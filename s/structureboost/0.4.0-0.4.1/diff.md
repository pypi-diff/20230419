# Comparing `tmp/structureboost-0.4.0.tar.gz` & `tmp/structureboost-0.4.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "structureboost-0.4.0.tar", last modified: Tue Apr 11 22:10:20 2023, max compression
+gzip compressed data, was "structureboost-0.4.1.tar", last modified: Wed Apr 19 15:53:20 2023, max compression
```

## Comparing `structureboost-0.4.0.tar` & `structureboost-0.4.1.tar`

### file list

```diff
@@ -1,31 +1,31 @@
-drwxr-xr-x   0 brianlucena   (501) staff       (20)        0 2023-04-11 22:10:20.741191 structureboost-0.4.0/
--rw-r--r--   0 brianlucena   (501) staff       (20)     1069 2020-02-12 23:26:49.000000 structureboost-0.4.0/LICENSE
--rw-r--r--   0 brianlucena   (501) staff       (20)     2269 2023-04-11 22:10:20.740921 structureboost-0.4.0/PKG-INFO
--rw-r--r--   0 brianlucena   (501) staff       (20)     1379 2020-07-30 21:19:11.000000 structureboost-0.4.0/README.md
--rw-r--r--   0 brianlucena   (501) staff       (20)      216 2020-03-27 21:03:03.000000 structureboost-0.4.0/README.rst
--rw-r--r--   0 brianlucena   (501) staff       (20)       68 2022-05-16 23:30:25.000000 structureboost-0.4.0/pyproject.toml
--rw-r--r--   0 brianlucena   (501) staff       (20)       38 2023-04-11 22:10:20.741377 structureboost-0.4.0/setup.cfg
--rw-r--r--   0 brianlucena   (501) staff       (20)     3745 2023-04-11 21:51:41.000000 structureboost-0.4.0/setup.py
-drwxr-xr-x   0 brianlucena   (501) staff       (20)        0 2023-04-11 22:10:20.733497 structureboost-0.4.0/structureboost/
--rw-r--r--   0 brianlucena   (501) staff       (20)      771 2023-04-11 21:52:23.000000 structureboost-0.4.0/structureboost/__init__.py
--rw-r--r--   0 brianlucena   (501) staff       (20)  1291636 2023-04-11 21:53:13.000000 structureboost-0.4.0/structureboost/coarsage.c
--rw-r--r--   0 brianlucena   (501) staff       (20)  1627393 2023-04-11 21:53:14.000000 structureboost-0.4.0/structureboost/graphs.c
--rw-r--r--   0 brianlucena   (501) staff       (20)   768847 2023-04-11 21:53:14.000000 structureboost-0.4.0/structureboost/pdf_discrete.c
--rw-r--r--   0 brianlucena   (501) staff       (20)   685166 2023-04-11 21:53:15.000000 structureboost-0.4.0/structureboost/pdf_group.c
--rw-r--r--   0 brianlucena   (501) staff       (20)   369766 2023-04-11 21:53:15.000000 structureboost-0.4.0/structureboost/pdf_set.c
--rw-r--r--   0 brianlucena   (501) staff       (20)   331763 2023-04-11 21:53:15.000000 structureboost-0.4.0/structureboost/prob_regr_unit.c
--rw-r--r--   0 brianlucena   (501) staff       (20)   791318 2023-04-11 21:53:15.000000 structureboost-0.4.0/structureboost/prob_regressor.c
--rw-r--r--   0 brianlucena   (501) staff       (20)  2551499 2023-04-11 21:53:18.000000 structureboost-0.4.0/structureboost/structure_dt.c
--rw-r--r--   0 brianlucena   (501) staff       (20)   691343 2023-04-11 21:53:19.000000 structureboost-0.4.0/structureboost/structure_dt_multi.c
--rw-r--r--   0 brianlucena   (501) staff       (20)  2195666 2023-04-11 21:53:21.000000 structureboost-0.4.0/structureboost/structure_gb.c
--rw-r--r--   0 brianlucena   (501) staff       (20)  1663768 2023-04-11 21:53:24.000000 structureboost-0.4.0/structureboost/structure_gb_multi.c
--rw-r--r--   0 brianlucena   (501) staff       (20)   801600 2023-04-11 21:53:24.000000 structureboost-0.4.0/structureboost/structure_rf.c
--rw-r--r--   0 brianlucena   (501) staff       (20)   755971 2023-04-11 21:53:25.000000 structureboost-0.4.0/structureboost/structure_rfdt.c
--rw-r--r--   0 brianlucena   (501) staff       (20)     9676 2022-10-26 21:11:48.000000 structureboost-0.4.0/structureboost/utils.py
-drwxr-xr-x   0 brianlucena   (501) staff       (20)        0 2023-04-11 22:10:20.740508 structureboost-0.4.0/structureboost.egg-info/
--rw-r--r--   0 brianlucena   (501) staff       (20)     2269 2023-04-11 22:10:20.000000 structureboost-0.4.0/structureboost.egg-info/PKG-INFO
--rw-r--r--   0 brianlucena   (501) staff       (20)      719 2023-04-11 22:10:20.000000 structureboost-0.4.0/structureboost.egg-info/SOURCES.txt
--rw-r--r--   0 brianlucena   (501) staff       (20)        1 2023-04-11 22:10:20.000000 structureboost-0.4.0/structureboost.egg-info/dependency_links.txt
--rw-r--r--   0 brianlucena   (501) staff       (20)        1 2022-02-04 23:34:24.000000 structureboost-0.4.0/structureboost.egg-info/not-zip-safe
--rw-r--r--   0 brianlucena   (501) staff       (20)       85 2023-04-11 22:10:20.000000 structureboost-0.4.0/structureboost.egg-info/requires.txt
--rw-r--r--   0 brianlucena   (501) staff       (20)      176 2023-04-11 22:10:20.000000 structureboost-0.4.0/structureboost.egg-info/top_level.txt
+drwxr-xr-x   0 brianlucena   (501) staff       (20)        0 2023-04-19 15:53:20.631988 structureboost-0.4.1/
+-rw-r--r--   0 brianlucena   (501) staff       (20)     1069 2020-02-12 23:26:49.000000 structureboost-0.4.1/LICENSE
+-rw-r--r--   0 brianlucena   (501) staff       (20)     2269 2023-04-19 15:53:20.631583 structureboost-0.4.1/PKG-INFO
+-rw-r--r--   0 brianlucena   (501) staff       (20)     1379 2020-07-30 21:19:11.000000 structureboost-0.4.1/README.md
+-rw-r--r--   0 brianlucena   (501) staff       (20)      216 2020-03-27 21:03:03.000000 structureboost-0.4.1/README.rst
+-rw-r--r--   0 brianlucena   (501) staff       (20)       68 2022-05-16 23:30:25.000000 structureboost-0.4.1/pyproject.toml
+-rw-r--r--   0 brianlucena   (501) staff       (20)       38 2023-04-19 15:53:20.632258 structureboost-0.4.1/setup.cfg
+-rw-r--r--   0 brianlucena   (501) staff       (20)     3745 2023-04-19 15:49:55.000000 structureboost-0.4.1/setup.py
+drwxr-xr-x   0 brianlucena   (501) staff       (20)        0 2023-04-19 15:53:20.627601 structureboost-0.4.1/structureboost/
+-rw-r--r--   0 brianlucena   (501) staff       (20)      771 2023-04-19 15:52:35.000000 structureboost-0.4.1/structureboost/__init__.py
+-rw-r--r--   0 brianlucena   (501) staff       (20)  1291598 2023-04-18 22:17:55.000000 structureboost-0.4.1/structureboost/coarsage.c
+-rw-r--r--   0 brianlucena   (501) staff       (20)  1627393 2023-04-18 22:17:56.000000 structureboost-0.4.1/structureboost/graphs.c
+-rw-r--r--   0 brianlucena   (501) staff       (20)   768847 2023-04-18 22:17:56.000000 structureboost-0.4.1/structureboost/pdf_discrete.c
+-rw-r--r--   0 brianlucena   (501) staff       (20)   685166 2023-04-18 22:17:56.000000 structureboost-0.4.1/structureboost/pdf_group.c
+-rw-r--r--   0 brianlucena   (501) staff       (20)   369766 2023-04-18 22:17:57.000000 structureboost-0.4.1/structureboost/pdf_set.c
+-rw-r--r--   0 brianlucena   (501) staff       (20)   331763 2023-04-18 22:17:57.000000 structureboost-0.4.1/structureboost/prob_regr_unit.c
+-rw-r--r--   0 brianlucena   (501) staff       (20)   791318 2023-04-18 22:17:57.000000 structureboost-0.4.1/structureboost/prob_regressor.c
+-rw-r--r--   0 brianlucena   (501) staff       (20)  2549702 2023-04-18 22:18:00.000000 structureboost-0.4.1/structureboost/structure_dt.c
+-rw-r--r--   0 brianlucena   (501) staff       (20)   690000 2023-04-18 22:18:00.000000 structureboost-0.4.1/structureboost/structure_dt_multi.c
+-rw-r--r--   0 brianlucena   (501) staff       (20)  2191823 2023-04-18 22:18:03.000000 structureboost-0.4.1/structureboost/structure_gb.c
+-rw-r--r--   0 brianlucena   (501) staff       (20)  1662473 2023-04-18 22:18:05.000000 structureboost-0.4.1/structureboost/structure_gb_multi.c
+-rw-r--r--   0 brianlucena   (501) staff       (20)   802064 2023-04-18 22:18:06.000000 structureboost-0.4.1/structureboost/structure_rf.c
+-rw-r--r--   0 brianlucena   (501) staff       (20)   754981 2023-04-18 22:18:06.000000 structureboost-0.4.1/structureboost/structure_rfdt.c
+-rw-r--r--   0 brianlucena   (501) staff       (20)     9676 2022-10-26 21:11:48.000000 structureboost-0.4.1/structureboost/utils.py
+drwxr-xr-x   0 brianlucena   (501) staff       (20)        0 2023-04-19 15:53:20.631096 structureboost-0.4.1/structureboost.egg-info/
+-rw-r--r--   0 brianlucena   (501) staff       (20)     2269 2023-04-19 15:53:20.000000 structureboost-0.4.1/structureboost.egg-info/PKG-INFO
+-rw-r--r--   0 brianlucena   (501) staff       (20)      719 2023-04-19 15:53:20.000000 structureboost-0.4.1/structureboost.egg-info/SOURCES.txt
+-rw-r--r--   0 brianlucena   (501) staff       (20)        1 2023-04-19 15:53:20.000000 structureboost-0.4.1/structureboost.egg-info/dependency_links.txt
+-rw-r--r--   0 brianlucena   (501) staff       (20)        1 2022-02-04 23:34:24.000000 structureboost-0.4.1/structureboost.egg-info/not-zip-safe
+-rw-r--r--   0 brianlucena   (501) staff       (20)       85 2023-04-19 15:53:20.000000 structureboost-0.4.1/structureboost.egg-info/requires.txt
+-rw-r--r--   0 brianlucena   (501) staff       (20)      176 2023-04-19 15:53:20.000000 structureboost-0.4.1/structureboost.egg-info/top_level.txt
```

### Comparing `structureboost-0.4.0/LICENSE` & `structureboost-0.4.1/LICENSE`

 * *Files identical despite different names*

### Comparing `structureboost-0.4.0/PKG-INFO` & `structureboost-0.4.1/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: structureboost
-Version: 0.4.0
+Version: 0.4.1
 Summary: StructureBoost is a Python package for gradient boosting using categorical structure.  See documentation at: https://structureboost.readthedocs.io/
 Home-page: https://github.com/numeristical/structureboost
 Author: Brian Lucena
 Author-email: brianlucena@gmail.com
 License: MIT
 Platform: UNKNOWN
 Classifier: Development Status :: 2 - Pre-Alpha
```

### Comparing `structureboost-0.4.0/README.md` & `structureboost-0.4.1/README.md`

 * *Files identical despite different names*

### Comparing `structureboost-0.4.0/setup.py` & `structureboost-0.4.1/setup.py`

 * *Files 1% similar despite different names*

```diff
@@ -18,15 +18,15 @@
 setup(
     author="Brian Lucena",
     author_email="brianlucena@gmail.com",
     name='structureboost',
     license="MIT",
     license_files=['LICENSE'],
     description="StructureBoost is a Python package for gradient boosting using categorical structure.  See documentation at: https://structureboost.readthedocs.io/",
-    version='0.4.0',
+    version='0.4.1',
     long_description=README,
     zip_safe=False,
     url='https://github.com/numeristical/structureboost',
     packages=['structureboost'],
     package_dir={'structureboost':
                  'structureboost'},
     python_requires=">=3.5",
```

### Comparing `structureboost-0.4.0/structureboost/__init__.py` & `structureboost-0.4.1/structureboost/__init__.py`

 * *Files 1% similar despite different names*

```diff
@@ -10,8 +10,8 @@
 from prob_regr_unit import ProbRegressorUnit
 from prob_regressor import PrestoBoost
 from coarsage import Coarsage
 from pdf_discrete import PdfDiscrete, average_densities
 from pdf_group import PdfGroup, log_loss_pdf, test_between_quantiles_pdf, test_in_pred_regions
 from .utils import get_basic_config, apply_defaults, default_config_dict, ice_plot, log_loss
 
-__version__ = '0.4.0'
+__version__ = '0.4.1'
```

### Comparing `structureboost-0.4.0/structureboost/coarsage.c` & `structureboost-0.4.1/structureboost/coarsage.c`

 * *Files 0% similar despite different names*

```diff
@@ -2414,14 +2414,15 @@
 static const char __pyx_k_doc[] = "__doc__";
 static const char __pyx_k_dtm[] = "dtm";
 static const char __pyx_k_eps[] = "eps";
 static const char __pyx_k_fbp[] = "fbp";
 static const char __pyx_k_fbw[] = "fbw";
 static const char __pyx_k_fit[] = "fit";
 static const char __pyx_k_ind[] = "ind";
+static const char __pyx_k_int[] = "int_";
 static const char __pyx_k_log[] = "log";
 static const char __pyx_k_max[] = "max";
 static const char __pyx_k_min[] = "min";
 static const char __pyx_k_mpv[] = "mpv";
 static const char __pyx_k_ngm[] = "ngm";
 static const char __pyx_k_rpt[] = "rpt";
 static const char __pyx_k_sum[] = "sum";
@@ -2449,15 +2450,14 @@
 static const char __pyx_k_CATEG[] = "CATEG";
 static const char __pyx_k_NUMER[] = "NUMER";
 static const char __pyx_k_array[] = "array";
 static const char __pyx_k_dtype[] = "dtype";
 static const char __pyx_k_fixed[] = "fixed";
 static const char __pyx_k_gamma[] = "gamma";
 static const char __pyx_k_index[] = "index";
-static const char __pyx_k_int64[] = "int64";
 static const char __pyx_k_isnan[] = "isnan";
 static const char __pyx_k_items[] = "items";
 static const char __pyx_k_midpt[] = "midpt";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_print[] = "print";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_round[] = "round";
@@ -2961,15 +2961,15 @@
 static PyObject *__pyx_n_s_init_bin_pts;
 static PyObject *__pyx_n_s_init_logprobmat_fine;
 static PyObject *__pyx_n_s_init_pdf;
 static PyObject *__pyx_n_s_init_pdf_fine;
 static PyObject *__pyx_n_s_initial_growth_steps;
 static PyObject *__pyx_n_s_initial_model;
 static PyObject *__pyx_n_s_initial_pred;
-static PyObject *__pyx_n_s_int64;
+static PyObject *__pyx_n_s_int;
 static PyObject *__pyx_n_s_inv_cti;
 static PyObject *__pyx_n_s_isin;
 static PyObject *__pyx_n_s_isnan;
 static PyObject *__pyx_n_s_isnan_array;
 static PyObject *__pyx_n_s_items;
 static PyObject *__pyx_n_s_j;
 static PyObject *__pyx_n_s_k;
@@ -7778,24 +7778,24 @@
   __Pyx_TraceCall("_create_rpt_from_list", __pyx_f[0], 294, 0, __PYX_ERR(0, 294, __pyx_L1_error));
 
   /* "structureboost/coarsage.pyx":295
  * 
  *     def _create_rpt_from_list(self, partition_list, num_classes):
  *         num_part = len(partition_list)             # <<<<<<<<<<<<<<
  *         max_part_size = np.max(np.array([len(qq) for qq in partition_list]))
- *         rpt = np.zeros((num_part, max_part_size, num_classes), dtype=np.int64)
+ *         rpt = np.zeros((num_part, max_part_size, num_classes), dtype=np.int_)
  */
   __pyx_t_1 = PyObject_Length(__pyx_v_partition_list); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 295, __pyx_L1_error)
   __pyx_v_num_part = __pyx_t_1;
 
   /* "structureboost/coarsage.pyx":296
  *     def _create_rpt_from_list(self, partition_list, num_classes):
  *         num_part = len(partition_list)
  *         max_part_size = np.max(np.array([len(qq) for qq in partition_list]))             # <<<<<<<<<<<<<<
- *         rpt = np.zeros((num_part, max_part_size, num_classes), dtype=np.int64)
+ *         rpt = np.zeros((num_part, max_part_size, num_classes), dtype=np.int_)
  *         flat_list = [j for sl in partition_list for i in sl for j in i]
  */
   __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_max); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 296, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -7896,15 +7896,15 @@
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_max_part_size = __pyx_t_2;
   __pyx_t_2 = 0;
 
   /* "structureboost/coarsage.pyx":297
  *         num_part = len(partition_list)
  *         max_part_size = np.max(np.array([len(qq) for qq in partition_list]))
- *         rpt = np.zeros((num_part, max_part_size, num_classes), dtype=np.int64)             # <<<<<<<<<<<<<<
+ *         rpt = np.zeros((num_part, max_part_size, num_classes), dtype=np.int_)             # <<<<<<<<<<<<<<
  *         flat_list = [j for sl in partition_list for i in sl for j in i]
  *         min_val, max_val = np.min(flat_list), np.max(flat_list)
  */
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
@@ -7927,30 +7927,30 @@
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
   __pyx_t_3 = 0;
   __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_int64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 297, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_int); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 297, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_rpt = __pyx_t_5;
   __pyx_t_5 = 0;
 
   /* "structureboost/coarsage.pyx":298
  *         max_part_size = np.max(np.array([len(qq) for qq in partition_list]))
- *         rpt = np.zeros((num_part, max_part_size, num_classes), dtype=np.int64)
+ *         rpt = np.zeros((num_part, max_part_size, num_classes), dtype=np.int_)
  *         flat_list = [j for sl in partition_list for i in sl for j in i]             # <<<<<<<<<<<<<<
  *         min_val, max_val = np.min(flat_list), np.max(flat_list)
  *         if (min_val<0) or (max_val>num_classes-1):
  */
   { /* enter inner scope */
     __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 298, __pyx_L11_error)
     __Pyx_GOTREF(__pyx_t_5);
@@ -8095,15 +8095,15 @@
     goto __pyx_L1_error;
     __pyx_L18_exit_scope:;
   } /* exit inner scope */
   __pyx_v_flat_list = ((PyObject*)__pyx_t_5);
   __pyx_t_5 = 0;
 
   /* "structureboost/coarsage.pyx":299
- *         rpt = np.zeros((num_part, max_part_size, num_classes), dtype=np.int64)
+ *         rpt = np.zeros((num_part, max_part_size, num_classes), dtype=np.int_)
  *         flat_list = [j for sl in partition_list for i in sl for j in i]
  *         min_val, max_val = np.min(flat_list), np.max(flat_list)             # <<<<<<<<<<<<<<
  *         if (min_val<0) or (max_val>num_classes-1):
  *             w_str = "Elements of partition must be >=0 and <=(num_classes-1). "
  */
   __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 299, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
@@ -8941,15 +8941,15 @@
     __pyx_v_num_dt = __pyx_t_9;
 
     /* "structureboost/coarsage.pyx":327
  *             cat_size = np.max(np.array([dt.get_max_split_size() for dt in self.dec_tree_list]))
  *             num_dt = len(self.dec_tree_list)
  *             max_nodes = np.max(np.array([dt.num_nodes for dt in self.dec_tree_list]))             # <<<<<<<<<<<<<<
  *             max_num_classes = np.max(self.num_classes)
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1
  */
     __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 327, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_max); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 327, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 327, __pyx_L1_error)
@@ -9052,15 +9052,15 @@
     __pyx_v_max_nodes = __pyx_t_1;
     __pyx_t_1 = 0;
 
     /* "structureboost/coarsage.pyx":328
  *             num_dt = len(self.dec_tree_list)
  *             max_nodes = np.max(np.array([dt.num_nodes for dt in self.dec_tree_list]))
  *             max_num_classes = np.max(self.num_classes)             # <<<<<<<<<<<<<<
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, max_num_classes+2))
  */
     __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 328, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_max); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 328, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -9084,15 +9084,15 @@
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_max_num_classes = __pyx_t_1;
     __pyx_t_1 = 0;
 
     /* "structureboost/coarsage.pyx":329
  *             max_nodes = np.max(np.array([dt.num_nodes for dt in self.dec_tree_list]))
  *             max_num_classes = np.max(self.num_classes)
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1             # <<<<<<<<<<<<<<
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1             # <<<<<<<<<<<<<<
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, max_num_classes+2))
  *             for i in range(num_dt):
  */
     __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 329, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 329, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
@@ -9117,15 +9117,15 @@
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
     __pyx_t_5 = 0;
     __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 329, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 329, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 329, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 329, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 329, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 329, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -9135,15 +9135,15 @@
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int, __pyx_t_5) < 0) __PYX_ERR(0, 329, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
     /* "structureboost/coarsage.pyx":330
  *             max_num_classes = np.max(self.num_classes)
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, max_num_classes+2))             # <<<<<<<<<<<<<<
  *             for i in range(num_dt):
  *                 self.convert_dt_to_matrix(i)
  */
     __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 330, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 330, __pyx_L1_error)
@@ -9180,15 +9180,15 @@
     if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 330, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float, __pyx_t_5) < 0) __PYX_ERR(0, 330, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
     /* "structureboost/coarsage.pyx":331
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, max_num_classes+2))
  *             for i in range(num_dt):             # <<<<<<<<<<<<<<
  *                 self.convert_dt_to_matrix(i)
  *             self.optimized=True
  */
     __pyx_t_9 = __pyx_v_num_dt;
     __pyx_t_13 = __pyx_t_9;
@@ -10199,42 +10199,42 @@
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
     /* "structureboost/coarsage.pyx":418
  *             curr_binpt_vec = self.get_bin_pts(y_train, self.random_seed+i, no_growth_mode=True)
  *             self.binpt_vec_list.append(curr_binpt_vec.copy())
  *             self.num_classes.append(len(curr_binpt_vec)-1)             # <<<<<<<<<<<<<<
  *             i+=1
- *         self.num_classes=np.array(self.num_classes, dtype=np.int64)
+ *         self.num_classes=np.array(self.num_classes, dtype=np.int_)
  */
     __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_11 = PyObject_Length(__pyx_v_curr_binpt_vec); if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1))) __PYX_ERR(0, 418, __pyx_L1_error)
     __pyx_t_2 = PyInt_FromSsize_t((__pyx_t_11 - 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_10 = __Pyx_PyObject_Append(__pyx_t_7, __pyx_t_2); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
     /* "structureboost/coarsage.pyx":419
  *             self.binpt_vec_list.append(curr_binpt_vec.copy())
  *             self.num_classes.append(len(curr_binpt_vec)-1)
  *             i+=1             # <<<<<<<<<<<<<<
- *         self.num_classes=np.array(self.num_classes, dtype=np.int64)
+ *         self.num_classes=np.array(self.num_classes, dtype=np.int_)
  * 
  */
     __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF_SET(__pyx_v_i, __pyx_t_2);
     __pyx_t_2 = 0;
   }
 
   /* "structureboost/coarsage.pyx":420
  *             self.num_classes.append(len(curr_binpt_vec)-1)
  *             i+=1
- *         self.num_classes=np.array(self.num_classes, dtype=np.int64)             # <<<<<<<<<<<<<<
+ *         self.num_classes=np.array(self.num_classes, dtype=np.int_)             # <<<<<<<<<<<<<<
  * 
  *         super().fit(X_train, y_train, eval_set=eval_set, eval_freq=eval_freq,
  */
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
@@ -10246,29 +10246,29 @@
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __pyx_t_2 = 0;
   __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_int64); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 420, __pyx_L1_error)
+  __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_int); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_12) < 0) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
   __pyx_t_12 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_12);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_num_classes, __pyx_t_12) < 0) __PYX_ERR(0, 420, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
   /* "structureboost/coarsage.pyx":422
- *         self.num_classes=np.array(self.num_classes, dtype=np.int64)
+ *         self.num_classes=np.array(self.num_classes, dtype=np.int_)
  * 
  *         super().fit(X_train, y_train, eval_set=eval_set, eval_freq=eval_freq,             # <<<<<<<<<<<<<<
  *             early_stop_past_steps=early_stop_past_steps,
  *             choose_best_eval=choose_best_eval, verbose=verbose)
  */
   __pyx_t_12 = __Pyx_CyFunction_GetClassObj(__pyx_self);
   if (!__pyx_t_12) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 422, __pyx_L1_error) }
@@ -10316,15 +10316,15 @@
  * 
  * 
  */
   if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_choose_best_eval, __pyx_v_choose_best_eval) < 0) __PYX_ERR(0, 422, __pyx_L1_error)
   if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_verbose, __pyx_v_verbose) < 0) __PYX_ERR(0, 422, __pyx_L1_error)
 
   /* "structureboost/coarsage.pyx":422
- *         self.num_classes=np.array(self.num_classes, dtype=np.int64)
+ *         self.num_classes=np.array(self.num_classes, dtype=np.int_)
  * 
  *         super().fit(X_train, y_train, eval_set=eval_set, eval_freq=eval_freq,             # <<<<<<<<<<<<<<
  *             early_stop_past_steps=early_stop_past_steps,
  *             choose_best_eval=choose_best_eval, verbose=verbose)
  */
   __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_12, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
@@ -18895,15 +18895,15 @@
   __pyx_v_num_fi = ((__pyx_v_fine_binpts->dimensions[0]) - 1);
 
   /* "structureboost/coarsage.pyx":738
  *     cdef long nt = coarse_pred.shape[1]
  *     cdef long num_fi = fine_binpts.shape[0]-1
  *     cdef np.ndarray[double, ndim=2] outmat = np.zeros((num_rows,num_fi))             # <<<<<<<<<<<<<<
  *     cdef long fi_ptr = 0
- *     cdef np.ndarray[long] coarse_ptr_arr = np.zeros(nt, dtype=np.int64)
+ *     cdef np.ndarray[long] coarse_ptr_arr = np.zeros(nt, dtype=np.int_)
  */
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 738, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_num_rows); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 738, __pyx_L1_error)
@@ -18948,23 +18948,23 @@
   __pyx_v_outmat = ((PyArrayObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
   /* "structureboost/coarsage.pyx":739
  *     cdef long num_fi = fine_binpts.shape[0]-1
  *     cdef np.ndarray[double, ndim=2] outmat = np.zeros((num_rows,num_fi))
  *     cdef long fi_ptr = 0             # <<<<<<<<<<<<<<
- *     cdef np.ndarray[long] coarse_ptr_arr = np.zeros(nt, dtype=np.int64)
+ *     cdef np.ndarray[long] coarse_ptr_arr = np.zeros(nt, dtype=np.int_)
  *     cdef long row_ptr = 0
  */
   __pyx_v_fi_ptr = 0;
 
   /* "structureboost/coarsage.pyx":740
  *     cdef np.ndarray[double, ndim=2] outmat = np.zeros((num_rows,num_fi))
  *     cdef long fi_ptr = 0
- *     cdef np.ndarray[long] coarse_ptr_arr = np.zeros(nt, dtype=np.int64)             # <<<<<<<<<<<<<<
+ *     cdef np.ndarray[long] coarse_ptr_arr = np.zeros(nt, dtype=np.int_)             # <<<<<<<<<<<<<<
  *     cdef long row_ptr = 0
  * 
  */
   __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 740, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
@@ -18976,15 +18976,15 @@
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
   __pyx_t_1 = 0;
   __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 740, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 740, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 740, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 740, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 740, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -19002,15 +19002,15 @@
   }
   __pyx_t_7 = 0;
   __pyx_v_coarse_ptr_arr = ((PyArrayObject *)__pyx_t_2);
   __pyx_t_2 = 0;
 
   /* "structureboost/coarsage.pyx":741
  *     cdef long fi_ptr = 0
- *     cdef np.ndarray[long] coarse_ptr_arr = np.zeros(nt, dtype=np.int64)
+ *     cdef np.ndarray[long] coarse_ptr_arr = np.zeros(nt, dtype=np.int_)
  *     cdef long row_ptr = 0             # <<<<<<<<<<<<<<
  * 
  *     for fi_ptr in range(num_fi):
  */
   __pyx_v_row_ptr = 0;
 
   /* "structureboost/coarsage.pyx":743
@@ -20503,15 +20503,15 @@
   {&__pyx_n_s_init_bin_pts, __pyx_k_init_bin_pts, sizeof(__pyx_k_init_bin_pts), 0, 0, 1, 1},
   {&__pyx_n_s_init_logprobmat_fine, __pyx_k_init_logprobmat_fine, sizeof(__pyx_k_init_logprobmat_fine), 0, 0, 1, 1},
   {&__pyx_n_s_init_pdf, __pyx_k_init_pdf, sizeof(__pyx_k_init_pdf), 0, 0, 1, 1},
   {&__pyx_n_s_init_pdf_fine, __pyx_k_init_pdf_fine, sizeof(__pyx_k_init_pdf_fine), 0, 0, 1, 1},
   {&__pyx_n_s_initial_growth_steps, __pyx_k_initial_growth_steps, sizeof(__pyx_k_initial_growth_steps), 0, 0, 1, 1},
   {&__pyx_n_s_initial_model, __pyx_k_initial_model, sizeof(__pyx_k_initial_model), 0, 0, 1, 1},
   {&__pyx_n_s_initial_pred, __pyx_k_initial_pred, sizeof(__pyx_k_initial_pred), 0, 0, 1, 1},
-  {&__pyx_n_s_int64, __pyx_k_int64, sizeof(__pyx_k_int64), 0, 0, 1, 1},
+  {&__pyx_n_s_int, __pyx_k_int, sizeof(__pyx_k_int), 0, 0, 1, 1},
   {&__pyx_n_s_inv_cti, __pyx_k_inv_cti, sizeof(__pyx_k_inv_cti), 0, 0, 1, 1},
   {&__pyx_n_s_isin, __pyx_k_isin, sizeof(__pyx_k_isin), 0, 0, 1, 1},
   {&__pyx_n_s_isnan, __pyx_k_isnan, sizeof(__pyx_k_isnan), 0, 0, 1, 1},
   {&__pyx_n_s_isnan_array, __pyx_k_isnan_array, sizeof(__pyx_k_isnan_array), 0, 0, 1, 1},
   {&__pyx_n_s_items, __pyx_k_items, sizeof(__pyx_k_items), 0, 0, 1, 1},
   {&__pyx_n_s_j, __pyx_k_j, sizeof(__pyx_k_j), 0, 0, 1, 1},
   {&__pyx_n_s_k, __pyx_k_k, sizeof(__pyx_k_k), 0, 0, 1, 1},
```

### Comparing `structureboost-0.4.0/structureboost/graphs.c` & `structureboost-0.4.1/structureboost/graphs.c`

 * *Files identical despite different names*

### Comparing `structureboost-0.4.0/structureboost/pdf_discrete.c` & `structureboost-0.4.1/structureboost/pdf_discrete.c`

 * *Files identical despite different names*

### Comparing `structureboost-0.4.0/structureboost/pdf_group.c` & `structureboost-0.4.1/structureboost/pdf_group.c`

 * *Files identical despite different names*

### Comparing `structureboost-0.4.0/structureboost/pdf_set.c` & `structureboost-0.4.1/structureboost/pdf_set.c`

 * *Files identical despite different names*

### Comparing `structureboost-0.4.0/structureboost/prob_regr_unit.c` & `structureboost-0.4.1/structureboost/prob_regr_unit.c`

 * *Files identical despite different names*

### Comparing `structureboost-0.4.0/structureboost/prob_regressor.c` & `structureboost-0.4.1/structureboost/prob_regressor.c`

 * *Files identical despite different names*

### Comparing `structureboost-0.4.0/structureboost/structure_dt.c` & `structureboost-0.4.1/structureboost/structure_dt.c`

 * *Files 0% similar despite different names*

```diff
@@ -1280,23 +1280,14 @@
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
-
-/* "structureboost/structure_dt.pyx":17
- * cimport cython
- * 
- * ctypedef np.int64_t dtype_int64_t             # <<<<<<<<<<<<<<
- * 
- * class StructureDecisionTree(object):
- */
-typedef __pyx_t_5numpy_int64_t __pyx_t_14structureboost_12structure_dt_dtype_int64_t;
 /* Declarations.proto */
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     typedef ::std::complex< float > __pyx_t_float_complex;
   #else
     typedef float _Complex __pyx_t_float_complex;
   #endif
@@ -2822,15 +2813,15 @@
 static void __pyx_memoryview_refcount_copying(__Pyx_memviewslice *, int, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice_with_gil(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_slice_assign_scalar(__Pyx_memviewslice *, int, size_t, void *, int); /*proto*/
 static void __pyx_memoryview__slice_assign_scalar(char *, Py_ssize_t *, Py_ssize_t *, int, size_t, void *); /*proto*/
 static PyObject *__pyx_unpickle_Enum__set_state(struct __pyx_MemviewEnum_obj *, PyObject *); /*proto*/
 static __Pyx_TypeInfo __Pyx_TypeInfo_double = { "double", NULL, sizeof(double), { 0 }, 0, 'R', 0, 0 };
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t = { "dtype_int64_t", NULL, sizeof(__pyx_t_14structureboost_12structure_dt_dtype_int64_t), { 0 }, 0, IS_UNSIGNED(__pyx_t_14structureboost_12structure_dt_dtype_int64_t) ? 'U' : 'I', IS_UNSIGNED(__pyx_t_14structureboost_12structure_dt_dtype_int64_t), 0 };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int_t = { "int_t", NULL, sizeof(__pyx_t_5numpy_int_t), { 0 }, 0, IS_UNSIGNED(__pyx_t_5numpy_int_t) ? 'U' : 'I', IS_UNSIGNED(__pyx_t_5numpy_int_t), 0 };
 #define __Pyx_MODULE_NAME "structureboost.structure_dt"
 extern int __pyx_module_is_main_structureboost__structure_dt;
 int __pyx_module_is_main_structureboost__structure_dt = 0;
 
 /* Implementation of 'structureboost.structure_dt' */
 static PyObject *__pyx_builtin_object;
 static PyObject *__pyx_builtin_range;
@@ -2863,14 +2854,15 @@
 static const char __pyx_k_col[] = "col";
 static const char __pyx_k_doc[] = "__doc__";
 static const char __pyx_k_drd[] = "drd";
 static const char __pyx_k_esm[] = "esm";
 static const char __pyx_k_fit[] = "fit";
 static const char __pyx_k_ind[] = "ind";
 static const char __pyx_k_inf[] = "inf";
+static const char __pyx_k_int[] = "int_";
 static const char __pyx_k_lni[] = "lni";
 static const char __pyx_k_loc[] = "loc";
 static const char __pyx_k_lvi[] = "lvi";
 static const char __pyx_k_max[] = "max";
 static const char __pyx_k_mid[] = "mid";
 static const char __pyx_k_min[] = "min";
 static const char __pyx_k_nan[] = "nan";
@@ -2924,15 +2916,14 @@
 static const char __pyx_k_enter[] = "__enter__";
 static const char __pyx_k_error[] = "error";
 static const char __pyx_k_flags[] = "flags";
 static const char __pyx_k_gamma[] = "gamma";
 static const char __pyx_k_graph[] = "graph";
 static const char __pyx_k_ind_a[] = "ind_a";
 static const char __pyx_k_ind_b[] = "ind_b";
-static const char __pyx_k_int64[] = "int64";
 static const char __pyx_k_isnan[] = "isnan";
 static const char __pyx_k_items[] = "items";
 static const char __pyx_k_lsize[] = "lsize";
 static const char __pyx_k_max_i[] = "max_i";
 static const char __pyx_k_min_i[] = "min_i";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_range[] = "range";
@@ -3682,15 +3673,15 @@
 static PyObject *__pyx_n_s_ind_subset_right;
 static PyObject *__pyx_n_s_index_range;
 static PyObject *__pyx_n_s_inds;
 static PyObject *__pyx_n_s_inf;
 static PyObject *__pyx_n_s_init;
 static PyObject *__pyx_n_s_init_for_span_trees;
 static PyObject *__pyx_n_s_initialize_best_split_dict;
-static PyObject *__pyx_n_s_int64;
+static PyObject *__pyx_n_s_int;
 static PyObject *__pyx_n_u_interior;
 static PyObject *__pyx_n_s_interp_mode;
 static PyObject *__pyx_n_u_interp_mode;
 static PyObject *__pyx_n_s_is_integer_valued;
 static PyObject *__pyx_n_s_isin;
 static PyObject *__pyx_n_s_isnan;
 static PyObject *__pyx_n_s_isnull;
@@ -10632,43 +10623,43 @@
   __pyx_t_3 = 0;
 
   /* "structureboost/structure_dt.pyx":311
  *                                                 'subfeature_list']]
  *         data_array = self.X_train.to_numpy()[:, subfeature_indices]
  *         num_query_pts = data_array.shape[0]             # <<<<<<<<<<<<<<
  *         num_vor_dims = data_array.shape[1]
- *         feat_vec = np.zeros(num_query_pts,dtype=np.int64)
+ *         feat_vec = np.zeros(num_query_pts,dtype=np.int_)
  */
   __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_data_array, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 311, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 311, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_num_query_pts = __pyx_t_6;
   __pyx_t_6 = 0;
 
   /* "structureboost/structure_dt.pyx":312
  *         data_array = self.X_train.to_numpy()[:, subfeature_indices]
  *         num_query_pts = data_array.shape[0]
  *         num_vor_dims = data_array.shape[1]             # <<<<<<<<<<<<<<
- *         feat_vec = np.zeros(num_query_pts,dtype=np.int64)
+ *         feat_vec = np.zeros(num_query_pts,dtype=np.int_)
  *         feat_vec = map_to_nn_point_index(best_split_dict['vor_pts'],
  */
   __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_data_array, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 312, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_6, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 312, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_num_vor_dims = __pyx_t_3;
   __pyx_t_3 = 0;
 
   /* "structureboost/structure_dt.pyx":313
  *         num_query_pts = data_array.shape[0]
  *         num_vor_dims = data_array.shape[1]
- *         feat_vec = np.zeros(num_query_pts,dtype=np.int64)             # <<<<<<<<<<<<<<
+ *         feat_vec = np.zeros(num_query_pts,dtype=np.int_)             # <<<<<<<<<<<<<<
  *         feat_vec = map_to_nn_point_index(best_split_dict['vor_pts'],
  *                                          data_array,
  */
   __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 313, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 313, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
@@ -10678,30 +10669,30 @@
   __Pyx_INCREF(__pyx_v_num_query_pts);
   __Pyx_GIVEREF(__pyx_v_num_query_pts);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_num_query_pts);
   __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 313, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 313, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 313, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 313, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 313, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 313, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_feat_vec = __pyx_t_7;
   __pyx_t_7 = 0;
 
   /* "structureboost/structure_dt.pyx":314
  *         num_vor_dims = data_array.shape[1]
- *         feat_vec = np.zeros(num_query_pts,dtype=np.int64)
+ *         feat_vec = np.zeros(num_query_pts,dtype=np.int_)
  *         feat_vec = map_to_nn_point_index(best_split_dict['vor_pts'],             # <<<<<<<<<<<<<<
  *                                          data_array,
  *                                          feat_vec,
  */
   __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_map_to_nn_point_index); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 314, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_best_split_dict, __pyx_n_u_vor_pts); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 314, __pyx_L1_error)
@@ -10724,15 +10715,15 @@
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "structureboost/structure_dt.pyx":318
  *                                          feat_vec,
  *                                          best_split_dict['vor_pts'].shape[0],
  *                                          num_query_pts, num_vor_dims)             # <<<<<<<<<<<<<<
  *         fs_array = np.fromiter(best_split_dict['left_split'], int,
- *                                len(best_split_dict['left_split'])).astype(np.int64)
+ *                                len(best_split_dict['left_split'])).astype(np.int_)
  */
   __pyx_t_2 = NULL;
   __pyx_t_8 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -10794,29 +10785,29 @@
   __Pyx_DECREF_SET(__pyx_v_feat_vec, __pyx_t_7);
   __pyx_t_7 = 0;
 
   /* "structureboost/structure_dt.pyx":319
  *                                          best_split_dict['vor_pts'].shape[0],
  *                                          num_query_pts, num_vor_dims)
  *         fs_array = np.fromiter(best_split_dict['left_split'], int,             # <<<<<<<<<<<<<<
- *                                len(best_split_dict['left_split'])).astype(np.int64)
+ *                                len(best_split_dict['left_split'])).astype(np.int_)
  *         vec_len = len(feat_vec)
  */
   __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 319, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_fromiter); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 319, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __pyx_t_9 = __Pyx_PyObject_Dict_GetItem(__pyx_v_best_split_dict, __pyx_n_u_left_split); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 319, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
 
   /* "structureboost/structure_dt.pyx":320
  *                                          num_query_pts, num_vor_dims)
  *         fs_array = np.fromiter(best_split_dict['left_split'], int,
- *                                len(best_split_dict['left_split'])).astype(np.int64)             # <<<<<<<<<<<<<<
+ *                                len(best_split_dict['left_split'])).astype(np.int_)             # <<<<<<<<<<<<<<
  *         vec_len = len(feat_vec)
  *         lsplit_len = len(fs_array)
  */
   __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_best_split_dict, __pyx_n_u_left_split); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 320, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -10875,15 +10866,15 @@
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 320, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_1)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
@@ -10899,36 +10890,36 @@
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_fs_array = __pyx_t_7;
   __pyx_t_7 = 0;
 
   /* "structureboost/structure_dt.pyx":321
  *         fs_array = np.fromiter(best_split_dict['left_split'], int,
- *                                len(best_split_dict['left_split'])).astype(np.int64)
+ *                                len(best_split_dict['left_split'])).astype(np.int_)
  *         vec_len = len(feat_vec)             # <<<<<<<<<<<<<<
  *         lsplit_len = len(fs_array)
- *         left_mask = np.zeros(vec_len, dtype=np.int64)
+ *         left_mask = np.zeros(vec_len, dtype=np.int_)
  */
   __pyx_t_4 = PyObject_Length(__pyx_v_feat_vec); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 321, __pyx_L1_error)
   __pyx_v_vec_len = __pyx_t_4;
 
   /* "structureboost/structure_dt.pyx":322
- *                                len(best_split_dict['left_split'])).astype(np.int64)
+ *                                len(best_split_dict['left_split'])).astype(np.int_)
  *         vec_len = len(feat_vec)
  *         lsplit_len = len(fs_array)             # <<<<<<<<<<<<<<
- *         left_mask = np.zeros(vec_len, dtype=np.int64)
+ *         left_mask = np.zeros(vec_len, dtype=np.int_)
  *         left_mask = get_mask_int_c(feat_vec, fs_array, vec_len,
  */
   __pyx_t_4 = PyObject_Length(__pyx_v_fs_array); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 322, __pyx_L1_error)
   __pyx_v_lsplit_len = __pyx_t_4;
 
   /* "structureboost/structure_dt.pyx":323
  *         vec_len = len(feat_vec)
  *         lsplit_len = len(fs_array)
- *         left_mask = np.zeros(vec_len, dtype=np.int64)             # <<<<<<<<<<<<<<
+ *         left_mask = np.zeros(vec_len, dtype=np.int_)             # <<<<<<<<<<<<<<
  *         left_mask = get_mask_int_c(feat_vec, fs_array, vec_len,
  *                                    lsplit_len, left_mask)
  */
   __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 323, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 323, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
@@ -10940,41 +10931,41 @@
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_7);
   __pyx_t_7 = 0;
   __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 323, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 323, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 323, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_10, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_left_mask = __pyx_t_3;
   __pyx_t_3 = 0;
 
   /* "structureboost/structure_dt.pyx":324
  *         lsplit_len = len(fs_array)
- *         left_mask = np.zeros(vec_len, dtype=np.int64)
+ *         left_mask = np.zeros(vec_len, dtype=np.int_)
  *         left_mask = get_mask_int_c(feat_vec, fs_array, vec_len,             # <<<<<<<<<<<<<<
  *                                    lsplit_len, left_mask)
  * 
  */
   __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_get_mask_int_c); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 324, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __pyx_t_10 = PyInt_FromSsize_t(__pyx_v_vec_len); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 324, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_10);
 
   /* "structureboost/structure_dt.pyx":325
- *         left_mask = np.zeros(vec_len, dtype=np.int64)
+ *         left_mask = np.zeros(vec_len, dtype=np.int_)
  *         left_mask = get_mask_int_c(feat_vec, fs_array, vec_len,
  *                                    lsplit_len, left_mask)             # <<<<<<<<<<<<<<
  * 
  *         # record info about current node
  */
   __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_lsplit_len); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 325, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
@@ -14069,75 +14060,75 @@
   __pyx_t_1 = 0;
 
   /* "structureboost/structure_dt.pyx":438
  * 
  *         has_na_vals = np.isnan(split_vec[-1])
  *         bin_result_vec = np.searchsorted(split_vec,             # <<<<<<<<<<<<<<
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)
+ *                                          side='right').astype(np.int_)
  */
   __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 438, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_searchsorted); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 438, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
   /* "structureboost/structure_dt.pyx":439
  *         has_na_vals = np.isnan(split_vec[-1])
  *         bin_result_vec = np.searchsorted(split_vec,
  *                                          feature_vec,             # <<<<<<<<<<<<<<
- *                                          side='right').astype(np.int64)
+ *                                          side='right').astype(np.int_)
  *         g_sum_bins, h_sum_bins = get_bin_sums_c(g_h_mat,
  */
   __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 438, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_split_vec);
   __Pyx_GIVEREF(__pyx_v_split_vec);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_split_vec);
   __Pyx_INCREF(__pyx_v_feature_vec);
   __Pyx_GIVEREF(__pyx_v_feature_vec);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_feature_vec);
 
   /* "structureboost/structure_dt.pyx":440
  *         bin_result_vec = np.searchsorted(split_vec,
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)             # <<<<<<<<<<<<<<
+ *                                          side='right').astype(np.int_)             # <<<<<<<<<<<<<<
  *         g_sum_bins, h_sum_bins = get_bin_sums_c(g_h_mat,
  *                                                 bin_result_vec,
  */
   __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 440, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_side, __pyx_n_u_right) < 0) __PYX_ERR(0, 440, __pyx_L1_error)
 
   /* "structureboost/structure_dt.pyx":438
  * 
  *         has_na_vals = np.isnan(split_vec[-1])
  *         bin_result_vec = np.searchsorted(split_vec,             # <<<<<<<<<<<<<<
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)
+ *                                          side='right').astype(np.int_)
  */
   __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 438, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
   /* "structureboost/structure_dt.pyx":440
  *         bin_result_vec = np.searchsorted(split_vec,
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)             # <<<<<<<<<<<<<<
+ *                                          side='right').astype(np.int_)             # <<<<<<<<<<<<<<
  *         g_sum_bins, h_sum_bins = get_bin_sums_c(g_h_mat,
  *                                                 bin_result_vec,
  */
   __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 440, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 440, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 440, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 440, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -14153,15 +14144,15 @@
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_bin_result_vec = __pyx_t_1;
   __pyx_t_1 = 0;
 
   /* "structureboost/structure_dt.pyx":441
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)
+ *                                          side='right').astype(np.int_)
  *         g_sum_bins, h_sum_bins = get_bin_sums_c(g_h_mat,             # <<<<<<<<<<<<<<
  *                                                 bin_result_vec,
  *                                                 len(split_vec)+1)
  */
   __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_get_bin_sums_c); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 441, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
 
@@ -14270,15 +14261,15 @@
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
     __PYX_ERR(0, 441, __pyx_L1_error)
     __pyx_L4_unpacking_done:;
   }
 
   /* "structureboost/structure_dt.pyx":441
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)
+ *                                          side='right').astype(np.int_)
  *         g_sum_bins, h_sum_bins = get_bin_sums_c(g_h_mat,             # <<<<<<<<<<<<<<
  *                                                 bin_result_vec,
  *                                                 len(split_vec)+1)
  */
   __pyx_v_g_sum_bins = __pyx_t_4;
   __pyx_t_4 = 0;
   __pyx_v_h_sum_bins = __pyx_t_2;
@@ -15827,36 +15818,36 @@
     __pyx_t_3 = 0;
 
     /* "structureboost/structure_dt.pyx":505
  *             left_split = curr_partition[0]
  *             right_split = curr_partition[1]
  *             if is_integer_valued:             # <<<<<<<<<<<<<<
  *                 fs_array = np.fromiter(left_split, int,
- *                                        len(left_split)).astype(np.int64)
+ *                                        len(left_split)).astype(np.int_)
  */
     __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_v_is_integer_valued); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 505, __pyx_L1_error)
     if (__pyx_t_5) {
 
       /* "structureboost/structure_dt.pyx":506
  *             right_split = curr_partition[1]
  *             if is_integer_valued:
  *                 fs_array = np.fromiter(left_split, int,             # <<<<<<<<<<<<<<
- *                                        len(left_split)).astype(np.int64)
+ *                                        len(left_split)).astype(np.int_)
  *                 vec_len = len(feature_vec_node)
  */
       __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 506, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_fromiter); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 506, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
       /* "structureboost/structure_dt.pyx":507
  *             if is_integer_valued:
  *                 fs_array = np.fromiter(left_split, int,
- *                                        len(left_split)).astype(np.int64)             # <<<<<<<<<<<<<<
+ *                                        len(left_split)).astype(np.int_)             # <<<<<<<<<<<<<<
  *                 vec_len = len(feature_vec_node)
  *                 lsplit_len = len(fs_array)
  */
       __pyx_t_9 = PyObject_Length(__pyx_v_left_split); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 507, __pyx_L1_error)
       __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 507, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __pyx_t_10 = NULL;
@@ -15910,15 +15901,15 @@
       }
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_astype); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 507, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 507, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 507, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_8))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_8);
         if (likely(__pyx_t_1)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
@@ -15934,37 +15925,37 @@
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_XDECREF_SET(__pyx_v_fs_array, __pyx_t_3);
       __pyx_t_3 = 0;
 
       /* "structureboost/structure_dt.pyx":508
  *                 fs_array = np.fromiter(left_split, int,
- *                                        len(left_split)).astype(np.int64)
+ *                                        len(left_split)).astype(np.int_)
  *                 vec_len = len(feature_vec_node)             # <<<<<<<<<<<<<<
  *                 lsplit_len = len(fs_array)
- *                 mask_left = np.zeros(vec_len, dtype=np.int64)
+ *                 mask_left = np.zeros(vec_len, dtype=np.int_)
  */
       __pyx_t_9 = PyObject_Length(__pyx_v_feature_vec_node); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 508, __pyx_L1_error)
       __pyx_v_vec_len = __pyx_t_9;
 
       /* "structureboost/structure_dt.pyx":509
- *                                        len(left_split)).astype(np.int64)
+ *                                        len(left_split)).astype(np.int_)
  *                 vec_len = len(feature_vec_node)
  *                 lsplit_len = len(fs_array)             # <<<<<<<<<<<<<<
- *                 mask_left = np.zeros(vec_len, dtype=np.int64)
- *                 mask_left = get_mask_int_c(feature_vec_node.astype(np.int64),
+ *                 mask_left = np.zeros(vec_len, dtype=np.int_)
+ *                 mask_left = get_mask_int_c(feature_vec_node.astype(np.int_),
  */
       __pyx_t_9 = PyObject_Length(__pyx_v_fs_array); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 509, __pyx_L1_error)
       __pyx_v_lsplit_len = __pyx_t_9;
 
       /* "structureboost/structure_dt.pyx":510
  *                 vec_len = len(feature_vec_node)
  *                 lsplit_len = len(fs_array)
- *                 mask_left = np.zeros(vec_len, dtype=np.int64)             # <<<<<<<<<<<<<<
- *                 mask_left = get_mask_int_c(feature_vec_node.astype(np.int64),
+ *                 mask_left = np.zeros(vec_len, dtype=np.int_)             # <<<<<<<<<<<<<<
+ *                 mask_left = get_mask_int_c(feature_vec_node.astype(np.int_),
  *                                                fs_array, vec_len, lsplit_len,
  */
       __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 510, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 510, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -15975,41 +15966,41 @@
       __Pyx_GIVEREF(__pyx_t_3);
       PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_3);
       __pyx_t_3 = 0;
       __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 510, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 510, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 510, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 510, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 510, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_12, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 510, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_XDECREF_SET(__pyx_v_mask_left, __pyx_t_2);
       __pyx_t_2 = 0;
 
       /* "structureboost/structure_dt.pyx":511
  *                 lsplit_len = len(fs_array)
- *                 mask_left = np.zeros(vec_len, dtype=np.int64)
- *                 mask_left = get_mask_int_c(feature_vec_node.astype(np.int64),             # <<<<<<<<<<<<<<
+ *                 mask_left = np.zeros(vec_len, dtype=np.int_)
+ *                 mask_left = get_mask_int_c(feature_vec_node.astype(np.int_),             # <<<<<<<<<<<<<<
  *                                                fs_array, vec_len, lsplit_len,
  *                                                mask_left)
  */
       __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_get_mask_int_c); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 511, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_feature_vec_node, __pyx_n_s_astype); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 511, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 511, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 511, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 511, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_8))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_8);
         if (likely(__pyx_t_1)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
@@ -16022,27 +16013,27 @@
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 511, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
       /* "structureboost/structure_dt.pyx":512
- *                 mask_left = np.zeros(vec_len, dtype=np.int64)
- *                 mask_left = get_mask_int_c(feature_vec_node.astype(np.int64),
+ *                 mask_left = np.zeros(vec_len, dtype=np.int_)
+ *                 mask_left = get_mask_int_c(feature_vec_node.astype(np.int_),
  *                                                fs_array, vec_len, lsplit_len,             # <<<<<<<<<<<<<<
  *                                                mask_left)
  *             else:
  */
       __pyx_t_8 = PyInt_FromSsize_t(__pyx_v_vec_len); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 512, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __pyx_t_10 = PyInt_FromSsize_t(__pyx_v_lsplit_len); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 512, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
 
       /* "structureboost/structure_dt.pyx":513
- *                 mask_left = get_mask_int_c(feature_vec_node.astype(np.int64),
+ *                 mask_left = get_mask_int_c(feature_vec_node.astype(np.int_),
  *                                                fs_array, vec_len, lsplit_len,
  *                                                mask_left)             # <<<<<<<<<<<<<<
  *             else:
  *                 mask_left = get_mask(feature_vec_node, left_split)
  */
       __pyx_t_1 = NULL;
       __pyx_t_11 = 0;
@@ -16108,15 +16099,15 @@
       __pyx_t_2 = 0;
 
       /* "structureboost/structure_dt.pyx":505
  *             left_split = curr_partition[0]
  *             right_split = curr_partition[1]
  *             if is_integer_valued:             # <<<<<<<<<<<<<<
  *                 fs_array = np.fromiter(left_split, int,
- *                                        len(left_split)).astype(np.int64)
+ *                                        len(left_split)).astype(np.int_)
  */
       goto __pyx_L7;
     }
 
     /* "structureboost/structure_dt.pyx":515
  *                                                mask_left)
  *             else:
@@ -17151,43 +17142,43 @@
   }
 
   /* "structureboost/structure_dt.pyx":560
  *         # Map data points to regions
  * 
  *         num_query_pts = data_array.shape[0]             # <<<<<<<<<<<<<<
  *         num_vor_dims = data_array.shape[1]
- *         feature_vec_node = np.zeros(num_query_pts,dtype=np.int64)
+ *         feature_vec_node = np.zeros(num_query_pts,dtype=np.int_)
  */
   __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_data_array, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 560, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 560, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_num_query_pts = __pyx_t_7;
   __pyx_t_7 = 0;
 
   /* "structureboost/structure_dt.pyx":561
  * 
  *         num_query_pts = data_array.shape[0]
  *         num_vor_dims = data_array.shape[1]             # <<<<<<<<<<<<<<
- *         feature_vec_node = np.zeros(num_query_pts,dtype=np.int64)
+ *         feature_vec_node = np.zeros(num_query_pts,dtype=np.int_)
  *         feature_vec_node = map_to_nn_point_index(vor_pts,
  */
   __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_data_array, __pyx_n_s_shape); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 561, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 561, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_num_vor_dims = __pyx_t_1;
   __pyx_t_1 = 0;
 
   /* "structureboost/structure_dt.pyx":562
  *         num_query_pts = data_array.shape[0]
  *         num_vor_dims = data_array.shape[1]
- *         feature_vec_node = np.zeros(num_query_pts,dtype=np.int64)             # <<<<<<<<<<<<<<
+ *         feature_vec_node = np.zeros(num_query_pts,dtype=np.int_)             # <<<<<<<<<<<<<<
  *         feature_vec_node = map_to_nn_point_index(vor_pts,
  *                                          data_array,
  */
   __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
@@ -17197,30 +17188,30 @@
   __Pyx_INCREF(__pyx_v_num_query_pts);
   __Pyx_GIVEREF(__pyx_v_num_query_pts);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_num_query_pts);
   __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_int64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 562, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_int); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_feature_vec_node = __pyx_t_2;
   __pyx_t_2 = 0;
 
   /* "structureboost/structure_dt.pyx":563
  *         num_vor_dims = data_array.shape[1]
- *         feature_vec_node = np.zeros(num_query_pts,dtype=np.int64)
+ *         feature_vec_node = np.zeros(num_query_pts,dtype=np.int_)
  *         feature_vec_node = map_to_nn_point_index(vor_pts,             # <<<<<<<<<<<<<<
  *                                          data_array,
  *                                          feature_vec_node,
  */
   __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_map_to_nn_point_index); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 563, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
 
@@ -18926,15 +18917,15 @@
   __Pyx_TraceCall("get_gh_val_mat", __pyx_f[0], 638, 0, __PYX_ERR(0, 638, __pyx_L1_error));
 
   /* "structureboost/structure_dt.pyx":640
  *     def get_gh_val_mat(self, feature_vec_node,g_h_train_node,
  *                        max_num_vertices):
  *         g_h_val_arr = np.zeros((max_num_vertices,2))             # <<<<<<<<<<<<<<
  *         g_h_val_arr = get_g_h_feature_sum_arrays(
- *                                             feature_vec_node.astype(np.int64),
+ *                                             feature_vec_node.astype(np.int_),
  */
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 640, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 640, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 640, __pyx_L1_error)
@@ -18964,32 +18955,32 @@
   __pyx_v_g_h_val_arr = __pyx_t_1;
   __pyx_t_1 = 0;
 
   /* "structureboost/structure_dt.pyx":641
  *                        max_num_vertices):
  *         g_h_val_arr = np.zeros((max_num_vertices,2))
  *         g_h_val_arr = get_g_h_feature_sum_arrays(             # <<<<<<<<<<<<<<
- *                                             feature_vec_node.astype(np.int64),
+ *                                             feature_vec_node.astype(np.int_),
  *                                             g_h_train_node,
  */
   __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_get_g_h_feature_sum_arrays); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 641, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
 
   /* "structureboost/structure_dt.pyx":642
  *         g_h_val_arr = np.zeros((max_num_vertices,2))
  *         g_h_val_arr = get_g_h_feature_sum_arrays(
- *                                             feature_vec_node.astype(np.int64),             # <<<<<<<<<<<<<<
+ *                                             feature_vec_node.astype(np.int_),             # <<<<<<<<<<<<<<
  *                                             g_h_train_node,
  *                                             g_h_val_arr)
  */
   __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_feature_vec_node, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 642, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 642, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 642, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 642, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -19002,15 +18993,15 @@
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 642, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
   /* "structureboost/structure_dt.pyx":644
- *                                             feature_vec_node.astype(np.int64),
+ *                                             feature_vec_node.astype(np.int_),
  *                                             g_h_train_node,
  *                                             g_h_val_arr)             # <<<<<<<<<<<<<<
  *         return g_h_val_arr
  * 
  */
   __pyx_t_4 = NULL;
   __pyx_t_7 = 0;
@@ -22037,15 +22028,15 @@
   return __pyx_r;
 }
 
 /* "structureboost/structure_dt.pyx":767
  * 
  * 
  *     def get_prediction(self, tree_node, X_te, dict col_to_int_dict):             # <<<<<<<<<<<<<<
- *         cdef np.ndarray[dtype_int64_t] ind_subset_left, ind_subset_right
+ *         cdef np.ndarray[np.int_t] ind_subset_left, ind_subset_right
  *         cdef long vec_len, lsize
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_12structure_dt_21StructureDecisionTree_61get_prediction(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_12structure_dt_21StructureDecisionTree_61get_prediction = {"get_prediction", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_12structure_dt_21StructureDecisionTree_61get_prediction, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_14structureboost_12structure_dt_21StructureDecisionTree_61get_prediction(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
@@ -22338,25 +22329,25 @@
     __pyx_t_1 = 0;
 
     /* "structureboost/structure_dt.pyx":776
  *         else:
  *             split_bool = get_node_response_df_val(X_te, tree_node, col_to_int_dict)
  *             vec_len = len(split_bool)             # <<<<<<<<<<<<<<
  *             next_vec = np.zeros(vec_len)
- *             ind_subset_left = np.empty(vec_len, dtype=np.int64)
+ *             ind_subset_left = np.empty(vec_len, dtype=np.int_)
  */
     __pyx_t_8 = PyObject_Length(__pyx_v_split_bool); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 776, __pyx_L1_error)
     __pyx_v_vec_len = __pyx_t_8;
 
     /* "structureboost/structure_dt.pyx":777
  *             split_bool = get_node_response_df_val(X_te, tree_node, col_to_int_dict)
  *             vec_len = len(split_bool)
  *             next_vec = np.zeros(vec_len)             # <<<<<<<<<<<<<<
- *             ind_subset_left = np.empty(vec_len, dtype=np.int64)
- *             ind_subset_right = np.empty(vec_len, dtype=np.int64)
+ *             ind_subset_left = np.empty(vec_len, dtype=np.int_)
+ *             ind_subset_right = np.empty(vec_len, dtype=np.int_)
  */
     __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 777, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 777, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_vec_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 777, __pyx_L1_error)
@@ -22399,16 +22390,16 @@
     __pyx_t_9 = 0;
     __pyx_v_next_vec = ((PyArrayObject *)__pyx_t_1);
     __pyx_t_1 = 0;
 
     /* "structureboost/structure_dt.pyx":778
  *             vec_len = len(split_bool)
  *             next_vec = np.zeros(vec_len)
- *             ind_subset_left = np.empty(vec_len, dtype=np.int64)             # <<<<<<<<<<<<<<
- *             ind_subset_right = np.empty(vec_len, dtype=np.int64)
+ *             ind_subset_left = np.empty(vec_len, dtype=np.int_)             # <<<<<<<<<<<<<<
+ *             ind_subset_right = np.empty(vec_len, dtype=np.int_)
  *             ind_subset_left, ind_subset_right, lsize = separate_indices(
  */
     __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 778, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 778, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -22419,33 +22410,33 @@
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
     __pyx_t_1 = 0;
     __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 778, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 778, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_int64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_int); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 778, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 778, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 778, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 778, __pyx_L1_error)
     __pyx_t_13 = ((PyArrayObject *)__pyx_t_4);
     {
       __Pyx_BufFmt_StackElem __pyx_stack[1];
       __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer);
-      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
       if (unlikely(__pyx_t_6 < 0)) {
         PyErr_Fetch(&__pyx_t_12, &__pyx_t_11, &__pyx_t_10);
-        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_left, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_left, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
           Py_XDECREF(__pyx_t_12); Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10);
           __Pyx_RaiseBufferFallbackError();
         } else {
           PyErr_Restore(__pyx_t_12, __pyx_t_11, __pyx_t_10);
         }
         __pyx_t_12 = __pyx_t_11 = __pyx_t_10 = 0;
       }
@@ -22454,16 +22445,16 @@
     }
     __pyx_t_13 = 0;
     __pyx_v_ind_subset_left = ((PyArrayObject *)__pyx_t_4);
     __pyx_t_4 = 0;
 
     /* "structureboost/structure_dt.pyx":779
  *             next_vec = np.zeros(vec_len)
- *             ind_subset_left = np.empty(vec_len, dtype=np.int64)
- *             ind_subset_right = np.empty(vec_len, dtype=np.int64)             # <<<<<<<<<<<<<<
+ *             ind_subset_left = np.empty(vec_len, dtype=np.int_)
+ *             ind_subset_right = np.empty(vec_len, dtype=np.int_)             # <<<<<<<<<<<<<<
  *             ind_subset_left, ind_subset_right, lsize = separate_indices(
  *                                                     ind_subset_left,
  */
     __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 779, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 779, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
@@ -22475,33 +22466,33 @@
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
     __pyx_t_4 = 0;
     __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 779, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 779, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 779, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 779, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 779, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 779, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 779, __pyx_L1_error)
     __pyx_t_13 = ((PyArrayObject *)__pyx_t_7);
     {
       __Pyx_BufFmt_StackElem __pyx_stack[1];
       __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer);
-      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
       if (unlikely(__pyx_t_6 < 0)) {
         PyErr_Fetch(&__pyx_t_10, &__pyx_t_11, &__pyx_t_12);
-        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_right, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_right, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
           Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_12);
           __Pyx_RaiseBufferFallbackError();
         } else {
           PyErr_Restore(__pyx_t_10, __pyx_t_11, __pyx_t_12);
         }
         __pyx_t_10 = __pyx_t_11 = __pyx_t_12 = 0;
       }
@@ -22509,35 +22500,35 @@
       if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 779, __pyx_L1_error)
     }
     __pyx_t_13 = 0;
     __pyx_v_ind_subset_right = ((PyArrayObject *)__pyx_t_7);
     __pyx_t_7 = 0;
 
     /* "structureboost/structure_dt.pyx":780
- *             ind_subset_left = np.empty(vec_len, dtype=np.int64)
- *             ind_subset_right = np.empty(vec_len, dtype=np.int64)
+ *             ind_subset_left = np.empty(vec_len, dtype=np.int_)
+ *             ind_subset_right = np.empty(vec_len, dtype=np.int_)
  *             ind_subset_left, ind_subset_right, lsize = separate_indices(             # <<<<<<<<<<<<<<
  *                                                     ind_subset_left,
  *                                                     ind_subset_right,
  */
     __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_separate_indices); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 780, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
 
     /* "structureboost/structure_dt.pyx":783
  *                                                     ind_subset_left,
  *                                                     ind_subset_right,
- *                                                     split_bool.astype(np.int64),             # <<<<<<<<<<<<<<
+ *                                                     split_bool.astype(np.int_),             # <<<<<<<<<<<<<<
  *                                                     vec_len)
  *             ind_subset_left = ind_subset_left[:lsize]
  */
     __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_split_bool, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 783, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 783, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int64); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 783, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 783, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -22551,15 +22542,15 @@
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 783, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
     /* "structureboost/structure_dt.pyx":784
  *                                                     ind_subset_right,
- *                                                     split_bool.astype(np.int64),
+ *                                                     split_bool.astype(np.int_),
  *                                                     vec_len)             # <<<<<<<<<<<<<<
  *             ind_subset_left = ind_subset_left[:lsize]
  *             ind_subset_right = ind_subset_right[:(vec_len-lsize)]
  */
     __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_vec_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 784, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_14 = NULL;
@@ -22668,32 +22659,32 @@
       __pyx_t_15 = NULL;
       if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
       __PYX_ERR(0, 780, __pyx_L1_error)
       __pyx_L5_unpacking_done:;
     }
 
     /* "structureboost/structure_dt.pyx":780
- *             ind_subset_left = np.empty(vec_len, dtype=np.int64)
- *             ind_subset_right = np.empty(vec_len, dtype=np.int64)
+ *             ind_subset_left = np.empty(vec_len, dtype=np.int_)
+ *             ind_subset_right = np.empty(vec_len, dtype=np.int_)
  *             ind_subset_left, ind_subset_right, lsize = separate_indices(             # <<<<<<<<<<<<<<
  *                                                     ind_subset_left,
  *                                                     ind_subset_right,
  */
     if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 780, __pyx_L1_error)
     if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 780, __pyx_L1_error)
     __pyx_t_16 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_16 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 780, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_13 = ((PyArrayObject *)__pyx_t_4);
     {
       __Pyx_BufFmt_StackElem __pyx_stack[1];
       __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer);
-      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
       if (unlikely(__pyx_t_6 < 0)) {
         PyErr_Fetch(&__pyx_t_12, &__pyx_t_11, &__pyx_t_10);
-        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_left, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_left, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
           Py_XDECREF(__pyx_t_12); Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10);
           __Pyx_RaiseBufferFallbackError();
         } else {
           PyErr_Restore(__pyx_t_12, __pyx_t_11, __pyx_t_10);
         }
         __pyx_t_12 = __pyx_t_11 = __pyx_t_10 = 0;
       }
@@ -22703,18 +22694,18 @@
     __pyx_t_13 = 0;
     __Pyx_DECREF_SET(__pyx_v_ind_subset_left, ((PyArrayObject *)__pyx_t_4));
     __pyx_t_4 = 0;
     __pyx_t_13 = ((PyArrayObject *)__pyx_t_5);
     {
       __Pyx_BufFmt_StackElem __pyx_stack[1];
       __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer);
-      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
       if (unlikely(__pyx_t_6 < 0)) {
         PyErr_Fetch(&__pyx_t_10, &__pyx_t_11, &__pyx_t_12);
-        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_right, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_right, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
           Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_12);
           __Pyx_RaiseBufferFallbackError();
         } else {
           PyErr_Restore(__pyx_t_10, __pyx_t_11, __pyx_t_12);
         }
         __pyx_t_10 = __pyx_t_11 = __pyx_t_12 = 0;
       }
@@ -22723,15 +22714,15 @@
     }
     __pyx_t_13 = 0;
     __Pyx_DECREF_SET(__pyx_v_ind_subset_right, ((PyArrayObject *)__pyx_t_5));
     __pyx_t_5 = 0;
     __pyx_v_lsize = __pyx_t_16;
 
     /* "structureboost/structure_dt.pyx":785
- *                                                     split_bool.astype(np.int64),
+ *                                                     split_bool.astype(np.int_),
  *                                                     vec_len)
  *             ind_subset_left = ind_subset_left[:lsize]             # <<<<<<<<<<<<<<
  *             ind_subset_right = ind_subset_right[:(vec_len-lsize)]
  * 
  */
     __pyx_t_7 = __Pyx_PyInt_From_long(__pyx_v_lsize); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 785, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
@@ -22742,18 +22733,18 @@
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 785, __pyx_L1_error)
     __pyx_t_13 = ((PyArrayObject *)__pyx_t_7);
     {
       __Pyx_BufFmt_StackElem __pyx_stack[1];
       __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer);
-      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
       if (unlikely(__pyx_t_6 < 0)) {
         PyErr_Fetch(&__pyx_t_12, &__pyx_t_11, &__pyx_t_10);
-        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_left, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_left, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
           Py_XDECREF(__pyx_t_12); Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10);
           __Pyx_RaiseBufferFallbackError();
         } else {
           PyErr_Restore(__pyx_t_12, __pyx_t_11, __pyx_t_10);
         }
         __pyx_t_12 = __pyx_t_11 = __pyx_t_10 = 0;
       }
@@ -22780,18 +22771,18 @@
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 786, __pyx_L1_error)
     __pyx_t_13 = ((PyArrayObject *)__pyx_t_7);
     {
       __Pyx_BufFmt_StackElem __pyx_stack[1];
       __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer);
-      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
       if (unlikely(__pyx_t_6 < 0)) {
         PyErr_Fetch(&__pyx_t_10, &__pyx_t_11, &__pyx_t_12);
-        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_right, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_right, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
           Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_12);
           __Pyx_RaiseBufferFallbackError();
         } else {
           PyErr_Restore(__pyx_t_10, __pyx_t_11, __pyx_t_12);
         }
         __pyx_t_10 = __pyx_t_11 = __pyx_t_12 = 0;
       }
@@ -23063,15 +23054,15 @@
     goto __pyx_L0;
   }
 
   /* "structureboost/structure_dt.pyx":767
  * 
  * 
  *     def get_prediction(self, tree_node, X_te, dict col_to_int_dict):             # <<<<<<<<<<<<<<
- *         cdef np.ndarray[dtype_int64_t] ind_subset_left, ind_subset_right
+ *         cdef np.ndarray[np.int_t] ind_subset_left, ind_subset_right
  *         cdef long vec_len, lsize
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_3);
@@ -25433,15 +25424,15 @@
   return __pyx_r;
 }
 
 /* "structureboost/structure_dt.pyx":898
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * def get_bin_sums_c(np.ndarray[double, ndim=2] g_h_mat,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] bin_result_vec, long out_vec_size):
+ *                    np.ndarray[np.int_t] bin_result_vec, long out_vec_size):
  *     cdef int i
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_12structure_dt_15get_bin_sums_c(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_12structure_dt_15get_bin_sums_c = {"get_bin_sums_c", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_12structure_dt_15get_bin_sums_c, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_14structureboost_12structure_dt_15get_bin_sums_c(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
@@ -25547,15 +25538,15 @@
   PyArrayObject *__pyx_t_6 = NULL;
   int __pyx_t_7;
   int __pyx_t_8;
   int __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   Py_ssize_t __pyx_t_12;
-  __pyx_t_14structureboost_12structure_dt_dtype_int64_t __pyx_t_13;
+  Py_ssize_t __pyx_t_13;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__47)
   __Pyx_RefNannySetupContext("get_bin_sums_c", 0);
   __Pyx_TraceCall("get_bin_sums_c", __pyx_f[0], 898, 0, __PYX_ERR(0, 898, __pyx_L1_error));
   __pyx_pybuffer_g_sum_bins.pybuffer.buf = NULL;
@@ -25577,20 +25568,20 @@
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_h_mat.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_h_mat, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 898, __pyx_L1_error)
   }
   __pyx_pybuffernd_g_h_mat.diminfo[0].strides = __pyx_pybuffernd_g_h_mat.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_g_h_mat.diminfo[0].shape = __pyx_pybuffernd_g_h_mat.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_g_h_mat.diminfo[1].strides = __pyx_pybuffernd_g_h_mat.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_g_h_mat.diminfo[1].shape = __pyx_pybuffernd_g_h_mat.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_bin_result_vec, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 898, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_bin_result_vec, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 898, __pyx_L1_error)
   }
   __pyx_pybuffernd_bin_result_vec.diminfo[0].strides = __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_bin_result_vec.diminfo[0].shape = __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.shape[0];
 
   /* "structureboost/structure_dt.pyx":901
- *                    np.ndarray[dtype_int64_t] bin_result_vec, long out_vec_size):
+ *                    np.ndarray[np.int_t] bin_result_vec, long out_vec_size):
  *     cdef int i
  *     cdef int m = bin_result_vec.shape[0]             # <<<<<<<<<<<<<<
  * 
  *     cdef np.ndarray[double] g_sum_bins = np.zeros(out_vec_size)
  */
   __pyx_v_m = (__pyx_v_bin_result_vec->dimensions[0]);
 
@@ -25700,28 +25691,28 @@
  *         g_sum_bins[bin_result_vec[i]] += g_h_mat[i,0]             # <<<<<<<<<<<<<<
  *         h_sum_bins[bin_result_vec[i]] += g_h_mat[i,1]
  *     return g_sum_bins, h_sum_bins
  */
     __pyx_t_10 = __pyx_v_i;
     __pyx_t_11 = 0;
     __pyx_t_12 = __pyx_v_i;
-    __pyx_t_13 = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_dt_dtype_int64_t *, __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_bin_result_vec.diminfo[0].strides));
+    __pyx_t_13 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_bin_result_vec.diminfo[0].strides));
     *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_g_sum_bins.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_g_sum_bins.diminfo[0].strides) += (*__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_g_h_mat.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_g_h_mat.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_g_h_mat.diminfo[1].strides));
 
     /* "structureboost/structure_dt.pyx":908
  *     for i in range(m):
  *         g_sum_bins[bin_result_vec[i]] += g_h_mat[i,0]
  *         h_sum_bins[bin_result_vec[i]] += g_h_mat[i,1]             # <<<<<<<<<<<<<<
  *     return g_sum_bins, h_sum_bins
  * 
  */
     __pyx_t_11 = __pyx_v_i;
     __pyx_t_10 = 1;
     __pyx_t_12 = __pyx_v_i;
-    __pyx_t_13 = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_dt_dtype_int64_t *, __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_bin_result_vec.diminfo[0].strides));
+    __pyx_t_13 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_bin_result_vec.diminfo[0].strides));
     *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_h_sum_bins.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_h_sum_bins.diminfo[0].strides) += (*__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_g_h_mat.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_g_h_mat.diminfo[0].strides, __pyx_t_10, __pyx_pybuffernd_g_h_mat.diminfo[1].strides));
   }
 
   /* "structureboost/structure_dt.pyx":909
  *         g_sum_bins[bin_result_vec[i]] += g_h_mat[i,0]
  *         h_sum_bins[bin_result_vec[i]] += g_h_mat[i,1]
  *     return g_sum_bins, h_sum_bins             # <<<<<<<<<<<<<<
@@ -25741,15 +25732,15 @@
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* "structureboost/structure_dt.pyx":898
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * def get_bin_sums_c(np.ndarray[double, ndim=2] g_h_mat,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] bin_result_vec, long out_vec_size):
+ *                    np.ndarray[np.int_t] bin_result_vec, long out_vec_size):
  *     cdef int i
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
@@ -27470,15 +27461,15 @@
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* "structureboost/structure_dt.pyx":975
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * def get_g_h_feature_sum_arrays(np.ndarray[dtype_int64_t] feature_vec_node,             # <<<<<<<<<<<<<<
+ * def get_g_h_feature_sum_arrays(np.ndarray[np.int_t] feature_vec_node,             # <<<<<<<<<<<<<<
  *                                np.ndarray[double, ndim=2] g_h_train_node,
  *                                np.ndarray[double, ndim=2] g_h_val_arr):
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_12structure_dt_31get_g_h_feature_sum_arrays(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_12structure_dt_31get_g_h_feature_sum_arrays = {"get_g_h_feature_sum_arrays", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_12structure_dt_31get_g_h_feature_sum_arrays, METH_VARARGS|METH_KEYWORDS, 0};
@@ -27601,15 +27592,15 @@
   __pyx_pybuffernd_g_h_train_node.rcbuffer = &__pyx_pybuffer_g_h_train_node;
   __pyx_pybuffer_g_h_val_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_g_h_val_arr.refcount = 0;
   __pyx_pybuffernd_g_h_val_arr.data = NULL;
   __pyx_pybuffernd_g_h_val_arr.rcbuffer = &__pyx_pybuffer_g_h_val_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer, (PyObject*)__pyx_v_feature_vec_node, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 975, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer, (PyObject*)__pyx_v_feature_vec_node, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 975, __pyx_L1_error)
   }
   __pyx_pybuffernd_feature_vec_node.diminfo[0].strides = __pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_feature_vec_node.diminfo[0].shape = __pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_h_train_node.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_h_train_node, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 975, __pyx_L1_error)
   }
   __pyx_pybuffernd_g_h_train_node.diminfo[0].strides = __pyx_pybuffernd_g_h_train_node.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_g_h_train_node.diminfo[0].shape = __pyx_pybuffernd_g_h_train_node.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_g_h_train_node.diminfo[1].strides = __pyx_pybuffernd_g_h_train_node.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_g_h_train_node.diminfo[1].shape = __pyx_pybuffernd_g_h_train_node.rcbuffer->pybuffer.shape[1];
@@ -27645,15 +27636,15 @@
  *     cdef long array_size = len(feature_vec_node)
  *     for i in range(array_size):
  *         ind = feature_vec_node[i]             # <<<<<<<<<<<<<<
  *         g_h_val_arr[ind,0] = g_h_val_arr[ind,0]+g_h_train_node[i,0]
  *         g_h_val_arr[ind,1] = g_h_val_arr[ind,1]+g_h_train_node[i,1]
  */
     __pyx_t_5 = __pyx_v_i;
-    __pyx_v_ind = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_dt_dtype_int64_t *, __pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_feature_vec_node.diminfo[0].strides));
+    __pyx_v_ind = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_feature_vec_node.diminfo[0].strides));
 
     /* "structureboost/structure_dt.pyx":982
  *     for i in range(array_size):
  *         ind = feature_vec_node[i]
  *         g_h_val_arr[ind,0] = g_h_val_arr[ind,0]+g_h_train_node[i,0]             # <<<<<<<<<<<<<<
  *         g_h_val_arr[ind,1] = g_h_val_arr[ind,1]+g_h_train_node[i,1]
  *     return g_h_val_arr
@@ -27693,15 +27684,15 @@
   __Pyx_INCREF(((PyObject *)__pyx_v_g_h_val_arr));
   __pyx_r = ((PyObject *)__pyx_v_g_h_val_arr);
   goto __pyx_L0;
 
   /* "structureboost/structure_dt.pyx":975
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * def get_g_h_feature_sum_arrays(np.ndarray[dtype_int64_t] feature_vec_node,             # <<<<<<<<<<<<<<
+ * def get_g_h_feature_sum_arrays(np.ndarray[np.int_t] feature_vec_node,             # <<<<<<<<<<<<<<
  *                                np.ndarray[double, ndim=2] g_h_train_node,
  *                                np.ndarray[double, ndim=2] g_h_val_arr):
  */
 
   /* function exit code */
   __pyx_L1_error:;
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
@@ -29013,16 +29004,16 @@
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* "structureboost/structure_dt.pyx":1045
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * def get_mask_int_c(np.ndarray[dtype_int64_t] feature_vec_node,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] left_split,
+ * def get_mask_int_c(np.ndarray[np.int_t] feature_vec_node,             # <<<<<<<<<<<<<<
+ *                    np.ndarray[np.int_t] left_split,
  *                    long vec_len, long lsplit_len,
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_12structure_dt_39get_mask_int_c(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_12structure_dt_39get_mask_int_c = {"get_mask_int_c", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_12structure_dt_39get_mask_int_c, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_14structureboost_12structure_dt_39get_mask_int_c(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
@@ -29167,30 +29158,30 @@
   __pyx_pybuffernd_left_split.rcbuffer = &__pyx_pybuffer_left_split;
   __pyx_pybuffer_mask_vec.pybuffer.buf = NULL;
   __pyx_pybuffer_mask_vec.refcount = 0;
   __pyx_pybuffernd_mask_vec.data = NULL;
   __pyx_pybuffernd_mask_vec.rcbuffer = &__pyx_pybuffer_mask_vec;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer, (PyObject*)__pyx_v_feature_vec_node, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1045, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer, (PyObject*)__pyx_v_feature_vec_node, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1045, __pyx_L1_error)
   }
   __pyx_pybuffernd_feature_vec_node.diminfo[0].strides = __pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_feature_vec_node.diminfo[0].shape = __pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_left_split.rcbuffer->pybuffer, (PyObject*)__pyx_v_left_split, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1045, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_left_split.rcbuffer->pybuffer, (PyObject*)__pyx_v_left_split, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1045, __pyx_L1_error)
   }
   __pyx_pybuffernd_left_split.diminfo[0].strides = __pyx_pybuffernd_left_split.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_left_split.diminfo[0].shape = __pyx_pybuffernd_left_split.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_mask_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_mask_vec, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1045, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_mask_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_mask_vec, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1045, __pyx_L1_error)
   }
   __pyx_pybuffernd_mask_vec.diminfo[0].strides = __pyx_pybuffernd_mask_vec.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_mask_vec.diminfo[0].shape = __pyx_pybuffernd_mask_vec.rcbuffer->pybuffer.shape[0];
 
   /* "structureboost/structure_dt.pyx":1050
- *                    np.ndarray[dtype_int64_t] mask_vec):
+ *                    np.ndarray[np.int_t] mask_vec):
  *     cdef int i, j
  *     for i in range(vec_len):             # <<<<<<<<<<<<<<
  *         for j in range(lsplit_len):
  *             if feature_vec_node[i] == left_split[j]:
  */
   __pyx_t_1 = __pyx_v_vec_len;
   __pyx_t_2 = __pyx_t_1;
@@ -29214,26 +29205,26 @@
  *         for j in range(lsplit_len):
  *             if feature_vec_node[i] == left_split[j]:             # <<<<<<<<<<<<<<
  *                 mask_vec[i] = 1
  *                 break
  */
       __pyx_t_7 = __pyx_v_i;
       __pyx_t_8 = __pyx_v_j;
-      __pyx_t_9 = (((*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_dt_dtype_int64_t *, __pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_feature_vec_node.diminfo[0].strides)) == (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_dt_dtype_int64_t *, __pyx_pybuffernd_left_split.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_left_split.diminfo[0].strides))) != 0);
+      __pyx_t_9 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_feature_vec_node.diminfo[0].strides)) == (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_left_split.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_left_split.diminfo[0].strides))) != 0);
       if (__pyx_t_9) {
 
         /* "structureboost/structure_dt.pyx":1053
  *         for j in range(lsplit_len):
  *             if feature_vec_node[i] == left_split[j]:
  *                 mask_vec[i] = 1             # <<<<<<<<<<<<<<
  *                 break
  *     return mask_vec.astype(bool)
  */
         __pyx_t_8 = __pyx_v_i;
-        *__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_dt_dtype_int64_t *, __pyx_pybuffernd_mask_vec.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_mask_vec.diminfo[0].strides) = 1;
+        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_mask_vec.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_mask_vec.diminfo[0].strides) = 1;
 
         /* "structureboost/structure_dt.pyx":1054
  *             if feature_vec_node[i] == left_split[j]:
  *                 mask_vec[i] = 1
  *                 break             # <<<<<<<<<<<<<<
  *     return mask_vec.astype(bool)
  * 
@@ -29280,16 +29271,16 @@
   __pyx_r = __pyx_t_10;
   __pyx_t_10 = 0;
   goto __pyx_L0;
 
   /* "structureboost/structure_dt.pyx":1045
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * def get_mask_int_c(np.ndarray[dtype_int64_t] feature_vec_node,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] left_split,
+ * def get_mask_int_c(np.ndarray[np.int_t] feature_vec_node,             # <<<<<<<<<<<<<<
+ *                    np.ndarray[np.int_t] left_split,
  *                    long vec_len, long lsplit_len,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_10);
   __Pyx_XDECREF(__pyx_t_11);
@@ -29315,16 +29306,16 @@
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* "structureboost/structure_dt.pyx":1060
  * @cython.boundscheck(False)
  * @cython.wraparound(False)
- * def separate_indices(np.ndarray[dtype_int64_t] a, np.ndarray[dtype_int64_t] b,             # <<<<<<<<<<<<<<
- *                      np.ndarray[dtype_int64_t] c, long vec_len):
+ * def separate_indices(np.ndarray[np.int_t] a, np.ndarray[np.int_t] b,             # <<<<<<<<<<<<<<
+ *                      np.ndarray[np.int_t] c, long vec_len):
  *     cdef long ind_a = 0, ind_b = 0, i
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_12structure_dt_41separate_indices(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_12structure_dt_41separate_indices = {"separate_indices", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_12structure_dt_41separate_indices, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_14structureboost_12structure_dt_41separate_indices(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
@@ -29454,40 +29445,40 @@
   __pyx_pybuffernd_b.rcbuffer = &__pyx_pybuffer_b;
   __pyx_pybuffer_c.pybuffer.buf = NULL;
   __pyx_pybuffer_c.refcount = 0;
   __pyx_pybuffernd_c.data = NULL;
   __pyx_pybuffernd_c.rcbuffer = &__pyx_pybuffer_c;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1060, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_a.rcbuffer->pybuffer, (PyObject*)__pyx_v_a, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1060, __pyx_L1_error)
   }
   __pyx_pybuffernd_a.diminfo[0].strides = __pyx_pybuffernd_a.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_a.diminfo[0].shape = __pyx_pybuffernd_a.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_b.rcbuffer->pybuffer, (PyObject*)__pyx_v_b, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1060, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_b.rcbuffer->pybuffer, (PyObject*)__pyx_v_b, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1060, __pyx_L1_error)
   }
   __pyx_pybuffernd_b.diminfo[0].strides = __pyx_pybuffernd_b.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_b.diminfo[0].shape = __pyx_pybuffernd_b.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_c.rcbuffer->pybuffer, (PyObject*)__pyx_v_c, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1060, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_c.rcbuffer->pybuffer, (PyObject*)__pyx_v_c, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1060, __pyx_L1_error)
   }
   __pyx_pybuffernd_c.diminfo[0].strides = __pyx_pybuffernd_c.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_c.diminfo[0].shape = __pyx_pybuffernd_c.rcbuffer->pybuffer.shape[0];
 
   /* "structureboost/structure_dt.pyx":1062
- * def separate_indices(np.ndarray[dtype_int64_t] a, np.ndarray[dtype_int64_t] b,
- *                      np.ndarray[dtype_int64_t] c, long vec_len):
+ * def separate_indices(np.ndarray[np.int_t] a, np.ndarray[np.int_t] b,
+ *                      np.ndarray[np.int_t] c, long vec_len):
  *     cdef long ind_a = 0, ind_b = 0, i             # <<<<<<<<<<<<<<
  *     for i in range(vec_len):
  *         if c[i] == 0:
  */
   __pyx_v_ind_a = 0;
   __pyx_v_ind_b = 0;
 
   /* "structureboost/structure_dt.pyx":1063
- *                      np.ndarray[dtype_int64_t] c, long vec_len):
+ *                      np.ndarray[np.int_t] c, long vec_len):
  *     cdef long ind_a = 0, ind_b = 0, i
  *     for i in range(vec_len):             # <<<<<<<<<<<<<<
  *         if c[i] == 0:
  *             b[ind_b] = i
  */
   __pyx_t_1 = __pyx_v_vec_len;
   __pyx_t_2 = __pyx_t_1;
@@ -29498,26 +29489,26 @@
  *     cdef long ind_a = 0, ind_b = 0, i
  *     for i in range(vec_len):
  *         if c[i] == 0:             # <<<<<<<<<<<<<<
  *             b[ind_b] = i
  *             ind_b = ind_b+1
  */
     __pyx_t_4 = __pyx_v_i;
-    __pyx_t_5 = (((*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_dt_dtype_int64_t *, __pyx_pybuffernd_c.rcbuffer->pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_c.diminfo[0].strides)) == 0) != 0);
+    __pyx_t_5 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_c.rcbuffer->pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_c.diminfo[0].strides)) == 0) != 0);
     if (__pyx_t_5) {
 
       /* "structureboost/structure_dt.pyx":1065
  *     for i in range(vec_len):
  *         if c[i] == 0:
  *             b[ind_b] = i             # <<<<<<<<<<<<<<
  *             ind_b = ind_b+1
  *         else:
  */
       __pyx_t_4 = __pyx_v_ind_b;
-      *__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_dt_dtype_int64_t *, __pyx_pybuffernd_b.rcbuffer->pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_b.diminfo[0].strides) = __pyx_v_i;
+      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_b.rcbuffer->pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_b.diminfo[0].strides) = __pyx_v_i;
 
       /* "structureboost/structure_dt.pyx":1066
  *         if c[i] == 0:
  *             b[ind_b] = i
  *             ind_b = ind_b+1             # <<<<<<<<<<<<<<
  *         else:
  *             a[ind_a] = i
@@ -29539,15 +29530,15 @@
  *         else:
  *             a[ind_a] = i             # <<<<<<<<<<<<<<
  *             ind_a = ind_a+1
  *     return a, b, ind_a
  */
     /*else*/ {
       __pyx_t_4 = __pyx_v_ind_a;
-      *__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_dt_dtype_int64_t *, __pyx_pybuffernd_a.rcbuffer->pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_a.diminfo[0].strides) = __pyx_v_i;
+      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_a.rcbuffer->pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_a.diminfo[0].strides) = __pyx_v_i;
 
       /* "structureboost/structure_dt.pyx":1069
  *         else:
  *             a[ind_a] = i
  *             ind_a = ind_a+1             # <<<<<<<<<<<<<<
  *     return a, b, ind_a
  * 
@@ -29581,16 +29572,16 @@
   __pyx_r = __pyx_t_7;
   __pyx_t_7 = 0;
   goto __pyx_L0;
 
   /* "structureboost/structure_dt.pyx":1060
  * @cython.boundscheck(False)
  * @cython.wraparound(False)
- * def separate_indices(np.ndarray[dtype_int64_t] a, np.ndarray[dtype_int64_t] b,             # <<<<<<<<<<<<<<
- *                      np.ndarray[dtype_int64_t] c, long vec_len):
+ * def separate_indices(np.ndarray[np.int_t] a, np.ndarray[np.int_t] b,             # <<<<<<<<<<<<<<
+ *                      np.ndarray[np.int_t] c, long vec_len):
  *     cdef long ind_a = 0, ind_b = 0, i
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_7);
@@ -29616,15 +29607,15 @@
   return __pyx_r;
 }
 
 /* "structureboost/structure_dt.pyx":1073
  * 
  * 
  * def get_node_response_graphical_int(feature_vec, node):             # <<<<<<<<<<<<<<
- *     # fs_array = np.array(list(node['left_split'])).astype(np.int64)
+ *     # fs_array = np.array(list(node['left_split'])).astype(np.int_)
  *     cdef int vec_len, lsplit_len
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_12structure_dt_43get_node_response_graphical_int(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_12structure_dt_43get_node_response_graphical_int = {"get_node_response_graphical_int", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_12structure_dt_43get_node_response_graphical_int, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_14structureboost_12structure_dt_43get_node_response_graphical_int(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
@@ -29713,29 +29704,29 @@
   __Pyx_RefNannySetupContext("get_node_response_graphical_int", 0);
   __Pyx_TraceCall("get_node_response_graphical_int", __pyx_f[0], 1073, 0, __PYX_ERR(0, 1073, __pyx_L1_error));
 
   /* "structureboost/structure_dt.pyx":1077
  *     cdef int vec_len, lsplit_len
  * 
  *     fs_array = np.fromiter(node['left_split'], int,             # <<<<<<<<<<<<<<
- *                            len(node['left_split'])).astype(np.int64)
+ *                            len(node['left_split'])).astype(np.int_)
  *     vec_len = len(feature_vec)
  */
   __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_fromiter); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_left_split); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
 
   /* "structureboost/structure_dt.pyx":1078
  * 
  *     fs_array = np.fromiter(node['left_split'], int,
- *                            len(node['left_split'])).astype(np.int64)             # <<<<<<<<<<<<<<
+ *                            len(node['left_split'])).astype(np.int_)             # <<<<<<<<<<<<<<
  *     vec_len = len(feature_vec)
  *     lsplit_len = len(fs_array)
  */
   __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_left_split); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_6 = PyObject_Length(__pyx_t_5); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
@@ -29794,15 +29785,15 @@
   }
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int64); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1078, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1078, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -29818,37 +29809,37 @@
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_fs_array = __pyx_t_1;
   __pyx_t_1 = 0;
 
   /* "structureboost/structure_dt.pyx":1079
  *     fs_array = np.fromiter(node['left_split'], int,
- *                            len(node['left_split'])).astype(np.int64)
+ *                            len(node['left_split'])).astype(np.int_)
  *     vec_len = len(feature_vec)             # <<<<<<<<<<<<<<
  *     lsplit_len = len(fs_array)
- *     mask_vec = np.zeros(vec_len, dtype=np.int64)
+ *     mask_vec = np.zeros(vec_len, dtype=np.int_)
  */
   __pyx_t_6 = PyObject_Length(__pyx_v_feature_vec); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1079, __pyx_L1_error)
   __pyx_v_vec_len = __pyx_t_6;
 
   /* "structureboost/structure_dt.pyx":1080
- *                            len(node['left_split'])).astype(np.int64)
+ *                            len(node['left_split'])).astype(np.int_)
  *     vec_len = len(feature_vec)
  *     lsplit_len = len(fs_array)             # <<<<<<<<<<<<<<
- *     mask_vec = np.zeros(vec_len, dtype=np.int64)
- *     mask_vec = get_mask_int_c(feature_vec.astype(np.int64),
+ *     mask_vec = np.zeros(vec_len, dtype=np.int_)
+ *     mask_vec = get_mask_int_c(feature_vec.astype(np.int_),
  */
   __pyx_t_6 = PyObject_Length(__pyx_v_fs_array); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1080, __pyx_L1_error)
   __pyx_v_lsplit_len = __pyx_t_6;
 
   /* "structureboost/structure_dt.pyx":1081
  *     vec_len = len(feature_vec)
  *     lsplit_len = len(fs_array)
- *     mask_vec = np.zeros(vec_len, dtype=np.int64)             # <<<<<<<<<<<<<<
- *     mask_vec = get_mask_int_c(feature_vec.astype(np.int64),
+ *     mask_vec = np.zeros(vec_len, dtype=np.int_)             # <<<<<<<<<<<<<<
+ *     mask_vec = get_mask_int_c(feature_vec.astype(np.int_),
  *                               fs_array, vec_len,
  */
   __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1081, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1081, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -29859,41 +29850,41 @@
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_1);
   __pyx_t_1 = 0;
   __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1081, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1081, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1081, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1081, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1081, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_9, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1081, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_mask_vec = __pyx_t_5;
   __pyx_t_5 = 0;
 
   /* "structureboost/structure_dt.pyx":1082
  *     lsplit_len = len(fs_array)
- *     mask_vec = np.zeros(vec_len, dtype=np.int64)
- *     mask_vec = get_mask_int_c(feature_vec.astype(np.int64),             # <<<<<<<<<<<<<<
+ *     mask_vec = np.zeros(vec_len, dtype=np.int_)
+ *     mask_vec = get_mask_int_c(feature_vec.astype(np.int_),             # <<<<<<<<<<<<<<
  *                               fs_array, vec_len,
  *                               lsplit_len, mask_vec)
  */
   __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_get_mask_int_c); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1082, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_feature_vec, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1082, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1082, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1082, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1082, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -29906,25 +29897,25 @@
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1082, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
   /* "structureboost/structure_dt.pyx":1083
- *     mask_vec = np.zeros(vec_len, dtype=np.int64)
- *     mask_vec = get_mask_int_c(feature_vec.astype(np.int64),
+ *     mask_vec = np.zeros(vec_len, dtype=np.int_)
+ *     mask_vec = get_mask_int_c(feature_vec.astype(np.int_),
  *                               fs_array, vec_len,             # <<<<<<<<<<<<<<
  *                               lsplit_len, mask_vec)
  *     return mask_vec
  */
   __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_vec_len); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1083, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
 
   /* "structureboost/structure_dt.pyx":1084
- *     mask_vec = get_mask_int_c(feature_vec.astype(np.int64),
+ *     mask_vec = get_mask_int_c(feature_vec.astype(np.int_),
  *                               fs_array, vec_len,
  *                               lsplit_len, mask_vec)             # <<<<<<<<<<<<<<
  *     return mask_vec
  * 
  */
   __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_lsplit_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1084, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
@@ -30003,15 +29994,15 @@
   __pyx_r = __pyx_v_mask_vec;
   goto __pyx_L0;
 
   /* "structureboost/structure_dt.pyx":1073
  * 
  * 
  * def get_node_response_graphical_int(feature_vec, node):             # <<<<<<<<<<<<<<
- *     # fs_array = np.array(list(node['left_split'])).astype(np.int64)
+ *     # fs_array = np.array(list(node['left_split'])).astype(np.int_)
  *     cdef int vec_len, lsplit_len
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
@@ -30126,43 +30117,43 @@
   __Pyx_TraceCall("get_node_response_graphical_vor", __pyx_f[0], 1088, 0, __PYX_ERR(0, 1088, __pyx_L1_error));
 
   /* "structureboost/structure_dt.pyx":1089
  * 
  * def get_node_response_graphical_vor(feature_mat, node):
  *     num_query_pts = feature_mat.shape[0]             # <<<<<<<<<<<<<<
  *     num_vor_dims = feature_mat.shape[1]
- *     feature_vec = np.zeros(num_query_pts,dtype=np.int64)
+ *     feature_vec = np.zeros(num_query_pts,dtype=np.int_)
  */
   __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_feature_mat, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1089, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1089, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_num_query_pts = __pyx_t_2;
   __pyx_t_2 = 0;
 
   /* "structureboost/structure_dt.pyx":1090
  * def get_node_response_graphical_vor(feature_mat, node):
  *     num_query_pts = feature_mat.shape[0]
  *     num_vor_dims = feature_mat.shape[1]             # <<<<<<<<<<<<<<
- *     feature_vec = np.zeros(num_query_pts,dtype=np.int64)
+ *     feature_vec = np.zeros(num_query_pts,dtype=np.int_)
  *     feature_vec = map_to_nn_point_index(node['vor_pts'],
  */
   __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_feature_mat, __pyx_n_s_shape); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1090, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_2, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1090, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_num_vor_dims = __pyx_t_1;
   __pyx_t_1 = 0;
 
   /* "structureboost/structure_dt.pyx":1091
  *     num_query_pts = feature_mat.shape[0]
  *     num_vor_dims = feature_mat.shape[1]
- *     feature_vec = np.zeros(num_query_pts,dtype=np.int64)             # <<<<<<<<<<<<<<
+ *     feature_vec = np.zeros(num_query_pts,dtype=np.int_)             # <<<<<<<<<<<<<<
  *     feature_vec = map_to_nn_point_index(node['vor_pts'],
  *                                         feature_mat,
  */
   __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1091, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1091, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
@@ -30172,30 +30163,30 @@
   __Pyx_INCREF(__pyx_v_num_query_pts);
   __Pyx_GIVEREF(__pyx_v_num_query_pts);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_num_query_pts);
   __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1091, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1091, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1091, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1091, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1091, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1091, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_feature_vec = __pyx_t_5;
   __pyx_t_5 = 0;
 
   /* "structureboost/structure_dt.pyx":1092
  *     num_vor_dims = feature_mat.shape[1]
- *     feature_vec = np.zeros(num_query_pts,dtype=np.int64)
+ *     feature_vec = np.zeros(num_query_pts,dtype=np.int_)
  *     feature_vec = map_to_nn_point_index(node['vor_pts'],             # <<<<<<<<<<<<<<
  *                                         feature_mat,
  *                                         feature_vec,
  */
   __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_map_to_nn_point_index); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1092, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_vor_pts); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1092, __pyx_L1_error)
@@ -32647,15 +32638,15 @@
   return __pyx_r;
 }
 
 /* "structureboost/structure_dt.pyx":1165
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * def map_to_nn_point_index(double[:,:] core_pts, double[:,:] query_pts,             # <<<<<<<<<<<<<<
- *                           np.ndarray[dtype_int64_t] out_mat, long num_core_pts,
+ *                           np.ndarray[np.int_t] out_mat, long num_core_pts,
  *                           long num_query_pts, long ndim):
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_12structure_dt_61map_to_nn_point_index(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_12structure_dt_61map_to_nn_point_index = {"map_to_nn_point_index", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_12structure_dt_61map_to_nn_point_index, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_14structureboost_12structure_dt_61map_to_nn_point_index(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
@@ -32804,15 +32795,15 @@
   __Pyx_TraceCall("map_to_nn_point_index", __pyx_f[0], 1165, 0, __PYX_ERR(0, 1165, __pyx_L1_error));
   __pyx_pybuffer_out_mat.pybuffer.buf = NULL;
   __pyx_pybuffer_out_mat.refcount = 0;
   __pyx_pybuffernd_out_mat.data = NULL;
   __pyx_pybuffernd_out_mat.rcbuffer = &__pyx_pybuffer_out_mat;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_out_mat.rcbuffer->pybuffer, (PyObject*)__pyx_v_out_mat, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_dt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1165, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_out_mat.rcbuffer->pybuffer, (PyObject*)__pyx_v_out_mat, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1165, __pyx_L1_error)
   }
   __pyx_pybuffernd_out_mat.diminfo[0].strides = __pyx_pybuffernd_out_mat.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_out_mat.diminfo[0].shape = __pyx_pybuffernd_out_mat.rcbuffer->pybuffer.shape[0];
 
   /* "structureboost/structure_dt.pyx":1170
  *     cdef double curr_dist, tnum, best_dist
  *     cdef int i,j, best_j
  *     for i in range(num_query_pts):             # <<<<<<<<<<<<<<
@@ -32940,15 +32931,15 @@
  *                 best_dist = curr_dist
  *                 best_j = j
  *         out_mat[i] = best_j             # <<<<<<<<<<<<<<
  *     return(out_mat)
  * 
  */
     __pyx_t_13 = __pyx_v_i;
-    *__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_dt_dtype_int64_t *, __pyx_pybuffernd_out_mat.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_out_mat.diminfo[0].strides) = __pyx_v_best_j;
+    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_out_mat.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_out_mat.diminfo[0].strides) = __pyx_v_best_j;
   }
 
   /* "structureboost/structure_dt.pyx":1184
  *                 best_j = j
  *         out_mat[i] = best_j
  *     return(out_mat)             # <<<<<<<<<<<<<<
  * 
@@ -32959,15 +32950,15 @@
   __pyx_r = ((PyObject *)__pyx_v_out_mat);
   goto __pyx_L0;
 
   /* "structureboost/structure_dt.pyx":1165
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * def map_to_nn_point_index(double[:,:] core_pts, double[:,:] query_pts,             # <<<<<<<<<<<<<<
- *                           np.ndarray[dtype_int64_t] out_mat, long num_core_pts,
+ *                           np.ndarray[np.int_t] out_mat, long num_core_pts,
  *                           long num_query_pts, long ndim):
  */
 
   /* function exit code */
   __pyx_L1_error:;
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
     __Pyx_PyThreadState_declare
@@ -48927,15 +48918,15 @@
   {&__pyx_n_s_ind_subset_right, __pyx_k_ind_subset_right, sizeof(__pyx_k_ind_subset_right), 0, 0, 1, 1},
   {&__pyx_n_s_index_range, __pyx_k_index_range, sizeof(__pyx_k_index_range), 0, 0, 1, 1},
   {&__pyx_n_s_inds, __pyx_k_inds, sizeof(__pyx_k_inds), 0, 0, 1, 1},
   {&__pyx_n_s_inf, __pyx_k_inf, sizeof(__pyx_k_inf), 0, 0, 1, 1},
   {&__pyx_n_s_init, __pyx_k_init, sizeof(__pyx_k_init), 0, 0, 1, 1},
   {&__pyx_n_s_init_for_span_trees, __pyx_k_init_for_span_trees, sizeof(__pyx_k_init_for_span_trees), 0, 0, 1, 1},
   {&__pyx_n_s_initialize_best_split_dict, __pyx_k_initialize_best_split_dict, sizeof(__pyx_k_initialize_best_split_dict), 0, 0, 1, 1},
-  {&__pyx_n_s_int64, __pyx_k_int64, sizeof(__pyx_k_int64), 0, 0, 1, 1},
+  {&__pyx_n_s_int, __pyx_k_int, sizeof(__pyx_k_int), 0, 0, 1, 1},
   {&__pyx_n_u_interior, __pyx_k_interior, sizeof(__pyx_k_interior), 0, 1, 0, 1},
   {&__pyx_n_s_interp_mode, __pyx_k_interp_mode, sizeof(__pyx_k_interp_mode), 0, 0, 1, 1},
   {&__pyx_n_u_interp_mode, __pyx_k_interp_mode, sizeof(__pyx_k_interp_mode), 0, 1, 0, 1},
   {&__pyx_n_s_is_integer_valued, __pyx_k_is_integer_valued, sizeof(__pyx_k_is_integer_valued), 0, 0, 1, 1},
   {&__pyx_n_s_isin, __pyx_k_isin, sizeof(__pyx_k_isin), 0, 0, 1, 1},
   {&__pyx_n_s_isnan, __pyx_k_isnan, sizeof(__pyx_k_isnan), 0, 0, 1, 1},
   {&__pyx_n_s_isnull, __pyx_k_isnull, sizeof(__pyx_k_isnull), 0, 0, 1, 1},
@@ -49479,15 +49470,15 @@
   __Pyx_GOTREF(__pyx_tuple__92);
   __Pyx_GIVEREF(__pyx_tuple__92);
   __pyx_tuple__94 = PyTuple_Pack(3, __pyx_int_184977713, __pyx_int_136983863, __pyx_int_112105877); if (unlikely(!__pyx_tuple__94)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__94);
   __Pyx_GIVEREF(__pyx_tuple__94);
 
   /* "structureboost/structure_dt.pyx":19
- * ctypedef np.int64_t dtype_int64_t
+ * # ctypedef np.int64_t dtype_int64_t
  * 
  * class StructureDecisionTree(object):             # <<<<<<<<<<<<<<
  *     """Decision Tree using graphical structure.
  * 
  */
   __pyx_tuple__95 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__95)) __PYX_ERR(0, 19, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__95);
@@ -49865,15 +49856,15 @@
   __Pyx_GIVEREF(__pyx_tuple__129);
   __pyx_codeobj__36 = (PyObject*)__Pyx_PyCode_New(5, 0, 15, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__129, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_pyx, __pyx_n_s_evaluate_feature_onehot, 740, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 740, __pyx_L1_error)
 
   /* "structureboost/structure_dt.pyx":767
  * 
  * 
  *     def get_prediction(self, tree_node, X_te, dict col_to_int_dict):             # <<<<<<<<<<<<<<
- *         cdef np.ndarray[dtype_int64_t] ind_subset_left, ind_subset_right
+ *         cdef np.ndarray[np.int_t] ind_subset_left, ind_subset_right
  *         cdef long vec_len, lsize
  */
   __pyx_tuple__130 = PyTuple_Pack(10, __pyx_n_s_self, __pyx_n_s_tree_node, __pyx_n_s_X_te, __pyx_n_s_col_to_int_dict, __pyx_n_s_ind_subset_left, __pyx_n_s_ind_subset_right, __pyx_n_s_vec_len, __pyx_n_s_lsize, __pyx_n_s_next_vec, __pyx_n_s_split_bool); if (unlikely(!__pyx_tuple__130)) __PYX_ERR(0, 767, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__130);
   __Pyx_GIVEREF(__pyx_tuple__130);
   __pyx_codeobj__37 = (PyObject*)__Pyx_PyCode_New(4, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__130, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_pyx, __pyx_n_s_get_prediction, 767, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__37)) __PYX_ERR(0, 767, __pyx_L1_error)
 
@@ -49985,15 +49976,15 @@
   __Pyx_GIVEREF(__pyx_tuple__139);
   __pyx_codeobj__46 = (PyObject*)__Pyx_PyCode_New(2, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__139, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_pyx, __pyx_n_s_get_best_vals, 888, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__46)) __PYX_ERR(0, 888, __pyx_L1_error)
 
   /* "structureboost/structure_dt.pyx":898
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * def get_bin_sums_c(np.ndarray[double, ndim=2] g_h_mat,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] bin_result_vec, long out_vec_size):
+ *                    np.ndarray[np.int_t] bin_result_vec, long out_vec_size):
  *     cdef int i
  */
   __pyx_tuple__140 = PyTuple_Pack(7, __pyx_n_s_g_h_mat, __pyx_n_s_bin_result_vec, __pyx_n_s_out_vec_size, __pyx_n_s_i, __pyx_n_s_m, __pyx_n_s_g_sum_bins, __pyx_n_s_h_sum_bins); if (unlikely(!__pyx_tuple__140)) __PYX_ERR(0, 898, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__140);
   __Pyx_GIVEREF(__pyx_tuple__140);
   __pyx_codeobj__47 = (PyObject*)__Pyx_PyCode_New(3, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__140, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_pyx, __pyx_n_s_get_bin_sums_c, 898, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__47)) __PYX_ERR(0, 898, __pyx_L1_error)
 
@@ -50080,15 +50071,15 @@
   __Pyx_GOTREF(__pyx_tuple__147);
   __Pyx_GIVEREF(__pyx_tuple__147);
   __pyx_codeobj__56 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__147, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_pyx, __pyx_n_s_get_voronoi_obj, 965, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__56)) __PYX_ERR(0, 965, __pyx_L1_error)
 
   /* "structureboost/structure_dt.pyx":975
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * def get_g_h_feature_sum_arrays(np.ndarray[dtype_int64_t] feature_vec_node,             # <<<<<<<<<<<<<<
+ * def get_g_h_feature_sum_arrays(np.ndarray[np.int_t] feature_vec_node,             # <<<<<<<<<<<<<<
  *                                np.ndarray[double, ndim=2] g_h_train_node,
  *                                np.ndarray[double, ndim=2] g_h_val_arr):
  */
   __pyx_tuple__148 = PyTuple_Pack(6, __pyx_n_s_feature_vec_node, __pyx_n_s_g_h_train_node, __pyx_n_s_g_h_val_arr, __pyx_n_s_i, __pyx_n_s_ind, __pyx_n_s_array_size); if (unlikely(!__pyx_tuple__148)) __PYX_ERR(0, 975, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__148);
   __Pyx_GIVEREF(__pyx_tuple__148);
   __pyx_codeobj__57 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__148, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_pyx, __pyx_n_s_get_g_h_feature_sum_arrays, 975, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__57)) __PYX_ERR(0, 975, __pyx_L1_error)
@@ -50128,40 +50119,40 @@
   __Pyx_GOTREF(__pyx_tuple__151);
   __Pyx_GIVEREF(__pyx_tuple__151);
   __pyx_codeobj__60 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__151, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_pyx, __pyx_n_s_get_mask, 1039, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__60)) __PYX_ERR(0, 1039, __pyx_L1_error)
 
   /* "structureboost/structure_dt.pyx":1045
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * def get_mask_int_c(np.ndarray[dtype_int64_t] feature_vec_node,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] left_split,
+ * def get_mask_int_c(np.ndarray[np.int_t] feature_vec_node,             # <<<<<<<<<<<<<<
+ *                    np.ndarray[np.int_t] left_split,
  *                    long vec_len, long lsplit_len,
  */
   __pyx_tuple__152 = PyTuple_Pack(7, __pyx_n_s_feature_vec_node, __pyx_n_s_left_split, __pyx_n_s_vec_len, __pyx_n_s_lsplit_len, __pyx_n_s_mask_vec, __pyx_n_s_i, __pyx_n_s_j); if (unlikely(!__pyx_tuple__152)) __PYX_ERR(0, 1045, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__152);
   __Pyx_GIVEREF(__pyx_tuple__152);
   __pyx_codeobj__61 = (PyObject*)__Pyx_PyCode_New(5, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__152, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_pyx, __pyx_n_s_get_mask_int_c, 1045, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__61)) __PYX_ERR(0, 1045, __pyx_L1_error)
 
   /* "structureboost/structure_dt.pyx":1060
  * @cython.boundscheck(False)
  * @cython.wraparound(False)
- * def separate_indices(np.ndarray[dtype_int64_t] a, np.ndarray[dtype_int64_t] b,             # <<<<<<<<<<<<<<
- *                      np.ndarray[dtype_int64_t] c, long vec_len):
+ * def separate_indices(np.ndarray[np.int_t] a, np.ndarray[np.int_t] b,             # <<<<<<<<<<<<<<
+ *                      np.ndarray[np.int_t] c, long vec_len):
  *     cdef long ind_a = 0, ind_b = 0, i
  */
   __pyx_tuple__153 = PyTuple_Pack(7, __pyx_n_s_a, __pyx_n_s_b, __pyx_n_s_c, __pyx_n_s_vec_len, __pyx_n_s_ind_a, __pyx_n_s_ind_b, __pyx_n_s_i); if (unlikely(!__pyx_tuple__153)) __PYX_ERR(0, 1060, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__153);
   __Pyx_GIVEREF(__pyx_tuple__153);
   __pyx_codeobj__62 = (PyObject*)__Pyx_PyCode_New(4, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__153, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_pyx, __pyx_n_s_separate_indices, 1060, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__62)) __PYX_ERR(0, 1060, __pyx_L1_error)
 
   /* "structureboost/structure_dt.pyx":1073
  * 
  * 
  * def get_node_response_graphical_int(feature_vec, node):             # <<<<<<<<<<<<<<
- *     # fs_array = np.array(list(node['left_split'])).astype(np.int64)
+ *     # fs_array = np.array(list(node['left_split'])).astype(np.int_)
  *     cdef int vec_len, lsplit_len
  */
   __pyx_tuple__154 = PyTuple_Pack(6, __pyx_n_s_feature_vec, __pyx_n_s_node, __pyx_n_s_vec_len, __pyx_n_s_lsplit_len, __pyx_n_s_fs_array, __pyx_n_s_mask_vec); if (unlikely(!__pyx_tuple__154)) __PYX_ERR(0, 1073, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__154);
   __Pyx_GIVEREF(__pyx_tuple__154);
   __pyx_codeobj__63 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__154, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_pyx, __pyx_n_s_get_node_response_graphical_int, 1073, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__63)) __PYX_ERR(0, 1073, __pyx_L1_error)
 
@@ -50261,15 +50252,15 @@
   __Pyx_GIVEREF(__pyx_tuple__162);
   __pyx_codeobj__71 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__162, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_pyx, __pyx_n_s_ridge_points_to_edge_set, 1159, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__71)) __PYX_ERR(0, 1159, __pyx_L1_error)
 
   /* "structureboost/structure_dt.pyx":1165
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * def map_to_nn_point_index(double[:,:] core_pts, double[:,:] query_pts,             # <<<<<<<<<<<<<<
- *                           np.ndarray[dtype_int64_t] out_mat, long num_core_pts,
+ *                           np.ndarray[np.int_t] out_mat, long num_core_pts,
  *                           long num_query_pts, long ndim):
  */
   __pyx_tuple__163 = PyTuple_Pack(13, __pyx_n_s_core_pts, __pyx_n_s_query_pts, __pyx_n_s_out_mat, __pyx_n_s_num_core_pts, __pyx_n_s_num_query_pts, __pyx_n_s_ndim, __pyx_n_s_curr_dist, __pyx_n_s_tnum, __pyx_n_s_best_dist, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_best_j, __pyx_n_s_k); if (unlikely(!__pyx_tuple__163)) __PYX_ERR(0, 1165, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__163);
   __Pyx_GIVEREF(__pyx_tuple__163);
   __pyx_codeobj__72 = (PyObject*)__Pyx_PyCode_New(6, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__163, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_pyx, __pyx_n_s_map_to_nn_point_index, 1165, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__72)) __PYX_ERR(0, 1165, __pyx_L1_error)
 
@@ -50848,15 +50839,15 @@
  */
   __pyx_t_2 = __Pyx_Import(__pyx_n_s_pandas, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_pd, __pyx_t_2) < 0) __PYX_ERR(0, 11, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "structureboost/structure_dt.pyx":19
- * ctypedef np.int64_t dtype_int64_t
+ * # ctypedef np.int64_t dtype_int64_t
  * 
  * class StructureDecisionTree(object):             # <<<<<<<<<<<<<<
  *     """Decision Tree using graphical structure.
  * 
  */
   __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__95); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 19, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
@@ -51227,15 +51218,15 @@
   if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_evaluate_feature_onehot, __pyx_t_3) < 0) __PYX_ERR(0, 740, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
   /* "structureboost/structure_dt.pyx":767
  * 
  * 
  *     def get_prediction(self, tree_node, X_te, dict col_to_int_dict):             # <<<<<<<<<<<<<<
- *         cdef np.ndarray[dtype_int64_t] ind_subset_left, ind_subset_right
+ *         cdef np.ndarray[np.int_t] ind_subset_left, ind_subset_right
  *         cdef long vec_len, lsize
  */
   __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_dt_21StructureDecisionTree_61get_prediction, 0, __pyx_n_s_StructureDecisionTree_get_predic, NULL, __pyx_n_s_structureboost_structure_dt, __pyx_d, ((PyObject *)__pyx_codeobj__37)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 767, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_get_prediction, __pyx_t_3) < 0) __PYX_ERR(0, 767, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
@@ -51260,15 +51251,15 @@
  */
   __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_dt_21StructureDecisionTree_65_process_feature_configs, 0, __pyx_n_s_StructureDecisionTree__process_f, NULL, __pyx_n_s_structureboost_structure_dt, __pyx_d, ((PyObject *)__pyx_codeobj__39)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 806, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   if (__Pyx_SetNameInClass(__pyx_t_1, __pyx_n_s_process_feature_configs, __pyx_t_3) < 0) __PYX_ERR(0, 806, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
   /* "structureboost/structure_dt.pyx":19
- * ctypedef np.int64_t dtype_int64_t
+ * # ctypedef np.int64_t dtype_int64_t
  * 
  * class StructureDecisionTree(object):             # <<<<<<<<<<<<<<
  *     """Decision Tree using graphical structure.
  * 
  */
   __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_StructureDecisionTree, __pyx_tuple__95, __pyx_t_1, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 19, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
@@ -51361,15 +51352,15 @@
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_best_vals, __pyx_t_2) < 0) __PYX_ERR(0, 888, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "structureboost/structure_dt.pyx":898
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * def get_bin_sums_c(np.ndarray[double, ndim=2] g_h_mat,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] bin_result_vec, long out_vec_size):
+ *                    np.ndarray[np.int_t] bin_result_vec, long out_vec_size):
  *     cdef int i
  */
   __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_dt_15get_bin_sums_c, NULL, __pyx_n_s_structureboost_structure_dt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 898, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_bin_sums_c, __pyx_t_2) < 0) __PYX_ERR(0, 898, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
@@ -51456,15 +51447,15 @@
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_voronoi_obj, __pyx_t_2) < 0) __PYX_ERR(0, 965, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "structureboost/structure_dt.pyx":975
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * def get_g_h_feature_sum_arrays(np.ndarray[dtype_int64_t] feature_vec_node,             # <<<<<<<<<<<<<<
+ * def get_g_h_feature_sum_arrays(np.ndarray[np.int_t] feature_vec_node,             # <<<<<<<<<<<<<<
  *                                np.ndarray[double, ndim=2] g_h_train_node,
  *                                np.ndarray[double, ndim=2] g_h_val_arr):
  */
   __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_dt_31get_g_h_feature_sum_arrays, NULL, __pyx_n_s_structureboost_structure_dt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 975, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_g_h_feature_sum_arrays, __pyx_t_2) < 0) __PYX_ERR(0, 975, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
@@ -51504,40 +51495,40 @@
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_mask, __pyx_t_2) < 0) __PYX_ERR(0, 1039, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "structureboost/structure_dt.pyx":1045
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * def get_mask_int_c(np.ndarray[dtype_int64_t] feature_vec_node,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] left_split,
+ * def get_mask_int_c(np.ndarray[np.int_t] feature_vec_node,             # <<<<<<<<<<<<<<
+ *                    np.ndarray[np.int_t] left_split,
  *                    long vec_len, long lsplit_len,
  */
   __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_dt_39get_mask_int_c, NULL, __pyx_n_s_structureboost_structure_dt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1045, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_mask_int_c, __pyx_t_2) < 0) __PYX_ERR(0, 1045, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "structureboost/structure_dt.pyx":1060
  * @cython.boundscheck(False)
  * @cython.wraparound(False)
- * def separate_indices(np.ndarray[dtype_int64_t] a, np.ndarray[dtype_int64_t] b,             # <<<<<<<<<<<<<<
- *                      np.ndarray[dtype_int64_t] c, long vec_len):
+ * def separate_indices(np.ndarray[np.int_t] a, np.ndarray[np.int_t] b,             # <<<<<<<<<<<<<<
+ *                      np.ndarray[np.int_t] c, long vec_len):
  *     cdef long ind_a = 0, ind_b = 0, i
  */
   __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_dt_41separate_indices, NULL, __pyx_n_s_structureboost_structure_dt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1060, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_separate_indices, __pyx_t_2) < 0) __PYX_ERR(0, 1060, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "structureboost/structure_dt.pyx":1073
  * 
  * 
  * def get_node_response_graphical_int(feature_vec, node):             # <<<<<<<<<<<<<<
- *     # fs_array = np.array(list(node['left_split'])).astype(np.int64)
+ *     # fs_array = np.array(list(node['left_split'])).astype(np.int_)
  *     cdef int vec_len, lsplit_len
  */
   __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_dt_43get_node_response_graphical_int, NULL, __pyx_n_s_structureboost_structure_dt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1073, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_node_response_graphical_int, __pyx_t_2) < 0) __PYX_ERR(0, 1073, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
@@ -51637,15 +51628,15 @@
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_ridge_points_to_edge_set, __pyx_t_2) < 0) __PYX_ERR(0, 1159, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "structureboost/structure_dt.pyx":1165
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * def map_to_nn_point_index(double[:,:] core_pts, double[:,:] query_pts,             # <<<<<<<<<<<<<<
- *                           np.ndarray[dtype_int64_t] out_mat, long num_core_pts,
+ *                           np.ndarray[np.int_t] out_mat, long num_core_pts,
  *                           long num_query_pts, long ndim):
  */
   __pyx_t_2 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_dt_61map_to_nn_point_index, NULL, __pyx_n_s_structureboost_structure_dt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1165, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_map_to_nn_point_index, __pyx_t_2) < 0) __PYX_ERR(0, 1165, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
```

### Comparing `structureboost-0.4.0/structureboost/structure_dt_multi.c` & `structureboost-0.4.1/structureboost/structure_dt_multi.c`

 * *Files 1% similar despite different names*

```diff
@@ -1208,23 +1208,14 @@
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
-
-/* "structureboost/structure_dt_multi.pyx":19
- * cimport cython
- * 
- * ctypedef np.int64_t dtype_int64_t             # <<<<<<<<<<<<<<
- * 
- * class StructureDecisionTreeMulti(StructureDecisionTree):
- */
-typedef __pyx_t_5numpy_int64_t __pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t;
 /* Declarations.proto */
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     typedef ::std::complex< float > __pyx_t_float_complex;
   #else
     typedef float _Complex __pyx_t_float_complex;
   #endif
@@ -2229,15 +2220,15 @@
 static PyTypeObject *__pyx_ptype_5numpy_character = 0;
 static PyTypeObject *__pyx_ptype_5numpy_ufunc = 0;
 
 /* Module declarations from 'cython' */
 
 /* Module declarations from 'structureboost.structure_dt_multi' */
 static __Pyx_TypeInfo __Pyx_TypeInfo_double = { "double", NULL, sizeof(double), { 0 }, 0, 'R', 0, 0 };
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t = { "dtype_int64_t", NULL, sizeof(__pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t), { 0 }, 0, IS_UNSIGNED(__pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t) ? 'U' : 'I', IS_UNSIGNED(__pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t), 0 };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int_t = { "int_t", NULL, sizeof(__pyx_t_5numpy_int_t), { 0 }, 0, IS_UNSIGNED(__pyx_t_5numpy_int_t) ? 'U' : 'I', IS_UNSIGNED(__pyx_t_5numpy_int_t), 0 };
 #define __Pyx_MODULE_NAME "structureboost.structure_dt_multi"
 extern int __pyx_module_is_main_structureboost__structure_dt_multi;
 int __pyx_module_is_main_structureboost__structure_dt_multi = 0;
 
 /* Implementation of 'structureboost.structure_dt_multi' */
 static PyObject *__pyx_builtin_super;
 static PyObject *__pyx_builtin_range;
@@ -2247,14 +2238,15 @@
 static const char __pyx_k_m[] = "m";
 static const char __pyx_k_np[] = "np";
 static const char __pyx_k_pd[] = "pd";
 static const char __pyx_k_sp[] = "sp";
 static const char __pyx_k_doc[] = "__doc__";
 static const char __pyx_k_ind[] = "ind";
 static const char __pyx_k_inf[] = "inf";
+static const char __pyx_k_int[] = "int_";
 static const char __pyx_k_lni[] = "lni";
 static const char __pyx_k_lvi[] = "lvi";
 static const char __pyx_k_sum[] = "sum";
 static const char __pyx_k_tol[] = "tol";
 static const char __pyx_k_X_te[] = "X_te";
 static const char __pyx_k_axis[] = "axis";
 static const char __pyx_k_copy[] = "copy";
@@ -2269,15 +2261,14 @@
 static const char __pyx_k_dtype[] = "dtype";
 static const char __pyx_k_empty[] = "empty";
 static const char __pyx_k_g_sum[] = "g_sum";
 static const char __pyx_k_g_vec[] = "g_vec";
 static const char __pyx_k_gamma[] = "gamma";
 static const char __pyx_k_h_sum[] = "h_sum";
 static const char __pyx_k_h_vec[] = "h_vec";
-static const char __pyx_k_int64[] = "int64";
 static const char __pyx_k_isnan[] = "isnan";
 static const char __pyx_k_limit[] = "limit";
 static const char __pyx_k_lsize[] = "lsize";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_right[] = "right";
 static const char __pyx_k_scipy[] = "scipy";
@@ -2492,15 +2483,15 @@
 static PyObject *__pyx_n_s_i;
 static PyObject *__pyx_n_s_import;
 static PyObject *__pyx_n_s_ind;
 static PyObject *__pyx_n_s_ind_subset_left;
 static PyObject *__pyx_n_s_ind_subset_right;
 static PyObject *__pyx_n_s_inf;
 static PyObject *__pyx_n_s_init;
-static PyObject *__pyx_n_s_int64;
+static PyObject *__pyx_n_s_int;
 static PyObject *__pyx_n_s_isnan;
 static PyObject *__pyx_n_s_j;
 static PyObject *__pyx_n_u_leaf;
 static PyObject *__pyx_n_s_leaf_vertex_ind;
 static PyObject *__pyx_n_u_left_child;
 static PyObject *__pyx_n_s_left_feat_values;
 static PyObject *__pyx_n_s_limit;
@@ -2619,15 +2610,15 @@
 static PyObject *__pyx_codeobj__14;
 static PyObject *__pyx_codeobj__15;
 static PyObject *__pyx_codeobj__16;
 static PyObject *__pyx_codeobj__17;
 static PyObject *__pyx_codeobj__18;
 /* Late includes */
 
-/* "structureboost/structure_dt_multi.pyx":27
+/* "structureboost/structure_dt_multi.pyx":26
  *     """
  * 
  *     def __init__(self, feature_configs, feature_graphs, num_classes,             # <<<<<<<<<<<<<<
  *                  min_size_split=2,
  *                  max_depth=3, gamma=0, feat_sample_by_node=1,
  */
 
@@ -2688,27 +2679,27 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_feature_configs)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 9, 1); __PYX_ERR(0, 27, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 9, 1); __PYX_ERR(0, 26, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_feature_graphs)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 9, 2); __PYX_ERR(0, 27, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 9, 2); __PYX_ERR(0, 26, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num_classes)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 9, 3); __PYX_ERR(0, 27, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 9, 3); __PYX_ERR(0, 26, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_min_size_split);
           if (value) { values[4] = value; kw_args--; }
         }
@@ -2734,15 +2725,15 @@
         case  8:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reg_lambda);
           if (value) { values[8] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 27, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 26, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  9: values[8] = PyTuple_GET_ITEM(__pyx_args, 8);
         CYTHON_FALLTHROUGH;
         case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
         CYTHON_FALLTHROUGH;
@@ -2768,15 +2759,15 @@
     __pyx_v_max_depth = values[5];
     __pyx_v_gamma = values[6];
     __pyx_v_feat_sample_by_node = values[7];
     __pyx_v_reg_lambda = values[8];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 9, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 27, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 0, 4, 9, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 26, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_dt_multi.StructureDecisionTreeMulti.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti___init__(__pyx_self, __pyx_v_self, __pyx_v_feature_configs, __pyx_v_feature_graphs, __pyx_v_num_classes, __pyx_v_min_size_split, __pyx_v_max_depth, __pyx_v_gamma, __pyx_v_feat_sample_by_node, __pyx_v_reg_lambda);
 
@@ -2793,113 +2784,113 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj_)
   __Pyx_RefNannySetupContext("__init__", 0);
-  __Pyx_TraceCall("__init__", __pyx_f[0], 27, 0, __PYX_ERR(0, 27, __pyx_L1_error));
+  __Pyx_TraceCall("__init__", __pyx_f[0], 26, 0, __PYX_ERR(0, 26, __pyx_L1_error));
 
-  /* "structureboost/structure_dt_multi.pyx":31
+  /* "structureboost/structure_dt_multi.pyx":30
  *                  max_depth=3, gamma=0, feat_sample_by_node=1,
  *                  reg_lambda=1):
  *         super().__init__(feature_configs=feature_configs,             # <<<<<<<<<<<<<<
  *                          min_size_split=min_size_split,
  *                          max_depth=max_depth, gamma=gamma,
  */
   __pyx_t_1 = __Pyx_CyFunction_GetClassObj(__pyx_self);
-  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 31, __pyx_L1_error) }
+  if (!__pyx_t_1) { PyErr_SetString(PyExc_SystemError, "super(): empty __class__ cell"); __PYX_ERR(0, 30, __pyx_L1_error) }
   __Pyx_INCREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 31, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_INCREF(__pyx_v_self);
   __Pyx_GIVEREF(__pyx_v_self);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_self);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 31, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_super, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 30, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 31, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_init); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 31, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 30, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_feature_configs, __pyx_v_feature_configs) < 0) __PYX_ERR(0, 31, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_feature_configs, __pyx_v_feature_configs) < 0) __PYX_ERR(0, 30, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":32
+  /* "structureboost/structure_dt_multi.pyx":31
  *                  reg_lambda=1):
  *         super().__init__(feature_configs=feature_configs,
  *                          min_size_split=min_size_split,             # <<<<<<<<<<<<<<
  *                          max_depth=max_depth, gamma=gamma,
  *                          feat_sample_by_node=feat_sample_by_node,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_min_size_split, __pyx_v_min_size_split) < 0) __PYX_ERR(0, 31, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_min_size_split, __pyx_v_min_size_split) < 0) __PYX_ERR(0, 30, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":33
+  /* "structureboost/structure_dt_multi.pyx":32
  *         super().__init__(feature_configs=feature_configs,
  *                          min_size_split=min_size_split,
  *                          max_depth=max_depth, gamma=gamma,             # <<<<<<<<<<<<<<
  *                          feat_sample_by_node=feat_sample_by_node,
  *                          reg_lambda=reg_lambda,
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_max_depth, __pyx_v_max_depth) < 0) __PYX_ERR(0, 31, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_gamma, __pyx_v_gamma) < 0) __PYX_ERR(0, 31, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_max_depth, __pyx_v_max_depth) < 0) __PYX_ERR(0, 30, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_gamma, __pyx_v_gamma) < 0) __PYX_ERR(0, 30, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":34
+  /* "structureboost/structure_dt_multi.pyx":33
  *                          min_size_split=min_size_split,
  *                          max_depth=max_depth, gamma=gamma,
  *                          feat_sample_by_node=feat_sample_by_node,             # <<<<<<<<<<<<<<
  *                          reg_lambda=reg_lambda,
  *                          feature_graphs=feature_graphs)
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_feat_sample_by_node, __pyx_v_feat_sample_by_node) < 0) __PYX_ERR(0, 31, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_feat_sample_by_node, __pyx_v_feat_sample_by_node) < 0) __PYX_ERR(0, 30, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":35
+  /* "structureboost/structure_dt_multi.pyx":34
  *                          max_depth=max_depth, gamma=gamma,
  *                          feat_sample_by_node=feat_sample_by_node,
  *                          reg_lambda=reg_lambda,             # <<<<<<<<<<<<<<
  *                          feature_graphs=feature_graphs)
  *         self.num_classes = num_classes
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_reg_lambda, __pyx_v_reg_lambda) < 0) __PYX_ERR(0, 31, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_reg_lambda, __pyx_v_reg_lambda) < 0) __PYX_ERR(0, 30, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":36
+  /* "structureboost/structure_dt_multi.pyx":35
  *                          feat_sample_by_node=feat_sample_by_node,
  *                          reg_lambda=reg_lambda,
  *                          feature_graphs=feature_graphs)             # <<<<<<<<<<<<<<
  *         self.num_classes = num_classes
  * 
  */
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_feature_graphs, __pyx_v_feature_graphs) < 0) __PYX_ERR(0, 31, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_feature_graphs, __pyx_v_feature_graphs) < 0) __PYX_ERR(0, 30, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":31
+  /* "structureboost/structure_dt_multi.pyx":30
  *                  max_depth=3, gamma=0, feat_sample_by_node=1,
  *                  reg_lambda=1):
  *         super().__init__(feature_configs=feature_configs,             # <<<<<<<<<<<<<<
  *                          min_size_split=min_size_split,
  *                          max_depth=max_depth, gamma=gamma,
  */
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 31, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_empty_tuple, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 30, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":37
+  /* "structureboost/structure_dt_multi.pyx":36
  *                          reg_lambda=reg_lambda,
  *                          feature_graphs=feature_graphs)
  *         self.num_classes = num_classes             # <<<<<<<<<<<<<<
  * 
  *     def _node_summary_gh(self, g_h_mat):
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_num_classes, __pyx_v_num_classes) < 0) __PYX_ERR(0, 37, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_num_classes, __pyx_v_num_classes) < 0) __PYX_ERR(0, 36, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":27
+  /* "structureboost/structure_dt_multi.pyx":26
  *     """
  * 
  *     def __init__(self, feature_configs, feature_graphs, num_classes,             # <<<<<<<<<<<<<<
  *                  min_size_split=2,
  *                  max_depth=3, gamma=0, feat_sample_by_node=1,
  */
 
@@ -2915,15 +2906,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_dt_multi.pyx":39
+/* "structureboost/structure_dt_multi.pyx":38
  *         self.num_classes = num_classes
  * 
  *     def _node_summary_gh(self, g_h_mat):             # <<<<<<<<<<<<<<
  *         if (g_h_mat.shape[0] == 0):
  *             return np.zeros(self.num_classes)
  */
 
@@ -2958,32 +2949,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g_h_mat)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_node_summary_gh", 1, 2, 2, 1); __PYX_ERR(0, 39, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_node_summary_gh", 1, 2, 2, 1); __PYX_ERR(0, 38, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_node_summary_gh") < 0)) __PYX_ERR(0, 39, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_node_summary_gh") < 0)) __PYX_ERR(0, 38, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_g_h_mat = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_node_summary_gh", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 39, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_node_summary_gh", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 38, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_dt_multi.StructureDecisionTreeMulti._node_summary_gh", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_2_node_summary_gh(__pyx_self, __pyx_v_self, __pyx_v_g_h_mat);
 
@@ -3005,209 +2996,209 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__2)
   __Pyx_RefNannySetupContext("_node_summary_gh", 0);
-  __Pyx_TraceCall("_node_summary_gh", __pyx_f[0], 39, 0, __PYX_ERR(0, 39, __pyx_L1_error));
+  __Pyx_TraceCall("_node_summary_gh", __pyx_f[0], 38, 0, __PYX_ERR(0, 38, __pyx_L1_error));
 
-  /* "structureboost/structure_dt_multi.pyx":40
+  /* "structureboost/structure_dt_multi.pyx":39
  * 
  *     def _node_summary_gh(self, g_h_mat):
  *         if (g_h_mat.shape[0] == 0):             # <<<<<<<<<<<<<<
  *             return np.zeros(self.num_classes)
  *         else:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_g_h_mat, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 40, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_g_h_mat, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 39, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 40, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 39, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_t_2, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 40, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_EqObjC(__pyx_t_2, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 39, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 40, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 39, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_3) {
 
-    /* "structureboost/structure_dt_multi.pyx":41
+    /* "structureboost/structure_dt_multi.pyx":40
  *     def _node_summary_gh(self, g_h_mat):
  *         if (g_h_mat.shape[0] == 0):
  *             return np.zeros(self.num_classes)             # <<<<<<<<<<<<<<
  *         else:
  *             g_vec = np.sum(g_h_mat[:,:self.num_classes], axis=0)
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 41, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 40, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 41, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 40, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 41, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 40, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 41, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 40, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L0;
 
-    /* "structureboost/structure_dt_multi.pyx":40
+    /* "structureboost/structure_dt_multi.pyx":39
  * 
  *     def _node_summary_gh(self, g_h_mat):
  *         if (g_h_mat.shape[0] == 0):             # <<<<<<<<<<<<<<
  *             return np.zeros(self.num_classes)
  *         else:
  */
   }
 
-  /* "structureboost/structure_dt_multi.pyx":43
+  /* "structureboost/structure_dt_multi.pyx":42
  *             return np.zeros(self.num_classes)
  *         else:
  *             g_vec = np.sum(g_h_mat[:,:self.num_classes], axis=0)             # <<<<<<<<<<<<<<
  *             h_vec = np.sum(g_h_mat[:,self.num_classes:2*self.num_classes], axis=0)
  *             out_val = -(g_vec/(h_vec+self.reg_lambda))
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 43, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 42, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 43, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 42, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 43, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 42, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = PySlice_New(Py_None, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 43, __pyx_L1_error)
+    __pyx_t_2 = PySlice_New(Py_None, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 42, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 43, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 42, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_slice__3);
     __Pyx_GIVEREF(__pyx_slice__3);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_slice__3);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
     __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_g_h_mat, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 43, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_g_h_mat, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 42, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 43, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 42, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
     __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 43, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 42, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 43, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 43, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 42, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 42, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_g_vec = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":44
+    /* "structureboost/structure_dt_multi.pyx":43
  *         else:
  *             g_vec = np.sum(g_h_mat[:,:self.num_classes], axis=0)
  *             h_vec = np.sum(g_h_mat[:,self.num_classes:2*self.num_classes], axis=0)             # <<<<<<<<<<<<<<
  *             out_val = -(g_vec/(h_vec+self.reg_lambda))
  *             return(out_val)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 44, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 43, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 44, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 43, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 44, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 43, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 44, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 43, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 44, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 43, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PySlice_New(__pyx_t_5, __pyx_t_4, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 44, __pyx_L1_error)
+    __pyx_t_1 = PySlice_New(__pyx_t_5, __pyx_t_4, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 43, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 44, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 43, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_slice__3);
     __Pyx_GIVEREF(__pyx_slice__3);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_slice__3);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_g_h_mat, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 44, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_g_h_mat, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 43, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 44, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 43, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 44, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 43, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 44, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 44, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 43, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 43, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_v_h_vec = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":45
+    /* "structureboost/structure_dt_multi.pyx":44
  *             g_vec = np.sum(g_h_mat[:,:self.num_classes], axis=0)
  *             h_vec = np.sum(g_h_mat[:,self.num_classes:2*self.num_classes], axis=0)
  *             out_val = -(g_vec/(h_vec+self.reg_lambda))             # <<<<<<<<<<<<<<
  *             return(out_val)
  * 
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_reg_lambda); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 45, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_reg_lambda); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 44, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_1 = PyNumber_Add(__pyx_v_h_vec, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 45, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Add(__pyx_v_h_vec, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 44, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_v_g_vec, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 45, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_v_g_vec, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 44, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Negative(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 45, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Negative(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 44, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_v_out_val = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":46
+    /* "structureboost/structure_dt_multi.pyx":45
  *             h_vec = np.sum(g_h_mat[:,self.num_classes:2*self.num_classes], axis=0)
  *             out_val = -(g_vec/(h_vec+self.reg_lambda))
  *             return(out_val)             # <<<<<<<<<<<<<<
  * 
  *     def _evaluate_numerical_splits(self, feature_vec, g_h_mat,
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_v_out_val);
     __pyx_r = __pyx_v_out_val;
     goto __pyx_L0;
   }
 
-  /* "structureboost/structure_dt_multi.pyx":39
+  /* "structureboost/structure_dt_multi.pyx":38
  *         self.num_classes = num_classes
  * 
  *     def _node_summary_gh(self, g_h_mat):             # <<<<<<<<<<<<<<
  *         if (g_h_mat.shape[0] == 0):
  *             return np.zeros(self.num_classes)
  */
 
@@ -3225,15 +3216,15 @@
   __Pyx_XDECREF(__pyx_v_out_val);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_dt_multi.pyx":48
+/* "structureboost/structure_dt_multi.pyx":47
  *             return(out_val)
  * 
  *     def _evaluate_numerical_splits(self, feature_vec, g_h_mat,             # <<<<<<<<<<<<<<
  *                                    split_vec):
  * 
  */
 
@@ -3274,31 +3265,31 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_feature_vec)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_evaluate_numerical_splits", 1, 4, 4, 1); __PYX_ERR(0, 48, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_evaluate_numerical_splits", 1, 4, 4, 1); __PYX_ERR(0, 47, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g_h_mat)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_evaluate_numerical_splits", 1, 4, 4, 2); __PYX_ERR(0, 48, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_evaluate_numerical_splits", 1, 4, 4, 2); __PYX_ERR(0, 47, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_split_vec)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_evaluate_numerical_splits", 1, 4, 4, 3); __PYX_ERR(0, 48, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_evaluate_numerical_splits", 1, 4, 4, 3); __PYX_ERR(0, 47, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_evaluate_numerical_splits") < 0)) __PYX_ERR(0, 48, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_evaluate_numerical_splits") < 0)) __PYX_ERR(0, 47, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -3307,15 +3298,15 @@
     __pyx_v_self = values[0];
     __pyx_v_feature_vec = values[1];
     __pyx_v_g_h_mat = values[2];
     __pyx_v_split_vec = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_evaluate_numerical_splits", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 48, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_evaluate_numerical_splits", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 47, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_dt_multi.StructureDecisionTreeMulti._evaluate_numerical_splits", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_4_evaluate_numerical_splits(__pyx_self, __pyx_v_self, __pyx_v_feature_vec, __pyx_v_g_h_mat, __pyx_v_split_vec);
 
@@ -3360,115 +3351,115 @@
   int __pyx_t_10;
   int __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__4)
   __Pyx_RefNannySetupContext("_evaluate_numerical_splits", 0);
-  __Pyx_TraceCall("_evaluate_numerical_splits", __pyx_f[0], 48, 0, __PYX_ERR(0, 48, __pyx_L1_error));
+  __Pyx_TraceCall("_evaluate_numerical_splits", __pyx_f[0], 47, 0, __PYX_ERR(0, 47, __pyx_L1_error));
 
-  /* "structureboost/structure_dt_multi.pyx":51
+  /* "structureboost/structure_dt_multi.pyx":50
  *                                    split_vec):
  * 
  *         has_na_vals = np.isnan(split_vec[-1])             # <<<<<<<<<<<<<<
  *         bin_result_vec = np.searchsorted(split_vec,
  *                                          feature_vec,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 51, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 50, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_isnan); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 51, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_isnan); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 50, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_split_vec, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 51, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_split_vec, -1L, long, 1, __Pyx_PyInt_From_long, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 50, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 51, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 50, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_has_na_vals = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":52
+  /* "structureboost/structure_dt_multi.pyx":51
  * 
  *         has_na_vals = np.isnan(split_vec[-1])
  *         bin_result_vec = np.searchsorted(split_vec,             # <<<<<<<<<<<<<<
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)
+ *                                          side='right').astype(np.int_)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 52, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 51, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_searchsorted); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 52, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_searchsorted); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 51, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":53
+  /* "structureboost/structure_dt_multi.pyx":52
  *         has_na_vals = np.isnan(split_vec[-1])
  *         bin_result_vec = np.searchsorted(split_vec,
  *                                          feature_vec,             # <<<<<<<<<<<<<<
- *                                          side='right').astype(np.int64)
+ *                                          side='right').astype(np.int_)
  *         g_sum_bins, h_sum_bins = get_bin_sums_c_mc(g_h_mat,
  */
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 52, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 51, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_split_vec);
   __Pyx_GIVEREF(__pyx_v_split_vec);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_split_vec);
   __Pyx_INCREF(__pyx_v_feature_vec);
   __Pyx_GIVEREF(__pyx_v_feature_vec);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_feature_vec);
 
-  /* "structureboost/structure_dt_multi.pyx":54
+  /* "structureboost/structure_dt_multi.pyx":53
  *         bin_result_vec = np.searchsorted(split_vec,
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)             # <<<<<<<<<<<<<<
+ *                                          side='right').astype(np.int_)             # <<<<<<<<<<<<<<
  *         g_sum_bins, h_sum_bins = get_bin_sums_c_mc(g_h_mat,
  *                                                 bin_result_vec,
  */
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 54, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 53, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_side, __pyx_n_u_right) < 0) __PYX_ERR(0, 54, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_side, __pyx_n_u_right) < 0) __PYX_ERR(0, 53, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":52
+  /* "structureboost/structure_dt_multi.pyx":51
  * 
  *         has_na_vals = np.isnan(split_vec[-1])
  *         bin_result_vec = np.searchsorted(split_vec,             # <<<<<<<<<<<<<<
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)
+ *                                          side='right').astype(np.int_)
  */
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 52, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 51, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":54
+  /* "structureboost/structure_dt_multi.pyx":53
  *         bin_result_vec = np.searchsorted(split_vec,
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)             # <<<<<<<<<<<<<<
+ *                                          side='right').astype(np.int_)             # <<<<<<<<<<<<<<
  *         g_sum_bins, h_sum_bins = get_bin_sums_c_mc(g_h_mat,
  *                                                 bin_result_vec,
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 54, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 53, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 54, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 53, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 54, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 53, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -3476,41 +3467,41 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 53, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_bin_result_vec = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":55
+  /* "structureboost/structure_dt_multi.pyx":54
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)
+ *                                          side='right').astype(np.int_)
  *         g_sum_bins, h_sum_bins = get_bin_sums_c_mc(g_h_mat,             # <<<<<<<<<<<<<<
  *                                                 bin_result_vec,
  *                                                 len(split_vec)+1, self.num_classes)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_get_bin_sums_c_mc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 55, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_get_bin_sums_c_mc); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 54, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
 
-  /* "structureboost/structure_dt_multi.pyx":57
+  /* "structureboost/structure_dt_multi.pyx":56
  *         g_sum_bins, h_sum_bins = get_bin_sums_c_mc(g_h_mat,
  *                                                 bin_result_vec,
  *                                                 len(split_vec)+1, self.num_classes)             # <<<<<<<<<<<<<<
  *         g_sum_total, g_sum_left, g_sum_right = get_left_right_sums_mc(g_sum_bins)
  *         h_sum_total, h_sum_left, h_sum_right = get_left_right_sums_mc(h_sum_bins)
  */
-  __pyx_t_6 = PyObject_Length(__pyx_v_split_vec); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 57, __pyx_L1_error)
-  __pyx_t_3 = PyInt_FromSsize_t((__pyx_t_6 + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 57, __pyx_L1_error)
+  __pyx_t_6 = PyObject_Length(__pyx_v_split_vec); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 56, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t((__pyx_t_6 + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 56, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 57, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 56, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_2 = NULL;
   __pyx_t_7 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -3519,33 +3510,33 @@
       __Pyx_DECREF_SET(__pyx_t_4, function);
       __pyx_t_7 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_4)) {
     PyObject *__pyx_temp[5] = {__pyx_t_2, __pyx_v_g_h_mat, __pyx_v_bin_result_vec, __pyx_t_3, __pyx_t_5};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 55, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
     PyObject *__pyx_temp[5] = {__pyx_t_2, __pyx_v_g_h_mat, __pyx_v_bin_result_vec, __pyx_t_3, __pyx_t_5};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 55, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   {
-    __pyx_t_8 = PyTuple_New(4+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 55, __pyx_L1_error)
+    __pyx_t_8 = PyTuple_New(4+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 54, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     if (__pyx_t_2) {
       __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_2); __pyx_t_2 = NULL;
     }
     __Pyx_INCREF(__pyx_v_g_h_mat);
     __Pyx_GIVEREF(__pyx_v_g_h_mat);
     PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_v_g_h_mat);
@@ -3554,109 +3545,109 @@
     PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_v_bin_result_vec);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_7, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_8, 3+__pyx_t_7, __pyx_t_5);
     __pyx_t_3 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 55, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   }
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
     PyObject* sequence = __pyx_t_1;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 2)) {
       if (size > 2) __Pyx_RaiseTooManyValuesError(2);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(0, 55, __pyx_L1_error)
+      __PYX_ERR(0, 54, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     if (likely(PyTuple_CheckExact(sequence))) {
       __pyx_t_4 = PyTuple_GET_ITEM(sequence, 0); 
       __pyx_t_8 = PyTuple_GET_ITEM(sequence, 1); 
     } else {
       __pyx_t_4 = PyList_GET_ITEM(sequence, 0); 
       __pyx_t_8 = PyList_GET_ITEM(sequence, 1); 
     }
     __Pyx_INCREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_t_8);
     #else
-    __pyx_t_4 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 55, __pyx_L1_error)
+    __pyx_t_4 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 54, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_8 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 55, __pyx_L1_error)
+    __pyx_t_8 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 54, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     #endif
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } else {
     Py_ssize_t index = -1;
-    __pyx_t_5 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 55, __pyx_L1_error)
+    __pyx_t_5 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 54, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_9 = Py_TYPE(__pyx_t_5)->tp_iternext;
     index = 0; __pyx_t_4 = __pyx_t_9(__pyx_t_5); if (unlikely(!__pyx_t_4)) goto __pyx_L3_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_4);
     index = 1; __pyx_t_8 = __pyx_t_9(__pyx_t_5); if (unlikely(!__pyx_t_8)) goto __pyx_L3_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_8);
-    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_5), 2) < 0) __PYX_ERR(0, 55, __pyx_L1_error)
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_5), 2) < 0) __PYX_ERR(0, 54, __pyx_L1_error)
     __pyx_t_9 = NULL;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     goto __pyx_L4_unpacking_done;
     __pyx_L3_unpacking_failed:;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_9 = NULL;
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-    __PYX_ERR(0, 55, __pyx_L1_error)
+    __PYX_ERR(0, 54, __pyx_L1_error)
     __pyx_L4_unpacking_done:;
   }
 
-  /* "structureboost/structure_dt_multi.pyx":55
+  /* "structureboost/structure_dt_multi.pyx":54
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)
+ *                                          side='right').astype(np.int_)
  *         g_sum_bins, h_sum_bins = get_bin_sums_c_mc(g_h_mat,             # <<<<<<<<<<<<<<
  *                                                 bin_result_vec,
  *                                                 len(split_vec)+1, self.num_classes)
  */
   __pyx_v_g_sum_bins = __pyx_t_4;
   __pyx_t_4 = 0;
   __pyx_v_h_sum_bins = __pyx_t_8;
   __pyx_t_8 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":58
+  /* "structureboost/structure_dt_multi.pyx":57
  *                                                 bin_result_vec,
  *                                                 len(split_vec)+1, self.num_classes)
  *         g_sum_total, g_sum_left, g_sum_right = get_left_right_sums_mc(g_sum_bins)             # <<<<<<<<<<<<<<
  *         h_sum_total, h_sum_left, h_sum_right = get_left_right_sums_mc(h_sum_bins)
  *         score_vec = (-1)*_get_gh_score_array_mc(g_sum_left, g_sum_right,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_get_left_right_sums_mc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 58, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_get_left_right_sums_mc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 57, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_8);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_8, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_4, __pyx_v_g_sum_bins) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_v_g_sum_bins);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 58, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 57, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
     PyObject* sequence = __pyx_t_1;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 3)) {
       if (size > 3) __Pyx_RaiseTooManyValuesError(3);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(0, 58, __pyx_L1_error)
+      __PYX_ERR(0, 57, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     if (likely(PyTuple_CheckExact(sequence))) {
       __pyx_t_8 = PyTuple_GET_ITEM(sequence, 0); 
       __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
       __pyx_t_5 = PyTuple_GET_ITEM(sequence, 2); 
     } else {
@@ -3664,83 +3655,83 @@
       __pyx_t_4 = PyList_GET_ITEM(sequence, 1); 
       __pyx_t_5 = PyList_GET_ITEM(sequence, 2); 
     }
     __Pyx_INCREF(__pyx_t_8);
     __Pyx_INCREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_t_5);
     #else
-    __pyx_t_8 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 58, __pyx_L1_error)
+    __pyx_t_8 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 57, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 58, __pyx_L1_error)
+    __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 57, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 58, __pyx_L1_error)
+    __pyx_t_5 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 57, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     #endif
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } else {
     Py_ssize_t index = -1;
-    __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 58, __pyx_L1_error)
+    __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 57, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_9 = Py_TYPE(__pyx_t_3)->tp_iternext;
     index = 0; __pyx_t_8 = __pyx_t_9(__pyx_t_3); if (unlikely(!__pyx_t_8)) goto __pyx_L5_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_8);
     index = 1; __pyx_t_4 = __pyx_t_9(__pyx_t_3); if (unlikely(!__pyx_t_4)) goto __pyx_L5_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_4);
     index = 2; __pyx_t_5 = __pyx_t_9(__pyx_t_3); if (unlikely(!__pyx_t_5)) goto __pyx_L5_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_5);
-    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_3), 3) < 0) __PYX_ERR(0, 58, __pyx_L1_error)
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_3), 3) < 0) __PYX_ERR(0, 57, __pyx_L1_error)
     __pyx_t_9 = NULL;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L6_unpacking_done;
     __pyx_L5_unpacking_failed:;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_9 = NULL;
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-    __PYX_ERR(0, 58, __pyx_L1_error)
+    __PYX_ERR(0, 57, __pyx_L1_error)
     __pyx_L6_unpacking_done:;
   }
   __pyx_v_g_sum_total = __pyx_t_8;
   __pyx_t_8 = 0;
   __pyx_v_g_sum_left = __pyx_t_4;
   __pyx_t_4 = 0;
   __pyx_v_g_sum_right = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":59
+  /* "structureboost/structure_dt_multi.pyx":58
  *                                                 len(split_vec)+1, self.num_classes)
  *         g_sum_total, g_sum_left, g_sum_right = get_left_right_sums_mc(g_sum_bins)
  *         h_sum_total, h_sum_left, h_sum_right = get_left_right_sums_mc(h_sum_bins)             # <<<<<<<<<<<<<<
  *         score_vec = (-1)*_get_gh_score_array_mc(g_sum_left, g_sum_right,
  *                                              h_sum_left, h_sum_right,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_get_left_right_sums_mc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 59, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_get_left_right_sums_mc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 58, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_v_h_sum_bins) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_h_sum_bins);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 59, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 58, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
     PyObject* sequence = __pyx_t_1;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 3)) {
       if (size > 3) __Pyx_RaiseTooManyValuesError(3);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(0, 59, __pyx_L1_error)
+      __PYX_ERR(0, 58, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     if (likely(PyTuple_CheckExact(sequence))) {
       __pyx_t_5 = PyTuple_GET_ITEM(sequence, 0); 
       __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
       __pyx_t_8 = PyTuple_GET_ITEM(sequence, 2); 
     } else {
@@ -3748,72 +3739,72 @@
       __pyx_t_4 = PyList_GET_ITEM(sequence, 1); 
       __pyx_t_8 = PyList_GET_ITEM(sequence, 2); 
     }
     __Pyx_INCREF(__pyx_t_5);
     __Pyx_INCREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_t_8);
     #else
-    __pyx_t_5 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 59, __pyx_L1_error)
+    __pyx_t_5 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 58, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 59, __pyx_L1_error)
+    __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 58, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_8 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 59, __pyx_L1_error)
+    __pyx_t_8 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 58, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     #endif
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } else {
     Py_ssize_t index = -1;
-    __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 59, __pyx_L1_error)
+    __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 58, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_9 = Py_TYPE(__pyx_t_3)->tp_iternext;
     index = 0; __pyx_t_5 = __pyx_t_9(__pyx_t_3); if (unlikely(!__pyx_t_5)) goto __pyx_L7_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_5);
     index = 1; __pyx_t_4 = __pyx_t_9(__pyx_t_3); if (unlikely(!__pyx_t_4)) goto __pyx_L7_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_4);
     index = 2; __pyx_t_8 = __pyx_t_9(__pyx_t_3); if (unlikely(!__pyx_t_8)) goto __pyx_L7_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_8);
-    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_3), 3) < 0) __PYX_ERR(0, 59, __pyx_L1_error)
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_3), 3) < 0) __PYX_ERR(0, 58, __pyx_L1_error)
     __pyx_t_9 = NULL;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     goto __pyx_L8_unpacking_done;
     __pyx_L7_unpacking_failed:;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_9 = NULL;
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-    __PYX_ERR(0, 59, __pyx_L1_error)
+    __PYX_ERR(0, 58, __pyx_L1_error)
     __pyx_L8_unpacking_done:;
   }
   __pyx_v_h_sum_total = __pyx_t_5;
   __pyx_t_5 = 0;
   __pyx_v_h_sum_left = __pyx_t_4;
   __pyx_t_4 = 0;
   __pyx_v_h_sum_right = __pyx_t_8;
   __pyx_t_8 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":60
+  /* "structureboost/structure_dt_multi.pyx":59
  *         g_sum_total, g_sum_left, g_sum_right = get_left_right_sums_mc(g_sum_bins)
  *         h_sum_total, h_sum_left, h_sum_right = get_left_right_sums_mc(h_sum_bins)
  *         score_vec = (-1)*_get_gh_score_array_mc(g_sum_left, g_sum_right,             # <<<<<<<<<<<<<<
  *                                              h_sum_left, h_sum_right,
  *                                              self.gamma, self.reg_lambda)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_get_gh_score_array_mc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 60, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_get_gh_score_array_mc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 59, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
 
-  /* "structureboost/structure_dt_multi.pyx":62
+  /* "structureboost/structure_dt_multi.pyx":61
  *         score_vec = (-1)*_get_gh_score_array_mc(g_sum_left, g_sum_right,
  *                                              h_sum_left, h_sum_right,
  *                                              self.gamma, self.reg_lambda)             # <<<<<<<<<<<<<<
  * 
  *         best_loss, best_split_val = stdt._get_best_vals(score_vec, split_vec)
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_gamma); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 62, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_gamma); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 61, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_reg_lambda); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 62, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_reg_lambda); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 61, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_3 = NULL;
   __pyx_t_7 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_8);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
@@ -3822,33 +3813,33 @@
       __Pyx_DECREF_SET(__pyx_t_8, function);
       __pyx_t_7 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_8)) {
     PyObject *__pyx_temp[7] = {__pyx_t_3, __pyx_v_g_sum_left, __pyx_v_g_sum_right, __pyx_v_h_sum_left, __pyx_v_h_sum_right, __pyx_t_4, __pyx_t_5};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_7, 6+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 60, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_7, 6+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 59, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_8)) {
     PyObject *__pyx_temp[7] = {__pyx_t_3, __pyx_v_g_sum_left, __pyx_v_g_sum_right, __pyx_v_h_sum_left, __pyx_v_h_sum_right, __pyx_t_4, __pyx_t_5};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_7, 6+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 60, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_7, 6+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 59, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   } else
   #endif
   {
-    __pyx_t_2 = PyTuple_New(6+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 60, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(6+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 59, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     if (__pyx_t_3) {
       __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3); __pyx_t_3 = NULL;
     }
     __Pyx_INCREF(__pyx_v_g_sum_left);
     __Pyx_GIVEREF(__pyx_v_g_sum_left);
     PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_7, __pyx_v_g_sum_left);
@@ -3863,43 +3854,43 @@
     PyTuple_SET_ITEM(__pyx_t_2, 3+__pyx_t_7, __pyx_v_h_sum_right);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_2, 4+__pyx_t_7, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_2, 5+__pyx_t_7, __pyx_t_5);
     __pyx_t_4 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 60, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 59, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":60
+  /* "structureboost/structure_dt_multi.pyx":59
  *         g_sum_total, g_sum_left, g_sum_right = get_left_right_sums_mc(g_sum_bins)
  *         h_sum_total, h_sum_left, h_sum_right = get_left_right_sums_mc(h_sum_bins)
  *         score_vec = (-1)*_get_gh_score_array_mc(g_sum_left, g_sum_right,             # <<<<<<<<<<<<<<
  *                                              h_sum_left, h_sum_right,
  *                                              self.gamma, self.reg_lambda)
  */
-  __pyx_t_8 = PyNumber_Multiply(__pyx_int_neg_1, __pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 60, __pyx_L1_error)
+  __pyx_t_8 = PyNumber_Multiply(__pyx_int_neg_1, __pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 59, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_score_vec = __pyx_t_8;
   __pyx_t_8 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":64
+  /* "structureboost/structure_dt_multi.pyx":63
  *                                              self.gamma, self.reg_lambda)
  * 
  *         best_loss, best_split_val = stdt._get_best_vals(score_vec, split_vec)             # <<<<<<<<<<<<<<
  *         if has_na_vals and (len(split_vec) > 2):
  *             g_sum_left_nal = (g_sum_left + (g_sum_total - g_sum_left[-1,:]))[:-1,:]
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_stdt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 64, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_stdt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 63, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_get_best_vals); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 64, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_get_best_vals); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 63, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_1 = NULL;
   __pyx_t_7 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_1)) {
@@ -3909,200 +3900,200 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_7 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_score_vec, __pyx_v_split_vec};
-    __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 64, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 63, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_GOTREF(__pyx_t_8);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_score_vec, __pyx_v_split_vec};
-    __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 64, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 63, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_GOTREF(__pyx_t_8);
   } else
   #endif
   {
-    __pyx_t_5 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 64, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 63, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     if (__pyx_t_1) {
       __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1); __pyx_t_1 = NULL;
     }
     __Pyx_INCREF(__pyx_v_score_vec);
     __Pyx_GIVEREF(__pyx_v_score_vec);
     PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_7, __pyx_v_score_vec);
     __Pyx_INCREF(__pyx_v_split_vec);
     __Pyx_GIVEREF(__pyx_v_split_vec);
     PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_7, __pyx_v_split_vec);
-    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 64, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 63, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if ((likely(PyTuple_CheckExact(__pyx_t_8))) || (PyList_CheckExact(__pyx_t_8))) {
     PyObject* sequence = __pyx_t_8;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 2)) {
       if (size > 2) __Pyx_RaiseTooManyValuesError(2);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(0, 64, __pyx_L1_error)
+      __PYX_ERR(0, 63, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     if (likely(PyTuple_CheckExact(sequence))) {
       __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
       __pyx_t_5 = PyTuple_GET_ITEM(sequence, 1); 
     } else {
       __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
       __pyx_t_5 = PyList_GET_ITEM(sequence, 1); 
     }
     __Pyx_INCREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_t_5);
     #else
-    __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 64, __pyx_L1_error)
+    __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 63, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 64, __pyx_L1_error)
+    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 63, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     #endif
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   } else {
     Py_ssize_t index = -1;
-    __pyx_t_1 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 64, __pyx_L1_error)
+    __pyx_t_1 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 63, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __pyx_t_9 = Py_TYPE(__pyx_t_1)->tp_iternext;
     index = 0; __pyx_t_2 = __pyx_t_9(__pyx_t_1); if (unlikely(!__pyx_t_2)) goto __pyx_L9_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_2);
     index = 1; __pyx_t_5 = __pyx_t_9(__pyx_t_1); if (unlikely(!__pyx_t_5)) goto __pyx_L9_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_5);
-    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_1), 2) < 0) __PYX_ERR(0, 64, __pyx_L1_error)
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_1), 2) < 0) __PYX_ERR(0, 63, __pyx_L1_error)
     __pyx_t_9 = NULL;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     goto __pyx_L10_unpacking_done;
     __pyx_L9_unpacking_failed:;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_9 = NULL;
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-    __PYX_ERR(0, 64, __pyx_L1_error)
+    __PYX_ERR(0, 63, __pyx_L1_error)
     __pyx_L10_unpacking_done:;
   }
   __pyx_v_best_loss = __pyx_t_2;
   __pyx_t_2 = 0;
   __pyx_v_best_split_val = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":65
+  /* "structureboost/structure_dt_multi.pyx":64
  * 
  *         best_loss, best_split_val = stdt._get_best_vals(score_vec, split_vec)
  *         if has_na_vals and (len(split_vec) > 2):             # <<<<<<<<<<<<<<
  *             g_sum_left_nal = (g_sum_left + (g_sum_total - g_sum_left[-1,:]))[:-1,:]
  *             h_sum_left_nal = (h_sum_left + (h_sum_total - h_sum_left[-1,:]))[:-1,:]
  */
-  __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_v_has_na_vals); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 65, __pyx_L1_error)
+  __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_v_has_na_vals); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 64, __pyx_L1_error)
   if (__pyx_t_11) {
   } else {
     __pyx_t_10 = __pyx_t_11;
     goto __pyx_L12_bool_binop_done;
   }
-  __pyx_t_6 = PyObject_Length(__pyx_v_split_vec); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 65, __pyx_L1_error)
+  __pyx_t_6 = PyObject_Length(__pyx_v_split_vec); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 64, __pyx_L1_error)
   __pyx_t_11 = ((__pyx_t_6 > 2) != 0);
   __pyx_t_10 = __pyx_t_11;
   __pyx_L12_bool_binop_done:;
   if (__pyx_t_10) {
 
-    /* "structureboost/structure_dt_multi.pyx":66
+    /* "structureboost/structure_dt_multi.pyx":65
  *         best_loss, best_split_val = stdt._get_best_vals(score_vec, split_vec)
  *         if has_na_vals and (len(split_vec) > 2):
  *             g_sum_left_nal = (g_sum_left + (g_sum_total - g_sum_left[-1,:]))[:-1,:]             # <<<<<<<<<<<<<<
  *             h_sum_left_nal = (h_sum_left + (h_sum_total - h_sum_left[-1,:]))[:-1,:]
  *             g_sum_right_nal = g_sum_total - g_sum_left_nal
  */
-    __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_v_g_sum_left, __pyx_tuple__5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 66, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_v_g_sum_left, __pyx_tuple__5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 65, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_5 = PyNumber_Subtract(__pyx_v_g_sum_total, __pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 66, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Subtract(__pyx_v_g_sum_total, __pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 65, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = PyNumber_Add(__pyx_v_g_sum_left, __pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 66, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Add(__pyx_v_g_sum_left, __pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 65, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_8, __pyx_tuple__7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 66, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_8, __pyx_tuple__7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 65, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __pyx_v_g_sum_left_nal = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":67
+    /* "structureboost/structure_dt_multi.pyx":66
  *         if has_na_vals and (len(split_vec) > 2):
  *             g_sum_left_nal = (g_sum_left + (g_sum_total - g_sum_left[-1,:]))[:-1,:]
  *             h_sum_left_nal = (h_sum_left + (h_sum_total - h_sum_left[-1,:]))[:-1,:]             # <<<<<<<<<<<<<<
  *             g_sum_right_nal = g_sum_total - g_sum_left_nal
  *             h_sum_right_nal = h_sum_total - h_sum_left_nal
  */
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_h_sum_left, __pyx_tuple__5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 67, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_h_sum_left, __pyx_tuple__5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 66, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_8 = PyNumber_Subtract(__pyx_v_h_sum_total, __pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 67, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Subtract(__pyx_v_h_sum_total, __pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 66, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Add(__pyx_v_h_sum_left, __pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 67, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Add(__pyx_v_h_sum_left, __pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 66, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_tuple__7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 67, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_tuple__7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 66, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_v_h_sum_left_nal = __pyx_t_8;
     __pyx_t_8 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":68
+    /* "structureboost/structure_dt_multi.pyx":67
  *             g_sum_left_nal = (g_sum_left + (g_sum_total - g_sum_left[-1,:]))[:-1,:]
  *             h_sum_left_nal = (h_sum_left + (h_sum_total - h_sum_left[-1,:]))[:-1,:]
  *             g_sum_right_nal = g_sum_total - g_sum_left_nal             # <<<<<<<<<<<<<<
  *             h_sum_right_nal = h_sum_total - h_sum_left_nal
  * 
  */
-    __pyx_t_8 = PyNumber_Subtract(__pyx_v_g_sum_total, __pyx_v_g_sum_left_nal); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 68, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Subtract(__pyx_v_g_sum_total, __pyx_v_g_sum_left_nal); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 67, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_v_g_sum_right_nal = __pyx_t_8;
     __pyx_t_8 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":69
+    /* "structureboost/structure_dt_multi.pyx":68
  *             h_sum_left_nal = (h_sum_left + (h_sum_total - h_sum_left[-1,:]))[:-1,:]
  *             g_sum_right_nal = g_sum_total - g_sum_left_nal
  *             h_sum_right_nal = h_sum_total - h_sum_left_nal             # <<<<<<<<<<<<<<
  * 
  *             score_vec_nal = (-1)*_get_gh_score_array_mc(g_sum_left_nal,
  */
-    __pyx_t_8 = PyNumber_Subtract(__pyx_v_h_sum_total, __pyx_v_h_sum_left_nal); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 69, __pyx_L1_error)
+    __pyx_t_8 = PyNumber_Subtract(__pyx_v_h_sum_total, __pyx_v_h_sum_left_nal); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 68, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_v_h_sum_right_nal = __pyx_t_8;
     __pyx_t_8 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":71
+    /* "structureboost/structure_dt_multi.pyx":70
  *             h_sum_right_nal = h_sum_total - h_sum_left_nal
  * 
  *             score_vec_nal = (-1)*_get_gh_score_array_mc(g_sum_left_nal,             # <<<<<<<<<<<<<<
  *                                                      g_sum_right_nal,
  *                                                      h_sum_left_nal,
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_get_gh_score_array_mc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 71, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_get_gh_score_array_mc); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 70, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
 
-    /* "structureboost/structure_dt_multi.pyx":75
+    /* "structureboost/structure_dt_multi.pyx":74
  *                                                      h_sum_left_nal,
  *                                                      h_sum_right_nal,
  *                                                      self.gamma, self.reg_lambda)             # <<<<<<<<<<<<<<
  *             best_loss_nal, best_split_val_nal = stdt._get_best_vals(score_vec_nal,
  *                                                                split_vec)
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_gamma); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 75, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_gamma); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 74, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_reg_lambda); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 75, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_reg_lambda); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 74, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_4 = NULL;
     __pyx_t_7 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
@@ -4111,33 +4102,33 @@
         __Pyx_DECREF_SET(__pyx_t_5, function);
         __pyx_t_7 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_5)) {
       PyObject *__pyx_temp[7] = {__pyx_t_4, __pyx_v_g_sum_left_nal, __pyx_v_g_sum_right_nal, __pyx_v_h_sum_left_nal, __pyx_v_h_sum_right_nal, __pyx_t_2, __pyx_t_1};
-      __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 6+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 71, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 6+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 70, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_5)) {
       PyObject *__pyx_temp[7] = {__pyx_t_4, __pyx_v_g_sum_left_nal, __pyx_v_g_sum_right_nal, __pyx_v_h_sum_left_nal, __pyx_v_h_sum_right_nal, __pyx_t_2, __pyx_t_1};
-      __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 6+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 71, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_5, __pyx_temp+1-__pyx_t_7, 6+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 70, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     } else
     #endif
     {
-      __pyx_t_3 = PyTuple_New(6+__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 71, __pyx_L1_error)
+      __pyx_t_3 = PyTuple_New(6+__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 70, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       if (__pyx_t_4) {
         __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
       }
       __Pyx_INCREF(__pyx_v_g_sum_left_nal);
       __Pyx_GIVEREF(__pyx_v_g_sum_left_nal);
       PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_7, __pyx_v_g_sum_left_nal);
@@ -4152,47 +4143,47 @@
       PyTuple_SET_ITEM(__pyx_t_3, 3+__pyx_t_7, __pyx_v_h_sum_right_nal);
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_3, 4+__pyx_t_7, __pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_3, 5+__pyx_t_7, __pyx_t_1);
       __pyx_t_2 = 0;
       __pyx_t_1 = 0;
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 71, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 70, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":71
+    /* "structureboost/structure_dt_multi.pyx":70
  *             h_sum_right_nal = h_sum_total - h_sum_left_nal
  * 
  *             score_vec_nal = (-1)*_get_gh_score_array_mc(g_sum_left_nal,             # <<<<<<<<<<<<<<
  *                                                      g_sum_right_nal,
  *                                                      h_sum_left_nal,
  */
-    __pyx_t_5 = PyNumber_Multiply(__pyx_int_neg_1, __pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 71, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Multiply(__pyx_int_neg_1, __pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 70, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __pyx_v_score_vec_nal = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":76
+    /* "structureboost/structure_dt_multi.pyx":75
  *                                                      h_sum_right_nal,
  *                                                      self.gamma, self.reg_lambda)
  *             best_loss_nal, best_split_val_nal = stdt._get_best_vals(score_vec_nal,             # <<<<<<<<<<<<<<
  *                                                                split_vec)
  *             if best_loss_nal < best_loss:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_stdt); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 76, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_stdt); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 75, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_get_best_vals); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 76, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_get_best_vals); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 75, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":77
+    /* "structureboost/structure_dt_multi.pyx":76
  *                                                      self.gamma, self.reg_lambda)
  *             best_loss_nal, best_split_val_nal = stdt._get_best_vals(score_vec_nal,
  *                                                                split_vec)             # <<<<<<<<<<<<<<
  *             if best_loss_nal < best_loss:
  *                 # NAs go left by design
  */
     __pyx_t_8 = NULL;
@@ -4206,124 +4197,124 @@
         __Pyx_DECREF_SET(__pyx_t_3, function);
         __pyx_t_7 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_v_score_vec_nal, __pyx_v_split_vec};
-      __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 76, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 75, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_GOTREF(__pyx_t_5);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_v_score_vec_nal, __pyx_v_split_vec};
-      __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 76, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 75, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_GOTREF(__pyx_t_5);
     } else
     #endif
     {
-      __pyx_t_1 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 76, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 75, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (__pyx_t_8) {
         __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_8); __pyx_t_8 = NULL;
       }
       __Pyx_INCREF(__pyx_v_score_vec_nal);
       __Pyx_GIVEREF(__pyx_v_score_vec_nal);
       PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_7, __pyx_v_score_vec_nal);
       __Pyx_INCREF(__pyx_v_split_vec);
       __Pyx_GIVEREF(__pyx_v_split_vec);
       PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_7, __pyx_v_split_vec);
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 76, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 75, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if ((likely(PyTuple_CheckExact(__pyx_t_5))) || (PyList_CheckExact(__pyx_t_5))) {
       PyObject* sequence = __pyx_t_5;
       Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
       if (unlikely(size != 2)) {
         if (size > 2) __Pyx_RaiseTooManyValuesError(2);
         else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-        __PYX_ERR(0, 76, __pyx_L1_error)
+        __PYX_ERR(0, 75, __pyx_L1_error)
       }
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
       if (likely(PyTuple_CheckExact(sequence))) {
         __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
         __pyx_t_1 = PyTuple_GET_ITEM(sequence, 1); 
       } else {
         __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
         __pyx_t_1 = PyList_GET_ITEM(sequence, 1); 
       }
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_1);
       #else
-      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 76, __pyx_L1_error)
+      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 75, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 76, __pyx_L1_error)
+      __pyx_t_1 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 75, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       #endif
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     } else {
       Py_ssize_t index = -1;
-      __pyx_t_8 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 76, __pyx_L1_error)
+      __pyx_t_8 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 75, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_9 = Py_TYPE(__pyx_t_8)->tp_iternext;
       index = 0; __pyx_t_3 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_3)) goto __pyx_L14_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_3);
       index = 1; __pyx_t_1 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_1)) goto __pyx_L14_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_1);
-      if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_8), 2) < 0) __PYX_ERR(0, 76, __pyx_L1_error)
+      if (__Pyx_IternextUnpackEndCheck(__pyx_t_9(__pyx_t_8), 2) < 0) __PYX_ERR(0, 75, __pyx_L1_error)
       __pyx_t_9 = NULL;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       goto __pyx_L15_unpacking_done;
       __pyx_L14_unpacking_failed:;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __pyx_t_9 = NULL;
       if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-      __PYX_ERR(0, 76, __pyx_L1_error)
+      __PYX_ERR(0, 75, __pyx_L1_error)
       __pyx_L15_unpacking_done:;
     }
 
-    /* "structureboost/structure_dt_multi.pyx":76
+    /* "structureboost/structure_dt_multi.pyx":75
  *                                                      h_sum_right_nal,
  *                                                      self.gamma, self.reg_lambda)
  *             best_loss_nal, best_split_val_nal = stdt._get_best_vals(score_vec_nal,             # <<<<<<<<<<<<<<
  *                                                                split_vec)
  *             if best_loss_nal < best_loss:
  */
     __pyx_v_best_loss_nal = __pyx_t_3;
     __pyx_t_3 = 0;
     __pyx_v_best_split_val_nal = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":78
+    /* "structureboost/structure_dt_multi.pyx":77
  *             best_loss_nal, best_split_val_nal = stdt._get_best_vals(score_vec_nal,
  *                                                                split_vec)
  *             if best_loss_nal < best_loss:             # <<<<<<<<<<<<<<
  *                 # NAs go left by design
  *                 return best_loss_nal, best_split_val_nal, 1, 0
  */
-    __pyx_t_5 = PyObject_RichCompare(__pyx_v_best_loss_nal, __pyx_v_best_loss, Py_LT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 78, __pyx_L1_error)
-    __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 78, __pyx_L1_error)
+    __pyx_t_5 = PyObject_RichCompare(__pyx_v_best_loss_nal, __pyx_v_best_loss, Py_LT); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 77, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 77, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (__pyx_t_10) {
 
-      /* "structureboost/structure_dt_multi.pyx":80
+      /* "structureboost/structure_dt_multi.pyx":79
  *             if best_loss_nal < best_loss:
  *                 # NAs go left by design
  *                 return best_loss_nal, best_split_val_nal, 1, 0             # <<<<<<<<<<<<<<
  *             else:
  *                 # NAs go right by design
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_5 = PyTuple_New(4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 80, __pyx_L1_error)
+      __pyx_t_5 = PyTuple_New(4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 79, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_INCREF(__pyx_v_best_loss_nal);
       __Pyx_GIVEREF(__pyx_v_best_loss_nal);
       PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_best_loss_nal);
       __Pyx_INCREF(__pyx_v_best_split_val_nal);
       __Pyx_GIVEREF(__pyx_v_best_split_val_nal);
       PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_best_split_val_nal);
@@ -4333,33 +4324,33 @@
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyTuple_SET_ITEM(__pyx_t_5, 3, __pyx_int_0);
       __pyx_r = __pyx_t_5;
       __pyx_t_5 = 0;
       goto __pyx_L0;
 
-      /* "structureboost/structure_dt_multi.pyx":78
+      /* "structureboost/structure_dt_multi.pyx":77
  *             best_loss_nal, best_split_val_nal = stdt._get_best_vals(score_vec_nal,
  *                                                                split_vec)
  *             if best_loss_nal < best_loss:             # <<<<<<<<<<<<<<
  *                 # NAs go left by design
  *                 return best_loss_nal, best_split_val_nal, 1, 0
  */
     }
 
-    /* "structureboost/structure_dt_multi.pyx":83
+    /* "structureboost/structure_dt_multi.pyx":82
  *             else:
  *                 # NAs go right by design
  *                 return best_loss, best_split_val, 0, 0             # <<<<<<<<<<<<<<
  *         else:
  *             # If no NAs at training, randomly choose side for NAs at this node
  */
     /*else*/ {
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_5 = PyTuple_New(4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 83, __pyx_L1_error)
+      __pyx_t_5 = PyTuple_New(4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 82, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_INCREF(__pyx_v_best_loss);
       __Pyx_GIVEREF(__pyx_v_best_loss);
       PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_best_loss);
       __Pyx_INCREF(__pyx_v_best_split_val);
       __Pyx_GIVEREF(__pyx_v_best_split_val);
       PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_best_split_val);
@@ -4370,58 +4361,58 @@
       __Pyx_GIVEREF(__pyx_int_0);
       PyTuple_SET_ITEM(__pyx_t_5, 3, __pyx_int_0);
       __pyx_r = __pyx_t_5;
       __pyx_t_5 = 0;
       goto __pyx_L0;
     }
 
-    /* "structureboost/structure_dt_multi.pyx":65
+    /* "structureboost/structure_dt_multi.pyx":64
  * 
  *         best_loss, best_split_val = stdt._get_best_vals(score_vec, split_vec)
  *         if has_na_vals and (len(split_vec) > 2):             # <<<<<<<<<<<<<<
  *             g_sum_left_nal = (g_sum_left + (g_sum_total - g_sum_left[-1,:]))[:-1,:]
  *             h_sum_left_nal = (h_sum_left + (h_sum_total - h_sum_left[-1,:]))[:-1,:]
  */
   }
 
-  /* "structureboost/structure_dt_multi.pyx":87
+  /* "structureboost/structure_dt_multi.pyx":86
  *             # If no NAs at training, randomly choose side for NAs at this node
  *             # adjust here if we want coin flip to be other than .5
  *             return best_loss, best_split_val, int(random.random() < .5), 1             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_random); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 87, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_random); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 86, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_random); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 87, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_random); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 86, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_5 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 87, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 86, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyObject_RichCompare(__pyx_t_5, __pyx_float__5, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 87, __pyx_L1_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_t_5, __pyx_float__5, Py_LT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 86, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyNumber_Int(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 87, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyNumber_Int(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 86, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 87, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 86, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_v_best_loss);
     __Pyx_GIVEREF(__pyx_v_best_loss);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_best_loss);
     __Pyx_INCREF(__pyx_v_best_split_val);
     __Pyx_GIVEREF(__pyx_v_best_split_val);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_best_split_val);
@@ -4432,15 +4423,15 @@
     PyTuple_SET_ITEM(__pyx_t_3, 3, __pyx_int_1);
     __pyx_t_5 = 0;
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
   }
 
-  /* "structureboost/structure_dt_multi.pyx":48
+  /* "structureboost/structure_dt_multi.pyx":47
  *             return(out_val)
  * 
  *     def _evaluate_numerical_splits(self, feature_vec, g_h_mat,             # <<<<<<<<<<<<<<
  *                                    split_vec):
  * 
  */
 
@@ -4477,15 +4468,15 @@
   __Pyx_XDECREF(__pyx_v_best_split_val_nal);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_dt_multi.pyx":90
+/* "structureboost/structure_dt_multi.pyx":89
  * 
  * 
  *     def get_gh_val_mat(self, feature_vec_node,g_h_train_node,             # <<<<<<<<<<<<<<
  *                        max_num_vertices):
  *         g_h_val_arr = np.zeros((max_num_vertices,2*self.num_classes))
  */
 
@@ -4526,31 +4517,31 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_feature_vec_node)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_gh_val_mat", 1, 4, 4, 1); __PYX_ERR(0, 90, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_gh_val_mat", 1, 4, 4, 1); __PYX_ERR(0, 89, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g_h_train_node)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_gh_val_mat", 1, 4, 4, 2); __PYX_ERR(0, 90, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_gh_val_mat", 1, 4, 4, 2); __PYX_ERR(0, 89, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_max_num_vertices)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_gh_val_mat", 1, 4, 4, 3); __PYX_ERR(0, 90, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_gh_val_mat", 1, 4, 4, 3); __PYX_ERR(0, 89, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_gh_val_mat") < 0)) __PYX_ERR(0, 90, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_gh_val_mat") < 0)) __PYX_ERR(0, 89, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -4559,15 +4550,15 @@
     __pyx_v_self = values[0];
     __pyx_v_feature_vec_node = values[1];
     __pyx_v_g_h_train_node = values[2];
     __pyx_v_max_num_vertices = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("get_gh_val_mat", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 90, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("get_gh_val_mat", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 89, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_dt_multi.StructureDecisionTreeMulti.get_gh_val_mat", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_6get_gh_val_mat(__pyx_self, __pyx_v_self, __pyx_v_feature_vec_node, __pyx_v_g_h_train_node, __pyx_v_max_num_vertices);
 
@@ -4589,34 +4580,34 @@
   PyObject *__pyx_t_6 = NULL;
   int __pyx_t_7;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__8)
   __Pyx_RefNannySetupContext("get_gh_val_mat", 0);
-  __Pyx_TraceCall("get_gh_val_mat", __pyx_f[0], 90, 0, __PYX_ERR(0, 90, __pyx_L1_error));
+  __Pyx_TraceCall("get_gh_val_mat", __pyx_f[0], 89, 0, __PYX_ERR(0, 89, __pyx_L1_error));
 
-  /* "structureboost/structure_dt_multi.pyx":92
+  /* "structureboost/structure_dt_multi.pyx":91
  *     def get_gh_val_mat(self, feature_vec_node,g_h_train_node,
  *                        max_num_vertices):
  *         g_h_val_arr = np.zeros((max_num_vertices,2*self.num_classes))             # <<<<<<<<<<<<<<
  *         g_h_val_arr = get_g_h_feature_sum_matrix(
- *                                         feature_vec_node.astype(np.int64),
+ *                                         feature_vec_node.astype(np.int_),
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 92, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 91, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 92, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_int_2, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 92, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_int_2, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 91, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 92, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_v_max_num_vertices);
   __Pyx_GIVEREF(__pyx_v_max_num_vertices);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_max_num_vertices);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
   __pyx_t_4 = 0;
@@ -4629,42 +4620,42 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 92, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 91, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_g_h_val_arr = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":93
+  /* "structureboost/structure_dt_multi.pyx":92
  *                        max_num_vertices):
  *         g_h_val_arr = np.zeros((max_num_vertices,2*self.num_classes))
  *         g_h_val_arr = get_g_h_feature_sum_matrix(             # <<<<<<<<<<<<<<
- *                                         feature_vec_node.astype(np.int64),
+ *                                         feature_vec_node.astype(np.int_),
  *                                         g_h_train_node,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_get_g_h_feature_sum_matrix); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 93, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_get_g_h_feature_sum_matrix); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
 
-  /* "structureboost/structure_dt_multi.pyx":94
+  /* "structureboost/structure_dt_multi.pyx":93
  *         g_h_val_arr = np.zeros((max_num_vertices,2*self.num_classes))
  *         g_h_val_arr = get_g_h_feature_sum_matrix(
- *                                         feature_vec_node.astype(np.int64),             # <<<<<<<<<<<<<<
+ *                                         feature_vec_node.astype(np.int_),             # <<<<<<<<<<<<<<
  *                                         g_h_train_node,
  *                                         g_h_val_arr, self.num_classes)
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_feature_vec_node, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 94, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_feature_vec_node, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 93, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 94, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 93, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 94, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 93, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -4672,26 +4663,26 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_6);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 94, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 93, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":96
- *                                         feature_vec_node.astype(np.int64),
+  /* "structureboost/structure_dt_multi.pyx":95
+ *                                         feature_vec_node.astype(np.int_),
  *                                         g_h_train_node,
  *                                         g_h_val_arr, self.num_classes)             # <<<<<<<<<<<<<<
  *         return g_h_val_arr
  * 
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 96, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 95, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_6 = NULL;
   __pyx_t_7 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -4700,33 +4691,33 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_7 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[5] = {__pyx_t_6, __pyx_t_2, __pyx_v_g_h_train_node, __pyx_v_g_h_val_arr, __pyx_t_4};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 93, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 92, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[5] = {__pyx_t_6, __pyx_t_2, __pyx_v_g_h_train_node, __pyx_v_g_h_val_arr, __pyx_t_4};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 93, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 92, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   } else
   #endif
   {
-    __pyx_t_5 = PyTuple_New(4+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 93, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(4+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 92, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     if (__pyx_t_6) {
       __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6); __pyx_t_6 = NULL;
     }
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_7, __pyx_t_2);
     __Pyx_INCREF(__pyx_v_g_h_train_node);
@@ -4735,35 +4726,35 @@
     __Pyx_INCREF(__pyx_v_g_h_val_arr);
     __Pyx_GIVEREF(__pyx_v_g_h_val_arr);
     PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_7, __pyx_v_g_h_val_arr);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_5, 3+__pyx_t_7, __pyx_t_4);
     __pyx_t_2 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 93, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 92, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF_SET(__pyx_v_g_h_val_arr, __pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":97
+  /* "structureboost/structure_dt_multi.pyx":96
  *                                         g_h_train_node,
  *                                         g_h_val_arr, self.num_classes)
  *         return g_h_val_arr             # <<<<<<<<<<<<<<
  * 
  *     @cython.boundscheck(False)  # Deactivate bounds checking
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_g_h_val_arr);
   __pyx_r = __pyx_v_g_h_val_arr;
   goto __pyx_L0;
 
-  /* "structureboost/structure_dt_multi.pyx":90
+  /* "structureboost/structure_dt_multi.pyx":89
  * 
  * 
  *     def get_gh_val_mat(self, feature_vec_node,g_h_train_node,             # <<<<<<<<<<<<<<
  *                        max_num_vertices):
  *         g_h_val_arr = np.zeros((max_num_vertices,2*self.num_classes))
  */
 
@@ -4781,15 +4772,15 @@
   __Pyx_XDECREF(__pyx_v_g_h_val_arr);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_dt_multi.pyx":101
+/* "structureboost/structure_dt_multi.pyx":100
  *     @cython.boundscheck(False)  # Deactivate bounds checking
  *     @cython.wraparound(False)   # Deactivate negative indexing.
  *     def update_g_h_accum(self, np.ndarray[double, ndim=2] g_h_accum_array,             # <<<<<<<<<<<<<<
  *         long lni, long lvi):
  *         ## TODO: make this more efficient (cython)
  */
 
@@ -4830,54 +4821,54 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g_h_accum_array)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_g_h_accum", 1, 4, 4, 1); __PYX_ERR(0, 101, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_g_h_accum", 1, 4, 4, 1); __PYX_ERR(0, 100, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_lni)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_g_h_accum", 1, 4, 4, 2); __PYX_ERR(0, 101, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_g_h_accum", 1, 4, 4, 2); __PYX_ERR(0, 100, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_lvi)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_g_h_accum", 1, 4, 4, 3); __PYX_ERR(0, 101, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_g_h_accum", 1, 4, 4, 3); __PYX_ERR(0, 100, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update_g_h_accum") < 0)) __PYX_ERR(0, 101, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update_g_h_accum") < 0)) __PYX_ERR(0, 100, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
     }
     __pyx_v_self = values[0];
     __pyx_v_g_h_accum_array = ((PyArrayObject *)values[1]);
-    __pyx_v_lni = __Pyx_PyInt_As_long(values[2]); if (unlikely((__pyx_v_lni == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 102, __pyx_L3_error)
-    __pyx_v_lvi = __Pyx_PyInt_As_long(values[3]); if (unlikely((__pyx_v_lvi == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 102, __pyx_L3_error)
+    __pyx_v_lni = __Pyx_PyInt_As_long(values[2]); if (unlikely((__pyx_v_lni == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 101, __pyx_L3_error)
+    __pyx_v_lvi = __Pyx_PyInt_As_long(values[3]); if (unlikely((__pyx_v_lvi == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 101, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("update_g_h_accum", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 101, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("update_g_h_accum", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 100, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_dt_multi.StructureDecisionTreeMulti.update_g_h_accum", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g_h_accum_array), __pyx_ptype_5numpy_ndarray, 1, "g_h_accum_array", 0))) __PYX_ERR(0, 101, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g_h_accum_array), __pyx_ptype_5numpy_ndarray, 1, "g_h_accum_array", 0))) __PYX_ERR(0, 100, __pyx_L1_error)
   __pyx_r = __pyx_pf_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_8update_g_h_accum(__pyx_self, __pyx_v_self, __pyx_v_g_h_accum_array, __pyx_v_lni, __pyx_v_lvi);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -4903,86 +4894,86 @@
   Py_ssize_t __pyx_t_8;
   Py_ssize_t __pyx_t_9;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__9)
   __Pyx_RefNannySetupContext("update_g_h_accum", 0);
-  __Pyx_TraceCall("update_g_h_accum", __pyx_f[0], 101, 0, __PYX_ERR(0, 101, __pyx_L1_error));
+  __Pyx_TraceCall("update_g_h_accum", __pyx_f[0], 100, 0, __PYX_ERR(0, 100, __pyx_L1_error));
   __pyx_pybuffer_g_h_accum_array.pybuffer.buf = NULL;
   __pyx_pybuffer_g_h_accum_array.refcount = 0;
   __pyx_pybuffernd_g_h_accum_array.data = NULL;
   __pyx_pybuffernd_g_h_accum_array.rcbuffer = &__pyx_pybuffer_g_h_accum_array;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_h_accum_array.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_h_accum_array, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 101, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_h_accum_array.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_h_accum_array, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 100, __pyx_L1_error)
   }
   __pyx_pybuffernd_g_h_accum_array.diminfo[0].strides = __pyx_pybuffernd_g_h_accum_array.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_g_h_accum_array.diminfo[0].shape = __pyx_pybuffernd_g_h_accum_array.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_g_h_accum_array.diminfo[1].strides = __pyx_pybuffernd_g_h_accum_array.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_g_h_accum_array.diminfo[1].shape = __pyx_pybuffernd_g_h_accum_array.rcbuffer->pybuffer.shape[1];
 
-  /* "structureboost/structure_dt_multi.pyx":105
+  /* "structureboost/structure_dt_multi.pyx":104
  *         ## TODO: make this more efficient (cython)
  *         cdef long j
  *         cdef long limit = 2*self.num_classes             # <<<<<<<<<<<<<<
  *         for j in range(2*self.num_classes):
  *             g_h_accum_array[lni,j] +=  g_h_accum_array[lvi,j]
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 104, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 105, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 104, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __Pyx_PyInt_As_long(__pyx_t_2); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 105, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_As_long(__pyx_t_2); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 104, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_limit = __pyx_t_3;
 
-  /* "structureboost/structure_dt_multi.pyx":106
+  /* "structureboost/structure_dt_multi.pyx":105
  *         cdef long j
  *         cdef long limit = 2*self.num_classes
  *         for j in range(2*self.num_classes):             # <<<<<<<<<<<<<<
  *             g_h_accum_array[lni,j] +=  g_h_accum_array[lvi,j]
  *         return g_h_accum_array
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 106, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 105, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_int_2, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 106, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_int_2, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 106, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_3 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 105, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_4 = __pyx_t_3;
   for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
     __pyx_v_j = __pyx_t_5;
 
-    /* "structureboost/structure_dt_multi.pyx":107
+    /* "structureboost/structure_dt_multi.pyx":106
  *         cdef long limit = 2*self.num_classes
  *         for j in range(2*self.num_classes):
  *             g_h_accum_array[lni,j] +=  g_h_accum_array[lvi,j]             # <<<<<<<<<<<<<<
  *         return g_h_accum_array
  * 
  */
     __pyx_t_6 = __pyx_v_lvi;
     __pyx_t_7 = __pyx_v_j;
     __pyx_t_8 = __pyx_v_lni;
     __pyx_t_9 = __pyx_v_j;
     *__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_g_h_accum_array.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_g_h_accum_array.diminfo[0].strides, __pyx_t_9, __pyx_pybuffernd_g_h_accum_array.diminfo[1].strides) += (*__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_g_h_accum_array.rcbuffer->pybuffer.buf, __pyx_t_6, __pyx_pybuffernd_g_h_accum_array.diminfo[0].strides, __pyx_t_7, __pyx_pybuffernd_g_h_accum_array.diminfo[1].strides));
   }
 
-  /* "structureboost/structure_dt_multi.pyx":108
+  /* "structureboost/structure_dt_multi.pyx":107
  *         for j in range(2*self.num_classes):
  *             g_h_accum_array[lni,j] +=  g_h_accum_array[lvi,j]
  *         return g_h_accum_array             # <<<<<<<<<<<<<<
  * 
  *     def get_loss_in_span_tree(self, feature_vec_node, g_h_train_node,
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_g_h_accum_array));
   __pyx_r = ((PyObject *)__pyx_v_g_h_accum_array);
   goto __pyx_L0;
 
-  /* "structureboost/structure_dt_multi.pyx":101
+  /* "structureboost/structure_dt_multi.pyx":100
  *     @cython.boundscheck(False)  # Deactivate bounds checking
  *     @cython.wraparound(False)   # Deactivate negative indexing.
  *     def update_g_h_accum(self, np.ndarray[double, ndim=2] g_h_accum_array,             # <<<<<<<<<<<<<<
  *         long lni, long lvi):
  *         ## TODO: make this more efficient (cython)
  */
 
@@ -5004,15 +4995,15 @@
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_dt_multi.pyx":110
+/* "structureboost/structure_dt_multi.pyx":109
  *         return g_h_accum_array
  * 
  *     def get_loss_in_span_tree(self, feature_vec_node, g_h_train_node,             # <<<<<<<<<<<<<<
  *                               g_h_accum_array, g_h_sum, leaf_vertex_ind,
  *                               left_feat_values, feature_type):
  */
 
@@ -5065,55 +5056,55 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_feature_vec_node)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_loss_in_span_tree", 1, 8, 8, 1); __PYX_ERR(0, 110, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_loss_in_span_tree", 1, 8, 8, 1); __PYX_ERR(0, 109, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g_h_train_node)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_loss_in_span_tree", 1, 8, 8, 2); __PYX_ERR(0, 110, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_loss_in_span_tree", 1, 8, 8, 2); __PYX_ERR(0, 109, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g_h_accum_array)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_loss_in_span_tree", 1, 8, 8, 3); __PYX_ERR(0, 110, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_loss_in_span_tree", 1, 8, 8, 3); __PYX_ERR(0, 109, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g_h_sum)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_loss_in_span_tree", 1, 8, 8, 4); __PYX_ERR(0, 110, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_loss_in_span_tree", 1, 8, 8, 4); __PYX_ERR(0, 109, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_leaf_vertex_ind)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_loss_in_span_tree", 1, 8, 8, 5); __PYX_ERR(0, 110, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_loss_in_span_tree", 1, 8, 8, 5); __PYX_ERR(0, 109, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_left_feat_values)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_loss_in_span_tree", 1, 8, 8, 6); __PYX_ERR(0, 110, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_loss_in_span_tree", 1, 8, 8, 6); __PYX_ERR(0, 109, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  7:
         if (likely((values[7] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_feature_type)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_loss_in_span_tree", 1, 8, 8, 7); __PYX_ERR(0, 110, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_loss_in_span_tree", 1, 8, 8, 7); __PYX_ERR(0, 109, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_loss_in_span_tree") < 0)) __PYX_ERR(0, 110, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_loss_in_span_tree") < 0)) __PYX_ERR(0, 109, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 8) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -5130,15 +5121,15 @@
     __pyx_v_g_h_sum = values[4];
     __pyx_v_leaf_vertex_ind = values[5];
     __pyx_v_left_feat_values = values[6];
     __pyx_v_feature_type = values[7];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("get_loss_in_span_tree", 1, 8, 8, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 110, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("get_loss_in_span_tree", 1, 8, 8, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 109, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_dt_multi.StructureDecisionTreeMulti.get_loss_in_span_tree", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_10get_loss_in_span_tree(__pyx_self, __pyx_v_self, __pyx_v_feature_vec_node, __pyx_v_g_h_train_node, __pyx_v_g_h_accum_array, __pyx_v_g_h_sum, __pyx_v_leaf_vertex_ind, __pyx_v_left_feat_values, __pyx_v_feature_type);
 
@@ -5166,142 +5157,142 @@
   int __pyx_t_8;
   PyObject *__pyx_t_9 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__10)
   __Pyx_RefNannySetupContext("get_loss_in_span_tree", 0);
-  __Pyx_TraceCall("get_loss_in_span_tree", __pyx_f[0], 110, 0, __PYX_ERR(0, 110, __pyx_L1_error));
+  __Pyx_TraceCall("get_loss_in_span_tree", __pyx_f[0], 109, 0, __PYX_ERR(0, 109, __pyx_L1_error));
 
-  /* "structureboost/structure_dt_multi.pyx":113
+  /* "structureboost/structure_dt_multi.pyx":112
  *                               g_h_accum_array, g_h_sum, leaf_vertex_ind,
  *                               left_feat_values, feature_type):
  *         g_left = g_h_accum_array[leaf_vertex_ind,:self.num_classes]             # <<<<<<<<<<<<<<
  *         h_left = g_h_accum_array[leaf_vertex_ind,self.num_classes:2*(self.num_classes)]
  *         g_sum = g_h_sum[:self.num_classes]
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 113, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 112, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PySlice_New(Py_None, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 113, __pyx_L1_error)
+  __pyx_t_2 = PySlice_New(Py_None, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 112, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 113, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 112, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_leaf_vertex_ind);
   __Pyx_GIVEREF(__pyx_v_leaf_vertex_ind);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_leaf_vertex_ind);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_g_h_accum_array, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 113, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_g_h_accum_array, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 112, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_g_left = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":114
+  /* "structureboost/structure_dt_multi.pyx":113
  *                               left_feat_values, feature_type):
  *         g_left = g_h_accum_array[leaf_vertex_ind,:self.num_classes]
  *         h_left = g_h_accum_array[leaf_vertex_ind,self.num_classes:2*(self.num_classes)]             # <<<<<<<<<<<<<<
  *         g_sum = g_h_sum[:self.num_classes]
  *         h_sum = g_h_sum[self.num_classes:2*self.num_classes]
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 114, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 113, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 114, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 113, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 114, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 113, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PySlice_New(__pyx_t_2, __pyx_t_3, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 114, __pyx_L1_error)
+  __pyx_t_1 = PySlice_New(__pyx_t_2, __pyx_t_3, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 113, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 114, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 113, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_leaf_vertex_ind);
   __Pyx_GIVEREF(__pyx_v_leaf_vertex_ind);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_leaf_vertex_ind);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_g_h_accum_array, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 114, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_g_h_accum_array, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 113, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_h_left = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":115
+  /* "structureboost/structure_dt_multi.pyx":114
  *         g_left = g_h_accum_array[leaf_vertex_ind,:self.num_classes]
  *         h_left = g_h_accum_array[leaf_vertex_ind,self.num_classes:2*(self.num_classes)]
  *         g_sum = g_h_sum[:self.num_classes]             # <<<<<<<<<<<<<<
  *         h_sum = g_h_sum[self.num_classes:2*self.num_classes]
  *         curr_loss = _get_gh_score_num_mc(g_left, g_sum-g_left,
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 115, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 114, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_g_h_sum, 0, 0, NULL, &__pyx_t_1, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 115, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_g_h_sum, 0, 0, NULL, &__pyx_t_1, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 114, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_g_sum = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":116
+  /* "structureboost/structure_dt_multi.pyx":115
  *         h_left = g_h_accum_array[leaf_vertex_ind,self.num_classes:2*(self.num_classes)]
  *         g_sum = g_h_sum[:self.num_classes]
  *         h_sum = g_h_sum[self.num_classes:2*self.num_classes]             # <<<<<<<<<<<<<<
  *         curr_loss = _get_gh_score_num_mc(g_left, g_sum-g_left,
  *                                       h_left, h_sum-h_left,
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 116, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 115, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 116, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 115, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 116, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 115, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_g_h_sum, 0, 0, &__pyx_t_3, &__pyx_t_2, NULL, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 116, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetSlice(__pyx_v_g_h_sum, 0, 0, &__pyx_t_3, &__pyx_t_2, NULL, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 115, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_h_sum = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":117
+  /* "structureboost/structure_dt_multi.pyx":116
  *         g_sum = g_h_sum[:self.num_classes]
  *         h_sum = g_h_sum[self.num_classes:2*self.num_classes]
  *         curr_loss = _get_gh_score_num_mc(g_left, g_sum-g_left,             # <<<<<<<<<<<<<<
  *                                       h_left, h_sum-h_left,
  *                                       self.gamma, self.reg_lambda)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_get_gh_score_num_mc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 117, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_get_gh_score_num_mc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 116, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyNumber_Subtract(__pyx_v_g_sum, __pyx_v_g_left); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 117, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Subtract(__pyx_v_g_sum, __pyx_v_g_left); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 116, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
 
-  /* "structureboost/structure_dt_multi.pyx":118
+  /* "structureboost/structure_dt_multi.pyx":117
  *         h_sum = g_h_sum[self.num_classes:2*self.num_classes]
  *         curr_loss = _get_gh_score_num_mc(g_left, g_sum-g_left,
  *                                       h_left, h_sum-h_left,             # <<<<<<<<<<<<<<
  *                                       self.gamma, self.reg_lambda)
  *         return(curr_loss)
  */
-  __pyx_t_4 = PyNumber_Subtract(__pyx_v_h_sum, __pyx_v_h_left); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 118, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Subtract(__pyx_v_h_sum, __pyx_v_h_left); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 117, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
 
-  /* "structureboost/structure_dt_multi.pyx":119
+  /* "structureboost/structure_dt_multi.pyx":118
  *         curr_loss = _get_gh_score_num_mc(g_left, g_sum-g_left,
  *                                       h_left, h_sum-h_left,
  *                                       self.gamma, self.reg_lambda)             # <<<<<<<<<<<<<<
  *         return(curr_loss)
  * 
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_gamma); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 119, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_gamma); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 118, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_reg_lambda); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 119, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_reg_lambda); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 118, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_t_7 = NULL;
   __pyx_t_8 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_7)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -5310,37 +5301,37 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_8 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[7] = {__pyx_t_7, __pyx_v_g_left, __pyx_t_3, __pyx_v_h_left, __pyx_t_4, __pyx_t_5, __pyx_t_6};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 6+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 117, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 6+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 116, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[7] = {__pyx_t_7, __pyx_v_g_left, __pyx_t_3, __pyx_v_h_left, __pyx_t_4, __pyx_t_5, __pyx_t_6};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 6+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 117, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 6+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 116, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   } else
   #endif
   {
-    __pyx_t_9 = PyTuple_New(6+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 117, __pyx_L1_error)
+    __pyx_t_9 = PyTuple_New(6+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 116, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     if (__pyx_t_7) {
       __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
     }
     __Pyx_INCREF(__pyx_v_g_left);
     __Pyx_GIVEREF(__pyx_v_g_left);
     PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_8, __pyx_v_g_left);
@@ -5355,35 +5346,35 @@
     PyTuple_SET_ITEM(__pyx_t_9, 4+__pyx_t_8, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_9, 5+__pyx_t_8, __pyx_t_6);
     __pyx_t_3 = 0;
     __pyx_t_4 = 0;
     __pyx_t_5 = 0;
     __pyx_t_6 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 117, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 116, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_curr_loss = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":120
+  /* "structureboost/structure_dt_multi.pyx":119
  *                                       h_left, h_sum-h_left,
  *                                       self.gamma, self.reg_lambda)
  *         return(curr_loss)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_curr_loss);
   __pyx_r = __pyx_v_curr_loss;
   goto __pyx_L0;
 
-  /* "structureboost/structure_dt_multi.pyx":110
+  /* "structureboost/structure_dt_multi.pyx":109
  *         return g_h_accum_array
  * 
  *     def get_loss_in_span_tree(self, feature_vec_node, g_h_train_node,             # <<<<<<<<<<<<<<
  *                               g_h_accum_array, g_h_sum, leaf_vertex_ind,
  *                               left_feat_values, feature_type):
  */
 
@@ -5407,15 +5398,15 @@
   __Pyx_XDECREF(__pyx_v_curr_loss);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_dt_multi.pyx":123
+/* "structureboost/structure_dt_multi.pyx":122
  * 
  * 
  *     def get_score_of_split(self, g_h_train_node, mask_left, g_h_sum):             # <<<<<<<<<<<<<<
  *         g_h_masked = g_h_train_node[mask_left,:]
  *         g_h_masked_sum = np.sum(g_h_masked, axis=0)
  */
 
@@ -5456,31 +5447,31 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g_h_train_node)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_score_of_split", 1, 4, 4, 1); __PYX_ERR(0, 123, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_score_of_split", 1, 4, 4, 1); __PYX_ERR(0, 122, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_mask_left)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_score_of_split", 1, 4, 4, 2); __PYX_ERR(0, 123, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_score_of_split", 1, 4, 4, 2); __PYX_ERR(0, 122, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g_h_sum)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_score_of_split", 1, 4, 4, 3); __PYX_ERR(0, 123, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_score_of_split", 1, 4, 4, 3); __PYX_ERR(0, 122, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_score_of_split") < 0)) __PYX_ERR(0, 123, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_score_of_split") < 0)) __PYX_ERR(0, 122, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -5489,15 +5480,15 @@
     __pyx_v_self = values[0];
     __pyx_v_g_h_train_node = values[1];
     __pyx_v_mask_left = values[2];
     __pyx_v_g_h_sum = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("get_score_of_split", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 123, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("get_score_of_split", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 122, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_dt_multi.StructureDecisionTreeMulti.get_score_of_split", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_12get_score_of_split(__pyx_self, __pyx_v_self, __pyx_v_g_h_train_node, __pyx_v_mask_left, __pyx_v_g_h_sum);
 
@@ -5527,169 +5518,169 @@
   int __pyx_t_8;
   PyObject *__pyx_t_9 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__11)
   __Pyx_RefNannySetupContext("get_score_of_split", 0);
-  __Pyx_TraceCall("get_score_of_split", __pyx_f[0], 123, 0, __PYX_ERR(0, 123, __pyx_L1_error));
+  __Pyx_TraceCall("get_score_of_split", __pyx_f[0], 122, 0, __PYX_ERR(0, 122, __pyx_L1_error));
 
-  /* "structureboost/structure_dt_multi.pyx":124
+  /* "structureboost/structure_dt_multi.pyx":123
  * 
  *     def get_score_of_split(self, g_h_train_node, mask_left, g_h_sum):
  *         g_h_masked = g_h_train_node[mask_left,:]             # <<<<<<<<<<<<<<
  *         g_h_masked_sum = np.sum(g_h_masked, axis=0)
  *         g_left = g_h_masked_sum[:self.num_classes]
  */
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 124, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_mask_left);
   __Pyx_GIVEREF(__pyx_v_mask_left);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_mask_left);
   __Pyx_INCREF(__pyx_slice__3);
   __Pyx_GIVEREF(__pyx_slice__3);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_slice__3);
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_g_h_train_node, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 124, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_g_h_train_node, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 123, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_g_h_masked = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":125
+  /* "structureboost/structure_dt_multi.pyx":124
  *     def get_score_of_split(self, g_h_train_node, mask_left, g_h_sum):
  *         g_h_masked = g_h_train_node[mask_left,:]
  *         g_h_masked_sum = np.sum(g_h_masked, axis=0)             # <<<<<<<<<<<<<<
  *         g_left = g_h_masked_sum[:self.num_classes]
  *         h_left = g_h_masked_sum[self.num_classes:(2*self.num_classes)]
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 125, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 125, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 125, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_v_g_h_masked);
   __Pyx_GIVEREF(__pyx_v_g_h_masked);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_g_h_masked);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 125, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 125, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 125, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 124, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 124, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_g_h_masked_sum = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":126
+  /* "structureboost/structure_dt_multi.pyx":125
  *         g_h_masked = g_h_train_node[mask_left,:]
  *         g_h_masked_sum = np.sum(g_h_masked, axis=0)
  *         g_left = g_h_masked_sum[:self.num_classes]             # <<<<<<<<<<<<<<
  *         h_left = g_h_masked_sum[self.num_classes:(2*self.num_classes)]
  *         g_sum = g_h_sum[:self.num_classes]
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 126, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 125, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_g_h_masked_sum, 0, 0, NULL, &__pyx_t_4, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 126, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetSlice(__pyx_v_g_h_masked_sum, 0, 0, NULL, &__pyx_t_4, NULL, 0, 0, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 125, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_g_left = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":127
+  /* "structureboost/structure_dt_multi.pyx":126
  *         g_h_masked_sum = np.sum(g_h_masked, axis=0)
  *         g_left = g_h_masked_sum[:self.num_classes]
  *         h_left = g_h_masked_sum[self.num_classes:(2*self.num_classes)]             # <<<<<<<<<<<<<<
  *         g_sum = g_h_sum[:self.num_classes]
  *         h_sum = g_h_sum[self.num_classes:(2*self.num_classes)]
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 127, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 126, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 127, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 126, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_int_2, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 127, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_int_2, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 126, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_v_g_h_masked_sum, 0, 0, &__pyx_t_3, &__pyx_t_2, NULL, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 127, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_v_g_h_masked_sum, 0, 0, &__pyx_t_3, &__pyx_t_2, NULL, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 126, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_h_left = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":128
+  /* "structureboost/structure_dt_multi.pyx":127
  *         g_left = g_h_masked_sum[:self.num_classes]
  *         h_left = g_h_masked_sum[self.num_classes:(2*self.num_classes)]
  *         g_sum = g_h_sum[:self.num_classes]             # <<<<<<<<<<<<<<
  *         h_sum = g_h_sum[self.num_classes:(2*self.num_classes)]
  *         curr_loss = _get_gh_score_num_mc(g_left, g_sum-g_left,
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 128, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 127, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_g_h_sum, 0, 0, NULL, &__pyx_t_4, NULL, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 128, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_v_g_h_sum, 0, 0, NULL, &__pyx_t_4, NULL, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 127, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_g_sum = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":129
+  /* "structureboost/structure_dt_multi.pyx":128
  *         h_left = g_h_masked_sum[self.num_classes:(2*self.num_classes)]
  *         g_sum = g_h_sum[:self.num_classes]
  *         h_sum = g_h_sum[self.num_classes:(2*self.num_classes)]             # <<<<<<<<<<<<<<
  *         curr_loss = _get_gh_score_num_mc(g_left, g_sum-g_left,
  *                                       h_left, h_sum-h_left,
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 129, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 128, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 129, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 128, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_int_2, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 129, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_int_2, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 128, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_v_g_h_sum, 0, 0, &__pyx_t_2, &__pyx_t_3, NULL, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 129, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetSlice(__pyx_v_g_h_sum, 0, 0, &__pyx_t_2, &__pyx_t_3, NULL, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 128, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_h_sum = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":130
+  /* "structureboost/structure_dt_multi.pyx":129
  *         g_sum = g_h_sum[:self.num_classes]
  *         h_sum = g_h_sum[self.num_classes:(2*self.num_classes)]
  *         curr_loss = _get_gh_score_num_mc(g_left, g_sum-g_left,             # <<<<<<<<<<<<<<
  *                                       h_left, h_sum-h_left,
  *                                       self.gamma, self.reg_lambda)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_get_gh_score_num_mc); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 130, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_get_gh_score_num_mc); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 129, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = PyNumber_Subtract(__pyx_v_g_sum, __pyx_v_g_left); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 130, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Subtract(__pyx_v_g_sum, __pyx_v_g_left); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 129, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
-  /* "structureboost/structure_dt_multi.pyx":131
+  /* "structureboost/structure_dt_multi.pyx":130
  *         h_sum = g_h_sum[self.num_classes:(2*self.num_classes)]
  *         curr_loss = _get_gh_score_num_mc(g_left, g_sum-g_left,
  *                                       h_left, h_sum-h_left,             # <<<<<<<<<<<<<<
  *                                       self.gamma, self.reg_lambda)
  *         return(curr_loss)
  */
-  __pyx_t_1 = PyNumber_Subtract(__pyx_v_h_sum, __pyx_v_h_left); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 131, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_v_h_sum, __pyx_v_h_left); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 130, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
 
-  /* "structureboost/structure_dt_multi.pyx":132
+  /* "structureboost/structure_dt_multi.pyx":131
  *         curr_loss = _get_gh_score_num_mc(g_left, g_sum-g_left,
  *                                       h_left, h_sum-h_left,
  *                                       self.gamma, self.reg_lambda)             # <<<<<<<<<<<<<<
  *         return(curr_loss)
  * 
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_gamma); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 132, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_gamma); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 131, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_reg_lambda); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 132, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_reg_lambda); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 131, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_t_7 = NULL;
   __pyx_t_8 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_7)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -5698,37 +5689,37 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_8 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[7] = {__pyx_t_7, __pyx_v_g_left, __pyx_t_2, __pyx_v_h_left, __pyx_t_1, __pyx_t_5, __pyx_t_6};
-    __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 6+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 130, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 6+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 129, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[7] = {__pyx_t_7, __pyx_v_g_left, __pyx_t_2, __pyx_v_h_left, __pyx_t_1, __pyx_t_5, __pyx_t_6};
-    __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 6+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 130, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 6+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 129, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   } else
   #endif
   {
-    __pyx_t_9 = PyTuple_New(6+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 130, __pyx_L1_error)
+    __pyx_t_9 = PyTuple_New(6+__pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 129, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     if (__pyx_t_7) {
       __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
     }
     __Pyx_INCREF(__pyx_v_g_left);
     __Pyx_GIVEREF(__pyx_v_g_left);
     PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_8, __pyx_v_g_left);
@@ -5743,35 +5734,35 @@
     PyTuple_SET_ITEM(__pyx_t_9, 4+__pyx_t_8, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_9, 5+__pyx_t_8, __pyx_t_6);
     __pyx_t_2 = 0;
     __pyx_t_1 = 0;
     __pyx_t_5 = 0;
     __pyx_t_6 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 130, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 129, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_curr_loss = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":133
+  /* "structureboost/structure_dt_multi.pyx":132
  *                                       h_left, h_sum-h_left,
  *                                       self.gamma, self.reg_lambda)
  *         return(curr_loss)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_curr_loss);
   __pyx_r = __pyx_v_curr_loss;
   goto __pyx_L0;
 
-  /* "structureboost/structure_dt_multi.pyx":123
+  /* "structureboost/structure_dt_multi.pyx":122
  * 
  * 
  *     def get_score_of_split(self, g_h_train_node, mask_left, g_h_sum):             # <<<<<<<<<<<<<<
  *         g_h_masked = g_h_train_node[mask_left,:]
  *         g_h_masked_sum = np.sum(g_h_masked, axis=0)
  */
 
@@ -5797,15 +5788,15 @@
   __Pyx_XDECREF(__pyx_v_curr_loss);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_dt_multi.pyx":136
+/* "structureboost/structure_dt_multi.pyx":135
  * 
  * 
  *     def predict(self, X_test):             # <<<<<<<<<<<<<<
  *         col_list = list(X_test.columns)
  *         column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}
  */
 
@@ -5840,32 +5831,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X_test)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("predict", 1, 2, 2, 1); __PYX_ERR(0, 136, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("predict", 1, 2, 2, 1); __PYX_ERR(0, 135, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "predict") < 0)) __PYX_ERR(0, 136, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "predict") < 0)) __PYX_ERR(0, 135, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_X_test = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("predict", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 136, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("predict", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 135, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_dt_multi.StructureDecisionTreeMulti.predict", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_14predict(__pyx_self, __pyx_v_self, __pyx_v_X_test);
 
@@ -5892,88 +5883,88 @@
   PyObject *__pyx_t_9 = NULL;
   int __pyx_t_10;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__12)
   __Pyx_RefNannySetupContext("predict", 0);
-  __Pyx_TraceCall("predict", __pyx_f[0], 136, 0, __PYX_ERR(0, 136, __pyx_L1_error));
+  __Pyx_TraceCall("predict", __pyx_f[0], 135, 0, __PYX_ERR(0, 135, __pyx_L1_error));
 
-  /* "structureboost/structure_dt_multi.pyx":137
+  /* "structureboost/structure_dt_multi.pyx":136
  * 
  *     def predict(self, X_test):
  *         col_list = list(X_test.columns)             # <<<<<<<<<<<<<<
  *         column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}
  *         return self.get_prediction(self.dec_tree, X_test.to_numpy(),
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_test, __pyx_n_s_columns); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 137, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_test, __pyx_n_s_columns); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 136, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 137, __pyx_L1_error)
+  __pyx_t_2 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 136, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_col_list = ((PyObject*)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":138
+  /* "structureboost/structure_dt_multi.pyx":137
  *     def predict(self, X_test):
  *         col_list = list(X_test.columns)
  *         column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}             # <<<<<<<<<<<<<<
  *         return self.get_prediction(self.dec_tree, X_test.to_numpy(),
  *                               column_to_int_dict)
  */
   { /* enter inner scope */
-    __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 138, __pyx_L1_error)
+    __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 137, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PyList_GET_SIZE(__pyx_v_col_list); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 138, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_SIZE(__pyx_v_col_list); if (unlikely(__pyx_t_3 == ((Py_ssize_t)-1))) __PYX_ERR(0, 137, __pyx_L1_error)
     __pyx_t_4 = __pyx_t_3;
     for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
       __pyx_7genexpr__pyx_v_i = __pyx_t_5;
-      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_col_list, __pyx_7genexpr__pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 138, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_col_list, __pyx_7genexpr__pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 137, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = PyInt_FromSsize_t(__pyx_7genexpr__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 138, __pyx_L1_error)
+      __pyx_t_6 = PyInt_FromSsize_t(__pyx_7genexpr__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 137, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      if (unlikely(PyDict_SetItem(__pyx_t_2, (PyObject*)__pyx_t_1, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 138, __pyx_L1_error)
+      if (unlikely(PyDict_SetItem(__pyx_t_2, (PyObject*)__pyx_t_1, (PyObject*)__pyx_t_6))) __PYX_ERR(0, 137, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     }
   } /* exit inner scope */
   __pyx_v_column_to_int_dict = ((PyObject*)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":139
+  /* "structureboost/structure_dt_multi.pyx":138
  *         col_list = list(X_test.columns)
  *         column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}
  *         return self.get_prediction(self.dec_tree, X_test.to_numpy(),             # <<<<<<<<<<<<<<
  *                               column_to_int_dict)
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_prediction); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 139, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_prediction); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 138, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 139, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 138, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_test, __pyx_n_s_to_numpy); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 139, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_test, __pyx_n_s_to_numpy); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 138, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __pyx_t_9 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_8))) {
     __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_8);
     if (likely(__pyx_t_9)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
       __Pyx_INCREF(__pyx_t_9);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_8, function);
     }
   }
   __pyx_t_7 = (__pyx_t_9) ? __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_9) : __Pyx_PyObject_CallNoArg(__pyx_t_8);
   __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
-  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 139, __pyx_L1_error)
+  if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 138, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":140
+  /* "structureboost/structure_dt_multi.pyx":139
  *         column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}
  *         return self.get_prediction(self.dec_tree, X_test.to_numpy(),
  *                               column_to_int_dict)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __pyx_t_8 = NULL;
@@ -5987,56 +5978,56 @@
       __Pyx_DECREF_SET(__pyx_t_6, function);
       __pyx_t_10 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_6)) {
     PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_t_1, __pyx_t_7, __pyx_v_column_to_int_dict};
-    __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 139, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 138, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_6)) {
     PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_t_1, __pyx_t_7, __pyx_v_column_to_int_dict};
-    __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 139, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_6, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 138, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   } else
   #endif
   {
-    __pyx_t_9 = PyTuple_New(3+__pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 139, __pyx_L1_error)
+    __pyx_t_9 = PyTuple_New(3+__pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 138, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     if (__pyx_t_8) {
       __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_8); __pyx_t_8 = NULL;
     }
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_10, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_10, __pyx_t_7);
     __Pyx_INCREF(__pyx_v_column_to_int_dict);
     __Pyx_GIVEREF(__pyx_v_column_to_int_dict);
     PyTuple_SET_ITEM(__pyx_t_9, 2+__pyx_t_10, __pyx_v_column_to_int_dict);
     __pyx_t_1 = 0;
     __pyx_t_7 = 0;
-    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_9, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 139, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_9, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 138, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_dt_multi.pyx":136
+  /* "structureboost/structure_dt_multi.pyx":135
  * 
  * 
  *     def predict(self, X_test):             # <<<<<<<<<<<<<<
  *         col_list = list(X_test.columns)
  *         column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}
  */
 
@@ -6055,19 +6046,19 @@
   __Pyx_XDECREF(__pyx_v_column_to_int_dict);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_dt_multi.pyx":143
+/* "structureboost/structure_dt_multi.pyx":142
  * 
  * 
  *     def get_prediction(self, tree_node, X_te, dict col_to_int_dict):             # <<<<<<<<<<<<<<
- *         cdef np.ndarray[dtype_int64_t] ind_subset_left, ind_subset_right
+ *         cdef np.ndarray[np.int_t] ind_subset_left, ind_subset_right
  *         cdef long vec_len, lsize
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_17get_prediction(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_17get_prediction = {"get_prediction", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_17get_prediction, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_17get_prediction(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
@@ -6104,31 +6095,31 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tree_node)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_prediction", 1, 4, 4, 1); __PYX_ERR(0, 143, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_prediction", 1, 4, 4, 1); __PYX_ERR(0, 142, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X_te)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_prediction", 1, 4, 4, 2); __PYX_ERR(0, 143, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_prediction", 1, 4, 4, 2); __PYX_ERR(0, 142, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_col_to_int_dict)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_prediction", 1, 4, 4, 3); __PYX_ERR(0, 143, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_prediction", 1, 4, 4, 3); __PYX_ERR(0, 142, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_prediction") < 0)) __PYX_ERR(0, 143, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_prediction") < 0)) __PYX_ERR(0, 142, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -6137,21 +6128,21 @@
     __pyx_v_self = values[0];
     __pyx_v_tree_node = values[1];
     __pyx_v_X_te = values[2];
     __pyx_v_col_to_int_dict = ((PyObject*)values[3]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("get_prediction", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 143, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("get_prediction", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 142, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_dt_multi.StructureDecisionTreeMulti.get_prediction", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_col_to_int_dict), (&PyDict_Type), 1, "col_to_int_dict", 1))) __PYX_ERR(0, 143, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_col_to_int_dict), (&PyDict_Type), 1, "col_to_int_dict", 1))) __PYX_ERR(0, 142, __pyx_L1_error)
   __pyx_r = __pyx_pf_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_16get_prediction(__pyx_self, __pyx_v_self, __pyx_v_tree_node, __pyx_v_X_te, __pyx_v_col_to_int_dict);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -6192,57 +6183,57 @@
   PyObject *(*__pyx_t_15)(PyObject *);
   long __pyx_t_16;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__13)
   __Pyx_RefNannySetupContext("get_prediction", 0);
-  __Pyx_TraceCall("get_prediction", __pyx_f[0], 143, 0, __PYX_ERR(0, 143, __pyx_L1_error));
+  __Pyx_TraceCall("get_prediction", __pyx_f[0], 142, 0, __PYX_ERR(0, 142, __pyx_L1_error));
   __pyx_pybuffer_ind_subset_left.pybuffer.buf = NULL;
   __pyx_pybuffer_ind_subset_left.refcount = 0;
   __pyx_pybuffernd_ind_subset_left.data = NULL;
   __pyx_pybuffernd_ind_subset_left.rcbuffer = &__pyx_pybuffer_ind_subset_left;
   __pyx_pybuffer_ind_subset_right.pybuffer.buf = NULL;
   __pyx_pybuffer_ind_subset_right.refcount = 0;
   __pyx_pybuffernd_ind_subset_right.data = NULL;
   __pyx_pybuffernd_ind_subset_right.rcbuffer = &__pyx_pybuffer_ind_subset_right;
   __pyx_pybuffer_next_vec.pybuffer.buf = NULL;
   __pyx_pybuffer_next_vec.refcount = 0;
   __pyx_pybuffernd_next_vec.data = NULL;
   __pyx_pybuffernd_next_vec.rcbuffer = &__pyx_pybuffer_next_vec;
 
-  /* "structureboost/structure_dt_multi.pyx":148
+  /* "structureboost/structure_dt_multi.pyx":147
  *         cdef np.ndarray[double,ndim=2] next_vec
  * 
  *         if tree_node['node_type'] == 'leaf':             # <<<<<<<<<<<<<<
  *             return stdt.get_node_response_leaf(X_te.shape[0], tree_node)
  *         else:
  */
-  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_tree_node, __pyx_n_u_node_type); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 148, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_tree_node, __pyx_n_u_node_type); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 147, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_leaf, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 148, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_leaf, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 147, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_dt_multi.pyx":149
+    /* "structureboost/structure_dt_multi.pyx":148
  * 
  *         if tree_node['node_type'] == 'leaf':
  *             return stdt.get_node_response_leaf(X_te.shape[0], tree_node)             # <<<<<<<<<<<<<<
  *         else:
  *             split_bool = stdt.get_node_response_df_val(X_te, tree_node, col_to_int_dict)
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_stdt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 149, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_stdt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 148, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_get_node_response_leaf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 149, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_get_node_response_leaf); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 148, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_te, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 149, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_te, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 148, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 149, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 148, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_3 = NULL;
     __pyx_t_6 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
@@ -6252,70 +6243,70 @@
         __Pyx_DECREF_SET(__pyx_t_4, function);
         __pyx_t_6 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_4)) {
       PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_5, __pyx_v_tree_node};
-      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 149, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 148, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
       PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_5, __pyx_v_tree_node};
-      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 149, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 148, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     } else
     #endif
     {
-      __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 149, __pyx_L1_error)
+      __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 148, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (__pyx_t_3) {
         __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3); __pyx_t_3 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_5);
       PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_t_5);
       __Pyx_INCREF(__pyx_v_tree_node);
       __Pyx_GIVEREF(__pyx_v_tree_node);
       PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_v_tree_node);
       __pyx_t_5 = 0;
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 149, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 148, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L0;
 
-    /* "structureboost/structure_dt_multi.pyx":148
+    /* "structureboost/structure_dt_multi.pyx":147
  *         cdef np.ndarray[double,ndim=2] next_vec
  * 
  *         if tree_node['node_type'] == 'leaf':             # <<<<<<<<<<<<<<
  *             return stdt.get_node_response_leaf(X_te.shape[0], tree_node)
  *         else:
  */
   }
 
-  /* "structureboost/structure_dt_multi.pyx":151
+  /* "structureboost/structure_dt_multi.pyx":150
  *             return stdt.get_node_response_leaf(X_te.shape[0], tree_node)
  *         else:
  *             split_bool = stdt.get_node_response_df_val(X_te, tree_node, col_to_int_dict)             # <<<<<<<<<<<<<<
  *             vec_len = len(split_bool)
  *             next_vec = np.zeros((vec_len,self.num_classes))
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_stdt); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 151, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_stdt); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 150, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_get_node_response_df_val); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 151, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_get_node_response_df_val); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 150, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = NULL;
     __pyx_t_6 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_4)) {
@@ -6325,77 +6316,77 @@
         __Pyx_DECREF_SET(__pyx_t_7, function);
         __pyx_t_6 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_7)) {
       PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_X_te, __pyx_v_tree_node, __pyx_v_col_to_int_dict};
-      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 151, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 150, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_1);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
       PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_X_te, __pyx_v_tree_node, __pyx_v_col_to_int_dict};
-      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 151, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 150, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_1);
     } else
     #endif
     {
-      __pyx_t_5 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 151, __pyx_L1_error)
+      __pyx_t_5 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 150, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       if (__pyx_t_4) {
         __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
       }
       __Pyx_INCREF(__pyx_v_X_te);
       __Pyx_GIVEREF(__pyx_v_X_te);
       PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_6, __pyx_v_X_te);
       __Pyx_INCREF(__pyx_v_tree_node);
       __Pyx_GIVEREF(__pyx_v_tree_node);
       PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_6, __pyx_v_tree_node);
       __Pyx_INCREF(__pyx_v_col_to_int_dict);
       __Pyx_GIVEREF(__pyx_v_col_to_int_dict);
       PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_6, __pyx_v_col_to_int_dict);
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 151, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 150, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     }
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_v_split_bool = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":152
+    /* "structureboost/structure_dt_multi.pyx":151
  *         else:
  *             split_bool = stdt.get_node_response_df_val(X_te, tree_node, col_to_int_dict)
  *             vec_len = len(split_bool)             # <<<<<<<<<<<<<<
  *             next_vec = np.zeros((vec_len,self.num_classes))
- *             ind_subset_left = np.empty(vec_len, dtype=np.int64)
+ *             ind_subset_left = np.empty(vec_len, dtype=np.int_)
  */
-    __pyx_t_8 = PyObject_Length(__pyx_v_split_bool); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 152, __pyx_L1_error)
+    __pyx_t_8 = PyObject_Length(__pyx_v_split_bool); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 151, __pyx_L1_error)
     __pyx_v_vec_len = __pyx_t_8;
 
-    /* "structureboost/structure_dt_multi.pyx":153
+    /* "structureboost/structure_dt_multi.pyx":152
  *             split_bool = stdt.get_node_response_df_val(X_te, tree_node, col_to_int_dict)
  *             vec_len = len(split_bool)
  *             next_vec = np.zeros((vec_len,self.num_classes))             # <<<<<<<<<<<<<<
- *             ind_subset_left = np.empty(vec_len, dtype=np.int64)
- *             ind_subset_right = np.empty(vec_len, dtype=np.int64)
+ *             ind_subset_left = np.empty(vec_len, dtype=np.int_)
+ *             ind_subset_right = np.empty(vec_len, dtype=np.int_)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 153, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 152, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 153, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 152, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyInt_From_long(__pyx_v_vec_len); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 153, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_long(__pyx_v_vec_len); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 152, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 153, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_classes); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 152, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 153, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 152, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
     __pyx_t_7 = 0;
     __pyx_t_4 = 0;
@@ -6408,18 +6399,18 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 153, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 152, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 153, __pyx_L1_error)
+    if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 152, __pyx_L1_error)
     __pyx_t_9 = ((PyArrayObject *)__pyx_t_1);
     {
       __Pyx_BufFmt_StackElem __pyx_stack[1];
       __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_next_vec.rcbuffer->pybuffer);
       __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_next_vec.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
       if (unlikely(__pyx_t_6 < 0)) {
         PyErr_Fetch(&__pyx_t_10, &__pyx_t_11, &__pyx_t_12);
@@ -6428,157 +6419,157 @@
           __Pyx_RaiseBufferFallbackError();
         } else {
           PyErr_Restore(__pyx_t_10, __pyx_t_11, __pyx_t_12);
         }
         __pyx_t_10 = __pyx_t_11 = __pyx_t_12 = 0;
       }
       __pyx_pybuffernd_next_vec.diminfo[0].strides = __pyx_pybuffernd_next_vec.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_next_vec.diminfo[0].shape = __pyx_pybuffernd_next_vec.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_next_vec.diminfo[1].strides = __pyx_pybuffernd_next_vec.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_next_vec.diminfo[1].shape = __pyx_pybuffernd_next_vec.rcbuffer->pybuffer.shape[1];
-      if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 153, __pyx_L1_error)
+      if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 152, __pyx_L1_error)
     }
     __pyx_t_9 = 0;
     __pyx_v_next_vec = ((PyArrayObject *)__pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":154
+    /* "structureboost/structure_dt_multi.pyx":153
  *             vec_len = len(split_bool)
  *             next_vec = np.zeros((vec_len,self.num_classes))
- *             ind_subset_left = np.empty(vec_len, dtype=np.int64)             # <<<<<<<<<<<<<<
- *             ind_subset_right = np.empty(vec_len, dtype=np.int64)
+ *             ind_subset_left = np.empty(vec_len, dtype=np.int_)             # <<<<<<<<<<<<<<
+ *             ind_subset_right = np.empty(vec_len, dtype=np.int_)
  *             ind_subset_left, ind_subset_right, lsize = stdt.separate_indices(
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 154, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 153, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 154, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_empty); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 153, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_vec_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 154, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_vec_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 153, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 154, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 153, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 154, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 153, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 154, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 153, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 154, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_int); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 153, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 154, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 153, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 154, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 153, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 154, __pyx_L1_error)
+    if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 153, __pyx_L1_error)
     __pyx_t_13 = ((PyArrayObject *)__pyx_t_7);
     {
       __Pyx_BufFmt_StackElem __pyx_stack[1];
       __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer);
-      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
       if (unlikely(__pyx_t_6 < 0)) {
         PyErr_Fetch(&__pyx_t_12, &__pyx_t_11, &__pyx_t_10);
-        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_left, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_left, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
           Py_XDECREF(__pyx_t_12); Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10);
           __Pyx_RaiseBufferFallbackError();
         } else {
           PyErr_Restore(__pyx_t_12, __pyx_t_11, __pyx_t_10);
         }
         __pyx_t_12 = __pyx_t_11 = __pyx_t_10 = 0;
       }
       __pyx_pybuffernd_ind_subset_left.diminfo[0].strides = __pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_ind_subset_left.diminfo[0].shape = __pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer.shape[0];
-      if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 154, __pyx_L1_error)
+      if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 153, __pyx_L1_error)
     }
     __pyx_t_13 = 0;
     __pyx_v_ind_subset_left = ((PyArrayObject *)__pyx_t_7);
     __pyx_t_7 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":155
+    /* "structureboost/structure_dt_multi.pyx":154
  *             next_vec = np.zeros((vec_len,self.num_classes))
- *             ind_subset_left = np.empty(vec_len, dtype=np.int64)
- *             ind_subset_right = np.empty(vec_len, dtype=np.int64)             # <<<<<<<<<<<<<<
+ *             ind_subset_left = np.empty(vec_len, dtype=np.int_)
+ *             ind_subset_right = np.empty(vec_len, dtype=np.int_)             # <<<<<<<<<<<<<<
  *             ind_subset_left, ind_subset_right, lsize = stdt.separate_indices(
  *                                                     ind_subset_left,
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 155, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 154, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 155, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 154, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyInt_From_long(__pyx_v_vec_len); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 155, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_From_long(__pyx_v_vec_len); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 154, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 155, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 154, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_7);
     __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 155, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 154, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 155, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 154, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 155, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 154, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 155, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 154, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 155, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 154, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 155, __pyx_L1_error)
+    if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 154, __pyx_L1_error)
     __pyx_t_13 = ((PyArrayObject *)__pyx_t_4);
     {
       __Pyx_BufFmt_StackElem __pyx_stack[1];
       __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer);
-      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
       if (unlikely(__pyx_t_6 < 0)) {
         PyErr_Fetch(&__pyx_t_10, &__pyx_t_11, &__pyx_t_12);
-        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_right, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_right, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
           Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_12);
           __Pyx_RaiseBufferFallbackError();
         } else {
           PyErr_Restore(__pyx_t_10, __pyx_t_11, __pyx_t_12);
         }
         __pyx_t_10 = __pyx_t_11 = __pyx_t_12 = 0;
       }
       __pyx_pybuffernd_ind_subset_right.diminfo[0].strides = __pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_ind_subset_right.diminfo[0].shape = __pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer.shape[0];
-      if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 155, __pyx_L1_error)
+      if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 154, __pyx_L1_error)
     }
     __pyx_t_13 = 0;
     __pyx_v_ind_subset_right = ((PyArrayObject *)__pyx_t_4);
     __pyx_t_4 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":156
- *             ind_subset_left = np.empty(vec_len, dtype=np.int64)
- *             ind_subset_right = np.empty(vec_len, dtype=np.int64)
+    /* "structureboost/structure_dt_multi.pyx":155
+ *             ind_subset_left = np.empty(vec_len, dtype=np.int_)
+ *             ind_subset_right = np.empty(vec_len, dtype=np.int_)
  *             ind_subset_left, ind_subset_right, lsize = stdt.separate_indices(             # <<<<<<<<<<<<<<
  *                                                     ind_subset_left,
  *                                                     ind_subset_right,
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_stdt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 156, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_stdt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 155, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_separate_indices); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 156, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_separate_indices); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 155, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":159
+    /* "structureboost/structure_dt_multi.pyx":158
  *                                                     ind_subset_left,
  *                                                     ind_subset_right,
- *                                                     split_bool.astype(np.int64),             # <<<<<<<<<<<<<<
+ *                                                     split_bool.astype(np.int_),             # <<<<<<<<<<<<<<
  *                                                     vec_len)
  *             ind_subset_left = ind_subset_left[:lsize]
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_split_bool, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 159, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_split_bool, __pyx_n_s_astype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 158, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 159, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 158, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int64); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 159, __pyx_L1_error)
+    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 158, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_14);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -6586,26 +6577,26 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_7 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_t_14) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_14);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 159, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 158, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":160
+    /* "structureboost/structure_dt_multi.pyx":159
  *                                                     ind_subset_right,
- *                                                     split_bool.astype(np.int64),
+ *                                                     split_bool.astype(np.int_),
  *                                                     vec_len)             # <<<<<<<<<<<<<<
  *             ind_subset_left = ind_subset_left[:lsize]
  *             ind_subset_right = ind_subset_right[:(vec_len-lsize)]
  */
-    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_vec_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 160, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyInt_From_long(__pyx_v_vec_len); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 159, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_14 = NULL;
     __pyx_t_6 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_14 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_14)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -6614,33 +6605,33 @@
         __Pyx_DECREF_SET(__pyx_t_3, function);
         __pyx_t_6 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[5] = {__pyx_t_14, ((PyObject *)__pyx_v_ind_subset_left), ((PyObject *)__pyx_v_ind_subset_right), __pyx_t_7, __pyx_t_1};
-      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 156, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 155, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[5] = {__pyx_t_14, ((PyObject *)__pyx_v_ind_subset_left), ((PyObject *)__pyx_v_ind_subset_right), __pyx_t_7, __pyx_t_1};
-      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 156, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 155, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_14); __pyx_t_14 = 0;
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     } else
     #endif
     {
-      __pyx_t_5 = PyTuple_New(4+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 156, __pyx_L1_error)
+      __pyx_t_5 = PyTuple_New(4+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 155, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       if (__pyx_t_14) {
         __Pyx_GIVEREF(__pyx_t_14); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_14); __pyx_t_14 = NULL;
       }
       __Pyx_INCREF(((PyObject *)__pyx_v_ind_subset_left));
       __Pyx_GIVEREF(((PyObject *)__pyx_v_ind_subset_left));
       PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_6, ((PyObject *)__pyx_v_ind_subset_left));
@@ -6649,26 +6640,26 @@
       PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_6, ((PyObject *)__pyx_v_ind_subset_right));
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_6, __pyx_t_7);
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_5, 3+__pyx_t_6, __pyx_t_1);
       __pyx_t_7 = 0;
       __pyx_t_1 = 0;
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 156, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 155, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if ((likely(PyTuple_CheckExact(__pyx_t_4))) || (PyList_CheckExact(__pyx_t_4))) {
       PyObject* sequence = __pyx_t_4;
       Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
       if (unlikely(size != 3)) {
         if (size > 3) __Pyx_RaiseTooManyValuesError(3);
         else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-        __PYX_ERR(0, 156, __pyx_L1_error)
+        __PYX_ERR(0, 155, __pyx_L1_error)
       }
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
       if (likely(PyTuple_CheckExact(sequence))) {
         __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
         __pyx_t_5 = PyTuple_GET_ITEM(sequence, 1); 
         __pyx_t_1 = PyTuple_GET_ITEM(sequence, 2); 
       } else {
@@ -6676,219 +6667,219 @@
         __pyx_t_5 = PyList_GET_ITEM(sequence, 1); 
         __pyx_t_1 = PyList_GET_ITEM(sequence, 2); 
       }
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_1);
       #else
-      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 156, __pyx_L1_error)
+      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 155, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 156, __pyx_L1_error)
+      __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 155, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_1 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 156, __pyx_L1_error)
+      __pyx_t_1 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 155, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       #endif
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     } else {
       Py_ssize_t index = -1;
-      __pyx_t_7 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 156, __pyx_L1_error)
+      __pyx_t_7 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 155, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_15 = Py_TYPE(__pyx_t_7)->tp_iternext;
       index = 0; __pyx_t_3 = __pyx_t_15(__pyx_t_7); if (unlikely(!__pyx_t_3)) goto __pyx_L4_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_3);
       index = 1; __pyx_t_5 = __pyx_t_15(__pyx_t_7); if (unlikely(!__pyx_t_5)) goto __pyx_L4_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_5);
       index = 2; __pyx_t_1 = __pyx_t_15(__pyx_t_7); if (unlikely(!__pyx_t_1)) goto __pyx_L4_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_1);
-      if (__Pyx_IternextUnpackEndCheck(__pyx_t_15(__pyx_t_7), 3) < 0) __PYX_ERR(0, 156, __pyx_L1_error)
+      if (__Pyx_IternextUnpackEndCheck(__pyx_t_15(__pyx_t_7), 3) < 0) __PYX_ERR(0, 155, __pyx_L1_error)
       __pyx_t_15 = NULL;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       goto __pyx_L5_unpacking_done;
       __pyx_L4_unpacking_failed:;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __pyx_t_15 = NULL;
       if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-      __PYX_ERR(0, 156, __pyx_L1_error)
+      __PYX_ERR(0, 155, __pyx_L1_error)
       __pyx_L5_unpacking_done:;
     }
 
-    /* "structureboost/structure_dt_multi.pyx":156
- *             ind_subset_left = np.empty(vec_len, dtype=np.int64)
- *             ind_subset_right = np.empty(vec_len, dtype=np.int64)
+    /* "structureboost/structure_dt_multi.pyx":155
+ *             ind_subset_left = np.empty(vec_len, dtype=np.int_)
+ *             ind_subset_right = np.empty(vec_len, dtype=np.int_)
  *             ind_subset_left, ind_subset_right, lsize = stdt.separate_indices(             # <<<<<<<<<<<<<<
  *                                                     ind_subset_left,
  *                                                     ind_subset_right,
  */
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 156, __pyx_L1_error)
-    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 156, __pyx_L1_error)
-    __pyx_t_16 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_16 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 156, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 155, __pyx_L1_error)
+    if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 155, __pyx_L1_error)
+    __pyx_t_16 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_16 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 155, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_13 = ((PyArrayObject *)__pyx_t_3);
     {
       __Pyx_BufFmt_StackElem __pyx_stack[1];
       __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer);
-      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
       if (unlikely(__pyx_t_6 < 0)) {
         PyErr_Fetch(&__pyx_t_12, &__pyx_t_11, &__pyx_t_10);
-        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_left, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_left, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
           Py_XDECREF(__pyx_t_12); Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10);
           __Pyx_RaiseBufferFallbackError();
         } else {
           PyErr_Restore(__pyx_t_12, __pyx_t_11, __pyx_t_10);
         }
         __pyx_t_12 = __pyx_t_11 = __pyx_t_10 = 0;
       }
       __pyx_pybuffernd_ind_subset_left.diminfo[0].strides = __pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_ind_subset_left.diminfo[0].shape = __pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer.shape[0];
-      if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 156, __pyx_L1_error)
+      if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 155, __pyx_L1_error)
     }
     __pyx_t_13 = 0;
     __Pyx_DECREF_SET(__pyx_v_ind_subset_left, ((PyArrayObject *)__pyx_t_3));
     __pyx_t_3 = 0;
     __pyx_t_13 = ((PyArrayObject *)__pyx_t_5);
     {
       __Pyx_BufFmt_StackElem __pyx_stack[1];
       __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer);
-      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
       if (unlikely(__pyx_t_6 < 0)) {
         PyErr_Fetch(&__pyx_t_10, &__pyx_t_11, &__pyx_t_12);
-        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_right, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_right, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
           Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_12);
           __Pyx_RaiseBufferFallbackError();
         } else {
           PyErr_Restore(__pyx_t_10, __pyx_t_11, __pyx_t_12);
         }
         __pyx_t_10 = __pyx_t_11 = __pyx_t_12 = 0;
       }
       __pyx_pybuffernd_ind_subset_right.diminfo[0].strides = __pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_ind_subset_right.diminfo[0].shape = __pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer.shape[0];
-      if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 156, __pyx_L1_error)
+      if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 155, __pyx_L1_error)
     }
     __pyx_t_13 = 0;
     __Pyx_DECREF_SET(__pyx_v_ind_subset_right, ((PyArrayObject *)__pyx_t_5));
     __pyx_t_5 = 0;
     __pyx_v_lsize = __pyx_t_16;
 
-    /* "structureboost/structure_dt_multi.pyx":161
- *                                                     split_bool.astype(np.int64),
+    /* "structureboost/structure_dt_multi.pyx":160
+ *                                                     split_bool.astype(np.int_),
  *                                                     vec_len)
  *             ind_subset_left = ind_subset_left[:lsize]             # <<<<<<<<<<<<<<
  *             ind_subset_right = ind_subset_right[:(vec_len-lsize)]
  * 
  */
-    __pyx_t_4 = __Pyx_PyInt_From_long(__pyx_v_lsize); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 161, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_From_long(__pyx_v_lsize); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 160, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = PySlice_New(Py_None, __pyx_t_4, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 161, __pyx_L1_error)
+    __pyx_t_1 = PySlice_New(Py_None, __pyx_t_4, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 160, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_ind_subset_left), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 161, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_ind_subset_left), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 160, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 161, __pyx_L1_error)
+    if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 160, __pyx_L1_error)
     __pyx_t_13 = ((PyArrayObject *)__pyx_t_4);
     {
       __Pyx_BufFmt_StackElem __pyx_stack[1];
       __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer);
-      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
       if (unlikely(__pyx_t_6 < 0)) {
         PyErr_Fetch(&__pyx_t_12, &__pyx_t_11, &__pyx_t_10);
-        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_left, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_left, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
           Py_XDECREF(__pyx_t_12); Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_10);
           __Pyx_RaiseBufferFallbackError();
         } else {
           PyErr_Restore(__pyx_t_12, __pyx_t_11, __pyx_t_10);
         }
         __pyx_t_12 = __pyx_t_11 = __pyx_t_10 = 0;
       }
       __pyx_pybuffernd_ind_subset_left.diminfo[0].strides = __pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_ind_subset_left.diminfo[0].shape = __pyx_pybuffernd_ind_subset_left.rcbuffer->pybuffer.shape[0];
-      if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 161, __pyx_L1_error)
+      if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 160, __pyx_L1_error)
     }
     __pyx_t_13 = 0;
     __Pyx_DECREF_SET(__pyx_v_ind_subset_left, ((PyArrayObject *)__pyx_t_4));
     __pyx_t_4 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":162
+    /* "structureboost/structure_dt_multi.pyx":161
  *                                                     vec_len)
  *             ind_subset_left = ind_subset_left[:lsize]
  *             ind_subset_right = ind_subset_right[:(vec_len-lsize)]             # <<<<<<<<<<<<<<
  * 
  *             if lsize > 0:
  */
-    __pyx_t_4 = __Pyx_PyInt_From_long((__pyx_v_vec_len - __pyx_v_lsize)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 162, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_From_long((__pyx_v_vec_len - __pyx_v_lsize)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 161, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = PySlice_New(Py_None, __pyx_t_4, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 162, __pyx_L1_error)
+    __pyx_t_1 = PySlice_New(Py_None, __pyx_t_4, Py_None); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 161, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_ind_subset_right), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 162, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_ind_subset_right), __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 161, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 162, __pyx_L1_error)
+    if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 161, __pyx_L1_error)
     __pyx_t_13 = ((PyArrayObject *)__pyx_t_4);
     {
       __Pyx_BufFmt_StackElem __pyx_stack[1];
       __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer);
-      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
+      __pyx_t_6 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
       if (unlikely(__pyx_t_6 < 0)) {
         PyErr_Fetch(&__pyx_t_10, &__pyx_t_11, &__pyx_t_12);
-        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_right, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
+        if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_ind_subset_right, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
           Py_XDECREF(__pyx_t_10); Py_XDECREF(__pyx_t_11); Py_XDECREF(__pyx_t_12);
           __Pyx_RaiseBufferFallbackError();
         } else {
           PyErr_Restore(__pyx_t_10, __pyx_t_11, __pyx_t_12);
         }
         __pyx_t_10 = __pyx_t_11 = __pyx_t_12 = 0;
       }
       __pyx_pybuffernd_ind_subset_right.diminfo[0].strides = __pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_ind_subset_right.diminfo[0].shape = __pyx_pybuffernd_ind_subset_right.rcbuffer->pybuffer.shape[0];
-      if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 162, __pyx_L1_error)
+      if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 161, __pyx_L1_error)
     }
     __pyx_t_13 = 0;
     __Pyx_DECREF_SET(__pyx_v_ind_subset_right, ((PyArrayObject *)__pyx_t_4));
     __pyx_t_4 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":164
+    /* "structureboost/structure_dt_multi.pyx":163
  *             ind_subset_right = ind_subset_right[:(vec_len-lsize)]
  * 
  *             if lsize > 0:             # <<<<<<<<<<<<<<
  *                 next_vec[ind_subset_left,:] = self.get_prediction(tree_node['left_child'],
  *                                                            X_te[
  */
     __pyx_t_2 = ((__pyx_v_lsize > 0) != 0);
     if (__pyx_t_2) {
 
-      /* "structureboost/structure_dt_multi.pyx":165
+      /* "structureboost/structure_dt_multi.pyx":164
  * 
  *             if lsize > 0:
  *                 next_vec[ind_subset_left,:] = self.get_prediction(tree_node['left_child'],             # <<<<<<<<<<<<<<
  *                                                            X_te[
  *                                                            ind_subset_left, :],
  */
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_prediction); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 165, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_prediction); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 164, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_v_tree_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 165, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_v_tree_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 164, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
 
-      /* "structureboost/structure_dt_multi.pyx":166
+      /* "structureboost/structure_dt_multi.pyx":165
  *             if lsize > 0:
  *                 next_vec[ind_subset_left,:] = self.get_prediction(tree_node['left_child'],
  *                                                            X_te[             # <<<<<<<<<<<<<<
  *                                                            ind_subset_left, :],
  *                                                            col_to_int_dict)
  */
-      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 166, __pyx_L1_error)
+      __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 165, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_INCREF(((PyObject *)__pyx_v_ind_subset_left));
       __Pyx_GIVEREF(((PyObject *)__pyx_v_ind_subset_left));
       PyTuple_SET_ITEM(__pyx_t_3, 0, ((PyObject *)__pyx_v_ind_subset_left));
       __Pyx_INCREF(__pyx_slice__3);
       __Pyx_GIVEREF(__pyx_slice__3);
       PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_slice__3);
-      __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_X_te, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 166, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_X_te, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 165, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "structureboost/structure_dt_multi.pyx":168
+      /* "structureboost/structure_dt_multi.pyx":167
  *                                                            X_te[
  *                                                            ind_subset_left, :],
  *                                                            col_to_int_dict)             # <<<<<<<<<<<<<<
  * 
  *             if lsize < vec_len:
  */
       __pyx_t_3 = NULL;
@@ -6902,130 +6893,130 @@
           __Pyx_DECREF_SET(__pyx_t_1, function);
           __pyx_t_6 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_5, __pyx_t_7, __pyx_v_col_to_int_dict};
-        __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 165, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 164, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_t_5, __pyx_t_7, __pyx_v_col_to_int_dict};
-        __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 165, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 164, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       } else
       #endif
       {
-        __pyx_t_14 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 165, __pyx_L1_error)
+        __pyx_t_14 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 164, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_14);
         if (__pyx_t_3) {
           __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_3); __pyx_t_3 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_5);
         PyTuple_SET_ITEM(__pyx_t_14, 0+__pyx_t_6, __pyx_t_5);
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_14, 1+__pyx_t_6, __pyx_t_7);
         __Pyx_INCREF(__pyx_v_col_to_int_dict);
         __Pyx_GIVEREF(__pyx_v_col_to_int_dict);
         PyTuple_SET_ITEM(__pyx_t_14, 2+__pyx_t_6, __pyx_v_col_to_int_dict);
         __pyx_t_5 = 0;
         __pyx_t_7 = 0;
-        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_14, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 165, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_14, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 164, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "structureboost/structure_dt_multi.pyx":165
+      /* "structureboost/structure_dt_multi.pyx":164
  * 
  *             if lsize > 0:
  *                 next_vec[ind_subset_left,:] = self.get_prediction(tree_node['left_child'],             # <<<<<<<<<<<<<<
  *                                                            X_te[
  *                                                            ind_subset_left, :],
  */
-      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 165, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 164, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(((PyObject *)__pyx_v_ind_subset_left));
       __Pyx_GIVEREF(((PyObject *)__pyx_v_ind_subset_left));
       PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_ind_subset_left));
       __Pyx_INCREF(__pyx_slice__3);
       __Pyx_GIVEREF(__pyx_slice__3);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_slice__3);
-      if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_next_vec), __pyx_t_1, __pyx_t_4) < 0)) __PYX_ERR(0, 165, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_next_vec), __pyx_t_1, __pyx_t_4) < 0)) __PYX_ERR(0, 164, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "structureboost/structure_dt_multi.pyx":164
+      /* "structureboost/structure_dt_multi.pyx":163
  *             ind_subset_right = ind_subset_right[:(vec_len-lsize)]
  * 
  *             if lsize > 0:             # <<<<<<<<<<<<<<
  *                 next_vec[ind_subset_left,:] = self.get_prediction(tree_node['left_child'],
  *                                                            X_te[
  */
     }
 
-    /* "structureboost/structure_dt_multi.pyx":170
+    /* "structureboost/structure_dt_multi.pyx":169
  *                                                            col_to_int_dict)
  * 
  *             if lsize < vec_len:             # <<<<<<<<<<<<<<
  *                 next_vec[ind_subset_right,:] = self.get_prediction(
  *                                                 tree_node['right_child'],
  */
     __pyx_t_2 = ((__pyx_v_lsize < __pyx_v_vec_len) != 0);
     if (__pyx_t_2) {
 
-      /* "structureboost/structure_dt_multi.pyx":171
+      /* "structureboost/structure_dt_multi.pyx":170
  * 
  *             if lsize < vec_len:
  *                 next_vec[ind_subset_right,:] = self.get_prediction(             # <<<<<<<<<<<<<<
  *                                                 tree_node['right_child'],
  *                                                 X_te[ind_subset_right, :],
  */
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_prediction); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 171, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_prediction); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 170, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
 
-      /* "structureboost/structure_dt_multi.pyx":172
+      /* "structureboost/structure_dt_multi.pyx":171
  *             if lsize < vec_len:
  *                 next_vec[ind_subset_right,:] = self.get_prediction(
  *                                                 tree_node['right_child'],             # <<<<<<<<<<<<<<
  *                                                 X_te[ind_subset_right, :],
  *                                                 col_to_int_dict)
  */
-      __pyx_t_14 = __Pyx_PyObject_Dict_GetItem(__pyx_v_tree_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 172, __pyx_L1_error)
+      __pyx_t_14 = __Pyx_PyObject_Dict_GetItem(__pyx_v_tree_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 171, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_14);
 
-      /* "structureboost/structure_dt_multi.pyx":173
+      /* "structureboost/structure_dt_multi.pyx":172
  *                 next_vec[ind_subset_right,:] = self.get_prediction(
  *                                                 tree_node['right_child'],
  *                                                 X_te[ind_subset_right, :],             # <<<<<<<<<<<<<<
  *                                                 col_to_int_dict)
  *             return next_vec
  */
-      __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 173, __pyx_L1_error)
+      __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 172, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_INCREF(((PyObject *)__pyx_v_ind_subset_right));
       __Pyx_GIVEREF(((PyObject *)__pyx_v_ind_subset_right));
       PyTuple_SET_ITEM(__pyx_t_7, 0, ((PyObject *)__pyx_v_ind_subset_right));
       __Pyx_INCREF(__pyx_slice__3);
       __Pyx_GIVEREF(__pyx_slice__3);
       PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_slice__3);
-      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_X_te, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 173, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_X_te, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 172, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "structureboost/structure_dt_multi.pyx":174
+      /* "structureboost/structure_dt_multi.pyx":173
  *                                                 tree_node['right_child'],
  *                                                 X_te[ind_subset_right, :],
  *                                                 col_to_int_dict)             # <<<<<<<<<<<<<<
  *             return next_vec
  * 
  */
       __pyx_t_7 = NULL;
@@ -7039,98 +7030,98 @@
           __Pyx_DECREF_SET(__pyx_t_1, function);
           __pyx_t_6 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_t_14, __pyx_t_5, __pyx_v_col_to_int_dict};
-        __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 171, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 170, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_t_14, __pyx_t_5, __pyx_v_col_to_int_dict};
-        __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 171, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 170, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       } else
       #endif
       {
-        __pyx_t_3 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 171, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_New(3+__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 170, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         if (__pyx_t_7) {
           __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_7); __pyx_t_7 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_14);
         PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_6, __pyx_t_14);
         __Pyx_GIVEREF(__pyx_t_5);
         PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_6, __pyx_t_5);
         __Pyx_INCREF(__pyx_v_col_to_int_dict);
         __Pyx_GIVEREF(__pyx_v_col_to_int_dict);
         PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_6, __pyx_v_col_to_int_dict);
         __pyx_t_14 = 0;
         __pyx_t_5 = 0;
-        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 171, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 170, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "structureboost/structure_dt_multi.pyx":171
+      /* "structureboost/structure_dt_multi.pyx":170
  * 
  *             if lsize < vec_len:
  *                 next_vec[ind_subset_right,:] = self.get_prediction(             # <<<<<<<<<<<<<<
  *                                                 tree_node['right_child'],
  *                                                 X_te[ind_subset_right, :],
  */
-      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 171, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 170, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(((PyObject *)__pyx_v_ind_subset_right));
       __Pyx_GIVEREF(((PyObject *)__pyx_v_ind_subset_right));
       PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_ind_subset_right));
       __Pyx_INCREF(__pyx_slice__3);
       __Pyx_GIVEREF(__pyx_slice__3);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_slice__3);
-      if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_next_vec), __pyx_t_1, __pyx_t_4) < 0)) __PYX_ERR(0, 171, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_next_vec), __pyx_t_1, __pyx_t_4) < 0)) __PYX_ERR(0, 170, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "structureboost/structure_dt_multi.pyx":170
+      /* "structureboost/structure_dt_multi.pyx":169
  *                                                            col_to_int_dict)
  * 
  *             if lsize < vec_len:             # <<<<<<<<<<<<<<
  *                 next_vec[ind_subset_right,:] = self.get_prediction(
  *                                                 tree_node['right_child'],
  */
     }
 
-    /* "structureboost/structure_dt_multi.pyx":175
+    /* "structureboost/structure_dt_multi.pyx":174
  *                                                 X_te[ind_subset_right, :],
  *                                                 col_to_int_dict)
  *             return next_vec             # <<<<<<<<<<<<<<
  * 
  * 
  */
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(((PyObject *)__pyx_v_next_vec));
     __pyx_r = ((PyObject *)__pyx_v_next_vec);
     goto __pyx_L0;
   }
 
-  /* "structureboost/structure_dt_multi.pyx":143
+  /* "structureboost/structure_dt_multi.pyx":142
  * 
  * 
  *     def get_prediction(self, tree_node, X_te, dict col_to_int_dict):             # <<<<<<<<<<<<<<
- *         cdef np.ndarray[dtype_int64_t] ind_subset_left, ind_subset_right
+ *         cdef np.ndarray[np.int_t] ind_subset_left, ind_subset_right
  *         cdef long vec_len, lsize
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_3);
@@ -7160,18 +7151,18 @@
   __Pyx_XDECREF(__pyx_v_split_bool);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_dt_multi.pyx":180
+/* "structureboost/structure_dt_multi.pyx":179
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * def get_g_h_feature_sum_matrix(np.ndarray[dtype_int64_t] feature_vec_node,             # <<<<<<<<<<<<<<
+ * def get_g_h_feature_sum_matrix(np.ndarray[np.int_t] feature_vec_node,             # <<<<<<<<<<<<<<
  *                                np.ndarray[double, ndim=2] g_h_train_node,
  *                                np.ndarray[double, ndim=2] g_h_val_arr,
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_18structure_dt_multi_1get_g_h_feature_sum_matrix(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_18structure_dt_multi_1get_g_h_feature_sum_matrix = {"get_g_h_feature_sum_matrix", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_18structure_dt_multi_1get_g_h_feature_sum_matrix, METH_VARARGS|METH_KEYWORDS, 0};
@@ -7209,56 +7200,56 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_feature_vec_node)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g_h_train_node)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_g_h_feature_sum_matrix", 1, 4, 4, 1); __PYX_ERR(0, 180, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_g_h_feature_sum_matrix", 1, 4, 4, 1); __PYX_ERR(0, 179, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g_h_val_arr)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_g_h_feature_sum_matrix", 1, 4, 4, 2); __PYX_ERR(0, 180, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_g_h_feature_sum_matrix", 1, 4, 4, 2); __PYX_ERR(0, 179, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num_classes)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_g_h_feature_sum_matrix", 1, 4, 4, 3); __PYX_ERR(0, 180, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_g_h_feature_sum_matrix", 1, 4, 4, 3); __PYX_ERR(0, 179, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_g_h_feature_sum_matrix") < 0)) __PYX_ERR(0, 180, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_g_h_feature_sum_matrix") < 0)) __PYX_ERR(0, 179, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
     }
     __pyx_v_feature_vec_node = ((PyArrayObject *)values[0]);
     __pyx_v_g_h_train_node = ((PyArrayObject *)values[1]);
     __pyx_v_g_h_val_arr = ((PyArrayObject *)values[2]);
-    __pyx_v_num_classes = __Pyx_PyInt_As_long(values[3]); if (unlikely((__pyx_v_num_classes == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 183, __pyx_L3_error)
+    __pyx_v_num_classes = __Pyx_PyInt_As_long(values[3]); if (unlikely((__pyx_v_num_classes == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 182, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("get_g_h_feature_sum_matrix", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 180, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("get_g_h_feature_sum_matrix", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 179, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_dt_multi.get_g_h_feature_sum_matrix", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_feature_vec_node), __pyx_ptype_5numpy_ndarray, 1, "feature_vec_node", 0))) __PYX_ERR(0, 180, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g_h_train_node), __pyx_ptype_5numpy_ndarray, 1, "g_h_train_node", 0))) __PYX_ERR(0, 181, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g_h_val_arr), __pyx_ptype_5numpy_ndarray, 1, "g_h_val_arr", 0))) __PYX_ERR(0, 182, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_feature_vec_node), __pyx_ptype_5numpy_ndarray, 1, "feature_vec_node", 0))) __PYX_ERR(0, 179, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g_h_train_node), __pyx_ptype_5numpy_ndarray, 1, "g_h_train_node", 0))) __PYX_ERR(0, 180, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g_h_val_arr), __pyx_ptype_5numpy_ndarray, 1, "g_h_val_arr", 0))) __PYX_ERR(0, 181, __pyx_L1_error)
   __pyx_r = __pyx_pf_14structureboost_18structure_dt_multi_get_g_h_feature_sum_matrix(__pyx_self, __pyx_v_feature_vec_node, __pyx_v_g_h_train_node, __pyx_v_g_h_val_arr, __pyx_v_num_classes);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -7292,118 +7283,118 @@
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__14)
   __Pyx_RefNannySetupContext("get_g_h_feature_sum_matrix", 0);
-  __Pyx_TraceCall("get_g_h_feature_sum_matrix", __pyx_f[0], 180, 0, __PYX_ERR(0, 180, __pyx_L1_error));
+  __Pyx_TraceCall("get_g_h_feature_sum_matrix", __pyx_f[0], 179, 0, __PYX_ERR(0, 179, __pyx_L1_error));
   __pyx_pybuffer_feature_vec_node.pybuffer.buf = NULL;
   __pyx_pybuffer_feature_vec_node.refcount = 0;
   __pyx_pybuffernd_feature_vec_node.data = NULL;
   __pyx_pybuffernd_feature_vec_node.rcbuffer = &__pyx_pybuffer_feature_vec_node;
   __pyx_pybuffer_g_h_train_node.pybuffer.buf = NULL;
   __pyx_pybuffer_g_h_train_node.refcount = 0;
   __pyx_pybuffernd_g_h_train_node.data = NULL;
   __pyx_pybuffernd_g_h_train_node.rcbuffer = &__pyx_pybuffer_g_h_train_node;
   __pyx_pybuffer_g_h_val_arr.pybuffer.buf = NULL;
   __pyx_pybuffer_g_h_val_arr.refcount = 0;
   __pyx_pybuffernd_g_h_val_arr.data = NULL;
   __pyx_pybuffernd_g_h_val_arr.rcbuffer = &__pyx_pybuffer_g_h_val_arr;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer, (PyObject*)__pyx_v_feature_vec_node, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 180, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer, (PyObject*)__pyx_v_feature_vec_node, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 179, __pyx_L1_error)
   }
   __pyx_pybuffernd_feature_vec_node.diminfo[0].strides = __pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_feature_vec_node.diminfo[0].shape = __pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_h_train_node.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_h_train_node, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 180, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_h_train_node.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_h_train_node, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 179, __pyx_L1_error)
   }
   __pyx_pybuffernd_g_h_train_node.diminfo[0].strides = __pyx_pybuffernd_g_h_train_node.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_g_h_train_node.diminfo[0].shape = __pyx_pybuffernd_g_h_train_node.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_g_h_train_node.diminfo[1].strides = __pyx_pybuffernd_g_h_train_node.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_g_h_train_node.diminfo[1].shape = __pyx_pybuffernd_g_h_train_node.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_h_val_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_h_val_arr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 180, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_h_val_arr.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_h_val_arr, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 179, __pyx_L1_error)
   }
   __pyx_pybuffernd_g_h_val_arr.diminfo[0].strides = __pyx_pybuffernd_g_h_val_arr.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_g_h_val_arr.diminfo[0].shape = __pyx_pybuffernd_g_h_val_arr.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_g_h_val_arr.diminfo[1].strides = __pyx_pybuffernd_g_h_val_arr.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_g_h_val_arr.diminfo[1].shape = __pyx_pybuffernd_g_h_val_arr.rcbuffer->pybuffer.shape[1];
 
-  /* "structureboost/structure_dt_multi.pyx":185
+  /* "structureboost/structure_dt_multi.pyx":184
  *                                long num_classes):
  *     cdef long i, ind
  *     cdef long array_size = len(feature_vec_node)             # <<<<<<<<<<<<<<
  *     for i in range(array_size):
  *         for j in range(2*num_classes):
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_feature_vec_node)); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 185, __pyx_L1_error)
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_feature_vec_node)); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 184, __pyx_L1_error)
   __pyx_v_array_size = __pyx_t_1;
 
-  /* "structureboost/structure_dt_multi.pyx":186
+  /* "structureboost/structure_dt_multi.pyx":185
  *     cdef long i, ind
  *     cdef long array_size = len(feature_vec_node)
  *     for i in range(array_size):             # <<<<<<<<<<<<<<
  *         for j in range(2*num_classes):
  *             ind = feature_vec_node[i]
  */
   __pyx_t_2 = __pyx_v_array_size;
   __pyx_t_3 = __pyx_t_2;
   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
     __pyx_v_i = __pyx_t_4;
 
-    /* "structureboost/structure_dt_multi.pyx":187
+    /* "structureboost/structure_dt_multi.pyx":186
  *     cdef long array_size = len(feature_vec_node)
  *     for i in range(array_size):
  *         for j in range(2*num_classes):             # <<<<<<<<<<<<<<
  *             ind = feature_vec_node[i]
  *             g_h_val_arr[ind,j] += g_h_train_node[i,j]
  */
     __pyx_t_5 = (2 * __pyx_v_num_classes);
     __pyx_t_6 = __pyx_t_5;
     for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
       __pyx_v_j = __pyx_t_7;
 
-      /* "structureboost/structure_dt_multi.pyx":188
+      /* "structureboost/structure_dt_multi.pyx":187
  *     for i in range(array_size):
  *         for j in range(2*num_classes):
  *             ind = feature_vec_node[i]             # <<<<<<<<<<<<<<
  *             g_h_val_arr[ind,j] += g_h_train_node[i,j]
  *     return g_h_val_arr
  */
       __pyx_t_8 = __pyx_v_i;
-      __pyx_v_ind = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t *, __pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_feature_vec_node.diminfo[0].strides));
+      __pyx_v_ind = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_feature_vec_node.diminfo[0].strides));
 
-      /* "structureboost/structure_dt_multi.pyx":189
+      /* "structureboost/structure_dt_multi.pyx":188
  *         for j in range(2*num_classes):
  *             ind = feature_vec_node[i]
  *             g_h_val_arr[ind,j] += g_h_train_node[i,j]             # <<<<<<<<<<<<<<
  *     return g_h_val_arr
  * 
  */
       __pyx_t_8 = __pyx_v_i;
       __pyx_t_9 = __pyx_v_j;
       __pyx_t_10 = __pyx_v_ind;
       __pyx_t_11 = __pyx_v_j;
       *__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_g_h_val_arr.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_g_h_val_arr.diminfo[0].strides, __pyx_t_11, __pyx_pybuffernd_g_h_val_arr.diminfo[1].strides) += (*__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_g_h_train_node.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_g_h_train_node.diminfo[0].strides, __pyx_t_9, __pyx_pybuffernd_g_h_train_node.diminfo[1].strides));
     }
   }
 
-  /* "structureboost/structure_dt_multi.pyx":190
+  /* "structureboost/structure_dt_multi.pyx":189
  *             ind = feature_vec_node[i]
  *             g_h_val_arr[ind,j] += g_h_train_node[i,j]
  *     return g_h_val_arr             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_g_h_val_arr));
   __pyx_r = ((PyObject *)__pyx_v_g_h_val_arr);
   goto __pyx_L0;
 
-  /* "structureboost/structure_dt_multi.pyx":180
+  /* "structureboost/structure_dt_multi.pyx":179
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * def get_g_h_feature_sum_matrix(np.ndarray[dtype_int64_t] feature_vec_node,             # <<<<<<<<<<<<<<
+ * def get_g_h_feature_sum_matrix(np.ndarray[np.int_t] feature_vec_node,             # <<<<<<<<<<<<<<
  *                                np.ndarray[double, ndim=2] g_h_train_node,
  *                                np.ndarray[double, ndim=2] g_h_val_arr,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
@@ -7424,15 +7415,15 @@
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_dt_multi.pyx":193
+/* "structureboost/structure_dt_multi.pyx":192
  * 
  * 
  * def _get_gh_score_num_mc(np.ndarray[double] g_left,             # <<<<<<<<<<<<<<
  *                       np.ndarray[double] g_right,
  *                       np.ndarray[double] h_left,
  */
 
@@ -7482,49 +7473,49 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g_left)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g_right)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_get_gh_score_num_mc", 0, 6, 7, 1); __PYX_ERR(0, 193, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_get_gh_score_num_mc", 0, 6, 7, 1); __PYX_ERR(0, 192, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_h_left)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_get_gh_score_num_mc", 0, 6, 7, 2); __PYX_ERR(0, 193, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_get_gh_score_num_mc", 0, 6, 7, 2); __PYX_ERR(0, 192, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_h_right)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_get_gh_score_num_mc", 0, 6, 7, 3); __PYX_ERR(0, 193, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_get_gh_score_num_mc", 0, 6, 7, 3); __PYX_ERR(0, 192, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_gamma)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_get_gh_score_num_mc", 0, 6, 7, 4); __PYX_ERR(0, 193, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_get_gh_score_num_mc", 0, 6, 7, 4); __PYX_ERR(0, 192, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reg_lambda)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_get_gh_score_num_mc", 0, 6, 7, 5); __PYX_ERR(0, 193, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_get_gh_score_num_mc", 0, 6, 7, 5); __PYX_ERR(0, 192, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_tol);
           if (value) { values[6] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_get_gh_score_num_mc") < 0)) __PYX_ERR(0, 193, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_get_gh_score_num_mc") < 0)) __PYX_ERR(0, 192, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
         CYTHON_FALLTHROUGH;
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
@@ -7536,34 +7527,34 @@
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_g_left = ((PyArrayObject *)values[0]);
     __pyx_v_g_right = ((PyArrayObject *)values[1]);
     __pyx_v_h_left = ((PyArrayObject *)values[2]);
     __pyx_v_h_right = ((PyArrayObject *)values[3]);
-    __pyx_v_gamma = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_gamma == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 197, __pyx_L3_error)
-    __pyx_v_reg_lambda = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_reg_lambda == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 197, __pyx_L3_error)
+    __pyx_v_gamma = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_gamma == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 196, __pyx_L3_error)
+    __pyx_v_reg_lambda = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_reg_lambda == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 196, __pyx_L3_error)
     if (values[6]) {
-      __pyx_v_tol = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_tol == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 197, __pyx_L3_error)
+      __pyx_v_tol = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_tol == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 196, __pyx_L3_error)
     } else {
       __pyx_v_tol = ((double)1e-12);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_get_gh_score_num_mc", 0, 6, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 193, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_get_gh_score_num_mc", 0, 6, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 192, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_dt_multi._get_gh_score_num_mc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g_left), __pyx_ptype_5numpy_ndarray, 1, "g_left", 0))) __PYX_ERR(0, 193, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g_right), __pyx_ptype_5numpy_ndarray, 1, "g_right", 0))) __PYX_ERR(0, 194, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_h_left), __pyx_ptype_5numpy_ndarray, 1, "h_left", 0))) __PYX_ERR(0, 195, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_h_right), __pyx_ptype_5numpy_ndarray, 1, "h_right", 0))) __PYX_ERR(0, 196, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g_left), __pyx_ptype_5numpy_ndarray, 1, "g_left", 0))) __PYX_ERR(0, 192, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g_right), __pyx_ptype_5numpy_ndarray, 1, "g_right", 0))) __PYX_ERR(0, 193, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_h_left), __pyx_ptype_5numpy_ndarray, 1, "h_left", 0))) __PYX_ERR(0, 194, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_h_right), __pyx_ptype_5numpy_ndarray, 1, "h_right", 0))) __PYX_ERR(0, 195, __pyx_L1_error)
   __pyx_r = __pyx_pf_14structureboost_18structure_dt_multi_2_get_gh_score_num_mc(__pyx_self, __pyx_v_g_left, __pyx_v_g_right, __pyx_v_h_left, __pyx_v_h_right, __pyx_v_gamma, __pyx_v_reg_lambda, __pyx_v_tol);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -7593,15 +7584,15 @@
   PyObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__15)
   __Pyx_RefNannySetupContext("_get_gh_score_num_mc", 0);
-  __Pyx_TraceCall("_get_gh_score_num_mc", __pyx_f[0], 193, 0, __PYX_ERR(0, 193, __pyx_L1_error));
+  __Pyx_TraceCall("_get_gh_score_num_mc", __pyx_f[0], 192, 0, __PYX_ERR(0, 192, __pyx_L1_error));
   __pyx_pybuffer_g_left.pybuffer.buf = NULL;
   __pyx_pybuffer_g_left.refcount = 0;
   __pyx_pybuffernd_g_left.data = NULL;
   __pyx_pybuffernd_g_left.rcbuffer = &__pyx_pybuffer_g_left;
   __pyx_pybuffer_g_right.pybuffer.buf = NULL;
   __pyx_pybuffer_g_right.refcount = 0;
   __pyx_pybuffernd_g_right.data = NULL;
@@ -7612,165 +7603,165 @@
   __pyx_pybuffernd_h_left.rcbuffer = &__pyx_pybuffer_h_left;
   __pyx_pybuffer_h_right.pybuffer.buf = NULL;
   __pyx_pybuffer_h_right.refcount = 0;
   __pyx_pybuffernd_h_right.data = NULL;
   __pyx_pybuffernd_h_right.rcbuffer = &__pyx_pybuffer_h_right;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_left, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 193, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_left, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 192, __pyx_L1_error)
   }
   __pyx_pybuffernd_g_left.diminfo[0].strides = __pyx_pybuffernd_g_left.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_g_left.diminfo[0].shape = __pyx_pybuffernd_g_left.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_right, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 193, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_right, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 192, __pyx_L1_error)
   }
   __pyx_pybuffernd_g_right.diminfo[0].strides = __pyx_pybuffernd_g_right.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_g_right.diminfo[0].shape = __pyx_pybuffernd_g_right.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_h_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_h_left, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 193, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_h_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_h_left, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 192, __pyx_L1_error)
   }
   __pyx_pybuffernd_h_left.diminfo[0].strides = __pyx_pybuffernd_h_left.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_h_left.diminfo[0].shape = __pyx_pybuffernd_h_left.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_h_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_h_right, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 193, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_h_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_h_right, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 192, __pyx_L1_error)
   }
   __pyx_pybuffernd_h_right.diminfo[0].strides = __pyx_pybuffernd_h_right.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_h_right.diminfo[0].shape = __pyx_pybuffernd_h_right.rcbuffer->pybuffer.shape[0];
 
-  /* "structureboost/structure_dt_multi.pyx":198
+  /* "structureboost/structure_dt_multi.pyx":197
  *                       np.ndarray[double] h_right,
  *                       double gamma, double reg_lambda, double tol=1e-12):
  *     loss_val = -1.0 * np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +             # <<<<<<<<<<<<<<
  *                        ((g_right*g_right)/(h_right+reg_lambda)) -
  *                    (((g_left + g_right)*(g_left + g_right)) /
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 198, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 197, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 198, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 197, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Multiply(((PyObject *)__pyx_v_g_left), ((PyObject *)__pyx_v_g_left)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 198, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(((PyObject *)__pyx_v_g_left), ((PyObject *)__pyx_v_g_left)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 197, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_reg_lambda); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 198, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_reg_lambda); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 197, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyNumber_Add(((PyObject *)__pyx_v_h_left), __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 198, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Add(((PyObject *)__pyx_v_h_left), __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 197, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 198, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 197, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":199
+  /* "structureboost/structure_dt_multi.pyx":198
  *                       double gamma, double reg_lambda, double tol=1e-12):
  *     loss_val = -1.0 * np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +
  *                        ((g_right*g_right)/(h_right+reg_lambda)) -             # <<<<<<<<<<<<<<
  *                    (((g_left + g_right)*(g_left + g_right)) /
  *                     (h_left + h_right+reg_lambda)))-gamma)
  */
-  __pyx_t_5 = PyNumber_Multiply(((PyObject *)__pyx_v_g_right), ((PyObject *)__pyx_v_g_right)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 199, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Multiply(((PyObject *)__pyx_v_g_right), ((PyObject *)__pyx_v_g_right)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 198, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_reg_lambda); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 199, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_reg_lambda); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 198, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_6 = PyNumber_Add(((PyObject *)__pyx_v_h_right), __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 199, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_Add(((PyObject *)__pyx_v_h_right), __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 198, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 199, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 198, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":198
+  /* "structureboost/structure_dt_multi.pyx":197
  *                       np.ndarray[double] h_right,
  *                       double gamma, double reg_lambda, double tol=1e-12):
  *     loss_val = -1.0 * np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +             # <<<<<<<<<<<<<<
  *                        ((g_right*g_right)/(h_right+reg_lambda)) -
  *                    (((g_left + g_right)*(g_left + g_right)) /
  */
-  __pyx_t_6 = PyNumber_Add(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 198, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_Add(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 197, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":200
+  /* "structureboost/structure_dt_multi.pyx":199
  *     loss_val = -1.0 * np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +
  *                        ((g_right*g_right)/(h_right+reg_lambda)) -
  *                    (((g_left + g_right)*(g_left + g_right)) /             # <<<<<<<<<<<<<<
  *                     (h_left + h_right+reg_lambda)))-gamma)
  *     if loss_val >= -tol:
  */
-  __pyx_t_2 = PyNumber_Add(((PyObject *)__pyx_v_g_left), ((PyObject *)__pyx_v_g_right)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 200, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Add(((PyObject *)__pyx_v_g_left), ((PyObject *)__pyx_v_g_right)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 199, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyNumber_Add(((PyObject *)__pyx_v_g_left), ((PyObject *)__pyx_v_g_right)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 200, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Add(((PyObject *)__pyx_v_g_left), ((PyObject *)__pyx_v_g_right)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 199, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyNumber_Multiply(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 200, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Multiply(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 199, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":201
+  /* "structureboost/structure_dt_multi.pyx":200
  *                        ((g_right*g_right)/(h_right+reg_lambda)) -
  *                    (((g_left + g_right)*(g_left + g_right)) /
  *                     (h_left + h_right+reg_lambda)))-gamma)             # <<<<<<<<<<<<<<
  *     if loss_val >= -tol:
  *         loss_val = np.inf
  */
-  __pyx_t_4 = PyNumber_Add(((PyObject *)__pyx_v_h_left), ((PyObject *)__pyx_v_h_right)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 201, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Add(((PyObject *)__pyx_v_h_left), ((PyObject *)__pyx_v_h_right)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 200, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_reg_lambda); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 201, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_reg_lambda); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 200, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_7 = PyNumber_Add(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 201, __pyx_L1_error)
+  __pyx_t_7 = PyNumber_Add(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 200, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":200
+  /* "structureboost/structure_dt_multi.pyx":199
  *     loss_val = -1.0 * np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +
  *                        ((g_right*g_right)/(h_right+reg_lambda)) -
  *                    (((g_left + g_right)*(g_left + g_right)) /             # <<<<<<<<<<<<<<
  *                     (h_left + h_right+reg_lambda)))-gamma)
  *     if loss_val >= -tol:
  */
-  __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 200, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 199, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":199
+  /* "structureboost/structure_dt_multi.pyx":198
  *                       double gamma, double reg_lambda, double tol=1e-12):
  *     loss_val = -1.0 * np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +
  *                        ((g_right*g_right)/(h_right+reg_lambda)) -             # <<<<<<<<<<<<<<
  *                    (((g_left + g_right)*(g_left + g_right)) /
  *                     (h_left + h_right+reg_lambda)))-gamma)
  */
-  __pyx_t_7 = PyNumber_Subtract(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 199, __pyx_L1_error)
+  __pyx_t_7 = PyNumber_Subtract(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 198, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":198
+  /* "structureboost/structure_dt_multi.pyx":197
  *                       np.ndarray[double] h_right,
  *                       double gamma, double reg_lambda, double tol=1e-12):
  *     loss_val = -1.0 * np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +             # <<<<<<<<<<<<<<
  *                        ((g_right*g_right)/(h_right+reg_lambda)) -
  *                    (((g_left + g_right)*(g_left + g_right)) /
  */
-  __pyx_t_2 = PyNumber_Multiply(__pyx_float__5, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 198, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_float__5, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 197, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":201
+  /* "structureboost/structure_dt_multi.pyx":200
  *                        ((g_right*g_right)/(h_right+reg_lambda)) -
  *                    (((g_left + g_right)*(g_left + g_right)) /
  *                     (h_left + h_right+reg_lambda)))-gamma)             # <<<<<<<<<<<<<<
  *     if loss_val >= -tol:
  *         loss_val = np.inf
  */
-  __pyx_t_7 = PyFloat_FromDouble(__pyx_v_gamma); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 201, __pyx_L1_error)
+  __pyx_t_7 = PyFloat_FromDouble(__pyx_v_gamma); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 200, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_6 = PyNumber_Subtract(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 201, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_Subtract(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 200, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_7 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_7)) {
@@ -7779,83 +7770,83 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_7, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6);
   __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 198, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 197, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":198
+  /* "structureboost/structure_dt_multi.pyx":197
  *                       np.ndarray[double] h_right,
  *                       double gamma, double reg_lambda, double tol=1e-12):
  *     loss_val = -1.0 * np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +             # <<<<<<<<<<<<<<
  *                        ((g_right*g_right)/(h_right+reg_lambda)) -
  *                    (((g_left + g_right)*(g_left + g_right)) /
  */
-  __pyx_t_3 = PyNumber_Multiply(__pyx_float_neg_1_0, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 198, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_float_neg_1_0, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 197, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_loss_val = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":202
+  /* "structureboost/structure_dt_multi.pyx":201
  *                    (((g_left + g_right)*(g_left + g_right)) /
  *                     (h_left + h_right+reg_lambda)))-gamma)
  *     if loss_val >= -tol:             # <<<<<<<<<<<<<<
  *         loss_val = np.inf
  *     return(loss_val)
  */
-  __pyx_t_3 = PyFloat_FromDouble((-__pyx_v_tol)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 202, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble((-__pyx_v_tol)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 201, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_loss_val, __pyx_t_3, Py_GE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 202, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_loss_val, __pyx_t_3, Py_GE); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 201, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 202, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 201, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_8) {
 
-    /* "structureboost/structure_dt_multi.pyx":203
+    /* "structureboost/structure_dt_multi.pyx":202
  *                     (h_left + h_right+reg_lambda)))-gamma)
  *     if loss_val >= -tol:
  *         loss_val = np.inf             # <<<<<<<<<<<<<<
  *     return(loss_val)
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 203, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 202, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_inf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 203, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_inf); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 202, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF_SET(__pyx_v_loss_val, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "structureboost/structure_dt_multi.pyx":202
+    /* "structureboost/structure_dt_multi.pyx":201
  *                    (((g_left + g_right)*(g_left + g_right)) /
  *                     (h_left + h_right+reg_lambda)))-gamma)
  *     if loss_val >= -tol:             # <<<<<<<<<<<<<<
  *         loss_val = np.inf
  *     return(loss_val)
  */
   }
 
-  /* "structureboost/structure_dt_multi.pyx":204
+  /* "structureboost/structure_dt_multi.pyx":203
  *     if loss_val >= -tol:
  *         loss_val = np.inf
  *     return(loss_val)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_loss_val);
   __pyx_r = __pyx_v_loss_val;
   goto __pyx_L0;
 
-  /* "structureboost/structure_dt_multi.pyx":193
+  /* "structureboost/structure_dt_multi.pyx":192
  * 
  * 
  * def _get_gh_score_num_mc(np.ndarray[double] g_left,             # <<<<<<<<<<<<<<
  *                       np.ndarray[double] g_right,
  *                       np.ndarray[double] h_left,
  */
 
@@ -7889,15 +7880,15 @@
   __Pyx_XDECREF(__pyx_v_loss_val);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_dt_multi.pyx":207
+/* "structureboost/structure_dt_multi.pyx":206
  * 
  * 
  * def _get_gh_score_array_mc(np.ndarray[double, ndim=2] g_left,             # <<<<<<<<<<<<<<
  *                         np.ndarray[double, ndim=2] g_right,
  *                         np.ndarray[double, ndim=2] h_left,
  */
 
@@ -7944,43 +7935,43 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g_left)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g_right)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_get_gh_score_array_mc", 1, 6, 6, 1); __PYX_ERR(0, 207, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_get_gh_score_array_mc", 1, 6, 6, 1); __PYX_ERR(0, 206, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_h_left)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_get_gh_score_array_mc", 1, 6, 6, 2); __PYX_ERR(0, 207, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_get_gh_score_array_mc", 1, 6, 6, 2); __PYX_ERR(0, 206, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_h_right)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_get_gh_score_array_mc", 1, 6, 6, 3); __PYX_ERR(0, 207, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_get_gh_score_array_mc", 1, 6, 6, 3); __PYX_ERR(0, 206, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_gamma)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_get_gh_score_array_mc", 1, 6, 6, 4); __PYX_ERR(0, 207, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_get_gh_score_array_mc", 1, 6, 6, 4); __PYX_ERR(0, 206, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_reg_lambda)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_get_gh_score_array_mc", 1, 6, 6, 5); __PYX_ERR(0, 207, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_get_gh_score_array_mc", 1, 6, 6, 5); __PYX_ERR(0, 206, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_get_gh_score_array_mc") < 0)) __PYX_ERR(0, 207, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_get_gh_score_array_mc") < 0)) __PYX_ERR(0, 206, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -7988,29 +7979,29 @@
       values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
       values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
     }
     __pyx_v_g_left = ((PyArrayObject *)values[0]);
     __pyx_v_g_right = ((PyArrayObject *)values[1]);
     __pyx_v_h_left = ((PyArrayObject *)values[2]);
     __pyx_v_h_right = ((PyArrayObject *)values[3]);
-    __pyx_v_gamma = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_gamma == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 211, __pyx_L3_error)
-    __pyx_v_reg_lambda = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_reg_lambda == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 211, __pyx_L3_error)
+    __pyx_v_gamma = __pyx_PyFloat_AsDouble(values[4]); if (unlikely((__pyx_v_gamma == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 210, __pyx_L3_error)
+    __pyx_v_reg_lambda = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_reg_lambda == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 210, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_get_gh_score_array_mc", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 207, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_get_gh_score_array_mc", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 206, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_dt_multi._get_gh_score_array_mc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g_left), __pyx_ptype_5numpy_ndarray, 1, "g_left", 0))) __PYX_ERR(0, 207, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g_right), __pyx_ptype_5numpy_ndarray, 1, "g_right", 0))) __PYX_ERR(0, 208, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_h_left), __pyx_ptype_5numpy_ndarray, 1, "h_left", 0))) __PYX_ERR(0, 209, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_h_right), __pyx_ptype_5numpy_ndarray, 1, "h_right", 0))) __PYX_ERR(0, 210, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g_left), __pyx_ptype_5numpy_ndarray, 1, "g_left", 0))) __PYX_ERR(0, 206, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g_right), __pyx_ptype_5numpy_ndarray, 1, "g_right", 0))) __PYX_ERR(0, 207, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_h_left), __pyx_ptype_5numpy_ndarray, 1, "h_left", 0))) __PYX_ERR(0, 208, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_h_right), __pyx_ptype_5numpy_ndarray, 1, "h_right", 0))) __PYX_ERR(0, 209, __pyx_L1_error)
   __pyx_r = __pyx_pf_14structureboost_18structure_dt_multi_4_get_gh_score_array_mc(__pyx_self, __pyx_v_g_left, __pyx_v_g_right, __pyx_v_h_left, __pyx_v_h_right, __pyx_v_gamma, __pyx_v_reg_lambda);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -8037,15 +8028,15 @@
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__16)
   __Pyx_RefNannySetupContext("_get_gh_score_array_mc", 0);
-  __Pyx_TraceCall("_get_gh_score_array_mc", __pyx_f[0], 207, 0, __PYX_ERR(0, 207, __pyx_L1_error));
+  __Pyx_TraceCall("_get_gh_score_array_mc", __pyx_f[0], 206, 0, __PYX_ERR(0, 206, __pyx_L1_error));
   __pyx_pybuffer_g_left.pybuffer.buf = NULL;
   __pyx_pybuffer_g_left.refcount = 0;
   __pyx_pybuffernd_g_left.data = NULL;
   __pyx_pybuffernd_g_left.rcbuffer = &__pyx_pybuffer_g_left;
   __pyx_pybuffer_g_right.pybuffer.buf = NULL;
   __pyx_pybuffer_g_right.refcount = 0;
   __pyx_pybuffernd_g_right.data = NULL;
@@ -8056,211 +8047,211 @@
   __pyx_pybuffernd_h_left.rcbuffer = &__pyx_pybuffer_h_left;
   __pyx_pybuffer_h_right.pybuffer.buf = NULL;
   __pyx_pybuffer_h_right.refcount = 0;
   __pyx_pybuffernd_h_right.data = NULL;
   __pyx_pybuffernd_h_right.rcbuffer = &__pyx_pybuffer_h_right;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_left, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 207, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_left, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 206, __pyx_L1_error)
   }
   __pyx_pybuffernd_g_left.diminfo[0].strides = __pyx_pybuffernd_g_left.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_g_left.diminfo[0].shape = __pyx_pybuffernd_g_left.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_g_left.diminfo[1].strides = __pyx_pybuffernd_g_left.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_g_left.diminfo[1].shape = __pyx_pybuffernd_g_left.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_right, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 207, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_right, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 206, __pyx_L1_error)
   }
   __pyx_pybuffernd_g_right.diminfo[0].strides = __pyx_pybuffernd_g_right.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_g_right.diminfo[0].shape = __pyx_pybuffernd_g_right.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_g_right.diminfo[1].strides = __pyx_pybuffernd_g_right.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_g_right.diminfo[1].shape = __pyx_pybuffernd_g_right.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_h_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_h_left, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 207, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_h_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_h_left, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 206, __pyx_L1_error)
   }
   __pyx_pybuffernd_h_left.diminfo[0].strides = __pyx_pybuffernd_h_left.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_h_left.diminfo[0].shape = __pyx_pybuffernd_h_left.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_h_left.diminfo[1].strides = __pyx_pybuffernd_h_left.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_h_left.diminfo[1].shape = __pyx_pybuffernd_h_left.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_h_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_h_right, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 207, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_h_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_h_right, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 206, __pyx_L1_error)
   }
   __pyx_pybuffernd_h_right.diminfo[0].strides = __pyx_pybuffernd_h_right.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_h_right.diminfo[0].shape = __pyx_pybuffernd_h_right.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_h_right.diminfo[1].strides = __pyx_pybuffernd_h_right.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_h_right.diminfo[1].shape = __pyx_pybuffernd_h_right.rcbuffer->pybuffer.shape[1];
 
-  /* "structureboost/structure_dt_multi.pyx":212
+  /* "structureboost/structure_dt_multi.pyx":211
  *                         np.ndarray[double, ndim=2] h_right,
  *                         double gamma, double reg_lambda):
  *     return(np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +             # <<<<<<<<<<<<<<
  *                ((g_right*g_right)/(h_right+reg_lambda)) -
  *                (((g_left+g_right) * (g_left+g_right)) /
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 212, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 211, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 212, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 211, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Multiply(((PyObject *)__pyx_v_g_left), ((PyObject *)__pyx_v_g_left)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 212, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(((PyObject *)__pyx_v_g_left), ((PyObject *)__pyx_v_g_left)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 211, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_reg_lambda); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 212, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_reg_lambda); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 211, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyNumber_Add(((PyObject *)__pyx_v_h_left), __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 212, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Add(((PyObject *)__pyx_v_h_left), __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 211, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 212, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 211, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":213
+  /* "structureboost/structure_dt_multi.pyx":212
  *                         double gamma, double reg_lambda):
  *     return(np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +
  *                ((g_right*g_right)/(h_right+reg_lambda)) -             # <<<<<<<<<<<<<<
  *                (((g_left+g_right) * (g_left+g_right)) /
  *                 (h_left+h_right+reg_lambda)))-gamma, axis=1))
  */
-  __pyx_t_4 = PyNumber_Multiply(((PyObject *)__pyx_v_g_right), ((PyObject *)__pyx_v_g_right)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 213, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(((PyObject *)__pyx_v_g_right), ((PyObject *)__pyx_v_g_right)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_reg_lambda); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 213, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_reg_lambda); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = PyNumber_Add(((PyObject *)__pyx_v_h_right), __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 213, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Add(((PyObject *)__pyx_v_h_right), __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 213, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":212
+  /* "structureboost/structure_dt_multi.pyx":211
  *                         np.ndarray[double, ndim=2] h_right,
  *                         double gamma, double reg_lambda):
  *     return(np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +             # <<<<<<<<<<<<<<
  *                ((g_right*g_right)/(h_right+reg_lambda)) -
  *                (((g_left+g_right) * (g_left+g_right)) /
  */
-  __pyx_t_5 = PyNumber_Add(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 212, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Add(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 211, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":214
+  /* "structureboost/structure_dt_multi.pyx":213
  *     return(np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +
  *                ((g_right*g_right)/(h_right+reg_lambda)) -
  *                (((g_left+g_right) * (g_left+g_right)) /             # <<<<<<<<<<<<<<
  *                 (h_left+h_right+reg_lambda)))-gamma, axis=1))
  * 
  */
-  __pyx_t_1 = PyNumber_Add(((PyObject *)__pyx_v_g_left), ((PyObject *)__pyx_v_g_right)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 214, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Add(((PyObject *)__pyx_v_g_left), ((PyObject *)__pyx_v_g_right)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 213, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Add(((PyObject *)__pyx_v_g_left), ((PyObject *)__pyx_v_g_right)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 214, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Add(((PyObject *)__pyx_v_g_left), ((PyObject *)__pyx_v_g_right)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 213, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 214, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 213, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":215
+  /* "structureboost/structure_dt_multi.pyx":214
  *                ((g_right*g_right)/(h_right+reg_lambda)) -
  *                (((g_left+g_right) * (g_left+g_right)) /
  *                 (h_left+h_right+reg_lambda)))-gamma, axis=1))             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_3 = PyNumber_Add(((PyObject *)__pyx_v_h_left), ((PyObject *)__pyx_v_h_right)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 215, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Add(((PyObject *)__pyx_v_h_left), ((PyObject *)__pyx_v_h_right)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 214, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_reg_lambda); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 215, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_reg_lambda); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 214, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_6 = PyNumber_Add(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 215, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_Add(__pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 214, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":214
+  /* "structureboost/structure_dt_multi.pyx":213
  *     return(np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +
  *                ((g_right*g_right)/(h_right+reg_lambda)) -
  *                (((g_left+g_right) * (g_left+g_right)) /             # <<<<<<<<<<<<<<
  *                 (h_left+h_right+reg_lambda)))-gamma, axis=1))
  * 
  */
-  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 214, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 213, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":213
+  /* "structureboost/structure_dt_multi.pyx":212
  *                         double gamma, double reg_lambda):
  *     return(np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +
  *                ((g_right*g_right)/(h_right+reg_lambda)) -             # <<<<<<<<<<<<<<
  *                (((g_left+g_right) * (g_left+g_right)) /
  *                 (h_left+h_right+reg_lambda)))-gamma, axis=1))
  */
-  __pyx_t_6 = PyNumber_Subtract(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 213, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_Subtract(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":212
+  /* "structureboost/structure_dt_multi.pyx":211
  *                         np.ndarray[double, ndim=2] h_right,
  *                         double gamma, double reg_lambda):
  *     return(np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +             # <<<<<<<<<<<<<<
  *                ((g_right*g_right)/(h_right+reg_lambda)) -
  *                (((g_left+g_right) * (g_left+g_right)) /
  */
-  __pyx_t_1 = PyNumber_Multiply(__pyx_float__5, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 212, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_float__5, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 211, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":215
+  /* "structureboost/structure_dt_multi.pyx":214
  *                ((g_right*g_right)/(h_right+reg_lambda)) -
  *                (((g_left+g_right) * (g_left+g_right)) /
  *                 (h_left+h_right+reg_lambda)))-gamma, axis=1))             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_6 = PyFloat_FromDouble(__pyx_v_gamma); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 215, __pyx_L1_error)
+  __pyx_t_6 = PyFloat_FromDouble(__pyx_v_gamma); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 214, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = PyNumber_Subtract(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 215, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Subtract(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 214, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":212
+  /* "structureboost/structure_dt_multi.pyx":211
  *                         np.ndarray[double, ndim=2] h_right,
  *                         double gamma, double reg_lambda):
  *     return(np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +             # <<<<<<<<<<<<<<
  *                ((g_right*g_right)/(h_right+reg_lambda)) -
  *                (((g_left+g_right) * (g_left+g_right)) /
  */
-  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 212, __pyx_L1_error)
+  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 211, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":215
+  /* "structureboost/structure_dt_multi.pyx":214
  *                ((g_right*g_right)/(h_right+reg_lambda)) -
  *                (((g_left+g_right) * (g_left+g_right)) /
  *                 (h_left+h_right+reg_lambda)))-gamma, axis=1))             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 215, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 214, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_axis, __pyx_int_1) < 0) __PYX_ERR(0, 215, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_axis, __pyx_int_1) < 0) __PYX_ERR(0, 214, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":212
+  /* "structureboost/structure_dt_multi.pyx":211
  *                         np.ndarray[double, ndim=2] h_right,
  *                         double gamma, double reg_lambda):
  *     return(np.sum(.5*(((g_left*g_left)/(h_left+reg_lambda)) +             # <<<<<<<<<<<<<<
  *                ((g_right*g_right)/(h_right+reg_lambda)) -
  *                (((g_left+g_right) * (g_left+g_right)) /
  */
-  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 212, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 211, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_dt_multi.pyx":207
+  /* "structureboost/structure_dt_multi.pyx":206
  * 
  * 
  * def _get_gh_score_array_mc(np.ndarray[double, ndim=2] g_left,             # <<<<<<<<<<<<<<
  *                         np.ndarray[double, ndim=2] g_right,
  *                         np.ndarray[double, ndim=2] h_left,
  */
 
@@ -8292,19 +8283,19 @@
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_dt_multi.pyx":220
+/* "structureboost/structure_dt_multi.pyx":219
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * def get_bin_sums_c_mc(np.ndarray[double, ndim=2] g_h_mat,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] bin_result_vec,
+ *                    np.ndarray[np.int_t] bin_result_vec,
  *                    long out_vec_size, long num_classes):
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_18structure_dt_multi_7get_bin_sums_c_mc(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_18structure_dt_multi_7get_bin_sums_c_mc = {"get_bin_sums_c_mc", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_18structure_dt_multi_7get_bin_sums_c_mc, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_14structureboost_18structure_dt_multi_7get_bin_sums_c_mc(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
@@ -8341,55 +8332,55 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_g_h_mat)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_bin_result_vec)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_bin_sums_c_mc", 1, 4, 4, 1); __PYX_ERR(0, 220, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_bin_sums_c_mc", 1, 4, 4, 1); __PYX_ERR(0, 219, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_out_vec_size)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_bin_sums_c_mc", 1, 4, 4, 2); __PYX_ERR(0, 220, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_bin_sums_c_mc", 1, 4, 4, 2); __PYX_ERR(0, 219, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num_classes)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_bin_sums_c_mc", 1, 4, 4, 3); __PYX_ERR(0, 220, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_bin_sums_c_mc", 1, 4, 4, 3); __PYX_ERR(0, 219, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_bin_sums_c_mc") < 0)) __PYX_ERR(0, 220, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_bin_sums_c_mc") < 0)) __PYX_ERR(0, 219, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
     }
     __pyx_v_g_h_mat = ((PyArrayObject *)values[0]);
     __pyx_v_bin_result_vec = ((PyArrayObject *)values[1]);
-    __pyx_v_out_vec_size = __Pyx_PyInt_As_long(values[2]); if (unlikely((__pyx_v_out_vec_size == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 222, __pyx_L3_error)
-    __pyx_v_num_classes = __Pyx_PyInt_As_long(values[3]); if (unlikely((__pyx_v_num_classes == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 222, __pyx_L3_error)
+    __pyx_v_out_vec_size = __Pyx_PyInt_As_long(values[2]); if (unlikely((__pyx_v_out_vec_size == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 221, __pyx_L3_error)
+    __pyx_v_num_classes = __Pyx_PyInt_As_long(values[3]); if (unlikely((__pyx_v_num_classes == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 221, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("get_bin_sums_c_mc", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 220, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("get_bin_sums_c_mc", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 219, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_dt_multi.get_bin_sums_c_mc", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g_h_mat), __pyx_ptype_5numpy_ndarray, 1, "g_h_mat", 0))) __PYX_ERR(0, 220, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_bin_result_vec), __pyx_ptype_5numpy_ndarray, 1, "bin_result_vec", 0))) __PYX_ERR(0, 221, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_g_h_mat), __pyx_ptype_5numpy_ndarray, 1, "g_h_mat", 0))) __PYX_ERR(0, 219, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_bin_result_vec), __pyx_ptype_5numpy_ndarray, 1, "bin_result_vec", 0))) __PYX_ERR(0, 220, __pyx_L1_error)
   __pyx_r = __pyx_pf_14structureboost_18structure_dt_multi_6get_bin_sums_c_mc(__pyx_self, __pyx_v_g_h_mat, __pyx_v_bin_result_vec, __pyx_v_out_vec_size, __pyx_v_num_classes);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -8426,22 +8417,22 @@
   int __pyx_t_10;
   long __pyx_t_11;
   long __pyx_t_12;
   int __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
-  __pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t __pyx_t_17;
+  Py_ssize_t __pyx_t_17;
   Py_ssize_t __pyx_t_18;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__17)
   __Pyx_RefNannySetupContext("get_bin_sums_c_mc", 0);
-  __Pyx_TraceCall("get_bin_sums_c_mc", __pyx_f[0], 220, 0, __PYX_ERR(0, 220, __pyx_L1_error));
+  __Pyx_TraceCall("get_bin_sums_c_mc", __pyx_f[0], 219, 0, __PYX_ERR(0, 219, __pyx_L1_error));
   __pyx_pybuffer_g_sum_bins.pybuffer.buf = NULL;
   __pyx_pybuffer_g_sum_bins.refcount = 0;
   __pyx_pybuffernd_g_sum_bins.data = NULL;
   __pyx_pybuffernd_g_sum_bins.rcbuffer = &__pyx_pybuffer_g_sum_bins;
   __pyx_pybuffer_h_sum_bins.pybuffer.buf = NULL;
   __pyx_pybuffer_h_sum_bins.refcount = 0;
   __pyx_pybuffernd_h_sum_bins.data = NULL;
@@ -8452,49 +8443,49 @@
   __pyx_pybuffernd_g_h_mat.rcbuffer = &__pyx_pybuffer_g_h_mat;
   __pyx_pybuffer_bin_result_vec.pybuffer.buf = NULL;
   __pyx_pybuffer_bin_result_vec.refcount = 0;
   __pyx_pybuffernd_bin_result_vec.data = NULL;
   __pyx_pybuffernd_bin_result_vec.rcbuffer = &__pyx_pybuffer_bin_result_vec;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_h_mat.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_h_mat, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 220, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_h_mat.rcbuffer->pybuffer, (PyObject*)__pyx_v_g_h_mat, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 219, __pyx_L1_error)
   }
   __pyx_pybuffernd_g_h_mat.diminfo[0].strides = __pyx_pybuffernd_g_h_mat.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_g_h_mat.diminfo[0].shape = __pyx_pybuffernd_g_h_mat.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_g_h_mat.diminfo[1].strides = __pyx_pybuffernd_g_h_mat.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_g_h_mat.diminfo[1].shape = __pyx_pybuffernd_g_h_mat.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_bin_result_vec, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 220, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_bin_result_vec, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 219, __pyx_L1_error)
   }
   __pyx_pybuffernd_bin_result_vec.diminfo[0].strides = __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_bin_result_vec.diminfo[0].shape = __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.shape[0];
 
-  /* "structureboost/structure_dt_multi.pyx":224
+  /* "structureboost/structure_dt_multi.pyx":223
  *                    long out_vec_size, long num_classes):
  *     cdef int i,j
  *     cdef int m = bin_result_vec.shape[0]             # <<<<<<<<<<<<<<
  * 
  *     cdef np.ndarray[double, ndim=2] g_sum_bins = np.zeros((out_vec_size, num_classes))
  */
   __pyx_v_m = (__pyx_v_bin_result_vec->dimensions[0]);
 
-  /* "structureboost/structure_dt_multi.pyx":226
+  /* "structureboost/structure_dt_multi.pyx":225
  *     cdef int m = bin_result_vec.shape[0]
  * 
  *     cdef np.ndarray[double, ndim=2] g_sum_bins = np.zeros((out_vec_size, num_classes))             # <<<<<<<<<<<<<<
  *     cdef np.ndarray[double, ndim=2] h_sum_bins = np.zeros((out_vec_size, num_classes))
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 226, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 226, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_out_vec_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 226, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_out_vec_size); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyInt_From_long(__pyx_v_num_classes); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 226, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_long(__pyx_v_num_classes); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 226, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
   __pyx_t_2 = 0;
   __pyx_t_4 = 0;
@@ -8507,48 +8498,48 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 226, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 225, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 226, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 225, __pyx_L1_error)
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_g_sum_bins.rcbuffer->pybuffer, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
       __pyx_v_g_sum_bins = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_g_sum_bins.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 226, __pyx_L1_error)
+      __PYX_ERR(0, 225, __pyx_L1_error)
     } else {__pyx_pybuffernd_g_sum_bins.diminfo[0].strides = __pyx_pybuffernd_g_sum_bins.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_g_sum_bins.diminfo[0].shape = __pyx_pybuffernd_g_sum_bins.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_g_sum_bins.diminfo[1].strides = __pyx_pybuffernd_g_sum_bins.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_g_sum_bins.diminfo[1].shape = __pyx_pybuffernd_g_sum_bins.rcbuffer->pybuffer.shape[1];
     }
   }
   __pyx_t_6 = 0;
   __pyx_v_g_sum_bins = ((PyArrayObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":227
+  /* "structureboost/structure_dt_multi.pyx":226
  * 
  *     cdef np.ndarray[double, ndim=2] g_sum_bins = np.zeros((out_vec_size, num_classes))
  *     cdef np.ndarray[double, ndim=2] h_sum_bins = np.zeros((out_vec_size, num_classes))             # <<<<<<<<<<<<<<
  * 
  *     for i in range(m):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 227, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 227, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_out_vec_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 227, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_out_vec_size); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyInt_From_long(__pyx_v_num_classes); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 227, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_long(__pyx_v_num_classes); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 227, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
   __pyx_t_3 = 0;
   __pyx_t_4 = 0;
@@ -8561,110 +8552,110 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 227, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 227, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 226, __pyx_L1_error)
   __pyx_t_7 = ((PyArrayObject *)__pyx_t_1);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_h_sum_bins.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
       __pyx_v_h_sum_bins = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_h_sum_bins.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 227, __pyx_L1_error)
+      __PYX_ERR(0, 226, __pyx_L1_error)
     } else {__pyx_pybuffernd_h_sum_bins.diminfo[0].strides = __pyx_pybuffernd_h_sum_bins.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_h_sum_bins.diminfo[0].shape = __pyx_pybuffernd_h_sum_bins.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_h_sum_bins.diminfo[1].strides = __pyx_pybuffernd_h_sum_bins.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_h_sum_bins.diminfo[1].shape = __pyx_pybuffernd_h_sum_bins.rcbuffer->pybuffer.shape[1];
     }
   }
   __pyx_t_7 = 0;
   __pyx_v_h_sum_bins = ((PyArrayObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":229
+  /* "structureboost/structure_dt_multi.pyx":228
  *     cdef np.ndarray[double, ndim=2] h_sum_bins = np.zeros((out_vec_size, num_classes))
  * 
  *     for i in range(m):             # <<<<<<<<<<<<<<
  *         for j in range(num_classes):
  *             g_sum_bins[bin_result_vec[i],j] += g_h_mat[i,j]
  */
   __pyx_t_8 = __pyx_v_m;
   __pyx_t_9 = __pyx_t_8;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_i = __pyx_t_10;
 
-    /* "structureboost/structure_dt_multi.pyx":230
+    /* "structureboost/structure_dt_multi.pyx":229
  * 
  *     for i in range(m):
  *         for j in range(num_classes):             # <<<<<<<<<<<<<<
  *             g_sum_bins[bin_result_vec[i],j] += g_h_mat[i,j]
  *             h_sum_bins[bin_result_vec[i],j] += g_h_mat[i,num_classes+j]
  */
     __pyx_t_11 = __pyx_v_num_classes;
     __pyx_t_12 = __pyx_t_11;
     for (__pyx_t_13 = 0; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
       __pyx_v_j = __pyx_t_13;
 
-      /* "structureboost/structure_dt_multi.pyx":231
+      /* "structureboost/structure_dt_multi.pyx":230
  *     for i in range(m):
  *         for j in range(num_classes):
  *             g_sum_bins[bin_result_vec[i],j] += g_h_mat[i,j]             # <<<<<<<<<<<<<<
  *             h_sum_bins[bin_result_vec[i],j] += g_h_mat[i,num_classes+j]
  *     return g_sum_bins, h_sum_bins
  */
       __pyx_t_14 = __pyx_v_i;
       __pyx_t_15 = __pyx_v_j;
       __pyx_t_16 = __pyx_v_i;
-      __pyx_t_17 = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t *, __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_bin_result_vec.diminfo[0].strides));
+      __pyx_t_17 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_bin_result_vec.diminfo[0].strides));
       __pyx_t_18 = __pyx_v_j;
       *__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_g_sum_bins.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_g_sum_bins.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_g_sum_bins.diminfo[1].strides) += (*__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_g_h_mat.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_g_h_mat.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_g_h_mat.diminfo[1].strides));
 
-      /* "structureboost/structure_dt_multi.pyx":232
+      /* "structureboost/structure_dt_multi.pyx":231
  *         for j in range(num_classes):
  *             g_sum_bins[bin_result_vec[i],j] += g_h_mat[i,j]
  *             h_sum_bins[bin_result_vec[i],j] += g_h_mat[i,num_classes+j]             # <<<<<<<<<<<<<<
  *     return g_sum_bins, h_sum_bins
  * 
  */
       __pyx_t_15 = __pyx_v_i;
       __pyx_t_14 = (__pyx_v_num_classes + __pyx_v_j);
       __pyx_t_16 = __pyx_v_i;
-      __pyx_t_17 = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_18structure_dt_multi_dtype_int64_t *, __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_bin_result_vec.diminfo[0].strides));
-      __pyx_t_18 = __pyx_v_j;
-      *__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_h_sum_bins.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_h_sum_bins.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_h_sum_bins.diminfo[1].strides) += (*__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_g_h_mat.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_g_h_mat.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_g_h_mat.diminfo[1].strides));
+      __pyx_t_18 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_bin_result_vec.diminfo[0].strides));
+      __pyx_t_17 = __pyx_v_j;
+      *__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_h_sum_bins.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_h_sum_bins.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_h_sum_bins.diminfo[1].strides) += (*__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_g_h_mat.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_g_h_mat.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_g_h_mat.diminfo[1].strides));
     }
   }
 
-  /* "structureboost/structure_dt_multi.pyx":233
+  /* "structureboost/structure_dt_multi.pyx":232
  *             g_sum_bins[bin_result_vec[i],j] += g_h_mat[i,j]
  *             h_sum_bins[bin_result_vec[i],j] += g_h_mat[i,num_classes+j]
  *     return g_sum_bins, h_sum_bins             # <<<<<<<<<<<<<<
  * 
  * def get_left_right_sums_mc(bin_sums):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 233, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 232, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(((PyObject *)__pyx_v_g_sum_bins));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_g_sum_bins));
   PyTuple_SET_ITEM(__pyx_t_1, 0, ((PyObject *)__pyx_v_g_sum_bins));
   __Pyx_INCREF(((PyObject *)__pyx_v_h_sum_bins));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_h_sum_bins));
   PyTuple_SET_ITEM(__pyx_t_1, 1, ((PyObject *)__pyx_v_h_sum_bins));
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_dt_multi.pyx":220
+  /* "structureboost/structure_dt_multi.pyx":219
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * def get_bin_sums_c_mc(np.ndarray[double, ndim=2] g_h_mat,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] bin_result_vec,
+ *                    np.ndarray[np.int_t] bin_result_vec,
  *                    long out_vec_size, long num_classes):
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
@@ -8693,15 +8684,15 @@
   __Pyx_XDECREF((PyObject *)__pyx_v_h_sum_bins);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_dt_multi.pyx":235
+/* "structureboost/structure_dt_multi.pyx":234
  *     return g_sum_bins, h_sum_bins
  * 
  * def get_left_right_sums_mc(bin_sums):             # <<<<<<<<<<<<<<
  *     sum_left = np.cumsum(bin_sums, axis=0)
  *     sum_total = sum_left[-1,:]
  */
 
@@ -8731,104 +8722,104 @@
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__18)
   __Pyx_RefNannySetupContext("get_left_right_sums_mc", 0);
-  __Pyx_TraceCall("get_left_right_sums_mc", __pyx_f[0], 235, 0, __PYX_ERR(0, 235, __pyx_L1_error));
+  __Pyx_TraceCall("get_left_right_sums_mc", __pyx_f[0], 234, 0, __PYX_ERR(0, 234, __pyx_L1_error));
 
-  /* "structureboost/structure_dt_multi.pyx":236
+  /* "structureboost/structure_dt_multi.pyx":235
  * 
  * def get_left_right_sums_mc(bin_sums):
  *     sum_left = np.cumsum(bin_sums, axis=0)             # <<<<<<<<<<<<<<
  *     sum_total = sum_left[-1,:]
  *     sum_left = sum_left[:-1,:]
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 236, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 235, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_cumsum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 236, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_cumsum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 235, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 236, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 235, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_bin_sums);
   __Pyx_GIVEREF(__pyx_v_bin_sums);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_bin_sums);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 236, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 235, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 236, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 236, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_axis, __pyx_int_0) < 0) __PYX_ERR(0, 235, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 235, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_sum_left = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":237
+  /* "structureboost/structure_dt_multi.pyx":236
  * def get_left_right_sums_mc(bin_sums):
  *     sum_left = np.cumsum(bin_sums, axis=0)
  *     sum_total = sum_left[-1,:]             # <<<<<<<<<<<<<<
  *     sum_left = sum_left[:-1,:]
  *     sum_right = sum_total - sum_left
  */
-  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_sum_left, __pyx_tuple__5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 237, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_sum_left, __pyx_tuple__5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 236, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_v_sum_total = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":238
+  /* "structureboost/structure_dt_multi.pyx":237
  *     sum_left = np.cumsum(bin_sums, axis=0)
  *     sum_total = sum_left[-1,:]
  *     sum_left = sum_left[:-1,:]             # <<<<<<<<<<<<<<
  *     sum_right = sum_total - sum_left
  *     return sum_total, sum_left, sum_right
  */
-  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_sum_left, __pyx_tuple__7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 238, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_sum_left, __pyx_tuple__7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 237, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF_SET(__pyx_v_sum_left, __pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":239
+  /* "structureboost/structure_dt_multi.pyx":238
  *     sum_total = sum_left[-1,:]
  *     sum_left = sum_left[:-1,:]
  *     sum_right = sum_total - sum_left             # <<<<<<<<<<<<<<
  *     return sum_total, sum_left, sum_right
  * 
  */
-  __pyx_t_4 = PyNumber_Subtract(__pyx_v_sum_total, __pyx_v_sum_left); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 239, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Subtract(__pyx_v_sum_total, __pyx_v_sum_left); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 238, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_v_sum_right = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":240
+  /* "structureboost/structure_dt_multi.pyx":239
  *     sum_left = sum_left[:-1,:]
  *     sum_right = sum_total - sum_left
  *     return sum_total, sum_left, sum_right             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 240, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 239, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_v_sum_total);
   __Pyx_GIVEREF(__pyx_v_sum_total);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_sum_total);
   __Pyx_INCREF(__pyx_v_sum_left);
   __Pyx_GIVEREF(__pyx_v_sum_left);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_sum_left);
   __Pyx_INCREF(__pyx_v_sum_right);
   __Pyx_GIVEREF(__pyx_v_sum_right);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_v_sum_right);
   __pyx_r = __pyx_t_4;
   __pyx_t_4 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_dt_multi.pyx":235
+  /* "structureboost/structure_dt_multi.pyx":234
  *     return g_sum_bins, h_sum_bins
  * 
  * def get_left_right_sums_mc(bin_sums):             # <<<<<<<<<<<<<<
  *     sum_left = np.cumsum(bin_sums, axis=0)
  *     sum_total = sum_left[-1,:]
  */
 
@@ -10098,15 +10089,15 @@
   {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
   {&__pyx_n_s_ind, __pyx_k_ind, sizeof(__pyx_k_ind), 0, 0, 1, 1},
   {&__pyx_n_s_ind_subset_left, __pyx_k_ind_subset_left, sizeof(__pyx_k_ind_subset_left), 0, 0, 1, 1},
   {&__pyx_n_s_ind_subset_right, __pyx_k_ind_subset_right, sizeof(__pyx_k_ind_subset_right), 0, 0, 1, 1},
   {&__pyx_n_s_inf, __pyx_k_inf, sizeof(__pyx_k_inf), 0, 0, 1, 1},
   {&__pyx_n_s_init, __pyx_k_init, sizeof(__pyx_k_init), 0, 0, 1, 1},
-  {&__pyx_n_s_int64, __pyx_k_int64, sizeof(__pyx_k_int64), 0, 0, 1, 1},
+  {&__pyx_n_s_int, __pyx_k_int, sizeof(__pyx_k_int), 0, 0, 1, 1},
   {&__pyx_n_s_isnan, __pyx_k_isnan, sizeof(__pyx_k_isnan), 0, 0, 1, 1},
   {&__pyx_n_s_j, __pyx_k_j, sizeof(__pyx_k_j), 0, 0, 1, 1},
   {&__pyx_n_u_leaf, __pyx_k_leaf, sizeof(__pyx_k_leaf), 0, 1, 0, 1},
   {&__pyx_n_s_leaf_vertex_ind, __pyx_k_leaf_vertex_ind, sizeof(__pyx_k_leaf_vertex_ind), 0, 0, 1, 1},
   {&__pyx_n_u_left_child, __pyx_k_left_child, sizeof(__pyx_k_left_child), 0, 1, 0, 1},
   {&__pyx_n_s_left_feat_values, __pyx_k_left_feat_values, sizeof(__pyx_k_left_feat_values), 0, 0, 1, 1},
   {&__pyx_n_s_limit, __pyx_k_limit, sizeof(__pyx_k_limit), 0, 0, 1, 1},
@@ -10170,51 +10161,51 @@
   {&__pyx_n_s_update_g_h_accum, __pyx_k_update_g_h_accum, sizeof(__pyx_k_update_g_h_accum), 0, 0, 1, 1},
   {&__pyx_n_s_vec_len, __pyx_k_vec_len, sizeof(__pyx_k_vec_len), 0, 0, 1, 1},
   {&__pyx_n_s_warnings, __pyx_k_warnings, sizeof(__pyx_k_warnings), 0, 0, 1, 1},
   {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_super = __Pyx_GetBuiltinName(__pyx_n_s_super); if (!__pyx_builtin_super) __PYX_ERR(0, 31, __pyx_L1_error)
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 106, __pyx_L1_error)
+  __pyx_builtin_super = __Pyx_GetBuiltinName(__pyx_n_s_super); if (!__pyx_builtin_super) __PYX_ERR(0, 30, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 105, __pyx_L1_error)
   __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(1, 944, __pyx_L1_error)
   return 0;
   __pyx_L1_error:;
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);
 
-  /* "structureboost/structure_dt_multi.pyx":43
+  /* "structureboost/structure_dt_multi.pyx":42
  *             return np.zeros(self.num_classes)
  *         else:
  *             g_vec = np.sum(g_h_mat[:,:self.num_classes], axis=0)             # <<<<<<<<<<<<<<
  *             h_vec = np.sum(g_h_mat[:,self.num_classes:2*self.num_classes], axis=0)
  *             out_val = -(g_vec/(h_vec+self.reg_lambda))
  */
-  __pyx_slice__3 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__3)) __PYX_ERR(0, 43, __pyx_L1_error)
+  __pyx_slice__3 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__3)) __PYX_ERR(0, 42, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_slice__3);
   __Pyx_GIVEREF(__pyx_slice__3);
 
-  /* "structureboost/structure_dt_multi.pyx":66
+  /* "structureboost/structure_dt_multi.pyx":65
  *         best_loss, best_split_val = stdt._get_best_vals(score_vec, split_vec)
  *         if has_na_vals and (len(split_vec) > 2):
  *             g_sum_left_nal = (g_sum_left + (g_sum_total - g_sum_left[-1,:]))[:-1,:]             # <<<<<<<<<<<<<<
  *             h_sum_left_nal = (h_sum_left + (h_sum_total - h_sum_left[-1,:]))[:-1,:]
  *             g_sum_right_nal = g_sum_total - g_sum_left_nal
  */
-  __pyx_tuple__5 = PyTuple_Pack(2, __pyx_int_neg_1, __pyx_slice__3); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 66, __pyx_L1_error)
+  __pyx_tuple__5 = PyTuple_Pack(2, __pyx_int_neg_1, __pyx_slice__3); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 65, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__5);
   __Pyx_GIVEREF(__pyx_tuple__5);
-  __pyx_slice__6 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__6)) __PYX_ERR(0, 66, __pyx_L1_error)
+  __pyx_slice__6 = PySlice_New(Py_None, __pyx_int_neg_1, Py_None); if (unlikely(!__pyx_slice__6)) __PYX_ERR(0, 65, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_slice__6);
   __Pyx_GIVEREF(__pyx_slice__6);
-  __pyx_tuple__7 = PyTuple_Pack(2, __pyx_slice__6, __pyx_slice__3); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 66, __pyx_L1_error)
+  __pyx_tuple__7 = PyTuple_Pack(2, __pyx_slice__6, __pyx_slice__3); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 65, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__7);
   __Pyx_GIVEREF(__pyx_tuple__7);
 
   /* "../../../../../../.pyenv/versions/3.9.13/envs/ds3913/lib/python3.9/site-packages/numpy/__init__.pxd":944
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
@@ -10232,184 +10223,184 @@
  * 
  * cdef inline int import_ufunc() except -1:
  */
   __pyx_tuple__20 = PyTuple_Pack(1, __pyx_kp_u_numpy_core_umath_failed_to_impor); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(1, 950, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__20);
   __Pyx_GIVEREF(__pyx_tuple__20);
 
-  /* "structureboost/structure_dt_multi.pyx":27
+  /* "structureboost/structure_dt_multi.pyx":26
  *     """
  * 
  *     def __init__(self, feature_configs, feature_graphs, num_classes,             # <<<<<<<<<<<<<<
  *                  min_size_split=2,
  *                  max_depth=3, gamma=0, feat_sample_by_node=1,
  */
-  __pyx_tuple__21 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_feature_configs, __pyx_n_s_feature_graphs, __pyx_n_s_num_classes, __pyx_n_s_min_size_split, __pyx_n_s_max_depth, __pyx_n_s_gamma, __pyx_n_s_feat_sample_by_node, __pyx_n_s_reg_lambda); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 27, __pyx_L1_error)
+  __pyx_tuple__21 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_feature_configs, __pyx_n_s_feature_graphs, __pyx_n_s_num_classes, __pyx_n_s_min_size_split, __pyx_n_s_max_depth, __pyx_n_s_gamma, __pyx_n_s_feat_sample_by_node, __pyx_n_s_reg_lambda); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 26, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__21);
   __Pyx_GIVEREF(__pyx_tuple__21);
-  __pyx_codeobj_ = (PyObject*)__Pyx_PyCode_New(9, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__21, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_init, 27, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj_)) __PYX_ERR(0, 27, __pyx_L1_error)
-  __pyx_tuple__22 = PyTuple_Pack(5, ((PyObject *)__pyx_int_2), ((PyObject *)__pyx_int_3), ((PyObject *)__pyx_int_0), ((PyObject *)__pyx_int_1), ((PyObject *)__pyx_int_1)); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 27, __pyx_L1_error)
+  __pyx_codeobj_ = (PyObject*)__Pyx_PyCode_New(9, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__21, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_init, 26, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj_)) __PYX_ERR(0, 26, __pyx_L1_error)
+  __pyx_tuple__22 = PyTuple_Pack(5, ((PyObject *)__pyx_int_2), ((PyObject *)__pyx_int_3), ((PyObject *)__pyx_int_0), ((PyObject *)__pyx_int_1), ((PyObject *)__pyx_int_1)); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 26, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__22);
   __Pyx_GIVEREF(__pyx_tuple__22);
 
-  /* "structureboost/structure_dt_multi.pyx":39
+  /* "structureboost/structure_dt_multi.pyx":38
  *         self.num_classes = num_classes
  * 
  *     def _node_summary_gh(self, g_h_mat):             # <<<<<<<<<<<<<<
  *         if (g_h_mat.shape[0] == 0):
  *             return np.zeros(self.num_classes)
  */
-  __pyx_tuple__23 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_g_h_mat, __pyx_n_s_g_vec, __pyx_n_s_h_vec, __pyx_n_s_out_val); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 39, __pyx_L1_error)
+  __pyx_tuple__23 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_g_h_mat, __pyx_n_s_g_vec, __pyx_n_s_h_vec, __pyx_n_s_out_val); if (unlikely(!__pyx_tuple__23)) __PYX_ERR(0, 38, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__23);
   __Pyx_GIVEREF(__pyx_tuple__23);
-  __pyx_codeobj__2 = (PyObject*)__Pyx_PyCode_New(2, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_node_summary_gh, 39, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__2)) __PYX_ERR(0, 39, __pyx_L1_error)
+  __pyx_codeobj__2 = (PyObject*)__Pyx_PyCode_New(2, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_node_summary_gh, 38, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__2)) __PYX_ERR(0, 38, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":48
+  /* "structureboost/structure_dt_multi.pyx":47
  *             return(out_val)
  * 
  *     def _evaluate_numerical_splits(self, feature_vec, g_h_mat,             # <<<<<<<<<<<<<<
  *                                    split_vec):
  * 
  */
-  __pyx_tuple__24 = PyTuple_Pack(24, __pyx_n_s_self, __pyx_n_s_feature_vec, __pyx_n_s_g_h_mat, __pyx_n_s_split_vec, __pyx_n_s_has_na_vals, __pyx_n_s_bin_result_vec, __pyx_n_s_g_sum_bins, __pyx_n_s_h_sum_bins, __pyx_n_s_g_sum_total, __pyx_n_s_g_sum_left, __pyx_n_s_g_sum_right, __pyx_n_s_h_sum_total, __pyx_n_s_h_sum_left, __pyx_n_s_h_sum_right, __pyx_n_s_score_vec, __pyx_n_s_best_loss, __pyx_n_s_best_split_val, __pyx_n_s_g_sum_left_nal, __pyx_n_s_h_sum_left_nal, __pyx_n_s_g_sum_right_nal, __pyx_n_s_h_sum_right_nal, __pyx_n_s_score_vec_nal, __pyx_n_s_best_loss_nal, __pyx_n_s_best_split_val_nal); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 48, __pyx_L1_error)
+  __pyx_tuple__24 = PyTuple_Pack(24, __pyx_n_s_self, __pyx_n_s_feature_vec, __pyx_n_s_g_h_mat, __pyx_n_s_split_vec, __pyx_n_s_has_na_vals, __pyx_n_s_bin_result_vec, __pyx_n_s_g_sum_bins, __pyx_n_s_h_sum_bins, __pyx_n_s_g_sum_total, __pyx_n_s_g_sum_left, __pyx_n_s_g_sum_right, __pyx_n_s_h_sum_total, __pyx_n_s_h_sum_left, __pyx_n_s_h_sum_right, __pyx_n_s_score_vec, __pyx_n_s_best_loss, __pyx_n_s_best_split_val, __pyx_n_s_g_sum_left_nal, __pyx_n_s_h_sum_left_nal, __pyx_n_s_g_sum_right_nal, __pyx_n_s_h_sum_right_nal, __pyx_n_s_score_vec_nal, __pyx_n_s_best_loss_nal, __pyx_n_s_best_split_val_nal); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 47, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__24);
   __Pyx_GIVEREF(__pyx_tuple__24);
-  __pyx_codeobj__4 = (PyObject*)__Pyx_PyCode_New(4, 0, 24, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_evaluate_numerical_splits, 48, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__4)) __PYX_ERR(0, 48, __pyx_L1_error)
+  __pyx_codeobj__4 = (PyObject*)__Pyx_PyCode_New(4, 0, 24, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_evaluate_numerical_splits, 47, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__4)) __PYX_ERR(0, 47, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":90
+  /* "structureboost/structure_dt_multi.pyx":89
  * 
  * 
  *     def get_gh_val_mat(self, feature_vec_node,g_h_train_node,             # <<<<<<<<<<<<<<
  *                        max_num_vertices):
  *         g_h_val_arr = np.zeros((max_num_vertices,2*self.num_classes))
  */
-  __pyx_tuple__25 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_feature_vec_node, __pyx_n_s_g_h_train_node, __pyx_n_s_max_num_vertices, __pyx_n_s_g_h_val_arr); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 90, __pyx_L1_error)
+  __pyx_tuple__25 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_feature_vec_node, __pyx_n_s_g_h_train_node, __pyx_n_s_max_num_vertices, __pyx_n_s_g_h_val_arr); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 89, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__25);
   __Pyx_GIVEREF(__pyx_tuple__25);
-  __pyx_codeobj__8 = (PyObject*)__Pyx_PyCode_New(4, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__25, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_gh_val_mat, 90, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__8)) __PYX_ERR(0, 90, __pyx_L1_error)
+  __pyx_codeobj__8 = (PyObject*)__Pyx_PyCode_New(4, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__25, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_gh_val_mat, 89, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__8)) __PYX_ERR(0, 89, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":101
+  /* "structureboost/structure_dt_multi.pyx":100
  *     @cython.boundscheck(False)  # Deactivate bounds checking
  *     @cython.wraparound(False)   # Deactivate negative indexing.
  *     def update_g_h_accum(self, np.ndarray[double, ndim=2] g_h_accum_array,             # <<<<<<<<<<<<<<
  *         long lni, long lvi):
  *         ## TODO: make this more efficient (cython)
  */
-  __pyx_tuple__26 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_g_h_accum_array, __pyx_n_s_lni, __pyx_n_s_lvi, __pyx_n_s_j, __pyx_n_s_limit); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 101, __pyx_L1_error)
+  __pyx_tuple__26 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_g_h_accum_array, __pyx_n_s_lni, __pyx_n_s_lvi, __pyx_n_s_j, __pyx_n_s_limit); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 100, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__26);
   __Pyx_GIVEREF(__pyx_tuple__26);
-  __pyx_codeobj__9 = (PyObject*)__Pyx_PyCode_New(4, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__26, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_update_g_h_accum, 101, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__9)) __PYX_ERR(0, 101, __pyx_L1_error)
+  __pyx_codeobj__9 = (PyObject*)__Pyx_PyCode_New(4, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__26, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_update_g_h_accum, 100, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__9)) __PYX_ERR(0, 100, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":110
+  /* "structureboost/structure_dt_multi.pyx":109
  *         return g_h_accum_array
  * 
  *     def get_loss_in_span_tree(self, feature_vec_node, g_h_train_node,             # <<<<<<<<<<<<<<
  *                               g_h_accum_array, g_h_sum, leaf_vertex_ind,
  *                               left_feat_values, feature_type):
  */
-  __pyx_tuple__27 = PyTuple_Pack(13, __pyx_n_s_self, __pyx_n_s_feature_vec_node, __pyx_n_s_g_h_train_node, __pyx_n_s_g_h_accum_array, __pyx_n_s_g_h_sum, __pyx_n_s_leaf_vertex_ind, __pyx_n_s_left_feat_values, __pyx_n_s_feature_type, __pyx_n_s_g_left, __pyx_n_s_h_left, __pyx_n_s_g_sum, __pyx_n_s_h_sum, __pyx_n_s_curr_loss); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 110, __pyx_L1_error)
+  __pyx_tuple__27 = PyTuple_Pack(13, __pyx_n_s_self, __pyx_n_s_feature_vec_node, __pyx_n_s_g_h_train_node, __pyx_n_s_g_h_accum_array, __pyx_n_s_g_h_sum, __pyx_n_s_leaf_vertex_ind, __pyx_n_s_left_feat_values, __pyx_n_s_feature_type, __pyx_n_s_g_left, __pyx_n_s_h_left, __pyx_n_s_g_sum, __pyx_n_s_h_sum, __pyx_n_s_curr_loss); if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__27);
   __Pyx_GIVEREF(__pyx_tuple__27);
-  __pyx_codeobj__10 = (PyObject*)__Pyx_PyCode_New(8, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__27, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_loss_in_span_tree, 110, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__10)) __PYX_ERR(0, 110, __pyx_L1_error)
+  __pyx_codeobj__10 = (PyObject*)__Pyx_PyCode_New(8, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__27, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_loss_in_span_tree, 109, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__10)) __PYX_ERR(0, 109, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":123
+  /* "structureboost/structure_dt_multi.pyx":122
  * 
  * 
  *     def get_score_of_split(self, g_h_train_node, mask_left, g_h_sum):             # <<<<<<<<<<<<<<
  *         g_h_masked = g_h_train_node[mask_left,:]
  *         g_h_masked_sum = np.sum(g_h_masked, axis=0)
  */
-  __pyx_tuple__28 = PyTuple_Pack(11, __pyx_n_s_self, __pyx_n_s_g_h_train_node, __pyx_n_s_mask_left, __pyx_n_s_g_h_sum, __pyx_n_s_g_h_masked, __pyx_n_s_g_h_masked_sum, __pyx_n_s_g_left, __pyx_n_s_h_left, __pyx_n_s_g_sum, __pyx_n_s_h_sum, __pyx_n_s_curr_loss); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 123, __pyx_L1_error)
+  __pyx_tuple__28 = PyTuple_Pack(11, __pyx_n_s_self, __pyx_n_s_g_h_train_node, __pyx_n_s_mask_left, __pyx_n_s_g_h_sum, __pyx_n_s_g_h_masked, __pyx_n_s_g_h_masked_sum, __pyx_n_s_g_left, __pyx_n_s_h_left, __pyx_n_s_g_sum, __pyx_n_s_h_sum, __pyx_n_s_curr_loss); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 122, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__28);
   __Pyx_GIVEREF(__pyx_tuple__28);
-  __pyx_codeobj__11 = (PyObject*)__Pyx_PyCode_New(4, 0, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__28, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_score_of_split, 123, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 123, __pyx_L1_error)
+  __pyx_codeobj__11 = (PyObject*)__Pyx_PyCode_New(4, 0, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__28, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_score_of_split, 122, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 122, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":136
+  /* "structureboost/structure_dt_multi.pyx":135
  * 
  * 
  *     def predict(self, X_test):             # <<<<<<<<<<<<<<
  *         col_list = list(X_test.columns)
  *         column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}
  */
-  __pyx_tuple__29 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_X_test, __pyx_n_s_col_list, __pyx_n_s_column_to_int_dict, __pyx_n_s_i); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 136, __pyx_L1_error)
+  __pyx_tuple__29 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_X_test, __pyx_n_s_col_list, __pyx_n_s_column_to_int_dict, __pyx_n_s_i); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 135, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__29);
   __Pyx_GIVEREF(__pyx_tuple__29);
-  __pyx_codeobj__12 = (PyObject*)__Pyx_PyCode_New(2, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_predict, 136, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__12)) __PYX_ERR(0, 136, __pyx_L1_error)
+  __pyx_codeobj__12 = (PyObject*)__Pyx_PyCode_New(2, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_predict, 135, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__12)) __PYX_ERR(0, 135, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":143
+  /* "structureboost/structure_dt_multi.pyx":142
  * 
  * 
  *     def get_prediction(self, tree_node, X_te, dict col_to_int_dict):             # <<<<<<<<<<<<<<
- *         cdef np.ndarray[dtype_int64_t] ind_subset_left, ind_subset_right
+ *         cdef np.ndarray[np.int_t] ind_subset_left, ind_subset_right
  *         cdef long vec_len, lsize
  */
-  __pyx_tuple__30 = PyTuple_Pack(10, __pyx_n_s_self, __pyx_n_s_tree_node, __pyx_n_s_X_te, __pyx_n_s_col_to_int_dict, __pyx_n_s_ind_subset_left, __pyx_n_s_ind_subset_right, __pyx_n_s_vec_len, __pyx_n_s_lsize, __pyx_n_s_next_vec, __pyx_n_s_split_bool); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 143, __pyx_L1_error)
+  __pyx_tuple__30 = PyTuple_Pack(10, __pyx_n_s_self, __pyx_n_s_tree_node, __pyx_n_s_X_te, __pyx_n_s_col_to_int_dict, __pyx_n_s_ind_subset_left, __pyx_n_s_ind_subset_right, __pyx_n_s_vec_len, __pyx_n_s_lsize, __pyx_n_s_next_vec, __pyx_n_s_split_bool); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 142, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__30);
   __Pyx_GIVEREF(__pyx_tuple__30);
-  __pyx_codeobj__13 = (PyObject*)__Pyx_PyCode_New(4, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__30, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_prediction, 143, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__13)) __PYX_ERR(0, 143, __pyx_L1_error)
+  __pyx_codeobj__13 = (PyObject*)__Pyx_PyCode_New(4, 0, 10, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__30, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_prediction, 142, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__13)) __PYX_ERR(0, 142, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":180
+  /* "structureboost/structure_dt_multi.pyx":179
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * def get_g_h_feature_sum_matrix(np.ndarray[dtype_int64_t] feature_vec_node,             # <<<<<<<<<<<<<<
+ * def get_g_h_feature_sum_matrix(np.ndarray[np.int_t] feature_vec_node,             # <<<<<<<<<<<<<<
  *                                np.ndarray[double, ndim=2] g_h_train_node,
  *                                np.ndarray[double, ndim=2] g_h_val_arr,
  */
-  __pyx_tuple__31 = PyTuple_Pack(8, __pyx_n_s_feature_vec_node, __pyx_n_s_g_h_train_node, __pyx_n_s_g_h_val_arr, __pyx_n_s_num_classes, __pyx_n_s_i, __pyx_n_s_ind, __pyx_n_s_array_size, __pyx_n_s_j); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 180, __pyx_L1_error)
+  __pyx_tuple__31 = PyTuple_Pack(8, __pyx_n_s_feature_vec_node, __pyx_n_s_g_h_train_node, __pyx_n_s_g_h_val_arr, __pyx_n_s_num_classes, __pyx_n_s_i, __pyx_n_s_ind, __pyx_n_s_array_size, __pyx_n_s_j); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 179, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__31);
   __Pyx_GIVEREF(__pyx_tuple__31);
-  __pyx_codeobj__14 = (PyObject*)__Pyx_PyCode_New(4, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__31, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_g_h_feature_sum_matrix, 180, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__14)) __PYX_ERR(0, 180, __pyx_L1_error)
+  __pyx_codeobj__14 = (PyObject*)__Pyx_PyCode_New(4, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__31, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_g_h_feature_sum_matrix, 179, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__14)) __PYX_ERR(0, 179, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":193
+  /* "structureboost/structure_dt_multi.pyx":192
  * 
  * 
  * def _get_gh_score_num_mc(np.ndarray[double] g_left,             # <<<<<<<<<<<<<<
  *                       np.ndarray[double] g_right,
  *                       np.ndarray[double] h_left,
  */
-  __pyx_tuple__32 = PyTuple_Pack(8, __pyx_n_s_g_left, __pyx_n_s_g_right, __pyx_n_s_h_left, __pyx_n_s_h_right, __pyx_n_s_gamma, __pyx_n_s_reg_lambda, __pyx_n_s_tol, __pyx_n_s_loss_val); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 193, __pyx_L1_error)
+  __pyx_tuple__32 = PyTuple_Pack(8, __pyx_n_s_g_left, __pyx_n_s_g_right, __pyx_n_s_h_left, __pyx_n_s_h_right, __pyx_n_s_gamma, __pyx_n_s_reg_lambda, __pyx_n_s_tol, __pyx_n_s_loss_val); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 192, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__32);
   __Pyx_GIVEREF(__pyx_tuple__32);
-  __pyx_codeobj__15 = (PyObject*)__Pyx_PyCode_New(7, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__32, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_gh_score_num_mc, 193, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__15)) __PYX_ERR(0, 193, __pyx_L1_error)
+  __pyx_codeobj__15 = (PyObject*)__Pyx_PyCode_New(7, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__32, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_gh_score_num_mc, 192, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__15)) __PYX_ERR(0, 192, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":207
+  /* "structureboost/structure_dt_multi.pyx":206
  * 
  * 
  * def _get_gh_score_array_mc(np.ndarray[double, ndim=2] g_left,             # <<<<<<<<<<<<<<
  *                         np.ndarray[double, ndim=2] g_right,
  *                         np.ndarray[double, ndim=2] h_left,
  */
-  __pyx_tuple__33 = PyTuple_Pack(6, __pyx_n_s_g_left, __pyx_n_s_g_right, __pyx_n_s_h_left, __pyx_n_s_h_right, __pyx_n_s_gamma, __pyx_n_s_reg_lambda); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 207, __pyx_L1_error)
+  __pyx_tuple__33 = PyTuple_Pack(6, __pyx_n_s_g_left, __pyx_n_s_g_right, __pyx_n_s_h_left, __pyx_n_s_h_right, __pyx_n_s_gamma, __pyx_n_s_reg_lambda); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 206, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__33);
   __Pyx_GIVEREF(__pyx_tuple__33);
-  __pyx_codeobj__16 = (PyObject*)__Pyx_PyCode_New(6, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_gh_score_array_mc, 207, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__16)) __PYX_ERR(0, 207, __pyx_L1_error)
+  __pyx_codeobj__16 = (PyObject*)__Pyx_PyCode_New(6, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_gh_score_array_mc, 206, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__16)) __PYX_ERR(0, 206, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":220
+  /* "structureboost/structure_dt_multi.pyx":219
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * def get_bin_sums_c_mc(np.ndarray[double, ndim=2] g_h_mat,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] bin_result_vec,
+ *                    np.ndarray[np.int_t] bin_result_vec,
  *                    long out_vec_size, long num_classes):
  */
-  __pyx_tuple__34 = PyTuple_Pack(9, __pyx_n_s_g_h_mat, __pyx_n_s_bin_result_vec, __pyx_n_s_out_vec_size, __pyx_n_s_num_classes, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_m, __pyx_n_s_g_sum_bins, __pyx_n_s_h_sum_bins); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 220, __pyx_L1_error)
+  __pyx_tuple__34 = PyTuple_Pack(9, __pyx_n_s_g_h_mat, __pyx_n_s_bin_result_vec, __pyx_n_s_out_vec_size, __pyx_n_s_num_classes, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_m, __pyx_n_s_g_sum_bins, __pyx_n_s_h_sum_bins); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__34);
   __Pyx_GIVEREF(__pyx_tuple__34);
-  __pyx_codeobj__17 = (PyObject*)__Pyx_PyCode_New(4, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__34, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_bin_sums_c_mc, 220, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__17)) __PYX_ERR(0, 220, __pyx_L1_error)
+  __pyx_codeobj__17 = (PyObject*)__Pyx_PyCode_New(4, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__34, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_bin_sums_c_mc, 219, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__17)) __PYX_ERR(0, 219, __pyx_L1_error)
 
-  /* "structureboost/structure_dt_multi.pyx":235
+  /* "structureboost/structure_dt_multi.pyx":234
  *     return g_sum_bins, h_sum_bins
  * 
  * def get_left_right_sums_mc(bin_sums):             # <<<<<<<<<<<<<<
  *     sum_left = np.cumsum(bin_sums, axis=0)
  *     sum_total = sum_left[-1,:]
  */
-  __pyx_tuple__35 = PyTuple_Pack(4, __pyx_n_s_bin_sums, __pyx_n_s_sum_left, __pyx_n_s_sum_total, __pyx_n_s_sum_right); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 235, __pyx_L1_error)
+  __pyx_tuple__35 = PyTuple_Pack(4, __pyx_n_s_bin_sums, __pyx_n_s_sum_left, __pyx_n_s_sum_total, __pyx_n_s_sum_right); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 234, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__35);
   __Pyx_GIVEREF(__pyx_tuple__35);
-  __pyx_codeobj__18 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_left_right_sums_mc, 235, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__18)) __PYX_ERR(0, 235, __pyx_L1_error)
+  __pyx_codeobj__18 = (PyObject*)__Pyx_PyCode_New(1, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_dt_multi_pyx, __pyx_n_s_get_left_right_sums_mc, 234, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__18)) __PYX_ERR(0, 234, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
   return 0;
   __pyx_L1_error:;
   __Pyx_RefNannyFinishContext();
   return -1;
 }
 
@@ -10862,222 +10853,222 @@
  * cimport cython
  */
   __pyx_t_2 = __Pyx_Import(__pyx_n_s_structure_dt, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_stdt, __pyx_t_2) < 0) __PYX_ERR(0, 15, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":21
- * ctypedef np.int64_t dtype_int64_t
+  /* "structureboost/structure_dt_multi.pyx":20
+ * 
  * 
  * class StructureDecisionTreeMulti(StructureDecisionTree):             # <<<<<<<<<<<<<<
  *     """Multi class Decision Tree using graphical structure.
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_StructureDecisionTree); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 21, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_StructureDecisionTree); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 20, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 21, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 20, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 21, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_CalculateMetaclass(NULL, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 20, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_1, __pyx_n_s_StructureDecisionTreeMulti, __pyx_n_s_StructureDecisionTreeMulti, (PyObject *) NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_kp_s_Multi_class_Decision_Tree_using); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 21, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_1, __pyx_n_s_StructureDecisionTreeMulti, __pyx_n_s_StructureDecisionTreeMulti, (PyObject *) NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_kp_s_Multi_class_Decision_Tree_using); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 20, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 21, __pyx_L1_error)
+  __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 20, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
 
-  /* "structureboost/structure_dt_multi.pyx":27
+  /* "structureboost/structure_dt_multi.pyx":26
  *     """
  * 
  *     def __init__(self, feature_configs, feature_graphs, num_classes,             # <<<<<<<<<<<<<<
  *                  min_size_split=2,
  *                  max_depth=3, gamma=0, feat_sample_by_node=1,
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_1__init__, 0, __pyx_n_s_StructureDecisionTreeMulti___ini, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj_)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 27, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_1__init__, 0, __pyx_n_s_StructureDecisionTreeMulti___ini, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj_)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 26, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(__pyx_t_5);
   PyList_Append(__pyx_t_4, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_5);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_5, __pyx_tuple__22);
-  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_init, __pyx_t_5) < 0) __PYX_ERR(0, 27, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_init, __pyx_t_5) < 0) __PYX_ERR(0, 26, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":39
+  /* "structureboost/structure_dt_multi.pyx":38
  *         self.num_classes = num_classes
  * 
  *     def _node_summary_gh(self, g_h_mat):             # <<<<<<<<<<<<<<
  *         if (g_h_mat.shape[0] == 0):
  *             return np.zeros(self.num_classes)
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_3_node_summary_gh, 0, __pyx_n_s_StructureDecisionTreeMulti__node, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj__2)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 39, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_3_node_summary_gh, 0, __pyx_n_s_StructureDecisionTreeMulti__node, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj__2)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 38, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_node_summary_gh, __pyx_t_5) < 0) __PYX_ERR(0, 39, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_node_summary_gh, __pyx_t_5) < 0) __PYX_ERR(0, 38, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":48
+  /* "structureboost/structure_dt_multi.pyx":47
  *             return(out_val)
  * 
  *     def _evaluate_numerical_splits(self, feature_vec, g_h_mat,             # <<<<<<<<<<<<<<
  *                                    split_vec):
  * 
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_5_evaluate_numerical_splits, 0, __pyx_n_s_StructureDecisionTreeMulti__eval, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj__4)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 48, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_5_evaluate_numerical_splits, 0, __pyx_n_s_StructureDecisionTreeMulti__eval, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj__4)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 47, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_evaluate_numerical_splits, __pyx_t_5) < 0) __PYX_ERR(0, 48, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_evaluate_numerical_splits, __pyx_t_5) < 0) __PYX_ERR(0, 47, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":90
+  /* "structureboost/structure_dt_multi.pyx":89
  * 
  * 
  *     def get_gh_val_mat(self, feature_vec_node,g_h_train_node,             # <<<<<<<<<<<<<<
  *                        max_num_vertices):
  *         g_h_val_arr = np.zeros((max_num_vertices,2*self.num_classes))
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_7get_gh_val_mat, 0, __pyx_n_s_StructureDecisionTreeMulti_get_g, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj__8)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 90, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_7get_gh_val_mat, 0, __pyx_n_s_StructureDecisionTreeMulti_get_g, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj__8)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 89, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_get_gh_val_mat, __pyx_t_5) < 0) __PYX_ERR(0, 90, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_get_gh_val_mat, __pyx_t_5) < 0) __PYX_ERR(0, 89, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":101
+  /* "structureboost/structure_dt_multi.pyx":100
  *     @cython.boundscheck(False)  # Deactivate bounds checking
  *     @cython.wraparound(False)   # Deactivate negative indexing.
  *     def update_g_h_accum(self, np.ndarray[double, ndim=2] g_h_accum_array,             # <<<<<<<<<<<<<<
  *         long lni, long lvi):
  *         ## TODO: make this more efficient (cython)
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_9update_g_h_accum, 0, __pyx_n_s_StructureDecisionTreeMulti_updat, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj__9)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 101, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_9update_g_h_accum, 0, __pyx_n_s_StructureDecisionTreeMulti_updat, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj__9)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 100, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_update_g_h_accum, __pyx_t_5) < 0) __PYX_ERR(0, 101, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_update_g_h_accum, __pyx_t_5) < 0) __PYX_ERR(0, 100, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":110
+  /* "structureboost/structure_dt_multi.pyx":109
  *         return g_h_accum_array
  * 
  *     def get_loss_in_span_tree(self, feature_vec_node, g_h_train_node,             # <<<<<<<<<<<<<<
  *                               g_h_accum_array, g_h_sum, leaf_vertex_ind,
  *                               left_feat_values, feature_type):
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_11get_loss_in_span_tree, 0, __pyx_n_s_StructureDecisionTreeMulti_get_l, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj__10)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 110, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_11get_loss_in_span_tree, 0, __pyx_n_s_StructureDecisionTreeMulti_get_l, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj__10)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_get_loss_in_span_tree, __pyx_t_5) < 0) __PYX_ERR(0, 110, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_get_loss_in_span_tree, __pyx_t_5) < 0) __PYX_ERR(0, 109, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":123
+  /* "structureboost/structure_dt_multi.pyx":122
  * 
  * 
  *     def get_score_of_split(self, g_h_train_node, mask_left, g_h_sum):             # <<<<<<<<<<<<<<
  *         g_h_masked = g_h_train_node[mask_left,:]
  *         g_h_masked_sum = np.sum(g_h_masked, axis=0)
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_13get_score_of_split, 0, __pyx_n_s_StructureDecisionTreeMulti_get_s, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj__11)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 123, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_13get_score_of_split, 0, __pyx_n_s_StructureDecisionTreeMulti_get_s, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj__11)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 122, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_get_score_of_split, __pyx_t_5) < 0) __PYX_ERR(0, 123, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_get_score_of_split, __pyx_t_5) < 0) __PYX_ERR(0, 122, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":136
+  /* "structureboost/structure_dt_multi.pyx":135
  * 
  * 
  *     def predict(self, X_test):             # <<<<<<<<<<<<<<
  *         col_list = list(X_test.columns)
  *         column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_15predict, 0, __pyx_n_s_StructureDecisionTreeMulti_predi, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj__12)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 136, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_15predict, 0, __pyx_n_s_StructureDecisionTreeMulti_predi, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj__12)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 135, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_predict, __pyx_t_5) < 0) __PYX_ERR(0, 136, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_predict, __pyx_t_5) < 0) __PYX_ERR(0, 135, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":143
+  /* "structureboost/structure_dt_multi.pyx":142
  * 
  * 
  *     def get_prediction(self, tree_node, X_te, dict col_to_int_dict):             # <<<<<<<<<<<<<<
- *         cdef np.ndarray[dtype_int64_t] ind_subset_left, ind_subset_right
+ *         cdef np.ndarray[np.int_t] ind_subset_left, ind_subset_right
  *         cdef long vec_len, lsize
  */
-  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_17get_prediction, 0, __pyx_n_s_StructureDecisionTreeMulti_get_p, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj__13)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 143, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_dt_multi_26StructureDecisionTreeMulti_17get_prediction, 0, __pyx_n_s_StructureDecisionTreeMulti_get_p, NULL, __pyx_n_s_structureboost_structure_dt_mult, __pyx_d, ((PyObject *)__pyx_codeobj__13)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 142, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_get_prediction, __pyx_t_5) < 0) __PYX_ERR(0, 143, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_get_prediction, __pyx_t_5) < 0) __PYX_ERR(0, 142, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":21
- * ctypedef np.int64_t dtype_int64_t
+  /* "structureboost/structure_dt_multi.pyx":20
+ * 
  * 
  * class StructureDecisionTreeMulti(StructureDecisionTree):             # <<<<<<<<<<<<<<
  *     """Multi class Decision Tree using graphical structure.
  * 
  */
-  __pyx_t_5 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_StructureDecisionTreeMulti, __pyx_t_1, __pyx_t_3, NULL, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 21, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_StructureDecisionTreeMulti, __pyx_t_1, __pyx_t_3, NULL, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 20, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  if (__Pyx_CyFunction_InitClassCell(__pyx_t_4, __pyx_t_5) < 0) __PYX_ERR(0, 21, __pyx_L1_error)
+  if (__Pyx_CyFunction_InitClassCell(__pyx_t_4, __pyx_t_5) < 0) __PYX_ERR(0, 20, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_StructureDecisionTreeMulti, __pyx_t_5) < 0) __PYX_ERR(0, 21, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_StructureDecisionTreeMulti, __pyx_t_5) < 0) __PYX_ERR(0, 20, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":180
+  /* "structureboost/structure_dt_multi.pyx":179
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * def get_g_h_feature_sum_matrix(np.ndarray[dtype_int64_t] feature_vec_node,             # <<<<<<<<<<<<<<
+ * def get_g_h_feature_sum_matrix(np.ndarray[np.int_t] feature_vec_node,             # <<<<<<<<<<<<<<
  *                                np.ndarray[double, ndim=2] g_h_train_node,
  *                                np.ndarray[double, ndim=2] g_h_val_arr,
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_dt_multi_1get_g_h_feature_sum_matrix, NULL, __pyx_n_s_structureboost_structure_dt_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 180, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_dt_multi_1get_g_h_feature_sum_matrix, NULL, __pyx_n_s_structureboost_structure_dt_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 179, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_g_h_feature_sum_matrix, __pyx_t_1) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_g_h_feature_sum_matrix, __pyx_t_1) < 0) __PYX_ERR(0, 179, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":193
+  /* "structureboost/structure_dt_multi.pyx":192
  * 
  * 
  * def _get_gh_score_num_mc(np.ndarray[double] g_left,             # <<<<<<<<<<<<<<
  *                       np.ndarray[double] g_right,
  *                       np.ndarray[double] h_left,
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_dt_multi_3_get_gh_score_num_mc, NULL, __pyx_n_s_structureboost_structure_dt_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 193, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_dt_multi_3_get_gh_score_num_mc, NULL, __pyx_n_s_structureboost_structure_dt_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 192, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_gh_score_num_mc, __pyx_t_1) < 0) __PYX_ERR(0, 193, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_gh_score_num_mc, __pyx_t_1) < 0) __PYX_ERR(0, 192, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":207
+  /* "structureboost/structure_dt_multi.pyx":206
  * 
  * 
  * def _get_gh_score_array_mc(np.ndarray[double, ndim=2] g_left,             # <<<<<<<<<<<<<<
  *                         np.ndarray[double, ndim=2] g_right,
  *                         np.ndarray[double, ndim=2] h_left,
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_dt_multi_5_get_gh_score_array_mc, NULL, __pyx_n_s_structureboost_structure_dt_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 207, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_dt_multi_5_get_gh_score_array_mc, NULL, __pyx_n_s_structureboost_structure_dt_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 206, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_gh_score_array_mc, __pyx_t_1) < 0) __PYX_ERR(0, 207, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_gh_score_array_mc, __pyx_t_1) < 0) __PYX_ERR(0, 206, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":220
+  /* "structureboost/structure_dt_multi.pyx":219
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * def get_bin_sums_c_mc(np.ndarray[double, ndim=2] g_h_mat,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] bin_result_vec,
+ *                    np.ndarray[np.int_t] bin_result_vec,
  *                    long out_vec_size, long num_classes):
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_dt_multi_7get_bin_sums_c_mc, NULL, __pyx_n_s_structureboost_structure_dt_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 220, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_dt_multi_7get_bin_sums_c_mc, NULL, __pyx_n_s_structureboost_structure_dt_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_bin_sums_c_mc, __pyx_t_1) < 0) __PYX_ERR(0, 220, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_bin_sums_c_mc, __pyx_t_1) < 0) __PYX_ERR(0, 219, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_dt_multi.pyx":235
+  /* "structureboost/structure_dt_multi.pyx":234
  *     return g_sum_bins, h_sum_bins
  * 
  * def get_left_right_sums_mc(bin_sums):             # <<<<<<<<<<<<<<
  *     sum_left = np.cumsum(bin_sums, axis=0)
  *     sum_total = sum_left[-1,:]
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_dt_multi_9get_left_right_sums_mc, NULL, __pyx_n_s_structureboost_structure_dt_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 235, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_dt_multi_9get_left_right_sums_mc, NULL, __pyx_n_s_structureboost_structure_dt_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 234, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_left_right_sums_mc, __pyx_t_1) < 0) __PYX_ERR(0, 235, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_left_right_sums_mc, __pyx_t_1) < 0) __PYX_ERR(0, 234, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "structureboost/structure_dt_multi.pyx":1
  * # cython: profile=True             # <<<<<<<<<<<<<<
  * # cython: language_level=3
  * 
  */
```

### Comparing `structureboost-0.4.0/structureboost/structure_gb.c` & `structureboost-0.4.1/structureboost/structure_gb.c`

 * *Files 1% similar despite different names*

```diff
@@ -1280,23 +1280,14 @@
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
-
-/* "structureboost/structure_gb.pyx":20
- * cimport cython
- * 
- * ctypedef np.int64_t dtype_int64_t             # <<<<<<<<<<<<<<
- * 
- * 
- */
-typedef __pyx_t_5numpy_int64_t __pyx_t_14structureboost_12structure_gb_dtype_int64_t;
 /* Declarations.proto */
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     typedef ::std::complex< float > __pyx_t_float_complex;
   #else
     typedef float _Complex __pyx_t_float_complex;
   #endif
@@ -2688,17 +2679,14 @@
 
 /* CIntFromPy.proto */
 static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);
 
 /* CIntToPy.proto */
 static CYTHON_INLINE PyObject* __Pyx_PyInt_From_Py_intptr_t(Py_intptr_t value);
 
-/* CIntToPy.proto */
-static CYTHON_INLINE PyObject* __Pyx_PyInt_From_npy_int64(npy_int64 value);
-
 /* CIntFromPy.proto */
 static CYTHON_INLINE char __Pyx_PyInt_As_char(PyObject *);
 
 /* CheckBinaryVersion.proto */
 static int __Pyx_check_binary_version(void);
 
 /* InitStrings.proto */
@@ -2806,15 +2794,14 @@
 static void __pyx_memoryview_refcount_objects_in_slice_with_gil(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_slice_assign_scalar(__Pyx_memviewslice *, int, size_t, void *, int); /*proto*/
 static void __pyx_memoryview__slice_assign_scalar(char *, Py_ssize_t *, Py_ssize_t *, int, size_t, void *); /*proto*/
 static PyObject *__pyx_unpickle_Enum__set_state(struct __pyx_MemviewEnum_obj *, PyObject *); /*proto*/
 static __Pyx_TypeInfo __Pyx_TypeInfo_double = { "double", NULL, sizeof(double), { 0 }, 0, 'R', 0, 0 };
 static __Pyx_TypeInfo __Pyx_TypeInfo_long = { "long", NULL, sizeof(long), { 0 }, 0, IS_UNSIGNED(long) ? 'U' : 'I', IS_UNSIGNED(long), 0 };
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_gb_dtype_int64_t = { "dtype_int64_t", NULL, sizeof(__pyx_t_14structureboost_12structure_gb_dtype_int64_t), { 0 }, 0, IS_UNSIGNED(__pyx_t_14structureboost_12structure_gb_dtype_int64_t) ? 'U' : 'I', IS_UNSIGNED(__pyx_t_14structureboost_12structure_gb_dtype_int64_t), 0 };
 #define __Pyx_MODULE_NAME "structureboost.structure_gb"
 extern int __pyx_module_is_main_structureboost__structure_gb;
 int __pyx_module_is_main_structureboost__structure_gb = 0;
 
 /* Implementation of 'structureboost.structure_gb' */
 static PyObject *__pyx_builtin_object;
 static PyObject *__pyx_builtin_print;
@@ -2852,14 +2839,15 @@
 static const char __pyx_k_doc[] = "__doc__";
 static const char __pyx_k_dtm[] = "dtm";
 static const char __pyx_k_eps[] = "eps";
 static const char __pyx_k_exp[] = "exp";
 static const char __pyx_k_fit[] = "fit";
 static const char __pyx_k_i_2[] = "i={}";
 static const char __pyx_k_ind[] = "ind";
+static const char __pyx_k_int[] = "int_";
 static const char __pyx_k_log[] = "log";
 static const char __pyx_k_max[] = "max";
 static const char __pyx_k_mse[] = "mse";
 static const char __pyx_k_new[] = "__new__";
 static const char __pyx_k_obj[] = "obj";
 static const char __pyx_k_phi[] = "phi";
 static const char __pyx_k_sum[] = "sum";
@@ -2905,15 +2893,14 @@
 static const char __pyx_k_dtype[] = "dtype";
 static const char __pyx_k_error[] = "error";
 static const char __pyx_k_flags[] = "flags";
 static const char __pyx_k_floor[] = "floor";
 static const char __pyx_k_gamma[] = "gamma";
 static const char __pyx_k_graph[] = "graph";
 static const char __pyx_k_index[] = "index";
-static const char __pyx_k_int64[] = "int64";
 static const char __pyx_k_isnan[] = "isnan";
 static const char __pyx_k_items[] = "items";
 static const char __pyx_k_nfeat[] = "nfeat";
 static const char __pyx_k_nrows[] = "nrows";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_print[] = "print";
 static const char __pyx_k_range[] = "range";
@@ -3228,24 +3215,24 @@
 static const char __pyx_k_Cannot_index_with_type_s[] = "Cannot index with type '%s'";
 static const char __pyx_k_default_contraction_size[] = "default_contraction_size";
 static const char __pyx_k_num_trees_for_prediction[] = "num_trees_for_prediction";
 static const char __pyx_k_Invalid_shape_in_axis_d_d[] = "Invalid shape in axis %d: %d.";
 static const char __pyx_k_StructureBoost__predict_py[] = "StructureBoost._predict_py";
 static const char __pyx_k_Warning_zero_fraction_is_0[] = "Warning: zero_fraction is 0";
 static const char __pyx_k_default_categorical_method[] = "default_categorical_method";
-static const char __pyx_k_get_basic_config_line_1228[] = "get_basic_config (line 1228)";
+static const char __pyx_k_get_basic_config_line_1226[] = "get_basic_config (line 1226)";
 static const char __pyx_k_StructureBoost_predict_shap[] = "StructureBoost.predict_shap";
 static const char __pyx_k_itemsize_0_for_cython_array[] = "itemsize <= 0 for cython.array";
 static const char __pyx_k_structureboost_structure_gb[] = "structureboost.structure_gb";
 static const char __pyx_k_StructureBoost__compute_loss[] = "StructureBoost._compute_loss";
 static const char __pyx_k_StructureBoost__predict_fast[] = "StructureBoost._predict_fast";
 static const char __pyx_k_StructureBoost__predict_shap[] = "StructureBoost._predict_shap";
 static const char __pyx_k_StructureBoost_predict_proba[] = "StructureBoost.predict_proba";
 static const char __pyx_k_StructureBoost_compute_gh_mat[] = "StructureBoost.compute_gh_mat";
-static const char __pyx_k_default_config_dict_line_1285[] = "default_config_dict (line 1285)";
+static const char __pyx_k_default_config_dict_line_1283[] = "default_config_dict (line 1283)";
 static const char __pyx_k_unable_to_allocate_array_data[] = "unable to allocate array data.";
 static const char __pyx_k_StructureBoost__process_y_data[] = "StructureBoost._process_y_data";
 static const char __pyx_k_StructureBoost_convert_subtree[] = "StructureBoost.convert_subtree";
 static const char __pyx_k_feature_type_not_configured_in[] = "\"feature_type\" not configured in feature {}";
 static const char __pyx_k_graph_not_connected_in_feature[] = "graph not connected in feature {}";
 static const char __pyx_k_randomize_node_na_dir_weighted[] = "randomize_node_na_dir_weighted";
 static const char __pyx_k_strided_and_direct_or_indirect[] = "<strided and direct or indirect>";
@@ -3454,15 +3441,15 @@
 static PyObject *__pyx_n_s_curr_valid_loss;
 static PyObject *__pyx_n_s_dec_tree;
 static PyObject *__pyx_n_s_dec_tree_list;
 static PyObject *__pyx_n_s_decimals;
 static PyObject *__pyx_n_u_default_categorical_method;
 static PyObject *__pyx_n_s_default_config;
 static PyObject *__pyx_n_s_default_config_dict;
-static PyObject *__pyx_kp_u_default_config_dict_line_1285;
+static PyObject *__pyx_kp_u_default_config_dict_line_1283;
 static PyObject *__pyx_n_s_default_configs;
 static PyObject *__pyx_n_u_default_contraction_max_splits_t;
 static PyObject *__pyx_n_u_default_contraction_size;
 static PyObject *__pyx_n_u_default_num_span_trees;
 static PyObject *__pyx_n_u_default_numerical_max_splits_to;
 static PyObject *__pyx_n_s_denom1;
 static PyObject *__pyx_n_s_denom2;
@@ -3529,15 +3516,15 @@
 static PyObject *__pyx_n_s_format;
 static PyObject *__pyx_n_s_fortran;
 static PyObject *__pyx_n_u_fortran;
 static PyObject *__pyx_n_s_found_val;
 static PyObject *__pyx_n_s_fromiter;
 static PyObject *__pyx_n_s_gamma;
 static PyObject *__pyx_n_s_get_basic_config;
-static PyObject *__pyx_kp_u_get_basic_config_line_1228;
+static PyObject *__pyx_kp_u_get_basic_config_line_1226;
 static PyObject *__pyx_n_s_get_basic_config_series;
 static PyObject *__pyx_n_s_get_features_for_tree;
 static PyObject *__pyx_n_s_get_initial_pred;
 static PyObject *__pyx_n_s_get_max_split_size;
 static PyObject *__pyx_n_s_get_rows_for_tree;
 static PyObject *__pyx_n_s_get_tensors_for_predict;
 static PyObject *__pyx_n_s_getstate;
@@ -3561,15 +3548,15 @@
 static PyObject *__pyx_n_s_index;
 static PyObject *__pyx_n_s_indexes;
 static PyObject *__pyx_n_s_init;
 static PyObject *__pyx_n_s_init_eval_set_info;
 static PyObject *__pyx_n_s_initial_model;
 static PyObject *__pyx_n_s_initial_pred;
 static PyObject *__pyx_n_s_initialize_uv_dict;
-static PyObject *__pyx_n_s_int64;
+static PyObject *__pyx_n_s_int;
 static PyObject *__pyx_n_u_interior;
 static PyObject *__pyx_n_s_inv_cti;
 static PyObject *__pyx_n_s_is_connected;
 static PyObject *__pyx_n_s_isnan;
 static PyObject *__pyx_n_s_isnan_array;
 static PyObject *__pyx_n_s_items;
 static PyObject *__pyx_n_s_itemsize;
@@ -4008,15 +3995,15 @@
 static PyObject *__pyx_codeobj__46;
 static PyObject *__pyx_codeobj__54;
 static PyObject *__pyx_codeobj__55;
 static PyObject *__pyx_codeobj__56;
 static PyObject *__pyx_codeobj__76;
 /* Late includes */
 
-/* "structureboost/structure_gb.pyx":137
+/* "structureboost/structure_gb.pyx":135
  *     Categorical Variables. https://arxiv.org/abs/2007.04446
  *     """
  *     def __init__(self, num_trees, feature_configs=None,             # <<<<<<<<<<<<<<
  *                  mode='classification',
  *                  loss_fn=None, subsample=1,
  */
 
@@ -4051,34 +4038,34 @@
   __Pyx_RefNannySetupContext("__init__ (wrapper)", 0);
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_num_trees,&__pyx_n_s_feature_configs,&__pyx_n_s_mode,&__pyx_n_s_loss_fn,&__pyx_n_s_subsample,&__pyx_n_s_initial_model,&__pyx_n_s_replace,&__pyx_n_s_min_size_split,&__pyx_n_s_max_depth,&__pyx_n_s_gamma,&__pyx_n_s_reg_lambda,&__pyx_n_s_feat_sample_by_tree,&__pyx_n_s_feat_sample_by_node,&__pyx_n_s_learning_rate,&__pyx_n_s_random_seed,&__pyx_n_s_na_unseen_action,&__pyx_n_s_prec_digits,&__pyx_n_s_default_configs,0};
     PyObject* values[19] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
     values[2] = ((PyObject *)((PyObject *)Py_None));
     values[3] = ((PyObject *)((PyObject*)__pyx_n_u_classification));
 
-    /* "structureboost/structure_gb.pyx":139
+    /* "structureboost/structure_gb.pyx":137
  *     def __init__(self, num_trees, feature_configs=None,
  *                  mode='classification',
  *                  loss_fn=None, subsample=1,             # <<<<<<<<<<<<<<
  *                  initial_model=None,
  *                  replace=True, min_size_split=25, max_depth=3,
  */
     values[4] = ((PyObject *)((PyObject *)Py_None));
     values[5] = ((PyObject *)((PyObject *)__pyx_int_1));
 
-    /* "structureboost/structure_gb.pyx":140
+    /* "structureboost/structure_gb.pyx":138
  *                  mode='classification',
  *                  loss_fn=None, subsample=1,
  *                  initial_model=None,             # <<<<<<<<<<<<<<
  *                  replace=True, min_size_split=25, max_depth=3,
  *                  gamma=0, reg_lambda=1, feat_sample_by_tree=1,
  */
     values[6] = ((PyObject *)((PyObject *)Py_None));
 
-    /* "structureboost/structure_gb.pyx":141
+    /* "structureboost/structure_gb.pyx":139
  *                  loss_fn=None, subsample=1,
  *                  initial_model=None,
  *                  replace=True, min_size_split=25, max_depth=3,             # <<<<<<<<<<<<<<
  *                  gamma=0, reg_lambda=1, feat_sample_by_tree=1,
  *                  feat_sample_by_node=1, learning_rate=.02,
  */
     values[7] = ((PyObject *)((PyObject *)Py_True));
@@ -4089,15 +4076,15 @@
     values[12] = ((PyObject *)((PyObject *)__pyx_int_1));
     values[13] = ((PyObject *)((PyObject *)__pyx_int_1));
     values[14] = ((PyObject *)((PyObject*)__pyx_float__02));
     values[15] = ((PyObject *)((PyObject *)__pyx_int_0));
     values[16] = ((PyObject *)((PyObject*)__pyx_n_u_weighted_random));
     values[17] = ((PyObject *)((PyObject *)__pyx_int_6));
 
-    /* "structureboost/structure_gb.pyx":145
+    /* "structureboost/structure_gb.pyx":143
  *                  feat_sample_by_node=1, learning_rate=.02,
  *                  random_seed=0, na_unseen_action='weighted_random',
  *                  prec_digits=6, default_configs=None):             # <<<<<<<<<<<<<<
  *         self.num_trees = num_trees
  *         self.num_trees_for_prediction = num_trees
  */
     values[18] = ((PyObject *)((PyObject *)Py_None));
@@ -4151,15 +4138,15 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num_trees)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 19, 1); __PYX_ERR(0, 137, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 19, 1); __PYX_ERR(0, 135, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_feature_configs);
           if (value) { values[2] = value; kw_args--; }
         }
@@ -4257,15 +4244,15 @@
         case 18:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_default_configs);
           if (value) { values[18] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 137, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 135, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case 19: values[18] = PyTuple_GET_ITEM(__pyx_args, 18);
         CYTHON_FALLTHROUGH;
         case 18: values[17] = PyTuple_GET_ITEM(__pyx_args, 17);
         CYTHON_FALLTHROUGH;
@@ -4323,23 +4310,23 @@
     __pyx_v_random_seed = values[15];
     __pyx_v_na_unseen_action = values[16];
     __pyx_v_prec_digits = values[17];
     __pyx_v_default_configs = values[18];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 19, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 137, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 0, 2, 19, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 135, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost___init__(__pyx_self, __pyx_v_self, __pyx_v_num_trees, __pyx_v_feature_configs, __pyx_v_mode, __pyx_v_loss_fn, __pyx_v_subsample, __pyx_v_initial_model, __pyx_v_replace, __pyx_v_min_size_split, __pyx_v_max_depth, __pyx_v_gamma, __pyx_v_reg_lambda, __pyx_v_feat_sample_by_tree, __pyx_v_feat_sample_by_node, __pyx_v_learning_rate, __pyx_v_random_seed, __pyx_v_na_unseen_action, __pyx_v_prec_digits, __pyx_v_default_configs);
 
-  /* "structureboost/structure_gb.pyx":137
+  /* "structureboost/structure_gb.pyx":135
  *     Categorical Variables. https://arxiv.org/abs/2007.04446
  *     """
  *     def __init__(self, num_trees, feature_configs=None,             # <<<<<<<<<<<<<<
  *                  mode='classification',
  *                  loss_fn=None, subsample=1,
  */
 
@@ -4358,661 +4345,661 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj_)
   __Pyx_RefNannySetupContext("__init__", 0);
-  __Pyx_TraceCall("__init__", __pyx_f[0], 137, 0, __PYX_ERR(0, 137, __pyx_L1_error));
+  __Pyx_TraceCall("__init__", __pyx_f[0], 135, 0, __PYX_ERR(0, 135, __pyx_L1_error));
   __Pyx_INCREF(__pyx_v_loss_fn);
 
-  /* "structureboost/structure_gb.pyx":146
+  /* "structureboost/structure_gb.pyx":144
  *                  random_seed=0, na_unseen_action='weighted_random',
  *                  prec_digits=6, default_configs=None):
  *         self.num_trees = num_trees             # <<<<<<<<<<<<<<
  *         self.num_trees_for_prediction = num_trees
  *         if feature_configs is not None:
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_num_trees, __pyx_v_num_trees) < 0) __PYX_ERR(0, 146, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_num_trees, __pyx_v_num_trees) < 0) __PYX_ERR(0, 144, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":147
+  /* "structureboost/structure_gb.pyx":145
  *                  prec_digits=6, default_configs=None):
  *         self.num_trees = num_trees
  *         self.num_trees_for_prediction = num_trees             # <<<<<<<<<<<<<<
  *         if feature_configs is not None:
  *             self.feature_configs = feature_configs.copy()
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_num_trees_for_prediction, __pyx_v_num_trees) < 0) __PYX_ERR(0, 147, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_num_trees_for_prediction, __pyx_v_num_trees) < 0) __PYX_ERR(0, 145, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":148
+  /* "structureboost/structure_gb.pyx":146
  *         self.num_trees = num_trees
  *         self.num_trees_for_prediction = num_trees
  *         if feature_configs is not None:             # <<<<<<<<<<<<<<
  *             self.feature_configs = feature_configs.copy()
  *             self._process_feature_configs()
  */
   __pyx_t_1 = (__pyx_v_feature_configs != Py_None);
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_gb.pyx":149
+    /* "structureboost/structure_gb.pyx":147
  *         self.num_trees_for_prediction = num_trees
  *         if feature_configs is not None:
  *             self.feature_configs = feature_configs.copy()             # <<<<<<<<<<<<<<
  *             self._process_feature_configs()
  *             self.feat_list_full = list(self.feature_configs.keys())
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_feature_configs, __pyx_n_s_copy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 149, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_feature_configs, __pyx_n_s_copy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 147, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 149, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 147, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs, __pyx_t_3) < 0) __PYX_ERR(0, 149, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs, __pyx_t_3) < 0) __PYX_ERR(0, 147, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "structureboost/structure_gb.pyx":150
+    /* "structureboost/structure_gb.pyx":148
  *         if feature_configs is not None:
  *             self.feature_configs = feature_configs.copy()
  *             self._process_feature_configs()             # <<<<<<<<<<<<<<
  *             self.feat_list_full = list(self.feature_configs.keys())
  *         else:
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_process_feature_configs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 150, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_process_feature_configs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 148, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 150, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 148, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "structureboost/structure_gb.pyx":151
+    /* "structureboost/structure_gb.pyx":149
  *             self.feature_configs = feature_configs.copy()
  *             self._process_feature_configs()
  *             self.feat_list_full = list(self.feature_configs.keys())             # <<<<<<<<<<<<<<
  *         else:
  *             self.feature_configs=None
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 151, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 149, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_keys); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 151, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_keys); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 149, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 151, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 149, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PySequence_List(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 151, __pyx_L1_error)
+    __pyx_t_5 = PySequence_List(__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 149, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_feat_list_full, __pyx_t_5) < 0) __PYX_ERR(0, 151, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_feat_list_full, __pyx_t_5) < 0) __PYX_ERR(0, 149, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":148
+    /* "structureboost/structure_gb.pyx":146
  *         self.num_trees = num_trees
  *         self.num_trees_for_prediction = num_trees
  *         if feature_configs is not None:             # <<<<<<<<<<<<<<
  *             self.feature_configs = feature_configs.copy()
  *             self._process_feature_configs()
  */
     goto __pyx_L3;
   }
 
-  /* "structureboost/structure_gb.pyx":153
+  /* "structureboost/structure_gb.pyx":151
  *             self.feat_list_full = list(self.feature_configs.keys())
  *         else:
  *             self.feature_configs=None             # <<<<<<<<<<<<<<
  *         self.min_size_split = min_size_split
  *         self.max_depth = max_depth
  */
   /*else*/ {
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs, Py_None) < 0) __PYX_ERR(0, 153, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs, Py_None) < 0) __PYX_ERR(0, 151, __pyx_L1_error)
   }
   __pyx_L3:;
 
-  /* "structureboost/structure_gb.pyx":154
+  /* "structureboost/structure_gb.pyx":152
  *         else:
  *             self.feature_configs=None
  *         self.min_size_split = min_size_split             # <<<<<<<<<<<<<<
  *         self.max_depth = max_depth
  *         self.gamma = gamma
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_min_size_split, __pyx_v_min_size_split) < 0) __PYX_ERR(0, 154, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_min_size_split, __pyx_v_min_size_split) < 0) __PYX_ERR(0, 152, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":155
+  /* "structureboost/structure_gb.pyx":153
  *             self.feature_configs=None
  *         self.min_size_split = min_size_split
  *         self.max_depth = max_depth             # <<<<<<<<<<<<<<
  *         self.gamma = gamma
  *         self.reg_lambda = reg_lambda
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_max_depth, __pyx_v_max_depth) < 0) __PYX_ERR(0, 155, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_max_depth, __pyx_v_max_depth) < 0) __PYX_ERR(0, 153, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":156
+  /* "structureboost/structure_gb.pyx":154
  *         self.min_size_split = min_size_split
  *         self.max_depth = max_depth
  *         self.gamma = gamma             # <<<<<<<<<<<<<<
  *         self.reg_lambda = reg_lambda
  *         self.learning_rate = learning_rate
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_gamma, __pyx_v_gamma) < 0) __PYX_ERR(0, 156, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_gamma, __pyx_v_gamma) < 0) __PYX_ERR(0, 154, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":157
+  /* "structureboost/structure_gb.pyx":155
  *         self.max_depth = max_depth
  *         self.gamma = gamma
  *         self.reg_lambda = reg_lambda             # <<<<<<<<<<<<<<
  *         self.learning_rate = learning_rate
  *         self.feat_sample_by_tree = feat_sample_by_tree
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_reg_lambda, __pyx_v_reg_lambda) < 0) __PYX_ERR(0, 157, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_reg_lambda, __pyx_v_reg_lambda) < 0) __PYX_ERR(0, 155, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":158
+  /* "structureboost/structure_gb.pyx":156
  *         self.gamma = gamma
  *         self.reg_lambda = reg_lambda
  *         self.learning_rate = learning_rate             # <<<<<<<<<<<<<<
  *         self.feat_sample_by_tree = feat_sample_by_tree
  *         self.feat_sample_by_node = feat_sample_by_node
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_learning_rate, __pyx_v_learning_rate) < 0) __PYX_ERR(0, 158, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_learning_rate, __pyx_v_learning_rate) < 0) __PYX_ERR(0, 156, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":159
+  /* "structureboost/structure_gb.pyx":157
  *         self.reg_lambda = reg_lambda
  *         self.learning_rate = learning_rate
  *         self.feat_sample_by_tree = feat_sample_by_tree             # <<<<<<<<<<<<<<
  *         self.feat_sample_by_node = feat_sample_by_node
  *         self.loss_fn = loss_fn
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_feat_sample_by_tree, __pyx_v_feat_sample_by_tree) < 0) __PYX_ERR(0, 159, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_feat_sample_by_tree, __pyx_v_feat_sample_by_tree) < 0) __PYX_ERR(0, 157, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":160
+  /* "structureboost/structure_gb.pyx":158
  *         self.learning_rate = learning_rate
  *         self.feat_sample_by_tree = feat_sample_by_tree
  *         self.feat_sample_by_node = feat_sample_by_node             # <<<<<<<<<<<<<<
  *         self.loss_fn = loss_fn
  *         self.subsample = subsample
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_feat_sample_by_node, __pyx_v_feat_sample_by_node) < 0) __PYX_ERR(0, 160, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_feat_sample_by_node, __pyx_v_feat_sample_by_node) < 0) __PYX_ERR(0, 158, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":161
+  /* "structureboost/structure_gb.pyx":159
  *         self.feat_sample_by_tree = feat_sample_by_tree
  *         self.feat_sample_by_node = feat_sample_by_node
  *         self.loss_fn = loss_fn             # <<<<<<<<<<<<<<
  *         self.subsample = subsample
  *         self.initial_model = initial_model
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn, __pyx_v_loss_fn) < 0) __PYX_ERR(0, 161, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn, __pyx_v_loss_fn) < 0) __PYX_ERR(0, 159, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":162
+  /* "structureboost/structure_gb.pyx":160
  *         self.feat_sample_by_node = feat_sample_by_node
  *         self.loss_fn = loss_fn
  *         self.subsample = subsample             # <<<<<<<<<<<<<<
  *         self.initial_model = initial_model
  *         self.replace = replace
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_subsample, __pyx_v_subsample) < 0) __PYX_ERR(0, 162, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_subsample, __pyx_v_subsample) < 0) __PYX_ERR(0, 160, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":163
+  /* "structureboost/structure_gb.pyx":161
  *         self.loss_fn = loss_fn
  *         self.subsample = subsample
  *         self.initial_model = initial_model             # <<<<<<<<<<<<<<
  *         self.replace = replace
  *         self.random_seed = random_seed
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_initial_model, __pyx_v_initial_model) < 0) __PYX_ERR(0, 163, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_initial_model, __pyx_v_initial_model) < 0) __PYX_ERR(0, 161, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":164
+  /* "structureboost/structure_gb.pyx":162
  *         self.subsample = subsample
  *         self.initial_model = initial_model
  *         self.replace = replace             # <<<<<<<<<<<<<<
  *         self.random_seed = random_seed
  *         self.na_unseen_action = na_unseen_action
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_replace, __pyx_v_replace) < 0) __PYX_ERR(0, 164, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_replace, __pyx_v_replace) < 0) __PYX_ERR(0, 162, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":165
+  /* "structureboost/structure_gb.pyx":163
  *         self.initial_model = initial_model
  *         self.replace = replace
  *         self.random_seed = random_seed             # <<<<<<<<<<<<<<
  *         self.na_unseen_action = na_unseen_action
  *         self.num_classes=2
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_random_seed, __pyx_v_random_seed) < 0) __PYX_ERR(0, 165, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_random_seed, __pyx_v_random_seed) < 0) __PYX_ERR(0, 163, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":166
+  /* "structureboost/structure_gb.pyx":164
  *         self.replace = replace
  *         self.random_seed = random_seed
  *         self.na_unseen_action = na_unseen_action             # <<<<<<<<<<<<<<
  *         self.num_classes=2
  *         self.optimized = False
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_na_unseen_action, __pyx_v_na_unseen_action) < 0) __PYX_ERR(0, 166, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_na_unseen_action, __pyx_v_na_unseen_action) < 0) __PYX_ERR(0, 164, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":167
+  /* "structureboost/structure_gb.pyx":165
  *         self.random_seed = random_seed
  *         self.na_unseen_action = na_unseen_action
  *         self.num_classes=2             # <<<<<<<<<<<<<<
  *         self.optimized = False
  *         self.prec_digits=prec_digits
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_num_classes, __pyx_int_2) < 0) __PYX_ERR(0, 167, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_num_classes, __pyx_int_2) < 0) __PYX_ERR(0, 165, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":168
+  /* "structureboost/structure_gb.pyx":166
  *         self.na_unseen_action = na_unseen_action
  *         self.num_classes=2
  *         self.optimized = False             # <<<<<<<<<<<<<<
  *         self.prec_digits=prec_digits
  *         self.mode = mode
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_optimized, Py_False) < 0) __PYX_ERR(0, 168, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_optimized, Py_False) < 0) __PYX_ERR(0, 166, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":169
+  /* "structureboost/structure_gb.pyx":167
  *         self.num_classes=2
  *         self.optimized = False
  *         self.prec_digits=prec_digits             # <<<<<<<<<<<<<<
  *         self.mode = mode
  *         if mode not in ['classification', 'regression']:
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prec_digits, __pyx_v_prec_digits) < 0) __PYX_ERR(0, 169, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_prec_digits, __pyx_v_prec_digits) < 0) __PYX_ERR(0, 167, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":170
+  /* "structureboost/structure_gb.pyx":168
  *         self.optimized = False
  *         self.prec_digits=prec_digits
  *         self.mode = mode             # <<<<<<<<<<<<<<
  *         if mode not in ['classification', 'regression']:
  *             warnings.warn('Mode not recognized')
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_mode, __pyx_v_mode) < 0) __PYX_ERR(0, 170, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_mode, __pyx_v_mode) < 0) __PYX_ERR(0, 168, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":171
+  /* "structureboost/structure_gb.pyx":169
  *         self.prec_digits=prec_digits
  *         self.mode = mode
  *         if mode not in ['classification', 'regression']:             # <<<<<<<<<<<<<<
  *             warnings.warn('Mode not recognized')
  *         if loss_fn is None:
  */
   __Pyx_INCREF(__pyx_v_mode);
   __pyx_t_5 = __pyx_v_mode;
-  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_t_5, __pyx_n_u_classification, Py_NE)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 171, __pyx_L1_error)
+  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_t_5, __pyx_n_u_classification, Py_NE)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 169, __pyx_L1_error)
   if (__pyx_t_1) {
   } else {
     __pyx_t_2 = __pyx_t_1;
     goto __pyx_L5_bool_binop_done;
   }
-  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_t_5, __pyx_n_u_regression, Py_NE)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 171, __pyx_L1_error)
+  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_t_5, __pyx_n_u_regression, Py_NE)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 169, __pyx_L1_error)
   __pyx_t_2 = __pyx_t_1;
   __pyx_L5_bool_binop_done:;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_1 = (__pyx_t_2 != 0);
   if (__pyx_t_1) {
 
-    /* "structureboost/structure_gb.pyx":172
+    /* "structureboost/structure_gb.pyx":170
  *         self.mode = mode
  *         if mode not in ['classification', 'regression']:
  *             warnings.warn('Mode not recognized')             # <<<<<<<<<<<<<<
  *         if loss_fn is None:
  *             if mode == 'classification':
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_warnings); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 172, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_warnings); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 170, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_warn); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 172, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_warn); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 170, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_5 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_kp_u_Mode_not_recognized) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_kp_u_Mode_not_recognized);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 172, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 170, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":171
+    /* "structureboost/structure_gb.pyx":169
  *         self.prec_digits=prec_digits
  *         self.mode = mode
  *         if mode not in ['classification', 'regression']:             # <<<<<<<<<<<<<<
  *             warnings.warn('Mode not recognized')
  *         if loss_fn is None:
  */
   }
 
-  /* "structureboost/structure_gb.pyx":173
+  /* "structureboost/structure_gb.pyx":171
  *         if mode not in ['classification', 'regression']:
  *             warnings.warn('Mode not recognized')
  *         if loss_fn is None:             # <<<<<<<<<<<<<<
  *             if mode == 'classification':
  *                 loss_fn = 'entropy'
  */
   __pyx_t_1 = (__pyx_v_loss_fn == Py_None);
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_gb.pyx":174
+    /* "structureboost/structure_gb.pyx":172
  *             warnings.warn('Mode not recognized')
  *         if loss_fn is None:
  *             if mode == 'classification':             # <<<<<<<<<<<<<<
  *                 loss_fn = 'entropy'
  *             else:
  */
-    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_mode, __pyx_n_u_classification, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 174, __pyx_L1_error)
+    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_mode, __pyx_n_u_classification, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 172, __pyx_L1_error)
     if (__pyx_t_2) {
 
-      /* "structureboost/structure_gb.pyx":175
+      /* "structureboost/structure_gb.pyx":173
  *         if loss_fn is None:
  *             if mode == 'classification':
  *                 loss_fn = 'entropy'             # <<<<<<<<<<<<<<
  *             else:
  *                 loss_fn = 'mse'
  */
       __Pyx_INCREF(__pyx_n_u_entropy);
       __Pyx_DECREF_SET(__pyx_v_loss_fn, __pyx_n_u_entropy);
 
-      /* "structureboost/structure_gb.pyx":174
+      /* "structureboost/structure_gb.pyx":172
  *             warnings.warn('Mode not recognized')
  *         if loss_fn is None:
  *             if mode == 'classification':             # <<<<<<<<<<<<<<
  *                 loss_fn = 'entropy'
  *             else:
  */
       goto __pyx_L8;
     }
 
-    /* "structureboost/structure_gb.pyx":177
+    /* "structureboost/structure_gb.pyx":175
  *                 loss_fn = 'entropy'
  *             else:
  *                 loss_fn = 'mse'             # <<<<<<<<<<<<<<
  *         if type(loss_fn) == tuple:
  *             self.loss_fn_der_1 = loss_fn[0]
  */
     /*else*/ {
       __Pyx_INCREF(__pyx_n_u_mse);
       __Pyx_DECREF_SET(__pyx_v_loss_fn, __pyx_n_u_mse);
     }
     __pyx_L8:;
 
-    /* "structureboost/structure_gb.pyx":173
+    /* "structureboost/structure_gb.pyx":171
  *         if mode not in ['classification', 'regression']:
  *             warnings.warn('Mode not recognized')
  *         if loss_fn is None:             # <<<<<<<<<<<<<<
  *             if mode == 'classification':
  *                 loss_fn = 'entropy'
  */
   }
 
-  /* "structureboost/structure_gb.pyx":178
+  /* "structureboost/structure_gb.pyx":176
  *             else:
  *                 loss_fn = 'mse'
  *         if type(loss_fn) == tuple:             # <<<<<<<<<<<<<<
  *             self.loss_fn_der_1 = loss_fn[0]
  *             self.loss_fn_der_2 = loss_fn[1]
  */
-  __pyx_t_5 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_loss_fn)), ((PyObject *)(&PyTuple_Type)), Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 178, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 178, __pyx_L1_error)
+  __pyx_t_5 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_loss_fn)), ((PyObject *)(&PyTuple_Type)), Py_EQ); __Pyx_XGOTREF(__pyx_t_5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 176, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 176, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_gb.pyx":179
+    /* "structureboost/structure_gb.pyx":177
  *                 loss_fn = 'mse'
  *         if type(loss_fn) == tuple:
  *             self.loss_fn_der_1 = loss_fn[0]             # <<<<<<<<<<<<<<
  *             self.loss_fn_der_2 = loss_fn[1]
  *         elif (loss_fn == 'entropy'):
  */
-    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_loss_fn, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 179, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_loss_fn, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 177, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn_der_1, __pyx_t_5) < 0) __PYX_ERR(0, 179, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn_der_1, __pyx_t_5) < 0) __PYX_ERR(0, 177, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":180
+    /* "structureboost/structure_gb.pyx":178
  *         if type(loss_fn) == tuple:
  *             self.loss_fn_der_1 = loss_fn[0]
  *             self.loss_fn_der_2 = loss_fn[1]             # <<<<<<<<<<<<<<
  *         elif (loss_fn == 'entropy'):
  *             self.loss_fn_der_1 = c_entropy_link_der_1
  */
-    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_loss_fn, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 180, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_loss_fn, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 178, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn_der_2, __pyx_t_5) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn_der_2, __pyx_t_5) < 0) __PYX_ERR(0, 178, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":178
+    /* "structureboost/structure_gb.pyx":176
  *             else:
  *                 loss_fn = 'mse'
  *         if type(loss_fn) == tuple:             # <<<<<<<<<<<<<<
  *             self.loss_fn_der_1 = loss_fn[0]
  *             self.loss_fn_der_2 = loss_fn[1]
  */
     goto __pyx_L9;
   }
 
-  /* "structureboost/structure_gb.pyx":181
+  /* "structureboost/structure_gb.pyx":179
  *             self.loss_fn_der_1 = loss_fn[0]
  *             self.loss_fn_der_2 = loss_fn[1]
  *         elif (loss_fn == 'entropy'):             # <<<<<<<<<<<<<<
  *             self.loss_fn_der_1 = c_entropy_link_der_1
  *             self.loss_fn_der_2 = c_entropy_link_der_2
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_loss_fn, __pyx_n_u_entropy, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 181, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_loss_fn, __pyx_n_u_entropy, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 179, __pyx_L1_error)
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_gb.pyx":182
+    /* "structureboost/structure_gb.pyx":180
  *             self.loss_fn_der_2 = loss_fn[1]
  *         elif (loss_fn == 'entropy'):
  *             self.loss_fn_der_1 = c_entropy_link_der_1             # <<<<<<<<<<<<<<
  *             self.loss_fn_der_2 = c_entropy_link_der_2
  *         elif loss_fn == 'mse':
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_c_entropy_link_der_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 182, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_c_entropy_link_der_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 180, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn_der_1, __pyx_t_5) < 0) __PYX_ERR(0, 182, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn_der_1, __pyx_t_5) < 0) __PYX_ERR(0, 180, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":183
+    /* "structureboost/structure_gb.pyx":181
  *         elif (loss_fn == 'entropy'):
  *             self.loss_fn_der_1 = c_entropy_link_der_1
  *             self.loss_fn_der_2 = c_entropy_link_der_2             # <<<<<<<<<<<<<<
  *         elif loss_fn == 'mse':
  *             self.loss_fn_der_1 = _mse_der_1
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_c_entropy_link_der_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 183, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_c_entropy_link_der_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 181, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn_der_2, __pyx_t_5) < 0) __PYX_ERR(0, 183, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn_der_2, __pyx_t_5) < 0) __PYX_ERR(0, 181, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":181
+    /* "structureboost/structure_gb.pyx":179
  *             self.loss_fn_der_1 = loss_fn[0]
  *             self.loss_fn_der_2 = loss_fn[1]
  *         elif (loss_fn == 'entropy'):             # <<<<<<<<<<<<<<
  *             self.loss_fn_der_1 = c_entropy_link_der_1
  *             self.loss_fn_der_2 = c_entropy_link_der_2
  */
     goto __pyx_L9;
   }
 
-  /* "structureboost/structure_gb.pyx":184
+  /* "structureboost/structure_gb.pyx":182
  *             self.loss_fn_der_1 = c_entropy_link_der_1
  *             self.loss_fn_der_2 = c_entropy_link_der_2
  *         elif loss_fn == 'mse':             # <<<<<<<<<<<<<<
  *             self.loss_fn_der_1 = _mse_der_1
  *             self.loss_fn_der_2 = _mse_der_2
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_loss_fn, __pyx_n_u_mse, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 184, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_loss_fn, __pyx_n_u_mse, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 182, __pyx_L1_error)
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_gb.pyx":185
+    /* "structureboost/structure_gb.pyx":183
  *             self.loss_fn_der_2 = c_entropy_link_der_2
  *         elif loss_fn == 'mse':
  *             self.loss_fn_der_1 = _mse_der_1             # <<<<<<<<<<<<<<
  *             self.loss_fn_der_2 = _mse_der_2
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_mse_der_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 185, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_mse_der_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 183, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn_der_1, __pyx_t_5) < 0) __PYX_ERR(0, 185, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn_der_1, __pyx_t_5) < 0) __PYX_ERR(0, 183, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":186
+    /* "structureboost/structure_gb.pyx":184
  *         elif loss_fn == 'mse':
  *             self.loss_fn_der_1 = _mse_der_1
  *             self.loss_fn_der_2 = _mse_der_2             # <<<<<<<<<<<<<<
  * 
  *         if self.feature_configs is not None:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_mse_der_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 186, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_mse_der_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 184, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn_der_2, __pyx_t_5) < 0) __PYX_ERR(0, 186, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn_der_2, __pyx_t_5) < 0) __PYX_ERR(0, 184, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":184
+    /* "structureboost/structure_gb.pyx":182
  *             self.loss_fn_der_1 = c_entropy_link_der_1
  *             self.loss_fn_der_2 = c_entropy_link_der_2
  *         elif loss_fn == 'mse':             # <<<<<<<<<<<<<<
  *             self.loss_fn_der_1 = _mse_der_1
  *             self.loss_fn_der_2 = _mse_der_2
  */
   }
   __pyx_L9:;
 
-  /* "structureboost/structure_gb.pyx":188
+  /* "structureboost/structure_gb.pyx":186
  *             self.loss_fn_der_2 = _mse_der_2
  * 
  *         if self.feature_configs is not None:             # <<<<<<<<<<<<<<
  *             self._validate_feature_config()
  *         if default_configs is None:
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 188, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 186, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_2 = (__pyx_t_5 != Py_None);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_1 = (__pyx_t_2 != 0);
   if (__pyx_t_1) {
 
-    /* "structureboost/structure_gb.pyx":189
+    /* "structureboost/structure_gb.pyx":187
  * 
  *         if self.feature_configs is not None:
  *             self._validate_feature_config()             # <<<<<<<<<<<<<<
  *         if default_configs is None:
  *             self.default_configs = default_config_dict()
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_validate_feature_config); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 189, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_validate_feature_config); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 187, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_5 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 189, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 187, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":188
+    /* "structureboost/structure_gb.pyx":186
  *             self.loss_fn_der_2 = _mse_der_2
  * 
  *         if self.feature_configs is not None:             # <<<<<<<<<<<<<<
  *             self._validate_feature_config()
  *         if default_configs is None:
  */
   }
 
-  /* "structureboost/structure_gb.pyx":190
+  /* "structureboost/structure_gb.pyx":188
  *         if self.feature_configs is not None:
  *             self._validate_feature_config()
  *         if default_configs is None:             # <<<<<<<<<<<<<<
  *             self.default_configs = default_config_dict()
  * 
  */
   __pyx_t_1 = (__pyx_v_default_configs == Py_None);
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_gb.pyx":191
+    /* "structureboost/structure_gb.pyx":189
  *             self._validate_feature_config()
  *         if default_configs is None:
  *             self.default_configs = default_config_dict()             # <<<<<<<<<<<<<<
  * 
  *     def _validate_feature_config(self):
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_default_config_dict); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 191, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_default_config_dict); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 189, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_5 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 191, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 189, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_default_configs, __pyx_t_5) < 0) __PYX_ERR(0, 191, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_default_configs, __pyx_t_5) < 0) __PYX_ERR(0, 189, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":190
+    /* "structureboost/structure_gb.pyx":188
  *         if self.feature_configs is not None:
  *             self._validate_feature_config()
  *         if default_configs is None:             # <<<<<<<<<<<<<<
  *             self.default_configs = default_config_dict()
  * 
  */
   }
 
-  /* "structureboost/structure_gb.pyx":137
+  /* "structureboost/structure_gb.pyx":135
  *     Categorical Variables. https://arxiv.org/abs/2007.04446
  *     """
  *     def __init__(self, num_trees, feature_configs=None,             # <<<<<<<<<<<<<<
  *                  mode='classification',
  *                  loss_fn=None, subsample=1,
  */
 
@@ -5029,15 +5016,15 @@
   __Pyx_XDECREF(__pyx_v_loss_fn);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":193
+/* "structureboost/structure_gb.pyx":191
  *             self.default_configs = default_config_dict()
  * 
  *     def _validate_feature_config(self):             # <<<<<<<<<<<<<<
  *         valid_ftypes = ['numerical', 'categorical_int',
  *                         'categorical_str', 'graphical_voronoi']
  */
 
@@ -5075,24 +5062,24 @@
   PyObject *__pyx_t_10 = NULL;
   PyObject *__pyx_t_11 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__2)
   __Pyx_RefNannySetupContext("_validate_feature_config", 0);
-  __Pyx_TraceCall("_validate_feature_config", __pyx_f[0], 193, 0, __PYX_ERR(0, 193, __pyx_L1_error));
+  __Pyx_TraceCall("_validate_feature_config", __pyx_f[0], 191, 0, __PYX_ERR(0, 191, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":194
+  /* "structureboost/structure_gb.pyx":192
  * 
  *     def _validate_feature_config(self):
  *         valid_ftypes = ['numerical', 'categorical_int',             # <<<<<<<<<<<<<<
  *                         'categorical_str', 'graphical_voronoi']
  *         cat_smtypes = ['span_tree', 'contraction','onehot']
  */
-  __pyx_t_1 = PyList_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 194, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 192, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_n_u_numerical);
   __Pyx_GIVEREF(__pyx_n_u_numerical);
   PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_u_numerical);
   __Pyx_INCREF(__pyx_n_u_categorical_int);
   __Pyx_GIVEREF(__pyx_n_u_categorical_int);
   PyList_SET_ITEM(__pyx_t_1, 1, __pyx_n_u_categorical_int);
@@ -5101,500 +5088,500 @@
   PyList_SET_ITEM(__pyx_t_1, 2, __pyx_n_u_categorical_str);
   __Pyx_INCREF(__pyx_n_u_graphical_voronoi);
   __Pyx_GIVEREF(__pyx_n_u_graphical_voronoi);
   PyList_SET_ITEM(__pyx_t_1, 3, __pyx_n_u_graphical_voronoi);
   __pyx_v_valid_ftypes = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":196
+  /* "structureboost/structure_gb.pyx":194
  *         valid_ftypes = ['numerical', 'categorical_int',
  *                         'categorical_str', 'graphical_voronoi']
  *         cat_smtypes = ['span_tree', 'contraction','onehot']             # <<<<<<<<<<<<<<
  *         for fn in self.feature_configs.keys():
  *             if 'feature_type' not in self.feature_configs[fn]:
  */
-  __pyx_t_1 = PyList_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 196, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 194, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_n_u_span_tree);
   __Pyx_GIVEREF(__pyx_n_u_span_tree);
   PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_u_span_tree);
   __Pyx_INCREF(__pyx_n_u_contraction);
   __Pyx_GIVEREF(__pyx_n_u_contraction);
   PyList_SET_ITEM(__pyx_t_1, 1, __pyx_n_u_contraction);
   __Pyx_INCREF(__pyx_n_u_onehot);
   __Pyx_GIVEREF(__pyx_n_u_onehot);
   PyList_SET_ITEM(__pyx_t_1, 2, __pyx_n_u_onehot);
   __pyx_v_cat_smtypes = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":197
+  /* "structureboost/structure_gb.pyx":195
  *                         'categorical_str', 'graphical_voronoi']
  *         cat_smtypes = ['span_tree', 'contraction','onehot']
  *         for fn in self.feature_configs.keys():             # <<<<<<<<<<<<<<
  *             if 'feature_type' not in self.feature_configs[fn]:
  *                 w_str = '"feature_type" not configured in feature {}'.format(fn)
  */
   __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 197, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 195, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   if (unlikely(__pyx_t_5 == Py_None)) {
     PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-    __PYX_ERR(0, 197, __pyx_L1_error)
+    __PYX_ERR(0, 195, __pyx_L1_error)
   }
-  __pyx_t_6 = __Pyx_dict_iterator(__pyx_t_5, 0, __pyx_n_s_keys, (&__pyx_t_3), (&__pyx_t_4)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 197, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_dict_iterator(__pyx_t_5, 0, __pyx_n_s_keys, (&__pyx_t_3), (&__pyx_t_4)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 195, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_XDECREF(__pyx_t_1);
   __pyx_t_1 = __pyx_t_6;
   __pyx_t_6 = 0;
   while (1) {
     __pyx_t_7 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_3, &__pyx_t_2, &__pyx_t_6, NULL, NULL, __pyx_t_4);
     if (unlikely(__pyx_t_7 == 0)) break;
-    if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 197, __pyx_L1_error)
+    if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 195, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_XDECREF_SET(__pyx_v_fn, __pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "structureboost/structure_gb.pyx":198
+    /* "structureboost/structure_gb.pyx":196
  *         cat_smtypes = ['span_tree', 'contraction','onehot']
  *         for fn in self.feature_configs.keys():
  *             if 'feature_type' not in self.feature_configs[fn]:             # <<<<<<<<<<<<<<
  *                 w_str = '"feature_type" not configured in feature {}'.format(fn)
  *                 warnings.warn(w_str)
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 198, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 196, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_fn); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 198, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_fn); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 196, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_feature_type, __pyx_t_5, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 198, __pyx_L1_error)
+    __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_feature_type, __pyx_t_5, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 196, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_9 = (__pyx_t_8 != 0);
     if (__pyx_t_9) {
 
-      /* "structureboost/structure_gb.pyx":199
+      /* "structureboost/structure_gb.pyx":197
  *         for fn in self.feature_configs.keys():
  *             if 'feature_type' not in self.feature_configs[fn]:
  *                 w_str = '"feature_type" not configured in feature {}'.format(fn)             # <<<<<<<<<<<<<<
  *                 warnings.warn(w_str)
  *             elif self.feature_configs[fn]['feature_type'] not in valid_ftypes:
  */
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_feature_type_not_configured_in, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 199, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_feature_type_not_configured_in, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 197, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __pyx_t_10 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
         __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_6);
         if (likely(__pyx_t_10)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
           __Pyx_INCREF(__pyx_t_10);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_6, function);
         }
       }
       __pyx_t_5 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_10, __pyx_v_fn) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_fn);
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 199, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 197, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_XDECREF_SET(__pyx_v_w_str, __pyx_t_5);
       __pyx_t_5 = 0;
 
-      /* "structureboost/structure_gb.pyx":200
+      /* "structureboost/structure_gb.pyx":198
  *             if 'feature_type' not in self.feature_configs[fn]:
  *                 w_str = '"feature_type" not configured in feature {}'.format(fn)
  *                 warnings.warn(w_str)             # <<<<<<<<<<<<<<
  *             elif self.feature_configs[fn]['feature_type'] not in valid_ftypes:
  *                 w_str = 'Unknown feature_type in feature {}'.format(fn)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_warnings); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 200, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_warnings); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 198, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_warn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 200, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_warn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 198, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __pyx_t_6 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_6)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
           __Pyx_INCREF(__pyx_t_6);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_10, function);
         }
       }
       __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_6, __pyx_v_w_str) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_w_str);
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 200, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 198, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-      /* "structureboost/structure_gb.pyx":198
+      /* "structureboost/structure_gb.pyx":196
  *         cat_smtypes = ['span_tree', 'contraction','onehot']
  *         for fn in self.feature_configs.keys():
  *             if 'feature_type' not in self.feature_configs[fn]:             # <<<<<<<<<<<<<<
  *                 w_str = '"feature_type" not configured in feature {}'.format(fn)
  *                 warnings.warn(w_str)
  */
       goto __pyx_L5;
     }
 
-    /* "structureboost/structure_gb.pyx":201
+    /* "structureboost/structure_gb.pyx":199
  *                 w_str = '"feature_type" not configured in feature {}'.format(fn)
  *                 warnings.warn(w_str)
  *             elif self.feature_configs[fn]['feature_type'] not in valid_ftypes:             # <<<<<<<<<<<<<<
  *                 w_str = 'Unknown feature_type in feature {}'.format(fn)
  *                 warnings.warn(w_str)
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 201, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 199, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_fn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 201, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_fn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 199, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_t_10, __pyx_n_u_feature_type); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 201, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_t_10, __pyx_n_u_feature_type); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 199, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_9 = (__Pyx_PySequence_ContainsTF(__pyx_t_5, __pyx_v_valid_ftypes, Py_NE)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 201, __pyx_L1_error)
+    __pyx_t_9 = (__Pyx_PySequence_ContainsTF(__pyx_t_5, __pyx_v_valid_ftypes, Py_NE)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 199, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_8 = (__pyx_t_9 != 0);
     if (__pyx_t_8) {
 
-      /* "structureboost/structure_gb.pyx":202
+      /* "structureboost/structure_gb.pyx":200
  *                 warnings.warn(w_str)
  *             elif self.feature_configs[fn]['feature_type'] not in valid_ftypes:
  *                 w_str = 'Unknown feature_type in feature {}'.format(fn)             # <<<<<<<<<<<<<<
  *                 warnings.warn(w_str)
  *             elif self.feature_configs[fn]['feature_type']=='numerical':
  */
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_Unknown_feature_type_in_feature, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 202, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_Unknown_feature_type_in_feature, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 200, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __pyx_t_6 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
         __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_10);
         if (likely(__pyx_t_6)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
           __Pyx_INCREF(__pyx_t_6);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_10, function);
         }
       }
       __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_6, __pyx_v_fn) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_fn);
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 202, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 200, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_XDECREF_SET(__pyx_v_w_str, __pyx_t_5);
       __pyx_t_5 = 0;
 
-      /* "structureboost/structure_gb.pyx":203
+      /* "structureboost/structure_gb.pyx":201
  *             elif self.feature_configs[fn]['feature_type'] not in valid_ftypes:
  *                 w_str = 'Unknown feature_type in feature {}'.format(fn)
  *                 warnings.warn(w_str)             # <<<<<<<<<<<<<<
  *             elif self.feature_configs[fn]['feature_type']=='numerical':
  *                 if 'max_splits_to_search' not in self.feature_configs[fn]:
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_warnings); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 203, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_warnings); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 201, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_warn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 203, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_warn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 201, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __pyx_t_10 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
         __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_6);
         if (likely(__pyx_t_10)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
           __Pyx_INCREF(__pyx_t_10);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_6, function);
         }
       }
       __pyx_t_5 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_10, __pyx_v_w_str) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_w_str);
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 203, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 201, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-      /* "structureboost/structure_gb.pyx":201
+      /* "structureboost/structure_gb.pyx":199
  *                 w_str = '"feature_type" not configured in feature {}'.format(fn)
  *                 warnings.warn(w_str)
  *             elif self.feature_configs[fn]['feature_type'] not in valid_ftypes:             # <<<<<<<<<<<<<<
  *                 w_str = 'Unknown feature_type in feature {}'.format(fn)
  *                 warnings.warn(w_str)
  */
       goto __pyx_L5;
     }
 
-    /* "structureboost/structure_gb.pyx":204
+    /* "structureboost/structure_gb.pyx":202
  *                 w_str = 'Unknown feature_type in feature {}'.format(fn)
  *                 warnings.warn(w_str)
  *             elif self.feature_configs[fn]['feature_type']=='numerical':             # <<<<<<<<<<<<<<
  *                 if 'max_splits_to_search' not in self.feature_configs[fn]:
  *                     w_str = '"max_splits_to_search" not configured in feature {}'.format(fn)
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 204, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 202, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_fn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 204, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_fn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 202, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_t_6, __pyx_n_u_feature_type); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 204, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_t_6, __pyx_n_u_feature_type); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 202, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_8 = (__Pyx_PyUnicode_Equals(__pyx_t_5, __pyx_n_u_numerical, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 204, __pyx_L1_error)
+    __pyx_t_8 = (__Pyx_PyUnicode_Equals(__pyx_t_5, __pyx_n_u_numerical, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 202, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (__pyx_t_8) {
 
-      /* "structureboost/structure_gb.pyx":205
+      /* "structureboost/structure_gb.pyx":203
  *                 warnings.warn(w_str)
  *             elif self.feature_configs[fn]['feature_type']=='numerical':
  *                 if 'max_splits_to_search' not in self.feature_configs[fn]:             # <<<<<<<<<<<<<<
  *                     w_str = '"max_splits_to_search" not configured in feature {}'.format(fn)
  *                     warnings.warn(w_str)
  */
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 205, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 203, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_fn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 205, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_fn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 203, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_max_splits_to_search, __pyx_t_6, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 205, __pyx_L1_error)
+      __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_max_splits_to_search, __pyx_t_6, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 203, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __pyx_t_9 = (__pyx_t_8 != 0);
       if (__pyx_t_9) {
 
-        /* "structureboost/structure_gb.pyx":206
+        /* "structureboost/structure_gb.pyx":204
  *             elif self.feature_configs[fn]['feature_type']=='numerical':
  *                 if 'max_splits_to_search' not in self.feature_configs[fn]:
  *                     w_str = '"max_splits_to_search" not configured in feature {}'.format(fn)             # <<<<<<<<<<<<<<
  *                     warnings.warn(w_str)
  * 
  */
-        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_max_splits_to_search_not_config, __pyx_n_s_format); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 206, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_max_splits_to_search_not_config, __pyx_n_s_format); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 204, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __pyx_t_10 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
           __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_5);
           if (likely(__pyx_t_10)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
             __Pyx_INCREF(__pyx_t_10);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_5, function);
           }
         }
         __pyx_t_6 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_10, __pyx_v_fn) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_fn);
         __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 206, __pyx_L1_error)
+        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 204, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_XDECREF_SET(__pyx_v_w_str, __pyx_t_6);
         __pyx_t_6 = 0;
 
-        /* "structureboost/structure_gb.pyx":207
+        /* "structureboost/structure_gb.pyx":205
  *                 if 'max_splits_to_search' not in self.feature_configs[fn]:
  *                     w_str = '"max_splits_to_search" not configured in feature {}'.format(fn)
  *                     warnings.warn(w_str)             # <<<<<<<<<<<<<<
  * 
  *             elif self.feature_configs[fn]['feature_type'] in ['categorical_int',
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_warnings); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 207, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_warnings); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 205, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_warn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 207, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_warn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 205, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __pyx_t_5 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
           __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_10);
           if (likely(__pyx_t_5)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
             __Pyx_INCREF(__pyx_t_5);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_10, function);
           }
         }
         __pyx_t_6 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_5, __pyx_v_w_str) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_w_str);
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 207, __pyx_L1_error)
+        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 205, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-        /* "structureboost/structure_gb.pyx":205
+        /* "structureboost/structure_gb.pyx":203
  *                 warnings.warn(w_str)
  *             elif self.feature_configs[fn]['feature_type']=='numerical':
  *                 if 'max_splits_to_search' not in self.feature_configs[fn]:             # <<<<<<<<<<<<<<
  *                     w_str = '"max_splits_to_search" not configured in feature {}'.format(fn)
  *                     warnings.warn(w_str)
  */
       }
 
-      /* "structureboost/structure_gb.pyx":204
+      /* "structureboost/structure_gb.pyx":202
  *                 w_str = 'Unknown feature_type in feature {}'.format(fn)
  *                 warnings.warn(w_str)
  *             elif self.feature_configs[fn]['feature_type']=='numerical':             # <<<<<<<<<<<<<<
  *                 if 'max_splits_to_search' not in self.feature_configs[fn]:
  *                     w_str = '"max_splits_to_search" not configured in feature {}'.format(fn)
  */
       goto __pyx_L5;
     }
 
-    /* "structureboost/structure_gb.pyx":209
+    /* "structureboost/structure_gb.pyx":207
  *                     warnings.warn(w_str)
  * 
  *             elif self.feature_configs[fn]['feature_type'] in ['categorical_int',             # <<<<<<<<<<<<<<
  *                                                             'categorical_str']:
  *                 # Check for existence and connectivity of graphs
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 209, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 207, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_fn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 209, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_fn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 207, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_Dict_GetItem(__pyx_t_10, __pyx_n_u_feature_type); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 209, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Dict_GetItem(__pyx_t_10, __pyx_n_u_feature_type); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 207, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-    __pyx_t_8 = (__Pyx_PyUnicode_Equals(__pyx_t_6, __pyx_n_u_categorical_int, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 209, __pyx_L1_error)
+    __pyx_t_8 = (__Pyx_PyUnicode_Equals(__pyx_t_6, __pyx_n_u_categorical_int, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 207, __pyx_L1_error)
     if (!__pyx_t_8) {
     } else {
       __pyx_t_9 = __pyx_t_8;
       goto __pyx_L7_bool_binop_done;
     }
-    __pyx_t_8 = (__Pyx_PyUnicode_Equals(__pyx_t_6, __pyx_n_u_categorical_str, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 209, __pyx_L1_error)
+    __pyx_t_8 = (__Pyx_PyUnicode_Equals(__pyx_t_6, __pyx_n_u_categorical_str, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 207, __pyx_L1_error)
     __pyx_t_9 = __pyx_t_8;
     __pyx_L7_bool_binop_done:;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_8 = (__pyx_t_9 != 0);
     if (__pyx_t_8) {
 
-      /* "structureboost/structure_gb.pyx":212
+      /* "structureboost/structure_gb.pyx":210
  *                                                             'categorical_str']:
  *                 # Check for existence and connectivity of graphs
  *                 if ('graph' not in self.feature_configs[fn]):             # <<<<<<<<<<<<<<
  *                     if (self.feature_configs[fn]['split_method'] != 'onehot'):
  *                         w_str = 'graph not configured in feature {}'.format(fn)
  */
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 212, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 210, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_fn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 212, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_fn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 210, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_graph, __pyx_t_10, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 212, __pyx_L1_error)
+      __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_graph, __pyx_t_10, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 210, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __pyx_t_9 = (__pyx_t_8 != 0);
       if (__pyx_t_9) {
 
-        /* "structureboost/structure_gb.pyx":213
+        /* "structureboost/structure_gb.pyx":211
  *                 # Check for existence and connectivity of graphs
  *                 if ('graph' not in self.feature_configs[fn]):
  *                     if (self.feature_configs[fn]['split_method'] != 'onehot'):             # <<<<<<<<<<<<<<
  *                         w_str = 'graph not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)
  */
-        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 213, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 211, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
-        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_10, __pyx_v_fn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 213, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_10, __pyx_v_fn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 211, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-        __pyx_t_10 = __Pyx_PyObject_Dict_GetItem(__pyx_t_6, __pyx_n_u_split_method); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 213, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_Dict_GetItem(__pyx_t_6, __pyx_n_u_split_method); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 211, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_t_10, __pyx_n_u_onehot, Py_NE)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 213, __pyx_L1_error)
+        __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_t_10, __pyx_n_u_onehot, Py_NE)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 211, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         if (__pyx_t_9) {
 
-          /* "structureboost/structure_gb.pyx":214
+          /* "structureboost/structure_gb.pyx":212
  *                 if ('graph' not in self.feature_configs[fn]):
  *                     if (self.feature_configs[fn]['split_method'] != 'onehot'):
  *                         w_str = 'graph not configured in feature {}'.format(fn)             # <<<<<<<<<<<<<<
  *                         warnings.warn(w_str)
  *                 elif not graphs.is_connected(self.feature_configs[fn]['graph']):
  */
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_graph_not_configured_in_feature, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 214, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_graph_not_configured_in_feature, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 212, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __pyx_t_5 = NULL;
           if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
             __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
             if (likely(__pyx_t_5)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
               __Pyx_INCREF(__pyx_t_5);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_6, function);
             }
           }
           __pyx_t_10 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_v_fn) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_fn);
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 214, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 212, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_XDECREF_SET(__pyx_v_w_str, __pyx_t_10);
           __pyx_t_10 = 0;
 
-          /* "structureboost/structure_gb.pyx":215
+          /* "structureboost/structure_gb.pyx":213
  *                     if (self.feature_configs[fn]['split_method'] != 'onehot'):
  *                         w_str = 'graph not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)             # <<<<<<<<<<<<<<
  *                 elif not graphs.is_connected(self.feature_configs[fn]['graph']):
  *                     w_str = 'graph not connected in feature {}'.format(fn)
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_warnings); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 215, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_warnings); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 213, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_warn); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 215, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_warn); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 213, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_6 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
             __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
             if (likely(__pyx_t_6)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
               __Pyx_INCREF(__pyx_t_6);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_5, function);
             }
           }
           __pyx_t_10 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_v_w_str) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_w_str);
           __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 215, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 213, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-          /* "structureboost/structure_gb.pyx":213
+          /* "structureboost/structure_gb.pyx":211
  *                 # Check for existence and connectivity of graphs
  *                 if ('graph' not in self.feature_configs[fn]):
  *                     if (self.feature_configs[fn]['split_method'] != 'onehot'):             # <<<<<<<<<<<<<<
  *                         w_str = 'graph not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)
  */
         }
 
-        /* "structureboost/structure_gb.pyx":212
+        /* "structureboost/structure_gb.pyx":210
  *                                                             'categorical_str']:
  *                 # Check for existence and connectivity of graphs
  *                 if ('graph' not in self.feature_configs[fn]):             # <<<<<<<<<<<<<<
  *                     if (self.feature_configs[fn]['split_method'] != 'onehot'):
  *                         w_str = 'graph not configured in feature {}'.format(fn)
  */
         goto __pyx_L9;
       }
 
-      /* "structureboost/structure_gb.pyx":216
+      /* "structureboost/structure_gb.pyx":214
  *                         w_str = 'graph not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)
  *                 elif not graphs.is_connected(self.feature_configs[fn]['graph']):             # <<<<<<<<<<<<<<
  *                     w_str = 'graph not connected in feature {}'.format(fn)
  *                     warnings.warn(w_str)
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_graphs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 216, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_graphs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 214, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_is_connected); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 216, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_is_connected); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 214, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 216, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 214, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_fn); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 216, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_fn); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 214, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_t_11, __pyx_n_u_graph); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 216, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_t_11, __pyx_n_u_graph); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 214, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __pyx_t_11 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
         __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_6);
         if (likely(__pyx_t_11)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
@@ -5602,574 +5589,574 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_6, function);
         }
       }
       __pyx_t_10 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_11, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_5);
       __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 216, __pyx_L1_error)
+      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 214, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 216, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_IsTrue(__pyx_t_10); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 214, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __pyx_t_8 = ((!__pyx_t_9) != 0);
       if (__pyx_t_8) {
 
-        /* "structureboost/structure_gb.pyx":217
+        /* "structureboost/structure_gb.pyx":215
  *                         warnings.warn(w_str)
  *                 elif not graphs.is_connected(self.feature_configs[fn]['graph']):
  *                     w_str = 'graph not connected in feature {}'.format(fn)             # <<<<<<<<<<<<<<
  *                     warnings.warn(w_str)
  * 
  */
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_graph_not_connected_in_feature, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 217, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_graph_not_connected_in_feature, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 215, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_t_5 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
           __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
           if (likely(__pyx_t_5)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
             __Pyx_INCREF(__pyx_t_5);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_6, function);
           }
         }
         __pyx_t_10 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_v_fn) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_fn);
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-        if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 217, __pyx_L1_error)
+        if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 215, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_XDECREF_SET(__pyx_v_w_str, __pyx_t_10);
         __pyx_t_10 = 0;
 
-        /* "structureboost/structure_gb.pyx":218
+        /* "structureboost/structure_gb.pyx":216
  *                 elif not graphs.is_connected(self.feature_configs[fn]['graph']):
  *                     w_str = 'graph not connected in feature {}'.format(fn)
  *                     warnings.warn(w_str)             # <<<<<<<<<<<<<<
  * 
  *                 # Check for proper parameters existence
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_warnings); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 218, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_warnings); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 216, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_warn); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 218, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_warn); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 216, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_t_6 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
           __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
           if (likely(__pyx_t_6)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
             __Pyx_INCREF(__pyx_t_6);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_5, function);
           }
         }
         __pyx_t_10 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_v_w_str) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_w_str);
         __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-        if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 218, __pyx_L1_error)
+        if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 216, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-        /* "structureboost/structure_gb.pyx":216
+        /* "structureboost/structure_gb.pyx":214
  *                         w_str = 'graph not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)
  *                 elif not graphs.is_connected(self.feature_configs[fn]['graph']):             # <<<<<<<<<<<<<<
  *                     w_str = 'graph not connected in feature {}'.format(fn)
  *                     warnings.warn(w_str)
  */
       }
       __pyx_L9:;
 
-      /* "structureboost/structure_gb.pyx":221
+      /* "structureboost/structure_gb.pyx":219
  * 
  *                 # Check for proper parameters existence
  *                 if 'split_method' not in self.feature_configs[fn]:             # <<<<<<<<<<<<<<
  *                     w_str='"split_method" not specified in feature {}'.format(fn)
  *                     warnings.warn(w_str)
  */
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 221, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 219, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_10, __pyx_v_fn); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 221, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_10, __pyx_v_fn); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 219, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_split_method, __pyx_t_5, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 221, __pyx_L1_error)
+      __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_split_method, __pyx_t_5, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 219, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_9 = (__pyx_t_8 != 0);
       if (__pyx_t_9) {
 
-        /* "structureboost/structure_gb.pyx":222
+        /* "structureboost/structure_gb.pyx":220
  *                 # Check for proper parameters existence
  *                 if 'split_method' not in self.feature_configs[fn]:
  *                     w_str='"split_method" not specified in feature {}'.format(fn)             # <<<<<<<<<<<<<<
  *                     warnings.warn(w_str)
  *                 elif self.feature_configs[fn]['split_method'] not in cat_smtypes:
  */
-        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_split_method_not_specified_in_f, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 222, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_split_method_not_specified_in_f, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 220, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         __pyx_t_6 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
           __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_10);
           if (likely(__pyx_t_6)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
             __Pyx_INCREF(__pyx_t_6);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_10, function);
           }
         }
         __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_6, __pyx_v_fn) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_fn);
         __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 222, __pyx_L1_error)
+        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 220, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_XDECREF_SET(__pyx_v_w_str, __pyx_t_5);
         __pyx_t_5 = 0;
 
-        /* "structureboost/structure_gb.pyx":223
+        /* "structureboost/structure_gb.pyx":221
  *                 if 'split_method' not in self.feature_configs[fn]:
  *                     w_str='"split_method" not specified in feature {}'.format(fn)
  *                     warnings.warn(w_str)             # <<<<<<<<<<<<<<
  *                 elif self.feature_configs[fn]['split_method'] not in cat_smtypes:
  *                     w_str = 'Unknown split_method in feature {}'.format(fn)
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_warnings); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 223, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_warnings); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 221, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_warn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 223, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_warn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 221, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __pyx_t_10 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
           __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_6);
           if (likely(__pyx_t_10)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
             __Pyx_INCREF(__pyx_t_10);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_6, function);
           }
         }
         __pyx_t_5 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_10, __pyx_v_w_str) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_w_str);
         __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 223, __pyx_L1_error)
+        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 221, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "structureboost/structure_gb.pyx":221
+        /* "structureboost/structure_gb.pyx":219
  * 
  *                 # Check for proper parameters existence
  *                 if 'split_method' not in self.feature_configs[fn]:             # <<<<<<<<<<<<<<
  *                     w_str='"split_method" not specified in feature {}'.format(fn)
  *                     warnings.warn(w_str)
  */
         goto __pyx_L11;
       }
 
-      /* "structureboost/structure_gb.pyx":224
+      /* "structureboost/structure_gb.pyx":222
  *                     w_str='"split_method" not specified in feature {}'.format(fn)
  *                     warnings.warn(w_str)
  *                 elif self.feature_configs[fn]['split_method'] not in cat_smtypes:             # <<<<<<<<<<<<<<
  *                     w_str = 'Unknown split_method in feature {}'.format(fn)
  *                     warnings.warn(w_str)
  */
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 224, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 222, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_fn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 224, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_fn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 222, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_t_6, __pyx_n_u_split_method); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 224, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_t_6, __pyx_n_u_split_method); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 222, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_9 = (__Pyx_PySequence_ContainsTF(__pyx_t_5, __pyx_v_cat_smtypes, Py_NE)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 224, __pyx_L1_error)
+      __pyx_t_9 = (__Pyx_PySequence_ContainsTF(__pyx_t_5, __pyx_v_cat_smtypes, Py_NE)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 222, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_8 = (__pyx_t_9 != 0);
       if (__pyx_t_8) {
 
-        /* "structureboost/structure_gb.pyx":225
+        /* "structureboost/structure_gb.pyx":223
  *                     warnings.warn(w_str)
  *                 elif self.feature_configs[fn]['split_method'] not in cat_smtypes:
  *                     w_str = 'Unknown split_method in feature {}'.format(fn)             # <<<<<<<<<<<<<<
  *                     warnings.warn(w_str)
  *                 elif self.feature_configs[fn]['split_method'] == 'span_tree':
  */
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_Unknown_split_method_in_feature, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 225, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_Unknown_split_method_in_feature, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 223, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __pyx_t_10 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
           __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_6);
           if (likely(__pyx_t_10)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
             __Pyx_INCREF(__pyx_t_10);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_6, function);
           }
         }
         __pyx_t_5 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_10, __pyx_v_fn) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_fn);
         __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 225, __pyx_L1_error)
+        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 223, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_XDECREF_SET(__pyx_v_w_str, __pyx_t_5);
         __pyx_t_5 = 0;
 
-        /* "structureboost/structure_gb.pyx":226
+        /* "structureboost/structure_gb.pyx":224
  *                 elif self.feature_configs[fn]['split_method'] not in cat_smtypes:
  *                     w_str = 'Unknown split_method in feature {}'.format(fn)
  *                     warnings.warn(w_str)             # <<<<<<<<<<<<<<
  *                 elif self.feature_configs[fn]['split_method'] == 'span_tree':
  *                     if 'num_span_trees' not in self.feature_configs[fn]:
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_warnings); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 226, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_warnings); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 224, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_warn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 226, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_warn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 224, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_t_6 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
           __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_10);
           if (likely(__pyx_t_6)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
             __Pyx_INCREF(__pyx_t_6);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_10, function);
           }
         }
         __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_6, __pyx_v_w_str) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_w_str);
         __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 226, __pyx_L1_error)
+        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 224, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "structureboost/structure_gb.pyx":224
+        /* "structureboost/structure_gb.pyx":222
  *                     w_str='"split_method" not specified in feature {}'.format(fn)
  *                     warnings.warn(w_str)
  *                 elif self.feature_configs[fn]['split_method'] not in cat_smtypes:             # <<<<<<<<<<<<<<
  *                     w_str = 'Unknown split_method in feature {}'.format(fn)
  *                     warnings.warn(w_str)
  */
         goto __pyx_L11;
       }
 
-      /* "structureboost/structure_gb.pyx":227
+      /* "structureboost/structure_gb.pyx":225
  *                     w_str = 'Unknown split_method in feature {}'.format(fn)
  *                     warnings.warn(w_str)
  *                 elif self.feature_configs[fn]['split_method'] == 'span_tree':             # <<<<<<<<<<<<<<
  *                     if 'num_span_trees' not in self.feature_configs[fn]:
  *                         w_str = '"num_span_trees" not configured in feature {}'.format(fn)
  */
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 227, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 225, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_fn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 227, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_fn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 225, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_t_10, __pyx_n_u_split_method); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 227, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_t_10, __pyx_n_u_split_method); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 225, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_8 = (__Pyx_PyUnicode_Equals(__pyx_t_5, __pyx_n_u_span_tree, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 227, __pyx_L1_error)
+      __pyx_t_8 = (__Pyx_PyUnicode_Equals(__pyx_t_5, __pyx_n_u_span_tree, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 225, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (__pyx_t_8) {
 
-        /* "structureboost/structure_gb.pyx":228
+        /* "structureboost/structure_gb.pyx":226
  *                     warnings.warn(w_str)
  *                 elif self.feature_configs[fn]['split_method'] == 'span_tree':
  *                     if 'num_span_trees' not in self.feature_configs[fn]:             # <<<<<<<<<<<<<<
  *                         w_str = '"num_span_trees" not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)
  */
-        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 228, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 226, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_fn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 228, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_fn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 226, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_num_span_trees, __pyx_t_10, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 228, __pyx_L1_error)
+        __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_num_span_trees, __pyx_t_10, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 226, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __pyx_t_9 = (__pyx_t_8 != 0);
         if (__pyx_t_9) {
 
-          /* "structureboost/structure_gb.pyx":229
+          /* "structureboost/structure_gb.pyx":227
  *                 elif self.feature_configs[fn]['split_method'] == 'span_tree':
  *                     if 'num_span_trees' not in self.feature_configs[fn]:
  *                         w_str = '"num_span_trees" not configured in feature {}'.format(fn)             # <<<<<<<<<<<<<<
  *                         warnings.warn(w_str)
  *                 elif self.feature_configs[fn]['split_method'] == 'contraction':
  */
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_num_span_trees_not_configured_i, __pyx_n_s_format); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 229, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_num_span_trees_not_configured_i, __pyx_n_s_format); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 227, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           __pyx_t_6 = NULL;
           if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
             __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
             if (likely(__pyx_t_6)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
               __Pyx_INCREF(__pyx_t_6);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_5, function);
             }
           }
           __pyx_t_10 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_v_fn) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_fn);
           __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 229, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 227, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_XDECREF_SET(__pyx_v_w_str, __pyx_t_10);
           __pyx_t_10 = 0;
 
-          /* "structureboost/structure_gb.pyx":230
+          /* "structureboost/structure_gb.pyx":228
  *                     if 'num_span_trees' not in self.feature_configs[fn]:
  *                         w_str = '"num_span_trees" not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)             # <<<<<<<<<<<<<<
  *                 elif self.feature_configs[fn]['split_method'] == 'contraction':
  *                     if 'contraction_size' not in self.feature_configs[fn]:
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_warnings); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 230, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_warnings); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 228, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_warn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 230, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_warn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 228, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __pyx_t_5 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
             __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
             if (likely(__pyx_t_5)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
               __Pyx_INCREF(__pyx_t_5);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_6, function);
             }
           }
           __pyx_t_10 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_v_w_str) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_w_str);
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 230, __pyx_L1_error)
+          if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 228, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
-          /* "structureboost/structure_gb.pyx":228
+          /* "structureboost/structure_gb.pyx":226
  *                     warnings.warn(w_str)
  *                 elif self.feature_configs[fn]['split_method'] == 'span_tree':
  *                     if 'num_span_trees' not in self.feature_configs[fn]:             # <<<<<<<<<<<<<<
  *                         w_str = '"num_span_trees" not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)
  */
         }
 
-        /* "structureboost/structure_gb.pyx":227
+        /* "structureboost/structure_gb.pyx":225
  *                     w_str = 'Unknown split_method in feature {}'.format(fn)
  *                     warnings.warn(w_str)
  *                 elif self.feature_configs[fn]['split_method'] == 'span_tree':             # <<<<<<<<<<<<<<
  *                     if 'num_span_trees' not in self.feature_configs[fn]:
  *                         w_str = '"num_span_trees" not configured in feature {}'.format(fn)
  */
         goto __pyx_L11;
       }
 
-      /* "structureboost/structure_gb.pyx":231
+      /* "structureboost/structure_gb.pyx":229
  *                         w_str = '"num_span_trees" not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)
  *                 elif self.feature_configs[fn]['split_method'] == 'contraction':             # <<<<<<<<<<<<<<
  *                     if 'contraction_size' not in self.feature_configs[fn]:
  *                         w_str = '"contraction_size" not configured in feature {}'.format(fn)
  */
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 231, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 229, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_10, __pyx_v_fn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 231, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_10, __pyx_v_fn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 229, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_10 = __Pyx_PyObject_Dict_GetItem(__pyx_t_6, __pyx_n_u_split_method); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 231, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_Dict_GetItem(__pyx_t_6, __pyx_n_u_split_method); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 229, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_t_10, __pyx_n_u_contraction, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 231, __pyx_L1_error)
+      __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_t_10, __pyx_n_u_contraction, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 229, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       if (__pyx_t_9) {
 
-        /* "structureboost/structure_gb.pyx":232
+        /* "structureboost/structure_gb.pyx":230
  *                         warnings.warn(w_str)
  *                 elif self.feature_configs[fn]['split_method'] == 'contraction':
  *                     if 'contraction_size' not in self.feature_configs[fn]:             # <<<<<<<<<<<<<<
  *                         w_str = '"contraction_size" not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)
  */
-        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 232, __pyx_L1_error)
+        __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 230, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_10);
-        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_10, __pyx_v_fn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 232, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_10, __pyx_v_fn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 230, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-        __pyx_t_9 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_contraction_size, __pyx_t_6, Py_NE)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 232, __pyx_L1_error)
+        __pyx_t_9 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_contraction_size, __pyx_t_6, Py_NE)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 230, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __pyx_t_8 = (__pyx_t_9 != 0);
         if (__pyx_t_8) {
 
-          /* "structureboost/structure_gb.pyx":233
+          /* "structureboost/structure_gb.pyx":231
  *                 elif self.feature_configs[fn]['split_method'] == 'contraction':
  *                     if 'contraction_size' not in self.feature_configs[fn]:
  *                         w_str = '"contraction_size" not configured in feature {}'.format(fn)             # <<<<<<<<<<<<<<
  *                         warnings.warn(w_str)
  *                     if 'max_splits_to_search' not in self.feature_configs[fn]:
  */
-          __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_contraction_size_not_configured, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 233, __pyx_L1_error)
+          __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_contraction_size_not_configured, __pyx_n_s_format); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 231, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __pyx_t_5 = NULL;
           if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_10))) {
             __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_10);
             if (likely(__pyx_t_5)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
               __Pyx_INCREF(__pyx_t_5);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_10, function);
             }
           }
           __pyx_t_6 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_5, __pyx_v_fn) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_fn);
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 233, __pyx_L1_error)
+          if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 231, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
           __Pyx_XDECREF_SET(__pyx_v_w_str, __pyx_t_6);
           __pyx_t_6 = 0;
 
-          /* "structureboost/structure_gb.pyx":234
+          /* "structureboost/structure_gb.pyx":232
  *                     if 'contraction_size' not in self.feature_configs[fn]:
  *                         w_str = '"contraction_size" not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)             # <<<<<<<<<<<<<<
  *                     if 'max_splits_to_search' not in self.feature_configs[fn]:
  *                         w_str = '"max_splits_to_search" not configured in feature {}'.format(fn)
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_warnings); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 234, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_warnings); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 232, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
-          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_warn); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 234, __pyx_L1_error)
+          __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_warn); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 232, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
           __pyx_t_10 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
             __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_5);
             if (likely(__pyx_t_10)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
               __Pyx_INCREF(__pyx_t_10);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_5, function);
             }
           }
           __pyx_t_6 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_10, __pyx_v_w_str) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_w_str);
           __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-          if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 234, __pyx_L1_error)
+          if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 232, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-          /* "structureboost/structure_gb.pyx":232
+          /* "structureboost/structure_gb.pyx":230
  *                         warnings.warn(w_str)
  *                 elif self.feature_configs[fn]['split_method'] == 'contraction':
  *                     if 'contraction_size' not in self.feature_configs[fn]:             # <<<<<<<<<<<<<<
  *                         w_str = '"contraction_size" not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)
  */
         }
 
-        /* "structureboost/structure_gb.pyx":235
+        /* "structureboost/structure_gb.pyx":233
  *                         w_str = '"contraction_size" not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)
  *                     if 'max_splits_to_search' not in self.feature_configs[fn]:             # <<<<<<<<<<<<<<
  *                         w_str = '"max_splits_to_search" not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)
  */
-        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 235, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 233, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_fn); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 235, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_fn); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 233, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_max_splits_to_search, __pyx_t_5, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 235, __pyx_L1_error)
+        __pyx_t_8 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_max_splits_to_search, __pyx_t_5, Py_NE)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 233, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         __pyx_t_9 = (__pyx_t_8 != 0);
         if (__pyx_t_9) {
 
-          /* "structureboost/structure_gb.pyx":236
+          /* "structureboost/structure_gb.pyx":234
  *                         warnings.warn(w_str)
  *                     if 'max_splits_to_search' not in self.feature_configs[fn]:
  *                         w_str = '"max_splits_to_search" not configured in feature {}'.format(fn)             # <<<<<<<<<<<<<<
  *                         warnings.warn(w_str)
  * 
  */
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_max_splits_to_search_not_config, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 236, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_max_splits_to_search_not_config, __pyx_n_s_format); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 234, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __pyx_t_10 = NULL;
           if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
             __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_6);
             if (likely(__pyx_t_10)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
               __Pyx_INCREF(__pyx_t_10);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_6, function);
             }
           }
           __pyx_t_5 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_10, __pyx_v_fn) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_fn);
           __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 236, __pyx_L1_error)
+          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 234, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_XDECREF_SET(__pyx_v_w_str, __pyx_t_5);
           __pyx_t_5 = 0;
 
-          /* "structureboost/structure_gb.pyx":237
+          /* "structureboost/structure_gb.pyx":235
  *                     if 'max_splits_to_search' not in self.feature_configs[fn]:
  *                         w_str = '"max_splits_to_search" not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)             # <<<<<<<<<<<<<<
  * 
  *     def _process_y_data(self, y_data):
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_warnings); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 237, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_warnings); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 235, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_warn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 237, __pyx_L1_error)
+          __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_warn); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 235, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_10);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __pyx_t_6 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_10))) {
             __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_10);
             if (likely(__pyx_t_6)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
               __Pyx_INCREF(__pyx_t_6);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_10, function);
             }
           }
           __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_10, __pyx_t_6, __pyx_v_w_str) : __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_w_str);
           __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 237, __pyx_L1_error)
+          if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 235, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-          /* "structureboost/structure_gb.pyx":235
+          /* "structureboost/structure_gb.pyx":233
  *                         w_str = '"contraction_size" not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)
  *                     if 'max_splits_to_search' not in self.feature_configs[fn]:             # <<<<<<<<<<<<<<
  *                         w_str = '"max_splits_to_search" not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)
  */
         }
 
-        /* "structureboost/structure_gb.pyx":231
+        /* "structureboost/structure_gb.pyx":229
  *                         w_str = '"num_span_trees" not configured in feature {}'.format(fn)
  *                         warnings.warn(w_str)
  *                 elif self.feature_configs[fn]['split_method'] == 'contraction':             # <<<<<<<<<<<<<<
  *                     if 'contraction_size' not in self.feature_configs[fn]:
  *                         w_str = '"contraction_size" not configured in feature {}'.format(fn)
  */
       }
       __pyx_L11:;
 
-      /* "structureboost/structure_gb.pyx":209
+      /* "structureboost/structure_gb.pyx":207
  *                     warnings.warn(w_str)
  * 
  *             elif self.feature_configs[fn]['feature_type'] in ['categorical_int',             # <<<<<<<<<<<<<<
  *                                                             'categorical_str']:
  *                 # Check for existence and connectivity of graphs
  */
     }
     __pyx_L5:;
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":193
+  /* "structureboost/structure_gb.pyx":191
  *             self.default_configs = default_config_dict()
  * 
  *     def _validate_feature_config(self):             # <<<<<<<<<<<<<<
  *         valid_ftypes = ['numerical', 'categorical_int',
  *                         'categorical_str', 'graphical_voronoi']
  */
 
@@ -6191,15 +6178,15 @@
   __Pyx_XDECREF(__pyx_v_w_str);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":239
+/* "structureboost/structure_gb.pyx":237
  *                         warnings.warn(w_str)
  * 
  *     def _process_y_data(self, y_data):             # <<<<<<<<<<<<<<
  *         if type(y_data) == pd.Series:
  *             y_data = y_data.to_numpy().astype(float)
  */
 
@@ -6234,32 +6221,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_data)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_process_y_data", 1, 2, 2, 1); __PYX_ERR(0, 239, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_process_y_data", 1, 2, 2, 1); __PYX_ERR(0, 237, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_process_y_data") < 0)) __PYX_ERR(0, 239, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_process_y_data") < 0)) __PYX_ERR(0, 237, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_y_data = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_process_y_data", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 239, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_process_y_data", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 237, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost._process_y_data", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_4_process_y_data(__pyx_self, __pyx_v_self, __pyx_v_y_data);
 
@@ -6278,152 +6265,152 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__3)
   __Pyx_RefNannySetupContext("_process_y_data", 0);
-  __Pyx_TraceCall("_process_y_data", __pyx_f[0], 239, 0, __PYX_ERR(0, 239, __pyx_L1_error));
+  __Pyx_TraceCall("_process_y_data", __pyx_f[0], 237, 0, __PYX_ERR(0, 237, __pyx_L1_error));
   __Pyx_INCREF(__pyx_v_y_data);
 
-  /* "structureboost/structure_gb.pyx":240
+  /* "structureboost/structure_gb.pyx":238
  * 
  *     def _process_y_data(self, y_data):
  *         if type(y_data) == pd.Series:             # <<<<<<<<<<<<<<
  *             y_data = y_data.to_numpy().astype(float)
  *         elif type(y_data) == np.ndarray:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pd); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pd); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 238, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Series); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 240, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Series); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 238, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_y_data)), __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_y_data)), __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 238, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 240, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 238, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_3) {
 
-    /* "structureboost/structure_gb.pyx":241
+    /* "structureboost/structure_gb.pyx":239
  *     def _process_y_data(self, y_data):
  *         if type(y_data) == pd.Series:
  *             y_data = y_data.to_numpy().astype(float)             # <<<<<<<<<<<<<<
  *         elif type(y_data) == np.ndarray:
  *             y_data = y_data.astype(float)
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_y_data, __pyx_n_s_to_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 241, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_y_data, __pyx_n_s_to_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 239, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 241, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 239, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 241, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 239, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, ((PyObject *)(&PyFloat_Type))) : __Pyx_PyObject_CallOneArg(__pyx_t_4, ((PyObject *)(&PyFloat_Type)));
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 241, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 239, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF_SET(__pyx_v_y_data, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":240
+    /* "structureboost/structure_gb.pyx":238
  * 
  *     def _process_y_data(self, y_data):
  *         if type(y_data) == pd.Series:             # <<<<<<<<<<<<<<
  *             y_data = y_data.to_numpy().astype(float)
  *         elif type(y_data) == np.ndarray:
  */
     goto __pyx_L3;
   }
 
-  /* "structureboost/structure_gb.pyx":242
+  /* "structureboost/structure_gb.pyx":240
  *         if type(y_data) == pd.Series:
  *             y_data = y_data.to_numpy().astype(float)
  *         elif type(y_data) == np.ndarray:             # <<<<<<<<<<<<<<
  *             y_data = y_data.astype(float)
  *         return(y_data)
  */
-  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_y_data)), ((PyObject *)__pyx_ptype_5numpy_ndarray), Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 242, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_y_data)), ((PyObject *)__pyx_ptype_5numpy_ndarray), Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 240, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 240, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_3) {
 
-    /* "structureboost/structure_gb.pyx":243
+    /* "structureboost/structure_gb.pyx":241
  *             y_data = y_data.to_numpy().astype(float)
  *         elif type(y_data) == np.ndarray:
  *             y_data = y_data.astype(float)             # <<<<<<<<<<<<<<
  *         return(y_data)
  * 
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_y_data, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 243, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_y_data, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 241, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, ((PyObject *)(&PyFloat_Type))) : __Pyx_PyObject_CallOneArg(__pyx_t_4, ((PyObject *)(&PyFloat_Type)));
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 243, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 241, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF_SET(__pyx_v_y_data, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":242
+    /* "structureboost/structure_gb.pyx":240
  *         if type(y_data) == pd.Series:
  *             y_data = y_data.to_numpy().astype(float)
  *         elif type(y_data) == np.ndarray:             # <<<<<<<<<<<<<<
  *             y_data = y_data.astype(float)
  *         return(y_data)
  */
   }
   __pyx_L3:;
 
-  /* "structureboost/structure_gb.pyx":244
+  /* "structureboost/structure_gb.pyx":242
  *         elif type(y_data) == np.ndarray:
  *             y_data = y_data.astype(float)
  *         return(y_data)             # <<<<<<<<<<<<<<
  * 
  *     def _get_initial_pred(self, X_train, y_train):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_y_data);
   __pyx_r = __pyx_v_y_data;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":239
+  /* "structureboost/structure_gb.pyx":237
  *                         warnings.warn(w_str)
  * 
  *     def _process_y_data(self, y_data):             # <<<<<<<<<<<<<<
  *         if type(y_data) == pd.Series:
  *             y_data = y_data.to_numpy().astype(float)
  */
 
@@ -6439,15 +6426,15 @@
   __Pyx_XDECREF(__pyx_v_y_data);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":246
+/* "structureboost/structure_gb.pyx":244
  *         return(y_data)
  * 
  *     def _get_initial_pred(self, X_train, y_train):             # <<<<<<<<<<<<<<
  *         if self.initial_model is not None:
  *             if (self.mode == 'classification'):
  */
 
@@ -6485,40 +6472,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X_train)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_get_initial_pred", 1, 3, 3, 1); __PYX_ERR(0, 246, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_get_initial_pred", 1, 3, 3, 1); __PYX_ERR(0, 244, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_train)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_get_initial_pred", 1, 3, 3, 2); __PYX_ERR(0, 246, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_get_initial_pred", 1, 3, 3, 2); __PYX_ERR(0, 244, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_get_initial_pred") < 0)) __PYX_ERR(0, 246, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_get_initial_pred") < 0)) __PYX_ERR(0, 244, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_X_train = values[1];
     __pyx_v_y_train = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_get_initial_pred", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 246, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_get_initial_pred", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 244, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost._get_initial_pred", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_6_get_initial_pred(__pyx_self, __pyx_v_self, __pyx_v_X_train, __pyx_v_y_train);
 
@@ -6542,89 +6529,89 @@
   int __pyx_t_7;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__4)
   __Pyx_RefNannySetupContext("_get_initial_pred", 0);
-  __Pyx_TraceCall("_get_initial_pred", __pyx_f[0], 246, 0, __PYX_ERR(0, 246, __pyx_L1_error));
+  __Pyx_TraceCall("_get_initial_pred", __pyx_f[0], 244, 0, __PYX_ERR(0, 244, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":247
+  /* "structureboost/structure_gb.pyx":245
  * 
  *     def _get_initial_pred(self, X_train, y_train):
  *         if self.initial_model is not None:             # <<<<<<<<<<<<<<
  *             if (self.mode == 'classification'):
  *                 start_probs = self.initial_model.predict_proba(X_train)[:,1]
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 247, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 245, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = (__pyx_t_1 != Py_None);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_3 = (__pyx_t_2 != 0);
   if (__pyx_t_3) {
 
-    /* "structureboost/structure_gb.pyx":248
+    /* "structureboost/structure_gb.pyx":246
  *     def _get_initial_pred(self, X_train, y_train):
  *         if self.initial_model is not None:
  *             if (self.mode == 'classification'):             # <<<<<<<<<<<<<<
  *                 start_probs = self.initial_model.predict_proba(X_train)[:,1]
  *                 start_probs = np.clip(start_probs, 1e-15, 1-1e-15)
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_mode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_mode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 246, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_classification, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 248, __pyx_L1_error)
+    __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_classification, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 246, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (__pyx_t_3) {
 
-      /* "structureboost/structure_gb.pyx":249
+      /* "structureboost/structure_gb.pyx":247
  *         if self.initial_model is not None:
  *             if (self.mode == 'classification'):
  *                 start_probs = self.initial_model.predict_proba(X_train)[:,1]             # <<<<<<<<<<<<<<
  *                 start_probs = np.clip(start_probs, 1e-15, 1-1e-15)
  *                 return(np.log(start_probs / (1-start_probs)))
  */
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 249, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 247, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_predict_proba); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 249, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_predict_proba); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 247, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
         if (likely(__pyx_t_4)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
           __Pyx_INCREF(__pyx_t_4);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_5, function);
         }
       }
       __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_v_X_train) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_X_train);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 249, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 247, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_tuple__6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 249, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_tuple__6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 247, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_v_start_probs = __pyx_t_5;
       __pyx_t_5 = 0;
 
-      /* "structureboost/structure_gb.pyx":250
+      /* "structureboost/structure_gb.pyx":248
  *             if (self.mode == 'classification'):
  *                 start_probs = self.initial_model.predict_proba(X_train)[:,1]
  *                 start_probs = np.clip(start_probs, 1e-15, 1-1e-15)             # <<<<<<<<<<<<<<
  *                 return(np.log(start_probs / (1-start_probs)))
  *             else:
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 250, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_clip); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 250, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_clip); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 248, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyFloat_FromDouble((1.0 - 1e-15)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 250, __pyx_L1_error)
+      __pyx_t_1 = PyFloat_FromDouble((1.0 - 1e-15)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 248, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_t_6 = NULL;
       __pyx_t_7 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_6)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -6633,68 +6620,68 @@
           __Pyx_DECREF_SET(__pyx_t_4, function);
           __pyx_t_7 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_4)) {
         PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_v_start_probs, __pyx_float_1eneg_15, __pyx_t_1};
-        __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 250, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 248, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
         PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_v_start_probs, __pyx_float_1eneg_15, __pyx_t_1};
-        __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 250, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 248, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       } else
       #endif
       {
-        __pyx_t_8 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 250, __pyx_L1_error)
+        __pyx_t_8 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 248, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         if (__pyx_t_6) {
           __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
         }
         __Pyx_INCREF(__pyx_v_start_probs);
         __Pyx_GIVEREF(__pyx_v_start_probs);
         PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_v_start_probs);
         __Pyx_INCREF(__pyx_float_1eneg_15);
         __Pyx_GIVEREF(__pyx_float_1eneg_15);
         PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_float_1eneg_15);
         __Pyx_GIVEREF(__pyx_t_1);
         PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_7, __pyx_t_1);
         __pyx_t_1 = 0;
-        __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_8, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 250, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_8, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 248, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       }
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF_SET(__pyx_v_start_probs, __pyx_t_5);
       __pyx_t_5 = 0;
 
-      /* "structureboost/structure_gb.pyx":251
+      /* "structureboost/structure_gb.pyx":249
  *                 start_probs = self.initial_model.predict_proba(X_train)[:,1]
  *                 start_probs = np.clip(start_probs, 1e-15, 1-1e-15)
  *                 return(np.log(start_probs / (1-start_probs)))             # <<<<<<<<<<<<<<
  *             else:
  *                 return(self.initial_model.predict(X_train))
  */
       __Pyx_XDECREF(__pyx_r);
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 251, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 249, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_log); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 251, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_log); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 249, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_start_probs, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 251, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_start_probs, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 249, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_v_start_probs, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 251, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_v_start_probs, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 249, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_8);
         if (likely(__pyx_t_4)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
@@ -6702,149 +6689,149 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_8, function);
         }
       }
       __pyx_t_5 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_4, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_1);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 251, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 249, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __pyx_r = __pyx_t_5;
       __pyx_t_5 = 0;
       goto __pyx_L0;
 
-      /* "structureboost/structure_gb.pyx":248
+      /* "structureboost/structure_gb.pyx":246
  *     def _get_initial_pred(self, X_train, y_train):
  *         if self.initial_model is not None:
  *             if (self.mode == 'classification'):             # <<<<<<<<<<<<<<
  *                 start_probs = self.initial_model.predict_proba(X_train)[:,1]
  *                 start_probs = np.clip(start_probs, 1e-15, 1-1e-15)
  */
     }
 
-    /* "structureboost/structure_gb.pyx":253
+    /* "structureboost/structure_gb.pyx":251
  *                 return(np.log(start_probs / (1-start_probs)))
  *             else:
  *                 return(self.initial_model.predict(X_train))             # <<<<<<<<<<<<<<
  *         else:
  *             if (self.mode == 'classification'):
  */
     /*else*/ {
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 253, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 251, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_predict); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_predict); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 251, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __pyx_t_8 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_8)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
           __Pyx_INCREF(__pyx_t_8);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
       __pyx_t_5 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_8, __pyx_v_X_train) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_X_train);
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 253, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 251, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_r = __pyx_t_5;
       __pyx_t_5 = 0;
       goto __pyx_L0;
     }
 
-    /* "structureboost/structure_gb.pyx":247
+    /* "structureboost/structure_gb.pyx":245
  * 
  *     def _get_initial_pred(self, X_train, y_train):
  *         if self.initial_model is not None:             # <<<<<<<<<<<<<<
  *             if (self.mode == 'classification'):
  *                 start_probs = self.initial_model.predict_proba(X_train)[:,1]
  */
   }
 
-  /* "structureboost/structure_gb.pyx":255
+  /* "structureboost/structure_gb.pyx":253
  *                 return(self.initial_model.predict(X_train))
  *         else:
  *             if (self.mode == 'classification'):             # <<<<<<<<<<<<<<
  *                 prob_est = np.mean(y_train)
  *                 return((np.log(prob_est /
  */
   /*else*/ {
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_mode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 255, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_mode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 253, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_t_5, __pyx_n_u_classification, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 255, __pyx_L1_error)
+    __pyx_t_3 = (__Pyx_PyUnicode_Equals(__pyx_t_5, __pyx_n_u_classification, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 253, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     if (__pyx_t_3) {
 
-      /* "structureboost/structure_gb.pyx":256
+      /* "structureboost/structure_gb.pyx":254
  *         else:
  *             if (self.mode == 'classification'):
  *                 prob_est = np.mean(y_train)             # <<<<<<<<<<<<<<
  *                 return((np.log(prob_est /
  *                                     (1-prob_est)))*np.ones(X_train.shape[0]))
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 254, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_mean); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 256, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_mean); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 254, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_8);
         if (likely(__pyx_t_1)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
           __Pyx_INCREF(__pyx_t_1);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_8, function);
         }
       }
       __pyx_t_5 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_1, __pyx_v_y_train) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_v_y_train);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 256, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 254, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __pyx_v_prob_est = __pyx_t_5;
       __pyx_t_5 = 0;
 
-      /* "structureboost/structure_gb.pyx":257
+      /* "structureboost/structure_gb.pyx":255
  *             if (self.mode == 'classification'):
  *                 prob_est = np.mean(y_train)
  *                 return((np.log(prob_est /             # <<<<<<<<<<<<<<
  *                                     (1-prob_est)))*np.ones(X_train.shape[0]))
  *             else:
  */
       __Pyx_XDECREF(__pyx_r);
-      __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 257, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_np); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 255, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_log); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 257, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_log); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 255, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-      /* "structureboost/structure_gb.pyx":258
+      /* "structureboost/structure_gb.pyx":256
  *                 prob_est = np.mean(y_train)
  *                 return((np.log(prob_est /
  *                                     (1-prob_est)))*np.ones(X_train.shape[0]))             # <<<<<<<<<<<<<<
  *             else:
  *                 return(np.mean(y_train)*np.ones(X_train.shape[0]))
  */
-      __pyx_t_8 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_prob_est, 1, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 258, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_prob_est, 1, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 256, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
 
-      /* "structureboost/structure_gb.pyx":257
+      /* "structureboost/structure_gb.pyx":255
  *             if (self.mode == 'classification'):
  *                 prob_est = np.mean(y_train)
  *                 return((np.log(prob_est /             # <<<<<<<<<<<<<<
  *                                     (1-prob_est)))*np.ones(X_train.shape[0]))
  *             else:
  */
-      __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_v_prob_est, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 257, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_v_prob_est, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 255, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __pyx_t_8 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_8)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -6852,33 +6839,33 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
       __pyx_t_5 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_8, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_4);
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 257, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 255, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "structureboost/structure_gb.pyx":258
+      /* "structureboost/structure_gb.pyx":256
  *                 prob_est = np.mean(y_train)
  *                 return((np.log(prob_est /
  *                                     (1-prob_est)))*np.ones(X_train.shape[0]))             # <<<<<<<<<<<<<<
  *             else:
  *                 return(np.mean(y_train)*np.ones(X_train.shape[0]))
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 258, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 256, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_ones); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 258, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_ones); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 256, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_train, __pyx_n_s_shape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 258, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_train, __pyx_n_s_shape); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 256, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 258, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_GetItemInt(__pyx_t_4, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 256, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_8);
         if (likely(__pyx_t_4)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
@@ -6886,71 +6873,71 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_8, function);
         }
       }
       __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_4, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_6);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 258, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = PyNumber_Multiply(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 258, __pyx_L1_error)
+      __pyx_t_8 = PyNumber_Multiply(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 256, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_r = __pyx_t_8;
       __pyx_t_8 = 0;
       goto __pyx_L0;
 
-      /* "structureboost/structure_gb.pyx":255
+      /* "structureboost/structure_gb.pyx":253
  *                 return(self.initial_model.predict(X_train))
  *         else:
  *             if (self.mode == 'classification'):             # <<<<<<<<<<<<<<
  *                 prob_est = np.mean(y_train)
  *                 return((np.log(prob_est /
  */
     }
 
-    /* "structureboost/structure_gb.pyx":260
+    /* "structureboost/structure_gb.pyx":258
  *                                     (1-prob_est)))*np.ones(X_train.shape[0]))
  *             else:
  *                 return(np.mean(y_train)*np.ones(X_train.shape[0]))             # <<<<<<<<<<<<<<
  * 
  *     def _add_train_next_tree(self, features_for_tree, X_train, y_g_h_train, index):
  */
     /*else*/ {
       __Pyx_XDECREF(__pyx_r);
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 258, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_mean); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 260, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_mean); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 258, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
         if (likely(__pyx_t_1)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
           __Pyx_INCREF(__pyx_t_1);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_5, function);
         }
       }
       __pyx_t_8 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_1, __pyx_v_y_train) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_y_train);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 260, __pyx_L1_error)
+      if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 258, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 258, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_ones); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 260, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_ones); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 258, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_train, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 260, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_train, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 258, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 260, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 258, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
         if (likely(__pyx_t_1)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
@@ -6958,28 +6945,28 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_6, function);
         }
       }
       __pyx_t_5 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_1, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 260, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 258, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PyNumber_Multiply(__pyx_t_8, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 260, __pyx_L1_error)
+      __pyx_t_6 = PyNumber_Multiply(__pyx_t_8, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 258, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_r = __pyx_t_6;
       __pyx_t_6 = 0;
       goto __pyx_L0;
     }
   }
 
-  /* "structureboost/structure_gb.pyx":246
+  /* "structureboost/structure_gb.pyx":244
  *         return(y_data)
  * 
  *     def _get_initial_pred(self, X_train, y_train):             # <<<<<<<<<<<<<<
  *         if self.initial_model is not None:
  *             if (self.mode == 'classification'):
  */
 
@@ -6997,15 +6984,15 @@
   __Pyx_XDECREF(__pyx_v_prob_est);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":262
+/* "structureboost/structure_gb.pyx":260
  *                 return(np.mean(y_train)*np.ones(X_train.shape[0]))
  * 
  *     def _add_train_next_tree(self, features_for_tree, X_train, y_g_h_train, index):             # <<<<<<<<<<<<<<
  *         self.dec_tree_list.append(stdt.StructureDecisionTree(
  *                         feature_configs=self.feature_configs,
  */
 
@@ -7049,37 +7036,37 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_features_for_tree)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_add_train_next_tree", 1, 5, 5, 1); __PYX_ERR(0, 262, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_add_train_next_tree", 1, 5, 5, 1); __PYX_ERR(0, 260, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X_train)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_add_train_next_tree", 1, 5, 5, 2); __PYX_ERR(0, 262, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_add_train_next_tree", 1, 5, 5, 2); __PYX_ERR(0, 260, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_g_h_train)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_add_train_next_tree", 1, 5, 5, 3); __PYX_ERR(0, 262, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_add_train_next_tree", 1, 5, 5, 3); __PYX_ERR(0, 260, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_index)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_add_train_next_tree", 1, 5, 5, 4); __PYX_ERR(0, 262, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_add_train_next_tree", 1, 5, 5, 4); __PYX_ERR(0, 260, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_add_train_next_tree") < 0)) __PYX_ERR(0, 262, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_add_train_next_tree") < 0)) __PYX_ERR(0, 260, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -7090,15 +7077,15 @@
     __pyx_v_features_for_tree = values[1];
     __pyx_v_X_train = values[2];
     __pyx_v_y_g_h_train = values[3];
     __pyx_v_index = values[4];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_add_train_next_tree", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 262, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_add_train_next_tree", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 260, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost._add_train_next_tree", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_8_add_train_next_tree(__pyx_self, __pyx_v_self, __pyx_v_features_for_tree, __pyx_v_X_train, __pyx_v_y_g_h_train, __pyx_v_index);
 
@@ -7117,186 +7104,186 @@
   PyObject *__pyx_t_4 = NULL;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__7)
   __Pyx_RefNannySetupContext("_add_train_next_tree", 0);
-  __Pyx_TraceCall("_add_train_next_tree", __pyx_f[0], 262, 0, __PYX_ERR(0, 262, __pyx_L1_error));
+  __Pyx_TraceCall("_add_train_next_tree", __pyx_f[0], 260, 0, __PYX_ERR(0, 260, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":263
+  /* "structureboost/structure_gb.pyx":261
  * 
  *     def _add_train_next_tree(self, features_for_tree, X_train, y_g_h_train, index):
  *         self.dec_tree_list.append(stdt.StructureDecisionTree(             # <<<<<<<<<<<<<<
  *                         feature_configs=self.feature_configs,
  *                         feature_graphs=self.feature_graphs,
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 263, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 261, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_stdt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 263, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_stdt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 261, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_StructureDecisionTree); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 263, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_StructureDecisionTree); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 261, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "structureboost/structure_gb.pyx":264
+  /* "structureboost/structure_gb.pyx":262
  *     def _add_train_next_tree(self, features_for_tree, X_train, y_g_h_train, index):
  *         self.dec_tree_list.append(stdt.StructureDecisionTree(
  *                         feature_configs=self.feature_configs,             # <<<<<<<<<<<<<<
  *                         feature_graphs=self.feature_graphs,
  *                         min_size_split=self.min_size_split,
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 264, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 262, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 264, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 262, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_feature_configs, __pyx_t_4) < 0) __PYX_ERR(0, 264, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_feature_configs, __pyx_t_4) < 0) __PYX_ERR(0, 262, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "structureboost/structure_gb.pyx":265
+  /* "structureboost/structure_gb.pyx":263
  *         self.dec_tree_list.append(stdt.StructureDecisionTree(
  *                         feature_configs=self.feature_configs,
  *                         feature_graphs=self.feature_graphs,             # <<<<<<<<<<<<<<
  *                         min_size_split=self.min_size_split,
  *                         gamma=self.gamma, max_depth=self.max_depth,
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_graphs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 265, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_graphs); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 263, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_feature_graphs, __pyx_t_4) < 0) __PYX_ERR(0, 264, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_feature_graphs, __pyx_t_4) < 0) __PYX_ERR(0, 262, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "structureboost/structure_gb.pyx":266
+  /* "structureboost/structure_gb.pyx":264
  *                         feature_configs=self.feature_configs,
  *                         feature_graphs=self.feature_graphs,
  *                         min_size_split=self.min_size_split,             # <<<<<<<<<<<<<<
  *                         gamma=self.gamma, max_depth=self.max_depth,
  *                         reg_lambda=self.reg_lambda,
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_min_size_split); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 266, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_min_size_split); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 264, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_min_size_split, __pyx_t_4) < 0) __PYX_ERR(0, 264, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_min_size_split, __pyx_t_4) < 0) __PYX_ERR(0, 262, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "structureboost/structure_gb.pyx":267
+  /* "structureboost/structure_gb.pyx":265
  *                         feature_graphs=self.feature_graphs,
  *                         min_size_split=self.min_size_split,
  *                         gamma=self.gamma, max_depth=self.max_depth,             # <<<<<<<<<<<<<<
  *                         reg_lambda=self.reg_lambda,
  *                         feat_sample_by_node=self.feat_sample_by_node))
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_gamma); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 267, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_gamma); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 265, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_gamma, __pyx_t_4) < 0) __PYX_ERR(0, 264, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_gamma, __pyx_t_4) < 0) __PYX_ERR(0, 262, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_max_depth); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 267, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_max_depth); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 265, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_max_depth, __pyx_t_4) < 0) __PYX_ERR(0, 264, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_max_depth, __pyx_t_4) < 0) __PYX_ERR(0, 262, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "structureboost/structure_gb.pyx":268
+  /* "structureboost/structure_gb.pyx":266
  *                         min_size_split=self.min_size_split,
  *                         gamma=self.gamma, max_depth=self.max_depth,
  *                         reg_lambda=self.reg_lambda,             # <<<<<<<<<<<<<<
  *                         feat_sample_by_node=self.feat_sample_by_node))
  *         self.dec_tree_list[index].fit(X_train, y_g_h_train,
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_reg_lambda); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 268, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_reg_lambda); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 266, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_reg_lambda, __pyx_t_4) < 0) __PYX_ERR(0, 264, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_reg_lambda, __pyx_t_4) < 0) __PYX_ERR(0, 262, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "structureboost/structure_gb.pyx":269
+  /* "structureboost/structure_gb.pyx":267
  *                         gamma=self.gamma, max_depth=self.max_depth,
  *                         reg_lambda=self.reg_lambda,
  *                         feat_sample_by_node=self.feat_sample_by_node))             # <<<<<<<<<<<<<<
  *         self.dec_tree_list[index].fit(X_train, y_g_h_train,
  *                                   feature_sublist=features_for_tree,
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_sample_by_node); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 269, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_sample_by_node); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 267, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_feat_sample_by_node, __pyx_t_4) < 0) __PYX_ERR(0, 264, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_feat_sample_by_node, __pyx_t_4) < 0) __PYX_ERR(0, 262, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "structureboost/structure_gb.pyx":263
+  /* "structureboost/structure_gb.pyx":261
  * 
  *     def _add_train_next_tree(self, features_for_tree, X_train, y_g_h_train, index):
  *         self.dec_tree_list.append(stdt.StructureDecisionTree(             # <<<<<<<<<<<<<<
  *                         feature_configs=self.feature_configs,
  *                         feature_graphs=self.feature_graphs,
  */
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_empty_tuple, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 263, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_empty_tuple, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 261, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Append(__pyx_t_1, __pyx_t_4); if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 263, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Append(__pyx_t_1, __pyx_t_4); if (unlikely(__pyx_t_5 == ((int)-1))) __PYX_ERR(0, 261, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-  /* "structureboost/structure_gb.pyx":270
+  /* "structureboost/structure_gb.pyx":268
  *                         reg_lambda=self.reg_lambda,
  *                         feat_sample_by_node=self.feat_sample_by_node))
  *         self.dec_tree_list[index].fit(X_train, y_g_h_train,             # <<<<<<<<<<<<<<
  *                                   feature_sublist=features_for_tree,
  *                                   uv_dict=self.unique_vals_dict)
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 270, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 268, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_v_index); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 270, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_v_index); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_fit); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 270, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_fit); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 268, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 270, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_X_train);
   __Pyx_GIVEREF(__pyx_v_X_train);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_X_train);
   __Pyx_INCREF(__pyx_v_y_g_h_train);
   __Pyx_GIVEREF(__pyx_v_y_g_h_train);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_y_g_h_train);
 
-  /* "structureboost/structure_gb.pyx":271
+  /* "structureboost/structure_gb.pyx":269
  *                         feat_sample_by_node=self.feat_sample_by_node))
  *         self.dec_tree_list[index].fit(X_train, y_g_h_train,
  *                                   feature_sublist=features_for_tree,             # <<<<<<<<<<<<<<
  *                                   uv_dict=self.unique_vals_dict)
  * 
  */
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 271, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 269, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_feature_sublist, __pyx_v_features_for_tree) < 0) __PYX_ERR(0, 271, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_feature_sublist, __pyx_v_features_for_tree) < 0) __PYX_ERR(0, 269, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":272
+  /* "structureboost/structure_gb.pyx":270
  *         self.dec_tree_list[index].fit(X_train, y_g_h_train,
  *                                   feature_sublist=features_for_tree,
  *                                   uv_dict=self.unique_vals_dict)             # <<<<<<<<<<<<<<
  * 
  *     def process_curr_answer(self, curr_answer):
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_unique_vals_dict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 272, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_unique_vals_dict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 270, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_uv_dict, __pyx_t_3) < 0) __PYX_ERR(0, 271, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_uv_dict, __pyx_t_3) < 0) __PYX_ERR(0, 269, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":270
+  /* "structureboost/structure_gb.pyx":268
  *                         reg_lambda=self.reg_lambda,
  *                         feat_sample_by_node=self.feat_sample_by_node))
  *         self.dec_tree_list[index].fit(X_train, y_g_h_train,             # <<<<<<<<<<<<<<
  *                                   feature_sublist=features_for_tree,
  *                                   uv_dict=self.unique_vals_dict)
  */
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 270, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 268, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":262
+  /* "structureboost/structure_gb.pyx":260
  *                 return(np.mean(y_train)*np.ones(X_train.shape[0]))
  * 
  *     def _add_train_next_tree(self, features_for_tree, X_train, y_g_h_train, index):             # <<<<<<<<<<<<<<
  *         self.dec_tree_list.append(stdt.StructureDecisionTree(
  *                         feature_configs=self.feature_configs,
  */
 
@@ -7313,15 +7300,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":274
+/* "structureboost/structure_gb.pyx":272
  *                                   uv_dict=self.unique_vals_dict)
  * 
  *     def process_curr_answer(self, curr_answer):             # <<<<<<<<<<<<<<
  *         return curr_answer
  * 
  */
 
@@ -7356,32 +7343,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_curr_answer)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("process_curr_answer", 1, 2, 2, 1); __PYX_ERR(0, 274, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("process_curr_answer", 1, 2, 2, 1); __PYX_ERR(0, 272, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "process_curr_answer") < 0)) __PYX_ERR(0, 274, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "process_curr_answer") < 0)) __PYX_ERR(0, 272, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_curr_answer = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("process_curr_answer", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 274, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("process_curr_answer", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 272, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost.process_curr_answer", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_10process_curr_answer(__pyx_self, __pyx_v_self, __pyx_v_curr_answer);
 
@@ -7395,29 +7382,29 @@
   __Pyx_TraceDeclarations
   __Pyx_RefNannyDeclarations
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__8)
   __Pyx_RefNannySetupContext("process_curr_answer", 0);
-  __Pyx_TraceCall("process_curr_answer", __pyx_f[0], 274, 0, __PYX_ERR(0, 274, __pyx_L1_error));
+  __Pyx_TraceCall("process_curr_answer", __pyx_f[0], 272, 0, __PYX_ERR(0, 272, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":275
+  /* "structureboost/structure_gb.pyx":273
  * 
  *     def process_curr_answer(self, curr_answer):
  *         return curr_answer             # <<<<<<<<<<<<<<
  * 
  *     def compute_gh_mat(self, y_train, curr_answer, index):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_curr_answer);
   __pyx_r = __pyx_v_curr_answer;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":274
+  /* "structureboost/structure_gb.pyx":272
  *                                   uv_dict=self.unique_vals_dict)
  * 
  *     def process_curr_answer(self, curr_answer):             # <<<<<<<<<<<<<<
  *         return curr_answer
  * 
  */
 
@@ -7428,15 +7415,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":277
+/* "structureboost/structure_gb.pyx":275
  *         return curr_answer
  * 
  *     def compute_gh_mat(self, y_train, curr_answer, index):             # <<<<<<<<<<<<<<
  *         y_g_vec = self.loss_fn_der_1(y_train, curr_answer)
  *         y_h_vec = self.loss_fn_der_2(y_train, curr_answer)
  */
 
@@ -7477,31 +7464,31 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_train)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_gh_mat", 1, 4, 4, 1); __PYX_ERR(0, 277, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_gh_mat", 1, 4, 4, 1); __PYX_ERR(0, 275, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_curr_answer)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_gh_mat", 1, 4, 4, 2); __PYX_ERR(0, 277, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_gh_mat", 1, 4, 4, 2); __PYX_ERR(0, 275, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_index)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("compute_gh_mat", 1, 4, 4, 3); __PYX_ERR(0, 277, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("compute_gh_mat", 1, 4, 4, 3); __PYX_ERR(0, 275, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "compute_gh_mat") < 0)) __PYX_ERR(0, 277, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "compute_gh_mat") < 0)) __PYX_ERR(0, 275, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -7510,15 +7497,15 @@
     __pyx_v_self = values[0];
     __pyx_v_y_train = values[1];
     __pyx_v_curr_answer = values[2];
     __pyx_v_index = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("compute_gh_mat", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 277, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("compute_gh_mat", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 275, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost.compute_gh_mat", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_12compute_gh_mat(__pyx_self, __pyx_v_self, __pyx_v_y_train, __pyx_v_curr_answer, __pyx_v_index);
 
@@ -7540,24 +7527,24 @@
   int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__9)
   __Pyx_RefNannySetupContext("compute_gh_mat", 0);
-  __Pyx_TraceCall("compute_gh_mat", __pyx_f[0], 277, 0, __PYX_ERR(0, 277, __pyx_L1_error));
+  __Pyx_TraceCall("compute_gh_mat", __pyx_f[0], 275, 0, __PYX_ERR(0, 275, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":278
+  /* "structureboost/structure_gb.pyx":276
  * 
  *     def compute_gh_mat(self, y_train, curr_answer, index):
  *         y_g_vec = self.loss_fn_der_1(y_train, curr_answer)             # <<<<<<<<<<<<<<
  *         y_h_vec = self.loss_fn_der_2(y_train, curr_answer)
  *         y_g_h_mat = np.vstack((y_g_vec, y_h_vec)).T
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn_der_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 278, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn_der_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -7566,55 +7553,55 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_4 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_y_train, __pyx_v_curr_answer};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_y_train, __pyx_v_curr_answer};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_5 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 278, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 276, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     if (__pyx_t_3) {
       __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
     }
     __Pyx_INCREF(__pyx_v_y_train);
     __Pyx_GIVEREF(__pyx_v_y_train);
     PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_4, __pyx_v_y_train);
     __Pyx_INCREF(__pyx_v_curr_answer);
     __Pyx_GIVEREF(__pyx_v_curr_answer);
     PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_4, __pyx_v_curr_answer);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_y_g_vec = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":279
+  /* "structureboost/structure_gb.pyx":277
  *     def compute_gh_mat(self, y_train, curr_answer, index):
  *         y_g_vec = self.loss_fn_der_1(y_train, curr_answer)
  *         y_h_vec = self.loss_fn_der_2(y_train, curr_answer)             # <<<<<<<<<<<<<<
  *         y_g_h_mat = np.vstack((y_g_vec, y_h_vec)).T
  *         return y_g_h_mat
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn_der_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 279, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_loss_fn_der_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_5 = NULL;
   __pyx_t_4 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -7623,60 +7610,60 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_4 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_y_train, __pyx_v_curr_answer};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_y_train, __pyx_v_curr_answer};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_3 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 279, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 277, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     if (__pyx_t_5) {
       __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
     }
     __Pyx_INCREF(__pyx_v_y_train);
     __Pyx_GIVEREF(__pyx_v_y_train);
     PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_4, __pyx_v_y_train);
     __Pyx_INCREF(__pyx_v_curr_answer);
     __Pyx_GIVEREF(__pyx_v_curr_answer);
     PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_4, __pyx_v_curr_answer);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_y_h_vec = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":280
+  /* "structureboost/structure_gb.pyx":278
  *         y_g_vec = self.loss_fn_der_1(y_train, curr_answer)
  *         y_h_vec = self.loss_fn_der_2(y_train, curr_answer)
  *         y_g_h_mat = np.vstack((y_g_vec, y_h_vec)).T             # <<<<<<<<<<<<<<
  *         return y_g_h_mat
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 280, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 278, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_vstack); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 280, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_vstack); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 278, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 280, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 278, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_v_y_g_vec);
   __Pyx_GIVEREF(__pyx_v_y_g_vec);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_y_g_vec);
   __Pyx_INCREF(__pyx_v_y_h_vec);
   __Pyx_GIVEREF(__pyx_v_y_h_vec);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_v_y_h_vec);
@@ -7689,36 +7676,36 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 280, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_T); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 280, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_T); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 278, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_y_g_h_mat = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":281
+  /* "structureboost/structure_gb.pyx":279
  *         y_h_vec = self.loss_fn_der_2(y_train, curr_answer)
  *         y_g_h_mat = np.vstack((y_g_vec, y_h_vec)).T
  *         return y_g_h_mat             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_y_g_h_mat);
   __pyx_r = __pyx_v_y_g_h_mat;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":277
+  /* "structureboost/structure_gb.pyx":275
  *         return curr_answer
  * 
  *     def compute_gh_mat(self, y_train, curr_answer, index):             # <<<<<<<<<<<<<<
  *         y_g_vec = self.loss_fn_der_1(y_train, curr_answer)
  *         y_h_vec = self.loss_fn_der_2(y_train, curr_answer)
  */
 
@@ -7736,15 +7723,15 @@
   __Pyx_XDECREF(__pyx_v_y_g_h_mat);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":284
+/* "structureboost/structure_gb.pyx":282
  * 
  * 
  *     def _compute_loss(self, y_true, pred):             # <<<<<<<<<<<<<<
  *         if ((self.mode == 'classification')):
  *             return(my_log_loss(y_true, 1/(1+np.exp(-pred))))
  */
 
@@ -7782,40 +7769,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_true)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_compute_loss", 1, 3, 3, 1); __PYX_ERR(0, 284, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_compute_loss", 1, 3, 3, 1); __PYX_ERR(0, 282, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_pred)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_compute_loss", 1, 3, 3, 2); __PYX_ERR(0, 284, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_compute_loss", 1, 3, 3, 2); __PYX_ERR(0, 282, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_compute_loss") < 0)) __PYX_ERR(0, 284, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_compute_loss") < 0)) __PYX_ERR(0, 282, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_y_true = values[1];
     __pyx_v_pred = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_compute_loss", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 284, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_compute_loss", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 282, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost._compute_loss", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_14_compute_loss(__pyx_self, __pyx_v_self, __pyx_v_y_true, __pyx_v_pred);
 
@@ -7837,66 +7824,66 @@
   PyObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__10)
   __Pyx_RefNannySetupContext("_compute_loss", 0);
-  __Pyx_TraceCall("_compute_loss", __pyx_f[0], 284, 0, __PYX_ERR(0, 284, __pyx_L1_error));
+  __Pyx_TraceCall("_compute_loss", __pyx_f[0], 282, 0, __PYX_ERR(0, 282, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":285
+  /* "structureboost/structure_gb.pyx":283
  * 
  *     def _compute_loss(self, y_true, pred):
  *         if ((self.mode == 'classification')):             # <<<<<<<<<<<<<<
  *             return(my_log_loss(y_true, 1/(1+np.exp(-pred))))
  *         else:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_mode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 285, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_mode); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 283, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_classification, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 285, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_classification, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 283, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_gb.pyx":286
+    /* "structureboost/structure_gb.pyx":284
  *     def _compute_loss(self, y_true, pred):
  *         if ((self.mode == 'classification')):
  *             return(my_log_loss(y_true, 1/(1+np.exp(-pred))))             # <<<<<<<<<<<<<<
  *         else:
  *             return(my_mean_squared_error(y_true, pred))
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_my_log_loss); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_my_log_loss); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_exp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_exp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Negative(__pyx_v_pred); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Negative(__pyx_v_pred); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_7, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_5);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 286, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_t_4, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_t_4, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 286, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 284, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = NULL;
     __pyx_t_8 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_6)) {
@@ -7906,69 +7893,69 @@
         __Pyx_DECREF_SET(__pyx_t_3, function);
         __pyx_t_8 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_v_y_true, __pyx_t_4};
-      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 284, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_v_y_true, __pyx_t_4};
-      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 284, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     } else
     #endif
     {
-      __pyx_t_5 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 286, __pyx_L1_error)
+      __pyx_t_5 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 284, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       if (__pyx_t_6) {
         __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6); __pyx_t_6 = NULL;
       }
       __Pyx_INCREF(__pyx_v_y_true);
       __Pyx_GIVEREF(__pyx_v_y_true);
       PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_8, __pyx_v_y_true);
       __Pyx_GIVEREF(__pyx_t_4);
       PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_8, __pyx_t_4);
       __pyx_t_4 = 0;
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 284, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L0;
 
-    /* "structureboost/structure_gb.pyx":285
+    /* "structureboost/structure_gb.pyx":283
  * 
  *     def _compute_loss(self, y_true, pred):
  *         if ((self.mode == 'classification')):             # <<<<<<<<<<<<<<
  *             return(my_log_loss(y_true, 1/(1+np.exp(-pred))))
  *         else:
  */
   }
 
-  /* "structureboost/structure_gb.pyx":288
+  /* "structureboost/structure_gb.pyx":286
  *             return(my_log_loss(y_true, 1/(1+np.exp(-pred))))
  *         else:
  *             return(my_mean_squared_error(y_true, pred))             # <<<<<<<<<<<<<<
  * 
  *     def _update_curr_answer(self, curr_answer, X_train, index):
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_my_mean_squared_error); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 288, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_my_mean_squared_error); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 286, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_5 = NULL;
     __pyx_t_8 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -7977,50 +7964,50 @@
         __Pyx_DECREF_SET(__pyx_t_3, function);
         __pyx_t_8 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_y_true, __pyx_v_pred};
-      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_GOTREF(__pyx_t_1);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_y_true, __pyx_v_pred};
-      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 2+__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_GOTREF(__pyx_t_1);
     } else
     #endif
     {
-      __pyx_t_4 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __pyx_t_4 = PyTuple_New(2+__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 286, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       if (__pyx_t_5) {
         __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
       }
       __Pyx_INCREF(__pyx_v_y_true);
       __Pyx_GIVEREF(__pyx_v_y_true);
       PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_8, __pyx_v_y_true);
       __Pyx_INCREF(__pyx_v_pred);
       __Pyx_GIVEREF(__pyx_v_pred);
       PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_8, __pyx_v_pred);
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_r = __pyx_t_1;
     __pyx_t_1 = 0;
     goto __pyx_L0;
   }
 
-  /* "structureboost/structure_gb.pyx":284
+  /* "structureboost/structure_gb.pyx":282
  * 
  * 
  *     def _compute_loss(self, y_true, pred):             # <<<<<<<<<<<<<<
  *         if ((self.mode == 'classification')):
  *             return(my_log_loss(y_true, 1/(1+np.exp(-pred))))
  */
 
@@ -8037,15 +8024,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":290
+/* "structureboost/structure_gb.pyx":288
  *             return(my_mean_squared_error(y_true, pred))
  * 
  *     def _update_curr_answer(self, curr_answer, X_train, index):             # <<<<<<<<<<<<<<
  *         if (index>0):
  *             curr_answer = (curr_answer + self.learning_rate *
  */
 
@@ -8086,31 +8073,31 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_curr_answer)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_update_curr_answer", 1, 4, 4, 1); __PYX_ERR(0, 290, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_update_curr_answer", 1, 4, 4, 1); __PYX_ERR(0, 288, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X_train)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_update_curr_answer", 1, 4, 4, 2); __PYX_ERR(0, 290, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_update_curr_answer", 1, 4, 4, 2); __PYX_ERR(0, 288, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_index)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_update_curr_answer", 1, 4, 4, 3); __PYX_ERR(0, 290, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_update_curr_answer", 1, 4, 4, 3); __PYX_ERR(0, 288, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_update_curr_answer") < 0)) __PYX_ERR(0, 290, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_update_curr_answer") < 0)) __PYX_ERR(0, 288, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -8119,15 +8106,15 @@
     __pyx_v_self = values[0];
     __pyx_v_curr_answer = values[1];
     __pyx_v_X_train = values[2];
     __pyx_v_index = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_update_curr_answer", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 290, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_update_curr_answer", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 288, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost._update_curr_answer", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_16_update_curr_answer(__pyx_self, __pyx_v_self, __pyx_v_curr_answer, __pyx_v_X_train, __pyx_v_index);
 
@@ -8147,112 +8134,112 @@
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__11)
   __Pyx_RefNannySetupContext("_update_curr_answer", 0);
-  __Pyx_TraceCall("_update_curr_answer", __pyx_f[0], 290, 0, __PYX_ERR(0, 290, __pyx_L1_error));
+  __Pyx_TraceCall("_update_curr_answer", __pyx_f[0], 288, 0, __PYX_ERR(0, 288, __pyx_L1_error));
   __Pyx_INCREF(__pyx_v_curr_answer);
 
-  /* "structureboost/structure_gb.pyx":291
+  /* "structureboost/structure_gb.pyx":289
  * 
  *     def _update_curr_answer(self, curr_answer, X_train, index):
  *         if (index>0):             # <<<<<<<<<<<<<<
  *             curr_answer = (curr_answer + self.learning_rate *
  *                                     self.dec_tree_list[index-1].predict(X_train))
  */
-  __pyx_t_1 = PyObject_RichCompare(__pyx_v_index, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 291, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 291, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(__pyx_v_index, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 289, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_gb.pyx":292
+    /* "structureboost/structure_gb.pyx":290
  *     def _update_curr_answer(self, curr_answer, X_train, index):
  *         if (index>0):
  *             curr_answer = (curr_answer + self.learning_rate *             # <<<<<<<<<<<<<<
  *                                     self.dec_tree_list[index-1].predict(X_train))
  *         return(curr_answer)
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_learning_rate); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_learning_rate); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 290, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
 
-    /* "structureboost/structure_gb.pyx":293
+    /* "structureboost/structure_gb.pyx":291
  *         if (index>0):
  *             curr_answer = (curr_answer + self.learning_rate *
  *                                     self.dec_tree_list[index-1].predict(X_train))             # <<<<<<<<<<<<<<
  *         return(curr_answer)
  * 
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 293, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 291, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_v_index, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 293, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_v_index, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 291, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 293, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 291, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_predict); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 293, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_predict); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 291, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_v_X_train) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_X_train);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 293, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 291, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":292
+    /* "structureboost/structure_gb.pyx":290
  *     def _update_curr_answer(self, curr_answer, X_train, index):
  *         if (index>0):
  *             curr_answer = (curr_answer + self.learning_rate *             # <<<<<<<<<<<<<<
  *                                     self.dec_tree_list[index-1].predict(X_train))
  *         return(curr_answer)
  */
-    __pyx_t_5 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 292, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 290, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyNumber_Add(__pyx_v_curr_answer, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 292, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Add(__pyx_v_curr_answer, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 290, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF_SET(__pyx_v_curr_answer, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "structureboost/structure_gb.pyx":291
+    /* "structureboost/structure_gb.pyx":289
  * 
  *     def _update_curr_answer(self, curr_answer, X_train, index):
  *         if (index>0):             # <<<<<<<<<<<<<<
  *             curr_answer = (curr_answer + self.learning_rate *
  *                                     self.dec_tree_list[index-1].predict(X_train))
  */
   }
 
-  /* "structureboost/structure_gb.pyx":294
+  /* "structureboost/structure_gb.pyx":292
  *             curr_answer = (curr_answer + self.learning_rate *
  *                                     self.dec_tree_list[index-1].predict(X_train))
  *         return(curr_answer)             # <<<<<<<<<<<<<<
  * 
  *     def _get_rows_for_tree(self, num_rows):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_curr_answer);
   __pyx_r = __pyx_v_curr_answer;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":290
+  /* "structureboost/structure_gb.pyx":288
  *             return(my_mean_squared_error(y_true, pred))
  * 
  *     def _update_curr_answer(self, curr_answer, X_train, index):             # <<<<<<<<<<<<<<
  *         if (index>0):
  *             curr_answer = (curr_answer + self.learning_rate *
  */
 
@@ -8269,15 +8256,15 @@
   __Pyx_XDECREF(__pyx_v_curr_answer);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":296
+/* "structureboost/structure_gb.pyx":294
  *         return(curr_answer)
  * 
  *     def _get_rows_for_tree(self, num_rows):             # <<<<<<<<<<<<<<
  *         if (self.subsample == 1) and (not self.replace):
  *             return np.arange(num_rows)
  */
 
@@ -8312,32 +8299,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num_rows)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_get_rows_for_tree", 1, 2, 2, 1); __PYX_ERR(0, 296, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_get_rows_for_tree", 1, 2, 2, 1); __PYX_ERR(0, 294, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_get_rows_for_tree") < 0)) __PYX_ERR(0, 296, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_get_rows_for_tree") < 0)) __PYX_ERR(0, 294, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_num_rows = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_get_rows_for_tree", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 296, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_get_rows_for_tree", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 294, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost._get_rows_for_tree", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_18_get_rows_for_tree(__pyx_self, __pyx_v_self, __pyx_v_num_rows);
 
@@ -8360,100 +8347,100 @@
   PyObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__12)
   __Pyx_RefNannySetupContext("_get_rows_for_tree", 0);
-  __Pyx_TraceCall("_get_rows_for_tree", __pyx_f[0], 296, 0, __PYX_ERR(0, 296, __pyx_L1_error));
+  __Pyx_TraceCall("_get_rows_for_tree", __pyx_f[0], 294, 0, __PYX_ERR(0, 294, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":297
+  /* "structureboost/structure_gb.pyx":295
  * 
  *     def _get_rows_for_tree(self, num_rows):
  *         if (self.subsample == 1) and (not self.replace):             # <<<<<<<<<<<<<<
  *             return np.arange(num_rows)
  *         rows_to_return = int(np.ceil(num_rows*self.subsample))
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_subsample); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 297, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_subsample); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 295, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_t_2, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_t_2, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 295, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 297, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 295, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_4) {
   } else {
     __pyx_t_1 = __pyx_t_4;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_replace); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_replace); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 295, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 297, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 295, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_5 = ((!__pyx_t_4) != 0);
   __pyx_t_1 = __pyx_t_5;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "structureboost/structure_gb.pyx":298
+    /* "structureboost/structure_gb.pyx":296
  *     def _get_rows_for_tree(self, num_rows):
  *         if (self.subsample == 1) and (not self.replace):
  *             return np.arange(num_rows)             # <<<<<<<<<<<<<<
  *         rows_to_return = int(np.ceil(num_rows*self.subsample))
  *         if self.replace:
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 296, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_arange); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_arange); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 296, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_3 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_v_num_rows) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_num_rows);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 298, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 296, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
-    /* "structureboost/structure_gb.pyx":297
+    /* "structureboost/structure_gb.pyx":295
  * 
  *     def _get_rows_for_tree(self, num_rows):
  *         if (self.subsample == 1) and (not self.replace):             # <<<<<<<<<<<<<<
  *             return np.arange(num_rows)
  *         rows_to_return = int(np.ceil(num_rows*self.subsample))
  */
   }
 
-  /* "structureboost/structure_gb.pyx":299
+  /* "structureboost/structure_gb.pyx":297
  *         if (self.subsample == 1) and (not self.replace):
  *             return np.arange(num_rows)
  *         rows_to_return = int(np.ceil(num_rows*self.subsample))             # <<<<<<<<<<<<<<
  *         if self.replace:
  *             return np.random.randint(0, num_rows, rows_to_return)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 299, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ceil); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 299, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ceil); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_subsample); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 299, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_subsample); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_7 = PyNumber_Multiply(__pyx_v_num_rows, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 299, __pyx_L1_error)
+  __pyx_t_7 = PyNumber_Multiply(__pyx_v_num_rows, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -8461,50 +8448,50 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_6, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_7);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 299, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 299, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 297, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_rows_to_return = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "structureboost/structure_gb.pyx":300
+  /* "structureboost/structure_gb.pyx":298
  *             return np.arange(num_rows)
  *         rows_to_return = int(np.ceil(num_rows*self.subsample))
  *         if self.replace:             # <<<<<<<<<<<<<<
  *             return np.random.randint(0, num_rows, rows_to_return)
  *         else:
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_replace); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 300, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_replace); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 298, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 300, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 298, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (__pyx_t_1) {
 
-    /* "structureboost/structure_gb.pyx":301
+    /* "structureboost/structure_gb.pyx":299
  *         rows_to_return = int(np.ceil(num_rows*self.subsample))
  *         if self.replace:
  *             return np.random.randint(0, num_rows, rows_to_return)             # <<<<<<<<<<<<<<
  *         else:
  *             return np.random.choice(num_rows, rows_to_return, replace=False)
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 301, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_random); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 301, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_random); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_randint); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 301, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_randint); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 299, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_t_7 = NULL;
     __pyx_t_8 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_7)) {
@@ -8514,99 +8501,99 @@
         __Pyx_DECREF_SET(__pyx_t_3, function);
         __pyx_t_8 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_int_0, __pyx_v_num_rows, __pyx_v_rows_to_return};
-      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 301, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 299, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_GOTREF(__pyx_t_2);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_int_0, __pyx_v_num_rows, __pyx_v_rows_to_return};
-      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 301, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_8, 3+__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 299, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_GOTREF(__pyx_t_2);
     } else
     #endif
     {
-      __pyx_t_6 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 301, __pyx_L1_error)
+      __pyx_t_6 = PyTuple_New(3+__pyx_t_8); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 299, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       if (__pyx_t_7) {
         __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_7); __pyx_t_7 = NULL;
       }
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_8, __pyx_int_0);
       __Pyx_INCREF(__pyx_v_num_rows);
       __Pyx_GIVEREF(__pyx_v_num_rows);
       PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_8, __pyx_v_num_rows);
       __Pyx_INCREF(__pyx_v_rows_to_return);
       __Pyx_GIVEREF(__pyx_v_rows_to_return);
       PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_8, __pyx_v_rows_to_return);
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 301, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 299, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     goto __pyx_L0;
 
-    /* "structureboost/structure_gb.pyx":300
+    /* "structureboost/structure_gb.pyx":298
  *             return np.arange(num_rows)
  *         rows_to_return = int(np.ceil(num_rows*self.subsample))
  *         if self.replace:             # <<<<<<<<<<<<<<
  *             return np.random.randint(0, num_rows, rows_to_return)
  *         else:
  */
   }
 
-  /* "structureboost/structure_gb.pyx":303
+  /* "structureboost/structure_gb.pyx":301
  *             return np.random.randint(0, num_rows, rows_to_return)
  *         else:
  *             return np.random.choice(num_rows, rows_to_return, replace=False)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 301, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 301, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_choice); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_choice); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 301, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 301, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_v_num_rows);
     __Pyx_GIVEREF(__pyx_v_num_rows);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_num_rows);
     __Pyx_INCREF(__pyx_v_rows_to_return);
     __Pyx_GIVEREF(__pyx_v_rows_to_return);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_rows_to_return);
-    __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 301, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_replace, Py_False) < 0) __PYX_ERR(0, 303, __pyx_L1_error)
-    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 303, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_replace, Py_False) < 0) __PYX_ERR(0, 301, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 301, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_r = __pyx_t_7;
     __pyx_t_7 = 0;
     goto __pyx_L0;
   }
 
-  /* "structureboost/structure_gb.pyx":296
+  /* "structureboost/structure_gb.pyx":294
  *         return(curr_answer)
  * 
  *     def _get_rows_for_tree(self, num_rows):             # <<<<<<<<<<<<<<
  *         if (self.subsample == 1) and (not self.replace):
  *             return np.arange(num_rows)
  */
 
@@ -8622,15 +8609,15 @@
   __Pyx_XDECREF(__pyx_v_rows_to_return);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":306
+/* "structureboost/structure_gb.pyx":304
  * 
  * 
  *     def _get_features_for_tree(self):             # <<<<<<<<<<<<<<
  *         if self.feat_sample_by_tree < 1:
  *             feat_set_size = (self.feat_sample_by_tree *
  */
 
@@ -8662,79 +8649,79 @@
   int __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__13)
   __Pyx_RefNannySetupContext("_get_features_for_tree", 0);
-  __Pyx_TraceCall("_get_features_for_tree", __pyx_f[0], 306, 0, __PYX_ERR(0, 306, __pyx_L1_error));
+  __Pyx_TraceCall("_get_features_for_tree", __pyx_f[0], 304, 0, __PYX_ERR(0, 304, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":307
+  /* "structureboost/structure_gb.pyx":305
  * 
  *     def _get_features_for_tree(self):
  *         if self.feat_sample_by_tree < 1:             # <<<<<<<<<<<<<<
  *             feat_set_size = (self.feat_sample_by_tree *
  *                              len(self.feat_list_full))
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_sample_by_tree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 307, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_sample_by_tree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 305, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_int_1, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 307, __pyx_L1_error)
+  __pyx_t_2 = PyObject_RichCompare(__pyx_t_1, __pyx_int_1, Py_LT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 305, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 307, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 305, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (__pyx_t_3) {
 
-    /* "structureboost/structure_gb.pyx":308
+    /* "structureboost/structure_gb.pyx":306
  *     def _get_features_for_tree(self):
  *         if self.feat_sample_by_tree < 1:
  *             feat_set_size = (self.feat_sample_by_tree *             # <<<<<<<<<<<<<<
  *                              len(self.feat_list_full))
  *             feat_set_size = int(np.maximum(feat_set_size, 1))
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_sample_by_tree); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 308, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_sample_by_tree); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 306, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
 
-    /* "structureboost/structure_gb.pyx":309
+    /* "structureboost/structure_gb.pyx":307
  *         if self.feat_sample_by_tree < 1:
  *             feat_set_size = (self.feat_sample_by_tree *
  *                              len(self.feat_list_full))             # <<<<<<<<<<<<<<
  *             feat_set_size = int(np.maximum(feat_set_size, 1))
  *             np.random.shuffle(self.feat_list_full)
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_list_full); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 309, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_list_full); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 307, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 309, __pyx_L1_error)
+    __pyx_t_4 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 307, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 309, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 307, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
 
-    /* "structureboost/structure_gb.pyx":308
+    /* "structureboost/structure_gb.pyx":306
  *     def _get_features_for_tree(self):
  *         if self.feat_sample_by_tree < 1:
  *             feat_set_size = (self.feat_sample_by_tree *             # <<<<<<<<<<<<<<
  *                              len(self.feat_list_full))
  *             feat_set_size = int(np.maximum(feat_set_size, 1))
  */
-    __pyx_t_5 = PyNumber_Multiply(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 308, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Multiply(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 306, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_v_feat_set_size = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":310
+    /* "structureboost/structure_gb.pyx":308
  *             feat_set_size = (self.feat_sample_by_tree *
  *                              len(self.feat_list_full))
  *             feat_set_size = int(np.maximum(feat_set_size, 1))             # <<<<<<<<<<<<<<
  *             np.random.shuffle(self.feat_list_full)
  *             features_for_tree = self.feat_list_full[:feat_set_size]
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 310, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 308, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_maximum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 310, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_maximum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 308, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_1 = NULL;
     __pyx_t_6 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_1)) {
@@ -8744,216 +8731,216 @@
         __Pyx_DECREF_SET(__pyx_t_2, function);
         __pyx_t_6 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_feat_set_size, __pyx_int_1};
-      __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 310, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 308, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_GOTREF(__pyx_t_5);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_feat_set_size, __pyx_int_1};
-      __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 310, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 308, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_GOTREF(__pyx_t_5);
     } else
     #endif
     {
-      __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 310, __pyx_L1_error)
+      __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 308, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (__pyx_t_1) {
         __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_1); __pyx_t_1 = NULL;
       }
       __Pyx_INCREF(__pyx_v_feat_set_size);
       __Pyx_GIVEREF(__pyx_v_feat_set_size);
       PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_feat_set_size);
       __Pyx_INCREF(__pyx_int_1);
       __Pyx_GIVEREF(__pyx_int_1);
       PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_int_1);
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 310, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 308, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 310, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 308, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF_SET(__pyx_v_feat_set_size, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "structureboost/structure_gb.pyx":311
+    /* "structureboost/structure_gb.pyx":309
  *                              len(self.feat_list_full))
  *             feat_set_size = int(np.maximum(feat_set_size, 1))
  *             np.random.shuffle(self.feat_list_full)             # <<<<<<<<<<<<<<
  *             features_for_tree = self.feat_list_full[:feat_set_size]
  *         elif self.feat_sample_by_tree > 1:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 311, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_random); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 311, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_random); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_shuffle); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 311, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_shuffle); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_list_full); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 311, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_list_full); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_1, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_7);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 311, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 309, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "structureboost/structure_gb.pyx":312
+    /* "structureboost/structure_gb.pyx":310
  *             feat_set_size = int(np.maximum(feat_set_size, 1))
  *             np.random.shuffle(self.feat_list_full)
  *             features_for_tree = self.feat_list_full[:feat_set_size]             # <<<<<<<<<<<<<<
  *         elif self.feat_sample_by_tree > 1:
  *             feat_set_size = int(self.feat_sample_by_tree)
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_list_full); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 312, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_list_full); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 310, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_t_2, 0, 0, NULL, &__pyx_v_feat_set_size, NULL, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetSlice(__pyx_t_2, 0, 0, NULL, &__pyx_v_feat_set_size, NULL, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 310, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_features_for_tree = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":307
+    /* "structureboost/structure_gb.pyx":305
  * 
  *     def _get_features_for_tree(self):
  *         if self.feat_sample_by_tree < 1:             # <<<<<<<<<<<<<<
  *             feat_set_size = (self.feat_sample_by_tree *
  *                              len(self.feat_list_full))
  */
     goto __pyx_L3;
   }
 
-  /* "structureboost/structure_gb.pyx":313
+  /* "structureboost/structure_gb.pyx":311
  *             np.random.shuffle(self.feat_list_full)
  *             features_for_tree = self.feat_list_full[:feat_set_size]
  *         elif self.feat_sample_by_tree > 1:             # <<<<<<<<<<<<<<
  *             feat_set_size = int(self.feat_sample_by_tree)
  *             np.random.shuffle(self.feat_list_full)
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_sample_by_tree); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 313, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_sample_by_tree); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 311, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_2 = PyObject_RichCompare(__pyx_t_5, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 313, __pyx_L1_error)
+  __pyx_t_2 = PyObject_RichCompare(__pyx_t_5, __pyx_int_1, Py_GT); __Pyx_XGOTREF(__pyx_t_2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 311, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 313, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 311, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (__pyx_t_3) {
 
-    /* "structureboost/structure_gb.pyx":314
+    /* "structureboost/structure_gb.pyx":312
  *             features_for_tree = self.feat_list_full[:feat_set_size]
  *         elif self.feat_sample_by_tree > 1:
  *             feat_set_size = int(self.feat_sample_by_tree)             # <<<<<<<<<<<<<<
  *             np.random.shuffle(self.feat_list_full)
  *             features_for_tree = self.feat_list_full[:feat_set_size]
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_sample_by_tree); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_sample_by_tree); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 312, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = __Pyx_PyNumber_Int(__pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 314, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyNumber_Int(__pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_feat_set_size = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":315
+    /* "structureboost/structure_gb.pyx":313
  *         elif self.feat_sample_by_tree > 1:
  *             feat_set_size = int(self.feat_sample_by_tree)
  *             np.random.shuffle(self.feat_list_full)             # <<<<<<<<<<<<<<
  *             features_for_tree = self.feat_list_full[:feat_set_size]
  *         else:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 315, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 313, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 315, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 313, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_shuffle); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 315, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_shuffle); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 313, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_list_full); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 315, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_list_full); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 313, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_5 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_1, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_7);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 315, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 313, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":316
+    /* "structureboost/structure_gb.pyx":314
  *             feat_set_size = int(self.feat_sample_by_tree)
  *             np.random.shuffle(self.feat_list_full)
  *             features_for_tree = self.feat_list_full[:feat_set_size]             # <<<<<<<<<<<<<<
  *         else:
  *             features_for_tree = self.feat_list_full
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_list_full); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_list_full); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 314, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_t_5, 0, 0, NULL, &__pyx_v_feat_set_size, NULL, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 316, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_t_5, 0, 0, NULL, &__pyx_v_feat_set_size, NULL, 0, 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 314, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_v_features_for_tree = __pyx_t_2;
     __pyx_t_2 = 0;
 
-    /* "structureboost/structure_gb.pyx":313
+    /* "structureboost/structure_gb.pyx":311
  *             np.random.shuffle(self.feat_list_full)
  *             features_for_tree = self.feat_list_full[:feat_set_size]
  *         elif self.feat_sample_by_tree > 1:             # <<<<<<<<<<<<<<
  *             feat_set_size = int(self.feat_sample_by_tree)
  *             np.random.shuffle(self.feat_list_full)
  */
     goto __pyx_L3;
   }
 
-  /* "structureboost/structure_gb.pyx":318
+  /* "structureboost/structure_gb.pyx":316
  *             features_for_tree = self.feat_list_full[:feat_set_size]
  *         else:
  *             features_for_tree = self.feat_list_full             # <<<<<<<<<<<<<<
  * 
  *     def _output_loss_check_stop(self, y_valid, curr_valid_answer, i):
  */
   /*else*/ {
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_list_full); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 318, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feat_list_full); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 316, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_v_features_for_tree = __pyx_t_2;
     __pyx_t_2 = 0;
   }
   __pyx_L3:;
 
-  /* "structureboost/structure_gb.pyx":306
+  /* "structureboost/structure_gb.pyx":304
  * 
  * 
  *     def _get_features_for_tree(self):             # <<<<<<<<<<<<<<
  *         if self.feat_sample_by_tree < 1:
  *             feat_set_size = (self.feat_sample_by_tree *
  */
 
@@ -8972,15 +8959,15 @@
   __Pyx_XDECREF(__pyx_v_features_for_tree);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":320
+/* "structureboost/structure_gb.pyx":318
  *             features_for_tree = self.feat_list_full
  * 
  *     def _output_loss_check_stop(self, y_valid, curr_valid_answer, i):             # <<<<<<<<<<<<<<
  *         stop_now=False
  *         if ((i+1) % self.eval_freq == 1) and (i>0):
  */
 
@@ -9021,31 +9008,31 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_valid)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_output_loss_check_stop", 1, 4, 4, 1); __PYX_ERR(0, 320, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_output_loss_check_stop", 1, 4, 4, 1); __PYX_ERR(0, 318, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_curr_valid_answer)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_output_loss_check_stop", 1, 4, 4, 2); __PYX_ERR(0, 320, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_output_loss_check_stop", 1, 4, 4, 2); __PYX_ERR(0, 318, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_i)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_output_loss_check_stop", 1, 4, 4, 3); __PYX_ERR(0, 320, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_output_loss_check_stop", 1, 4, 4, 3); __PYX_ERR(0, 318, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_output_loss_check_stop") < 0)) __PYX_ERR(0, 320, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_output_loss_check_stop") < 0)) __PYX_ERR(0, 318, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 4) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
@@ -9054,15 +9041,15 @@
     __pyx_v_self = values[0];
     __pyx_v_y_valid = values[1];
     __pyx_v_curr_valid_answer = values[2];
     __pyx_v_i = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_output_loss_check_stop", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 320, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_output_loss_check_stop", 1, 4, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 318, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost._output_loss_check_stop", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_22_output_loss_check_stop(__pyx_self, __pyx_v_self, __pyx_v_y_valid, __pyx_v_curr_valid_answer, __pyx_v_i);
 
@@ -9087,65 +9074,65 @@
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__14)
   __Pyx_RefNannySetupContext("_output_loss_check_stop", 0);
-  __Pyx_TraceCall("_output_loss_check_stop", __pyx_f[0], 320, 0, __PYX_ERR(0, 320, __pyx_L1_error));
+  __Pyx_TraceCall("_output_loss_check_stop", __pyx_f[0], 318, 0, __PYX_ERR(0, 318, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":321
+  /* "structureboost/structure_gb.pyx":319
  * 
  *     def _output_loss_check_stop(self, y_valid, curr_valid_answer, i):
  *         stop_now=False             # <<<<<<<<<<<<<<
  *         if ((i+1) % self.eval_freq == 1) and (i>0):
  *             curr_loss = self._compute_loss(y_valid, curr_valid_answer)
  */
   __pyx_v_stop_now = 0;
 
-  /* "structureboost/structure_gb.pyx":322
+  /* "structureboost/structure_gb.pyx":320
  *     def _output_loss_check_stop(self, y_valid, curr_valid_answer, i):
  *         stop_now=False
  *         if ((i+1) % self.eval_freq == 1) and (i>0):             # <<<<<<<<<<<<<<
  *             curr_loss = self._compute_loss(y_valid, curr_valid_answer)
  *             if self.verbose:
  */
-  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 322, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_eval_freq); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 322, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_eval_freq); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyNumber_Remainder(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 322, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Remainder(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_t_4, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 322, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_t_4, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 320, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 322, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 320, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_5) {
   } else {
     __pyx_t_1 = __pyx_t_5;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_3 = PyObject_RichCompare(__pyx_v_i, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 322, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 322, __pyx_L1_error)
+  __pyx_t_3 = PyObject_RichCompare(__pyx_v_i, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 320, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 320, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_1 = __pyx_t_5;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "structureboost/structure_gb.pyx":323
+    /* "structureboost/structure_gb.pyx":321
  *         stop_now=False
  *         if ((i+1) % self.eval_freq == 1) and (i>0):
  *             curr_loss = self._compute_loss(y_valid, curr_valid_answer)             # <<<<<<<<<<<<<<
  *             if self.verbose:
  *                 print("i={}, eval_set_loss = {}".format(i, curr_loss))
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_compute_loss); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 323, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_compute_loss); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 321, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_2 = NULL;
     __pyx_t_6 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -9154,68 +9141,68 @@
         __Pyx_DECREF_SET(__pyx_t_4, function);
         __pyx_t_6 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_4)) {
       PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_v_y_valid, __pyx_v_curr_valid_answer};
-      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 321, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_GOTREF(__pyx_t_3);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
       PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_v_y_valid, __pyx_v_curr_valid_answer};
-      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 321, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_GOTREF(__pyx_t_3);
     } else
     #endif
     {
-      __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 323, __pyx_L1_error)
+      __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 321, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (__pyx_t_2) {
         __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_2); __pyx_t_2 = NULL;
       }
       __Pyx_INCREF(__pyx_v_y_valid);
       __Pyx_GIVEREF(__pyx_v_y_valid);
       PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_y_valid);
       __Pyx_INCREF(__pyx_v_curr_valid_answer);
       __Pyx_GIVEREF(__pyx_v_curr_valid_answer);
       PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_v_curr_valid_answer);
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 321, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     }
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_curr_loss = __pyx_t_3;
     __pyx_t_3 = 0;
 
-    /* "structureboost/structure_gb.pyx":324
+    /* "structureboost/structure_gb.pyx":322
  *         if ((i+1) % self.eval_freq == 1) and (i>0):
  *             curr_loss = self._compute_loss(y_valid, curr_valid_answer)
  *             if self.verbose:             # <<<<<<<<<<<<<<
  *                 print("i={}, eval_set_loss = {}".format(i, curr_loss))
  *             self.curr_step = np.floor((i+1) /
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_verbose); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 324, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_verbose); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 322, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 324, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 322, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_1) {
 
-      /* "structureboost/structure_gb.pyx":325
+      /* "structureboost/structure_gb.pyx":323
  *             curr_loss = self._compute_loss(y_valid, curr_valid_answer)
  *             if self.verbose:
  *                 print("i={}, eval_set_loss = {}".format(i, curr_loss))             # <<<<<<<<<<<<<<
  *             self.curr_step = np.floor((i+1) /
  *                                  self.eval_freq).astype(int)-1
  */
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_i_eval_set_loss, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 325, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_i_eval_set_loss, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 323, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __pyx_t_7 = NULL;
       __pyx_t_6 = 0;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_7)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -9224,91 +9211,91 @@
           __Pyx_DECREF_SET(__pyx_t_4, function);
           __pyx_t_6 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_4)) {
         PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_v_i, __pyx_v_curr_loss};
-        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 325, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_GOTREF(__pyx_t_3);
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
         PyObject *__pyx_temp[3] = {__pyx_t_7, __pyx_v_i, __pyx_v_curr_loss};
-        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 325, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_GOTREF(__pyx_t_3);
       } else
       #endif
       {
-        __pyx_t_2 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 325, __pyx_L1_error)
+        __pyx_t_2 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 323, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         if (__pyx_t_7) {
           __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_7); __pyx_t_7 = NULL;
         }
         __Pyx_INCREF(__pyx_v_i);
         __Pyx_GIVEREF(__pyx_v_i);
         PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_6, __pyx_v_i);
         __Pyx_INCREF(__pyx_v_curr_loss);
         __Pyx_GIVEREF(__pyx_v_curr_loss);
         PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_6, __pyx_v_curr_loss);
-        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 325, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_2, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 323, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       }
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 325, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 323, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "structureboost/structure_gb.pyx":324
+      /* "structureboost/structure_gb.pyx":322
  *         if ((i+1) % self.eval_freq == 1) and (i>0):
  *             curr_loss = self._compute_loss(y_valid, curr_valid_answer)
  *             if self.verbose:             # <<<<<<<<<<<<<<
  *                 print("i={}, eval_set_loss = {}".format(i, curr_loss))
  *             self.curr_step = np.floor((i+1) /
  */
     }
 
-    /* "structureboost/structure_gb.pyx":326
+    /* "structureboost/structure_gb.pyx":324
  *             if self.verbose:
  *                 print("i={}, eval_set_loss = {}".format(i, curr_loss))
  *             self.curr_step = np.floor((i+1) /             # <<<<<<<<<<<<<<
  *                                  self.eval_freq).astype(int)-1
  *             self.eval_results[self.curr_step] = curr_loss
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 326, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 324, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_floor); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 326, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_floor); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 324, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 326, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_i, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 324, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
 
-    /* "structureboost/structure_gb.pyx":327
+    /* "structureboost/structure_gb.pyx":325
  *                 print("i={}, eval_set_loss = {}".format(i, curr_loss))
  *             self.curr_step = np.floor((i+1) /
  *                                  self.eval_freq).astype(int)-1             # <<<<<<<<<<<<<<
  *             self.eval_results[self.curr_step] = curr_loss
  *             if ((self.early_stop_past_steps>=0) and
  */
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_eval_freq); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 327, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_eval_freq); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 325, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
 
-    /* "structureboost/structure_gb.pyx":326
+    /* "structureboost/structure_gb.pyx":324
  *             if self.verbose:
  *                 print("i={}, eval_set_loss = {}".format(i, curr_loss))
  *             self.curr_step = np.floor((i+1) /             # <<<<<<<<<<<<<<
  *                                  self.eval_freq).astype(int)-1
  *             self.eval_results[self.curr_step] = curr_loss
  */
-    __pyx_t_9 = __Pyx_PyNumber_Divide(__pyx_t_2, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 326, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyNumber_Divide(__pyx_t_2, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 324, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __pyx_t_8 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_8)) {
@@ -9317,139 +9304,139 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_3 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_8, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_9);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 326, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 324, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "structureboost/structure_gb.pyx":327
+    /* "structureboost/structure_gb.pyx":325
  *                 print("i={}, eval_set_loss = {}".format(i, curr_loss))
  *             self.curr_step = np.floor((i+1) /
  *                                  self.eval_freq).astype(int)-1             # <<<<<<<<<<<<<<
  *             self.eval_results[self.curr_step] = curr_loss
  *             if ((self.early_stop_past_steps>=0) and
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 327, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 325, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_4 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_3, ((PyObject *)(&PyInt_Type))) : __Pyx_PyObject_CallOneArg(__pyx_t_7, ((PyObject *)(&PyInt_Type)));
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 327, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 325, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 327, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 325, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "structureboost/structure_gb.pyx":326
+    /* "structureboost/structure_gb.pyx":324
  *             if self.verbose:
  *                 print("i={}, eval_set_loss = {}".format(i, curr_loss))
  *             self.curr_step = np.floor((i+1) /             # <<<<<<<<<<<<<<
  *                                  self.eval_freq).astype(int)-1
  *             self.eval_results[self.curr_step] = curr_loss
  */
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_curr_step, __pyx_t_7) < 0) __PYX_ERR(0, 326, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_curr_step, __pyx_t_7) < 0) __PYX_ERR(0, 324, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "structureboost/structure_gb.pyx":328
+    /* "structureboost/structure_gb.pyx":326
  *             self.curr_step = np.floor((i+1) /
  *                                  self.eval_freq).astype(int)-1
  *             self.eval_results[self.curr_step] = curr_loss             # <<<<<<<<<<<<<<
  *             if ((self.early_stop_past_steps>=0) and
  *                     (self.curr_step > self.early_stop_past_steps)):
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_eval_results); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 328, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_eval_results); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 326, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_curr_step); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 328, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_curr_step); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 326, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    if (unlikely(PyObject_SetItem(__pyx_t_7, __pyx_t_4, __pyx_v_curr_loss) < 0)) __PYX_ERR(0, 328, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_t_7, __pyx_t_4, __pyx_v_curr_loss) < 0)) __PYX_ERR(0, 326, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "structureboost/structure_gb.pyx":329
+    /* "structureboost/structure_gb.pyx":327
  *                                  self.eval_freq).astype(int)-1
  *             self.eval_results[self.curr_step] = curr_loss
  *             if ((self.early_stop_past_steps>=0) and             # <<<<<<<<<<<<<<
  *                     (self.curr_step > self.early_stop_past_steps)):
  *                 self.best_step = np.argmin(self.eval_results[:(self.curr_step+1)])
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_early_stop_past_steps); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 329, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_early_stop_past_steps); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 327, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_7 = PyObject_RichCompare(__pyx_t_4, __pyx_int_0, Py_GE); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 329, __pyx_L1_error)
+    __pyx_t_7 = PyObject_RichCompare(__pyx_t_4, __pyx_int_0, Py_GE); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 327, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 329, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 327, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     if (__pyx_t_5) {
     } else {
       __pyx_t_1 = __pyx_t_5;
       goto __pyx_L8_bool_binop_done;
     }
 
-    /* "structureboost/structure_gb.pyx":330
+    /* "structureboost/structure_gb.pyx":328
  *             self.eval_results[self.curr_step] = curr_loss
  *             if ((self.early_stop_past_steps>=0) and
  *                     (self.curr_step > self.early_stop_past_steps)):             # <<<<<<<<<<<<<<
  *                 self.best_step = np.argmin(self.eval_results[:(self.curr_step+1)])
  *                 if ((self.curr_step-self.best_step) >= self.early_stop_past_steps):
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_curr_step); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 330, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_curr_step); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 328, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_early_stop_past_steps); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 330, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_early_stop_past_steps); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 328, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyObject_RichCompare(__pyx_t_7, __pyx_t_4, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 330, __pyx_L1_error)
+    __pyx_t_3 = PyObject_RichCompare(__pyx_t_7, __pyx_t_4, Py_GT); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 328, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 330, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 328, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_1 = __pyx_t_5;
     __pyx_L8_bool_binop_done:;
 
-    /* "structureboost/structure_gb.pyx":329
+    /* "structureboost/structure_gb.pyx":327
  *                                  self.eval_freq).astype(int)-1
  *             self.eval_results[self.curr_step] = curr_loss
  *             if ((self.early_stop_past_steps>=0) and             # <<<<<<<<<<<<<<
  *                     (self.curr_step > self.early_stop_past_steps)):
  *                 self.best_step = np.argmin(self.eval_results[:(self.curr_step+1)])
  */
     if (__pyx_t_1) {
 
-      /* "structureboost/structure_gb.pyx":331
+      /* "structureboost/structure_gb.pyx":329
  *             if ((self.early_stop_past_steps>=0) and
  *                     (self.curr_step > self.early_stop_past_steps)):
  *                 self.best_step = np.argmin(self.eval_results[:(self.curr_step+1)])             # <<<<<<<<<<<<<<
  *                 if ((self.curr_step-self.best_step) >= self.early_stop_past_steps):
  *                     stop_now = True
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 331, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 329, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_argmin); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 331, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_argmin); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 329, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_eval_results); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 331, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_eval_results); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 329, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_curr_step); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 331, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_curr_step); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 329, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_8 = __Pyx_PyInt_AddObjC(__pyx_t_9, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 331, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyInt_AddObjC(__pyx_t_9, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 329, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      __pyx_t_9 = __Pyx_PyObject_GetSlice(__pyx_t_4, 0, 0, NULL, &__pyx_t_8, NULL, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 331, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetSlice(__pyx_t_4, 0, 0, NULL, &__pyx_t_8, NULL, 0, 0, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 329, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __pyx_t_8 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
         __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
         if (likely(__pyx_t_8)) {
@@ -9458,80 +9445,80 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_7, function);
         }
       }
       __pyx_t_3 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_8, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_9);
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 331, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 329, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_best_step, __pyx_t_3) < 0) __PYX_ERR(0, 331, __pyx_L1_error)
+      if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_best_step, __pyx_t_3) < 0) __PYX_ERR(0, 329, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "structureboost/structure_gb.pyx":332
+      /* "structureboost/structure_gb.pyx":330
  *                     (self.curr_step > self.early_stop_past_steps)):
  *                 self.best_step = np.argmin(self.eval_results[:(self.curr_step+1)])
  *                 if ((self.curr_step-self.best_step) >= self.early_stop_past_steps):             # <<<<<<<<<<<<<<
  *                     stop_now = True
  *                     if self.verbose:
  */
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_curr_step); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 332, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_curr_step); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 330, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_best_step); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 332, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_best_step); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 330, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_9 = PyNumber_Subtract(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 332, __pyx_L1_error)
+      __pyx_t_9 = PyNumber_Subtract(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 330, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_early_stop_past_steps); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 332, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_early_stop_past_steps); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 330, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_3 = PyObject_RichCompare(__pyx_t_9, __pyx_t_7, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 332, __pyx_L1_error)
+      __pyx_t_3 = PyObject_RichCompare(__pyx_t_9, __pyx_t_7, Py_GE); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 330, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 332, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 330, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       if (__pyx_t_1) {
 
-        /* "structureboost/structure_gb.pyx":333
+        /* "structureboost/structure_gb.pyx":331
  *                 self.best_step = np.argmin(self.eval_results[:(self.curr_step+1)])
  *                 if ((self.curr_step-self.best_step) >= self.early_stop_past_steps):
  *                     stop_now = True             # <<<<<<<<<<<<<<
  *                     if self.verbose:
  *                         print("""Stopping early: low pt was {} steps ago"""
  */
         __pyx_v_stop_now = 1;
 
-        /* "structureboost/structure_gb.pyx":334
+        /* "structureboost/structure_gb.pyx":332
  *                 if ((self.curr_step-self.best_step) >= self.early_stop_past_steps):
  *                     stop_now = True
  *                     if self.verbose:             # <<<<<<<<<<<<<<
  *                         print("""Stopping early: low pt was {} steps ago"""
  *                             .format((self.curr_step-self.best_step)))
  */
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_verbose); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 334, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_verbose); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 332, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 334, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 332, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         if (__pyx_t_1) {
 
-          /* "structureboost/structure_gb.pyx":336
+          /* "structureboost/structure_gb.pyx":334
  *                     if self.verbose:
  *                         print("""Stopping early: low pt was {} steps ago"""
  *                             .format((self.curr_step-self.best_step)))             # <<<<<<<<<<<<<<
  *                     if self.choose_best_eval:
  *                         self.num_trees_for_prediction = ((
  */
-          __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_Stopping_early_low_pt_was_steps, __pyx_n_s_format); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 336, __pyx_L1_error)
+          __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_Stopping_early_low_pt_was_steps, __pyx_n_s_format); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 334, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
-          __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_curr_step); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 336, __pyx_L1_error)
+          __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_curr_step); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 334, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
-          __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_best_step); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 336, __pyx_L1_error)
+          __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_best_step); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 334, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
-          __pyx_t_4 = PyNumber_Subtract(__pyx_t_9, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 336, __pyx_L1_error)
+          __pyx_t_4 = PyNumber_Subtract(__pyx_t_9, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 334, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
           __pyx_t_8 = NULL;
           if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
             __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
             if (likely(__pyx_t_8)) {
@@ -9540,72 +9527,72 @@
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_7, function);
             }
           }
           __pyx_t_3 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_8, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_4);
           __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 336, __pyx_L1_error)
+          if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 334, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-          /* "structureboost/structure_gb.pyx":335
+          /* "structureboost/structure_gb.pyx":333
  *                     stop_now = True
  *                     if self.verbose:
  *                         print("""Stopping early: low pt was {} steps ago"""             # <<<<<<<<<<<<<<
  *                             .format((self.curr_step-self.best_step)))
  *                     if self.choose_best_eval:
  */
-          __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 335, __pyx_L1_error)
+          __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 333, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-          /* "structureboost/structure_gb.pyx":334
+          /* "structureboost/structure_gb.pyx":332
  *                 if ((self.curr_step-self.best_step) >= self.early_stop_past_steps):
  *                     stop_now = True
  *                     if self.verbose:             # <<<<<<<<<<<<<<
  *                         print("""Stopping early: low pt was {} steps ago"""
  *                             .format((self.curr_step-self.best_step)))
  */
         }
 
-        /* "structureboost/structure_gb.pyx":337
+        /* "structureboost/structure_gb.pyx":335
  *                         print("""Stopping early: low pt was {} steps ago"""
  *                             .format((self.curr_step-self.best_step)))
  *                     if self.choose_best_eval:             # <<<<<<<<<<<<<<
  *                         self.num_trees_for_prediction = ((
  *                             np.argmin(self.eval_results[:self.curr_step+1])+1) *
  */
-        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_choose_best_eval); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 337, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_choose_best_eval); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 335, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 337, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 335, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         if (__pyx_t_1) {
 
-          /* "structureboost/structure_gb.pyx":339
+          /* "structureboost/structure_gb.pyx":337
  *                     if self.choose_best_eval:
  *                         self.num_trees_for_prediction = ((
  *                             np.argmin(self.eval_results[:self.curr_step+1])+1) *             # <<<<<<<<<<<<<<
  *                             self.eval_freq)
  *         return(stop_now)
  */
-          __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 339, __pyx_L1_error)
+          __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 337, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_argmin); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 339, __pyx_L1_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_argmin); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 337, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_eval_results); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 339, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_eval_results); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 337, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_curr_step); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 339, __pyx_L1_error)
+          __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_curr_step); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 337, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
-          __pyx_t_9 = __Pyx_PyInt_AddObjC(__pyx_t_8, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 339, __pyx_L1_error)
+          __pyx_t_9 = __Pyx_PyInt_AddObjC(__pyx_t_8, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 337, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __pyx_t_8 = __Pyx_PyObject_GetSlice(__pyx_t_3, 0, 0, NULL, &__pyx_t_9, NULL, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 339, __pyx_L1_error)
+          __pyx_t_8 = __Pyx_PyObject_GetSlice(__pyx_t_3, 0, 0, NULL, &__pyx_t_9, NULL, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 337, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
           __pyx_t_9 = NULL;
           if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
             __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_4);
             if (likely(__pyx_t_9)) {
@@ -9614,104 +9601,104 @@
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_4, function);
             }
           }
           __pyx_t_7 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_9, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_8);
           __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 339, __pyx_L1_error)
+          if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 337, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_7, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 339, __pyx_L1_error)
+          __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_t_7, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 337, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-          /* "structureboost/structure_gb.pyx":340
+          /* "structureboost/structure_gb.pyx":338
  *                         self.num_trees_for_prediction = ((
  *                             np.argmin(self.eval_results[:self.curr_step+1])+1) *
  *                             self.eval_freq)             # <<<<<<<<<<<<<<
  *         return(stop_now)
  * 
  */
-          __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_eval_freq); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 340, __pyx_L1_error)
+          __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_eval_freq); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 338, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
 
-          /* "structureboost/structure_gb.pyx":339
+          /* "structureboost/structure_gb.pyx":337
  *                     if self.choose_best_eval:
  *                         self.num_trees_for_prediction = ((
  *                             np.argmin(self.eval_results[:self.curr_step+1])+1) *             # <<<<<<<<<<<<<<
  *                             self.eval_freq)
  *         return(stop_now)
  */
-          __pyx_t_8 = PyNumber_Multiply(__pyx_t_4, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 339, __pyx_L1_error)
+          __pyx_t_8 = PyNumber_Multiply(__pyx_t_4, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 337, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-          /* "structureboost/structure_gb.pyx":338
+          /* "structureboost/structure_gb.pyx":336
  *                             .format((self.curr_step-self.best_step)))
  *                     if self.choose_best_eval:
  *                         self.num_trees_for_prediction = ((             # <<<<<<<<<<<<<<
  *                             np.argmin(self.eval_results[:self.curr_step+1])+1) *
  *                             self.eval_freq)
  */
-          if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_num_trees_for_prediction, __pyx_t_8) < 0) __PYX_ERR(0, 338, __pyx_L1_error)
+          if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_num_trees_for_prediction, __pyx_t_8) < 0) __PYX_ERR(0, 336, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-          /* "structureboost/structure_gb.pyx":337
+          /* "structureboost/structure_gb.pyx":335
  *                         print("""Stopping early: low pt was {} steps ago"""
  *                             .format((self.curr_step-self.best_step)))
  *                     if self.choose_best_eval:             # <<<<<<<<<<<<<<
  *                         self.num_trees_for_prediction = ((
  *                             np.argmin(self.eval_results[:self.curr_step+1])+1) *
  */
         }
 
-        /* "structureboost/structure_gb.pyx":332
+        /* "structureboost/structure_gb.pyx":330
  *                     (self.curr_step > self.early_stop_past_steps)):
  *                 self.best_step = np.argmin(self.eval_results[:(self.curr_step+1)])
  *                 if ((self.curr_step-self.best_step) >= self.early_stop_past_steps):             # <<<<<<<<<<<<<<
  *                     stop_now = True
  *                     if self.verbose:
  */
       }
 
-      /* "structureboost/structure_gb.pyx":329
+      /* "structureboost/structure_gb.pyx":327
  *                                  self.eval_freq).astype(int)-1
  *             self.eval_results[self.curr_step] = curr_loss
  *             if ((self.early_stop_past_steps>=0) and             # <<<<<<<<<<<<<<
  *                     (self.curr_step > self.early_stop_past_steps)):
  *                 self.best_step = np.argmin(self.eval_results[:(self.curr_step+1)])
  */
     }
 
-    /* "structureboost/structure_gb.pyx":322
+    /* "structureboost/structure_gb.pyx":320
  *     def _output_loss_check_stop(self, y_valid, curr_valid_answer, i):
  *         stop_now=False
  *         if ((i+1) % self.eval_freq == 1) and (i>0):             # <<<<<<<<<<<<<<
  *             curr_loss = self._compute_loss(y_valid, curr_valid_answer)
  *             if self.verbose:
  */
   }
 
-  /* "structureboost/structure_gb.pyx":341
+  /* "structureboost/structure_gb.pyx":339
  *                             np.argmin(self.eval_results[:self.curr_step+1])+1) *
  *                             self.eval_freq)
  *         return(stop_now)             # <<<<<<<<<<<<<<
  * 
  *     def _initialize_uv_dict(self, X_train):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_8 = __Pyx_PyBool_FromLong(__pyx_v_stop_now); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 341, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyBool_FromLong(__pyx_v_stop_now); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 339, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __pyx_r = __pyx_t_8;
   __pyx_t_8 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":320
+  /* "structureboost/structure_gb.pyx":318
  *             features_for_tree = self.feat_list_full
  * 
  *     def _output_loss_check_stop(self, y_valid, curr_valid_answer, i):             # <<<<<<<<<<<<<<
  *         stop_now=False
  *         if ((i+1) % self.eval_freq == 1) and (i>0):
  */
 
@@ -9729,15 +9716,15 @@
   __Pyx_XDECREF(__pyx_v_curr_loss);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":343
+/* "structureboost/structure_gb.pyx":341
  *         return(stop_now)
  * 
  *     def _initialize_uv_dict(self, X_train):             # <<<<<<<<<<<<<<
  *         self.unique_vals_dict = {}
  *         for feature in self.feature_configs.keys():
  */
 
@@ -9772,32 +9759,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X_train)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_initialize_uv_dict", 1, 2, 2, 1); __PYX_ERR(0, 343, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_initialize_uv_dict", 1, 2, 2, 1); __PYX_ERR(0, 341, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_initialize_uv_dict") < 0)) __PYX_ERR(0, 343, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_initialize_uv_dict") < 0)) __PYX_ERR(0, 341, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_X_train = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_initialize_uv_dict", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 343, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_initialize_uv_dict", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 341, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost._initialize_uv_dict", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_24_initialize_uv_dict(__pyx_self, __pyx_v_self, __pyx_v_X_train);
 
@@ -9826,153 +9813,153 @@
   PyObject *__pyx_t_13 = NULL;
   PyObject *__pyx_t_14 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__15)
   __Pyx_RefNannySetupContext("_initialize_uv_dict", 0);
-  __Pyx_TraceCall("_initialize_uv_dict", __pyx_f[0], 343, 0, __PYX_ERR(0, 343, __pyx_L1_error));
+  __Pyx_TraceCall("_initialize_uv_dict", __pyx_f[0], 341, 0, __PYX_ERR(0, 341, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":344
+  /* "structureboost/structure_gb.pyx":342
  * 
  *     def _initialize_uv_dict(self, X_train):
  *         self.unique_vals_dict = {}             # <<<<<<<<<<<<<<
  *         for feature in self.feature_configs.keys():
  *             if self.feature_configs[feature]['feature_type'] == 'numerical':
  */
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 344, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 342, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_unique_vals_dict, __pyx_t_1) < 0) __PYX_ERR(0, 344, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_unique_vals_dict, __pyx_t_1) < 0) __PYX_ERR(0, 342, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":345
+  /* "structureboost/structure_gb.pyx":343
  *     def _initialize_uv_dict(self, X_train):
  *         self.unique_vals_dict = {}
  *         for feature in self.feature_configs.keys():             # <<<<<<<<<<<<<<
  *             if self.feature_configs[feature]['feature_type'] == 'numerical':
  *                 self.unique_vals_dict[feature] = np.sort(
  */
   __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 345, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 343, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   if (unlikely(__pyx_t_5 == Py_None)) {
     PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-    __PYX_ERR(0, 345, __pyx_L1_error)
+    __PYX_ERR(0, 343, __pyx_L1_error)
   }
-  __pyx_t_6 = __Pyx_dict_iterator(__pyx_t_5, 0, __pyx_n_s_keys, (&__pyx_t_3), (&__pyx_t_4)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 345, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_dict_iterator(__pyx_t_5, 0, __pyx_n_s_keys, (&__pyx_t_3), (&__pyx_t_4)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 343, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_XDECREF(__pyx_t_1);
   __pyx_t_1 = __pyx_t_6;
   __pyx_t_6 = 0;
   while (1) {
     __pyx_t_7 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_3, &__pyx_t_2, &__pyx_t_6, NULL, NULL, __pyx_t_4);
     if (unlikely(__pyx_t_7 == 0)) break;
-    if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 345, __pyx_L1_error)
+    if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 343, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_XDECREF_SET(__pyx_v_feature, __pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "structureboost/structure_gb.pyx":346
+    /* "structureboost/structure_gb.pyx":344
  *         self.unique_vals_dict = {}
  *         for feature in self.feature_configs.keys():
  *             if self.feature_configs[feature]['feature_type'] == 'numerical':             # <<<<<<<<<<<<<<
  *                 self.unique_vals_dict[feature] = np.sort(
  *                                     pd.unique(np.round(X_train[feature].dropna(),
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 346, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_feature); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 346, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_feature); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_Dict_GetItem(__pyx_t_5, __pyx_n_u_feature_type); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 346, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Dict_GetItem(__pyx_t_5, __pyx_n_u_feature_type); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 344, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_8 = (__Pyx_PyUnicode_Equals(__pyx_t_6, __pyx_n_u_numerical, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 346, __pyx_L1_error)
+    __pyx_t_8 = (__Pyx_PyUnicode_Equals(__pyx_t_6, __pyx_n_u_numerical, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 344, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     if (__pyx_t_8) {
 
-      /* "structureboost/structure_gb.pyx":347
+      /* "structureboost/structure_gb.pyx":345
  *         for feature in self.feature_configs.keys():
  *             if self.feature_configs[feature]['feature_type'] == 'numerical':
  *                 self.unique_vals_dict[feature] = np.sort(             # <<<<<<<<<<<<<<
  *                                     pd.unique(np.round(X_train[feature].dropna(),
  *                                         decimals=self.prec_digits)))
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 347, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 345, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sort); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 347, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_sort); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 345, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-      /* "structureboost/structure_gb.pyx":348
+      /* "structureboost/structure_gb.pyx":346
  *             if self.feature_configs[feature]['feature_type'] == 'numerical':
  *                 self.unique_vals_dict[feature] = np.sort(
  *                                     pd.unique(np.round(X_train[feature].dropna(),             # <<<<<<<<<<<<<<
  *                                         decimals=self.prec_digits)))
  * 
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_pd); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 348, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_pd); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 346, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_unique); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 348, __pyx_L1_error)
+      __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_unique); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 346, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 348, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 346, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_round); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 348, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_round); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 346, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_12);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_v_X_train, __pyx_v_feature); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 348, __pyx_L1_error)
+      __pyx_t_13 = __Pyx_PyObject_GetItem(__pyx_v_X_train, __pyx_v_feature); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 346, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_13);
-      __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_dropna); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 348, __pyx_L1_error)
+      __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_t_13, __pyx_n_s_dropna); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 346, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_14);
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
       __pyx_t_13 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_14))) {
         __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_14);
         if (likely(__pyx_t_13)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_14);
           __Pyx_INCREF(__pyx_t_13);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_14, function);
         }
       }
       __pyx_t_10 = (__pyx_t_13) ? __Pyx_PyObject_CallOneArg(__pyx_t_14, __pyx_t_13) : __Pyx_PyObject_CallNoArg(__pyx_t_14);
       __Pyx_XDECREF(__pyx_t_13); __pyx_t_13 = 0;
-      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 348, __pyx_L1_error)
+      if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 346, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
-      __pyx_t_14 = PyTuple_New(1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 348, __pyx_L1_error)
+      __pyx_t_14 = PyTuple_New(1); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 346, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_14);
       __Pyx_GIVEREF(__pyx_t_10);
       PyTuple_SET_ITEM(__pyx_t_14, 0, __pyx_t_10);
       __pyx_t_10 = 0;
 
-      /* "structureboost/structure_gb.pyx":349
+      /* "structureboost/structure_gb.pyx":347
  *                 self.unique_vals_dict[feature] = np.sort(
  *                                     pd.unique(np.round(X_train[feature].dropna(),
  *                                         decimals=self.prec_digits)))             # <<<<<<<<<<<<<<
  * 
  *     def _init_eval_set_info(self, eval_set, y_train):
  */
-      __pyx_t_10 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 349, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 347, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
-      __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_prec_digits); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 349, __pyx_L1_error)
+      __pyx_t_13 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_prec_digits); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 347, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_13);
-      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_decimals, __pyx_t_13) < 0) __PYX_ERR(0, 349, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_10, __pyx_n_s_decimals, __pyx_t_13) < 0) __PYX_ERR(0, 347, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
 
-      /* "structureboost/structure_gb.pyx":348
+      /* "structureboost/structure_gb.pyx":346
  *             if self.feature_configs[feature]['feature_type'] == 'numerical':
  *                 self.unique_vals_dict[feature] = np.sort(
  *                                     pd.unique(np.round(X_train[feature].dropna(),             # <<<<<<<<<<<<<<
  *                                         decimals=self.prec_digits)))
  * 
  */
-      __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_14, __pyx_t_10); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 348, __pyx_L1_error)
+      __pyx_t_13 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_14, __pyx_t_10); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 346, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_13);
       __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __pyx_t_10 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
         __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_11);
@@ -9982,15 +9969,15 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_11, function);
         }
       }
       __pyx_t_5 = (__pyx_t_10) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_10, __pyx_t_13) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_13);
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_13); __pyx_t_13 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 348, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 346, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __pyx_t_11 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
         __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_9);
         if (likely(__pyx_t_11)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
@@ -9998,43 +9985,43 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_9, function);
         }
       }
       __pyx_t_6 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_11, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_5);
       __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 347, __pyx_L1_error)
+      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 345, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-      /* "structureboost/structure_gb.pyx":347
+      /* "structureboost/structure_gb.pyx":345
  *         for feature in self.feature_configs.keys():
  *             if self.feature_configs[feature]['feature_type'] == 'numerical':
  *                 self.unique_vals_dict[feature] = np.sort(             # <<<<<<<<<<<<<<
  *                                     pd.unique(np.round(X_train[feature].dropna(),
  *                                         decimals=self.prec_digits)))
  */
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_unique_vals_dict); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 347, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_unique_vals_dict); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 345, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      if (unlikely(PyObject_SetItem(__pyx_t_9, __pyx_v_feature, __pyx_t_6) < 0)) __PYX_ERR(0, 347, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_t_9, __pyx_v_feature, __pyx_t_6) < 0)) __PYX_ERR(0, 345, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-      /* "structureboost/structure_gb.pyx":346
+      /* "structureboost/structure_gb.pyx":344
  *         self.unique_vals_dict = {}
  *         for feature in self.feature_configs.keys():
  *             if self.feature_configs[feature]['feature_type'] == 'numerical':             # <<<<<<<<<<<<<<
  *                 self.unique_vals_dict[feature] = np.sort(
  *                                     pd.unique(np.round(X_train[feature].dropna(),
  */
     }
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":343
+  /* "structureboost/structure_gb.pyx":341
  *         return(stop_now)
  * 
  *     def _initialize_uv_dict(self, X_train):             # <<<<<<<<<<<<<<
  *         self.unique_vals_dict = {}
  *         for feature in self.feature_configs.keys():
  */
 
@@ -10057,15 +10044,15 @@
   __Pyx_XDECREF(__pyx_v_feature);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":351
+/* "structureboost/structure_gb.pyx":349
  *                                         decimals=self.prec_digits)))
  * 
  *     def _init_eval_set_info(self, eval_set, y_train):             # <<<<<<<<<<<<<<
  *         self.eval_results = np.zeros(np.floor(
  *                                 self.num_trees/self.eval_freq).astype(int))
  */
 
@@ -10103,40 +10090,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_eval_set)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_init_eval_set_info", 1, 3, 3, 1); __PYX_ERR(0, 351, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_init_eval_set_info", 1, 3, 3, 1); __PYX_ERR(0, 349, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_train)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_init_eval_set_info", 1, 3, 3, 2); __PYX_ERR(0, 351, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_init_eval_set_info", 1, 3, 3, 2); __PYX_ERR(0, 349, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_init_eval_set_info") < 0)) __PYX_ERR(0, 351, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_init_eval_set_info") < 0)) __PYX_ERR(0, 349, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_eval_set = values[1];
     __pyx_v_y_train = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_init_eval_set_info", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 351, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_init_eval_set_info", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 349, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost._init_eval_set_info", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_26_init_eval_set_info(__pyx_self, __pyx_v_self, __pyx_v_eval_set, __pyx_v_y_train);
 
@@ -10164,62 +10151,62 @@
   int __pyx_t_9;
   int __pyx_t_10;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__16)
   __Pyx_RefNannySetupContext("_init_eval_set_info", 0);
-  __Pyx_TraceCall("_init_eval_set_info", __pyx_f[0], 351, 0, __PYX_ERR(0, 351, __pyx_L1_error));
+  __Pyx_TraceCall("_init_eval_set_info", __pyx_f[0], 349, 0, __PYX_ERR(0, 349, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":352
+  /* "structureboost/structure_gb.pyx":350
  * 
  *     def _init_eval_set_info(self, eval_set, y_train):
  *         self.eval_results = np.zeros(np.floor(             # <<<<<<<<<<<<<<
  *                                 self.num_trees/self.eval_freq).astype(int))
  *         X_valid = eval_set[0]
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 352, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 352, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "structureboost/structure_gb.pyx":353
+  /* "structureboost/structure_gb.pyx":351
  *     def _init_eval_set_info(self, eval_set, y_train):
  *         self.eval_results = np.zeros(np.floor(
  *                                 self.num_trees/self.eval_freq).astype(int))             # <<<<<<<<<<<<<<
  *         X_valid = eval_set[0]
  *         y_valid = eval_set[1]
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 352, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
 
-  /* "structureboost/structure_gb.pyx":352
+  /* "structureboost/structure_gb.pyx":350
  * 
  *     def _init_eval_set_info(self, eval_set, y_train):
  *         self.eval_results = np.zeros(np.floor(             # <<<<<<<<<<<<<<
  *                                 self.num_trees/self.eval_freq).astype(int))
  *         X_valid = eval_set[0]
  */
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_floor); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 352, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_floor); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "structureboost/structure_gb.pyx":353
+  /* "structureboost/structure_gb.pyx":351
  *     def _init_eval_set_info(self, eval_set, y_train):
  *         self.eval_results = np.zeros(np.floor(
  *                                 self.num_trees/self.eval_freq).astype(int))             # <<<<<<<<<<<<<<
  *         X_valid = eval_set[0]
  *         y_valid = eval_set[1]
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_trees); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 353, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_trees); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 351, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_eval_freq); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 353, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_eval_freq); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 351, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 353, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 351, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_7 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_7)) {
@@ -10228,33 +10215,33 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_7, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_8);
   __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 352, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_astype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 353, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_astype); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 351, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_4, ((PyObject *)(&PyInt_Type))) : __Pyx_PyObject_CallOneArg(__pyx_t_6, ((PyObject *)(&PyInt_Type)));
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 353, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 351, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -10262,87 +10249,87 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 352, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":352
+  /* "structureboost/structure_gb.pyx":350
  * 
  *     def _init_eval_set_info(self, eval_set, y_train):
  *         self.eval_results = np.zeros(np.floor(             # <<<<<<<<<<<<<<
  *                                 self.num_trees/self.eval_freq).astype(int))
  *         X_valid = eval_set[0]
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_eval_results, __pyx_t_1) < 0) __PYX_ERR(0, 352, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_eval_results, __pyx_t_1) < 0) __PYX_ERR(0, 350, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":354
+  /* "structureboost/structure_gb.pyx":352
  *         self.eval_results = np.zeros(np.floor(
  *                                 self.num_trees/self.eval_freq).astype(int))
  *         X_valid = eval_set[0]             # <<<<<<<<<<<<<<
  *         y_valid = eval_set[1]
  *         y_valid = self._process_y_data(y_valid)
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_eval_set, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 354, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_eval_set, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 352, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_X_valid = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":355
+  /* "structureboost/structure_gb.pyx":353
  *                                 self.num_trees/self.eval_freq).astype(int))
  *         X_valid = eval_set[0]
  *         y_valid = eval_set[1]             # <<<<<<<<<<<<<<
  *         y_valid = self._process_y_data(y_valid)
  *         # below, we use X_valid and y_train *not a mistake*
  */
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_eval_set, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 355, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_eval_set, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 353, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_y_valid = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":356
+  /* "structureboost/structure_gb.pyx":354
  *         X_valid = eval_set[0]
  *         y_valid = eval_set[1]
  *         y_valid = self._process_y_data(y_valid)             # <<<<<<<<<<<<<<
  *         # below, we use X_valid and y_train *not a mistake*
  *         # if there is initial model, we apply it to X_valid
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_process_y_data); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 356, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_process_y_data); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 354, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_y_valid) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_y_valid);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 356, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 354, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF_SET(__pyx_v_y_valid, __pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":360
+  /* "structureboost/structure_gb.pyx":358
  *         # if there is initial model, we apply it to X_valid
  *         # otherwise we use the marginal averages from y_train
  *         curr_valid_answer = self._get_initial_pred(X_valid, y_train)             # <<<<<<<<<<<<<<
  *         curr_valid_loss = self._compute_loss(y_valid, curr_valid_answer)
  *         if self.verbose:
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_initial_pred); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 360, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_initial_pred); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 358, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_2 = NULL;
   __pyx_t_9 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -10351,55 +10338,55 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_9 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_v_X_valid, __pyx_v_y_train};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 360, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 358, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_v_X_valid, __pyx_v_y_train};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 360, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 358, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_6 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 360, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 358, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     if (__pyx_t_2) {
       __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_2); __pyx_t_2 = NULL;
     }
     __Pyx_INCREF(__pyx_v_X_valid);
     __Pyx_GIVEREF(__pyx_v_X_valid);
     PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_9, __pyx_v_X_valid);
     __Pyx_INCREF(__pyx_v_y_train);
     __Pyx_GIVEREF(__pyx_v_y_train);
     PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_9, __pyx_v_y_train);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 360, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 358, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_curr_valid_answer = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":361
+  /* "structureboost/structure_gb.pyx":359
  *         # otherwise we use the marginal averages from y_train
  *         curr_valid_answer = self._get_initial_pred(X_valid, y_train)
  *         curr_valid_loss = self._compute_loss(y_valid, curr_valid_answer)             # <<<<<<<<<<<<<<
  *         if self.verbose:
  *             print("i={}, eval_set_loss = {}".format(0, curr_valid_loss))
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_compute_loss); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_compute_loss); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 359, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_6 = NULL;
   __pyx_t_9 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -10408,68 +10395,68 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_9 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_v_y_valid, __pyx_v_curr_valid_answer};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 361, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 359, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_6, __pyx_v_y_valid, __pyx_v_curr_valid_answer};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 361, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 359, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_2 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 361, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 359, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     if (__pyx_t_6) {
       __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6); __pyx_t_6 = NULL;
     }
     __Pyx_INCREF(__pyx_v_y_valid);
     __Pyx_GIVEREF(__pyx_v_y_valid);
     PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_9, __pyx_v_y_valid);
     __Pyx_INCREF(__pyx_v_curr_valid_answer);
     __Pyx_GIVEREF(__pyx_v_curr_valid_answer);
     PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_9, __pyx_v_curr_valid_answer);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 361, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 359, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_curr_valid_loss = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":362
+  /* "structureboost/structure_gb.pyx":360
  *         curr_valid_answer = self._get_initial_pred(X_valid, y_train)
  *         curr_valid_loss = self._compute_loss(y_valid, curr_valid_answer)
  *         if self.verbose:             # <<<<<<<<<<<<<<
  *             print("i={}, eval_set_loss = {}".format(0, curr_valid_loss))
  *         return(X_valid, y_valid, curr_valid_answer)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_verbose); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 362, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_verbose); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 362, __pyx_L1_error)
+  __pyx_t_10 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_10) {
 
-    /* "structureboost/structure_gb.pyx":363
+    /* "structureboost/structure_gb.pyx":361
  *         curr_valid_loss = self._compute_loss(y_valid, curr_valid_answer)
  *         if self.verbose:
  *             print("i={}, eval_set_loss = {}".format(0, curr_valid_loss))             # <<<<<<<<<<<<<<
  *         return(X_valid, y_valid, curr_valid_answer)
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_i_eval_set_loss, __pyx_n_s_format); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 363, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_i_eval_set_loss, __pyx_n_s_format); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_2 = NULL;
     __pyx_t_9 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -10478,82 +10465,82 @@
         __Pyx_DECREF_SET(__pyx_t_3, function);
         __pyx_t_9 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_int_0, __pyx_v_curr_valid_loss};
-      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 361, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_GOTREF(__pyx_t_1);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_int_0, __pyx_v_curr_valid_loss};
-      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 361, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_GOTREF(__pyx_t_1);
     } else
     #endif
     {
-      __pyx_t_6 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __pyx_t_6 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 361, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       if (__pyx_t_2) {
         __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_2); __pyx_t_2 = NULL;
       }
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_9, __pyx_int_0);
       __Pyx_INCREF(__pyx_v_curr_valid_loss);
       __Pyx_GIVEREF(__pyx_v_curr_valid_loss);
       PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_9, __pyx_v_curr_valid_loss);
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 363, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 361, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 363, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "structureboost/structure_gb.pyx":362
+    /* "structureboost/structure_gb.pyx":360
  *         curr_valid_answer = self._get_initial_pred(X_valid, y_train)
  *         curr_valid_loss = self._compute_loss(y_valid, curr_valid_answer)
  *         if self.verbose:             # <<<<<<<<<<<<<<
  *             print("i={}, eval_set_loss = {}".format(0, curr_valid_loss))
  *         return(X_valid, y_valid, curr_valid_answer)
  */
   }
 
-  /* "structureboost/structure_gb.pyx":364
+  /* "structureboost/structure_gb.pyx":362
  *         if self.verbose:
  *             print("i={}, eval_set_loss = {}".format(0, curr_valid_loss))
  *         return(X_valid, y_valid, curr_valid_answer)             # <<<<<<<<<<<<<<
  * 
  *     def _output_no_evalset(self, index):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 364, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 362, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_X_valid);
   __Pyx_GIVEREF(__pyx_v_X_valid);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_X_valid);
   __Pyx_INCREF(__pyx_v_y_valid);
   __Pyx_GIVEREF(__pyx_v_y_valid);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_y_valid);
   __Pyx_INCREF(__pyx_v_curr_valid_answer);
   __Pyx_GIVEREF(__pyx_v_curr_valid_answer);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_v_curr_valid_answer);
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":351
+  /* "structureboost/structure_gb.pyx":349
  *                                         decimals=self.prec_digits)))
  * 
  *     def _init_eval_set_info(self, eval_set, y_train):             # <<<<<<<<<<<<<<
  *         self.eval_results = np.zeros(np.floor(
  *                                 self.num_trees/self.eval_freq).astype(int))
  */
 
@@ -10576,15 +10563,15 @@
   __Pyx_XDECREF(__pyx_v_curr_valid_loss);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":366
+/* "structureboost/structure_gb.pyx":364
  *         return(X_valid, y_valid, curr_valid_answer)
  * 
  *     def _output_no_evalset(self, index):             # <<<<<<<<<<<<<<
  *         if (((index+1) % self.eval_freq == 1) and self.verbose):
  *                 print("i={}".format(index))
  */
 
@@ -10619,32 +10606,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_index)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_output_no_evalset", 1, 2, 2, 1); __PYX_ERR(0, 366, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_output_no_evalset", 1, 2, 2, 1); __PYX_ERR(0, 364, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_output_no_evalset") < 0)) __PYX_ERR(0, 366, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_output_no_evalset") < 0)) __PYX_ERR(0, 364, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_index = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_output_no_evalset", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 366, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_output_no_evalset", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 364, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost._output_no_evalset", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_28_output_no_evalset(__pyx_self, __pyx_v_self, __pyx_v_index);
 
@@ -10663,88 +10650,88 @@
   PyObject *__pyx_t_4 = NULL;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__17)
   __Pyx_RefNannySetupContext("_output_no_evalset", 0);
-  __Pyx_TraceCall("_output_no_evalset", __pyx_f[0], 366, 0, __PYX_ERR(0, 366, __pyx_L1_error));
+  __Pyx_TraceCall("_output_no_evalset", __pyx_f[0], 364, 0, __PYX_ERR(0, 364, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":367
+  /* "structureboost/structure_gb.pyx":365
  * 
  *     def _output_no_evalset(self, index):
  *         if (((index+1) % self.eval_freq == 1) and self.verbose):             # <<<<<<<<<<<<<<
  *                 print("i={}".format(index))
  * 
  */
-  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_index, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 367, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_index, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_eval_freq); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 367, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_eval_freq); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyNumber_Remainder(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 367, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Remainder(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_t_4, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 367, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_t_4, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 367, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_5) {
   } else {
     __pyx_t_1 = __pyx_t_5;
     goto __pyx_L4_bool_binop_done;
   }
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_verbose); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 367, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_verbose); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 367, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_1 = __pyx_t_5;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "structureboost/structure_gb.pyx":368
+    /* "structureboost/structure_gb.pyx":366
  *     def _output_no_evalset(self, index):
  *         if (((index+1) % self.eval_freq == 1) and self.verbose):
  *                 print("i={}".format(index))             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_i_2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 368, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_kp_u_i_2, __pyx_n_s_format); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_3 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_v_index) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_index);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 368, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 366, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 368, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_builtin_print, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "structureboost/structure_gb.pyx":367
+    /* "structureboost/structure_gb.pyx":365
  * 
  *     def _output_no_evalset(self, index):
  *         if (((index+1) % self.eval_freq == 1) and self.verbose):             # <<<<<<<<<<<<<<
  *                 print("i={}".format(index))
  * 
  */
   }
 
-  /* "structureboost/structure_gb.pyx":366
+  /* "structureboost/structure_gb.pyx":364
  *         return(X_valid, y_valid, curr_valid_answer)
  * 
  *     def _output_no_evalset(self, index):             # <<<<<<<<<<<<<<
  *         if (((index+1) % self.eval_freq == 1) and self.verbose):
  *                 print("i={}".format(index))
  */
 
@@ -10760,15 +10747,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":371
+/* "structureboost/structure_gb.pyx":369
  * 
  * 
  *     def fit(self, X_train, y_train, eval_set=None, eval_freq=10,             # <<<<<<<<<<<<<<
  *             early_stop_past_steps=0, choose_best_eval=True, verbose=1):
  *         """Fits the model given training features and labels.
  */
 
@@ -10794,15 +10781,15 @@
   {
     static PyObject **__pyx_pyargnames[] = {&__pyx_n_s_self,&__pyx_n_s_X_train,&__pyx_n_s_y_train,&__pyx_n_s_eval_set,&__pyx_n_s_eval_freq,&__pyx_n_s_early_stop_past_steps,&__pyx_n_s_choose_best_eval,&__pyx_n_s_verbose,0};
     PyObject* values[8] = {0,0,0,0,0,0,0,0};
     values[3] = ((PyObject *)((PyObject *)Py_None));
     values[4] = ((PyObject *)((PyObject *)__pyx_int_10));
     values[5] = ((PyObject *)((PyObject *)__pyx_int_0));
 
-    /* "structureboost/structure_gb.pyx":372
+    /* "structureboost/structure_gb.pyx":370
  * 
  *     def fit(self, X_train, y_train, eval_set=None, eval_freq=10,
  *             early_stop_past_steps=0, choose_best_eval=True, verbose=1):             # <<<<<<<<<<<<<<
  *         """Fits the model given training features and labels.
  * 
  */
     values[6] = ((PyObject *)((PyObject *)Py_True));
@@ -10835,21 +10822,21 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X_train)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("fit", 0, 3, 8, 1); __PYX_ERR(0, 371, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("fit", 0, 3, 8, 1); __PYX_ERR(0, 369, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_train)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("fit", 0, 3, 8, 2); __PYX_ERR(0, 371, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("fit", 0, 3, 8, 2); __PYX_ERR(0, 369, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_eval_set);
           if (value) { values[3] = value; kw_args--; }
         }
@@ -10875,15 +10862,15 @@
         case  7:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_verbose);
           if (value) { values[7] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "fit") < 0)) __PYX_ERR(0, 371, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "fit") < 0)) __PYX_ERR(0, 369, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  8: values[7] = PyTuple_GET_ITEM(__pyx_args, 7);
         CYTHON_FALLTHROUGH;
         case  7: values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
         CYTHON_FALLTHROUGH;
@@ -10907,23 +10894,23 @@
     __pyx_v_eval_freq = values[4];
     __pyx_v_early_stop_past_steps = values[5];
     __pyx_v_choose_best_eval = values[6];
     __pyx_v_verbose = values[7];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("fit", 0, 3, 8, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 371, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("fit", 0, 3, 8, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 369, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost.fit", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_30fit(__pyx_self, __pyx_v_self, __pyx_v_X_train, __pyx_v_y_train, __pyx_v_eval_set, __pyx_v_eval_freq, __pyx_v_early_stop_past_steps, __pyx_v_choose_best_eval, __pyx_v_verbose);
 
-  /* "structureboost/structure_gb.pyx":371
+  /* "structureboost/structure_gb.pyx":369
  * 
  * 
  *     def fit(self, X_train, y_train, eval_set=None, eval_freq=10,             # <<<<<<<<<<<<<<
  *             early_stop_past_steps=0, choose_best_eval=True, verbose=1):
  *         """Fits the model given training features and labels.
  */
 
@@ -10967,108 +10954,108 @@
   PyObject *__pyx_t_14 = NULL;
   PyObject *__pyx_t_15 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__18)
   __Pyx_RefNannySetupContext("fit", 0);
-  __Pyx_TraceCall("fit", __pyx_f[0], 371, 0, __PYX_ERR(0, 371, __pyx_L1_error));
+  __Pyx_TraceCall("fit", __pyx_f[0], 369, 0, __PYX_ERR(0, 369, __pyx_L1_error));
   __Pyx_INCREF(__pyx_v_y_train);
 
-  /* "structureboost/structure_gb.pyx":423
+  /* "structureboost/structure_gb.pyx":421
  *             trees.
  *         """
  *         np.random.seed(self.random_seed)             # <<<<<<<<<<<<<<
  *         random.seed(self.random_seed)
  *         if self.feature_configs is None:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 423, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 423, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_seed); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 423, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_seed); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_random_seed); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 423, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_random_seed); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 423, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":424
+  /* "structureboost/structure_gb.pyx":422
  *         """
  *         np.random.seed(self.random_seed)
  *         random.seed(self.random_seed)             # <<<<<<<<<<<<<<
  *         if self.feature_configs is None:
  *             self.feature_configs = get_basic_config(X_train,self.default_configs)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_seed); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_seed); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_random_seed); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_random_seed); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 424, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 422, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":425
+  /* "structureboost/structure_gb.pyx":423
  *         np.random.seed(self.random_seed)
  *         random.seed(self.random_seed)
  *         if self.feature_configs is None:             # <<<<<<<<<<<<<<
  *             self.feature_configs = get_basic_config(X_train,self.default_configs)
  *             self._process_feature_configs()
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 425, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 423, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_5 = (__pyx_t_1 == Py_None);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_6 = (__pyx_t_5 != 0);
   if (__pyx_t_6) {
 
-    /* "structureboost/structure_gb.pyx":426
+    /* "structureboost/structure_gb.pyx":424
  *         random.seed(self.random_seed)
  *         if self.feature_configs is None:
  *             self.feature_configs = get_basic_config(X_train,self.default_configs)             # <<<<<<<<<<<<<<
  *             self._process_feature_configs()
  *             self.feat_list_full = list(self.feature_configs.keys())
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_get_basic_config); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 426, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_get_basic_config); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 424, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_default_configs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 426, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_default_configs); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 424, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_4 = NULL;
     __pyx_t_7 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -11077,295 +11064,295 @@
         __Pyx_DECREF_SET(__pyx_t_3, function);
         __pyx_t_7 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_X_train, __pyx_t_2};
-      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 426, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 424, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_X_train, __pyx_t_2};
-      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 426, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 424, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     } else
     #endif
     {
-      __pyx_t_8 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 426, __pyx_L1_error)
+      __pyx_t_8 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 424, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       if (__pyx_t_4) {
         __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_4); __pyx_t_4 = NULL;
       }
       __Pyx_INCREF(__pyx_v_X_train);
       __Pyx_GIVEREF(__pyx_v_X_train);
       PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_v_X_train);
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, __pyx_t_2);
       __pyx_t_2 = 0;
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 426, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 424, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs, __pyx_t_1) < 0) __PYX_ERR(0, 426, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs, __pyx_t_1) < 0) __PYX_ERR(0, 424, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":427
+    /* "structureboost/structure_gb.pyx":425
  *         if self.feature_configs is None:
  *             self.feature_configs = get_basic_config(X_train,self.default_configs)
  *             self._process_feature_configs()             # <<<<<<<<<<<<<<
  *             self.feat_list_full = list(self.feature_configs.keys())
  *         self.dec_tree_list = []
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_process_feature_configs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 427, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_process_feature_configs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 425, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_8 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_8);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_1 = (__pyx_t_8) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_8) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 427, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 425, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":428
+    /* "structureboost/structure_gb.pyx":426
  *             self.feature_configs = get_basic_config(X_train,self.default_configs)
  *             self._process_feature_configs()
  *             self.feat_list_full = list(self.feature_configs.keys())             # <<<<<<<<<<<<<<
  *         self.dec_tree_list = []
  *         self.verbose = verbose
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 428, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 426, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_keys); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 428, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_keys); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 426, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_8))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_8);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_8, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_8);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 428, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 426, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 428, __pyx_L1_error)
+    __pyx_t_8 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 426, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_feat_list_full, __pyx_t_8) < 0) __PYX_ERR(0, 428, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_feat_list_full, __pyx_t_8) < 0) __PYX_ERR(0, 426, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "structureboost/structure_gb.pyx":425
+    /* "structureboost/structure_gb.pyx":423
  *         np.random.seed(self.random_seed)
  *         random.seed(self.random_seed)
  *         if self.feature_configs is None:             # <<<<<<<<<<<<<<
  *             self.feature_configs = get_basic_config(X_train,self.default_configs)
  *             self._process_feature_configs()
  */
   }
 
-  /* "structureboost/structure_gb.pyx":429
+  /* "structureboost/structure_gb.pyx":427
  *             self._process_feature_configs()
  *             self.feat_list_full = list(self.feature_configs.keys())
  *         self.dec_tree_list = []             # <<<<<<<<<<<<<<
  *         self.verbose = verbose
  *         self.early_stop_past_steps = early_stop_past_steps
  */
-  __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 429, __pyx_L1_error)
+  __pyx_t_8 = PyList_New(0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 427, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list, __pyx_t_8) < 0) __PYX_ERR(0, 429, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list, __pyx_t_8) < 0) __PYX_ERR(0, 427, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-  /* "structureboost/structure_gb.pyx":430
+  /* "structureboost/structure_gb.pyx":428
  *             self.feat_list_full = list(self.feature_configs.keys())
  *         self.dec_tree_list = []
  *         self.verbose = verbose             # <<<<<<<<<<<<<<
  *         self.early_stop_past_steps = early_stop_past_steps
  *         self.eval_freq = eval_freq
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_verbose, __pyx_v_verbose) < 0) __PYX_ERR(0, 430, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_verbose, __pyx_v_verbose) < 0) __PYX_ERR(0, 428, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":431
+  /* "structureboost/structure_gb.pyx":429
  *         self.dec_tree_list = []
  *         self.verbose = verbose
  *         self.early_stop_past_steps = early_stop_past_steps             # <<<<<<<<<<<<<<
  *         self.eval_freq = eval_freq
  *         self.choose_best_eval = choose_best_eval
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_early_stop_past_steps, __pyx_v_early_stop_past_steps) < 0) __PYX_ERR(0, 431, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_early_stop_past_steps, __pyx_v_early_stop_past_steps) < 0) __PYX_ERR(0, 429, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":432
+  /* "structureboost/structure_gb.pyx":430
  *         self.verbose = verbose
  *         self.early_stop_past_steps = early_stop_past_steps
  *         self.eval_freq = eval_freq             # <<<<<<<<<<<<<<
  *         self.choose_best_eval = choose_best_eval
  *         self.has_eval_set = (eval_set is not None)
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_eval_freq, __pyx_v_eval_freq) < 0) __PYX_ERR(0, 432, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_eval_freq, __pyx_v_eval_freq) < 0) __PYX_ERR(0, 430, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":433
+  /* "structureboost/structure_gb.pyx":431
  *         self.early_stop_past_steps = early_stop_past_steps
  *         self.eval_freq = eval_freq
  *         self.choose_best_eval = choose_best_eval             # <<<<<<<<<<<<<<
  *         self.has_eval_set = (eval_set is not None)
  *         num_rows = X_train.shape[0]
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_choose_best_eval, __pyx_v_choose_best_eval) < 0) __PYX_ERR(0, 433, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_choose_best_eval, __pyx_v_choose_best_eval) < 0) __PYX_ERR(0, 431, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":434
+  /* "structureboost/structure_gb.pyx":432
  *         self.eval_freq = eval_freq
  *         self.choose_best_eval = choose_best_eval
  *         self.has_eval_set = (eval_set is not None)             # <<<<<<<<<<<<<<
  *         num_rows = X_train.shape[0]
  *         col_list = list(X_train.columns)
  */
   __pyx_t_6 = (__pyx_v_eval_set != Py_None);
-  __pyx_t_8 = __Pyx_PyBool_FromLong(__pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 434, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyBool_FromLong(__pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 432, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_has_eval_set, __pyx_t_8) < 0) __PYX_ERR(0, 434, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_has_eval_set, __pyx_t_8) < 0) __PYX_ERR(0, 432, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-  /* "structureboost/structure_gb.pyx":435
+  /* "structureboost/structure_gb.pyx":433
  *         self.choose_best_eval = choose_best_eval
  *         self.has_eval_set = (eval_set is not None)
  *         num_rows = X_train.shape[0]             # <<<<<<<<<<<<<<
  *         col_list = list(X_train.columns)
  *         self.column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}
  */
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_train, __pyx_n_s_shape); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 435, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_train, __pyx_n_s_shape); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 433, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_8, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 435, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_8, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 433, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   __pyx_v_num_rows = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":436
+  /* "structureboost/structure_gb.pyx":434
  *         self.has_eval_set = (eval_set is not None)
  *         num_rows = X_train.shape[0]
  *         col_list = list(X_train.columns)             # <<<<<<<<<<<<<<
  *         self.column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}
  *         self._initialize_uv_dict(X_train)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_train, __pyx_n_s_columns); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 436, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_train, __pyx_n_s_columns); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 434, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_8 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 436, __pyx_L1_error)
+  __pyx_t_8 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 434, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_col_list = ((PyObject*)__pyx_t_8);
   __pyx_t_8 = 0;
 
-  /* "structureboost/structure_gb.pyx":437
+  /* "structureboost/structure_gb.pyx":435
  *         num_rows = X_train.shape[0]
  *         col_list = list(X_train.columns)
  *         self.column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}             # <<<<<<<<<<<<<<
  *         self._initialize_uv_dict(X_train)
  * 
  */
   { /* enter inner scope */
-    __pyx_t_8 = PyDict_New(); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 437, __pyx_L1_error)
+    __pyx_t_8 = PyDict_New(); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_9 = PyList_GET_SIZE(__pyx_v_col_list); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 437, __pyx_L1_error)
+    __pyx_t_9 = PyList_GET_SIZE(__pyx_v_col_list); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 435, __pyx_L1_error)
     __pyx_t_10 = __pyx_t_9;
     for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
       __pyx_7genexpr__pyx_v_i = __pyx_t_11;
-      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_col_list, __pyx_7genexpr__pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 437, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt_List(__pyx_v_col_list, __pyx_7genexpr__pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 1, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 435, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = PyInt_FromSsize_t(__pyx_7genexpr__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 437, __pyx_L1_error)
+      __pyx_t_3 = PyInt_FromSsize_t(__pyx_7genexpr__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 435, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      if (unlikely(PyDict_SetItem(__pyx_t_8, (PyObject*)__pyx_t_1, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 437, __pyx_L1_error)
+      if (unlikely(PyDict_SetItem(__pyx_t_8, (PyObject*)__pyx_t_1, (PyObject*)__pyx_t_3))) __PYX_ERR(0, 435, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
   } /* exit inner scope */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_column_to_int_dict, __pyx_t_8) < 0) __PYX_ERR(0, 437, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_column_to_int_dict, __pyx_t_8) < 0) __PYX_ERR(0, 435, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-  /* "structureboost/structure_gb.pyx":438
+  /* "structureboost/structure_gb.pyx":436
  *         col_list = list(X_train.columns)
  *         self.column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}
  *         self._initialize_uv_dict(X_train)             # <<<<<<<<<<<<<<
  * 
  *         y_train = self._process_y_data(y_train)
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initialize_uv_dict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 438, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initialize_uv_dict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_1 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_1)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_1);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_8 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_v_X_train) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_X_train);
   __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 438, __pyx_L1_error)
+  if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 436, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-  /* "structureboost/structure_gb.pyx":440
+  /* "structureboost/structure_gb.pyx":438
  *         self._initialize_uv_dict(X_train)
  * 
  *         y_train = self._process_y_data(y_train)             # <<<<<<<<<<<<<<
  *         self.initial_pred = self._get_initial_pred(X_train, y_train)
  *         curr_answer = self.initial_pred
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_process_y_data); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 440, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_process_y_data); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 438, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_1 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_1)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_1);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_8 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_1, __pyx_v_y_train) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_y_train);
   __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 440, __pyx_L1_error)
+  if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 438, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF_SET(__pyx_v_y_train, __pyx_t_8);
   __pyx_t_8 = 0;
 
-  /* "structureboost/structure_gb.pyx":441
+  /* "structureboost/structure_gb.pyx":439
  * 
  *         y_train = self._process_y_data(y_train)
  *         self.initial_pred = self._get_initial_pred(X_train, y_train)             # <<<<<<<<<<<<<<
  *         curr_answer = self.initial_pred
  *         if self.has_eval_set:
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_initial_pred); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_initial_pred); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 439, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_1 = NULL;
   __pyx_t_7 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_1)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -11374,83 +11361,83 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_7 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_X_train, __pyx_v_y_train};
-    __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 441, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 439, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_GOTREF(__pyx_t_8);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_v_X_train, __pyx_v_y_train};
-    __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 441, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 439, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_GOTREF(__pyx_t_8);
   } else
   #endif
   {
-    __pyx_t_2 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 441, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 439, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     if (__pyx_t_1) {
       __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1); __pyx_t_1 = NULL;
     }
     __Pyx_INCREF(__pyx_v_X_train);
     __Pyx_GIVEREF(__pyx_v_X_train);
     PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_7, __pyx_v_X_train);
     __Pyx_INCREF(__pyx_v_y_train);
     __Pyx_GIVEREF(__pyx_v_y_train);
     PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_7, __pyx_v_y_train);
-    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 441, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_2, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 439, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_initial_pred, __pyx_t_8) < 0) __PYX_ERR(0, 441, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_initial_pred, __pyx_t_8) < 0) __PYX_ERR(0, 439, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-  /* "structureboost/structure_gb.pyx":442
+  /* "structureboost/structure_gb.pyx":440
  *         y_train = self._process_y_data(y_train)
  *         self.initial_pred = self._get_initial_pred(X_train, y_train)
  *         curr_answer = self.initial_pred             # <<<<<<<<<<<<<<
  *         if self.has_eval_set:
  *             X_valid, y_valid, curr_valid_answer = self._init_eval_set_info(
  */
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_pred); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_pred); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 440, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __pyx_v_curr_answer = __pyx_t_8;
   __pyx_t_8 = 0;
 
-  /* "structureboost/structure_gb.pyx":443
+  /* "structureboost/structure_gb.pyx":441
  *         self.initial_pred = self._get_initial_pred(X_train, y_train)
  *         curr_answer = self.initial_pred
  *         if self.has_eval_set:             # <<<<<<<<<<<<<<
  *             X_valid, y_valid, curr_valid_answer = self._init_eval_set_info(
  *                                                             eval_set, y_train)
  */
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_has_eval_set); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_has_eval_set); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 441, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 441, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   if (__pyx_t_6) {
 
-    /* "structureboost/structure_gb.pyx":444
+    /* "structureboost/structure_gb.pyx":442
  *         curr_answer = self.initial_pred
  *         if self.has_eval_set:
  *             X_valid, y_valid, curr_valid_answer = self._init_eval_set_info(             # <<<<<<<<<<<<<<
  *                                                             eval_set, y_train)
  * 
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_init_eval_set_info); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 444, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_init_eval_set_info); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 442, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
 
-    /* "structureboost/structure_gb.pyx":445
+    /* "structureboost/structure_gb.pyx":443
  *         if self.has_eval_set:
  *             X_valid, y_valid, curr_valid_answer = self._init_eval_set_info(
  *                                                             eval_set, y_train)             # <<<<<<<<<<<<<<
  * 
  *         # Main loop to build trees
  */
     __pyx_t_2 = NULL;
@@ -11464,51 +11451,51 @@
         __Pyx_DECREF_SET(__pyx_t_3, function);
         __pyx_t_7 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_v_eval_set, __pyx_v_y_train};
-      __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 444, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 442, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_GOTREF(__pyx_t_8);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_v_eval_set, __pyx_v_y_train};
-      __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 444, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 442, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_GOTREF(__pyx_t_8);
     } else
     #endif
     {
-      __pyx_t_1 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 444, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 442, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (__pyx_t_2) {
         __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2); __pyx_t_2 = NULL;
       }
       __Pyx_INCREF(__pyx_v_eval_set);
       __Pyx_GIVEREF(__pyx_v_eval_set);
       PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_7, __pyx_v_eval_set);
       __Pyx_INCREF(__pyx_v_y_train);
       __Pyx_GIVEREF(__pyx_v_y_train);
       PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_7, __pyx_v_y_train);
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 444, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 442, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if ((likely(PyTuple_CheckExact(__pyx_t_8))) || (PyList_CheckExact(__pyx_t_8))) {
       PyObject* sequence = __pyx_t_8;
       Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
       if (unlikely(size != 3)) {
         if (size > 3) __Pyx_RaiseTooManyValuesError(3);
         else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-        __PYX_ERR(0, 444, __pyx_L1_error)
+        __PYX_ERR(0, 442, __pyx_L1_error)
       }
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
       if (likely(PyTuple_CheckExact(sequence))) {
         __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
         __pyx_t_1 = PyTuple_GET_ITEM(sequence, 1); 
         __pyx_t_2 = PyTuple_GET_ITEM(sequence, 2); 
       } else {
@@ -11516,142 +11503,142 @@
         __pyx_t_1 = PyList_GET_ITEM(sequence, 1); 
         __pyx_t_2 = PyList_GET_ITEM(sequence, 2); 
       }
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_t_2);
       #else
-      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 444, __pyx_L1_error)
+      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 442, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 444, __pyx_L1_error)
+      __pyx_t_1 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 442, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 444, __pyx_L1_error)
+      __pyx_t_2 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 442, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       #endif
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     } else {
       Py_ssize_t index = -1;
-      __pyx_t_4 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 444, __pyx_L1_error)
+      __pyx_t_4 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 442, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __pyx_t_12 = Py_TYPE(__pyx_t_4)->tp_iternext;
       index = 0; __pyx_t_3 = __pyx_t_12(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L7_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_3);
       index = 1; __pyx_t_1 = __pyx_t_12(__pyx_t_4); if (unlikely(!__pyx_t_1)) goto __pyx_L7_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_1);
       index = 2; __pyx_t_2 = __pyx_t_12(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L7_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_2);
-      if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_4), 3) < 0) __PYX_ERR(0, 444, __pyx_L1_error)
+      if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_4), 3) < 0) __PYX_ERR(0, 442, __pyx_L1_error)
       __pyx_t_12 = NULL;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       goto __pyx_L8_unpacking_done;
       __pyx_L7_unpacking_failed:;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_12 = NULL;
       if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-      __PYX_ERR(0, 444, __pyx_L1_error)
+      __PYX_ERR(0, 442, __pyx_L1_error)
       __pyx_L8_unpacking_done:;
     }
 
-    /* "structureboost/structure_gb.pyx":444
+    /* "structureboost/structure_gb.pyx":442
  *         curr_answer = self.initial_pred
  *         if self.has_eval_set:
  *             X_valid, y_valid, curr_valid_answer = self._init_eval_set_info(             # <<<<<<<<<<<<<<
  *                                                             eval_set, y_train)
  * 
  */
     __pyx_v_X_valid = __pyx_t_3;
     __pyx_t_3 = 0;
     __pyx_v_y_valid = __pyx_t_1;
     __pyx_t_1 = 0;
     __pyx_v_curr_valid_answer = __pyx_t_2;
     __pyx_t_2 = 0;
 
-    /* "structureboost/structure_gb.pyx":443
+    /* "structureboost/structure_gb.pyx":441
  *         self.initial_pred = self._get_initial_pred(X_train, y_train)
  *         curr_answer = self.initial_pred
  *         if self.has_eval_set:             # <<<<<<<<<<<<<<
  *             X_valid, y_valid, curr_valid_answer = self._init_eval_set_info(
  *                                                             eval_set, y_train)
  */
   }
 
-  /* "structureboost/structure_gb.pyx":448
+  /* "structureboost/structure_gb.pyx":446
  * 
  *         # Main loop to build trees
  *         stop_now = False             # <<<<<<<<<<<<<<
  *         for i in range(self.num_trees):
  *             curr_answer = self._update_curr_answer(curr_answer, X_train, i)
  */
   __Pyx_INCREF(Py_False);
   __pyx_v_stop_now = Py_False;
 
-  /* "structureboost/structure_gb.pyx":449
+  /* "structureboost/structure_gb.pyx":447
  *         # Main loop to build trees
  *         stop_now = False
  *         for i in range(self.num_trees):             # <<<<<<<<<<<<<<
  *             curr_answer = self._update_curr_answer(curr_answer, X_train, i)
  *             # handle eval_set / early_stopping related tasks
  */
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_trees); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 449, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_trees); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 447, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 449, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 447, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
     __pyx_t_8 = __pyx_t_2; __Pyx_INCREF(__pyx_t_8); __pyx_t_9 = 0;
     __pyx_t_13 = NULL;
   } else {
-    __pyx_t_9 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 449, __pyx_L1_error)
+    __pyx_t_9 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 447, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_13 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 449, __pyx_L1_error)
+    __pyx_t_13 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 447, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   for (;;) {
     if (likely(!__pyx_t_13)) {
       if (likely(PyList_CheckExact(__pyx_t_8))) {
         if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_8)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_9); __Pyx_INCREF(__pyx_t_2); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 449, __pyx_L1_error)
+        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_9); __Pyx_INCREF(__pyx_t_2); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 447, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_8, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 449, __pyx_L1_error)
+        __pyx_t_2 = PySequence_ITEM(__pyx_t_8, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 447, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
       } else {
         if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_9); __Pyx_INCREF(__pyx_t_2); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 449, __pyx_L1_error)
+        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_9); __Pyx_INCREF(__pyx_t_2); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 447, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_8, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 449, __pyx_L1_error)
+        __pyx_t_2 = PySequence_ITEM(__pyx_t_8, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 447, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
       }
     } else {
       __pyx_t_2 = __pyx_t_13(__pyx_t_8);
       if (unlikely(!__pyx_t_2)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 449, __pyx_L1_error)
+          else __PYX_ERR(0, 447, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_2);
     }
     __Pyx_XDECREF_SET(__pyx_v_i, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "structureboost/structure_gb.pyx":450
+    /* "structureboost/structure_gb.pyx":448
  *         stop_now = False
  *         for i in range(self.num_trees):
  *             curr_answer = self._update_curr_answer(curr_answer, X_train, i)             # <<<<<<<<<<<<<<
  *             # handle eval_set / early_stopping related tasks
  *             if self.has_eval_set:
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_update_curr_answer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 450, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_update_curr_answer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 448, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_3 = NULL;
     __pyx_t_7 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -11660,82 +11647,82 @@
         __Pyx_DECREF_SET(__pyx_t_1, function);
         __pyx_t_7 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_1)) {
       PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_v_curr_answer, __pyx_v_X_train, __pyx_v_i};
-      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 450, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 448, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_GOTREF(__pyx_t_2);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
       PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_v_curr_answer, __pyx_v_X_train, __pyx_v_i};
-      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 450, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 448, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_GOTREF(__pyx_t_2);
     } else
     #endif
     {
-      __pyx_t_4 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 450, __pyx_L1_error)
+      __pyx_t_4 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 448, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       if (__pyx_t_3) {
         __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
       }
       __Pyx_INCREF(__pyx_v_curr_answer);
       __Pyx_GIVEREF(__pyx_v_curr_answer);
       PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_7, __pyx_v_curr_answer);
       __Pyx_INCREF(__pyx_v_X_train);
       __Pyx_GIVEREF(__pyx_v_X_train);
       PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_7, __pyx_v_X_train);
       __Pyx_INCREF(__pyx_v_i);
       __Pyx_GIVEREF(__pyx_v_i);
       PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_7, __pyx_v_i);
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 450, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 448, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF_SET(__pyx_v_curr_answer, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "structureboost/structure_gb.pyx":452
+    /* "structureboost/structure_gb.pyx":450
  *             curr_answer = self._update_curr_answer(curr_answer, X_train, i)
  *             # handle eval_set / early_stopping related tasks
  *             if self.has_eval_set:             # <<<<<<<<<<<<<<
  *                 curr_valid_answer = self._update_curr_answer(curr_valid_answer,
  *                                                     X_valid, i)
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_has_eval_set); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 452, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_has_eval_set); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 450, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 452, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 450, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (__pyx_t_6) {
 
-      /* "structureboost/structure_gb.pyx":453
+      /* "structureboost/structure_gb.pyx":451
  *             # handle eval_set / early_stopping related tasks
  *             if self.has_eval_set:
  *                 curr_valid_answer = self._update_curr_answer(curr_valid_answer,             # <<<<<<<<<<<<<<
  *                                                     X_valid, i)
  *                 stop_now = self._output_loss_check_stop(y_valid,
  */
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_update_curr_answer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 453, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_update_curr_answer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 451, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (unlikely(!__pyx_v_curr_valid_answer)) { __Pyx_RaiseUnboundLocalError("curr_valid_answer"); __PYX_ERR(0, 453, __pyx_L1_error) }
+      if (unlikely(!__pyx_v_curr_valid_answer)) { __Pyx_RaiseUnboundLocalError("curr_valid_answer"); __PYX_ERR(0, 451, __pyx_L1_error) }
 
-      /* "structureboost/structure_gb.pyx":454
+      /* "structureboost/structure_gb.pyx":452
  *             if self.has_eval_set:
  *                 curr_valid_answer = self._update_curr_answer(curr_valid_answer,
  *                                                     X_valid, i)             # <<<<<<<<<<<<<<
  *                 stop_now = self._output_loss_check_stop(y_valid,
  *                                     curr_valid_answer, i)
  */
-      if (unlikely(!__pyx_v_X_valid)) { __Pyx_RaiseUnboundLocalError("X_valid"); __PYX_ERR(0, 454, __pyx_L1_error) }
+      if (unlikely(!__pyx_v_X_valid)) { __Pyx_RaiseUnboundLocalError("X_valid"); __PYX_ERR(0, 452, __pyx_L1_error) }
       __pyx_t_4 = NULL;
       __pyx_t_7 = 0;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_4)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
           __Pyx_INCREF(__pyx_t_4);
@@ -11743,62 +11730,62 @@
           __Pyx_DECREF_SET(__pyx_t_1, function);
           __pyx_t_7 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_curr_valid_answer, __pyx_v_X_valid, __pyx_v_i};
-        __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 453, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 451, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_2);
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_curr_valid_answer, __pyx_v_X_valid, __pyx_v_i};
-        __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 453, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 451, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_GOTREF(__pyx_t_2);
       } else
       #endif
       {
-        __pyx_t_3 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 453, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 451, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         if (__pyx_t_4) {
           __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
         }
         __Pyx_INCREF(__pyx_v_curr_valid_answer);
         __Pyx_GIVEREF(__pyx_v_curr_valid_answer);
         PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_7, __pyx_v_curr_valid_answer);
         __Pyx_INCREF(__pyx_v_X_valid);
         __Pyx_GIVEREF(__pyx_v_X_valid);
         PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_7, __pyx_v_X_valid);
         __Pyx_INCREF(__pyx_v_i);
         __Pyx_GIVEREF(__pyx_v_i);
         PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_7, __pyx_v_i);
-        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 453, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 451, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_XDECREF_SET(__pyx_v_curr_valid_answer, __pyx_t_2);
       __pyx_t_2 = 0;
 
-      /* "structureboost/structure_gb.pyx":455
+      /* "structureboost/structure_gb.pyx":453
  *                 curr_valid_answer = self._update_curr_answer(curr_valid_answer,
  *                                                     X_valid, i)
  *                 stop_now = self._output_loss_check_stop(y_valid,             # <<<<<<<<<<<<<<
  *                                     curr_valid_answer, i)
  *                 if stop_now:
  */
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_output_loss_check_stop); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 455, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_output_loss_check_stop); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 453, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (unlikely(!__pyx_v_y_valid)) { __Pyx_RaiseUnboundLocalError("y_valid"); __PYX_ERR(0, 455, __pyx_L1_error) }
+      if (unlikely(!__pyx_v_y_valid)) { __Pyx_RaiseUnboundLocalError("y_valid"); __PYX_ERR(0, 453, __pyx_L1_error) }
 
-      /* "structureboost/structure_gb.pyx":456
+      /* "structureboost/structure_gb.pyx":454
  *                                                     X_valid, i)
  *                 stop_now = self._output_loss_check_stop(y_valid,
  *                                     curr_valid_answer, i)             # <<<<<<<<<<<<<<
  *                 if stop_now:
  *                     break
  */
       __pyx_t_3 = NULL;
@@ -11812,152 +11799,152 @@
           __Pyx_DECREF_SET(__pyx_t_1, function);
           __pyx_t_7 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_v_y_valid, __pyx_v_curr_valid_answer, __pyx_v_i};
-        __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 455, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 453, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_GOTREF(__pyx_t_2);
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
         PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_v_y_valid, __pyx_v_curr_valid_answer, __pyx_v_i};
-        __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 455, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 453, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_GOTREF(__pyx_t_2);
       } else
       #endif
       {
-        __pyx_t_4 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 455, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 453, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         if (__pyx_t_3) {
           __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
         }
         __Pyx_INCREF(__pyx_v_y_valid);
         __Pyx_GIVEREF(__pyx_v_y_valid);
         PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_7, __pyx_v_y_valid);
         __Pyx_INCREF(__pyx_v_curr_valid_answer);
         __Pyx_GIVEREF(__pyx_v_curr_valid_answer);
         PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_7, __pyx_v_curr_valid_answer);
         __Pyx_INCREF(__pyx_v_i);
         __Pyx_GIVEREF(__pyx_v_i);
         PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_7, __pyx_v_i);
-        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 455, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 453, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF_SET(__pyx_v_stop_now, __pyx_t_2);
       __pyx_t_2 = 0;
 
-      /* "structureboost/structure_gb.pyx":457
+      /* "structureboost/structure_gb.pyx":455
  *                 stop_now = self._output_loss_check_stop(y_valid,
  *                                     curr_valid_answer, i)
  *                 if stop_now:             # <<<<<<<<<<<<<<
  *                     break
  *             else:
  */
-      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_stop_now); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 457, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_stop_now); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 455, __pyx_L1_error)
       if (__pyx_t_6) {
 
-        /* "structureboost/structure_gb.pyx":458
+        /* "structureboost/structure_gb.pyx":456
  *                                     curr_valid_answer, i)
  *                 if stop_now:
  *                     break             # <<<<<<<<<<<<<<
  *             else:
  *                 self._output_no_evalset(i)
  */
         goto __pyx_L10_break;
 
-        /* "structureboost/structure_gb.pyx":457
+        /* "structureboost/structure_gb.pyx":455
  *                 stop_now = self._output_loss_check_stop(y_valid,
  *                                     curr_valid_answer, i)
  *                 if stop_now:             # <<<<<<<<<<<<<<
  *                     break
  *             else:
  */
       }
 
-      /* "structureboost/structure_gb.pyx":452
+      /* "structureboost/structure_gb.pyx":450
  *             curr_answer = self._update_curr_answer(curr_answer, X_train, i)
  *             # handle eval_set / early_stopping related tasks
  *             if self.has_eval_set:             # <<<<<<<<<<<<<<
  *                 curr_valid_answer = self._update_curr_answer(curr_valid_answer,
  *                                                     X_valid, i)
  */
       goto __pyx_L11;
     }
 
-    /* "structureboost/structure_gb.pyx":460
+    /* "structureboost/structure_gb.pyx":458
  *                     break
  *             else:
  *                 self._output_no_evalset(i)             # <<<<<<<<<<<<<<
  * 
  *             # Get first and second derivatives of loss fn for current prediction
  */
     /*else*/ {
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_output_no_evalset); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 460, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_output_no_evalset); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 458, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_t_4 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_4)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
           __Pyx_INCREF(__pyx_t_4);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
       __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_v_i) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_i);
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 460, __pyx_L1_error)
+      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 458, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __pyx_L11:;
 
-    /* "structureboost/structure_gb.pyx":463
+    /* "structureboost/structure_gb.pyx":461
  * 
  *             # Get first and second derivatives of loss fn for current prediction
  *             curr_answer = self.process_curr_answer(curr_answer)             # <<<<<<<<<<<<<<
  *             y_g_h_mat = self.compute_gh_mat(y_train, curr_answer, i)
  * 
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_process_curr_answer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 463, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_process_curr_answer); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 461, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_v_curr_answer) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_curr_answer);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 463, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 461, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF_SET(__pyx_v_curr_answer, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "structureboost/structure_gb.pyx":464
+    /* "structureboost/structure_gb.pyx":462
  *             # Get first and second derivatives of loss fn for current prediction
  *             curr_answer = self.process_curr_answer(curr_answer)
  *             y_g_h_mat = self.compute_gh_mat(y_train, curr_answer, i)             # <<<<<<<<<<<<<<
  * 
  *             # Determine rows and features to use for this tree
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_compute_gh_mat); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 464, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_compute_gh_mat); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 462, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_4 = NULL;
     __pyx_t_7 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -11966,157 +11953,157 @@
         __Pyx_DECREF_SET(__pyx_t_1, function);
         __pyx_t_7 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_1)) {
       PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_y_train, __pyx_v_curr_answer, __pyx_v_i};
-      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 464, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 462, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_2);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
       PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_y_train, __pyx_v_curr_answer, __pyx_v_i};
-      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 464, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 462, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_2);
     } else
     #endif
     {
-      __pyx_t_3 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 464, __pyx_L1_error)
+      __pyx_t_3 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 462, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       if (__pyx_t_4) {
         __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
       }
       __Pyx_INCREF(__pyx_v_y_train);
       __Pyx_GIVEREF(__pyx_v_y_train);
       PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_7, __pyx_v_y_train);
       __Pyx_INCREF(__pyx_v_curr_answer);
       __Pyx_GIVEREF(__pyx_v_curr_answer);
       PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_7, __pyx_v_curr_answer);
       __Pyx_INCREF(__pyx_v_i);
       __Pyx_GIVEREF(__pyx_v_i);
       PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_7, __pyx_v_i);
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 464, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 462, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF_SET(__pyx_v_y_g_h_mat, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "structureboost/structure_gb.pyx":467
+    /* "structureboost/structure_gb.pyx":465
  * 
  *             # Determine rows and features to use for this tree
  *             rows_to_use = self._get_rows_for_tree(num_rows)             # <<<<<<<<<<<<<<
  *             features_for_tree = self._get_features_for_tree()
  *             X_train_to_use = X_train.iloc[rows_to_use, :]
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_rows_for_tree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 467, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_rows_for_tree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 465, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_3, __pyx_v_num_rows) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_num_rows);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 467, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 465, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF_SET(__pyx_v_rows_to_use, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "structureboost/structure_gb.pyx":468
+    /* "structureboost/structure_gb.pyx":466
  *             # Determine rows and features to use for this tree
  *             rows_to_use = self._get_rows_for_tree(num_rows)
  *             features_for_tree = self._get_features_for_tree()             # <<<<<<<<<<<<<<
  *             X_train_to_use = X_train.iloc[rows_to_use, :]
  *             y_g_h_to_use = y_g_h_mat[rows_to_use, :]
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_features_for_tree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 468, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_features_for_tree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 466, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_1);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 468, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 466, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF_SET(__pyx_v_features_for_tree, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "structureboost/structure_gb.pyx":469
+    /* "structureboost/structure_gb.pyx":467
  *             rows_to_use = self._get_rows_for_tree(num_rows)
  *             features_for_tree = self._get_features_for_tree()
  *             X_train_to_use = X_train.iloc[rows_to_use, :]             # <<<<<<<<<<<<<<
  *             y_g_h_to_use = y_g_h_mat[rows_to_use, :]
  * 
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_train, __pyx_n_s_iloc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 469, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_train, __pyx_n_s_iloc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 467, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 469, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 467, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_rows_to_use);
     __Pyx_GIVEREF(__pyx_v_rows_to_use);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_rows_to_use);
     __Pyx_INCREF(__pyx_slice__5);
     __Pyx_GIVEREF(__pyx_slice__5);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_slice__5);
-    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 469, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 467, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_XDECREF_SET(__pyx_v_X_train_to_use, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "structureboost/structure_gb.pyx":470
+    /* "structureboost/structure_gb.pyx":468
  *             features_for_tree = self._get_features_for_tree()
  *             X_train_to_use = X_train.iloc[rows_to_use, :]
  *             y_g_h_to_use = y_g_h_mat[rows_to_use, :]             # <<<<<<<<<<<<<<
  * 
  *             # Add and train the next tree
  */
-    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 470, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 468, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_v_rows_to_use);
     __Pyx_GIVEREF(__pyx_v_rows_to_use);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_rows_to_use);
     __Pyx_INCREF(__pyx_slice__5);
     __Pyx_GIVEREF(__pyx_slice__5);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_slice__5);
-    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_y_g_h_mat, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 470, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_y_g_h_mat, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 468, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_XDECREF_SET(__pyx_v_y_g_h_to_use, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":473
+    /* "structureboost/structure_gb.pyx":471
  * 
  *             # Add and train the next tree
  *             self._add_train_next_tree(features_for_tree, X_train_to_use, y_g_h_to_use, i)             # <<<<<<<<<<<<<<
  * 
  *         # Post-processing steps
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_add_train_next_tree); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 473, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_add_train_next_tree); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 471, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_2 = NULL;
     __pyx_t_7 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -12125,29 +12112,29 @@
         __Pyx_DECREF_SET(__pyx_t_3, function);
         __pyx_t_7 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[5] = {__pyx_t_2, __pyx_v_features_for_tree, __pyx_v_X_train_to_use, __pyx_v_y_g_h_to_use, __pyx_v_i};
-      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 473, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 471, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_GOTREF(__pyx_t_1);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
       PyObject *__pyx_temp[5] = {__pyx_t_2, __pyx_v_features_for_tree, __pyx_v_X_train_to_use, __pyx_v_y_g_h_to_use, __pyx_v_i};
-      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 473, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_7, 4+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 471, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_GOTREF(__pyx_t_1);
     } else
     #endif
     {
-      __pyx_t_4 = PyTuple_New(4+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 473, __pyx_L1_error)
+      __pyx_t_4 = PyTuple_New(4+__pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 471, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       if (__pyx_t_2) {
         __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2); __pyx_t_2 = NULL;
       }
       __Pyx_INCREF(__pyx_v_features_for_tree);
       __Pyx_GIVEREF(__pyx_v_features_for_tree);
       PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_7, __pyx_v_features_for_tree);
@@ -12156,147 +12143,147 @@
       PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_7, __pyx_v_X_train_to_use);
       __Pyx_INCREF(__pyx_v_y_g_h_to_use);
       __Pyx_GIVEREF(__pyx_v_y_g_h_to_use);
       PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_7, __pyx_v_y_g_h_to_use);
       __Pyx_INCREF(__pyx_v_i);
       __Pyx_GIVEREF(__pyx_v_i);
       PyTuple_SET_ITEM(__pyx_t_4, 3+__pyx_t_7, __pyx_v_i);
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 473, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 471, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":449
+    /* "structureboost/structure_gb.pyx":447
  *         # Main loop to build trees
  *         stop_now = False
  *         for i in range(self.num_trees):             # <<<<<<<<<<<<<<
  *             curr_answer = self._update_curr_answer(curr_answer, X_train, i)
  *             # handle eval_set / early_stopping related tasks
  */
   }
   __pyx_L10_break:;
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-  /* "structureboost/structure_gb.pyx":476
+  /* "structureboost/structure_gb.pyx":474
  * 
  *         # Post-processing steps
  *         if self.na_unseen_action == 'weighted_random':             # <<<<<<<<<<<<<<
  *             self.rerandomize_na_dir_weighted_all_trees()
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_na_unseen_action); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 476, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_na_unseen_action); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 474, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_t_8, __pyx_n_u_weighted_random, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 476, __pyx_L1_error)
+  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_t_8, __pyx_n_u_weighted_random, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 474, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   if (__pyx_t_6) {
 
-    /* "structureboost/structure_gb.pyx":477
+    /* "structureboost/structure_gb.pyx":475
  *         # Post-processing steps
  *         if self.na_unseen_action == 'weighted_random':
  *             self.rerandomize_na_dir_weighted_all_trees()             # <<<<<<<<<<<<<<
  * 
  *         self.optimizable = np.all(np.array([dt.optimizable for dt in self.dec_tree_list]))
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_rerandomize_na_dir_weighted_all); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 477, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_rerandomize_na_dir_weighted_all); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 475, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_3);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_8 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_1);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 477, __pyx_L1_error)
+    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 475, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "structureboost/structure_gb.pyx":476
+    /* "structureboost/structure_gb.pyx":474
  * 
  *         # Post-processing steps
  *         if self.na_unseen_action == 'weighted_random':             # <<<<<<<<<<<<<<
  *             self.rerandomize_na_dir_weighted_all_trees()
  * 
  */
   }
 
-  /* "structureboost/structure_gb.pyx":479
+  /* "structureboost/structure_gb.pyx":477
  *             self.rerandomize_na_dir_weighted_all_trees()
  * 
  *         self.optimizable = np.all(np.array([dt.optimizable for dt in self.dec_tree_list]))             # <<<<<<<<<<<<<<
  *         if (self.optimizable):
  *             self.get_tensors_for_predict()
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 479, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_all); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 479, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_all); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 479, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 479, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   { /* enter inner scope */
-    __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 479, __pyx_L16_error)
+    __pyx_t_4 = PyList_New(0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 477, __pyx_L16_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 479, __pyx_L16_error)
+    __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 477, __pyx_L16_error)
     __Pyx_GOTREF(__pyx_t_14);
     if (likely(PyList_CheckExact(__pyx_t_14)) || PyTuple_CheckExact(__pyx_t_14)) {
       __pyx_t_15 = __pyx_t_14; __Pyx_INCREF(__pyx_t_15); __pyx_t_9 = 0;
       __pyx_t_13 = NULL;
     } else {
-      __pyx_t_9 = -1; __pyx_t_15 = PyObject_GetIter(__pyx_t_14); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 479, __pyx_L16_error)
+      __pyx_t_9 = -1; __pyx_t_15 = PyObject_GetIter(__pyx_t_14); if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 477, __pyx_L16_error)
       __Pyx_GOTREF(__pyx_t_15);
-      __pyx_t_13 = Py_TYPE(__pyx_t_15)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 479, __pyx_L16_error)
+      __pyx_t_13 = Py_TYPE(__pyx_t_15)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 477, __pyx_L16_error)
     }
     __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     for (;;) {
       if (likely(!__pyx_t_13)) {
         if (likely(PyList_CheckExact(__pyx_t_15))) {
           if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_15)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_14 = PyList_GET_ITEM(__pyx_t_15, __pyx_t_9); __Pyx_INCREF(__pyx_t_14); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 479, __pyx_L16_error)
+          __pyx_t_14 = PyList_GET_ITEM(__pyx_t_15, __pyx_t_9); __Pyx_INCREF(__pyx_t_14); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 477, __pyx_L16_error)
           #else
-          __pyx_t_14 = PySequence_ITEM(__pyx_t_15, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 479, __pyx_L16_error)
+          __pyx_t_14 = PySequence_ITEM(__pyx_t_15, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 477, __pyx_L16_error)
           __Pyx_GOTREF(__pyx_t_14);
           #endif
         } else {
           if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_15)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_14 = PyTuple_GET_ITEM(__pyx_t_15, __pyx_t_9); __Pyx_INCREF(__pyx_t_14); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 479, __pyx_L16_error)
+          __pyx_t_14 = PyTuple_GET_ITEM(__pyx_t_15, __pyx_t_9); __Pyx_INCREF(__pyx_t_14); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 477, __pyx_L16_error)
           #else
-          __pyx_t_14 = PySequence_ITEM(__pyx_t_15, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 479, __pyx_L16_error)
+          __pyx_t_14 = PySequence_ITEM(__pyx_t_15, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 477, __pyx_L16_error)
           __Pyx_GOTREF(__pyx_t_14);
           #endif
         }
       } else {
         __pyx_t_14 = __pyx_t_13(__pyx_t_15);
         if (unlikely(!__pyx_t_14)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 479, __pyx_L16_error)
+            else __PYX_ERR(0, 477, __pyx_L16_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_14);
       }
       __Pyx_XDECREF_SET(__pyx_8genexpr1__pyx_v_dt, __pyx_t_14);
       __pyx_t_14 = 0;
-      __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_8genexpr1__pyx_v_dt, __pyx_n_s_optimizable); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 479, __pyx_L16_error)
+      __pyx_t_14 = __Pyx_PyObject_GetAttrStr(__pyx_8genexpr1__pyx_v_dt, __pyx_n_s_optimizable); if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 477, __pyx_L16_error)
       __Pyx_GOTREF(__pyx_t_14);
-      if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_14))) __PYX_ERR(0, 479, __pyx_L16_error)
+      if (unlikely(__Pyx_ListComp_Append(__pyx_t_4, (PyObject*)__pyx_t_14))) __PYX_ERR(0, 477, __pyx_L16_error)
       __Pyx_DECREF(__pyx_t_14); __pyx_t_14 = 0;
     }
     __Pyx_DECREF(__pyx_t_15); __pyx_t_15 = 0;
     __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_dt); __pyx_8genexpr1__pyx_v_dt = 0;
     goto __pyx_L19_exit_scope;
     __pyx_L16_error:;
     __Pyx_XDECREF(__pyx_8genexpr1__pyx_v_dt); __pyx_8genexpr1__pyx_v_dt = 0;
@@ -12312,15 +12299,15 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_15) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_15, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 479, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -12328,69 +12315,69 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_8 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 479, __pyx_L1_error)
+  if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_optimizable, __pyx_t_8) < 0) __PYX_ERR(0, 479, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_optimizable, __pyx_t_8) < 0) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-  /* "structureboost/structure_gb.pyx":480
+  /* "structureboost/structure_gb.pyx":478
  * 
  *         self.optimizable = np.all(np.array([dt.optimizable for dt in self.dec_tree_list]))
  *         if (self.optimizable):             # <<<<<<<<<<<<<<
  *             self.get_tensors_for_predict()
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimizable); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 480, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimizable); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 478, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 480, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_8); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 478, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   if (__pyx_t_6) {
 
-    /* "structureboost/structure_gb.pyx":481
+    /* "structureboost/structure_gb.pyx":479
  *         self.optimizable = np.all(np.array([dt.optimizable for dt in self.dec_tree_list]))
  *         if (self.optimizable):
  *             self.get_tensors_for_predict()             # <<<<<<<<<<<<<<
  * 
  *     def predict(self, X_test, int num_trees_to_use=-1, same_col_pos=True):
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_tensors_for_predict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 481, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_tensors_for_predict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 479, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_8 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 481, __pyx_L1_error)
+    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 479, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "structureboost/structure_gb.pyx":480
+    /* "structureboost/structure_gb.pyx":478
  * 
  *         self.optimizable = np.all(np.array([dt.optimizable for dt in self.dec_tree_list]))
  *         if (self.optimizable):             # <<<<<<<<<<<<<<
  *             self.get_tensors_for_predict()
  * 
  */
   }
 
-  /* "structureboost/structure_gb.pyx":371
+  /* "structureboost/structure_gb.pyx":369
  * 
  * 
  *     def fit(self, X_train, y_train, eval_set=None, eval_freq=10,             # <<<<<<<<<<<<<<
  *             early_stop_past_steps=0, choose_best_eval=True, verbose=1):
  *         """Fits the model given training features and labels.
  */
 
@@ -12425,15 +12412,15 @@
   __Pyx_XDECREF(__pyx_v_y_train);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":483
+/* "structureboost/structure_gb.pyx":481
  *             self.get_tensors_for_predict()
  * 
  *     def predict(self, X_test, int num_trees_to_use=-1, same_col_pos=True):             # <<<<<<<<<<<<<<
  *         """Returns a one-dimensional response - probability of 1 or numeric prediction
  * 
  */
 
@@ -12476,15 +12463,15 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X_test)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("predict", 0, 2, 4, 1); __PYX_ERR(0, 483, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("predict", 0, 2, 4, 1); __PYX_ERR(0, 481, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num_trees_to_use);
           if (value) { values[2] = value; kw_args--; }
         }
@@ -12492,15 +12479,15 @@
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_same_col_pos);
           if (value) { values[3] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "predict") < 0)) __PYX_ERR(0, 483, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "predict") < 0)) __PYX_ERR(0, 481, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
@@ -12509,23 +12496,23 @@
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_self = values[0];
     __pyx_v_X_test = values[1];
     if (values[2]) {
-      __pyx_v_num_trees_to_use = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_num_trees_to_use == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 483, __pyx_L3_error)
+      __pyx_v_num_trees_to_use = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_num_trees_to_use == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 481, __pyx_L3_error)
     } else {
       __pyx_v_num_trees_to_use = ((int)((int)-1));
     }
     __pyx_v_same_col_pos = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("predict", 0, 2, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 483, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("predict", 0, 2, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 481, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost.predict", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_32predict(__pyx_self, __pyx_v_self, __pyx_v_X_test, __pyx_v_num_trees_to_use, __pyx_v_same_col_pos);
 
@@ -12556,65 +12543,65 @@
   PyObject *(*__pyx_t_11)(PyObject *);
   int __pyx_t_12;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__19)
   __Pyx_RefNannySetupContext("predict", 0);
-  __Pyx_TraceCall("predict", __pyx_f[0], 483, 0, __PYX_ERR(0, 483, __pyx_L1_error));
+  __Pyx_TraceCall("predict", __pyx_f[0], 481, 0, __PYX_ERR(0, 481, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":538
+  /* "structureboost/structure_gb.pyx":536
  *             in X-test.
  *         """
  *         if (type(X_test)==np.ndarray):             # <<<<<<<<<<<<<<
  *             if self.optimizable:
  *                 if self.optimized:
  */
-  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_X_test)), ((PyObject *)__pyx_ptype_5numpy_ndarray), Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 538, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 538, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_X_test)), ((PyObject *)__pyx_ptype_5numpy_ndarray), Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 536, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 536, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_gb.pyx":539
+    /* "structureboost/structure_gb.pyx":537
  *         """
  *         if (type(X_test)==np.ndarray):
  *             if self.optimizable:             # <<<<<<<<<<<<<<
  *                 if self.optimized:
  *                     return(self._predict_fast(X_test, num_trees_to_use))
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimizable); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 539, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimizable); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 537, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 539, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 537, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (__pyx_t_2) {
 
-      /* "structureboost/structure_gb.pyx":540
+      /* "structureboost/structure_gb.pyx":538
  *         if (type(X_test)==np.ndarray):
  *             if self.optimizable:
  *                 if self.optimized:             # <<<<<<<<<<<<<<
  *                     return(self._predict_fast(X_test, num_trees_to_use))
  *                 else:
  */
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimized); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 540, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimized); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 538, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 540, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 538, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       if (__pyx_t_2) {
 
-        /* "structureboost/structure_gb.pyx":541
+        /* "structureboost/structure_gb.pyx":539
  *             if self.optimizable:
  *                 if self.optimized:
  *                     return(self._predict_fast(X_test, num_trees_to_use))             # <<<<<<<<<<<<<<
  *                 else:
  *                     self.get_tensors_for_predict()
  */
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_fast); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 541, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_fast); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 539, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 541, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 539, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __pyx_t_5 = NULL;
         __pyx_t_6 = 0;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
           if (likely(__pyx_t_5)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -12623,97 +12610,97 @@
             __Pyx_DECREF_SET(__pyx_t_3, function);
             __pyx_t_6 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_X_test, __pyx_t_4};
-          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 541, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 539, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_X_test, __pyx_t_4};
-          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 541, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 539, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         } else
         #endif
         {
-          __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 541, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 539, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           if (__pyx_t_5) {
             __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
           }
           __Pyx_INCREF(__pyx_v_X_test);
           __Pyx_GIVEREF(__pyx_v_X_test);
           PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_X_test);
           __Pyx_GIVEREF(__pyx_t_4);
           PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_4);
           __pyx_t_4 = 0;
-          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 541, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 539, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         }
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_1;
         __pyx_t_1 = 0;
         goto __pyx_L0;
 
-        /* "structureboost/structure_gb.pyx":540
+        /* "structureboost/structure_gb.pyx":538
  *         if (type(X_test)==np.ndarray):
  *             if self.optimizable:
  *                 if self.optimized:             # <<<<<<<<<<<<<<
  *                     return(self._predict_fast(X_test, num_trees_to_use))
  *                 else:
  */
       }
 
-      /* "structureboost/structure_gb.pyx":543
+      /* "structureboost/structure_gb.pyx":541
  *                     return(self._predict_fast(X_test, num_trees_to_use))
  *                 else:
  *                     self.get_tensors_for_predict()             # <<<<<<<<<<<<<<
  *                     return(self._predict_fast(X_test, num_trees_to_use))
  *             else:
  */
       /*else*/ {
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_tensors_for_predict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 543, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_tensors_for_predict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 541, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __pyx_t_7 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
           if (likely(__pyx_t_7)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
             __Pyx_INCREF(__pyx_t_7);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_7) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
         __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 543, __pyx_L1_error)
+        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 541, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-        /* "structureboost/structure_gb.pyx":544
+        /* "structureboost/structure_gb.pyx":542
  *                 else:
  *                     self.get_tensors_for_predict()
  *                     return(self._predict_fast(X_test, num_trees_to_use))             # <<<<<<<<<<<<<<
  *             else:
  *                 # clunky.. make X_test into a pd.DataFrame with appr columns
  */
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_fast); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 544, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_fast); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 542, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 544, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 542, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __pyx_t_4 = NULL;
         __pyx_t_6 = 0;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
           if (likely(__pyx_t_4)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -12722,276 +12709,276 @@
             __Pyx_DECREF_SET(__pyx_t_3, function);
             __pyx_t_6 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_X_test, __pyx_t_7};
-          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 544, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 542, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_X_test, __pyx_t_7};
-          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 544, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 542, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         } else
         #endif
         {
-          __pyx_t_5 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 544, __pyx_L1_error)
+          __pyx_t_5 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 542, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           if (__pyx_t_4) {
             __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
           }
           __Pyx_INCREF(__pyx_v_X_test);
           __Pyx_GIVEREF(__pyx_v_X_test);
           PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_6, __pyx_v_X_test);
           __Pyx_GIVEREF(__pyx_t_7);
           PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_6, __pyx_t_7);
           __pyx_t_7 = 0;
-          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 544, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 542, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         }
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_1;
         __pyx_t_1 = 0;
         goto __pyx_L0;
       }
 
-      /* "structureboost/structure_gb.pyx":539
+      /* "structureboost/structure_gb.pyx":537
  *         """
  *         if (type(X_test)==np.ndarray):
  *             if self.optimizable:             # <<<<<<<<<<<<<<
  *                 if self.optimized:
  *                     return(self._predict_fast(X_test, num_trees_to_use))
  */
     }
 
-    /* "structureboost/structure_gb.pyx":548
+    /* "structureboost/structure_gb.pyx":546
  *                 # clunky.. make X_test into a pd.DataFrame with appr columns
  *                 # but this would be an unusual situation
  *                 inv_cti = {j:i for (i,j) in self.column_to_int_dict.items}             # <<<<<<<<<<<<<<
  *                 col_list = [inv_cti[i] if i in inv_cti.keys() else '_X_'+str(i)
  *                             for i in X_test.shape[0]]
  */
     /*else*/ {
       { /* enter inner scope */
-        __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 548, __pyx_L8_error)
+        __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 546, __pyx_L8_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_column_to_int_dict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 548, __pyx_L8_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_column_to_int_dict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 546, __pyx_L8_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_items); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 548, __pyx_L8_error)
+        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_items); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 546, __pyx_L8_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
           __pyx_t_3 = __pyx_t_5; __Pyx_INCREF(__pyx_t_3); __pyx_t_8 = 0;
           __pyx_t_9 = NULL;
         } else {
-          __pyx_t_8 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 548, __pyx_L8_error)
+          __pyx_t_8 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 546, __pyx_L8_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_9 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 548, __pyx_L8_error)
+          __pyx_t_9 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 546, __pyx_L8_error)
         }
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         for (;;) {
           if (likely(!__pyx_t_9)) {
             if (likely(PyList_CheckExact(__pyx_t_3))) {
               if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_3)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_8); __Pyx_INCREF(__pyx_t_5); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 548, __pyx_L8_error)
+              __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_8); __Pyx_INCREF(__pyx_t_5); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 546, __pyx_L8_error)
               #else
-              __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 548, __pyx_L8_error)
+              __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 546, __pyx_L8_error)
               __Pyx_GOTREF(__pyx_t_5);
               #endif
             } else {
               if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_8); __Pyx_INCREF(__pyx_t_5); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 548, __pyx_L8_error)
+              __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_8); __Pyx_INCREF(__pyx_t_5); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 546, __pyx_L8_error)
               #else
-              __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 548, __pyx_L8_error)
+              __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 546, __pyx_L8_error)
               __Pyx_GOTREF(__pyx_t_5);
               #endif
             }
           } else {
             __pyx_t_5 = __pyx_t_9(__pyx_t_3);
             if (unlikely(!__pyx_t_5)) {
               PyObject* exc_type = PyErr_Occurred();
               if (exc_type) {
                 if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                else __PYX_ERR(0, 548, __pyx_L8_error)
+                else __PYX_ERR(0, 546, __pyx_L8_error)
               }
               break;
             }
             __Pyx_GOTREF(__pyx_t_5);
           }
           if ((likely(PyTuple_CheckExact(__pyx_t_5))) || (PyList_CheckExact(__pyx_t_5))) {
             PyObject* sequence = __pyx_t_5;
             Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
             if (unlikely(size != 2)) {
               if (size > 2) __Pyx_RaiseTooManyValuesError(2);
               else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-              __PYX_ERR(0, 548, __pyx_L8_error)
+              __PYX_ERR(0, 546, __pyx_L8_error)
             }
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
             if (likely(PyTuple_CheckExact(sequence))) {
               __pyx_t_7 = PyTuple_GET_ITEM(sequence, 0); 
               __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
             } else {
               __pyx_t_7 = PyList_GET_ITEM(sequence, 0); 
               __pyx_t_4 = PyList_GET_ITEM(sequence, 1); 
             }
             __Pyx_INCREF(__pyx_t_7);
             __Pyx_INCREF(__pyx_t_4);
             #else
-            __pyx_t_7 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 548, __pyx_L8_error)
+            __pyx_t_7 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 546, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_7);
-            __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 548, __pyx_L8_error)
+            __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 546, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_4);
             #endif
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           } else {
             Py_ssize_t index = -1;
-            __pyx_t_10 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 548, __pyx_L8_error)
+            __pyx_t_10 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 546, __pyx_L8_error)
             __Pyx_GOTREF(__pyx_t_10);
             __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
             __pyx_t_11 = Py_TYPE(__pyx_t_10)->tp_iternext;
             index = 0; __pyx_t_7 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_7)) goto __pyx_L11_unpacking_failed;
             __Pyx_GOTREF(__pyx_t_7);
             index = 1; __pyx_t_4 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_4)) goto __pyx_L11_unpacking_failed;
             __Pyx_GOTREF(__pyx_t_4);
-            if (__Pyx_IternextUnpackEndCheck(__pyx_t_11(__pyx_t_10), 2) < 0) __PYX_ERR(0, 548, __pyx_L8_error)
+            if (__Pyx_IternextUnpackEndCheck(__pyx_t_11(__pyx_t_10), 2) < 0) __PYX_ERR(0, 546, __pyx_L8_error)
             __pyx_t_11 = NULL;
             __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
             goto __pyx_L12_unpacking_done;
             __pyx_L11_unpacking_failed:;
             __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
             __pyx_t_11 = NULL;
             if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-            __PYX_ERR(0, 548, __pyx_L8_error)
+            __PYX_ERR(0, 546, __pyx_L8_error)
             __pyx_L12_unpacking_done:;
           }
           __Pyx_XDECREF_SET(__pyx_8genexpr2__pyx_v_i, __pyx_t_7);
           __pyx_t_7 = 0;
           __Pyx_XDECREF_SET(__pyx_8genexpr2__pyx_v_j, __pyx_t_4);
           __pyx_t_4 = 0;
-          if (unlikely(PyDict_SetItem(__pyx_t_1, (PyObject*)__pyx_8genexpr2__pyx_v_j, (PyObject*)__pyx_8genexpr2__pyx_v_i))) __PYX_ERR(0, 548, __pyx_L8_error)
+          if (unlikely(PyDict_SetItem(__pyx_t_1, (PyObject*)__pyx_8genexpr2__pyx_v_j, (PyObject*)__pyx_8genexpr2__pyx_v_i))) __PYX_ERR(0, 546, __pyx_L8_error)
         }
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_i); __pyx_8genexpr2__pyx_v_i = 0;
         __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_j); __pyx_8genexpr2__pyx_v_j = 0;
         goto __pyx_L13_exit_scope;
         __pyx_L8_error:;
         __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_i); __pyx_8genexpr2__pyx_v_i = 0;
         __Pyx_XDECREF(__pyx_8genexpr2__pyx_v_j); __pyx_8genexpr2__pyx_v_j = 0;
         goto __pyx_L1_error;
         __pyx_L13_exit_scope:;
       } /* exit inner scope */
       __pyx_v_inv_cti = ((PyObject*)__pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "structureboost/structure_gb.pyx":549
+      /* "structureboost/structure_gb.pyx":547
  *                 # but this would be an unusual situation
  *                 inv_cti = {j:i for (i,j) in self.column_to_int_dict.items}
  *                 col_list = [inv_cti[i] if i in inv_cti.keys() else '_X_'+str(i)             # <<<<<<<<<<<<<<
  *                             for i in X_test.shape[0]]
  *                 return(self._predict_py(pd.DataFrame(X_test, columns=col_list), num_trees_to_use))
  */
       { /* enter inner scope */
-        __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 549, __pyx_L16_error)
+        __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 547, __pyx_L16_error)
         __Pyx_GOTREF(__pyx_t_1);
 
-        /* "structureboost/structure_gb.pyx":550
+        /* "structureboost/structure_gb.pyx":548
  *                 inv_cti = {j:i for (i,j) in self.column_to_int_dict.items}
  *                 col_list = [inv_cti[i] if i in inv_cti.keys() else '_X_'+str(i)
  *                             for i in X_test.shape[0]]             # <<<<<<<<<<<<<<
  *                 return(self._predict_py(pd.DataFrame(X_test, columns=col_list), num_trees_to_use))
  * 
  */
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_test, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 550, __pyx_L16_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_test, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 548, __pyx_L16_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 550, __pyx_L16_error)
+        __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 548, __pyx_L16_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
           __pyx_t_3 = __pyx_t_5; __Pyx_INCREF(__pyx_t_3); __pyx_t_8 = 0;
           __pyx_t_9 = NULL;
         } else {
-          __pyx_t_8 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 550, __pyx_L16_error)
+          __pyx_t_8 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 548, __pyx_L16_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_9 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 550, __pyx_L16_error)
+          __pyx_t_9 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 548, __pyx_L16_error)
         }
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         for (;;) {
           if (likely(!__pyx_t_9)) {
             if (likely(PyList_CheckExact(__pyx_t_3))) {
               if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_3)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_8); __Pyx_INCREF(__pyx_t_5); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 550, __pyx_L16_error)
+              __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_8); __Pyx_INCREF(__pyx_t_5); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 548, __pyx_L16_error)
               #else
-              __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 550, __pyx_L16_error)
+              __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 548, __pyx_L16_error)
               __Pyx_GOTREF(__pyx_t_5);
               #endif
             } else {
               if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_8); __Pyx_INCREF(__pyx_t_5); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 550, __pyx_L16_error)
+              __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_8); __Pyx_INCREF(__pyx_t_5); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 548, __pyx_L16_error)
               #else
-              __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 550, __pyx_L16_error)
+              __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 548, __pyx_L16_error)
               __Pyx_GOTREF(__pyx_t_5);
               #endif
             }
           } else {
             __pyx_t_5 = __pyx_t_9(__pyx_t_3);
             if (unlikely(!__pyx_t_5)) {
               PyObject* exc_type = PyErr_Occurred();
               if (exc_type) {
                 if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                else __PYX_ERR(0, 550, __pyx_L16_error)
+                else __PYX_ERR(0, 548, __pyx_L16_error)
               }
               break;
             }
             __Pyx_GOTREF(__pyx_t_5);
           }
           __Pyx_XDECREF_SET(__pyx_8genexpr3__pyx_v_i, __pyx_t_5);
           __pyx_t_5 = 0;
 
-          /* "structureboost/structure_gb.pyx":549
+          /* "structureboost/structure_gb.pyx":547
  *                 # but this would be an unusual situation
  *                 inv_cti = {j:i for (i,j) in self.column_to_int_dict.items}
  *                 col_list = [inv_cti[i] if i in inv_cti.keys() else '_X_'+str(i)             # <<<<<<<<<<<<<<
  *                             for i in X_test.shape[0]]
  *                 return(self._predict_py(pd.DataFrame(X_test, columns=col_list), num_trees_to_use))
  */
-          __pyx_t_4 = __Pyx_PyDict_Keys(__pyx_v_inv_cti); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 549, __pyx_L16_error)
+          __pyx_t_4 = __Pyx_PyDict_Keys(__pyx_v_inv_cti); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 547, __pyx_L16_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_8genexpr3__pyx_v_i, __pyx_t_4, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 549, __pyx_L16_error)
+          __pyx_t_2 = (__Pyx_PySequence_ContainsTF(__pyx_8genexpr3__pyx_v_i, __pyx_t_4, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 547, __pyx_L16_error)
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           if ((__pyx_t_2 != 0)) {
-            __pyx_t_4 = __Pyx_PyDict_GetItem(__pyx_v_inv_cti, __pyx_8genexpr3__pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 549, __pyx_L16_error)
+            __pyx_t_4 = __Pyx_PyDict_GetItem(__pyx_v_inv_cti, __pyx_8genexpr3__pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 547, __pyx_L16_error)
             __Pyx_GOTREF(__pyx_t_4);
             __pyx_t_5 = __pyx_t_4;
             __pyx_t_4 = 0;
           } else {
-            __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_8genexpr3__pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 549, __pyx_L16_error)
+            __pyx_t_4 = __Pyx_PyObject_CallOneArg(((PyObject *)(&PyUnicode_Type)), __pyx_8genexpr3__pyx_v_i); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 547, __pyx_L16_error)
             __Pyx_GOTREF(__pyx_t_4);
-            __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_n_u_X, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 549, __pyx_L16_error)
+            __pyx_t_7 = __Pyx_PyUnicode_Concat(__pyx_n_u_X, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 547, __pyx_L16_error)
             __Pyx_GOTREF(__pyx_t_7);
             __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
             __pyx_t_5 = __pyx_t_7;
             __pyx_t_7 = 0;
           }
-          if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 549, __pyx_L16_error)
+          if (unlikely(__Pyx_ListComp_Append(__pyx_t_1, (PyObject*)__pyx_t_5))) __PYX_ERR(0, 547, __pyx_L16_error)
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-          /* "structureboost/structure_gb.pyx":550
+          /* "structureboost/structure_gb.pyx":548
  *                 inv_cti = {j:i for (i,j) in self.column_to_int_dict.items}
  *                 col_list = [inv_cti[i] if i in inv_cti.keys() else '_X_'+str(i)
  *                             for i in X_test.shape[0]]             # <<<<<<<<<<<<<<
  *                 return(self._predict_py(pd.DataFrame(X_test, columns=col_list), num_trees_to_use))
  * 
  */
         }
@@ -13002,43 +12989,43 @@
         __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_i); __pyx_8genexpr3__pyx_v_i = 0;
         goto __pyx_L1_error;
         __pyx_L19_exit_scope:;
       } /* exit inner scope */
       __pyx_v_col_list = ((PyObject*)__pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "structureboost/structure_gb.pyx":551
+      /* "structureboost/structure_gb.pyx":549
  *                 col_list = [inv_cti[i] if i in inv_cti.keys() else '_X_'+str(i)
  *                             for i in X_test.shape[0]]
  *                 return(self._predict_py(pd.DataFrame(X_test, columns=col_list), num_trees_to_use))             # <<<<<<<<<<<<<<
  * 
  *         elif (type(X_test)==pd.DataFrame):
  */
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_py); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 551, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_py); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 549, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_pd); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 551, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_pd); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 549, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_DataFrame); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 551, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_DataFrame); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 549, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 551, __pyx_L1_error)
+      __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 549, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_INCREF(__pyx_v_X_test);
       __Pyx_GIVEREF(__pyx_v_X_test);
       PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_X_test);
-      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 551, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 549, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_columns, __pyx_v_col_list) < 0) __PYX_ERR(0, 551, __pyx_L1_error)
-      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 551, __pyx_L1_error)
+      if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_columns, __pyx_v_col_list) < 0) __PYX_ERR(0, 549, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 549, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 551, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 549, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __pyx_t_5 = NULL;
       __pyx_t_6 = 0;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -13047,180 +13034,180 @@
           __Pyx_DECREF_SET(__pyx_t_3, function);
           __pyx_t_6 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_3)) {
         PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_10, __pyx_t_4};
-        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 551, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 549, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
         PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_t_10, __pyx_t_4};
-        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 551, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 549, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       {
-        __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 551, __pyx_L1_error)
+        __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 549, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         if (__pyx_t_5) {
           __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_10);
         PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_t_10);
         __Pyx_GIVEREF(__pyx_t_4);
         PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_4);
         __pyx_t_10 = 0;
         __pyx_t_4 = 0;
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 551, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 549, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       }
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_r = __pyx_t_1;
       __pyx_t_1 = 0;
       goto __pyx_L0;
     }
 
-    /* "structureboost/structure_gb.pyx":538
+    /* "structureboost/structure_gb.pyx":536
  *             in X-test.
  *         """
  *         if (type(X_test)==np.ndarray):             # <<<<<<<<<<<<<<
  *             if self.optimizable:
  *                 if self.optimized:
  */
   }
 
-  /* "structureboost/structure_gb.pyx":553
+  /* "structureboost/structure_gb.pyx":551
  *                 return(self._predict_py(pd.DataFrame(X_test, columns=col_list), num_trees_to_use))
  * 
  *         elif (type(X_test)==pd.DataFrame):             # <<<<<<<<<<<<<<
  *             if same_col_pos:
  *                 if self.optimizable:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pd); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 553, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pd); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 551, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_DataFrame); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 553, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_DataFrame); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 551, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_X_test)), __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 553, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_X_test)), __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 551, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 553, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 551, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_gb.pyx":554
+    /* "structureboost/structure_gb.pyx":552
  * 
  *         elif (type(X_test)==pd.DataFrame):
  *             if same_col_pos:             # <<<<<<<<<<<<<<
  *                 if self.optimizable:
  *                     if not self.optimized:
  */
-    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_same_col_pos); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 554, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_same_col_pos); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 552, __pyx_L1_error)
     if (__pyx_t_2) {
 
-      /* "structureboost/structure_gb.pyx":555
+      /* "structureboost/structure_gb.pyx":553
  *         elif (type(X_test)==pd.DataFrame):
  *             if same_col_pos:
  *                 if self.optimizable:             # <<<<<<<<<<<<<<
  *                     if not self.optimized:
  *                         self.get_tensors_for_predict()
  */
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimizable); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 555, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimizable); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 553, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 555, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 553, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       if (__pyx_t_2) {
 
-        /* "structureboost/structure_gb.pyx":556
+        /* "structureboost/structure_gb.pyx":554
  *             if same_col_pos:
  *                 if self.optimizable:
  *                     if not self.optimized:             # <<<<<<<<<<<<<<
  *                         self.get_tensors_for_predict()
  *                     return(self._predict_fast(X_test.to_numpy(), num_trees_to_use))
  */
-        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimized); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 556, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimized); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 554, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 556, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 554, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __pyx_t_12 = ((!__pyx_t_2) != 0);
         if (__pyx_t_12) {
 
-          /* "structureboost/structure_gb.pyx":557
+          /* "structureboost/structure_gb.pyx":555
  *                 if self.optimizable:
  *                     if not self.optimized:
  *                         self.get_tensors_for_predict()             # <<<<<<<<<<<<<<
  *                     return(self._predict_fast(X_test.to_numpy(), num_trees_to_use))
  *                 else:
  */
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_tensors_for_predict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 557, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_tensors_for_predict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 555, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
           __pyx_t_7 = NULL;
           if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
             __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
             if (likely(__pyx_t_7)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
               __Pyx_INCREF(__pyx_t_7);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_3, function);
             }
           }
           __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_7) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
           __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 557, __pyx_L1_error)
+          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 555, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "structureboost/structure_gb.pyx":556
+          /* "structureboost/structure_gb.pyx":554
  *             if same_col_pos:
  *                 if self.optimizable:
  *                     if not self.optimized:             # <<<<<<<<<<<<<<
  *                         self.get_tensors_for_predict()
  *                     return(self._predict_fast(X_test.to_numpy(), num_trees_to_use))
  */
         }
 
-        /* "structureboost/structure_gb.pyx":558
+        /* "structureboost/structure_gb.pyx":556
  *                     if not self.optimized:
  *                         self.get_tensors_for_predict()
  *                     return(self._predict_fast(X_test.to_numpy(), num_trees_to_use))             # <<<<<<<<<<<<<<
  *                 else:
  *                     return(self._predict_py(X_test, num_trees_to_use))
  */
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_fast); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 558, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_fast); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 556, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_test, __pyx_n_s_to_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 558, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_test, __pyx_n_s_to_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 556, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __pyx_t_10 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
           __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_4);
           if (likely(__pyx_t_10)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
             __Pyx_INCREF(__pyx_t_10);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_4, function);
           }
         }
         __pyx_t_7 = (__pyx_t_10) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_10) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
         __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
-        if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 558, __pyx_L1_error)
+        if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 556, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 558, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 556, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __pyx_t_10 = NULL;
         __pyx_t_6 = 0;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_3);
           if (likely(__pyx_t_10)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -13229,73 +13216,73 @@
             __Pyx_DECREF_SET(__pyx_t_3, function);
             __pyx_t_6 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_7, __pyx_t_4};
-          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 556, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_7, __pyx_t_4};
-          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 556, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         } else
         #endif
         {
-          __pyx_t_5 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 558, __pyx_L1_error)
+          __pyx_t_5 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 556, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           if (__pyx_t_10) {
             __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_10); __pyx_t_10 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_7);
           PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_6, __pyx_t_7);
           __Pyx_GIVEREF(__pyx_t_4);
           PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_6, __pyx_t_4);
           __pyx_t_7 = 0;
           __pyx_t_4 = 0;
-          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 556, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         }
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_1;
         __pyx_t_1 = 0;
         goto __pyx_L0;
 
-        /* "structureboost/structure_gb.pyx":555
+        /* "structureboost/structure_gb.pyx":553
  *         elif (type(X_test)==pd.DataFrame):
  *             if same_col_pos:
  *                 if self.optimizable:             # <<<<<<<<<<<<<<
  *                     if not self.optimized:
  *                         self.get_tensors_for_predict()
  */
       }
 
-      /* "structureboost/structure_gb.pyx":560
+      /* "structureboost/structure_gb.pyx":558
  *                     return(self._predict_fast(X_test.to_numpy(), num_trees_to_use))
  *                 else:
  *                     return(self._predict_py(X_test, num_trees_to_use))             # <<<<<<<<<<<<<<
  *             else:
  *                 return(self._predict_py(X_test, num_trees_to_use))
  */
       /*else*/ {
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_py); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 560, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_py); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 560, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __pyx_t_4 = NULL;
         __pyx_t_6 = 0;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
           if (likely(__pyx_t_4)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -13304,72 +13291,72 @@
             __Pyx_DECREF_SET(__pyx_t_3, function);
             __pyx_t_6 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_X_test, __pyx_t_5};
-          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 560, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_X_test, __pyx_t_5};
-          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 560, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         } else
         #endif
         {
-          __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 560, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 558, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           if (__pyx_t_4) {
             __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4); __pyx_t_4 = NULL;
           }
           __Pyx_INCREF(__pyx_v_X_test);
           __Pyx_GIVEREF(__pyx_v_X_test);
           PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_X_test);
           __Pyx_GIVEREF(__pyx_t_5);
           PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_5);
           __pyx_t_5 = 0;
-          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 560, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         }
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_1;
         __pyx_t_1 = 0;
         goto __pyx_L0;
       }
 
-      /* "structureboost/structure_gb.pyx":554
+      /* "structureboost/structure_gb.pyx":552
  * 
  *         elif (type(X_test)==pd.DataFrame):
  *             if same_col_pos:             # <<<<<<<<<<<<<<
  *                 if self.optimizable:
  *                     if not self.optimized:
  */
     }
 
-    /* "structureboost/structure_gb.pyx":562
+    /* "structureboost/structure_gb.pyx":560
  *                     return(self._predict_py(X_test, num_trees_to_use))
  *             else:
  *                 return(self._predict_py(X_test, num_trees_to_use))             # <<<<<<<<<<<<<<
  * 
  *     def _predict_py(self, X_test, int num_trees_to_use=-1):
  */
     /*else*/ {
       __Pyx_XDECREF(__pyx_r);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_py); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 562, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_py); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 560, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 562, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 560, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __pyx_t_5 = NULL;
       __pyx_t_6 = 0;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
         if (likely(__pyx_t_5)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -13378,61 +13365,61 @@
           __Pyx_DECREF_SET(__pyx_t_3, function);
           __pyx_t_6 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_3)) {
         PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_X_test, __pyx_t_7};
-        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 562, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 560, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
         PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_X_test, __pyx_t_7};
-        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 562, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 560, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       } else
       #endif
       {
-        __pyx_t_4 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 562, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 560, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         if (__pyx_t_5) {
           __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
         }
         __Pyx_INCREF(__pyx_v_X_test);
         __Pyx_GIVEREF(__pyx_v_X_test);
         PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_6, __pyx_v_X_test);
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_6, __pyx_t_7);
         __pyx_t_7 = 0;
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 562, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 560, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       }
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_r = __pyx_t_1;
       __pyx_t_1 = 0;
       goto __pyx_L0;
     }
 
-    /* "structureboost/structure_gb.pyx":553
+    /* "structureboost/structure_gb.pyx":551
  *                 return(self._predict_py(pd.DataFrame(X_test, columns=col_list), num_trees_to_use))
  * 
  *         elif (type(X_test)==pd.DataFrame):             # <<<<<<<<<<<<<<
  *             if same_col_pos:
  *                 if self.optimizable:
  */
   }
 
-  /* "structureboost/structure_gb.pyx":483
+  /* "structureboost/structure_gb.pyx":481
  *             self.get_tensors_for_predict()
  * 
  *     def predict(self, X_test, int num_trees_to_use=-1, same_col_pos=True):             # <<<<<<<<<<<<<<
  *         """Returns a one-dimensional response - probability of 1 or numeric prediction
  * 
  */
 
@@ -13456,15 +13443,15 @@
   __Pyx_XDECREF(__pyx_8genexpr3__pyx_v_i);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":564
+/* "structureboost/structure_gb.pyx":562
  *                 return(self._predict_py(X_test, num_trees_to_use))
  * 
  *     def _predict_py(self, X_test, int num_trees_to_use=-1):             # <<<<<<<<<<<<<<
  *         cdef int i
  *         if num_trees_to_use == -1:
  */
 
@@ -13502,47 +13489,47 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X_test)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_predict_py", 0, 2, 3, 1); __PYX_ERR(0, 564, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_predict_py", 0, 2, 3, 1); __PYX_ERR(0, 562, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num_trees_to_use);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_predict_py") < 0)) __PYX_ERR(0, 564, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_predict_py") < 0)) __PYX_ERR(0, 562, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_self = values[0];
     __pyx_v_X_test = values[1];
     if (values[2]) {
-      __pyx_v_num_trees_to_use = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_num_trees_to_use == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 564, __pyx_L3_error)
+      __pyx_v_num_trees_to_use = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_num_trees_to_use == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 562, __pyx_L3_error)
     } else {
       __pyx_v_num_trees_to_use = ((int)((int)-1));
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_predict_py", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 564, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_predict_py", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 562, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost._predict_py", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_34_predict_py(__pyx_self, __pyx_v_self, __pyx_v_X_test, __pyx_v_num_trees_to_use);
 
@@ -13568,82 +13555,82 @@
   int __pyx_t_9;
   int __pyx_t_10;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__20)
   __Pyx_RefNannySetupContext("_predict_py", 0);
-  __Pyx_TraceCall("_predict_py", __pyx_f[0], 564, 0, __PYX_ERR(0, 564, __pyx_L1_error));
+  __Pyx_TraceCall("_predict_py", __pyx_f[0], 562, 0, __PYX_ERR(0, 562, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":566
+  /* "structureboost/structure_gb.pyx":564
  *     def _predict_py(self, X_test, int num_trees_to_use=-1):
  *         cdef int i
  *         if num_trees_to_use == -1:             # <<<<<<<<<<<<<<
  *             num_trees_to_use = self.num_trees_for_prediction
  *         if self.initial_model is None:
  */
   __pyx_t_1 = ((__pyx_v_num_trees_to_use == -1L) != 0);
   if (__pyx_t_1) {
 
-    /* "structureboost/structure_gb.pyx":567
+    /* "structureboost/structure_gb.pyx":565
  *         cdef int i
  *         if num_trees_to_use == -1:
  *             num_trees_to_use = self.num_trees_for_prediction             # <<<<<<<<<<<<<<
  *         if self.initial_model is None:
  *             # todo: revisit below
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_trees_for_prediction); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 567, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_trees_for_prediction); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 565, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 567, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 565, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_num_trees_to_use = __pyx_t_3;
 
-    /* "structureboost/structure_gb.pyx":566
+    /* "structureboost/structure_gb.pyx":564
  *     def _predict_py(self, X_test, int num_trees_to_use=-1):
  *         cdef int i
  *         if num_trees_to_use == -1:             # <<<<<<<<<<<<<<
  *             num_trees_to_use = self.num_trees_for_prediction
  *         if self.initial_model is None:
  */
   }
 
-  /* "structureboost/structure_gb.pyx":568
+  /* "structureboost/structure_gb.pyx":566
  *         if num_trees_to_use == -1:
  *             num_trees_to_use = self.num_trees_for_prediction
  *         if self.initial_model is None:             # <<<<<<<<<<<<<<
  *             # todo: revisit below
  *             out_vec = self.initial_pred[0]*np.ones(X_test.shape[0])
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 568, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_1 = (__pyx_t_2 == Py_None);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_4 = (__pyx_t_1 != 0);
   if (__pyx_t_4) {
 
-    /* "structureboost/structure_gb.pyx":570
+    /* "structureboost/structure_gb.pyx":568
  *         if self.initial_model is None:
  *             # todo: revisit below
  *             out_vec = self.initial_pred[0]*np.ones(X_test.shape[0])             # <<<<<<<<<<<<<<
  *         elif self.mode=='classification':
  *             out_vec = self.initial_model.predict_proba(X_test)[:,1]
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_pred); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 570, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_pred); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 568, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 568, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 570, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 568, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ones); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 570, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ones); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 568, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_test, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 570, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_test, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 568, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 570, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 568, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
@@ -13651,93 +13638,93 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_6, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_8);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 570, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 568, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_Multiply(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 570, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Multiply(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 568, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_out_vec = __pyx_t_7;
     __pyx_t_7 = 0;
 
-    /* "structureboost/structure_gb.pyx":568
+    /* "structureboost/structure_gb.pyx":566
  *         if num_trees_to_use == -1:
  *             num_trees_to_use = self.num_trees_for_prediction
  *         if self.initial_model is None:             # <<<<<<<<<<<<<<
  *             # todo: revisit below
  *             out_vec = self.initial_pred[0]*np.ones(X_test.shape[0])
  */
     goto __pyx_L4;
   }
 
-  /* "structureboost/structure_gb.pyx":571
+  /* "structureboost/structure_gb.pyx":569
  *             # todo: revisit below
  *             out_vec = self.initial_pred[0]*np.ones(X_test.shape[0])
  *         elif self.mode=='classification':             # <<<<<<<<<<<<<<
  *             out_vec = self.initial_model.predict_proba(X_test)[:,1]
  *             out_vec = np.clip(out_vec, 1e-15, 1-1e-15)
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_mode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 571, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_mode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 569, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_classification, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 571, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_classification, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 569, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   if (__pyx_t_4) {
 
-    /* "structureboost/structure_gb.pyx":572
+    /* "structureboost/structure_gb.pyx":570
  *             out_vec = self.initial_pred[0]*np.ones(X_test.shape[0])
  *         elif self.mode=='classification':
  *             out_vec = self.initial_model.predict_proba(X_test)[:,1]             # <<<<<<<<<<<<<<
  *             out_vec = np.clip(out_vec, 1e-15, 1-1e-15)
  *             out_vec = np.log(out_vec/(1-out_vec))
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 570, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_predict_proba); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 572, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_predict_proba); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_7 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_v_X_test) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_X_test);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 572, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 570, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_tuple__6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 572, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_tuple__6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_v_out_vec = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":573
+    /* "structureboost/structure_gb.pyx":571
  *         elif self.mode=='classification':
  *             out_vec = self.initial_model.predict_proba(X_test)[:,1]
  *             out_vec = np.clip(out_vec, 1e-15, 1-1e-15)             # <<<<<<<<<<<<<<
  *             out_vec = np.log(out_vec/(1-out_vec))
  *         else:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 573, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 571, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_clip); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 573, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_clip); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 571, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyFloat_FromDouble((1.0 - 1e-15)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 573, __pyx_L1_error)
+    __pyx_t_7 = PyFloat_FromDouble((1.0 - 1e-15)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 571, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_8 = NULL;
     __pyx_t_3 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -13746,67 +13733,67 @@
         __Pyx_DECREF_SET(__pyx_t_2, function);
         __pyx_t_3 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_v_out_vec, __pyx_float_1eneg_15, __pyx_t_7};
-      __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_3, 3+__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 573, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_3, 3+__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 571, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_v_out_vec, __pyx_float_1eneg_15, __pyx_t_7};
-      __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_3, 3+__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 573, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_3, 3+__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 571, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     {
-      __pyx_t_6 = PyTuple_New(3+__pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 573, __pyx_L1_error)
+      __pyx_t_6 = PyTuple_New(3+__pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 571, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       if (__pyx_t_8) {
         __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_8); __pyx_t_8 = NULL;
       }
       __Pyx_INCREF(__pyx_v_out_vec);
       __Pyx_GIVEREF(__pyx_v_out_vec);
       PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_3, __pyx_v_out_vec);
       __Pyx_INCREF(__pyx_float_1eneg_15);
       __Pyx_GIVEREF(__pyx_float_1eneg_15);
       PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_3, __pyx_float_1eneg_15);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_3, __pyx_t_7);
       __pyx_t_7 = 0;
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 573, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 571, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF_SET(__pyx_v_out_vec, __pyx_t_5);
     __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":574
+    /* "structureboost/structure_gb.pyx":572
  *             out_vec = self.initial_model.predict_proba(X_test)[:,1]
  *             out_vec = np.clip(out_vec, 1e-15, 1-1e-15)
  *             out_vec = np.log(out_vec/(1-out_vec))             # <<<<<<<<<<<<<<
  *         else:
  *             out_vec = self.initial_model.predict(X_test)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_log); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 574, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_log); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 572, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_out_vec, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 574, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_out_vec, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 572, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_7 = __Pyx_PyNumber_Divide(__pyx_v_out_vec, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 574, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyNumber_Divide(__pyx_v_out_vec, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 572, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
@@ -13814,212 +13801,212 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_5 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_7);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 574, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 572, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF_SET(__pyx_v_out_vec, __pyx_t_5);
     __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":571
+    /* "structureboost/structure_gb.pyx":569
  *             # todo: revisit below
  *             out_vec = self.initial_pred[0]*np.ones(X_test.shape[0])
  *         elif self.mode=='classification':             # <<<<<<<<<<<<<<
  *             out_vec = self.initial_model.predict_proba(X_test)[:,1]
  *             out_vec = np.clip(out_vec, 1e-15, 1-1e-15)
  */
     goto __pyx_L4;
   }
 
-  /* "structureboost/structure_gb.pyx":576
+  /* "structureboost/structure_gb.pyx":574
  *             out_vec = np.log(out_vec/(1-out_vec))
  *         else:
  *             out_vec = self.initial_model.predict(X_test)             # <<<<<<<<<<<<<<
  *         for i in range(num_trees_to_use):
  *             out_vec = (out_vec + self.learning_rate *
  */
   /*else*/ {
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 576, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 574, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_predict); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 576, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_predict); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 574, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_6, __pyx_v_X_test) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_X_test);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 576, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 574, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_v_out_vec = __pyx_t_5;
     __pyx_t_5 = 0;
   }
   __pyx_L4:;
 
-  /* "structureboost/structure_gb.pyx":577
+  /* "structureboost/structure_gb.pyx":575
  *         else:
  *             out_vec = self.initial_model.predict(X_test)
  *         for i in range(num_trees_to_use):             # <<<<<<<<<<<<<<
  *             out_vec = (out_vec + self.learning_rate *
  *                        self.dec_tree_list[i].predict(X_test))
  */
   __pyx_t_3 = __pyx_v_num_trees_to_use;
   __pyx_t_9 = __pyx_t_3;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_i = __pyx_t_10;
 
-    /* "structureboost/structure_gb.pyx":578
+    /* "structureboost/structure_gb.pyx":576
  *             out_vec = self.initial_model.predict(X_test)
  *         for i in range(num_trees_to_use):
  *             out_vec = (out_vec + self.learning_rate *             # <<<<<<<<<<<<<<
  *                        self.dec_tree_list[i].predict(X_test))
  *         if self.mode == 'classification':
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_learning_rate); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 578, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_learning_rate); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 576, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
 
-    /* "structureboost/structure_gb.pyx":579
+    /* "structureboost/structure_gb.pyx":577
  *         for i in range(num_trees_to_use):
  *             out_vec = (out_vec + self.learning_rate *
  *                        self.dec_tree_list[i].predict(X_test))             # <<<<<<<<<<<<<<
  *         if self.mode == 'classification':
  *             return(1/(1+np.exp(-out_vec)))
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 579, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 577, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 579, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_6, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 577, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_predict); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 579, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_predict); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 577, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_7 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_v_X_test) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_X_test);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 579, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 577, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "structureboost/structure_gb.pyx":578
+    /* "structureboost/structure_gb.pyx":576
  *             out_vec = self.initial_model.predict(X_test)
  *         for i in range(num_trees_to_use):
  *             out_vec = (out_vec + self.learning_rate *             # <<<<<<<<<<<<<<
  *                        self.dec_tree_list[i].predict(X_test))
  *         if self.mode == 'classification':
  */
-    __pyx_t_6 = PyNumber_Multiply(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 578, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Multiply(__pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 576, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_Add(__pyx_v_out_vec, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 578, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Add(__pyx_v_out_vec, __pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 576, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF_SET(__pyx_v_out_vec, __pyx_t_7);
     __pyx_t_7 = 0;
   }
 
-  /* "structureboost/structure_gb.pyx":580
+  /* "structureboost/structure_gb.pyx":578
  *             out_vec = (out_vec + self.learning_rate *
  *                        self.dec_tree_list[i].predict(X_test))
  *         if self.mode == 'classification':             # <<<<<<<<<<<<<<
  *             return(1/(1+np.exp(-out_vec)))
  *         else:
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_mode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 580, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_mode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 578, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_classification, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 580, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_classification, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 578, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   if (__pyx_t_4) {
 
-    /* "structureboost/structure_gb.pyx":581
+    /* "structureboost/structure_gb.pyx":579
  *                        self.dec_tree_list[i].predict(X_test))
  *         if self.mode == 'classification':
  *             return(1/(1+np.exp(-out_vec)))             # <<<<<<<<<<<<<<
  *         else:
  *             return(out_vec)
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 581, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_exp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 581, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_exp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyNumber_Negative(__pyx_v_out_vec); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 581, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Negative(__pyx_v_out_vec); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_7 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 581, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_t_7, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 581, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_t_7, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 581, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 579, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_r = __pyx_t_7;
     __pyx_t_7 = 0;
     goto __pyx_L0;
 
-    /* "structureboost/structure_gb.pyx":580
+    /* "structureboost/structure_gb.pyx":578
  *             out_vec = (out_vec + self.learning_rate *
  *                        self.dec_tree_list[i].predict(X_test))
  *         if self.mode == 'classification':             # <<<<<<<<<<<<<<
  *             return(1/(1+np.exp(-out_vec)))
  *         else:
  */
   }
 
-  /* "structureboost/structure_gb.pyx":583
+  /* "structureboost/structure_gb.pyx":581
  *             return(1/(1+np.exp(-out_vec)))
  *         else:
  *             return(out_vec)             # <<<<<<<<<<<<<<
  * 
  *     def predict_proba(self, X_test, int num_trees_to_use=-1):
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_v_out_vec);
     __pyx_r = __pyx_v_out_vec;
     goto __pyx_L0;
   }
 
-  /* "structureboost/structure_gb.pyx":564
+  /* "structureboost/structure_gb.pyx":562
  *                 return(self._predict_py(X_test, num_trees_to_use))
  * 
  *     def _predict_py(self, X_test, int num_trees_to_use=-1):             # <<<<<<<<<<<<<<
  *         cdef int i
  *         if num_trees_to_use == -1:
  */
 
@@ -14036,15 +14023,15 @@
   __Pyx_XDECREF(__pyx_v_out_vec);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":585
+/* "structureboost/structure_gb.pyx":583
  *             return(out_vec)
  * 
  *     def predict_proba(self, X_test, int num_trees_to_use=-1):             # <<<<<<<<<<<<<<
  *         """Returns a n x 2 matrix of class probabilities
  * 
  */
 
@@ -14083,47 +14070,47 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X_test)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("predict_proba", 0, 2, 3, 1); __PYX_ERR(0, 585, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("predict_proba", 0, 2, 3, 1); __PYX_ERR(0, 583, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num_trees_to_use);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "predict_proba") < 0)) __PYX_ERR(0, 585, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "predict_proba") < 0)) __PYX_ERR(0, 583, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_self = values[0];
     __pyx_v_X_test = values[1];
     if (values[2]) {
-      __pyx_v_num_trees_to_use = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_num_trees_to_use == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 585, __pyx_L3_error)
+      __pyx_v_num_trees_to_use = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_num_trees_to_use == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 583, __pyx_L3_error)
     } else {
       __pyx_v_num_trees_to_use = ((int)((int)-1));
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("predict_proba", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 585, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("predict_proba", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 583, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost.predict_proba", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_36predict_proba(__pyx_self, __pyx_v_self, __pyx_v_X_test, __pyx_v_num_trees_to_use);
 
@@ -14144,26 +14131,26 @@
   int __pyx_t_5;
   PyObject *__pyx_t_6 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__21)
   __Pyx_RefNannySetupContext("predict_proba", 0);
-  __Pyx_TraceCall("predict_proba", __pyx_f[0], 585, 0, __PYX_ERR(0, 585, __pyx_L1_error));
+  __Pyx_TraceCall("predict_proba", __pyx_f[0], 583, 0, __PYX_ERR(0, 583, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":612
+  /* "structureboost/structure_gb.pyx":610
  *             in X-test.
  *         """
  *         pred_probs = self.predict(X_test, num_trees_to_use)             # <<<<<<<<<<<<<<
  *         return(np.vstack((1-pred_probs, pred_probs)).T)
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 612, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 610, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 612, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 610, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -14172,65 +14159,65 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_5 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_X_test, __pyx_t_3};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 612, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 610, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_X_test, __pyx_t_3};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 612, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_5, 2+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 610, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   } else
   #endif
   {
-    __pyx_t_6 = PyTuple_New(2+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 612, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 610, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     if (__pyx_t_4) {
       __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
     }
     __Pyx_INCREF(__pyx_v_X_test);
     __Pyx_GIVEREF(__pyx_v_X_test);
     PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_5, __pyx_v_X_test);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, __pyx_t_3);
     __pyx_t_3 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 612, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 610, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_pred_probs = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":613
+  /* "structureboost/structure_gb.pyx":611
  *         """
  *         pred_probs = self.predict(X_test, num_trees_to_use)
  *         return(np.vstack((1-pred_probs, pred_probs)).T)             # <<<<<<<<<<<<<<
  * 
  *     def _predict_fast(self, X_test, int num_trees_to_use=-1):
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 611, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_vstack); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_vstack); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 611, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_pred_probs, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_pred_probs, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 611, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 611, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __Pyx_INCREF(__pyx_v_pred_probs);
   __Pyx_GIVEREF(__pyx_v_pred_probs);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_pred_probs);
   __pyx_t_2 = 0;
@@ -14243,25 +14230,25 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 613, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 611, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_T); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_T); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 611, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_6;
   __pyx_t_6 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":585
+  /* "structureboost/structure_gb.pyx":583
  *             return(out_vec)
  * 
  *     def predict_proba(self, X_test, int num_trees_to_use=-1):             # <<<<<<<<<<<<<<
  *         """Returns a n x 2 matrix of class probabilities
  * 
  */
 
@@ -14278,15 +14265,15 @@
   __Pyx_XDECREF(__pyx_v_pred_probs);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":615
+/* "structureboost/structure_gb.pyx":613
  *         return(np.vstack((1-pred_probs, pred_probs)).T)
  * 
  *     def _predict_fast(self, X_test, int num_trees_to_use=-1):             # <<<<<<<<<<<<<<
  *         cdef int i
  * 
  */
 
@@ -14324,47 +14311,47 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X_test)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_predict_fast", 0, 2, 3, 1); __PYX_ERR(0, 615, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_predict_fast", 0, 2, 3, 1); __PYX_ERR(0, 613, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num_trees_to_use);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_predict_fast") < 0)) __PYX_ERR(0, 615, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_predict_fast") < 0)) __PYX_ERR(0, 613, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_self = values[0];
     __pyx_v_X_test = values[1];
     if (values[2]) {
-      __pyx_v_num_trees_to_use = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_num_trees_to_use == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 615, __pyx_L3_error)
+      __pyx_v_num_trees_to_use = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_num_trees_to_use == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 613, __pyx_L3_error)
     } else {
       __pyx_v_num_trees_to_use = ((int)((int)-1));
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_predict_fast", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 615, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_predict_fast", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 613, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost._predict_fast", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_38_predict_fast(__pyx_self, __pyx_v_self, __pyx_v_X_test, __pyx_v_num_trees_to_use);
 
@@ -14389,82 +14376,82 @@
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__22)
   __Pyx_RefNannySetupContext("_predict_fast", 0);
-  __Pyx_TraceCall("_predict_fast", __pyx_f[0], 615, 0, __PYX_ERR(0, 615, __pyx_L1_error));
+  __Pyx_TraceCall("_predict_fast", __pyx_f[0], 613, 0, __PYX_ERR(0, 613, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":618
+  /* "structureboost/structure_gb.pyx":616
  *         cdef int i
  * 
  *         if num_trees_to_use == -1:             # <<<<<<<<<<<<<<
  *             num_trees_to_use = self.num_trees_for_prediction
  *         if self.initial_model is None:
  */
   __pyx_t_1 = ((__pyx_v_num_trees_to_use == -1L) != 0);
   if (__pyx_t_1) {
 
-    /* "structureboost/structure_gb.pyx":619
+    /* "structureboost/structure_gb.pyx":617
  * 
  *         if num_trees_to_use == -1:
  *             num_trees_to_use = self.num_trees_for_prediction             # <<<<<<<<<<<<<<
  *         if self.initial_model is None:
  *             # todo: revisit below
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_trees_for_prediction); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 619, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_trees_for_prediction); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 617, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 619, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 617, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_num_trees_to_use = __pyx_t_3;
 
-    /* "structureboost/structure_gb.pyx":618
+    /* "structureboost/structure_gb.pyx":616
  *         cdef int i
  * 
  *         if num_trees_to_use == -1:             # <<<<<<<<<<<<<<
  *             num_trees_to_use = self.num_trees_for_prediction
  *         if self.initial_model is None:
  */
   }
 
-  /* "structureboost/structure_gb.pyx":620
+  /* "structureboost/structure_gb.pyx":618
  *         if num_trees_to_use == -1:
  *             num_trees_to_use = self.num_trees_for_prediction
  *         if self.initial_model is None:             # <<<<<<<<<<<<<<
  *             # todo: revisit below
  *             out_vec = self.initial_pred[0]*np.ones(X_test.shape[0])
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 620, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 618, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_1 = (__pyx_t_2 == Py_None);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_4 = (__pyx_t_1 != 0);
   if (__pyx_t_4) {
 
-    /* "structureboost/structure_gb.pyx":622
+    /* "structureboost/structure_gb.pyx":620
  *         if self.initial_model is None:
  *             # todo: revisit below
  *             out_vec = self.initial_pred[0]*np.ones(X_test.shape[0])             # <<<<<<<<<<<<<<
  *         elif self.mode=='classification':
  *             out_vec = self.initial_model.predict_proba(X_test)[:,1]
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_pred); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 622, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_pred); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 622, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 622, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ones); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 622, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_ones); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_test, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 622, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_test, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 622, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_6, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
@@ -14472,93 +14459,93 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_6, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_8);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 622, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_Multiply(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 622, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Multiply(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 620, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_out_vec = __pyx_t_7;
     __pyx_t_7 = 0;
 
-    /* "structureboost/structure_gb.pyx":620
+    /* "structureboost/structure_gb.pyx":618
  *         if num_trees_to_use == -1:
  *             num_trees_to_use = self.num_trees_for_prediction
  *         if self.initial_model is None:             # <<<<<<<<<<<<<<
  *             # todo: revisit below
  *             out_vec = self.initial_pred[0]*np.ones(X_test.shape[0])
  */
     goto __pyx_L4;
   }
 
-  /* "structureboost/structure_gb.pyx":623
+  /* "structureboost/structure_gb.pyx":621
  *             # todo: revisit below
  *             out_vec = self.initial_pred[0]*np.ones(X_test.shape[0])
  *         elif self.mode=='classification':             # <<<<<<<<<<<<<<
  *             out_vec = self.initial_model.predict_proba(X_test)[:,1]
  *             out_vec = np.clip(out_vec, 1e-15, 1-1e-15)
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_mode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_mode); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 621, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_classification, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_classification, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 621, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   if (__pyx_t_4) {
 
-    /* "structureboost/structure_gb.pyx":624
+    /* "structureboost/structure_gb.pyx":622
  *             out_vec = self.initial_pred[0]*np.ones(X_test.shape[0])
  *         elif self.mode=='classification':
  *             out_vec = self.initial_model.predict_proba(X_test)[:,1]             # <<<<<<<<<<<<<<
  *             out_vec = np.clip(out_vec, 1e-15, 1-1e-15)
  *             out_vec = np.log(out_vec/(1-out_vec))
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 624, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 622, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_predict_proba); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 624, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_predict_proba); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 622, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_7 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_v_X_test) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_X_test);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 624, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 622, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_tuple__6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 624, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_tuple__6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 622, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_v_out_vec = __pyx_t_5;
     __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":625
+    /* "structureboost/structure_gb.pyx":623
  *         elif self.mode=='classification':
  *             out_vec = self.initial_model.predict_proba(X_test)[:,1]
  *             out_vec = np.clip(out_vec, 1e-15, 1-1e-15)             # <<<<<<<<<<<<<<
  *             out_vec = np.log(out_vec/(1-out_vec))
  *         else:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 625, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 623, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_clip); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 625, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_clip); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 623, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyFloat_FromDouble((1.0 - 1e-15)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 625, __pyx_L1_error)
+    __pyx_t_7 = PyFloat_FromDouble((1.0 - 1e-15)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 623, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_8 = NULL;
     __pyx_t_3 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -14567,67 +14554,67 @@
         __Pyx_DECREF_SET(__pyx_t_2, function);
         __pyx_t_3 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_v_out_vec, __pyx_float_1eneg_15, __pyx_t_7};
-      __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_3, 3+__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 625, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_3, 3+__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[4] = {__pyx_t_8, __pyx_v_out_vec, __pyx_float_1eneg_15, __pyx_t_7};
-      __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_3, 3+__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 625, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_3, 3+__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     {
-      __pyx_t_6 = PyTuple_New(3+__pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 625, __pyx_L1_error)
+      __pyx_t_6 = PyTuple_New(3+__pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 623, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       if (__pyx_t_8) {
         __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_8); __pyx_t_8 = NULL;
       }
       __Pyx_INCREF(__pyx_v_out_vec);
       __Pyx_GIVEREF(__pyx_v_out_vec);
       PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_3, __pyx_v_out_vec);
       __Pyx_INCREF(__pyx_float_1eneg_15);
       __Pyx_GIVEREF(__pyx_float_1eneg_15);
       PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_3, __pyx_float_1eneg_15);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_3, __pyx_t_7);
       __pyx_t_7 = 0;
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 625, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF_SET(__pyx_v_out_vec, __pyx_t_5);
     __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":626
+    /* "structureboost/structure_gb.pyx":624
  *             out_vec = self.initial_model.predict_proba(X_test)[:,1]
  *             out_vec = np.clip(out_vec, 1e-15, 1-1e-15)
  *             out_vec = np.log(out_vec/(1-out_vec))             # <<<<<<<<<<<<<<
  *         else:
  *             out_vec = self.initial_model.predict(X_test)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 626, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 624, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_log); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 626, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_log); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 624, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_out_vec, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 626, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_out_vec, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 624, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_7 = __Pyx_PyNumber_Divide(__pyx_v_out_vec, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 626, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyNumber_Divide(__pyx_v_out_vec, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 624, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
@@ -14635,126 +14622,126 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_5 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_2, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_7);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 626, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 624, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF_SET(__pyx_v_out_vec, __pyx_t_5);
     __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":623
+    /* "structureboost/structure_gb.pyx":621
  *             # todo: revisit below
  *             out_vec = self.initial_pred[0]*np.ones(X_test.shape[0])
  *         elif self.mode=='classification':             # <<<<<<<<<<<<<<
  *             out_vec = self.initial_model.predict_proba(X_test)[:,1]
  *             out_vec = np.clip(out_vec, 1e-15, 1-1e-15)
  */
     goto __pyx_L4;
   }
 
-  /* "structureboost/structure_gb.pyx":628
+  /* "structureboost/structure_gb.pyx":626
  *             out_vec = np.log(out_vec/(1-out_vec))
  *         else:
  *             out_vec = self.initial_model.predict(X_test)             # <<<<<<<<<<<<<<
  *         tree_pred_mat = predict_with_tensor_c(self.pred_tens_float[:num_trees_to_use,:,:],
  *                                               self.pred_tens_int[:num_trees_to_use,:,:],
  */
   /*else*/ {
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 628, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 626, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_predict); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 628, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_predict); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 626, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_6);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_6, __pyx_v_X_test) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_X_test);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 628, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 626, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_v_out_vec = __pyx_t_5;
     __pyx_t_5 = 0;
   }
   __pyx_L4:;
 
-  /* "structureboost/structure_gb.pyx":629
+  /* "structureboost/structure_gb.pyx":627
  *         else:
  *             out_vec = self.initial_model.predict(X_test)
  *         tree_pred_mat = predict_with_tensor_c(self.pred_tens_float[:num_trees_to_use,:,:],             # <<<<<<<<<<<<<<
  *                                               self.pred_tens_int[:num_trees_to_use,:,:],
  *                                               X_test)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_predict_with_tensor_c); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 629, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_predict_with_tensor_c); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 627, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 629, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 627, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 629, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 627, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_8 = PySlice_New(Py_None, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 629, __pyx_L1_error)
+  __pyx_t_8 = PySlice_New(Py_None, __pyx_t_2, Py_None); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 627, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 629, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 627, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_8);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_8);
   __Pyx_INCREF(__pyx_slice__5);
   __Pyx_GIVEREF(__pyx_slice__5);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_slice__5);
   __Pyx_INCREF(__pyx_slice__5);
   __Pyx_GIVEREF(__pyx_slice__5);
   PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_slice__5);
   __pyx_t_8 = 0;
-  __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 629, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 627, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "structureboost/structure_gb.pyx":630
+  /* "structureboost/structure_gb.pyx":628
  *             out_vec = self.initial_model.predict(X_test)
  *         tree_pred_mat = predict_with_tensor_c(self.pred_tens_float[:num_trees_to_use,:,:],
  *                                               self.pred_tens_int[:num_trees_to_use,:,:],             # <<<<<<<<<<<<<<
  *                                               X_test)
  *         out_vec = out_vec + self.learning_rate*np.sum(tree_pred_mat, axis=1)
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_9 = PySlice_New(Py_None, __pyx_t_6, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_9 = PySlice_New(Py_None, __pyx_t_6, Py_None); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_9);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_9);
   __Pyx_INCREF(__pyx_slice__5);
   __Pyx_GIVEREF(__pyx_slice__5);
   PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_slice__5);
   __Pyx_INCREF(__pyx_slice__5);
   __Pyx_GIVEREF(__pyx_slice__5);
   PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_slice__5);
   __pyx_t_9 = 0;
-  __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_GetItem(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "structureboost/structure_gb.pyx":631
+  /* "structureboost/structure_gb.pyx":629
  *         tree_pred_mat = predict_with_tensor_c(self.pred_tens_float[:num_trees_to_use,:,:],
  *                                               self.pred_tens_int[:num_trees_to_use,:,:],
  *                                               X_test)             # <<<<<<<<<<<<<<
  *         out_vec = out_vec + self.learning_rate*np.sum(tree_pred_mat, axis=1)
  *         if self.mode == 'classification':
  */
   __pyx_t_6 = NULL;
@@ -14768,169 +14755,169 @@
       __Pyx_DECREF_SET(__pyx_t_7, function);
       __pyx_t_3 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_7)) {
     PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_8, __pyx_t_9, __pyx_v_X_test};
-    __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_3, 3+__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 629, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_3, 3+__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_7)) {
     PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_8, __pyx_t_9, __pyx_v_X_test};
-    __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_3, 3+__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 629, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyCFunction_FastCall(__pyx_t_7, __pyx_temp+1-__pyx_t_3, 3+__pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   } else
   #endif
   {
-    __pyx_t_2 = PyTuple_New(3+__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 629, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(3+__pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     if (__pyx_t_6) {
       __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6); __pyx_t_6 = NULL;
     }
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_3, __pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_9);
     PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_3, __pyx_t_9);
     __Pyx_INCREF(__pyx_v_X_test);
     __Pyx_GIVEREF(__pyx_v_X_test);
     PyTuple_SET_ITEM(__pyx_t_2, 2+__pyx_t_3, __pyx_v_X_test);
     __pyx_t_8 = 0;
     __pyx_t_9 = 0;
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 629, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_2, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_v_tree_pred_mat = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "structureboost/structure_gb.pyx":632
+  /* "structureboost/structure_gb.pyx":630
  *                                               self.pred_tens_int[:num_trees_to_use,:,:],
  *                                               X_test)
  *         out_vec = out_vec + self.learning_rate*np.sum(tree_pred_mat, axis=1)             # <<<<<<<<<<<<<<
  *         if self.mode == 'classification':
  *             return(1/(1+np.exp(-out_vec)))
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_learning_rate); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_learning_rate); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 630, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 630, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_sum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 630, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 630, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_INCREF(__pyx_v_tree_pred_mat);
   __Pyx_GIVEREF(__pyx_v_tree_pred_mat);
   PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_v_tree_pred_mat);
-  __pyx_t_9 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 630, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
-  if (PyDict_SetItem(__pyx_t_9, __pyx_n_s_axis, __pyx_int_1) < 0) __PYX_ERR(0, 632, __pyx_L1_error)
-  __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 632, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_9, __pyx_n_s_axis, __pyx_int_1) < 0) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_7, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 630, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-  __pyx_t_9 = PyNumber_Multiply(__pyx_t_5, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_9 = PyNumber_Multiply(__pyx_t_5, __pyx_t_8); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 630, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_9);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_8 = PyNumber_Add(__pyx_v_out_vec, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_8 = PyNumber_Add(__pyx_v_out_vec, __pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 630, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
   __Pyx_DECREF_SET(__pyx_v_out_vec, __pyx_t_8);
   __pyx_t_8 = 0;
 
-  /* "structureboost/structure_gb.pyx":633
+  /* "structureboost/structure_gb.pyx":631
  *                                               X_test)
  *         out_vec = out_vec + self.learning_rate*np.sum(tree_pred_mat, axis=1)
  *         if self.mode == 'classification':             # <<<<<<<<<<<<<<
  *             return(1/(1+np.exp(-out_vec)))
  *         else:
  */
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_mode); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 633, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_mode); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 631, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_t_8, __pyx_n_u_classification, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 633, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_t_8, __pyx_n_u_classification, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 631, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   if (__pyx_t_4) {
 
-    /* "structureboost/structure_gb.pyx":634
+    /* "structureboost/structure_gb.pyx":632
  *         out_vec = out_vec + self.learning_rate*np.sum(tree_pred_mat, axis=1)
  *         if self.mode == 'classification':
  *             return(1/(1+np.exp(-out_vec)))             # <<<<<<<<<<<<<<
  *         else:
  *             return(out_vec)
  */
     __Pyx_XDECREF(__pyx_r);
-    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 634, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_exp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 634, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_exp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = PyNumber_Negative(__pyx_v_out_vec); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 634, __pyx_L1_error)
+    __pyx_t_9 = PyNumber_Negative(__pyx_v_out_vec); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_8 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_7, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_9);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 634, __pyx_L1_error)
+    if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_t_8, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 634, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_t_8, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 634, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_t_5); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_r = __pyx_t_8;
     __pyx_t_8 = 0;
     goto __pyx_L0;
 
-    /* "structureboost/structure_gb.pyx":633
+    /* "structureboost/structure_gb.pyx":631
  *                                               X_test)
  *         out_vec = out_vec + self.learning_rate*np.sum(tree_pred_mat, axis=1)
  *         if self.mode == 'classification':             # <<<<<<<<<<<<<<
  *             return(1/(1+np.exp(-out_vec)))
  *         else:
  */
   }
 
-  /* "structureboost/structure_gb.pyx":636
+  /* "structureboost/structure_gb.pyx":634
  *             return(1/(1+np.exp(-out_vec)))
  *         else:
  *             return(out_vec)             # <<<<<<<<<<<<<<
  * 
  *     def _process_feature_configs(self):
  */
   /*else*/ {
     __Pyx_XDECREF(__pyx_r);
     __Pyx_INCREF(__pyx_v_out_vec);
     __pyx_r = __pyx_v_out_vec;
     goto __pyx_L0;
   }
 
-  /* "structureboost/structure_gb.pyx":615
+  /* "structureboost/structure_gb.pyx":613
  *         return(np.vstack((1-pred_probs, pred_probs)).T)
  * 
  *     def _predict_fast(self, X_test, int num_trees_to_use=-1):             # <<<<<<<<<<<<<<
  *         cdef int i
  * 
  */
 
@@ -14949,15 +14936,15 @@
   __Pyx_XDECREF(__pyx_v_tree_pred_mat);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":638
+/* "structureboost/structure_gb.pyx":636
  *             return(out_vec)
  * 
  *     def _process_feature_configs(self):             # <<<<<<<<<<<<<<
  *         fg = {}
  *         for feat_name in self.feature_configs.keys():
  */
 
@@ -14993,206 +14980,206 @@
   int __pyx_t_10;
   PyObject *__pyx_t_11 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__23)
   __Pyx_RefNannySetupContext("_process_feature_configs", 0);
-  __Pyx_TraceCall("_process_feature_configs", __pyx_f[0], 638, 0, __PYX_ERR(0, 638, __pyx_L1_error));
+  __Pyx_TraceCall("_process_feature_configs", __pyx_f[0], 636, 0, __PYX_ERR(0, 636, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":639
+  /* "structureboost/structure_gb.pyx":637
  * 
  *     def _process_feature_configs(self):
  *         fg = {}             # <<<<<<<<<<<<<<
  *         for feat_name in self.feature_configs.keys():
  *             if 'graph' in self.feature_configs[feat_name].keys():
  */
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 639, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 637, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_fg = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":640
+  /* "structureboost/structure_gb.pyx":638
  *     def _process_feature_configs(self):
  *         fg = {}
  *         for feat_name in self.feature_configs.keys():             # <<<<<<<<<<<<<<
  *             if 'graph' in self.feature_configs[feat_name].keys():
  *                 fg[feat_name] = self.feature_configs[feat_name]['graph']
  */
   __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 640, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 638, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   if (unlikely(__pyx_t_5 == Py_None)) {
     PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "keys");
-    __PYX_ERR(0, 640, __pyx_L1_error)
+    __PYX_ERR(0, 638, __pyx_L1_error)
   }
-  __pyx_t_6 = __Pyx_dict_iterator(__pyx_t_5, 0, __pyx_n_s_keys, (&__pyx_t_3), (&__pyx_t_4)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 640, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_dict_iterator(__pyx_t_5, 0, __pyx_n_s_keys, (&__pyx_t_3), (&__pyx_t_4)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 638, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_XDECREF(__pyx_t_1);
   __pyx_t_1 = __pyx_t_6;
   __pyx_t_6 = 0;
   while (1) {
     __pyx_t_7 = __Pyx_dict_iter_next(__pyx_t_1, __pyx_t_3, &__pyx_t_2, &__pyx_t_6, NULL, NULL, __pyx_t_4);
     if (unlikely(__pyx_t_7 == 0)) break;
-    if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 640, __pyx_L1_error)
+    if (unlikely(__pyx_t_7 == -1)) __PYX_ERR(0, 638, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_XDECREF_SET(__pyx_v_feat_name, __pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "structureboost/structure_gb.pyx":641
+    /* "structureboost/structure_gb.pyx":639
  *         fg = {}
  *         for feat_name in self.feature_configs.keys():
  *             if 'graph' in self.feature_configs[feat_name].keys():             # <<<<<<<<<<<<<<
  *                 fg[feat_name] = self.feature_configs[feat_name]['graph']
  *             if 'split_method' in self.feature_configs[feat_name].keys():
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_feat_name); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_feat_name); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_keys); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_keys); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __pyx_t_8 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_8);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_6 = (__pyx_t_8) ? __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_8) : __Pyx_PyObject_CallNoArg(__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 641, __pyx_L1_error)
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_9 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_graph, __pyx_t_6, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 641, __pyx_L1_error)
+    __pyx_t_9 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_graph, __pyx_t_6, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 639, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_10 = (__pyx_t_9 != 0);
     if (__pyx_t_10) {
 
-      /* "structureboost/structure_gb.pyx":642
+      /* "structureboost/structure_gb.pyx":640
  *         for feat_name in self.feature_configs.keys():
  *             if 'graph' in self.feature_configs[feat_name].keys():
  *                 fg[feat_name] = self.feature_configs[feat_name]['graph']             # <<<<<<<<<<<<<<
  *             if 'split_method' in self.feature_configs[feat_name].keys():
  *                 if self.feature_configs[feat_name]['split_method'] == 'onehot':
  */
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 642, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 640, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_feat_name); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 642, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_feat_name); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 640, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_Dict_GetItem(__pyx_t_5, __pyx_n_u_graph); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 642, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_Dict_GetItem(__pyx_t_5, __pyx_n_u_graph); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 640, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      if (unlikely(PyDict_SetItem(__pyx_v_fg, __pyx_v_feat_name, __pyx_t_6) < 0)) __PYX_ERR(0, 642, __pyx_L1_error)
+      if (unlikely(PyDict_SetItem(__pyx_v_fg, __pyx_v_feat_name, __pyx_t_6) < 0)) __PYX_ERR(0, 640, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-      /* "structureboost/structure_gb.pyx":641
+      /* "structureboost/structure_gb.pyx":639
  *         fg = {}
  *         for feat_name in self.feature_configs.keys():
  *             if 'graph' in self.feature_configs[feat_name].keys():             # <<<<<<<<<<<<<<
  *                 fg[feat_name] = self.feature_configs[feat_name]['graph']
  *             if 'split_method' in self.feature_configs[feat_name].keys():
  */
     }
 
-    /* "structureboost/structure_gb.pyx":643
+    /* "structureboost/structure_gb.pyx":641
  *             if 'graph' in self.feature_configs[feat_name].keys():
  *                 fg[feat_name] = self.feature_configs[feat_name]['graph']
  *             if 'split_method' in self.feature_configs[feat_name].keys():             # <<<<<<<<<<<<<<
  *                 if self.feature_configs[feat_name]['split_method'] == 'onehot':
  *                     fg[feat_name] = graphs.complete_graph(
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 643, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 641, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_feat_name); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 643, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_feat_name); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 641, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_keys); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 643, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_8, __pyx_n_s_keys); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 641, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __pyx_t_8 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_8);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_6 = (__pyx_t_8) ? __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_8) : __Pyx_PyObject_CallNoArg(__pyx_t_5);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 643, __pyx_L1_error)
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 641, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_10 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_split_method, __pyx_t_6, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 643, __pyx_L1_error)
+    __pyx_t_10 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_split_method, __pyx_t_6, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 641, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_9 = (__pyx_t_10 != 0);
     if (__pyx_t_9) {
 
-      /* "structureboost/structure_gb.pyx":644
+      /* "structureboost/structure_gb.pyx":642
  *                 fg[feat_name] = self.feature_configs[feat_name]['graph']
  *             if 'split_method' in self.feature_configs[feat_name].keys():
  *                 if self.feature_configs[feat_name]['split_method'] == 'onehot':             # <<<<<<<<<<<<<<
  *                     fg[feat_name] = graphs.complete_graph(
  *                                     self.feature_configs[
  */
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 644, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 642, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_feat_name); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 644, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_v_feat_name); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 642, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_Dict_GetItem(__pyx_t_5, __pyx_n_u_split_method); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 644, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_Dict_GetItem(__pyx_t_5, __pyx_n_u_split_method); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 642, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_t_6, __pyx_n_u_onehot, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 644, __pyx_L1_error)
+      __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_t_6, __pyx_n_u_onehot, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 642, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       if (__pyx_t_9) {
 
-        /* "structureboost/structure_gb.pyx":645
+        /* "structureboost/structure_gb.pyx":643
  *             if 'split_method' in self.feature_configs[feat_name].keys():
  *                 if self.feature_configs[feat_name]['split_method'] == 'onehot':
  *                     fg[feat_name] = graphs.complete_graph(             # <<<<<<<<<<<<<<
  *                                     self.feature_configs[
  *                                                  feat_name]['feature_vals'])
  */
-        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_graphs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 645, __pyx_L1_error)
+        __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_graphs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 643, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
-        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_complete_graph); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 645, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_complete_graph); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 643, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-        /* "structureboost/structure_gb.pyx":646
+        /* "structureboost/structure_gb.pyx":644
  *                 if self.feature_configs[feat_name]['split_method'] == 'onehot':
  *                     fg[feat_name] = graphs.complete_graph(
  *                                     self.feature_configs[             # <<<<<<<<<<<<<<
  *                                                  feat_name]['feature_vals'])
  *         self.feature_graphs = fg
  */
-        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 646, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_feature_configs); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 644, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
 
-        /* "structureboost/structure_gb.pyx":647
+        /* "structureboost/structure_gb.pyx":645
  *                     fg[feat_name] = graphs.complete_graph(
  *                                     self.feature_configs[
  *                                                  feat_name]['feature_vals'])             # <<<<<<<<<<<<<<
  *         self.feature_graphs = fg
  * 
  */
-        __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_feat_name); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 646, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyObject_GetItem(__pyx_t_5, __pyx_v_feat_name); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 644, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_11);
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_t_11, __pyx_n_u_feature_vals); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 647, __pyx_L1_error)
+        __pyx_t_5 = __Pyx_PyObject_Dict_GetItem(__pyx_t_11, __pyx_n_u_feature_vals); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 645, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
         __pyx_t_11 = NULL;
         if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
           __pyx_t_11 = PyMethod_GET_SELF(__pyx_t_8);
           if (likely(__pyx_t_11)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
@@ -15200,58 +15187,58 @@
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_8, function);
           }
         }
         __pyx_t_6 = (__pyx_t_11) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_11, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_5);
         __Pyx_XDECREF(__pyx_t_11); __pyx_t_11 = 0;
         __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 645, __pyx_L1_error)
+        if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 643, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-        /* "structureboost/structure_gb.pyx":645
+        /* "structureboost/structure_gb.pyx":643
  *             if 'split_method' in self.feature_configs[feat_name].keys():
  *                 if self.feature_configs[feat_name]['split_method'] == 'onehot':
  *                     fg[feat_name] = graphs.complete_graph(             # <<<<<<<<<<<<<<
  *                                     self.feature_configs[
  *                                                  feat_name]['feature_vals'])
  */
-        if (unlikely(PyDict_SetItem(__pyx_v_fg, __pyx_v_feat_name, __pyx_t_6) < 0)) __PYX_ERR(0, 645, __pyx_L1_error)
+        if (unlikely(PyDict_SetItem(__pyx_v_fg, __pyx_v_feat_name, __pyx_t_6) < 0)) __PYX_ERR(0, 643, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-        /* "structureboost/structure_gb.pyx":644
+        /* "structureboost/structure_gb.pyx":642
  *                 fg[feat_name] = self.feature_configs[feat_name]['graph']
  *             if 'split_method' in self.feature_configs[feat_name].keys():
  *                 if self.feature_configs[feat_name]['split_method'] == 'onehot':             # <<<<<<<<<<<<<<
  *                     fg[feat_name] = graphs.complete_graph(
  *                                     self.feature_configs[
  */
       }
 
-      /* "structureboost/structure_gb.pyx":643
+      /* "structureboost/structure_gb.pyx":641
  *             if 'graph' in self.feature_configs[feat_name].keys():
  *                 fg[feat_name] = self.feature_configs[feat_name]['graph']
  *             if 'split_method' in self.feature_configs[feat_name].keys():             # <<<<<<<<<<<<<<
  *                 if self.feature_configs[feat_name]['split_method'] == 'onehot':
  *                     fg[feat_name] = graphs.complete_graph(
  */
     }
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":648
+  /* "structureboost/structure_gb.pyx":646
  *                                     self.feature_configs[
  *                                                  feat_name]['feature_vals'])
  *         self.feature_graphs = fg             # <<<<<<<<<<<<<<
  * 
  *     def predict_shap(self, X_test, int num_trees_to_use=-1, same_col_pos=True):
  */
-  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_feature_graphs, __pyx_v_fg) < 0) __PYX_ERR(0, 648, __pyx_L1_error)
+  if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_feature_graphs, __pyx_v_fg) < 0) __PYX_ERR(0, 646, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":638
+  /* "structureboost/structure_gb.pyx":636
  *             return(out_vec)
  * 
  *     def _process_feature_configs(self):             # <<<<<<<<<<<<<<
  *         fg = {}
  *         for feat_name in self.feature_configs.keys():
  */
 
@@ -15271,15 +15258,15 @@
   __Pyx_XDECREF(__pyx_v_feat_name);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":650
+/* "structureboost/structure_gb.pyx":648
  *         self.feature_graphs = fg
  * 
  *     def predict_shap(self, X_test, int num_trees_to_use=-1, same_col_pos=True):             # <<<<<<<<<<<<<<
  *         if (type(X_test)==np.ndarray):
  *             if self.optimizable:
  */
 
@@ -15321,15 +15308,15 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X_test)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("predict_shap", 0, 2, 4, 1); __PYX_ERR(0, 650, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("predict_shap", 0, 2, 4, 1); __PYX_ERR(0, 648, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num_trees_to_use);
           if (value) { values[2] = value; kw_args--; }
         }
@@ -15337,15 +15324,15 @@
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_same_col_pos);
           if (value) { values[3] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "predict_shap") < 0)) __PYX_ERR(0, 650, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "predict_shap") < 0)) __PYX_ERR(0, 648, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
@@ -15354,23 +15341,23 @@
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_self = values[0];
     __pyx_v_X_test = values[1];
     if (values[2]) {
-      __pyx_v_num_trees_to_use = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_num_trees_to_use == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 650, __pyx_L3_error)
+      __pyx_v_num_trees_to_use = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_num_trees_to_use == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 648, __pyx_L3_error)
     } else {
       __pyx_v_num_trees_to_use = ((int)((int)-1));
     }
     __pyx_v_same_col_pos = values[3];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("predict_shap", 0, 2, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 650, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("predict_shap", 0, 2, 4, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 648, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost.predict_shap", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_42predict_shap(__pyx_self, __pyx_v_self, __pyx_v_X_test, __pyx_v_num_trees_to_use, __pyx_v_same_col_pos);
 
@@ -15393,65 +15380,65 @@
   int __pyx_t_8;
   PyObject *__pyx_t_9 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__24)
   __Pyx_RefNannySetupContext("predict_shap", 0);
-  __Pyx_TraceCall("predict_shap", __pyx_f[0], 650, 0, __PYX_ERR(0, 650, __pyx_L1_error));
+  __Pyx_TraceCall("predict_shap", __pyx_f[0], 648, 0, __PYX_ERR(0, 648, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":651
+  /* "structureboost/structure_gb.pyx":649
  * 
  *     def predict_shap(self, X_test, int num_trees_to_use=-1, same_col_pos=True):
  *         if (type(X_test)==np.ndarray):             # <<<<<<<<<<<<<<
  *             if self.optimizable:
  *                 if self.optimized:
  */
-  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_X_test)), ((PyObject *)__pyx_ptype_5numpy_ndarray), Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 651, __pyx_L1_error)
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 651, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_X_test)), ((PyObject *)__pyx_ptype_5numpy_ndarray), Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 649, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 649, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_gb.pyx":652
+    /* "structureboost/structure_gb.pyx":650
  *     def predict_shap(self, X_test, int num_trees_to_use=-1, same_col_pos=True):
  *         if (type(X_test)==np.ndarray):
  *             if self.optimizable:             # <<<<<<<<<<<<<<
  *                 if self.optimized:
  *                     return(self._predict_shap(X_test, num_trees_to_use))
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimizable); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 652, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimizable); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 650, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 652, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 650, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (__pyx_t_2) {
 
-      /* "structureboost/structure_gb.pyx":653
+      /* "structureboost/structure_gb.pyx":651
  *         if (type(X_test)==np.ndarray):
  *             if self.optimizable:
  *                 if self.optimized:             # <<<<<<<<<<<<<<
  *                     return(self._predict_shap(X_test, num_trees_to_use))
  *                 else:
  */
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimized); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 653, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimized); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 651, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 653, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 651, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       if (__pyx_t_2) {
 
-        /* "structureboost/structure_gb.pyx":654
+        /* "structureboost/structure_gb.pyx":652
  *             if self.optimizable:
  *                 if self.optimized:
  *                     return(self._predict_shap(X_test, num_trees_to_use))             # <<<<<<<<<<<<<<
  *                 else:
  *                     self.get_tensors_for_predict()
  */
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_shap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 654, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_shap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 652, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 654, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 652, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __pyx_t_5 = NULL;
         __pyx_t_6 = 0;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
           if (likely(__pyx_t_5)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -15460,97 +15447,97 @@
             __Pyx_DECREF_SET(__pyx_t_3, function);
             __pyx_t_6 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_X_test, __pyx_t_4};
-          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 652, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_v_X_test, __pyx_t_4};
-          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 652, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         } else
         #endif
         {
-          __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 654, __pyx_L1_error)
+          __pyx_t_7 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 652, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           if (__pyx_t_5) {
             __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
           }
           __Pyx_INCREF(__pyx_v_X_test);
           __Pyx_GIVEREF(__pyx_v_X_test);
           PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_6, __pyx_v_X_test);
           __Pyx_GIVEREF(__pyx_t_4);
           PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_6, __pyx_t_4);
           __pyx_t_4 = 0;
-          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_7, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 652, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         }
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_1;
         __pyx_t_1 = 0;
         goto __pyx_L0;
 
-        /* "structureboost/structure_gb.pyx":653
+        /* "structureboost/structure_gb.pyx":651
  *         if (type(X_test)==np.ndarray):
  *             if self.optimizable:
  *                 if self.optimized:             # <<<<<<<<<<<<<<
  *                     return(self._predict_shap(X_test, num_trees_to_use))
  *                 else:
  */
       }
 
-      /* "structureboost/structure_gb.pyx":656
+      /* "structureboost/structure_gb.pyx":654
  *                     return(self._predict_shap(X_test, num_trees_to_use))
  *                 else:
  *                     self.get_tensors_for_predict()             # <<<<<<<<<<<<<<
  *                     return(self._predict_shap(X_test, num_trees_to_use))
  *             else:
  */
       /*else*/ {
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_tensors_for_predict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 656, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_tensors_for_predict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 654, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __pyx_t_7 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_3);
           if (likely(__pyx_t_7)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
             __Pyx_INCREF(__pyx_t_7);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_3, function);
           }
         }
         __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_7) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
         __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 656, __pyx_L1_error)
+        if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 654, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-        /* "structureboost/structure_gb.pyx":657
+        /* "structureboost/structure_gb.pyx":655
  *                 else:
  *                     self.get_tensors_for_predict()
  *                     return(self._predict_shap(X_test, num_trees_to_use))             # <<<<<<<<<<<<<<
  *             else:
  *                 print("Shap values not available for categorical string or voronoi vars")
  */
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_shap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 657, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_shap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 655, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 657, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 655, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __pyx_t_4 = NULL;
         __pyx_t_6 = 0;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
           if (likely(__pyx_t_4)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -15559,201 +15546,201 @@
             __Pyx_DECREF_SET(__pyx_t_3, function);
             __pyx_t_6 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_X_test, __pyx_t_7};
-          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 657, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 655, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_v_X_test, __pyx_t_7};
-          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 657, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 655, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         } else
         #endif
         {
-          __pyx_t_5 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 657, __pyx_L1_error)
+          __pyx_t_5 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 655, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_5);
           if (__pyx_t_4) {
             __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
           }
           __Pyx_INCREF(__pyx_v_X_test);
           __Pyx_GIVEREF(__pyx_v_X_test);
           PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_6, __pyx_v_X_test);
           __Pyx_GIVEREF(__pyx_t_7);
           PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_6, __pyx_t_7);
           __pyx_t_7 = 0;
-          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 657, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 655, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
         }
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_1;
         __pyx_t_1 = 0;
         goto __pyx_L0;
       }
 
-      /* "structureboost/structure_gb.pyx":652
+      /* "structureboost/structure_gb.pyx":650
  *     def predict_shap(self, X_test, int num_trees_to_use=-1, same_col_pos=True):
  *         if (type(X_test)==np.ndarray):
  *             if self.optimizable:             # <<<<<<<<<<<<<<
  *                 if self.optimized:
  *                     return(self._predict_shap(X_test, num_trees_to_use))
  */
     }
 
-    /* "structureboost/structure_gb.pyx":659
+    /* "structureboost/structure_gb.pyx":657
  *                     return(self._predict_shap(X_test, num_trees_to_use))
  *             else:
  *                 print("Shap values not available for categorical string or voronoi vars")             # <<<<<<<<<<<<<<
  *         elif (type(X_test)==pd.DataFrame):
  *             if same_col_pos:
  */
     /*else*/ {
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 659, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 657, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
 
-    /* "structureboost/structure_gb.pyx":651
+    /* "structureboost/structure_gb.pyx":649
  * 
  *     def predict_shap(self, X_test, int num_trees_to_use=-1, same_col_pos=True):
  *         if (type(X_test)==np.ndarray):             # <<<<<<<<<<<<<<
  *             if self.optimizable:
  *                 if self.optimized:
  */
     goto __pyx_L3;
   }
 
-  /* "structureboost/structure_gb.pyx":660
+  /* "structureboost/structure_gb.pyx":658
  *             else:
  *                 print("Shap values not available for categorical string or voronoi vars")
  *         elif (type(X_test)==pd.DataFrame):             # <<<<<<<<<<<<<<
  *             if same_col_pos:
  *                 if self.optimizable:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pd); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 660, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pd); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 658, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_DataFrame); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 660, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_DataFrame); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 658, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_X_test)), __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 660, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_X_test)), __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 658, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 660, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 658, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_gb.pyx":661
+    /* "structureboost/structure_gb.pyx":659
  *                 print("Shap values not available for categorical string or voronoi vars")
  *         elif (type(X_test)==pd.DataFrame):
  *             if same_col_pos:             # <<<<<<<<<<<<<<
  *                 if self.optimizable:
  *                     if not self.optimized:
  */
-    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_same_col_pos); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 661, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_v_same_col_pos); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 659, __pyx_L1_error)
     if (__pyx_t_2) {
 
-      /* "structureboost/structure_gb.pyx":662
+      /* "structureboost/structure_gb.pyx":660
  *         elif (type(X_test)==pd.DataFrame):
  *             if same_col_pos:
  *                 if self.optimizable:             # <<<<<<<<<<<<<<
  *                     if not self.optimized:
  *                         self.get_tensors_for_predict()
  */
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimizable); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimizable); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 660, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 662, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 660, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       if (__pyx_t_2) {
 
-        /* "structureboost/structure_gb.pyx":663
+        /* "structureboost/structure_gb.pyx":661
  *             if same_col_pos:
  *                 if self.optimizable:
  *                     if not self.optimized:             # <<<<<<<<<<<<<<
  *                         self.get_tensors_for_predict()
  *                     return(self._predict_shap(X_test.to_numpy(), num_trees_to_use))
  */
-        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimized); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 663, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimized); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 661, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 663, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 661, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __pyx_t_8 = ((!__pyx_t_2) != 0);
         if (__pyx_t_8) {
 
-          /* "structureboost/structure_gb.pyx":664
+          /* "structureboost/structure_gb.pyx":662
  *                 if self.optimizable:
  *                     if not self.optimized:
  *                         self.get_tensors_for_predict()             # <<<<<<<<<<<<<<
  *                     return(self._predict_shap(X_test.to_numpy(), num_trees_to_use))
  *                 else:
  */
-          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_tensors_for_predict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 664, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_tensors_for_predict); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 662, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
           __pyx_t_5 = NULL;
           if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
             __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
             if (likely(__pyx_t_5)) {
               PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
               __Pyx_INCREF(__pyx_t_5);
               __Pyx_INCREF(function);
               __Pyx_DECREF_SET(__pyx_t_3, function);
             }
           }
           __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
           __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 664, __pyx_L1_error)
+          if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 662, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-          /* "structureboost/structure_gb.pyx":663
+          /* "structureboost/structure_gb.pyx":661
  *             if same_col_pos:
  *                 if self.optimizable:
  *                     if not self.optimized:             # <<<<<<<<<<<<<<
  *                         self.get_tensors_for_predict()
  *                     return(self._predict_shap(X_test.to_numpy(), num_trees_to_use))
  */
         }
 
-        /* "structureboost/structure_gb.pyx":665
+        /* "structureboost/structure_gb.pyx":663
  *                     if not self.optimized:
  *                         self.get_tensors_for_predict()
  *                     return(self._predict_shap(X_test.to_numpy(), num_trees_to_use))             # <<<<<<<<<<<<<<
  *                 else:
  *                     print("Shap values not available for categorical string or voronoi vars")
  */
         __Pyx_XDECREF(__pyx_r);
-        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_shap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 665, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_predict_shap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 663, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_test, __pyx_n_s_to_numpy); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 665, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_test, __pyx_n_s_to_numpy); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 663, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __pyx_t_4 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_7);
           if (likely(__pyx_t_4)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
             __Pyx_INCREF(__pyx_t_4);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_7, function);
           }
         }
         __pyx_t_5 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_7);
         __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 665, __pyx_L1_error)
+        if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 663, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 665, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_num_trees_to_use); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 663, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __pyx_t_4 = NULL;
         __pyx_t_6 = 0;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
           __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
           if (likely(__pyx_t_4)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -15762,109 +15749,109 @@
             __Pyx_DECREF_SET(__pyx_t_3, function);
             __pyx_t_6 = 1;
           }
         }
         #if CYTHON_FAST_PYCALL
         if (PyFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_5, __pyx_t_7};
-          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 665, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 663, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         } else
         #endif
         #if CYTHON_FAST_PYCCALL
         if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
           PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_5, __pyx_t_7};
-          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 665, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 663, __pyx_L1_error)
           __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         } else
         #endif
         {
-          __pyx_t_9 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 665, __pyx_L1_error)
+          __pyx_t_9 = PyTuple_New(2+__pyx_t_6); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 663, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_9);
           if (__pyx_t_4) {
             __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_4); __pyx_t_4 = NULL;
           }
           __Pyx_GIVEREF(__pyx_t_5);
           PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_6, __pyx_t_5);
           __Pyx_GIVEREF(__pyx_t_7);
           PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_6, __pyx_t_7);
           __pyx_t_5 = 0;
           __pyx_t_7 = 0;
-          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 665, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 663, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
         }
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __pyx_r = __pyx_t_1;
         __pyx_t_1 = 0;
         goto __pyx_L0;
 
-        /* "structureboost/structure_gb.pyx":662
+        /* "structureboost/structure_gb.pyx":660
  *         elif (type(X_test)==pd.DataFrame):
  *             if same_col_pos:
  *                 if self.optimizable:             # <<<<<<<<<<<<<<
  *                     if not self.optimized:
  *                         self.get_tensors_for_predict()
  */
       }
 
-      /* "structureboost/structure_gb.pyx":667
+      /* "structureboost/structure_gb.pyx":665
  *                     return(self._predict_shap(X_test.to_numpy(), num_trees_to_use))
  *                 else:
  *                     print("Shap values not available for categorical string or voronoi vars")             # <<<<<<<<<<<<<<
  *             else:
  *                 print('columns must be in correct order for shap values')
  */
       /*else*/ {
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 667, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__25, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 665, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       }
 
-      /* "structureboost/structure_gb.pyx":661
+      /* "structureboost/structure_gb.pyx":659
  *                 print("Shap values not available for categorical string or voronoi vars")
  *         elif (type(X_test)==pd.DataFrame):
  *             if same_col_pos:             # <<<<<<<<<<<<<<
  *                 if self.optimizable:
  *                     if not self.optimized:
  */
       goto __pyx_L6;
     }
 
-    /* "structureboost/structure_gb.pyx":669
+    /* "structureboost/structure_gb.pyx":667
  *                     print("Shap values not available for categorical string or voronoi vars")
  *             else:
  *                 print('columns must be in correct order for shap values')             # <<<<<<<<<<<<<<
  * 
  *     def _predict_shap(self,
  */
     /*else*/ {
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 669, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__26, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 667, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __pyx_L6:;
 
-    /* "structureboost/structure_gb.pyx":660
+    /* "structureboost/structure_gb.pyx":658
  *             else:
  *                 print("Shap values not available for categorical string or voronoi vars")
  *         elif (type(X_test)==pd.DataFrame):             # <<<<<<<<<<<<<<
  *             if same_col_pos:
  *                 if self.optimizable:
  */
   }
   __pyx_L3:;
 
-  /* "structureboost/structure_gb.pyx":650
+  /* "structureboost/structure_gb.pyx":648
  *         self.feature_graphs = fg
  * 
  *     def predict_shap(self, X_test, int num_trees_to_use=-1, same_col_pos=True):             # <<<<<<<<<<<<<<
  *         if (type(X_test)==np.ndarray):
  *             if self.optimizable:
  */
 
@@ -15883,15 +15870,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":671
+/* "structureboost/structure_gb.pyx":669
  *                 print('columns must be in correct order for shap values')
  * 
  *     def _predict_shap(self,             # <<<<<<<<<<<<<<
  *                     np.ndarray[double, ndim=2] X_test, int num_trees_to_use=-1):
  *         cdef long i,j
  */
 
@@ -15929,53 +15916,53 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X_test)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_predict_shap", 0, 2, 3, 1); __PYX_ERR(0, 671, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_predict_shap", 0, 2, 3, 1); __PYX_ERR(0, 669, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num_trees_to_use);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_predict_shap") < 0)) __PYX_ERR(0, 671, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_predict_shap") < 0)) __PYX_ERR(0, 669, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
     __pyx_v_self = values[0];
     __pyx_v_X_test = ((PyArrayObject *)values[1]);
     if (values[2]) {
-      __pyx_v_num_trees_to_use = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_num_trees_to_use == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 672, __pyx_L3_error)
+      __pyx_v_num_trees_to_use = __Pyx_PyInt_As_int(values[2]); if (unlikely((__pyx_v_num_trees_to_use == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 670, __pyx_L3_error)
     } else {
       __pyx_v_num_trees_to_use = ((int)((int)-1));
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_predict_shap", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 671, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_predict_shap", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 669, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost._predict_shap", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_X_test), __pyx_ptype_5numpy_ndarray, 1, "X_test", 0))) __PYX_ERR(0, 672, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_X_test), __pyx_ptype_5numpy_ndarray, 1, "X_test", 0))) __PYX_ERR(0, 670, __pyx_L1_error)
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_44_predict_shap(__pyx_self, __pyx_v_self, __pyx_v_X_test, __pyx_v_num_trees_to_use);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -16016,92 +16003,92 @@
   int __pyx_t_16;
   PyObject *__pyx_t_17 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__27)
   __Pyx_RefNannySetupContext("_predict_shap", 0);
-  __Pyx_TraceCall("_predict_shap", __pyx_f[0], 671, 0, __PYX_ERR(0, 671, __pyx_L1_error));
+  __Pyx_TraceCall("_predict_shap", __pyx_f[0], 669, 0, __PYX_ERR(0, 669, __pyx_L1_error));
   __pyx_pybuffer_X_test.pybuffer.buf = NULL;
   __pyx_pybuffer_X_test.refcount = 0;
   __pyx_pybuffernd_X_test.data = NULL;
   __pyx_pybuffernd_X_test.rcbuffer = &__pyx_pybuffer_X_test;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X_test.rcbuffer->pybuffer, (PyObject*)__pyx_v_X_test, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 671, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X_test.rcbuffer->pybuffer, (PyObject*)__pyx_v_X_test, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 669, __pyx_L1_error)
   }
   __pyx_pybuffernd_X_test.diminfo[0].strides = __pyx_pybuffernd_X_test.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_X_test.diminfo[0].shape = __pyx_pybuffernd_X_test.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_X_test.diminfo[1].strides = __pyx_pybuffernd_X_test.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_X_test.diminfo[1].shape = __pyx_pybuffernd_X_test.rcbuffer->pybuffer.shape[1];
 
-  /* "structureboost/structure_gb.pyx":674
+  /* "structureboost/structure_gb.pyx":672
  *                     np.ndarray[double, ndim=2] X_test, int num_trees_to_use=-1):
  *         cdef long i,j
  *         cdef long nrows = X_test.shape[0]             # <<<<<<<<<<<<<<
  *         cdef long nfeat = X_test.shape[1] #not including intercept
  *         cdef double start_pred
  */
   __pyx_v_nrows = (__pyx_v_X_test->dimensions[0]);
 
-  /* "structureboost/structure_gb.pyx":675
+  /* "structureboost/structure_gb.pyx":673
  *         cdef long i,j
  *         cdef long nrows = X_test.shape[0]
  *         cdef long nfeat = X_test.shape[1] #not including intercept             # <<<<<<<<<<<<<<
  *         cdef double start_pred
  * 
  */
   __pyx_v_nfeat = (__pyx_v_X_test->dimensions[1]);
 
-  /* "structureboost/structure_gb.pyx":678
+  /* "structureboost/structure_gb.pyx":676
  *         cdef double start_pred
  * 
  *         if num_trees_to_use == -1:             # <<<<<<<<<<<<<<
  *             num_trees_to_use = self.num_trees_for_prediction
  *         phi_out = np.zeros((nrows, nfeat+1))
  */
   __pyx_t_1 = ((__pyx_v_num_trees_to_use == -1L) != 0);
   if (__pyx_t_1) {
 
-    /* "structureboost/structure_gb.pyx":679
+    /* "structureboost/structure_gb.pyx":677
  * 
  *         if num_trees_to_use == -1:
  *             num_trees_to_use = self.num_trees_for_prediction             # <<<<<<<<<<<<<<
  *         phi_out = np.zeros((nrows, nfeat+1))
  *         start_pred=0
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_trees_for_prediction); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 679, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_num_trees_for_prediction); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 677, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 679, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_As_int(__pyx_t_2); if (unlikely((__pyx_t_3 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 677, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_v_num_trees_to_use = __pyx_t_3;
 
-    /* "structureboost/structure_gb.pyx":678
+    /* "structureboost/structure_gb.pyx":676
  *         cdef double start_pred
  * 
  *         if num_trees_to_use == -1:             # <<<<<<<<<<<<<<
  *             num_trees_to_use = self.num_trees_for_prediction
  *         phi_out = np.zeros((nrows, nfeat+1))
  */
   }
 
-  /* "structureboost/structure_gb.pyx":680
+  /* "structureboost/structure_gb.pyx":678
  *         if num_trees_to_use == -1:
  *             num_trees_to_use = self.num_trees_for_prediction
  *         phi_out = np.zeros((nrows, nfeat+1))             # <<<<<<<<<<<<<<
  *         start_pred=0
  *         if self.initial_model is None:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 680, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 678, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 680, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 678, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_From_long(__pyx_v_nrows); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 680, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_long(__pyx_v_nrows); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 678, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = __Pyx_PyInt_From_long((__pyx_v_nfeat + 1)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 680, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyInt_From_long((__pyx_v_nfeat + 1)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 678, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 680, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 678, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_6);
   __pyx_t_4 = 0;
   __pyx_t_6 = 0;
@@ -16114,247 +16101,247 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_2 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_7);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 680, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 678, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_phi_out = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "structureboost/structure_gb.pyx":681
+  /* "structureboost/structure_gb.pyx":679
  *             num_trees_to_use = self.num_trees_for_prediction
  *         phi_out = np.zeros((nrows, nfeat+1))
  *         start_pred=0             # <<<<<<<<<<<<<<
  *         if self.initial_model is None:
  *             start_pred = self.initial_pred[0]
  */
   __pyx_v_start_pred = 0.0;
 
-  /* "structureboost/structure_gb.pyx":682
+  /* "structureboost/structure_gb.pyx":680
  *         phi_out = np.zeros((nrows, nfeat+1))
  *         start_pred=0
  *         if self.initial_model is None:             # <<<<<<<<<<<<<<
  *             start_pred = self.initial_pred[0]
  *         for j in range(nrows):
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 682, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_model); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 680, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_1 = (__pyx_t_2 == Py_None);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_8 = (__pyx_t_1 != 0);
   if (__pyx_t_8) {
 
-    /* "structureboost/structure_gb.pyx":683
+    /* "structureboost/structure_gb.pyx":681
  *         start_pred=0
  *         if self.initial_model is None:
  *             start_pred = self.initial_pred[0]             # <<<<<<<<<<<<<<
  *         for j in range(nrows):
  *             phi_out[j,nfeat] += start_pred
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_pred); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 683, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_initial_pred); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 681, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 683, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_2, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 681, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_9 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 683, __pyx_L1_error)
+    __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_9 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 681, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_v_start_pred = __pyx_t_9;
 
-    /* "structureboost/structure_gb.pyx":682
+    /* "structureboost/structure_gb.pyx":680
  *         phi_out = np.zeros((nrows, nfeat+1))
  *         start_pred=0
  *         if self.initial_model is None:             # <<<<<<<<<<<<<<
  *             start_pred = self.initial_pred[0]
  *         for j in range(nrows):
  */
   }
 
-  /* "structureboost/structure_gb.pyx":684
+  /* "structureboost/structure_gb.pyx":682
  *         if self.initial_model is None:
  *             start_pred = self.initial_pred[0]
  *         for j in range(nrows):             # <<<<<<<<<<<<<<
  *             phi_out[j,nfeat] += start_pred
  *         for i in range(num_trees_to_use):
  */
   __pyx_t_10 = __pyx_v_nrows;
   __pyx_t_11 = __pyx_t_10;
   for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
     __pyx_v_j = __pyx_t_12;
 
-    /* "structureboost/structure_gb.pyx":685
+    /* "structureboost/structure_gb.pyx":683
  *             start_pred = self.initial_pred[0]
  *         for j in range(nrows):
  *             phi_out[j,nfeat] += start_pred             # <<<<<<<<<<<<<<
  *         for i in range(num_trees_to_use):
  *             dt_mat_int = self.pred_tens_int[i,:,:]
  */
-    __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_j); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 685, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_j); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_nfeat); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 685, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_nfeat); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 685, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_2);
     __pyx_t_5 = 0;
     __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_phi_out, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 685, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_v_phi_out, __pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = PyFloat_FromDouble(__pyx_v_start_pred); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 685, __pyx_L1_error)
+    __pyx_t_5 = PyFloat_FromDouble(__pyx_v_start_pred); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = PyNumber_InPlaceAdd(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 685, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_InPlaceAdd(__pyx_t_2, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(PyObject_SetItem(__pyx_v_phi_out, __pyx_t_7, __pyx_t_6) < 0)) __PYX_ERR(0, 685, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_v_phi_out, __pyx_t_7, __pyx_t_6) < 0)) __PYX_ERR(0, 683, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
 
-  /* "structureboost/structure_gb.pyx":686
+  /* "structureboost/structure_gb.pyx":684
  *         for j in range(nrows):
  *             phi_out[j,nfeat] += start_pred
  *         for i in range(num_trees_to_use):             # <<<<<<<<<<<<<<
  *             dt_mat_int = self.pred_tens_int[i,:,:]
  *             dt_mat_float = self.pred_tens_float[i,:,:]
  */
   __pyx_t_3 = __pyx_v_num_trees_to_use;
   __pyx_t_13 = __pyx_t_3;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_13; __pyx_t_10+=1) {
     __pyx_v_i = __pyx_t_10;
 
-    /* "structureboost/structure_gb.pyx":687
+    /* "structureboost/structure_gb.pyx":685
  *             phi_out[j,nfeat] += start_pred
  *         for i in range(num_trees_to_use):
  *             dt_mat_int = self.pred_tens_int[i,:,:]             # <<<<<<<<<<<<<<
  *             dt_mat_float = self.pred_tens_float[i,:,:]
  *             for j in range(nrows):
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 687, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 685, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __Pyx_PyInt_From_long(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 687, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyInt_From_long(__pyx_v_i); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 685, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 687, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 685, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
     __Pyx_INCREF(__pyx_slice__5);
     __Pyx_GIVEREF(__pyx_slice__5);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_slice__5);
     __Pyx_INCREF(__pyx_slice__5);
     __Pyx_GIVEREF(__pyx_slice__5);
     PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_slice__5);
     __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 687, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 685, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_XDECREF_SET(__pyx_v_dt_mat_int, __pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "structureboost/structure_gb.pyx":688
+    /* "structureboost/structure_gb.pyx":686
  *         for i in range(num_trees_to_use):
  *             dt_mat_int = self.pred_tens_int[i,:,:]
  *             dt_mat_float = self.pred_tens_float[i,:,:]             # <<<<<<<<<<<<<<
  *             for j in range(nrows):
  *                 curr_pt = X_test[j,:]
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 688, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 686, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 688, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_i); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 686, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_7 = PyTuple_New(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 688, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_New(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 686, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5);
     __Pyx_INCREF(__pyx_slice__5);
     __Pyx_GIVEREF(__pyx_slice__5);
     PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_slice__5);
     __Pyx_INCREF(__pyx_slice__5);
     __Pyx_GIVEREF(__pyx_slice__5);
     PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_slice__5);
     __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 688, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 686, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_XDECREF_SET(__pyx_v_dt_mat_float, __pyx_t_5);
     __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":689
+    /* "structureboost/structure_gb.pyx":687
  *             dt_mat_int = self.pred_tens_int[i,:,:]
  *             dt_mat_float = self.pred_tens_float[i,:,:]
  *             for j in range(nrows):             # <<<<<<<<<<<<<<
  *                 curr_pt = X_test[j,:]
  *                 phi_out[j,:]+= tree_shap_single_pt(dt_mat_int, dt_mat_float,
  */
     __pyx_t_11 = __pyx_v_nrows;
     __pyx_t_12 = __pyx_t_11;
     for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_12; __pyx_t_14+=1) {
       __pyx_v_j = __pyx_t_14;
 
-      /* "structureboost/structure_gb.pyx":690
+      /* "structureboost/structure_gb.pyx":688
  *             dt_mat_float = self.pred_tens_float[i,:,:]
  *             for j in range(nrows):
  *                 curr_pt = X_test[j,:]             # <<<<<<<<<<<<<<
  *                 phi_out[j,:]+= tree_shap_single_pt(dt_mat_int, dt_mat_float,
  *                     self.max_depth, curr_pt) * self.learning_rate
  */
-      __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_j); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 690, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_j); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 688, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 690, __pyx_L1_error)
+      __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 688, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_GIVEREF(__pyx_t_5);
       PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5);
       __Pyx_INCREF(__pyx_slice__5);
       __Pyx_GIVEREF(__pyx_slice__5);
       PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_slice__5);
       __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_X_test), __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 690, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetItem(((PyObject *)__pyx_v_X_test), __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 688, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_XDECREF_SET(__pyx_v_curr_pt, __pyx_t_5);
       __pyx_t_5 = 0;
 
-      /* "structureboost/structure_gb.pyx":691
+      /* "structureboost/structure_gb.pyx":689
  *             for j in range(nrows):
  *                 curr_pt = X_test[j,:]
  *                 phi_out[j,:]+= tree_shap_single_pt(dt_mat_int, dt_mat_float,             # <<<<<<<<<<<<<<
  *                     self.max_depth, curr_pt) * self.learning_rate
  *         return(phi_out)
  */
-      __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_j); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 691, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_j); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 689, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 691, __pyx_L1_error)
+      __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 689, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_GIVEREF(__pyx_t_5);
       PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_5);
       __Pyx_INCREF(__pyx_slice__5);
       __Pyx_GIVEREF(__pyx_slice__5);
       PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_slice__5);
       __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_phi_out, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 691, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetItem(__pyx_v_phi_out, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 689, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_tree_shap_single_pt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 691, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_tree_shap_single_pt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 689, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
 
-      /* "structureboost/structure_gb.pyx":692
+      /* "structureboost/structure_gb.pyx":690
  *                 curr_pt = X_test[j,:]
  *                 phi_out[j,:]+= tree_shap_single_pt(dt_mat_int, dt_mat_float,
  *                     self.max_depth, curr_pt) * self.learning_rate             # <<<<<<<<<<<<<<
  *         return(phi_out)
  * 
  */
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_max_depth); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 692, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_max_depth); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 690, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __pyx_t_15 = NULL;
       __pyx_t_16 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
         __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_15)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -16363,31 +16350,31 @@
           __Pyx_DECREF_SET(__pyx_t_2, function);
           __pyx_t_16 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_2)) {
         PyObject *__pyx_temp[5] = {__pyx_t_15, __pyx_v_dt_mat_int, __pyx_v_dt_mat_float, __pyx_t_4, __pyx_v_curr_pt};
-        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_16, 4+__pyx_t_16); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 691, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_16, 4+__pyx_t_16); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 689, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
         PyObject *__pyx_temp[5] = {__pyx_t_15, __pyx_v_dt_mat_int, __pyx_v_dt_mat_float, __pyx_t_4, __pyx_v_curr_pt};
-        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_16, 4+__pyx_t_16); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 691, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_16, 4+__pyx_t_16); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 689, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_15); __pyx_t_15 = 0;
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       } else
       #endif
       {
-        __pyx_t_17 = PyTuple_New(4+__pyx_t_16); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 691, __pyx_L1_error)
+        __pyx_t_17 = PyTuple_New(4+__pyx_t_16); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 689, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_17);
         if (__pyx_t_15) {
           __Pyx_GIVEREF(__pyx_t_15); PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_15); __pyx_t_15 = NULL;
         }
         __Pyx_INCREF(__pyx_v_dt_mat_int);
         __Pyx_GIVEREF(__pyx_v_dt_mat_int);
         PyTuple_SET_ITEM(__pyx_t_17, 0+__pyx_t_16, __pyx_v_dt_mat_int);
@@ -16396,56 +16383,56 @@
         PyTuple_SET_ITEM(__pyx_t_17, 1+__pyx_t_16, __pyx_v_dt_mat_float);
         __Pyx_GIVEREF(__pyx_t_4);
         PyTuple_SET_ITEM(__pyx_t_17, 2+__pyx_t_16, __pyx_t_4);
         __Pyx_INCREF(__pyx_v_curr_pt);
         __Pyx_GIVEREF(__pyx_v_curr_pt);
         PyTuple_SET_ITEM(__pyx_t_17, 3+__pyx_t_16, __pyx_v_curr_pt);
         __pyx_t_4 = 0;
-        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_17, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 691, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_17, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 689, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
       }
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_learning_rate); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 692, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_learning_rate); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 690, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_17 = PyNumber_Multiply(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 692, __pyx_L1_error)
+      __pyx_t_17 = PyNumber_Multiply(__pyx_t_6, __pyx_t_2); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 690, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_17);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-      /* "structureboost/structure_gb.pyx":691
+      /* "structureboost/structure_gb.pyx":689
  *             for j in range(nrows):
  *                 curr_pt = X_test[j,:]
  *                 phi_out[j,:]+= tree_shap_single_pt(dt_mat_int, dt_mat_float,             # <<<<<<<<<<<<<<
  *                     self.max_depth, curr_pt) * self.learning_rate
  *         return(phi_out)
  */
-      __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_t_5, __pyx_t_17); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 691, __pyx_L1_error)
+      __pyx_t_2 = PyNumber_InPlaceAdd(__pyx_t_5, __pyx_t_17); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 689, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
-      if (unlikely(PyObject_SetItem(__pyx_v_phi_out, __pyx_t_7, __pyx_t_2) < 0)) __PYX_ERR(0, 691, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_v_phi_out, __pyx_t_7, __pyx_t_2) < 0)) __PYX_ERR(0, 689, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     }
   }
 
-  /* "structureboost/structure_gb.pyx":693
+  /* "structureboost/structure_gb.pyx":691
  *                 phi_out[j,:]+= tree_shap_single_pt(dt_mat_int, dt_mat_float,
  *                     self.max_depth, curr_pt) * self.learning_rate
  *         return(phi_out)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_phi_out);
   __pyx_r = __pyx_v_phi_out;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":671
+  /* "structureboost/structure_gb.pyx":669
  *                 print('columns must be in correct order for shap values')
  * 
  *     def _predict_shap(self,             # <<<<<<<<<<<<<<
  *                     np.ndarray[double, ndim=2] X_test, int num_trees_to_use=-1):
  *         cdef long i,j
  */
 
@@ -16476,15 +16463,15 @@
   __Pyx_XDECREF(__pyx_v_curr_pt);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":696
+/* "structureboost/structure_gb.pyx":694
  * 
  * 
  *     def rerandomize_na_dir_weighted_all_trees(self):             # <<<<<<<<<<<<<<
  *         for i in range(len(self.dec_tree_list)):
  *             curr_tree = self.dec_tree_list[i].dec_tree
  */
 
@@ -16516,96 +16503,96 @@
   int __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__28)
   __Pyx_RefNannySetupContext("rerandomize_na_dir_weighted_all_trees", 0);
-  __Pyx_TraceCall("rerandomize_na_dir_weighted_all_trees", __pyx_f[0], 696, 0, __PYX_ERR(0, 696, __pyx_L1_error));
+  __Pyx_TraceCall("rerandomize_na_dir_weighted_all_trees", __pyx_f[0], 694, 0, __PYX_ERR(0, 694, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":697
+  /* "structureboost/structure_gb.pyx":695
  * 
  *     def rerandomize_na_dir_weighted_all_trees(self):
  *         for i in range(len(self.dec_tree_list)):             # <<<<<<<<<<<<<<
  *             curr_tree = self.dec_tree_list[i].dec_tree
  *             if curr_tree:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 695, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 697, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 695, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_3 = __pyx_t_2;
   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
     __pyx_v_i = __pyx_t_4;
 
-    /* "structureboost/structure_gb.pyx":698
+    /* "structureboost/structure_gb.pyx":696
  *     def rerandomize_na_dir_weighted_all_trees(self):
  *         for i in range(len(self.dec_tree_list)):
  *             curr_tree = self.dec_tree_list[i].dec_tree             # <<<<<<<<<<<<<<
  *             if curr_tree:
  *                 randomize_node_na_dir_weighted(curr_tree)
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 696, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 698, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_dec_tree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_dec_tree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 696, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_XDECREF_SET(__pyx_v_curr_tree, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":699
+    /* "structureboost/structure_gb.pyx":697
  *         for i in range(len(self.dec_tree_list)):
  *             curr_tree = self.dec_tree_list[i].dec_tree
  *             if curr_tree:             # <<<<<<<<<<<<<<
  *                 randomize_node_na_dir_weighted(curr_tree)
  * 
  */
-    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_curr_tree); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 699, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_v_curr_tree); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 697, __pyx_L1_error)
     if (__pyx_t_6) {
 
-      /* "structureboost/structure_gb.pyx":700
+      /* "structureboost/structure_gb.pyx":698
  *             curr_tree = self.dec_tree_list[i].dec_tree
  *             if curr_tree:
  *                 randomize_node_na_dir_weighted(curr_tree)             # <<<<<<<<<<<<<<
  * 
  *     def remap_predict_columns(self, new_col_struct):
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_randomize_node_na_dir_weighted); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 700, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_randomize_node_na_dir_weighted); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __pyx_t_7 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
         __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
         if (likely(__pyx_t_7)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
           __Pyx_INCREF(__pyx_t_7);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_5, function);
         }
       }
       __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_7, __pyx_v_curr_tree) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_curr_tree);
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 700, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 698, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "structureboost/structure_gb.pyx":699
+      /* "structureboost/structure_gb.pyx":697
  *         for i in range(len(self.dec_tree_list)):
  *             curr_tree = self.dec_tree_list[i].dec_tree
  *             if curr_tree:             # <<<<<<<<<<<<<<
  *                 randomize_node_na_dir_weighted(curr_tree)
  * 
  */
     }
   }
 
-  /* "structureboost/structure_gb.pyx":696
+  /* "structureboost/structure_gb.pyx":694
  * 
  * 
  *     def rerandomize_na_dir_weighted_all_trees(self):             # <<<<<<<<<<<<<<
  *         for i in range(len(self.dec_tree_list)):
  *             curr_tree = self.dec_tree_list[i].dec_tree
  */
 
@@ -16622,15 +16609,15 @@
   __Pyx_XDECREF(__pyx_v_curr_tree);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":702
+/* "structureboost/structure_gb.pyx":700
  *                 randomize_node_na_dir_weighted(curr_tree)
  * 
  *     def remap_predict_columns(self, new_col_struct):             # <<<<<<<<<<<<<<
  *         """Indicate which column in numpy array each feature is located.
  * 
  */
 
@@ -16666,32 +16653,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_new_col_struct)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("remap_predict_columns", 1, 2, 2, 1); __PYX_ERR(0, 702, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("remap_predict_columns", 1, 2, 2, 1); __PYX_ERR(0, 700, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "remap_predict_columns") < 0)) __PYX_ERR(0, 702, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "remap_predict_columns") < 0)) __PYX_ERR(0, 700, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_new_col_struct = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("remap_predict_columns", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 702, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("remap_predict_columns", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 700, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost.remap_predict_columns", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_48remap_predict_columns(__pyx_self, __pyx_v_self, __pyx_v_new_col_struct);
 
@@ -16717,339 +16704,339 @@
   PyObject *__pyx_t_7 = NULL;
   int __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__29)
   __Pyx_RefNannySetupContext("remap_predict_columns", 0);
-  __Pyx_TraceCall("remap_predict_columns", __pyx_f[0], 702, 0, __PYX_ERR(0, 702, __pyx_L1_error));
+  __Pyx_TraceCall("remap_predict_columns", __pyx_f[0], 700, 0, __PYX_ERR(0, 700, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":729
+  /* "structureboost/structure_gb.pyx":727
  *         This is useful if you want to then call `predict` on df.to_numpy()
  *         """
  *         if type(new_col_struct)==pd.DataFrame:             # <<<<<<<<<<<<<<
  *             col_list = new_col_struct.columns
  *             self.column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pd); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 729, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pd); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_DataFrame); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 729, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_DataFrame); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_new_col_struct)), __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 729, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_new_col_struct)), __pyx_t_2, Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 729, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 727, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_3) {
 
-    /* "structureboost/structure_gb.pyx":730
+    /* "structureboost/structure_gb.pyx":728
  *         """
  *         if type(new_col_struct)==pd.DataFrame:
  *             col_list = new_col_struct.columns             # <<<<<<<<<<<<<<
  *             self.column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}
  *             self.get_tensors_for_predict()
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_new_col_struct, __pyx_n_s_columns); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 730, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_new_col_struct, __pyx_n_s_columns); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 728, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_col_list = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":731
+    /* "structureboost/structure_gb.pyx":729
  *         if type(new_col_struct)==pd.DataFrame:
  *             col_list = new_col_struct.columns
  *             self.column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}             # <<<<<<<<<<<<<<
  *             self.get_tensors_for_predict()
  *         elif type(new_col_struct)==dict:
  */
     { /* enter inner scope */
-      __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)
+      __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 729, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_4 = PyObject_Length(__pyx_v_col_list); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 731, __pyx_L1_error)
+      __pyx_t_4 = PyObject_Length(__pyx_v_col_list); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 729, __pyx_L1_error)
       __pyx_t_5 = __pyx_t_4;
       for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
         __pyx_8genexpr4__pyx_v_i = __pyx_t_6;
-        __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_col_list, __pyx_8genexpr4__pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 731, __pyx_L1_error)
+        __pyx_t_2 = __Pyx_GetItemInt(__pyx_v_col_list, __pyx_8genexpr4__pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 729, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        __pyx_t_7 = PyInt_FromSsize_t(__pyx_8genexpr4__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 731, __pyx_L1_error)
+        __pyx_t_7 = PyInt_FromSsize_t(__pyx_8genexpr4__pyx_v_i); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 729, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        if (unlikely(PyDict_SetItem(__pyx_t_1, (PyObject*)__pyx_t_2, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 731, __pyx_L1_error)
+        if (unlikely(PyDict_SetItem(__pyx_t_1, (PyObject*)__pyx_t_2, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 729, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       }
     } /* exit inner scope */
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_column_to_int_dict, __pyx_t_1) < 0) __PYX_ERR(0, 731, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_column_to_int_dict, __pyx_t_1) < 0) __PYX_ERR(0, 729, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":732
+    /* "structureboost/structure_gb.pyx":730
  *             col_list = new_col_struct.columns
  *             self.column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}
  *             self.get_tensors_for_predict()             # <<<<<<<<<<<<<<
  *         elif type(new_col_struct)==dict:
  *             self.column_to_int_dict = new_col_struct
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_tensors_for_predict); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 732, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_tensors_for_predict); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 730, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 732, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 730, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":729
+    /* "structureboost/structure_gb.pyx":727
  *         This is useful if you want to then call `predict` on df.to_numpy()
  *         """
  *         if type(new_col_struct)==pd.DataFrame:             # <<<<<<<<<<<<<<
  *             col_list = new_col_struct.columns
  *             self.column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}
  */
     goto __pyx_L3;
   }
 
-  /* "structureboost/structure_gb.pyx":733
+  /* "structureboost/structure_gb.pyx":731
  *             self.column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}
  *             self.get_tensors_for_predict()
  *         elif type(new_col_struct)==dict:             # <<<<<<<<<<<<<<
  *             self.column_to_int_dict = new_col_struct
  *             self.get_tensors_for_predict()
  */
-  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_new_col_struct)), ((PyObject *)(&PyDict_Type)), Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 733, __pyx_L1_error)
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 733, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_new_col_struct)), ((PyObject *)(&PyDict_Type)), Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 731, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_3) {
 
-    /* "structureboost/structure_gb.pyx":734
+    /* "structureboost/structure_gb.pyx":732
  *             self.get_tensors_for_predict()
  *         elif type(new_col_struct)==dict:
  *             self.column_to_int_dict = new_col_struct             # <<<<<<<<<<<<<<
  *             self.get_tensors_for_predict()
  *         elif ((type(new_col_struct)==list) or
  */
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_column_to_int_dict, __pyx_v_new_col_struct) < 0) __PYX_ERR(0, 734, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_column_to_int_dict, __pyx_v_new_col_struct) < 0) __PYX_ERR(0, 732, __pyx_L1_error)
 
-    /* "structureboost/structure_gb.pyx":735
+    /* "structureboost/structure_gb.pyx":733
  *         elif type(new_col_struct)==dict:
  *             self.column_to_int_dict = new_col_struct
  *             self.get_tensors_for_predict()             # <<<<<<<<<<<<<<
  *         elif ((type(new_col_struct)==list) or
  *                     (type(new_col_struct)==pd.core.indexes.base.Index)):
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_tensors_for_predict); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 735, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_tensors_for_predict); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 733, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 735, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 733, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":733
+    /* "structureboost/structure_gb.pyx":731
  *             self.column_to_int_dict = {col_list[i]: i for i in range(len(col_list))}
  *             self.get_tensors_for_predict()
  *         elif type(new_col_struct)==dict:             # <<<<<<<<<<<<<<
  *             self.column_to_int_dict = new_col_struct
  *             self.get_tensors_for_predict()
  */
     goto __pyx_L3;
   }
 
-  /* "structureboost/structure_gb.pyx":736
+  /* "structureboost/structure_gb.pyx":734
  *             self.column_to_int_dict = new_col_struct
  *             self.get_tensors_for_predict()
  *         elif ((type(new_col_struct)==list) or             # <<<<<<<<<<<<<<
  *                     (type(new_col_struct)==pd.core.indexes.base.Index)):
  *             self.column_to_int_dict = {new_col_struct[i]: i for i in
  */
-  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_new_col_struct)), ((PyObject *)(&PyList_Type)), Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 736, __pyx_L1_error)
-  __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_new_col_struct)), ((PyObject *)(&PyList_Type)), Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 734, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 734, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (!__pyx_t_8) {
   } else {
     __pyx_t_3 = __pyx_t_8;
     goto __pyx_L6_bool_binop_done;
   }
 
-  /* "structureboost/structure_gb.pyx":737
+  /* "structureboost/structure_gb.pyx":735
  *             self.get_tensors_for_predict()
  *         elif ((type(new_col_struct)==list) or
  *                     (type(new_col_struct)==pd.core.indexes.base.Index)):             # <<<<<<<<<<<<<<
  *             self.column_to_int_dict = {new_col_struct[i]: i for i in
  *                                                         range(len(new_col_struct))}
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pd); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pd); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 735, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_core); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_core); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 735, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_indexes); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_indexes); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 735, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_base); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_base); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 735, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_Index); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_Index); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 735, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_new_col_struct)), __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __pyx_t_7 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_new_col_struct)), __pyx_t_1, Py_EQ); __Pyx_XGOTREF(__pyx_t_7); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 735, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 735, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_3 = __pyx_t_8;
   __pyx_L6_bool_binop_done:;
 
-  /* "structureboost/structure_gb.pyx":736
+  /* "structureboost/structure_gb.pyx":734
  *             self.column_to_int_dict = new_col_struct
  *             self.get_tensors_for_predict()
  *         elif ((type(new_col_struct)==list) or             # <<<<<<<<<<<<<<
  *                     (type(new_col_struct)==pd.core.indexes.base.Index)):
  *             self.column_to_int_dict = {new_col_struct[i]: i for i in
  */
   if (__pyx_t_3) {
 
-    /* "structureboost/structure_gb.pyx":738
+    /* "structureboost/structure_gb.pyx":736
  *         elif ((type(new_col_struct)==list) or
  *                     (type(new_col_struct)==pd.core.indexes.base.Index)):
  *             self.column_to_int_dict = {new_col_struct[i]: i for i in             # <<<<<<<<<<<<<<
  *                                                         range(len(new_col_struct))}
  *             self.get_tensors_for_predict()
  */
     { /* enter inner scope */
-      __pyx_t_7 = PyDict_New(); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 738, __pyx_L1_error)
+      __pyx_t_7 = PyDict_New(); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 736, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
 
-      /* "structureboost/structure_gb.pyx":739
+      /* "structureboost/structure_gb.pyx":737
  *                     (type(new_col_struct)==pd.core.indexes.base.Index)):
  *             self.column_to_int_dict = {new_col_struct[i]: i for i in
  *                                                         range(len(new_col_struct))}             # <<<<<<<<<<<<<<
  *             self.get_tensors_for_predict()
  *         else:
  */
-      __pyx_t_4 = PyObject_Length(__pyx_v_new_col_struct); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 739, __pyx_L1_error)
+      __pyx_t_4 = PyObject_Length(__pyx_v_new_col_struct); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 737, __pyx_L1_error)
 
-      /* "structureboost/structure_gb.pyx":738
+      /* "structureboost/structure_gb.pyx":736
  *         elif ((type(new_col_struct)==list) or
  *                     (type(new_col_struct)==pd.core.indexes.base.Index)):
  *             self.column_to_int_dict = {new_col_struct[i]: i for i in             # <<<<<<<<<<<<<<
  *                                                         range(len(new_col_struct))}
  *             self.get_tensors_for_predict()
  */
       __pyx_t_5 = __pyx_t_4;
       for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
         __pyx_8genexpr5__pyx_v_i = __pyx_t_6;
-        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_new_col_struct, __pyx_8genexpr5__pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 738, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_new_col_struct, __pyx_8genexpr5__pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 736, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_2 = PyInt_FromSsize_t(__pyx_8genexpr5__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 738, __pyx_L1_error)
+        __pyx_t_2 = PyInt_FromSsize_t(__pyx_8genexpr5__pyx_v_i); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
-        if (unlikely(PyDict_SetItem(__pyx_t_7, (PyObject*)__pyx_t_1, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 738, __pyx_L1_error)
+        if (unlikely(PyDict_SetItem(__pyx_t_7, (PyObject*)__pyx_t_1, (PyObject*)__pyx_t_2))) __PYX_ERR(0, 736, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       }
     } /* exit inner scope */
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_column_to_int_dict, __pyx_t_7) < 0) __PYX_ERR(0, 738, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_column_to_int_dict, __pyx_t_7) < 0) __PYX_ERR(0, 736, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "structureboost/structure_gb.pyx":740
+    /* "structureboost/structure_gb.pyx":738
  *             self.column_to_int_dict = {new_col_struct[i]: i for i in
  *                                                         range(len(new_col_struct))}
  *             self.get_tensors_for_predict()             # <<<<<<<<<<<<<<
  *         else:
  *             w_str='new_col_struct not of appropriate type - mapping not changed'
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_tensors_for_predict); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 740, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_get_tensors_for_predict); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 738, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_1 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_1);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_7 = (__pyx_t_1) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1) : __Pyx_PyObject_CallNoArg(__pyx_t_2);
     __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 740, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 738, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-    /* "structureboost/structure_gb.pyx":736
+    /* "structureboost/structure_gb.pyx":734
  *             self.column_to_int_dict = new_col_struct
  *             self.get_tensors_for_predict()
  *         elif ((type(new_col_struct)==list) or             # <<<<<<<<<<<<<<
  *                     (type(new_col_struct)==pd.core.indexes.base.Index)):
  *             self.column_to_int_dict = {new_col_struct[i]: i for i in
  */
     goto __pyx_L3;
   }
 
-  /* "structureboost/structure_gb.pyx":742
+  /* "structureboost/structure_gb.pyx":740
  *             self.get_tensors_for_predict()
  *         else:
  *             w_str='new_col_struct not of appropriate type - mapping not changed'             # <<<<<<<<<<<<<<
  *             warnings.warn(w_str)
  * 
  */
   /*else*/ {
     __Pyx_INCREF(__pyx_kp_u_new_col_struct_not_of_appropriat);
     __pyx_v_w_str = __pyx_kp_u_new_col_struct_not_of_appropriat;
 
-    /* "structureboost/structure_gb.pyx":743
+    /* "structureboost/structure_gb.pyx":741
  *         else:
  *             w_str='new_col_struct not of appropriate type - mapping not changed'
  *             warnings.warn(w_str)             # <<<<<<<<<<<<<<
  * 
  *     def get_tensors_for_predict(self):
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_warnings); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 743, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_warnings); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 741, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_warn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 743, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_warn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 741, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_2);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_7 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_v_w_str) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_v_w_str);
     __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 743, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 741, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   }
   __pyx_L3:;
 
-  /* "structureboost/structure_gb.pyx":702
+  /* "structureboost/structure_gb.pyx":700
  *                 randomize_node_na_dir_weighted(curr_tree)
  * 
  *     def remap_predict_columns(self, new_col_struct):             # <<<<<<<<<<<<<<
  *         """Indicate which column in numpy array each feature is located.
  * 
  */
 
@@ -17067,15 +17054,15 @@
   __Pyx_XDECREF(__pyx_v_w_str);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":745
+/* "structureboost/structure_gb.pyx":743
  *             warnings.warn(w_str)
  * 
  *     def get_tensors_for_predict(self):             # <<<<<<<<<<<<<<
  *         if self.optimizable:
  *             cat_size = np.max(np.array([dt.get_max_split_size() for dt in self.dec_tree_list]))
  */
 
@@ -17118,111 +17105,111 @@
   Py_ssize_t __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__30)
   __Pyx_RefNannySetupContext("get_tensors_for_predict", 0);
-  __Pyx_TraceCall("get_tensors_for_predict", __pyx_f[0], 745, 0, __PYX_ERR(0, 745, __pyx_L1_error));
+  __Pyx_TraceCall("get_tensors_for_predict", __pyx_f[0], 743, 0, __PYX_ERR(0, 743, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":746
+  /* "structureboost/structure_gb.pyx":744
  * 
  *     def get_tensors_for_predict(self):
  *         if self.optimizable:             # <<<<<<<<<<<<<<
  *             cat_size = np.max(np.array([dt.get_max_split_size() for dt in self.dec_tree_list]))
  *             num_dt = len(self.dec_tree_list)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimizable); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 746, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_optimizable); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 746, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 744, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_gb.pyx":747
+    /* "structureboost/structure_gb.pyx":745
  *     def get_tensors_for_predict(self):
  *         if self.optimizable:
  *             cat_size = np.max(np.array([dt.get_max_split_size() for dt in self.dec_tree_list]))             # <<<<<<<<<<<<<<
  *             num_dt = len(self.dec_tree_list)
  *             max_nodes = np.max(np.array([dt.num_nodes for dt in self.dec_tree_list]))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 747, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 745, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_max); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 747, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_max); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 745, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 747, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 745, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 747, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 745, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     { /* enter inner scope */
-      __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 747, __pyx_L6_error)
+      __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 745, __pyx_L6_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 747, __pyx_L6_error)
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 745, __pyx_L6_error)
       __Pyx_GOTREF(__pyx_t_7);
       if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
         __pyx_t_8 = __pyx_t_7; __Pyx_INCREF(__pyx_t_8); __pyx_t_9 = 0;
         __pyx_t_10 = NULL;
       } else {
-        __pyx_t_9 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 747, __pyx_L6_error)
+        __pyx_t_9 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 745, __pyx_L6_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_10 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 747, __pyx_L6_error)
+        __pyx_t_10 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 745, __pyx_L6_error)
       }
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       for (;;) {
         if (likely(!__pyx_t_10)) {
           if (likely(PyList_CheckExact(__pyx_t_8))) {
             if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_8)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_7 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_9); __Pyx_INCREF(__pyx_t_7); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 747, __pyx_L6_error)
+            __pyx_t_7 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_9); __Pyx_INCREF(__pyx_t_7); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 745, __pyx_L6_error)
             #else
-            __pyx_t_7 = PySequence_ITEM(__pyx_t_8, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 747, __pyx_L6_error)
+            __pyx_t_7 = PySequence_ITEM(__pyx_t_8, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 745, __pyx_L6_error)
             __Pyx_GOTREF(__pyx_t_7);
             #endif
           } else {
             if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_9); __Pyx_INCREF(__pyx_t_7); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 747, __pyx_L6_error)
+            __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_9); __Pyx_INCREF(__pyx_t_7); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 745, __pyx_L6_error)
             #else
-            __pyx_t_7 = PySequence_ITEM(__pyx_t_8, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 747, __pyx_L6_error)
+            __pyx_t_7 = PySequence_ITEM(__pyx_t_8, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 745, __pyx_L6_error)
             __Pyx_GOTREF(__pyx_t_7);
             #endif
           }
         } else {
           __pyx_t_7 = __pyx_t_10(__pyx_t_8);
           if (unlikely(!__pyx_t_7)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 747, __pyx_L6_error)
+              else __PYX_ERR(0, 745, __pyx_L6_error)
             }
             break;
           }
           __Pyx_GOTREF(__pyx_t_7);
         }
         __Pyx_XDECREF_SET(__pyx_8genexpr6__pyx_v_dt, __pyx_t_7);
         __pyx_t_7 = 0;
-        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_8genexpr6__pyx_v_dt, __pyx_n_s_get_max_split_size); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 747, __pyx_L6_error)
+        __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_8genexpr6__pyx_v_dt, __pyx_n_s_get_max_split_size); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 745, __pyx_L6_error)
         __Pyx_GOTREF(__pyx_t_11);
         __pyx_t_12 = NULL;
         if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_11))) {
           __pyx_t_12 = PyMethod_GET_SELF(__pyx_t_11);
           if (likely(__pyx_t_12)) {
             PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
             __Pyx_INCREF(__pyx_t_12);
             __Pyx_INCREF(function);
             __Pyx_DECREF_SET(__pyx_t_11, function);
           }
         }
         __pyx_t_7 = (__pyx_t_12) ? __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_12) : __Pyx_PyObject_CallNoArg(__pyx_t_11);
         __Pyx_XDECREF(__pyx_t_12); __pyx_t_12 = 0;
-        if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 747, __pyx_L6_error)
+        if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 745, __pyx_L6_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-        if (unlikely(__Pyx_ListComp_Append(__pyx_t_5, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 747, __pyx_L6_error)
+        if (unlikely(__Pyx_ListComp_Append(__pyx_t_5, (PyObject*)__pyx_t_7))) __PYX_ERR(0, 745, __pyx_L6_error)
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       }
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_XDECREF(__pyx_8genexpr6__pyx_v_dt); __pyx_8genexpr6__pyx_v_dt = 0;
       goto __pyx_L9_exit_scope;
       __pyx_L6_error:;
       __Pyx_XDECREF(__pyx_8genexpr6__pyx_v_dt); __pyx_8genexpr6__pyx_v_dt = 0;
@@ -17238,15 +17225,15 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_3 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_8, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_5);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 747, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 745, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -17254,100 +17241,100 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_6, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 747, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 745, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_v_cat_size = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":748
+    /* "structureboost/structure_gb.pyx":746
  *         if self.optimizable:
  *             cat_size = np.max(np.array([dt.get_max_split_size() for dt in self.dec_tree_list]))
  *             num_dt = len(self.dec_tree_list)             # <<<<<<<<<<<<<<
  *             max_nodes = np.max(np.array([dt.num_nodes for dt in self.dec_tree_list]))
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 748, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 746, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_9 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 748, __pyx_L1_error)
+    __pyx_t_9 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 746, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_v_num_dt = __pyx_t_9;
 
-    /* "structureboost/structure_gb.pyx":749
+    /* "structureboost/structure_gb.pyx":747
  *             cat_size = np.max(np.array([dt.get_max_split_size() for dt in self.dec_tree_list]))
  *             num_dt = len(self.dec_tree_list)
  *             max_nodes = np.max(np.array([dt.num_nodes for dt in self.dec_tree_list]))             # <<<<<<<<<<<<<<
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, 3))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 749, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 747, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_max); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 749, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_max); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 747, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 749, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 747, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 749, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 747, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     { /* enter inner scope */
-      __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 749, __pyx_L12_error)
+      __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 747, __pyx_L12_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 749, __pyx_L12_error)
+      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 747, __pyx_L12_error)
       __Pyx_GOTREF(__pyx_t_8);
       if (likely(PyList_CheckExact(__pyx_t_8)) || PyTuple_CheckExact(__pyx_t_8)) {
         __pyx_t_7 = __pyx_t_8; __Pyx_INCREF(__pyx_t_7); __pyx_t_9 = 0;
         __pyx_t_10 = NULL;
       } else {
-        __pyx_t_9 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 749, __pyx_L12_error)
+        __pyx_t_9 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 747, __pyx_L12_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_10 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 749, __pyx_L12_error)
+        __pyx_t_10 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 747, __pyx_L12_error)
       }
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       for (;;) {
         if (likely(!__pyx_t_10)) {
           if (likely(PyList_CheckExact(__pyx_t_7))) {
             if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_7)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_8 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_9); __Pyx_INCREF(__pyx_t_8); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 749, __pyx_L12_error)
+            __pyx_t_8 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_9); __Pyx_INCREF(__pyx_t_8); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 747, __pyx_L12_error)
             #else
-            __pyx_t_8 = PySequence_ITEM(__pyx_t_7, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 749, __pyx_L12_error)
+            __pyx_t_8 = PySequence_ITEM(__pyx_t_7, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 747, __pyx_L12_error)
             __Pyx_GOTREF(__pyx_t_8);
             #endif
           } else {
             if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_9); __Pyx_INCREF(__pyx_t_8); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 749, __pyx_L12_error)
+            __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_9); __Pyx_INCREF(__pyx_t_8); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 747, __pyx_L12_error)
             #else
-            __pyx_t_8 = PySequence_ITEM(__pyx_t_7, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 749, __pyx_L12_error)
+            __pyx_t_8 = PySequence_ITEM(__pyx_t_7, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 747, __pyx_L12_error)
             __Pyx_GOTREF(__pyx_t_8);
             #endif
           }
         } else {
           __pyx_t_8 = __pyx_t_10(__pyx_t_7);
           if (unlikely(!__pyx_t_8)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 749, __pyx_L12_error)
+              else __PYX_ERR(0, 747, __pyx_L12_error)
             }
             break;
           }
           __Pyx_GOTREF(__pyx_t_8);
         }
         __Pyx_XDECREF_SET(__pyx_8genexpr7__pyx_v_dt, __pyx_t_8);
         __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_8genexpr7__pyx_v_dt, __pyx_n_s_num_nodes); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 749, __pyx_L12_error)
+        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_8genexpr7__pyx_v_dt, __pyx_n_s_num_nodes); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 747, __pyx_L12_error)
         __Pyx_GOTREF(__pyx_t_8);
-        if (unlikely(__Pyx_ListComp_Append(__pyx_t_6, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 749, __pyx_L12_error)
+        if (unlikely(__Pyx_ListComp_Append(__pyx_t_6, (PyObject*)__pyx_t_8))) __PYX_ERR(0, 747, __pyx_L12_error)
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       }
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_XDECREF(__pyx_8genexpr7__pyx_v_dt); __pyx_8genexpr7__pyx_v_dt = 0;
       goto __pyx_L15_exit_scope;
       __pyx_L12_error:;
       __Pyx_XDECREF(__pyx_8genexpr7__pyx_v_dt); __pyx_8genexpr7__pyx_v_dt = 0;
@@ -17363,15 +17350,15 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_7, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 749, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 747, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -17379,87 +17366,87 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 749, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 747, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_max_nodes = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":750
+    /* "structureboost/structure_gb.pyx":748
  *             num_dt = len(self.dec_tree_list)
  *             max_nodes = np.max(np.array([dt.num_nodes for dt in self.dec_tree_list]))
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1             # <<<<<<<<<<<<<<
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1             # <<<<<<<<<<<<<<
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, 3))
  *             for i in range(num_dt):
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_num_dt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_num_dt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_v_cat_size, __pyx_int_6, 6, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_v_cat_size, __pyx_int_6, 6, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
     __Pyx_INCREF(__pyx_v_max_nodes);
     __Pyx_GIVEREF(__pyx_v_max_nodes);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_max_nodes);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_t_4);
     __pyx_t_1 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
     __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 750, __pyx_L1_error)
+    if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 750, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_t_6, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int, __pyx_t_5) < 0) __PYX_ERR(0, 750, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int, __pyx_t_5) < 0) __PYX_ERR(0, 748, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":751
+    /* "structureboost/structure_gb.pyx":749
  *             max_nodes = np.max(np.array([dt.num_nodes for dt in self.dec_tree_list]))
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, 3))             # <<<<<<<<<<<<<<
  *             for i in range(num_dt):
  *                 self.convert_dt_to_matrix(i)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 751, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 749, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 751, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 749, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_num_dt); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 751, __pyx_L1_error)
+    __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_num_dt); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 749, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 751, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 749, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
     __Pyx_INCREF(__pyx_v_max_nodes);
     __Pyx_GIVEREF(__pyx_v_max_nodes);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_max_nodes);
     __Pyx_INCREF(__pyx_int_3);
@@ -17475,96 +17462,96 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_6, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 751, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 749, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float, __pyx_t_5) < 0) __PYX_ERR(0, 751, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float, __pyx_t_5) < 0) __PYX_ERR(0, 749, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":752
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1
+    /* "structureboost/structure_gb.pyx":750
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, 3))
  *             for i in range(num_dt):             # <<<<<<<<<<<<<<
  *                 self.convert_dt_to_matrix(i)
  *             self.optimized=True
  */
     __pyx_t_9 = __pyx_v_num_dt;
     __pyx_t_13 = __pyx_t_9;
     for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
       __pyx_v_i = __pyx_t_14;
 
-      /* "structureboost/structure_gb.pyx":753
+      /* "structureboost/structure_gb.pyx":751
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, 3))
  *             for i in range(num_dt):
  *                 self.convert_dt_to_matrix(i)             # <<<<<<<<<<<<<<
  *             self.optimized=True
  *         else:
  */
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_convert_dt_to_matrix); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 753, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_convert_dt_to_matrix); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 751, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 753, __pyx_L1_error)
+      __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_i); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 751, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_6 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_6)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
           __Pyx_INCREF(__pyx_t_6);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_4, function);
         }
       }
       __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_6, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 753, __pyx_L1_error)
+      if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 751, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     }
 
-    /* "structureboost/structure_gb.pyx":754
+    /* "structureboost/structure_gb.pyx":752
  *             for i in range(num_dt):
  *                 self.convert_dt_to_matrix(i)
  *             self.optimized=True             # <<<<<<<<<<<<<<
  *         else:
  *             print("Model not optimizable for predict due to string or voronoi variable.")
  */
-    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_optimized, Py_True) < 0) __PYX_ERR(0, 754, __pyx_L1_error)
+    if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_optimized, Py_True) < 0) __PYX_ERR(0, 752, __pyx_L1_error)
 
-    /* "structureboost/structure_gb.pyx":746
+    /* "structureboost/structure_gb.pyx":744
  * 
  *     def get_tensors_for_predict(self):
  *         if self.optimizable:             # <<<<<<<<<<<<<<
  *             cat_size = np.max(np.array([dt.get_max_split_size() for dt in self.dec_tree_list]))
  *             num_dt = len(self.dec_tree_list)
  */
     goto __pyx_L3;
   }
 
-  /* "structureboost/structure_gb.pyx":756
+  /* "structureboost/structure_gb.pyx":754
  *             self.optimized=True
  *         else:
  *             print("Model not optimizable for predict due to string or voronoi variable.")             # <<<<<<<<<<<<<<
  * 
  *     def convert_dt_to_matrix(self, dt_num):
  */
   /*else*/ {
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__31, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 756, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__31, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 754, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __pyx_L3:;
 
-  /* "structureboost/structure_gb.pyx":745
+  /* "structureboost/structure_gb.pyx":743
  *             warnings.warn(w_str)
  * 
  *     def get_tensors_for_predict(self):             # <<<<<<<<<<<<<<
  *         if self.optimizable:
  *             cat_size = np.max(np.array([dt.get_max_split_size() for dt in self.dec_tree_list]))
  */
 
@@ -17590,15 +17577,15 @@
   __Pyx_XDECREF(__pyx_8genexpr7__pyx_v_dt);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":758
+/* "structureboost/structure_gb.pyx":756
  *             print("Model not optimizable for predict due to string or voronoi variable.")
  * 
  *     def convert_dt_to_matrix(self, dt_num):             # <<<<<<<<<<<<<<
  *         curr_node = self.dec_tree_list[dt_num].dec_tree
  *         self.convert_subtree(curr_node, dt_num)
  */
 
@@ -17633,32 +17620,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_dt_num)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("convert_dt_to_matrix", 1, 2, 2, 1); __PYX_ERR(0, 758, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("convert_dt_to_matrix", 1, 2, 2, 1); __PYX_ERR(0, 756, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "convert_dt_to_matrix") < 0)) __PYX_ERR(0, 758, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "convert_dt_to_matrix") < 0)) __PYX_ERR(0, 756, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_self = values[0];
     __pyx_v_dt_num = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("convert_dt_to_matrix", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 758, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("convert_dt_to_matrix", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 756, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost.convert_dt_to_matrix", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_52convert_dt_to_matrix(__pyx_self, __pyx_v_self, __pyx_v_dt_num);
 
@@ -17678,42 +17665,42 @@
   int __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__32)
   __Pyx_RefNannySetupContext("convert_dt_to_matrix", 0);
-  __Pyx_TraceCall("convert_dt_to_matrix", __pyx_f[0], 758, 0, __PYX_ERR(0, 758, __pyx_L1_error));
+  __Pyx_TraceCall("convert_dt_to_matrix", __pyx_f[0], 756, 0, __PYX_ERR(0, 756, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":759
+  /* "structureboost/structure_gb.pyx":757
  * 
  *     def convert_dt_to_matrix(self, dt_num):
  *         curr_node = self.dec_tree_list[dt_num].dec_tree             # <<<<<<<<<<<<<<
  *         self.convert_subtree(curr_node, dt_num)
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 759, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 757, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_dt_num); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 759, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_v_dt_num); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 757, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dec_tree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 759, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_dec_tree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 757, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_curr_node = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":760
+  /* "structureboost/structure_gb.pyx":758
  *     def convert_dt_to_matrix(self, dt_num):
  *         curr_node = self.dec_tree_list[dt_num].dec_tree
  *         self.convert_subtree(curr_node, dt_num)             # <<<<<<<<<<<<<<
  * 
  *     def convert_subtree(self, node, dt_num):
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_convert_subtree); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 760, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_convert_subtree); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 758, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   __pyx_t_4 = 0;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -17722,47 +17709,47 @@
       __Pyx_DECREF_SET(__pyx_t_2, function);
       __pyx_t_4 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_curr_node, __pyx_v_dt_num};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 760, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 758, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
     PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_v_curr_node, __pyx_v_dt_num};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 760, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 2+__pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 758, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GOTREF(__pyx_t_1);
   } else
   #endif
   {
-    __pyx_t_5 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 760, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2+__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 758, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     if (__pyx_t_3) {
       __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
     }
     __Pyx_INCREF(__pyx_v_curr_node);
     __Pyx_GIVEREF(__pyx_v_curr_node);
     PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_4, __pyx_v_curr_node);
     __Pyx_INCREF(__pyx_v_dt_num);
     __Pyx_GIVEREF(__pyx_v_dt_num);
     PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_4, __pyx_v_dt_num);
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 760, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 758, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":758
+  /* "structureboost/structure_gb.pyx":756
  *             print("Model not optimizable for predict due to string or voronoi variable.")
  * 
  *     def convert_dt_to_matrix(self, dt_num):             # <<<<<<<<<<<<<<
  *         curr_node = self.dec_tree_list[dt_num].dec_tree
  *         self.convert_subtree(curr_node, dt_num)
  */
 
@@ -17780,15 +17767,15 @@
   __Pyx_XDECREF(__pyx_v_curr_node);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":762
+/* "structureboost/structure_gb.pyx":760
  *         self.convert_subtree(curr_node, dt_num)
  * 
  *     def convert_subtree(self, node, dt_num):             # <<<<<<<<<<<<<<
  *         ni = node['node_index']
  *         if node['node_type']=='leaf':
  */
 
@@ -17826,40 +17813,40 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_self)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_node)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("convert_subtree", 1, 3, 3, 1); __PYX_ERR(0, 762, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("convert_subtree", 1, 3, 3, 1); __PYX_ERR(0, 760, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_dt_num)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("convert_subtree", 1, 3, 3, 2); __PYX_ERR(0, 762, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("convert_subtree", 1, 3, 3, 2); __PYX_ERR(0, 760, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "convert_subtree") < 0)) __PYX_ERR(0, 762, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "convert_subtree") < 0)) __PYX_ERR(0, 760, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_self = values[0];
     __pyx_v_node = values[1];
     __pyx_v_dt_num = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("convert_subtree", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 762, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("convert_subtree", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 760, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.StructureBoost.convert_subtree", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_14StructureBoost_54convert_subtree(__pyx_self, __pyx_v_self, __pyx_v_node, __pyx_v_dt_num);
 
@@ -17883,279 +17870,279 @@
   int __pyx_t_7;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__33)
   __Pyx_RefNannySetupContext("convert_subtree", 0);
-  __Pyx_TraceCall("convert_subtree", __pyx_f[0], 762, 0, __PYX_ERR(0, 762, __pyx_L1_error));
+  __Pyx_TraceCall("convert_subtree", __pyx_f[0], 760, 0, __PYX_ERR(0, 760, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":763
+  /* "structureboost/structure_gb.pyx":761
  * 
  *     def convert_subtree(self, node, dt_num):
  *         ni = node['node_index']             # <<<<<<<<<<<<<<
  *         if node['node_type']=='leaf':
  *             self.pred_tens_int[dt_num, ni, 0]= 0
  */
-  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_node_index); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 763, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_node_index); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 761, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_ni = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":764
+  /* "structureboost/structure_gb.pyx":762
  *     def convert_subtree(self, node, dt_num):
  *         ni = node['node_index']
  *         if node['node_type']=='leaf':             # <<<<<<<<<<<<<<
  *             self.pred_tens_int[dt_num, ni, 0]= 0
  *             self.pred_tens_float[dt_num, ni, 1] = float(node['num_data_points'])
  */
-  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_node_type); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 764, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_node_type); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 762, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_leaf, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 764, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_leaf, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 762, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_gb.pyx":765
+    /* "structureboost/structure_gb.pyx":763
  *         ni = node['node_index']
  *         if node['node_type']=='leaf':
  *             self.pred_tens_int[dt_num, ni, 0]= 0             # <<<<<<<<<<<<<<
  *             self.pred_tens_float[dt_num, ni, 1] = float(node['num_data_points'])
  *             self.pred_tens_float[dt_num, ni, 2] = node['node_summary_val']
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 765, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 763, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 765, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 763, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_v_dt_num);
     __Pyx_GIVEREF(__pyx_v_dt_num);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_dt_num);
     __Pyx_INCREF(__pyx_v_ni);
     __Pyx_GIVEREF(__pyx_v_ni);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_ni);
     __Pyx_INCREF(__pyx_int_0);
     __Pyx_GIVEREF(__pyx_int_0);
     PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_0);
-    if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_t_3, __pyx_int_0) < 0)) __PYX_ERR(0, 765, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_t_3, __pyx_int_0) < 0)) __PYX_ERR(0, 763, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "structureboost/structure_gb.pyx":766
+    /* "structureboost/structure_gb.pyx":764
  *         if node['node_type']=='leaf':
  *             self.pred_tens_int[dt_num, ni, 0]= 0
  *             self.pred_tens_float[dt_num, ni, 1] = float(node['num_data_points'])             # <<<<<<<<<<<<<<
  *             self.pred_tens_float[dt_num, ni, 2] = node['node_summary_val']
  *         else:
  */
-    __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_num_data_points); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 766, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_num_data_points); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 764, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_1 = __Pyx_PyNumber_Float(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 766, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyNumber_Float(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 764, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 766, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 764, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 766, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 764, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_v_dt_num);
     __Pyx_GIVEREF(__pyx_v_dt_num);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_dt_num);
     __Pyx_INCREF(__pyx_v_ni);
     __Pyx_GIVEREF(__pyx_v_ni);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_ni);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
     PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_int_1);
-    if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_t_4, __pyx_t_1) < 0)) __PYX_ERR(0, 766, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_t_4, __pyx_t_1) < 0)) __PYX_ERR(0, 764, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":767
+    /* "structureboost/structure_gb.pyx":765
  *             self.pred_tens_int[dt_num, ni, 0]= 0
  *             self.pred_tens_float[dt_num, ni, 1] = float(node['num_data_points'])
  *             self.pred_tens_float[dt_num, ni, 2] = node['node_summary_val']             # <<<<<<<<<<<<<<
  *         else:
  *             self.pred_tens_float[dt_num, ni, 1] = float(node['num_data_points'])
  */
-    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_node_summary_val); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 767, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_node_summary_val); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 765, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 767, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 765, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 767, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 765, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_v_dt_num);
     __Pyx_GIVEREF(__pyx_v_dt_num);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_dt_num);
     __Pyx_INCREF(__pyx_v_ni);
     __Pyx_GIVEREF(__pyx_v_ni);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_ni);
     __Pyx_INCREF(__pyx_int_2);
     __Pyx_GIVEREF(__pyx_int_2);
     PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_2);
-    if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_t_3, __pyx_t_1) < 0)) __PYX_ERR(0, 767, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_t_3, __pyx_t_1) < 0)) __PYX_ERR(0, 765, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":764
+    /* "structureboost/structure_gb.pyx":762
  *     def convert_subtree(self, node, dt_num):
  *         ni = node['node_index']
  *         if node['node_type']=='leaf':             # <<<<<<<<<<<<<<
  *             self.pred_tens_int[dt_num, ni, 0]= 0
  *             self.pred_tens_float[dt_num, ni, 1] = float(node['num_data_points'])
  */
     goto __pyx_L3;
   }
 
-  /* "structureboost/structure_gb.pyx":769
+  /* "structureboost/structure_gb.pyx":767
  *             self.pred_tens_float[dt_num, ni, 2] = node['node_summary_val']
  *         else:
  *             self.pred_tens_float[dt_num, ni, 1] = float(node['num_data_points'])             # <<<<<<<<<<<<<<
  *             if node['feature_type']=='numerical':
  *                 self.pred_tens_float[dt_num, ni, 0] = node['split_val']
  */
   /*else*/ {
-    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_num_data_points); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 769, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_num_data_points); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 767, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_PyNumber_Float(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 769, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyNumber_Float(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 767, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 769, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 767, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 769, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 767, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_v_dt_num);
     __Pyx_GIVEREF(__pyx_v_dt_num);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_dt_num);
     __Pyx_INCREF(__pyx_v_ni);
     __Pyx_GIVEREF(__pyx_v_ni);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_ni);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
     PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_int_1);
-    if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_t_4, __pyx_t_3) < 0)) __PYX_ERR(0, 769, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_t_4, __pyx_t_3) < 0)) __PYX_ERR(0, 767, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "structureboost/structure_gb.pyx":770
+    /* "structureboost/structure_gb.pyx":768
  *         else:
  *             self.pred_tens_float[dt_num, ni, 1] = float(node['num_data_points'])
  *             if node['feature_type']=='numerical':             # <<<<<<<<<<<<<<
  *                 self.pred_tens_float[dt_num, ni, 0] = node['split_val']
  *                 self.pred_tens_int[dt_num, ni, 0]= 1
  */
-    __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_feature_type); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 770, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_feature_type); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 768, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_3, __pyx_n_u_numerical, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 770, __pyx_L1_error)
+    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_3, __pyx_n_u_numerical, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 768, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     if (__pyx_t_2) {
 
-      /* "structureboost/structure_gb.pyx":771
+      /* "structureboost/structure_gb.pyx":769
  *             self.pred_tens_float[dt_num, ni, 1] = float(node['num_data_points'])
  *             if node['feature_type']=='numerical':
  *                 self.pred_tens_float[dt_num, ni, 0] = node['split_val']             # <<<<<<<<<<<<<<
  *                 self.pred_tens_int[dt_num, ni, 0]= 1
  *             elif node['feature_type']=='categorical_int':
  */
-      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_split_val); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 771, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_split_val); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 769, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 771, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 769, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 771, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 769, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_v_dt_num);
       __Pyx_GIVEREF(__pyx_v_dt_num);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_dt_num);
       __Pyx_INCREF(__pyx_v_ni);
       __Pyx_GIVEREF(__pyx_v_ni);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_ni);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_0);
-      if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_t_1, __pyx_t_3) < 0)) __PYX_ERR(0, 771, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_t_1, __pyx_t_3) < 0)) __PYX_ERR(0, 769, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-      /* "structureboost/structure_gb.pyx":772
+      /* "structureboost/structure_gb.pyx":770
  *             if node['feature_type']=='numerical':
  *                 self.pred_tens_float[dt_num, ni, 0] = node['split_val']
  *                 self.pred_tens_int[dt_num, ni, 0]= 1             # <<<<<<<<<<<<<<
  *             elif node['feature_type']=='categorical_int':
  *                 setlen = len(node['left_split'])
  */
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 772, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 770, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 772, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 770, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_v_dt_num);
       __Pyx_GIVEREF(__pyx_v_dt_num);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_dt_num);
       __Pyx_INCREF(__pyx_v_ni);
       __Pyx_GIVEREF(__pyx_v_ni);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_ni);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_0);
-      if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_t_1, __pyx_int_1) < 0)) __PYX_ERR(0, 772, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_t_3, __pyx_t_1, __pyx_int_1) < 0)) __PYX_ERR(0, 770, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "structureboost/structure_gb.pyx":770
+      /* "structureboost/structure_gb.pyx":768
  *         else:
  *             self.pred_tens_float[dt_num, ni, 1] = float(node['num_data_points'])
  *             if node['feature_type']=='numerical':             # <<<<<<<<<<<<<<
  *                 self.pred_tens_float[dt_num, ni, 0] = node['split_val']
  *                 self.pred_tens_int[dt_num, ni, 0]= 1
  */
       goto __pyx_L4;
     }
 
-    /* "structureboost/structure_gb.pyx":773
+    /* "structureboost/structure_gb.pyx":771
  *                 self.pred_tens_float[dt_num, ni, 0] = node['split_val']
  *                 self.pred_tens_int[dt_num, ni, 0]= 1
  *             elif node['feature_type']=='categorical_int':             # <<<<<<<<<<<<<<
  *                 setlen = len(node['left_split'])
  *                 self.pred_tens_int[dt_num, ni, 6:6+setlen] = np.fromiter(node['left_split'], int, setlen)
  */
-    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_feature_type); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 773, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_feature_type); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 771, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_categorical_int, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 773, __pyx_L1_error)
+    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_categorical_int, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 771, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (__pyx_t_2) {
 
-      /* "structureboost/structure_gb.pyx":774
+      /* "structureboost/structure_gb.pyx":772
  *                 self.pred_tens_int[dt_num, ni, 0]= 1
  *             elif node['feature_type']=='categorical_int':
  *                 setlen = len(node['left_split'])             # <<<<<<<<<<<<<<
  *                 self.pred_tens_int[dt_num, ni, 6:6+setlen] = np.fromiter(node['left_split'], int, setlen)
  *                 self.pred_tens_int[dt_num, ni, 0]= 2
  */
-      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_left_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 774, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_left_split); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 772, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_5 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 774, __pyx_L1_error)
+      __pyx_t_5 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 772, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 774, __pyx_L1_error)
+      __pyx_t_1 = PyInt_FromSsize_t(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 772, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_v_setlen = __pyx_t_1;
       __pyx_t_1 = 0;
 
-      /* "structureboost/structure_gb.pyx":775
+      /* "structureboost/structure_gb.pyx":773
  *             elif node['feature_type']=='categorical_int':
  *                 setlen = len(node['left_split'])
  *                 self.pred_tens_int[dt_num, ni, 6:6+setlen] = np.fromiter(node['left_split'], int, setlen)             # <<<<<<<<<<<<<<
  *                 self.pred_tens_int[dt_num, ni, 0]= 2
  *                 self.pred_tens_int[dt_num, ni, 5]= setlen
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 775, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 773, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_fromiter); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 775, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_fromiter); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 773, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_left_split); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 775, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_left_split); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 773, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_6 = NULL;
       __pyx_t_7 = 0;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_6)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -18164,260 +18151,260 @@
           __Pyx_DECREF_SET(__pyx_t_4, function);
           __pyx_t_7 = 1;
         }
       }
       #if CYTHON_FAST_PYCALL
       if (PyFunction_Check(__pyx_t_4)) {
         PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_3, ((PyObject *)(&PyInt_Type)), __pyx_v_setlen};
-        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 775, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 773, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       #if CYTHON_FAST_PYCCALL
       if (__Pyx_PyFastCFunction_Check(__pyx_t_4)) {
         PyObject *__pyx_temp[4] = {__pyx_t_6, __pyx_t_3, ((PyObject *)(&PyInt_Type)), __pyx_v_setlen};
-        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 775, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_4, __pyx_temp+1-__pyx_t_7, 3+__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 773, __pyx_L1_error)
         __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       } else
       #endif
       {
-        __pyx_t_8 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 775, __pyx_L1_error)
+        __pyx_t_8 = PyTuple_New(3+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 773, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         if (__pyx_t_6) {
           __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
         }
         __Pyx_GIVEREF(__pyx_t_3);
         PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_7, __pyx_t_3);
         __Pyx_INCREF(((PyObject *)(&PyInt_Type)));
         __Pyx_GIVEREF(((PyObject *)(&PyInt_Type)));
         PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_7, ((PyObject *)(&PyInt_Type)));
         __Pyx_INCREF(__pyx_v_setlen);
         __Pyx_GIVEREF(__pyx_v_setlen);
         PyTuple_SET_ITEM(__pyx_t_8, 2+__pyx_t_7, __pyx_v_setlen);
         __pyx_t_3 = 0;
-        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 775, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_8, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 773, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       }
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 775, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 773, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_8 = __Pyx_PyInt_AddCObj(__pyx_int_6, __pyx_v_setlen, 6, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 775, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyInt_AddCObj(__pyx_int_6, __pyx_v_setlen, 6, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 773, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_3 = PySlice_New(__pyx_int_6, __pyx_t_8, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 775, __pyx_L1_error)
+      __pyx_t_3 = PySlice_New(__pyx_int_6, __pyx_t_8, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 773, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = PyTuple_New(3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 775, __pyx_L1_error)
+      __pyx_t_8 = PyTuple_New(3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 773, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_INCREF(__pyx_v_dt_num);
       __Pyx_GIVEREF(__pyx_v_dt_num);
       PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_v_dt_num);
       __Pyx_INCREF(__pyx_v_ni);
       __Pyx_GIVEREF(__pyx_v_ni);
       PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_v_ni);
       __Pyx_GIVEREF(__pyx_t_3);
       PyTuple_SET_ITEM(__pyx_t_8, 2, __pyx_t_3);
       __pyx_t_3 = 0;
-      if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_t_8, __pyx_t_1) < 0)) __PYX_ERR(0, 775, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_t_8, __pyx_t_1) < 0)) __PYX_ERR(0, 773, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "structureboost/structure_gb.pyx":776
+      /* "structureboost/structure_gb.pyx":774
  *                 setlen = len(node['left_split'])
  *                 self.pred_tens_int[dt_num, ni, 6:6+setlen] = np.fromiter(node['left_split'], int, setlen)
  *                 self.pred_tens_int[dt_num, ni, 0]= 2             # <<<<<<<<<<<<<<
  *                 self.pred_tens_int[dt_num, ni, 5]= setlen
  *             self.pred_tens_int[dt_num, ni, 1]=self.column_to_int_dict[node['split_feature']]
  */
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 776, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 774, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_8 = PyTuple_New(3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 776, __pyx_L1_error)
+      __pyx_t_8 = PyTuple_New(3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 774, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_INCREF(__pyx_v_dt_num);
       __Pyx_GIVEREF(__pyx_v_dt_num);
       PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_v_dt_num);
       __Pyx_INCREF(__pyx_v_ni);
       __Pyx_GIVEREF(__pyx_v_ni);
       PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_v_ni);
       __Pyx_INCREF(__pyx_int_0);
       __Pyx_GIVEREF(__pyx_int_0);
       PyTuple_SET_ITEM(__pyx_t_8, 2, __pyx_int_0);
-      if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_t_8, __pyx_int_2) < 0)) __PYX_ERR(0, 776, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_t_8, __pyx_int_2) < 0)) __PYX_ERR(0, 774, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-      /* "structureboost/structure_gb.pyx":777
+      /* "structureboost/structure_gb.pyx":775
  *                 self.pred_tens_int[dt_num, ni, 6:6+setlen] = np.fromiter(node['left_split'], int, setlen)
  *                 self.pred_tens_int[dt_num, ni, 0]= 2
  *                 self.pred_tens_int[dt_num, ni, 5]= setlen             # <<<<<<<<<<<<<<
  *             self.pred_tens_int[dt_num, ni, 1]=self.column_to_int_dict[node['split_feature']]
  *             self.pred_tens_int[dt_num, ni, 2]=node['left_child']['node_index']
  */
-      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 777, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 775, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 775, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_INCREF(__pyx_v_dt_num);
       __Pyx_GIVEREF(__pyx_v_dt_num);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_dt_num);
       __Pyx_INCREF(__pyx_v_ni);
       __Pyx_GIVEREF(__pyx_v_ni);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_ni);
       __Pyx_INCREF(__pyx_int_5);
       __Pyx_GIVEREF(__pyx_int_5);
       PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_5);
-      if (unlikely(PyObject_SetItem(__pyx_t_8, __pyx_t_1, __pyx_v_setlen) < 0)) __PYX_ERR(0, 777, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_t_8, __pyx_t_1, __pyx_v_setlen) < 0)) __PYX_ERR(0, 775, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "structureboost/structure_gb.pyx":773
+      /* "structureboost/structure_gb.pyx":771
  *                 self.pred_tens_float[dt_num, ni, 0] = node['split_val']
  *                 self.pred_tens_int[dt_num, ni, 0]= 1
  *             elif node['feature_type']=='categorical_int':             # <<<<<<<<<<<<<<
  *                 setlen = len(node['left_split'])
  *                 self.pred_tens_int[dt_num, ni, 6:6+setlen] = np.fromiter(node['left_split'], int, setlen)
  */
     }
     __pyx_L4:;
 
-    /* "structureboost/structure_gb.pyx":778
+    /* "structureboost/structure_gb.pyx":776
  *                 self.pred_tens_int[dt_num, ni, 0]= 2
  *                 self.pred_tens_int[dt_num, ni, 5]= setlen
  *             self.pred_tens_int[dt_num, ni, 1]=self.column_to_int_dict[node['split_feature']]             # <<<<<<<<<<<<<<
  *             self.pred_tens_int[dt_num, ni, 2]=node['left_child']['node_index']
  *             self.pred_tens_int[dt_num, ni, 3]=node['right_child']['node_index']
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_column_to_int_dict); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_column_to_int_dict); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 776, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_split_feature); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_split_feature); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 776, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_8); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 776, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 776, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 776, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_dt_num);
     __Pyx_GIVEREF(__pyx_v_dt_num);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_dt_num);
     __Pyx_INCREF(__pyx_v_ni);
     __Pyx_GIVEREF(__pyx_v_ni);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_ni);
     __Pyx_INCREF(__pyx_int_1);
     __Pyx_GIVEREF(__pyx_int_1);
     PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_1);
-    if (unlikely(PyObject_SetItem(__pyx_t_8, __pyx_t_1, __pyx_t_4) < 0)) __PYX_ERR(0, 778, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_t_8, __pyx_t_1, __pyx_t_4) < 0)) __PYX_ERR(0, 776, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "structureboost/structure_gb.pyx":779
+    /* "structureboost/structure_gb.pyx":777
  *                 self.pred_tens_int[dt_num, ni, 5]= setlen
  *             self.pred_tens_int[dt_num, ni, 1]=self.column_to_int_dict[node['split_feature']]
  *             self.pred_tens_int[dt_num, ni, 2]=node['left_child']['node_index']             # <<<<<<<<<<<<<<
  *             self.pred_tens_int[dt_num, ni, 3]=node['right_child']['node_index']
  *             self.pred_tens_int[dt_num, ni, 4]=node['na_left']
  */
-    __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 779, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 777, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_t_4, __pyx_n_u_node_index); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 779, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_t_4, __pyx_n_u_node_index); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 779, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 777, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_8 = PyTuple_New(3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 779, __pyx_L1_error)
+    __pyx_t_8 = PyTuple_New(3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 777, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_INCREF(__pyx_v_dt_num);
     __Pyx_GIVEREF(__pyx_v_dt_num);
     PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_v_dt_num);
     __Pyx_INCREF(__pyx_v_ni);
     __Pyx_GIVEREF(__pyx_v_ni);
     PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_v_ni);
     __Pyx_INCREF(__pyx_int_2);
     __Pyx_GIVEREF(__pyx_int_2);
     PyTuple_SET_ITEM(__pyx_t_8, 2, __pyx_int_2);
-    if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_t_8, __pyx_t_1) < 0)) __PYX_ERR(0, 779, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_t_8, __pyx_t_1) < 0)) __PYX_ERR(0, 777, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":780
+    /* "structureboost/structure_gb.pyx":778
  *             self.pred_tens_int[dt_num, ni, 1]=self.column_to_int_dict[node['split_feature']]
  *             self.pred_tens_int[dt_num, ni, 2]=node['left_child']['node_index']
  *             self.pred_tens_int[dt_num, ni, 3]=node['right_child']['node_index']             # <<<<<<<<<<<<<<
  *             self.pred_tens_int[dt_num, ni, 4]=node['na_left']
  *             self.convert_subtree(node['left_child'], dt_num)
  */
-    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 778, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_t_1, __pyx_n_u_node_index); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_t_1, __pyx_n_u_node_index); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 778, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 778, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 778, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_INCREF(__pyx_v_dt_num);
     __Pyx_GIVEREF(__pyx_v_dt_num);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_dt_num);
     __Pyx_INCREF(__pyx_v_ni);
     __Pyx_GIVEREF(__pyx_v_ni);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_ni);
     __Pyx_INCREF(__pyx_int_3);
     __Pyx_GIVEREF(__pyx_int_3);
     PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_int_3);
-    if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_t_4, __pyx_t_8) < 0)) __PYX_ERR(0, 780, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_t_4, __pyx_t_8) < 0)) __PYX_ERR(0, 778, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "structureboost/structure_gb.pyx":781
+    /* "structureboost/structure_gb.pyx":779
  *             self.pred_tens_int[dt_num, ni, 2]=node['left_child']['node_index']
  *             self.pred_tens_int[dt_num, ni, 3]=node['right_child']['node_index']
  *             self.pred_tens_int[dt_num, ni, 4]=node['na_left']             # <<<<<<<<<<<<<<
  *             self.convert_subtree(node['left_child'], dt_num)
  *             self.convert_subtree(node['right_child'], dt_num)
  */
-    __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_na_left); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 781, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_na_left); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 779, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 781, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 779, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 781, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 779, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_dt_num);
     __Pyx_GIVEREF(__pyx_v_dt_num);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_dt_num);
     __Pyx_INCREF(__pyx_v_ni);
     __Pyx_GIVEREF(__pyx_v_ni);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_ni);
     __Pyx_INCREF(__pyx_int_4);
     __Pyx_GIVEREF(__pyx_int_4);
     PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_4);
-    if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_t_1, __pyx_t_8) < 0)) __PYX_ERR(0, 781, __pyx_L1_error)
+    if (unlikely(PyObject_SetItem(__pyx_t_4, __pyx_t_1, __pyx_t_8) < 0)) __PYX_ERR(0, 779, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "structureboost/structure_gb.pyx":782
+    /* "structureboost/structure_gb.pyx":780
  *             self.pred_tens_int[dt_num, ni, 3]=node['right_child']['node_index']
  *             self.pred_tens_int[dt_num, ni, 4]=node['na_left']
  *             self.convert_subtree(node['left_child'], dt_num)             # <<<<<<<<<<<<<<
  *             self.convert_subtree(node['right_child'], dt_num)
  * 
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_convert_subtree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 782, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_convert_subtree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 780, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 782, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 780, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = NULL;
     __pyx_t_7 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -18426,58 +18413,58 @@
         __Pyx_DECREF_SET(__pyx_t_1, function);
         __pyx_t_7 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_1)) {
       PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_4, __pyx_v_dt_num};
-      __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 782, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 780, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
       PyObject *__pyx_temp[3] = {__pyx_t_3, __pyx_t_4, __pyx_v_dt_num};
-      __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 782, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 780, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     } else
     #endif
     {
-      __pyx_t_6 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 782, __pyx_L1_error)
+      __pyx_t_6 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 780, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       if (__pyx_t_3) {
         __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_4);
       PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_7, __pyx_t_4);
       __Pyx_INCREF(__pyx_v_dt_num);
       __Pyx_GIVEREF(__pyx_v_dt_num);
       PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_7, __pyx_v_dt_num);
       __pyx_t_4 = 0;
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 782, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 780, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "structureboost/structure_gb.pyx":783
+    /* "structureboost/structure_gb.pyx":781
  *             self.pred_tens_int[dt_num, ni, 4]=node['na_left']
  *             self.convert_subtree(node['left_child'], dt_num)
  *             self.convert_subtree(node['right_child'], dt_num)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_convert_subtree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 783, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_convert_subtree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 781, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 783, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Dict_GetItem(__pyx_v_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 781, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_4 = NULL;
     __pyx_t_7 = 0;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -18486,51 +18473,51 @@
         __Pyx_DECREF_SET(__pyx_t_1, function);
         __pyx_t_7 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_1)) {
       PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_6, __pyx_v_dt_num};
-      __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 783, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 781, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
       PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_6, __pyx_v_dt_num};
-      __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 783, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_7, 2+__pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 781, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     } else
     #endif
     {
-      __pyx_t_3 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 783, __pyx_L1_error)
+      __pyx_t_3 = PyTuple_New(2+__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 781, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       if (__pyx_t_4) {
         __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4); __pyx_t_4 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_6);
       PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_7, __pyx_t_6);
       __Pyx_INCREF(__pyx_v_dt_num);
       __Pyx_GIVEREF(__pyx_v_dt_num);
       PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_7, __pyx_v_dt_num);
       __pyx_t_6 = 0;
-      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 783, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 781, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   }
   __pyx_L3:;
 
-  /* "structureboost/structure_gb.pyx":762
+  /* "structureboost/structure_gb.pyx":760
  *         self.convert_subtree(curr_node, dt_num)
  * 
  *     def convert_subtree(self, node, dt_num):             # <<<<<<<<<<<<<<
  *         ni = node['node_index']
  *         if node['node_type']=='leaf':
  */
 
@@ -18550,15 +18537,15 @@
   __Pyx_XDECREF(__pyx_v_setlen);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":786
+/* "structureboost/structure_gb.pyx":784
  * 
  * 
  * def _mse_der_1(y_true, y_pred, eps=1e-15):             # <<<<<<<<<<<<<<
  *     return(2*(y_pred-y_true))
  * 
  */
 
@@ -18597,25 +18584,25 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_true)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_pred)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_mse_der_1", 0, 2, 3, 1); __PYX_ERR(0, 786, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_mse_der_1", 0, 2, 3, 1); __PYX_ERR(0, 784, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_eps);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_mse_der_1") < 0)) __PYX_ERR(0, 786, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_mse_der_1") < 0)) __PYX_ERR(0, 784, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
@@ -18625,15 +18612,15 @@
     }
     __pyx_v_y_true = values[0];
     __pyx_v_y_pred = values[1];
     __pyx_v_eps = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_mse_der_1", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 786, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_mse_der_1", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 784, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb._mse_der_1", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb__mse_der_1(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_eps);
 
@@ -18649,34 +18636,34 @@
   PyObject *__pyx_t_1 = NULL;
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__34)
   __Pyx_RefNannySetupContext("_mse_der_1", 0);
-  __Pyx_TraceCall("_mse_der_1", __pyx_f[0], 786, 0, __PYX_ERR(0, 786, __pyx_L1_error));
+  __Pyx_TraceCall("_mse_der_1", __pyx_f[0], 784, 0, __PYX_ERR(0, 784, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":787
+  /* "structureboost/structure_gb.pyx":785
  * 
  * def _mse_der_1(y_true, y_pred, eps=1e-15):
  *     return(2*(y_pred-y_true))             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyNumber_Subtract(__pyx_v_y_pred, __pyx_v_y_true); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 787, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_v_y_pred, __pyx_v_y_true); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 787, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 785, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":786
+  /* "structureboost/structure_gb.pyx":784
  * 
  * 
  * def _mse_der_1(y_true, y_pred, eps=1e-15):             # <<<<<<<<<<<<<<
  *     return(2*(y_pred-y_true))
  * 
  */
 
@@ -18689,15 +18676,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":790
+/* "structureboost/structure_gb.pyx":788
  * 
  * 
  * def _mse_der_2(y_true, y_pred, eps=1e-15):             # <<<<<<<<<<<<<<
  *     return(2*np.ones(len(y_pred)))
  * 
  */
 
@@ -18736,25 +18723,25 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_true)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_pred)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_mse_der_2", 0, 2, 3, 1); __PYX_ERR(0, 790, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_mse_der_2", 0, 2, 3, 1); __PYX_ERR(0, 788, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_eps);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_mse_der_2") < 0)) __PYX_ERR(0, 790, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_mse_der_2") < 0)) __PYX_ERR(0, 788, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
@@ -18764,15 +18751,15 @@
     }
     __pyx_v_y_true = values[0];
     __pyx_v_y_pred = values[1];
     __pyx_v_eps = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_mse_der_2", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 790, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_mse_der_2", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 788, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb._mse_der_2", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_2_mse_der_2(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_eps);
 
@@ -18791,56 +18778,56 @@
   Py_ssize_t __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__35)
   __Pyx_RefNannySetupContext("_mse_der_2", 0);
-  __Pyx_TraceCall("_mse_der_2", __pyx_f[0], 790, 0, __PYX_ERR(0, 790, __pyx_L1_error));
+  __Pyx_TraceCall("_mse_der_2", __pyx_f[0], 788, 0, __PYX_ERR(0, 788, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":791
+  /* "structureboost/structure_gb.pyx":789
  * 
  * def _mse_der_2(y_true, y_pred, eps=1e-15):
  *     return(2*np.ones(len(y_pred)))             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 791, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 789, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_ones); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 791, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_ones); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 789, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = PyObject_Length(__pyx_v_y_pred); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 791, __pyx_L1_error)
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 791, __pyx_L1_error)
+  __pyx_t_4 = PyObject_Length(__pyx_v_y_pred); if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 789, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 789, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 791, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 789, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 791, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 789, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":790
+  /* "structureboost/structure_gb.pyx":788
  * 
  * 
  * def _mse_der_2(y_true, y_pred, eps=1e-15):             # <<<<<<<<<<<<<<
  *     return(2*np.ones(len(y_pred)))
  * 
  */
 
@@ -18855,15 +18842,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":794
+/* "structureboost/structure_gb.pyx":792
  * 
  * 
  * def _entropy_link_der_1(y_true, z_pred, eps=1e-15):             # <<<<<<<<<<<<<<
  *     return(-y_true*(1/(1+np.exp(z_pred))) + (1-y_true) *
  *            (1/(1+np.exp(-z_pred))))
  */
 
@@ -18902,25 +18889,25 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_true)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z_pred)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_entropy_link_der_1", 0, 2, 3, 1); __PYX_ERR(0, 794, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_entropy_link_der_1", 0, 2, 3, 1); __PYX_ERR(0, 792, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_eps);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_entropy_link_der_1") < 0)) __PYX_ERR(0, 794, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_entropy_link_der_1") < 0)) __PYX_ERR(0, 792, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
@@ -18930,15 +18917,15 @@
     }
     __pyx_v_y_true = values[0];
     __pyx_v_z_pred = values[1];
     __pyx_v_eps = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_entropy_link_der_1", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 794, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_entropy_link_der_1", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 792, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb._entropy_link_der_1", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_4_entropy_link_der_1(__pyx_self, __pyx_v_y_true, __pyx_v_z_pred, __pyx_v_eps);
 
@@ -18958,116 +18945,116 @@
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__36)
   __Pyx_RefNannySetupContext("_entropy_link_der_1", 0);
-  __Pyx_TraceCall("_entropy_link_der_1", __pyx_f[0], 794, 0, __PYX_ERR(0, 794, __pyx_L1_error));
+  __Pyx_TraceCall("_entropy_link_der_1", __pyx_f[0], 792, 0, __PYX_ERR(0, 792, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":795
+  /* "structureboost/structure_gb.pyx":793
  * 
  * def _entropy_link_der_1(y_true, z_pred, eps=1e-15):
  *     return(-y_true*(1/(1+np.exp(z_pred))) + (1-y_true) *             # <<<<<<<<<<<<<<
  *            (1/(1+np.exp(-z_pred))))
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyNumber_Negative(__pyx_v_y_true); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 795, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Negative(__pyx_v_y_true); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 793, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 795, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 793, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_exp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 795, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_exp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 793, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_z_pred) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_z_pred);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 795, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 793, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_t_2, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 795, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_t_2, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 793, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 795, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 793, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 795, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 793, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_y_true, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 795, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_y_true, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 793, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
-  /* "structureboost/structure_gb.pyx":796
+  /* "structureboost/structure_gb.pyx":794
  * def _entropy_link_der_1(y_true, z_pred, eps=1e-15):
  *     return(-y_true*(1/(1+np.exp(z_pred))) + (1-y_true) *
  *            (1/(1+np.exp(-z_pred))))             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 796, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 794, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_exp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 796, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_exp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 794, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Negative(__pyx_v_z_pred); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 796, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Negative(__pyx_v_z_pred); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 794, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_6 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_6)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_6);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 796, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 794, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_t_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 796, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_t_1, 1, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 794, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 796, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_int_1, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 794, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "structureboost/structure_gb.pyx":795
+  /* "structureboost/structure_gb.pyx":793
  * 
  * def _entropy_link_der_1(y_true, z_pred, eps=1e-15):
  *     return(-y_true*(1/(1+np.exp(z_pred))) + (1-y_true) *             # <<<<<<<<<<<<<<
  *            (1/(1+np.exp(-z_pred))))
  * 
  */
-  __pyx_t_5 = PyNumber_Multiply(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 795, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Multiply(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 793, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 795, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Add(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 793, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":794
+  /* "structureboost/structure_gb.pyx":792
  * 
  * 
  * def _entropy_link_der_1(y_true, z_pred, eps=1e-15):             # <<<<<<<<<<<<<<
  *     return(-y_true*(1/(1+np.exp(z_pred))) + (1-y_true) *
  *            (1/(1+np.exp(-z_pred))))
  */
 
@@ -19084,15 +19071,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":799
+/* "structureboost/structure_gb.pyx":797
  * 
  * 
  * def _entropy_link_der_2(y_true, z_pred, eps=1e-15):             # <<<<<<<<<<<<<<
  *     z_pred_exp = np.exp(z_pred)
  *     minus_z_pred_exp = np.exp(-z_pred)
  */
 
@@ -19131,25 +19118,25 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_true)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z_pred)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("_entropy_link_der_2", 0, 2, 3, 1); __PYX_ERR(0, 799, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("_entropy_link_der_2", 0, 2, 3, 1); __PYX_ERR(0, 797, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_eps);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_entropy_link_der_2") < 0)) __PYX_ERR(0, 799, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "_entropy_link_der_2") < 0)) __PYX_ERR(0, 797, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
@@ -19159,15 +19146,15 @@
     }
     __pyx_v_y_true = values[0];
     __pyx_v_z_pred = values[1];
     __pyx_v_eps = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("_entropy_link_der_2", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 799, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("_entropy_link_der_2", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 797, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb._entropy_link_der_2", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_6_entropy_link_der_2(__pyx_self, __pyx_v_y_true, __pyx_v_z_pred, __pyx_v_eps);
 
@@ -19189,161 +19176,161 @@
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__37)
   __Pyx_RefNannySetupContext("_entropy_link_der_2", 0);
-  __Pyx_TraceCall("_entropy_link_der_2", __pyx_f[0], 799, 0, __PYX_ERR(0, 799, __pyx_L1_error));
+  __Pyx_TraceCall("_entropy_link_der_2", __pyx_f[0], 797, 0, __PYX_ERR(0, 797, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":800
+  /* "structureboost/structure_gb.pyx":798
  * 
  * def _entropy_link_der_2(y_true, z_pred, eps=1e-15):
  *     z_pred_exp = np.exp(z_pred)             # <<<<<<<<<<<<<<
  *     minus_z_pred_exp = np.exp(-z_pred)
  *     denom_1 = (1+z_pred_exp)*(1+z_pred_exp)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 800, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 798, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_exp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 800, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_exp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 798, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_z_pred) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_z_pred);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 800, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 798, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_z_pred_exp = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":801
+  /* "structureboost/structure_gb.pyx":799
  * def _entropy_link_der_2(y_true, z_pred, eps=1e-15):
  *     z_pred_exp = np.exp(z_pred)
  *     minus_z_pred_exp = np.exp(-z_pred)             # <<<<<<<<<<<<<<
  *     denom_1 = (1+z_pred_exp)*(1+z_pred_exp)
  *     denom_2 = (1+minus_z_pred_exp)*(1+minus_z_pred_exp)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 799, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_exp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_exp); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 799, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Negative(__pyx_v_z_pred); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 801, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Negative(__pyx_v_z_pred); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 799, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 801, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 799, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_minus_z_pred_exp = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":802
+  /* "structureboost/structure_gb.pyx":800
  *     z_pred_exp = np.exp(z_pred)
  *     minus_z_pred_exp = np.exp(-z_pred)
  *     denom_1 = (1+z_pred_exp)*(1+z_pred_exp)             # <<<<<<<<<<<<<<
  *     denom_2 = (1+minus_z_pred_exp)*(1+minus_z_pred_exp)
  *     return(y_true*(z_pred_exp/denom_1) +
  */
-  __pyx_t_1 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_v_z_pred_exp, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 802, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_v_z_pred_exp, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 800, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_v_z_pred_exp, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 802, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_v_z_pred_exp, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 800, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 802, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 800, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_denom_1 = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":803
+  /* "structureboost/structure_gb.pyx":801
  *     minus_z_pred_exp = np.exp(-z_pred)
  *     denom_1 = (1+z_pred_exp)*(1+z_pred_exp)
  *     denom_2 = (1+minus_z_pred_exp)*(1+minus_z_pred_exp)             # <<<<<<<<<<<<<<
  *     return(y_true*(z_pred_exp/denom_1) +
  *            (1-y_true) * (minus_z_pred_exp/denom_2))
  */
-  __pyx_t_3 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_v_minus_z_pred_exp, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_v_minus_z_pred_exp, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 801, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_v_minus_z_pred_exp, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_AddCObj(__pyx_int_1, __pyx_v_minus_z_pred_exp, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 801, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 803, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 801, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_denom_2 = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":804
+  /* "structureboost/structure_gb.pyx":802
  *     denom_1 = (1+z_pred_exp)*(1+z_pred_exp)
  *     denom_2 = (1+minus_z_pred_exp)*(1+minus_z_pred_exp)
  *     return(y_true*(z_pred_exp/denom_1) +             # <<<<<<<<<<<<<<
  *            (1-y_true) * (minus_z_pred_exp/denom_2))
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_v_z_pred_exp, __pyx_v_denom_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 804, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_v_z_pred_exp, __pyx_v_denom_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 802, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_v_y_true, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 804, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_v_y_true, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 802, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":805
+  /* "structureboost/structure_gb.pyx":803
  *     denom_2 = (1+minus_z_pred_exp)*(1+minus_z_pred_exp)
  *     return(y_true*(z_pred_exp/denom_1) +
  *            (1-y_true) * (minus_z_pred_exp/denom_2))             # <<<<<<<<<<<<<<
  * 
  * 
  */
-  __pyx_t_1 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_y_true, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 805, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_y_true, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 803, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_v_minus_z_pred_exp, __pyx_v_denom_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 805, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_v_minus_z_pred_exp, __pyx_v_denom_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 803, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 805, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 803, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":804
+  /* "structureboost/structure_gb.pyx":802
  *     denom_1 = (1+z_pred_exp)*(1+z_pred_exp)
  *     denom_2 = (1+minus_z_pred_exp)*(1+minus_z_pred_exp)
  *     return(y_true*(z_pred_exp/denom_1) +             # <<<<<<<<<<<<<<
  *            (1-y_true) * (minus_z_pred_exp/denom_2))
  * 
  */
-  __pyx_t_3 = PyNumber_Add(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 804, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Add(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 802, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":799
+  /* "structureboost/structure_gb.pyx":797
  * 
  * 
  * def _entropy_link_der_2(y_true, z_pred, eps=1e-15):             # <<<<<<<<<<<<<<
  *     z_pred_exp = np.exp(z_pred)
  *     minus_z_pred_exp = np.exp(-z_pred)
  */
 
@@ -19362,15 +19349,15 @@
   __Pyx_XDECREF(__pyx_v_denom_2);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":808
+/* "structureboost/structure_gb.pyx":806
  * 
  * 
  * def my_log_loss(y_true, y_pred, eps=1e-16):             # <<<<<<<<<<<<<<
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(y_true*(np.log(y_pred)) + (1-y_true)*np.log(1-y_pred))
  */
 
@@ -19409,25 +19396,25 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_true)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_pred)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("my_log_loss", 0, 2, 3, 1); __PYX_ERR(0, 808, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("my_log_loss", 0, 2, 3, 1); __PYX_ERR(0, 806, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_eps);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "my_log_loss") < 0)) __PYX_ERR(0, 808, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "my_log_loss") < 0)) __PYX_ERR(0, 806, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
@@ -19437,15 +19424,15 @@
     }
     __pyx_v_y_true = values[0];
     __pyx_v_y_pred = values[1];
     __pyx_v_eps = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("my_log_loss", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 808, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("my_log_loss", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 806, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.my_log_loss", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_8my_log_loss(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_eps);
 
@@ -19469,30 +19456,30 @@
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__38)
   __Pyx_RefNannySetupContext("my_log_loss", 0);
-  __Pyx_TraceCall("my_log_loss", __pyx_f[0], 808, 0, __PYX_ERR(0, 808, __pyx_L1_error));
+  __Pyx_TraceCall("my_log_loss", __pyx_f[0], 806, 0, __PYX_ERR(0, 806, __pyx_L1_error));
   __Pyx_INCREF(__pyx_v_y_pred);
 
-  /* "structureboost/structure_gb.pyx":809
+  /* "structureboost/structure_gb.pyx":807
  * 
  * def my_log_loss(y_true, y_pred, eps=1e-16):
  *     y_pred = np.clip(y_pred, eps, (1-eps))             # <<<<<<<<<<<<<<
  *     out_val = -np.mean(y_true*(np.log(y_pred)) + (1-y_true)*np.log(1-y_pred))
  *     return out_val
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 809, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 807, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_clip); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 809, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_clip); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 807, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_eps, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 809, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_eps, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 807, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -19501,117 +19488,117 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_5 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_y_pred, __pyx_v_eps, __pyx_t_2};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 809, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 807, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_y_pred, __pyx_v_eps, __pyx_t_2};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 809, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 807, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   {
-    __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 809, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 807, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     if (__pyx_t_4) {
       __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
     }
     __Pyx_INCREF(__pyx_v_y_pred);
     __Pyx_GIVEREF(__pyx_v_y_pred);
     PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_5, __pyx_v_y_pred);
     __Pyx_INCREF(__pyx_v_eps);
     __Pyx_GIVEREF(__pyx_v_eps);
     PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, __pyx_v_eps);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_5, __pyx_t_2);
     __pyx_t_2 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 809, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 807, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF_SET(__pyx_v_y_pred, __pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":810
+  /* "structureboost/structure_gb.pyx":808
  * def my_log_loss(y_true, y_pred, eps=1e-16):
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(y_true*(np.log(y_pred)) + (1-y_true)*np.log(1-y_pred))             # <<<<<<<<<<<<<<
  *     return out_val
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 808, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_mean); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_mean); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 808, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 808, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_log); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_log); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 808, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_3 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_v_y_pred) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_y_pred);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 810, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 808, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyNumber_Multiply(__pyx_v_y_true, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_v_y_true, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 808, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_y_true, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_y_true, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 808, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 808, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_log); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_log); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 808, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_y_pred, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_y_pred, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 808, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __pyx_t_9 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
     __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_8);
     if (likely(__pyx_t_9)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
       __Pyx_INCREF(__pyx_t_9);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_8, function);
     }
   }
   __pyx_t_2 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_9, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_7);
   __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 810, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 808, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_8 = PyNumber_Multiply(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __pyx_t_8 = PyNumber_Multiply(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 808, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Add(__pyx_t_4, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Add(__pyx_t_4, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 808, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   __pyx_t_8 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_8)) {
@@ -19620,36 +19607,36 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_1 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_8, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 810, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 808, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 810, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 808, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_out_val = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "structureboost/structure_gb.pyx":811
+  /* "structureboost/structure_gb.pyx":809
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(y_true*(np.log(y_pred)) + (1-y_true)*np.log(1-y_pred))
  *     return out_val             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_out_val);
   __pyx_r = __pyx_v_out_val;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":808
+  /* "structureboost/structure_gb.pyx":806
  * 
  * 
  * def my_log_loss(y_true, y_pred, eps=1e-16):             # <<<<<<<<<<<<<<
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(y_true*(np.log(y_pred)) + (1-y_true)*np.log(1-y_pred))
  */
 
@@ -19670,15 +19657,15 @@
   __Pyx_XDECREF(__pyx_v_y_pred);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":814
+/* "structureboost/structure_gb.pyx":812
  * 
  * 
  * def my_log_loss_vec(y_true_mat, y_pred, eps=1e-16):             # <<<<<<<<<<<<<<
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(np.sum(y_true_mat*np.log(y_pred),axis=1))
  */
 
@@ -19717,25 +19704,25 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_true_mat)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_pred)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("my_log_loss_vec", 0, 2, 3, 1); __PYX_ERR(0, 814, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("my_log_loss_vec", 0, 2, 3, 1); __PYX_ERR(0, 812, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_eps);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "my_log_loss_vec") < 0)) __PYX_ERR(0, 814, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "my_log_loss_vec") < 0)) __PYX_ERR(0, 812, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
@@ -19745,15 +19732,15 @@
     }
     __pyx_v_y_true_mat = values[0];
     __pyx_v_y_pred = values[1];
     __pyx_v_eps = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("my_log_loss_vec", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 814, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("my_log_loss_vec", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 812, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.my_log_loss_vec", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_10my_log_loss_vec(__pyx_self, __pyx_v_y_true_mat, __pyx_v_y_pred, __pyx_v_eps);
 
@@ -19775,30 +19762,30 @@
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__39)
   __Pyx_RefNannySetupContext("my_log_loss_vec", 0);
-  __Pyx_TraceCall("my_log_loss_vec", __pyx_f[0], 814, 0, __PYX_ERR(0, 814, __pyx_L1_error));
+  __Pyx_TraceCall("my_log_loss_vec", __pyx_f[0], 812, 0, __PYX_ERR(0, 812, __pyx_L1_error));
   __Pyx_INCREF(__pyx_v_y_pred);
 
-  /* "structureboost/structure_gb.pyx":815
+  /* "structureboost/structure_gb.pyx":813
  * 
  * def my_log_loss_vec(y_true_mat, y_pred, eps=1e-16):
  *     y_pred = np.clip(y_pred, eps, (1-eps))             # <<<<<<<<<<<<<<
  *     out_val = -np.mean(np.sum(y_true_mat*np.log(y_pred),axis=1))
  *     return out_val
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 815, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 813, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_clip); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 815, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_clip); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 813, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_eps, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 815, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_eps, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 813, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -19807,101 +19794,101 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_5 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_y_pred, __pyx_v_eps, __pyx_t_2};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 815, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 813, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_y_pred, __pyx_v_eps, __pyx_t_2};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 815, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 813, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   {
-    __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 815, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 813, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     if (__pyx_t_4) {
       __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
     }
     __Pyx_INCREF(__pyx_v_y_pred);
     __Pyx_GIVEREF(__pyx_v_y_pred);
     PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_5, __pyx_v_y_pred);
     __Pyx_INCREF(__pyx_v_eps);
     __Pyx_GIVEREF(__pyx_v_eps);
     PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, __pyx_v_eps);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_5, __pyx_t_2);
     __pyx_t_2 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 815, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 813, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF_SET(__pyx_v_y_pred, __pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":816
+  /* "structureboost/structure_gb.pyx":814
  * def my_log_loss_vec(y_true_mat, y_pred, eps=1e-16):
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(np.sum(y_true_mat*np.log(y_pred),axis=1))             # <<<<<<<<<<<<<<
  *     return out_val
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_mean); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_mean); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_sum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_sum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_log); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_log); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_7);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_7, function);
     }
   }
   __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_4, __pyx_v_y_pred) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_y_pred);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 816, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = PyNumber_Multiply(__pyx_v_y_true_mat, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __pyx_t_7 = PyNumber_Multiply(__pyx_v_y_true_mat, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_7);
   __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_axis, __pyx_int_1) < 0) __PYX_ERR(0, 816, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 816, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_axis, __pyx_int_1) < 0) __PYX_ERR(0, 814, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_7 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
@@ -19911,36 +19898,36 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_7, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 816, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 816, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_out_val = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "structureboost/structure_gb.pyx":817
+  /* "structureboost/structure_gb.pyx":815
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(np.sum(y_true_mat*np.log(y_pred),axis=1))
  *     return out_val             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_out_val);
   __pyx_r = __pyx_v_out_val;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":814
+  /* "structureboost/structure_gb.pyx":812
  * 
  * 
  * def my_log_loss_vec(y_true_mat, y_pred, eps=1e-16):             # <<<<<<<<<<<<<<
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(np.sum(y_true_mat*np.log(y_pred),axis=1))
  */
 
@@ -19959,15 +19946,15 @@
   __Pyx_XDECREF(__pyx_v_y_pred);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":820
+/* "structureboost/structure_gb.pyx":818
  * 
  * 
  * def my_mean_squared_error(y_true, y_pred):             # <<<<<<<<<<<<<<
  *     return(np.mean((y_true-y_pred)*(y_true-y_pred)))
  * 
  */
 
@@ -20002,32 +19989,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_true)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_pred)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("my_mean_squared_error", 1, 2, 2, 1); __PYX_ERR(0, 820, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("my_mean_squared_error", 1, 2, 2, 1); __PYX_ERR(0, 818, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "my_mean_squared_error") < 0)) __PYX_ERR(0, 820, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "my_mean_squared_error") < 0)) __PYX_ERR(0, 818, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_y_true = values[0];
     __pyx_v_y_pred = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("my_mean_squared_error", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 820, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("my_mean_squared_error", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 818, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.my_mean_squared_error", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_12my_mean_squared_error(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred);
 
@@ -20046,34 +20033,34 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__40)
   __Pyx_RefNannySetupContext("my_mean_squared_error", 0);
-  __Pyx_TraceCall("my_mean_squared_error", __pyx_f[0], 820, 0, __PYX_ERR(0, 820, __pyx_L1_error));
+  __Pyx_TraceCall("my_mean_squared_error", __pyx_f[0], 818, 0, __PYX_ERR(0, 818, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":821
+  /* "structureboost/structure_gb.pyx":819
  * 
  * def my_mean_squared_error(y_true, y_pred):
  *     return(np.mean((y_true-y_pred)*(y_true-y_pred)))             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 821, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_mean); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 821, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_mean); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Subtract(__pyx_v_y_true, __pyx_v_y_pred); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 821, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Subtract(__pyx_v_y_true, __pyx_v_y_pred); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyNumber_Subtract(__pyx_v_y_true, __pyx_v_y_pred); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 821, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Subtract(__pyx_v_y_true, __pyx_v_y_pred); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyNumber_Multiply(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 821, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Multiply(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
@@ -20082,22 +20069,22 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 821, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":820
+  /* "structureboost/structure_gb.pyx":818
  * 
  * 
  * def my_mean_squared_error(y_true, y_pred):             # <<<<<<<<<<<<<<
  *     return(np.mean((y_true-y_pred)*(y_true-y_pred)))
  * 
  */
 
@@ -20113,15 +20100,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":824
+/* "structureboost/structure_gb.pyx":822
  * 
  * 
  * def randomize_node_na_dir_weighted(curr_node):             # <<<<<<<<<<<<<<
  *     if (('node_type' in curr_node.keys()) and
  *                 (curr_node['node_type'] == 'interior')):
  */
 
@@ -20153,329 +20140,329 @@
   int __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__41)
   __Pyx_RefNannySetupContext("randomize_node_na_dir_weighted", 0);
-  __Pyx_TraceCall("randomize_node_na_dir_weighted", __pyx_f[0], 824, 0, __PYX_ERR(0, 824, __pyx_L1_error));
+  __Pyx_TraceCall("randomize_node_na_dir_weighted", __pyx_f[0], 822, 0, __PYX_ERR(0, 822, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":825
+  /* "structureboost/structure_gb.pyx":823
  * 
  * def randomize_node_na_dir_weighted(curr_node):
  *     if (('node_type' in curr_node.keys()) and             # <<<<<<<<<<<<<<
  *                 (curr_node['node_type'] == 'interior')):
  *         if ('na_dir_random' in curr_node.keys()) and (
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_curr_node, __pyx_n_s_keys); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 825, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_curr_node, __pyx_n_s_keys); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 823, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 825, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 823, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_node_type, __pyx_t_2, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 825, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_node_type, __pyx_t_2, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 823, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_6 = (__pyx_t_5 != 0);
   if (__pyx_t_6) {
   } else {
     __pyx_t_1 = __pyx_t_6;
     goto __pyx_L4_bool_binop_done;
   }
 
-  /* "structureboost/structure_gb.pyx":826
+  /* "structureboost/structure_gb.pyx":824
  * def randomize_node_na_dir_weighted(curr_node):
  *     if (('node_type' in curr_node.keys()) and
  *                 (curr_node['node_type'] == 'interior')):             # <<<<<<<<<<<<<<
  *         if ('na_dir_random' in curr_node.keys()) and (
  *              curr_node['na_dir_random'] == 1):
  */
-  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_node_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 826, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_node_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 824, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_t_2, __pyx_n_u_interior, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 826, __pyx_L1_error)
+  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_t_2, __pyx_n_u_interior, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 824, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_1 = __pyx_t_6;
   __pyx_L4_bool_binop_done:;
 
-  /* "structureboost/structure_gb.pyx":825
+  /* "structureboost/structure_gb.pyx":823
  * 
  * def randomize_node_na_dir_weighted(curr_node):
  *     if (('node_type' in curr_node.keys()) and             # <<<<<<<<<<<<<<
  *                 (curr_node['node_type'] == 'interior')):
  *         if ('na_dir_random' in curr_node.keys()) and (
  */
   if (__pyx_t_1) {
 
-    /* "structureboost/structure_gb.pyx":827
+    /* "structureboost/structure_gb.pyx":825
  *     if (('node_type' in curr_node.keys()) and
  *                 (curr_node['node_type'] == 'interior')):
  *         if ('na_dir_random' in curr_node.keys()) and (             # <<<<<<<<<<<<<<
  *              curr_node['na_dir_random'] == 1):
  *             lw = curr_node['left_child']['num_data_points']
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_curr_node, __pyx_n_s_keys); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 827, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_curr_node, __pyx_n_s_keys); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 825, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 827, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 825, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_na_dir_random, __pyx_t_2, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 827, __pyx_L1_error)
+    __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_na_dir_random, __pyx_t_2, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 825, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_5 = (__pyx_t_6 != 0);
     if (__pyx_t_5) {
     } else {
       __pyx_t_1 = __pyx_t_5;
       goto __pyx_L7_bool_binop_done;
     }
 
-    /* "structureboost/structure_gb.pyx":828
+    /* "structureboost/structure_gb.pyx":826
  *                 (curr_node['node_type'] == 'interior')):
  *         if ('na_dir_random' in curr_node.keys()) and (
  *              curr_node['na_dir_random'] == 1):             # <<<<<<<<<<<<<<
  *             lw = curr_node['left_child']['num_data_points']
  *             rw = curr_node['right_child']['num_data_points']
  */
-    __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_na_dir_random); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 828, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_na_dir_random); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 826, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_t_2, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 828, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_t_2, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 826, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 828, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 826, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_1 = __pyx_t_5;
     __pyx_L7_bool_binop_done:;
 
-    /* "structureboost/structure_gb.pyx":827
+    /* "structureboost/structure_gb.pyx":825
  *     if (('node_type' in curr_node.keys()) and
  *                 (curr_node['node_type'] == 'interior')):
  *         if ('na_dir_random' in curr_node.keys()) and (             # <<<<<<<<<<<<<<
  *              curr_node['na_dir_random'] == 1):
  *             lw = curr_node['left_child']['num_data_points']
  */
     if (__pyx_t_1) {
 
-      /* "structureboost/structure_gb.pyx":829
+      /* "structureboost/structure_gb.pyx":827
  *         if ('na_dir_random' in curr_node.keys()) and (
  *              curr_node['na_dir_random'] == 1):
  *             lw = curr_node['left_child']['num_data_points']             # <<<<<<<<<<<<<<
  *             rw = curr_node['right_child']['num_data_points']
  *             curr_node['na_left'] = int(random.random() < (lw/(lw+rw)))
  */
-      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 829, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 827, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_t_3, __pyx_n_u_num_data_points); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 829, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_t_3, __pyx_n_u_num_data_points); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 827, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_v_lw = __pyx_t_2;
       __pyx_t_2 = 0;
 
-      /* "structureboost/structure_gb.pyx":830
+      /* "structureboost/structure_gb.pyx":828
  *              curr_node['na_dir_random'] == 1):
  *             lw = curr_node['left_child']['num_data_points']
  *             rw = curr_node['right_child']['num_data_points']             # <<<<<<<<<<<<<<
  *             curr_node['na_left'] = int(random.random() < (lw/(lw+rw)))
  *         if curr_node['left_child']['node_type'] == 'interior':
  */
-      __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 830, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 828, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_num_data_points); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 830, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_num_data_points); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 828, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_v_rw = __pyx_t_3;
       __pyx_t_3 = 0;
 
-      /* "structureboost/structure_gb.pyx":831
+      /* "structureboost/structure_gb.pyx":829
  *             lw = curr_node['left_child']['num_data_points']
  *             rw = curr_node['right_child']['num_data_points']
  *             curr_node['na_left'] = int(random.random() < (lw/(lw+rw)))             # <<<<<<<<<<<<<<
  *         if curr_node['left_child']['node_type'] == 'interior':
  *             randomize_node_na_dir_weighted(curr_node['left_child'])
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 831, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 829, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 831, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 829, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_2 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_2)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
           __Pyx_INCREF(__pyx_t_2);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_4, function);
         }
       }
       __pyx_t_3 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 831, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 829, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = PyNumber_Add(__pyx_v_lw, __pyx_v_rw); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 831, __pyx_L1_error)
+      __pyx_t_4 = PyNumber_Add(__pyx_v_lw, __pyx_v_rw); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 829, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_v_lw, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 831, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_v_lw, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 829, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = PyObject_RichCompare(__pyx_t_3, __pyx_t_2, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 831, __pyx_L1_error)
+      __pyx_t_4 = PyObject_RichCompare(__pyx_t_3, __pyx_t_2, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 829, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 831, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 829, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(PyObject_SetItem(__pyx_v_curr_node, __pyx_n_u_na_left, __pyx_t_2) < 0)) __PYX_ERR(0, 831, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_v_curr_node, __pyx_n_u_na_left, __pyx_t_2) < 0)) __PYX_ERR(0, 829, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-      /* "structureboost/structure_gb.pyx":827
+      /* "structureboost/structure_gb.pyx":825
  *     if (('node_type' in curr_node.keys()) and
  *                 (curr_node['node_type'] == 'interior')):
  *         if ('na_dir_random' in curr_node.keys()) and (             # <<<<<<<<<<<<<<
  *              curr_node['na_dir_random'] == 1):
  *             lw = curr_node['left_child']['num_data_points']
  */
     }
 
-    /* "structureboost/structure_gb.pyx":832
+    /* "structureboost/structure_gb.pyx":830
  *             rw = curr_node['right_child']['num_data_points']
  *             curr_node['na_left'] = int(random.random() < (lw/(lw+rw)))
  *         if curr_node['left_child']['node_type'] == 'interior':             # <<<<<<<<<<<<<<
  *             randomize_node_na_dir_weighted(curr_node['left_child'])
  *         if curr_node['right_child']['node_type'] == 'interior':
  */
-    __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 832, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 830, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_node_type); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 832, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_node_type); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 830, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_t_4, __pyx_n_u_interior, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 832, __pyx_L1_error)
+    __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_t_4, __pyx_n_u_interior, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 830, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     if (__pyx_t_1) {
 
-      /* "structureboost/structure_gb.pyx":833
+      /* "structureboost/structure_gb.pyx":831
  *             curr_node['na_left'] = int(random.random() < (lw/(lw+rw)))
  *         if curr_node['left_child']['node_type'] == 'interior':
  *             randomize_node_na_dir_weighted(curr_node['left_child'])             # <<<<<<<<<<<<<<
  *         if curr_node['right_child']['node_type'] == 'interior':
  *             randomize_node_na_dir_weighted(curr_node['right_child'])
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_randomize_node_na_dir_weighted); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 833, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_randomize_node_na_dir_weighted); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 831, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 833, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 831, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_7 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
         __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_7)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
           __Pyx_INCREF(__pyx_t_7);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
       __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_7, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 833, __pyx_L1_error)
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 831, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "structureboost/structure_gb.pyx":832
+      /* "structureboost/structure_gb.pyx":830
  *             rw = curr_node['right_child']['num_data_points']
  *             curr_node['na_left'] = int(random.random() < (lw/(lw+rw)))
  *         if curr_node['left_child']['node_type'] == 'interior':             # <<<<<<<<<<<<<<
  *             randomize_node_na_dir_weighted(curr_node['left_child'])
  *         if curr_node['right_child']['node_type'] == 'interior':
  */
     }
 
-    /* "structureboost/structure_gb.pyx":834
+    /* "structureboost/structure_gb.pyx":832
  *         if curr_node['left_child']['node_type'] == 'interior':
  *             randomize_node_na_dir_weighted(curr_node['left_child'])
  *         if curr_node['right_child']['node_type'] == 'interior':             # <<<<<<<<<<<<<<
  *             randomize_node_na_dir_weighted(curr_node['right_child'])
  * 
  */
-    __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 834, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 832, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_t_4, __pyx_n_u_node_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 834, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_t_4, __pyx_n_u_node_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 832, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_t_2, __pyx_n_u_interior, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 834, __pyx_L1_error)
+    __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_t_2, __pyx_n_u_interior, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 832, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (__pyx_t_1) {
 
-      /* "structureboost/structure_gb.pyx":835
+      /* "structureboost/structure_gb.pyx":833
  *             randomize_node_na_dir_weighted(curr_node['left_child'])
  *         if curr_node['right_child']['node_type'] == 'interior':
  *             randomize_node_na_dir_weighted(curr_node['right_child'])             # <<<<<<<<<<<<<<
  * 
  * 
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_randomize_node_na_dir_weighted); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 835, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_randomize_node_na_dir_weighted); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 833, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 835, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 833, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_7 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_7)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
           __Pyx_INCREF(__pyx_t_7);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_4, function);
         }
       }
       __pyx_t_2 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_7, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 835, __pyx_L1_error)
+      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 833, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-      /* "structureboost/structure_gb.pyx":834
+      /* "structureboost/structure_gb.pyx":832
  *         if curr_node['left_child']['node_type'] == 'interior':
  *             randomize_node_na_dir_weighted(curr_node['left_child'])
  *         if curr_node['right_child']['node_type'] == 'interior':             # <<<<<<<<<<<<<<
  *             randomize_node_na_dir_weighted(curr_node['right_child'])
  * 
  */
     }
 
-    /* "structureboost/structure_gb.pyx":825
+    /* "structureboost/structure_gb.pyx":823
  * 
  * def randomize_node_na_dir_weighted(curr_node):
  *     if (('node_type' in curr_node.keys()) and             # <<<<<<<<<<<<<<
  *                 (curr_node['node_type'] == 'interior')):
  *         if ('na_dir_random' in curr_node.keys()) and (
  */
   }
 
-  /* "structureboost/structure_gb.pyx":824
+  /* "structureboost/structure_gb.pyx":822
  * 
  * 
  * def randomize_node_na_dir_weighted(curr_node):             # <<<<<<<<<<<<<<
  *     if (('node_type' in curr_node.keys()) and
  *                 (curr_node['node_type'] == 'interior')):
  */
 
@@ -20494,15 +20481,15 @@
   __Pyx_XDECREF(__pyx_v_rw);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":842
+/* "structureboost/structure_gb.pyx":840
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
  * def c_entropy_link_der_1(np.ndarray[double] y_true,             # <<<<<<<<<<<<<<
  *                          np.ndarray[double] z_pred):
  *     cdef int N = y_true.shape[0]
  */
 
@@ -20537,39 +20524,39 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_true)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z_pred)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("c_entropy_link_der_1", 1, 2, 2, 1); __PYX_ERR(0, 842, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("c_entropy_link_der_1", 1, 2, 2, 1); __PYX_ERR(0, 840, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "c_entropy_link_der_1") < 0)) __PYX_ERR(0, 842, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "c_entropy_link_der_1") < 0)) __PYX_ERR(0, 840, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_y_true = ((PyArrayObject *)values[0]);
     __pyx_v_z_pred = ((PyArrayObject *)values[1]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("c_entropy_link_der_1", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 842, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("c_entropy_link_der_1", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 840, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.c_entropy_link_der_1", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_y_true), __pyx_ptype_5numpy_ndarray, 1, "y_true", 0))) __PYX_ERR(0, 842, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_pred), __pyx_ptype_5numpy_ndarray, 1, "z_pred", 0))) __PYX_ERR(0, 843, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_y_true), __pyx_ptype_5numpy_ndarray, 1, "y_true", 0))) __PYX_ERR(0, 840, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_pred), __pyx_ptype_5numpy_ndarray, 1, "z_pred", 0))) __PYX_ERR(0, 841, __pyx_L1_error)
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_16c_entropy_link_der_1(__pyx_self, __pyx_v_y_true, __pyx_v_z_pred);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -20602,139 +20589,139 @@
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__42)
   __Pyx_RefNannySetupContext("c_entropy_link_der_1", 0);
-  __Pyx_TraceCall("c_entropy_link_der_1", __pyx_f[0], 842, 0, __PYX_ERR(0, 842, __pyx_L1_error));
+  __Pyx_TraceCall("c_entropy_link_der_1", __pyx_f[0], 840, 0, __PYX_ERR(0, 840, __pyx_L1_error));
   __pyx_pybuffer_y_true.pybuffer.buf = NULL;
   __pyx_pybuffer_y_true.refcount = 0;
   __pyx_pybuffernd_y_true.data = NULL;
   __pyx_pybuffernd_y_true.rcbuffer = &__pyx_pybuffer_y_true;
   __pyx_pybuffer_z_pred.pybuffer.buf = NULL;
   __pyx_pybuffer_z_pred.refcount = 0;
   __pyx_pybuffernd_z_pred.data = NULL;
   __pyx_pybuffernd_z_pred.rcbuffer = &__pyx_pybuffer_z_pred;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_y_true.rcbuffer->pybuffer, (PyObject*)__pyx_v_y_true, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 842, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_y_true.rcbuffer->pybuffer, (PyObject*)__pyx_v_y_true, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 840, __pyx_L1_error)
   }
   __pyx_pybuffernd_y_true.diminfo[0].strides = __pyx_pybuffernd_y_true.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_y_true.diminfo[0].shape = __pyx_pybuffernd_y_true.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_pred.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_pred, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 842, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_pred.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_pred, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 840, __pyx_L1_error)
   }
   __pyx_pybuffernd_z_pred.diminfo[0].strides = __pyx_pybuffernd_z_pred.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z_pred.diminfo[0].shape = __pyx_pybuffernd_z_pred.rcbuffer->pybuffer.shape[0];
 
-  /* "structureboost/structure_gb.pyx":844
+  /* "structureboost/structure_gb.pyx":842
  * def c_entropy_link_der_1(np.ndarray[double] y_true,
  *                          np.ndarray[double] z_pred):
  *     cdef int N = y_true.shape[0]             # <<<<<<<<<<<<<<
  *     cdef double[:] Y = np.zeros(N)
  *     cdef double denom1, denom2
  */
   __pyx_v_N = (__pyx_v_y_true->dimensions[0]);
 
-  /* "structureboost/structure_gb.pyx":845
+  /* "structureboost/structure_gb.pyx":843
  *                          np.ndarray[double] z_pred):
  *     cdef int N = y_true.shape[0]
  *     cdef double[:] Y = np.zeros(N)             # <<<<<<<<<<<<<<
  *     cdef double denom1, denom2
  *     cdef long i
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 845, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 843, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 845, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 843, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_N); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 845, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_N); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 843, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 845, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 843, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 845, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 843, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_Y = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "structureboost/structure_gb.pyx":849
+  /* "structureboost/structure_gb.pyx":847
  *     cdef long i
  * 
  *     for i in range(N):             # <<<<<<<<<<<<<<
  *         denom_1 = 1+exp(z_pred[i])
  *         denom_2 = 1+exp(-z_pred[i])
  */
   __pyx_t_6 = __pyx_v_N;
   __pyx_t_7 = __pyx_t_6;
   for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
     __pyx_v_i = __pyx_t_8;
 
-    /* "structureboost/structure_gb.pyx":850
+    /* "structureboost/structure_gb.pyx":848
  * 
  *     for i in range(N):
  *         denom_1 = 1+exp(z_pred[i])             # <<<<<<<<<<<<<<
  *         denom_2 = 1+exp(-z_pred[i])
  *         Y[i] = (-y_true[i]*(1/denom_1) + (1-y_true[i]) * (1/denom_2))
  */
     __pyx_t_9 = __pyx_v_i;
     __pyx_v_denom_1 = (1.0 + exp((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_z_pred.rcbuffer->pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_z_pred.diminfo[0].strides))));
 
-    /* "structureboost/structure_gb.pyx":851
+    /* "structureboost/structure_gb.pyx":849
  *     for i in range(N):
  *         denom_1 = 1+exp(z_pred[i])
  *         denom_2 = 1+exp(-z_pred[i])             # <<<<<<<<<<<<<<
  *         Y[i] = (-y_true[i]*(1/denom_1) + (1-y_true[i]) * (1/denom_2))
  *     return Y
  */
     __pyx_t_9 = __pyx_v_i;
     __pyx_v_denom_2 = (1.0 + exp((-(*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_z_pred.rcbuffer->pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_z_pred.diminfo[0].strides)))));
 
-    /* "structureboost/structure_gb.pyx":852
+    /* "structureboost/structure_gb.pyx":850
  *         denom_1 = 1+exp(z_pred[i])
  *         denom_2 = 1+exp(-z_pred[i])
  *         Y[i] = (-y_true[i]*(1/denom_1) + (1-y_true[i]) * (1/denom_2))             # <<<<<<<<<<<<<<
  *     return Y
  * 
  */
     __pyx_t_9 = __pyx_v_i;
     __pyx_t_10 = __pyx_v_i;
     __pyx_t_11 = __pyx_v_i;
     *((double *) ( /* dim=0 */ (__pyx_v_Y.data + __pyx_t_11 * __pyx_v_Y.strides[0]) )) = (((-(*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_y_true.rcbuffer->pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_y_true.diminfo[0].strides))) * (1.0 / __pyx_v_denom_1)) + ((1.0 - (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_y_true.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_y_true.diminfo[0].strides))) * (1.0 / __pyx_v_denom_2)));
   }
 
-  /* "structureboost/structure_gb.pyx":853
+  /* "structureboost/structure_gb.pyx":851
  *         denom_2 = 1+exp(-z_pred[i])
  *         Y[i] = (-y_true[i]*(1/denom_1) + (1-y_true[i]) * (1/denom_2))
  *     return Y             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_Y, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 853, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_Y, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":842
+  /* "structureboost/structure_gb.pyx":840
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
  * def c_entropy_link_der_1(np.ndarray[double] y_true,             # <<<<<<<<<<<<<<
  *                          np.ndarray[double] z_pred):
  *     cdef int N = y_true.shape[0]
  */
 
@@ -20762,15 +20749,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_Y, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":860
+/* "structureboost/structure_gb.pyx":858
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
  * def c_entropy_link_der_2(np.ndarray[double] y_true,             # <<<<<<<<<<<<<<
  *                          np.ndarray[double] z_pred):
  *     cdef int N = y_true.shape[0]
  */
 
@@ -20805,39 +20792,39 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_true)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_z_pred)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("c_entropy_link_der_2", 1, 2, 2, 1); __PYX_ERR(0, 860, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("c_entropy_link_der_2", 1, 2, 2, 1); __PYX_ERR(0, 858, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "c_entropy_link_der_2") < 0)) __PYX_ERR(0, 860, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "c_entropy_link_der_2") < 0)) __PYX_ERR(0, 858, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_y_true = ((PyArrayObject *)values[0]);
     __pyx_v_z_pred = ((PyArrayObject *)values[1]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("c_entropy_link_der_2", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 860, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("c_entropy_link_der_2", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 858, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.c_entropy_link_der_2", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_y_true), __pyx_ptype_5numpy_ndarray, 1, "y_true", 0))) __PYX_ERR(0, 860, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_pred), __pyx_ptype_5numpy_ndarray, 1, "z_pred", 0))) __PYX_ERR(0, 861, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_y_true), __pyx_ptype_5numpy_ndarray, 1, "y_true", 0))) __PYX_ERR(0, 858, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_z_pred), __pyx_ptype_5numpy_ndarray, 1, "z_pred", 0))) __PYX_ERR(0, 859, __pyx_L1_error)
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_18c_entropy_link_der_2(__pyx_self, __pyx_v_y_true, __pyx_v_z_pred);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -20872,165 +20859,165 @@
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__43)
   __Pyx_RefNannySetupContext("c_entropy_link_der_2", 0);
-  __Pyx_TraceCall("c_entropy_link_der_2", __pyx_f[0], 860, 0, __PYX_ERR(0, 860, __pyx_L1_error));
+  __Pyx_TraceCall("c_entropy_link_der_2", __pyx_f[0], 858, 0, __PYX_ERR(0, 858, __pyx_L1_error));
   __pyx_pybuffer_y_true.pybuffer.buf = NULL;
   __pyx_pybuffer_y_true.refcount = 0;
   __pyx_pybuffernd_y_true.data = NULL;
   __pyx_pybuffernd_y_true.rcbuffer = &__pyx_pybuffer_y_true;
   __pyx_pybuffer_z_pred.pybuffer.buf = NULL;
   __pyx_pybuffer_z_pred.refcount = 0;
   __pyx_pybuffernd_z_pred.data = NULL;
   __pyx_pybuffernd_z_pred.rcbuffer = &__pyx_pybuffer_z_pred;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_y_true.rcbuffer->pybuffer, (PyObject*)__pyx_v_y_true, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 860, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_y_true.rcbuffer->pybuffer, (PyObject*)__pyx_v_y_true, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 858, __pyx_L1_error)
   }
   __pyx_pybuffernd_y_true.diminfo[0].strides = __pyx_pybuffernd_y_true.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_y_true.diminfo[0].shape = __pyx_pybuffernd_y_true.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_pred.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_pred, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 860, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_z_pred.rcbuffer->pybuffer, (PyObject*)__pyx_v_z_pred, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 858, __pyx_L1_error)
   }
   __pyx_pybuffernd_z_pred.diminfo[0].strides = __pyx_pybuffernd_z_pred.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_z_pred.diminfo[0].shape = __pyx_pybuffernd_z_pred.rcbuffer->pybuffer.shape[0];
 
-  /* "structureboost/structure_gb.pyx":862
+  /* "structureboost/structure_gb.pyx":860
  * def c_entropy_link_der_2(np.ndarray[double] y_true,
  *                          np.ndarray[double] z_pred):
  *     cdef int N = y_true.shape[0]             # <<<<<<<<<<<<<<
  *     cdef double[:] Y = np.zeros(N)
  *     cdef double z_pred_exp, minus_z_pred_exp, denom1, denom2
  */
   __pyx_v_N = (__pyx_v_y_true->dimensions[0]);
 
-  /* "structureboost/structure_gb.pyx":863
+  /* "structureboost/structure_gb.pyx":861
  *                          np.ndarray[double] z_pred):
  *     cdef int N = y_true.shape[0]
  *     cdef double[:] Y = np.zeros(N)             # <<<<<<<<<<<<<<
  *     cdef double z_pred_exp, minus_z_pred_exp, denom1, denom2
  *     cdef long i
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 863, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 861, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 863, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 861, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_N); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 863, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_N); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 861, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 863, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 861, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_ds_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 861, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_Y = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "structureboost/structure_gb.pyx":867
+  /* "structureboost/structure_gb.pyx":865
  *     cdef long i
  * 
  *     for i in range(N):             # <<<<<<<<<<<<<<
  *         z_pred_exp = exp(z_pred[i])
  *         minus_z_pred_exp = exp(-z_pred[i])
  */
   __pyx_t_6 = __pyx_v_N;
   __pyx_t_7 = __pyx_t_6;
   for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
     __pyx_v_i = __pyx_t_8;
 
-    /* "structureboost/structure_gb.pyx":868
+    /* "structureboost/structure_gb.pyx":866
  * 
  *     for i in range(N):
  *         z_pred_exp = exp(z_pred[i])             # <<<<<<<<<<<<<<
  *         minus_z_pred_exp = exp(-z_pred[i])
  *         denom_1 = (1+z_pred_exp)*(1+z_pred_exp)
  */
     __pyx_t_9 = __pyx_v_i;
     __pyx_v_z_pred_exp = exp((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_z_pred.rcbuffer->pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_z_pred.diminfo[0].strides)));
 
-    /* "structureboost/structure_gb.pyx":869
+    /* "structureboost/structure_gb.pyx":867
  *     for i in range(N):
  *         z_pred_exp = exp(z_pred[i])
  *         minus_z_pred_exp = exp(-z_pred[i])             # <<<<<<<<<<<<<<
  *         denom_1 = (1+z_pred_exp)*(1+z_pred_exp)
  *         denom_2 = (1+minus_z_pred_exp)*(1+minus_z_pred_exp)
  */
     __pyx_t_9 = __pyx_v_i;
     __pyx_v_minus_z_pred_exp = exp((-(*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_z_pred.rcbuffer->pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_z_pred.diminfo[0].strides))));
 
-    /* "structureboost/structure_gb.pyx":870
+    /* "structureboost/structure_gb.pyx":868
  *         z_pred_exp = exp(z_pred[i])
  *         minus_z_pred_exp = exp(-z_pred[i])
  *         denom_1 = (1+z_pred_exp)*(1+z_pred_exp)             # <<<<<<<<<<<<<<
  *         denom_2 = (1+minus_z_pred_exp)*(1+minus_z_pred_exp)
  *         Y[i] = (y_true[i]*(z_pred_exp/denom_1) + (1-y_true[i]) *
  */
     __pyx_v_denom_1 = ((1.0 + __pyx_v_z_pred_exp) * (1.0 + __pyx_v_z_pred_exp));
 
-    /* "structureboost/structure_gb.pyx":871
+    /* "structureboost/structure_gb.pyx":869
  *         minus_z_pred_exp = exp(-z_pred[i])
  *         denom_1 = (1+z_pred_exp)*(1+z_pred_exp)
  *         denom_2 = (1+minus_z_pred_exp)*(1+minus_z_pred_exp)             # <<<<<<<<<<<<<<
  *         Y[i] = (y_true[i]*(z_pred_exp/denom_1) + (1-y_true[i]) *
  *                           (minus_z_pred_exp/denom_2))
  */
     __pyx_v_denom_2 = ((1.0 + __pyx_v_minus_z_pred_exp) * (1.0 + __pyx_v_minus_z_pred_exp));
 
-    /* "structureboost/structure_gb.pyx":872
+    /* "structureboost/structure_gb.pyx":870
  *         denom_1 = (1+z_pred_exp)*(1+z_pred_exp)
  *         denom_2 = (1+minus_z_pred_exp)*(1+minus_z_pred_exp)
  *         Y[i] = (y_true[i]*(z_pred_exp/denom_1) + (1-y_true[i]) *             # <<<<<<<<<<<<<<
  *                           (minus_z_pred_exp/denom_2))
  *     return Y
  */
     __pyx_t_9 = __pyx_v_i;
     __pyx_t_10 = __pyx_v_i;
 
-    /* "structureboost/structure_gb.pyx":873
+    /* "structureboost/structure_gb.pyx":871
  *         denom_2 = (1+minus_z_pred_exp)*(1+minus_z_pred_exp)
  *         Y[i] = (y_true[i]*(z_pred_exp/denom_1) + (1-y_true[i]) *
  *                           (minus_z_pred_exp/denom_2))             # <<<<<<<<<<<<<<
  *     return Y
  * 
  */
     __pyx_t_11 = __pyx_v_i;
     *((double *) ( /* dim=0 */ (__pyx_v_Y.data + __pyx_t_11 * __pyx_v_Y.strides[0]) )) = (((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_y_true.rcbuffer->pybuffer.buf, __pyx_t_9, __pyx_pybuffernd_y_true.diminfo[0].strides)) * (__pyx_v_z_pred_exp / __pyx_v_denom_1)) + ((1.0 - (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_y_true.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_y_true.diminfo[0].strides))) * (__pyx_v_minus_z_pred_exp / __pyx_v_denom_2)));
   }
 
-  /* "structureboost/structure_gb.pyx":874
+  /* "structureboost/structure_gb.pyx":872
  *         Y[i] = (y_true[i]*(z_pred_exp/denom_1) + (1-y_true[i]) *
  *                           (minus_z_pred_exp/denom_2))
  *     return Y             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_Y, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 874, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_Y, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 872, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":860
+  /* "structureboost/structure_gb.pyx":858
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
  * def c_entropy_link_der_2(np.ndarray[double] y_true,             # <<<<<<<<<<<<<<
  *                          np.ndarray[double] z_pred):
  *     cdef int N = y_true.shape[0]
  */
 
@@ -21058,15 +21045,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_Y, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":879
+/* "structureboost/structure_gb.pyx":877
  * @cython.boundscheck(False)
  * @cython.wraparound(False)
  * def predict_with_tensor_c(np.ndarray[double, ndim=3] dtm_float,             # <<<<<<<<<<<<<<
  *                       np.ndarray[long, ndim=3] dtm,
  *                       np.ndarray[double, ndim=2] feat_array):
  */
 
@@ -21104,48 +21091,48 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_dtm_float)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_dtm)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("predict_with_tensor_c", 1, 3, 3, 1); __PYX_ERR(0, 879, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("predict_with_tensor_c", 1, 3, 3, 1); __PYX_ERR(0, 877, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_feat_array)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("predict_with_tensor_c", 1, 3, 3, 2); __PYX_ERR(0, 879, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("predict_with_tensor_c", 1, 3, 3, 2); __PYX_ERR(0, 877, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "predict_with_tensor_c") < 0)) __PYX_ERR(0, 879, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "predict_with_tensor_c") < 0)) __PYX_ERR(0, 877, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_dtm_float = ((PyArrayObject *)values[0]);
     __pyx_v_dtm = ((PyArrayObject *)values[1]);
     __pyx_v_feat_array = ((PyArrayObject *)values[2]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("predict_with_tensor_c", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 879, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("predict_with_tensor_c", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 877, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.predict_with_tensor_c", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dtm_float), __pyx_ptype_5numpy_ndarray, 1, "dtm_float", 0))) __PYX_ERR(0, 879, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dtm), __pyx_ptype_5numpy_ndarray, 1, "dtm", 0))) __PYX_ERR(0, 880, __pyx_L1_error)
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_feat_array), __pyx_ptype_5numpy_ndarray, 1, "feat_array", 0))) __PYX_ERR(0, 881, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dtm_float), __pyx_ptype_5numpy_ndarray, 1, "dtm_float", 0))) __PYX_ERR(0, 877, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_dtm), __pyx_ptype_5numpy_ndarray, 1, "dtm", 0))) __PYX_ERR(0, 878, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_feat_array), __pyx_ptype_5numpy_ndarray, 1, "feat_array", 0))) __PYX_ERR(0, 879, __pyx_L1_error)
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_20predict_with_tensor_c(__pyx_self, __pyx_v_dtm_float, __pyx_v_dtm, __pyx_v_feat_array);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -21213,15 +21200,15 @@
   long __pyx_t_20;
   Py_ssize_t __pyx_t_21;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__44)
   __Pyx_RefNannySetupContext("predict_with_tensor_c", 0);
-  __Pyx_TraceCall("predict_with_tensor_c", __pyx_f[0], 879, 0, __PYX_ERR(0, 879, __pyx_L1_error));
+  __Pyx_TraceCall("predict_with_tensor_c", __pyx_f[0], 877, 0, __PYX_ERR(0, 877, __pyx_L1_error));
   __pyx_pybuffer_res_mat.pybuffer.buf = NULL;
   __pyx_pybuffer_res_mat.refcount = 0;
   __pyx_pybuffernd_res_mat.data = NULL;
   __pyx_pybuffernd_res_mat.rcbuffer = &__pyx_pybuffer_res_mat;
   __pyx_pybuffer_isnan_array.pybuffer.buf = NULL;
   __pyx_pybuffer_isnan_array.refcount = 0;
   __pyx_pybuffernd_isnan_array.data = NULL;
@@ -21236,45 +21223,45 @@
   __pyx_pybuffernd_dtm.rcbuffer = &__pyx_pybuffer_dtm;
   __pyx_pybuffer_feat_array.pybuffer.buf = NULL;
   __pyx_pybuffer_feat_array.refcount = 0;
   __pyx_pybuffernd_feat_array.data = NULL;
   __pyx_pybuffernd_feat_array.rcbuffer = &__pyx_pybuffer_feat_array;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_dtm_float.rcbuffer->pybuffer, (PyObject*)__pyx_v_dtm_float, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) __PYX_ERR(0, 879, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_dtm_float.rcbuffer->pybuffer, (PyObject*)__pyx_v_dtm_float, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) __PYX_ERR(0, 877, __pyx_L1_error)
   }
   __pyx_pybuffernd_dtm_float.diminfo[0].strides = __pyx_pybuffernd_dtm_float.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_dtm_float.diminfo[0].shape = __pyx_pybuffernd_dtm_float.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_dtm_float.diminfo[1].strides = __pyx_pybuffernd_dtm_float.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_dtm_float.diminfo[1].shape = __pyx_pybuffernd_dtm_float.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_dtm_float.diminfo[2].strides = __pyx_pybuffernd_dtm_float.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_dtm_float.diminfo[2].shape = __pyx_pybuffernd_dtm_float.rcbuffer->pybuffer.shape[2];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_dtm.rcbuffer->pybuffer, (PyObject*)__pyx_v_dtm, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) __PYX_ERR(0, 879, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_dtm.rcbuffer->pybuffer, (PyObject*)__pyx_v_dtm, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) __PYX_ERR(0, 877, __pyx_L1_error)
   }
   __pyx_pybuffernd_dtm.diminfo[0].strides = __pyx_pybuffernd_dtm.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_dtm.diminfo[0].shape = __pyx_pybuffernd_dtm.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_dtm.diminfo[1].strides = __pyx_pybuffernd_dtm.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_dtm.diminfo[1].shape = __pyx_pybuffernd_dtm.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_dtm.diminfo[2].strides = __pyx_pybuffernd_dtm.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_dtm.diminfo[2].shape = __pyx_pybuffernd_dtm.rcbuffer->pybuffer.shape[2];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feat_array.rcbuffer->pybuffer, (PyObject*)__pyx_v_feat_array, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 879, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feat_array.rcbuffer->pybuffer, (PyObject*)__pyx_v_feat_array, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 877, __pyx_L1_error)
   }
   __pyx_pybuffernd_feat_array.diminfo[0].strides = __pyx_pybuffernd_feat_array.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_feat_array.diminfo[0].shape = __pyx_pybuffernd_feat_array.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_feat_array.diminfo[1].strides = __pyx_pybuffernd_feat_array.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_feat_array.diminfo[1].shape = __pyx_pybuffernd_feat_array.rcbuffer->pybuffer.shape[1];
 
-  /* "structureboost/structure_gb.pyx":884
+  /* "structureboost/structure_gb.pyx":882
  * 
  *     cdef long cat_vals_end
  *     cdef np.ndarray[double, ndim=2] res_mat = np.zeros((feat_array.shape[0], dtm.shape[0]))             # <<<<<<<<<<<<<<
  *     cdef long cn, ri, ind, j, k
  *     cdef double curr_val, ind_doub
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 884, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 882, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 884, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 882, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_feat_array->dimensions[0])); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 884, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_feat_array->dimensions[0])); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 882, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_dtm->dimensions[0])); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 884, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_From_Py_intptr_t((__pyx_v_dtm->dimensions[0])); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 882, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 884, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 882, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
   __pyx_t_2 = 0;
   __pyx_t_4 = 0;
@@ -21287,344 +21274,344 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 884, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 882, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 884, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 882, __pyx_L1_error)
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_res_mat.rcbuffer->pybuffer, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
       __pyx_v_res_mat = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_res_mat.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 884, __pyx_L1_error)
+      __PYX_ERR(0, 882, __pyx_L1_error)
     } else {__pyx_pybuffernd_res_mat.diminfo[0].strides = __pyx_pybuffernd_res_mat.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_res_mat.diminfo[0].shape = __pyx_pybuffernd_res_mat.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_res_mat.diminfo[1].strides = __pyx_pybuffernd_res_mat.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_res_mat.diminfo[1].shape = __pyx_pybuffernd_res_mat.rcbuffer->pybuffer.shape[1];
     }
   }
   __pyx_t_6 = 0;
   __pyx_v_res_mat = ((PyArrayObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":888
+  /* "structureboost/structure_gb.pyx":886
  *     cdef double curr_val, ind_doub
  *     cdef bint at_leaf, found_val
  *     cdef np.ndarray[long, ndim=2] isnan_array = np.isnan(feat_array).astype(int)             # <<<<<<<<<<<<<<
  * 
  *     # These are in dtm_float
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 888, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 886, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_isnan); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 888, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_isnan); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 886, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, ((PyObject *)__pyx_v_feat_array)) : __Pyx_PyObject_CallOneArg(__pyx_t_4, ((PyObject *)__pyx_v_feat_array));
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 888, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 886, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 888, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 886, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, ((PyObject *)(&PyInt_Type))) : __Pyx_PyObject_CallOneArg(__pyx_t_4, ((PyObject *)(&PyInt_Type)));
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 888, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 888, __pyx_L1_error)
+  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 886, __pyx_L1_error)
   __pyx_t_7 = ((PyArrayObject *)__pyx_t_1);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_isnan_array.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
       __pyx_v_isnan_array = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_isnan_array.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 888, __pyx_L1_error)
+      __PYX_ERR(0, 886, __pyx_L1_error)
     } else {__pyx_pybuffernd_isnan_array.diminfo[0].strides = __pyx_pybuffernd_isnan_array.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_isnan_array.diminfo[0].shape = __pyx_pybuffernd_isnan_array.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_isnan_array.diminfo[1].strides = __pyx_pybuffernd_isnan_array.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_isnan_array.diminfo[1].shape = __pyx_pybuffernd_isnan_array.rcbuffer->pybuffer.shape[1];
     }
   }
   __pyx_t_7 = 0;
   __pyx_v_isnan_array = ((PyArrayObject *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":891
+  /* "structureboost/structure_gb.pyx":889
  * 
  *     # These are in dtm_float
  *     cdef long THRESH = 0             # <<<<<<<<<<<<<<
  *     cdef long NODE_WEIGHT = 1
  *     cdef long NODE_VALUE = 2
  */
   __pyx_v_THRESH = 0;
 
-  /* "structureboost/structure_gb.pyx":892
+  /* "structureboost/structure_gb.pyx":890
  *     # These are in dtm_float
  *     cdef long THRESH = 0
  *     cdef long NODE_WEIGHT = 1             # <<<<<<<<<<<<<<
  *     cdef long NODE_VALUE = 2
  * 
  */
   __pyx_v_NODE_WEIGHT = 1;
 
-  /* "structureboost/structure_gb.pyx":893
+  /* "structureboost/structure_gb.pyx":891
  *     cdef long THRESH = 0
  *     cdef long NODE_WEIGHT = 1
  *     cdef long NODE_VALUE = 2             # <<<<<<<<<<<<<<
  * 
  *     # These are in dtm_int
  */
   __pyx_v_NODE_VALUE = 2;
 
-  /* "structureboost/structure_gb.pyx":896
+  /* "structureboost/structure_gb.pyx":894
  * 
  *     # These are in dtm_int
  *     cdef long NODE_TYPE = 0             # <<<<<<<<<<<<<<
  *     cdef long FEATURE_COL = 1
  *     cdef long LEFT_CHILD = 2
  */
   __pyx_v_NODE_TYPE = 0;
 
-  /* "structureboost/structure_gb.pyx":897
+  /* "structureboost/structure_gb.pyx":895
  *     # These are in dtm_int
  *     cdef long NODE_TYPE = 0
  *     cdef long FEATURE_COL = 1             # <<<<<<<<<<<<<<
  *     cdef long LEFT_CHILD = 2
  *     cdef long RIGHT_CHILD = 3
  */
   __pyx_v_FEATURE_COL = 1;
 
-  /* "structureboost/structure_gb.pyx":898
+  /* "structureboost/structure_gb.pyx":896
  *     cdef long NODE_TYPE = 0
  *     cdef long FEATURE_COL = 1
  *     cdef long LEFT_CHILD = 2             # <<<<<<<<<<<<<<
  *     cdef long RIGHT_CHILD = 3
  *     cdef long NA_LEFT = 4
  */
   __pyx_v_LEFT_CHILD = 2;
 
-  /* "structureboost/structure_gb.pyx":899
+  /* "structureboost/structure_gb.pyx":897
  *     cdef long FEATURE_COL = 1
  *     cdef long LEFT_CHILD = 2
  *     cdef long RIGHT_CHILD = 3             # <<<<<<<<<<<<<<
  *     cdef long NA_LEFT = 4
  *     cdef long NUM_CAT_VALS = 5
  */
   __pyx_v_RIGHT_CHILD = 3;
 
-  /* "structureboost/structure_gb.pyx":900
+  /* "structureboost/structure_gb.pyx":898
  *     cdef long LEFT_CHILD = 2
  *     cdef long RIGHT_CHILD = 3
  *     cdef long NA_LEFT = 4             # <<<<<<<<<<<<<<
  *     cdef long NUM_CAT_VALS = 5
  *     cdef long CAT_VALS_START = 6
  */
   __pyx_v_NA_LEFT = 4;
 
-  /* "structureboost/structure_gb.pyx":901
+  /* "structureboost/structure_gb.pyx":899
  *     cdef long RIGHT_CHILD = 3
  *     cdef long NA_LEFT = 4
  *     cdef long NUM_CAT_VALS = 5             # <<<<<<<<<<<<<<
  *     cdef long CAT_VALS_START = 6
  *     # categorical values for left: 6 ... whatever
  */
   __pyx_v_NUM_CAT_VALS = 5;
 
-  /* "structureboost/structure_gb.pyx":902
+  /* "structureboost/structure_gb.pyx":900
  *     cdef long NA_LEFT = 4
  *     cdef long NUM_CAT_VALS = 5
  *     cdef long CAT_VALS_START = 6             # <<<<<<<<<<<<<<
  *     # categorical values for left: 6 ... whatever
  * 
  */
   __pyx_v_CAT_VALS_START = 6;
 
-  /* "structureboost/structure_gb.pyx":905
+  /* "structureboost/structure_gb.pyx":903
  *     # categorical values for left: 6 ... whatever
  * 
  *     cdef long LEAF = 0             # <<<<<<<<<<<<<<
  *     cdef long NUMER = 1
  *     cdef long CATEG = 2
  */
   __pyx_v_LEAF = 0;
 
-  /* "structureboost/structure_gb.pyx":906
+  /* "structureboost/structure_gb.pyx":904
  * 
  *     cdef long LEAF = 0
  *     cdef long NUMER = 1             # <<<<<<<<<<<<<<
  *     cdef long CATEG = 2
  * 
  */
   __pyx_v_NUMER = 1;
 
-  /* "structureboost/structure_gb.pyx":907
+  /* "structureboost/structure_gb.pyx":905
  *     cdef long LEAF = 0
  *     cdef long NUMER = 1
  *     cdef long CATEG = 2             # <<<<<<<<<<<<<<
  * 
  *     for k in range(dtm.shape[0]):
  */
   __pyx_v_CATEG = 2;
 
-  /* "structureboost/structure_gb.pyx":909
+  /* "structureboost/structure_gb.pyx":907
  *     cdef long CATEG = 2
  * 
  *     for k in range(dtm.shape[0]):             # <<<<<<<<<<<<<<
  *         for ri in range(feat_array.shape[0]):
  *             cn = 0
  */
   __pyx_t_8 = (__pyx_v_dtm->dimensions[0]);
   __pyx_t_9 = __pyx_t_8;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_k = __pyx_t_10;
 
-    /* "structureboost/structure_gb.pyx":910
+    /* "structureboost/structure_gb.pyx":908
  * 
  *     for k in range(dtm.shape[0]):
  *         for ri in range(feat_array.shape[0]):             # <<<<<<<<<<<<<<
  *             cn = 0
  *             at_leaf = 0
  */
     __pyx_t_11 = (__pyx_v_feat_array->dimensions[0]);
     __pyx_t_12 = __pyx_t_11;
     for (__pyx_t_13 = 0; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
       __pyx_v_ri = __pyx_t_13;
 
-      /* "structureboost/structure_gb.pyx":911
+      /* "structureboost/structure_gb.pyx":909
  *     for k in range(dtm.shape[0]):
  *         for ri in range(feat_array.shape[0]):
  *             cn = 0             # <<<<<<<<<<<<<<
  *             at_leaf = 0
  *             while not at_leaf:
  */
       __pyx_v_cn = 0;
 
-      /* "structureboost/structure_gb.pyx":912
+      /* "structureboost/structure_gb.pyx":910
  *         for ri in range(feat_array.shape[0]):
  *             cn = 0
  *             at_leaf = 0             # <<<<<<<<<<<<<<
  *             while not at_leaf:
  *                 cn = int(cn)
  */
       __pyx_v_at_leaf = 0;
 
-      /* "structureboost/structure_gb.pyx":913
+      /* "structureboost/structure_gb.pyx":911
  *             cn = 0
  *             at_leaf = 0
  *             while not at_leaf:             # <<<<<<<<<<<<<<
  *                 cn = int(cn)
  *                 if dtm[k,cn, NODE_TYPE]==LEAF:
  */
       while (1) {
         __pyx_t_14 = ((!(__pyx_v_at_leaf != 0)) != 0);
         if (!__pyx_t_14) break;
 
-        /* "structureboost/structure_gb.pyx":915
+        /* "structureboost/structure_gb.pyx":913
  *             while not at_leaf:
  *                 cn = int(cn)
  *                 if dtm[k,cn, NODE_TYPE]==LEAF:             # <<<<<<<<<<<<<<
  *                     at_leaf = 1
  *                     res_mat[ri,k] = dtm_float[k,cn, NODE_VALUE]
  */
         __pyx_t_15 = __pyx_v_k;
         __pyx_t_16 = __pyx_v_cn;
         __pyx_t_17 = __pyx_v_NODE_TYPE;
         __pyx_t_14 = (((*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[2].strides)) == __pyx_v_LEAF) != 0);
         if (__pyx_t_14) {
 
-          /* "structureboost/structure_gb.pyx":916
+          /* "structureboost/structure_gb.pyx":914
  *                 cn = int(cn)
  *                 if dtm[k,cn, NODE_TYPE]==LEAF:
  *                     at_leaf = 1             # <<<<<<<<<<<<<<
  *                     res_mat[ri,k] = dtm_float[k,cn, NODE_VALUE]
  *                 elif dtm[k,cn, NODE_TYPE]==NUMER:
  */
           __pyx_v_at_leaf = 1;
 
-          /* "structureboost/structure_gb.pyx":917
+          /* "structureboost/structure_gb.pyx":915
  *                 if dtm[k,cn, NODE_TYPE]==LEAF:
  *                     at_leaf = 1
  *                     res_mat[ri,k] = dtm_float[k,cn, NODE_VALUE]             # <<<<<<<<<<<<<<
  *                 elif dtm[k,cn, NODE_TYPE]==NUMER:
  *                     ind = dtm[k,cn, FEATURE_COL]
  */
           __pyx_t_17 = __pyx_v_k;
           __pyx_t_16 = __pyx_v_cn;
           __pyx_t_15 = __pyx_v_NODE_VALUE;
           __pyx_t_18 = __pyx_v_ri;
           __pyx_t_19 = __pyx_v_k;
           *__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_res_mat.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_res_mat.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_res_mat.diminfo[1].strides) = (*__Pyx_BufPtrStrided3d(double *, __pyx_pybuffernd_dtm_float.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_dtm_float.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_dtm_float.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_dtm_float.diminfo[2].strides));
 
-          /* "structureboost/structure_gb.pyx":915
+          /* "structureboost/structure_gb.pyx":913
  *             while not at_leaf:
  *                 cn = int(cn)
  *                 if dtm[k,cn, NODE_TYPE]==LEAF:             # <<<<<<<<<<<<<<
  *                     at_leaf = 1
  *                     res_mat[ri,k] = dtm_float[k,cn, NODE_VALUE]
  */
           goto __pyx_L9;
         }
 
-        /* "structureboost/structure_gb.pyx":918
+        /* "structureboost/structure_gb.pyx":916
  *                     at_leaf = 1
  *                     res_mat[ri,k] = dtm_float[k,cn, NODE_VALUE]
  *                 elif dtm[k,cn, NODE_TYPE]==NUMER:             # <<<<<<<<<<<<<<
  *                     ind = dtm[k,cn, FEATURE_COL]
  *                     if isnan_array[ri,ind]:
  */
         __pyx_t_15 = __pyx_v_k;
         __pyx_t_16 = __pyx_v_cn;
         __pyx_t_17 = __pyx_v_NODE_TYPE;
         __pyx_t_14 = (((*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[2].strides)) == __pyx_v_NUMER) != 0);
         if (__pyx_t_14) {
 
-          /* "structureboost/structure_gb.pyx":919
+          /* "structureboost/structure_gb.pyx":917
  *                     res_mat[ri,k] = dtm_float[k,cn, NODE_VALUE]
  *                 elif dtm[k,cn, NODE_TYPE]==NUMER:
  *                     ind = dtm[k,cn, FEATURE_COL]             # <<<<<<<<<<<<<<
  *                     if isnan_array[ri,ind]:
  *                         cn = dtm[k,cn, LEFT_CHILD] if dtm[k,cn, NA_LEFT] else dtm[k,cn, RIGHT_CHILD]
  */
           __pyx_t_17 = __pyx_v_k;
           __pyx_t_16 = __pyx_v_cn;
           __pyx_t_15 = __pyx_v_FEATURE_COL;
           __pyx_v_ind = (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[2].strides));
 
-          /* "structureboost/structure_gb.pyx":920
+          /* "structureboost/structure_gb.pyx":918
  *                 elif dtm[k,cn, NODE_TYPE]==NUMER:
  *                     ind = dtm[k,cn, FEATURE_COL]
  *                     if isnan_array[ri,ind]:             # <<<<<<<<<<<<<<
  *                         cn = dtm[k,cn, LEFT_CHILD] if dtm[k,cn, NA_LEFT] else dtm[k,cn, RIGHT_CHILD]
  *                     else:
  */
           __pyx_t_15 = __pyx_v_ri;
           __pyx_t_16 = __pyx_v_ind;
           __pyx_t_14 = ((*__Pyx_BufPtrStrided2d(long *, __pyx_pybuffernd_isnan_array.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_isnan_array.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_isnan_array.diminfo[1].strides)) != 0);
           if (__pyx_t_14) {
 
-            /* "structureboost/structure_gb.pyx":921
+            /* "structureboost/structure_gb.pyx":919
  *                     ind = dtm[k,cn, FEATURE_COL]
  *                     if isnan_array[ri,ind]:
  *                         cn = dtm[k,cn, LEFT_CHILD] if dtm[k,cn, NA_LEFT] else dtm[k,cn, RIGHT_CHILD]             # <<<<<<<<<<<<<<
  *                     else:
  *                         curr_val = feat_array[ri,ind]
  */
             __pyx_t_16 = __pyx_v_k;
@@ -21639,37 +21626,37 @@
               __pyx_t_21 = __pyx_v_k;
               __pyx_t_18 = __pyx_v_cn;
               __pyx_t_19 = __pyx_v_RIGHT_CHILD;
               __pyx_t_20 = (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_19, __pyx_pybuffernd_dtm.diminfo[2].strides));
             }
             __pyx_v_cn = __pyx_t_20;
 
-            /* "structureboost/structure_gb.pyx":920
+            /* "structureboost/structure_gb.pyx":918
  *                 elif dtm[k,cn, NODE_TYPE]==NUMER:
  *                     ind = dtm[k,cn, FEATURE_COL]
  *                     if isnan_array[ri,ind]:             # <<<<<<<<<<<<<<
  *                         cn = dtm[k,cn, LEFT_CHILD] if dtm[k,cn, NA_LEFT] else dtm[k,cn, RIGHT_CHILD]
  *                     else:
  */
             goto __pyx_L10;
           }
 
-          /* "structureboost/structure_gb.pyx":923
+          /* "structureboost/structure_gb.pyx":921
  *                         cn = dtm[k,cn, LEFT_CHILD] if dtm[k,cn, NA_LEFT] else dtm[k,cn, RIGHT_CHILD]
  *                     else:
  *                         curr_val = feat_array[ri,ind]             # <<<<<<<<<<<<<<
  *                         cn = dtm[k,cn, LEFT_CHILD] if curr_val<dtm_float[k,cn, THRESH] else dtm[k,cn, RIGHT_CHILD]
  *                 elif dtm[k,cn, NODE_TYPE]==CATEG:
  */
           /*else*/ {
             __pyx_t_17 = __pyx_v_ri;
             __pyx_t_15 = __pyx_v_ind;
             __pyx_v_curr_val = (*__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_feat_array.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_feat_array.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_feat_array.diminfo[1].strides));
 
-            /* "structureboost/structure_gb.pyx":924
+            /* "structureboost/structure_gb.pyx":922
  *                     else:
  *                         curr_val = feat_array[ri,ind]
  *                         cn = dtm[k,cn, LEFT_CHILD] if curr_val<dtm_float[k,cn, THRESH] else dtm[k,cn, RIGHT_CHILD]             # <<<<<<<<<<<<<<
  *                 elif dtm[k,cn, NODE_TYPE]==CATEG:
  *                     curr_val = feat_array[ri,dtm[k,cn, FEATURE_COL]]
  */
             __pyx_t_15 = __pyx_v_k;
@@ -21686,138 +21673,138 @@
               __pyx_t_19 = __pyx_v_RIGHT_CHILD;
               __pyx_t_20 = (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_19, __pyx_pybuffernd_dtm.diminfo[2].strides));
             }
             __pyx_v_cn = __pyx_t_20;
           }
           __pyx_L10:;
 
-          /* "structureboost/structure_gb.pyx":918
+          /* "structureboost/structure_gb.pyx":916
  *                     at_leaf = 1
  *                     res_mat[ri,k] = dtm_float[k,cn, NODE_VALUE]
  *                 elif dtm[k,cn, NODE_TYPE]==NUMER:             # <<<<<<<<<<<<<<
  *                     ind = dtm[k,cn, FEATURE_COL]
  *                     if isnan_array[ri,ind]:
  */
           goto __pyx_L9;
         }
 
-        /* "structureboost/structure_gb.pyx":925
+        /* "structureboost/structure_gb.pyx":923
  *                         curr_val = feat_array[ri,ind]
  *                         cn = dtm[k,cn, LEFT_CHILD] if curr_val<dtm_float[k,cn, THRESH] else dtm[k,cn, RIGHT_CHILD]
  *                 elif dtm[k,cn, NODE_TYPE]==CATEG:             # <<<<<<<<<<<<<<
  *                     curr_val = feat_array[ri,dtm[k,cn, FEATURE_COL]]
  *                     found_val = 0
  */
         __pyx_t_16 = __pyx_v_k;
         __pyx_t_17 = __pyx_v_cn;
         __pyx_t_15 = __pyx_v_NODE_TYPE;
         __pyx_t_14 = (((*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[2].strides)) == __pyx_v_CATEG) != 0);
         if (__pyx_t_14) {
 
-          /* "structureboost/structure_gb.pyx":926
+          /* "structureboost/structure_gb.pyx":924
  *                         cn = dtm[k,cn, LEFT_CHILD] if curr_val<dtm_float[k,cn, THRESH] else dtm[k,cn, RIGHT_CHILD]
  *                 elif dtm[k,cn, NODE_TYPE]==CATEG:
  *                     curr_val = feat_array[ri,dtm[k,cn, FEATURE_COL]]             # <<<<<<<<<<<<<<
  *                     found_val = 0
  *                     j = CAT_VALS_START
  */
           __pyx_t_15 = __pyx_v_k;
           __pyx_t_17 = __pyx_v_cn;
           __pyx_t_16 = __pyx_v_FEATURE_COL;
           __pyx_t_19 = __pyx_v_ri;
           __pyx_t_18 = (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[2].strides));
           __pyx_v_curr_val = (*__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_feat_array.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_feat_array.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_feat_array.diminfo[1].strides));
 
-          /* "structureboost/structure_gb.pyx":927
+          /* "structureboost/structure_gb.pyx":925
  *                 elif dtm[k,cn, NODE_TYPE]==CATEG:
  *                     curr_val = feat_array[ri,dtm[k,cn, FEATURE_COL]]
  *                     found_val = 0             # <<<<<<<<<<<<<<
  *                     j = CAT_VALS_START
  *                     cat_vals_end = CAT_VALS_START + dtm[k, cn, NUM_CAT_VALS]
  */
           __pyx_v_found_val = 0;
 
-          /* "structureboost/structure_gb.pyx":928
+          /* "structureboost/structure_gb.pyx":926
  *                     curr_val = feat_array[ri,dtm[k,cn, FEATURE_COL]]
  *                     found_val = 0
  *                     j = CAT_VALS_START             # <<<<<<<<<<<<<<
  *                     cat_vals_end = CAT_VALS_START + dtm[k, cn, NUM_CAT_VALS]
  *                     while ((not found_val) & (j<cat_vals_end)):
  */
           __pyx_v_j = __pyx_v_CAT_VALS_START;
 
-          /* "structureboost/structure_gb.pyx":929
+          /* "structureboost/structure_gb.pyx":927
  *                     found_val = 0
  *                     j = CAT_VALS_START
  *                     cat_vals_end = CAT_VALS_START + dtm[k, cn, NUM_CAT_VALS]             # <<<<<<<<<<<<<<
  *                     while ((not found_val) & (j<cat_vals_end)):
  *                         if curr_val==dtm[k,cn, j]:
  */
           __pyx_t_16 = __pyx_v_k;
           __pyx_t_17 = __pyx_v_cn;
           __pyx_t_15 = __pyx_v_NUM_CAT_VALS;
           __pyx_v_cat_vals_end = (__pyx_v_CAT_VALS_START + (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[2].strides)));
 
-          /* "structureboost/structure_gb.pyx":930
+          /* "structureboost/structure_gb.pyx":928
  *                     j = CAT_VALS_START
  *                     cat_vals_end = CAT_VALS_START + dtm[k, cn, NUM_CAT_VALS]
  *                     while ((not found_val) & (j<cat_vals_end)):             # <<<<<<<<<<<<<<
  *                         if curr_val==dtm[k,cn, j]:
  *                             found_val=1
  */
           while (1) {
             __pyx_t_14 = (((!(__pyx_v_found_val != 0)) & (__pyx_v_j < __pyx_v_cat_vals_end)) != 0);
             if (!__pyx_t_14) break;
 
-            /* "structureboost/structure_gb.pyx":931
+            /* "structureboost/structure_gb.pyx":929
  *                     cat_vals_end = CAT_VALS_START + dtm[k, cn, NUM_CAT_VALS]
  *                     while ((not found_val) & (j<cat_vals_end)):
  *                         if curr_val==dtm[k,cn, j]:             # <<<<<<<<<<<<<<
  *                             found_val=1
  *                         else:
  */
             __pyx_t_15 = __pyx_v_k;
             __pyx_t_17 = __pyx_v_cn;
             __pyx_t_16 = __pyx_v_j;
             __pyx_t_14 = ((__pyx_v_curr_val == (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[2].strides))) != 0);
             if (__pyx_t_14) {
 
-              /* "structureboost/structure_gb.pyx":932
+              /* "structureboost/structure_gb.pyx":930
  *                     while ((not found_val) & (j<cat_vals_end)):
  *                         if curr_val==dtm[k,cn, j]:
  *                             found_val=1             # <<<<<<<<<<<<<<
  *                         else:
  *                             j+=1
  */
               __pyx_v_found_val = 1;
 
-              /* "structureboost/structure_gb.pyx":931
+              /* "structureboost/structure_gb.pyx":929
  *                     cat_vals_end = CAT_VALS_START + dtm[k, cn, NUM_CAT_VALS]
  *                     while ((not found_val) & (j<cat_vals_end)):
  *                         if curr_val==dtm[k,cn, j]:             # <<<<<<<<<<<<<<
  *                             found_val=1
  *                         else:
  */
               goto __pyx_L13;
             }
 
-            /* "structureboost/structure_gb.pyx":934
+            /* "structureboost/structure_gb.pyx":932
  *                             found_val=1
  *                         else:
  *                             j+=1             # <<<<<<<<<<<<<<
  *                     cn = dtm[k,cn, LEFT_CHILD] if found_val else dtm[k,cn, RIGHT_CHILD]
  *     return(res_mat)
  */
             /*else*/ {
               __pyx_v_j = (__pyx_v_j + 1);
             }
             __pyx_L13:;
           }
 
-          /* "structureboost/structure_gb.pyx":935
+          /* "structureboost/structure_gb.pyx":933
  *                         else:
  *                             j+=1
  *                     cn = dtm[k,cn, LEFT_CHILD] if found_val else dtm[k,cn, RIGHT_CHILD]             # <<<<<<<<<<<<<<
  *     return(res_mat)
  * 
  */
           if ((__pyx_v_found_val != 0)) {
@@ -21829,40 +21816,40 @@
             __pyx_t_15 = __pyx_v_k;
             __pyx_t_17 = __pyx_v_cn;
             __pyx_t_16 = __pyx_v_RIGHT_CHILD;
             __pyx_t_20 = (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[2].strides));
           }
           __pyx_v_cn = __pyx_t_20;
 
-          /* "structureboost/structure_gb.pyx":925
+          /* "structureboost/structure_gb.pyx":923
  *                         curr_val = feat_array[ri,ind]
  *                         cn = dtm[k,cn, LEFT_CHILD] if curr_val<dtm_float[k,cn, THRESH] else dtm[k,cn, RIGHT_CHILD]
  *                 elif dtm[k,cn, NODE_TYPE]==CATEG:             # <<<<<<<<<<<<<<
  *                     curr_val = feat_array[ri,dtm[k,cn, FEATURE_COL]]
  *                     found_val = 0
  */
         }
         __pyx_L9:;
       }
     }
   }
 
-  /* "structureboost/structure_gb.pyx":936
+  /* "structureboost/structure_gb.pyx":934
  *                             j+=1
  *                     cn = dtm[k,cn, LEFT_CHILD] if found_val else dtm[k,cn, RIGHT_CHILD]
  *     return(res_mat)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_res_mat));
   __pyx_r = ((PyObject *)__pyx_v_res_mat);
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":879
+  /* "structureboost/structure_gb.pyx":877
  * @cython.boundscheck(False)
  * @cython.wraparound(False)
  * def predict_with_tensor_c(np.ndarray[double, ndim=3] dtm_float,             # <<<<<<<<<<<<<<
  *                       np.ndarray[long, ndim=3] dtm,
  *                       np.ndarray[double, ndim=2] feat_array):
  */
 
@@ -21897,18 +21884,18 @@
   __Pyx_XDECREF((PyObject *)__pyx_v_isnan_array);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":948
+/* "structureboost/structure_gb.pyx":946
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * @cython.cdivision(True)
- * cdef extend_path(np.ndarray[dtype_int64_t] feature_indexes,             # <<<<<<<<<<<<<<
+ * cdef extend_path(np.ndarray[long] feature_indexes,             # <<<<<<<<<<<<<<
  *                 np.ndarray[double] zero_fractions,
  *                 np.ndarray[double] one_fractions,
  */
 
 static PyObject *__pyx_f_14structureboost_12structure_gb_extend_path(PyArrayObject *__pyx_v_feature_indexes, PyArrayObject *__pyx_v_zero_fractions, PyArrayObject *__pyx_v_one_fractions, PyArrayObject *__pyx_v_pweights, long __pyx_v_unique_depth, double __pyx_v_zero_fraction, double __pyx_v_one_fraction, long __pyx_v_feature_index) {
   long __pyx_v_i;
   __Pyx_LocalBuf_ND __pyx_pybuffernd_feature_indexes;
@@ -21926,15 +21913,15 @@
   int __pyx_t_2;
   long __pyx_t_3;
   Py_ssize_t __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("extend_path", 0);
-  __Pyx_TraceCall("extend_path", __pyx_f[0], 948, 0, __PYX_ERR(0, 948, __pyx_L1_error));
+  __Pyx_TraceCall("extend_path", __pyx_f[0], 946, 0, __PYX_ERR(0, 946, __pyx_L1_error));
   __pyx_pybuffer_feature_indexes.pybuffer.buf = NULL;
   __pyx_pybuffer_feature_indexes.refcount = 0;
   __pyx_pybuffernd_feature_indexes.data = NULL;
   __pyx_pybuffernd_feature_indexes.rcbuffer = &__pyx_pybuffer_feature_indexes;
   __pyx_pybuffer_zero_fractions.pybuffer.buf = NULL;
   __pyx_pybuffer_zero_fractions.refcount = 0;
   __pyx_pybuffernd_zero_fractions.data = NULL;
@@ -21945,143 +21932,143 @@
   __pyx_pybuffernd_one_fractions.rcbuffer = &__pyx_pybuffer_one_fractions;
   __pyx_pybuffer_pweights.pybuffer.buf = NULL;
   __pyx_pybuffer_pweights.refcount = 0;
   __pyx_pybuffernd_pweights.data = NULL;
   __pyx_pybuffernd_pweights.rcbuffer = &__pyx_pybuffer_pweights;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer, (PyObject*)__pyx_v_feature_indexes, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_gb_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 948, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer, (PyObject*)__pyx_v_feature_indexes, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 946, __pyx_L1_error)
   }
   __pyx_pybuffernd_feature_indexes.diminfo[0].strides = __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_feature_indexes.diminfo[0].shape = __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_v_zero_fractions, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 948, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_v_zero_fractions, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 946, __pyx_L1_error)
   }
   __pyx_pybuffernd_zero_fractions.diminfo[0].strides = __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_zero_fractions.diminfo[0].shape = __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_one_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_v_one_fractions, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 948, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_one_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_v_one_fractions, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 946, __pyx_L1_error)
   }
   __pyx_pybuffernd_one_fractions.diminfo[0].strides = __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_one_fractions.diminfo[0].shape = __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_pweights.rcbuffer->pybuffer, (PyObject*)__pyx_v_pweights, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 948, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_pweights.rcbuffer->pybuffer, (PyObject*)__pyx_v_pweights, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 946, __pyx_L1_error)
   }
   __pyx_pybuffernd_pweights.diminfo[0].strides = __pyx_pybuffernd_pweights.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_pweights.diminfo[0].shape = __pyx_pybuffernd_pweights.rcbuffer->pybuffer.shape[0];
 
-  /* "structureboost/structure_gb.pyx":957
+  /* "structureboost/structure_gb.pyx":955
  *     cdef long i
  * 
  *     feature_indexes[unique_depth] = feature_index             # <<<<<<<<<<<<<<
  *     zero_fractions[unique_depth] = zero_fraction
  *     one_fractions[unique_depth] = one_fraction
  */
   __pyx_t_1 = __pyx_v_unique_depth;
-  *__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_feature_indexes.diminfo[0].strides) = __pyx_v_feature_index;
+  *__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_feature_indexes.diminfo[0].strides) = __pyx_v_feature_index;
 
-  /* "structureboost/structure_gb.pyx":958
+  /* "structureboost/structure_gb.pyx":956
  * 
  *     feature_indexes[unique_depth] = feature_index
  *     zero_fractions[unique_depth] = zero_fraction             # <<<<<<<<<<<<<<
  *     one_fractions[unique_depth] = one_fraction
  *     if unique_depth == 0:
  */
   __pyx_t_1 = __pyx_v_unique_depth;
   *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_zero_fractions.diminfo[0].strides) = __pyx_v_zero_fraction;
 
-  /* "structureboost/structure_gb.pyx":959
+  /* "structureboost/structure_gb.pyx":957
  *     feature_indexes[unique_depth] = feature_index
  *     zero_fractions[unique_depth] = zero_fraction
  *     one_fractions[unique_depth] = one_fraction             # <<<<<<<<<<<<<<
  *     if unique_depth == 0:
  *         pweights[unique_depth] = 1
  */
   __pyx_t_1 = __pyx_v_unique_depth;
   *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_one_fractions.diminfo[0].strides) = __pyx_v_one_fraction;
 
-  /* "structureboost/structure_gb.pyx":960
+  /* "structureboost/structure_gb.pyx":958
  *     zero_fractions[unique_depth] = zero_fraction
  *     one_fractions[unique_depth] = one_fraction
  *     if unique_depth == 0:             # <<<<<<<<<<<<<<
  *         pweights[unique_depth] = 1
  *     else:
  */
   __pyx_t_2 = ((__pyx_v_unique_depth == 0) != 0);
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_gb.pyx":961
+    /* "structureboost/structure_gb.pyx":959
  *     one_fractions[unique_depth] = one_fraction
  *     if unique_depth == 0:
  *         pweights[unique_depth] = 1             # <<<<<<<<<<<<<<
  *     else:
  *         pweights[unique_depth] = 0
  */
     __pyx_t_1 = __pyx_v_unique_depth;
     *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_pweights.diminfo[0].strides) = 1.0;
 
-    /* "structureboost/structure_gb.pyx":960
+    /* "structureboost/structure_gb.pyx":958
  *     zero_fractions[unique_depth] = zero_fraction
  *     one_fractions[unique_depth] = one_fraction
  *     if unique_depth == 0:             # <<<<<<<<<<<<<<
  *         pweights[unique_depth] = 1
  *     else:
  */
     goto __pyx_L3;
   }
 
-  /* "structureboost/structure_gb.pyx":963
+  /* "structureboost/structure_gb.pyx":961
  *         pweights[unique_depth] = 1
  *     else:
  *         pweights[unique_depth] = 0             # <<<<<<<<<<<<<<
  * 
  *     for i in range(unique_depth - 1, -1, -1):
  */
   /*else*/ {
     __pyx_t_1 = __pyx_v_unique_depth;
     *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_pweights.diminfo[0].strides) = 0.0;
   }
   __pyx_L3:;
 
-  /* "structureboost/structure_gb.pyx":965
+  /* "structureboost/structure_gb.pyx":963
  *         pweights[unique_depth] = 0
  * 
  *     for i in range(unique_depth - 1, -1, -1):             # <<<<<<<<<<<<<<
  *         pweights[i+1] += one_fraction * pweights[i] * (i + 1) / (unique_depth + 1)
  *         pweights[i] = zero_fraction * pweights[i] * (unique_depth - i) / (unique_depth + 1)
  */
   for (__pyx_t_3 = (__pyx_v_unique_depth - 1); __pyx_t_3 > -1L; __pyx_t_3-=1) {
     __pyx_v_i = __pyx_t_3;
 
-    /* "structureboost/structure_gb.pyx":966
+    /* "structureboost/structure_gb.pyx":964
  * 
  *     for i in range(unique_depth - 1, -1, -1):
  *         pweights[i+1] += one_fraction * pweights[i] * (i + 1) / (unique_depth + 1)             # <<<<<<<<<<<<<<
  *         pweights[i] = zero_fraction * pweights[i] * (unique_depth - i) / (unique_depth + 1)
  * 
  */
     __pyx_t_1 = __pyx_v_i;
     __pyx_t_4 = (__pyx_v_i + 1);
     *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_pweights.diminfo[0].strides) += (((__pyx_v_one_fraction * (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_pweights.diminfo[0].strides))) * (__pyx_v_i + 1)) / ((double)(__pyx_v_unique_depth + 1)));
 
-    /* "structureboost/structure_gb.pyx":967
+    /* "structureboost/structure_gb.pyx":965
  *     for i in range(unique_depth - 1, -1, -1):
  *         pweights[i+1] += one_fraction * pweights[i] * (i + 1) / (unique_depth + 1)
  *         pweights[i] = zero_fraction * pweights[i] * (unique_depth - i) / (unique_depth + 1)             # <<<<<<<<<<<<<<
  * 
  * # undo a previous extension of the decision path
  */
     __pyx_t_1 = __pyx_v_i;
     __pyx_t_4 = __pyx_v_i;
     *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_pweights.diminfo[0].strides) = (((__pyx_v_zero_fraction * (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_pweights.diminfo[0].strides))) * (__pyx_v_unique_depth - __pyx_v_i)) / ((double)(__pyx_v_unique_depth + 1)));
   }
 
-  /* "structureboost/structure_gb.pyx":948
+  /* "structureboost/structure_gb.pyx":946
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * @cython.cdivision(True)
- * cdef extend_path(np.ndarray[dtype_int64_t] feature_indexes,             # <<<<<<<<<<<<<<
+ * cdef extend_path(np.ndarray[long] feature_indexes,             # <<<<<<<<<<<<<<
  *                 np.ndarray[double] zero_fractions,
  *                 np.ndarray[double] one_fractions,
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
@@ -22106,18 +22093,18 @@
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":974
+/* "structureboost/structure_gb.pyx":972
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * @cython.cdivision(True)
- * cdef unwind_path(np.ndarray[dtype_int64_t] feature_indexes,             # <<<<<<<<<<<<<<
+ * cdef unwind_path(np.ndarray[long] feature_indexes,             # <<<<<<<<<<<<<<
  *                 np.ndarray[double] zero_fractions,
  *                 np.ndarray[double] one_fractions,
  */
 
 static PyObject *__pyx_f_14structureboost_12structure_gb_unwind_path(PyArrayObject *__pyx_v_feature_indexes, PyArrayObject *__pyx_v_zero_fractions, PyArrayObject *__pyx_v_one_fractions, PyArrayObject *__pyx_v_pweights, long __pyx_v_unique_depth, long __pyx_v_path_index) {
   double __pyx_v_one_fraction;
   double __pyx_v_zero_fraction;
@@ -22141,15 +22128,15 @@
   Py_ssize_t __pyx_t_4;
   long __pyx_t_5;
   long __pyx_t_6;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("unwind_path", 0);
-  __Pyx_TraceCall("unwind_path", __pyx_f[0], 974, 0, __PYX_ERR(0, 974, __pyx_L1_error));
+  __Pyx_TraceCall("unwind_path", __pyx_f[0], 972, 0, __PYX_ERR(0, 972, __pyx_L1_error));
   __pyx_pybuffer_feature_indexes.pybuffer.buf = NULL;
   __pyx_pybuffer_feature_indexes.refcount = 0;
   __pyx_pybuffernd_feature_indexes.data = NULL;
   __pyx_pybuffernd_feature_indexes.rcbuffer = &__pyx_pybuffer_feature_indexes;
   __pyx_pybuffer_zero_fractions.pybuffer.buf = NULL;
   __pyx_pybuffer_zero_fractions.refcount = 0;
   __pyx_pybuffernd_zero_fractions.data = NULL;
@@ -22160,188 +22147,188 @@
   __pyx_pybuffernd_one_fractions.rcbuffer = &__pyx_pybuffer_one_fractions;
   __pyx_pybuffer_pweights.pybuffer.buf = NULL;
   __pyx_pybuffer_pweights.refcount = 0;
   __pyx_pybuffernd_pweights.data = NULL;
   __pyx_pybuffernd_pweights.rcbuffer = &__pyx_pybuffer_pweights;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer, (PyObject*)__pyx_v_feature_indexes, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_gb_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 974, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer, (PyObject*)__pyx_v_feature_indexes, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 972, __pyx_L1_error)
   }
   __pyx_pybuffernd_feature_indexes.diminfo[0].strides = __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_feature_indexes.diminfo[0].shape = __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_v_zero_fractions, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 974, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_v_zero_fractions, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 972, __pyx_L1_error)
   }
   __pyx_pybuffernd_zero_fractions.diminfo[0].strides = __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_zero_fractions.diminfo[0].shape = __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_one_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_v_one_fractions, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 974, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_one_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_v_one_fractions, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 972, __pyx_L1_error)
   }
   __pyx_pybuffernd_one_fractions.diminfo[0].strides = __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_one_fractions.diminfo[0].shape = __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_pweights.rcbuffer->pybuffer, (PyObject*)__pyx_v_pweights, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 974, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_pweights.rcbuffer->pybuffer, (PyObject*)__pyx_v_pweights, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 972, __pyx_L1_error)
   }
   __pyx_pybuffernd_pweights.diminfo[0].strides = __pyx_pybuffernd_pweights.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_pweights.diminfo[0].shape = __pyx_pybuffernd_pweights.rcbuffer->pybuffer.shape[0];
 
-  /* "structureboost/structure_gb.pyx":983
+  /* "structureboost/structure_gb.pyx":981
  *     cdef long i
  * 
  *     one_fraction = one_fractions[path_index]             # <<<<<<<<<<<<<<
  *     zero_fraction = zero_fractions[path_index]
  *     next_one_portion = pweights[unique_depth]
  */
   __pyx_t_1 = __pyx_v_path_index;
   __pyx_v_one_fraction = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_one_fractions.diminfo[0].strides));
 
-  /* "structureboost/structure_gb.pyx":984
+  /* "structureboost/structure_gb.pyx":982
  * 
  *     one_fraction = one_fractions[path_index]
  *     zero_fraction = zero_fractions[path_index]             # <<<<<<<<<<<<<<
  *     next_one_portion = pweights[unique_depth]
  * 
  */
   __pyx_t_1 = __pyx_v_path_index;
   __pyx_v_zero_fraction = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_zero_fractions.diminfo[0].strides));
 
-  /* "structureboost/structure_gb.pyx":985
+  /* "structureboost/structure_gb.pyx":983
  *     one_fraction = one_fractions[path_index]
  *     zero_fraction = zero_fractions[path_index]
  *     next_one_portion = pweights[unique_depth]             # <<<<<<<<<<<<<<
  * 
  *     for i in range(unique_depth - 1, -1, -1):
  */
   __pyx_t_1 = __pyx_v_unique_depth;
   __pyx_v_next_one_portion = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_pweights.diminfo[0].strides));
 
-  /* "structureboost/structure_gb.pyx":987
+  /* "structureboost/structure_gb.pyx":985
  *     next_one_portion = pweights[unique_depth]
  * 
  *     for i in range(unique_depth - 1, -1, -1):             # <<<<<<<<<<<<<<
  *         if one_fraction != 0:
  *             tmp = pweights[i]
  */
   for (__pyx_t_2 = (__pyx_v_unique_depth - 1); __pyx_t_2 > -1L; __pyx_t_2-=1) {
     __pyx_v_i = __pyx_t_2;
 
-    /* "structureboost/structure_gb.pyx":988
+    /* "structureboost/structure_gb.pyx":986
  * 
  *     for i in range(unique_depth - 1, -1, -1):
  *         if one_fraction != 0:             # <<<<<<<<<<<<<<
  *             tmp = pweights[i]
  *             pweights[i] = next_one_portion * (unique_depth + 1) / ((i + 1) * one_fraction)
  */
     __pyx_t_3 = ((__pyx_v_one_fraction != 0.0) != 0);
     if (__pyx_t_3) {
 
-      /* "structureboost/structure_gb.pyx":989
+      /* "structureboost/structure_gb.pyx":987
  *     for i in range(unique_depth - 1, -1, -1):
  *         if one_fraction != 0:
  *             tmp = pweights[i]             # <<<<<<<<<<<<<<
  *             pweights[i] = next_one_portion * (unique_depth + 1) / ((i + 1) * one_fraction)
  *             next_one_portion = tmp - pweights[i] * zero_fraction * (unique_depth - i) / (unique_depth + 1)
  */
       __pyx_t_1 = __pyx_v_i;
       __pyx_v_tmp = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_pweights.diminfo[0].strides));
 
-      /* "structureboost/structure_gb.pyx":990
+      /* "structureboost/structure_gb.pyx":988
  *         if one_fraction != 0:
  *             tmp = pweights[i]
  *             pweights[i] = next_one_portion * (unique_depth + 1) / ((i + 1) * one_fraction)             # <<<<<<<<<<<<<<
  *             next_one_portion = tmp - pweights[i] * zero_fraction * (unique_depth - i) / (unique_depth + 1)
  *         else:
  */
       __pyx_t_1 = __pyx_v_i;
       *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_pweights.diminfo[0].strides) = ((__pyx_v_next_one_portion * (__pyx_v_unique_depth + 1)) / ((__pyx_v_i + 1) * __pyx_v_one_fraction));
 
-      /* "structureboost/structure_gb.pyx":991
+      /* "structureboost/structure_gb.pyx":989
  *             tmp = pweights[i]
  *             pweights[i] = next_one_portion * (unique_depth + 1) / ((i + 1) * one_fraction)
  *             next_one_portion = tmp - pweights[i] * zero_fraction * (unique_depth - i) / (unique_depth + 1)             # <<<<<<<<<<<<<<
  *         else:
  *             pweights[i] = (pweights[i] * (unique_depth + 1)) / (zero_fraction * (unique_depth - i))
  */
       __pyx_t_1 = __pyx_v_i;
       __pyx_v_next_one_portion = (__pyx_v_tmp - ((((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_pweights.diminfo[0].strides)) * __pyx_v_zero_fraction) * (__pyx_v_unique_depth - __pyx_v_i)) / ((double)(__pyx_v_unique_depth + 1))));
 
-      /* "structureboost/structure_gb.pyx":988
+      /* "structureboost/structure_gb.pyx":986
  * 
  *     for i in range(unique_depth - 1, -1, -1):
  *         if one_fraction != 0:             # <<<<<<<<<<<<<<
  *             tmp = pweights[i]
  *             pweights[i] = next_one_portion * (unique_depth + 1) / ((i + 1) * one_fraction)
  */
       goto __pyx_L5;
     }
 
-    /* "structureboost/structure_gb.pyx":993
+    /* "structureboost/structure_gb.pyx":991
  *             next_one_portion = tmp - pweights[i] * zero_fraction * (unique_depth - i) / (unique_depth + 1)
  *         else:
  *             pweights[i] = (pweights[i] * (unique_depth + 1)) / (zero_fraction * (unique_depth - i))             # <<<<<<<<<<<<<<
  * 
  *     for i in range(path_index, unique_depth):
  */
     /*else*/ {
       __pyx_t_1 = __pyx_v_i;
       __pyx_t_4 = __pyx_v_i;
       *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_pweights.diminfo[0].strides) = (((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_pweights.diminfo[0].strides)) * (__pyx_v_unique_depth + 1)) / (__pyx_v_zero_fraction * (__pyx_v_unique_depth - __pyx_v_i)));
     }
     __pyx_L5:;
   }
 
-  /* "structureboost/structure_gb.pyx":995
+  /* "structureboost/structure_gb.pyx":993
  *             pweights[i] = (pweights[i] * (unique_depth + 1)) / (zero_fraction * (unique_depth - i))
  * 
  *     for i in range(path_index, unique_depth):             # <<<<<<<<<<<<<<
  *         feature_indexes[i] = feature_indexes[i+1]
  *         zero_fractions[i] = zero_fractions[i+1]
  */
   __pyx_t_2 = __pyx_v_unique_depth;
   __pyx_t_5 = __pyx_t_2;
   for (__pyx_t_6 = __pyx_v_path_index; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
     __pyx_v_i = __pyx_t_6;
 
-    /* "structureboost/structure_gb.pyx":996
+    /* "structureboost/structure_gb.pyx":994
  * 
  *     for i in range(path_index, unique_depth):
  *         feature_indexes[i] = feature_indexes[i+1]             # <<<<<<<<<<<<<<
  *         zero_fractions[i] = zero_fractions[i+1]
  *         one_fractions[i] = one_fractions[i+1]
  */
     __pyx_t_1 = (__pyx_v_i + 1);
     __pyx_t_4 = __pyx_v_i;
-    *__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_feature_indexes.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_feature_indexes.diminfo[0].strides));
+    *__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_feature_indexes.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_feature_indexes.diminfo[0].strides));
 
-    /* "structureboost/structure_gb.pyx":997
+    /* "structureboost/structure_gb.pyx":995
  *     for i in range(path_index, unique_depth):
  *         feature_indexes[i] = feature_indexes[i+1]
  *         zero_fractions[i] = zero_fractions[i+1]             # <<<<<<<<<<<<<<
  *         one_fractions[i] = one_fractions[i+1]
  * 
  */
     __pyx_t_1 = (__pyx_v_i + 1);
     __pyx_t_4 = __pyx_v_i;
     *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_zero_fractions.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_zero_fractions.diminfo[0].strides));
 
-    /* "structureboost/structure_gb.pyx":998
+    /* "structureboost/structure_gb.pyx":996
  *         feature_indexes[i] = feature_indexes[i+1]
  *         zero_fractions[i] = zero_fractions[i+1]
  *         one_fractions[i] = one_fractions[i+1]             # <<<<<<<<<<<<<<
  * 
  * # determine what the total permuation weight would be if
  */
     __pyx_t_1 = (__pyx_v_i + 1);
     __pyx_t_4 = __pyx_v_i;
     *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_one_fractions.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_one_fractions.diminfo[0].strides));
   }
 
-  /* "structureboost/structure_gb.pyx":974
+  /* "structureboost/structure_gb.pyx":972
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * @cython.cdivision(True)
- * cdef unwind_path(np.ndarray[dtype_int64_t] feature_indexes,             # <<<<<<<<<<<<<<
+ * cdef unwind_path(np.ndarray[long] feature_indexes,             # <<<<<<<<<<<<<<
  *                 np.ndarray[double] zero_fractions,
  *                 np.ndarray[double] one_fractions,
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
@@ -22366,18 +22353,18 @@
   __pyx_L2:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":1004
+/* "structureboost/structure_gb.pyx":1002
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * cdef double unwound_path_sum(np.ndarray[dtype_int64_t] feature_indexes,             # <<<<<<<<<<<<<<
+ * cdef double unwound_path_sum(np.ndarray[long] feature_indexes,             # <<<<<<<<<<<<<<
  *                      np.ndarray[double] zero_fractions,
  *                      np.ndarray[double] one_fractions,
  */
 
 static double __pyx_f_14structureboost_12structure_gb_unwound_path_sum(CYTHON_UNUSED PyArrayObject *__pyx_v_feature_indexes, PyArrayObject *__pyx_v_zero_fractions, PyArrayObject *__pyx_v_one_fractions, PyArrayObject *__pyx_v_pweights, long __pyx_v_unique_depth, long __pyx_v_path_index) {
   double __pyx_v_one_fraction;
   double __pyx_v_zero_fraction;
@@ -22404,15 +22391,15 @@
   long __pyx_t_6;
   long __pyx_t_7;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("unwound_path_sum", 0);
-  __Pyx_TraceCall("unwound_path_sum", __pyx_f[0], 1004, 0, __PYX_ERR(0, 1004, __pyx_L1_error));
+  __Pyx_TraceCall("unwound_path_sum", __pyx_f[0], 1002, 0, __PYX_ERR(0, 1002, __pyx_L1_error));
   __pyx_pybuffer_feature_indexes.pybuffer.buf = NULL;
   __pyx_pybuffer_feature_indexes.refcount = 0;
   __pyx_pybuffernd_feature_indexes.data = NULL;
   __pyx_pybuffernd_feature_indexes.rcbuffer = &__pyx_pybuffer_feature_indexes;
   __pyx_pybuffer_zero_fractions.pybuffer.buf = NULL;
   __pyx_pybuffer_zero_fractions.refcount = 0;
   __pyx_pybuffernd_zero_fractions.data = NULL;
@@ -22423,221 +22410,221 @@
   __pyx_pybuffernd_one_fractions.rcbuffer = &__pyx_pybuffer_one_fractions;
   __pyx_pybuffer_pweights.pybuffer.buf = NULL;
   __pyx_pybuffer_pweights.refcount = 0;
   __pyx_pybuffernd_pweights.data = NULL;
   __pyx_pybuffernd_pweights.rcbuffer = &__pyx_pybuffer_pweights;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer, (PyObject*)__pyx_v_feature_indexes, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_gb_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1004, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer, (PyObject*)__pyx_v_feature_indexes, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1002, __pyx_L1_error)
   }
   __pyx_pybuffernd_feature_indexes.diminfo[0].strides = __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_feature_indexes.diminfo[0].shape = __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_v_zero_fractions, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1004, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_v_zero_fractions, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1002, __pyx_L1_error)
   }
   __pyx_pybuffernd_zero_fractions.diminfo[0].strides = __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_zero_fractions.diminfo[0].shape = __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_one_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_v_one_fractions, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1004, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_one_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_v_one_fractions, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1002, __pyx_L1_error)
   }
   __pyx_pybuffernd_one_fractions.diminfo[0].strides = __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_one_fractions.diminfo[0].shape = __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_pweights.rcbuffer->pybuffer, (PyObject*)__pyx_v_pweights, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1004, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_pweights.rcbuffer->pybuffer, (PyObject*)__pyx_v_pweights, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1002, __pyx_L1_error)
   }
   __pyx_pybuffernd_pweights.diminfo[0].strides = __pyx_pybuffernd_pweights.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_pweights.diminfo[0].shape = __pyx_pybuffernd_pweights.rcbuffer->pybuffer.shape[0];
 
-  /* "structureboost/structure_gb.pyx":1010
+  /* "structureboost/structure_gb.pyx":1008
  *                      long unique_depth,
  *                      long path_index):
  *     cdef double one_fraction = one_fractions[path_index]             # <<<<<<<<<<<<<<
  *     cdef double zero_fraction = zero_fractions[path_index]
  *     cdef double next_one_portion = pweights[unique_depth]
  */
   __pyx_t_1 = __pyx_v_path_index;
   __pyx_v_one_fraction = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_one_fractions.diminfo[0].strides));
 
-  /* "structureboost/structure_gb.pyx":1011
+  /* "structureboost/structure_gb.pyx":1009
  *                      long path_index):
  *     cdef double one_fraction = one_fractions[path_index]
  *     cdef double zero_fraction = zero_fractions[path_index]             # <<<<<<<<<<<<<<
  *     cdef double next_one_portion = pweights[unique_depth]
  *     cdef double total = 0.0
  */
   __pyx_t_1 = __pyx_v_path_index;
   __pyx_v_zero_fraction = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_zero_fractions.diminfo[0].strides));
 
-  /* "structureboost/structure_gb.pyx":1012
+  /* "structureboost/structure_gb.pyx":1010
  *     cdef double one_fraction = one_fractions[path_index]
  *     cdef double zero_fraction = zero_fractions[path_index]
  *     cdef double next_one_portion = pweights[unique_depth]             # <<<<<<<<<<<<<<
  *     cdef double total = 0.0
  *     cdef long i
  */
   __pyx_t_1 = __pyx_v_unique_depth;
   __pyx_v_next_one_portion = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_pweights.diminfo[0].strides));
 
-  /* "structureboost/structure_gb.pyx":1013
+  /* "structureboost/structure_gb.pyx":1011
  *     cdef double zero_fraction = zero_fractions[path_index]
  *     cdef double next_one_portion = pweights[unique_depth]
  *     cdef double total = 0.0             # <<<<<<<<<<<<<<
  *     cdef long i
  *     cdef double tmp
  */
   __pyx_v_total = 0.0;
 
-  /* "structureboost/structure_gb.pyx":1017
+  /* "structureboost/structure_gb.pyx":1015
  *     cdef double tmp
  * 
  *     for i in range(unique_depth - 1, -1, -1):             # <<<<<<<<<<<<<<
  *         if one_fraction != 0:
  *             tmp = next_one_portion * (unique_depth + 1) / ((i + 1) * one_fraction)
  */
   for (__pyx_t_2 = (__pyx_v_unique_depth - 1); __pyx_t_2 > -1L; __pyx_t_2-=1) {
     __pyx_v_i = __pyx_t_2;
 
-    /* "structureboost/structure_gb.pyx":1018
+    /* "structureboost/structure_gb.pyx":1016
  * 
  *     for i in range(unique_depth - 1, -1, -1):
  *         if one_fraction != 0:             # <<<<<<<<<<<<<<
  *             tmp = next_one_portion * (unique_depth + 1) / ((i + 1) * one_fraction)
  *             total += tmp;
  */
     __pyx_t_3 = ((__pyx_v_one_fraction != 0.0) != 0);
     if (__pyx_t_3) {
 
-      /* "structureboost/structure_gb.pyx":1019
+      /* "structureboost/structure_gb.pyx":1017
  *     for i in range(unique_depth - 1, -1, -1):
  *         if one_fraction != 0:
  *             tmp = next_one_portion * (unique_depth + 1) / ((i + 1) * one_fraction)             # <<<<<<<<<<<<<<
  *             total += tmp;
  *             next_one_portion = pweights[i] - tmp * zero_fraction * ((unique_depth - i) / (unique_depth + 1))
  */
       __pyx_t_4 = (__pyx_v_next_one_portion * (__pyx_v_unique_depth + 1));
       __pyx_t_5 = ((__pyx_v_i + 1) * __pyx_v_one_fraction);
       if (unlikely(__pyx_t_5 == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-        __PYX_ERR(0, 1019, __pyx_L1_error)
+        __PYX_ERR(0, 1017, __pyx_L1_error)
       }
       __pyx_v_tmp = (__pyx_t_4 / __pyx_t_5);
 
-      /* "structureboost/structure_gb.pyx":1020
+      /* "structureboost/structure_gb.pyx":1018
  *         if one_fraction != 0:
  *             tmp = next_one_portion * (unique_depth + 1) / ((i + 1) * one_fraction)
  *             total += tmp;             # <<<<<<<<<<<<<<
  *             next_one_portion = pweights[i] - tmp * zero_fraction * ((unique_depth - i) / (unique_depth + 1))
  *         else:
  */
       __pyx_v_total = (__pyx_v_total + __pyx_v_tmp);
 
-      /* "structureboost/structure_gb.pyx":1021
+      /* "structureboost/structure_gb.pyx":1019
  *             tmp = next_one_portion * (unique_depth + 1) / ((i + 1) * one_fraction)
  *             total += tmp;
  *             next_one_portion = pweights[i] - tmp * zero_fraction * ((unique_depth - i) / (unique_depth + 1))             # <<<<<<<<<<<<<<
  *         else:
  *             if zero_fraction == 0:
  */
       __pyx_t_1 = __pyx_v_i;
       __pyx_t_6 = (__pyx_v_unique_depth - __pyx_v_i);
       __pyx_t_7 = (__pyx_v_unique_depth + 1);
       if (unlikely(__pyx_t_7 == 0)) {
         PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-        __PYX_ERR(0, 1021, __pyx_L1_error)
+        __PYX_ERR(0, 1019, __pyx_L1_error)
       }
       __pyx_v_next_one_portion = ((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_pweights.diminfo[0].strides)) - ((__pyx_v_tmp * __pyx_v_zero_fraction) * (((double)__pyx_t_6) / ((double)__pyx_t_7))));
 
-      /* "structureboost/structure_gb.pyx":1018
+      /* "structureboost/structure_gb.pyx":1016
  * 
  *     for i in range(unique_depth - 1, -1, -1):
  *         if one_fraction != 0:             # <<<<<<<<<<<<<<
  *             tmp = next_one_portion * (unique_depth + 1) / ((i + 1) * one_fraction)
  *             total += tmp;
  */
       goto __pyx_L5;
     }
 
-    /* "structureboost/structure_gb.pyx":1023
+    /* "structureboost/structure_gb.pyx":1021
  *             next_one_portion = pweights[i] - tmp * zero_fraction * ((unique_depth - i) / (unique_depth + 1))
  *         else:
  *             if zero_fraction == 0:             # <<<<<<<<<<<<<<
  *                 print('Warning: zero_fraction is 0')
  *             else:
  */
     /*else*/ {
       __pyx_t_3 = ((__pyx_v_zero_fraction == 0.0) != 0);
       if (__pyx_t_3) {
 
-        /* "structureboost/structure_gb.pyx":1024
+        /* "structureboost/structure_gb.pyx":1022
  *         else:
  *             if zero_fraction == 0:
  *                 print('Warning: zero_fraction is 0')             # <<<<<<<<<<<<<<
  *             else:
  *                 total += (pweights[i] / zero_fraction) / ((unique_depth - i) / (unique_depth + 1))
  */
-        __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__45, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1024, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_Call(__pyx_builtin_print, __pyx_tuple__45, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1022, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-        /* "structureboost/structure_gb.pyx":1023
+        /* "structureboost/structure_gb.pyx":1021
  *             next_one_portion = pweights[i] - tmp * zero_fraction * ((unique_depth - i) / (unique_depth + 1))
  *         else:
  *             if zero_fraction == 0:             # <<<<<<<<<<<<<<
  *                 print('Warning: zero_fraction is 0')
  *             else:
  */
         goto __pyx_L6;
       }
 
-      /* "structureboost/structure_gb.pyx":1026
+      /* "structureboost/structure_gb.pyx":1024
  *                 print('Warning: zero_fraction is 0')
  *             else:
  *                 total += (pweights[i] / zero_fraction) / ((unique_depth - i) / (unique_depth + 1))             # <<<<<<<<<<<<<<
  * 
  *     return total
  */
       /*else*/ {
         __pyx_t_1 = __pyx_v_i;
         __pyx_t_5 = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_1, __pyx_pybuffernd_pweights.diminfo[0].strides));
         if (unlikely(__pyx_v_zero_fraction == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-          __PYX_ERR(0, 1026, __pyx_L1_error)
+          __PYX_ERR(0, 1024, __pyx_L1_error)
         }
         __pyx_t_4 = (__pyx_t_5 / __pyx_v_zero_fraction);
         __pyx_t_7 = (__pyx_v_unique_depth - __pyx_v_i);
         __pyx_t_6 = (__pyx_v_unique_depth + 1);
         if (unlikely(__pyx_t_6 == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-          __PYX_ERR(0, 1026, __pyx_L1_error)
+          __PYX_ERR(0, 1024, __pyx_L1_error)
         }
         __pyx_t_5 = (((double)__pyx_t_7) / ((double)__pyx_t_6));
         if (unlikely(__pyx_t_5 == 0)) {
           PyErr_SetString(PyExc_ZeroDivisionError, "float division");
-          __PYX_ERR(0, 1026, __pyx_L1_error)
+          __PYX_ERR(0, 1024, __pyx_L1_error)
         }
         __pyx_v_total = (__pyx_v_total + (__pyx_t_4 / __pyx_t_5));
       }
       __pyx_L6:;
     }
     __pyx_L5:;
   }
 
-  /* "structureboost/structure_gb.pyx":1028
+  /* "structureboost/structure_gb.pyx":1026
  *                 total += (pweights[i] / zero_fraction) / ((unique_depth - i) / (unique_depth + 1))
  * 
  *     return total             # <<<<<<<<<<<<<<
  * 
  * # recursive computation of SHAP values for a decision tree
  */
   __pyx_r = __pyx_v_total;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":1004
+  /* "structureboost/structure_gb.pyx":1002
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * cdef double unwound_path_sum(np.ndarray[dtype_int64_t] feature_indexes,             # <<<<<<<<<<<<<<
+ * cdef double unwound_path_sum(np.ndarray[long] feature_indexes,             # <<<<<<<<<<<<<<
  *                      np.ndarray[double] zero_fractions,
  *                      np.ndarray[double] one_fractions,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_8);
@@ -22658,20 +22645,20 @@
   __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer);
   __pyx_L2:;
   __Pyx_TraceReturn(Py_None, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":1034
+/* "structureboost/structure_gb.pyx":1032
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * @cython.cdivision(True)
- * cdef tree_shap_recursive(np.ndarray[dtype_int64_t] children_left,             # <<<<<<<<<<<<<<
- *                         np.ndarray[dtype_int64_t] children_right,
- *                         np.ndarray[dtype_int64_t] children_default,
+ * cdef tree_shap_recursive(np.ndarray[long] children_left,             # <<<<<<<<<<<<<<
+ *                         np.ndarray[long] children_right,
+ *                         np.ndarray[long] children_default,
  */
 
 static PyObject *__pyx_f_14structureboost_12structure_gb_tree_shap_recursive(PyArrayObject *__pyx_v_children_left, PyArrayObject *__pyx_v_children_right, PyArrayObject *__pyx_v_children_default, PyArrayObject *__pyx_v_features, PyArrayObject *__pyx_v_node_type_vec, PyArrayObject *__pyx_v_num_cat_vals_vec, PyArrayObject *__pyx_v_cat_vals_mat, PyArrayObject *__pyx_v_thresholds, PyArrayObject *__pyx_v_values, PyArrayObject *__pyx_v_node_sample_weight, PyArrayObject *__pyx_v_x, PyArrayObject *__pyx_v_x_missing, PyArrayObject *__pyx_v_phi, long __pyx_v_node_index, long __pyx_v_unique_depth, PyArrayObject *__pyx_v_parent_feature_indexes, PyArrayObject *__pyx_v_parent_zero_fractions, PyArrayObject *__pyx_v_parent_one_fractions, PyArrayObject *__pyx_v_parent_pweights, double __pyx_v_parent_zero_fraction, double __pyx_v_parent_one_fraction, long __pyx_v_parent_feature_index, long __pyx_v_condition, long __pyx_v_condition_feature, double __pyx_v_condition_fraction) {
   long __pyx_v_pfi_len;
   PyArrayObject *__pyx_v_feature_indexes = 0;
   PyArrayObject *__pyx_v_zero_fractions = 0;
   PyArrayObject *__pyx_v_one_fractions = 0;
@@ -22752,21 +22739,20 @@
   long __pyx_t_13;
   long __pyx_t_14;
   Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
   int __pyx_t_17;
   Py_ssize_t __pyx_t_18;
   Py_ssize_t __pyx_t_19;
-  __pyx_t_14structureboost_12structure_gb_dtype_int64_t __pyx_t_20;
-  __pyx_t_14structureboost_12structure_gb_dtype_int64_t __pyx_t_21;
+  Py_ssize_t __pyx_t_20;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("tree_shap_recursive", 0);
-  __Pyx_TraceCall("tree_shap_recursive", __pyx_f[0], 1034, 0, __PYX_ERR(0, 1034, __pyx_L1_error));
+  __Pyx_TraceCall("tree_shap_recursive", __pyx_f[0], 1032, 0, __PYX_ERR(0, 1032, __pyx_L1_error));
   __pyx_pybuffer_feature_indexes.pybuffer.buf = NULL;
   __pyx_pybuffer_feature_indexes.refcount = 0;
   __pyx_pybuffernd_feature_indexes.data = NULL;
   __pyx_pybuffernd_feature_indexes.rcbuffer = &__pyx_pybuffer_feature_indexes;
   __pyx_pybuffer_zero_fractions.pybuffer.buf = NULL;
   __pyx_pybuffer_zero_fractions.refcount = 0;
   __pyx_pybuffernd_zero_fractions.data = NULL;
@@ -22845,459 +22831,459 @@
   __pyx_pybuffernd_parent_one_fractions.rcbuffer = &__pyx_pybuffer_parent_one_fractions;
   __pyx_pybuffer_parent_pweights.pybuffer.buf = NULL;
   __pyx_pybuffer_parent_pweights.refcount = 0;
   __pyx_pybuffernd_parent_pweights.data = NULL;
   __pyx_pybuffernd_parent_pweights.rcbuffer = &__pyx_pybuffer_parent_pweights;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_children_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_children_left, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_gb_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_children_left.rcbuffer->pybuffer, (PyObject*)__pyx_v_children_left, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_children_left.diminfo[0].strides = __pyx_pybuffernd_children_left.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_children_left.diminfo[0].shape = __pyx_pybuffernd_children_left.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_children_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_children_right, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_gb_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_children_right.rcbuffer->pybuffer, (PyObject*)__pyx_v_children_right, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_children_right.diminfo[0].strides = __pyx_pybuffernd_children_right.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_children_right.diminfo[0].shape = __pyx_pybuffernd_children_right.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_children_default.rcbuffer->pybuffer, (PyObject*)__pyx_v_children_default, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_gb_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_children_default.rcbuffer->pybuffer, (PyObject*)__pyx_v_children_default, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_children_default.diminfo[0].strides = __pyx_pybuffernd_children_default.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_children_default.diminfo[0].shape = __pyx_pybuffernd_children_default.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_features.rcbuffer->pybuffer, (PyObject*)__pyx_v_features, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_gb_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_features.rcbuffer->pybuffer, (PyObject*)__pyx_v_features, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_features.diminfo[0].strides = __pyx_pybuffernd_features.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_features.diminfo[0].shape = __pyx_pybuffernd_features.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_node_type_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_node_type_vec, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_gb_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_node_type_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_node_type_vec, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_node_type_vec.diminfo[0].strides = __pyx_pybuffernd_node_type_vec.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_node_type_vec.diminfo[0].shape = __pyx_pybuffernd_node_type_vec.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_num_cat_vals_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_num_cat_vals_vec, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_gb_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_num_cat_vals_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_num_cat_vals_vec, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_num_cat_vals_vec.diminfo[0].strides = __pyx_pybuffernd_num_cat_vals_vec.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_num_cat_vals_vec.diminfo[0].shape = __pyx_pybuffernd_num_cat_vals_vec.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cat_vals_mat.rcbuffer->pybuffer, (PyObject*)__pyx_v_cat_vals_mat, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_gb_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_cat_vals_mat.rcbuffer->pybuffer, (PyObject*)__pyx_v_cat_vals_mat, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_cat_vals_mat.diminfo[0].strides = __pyx_pybuffernd_cat_vals_mat.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_cat_vals_mat.diminfo[0].shape = __pyx_pybuffernd_cat_vals_mat.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_cat_vals_mat.diminfo[1].strides = __pyx_pybuffernd_cat_vals_mat.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_cat_vals_mat.diminfo[1].shape = __pyx_pybuffernd_cat_vals_mat.rcbuffer->pybuffer.shape[1];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_thresholds.rcbuffer->pybuffer, (PyObject*)__pyx_v_thresholds, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_thresholds.rcbuffer->pybuffer, (PyObject*)__pyx_v_thresholds, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_thresholds.diminfo[0].strides = __pyx_pybuffernd_thresholds.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_thresholds.diminfo[0].shape = __pyx_pybuffernd_thresholds.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_values.rcbuffer->pybuffer, (PyObject*)__pyx_v_values, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_values.rcbuffer->pybuffer, (PyObject*)__pyx_v_values, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_values.diminfo[0].strides = __pyx_pybuffernd_values.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_values.diminfo[0].shape = __pyx_pybuffernd_values.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_node_sample_weight.rcbuffer->pybuffer, (PyObject*)__pyx_v_node_sample_weight, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_node_sample_weight.rcbuffer->pybuffer, (PyObject*)__pyx_v_node_sample_weight, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_node_sample_weight.diminfo[0].strides = __pyx_pybuffernd_node_sample_weight.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_node_sample_weight.diminfo[0].shape = __pyx_pybuffernd_node_sample_weight.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_x.rcbuffer->pybuffer, (PyObject*)__pyx_v_x, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_x.rcbuffer->pybuffer, (PyObject*)__pyx_v_x, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_x.diminfo[0].strides = __pyx_pybuffernd_x.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_x.diminfo[0].shape = __pyx_pybuffernd_x.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_x_missing.rcbuffer->pybuffer, (PyObject*)__pyx_v_x_missing, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_x_missing.rcbuffer->pybuffer, (PyObject*)__pyx_v_x_missing, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_x_missing.diminfo[0].strides = __pyx_pybuffernd_x_missing.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_x_missing.diminfo[0].shape = __pyx_pybuffernd_x_missing.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phi.rcbuffer->pybuffer, (PyObject*)__pyx_v_phi, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phi.rcbuffer->pybuffer, (PyObject*)__pyx_v_phi, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_phi.diminfo[0].strides = __pyx_pybuffernd_phi.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phi.diminfo[0].shape = __pyx_pybuffernd_phi.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_parent_feature_indexes.rcbuffer->pybuffer, (PyObject*)__pyx_v_parent_feature_indexes, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_gb_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_parent_feature_indexes.rcbuffer->pybuffer, (PyObject*)__pyx_v_parent_feature_indexes, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_parent_feature_indexes.diminfo[0].strides = __pyx_pybuffernd_parent_feature_indexes.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_parent_feature_indexes.diminfo[0].shape = __pyx_pybuffernd_parent_feature_indexes.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_parent_zero_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_v_parent_zero_fractions, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_parent_zero_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_v_parent_zero_fractions, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_parent_zero_fractions.diminfo[0].strides = __pyx_pybuffernd_parent_zero_fractions.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_parent_zero_fractions.diminfo[0].shape = __pyx_pybuffernd_parent_zero_fractions.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_parent_one_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_v_parent_one_fractions, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_parent_one_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_v_parent_one_fractions, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_parent_one_fractions.diminfo[0].strides = __pyx_pybuffernd_parent_one_fractions.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_parent_one_fractions.diminfo[0].shape = __pyx_pybuffernd_parent_one_fractions.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_parent_pweights.rcbuffer->pybuffer, (PyObject*)__pyx_v_parent_pweights, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1034, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_parent_pweights.rcbuffer->pybuffer, (PyObject*)__pyx_v_parent_pweights, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1032, __pyx_L1_error)
   }
   __pyx_pybuffernd_parent_pweights.diminfo[0].strides = __pyx_pybuffernd_parent_pweights.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_parent_pweights.diminfo[0].shape = __pyx_pybuffernd_parent_pweights.rcbuffer->pybuffer.shape[0];
 
-  /* "structureboost/structure_gb.pyx":1060
+  /* "structureboost/structure_gb.pyx":1058
  *                         double condition_fraction):
  * 
  *     cdef long pfi_len = len(parent_feature_indexes)             # <<<<<<<<<<<<<<
- *     cdef np.ndarray[dtype_int64_t] feature_indexes = np.zeros(pfi_len, dtype=np.int64)
+ *     cdef np.ndarray[long] feature_indexes = np.zeros(pfi_len, dtype=np.int_)
  *     cdef np.ndarray[double] zero_fractions = np.zeros(pfi_len, dtype=np.float64)
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_parent_feature_indexes)); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1060, __pyx_L1_error)
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_parent_feature_indexes)); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1058, __pyx_L1_error)
   __pyx_v_pfi_len = __pyx_t_1;
 
-  /* "structureboost/structure_gb.pyx":1061
+  /* "structureboost/structure_gb.pyx":1059
  * 
  *     cdef long pfi_len = len(parent_feature_indexes)
- *     cdef np.ndarray[dtype_int64_t] feature_indexes = np.zeros(pfi_len, dtype=np.int64)             # <<<<<<<<<<<<<<
+ *     cdef np.ndarray[long] feature_indexes = np.zeros(pfi_len, dtype=np.int_)             # <<<<<<<<<<<<<<
  *     cdef np.ndarray[double] zero_fractions = np.zeros(pfi_len, dtype=np.float64)
  *     cdef np.ndarray[double] one_fractions = np.zeros(pfi_len, dtype=np.float64)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1059, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1059, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_pfi_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_From_long(__pyx_v_pfi_len); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1059, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1059, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1059, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1059, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1059, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 1061, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 1059, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1061, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1059, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1061, __pyx_L1_error)
+  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1059, __pyx_L1_error)
   __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_12structure_gb_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_feature_indexes = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 1061, __pyx_L1_error)
+      __PYX_ERR(0, 1059, __pyx_L1_error)
     } else {__pyx_pybuffernd_feature_indexes.diminfo[0].strides = __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_feature_indexes.diminfo[0].shape = __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.shape[0];
     }
   }
   __pyx_t_7 = 0;
   __pyx_v_feature_indexes = ((PyArrayObject *)__pyx_t_6);
   __pyx_t_6 = 0;
 
-  /* "structureboost/structure_gb.pyx":1062
+  /* "structureboost/structure_gb.pyx":1060
  *     cdef long pfi_len = len(parent_feature_indexes)
- *     cdef np.ndarray[dtype_int64_t] feature_indexes = np.zeros(pfi_len, dtype=np.int64)
+ *     cdef np.ndarray[long] feature_indexes = np.zeros(pfi_len, dtype=np.int_)
  *     cdef np.ndarray[double] zero_fractions = np.zeros(pfi_len, dtype=np.float64)             # <<<<<<<<<<<<<<
  *     cdef np.ndarray[double] one_fractions = np.zeros(pfi_len, dtype=np.float64)
  *     cdef np.ndarray[double] pweights = np.zeros(pfi_len, dtype=np.float64)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1060, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1060, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyInt_From_long(__pyx_v_pfi_len); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyInt_From_long(__pyx_v_pfi_len); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1060, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1060, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
   __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1060, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1060, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1060, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1062, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1060, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1062, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1060, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1062, __pyx_L1_error)
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1060, __pyx_L1_error)
   __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_zero_fractions = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 1062, __pyx_L1_error)
+      __PYX_ERR(0, 1060, __pyx_L1_error)
     } else {__pyx_pybuffernd_zero_fractions.diminfo[0].strides = __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_zero_fractions.diminfo[0].shape = __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.shape[0];
     }
   }
   __pyx_t_8 = 0;
   __pyx_v_zero_fractions = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "structureboost/structure_gb.pyx":1063
- *     cdef np.ndarray[dtype_int64_t] feature_indexes = np.zeros(pfi_len, dtype=np.int64)
+  /* "structureboost/structure_gb.pyx":1061
+ *     cdef np.ndarray[long] feature_indexes = np.zeros(pfi_len, dtype=np.int_)
  *     cdef np.ndarray[double] zero_fractions = np.zeros(pfi_len, dtype=np.float64)
  *     cdef np.ndarray[double] one_fractions = np.zeros(pfi_len, dtype=np.float64)             # <<<<<<<<<<<<<<
  *     cdef np.ndarray[double] pweights = np.zeros(pfi_len, dtype=np.float64)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1063, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1063, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_pfi_len); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1063, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_long(__pyx_v_pfi_len); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1063, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1063, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1063, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1063, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 1063, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1063, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1061, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1063, __pyx_L1_error)
+  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1061, __pyx_L1_error)
   __pyx_t_9 = ((PyArrayObject *)__pyx_t_3);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_one_fractions.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_one_fractions = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 1063, __pyx_L1_error)
+      __PYX_ERR(0, 1061, __pyx_L1_error)
     } else {__pyx_pybuffernd_one_fractions.diminfo[0].strides = __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_one_fractions.diminfo[0].shape = __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.shape[0];
     }
   }
   __pyx_t_9 = 0;
   __pyx_v_one_fractions = ((PyArrayObject *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":1064
+  /* "structureboost/structure_gb.pyx":1062
  *     cdef np.ndarray[double] zero_fractions = np.zeros(pfi_len, dtype=np.float64)
  *     cdef np.ndarray[double] one_fractions = np.zeros(pfi_len, dtype=np.float64)
  *     cdef np.ndarray[double] pweights = np.zeros(pfi_len, dtype=np.float64)             # <<<<<<<<<<<<<<
  * 
  *     cdef long i,j,k, split_index, hot_index, cold_index, cleft, cright, path_index,
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1064, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1064, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_pfi_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1064, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_pfi_len); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1064, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1064, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1064, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1064, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 1064, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1064, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1062, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1064, __pyx_L1_error)
+  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1062, __pyx_L1_error)
   __pyx_t_10 = ((PyArrayObject *)__pyx_t_2);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_pweights.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
       __pyx_v_pweights = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 1064, __pyx_L1_error)
+      __PYX_ERR(0, 1062, __pyx_L1_error)
     } else {__pyx_pybuffernd_pweights.diminfo[0].strides = __pyx_pybuffernd_pweights.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_pweights.diminfo[0].shape = __pyx_pybuffernd_pweights.rcbuffer->pybuffer.shape[0];
     }
   }
   __pyx_t_10 = 0;
   __pyx_v_pweights = ((PyArrayObject *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "structureboost/structure_gb.pyx":1074
+  /* "structureboost/structure_gb.pyx":1072
  * 
  *     # stop if we have no weight coming down to us
  *     if condition_fraction == 0:             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   __pyx_t_11 = ((__pyx_v_condition_fraction == 0.0) != 0);
   if (__pyx_t_11) {
 
-    /* "structureboost/structure_gb.pyx":1075
+    /* "structureboost/structure_gb.pyx":1073
  *     # stop if we have no weight coming down to us
  *     if condition_fraction == 0:
  *         return             # <<<<<<<<<<<<<<
  * 
  *     # # extend the unique path
  */
     __Pyx_XDECREF(__pyx_r);
     __pyx_r = Py_None; __Pyx_INCREF(Py_None);
     goto __pyx_L0;
 
-    /* "structureboost/structure_gb.pyx":1074
+    /* "structureboost/structure_gb.pyx":1072
  * 
  *     # stop if we have no weight coming down to us
  *     if condition_fraction == 0:             # <<<<<<<<<<<<<<
  *         return
  * 
  */
   }
 
-  /* "structureboost/structure_gb.pyx":1088
+  /* "structureboost/structure_gb.pyx":1086
  * 
  *     # extend the unique path
  *     j=0             # <<<<<<<<<<<<<<
  *     # I am assuming the length of parent_feature_indexes is the same as the others
  *     for i in range((unique_depth + 1),pfi_len):
  */
   __pyx_v_j = 0;
 
-  /* "structureboost/structure_gb.pyx":1090
+  /* "structureboost/structure_gb.pyx":1088
  *     j=0
  *     # I am assuming the length of parent_feature_indexes is the same as the others
  *     for i in range((unique_depth + 1),pfi_len):             # <<<<<<<<<<<<<<
  *         feature_indexes[j] = parent_feature_indexes[i]
  *         zero_fractions[j] = parent_zero_fractions[i]
  */
   __pyx_t_12 = __pyx_v_pfi_len;
   __pyx_t_13 = __pyx_t_12;
   for (__pyx_t_14 = (__pyx_v_unique_depth + 1); __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
     __pyx_v_i = __pyx_t_14;
 
-    /* "structureboost/structure_gb.pyx":1091
+    /* "structureboost/structure_gb.pyx":1089
  *     # I am assuming the length of parent_feature_indexes is the same as the others
  *     for i in range((unique_depth + 1),pfi_len):
  *         feature_indexes[j] = parent_feature_indexes[i]             # <<<<<<<<<<<<<<
  *         zero_fractions[j] = parent_zero_fractions[i]
  *         one_fractions[j] = parent_one_fractions[i]
  */
     __pyx_t_15 = __pyx_v_i;
     __pyx_t_16 = __pyx_v_j;
-    *__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_feature_indexes.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_parent_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_parent_feature_indexes.diminfo[0].strides));
+    *__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_feature_indexes.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_parent_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_parent_feature_indexes.diminfo[0].strides));
 
-    /* "structureboost/structure_gb.pyx":1092
+    /* "structureboost/structure_gb.pyx":1090
  *     for i in range((unique_depth + 1),pfi_len):
  *         feature_indexes[j] = parent_feature_indexes[i]
  *         zero_fractions[j] = parent_zero_fractions[i]             # <<<<<<<<<<<<<<
  *         one_fractions[j] = parent_one_fractions[i]
  *         pweights[j] = parent_pweights[i]
  */
     __pyx_t_15 = __pyx_v_i;
     __pyx_t_16 = __pyx_v_j;
     *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_zero_fractions.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_parent_zero_fractions.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_parent_zero_fractions.diminfo[0].strides));
 
-    /* "structureboost/structure_gb.pyx":1093
+    /* "structureboost/structure_gb.pyx":1091
  *         feature_indexes[j] = parent_feature_indexes[i]
  *         zero_fractions[j] = parent_zero_fractions[i]
  *         one_fractions[j] = parent_one_fractions[i]             # <<<<<<<<<<<<<<
  *         pweights[j] = parent_pweights[i]
  *         j+=1
  */
     __pyx_t_15 = __pyx_v_i;
     __pyx_t_16 = __pyx_v_j;
     *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_one_fractions.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_parent_one_fractions.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_parent_one_fractions.diminfo[0].strides));
 
-    /* "structureboost/structure_gb.pyx":1094
+    /* "structureboost/structure_gb.pyx":1092
  *         zero_fractions[j] = parent_zero_fractions[i]
  *         one_fractions[j] = parent_one_fractions[i]
  *         pweights[j] = parent_pweights[i]             # <<<<<<<<<<<<<<
  *         j+=1
  *     for i in range(unique_depth+1):
  */
     __pyx_t_15 = __pyx_v_i;
     __pyx_t_16 = __pyx_v_j;
     *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_pweights.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_parent_pweights.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_parent_pweights.diminfo[0].strides));
 
-    /* "structureboost/structure_gb.pyx":1095
+    /* "structureboost/structure_gb.pyx":1093
  *         one_fractions[j] = parent_one_fractions[i]
  *         pweights[j] = parent_pweights[i]
  *         j+=1             # <<<<<<<<<<<<<<
  *     for i in range(unique_depth+1):
  *         feature_indexes[i] = parent_feature_indexes[i]
  */
     __pyx_v_j = (__pyx_v_j + 1);
   }
 
-  /* "structureboost/structure_gb.pyx":1096
+  /* "structureboost/structure_gb.pyx":1094
  *         pweights[j] = parent_pweights[i]
  *         j+=1
  *     for i in range(unique_depth+1):             # <<<<<<<<<<<<<<
  *         feature_indexes[i] = parent_feature_indexes[i]
  *         zero_fractions[i] = parent_zero_fractions[i]
  */
   __pyx_t_12 = (__pyx_v_unique_depth + 1);
   __pyx_t_13 = __pyx_t_12;
   for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
     __pyx_v_i = __pyx_t_14;
 
-    /* "structureboost/structure_gb.pyx":1097
+    /* "structureboost/structure_gb.pyx":1095
  *         j+=1
  *     for i in range(unique_depth+1):
  *         feature_indexes[i] = parent_feature_indexes[i]             # <<<<<<<<<<<<<<
  *         zero_fractions[i] = parent_zero_fractions[i]
  *         one_fractions[i] = parent_one_fractions[i]
  */
     __pyx_t_15 = __pyx_v_i;
     __pyx_t_16 = __pyx_v_i;
-    *__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_feature_indexes.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_parent_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_parent_feature_indexes.diminfo[0].strides));
+    *__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_feature_indexes.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_parent_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_parent_feature_indexes.diminfo[0].strides));
 
-    /* "structureboost/structure_gb.pyx":1098
+    /* "structureboost/structure_gb.pyx":1096
  *     for i in range(unique_depth+1):
  *         feature_indexes[i] = parent_feature_indexes[i]
  *         zero_fractions[i] = parent_zero_fractions[i]             # <<<<<<<<<<<<<<
  *         one_fractions[i] = parent_one_fractions[i]
  *         pweights[i] = parent_pweights[i]
  */
     __pyx_t_15 = __pyx_v_i;
     __pyx_t_16 = __pyx_v_i;
     *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_zero_fractions.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_parent_zero_fractions.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_parent_zero_fractions.diminfo[0].strides));
 
-    /* "structureboost/structure_gb.pyx":1099
+    /* "structureboost/structure_gb.pyx":1097
  *         feature_indexes[i] = parent_feature_indexes[i]
  *         zero_fractions[i] = parent_zero_fractions[i]
  *         one_fractions[i] = parent_one_fractions[i]             # <<<<<<<<<<<<<<
  *         pweights[i] = parent_pweights[i]
  * 
  */
     __pyx_t_15 = __pyx_v_i;
     __pyx_t_16 = __pyx_v_i;
     *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_one_fractions.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_parent_one_fractions.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_parent_one_fractions.diminfo[0].strides));
 
-    /* "structureboost/structure_gb.pyx":1100
+    /* "structureboost/structure_gb.pyx":1098
  *         zero_fractions[i] = parent_zero_fractions[i]
  *         one_fractions[i] = parent_one_fractions[i]
  *         pweights[i] = parent_pweights[i]             # <<<<<<<<<<<<<<
  * 
  *     if condition == 0 or condition_feature != parent_feature_index:
  */
     __pyx_t_15 = __pyx_v_i;
     __pyx_t_16 = __pyx_v_i;
     *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_pweights.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_pweights.diminfo[0].strides) = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_parent_pweights.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_parent_pweights.diminfo[0].strides));
   }
 
-  /* "structureboost/structure_gb.pyx":1102
+  /* "structureboost/structure_gb.pyx":1100
  *         pweights[i] = parent_pweights[i]
  * 
  *     if condition == 0 or condition_feature != parent_feature_index:             # <<<<<<<<<<<<<<
  *         extend_path(
  *             feature_indexes, zero_fractions, one_fractions, pweights,
  */
   __pyx_t_17 = ((__pyx_v_condition == 0) != 0);
@@ -23307,499 +23293,499 @@
     goto __pyx_L9_bool_binop_done;
   }
   __pyx_t_17 = ((__pyx_v_condition_feature != __pyx_v_parent_feature_index) != 0);
   __pyx_t_11 = __pyx_t_17;
   __pyx_L9_bool_binop_done:;
   if (__pyx_t_11) {
 
-    /* "structureboost/structure_gb.pyx":1103
+    /* "structureboost/structure_gb.pyx":1101
  * 
  *     if condition == 0 or condition_feature != parent_feature_index:
  *         extend_path(             # <<<<<<<<<<<<<<
  *             feature_indexes, zero_fractions, one_fractions, pweights,
  *             unique_depth, parent_zero_fraction, parent_one_fraction, parent_feature_index
  */
-    __pyx_t_2 = __pyx_f_14structureboost_12structure_gb_extend_path(((PyArrayObject *)__pyx_v_feature_indexes), ((PyArrayObject *)__pyx_v_zero_fractions), ((PyArrayObject *)__pyx_v_one_fractions), ((PyArrayObject *)__pyx_v_pweights), __pyx_v_unique_depth, __pyx_v_parent_zero_fraction, __pyx_v_parent_one_fraction, __pyx_v_parent_feature_index); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1103, __pyx_L1_error)
+    __pyx_t_2 = __pyx_f_14structureboost_12structure_gb_extend_path(((PyArrayObject *)__pyx_v_feature_indexes), ((PyArrayObject *)__pyx_v_zero_fractions), ((PyArrayObject *)__pyx_v_one_fractions), ((PyArrayObject *)__pyx_v_pweights), __pyx_v_unique_depth, __pyx_v_parent_zero_fraction, __pyx_v_parent_one_fraction, __pyx_v_parent_feature_index); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1101, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "structureboost/structure_gb.pyx":1102
+    /* "structureboost/structure_gb.pyx":1100
  *         pweights[i] = parent_pweights[i]
  * 
  *     if condition == 0 or condition_feature != parent_feature_index:             # <<<<<<<<<<<<<<
  *         extend_path(
  *             feature_indexes, zero_fractions, one_fractions, pweights,
  */
   }
 
-  /* "structureboost/structure_gb.pyx":1108
+  /* "structureboost/structure_gb.pyx":1106
  *         )
  * 
  *     split_index = features[node_index]             # <<<<<<<<<<<<<<
  * 
  *     # leaf node
  */
   __pyx_t_15 = __pyx_v_node_index;
-  __pyx_v_split_index = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_features.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_features.diminfo[0].strides));
+  __pyx_v_split_index = (*__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_features.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_features.diminfo[0].strides));
 
-  /* "structureboost/structure_gb.pyx":1111
+  /* "structureboost/structure_gb.pyx":1109
  * 
  *     # leaf node
  *     if children_right[node_index] == -1:             # <<<<<<<<<<<<<<
  *         for i in range(1, unique_depth+1):
  *             w = unwound_path_sum(feature_indexes, zero_fractions, one_fractions, pweights, unique_depth, i)
  */
   __pyx_t_15 = __pyx_v_node_index;
-  __pyx_t_11 = (((*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_children_right.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_children_right.diminfo[0].strides)) == -1LL) != 0);
+  __pyx_t_11 = (((*__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_children_right.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_children_right.diminfo[0].strides)) == -1L) != 0);
   if (__pyx_t_11) {
 
-    /* "structureboost/structure_gb.pyx":1112
+    /* "structureboost/structure_gb.pyx":1110
  *     # leaf node
  *     if children_right[node_index] == -1:
  *         for i in range(1, unique_depth+1):             # <<<<<<<<<<<<<<
  *             w = unwound_path_sum(feature_indexes, zero_fractions, one_fractions, pweights, unique_depth, i)
  *             phi[feature_indexes[i]] += w * (one_fractions[i] - zero_fractions[i]) * values[node_index] * condition_fraction
  */
     __pyx_t_12 = (__pyx_v_unique_depth + 1);
     __pyx_t_13 = __pyx_t_12;
     for (__pyx_t_14 = 1; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
       __pyx_v_i = __pyx_t_14;
 
-      /* "structureboost/structure_gb.pyx":1113
+      /* "structureboost/structure_gb.pyx":1111
  *     if children_right[node_index] == -1:
  *         for i in range(1, unique_depth+1):
  *             w = unwound_path_sum(feature_indexes, zero_fractions, one_fractions, pweights, unique_depth, i)             # <<<<<<<<<<<<<<
  *             phi[feature_indexes[i]] += w * (one_fractions[i] - zero_fractions[i]) * values[node_index] * condition_fraction
  *     # internal node
  */
       __pyx_v_w = __pyx_f_14structureboost_12structure_gb_unwound_path_sum(((PyArrayObject *)__pyx_v_feature_indexes), ((PyArrayObject *)__pyx_v_zero_fractions), ((PyArrayObject *)__pyx_v_one_fractions), ((PyArrayObject *)__pyx_v_pweights), __pyx_v_unique_depth, __pyx_v_i);
 
-      /* "structureboost/structure_gb.pyx":1114
+      /* "structureboost/structure_gb.pyx":1112
  *         for i in range(1, unique_depth+1):
  *             w = unwound_path_sum(feature_indexes, zero_fractions, one_fractions, pweights, unique_depth, i)
  *             phi[feature_indexes[i]] += w * (one_fractions[i] - zero_fractions[i]) * values[node_index] * condition_fraction             # <<<<<<<<<<<<<<
  *     # internal node
  *     else:
  */
       __pyx_t_15 = __pyx_v_i;
       __pyx_t_16 = __pyx_v_i;
       __pyx_t_18 = __pyx_v_node_index;
       __pyx_t_19 = __pyx_v_i;
-      __pyx_t_20 = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_feature_indexes.diminfo[0].strides));
+      __pyx_t_20 = (*__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_feature_indexes.diminfo[0].strides));
       *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_phi.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_phi.diminfo[0].strides) += (((__pyx_v_w * ((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_one_fractions.diminfo[0].strides)) - (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_zero_fractions.diminfo[0].strides)))) * (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_values.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_values.diminfo[0].strides))) * __pyx_v_condition_fraction);
     }
 
-    /* "structureboost/structure_gb.pyx":1111
+    /* "structureboost/structure_gb.pyx":1109
  * 
  *     # leaf node
  *     if children_right[node_index] == -1:             # <<<<<<<<<<<<<<
  *         for i in range(1, unique_depth+1):
  *             w = unwound_path_sum(feature_indexes, zero_fractions, one_fractions, pweights, unique_depth, i)
  */
     goto __pyx_L11;
   }
 
-  /* "structureboost/structure_gb.pyx":1118
+  /* "structureboost/structure_gb.pyx":1116
  *     else:
  *         # find which branch is "hot" (meaning x would follow it)
  *         hot_index = 0             # <<<<<<<<<<<<<<
  *         cleft = children_left[node_index]
  *         cright = children_right[node_index]
  */
   /*else*/ {
     __pyx_v_hot_index = 0;
 
-    /* "structureboost/structure_gb.pyx":1119
+    /* "structureboost/structure_gb.pyx":1117
  *         # find which branch is "hot" (meaning x would follow it)
  *         hot_index = 0
  *         cleft = children_left[node_index]             # <<<<<<<<<<<<<<
  *         cright = children_right[node_index]
  *         if x_missing[split_index] == 1:
  */
     __pyx_t_18 = __pyx_v_node_index;
-    __pyx_v_cleft = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_children_left.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_children_left.diminfo[0].strides));
+    __pyx_v_cleft = (*__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_children_left.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_children_left.diminfo[0].strides));
 
-    /* "structureboost/structure_gb.pyx":1120
+    /* "structureboost/structure_gb.pyx":1118
  *         hot_index = 0
  *         cleft = children_left[node_index]
  *         cright = children_right[node_index]             # <<<<<<<<<<<<<<
  *         if x_missing[split_index] == 1:
  *             hot_index = children_default[node_index]
  */
     __pyx_t_18 = __pyx_v_node_index;
-    __pyx_v_cright = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_children_right.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_children_right.diminfo[0].strides));
+    __pyx_v_cright = (*__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_children_right.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_children_right.diminfo[0].strides));
 
-    /* "structureboost/structure_gb.pyx":1121
+    /* "structureboost/structure_gb.pyx":1119
  *         cleft = children_left[node_index]
  *         cright = children_right[node_index]
  *         if x_missing[split_index] == 1:             # <<<<<<<<<<<<<<
  *             hot_index = children_default[node_index]
  *         elif (node_type_vec[node_index]==1) and (x[split_index] < thresholds[node_index]): # (node_type_vec[node_index]==1) and
  */
     __pyx_t_18 = __pyx_v_split_index;
     __pyx_t_11 = (((*__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_x_missing.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_x_missing.diminfo[0].strides)) == 1) != 0);
     if (__pyx_t_11) {
 
-      /* "structureboost/structure_gb.pyx":1122
+      /* "structureboost/structure_gb.pyx":1120
  *         cright = children_right[node_index]
  *         if x_missing[split_index] == 1:
  *             hot_index = children_default[node_index]             # <<<<<<<<<<<<<<
  *         elif (node_type_vec[node_index]==1) and (x[split_index] < thresholds[node_index]): # (node_type_vec[node_index]==1) and
  *             hot_index = cleft
  */
       __pyx_t_18 = __pyx_v_node_index;
-      __pyx_v_hot_index = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_children_default.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_children_default.diminfo[0].strides));
+      __pyx_v_hot_index = (*__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_children_default.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_children_default.diminfo[0].strides));
 
-      /* "structureboost/structure_gb.pyx":1121
+      /* "structureboost/structure_gb.pyx":1119
  *         cleft = children_left[node_index]
  *         cright = children_right[node_index]
  *         if x_missing[split_index] == 1:             # <<<<<<<<<<<<<<
  *             hot_index = children_default[node_index]
  *         elif (node_type_vec[node_index]==1) and (x[split_index] < thresholds[node_index]): # (node_type_vec[node_index]==1) and
  */
       goto __pyx_L14;
     }
 
-    /* "structureboost/structure_gb.pyx":1123
+    /* "structureboost/structure_gb.pyx":1121
  *         if x_missing[split_index] == 1:
  *             hot_index = children_default[node_index]
  *         elif (node_type_vec[node_index]==1) and (x[split_index] < thresholds[node_index]): # (node_type_vec[node_index]==1) and             # <<<<<<<<<<<<<<
  *             hot_index = cleft
  *         elif (node_type_vec[node_index]==2):
  */
     __pyx_t_18 = __pyx_v_node_index;
-    __pyx_t_17 = (((*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_node_type_vec.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_node_type_vec.diminfo[0].strides)) == 1) != 0);
+    __pyx_t_17 = (((*__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_node_type_vec.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_node_type_vec.diminfo[0].strides)) == 1) != 0);
     if (__pyx_t_17) {
     } else {
       __pyx_t_11 = __pyx_t_17;
       goto __pyx_L15_bool_binop_done;
     }
     __pyx_t_18 = __pyx_v_split_index;
     __pyx_t_16 = __pyx_v_node_index;
     __pyx_t_17 = (((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_x.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_x.diminfo[0].strides)) < (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_thresholds.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_thresholds.diminfo[0].strides))) != 0);
     __pyx_t_11 = __pyx_t_17;
     __pyx_L15_bool_binop_done:;
     if (__pyx_t_11) {
 
-      /* "structureboost/structure_gb.pyx":1124
+      /* "structureboost/structure_gb.pyx":1122
  *             hot_index = children_default[node_index]
  *         elif (node_type_vec[node_index]==1) and (x[split_index] < thresholds[node_index]): # (node_type_vec[node_index]==1) and
  *             hot_index = cleft             # <<<<<<<<<<<<<<
  *         elif (node_type_vec[node_index]==2):
  *             hot_index = cright
  */
       __pyx_v_hot_index = __pyx_v_cleft;
 
-      /* "structureboost/structure_gb.pyx":1123
+      /* "structureboost/structure_gb.pyx":1121
  *         if x_missing[split_index] == 1:
  *             hot_index = children_default[node_index]
  *         elif (node_type_vec[node_index]==1) and (x[split_index] < thresholds[node_index]): # (node_type_vec[node_index]==1) and             # <<<<<<<<<<<<<<
  *             hot_index = cleft
  *         elif (node_type_vec[node_index]==2):
  */
       goto __pyx_L14;
     }
 
-    /* "structureboost/structure_gb.pyx":1125
+    /* "structureboost/structure_gb.pyx":1123
  *         elif (node_type_vec[node_index]==1) and (x[split_index] < thresholds[node_index]): # (node_type_vec[node_index]==1) and
  *             hot_index = cleft
  *         elif (node_type_vec[node_index]==2):             # <<<<<<<<<<<<<<
  *             hot_index = cright
  *             for k in range(num_cat_vals_vec[node_index]):
  */
     __pyx_t_16 = __pyx_v_node_index;
-    __pyx_t_11 = (((*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_node_type_vec.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_node_type_vec.diminfo[0].strides)) == 2) != 0);
+    __pyx_t_11 = (((*__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_node_type_vec.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_node_type_vec.diminfo[0].strides)) == 2) != 0);
     if (__pyx_t_11) {
 
-      /* "structureboost/structure_gb.pyx":1126
+      /* "structureboost/structure_gb.pyx":1124
  *             hot_index = cleft
  *         elif (node_type_vec[node_index]==2):
  *             hot_index = cright             # <<<<<<<<<<<<<<
  *             for k in range(num_cat_vals_vec[node_index]):
  *                 if x[split_index]==cat_vals_mat[node_index,k]:
  */
       __pyx_v_hot_index = __pyx_v_cright;
 
-      /* "structureboost/structure_gb.pyx":1127
+      /* "structureboost/structure_gb.pyx":1125
  *         elif (node_type_vec[node_index]==2):
  *             hot_index = cright
  *             for k in range(num_cat_vals_vec[node_index]):             # <<<<<<<<<<<<<<
  *                 if x[split_index]==cat_vals_mat[node_index,k]:
  *                     hot_index = cleft
  */
       __pyx_t_16 = __pyx_v_node_index;
-      __pyx_t_20 = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_num_cat_vals_vec.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_num_cat_vals_vec.diminfo[0].strides));
-      __pyx_t_21 = __pyx_t_20;
-      for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_21; __pyx_t_12+=1) {
-        __pyx_v_k = __pyx_t_12;
+      __pyx_t_12 = (*__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_num_cat_vals_vec.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_num_cat_vals_vec.diminfo[0].strides));
+      __pyx_t_13 = __pyx_t_12;
+      for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
+        __pyx_v_k = __pyx_t_14;
 
-        /* "structureboost/structure_gb.pyx":1128
+        /* "structureboost/structure_gb.pyx":1126
  *             hot_index = cright
  *             for k in range(num_cat_vals_vec[node_index]):
  *                 if x[split_index]==cat_vals_mat[node_index,k]:             # <<<<<<<<<<<<<<
  *                     hot_index = cleft
  *                     break
  */
         __pyx_t_16 = __pyx_v_split_index;
         __pyx_t_18 = __pyx_v_node_index;
         __pyx_t_15 = __pyx_v_k;
-        __pyx_t_11 = (((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_x.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_x.diminfo[0].strides)) == (*__Pyx_BufPtrStrided2d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_cat_vals_mat.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_cat_vals_mat.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_cat_vals_mat.diminfo[1].strides))) != 0);
+        __pyx_t_11 = (((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_x.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_x.diminfo[0].strides)) == (*__Pyx_BufPtrStrided2d(long *, __pyx_pybuffernd_cat_vals_mat.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_cat_vals_mat.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_cat_vals_mat.diminfo[1].strides))) != 0);
         if (__pyx_t_11) {
 
-          /* "structureboost/structure_gb.pyx":1129
+          /* "structureboost/structure_gb.pyx":1127
  *             for k in range(num_cat_vals_vec[node_index]):
  *                 if x[split_index]==cat_vals_mat[node_index,k]:
  *                     hot_index = cleft             # <<<<<<<<<<<<<<
  *                     break
  *         else:
  */
           __pyx_v_hot_index = __pyx_v_cleft;
 
-          /* "structureboost/structure_gb.pyx":1130
+          /* "structureboost/structure_gb.pyx":1128
  *                 if x[split_index]==cat_vals_mat[node_index,k]:
  *                     hot_index = cleft
  *                     break             # <<<<<<<<<<<<<<
  *         else:
  *             hot_index = cright
  */
           goto __pyx_L18_break;
 
-          /* "structureboost/structure_gb.pyx":1128
+          /* "structureboost/structure_gb.pyx":1126
  *             hot_index = cright
  *             for k in range(num_cat_vals_vec[node_index]):
  *                 if x[split_index]==cat_vals_mat[node_index,k]:             # <<<<<<<<<<<<<<
  *                     hot_index = cleft
  *                     break
  */
         }
       }
       __pyx_L18_break:;
 
-      /* "structureboost/structure_gb.pyx":1125
+      /* "structureboost/structure_gb.pyx":1123
  *         elif (node_type_vec[node_index]==1) and (x[split_index] < thresholds[node_index]): # (node_type_vec[node_index]==1) and
  *             hot_index = cleft
  *         elif (node_type_vec[node_index]==2):             # <<<<<<<<<<<<<<
  *             hot_index = cright
  *             for k in range(num_cat_vals_vec[node_index]):
  */
       goto __pyx_L14;
     }
 
-    /* "structureboost/structure_gb.pyx":1132
+    /* "structureboost/structure_gb.pyx":1130
  *                     break
  *         else:
  *             hot_index = cright             # <<<<<<<<<<<<<<
  *         cold_index = (cright if hot_index == cleft else cleft)
  *         w = node_sample_weight[node_index]
  */
     /*else*/ {
       __pyx_v_hot_index = __pyx_v_cright;
     }
     __pyx_L14:;
 
-    /* "structureboost/structure_gb.pyx":1133
+    /* "structureboost/structure_gb.pyx":1131
  *         else:
  *             hot_index = cright
  *         cold_index = (cright if hot_index == cleft else cleft)             # <<<<<<<<<<<<<<
  *         w = node_sample_weight[node_index]
  *         hot_zero_fraction = node_sample_weight[hot_index] / w
  */
     if (((__pyx_v_hot_index == __pyx_v_cleft) != 0)) {
       __pyx_t_12 = __pyx_v_cright;
     } else {
       __pyx_t_12 = __pyx_v_cleft;
     }
     __pyx_v_cold_index = __pyx_t_12;
 
-    /* "structureboost/structure_gb.pyx":1134
+    /* "structureboost/structure_gb.pyx":1132
  *             hot_index = cright
  *         cold_index = (cright if hot_index == cleft else cleft)
  *         w = node_sample_weight[node_index]             # <<<<<<<<<<<<<<
  *         hot_zero_fraction = node_sample_weight[hot_index] / w
  *         cold_zero_fraction = node_sample_weight[cold_index] / w
  */
     __pyx_t_15 = __pyx_v_node_index;
     __pyx_v_w = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_node_sample_weight.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_node_sample_weight.diminfo[0].strides));
 
-    /* "structureboost/structure_gb.pyx":1135
+    /* "structureboost/structure_gb.pyx":1133
  *         cold_index = (cright if hot_index == cleft else cleft)
  *         w = node_sample_weight[node_index]
  *         hot_zero_fraction = node_sample_weight[hot_index] / w             # <<<<<<<<<<<<<<
  *         cold_zero_fraction = node_sample_weight[cold_index] / w
  *         incoming_zero_fraction = 1
  */
     __pyx_t_15 = __pyx_v_hot_index;
     __pyx_v_hot_zero_fraction = ((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_node_sample_weight.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_node_sample_weight.diminfo[0].strides)) / __pyx_v_w);
 
-    /* "structureboost/structure_gb.pyx":1136
+    /* "structureboost/structure_gb.pyx":1134
  *         w = node_sample_weight[node_index]
  *         hot_zero_fraction = node_sample_weight[hot_index] / w
  *         cold_zero_fraction = node_sample_weight[cold_index] / w             # <<<<<<<<<<<<<<
  *         incoming_zero_fraction = 1
  *         incoming_one_fraction = 1
  */
     __pyx_t_15 = __pyx_v_cold_index;
     __pyx_v_cold_zero_fraction = ((*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_node_sample_weight.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_node_sample_weight.diminfo[0].strides)) / __pyx_v_w);
 
-    /* "structureboost/structure_gb.pyx":1137
+    /* "structureboost/structure_gb.pyx":1135
  *         hot_zero_fraction = node_sample_weight[hot_index] / w
  *         cold_zero_fraction = node_sample_weight[cold_index] / w
  *         incoming_zero_fraction = 1             # <<<<<<<<<<<<<<
  *         incoming_one_fraction = 1
  * 
  */
     __pyx_v_incoming_zero_fraction = 1.0;
 
-    /* "structureboost/structure_gb.pyx":1138
+    /* "structureboost/structure_gb.pyx":1136
  *         cold_zero_fraction = node_sample_weight[cold_index] / w
  *         incoming_zero_fraction = 1
  *         incoming_one_fraction = 1             # <<<<<<<<<<<<<<
  * 
  *         # see if we have already split on this feature,
  */
     __pyx_v_incoming_one_fraction = 1.0;
 
-    /* "structureboost/structure_gb.pyx":1142
+    /* "structureboost/structure_gb.pyx":1140
  *         # see if we have already split on this feature,
  *         # if so we undo that split so we can redo it for this node
  *         path_index = 0             # <<<<<<<<<<<<<<
  *         while (path_index <= unique_depth):
  *             if feature_indexes[path_index] == split_index:
  */
     __pyx_v_path_index = 0;
 
-    /* "structureboost/structure_gb.pyx":1143
+    /* "structureboost/structure_gb.pyx":1141
  *         # if so we undo that split so we can redo it for this node
  *         path_index = 0
  *         while (path_index <= unique_depth):             # <<<<<<<<<<<<<<
  *             if feature_indexes[path_index] == split_index:
  *                 break
  */
     while (1) {
       __pyx_t_11 = ((__pyx_v_path_index <= __pyx_v_unique_depth) != 0);
       if (!__pyx_t_11) break;
 
-      /* "structureboost/structure_gb.pyx":1144
+      /* "structureboost/structure_gb.pyx":1142
  *         path_index = 0
  *         while (path_index <= unique_depth):
  *             if feature_indexes[path_index] == split_index:             # <<<<<<<<<<<<<<
  *                 break
  *             path_index += 1
  */
       __pyx_t_15 = __pyx_v_path_index;
-      __pyx_t_11 = (((*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_12structure_gb_dtype_int64_t *, __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_feature_indexes.diminfo[0].strides)) == __pyx_v_split_index) != 0);
+      __pyx_t_11 = (((*__Pyx_BufPtrStrided1d(long *, __pyx_pybuffernd_feature_indexes.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_feature_indexes.diminfo[0].strides)) == __pyx_v_split_index) != 0);
       if (__pyx_t_11) {
 
-        /* "structureboost/structure_gb.pyx":1145
+        /* "structureboost/structure_gb.pyx":1143
  *         while (path_index <= unique_depth):
  *             if feature_indexes[path_index] == split_index:
  *                 break             # <<<<<<<<<<<<<<
  *             path_index += 1
  * 
  */
         goto __pyx_L21_break;
 
-        /* "structureboost/structure_gb.pyx":1144
+        /* "structureboost/structure_gb.pyx":1142
  *         path_index = 0
  *         while (path_index <= unique_depth):
  *             if feature_indexes[path_index] == split_index:             # <<<<<<<<<<<<<<
  *                 break
  *             path_index += 1
  */
       }
 
-      /* "structureboost/structure_gb.pyx":1146
+      /* "structureboost/structure_gb.pyx":1144
  *             if feature_indexes[path_index] == split_index:
  *                 break
  *             path_index += 1             # <<<<<<<<<<<<<<
  * 
  *         if path_index != unique_depth + 1:
  */
       __pyx_v_path_index = (__pyx_v_path_index + 1);
     }
     __pyx_L21_break:;
 
-    /* "structureboost/structure_gb.pyx":1148
+    /* "structureboost/structure_gb.pyx":1146
  *             path_index += 1
  * 
  *         if path_index != unique_depth + 1:             # <<<<<<<<<<<<<<
  *             incoming_zero_fraction = zero_fractions[path_index]
  *             incoming_one_fraction = one_fractions[path_index]
  */
     __pyx_t_11 = ((__pyx_v_path_index != (__pyx_v_unique_depth + 1)) != 0);
     if (__pyx_t_11) {
 
-      /* "structureboost/structure_gb.pyx":1149
+      /* "structureboost/structure_gb.pyx":1147
  * 
  *         if path_index != unique_depth + 1:
  *             incoming_zero_fraction = zero_fractions[path_index]             # <<<<<<<<<<<<<<
  *             incoming_one_fraction = one_fractions[path_index]
  *             unwind_path(feature_indexes, zero_fractions, one_fractions, pweights, unique_depth, path_index)
  */
       __pyx_t_15 = __pyx_v_path_index;
       __pyx_v_incoming_zero_fraction = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_zero_fractions.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_zero_fractions.diminfo[0].strides));
 
-      /* "structureboost/structure_gb.pyx":1150
+      /* "structureboost/structure_gb.pyx":1148
  *         if path_index != unique_depth + 1:
  *             incoming_zero_fraction = zero_fractions[path_index]
  *             incoming_one_fraction = one_fractions[path_index]             # <<<<<<<<<<<<<<
  *             unwind_path(feature_indexes, zero_fractions, one_fractions, pweights, unique_depth, path_index)
  *             unique_depth -= 1
  */
       __pyx_t_15 = __pyx_v_path_index;
       __pyx_v_incoming_one_fraction = (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_one_fractions.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_one_fractions.diminfo[0].strides));
 
-      /* "structureboost/structure_gb.pyx":1151
+      /* "structureboost/structure_gb.pyx":1149
  *             incoming_zero_fraction = zero_fractions[path_index]
  *             incoming_one_fraction = one_fractions[path_index]
  *             unwind_path(feature_indexes, zero_fractions, one_fractions, pweights, unique_depth, path_index)             # <<<<<<<<<<<<<<
  *             unique_depth -= 1
  * 
  */
-      __pyx_t_2 = __pyx_f_14structureboost_12structure_gb_unwind_path(((PyArrayObject *)__pyx_v_feature_indexes), ((PyArrayObject *)__pyx_v_zero_fractions), ((PyArrayObject *)__pyx_v_one_fractions), ((PyArrayObject *)__pyx_v_pweights), __pyx_v_unique_depth, __pyx_v_path_index); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1151, __pyx_L1_error)
+      __pyx_t_2 = __pyx_f_14structureboost_12structure_gb_unwind_path(((PyArrayObject *)__pyx_v_feature_indexes), ((PyArrayObject *)__pyx_v_zero_fractions), ((PyArrayObject *)__pyx_v_one_fractions), ((PyArrayObject *)__pyx_v_pweights), __pyx_v_unique_depth, __pyx_v_path_index); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1149, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-      /* "structureboost/structure_gb.pyx":1152
+      /* "structureboost/structure_gb.pyx":1150
  *             incoming_one_fraction = one_fractions[path_index]
  *             unwind_path(feature_indexes, zero_fractions, one_fractions, pweights, unique_depth, path_index)
  *             unique_depth -= 1             # <<<<<<<<<<<<<<
  * 
  *         # divide up the condition_fraction among the recursive calls
  */
       __pyx_v_unique_depth = (__pyx_v_unique_depth - 1);
 
-      /* "structureboost/structure_gb.pyx":1148
+      /* "structureboost/structure_gb.pyx":1146
  *             path_index += 1
  * 
  *         if path_index != unique_depth + 1:             # <<<<<<<<<<<<<<
  *             incoming_zero_fraction = zero_fractions[path_index]
  *             incoming_one_fraction = one_fractions[path_index]
  */
     }
 
-    /* "structureboost/structure_gb.pyx":1155
+    /* "structureboost/structure_gb.pyx":1153
  * 
  *         # divide up the condition_fraction among the recursive calls
  *         hot_condition_fraction = condition_fraction             # <<<<<<<<<<<<<<
  *         cold_condition_fraction = condition_fraction
  *         if condition > 0 and split_index == condition_feature:
  */
     __pyx_v_hot_condition_fraction = __pyx_v_condition_fraction;
 
-    /* "structureboost/structure_gb.pyx":1156
+    /* "structureboost/structure_gb.pyx":1154
  *         # divide up the condition_fraction among the recursive calls
  *         hot_condition_fraction = condition_fraction
  *         cold_condition_fraction = condition_fraction             # <<<<<<<<<<<<<<
  *         if condition > 0 and split_index == condition_feature:
  *             cold_condition_fraction = 0;
  */
     __pyx_v_cold_condition_fraction = __pyx_v_condition_fraction;
 
-    /* "structureboost/structure_gb.pyx":1157
+    /* "structureboost/structure_gb.pyx":1155
  *         hot_condition_fraction = condition_fraction
  *         cold_condition_fraction = condition_fraction
  *         if condition > 0 and split_index == condition_feature:             # <<<<<<<<<<<<<<
  *             cold_condition_fraction = 0;
  *             unique_depth -= 1
  */
     __pyx_t_17 = ((__pyx_v_condition > 0) != 0);
@@ -23809,43 +23795,43 @@
       goto __pyx_L25_bool_binop_done;
     }
     __pyx_t_17 = ((__pyx_v_split_index == __pyx_v_condition_feature) != 0);
     __pyx_t_11 = __pyx_t_17;
     __pyx_L25_bool_binop_done:;
     if (__pyx_t_11) {
 
-      /* "structureboost/structure_gb.pyx":1158
+      /* "structureboost/structure_gb.pyx":1156
  *         cold_condition_fraction = condition_fraction
  *         if condition > 0 and split_index == condition_feature:
  *             cold_condition_fraction = 0;             # <<<<<<<<<<<<<<
  *             unique_depth -= 1
  *         elif condition < 0 and split_index == condition_feature:
  */
       __pyx_v_cold_condition_fraction = 0.0;
 
-      /* "structureboost/structure_gb.pyx":1159
+      /* "structureboost/structure_gb.pyx":1157
  *         if condition > 0 and split_index == condition_feature:
  *             cold_condition_fraction = 0;
  *             unique_depth -= 1             # <<<<<<<<<<<<<<
  *         elif condition < 0 and split_index == condition_feature:
  *             hot_condition_fraction *= hot_zero_fraction
  */
       __pyx_v_unique_depth = (__pyx_v_unique_depth - 1);
 
-      /* "structureboost/structure_gb.pyx":1157
+      /* "structureboost/structure_gb.pyx":1155
  *         hot_condition_fraction = condition_fraction
  *         cold_condition_fraction = condition_fraction
  *         if condition > 0 and split_index == condition_feature:             # <<<<<<<<<<<<<<
  *             cold_condition_fraction = 0;
  *             unique_depth -= 1
  */
       goto __pyx_L24;
     }
 
-    /* "structureboost/structure_gb.pyx":1160
+    /* "structureboost/structure_gb.pyx":1158
  *             cold_condition_fraction = 0;
  *             unique_depth -= 1
  *         elif condition < 0 and split_index == condition_feature:             # <<<<<<<<<<<<<<
  *             hot_condition_fraction *= hot_zero_fraction
  *             cold_condition_fraction *= cold_zero_fraction
  */
     __pyx_t_17 = ((__pyx_v_condition < 0) != 0);
@@ -23855,81 +23841,81 @@
       goto __pyx_L27_bool_binop_done;
     }
     __pyx_t_17 = ((__pyx_v_split_index == __pyx_v_condition_feature) != 0);
     __pyx_t_11 = __pyx_t_17;
     __pyx_L27_bool_binop_done:;
     if (__pyx_t_11) {
 
-      /* "structureboost/structure_gb.pyx":1161
+      /* "structureboost/structure_gb.pyx":1159
  *             unique_depth -= 1
  *         elif condition < 0 and split_index == condition_feature:
  *             hot_condition_fraction *= hot_zero_fraction             # <<<<<<<<<<<<<<
  *             cold_condition_fraction *= cold_zero_fraction
  *             unique_depth -= 1
  */
       __pyx_v_hot_condition_fraction = (__pyx_v_hot_condition_fraction * __pyx_v_hot_zero_fraction);
 
-      /* "structureboost/structure_gb.pyx":1162
+      /* "structureboost/structure_gb.pyx":1160
  *         elif condition < 0 and split_index == condition_feature:
  *             hot_condition_fraction *= hot_zero_fraction
  *             cold_condition_fraction *= cold_zero_fraction             # <<<<<<<<<<<<<<
  *             unique_depth -= 1
  * 
  */
       __pyx_v_cold_condition_fraction = (__pyx_v_cold_condition_fraction * __pyx_v_cold_zero_fraction);
 
-      /* "structureboost/structure_gb.pyx":1163
+      /* "structureboost/structure_gb.pyx":1161
  *             hot_condition_fraction *= hot_zero_fraction
  *             cold_condition_fraction *= cold_zero_fraction
  *             unique_depth -= 1             # <<<<<<<<<<<<<<
  * 
  *         tree_shap_recursive(
  */
       __pyx_v_unique_depth = (__pyx_v_unique_depth - 1);
 
-      /* "structureboost/structure_gb.pyx":1160
+      /* "structureboost/structure_gb.pyx":1158
  *             cold_condition_fraction = 0;
  *             unique_depth -= 1
  *         elif condition < 0 and split_index == condition_feature:             # <<<<<<<<<<<<<<
  *             hot_condition_fraction *= hot_zero_fraction
  *             cold_condition_fraction *= cold_zero_fraction
  */
     }
     __pyx_L24:;
 
-    /* "structureboost/structure_gb.pyx":1165
+    /* "structureboost/structure_gb.pyx":1163
  *             unique_depth -= 1
  * 
  *         tree_shap_recursive(             # <<<<<<<<<<<<<<
  *             children_left, children_right, children_default, features,
  *             node_type_vec, num_cat_vals_vec, cat_vals_mat,
  */
-    __pyx_t_2 = __pyx_f_14structureboost_12structure_gb_tree_shap_recursive(__pyx_v_children_left, __pyx_v_children_right, __pyx_v_children_default, __pyx_v_features, __pyx_v_node_type_vec, __pyx_v_num_cat_vals_vec, __pyx_v_cat_vals_mat, __pyx_v_thresholds, __pyx_v_values, __pyx_v_node_sample_weight, __pyx_v_x, __pyx_v_x_missing, __pyx_v_phi, __pyx_v_hot_index, (__pyx_v_unique_depth + 1), ((PyArrayObject *)__pyx_v_feature_indexes), ((PyArrayObject *)__pyx_v_zero_fractions), ((PyArrayObject *)__pyx_v_one_fractions), ((PyArrayObject *)__pyx_v_pweights), (__pyx_v_hot_zero_fraction * __pyx_v_incoming_zero_fraction), __pyx_v_incoming_one_fraction, __pyx_v_split_index, __pyx_v_condition, __pyx_v_condition_feature, __pyx_v_hot_condition_fraction); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1165, __pyx_L1_error)
+    __pyx_t_2 = __pyx_f_14structureboost_12structure_gb_tree_shap_recursive(__pyx_v_children_left, __pyx_v_children_right, __pyx_v_children_default, __pyx_v_features, __pyx_v_node_type_vec, __pyx_v_num_cat_vals_vec, __pyx_v_cat_vals_mat, __pyx_v_thresholds, __pyx_v_values, __pyx_v_node_sample_weight, __pyx_v_x, __pyx_v_x_missing, __pyx_v_phi, __pyx_v_hot_index, (__pyx_v_unique_depth + 1), ((PyArrayObject *)__pyx_v_feature_indexes), ((PyArrayObject *)__pyx_v_zero_fractions), ((PyArrayObject *)__pyx_v_one_fractions), ((PyArrayObject *)__pyx_v_pweights), (__pyx_v_hot_zero_fraction * __pyx_v_incoming_zero_fraction), __pyx_v_incoming_one_fraction, __pyx_v_split_index, __pyx_v_condition, __pyx_v_condition_feature, __pyx_v_hot_condition_fraction); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1163, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "structureboost/structure_gb.pyx":1175
+    /* "structureboost/structure_gb.pyx":1173
  *         )
  * 
  *         tree_shap_recursive(             # <<<<<<<<<<<<<<
  *             children_left, children_right, children_default, features,
  *             node_type_vec, num_cat_vals_vec, cat_vals_mat,
  */
-    __pyx_t_2 = __pyx_f_14structureboost_12structure_gb_tree_shap_recursive(__pyx_v_children_left, __pyx_v_children_right, __pyx_v_children_default, __pyx_v_features, __pyx_v_node_type_vec, __pyx_v_num_cat_vals_vec, __pyx_v_cat_vals_mat, __pyx_v_thresholds, __pyx_v_values, __pyx_v_node_sample_weight, __pyx_v_x, __pyx_v_x_missing, __pyx_v_phi, __pyx_v_cold_index, (__pyx_v_unique_depth + 1), ((PyArrayObject *)__pyx_v_feature_indexes), ((PyArrayObject *)__pyx_v_zero_fractions), ((PyArrayObject *)__pyx_v_one_fractions), ((PyArrayObject *)__pyx_v_pweights), (__pyx_v_cold_zero_fraction * __pyx_v_incoming_zero_fraction), 0.0, __pyx_v_split_index, __pyx_v_condition, __pyx_v_condition_feature, __pyx_v_cold_condition_fraction); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1175, __pyx_L1_error)
+    __pyx_t_2 = __pyx_f_14structureboost_12structure_gb_tree_shap_recursive(__pyx_v_children_left, __pyx_v_children_right, __pyx_v_children_default, __pyx_v_features, __pyx_v_node_type_vec, __pyx_v_num_cat_vals_vec, __pyx_v_cat_vals_mat, __pyx_v_thresholds, __pyx_v_values, __pyx_v_node_sample_weight, __pyx_v_x, __pyx_v_x_missing, __pyx_v_phi, __pyx_v_cold_index, (__pyx_v_unique_depth + 1), ((PyArrayObject *)__pyx_v_feature_indexes), ((PyArrayObject *)__pyx_v_zero_fractions), ((PyArrayObject *)__pyx_v_one_fractions), ((PyArrayObject *)__pyx_v_pweights), (__pyx_v_cold_zero_fraction * __pyx_v_incoming_zero_fraction), 0.0, __pyx_v_split_index, __pyx_v_condition, __pyx_v_condition_feature, __pyx_v_cold_condition_fraction); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1173, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   }
   __pyx_L11:;
 
-  /* "structureboost/structure_gb.pyx":1034
+  /* "structureboost/structure_gb.pyx":1032
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * @cython.cdivision(True)
- * cdef tree_shap_recursive(np.ndarray[dtype_int64_t] children_left,             # <<<<<<<<<<<<<<
- *                         np.ndarray[dtype_int64_t] children_right,
- *                         np.ndarray[dtype_int64_t] children_default,
+ * cdef tree_shap_recursive(np.ndarray[long] children_left,             # <<<<<<<<<<<<<<
+ *                         np.ndarray[long] children_right,
+ *                         np.ndarray[long] children_default,
  */
 
   /* function exit code */
   __pyx_r = Py_None; __Pyx_INCREF(Py_None);
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_2);
@@ -23995,15 +23981,15 @@
   __Pyx_XDECREF((PyObject *)__pyx_v_pweights);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":1185
+/* "structureboost/structure_gb.pyx":1183
  *         )
  * 
  * def tree_shap_single_pt(dt_mat_int, dt_mat_float,  dt_max_depth, X_in, condition=0, condition_feature=0):             # <<<<<<<<<<<<<<
  * 
  *     x_missing = np.isnan(X_in).astype(int)
  */
 
@@ -24052,27 +24038,27 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_dt_mat_int)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_dt_mat_float)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("tree_shap_single_pt", 0, 4, 6, 1); __PYX_ERR(0, 1185, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("tree_shap_single_pt", 0, 4, 6, 1); __PYX_ERR(0, 1183, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_dt_max_depth)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("tree_shap_single_pt", 0, 4, 6, 2); __PYX_ERR(0, 1185, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("tree_shap_single_pt", 0, 4, 6, 2); __PYX_ERR(0, 1183, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X_in)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("tree_shap_single_pt", 0, 4, 6, 3); __PYX_ERR(0, 1185, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("tree_shap_single_pt", 0, 4, 6, 3); __PYX_ERR(0, 1183, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_condition);
           if (value) { values[4] = value; kw_args--; }
         }
@@ -24080,15 +24066,15 @@
         case  5:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_condition_feature);
           if (value) { values[5] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "tree_shap_single_pt") < 0)) __PYX_ERR(0, 1185, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "tree_shap_single_pt") < 0)) __PYX_ERR(0, 1183, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  6: values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
         CYTHON_FALLTHROUGH;
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
@@ -24105,15 +24091,15 @@
     __pyx_v_dt_max_depth = values[2];
     __pyx_v_X_in = values[3];
     __pyx_v_condition = values[4];
     __pyx_v_condition_feature = values[5];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("tree_shap_single_pt", 0, 4, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1185, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("tree_shap_single_pt", 0, 4, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1183, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.tree_shap_single_pt", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_22tree_shap_single_pt(__pyx_self, __pyx_v_dt_mat_int, __pyx_v_dt_mat_float, __pyx_v_dt_max_depth, __pyx_v_X_in, __pyx_v_condition, __pyx_v_condition_feature);
 
@@ -24155,411 +24141,411 @@
   long __pyx_t_8;
   long __pyx_t_9;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__46)
   __Pyx_RefNannySetupContext("tree_shap_single_pt", 0);
-  __Pyx_TraceCall("tree_shap_single_pt", __pyx_f[0], 1185, 0, __PYX_ERR(0, 1185, __pyx_L1_error));
+  __Pyx_TraceCall("tree_shap_single_pt", __pyx_f[0], 1183, 0, __PYX_ERR(0, 1183, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":1187
+  /* "structureboost/structure_gb.pyx":1185
  * def tree_shap_single_pt(dt_mat_int, dt_mat_float,  dt_max_depth, X_in, condition=0, condition_feature=0):
  * 
  *     x_missing = np.isnan(X_in).astype(int)             # <<<<<<<<<<<<<<
  *     # Extract tree info from the matrix/tensor representation
  *     dt_thresholds = dt_mat_float[:,0]
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1187, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1185, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_isnan); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1187, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_isnan); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1185, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_v_X_in) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_X_in);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1187, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1185, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1187, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1185, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, ((PyObject *)(&PyInt_Type))) : __Pyx_PyObject_CallOneArg(__pyx_t_4, ((PyObject *)(&PyInt_Type)));
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1187, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1185, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_x_missing = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1189
+  /* "structureboost/structure_gb.pyx":1187
  *     x_missing = np.isnan(X_in).astype(int)
  *     # Extract tree info from the matrix/tensor representation
  *     dt_thresholds = dt_mat_float[:,0]             # <<<<<<<<<<<<<<
  *     dt_node_weights = dt_mat_float[:,1]
  *     dt_node_vals = dt_mat_float[:,2] # for a single valued output
  */
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_float, __pyx_tuple__47); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1189, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_float, __pyx_tuple__47); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1187, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_dt_thresholds = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1190
+  /* "structureboost/structure_gb.pyx":1188
  *     # Extract tree info from the matrix/tensor representation
  *     dt_thresholds = dt_mat_float[:,0]
  *     dt_node_weights = dt_mat_float[:,1]             # <<<<<<<<<<<<<<
  *     dt_node_vals = dt_mat_float[:,2] # for a single valued output
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_float, __pyx_tuple__6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1190, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_float, __pyx_tuple__6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1188, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_dt_node_weights = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1191
+  /* "structureboost/structure_gb.pyx":1189
  *     dt_thresholds = dt_mat_float[:,0]
  *     dt_node_weights = dt_mat_float[:,1]
  *     dt_node_vals = dt_mat_float[:,2] # for a single valued output             # <<<<<<<<<<<<<<
  * 
  *     dt_node_type = dt_mat_int[:,0]
  */
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_float, __pyx_tuple__48); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1191, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_float, __pyx_tuple__48); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1189, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_dt_node_vals = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1193
+  /* "structureboost/structure_gb.pyx":1191
  *     dt_node_vals = dt_mat_float[:,2] # for a single valued output
  * 
  *     dt_node_type = dt_mat_int[:,0]             # <<<<<<<<<<<<<<
  *     dt_features = dt_mat_int[:,1]
  *     dt_left_children = dt_mat_int[:,2]
  */
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_int, __pyx_tuple__47); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1193, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_int, __pyx_tuple__47); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1191, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_dt_node_type = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1194
+  /* "structureboost/structure_gb.pyx":1192
  * 
  *     dt_node_type = dt_mat_int[:,0]
  *     dt_features = dt_mat_int[:,1]             # <<<<<<<<<<<<<<
  *     dt_left_children = dt_mat_int[:,2]
  *     dt_right_children = dt_mat_int[:,3]
  */
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_int, __pyx_tuple__6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1194, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_int, __pyx_tuple__6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1192, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_dt_features = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1195
+  /* "structureboost/structure_gb.pyx":1193
  *     dt_node_type = dt_mat_int[:,0]
  *     dt_features = dt_mat_int[:,1]
  *     dt_left_children = dt_mat_int[:,2]             # <<<<<<<<<<<<<<
  *     dt_right_children = dt_mat_int[:,3]
  *     dt_na_left = dt_mat_int[:,4]
  */
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_int, __pyx_tuple__48); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1195, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_int, __pyx_tuple__48); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1193, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_dt_left_children = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1196
+  /* "structureboost/structure_gb.pyx":1194
  *     dt_features = dt_mat_int[:,1]
  *     dt_left_children = dt_mat_int[:,2]
  *     dt_right_children = dt_mat_int[:,3]             # <<<<<<<<<<<<<<
  *     dt_na_left = dt_mat_int[:,4]
  *     dt_default_children = dt_na_left*dt_left_children + (1-dt_na_left)*dt_right_children
  */
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_int, __pyx_tuple__49); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1196, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_int, __pyx_tuple__49); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1194, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_dt_right_children = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1197
+  /* "structureboost/structure_gb.pyx":1195
  *     dt_left_children = dt_mat_int[:,2]
  *     dt_right_children = dt_mat_int[:,3]
  *     dt_na_left = dt_mat_int[:,4]             # <<<<<<<<<<<<<<
  *     dt_default_children = dt_na_left*dt_left_children + (1-dt_na_left)*dt_right_children
  *     dt_num_cat_vals = dt_mat_int[:,5]
  */
-  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_int, __pyx_tuple__50); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1197, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_int, __pyx_tuple__50); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1195, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_dt_na_left = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1198
+  /* "structureboost/structure_gb.pyx":1196
  *     dt_right_children = dt_mat_int[:,3]
  *     dt_na_left = dt_mat_int[:,4]
  *     dt_default_children = dt_na_left*dt_left_children + (1-dt_na_left)*dt_right_children             # <<<<<<<<<<<<<<
  *     dt_num_cat_vals = dt_mat_int[:,5]
  *     dt_cat_vals_mat = dt_mat_int[:,6:]
  */
-  __pyx_t_1 = PyNumber_Multiply(__pyx_v_dt_na_left, __pyx_v_dt_left_children); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1198, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_v_dt_na_left, __pyx_v_dt_left_children); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1196, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_dt_na_left, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1198, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_dt_na_left, 1, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1196, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_t_4, __pyx_v_dt_right_children); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1198, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_t_4, __pyx_v_dt_right_children); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1196, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1198, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1196, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_dt_default_children = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "structureboost/structure_gb.pyx":1199
+  /* "structureboost/structure_gb.pyx":1197
  *     dt_na_left = dt_mat_int[:,4]
  *     dt_default_children = dt_na_left*dt_left_children + (1-dt_na_left)*dt_right_children
  *     dt_num_cat_vals = dt_mat_int[:,5]             # <<<<<<<<<<<<<<
  *     dt_cat_vals_mat = dt_mat_int[:,6:]
  * 
  */
-  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_int, __pyx_tuple__51); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1199, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_int, __pyx_tuple__51); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1197, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_v_dt_num_cat_vals = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "structureboost/structure_gb.pyx":1200
+  /* "structureboost/structure_gb.pyx":1198
  *     dt_default_children = dt_na_left*dt_left_children + (1-dt_na_left)*dt_right_children
  *     dt_num_cat_vals = dt_mat_int[:,5]
  *     dt_cat_vals_mat = dt_mat_int[:,6:]             # <<<<<<<<<<<<<<
  * 
  *     # Initialize tracking vectors
  */
-  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_int, __pyx_tuple__53); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1200, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_v_dt_mat_int, __pyx_tuple__53); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1198, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_v_dt_cat_vals_mat = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "structureboost/structure_gb.pyx":1203
+  /* "structureboost/structure_gb.pyx":1201
  * 
  *     # Initialize tracking vectors
  *     s = (dt_max_depth+2)*(dt_max_depth+1)             # <<<<<<<<<<<<<<
- *     feature_indexes = np.zeros(s, dtype=np.int64)
+ *     feature_indexes = np.zeros(s, dtype=np.int_)
  *     zero_fractions = np.zeros(s, dtype=np.float64)
  */
-  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_v_dt_max_depth, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1203, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyInt_AddObjC(__pyx_v_dt_max_depth, __pyx_int_2, 2, 0, 0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1201, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_dt_max_depth, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1203, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_AddObjC(__pyx_v_dt_max_depth, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1201, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1203, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1201, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_s = __pyx_t_1;
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1204
+  /* "structureboost/structure_gb.pyx":1202
  *     # Initialize tracking vectors
  *     s = (dt_max_depth+2)*(dt_max_depth+1)
- *     feature_indexes = np.zeros(s, dtype=np.int64)             # <<<<<<<<<<<<<<
+ *     feature_indexes = np.zeros(s, dtype=np.int_)             # <<<<<<<<<<<<<<
  *     zero_fractions = np.zeros(s, dtype=np.float64)
  *     one_fractions = np.zeros(s, dtype=np.float64)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1204, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1202, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1204, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1202, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1204, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1202, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_s);
   __Pyx_GIVEREF(__pyx_v_s);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_s);
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1204, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1202, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1204, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1202, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_int64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1204, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_int); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1202, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1204, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1202, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1204, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1202, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_feature_indexes = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "structureboost/structure_gb.pyx":1205
+  /* "structureboost/structure_gb.pyx":1203
  *     s = (dt_max_depth+2)*(dt_max_depth+1)
- *     feature_indexes = np.zeros(s, dtype=np.int64)
+ *     feature_indexes = np.zeros(s, dtype=np.int_)
  *     zero_fractions = np.zeros(s, dtype=np.float64)             # <<<<<<<<<<<<<<
  *     one_fractions = np.zeros(s, dtype=np.float64)
  *     pweights = np.zeros(s, dtype=np.float64)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1205, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1203, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1205, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1203, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1205, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1203, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_INCREF(__pyx_v_s);
   __Pyx_GIVEREF(__pyx_v_s);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_v_s);
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1205, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1203, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1205, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1203, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1205, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1203, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 1205, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 1203, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1205, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1203, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_zero_fractions = __pyx_t_3;
   __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":1206
- *     feature_indexes = np.zeros(s, dtype=np.int64)
+  /* "structureboost/structure_gb.pyx":1204
+ *     feature_indexes = np.zeros(s, dtype=np.int_)
  *     zero_fractions = np.zeros(s, dtype=np.float64)
  *     one_fractions = np.zeros(s, dtype=np.float64)             # <<<<<<<<<<<<<<
  *     pweights = np.zeros(s, dtype=np.float64)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1206, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1204, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1206, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1204, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1206, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1204, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_s);
   __Pyx_GIVEREF(__pyx_v_s);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_s);
-  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1206, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1204, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1206, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1204, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1206, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1204, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 1206, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 1204, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1206, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1204, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_v_one_fractions = __pyx_t_2;
   __pyx_t_2 = 0;
 
-  /* "structureboost/structure_gb.pyx":1207
+  /* "structureboost/structure_gb.pyx":1205
  *     zero_fractions = np.zeros(s, dtype=np.float64)
  *     one_fractions = np.zeros(s, dtype=np.float64)
  *     pweights = np.zeros(s, dtype=np.float64)             # <<<<<<<<<<<<<<
  * 
  *     phi = np.zeros(len(X_in)+1) # Assuming single value output
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1207, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1205, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1207, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1205, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1207, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1205, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_INCREF(__pyx_v_s);
   __Pyx_GIVEREF(__pyx_v_s);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_v_s);
-  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1207, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1205, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1207, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1205, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1207, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1205, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1207, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1205, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1207, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1205, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_pweights = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "structureboost/structure_gb.pyx":1209
+  /* "structureboost/structure_gb.pyx":1207
  *     pweights = np.zeros(s, dtype=np.float64)
  * 
  *     phi = np.zeros(len(X_in)+1) # Assuming single value output             # <<<<<<<<<<<<<<
  *     root_val = (np.sum((dt_node_type==0) * (dt_node_weights) * dt_node_vals) /
  *                 np.sum((dt_node_type==0) * (dt_node_weights)) )
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1209, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1207, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1209, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1207, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_6 = PyObject_Length(__pyx_v_X_in); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1209, __pyx_L1_error)
-  __pyx_t_3 = PyInt_FromSsize_t((__pyx_t_6 + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1209, __pyx_L1_error)
+  __pyx_t_6 = PyObject_Length(__pyx_v_X_in); if (unlikely(__pyx_t_6 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1207, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t((__pyx_t_6 + 1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1207, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1209, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1207, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_phi = __pyx_t_4;
   __pyx_t_4 = 0;
 
-  /* "structureboost/structure_gb.pyx":1210
+  /* "structureboost/structure_gb.pyx":1208
  * 
  *     phi = np.zeros(len(X_in)+1) # Assuming single value output
  *     root_val = (np.sum((dt_node_type==0) * (dt_node_weights) * dt_node_vals) /             # <<<<<<<<<<<<<<
  *                 np.sum((dt_node_type==0) * (dt_node_weights)) )
  *     # update the bias term, which is the last index in phi
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1210, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1208, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1210, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1208, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_v_dt_node_type, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1210, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_v_dt_node_type, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1208, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = PyNumber_Multiply(__pyx_t_2, __pyx_v_dt_node_weights); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1210, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Multiply(__pyx_t_2, __pyx_v_dt_node_weights); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1208, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Multiply(__pyx_t_5, __pyx_v_dt_node_vals); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1210, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_t_5, __pyx_v_dt_node_vals); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1208, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -24567,33 +24553,33 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1210, __pyx_L1_error)
+  if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1208, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":1211
+  /* "structureboost/structure_gb.pyx":1209
  *     phi = np.zeros(len(X_in)+1) # Assuming single value output
  *     root_val = (np.sum((dt_node_type==0) * (dt_node_weights) * dt_node_vals) /
  *                 np.sum((dt_node_type==0) * (dt_node_weights)) )             # <<<<<<<<<<<<<<
  *     # update the bias term, which is the last index in phi
  *     # (note the paper has this as phi_0 instead of phi_M)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1211, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1209, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1211, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_sum); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1209, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_v_dt_node_type, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1211, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_v_dt_node_type, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1209, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_v_dt_node_weights); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1211, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_2, __pyx_v_dt_node_weights); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1209, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
@@ -24601,153 +24587,153 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1211, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1209, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-  /* "structureboost/structure_gb.pyx":1210
+  /* "structureboost/structure_gb.pyx":1208
  * 
  *     phi = np.zeros(len(X_in)+1) # Assuming single value output
  *     root_val = (np.sum((dt_node_type==0) * (dt_node_weights) * dt_node_vals) /             # <<<<<<<<<<<<<<
  *                 np.sum((dt_node_type==0) * (dt_node_weights)) )
  *     # update the bias term, which is the last index in phi
  */
-  __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1210, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1208, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_root_val = __pyx_t_5;
   __pyx_t_5 = 0;
 
-  /* "structureboost/structure_gb.pyx":1214
+  /* "structureboost/structure_gb.pyx":1212
  *     # update the bias term, which is the last index in phi
  *     # (note the paper has this as phi_0 instead of phi_M)
  *     if condition == 0:             # <<<<<<<<<<<<<<
  *         phi[-1] +=  root_val # Assuming single value output
  * 
  */
-  __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_v_condition, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1214, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_EqObjC(__pyx_v_condition, __pyx_int_0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1212, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1214, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 1212, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   if (__pyx_t_7) {
 
-    /* "structureboost/structure_gb.pyx":1215
+    /* "structureboost/structure_gb.pyx":1213
  *     # (note the paper has this as phi_0 instead of phi_M)
  *     if condition == 0:
  *         phi[-1] +=  root_val # Assuming single value output             # <<<<<<<<<<<<<<
  * 
  *     # start the recursive algorithm
  */
     __pyx_t_6 = -1L;
-    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_phi, __pyx_t_6, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1215, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_phi, __pyx_t_6, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1213, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_t_5, __pyx_v_root_val); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1215, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_InPlaceAdd(__pyx_t_5, __pyx_v_root_val); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1213, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(__Pyx_SetItemInt(__pyx_v_phi, __pyx_t_6, __pyx_t_3, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1) < 0)) __PYX_ERR(0, 1215, __pyx_L1_error)
+    if (unlikely(__Pyx_SetItemInt(__pyx_v_phi, __pyx_t_6, __pyx_t_3, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 1, 1) < 0)) __PYX_ERR(0, 1213, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "structureboost/structure_gb.pyx":1214
+    /* "structureboost/structure_gb.pyx":1212
  *     # update the bias term, which is the last index in phi
  *     # (note the paper has this as phi_0 instead of phi_M)
  *     if condition == 0:             # <<<<<<<<<<<<<<
  *         phi[-1] +=  root_val # Assuming single value output
  * 
  */
   }
 
-  /* "structureboost/structure_gb.pyx":1219
+  /* "structureboost/structure_gb.pyx":1217
  *     # start the recursive algorithm
  *     tree_shap_recursive(
  *         dt_left_children, dt_right_children, dt_default_children, dt_features,             # <<<<<<<<<<<<<<
  *         dt_node_type, dt_num_cat_vals, dt_cat_vals_mat,
  *         dt_thresholds, dt_node_vals, dt_node_weights,
  */
-  if (!(likely(((__pyx_v_dt_left_children) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_left_children, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1219, __pyx_L1_error)
-  if (!(likely(((__pyx_v_dt_right_children) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_right_children, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1219, __pyx_L1_error)
-  if (!(likely(((__pyx_v_dt_default_children) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_default_children, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1219, __pyx_L1_error)
-  if (!(likely(((__pyx_v_dt_features) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_features, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1219, __pyx_L1_error)
+  if (!(likely(((__pyx_v_dt_left_children) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_left_children, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1217, __pyx_L1_error)
+  if (!(likely(((__pyx_v_dt_right_children) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_right_children, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1217, __pyx_L1_error)
+  if (!(likely(((__pyx_v_dt_default_children) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_default_children, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1217, __pyx_L1_error)
+  if (!(likely(((__pyx_v_dt_features) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_features, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1217, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":1220
+  /* "structureboost/structure_gb.pyx":1218
  *     tree_shap_recursive(
  *         dt_left_children, dt_right_children, dt_default_children, dt_features,
  *         dt_node_type, dt_num_cat_vals, dt_cat_vals_mat,             # <<<<<<<<<<<<<<
  *         dt_thresholds, dt_node_vals, dt_node_weights,
  *         X_in, x_missing, phi, 0, 0, feature_indexes, zero_fractions, one_fractions, pweights,
  */
-  if (!(likely(((__pyx_v_dt_node_type) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_node_type, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1220, __pyx_L1_error)
-  if (!(likely(((__pyx_v_dt_num_cat_vals) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_num_cat_vals, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1220, __pyx_L1_error)
-  if (!(likely(((__pyx_v_dt_cat_vals_mat) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_cat_vals_mat, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1220, __pyx_L1_error)
+  if (!(likely(((__pyx_v_dt_node_type) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_node_type, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1218, __pyx_L1_error)
+  if (!(likely(((__pyx_v_dt_num_cat_vals) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_num_cat_vals, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1218, __pyx_L1_error)
+  if (!(likely(((__pyx_v_dt_cat_vals_mat) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_cat_vals_mat, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1218, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":1221
+  /* "structureboost/structure_gb.pyx":1219
  *         dt_left_children, dt_right_children, dt_default_children, dt_features,
  *         dt_node_type, dt_num_cat_vals, dt_cat_vals_mat,
  *         dt_thresholds, dt_node_vals, dt_node_weights,             # <<<<<<<<<<<<<<
  *         X_in, x_missing, phi, 0, 0, feature_indexes, zero_fractions, one_fractions, pweights,
  *         1, 1, -1, condition, condition_feature, 1
  */
-  if (!(likely(((__pyx_v_dt_thresholds) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_thresholds, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1221, __pyx_L1_error)
-  if (!(likely(((__pyx_v_dt_node_vals) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_node_vals, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1221, __pyx_L1_error)
-  if (!(likely(((__pyx_v_dt_node_weights) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_node_weights, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1221, __pyx_L1_error)
+  if (!(likely(((__pyx_v_dt_thresholds) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_thresholds, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1219, __pyx_L1_error)
+  if (!(likely(((__pyx_v_dt_node_vals) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_node_vals, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1219, __pyx_L1_error)
+  if (!(likely(((__pyx_v_dt_node_weights) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_dt_node_weights, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1219, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":1222
+  /* "structureboost/structure_gb.pyx":1220
  *         dt_node_type, dt_num_cat_vals, dt_cat_vals_mat,
  *         dt_thresholds, dt_node_vals, dt_node_weights,
  *         X_in, x_missing, phi, 0, 0, feature_indexes, zero_fractions, one_fractions, pweights,             # <<<<<<<<<<<<<<
  *         1, 1, -1, condition, condition_feature, 1
  *     )
  */
-  if (!(likely(((__pyx_v_X_in) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_X_in, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1222, __pyx_L1_error)
-  if (!(likely(((__pyx_v_x_missing) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_x_missing, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1222, __pyx_L1_error)
-  if (!(likely(((__pyx_v_phi) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_phi, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1222, __pyx_L1_error)
-  if (!(likely(((__pyx_v_feature_indexes) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_feature_indexes, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1222, __pyx_L1_error)
-  if (!(likely(((__pyx_v_zero_fractions) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_zero_fractions, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1222, __pyx_L1_error)
-  if (!(likely(((__pyx_v_one_fractions) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_one_fractions, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1222, __pyx_L1_error)
-  if (!(likely(((__pyx_v_pweights) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_pweights, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1222, __pyx_L1_error)
+  if (!(likely(((__pyx_v_X_in) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_X_in, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1220, __pyx_L1_error)
+  if (!(likely(((__pyx_v_x_missing) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_x_missing, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1220, __pyx_L1_error)
+  if (!(likely(((__pyx_v_phi) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_phi, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1220, __pyx_L1_error)
+  if (!(likely(((__pyx_v_feature_indexes) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_feature_indexes, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1220, __pyx_L1_error)
+  if (!(likely(((__pyx_v_zero_fractions) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_zero_fractions, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1220, __pyx_L1_error)
+  if (!(likely(((__pyx_v_one_fractions) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_one_fractions, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1220, __pyx_L1_error)
+  if (!(likely(((__pyx_v_pweights) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_pweights, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1220, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":1223
+  /* "structureboost/structure_gb.pyx":1221
  *         dt_thresholds, dt_node_vals, dt_node_weights,
  *         X_in, x_missing, phi, 0, 0, feature_indexes, zero_fractions, one_fractions, pweights,
  *         1, 1, -1, condition, condition_feature, 1             # <<<<<<<<<<<<<<
  *     )
  * 
  */
-  __pyx_t_8 = __Pyx_PyInt_As_long(__pyx_v_condition); if (unlikely((__pyx_t_8 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1223, __pyx_L1_error)
-  __pyx_t_9 = __Pyx_PyInt_As_long(__pyx_v_condition_feature); if (unlikely((__pyx_t_9 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1223, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyInt_As_long(__pyx_v_condition); if (unlikely((__pyx_t_8 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1221, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyInt_As_long(__pyx_v_condition_feature); if (unlikely((__pyx_t_9 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1221, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":1218
+  /* "structureboost/structure_gb.pyx":1216
  * 
  *     # start the recursive algorithm
  *     tree_shap_recursive(             # <<<<<<<<<<<<<<
  *         dt_left_children, dt_right_children, dt_default_children, dt_features,
  *         dt_node_type, dt_num_cat_vals, dt_cat_vals_mat,
  */
-  __pyx_t_3 = __pyx_f_14structureboost_12structure_gb_tree_shap_recursive(((PyArrayObject *)__pyx_v_dt_left_children), ((PyArrayObject *)__pyx_v_dt_right_children), ((PyArrayObject *)__pyx_v_dt_default_children), ((PyArrayObject *)__pyx_v_dt_features), ((PyArrayObject *)__pyx_v_dt_node_type), ((PyArrayObject *)__pyx_v_dt_num_cat_vals), ((PyArrayObject *)__pyx_v_dt_cat_vals_mat), ((PyArrayObject *)__pyx_v_dt_thresholds), ((PyArrayObject *)__pyx_v_dt_node_vals), ((PyArrayObject *)__pyx_v_dt_node_weights), ((PyArrayObject *)__pyx_v_X_in), ((PyArrayObject *)__pyx_v_x_missing), ((PyArrayObject *)__pyx_v_phi), 0, 0, ((PyArrayObject *)__pyx_v_feature_indexes), ((PyArrayObject *)__pyx_v_zero_fractions), ((PyArrayObject *)__pyx_v_one_fractions), ((PyArrayObject *)__pyx_v_pweights), 1.0, 1.0, -1L, __pyx_t_8, __pyx_t_9, 1.0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1218, __pyx_L1_error)
+  __pyx_t_3 = __pyx_f_14structureboost_12structure_gb_tree_shap_recursive(((PyArrayObject *)__pyx_v_dt_left_children), ((PyArrayObject *)__pyx_v_dt_right_children), ((PyArrayObject *)__pyx_v_dt_default_children), ((PyArrayObject *)__pyx_v_dt_features), ((PyArrayObject *)__pyx_v_dt_node_type), ((PyArrayObject *)__pyx_v_dt_num_cat_vals), ((PyArrayObject *)__pyx_v_dt_cat_vals_mat), ((PyArrayObject *)__pyx_v_dt_thresholds), ((PyArrayObject *)__pyx_v_dt_node_vals), ((PyArrayObject *)__pyx_v_dt_node_weights), ((PyArrayObject *)__pyx_v_X_in), ((PyArrayObject *)__pyx_v_x_missing), ((PyArrayObject *)__pyx_v_phi), 0, 0, ((PyArrayObject *)__pyx_v_feature_indexes), ((PyArrayObject *)__pyx_v_zero_fractions), ((PyArrayObject *)__pyx_v_one_fractions), ((PyArrayObject *)__pyx_v_pweights), 1.0, 1.0, -1L, __pyx_t_8, __pyx_t_9, 1.0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1216, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":1226
+  /* "structureboost/structure_gb.pyx":1224
  *     )
  * 
  *     return(phi)             # <<<<<<<<<<<<<<
  * 
  * def get_basic_config(X_tr, default_config, X_te=None):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_phi);
   __pyx_r = __pyx_v_phi;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":1185
+  /* "structureboost/structure_gb.pyx":1183
  *         )
  * 
  * def tree_shap_single_pt(dt_mat_int, dt_mat_float,  dt_max_depth, X_in, condition=0, condition_feature=0):             # <<<<<<<<<<<<<<
  * 
  *     x_missing = np.isnan(X_in).astype(int)
  */
 
@@ -24782,15 +24768,15 @@
   __Pyx_XDECREF(__pyx_v_root_val);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":1228
+/* "structureboost/structure_gb.pyx":1226
  *     return(phi)
  * 
  * def get_basic_config(X_tr, default_config, X_te=None):             # <<<<<<<<<<<<<<
  *     """Returns a feature_configs based on a training set and some defaults.
  * 
  */
 
@@ -24830,25 +24816,25 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X_tr)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_default_config)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_basic_config", 0, 2, 3, 1); __PYX_ERR(0, 1228, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_basic_config", 0, 2, 3, 1); __PYX_ERR(0, 1226, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_X_te);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_basic_config") < 0)) __PYX_ERR(0, 1228, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_basic_config") < 0)) __PYX_ERR(0, 1226, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
@@ -24858,15 +24844,15 @@
     }
     __pyx_v_X_tr = values[0];
     __pyx_v_default_config = values[1];
     __pyx_v_X_te = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("get_basic_config", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1228, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("get_basic_config", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1226, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.get_basic_config", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_24get_basic_config(__pyx_self, __pyx_v_X_tr, __pyx_v_default_config, __pyx_v_X_te);
 
@@ -24897,108 +24883,108 @@
   int __pyx_t_11;
   PyObject *(*__pyx_t_12)(PyObject *);
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__54)
   __Pyx_RefNannySetupContext("get_basic_config", 0);
-  __Pyx_TraceCall("get_basic_config", __pyx_f[0], 1228, 0, __PYX_ERR(0, 1228, __pyx_L1_error));
+  __Pyx_TraceCall("get_basic_config", __pyx_f[0], 1226, 0, __PYX_ERR(0, 1226, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":1272
+  /* "structureboost/structure_gb.pyx":1270
  *     >>> stb_model.fit(X_train, y_train)
  * """
  *     feature_config_dict = {}             # <<<<<<<<<<<<<<
  *     for colname in X_tr.columns:
  *         if X_te is not None:
  */
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1272, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1270, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_feature_config_dict = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1273
+  /* "structureboost/structure_gb.pyx":1271
  * """
  *     feature_config_dict = {}
  *     for colname in X_tr.columns:             # <<<<<<<<<<<<<<
  *         if X_te is not None:
  *             vec_to_use = pd.concat((X_tr[colname], X_te.colname))
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_tr, __pyx_n_s_columns); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1273, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_tr, __pyx_n_s_columns); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1271, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1273, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1271, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1273, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1271, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1273, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1271, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1273, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1271, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1273, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1271, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1273, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1271, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_4(__pyx_t_2);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 1273, __pyx_L1_error)
+          else __PYX_ERR(0, 1271, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_colname, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":1274
+    /* "structureboost/structure_gb.pyx":1272
  *     feature_config_dict = {}
  *     for colname in X_tr.columns:
  *         if X_te is not None:             # <<<<<<<<<<<<<<
  *             vec_to_use = pd.concat((X_tr[colname], X_te.colname))
  *         else:
  */
     __pyx_t_5 = (__pyx_v_X_te != Py_None);
     __pyx_t_6 = (__pyx_t_5 != 0);
     if (__pyx_t_6) {
 
-      /* "structureboost/structure_gb.pyx":1275
+      /* "structureboost/structure_gb.pyx":1273
  *     for colname in X_tr.columns:
  *         if X_te is not None:
  *             vec_to_use = pd.concat((X_tr[colname], X_te.colname))             # <<<<<<<<<<<<<<
  *         else:
  *             vec_to_use = X_tr[colname]
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_pd); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1275, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_pd); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1273, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_concat); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1275, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_concat); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1273, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_X_tr, __pyx_v_colname); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1275, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_v_X_tr, __pyx_v_colname); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1273, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_te, __pyx_n_s_colname); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1275, __pyx_L1_error)
+      __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_X_te, __pyx_n_s_colname); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1273, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
-      __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1275, __pyx_L1_error)
+      __pyx_t_10 = PyTuple_New(2); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1273, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_7);
       __Pyx_GIVEREF(__pyx_t_9);
       PyTuple_SET_ITEM(__pyx_t_10, 1, __pyx_t_9);
       __pyx_t_7 = 0;
       __pyx_t_9 = 0;
@@ -25011,53 +24997,53 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_8, function);
         }
       }
       __pyx_t_1 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_9, __pyx_t_10) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_10);
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
-      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1275, __pyx_L1_error)
+      if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1273, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_XDECREF_SET(__pyx_v_vec_to_use, __pyx_t_1);
       __pyx_t_1 = 0;
 
-      /* "structureboost/structure_gb.pyx":1274
+      /* "structureboost/structure_gb.pyx":1272
  *     feature_config_dict = {}
  *     for colname in X_tr.columns:
  *         if X_te is not None:             # <<<<<<<<<<<<<<
  *             vec_to_use = pd.concat((X_tr[colname], X_te.colname))
  *         else:
  */
       goto __pyx_L5;
     }
 
-    /* "structureboost/structure_gb.pyx":1277
+    /* "structureboost/structure_gb.pyx":1275
  *             vec_to_use = pd.concat((X_tr[colname], X_te.colname))
  *         else:
  *             vec_to_use = X_tr[colname]             # <<<<<<<<<<<<<<
  *         config, graph = get_basic_config_series(vec_to_use, default_config)
  *         feature_config_dict[colname] = config
  */
     /*else*/ {
-      __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_X_tr, __pyx_v_colname); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1277, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_v_X_tr, __pyx_v_colname); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1275, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_XDECREF_SET(__pyx_v_vec_to_use, __pyx_t_1);
       __pyx_t_1 = 0;
     }
     __pyx_L5:;
 
-    /* "structureboost/structure_gb.pyx":1278
+    /* "structureboost/structure_gb.pyx":1276
  *         else:
  *             vec_to_use = X_tr[colname]
  *         config, graph = get_basic_config_series(vec_to_use, default_config)             # <<<<<<<<<<<<<<
  *         feature_config_dict[colname] = config
  *         if graph is not None:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_get_basic_config_series); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1278, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_8, __pyx_n_s_get_basic_config_series); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1276, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __pyx_t_10 = NULL;
     __pyx_t_11 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_8);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
@@ -25066,159 +25052,159 @@
         __Pyx_DECREF_SET(__pyx_t_8, function);
         __pyx_t_11 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_8)) {
       PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_v_vec_to_use, __pyx_v_default_config};
-      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1278, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1276, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_GOTREF(__pyx_t_1);
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_8)) {
       PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_v_vec_to_use, __pyx_v_default_config};
-      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1278, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_8, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1276, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_GOTREF(__pyx_t_1);
     } else
     #endif
     {
-      __pyx_t_9 = PyTuple_New(2+__pyx_t_11); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1278, __pyx_L1_error)
+      __pyx_t_9 = PyTuple_New(2+__pyx_t_11); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1276, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       if (__pyx_t_10) {
         __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_10); __pyx_t_10 = NULL;
       }
       __Pyx_INCREF(__pyx_v_vec_to_use);
       __Pyx_GIVEREF(__pyx_v_vec_to_use);
       PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_11, __pyx_v_vec_to_use);
       __Pyx_INCREF(__pyx_v_default_config);
       __Pyx_GIVEREF(__pyx_v_default_config);
       PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_11, __pyx_v_default_config);
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1278, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_8, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1276, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     }
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
       PyObject* sequence = __pyx_t_1;
       Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
       if (unlikely(size != 2)) {
         if (size > 2) __Pyx_RaiseTooManyValuesError(2);
         else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-        __PYX_ERR(0, 1278, __pyx_L1_error)
+        __PYX_ERR(0, 1276, __pyx_L1_error)
       }
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
       if (likely(PyTuple_CheckExact(sequence))) {
         __pyx_t_8 = PyTuple_GET_ITEM(sequence, 0); 
         __pyx_t_9 = PyTuple_GET_ITEM(sequence, 1); 
       } else {
         __pyx_t_8 = PyList_GET_ITEM(sequence, 0); 
         __pyx_t_9 = PyList_GET_ITEM(sequence, 1); 
       }
       __Pyx_INCREF(__pyx_t_8);
       __Pyx_INCREF(__pyx_t_9);
       #else
-      __pyx_t_8 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1278, __pyx_L1_error)
+      __pyx_t_8 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1276, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_9 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1278, __pyx_L1_error)
+      __pyx_t_9 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1276, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       #endif
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     } else {
       Py_ssize_t index = -1;
-      __pyx_t_10 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1278, __pyx_L1_error)
+      __pyx_t_10 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1276, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_12 = Py_TYPE(__pyx_t_10)->tp_iternext;
       index = 0; __pyx_t_8 = __pyx_t_12(__pyx_t_10); if (unlikely(!__pyx_t_8)) goto __pyx_L6_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_8);
       index = 1; __pyx_t_9 = __pyx_t_12(__pyx_t_10); if (unlikely(!__pyx_t_9)) goto __pyx_L6_unpacking_failed;
       __Pyx_GOTREF(__pyx_t_9);
-      if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_10), 2) < 0) __PYX_ERR(0, 1278, __pyx_L1_error)
+      if (__Pyx_IternextUnpackEndCheck(__pyx_t_12(__pyx_t_10), 2) < 0) __PYX_ERR(0, 1276, __pyx_L1_error)
       __pyx_t_12 = NULL;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       goto __pyx_L7_unpacking_done;
       __pyx_L6_unpacking_failed:;
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __pyx_t_12 = NULL;
       if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-      __PYX_ERR(0, 1278, __pyx_L1_error)
+      __PYX_ERR(0, 1276, __pyx_L1_error)
       __pyx_L7_unpacking_done:;
     }
     __Pyx_XDECREF_SET(__pyx_v_config, __pyx_t_8);
     __pyx_t_8 = 0;
     __Pyx_XDECREF_SET(__pyx_v_graph, __pyx_t_9);
     __pyx_t_9 = 0;
 
-    /* "structureboost/structure_gb.pyx":1279
+    /* "structureboost/structure_gb.pyx":1277
  *             vec_to_use = X_tr[colname]
  *         config, graph = get_basic_config_series(vec_to_use, default_config)
  *         feature_config_dict[colname] = config             # <<<<<<<<<<<<<<
  *         if graph is not None:
  *             feature_config_dict[colname]['graph'] = graph
  */
-    if (unlikely(PyDict_SetItem(__pyx_v_feature_config_dict, __pyx_v_colname, __pyx_v_config) < 0)) __PYX_ERR(0, 1279, __pyx_L1_error)
+    if (unlikely(PyDict_SetItem(__pyx_v_feature_config_dict, __pyx_v_colname, __pyx_v_config) < 0)) __PYX_ERR(0, 1277, __pyx_L1_error)
 
-    /* "structureboost/structure_gb.pyx":1280
+    /* "structureboost/structure_gb.pyx":1278
  *         config, graph = get_basic_config_series(vec_to_use, default_config)
  *         feature_config_dict[colname] = config
  *         if graph is not None:             # <<<<<<<<<<<<<<
  *             feature_config_dict[colname]['graph'] = graph
  *     return feature_config_dict
  */
     __pyx_t_6 = (__pyx_v_graph != Py_None);
     __pyx_t_5 = (__pyx_t_6 != 0);
     if (__pyx_t_5) {
 
-      /* "structureboost/structure_gb.pyx":1281
+      /* "structureboost/structure_gb.pyx":1279
  *         feature_config_dict[colname] = config
  *         if graph is not None:
  *             feature_config_dict[colname]['graph'] = graph             # <<<<<<<<<<<<<<
  *     return feature_config_dict
  * 
  */
-      __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_feature_config_dict, __pyx_v_colname); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1281, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyDict_GetItem(__pyx_v_feature_config_dict, __pyx_v_colname); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1279, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_n_u_graph, __pyx_v_graph) < 0)) __PYX_ERR(0, 1281, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_t_1, __pyx_n_u_graph, __pyx_v_graph) < 0)) __PYX_ERR(0, 1279, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "structureboost/structure_gb.pyx":1280
+      /* "structureboost/structure_gb.pyx":1278
  *         config, graph = get_basic_config_series(vec_to_use, default_config)
  *         feature_config_dict[colname] = config
  *         if graph is not None:             # <<<<<<<<<<<<<<
  *             feature_config_dict[colname]['graph'] = graph
  *     return feature_config_dict
  */
     }
 
-    /* "structureboost/structure_gb.pyx":1273
+    /* "structureboost/structure_gb.pyx":1271
  * """
  *     feature_config_dict = {}
  *     for colname in X_tr.columns:             # <<<<<<<<<<<<<<
  *         if X_te is not None:
  *             vec_to_use = pd.concat((X_tr[colname], X_te.colname))
  */
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "structureboost/structure_gb.pyx":1282
+  /* "structureboost/structure_gb.pyx":1280
  *         if graph is not None:
  *             feature_config_dict[colname]['graph'] = graph
  *     return feature_config_dict             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_feature_config_dict);
   __pyx_r = __pyx_v_feature_config_dict;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":1228
+  /* "structureboost/structure_gb.pyx":1226
  *     return(phi)
  * 
  * def get_basic_config(X_tr, default_config, X_te=None):             # <<<<<<<<<<<<<<
  *     """Returns a feature_configs based on a training set and some defaults.
  * 
  */
 
@@ -25240,15 +25226,15 @@
   __Pyx_XDECREF(__pyx_v_graph);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":1285
+/* "structureboost/structure_gb.pyx":1283
  * 
  * 
  * def default_config_dict():             # <<<<<<<<<<<<<<
  *     """Returns a dict of defaults to be used with `get_basic_config`
  * 
  */
 
@@ -25274,86 +25260,86 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__55)
   __Pyx_RefNannySetupContext("default_config_dict", 0);
-  __Pyx_TraceCall("default_config_dict", __pyx_f[0], 1285, 0, __PYX_ERR(0, 1285, __pyx_L1_error));
+  __Pyx_TraceCall("default_config_dict", __pyx_f[0], 1283, 0, __PYX_ERR(0, 1283, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":1321
+  /* "structureboost/structure_gb.pyx":1319
  *     >>> stb_model.fit(X_train, y_train)
  *     """
  *     config_dict = {}             # <<<<<<<<<<<<<<
  *     config_dict['default_categorical_method'] = 'span_tree'
  *     config_dict['default_num_span_trees'] = 1
  */
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1321, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1319, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_config_dict = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1322
+  /* "structureboost/structure_gb.pyx":1320
  *     """
  *     config_dict = {}
  *     config_dict['default_categorical_method'] = 'span_tree'             # <<<<<<<<<<<<<<
  *     config_dict['default_num_span_trees'] = 1
  *     config_dict['default_contraction_size'] = 9
  */
-  if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_default_categorical_method, __pyx_n_u_span_tree) < 0)) __PYX_ERR(0, 1322, __pyx_L1_error)
+  if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_default_categorical_method, __pyx_n_u_span_tree) < 0)) __PYX_ERR(0, 1320, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":1323
+  /* "structureboost/structure_gb.pyx":1321
  *     config_dict = {}
  *     config_dict['default_categorical_method'] = 'span_tree'
  *     config_dict['default_num_span_trees'] = 1             # <<<<<<<<<<<<<<
  *     config_dict['default_contraction_size'] = 9
  *     config_dict['default_contraction_max_splits_to_search'] = 25
  */
-  if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_default_num_span_trees, __pyx_int_1) < 0)) __PYX_ERR(0, 1323, __pyx_L1_error)
+  if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_default_num_span_trees, __pyx_int_1) < 0)) __PYX_ERR(0, 1321, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":1324
+  /* "structureboost/structure_gb.pyx":1322
  *     config_dict['default_categorical_method'] = 'span_tree'
  *     config_dict['default_num_span_trees'] = 1
  *     config_dict['default_contraction_size'] = 9             # <<<<<<<<<<<<<<
  *     config_dict['default_contraction_max_splits_to_search'] = 25
  *     config_dict['default_numerical_max_splits_to_search'] = 25
  */
-  if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_default_contraction_size, __pyx_int_9) < 0)) __PYX_ERR(0, 1324, __pyx_L1_error)
+  if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_default_contraction_size, __pyx_int_9) < 0)) __PYX_ERR(0, 1322, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":1325
+  /* "structureboost/structure_gb.pyx":1323
  *     config_dict['default_num_span_trees'] = 1
  *     config_dict['default_contraction_size'] = 9
  *     config_dict['default_contraction_max_splits_to_search'] = 25             # <<<<<<<<<<<<<<
  *     config_dict['default_numerical_max_splits_to_search'] = 25
  *     return config_dict
  */
-  if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_default_contraction_max_splits_t, __pyx_int_25) < 0)) __PYX_ERR(0, 1325, __pyx_L1_error)
+  if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_default_contraction_max_splits_t, __pyx_int_25) < 0)) __PYX_ERR(0, 1323, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":1326
+  /* "structureboost/structure_gb.pyx":1324
  *     config_dict['default_contraction_size'] = 9
  *     config_dict['default_contraction_max_splits_to_search'] = 25
  *     config_dict['default_numerical_max_splits_to_search'] = 25             # <<<<<<<<<<<<<<
  *     return config_dict
  * 
  */
-  if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_default_numerical_max_splits_to, __pyx_int_25) < 0)) __PYX_ERR(0, 1326, __pyx_L1_error)
+  if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_default_numerical_max_splits_to, __pyx_int_25) < 0)) __PYX_ERR(0, 1324, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":1327
+  /* "structureboost/structure_gb.pyx":1325
  *     config_dict['default_contraction_max_splits_to_search'] = 25
  *     config_dict['default_numerical_max_splits_to_search'] = 25
  *     return config_dict             # <<<<<<<<<<<<<<
  * 
  * def get_basic_config_series(feature_vec, default_config):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_config_dict);
   __pyx_r = __pyx_v_config_dict;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":1285
+  /* "structureboost/structure_gb.pyx":1283
  * 
  * 
  * def default_config_dict():             # <<<<<<<<<<<<<<
  *     """Returns a dict of defaults to be used with `get_basic_config`
  * 
  */
 
@@ -25366,15 +25352,15 @@
   __Pyx_XDECREF(__pyx_v_config_dict);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb.pyx":1329
+/* "structureboost/structure_gb.pyx":1327
  *     return config_dict
  * 
  * def get_basic_config_series(feature_vec, default_config):             # <<<<<<<<<<<<<<
  *     config_dict = {}
  *     graph_out = None
  */
 
@@ -25409,32 +25395,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_feature_vec)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_default_config)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_basic_config_series", 1, 2, 2, 1); __PYX_ERR(0, 1329, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_basic_config_series", 1, 2, 2, 1); __PYX_ERR(0, 1327, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_basic_config_series") < 0)) __PYX_ERR(0, 1329, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_basic_config_series") < 0)) __PYX_ERR(0, 1327, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_feature_vec = values[0];
     __pyx_v_default_config = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("get_basic_config_series", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1329, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("get_basic_config_series", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1327, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb.get_basic_config_series", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_12structure_gb_28get_basic_config_series(__pyx_self, __pyx_v_feature_vec, __pyx_v_default_config);
 
@@ -25459,100 +25445,100 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__56)
   __Pyx_RefNannySetupContext("get_basic_config_series", 0);
-  __Pyx_TraceCall("get_basic_config_series", __pyx_f[0], 1329, 0, __PYX_ERR(0, 1329, __pyx_L1_error));
+  __Pyx_TraceCall("get_basic_config_series", __pyx_f[0], 1327, 0, __PYX_ERR(0, 1327, __pyx_L1_error));
 
-  /* "structureboost/structure_gb.pyx":1330
+  /* "structureboost/structure_gb.pyx":1328
  * 
  * def get_basic_config_series(feature_vec, default_config):
  *     config_dict = {}             # <<<<<<<<<<<<<<
  *     graph_out = None
  *     if feature_vec.dtype == 'O':
  */
-  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1330, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyDict_NewPresized(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1328, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_v_config_dict = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1331
+  /* "structureboost/structure_gb.pyx":1329
  * def get_basic_config_series(feature_vec, default_config):
  *     config_dict = {}
  *     graph_out = None             # <<<<<<<<<<<<<<
  *     if feature_vec.dtype == 'O':
  *         config_dict['feature_type'] = 'categorical_str'
  */
   __Pyx_INCREF(Py_None);
   __pyx_v_graph_out = Py_None;
 
-  /* "structureboost/structure_gb.pyx":1332
+  /* "structureboost/structure_gb.pyx":1330
  *     config_dict = {}
  *     graph_out = None
  *     if feature_vec.dtype == 'O':             # <<<<<<<<<<<<<<
  *         config_dict['feature_type'] = 'categorical_str'
  *         config_dict['graph'] = graphs.complete_graph(pd.unique(
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_feature_vec, __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1332, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_feature_vec, __pyx_n_s_dtype); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1330, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_O, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1332, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_O, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1330, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_2) {
 
-    /* "structureboost/structure_gb.pyx":1333
+    /* "structureboost/structure_gb.pyx":1331
  *     graph_out = None
  *     if feature_vec.dtype == 'O':
  *         config_dict['feature_type'] = 'categorical_str'             # <<<<<<<<<<<<<<
  *         config_dict['graph'] = graphs.complete_graph(pd.unique(
  *                                                      feature_vec.dropna()))
  */
-    if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_feature_type, __pyx_n_u_categorical_str) < 0)) __PYX_ERR(0, 1333, __pyx_L1_error)
+    if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_feature_type, __pyx_n_u_categorical_str) < 0)) __PYX_ERR(0, 1331, __pyx_L1_error)
 
-    /* "structureboost/structure_gb.pyx":1334
+    /* "structureboost/structure_gb.pyx":1332
  *     if feature_vec.dtype == 'O':
  *         config_dict['feature_type'] = 'categorical_str'
  *         config_dict['graph'] = graphs.complete_graph(pd.unique(             # <<<<<<<<<<<<<<
  *                                                      feature_vec.dropna()))
  *         categorical_method = default_config['default_categorical_method']
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_graphs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1334, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_graphs); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1332, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_complete_graph); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1334, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_complete_graph); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1332, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_pd); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1334, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_pd); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1332, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_unique); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1334, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_unique); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1332, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "structureboost/structure_gb.pyx":1335
+    /* "structureboost/structure_gb.pyx":1333
  *         config_dict['feature_type'] = 'categorical_str'
  *         config_dict['graph'] = graphs.complete_graph(pd.unique(
  *                                                      feature_vec.dropna()))             # <<<<<<<<<<<<<<
  *         categorical_method = default_config['default_categorical_method']
  *         config_dict['split_method'] = categorical_method
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_feature_vec, __pyx_n_s_dropna); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1335, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_feature_vec, __pyx_n_s_dropna); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1333, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_8 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_7))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_7);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
         __Pyx_INCREF(__pyx_t_8);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_7, function);
       }
     }
     __pyx_t_5 = (__pyx_t_8) ? __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_8) : __Pyx_PyObject_CallNoArg(__pyx_t_7);
     __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
-    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1335, __pyx_L1_error)
+    if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1333, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
@@ -25560,15 +25546,15 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_3 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_7, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_5);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1334, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1332, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -25576,177 +25562,177 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_4, function);
       }
     }
     __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_6, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1334, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1332, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-    /* "structureboost/structure_gb.pyx":1334
+    /* "structureboost/structure_gb.pyx":1332
  *     if feature_vec.dtype == 'O':
  *         config_dict['feature_type'] = 'categorical_str'
  *         config_dict['graph'] = graphs.complete_graph(pd.unique(             # <<<<<<<<<<<<<<
  *                                                      feature_vec.dropna()))
  *         categorical_method = default_config['default_categorical_method']
  */
-    if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_graph, __pyx_t_1) < 0)) __PYX_ERR(0, 1334, __pyx_L1_error)
+    if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_graph, __pyx_t_1) < 0)) __PYX_ERR(0, 1332, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":1336
+    /* "structureboost/structure_gb.pyx":1334
  *         config_dict['graph'] = graphs.complete_graph(pd.unique(
  *                                                      feature_vec.dropna()))
  *         categorical_method = default_config['default_categorical_method']             # <<<<<<<<<<<<<<
  *         config_dict['split_method'] = categorical_method
  *         if categorical_method == 'contraction':
  */
-    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_default_config, __pyx_n_u_default_categorical_method); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1336, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_default_config, __pyx_n_u_default_categorical_method); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1334, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_v_categorical_method = __pyx_t_1;
     __pyx_t_1 = 0;
 
-    /* "structureboost/structure_gb.pyx":1337
+    /* "structureboost/structure_gb.pyx":1335
  *                                                      feature_vec.dropna()))
  *         categorical_method = default_config['default_categorical_method']
  *         config_dict['split_method'] = categorical_method             # <<<<<<<<<<<<<<
  *         if categorical_method == 'contraction':
  *             config_dict['contraction_size'] = default_config[
  */
-    if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_split_method, __pyx_v_categorical_method) < 0)) __PYX_ERR(0, 1337, __pyx_L1_error)
+    if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_split_method, __pyx_v_categorical_method) < 0)) __PYX_ERR(0, 1335, __pyx_L1_error)
 
-    /* "structureboost/structure_gb.pyx":1338
+    /* "structureboost/structure_gb.pyx":1336
  *         categorical_method = default_config['default_categorical_method']
  *         config_dict['split_method'] = categorical_method
  *         if categorical_method == 'contraction':             # <<<<<<<<<<<<<<
  *             config_dict['contraction_size'] = default_config[
  *                                                 'default_contraction_size']
  */
-    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_categorical_method, __pyx_n_u_contraction, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1338, __pyx_L1_error)
+    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_categorical_method, __pyx_n_u_contraction, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1336, __pyx_L1_error)
     if (__pyx_t_2) {
 
-      /* "structureboost/structure_gb.pyx":1339
+      /* "structureboost/structure_gb.pyx":1337
  *         config_dict['split_method'] = categorical_method
  *         if categorical_method == 'contraction':
  *             config_dict['contraction_size'] = default_config[             # <<<<<<<<<<<<<<
  *                                                 'default_contraction_size']
  *             config_dict['max_splits_to_search'] = default_config[
  */
-      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_default_config, __pyx_n_u_default_contraction_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1339, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_default_config, __pyx_n_u_default_contraction_size); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1337, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_contraction_size, __pyx_t_1) < 0)) __PYX_ERR(0, 1339, __pyx_L1_error)
+      if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_contraction_size, __pyx_t_1) < 0)) __PYX_ERR(0, 1337, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "structureboost/structure_gb.pyx":1341
+      /* "structureboost/structure_gb.pyx":1339
  *             config_dict['contraction_size'] = default_config[
  *                                                 'default_contraction_size']
  *             config_dict['max_splits_to_search'] = default_config[             # <<<<<<<<<<<<<<
  *                                 'default_contraction_max_splits_to_search']
  *         if categorical_method == 'span_tree':
  */
-      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_default_config, __pyx_n_u_default_contraction_max_splits_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1341, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_default_config, __pyx_n_u_default_contraction_max_splits_t); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1339, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_max_splits_to_search, __pyx_t_1) < 0)) __PYX_ERR(0, 1341, __pyx_L1_error)
+      if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_max_splits_to_search, __pyx_t_1) < 0)) __PYX_ERR(0, 1339, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "structureboost/structure_gb.pyx":1338
+      /* "structureboost/structure_gb.pyx":1336
  *         categorical_method = default_config['default_categorical_method']
  *         config_dict['split_method'] = categorical_method
  *         if categorical_method == 'contraction':             # <<<<<<<<<<<<<<
  *             config_dict['contraction_size'] = default_config[
  *                                                 'default_contraction_size']
  */
     }
 
-    /* "structureboost/structure_gb.pyx":1343
+    /* "structureboost/structure_gb.pyx":1341
  *             config_dict['max_splits_to_search'] = default_config[
  *                                 'default_contraction_max_splits_to_search']
  *         if categorical_method == 'span_tree':             # <<<<<<<<<<<<<<
  *             config_dict['num_span_trees'] = default_config[
  *                                                     'default_num_span_trees']
  */
-    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_categorical_method, __pyx_n_u_span_tree, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1343, __pyx_L1_error)
+    __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_categorical_method, __pyx_n_u_span_tree, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 1341, __pyx_L1_error)
     if (__pyx_t_2) {
 
-      /* "structureboost/structure_gb.pyx":1344
+      /* "structureboost/structure_gb.pyx":1342
  *                                 'default_contraction_max_splits_to_search']
  *         if categorical_method == 'span_tree':
  *             config_dict['num_span_trees'] = default_config[             # <<<<<<<<<<<<<<
  *                                                     'default_num_span_trees']
  *     else:
  */
-      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_default_config, __pyx_n_u_default_num_span_trees); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1344, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_default_config, __pyx_n_u_default_num_span_trees); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1342, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_num_span_trees, __pyx_t_1) < 0)) __PYX_ERR(0, 1344, __pyx_L1_error)
+      if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_num_span_trees, __pyx_t_1) < 0)) __PYX_ERR(0, 1342, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-      /* "structureboost/structure_gb.pyx":1343
+      /* "structureboost/structure_gb.pyx":1341
  *             config_dict['max_splits_to_search'] = default_config[
  *                                 'default_contraction_max_splits_to_search']
  *         if categorical_method == 'span_tree':             # <<<<<<<<<<<<<<
  *             config_dict['num_span_trees'] = default_config[
  *                                                     'default_num_span_trees']
  */
     }
 
-    /* "structureboost/structure_gb.pyx":1332
+    /* "structureboost/structure_gb.pyx":1330
  *     config_dict = {}
  *     graph_out = None
  *     if feature_vec.dtype == 'O':             # <<<<<<<<<<<<<<
  *         config_dict['feature_type'] = 'categorical_str'
  *         config_dict['graph'] = graphs.complete_graph(pd.unique(
  */
     goto __pyx_L3;
   }
 
-  /* "structureboost/structure_gb.pyx":1347
+  /* "structureboost/structure_gb.pyx":1345
  *                                                     'default_num_span_trees']
  *     else:
  *         config_dict['feature_type'] = 'numerical'             # <<<<<<<<<<<<<<
  *         config_dict['max_splits_to_search'] = default_config[
  *                                     'default_numerical_max_splits_to_search']
  */
   /*else*/ {
-    if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_feature_type, __pyx_n_u_numerical) < 0)) __PYX_ERR(0, 1347, __pyx_L1_error)
+    if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_feature_type, __pyx_n_u_numerical) < 0)) __PYX_ERR(0, 1345, __pyx_L1_error)
 
-    /* "structureboost/structure_gb.pyx":1348
+    /* "structureboost/structure_gb.pyx":1346
  *     else:
  *         config_dict['feature_type'] = 'numerical'
  *         config_dict['max_splits_to_search'] = default_config[             # <<<<<<<<<<<<<<
  *                                     'default_numerical_max_splits_to_search']
  *     return config_dict, graph_out
  */
-    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_default_config, __pyx_n_u_default_numerical_max_splits_to); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1348, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Dict_GetItem(__pyx_v_default_config, __pyx_n_u_default_numerical_max_splits_to); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1346, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_max_splits_to_search, __pyx_t_1) < 0)) __PYX_ERR(0, 1348, __pyx_L1_error)
+    if (unlikely(PyDict_SetItem(__pyx_v_config_dict, __pyx_n_u_max_splits_to_search, __pyx_t_1) < 0)) __PYX_ERR(0, 1346, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   }
   __pyx_L3:;
 
-  /* "structureboost/structure_gb.pyx":1350
+  /* "structureboost/structure_gb.pyx":1348
  *         config_dict['max_splits_to_search'] = default_config[
  *                                     'default_numerical_max_splits_to_search']
  *     return config_dict, graph_out             # <<<<<<<<<<<<<<
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1350, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1348, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_INCREF(__pyx_v_config_dict);
   __Pyx_GIVEREF(__pyx_v_config_dict);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_config_dict);
   __Pyx_INCREF(__pyx_v_graph_out);
   __Pyx_GIVEREF(__pyx_v_graph_out);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_graph_out);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb.pyx":1329
+  /* "structureboost/structure_gb.pyx":1327
  *     return config_dict
  * 
  * def get_basic_config_series(feature_vec, default_config):             # <<<<<<<<<<<<<<
  *     config_dict = {}
  *     graph_out = None
  */
 
@@ -41258,15 +41244,15 @@
   {&__pyx_n_s_curr_valid_loss, __pyx_k_curr_valid_loss, sizeof(__pyx_k_curr_valid_loss), 0, 0, 1, 1},
   {&__pyx_n_s_dec_tree, __pyx_k_dec_tree, sizeof(__pyx_k_dec_tree), 0, 0, 1, 1},
   {&__pyx_n_s_dec_tree_list, __pyx_k_dec_tree_list, sizeof(__pyx_k_dec_tree_list), 0, 0, 1, 1},
   {&__pyx_n_s_decimals, __pyx_k_decimals, sizeof(__pyx_k_decimals), 0, 0, 1, 1},
   {&__pyx_n_u_default_categorical_method, __pyx_k_default_categorical_method, sizeof(__pyx_k_default_categorical_method), 0, 1, 0, 1},
   {&__pyx_n_s_default_config, __pyx_k_default_config, sizeof(__pyx_k_default_config), 0, 0, 1, 1},
   {&__pyx_n_s_default_config_dict, __pyx_k_default_config_dict, sizeof(__pyx_k_default_config_dict), 0, 0, 1, 1},
-  {&__pyx_kp_u_default_config_dict_line_1285, __pyx_k_default_config_dict_line_1285, sizeof(__pyx_k_default_config_dict_line_1285), 0, 1, 0, 0},
+  {&__pyx_kp_u_default_config_dict_line_1283, __pyx_k_default_config_dict_line_1283, sizeof(__pyx_k_default_config_dict_line_1283), 0, 1, 0, 0},
   {&__pyx_n_s_default_configs, __pyx_k_default_configs, sizeof(__pyx_k_default_configs), 0, 0, 1, 1},
   {&__pyx_n_u_default_contraction_max_splits_t, __pyx_k_default_contraction_max_splits_t, sizeof(__pyx_k_default_contraction_max_splits_t), 0, 1, 0, 1},
   {&__pyx_n_u_default_contraction_size, __pyx_k_default_contraction_size, sizeof(__pyx_k_default_contraction_size), 0, 1, 0, 1},
   {&__pyx_n_u_default_num_span_trees, __pyx_k_default_num_span_trees, sizeof(__pyx_k_default_num_span_trees), 0, 1, 0, 1},
   {&__pyx_n_u_default_numerical_max_splits_to, __pyx_k_default_numerical_max_splits_to, sizeof(__pyx_k_default_numerical_max_splits_to), 0, 1, 0, 1},
   {&__pyx_n_s_denom1, __pyx_k_denom1, sizeof(__pyx_k_denom1), 0, 0, 1, 1},
   {&__pyx_n_s_denom2, __pyx_k_denom2, sizeof(__pyx_k_denom2), 0, 0, 1, 1},
@@ -41333,15 +41319,15 @@
   {&__pyx_n_s_format, __pyx_k_format, sizeof(__pyx_k_format), 0, 0, 1, 1},
   {&__pyx_n_s_fortran, __pyx_k_fortran, sizeof(__pyx_k_fortran), 0, 0, 1, 1},
   {&__pyx_n_u_fortran, __pyx_k_fortran, sizeof(__pyx_k_fortran), 0, 1, 0, 1},
   {&__pyx_n_s_found_val, __pyx_k_found_val, sizeof(__pyx_k_found_val), 0, 0, 1, 1},
   {&__pyx_n_s_fromiter, __pyx_k_fromiter, sizeof(__pyx_k_fromiter), 0, 0, 1, 1},
   {&__pyx_n_s_gamma, __pyx_k_gamma, sizeof(__pyx_k_gamma), 0, 0, 1, 1},
   {&__pyx_n_s_get_basic_config, __pyx_k_get_basic_config, sizeof(__pyx_k_get_basic_config), 0, 0, 1, 1},
-  {&__pyx_kp_u_get_basic_config_line_1228, __pyx_k_get_basic_config_line_1228, sizeof(__pyx_k_get_basic_config_line_1228), 0, 1, 0, 0},
+  {&__pyx_kp_u_get_basic_config_line_1226, __pyx_k_get_basic_config_line_1226, sizeof(__pyx_k_get_basic_config_line_1226), 0, 1, 0, 0},
   {&__pyx_n_s_get_basic_config_series, __pyx_k_get_basic_config_series, sizeof(__pyx_k_get_basic_config_series), 0, 0, 1, 1},
   {&__pyx_n_s_get_features_for_tree, __pyx_k_get_features_for_tree, sizeof(__pyx_k_get_features_for_tree), 0, 0, 1, 1},
   {&__pyx_n_s_get_initial_pred, __pyx_k_get_initial_pred, sizeof(__pyx_k_get_initial_pred), 0, 0, 1, 1},
   {&__pyx_n_s_get_max_split_size, __pyx_k_get_max_split_size, sizeof(__pyx_k_get_max_split_size), 0, 0, 1, 1},
   {&__pyx_n_s_get_rows_for_tree, __pyx_k_get_rows_for_tree, sizeof(__pyx_k_get_rows_for_tree), 0, 0, 1, 1},
   {&__pyx_n_s_get_tensors_for_predict, __pyx_k_get_tensors_for_predict, sizeof(__pyx_k_get_tensors_for_predict), 0, 0, 1, 1},
   {&__pyx_n_s_getstate, __pyx_k_getstate, sizeof(__pyx_k_getstate), 0, 0, 1, 1},
@@ -41365,15 +41351,15 @@
   {&__pyx_n_s_index, __pyx_k_index, sizeof(__pyx_k_index), 0, 0, 1, 1},
   {&__pyx_n_s_indexes, __pyx_k_indexes, sizeof(__pyx_k_indexes), 0, 0, 1, 1},
   {&__pyx_n_s_init, __pyx_k_init, sizeof(__pyx_k_init), 0, 0, 1, 1},
   {&__pyx_n_s_init_eval_set_info, __pyx_k_init_eval_set_info, sizeof(__pyx_k_init_eval_set_info), 0, 0, 1, 1},
   {&__pyx_n_s_initial_model, __pyx_k_initial_model, sizeof(__pyx_k_initial_model), 0, 0, 1, 1},
   {&__pyx_n_s_initial_pred, __pyx_k_initial_pred, sizeof(__pyx_k_initial_pred), 0, 0, 1, 1},
   {&__pyx_n_s_initialize_uv_dict, __pyx_k_initialize_uv_dict, sizeof(__pyx_k_initialize_uv_dict), 0, 0, 1, 1},
-  {&__pyx_n_s_int64, __pyx_k_int64, sizeof(__pyx_k_int64), 0, 0, 1, 1},
+  {&__pyx_n_s_int, __pyx_k_int, sizeof(__pyx_k_int), 0, 0, 1, 1},
   {&__pyx_n_u_interior, __pyx_k_interior, sizeof(__pyx_k_interior), 0, 1, 0, 1},
   {&__pyx_n_s_inv_cti, __pyx_k_inv_cti, sizeof(__pyx_k_inv_cti), 0, 0, 1, 1},
   {&__pyx_n_s_is_connected, __pyx_k_is_connected, sizeof(__pyx_k_is_connected), 0, 0, 1, 1},
   {&__pyx_n_s_isnan, __pyx_k_isnan, sizeof(__pyx_k_isnan), 0, 0, 1, 1},
   {&__pyx_n_s_isnan_array, __pyx_k_isnan_array, sizeof(__pyx_k_isnan_array), 0, 0, 1, 1},
   {&__pyx_n_s_items, __pyx_k_items, sizeof(__pyx_k_items), 0, 0, 1, 1},
   {&__pyx_n_s_itemsize, __pyx_k_itemsize, sizeof(__pyx_k_itemsize), 0, 0, 1, 1},
@@ -41577,17 +41563,17 @@
   {&__pyx_n_s_z_pred, __pyx_k_z_pred, sizeof(__pyx_k_z_pred), 0, 0, 1, 1},
   {&__pyx_n_s_z_pred_exp, __pyx_k_z_pred_exp, sizeof(__pyx_k_z_pred_exp), 0, 0, 1, 1},
   {&__pyx_n_s_zero_fractions, __pyx_k_zero_fractions, sizeof(__pyx_k_zero_fractions), 0, 0, 1, 1},
   {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_object = __Pyx_GetBuiltinName(__pyx_n_s_object); if (!__pyx_builtin_object) __PYX_ERR(0, 23, __pyx_L1_error)
-  __pyx_builtin_print = __Pyx_GetBuiltinName(__pyx_n_s_print); if (!__pyx_builtin_print) __PYX_ERR(0, 325, __pyx_L1_error)
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 449, __pyx_L1_error)
+  __pyx_builtin_object = __Pyx_GetBuiltinName(__pyx_n_s_object); if (!__pyx_builtin_object) __PYX_ERR(0, 21, __pyx_L1_error)
+  __pyx_builtin_print = __Pyx_GetBuiltinName(__pyx_n_s_print); if (!__pyx_builtin_print) __PYX_ERR(0, 323, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 447, __pyx_L1_error)
   __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(1, 944, __pyx_L1_error)
   __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(2, 134, __pyx_L1_error)
   __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(2, 149, __pyx_L1_error)
   __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(2, 152, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(2, 2, __pyx_L1_error)
   __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(2, 406, __pyx_L1_error)
   __pyx_builtin_id = __Pyx_GetBuiltinName(__pyx_n_s_id); if (!__pyx_builtin_id) __PYX_ERR(2, 615, __pyx_L1_error)
@@ -41597,138 +41583,138 @@
   return -1;
 }
 
 static CYTHON_SMALL_CODE int __Pyx_InitCachedConstants(void) {
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);
 
-  /* "structureboost/structure_gb.pyx":249
+  /* "structureboost/structure_gb.pyx":247
  *         if self.initial_model is not None:
  *             if (self.mode == 'classification'):
  *                 start_probs = self.initial_model.predict_proba(X_train)[:,1]             # <<<<<<<<<<<<<<
  *                 start_probs = np.clip(start_probs, 1e-15, 1-1e-15)
  *                 return(np.log(start_probs / (1-start_probs)))
  */
-  __pyx_slice__5 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__5)) __PYX_ERR(0, 249, __pyx_L1_error)
+  __pyx_slice__5 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__5)) __PYX_ERR(0, 247, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_slice__5);
   __Pyx_GIVEREF(__pyx_slice__5);
-  __pyx_tuple__6 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_1); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 249, __pyx_L1_error)
+  __pyx_tuple__6 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_1); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 247, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__6);
   __Pyx_GIVEREF(__pyx_tuple__6);
 
-  /* "structureboost/structure_gb.pyx":659
+  /* "structureboost/structure_gb.pyx":657
  *                     return(self._predict_shap(X_test, num_trees_to_use))
  *             else:
  *                 print("Shap values not available for categorical string or voronoi vars")             # <<<<<<<<<<<<<<
  *         elif (type(X_test)==pd.DataFrame):
  *             if same_col_pos:
  */
-  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_kp_u_Shap_values_not_available_for_ca); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 659, __pyx_L1_error)
+  __pyx_tuple__25 = PyTuple_Pack(1, __pyx_kp_u_Shap_values_not_available_for_ca); if (unlikely(!__pyx_tuple__25)) __PYX_ERR(0, 657, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__25);
   __Pyx_GIVEREF(__pyx_tuple__25);
 
-  /* "structureboost/structure_gb.pyx":669
+  /* "structureboost/structure_gb.pyx":667
  *                     print("Shap values not available for categorical string or voronoi vars")
  *             else:
  *                 print('columns must be in correct order for shap values')             # <<<<<<<<<<<<<<
  * 
  *     def _predict_shap(self,
  */
-  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_u_columns_must_be_in_correct_order); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 669, __pyx_L1_error)
+  __pyx_tuple__26 = PyTuple_Pack(1, __pyx_kp_u_columns_must_be_in_correct_order); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 667, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__26);
   __Pyx_GIVEREF(__pyx_tuple__26);
 
-  /* "structureboost/structure_gb.pyx":756
+  /* "structureboost/structure_gb.pyx":754
  *             self.optimized=True
  *         else:
  *             print("Model not optimizable for predict due to string or voronoi variable.")             # <<<<<<<<<<<<<<
  * 
  *     def convert_dt_to_matrix(self, dt_num):
  */
-  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_kp_u_Model_not_optimizable_for_predic); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 756, __pyx_L1_error)
+  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_kp_u_Model_not_optimizable_for_predic); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 754, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__31);
   __Pyx_GIVEREF(__pyx_tuple__31);
 
-  /* "structureboost/structure_gb.pyx":1024
+  /* "structureboost/structure_gb.pyx":1022
  *         else:
  *             if zero_fraction == 0:
  *                 print('Warning: zero_fraction is 0')             # <<<<<<<<<<<<<<
  *             else:
  *                 total += (pweights[i] / zero_fraction) / ((unique_depth - i) / (unique_depth + 1))
  */
-  __pyx_tuple__45 = PyTuple_Pack(1, __pyx_kp_u_Warning_zero_fraction_is_0); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 1024, __pyx_L1_error)
+  __pyx_tuple__45 = PyTuple_Pack(1, __pyx_kp_u_Warning_zero_fraction_is_0); if (unlikely(!__pyx_tuple__45)) __PYX_ERR(0, 1022, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__45);
   __Pyx_GIVEREF(__pyx_tuple__45);
 
-  /* "structureboost/structure_gb.pyx":1189
+  /* "structureboost/structure_gb.pyx":1187
  *     x_missing = np.isnan(X_in).astype(int)
  *     # Extract tree info from the matrix/tensor representation
  *     dt_thresholds = dt_mat_float[:,0]             # <<<<<<<<<<<<<<
  *     dt_node_weights = dt_mat_float[:,1]
  *     dt_node_vals = dt_mat_float[:,2] # for a single valued output
  */
-  __pyx_tuple__47 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_0); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 1189, __pyx_L1_error)
+  __pyx_tuple__47 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_0); if (unlikely(!__pyx_tuple__47)) __PYX_ERR(0, 1187, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__47);
   __Pyx_GIVEREF(__pyx_tuple__47);
 
-  /* "structureboost/structure_gb.pyx":1191
+  /* "structureboost/structure_gb.pyx":1189
  *     dt_thresholds = dt_mat_float[:,0]
  *     dt_node_weights = dt_mat_float[:,1]
  *     dt_node_vals = dt_mat_float[:,2] # for a single valued output             # <<<<<<<<<<<<<<
  * 
  *     dt_node_type = dt_mat_int[:,0]
  */
-  __pyx_tuple__48 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_2); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 1191, __pyx_L1_error)
+  __pyx_tuple__48 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_2); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 1189, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__48);
   __Pyx_GIVEREF(__pyx_tuple__48);
 
-  /* "structureboost/structure_gb.pyx":1196
+  /* "structureboost/structure_gb.pyx":1194
  *     dt_features = dt_mat_int[:,1]
  *     dt_left_children = dt_mat_int[:,2]
  *     dt_right_children = dt_mat_int[:,3]             # <<<<<<<<<<<<<<
  *     dt_na_left = dt_mat_int[:,4]
  *     dt_default_children = dt_na_left*dt_left_children + (1-dt_na_left)*dt_right_children
  */
-  __pyx_tuple__49 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_3); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 1196, __pyx_L1_error)
+  __pyx_tuple__49 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_3); if (unlikely(!__pyx_tuple__49)) __PYX_ERR(0, 1194, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__49);
   __Pyx_GIVEREF(__pyx_tuple__49);
 
-  /* "structureboost/structure_gb.pyx":1197
+  /* "structureboost/structure_gb.pyx":1195
  *     dt_left_children = dt_mat_int[:,2]
  *     dt_right_children = dt_mat_int[:,3]
  *     dt_na_left = dt_mat_int[:,4]             # <<<<<<<<<<<<<<
  *     dt_default_children = dt_na_left*dt_left_children + (1-dt_na_left)*dt_right_children
  *     dt_num_cat_vals = dt_mat_int[:,5]
  */
-  __pyx_tuple__50 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_4); if (unlikely(!__pyx_tuple__50)) __PYX_ERR(0, 1197, __pyx_L1_error)
+  __pyx_tuple__50 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_4); if (unlikely(!__pyx_tuple__50)) __PYX_ERR(0, 1195, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__50);
   __Pyx_GIVEREF(__pyx_tuple__50);
 
-  /* "structureboost/structure_gb.pyx":1199
+  /* "structureboost/structure_gb.pyx":1197
  *     dt_na_left = dt_mat_int[:,4]
  *     dt_default_children = dt_na_left*dt_left_children + (1-dt_na_left)*dt_right_children
  *     dt_num_cat_vals = dt_mat_int[:,5]             # <<<<<<<<<<<<<<
  *     dt_cat_vals_mat = dt_mat_int[:,6:]
  * 
  */
-  __pyx_tuple__51 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_5); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 1199, __pyx_L1_error)
+  __pyx_tuple__51 = PyTuple_Pack(2, __pyx_slice__5, __pyx_int_5); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 1197, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__51);
   __Pyx_GIVEREF(__pyx_tuple__51);
 
-  /* "structureboost/structure_gb.pyx":1200
+  /* "structureboost/structure_gb.pyx":1198
  *     dt_default_children = dt_na_left*dt_left_children + (1-dt_na_left)*dt_right_children
  *     dt_num_cat_vals = dt_mat_int[:,5]
  *     dt_cat_vals_mat = dt_mat_int[:,6:]             # <<<<<<<<<<<<<<
  * 
  *     # Initialize tracking vectors
  */
-  __pyx_slice__52 = PySlice_New(__pyx_int_6, Py_None, Py_None); if (unlikely(!__pyx_slice__52)) __PYX_ERR(0, 1200, __pyx_L1_error)
+  __pyx_slice__52 = PySlice_New(__pyx_int_6, Py_None, Py_None); if (unlikely(!__pyx_slice__52)) __PYX_ERR(0, 1198, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_slice__52);
   __Pyx_GIVEREF(__pyx_slice__52);
-  __pyx_tuple__53 = PyTuple_Pack(2, __pyx_slice__5, __pyx_slice__52); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 1200, __pyx_L1_error)
+  __pyx_tuple__53 = PyTuple_Pack(2, __pyx_slice__5, __pyx_slice__52); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 1198, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__53);
   __Pyx_GIVEREF(__pyx_tuple__53);
 
   /* "../../../../../../.pyenv/versions/3.9.13/envs/ds3913/lib/python3.9/site-packages/numpy/__init__.pxd":944
  *         __pyx_import_array()
  *     except Exception:
  *         raise ImportError("numpy.core.multiarray failed to import")             # <<<<<<<<<<<<<<
@@ -41930,546 +41916,546 @@
   __pyx_tuple__75 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__75)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__75);
   __Pyx_GIVEREF(__pyx_tuple__75);
   __pyx_tuple__77 = PyTuple_Pack(3, __pyx_int_184977713, __pyx_int_136983863, __pyx_int_112105877); if (unlikely(!__pyx_tuple__77)) __PYX_ERR(2, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__77);
   __Pyx_GIVEREF(__pyx_tuple__77);
 
-  /* "structureboost/structure_gb.pyx":23
+  /* "structureboost/structure_gb.pyx":21
  * 
  * 
  * class StructureBoost(object):             # <<<<<<<<<<<<<<
  *     """Gradient Boosting model allowing categorical structure.
  * 
  */
-  __pyx_tuple__78 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__78)) __PYX_ERR(0, 23, __pyx_L1_error)
+  __pyx_tuple__78 = PyTuple_Pack(1, __pyx_builtin_object); if (unlikely(!__pyx_tuple__78)) __PYX_ERR(0, 21, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__78);
   __Pyx_GIVEREF(__pyx_tuple__78);
 
-  /* "structureboost/structure_gb.pyx":137
+  /* "structureboost/structure_gb.pyx":135
  *     Categorical Variables. https://arxiv.org/abs/2007.04446
  *     """
  *     def __init__(self, num_trees, feature_configs=None,             # <<<<<<<<<<<<<<
  *                  mode='classification',
  *                  loss_fn=None, subsample=1,
  */
-  __pyx_tuple__79 = PyTuple_Pack(19, __pyx_n_s_self, __pyx_n_s_num_trees, __pyx_n_s_feature_configs, __pyx_n_s_mode, __pyx_n_s_loss_fn, __pyx_n_s_subsample, __pyx_n_s_initial_model, __pyx_n_s_replace, __pyx_n_s_min_size_split, __pyx_n_s_max_depth, __pyx_n_s_gamma, __pyx_n_s_reg_lambda, __pyx_n_s_feat_sample_by_tree, __pyx_n_s_feat_sample_by_node, __pyx_n_s_learning_rate, __pyx_n_s_random_seed, __pyx_n_s_na_unseen_action, __pyx_n_s_prec_digits, __pyx_n_s_default_configs); if (unlikely(!__pyx_tuple__79)) __PYX_ERR(0, 137, __pyx_L1_error)
+  __pyx_tuple__79 = PyTuple_Pack(19, __pyx_n_s_self, __pyx_n_s_num_trees, __pyx_n_s_feature_configs, __pyx_n_s_mode, __pyx_n_s_loss_fn, __pyx_n_s_subsample, __pyx_n_s_initial_model, __pyx_n_s_replace, __pyx_n_s_min_size_split, __pyx_n_s_max_depth, __pyx_n_s_gamma, __pyx_n_s_reg_lambda, __pyx_n_s_feat_sample_by_tree, __pyx_n_s_feat_sample_by_node, __pyx_n_s_learning_rate, __pyx_n_s_random_seed, __pyx_n_s_na_unseen_action, __pyx_n_s_prec_digits, __pyx_n_s_default_configs); if (unlikely(!__pyx_tuple__79)) __PYX_ERR(0, 135, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__79);
   __Pyx_GIVEREF(__pyx_tuple__79);
-  __pyx_codeobj_ = (PyObject*)__Pyx_PyCode_New(19, 0, 19, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__79, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_init, 137, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj_)) __PYX_ERR(0, 137, __pyx_L1_error)
-  __pyx_tuple__80 = PyTuple_Pack(17, ((PyObject *)Py_None), ((PyObject*)__pyx_n_u_classification), ((PyObject *)Py_None), ((PyObject *)__pyx_int_1), ((PyObject *)Py_None), ((PyObject *)Py_True), ((PyObject *)__pyx_int_25), ((PyObject *)__pyx_int_3), ((PyObject *)__pyx_int_0), ((PyObject *)__pyx_int_1), ((PyObject *)__pyx_int_1), ((PyObject *)__pyx_int_1), ((PyObject*)__pyx_float__02), ((PyObject *)__pyx_int_0), ((PyObject*)__pyx_n_u_weighted_random), ((PyObject *)__pyx_int_6), ((PyObject *)Py_None)); if (unlikely(!__pyx_tuple__80)) __PYX_ERR(0, 137, __pyx_L1_error)
+  __pyx_codeobj_ = (PyObject*)__Pyx_PyCode_New(19, 0, 19, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__79, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_init, 135, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj_)) __PYX_ERR(0, 135, __pyx_L1_error)
+  __pyx_tuple__80 = PyTuple_Pack(17, ((PyObject *)Py_None), ((PyObject*)__pyx_n_u_classification), ((PyObject *)Py_None), ((PyObject *)__pyx_int_1), ((PyObject *)Py_None), ((PyObject *)Py_True), ((PyObject *)__pyx_int_25), ((PyObject *)__pyx_int_3), ((PyObject *)__pyx_int_0), ((PyObject *)__pyx_int_1), ((PyObject *)__pyx_int_1), ((PyObject *)__pyx_int_1), ((PyObject*)__pyx_float__02), ((PyObject *)__pyx_int_0), ((PyObject*)__pyx_n_u_weighted_random), ((PyObject *)__pyx_int_6), ((PyObject *)Py_None)); if (unlikely(!__pyx_tuple__80)) __PYX_ERR(0, 135, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__80);
   __Pyx_GIVEREF(__pyx_tuple__80);
 
-  /* "structureboost/structure_gb.pyx":193
+  /* "structureboost/structure_gb.pyx":191
  *             self.default_configs = default_config_dict()
  * 
  *     def _validate_feature_config(self):             # <<<<<<<<<<<<<<
  *         valid_ftypes = ['numerical', 'categorical_int',
  *                         'categorical_str', 'graphical_voronoi']
  */
-  __pyx_tuple__81 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_valid_ftypes, __pyx_n_s_cat_smtypes, __pyx_n_s_fn, __pyx_n_s_w_str); if (unlikely(!__pyx_tuple__81)) __PYX_ERR(0, 193, __pyx_L1_error)
+  __pyx_tuple__81 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_valid_ftypes, __pyx_n_s_cat_smtypes, __pyx_n_s_fn, __pyx_n_s_w_str); if (unlikely(!__pyx_tuple__81)) __PYX_ERR(0, 191, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__81);
   __Pyx_GIVEREF(__pyx_tuple__81);
-  __pyx_codeobj__2 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__81, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_validate_feature_config, 193, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__2)) __PYX_ERR(0, 193, __pyx_L1_error)
+  __pyx_codeobj__2 = (PyObject*)__Pyx_PyCode_New(1, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__81, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_validate_feature_config, 191, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__2)) __PYX_ERR(0, 191, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":239
+  /* "structureboost/structure_gb.pyx":237
  *                         warnings.warn(w_str)
  * 
  *     def _process_y_data(self, y_data):             # <<<<<<<<<<<<<<
  *         if type(y_data) == pd.Series:
  *             y_data = y_data.to_numpy().astype(float)
  */
-  __pyx_tuple__82 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_y_data); if (unlikely(!__pyx_tuple__82)) __PYX_ERR(0, 239, __pyx_L1_error)
+  __pyx_tuple__82 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_y_data); if (unlikely(!__pyx_tuple__82)) __PYX_ERR(0, 237, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__82);
   __Pyx_GIVEREF(__pyx_tuple__82);
-  __pyx_codeobj__3 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__82, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_process_y_data, 239, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__3)) __PYX_ERR(0, 239, __pyx_L1_error)
+  __pyx_codeobj__3 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__82, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_process_y_data, 237, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__3)) __PYX_ERR(0, 237, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":246
+  /* "structureboost/structure_gb.pyx":244
  *         return(y_data)
  * 
  *     def _get_initial_pred(self, X_train, y_train):             # <<<<<<<<<<<<<<
  *         if self.initial_model is not None:
  *             if (self.mode == 'classification'):
  */
-  __pyx_tuple__83 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_X_train, __pyx_n_s_y_train, __pyx_n_s_start_probs, __pyx_n_s_prob_est); if (unlikely(!__pyx_tuple__83)) __PYX_ERR(0, 246, __pyx_L1_error)
+  __pyx_tuple__83 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_X_train, __pyx_n_s_y_train, __pyx_n_s_start_probs, __pyx_n_s_prob_est); if (unlikely(!__pyx_tuple__83)) __PYX_ERR(0, 244, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__83);
   __Pyx_GIVEREF(__pyx_tuple__83);
-  __pyx_codeobj__4 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__83, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_get_initial_pred, 246, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__4)) __PYX_ERR(0, 246, __pyx_L1_error)
+  __pyx_codeobj__4 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__83, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_get_initial_pred, 244, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__4)) __PYX_ERR(0, 244, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":262
+  /* "structureboost/structure_gb.pyx":260
  *                 return(np.mean(y_train)*np.ones(X_train.shape[0]))
  * 
  *     def _add_train_next_tree(self, features_for_tree, X_train, y_g_h_train, index):             # <<<<<<<<<<<<<<
  *         self.dec_tree_list.append(stdt.StructureDecisionTree(
  *                         feature_configs=self.feature_configs,
  */
-  __pyx_tuple__84 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_features_for_tree, __pyx_n_s_X_train, __pyx_n_s_y_g_h_train, __pyx_n_s_index); if (unlikely(!__pyx_tuple__84)) __PYX_ERR(0, 262, __pyx_L1_error)
+  __pyx_tuple__84 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_features_for_tree, __pyx_n_s_X_train, __pyx_n_s_y_g_h_train, __pyx_n_s_index); if (unlikely(!__pyx_tuple__84)) __PYX_ERR(0, 260, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__84);
   __Pyx_GIVEREF(__pyx_tuple__84);
-  __pyx_codeobj__7 = (PyObject*)__Pyx_PyCode_New(5, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__84, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_add_train_next_tree, 262, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__7)) __PYX_ERR(0, 262, __pyx_L1_error)
+  __pyx_codeobj__7 = (PyObject*)__Pyx_PyCode_New(5, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__84, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_add_train_next_tree, 260, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__7)) __PYX_ERR(0, 260, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":274
+  /* "structureboost/structure_gb.pyx":272
  *                                   uv_dict=self.unique_vals_dict)
  * 
  *     def process_curr_answer(self, curr_answer):             # <<<<<<<<<<<<<<
  *         return curr_answer
  * 
  */
-  __pyx_tuple__85 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_curr_answer); if (unlikely(!__pyx_tuple__85)) __PYX_ERR(0, 274, __pyx_L1_error)
+  __pyx_tuple__85 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_curr_answer); if (unlikely(!__pyx_tuple__85)) __PYX_ERR(0, 272, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__85);
   __Pyx_GIVEREF(__pyx_tuple__85);
-  __pyx_codeobj__8 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__85, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_process_curr_answer, 274, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__8)) __PYX_ERR(0, 274, __pyx_L1_error)
+  __pyx_codeobj__8 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__85, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_process_curr_answer, 272, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__8)) __PYX_ERR(0, 272, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":277
+  /* "structureboost/structure_gb.pyx":275
  *         return curr_answer
  * 
  *     def compute_gh_mat(self, y_train, curr_answer, index):             # <<<<<<<<<<<<<<
  *         y_g_vec = self.loss_fn_der_1(y_train, curr_answer)
  *         y_h_vec = self.loss_fn_der_2(y_train, curr_answer)
  */
-  __pyx_tuple__86 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_y_train, __pyx_n_s_curr_answer, __pyx_n_s_index, __pyx_n_s_y_g_vec, __pyx_n_s_y_h_vec, __pyx_n_s_y_g_h_mat); if (unlikely(!__pyx_tuple__86)) __PYX_ERR(0, 277, __pyx_L1_error)
+  __pyx_tuple__86 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_y_train, __pyx_n_s_curr_answer, __pyx_n_s_index, __pyx_n_s_y_g_vec, __pyx_n_s_y_h_vec, __pyx_n_s_y_g_h_mat); if (unlikely(!__pyx_tuple__86)) __PYX_ERR(0, 275, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__86);
   __Pyx_GIVEREF(__pyx_tuple__86);
-  __pyx_codeobj__9 = (PyObject*)__Pyx_PyCode_New(4, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__86, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_compute_gh_mat, 277, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__9)) __PYX_ERR(0, 277, __pyx_L1_error)
+  __pyx_codeobj__9 = (PyObject*)__Pyx_PyCode_New(4, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__86, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_compute_gh_mat, 275, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__9)) __PYX_ERR(0, 275, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":284
+  /* "structureboost/structure_gb.pyx":282
  * 
  * 
  *     def _compute_loss(self, y_true, pred):             # <<<<<<<<<<<<<<
  *         if ((self.mode == 'classification')):
  *             return(my_log_loss(y_true, 1/(1+np.exp(-pred))))
  */
-  __pyx_tuple__87 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_y_true, __pyx_n_s_pred); if (unlikely(!__pyx_tuple__87)) __PYX_ERR(0, 284, __pyx_L1_error)
+  __pyx_tuple__87 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_y_true, __pyx_n_s_pred); if (unlikely(!__pyx_tuple__87)) __PYX_ERR(0, 282, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__87);
   __Pyx_GIVEREF(__pyx_tuple__87);
-  __pyx_codeobj__10 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__87, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_compute_loss, 284, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__10)) __PYX_ERR(0, 284, __pyx_L1_error)
+  __pyx_codeobj__10 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__87, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_compute_loss, 282, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__10)) __PYX_ERR(0, 282, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":290
+  /* "structureboost/structure_gb.pyx":288
  *             return(my_mean_squared_error(y_true, pred))
  * 
  *     def _update_curr_answer(self, curr_answer, X_train, index):             # <<<<<<<<<<<<<<
  *         if (index>0):
  *             curr_answer = (curr_answer + self.learning_rate *
  */
-  __pyx_tuple__88 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_curr_answer, __pyx_n_s_X_train, __pyx_n_s_index); if (unlikely(!__pyx_tuple__88)) __PYX_ERR(0, 290, __pyx_L1_error)
+  __pyx_tuple__88 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_curr_answer, __pyx_n_s_X_train, __pyx_n_s_index); if (unlikely(!__pyx_tuple__88)) __PYX_ERR(0, 288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__88);
   __Pyx_GIVEREF(__pyx_tuple__88);
-  __pyx_codeobj__11 = (PyObject*)__Pyx_PyCode_New(4, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__88, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_update_curr_answer, 290, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 290, __pyx_L1_error)
+  __pyx_codeobj__11 = (PyObject*)__Pyx_PyCode_New(4, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__88, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_update_curr_answer, 288, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 288, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":296
+  /* "structureboost/structure_gb.pyx":294
  *         return(curr_answer)
  * 
  *     def _get_rows_for_tree(self, num_rows):             # <<<<<<<<<<<<<<
  *         if (self.subsample == 1) and (not self.replace):
  *             return np.arange(num_rows)
  */
-  __pyx_tuple__89 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_num_rows, __pyx_n_s_rows_to_return); if (unlikely(!__pyx_tuple__89)) __PYX_ERR(0, 296, __pyx_L1_error)
+  __pyx_tuple__89 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_num_rows, __pyx_n_s_rows_to_return); if (unlikely(!__pyx_tuple__89)) __PYX_ERR(0, 294, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__89);
   __Pyx_GIVEREF(__pyx_tuple__89);
-  __pyx_codeobj__12 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__89, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_get_rows_for_tree, 296, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__12)) __PYX_ERR(0, 296, __pyx_L1_error)
+  __pyx_codeobj__12 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__89, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_get_rows_for_tree, 294, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__12)) __PYX_ERR(0, 294, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":306
+  /* "structureboost/structure_gb.pyx":304
  * 
  * 
  *     def _get_features_for_tree(self):             # <<<<<<<<<<<<<<
  *         if self.feat_sample_by_tree < 1:
  *             feat_set_size = (self.feat_sample_by_tree *
  */
-  __pyx_tuple__90 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_feat_set_size, __pyx_n_s_features_for_tree); if (unlikely(!__pyx_tuple__90)) __PYX_ERR(0, 306, __pyx_L1_error)
+  __pyx_tuple__90 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_feat_set_size, __pyx_n_s_features_for_tree); if (unlikely(!__pyx_tuple__90)) __PYX_ERR(0, 304, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__90);
   __Pyx_GIVEREF(__pyx_tuple__90);
-  __pyx_codeobj__13 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__90, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_get_features_for_tree, 306, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__13)) __PYX_ERR(0, 306, __pyx_L1_error)
+  __pyx_codeobj__13 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__90, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_get_features_for_tree, 304, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__13)) __PYX_ERR(0, 304, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":320
+  /* "structureboost/structure_gb.pyx":318
  *             features_for_tree = self.feat_list_full
  * 
  *     def _output_loss_check_stop(self, y_valid, curr_valid_answer, i):             # <<<<<<<<<<<<<<
  *         stop_now=False
  *         if ((i+1) % self.eval_freq == 1) and (i>0):
  */
-  __pyx_tuple__91 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_y_valid, __pyx_n_s_curr_valid_answer, __pyx_n_s_i, __pyx_n_s_stop_now, __pyx_n_s_curr_loss); if (unlikely(!__pyx_tuple__91)) __PYX_ERR(0, 320, __pyx_L1_error)
+  __pyx_tuple__91 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_y_valid, __pyx_n_s_curr_valid_answer, __pyx_n_s_i, __pyx_n_s_stop_now, __pyx_n_s_curr_loss); if (unlikely(!__pyx_tuple__91)) __PYX_ERR(0, 318, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__91);
   __Pyx_GIVEREF(__pyx_tuple__91);
-  __pyx_codeobj__14 = (PyObject*)__Pyx_PyCode_New(4, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_output_loss_check_stop, 320, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__14)) __PYX_ERR(0, 320, __pyx_L1_error)
+  __pyx_codeobj__14 = (PyObject*)__Pyx_PyCode_New(4, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__91, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_output_loss_check_stop, 318, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__14)) __PYX_ERR(0, 318, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":343
+  /* "structureboost/structure_gb.pyx":341
  *         return(stop_now)
  * 
  *     def _initialize_uv_dict(self, X_train):             # <<<<<<<<<<<<<<
  *         self.unique_vals_dict = {}
  *         for feature in self.feature_configs.keys():
  */
-  __pyx_tuple__92 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_X_train, __pyx_n_s_feature); if (unlikely(!__pyx_tuple__92)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_tuple__92 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_X_train, __pyx_n_s_feature); if (unlikely(!__pyx_tuple__92)) __PYX_ERR(0, 341, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__92);
   __Pyx_GIVEREF(__pyx_tuple__92);
-  __pyx_codeobj__15 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__92, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_initialize_uv_dict, 343, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__15)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_codeobj__15 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__92, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_initialize_uv_dict, 341, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__15)) __PYX_ERR(0, 341, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":351
+  /* "structureboost/structure_gb.pyx":349
  *                                         decimals=self.prec_digits)))
  * 
  *     def _init_eval_set_info(self, eval_set, y_train):             # <<<<<<<<<<<<<<
  *         self.eval_results = np.zeros(np.floor(
  *                                 self.num_trees/self.eval_freq).astype(int))
  */
-  __pyx_tuple__93 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_eval_set, __pyx_n_s_y_train, __pyx_n_s_X_valid, __pyx_n_s_y_valid, __pyx_n_s_curr_valid_answer, __pyx_n_s_curr_valid_loss); if (unlikely(!__pyx_tuple__93)) __PYX_ERR(0, 351, __pyx_L1_error)
+  __pyx_tuple__93 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_eval_set, __pyx_n_s_y_train, __pyx_n_s_X_valid, __pyx_n_s_y_valid, __pyx_n_s_curr_valid_answer, __pyx_n_s_curr_valid_loss); if (unlikely(!__pyx_tuple__93)) __PYX_ERR(0, 349, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__93);
   __Pyx_GIVEREF(__pyx_tuple__93);
-  __pyx_codeobj__16 = (PyObject*)__Pyx_PyCode_New(3, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__93, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_init_eval_set_info, 351, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__16)) __PYX_ERR(0, 351, __pyx_L1_error)
+  __pyx_codeobj__16 = (PyObject*)__Pyx_PyCode_New(3, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__93, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_init_eval_set_info, 349, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__16)) __PYX_ERR(0, 349, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":366
+  /* "structureboost/structure_gb.pyx":364
  *         return(X_valid, y_valid, curr_valid_answer)
  * 
  *     def _output_no_evalset(self, index):             # <<<<<<<<<<<<<<
  *         if (((index+1) % self.eval_freq == 1) and self.verbose):
  *                 print("i={}".format(index))
  */
-  __pyx_tuple__94 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_index); if (unlikely(!__pyx_tuple__94)) __PYX_ERR(0, 366, __pyx_L1_error)
+  __pyx_tuple__94 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_index); if (unlikely(!__pyx_tuple__94)) __PYX_ERR(0, 364, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__94);
   __Pyx_GIVEREF(__pyx_tuple__94);
-  __pyx_codeobj__17 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__94, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_output_no_evalset, 366, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__17)) __PYX_ERR(0, 366, __pyx_L1_error)
+  __pyx_codeobj__17 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__94, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_output_no_evalset, 364, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__17)) __PYX_ERR(0, 364, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":371
+  /* "structureboost/structure_gb.pyx":369
  * 
  * 
  *     def fit(self, X_train, y_train, eval_set=None, eval_freq=10,             # <<<<<<<<<<<<<<
  *             early_stop_past_steps=0, choose_best_eval=True, verbose=1):
  *         """Fits the model given training features and labels.
  */
-  __pyx_tuple__95 = PyTuple_Pack(23, __pyx_n_s_self, __pyx_n_s_X_train, __pyx_n_s_y_train, __pyx_n_s_eval_set, __pyx_n_s_eval_freq, __pyx_n_s_early_stop_past_steps, __pyx_n_s_choose_best_eval, __pyx_n_s_verbose, __pyx_n_s_num_rows, __pyx_n_s_col_list, __pyx_n_s_curr_answer, __pyx_n_s_X_valid, __pyx_n_s_y_valid, __pyx_n_s_curr_valid_answer, __pyx_n_s_stop_now, __pyx_n_s_i, __pyx_n_s_y_g_h_mat, __pyx_n_s_rows_to_use, __pyx_n_s_features_for_tree, __pyx_n_s_X_train_to_use, __pyx_n_s_y_g_h_to_use, __pyx_n_s_i, __pyx_n_s_dt); if (unlikely(!__pyx_tuple__95)) __PYX_ERR(0, 371, __pyx_L1_error)
+  __pyx_tuple__95 = PyTuple_Pack(23, __pyx_n_s_self, __pyx_n_s_X_train, __pyx_n_s_y_train, __pyx_n_s_eval_set, __pyx_n_s_eval_freq, __pyx_n_s_early_stop_past_steps, __pyx_n_s_choose_best_eval, __pyx_n_s_verbose, __pyx_n_s_num_rows, __pyx_n_s_col_list, __pyx_n_s_curr_answer, __pyx_n_s_X_valid, __pyx_n_s_y_valid, __pyx_n_s_curr_valid_answer, __pyx_n_s_stop_now, __pyx_n_s_i, __pyx_n_s_y_g_h_mat, __pyx_n_s_rows_to_use, __pyx_n_s_features_for_tree, __pyx_n_s_X_train_to_use, __pyx_n_s_y_g_h_to_use, __pyx_n_s_i, __pyx_n_s_dt); if (unlikely(!__pyx_tuple__95)) __PYX_ERR(0, 369, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__95);
   __Pyx_GIVEREF(__pyx_tuple__95);
-  __pyx_codeobj__18 = (PyObject*)__Pyx_PyCode_New(8, 0, 23, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__95, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_fit, 371, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__18)) __PYX_ERR(0, 371, __pyx_L1_error)
-  __pyx_tuple__96 = PyTuple_Pack(5, ((PyObject *)Py_None), ((PyObject *)__pyx_int_10), ((PyObject *)__pyx_int_0), ((PyObject *)Py_True), ((PyObject *)__pyx_int_1)); if (unlikely(!__pyx_tuple__96)) __PYX_ERR(0, 371, __pyx_L1_error)
+  __pyx_codeobj__18 = (PyObject*)__Pyx_PyCode_New(8, 0, 23, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__95, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_fit, 369, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__18)) __PYX_ERR(0, 369, __pyx_L1_error)
+  __pyx_tuple__96 = PyTuple_Pack(5, ((PyObject *)Py_None), ((PyObject *)__pyx_int_10), ((PyObject *)__pyx_int_0), ((PyObject *)Py_True), ((PyObject *)__pyx_int_1)); if (unlikely(!__pyx_tuple__96)) __PYX_ERR(0, 369, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__96);
   __Pyx_GIVEREF(__pyx_tuple__96);
 
-  /* "structureboost/structure_gb.pyx":483
+  /* "structureboost/structure_gb.pyx":481
  *             self.get_tensors_for_predict()
  * 
  *     def predict(self, X_test, int num_trees_to_use=-1, same_col_pos=True):             # <<<<<<<<<<<<<<
  *         """Returns a one-dimensional response - probability of 1 or numeric prediction
  * 
  */
-  __pyx_tuple__97 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_X_test, __pyx_n_s_num_trees_to_use, __pyx_n_s_same_col_pos, __pyx_n_s_inv_cti, __pyx_n_s_col_list, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_i); if (unlikely(!__pyx_tuple__97)) __PYX_ERR(0, 483, __pyx_L1_error)
+  __pyx_tuple__97 = PyTuple_Pack(9, __pyx_n_s_self, __pyx_n_s_X_test, __pyx_n_s_num_trees_to_use, __pyx_n_s_same_col_pos, __pyx_n_s_inv_cti, __pyx_n_s_col_list, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_i); if (unlikely(!__pyx_tuple__97)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__97);
   __Pyx_GIVEREF(__pyx_tuple__97);
-  __pyx_codeobj__19 = (PyObject*)__Pyx_PyCode_New(4, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__97, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_predict, 483, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__19)) __PYX_ERR(0, 483, __pyx_L1_error)
+  __pyx_codeobj__19 = (PyObject*)__Pyx_PyCode_New(4, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__97, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_predict, 481, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__19)) __PYX_ERR(0, 481, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":564
+  /* "structureboost/structure_gb.pyx":562
  *                 return(self._predict_py(X_test, num_trees_to_use))
  * 
  *     def _predict_py(self, X_test, int num_trees_to_use=-1):             # <<<<<<<<<<<<<<
  *         cdef int i
  *         if num_trees_to_use == -1:
  */
-  __pyx_tuple__98 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_X_test, __pyx_n_s_num_trees_to_use, __pyx_n_s_i, __pyx_n_s_out_vec); if (unlikely(!__pyx_tuple__98)) __PYX_ERR(0, 564, __pyx_L1_error)
+  __pyx_tuple__98 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_X_test, __pyx_n_s_num_trees_to_use, __pyx_n_s_i, __pyx_n_s_out_vec); if (unlikely(!__pyx_tuple__98)) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__98);
   __Pyx_GIVEREF(__pyx_tuple__98);
-  __pyx_codeobj__20 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__98, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_predict_py, 564, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__20)) __PYX_ERR(0, 564, __pyx_L1_error)
+  __pyx_codeobj__20 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__98, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_predict_py, 562, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__20)) __PYX_ERR(0, 562, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":585
+  /* "structureboost/structure_gb.pyx":583
  *             return(out_vec)
  * 
  *     def predict_proba(self, X_test, int num_trees_to_use=-1):             # <<<<<<<<<<<<<<
  *         """Returns a n x 2 matrix of class probabilities
  * 
  */
-  __pyx_tuple__99 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_X_test, __pyx_n_s_num_trees_to_use, __pyx_n_s_pred_probs); if (unlikely(!__pyx_tuple__99)) __PYX_ERR(0, 585, __pyx_L1_error)
+  __pyx_tuple__99 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_X_test, __pyx_n_s_num_trees_to_use, __pyx_n_s_pred_probs); if (unlikely(!__pyx_tuple__99)) __PYX_ERR(0, 583, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__99);
   __Pyx_GIVEREF(__pyx_tuple__99);
-  __pyx_codeobj__21 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__99, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_predict_proba, 585, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__21)) __PYX_ERR(0, 585, __pyx_L1_error)
+  __pyx_codeobj__21 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__99, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_predict_proba, 583, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__21)) __PYX_ERR(0, 583, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":615
+  /* "structureboost/structure_gb.pyx":613
  *         return(np.vstack((1-pred_probs, pred_probs)).T)
  * 
  *     def _predict_fast(self, X_test, int num_trees_to_use=-1):             # <<<<<<<<<<<<<<
  *         cdef int i
  * 
  */
-  __pyx_tuple__100 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_X_test, __pyx_n_s_num_trees_to_use, __pyx_n_s_i, __pyx_n_s_out_vec, __pyx_n_s_tree_pred_mat); if (unlikely(!__pyx_tuple__100)) __PYX_ERR(0, 615, __pyx_L1_error)
+  __pyx_tuple__100 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_X_test, __pyx_n_s_num_trees_to_use, __pyx_n_s_i, __pyx_n_s_out_vec, __pyx_n_s_tree_pred_mat); if (unlikely(!__pyx_tuple__100)) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__100);
   __Pyx_GIVEREF(__pyx_tuple__100);
-  __pyx_codeobj__22 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__100, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_predict_fast, 615, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__22)) __PYX_ERR(0, 615, __pyx_L1_error)
+  __pyx_codeobj__22 = (PyObject*)__Pyx_PyCode_New(3, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__100, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_predict_fast, 613, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__22)) __PYX_ERR(0, 613, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":638
+  /* "structureboost/structure_gb.pyx":636
  *             return(out_vec)
  * 
  *     def _process_feature_configs(self):             # <<<<<<<<<<<<<<
  *         fg = {}
  *         for feat_name in self.feature_configs.keys():
  */
-  __pyx_tuple__101 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_fg, __pyx_n_s_feat_name); if (unlikely(!__pyx_tuple__101)) __PYX_ERR(0, 638, __pyx_L1_error)
+  __pyx_tuple__101 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_fg, __pyx_n_s_feat_name); if (unlikely(!__pyx_tuple__101)) __PYX_ERR(0, 636, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__101);
   __Pyx_GIVEREF(__pyx_tuple__101);
-  __pyx_codeobj__23 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__101, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_process_feature_configs, 638, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__23)) __PYX_ERR(0, 638, __pyx_L1_error)
+  __pyx_codeobj__23 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__101, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_process_feature_configs, 636, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__23)) __PYX_ERR(0, 636, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":650
+  /* "structureboost/structure_gb.pyx":648
  *         self.feature_graphs = fg
  * 
  *     def predict_shap(self, X_test, int num_trees_to_use=-1, same_col_pos=True):             # <<<<<<<<<<<<<<
  *         if (type(X_test)==np.ndarray):
  *             if self.optimizable:
  */
-  __pyx_tuple__102 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_X_test, __pyx_n_s_num_trees_to_use, __pyx_n_s_same_col_pos); if (unlikely(!__pyx_tuple__102)) __PYX_ERR(0, 650, __pyx_L1_error)
+  __pyx_tuple__102 = PyTuple_Pack(4, __pyx_n_s_self, __pyx_n_s_X_test, __pyx_n_s_num_trees_to_use, __pyx_n_s_same_col_pos); if (unlikely(!__pyx_tuple__102)) __PYX_ERR(0, 648, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__102);
   __Pyx_GIVEREF(__pyx_tuple__102);
-  __pyx_codeobj__24 = (PyObject*)__Pyx_PyCode_New(4, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__102, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_predict_shap_2, 650, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__24)) __PYX_ERR(0, 650, __pyx_L1_error)
+  __pyx_codeobj__24 = (PyObject*)__Pyx_PyCode_New(4, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__102, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_predict_shap_2, 648, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__24)) __PYX_ERR(0, 648, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":671
+  /* "structureboost/structure_gb.pyx":669
  *                 print('columns must be in correct order for shap values')
  * 
  *     def _predict_shap(self,             # <<<<<<<<<<<<<<
  *                     np.ndarray[double, ndim=2] X_test, int num_trees_to_use=-1):
  *         cdef long i,j
  */
-  __pyx_tuple__103 = PyTuple_Pack(12, __pyx_n_s_self, __pyx_n_s_X_test, __pyx_n_s_num_trees_to_use, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_nrows, __pyx_n_s_nfeat, __pyx_n_s_start_pred, __pyx_n_s_phi_out, __pyx_n_s_dt_mat_int, __pyx_n_s_dt_mat_float, __pyx_n_s_curr_pt); if (unlikely(!__pyx_tuple__103)) __PYX_ERR(0, 671, __pyx_L1_error)
+  __pyx_tuple__103 = PyTuple_Pack(12, __pyx_n_s_self, __pyx_n_s_X_test, __pyx_n_s_num_trees_to_use, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_nrows, __pyx_n_s_nfeat, __pyx_n_s_start_pred, __pyx_n_s_phi_out, __pyx_n_s_dt_mat_int, __pyx_n_s_dt_mat_float, __pyx_n_s_curr_pt); if (unlikely(!__pyx_tuple__103)) __PYX_ERR(0, 669, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__103);
   __Pyx_GIVEREF(__pyx_tuple__103);
-  __pyx_codeobj__27 = (PyObject*)__Pyx_PyCode_New(3, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__103, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_predict_shap, 671, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__27)) __PYX_ERR(0, 671, __pyx_L1_error)
+  __pyx_codeobj__27 = (PyObject*)__Pyx_PyCode_New(3, 0, 12, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__103, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_predict_shap, 669, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__27)) __PYX_ERR(0, 669, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":696
+  /* "structureboost/structure_gb.pyx":694
  * 
  * 
  *     def rerandomize_na_dir_weighted_all_trees(self):             # <<<<<<<<<<<<<<
  *         for i in range(len(self.dec_tree_list)):
  *             curr_tree = self.dec_tree_list[i].dec_tree
  */
-  __pyx_tuple__104 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_i, __pyx_n_s_curr_tree); if (unlikely(!__pyx_tuple__104)) __PYX_ERR(0, 696, __pyx_L1_error)
+  __pyx_tuple__104 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_i, __pyx_n_s_curr_tree); if (unlikely(!__pyx_tuple__104)) __PYX_ERR(0, 694, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__104);
   __Pyx_GIVEREF(__pyx_tuple__104);
-  __pyx_codeobj__28 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__104, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_rerandomize_na_dir_weighted_all, 696, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 696, __pyx_L1_error)
+  __pyx_codeobj__28 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__104, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_rerandomize_na_dir_weighted_all, 694, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 694, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":702
+  /* "structureboost/structure_gb.pyx":700
  *                 randomize_node_na_dir_weighted(curr_tree)
  * 
  *     def remap_predict_columns(self, new_col_struct):             # <<<<<<<<<<<<<<
  *         """Indicate which column in numpy array each feature is located.
  * 
  */
-  __pyx_tuple__105 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_new_col_struct, __pyx_n_s_col_list, __pyx_n_s_w_str, __pyx_n_s_i, __pyx_n_s_i); if (unlikely(!__pyx_tuple__105)) __PYX_ERR(0, 702, __pyx_L1_error)
+  __pyx_tuple__105 = PyTuple_Pack(6, __pyx_n_s_self, __pyx_n_s_new_col_struct, __pyx_n_s_col_list, __pyx_n_s_w_str, __pyx_n_s_i, __pyx_n_s_i); if (unlikely(!__pyx_tuple__105)) __PYX_ERR(0, 700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__105);
   __Pyx_GIVEREF(__pyx_tuple__105);
-  __pyx_codeobj__29 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__105, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_remap_predict_columns, 702, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__29)) __PYX_ERR(0, 702, __pyx_L1_error)
+  __pyx_codeobj__29 = (PyObject*)__Pyx_PyCode_New(2, 0, 6, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__105, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_remap_predict_columns, 700, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__29)) __PYX_ERR(0, 700, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":745
+  /* "structureboost/structure_gb.pyx":743
  *             warnings.warn(w_str)
  * 
  *     def get_tensors_for_predict(self):             # <<<<<<<<<<<<<<
  *         if self.optimizable:
  *             cat_size = np.max(np.array([dt.get_max_split_size() for dt in self.dec_tree_list]))
  */
-  __pyx_tuple__106 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_cat_size, __pyx_n_s_num_dt, __pyx_n_s_max_nodes, __pyx_n_s_i, __pyx_n_s_dt, __pyx_n_s_dt); if (unlikely(!__pyx_tuple__106)) __PYX_ERR(0, 745, __pyx_L1_error)
+  __pyx_tuple__106 = PyTuple_Pack(7, __pyx_n_s_self, __pyx_n_s_cat_size, __pyx_n_s_num_dt, __pyx_n_s_max_nodes, __pyx_n_s_i, __pyx_n_s_dt, __pyx_n_s_dt); if (unlikely(!__pyx_tuple__106)) __PYX_ERR(0, 743, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__106);
   __Pyx_GIVEREF(__pyx_tuple__106);
-  __pyx_codeobj__30 = (PyObject*)__Pyx_PyCode_New(1, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__106, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_get_tensors_for_predict, 745, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 745, __pyx_L1_error)
+  __pyx_codeobj__30 = (PyObject*)__Pyx_PyCode_New(1, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__106, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_get_tensors_for_predict, 743, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 743, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":758
+  /* "structureboost/structure_gb.pyx":756
  *             print("Model not optimizable for predict due to string or voronoi variable.")
  * 
  *     def convert_dt_to_matrix(self, dt_num):             # <<<<<<<<<<<<<<
  *         curr_node = self.dec_tree_list[dt_num].dec_tree
  *         self.convert_subtree(curr_node, dt_num)
  */
-  __pyx_tuple__107 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_dt_num, __pyx_n_s_curr_node); if (unlikely(!__pyx_tuple__107)) __PYX_ERR(0, 758, __pyx_L1_error)
+  __pyx_tuple__107 = PyTuple_Pack(3, __pyx_n_s_self, __pyx_n_s_dt_num, __pyx_n_s_curr_node); if (unlikely(!__pyx_tuple__107)) __PYX_ERR(0, 756, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__107);
   __Pyx_GIVEREF(__pyx_tuple__107);
-  __pyx_codeobj__32 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__107, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_convert_dt_to_matrix, 758, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 758, __pyx_L1_error)
+  __pyx_codeobj__32 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__107, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_convert_dt_to_matrix, 756, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 756, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":762
+  /* "structureboost/structure_gb.pyx":760
  *         self.convert_subtree(curr_node, dt_num)
  * 
  *     def convert_subtree(self, node, dt_num):             # <<<<<<<<<<<<<<
  *         ni = node['node_index']
  *         if node['node_type']=='leaf':
  */
-  __pyx_tuple__108 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_node, __pyx_n_s_dt_num, __pyx_n_s_ni, __pyx_n_s_setlen); if (unlikely(!__pyx_tuple__108)) __PYX_ERR(0, 762, __pyx_L1_error)
+  __pyx_tuple__108 = PyTuple_Pack(5, __pyx_n_s_self, __pyx_n_s_node, __pyx_n_s_dt_num, __pyx_n_s_ni, __pyx_n_s_setlen); if (unlikely(!__pyx_tuple__108)) __PYX_ERR(0, 760, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__108);
   __Pyx_GIVEREF(__pyx_tuple__108);
-  __pyx_codeobj__33 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__108, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_convert_subtree, 762, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__33)) __PYX_ERR(0, 762, __pyx_L1_error)
+  __pyx_codeobj__33 = (PyObject*)__Pyx_PyCode_New(3, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__108, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_convert_subtree, 760, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__33)) __PYX_ERR(0, 760, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":786
+  /* "structureboost/structure_gb.pyx":784
  * 
  * 
  * def _mse_der_1(y_true, y_pred, eps=1e-15):             # <<<<<<<<<<<<<<
  *     return(2*(y_pred-y_true))
  * 
  */
-  __pyx_tuple__109 = PyTuple_Pack(3, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_eps); if (unlikely(!__pyx_tuple__109)) __PYX_ERR(0, 786, __pyx_L1_error)
+  __pyx_tuple__109 = PyTuple_Pack(3, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_eps); if (unlikely(!__pyx_tuple__109)) __PYX_ERR(0, 784, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__109);
   __Pyx_GIVEREF(__pyx_tuple__109);
-  __pyx_codeobj__34 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__109, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_mse_der_1, 786, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 786, __pyx_L1_error)
+  __pyx_codeobj__34 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__109, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_mse_der_1, 784, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 784, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":790
+  /* "structureboost/structure_gb.pyx":788
  * 
  * 
  * def _mse_der_2(y_true, y_pred, eps=1e-15):             # <<<<<<<<<<<<<<
  *     return(2*np.ones(len(y_pred)))
  * 
  */
-  __pyx_tuple__110 = PyTuple_Pack(3, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_eps); if (unlikely(!__pyx_tuple__110)) __PYX_ERR(0, 790, __pyx_L1_error)
+  __pyx_tuple__110 = PyTuple_Pack(3, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_eps); if (unlikely(!__pyx_tuple__110)) __PYX_ERR(0, 788, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__110);
   __Pyx_GIVEREF(__pyx_tuple__110);
-  __pyx_codeobj__35 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__110, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_mse_der_2, 790, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__35)) __PYX_ERR(0, 790, __pyx_L1_error)
+  __pyx_codeobj__35 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__110, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_mse_der_2, 788, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__35)) __PYX_ERR(0, 788, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":794
+  /* "structureboost/structure_gb.pyx":792
  * 
  * 
  * def _entropy_link_der_1(y_true, z_pred, eps=1e-15):             # <<<<<<<<<<<<<<
  *     return(-y_true*(1/(1+np.exp(z_pred))) + (1-y_true) *
  *            (1/(1+np.exp(-z_pred))))
  */
-  __pyx_tuple__111 = PyTuple_Pack(3, __pyx_n_s_y_true, __pyx_n_s_z_pred, __pyx_n_s_eps); if (unlikely(!__pyx_tuple__111)) __PYX_ERR(0, 794, __pyx_L1_error)
+  __pyx_tuple__111 = PyTuple_Pack(3, __pyx_n_s_y_true, __pyx_n_s_z_pred, __pyx_n_s_eps); if (unlikely(!__pyx_tuple__111)) __PYX_ERR(0, 792, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__111);
   __Pyx_GIVEREF(__pyx_tuple__111);
-  __pyx_codeobj__36 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__111, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_entropy_link_der_1, 794, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 794, __pyx_L1_error)
+  __pyx_codeobj__36 = (PyObject*)__Pyx_PyCode_New(3, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__111, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_entropy_link_der_1, 792, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 792, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":799
+  /* "structureboost/structure_gb.pyx":797
  * 
  * 
  * def _entropy_link_der_2(y_true, z_pred, eps=1e-15):             # <<<<<<<<<<<<<<
  *     z_pred_exp = np.exp(z_pred)
  *     minus_z_pred_exp = np.exp(-z_pred)
  */
-  __pyx_tuple__112 = PyTuple_Pack(7, __pyx_n_s_y_true, __pyx_n_s_z_pred, __pyx_n_s_eps, __pyx_n_s_z_pred_exp, __pyx_n_s_minus_z_pred_exp, __pyx_n_s_denom_1, __pyx_n_s_denom_2); if (unlikely(!__pyx_tuple__112)) __PYX_ERR(0, 799, __pyx_L1_error)
+  __pyx_tuple__112 = PyTuple_Pack(7, __pyx_n_s_y_true, __pyx_n_s_z_pred, __pyx_n_s_eps, __pyx_n_s_z_pred_exp, __pyx_n_s_minus_z_pred_exp, __pyx_n_s_denom_1, __pyx_n_s_denom_2); if (unlikely(!__pyx_tuple__112)) __PYX_ERR(0, 797, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__112);
   __Pyx_GIVEREF(__pyx_tuple__112);
-  __pyx_codeobj__37 = (PyObject*)__Pyx_PyCode_New(3, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__112, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_entropy_link_der_2, 799, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__37)) __PYX_ERR(0, 799, __pyx_L1_error)
+  __pyx_codeobj__37 = (PyObject*)__Pyx_PyCode_New(3, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__112, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_entropy_link_der_2, 797, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__37)) __PYX_ERR(0, 797, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":808
+  /* "structureboost/structure_gb.pyx":806
  * 
  * 
  * def my_log_loss(y_true, y_pred, eps=1e-16):             # <<<<<<<<<<<<<<
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(y_true*(np.log(y_pred)) + (1-y_true)*np.log(1-y_pred))
  */
-  __pyx_tuple__113 = PyTuple_Pack(4, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_eps, __pyx_n_s_out_val); if (unlikely(!__pyx_tuple__113)) __PYX_ERR(0, 808, __pyx_L1_error)
+  __pyx_tuple__113 = PyTuple_Pack(4, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_eps, __pyx_n_s_out_val); if (unlikely(!__pyx_tuple__113)) __PYX_ERR(0, 806, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__113);
   __Pyx_GIVEREF(__pyx_tuple__113);
-  __pyx_codeobj__38 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__113, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_my_log_loss, 808, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__38)) __PYX_ERR(0, 808, __pyx_L1_error)
+  __pyx_codeobj__38 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__113, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_my_log_loss, 806, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__38)) __PYX_ERR(0, 806, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":814
+  /* "structureboost/structure_gb.pyx":812
  * 
  * 
  * def my_log_loss_vec(y_true_mat, y_pred, eps=1e-16):             # <<<<<<<<<<<<<<
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(np.sum(y_true_mat*np.log(y_pred),axis=1))
  */
-  __pyx_tuple__114 = PyTuple_Pack(4, __pyx_n_s_y_true_mat, __pyx_n_s_y_pred, __pyx_n_s_eps, __pyx_n_s_out_val); if (unlikely(!__pyx_tuple__114)) __PYX_ERR(0, 814, __pyx_L1_error)
+  __pyx_tuple__114 = PyTuple_Pack(4, __pyx_n_s_y_true_mat, __pyx_n_s_y_pred, __pyx_n_s_eps, __pyx_n_s_out_val); if (unlikely(!__pyx_tuple__114)) __PYX_ERR(0, 812, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__114);
   __Pyx_GIVEREF(__pyx_tuple__114);
-  __pyx_codeobj__39 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__114, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_my_log_loss_vec, 814, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__39)) __PYX_ERR(0, 814, __pyx_L1_error)
+  __pyx_codeobj__39 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__114, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_my_log_loss_vec, 812, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__39)) __PYX_ERR(0, 812, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":820
+  /* "structureboost/structure_gb.pyx":818
  * 
  * 
  * def my_mean_squared_error(y_true, y_pred):             # <<<<<<<<<<<<<<
  *     return(np.mean((y_true-y_pred)*(y_true-y_pred)))
  * 
  */
-  __pyx_tuple__115 = PyTuple_Pack(2, __pyx_n_s_y_true, __pyx_n_s_y_pred); if (unlikely(!__pyx_tuple__115)) __PYX_ERR(0, 820, __pyx_L1_error)
+  __pyx_tuple__115 = PyTuple_Pack(2, __pyx_n_s_y_true, __pyx_n_s_y_pred); if (unlikely(!__pyx_tuple__115)) __PYX_ERR(0, 818, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__115);
   __Pyx_GIVEREF(__pyx_tuple__115);
-  __pyx_codeobj__40 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__115, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_my_mean_squared_error, 820, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__40)) __PYX_ERR(0, 820, __pyx_L1_error)
+  __pyx_codeobj__40 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__115, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_my_mean_squared_error, 818, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__40)) __PYX_ERR(0, 818, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":824
+  /* "structureboost/structure_gb.pyx":822
  * 
  * 
  * def randomize_node_na_dir_weighted(curr_node):             # <<<<<<<<<<<<<<
  *     if (('node_type' in curr_node.keys()) and
  *                 (curr_node['node_type'] == 'interior')):
  */
-  __pyx_tuple__116 = PyTuple_Pack(3, __pyx_n_s_curr_node, __pyx_n_s_lw, __pyx_n_s_rw); if (unlikely(!__pyx_tuple__116)) __PYX_ERR(0, 824, __pyx_L1_error)
+  __pyx_tuple__116 = PyTuple_Pack(3, __pyx_n_s_curr_node, __pyx_n_s_lw, __pyx_n_s_rw); if (unlikely(!__pyx_tuple__116)) __PYX_ERR(0, 822, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__116);
   __Pyx_GIVEREF(__pyx_tuple__116);
-  __pyx_codeobj__41 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__116, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_randomize_node_na_dir_weighted, 824, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__41)) __PYX_ERR(0, 824, __pyx_L1_error)
+  __pyx_codeobj__41 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__116, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_randomize_node_na_dir_weighted, 822, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__41)) __PYX_ERR(0, 822, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":842
+  /* "structureboost/structure_gb.pyx":840
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
  * def c_entropy_link_der_1(np.ndarray[double] y_true,             # <<<<<<<<<<<<<<
  *                          np.ndarray[double] z_pred):
  *     cdef int N = y_true.shape[0]
  */
-  __pyx_tuple__117 = PyTuple_Pack(9, __pyx_n_s_y_true, __pyx_n_s_z_pred, __pyx_n_s_N, __pyx_n_s_Y, __pyx_n_s_denom1, __pyx_n_s_denom2, __pyx_n_s_i, __pyx_n_s_denom_1, __pyx_n_s_denom_2); if (unlikely(!__pyx_tuple__117)) __PYX_ERR(0, 842, __pyx_L1_error)
+  __pyx_tuple__117 = PyTuple_Pack(9, __pyx_n_s_y_true, __pyx_n_s_z_pred, __pyx_n_s_N, __pyx_n_s_Y, __pyx_n_s_denom1, __pyx_n_s_denom2, __pyx_n_s_i, __pyx_n_s_denom_1, __pyx_n_s_denom_2); if (unlikely(!__pyx_tuple__117)) __PYX_ERR(0, 840, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__117);
   __Pyx_GIVEREF(__pyx_tuple__117);
-  __pyx_codeobj__42 = (PyObject*)__Pyx_PyCode_New(2, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__117, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_c_entropy_link_der_1, 842, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__42)) __PYX_ERR(0, 842, __pyx_L1_error)
+  __pyx_codeobj__42 = (PyObject*)__Pyx_PyCode_New(2, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__117, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_c_entropy_link_der_1, 840, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__42)) __PYX_ERR(0, 840, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":860
+  /* "structureboost/structure_gb.pyx":858
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
  * def c_entropy_link_der_2(np.ndarray[double] y_true,             # <<<<<<<<<<<<<<
  *                          np.ndarray[double] z_pred):
  *     cdef int N = y_true.shape[0]
  */
-  __pyx_tuple__118 = PyTuple_Pack(11, __pyx_n_s_y_true, __pyx_n_s_z_pred, __pyx_n_s_N, __pyx_n_s_Y, __pyx_n_s_z_pred_exp, __pyx_n_s_minus_z_pred_exp, __pyx_n_s_denom1, __pyx_n_s_denom2, __pyx_n_s_i, __pyx_n_s_denom_1, __pyx_n_s_denom_2); if (unlikely(!__pyx_tuple__118)) __PYX_ERR(0, 860, __pyx_L1_error)
+  __pyx_tuple__118 = PyTuple_Pack(11, __pyx_n_s_y_true, __pyx_n_s_z_pred, __pyx_n_s_N, __pyx_n_s_Y, __pyx_n_s_z_pred_exp, __pyx_n_s_minus_z_pred_exp, __pyx_n_s_denom1, __pyx_n_s_denom2, __pyx_n_s_i, __pyx_n_s_denom_1, __pyx_n_s_denom_2); if (unlikely(!__pyx_tuple__118)) __PYX_ERR(0, 858, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__118);
   __Pyx_GIVEREF(__pyx_tuple__118);
-  __pyx_codeobj__43 = (PyObject*)__Pyx_PyCode_New(2, 0, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__118, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_c_entropy_link_der_2, 860, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__43)) __PYX_ERR(0, 860, __pyx_L1_error)
+  __pyx_codeobj__43 = (PyObject*)__Pyx_PyCode_New(2, 0, 11, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__118, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_c_entropy_link_der_2, 858, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__43)) __PYX_ERR(0, 858, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":879
+  /* "structureboost/structure_gb.pyx":877
  * @cython.boundscheck(False)
  * @cython.wraparound(False)
  * def predict_with_tensor_c(np.ndarray[double, ndim=3] dtm_float,             # <<<<<<<<<<<<<<
  *                       np.ndarray[long, ndim=3] dtm,
  *                       np.ndarray[double, ndim=2] feat_array):
  */
-  __pyx_tuple__119 = PyTuple_Pack(28, __pyx_n_s_dtm_float, __pyx_n_s_dtm, __pyx_n_s_feat_array, __pyx_n_s_cat_vals_end, __pyx_n_s_res_mat, __pyx_n_s_cn, __pyx_n_s_ri, __pyx_n_s_ind, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_curr_val, __pyx_n_s_ind_doub, __pyx_n_s_at_leaf, __pyx_n_s_found_val, __pyx_n_s_isnan_array, __pyx_n_s_THRESH, __pyx_n_s_NODE_WEIGHT, __pyx_n_s_NODE_VALUE, __pyx_n_s_NODE_TYPE, __pyx_n_s_FEATURE_COL, __pyx_n_s_LEFT_CHILD, __pyx_n_s_RIGHT_CHILD, __pyx_n_s_NA_LEFT, __pyx_n_s_NUM_CAT_VALS, __pyx_n_s_CAT_VALS_START, __pyx_n_s_LEAF, __pyx_n_s_NUMER, __pyx_n_s_CATEG); if (unlikely(!__pyx_tuple__119)) __PYX_ERR(0, 879, __pyx_L1_error)
+  __pyx_tuple__119 = PyTuple_Pack(28, __pyx_n_s_dtm_float, __pyx_n_s_dtm, __pyx_n_s_feat_array, __pyx_n_s_cat_vals_end, __pyx_n_s_res_mat, __pyx_n_s_cn, __pyx_n_s_ri, __pyx_n_s_ind, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_curr_val, __pyx_n_s_ind_doub, __pyx_n_s_at_leaf, __pyx_n_s_found_val, __pyx_n_s_isnan_array, __pyx_n_s_THRESH, __pyx_n_s_NODE_WEIGHT, __pyx_n_s_NODE_VALUE, __pyx_n_s_NODE_TYPE, __pyx_n_s_FEATURE_COL, __pyx_n_s_LEFT_CHILD, __pyx_n_s_RIGHT_CHILD, __pyx_n_s_NA_LEFT, __pyx_n_s_NUM_CAT_VALS, __pyx_n_s_CAT_VALS_START, __pyx_n_s_LEAF, __pyx_n_s_NUMER, __pyx_n_s_CATEG); if (unlikely(!__pyx_tuple__119)) __PYX_ERR(0, 877, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__119);
   __Pyx_GIVEREF(__pyx_tuple__119);
-  __pyx_codeobj__44 = (PyObject*)__Pyx_PyCode_New(3, 0, 28, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__119, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_predict_with_tensor_c, 879, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__44)) __PYX_ERR(0, 879, __pyx_L1_error)
+  __pyx_codeobj__44 = (PyObject*)__Pyx_PyCode_New(3, 0, 28, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__119, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_predict_with_tensor_c, 877, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__44)) __PYX_ERR(0, 877, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":1185
+  /* "structureboost/structure_gb.pyx":1183
  *         )
  * 
  * def tree_shap_single_pt(dt_mat_int, dt_mat_float,  dt_max_depth, X_in, condition=0, condition_feature=0):             # <<<<<<<<<<<<<<
  * 
  *     x_missing = np.isnan(X_in).astype(int)
  */
-  __pyx_tuple__120 = PyTuple_Pack(25, __pyx_n_s_dt_mat_int, __pyx_n_s_dt_mat_float, __pyx_n_s_dt_max_depth, __pyx_n_s_X_in, __pyx_n_s_condition, __pyx_n_s_condition_feature, __pyx_n_s_x_missing, __pyx_n_s_dt_thresholds, __pyx_n_s_dt_node_weights, __pyx_n_s_dt_node_vals, __pyx_n_s_dt_node_type, __pyx_n_s_dt_features, __pyx_n_s_dt_left_children, __pyx_n_s_dt_right_children, __pyx_n_s_dt_na_left, __pyx_n_s_dt_default_children, __pyx_n_s_dt_num_cat_vals, __pyx_n_s_dt_cat_vals_mat, __pyx_n_s_s, __pyx_n_s_feature_indexes, __pyx_n_s_zero_fractions, __pyx_n_s_one_fractions, __pyx_n_s_pweights, __pyx_n_s_phi, __pyx_n_s_root_val); if (unlikely(!__pyx_tuple__120)) __PYX_ERR(0, 1185, __pyx_L1_error)
+  __pyx_tuple__120 = PyTuple_Pack(25, __pyx_n_s_dt_mat_int, __pyx_n_s_dt_mat_float, __pyx_n_s_dt_max_depth, __pyx_n_s_X_in, __pyx_n_s_condition, __pyx_n_s_condition_feature, __pyx_n_s_x_missing, __pyx_n_s_dt_thresholds, __pyx_n_s_dt_node_weights, __pyx_n_s_dt_node_vals, __pyx_n_s_dt_node_type, __pyx_n_s_dt_features, __pyx_n_s_dt_left_children, __pyx_n_s_dt_right_children, __pyx_n_s_dt_na_left, __pyx_n_s_dt_default_children, __pyx_n_s_dt_num_cat_vals, __pyx_n_s_dt_cat_vals_mat, __pyx_n_s_s, __pyx_n_s_feature_indexes, __pyx_n_s_zero_fractions, __pyx_n_s_one_fractions, __pyx_n_s_pweights, __pyx_n_s_phi, __pyx_n_s_root_val); if (unlikely(!__pyx_tuple__120)) __PYX_ERR(0, 1183, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__120);
   __Pyx_GIVEREF(__pyx_tuple__120);
-  __pyx_codeobj__46 = (PyObject*)__Pyx_PyCode_New(6, 0, 25, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__120, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_tree_shap_single_pt, 1185, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__46)) __PYX_ERR(0, 1185, __pyx_L1_error)
+  __pyx_codeobj__46 = (PyObject*)__Pyx_PyCode_New(6, 0, 25, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__120, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_tree_shap_single_pt, 1183, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__46)) __PYX_ERR(0, 1183, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":1228
+  /* "structureboost/structure_gb.pyx":1226
  *     return(phi)
  * 
  * def get_basic_config(X_tr, default_config, X_te=None):             # <<<<<<<<<<<<<<
  *     """Returns a feature_configs based on a training set and some defaults.
  * 
  */
-  __pyx_tuple__121 = PyTuple_Pack(8, __pyx_n_s_X_tr, __pyx_n_s_default_config, __pyx_n_s_X_te, __pyx_n_s_feature_config_dict, __pyx_n_s_colname, __pyx_n_s_vec_to_use, __pyx_n_s_config, __pyx_n_s_graph); if (unlikely(!__pyx_tuple__121)) __PYX_ERR(0, 1228, __pyx_L1_error)
+  __pyx_tuple__121 = PyTuple_Pack(8, __pyx_n_s_X_tr, __pyx_n_s_default_config, __pyx_n_s_X_te, __pyx_n_s_feature_config_dict, __pyx_n_s_colname, __pyx_n_s_vec_to_use, __pyx_n_s_config, __pyx_n_s_graph); if (unlikely(!__pyx_tuple__121)) __PYX_ERR(0, 1226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__121);
   __Pyx_GIVEREF(__pyx_tuple__121);
-  __pyx_codeobj__54 = (PyObject*)__Pyx_PyCode_New(3, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__121, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_get_basic_config, 1228, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__54)) __PYX_ERR(0, 1228, __pyx_L1_error)
+  __pyx_codeobj__54 = (PyObject*)__Pyx_PyCode_New(3, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__121, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_get_basic_config, 1226, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__54)) __PYX_ERR(0, 1226, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":1285
+  /* "structureboost/structure_gb.pyx":1283
  * 
  * 
  * def default_config_dict():             # <<<<<<<<<<<<<<
  *     """Returns a dict of defaults to be used with `get_basic_config`
  * 
  */
-  __pyx_tuple__122 = PyTuple_Pack(1, __pyx_n_s_config_dict); if (unlikely(!__pyx_tuple__122)) __PYX_ERR(0, 1285, __pyx_L1_error)
+  __pyx_tuple__122 = PyTuple_Pack(1, __pyx_n_s_config_dict); if (unlikely(!__pyx_tuple__122)) __PYX_ERR(0, 1283, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__122);
   __Pyx_GIVEREF(__pyx_tuple__122);
-  __pyx_codeobj__55 = (PyObject*)__Pyx_PyCode_New(0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__122, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_default_config_dict, 1285, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__55)) __PYX_ERR(0, 1285, __pyx_L1_error)
+  __pyx_codeobj__55 = (PyObject*)__Pyx_PyCode_New(0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__122, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_default_config_dict, 1283, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__55)) __PYX_ERR(0, 1283, __pyx_L1_error)
 
-  /* "structureboost/structure_gb.pyx":1329
+  /* "structureboost/structure_gb.pyx":1327
  *     return config_dict
  * 
  * def get_basic_config_series(feature_vec, default_config):             # <<<<<<<<<<<<<<
  *     config_dict = {}
  *     graph_out = None
  */
-  __pyx_tuple__123 = PyTuple_Pack(5, __pyx_n_s_feature_vec, __pyx_n_s_default_config, __pyx_n_s_config_dict, __pyx_n_s_graph_out, __pyx_n_s_categorical_method); if (unlikely(!__pyx_tuple__123)) __PYX_ERR(0, 1329, __pyx_L1_error)
+  __pyx_tuple__123 = PyTuple_Pack(5, __pyx_n_s_feature_vec, __pyx_n_s_default_config, __pyx_n_s_config_dict, __pyx_n_s_graph_out, __pyx_n_s_categorical_method); if (unlikely(!__pyx_tuple__123)) __PYX_ERR(0, 1327, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__123);
   __Pyx_GIVEREF(__pyx_tuple__123);
-  __pyx_codeobj__56 = (PyObject*)__Pyx_PyCode_New(2, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__123, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_get_basic_config_series, 1329, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__56)) __PYX_ERR(0, 1329, __pyx_L1_error)
+  __pyx_codeobj__56 = (PyObject*)__Pyx_PyCode_New(2, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__123, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_pyx, __pyx_n_s_get_basic_config_series, 1327, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__56)) __PYX_ERR(0, 1327, __pyx_L1_error)
 
   /* "View.MemoryView":287
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
@@ -43015,635 +43001,635 @@
  * # Always run into issues trying to import from utils
  */
   __pyx_t_1 = __Pyx_Import(__pyx_n_s_random, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_random, __pyx_t_1) < 0) __PYX_ERR(0, 10, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":23
+  /* "structureboost/structure_gb.pyx":21
  * 
  * 
  * class StructureBoost(object):             # <<<<<<<<<<<<<<
  *     """Gradient Boosting model allowing categorical structure.
  * 
  */
-  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__78); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 23, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_CalculateMetaclass(NULL, __pyx_tuple__78); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 21, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__78, __pyx_n_s_StructureBoost, __pyx_n_s_StructureBoost, (PyObject *) NULL, __pyx_n_s_structureboost_structure_gb, __pyx_kp_s_Gradient_Boosting_model_allowing); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 23, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_Py3MetaclassPrepare(__pyx_t_1, __pyx_tuple__78, __pyx_n_s_StructureBoost, __pyx_n_s_StructureBoost, (PyObject *) NULL, __pyx_n_s_structureboost_structure_gb, __pyx_kp_s_Gradient_Boosting_model_allowing); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 21, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
 
-  /* "structureboost/structure_gb.pyx":137
+  /* "structureboost/structure_gb.pyx":135
  *     Categorical Variables. https://arxiv.org/abs/2007.04446
  *     """
  *     def __init__(self, num_trees, feature_configs=None,             # <<<<<<<<<<<<<<
  *                  mode='classification',
  *                  loss_fn=None, subsample=1,
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_1__init__, 0, __pyx_n_s_StructureBoost___init, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj_)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 137, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_1__init__, 0, __pyx_n_s_StructureBoost___init, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj_)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 135, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__80);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 137, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init, __pyx_t_3) < 0) __PYX_ERR(0, 135, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":193
+  /* "structureboost/structure_gb.pyx":191
  *             self.default_configs = default_config_dict()
  * 
  *     def _validate_feature_config(self):             # <<<<<<<<<<<<<<
  *         valid_ftypes = ['numerical', 'categorical_int',
  *                         'categorical_str', 'graphical_voronoi']
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_3_validate_feature_config, 0, __pyx_n_s_StructureBoost__validate_feature, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 193, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_3_validate_feature_config, 0, __pyx_n_s_StructureBoost__validate_feature, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 191, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_validate_feature_config, __pyx_t_3) < 0) __PYX_ERR(0, 193, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_validate_feature_config, __pyx_t_3) < 0) __PYX_ERR(0, 191, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":239
+  /* "structureboost/structure_gb.pyx":237
  *                         warnings.warn(w_str)
  * 
  *     def _process_y_data(self, y_data):             # <<<<<<<<<<<<<<
  *         if type(y_data) == pd.Series:
  *             y_data = y_data.to_numpy().astype(float)
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_5_process_y_data, 0, __pyx_n_s_StructureBoost__process_y_data, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__3)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 239, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_5_process_y_data, 0, __pyx_n_s_StructureBoost__process_y_data, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__3)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_process_y_data, __pyx_t_3) < 0) __PYX_ERR(0, 239, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_process_y_data, __pyx_t_3) < 0) __PYX_ERR(0, 237, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":246
+  /* "structureboost/structure_gb.pyx":244
  *         return(y_data)
  * 
  *     def _get_initial_pred(self, X_train, y_train):             # <<<<<<<<<<<<<<
  *         if self.initial_model is not None:
  *             if (self.mode == 'classification'):
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_7_get_initial_pred, 0, __pyx_n_s_StructureBoost__get_initial_pred, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__4)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 246, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_7_get_initial_pred, 0, __pyx_n_s_StructureBoost__get_initial_pred, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__4)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 244, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_get_initial_pred, __pyx_t_3) < 0) __PYX_ERR(0, 246, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_get_initial_pred, __pyx_t_3) < 0) __PYX_ERR(0, 244, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":262
+  /* "structureboost/structure_gb.pyx":260
  *                 return(np.mean(y_train)*np.ones(X_train.shape[0]))
  * 
  *     def _add_train_next_tree(self, features_for_tree, X_train, y_g_h_train, index):             # <<<<<<<<<<<<<<
  *         self.dec_tree_list.append(stdt.StructureDecisionTree(
  *                         feature_configs=self.feature_configs,
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_9_add_train_next_tree, 0, __pyx_n_s_StructureBoost__add_train_next_t, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__7)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 262, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_9_add_train_next_tree, 0, __pyx_n_s_StructureBoost__add_train_next_t, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__7)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 260, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_add_train_next_tree, __pyx_t_3) < 0) __PYX_ERR(0, 262, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_add_train_next_tree, __pyx_t_3) < 0) __PYX_ERR(0, 260, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":274
+  /* "structureboost/structure_gb.pyx":272
  *                                   uv_dict=self.unique_vals_dict)
  * 
  *     def process_curr_answer(self, curr_answer):             # <<<<<<<<<<<<<<
  *         return curr_answer
  * 
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_11process_curr_answer, 0, __pyx_n_s_StructureBoost_process_curr_answ, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__8)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 274, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_11process_curr_answer, 0, __pyx_n_s_StructureBoost_process_curr_answ, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__8)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 272, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_process_curr_answer, __pyx_t_3) < 0) __PYX_ERR(0, 274, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_process_curr_answer, __pyx_t_3) < 0) __PYX_ERR(0, 272, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":277
+  /* "structureboost/structure_gb.pyx":275
  *         return curr_answer
  * 
  *     def compute_gh_mat(self, y_train, curr_answer, index):             # <<<<<<<<<<<<<<
  *         y_g_vec = self.loss_fn_der_1(y_train, curr_answer)
  *         y_h_vec = self.loss_fn_der_2(y_train, curr_answer)
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_13compute_gh_mat, 0, __pyx_n_s_StructureBoost_compute_gh_mat, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__9)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 277, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_13compute_gh_mat, 0, __pyx_n_s_StructureBoost_compute_gh_mat, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__9)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 275, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_compute_gh_mat, __pyx_t_3) < 0) __PYX_ERR(0, 277, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_compute_gh_mat, __pyx_t_3) < 0) __PYX_ERR(0, 275, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":284
+  /* "structureboost/structure_gb.pyx":282
  * 
  * 
  *     def _compute_loss(self, y_true, pred):             # <<<<<<<<<<<<<<
  *         if ((self.mode == 'classification')):
  *             return(my_log_loss(y_true, 1/(1+np.exp(-pred))))
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_15_compute_loss, 0, __pyx_n_s_StructureBoost__compute_loss, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__10)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 284, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_15_compute_loss, 0, __pyx_n_s_StructureBoost__compute_loss, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__10)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 282, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_compute_loss, __pyx_t_3) < 0) __PYX_ERR(0, 284, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_compute_loss, __pyx_t_3) < 0) __PYX_ERR(0, 282, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":290
+  /* "structureboost/structure_gb.pyx":288
  *             return(my_mean_squared_error(y_true, pred))
  * 
  *     def _update_curr_answer(self, curr_answer, X_train, index):             # <<<<<<<<<<<<<<
  *         if (index>0):
  *             curr_answer = (curr_answer + self.learning_rate *
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_17_update_curr_answer, 0, __pyx_n_s_StructureBoost__update_curr_answ, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__11)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 290, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_17_update_curr_answer, 0, __pyx_n_s_StructureBoost__update_curr_answ, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__11)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 288, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_update_curr_answer, __pyx_t_3) < 0) __PYX_ERR(0, 290, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_update_curr_answer, __pyx_t_3) < 0) __PYX_ERR(0, 288, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":296
+  /* "structureboost/structure_gb.pyx":294
  *         return(curr_answer)
  * 
  *     def _get_rows_for_tree(self, num_rows):             # <<<<<<<<<<<<<<
  *         if (self.subsample == 1) and (not self.replace):
  *             return np.arange(num_rows)
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_19_get_rows_for_tree, 0, __pyx_n_s_StructureBoost__get_rows_for_tre, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__12)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 296, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_19_get_rows_for_tree, 0, __pyx_n_s_StructureBoost__get_rows_for_tre, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__12)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 294, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_get_rows_for_tree, __pyx_t_3) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_get_rows_for_tree, __pyx_t_3) < 0) __PYX_ERR(0, 294, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":306
+  /* "structureboost/structure_gb.pyx":304
  * 
  * 
  *     def _get_features_for_tree(self):             # <<<<<<<<<<<<<<
  *         if self.feat_sample_by_tree < 1:
  *             feat_set_size = (self.feat_sample_by_tree *
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_21_get_features_for_tree, 0, __pyx_n_s_StructureBoost__get_features_for, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__13)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 306, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_21_get_features_for_tree, 0, __pyx_n_s_StructureBoost__get_features_for, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__13)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 304, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_get_features_for_tree, __pyx_t_3) < 0) __PYX_ERR(0, 306, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_get_features_for_tree, __pyx_t_3) < 0) __PYX_ERR(0, 304, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":320
+  /* "structureboost/structure_gb.pyx":318
  *             features_for_tree = self.feat_list_full
  * 
  *     def _output_loss_check_stop(self, y_valid, curr_valid_answer, i):             # <<<<<<<<<<<<<<
  *         stop_now=False
  *         if ((i+1) % self.eval_freq == 1) and (i>0):
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_23_output_loss_check_stop, 0, __pyx_n_s_StructureBoost__output_loss_chec, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__14)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 320, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_23_output_loss_check_stop, 0, __pyx_n_s_StructureBoost__output_loss_chec, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__14)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 318, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_output_loss_check_stop, __pyx_t_3) < 0) __PYX_ERR(0, 320, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_output_loss_check_stop, __pyx_t_3) < 0) __PYX_ERR(0, 318, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":343
+  /* "structureboost/structure_gb.pyx":341
  *         return(stop_now)
  * 
  *     def _initialize_uv_dict(self, X_train):             # <<<<<<<<<<<<<<
  *         self.unique_vals_dict = {}
  *         for feature in self.feature_configs.keys():
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_25_initialize_uv_dict, 0, __pyx_n_s_StructureBoost__initialize_uv_di, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__15)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_25_initialize_uv_dict, 0, __pyx_n_s_StructureBoost__initialize_uv_di, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__15)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 341, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_initialize_uv_dict, __pyx_t_3) < 0) __PYX_ERR(0, 343, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_initialize_uv_dict, __pyx_t_3) < 0) __PYX_ERR(0, 341, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":351
+  /* "structureboost/structure_gb.pyx":349
  *                                         decimals=self.prec_digits)))
  * 
  *     def _init_eval_set_info(self, eval_set, y_train):             # <<<<<<<<<<<<<<
  *         self.eval_results = np.zeros(np.floor(
  *                                 self.num_trees/self.eval_freq).astype(int))
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_27_init_eval_set_info, 0, __pyx_n_s_StructureBoost__init_eval_set_in, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__16)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 351, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_27_init_eval_set_info, 0, __pyx_n_s_StructureBoost__init_eval_set_in, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__16)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 349, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init_eval_set_info, __pyx_t_3) < 0) __PYX_ERR(0, 351, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_init_eval_set_info, __pyx_t_3) < 0) __PYX_ERR(0, 349, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":366
+  /* "structureboost/structure_gb.pyx":364
  *         return(X_valid, y_valid, curr_valid_answer)
  * 
  *     def _output_no_evalset(self, index):             # <<<<<<<<<<<<<<
  *         if (((index+1) % self.eval_freq == 1) and self.verbose):
  *                 print("i={}".format(index))
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_29_output_no_evalset, 0, __pyx_n_s_StructureBoost__output_no_evalse, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__17)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 366, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_29_output_no_evalset, 0, __pyx_n_s_StructureBoost__output_no_evalse, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__17)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 364, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_output_no_evalset, __pyx_t_3) < 0) __PYX_ERR(0, 366, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_output_no_evalset, __pyx_t_3) < 0) __PYX_ERR(0, 364, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":371
+  /* "structureboost/structure_gb.pyx":369
  * 
  * 
  *     def fit(self, X_train, y_train, eval_set=None, eval_freq=10,             # <<<<<<<<<<<<<<
  *             early_stop_past_steps=0, choose_best_eval=True, verbose=1):
  *         """Fits the model given training features and labels.
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_31fit, 0, __pyx_n_s_StructureBoost_fit, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__18)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 371, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_31fit, 0, __pyx_n_s_StructureBoost_fit, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__18)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 369, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_tuple__96);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_fit, __pyx_t_3) < 0) __PYX_ERR(0, 371, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_fit, __pyx_t_3) < 0) __PYX_ERR(0, 369, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":483
+  /* "structureboost/structure_gb.pyx":481
  *             self.get_tensors_for_predict()
  * 
  *     def predict(self, X_test, int num_trees_to_use=-1, same_col_pos=True):             # <<<<<<<<<<<<<<
  *         """Returns a one-dimensional response - probability of 1 or numeric prediction
  * 
  */
-  __pyx_t_3 = __Pyx_PyInt_From_int(((int)-1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 483, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(((int)-1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 483, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __Pyx_INCREF(((PyObject *)Py_True));
   __Pyx_GIVEREF(((PyObject *)Py_True));
   PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)Py_True));
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_33predict, 0, __pyx_n_s_StructureBoost_predict, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__19)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 483, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_33predict, 0, __pyx_n_s_StructureBoost_predict, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__19)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_predict, __pyx_t_3) < 0) __PYX_ERR(0, 483, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_predict, __pyx_t_3) < 0) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":564
+  /* "structureboost/structure_gb.pyx":562
  *                 return(self._predict_py(X_test, num_trees_to_use))
  * 
  *     def _predict_py(self, X_test, int num_trees_to_use=-1):             # <<<<<<<<<<<<<<
  *         cdef int i
  *         if num_trees_to_use == -1:
  */
-  __pyx_t_3 = __Pyx_PyInt_From_int(((int)-1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 564, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(((int)-1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 564, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_35_predict_py, 0, __pyx_n_s_StructureBoost__predict_py, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__20)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 564, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_35_predict_py, 0, __pyx_n_s_StructureBoost__predict_py, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__20)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_predict_py, __pyx_t_3) < 0) __PYX_ERR(0, 564, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_predict_py, __pyx_t_3) < 0) __PYX_ERR(0, 562, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":585
+  /* "structureboost/structure_gb.pyx":583
  *             return(out_vec)
  * 
  *     def predict_proba(self, X_test, int num_trees_to_use=-1):             # <<<<<<<<<<<<<<
  *         """Returns a n x 2 matrix of class probabilities
  * 
  */
-  __pyx_t_3 = __Pyx_PyInt_From_int(((int)-1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 585, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(((int)-1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 583, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 585, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 583, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_37predict_proba, 0, __pyx_n_s_StructureBoost_predict_proba, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__21)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 585, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_37predict_proba, 0, __pyx_n_s_StructureBoost_predict_proba, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__21)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 583, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_predict_proba, __pyx_t_3) < 0) __PYX_ERR(0, 585, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_predict_proba, __pyx_t_3) < 0) __PYX_ERR(0, 583, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":615
+  /* "structureboost/structure_gb.pyx":613
  *         return(np.vstack((1-pred_probs, pred_probs)).T)
  * 
  *     def _predict_fast(self, X_test, int num_trees_to_use=-1):             # <<<<<<<<<<<<<<
  *         cdef int i
  * 
  */
-  __pyx_t_3 = __Pyx_PyInt_From_int(((int)-1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 615, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(((int)-1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 615, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_39_predict_fast, 0, __pyx_n_s_StructureBoost__predict_fast, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__22)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 615, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_39_predict_fast, 0, __pyx_n_s_StructureBoost__predict_fast, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__22)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_predict_fast, __pyx_t_3) < 0) __PYX_ERR(0, 615, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_predict_fast, __pyx_t_3) < 0) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":638
+  /* "structureboost/structure_gb.pyx":636
  *             return(out_vec)
  * 
  *     def _process_feature_configs(self):             # <<<<<<<<<<<<<<
  *         fg = {}
  *         for feat_name in self.feature_configs.keys():
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_41_process_feature_configs, 0, __pyx_n_s_StructureBoost__process_feature, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__23)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 638, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_41_process_feature_configs, 0, __pyx_n_s_StructureBoost__process_feature, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__23)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_process_feature_configs, __pyx_t_3) < 0) __PYX_ERR(0, 638, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_process_feature_configs, __pyx_t_3) < 0) __PYX_ERR(0, 636, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":650
+  /* "structureboost/structure_gb.pyx":648
  *         self.feature_graphs = fg
  * 
  *     def predict_shap(self, X_test, int num_trees_to_use=-1, same_col_pos=True):             # <<<<<<<<<<<<<<
  *         if (type(X_test)==np.ndarray):
  *             if self.optimizable:
  */
-  __pyx_t_3 = __Pyx_PyInt_From_int(((int)-1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 650, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(((int)-1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 648, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 650, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 648, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __Pyx_INCREF(((PyObject *)Py_True));
   __Pyx_GIVEREF(((PyObject *)Py_True));
   PyTuple_SET_ITEM(__pyx_t_4, 1, ((PyObject *)Py_True));
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_43predict_shap, 0, __pyx_n_s_StructureBoost_predict_shap, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__24)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 650, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_43predict_shap, 0, __pyx_n_s_StructureBoost_predict_shap, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__24)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 648, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_predict_shap_2, __pyx_t_3) < 0) __PYX_ERR(0, 650, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_predict_shap_2, __pyx_t_3) < 0) __PYX_ERR(0, 648, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":672
+  /* "structureboost/structure_gb.pyx":670
  * 
  *     def _predict_shap(self,
  *                     np.ndarray[double, ndim=2] X_test, int num_trees_to_use=-1):             # <<<<<<<<<<<<<<
  *         cdef long i,j
  *         cdef long nrows = X_test.shape[0]
  */
-  __pyx_t_3 = __Pyx_PyInt_From_int(((int)-1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 672, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(((int)-1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 670, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
 
-  /* "structureboost/structure_gb.pyx":671
+  /* "structureboost/structure_gb.pyx":669
  *                 print('columns must be in correct order for shap values')
  * 
  *     def _predict_shap(self,             # <<<<<<<<<<<<<<
  *                     np.ndarray[double, ndim=2] X_test, int num_trees_to_use=-1):
  *         cdef long i,j
  */
-  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 671, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 669, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_45_predict_shap, 0, __pyx_n_s_StructureBoost__predict_shap, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__27)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 671, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_45_predict_shap, 0, __pyx_n_s_StructureBoost__predict_shap, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__27)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 669, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_CyFunction_SetDefaultsTuple(__pyx_t_3, __pyx_t_4);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_predict_shap, __pyx_t_3) < 0) __PYX_ERR(0, 671, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_predict_shap, __pyx_t_3) < 0) __PYX_ERR(0, 669, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":696
+  /* "structureboost/structure_gb.pyx":694
  * 
  * 
  *     def rerandomize_na_dir_weighted_all_trees(self):             # <<<<<<<<<<<<<<
  *         for i in range(len(self.dec_tree_list)):
  *             curr_tree = self.dec_tree_list[i].dec_tree
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_47rerandomize_na_dir_weighted_all_trees, 0, __pyx_n_s_StructureBoost_rerandomize_na_di, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__28)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 696, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_47rerandomize_na_dir_weighted_all_trees, 0, __pyx_n_s_StructureBoost_rerandomize_na_di, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__28)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 694, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_rerandomize_na_dir_weighted_all, __pyx_t_3) < 0) __PYX_ERR(0, 696, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_rerandomize_na_dir_weighted_all, __pyx_t_3) < 0) __PYX_ERR(0, 694, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":702
+  /* "structureboost/structure_gb.pyx":700
  *                 randomize_node_na_dir_weighted(curr_tree)
  * 
  *     def remap_predict_columns(self, new_col_struct):             # <<<<<<<<<<<<<<
  *         """Indicate which column in numpy array each feature is located.
  * 
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_49remap_predict_columns, 0, __pyx_n_s_StructureBoost_remap_predict_col, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__29)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 702, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_49remap_predict_columns, 0, __pyx_n_s_StructureBoost_remap_predict_col, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__29)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 700, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_remap_predict_columns, __pyx_t_3) < 0) __PYX_ERR(0, 702, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_remap_predict_columns, __pyx_t_3) < 0) __PYX_ERR(0, 700, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":745
+  /* "structureboost/structure_gb.pyx":743
  *             warnings.warn(w_str)
  * 
  *     def get_tensors_for_predict(self):             # <<<<<<<<<<<<<<
  *         if self.optimizable:
  *             cat_size = np.max(np.array([dt.get_max_split_size() for dt in self.dec_tree_list]))
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_51get_tensors_for_predict, 0, __pyx_n_s_StructureBoost_get_tensors_for_p, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__30)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 745, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_51get_tensors_for_predict, 0, __pyx_n_s_StructureBoost_get_tensors_for_p, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__30)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 743, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_get_tensors_for_predict, __pyx_t_3) < 0) __PYX_ERR(0, 745, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_get_tensors_for_predict, __pyx_t_3) < 0) __PYX_ERR(0, 743, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":758
+  /* "structureboost/structure_gb.pyx":756
  *             print("Model not optimizable for predict due to string or voronoi variable.")
  * 
  *     def convert_dt_to_matrix(self, dt_num):             # <<<<<<<<<<<<<<
  *         curr_node = self.dec_tree_list[dt_num].dec_tree
  *         self.convert_subtree(curr_node, dt_num)
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_53convert_dt_to_matrix, 0, __pyx_n_s_StructureBoost_convert_dt_to_mat, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__32)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 758, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_53convert_dt_to_matrix, 0, __pyx_n_s_StructureBoost_convert_dt_to_mat, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__32)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 756, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_convert_dt_to_matrix, __pyx_t_3) < 0) __PYX_ERR(0, 758, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_convert_dt_to_matrix, __pyx_t_3) < 0) __PYX_ERR(0, 756, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":762
+  /* "structureboost/structure_gb.pyx":760
  *         self.convert_subtree(curr_node, dt_num)
  * 
  *     def convert_subtree(self, node, dt_num):             # <<<<<<<<<<<<<<
  *         ni = node['node_index']
  *         if node['node_type']=='leaf':
  */
-  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_55convert_subtree, 0, __pyx_n_s_StructureBoost_convert_subtree, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__33)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 762, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_12structure_gb_14StructureBoost_55convert_subtree, 0, __pyx_n_s_StructureBoost_convert_subtree, NULL, __pyx_n_s_structureboost_structure_gb, __pyx_d, ((PyObject *)__pyx_codeobj__33)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 760, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_convert_subtree, __pyx_t_3) < 0) __PYX_ERR(0, 762, __pyx_L1_error)
+  if (__Pyx_SetNameInClass(__pyx_t_2, __pyx_n_s_convert_subtree, __pyx_t_3) < 0) __PYX_ERR(0, 760, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "structureboost/structure_gb.pyx":23
+  /* "structureboost/structure_gb.pyx":21
  * 
  * 
  * class StructureBoost(object):             # <<<<<<<<<<<<<<
  *     """Gradient Boosting model allowing categorical structure.
  * 
  */
-  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_StructureBoost, __pyx_tuple__78, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 23, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_Py3ClassCreate(__pyx_t_1, __pyx_n_s_StructureBoost, __pyx_tuple__78, __pyx_t_2, NULL, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 21, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_StructureBoost, __pyx_t_3) < 0) __PYX_ERR(0, 23, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_StructureBoost, __pyx_t_3) < 0) __PYX_ERR(0, 21, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":786
+  /* "structureboost/structure_gb.pyx":784
  * 
  * 
  * def _mse_der_1(y_true, y_pred, eps=1e-15):             # <<<<<<<<<<<<<<
  *     return(2*(y_pred-y_true))
  * 
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_1_mse_der_1, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 786, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_1_mse_der_1, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 784, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_mse_der_1, __pyx_t_1) < 0) __PYX_ERR(0, 786, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_mse_der_1, __pyx_t_1) < 0) __PYX_ERR(0, 784, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":790
+  /* "structureboost/structure_gb.pyx":788
  * 
  * 
  * def _mse_der_2(y_true, y_pred, eps=1e-15):             # <<<<<<<<<<<<<<
  *     return(2*np.ones(len(y_pred)))
  * 
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_3_mse_der_2, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 790, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_3_mse_der_2, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 788, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_mse_der_2, __pyx_t_1) < 0) __PYX_ERR(0, 790, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_mse_der_2, __pyx_t_1) < 0) __PYX_ERR(0, 788, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":794
+  /* "structureboost/structure_gb.pyx":792
  * 
  * 
  * def _entropy_link_der_1(y_true, z_pred, eps=1e-15):             # <<<<<<<<<<<<<<
  *     return(-y_true*(1/(1+np.exp(z_pred))) + (1-y_true) *
  *            (1/(1+np.exp(-z_pred))))
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_5_entropy_link_der_1, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 794, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_5_entropy_link_der_1, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 792, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_entropy_link_der_1, __pyx_t_1) < 0) __PYX_ERR(0, 794, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_entropy_link_der_1, __pyx_t_1) < 0) __PYX_ERR(0, 792, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":799
+  /* "structureboost/structure_gb.pyx":797
  * 
  * 
  * def _entropy_link_der_2(y_true, z_pred, eps=1e-15):             # <<<<<<<<<<<<<<
  *     z_pred_exp = np.exp(z_pred)
  *     minus_z_pred_exp = np.exp(-z_pred)
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_7_entropy_link_der_2, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 799, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_7_entropy_link_der_2, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 797, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_entropy_link_der_2, __pyx_t_1) < 0) __PYX_ERR(0, 799, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_entropy_link_der_2, __pyx_t_1) < 0) __PYX_ERR(0, 797, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":808
+  /* "structureboost/structure_gb.pyx":806
  * 
  * 
  * def my_log_loss(y_true, y_pred, eps=1e-16):             # <<<<<<<<<<<<<<
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(y_true*(np.log(y_pred)) + (1-y_true)*np.log(1-y_pred))
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_9my_log_loss, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 808, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_9my_log_loss, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 806, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_my_log_loss, __pyx_t_1) < 0) __PYX_ERR(0, 808, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_my_log_loss, __pyx_t_1) < 0) __PYX_ERR(0, 806, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":814
+  /* "structureboost/structure_gb.pyx":812
  * 
  * 
  * def my_log_loss_vec(y_true_mat, y_pred, eps=1e-16):             # <<<<<<<<<<<<<<
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(np.sum(y_true_mat*np.log(y_pred),axis=1))
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_11my_log_loss_vec, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 814, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_11my_log_loss_vec, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 812, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_my_log_loss_vec, __pyx_t_1) < 0) __PYX_ERR(0, 814, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_my_log_loss_vec, __pyx_t_1) < 0) __PYX_ERR(0, 812, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":820
+  /* "structureboost/structure_gb.pyx":818
  * 
  * 
  * def my_mean_squared_error(y_true, y_pred):             # <<<<<<<<<<<<<<
  *     return(np.mean((y_true-y_pred)*(y_true-y_pred)))
  * 
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_13my_mean_squared_error, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 820, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_13my_mean_squared_error, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 818, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_my_mean_squared_error, __pyx_t_1) < 0) __PYX_ERR(0, 820, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_my_mean_squared_error, __pyx_t_1) < 0) __PYX_ERR(0, 818, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":824
+  /* "structureboost/structure_gb.pyx":822
  * 
  * 
  * def randomize_node_na_dir_weighted(curr_node):             # <<<<<<<<<<<<<<
  *     if (('node_type' in curr_node.keys()) and
  *                 (curr_node['node_type'] == 'interior')):
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_15randomize_node_na_dir_weighted, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 824, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_15randomize_node_na_dir_weighted, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 822, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_randomize_node_na_dir_weighted, __pyx_t_1) < 0) __PYX_ERR(0, 824, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_randomize_node_na_dir_weighted, __pyx_t_1) < 0) __PYX_ERR(0, 822, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":842
+  /* "structureboost/structure_gb.pyx":840
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
  * def c_entropy_link_der_1(np.ndarray[double] y_true,             # <<<<<<<<<<<<<<
  *                          np.ndarray[double] z_pred):
  *     cdef int N = y_true.shape[0]
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_17c_entropy_link_der_1, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 842, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_17c_entropy_link_der_1, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 840, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_c_entropy_link_der_1, __pyx_t_1) < 0) __PYX_ERR(0, 842, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_c_entropy_link_der_1, __pyx_t_1) < 0) __PYX_ERR(0, 840, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":860
+  /* "structureboost/structure_gb.pyx":858
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
  * def c_entropy_link_der_2(np.ndarray[double] y_true,             # <<<<<<<<<<<<<<
  *                          np.ndarray[double] z_pred):
  *     cdef int N = y_true.shape[0]
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_19c_entropy_link_der_2, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 860, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_19c_entropy_link_der_2, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 858, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_c_entropy_link_der_2, __pyx_t_1) < 0) __PYX_ERR(0, 860, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_c_entropy_link_der_2, __pyx_t_1) < 0) __PYX_ERR(0, 858, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":879
+  /* "structureboost/structure_gb.pyx":877
  * @cython.boundscheck(False)
  * @cython.wraparound(False)
  * def predict_with_tensor_c(np.ndarray[double, ndim=3] dtm_float,             # <<<<<<<<<<<<<<
  *                       np.ndarray[long, ndim=3] dtm,
  *                       np.ndarray[double, ndim=2] feat_array):
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_21predict_with_tensor_c, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 879, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_21predict_with_tensor_c, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 877, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_predict_with_tensor_c, __pyx_t_1) < 0) __PYX_ERR(0, 879, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_predict_with_tensor_c, __pyx_t_1) < 0) __PYX_ERR(0, 877, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1185
+  /* "structureboost/structure_gb.pyx":1183
  *         )
  * 
  * def tree_shap_single_pt(dt_mat_int, dt_mat_float,  dt_max_depth, X_in, condition=0, condition_feature=0):             # <<<<<<<<<<<<<<
  * 
  *     x_missing = np.isnan(X_in).astype(int)
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_23tree_shap_single_pt, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1185, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_23tree_shap_single_pt, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1183, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_tree_shap_single_pt, __pyx_t_1) < 0) __PYX_ERR(0, 1185, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_tree_shap_single_pt, __pyx_t_1) < 0) __PYX_ERR(0, 1183, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1228
+  /* "structureboost/structure_gb.pyx":1226
  *     return(phi)
  * 
  * def get_basic_config(X_tr, default_config, X_te=None):             # <<<<<<<<<<<<<<
  *     """Returns a feature_configs based on a training set and some defaults.
  * 
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_25get_basic_config, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1228, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_25get_basic_config, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1226, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_basic_config, __pyx_t_1) < 0) __PYX_ERR(0, 1228, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_basic_config, __pyx_t_1) < 0) __PYX_ERR(0, 1226, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1285
+  /* "structureboost/structure_gb.pyx":1283
  * 
  * 
  * def default_config_dict():             # <<<<<<<<<<<<<<
  *     """Returns a dict of defaults to be used with `get_basic_config`
  * 
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_27default_config_dict, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1285, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_27default_config_dict, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1283, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_default_config_dict, __pyx_t_1) < 0) __PYX_ERR(0, 1285, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_default_config_dict, __pyx_t_1) < 0) __PYX_ERR(0, 1283, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb.pyx":1329
+  /* "structureboost/structure_gb.pyx":1327
  *     return config_dict
  * 
  * def get_basic_config_series(feature_vec, default_config):             # <<<<<<<<<<<<<<
  *     config_dict = {}
  *     graph_out = None
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_29get_basic_config_series, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1329, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_gb_29get_basic_config_series, NULL, __pyx_n_s_structureboost_structure_gb); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1327, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_basic_config_series, __pyx_t_1) < 0) __PYX_ERR(0, 1329, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_basic_config_series, __pyx_t_1) < 0) __PYX_ERR(0, 1327, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "structureboost/structure_gb.pyx":1
  * # cython: profile=True             # <<<<<<<<<<<<<<
  * # cython: language_level=3
  * 
  */
   __pyx_t_1 = __Pyx_PyDict_NewPresized(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_t_1, __pyx_kp_u_get_basic_config_line_1228, __pyx_kp_u_Returns_a_feature_configs_based) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
-  if (PyDict_SetItem(__pyx_t_1, __pyx_kp_u_default_config_dict_line_1285, __pyx_kp_u_Returns_a_dict_of_defaults_to_be) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_kp_u_get_basic_config_line_1226, __pyx_kp_u_Returns_a_feature_configs_based) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_1, __pyx_kp_u_default_config_dict_line_1283, __pyx_kp_u_Returns_a_dict_of_defaults_to_be) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "View.MemoryView":210
  *         info.obj = self
  * 
  *     __pyx_getbuffer = capsule(<void *> &__pyx_array_getbuffer, "getbuffer(obj, view, flags)")             # <<<<<<<<<<<<<<
@@ -49801,52 +49787,14 @@
         int one = 1; int little = (int)*(unsigned char *)&one;
         unsigned char *bytes = (unsigned char *)&value;
         return _PyLong_FromByteArray(bytes, sizeof(Py_intptr_t),
                                      little, !is_unsigned);
     }
 }
 
-/* CIntToPy */
-  static CYTHON_INLINE PyObject* __Pyx_PyInt_From_npy_int64(npy_int64 value) {
-#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
-#pragma GCC diagnostic push
-#pragma GCC diagnostic ignored "-Wconversion"
-#endif
-    const npy_int64 neg_one = (npy_int64) -1, const_zero = (npy_int64) 0;
-#ifdef __Pyx_HAS_GCC_DIAGNOSTIC
-#pragma GCC diagnostic pop
-#endif
-    const int is_unsigned = neg_one > const_zero;
-    if (is_unsigned) {
-        if (sizeof(npy_int64) < sizeof(long)) {
-            return PyInt_FromLong((long) value);
-        } else if (sizeof(npy_int64) <= sizeof(unsigned long)) {
-            return PyLong_FromUnsignedLong((unsigned long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(npy_int64) <= sizeof(unsigned PY_LONG_LONG)) {
-            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
-#endif
-        }
-    } else {
-        if (sizeof(npy_int64) <= sizeof(long)) {
-            return PyInt_FromLong((long) value);
-#ifdef HAVE_LONG_LONG
-        } else if (sizeof(npy_int64) <= sizeof(PY_LONG_LONG)) {
-            return PyLong_FromLongLong((PY_LONG_LONG) value);
-#endif
-        }
-    }
-    {
-        int one = 1; int little = (int)*(unsigned char *)&one;
-        unsigned char *bytes = (unsigned char *)&value;
-        return _PyLong_FromByteArray(bytes, sizeof(npy_int64),
-                                     little, !is_unsigned);
-    }
-}
-
 /* CIntFromPy */
   static CYTHON_INLINE char __Pyx_PyInt_As_char(PyObject *x) {
 #ifdef __Pyx_HAS_GCC_DIAGNOSTIC
 #pragma GCC diagnostic push
 #pragma GCC diagnostic ignored "-Wconversion"
 #endif
     const char neg_one = (char) -1, const_zero = (char) 0;
```

### Comparing `structureboost-0.4.0/structureboost/structure_gb_multi.c` & `structureboost-0.4.1/structureboost/structure_gb_multi.c`

 * *Files 0% similar despite different names*

```diff
@@ -1280,23 +1280,14 @@
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
-
-/* "structureboost/structure_gb_multi.pyx":539
- * 
- * 
- * ctypedef np.int64_t dtype_int64_t             # <<<<<<<<<<<<<<
- * 
- * 
- */
-typedef __pyx_t_5numpy_int64_t __pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t;
 /* Declarations.proto */
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     typedef ::std::complex< float > __pyx_t_float_complex;
   #else
     typedef float _Complex __pyx_t_float_complex;
   #endif
@@ -2496,15 +2487,15 @@
 /* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsds_double(PyObject *, int writable_flag);
 
 /* ObjectToMemviewSlice.proto */
 static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_ds_double(PyObject *, int writable_flag);
 
 /* ObjectToMemviewSlice.proto */
-static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn___pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t(PyObject *, int writable_flag);
+static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_long(PyObject *, int writable_flag);
 
 /* MemviewDtypeToObject.proto */
 static CYTHON_INLINE PyObject *__pyx_memview_get_double(const char *itemp);
 static CYTHON_INLINE int __pyx_memview_set_double(const char *itemp, PyObject *obj);
 
 /* RealImag.proto */
 #if CYTHON_CCOMPLEX
@@ -2733,15 +2724,15 @@
 static void __pyx_memoryview_refcount_objects_in_slice_with_gil(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_refcount_objects_in_slice(char *, Py_ssize_t *, Py_ssize_t *, int, int); /*proto*/
 static void __pyx_memoryview_slice_assign_scalar(__Pyx_memviewslice *, int, size_t, void *, int); /*proto*/
 static void __pyx_memoryview__slice_assign_scalar(char *, Py_ssize_t *, Py_ssize_t *, int, size_t, void *); /*proto*/
 static PyObject *__pyx_unpickle_Enum__set_state(struct __pyx_MemviewEnum_obj *, PyObject *); /*proto*/
 static __Pyx_TypeInfo __Pyx_TypeInfo_double = { "double", NULL, sizeof(double), { 0 }, 0, 'R', 0, 0 };
 static __Pyx_TypeInfo __Pyx_TypeInfo_long = { "long", NULL, sizeof(long), { 0 }, 0, IS_UNSIGNED(long) ? 'U' : 'I', IS_UNSIGNED(long), 0 };
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t = { "dtype_int64_t", NULL, sizeof(__pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t), { 0 }, 0, IS_UNSIGNED(__pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t) ? 'U' : 'I', IS_UNSIGNED(__pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t), 0 };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int_t = { "int_t", NULL, sizeof(__pyx_t_5numpy_int_t), { 0 }, 0, IS_UNSIGNED(__pyx_t_5numpy_int_t) ? 'U' : 'I', IS_UNSIGNED(__pyx_t_5numpy_int_t), 0 };
 #define __Pyx_MODULE_NAME "structureboost.structure_gb_multi"
 extern int __pyx_module_is_main_structureboost__structure_gb_multi;
 int __pyx_module_is_main_structureboost__structure_gb_multi = 0;
 
 /* Implementation of 'structureboost.structure_gb_multi' */
 static PyObject *__pyx_builtin_super;
 static PyObject *__pyx_builtin_print;
@@ -2781,14 +2772,15 @@
 static const char __pyx_k_all[] = "all";
 static const char __pyx_k_doc[] = "__doc__";
 static const char __pyx_k_dtm[] = "dtm";
 static const char __pyx_k_eps[] = "eps";
 static const char __pyx_k_exp[] = "exp";
 static const char __pyx_k_fit[] = "fit";
 static const char __pyx_k_ind[] = "ind";
+static const char __pyx_k_int[] = "int_";
 static const char __pyx_k_log[] = "log";
 static const char __pyx_k_max[] = "max";
 static const char __pyx_k_min[] = "min";
 static const char __pyx_k_new[] = "__new__";
 static const char __pyx_k_obj[] = "obj";
 static const char __pyx_k_qqq[] = "qqq";
 static const char __pyx_k_rpt[] = "rpt";
@@ -2827,15 +2819,14 @@
 static const char __pyx_k_class[] = "__class__";
 static const char __pyx_k_dtype[] = "dtype";
 static const char __pyx_k_error[] = "error";
 static const char __pyx_k_fixed[] = "fixed";
 static const char __pyx_k_flags[] = "flags";
 static const char __pyx_k_gamma[] = "gamma";
 static const char __pyx_k_index[] = "index";
-static const char __pyx_k_int64[] = "int64";
 static const char __pyx_k_isnan[] = "isnan";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_print[] = "print";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_shape[] = "shape";
 static const char __pyx_k_start[] = "start";
 static const char __pyx_k_super[] = "super";
@@ -3309,15 +3300,15 @@
 static PyObject *__pyx_n_s_ind;
 static PyObject *__pyx_n_s_ind_doub;
 static PyObject *__pyx_n_s_index;
 static PyObject *__pyx_n_s_init;
 static PyObject *__pyx_n_s_initial_model;
 static PyObject *__pyx_n_s_initial_pred;
 static PyObject *__pyx_kp_u_instead_of_1_May_cause_unexpect;
-static PyObject *__pyx_n_s_int64;
+static PyObject *__pyx_n_s_int;
 static PyObject *__pyx_n_u_interior;
 static PyObject *__pyx_n_s_isnan;
 static PyObject *__pyx_n_s_isnan_array;
 static PyObject *__pyx_n_s_itemsize;
 static PyObject *__pyx_kp_s_itemsize_0_for_cython_array;
 static PyObject *__pyx_n_s_j;
 static PyObject *__pyx_n_s_jk;
@@ -6845,24 +6836,24 @@
   __Pyx_TraceCall("_create_rpt_from_list", __pyx_f[0], 251, 0, __PYX_ERR(0, 251, __pyx_L1_error));
 
   /* "structureboost/structure_gb_multi.pyx":252
  * 
  *     def _create_rpt_from_list(self, partition_list):
  *         num_part = len(partition_list)             # <<<<<<<<<<<<<<
  *         max_part_size = np.max(np.array([len(qq) for qq in partition_list]))
- *         rpt = np.zeros((num_part, max_part_size, self.num_classes), dtype=np.int64)
+ *         rpt = np.zeros((num_part, max_part_size, self.num_classes), dtype=np.int_)
  */
   __pyx_t_1 = PyObject_Length(__pyx_v_partition_list); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 252, __pyx_L1_error)
   __pyx_v_num_part = __pyx_t_1;
 
   /* "structureboost/structure_gb_multi.pyx":253
  *     def _create_rpt_from_list(self, partition_list):
  *         num_part = len(partition_list)
  *         max_part_size = np.max(np.array([len(qq) for qq in partition_list]))             # <<<<<<<<<<<<<<
- *         rpt = np.zeros((num_part, max_part_size, self.num_classes), dtype=np.int64)
+ *         rpt = np.zeros((num_part, max_part_size, self.num_classes), dtype=np.int_)
  *         flat_list = [j for sl in partition_list for i in sl for j in i]
  */
   __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 253, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_max); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 253, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -6963,15 +6954,15 @@
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_max_part_size = __pyx_t_2;
   __pyx_t_2 = 0;
 
   /* "structureboost/structure_gb_multi.pyx":254
  *         num_part = len(partition_list)
  *         max_part_size = np.max(np.array([len(qq) for qq in partition_list]))
- *         rpt = np.zeros((num_part, max_part_size, self.num_classes), dtype=np.int64)             # <<<<<<<<<<<<<<
+ *         rpt = np.zeros((num_part, max_part_size, self.num_classes), dtype=np.int_)             # <<<<<<<<<<<<<<
  *         flat_list = [j for sl in partition_list for i in sl for j in i]
  *         min_val, max_val = np.min(flat_list), np.max(flat_list)
  */
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 254, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 254, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
@@ -6996,30 +6987,30 @@
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
   __pyx_t_6 = 0;
   __pyx_t_6 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 254, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 254, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 254, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 254, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 254, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 254, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_v_rpt = __pyx_t_5;
   __pyx_t_5 = 0;
 
   /* "structureboost/structure_gb_multi.pyx":255
  *         max_part_size = np.max(np.array([len(qq) for qq in partition_list]))
- *         rpt = np.zeros((num_part, max_part_size, self.num_classes), dtype=np.int64)
+ *         rpt = np.zeros((num_part, max_part_size, self.num_classes), dtype=np.int_)
  *         flat_list = [j for sl in partition_list for i in sl for j in i]             # <<<<<<<<<<<<<<
  *         min_val, max_val = np.min(flat_list), np.max(flat_list)
  *         if (min_val<0) or (max_val>self.num_classes-1):
  */
   { /* enter inner scope */
     __pyx_t_5 = PyList_New(0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 255, __pyx_L11_error)
     __Pyx_GOTREF(__pyx_t_5);
@@ -7164,15 +7155,15 @@
     goto __pyx_L1_error;
     __pyx_L18_exit_scope:;
   } /* exit inner scope */
   __pyx_v_flat_list = ((PyObject*)__pyx_t_5);
   __pyx_t_5 = 0;
 
   /* "structureboost/structure_gb_multi.pyx":256
- *         rpt = np.zeros((num_part, max_part_size, self.num_classes), dtype=np.int64)
+ *         rpt = np.zeros((num_part, max_part_size, self.num_classes), dtype=np.int_)
  *         flat_list = [j for sl in partition_list for i in sl for j in i]
  *         min_val, max_val = np.min(flat_list), np.max(flat_list)             # <<<<<<<<<<<<<<
  *         if (min_val<0) or (max_val>self.num_classes-1):
  *             w_str = "Elements of partition must be >=0 and <=(num_classes-1). "
  */
   __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 256, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
@@ -7476,15 +7467,15 @@
 }
 
 /* "structureboost/structure_gb_multi.pyx":267
  *         return(rpt)
  * 
  *     def _process_y_data(self, y_data):             # <<<<<<<<<<<<<<
  *         if type(y_data) == pd.Series:
- *             y_data = y_data.to_numpy().astype(np.int64)
+ *             y_data = y_data.to_numpy().astype(np.int_)
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_18structure_gb_multi_19StructureBoostMulti_17_process_y_data(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_18structure_gb_multi_19StructureBoostMulti_17_process_y_data = {"_process_y_data", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_18structure_gb_multi_19StructureBoostMulti_17_process_y_data, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_14structureboost_18structure_gb_multi_19StructureBoostMulti_17_process_y_data(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   CYTHON_UNUSED PyObject *__pyx_v_self = 0;
@@ -7565,15 +7556,15 @@
   __Pyx_TraceCall("_process_y_data", __pyx_f[0], 267, 0, __PYX_ERR(0, 267, __pyx_L1_error));
   __Pyx_INCREF(__pyx_v_y_data);
 
   /* "structureboost/structure_gb_multi.pyx":268
  * 
  *     def _process_y_data(self, y_data):
  *         if type(y_data) == pd.Series:             # <<<<<<<<<<<<<<
- *             y_data = y_data.to_numpy().astype(np.int64)
+ *             y_data = y_data.to_numpy().astype(np.int_)
  *         elif type(y_data) == np.ndarray:
  */
   __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_pd); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Series); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 268, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -7582,17 +7573,17 @@
   __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 268, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_3) {
 
     /* "structureboost/structure_gb_multi.pyx":269
  *     def _process_y_data(self, y_data):
  *         if type(y_data) == pd.Series:
- *             y_data = y_data.to_numpy().astype(np.int64)             # <<<<<<<<<<<<<<
+ *             y_data = y_data.to_numpy().astype(np.int_)             # <<<<<<<<<<<<<<
  *         elif type(y_data) == np.ndarray:
- *             y_data = y_data.astype(np.int64)
+ *             y_data = y_data.astype(np.int_)
  */
     __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_y_data, __pyx_n_s_to_numpy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 269, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_5)) {
@@ -7608,15 +7599,15 @@
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 269, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 269, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 269, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 269, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_2 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -7634,44 +7625,44 @@
     __Pyx_DECREF_SET(__pyx_v_y_data, __pyx_t_1);
     __pyx_t_1 = 0;
 
     /* "structureboost/structure_gb_multi.pyx":268
  * 
  *     def _process_y_data(self, y_data):
  *         if type(y_data) == pd.Series:             # <<<<<<<<<<<<<<
- *             y_data = y_data.to_numpy().astype(np.int64)
+ *             y_data = y_data.to_numpy().astype(np.int_)
  *         elif type(y_data) == np.ndarray:
  */
     goto __pyx_L3;
   }
 
   /* "structureboost/structure_gb_multi.pyx":270
  *         if type(y_data) == pd.Series:
- *             y_data = y_data.to_numpy().astype(np.int64)
+ *             y_data = y_data.to_numpy().astype(np.int_)
  *         elif type(y_data) == np.ndarray:             # <<<<<<<<<<<<<<
- *             y_data = y_data.astype(np.int64)
+ *             y_data = y_data.astype(np.int_)
  *         #y_data = get_one_hot_mat(y_data, self.num_classes)
  */
   __pyx_t_1 = PyObject_RichCompare(((PyObject *)Py_TYPE(__pyx_v_y_data)), ((PyObject *)__pyx_ptype_5numpy_ndarray), Py_EQ); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 270, __pyx_L1_error)
   __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 270, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_3) {
 
     /* "structureboost/structure_gb_multi.pyx":271
- *             y_data = y_data.to_numpy().astype(np.int64)
+ *             y_data = y_data.to_numpy().astype(np.int_)
  *         elif type(y_data) == np.ndarray:
- *             y_data = y_data.astype(np.int64)             # <<<<<<<<<<<<<<
+ *             y_data = y_data.astype(np.int_)             # <<<<<<<<<<<<<<
  *         #y_data = get_one_hot_mat(y_data, self.num_classes)
  *         return(y_data)
  */
     __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_y_data, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 271, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 271, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 271, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 271, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -7687,24 +7678,24 @@
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF_SET(__pyx_v_y_data, __pyx_t_1);
     __pyx_t_1 = 0;
 
     /* "structureboost/structure_gb_multi.pyx":270
  *         if type(y_data) == pd.Series:
- *             y_data = y_data.to_numpy().astype(np.int64)
+ *             y_data = y_data.to_numpy().astype(np.int_)
  *         elif type(y_data) == np.ndarray:             # <<<<<<<<<<<<<<
- *             y_data = y_data.astype(np.int64)
+ *             y_data = y_data.astype(np.int_)
  *         #y_data = get_one_hot_mat(y_data, self.num_classes)
  */
   }
   __pyx_L3:;
 
   /* "structureboost/structure_gb_multi.pyx":273
- *             y_data = y_data.astype(np.int64)
+ *             y_data = y_data.astype(np.int_)
  *         #y_data = get_one_hot_mat(y_data, self.num_classes)
  *         return(y_data)             # <<<<<<<<<<<<<<
  * 
  *     def _get_initial_pred(self, X_train, y_train):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_y_data);
@@ -7712,15 +7703,15 @@
   goto __pyx_L0;
 
   /* "structureboost/structure_gb_multi.pyx":267
  *         return(rpt)
  * 
  *     def _process_y_data(self, y_data):             # <<<<<<<<<<<<<<
  *         if type(y_data) == pd.Series:
- *             y_data = y_data.to_numpy().astype(np.int64)
+ *             y_data = y_data.to_numpy().astype(np.int_)
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4);
@@ -11386,27 +11377,27 @@
     __pyx_t_1 = 0;
 
     /* "structureboost/structure_gb_multi.pyx":416
  *         if self.optimizable:
  *             cat_size = np.max(np.array([dt.get_max_split_size() for dt in self.dec_tree_list]))
  *             num_dt = len(self.dec_tree_list)             # <<<<<<<<<<<<<<
  *             max_nodes = np.max(np.array([dt.num_nodes for dt in self.dec_tree_list]))
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1
  */
     __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 416, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_9 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 416, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_v_num_dt = __pyx_t_9;
 
     /* "structureboost/structure_gb_multi.pyx":417
  *             cat_size = np.max(np.array([dt.get_max_split_size() for dt in self.dec_tree_list]))
  *             num_dt = len(self.dec_tree_list)
  *             max_nodes = np.max(np.array([dt.num_nodes for dt in self.dec_tree_list]))             # <<<<<<<<<<<<<<
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, self.num_classes+2))
  */
     __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 417, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_max); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 417, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -11509,15 +11500,15 @@
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_max_nodes = __pyx_t_1;
     __pyx_t_1 = 0;
 
     /* "structureboost/structure_gb_multi.pyx":418
  *             num_dt = len(self.dec_tree_list)
  *             max_nodes = np.max(np.array([dt.num_nodes for dt in self.dec_tree_list]))
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1             # <<<<<<<<<<<<<<
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1             # <<<<<<<<<<<<<<
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, self.num_classes+2))
  *             for i in range(num_dt):
  */
     __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
@@ -11542,15 +11533,15 @@
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
     __pyx_t_5 = 0;
     __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 418, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -11560,15 +11551,15 @@
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int, __pyx_t_5) < 0) __PYX_ERR(0, 418, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
     /* "structureboost/structure_gb_multi.pyx":419
  *             max_nodes = np.max(np.array([dt.num_nodes for dt in self.dec_tree_list]))
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, self.num_classes+2))             # <<<<<<<<<<<<<<
  *             for i in range(num_dt):
  *                 self.convert_dt_to_matrix(i)
  */
     __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 419, __pyx_L1_error)
@@ -11608,15 +11599,15 @@
     if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float, __pyx_t_5) < 0) __PYX_ERR(0, 419, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
     /* "structureboost/structure_gb_multi.pyx":420
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, self.num_classes+2))
  *             for i in range(num_dt):             # <<<<<<<<<<<<<<
  *                 self.convert_dt_to_matrix(i)
  *             self.optimized=True
  */
     __pyx_t_9 = __pyx_v_num_dt;
     __pyx_t_13 = __pyx_t_9;
@@ -13574,18 +13565,18 @@
   __Pyx_XDECREF((PyObject *)__pyx_v_isnan_array);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb_multi.pyx":547
+/* "structureboost/structure_gb_multi.pyx":543
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
- * def c_entropy_link_der_12_vec_sp(np.ndarray[dtype_int64_t] y_true,             # <<<<<<<<<<<<<<
+ * def c_entropy_link_der_12_vec_sp(np.ndarray[np.int_t] y_true,             # <<<<<<<<<<<<<<
  *                          double[:,:] exp_phi_pred,
  *                          double[:] exp_phi_sum_vec):
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_18structure_gb_multi_3c_entropy_link_der_12_vec_sp(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static char __pyx_doc_14structureboost_18structure_gb_multi_2c_entropy_link_der_12_vec_sp[] = "In this variant, y_true is just a vector of correct classes (not one hot)";
@@ -13621,46 +13612,46 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_true)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_exp_phi_pred)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("c_entropy_link_der_12_vec_sp", 1, 3, 3, 1); __PYX_ERR(0, 547, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("c_entropy_link_der_12_vec_sp", 1, 3, 3, 1); __PYX_ERR(0, 543, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_exp_phi_sum_vec)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("c_entropy_link_der_12_vec_sp", 1, 3, 3, 2); __PYX_ERR(0, 547, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("c_entropy_link_der_12_vec_sp", 1, 3, 3, 2); __PYX_ERR(0, 543, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "c_entropy_link_der_12_vec_sp") < 0)) __PYX_ERR(0, 547, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "c_entropy_link_der_12_vec_sp") < 0)) __PYX_ERR(0, 543, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 3) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
     }
     __pyx_v_y_true = ((PyArrayObject *)values[0]);
-    __pyx_v_exp_phi_pred = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_exp_phi_pred.memview)) __PYX_ERR(0, 548, __pyx_L3_error)
-    __pyx_v_exp_phi_sum_vec = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_exp_phi_sum_vec.memview)) __PYX_ERR(0, 549, __pyx_L3_error)
+    __pyx_v_exp_phi_pred = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_exp_phi_pred.memview)) __PYX_ERR(0, 544, __pyx_L3_error)
+    __pyx_v_exp_phi_sum_vec = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_exp_phi_sum_vec.memview)) __PYX_ERR(0, 545, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("c_entropy_link_der_12_vec_sp", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 547, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("c_entropy_link_der_12_vec_sp", 1, 3, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 543, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb_multi.c_entropy_link_der_12_vec_sp", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_y_true), __pyx_ptype_5numpy_ndarray, 1, "y_true", 0))) __PYX_ERR(0, 547, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_y_true), __pyx_ptype_5numpy_ndarray, 1, "y_true", 0))) __PYX_ERR(0, 543, __pyx_L1_error)
   __pyx_r = __pyx_pf_14structureboost_18structure_gb_multi_2c_entropy_link_der_12_vec_sp(__pyx_self, __pyx_v_y_true, __pyx_v_exp_phi_pred, __pyx_v_exp_phi_sum_vec);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -13703,61 +13694,61 @@
   Py_ssize_t __pyx_t_22;
   Py_ssize_t __pyx_t_23;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__30)
   __Pyx_RefNannySetupContext("c_entropy_link_der_12_vec_sp", 0);
-  __Pyx_TraceCall("c_entropy_link_der_12_vec_sp", __pyx_f[0], 547, 0, __PYX_ERR(0, 547, __pyx_L1_error));
+  __Pyx_TraceCall("c_entropy_link_der_12_vec_sp", __pyx_f[0], 543, 0, __PYX_ERR(0, 543, __pyx_L1_error));
   __pyx_pybuffer_y_true.pybuffer.buf = NULL;
   __pyx_pybuffer_y_true.refcount = 0;
   __pyx_pybuffernd_y_true.data = NULL;
   __pyx_pybuffernd_y_true.rcbuffer = &__pyx_pybuffer_y_true;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_y_true.rcbuffer->pybuffer, (PyObject*)__pyx_v_y_true, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 547, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_y_true.rcbuffer->pybuffer, (PyObject*)__pyx_v_y_true, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 543, __pyx_L1_error)
   }
   __pyx_pybuffernd_y_true.diminfo[0].strides = __pyx_pybuffernd_y_true.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_y_true.diminfo[0].shape = __pyx_pybuffernd_y_true.rcbuffer->pybuffer.shape[0];
 
-  /* "structureboost/structure_gb_multi.pyx":551
+  /* "structureboost/structure_gb_multi.pyx":547
  *                          double[:] exp_phi_sum_vec):
  *     """In this variant, y_true is just a vector of correct classes (not one hot)"""
  *     cdef long N = len(y_true)             # <<<<<<<<<<<<<<
  *     cdef long m = exp_phi_pred.shape[1]
  *     cdef double[:,:] Y = np.zeros((N,m+m))
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_y_true)); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 551, __pyx_L1_error)
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_y_true)); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 547, __pyx_L1_error)
   __pyx_v_N = __pyx_t_1;
 
-  /* "structureboost/structure_gb_multi.pyx":552
+  /* "structureboost/structure_gb_multi.pyx":548
  *     """In this variant, y_true is just a vector of correct classes (not one hot)"""
  *     cdef long N = len(y_true)
  *     cdef long m = exp_phi_pred.shape[1]             # <<<<<<<<<<<<<<
  *     cdef double[:,:] Y = np.zeros((N,m+m))
  *     cdef long i,j,k
  */
   __pyx_v_m = (__pyx_v_exp_phi_pred.shape[1]);
 
-  /* "structureboost/structure_gb_multi.pyx":553
+  /* "structureboost/structure_gb_multi.pyx":549
  *     cdef long N = len(y_true)
  *     cdef long m = exp_phi_pred.shape[1]
  *     cdef double[:,:] Y = np.zeros((N,m+m))             # <<<<<<<<<<<<<<
  *     cdef long i,j,k
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 553, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 549, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 553, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 549, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_N); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 553, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_N); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 549, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyInt_From_long((__pyx_v_m + __pyx_v_m)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 553, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_long((__pyx_v_m + __pyx_v_m)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 549, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 553, __pyx_L1_error)
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 549, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
   __pyx_t_3 = 0;
   __pyx_t_5 = 0;
@@ -13770,83 +13761,83 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_6);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 553, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 549, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 553, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 549, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_Y = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "structureboost/structure_gb_multi.pyx":556
+  /* "structureboost/structure_gb_multi.pyx":552
  *     cdef long i,j,k
  * 
  *     for i in range(N):             # <<<<<<<<<<<<<<
  *         for j in range(m):
  *             if y_true[i]==j:
  */
   __pyx_t_8 = __pyx_v_N;
   __pyx_t_9 = __pyx_t_8;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_i = __pyx_t_10;
 
-    /* "structureboost/structure_gb_multi.pyx":557
+    /* "structureboost/structure_gb_multi.pyx":553
  * 
  *     for i in range(N):
  *         for j in range(m):             # <<<<<<<<<<<<<<
  *             if y_true[i]==j:
  *                 Y[i,j]=(exp_phi_pred[i,j]/exp_phi_sum_vec[i])-1
  */
     __pyx_t_11 = __pyx_v_m;
     __pyx_t_12 = __pyx_t_11;
     for (__pyx_t_13 = 0; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
       __pyx_v_j = __pyx_t_13;
 
-      /* "structureboost/structure_gb_multi.pyx":558
+      /* "structureboost/structure_gb_multi.pyx":554
  *     for i in range(N):
  *         for j in range(m):
  *             if y_true[i]==j:             # <<<<<<<<<<<<<<
  *                 Y[i,j]=(exp_phi_pred[i,j]/exp_phi_sum_vec[i])-1
  *             else:
  */
       __pyx_t_14 = __pyx_v_i;
-      __pyx_t_15 = (((*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t *, __pyx_pybuffernd_y_true.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_y_true.diminfo[0].strides)) == __pyx_v_j) != 0);
+      __pyx_t_15 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_y_true.rcbuffer->pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_y_true.diminfo[0].strides)) == __pyx_v_j) != 0);
       if (__pyx_t_15) {
 
-        /* "structureboost/structure_gb_multi.pyx":559
+        /* "structureboost/structure_gb_multi.pyx":555
  *         for j in range(m):
  *             if y_true[i]==j:
  *                 Y[i,j]=(exp_phi_pred[i,j]/exp_phi_sum_vec[i])-1             # <<<<<<<<<<<<<<
  *             else:
  *                 Y[i,j]=(exp_phi_pred[i,j]/exp_phi_sum_vec[i])
  */
         __pyx_t_14 = __pyx_v_i;
         __pyx_t_16 = __pyx_v_j;
         __pyx_t_17 = __pyx_v_i;
         __pyx_t_18 = __pyx_v_i;
         __pyx_t_19 = __pyx_v_j;
         *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Y.data + __pyx_t_18 * __pyx_v_Y.strides[0]) ) + __pyx_t_19 * __pyx_v_Y.strides[1]) )) = (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_exp_phi_pred.data + __pyx_t_14 * __pyx_v_exp_phi_pred.strides[0]) ) + __pyx_t_16 * __pyx_v_exp_phi_pred.strides[1]) ))) / (*((double *) ( /* dim=0 */ (__pyx_v_exp_phi_sum_vec.data + __pyx_t_17 * __pyx_v_exp_phi_sum_vec.strides[0]) )))) - 1.0);
 
-        /* "structureboost/structure_gb_multi.pyx":558
+        /* "structureboost/structure_gb_multi.pyx":554
  *     for i in range(N):
  *         for j in range(m):
  *             if y_true[i]==j:             # <<<<<<<<<<<<<<
  *                 Y[i,j]=(exp_phi_pred[i,j]/exp_phi_sum_vec[i])-1
  *             else:
  */
         goto __pyx_L7;
       }
 
-      /* "structureboost/structure_gb_multi.pyx":561
+      /* "structureboost/structure_gb_multi.pyx":557
  *                 Y[i,j]=(exp_phi_pred[i,j]/exp_phi_sum_vec[i])-1
  *             else:
  *                 Y[i,j]=(exp_phi_pred[i,j]/exp_phi_sum_vec[i])             # <<<<<<<<<<<<<<
  *             Y[i,j+m]=-(exp_phi_pred[i,j]*(exp_phi_pred[i,j]-exp_phi_sum_vec[i])/
  *                                              (exp_phi_sum_vec[i]*exp_phi_sum_vec[i]))
  */
       /*else*/ {
@@ -13855,89 +13846,89 @@
         __pyx_t_14 = __pyx_v_i;
         __pyx_t_19 = __pyx_v_i;
         __pyx_t_18 = __pyx_v_j;
         *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Y.data + __pyx_t_19 * __pyx_v_Y.strides[0]) ) + __pyx_t_18 * __pyx_v_Y.strides[1]) )) = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_exp_phi_pred.data + __pyx_t_17 * __pyx_v_exp_phi_pred.strides[0]) ) + __pyx_t_16 * __pyx_v_exp_phi_pred.strides[1]) ))) / (*((double *) ( /* dim=0 */ (__pyx_v_exp_phi_sum_vec.data + __pyx_t_14 * __pyx_v_exp_phi_sum_vec.strides[0]) ))));
       }
       __pyx_L7:;
 
-      /* "structureboost/structure_gb_multi.pyx":562
+      /* "structureboost/structure_gb_multi.pyx":558
  *             else:
  *                 Y[i,j]=(exp_phi_pred[i,j]/exp_phi_sum_vec[i])
  *             Y[i,j+m]=-(exp_phi_pred[i,j]*(exp_phi_pred[i,j]-exp_phi_sum_vec[i])/             # <<<<<<<<<<<<<<
  *                                              (exp_phi_sum_vec[i]*exp_phi_sum_vec[i]))
  *     return np.asarray(Y)
  */
       __pyx_t_14 = __pyx_v_i;
       __pyx_t_16 = __pyx_v_j;
       __pyx_t_17 = __pyx_v_i;
       __pyx_t_18 = __pyx_v_j;
       __pyx_t_19 = __pyx_v_i;
 
-      /* "structureboost/structure_gb_multi.pyx":563
+      /* "structureboost/structure_gb_multi.pyx":559
  *                 Y[i,j]=(exp_phi_pred[i,j]/exp_phi_sum_vec[i])
  *             Y[i,j+m]=-(exp_phi_pred[i,j]*(exp_phi_pred[i,j]-exp_phi_sum_vec[i])/
  *                                              (exp_phi_sum_vec[i]*exp_phi_sum_vec[i]))             # <<<<<<<<<<<<<<
  *     return np.asarray(Y)
  * 
  */
       __pyx_t_20 = __pyx_v_i;
       __pyx_t_21 = __pyx_v_i;
 
-      /* "structureboost/structure_gb_multi.pyx":562
+      /* "structureboost/structure_gb_multi.pyx":558
  *             else:
  *                 Y[i,j]=(exp_phi_pred[i,j]/exp_phi_sum_vec[i])
  *             Y[i,j+m]=-(exp_phi_pred[i,j]*(exp_phi_pred[i,j]-exp_phi_sum_vec[i])/             # <<<<<<<<<<<<<<
  *                                              (exp_phi_sum_vec[i]*exp_phi_sum_vec[i]))
  *     return np.asarray(Y)
  */
       __pyx_t_22 = __pyx_v_i;
       __pyx_t_23 = (__pyx_v_j + __pyx_v_m);
       *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Y.data + __pyx_t_22 * __pyx_v_Y.strides[0]) ) + __pyx_t_23 * __pyx_v_Y.strides[1]) )) = (-(((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_exp_phi_pred.data + __pyx_t_14 * __pyx_v_exp_phi_pred.strides[0]) ) + __pyx_t_16 * __pyx_v_exp_phi_pred.strides[1]) ))) * ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_exp_phi_pred.data + __pyx_t_17 * __pyx_v_exp_phi_pred.strides[0]) ) + __pyx_t_18 * __pyx_v_exp_phi_pred.strides[1]) ))) - (*((double *) ( /* dim=0 */ (__pyx_v_exp_phi_sum_vec.data + __pyx_t_19 * __pyx_v_exp_phi_sum_vec.strides[0]) ))))) / ((*((double *) ( /* dim=0 */ (__pyx_v_exp_phi_sum_vec.data + __pyx_t_20 * __pyx_v_exp_phi_sum_vec.strides[0]) ))) * (*((double *) ( /* dim=0 */ (__pyx_v_exp_phi_sum_vec.data + __pyx_t_21 * __pyx_v_exp_phi_sum_vec.strides[0]) ))))));
     }
   }
 
-  /* "structureboost/structure_gb_multi.pyx":564
+  /* "structureboost/structure_gb_multi.pyx":560
  *             Y[i,j+m]=-(exp_phi_pred[i,j]*(exp_phi_pred[i,j]-exp_phi_sum_vec[i])/
  *                                              (exp_phi_sum_vec[i]*exp_phi_sum_vec[i]))
  *     return np.asarray(Y)             # <<<<<<<<<<<<<<
  * 
  * @cython.boundscheck(False)  # Deactivate bounds checking
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 564, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 560, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 564, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 560, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_Y, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 564, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_Y, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 560, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 564, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 560, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb_multi.pyx":547
+  /* "structureboost/structure_gb_multi.pyx":543
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
- * def c_entropy_link_der_12_vec_sp(np.ndarray[dtype_int64_t] y_true,             # <<<<<<<<<<<<<<
+ * def c_entropy_link_der_12_vec_sp(np.ndarray[np.int_t] y_true,             # <<<<<<<<<<<<<<
  *                          double[:,:] exp_phi_pred,
  *                          double[:] exp_phi_sum_vec):
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_2);
@@ -13963,18 +13954,18 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_exp_phi_sum_vec, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb_multi.pyx":570
+/* "structureboost/structure_gb_multi.pyx":566
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
- * def c_str_entropy_link_der_12_vec_sp(np.ndarray[dtype_int64_t] y_true,             # <<<<<<<<<<<<<<
+ * def c_str_entropy_link_der_12_vec_sp(np.ndarray[np.int_t] y_true,             # <<<<<<<<<<<<<<
  *                                  double[:,:] exp_phi_pred,
  *                                  double[:] exp_phi_sum_vec,
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_18structure_gb_multi_5c_str_entropy_link_der_12_vec_sp(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_18structure_gb_multi_5c_str_entropy_link_der_12_vec_sp = {"c_str_entropy_link_der_12_vec_sp", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_18structure_gb_multi_5c_str_entropy_link_der_12_vec_sp, METH_VARARGS|METH_KEYWORDS, 0};
@@ -14015,62 +14006,62 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_true)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_exp_phi_pred)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("c_str_entropy_link_der_12_vec_sp", 1, 5, 5, 1); __PYX_ERR(0, 570, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("c_str_entropy_link_der_12_vec_sp", 1, 5, 5, 1); __PYX_ERR(0, 566, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_exp_phi_sum_vec)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("c_str_entropy_link_der_12_vec_sp", 1, 5, 5, 2); __PYX_ERR(0, 570, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("c_str_entropy_link_der_12_vec_sp", 1, 5, 5, 2); __PYX_ERR(0, 566, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_weight_vec)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("c_str_entropy_link_der_12_vec_sp", 1, 5, 5, 3); __PYX_ERR(0, 570, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("c_str_entropy_link_der_12_vec_sp", 1, 5, 5, 3); __PYX_ERR(0, 566, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_rp_tensor)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("c_str_entropy_link_der_12_vec_sp", 1, 5, 5, 4); __PYX_ERR(0, 570, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("c_str_entropy_link_der_12_vec_sp", 1, 5, 5, 4); __PYX_ERR(0, 566, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "c_str_entropy_link_der_12_vec_sp") < 0)) __PYX_ERR(0, 570, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "c_str_entropy_link_der_12_vec_sp") < 0)) __PYX_ERR(0, 566, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
     }
     __pyx_v_y_true = ((PyArrayObject *)values[0]);
-    __pyx_v_exp_phi_pred = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_exp_phi_pred.memview)) __PYX_ERR(0, 571, __pyx_L3_error)
-    __pyx_v_exp_phi_sum_vec = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_exp_phi_sum_vec.memview)) __PYX_ERR(0, 572, __pyx_L3_error)
-    __pyx_v_weight_vec = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_weight_vec.memview)) __PYX_ERR(0, 573, __pyx_L3_error)
-    __pyx_v_rp_tensor = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn___pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t(values[4], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rp_tensor.memview)) __PYX_ERR(0, 574, __pyx_L3_error)
+    __pyx_v_exp_phi_pred = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_exp_phi_pred.memview)) __PYX_ERR(0, 567, __pyx_L3_error)
+    __pyx_v_exp_phi_sum_vec = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_exp_phi_sum_vec.memview)) __PYX_ERR(0, 568, __pyx_L3_error)
+    __pyx_v_weight_vec = __Pyx_PyObject_to_MemoryviewSlice_ds_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_weight_vec.memview)) __PYX_ERR(0, 569, __pyx_L3_error)
+    __pyx_v_rp_tensor = __Pyx_PyObject_to_MemoryviewSlice_dsdsds_long(values[4], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rp_tensor.memview)) __PYX_ERR(0, 570, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("c_str_entropy_link_der_12_vec_sp", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 570, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("c_str_entropy_link_der_12_vec_sp", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 566, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb_multi.c_str_entropy_link_der_12_vec_sp", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_y_true), __pyx_ptype_5numpy_ndarray, 1, "y_true", 0))) __PYX_ERR(0, 570, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_y_true), __pyx_ptype_5numpy_ndarray, 1, "y_true", 0))) __PYX_ERR(0, 566, __pyx_L1_error)
   __pyx_r = __pyx_pf_14structureboost_18structure_gb_multi_4c_str_entropy_link_der_12_vec_sp(__pyx_self, __pyx_v_y_true, __pyx_v_exp_phi_pred, __pyx_v_exp_phi_sum_vec, __pyx_v_weight_vec, __pyx_v_rp_tensor);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -14124,79 +14115,79 @@
   Py_ssize_t __pyx_t_22;
   Py_ssize_t __pyx_t_23;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__31)
   __Pyx_RefNannySetupContext("c_str_entropy_link_der_12_vec_sp", 0);
-  __Pyx_TraceCall("c_str_entropy_link_der_12_vec_sp", __pyx_f[0], 570, 0, __PYX_ERR(0, 570, __pyx_L1_error));
+  __Pyx_TraceCall("c_str_entropy_link_der_12_vec_sp", __pyx_f[0], 566, 0, __PYX_ERR(0, 566, __pyx_L1_error));
   __pyx_pybuffer_y_true.pybuffer.buf = NULL;
   __pyx_pybuffer_y_true.refcount = 0;
   __pyx_pybuffernd_y_true.data = NULL;
   __pyx_pybuffernd_y_true.rcbuffer = &__pyx_pybuffer_y_true;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_y_true.rcbuffer->pybuffer, (PyObject*)__pyx_v_y_true, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 570, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_y_true.rcbuffer->pybuffer, (PyObject*)__pyx_v_y_true, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 566, __pyx_L1_error)
   }
   __pyx_pybuffernd_y_true.diminfo[0].strides = __pyx_pybuffernd_y_true.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_y_true.diminfo[0].shape = __pyx_pybuffernd_y_true.rcbuffer->pybuffer.shape[0];
 
-  /* "structureboost/structure_gb_multi.pyx":575
+  /* "structureboost/structure_gb_multi.pyx":571
  *                                  double[:] weight_vec,
- *                                  dtype_int64_t[:,:,:] rp_tensor):
+ *                                  long[:,:,:] rp_tensor):
  *     cdef long N = len(y_true)             # <<<<<<<<<<<<<<
  *     cdef long m = exp_phi_pred.shape[1]
  *     cdef long ind = 0
  */
-  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_y_true)); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 575, __pyx_L1_error)
+  __pyx_t_1 = PyObject_Length(((PyObject *)__pyx_v_y_true)); if (unlikely(__pyx_t_1 == ((Py_ssize_t)-1))) __PYX_ERR(0, 571, __pyx_L1_error)
   __pyx_v_N = __pyx_t_1;
 
-  /* "structureboost/structure_gb_multi.pyx":576
- *                                  dtype_int64_t[:,:,:] rp_tensor):
+  /* "structureboost/structure_gb_multi.pyx":572
+ *                                  long[:,:,:] rp_tensor):
  *     cdef long N = len(y_true)
  *     cdef long m = exp_phi_pred.shape[1]             # <<<<<<<<<<<<<<
  *     cdef long ind = 0
  *     cdef long qqq, xyz
  */
   __pyx_v_m = (__pyx_v_exp_phi_pred.shape[1]);
 
-  /* "structureboost/structure_gb_multi.pyx":577
+  /* "structureboost/structure_gb_multi.pyx":573
  *     cdef long N = len(y_true)
  *     cdef long m = exp_phi_pred.shape[1]
  *     cdef long ind = 0             # <<<<<<<<<<<<<<
  *     cdef long qqq, xyz
  *     cdef long yval = 0
  */
   __pyx_v_ind = 0;
 
-  /* "structureboost/structure_gb_multi.pyx":579
+  /* "structureboost/structure_gb_multi.pyx":575
  *     cdef long ind = 0
  *     cdef long qqq, xyz
  *     cdef long yval = 0             # <<<<<<<<<<<<<<
  *     cdef double curr_wt
  *     cdef double[:,:] Y = np.zeros((N,2*m))
  */
   __pyx_v_yval = 0;
 
-  /* "structureboost/structure_gb_multi.pyx":581
+  /* "structureboost/structure_gb_multi.pyx":577
  *     cdef long yval = 0
  *     cdef double curr_wt
  *     cdef double[:,:] Y = np.zeros((N,2*m))             # <<<<<<<<<<<<<<
  *     cdef double all_sum = 0
  *     cdef double set_sum = 0
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 581, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 577, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 581, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 577, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_N); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 581, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_long(__pyx_v_N); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 577, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __Pyx_PyInt_From_long((2 * __pyx_v_m)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 581, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_From_long((2 * __pyx_v_m)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 577, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 581, __pyx_L1_error)
+  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 577, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
   __pyx_t_3 = 0;
   __pyx_t_5 = 0;
@@ -14209,298 +14200,298 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_5, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_6);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 581, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 577, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 581, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_dsds_double(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 577, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_Y = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "structureboost/structure_gb_multi.pyx":582
+  /* "structureboost/structure_gb_multi.pyx":578
  *     cdef double curr_wt
  *     cdef double[:,:] Y = np.zeros((N,2*m))
  *     cdef double all_sum = 0             # <<<<<<<<<<<<<<
  *     cdef double set_sum = 0
  *     cdef long num_part = rp_tensor.shape[0]
  */
   __pyx_v_all_sum = 0.0;
 
-  /* "structureboost/structure_gb_multi.pyx":583
+  /* "structureboost/structure_gb_multi.pyx":579
  *     cdef double[:,:] Y = np.zeros((N,2*m))
  *     cdef double all_sum = 0
  *     cdef double set_sum = 0             # <<<<<<<<<<<<<<
  *     cdef long num_part = rp_tensor.shape[0]
  *     cdef long i,j,k,t
  */
   __pyx_v_set_sum = 0.0;
 
-  /* "structureboost/structure_gb_multi.pyx":584
+  /* "structureboost/structure_gb_multi.pyx":580
  *     cdef double all_sum = 0
  *     cdef double set_sum = 0
  *     cdef long num_part = rp_tensor.shape[0]             # <<<<<<<<<<<<<<
  *     cdef long i,j,k,t
  *     cdef double jt, jk
  */
   __pyx_v_num_part = (__pyx_v_rp_tensor.shape[0]);
 
-  /* "structureboost/structure_gb_multi.pyx":588
+  /* "structureboost/structure_gb_multi.pyx":584
  *     cdef double jt, jk
  * 
  *     for qqq in range(num_part):             # <<<<<<<<<<<<<<
  *         curr_wt = weight_vec[ind]
  *         for i in range(N):
  */
   __pyx_t_8 = __pyx_v_num_part;
   __pyx_t_9 = __pyx_t_8;
   for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
     __pyx_v_qqq = __pyx_t_10;
 
-    /* "structureboost/structure_gb_multi.pyx":589
+    /* "structureboost/structure_gb_multi.pyx":585
  * 
  *     for qqq in range(num_part):
  *         curr_wt = weight_vec[ind]             # <<<<<<<<<<<<<<
  *         for i in range(N):
  *             xyz=0
  */
     __pyx_t_11 = __pyx_v_ind;
     __pyx_v_curr_wt = (*((double *) ( /* dim=0 */ (__pyx_v_weight_vec.data + __pyx_t_11 * __pyx_v_weight_vec.strides[0]) )));
 
-    /* "structureboost/structure_gb_multi.pyx":590
+    /* "structureboost/structure_gb_multi.pyx":586
  *     for qqq in range(num_part):
  *         curr_wt = weight_vec[ind]
  *         for i in range(N):             # <<<<<<<<<<<<<<
  *             xyz=0
  *             # get y_true value from y_true onehot (passed in)
  */
     __pyx_t_12 = __pyx_v_N;
     __pyx_t_13 = __pyx_t_12;
     for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
       __pyx_v_i = __pyx_t_14;
 
-      /* "structureboost/structure_gb_multi.pyx":591
+      /* "structureboost/structure_gb_multi.pyx":587
  *         curr_wt = weight_vec[ind]
  *         for i in range(N):
  *             xyz=0             # <<<<<<<<<<<<<<
  *             # get y_true value from y_true onehot (passed in)
  *             yval = y_true[i]
  */
       __pyx_v_xyz = 0;
 
-      /* "structureboost/structure_gb_multi.pyx":593
+      /* "structureboost/structure_gb_multi.pyx":589
  *             xyz=0
  *             # get y_true value from y_true onehot (passed in)
  *             yval = y_true[i]             # <<<<<<<<<<<<<<
  *             while (rp_tensor[qqq,xyz,yval]==0):
  *                 xyz+=1
  */
       __pyx_t_11 = __pyx_v_i;
-      __pyx_v_yval = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t *, __pyx_pybuffernd_y_true.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_y_true.diminfo[0].strides));
+      __pyx_v_yval = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_y_true.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_y_true.diminfo[0].strides));
 
-      /* "structureboost/structure_gb_multi.pyx":594
+      /* "structureboost/structure_gb_multi.pyx":590
  *             # get y_true value from y_true onehot (passed in)
  *             yval = y_true[i]
  *             while (rp_tensor[qqq,xyz,yval]==0):             # <<<<<<<<<<<<<<
  *                 xyz+=1
  *             set_sum = 0
  */
       while (1) {
         __pyx_t_11 = __pyx_v_qqq;
         __pyx_t_15 = __pyx_v_xyz;
         __pyx_t_16 = __pyx_v_yval;
-        __pyx_t_17 = (((*((__pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rp_tensor.data + __pyx_t_11 * __pyx_v_rp_tensor.strides[0]) ) + __pyx_t_15 * __pyx_v_rp_tensor.strides[1]) ) + __pyx_t_16 * __pyx_v_rp_tensor.strides[2]) ))) == 0) != 0);
+        __pyx_t_17 = (((*((long *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rp_tensor.data + __pyx_t_11 * __pyx_v_rp_tensor.strides[0]) ) + __pyx_t_15 * __pyx_v_rp_tensor.strides[1]) ) + __pyx_t_16 * __pyx_v_rp_tensor.strides[2]) ))) == 0) != 0);
         if (!__pyx_t_17) break;
 
-        /* "structureboost/structure_gb_multi.pyx":595
+        /* "structureboost/structure_gb_multi.pyx":591
  *             yval = y_true[i]
  *             while (rp_tensor[qqq,xyz,yval]==0):
  *                 xyz+=1             # <<<<<<<<<<<<<<
  *             set_sum = 0
  *             for t in range(m):
  */
         __pyx_v_xyz = (__pyx_v_xyz + 1);
       }
 
-      /* "structureboost/structure_gb_multi.pyx":596
+      /* "structureboost/structure_gb_multi.pyx":592
  *             while (rp_tensor[qqq,xyz,yval]==0):
  *                 xyz+=1
  *             set_sum = 0             # <<<<<<<<<<<<<<
  *             for t in range(m):
  *                 if (rp_tensor[qqq,xyz,t]==1):
  */
       __pyx_v_set_sum = 0.0;
 
-      /* "structureboost/structure_gb_multi.pyx":597
+      /* "structureboost/structure_gb_multi.pyx":593
  *                 xyz+=1
  *             set_sum = 0
  *             for t in range(m):             # <<<<<<<<<<<<<<
  *                 if (rp_tensor[qqq,xyz,t]==1):
  *                     set_sum+=exp_phi_pred[i,t]
  */
       __pyx_t_18 = __pyx_v_m;
       __pyx_t_19 = __pyx_t_18;
       for (__pyx_t_20 = 0; __pyx_t_20 < __pyx_t_19; __pyx_t_20+=1) {
         __pyx_v_t = __pyx_t_20;
 
-        /* "structureboost/structure_gb_multi.pyx":598
+        /* "structureboost/structure_gb_multi.pyx":594
  *             set_sum = 0
  *             for t in range(m):
  *                 if (rp_tensor[qqq,xyz,t]==1):             # <<<<<<<<<<<<<<
  *                     set_sum+=exp_phi_pred[i,t]
  *             for j in range(m):
  */
         __pyx_t_16 = __pyx_v_qqq;
         __pyx_t_15 = __pyx_v_xyz;
         __pyx_t_11 = __pyx_v_t;
-        __pyx_t_17 = (((*((__pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rp_tensor.data + __pyx_t_16 * __pyx_v_rp_tensor.strides[0]) ) + __pyx_t_15 * __pyx_v_rp_tensor.strides[1]) ) + __pyx_t_11 * __pyx_v_rp_tensor.strides[2]) ))) == 1) != 0);
+        __pyx_t_17 = (((*((long *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rp_tensor.data + __pyx_t_16 * __pyx_v_rp_tensor.strides[0]) ) + __pyx_t_15 * __pyx_v_rp_tensor.strides[1]) ) + __pyx_t_11 * __pyx_v_rp_tensor.strides[2]) ))) == 1) != 0);
         if (__pyx_t_17) {
 
-          /* "structureboost/structure_gb_multi.pyx":599
+          /* "structureboost/structure_gb_multi.pyx":595
  *             for t in range(m):
  *                 if (rp_tensor[qqq,xyz,t]==1):
  *                     set_sum+=exp_phi_pred[i,t]             # <<<<<<<<<<<<<<
  *             for j in range(m):
  *                 jt = (exp_phi_pred[i,j]/set_sum)
  */
           __pyx_t_11 = __pyx_v_i;
           __pyx_t_15 = __pyx_v_t;
           __pyx_v_set_sum = (__pyx_v_set_sum + (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_exp_phi_pred.data + __pyx_t_11 * __pyx_v_exp_phi_pred.strides[0]) ) + __pyx_t_15 * __pyx_v_exp_phi_pred.strides[1]) ))));
 
-          /* "structureboost/structure_gb_multi.pyx":598
+          /* "structureboost/structure_gb_multi.pyx":594
  *             set_sum = 0
  *             for t in range(m):
  *                 if (rp_tensor[qqq,xyz,t]==1):             # <<<<<<<<<<<<<<
  *                     set_sum+=exp_phi_pred[i,t]
  *             for j in range(m):
  */
         }
       }
 
-      /* "structureboost/structure_gb_multi.pyx":600
+      /* "structureboost/structure_gb_multi.pyx":596
  *                 if (rp_tensor[qqq,xyz,t]==1):
  *                     set_sum+=exp_phi_pred[i,t]
  *             for j in range(m):             # <<<<<<<<<<<<<<
  *                 jt = (exp_phi_pred[i,j]/set_sum)
  *                 jk = (exp_phi_pred[i,j]/exp_phi_sum_vec[i])
  */
       __pyx_t_18 = __pyx_v_m;
       __pyx_t_19 = __pyx_t_18;
       for (__pyx_t_20 = 0; __pyx_t_20 < __pyx_t_19; __pyx_t_20+=1) {
         __pyx_v_j = __pyx_t_20;
 
-        /* "structureboost/structure_gb_multi.pyx":601
+        /* "structureboost/structure_gb_multi.pyx":597
  *                     set_sum+=exp_phi_pred[i,t]
  *             for j in range(m):
  *                 jt = (exp_phi_pred[i,j]/set_sum)             # <<<<<<<<<<<<<<
  *                 jk = (exp_phi_pred[i,j]/exp_phi_sum_vec[i])
  *                 # if j in set containing y_true
  */
         __pyx_t_15 = __pyx_v_i;
         __pyx_t_11 = __pyx_v_j;
         __pyx_v_jt = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_exp_phi_pred.data + __pyx_t_15 * __pyx_v_exp_phi_pred.strides[0]) ) + __pyx_t_11 * __pyx_v_exp_phi_pred.strides[1]) ))) / __pyx_v_set_sum);
 
-        /* "structureboost/structure_gb_multi.pyx":602
+        /* "structureboost/structure_gb_multi.pyx":598
  *             for j in range(m):
  *                 jt = (exp_phi_pred[i,j]/set_sum)
  *                 jk = (exp_phi_pred[i,j]/exp_phi_sum_vec[i])             # <<<<<<<<<<<<<<
  *                 # if j in set containing y_true
  *                 if (rp_tensor[qqq,xyz,j]==1):
  */
         __pyx_t_11 = __pyx_v_i;
         __pyx_t_15 = __pyx_v_j;
         __pyx_t_16 = __pyx_v_i;
         __pyx_v_jk = ((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_exp_phi_pred.data + __pyx_t_11 * __pyx_v_exp_phi_pred.strides[0]) ) + __pyx_t_15 * __pyx_v_exp_phi_pred.strides[1]) ))) / (*((double *) ( /* dim=0 */ (__pyx_v_exp_phi_sum_vec.data + __pyx_t_16 * __pyx_v_exp_phi_sum_vec.strides[0]) ))));
 
-        /* "structureboost/structure_gb_multi.pyx":604
+        /* "structureboost/structure_gb_multi.pyx":600
  *                 jk = (exp_phi_pred[i,j]/exp_phi_sum_vec[i])
  *                 # if j in set containing y_true
  *                 if (rp_tensor[qqq,xyz,j]==1):             # <<<<<<<<<<<<<<
  *                     #Y[i,j]+= value when j in T * weight
  *                     Y[i,j]+=(-curr_wt * (exp_phi_pred[i,j]*(exp_phi_sum_vec[i]-set_sum)/
  */
         __pyx_t_16 = __pyx_v_qqq;
         __pyx_t_15 = __pyx_v_xyz;
         __pyx_t_11 = __pyx_v_j;
-        __pyx_t_17 = (((*((__pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rp_tensor.data + __pyx_t_16 * __pyx_v_rp_tensor.strides[0]) ) + __pyx_t_15 * __pyx_v_rp_tensor.strides[1]) ) + __pyx_t_11 * __pyx_v_rp_tensor.strides[2]) ))) == 1) != 0);
+        __pyx_t_17 = (((*((long *) ( /* dim=2 */ (( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rp_tensor.data + __pyx_t_16 * __pyx_v_rp_tensor.strides[0]) ) + __pyx_t_15 * __pyx_v_rp_tensor.strides[1]) ) + __pyx_t_11 * __pyx_v_rp_tensor.strides[2]) ))) == 1) != 0);
         if (__pyx_t_17) {
 
-          /* "structureboost/structure_gb_multi.pyx":606
+          /* "structureboost/structure_gb_multi.pyx":602
  *                 if (rp_tensor[qqq,xyz,j]==1):
  *                     #Y[i,j]+= value when j in T * weight
  *                     Y[i,j]+=(-curr_wt * (exp_phi_pred[i,j]*(exp_phi_sum_vec[i]-set_sum)/             # <<<<<<<<<<<<<<
  *                                         (set_sum*exp_phi_sum_vec[i])))
  *                     Y[i,j+m]+=(curr_wt * (jt-jk+jk*jk-jt*jt))
  */
           __pyx_t_11 = __pyx_v_i;
           __pyx_t_15 = __pyx_v_j;
           __pyx_t_16 = __pyx_v_i;
 
-          /* "structureboost/structure_gb_multi.pyx":607
+          /* "structureboost/structure_gb_multi.pyx":603
  *                     #Y[i,j]+= value when j in T * weight
  *                     Y[i,j]+=(-curr_wt * (exp_phi_pred[i,j]*(exp_phi_sum_vec[i]-set_sum)/
  *                                         (set_sum*exp_phi_sum_vec[i])))             # <<<<<<<<<<<<<<
  *                     Y[i,j+m]+=(curr_wt * (jt-jk+jk*jk-jt*jt))
  *                 else:
  */
           __pyx_t_21 = __pyx_v_i;
 
-          /* "structureboost/structure_gb_multi.pyx":606
+          /* "structureboost/structure_gb_multi.pyx":602
  *                 if (rp_tensor[qqq,xyz,j]==1):
  *                     #Y[i,j]+= value when j in T * weight
  *                     Y[i,j]+=(-curr_wt * (exp_phi_pred[i,j]*(exp_phi_sum_vec[i]-set_sum)/             # <<<<<<<<<<<<<<
  *                                         (set_sum*exp_phi_sum_vec[i])))
  *                     Y[i,j+m]+=(curr_wt * (jt-jk+jk*jk-jt*jt))
  */
           __pyx_t_22 = __pyx_v_i;
           __pyx_t_23 = __pyx_v_j;
           *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Y.data + __pyx_t_22 * __pyx_v_Y.strides[0]) ) + __pyx_t_23 * __pyx_v_Y.strides[1]) )) += ((-__pyx_v_curr_wt) * (((*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_exp_phi_pred.data + __pyx_t_11 * __pyx_v_exp_phi_pred.strides[0]) ) + __pyx_t_15 * __pyx_v_exp_phi_pred.strides[1]) ))) * ((*((double *) ( /* dim=0 */ (__pyx_v_exp_phi_sum_vec.data + __pyx_t_16 * __pyx_v_exp_phi_sum_vec.strides[0]) ))) - __pyx_v_set_sum)) / (__pyx_v_set_sum * (*((double *) ( /* dim=0 */ (__pyx_v_exp_phi_sum_vec.data + __pyx_t_21 * __pyx_v_exp_phi_sum_vec.strides[0]) ))))));
 
-          /* "structureboost/structure_gb_multi.pyx":608
+          /* "structureboost/structure_gb_multi.pyx":604
  *                     Y[i,j]+=(-curr_wt * (exp_phi_pred[i,j]*(exp_phi_sum_vec[i]-set_sum)/
  *                                         (set_sum*exp_phi_sum_vec[i])))
  *                     Y[i,j+m]+=(curr_wt * (jt-jk+jk*jk-jt*jt))             # <<<<<<<<<<<<<<
  *                 else:
  *                     #Y[i,j]+= value when j not in T * weight
  */
           __pyx_t_21 = __pyx_v_i;
           __pyx_t_16 = (__pyx_v_j + __pyx_v_m);
           *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Y.data + __pyx_t_21 * __pyx_v_Y.strides[0]) ) + __pyx_t_16 * __pyx_v_Y.strides[1]) )) += (__pyx_v_curr_wt * (((__pyx_v_jt - __pyx_v_jk) + (__pyx_v_jk * __pyx_v_jk)) - (__pyx_v_jt * __pyx_v_jt)));
 
-          /* "structureboost/structure_gb_multi.pyx":604
+          /* "structureboost/structure_gb_multi.pyx":600
  *                 jk = (exp_phi_pred[i,j]/exp_phi_sum_vec[i])
  *                 # if j in set containing y_true
  *                 if (rp_tensor[qqq,xyz,j]==1):             # <<<<<<<<<<<<<<
  *                     #Y[i,j]+= value when j in T * weight
  *                     Y[i,j]+=(-curr_wt * (exp_phi_pred[i,j]*(exp_phi_sum_vec[i]-set_sum)/
  */
           goto __pyx_L14;
         }
 
-        /* "structureboost/structure_gb_multi.pyx":611
+        /* "structureboost/structure_gb_multi.pyx":607
  *                 else:
  *                     #Y[i,j]+= value when j not in T * weight
  *                     Y[i,j]+=curr_wt * exp_phi_pred[i,j]/exp_phi_sum_vec[i]             # <<<<<<<<<<<<<<
  *                     Y[i,j+m]+=(-curr_wt * (-jk+jk*jk))
  *     return np.asarray(Y)
  */
         /*else*/ {
           __pyx_t_16 = __pyx_v_i;
           __pyx_t_21 = __pyx_v_j;
           __pyx_t_15 = __pyx_v_i;
           __pyx_t_11 = __pyx_v_i;
           __pyx_t_23 = __pyx_v_j;
           *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Y.data + __pyx_t_11 * __pyx_v_Y.strides[0]) ) + __pyx_t_23 * __pyx_v_Y.strides[1]) )) += ((__pyx_v_curr_wt * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_exp_phi_pred.data + __pyx_t_16 * __pyx_v_exp_phi_pred.strides[0]) ) + __pyx_t_21 * __pyx_v_exp_phi_pred.strides[1]) )))) / (*((double *) ( /* dim=0 */ (__pyx_v_exp_phi_sum_vec.data + __pyx_t_15 * __pyx_v_exp_phi_sum_vec.strides[0]) ))));
 
-          /* "structureboost/structure_gb_multi.pyx":612
+          /* "structureboost/structure_gb_multi.pyx":608
  *                     #Y[i,j]+= value when j not in T * weight
  *                     Y[i,j]+=curr_wt * exp_phi_pred[i,j]/exp_phi_sum_vec[i]
  *                     Y[i,j+m]+=(-curr_wt * (-jk+jk*jk))             # <<<<<<<<<<<<<<
  *     return np.asarray(Y)
  * 
  */
           __pyx_t_15 = __pyx_v_i;
@@ -14508,53 +14499,53 @@
           *((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_Y.data + __pyx_t_15 * __pyx_v_Y.strides[0]) ) + __pyx_t_21 * __pyx_v_Y.strides[1]) )) += ((-__pyx_v_curr_wt) * ((-__pyx_v_jk) + (__pyx_v_jk * __pyx_v_jk)));
         }
         __pyx_L14:;
       }
     }
   }
 
-  /* "structureboost/structure_gb_multi.pyx":613
+  /* "structureboost/structure_gb_multi.pyx":609
  *                     Y[i,j]+=curr_wt * exp_phi_pred[i,j]/exp_phi_sum_vec[i]
  *                     Y[i,j+m]+=(-curr_wt * (-jk+jk*jk))
  *     return np.asarray(Y)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_asarray); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_Y, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 613, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_Y, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 613, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 609, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb_multi.pyx":570
+  /* "structureboost/structure_gb_multi.pyx":566
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
- * def c_str_entropy_link_der_12_vec_sp(np.ndarray[dtype_int64_t] y_true,             # <<<<<<<<<<<<<<
+ * def c_str_entropy_link_der_12_vec_sp(np.ndarray[np.int_t] y_true,             # <<<<<<<<<<<<<<
  *                                  double[:,:] exp_phi_pred,
  *                                  double[:] exp_phi_sum_vec,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_2);
@@ -14582,18 +14573,18 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_rp_tensor, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb_multi.pyx":620
+/* "structureboost/structure_gb_multi.pyx":616
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
- * def get_one_hot_mat(np.ndarray[dtype_int64_t] y_true,             # <<<<<<<<<<<<<<
+ * def get_one_hot_mat(np.ndarray[np.int_t] y_true,             # <<<<<<<<<<<<<<
  *                          int num_classes):
  *     cdef int N = y_true.shape[0]
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_18structure_gb_multi_7get_one_hot_mat(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_18structure_gb_multi_7get_one_hot_mat = {"get_one_hot_mat", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_18structure_gb_multi_7get_one_hot_mat, METH_VARARGS|METH_KEYWORDS, 0};
@@ -14625,38 +14616,38 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_true)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_num_classes)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("get_one_hot_mat", 1, 2, 2, 1); __PYX_ERR(0, 620, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("get_one_hot_mat", 1, 2, 2, 1); __PYX_ERR(0, 616, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_one_hot_mat") < 0)) __PYX_ERR(0, 620, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_one_hot_mat") < 0)) __PYX_ERR(0, 616, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_y_true = ((PyArrayObject *)values[0]);
-    __pyx_v_num_classes = __Pyx_PyInt_As_int(values[1]); if (unlikely((__pyx_v_num_classes == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 621, __pyx_L3_error)
+    __pyx_v_num_classes = __Pyx_PyInt_As_int(values[1]); if (unlikely((__pyx_v_num_classes == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 617, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("get_one_hot_mat", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 620, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("get_one_hot_mat", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 616, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb_multi.get_one_hot_mat", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_y_true), __pyx_ptype_5numpy_ndarray, 1, "y_true", 0))) __PYX_ERR(0, 620, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_y_true), __pyx_ptype_5numpy_ndarray, 1, "y_true", 0))) __PYX_ERR(0, 616, __pyx_L1_error)
   __pyx_r = __pyx_pf_14structureboost_18structure_gb_multi_6get_one_hot_mat(__pyx_self, __pyx_v_y_true, __pyx_v_num_classes);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = NULL;
   __pyx_L0:;
@@ -14682,142 +14673,142 @@
   PyObject *__pyx_t_5 = NULL;
   PyArrayObject *__pyx_t_6 = NULL;
   int __pyx_t_7;
   int __pyx_t_8;
   int __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
-  __pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t __pyx_t_12;
+  Py_ssize_t __pyx_t_12;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__32)
   __Pyx_RefNannySetupContext("get_one_hot_mat", 0);
-  __Pyx_TraceCall("get_one_hot_mat", __pyx_f[0], 620, 0, __PYX_ERR(0, 620, __pyx_L1_error));
+  __Pyx_TraceCall("get_one_hot_mat", __pyx_f[0], 616, 0, __PYX_ERR(0, 616, __pyx_L1_error));
   __pyx_pybuffer_Y.pybuffer.buf = NULL;
   __pyx_pybuffer_Y.refcount = 0;
   __pyx_pybuffernd_Y.data = NULL;
   __pyx_pybuffernd_Y.rcbuffer = &__pyx_pybuffer_Y;
   __pyx_pybuffer_y_true.pybuffer.buf = NULL;
   __pyx_pybuffer_y_true.refcount = 0;
   __pyx_pybuffernd_y_true.data = NULL;
   __pyx_pybuffernd_y_true.rcbuffer = &__pyx_pybuffer_y_true;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_y_true.rcbuffer->pybuffer, (PyObject*)__pyx_v_y_true, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 620, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_y_true.rcbuffer->pybuffer, (PyObject*)__pyx_v_y_true, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 616, __pyx_L1_error)
   }
   __pyx_pybuffernd_y_true.diminfo[0].strides = __pyx_pybuffernd_y_true.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_y_true.diminfo[0].shape = __pyx_pybuffernd_y_true.rcbuffer->pybuffer.shape[0];
 
-  /* "structureboost/structure_gb_multi.pyx":622
- * def get_one_hot_mat(np.ndarray[dtype_int64_t] y_true,
+  /* "structureboost/structure_gb_multi.pyx":618
+ * def get_one_hot_mat(np.ndarray[np.int_t] y_true,
  *                          int num_classes):
  *     cdef int N = y_true.shape[0]             # <<<<<<<<<<<<<<
- *     cdef np.ndarray[dtype_int64_t, ndim=2] Y = np.zeros((N,num_classes), dtype=np.int64)
+ *     cdef np.ndarray[np.int_t, ndim=2] Y = np.zeros((N,num_classes), dtype=np.int_)
  * 
  */
   __pyx_v_N = (__pyx_v_y_true->dimensions[0]);
 
-  /* "structureboost/structure_gb_multi.pyx":623
+  /* "structureboost/structure_gb_multi.pyx":619
  *                          int num_classes):
  *     cdef int N = y_true.shape[0]
- *     cdef np.ndarray[dtype_int64_t, ndim=2] Y = np.zeros((N,num_classes), dtype=np.int64)             # <<<<<<<<<<<<<<
+ *     cdef np.ndarray[np.int_t, ndim=2] Y = np.zeros((N,num_classes), dtype=np.int_)             # <<<<<<<<<<<<<<
  * 
  *     for i in range(N):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 619, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_N); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_N); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_num_classes); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_num_classes); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 619, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 619, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
   __pyx_t_1 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 619, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 619, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 619, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 619, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 623, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 619, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 619, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 623, __pyx_L1_error)
+  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 619, __pyx_L1_error)
   __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Y.rcbuffer->pybuffer, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Y.rcbuffer->pybuffer, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
       __pyx_v_Y = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Y.rcbuffer->pybuffer.buf = NULL;
-      __PYX_ERR(0, 623, __pyx_L1_error)
+      __PYX_ERR(0, 619, __pyx_L1_error)
     } else {__pyx_pybuffernd_Y.diminfo[0].strides = __pyx_pybuffernd_Y.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Y.diminfo[0].shape = __pyx_pybuffernd_Y.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Y.diminfo[1].strides = __pyx_pybuffernd_Y.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Y.diminfo[1].shape = __pyx_pybuffernd_Y.rcbuffer->pybuffer.shape[1];
     }
   }
   __pyx_t_6 = 0;
   __pyx_v_Y = ((PyArrayObject *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "structureboost/structure_gb_multi.pyx":625
- *     cdef np.ndarray[dtype_int64_t, ndim=2] Y = np.zeros((N,num_classes), dtype=np.int64)
+  /* "structureboost/structure_gb_multi.pyx":621
+ *     cdef np.ndarray[np.int_t, ndim=2] Y = np.zeros((N,num_classes), dtype=np.int_)
  * 
  *     for i in range(N):             # <<<<<<<<<<<<<<
  *         Y[i,y_true[i]]= 1
  *     return(Y)
  */
   __pyx_t_7 = __pyx_v_N;
   __pyx_t_8 = __pyx_t_7;
   for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
     __pyx_v_i = __pyx_t_9;
 
-    /* "structureboost/structure_gb_multi.pyx":626
+    /* "structureboost/structure_gb_multi.pyx":622
  * 
  *     for i in range(N):
  *         Y[i,y_true[i]]= 1             # <<<<<<<<<<<<<<
  *     return(Y)
  * 
  */
     __pyx_t_10 = __pyx_v_i;
     __pyx_t_11 = __pyx_v_i;
-    __pyx_t_12 = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t *, __pyx_pybuffernd_y_true.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_y_true.diminfo[0].strides));
-    *__Pyx_BufPtrStrided2d(__pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t *, __pyx_pybuffernd_Y.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Y.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Y.diminfo[1].strides) = 1;
+    __pyx_t_12 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_y_true.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_y_true.diminfo[0].strides));
+    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_Y.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Y.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Y.diminfo[1].strides) = 1;
   }
 
-  /* "structureboost/structure_gb_multi.pyx":627
+  /* "structureboost/structure_gb_multi.pyx":623
  *     for i in range(N):
  *         Y[i,y_true[i]]= 1
  *     return(Y)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(((PyObject *)__pyx_v_Y));
   __pyx_r = ((PyObject *)__pyx_v_Y);
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb_multi.pyx":620
+  /* "structureboost/structure_gb_multi.pyx":616
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
- * def get_one_hot_mat(np.ndarray[dtype_int64_t] y_true,             # <<<<<<<<<<<<<<
+ * def get_one_hot_mat(np.ndarray[np.int_t] y_true,             # <<<<<<<<<<<<<<
  *                          int num_classes):
  *     cdef int N = y_true.shape[0]
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
@@ -14842,15 +14833,15 @@
   __Pyx_XDECREF((PyObject *)__pyx_v_Y);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb_multi.pyx":630
+/* "structureboost/structure_gb_multi.pyx":626
  * 
  * 
  * def my_log_loss(y_true, y_pred, eps=1e-16):             # <<<<<<<<<<<<<<
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(y_true*(np.log(y_pred)) + (1-y_true)*np.log(1-y_pred))
  */
 
@@ -14889,25 +14880,25 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_true)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_pred)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("my_log_loss", 0, 2, 3, 1); __PYX_ERR(0, 630, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("my_log_loss", 0, 2, 3, 1); __PYX_ERR(0, 626, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_eps);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "my_log_loss") < 0)) __PYX_ERR(0, 630, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "my_log_loss") < 0)) __PYX_ERR(0, 626, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
@@ -14917,15 +14908,15 @@
     }
     __pyx_v_y_true = values[0];
     __pyx_v_y_pred = values[1];
     __pyx_v_eps = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("my_log_loss", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 630, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("my_log_loss", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 626, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb_multi.my_log_loss", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_18structure_gb_multi_8my_log_loss(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred, __pyx_v_eps);
 
@@ -14949,30 +14940,30 @@
   PyObject *__pyx_t_8 = NULL;
   PyObject *__pyx_t_9 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__33)
   __Pyx_RefNannySetupContext("my_log_loss", 0);
-  __Pyx_TraceCall("my_log_loss", __pyx_f[0], 630, 0, __PYX_ERR(0, 630, __pyx_L1_error));
+  __Pyx_TraceCall("my_log_loss", __pyx_f[0], 626, 0, __PYX_ERR(0, 626, __pyx_L1_error));
   __Pyx_INCREF(__pyx_v_y_pred);
 
-  /* "structureboost/structure_gb_multi.pyx":631
+  /* "structureboost/structure_gb_multi.pyx":627
  * 
  * def my_log_loss(y_true, y_pred, eps=1e-16):
  *     y_pred = np.clip(y_pred, eps, (1-eps))             # <<<<<<<<<<<<<<
  *     out_val = -np.mean(y_true*(np.log(y_pred)) + (1-y_true)*np.log(1-y_pred))
  *     return out_val
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 627, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_clip); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_clip); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 627, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_eps, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 631, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_eps, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 627, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -14981,117 +14972,117 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_5 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_y_pred, __pyx_v_eps, __pyx_t_2};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 631, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_y_pred, __pyx_v_eps, __pyx_t_2};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 631, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   {
-    __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 631, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     if (__pyx_t_4) {
       __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
     }
     __Pyx_INCREF(__pyx_v_y_pred);
     __Pyx_GIVEREF(__pyx_v_y_pred);
     PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_5, __pyx_v_y_pred);
     __Pyx_INCREF(__pyx_v_eps);
     __Pyx_GIVEREF(__pyx_v_eps);
     PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, __pyx_v_eps);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_5, __pyx_t_2);
     __pyx_t_2 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 631, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF_SET(__pyx_v_y_pred, __pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb_multi.pyx":632
+  /* "structureboost/structure_gb_multi.pyx":628
  * def my_log_loss(y_true, y_pred, eps=1e-16):
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(y_true*(np.log(y_pred)) + (1-y_true)*np.log(1-y_pred))             # <<<<<<<<<<<<<<
  *     return out_val
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_mean); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_mean); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_log); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_log); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_2 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_2)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_2);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_3 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_2, __pyx_v_y_pred) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_y_pred);
   __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 632, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyNumber_Multiply(__pyx_v_y_true, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_v_y_true, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_y_true, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_y_true, 1, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_log); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_log); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_y_pred, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_y_pred, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __pyx_t_9 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_8))) {
     __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_8);
     if (likely(__pyx_t_9)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_8);
       __Pyx_INCREF(__pyx_t_9);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_8, function);
     }
   }
   __pyx_t_2 = (__pyx_t_9) ? __Pyx_PyObject_Call2Args(__pyx_t_8, __pyx_t_9, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_8, __pyx_t_7);
   __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  __pyx_t_8 = PyNumber_Multiply(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_8 = PyNumber_Multiply(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Add(__pyx_t_4, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Add(__pyx_t_4, __pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   __pyx_t_8 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_8)) {
@@ -15100,36 +15091,36 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_1 = (__pyx_t_8) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_8, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 632, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 628, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_out_val = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "structureboost/structure_gb_multi.pyx":633
+  /* "structureboost/structure_gb_multi.pyx":629
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(y_true*(np.log(y_pred)) + (1-y_true)*np.log(1-y_pred))
  *     return out_val             # <<<<<<<<<<<<<<
  * 
  * def my_log_loss_vec(y_true_mat, y_pred, eps=1e-16):
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_out_val);
   __pyx_r = __pyx_v_out_val;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb_multi.pyx":630
+  /* "structureboost/structure_gb_multi.pyx":626
  * 
  * 
  * def my_log_loss(y_true, y_pred, eps=1e-16):             # <<<<<<<<<<<<<<
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(y_true*(np.log(y_pred)) + (1-y_true)*np.log(1-y_pred))
  */
 
@@ -15150,15 +15141,15 @@
   __Pyx_XDECREF(__pyx_v_y_pred);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb_multi.pyx":635
+/* "structureboost/structure_gb_multi.pyx":631
  *     return out_val
  * 
  * def my_log_loss_vec(y_true_mat, y_pred, eps=1e-16):             # <<<<<<<<<<<<<<
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(np.sum(y_true_mat*np.log(y_pred),axis=1))
  */
 
@@ -15197,25 +15188,25 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_true_mat)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_pred)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("my_log_loss_vec", 0, 2, 3, 1); __PYX_ERR(0, 635, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("my_log_loss_vec", 0, 2, 3, 1); __PYX_ERR(0, 631, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_eps);
           if (value) { values[2] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "my_log_loss_vec") < 0)) __PYX_ERR(0, 635, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "my_log_loss_vec") < 0)) __PYX_ERR(0, 631, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         CYTHON_FALLTHROUGH;
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
@@ -15225,15 +15216,15 @@
     }
     __pyx_v_y_true_mat = values[0];
     __pyx_v_y_pred = values[1];
     __pyx_v_eps = values[2];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("my_log_loss_vec", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 635, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("my_log_loss_vec", 0, 2, 3, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 631, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb_multi.my_log_loss_vec", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_18structure_gb_multi_10my_log_loss_vec(__pyx_self, __pyx_v_y_true_mat, __pyx_v_y_pred, __pyx_v_eps);
 
@@ -15255,30 +15246,30 @@
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__34)
   __Pyx_RefNannySetupContext("my_log_loss_vec", 0);
-  __Pyx_TraceCall("my_log_loss_vec", __pyx_f[0], 635, 0, __PYX_ERR(0, 635, __pyx_L1_error));
+  __Pyx_TraceCall("my_log_loss_vec", __pyx_f[0], 631, 0, __PYX_ERR(0, 631, __pyx_L1_error));
   __Pyx_INCREF(__pyx_v_y_pred);
 
-  /* "structureboost/structure_gb_multi.pyx":636
+  /* "structureboost/structure_gb_multi.pyx":632
  * 
  * def my_log_loss_vec(y_true_mat, y_pred, eps=1e-16):
  *     y_pred = np.clip(y_pred, eps, (1-eps))             # <<<<<<<<<<<<<<
  *     out_val = -np.mean(np.sum(y_true_mat*np.log(y_pred),axis=1))
  *     return out_val
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_clip); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_clip); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 632, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_eps, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 636, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_SubtractCObj(__pyx_int_1, __pyx_v_eps, 1, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 632, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   __pyx_t_5 = 0;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -15287,101 +15278,101 @@
       __Pyx_DECREF_SET(__pyx_t_3, function);
       __pyx_t_5 = 1;
     }
   }
   #if CYTHON_FAST_PYCALL
   if (PyFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_y_pred, __pyx_v_eps, __pyx_t_2};
-    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 636, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   #if CYTHON_FAST_PYCCALL
   if (__Pyx_PyFastCFunction_Check(__pyx_t_3)) {
     PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_v_y_pred, __pyx_v_eps, __pyx_t_2};
-    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 636, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_3, __pyx_temp+1-__pyx_t_5, 3+__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   } else
   #endif
   {
-    __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 636, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(3+__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     if (__pyx_t_4) {
       __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
     }
     __Pyx_INCREF(__pyx_v_y_pred);
     __Pyx_GIVEREF(__pyx_v_y_pred);
     PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_5, __pyx_v_y_pred);
     __Pyx_INCREF(__pyx_v_eps);
     __Pyx_GIVEREF(__pyx_v_eps);
     PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_5, __pyx_v_eps);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_5, __pyx_t_2);
     __pyx_t_2 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 636, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF_SET(__pyx_v_y_pred, __pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb_multi.pyx":637
+  /* "structureboost/structure_gb_multi.pyx":633
  * def my_log_loss_vec(y_true_mat, y_pred, eps=1e-16):
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(np.sum(y_true_mat*np.log(y_pred),axis=1))             # <<<<<<<<<<<<<<
  *     return out_val
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_mean); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_mean); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_sum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_sum); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_log); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_log); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_7);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_7, function);
     }
   }
   __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_4, __pyx_v_y_pred) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_y_pred);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 637, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_7 = PyNumber_Multiply(__pyx_v_y_true_mat, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __pyx_t_7 = PyNumber_Multiply(__pyx_v_y_true_mat, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_7);
   __pyx_t_7 = 0;
-  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_axis, __pyx_int_1) < 0) __PYX_ERR(0, 637, __pyx_L1_error)
-  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 637, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_axis, __pyx_int_1) < 0) __PYX_ERR(0, 633, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_7 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_6);
@@ -15391,36 +15382,36 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_7, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 637, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 637, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 633, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_out_val = __pyx_t_6;
   __pyx_t_6 = 0;
 
-  /* "structureboost/structure_gb_multi.pyx":638
+  /* "structureboost/structure_gb_multi.pyx":634
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(np.sum(y_true_mat*np.log(y_pred),axis=1))
  *     return out_val             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
   __Pyx_INCREF(__pyx_v_out_val);
   __pyx_r = __pyx_v_out_val;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb_multi.pyx":635
+  /* "structureboost/structure_gb_multi.pyx":631
  *     return out_val
  * 
  * def my_log_loss_vec(y_true_mat, y_pred, eps=1e-16):             # <<<<<<<<<<<<<<
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(np.sum(y_true_mat*np.log(y_pred),axis=1))
  */
 
@@ -15439,15 +15430,15 @@
   __Pyx_XDECREF(__pyx_v_y_pred);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb_multi.pyx":641
+/* "structureboost/structure_gb_multi.pyx":637
  * 
  * 
  * def my_mean_squared_error(y_true, y_pred):             # <<<<<<<<<<<<<<
  *     return(np.mean((y_true-y_pred)*(y_true-y_pred)))
  * 
  */
 
@@ -15482,32 +15473,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_true)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_y_pred)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("my_mean_squared_error", 1, 2, 2, 1); __PYX_ERR(0, 641, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("my_mean_squared_error", 1, 2, 2, 1); __PYX_ERR(0, 637, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "my_mean_squared_error") < 0)) __PYX_ERR(0, 641, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "my_mean_squared_error") < 0)) __PYX_ERR(0, 637, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_y_true = values[0];
     __pyx_v_y_pred = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("my_mean_squared_error", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 641, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("my_mean_squared_error", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 637, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("structureboost.structure_gb_multi.my_mean_squared_error", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_14structureboost_18structure_gb_multi_12my_mean_squared_error(__pyx_self, __pyx_v_y_true, __pyx_v_y_pred);
 
@@ -15526,34 +15517,34 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__35)
   __Pyx_RefNannySetupContext("my_mean_squared_error", 0);
-  __Pyx_TraceCall("my_mean_squared_error", __pyx_f[0], 641, 0, __PYX_ERR(0, 641, __pyx_L1_error));
+  __Pyx_TraceCall("my_mean_squared_error", __pyx_f[0], 637, 0, __PYX_ERR(0, 637, __pyx_L1_error));
 
-  /* "structureboost/structure_gb_multi.pyx":642
+  /* "structureboost/structure_gb_multi.pyx":638
  * 
  * def my_mean_squared_error(y_true, y_pred):
  *     return(np.mean((y_true-y_pred)*(y_true-y_pred)))             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 642, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 638, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_mean); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 642, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_mean); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 638, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyNumber_Subtract(__pyx_v_y_true, __pyx_v_y_pred); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 642, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Subtract(__pyx_v_y_true, __pyx_v_y_pred); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 638, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyNumber_Subtract(__pyx_v_y_true, __pyx_v_y_pred); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 642, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Subtract(__pyx_v_y_true, __pyx_v_y_pred); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 638, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyNumber_Multiply(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 642, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Multiply(__pyx_t_2, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 638, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
@@ -15562,22 +15553,22 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 642, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 638, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "structureboost/structure_gb_multi.pyx":641
+  /* "structureboost/structure_gb_multi.pyx":637
  * 
  * 
  * def my_mean_squared_error(y_true, y_pred):             # <<<<<<<<<<<<<<
  *     return(np.mean((y_true-y_pred)*(y_true-y_pred)))
  * 
  */
 
@@ -15593,15 +15584,15 @@
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_TraceReturn(__pyx_r, 0);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "structureboost/structure_gb_multi.pyx":645
+/* "structureboost/structure_gb_multi.pyx":641
  * 
  * 
  * def randomize_node_na_dir_weighted(curr_node):             # <<<<<<<<<<<<<<
  *     if (('node_type' in curr_node.keys()) and
  *                 (curr_node['node_type'] == 'interior')):
  */
 
@@ -15633,329 +15624,329 @@
   int __pyx_t_6;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__36)
   __Pyx_RefNannySetupContext("randomize_node_na_dir_weighted", 0);
-  __Pyx_TraceCall("randomize_node_na_dir_weighted", __pyx_f[0], 645, 0, __PYX_ERR(0, 645, __pyx_L1_error));
+  __Pyx_TraceCall("randomize_node_na_dir_weighted", __pyx_f[0], 641, 0, __PYX_ERR(0, 641, __pyx_L1_error));
 
-  /* "structureboost/structure_gb_multi.pyx":646
+  /* "structureboost/structure_gb_multi.pyx":642
  * 
  * def randomize_node_na_dir_weighted(curr_node):
  *     if (('node_type' in curr_node.keys()) and             # <<<<<<<<<<<<<<
  *                 (curr_node['node_type'] == 'interior')):
  *         if ('na_dir_random' in curr_node.keys()) and (
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_curr_node, __pyx_n_s_keys); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 646, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_curr_node, __pyx_n_s_keys); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 642, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 646, __pyx_L1_error)
+  if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 642, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_node_type, __pyx_t_2, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 646, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_node_type, __pyx_t_2, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 642, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_6 = (__pyx_t_5 != 0);
   if (__pyx_t_6) {
   } else {
     __pyx_t_1 = __pyx_t_6;
     goto __pyx_L4_bool_binop_done;
   }
 
-  /* "structureboost/structure_gb_multi.pyx":647
+  /* "structureboost/structure_gb_multi.pyx":643
  * def randomize_node_na_dir_weighted(curr_node):
  *     if (('node_type' in curr_node.keys()) and
  *                 (curr_node['node_type'] == 'interior')):             # <<<<<<<<<<<<<<
  *         if ('na_dir_random' in curr_node.keys()) and (
  *              curr_node['na_dir_random'] == 1):
  */
-  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_node_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 647, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_node_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 643, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_t_2, __pyx_n_u_interior, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 647, __pyx_L1_error)
+  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_t_2, __pyx_n_u_interior, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 643, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_1 = __pyx_t_6;
   __pyx_L4_bool_binop_done:;
 
-  /* "structureboost/structure_gb_multi.pyx":646
+  /* "structureboost/structure_gb_multi.pyx":642
  * 
  * def randomize_node_na_dir_weighted(curr_node):
  *     if (('node_type' in curr_node.keys()) and             # <<<<<<<<<<<<<<
  *                 (curr_node['node_type'] == 'interior')):
  *         if ('na_dir_random' in curr_node.keys()) and (
  */
   if (__pyx_t_1) {
 
-    /* "structureboost/structure_gb_multi.pyx":648
+    /* "structureboost/structure_gb_multi.pyx":644
  *     if (('node_type' in curr_node.keys()) and
  *                 (curr_node['node_type'] == 'interior')):
  *         if ('na_dir_random' in curr_node.keys()) and (             # <<<<<<<<<<<<<<
  *              curr_node['na_dir_random'] == 1):
  *             lw = curr_node['left_child']['num_data_points']
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_curr_node, __pyx_n_s_keys); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 648, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_curr_node, __pyx_n_s_keys); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 644, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_2 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 648, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 644, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_na_dir_random, __pyx_t_2, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 648, __pyx_L1_error)
+    __pyx_t_6 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_na_dir_random, __pyx_t_2, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 644, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __pyx_t_5 = (__pyx_t_6 != 0);
     if (__pyx_t_5) {
     } else {
       __pyx_t_1 = __pyx_t_5;
       goto __pyx_L7_bool_binop_done;
     }
 
-    /* "structureboost/structure_gb_multi.pyx":649
+    /* "structureboost/structure_gb_multi.pyx":645
  *                 (curr_node['node_type'] == 'interior')):
  *         if ('na_dir_random' in curr_node.keys()) and (
  *              curr_node['na_dir_random'] == 1):             # <<<<<<<<<<<<<<
  *             lw = curr_node['left_child']['num_data_points']
  *             rw = curr_node['right_child']['num_data_points']
  */
-    __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_na_dir_random); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 649, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_na_dir_random); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 645, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_t_2, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 649, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyInt_EqObjC(__pyx_t_2, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 645, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 649, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 645, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_1 = __pyx_t_5;
     __pyx_L7_bool_binop_done:;
 
-    /* "structureboost/structure_gb_multi.pyx":648
+    /* "structureboost/structure_gb_multi.pyx":644
  *     if (('node_type' in curr_node.keys()) and
  *                 (curr_node['node_type'] == 'interior')):
  *         if ('na_dir_random' in curr_node.keys()) and (             # <<<<<<<<<<<<<<
  *              curr_node['na_dir_random'] == 1):
  *             lw = curr_node['left_child']['num_data_points']
  */
     if (__pyx_t_1) {
 
-      /* "structureboost/structure_gb_multi.pyx":650
+      /* "structureboost/structure_gb_multi.pyx":646
  *         if ('na_dir_random' in curr_node.keys()) and (
  *              curr_node['na_dir_random'] == 1):
  *             lw = curr_node['left_child']['num_data_points']             # <<<<<<<<<<<<<<
  *             rw = curr_node['right_child']['num_data_points']
  *             curr_node['na_left'] = int(random.random() < (lw/(lw+rw)))
  */
-      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 650, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 646, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_t_3, __pyx_n_u_num_data_points); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 650, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_t_3, __pyx_n_u_num_data_points); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 646, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __pyx_v_lw = __pyx_t_2;
       __pyx_t_2 = 0;
 
-      /* "structureboost/structure_gb_multi.pyx":651
+      /* "structureboost/structure_gb_multi.pyx":647
  *              curr_node['na_dir_random'] == 1):
  *             lw = curr_node['left_child']['num_data_points']
  *             rw = curr_node['right_child']['num_data_points']             # <<<<<<<<<<<<<<
  *             curr_node['na_left'] = int(random.random() < (lw/(lw+rw)))
  *         if curr_node['left_child']['node_type'] == 'interior':
  */
-      __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 651, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 647, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_num_data_points); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 651, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_num_data_points); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 647, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_v_rw = __pyx_t_3;
       __pyx_t_3 = 0;
 
-      /* "structureboost/structure_gb_multi.pyx":652
+      /* "structureboost/structure_gb_multi.pyx":648
  *             lw = curr_node['left_child']['num_data_points']
  *             rw = curr_node['right_child']['num_data_points']
  *             curr_node['na_left'] = int(random.random() < (lw/(lw+rw)))             # <<<<<<<<<<<<<<
  *         if curr_node['left_child']['node_type'] == 'interior':
  *             randomize_node_na_dir_weighted(curr_node['left_child'])
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 652, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 648, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 652, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 648, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_2 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_2)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
           __Pyx_INCREF(__pyx_t_2);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_4, function);
         }
       }
       __pyx_t_3 = (__pyx_t_2) ? __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallNoArg(__pyx_t_4);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 652, __pyx_L1_error)
+      if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 648, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = PyNumber_Add(__pyx_v_lw, __pyx_v_rw); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 652, __pyx_L1_error)
+      __pyx_t_4 = PyNumber_Add(__pyx_v_lw, __pyx_v_rw); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 648, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_v_lw, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 652, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyNumber_Divide(__pyx_v_lw, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 648, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      __pyx_t_4 = PyObject_RichCompare(__pyx_t_3, __pyx_t_2, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 652, __pyx_L1_error)
+      __pyx_t_4 = PyObject_RichCompare(__pyx_t_3, __pyx_t_2, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 648, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 652, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyNumber_Int(__pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 648, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-      if (unlikely(PyObject_SetItem(__pyx_v_curr_node, __pyx_n_u_na_left, __pyx_t_2) < 0)) __PYX_ERR(0, 652, __pyx_L1_error)
+      if (unlikely(PyObject_SetItem(__pyx_v_curr_node, __pyx_n_u_na_left, __pyx_t_2) < 0)) __PYX_ERR(0, 648, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-      /* "structureboost/structure_gb_multi.pyx":648
+      /* "structureboost/structure_gb_multi.pyx":644
  *     if (('node_type' in curr_node.keys()) and
  *                 (curr_node['node_type'] == 'interior')):
  *         if ('na_dir_random' in curr_node.keys()) and (             # <<<<<<<<<<<<<<
  *              curr_node['na_dir_random'] == 1):
  *             lw = curr_node['left_child']['num_data_points']
  */
     }
 
-    /* "structureboost/structure_gb_multi.pyx":653
+    /* "structureboost/structure_gb_multi.pyx":649
  *             rw = curr_node['right_child']['num_data_points']
  *             curr_node['na_left'] = int(random.random() < (lw/(lw+rw)))
  *         if curr_node['left_child']['node_type'] == 'interior':             # <<<<<<<<<<<<<<
  *             randomize_node_na_dir_weighted(curr_node['left_child'])
  *         if curr_node['right_child']['node_type'] == 'interior':
  */
-    __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 653, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 649, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_node_type); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 653, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_t_2, __pyx_n_u_node_type); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 649, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_t_4, __pyx_n_u_interior, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 653, __pyx_L1_error)
+    __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_t_4, __pyx_n_u_interior, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 649, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     if (__pyx_t_1) {
 
-      /* "structureboost/structure_gb_multi.pyx":654
+      /* "structureboost/structure_gb_multi.pyx":650
  *             curr_node['na_left'] = int(random.random() < (lw/(lw+rw)))
  *         if curr_node['left_child']['node_type'] == 'interior':
  *             randomize_node_na_dir_weighted(curr_node['left_child'])             # <<<<<<<<<<<<<<
  *         if curr_node['right_child']['node_type'] == 'interior':
  *             randomize_node_na_dir_weighted(curr_node['right_child'])
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_randomize_node_na_dir_weighted); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 654, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_randomize_node_na_dir_weighted); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 650, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 654, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_left_child); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 650, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_7 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
         __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
         if (likely(__pyx_t_7)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
           __Pyx_INCREF(__pyx_t_7);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_2, function);
         }
       }
       __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_7, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 654, __pyx_L1_error)
+      if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 650, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
-      /* "structureboost/structure_gb_multi.pyx":653
+      /* "structureboost/structure_gb_multi.pyx":649
  *             rw = curr_node['right_child']['num_data_points']
  *             curr_node['na_left'] = int(random.random() < (lw/(lw+rw)))
  *         if curr_node['left_child']['node_type'] == 'interior':             # <<<<<<<<<<<<<<
  *             randomize_node_na_dir_weighted(curr_node['left_child'])
  *         if curr_node['right_child']['node_type'] == 'interior':
  */
     }
 
-    /* "structureboost/structure_gb_multi.pyx":655
+    /* "structureboost/structure_gb_multi.pyx":651
  *         if curr_node['left_child']['node_type'] == 'interior':
  *             randomize_node_na_dir_weighted(curr_node['left_child'])
  *         if curr_node['right_child']['node_type'] == 'interior':             # <<<<<<<<<<<<<<
  *             randomize_node_na_dir_weighted(curr_node['right_child'])
  * 
  */
-    __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 655, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 651, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_t_4, __pyx_n_u_node_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 655, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Dict_GetItem(__pyx_t_4, __pyx_n_u_node_type); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 651, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_t_2, __pyx_n_u_interior, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 655, __pyx_L1_error)
+    __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_t_2, __pyx_n_u_interior, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 651, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (__pyx_t_1) {
 
-      /* "structureboost/structure_gb_multi.pyx":656
+      /* "structureboost/structure_gb_multi.pyx":652
  *             randomize_node_na_dir_weighted(curr_node['left_child'])
  *         if curr_node['right_child']['node_type'] == 'interior':
  *             randomize_node_na_dir_weighted(curr_node['right_child'])             # <<<<<<<<<<<<<<
  * 
  * # @cython.boundscheck(False)  # Deactivate bounds checking
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_randomize_node_na_dir_weighted); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 656, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_randomize_node_na_dir_weighted); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 652, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
-      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 656, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Dict_GetItem(__pyx_v_curr_node, __pyx_n_u_right_child); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 652, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_7 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_7)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
           __Pyx_INCREF(__pyx_t_7);
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_4, function);
         }
       }
       __pyx_t_2 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_7, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3);
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 656, __pyx_L1_error)
+      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 652, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-      /* "structureboost/structure_gb_multi.pyx":655
+      /* "structureboost/structure_gb_multi.pyx":651
  *         if curr_node['left_child']['node_type'] == 'interior':
  *             randomize_node_na_dir_weighted(curr_node['left_child'])
  *         if curr_node['right_child']['node_type'] == 'interior':             # <<<<<<<<<<<<<<
  *             randomize_node_na_dir_weighted(curr_node['right_child'])
  * 
  */
     }
 
-    /* "structureboost/structure_gb_multi.pyx":646
+    /* "structureboost/structure_gb_multi.pyx":642
  * 
  * def randomize_node_na_dir_weighted(curr_node):
  *     if (('node_type' in curr_node.keys()) and             # <<<<<<<<<<<<<<
  *                 (curr_node['node_type'] == 'interior')):
  *         if ('na_dir_random' in curr_node.keys()) and (
  */
   }
 
-  /* "structureboost/structure_gb_multi.pyx":645
+  /* "structureboost/structure_gb_multi.pyx":641
  * 
  * 
  * def randomize_node_na_dir_weighted(curr_node):             # <<<<<<<<<<<<<<
  *     if (('node_type' in curr_node.keys()) and
  *                 (curr_node['node_type'] == 'interior')):
  */
 
@@ -31482,15 +31473,15 @@
   {&__pyx_n_s_ind, __pyx_k_ind, sizeof(__pyx_k_ind), 0, 0, 1, 1},
   {&__pyx_n_s_ind_doub, __pyx_k_ind_doub, sizeof(__pyx_k_ind_doub), 0, 0, 1, 1},
   {&__pyx_n_s_index, __pyx_k_index, sizeof(__pyx_k_index), 0, 0, 1, 1},
   {&__pyx_n_s_init, __pyx_k_init, sizeof(__pyx_k_init), 0, 0, 1, 1},
   {&__pyx_n_s_initial_model, __pyx_k_initial_model, sizeof(__pyx_k_initial_model), 0, 0, 1, 1},
   {&__pyx_n_s_initial_pred, __pyx_k_initial_pred, sizeof(__pyx_k_initial_pred), 0, 0, 1, 1},
   {&__pyx_kp_u_instead_of_1_May_cause_unexpect, __pyx_k_instead_of_1_May_cause_unexpect, sizeof(__pyx_k_instead_of_1_May_cause_unexpect), 0, 1, 0, 0},
-  {&__pyx_n_s_int64, __pyx_k_int64, sizeof(__pyx_k_int64), 0, 0, 1, 1},
+  {&__pyx_n_s_int, __pyx_k_int, sizeof(__pyx_k_int), 0, 0, 1, 1},
   {&__pyx_n_u_interior, __pyx_k_interior, sizeof(__pyx_k_interior), 0, 1, 0, 1},
   {&__pyx_n_s_isnan, __pyx_k_isnan, sizeof(__pyx_k_isnan), 0, 0, 1, 1},
   {&__pyx_n_s_isnan_array, __pyx_k_isnan_array, sizeof(__pyx_k_isnan_array), 0, 0, 1, 1},
   {&__pyx_n_s_itemsize, __pyx_k_itemsize, sizeof(__pyx_k_itemsize), 0, 0, 1, 1},
   {&__pyx_kp_s_itemsize_0_for_cython_array, __pyx_k_itemsize_0_for_cython_array, sizeof(__pyx_k_itemsize_0_for_cython_array), 0, 0, 1, 0},
   {&__pyx_n_s_j, __pyx_k_j, sizeof(__pyx_k_j), 0, 0, 1, 1},
   {&__pyx_n_s_jk, __pyx_k_jk, sizeof(__pyx_k_jk), 0, 0, 1, 1},
@@ -32099,15 +32090,15 @@
   __pyx_codeobj__10 = (PyObject*)__Pyx_PyCode_New(2, 0, 16, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__66, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_create_rpt_from_list, 251, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__10)) __PYX_ERR(0, 251, __pyx_L1_error)
 
   /* "structureboost/structure_gb_multi.pyx":267
  *         return(rpt)
  * 
  *     def _process_y_data(self, y_data):             # <<<<<<<<<<<<<<
  *         if type(y_data) == pd.Series:
- *             y_data = y_data.to_numpy().astype(np.int64)
+ *             y_data = y_data.to_numpy().astype(np.int_)
  */
   __pyx_tuple__67 = PyTuple_Pack(2, __pyx_n_s_self, __pyx_n_s_y_data); if (unlikely(!__pyx_tuple__67)) __PYX_ERR(0, 267, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__67);
   __Pyx_GIVEREF(__pyx_tuple__67);
   __pyx_codeobj__11 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__67, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_process_y_data, 267, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 267, __pyx_L1_error)
 
   /* "structureboost/structure_gb_multi.pyx":275
@@ -32262,97 +32253,97 @@
  *                       np.ndarray[double, ndim=2] feat_array,
  */
   __pyx_tuple__80 = PyTuple_Pack(30, __pyx_n_s_dtm_float, __pyx_n_s_dtm, __pyx_n_s_feat_array, __pyx_n_s_num_classes, __pyx_n_s_cat_vals_end, __pyx_n_s_res_tens, __pyx_n_s_cn, __pyx_n_s_ri, __pyx_n_s_ind, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_q, __pyx_n_s_curr_val, __pyx_n_s_ind_doub, __pyx_n_s_at_leaf, __pyx_n_s_found_val, __pyx_n_s_isnan_array, __pyx_n_s_THRESH, __pyx_n_s_NODE_WEIGHT, __pyx_n_s_NODE_VALUE_START, __pyx_n_s_NODE_TYPE, __pyx_n_s_FEATURE_COL, __pyx_n_s_LEFT_CHILD, __pyx_n_s_RIGHT_CHILD, __pyx_n_s_NA_LEFT, __pyx_n_s_NUM_CAT_VALS, __pyx_n_s_CAT_VALS_START, __pyx_n_s_LEAF, __pyx_n_s_NUMER, __pyx_n_s_CATEG); if (unlikely(!__pyx_tuple__80)) __PYX_ERR(0, 476, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__80);
   __Pyx_GIVEREF(__pyx_tuple__80);
   __pyx_codeobj__29 = (PyObject*)__Pyx_PyCode_New(4, 0, 30, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__80, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_predict_with_tensor_c_mc, 476, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__29)) __PYX_ERR(0, 476, __pyx_L1_error)
 
-  /* "structureboost/structure_gb_multi.pyx":547
+  /* "structureboost/structure_gb_multi.pyx":543
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
- * def c_entropy_link_der_12_vec_sp(np.ndarray[dtype_int64_t] y_true,             # <<<<<<<<<<<<<<
+ * def c_entropy_link_der_12_vec_sp(np.ndarray[np.int_t] y_true,             # <<<<<<<<<<<<<<
  *                          double[:,:] exp_phi_pred,
  *                          double[:] exp_phi_sum_vec):
  */
-  __pyx_tuple__81 = PyTuple_Pack(9, __pyx_n_s_y_true, __pyx_n_s_exp_phi_pred, __pyx_n_s_exp_phi_sum_vec, __pyx_n_s_N, __pyx_n_s_m, __pyx_n_s_Y, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k); if (unlikely(!__pyx_tuple__81)) __PYX_ERR(0, 547, __pyx_L1_error)
+  __pyx_tuple__81 = PyTuple_Pack(9, __pyx_n_s_y_true, __pyx_n_s_exp_phi_pred, __pyx_n_s_exp_phi_sum_vec, __pyx_n_s_N, __pyx_n_s_m, __pyx_n_s_Y, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k); if (unlikely(!__pyx_tuple__81)) __PYX_ERR(0, 543, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__81);
   __Pyx_GIVEREF(__pyx_tuple__81);
-  __pyx_codeobj__30 = (PyObject*)__Pyx_PyCode_New(3, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__81, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_c_entropy_link_der_12_vec_sp, 547, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 547, __pyx_L1_error)
+  __pyx_codeobj__30 = (PyObject*)__Pyx_PyCode_New(3, 0, 9, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__81, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_c_entropy_link_der_12_vec_sp, 543, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 543, __pyx_L1_error)
 
-  /* "structureboost/structure_gb_multi.pyx":570
+  /* "structureboost/structure_gb_multi.pyx":566
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
- * def c_str_entropy_link_der_12_vec_sp(np.ndarray[dtype_int64_t] y_true,             # <<<<<<<<<<<<<<
+ * def c_str_entropy_link_der_12_vec_sp(np.ndarray[np.int_t] y_true,             # <<<<<<<<<<<<<<
  *                                  double[:,:] exp_phi_pred,
  *                                  double[:] exp_phi_sum_vec,
  */
-  __pyx_tuple__82 = PyTuple_Pack(22, __pyx_n_s_y_true, __pyx_n_s_exp_phi_pred, __pyx_n_s_exp_phi_sum_vec, __pyx_n_s_weight_vec, __pyx_n_s_rp_tensor, __pyx_n_s_N, __pyx_n_s_m, __pyx_n_s_ind, __pyx_n_s_qqq, __pyx_n_s_xyz, __pyx_n_s_yval, __pyx_n_s_curr_wt, __pyx_n_s_Y, __pyx_n_s_all_sum, __pyx_n_s_set_sum, __pyx_n_s_num_part, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_t, __pyx_n_s_jt, __pyx_n_s_jk); if (unlikely(!__pyx_tuple__82)) __PYX_ERR(0, 570, __pyx_L1_error)
+  __pyx_tuple__82 = PyTuple_Pack(22, __pyx_n_s_y_true, __pyx_n_s_exp_phi_pred, __pyx_n_s_exp_phi_sum_vec, __pyx_n_s_weight_vec, __pyx_n_s_rp_tensor, __pyx_n_s_N, __pyx_n_s_m, __pyx_n_s_ind, __pyx_n_s_qqq, __pyx_n_s_xyz, __pyx_n_s_yval, __pyx_n_s_curr_wt, __pyx_n_s_Y, __pyx_n_s_all_sum, __pyx_n_s_set_sum, __pyx_n_s_num_part, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_t, __pyx_n_s_jt, __pyx_n_s_jk); if (unlikely(!__pyx_tuple__82)) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__82);
   __Pyx_GIVEREF(__pyx_tuple__82);
-  __pyx_codeobj__31 = (PyObject*)__Pyx_PyCode_New(5, 0, 22, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__82, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_c_str_entropy_link_der_12_vec_sp, 570, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__31)) __PYX_ERR(0, 570, __pyx_L1_error)
+  __pyx_codeobj__31 = (PyObject*)__Pyx_PyCode_New(5, 0, 22, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__82, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_c_str_entropy_link_der_12_vec_sp, 566, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__31)) __PYX_ERR(0, 566, __pyx_L1_error)
 
-  /* "structureboost/structure_gb_multi.pyx":620
+  /* "structureboost/structure_gb_multi.pyx":616
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
- * def get_one_hot_mat(np.ndarray[dtype_int64_t] y_true,             # <<<<<<<<<<<<<<
+ * def get_one_hot_mat(np.ndarray[np.int_t] y_true,             # <<<<<<<<<<<<<<
  *                          int num_classes):
  *     cdef int N = y_true.shape[0]
  */
-  __pyx_tuple__83 = PyTuple_Pack(5, __pyx_n_s_y_true, __pyx_n_s_num_classes, __pyx_n_s_N, __pyx_n_s_Y, __pyx_n_s_i); if (unlikely(!__pyx_tuple__83)) __PYX_ERR(0, 620, __pyx_L1_error)
+  __pyx_tuple__83 = PyTuple_Pack(5, __pyx_n_s_y_true, __pyx_n_s_num_classes, __pyx_n_s_N, __pyx_n_s_Y, __pyx_n_s_i); if (unlikely(!__pyx_tuple__83)) __PYX_ERR(0, 616, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__83);
   __Pyx_GIVEREF(__pyx_tuple__83);
-  __pyx_codeobj__32 = (PyObject*)__Pyx_PyCode_New(2, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__83, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_get_one_hot_mat, 620, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 620, __pyx_L1_error)
+  __pyx_codeobj__32 = (PyObject*)__Pyx_PyCode_New(2, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__83, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_get_one_hot_mat, 616, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 616, __pyx_L1_error)
 
-  /* "structureboost/structure_gb_multi.pyx":630
+  /* "structureboost/structure_gb_multi.pyx":626
  * 
  * 
  * def my_log_loss(y_true, y_pred, eps=1e-16):             # <<<<<<<<<<<<<<
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(y_true*(np.log(y_pred)) + (1-y_true)*np.log(1-y_pred))
  */
-  __pyx_tuple__84 = PyTuple_Pack(4, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_eps, __pyx_n_s_out_val); if (unlikely(!__pyx_tuple__84)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_tuple__84 = PyTuple_Pack(4, __pyx_n_s_y_true, __pyx_n_s_y_pred, __pyx_n_s_eps, __pyx_n_s_out_val); if (unlikely(!__pyx_tuple__84)) __PYX_ERR(0, 626, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__84);
   __Pyx_GIVEREF(__pyx_tuple__84);
-  __pyx_codeobj__33 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__84, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_my_log_loss, 630, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__33)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_codeobj__33 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__84, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_my_log_loss, 626, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__33)) __PYX_ERR(0, 626, __pyx_L1_error)
 
-  /* "structureboost/structure_gb_multi.pyx":635
+  /* "structureboost/structure_gb_multi.pyx":631
  *     return out_val
  * 
  * def my_log_loss_vec(y_true_mat, y_pred, eps=1e-16):             # <<<<<<<<<<<<<<
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(np.sum(y_true_mat*np.log(y_pred),axis=1))
  */
-  __pyx_tuple__85 = PyTuple_Pack(4, __pyx_n_s_y_true_mat, __pyx_n_s_y_pred, __pyx_n_s_eps, __pyx_n_s_out_val); if (unlikely(!__pyx_tuple__85)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_tuple__85 = PyTuple_Pack(4, __pyx_n_s_y_true_mat, __pyx_n_s_y_pred, __pyx_n_s_eps, __pyx_n_s_out_val); if (unlikely(!__pyx_tuple__85)) __PYX_ERR(0, 631, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__85);
   __Pyx_GIVEREF(__pyx_tuple__85);
-  __pyx_codeobj__34 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__85, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_my_log_loss_vec, 635, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_codeobj__34 = (PyObject*)__Pyx_PyCode_New(3, 0, 4, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__85, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_my_log_loss_vec, 631, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 631, __pyx_L1_error)
 
-  /* "structureboost/structure_gb_multi.pyx":641
+  /* "structureboost/structure_gb_multi.pyx":637
  * 
  * 
  * def my_mean_squared_error(y_true, y_pred):             # <<<<<<<<<<<<<<
  *     return(np.mean((y_true-y_pred)*(y_true-y_pred)))
  * 
  */
-  __pyx_tuple__86 = PyTuple_Pack(2, __pyx_n_s_y_true, __pyx_n_s_y_pred); if (unlikely(!__pyx_tuple__86)) __PYX_ERR(0, 641, __pyx_L1_error)
+  __pyx_tuple__86 = PyTuple_Pack(2, __pyx_n_s_y_true, __pyx_n_s_y_pred); if (unlikely(!__pyx_tuple__86)) __PYX_ERR(0, 637, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__86);
   __Pyx_GIVEREF(__pyx_tuple__86);
-  __pyx_codeobj__35 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__86, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_my_mean_squared_error, 641, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__35)) __PYX_ERR(0, 641, __pyx_L1_error)
+  __pyx_codeobj__35 = (PyObject*)__Pyx_PyCode_New(2, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__86, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_my_mean_squared_error, 637, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__35)) __PYX_ERR(0, 637, __pyx_L1_error)
 
-  /* "structureboost/structure_gb_multi.pyx":645
+  /* "structureboost/structure_gb_multi.pyx":641
  * 
  * 
  * def randomize_node_na_dir_weighted(curr_node):             # <<<<<<<<<<<<<<
  *     if (('node_type' in curr_node.keys()) and
  *                 (curr_node['node_type'] == 'interior')):
  */
-  __pyx_tuple__87 = PyTuple_Pack(3, __pyx_n_s_curr_node, __pyx_n_s_lw, __pyx_n_s_rw); if (unlikely(!__pyx_tuple__87)) __PYX_ERR(0, 645, __pyx_L1_error)
+  __pyx_tuple__87 = PyTuple_Pack(3, __pyx_n_s_curr_node, __pyx_n_s_lw, __pyx_n_s_rw); if (unlikely(!__pyx_tuple__87)) __PYX_ERR(0, 641, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__87);
   __Pyx_GIVEREF(__pyx_tuple__87);
-  __pyx_codeobj__36 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__87, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_randomize_node_na_dir_weighted, 645, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 645, __pyx_L1_error)
+  __pyx_codeobj__36 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__87, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_gb_multi_pyx, __pyx_n_s_randomize_node_na_dir_weighted, 641, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__36)) __PYX_ERR(0, 641, __pyx_L1_error)
 
   /* "View.MemoryView":287
  *         return self.name
  * 
  * cdef generic = Enum("<strided and direct or indirect>")             # <<<<<<<<<<<<<<
  * cdef strided = Enum("<strided and direct>") # default
  * cdef indirect = Enum("<strided and indirect>")
@@ -33087,15 +33078,15 @@
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
   /* "structureboost/structure_gb_multi.pyx":267
  *         return(rpt)
  * 
  *     def _process_y_data(self, y_data):             # <<<<<<<<<<<<<<
  *         if type(y_data) == pd.Series:
- *             y_data = y_data.to_numpy().astype(np.int64)
+ *             y_data = y_data.to_numpy().astype(np.int_)
  */
   __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_18structure_gb_multi_19StructureBoostMulti_17_process_y_data, 0, __pyx_n_s_StructureBoostMulti__process_y_d, NULL, __pyx_n_s_structureboost_structure_gb_mult, __pyx_d, ((PyObject *)__pyx_codeobj__11)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 267, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_process_y_data, __pyx_t_5) < 0) __PYX_ERR(0, 267, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
   /* "structureboost/structure_gb_multi.pyx":275
@@ -33294,96 +33285,96 @@
  *                       np.ndarray[double, ndim=2] feat_array,
  */
   __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_gb_multi_1predict_with_tensor_c_mc, NULL, __pyx_n_s_structureboost_structure_gb_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 476, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_predict_with_tensor_c_mc, __pyx_t_1) < 0) __PYX_ERR(0, 476, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb_multi.pyx":547
+  /* "structureboost/structure_gb_multi.pyx":543
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
- * def c_entropy_link_der_12_vec_sp(np.ndarray[dtype_int64_t] y_true,             # <<<<<<<<<<<<<<
+ * def c_entropy_link_der_12_vec_sp(np.ndarray[np.int_t] y_true,             # <<<<<<<<<<<<<<
  *                          double[:,:] exp_phi_pred,
  *                          double[:] exp_phi_sum_vec):
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_gb_multi_3c_entropy_link_der_12_vec_sp, NULL, __pyx_n_s_structureboost_structure_gb_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 547, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_gb_multi_3c_entropy_link_der_12_vec_sp, NULL, __pyx_n_s_structureboost_structure_gb_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 543, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_c_entropy_link_der_12_vec_sp, __pyx_t_1) < 0) __PYX_ERR(0, 547, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_c_entropy_link_der_12_vec_sp, __pyx_t_1) < 0) __PYX_ERR(0, 543, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb_multi.pyx":570
+  /* "structureboost/structure_gb_multi.pyx":566
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
- * def c_str_entropy_link_der_12_vec_sp(np.ndarray[dtype_int64_t] y_true,             # <<<<<<<<<<<<<<
+ * def c_str_entropy_link_der_12_vec_sp(np.ndarray[np.int_t] y_true,             # <<<<<<<<<<<<<<
  *                                  double[:,:] exp_phi_pred,
  *                                  double[:] exp_phi_sum_vec,
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_gb_multi_5c_str_entropy_link_der_12_vec_sp, NULL, __pyx_n_s_structureboost_structure_gb_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 570, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_gb_multi_5c_str_entropy_link_der_12_vec_sp, NULL, __pyx_n_s_structureboost_structure_gb_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_c_str_entropy_link_der_12_vec_sp, __pyx_t_1) < 0) __PYX_ERR(0, 570, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_c_str_entropy_link_der_12_vec_sp, __pyx_t_1) < 0) __PYX_ERR(0, 566, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb_multi.pyx":620
+  /* "structureboost/structure_gb_multi.pyx":616
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
- * def get_one_hot_mat(np.ndarray[dtype_int64_t] y_true,             # <<<<<<<<<<<<<<
+ * def get_one_hot_mat(np.ndarray[np.int_t] y_true,             # <<<<<<<<<<<<<<
  *                          int num_classes):
  *     cdef int N = y_true.shape[0]
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_gb_multi_7get_one_hot_mat, NULL, __pyx_n_s_structureboost_structure_gb_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 620, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_gb_multi_7get_one_hot_mat, NULL, __pyx_n_s_structureboost_structure_gb_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_one_hot_mat, __pyx_t_1) < 0) __PYX_ERR(0, 620, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_one_hot_mat, __pyx_t_1) < 0) __PYX_ERR(0, 616, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb_multi.pyx":630
+  /* "structureboost/structure_gb_multi.pyx":626
  * 
  * 
  * def my_log_loss(y_true, y_pred, eps=1e-16):             # <<<<<<<<<<<<<<
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(y_true*(np.log(y_pred)) + (1-y_true)*np.log(1-y_pred))
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_gb_multi_9my_log_loss, NULL, __pyx_n_s_structureboost_structure_gb_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 630, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_gb_multi_9my_log_loss, NULL, __pyx_n_s_structureboost_structure_gb_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 626, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_my_log_loss, __pyx_t_1) < 0) __PYX_ERR(0, 630, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_my_log_loss, __pyx_t_1) < 0) __PYX_ERR(0, 626, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb_multi.pyx":635
+  /* "structureboost/structure_gb_multi.pyx":631
  *     return out_val
  * 
  * def my_log_loss_vec(y_true_mat, y_pred, eps=1e-16):             # <<<<<<<<<<<<<<
  *     y_pred = np.clip(y_pred, eps, (1-eps))
  *     out_val = -np.mean(np.sum(y_true_mat*np.log(y_pred),axis=1))
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_gb_multi_11my_log_loss_vec, NULL, __pyx_n_s_structureboost_structure_gb_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 635, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_gb_multi_11my_log_loss_vec, NULL, __pyx_n_s_structureboost_structure_gb_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 631, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_my_log_loss_vec, __pyx_t_1) < 0) __PYX_ERR(0, 635, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_my_log_loss_vec, __pyx_t_1) < 0) __PYX_ERR(0, 631, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb_multi.pyx":641
+  /* "structureboost/structure_gb_multi.pyx":637
  * 
  * 
  * def my_mean_squared_error(y_true, y_pred):             # <<<<<<<<<<<<<<
  *     return(np.mean((y_true-y_pred)*(y_true-y_pred)))
  * 
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_gb_multi_13my_mean_squared_error, NULL, __pyx_n_s_structureboost_structure_gb_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 641, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_gb_multi_13my_mean_squared_error, NULL, __pyx_n_s_structureboost_structure_gb_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 637, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_my_mean_squared_error, __pyx_t_1) < 0) __PYX_ERR(0, 641, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_my_mean_squared_error, __pyx_t_1) < 0) __PYX_ERR(0, 637, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "structureboost/structure_gb_multi.pyx":645
+  /* "structureboost/structure_gb_multi.pyx":641
  * 
  * 
  * def randomize_node_na_dir_weighted(curr_node):             # <<<<<<<<<<<<<<
  *     if (('node_type' in curr_node.keys()) and
  *                 (curr_node['node_type'] == 'interior')):
  */
-  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_gb_multi_15randomize_node_na_dir_weighted, NULL, __pyx_n_s_structureboost_structure_gb_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 645, __pyx_L1_error)
+  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_18structure_gb_multi_15randomize_node_na_dir_weighted, NULL, __pyx_n_s_structureboost_structure_gb_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 641, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (PyDict_SetItem(__pyx_d, __pyx_n_s_randomize_node_na_dir_weighted, __pyx_t_1) < 0) __PYX_ERR(0, 645, __pyx_L1_error)
+  if (PyDict_SetItem(__pyx_d, __pyx_n_s_randomize_node_na_dir_weighted, __pyx_t_1) < 0) __PYX_ERR(0, 641, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "structureboost/structure_gb_multi.pyx":1
  * # cython: profile=True             # <<<<<<<<<<<<<<
  * # cython: language_level=3
  * 
  */
@@ -38304,26 +38295,26 @@
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
     return result;
 }
 
 /* ObjectToMemviewSlice */
-  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_nn___pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t(PyObject *obj, int writable_flag) {
+  static CYTHON_INLINE __Pyx_memviewslice __Pyx_PyObject_to_MemoryviewSlice_dsdsds_long(PyObject *obj, int writable_flag) {
     __Pyx_memviewslice result = { 0, 0, { 0 }, { 0 }, { 0 } };
     __Pyx_BufFmt_StackElem stack[1];
     int axes_specs[] = { (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED), (__Pyx_MEMVIEW_DIRECT | __Pyx_MEMVIEW_STRIDED) };
     int retcode;
     if (obj == Py_None) {
         result.memview = (struct __pyx_memoryview_obj *) Py_None;
         return result;
     }
     retcode = __Pyx_ValidateAndInit_memviewslice(axes_specs, 0,
                                                  PyBUF_RECORDS_RO | writable_flag, 3,
-                                                 &__Pyx_TypeInfo_nn___pyx_t_14structureboost_18structure_gb_multi_dtype_int64_t, stack,
+                                                 &__Pyx_TypeInfo_long, stack,
                                                  &result, obj);
     if (unlikely(retcode == -1))
         goto __pyx_fail;
     return result;
 __pyx_fail:
     result.memview = NULL;
     result.data = NULL;
```

### Comparing `structureboost-0.4.0/structureboost/structure_rf.c` & `structureboost-0.4.1/structureboost/structure_rf.c`

 * *Files 0% similar despite different names*

```diff
@@ -2354,14 +2354,15 @@
 static PyTypeObject *__pyx_ptype_5numpy_character = 0;
 static PyTypeObject *__pyx_ptype_5numpy_ufunc = 0;
 
 /* Module declarations from 'cython' */
 
 /* Module declarations from 'structureboost.structure_rf' */
 static __Pyx_TypeInfo __Pyx_TypeInfo_double = { "double", NULL, sizeof(double), { 0 }, 0, 'R', 0, 0 };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int_t = { "int_t", NULL, sizeof(__pyx_t_5numpy_int_t), { 0 }, 0, IS_UNSIGNED(__pyx_t_5numpy_int_t) ? 'U' : 'I', IS_UNSIGNED(__pyx_t_5numpy_int_t), 0 };
 static __Pyx_TypeInfo __Pyx_TypeInfo_long = { "long", NULL, sizeof(long), { 0 }, 0, IS_UNSIGNED(long) ? 'U' : 'I', IS_UNSIGNED(long), 0 };
 #define __Pyx_MODULE_NAME "structureboost.structure_rf"
 extern int __pyx_module_is_main_structureboost__structure_rf;
 int __pyx_module_is_main_structureboost__structure_rf = 0;
 
 /* Implementation of 'structureboost.structure_rf' */
 static PyObject *__pyx_builtin_object;
@@ -2383,14 +2384,15 @@
 static const char __pyx_k_ri[] = "ri";
 static const char __pyx_k_rw[] = "rw";
 static const char __pyx_k_all[] = "all";
 static const char __pyx_k_doc[] = "__doc__";
 static const char __pyx_k_dtm[] = "dtm";
 static const char __pyx_k_fit[] = "fit";
 static const char __pyx_k_ind[] = "ind";
+static const char __pyx_k_int[] = "int_";
 static const char __pyx_k_max[] = "max";
 static const char __pyx_k_LEAF[] = "LEAF";
 static const char __pyx_k_axis[] = "axis";
 static const char __pyx_k_ceil[] = "ceil";
 static const char __pyx_k_iloc[] = "iloc";
 static const char __pyx_k_init[] = "__init__";
 static const char __pyx_k_keys[] = "keys";
@@ -2406,15 +2408,14 @@
 static const char __pyx_k_test[] = "__test__";
 static const char __pyx_k_warn[] = "warn";
 static const char __pyx_k_CATEG[] = "CATEG";
 static const char __pyx_k_NUMER[] = "NUMER";
 static const char __pyx_k_array[] = "array";
 static const char __pyx_k_dtype[] = "dtype";
 static const char __pyx_k_graph[] = "graph";
-static const char __pyx_k_int64[] = "int64";
 static const char __pyx_k_isnan[] = "isnan";
 static const char __pyx_k_items[] = "items";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_print[] = "print";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_shape[] = "shape";
 static const char __pyx_k_zeros[] = "zeros";
@@ -2674,15 +2675,15 @@
 static PyObject *__pyx_n_s_graphs;
 static PyObject *__pyx_n_s_i;
 static PyObject *__pyx_n_s_iloc;
 static PyObject *__pyx_n_s_import;
 static PyObject *__pyx_n_s_ind;
 static PyObject *__pyx_n_s_ind_doub;
 static PyObject *__pyx_n_s_init;
-static PyObject *__pyx_n_s_int64;
+static PyObject *__pyx_n_s_int;
 static PyObject *__pyx_n_u_interior;
 static PyObject *__pyx_n_s_interval;
 static PyObject *__pyx_n_s_inv_cti;
 static PyObject *__pyx_n_s_isnan;
 static PyObject *__pyx_n_s_isnan_array;
 static PyObject *__pyx_n_s_items;
 static PyObject *__pyx_n_s_j;
@@ -7624,27 +7625,27 @@
     __pyx_t_1 = 0;
 
     /* "structureboost/structure_rf.pyx":372
  *         if self.optimizable:
  *             cat_size = np.max(np.array([dt.get_max_split_size() for dt in self.dec_tree_list]))
  *             num_dt = len(self.dec_tree_list)             # <<<<<<<<<<<<<<
  *             max_nodes = np.max(np.array([dt.num_nodes for dt in self.dec_tree_list]))
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1
  */
     __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self, __pyx_n_s_dec_tree_list); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 372, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_9 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 372, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_v_num_dt = __pyx_t_9;
 
     /* "structureboost/structure_rf.pyx":373
  *             cat_size = np.max(np.array([dt.get_max_split_size() for dt in self.dec_tree_list]))
  *             num_dt = len(self.dec_tree_list)
  *             max_nodes = np.max(np.array([dt.num_nodes for dt in self.dec_tree_list]))             # <<<<<<<<<<<<<<
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, 3))
  */
     __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_max); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
@@ -7747,15 +7748,15 @@
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_v_max_nodes = __pyx_t_1;
     __pyx_t_1 = 0;
 
     /* "structureboost/structure_rf.pyx":374
  *             num_dt = len(self.dec_tree_list)
  *             max_nodes = np.max(np.array([dt.num_nodes for dt in self.dec_tree_list]))
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1             # <<<<<<<<<<<<<<
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1             # <<<<<<<<<<<<<<
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, 3))
  *             for i in range(num_dt):
  */
     __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
@@ -7780,15 +7781,15 @@
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
     __pyx_t_5 = 0;
     __pyx_t_5 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 374, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_int); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
@@ -7798,15 +7799,15 @@
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_int, __pyx_t_5) < 0) __PYX_ERR(0, 374, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
     /* "structureboost/structure_rf.pyx":375
  *             max_nodes = np.max(np.array([dt.num_nodes for dt in self.dec_tree_list]))
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, 3))             # <<<<<<<<<<<<<<
  *             for i in range(num_dt):
  *                 self.convert_dt_to_matrix(i)
  */
     __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 375, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 375, __pyx_L1_error)
@@ -7841,15 +7842,15 @@
     if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 375, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     if (__Pyx_PyObject_SetAttrStr(__pyx_v_self, __pyx_n_s_pred_tens_float, __pyx_t_5) < 0) __PYX_ERR(0, 375, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
     /* "structureboost/structure_rf.pyx":376
- *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int64)-1
+ *             self.pred_tens_int = np.zeros((num_dt, max_nodes, cat_size+6), dtype=np.int_)-1
  *             self.pred_tens_float = np.zeros((num_dt, max_nodes, 3))
  *             for i in range(num_dt):             # <<<<<<<<<<<<<<
  *                 self.convert_dt_to_matrix(i)
  *             self.optimized=True
  */
     __pyx_t_9 = __pyx_v_num_dt;
     __pyx_t_13 = __pyx_t_9;
@@ -9646,15 +9647,15 @@
   return __pyx_r;
 }
 
 /* "structureboost/structure_rf.pyx":457
  * @cython.boundscheck(False)
  * @cython.wraparound(False)
  * def predict_with_tensor_c(np.ndarray[double, ndim=3] dtm_float,             # <<<<<<<<<<<<<<
- *                       np.ndarray[long, ndim=3] dtm,
+ *                       np.ndarray[np.int_t, ndim=3] dtm,
  *                       np.ndarray[double, ndim=2] feat_array):
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_12structure_rf_5predict_with_tensor_c(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_12structure_rf_5predict_with_tensor_c = {"predict_with_tensor_c", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_12structure_rf_5predict_with_tensor_c, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_14structureboost_12structure_rf_5predict_with_tensor_c(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
@@ -9789,15 +9790,15 @@
   long __pyx_t_13;
   int __pyx_t_14;
   Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   Py_ssize_t __pyx_t_18;
   Py_ssize_t __pyx_t_19;
-  long __pyx_t_20;
+  __pyx_t_5numpy_int_t __pyx_t_20;
   Py_ssize_t __pyx_t_21;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__17)
   __Pyx_RefNannySetupContext("predict_with_tensor_c", 0);
   __Pyx_TraceCall("predict_with_tensor_c", __pyx_f[0], 457, 0, __PYX_ERR(0, 457, __pyx_L1_error));
@@ -9824,15 +9825,15 @@
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_dtm_float.rcbuffer->pybuffer, (PyObject*)__pyx_v_dtm_float, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) __PYX_ERR(0, 457, __pyx_L1_error)
   }
   __pyx_pybuffernd_dtm_float.diminfo[0].strides = __pyx_pybuffernd_dtm_float.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_dtm_float.diminfo[0].shape = __pyx_pybuffernd_dtm_float.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_dtm_float.diminfo[1].strides = __pyx_pybuffernd_dtm_float.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_dtm_float.diminfo[1].shape = __pyx_pybuffernd_dtm_float.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_dtm_float.diminfo[2].strides = __pyx_pybuffernd_dtm_float.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_dtm_float.diminfo[2].shape = __pyx_pybuffernd_dtm_float.rcbuffer->pybuffer.shape[2];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_dtm.rcbuffer->pybuffer, (PyObject*)__pyx_v_dtm, &__Pyx_TypeInfo_long, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) __PYX_ERR(0, 457, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_dtm.rcbuffer->pybuffer, (PyObject*)__pyx_v_dtm, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) __PYX_ERR(0, 457, __pyx_L1_error)
   }
   __pyx_pybuffernd_dtm.diminfo[0].strides = __pyx_pybuffernd_dtm.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_dtm.diminfo[0].shape = __pyx_pybuffernd_dtm.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_dtm.diminfo[1].strides = __pyx_pybuffernd_dtm.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_dtm.diminfo[1].shape = __pyx_pybuffernd_dtm.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_dtm.diminfo[2].strides = __pyx_pybuffernd_dtm.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_dtm.diminfo[2].shape = __pyx_pybuffernd_dtm.rcbuffer->pybuffer.shape[2];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feat_array.rcbuffer->pybuffer, (PyObject*)__pyx_v_feat_array, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 457, __pyx_L1_error)
   }
   __pyx_pybuffernd_feat_array.diminfo[0].strides = __pyx_pybuffernd_feat_array.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_feat_array.diminfo[0].shape = __pyx_pybuffernd_feat_array.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_feat_array.diminfo[1].strides = __pyx_pybuffernd_feat_array.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_feat_array.diminfo[1].shape = __pyx_pybuffernd_feat_array.rcbuffer->pybuffer.shape[1];
@@ -10117,15 +10118,15 @@
  *                 if dtm[k,cn, NODE_TYPE]==LEAF:             # <<<<<<<<<<<<<<
  *                     at_leaf = 1
  *                     res_mat[ri,k] = dtm_float[k,cn, NODE_VALUE]
  */
         __pyx_t_15 = __pyx_v_k;
         __pyx_t_16 = __pyx_v_cn;
         __pyx_t_17 = __pyx_v_NODE_TYPE;
-        __pyx_t_14 = (((*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[2].strides)) == __pyx_v_LEAF) != 0);
+        __pyx_t_14 = (((*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[2].strides)) == __pyx_v_LEAF) != 0);
         if (__pyx_t_14) {
 
           /* "structureboost/structure_rf.pyx":493
  *                 cn = int(cn)
  *                 if dtm[k,cn, NODE_TYPE]==LEAF:
  *                     at_leaf = 1             # <<<<<<<<<<<<<<
  *                     res_mat[ri,k] = dtm_float[k,cn, NODE_VALUE]
@@ -10163,28 +10164,28 @@
  *                 elif dtm[k,cn, NODE_TYPE]==NUMER:             # <<<<<<<<<<<<<<
  *                     ind = dtm[k,cn, FEATURE_COL]
  *                     if isnan_array[ri,ind]:
  */
         __pyx_t_15 = __pyx_v_k;
         __pyx_t_16 = __pyx_v_cn;
         __pyx_t_17 = __pyx_v_NODE_TYPE;
-        __pyx_t_14 = (((*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[2].strides)) == __pyx_v_NUMER) != 0);
+        __pyx_t_14 = (((*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[2].strides)) == __pyx_v_NUMER) != 0);
         if (__pyx_t_14) {
 
           /* "structureboost/structure_rf.pyx":496
  *                     res_mat[ri,k] = dtm_float[k,cn, NODE_VALUE]
  *                 elif dtm[k,cn, NODE_TYPE]==NUMER:
  *                     ind = dtm[k,cn, FEATURE_COL]             # <<<<<<<<<<<<<<
  *                     if isnan_array[ri,ind]:
  *                         cn = dtm[k,cn, LEFT_CHILD] if dtm[k,cn, NA_LEFT] else dtm[k,cn, RIGHT_CHILD]
  */
           __pyx_t_17 = __pyx_v_k;
           __pyx_t_16 = __pyx_v_cn;
           __pyx_t_15 = __pyx_v_FEATURE_COL;
-          __pyx_v_ind = (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[2].strides));
+          __pyx_v_ind = (*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[2].strides));
 
           /* "structureboost/structure_rf.pyx":497
  *                 elif dtm[k,cn, NODE_TYPE]==NUMER:
  *                     ind = dtm[k,cn, FEATURE_COL]
  *                     if isnan_array[ri,ind]:             # <<<<<<<<<<<<<<
  *                         cn = dtm[k,cn, LEFT_CHILD] if dtm[k,cn, NA_LEFT] else dtm[k,cn, RIGHT_CHILD]
  *                     else:
@@ -10200,24 +10201,24 @@
  *                         cn = dtm[k,cn, LEFT_CHILD] if dtm[k,cn, NA_LEFT] else dtm[k,cn, RIGHT_CHILD]             # <<<<<<<<<<<<<<
  *                     else:
  *                         curr_val = feat_array[ri,ind]
  */
             __pyx_t_16 = __pyx_v_k;
             __pyx_t_15 = __pyx_v_cn;
             __pyx_t_17 = __pyx_v_NA_LEFT;
-            if (((*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[2].strides)) != 0)) {
+            if (((*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[2].strides)) != 0)) {
               __pyx_t_19 = __pyx_v_k;
               __pyx_t_18 = __pyx_v_cn;
               __pyx_t_21 = __pyx_v_LEFT_CHILD;
-              __pyx_t_20 = (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_21, __pyx_pybuffernd_dtm.diminfo[2].strides));
+              __pyx_t_20 = (*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_21, __pyx_pybuffernd_dtm.diminfo[2].strides));
             } else {
               __pyx_t_21 = __pyx_v_k;
               __pyx_t_18 = __pyx_v_cn;
               __pyx_t_19 = __pyx_v_RIGHT_CHILD;
-              __pyx_t_20 = (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_19, __pyx_pybuffernd_dtm.diminfo[2].strides));
+              __pyx_t_20 = (*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_19, __pyx_pybuffernd_dtm.diminfo[2].strides));
             }
             __pyx_v_cn = __pyx_t_20;
 
             /* "structureboost/structure_rf.pyx":497
  *                 elif dtm[k,cn, NODE_TYPE]==NUMER:
  *                     ind = dtm[k,cn, FEATURE_COL]
  *                     if isnan_array[ri,ind]:             # <<<<<<<<<<<<<<
@@ -10249,20 +10250,20 @@
             __pyx_t_15 = __pyx_v_k;
             __pyx_t_17 = __pyx_v_cn;
             __pyx_t_16 = __pyx_v_THRESH;
             if (((__pyx_v_curr_val < (*__Pyx_BufPtrStrided3d(double *, __pyx_pybuffernd_dtm_float.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dtm_float.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm_float.diminfo[1].strides, __pyx_t_16, __pyx_pybuffernd_dtm_float.diminfo[2].strides))) != 0)) {
               __pyx_t_19 = __pyx_v_k;
               __pyx_t_18 = __pyx_v_cn;
               __pyx_t_21 = __pyx_v_LEFT_CHILD;
-              __pyx_t_20 = (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_21, __pyx_pybuffernd_dtm.diminfo[2].strides));
+              __pyx_t_20 = (*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_21, __pyx_pybuffernd_dtm.diminfo[2].strides));
             } else {
               __pyx_t_21 = __pyx_v_k;
               __pyx_t_18 = __pyx_v_cn;
               __pyx_t_19 = __pyx_v_RIGHT_CHILD;
-              __pyx_t_20 = (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_19, __pyx_pybuffernd_dtm.diminfo[2].strides));
+              __pyx_t_20 = (*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_19, __pyx_pybuffernd_dtm.diminfo[2].strides));
             }
             __pyx_v_cn = __pyx_t_20;
           }
           __pyx_L10:;
 
           /* "structureboost/structure_rf.pyx":495
  *                     at_leaf = 1
@@ -10280,29 +10281,29 @@
  *                 elif dtm[k,cn, NODE_TYPE]==CATEG:             # <<<<<<<<<<<<<<
  *                     curr_val = feat_array[ri,dtm[k,cn, FEATURE_COL]]
  *                     found_val = 0
  */
         __pyx_t_16 = __pyx_v_k;
         __pyx_t_17 = __pyx_v_cn;
         __pyx_t_15 = __pyx_v_NODE_TYPE;
-        __pyx_t_14 = (((*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[2].strides)) == __pyx_v_CATEG) != 0);
+        __pyx_t_14 = (((*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[2].strides)) == __pyx_v_CATEG) != 0);
         if (__pyx_t_14) {
 
           /* "structureboost/structure_rf.pyx":503
  *                         cn = dtm[k,cn, LEFT_CHILD] if curr_val<dtm_float[k,cn, THRESH] else dtm[k,cn, RIGHT_CHILD]
  *                 elif dtm[k,cn, NODE_TYPE]==CATEG:
  *                     curr_val = feat_array[ri,dtm[k,cn, FEATURE_COL]]             # <<<<<<<<<<<<<<
  *                     found_val = 0
  *                     j = CAT_VALS_START
  */
           __pyx_t_15 = __pyx_v_k;
           __pyx_t_17 = __pyx_v_cn;
           __pyx_t_16 = __pyx_v_FEATURE_COL;
           __pyx_t_19 = __pyx_v_ri;
-          __pyx_t_18 = (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[2].strides));
+          __pyx_t_18 = (*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[2].strides));
           __pyx_v_curr_val = (*__Pyx_BufPtrStrided2d(double *, __pyx_pybuffernd_feat_array.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_feat_array.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_feat_array.diminfo[1].strides));
 
           /* "structureboost/structure_rf.pyx":504
  *                 elif dtm[k,cn, NODE_TYPE]==CATEG:
  *                     curr_val = feat_array[ri,dtm[k,cn, FEATURE_COL]]
  *                     found_val = 0             # <<<<<<<<<<<<<<
  *                     j = CAT_VALS_START
@@ -10325,15 +10326,15 @@
  *                     cat_vals_end = CAT_VALS_START + dtm[k, cn, NUM_CAT_VALS]             # <<<<<<<<<<<<<<
  *                     while ((not found_val) & (j<cat_vals_end)):
  *                         if curr_val==dtm[k,cn, j]:
  */
           __pyx_t_16 = __pyx_v_k;
           __pyx_t_17 = __pyx_v_cn;
           __pyx_t_15 = __pyx_v_NUM_CAT_VALS;
-          __pyx_v_cat_vals_end = (__pyx_v_CAT_VALS_START + (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[2].strides)));
+          __pyx_v_cat_vals_end = (__pyx_v_CAT_VALS_START + (*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[2].strides)));
 
           /* "structureboost/structure_rf.pyx":507
  *                     j = CAT_VALS_START
  *                     cat_vals_end = CAT_VALS_START + dtm[k, cn, NUM_CAT_VALS]
  *                     while ((not found_val) & (j<cat_vals_end)):             # <<<<<<<<<<<<<<
  *                         if curr_val==dtm[k,cn, j]:
  *                             found_val=1
@@ -10348,15 +10349,15 @@
  *                         if curr_val==dtm[k,cn, j]:             # <<<<<<<<<<<<<<
  *                             found_val=1
  *                         else:
  */
             __pyx_t_15 = __pyx_v_k;
             __pyx_t_17 = __pyx_v_cn;
             __pyx_t_16 = __pyx_v_j;
-            __pyx_t_14 = ((__pyx_v_curr_val == (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[2].strides))) != 0);
+            __pyx_t_14 = ((__pyx_v_curr_val == (*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[2].strides))) != 0);
             if (__pyx_t_14) {
 
               /* "structureboost/structure_rf.pyx":509
  *                     while ((not found_val) & (j<cat_vals_end)):
  *                         if curr_val==dtm[k,cn, j]:
  *                             found_val=1             # <<<<<<<<<<<<<<
  *                         else:
@@ -10393,20 +10394,20 @@
  *                     cn = dtm[k,cn, LEFT_CHILD] if found_val else dtm[k,cn, RIGHT_CHILD]             # <<<<<<<<<<<<<<
  *     return(res_mat)
  */
           if ((__pyx_v_found_val != 0)) {
             __pyx_t_16 = __pyx_v_k;
             __pyx_t_17 = __pyx_v_cn;
             __pyx_t_15 = __pyx_v_LEFT_CHILD;
-            __pyx_t_20 = (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[2].strides));
+            __pyx_t_20 = (*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[2].strides));
           } else {
             __pyx_t_15 = __pyx_v_k;
             __pyx_t_17 = __pyx_v_cn;
             __pyx_t_16 = __pyx_v_RIGHT_CHILD;
-            __pyx_t_20 = (*__Pyx_BufPtrStrided3d(long *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[2].strides));
+            __pyx_t_20 = (*__Pyx_BufPtrStrided3d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_dtm.rcbuffer->pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_dtm.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_dtm.diminfo[1].strides, __pyx_t_16, __pyx_pybuffernd_dtm.diminfo[2].strides));
           }
           __pyx_v_cn = __pyx_t_20;
 
           /* "structureboost/structure_rf.pyx":502
  *                         curr_val = feat_array[ri,ind]
  *                         cn = dtm[k,cn, LEFT_CHILD] if curr_val<dtm_float[k,cn, THRESH] else dtm[k,cn, RIGHT_CHILD]
  *                 elif dtm[k,cn, NODE_TYPE]==CATEG:             # <<<<<<<<<<<<<<
@@ -10429,15 +10430,15 @@
   __pyx_r = ((PyObject *)__pyx_v_res_mat);
   goto __pyx_L0;
 
   /* "structureboost/structure_rf.pyx":457
  * @cython.boundscheck(False)
  * @cython.wraparound(False)
  * def predict_with_tensor_c(np.ndarray[double, ndim=3] dtm_float,             # <<<<<<<<<<<<<<
- *                       np.ndarray[long, ndim=3] dtm,
+ *                       np.ndarray[np.int_t, ndim=3] dtm,
  *                       np.ndarray[double, ndim=2] feat_array):
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
@@ -11728,15 +11729,15 @@
   {&__pyx_n_s_graphs, __pyx_k_graphs, sizeof(__pyx_k_graphs), 0, 0, 1, 1},
   {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
   {&__pyx_n_s_iloc, __pyx_k_iloc, sizeof(__pyx_k_iloc), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
   {&__pyx_n_s_ind, __pyx_k_ind, sizeof(__pyx_k_ind), 0, 0, 1, 1},
   {&__pyx_n_s_ind_doub, __pyx_k_ind_doub, sizeof(__pyx_k_ind_doub), 0, 0, 1, 1},
   {&__pyx_n_s_init, __pyx_k_init, sizeof(__pyx_k_init), 0, 0, 1, 1},
-  {&__pyx_n_s_int64, __pyx_k_int64, sizeof(__pyx_k_int64), 0, 0, 1, 1},
+  {&__pyx_n_s_int, __pyx_k_int, sizeof(__pyx_k_int), 0, 0, 1, 1},
   {&__pyx_n_u_interior, __pyx_k_interior, sizeof(__pyx_k_interior), 0, 1, 0, 1},
   {&__pyx_n_s_interval, __pyx_k_interval, sizeof(__pyx_k_interval), 0, 0, 1, 1},
   {&__pyx_n_s_inv_cti, __pyx_k_inv_cti, sizeof(__pyx_k_inv_cti), 0, 0, 1, 1},
   {&__pyx_n_s_isnan, __pyx_k_isnan, sizeof(__pyx_k_isnan), 0, 0, 1, 1},
   {&__pyx_n_s_isnan_array, __pyx_k_isnan_array, sizeof(__pyx_k_isnan_array), 0, 0, 1, 1},
   {&__pyx_n_s_items, __pyx_k_items, sizeof(__pyx_k_items), 0, 0, 1, 1},
   {&__pyx_n_s_j, __pyx_k_j, sizeof(__pyx_k_j), 0, 0, 1, 1},
@@ -12085,15 +12086,15 @@
   __Pyx_GIVEREF(__pyx_tuple__35);
   __pyx_codeobj__16 = (PyObject*)__Pyx_PyCode_New(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_rf_pyx, __pyx_n_s_randomize_node_na_dir_weighted, 442, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__16)) __PYX_ERR(0, 442, __pyx_L1_error)
 
   /* "structureboost/structure_rf.pyx":457
  * @cython.boundscheck(False)
  * @cython.wraparound(False)
  * def predict_with_tensor_c(np.ndarray[double, ndim=3] dtm_float,             # <<<<<<<<<<<<<<
- *                       np.ndarray[long, ndim=3] dtm,
+ *                       np.ndarray[np.int_t, ndim=3] dtm,
  *                       np.ndarray[double, ndim=2] feat_array):
  */
   __pyx_tuple__36 = PyTuple_Pack(27, __pyx_n_s_dtm_float, __pyx_n_s_dtm, __pyx_n_s_feat_array, __pyx_n_s_cat_vals_end, __pyx_n_s_res_mat, __pyx_n_s_cn, __pyx_n_s_ri, __pyx_n_s_ind, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_curr_val, __pyx_n_s_ind_doub, __pyx_n_s_at_leaf, __pyx_n_s_found_val, __pyx_n_s_isnan_array, __pyx_n_s_THRESH, __pyx_n_s_NODE_VALUE, __pyx_n_s_NODE_TYPE, __pyx_n_s_FEATURE_COL, __pyx_n_s_LEFT_CHILD, __pyx_n_s_RIGHT_CHILD, __pyx_n_s_NA_LEFT, __pyx_n_s_NUM_CAT_VALS, __pyx_n_s_CAT_VALS_START, __pyx_n_s_LEAF, __pyx_n_s_NUMER, __pyx_n_s_CATEG); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(0, 457, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__36);
   __Pyx_GIVEREF(__pyx_tuple__36);
   __pyx_codeobj__17 = (PyObject*)__Pyx_PyCode_New(3, 0, 27, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__36, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_rf_pyx, __pyx_n_s_predict_with_tensor_c, 457, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__17)) __PYX_ERR(0, 457, __pyx_L1_error)
   __Pyx_RefNannyFinishContext();
@@ -12737,15 +12738,15 @@
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_randomize_node_na_dir_weighted, __pyx_t_1) < 0) __PYX_ERR(0, 442, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "structureboost/structure_rf.pyx":457
  * @cython.boundscheck(False)
  * @cython.wraparound(False)
  * def predict_with_tensor_c(np.ndarray[double, ndim=3] dtm_float,             # <<<<<<<<<<<<<<
- *                       np.ndarray[long, ndim=3] dtm,
+ *                       np.ndarray[np.int_t, ndim=3] dtm,
  *                       np.ndarray[double, ndim=2] feat_array):
  */
   __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_12structure_rf_5predict_with_tensor_c, NULL, __pyx_n_s_structureboost_structure_rf); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 457, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_predict_with_tensor_c, __pyx_t_1) < 0) __PYX_ERR(0, 457, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
```

### Comparing `structureboost-0.4.0/structureboost/structure_rfdt.c` & `structureboost-0.4.1/structureboost/structure_rfdt.c`

 * *Files 1% similar despite different names*

```diff
@@ -1208,23 +1208,14 @@
  * ctypedef npy_double     float_t
  * ctypedef npy_double     double_t
  * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
  * 
  * ctypedef npy_cfloat      cfloat_t
  */
 typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
-
-/* "structureboost/structure_rfdt.pyx":18
- * cimport cython
- * 
- * ctypedef np.int64_t dtype_int64_t             # <<<<<<<<<<<<<<
- * 
- * class StructureRFDecisionTree(StructureDecisionTree):
- */
-typedef __pyx_t_5numpy_int64_t __pyx_t_14structureboost_14structure_rfdt_dtype_int64_t;
 /* Declarations.proto */
 #if CYTHON_CCOMPLEX
   #ifdef __cplusplus
     typedef ::std::complex< float > __pyx_t_float_complex;
   #else
     typedef float _Complex __pyx_t_float_complex;
   #endif
@@ -2240,15 +2231,15 @@
 static PyTypeObject *__pyx_ptype_5numpy_character = 0;
 static PyTypeObject *__pyx_ptype_5numpy_ufunc = 0;
 
 /* Module declarations from 'cython' */
 
 /* Module declarations from 'structureboost.structure_rfdt' */
 static __Pyx_TypeInfo __Pyx_TypeInfo_double = { "double", NULL, sizeof(double), { 0 }, 0, 'R', 0, 0 };
-static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_14structureboost_14structure_rfdt_dtype_int64_t = { "dtype_int64_t", NULL, sizeof(__pyx_t_14structureboost_14structure_rfdt_dtype_int64_t), { 0 }, 0, IS_UNSIGNED(__pyx_t_14structureboost_14structure_rfdt_dtype_int64_t) ? 'U' : 'I', IS_UNSIGNED(__pyx_t_14structureboost_14structure_rfdt_dtype_int64_t), 0 };
+static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_int_t = { "int_t", NULL, sizeof(__pyx_t_5numpy_int_t), { 0 }, 0, IS_UNSIGNED(__pyx_t_5numpy_int_t) ? 'U' : 'I', IS_UNSIGNED(__pyx_t_5numpy_int_t), 0 };
 #define __Pyx_MODULE_NAME "structureboost.structure_rfdt"
 extern int __pyx_module_is_main_structureboost__structure_rfdt;
 int __pyx_module_is_main_structureboost__structure_rfdt = 0;
 
 /* Implementation of 'structureboost.structure_rfdt' */
 static PyObject *__pyx_builtin_super;
 static PyObject *__pyx_builtin_range;
@@ -2263,14 +2254,15 @@
 static const char __pyx_k_sp[] = "sp";
 static const char __pyx_k_cbl[] = "cbl";
 static const char __pyx_k_cbr[] = "cbr";
 static const char __pyx_k_cbt[] = "cbt";
 static const char __pyx_k_doc[] = "__doc__";
 static const char __pyx_k_eps[] = "eps";
 static const char __pyx_k_inf[] = "inf";
+static const char __pyx_k_int[] = "int_";
 static const char __pyx_k_log[] = "log";
 static const char __pyx_k_mls[] = "mls";
 static const char __pyx_k_sum[] = "sum";
 static const char __pyx_k_ysl[] = "ysl";
 static const char __pyx_k_ysr[] = "ysr";
 static const char __pyx_k_yst[] = "yst";
 static const char __pyx_k_axis[] = "axis";
@@ -2288,15 +2280,14 @@
 static const char __pyx_k_self[] = "self";
 static const char __pyx_k_side[] = "side";
 static const char __pyx_k_test[] = "__test__";
 static const char __pyx_k_array[] = "array";
 static const char __pyx_k_depth[] = "depth";
 static const char __pyx_k_dtype[] = "dtype";
 static const char __pyx_k_gamma[] = "gamma";
-static const char __pyx_k_int64[] = "int64";
 static const char __pyx_k_isnan[] = "isnan";
 static const char __pyx_k_numpy[] = "numpy";
 static const char __pyx_k_range[] = "range";
 static const char __pyx_k_right[] = "right";
 static const char __pyx_k_scipy[] = "scipy";
 static const char __pyx_k_shape[] = "shape";
 static const char __pyx_k_super[] = "super";
@@ -2501,15 +2492,15 @@
 static PyObject *__pyx_n_u_graphical_voronoi;
 static PyObject *__pyx_n_s_graphs;
 static PyObject *__pyx_n_s_has_na_vals;
 static PyObject *__pyx_n_s_i;
 static PyObject *__pyx_n_s_import;
 static PyObject *__pyx_n_s_inf;
 static PyObject *__pyx_n_s_init;
-static PyObject *__pyx_n_s_int64;
+static PyObject *__pyx_n_s_int;
 static PyObject *__pyx_n_s_isnan;
 static PyObject *__pyx_n_s_j;
 static PyObject *__pyx_n_s_leaf_vertex_ind;
 static PyObject *__pyx_n_s_left_feat_values;
 static PyObject *__pyx_n_s_left_mean;
 static PyObject *__pyx_n_s_left_split;
 static PyObject *__pyx_n_s_log;
@@ -3678,75 +3669,75 @@
   __pyx_t_1 = 0;
 
   /* "structureboost/structure_rfdt.pyx":65
  * 
  *         has_na_vals = np.isnan(split_vec[-1])
  *         bin_result_vec = np.searchsorted(split_vec,             # <<<<<<<<<<<<<<
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)
+ *                                          side='right').astype(np.int_)
  */
   __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 65, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_searchsorted); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 65, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
   /* "structureboost/structure_rfdt.pyx":66
  *         has_na_vals = np.isnan(split_vec[-1])
  *         bin_result_vec = np.searchsorted(split_vec,
  *                                          feature_vec,             # <<<<<<<<<<<<<<
- *                                          side='right').astype(np.int64)
+ *                                          side='right').astype(np.int_)
  *         y_sum_bins, count_in_bins = get_bin_sums_c_rfbin(y_c_mat[:,0],
  */
   __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 65, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_INCREF(__pyx_v_split_vec);
   __Pyx_GIVEREF(__pyx_v_split_vec);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_v_split_vec);
   __Pyx_INCREF(__pyx_v_feature_vec);
   __Pyx_GIVEREF(__pyx_v_feature_vec);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_v_feature_vec);
 
   /* "structureboost/structure_rfdt.pyx":67
  *         bin_result_vec = np.searchsorted(split_vec,
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)             # <<<<<<<<<<<<<<
+ *                                          side='right').astype(np.int_)             # <<<<<<<<<<<<<<
  *         y_sum_bins, count_in_bins = get_bin_sums_c_rfbin(y_c_mat[:,0],
  *                                                 bin_result_vec,
  */
   __pyx_t_4 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 67, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_side, __pyx_n_u_right) < 0) __PYX_ERR(0, 67, __pyx_L1_error)
 
   /* "structureboost/structure_rfdt.pyx":65
  * 
  *         has_na_vals = np.isnan(split_vec[-1])
  *         bin_result_vec = np.searchsorted(split_vec,             # <<<<<<<<<<<<<<
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)
+ *                                          side='right').astype(np.int_)
  */
   __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 65, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
   /* "structureboost/structure_rfdt.pyx":67
  *         bin_result_vec = np.searchsorted(split_vec,
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)             # <<<<<<<<<<<<<<
+ *                                          side='right').astype(np.int_)             # <<<<<<<<<<<<<<
  *         y_sum_bins, count_in_bins = get_bin_sums_c_rfbin(y_c_mat[:,0],
  *                                                 bin_result_vec,
  */
   __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 67, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 67, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 67, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_int); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 67, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -3762,15 +3753,15 @@
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_bin_result_vec = __pyx_t_1;
   __pyx_t_1 = 0;
 
   /* "structureboost/structure_rfdt.pyx":68
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)
+ *                                          side='right').astype(np.int_)
  *         y_sum_bins, count_in_bins = get_bin_sums_c_rfbin(y_c_mat[:,0],             # <<<<<<<<<<<<<<
  *                                                 bin_result_vec,
  *                                                 len(split_vec)+1)
  */
   __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_get_bin_sums_c_rfbin); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 68, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_3 = __Pyx_PyObject_GetItem(__pyx_v_y_c_mat, __pyx_tuple__4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 68, __pyx_L1_error)
@@ -3883,15 +3874,15 @@
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
     __PYX_ERR(0, 68, __pyx_L1_error)
     __pyx_L4_unpacking_done:;
   }
 
   /* "structureboost/structure_rfdt.pyx":68
  *                                          feature_vec,
- *                                          side='right').astype(np.int64)
+ *                                          side='right').astype(np.int_)
  *         y_sum_bins, count_in_bins = get_bin_sums_c_rfbin(y_c_mat[:,0],             # <<<<<<<<<<<<<<
  *                                                 bin_result_vec,
  *                                                 len(split_vec)+1)
  */
   __pyx_v_y_sum_bins = __pyx_t_4;
   __pyx_t_4 = 0;
   __pyx_v_count_in_bins = __pyx_t_8;
@@ -5832,15 +5823,15 @@
     }
 
     /* "structureboost/structure_rfdt.pyx":138
  *                                             c_left, y_c_sum[1]-c_left,
  *                                             float(self.min_leaf_size))
  *             elif feature_type in ['categorical_int','graphical_voronoi']:             # <<<<<<<<<<<<<<
  *                 fs_array = np.fromiter(left_feat_values, int,
- *                 len(left_feat_values)).astype(np.int64)
+ *                 len(left_feat_values)).astype(np.int_)
  */
     __Pyx_INCREF(__pyx_v_feature_type);
     __pyx_t_1 = __pyx_v_feature_type;
     __pyx_t_11 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_categorical_int, Py_EQ)); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 138, __pyx_L1_error)
     if (!__pyx_t_11) {
     } else {
       __pyx_t_3 = __pyx_t_11;
@@ -5853,27 +5844,27 @@
     __pyx_t_11 = (__pyx_t_3 != 0);
     if (__pyx_t_11) {
 
       /* "structureboost/structure_rfdt.pyx":139
  *                                             float(self.min_leaf_size))
  *             elif feature_type in ['categorical_int','graphical_voronoi']:
  *                 fs_array = np.fromiter(left_feat_values, int,             # <<<<<<<<<<<<<<
- *                 len(left_feat_values)).astype(np.int64)
+ *                 len(left_feat_values)).astype(np.int_)
  *                 vec_len = len(feature_vec_node)
  */
       __Pyx_GetModuleGlobalName(__pyx_t_10, __pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 139, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_fromiter); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 139, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
 
       /* "structureboost/structure_rfdt.pyx":140
  *             elif feature_type in ['categorical_int','graphical_voronoi']:
  *                 fs_array = np.fromiter(left_feat_values, int,
- *                 len(left_feat_values)).astype(np.int64)             # <<<<<<<<<<<<<<
+ *                 len(left_feat_values)).astype(np.int_)             # <<<<<<<<<<<<<<
  *                 vec_len = len(feature_vec_node)
  *                 lsplit_len = len(fs_array)
  */
       __pyx_t_12 = PyObject_Length(__pyx_v_left_feat_values); if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 140, __pyx_L1_error)
       __pyx_t_10 = PyInt_FromSsize_t(__pyx_t_12); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 140, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __pyx_t_5 = NULL;
@@ -5927,15 +5918,15 @@
       }
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 140, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 140, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 140, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 140, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_2 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_2)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -5951,37 +5942,37 @@
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __pyx_v_fs_array = __pyx_t_1;
       __pyx_t_1 = 0;
 
       /* "structureboost/structure_rfdt.pyx":141
  *                 fs_array = np.fromiter(left_feat_values, int,
- *                 len(left_feat_values)).astype(np.int64)
+ *                 len(left_feat_values)).astype(np.int_)
  *                 vec_len = len(feature_vec_node)             # <<<<<<<<<<<<<<
  *                 lsplit_len = len(fs_array)
- *                 mask = np.zeros(vec_len, dtype=np.int64)
+ *                 mask = np.zeros(vec_len, dtype=np.int_)
  */
       __pyx_t_12 = PyObject_Length(__pyx_v_feature_vec_node); if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 141, __pyx_L1_error)
       __pyx_v_vec_len = __pyx_t_12;
 
       /* "structureboost/structure_rfdt.pyx":142
- *                 len(left_feat_values)).astype(np.int64)
+ *                 len(left_feat_values)).astype(np.int_)
  *                 vec_len = len(feature_vec_node)
  *                 lsplit_len = len(fs_array)             # <<<<<<<<<<<<<<
- *                 mask = np.zeros(vec_len, dtype=np.int64)
- *                 mask = get_mask_int_c(feature_vec_node.astype(np.int64),
+ *                 mask = np.zeros(vec_len, dtype=np.int_)
+ *                 mask = get_mask_int_c(feature_vec_node.astype(np.int_),
  */
       __pyx_t_12 = PyObject_Length(__pyx_v_fs_array); if (unlikely(__pyx_t_12 == ((Py_ssize_t)-1))) __PYX_ERR(0, 142, __pyx_L1_error)
       __pyx_v_lsplit_len = __pyx_t_12;
 
       /* "structureboost/structure_rfdt.pyx":143
  *                 vec_len = len(feature_vec_node)
  *                 lsplit_len = len(fs_array)
- *                 mask = np.zeros(vec_len, dtype=np.int64)             # <<<<<<<<<<<<<<
- *                 mask = get_mask_int_c(feature_vec_node.astype(np.int64),
+ *                 mask = np.zeros(vec_len, dtype=np.int_)             # <<<<<<<<<<<<<<
+ *                 mask = get_mask_int_c(feature_vec_node.astype(np.int_),
  *                                fs_array, vec_len, lsplit_len,
  */
       __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 143, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 143, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
@@ -5992,41 +5983,41 @@
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
       __pyx_t_1 = 0;
       __pyx_t_1 = __Pyx_PyDict_NewPresized(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 143, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 143, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int64); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 143, __pyx_L1_error)
+      __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 143, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_10) < 0) __PYX_ERR(0, 143, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 143, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_v_mask = __pyx_t_10;
       __pyx_t_10 = 0;
 
       /* "structureboost/structure_rfdt.pyx":144
  *                 lsplit_len = len(fs_array)
- *                 mask = np.zeros(vec_len, dtype=np.int64)
- *                 mask = get_mask_int_c(feature_vec_node.astype(np.int64),             # <<<<<<<<<<<<<<
+ *                 mask = np.zeros(vec_len, dtype=np.int_)
+ *                 mask = get_mask_int_c(feature_vec_node.astype(np.int_),             # <<<<<<<<<<<<<<
  *                                fs_array, vec_len, lsplit_len,
  *                                mask)
  */
       __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_get_mask_int_c); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 144, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_feature_vec_node, __pyx_n_s_astype); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 144, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 144, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 144, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_int); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 144, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_2 = NULL;
       if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_4))) {
         __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_4);
         if (likely(__pyx_t_2)) {
           PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
@@ -6039,27 +6030,27 @@
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 144, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
 
       /* "structureboost/structure_rfdt.pyx":145
- *                 mask = np.zeros(vec_len, dtype=np.int64)
- *                 mask = get_mask_int_c(feature_vec_node.astype(np.int64),
+ *                 mask = np.zeros(vec_len, dtype=np.int_)
+ *                 mask = get_mask_int_c(feature_vec_node.astype(np.int_),
  *                                fs_array, vec_len, lsplit_len,             # <<<<<<<<<<<<<<
  *                                mask)
  * 
  */
       __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_vec_len); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 145, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_lsplit_len); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 145, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
 
       /* "structureboost/structure_rfdt.pyx":146
- *                 mask = get_mask_int_c(feature_vec_node.astype(np.int64),
+ *                 mask = get_mask_int_c(feature_vec_node.astype(np.int_),
  *                                fs_array, vec_len, lsplit_len,
  *                                mask)             # <<<<<<<<<<<<<<
  * 
  *                 curr_loss = _get_mse_mask(y_c_mat[:,0], mask, y_left,
  */
       __pyx_t_2 = NULL;
       __pyx_t_8 = 0;
@@ -6246,15 +6237,15 @@
       __pyx_t_10 = 0;
 
       /* "structureboost/structure_rfdt.pyx":138
  *                                             c_left, y_c_sum[1]-c_left,
  *                                             float(self.min_leaf_size))
  *             elif feature_type in ['categorical_int','graphical_voronoi']:             # <<<<<<<<<<<<<<
  *                 fs_array = np.fromiter(left_feat_values, int,
- *                 len(left_feat_values)).astype(np.int64)
+ *                 len(left_feat_values)).astype(np.int_)
  */
     }
     __pyx_L4:;
 
     /* "structureboost/structure_rfdt.pyx":131
  *                                                         float(self.min_leaf_size))
  * 
@@ -6815,15 +6806,15 @@
   return __pyx_r;
 }
 
 /* "structureboost/structure_rfdt.pyx":175
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * def get_bin_sums_c_rfbin(np.ndarray[double] y_vec,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] bin_result_vec, long out_vec_size):
+ *                    np.ndarray[np.int_t] bin_result_vec, long out_vec_size):
  *     cdef int i
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_14structure_rfdt_1get_bin_sums_c_rfbin(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_14structure_rfdt_1get_bin_sums_c_rfbin = {"get_bin_sums_c_rfbin", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_14structure_rfdt_1get_bin_sums_c_rfbin, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_14structureboost_14structure_rfdt_1get_bin_sums_c_rfbin(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
@@ -6928,15 +6919,15 @@
   PyArrayObject *__pyx_t_5 = NULL;
   PyArrayObject *__pyx_t_6 = NULL;
   int __pyx_t_7;
   int __pyx_t_8;
   int __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
-  __pyx_t_14structureboost_14structure_rfdt_dtype_int64_t __pyx_t_12;
+  Py_ssize_t __pyx_t_12;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_TraceFrameInit(__pyx_codeobj__11)
   __Pyx_RefNannySetupContext("get_bin_sums_c_rfbin", 0);
   __Pyx_TraceCall("get_bin_sums_c_rfbin", __pyx_f[0], 175, 0, __PYX_ERR(0, 175, __pyx_L1_error));
   __pyx_pybuffer_y_sum_bins.pybuffer.buf = NULL;
@@ -6958,20 +6949,20 @@
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_y_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_y_vec, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 175, __pyx_L1_error)
   }
   __pyx_pybuffernd_y_vec.diminfo[0].strides = __pyx_pybuffernd_y_vec.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_y_vec.diminfo[0].shape = __pyx_pybuffernd_y_vec.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_bin_result_vec, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_14structure_rfdt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 175, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_bin_result_vec, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 175, __pyx_L1_error)
   }
   __pyx_pybuffernd_bin_result_vec.diminfo[0].strides = __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_bin_result_vec.diminfo[0].shape = __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.shape[0];
 
   /* "structureboost/structure_rfdt.pyx":178
- *                    np.ndarray[dtype_int64_t] bin_result_vec, long out_vec_size):
+ *                    np.ndarray[np.int_t] bin_result_vec, long out_vec_size):
  *     cdef int i
  *     cdef int m = bin_result_vec.shape[0]             # <<<<<<<<<<<<<<
  * 
  *     cdef np.ndarray[double] y_sum_bins = np.zeros(out_vec_size)
  */
   __pyx_v_m = (__pyx_v_bin_result_vec->dimensions[0]);
 
@@ -7080,27 +7071,27 @@
  *     for i in range(m):
  *         y_sum_bins[bin_result_vec[i]] += y_vec[i]             # <<<<<<<<<<<<<<
  *         count_in_bins[bin_result_vec[i]] += 1
  *     return y_sum_bins, count_in_bins
  */
     __pyx_t_10 = __pyx_v_i;
     __pyx_t_11 = __pyx_v_i;
-    __pyx_t_12 = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_14structure_rfdt_dtype_int64_t *, __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_bin_result_vec.diminfo[0].strides));
+    __pyx_t_12 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_bin_result_vec.diminfo[0].strides));
     *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_y_sum_bins.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_y_sum_bins.diminfo[0].strides) += (*__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_y_vec.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_y_vec.diminfo[0].strides));
 
     /* "structureboost/structure_rfdt.pyx":185
  *     for i in range(m):
  *         y_sum_bins[bin_result_vec[i]] += y_vec[i]
  *         count_in_bins[bin_result_vec[i]] += 1             # <<<<<<<<<<<<<<
  *     return y_sum_bins, count_in_bins
  * 
  */
     __pyx_t_10 = __pyx_v_i;
-    __pyx_t_12 = (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_14structure_rfdt_dtype_int64_t *, __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_bin_result_vec.diminfo[0].strides));
-    *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_count_in_bins.rcbuffer->pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_count_in_bins.diminfo[0].strides) += 1.0;
+    __pyx_t_11 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_bin_result_vec.diminfo[0].strides));
+    *__Pyx_BufPtrStrided1d(double *, __pyx_pybuffernd_count_in_bins.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_count_in_bins.diminfo[0].strides) += 1.0;
   }
 
   /* "structureboost/structure_rfdt.pyx":186
  *         y_sum_bins[bin_result_vec[i]] += y_vec[i]
  *         count_in_bins[bin_result_vec[i]] += 1
  *     return y_sum_bins, count_in_bins             # <<<<<<<<<<<<<<
  * 
@@ -7119,15 +7110,15 @@
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* "structureboost/structure_rfdt.pyx":175
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * def get_bin_sums_c_rfbin(np.ndarray[double] y_vec,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] bin_result_vec, long out_vec_size):
+ *                    np.ndarray[np.int_t] bin_result_vec, long out_vec_size):
  *     cdef int i
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
@@ -8713,15 +8704,15 @@
   return __pyx_r;
 }
 
 /* "structureboost/structure_rfdt.pyx":252
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
  * def _get_score_array_mse(np.ndarray[double] y_vec,             # <<<<<<<<<<<<<<
- *                         np.ndarray[dtype_int64_t] bin_result_vec,
+ *                         np.ndarray[np.int_t] bin_result_vec,
  *                         np.ndarray[double] ysl,
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_14structure_rfdt_9_get_score_array_mse(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_14structure_rfdt_9_get_score_array_mse = {"_get_score_array_mse", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_14structure_rfdt_9_get_score_array_mse, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_14structureboost_14structure_rfdt_9_get_score_array_mse(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
@@ -8941,15 +8932,15 @@
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_y_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_y_vec, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 252, __pyx_L1_error)
   }
   __pyx_pybuffernd_y_vec.diminfo[0].strides = __pyx_pybuffernd_y_vec.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_y_vec.diminfo[0].shape = __pyx_pybuffernd_y_vec.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_bin_result_vec, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_14structure_rfdt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 252, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_bin_result_vec, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 252, __pyx_L1_error)
   }
   __pyx_pybuffernd_bin_result_vec.diminfo[0].strides = __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_bin_result_vec.diminfo[0].shape = __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
     if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ysl.rcbuffer->pybuffer, (PyObject*)__pyx_v_ysl, &__Pyx_TypeInfo_double, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 252, __pyx_L1_error)
   }
   __pyx_pybuffernd_ysl.diminfo[0].strides = __pyx_pybuffernd_ysl.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_ysl.diminfo[0].shape = __pyx_pybuffernd_ysl.rcbuffer->pybuffer.shape[0];
@@ -9109,15 +9100,15 @@
  *         right_mean = ysr[i]/(cbr[i]+eps)
  *         for j in range(len(y_vec)):
  *             if bin_result_vec[j]<=i:             # <<<<<<<<<<<<<<
  *                 adj_y_vec[j] = y_vec[j] - left_mean
  *             else:
  */
       __pyx_t_10 = __pyx_v_j;
-      __pyx_t_15 = (((*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_14structure_rfdt_dtype_int64_t *, __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_bin_result_vec.diminfo[0].strides)) <= __pyx_v_i) != 0);
+      __pyx_t_15 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_bin_result_vec.rcbuffer->pybuffer.buf, __pyx_t_10, __pyx_pybuffernd_bin_result_vec.diminfo[0].strides)) <= __pyx_v_i) != 0);
       if (__pyx_t_15) {
 
         /* "structureboost/structure_rfdt.pyx":269
  *         for j in range(len(y_vec)):
  *             if bin_result_vec[j]<=i:
  *                 adj_y_vec[j] = y_vec[j] - left_mean             # <<<<<<<<<<<<<<
  *             else:
@@ -9200,15 +9191,15 @@
   __pyx_r = ((PyObject *)__pyx_v_score_vec);
   goto __pyx_L0;
 
   /* "structureboost/structure_rfdt.pyx":252
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
  * def _get_score_array_mse(np.ndarray[double] y_vec,             # <<<<<<<<<<<<<<
- *                         np.ndarray[dtype_int64_t] bin_result_vec,
+ *                         np.ndarray[np.int_t] bin_result_vec,
  *                         np.ndarray[double] ysl,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
@@ -9645,16 +9636,16 @@
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* "structureboost/structure_rfdt.pyx":314
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * def get_mask_int_c(np.ndarray[dtype_int64_t] feature_vec_node,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] left_split,
+ * def get_mask_int_c(np.ndarray[np.int_t] feature_vec_node,             # <<<<<<<<<<<<<<
+ *                    np.ndarray[np.int_t] left_split,
  *                    long vec_len, long lsplit_len,
  */
 
 /* Python wrapper */
 static PyObject *__pyx_pw_14structureboost_14structure_rfdt_15get_mask_int_c(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyMethodDef __pyx_mdef_14structureboost_14structure_rfdt_15get_mask_int_c = {"get_mask_int_c", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_14structureboost_14structure_rfdt_15get_mask_int_c, METH_VARARGS|METH_KEYWORDS, 0};
 static PyObject *__pyx_pw_14structureboost_14structure_rfdt_15get_mask_int_c(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
@@ -9799,30 +9790,30 @@
   __pyx_pybuffernd_left_split.rcbuffer = &__pyx_pybuffer_left_split;
   __pyx_pybuffer_mask_vec.pybuffer.buf = NULL;
   __pyx_pybuffer_mask_vec.refcount = 0;
   __pyx_pybuffernd_mask_vec.data = NULL;
   __pyx_pybuffernd_mask_vec.rcbuffer = &__pyx_pybuffer_mask_vec;
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer, (PyObject*)__pyx_v_feature_vec_node, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_14structure_rfdt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 314, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer, (PyObject*)__pyx_v_feature_vec_node, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 314, __pyx_L1_error)
   }
   __pyx_pybuffernd_feature_vec_node.diminfo[0].strides = __pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_feature_vec_node.diminfo[0].shape = __pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_left_split.rcbuffer->pybuffer, (PyObject*)__pyx_v_left_split, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_14structure_rfdt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 314, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_left_split.rcbuffer->pybuffer, (PyObject*)__pyx_v_left_split, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 314, __pyx_L1_error)
   }
   __pyx_pybuffernd_left_split.diminfo[0].strides = __pyx_pybuffernd_left_split.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_left_split.diminfo[0].shape = __pyx_pybuffernd_left_split.rcbuffer->pybuffer.shape[0];
   {
     __Pyx_BufFmt_StackElem __pyx_stack[1];
-    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_mask_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_mask_vec, &__Pyx_TypeInfo_nn___pyx_t_14structureboost_14structure_rfdt_dtype_int64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 314, __pyx_L1_error)
+    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_mask_vec.rcbuffer->pybuffer, (PyObject*)__pyx_v_mask_vec, &__Pyx_TypeInfo_nn___pyx_t_5numpy_int_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) __PYX_ERR(0, 314, __pyx_L1_error)
   }
   __pyx_pybuffernd_mask_vec.diminfo[0].strides = __pyx_pybuffernd_mask_vec.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_mask_vec.diminfo[0].shape = __pyx_pybuffernd_mask_vec.rcbuffer->pybuffer.shape[0];
 
   /* "structureboost/structure_rfdt.pyx":319
- *                    np.ndarray[dtype_int64_t] mask_vec):
+ *                    np.ndarray[np.int_t] mask_vec):
  *     cdef int i, j
  *     for i in range(vec_len):             # <<<<<<<<<<<<<<
  *         for j in range(lsplit_len):
  *             if feature_vec_node[i] == left_split[j]:
  */
   __pyx_t_1 = __pyx_v_vec_len;
   __pyx_t_2 = __pyx_t_1;
@@ -9846,26 +9837,26 @@
  *         for j in range(lsplit_len):
  *             if feature_vec_node[i] == left_split[j]:             # <<<<<<<<<<<<<<
  *                 mask_vec[i] = 1
  *                 break
  */
       __pyx_t_7 = __pyx_v_i;
       __pyx_t_8 = __pyx_v_j;
-      __pyx_t_9 = (((*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_14structure_rfdt_dtype_int64_t *, __pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_feature_vec_node.diminfo[0].strides)) == (*__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_14structure_rfdt_dtype_int64_t *, __pyx_pybuffernd_left_split.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_left_split.diminfo[0].strides))) != 0);
+      __pyx_t_9 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_feature_vec_node.rcbuffer->pybuffer.buf, __pyx_t_7, __pyx_pybuffernd_feature_vec_node.diminfo[0].strides)) == (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_left_split.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_left_split.diminfo[0].strides))) != 0);
       if (__pyx_t_9) {
 
         /* "structureboost/structure_rfdt.pyx":322
  *         for j in range(lsplit_len):
  *             if feature_vec_node[i] == left_split[j]:
  *                 mask_vec[i] = 1             # <<<<<<<<<<<<<<
  *                 break
  *     return mask_vec.astype(bool)
  */
         __pyx_t_8 = __pyx_v_i;
-        *__Pyx_BufPtrStrided1d(__pyx_t_14structureboost_14structure_rfdt_dtype_int64_t *, __pyx_pybuffernd_mask_vec.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_mask_vec.diminfo[0].strides) = 1;
+        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int_t *, __pyx_pybuffernd_mask_vec.rcbuffer->pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_mask_vec.diminfo[0].strides) = 1;
 
         /* "structureboost/structure_rfdt.pyx":323
  *             if feature_vec_node[i] == left_split[j]:
  *                 mask_vec[i] = 1
  *                 break             # <<<<<<<<<<<<<<
  *     return mask_vec.astype(bool)
  * 
@@ -9912,16 +9903,16 @@
   __pyx_r = __pyx_t_10;
   __pyx_t_10 = 0;
   goto __pyx_L0;
 
   /* "structureboost/structure_rfdt.pyx":314
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * def get_mask_int_c(np.ndarray[dtype_int64_t] feature_vec_node,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] left_split,
+ * def get_mask_int_c(np.ndarray[np.int_t] feature_vec_node,             # <<<<<<<<<<<<<<
+ *                    np.ndarray[np.int_t] left_split,
  *                    long vec_len, long lsplit_len,
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_10);
   __Pyx_XDECREF(__pyx_t_11);
@@ -11596,15 +11587,15 @@
   {&__pyx_n_u_graphical_voronoi, __pyx_k_graphical_voronoi, sizeof(__pyx_k_graphical_voronoi), 0, 1, 0, 1},
   {&__pyx_n_s_graphs, __pyx_k_graphs, sizeof(__pyx_k_graphs), 0, 0, 1, 1},
   {&__pyx_n_s_has_na_vals, __pyx_k_has_na_vals, sizeof(__pyx_k_has_na_vals), 0, 0, 1, 1},
   {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
   {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
   {&__pyx_n_s_inf, __pyx_k_inf, sizeof(__pyx_k_inf), 0, 0, 1, 1},
   {&__pyx_n_s_init, __pyx_k_init, sizeof(__pyx_k_init), 0, 0, 1, 1},
-  {&__pyx_n_s_int64, __pyx_k_int64, sizeof(__pyx_k_int64), 0, 0, 1, 1},
+  {&__pyx_n_s_int, __pyx_k_int, sizeof(__pyx_k_int), 0, 0, 1, 1},
   {&__pyx_n_s_isnan, __pyx_k_isnan, sizeof(__pyx_k_isnan), 0, 0, 1, 1},
   {&__pyx_n_s_j, __pyx_k_j, sizeof(__pyx_k_j), 0, 0, 1, 1},
   {&__pyx_n_s_leaf_vertex_ind, __pyx_k_leaf_vertex_ind, sizeof(__pyx_k_leaf_vertex_ind), 0, 0, 1, 1},
   {&__pyx_n_s_left_feat_values, __pyx_k_left_feat_values, sizeof(__pyx_k_left_feat_values), 0, 0, 1, 1},
   {&__pyx_n_s_left_mean, __pyx_k_left_mean, sizeof(__pyx_k_left_mean), 0, 0, 1, 1},
   {&__pyx_n_s_left_split, __pyx_k_left_split, sizeof(__pyx_k_left_split), 0, 0, 1, 1},
   {&__pyx_n_s_log, __pyx_k_log, sizeof(__pyx_k_log), 0, 0, 1, 1},
@@ -11840,15 +11831,15 @@
   __Pyx_GIVEREF(__pyx_tuple__29);
   __pyx_codeobj__10 = (PyObject*)__Pyx_PyCode_New(4, 0, 8, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_rfdt_pyx, __pyx_n_s_get_score_of_split, 155, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__10)) __PYX_ERR(0, 155, __pyx_L1_error)
 
   /* "structureboost/structure_rfdt.pyx":175
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * def get_bin_sums_c_rfbin(np.ndarray[double] y_vec,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] bin_result_vec, long out_vec_size):
+ *                    np.ndarray[np.int_t] bin_result_vec, long out_vec_size):
  *     cdef int i
  */
   __pyx_tuple__30 = PyTuple_Pack(7, __pyx_n_s_y_vec, __pyx_n_s_bin_result_vec, __pyx_n_s_out_vec_size, __pyx_n_s_i, __pyx_n_s_m, __pyx_n_s_y_sum_bins, __pyx_n_s_count_in_bins); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 175, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__30);
   __Pyx_GIVEREF(__pyx_tuple__30);
   __pyx_codeobj__11 = (PyObject*)__Pyx_PyCode_New(3, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__30, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_rfdt_pyx, __pyx_n_s_get_bin_sums_c_rfbin, 175, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 175, __pyx_L1_error)
 
@@ -11888,15 +11879,15 @@
   __Pyx_GIVEREF(__pyx_tuple__33);
   __pyx_codeobj__14 = (PyObject*)__Pyx_PyCode_New(6, 0, 14, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_rfdt_pyx, __pyx_n_s_get_score_binary_entropy, 225, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__14)) __PYX_ERR(0, 225, __pyx_L1_error)
 
   /* "structureboost/structure_rfdt.pyx":252
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
  * def _get_score_array_mse(np.ndarray[double] y_vec,             # <<<<<<<<<<<<<<
- *                         np.ndarray[dtype_int64_t] bin_result_vec,
+ *                         np.ndarray[np.int_t] bin_result_vec,
  *                         np.ndarray[double] ysl,
  */
   __pyx_tuple__34 = PyTuple_Pack(13, __pyx_n_s_y_vec, __pyx_n_s_bin_result_vec, __pyx_n_s_ysl, __pyx_n_s_ysr, __pyx_n_s_cbl, __pyx_n_s_cbr, __pyx_n_s_eps, __pyx_n_s_score_vec, __pyx_n_s_adj_y_vec, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_left_mean, __pyx_n_s_right_mean); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 252, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__34);
   __Pyx_GIVEREF(__pyx_tuple__34);
   __pyx_codeobj__15 = (PyObject*)__Pyx_PyCode_New(7, 0, 13, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__34, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_rfdt_pyx, __pyx_n_s_get_score_array_mse, 252, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__15)) __PYX_ERR(0, 252, __pyx_L1_error)
 
@@ -11923,16 +11914,16 @@
   __Pyx_GOTREF(__pyx_tuple__36);
   __Pyx_GIVEREF(__pyx_tuple__36);
   __pyx_codeobj__17 = (PyObject*)__Pyx_PyCode_New(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__36, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_rfdt_pyx, __pyx_n_s_get_mask, 309, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__17)) __PYX_ERR(0, 309, __pyx_L1_error)
 
   /* "structureboost/structure_rfdt.pyx":314
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * def get_mask_int_c(np.ndarray[dtype_int64_t] feature_vec_node,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] left_split,
+ * def get_mask_int_c(np.ndarray[np.int_t] feature_vec_node,             # <<<<<<<<<<<<<<
+ *                    np.ndarray[np.int_t] left_split,
  *                    long vec_len, long lsplit_len,
  */
   __pyx_tuple__37 = PyTuple_Pack(7, __pyx_n_s_feature_vec_node, __pyx_n_s_left_split, __pyx_n_s_vec_len, __pyx_n_s_lsplit_len, __pyx_n_s_mask_vec, __pyx_n_s_i, __pyx_n_s_j); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 314, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__37);
   __Pyx_GIVEREF(__pyx_tuple__37);
   __pyx_codeobj__18 = (PyObject*)__Pyx_PyCode_New(5, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__37, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_structure_rfdt_pyx, __pyx_n_s_get_mask_int_c, 314, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__18)) __PYX_ERR(0, 314, __pyx_L1_error)
 
@@ -12393,15 +12384,15 @@
   __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_StructureDecisionTree); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 12, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_StructureDecisionTree, __pyx_t_1) < 0) __PYX_ERR(0, 12, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
   /* "structureboost/structure_rfdt.pyx":20
- * ctypedef np.int64_t dtype_int64_t
+ * # ctypedef np.int64_t dtype_int64_t
  * 
  * class StructureRFDecisionTree(StructureDecisionTree):             # <<<<<<<<<<<<<<
  *     """Decision Tree using graphical structure: variant for Random Forest
  *     """
  */
   __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_StructureDecisionTree); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 20, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
@@ -12502,15 +12493,15 @@
  */
   __pyx_t_5 = __Pyx_CyFunction_New(&__pyx_mdef_14structureboost_14structure_rfdt_23StructureRFDecisionTree_13get_score_of_split, 0, __pyx_n_s_StructureRFDecisionTree_get_scor, NULL, __pyx_n_s_structureboost_structure_rfdt, __pyx_d, ((PyObject *)__pyx_codeobj__10)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 155, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   if (__Pyx_SetNameInClass(__pyx_t_3, __pyx_n_s_get_score_of_split, __pyx_t_5) < 0) __PYX_ERR(0, 155, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
   /* "structureboost/structure_rfdt.pyx":20
- * ctypedef np.int64_t dtype_int64_t
+ * # ctypedef np.int64_t dtype_int64_t
  * 
  * class StructureRFDecisionTree(StructureDecisionTree):             # <<<<<<<<<<<<<<
  *     """Decision Tree using graphical structure: variant for Random Forest
  *     """
  */
   __pyx_t_5 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_StructureRFDecisionTree, __pyx_t_1, __pyx_t_3, NULL, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 20, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
@@ -12522,15 +12513,15 @@
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "structureboost/structure_rfdt.pyx":175
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
  * def get_bin_sums_c_rfbin(np.ndarray[double] y_vec,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] bin_result_vec, long out_vec_size):
+ *                    np.ndarray[np.int_t] bin_result_vec, long out_vec_size):
  *     cdef int i
  */
   __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_14structure_rfdt_1get_bin_sums_c_rfbin, NULL, __pyx_n_s_structureboost_structure_rfdt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 175, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_bin_sums_c_rfbin, __pyx_t_1) < 0) __PYX_ERR(0, 175, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
@@ -12570,15 +12561,15 @@
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_score_binary_entropy, __pyx_t_1) < 0) __PYX_ERR(0, 225, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "structureboost/structure_rfdt.pyx":252
  * @cython.nonecheck(False)
  * @cython.cdivision(True)
  * def _get_score_array_mse(np.ndarray[double] y_vec,             # <<<<<<<<<<<<<<
- *                         np.ndarray[dtype_int64_t] bin_result_vec,
+ *                         np.ndarray[np.int_t] bin_result_vec,
  *                         np.ndarray[double] ysl,
  */
   __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_14structure_rfdt_9_get_score_array_mse, NULL, __pyx_n_s_structureboost_structure_rfdt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 252, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_score_array_mse, __pyx_t_1) < 0) __PYX_ERR(0, 252, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
@@ -12605,16 +12596,16 @@
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_mask, __pyx_t_1) < 0) __PYX_ERR(0, 309, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
   /* "structureboost/structure_rfdt.pyx":314
  * @cython.boundscheck(False)  # Deactivate bounds checking
  * @cython.wraparound(False)   # Deactivate negative indexing.
- * def get_mask_int_c(np.ndarray[dtype_int64_t] feature_vec_node,             # <<<<<<<<<<<<<<
- *                    np.ndarray[dtype_int64_t] left_split,
+ * def get_mask_int_c(np.ndarray[np.int_t] feature_vec_node,             # <<<<<<<<<<<<<<
+ *                    np.ndarray[np.int_t] left_split,
  *                    long vec_len, long lsplit_len,
  */
   __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_14structureboost_14structure_rfdt_15get_mask_int_c, NULL, __pyx_n_s_structureboost_structure_rfdt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 314, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (PyDict_SetItem(__pyx_d, __pyx_n_s_get_mask_int_c, __pyx_t_1) < 0) __PYX_ERR(0, 314, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
```

### Comparing `structureboost-0.4.0/structureboost/utils.py` & `structureboost-0.4.1/structureboost/utils.py`

 * *Files identical despite different names*

### Comparing `structureboost-0.4.0/structureboost.egg-info/PKG-INFO` & `structureboost-0.4.1/structureboost.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: structureboost
-Version: 0.4.0
+Version: 0.4.1
 Summary: StructureBoost is a Python package for gradient boosting using categorical structure.  See documentation at: https://structureboost.readthedocs.io/
 Home-page: https://github.com/numeristical/structureboost
 Author: Brian Lucena
 Author-email: brianlucena@gmail.com
 License: MIT
 Platform: UNKNOWN
 Classifier: Development Status :: 2 - Pre-Alpha
```

### Comparing `structureboost-0.4.0/structureboost.egg-info/SOURCES.txt` & `structureboost-0.4.1/structureboost.egg-info/SOURCES.txt`

 * *Files identical despite different names*

