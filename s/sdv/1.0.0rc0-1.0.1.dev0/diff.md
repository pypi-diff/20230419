# Comparing `tmp/sdv-1.0.0rc0.tar.gz` & `tmp/sdv-1.0.1.dev0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "sdv-1.0.0rc0.tar", last modified: Tue Mar 28 14:08:32 2023, max compression
+gzip compressed data, was "sdv-1.0.1.dev0.tar", last modified: Wed Apr 19 17:34:10 2023, max compression
```

## Comparing `sdv-1.0.0rc0.tar` & `sdv-1.0.1.dev0.tar`

### file list

```diff
@@ -1,649 +1,651 @@
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.338435 sdv-1.0.0rc0/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       56 2023-01-24 21:06:49.000000 sdv-1.0.0rc0/AUTHORS.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     8268 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/CONTRIBUTING.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    42115 2023-03-28 14:06:39.000000 sdv-1.0.0rc0/HISTORY.md
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     4818 2023-01-24 21:06:49.000000 sdv-1.0.0rc0/LICENSE
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      245 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/MANIFEST.in
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    52949 2023-03-28 14:08:32.338587 sdv-1.0.0rc0/PKG-INFO
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     9801 2023-03-28 14:06:39.000000 sdv-1.0.0rc0/README.md
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.200735 sdv-1.0.0rc0/docs/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      604 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/Makefile
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.201841 sdv-1.0.0rc0/docs/api_reference/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.202574 sdv-1.0.0rc0/docs/api_reference/constraints/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.224315 sdv-1.0.0rc0/docs/api_reference/constraints/api/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Constraint.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Constraint.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Constraint.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Constraint.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Constraint.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Constraint.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      575 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Constraint.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Constraint.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Constraint.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      179 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      653 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      173 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      197 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      666 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Inequality.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Inequality.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Inequality.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Inequality.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Inequality.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Inequality.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      575 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Inequality.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Inequality.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Inequality.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Negative.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Negative.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      158 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Negative.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Negative.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      143 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Negative.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Negative.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      549 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Negative.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Negative.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Negative.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      173 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      627 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      158 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Positive.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Positive.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      158 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Positive.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Positive.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      143 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Positive.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Positive.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      549 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Positive.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Positive.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Positive.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Range.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      117 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Range.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Range.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      137 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Range.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      134 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Range.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Range.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      510 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Range.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      131 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Range.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Range.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      179 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      653 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      179 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      588 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Unique.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      120 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Unique.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Unique.fit_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Unique.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      137 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Unique.is_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Unique.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      523 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Unique.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      134 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Unique.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      138 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Unique.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      359 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/constraints/base.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      124 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/constraints/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2609 2022-07-22 02:55:50.000000 sdv-1.0.0rc0/docs/api_reference/constraints/tabular.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      353 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/demo.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/evaluation.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      347 2022-07-22 02:55:50.000000 sdv-1.0.0rc0/docs/api_reference/index.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.224828 sdv-1.0.0rc0/docs/api_reference/lite/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.226919 sdv-1.0.0rc0/docs/api_reference/lite/api/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      205 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.list_available_presets.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      147 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.load.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      502 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.sample.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.sample_conditions.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      211 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.sample_remaining_columns.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      147 2022-06-29 17:31:16.000000 sdv-1.0.0rc0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.save.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       94 2022-07-22 02:55:50.000000 sdv-1.0.0rc0/docs/api_reference/lite/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      348 2022-07-22 02:55:50.000000 sdv-1.0.0rc0/docs/api_reference/lite/tabular.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.227688 sdv-1.0.0rc0/docs/api_reference/metadata/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.235782 sdv-1.0.0rc0/docs/api_reference/metadata/api/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.add_field.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.add_relationship.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.add_table.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_children.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_dtypes.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      178 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_field_meta.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_fields.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      184 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_foreign_keys.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_parents.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      181 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_primary_key.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      178 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_table_meta.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_tables.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.load_table.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.load_tables.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      877 2022-09-29 22:36:12.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      181 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.set_primary_key.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.to_json.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.validate.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.visualize.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.table.Table.filter_valid.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.table.Table.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.table.Table.from_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.table.Table.from_json.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.table.Table.get_dtypes.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.table.Table.get_fields.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      169 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.table.Table.get_model_kwargs.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.table.Table.reverse_transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      668 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.table.Table.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      169 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.table.Table.set_model_kwargs.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      166 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.table.Table.set_primary_key.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.table.Table.to_dict.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.table.Table.to_json.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.table.Table.transform.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      854 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/metadata/dataset.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      116 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/metadata/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      583 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/metadata/table.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.236961 sdv-1.0.0rc0/docs/api_reference/metrics/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.273338 sdv-1.0.0rc0/docs/api_reference/metrics/api/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.demos.load_multi_table_demo.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.demos.load_single_table_demo.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.demos.load_timeseries_demo.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLikelihood.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLikelihood.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      578 2022-08-30 22:45:23.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLikelihood.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      180 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLogLikelihood.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      203 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLogLikelihood.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      614 2022-08-30 22:45:23.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLogLikelihood.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.CSTest.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.CSTest.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      506 2022-08-30 22:45:24.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.CSTest.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      203 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.DetectionMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      573 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.DetectionMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-08-30 23:02:40.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.KSComplement.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-08-30 23:02:40.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.KSComplement.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      578 2022-08-30 23:02:40.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.KSComplement.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      165 2022-08-30 23:02:15.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.KSTest.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-08-30 23:02:15.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.KSTest.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      534 2022-08-30 23:02:15.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.KSTest.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      186 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticDetection.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      209 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticDetection.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      638 2022-08-30 22:45:24.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticDetection.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      219 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticParentChildDetection.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      242 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticParentChildDetection.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      716 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticParentChildDetection.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      224 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiSingleTableMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      598 2022-08-30 22:45:24.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiSingleTableMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      206 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiTableMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      584 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiTableMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      236 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.ParentChildDetectionMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      582 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.ParentChildDetectionMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCDetection.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCDetection.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      578 2022-08-30 22:45:24.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCDetection.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      204 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCParentChildDetection.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      227 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCParentChildDetection.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      661 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCParentChildDetection.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLikelihood.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLikelihood.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      569 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLikelihood.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLogLikelihood.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLogLikelihood.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      605 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLogLikelihood.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      198 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryAdaBoostClassifier.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      221 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryAdaBoostClassifier.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      837 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryAdaBoostClassifier.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      210 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryDecisionTreeClassifier.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      233 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryDecisionTreeClassifier.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      897 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryDecisionTreeClassifier.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      209 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryEfficacyMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      811 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryEfficacyMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      198 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryLogisticRegression.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      221 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryLogisticRegression.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      837 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryLogisticRegression.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      183 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryMLPClassifier.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      206 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryMLPClassifier.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      762 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryMLPClassifier.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CSTest.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CSTest.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      565 2022-08-30 22:45:24.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CSTest.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalCAP.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalCAP.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      664 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalCAP.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      183 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalEnsemble.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      206 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalEnsemble.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      734 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalEnsemble.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      201 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalGeneralizedCAP.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      224 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalGeneralizedCAP.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      818 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalGeneralizedCAP.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalKNN.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalKNN.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      664 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalKNN.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      165 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalNB.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalNB.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      650 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalNB.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      221 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalPrivacyMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      842 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalPrivacyMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      165 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalRF.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalRF.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      650 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalRF.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalSVM.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalSVM.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      664 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalSVM.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      180 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalZeroCAP.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      203 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalZeroCAP.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      720 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalZeroCAP.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      192 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.ContinuousKLDivergence.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      215 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.ContinuousKLDivergence.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      788 2022-10-05 00:20:25.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.ContinuousKLDivergence.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.DetectionMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      605 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.DetectionMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      186 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.DiscreteKLDivergence.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      209 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.DiscreteKLDivergence.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      760 2022-10-05 00:20:25.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.DiscreteKLDivergence.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.GMLogLikelihood.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.GMLogLikelihood.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      605 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.GMLogLikelihood.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-08-30 23:02:40.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSComplement.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-08-30 23:02:40.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSComplement.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      649 2022-08-30 23:02:40.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSComplement.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-08-30 23:02:15.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSTest.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      179 2022-08-30 23:02:15.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSTest.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      605 2022-08-30 23:02:15.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSTest.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      174 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.LinearRegression.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      197 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.LinearRegression.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      717 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.LinearRegression.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      177 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.LogisticDetection.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      200 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.LogisticDetection.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      629 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.LogisticDetection.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      197 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLEfficacyMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      716 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLEfficacyMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLPRegressor.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLPRegressor.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      657 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLPRegressor.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      215 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiColumnPairsMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      688 2022-10-05 00:20:25.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiColumnPairsMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      218 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiSingleColumnMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      701 2022-08-30 22:45:24.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiSingleColumnMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      222 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassDecisionTreeClassifier.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      245 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassDecisionTreeClassifier.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      957 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassDecisionTreeClassifier.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      875 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassEfficacyMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      195 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassMLPClassifier.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      218 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassMLPClassifier.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      822 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassMLPClassifier.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalLR.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalLR.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      629 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalLR.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalMLP.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalMLP.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      643 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalMLP.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      215 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalPrivacyMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      819 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalPrivacyMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      216 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalRadiusNearestNeighbor.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      239 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalRadiusNearestNeighbor.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      895 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalRadiusNearestNeighbor.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalSVR.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalSVR.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      643 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalSVR.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      875 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.RegressionEfficacyMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.SVCDetection.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.SVCDetection.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      569 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.SVCDetection.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      257 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.ScikitLearnClassifierDetectionMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      857 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.ScikitLearnClassifierDetectionMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      200 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.SingleTableMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      629 2022-12-08 22:56:17.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.SingleTableMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      201 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMClassifierEfficacy.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      224 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMClassifierEfficacy.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      650 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMClassifierEfficacy.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      174 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMDetection.compute.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      197 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMDetection.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      551 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMDetection.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      233 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesDetectionMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      683 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesDetectionMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      230 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesEfficacyMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      672 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesEfficacyMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      206 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesMetric.get_subclasses.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      584 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesMetric.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      213 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/metrics/demos.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      143 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/metrics/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1402 2022-09-22 23:47:45.000000 sdv-1.0.0rc0/docs/api_reference/metrics/relational.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     4109 2022-09-22 23:47:45.000000 sdv-1.0.0rc0/docs/api_reference/metrics/tabular.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      735 2022-12-21 22:30:23.000000 sdv-1.0.0rc0/docs/api_reference/metrics/timeseries.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.273780 sdv-1.0.0rc0/docs/api_reference/relational/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.275121 sdv-1.0.0rc0/docs/api_reference/relational/api/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      123 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.load.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      416 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.sample.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.save.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      173 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/relational/hma1.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      109 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/relational/index.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.275565 sdv-1.0.0rc0/docs/api_reference/sampling/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.276240 sdv-1.0.0rc0/docs/api_reference/sampling/api/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      166 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/sampling/api/sdv.sampling.Condition.get_column_values.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      151 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/sampling/api/sdv.sampling.Condition.get_num_rows.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      417 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/sampling/api/sdv.sampling.Condition.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      109 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/sampling/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      227 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/sampling/tabular.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/sdv.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.277331 sdv-1.0.0rc0/docs/api_reference/tabular/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.284928 sdv-1.0.0rc0/docs/api_reference/tabular/api/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      147 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.get_distributions.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.get_metadata.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.load.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      655 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.sample.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.sample_conditions.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      214 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.sample_remaining_columns.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.save.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      200 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.get_distributions.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.get_likelihood.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.get_metadata.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.get_parameters.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.load.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      663 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      165 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.sample.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      200 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.sample_conditions.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      223 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.sample_remaining_columns.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.save.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.set_parameters.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      123 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.get_metadata.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.load.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      463 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.sample.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.sample_conditions.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      190 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.sample_remaining_columns.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.save.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      120 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.get_metadata.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      123 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.load.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      450 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      129 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.sample.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.sample_conditions.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      187 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.sample_remaining_columns.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      123 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.save.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      339 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/tabular/copulagan.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      489 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/tabular/copulas.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      260 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/tabular/ctgan.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      136 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/tabular/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      249 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/tabular/tvae.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.285475 sdv-1.0.0rc0/docs/api_reference/timeseries/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.286831 sdv-1.0.0rc0/docs/api_reference/timeseries/api/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.fit.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.get_metadata.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      138 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.load.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      338 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.sample.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      138 2022-06-22 20:44:18.000000 sdv-1.0.0rc0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.save.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      108 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/timeseries/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      190 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/api_reference/timeseries/par.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     6934 2023-03-23 18:08:51.000000 sdv-1.0.0rc0/docs/conf.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.287458 sdv-1.0.0rc0/docs/developer_guides/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     8771 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/developer_guides/contributing.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      364 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/developer_guides/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2905 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/developer_guides/overview.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.288463 sdv-1.0.0rc0/docs/developer_guides/sdv/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     5889 2022-07-22 02:55:50.000000 sdv-1.0.0rc0/docs/developer_guides/sdv/constraints.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      292 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/developer_guides/sdv/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     7480 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/developer_guides/sdv/metadata.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     9508 2023-02-02 20:58:41.000000 sdv-1.0.0rc0/docs/developer_guides/sdv/tabular.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.289245 sdv-1.0.0rc0/docs/getting_started/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      113 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/getting_started/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2557 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/getting_started/install.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     3664 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/getting_started/quickstart.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       29 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/history.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.300569 sdv-1.0.0rc0/docs/images/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    52078 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/images/CTGAN-DataCebo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    50900 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/images/Copulas-DataCebo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    60600 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/images/DataCebo-Blue.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    46250 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/images/DeepEcho-DataCebo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    25573 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/images/RDT-DataCebo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)   243101 2023-03-28 14:06:39.000000 sdv-1.0.0rc0/docs/images/Real-vs-Synthetic-Evaluation.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    27285 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/images/SDGym-DataCebo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    35670 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/images/SDMetrics-DataCebo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    22394 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/images/SDV-DataCebo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    64162 2023-03-28 14:06:39.000000 sdv-1.0.0rc0/docs/images/SDV-logo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     8765 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/images/SDV.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)   412158 2023-03-28 14:06:39.000000 sdv-1.0.0rc0/docs/images/Single-Table-Metadata-Example.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    99815 2022-07-22 02:55:50.000000 sdv-1.0.0rc0/docs/images/custom_constraint.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    50140 2023-03-28 14:06:39.000000 sdv-1.0.0rc0/docs/images/datacebo-logo-dark-mode.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    50481 2023-03-28 14:06:39.000000 sdv-1.0.0rc0/docs/images/datacebo-logo.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      547 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/images/google_colab.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    67403 2022-12-08 23:36:42.000000 sdv-1.0.0rc0/docs/images/hma1_1.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     8748 2022-12-08 23:36:42.000000 sdv-1.0.0rc0/docs/images/metadata_1.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    67425 2022-12-08 23:36:42.000000 sdv-1.0.0rc0/docs/images/metadata_2.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2497 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/images/mybinder.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    67403 2022-12-08 23:36:42.000000 sdv-1.0.0rc0/docs/images/quickstart_1.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)   176980 2023-01-24 21:06:49.000000 sdv-1.0.0rc0/docs/images/rdt_main_tranformation.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2283 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/images/slack.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     6075 2023-03-23 18:08:51.000000 sdv-1.0.0rc0/docs/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      765 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/make.bat
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.302080 sdv-1.0.0rc0/docs/savefig/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10974 2022-12-08 23:00:09.000000 sdv-1.0.0rc0/docs/savefig/copulagan_experience_years_1.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    12668 2022-12-08 23:00:10.000000 sdv-1.0.0rc0/docs/savefig/copulagan_experience_years_2.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10277 2022-12-08 23:00:37.000000 sdv-1.0.0rc0/docs/savefig/copulagan_experience_years_3.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10974 2022-12-08 23:05:15.000000 sdv-1.0.0rc0/docs/savefig/experience_years_1.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10270 2022-12-08 23:05:16.000000 sdv-1.0.0rc0/docs/savefig/experience_years_2.png
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    12415 2022-12-08 23:05:16.000000 sdv-1.0.0rc0/docs/savefig/experience_years_3.png
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.193759 sdv-1.0.0rc0/docs/sdv_theme/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.302347 sdv-1.0.0rc0/docs/sdv_theme/static/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1046 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/sdv_theme/static/slack-32.png
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.302572 sdv-1.0.0rc0/docs/user_guides/
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.304180 sdv-1.0.0rc0/docs/user_guides/benchmarking/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     4753 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/benchmarking/datasets.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1885 2023-02-02 20:58:41.000000 sdv-1.0.0rc0/docs/user_guides/benchmarking/docker.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      563 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/benchmarking/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2562 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/benchmarking/install.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     7764 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/benchmarking/run.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1731 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/benchmarking/synthesizers.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.305097 sdv-1.0.0rc0/docs/user_guides/evaluation/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     3240 2022-12-21 22:30:23.000000 sdv-1.0.0rc0/docs/user_guides/evaluation/evaluation_framework.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      504 2022-12-21 22:30:23.000000 sdv-1.0.0rc0/docs/user_guides/evaluation/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      219 2022-12-21 22:30:23.000000 sdv-1.0.0rc0/docs/user_guides/evaluation/synthetic_data_metrics.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      277 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/index.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.306314 sdv-1.0.0rc0/docs/user_guides/relational/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2131 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/relational/constraints.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      141 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/relational/data_description.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     8143 2022-12-21 22:30:23.000000 sdv-1.0.0rc0/docs/user_guides/relational/hma1.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      177 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/relational/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       79 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/relational/models.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     6906 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/relational/relational_metadata.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.310116 sdv-1.0.0rc0/docs/user_guides/single_table/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/single_table/constraints.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    24765 2023-02-02 20:58:41.000000 sdv-1.0.0rc0/docs/user_guides/single_table/copulagan.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    18899 2023-02-02 20:58:41.000000 sdv-1.0.0rc0/docs/user_guides/single_table/ctgan.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     6108 2022-09-22 23:47:45.000000 sdv-1.0.0rc0/docs/user_guides/single_table/custom_constraints.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      121 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/single_table/data_description.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    20259 2023-02-02 20:58:41.000000 sdv-1.0.0rc0/docs/user_guides/single_table/gaussian_copula.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    14530 2022-09-22 23:47:45.000000 sdv-1.0.0rc0/docs/user_guides/single_table/handling_constraints.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      980 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/single_table/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      510 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/single_table/models.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       65 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/single_table/table_metadata.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     8354 2022-07-22 02:55:50.000000 sdv-1.0.0rc0/docs/user_guides/single_table/tabular_preset.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    18149 2023-02-02 20:58:41.000000 sdv-1.0.0rc0/docs/user_guides/single_table/tvae.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.310703 sdv-1.0.0rc0/docs/user_guides/timeseries/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       92 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/timeseries/index.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       78 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/docs/user_guides/timeseries/models.rst
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    14863 2022-12-21 22:30:23.000000 sdv-1.0.0rc0/docs/user_guides/timeseries/par.rst
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.311534 sdv-1.0.0rc0/sdv/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      292 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/__init__.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.314186 sdv-1.0.0rc0/sdv/constraints/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      543 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/constraints/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    17970 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/constraints/base.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      799 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/constraints/errors.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    50472 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/constraints/tabular.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     3014 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/constraints/utils.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.315650 sdv-1.0.0rc0/sdv/data_processing/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/data_processing/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    33612 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/sdv/data_processing/data_processor.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1313 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/data_processing/datetime_formatter.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      522 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/data_processing/errors.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     4010 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/data_processing/numerical_formatter.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      726 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/data_processing/utils.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.316269 sdv-1.0.0rc0/sdv/datasets/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       43 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/datasets/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     6625 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/sdv/datasets/demo.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1117 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/datasets/local.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      694 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/errors.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.316977 sdv-1.0.0rc0/sdv/evaluation/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       49 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/evaluation/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     3701 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/evaluation/multi_table.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     3239 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/evaluation/single_table.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.317502 sdv-1.0.0rc0/sdv/lite/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      145 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/lite/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     6940 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/lite/single_table.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.319446 sdv-1.0.0rc0/sdv/metadata/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      400 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/metadata/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2624 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/metadata/anonymization.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      238 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/metadata/errors.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10362 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/sdv/metadata/metadata_upgrader.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    28381 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/metadata/multi_table.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    21754 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/sdv/metadata/single_table.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      793 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/metadata/utils.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2447 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/metadata/visualization.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.320745 sdv-1.0.0rc0/sdv/metrics/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      252 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/sdv/metrics/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/sdv/metrics/demos.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/sdv/metrics/relational.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      186 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/sdv/metrics/tabular.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/sdv/metrics/timeseries.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.321332 sdv-1.0.0rc0/sdv/multi_table/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/multi_table/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    19017 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/multi_table/base.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    21831 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/multi_table/hma.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.321882 sdv-1.0.0rc0/sdv/sampling/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      103 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/sdv/sampling/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      913 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/sdv/sampling/tabular.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.322234 sdv-1.0.0rc0/sdv/sequential/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      124 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/sequential/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    14676 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/sequential/par.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.323691 sdv-1.0.0rc0/sdv/single_table/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      358 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/single_table/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    44103 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/single_table/base.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10977 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/single_table/copulagan.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    14718 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/single_table/copulas.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     9725 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/single_table/ctgan.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      341 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/single_table/errors.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10141 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/single_table/utils.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     4279 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/sdv/utils.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.312543 sdv-1.0.0rc0/sdv.egg-info/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    52949 2023-03-28 14:08:32.000000 sdv-1.0.0rc0/sdv.egg-info/PKG-INFO
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    35433 2023-03-28 14:08:32.000000 sdv-1.0.0rc0/sdv.egg-info/SOURCES.txt
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        1 2023-03-28 14:08:32.000000 sdv-1.0.0rc0/sdv.egg-info/dependency_links.txt
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        1 2023-03-28 14:08:32.000000 sdv-1.0.0rc0/sdv.egg-info/not-zip-safe
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1483 2023-03-28 14:08:32.000000 sdv-1.0.0rc0/sdv.egg-info/requires.txt
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        4 2023-03-28 14:08:32.000000 sdv-1.0.0rc0/sdv.egg-info/top_level.txt
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1233 2023-03-28 14:08:32.339140 sdv-1.0.0rc0/setup.cfg
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     3855 2023-03-28 14:06:39.000000 sdv-1.0.0rc0/setup.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.324021 sdv-1.0.0rc0/tests/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/tests/__init__.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.324419 sdv-1.0.0rc0/tests/integration/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/tests/integration/__init__.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.324609 sdv-1.0.0rc0/tests/integration/data_processing/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    11659 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/integration/data_processing/test_data_processor.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      598 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/integration/dataset.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.324920 sdv-1.0.0rc0/tests/integration/datasets/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/integration/datasets/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     3324 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/integration/datasets/test_demo.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.325408 sdv-1.0.0rc0/tests/integration/evaluation/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/integration/evaluation/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1133 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/integration/evaluation/test_multi_table.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1131 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/integration/evaluation/test_single_table.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.325734 sdv-1.0.0rc0/tests/integration/lite/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-07-22 02:55:50.000000 sdv-1.0.0rc0/tests/integration/lite/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1447 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/integration/lite/test_single_table.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.326282 sdv-1.0.0rc0/tests/integration/metadata/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/integration/metadata/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     4369 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/integration/metadata/test_multi_table.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     6200 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/integration/metadata/test_single_table.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.326607 sdv-1.0.0rc0/tests/integration/multi_table/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/integration/multi_table/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    20856 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/integration/multi_table/test_hma.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.326985 sdv-1.0.0rc0/tests/integration/sequential/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/integration/sequential/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     6268 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/integration/sequential/test_par.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.328197 sdv-1.0.0rc0/tests/integration/single_table/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/integration/single_table/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1769 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/integration/single_table/custom_constraints.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    24591 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/integration/single_table/test_base.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     9991 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/integration/single_table/test_copulas.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2528 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/integration/single_table/test_ctgan.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.328473 sdv-1.0.0rc0/tests/readme_test/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    13973 2022-08-16 22:57:14.000000 sdv-1.0.0rc0/tests/readme_test/README.md
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.328776 sdv-1.0.0rc0/tests/unit/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/tests/unit/__init__.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.329773 sdv-1.0.0rc0/tests/unit/constraints/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/tests/unit/constraints/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    32115 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/constraints/test_base.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)   163645 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/unit/constraints/test_tabular.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     8458 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/constraints/test_utils.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.331991 sdv-1.0.0rc0/tests/unit/data_processing/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/data_processing/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    81545 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/unit/data_processing/test_data_processor.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     1931 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/data_processing/test_datetime_formatter.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    14718 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/data_processing/test_numerical_formatter.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)      926 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/data_processing/test_utils.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.332478 sdv-1.0.0rc0/tests/unit/datasets/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/datasets/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     9876 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/unit/datasets/test_demo.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2498 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/datasets/test_local.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.332874 sdv-1.0.0rc0/tests/unit/evaluation/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2865 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/evaluation/test_multi_table.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2533 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/evaluation/test_single_table.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.333178 sdv-1.0.0rc0/tests/unit/lite/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/tests/unit/lite/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     9295 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/lite/test_single_table.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.334539 sdv-1.0.0rc0/tests/unit/metadata/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/tests/unit/metadata/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     4338 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/metadata/test_anonymization.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    22557 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/unit/metadata/test_metadata_upgrader.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    74602 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/unit/metadata/test_multi_table.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    66066 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/unit/metadata/test_single_table.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.335433 sdv-1.0.0rc0/tests/unit/multi_table/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/multi_table/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    37472 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/unit/multi_table/test_base.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    26300 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/unit/multi_table/test_hma.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.335818 sdv-1.0.0rc0/tests/unit/sampling/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-07-22 02:55:50.000000 sdv-1.0.0rc0/tests/unit/sampling/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2140 2022-06-21 19:18:25.000000 sdv-1.0.0rc0/tests/unit/sampling/test_tabular.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.336403 sdv-1.0.0rc0/tests/unit/sequential/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)       50 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/sequential/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    29270 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/unit/sequential/test_par.py
-drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 14:08:32.338201 sdv-1.0.0rc0/tests/unit/single_table/
--rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/single_table/__init__.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    75060 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/unit/single_table/test_base.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    13748 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/single_table/test_copulagan.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    18053 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/single_table/test_copulas.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)    10299 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/single_table/test_ctgan.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     8358 2023-03-23 18:07:15.000000 sdv-1.0.0rc0/tests/unit/single_table/test_utils.py
--rw-r--r--   0 andrewmontanez   (501) staff       (20)     2794 2023-03-28 14:06:42.000000 sdv-1.0.0rc0/tests/utils.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.834229 sdv-1.0.1.dev0/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       56 2023-01-24 21:06:49.000000 sdv-1.0.1.dev0/AUTHORS.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     8268 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/CONTRIBUTING.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    63406 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/HISTORY.md
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     4818 2023-01-24 21:06:49.000000 sdv-1.0.1.dev0/LICENSE
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      245 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/MANIFEST.in
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    74242 2023-04-19 17:34:10.834493 sdv-1.0.1.dev0/PKG-INFO
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     9801 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/README.md
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.692435 sdv-1.0.1.dev0/docs/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      604 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/Makefile
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.693464 sdv-1.0.1.dev0/docs/api_reference/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.693977 sdv-1.0.1.dev0/docs/api_reference/constraints/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.714557 sdv-1.0.1.dev0/docs/api_reference/constraints/api/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      575 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      179 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      653 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      173 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      197 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      666 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      575 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      158 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      143 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      549 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      173 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      627 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      158 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      158 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      143 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      549 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      117 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      137 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      134 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      510 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      131 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Range.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      179 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      653 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      179 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      588 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      120 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.fit_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      137 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.is_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      523 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      134 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      138 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      359 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/base.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      124 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2609 2022-07-22 02:55:50.000000 sdv-1.0.1.dev0/docs/api_reference/constraints/tabular.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      353 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/demo.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/evaluation.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      347 2022-07-22 02:55:50.000000 sdv-1.0.1.dev0/docs/api_reference/index.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.714911 sdv-1.0.1.dev0/docs/api_reference/lite/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.716755 sdv-1.0.1.dev0/docs/api_reference/lite/api/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      205 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.list_available_presets.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      147 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.load.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      502 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.sample.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.sample_conditions.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      211 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.sample_remaining_columns.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      147 2022-06-29 17:31:16.000000 sdv-1.0.1.dev0/docs/api_reference/lite/api/sdv.lite.tabular.TabularPreset.save.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       94 2022-07-22 02:55:50.000000 sdv-1.0.1.dev0/docs/api_reference/lite/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      348 2022-07-22 02:55:50.000000 sdv-1.0.1.dev0/docs/api_reference/lite/tabular.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.717718 sdv-1.0.1.dev0/docs/api_reference/metadata/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.726386 sdv-1.0.1.dev0/docs/api_reference/metadata/api/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.add_field.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.add_relationship.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      161 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.add_table.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_children.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_dtypes.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      178 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_field_meta.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_fields.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      184 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_foreign_keys.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_parents.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      181 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_primary_key.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      178 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_table_meta.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.get_tables.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.load_table.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.load_tables.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      877 2022-09-29 22:36:12.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      181 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.set_primary_key.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.to_json.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.validate.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.visualize.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      155 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.filter_valid.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.from_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      146 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.from_json.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.get_dtypes.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.get_fields.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      169 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.get_model_kwargs.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.reverse_transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      668 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      169 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.set_model_kwargs.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      166 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.set_primary_key.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.to_dict.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      140 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.to_json.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.transform.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      854 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/dataset.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      116 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      583 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/metadata/table.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.727444 sdv-1.0.1.dev0/docs/api_reference/metrics/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.764731 sdv-1.0.1.dev0/docs/api_reference/metrics/api/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.demos.load_multi_table_demo.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      170 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.demos.load_single_table_demo.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.demos.load_timeseries_demo.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLikelihood.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLikelihood.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      578 2022-08-30 22:45:23.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLikelihood.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      180 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLogLikelihood.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      203 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLogLikelihood.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      614 2022-08-30 22:45:23.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLogLikelihood.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.CSTest.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.CSTest.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      506 2022-08-30 22:45:24.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.CSTest.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      203 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.DetectionMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      573 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.DetectionMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-08-30 23:02:40.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSComplement.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-08-30 23:02:40.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSComplement.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      578 2022-08-30 23:02:40.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSComplement.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      165 2022-08-30 23:02:15.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSTest.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-08-30 23:02:15.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSTest.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      534 2022-08-30 23:02:15.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSTest.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      186 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticDetection.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      209 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticDetection.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      638 2022-08-30 22:45:24.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticDetection.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      219 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticParentChildDetection.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      242 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticParentChildDetection.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      716 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticParentChildDetection.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      224 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiSingleTableMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      598 2022-08-30 22:45:24.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiSingleTableMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      206 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiTableMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      584 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiTableMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      236 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.ParentChildDetectionMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      582 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.ParentChildDetectionMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCDetection.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCDetection.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      578 2022-08-30 22:45:24.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCDetection.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      204 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCParentChildDetection.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      227 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCParentChildDetection.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      661 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCParentChildDetection.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLikelihood.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLikelihood.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      569 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLikelihood.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLogLikelihood.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLogLikelihood.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      605 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLogLikelihood.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      198 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryAdaBoostClassifier.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      221 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryAdaBoostClassifier.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      837 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryAdaBoostClassifier.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      210 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryDecisionTreeClassifier.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      233 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryDecisionTreeClassifier.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      897 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryDecisionTreeClassifier.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      209 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryEfficacyMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      811 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryEfficacyMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      198 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryLogisticRegression.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      221 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryLogisticRegression.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      837 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryLogisticRegression.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      183 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryMLPClassifier.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      206 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryMLPClassifier.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      762 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryMLPClassifier.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CSTest.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CSTest.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      565 2022-08-30 22:45:24.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CSTest.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalCAP.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalCAP.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      664 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalCAP.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      183 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalEnsemble.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      206 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalEnsemble.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      734 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalEnsemble.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      201 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalGeneralizedCAP.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      224 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalGeneralizedCAP.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      818 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalGeneralizedCAP.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalKNN.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalKNN.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      664 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalKNN.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      165 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalNB.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalNB.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      650 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalNB.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      221 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalPrivacyMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      842 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalPrivacyMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      165 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalRF.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalRF.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      650 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalRF.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      168 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalSVM.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalSVM.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      664 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalSVM.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      180 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalZeroCAP.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      203 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalZeroCAP.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      720 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalZeroCAP.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      192 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ContinuousKLDivergence.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      215 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ContinuousKLDivergence.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      788 2022-10-05 00:20:25.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ContinuousKLDivergence.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DetectionMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      605 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DetectionMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      186 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DiscreteKLDivergence.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      209 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DiscreteKLDivergence.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      760 2022-10-05 00:20:25.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DiscreteKLDivergence.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      171 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.GMLogLikelihood.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      194 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.GMLogLikelihood.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      605 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.GMLogLikelihood.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-08-30 23:02:40.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSComplement.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-08-30 23:02:40.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSComplement.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      649 2022-08-30 23:02:40.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSComplement.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-08-30 23:02:15.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSTest.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      179 2022-08-30 23:02:15.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSTest.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      605 2022-08-30 23:02:15.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSTest.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      174 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LinearRegression.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      197 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LinearRegression.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      717 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LinearRegression.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      177 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LogisticDetection.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      200 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LogisticDetection.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      629 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LogisticDetection.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      197 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLEfficacyMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      716 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLEfficacyMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLPRegressor.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLPRegressor.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      657 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLPRegressor.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      215 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiColumnPairsMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      688 2022-10-05 00:20:25.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiColumnPairsMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      218 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiSingleColumnMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      701 2022-08-30 22:45:24.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiSingleColumnMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      222 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassDecisionTreeClassifier.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      245 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassDecisionTreeClassifier.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      957 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassDecisionTreeClassifier.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      875 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassEfficacyMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      195 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassMLPClassifier.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      218 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassMLPClassifier.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      822 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassMLPClassifier.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalLR.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      182 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalLR.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      629 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalLR.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalMLP.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalMLP.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      643 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalMLP.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      215 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalPrivacyMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      819 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalPrivacyMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      216 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalRadiusNearestNeighbor.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      239 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalRadiusNearestNeighbor.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      895 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalRadiusNearestNeighbor.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalSVR.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalSVR.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      643 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalSVR.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      875 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.RegressionEfficacyMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      162 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SVCDetection.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SVCDetection.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      569 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SVCDetection.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      257 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ScikitLearnClassifierDetectionMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      857 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ScikitLearnClassifierDetectionMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      200 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SingleTableMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      629 2022-12-08 22:56:17.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SingleTableMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      201 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMClassifierEfficacy.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      224 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMClassifierEfficacy.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      650 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMClassifierEfficacy.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      174 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMDetection.compute.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      197 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMDetection.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      551 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMDetection.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      233 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesDetectionMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      683 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesDetectionMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      230 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesEfficacyMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      672 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesEfficacyMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      206 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesMetric.get_subclasses.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      584 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesMetric.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      213 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/demos.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      143 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1402 2022-09-22 23:47:45.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/relational.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     4109 2022-09-22 23:47:45.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/tabular.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      735 2022-12-21 22:30:23.000000 sdv-1.0.1.dev0/docs/api_reference/metrics/timeseries.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.765214 sdv-1.0.1.dev0/docs/api_reference/relational/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.766245 sdv-1.0.1.dev0/docs/api_reference/relational/api/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      123 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.load.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      416 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.sample.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/relational/api/sdv.relational.hma.HMA1.save.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      173 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/relational/hma1.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      109 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/relational/index.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.766642 sdv-1.0.1.dev0/docs/api_reference/sampling/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.767239 sdv-1.0.1.dev0/docs/api_reference/sampling/api/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      166 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/sampling/api/sdv.sampling.Condition.get_column_values.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      151 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/sampling/api/sdv.sampling.Condition.get_num_rows.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      417 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/sampling/api/sdv.sampling.Condition.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      109 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/sampling/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      227 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/sampling/tabular.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      153 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/sdv.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.768117 sdv-1.0.1.dev0/docs/api_reference/tabular/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.775416 sdv-1.0.1.dev0/docs/api_reference/tabular/api/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      147 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.get_distributions.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      176 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.get_metadata.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.load.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      655 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.sample.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.sample_conditions.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      214 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.sample_remaining_columns.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      150 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.save.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      200 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.get_distributions.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.get_likelihood.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      185 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.get_metadata.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.get_parameters.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.load.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      663 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      165 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.sample.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      200 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.sample_conditions.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      223 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.sample_remaining_columns.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      159 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.save.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      191 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.set_parameters.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      123 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      152 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.get_metadata.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.load.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      463 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.sample.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      167 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.sample_conditions.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      190 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.sample_remaining_columns.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.CTGAN.save.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      120 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      149 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.get_metadata.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      123 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.load.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      450 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      129 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.sample.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.sample_conditions.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      187 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.sample_remaining_columns.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      123 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.ctgan.TVAE.save.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      339 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/copulagan.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      489 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/copulas.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      260 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/ctgan.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      136 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      249 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/tabular/tvae.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.775826 sdv-1.0.1.dev0/docs/api_reference/timeseries/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.777197 sdv-1.0.1.dev0/docs/api_reference/timeseries/api/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.fit.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      164 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.get_metadata.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      138 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.load.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      338 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      144 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.sample.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      138 2022-06-22 20:44:18.000000 sdv-1.0.1.dev0/docs/api_reference/timeseries/api/sdv.timeseries.deepecho.PAR.save.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      108 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/timeseries/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      190 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/api_reference/timeseries/par.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     6934 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/docs/conf.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.777784 sdv-1.0.1.dev0/docs/developer_guides/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     8771 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/developer_guides/contributing.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      364 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/developer_guides/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2905 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/developer_guides/overview.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.778748 sdv-1.0.1.dev0/docs/developer_guides/sdv/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     5889 2022-07-22 02:55:50.000000 sdv-1.0.1.dev0/docs/developer_guides/sdv/constraints.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      292 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/developer_guides/sdv/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     7480 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/developer_guides/sdv/metadata.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     9508 2023-02-02 20:58:41.000000 sdv-1.0.1.dev0/docs/developer_guides/sdv/tabular.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.779459 sdv-1.0.1.dev0/docs/getting_started/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      113 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/getting_started/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2557 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/getting_started/install.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     3664 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/getting_started/quickstart.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       29 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/history.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.792407 sdv-1.0.1.dev0/docs/images/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    52078 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/images/CTGAN-DataCebo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    50900 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/images/Copulas-DataCebo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    60600 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/images/DataCebo-Blue.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    46250 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/images/DeepEcho-DataCebo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    25573 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/images/RDT-DataCebo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)   243101 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/docs/images/Real-vs-Synthetic-Evaluation.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    27285 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/images/SDGym-DataCebo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    35670 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/images/SDMetrics-DataCebo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    22394 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/images/SDV-DataCebo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    64162 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/docs/images/SDV-logo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     8765 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/images/SDV.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)   412158 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/docs/images/Single-Table-Metadata-Example.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    99815 2022-07-22 02:55:50.000000 sdv-1.0.1.dev0/docs/images/custom_constraint.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    50140 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/docs/images/datacebo-logo-dark-mode.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    50481 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/docs/images/datacebo-logo.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      547 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/images/google_colab.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    67403 2022-12-08 23:36:42.000000 sdv-1.0.1.dev0/docs/images/hma1_1.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     8748 2022-12-08 23:36:42.000000 sdv-1.0.1.dev0/docs/images/metadata_1.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    67425 2022-12-08 23:36:42.000000 sdv-1.0.1.dev0/docs/images/metadata_2.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2497 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/images/mybinder.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    67403 2022-12-08 23:36:42.000000 sdv-1.0.1.dev0/docs/images/quickstart_1.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)   176980 2023-01-24 21:06:49.000000 sdv-1.0.1.dev0/docs/images/rdt_main_tranformation.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2283 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/images/slack.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     6075 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/docs/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      765 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/make.bat
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.794134 sdv-1.0.1.dev0/docs/savefig/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    10974 2022-12-08 23:00:09.000000 sdv-1.0.1.dev0/docs/savefig/copulagan_experience_years_1.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    12668 2022-12-08 23:00:10.000000 sdv-1.0.1.dev0/docs/savefig/copulagan_experience_years_2.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    10277 2022-12-08 23:00:37.000000 sdv-1.0.1.dev0/docs/savefig/copulagan_experience_years_3.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    10974 2022-12-08 23:05:15.000000 sdv-1.0.1.dev0/docs/savefig/experience_years_1.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    10270 2022-12-08 23:05:16.000000 sdv-1.0.1.dev0/docs/savefig/experience_years_2.png
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    12415 2022-12-08 23:05:16.000000 sdv-1.0.1.dev0/docs/savefig/experience_years_3.png
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.686036 sdv-1.0.1.dev0/docs/sdv_theme/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.794404 sdv-1.0.1.dev0/docs/sdv_theme/static/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1046 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/sdv_theme/static/slack-32.png
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.794648 sdv-1.0.1.dev0/docs/user_guides/
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.796117 sdv-1.0.1.dev0/docs/user_guides/benchmarking/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     4753 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/benchmarking/datasets.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1885 2023-02-02 20:58:41.000000 sdv-1.0.1.dev0/docs/user_guides/benchmarking/docker.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      563 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/benchmarking/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2562 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/benchmarking/install.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     7764 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/benchmarking/run.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1731 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/benchmarking/synthesizers.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.796909 sdv-1.0.1.dev0/docs/user_guides/evaluation/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     3240 2022-12-21 22:30:23.000000 sdv-1.0.1.dev0/docs/user_guides/evaluation/evaluation_framework.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      504 2022-12-21 22:30:23.000000 sdv-1.0.1.dev0/docs/user_guides/evaluation/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      219 2022-12-21 22:30:23.000000 sdv-1.0.1.dev0/docs/user_guides/evaluation/synthetic_data_metrics.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      277 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/index.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.797943 sdv-1.0.1.dev0/docs/user_guides/relational/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2131 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/relational/constraints.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      141 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/relational/data_description.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     8143 2022-12-21 22:30:23.000000 sdv-1.0.1.dev0/docs/user_guides/relational/hma1.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      177 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/relational/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       79 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/relational/models.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     6906 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/relational/relational_metadata.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.801586 sdv-1.0.1.dev0/docs/user_guides/single_table/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      135 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/single_table/constraints.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    24765 2023-02-02 20:58:41.000000 sdv-1.0.1.dev0/docs/user_guides/single_table/copulagan.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    18899 2023-02-02 20:58:41.000000 sdv-1.0.1.dev0/docs/user_guides/single_table/ctgan.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     6108 2022-09-22 23:47:45.000000 sdv-1.0.1.dev0/docs/user_guides/single_table/custom_constraints.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      121 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/single_table/data_description.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    20259 2023-02-02 20:58:41.000000 sdv-1.0.1.dev0/docs/user_guides/single_table/gaussian_copula.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    14530 2022-09-22 23:47:45.000000 sdv-1.0.1.dev0/docs/user_guides/single_table/handling_constraints.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      980 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/single_table/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      510 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/single_table/models.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       65 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/single_table/table_metadata.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     8354 2022-07-22 02:55:50.000000 sdv-1.0.1.dev0/docs/user_guides/single_table/tabular_preset.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    18149 2023-02-02 20:58:41.000000 sdv-1.0.1.dev0/docs/user_guides/single_table/tvae.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.802187 sdv-1.0.1.dev0/docs/user_guides/timeseries/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       92 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/timeseries/index.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       78 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/docs/user_guides/timeseries/models.rst
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    14863 2022-12-21 22:30:23.000000 sdv-1.0.1.dev0/docs/user_guides/timeseries/par.rst
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.803278 sdv-1.0.1.dev0/sdv/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      372 2023-04-11 20:36:40.000000 sdv-1.0.1.dev0/sdv/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      819 2023-04-11 20:36:40.000000 sdv-1.0.1.dev0/sdv/_addons.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.805749 sdv-1.0.1.dev0/sdv/constraints/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      543 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/constraints/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    17970 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/constraints/base.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      799 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/constraints/errors.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    51311 2023-04-19 17:33:53.000000 sdv-1.0.1.dev0/sdv/constraints/tabular.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     3014 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/constraints/utils.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.807160 sdv-1.0.1.dev0/sdv/data_processing/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      132 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/data_processing/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    33694 2023-04-11 20:36:40.000000 sdv-1.0.1.dev0/sdv/data_processing/data_processor.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1526 2023-03-31 20:05:19.000000 sdv-1.0.1.dev0/sdv/data_processing/datetime_formatter.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      522 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/data_processing/errors.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     4010 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/data_processing/numerical_formatter.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      726 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/data_processing/utils.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.807742 sdv-1.0.1.dev0/sdv/datasets/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       43 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/datasets/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     6625 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/datasets/demo.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1117 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/datasets/local.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      694 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/errors.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.808310 sdv-1.0.1.dev0/sdv/evaluation/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       49 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/evaluation/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     3701 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/evaluation/multi_table.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     3239 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/evaluation/single_table.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.808705 sdv-1.0.1.dev0/sdv/lite/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      145 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/lite/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     6964 2023-04-11 20:36:40.000000 sdv-1.0.1.dev0/sdv/lite/single_table.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.810544 sdv-1.0.1.dev0/sdv/metadata/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      400 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/metadata/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2634 2023-04-11 20:36:40.000000 sdv-1.0.1.dev0/sdv/metadata/anonymization.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      238 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/metadata/errors.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    10362 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/metadata/metadata_upgrader.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    28381 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/metadata/multi_table.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    21748 2023-04-11 20:36:40.000000 sdv-1.0.1.dev0/sdv/metadata/single_table.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      793 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/metadata/utils.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2475 2023-04-11 20:36:40.000000 sdv-1.0.1.dev0/sdv/metadata/visualization.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.811971 sdv-1.0.1.dev0/sdv/metrics/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      252 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/sdv/metrics/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      156 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/sdv/metrics/demos.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/sdv/metrics/relational.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      186 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/sdv/metrics/tabular.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      188 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/sdv/metrics/timeseries.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.815489 sdv-1.0.1.dev0/sdv/multi_table/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      126 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/multi_table/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    18930 2023-04-11 20:36:40.000000 sdv-1.0.1.dev0/sdv/multi_table/base.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    21831 2023-04-12 17:32:29.000000 sdv-1.0.1.dev0/sdv/multi_table/hma.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.816182 sdv-1.0.1.dev0/sdv/sampling/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      103 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/sdv/sampling/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      913 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/sdv/sampling/tabular.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.816623 sdv-1.0.1.dev0/sdv/sequential/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      124 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/sequential/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    14676 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/sequential/par.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.819430 sdv-1.0.1.dev0/sdv/single_table/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      358 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/single_table/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    44567 2023-03-31 20:14:17.000000 sdv-1.0.1.dev0/sdv/single_table/base.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    10977 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/single_table/copulagan.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    14718 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/single_table/copulas.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     9725 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/single_table/ctgan.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      341 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/single_table/errors.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    10141 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/sdv/single_table/utils.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     4833 2023-04-19 17:33:49.000000 sdv-1.0.1.dev0/sdv/utils.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.804429 sdv-1.0.1.dev0/sdv.egg-info/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    74242 2023-04-19 17:34:10.000000 sdv-1.0.1.dev0/sdv.egg-info/PKG-INFO
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    35475 2023-04-19 17:34:10.000000 sdv-1.0.1.dev0/sdv.egg-info/SOURCES.txt
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        1 2023-04-19 17:34:10.000000 sdv-1.0.1.dev0/sdv.egg-info/dependency_links.txt
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        1 2023-04-19 17:34:10.000000 sdv-1.0.1.dev0/sdv.egg-info/not-zip-safe
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1483 2023-04-19 17:34:10.000000 sdv-1.0.1.dev0/sdv.egg-info/requires.txt
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        4 2023-04-19 17:34:10.000000 sdv-1.0.1.dev0/sdv.egg-info/top_level.txt
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1235 2023-04-19 17:34:10.835027 sdv-1.0.1.dev0/setup.cfg
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     3857 2023-04-14 18:08:46.000000 sdv-1.0.1.dev0/setup.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.819904 sdv-1.0.1.dev0/tests/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/tests/__init__.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.820293 sdv-1.0.1.dev0/tests/integration/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/tests/integration/__init__.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.820578 sdv-1.0.1.dev0/tests/integration/data_processing/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    11659 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/data_processing/test_data_processor.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      598 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/dataset.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.820886 sdv-1.0.1.dev0/tests/integration/datasets/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/datasets/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     3324 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/datasets/test_demo.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.821341 sdv-1.0.1.dev0/tests/integration/evaluation/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/evaluation/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1133 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/evaluation/test_multi_table.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1131 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/evaluation/test_single_table.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.821625 sdv-1.0.1.dev0/tests/integration/lite/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-07-22 02:55:50.000000 sdv-1.0.1.dev0/tests/integration/lite/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1447 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/lite/test_single_table.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.822114 sdv-1.0.1.dev0/tests/integration/metadata/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/metadata/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     4369 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/metadata/test_multi_table.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     6200 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/metadata/test_single_table.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.822561 sdv-1.0.1.dev0/tests/integration/multi_table/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/multi_table/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    22620 2023-04-11 20:36:40.000000 sdv-1.0.1.dev0/tests/integration/multi_table/test_hma.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.822949 sdv-1.0.1.dev0/tests/integration/sequential/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/sequential/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     6268 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/sequential/test_par.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.824264 sdv-1.0.1.dev0/tests/integration/single_table/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/single_table/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1769 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/single_table/custom_constraints.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    25795 2023-03-31 19:06:00.000000 sdv-1.0.1.dev0/tests/integration/single_table/test_base.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     9991 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/single_table/test_copulas.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2528 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/integration/single_table/test_ctgan.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.824479 sdv-1.0.1.dev0/tests/readme_test/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    13973 2022-08-16 22:57:14.000000 sdv-1.0.1.dev0/tests/readme_test/README.md
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.824892 sdv-1.0.1.dev0/tests/unit/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/tests/unit/__init__.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.826230 sdv-1.0.1.dev0/tests/unit/constraints/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/tests/unit/constraints/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    32139 2023-04-19 16:44:05.000000 sdv-1.0.1.dev0/tests/unit/constraints/test_base.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)   164371 2023-04-19 17:33:53.000000 sdv-1.0.1.dev0/tests/unit/constraints/test_tabular.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     8458 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/constraints/test_utils.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.827639 sdv-1.0.1.dev0/tests/unit/data_processing/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/data_processing/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    81545 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/data_processing/test_data_processor.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2765 2023-03-31 19:49:22.000000 sdv-1.0.1.dev0/tests/unit/data_processing/test_datetime_formatter.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    14718 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/data_processing/test_numerical_formatter.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)      926 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/data_processing/test_utils.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.828217 sdv-1.0.1.dev0/tests/unit/datasets/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/datasets/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     9876 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/datasets/test_demo.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2498 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/datasets/test_local.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.828637 sdv-1.0.1.dev0/tests/unit/evaluation/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2865 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/evaluation/test_multi_table.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2533 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/evaluation/test_single_table.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.829004 sdv-1.0.1.dev0/tests/unit/lite/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/tests/unit/lite/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     9299 2023-04-11 20:36:40.000000 sdv-1.0.1.dev0/tests/unit/lite/test_single_table.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.830179 sdv-1.0.1.dev0/tests/unit/metadata/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/tests/unit/metadata/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     4443 2023-04-11 20:36:40.000000 sdv-1.0.1.dev0/tests/unit/metadata/test_anonymization.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    22557 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/metadata/test_metadata_upgrader.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    74602 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/metadata/test_multi_table.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    66033 2023-04-11 20:36:40.000000 sdv-1.0.1.dev0/tests/unit/metadata/test_single_table.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.831188 sdv-1.0.1.dev0/tests/unit/multi_table/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/multi_table/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    39185 2023-04-11 20:36:40.000000 sdv-1.0.1.dev0/tests/unit/multi_table/test_base.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    26300 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/multi_table/test_hma.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.831780 sdv-1.0.1.dev0/tests/unit/sampling/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2022-07-22 02:55:50.000000 sdv-1.0.1.dev0/tests/unit/sampling/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2140 2022-06-21 19:18:25.000000 sdv-1.0.1.dev0/tests/unit/sampling/test_tabular.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.832271 sdv-1.0.1.dev0/tests/unit/sequential/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)       50 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/sequential/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    29270 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/sequential/test_par.py
+drwxr-xr-x   0 andrewmontanez   (501) staff       (20)        0 2023-04-19 17:34:10.834037 sdv-1.0.1.dev0/tests/unit/single_table/
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)        0 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/single_table/__init__.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    76489 2023-04-19 16:44:05.000000 sdv-1.0.1.dev0/tests/unit/single_table/test_base.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    13748 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/single_table/test_copulagan.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    18053 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/single_table/test_copulas.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)    10299 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/single_table/test_ctgan.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     8358 2023-03-28 20:22:54.000000 sdv-1.0.1.dev0/tests/unit/single_table/test_utils.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     1359 2023-04-11 20:36:40.000000 sdv-1.0.1.dev0/tests/unit/test__addons.py
+-rw-r--r--   0 andrewmontanez   (501) staff       (20)     2794 2023-04-19 17:33:49.000000 sdv-1.0.1.dev0/tests/utils.py
```

### Comparing `sdv-1.0.0rc0/CONTRIBUTING.rst` & `sdv-1.0.1.dev0/CONTRIBUTING.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/HISTORY.md` & `sdv-1.0.1.dev0/HISTORY.md`

 * *Files 23% similar despite different names*

```diff
@@ -1,9 +1,203 @@
 # Release Notes
 
+## 1.0.0 - 2023-03-28
+
+This is a major release that introduces a new API to the `SDV` aimed at streamlining the process of synthetic data generation! To achieve this, this release includes the addition of several large features.
+
+### Metadata
+
+Some of the most notable additions are the new `SingleTableMetadata` and `MultiTableMetadata` classes. These classes enable a number of features that make it easier to synthesize your data correctly such as:
+
+* Automatic data detection - Calling `metadata.detect_from_dataframe()` or `metadata.detect_from_csv()` will populate the metadata autonomously with values it thinks represent the data.
+* Easy updating - Once an instance of the metadata is created, values can be easily updated using a number of methods defined in the API. For more info, view the [docs](https://docs.sdv.dev/sdv/single-table-data/data-preparation/single-table-metadata-api).
+* Metadata validation - Calling `metadata.validate()` will return a report of any invalid definitions in the metadata specification.
+* Upgrading - Users with the previous metadata format can easily update to the new specification using the `upgrade_metadata()` method.
+* Saving and loading - The metadata itself can easily be saved to a json file and loaded back up later.
+
+### Class and Module Names
+
+Another major change is the renaming of our core modeling classes and modules. The name changes are meant to highlight the difference between the underlying machine learning models, and the objects responsible for the end-to-end workflow of generating synthetic data. The main name changes are as follows:
+* `tabular` -> `single_table`
+* `relational` -> `multi_table`
+* `timeseries` -> `sequential`
+* `BaseTabularModel` -> `BaseSingleTableSynthesizer`
+* `GaussianCopula` -> `GaussianCopulaSynthesizer`
+* `CTGAN` -> `CTGANSynthesizer`
+* `TVAE` -> `TVAESynthesizer`
+* `CopulaGan` -> `CopulaGANSynthesizer`
+* `PAR` -> `PARSynthesizer`
+* `HMA1` -> `HMASynthesizer`
+
+In `SDV` 1.0, synthesizers are classes that take in metadata and handle data preprocessing, model training and model sampling. This is similar to the previous `BaseTabularModel` in `SDV` <1.0.
+
+### Synthetic Data Workflow
+
+`Synthesizers` in `SDV` 1.0 define a clear workflow for generating synthetic data.
+1. Synthesizers are initialized with a metadata class.
+2. They can then be used to transform the data and apply constraints using the `synthesizer.preprocess()` method. This step also validates that the data matches the provided metadata to avoid errors in fitting or sampling.
+3. The processed data can then be fed into the underlying machine learning model using `synthesizer.fit_processed_data()`. (Alternatively, data can be preprocessed and fit to the model using `synthesizer.fit()`.)
+4. Data can then be sampled using `synthesizer.sample()`.
+
+Each synthesizer class also provides a series of methods to help users customize the transformations their data goes through. Read more about that [here](https://docs.sdv.dev/sdv/single-table-data/modeling/synthetic-data-workflow/transform-and-anonymize).
+
+Notice that the preprocessing and model fitting steps can now be separated. This can be helpful if preprocessing is time consuming or if the data has been processed externally.
+
+### Other Highly Requested Features
+
+Another major addition is control over randomization. In `SDV` <1.0, users could set a seed to control the randomization for only some columns. In `SDV` 1.0, randomization is controlled for all columns. Every new call to sample generates new data, but the synthesizer's seed can be reset to the original state using `synthesizer.reset_randomization()`, enabling reproducibility.
+
+`SDV 1.0` adds accessibility and transparency into the transformers used for preprocessing and underlying machine learning models.
+* Using the `synthesizer.get_transformers()` method, you can access the transformers used to preprocess each column and view their properties. This can be useful for debugging and accessing privacy information like mappings used to mask data.
+* Distribution parameters learned by copula models can be accessed using the `synthesizer.get_learned_distributions()` method.
+
+PII handling is improved by the following features:
+* Primary keys can be set to natural sdtypes (eg. SSN, email, name). Previously they could only be numerical or text.
+* The `PseudoAnonymizedFaker` can be used to provide consistent mapping to PII columns. As mentioned before, the mapping itself can be accessed by viewing the transformers for the column using `synthesizer.get_transformers()`.
+* A bug causing PII columns to slow down modeling is patched.
+
+Finally, the synthetic data can now be easily evaluated using the `evaluate_quality()` and `run_diagnostic()` methods. The data can be compared visually to the actual data using the `get_column_plot()` and `get_column_pair_plot()` methods. For more info on how to visualize or interpret the synthetic data evaluation, read the docs [here](https://docs.sdv.dev/sdv/single-table-data/evaluation).
+
+### Issues Resolved
+
+#### New Features
+
+* Change auto_assign_transformers to handle id types - Issue [#1325](https://github.com/sdv-dev/SDV/issues/1325) by @pvk-developer
+* Change 'text' sdtype to 'id' - Issue [#1324](https://github.com/sdv-dev/SDV/issues/1324) by @frances-h
+* In `upgrade_metadata`, return the object instead of writing it to a JSON file - Issue [#1319](https://github.com/sdv-dev/SDV/issues/1319) by @frances-h
+* In `upgrade_metadata` index primary keys should be converted to `text` - Issue [#1318](https://github.com/sdv-dev/SDV/issues/1318) by @amontanez24
+* Add `load_from_dict` to SingleTableMetadata and MultiTableMetadata - Issue [#1314](https://github.com/sdv-dev/SDV/issues/1314) by @amontanez24
+* Throw a `SynthesizerInputError` if `FixedCombinations` constraint is applied to a column that is not `boolean` or `categorical` - Issue [#1306](https://github.com/sdv-dev/SDV/issues/1306) by @frances-h
+* Missing `save` and `load` methods for `HMASynthesizer` - Issue [#1262](https://github.com/sdv-dev/SDV/issues/1262) by @amontanez24
+* Better input validation when creating single and multi table synthesizers - Issue [#1242](https://github.com/sdv-dev/SDV/issues/1242) by @fealho
+* Better input validation on `HMASynthesizer.sample` - Issue [#1241](https://github.com/sdv-dev/SDV/issues/1241) by @R-Palazzo
+* Validate that relationship must be between a `primary key` and `foreign key` - Issue [#1236](https://github.com/sdv-dev/SDV/issues/1236) by @fealho
+* Improve `update_column` validation for `pii` attribute - Issue [#1226](https://github.com/sdv-dev/SDV/issues/1226) by @pvk-developer
+* Order the output of `get_transformers()` based on the metadata - Issue [#1222](https://github.com/sdv-dev/SDV/issues/1222) by @pvk-developer
+* Log if any `numerical_distributions` will not be applied - Issue [#1212](https://github.com/sdv-dev/SDV/issues/1212) by @fealho
+* Improve error handling for `GaussianCopulaSynthesizer`: `numerical_distributions` - Issue [#1211](https://github.com/sdv-dev/SDV/issues/1211) by @fealho
+* Improve error handling when validating `constraints` - Issue [#1210](https://github.com/sdv-dev/SDV/issues/1210) by @fealho
+* Add `fake_companies` demo - Issue [#1209](https://github.com/sdv-dev/SDV/issues/1209) by @amontanez24
+* Allow me to create a custom constraint class and use it in the same file - Issue [#1205](https://github.com/sdv-dev/SDV/issues/1205) by @amontanez24
+* Sampling should reset after retraining the model - Issue [#1201](https://github.com/sdv-dev/SDV/issues/1201) by @pvk-developer
+* Change function name `HMASynthesizer.update_table_parameters` --> `set_table_parameters` - Issue [#1200](https://github.com/sdv-dev/SDV/issues/1200) by @pvk-developer
+* Add `get_info` method to synthesizers - Issue [#1199](https://github.com/sdv-dev/SDV/issues/1199) by @fealho
+* Add evaluation methods to synthesizer - Issue [#1190](https://github.com/sdv-dev/SDV/issues/1190) by @fealho
+* Update `evaluate.py` to work with the new `metadata` - Issue [#1186](https://github.com/sdv-dev/SDV/issues/1186) by @fealho
+* Remove old code - Issue [#1181](https://github.com/sdv-dev/SDV/issues/1181) by @pvk-developer
+* Drop support for python 3.6 and add support for 3.10 - Issue [#1176](https://github.com/sdv-dev/SDV/issues/1176) by @fealho
+* Add constraint methods to MultiTableSynthesizers - Issue [#1171](https://github.com/sdv-dev/SDV/issues/1171) by @fealho
+* Update custom constraint workflow - Issue [#1169](https://github.com/sdv-dev/SDV/issues/1169) by @pvk-developer
+* Add get_constraints method to synthesizers - Issue [#1168](https://github.com/sdv-dev/SDV/issues/1168) by @pvk-developer
+* Migrate adding and validating constraints to BaseSynthesizer - Issue [#1163](https://github.com/sdv-dev/SDV/issues/1163) by @pvk-developer
+* Change metadata `"SCHEMA_VERSION"` --> `"METADATA_SPEC_VERSION"` - Issue [#1139](https://github.com/sdv-dev/SDV/issues/1139) by @amontanez24
+* Add ability to reset random sampling - Issue [#1130](https://github.com/sdv-dev/SDV/issues/1130) by @pvk-developer
+* Add get_available_demos - Issue [#1129](https://github.com/sdv-dev/SDV/issues/1129) by @fealho
+* Add demo loading functionality - Issue [#1128](https://github.com/sdv-dev/SDV/issues/1128) by @fealho
+* Use logging instead of printing in detect methods - Issue [#1107](https://github.com/sdv-dev/SDV/issues/1107) by @fealho
+* Add save and load methods to synthesizers - Issue [#1106](https://github.com/sdv-dev/SDV/issues/1106) by @pvk-developer
+* Add sampling methods to PARSynthesizer - Issue [#1083](https://github.com/sdv-dev/SDV/issues/1083) by @amontanez24
+* Add transformer methods to PARSynthesizer - Issue [#1082](https://github.com/sdv-dev/SDV/issues/1082) by @fealho
+* Add validate to PARSynthesizer - Issue [#1081](https://github.com/sdv-dev/SDV/issues/1081) by @amontanez24
+* Add preprocess and fit methods to PARSynthesizer - Issue [#1080](https://github.com/sdv-dev/SDV/issues/1080) by @amontanez24
+* Create SingleTablePreset - Issue [#1079](https://github.com/sdv-dev/SDV/issues/1079) by @amontanez24
+* Add sample method to multi-table synthesizers - Issue [#1078](https://github.com/sdv-dev/SDV/issues/1078) by @pvk-developer
+* Add get_learned_distributions method to synthesizers - Issue [#1075](https://github.com/sdv-dev/SDV/issues/1075) by @pvk-developer
+* Add preprocess and fit methods to multi-table synthesizers - Issue [#1074](https://github.com/sdv-dev/SDV/issues/1074) by @pvk-developer
+* Add transformer related methods to BaseMultiTableSynthesizer - Issue [#1072](https://github.com/sdv-dev/SDV/issues/1072) by @fealho
+* Add validate method to `BaseMultiTableSynthesizer` - Issue [#1071](https://github.com/sdv-dev/SDV/issues/1071) by @pvk-developer
+* Create BaseMultiTableSynthesizer and HMASynthesizer classes - Issue [#1070](https://github.com/sdv-dev/SDV/issues/1070) by @pvk-developer
+* Create PARSynthesizer - Issue [#1055](https://github.com/sdv-dev/SDV/issues/1055) by @amontanez24
+* Raise an error if an invalid sdtype is provided to the metadata - Issue [#1042](https://github.com/sdv-dev/SDV/issues/1042) by @amontanez24
+* Only allow datetime and numerical sdtypes to be set as the sequence index - Issue [#1030](https://github.com/sdv-dev/SDV/issues/1030) by @amontanez24
+* Change set_alternate_keys to add_alternate_keys and add error handling - Issue [#1029](https://github.com/sdv-dev/SDV/issues/1029) by @amontanez24
+* Create `MultiTableMetadata.add_table` method - Issue [#1024](https://github.com/sdv-dev/SDV/issues/1024) by @amontanez24
+* Add update_transformers to synthesizers - Issue [#1021](https://github.com/sdv-dev/SDV/issues/1021) by @fealho
+* Add assign_transformers and get_transformers methods to synthesizers - Issue [#1020](https://github.com/sdv-dev/SDV/issues/1020) by @pvk-developer
+* Add fit and fit_processed_data methods to synthesizers - Issue [#1019](https://github.com/sdv-dev/SDV/issues/1019) by @pvk-developer
+* Add preprocess method to synthesizers - Issue [#1018](https://github.com/sdv-dev/SDV/issues/1018) by @pvk-developer
+* Add sampling to synthesizer classes - Issue [#1015](https://github.com/sdv-dev/SDV/issues/1015) by @pvk-developer
+* Add validate method to synthesizer - Issue [#1014](https://github.com/sdv-dev/SDV/issues/1014) by @fealho
+* Create GaussianCopula, CTGAN, TVAE and CopulaGAN synthesizer classes - Issue [#1013](https://github.com/sdv-dev/SDV/issues/1013) by @pvk-developer
+* Create BaseSynthesizer class - Issue [#1012](https://github.com/sdv-dev/SDV/issues/1012) by @pvk-developer
+* Add constraint conversion to upgrade_metadata - Issue [#1005](https://github.com/sdv-dev/SDV/issues/1005) by @amontanez24
+* Add method to generate keys to DataProcessor - Issue [#994](https://github.com/sdv-dev/SDV/issues/994) by @pvk-developer
+* Create formatter - Issue [#970](https://github.com/sdv-dev/SDV/issues/970) by @fealho
+* Create a utility to load multiple CSV files at once - Issue [#969](https://github.com/sdv-dev/SDV/issues/969) by @amontanez24
+* Create a utility to convert old --> new metadata format - Issue [#966](https://github.com/sdv-dev/SDV/issues/966) by @amontanez24
+* Add validation check that `primary_key`, `alternate_keys` and `sequence_key` cannot be sdtype categorical - Issue [#963](https://github.com/sdv-dev/SDV/issues/963) by @fealho
+* Add anonymization to DataProcessor - Issue [#950](https://github.com/sdv-dev/SDV/issues/950) by @pvk-developer
+* Add utility methods to DataProcessor - Issue [#948](https://github.com/sdv-dev/SDV/issues/948) by @fealho
+* Add fit, transform and reverse_transform to DataProcessor - Issue [#947](https://github.com/sdv-dev/SDV/issues/947) by @amontanez24
+* Create DataProcessor class - Issue [#946](https://github.com/sdv-dev/SDV/issues/946) by @amontanez24
+* Add add_constraint method to MultiTableMetadata - Issue [#895](https://github.com/sdv-dev/SDV/issues/895) by @amontanez24
+* Add key related methods to MultiTableMetadata - Issue [#894](https://github.com/sdv-dev/SDV/issues/894) by @fealho
+* Add update_column and add_column methods to MultiTableMetadata - Issue [#893](https://github.com/sdv-dev/SDV/issues/893) by @amontanez24
+* Add detect methods to MultiTableMetadata - Issue [#892](https://github.com/sdv-dev/SDV/issues/892) by @amontanez24
+* Add load_from_json and save_to_json methods to the MultiTableMetadata - Issue [#891](https://github.com/sdv-dev/SDV/issues/891) by @fealho
+* Add add_relationship method to MultiTableMetadata - Issue [#890](https://github.com/sdv-dev/SDV/issues/890) by @pvk-developer
+* Add validate method to MultiTableMetadata - Issue [#888](https://github.com/sdv-dev/SDV/issues/888) by @pvk-developer
+* Add visualize method to MultiTableMetadata class - Issue [#884](https://github.com/sdv-dev/SDV/issues/884) by @amontanez24
+* Create MultiTableMetadata class - Issue [#883](https://github.com/sdv-dev/SDV/issues/883) by @pvk-developer
+* Add add_constraint method to SingleTableMetadata - Issue [#881](https://github.com/sdv-dev/SDV/issues/881) by @amontanez24
+* Add key related methods to SingleTableMetadata - Issue [#880](https://github.com/sdv-dev/SDV/issues/880) by @fealho
+* Add validate method to SingleTableMetadata - Issue [#879](https://github.com/sdv-dev/SDV/issues/879) by @fealho
+* Add _validate_inputs class method to each constraint - Issue [#878](https://github.com/sdv-dev/SDV/issues/878) by @fealho
+* Add update_column and add_column methods to SingleTableMetadata - Issue [#877](https://github.com/sdv-dev/SDV/issues/877) by @pvk-developer
+* Add detect methods to SingleTableMetadata - Issue [#876](https://github.com/sdv-dev/SDV/issues/876) by @pvk-developer
+* Add load_from_json and save_to_json methods to SingleTableMetadata - Issue [#874](https://github.com/sdv-dev/SDV/issues/874) by @pvk-developer
+* Create SingleTableMetadata class - Issue [#873](https://github.com/sdv-dev/SDV/issues/873) by @pvk-developer
+
+#### Bugs Fixed
+
+* In `upgrade_metadata`, PII values are being converted to generic categorical columns - Issue [#1317](https://github.com/sdv-dev/SDV/issues/1317) by @frances-h
+* `PARSynthesizer` is missing `save` and `load` methods - Issue [#1289](https://github.com/sdv-dev/SDV/issues/1289) by @amontanez24
+* Confusing warning when updating transformers - Issue [#1272](https://github.com/sdv-dev/SDV/issues/1272) by @frances-h
+* When adding constraints, `auto_assign_transformers` is showing columns that should no longer exist - Issue [#1260](https://github.com/sdv-dev/SDV/issues/1260) by @pvk-developer
+* Cannot fit twice if I modify transformers: `ValueError: There are non-numerical values in your data.` - Issue [#1259](https://github.com/sdv-dev/SDV/issues/1259) by @frances-h
+* Cannot fit twice if I add constraints: `ValueError: There are non-numerical values in your data.` - Issue [#1258](https://github.com/sdv-dev/SDV/issues/1258) by @frances-h
+* `HMASynthesizer` errors out when fitting a dataset that has a table which holds primary key and foreign keys only - Issue [#1257](https://github.com/sdv-dev/SDV/issues/1257) by @pvk-developer
+* Change ValueErrors to InvalidMetadataErrors - Issue [#1251](https://github.com/sdv-dev/SDV/issues/1251) by @frances-h
+* Multi-table should show foreign key transformers as None - Issue [#1249](https://github.com/sdv-dev/SDV/issues/1249) by @frances-h
+* Cannot use `HMASynthesizer.fit_processed_data` more than once (`KeyError`) - Issue [#1240](https://github.com/sdv-dev/SDV/issues/1240) by @frances-h
+* Function `get_available_demos` crashes if a dataset's `num-tables` or `size-MB` cannot be found - Issue [#1215](https://github.com/sdv-dev/SDV/issues/1215) by @amontanez24
+* Cannot supply a natural key to `HMASynthesizer` (where `sdtype` is custom): Error in `sample` - Issue [#1214](https://github.com/sdv-dev/SDV/issues/1214) by @pvk-developer
+* Unable to sample when using a `PseudoAnonymizedFaker` - Issue [#1207](https://github.com/sdv-dev/SDV/issues/1207) by @pvk-developer
+* Incorrect `sdtype` specified in demo dataset `student_placements_pii` - Issue [#1206](https://github.com/sdv-dev/SDV/issues/1206) by @amontanez24
+* Auto assigned transformers for datetime columns don't have the right parameters - Issue [#1204](https://github.com/sdv-dev/SDV/issues/1204) by @pvk-developer
+* Cannot apply `Inequality` constraint on demo dataset's datetime columns - Issue [#1203](https://github.com/sdv-dev/SDV/issues/1203) by @pvk-developer
+* pii should not be required to auto-assign faker transformers - Issue [#1194](https://github.com/sdv-dev/SDV/issues/1194) by @pvk-developer
+* Misc. bug fixes for SDV 1.0.0 - Issue [#1193](https://github.com/sdv-dev/SDV/issues/1193) by @pvk-developer
+* Small bug fixes in demo module - Issue [#1192](https://github.com/sdv-dev/SDV/issues/1192) by @pvk-developer
+* Foreign Keys are added as Alternate Keys when upgrading - Issue [#1143](https://github.com/sdv-dev/SDV/issues/1143) by @pvk-developer
+* Alternate keys not unique when assigned to a semantic type - Issue [#1111](https://github.com/sdv-dev/SDV/issues/1111) by @pvk-developer
+* Synthesizer errors if column is semantic type and pii is False - Issue [#1110](https://github.com/sdv-dev/SDV/issues/1110) by @fealho
+* Sampled values not unique if primary key is numerical - Issue [#1109](https://github.com/sdv-dev/SDV/issues/1109) by @pvk-developer
+* Validate not called during synthesizer creation - Issue [#1105](https://github.com/sdv-dev/SDV/issues/1105) by @pvk-developer
+* SingleTableSynthesizer fit doesn't update rounding - Issue [#1104](https://github.com/sdv-dev/SDV/issues/1104) by @amontanez24
+* Method `auto_assign_tranformers` always sets `enforce_min_max_values=True` - Issue [#1095](https://github.com/sdv-dev/SDV/issues/1095) by @fealho
+* Sampled context columns in PAR must be in the same order - Issue [#1052](https://github.com/sdv-dev/SDV/issues/1052) by @amontanez24
+* Incorrect schema version printing during detect_table_from_dataframe - Issue [#1038](https://github.com/sdv-dev/SDV/issues/1038) by @amontanez24
+* Same relationship can be added twice to MultiTableMetadata - Issue [#1031](https://github.com/sdv-dev/SDV/issues/1031) by @amontanez24
+* Miscellaneous metadata bugs - Issue [#1026](https://github.com/sdv-dev/SDV/issues/1026) by @amontanez24
+
+#### Maintenance
+
+* SDV Package Maintenance Updates - Issue [#1140](https://github.com/sdv-dev/SDV/issues/1140) by @amontanez24
+
+#### Internal
+
+* Add integration tests for 'Synthesize Sequences' demo - Issue [#1295](https://github.com/sdv-dev/SDV/issues/1295) by @pvk-developer
+* Add integration tests for 'Adding Constraints' demo - Issue [#1280](https://github.com/sdv-dev/SDV/issues/1280) by @pvk-developer
+* Add integration tests to the 'Use Your Own Data' demo - Issue [#1278](https://github.com/sdv-dev/SDV/issues/1278) by @frances-h
+* Add integration tests for 'Synthesize Multi Tables' demo - Issue [#1277](https://github.com/sdv-dev/SDV/issues/1277) by @pvk-developer
+* Add integration tests for 'Synthesize a Table' demo - Issue [#1276](https://github.com/sdv-dev/SDV/issues/1276) by @frances-h
+* Update `get_available_demos` tests - Issue [#1247](https://github.com/sdv-dev/SDV/issues/1247) by @fealho
+* Make private attributes public in the metadata - Issue [#1245](https://github.com/sdv-dev/SDV/issues/1245) by @fealho
+
 ## 0.18.0 - 2023-01-24
 
 This release adds suppport for Python 3.10 and drops support for 3.6.
 
 ### Maintenance
 
 * Drop support for python 3.6 - Issue [#1177](https://github.com/sdv-dev/SDV/issues/1177) by @amontanez24
```

### Comparing `sdv-1.0.0rc0/LICENSE` & `sdv-1.0.1.dev0/LICENSE`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/PKG-INFO` & `sdv-1.0.1.dev0/PKG-INFO`

 * *Files 27% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: sdv
-Version: 1.0.0rc0
+Version: 1.0.1.dev0
 Summary: Generate synthetic data for single table, multi table and sequential data
 Home-page: https://github.com/sdv-dev/SDV
 Author: DataCebo, Inc.
 Author-email: info@sdv.dev
 License: BSL-1.1
 Keywords: sdv synthetic-data synhtetic-data-generation timeseries single-table multi-table
 Classifier: Development Status :: 5 - Production/Stable
@@ -242,14 +242,208 @@
 [Get started using the SDV package](https://bit.ly/sdv-docs) -- a fully
 integrated solution and your one-stop shop for synthetic data. Or, use the standalone libraries
 for specific needs.
 
 
 # Release Notes
 
+## 1.0.0 - 2023-03-28
+
+This is a major release that introduces a new API to the `SDV` aimed at streamlining the process of synthetic data generation! To achieve this, this release includes the addition of several large features.
+
+### Metadata
+
+Some of the most notable additions are the new `SingleTableMetadata` and `MultiTableMetadata` classes. These classes enable a number of features that make it easier to synthesize your data correctly such as:
+
+* Automatic data detection - Calling `metadata.detect_from_dataframe()` or `metadata.detect_from_csv()` will populate the metadata autonomously with values it thinks represent the data.
+* Easy updating - Once an instance of the metadata is created, values can be easily updated using a number of methods defined in the API. For more info, view the [docs](https://docs.sdv.dev/sdv/single-table-data/data-preparation/single-table-metadata-api).
+* Metadata validation - Calling `metadata.validate()` will return a report of any invalid definitions in the metadata specification.
+* Upgrading - Users with the previous metadata format can easily update to the new specification using the `upgrade_metadata()` method.
+* Saving and loading - The metadata itself can easily be saved to a json file and loaded back up later.
+
+### Class and Module Names
+
+Another major change is the renaming of our core modeling classes and modules. The name changes are meant to highlight the difference between the underlying machine learning models, and the objects responsible for the end-to-end workflow of generating synthetic data. The main name changes are as follows:
+* `tabular` -> `single_table`
+* `relational` -> `multi_table`
+* `timeseries` -> `sequential`
+* `BaseTabularModel` -> `BaseSingleTableSynthesizer`
+* `GaussianCopula` -> `GaussianCopulaSynthesizer`
+* `CTGAN` -> `CTGANSynthesizer`
+* `TVAE` -> `TVAESynthesizer`
+* `CopulaGan` -> `CopulaGANSynthesizer`
+* `PAR` -> `PARSynthesizer`
+* `HMA1` -> `HMASynthesizer`
+
+In `SDV` 1.0, synthesizers are classes that take in metadata and handle data preprocessing, model training and model sampling. This is similar to the previous `BaseTabularModel` in `SDV` <1.0.
+
+### Synthetic Data Workflow
+
+`Synthesizers` in `SDV` 1.0 define a clear workflow for generating synthetic data.
+1. Synthesizers are initialized with a metadata class.
+2. They can then be used to transform the data and apply constraints using the `synthesizer.preprocess()` method. This step also validates that the data matches the provided metadata to avoid errors in fitting or sampling.
+3. The processed data can then be fed into the underlying machine learning model using `synthesizer.fit_processed_data()`. (Alternatively, data can be preprocessed and fit to the model using `synthesizer.fit()`.)
+4. Data can then be sampled using `synthesizer.sample()`.
+
+Each synthesizer class also provides a series of methods to help users customize the transformations their data goes through. Read more about that [here](https://docs.sdv.dev/sdv/single-table-data/modeling/synthetic-data-workflow/transform-and-anonymize).
+
+Notice that the preprocessing and model fitting steps can now be separated. This can be helpful if preprocessing is time consuming or if the data has been processed externally.
+
+### Other Highly Requested Features
+
+Another major addition is control over randomization. In `SDV` <1.0, users could set a seed to control the randomization for only some columns. In `SDV` 1.0, randomization is controlled for all columns. Every new call to sample generates new data, but the synthesizer's seed can be reset to the original state using `synthesizer.reset_randomization()`, enabling reproducibility.
+
+`SDV 1.0` adds accessibility and transparency into the transformers used for preprocessing and underlying machine learning models.
+* Using the `synthesizer.get_transformers()` method, you can access the transformers used to preprocess each column and view their properties. This can be useful for debugging and accessing privacy information like mappings used to mask data.
+* Distribution parameters learned by copula models can be accessed using the `synthesizer.get_learned_distributions()` method.
+
+PII handling is improved by the following features:
+* Primary keys can be set to natural sdtypes (eg. SSN, email, name). Previously they could only be numerical or text.
+* The `PseudoAnonymizedFaker` can be used to provide consistent mapping to PII columns. As mentioned before, the mapping itself can be accessed by viewing the transformers for the column using `synthesizer.get_transformers()`.
+* A bug causing PII columns to slow down modeling is patched.
+
+Finally, the synthetic data can now be easily evaluated using the `evaluate_quality()` and `run_diagnostic()` methods. The data can be compared visually to the actual data using the `get_column_plot()` and `get_column_pair_plot()` methods. For more info on how to visualize or interpret the synthetic data evaluation, read the docs [here](https://docs.sdv.dev/sdv/single-table-data/evaluation).
+
+### Issues Resolved
+
+#### New Features
+
+* Change auto_assign_transformers to handle id types - Issue [#1325](https://github.com/sdv-dev/SDV/issues/1325) by @pvk-developer
+* Change 'text' sdtype to 'id' - Issue [#1324](https://github.com/sdv-dev/SDV/issues/1324) by @frances-h
+* In `upgrade_metadata`, return the object instead of writing it to a JSON file - Issue [#1319](https://github.com/sdv-dev/SDV/issues/1319) by @frances-h
+* In `upgrade_metadata` index primary keys should be converted to `text` - Issue [#1318](https://github.com/sdv-dev/SDV/issues/1318) by @amontanez24
+* Add `load_from_dict` to SingleTableMetadata and MultiTableMetadata - Issue [#1314](https://github.com/sdv-dev/SDV/issues/1314) by @amontanez24
+* Throw a `SynthesizerInputError` if `FixedCombinations` constraint is applied to a column that is not `boolean` or `categorical` - Issue [#1306](https://github.com/sdv-dev/SDV/issues/1306) by @frances-h
+* Missing `save` and `load` methods for `HMASynthesizer` - Issue [#1262](https://github.com/sdv-dev/SDV/issues/1262) by @amontanez24
+* Better input validation when creating single and multi table synthesizers - Issue [#1242](https://github.com/sdv-dev/SDV/issues/1242) by @fealho
+* Better input validation on `HMASynthesizer.sample` - Issue [#1241](https://github.com/sdv-dev/SDV/issues/1241) by @R-Palazzo
+* Validate that relationship must be between a `primary key` and `foreign key` - Issue [#1236](https://github.com/sdv-dev/SDV/issues/1236) by @fealho
+* Improve `update_column` validation for `pii` attribute - Issue [#1226](https://github.com/sdv-dev/SDV/issues/1226) by @pvk-developer
+* Order the output of `get_transformers()` based on the metadata - Issue [#1222](https://github.com/sdv-dev/SDV/issues/1222) by @pvk-developer
+* Log if any `numerical_distributions` will not be applied - Issue [#1212](https://github.com/sdv-dev/SDV/issues/1212) by @fealho
+* Improve error handling for `GaussianCopulaSynthesizer`: `numerical_distributions` - Issue [#1211](https://github.com/sdv-dev/SDV/issues/1211) by @fealho
+* Improve error handling when validating `constraints` - Issue [#1210](https://github.com/sdv-dev/SDV/issues/1210) by @fealho
+* Add `fake_companies` demo - Issue [#1209](https://github.com/sdv-dev/SDV/issues/1209) by @amontanez24
+* Allow me to create a custom constraint class and use it in the same file - Issue [#1205](https://github.com/sdv-dev/SDV/issues/1205) by @amontanez24
+* Sampling should reset after retraining the model - Issue [#1201](https://github.com/sdv-dev/SDV/issues/1201) by @pvk-developer
+* Change function name `HMASynthesizer.update_table_parameters` --> `set_table_parameters` - Issue [#1200](https://github.com/sdv-dev/SDV/issues/1200) by @pvk-developer
+* Add `get_info` method to synthesizers - Issue [#1199](https://github.com/sdv-dev/SDV/issues/1199) by @fealho
+* Add evaluation methods to synthesizer - Issue [#1190](https://github.com/sdv-dev/SDV/issues/1190) by @fealho
+* Update `evaluate.py` to work with the new `metadata` - Issue [#1186](https://github.com/sdv-dev/SDV/issues/1186) by @fealho
+* Remove old code - Issue [#1181](https://github.com/sdv-dev/SDV/issues/1181) by @pvk-developer
+* Drop support for python 3.6 and add support for 3.10 - Issue [#1176](https://github.com/sdv-dev/SDV/issues/1176) by @fealho
+* Add constraint methods to MultiTableSynthesizers - Issue [#1171](https://github.com/sdv-dev/SDV/issues/1171) by @fealho
+* Update custom constraint workflow - Issue [#1169](https://github.com/sdv-dev/SDV/issues/1169) by @pvk-developer
+* Add get_constraints method to synthesizers - Issue [#1168](https://github.com/sdv-dev/SDV/issues/1168) by @pvk-developer
+* Migrate adding and validating constraints to BaseSynthesizer - Issue [#1163](https://github.com/sdv-dev/SDV/issues/1163) by @pvk-developer
+* Change metadata `"SCHEMA_VERSION"` --> `"METADATA_SPEC_VERSION"` - Issue [#1139](https://github.com/sdv-dev/SDV/issues/1139) by @amontanez24
+* Add ability to reset random sampling - Issue [#1130](https://github.com/sdv-dev/SDV/issues/1130) by @pvk-developer
+* Add get_available_demos - Issue [#1129](https://github.com/sdv-dev/SDV/issues/1129) by @fealho
+* Add demo loading functionality - Issue [#1128](https://github.com/sdv-dev/SDV/issues/1128) by @fealho
+* Use logging instead of printing in detect methods - Issue [#1107](https://github.com/sdv-dev/SDV/issues/1107) by @fealho
+* Add save and load methods to synthesizers - Issue [#1106](https://github.com/sdv-dev/SDV/issues/1106) by @pvk-developer
+* Add sampling methods to PARSynthesizer - Issue [#1083](https://github.com/sdv-dev/SDV/issues/1083) by @amontanez24
+* Add transformer methods to PARSynthesizer - Issue [#1082](https://github.com/sdv-dev/SDV/issues/1082) by @fealho
+* Add validate to PARSynthesizer - Issue [#1081](https://github.com/sdv-dev/SDV/issues/1081) by @amontanez24
+* Add preprocess and fit methods to PARSynthesizer - Issue [#1080](https://github.com/sdv-dev/SDV/issues/1080) by @amontanez24
+* Create SingleTablePreset - Issue [#1079](https://github.com/sdv-dev/SDV/issues/1079) by @amontanez24
+* Add sample method to multi-table synthesizers - Issue [#1078](https://github.com/sdv-dev/SDV/issues/1078) by @pvk-developer
+* Add get_learned_distributions method to synthesizers - Issue [#1075](https://github.com/sdv-dev/SDV/issues/1075) by @pvk-developer
+* Add preprocess and fit methods to multi-table synthesizers - Issue [#1074](https://github.com/sdv-dev/SDV/issues/1074) by @pvk-developer
+* Add transformer related methods to BaseMultiTableSynthesizer - Issue [#1072](https://github.com/sdv-dev/SDV/issues/1072) by @fealho
+* Add validate method to `BaseMultiTableSynthesizer` - Issue [#1071](https://github.com/sdv-dev/SDV/issues/1071) by @pvk-developer
+* Create BaseMultiTableSynthesizer and HMASynthesizer classes - Issue [#1070](https://github.com/sdv-dev/SDV/issues/1070) by @pvk-developer
+* Create PARSynthesizer - Issue [#1055](https://github.com/sdv-dev/SDV/issues/1055) by @amontanez24
+* Raise an error if an invalid sdtype is provided to the metadata - Issue [#1042](https://github.com/sdv-dev/SDV/issues/1042) by @amontanez24
+* Only allow datetime and numerical sdtypes to be set as the sequence index - Issue [#1030](https://github.com/sdv-dev/SDV/issues/1030) by @amontanez24
+* Change set_alternate_keys to add_alternate_keys and add error handling - Issue [#1029](https://github.com/sdv-dev/SDV/issues/1029) by @amontanez24
+* Create `MultiTableMetadata.add_table` method - Issue [#1024](https://github.com/sdv-dev/SDV/issues/1024) by @amontanez24
+* Add update_transformers to synthesizers - Issue [#1021](https://github.com/sdv-dev/SDV/issues/1021) by @fealho
+* Add assign_transformers and get_transformers methods to synthesizers - Issue [#1020](https://github.com/sdv-dev/SDV/issues/1020) by @pvk-developer
+* Add fit and fit_processed_data methods to synthesizers - Issue [#1019](https://github.com/sdv-dev/SDV/issues/1019) by @pvk-developer
+* Add preprocess method to synthesizers - Issue [#1018](https://github.com/sdv-dev/SDV/issues/1018) by @pvk-developer
+* Add sampling to synthesizer classes - Issue [#1015](https://github.com/sdv-dev/SDV/issues/1015) by @pvk-developer
+* Add validate method to synthesizer - Issue [#1014](https://github.com/sdv-dev/SDV/issues/1014) by @fealho
+* Create GaussianCopula, CTGAN, TVAE and CopulaGAN synthesizer classes - Issue [#1013](https://github.com/sdv-dev/SDV/issues/1013) by @pvk-developer
+* Create BaseSynthesizer class - Issue [#1012](https://github.com/sdv-dev/SDV/issues/1012) by @pvk-developer
+* Add constraint conversion to upgrade_metadata - Issue [#1005](https://github.com/sdv-dev/SDV/issues/1005) by @amontanez24
+* Add method to generate keys to DataProcessor - Issue [#994](https://github.com/sdv-dev/SDV/issues/994) by @pvk-developer
+* Create formatter - Issue [#970](https://github.com/sdv-dev/SDV/issues/970) by @fealho
+* Create a utility to load multiple CSV files at once - Issue [#969](https://github.com/sdv-dev/SDV/issues/969) by @amontanez24
+* Create a utility to convert old --> new metadata format - Issue [#966](https://github.com/sdv-dev/SDV/issues/966) by @amontanez24
+* Add validation check that `primary_key`, `alternate_keys` and `sequence_key` cannot be sdtype categorical - Issue [#963](https://github.com/sdv-dev/SDV/issues/963) by @fealho
+* Add anonymization to DataProcessor - Issue [#950](https://github.com/sdv-dev/SDV/issues/950) by @pvk-developer
+* Add utility methods to DataProcessor - Issue [#948](https://github.com/sdv-dev/SDV/issues/948) by @fealho
+* Add fit, transform and reverse_transform to DataProcessor - Issue [#947](https://github.com/sdv-dev/SDV/issues/947) by @amontanez24
+* Create DataProcessor class - Issue [#946](https://github.com/sdv-dev/SDV/issues/946) by @amontanez24
+* Add add_constraint method to MultiTableMetadata - Issue [#895](https://github.com/sdv-dev/SDV/issues/895) by @amontanez24
+* Add key related methods to MultiTableMetadata - Issue [#894](https://github.com/sdv-dev/SDV/issues/894) by @fealho
+* Add update_column and add_column methods to MultiTableMetadata - Issue [#893](https://github.com/sdv-dev/SDV/issues/893) by @amontanez24
+* Add detect methods to MultiTableMetadata - Issue [#892](https://github.com/sdv-dev/SDV/issues/892) by @amontanez24
+* Add load_from_json and save_to_json methods to the MultiTableMetadata - Issue [#891](https://github.com/sdv-dev/SDV/issues/891) by @fealho
+* Add add_relationship method to MultiTableMetadata - Issue [#890](https://github.com/sdv-dev/SDV/issues/890) by @pvk-developer
+* Add validate method to MultiTableMetadata - Issue [#888](https://github.com/sdv-dev/SDV/issues/888) by @pvk-developer
+* Add visualize method to MultiTableMetadata class - Issue [#884](https://github.com/sdv-dev/SDV/issues/884) by @amontanez24
+* Create MultiTableMetadata class - Issue [#883](https://github.com/sdv-dev/SDV/issues/883) by @pvk-developer
+* Add add_constraint method to SingleTableMetadata - Issue [#881](https://github.com/sdv-dev/SDV/issues/881) by @amontanez24
+* Add key related methods to SingleTableMetadata - Issue [#880](https://github.com/sdv-dev/SDV/issues/880) by @fealho
+* Add validate method to SingleTableMetadata - Issue [#879](https://github.com/sdv-dev/SDV/issues/879) by @fealho
+* Add _validate_inputs class method to each constraint - Issue [#878](https://github.com/sdv-dev/SDV/issues/878) by @fealho
+* Add update_column and add_column methods to SingleTableMetadata - Issue [#877](https://github.com/sdv-dev/SDV/issues/877) by @pvk-developer
+* Add detect methods to SingleTableMetadata - Issue [#876](https://github.com/sdv-dev/SDV/issues/876) by @pvk-developer
+* Add load_from_json and save_to_json methods to SingleTableMetadata - Issue [#874](https://github.com/sdv-dev/SDV/issues/874) by @pvk-developer
+* Create SingleTableMetadata class - Issue [#873](https://github.com/sdv-dev/SDV/issues/873) by @pvk-developer
+
+#### Bugs Fixed
+
+* In `upgrade_metadata`, PII values are being converted to generic categorical columns - Issue [#1317](https://github.com/sdv-dev/SDV/issues/1317) by @frances-h
+* `PARSynthesizer` is missing `save` and `load` methods - Issue [#1289](https://github.com/sdv-dev/SDV/issues/1289) by @amontanez24
+* Confusing warning when updating transformers - Issue [#1272](https://github.com/sdv-dev/SDV/issues/1272) by @frances-h
+* When adding constraints, `auto_assign_transformers` is showing columns that should no longer exist - Issue [#1260](https://github.com/sdv-dev/SDV/issues/1260) by @pvk-developer
+* Cannot fit twice if I modify transformers: `ValueError: There are non-numerical values in your data.` - Issue [#1259](https://github.com/sdv-dev/SDV/issues/1259) by @frances-h
+* Cannot fit twice if I add constraints: `ValueError: There are non-numerical values in your data.` - Issue [#1258](https://github.com/sdv-dev/SDV/issues/1258) by @frances-h
+* `HMASynthesizer` errors out when fitting a dataset that has a table which holds primary key and foreign keys only - Issue [#1257](https://github.com/sdv-dev/SDV/issues/1257) by @pvk-developer
+* Change ValueErrors to InvalidMetadataErrors - Issue [#1251](https://github.com/sdv-dev/SDV/issues/1251) by @frances-h
+* Multi-table should show foreign key transformers as None - Issue [#1249](https://github.com/sdv-dev/SDV/issues/1249) by @frances-h
+* Cannot use `HMASynthesizer.fit_processed_data` more than once (`KeyError`) - Issue [#1240](https://github.com/sdv-dev/SDV/issues/1240) by @frances-h
+* Function `get_available_demos` crashes if a dataset's `num-tables` or `size-MB` cannot be found - Issue [#1215](https://github.com/sdv-dev/SDV/issues/1215) by @amontanez24
+* Cannot supply a natural key to `HMASynthesizer` (where `sdtype` is custom): Error in `sample` - Issue [#1214](https://github.com/sdv-dev/SDV/issues/1214) by @pvk-developer
+* Unable to sample when using a `PseudoAnonymizedFaker` - Issue [#1207](https://github.com/sdv-dev/SDV/issues/1207) by @pvk-developer
+* Incorrect `sdtype` specified in demo dataset `student_placements_pii` - Issue [#1206](https://github.com/sdv-dev/SDV/issues/1206) by @amontanez24
+* Auto assigned transformers for datetime columns don't have the right parameters - Issue [#1204](https://github.com/sdv-dev/SDV/issues/1204) by @pvk-developer
+* Cannot apply `Inequality` constraint on demo dataset's datetime columns - Issue [#1203](https://github.com/sdv-dev/SDV/issues/1203) by @pvk-developer
+* pii should not be required to auto-assign faker transformers - Issue [#1194](https://github.com/sdv-dev/SDV/issues/1194) by @pvk-developer
+* Misc. bug fixes for SDV 1.0.0 - Issue [#1193](https://github.com/sdv-dev/SDV/issues/1193) by @pvk-developer
+* Small bug fixes in demo module - Issue [#1192](https://github.com/sdv-dev/SDV/issues/1192) by @pvk-developer
+* Foreign Keys are added as Alternate Keys when upgrading - Issue [#1143](https://github.com/sdv-dev/SDV/issues/1143) by @pvk-developer
+* Alternate keys not unique when assigned to a semantic type - Issue [#1111](https://github.com/sdv-dev/SDV/issues/1111) by @pvk-developer
+* Synthesizer errors if column is semantic type and pii is False - Issue [#1110](https://github.com/sdv-dev/SDV/issues/1110) by @fealho
+* Sampled values not unique if primary key is numerical - Issue [#1109](https://github.com/sdv-dev/SDV/issues/1109) by @pvk-developer
+* Validate not called during synthesizer creation - Issue [#1105](https://github.com/sdv-dev/SDV/issues/1105) by @pvk-developer
+* SingleTableSynthesizer fit doesn't update rounding - Issue [#1104](https://github.com/sdv-dev/SDV/issues/1104) by @amontanez24
+* Method `auto_assign_tranformers` always sets `enforce_min_max_values=True` - Issue [#1095](https://github.com/sdv-dev/SDV/issues/1095) by @fealho
+* Sampled context columns in PAR must be in the same order - Issue [#1052](https://github.com/sdv-dev/SDV/issues/1052) by @amontanez24
+* Incorrect schema version printing during detect_table_from_dataframe - Issue [#1038](https://github.com/sdv-dev/SDV/issues/1038) by @amontanez24
+* Same relationship can be added twice to MultiTableMetadata - Issue [#1031](https://github.com/sdv-dev/SDV/issues/1031) by @amontanez24
+* Miscellaneous metadata bugs - Issue [#1026](https://github.com/sdv-dev/SDV/issues/1026) by @amontanez24
+
+#### Maintenance
+
+* SDV Package Maintenance Updates - Issue [#1140](https://github.com/sdv-dev/SDV/issues/1140) by @amontanez24
+
+#### Internal
+
+* Add integration tests for 'Synthesize Sequences' demo - Issue [#1295](https://github.com/sdv-dev/SDV/issues/1295) by @pvk-developer
+* Add integration tests for 'Adding Constraints' demo - Issue [#1280](https://github.com/sdv-dev/SDV/issues/1280) by @pvk-developer
+* Add integration tests to the 'Use Your Own Data' demo - Issue [#1278](https://github.com/sdv-dev/SDV/issues/1278) by @frances-h
+* Add integration tests for 'Synthesize Multi Tables' demo - Issue [#1277](https://github.com/sdv-dev/SDV/issues/1277) by @pvk-developer
+* Add integration tests for 'Synthesize a Table' demo - Issue [#1276](https://github.com/sdv-dev/SDV/issues/1276) by @frances-h
+* Update `get_available_demos` tests - Issue [#1247](https://github.com/sdv-dev/SDV/issues/1247) by @fealho
+* Make private attributes public in the metadata - Issue [#1245](https://github.com/sdv-dev/SDV/issues/1245) by @fealho
+
 ## 0.18.0 - 2023-01-24
 
 This release adds suppport for Python 3.10 and drops support for 3.6.
 
 ### Maintenance
 
 * Drop support for python 3.6 - Issue [#1177](https://github.com/sdv-dev/SDV/issues/1177) by @amontanez24
```

#### html2text {}

```diff
@@ -1,8 +1,8 @@
-Metadata-Version: 2.1 Name: sdv Version: 1.0.0rc0 Summary: Generate synthetic
+Metadata-Version: 2.1 Name: sdv Version: 1.0.1.dev0 Summary: Generate synthetic
 data for single table, multi table and sequential data Home-page: https://
 github.com/sdv-dev/SDV Author: DataCebo, Inc. Author-email: info@sdv.dev
 License: BSL-1.1 Keywords: sdv synthetic-data synhtetic-data-generation
 timeseries single-table multi-table Classifier: Development Status :: 5 -
 Production/Stable Classifier: Intended Audience :: Developers Classifier:
 License :: Free for non-commercial use Classifier: Natural Language :: English
 Classifier: Programming Language :: Python :: 3 Classifier: Programming
@@ -131,37 +131,318 @@
 including: *  Data discovery & transformation. Reverse the transforms to
 reproduce realistic data. *  Multiple machine learning models -- ranging
 from Copulas to Deep Learning -- to create tabular, multi table and time series
 data. *  Measuring quality and privacy of synthetic data, and comparing
 different synthetic data generation models. [Get started using the SDV package]
 (https://bit.ly/sdv-docs) -- a fully integrated solution and your one-stop shop
 for synthetic data. Or, use the standalone libraries for specific needs. #
-Release Notes ## 0.18.0 - 2023-01-24 This release adds suppport for Python 3.10
-and drops support for 3.6. ### Maintenance * Drop support for python 3.6 -
-Issue [#1177](https://github.com/sdv-dev/SDV/issues/1177) by @amontanez24 *
-Support for python 3.10 - Issue [#939](https://github.com/sdv-dev/SDV/issues/
-939) by @amontanez24 * Support Python >=3.10,<4 - Issue [#1000](https://
-github.com/sdv-dev/SDV/issues/1000) by @amontanez24 ## 0.17.2 - 2022-12-08 This
-release fixes a bug in the demo module related to loading the demo data with
-constraints. It also adds a name to the demo datasets. Finally, it bumps the
-version of `SDMetrics` used. ### Maintenance * Upgrade SDMetrics requirement to
-0.8.0 - Issue [#1125](https://github.com/sdv-dev/SDV/issues/1125) by @katxiao
-### New Features * Provide a name for the default demo datasets - Issue [#1124]
-(https://github.com/sdv-dev/SDV/issues/1124) by @amontanez24 ### Bugs Fixed *
-Cannot load_tabular_demo with metadata - Issue [#1123](https://github.com/sdv-
-dev/SDV/issues/1123) by @amontanez24 ## 0.17.1 - 2022-09-29 This release bumps
-the dependency requirements to use the latest version of `SDMetrics`. ###
-Maintenance * Patch release: Bump required version for SDMetrics - Issue
-[#1010](https://github.com/sdv-dev/SDV/issues/1010) by @katxiao ## 0.17.0 -
-2022-09-09 This release updates the code to use RDT version 1.2.0 and greater,
-so that those new features are now available in SDV. This changes the
-transformers that are available in SDV models to be those that are in RDT
-version 1.2.0. As a result, some arguments for initializing models have
-changed. Additionally, this release fixes bugs related to loading models with
-custom constraints. It also fixes a bug that added `NaNs` to the index of
+Release Notes ## 1.0.0 - 2023-03-28 This is a major release that introduces a
+new API to the `SDV` aimed at streamlining the process of synthetic data
+generation! To achieve this, this release includes the addition of several
+large features. ### Metadata Some of the most notable additions are the new
+`SingleTableMetadata` and `MultiTableMetadata` classes. These classes enable a
+number of features that make it easier to synthesize your data correctly such
+as: * Automatic data detection - Calling `metadata.detect_from_dataframe()` or
+`metadata.detect_from_csv()` will populate the metadata autonomously with
+values it thinks represent the data. * Easy updating - Once an instance of the
+metadata is created, values can be easily updated using a number of methods
+defined in the API. For more info, view the [docs](https://docs.sdv.dev/sdv/
+single-table-data/data-preparation/single-table-metadata-api). * Metadata
+validation - Calling `metadata.validate()` will return a report of any invalid
+definitions in the metadata specification. * Upgrading - Users with the
+previous metadata format can easily update to the new specification using the
+`upgrade_metadata()` method. * Saving and loading - The metadata itself can
+easily be saved to a json file and loaded back up later. ### Class and Module
+Names Another major change is the renaming of our core modeling classes and
+modules. The name changes are meant to highlight the difference between the
+underlying machine learning models, and the objects responsible for the end-to-
+end workflow of generating synthetic data. The main name changes are as
+follows: * `tabular` -> `single_table` * `relational` -> `multi_table` *
+`timeseries` -> `sequential` * `BaseTabularModel` -
+> `BaseSingleTableSynthesizer` * `GaussianCopula` -
+> `GaussianCopulaSynthesizer` * `CTGAN` -> `CTGANSynthesizer` * `TVAE` -
+> `TVAESynthesizer` * `CopulaGan` -> `CopulaGANSynthesizer` * `PAR` -
+> `PARSynthesizer` * `HMA1` -> `HMASynthesizer` In `SDV` 1.0, synthesizers are
+classes that take in metadata and handle data preprocessing, model training and
+model sampling. This is similar to the previous `BaseTabularModel` in `SDV`
+<1.0. ### Synthetic Data Workflow `Synthesizers` in `SDV` 1.0 define a clear
+workflow for generating synthetic data. 1. Synthesizers are initialized with a
+metadata class. 2. They can then be used to transform the data and apply
+constraints using the `synthesizer.preprocess()` method. This step also
+validates that the data matches the provided metadata to avoid errors in
+fitting or sampling. 3. The processed data can then be fed into the underlying
+machine learning model using `synthesizer.fit_processed_data()`.
+(Alternatively, data can be preprocessed and fit to the model using
+`synthesizer.fit()`.) 4. Data can then be sampled using `synthesizer.sample()`.
+Each synthesizer class also provides a series of methods to help users
+customize the transformations their data goes through. Read more about that
+[here](https://docs.sdv.dev/sdv/single-table-data/modeling/synthetic-data-
+workflow/transform-and-anonymize). Notice that the preprocessing and model
+fitting steps can now be separated. This can be helpful if preprocessing is
+time consuming or if the data has been processed externally. ### Other Highly
+Requested Features Another major addition is control over randomization. In
+`SDV` <1.0, users could set a seed to control the randomization for only some
+columns. In `SDV` 1.0, randomization is controlled for all columns. Every new
+call to sample generates new data, but the synthesizer's seed can be reset to
+the original state using `synthesizer.reset_randomization()`, enabling
+reproducibility. `SDV 1.0` adds accessibility and transparency into the
+transformers used for preprocessing and underlying machine learning models. *
+Using the `synthesizer.get_transformers()` method, you can access the
+transformers used to preprocess each column and view their properties. This can
+be useful for debugging and accessing privacy information like mappings used to
+mask data. * Distribution parameters learned by copula models can be accessed
+using the `synthesizer.get_learned_distributions()` method. PII handling is
+improved by the following features: * Primary keys can be set to natural
+sdtypes (eg. SSN, email, name). Previously they could only be numerical or
+text. * The `PseudoAnonymizedFaker` can be used to provide consistent mapping
+to PII columns. As mentioned before, the mapping itself can be accessed by
+viewing the transformers for the column using `synthesizer.get_transformers()`.
+* A bug causing PII columns to slow down modeling is patched. Finally, the
+synthetic data can now be easily evaluated using the `evaluate_quality()` and
+`run_diagnostic()` methods. The data can be compared visually to the actual
+data using the `get_column_plot()` and `get_column_pair_plot()` methods. For
+more info on how to visualize or interpret the synthetic data evaluation, read
+the docs [here](https://docs.sdv.dev/sdv/single-table-data/evaluation). ###
+Issues Resolved #### New Features * Change auto_assign_transformers to handle
+id types - Issue [#1325](https://github.com/sdv-dev/SDV/issues/1325) by @pvk-
+developer * Change 'text' sdtype to 'id' - Issue [#1324](https://github.com/
+sdv-dev/SDV/issues/1324) by @frances-h * In `upgrade_metadata`, return the
+object instead of writing it to a JSON file - Issue [#1319](https://github.com/
+sdv-dev/SDV/issues/1319) by @frances-h * In `upgrade_metadata` index primary
+keys should be converted to `text` - Issue [#1318](https://github.com/sdv-dev/
+SDV/issues/1318) by @amontanez24 * Add `load_from_dict` to SingleTableMetadata
+and MultiTableMetadata - Issue [#1314](https://github.com/sdv-dev/SDV/issues/
+1314) by @amontanez24 * Throw a `SynthesizerInputError` if `FixedCombinations`
+constraint is applied to a column that is not `boolean` or `categorical` -
+Issue [#1306](https://github.com/sdv-dev/SDV/issues/1306) by @frances-h *
+Missing `save` and `load` methods for `HMASynthesizer` - Issue [#1262](https://
+github.com/sdv-dev/SDV/issues/1262) by @amontanez24 * Better input validation
+when creating single and multi table synthesizers - Issue [#1242](https://
+github.com/sdv-dev/SDV/issues/1242) by @fealho * Better input validation on
+`HMASynthesizer.sample` - Issue [#1241](https://github.com/sdv-dev/SDV/issues/
+1241) by @R-Palazzo * Validate that relationship must be between a `primary
+key` and `foreign key` - Issue [#1236](https://github.com/sdv-dev/SDV/issues/
+1236) by @fealho * Improve `update_column` validation for `pii` attribute -
+Issue [#1226](https://github.com/sdv-dev/SDV/issues/1226) by @pvk-developer *
+Order the output of `get_transformers()` based on the metadata - Issue [#1222]
+(https://github.com/sdv-dev/SDV/issues/1222) by @pvk-developer * Log if any
+`numerical_distributions` will not be applied - Issue [#1212](https://
+github.com/sdv-dev/SDV/issues/1212) by @fealho * Improve error handling for
+`GaussianCopulaSynthesizer`: `numerical_distributions` - Issue [#1211](https://
+github.com/sdv-dev/SDV/issues/1211) by @fealho * Improve error handling when
+validating `constraints` - Issue [#1210](https://github.com/sdv-dev/SDV/issues/
+1210) by @fealho * Add `fake_companies` demo - Issue [#1209](https://
+github.com/sdv-dev/SDV/issues/1209) by @amontanez24 * Allow me to create a
+custom constraint class and use it in the same file - Issue [#1205](https://
+github.com/sdv-dev/SDV/issues/1205) by @amontanez24 * Sampling should reset
+after retraining the model - Issue [#1201](https://github.com/sdv-dev/SDV/
+issues/1201) by @pvk-developer * Change function name
+`HMASynthesizer.update_table_parameters` --> `set_table_parameters` - Issue
+[#1200](https://github.com/sdv-dev/SDV/issues/1200) by @pvk-developer * Add
+`get_info` method to synthesizers - Issue [#1199](https://github.com/sdv-dev/
+SDV/issues/1199) by @fealho * Add evaluation methods to synthesizer - Issue
+[#1190](https://github.com/sdv-dev/SDV/issues/1190) by @fealho * Update
+`evaluate.py` to work with the new `metadata` - Issue [#1186](https://
+github.com/sdv-dev/SDV/issues/1186) by @fealho * Remove old code - Issue
+[#1181](https://github.com/sdv-dev/SDV/issues/1181) by @pvk-developer * Drop
+support for python 3.6 and add support for 3.10 - Issue [#1176](https://
+github.com/sdv-dev/SDV/issues/1176) by @fealho * Add constraint methods to
+MultiTableSynthesizers - Issue [#1171](https://github.com/sdv-dev/SDV/issues/
+1171) by @fealho * Update custom constraint workflow - Issue [#1169](https://
+github.com/sdv-dev/SDV/issues/1169) by @pvk-developer * Add get_constraints
+method to synthesizers - Issue [#1168](https://github.com/sdv-dev/SDV/issues/
+1168) by @pvk-developer * Migrate adding and validating constraints to
+BaseSynthesizer - Issue [#1163](https://github.com/sdv-dev/SDV/issues/1163) by
+@pvk-developer * Change metadata `"SCHEMA_VERSION"` --
+> `"METADATA_SPEC_VERSION"` - Issue [#1139](https://github.com/sdv-dev/SDV/
+issues/1139) by @amontanez24 * Add ability to reset random sampling - Issue
+[#1130](https://github.com/sdv-dev/SDV/issues/1130) by @pvk-developer * Add
+get_available_demos - Issue [#1129](https://github.com/sdv-dev/SDV/issues/1129)
+by @fealho * Add demo loading functionality - Issue [#1128](https://github.com/
+sdv-dev/SDV/issues/1128) by @fealho * Use logging instead of printing in detect
+methods - Issue [#1107](https://github.com/sdv-dev/SDV/issues/1107) by @fealho
+* Add save and load methods to synthesizers - Issue [#1106](https://github.com/
+sdv-dev/SDV/issues/1106) by @pvk-developer * Add sampling methods to
+PARSynthesizer - Issue [#1083](https://github.com/sdv-dev/SDV/issues/1083) by
+@amontanez24 * Add transformer methods to PARSynthesizer - Issue [#1082](https:
+//github.com/sdv-dev/SDV/issues/1082) by @fealho * Add validate to
+PARSynthesizer - Issue [#1081](https://github.com/sdv-dev/SDV/issues/1081) by
+@amontanez24 * Add preprocess and fit methods to PARSynthesizer - Issue [#1080]
+(https://github.com/sdv-dev/SDV/issues/1080) by @amontanez24 * Create
+SingleTablePreset - Issue [#1079](https://github.com/sdv-dev/SDV/issues/1079)
+by @amontanez24 * Add sample method to multi-table synthesizers - Issue [#1078]
+(https://github.com/sdv-dev/SDV/issues/1078) by @pvk-developer * Add
+get_learned_distributions method to synthesizers - Issue [#1075](https://
+github.com/sdv-dev/SDV/issues/1075) by @pvk-developer * Add preprocess and fit
+methods to multi-table synthesizers - Issue [#1074](https://github.com/sdv-dev/
+SDV/issues/1074) by @pvk-developer * Add transformer related methods to
+BaseMultiTableSynthesizer - Issue [#1072](https://github.com/sdv-dev/SDV/
+issues/1072) by @fealho * Add validate method to `BaseMultiTableSynthesizer` -
+Issue [#1071](https://github.com/sdv-dev/SDV/issues/1071) by @pvk-developer *
+Create BaseMultiTableSynthesizer and HMASynthesizer classes - Issue [#1070]
+(https://github.com/sdv-dev/SDV/issues/1070) by @pvk-developer * Create
+PARSynthesizer - Issue [#1055](https://github.com/sdv-dev/SDV/issues/1055) by
+@amontanez24 * Raise an error if an invalid sdtype is provided to the metadata
+- Issue [#1042](https://github.com/sdv-dev/SDV/issues/1042) by @amontanez24 *
+Only allow datetime and numerical sdtypes to be set as the sequence index -
+Issue [#1030](https://github.com/sdv-dev/SDV/issues/1030) by @amontanez24 *
+Change set_alternate_keys to add_alternate_keys and add error handling - Issue
+[#1029](https://github.com/sdv-dev/SDV/issues/1029) by @amontanez24 * Create
+`MultiTableMetadata.add_table` method - Issue [#1024](https://github.com/sdv-
+dev/SDV/issues/1024) by @amontanez24 * Add update_transformers to synthesizers
+- Issue [#1021](https://github.com/sdv-dev/SDV/issues/1021) by @fealho * Add
+assign_transformers and get_transformers methods to synthesizers - Issue
+[#1020](https://github.com/sdv-dev/SDV/issues/1020) by @pvk-developer * Add fit
+and fit_processed_data methods to synthesizers - Issue [#1019](https://
+github.com/sdv-dev/SDV/issues/1019) by @pvk-developer * Add preprocess method
+to synthesizers - Issue [#1018](https://github.com/sdv-dev/SDV/issues/1018) by
+@pvk-developer * Add sampling to synthesizer classes - Issue [#1015](https://
+github.com/sdv-dev/SDV/issues/1015) by @pvk-developer * Add validate method to
+synthesizer - Issue [#1014](https://github.com/sdv-dev/SDV/issues/1014) by
+@fealho * Create GaussianCopula, CTGAN, TVAE and CopulaGAN synthesizer classes
+- Issue [#1013](https://github.com/sdv-dev/SDV/issues/1013) by @pvk-developer *
+Create BaseSynthesizer class - Issue [#1012](https://github.com/sdv-dev/SDV/
+issues/1012) by @pvk-developer * Add constraint conversion to upgrade_metadata
+- Issue [#1005](https://github.com/sdv-dev/SDV/issues/1005) by @amontanez24 *
+Add method to generate keys to DataProcessor - Issue [#994](https://github.com/
+sdv-dev/SDV/issues/994) by @pvk-developer * Create formatter - Issue [#970]
+(https://github.com/sdv-dev/SDV/issues/970) by @fealho * Create a utility to
+load multiple CSV files at once - Issue [#969](https://github.com/sdv-dev/SDV/
+issues/969) by @amontanez24 * Create a utility to convert old --> new metadata
+format - Issue [#966](https://github.com/sdv-dev/SDV/issues/966) by
+@amontanez24 * Add validation check that `primary_key`, `alternate_keys` and
+`sequence_key` cannot be sdtype categorical - Issue [#963](https://github.com/
+sdv-dev/SDV/issues/963) by @fealho * Add anonymization to DataProcessor - Issue
+[#950](https://github.com/sdv-dev/SDV/issues/950) by @pvk-developer * Add
+utility methods to DataProcessor - Issue [#948](https://github.com/sdv-dev/SDV/
+issues/948) by @fealho * Add fit, transform and reverse_transform to
+DataProcessor - Issue [#947](https://github.com/sdv-dev/SDV/issues/947) by
+@amontanez24 * Create DataProcessor class - Issue [#946](https://github.com/
+sdv-dev/SDV/issues/946) by @amontanez24 * Add add_constraint method to
+MultiTableMetadata - Issue [#895](https://github.com/sdv-dev/SDV/issues/895) by
+@amontanez24 * Add key related methods to MultiTableMetadata - Issue [#894]
+(https://github.com/sdv-dev/SDV/issues/894) by @fealho * Add update_column and
+add_column methods to MultiTableMetadata - Issue [#893](https://github.com/sdv-
+dev/SDV/issues/893) by @amontanez24 * Add detect methods to MultiTableMetadata
+- Issue [#892](https://github.com/sdv-dev/SDV/issues/892) by @amontanez24 * Add
+load_from_json and save_to_json methods to the MultiTableMetadata - Issue
+[#891](https://github.com/sdv-dev/SDV/issues/891) by @fealho * Add
+add_relationship method to MultiTableMetadata - Issue [#890](https://
+github.com/sdv-dev/SDV/issues/890) by @pvk-developer * Add validate method to
+MultiTableMetadata - Issue [#888](https://github.com/sdv-dev/SDV/issues/888) by
+@pvk-developer * Add visualize method to MultiTableMetadata class - Issue
+[#884](https://github.com/sdv-dev/SDV/issues/884) by @amontanez24 * Create
+MultiTableMetadata class - Issue [#883](https://github.com/sdv-dev/SDV/issues/
+883) by @pvk-developer * Add add_constraint method to SingleTableMetadata -
+Issue [#881](https://github.com/sdv-dev/SDV/issues/881) by @amontanez24 * Add
+key related methods to SingleTableMetadata - Issue [#880](https://github.com/
+sdv-dev/SDV/issues/880) by @fealho * Add validate method to SingleTableMetadata
+- Issue [#879](https://github.com/sdv-dev/SDV/issues/879) by @fealho * Add
+_validate_inputs class method to each constraint - Issue [#878](https://
+github.com/sdv-dev/SDV/issues/878) by @fealho * Add update_column and
+add_column methods to SingleTableMetadata - Issue [#877](https://github.com/
+sdv-dev/SDV/issues/877) by @pvk-developer * Add detect methods to
+SingleTableMetadata - Issue [#876](https://github.com/sdv-dev/SDV/issues/876)
+by @pvk-developer * Add load_from_json and save_to_json methods to
+SingleTableMetadata - Issue [#874](https://github.com/sdv-dev/SDV/issues/874)
+by @pvk-developer * Create SingleTableMetadata class - Issue [#873](https://
+github.com/sdv-dev/SDV/issues/873) by @pvk-developer #### Bugs Fixed * In
+`upgrade_metadata`, PII values are being converted to generic categorical
+columns - Issue [#1317](https://github.com/sdv-dev/SDV/issues/1317) by
+@frances-h * `PARSynthesizer` is missing `save` and `load` methods - Issue
+[#1289](https://github.com/sdv-dev/SDV/issues/1289) by @amontanez24 * Confusing
+warning when updating transformers - Issue [#1272](https://github.com/sdv-dev/
+SDV/issues/1272) by @frances-h * When adding constraints,
+`auto_assign_transformers` is showing columns that should no longer exist -
+Issue [#1260](https://github.com/sdv-dev/SDV/issues/1260) by @pvk-developer *
+Cannot fit twice if I modify transformers: `ValueError: There are non-numerical
+values in your data.` - Issue [#1259](https://github.com/sdv-dev/SDV/issues/
+1259) by @frances-h * Cannot fit twice if I add constraints: `ValueError: There
+are non-numerical values in your data.` - Issue [#1258](https://github.com/sdv-
+dev/SDV/issues/1258) by @frances-h * `HMASynthesizer` errors out when fitting a
+dataset that has a table which holds primary key and foreign keys only - Issue
+[#1257](https://github.com/sdv-dev/SDV/issues/1257) by @pvk-developer * Change
+ValueErrors to InvalidMetadataErrors - Issue [#1251](https://github.com/sdv-
+dev/SDV/issues/1251) by @frances-h * Multi-table should show foreign key
+transformers as None - Issue [#1249](https://github.com/sdv-dev/SDV/issues/
+1249) by @frances-h * Cannot use `HMASynthesizer.fit_processed_data` more than
+once (`KeyError`) - Issue [#1240](https://github.com/sdv-dev/SDV/issues/1240)
+by @frances-h * Function `get_available_demos` crashes if a dataset's `num-
+tables` or `size-MB` cannot be found - Issue [#1215](https://github.com/sdv-
+dev/SDV/issues/1215) by @amontanez24 * Cannot supply a natural key to
+`HMASynthesizer` (where `sdtype` is custom): Error in `sample` - Issue [#1214]
+(https://github.com/sdv-dev/SDV/issues/1214) by @pvk-developer * Unable to
+sample when using a `PseudoAnonymizedFaker` - Issue [#1207](https://github.com/
+sdv-dev/SDV/issues/1207) by @pvk-developer * Incorrect `sdtype` specified in
+demo dataset `student_placements_pii` - Issue [#1206](https://github.com/sdv-
+dev/SDV/issues/1206) by @amontanez24 * Auto assigned transformers for datetime
+columns don't have the right parameters - Issue [#1204](https://github.com/sdv-
+dev/SDV/issues/1204) by @pvk-developer * Cannot apply `Inequality` constraint
+on demo dataset's datetime columns - Issue [#1203](https://github.com/sdv-dev/
+SDV/issues/1203) by @pvk-developer * pii should not be required to auto-assign
+faker transformers - Issue [#1194](https://github.com/sdv-dev/SDV/issues/1194)
+by @pvk-developer * Misc. bug fixes for SDV 1.0.0 - Issue [#1193](https://
+github.com/sdv-dev/SDV/issues/1193) by @pvk-developer * Small bug fixes in demo
+module - Issue [#1192](https://github.com/sdv-dev/SDV/issues/1192) by @pvk-
+developer * Foreign Keys are added as Alternate Keys when upgrading - Issue
+[#1143](https://github.com/sdv-dev/SDV/issues/1143) by @pvk-developer *
+Alternate keys not unique when assigned to a semantic type - Issue [#1111]
+(https://github.com/sdv-dev/SDV/issues/1111) by @pvk-developer * Synthesizer
+errors if column is semantic type and pii is False - Issue [#1110](https://
+github.com/sdv-dev/SDV/issues/1110) by @fealho * Sampled values not unique if
+primary key is numerical - Issue [#1109](https://github.com/sdv-dev/SDV/issues/
+1109) by @pvk-developer * Validate not called during synthesizer creation -
+Issue [#1105](https://github.com/sdv-dev/SDV/issues/1105) by @pvk-developer *
+SingleTableSynthesizer fit doesn't update rounding - Issue [#1104](https://
+github.com/sdv-dev/SDV/issues/1104) by @amontanez24 * Method
+`auto_assign_tranformers` always sets `enforce_min_max_values=True` - Issue
+[#1095](https://github.com/sdv-dev/SDV/issues/1095) by @fealho * Sampled
+context columns in PAR must be in the same order - Issue [#1052](https://
+github.com/sdv-dev/SDV/issues/1052) by @amontanez24 * Incorrect schema version
+printing during detect_table_from_dataframe - Issue [#1038](https://github.com/
+sdv-dev/SDV/issues/1038) by @amontanez24 * Same relationship can be added twice
+to MultiTableMetadata - Issue [#1031](https://github.com/sdv-dev/SDV/issues/
+1031) by @amontanez24 * Miscellaneous metadata bugs - Issue [#1026](https://
+github.com/sdv-dev/SDV/issues/1026) by @amontanez24 #### Maintenance * SDV
+Package Maintenance Updates - Issue [#1140](https://github.com/sdv-dev/SDV/
+issues/1140) by @amontanez24 #### Internal * Add integration tests for
+'Synthesize Sequences' demo - Issue [#1295](https://github.com/sdv-dev/SDV/
+issues/1295) by @pvk-developer * Add integration tests for 'Adding Constraints'
+demo - Issue [#1280](https://github.com/sdv-dev/SDV/issues/1280) by @pvk-
+developer * Add integration tests to the 'Use Your Own Data' demo - Issue
+[#1278](https://github.com/sdv-dev/SDV/issues/1278) by @frances-h * Add
+integration tests for 'Synthesize Multi Tables' demo - Issue [#1277](https://
+github.com/sdv-dev/SDV/issues/1277) by @pvk-developer * Add integration tests
+for 'Synthesize a Table' demo - Issue [#1276](https://github.com/sdv-dev/SDV/
+issues/1276) by @frances-h * Update `get_available_demos` tests - Issue [#1247]
+(https://github.com/sdv-dev/SDV/issues/1247) by @fealho * Make private
+attributes public in the metadata - Issue [#1245](https://github.com/sdv-dev/
+SDV/issues/1245) by @fealho ## 0.18.0 - 2023-01-24 This release adds suppport
+for Python 3.10 and drops support for 3.6. ### Maintenance * Drop support for
+python 3.6 - Issue [#1177](https://github.com/sdv-dev/SDV/issues/1177) by
+@amontanez24 * Support for python 3.10 - Issue [#939](https://github.com/sdv-
+dev/SDV/issues/939) by @amontanez24 * Support Python >=3.10,<4 - Issue [#1000]
+(https://github.com/sdv-dev/SDV/issues/1000) by @amontanez24 ## 0.17.2 - 2022-
+12-08 This release fixes a bug in the demo module related to loading the demo
+data with constraints. It also adds a name to the demo datasets. Finally, it
+bumps the version of `SDMetrics` used. ### Maintenance * Upgrade SDMetrics
+requirement to 0.8.0 - Issue [#1125](https://github.com/sdv-dev/SDV/issues/
+1125) by @katxiao ### New Features * Provide a name for the default demo
+datasets - Issue [#1124](https://github.com/sdv-dev/SDV/issues/1124) by
+@amontanez24 ### Bugs Fixed * Cannot load_tabular_demo with metadata - Issue
+[#1123](https://github.com/sdv-dev/SDV/issues/1123) by @amontanez24 ## 0.17.1 -
+2022-09-29 This release bumps the dependency requirements to use the latest
+version of `SDMetrics`. ### Maintenance * Patch release: Bump required version
+for SDMetrics - Issue [#1010](https://github.com/sdv-dev/SDV/issues/1010) by
+@katxiao ## 0.17.0 - 2022-09-09 This release updates the code to use RDT
+version 1.2.0 and greater, so that those new features are now available in SDV.
+This changes the transformers that are available in SDV models to be those that
+are in RDT version 1.2.0. As a result, some arguments for initializing models
+have changed. Additionally, this release fixes bugs related to loading models
+with custom constraints. It also fixes a bug that added `NaNs` to the index of
 sampled data when using `sample_remaining_columns`. ### Bugs Fixed * Incorrect
 rounding in Custom Constraint example - Issue [#941](https://github.com/sdv-
 dev/SDV/issues/941) by @amontanez24 * Can't save the model if use the custom
 constraint - Issue [#928](https://github.com/sdv-dev/SDV/issues/928) by @pvk-
 developer * User Guide code fixes - Issue [#983](https://github.com/sdv-dev/
 SDV/issues/983) by @amontanez24 * Index contains NaNs when using
 sample_remaining_columns - Issue [#985](https://github.com/sdv-dev/SDV/issues/
```

### Comparing `sdv-1.0.0rc0/README.md` & `sdv-1.0.1.dev0/README.md`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/Makefile` & `sdv-1.0.1.dev0/docs/Makefile`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Constraint.rst` & `sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Constraint.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.rst` & `sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.CustomConstraint.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.rst` & `sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.FixedCombinations.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Inequality.rst` & `sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Inequality.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Negative.rst` & `sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Negative.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.rst` & `sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.OneHotEncoding.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Positive.rst` & `sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Positive.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.rst` & `sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarInequality.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.rst` & `sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.ScalarRange.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/constraints/api/sdv.constraints.Unique.rst` & `sdv-1.0.1.dev0/docs/api_reference/constraints/api/sdv.constraints.Unique.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/constraints/tabular.rst` & `sdv-1.0.1.dev0/docs/api_reference/constraints/tabular.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.rst` & `sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.dataset.Metadata.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metadata/api/sdv.metadata.table.Table.rst` & `sdv-1.0.1.dev0/docs/api_reference/metadata/api/sdv.metadata.table.Table.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metadata/dataset.rst` & `sdv-1.0.1.dev0/docs/api_reference/metadata/dataset.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metadata/table.rst` & `sdv-1.0.1.dev0/docs/api_reference/metadata/table.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLikelihood.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLikelihood.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLogLikelihood.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.BNLogLikelihood.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.DetectionMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.DetectionMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.KSComplement.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSComplement.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.KSTest.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.KSTest.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticDetection.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticDetection.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticParentChildDetection.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.LogisticParentChildDetection.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiSingleTableMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiSingleTableMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiTableMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.MultiTableMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.ParentChildDetectionMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.ParentChildDetectionMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCDetection.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCDetection.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCParentChildDetection.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.relational.SVCParentChildDetection.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLikelihood.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLikelihood.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLogLikelihood.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BNLogLikelihood.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryAdaBoostClassifier.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryAdaBoostClassifier.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryDecisionTreeClassifier.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryDecisionTreeClassifier.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryEfficacyMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryEfficacyMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryLogisticRegression.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryLogisticRegression.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryMLPClassifier.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.BinaryMLPClassifier.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CSTest.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CSTest.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalCAP.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalCAP.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalEnsemble.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalEnsemble.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalGeneralizedCAP.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalGeneralizedCAP.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalKNN.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalKNN.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalNB.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalNB.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalPrivacyMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalPrivacyMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalRF.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalRF.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalSVM.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalSVM.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalZeroCAP.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.CategoricalZeroCAP.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.ContinuousKLDivergence.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ContinuousKLDivergence.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.DetectionMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DetectionMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.DiscreteKLDivergence.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.DiscreteKLDivergence.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.GMLogLikelihood.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.GMLogLikelihood.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSComplement.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSComplement.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSTest.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.KSTest.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.LinearRegression.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LinearRegression.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.LogisticDetection.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.LogisticDetection.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLEfficacyMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLEfficacyMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLPRegressor.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MLPRegressor.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiColumnPairsMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiColumnPairsMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiSingleColumnMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MultiSingleColumnMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassDecisionTreeClassifier.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassDecisionTreeClassifier.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassEfficacyMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassEfficacyMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassMLPClassifier.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.MulticlassMLPClassifier.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalLR.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalLR.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalMLP.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalMLP.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalPrivacyMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalPrivacyMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalRadiusNearestNeighbor.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalRadiusNearestNeighbor.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalSVR.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.NumericalSVR.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.RegressionEfficacyMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.RegressionEfficacyMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.SVCDetection.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SVCDetection.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.ScikitLearnClassifierDetectionMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.ScikitLearnClassifierDetectionMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.tabular.SingleTableMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.tabular.SingleTableMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMClassifierEfficacy.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMClassifierEfficacy.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMDetection.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.LSTMDetection.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesDetectionMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesDetectionMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesEfficacyMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesEfficacyMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesMetric.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/api/sdv.metrics.timeseries.TimeSeriesMetric.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/relational.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/relational.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/tabular.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/tabular.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/metrics/timeseries.rst` & `sdv-1.0.1.dev0/docs/api_reference/metrics/timeseries.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.rst` & `sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulagan.CopulaGAN.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.rst` & `sdv-1.0.1.dev0/docs/api_reference/tabular/api/sdv.tabular.copulas.GaussianCopula.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/conf.py` & `sdv-1.0.1.dev0/docs/conf.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/developer_guides/contributing.rst` & `sdv-1.0.1.dev0/docs/developer_guides/contributing.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/developer_guides/overview.rst` & `sdv-1.0.1.dev0/docs/developer_guides/overview.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/developer_guides/sdv/constraints.rst` & `sdv-1.0.1.dev0/docs/developer_guides/sdv/constraints.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/developer_guides/sdv/metadata.rst` & `sdv-1.0.1.dev0/docs/developer_guides/sdv/metadata.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/developer_guides/sdv/tabular.rst` & `sdv-1.0.1.dev0/docs/developer_guides/sdv/tabular.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/getting_started/install.rst` & `sdv-1.0.1.dev0/docs/getting_started/install.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/getting_started/quickstart.rst` & `sdv-1.0.1.dev0/docs/getting_started/quickstart.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/CTGAN-DataCebo.png` & `sdv-1.0.1.dev0/docs/images/CTGAN-DataCebo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/Copulas-DataCebo.png` & `sdv-1.0.1.dev0/docs/images/Copulas-DataCebo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/DataCebo-Blue.png` & `sdv-1.0.1.dev0/docs/images/DataCebo-Blue.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/DeepEcho-DataCebo.png` & `sdv-1.0.1.dev0/docs/images/DeepEcho-DataCebo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/RDT-DataCebo.png` & `sdv-1.0.1.dev0/docs/images/RDT-DataCebo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/Real-vs-Synthetic-Evaluation.png` & `sdv-1.0.1.dev0/docs/images/Real-vs-Synthetic-Evaluation.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/SDGym-DataCebo.png` & `sdv-1.0.1.dev0/docs/images/SDGym-DataCebo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/SDMetrics-DataCebo.png` & `sdv-1.0.1.dev0/docs/images/SDMetrics-DataCebo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/SDV-DataCebo.png` & `sdv-1.0.1.dev0/docs/images/SDV-DataCebo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/SDV-logo.png` & `sdv-1.0.1.dev0/docs/images/SDV-logo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/SDV.png` & `sdv-1.0.1.dev0/docs/images/SDV.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/Single-Table-Metadata-Example.png` & `sdv-1.0.1.dev0/docs/images/Single-Table-Metadata-Example.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/custom_constraint.png` & `sdv-1.0.1.dev0/docs/images/custom_constraint.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/datacebo-logo-dark-mode.png` & `sdv-1.0.1.dev0/docs/images/datacebo-logo-dark-mode.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/datacebo-logo.png` & `sdv-1.0.1.dev0/docs/images/datacebo-logo.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/google_colab.png` & `sdv-1.0.1.dev0/docs/images/google_colab.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/hma1_1.png` & `sdv-1.0.1.dev0/docs/images/hma1_1.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/metadata_1.png` & `sdv-1.0.1.dev0/docs/images/metadata_1.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/metadata_2.png` & `sdv-1.0.1.dev0/docs/images/metadata_2.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/mybinder.png` & `sdv-1.0.1.dev0/docs/images/mybinder.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/quickstart_1.png` & `sdv-1.0.1.dev0/docs/images/quickstart_1.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/rdt_main_tranformation.png` & `sdv-1.0.1.dev0/docs/images/rdt_main_tranformation.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/images/slack.png` & `sdv-1.0.1.dev0/docs/images/slack.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/index.rst` & `sdv-1.0.1.dev0/docs/index.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/make.bat` & `sdv-1.0.1.dev0/docs/make.bat`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/savefig/copulagan_experience_years_1.png` & `sdv-1.0.1.dev0/docs/savefig/copulagan_experience_years_1.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/savefig/copulagan_experience_years_2.png` & `sdv-1.0.1.dev0/docs/savefig/copulagan_experience_years_2.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/savefig/copulagan_experience_years_3.png` & `sdv-1.0.1.dev0/docs/savefig/copulagan_experience_years_3.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/savefig/experience_years_1.png` & `sdv-1.0.1.dev0/docs/savefig/experience_years_1.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/savefig/experience_years_2.png` & `sdv-1.0.1.dev0/docs/savefig/experience_years_2.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/savefig/experience_years_3.png` & `sdv-1.0.1.dev0/docs/savefig/experience_years_3.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/sdv_theme/static/slack-32.png` & `sdv-1.0.1.dev0/docs/sdv_theme/static/slack-32.png`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/benchmarking/datasets.rst` & `sdv-1.0.1.dev0/docs/user_guides/benchmarking/datasets.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/benchmarking/docker.rst` & `sdv-1.0.1.dev0/docs/user_guides/benchmarking/docker.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/benchmarking/index.rst` & `sdv-1.0.1.dev0/docs/user_guides/benchmarking/index.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/benchmarking/install.rst` & `sdv-1.0.1.dev0/docs/user_guides/benchmarking/install.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/benchmarking/run.rst` & `sdv-1.0.1.dev0/docs/user_guides/benchmarking/run.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/benchmarking/synthesizers.rst` & `sdv-1.0.1.dev0/docs/user_guides/benchmarking/synthesizers.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/evaluation/evaluation_framework.rst` & `sdv-1.0.1.dev0/docs/user_guides/evaluation/evaluation_framework.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/relational/constraints.rst` & `sdv-1.0.1.dev0/docs/user_guides/relational/constraints.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/relational/hma1.rst` & `sdv-1.0.1.dev0/docs/user_guides/relational/hma1.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/relational/relational_metadata.rst` & `sdv-1.0.1.dev0/docs/user_guides/relational/relational_metadata.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/single_table/copulagan.rst` & `sdv-1.0.1.dev0/docs/user_guides/single_table/copulagan.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/single_table/ctgan.rst` & `sdv-1.0.1.dev0/docs/user_guides/single_table/ctgan.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/single_table/custom_constraints.rst` & `sdv-1.0.1.dev0/docs/user_guides/single_table/custom_constraints.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/single_table/gaussian_copula.rst` & `sdv-1.0.1.dev0/docs/user_guides/single_table/gaussian_copula.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/single_table/handling_constraints.rst` & `sdv-1.0.1.dev0/docs/user_guides/single_table/handling_constraints.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/single_table/index.rst` & `sdv-1.0.1.dev0/docs/user_guides/single_table/index.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/single_table/tabular_preset.rst` & `sdv-1.0.1.dev0/docs/user_guides/single_table/tabular_preset.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/single_table/tvae.rst` & `sdv-1.0.1.dev0/docs/user_guides/single_table/tvae.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/docs/user_guides/timeseries/par.rst` & `sdv-1.0.1.dev0/docs/user_guides/timeseries/par.rst`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/constraints/__init__.py` & `sdv-1.0.1.dev0/sdv/constraints/__init__.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/constraints/base.py` & `sdv-1.0.1.dev0/sdv/constraints/base.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/constraints/errors.py` & `sdv-1.0.1.dev0/sdv/constraints/errors.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/constraints/tabular.py` & `sdv-1.0.1.dev0/sdv/constraints/tabular.py`

 * *Files 2% similar despite different names*

```diff
@@ -451,14 +451,40 @@
         if self._is_datetime and self._dtype == 'O':
             low = cast_to_datetime64(low)
             high = cast_to_datetime64(high)
 
         valid = np.isnan(low) | np.isnan(high) | self._operator(high, low)
         return valid
 
+    def _get_datetime_diff(self, high, low):
+        """Calculate the difference between two datetime columns.
+
+        When casting datetimes to float using ``astype``, NaT values are not automatically
+        converted to NaN values. This method calculates the difference between the high
+        and low column values, preserving missing values as NaNs.
+
+        Args:
+            high (numpy.ndarray):
+                The high column values.
+            low (numpy.ndarray):
+                The low column values.
+
+        Returns:
+            numpy.ndarray:
+                The difference between the high and low column values.
+        """
+        if self._dtype == 'O':
+            low = cast_to_datetime64(low)
+            high = cast_to_datetime64(high)
+        diff_column = high - low
+        nan_mask = np.isnan(diff_column)
+        diff_column = diff_column.astype(np.float64)
+        diff_column[nan_mask] = np.nan
+        return diff_column
+
     def _transform(self, table_data):
         """Transform the table data.
 
         The transformation consists on replacing the ``high_column_name`` values with the
         difference between it and the ``low_column_name`` values.
 
         Afterwards, a logarithm is applied to the difference + 1 to ensure that the
@@ -469,21 +495,18 @@
                 Table data.
 
         Returns:
             pandas.DataFrame:
                 Transformed data.
         """
         low, high = self._get_data(table_data)
-        if self._is_datetime and self._dtype == 'O':
-            low = cast_to_datetime64(low)
-            high = cast_to_datetime64(high)
-
-        diff_column = high - low
         if self._is_datetime:
-            diff_column = diff_column.astype(np.float64)
+            diff_column = self._get_datetime_diff(high, low)
+        else:
+            diff_column = high - low
 
         table_data[self._diff_column_name] = np.log(diff_column + 1)
         return table_data.drop(self._high_column_name, axis=1)
 
     def _reverse_transform(self, table_data):
         """Reverse transform the table data.
```

### Comparing `sdv-1.0.0rc0/sdv/constraints/utils.py` & `sdv-1.0.1.dev0/sdv/constraints/utils.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/data_processing/data_processor.py` & `sdv-1.0.1.dev0/sdv/data_processing/data_processor.py`

 * *Files 1% similar despite different names*

```diff
@@ -4,14 +4,15 @@
 import logging
 import warnings
 from copy import deepcopy
 from pathlib import Path
 
 import pandas as pd
 import rdt
+from pandas.api.types import is_float_dtype, is_integer_dtype
 from rdt.transformers import AnonymizedFaker, RegexGenerator
 
 from sdv.constraints import Constraint
 from sdv.constraints.base import get_subclasses
 from sdv.constraints.errors import (
     AggregateConstraintsError, FunctionError, MissingConstraintColumnError)
 from sdv.data_processing.datetime_formatter import DatetimeFormatter
@@ -740,15 +741,15 @@
                 column_data = anonymized_data[column_name]
             elif column_name in self._keys:
                 column_data = generated_keys[column_name]
             else:
                 column_data = reversed_data[column_name]
 
             dtype = self._dtypes[column_name]
-            if pd.api.types.is_integer_dtype(dtype) and column_data.dtype != 'O':
+            if is_integer_dtype(dtype) and is_float_dtype(column_data.dtype):
                 column_data = column_data.round()
 
             reversed_data[column_name] = column_data[column_data.notna()].astype(dtype)
 
         # reformat columns using the formatters
         for column in sampled_columns:
             if column in self.formatters:
@@ -810,27 +811,27 @@
         instance._constraints_to_reverse = [
             Constraint.from_dict(cnt) for cnt in metadata_dict.get('constraints_to_reverse', [])
         ]
         instance._constraints_list = metadata_dict.get('constraints_list', [])
 
         return instance
 
-    def to_json(self, path):
+    def to_json(self, filepath):
         """Dump this DataProcessor into a JSON file.
 
         Args:
-            path (str):
+            filepath (str):
                 Path of the JSON file where this metadata will be stored.
         """
-        with open(path, 'w') as out_file:
+        with open(filepath, 'w') as out_file:
             json.dump(self.to_dict(), out_file, indent=4)
 
     @classmethod
-    def from_json(cls, path):
+    def from_json(cls, filepath):
         """Load a DataProcessor from a JSON.
 
         Args:
-            path (str):
+            filepath (str):
                 Path of the JSON file to load
         """
-        with open(path, 'r') as in_file:
+        with open(filepath, 'r') as in_file:
             return cls.from_dict(json.load(in_file))
```

### Comparing `sdv-1.0.0rc0/sdv/data_processing/datetime_formatter.py` & `sdv-1.0.1.dev0/sdv/data_processing/datetime_formatter.py`

 * *Files 14% similar despite different names*

```diff
@@ -36,10 +36,14 @@
                 Data to format.
 
         Returns:
             numpy.ndarray:
                 containing the formatted data.
         """
         if self.datetime_format:
-            column = pd.to_datetime(column).dt.strftime(self.datetime_format)
+            try:
+                datetime_column = pd.to_datetime(column, format=self.datetime_format)
+                column = datetime_column.dt.strftime(self.datetime_format)
+            except ValueError:
+                column = pd.to_datetime(column).dt.strftime(self.datetime_format)
 
         return column.astype(self._dtype)
```

### Comparing `sdv-1.0.0rc0/sdv/data_processing/errors.py` & `sdv-1.0.1.dev0/sdv/data_processing/errors.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/data_processing/numerical_formatter.py` & `sdv-1.0.1.dev0/sdv/data_processing/numerical_formatter.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/data_processing/utils.py` & `sdv-1.0.1.dev0/sdv/data_processing/utils.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/datasets/demo.py` & `sdv-1.0.1.dev0/sdv/datasets/demo.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/datasets/local.py` & `sdv-1.0.1.dev0/sdv/datasets/local.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/errors.py` & `sdv-1.0.1.dev0/sdv/errors.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/evaluation/multi_table.py` & `sdv-1.0.1.dev0/sdv/evaluation/multi_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/evaluation/single_table.py` & `sdv-1.0.1.dev0/sdv/evaluation/single_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/lite/single_table.py` & `sdv-1.0.1.dev0/sdv/lite/single_table.py`

 * *Files 2% similar despite different names*

```diff
@@ -161,37 +161,37 @@
             max_tries_per_batch,
             batch_size,
             output_file_path
         )
 
         return sampled
 
-    def save(self, path):
+    def save(self, filepath):
         """Save this model instance to the given path using cloudpickle.
 
         Args:
-            path (str):
+            filepath (str):
                 Path where the SDV instance will be serialized.
         """
-        with open(path, 'wb') as output:
+        with open(filepath, 'wb') as output:
             cloudpickle.dump(self, output)
 
     @classmethod
-    def load(cls, path):
+    def load(cls, filepath):
         """Load a SingleTableSynthesizer instance from a given path.
 
         Args:
-            path (str):
+            filepath (str):
                 Path from which to load the instance.
 
         Returns:
             SingleTableSynthesizer:
                 The loaded synthesizer.
         """
-        with open(path, 'rb') as f:
+        with open(filepath, 'rb') as f:
             model = cloudpickle.load(f)
             return model
 
     @classmethod
     def list_available_presets(cls, out=sys.stdout):
         """List the available presets and their descriptions."""
         out.write(f'Available presets:\n{PRESETS}\n\n'
```

### Comparing `sdv-1.0.0rc0/sdv/metadata/anonymization.py` & `sdv-1.0.1.dev0/sdv/metadata/anonymization.py`

 * *Files 1% similar despite different names*

```diff
@@ -67,15 +67,15 @@
     function_name = getattr(Faker(), function_name)
     module = inspect.getmodule(function_name).__name__
     module = module.split('.')
     if len(module) == 2:
         return 'BaseProvider'
 
     else:
-        return module[-1]
+        return '.'.join(module[2:])
 
 
 def get_anonymized_transformer(function_name, function_kwargs=None):
     """Get an instance with an ``AnonymizedFaker`` for the given ``function_name``.
 
     Args:
         function_name (str):
```

### Comparing `sdv-1.0.0rc0/sdv/metadata/metadata_upgrader.py` & `sdv-1.0.1.dev0/sdv/metadata/metadata_upgrader.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/metadata/multi_table.py` & `sdv-1.0.1.dev0/sdv/metadata/multi_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/metadata/single_table.py` & `sdv-1.0.1.dev0/sdv/metadata/single_table.py`

 * *Files 0% similar despite different names*

```diff
@@ -296,15 +296,15 @@
         for key in keys:
             if not (self.columns[key]['sdtype'] == 'id' or
                     is_faker_function(self.columns[key]['sdtype'])):
                 bad_keys.add(key)
         if bad_keys:
             raise InvalidMetadataError(
                 f"The {key_type}_keys {sorted(bad_keys)} must be type 'id' or "
-                'a valid Faker function.'
+                'another PII type.'
             )
 
     def _validate_key(self, column_name, key_type):
         """Validate the primary and sequence keys."""
         if column_name is not None:
             if not self._validate_datatype(column_name):
                 raise InvalidMetadataError(
```

### Comparing `sdv-1.0.0rc0/sdv/metadata/utils.py` & `sdv-1.0.1.dev0/sdv/metadata/utils.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/metadata/visualization.py` & `sdv-1.0.1.dev0/sdv/metadata/visualization.py`

 * *Files 9% similar despite different names*

```diff
@@ -1,48 +1,48 @@
 """Functions for Metadata visualization."""
 
 import warnings
 
 import graphviz
 
 
-def _get_graphviz_extension(path):
-    if path:
-        path_splitted = path.split('.')
+def _get_graphviz_extension(filepath):
+    if filepath:
+        path_splitted = filepath.split('.')
         if len(path_splitted) == 1:
             raise ValueError('Path without graphviz extension.')
 
         graphviz_extension = path_splitted[-1]
 
         if graphviz_extension not in graphviz.FORMATS:
             raise ValueError(f'"{graphviz_extension}" not a valid graphviz extension format.')
 
         return '.'.join(path_splitted[:-1]), graphviz_extension
 
     return None, None
 
 
-def visualize_graph(nodes, edges, path=None):
+def visualize_graph(nodes, edges, filepath=None):
     """Plot metadata usign graphviz.
 
     Try to generate a plot using graphviz.
-    If a ``path`` is provided save the output into a file.
+    If a ``filepath`` is provided save the output into a file.
 
     Args:
         nodes (dict):
             Dictionary mapping a node name to a node label.
         edges (list):
             List of tuples of the format (parent, child, label).
-        path (str):
+        filepath (str):
             Output file path to save the plot, it requires a graphviz
             supported extension. If ``None`` do not save the plot.
             Defaults to ``None``.
     """
     try:
-        filename, graphviz_extension = _get_graphviz_extension(path)
+        filename, graphviz_extension = _get_graphviz_extension(filepath)
     except ValueError:
         raise ValueError(
             'Unable to save a visualization with this file type. Try a supported file type like '
             "'png', 'jpg' or 'pdf'. For a full list, see 'https://graphviz.org/docs/outputs/'"
         )
 
     digraph = graphviz.Digraph(
```

### Comparing `sdv-1.0.0rc0/sdv/multi_table/base.py` & `sdv-1.0.1.dev0/sdv/multi_table/base.py`

 * *Files 2% similar despite different names*

```diff
@@ -425,41 +425,39 @@
         for table_name, synthesizer in self._table_synthesizers.items():
             for constraint in synthesizer.get_constraints():
                 constraint['table_name'] = table_name
                 constraints.append(constraint)
 
         return constraints
 
-    def load_custom_constraint_classes(self, table_name, filepath, class_names):
-        """Load a custom constraint class for the specified table's synthesizer.
+    def load_custom_constraint_classes(self, filepath, class_names):
+        """Load a custom constraint class for each table's synthesizer.
 
         Args:
-            table_name (str):
-                Table to add constraint to.
             filepath (str):
                 String representing the absolute or relative path to the python file where
                 the custom constraints are declared.
             class_names (list):
                 A list of custom constraint classes to be imported.
         """
-        self._table_synthesizers[table_name].load_custom_constraint_classes(filepath, class_names)
+        for synthesizer in self._table_synthesizers.values():
+            synthesizer.load_custom_constraint_classes(filepath, class_names)
 
-    def add_custom_constraint_class(self, table_name, class_object, class_name):
+    def add_custom_constraint_class(self, class_object, class_name):
         """Add a custom constraint class for the synthesizer to use.
 
         Args:
-            table_name (str):
-                Table to add constraint to.
             class_object (sdv.constraints.Constraint):
                 A custom constraint class object.
             class_name (str):
                 The name to assign this custom constraint class. This will be the name to use
                 when writing a constraint dictionary for ``add_constraints``.
         """
-        self._table_synthesizers[table_name].add_custom_constraint_class(class_object, class_name)
+        for synthesizer in self._table_synthesizers.values():
+            synthesizer.add_custom_constraint_class(class_object, class_name)
 
     def get_info(self):
         """Get dictionary with information regarding the synthesizer.
 
         Return:
             dict:
                 * ``class_name``: synthesizer class name
@@ -483,17 +481,17 @@
             filepath (str):
                 Path where the instance will be serialized.
         """
         with open(filepath, 'wb') as output:
             cloudpickle.dump(self, output)
 
     @classmethod
-    def load(cls, path):
+    def load(cls, filepath):
         """Load the multi-table synthesizer from a given path.
 
         Args:
-            path (str):
+            filepath (str):
                 Path from which to load the instance.
         """
-        with open(path, 'rb') as f:
+        with open(filepath, 'rb') as f:
             synthesizer = cloudpickle.load(f)
             return synthesizer
```

### Comparing `sdv-1.0.0rc0/sdv/multi_table/hma.py` & `sdv-1.0.1.dev0/sdv/multi_table/hma.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/sampling/tabular.py` & `sdv-1.0.1.dev0/sdv/sampling/tabular.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/sequential/par.py` & `sdv-1.0.1.dev0/sdv/sequential/par.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/single_table/base.py` & `sdv-1.0.1.dev0/sdv/single_table/base.py`

 * *Files 2% similar despite different names*

```diff
@@ -18,15 +18,16 @@
 import tqdm
 from copulas.multivariate import GaussianMultivariate
 
 from sdv.data_processing.data_processor import DataProcessor
 from sdv.errors import ConstraintsNotMetError, SynthesizerInputError
 from sdv.single_table.errors import InvalidDataError
 from sdv.single_table.utils import check_num_rows, handle_sampling_error, validate_file_path
-from sdv.utils import is_boolean_type, is_datetime_type, is_numerical_type
+from sdv.utils import (
+    is_boolean_type, is_datetime_type, is_numerical_type, validate_datetime_format)
 
 LOGGER = logging.getLogger(__name__)
 COND_IDX = str(uuid.uuid4())
 FIXED_RNG_SEED = 73251
 TMP_FILE_NAME = '.sample.csv.temp'
 DISABLE_TMP_FILE = 'disable'
 
@@ -146,44 +147,55 @@
             repeated_values = set(data[key][data[key].duplicated()])
             if repeated_values:
                 repeated_values = self._format_invalid_values_string(repeated_values)
                 errors.append(f"Key column '{key}' contains repeating values: {repeated_values}")
 
         return errors
 
-    def _validate_sdtype(self, sdtype, column, validation):
-        valid = column.apply(validation)
-        invalid_values = set(column[~valid])
-        if invalid_values:
-            invalid_values = self._format_invalid_values_string(invalid_values)
-            return [f"Invalid values found for {sdtype} column '{column.name}': {invalid_values}."]
-
-        return []
+    @staticmethod
+    def _get_invalid_column_values(column, validation_function):
+        valid = column.apply(validation_function)
+        return set(column[~valid])
 
     def _validate_column(self, column):
         """Validate values of the column satisfy its sdtype properties."""
-        errors = []
-        sdtype = self.metadata.columns[column.name]['sdtype']
+        column_metadata = self.metadata.columns[column.name]
+        sdtype = column_metadata['sdtype']
+        invalid_values = None
 
         # boolean values must be True/False, None or missing values
         # int/str are not allowed
         if sdtype == 'boolean':
-            errors += self._validate_sdtype(sdtype, column, is_boolean_type)
+            invalid_values = self._get_invalid_column_values(column, is_boolean_type)
 
         # numerical values must be int/float, None or missing values
         # str/bool are not allowed
         if sdtype == 'numerical':
-            errors += self._validate_sdtype(sdtype, column, is_numerical_type)
+            invalid_values = self._get_invalid_column_values(column, is_numerical_type)
 
         # datetime values must be castable to datetime, None or missing values
         if sdtype == 'datetime':
-            errors += self._validate_sdtype(
-                sdtype, column, lambda x: pd.isna(x) | is_datetime_type(x))
+            datetime_format = column_metadata.get('datetime_format')
+            if datetime_format:
+                invalid_values = self._get_invalid_column_values(
+                    column,
+                    lambda x: validate_datetime_format(x, datetime_format)
+                )
+
+            else:
+                invalid_values = self._get_invalid_column_values(
+                    column,
+                    lambda x: pd.isna(x) | is_datetime_type(x)
+                )
 
-        return errors
+        if invalid_values:
+            invalid_values = self._format_invalid_values_string(invalid_values)
+            return [f"Invalid values found for {sdtype} column '{column.name}': {invalid_values}."]
+
+        return []
 
     def _validate(self, data):
         """Validate any rules that only apply to specific synthesizers.
 
         This method should be overridden by subclasses.
         """
         return []
```

### Comparing `sdv-1.0.0rc0/sdv/single_table/copulagan.py` & `sdv-1.0.1.dev0/sdv/single_table/copulagan.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/single_table/copulas.py` & `sdv-1.0.1.dev0/sdv/single_table/copulas.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/single_table/ctgan.py` & `sdv-1.0.1.dev0/sdv/single_table/ctgan.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/single_table/utils.py` & `sdv-1.0.1.dev0/sdv/single_table/utils.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/sdv/utils.py` & `sdv-1.0.1.dev0/sdv/utils.py`

 * *Files 16% similar despite different names*

```diff
@@ -122,14 +122,38 @@
     Returns:
         bool:
             True if the input is a boolean, False if not.
     """
     return True if pd.isna(value) | (value is True) | (value is False) else False
 
 
+def validate_datetime_format(value, datetime_format):
+    """Determine that value matches datetime format.
+
+    Args:
+        value (int, str, datetime, bool):
+            Input to evaluate.
+        datetime_format (str):
+            The datetime format.
+
+    Returns:
+        bool:
+            True if the input matches the format, False if not.
+    """
+    pandas_datetime_format = datetime_format.replace('%-', '%')
+
+    try:
+        pd.to_datetime(value, format=pandas_datetime_format)
+
+    except ValueError:
+        return False
+
+    return True
+
+
 def load_data_from_csv(filepath, pandas_kwargs=None):
     """Load DataFrame from a filepath.
 
     Args:
         filepath (str):
             String that represents the ``path`` to the ``csv`` file.
         pandas_kwargs (dict):
```

### Comparing `sdv-1.0.0rc0/sdv.egg-info/PKG-INFO` & `sdv-1.0.1.dev0/sdv.egg-info/PKG-INFO`

 * *Files 27% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: sdv
-Version: 1.0.0rc0
+Version: 1.0.1.dev0
 Summary: Generate synthetic data for single table, multi table and sequential data
 Home-page: https://github.com/sdv-dev/SDV
 Author: DataCebo, Inc.
 Author-email: info@sdv.dev
 License: BSL-1.1
 Keywords: sdv synthetic-data synhtetic-data-generation timeseries single-table multi-table
 Classifier: Development Status :: 5 - Production/Stable
@@ -242,14 +242,208 @@
 [Get started using the SDV package](https://bit.ly/sdv-docs) -- a fully
 integrated solution and your one-stop shop for synthetic data. Or, use the standalone libraries
 for specific needs.
 
 
 # Release Notes
 
+## 1.0.0 - 2023-03-28
+
+This is a major release that introduces a new API to the `SDV` aimed at streamlining the process of synthetic data generation! To achieve this, this release includes the addition of several large features.
+
+### Metadata
+
+Some of the most notable additions are the new `SingleTableMetadata` and `MultiTableMetadata` classes. These classes enable a number of features that make it easier to synthesize your data correctly such as:
+
+* Automatic data detection - Calling `metadata.detect_from_dataframe()` or `metadata.detect_from_csv()` will populate the metadata autonomously with values it thinks represent the data.
+* Easy updating - Once an instance of the metadata is created, values can be easily updated using a number of methods defined in the API. For more info, view the [docs](https://docs.sdv.dev/sdv/single-table-data/data-preparation/single-table-metadata-api).
+* Metadata validation - Calling `metadata.validate()` will return a report of any invalid definitions in the metadata specification.
+* Upgrading - Users with the previous metadata format can easily update to the new specification using the `upgrade_metadata()` method.
+* Saving and loading - The metadata itself can easily be saved to a json file and loaded back up later.
+
+### Class and Module Names
+
+Another major change is the renaming of our core modeling classes and modules. The name changes are meant to highlight the difference between the underlying machine learning models, and the objects responsible for the end-to-end workflow of generating synthetic data. The main name changes are as follows:
+* `tabular` -> `single_table`
+* `relational` -> `multi_table`
+* `timeseries` -> `sequential`
+* `BaseTabularModel` -> `BaseSingleTableSynthesizer`
+* `GaussianCopula` -> `GaussianCopulaSynthesizer`
+* `CTGAN` -> `CTGANSynthesizer`
+* `TVAE` -> `TVAESynthesizer`
+* `CopulaGan` -> `CopulaGANSynthesizer`
+* `PAR` -> `PARSynthesizer`
+* `HMA1` -> `HMASynthesizer`
+
+In `SDV` 1.0, synthesizers are classes that take in metadata and handle data preprocessing, model training and model sampling. This is similar to the previous `BaseTabularModel` in `SDV` <1.0.
+
+### Synthetic Data Workflow
+
+`Synthesizers` in `SDV` 1.0 define a clear workflow for generating synthetic data.
+1. Synthesizers are initialized with a metadata class.
+2. They can then be used to transform the data and apply constraints using the `synthesizer.preprocess()` method. This step also validates that the data matches the provided metadata to avoid errors in fitting or sampling.
+3. The processed data can then be fed into the underlying machine learning model using `synthesizer.fit_processed_data()`. (Alternatively, data can be preprocessed and fit to the model using `synthesizer.fit()`.)
+4. Data can then be sampled using `synthesizer.sample()`.
+
+Each synthesizer class also provides a series of methods to help users customize the transformations their data goes through. Read more about that [here](https://docs.sdv.dev/sdv/single-table-data/modeling/synthetic-data-workflow/transform-and-anonymize).
+
+Notice that the preprocessing and model fitting steps can now be separated. This can be helpful if preprocessing is time consuming or if the data has been processed externally.
+
+### Other Highly Requested Features
+
+Another major addition is control over randomization. In `SDV` <1.0, users could set a seed to control the randomization for only some columns. In `SDV` 1.0, randomization is controlled for all columns. Every new call to sample generates new data, but the synthesizer's seed can be reset to the original state using `synthesizer.reset_randomization()`, enabling reproducibility.
+
+`SDV 1.0` adds accessibility and transparency into the transformers used for preprocessing and underlying machine learning models.
+* Using the `synthesizer.get_transformers()` method, you can access the transformers used to preprocess each column and view their properties. This can be useful for debugging and accessing privacy information like mappings used to mask data.
+* Distribution parameters learned by copula models can be accessed using the `synthesizer.get_learned_distributions()` method.
+
+PII handling is improved by the following features:
+* Primary keys can be set to natural sdtypes (eg. SSN, email, name). Previously they could only be numerical or text.
+* The `PseudoAnonymizedFaker` can be used to provide consistent mapping to PII columns. As mentioned before, the mapping itself can be accessed by viewing the transformers for the column using `synthesizer.get_transformers()`.
+* A bug causing PII columns to slow down modeling is patched.
+
+Finally, the synthetic data can now be easily evaluated using the `evaluate_quality()` and `run_diagnostic()` methods. The data can be compared visually to the actual data using the `get_column_plot()` and `get_column_pair_plot()` methods. For more info on how to visualize or interpret the synthetic data evaluation, read the docs [here](https://docs.sdv.dev/sdv/single-table-data/evaluation).
+
+### Issues Resolved
+
+#### New Features
+
+* Change auto_assign_transformers to handle id types - Issue [#1325](https://github.com/sdv-dev/SDV/issues/1325) by @pvk-developer
+* Change 'text' sdtype to 'id' - Issue [#1324](https://github.com/sdv-dev/SDV/issues/1324) by @frances-h
+* In `upgrade_metadata`, return the object instead of writing it to a JSON file - Issue [#1319](https://github.com/sdv-dev/SDV/issues/1319) by @frances-h
+* In `upgrade_metadata` index primary keys should be converted to `text` - Issue [#1318](https://github.com/sdv-dev/SDV/issues/1318) by @amontanez24
+* Add `load_from_dict` to SingleTableMetadata and MultiTableMetadata - Issue [#1314](https://github.com/sdv-dev/SDV/issues/1314) by @amontanez24
+* Throw a `SynthesizerInputError` if `FixedCombinations` constraint is applied to a column that is not `boolean` or `categorical` - Issue [#1306](https://github.com/sdv-dev/SDV/issues/1306) by @frances-h
+* Missing `save` and `load` methods for `HMASynthesizer` - Issue [#1262](https://github.com/sdv-dev/SDV/issues/1262) by @amontanez24
+* Better input validation when creating single and multi table synthesizers - Issue [#1242](https://github.com/sdv-dev/SDV/issues/1242) by @fealho
+* Better input validation on `HMASynthesizer.sample` - Issue [#1241](https://github.com/sdv-dev/SDV/issues/1241) by @R-Palazzo
+* Validate that relationship must be between a `primary key` and `foreign key` - Issue [#1236](https://github.com/sdv-dev/SDV/issues/1236) by @fealho
+* Improve `update_column` validation for `pii` attribute - Issue [#1226](https://github.com/sdv-dev/SDV/issues/1226) by @pvk-developer
+* Order the output of `get_transformers()` based on the metadata - Issue [#1222](https://github.com/sdv-dev/SDV/issues/1222) by @pvk-developer
+* Log if any `numerical_distributions` will not be applied - Issue [#1212](https://github.com/sdv-dev/SDV/issues/1212) by @fealho
+* Improve error handling for `GaussianCopulaSynthesizer`: `numerical_distributions` - Issue [#1211](https://github.com/sdv-dev/SDV/issues/1211) by @fealho
+* Improve error handling when validating `constraints` - Issue [#1210](https://github.com/sdv-dev/SDV/issues/1210) by @fealho
+* Add `fake_companies` demo - Issue [#1209](https://github.com/sdv-dev/SDV/issues/1209) by @amontanez24
+* Allow me to create a custom constraint class and use it in the same file - Issue [#1205](https://github.com/sdv-dev/SDV/issues/1205) by @amontanez24
+* Sampling should reset after retraining the model - Issue [#1201](https://github.com/sdv-dev/SDV/issues/1201) by @pvk-developer
+* Change function name `HMASynthesizer.update_table_parameters` --> `set_table_parameters` - Issue [#1200](https://github.com/sdv-dev/SDV/issues/1200) by @pvk-developer
+* Add `get_info` method to synthesizers - Issue [#1199](https://github.com/sdv-dev/SDV/issues/1199) by @fealho
+* Add evaluation methods to synthesizer - Issue [#1190](https://github.com/sdv-dev/SDV/issues/1190) by @fealho
+* Update `evaluate.py` to work with the new `metadata` - Issue [#1186](https://github.com/sdv-dev/SDV/issues/1186) by @fealho
+* Remove old code - Issue [#1181](https://github.com/sdv-dev/SDV/issues/1181) by @pvk-developer
+* Drop support for python 3.6 and add support for 3.10 - Issue [#1176](https://github.com/sdv-dev/SDV/issues/1176) by @fealho
+* Add constraint methods to MultiTableSynthesizers - Issue [#1171](https://github.com/sdv-dev/SDV/issues/1171) by @fealho
+* Update custom constraint workflow - Issue [#1169](https://github.com/sdv-dev/SDV/issues/1169) by @pvk-developer
+* Add get_constraints method to synthesizers - Issue [#1168](https://github.com/sdv-dev/SDV/issues/1168) by @pvk-developer
+* Migrate adding and validating constraints to BaseSynthesizer - Issue [#1163](https://github.com/sdv-dev/SDV/issues/1163) by @pvk-developer
+* Change metadata `"SCHEMA_VERSION"` --> `"METADATA_SPEC_VERSION"` - Issue [#1139](https://github.com/sdv-dev/SDV/issues/1139) by @amontanez24
+* Add ability to reset random sampling - Issue [#1130](https://github.com/sdv-dev/SDV/issues/1130) by @pvk-developer
+* Add get_available_demos - Issue [#1129](https://github.com/sdv-dev/SDV/issues/1129) by @fealho
+* Add demo loading functionality - Issue [#1128](https://github.com/sdv-dev/SDV/issues/1128) by @fealho
+* Use logging instead of printing in detect methods - Issue [#1107](https://github.com/sdv-dev/SDV/issues/1107) by @fealho
+* Add save and load methods to synthesizers - Issue [#1106](https://github.com/sdv-dev/SDV/issues/1106) by @pvk-developer
+* Add sampling methods to PARSynthesizer - Issue [#1083](https://github.com/sdv-dev/SDV/issues/1083) by @amontanez24
+* Add transformer methods to PARSynthesizer - Issue [#1082](https://github.com/sdv-dev/SDV/issues/1082) by @fealho
+* Add validate to PARSynthesizer - Issue [#1081](https://github.com/sdv-dev/SDV/issues/1081) by @amontanez24
+* Add preprocess and fit methods to PARSynthesizer - Issue [#1080](https://github.com/sdv-dev/SDV/issues/1080) by @amontanez24
+* Create SingleTablePreset - Issue [#1079](https://github.com/sdv-dev/SDV/issues/1079) by @amontanez24
+* Add sample method to multi-table synthesizers - Issue [#1078](https://github.com/sdv-dev/SDV/issues/1078) by @pvk-developer
+* Add get_learned_distributions method to synthesizers - Issue [#1075](https://github.com/sdv-dev/SDV/issues/1075) by @pvk-developer
+* Add preprocess and fit methods to multi-table synthesizers - Issue [#1074](https://github.com/sdv-dev/SDV/issues/1074) by @pvk-developer
+* Add transformer related methods to BaseMultiTableSynthesizer - Issue [#1072](https://github.com/sdv-dev/SDV/issues/1072) by @fealho
+* Add validate method to `BaseMultiTableSynthesizer` - Issue [#1071](https://github.com/sdv-dev/SDV/issues/1071) by @pvk-developer
+* Create BaseMultiTableSynthesizer and HMASynthesizer classes - Issue [#1070](https://github.com/sdv-dev/SDV/issues/1070) by @pvk-developer
+* Create PARSynthesizer - Issue [#1055](https://github.com/sdv-dev/SDV/issues/1055) by @amontanez24
+* Raise an error if an invalid sdtype is provided to the metadata - Issue [#1042](https://github.com/sdv-dev/SDV/issues/1042) by @amontanez24
+* Only allow datetime and numerical sdtypes to be set as the sequence index - Issue [#1030](https://github.com/sdv-dev/SDV/issues/1030) by @amontanez24
+* Change set_alternate_keys to add_alternate_keys and add error handling - Issue [#1029](https://github.com/sdv-dev/SDV/issues/1029) by @amontanez24
+* Create `MultiTableMetadata.add_table` method - Issue [#1024](https://github.com/sdv-dev/SDV/issues/1024) by @amontanez24
+* Add update_transformers to synthesizers - Issue [#1021](https://github.com/sdv-dev/SDV/issues/1021) by @fealho
+* Add assign_transformers and get_transformers methods to synthesizers - Issue [#1020](https://github.com/sdv-dev/SDV/issues/1020) by @pvk-developer
+* Add fit and fit_processed_data methods to synthesizers - Issue [#1019](https://github.com/sdv-dev/SDV/issues/1019) by @pvk-developer
+* Add preprocess method to synthesizers - Issue [#1018](https://github.com/sdv-dev/SDV/issues/1018) by @pvk-developer
+* Add sampling to synthesizer classes - Issue [#1015](https://github.com/sdv-dev/SDV/issues/1015) by @pvk-developer
+* Add validate method to synthesizer - Issue [#1014](https://github.com/sdv-dev/SDV/issues/1014) by @fealho
+* Create GaussianCopula, CTGAN, TVAE and CopulaGAN synthesizer classes - Issue [#1013](https://github.com/sdv-dev/SDV/issues/1013) by @pvk-developer
+* Create BaseSynthesizer class - Issue [#1012](https://github.com/sdv-dev/SDV/issues/1012) by @pvk-developer
+* Add constraint conversion to upgrade_metadata - Issue [#1005](https://github.com/sdv-dev/SDV/issues/1005) by @amontanez24
+* Add method to generate keys to DataProcessor - Issue [#994](https://github.com/sdv-dev/SDV/issues/994) by @pvk-developer
+* Create formatter - Issue [#970](https://github.com/sdv-dev/SDV/issues/970) by @fealho
+* Create a utility to load multiple CSV files at once - Issue [#969](https://github.com/sdv-dev/SDV/issues/969) by @amontanez24
+* Create a utility to convert old --> new metadata format - Issue [#966](https://github.com/sdv-dev/SDV/issues/966) by @amontanez24
+* Add validation check that `primary_key`, `alternate_keys` and `sequence_key` cannot be sdtype categorical - Issue [#963](https://github.com/sdv-dev/SDV/issues/963) by @fealho
+* Add anonymization to DataProcessor - Issue [#950](https://github.com/sdv-dev/SDV/issues/950) by @pvk-developer
+* Add utility methods to DataProcessor - Issue [#948](https://github.com/sdv-dev/SDV/issues/948) by @fealho
+* Add fit, transform and reverse_transform to DataProcessor - Issue [#947](https://github.com/sdv-dev/SDV/issues/947) by @amontanez24
+* Create DataProcessor class - Issue [#946](https://github.com/sdv-dev/SDV/issues/946) by @amontanez24
+* Add add_constraint method to MultiTableMetadata - Issue [#895](https://github.com/sdv-dev/SDV/issues/895) by @amontanez24
+* Add key related methods to MultiTableMetadata - Issue [#894](https://github.com/sdv-dev/SDV/issues/894) by @fealho
+* Add update_column and add_column methods to MultiTableMetadata - Issue [#893](https://github.com/sdv-dev/SDV/issues/893) by @amontanez24
+* Add detect methods to MultiTableMetadata - Issue [#892](https://github.com/sdv-dev/SDV/issues/892) by @amontanez24
+* Add load_from_json and save_to_json methods to the MultiTableMetadata - Issue [#891](https://github.com/sdv-dev/SDV/issues/891) by @fealho
+* Add add_relationship method to MultiTableMetadata - Issue [#890](https://github.com/sdv-dev/SDV/issues/890) by @pvk-developer
+* Add validate method to MultiTableMetadata - Issue [#888](https://github.com/sdv-dev/SDV/issues/888) by @pvk-developer
+* Add visualize method to MultiTableMetadata class - Issue [#884](https://github.com/sdv-dev/SDV/issues/884) by @amontanez24
+* Create MultiTableMetadata class - Issue [#883](https://github.com/sdv-dev/SDV/issues/883) by @pvk-developer
+* Add add_constraint method to SingleTableMetadata - Issue [#881](https://github.com/sdv-dev/SDV/issues/881) by @amontanez24
+* Add key related methods to SingleTableMetadata - Issue [#880](https://github.com/sdv-dev/SDV/issues/880) by @fealho
+* Add validate method to SingleTableMetadata - Issue [#879](https://github.com/sdv-dev/SDV/issues/879) by @fealho
+* Add _validate_inputs class method to each constraint - Issue [#878](https://github.com/sdv-dev/SDV/issues/878) by @fealho
+* Add update_column and add_column methods to SingleTableMetadata - Issue [#877](https://github.com/sdv-dev/SDV/issues/877) by @pvk-developer
+* Add detect methods to SingleTableMetadata - Issue [#876](https://github.com/sdv-dev/SDV/issues/876) by @pvk-developer
+* Add load_from_json and save_to_json methods to SingleTableMetadata - Issue [#874](https://github.com/sdv-dev/SDV/issues/874) by @pvk-developer
+* Create SingleTableMetadata class - Issue [#873](https://github.com/sdv-dev/SDV/issues/873) by @pvk-developer
+
+#### Bugs Fixed
+
+* In `upgrade_metadata`, PII values are being converted to generic categorical columns - Issue [#1317](https://github.com/sdv-dev/SDV/issues/1317) by @frances-h
+* `PARSynthesizer` is missing `save` and `load` methods - Issue [#1289](https://github.com/sdv-dev/SDV/issues/1289) by @amontanez24
+* Confusing warning when updating transformers - Issue [#1272](https://github.com/sdv-dev/SDV/issues/1272) by @frances-h
+* When adding constraints, `auto_assign_transformers` is showing columns that should no longer exist - Issue [#1260](https://github.com/sdv-dev/SDV/issues/1260) by @pvk-developer
+* Cannot fit twice if I modify transformers: `ValueError: There are non-numerical values in your data.` - Issue [#1259](https://github.com/sdv-dev/SDV/issues/1259) by @frances-h
+* Cannot fit twice if I add constraints: `ValueError: There are non-numerical values in your data.` - Issue [#1258](https://github.com/sdv-dev/SDV/issues/1258) by @frances-h
+* `HMASynthesizer` errors out when fitting a dataset that has a table which holds primary key and foreign keys only - Issue [#1257](https://github.com/sdv-dev/SDV/issues/1257) by @pvk-developer
+* Change ValueErrors to InvalidMetadataErrors - Issue [#1251](https://github.com/sdv-dev/SDV/issues/1251) by @frances-h
+* Multi-table should show foreign key transformers as None - Issue [#1249](https://github.com/sdv-dev/SDV/issues/1249) by @frances-h
+* Cannot use `HMASynthesizer.fit_processed_data` more than once (`KeyError`) - Issue [#1240](https://github.com/sdv-dev/SDV/issues/1240) by @frances-h
+* Function `get_available_demos` crashes if a dataset's `num-tables` or `size-MB` cannot be found - Issue [#1215](https://github.com/sdv-dev/SDV/issues/1215) by @amontanez24
+* Cannot supply a natural key to `HMASynthesizer` (where `sdtype` is custom): Error in `sample` - Issue [#1214](https://github.com/sdv-dev/SDV/issues/1214) by @pvk-developer
+* Unable to sample when using a `PseudoAnonymizedFaker` - Issue [#1207](https://github.com/sdv-dev/SDV/issues/1207) by @pvk-developer
+* Incorrect `sdtype` specified in demo dataset `student_placements_pii` - Issue [#1206](https://github.com/sdv-dev/SDV/issues/1206) by @amontanez24
+* Auto assigned transformers for datetime columns don't have the right parameters - Issue [#1204](https://github.com/sdv-dev/SDV/issues/1204) by @pvk-developer
+* Cannot apply `Inequality` constraint on demo dataset's datetime columns - Issue [#1203](https://github.com/sdv-dev/SDV/issues/1203) by @pvk-developer
+* pii should not be required to auto-assign faker transformers - Issue [#1194](https://github.com/sdv-dev/SDV/issues/1194) by @pvk-developer
+* Misc. bug fixes for SDV 1.0.0 - Issue [#1193](https://github.com/sdv-dev/SDV/issues/1193) by @pvk-developer
+* Small bug fixes in demo module - Issue [#1192](https://github.com/sdv-dev/SDV/issues/1192) by @pvk-developer
+* Foreign Keys are added as Alternate Keys when upgrading - Issue [#1143](https://github.com/sdv-dev/SDV/issues/1143) by @pvk-developer
+* Alternate keys not unique when assigned to a semantic type - Issue [#1111](https://github.com/sdv-dev/SDV/issues/1111) by @pvk-developer
+* Synthesizer errors if column is semantic type and pii is False - Issue [#1110](https://github.com/sdv-dev/SDV/issues/1110) by @fealho
+* Sampled values not unique if primary key is numerical - Issue [#1109](https://github.com/sdv-dev/SDV/issues/1109) by @pvk-developer
+* Validate not called during synthesizer creation - Issue [#1105](https://github.com/sdv-dev/SDV/issues/1105) by @pvk-developer
+* SingleTableSynthesizer fit doesn't update rounding - Issue [#1104](https://github.com/sdv-dev/SDV/issues/1104) by @amontanez24
+* Method `auto_assign_tranformers` always sets `enforce_min_max_values=True` - Issue [#1095](https://github.com/sdv-dev/SDV/issues/1095) by @fealho
+* Sampled context columns in PAR must be in the same order - Issue [#1052](https://github.com/sdv-dev/SDV/issues/1052) by @amontanez24
+* Incorrect schema version printing during detect_table_from_dataframe - Issue [#1038](https://github.com/sdv-dev/SDV/issues/1038) by @amontanez24
+* Same relationship can be added twice to MultiTableMetadata - Issue [#1031](https://github.com/sdv-dev/SDV/issues/1031) by @amontanez24
+* Miscellaneous metadata bugs - Issue [#1026](https://github.com/sdv-dev/SDV/issues/1026) by @amontanez24
+
+#### Maintenance
+
+* SDV Package Maintenance Updates - Issue [#1140](https://github.com/sdv-dev/SDV/issues/1140) by @amontanez24
+
+#### Internal
+
+* Add integration tests for 'Synthesize Sequences' demo - Issue [#1295](https://github.com/sdv-dev/SDV/issues/1295) by @pvk-developer
+* Add integration tests for 'Adding Constraints' demo - Issue [#1280](https://github.com/sdv-dev/SDV/issues/1280) by @pvk-developer
+* Add integration tests to the 'Use Your Own Data' demo - Issue [#1278](https://github.com/sdv-dev/SDV/issues/1278) by @frances-h
+* Add integration tests for 'Synthesize Multi Tables' demo - Issue [#1277](https://github.com/sdv-dev/SDV/issues/1277) by @pvk-developer
+* Add integration tests for 'Synthesize a Table' demo - Issue [#1276](https://github.com/sdv-dev/SDV/issues/1276) by @frances-h
+* Update `get_available_demos` tests - Issue [#1247](https://github.com/sdv-dev/SDV/issues/1247) by @fealho
+* Make private attributes public in the metadata - Issue [#1245](https://github.com/sdv-dev/SDV/issues/1245) by @fealho
+
 ## 0.18.0 - 2023-01-24
 
 This release adds suppport for Python 3.10 and drops support for 3.6.
 
 ### Maintenance
 
 * Drop support for python 3.6 - Issue [#1177](https://github.com/sdv-dev/SDV/issues/1177) by @amontanez24
```

#### html2text {}

```diff
@@ -1,8 +1,8 @@
-Metadata-Version: 2.1 Name: sdv Version: 1.0.0rc0 Summary: Generate synthetic
+Metadata-Version: 2.1 Name: sdv Version: 1.0.1.dev0 Summary: Generate synthetic
 data for single table, multi table and sequential data Home-page: https://
 github.com/sdv-dev/SDV Author: DataCebo, Inc. Author-email: info@sdv.dev
 License: BSL-1.1 Keywords: sdv synthetic-data synhtetic-data-generation
 timeseries single-table multi-table Classifier: Development Status :: 5 -
 Production/Stable Classifier: Intended Audience :: Developers Classifier:
 License :: Free for non-commercial use Classifier: Natural Language :: English
 Classifier: Programming Language :: Python :: 3 Classifier: Programming
@@ -131,37 +131,318 @@
 including: *  Data discovery & transformation. Reverse the transforms to
 reproduce realistic data. *  Multiple machine learning models -- ranging
 from Copulas to Deep Learning -- to create tabular, multi table and time series
 data. *  Measuring quality and privacy of synthetic data, and comparing
 different synthetic data generation models. [Get started using the SDV package]
 (https://bit.ly/sdv-docs) -- a fully integrated solution and your one-stop shop
 for synthetic data. Or, use the standalone libraries for specific needs. #
-Release Notes ## 0.18.0 - 2023-01-24 This release adds suppport for Python 3.10
-and drops support for 3.6. ### Maintenance * Drop support for python 3.6 -
-Issue [#1177](https://github.com/sdv-dev/SDV/issues/1177) by @amontanez24 *
-Support for python 3.10 - Issue [#939](https://github.com/sdv-dev/SDV/issues/
-939) by @amontanez24 * Support Python >=3.10,<4 - Issue [#1000](https://
-github.com/sdv-dev/SDV/issues/1000) by @amontanez24 ## 0.17.2 - 2022-12-08 This
-release fixes a bug in the demo module related to loading the demo data with
-constraints. It also adds a name to the demo datasets. Finally, it bumps the
-version of `SDMetrics` used. ### Maintenance * Upgrade SDMetrics requirement to
-0.8.0 - Issue [#1125](https://github.com/sdv-dev/SDV/issues/1125) by @katxiao
-### New Features * Provide a name for the default demo datasets - Issue [#1124]
-(https://github.com/sdv-dev/SDV/issues/1124) by @amontanez24 ### Bugs Fixed *
-Cannot load_tabular_demo with metadata - Issue [#1123](https://github.com/sdv-
-dev/SDV/issues/1123) by @amontanez24 ## 0.17.1 - 2022-09-29 This release bumps
-the dependency requirements to use the latest version of `SDMetrics`. ###
-Maintenance * Patch release: Bump required version for SDMetrics - Issue
-[#1010](https://github.com/sdv-dev/SDV/issues/1010) by @katxiao ## 0.17.0 -
-2022-09-09 This release updates the code to use RDT version 1.2.0 and greater,
-so that those new features are now available in SDV. This changes the
-transformers that are available in SDV models to be those that are in RDT
-version 1.2.0. As a result, some arguments for initializing models have
-changed. Additionally, this release fixes bugs related to loading models with
-custom constraints. It also fixes a bug that added `NaNs` to the index of
+Release Notes ## 1.0.0 - 2023-03-28 This is a major release that introduces a
+new API to the `SDV` aimed at streamlining the process of synthetic data
+generation! To achieve this, this release includes the addition of several
+large features. ### Metadata Some of the most notable additions are the new
+`SingleTableMetadata` and `MultiTableMetadata` classes. These classes enable a
+number of features that make it easier to synthesize your data correctly such
+as: * Automatic data detection - Calling `metadata.detect_from_dataframe()` or
+`metadata.detect_from_csv()` will populate the metadata autonomously with
+values it thinks represent the data. * Easy updating - Once an instance of the
+metadata is created, values can be easily updated using a number of methods
+defined in the API. For more info, view the [docs](https://docs.sdv.dev/sdv/
+single-table-data/data-preparation/single-table-metadata-api). * Metadata
+validation - Calling `metadata.validate()` will return a report of any invalid
+definitions in the metadata specification. * Upgrading - Users with the
+previous metadata format can easily update to the new specification using the
+`upgrade_metadata()` method. * Saving and loading - The metadata itself can
+easily be saved to a json file and loaded back up later. ### Class and Module
+Names Another major change is the renaming of our core modeling classes and
+modules. The name changes are meant to highlight the difference between the
+underlying machine learning models, and the objects responsible for the end-to-
+end workflow of generating synthetic data. The main name changes are as
+follows: * `tabular` -> `single_table` * `relational` -> `multi_table` *
+`timeseries` -> `sequential` * `BaseTabularModel` -
+> `BaseSingleTableSynthesizer` * `GaussianCopula` -
+> `GaussianCopulaSynthesizer` * `CTGAN` -> `CTGANSynthesizer` * `TVAE` -
+> `TVAESynthesizer` * `CopulaGan` -> `CopulaGANSynthesizer` * `PAR` -
+> `PARSynthesizer` * `HMA1` -> `HMASynthesizer` In `SDV` 1.0, synthesizers are
+classes that take in metadata and handle data preprocessing, model training and
+model sampling. This is similar to the previous `BaseTabularModel` in `SDV`
+<1.0. ### Synthetic Data Workflow `Synthesizers` in `SDV` 1.0 define a clear
+workflow for generating synthetic data. 1. Synthesizers are initialized with a
+metadata class. 2. They can then be used to transform the data and apply
+constraints using the `synthesizer.preprocess()` method. This step also
+validates that the data matches the provided metadata to avoid errors in
+fitting or sampling. 3. The processed data can then be fed into the underlying
+machine learning model using `synthesizer.fit_processed_data()`.
+(Alternatively, data can be preprocessed and fit to the model using
+`synthesizer.fit()`.) 4. Data can then be sampled using `synthesizer.sample()`.
+Each synthesizer class also provides a series of methods to help users
+customize the transformations their data goes through. Read more about that
+[here](https://docs.sdv.dev/sdv/single-table-data/modeling/synthetic-data-
+workflow/transform-and-anonymize). Notice that the preprocessing and model
+fitting steps can now be separated. This can be helpful if preprocessing is
+time consuming or if the data has been processed externally. ### Other Highly
+Requested Features Another major addition is control over randomization. In
+`SDV` <1.0, users could set a seed to control the randomization for only some
+columns. In `SDV` 1.0, randomization is controlled for all columns. Every new
+call to sample generates new data, but the synthesizer's seed can be reset to
+the original state using `synthesizer.reset_randomization()`, enabling
+reproducibility. `SDV 1.0` adds accessibility and transparency into the
+transformers used for preprocessing and underlying machine learning models. *
+Using the `synthesizer.get_transformers()` method, you can access the
+transformers used to preprocess each column and view their properties. This can
+be useful for debugging and accessing privacy information like mappings used to
+mask data. * Distribution parameters learned by copula models can be accessed
+using the `synthesizer.get_learned_distributions()` method. PII handling is
+improved by the following features: * Primary keys can be set to natural
+sdtypes (eg. SSN, email, name). Previously they could only be numerical or
+text. * The `PseudoAnonymizedFaker` can be used to provide consistent mapping
+to PII columns. As mentioned before, the mapping itself can be accessed by
+viewing the transformers for the column using `synthesizer.get_transformers()`.
+* A bug causing PII columns to slow down modeling is patched. Finally, the
+synthetic data can now be easily evaluated using the `evaluate_quality()` and
+`run_diagnostic()` methods. The data can be compared visually to the actual
+data using the `get_column_plot()` and `get_column_pair_plot()` methods. For
+more info on how to visualize or interpret the synthetic data evaluation, read
+the docs [here](https://docs.sdv.dev/sdv/single-table-data/evaluation). ###
+Issues Resolved #### New Features * Change auto_assign_transformers to handle
+id types - Issue [#1325](https://github.com/sdv-dev/SDV/issues/1325) by @pvk-
+developer * Change 'text' sdtype to 'id' - Issue [#1324](https://github.com/
+sdv-dev/SDV/issues/1324) by @frances-h * In `upgrade_metadata`, return the
+object instead of writing it to a JSON file - Issue [#1319](https://github.com/
+sdv-dev/SDV/issues/1319) by @frances-h * In `upgrade_metadata` index primary
+keys should be converted to `text` - Issue [#1318](https://github.com/sdv-dev/
+SDV/issues/1318) by @amontanez24 * Add `load_from_dict` to SingleTableMetadata
+and MultiTableMetadata - Issue [#1314](https://github.com/sdv-dev/SDV/issues/
+1314) by @amontanez24 * Throw a `SynthesizerInputError` if `FixedCombinations`
+constraint is applied to a column that is not `boolean` or `categorical` -
+Issue [#1306](https://github.com/sdv-dev/SDV/issues/1306) by @frances-h *
+Missing `save` and `load` methods for `HMASynthesizer` - Issue [#1262](https://
+github.com/sdv-dev/SDV/issues/1262) by @amontanez24 * Better input validation
+when creating single and multi table synthesizers - Issue [#1242](https://
+github.com/sdv-dev/SDV/issues/1242) by @fealho * Better input validation on
+`HMASynthesizer.sample` - Issue [#1241](https://github.com/sdv-dev/SDV/issues/
+1241) by @R-Palazzo * Validate that relationship must be between a `primary
+key` and `foreign key` - Issue [#1236](https://github.com/sdv-dev/SDV/issues/
+1236) by @fealho * Improve `update_column` validation for `pii` attribute -
+Issue [#1226](https://github.com/sdv-dev/SDV/issues/1226) by @pvk-developer *
+Order the output of `get_transformers()` based on the metadata - Issue [#1222]
+(https://github.com/sdv-dev/SDV/issues/1222) by @pvk-developer * Log if any
+`numerical_distributions` will not be applied - Issue [#1212](https://
+github.com/sdv-dev/SDV/issues/1212) by @fealho * Improve error handling for
+`GaussianCopulaSynthesizer`: `numerical_distributions` - Issue [#1211](https://
+github.com/sdv-dev/SDV/issues/1211) by @fealho * Improve error handling when
+validating `constraints` - Issue [#1210](https://github.com/sdv-dev/SDV/issues/
+1210) by @fealho * Add `fake_companies` demo - Issue [#1209](https://
+github.com/sdv-dev/SDV/issues/1209) by @amontanez24 * Allow me to create a
+custom constraint class and use it in the same file - Issue [#1205](https://
+github.com/sdv-dev/SDV/issues/1205) by @amontanez24 * Sampling should reset
+after retraining the model - Issue [#1201](https://github.com/sdv-dev/SDV/
+issues/1201) by @pvk-developer * Change function name
+`HMASynthesizer.update_table_parameters` --> `set_table_parameters` - Issue
+[#1200](https://github.com/sdv-dev/SDV/issues/1200) by @pvk-developer * Add
+`get_info` method to synthesizers - Issue [#1199](https://github.com/sdv-dev/
+SDV/issues/1199) by @fealho * Add evaluation methods to synthesizer - Issue
+[#1190](https://github.com/sdv-dev/SDV/issues/1190) by @fealho * Update
+`evaluate.py` to work with the new `metadata` - Issue [#1186](https://
+github.com/sdv-dev/SDV/issues/1186) by @fealho * Remove old code - Issue
+[#1181](https://github.com/sdv-dev/SDV/issues/1181) by @pvk-developer * Drop
+support for python 3.6 and add support for 3.10 - Issue [#1176](https://
+github.com/sdv-dev/SDV/issues/1176) by @fealho * Add constraint methods to
+MultiTableSynthesizers - Issue [#1171](https://github.com/sdv-dev/SDV/issues/
+1171) by @fealho * Update custom constraint workflow - Issue [#1169](https://
+github.com/sdv-dev/SDV/issues/1169) by @pvk-developer * Add get_constraints
+method to synthesizers - Issue [#1168](https://github.com/sdv-dev/SDV/issues/
+1168) by @pvk-developer * Migrate adding and validating constraints to
+BaseSynthesizer - Issue [#1163](https://github.com/sdv-dev/SDV/issues/1163) by
+@pvk-developer * Change metadata `"SCHEMA_VERSION"` --
+> `"METADATA_SPEC_VERSION"` - Issue [#1139](https://github.com/sdv-dev/SDV/
+issues/1139) by @amontanez24 * Add ability to reset random sampling - Issue
+[#1130](https://github.com/sdv-dev/SDV/issues/1130) by @pvk-developer * Add
+get_available_demos - Issue [#1129](https://github.com/sdv-dev/SDV/issues/1129)
+by @fealho * Add demo loading functionality - Issue [#1128](https://github.com/
+sdv-dev/SDV/issues/1128) by @fealho * Use logging instead of printing in detect
+methods - Issue [#1107](https://github.com/sdv-dev/SDV/issues/1107) by @fealho
+* Add save and load methods to synthesizers - Issue [#1106](https://github.com/
+sdv-dev/SDV/issues/1106) by @pvk-developer * Add sampling methods to
+PARSynthesizer - Issue [#1083](https://github.com/sdv-dev/SDV/issues/1083) by
+@amontanez24 * Add transformer methods to PARSynthesizer - Issue [#1082](https:
+//github.com/sdv-dev/SDV/issues/1082) by @fealho * Add validate to
+PARSynthesizer - Issue [#1081](https://github.com/sdv-dev/SDV/issues/1081) by
+@amontanez24 * Add preprocess and fit methods to PARSynthesizer - Issue [#1080]
+(https://github.com/sdv-dev/SDV/issues/1080) by @amontanez24 * Create
+SingleTablePreset - Issue [#1079](https://github.com/sdv-dev/SDV/issues/1079)
+by @amontanez24 * Add sample method to multi-table synthesizers - Issue [#1078]
+(https://github.com/sdv-dev/SDV/issues/1078) by @pvk-developer * Add
+get_learned_distributions method to synthesizers - Issue [#1075](https://
+github.com/sdv-dev/SDV/issues/1075) by @pvk-developer * Add preprocess and fit
+methods to multi-table synthesizers - Issue [#1074](https://github.com/sdv-dev/
+SDV/issues/1074) by @pvk-developer * Add transformer related methods to
+BaseMultiTableSynthesizer - Issue [#1072](https://github.com/sdv-dev/SDV/
+issues/1072) by @fealho * Add validate method to `BaseMultiTableSynthesizer` -
+Issue [#1071](https://github.com/sdv-dev/SDV/issues/1071) by @pvk-developer *
+Create BaseMultiTableSynthesizer and HMASynthesizer classes - Issue [#1070]
+(https://github.com/sdv-dev/SDV/issues/1070) by @pvk-developer * Create
+PARSynthesizer - Issue [#1055](https://github.com/sdv-dev/SDV/issues/1055) by
+@amontanez24 * Raise an error if an invalid sdtype is provided to the metadata
+- Issue [#1042](https://github.com/sdv-dev/SDV/issues/1042) by @amontanez24 *
+Only allow datetime and numerical sdtypes to be set as the sequence index -
+Issue [#1030](https://github.com/sdv-dev/SDV/issues/1030) by @amontanez24 *
+Change set_alternate_keys to add_alternate_keys and add error handling - Issue
+[#1029](https://github.com/sdv-dev/SDV/issues/1029) by @amontanez24 * Create
+`MultiTableMetadata.add_table` method - Issue [#1024](https://github.com/sdv-
+dev/SDV/issues/1024) by @amontanez24 * Add update_transformers to synthesizers
+- Issue [#1021](https://github.com/sdv-dev/SDV/issues/1021) by @fealho * Add
+assign_transformers and get_transformers methods to synthesizers - Issue
+[#1020](https://github.com/sdv-dev/SDV/issues/1020) by @pvk-developer * Add fit
+and fit_processed_data methods to synthesizers - Issue [#1019](https://
+github.com/sdv-dev/SDV/issues/1019) by @pvk-developer * Add preprocess method
+to synthesizers - Issue [#1018](https://github.com/sdv-dev/SDV/issues/1018) by
+@pvk-developer * Add sampling to synthesizer classes - Issue [#1015](https://
+github.com/sdv-dev/SDV/issues/1015) by @pvk-developer * Add validate method to
+synthesizer - Issue [#1014](https://github.com/sdv-dev/SDV/issues/1014) by
+@fealho * Create GaussianCopula, CTGAN, TVAE and CopulaGAN synthesizer classes
+- Issue [#1013](https://github.com/sdv-dev/SDV/issues/1013) by @pvk-developer *
+Create BaseSynthesizer class - Issue [#1012](https://github.com/sdv-dev/SDV/
+issues/1012) by @pvk-developer * Add constraint conversion to upgrade_metadata
+- Issue [#1005](https://github.com/sdv-dev/SDV/issues/1005) by @amontanez24 *
+Add method to generate keys to DataProcessor - Issue [#994](https://github.com/
+sdv-dev/SDV/issues/994) by @pvk-developer * Create formatter - Issue [#970]
+(https://github.com/sdv-dev/SDV/issues/970) by @fealho * Create a utility to
+load multiple CSV files at once - Issue [#969](https://github.com/sdv-dev/SDV/
+issues/969) by @amontanez24 * Create a utility to convert old --> new metadata
+format - Issue [#966](https://github.com/sdv-dev/SDV/issues/966) by
+@amontanez24 * Add validation check that `primary_key`, `alternate_keys` and
+`sequence_key` cannot be sdtype categorical - Issue [#963](https://github.com/
+sdv-dev/SDV/issues/963) by @fealho * Add anonymization to DataProcessor - Issue
+[#950](https://github.com/sdv-dev/SDV/issues/950) by @pvk-developer * Add
+utility methods to DataProcessor - Issue [#948](https://github.com/sdv-dev/SDV/
+issues/948) by @fealho * Add fit, transform and reverse_transform to
+DataProcessor - Issue [#947](https://github.com/sdv-dev/SDV/issues/947) by
+@amontanez24 * Create DataProcessor class - Issue [#946](https://github.com/
+sdv-dev/SDV/issues/946) by @amontanez24 * Add add_constraint method to
+MultiTableMetadata - Issue [#895](https://github.com/sdv-dev/SDV/issues/895) by
+@amontanez24 * Add key related methods to MultiTableMetadata - Issue [#894]
+(https://github.com/sdv-dev/SDV/issues/894) by @fealho * Add update_column and
+add_column methods to MultiTableMetadata - Issue [#893](https://github.com/sdv-
+dev/SDV/issues/893) by @amontanez24 * Add detect methods to MultiTableMetadata
+- Issue [#892](https://github.com/sdv-dev/SDV/issues/892) by @amontanez24 * Add
+load_from_json and save_to_json methods to the MultiTableMetadata - Issue
+[#891](https://github.com/sdv-dev/SDV/issues/891) by @fealho * Add
+add_relationship method to MultiTableMetadata - Issue [#890](https://
+github.com/sdv-dev/SDV/issues/890) by @pvk-developer * Add validate method to
+MultiTableMetadata - Issue [#888](https://github.com/sdv-dev/SDV/issues/888) by
+@pvk-developer * Add visualize method to MultiTableMetadata class - Issue
+[#884](https://github.com/sdv-dev/SDV/issues/884) by @amontanez24 * Create
+MultiTableMetadata class - Issue [#883](https://github.com/sdv-dev/SDV/issues/
+883) by @pvk-developer * Add add_constraint method to SingleTableMetadata -
+Issue [#881](https://github.com/sdv-dev/SDV/issues/881) by @amontanez24 * Add
+key related methods to SingleTableMetadata - Issue [#880](https://github.com/
+sdv-dev/SDV/issues/880) by @fealho * Add validate method to SingleTableMetadata
+- Issue [#879](https://github.com/sdv-dev/SDV/issues/879) by @fealho * Add
+_validate_inputs class method to each constraint - Issue [#878](https://
+github.com/sdv-dev/SDV/issues/878) by @fealho * Add update_column and
+add_column methods to SingleTableMetadata - Issue [#877](https://github.com/
+sdv-dev/SDV/issues/877) by @pvk-developer * Add detect methods to
+SingleTableMetadata - Issue [#876](https://github.com/sdv-dev/SDV/issues/876)
+by @pvk-developer * Add load_from_json and save_to_json methods to
+SingleTableMetadata - Issue [#874](https://github.com/sdv-dev/SDV/issues/874)
+by @pvk-developer * Create SingleTableMetadata class - Issue [#873](https://
+github.com/sdv-dev/SDV/issues/873) by @pvk-developer #### Bugs Fixed * In
+`upgrade_metadata`, PII values are being converted to generic categorical
+columns - Issue [#1317](https://github.com/sdv-dev/SDV/issues/1317) by
+@frances-h * `PARSynthesizer` is missing `save` and `load` methods - Issue
+[#1289](https://github.com/sdv-dev/SDV/issues/1289) by @amontanez24 * Confusing
+warning when updating transformers - Issue [#1272](https://github.com/sdv-dev/
+SDV/issues/1272) by @frances-h * When adding constraints,
+`auto_assign_transformers` is showing columns that should no longer exist -
+Issue [#1260](https://github.com/sdv-dev/SDV/issues/1260) by @pvk-developer *
+Cannot fit twice if I modify transformers: `ValueError: There are non-numerical
+values in your data.` - Issue [#1259](https://github.com/sdv-dev/SDV/issues/
+1259) by @frances-h * Cannot fit twice if I add constraints: `ValueError: There
+are non-numerical values in your data.` - Issue [#1258](https://github.com/sdv-
+dev/SDV/issues/1258) by @frances-h * `HMASynthesizer` errors out when fitting a
+dataset that has a table which holds primary key and foreign keys only - Issue
+[#1257](https://github.com/sdv-dev/SDV/issues/1257) by @pvk-developer * Change
+ValueErrors to InvalidMetadataErrors - Issue [#1251](https://github.com/sdv-
+dev/SDV/issues/1251) by @frances-h * Multi-table should show foreign key
+transformers as None - Issue [#1249](https://github.com/sdv-dev/SDV/issues/
+1249) by @frances-h * Cannot use `HMASynthesizer.fit_processed_data` more than
+once (`KeyError`) - Issue [#1240](https://github.com/sdv-dev/SDV/issues/1240)
+by @frances-h * Function `get_available_demos` crashes if a dataset's `num-
+tables` or `size-MB` cannot be found - Issue [#1215](https://github.com/sdv-
+dev/SDV/issues/1215) by @amontanez24 * Cannot supply a natural key to
+`HMASynthesizer` (where `sdtype` is custom): Error in `sample` - Issue [#1214]
+(https://github.com/sdv-dev/SDV/issues/1214) by @pvk-developer * Unable to
+sample when using a `PseudoAnonymizedFaker` - Issue [#1207](https://github.com/
+sdv-dev/SDV/issues/1207) by @pvk-developer * Incorrect `sdtype` specified in
+demo dataset `student_placements_pii` - Issue [#1206](https://github.com/sdv-
+dev/SDV/issues/1206) by @amontanez24 * Auto assigned transformers for datetime
+columns don't have the right parameters - Issue [#1204](https://github.com/sdv-
+dev/SDV/issues/1204) by @pvk-developer * Cannot apply `Inequality` constraint
+on demo dataset's datetime columns - Issue [#1203](https://github.com/sdv-dev/
+SDV/issues/1203) by @pvk-developer * pii should not be required to auto-assign
+faker transformers - Issue [#1194](https://github.com/sdv-dev/SDV/issues/1194)
+by @pvk-developer * Misc. bug fixes for SDV 1.0.0 - Issue [#1193](https://
+github.com/sdv-dev/SDV/issues/1193) by @pvk-developer * Small bug fixes in demo
+module - Issue [#1192](https://github.com/sdv-dev/SDV/issues/1192) by @pvk-
+developer * Foreign Keys are added as Alternate Keys when upgrading - Issue
+[#1143](https://github.com/sdv-dev/SDV/issues/1143) by @pvk-developer *
+Alternate keys not unique when assigned to a semantic type - Issue [#1111]
+(https://github.com/sdv-dev/SDV/issues/1111) by @pvk-developer * Synthesizer
+errors if column is semantic type and pii is False - Issue [#1110](https://
+github.com/sdv-dev/SDV/issues/1110) by @fealho * Sampled values not unique if
+primary key is numerical - Issue [#1109](https://github.com/sdv-dev/SDV/issues/
+1109) by @pvk-developer * Validate not called during synthesizer creation -
+Issue [#1105](https://github.com/sdv-dev/SDV/issues/1105) by @pvk-developer *
+SingleTableSynthesizer fit doesn't update rounding - Issue [#1104](https://
+github.com/sdv-dev/SDV/issues/1104) by @amontanez24 * Method
+`auto_assign_tranformers` always sets `enforce_min_max_values=True` - Issue
+[#1095](https://github.com/sdv-dev/SDV/issues/1095) by @fealho * Sampled
+context columns in PAR must be in the same order - Issue [#1052](https://
+github.com/sdv-dev/SDV/issues/1052) by @amontanez24 * Incorrect schema version
+printing during detect_table_from_dataframe - Issue [#1038](https://github.com/
+sdv-dev/SDV/issues/1038) by @amontanez24 * Same relationship can be added twice
+to MultiTableMetadata - Issue [#1031](https://github.com/sdv-dev/SDV/issues/
+1031) by @amontanez24 * Miscellaneous metadata bugs - Issue [#1026](https://
+github.com/sdv-dev/SDV/issues/1026) by @amontanez24 #### Maintenance * SDV
+Package Maintenance Updates - Issue [#1140](https://github.com/sdv-dev/SDV/
+issues/1140) by @amontanez24 #### Internal * Add integration tests for
+'Synthesize Sequences' demo - Issue [#1295](https://github.com/sdv-dev/SDV/
+issues/1295) by @pvk-developer * Add integration tests for 'Adding Constraints'
+demo - Issue [#1280](https://github.com/sdv-dev/SDV/issues/1280) by @pvk-
+developer * Add integration tests to the 'Use Your Own Data' demo - Issue
+[#1278](https://github.com/sdv-dev/SDV/issues/1278) by @frances-h * Add
+integration tests for 'Synthesize Multi Tables' demo - Issue [#1277](https://
+github.com/sdv-dev/SDV/issues/1277) by @pvk-developer * Add integration tests
+for 'Synthesize a Table' demo - Issue [#1276](https://github.com/sdv-dev/SDV/
+issues/1276) by @frances-h * Update `get_available_demos` tests - Issue [#1247]
+(https://github.com/sdv-dev/SDV/issues/1247) by @fealho * Make private
+attributes public in the metadata - Issue [#1245](https://github.com/sdv-dev/
+SDV/issues/1245) by @fealho ## 0.18.0 - 2023-01-24 This release adds suppport
+for Python 3.10 and drops support for 3.6. ### Maintenance * Drop support for
+python 3.6 - Issue [#1177](https://github.com/sdv-dev/SDV/issues/1177) by
+@amontanez24 * Support for python 3.10 - Issue [#939](https://github.com/sdv-
+dev/SDV/issues/939) by @amontanez24 * Support Python >=3.10,<4 - Issue [#1000]
+(https://github.com/sdv-dev/SDV/issues/1000) by @amontanez24 ## 0.17.2 - 2022-
+12-08 This release fixes a bug in the demo module related to loading the demo
+data with constraints. It also adds a name to the demo datasets. Finally, it
+bumps the version of `SDMetrics` used. ### Maintenance * Upgrade SDMetrics
+requirement to 0.8.0 - Issue [#1125](https://github.com/sdv-dev/SDV/issues/
+1125) by @katxiao ### New Features * Provide a name for the default demo
+datasets - Issue [#1124](https://github.com/sdv-dev/SDV/issues/1124) by
+@amontanez24 ### Bugs Fixed * Cannot load_tabular_demo with metadata - Issue
+[#1123](https://github.com/sdv-dev/SDV/issues/1123) by @amontanez24 ## 0.17.1 -
+2022-09-29 This release bumps the dependency requirements to use the latest
+version of `SDMetrics`. ### Maintenance * Patch release: Bump required version
+for SDMetrics - Issue [#1010](https://github.com/sdv-dev/SDV/issues/1010) by
+@katxiao ## 0.17.0 - 2022-09-09 This release updates the code to use RDT
+version 1.2.0 and greater, so that those new features are now available in SDV.
+This changes the transformers that are available in SDV models to be those that
+are in RDT version 1.2.0. As a result, some arguments for initializing models
+have changed. Additionally, this release fixes bugs related to loading models
+with custom constraints. It also fixes a bug that added `NaNs` to the index of
 sampled data when using `sample_remaining_columns`. ### Bugs Fixed * Incorrect
 rounding in Custom Constraint example - Issue [#941](https://github.com/sdv-
 dev/SDV/issues/941) by @amontanez24 * Can't save the model if use the custom
 constraint - Issue [#928](https://github.com/sdv-dev/SDV/issues/928) by @pvk-
 developer * User Guide code fixes - Issue [#983](https://github.com/sdv-dev/
 SDV/issues/983) by @amontanez24 * Index contains NaNs when using
 sample_remaining_columns - Issue [#985](https://github.com/sdv-dev/SDV/issues/
```

### Comparing `sdv-1.0.0rc0/sdv.egg-info/SOURCES.txt` & `sdv-1.0.1.dev0/sdv.egg-info/SOURCES.txt`

 * *Files 0% similar despite different names*

```diff
@@ -461,14 +461,15 @@
 docs/user_guides/single_table/table_metadata.rst
 docs/user_guides/single_table/tabular_preset.rst
 docs/user_guides/single_table/tvae.rst
 docs/user_guides/timeseries/index.rst
 docs/user_guides/timeseries/models.rst
 docs/user_guides/timeseries/par.rst
 sdv/__init__.py
+sdv/_addons.py
 sdv/errors.py
 sdv/utils.py
 sdv.egg-info/PKG-INFO
 sdv.egg-info/SOURCES.txt
 sdv.egg-info/dependency_links.txt
 sdv.egg-info/not-zip-safe
 sdv.egg-info/requires.txt
@@ -541,14 +542,15 @@
 tests/integration/single_table/__init__.py
 tests/integration/single_table/custom_constraints.py
 tests/integration/single_table/test_base.py
 tests/integration/single_table/test_copulas.py
 tests/integration/single_table/test_ctgan.py
 tests/readme_test/README.md
 tests/unit/__init__.py
+tests/unit/test__addons.py
 tests/unit/constraints/__init__.py
 tests/unit/constraints/test_base.py
 tests/unit/constraints/test_tabular.py
 tests/unit/constraints/test_utils.py
 tests/unit/data_processing/__init__.py
 tests/unit/data_processing/test_data_processor.py
 tests/unit/data_processing/test_datetime_formatter.py
```

### Comparing `sdv-1.0.0rc0/sdv.egg-info/requires.txt` & `sdv-1.0.1.dev0/sdv.egg-info/requires.txt`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/setup.cfg` & `sdv-1.0.1.dev0/setup.cfg`

 * *Files 14% similar despite different names*

```diff
@@ -1,9 +1,9 @@
 [bumpversion]
-current_version = 1.0.0rc0
+current_version = 1.0.1.dev0
 commit = True
 tag = True
 parse = (?P<major>\d+)\.(?P<minor>\d+)\.(?P<patch>\d+)(\.(?P<release>[a-z]+)(?P<candidate>\d+))?
 serialize = 
 	{major}.{minor}.{patch}.{release}{candidate}
 	{major}.{minor}.{patch}
```

### Comparing `sdv-1.0.0rc0/setup.py` & `sdv-1.0.1.dev0/setup.py`

 * *Files 0% similar despite different names*

```diff
@@ -132,10 +132,10 @@
     name='sdv',
     packages=find_packages(include=['sdv', 'sdv.*']),
     python_requires='>=3.7,<3.11',
     setup_requires=setup_requires,
     test_suite='tests',
     tests_require=tests_require,
     url='https://github.com/sdv-dev/SDV',
-    version='1.0.0rc0',
+    version='1.0.1.dev0',
     zip_safe=False,
 )
```

### Comparing `sdv-1.0.0rc0/tests/integration/data_processing/test_data_processor.py` & `sdv-1.0.1.dev0/tests/integration/data_processing/test_data_processor.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/integration/dataset.py` & `sdv-1.0.1.dev0/tests/integration/dataset.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/integration/datasets/test_demo.py` & `sdv-1.0.1.dev0/tests/integration/datasets/test_demo.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/integration/evaluation/test_multi_table.py` & `sdv-1.0.1.dev0/tests/integration/evaluation/test_multi_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/integration/evaluation/test_single_table.py` & `sdv-1.0.1.dev0/tests/integration/evaluation/test_single_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/integration/lite/test_single_table.py` & `sdv-1.0.1.dev0/tests/integration/lite/test_single_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/integration/metadata/test_multi_table.py` & `sdv-1.0.1.dev0/tests/integration/metadata/test_multi_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/integration/metadata/test_single_table.py` & `sdv-1.0.1.dev0/tests/integration/metadata/test_single_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/integration/multi_table/test_hma.py` & `sdv-1.0.1.dev0/tests/integration/multi_table/test_hma.py`

 * *Files 3% similar despite different names*

```diff
@@ -143,23 +143,26 @@
 
     assert hmasynthesizer._table_synthesizers['characters'].default_distribution == 'gamma'
     assert hmasynthesizer._table_synthesizers['families'].default_distribution == 'uniform'
     assert hmasynthesizer._table_synthesizers['character_families'].default_distribution == 'norm'
 
 
 def get_custom_constraint_data_and_metadata():
+    """Return data and metadata for the custom constraint tests."""
     parent_data = pd.DataFrame({
         'primary_key': [1000, 1001, 1002],
         'numerical_col': [2, 3, 4],
         'categorical_col': ['a', 'b', 'a'],
     })
     child_data = pd.DataFrame({
         'user_id': [1000, 1001, 1000],
         'id': [1, 2, 3],
-        'random': ['a', 'b', 'c']
+        'random': ['a', 'b', 'c'],
+        'numerical_col': [0.2, 0.7, 1.3],
+        'numerical_col_2': [2, 4, 6],
     })
 
     metadata = MultiTableMetadata()
     metadata.detect_table_from_dataframe('parent', parent_data)
     metadata.update_column('parent', 'primary_key', sdtype='id')
     metadata.detect_table_from_dataframe('child', child_data)
     metadata.update_column('child', 'user_id', sdtype='id')
@@ -174,24 +177,25 @@
     )
 
     return parent_data, child_data, metadata
 
 
 def test_hma_custom_constraint():
     """Test an example of using a custom constraint."""
+    # Setup
     parent_data, child_data, metadata = get_custom_constraint_data_and_metadata()
     synthesizer = HMASynthesizer(metadata)
     constraint = {
         'table_name': 'parent',
         'constraint_class': 'MyConstraint',
         'constraint_parameters': {
             'column_names': ['numerical_col']
         }
     }
-    synthesizer.add_custom_constraint_class('parent', MyConstraint, 'MyConstraint')
+    synthesizer.add_custom_constraint_class(MyConstraint, 'MyConstraint')
 
     # Run
     synthesizer.add_constraints(constraints=[constraint])
     processed_data = synthesizer.preprocess({'parent': parent_data, 'child': child_data})
 
     # Assert Processed Data
     np.testing.assert_equal(
@@ -203,27 +207,77 @@
     synthesizer.fit_processed_data(processed_data)
 
     # Run - sample
     sampled = synthesizer.sample(10)
     assert all(sampled['parent']['numerical_col'] > 1)
 
 
+def test_hma_custom_constraint_2_tables():
+    """Test an example of using a custom constraint.
+
+    Check that the same custom constraint can be applied to two different tables and columns.
+    """
+    # Setup
+    parent_data, child_data, metadata = get_custom_constraint_data_and_metadata()
+    synthesizer = HMASynthesizer(metadata)
+
+    constraint_parent = {
+        'table_name': 'parent',
+        'constraint_class': 'MyConstraint',
+        'constraint_parameters': {
+            'column_names': ['numerical_col']
+        }
+    }
+
+    constraint_child = {
+        'table_name': 'child',
+        'constraint_class': 'MyConstraint',
+        'constraint_parameters': {
+            'column_names': ['numerical_col_2']
+        }
+    }
+    synthesizer.add_custom_constraint_class(MyConstraint, 'MyConstraint')
+
+    # Run
+    synthesizer.add_constraints(constraints=[constraint_parent, constraint_child])
+    processed_data = synthesizer.preprocess({'parent': parent_data, 'child': child_data})
+
+    # Assert Processed Data
+    np.testing.assert_equal(
+        processed_data['parent']['numerical_col'].array,
+        (parent_data['numerical_col'] ** 2.0).array
+    )
+    np.testing.assert_equal(
+        processed_data['child']['numerical_col_2'].array,
+        (child_data['numerical_col_2'] ** 2.0).array
+    )
+
+    # Run - Fit the model
+    synthesizer.fit_processed_data(processed_data)
+
+    # Run - sample
+    sampled = synthesizer.sample(10)
+    assert all(sampled['parent']['numerical_col'] > 1)
+    assert all(sampled['child']['numerical_col_2'] > 1)
+    assert not all(sampled['child']['numerical_col'] > 1)
+
+
 def test_hma_custom_constraint_loaded_from_file():
     """Test an example of using a custom constraint loaded from a file."""
+    # Setup
     parent_data, child_data, metadata = get_custom_constraint_data_and_metadata()
     synthesizer = HMASynthesizer(metadata)
     constraint = {
         'table_name': 'parent',
         'constraint_class': 'MyConstraint',
         'constraint_parameters': {
             'column_names': ['numerical_col']
         }
     }
     synthesizer.load_custom_constraint_classes(
-        'parent',
         'tests/integration/single_table/custom_constraints.py',
         ['MyConstraint']
     )
 
     # Run
     synthesizer.add_constraints(constraints=[constraint])
     processed_data = synthesizer.preprocess({'parent': parent_data, 'child': child_data})
```

### Comparing `sdv-1.0.0rc0/tests/integration/sequential/test_par.py` & `sdv-1.0.1.dev0/tests/integration/sequential/test_par.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/integration/single_table/custom_constraints.py` & `sdv-1.0.1.dev0/tests/integration/single_table/custom_constraints.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/integration/single_table/test_base.py` & `sdv-1.0.1.dev0/tests/integration/single_table/test_base.py`

 * *Files 7% similar despite different names*

```diff
@@ -534,14 +534,59 @@
 
     assert transformers['primary_key'].regex_format == 'user-[0-9]{3}'
     assert transformers['primary_key'].enforce_uniqueness is True
 
     assert transformers['categorical_col'].add_noise is True
 
 
+def test_modeling_with_complex_datetimes():
+    """Test that models work with datetimes passed as strings or ints with complex format."""
+    # Setup
+    data = pd.DataFrame(data={
+        'string_column': [
+            '20220902110443000000',
+            '20220916230356000000',
+            '20220826173917000000',
+            '20220826212135000000',
+            '20220929111311000000'
+        ],
+        'int_column': [
+            20220902110443000000,
+            20220916230356000000,
+            20220826173917000000,
+            20220826212135000000,
+            20220929111311000000
+        ]
+    })
+
+    test_metadata = {
+        'columns': {
+            'string_column': {
+                'sdtype': 'datetime',
+                'datetime_format': '%Y%m%d%H%M%S%f'
+            },
+            'int_column': {
+                'sdtype': 'datetime',
+                'datetime_format': '%Y%m%d%H%M%S%f'
+            }
+        }
+    }
+
+    # Run
+    metadata = SingleTableMetadata.load_from_dict(test_metadata)
+    metadata.validate()
+    synth = GaussianCopulaSynthesizer(metadata)
+    synth.validate(data)
+    synth.fit(data)
+    sampled = synth.sample(10)
+
+    # Assert
+    synth.validate(sampled)
+
+
 def test_custom_constraints_from_file(tmpdir):
     """Ensure the correct loading for a custom constraint class defined in another file."""
     data = pd.DataFrame({
         'primary_key': ['user-000', 'user-001', 'user-002'],
         'pii_col': ['223 Williams Rd', '75 Waltham St', '77 Mass Ave'],
         'numerical_col': [2, 3, 4],
         'categorical_col': ['a', 'b', 'a'],
```

### Comparing `sdv-1.0.0rc0/tests/integration/single_table/test_copulas.py` & `sdv-1.0.1.dev0/tests/integration/single_table/test_copulas.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/integration/single_table/test_ctgan.py` & `sdv-1.0.1.dev0/tests/integration/single_table/test_ctgan.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/readme_test/README.md` & `sdv-1.0.1.dev0/tests/readme_test/README.md`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/constraints/test_base.py` & `sdv-1.0.1.dev0/tests/unit/constraints/test_base.py`

 * *Files 0% similar despite different names*

```diff
@@ -886,15 +886,15 @@
         Output:
             - Transformed data with all columns.
         """
         # Setup
         constraint = Mock()
         constraint.is_valid.side_effect = lambda x: pd.Series(
             [True for _ in range(len(x))],
-            index=x.index
+            index=x.index, dtype=bool
         )
         instance = ColumnsModel(constraint, ['a', 'b'])
         instance._hyper_transformer = Mock()
         instance._model = Mock()
         transformed_conditions = [pd.DataFrame([[1], [1], [1], [1], [1]], columns=['b'])]
         instance._model.sample.side_effect = [pd.DataFrame()] * 100 + [
             pd.DataFrame({
@@ -937,15 +937,15 @@
         Side Effects:
             - A ``ValueError`` should be raised.
         """
         # Setup
         constraint = Mock()
         constraint.is_valid.side_effect = lambda x: pd.Series(
             [False for _ in range(len(x))],
-            index=x.index
+            index=x.index, dtype=bool
         )
         instance = ColumnsModel(constraint, ['a', 'b'])
         instance._hyper_transformer = Mock()
         instance._model = Mock()
         transformed_conditions = [pd.DataFrame([[1], [1], [1], [1], [1]], columns=['b'])]
         instance._model.sample.side_effect = [pd.DataFrame()] * 100 + [
             pd.DataFrame({
```

### Comparing `sdv-1.0.0rc0/tests/unit/constraints/test_tabular.py` & `sdv-1.0.1.dev0/tests/unit/constraints/test_tabular.py`

 * *Files 0% similar despite different names*

```diff
@@ -3109,7120 +3109,7166 @@
 0000c240: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
 0000c250: 2020 2065 7870 6563 7465 645f 6f75 7420     expected_out 
 0000c260: 3d20 5b54 7275 652c 2046 616c 7365 2c20  = [True, False, 
 0000c270: 5472 7565 5d0a 2020 2020 2020 2020 6e70  True].        np
 0000c280: 2e74 6573 7469 6e67 2e61 7373 6572 745f  .testing.assert_
 0000c290: 6172 7261 795f 6571 7561 6c28 6578 7065  array_equal(expe
 0000c2a0: 6374 6564 5f6f 7574 2c20 6f75 7429 0a0a  cted_out, out)..
-0000c2b0: 2020 2020 6465 6620 7465 7374 5f5f 7472      def test__tr
-0000c2c0: 616e 7366 6f72 6d28 7365 6c66 293a 0a20  ansform(self):. 
-0000c2d0: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
-0000c2e0: 6865 2060 6049 6e65 7175 616c 6974 792e  he ``Inequality.
-0000c2f0: 5f74 7261 6e73 666f 726d 6060 206d 6574  _transform`` met
-0000c300: 686f 642e 0a0a 2020 2020 2020 2020 5468  hod...        Th
-0000c310: 6520 6d65 7468 6f64 2069 7320 6578 7065  e method is expe
-0000c320: 6374 6564 2074 6f20 636f 6d70 7574 6520  cted to compute 
-0000c330: 7468 6520 6469 7374 616e 6365 2062 6574  the distance bet
-0000c340: 7765 656e 2074 6865 2068 6967 6820 616e  ween the high an
-0000c350: 6420 6c6f 7720 636f 6c75 6d6e 730a 2020  d low columns.  
-0000c360: 2020 2020 2020 616e 6420 6372 6561 7465        and create
-0000c370: 2061 2064 6966 6620 636f 6c75 6d6e 2077   a diff column w
-0000c380: 6974 6820 7468 6520 6c6f 6761 7269 7468  ith the logarith
-0000c390: 6d20 6f66 2074 6865 2064 6973 7461 6e63  m of the distanc
-0000c3a0: 6520 2b20 312e 0a0a 2020 2020 2020 2020  e + 1...        
-0000c3b0: 5365 7475 703a 0a20 2020 2020 2020 202d  Setup:.        -
-0000c3c0: 2060 605f 6469 6666 5f63 6f6c 756d 6e5f   ``_diff_column_
-0000c3d0: 6e61 6d65 6060 2069 7320 7365 7420 746f  name`` is set to
-0000c3e0: 2060 6027 6123 6227 6060 2e0a 2020 2020   ``'a#b'``..    
-0000c3f0: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
-0000c400: 2020 202d 2054 6162 6c65 2077 6974 6820     - Table with 
-0000c410: 7477 6f20 636f 6c75 6d6e 7320 6174 2061  two columns at a
-0000c420: 2063 6f6e 7374 616e 7420 6469 7374 616e   constant distan
-0000c430: 6365 206f 6620 3320 616e 6420 6f6e 6520  ce of 3 and one 
-0000c440: 6164 6469 7469 6f6e 616c 2064 756d 6d79  additional dummy
-0000c450: 2063 6f6c 756d 6e2e 0a20 2020 2020 2020   column..       
-0000c460: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
-0000c470: 202d 2053 616d 6520 7461 626c 6520 7769   - Same table wi
-0000c480: 7468 2061 2064 6966 6620 636f 6c75 6d6e  th a diff column
-0000c490: 206f 6620 7468 6520 6c6f 6720 6f66 2064   of the log of d
-0000c4a0: 6973 7461 6e63 6573 202b 2031 2c20 7768  istances + 1, wh
-0000c4b0: 6963 6820 6973 206e 702e 6c6f 6728 3429  ich is np.log(4)
-0000c4c0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0000c4d0: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
-0000c4e0: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
-0000c4f0: 2049 6e65 7175 616c 6974 7928 6c6f 775f   Inequality(low_
-0000c500: 636f 6c75 6d6e 5f6e 616d 653d 2761 272c  column_name='a',
-0000c510: 2068 6967 685f 636f 6c75 6d6e 5f6e 616d   high_column_nam
-0000c520: 653d 2762 2729 0a20 2020 2020 2020 2069  e='b').        i
-0000c530: 6e73 7461 6e63 652e 5f64 6966 665f 636f  nstance._diff_co
-0000c540: 6c75 6d6e 5f6e 616d 6520 3d20 2761 2362  lumn_name = 'a#b
-0000c550: 270a 0a20 2020 2020 2020 2023 2052 756e  '..        # Run
-0000c560: 0a20 2020 2020 2020 2074 6162 6c65 5f64  .        table_d
-0000c570: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
-0000c580: 6d65 287b 0a20 2020 2020 2020 2020 2020  me({.           
-0000c590: 2027 6127 3a20 5b31 2c20 322c 2033 5d2c   'a': [1, 2, 3],
-0000c5a0: 0a20 2020 2020 2020 2020 2020 2027 6227  .            'b'
-0000c5b0: 3a20 5b34 2c20 352c 2036 5d2c 0a20 2020  : [4, 5, 6],.   
-0000c5c0: 2020 2020 2020 2020 2027 6327 3a20 5b37           'c': [7
-0000c5d0: 2c20 382c 2039 5d2c 0a20 2020 2020 2020  , 8, 9],.       
-0000c5e0: 207d 290a 2020 2020 2020 2020 6f75 7420   }).        out 
-0000c5f0: 3d20 696e 7374 616e 6365 2e5f 7472 616e  = instance._tran
-0000c600: 7366 6f72 6d28 7461 626c 655f 6461 7461  sform(table_data
-0000c610: 290a 0a20 2020 2020 2020 2023 2041 7373  )..        # Ass
-0000c620: 6572 740a 2020 2020 2020 2020 6578 7065  ert.        expe
-0000c630: 6374 6564 5f6f 7574 203d 2070 642e 4461  cted_out = pd.Da
-0000c640: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
-0000c650: 2020 2020 2020 2761 273a 205b 312c 2032        'a': [1, 2
-0000c660: 2c20 335d 2c0a 2020 2020 2020 2020 2020  , 3],.          
-0000c670: 2020 2763 273a 205b 372c 2038 2c20 395d    'c': [7, 8, 9]
-0000c680: 2c0a 2020 2020 2020 2020 2020 2020 2761  ,.            'a
-0000c690: 2362 273a 205b 6e70 2e6c 6f67 2834 295d  #b': [np.log(4)]
-0000c6a0: 202a 2033 2c0a 2020 2020 2020 2020 7d29   * 3,.        })
-0000c6b0: 0a20 2020 2020 2020 2070 642e 7465 7374  .        pd.test
-0000c6c0: 696e 672e 6173 7365 7274 5f66 7261 6d65  ing.assert_frame
-0000c6d0: 5f65 7175 616c 286f 7574 2c20 6578 7065  _equal(out, expe
-0000c6e0: 6374 6564 5f6f 7574 290a 0a20 2020 2064  cted_out)..    d
-0000c6f0: 6566 2074 6573 745f 5f74 7261 6e73 666f  ef test__transfo
-0000c700: 726d 5f64 6174 6574 696d 6528 7365 6c66  rm_datetime(self
-0000c710: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-0000c720: 7374 2074 6865 2060 6049 6e65 7175 616c  st the ``Inequal
-0000c730: 6974 792e 5f74 7261 6e73 666f 726d 6060  ity._transform``
-0000c740: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
-0000c750: 2020 5468 6520 6d65 7468 6f64 2069 7320    The method is 
-0000c760: 6578 7065 6374 6564 2074 6f20 636f 6d70  expected to comp
-0000c770: 7574 6520 7468 6520 6469 7374 616e 6365  ute the distance
-0000c780: 2062 6574 7765 656e 2074 6865 2068 6967   between the hig
-0000c790: 6820 616e 6420 6c6f 7720 636f 6c75 6d6e  h and low column
-0000c7a0: 730a 2020 2020 2020 2020 616e 6420 6372  s.        and cr
-0000c7b0: 6561 7465 2061 2064 6966 6620 636f 6c75  eate a diff colu
-0000c7c0: 6d6e 2077 6974 6820 7468 6520 6c6f 6761  mn with the loga
-0000c7d0: 7269 7468 6d20 6f66 2074 6865 2064 6973  rithm of the dis
-0000c7e0: 7461 6e63 6520 2b20 312e 0a0a 2020 2020  tance + 1...    
-0000c7f0: 2020 2020 5365 7475 703a 0a20 2020 2020      Setup:.     
-0000c800: 2020 202d 2060 605f 6469 6666 5f63 6f6c     - ``_diff_col
-0000c810: 756d 6e5f 6e61 6d65 6060 2069 7320 7365  umn_name`` is se
-0000c820: 7420 746f 2060 6027 6123 6227 6060 2e0a  t to ``'a#b'``..
-0000c830: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
-0000c840: 2020 2020 2020 202d 2054 6162 6c65 2077         - Table w
-0000c850: 6974 6820 7477 6f20 6461 7465 7469 6d65  ith two datetime
-0000c860: 2063 6f6c 756d 6e73 2061 7420 6120 6469   columns at a di
-0000c870: 7374 616e 6365 206f 6620 3320 616e 6420  stance of 3 and 
-0000c880: 6f6e 6520 6164 6469 7469 6f6e 616c 2064  one additional d
-0000c890: 756d 6d79 2063 6f6c 756d 6e2e 0a20 2020  ummy column..   
-0000c8a0: 2020 2020 204f 7574 7075 743a 0a20 2020       Output:.   
-0000c8b0: 2020 2020 202d 2053 616d 6520 7461 626c       - Same tabl
-0000c8c0: 6520 7769 7468 2061 2064 6966 6620 636f  e with a diff co
-0000c8d0: 6c75 6d6e 206f 6620 7468 6520 6c6f 6720  lumn of the log 
-0000c8e0: 6f66 2064 6973 7461 6e63 6573 202b 2031  of distances + 1
-0000c8f0: 2c20 7768 6963 6820 6973 206e 702e 6c6f  , which is np.lo
-0000c900: 6728 3429 2e0a 2020 2020 2020 2020 2222  g(4)..        ""
-0000c910: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
-0000c920: 700a 2020 2020 2020 2020 696e 7374 616e  p.        instan
-0000c930: 6365 203d 2049 6e65 7175 616c 6974 7928  ce = Inequality(
-0000c940: 6c6f 775f 636f 6c75 6d6e 5f6e 616d 653d  low_column_name=
-0000c950: 2761 272c 2068 6967 685f 636f 6c75 6d6e  'a', high_column
-0000c960: 5f6e 616d 653d 2762 2729 0a20 2020 2020  _name='b').     
-0000c970: 2020 2069 6e73 7461 6e63 652e 5f64 6966     instance._dif
-0000c980: 665f 636f 6c75 6d6e 5f6e 616d 6520 3d20  f_column_name = 
-0000c990: 2761 2362 270a 2020 2020 2020 2020 696e  'a#b'.        in
-0000c9a0: 7374 616e 6365 2e5f 6973 5f64 6174 6574  stance._is_datet
-0000c9b0: 696d 6520 3d20 5472 7565 0a0a 2020 2020  ime = True..    
-0000c9c0: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
-0000c9d0: 2020 7461 626c 655f 6461 7461 203d 2070    table_data = p
-0000c9e0: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-0000c9f0: 2020 2020 2020 2020 2020 2761 273a 2070            'a': p
-0000ca00: 642e 746f 5f64 6174 6574 696d 6528 5b27  d.to_datetime(['
-0000ca10: 3230 3230 2d30 312d 3031 5430 303a 3030  2020-01-01T00:00
-0000ca20: 3a30 3027 2c20 2732 3032 302d 3031 2d30  :00', '2020-01-0
-0000ca30: 3254 3030 3a30 303a 3030 275d 292c 0a20  2T00:00:00']),. 
-0000ca40: 2020 2020 2020 2020 2020 2027 6227 3a20             'b': 
-0000ca50: 7064 2e74 6f5f 6461 7465 7469 6d65 285b  pd.to_datetime([
-0000ca60: 2732 3032 302d 3031 2d30 3154 3030 3a30  '2020-01-01T00:0
-0000ca70: 303a 3031 272c 2027 3230 3230 2d30 312d  0:01', '2020-01-
-0000ca80: 3032 5430 303a 3030 3a30 3127 5d29 2c0a  02T00:00:01']),.
-0000ca90: 2020 2020 2020 2020 2020 2020 2763 273a              'c':
-0000caa0: 205b 312c 2032 5d2c 0a20 2020 2020 2020   [1, 2],.       
-0000cab0: 207d 290a 2020 2020 2020 2020 6f75 7420   }).        out 
-0000cac0: 3d20 696e 7374 616e 6365 2e5f 7472 616e  = instance._tran
-0000cad0: 7366 6f72 6d28 7461 626c 655f 6461 7461  sform(table_data
-0000cae0: 290a 0a20 2020 2020 2020 2023 2041 7373  )..        # Ass
-0000caf0: 6572 740a 2020 2020 2020 2020 6578 7065  ert.        expe
-0000cb00: 6374 6564 5f6f 7574 203d 2070 642e 4461  cted_out = pd.Da
-0000cb10: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
-0000cb20: 2020 2020 2020 2761 273a 2070 642e 746f        'a': pd.to
-0000cb30: 5f64 6174 6574 696d 6528 5b27 3230 3230  _datetime(['2020
-0000cb40: 2d30 312d 3031 5430 303a 3030 3a30 3027  -01-01T00:00:00'
-0000cb50: 2c20 2732 3032 302d 3031 2d30 3254 3030  , '2020-01-02T00
-0000cb60: 3a30 303a 3030 275d 292c 0a20 2020 2020  :00:00']),.     
-0000cb70: 2020 2020 2020 2027 6327 3a20 5b31 2c20         'c': [1, 
-0000cb80: 325d 2c0a 2020 2020 2020 2020 2020 2020  2],.            
-0000cb90: 2761 2362 273a 205b 6e70 2e6c 6f67 2831  'a#b': [np.log(1
-0000cba0: 5f30 3030 5f30 3030 5f30 3031 292c 206e  _000_000_001), n
-0000cbb0: 702e 6c6f 6728 315f 3030 305f 3030 305f  p.log(1_000_000_
-0000cbc0: 3030 3129 5d2c 0a20 2020 2020 2020 207d  001)],.        }
-0000cbd0: 290a 2020 2020 2020 2020 7064 2e74 6573  ).        pd.tes
-0000cbe0: 7469 6e67 2e61 7373 6572 745f 6672 616d  ting.assert_fram
-0000cbf0: 655f 6571 7561 6c28 6f75 742c 2065 7870  e_equal(out, exp
-0000cc00: 6563 7465 645f 6f75 7429 0a0a 2020 2020  ected_out)..    
-0000cc10: 6465 6620 7465 7374 5f5f 7472 616e 7366  def test__transf
-0000cc20: 6f72 6d5f 6461 7465 7469 6d65 5f64 7479  orm_datetime_dty
-0000cc30: 7065 5f6f 626a 6563 7428 7365 6c66 293a  pe_object(self):
-0000cc40: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-0000cc50: 2074 6865 2060 6049 6e65 7175 616c 6974   the ``Inequalit
-0000cc60: 792e 5f74 7261 6e73 666f 726d 6060 206d  y._transform`` m
-0000cc70: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
-0000cc80: 5468 6520 6d65 7468 6f64 2069 7320 6578  The method is ex
-0000cc90: 7065 6374 6564 2074 6f20 636f 6d70 7574  pected to comput
-0000cca0: 6520 7468 6520 6469 7374 616e 6365 2062  e the distance b
-0000ccb0: 6574 7765 656e 2074 6865 2068 6967 6820  etween the high 
-0000ccc0: 616e 6420 6c6f 7720 636f 6c75 6d6e 730a  and low columns.
-0000ccd0: 2020 2020 2020 2020 616e 6420 6372 6561          and crea
-0000cce0: 7465 2061 2064 6966 6620 636f 6c75 6d6e  te a diff column
-0000ccf0: 2077 6974 6820 7468 6520 6c6f 6761 7269   with the logari
-0000cd00: 7468 6d20 6f66 2074 6865 2064 6973 7461  thm of the dista
-0000cd10: 6e63 6520 2b20 3120 6576 656e 2077 6865  nce + 1 even whe
-0000cd20: 6e20 7468 6f73 650a 2020 2020 2020 2020  n those.        
-0000cd30: 6172 6520 6672 6f6d 2060 605f 6474 7970  are from ``_dtyp
-0000cd40: 6560 6020 6f62 6a65 6374 2062 7574 2061  e`` object but a
-0000cd50: 7265 2072 6570 7265 7365 6e74 696e 6720  re representing 
-0000cd60: 6120 6461 7465 7469 6d65 2e0a 2020 2020  a datetime..    
-0000cd70: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000cd80: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-0000cd90: 696e 7374 616e 6365 203d 2049 6e65 7175  instance = Inequ
-0000cda0: 616c 6974 7928 6c6f 775f 636f 6c75 6d6e  ality(low_column
-0000cdb0: 5f6e 616d 653d 2761 272c 2068 6967 685f  _name='a', high_
-0000cdc0: 636f 6c75 6d6e 5f6e 616d 653d 2762 2729  column_name='b')
-0000cdd0: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-0000cde0: 652e 5f64 6966 665f 636f 6c75 6d6e 5f6e  e._diff_column_n
-0000cdf0: 616d 6520 3d20 2761 2362 270a 2020 2020  ame = 'a#b'.    
-0000ce00: 2020 2020 696e 7374 616e 6365 2e5f 6973      instance._is
-0000ce10: 5f64 6174 6574 696d 6520 3d20 5472 7565  _datetime = True
-0000ce20: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-0000ce30: 652e 5f64 7479 7065 203d 2027 4f27 0a0a  e._dtype = 'O'..
-0000ce40: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
-0000ce50: 2020 2020 2020 7461 626c 655f 6461 7461        table_data
-0000ce60: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-0000ce70: 7b0a 2020 2020 2020 2020 2020 2020 2761  {.            'a
-0000ce80: 273a 205b 2732 3032 302d 3031 2d30 3154  ': ['2020-01-01T
-0000ce90: 3030 3a30 303a 3030 272c 2027 3230 3230  00:00:00', '2020
-0000cea0: 2d30 312d 3032 5430 303a 3030 3a30 3027  -01-02T00:00:00'
-0000ceb0: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
-0000cec0: 6227 3a20 5b27 3230 3230 2d30 312d 3031  b': ['2020-01-01
-0000ced0: 5430 303a 3030 3a30 3127 2c20 2732 3032  T00:00:01', '202
-0000cee0: 302d 3031 2d30 3254 3030 3a30 303a 3031  0-01-02T00:00:01
-0000cef0: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
-0000cf00: 2763 273a 205b 312c 2032 5d2c 0a20 2020  'c': [1, 2],.   
-0000cf10: 2020 2020 207d 290a 2020 2020 2020 2020       }).        
-0000cf20: 6f75 7420 3d20 696e 7374 616e 6365 2e5f  out = instance._
-0000cf30: 7472 616e 7366 6f72 6d28 7461 626c 655f  transform(table_
-0000cf40: 6461 7461 290a 0a20 2020 2020 2020 2023  data)..        #
-0000cf50: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-0000cf60: 6578 7065 6374 6564 5f6f 7574 203d 2070  expected_out = p
-0000cf70: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-0000cf80: 2020 2020 2020 2020 2020 2761 273a 205b            'a': [
-0000cf90: 2732 3032 302d 3031 2d30 3154 3030 3a30  '2020-01-01T00:0
-0000cfa0: 303a 3030 272c 2027 3230 3230 2d30 312d  0:00', '2020-01-
-0000cfb0: 3032 5430 303a 3030 3a30 3027 5d2c 0a20  02T00:00:00'],. 
-0000cfc0: 2020 2020 2020 2020 2020 2027 6327 3a20             'c': 
-0000cfd0: 5b31 2c20 325d 2c0a 2020 2020 2020 2020  [1, 2],.        
-0000cfe0: 2020 2020 2761 2362 273a 205b 6e70 2e6c      'a#b': [np.l
-0000cff0: 6f67 2831 5f30 3030 5f30 3030 5f30 3031  og(1_000_000_001
-0000d000: 292c 206e 702e 6c6f 6728 315f 3030 305f  ), np.log(1_000_
-0000d010: 3030 305f 3030 3129 5d2c 0a20 2020 2020  000_001)],.     
-0000d020: 2020 207d 290a 2020 2020 2020 2020 7064     }).        pd
-0000d030: 2e74 6573 7469 6e67 2e61 7373 6572 745f  .testing.assert_
-0000d040: 6672 616d 655f 6571 7561 6c28 6f75 742c  frame_equal(out,
-0000d050: 2065 7870 6563 7465 645f 6f75 7429 0a0a   expected_out)..
-0000d060: 2020 2020 6465 6620 7465 7374 5f72 6576      def test_rev
-0000d070: 6572 7365 5f74 7261 6e73 666f 726d 2873  erse_transform(s
-0000d080: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-0000d090: 2254 6573 7420 7468 6520 6060 496e 6571  "Test the ``Ineq
-0000d0a0: 7561 6c69 7479 2e72 6576 6572 7365 5f74  uality.reverse_t
-0000d0b0: 7261 6e73 666f 726d 6060 206d 6574 686f  ransform`` metho
-0000d0c0: 642e 0a0a 2020 2020 2020 2020 5468 6520  d...        The 
-0000d0d0: 6d65 7468 6f64 2069 7320 6578 7065 6374  method is expect
-0000d0e0: 6564 2074 6f3a 0a20 2020 2020 2020 2020  ed to:.         
-0000d0f0: 2020 202d 2061 7070 6c79 2061 6e20 6578     - apply an ex
-0000d100: 706f 6e65 6e74 6961 6c20 746f 2074 6865  ponential to the
-0000d110: 2069 6e70 7574 0a20 2020 2020 2020 2020   input.         
-0000d120: 2020 202d 2073 7562 7472 6163 7420 310a     - subtract 1.
-0000d130: 2020 2020 2020 2020 2020 2020 2d20 6164              - ad
-0000d140: 6420 7468 6520 6c6f 7720 636f 6c75 6d6e  d the low column
-0000d150: 0a20 2020 2020 2020 2020 2020 202d 2063  .            - c
-0000d160: 6f6e 7665 7274 2074 6865 206f 7574 7075  onvert the outpu
-0000d170: 7420 746f 2069 6e74 6567 6572 730a 2020  t to integers.  
-0000d180: 2020 2020 2020 2020 2020 2d20 6164 6420            - add 
-0000d190: 6261 636b 2074 6865 2064 726f 7070 6564  back the dropped
-0000d1a0: 2063 6f6c 756d 6e0a 0a20 2020 2020 2020   column..       
-0000d1b0: 2053 6574 7570 3a0a 2020 2020 2020 2020   Setup:.        
-0000d1c0: 2d20 6060 5f64 6966 665f 636f 6c75 6d6e  - ``_diff_column
-0000d1d0: 5f6e 616d 6520 3d20 2761 2362 2760 600a  _name = 'a#b'``.
-0000d1e0: 2020 2020 2020 2020 2d20 6060 5f64 7479          - ``_dty
-0000d1f0: 7065 6060 2061 7320 696e 7465 6765 720a  pe`` as integer.
-0000d200: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
-0000d210: 2020 2020 2020 202d 2054 6162 6c65 2077         - Table w
-0000d220: 6974 6820 6120 6469 6666 2063 6f6c 756d  ith a diff colum
-0000d230: 6e20 7468 6174 2063 6f6e 7461 696e 7320  n that contains 
-0000d240: 7468 6520 636f 6e73 7461 6e74 206e 702e  the constant np.
-0000d250: 6c6f 6728 3429 2e0a 2020 2020 2020 2020  log(4)..        
-0000d260: 4f75 7470 7574 3a0a 2020 2020 2020 2020  Output:.        
-0000d270: 2d20 5361 6d65 2074 6162 6c65 2077 6974  - Same table wit
-0000d280: 6820 7468 6520 6869 6768 2063 6f6c 756d  h the high colum
-0000d290: 6e20 7265 706c 6163 6564 2062 7920 7468  n replaced by th
-0000d2a0: 6520 6c6f 7720 6f6e 6520 2b20 3320 7769  e low one + 3 wi
-0000d2b0: 7468 2064 6966 6620 636f 6c75 6d6e 2064  th diff column d
-0000d2c0: 726f 7070 6564 2e0a 2020 2020 2020 2020  ropped..        
-0000d2d0: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
-0000d2e0: 7475 700a 2020 2020 2020 2020 696e 7374  tup.        inst
-0000d2f0: 616e 6365 203d 2049 6e65 7175 616c 6974  ance = Inequalit
-0000d300: 7928 6c6f 775f 636f 6c75 6d6e 5f6e 616d  y(low_column_nam
-0000d310: 653d 2761 272c 2068 6967 685f 636f 6c75  e='a', high_colu
-0000d320: 6d6e 5f6e 616d 653d 2762 2729 0a20 2020  mn_name='b').   
-0000d330: 2020 2020 2069 6e73 7461 6e63 652e 5f64       instance._d
-0000d340: 7479 7065 203d 2070 642e 5365 7269 6573  type = pd.Series
-0000d350: 285b 315d 292e 6474 7970 6520 2023 2065  ([1]).dtype  # e
-0000d360: 7861 6374 2064 7479 7065 2028 3332 206f  xact dtype (32 o
-0000d370: 7220 3634 2920 6465 7065 6e64 7320 6f6e  r 64) depends on
-0000d380: 204f 530a 2020 2020 2020 2020 696e 7374   OS.        inst
-0000d390: 616e 6365 2e5f 6469 6666 5f63 6f6c 756d  ance._diff_colum
-0000d3a0: 6e5f 6e61 6d65 203d 2027 6123 6227 0a0a  n_name = 'a#b'..
-0000d3b0: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
-0000d3c0: 2020 2020 2020 7472 616e 7366 6f72 6d65        transforme
-0000d3d0: 6420 3d20 7064 2e44 6174 6146 7261 6d65  d = pd.DataFrame
-0000d3e0: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
-0000d3f0: 6127 3a20 5b31 2c20 322c 2033 5d2c 0a20  a': [1, 2, 3],. 
-0000d400: 2020 2020 2020 2020 2020 2027 6327 3a20             'c': 
-0000d410: 5b37 2c20 382c 2039 5d2c 0a20 2020 2020  [7, 8, 9],.     
-0000d420: 2020 2020 2020 2027 6123 6227 3a20 5b6e         'a#b': [n
-0000d430: 702e 6c6f 6728 3429 5d20 2a20 332c 0a20  p.log(4)] * 3,. 
-0000d440: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
-0000d450: 2020 6f75 7420 3d20 696e 7374 616e 6365    out = instance
-0000d460: 2e72 6576 6572 7365 5f74 7261 6e73 666f  .reverse_transfo
-0000d470: 726d 2874 7261 6e73 666f 726d 6564 290a  rm(transformed).
-0000d480: 0a20 2020 2020 2020 2023 2041 7373 6572  .        # Asser
-0000d490: 740a 2020 2020 2020 2020 6578 7065 6374  t.        expect
-0000d4a0: 6564 5f6f 7574 203d 2070 642e 4461 7461  ed_out = pd.Data
-0000d4b0: 4672 616d 6528 7b0a 2020 2020 2020 2020  Frame({.        
-0000d4c0: 2020 2020 2761 273a 205b 312c 2032 2c20      'a': [1, 2, 
-0000d4d0: 335d 2c0a 2020 2020 2020 2020 2020 2020  3],.            
-0000d4e0: 2763 273a 205b 372c 2038 2c20 395d 2c0a  'c': [7, 8, 9],.
-0000d4f0: 2020 2020 2020 2020 2020 2020 2762 273a              'b':
-0000d500: 205b 342c 2035 2c20 365d 2c0a 2020 2020   [4, 5, 6],.    
-0000d510: 2020 2020 7d29 0a20 2020 2020 2020 2070      }).        p
-0000d520: 642e 7465 7374 696e 672e 6173 7365 7274  d.testing.assert
-0000d530: 5f66 7261 6d65 5f65 7175 616c 286f 7574  _frame_equal(out
-0000d540: 2c20 6578 7065 6374 6564 5f6f 7574 290a  , expected_out).
-0000d550: 0a20 2020 2064 6566 2074 6573 745f 7265  .    def test_re
-0000d560: 7665 7273 655f 7472 616e 7366 6f72 6d5f  verse_transform_
-0000d570: 666c 6f61 7473 2873 656c 6629 3a0a 2020  floats(self):.  
-0000d580: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-0000d590: 6520 6060 496e 6571 7561 6c69 7479 2e72  e ``Inequality.r
-0000d5a0: 6576 6572 7365 5f74 7261 6e73 666f 726d  everse_transform
-0000d5b0: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
-0000d5c0: 2020 2020 5468 6520 6d65 7468 6f64 2069      The method i
-0000d5d0: 7320 6578 7065 6374 6564 2074 6f3a 0a20  s expected to:. 
-0000d5e0: 2020 2020 2020 2020 2020 202d 2061 7070             - app
-0000d5f0: 6c79 2061 6e20 6578 706f 6e65 6e74 6961  ly an exponentia
-0000d600: 6c20 746f 2074 6865 2069 6e70 7574 0a20  l to the input. 
-0000d610: 2020 2020 2020 2020 2020 202d 2073 7562             - sub
-0000d620: 7472 6163 7420 310a 2020 2020 2020 2020  tract 1.        
-0000d630: 2020 2020 2d20 6164 6420 7468 6520 6c6f      - add the lo
-0000d640: 7720 636f 6c75 6d6e 0a20 2020 2020 2020  w column.       
-0000d650: 2020 2020 202d 2063 6f6e 7665 7274 2074       - convert t
-0000d660: 6865 206f 7574 7075 7420 746f 2066 6c6f  he output to flo
-0000d670: 6174 730a 2020 2020 2020 2020 2020 2020  ats.            
-0000d680: 2d20 6164 6420 6261 636b 2074 6865 2064  - add back the d
-0000d690: 726f 7070 6564 2063 6f6c 756d 6e0a 0a20  ropped column.. 
-0000d6a0: 2020 2020 2020 2053 6574 7570 3a0a 2020         Setup:.  
-0000d6b0: 2020 2020 2020 2d20 6060 5f64 6966 665f        - ``_diff_
-0000d6c0: 636f 6c75 6d6e 5f6e 616d 6520 3d20 2761  column_name = 'a
-0000d6d0: 2362 2760 600a 2020 2020 2020 2020 2d20  #b'``.        - 
-0000d6e0: 6060 5f64 7479 7065 6060 2061 7320 666c  ``_dtype`` as fl
-0000d6f0: 6f61 740a 2020 2020 2020 2020 496e 7075  oat.        Inpu
-0000d700: 743a 0a20 2020 2020 2020 202d 2054 6162  t:.        - Tab
-0000d710: 6c65 2077 6974 6820 6120 6469 6666 2063  le with a diff c
-0000d720: 6f6c 756d 6e20 7468 6174 2063 6f6e 7461  olumn that conta
-0000d730: 696e 7320 7468 6520 636f 6e73 7461 6e74  ins the constant
-0000d740: 206e 702e 6c6f 6728 3429 2e0a 2020 2020   np.log(4)..    
-0000d750: 2020 2020 4f75 7470 7574 3a0a 2020 2020      Output:.    
-0000d760: 2020 2020 2d20 5361 6d65 2074 6162 6c65      - Same table
-0000d770: 2077 6974 6820 7468 6520 6869 6768 2063   with the high c
-0000d780: 6f6c 756d 6e20 7265 706c 6163 6564 2062  olumn replaced b
-0000d790: 7920 7468 6520 6c6f 7720 6f6e 6520 2b20  y the low one + 
-0000d7a0: 3320 7769 7468 2064 6966 6620 636f 6c75  3 with diff colu
-0000d7b0: 6d6e 2064 726f 7070 6564 2e0a 2020 2020  mn dropped..    
-0000d7c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000d7d0: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-0000d7e0: 696e 7374 616e 6365 203d 2049 6e65 7175  instance = Inequ
-0000d7f0: 616c 6974 7928 6c6f 775f 636f 6c75 6d6e  ality(low_column
-0000d800: 5f6e 616d 653d 2761 272c 2068 6967 685f  _name='a', high_
-0000d810: 636f 6c75 6d6e 5f6e 616d 653d 2762 2729  column_name='b')
-0000d820: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-0000d830: 652e 5f64 7479 7065 203d 206e 702e 6474  e._dtype = np.dt
-0000d840: 7970 6528 2766 6c6f 6174 2729 0a20 2020  ype('float').   
-0000d850: 2020 2020 2069 6e73 7461 6e63 652e 5f64       instance._d
-0000d860: 6966 665f 636f 6c75 6d6e 5f6e 616d 6520  iff_column_name 
-0000d870: 3d20 2761 2362 270a 0a20 2020 2020 2020  = 'a#b'..       
-0000d880: 2023 2052 756e 0a20 2020 2020 2020 2074   # Run.        t
-0000d890: 7261 6e73 666f 726d 6564 203d 2070 642e  ransformed = pd.
-0000d8a0: 4461 7461 4672 616d 6528 7b0a 2020 2020  DataFrame({.    
-0000d8b0: 2020 2020 2020 2020 2761 273a 205b 312e          'a': [1.
-0000d8c0: 312c 2032 2e32 2c20 332e 335d 2c0a 2020  1, 2.2, 3.3],.  
-0000d8d0: 2020 2020 2020 2020 2020 2763 273a 205b            'c': [
-0000d8e0: 372c 2038 2c20 395d 2c0a 2020 2020 2020  7, 8, 9],.      
-0000d8f0: 2020 2020 2020 2761 2362 273a 205b 6e70        'a#b': [np
-0000d900: 2e6c 6f67 2834 295d 202a 2033 2c0a 2020  .log(4)] * 3,.  
-0000d910: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
-0000d920: 206f 7574 203d 2069 6e73 7461 6e63 652e   out = instance.
-0000d930: 7265 7665 7273 655f 7472 616e 7366 6f72  reverse_transfor
-0000d940: 6d28 7472 616e 7366 6f72 6d65 6429 0a0a  m(transformed)..
-0000d950: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
-0000d960: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
-0000d970: 645f 6f75 7420 3d20 7064 2e44 6174 6146  d_out = pd.DataF
-0000d980: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
-0000d990: 2020 2027 6127 3a20 5b31 2e31 2c20 322e     'a': [1.1, 2.
-0000d9a0: 322c 2033 2e33 5d2c 0a20 2020 2020 2020  2, 3.3],.       
-0000d9b0: 2020 2020 2027 6327 3a20 5b37 2c20 382c       'c': [7, 8,
-0000d9c0: 2039 5d2c 0a20 2020 2020 2020 2020 2020   9],.           
-0000d9d0: 2027 6227 3a20 5b34 2e31 2c20 352e 322c   'b': [4.1, 5.2,
-0000d9e0: 2036 2e33 5d2c 0a20 2020 2020 2020 207d   6.3],.        }
-0000d9f0: 290a 2020 2020 2020 2020 7064 2e74 6573  ).        pd.tes
-0000da00: 7469 6e67 2e61 7373 6572 745f 6672 616d  ting.assert_fram
-0000da10: 655f 6571 7561 6c28 6f75 742c 2065 7870  e_equal(out, exp
-0000da20: 6563 7465 645f 6f75 7429 0a0a 2020 2020  ected_out)..    
-0000da30: 6465 6620 7465 7374 5f72 6576 6572 7365  def test_reverse
-0000da40: 5f74 7261 6e73 666f 726d 5f64 6174 6574  _transform_datet
-0000da50: 696d 6528 7365 6c66 293a 0a20 2020 2020  ime(self):.     
-0000da60: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-0000da70: 6049 6e65 7175 616c 6974 792e 7265 7665  `Inequality.reve
-0000da80: 7273 655f 7472 616e 7366 6f72 6d60 6020  rse_transform`` 
-0000da90: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
-0000daa0: 2054 6865 206d 6574 686f 6420 6973 2065   The method is e
-0000dab0: 7870 6563 7465 6420 746f 3a0a 2020 2020  xpected to:.    
-0000dac0: 2020 2020 2020 2020 2d20 6170 706c 7920          - apply 
-0000dad0: 616e 2065 7870 6f6e 656e 7469 616c 2074  an exponential t
-0000dae0: 6f20 7468 6520 696e 7075 740a 2020 2020  o the input.    
-0000daf0: 2020 2020 2020 2020 2d20 7375 6274 7261          - subtra
-0000db00: 6374 2031 0a20 2020 2020 2020 2020 2020  ct 1.           
-0000db10: 202d 2061 6464 2074 6865 206c 6f77 2063   - add the low c
-0000db20: 6f6c 756d 6e0a 2020 2020 2020 2020 2020  olumn.          
-0000db30: 2020 2d20 636f 6e76 6572 7420 7468 6520    - convert the 
-0000db40: 6f75 7470 7574 2074 6f20 6461 7465 7469  output to dateti
-0000db50: 6d65 0a20 2020 2020 2020 2020 2020 202d  me.            -
-0000db60: 2061 6464 2062 6163 6b20 7468 6520 6472   add back the dr
-0000db70: 6f70 7065 6420 636f 6c75 6d6e 0a0a 2020  opped column..  
-0000db80: 2020 2020 2020 5365 7475 703a 0a20 2020        Setup:.   
-0000db90: 2020 2020 202d 2060 605f 6469 6666 5f63       - ``_diff_c
-0000dba0: 6f6c 756d 6e5f 6e61 6d65 203d 2027 6123  olumn_name = 'a#
-0000dbb0: 6227 6060 0a20 2020 2020 2020 202d 2060  b'``.        - `
-0000dbc0: 605f 6474 7970 6560 6020 6173 2064 6174  `_dtype`` as dat
-0000dbd0: 6574 696d 650a 2020 2020 2020 2020 496e  etime.        In
-0000dbe0: 7075 743a 0a20 2020 2020 2020 202d 2054  put:.        - T
-0000dbf0: 6162 6c65 2077 6974 6820 6120 6469 6666  able with a diff
-0000dc00: 2063 6f6c 756d 6e20 7468 6174 2063 6f6e   column that con
-0000dc10: 7461 696e 7320 7468 6520 636f 6e73 7461  tains the consta
-0000dc20: 6e74 206e 702e 6c6f 6728 3429 2e0a 2020  nt np.log(4)..  
-0000dc30: 2020 2020 2020 4f75 7470 7574 3a0a 2020        Output:.  
-0000dc40: 2020 2020 2020 2d20 5361 6d65 2074 6162        - Same tab
-0000dc50: 6c65 2077 6974 6820 7468 6520 6869 6768  le with the high
-0000dc60: 2063 6f6c 756d 6e20 7265 706c 6163 6564   column replaced
-0000dc70: 2062 7920 7468 6520 6c6f 7720 6f6e 6520   by the low one 
-0000dc80: 2b20 3173 6563 2077 6974 6820 6469 6666  + 1sec with diff
-0000dc90: 2063 6f6c 756d 6e20 6472 6f70 7065 642e   column dropped.
-0000dca0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000dcb0: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
-0000dcc0: 2020 2020 2069 6e73 7461 6e63 6520 3d20       instance = 
-0000dcd0: 496e 6571 7561 6c69 7479 286c 6f77 5f63  Inequality(low_c
-0000dce0: 6f6c 756d 6e5f 6e61 6d65 3d27 6127 2c20  olumn_name='a', 
-0000dcf0: 6869 6768 5f63 6f6c 756d 6e5f 6e61 6d65  high_column_name
-0000dd00: 3d27 6227 290a 2020 2020 2020 2020 696e  ='b').        in
-0000dd10: 7374 616e 6365 2e5f 6474 7970 6520 3d20  stance._dtype = 
-0000dd20: 6e70 2e64 7479 7065 2827 3c4d 385b 6e73  np.dtype('<M8[ns
-0000dd30: 5d27 290a 2020 2020 2020 2020 696e 7374  ]').        inst
-0000dd40: 616e 6365 2e5f 6469 6666 5f63 6f6c 756d  ance._diff_colum
-0000dd50: 6e5f 6e61 6d65 203d 2027 6123 6227 0a20  n_name = 'a#b'. 
-0000dd60: 2020 2020 2020 2069 6e73 7461 6e63 652e         instance.
-0000dd70: 5f69 735f 6461 7465 7469 6d65 203d 2054  _is_datetime = T
-0000dd80: 7275 650a 0a20 2020 2020 2020 2023 2052  rue..        # R
-0000dd90: 756e 0a20 2020 2020 2020 2074 7261 6e73  un.        trans
-0000dda0: 666f 726d 6564 203d 2070 642e 4461 7461  formed = pd.Data
-0000ddb0: 4672 616d 6528 7b0a 2020 2020 2020 2020  Frame({.        
-0000ddc0: 2020 2020 2761 273a 2070 642e 746f 5f64      'a': pd.to_d
-0000ddd0: 6174 6574 696d 6528 5b27 3230 3230 2d30  atetime(['2020-0
-0000dde0: 312d 3031 5430 303a 3030 3a30 3027 2c20  1-01T00:00:00', 
-0000ddf0: 2732 3032 302d 3031 2d30 3254 3030 3a30  '2020-01-02T00:0
-0000de00: 303a 3030 275d 292c 0a20 2020 2020 2020  0:00']),.       
-0000de10: 2020 2020 2027 6327 3a20 5b31 2c20 325d       'c': [1, 2]
-0000de20: 2c0a 2020 2020 2020 2020 2020 2020 2761  ,.            'a
-0000de30: 2362 273a 205b 6e70 2e6c 6f67 2831 5f30  #b': [np.log(1_0
-0000de40: 3030 5f30 3030 5f30 3031 292c 206e 702e  00_000_001), np.
-0000de50: 6c6f 6728 315f 3030 305f 3030 305f 3030  log(1_000_000_00
-0000de60: 3129 5d2c 0a20 2020 2020 2020 207d 290a  1)],.        }).
-0000de70: 2020 2020 2020 2020 6f75 7420 3d20 696e          out = in
-0000de80: 7374 616e 6365 2e72 6576 6572 7365 5f74  stance.reverse_t
-0000de90: 7261 6e73 666f 726d 2874 7261 6e73 666f  ransform(transfo
-0000dea0: 726d 6564 290a 0a20 2020 2020 2020 2023  rmed)..        #
-0000deb0: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-0000dec0: 6578 7065 6374 6564 5f6f 7574 203d 2070  expected_out = p
-0000ded0: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-0000dee0: 2020 2020 2020 2020 2020 2761 273a 2070            'a': p
-0000def0: 642e 746f 5f64 6174 6574 696d 6528 5b27  d.to_datetime(['
-0000df00: 3230 3230 2d30 312d 3031 5430 303a 3030  2020-01-01T00:00
-0000df10: 3a30 3027 2c20 2732 3032 302d 3031 2d30  :00', '2020-01-0
-0000df20: 3254 3030 3a30 303a 3030 275d 292c 0a20  2T00:00:00']),. 
-0000df30: 2020 2020 2020 2020 2020 2027 6327 3a20             'c': 
-0000df40: 5b31 2c20 325d 2c0a 2020 2020 2020 2020  [1, 2],.        
-0000df50: 2020 2020 2762 273a 2070 642e 746f 5f64      'b': pd.to_d
-0000df60: 6174 6574 696d 6528 5b27 3230 3230 2d30  atetime(['2020-0
-0000df70: 312d 3031 5430 303a 3030 3a30 3127 2c20  1-01T00:00:01', 
-0000df80: 2732 3032 302d 3031 2d30 3254 3030 3a30  '2020-01-02T00:0
-0000df90: 303a 3031 275d 290a 2020 2020 2020 2020  0:01']).        
-0000dfa0: 7d29 0a20 2020 2020 2020 2070 642e 7465  }).        pd.te
-0000dfb0: 7374 696e 672e 6173 7365 7274 5f66 7261  sting.assert_fra
-0000dfc0: 6d65 5f65 7175 616c 286f 7574 2c20 6578  me_equal(out, ex
-0000dfd0: 7065 6374 6564 5f6f 7574 290a 0a20 2020  pected_out)..   
-0000dfe0: 2064 6566 2074 6573 745f 7265 7665 7273   def test_revers
-0000dff0: 655f 7472 616e 7366 6f72 6d5f 6461 7465  e_transform_date
-0000e000: 7469 6d65 5f64 7479 7065 5f69 735f 6f62  time_dtype_is_ob
-0000e010: 6a65 6374 2873 656c 6629 3a0a 2020 2020  ject(self):.    
-0000e020: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
-0000e030: 6060 496e 6571 7561 6c69 7479 2e72 6576  ``Inequality.rev
-0000e040: 6572 7365 5f74 7261 6e73 666f 726d 6060  erse_transform``
-0000e050: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
-0000e060: 2020 5468 6973 2073 686f 756c 6420 6361    This should ca
-0000e070: 7374 2074 6865 2060 606c 6f77 6060 2063  st the ``low`` c
-0000e080: 6f6c 756d 6e20 746f 2060 6064 6174 6574  olumn to ``datet
-0000e090: 696d 6560 6020 7768 656e 2074 6865 2060  ime`` when the `
-0000e0a0: 6064 7479 7065 6060 2069 730a 2020 2020  `dtype`` is.    
-0000e0b0: 2020 2020 6f62 6a65 6374 2e0a 2020 2020      object..    
-0000e0c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000e0d0: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-0000e0e0: 696e 7374 616e 6365 203d 2049 6e65 7175  instance = Inequ
-0000e0f0: 616c 6974 7928 6c6f 775f 636f 6c75 6d6e  ality(low_column
-0000e100: 5f6e 616d 653d 2761 272c 2068 6967 685f  _name='a', high_
-0000e110: 636f 6c75 6d6e 5f6e 616d 653d 2762 2729  column_name='b')
-0000e120: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-0000e130: 652e 5f64 7479 7065 203d 206e 702e 6474  e._dtype = np.dt
-0000e140: 7970 6528 274f 2729 0a20 2020 2020 2020  ype('O').       
-0000e150: 2069 6e73 7461 6e63 652e 5f64 6966 665f   instance._diff_
-0000e160: 636f 6c75 6d6e 5f6e 616d 6520 3d20 2761  column_name = 'a
-0000e170: 2362 270a 2020 2020 2020 2020 696e 7374  #b'.        inst
-0000e180: 616e 6365 2e5f 6973 5f64 6174 6574 696d  ance._is_datetim
-0000e190: 6520 3d20 5472 7565 0a0a 2020 2020 2020  e = True..      
-0000e1a0: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
-0000e1b0: 7472 616e 7366 6f72 6d65 6420 3d20 7064  transformed = pd
-0000e1c0: 2e44 6174 6146 7261 6d65 287b 0a20 2020  .DataFrame({.   
-0000e1d0: 2020 2020 2020 2020 2027 6127 3a20 5b27           'a': ['
-0000e1e0: 3230 3230 2d30 312d 3031 5430 303a 3030  2020-01-01T00:00
-0000e1f0: 3a30 3027 2c20 2732 3032 302d 3031 2d30  :00', '2020-01-0
-0000e200: 3254 3030 3a30 303a 3030 275d 2c0a 2020  2T00:00:00'],.  
-0000e210: 2020 2020 2020 2020 2020 2763 273a 205b            'c': [
-0000e220: 312c 2032 5d2c 0a20 2020 2020 2020 2020  1, 2],.         
-0000e230: 2020 2027 6123 6227 3a20 5b6e 702e 6c6f     'a#b': [np.lo
-0000e240: 6728 315f 3030 305f 3030 305f 3030 3129  g(1_000_000_001)
-0000e250: 2c20 6e70 2e6c 6f67 2831 5f30 3030 5f30  , np.log(1_000_0
-0000e260: 3030 5f30 3031 295d 2c0a 2020 2020 2020  00_001)],.      
-0000e270: 2020 7d29 0a20 2020 2020 2020 206f 7574    }).        out
-0000e280: 203d 2069 6e73 7461 6e63 652e 7265 7665   = instance.reve
-0000e290: 7273 655f 7472 616e 7366 6f72 6d28 7472  rse_transform(tr
-0000e2a0: 616e 7366 6f72 6d65 6429 0a0a 2020 2020  ansformed)..    
-0000e2b0: 2020 2020 2320 4173 7365 7274 0a20 2020      # Assert.   
-0000e2c0: 2020 2020 2065 7870 6563 7465 645f 6f75       expected_ou
-0000e2d0: 7420 3d20 7064 2e44 6174 6146 7261 6d65  t = pd.DataFrame
-0000e2e0: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
-0000e2f0: 6127 3a20 5b27 3230 3230 2d30 312d 3031  a': ['2020-01-01
-0000e300: 5430 303a 3030 3a30 3027 2c20 2732 3032  T00:00:00', '202
-0000e310: 302d 3031 2d30 3254 3030 3a30 303a 3030  0-01-02T00:00:00
-0000e320: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
-0000e330: 2763 273a 205b 312c 2032 5d2c 0a20 2020  'c': [1, 2],.   
-0000e340: 2020 2020 2020 2020 2027 6227 3a20 5b70           'b': [p
-0000e350: 642e 5469 6d65 7374 616d 7028 2732 3032  d.Timestamp('202
-0000e360: 302d 3031 2d30 3120 3030 3a30 303a 3031  0-01-01 00:00:01
-0000e370: 2729 2c20 7064 2e54 696d 6573 7461 6d70  '), pd.Timestamp
-0000e380: 2827 3230 3230 2d30 312d 3032 2030 303a  ('2020-01-02 00:
-0000e390: 3030 3a30 3127 295d 0a20 2020 2020 2020  00:01')].       
-0000e3a0: 207d 290a 2020 2020 2020 2020 6578 7065   }).        expe
-0000e3b0: 6374 6564 5f6f 7574 5b27 6227 5d20 3d20  cted_out['b'] = 
-0000e3c0: 6578 7065 6374 6564 5f6f 7574 5b27 6227  expected_out['b'
-0000e3d0: 5d2e 6173 7479 7065 286e 702e 6474 7970  ].astype(np.dtyp
-0000e3e0: 6528 274f 2729 290a 2020 2020 2020 2020  e('O')).        
-0000e3f0: 7064 2e74 6573 7469 6e67 2e61 7373 6572  pd.testing.asser
-0000e400: 745f 6672 616d 655f 6571 7561 6c28 6f75  t_frame_equal(ou
-0000e410: 742c 2065 7870 6563 7465 645f 6f75 7429  t, expected_out)
-0000e420: 0a0a 0a63 6c61 7373 2054 6573 7453 6361  ...class TestSca
-0000e430: 6c61 7249 6e65 7175 616c 6974 7928 293a  larInequality():
-0000e440: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
-0000e450: 7661 6c69 6461 7465 5f69 6e70 7574 7328  validate_inputs(
-0000e460: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-0000e470: 2222 5465 7374 2074 6865 2060 6053 6361  ""Test the ``Sca
-0000e480: 6c61 7249 6e65 7175 616c 6974 792e 5f76  larInequality._v
-0000e490: 616c 6964 6174 655f 696e 7075 7473 6060  alidate_inputs``
-0000e4a0: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
-0000e4b0: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
-0000e4c0: 202d 2020 496e 636f 7272 6563 7420 7061   -  Incorrect pa
-0000e4d0: 7261 6d65 7465 7273 2066 6f72 2074 6865  rameters for the
-0000e4e0: 206d 6574 686f 640a 2020 2020 2020 2020   method.        
-0000e4f0: 5261 6973 6573 3a0a 2020 2020 2020 2020  Raises:.        
-0000e500: 2d20 4c69 7374 206f 6620 5661 6c75 6545  - List of ValueE
-0000e510: 7272 6f72 730a 2020 2020 2020 2020 2222  rrors.        ""
-0000e520: 220a 2020 2020 2020 2020 2320 5275 6e20  ".        # Run 
-0000e530: 2f20 4173 7365 7274 0a20 2020 2020 2020  / Assert.       
-0000e540: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
-0000e550: 7365 7328 4167 6772 6567 6174 6543 6f6e  ses(AggregateCon
-0000e560: 7374 7261 696e 7473 4572 726f 7229 2061  straintsError) a
-0000e570: 7320 6572 726f 723a 0a20 2020 2020 2020  s error:.       
-0000e580: 2020 2020 2053 6361 6c61 7249 6e65 7175       ScalarInequ
-0000e590: 616c 6974 792e 5f76 616c 6964 6174 655f  ality._validate_
-0000e5a0: 696e 7075 7473 280a 2020 2020 2020 2020  inputs(.        
-0000e5b0: 2020 2020 2020 2020 6e6f 745f 6869 6768          not_high
-0000e5c0: 5f63 6f6c 756d 6e3d 4e6f 6e65 2c20 6e6f  _column=None, no
-0000e5d0: 745f 6c6f 775f 636f 6c75 6d6e 3d4e 6f6e  t_low_column=Non
-0000e5e0: 652c 2072 656c 6174 696f 6e3d 272b 2729  e, relation='+')
-0000e5f0: 0a0a 2020 2020 2020 2020 6572 725f 6d73  ..        err_ms
-0000e600: 6720 3d20 280a 2020 2020 2020 2020 2020  g = (.          
-0000e610: 2020 7227 4d69 7373 696e 6720 7265 7175    r'Missing requ
-0000e620: 6972 6564 2076 616c 7565 7320 7b28 2e2a  ired values {(.*
-0000e630: 297d 2069 6e20 6120 5363 616c 6172 496e  )} in a ScalarIn
-0000e640: 6571 7561 6c69 7479 2063 6f6e 7374 7261  equality constra
-0000e650: 696e 742e 270a 2020 2020 2020 2020 2020  int.'.          
-0000e660: 2020 7227 5c6e 5c6e 496e 7661 6c69 6420    r'\n\nInvalid 
-0000e670: 7661 6c75 6573 207b 282e 2a29 7d20 6172  values {(.*)} ar
-0000e680: 6520 7072 6573 656e 7420 696e 2061 2053  e present in a S
-0000e690: 6361 6c61 7249 6e65 7175 616c 6974 7920  calarInequality 
-0000e6a0: 636f 6e73 7472 6169 6e74 2e27 0a20 2020  constraint.'.   
-0000e6b0: 2020 2020 2020 2020 2072 275c 6e5c 6e49           r'\n\nI
-0000e6c0: 6e76 616c 6964 2072 656c 6174 696f 6e20  nvalid relation 
-0000e6d0: 7661 6c75 6520 7b28 2e2a 297d 2069 6e20  value {(.*)} in 
-0000e6e0: 6120 5363 616c 6172 496e 6571 7561 6c69  a ScalarInequali
-0000e6f0: 7479 2063 6f6e 7374 7261 696e 742e 270a  ty constraint.'.
-0000e700: 2020 2020 2020 2020 2020 2020 2220 5468              " Th
-0000e710: 6520 7265 6c61 7469 6f6e 206d 7573 7420  e relation must 
-0000e720: 6265 206f 6e65 206f 663a 2027 3e27 2c20  be one of: '>', 
-0000e730: 273e 3d27 2c20 273c 2720 6f72 2027 3c3d  '>=', '<' or '<=
-0000e740: 272e 220a 2020 2020 2020 2020 290a 2020  '.".        ).  
-0000e750: 2020 2020 2020 6772 6f75 7073 203d 2072        groups = r
-0000e760: 652e 7365 6172 6368 2865 7272 5f6d 7367  e.search(err_msg
-0000e770: 2c20 7374 7228 6572 726f 722e 7661 6c75  , str(error.valu
-0000e780: 6529 290a 2020 2020 2020 2020 6173 7365  e)).        asse
-0000e790: 7274 2067 726f 7570 7320 6973 206e 6f74  rt groups is not
-0000e7a0: 204e 6f6e 650a 2020 2020 2020 2020 6173   None.        as
-0000e7b0: 7365 7274 2073 6574 2865 7661 6c28 6772  sert set(eval(gr
-0000e7c0: 6f75 7073 2e67 726f 7570 2831 2929 2920  oups.group(1))) 
-0000e7d0: 3d3d 207b 2763 6f6c 756d 6e5f 6e61 6d65  == {'column_name
-0000e7e0: 272c 2027 7661 6c75 6527 7d0a 2020 2020  ', 'value'}.    
-0000e7f0: 2020 2020 6173 7365 7274 2073 6574 2865      assert set(e
-0000e800: 7661 6c28 6772 6f75 7073 2e67 726f 7570  val(groups.group
-0000e810: 2832 2929 2920 3d3d 207b 276e 6f74 5f68  (2))) == {'not_h
-0000e820: 6967 685f 636f 6c75 6d6e 272c 2027 6e6f  igh_column', 'no
-0000e830: 745f 6c6f 775f 636f 6c75 6d6e 277d 0a20  t_low_column'}. 
-0000e840: 2020 2020 2020 2061 7373 6572 7420 7374         assert st
-0000e850: 7228 6576 616c 2867 726f 7570 732e 6772  r(eval(groups.gr
-0000e860: 6f75 7028 3329 2929 203d 3d20 272b 270a  oup(3))) == '+'.
-0000e870: 0a20 2020 2064 6566 2074 6573 745f 5f76  .    def test__v
-0000e880: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
-0000e890: 5f63 6f6c 756d 6e73 2873 656c 6629 3a0a  _columns(self):.
-0000e8a0: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-0000e8b0: 7468 6520 6060 5f76 616c 6964 6174 655f  the ``_validate_
-0000e8c0: 6d65 7461 6461 7461 5f63 6f6c 756d 6e73  metadata_columns
-0000e8d0: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
-0000e8e0: 2020 2020 416c 6c20 6f66 2074 6865 2063      All of the c
-0000e8f0: 6f6c 756d 6e73 2070 6173 7365 6420 696e  olumns passed in
-0000e900: 2063 6f6c 756d 6e5f 6e61 6d65 7320 7368   column_names sh
-0000e910: 6f75 6c64 2062 6520 696e 2074 6865 206d  ould be in the m
-0000e920: 6574 6164 6174 612e 0a0a 2020 2020 2020  etadata...      
-0000e930: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
-0000e940: 2020 2020 202d 2063 6f6c 756d 6e5f 6e61       - column_na
-0000e950: 6d65 2077 6974 6820 636f 6c75 6d6e 2074  me with column t
-0000e960: 6861 7420 6973 2069 6e20 7468 6520 6d65  hat is in the me
-0000e970: 7461 6461 7461 2e0a 0a20 2020 2020 2020  tadata...       
-0000e980: 2053 6964 6520 6566 6665 6374 3a0a 2020   Side effect:.  
-0000e990: 2020 2020 2020 2020 2020 2d20 4e6f 2065            - No e
-0000e9a0: 7272 6f72 2073 686f 756c 6420 6265 2072  rror should be r
-0000e9b0: 6169 7365 642e 0a20 2020 2020 2020 2022  aised..        "
-0000e9c0: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
-0000e9d0: 7570 0a20 2020 2020 2020 206d 6574 6164  up.        metad
-0000e9e0: 6174 6120 3d20 4d6f 636b 2829 0a20 2020  ata = Mock().   
-0000e9f0: 2020 2020 206d 6574 6164 6174 612e 636f       metadata.co
-0000ea00: 6c75 6d6e 7320 3d20 7b27 6127 3a20 312c  lumns = {'a': 1,
-0000ea10: 2027 6227 3a20 327d 0a0a 2020 2020 2020   'b': 2}..      
-0000ea20: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
-0000ea30: 5363 616c 6172 496e 6571 7561 6c69 7479  ScalarInequality
-0000ea40: 2e5f 7661 6c69 6461 7465 5f6d 6574 6164  ._validate_metad
-0000ea50: 6174 615f 636f 6c75 6d6e 7328 6d65 7461  ata_columns(meta
-0000ea60: 6461 7461 2c20 636f 6c75 6d6e 5f6e 616d  data, column_nam
-0000ea70: 653d 2761 2729 0a0a 2020 2020 6465 6620  e='a')..    def 
-0000ea80: 7465 7374 5f5f 7661 6c69 6461 7465 5f6d  test__validate_m
-0000ea90: 6574 6164 6174 615f 636f 6c75 6d6e 735f  etadata_columns_
-0000eaa0: 7261 6973 6573 5f65 7272 6f72 2873 656c  raises_error(sel
-0000eab0: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
-0000eac0: 6573 7420 7468 6520 6060 5f76 616c 6964  est the ``_valid
-0000ead0: 6174 655f 6d65 7461 6461 7461 5f63 6f6c  ate_metadata_col
-0000eae0: 756d 6e73 6060 206d 6574 686f 6427 7320  umns`` method's 
-0000eaf0: 6572 726f 7220 636f 6e64 6974 696f 6e2e  error condition.
-0000eb00: 0a0a 2020 2020 2020 2020 4966 2074 6865  ..        If the
-0000eb10: 2063 6f6c 756d 6e5f 6e61 6d65 2069 7320   column_name is 
-0000eb20: 6e6f 7420 696e 2074 6865 206d 6574 6164  not in the metad
-0000eb30: 6174 612c 2061 6e20 6572 726f 7220 7368  ata, an error sh
-0000eb40: 6f75 6c64 2062 6520 7261 6973 6564 2e0a  ould be raised..
-0000eb50: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-0000eb60: 2020 2020 2020 2020 2020 2020 2d20 636f              - co
-0000eb70: 6c75 6d6e 5f6e 616d 6520 7468 6174 2069  lumn_name that i
-0000eb80: 7320 6e6f 7420 696e 2074 6865 206d 6574  s not in the met
-0000eb90: 6164 6174 612e 0a0a 2020 2020 2020 2020  adata...        
-0000eba0: 5369 6465 2065 6666 6563 743a 0a20 2020  Side effect:.   
-0000ebb0: 2020 2020 2020 2020 202d 2043 6f6e 7374           - Const
-0000ebc0: 7261 696e 744d 6574 6164 6174 6145 7272  raintMetadataErr
-0000ebd0: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
-0000ebe0: 7365 642e 0a20 2020 2020 2020 2022 2222  sed..        """
-0000ebf0: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-0000ec00: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
-0000ec10: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
-0000ec20: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
-0000ec30: 6d6e 7320 3d20 7b27 6127 3a20 312c 2027  mns = {'a': 1, '
-0000ec40: 6227 3a20 327d 0a0a 2020 2020 2020 2020  b': 2}..        
-0000ec50: 2320 5275 6e0a 2020 2020 2020 2020 6572  # Run.        er
-0000ec60: 726f 725f 6d65 7373 6167 6520 3d20 7265  ror_message = re
-0000ec70: 2e65 7363 6170 6528 0a20 2020 2020 2020  .escape(.       
-0000ec80: 2020 2020 2027 4120 5363 616c 6172 496e       'A ScalarIn
-0000ec90: 6571 7561 6c69 7479 2063 6f6e 7374 7261  equality constra
-0000eca0: 696e 7420 6973 2062 6569 6e67 2061 7070  int is being app
-0000ecb0: 6c69 6564 2074 6f20 696e 7661 6c69 6420  lied to invalid 
-0000ecc0: 636f 6c75 6d6e 206e 616d 6573 2027 0a20  column names '. 
-0000ecd0: 2020 2020 2020 2020 2020 2022 7b27 6327             "{'c'
-0000ece0: 7d2e 2054 6865 2063 6f6c 756d 6e73 206d  }. The columns m
-0000ecf0: 7573 7420 6578 6973 7420 696e 2074 6865  ust exist in the
-0000ed00: 2074 6162 6c65 2e22 0a20 2020 2020 2020   table.".       
-0000ed10: 2029 0a20 2020 2020 2020 2077 6974 6820   ).        with 
-0000ed20: 7079 7465 7374 2e72 6169 7365 7328 436f  pytest.raises(Co
-0000ed30: 6e73 7472 6169 6e74 4d65 7461 6461 7461  nstraintMetadata
-0000ed40: 4572 726f 722c 206d 6174 6368 3d65 7272  Error, match=err
-0000ed50: 6f72 5f6d 6573 7361 6765 293a 0a20 2020  or_message):.   
-0000ed60: 2020 2020 2020 2020 2053 6361 6c61 7249           ScalarI
-0000ed70: 6e65 7175 616c 6974 792e 5f76 616c 6964  nequality._valid
-0000ed80: 6174 655f 6d65 7461 6461 7461 5f63 6f6c  ate_metadata_col
-0000ed90: 756d 6e73 286d 6574 6164 6174 612c 2063  umns(metadata, c
-0000eda0: 6f6c 756d 6e5f 6e61 6d65 3d27 6327 290a  olumn_name='c').
-0000edb0: 0a20 2020 2064 6566 2074 6573 745f 5f76  .    def test__v
-0000edc0: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
-0000edd0: 5f73 7065 6369 6669 635f 746f 5f63 6f6e  _specific_to_con
-0000ede0: 7374 7261 696e 745f 6e75 6d65 7269 6361  straint_numerica
-0000edf0: 6c28 7365 6c66 293a 0a20 2020 2020 2020  l(self):.       
-0000ee00: 2022 2222 5465 7374 2074 6865 2060 605f   """Test the ``_
-0000ee10: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-0000ee20: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
-0000ee30: 6e73 7472 6169 6e74 6060 206d 6574 686f  nstraint`` metho
-0000ee40: 642e 0a0a 2020 2020 2020 2020 4966 2074  d...        If t
-0000ee50: 6865 2063 6f6c 756d 6e5f 6e61 6d65 2068  he column_name h
-0000ee60: 6173 2061 6e20 7364 7479 7065 206f 6620  as an sdtype of 
-0000ee70: 6e75 6d65 7269 6361 6c2c 2061 6e64 2074  numerical, and t
-0000ee80: 6865 2076 616c 7565 0a20 2020 2020 2020  he value.       
-0000ee90: 2069 7320 616e 2069 6e74 206f 7220 666c   is an int or fl
-0000eea0: 6f61 742c 2074 6865 6e20 6e6f 2065 7272  oat, then no err
-0000eeb0: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
-0000eec0: 7365 642e 0a0a 2020 2020 2020 2020 5365  sed...        Se
-0000eed0: 7475 703a 0a20 2020 2020 2020 2020 2020  tup:.           
-0000eee0: 202d 204d 6574 6164 6174 6120 7769 7468   - Metadata with
-0000eef0: 2074 6865 2073 6474 7970 6520 7365 7420   the sdtype set 
-0000ef00: 746f 206e 756d 6572 6963 616c 2e0a 0a20  to numerical... 
-0000ef10: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
-0000ef20: 2020 2020 2020 2020 2020 2d20 5468 6520            - The 
-0000ef30: 636f 6c75 6d6e 206e 616d 6520 616e 6420  column name and 
-0000ef40: 6120 7661 6c75 6520 7365 7420 746f 2061  a value set to a
-0000ef50: 206e 756d 6265 722e 0a20 2020 2020 2020   number..       
-0000ef60: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
-0000ef70: 6574 7570 0a20 2020 2020 2020 206d 6574  etup.        met
-0000ef80: 6164 6174 6120 3d20 4d6f 636b 2829 0a20  adata = Mock(). 
-0000ef90: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
-0000efa0: 636f 6c75 6d6e 7320 3d20 7b27 6127 3a20  columns = {'a': 
-0000efb0: 7b27 7364 7479 7065 273a 2027 6e75 6d65  {'sdtype': 'nume
-0000efc0: 7269 6361 6c27 7d7d 0a0a 2020 2020 2020  rical'}}..      
-0000efd0: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
-0000efe0: 5363 616c 6172 496e 6571 7561 6c69 7479  ScalarInequality
-0000eff0: 2e5f 7661 6c69 6461 7465 5f6d 6574 6164  ._validate_metad
-0000f000: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
-0000f010: 636f 6e73 7472 6169 6e74 280a 2020 2020  constraint(.    
-0000f020: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-0000f030: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
-0000f040: 6c75 6d6e 5f6e 616d 653d 2761 272c 0a20  lumn_name='a',. 
-0000f050: 2020 2020 2020 2020 2020 2072 656c 6174             relat
-0000f060: 696f 6e3d 273e 272c 0a20 2020 2020 2020  ion='>',.       
-0000f070: 2020 2020 2076 616c 7565 3d37 0a20 2020       value=7.   
-0000f080: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-0000f090: 7465 7374 5f5f 7661 6c69 6461 7465 5f6d  test__validate_m
-0000f0a0: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
-0000f0b0: 5f74 6f5f 636f 6e73 7472 6169 6e74 5f6e  _to_constraint_n
-0000f0c0: 756d 6572 6963 616c 5f65 7272 6f72 2873  umerical_error(s
-0000f0d0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-0000f0e0: 2254 6573 7420 7468 6520 6060 5f76 616c  "Test the ``_val
-0000f0f0: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
-0000f100: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
-0000f110: 7261 696e 7460 6020 6d65 7468 6f64 2e0a  raint`` method..
-0000f120: 0a20 2020 2020 2020 2049 6620 7468 6520  .        If the 
-0000f130: 636f 6c75 6d6e 5f6e 616d 6520 6861 7320  column_name has 
-0000f140: 616e 2073 6474 7970 6520 6f66 206e 756d  an sdtype of num
-0000f150: 6572 6963 616c 2c20 616e 6420 7468 6520  erical, and the 
-0000f160: 7661 6c75 650a 2020 2020 2020 2020 6973  value.        is
-0000f170: 206e 6f74 2061 6e20 696e 7420 6f72 2066   not an int or f
-0000f180: 6c6f 6174 2c20 7468 656e 2061 6e20 6572  loat, then an er
-0000f190: 726f 7220 7368 6f75 6c64 2062 6520 7261  ror should be ra
-0000f1a0: 6973 6564 2e0a 0a20 2020 2020 2020 2053  ised...        S
-0000f1b0: 6574 7570 3a0a 2020 2020 2020 2020 2020  etup:.          
-0000f1c0: 2020 2d20 4d65 7461 6461 7461 2077 6974    - Metadata wit
-0000f1d0: 6820 7468 6520 7364 7479 7065 2073 6574  h the sdtype set
-0000f1e0: 2074 6f20 6e75 6d65 7269 6361 6c2e 0a0a   to numerical...
-0000f1f0: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
-0000f200: 2020 2020 2020 2020 2020 202d 2054 6865             - The
-0000f210: 2063 6f6c 756d 6e20 6e61 6d65 2061 6e64   column name and
-0000f220: 2061 2076 616c 7565 2073 6574 2074 6f20   a value set to 
-0000f230: 6120 7374 7269 6e67 2e0a 2020 2020 2020  a string..      
-0000f240: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
-0000f250: 5365 7475 700a 2020 2020 2020 2020 6d65  Setup.        me
-0000f260: 7461 6461 7461 203d 204d 6f63 6b28 290a  tadata = Mock().
-0000f270: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-0000f280: 2e63 6f6c 756d 6e73 203d 207b 2761 273a  .columns = {'a':
-0000f290: 207b 2773 6474 7970 6527 3a20 276e 756d   {'sdtype': 'num
-0000f2a0: 6572 6963 616c 277d 7d0a 0a20 2020 2020  erical'}}..     
-0000f2b0: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
-0000f2c0: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-0000f2d0: 2022 2776 616c 7565 2720 6d75 7374 2062   "'value' must b
-0000f2e0: 6520 616e 2069 6e74 206f 7220 666c 6f61  e an int or floa
-0000f2f0: 742e 220a 2020 2020 2020 2020 7769 7468  t.".        with
-0000f300: 2070 7974 6573 742e 7261 6973 6573 2843   pytest.raises(C
-0000f310: 6f6e 7374 7261 696e 744d 6574 6164 6174  onstraintMetadat
-0000f320: 6145 7272 6f72 2c20 6d61 7463 683d 6572  aError, match=er
-0000f330: 726f 725f 6d65 7373 6167 6529 3a0a 2020  ror_message):.  
-0000f340: 2020 2020 2020 2020 2020 5363 616c 6172            Scalar
-0000f350: 496e 6571 7561 6c69 7479 2e5f 7661 6c69  Inequality._vali
-0000f360: 6461 7465 5f6d 6574 6164 6174 615f 7370  date_metadata_sp
-0000f370: 6563 6966 6963 5f74 6f5f 636f 6e73 7472  ecific_to_constr
-0000f380: 6169 6e74 280a 2020 2020 2020 2020 2020  aint(.          
-0000f390: 2020 2020 2020 6d65 7461 6461 7461 2c0a        metadata,.
-0000f3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f3b0: 636f 6c75 6d6e 5f6e 616d 653d 2761 272c  column_name='a',
-0000f3c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f3d0: 2072 656c 6174 696f 6e3d 273e 272c 0a20   relation='>',. 
-0000f3e0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0000f3f0: 616c 7565 3d27 3727 0a20 2020 2020 2020  alue='7'.       
-0000f400: 2020 2020 2029 0a0a 2020 2020 4070 6174       )..    @pat
-0000f410: 6368 2827 7364 762e 636f 6e73 7472 6169  ch('sdv.constrai
-0000f420: 6e74 732e 7461 6275 6c61 722e 6d61 7463  nts.tabular.matc
-0000f430: 6865 735f 6461 7465 7469 6d65 5f66 6f72  hes_datetime_for
-0000f440: 6d61 7427 290a 2020 2020 6465 6620 7465  mat').    def te
-0000f450: 7374 5f5f 7661 6c69 6461 7465 5f6d 6574  st__validate_met
-0000f460: 6164 6174 615f 7370 6563 6966 6963 5f74  adata_specific_t
-0000f470: 6f5f 636f 6e73 7472 6169 6e74 5f64 6174  o_constraint_dat
-0000f480: 6574 696d 6528 7365 6c66 2c20 6461 7465  etime(self, date
-0000f490: 7469 6d65 5f66 6f72 6d61 745f 6d6f 636b  time_format_mock
-0000f4a0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-0000f4b0: 7374 2074 6865 2060 605f 7661 6c69 6461  st the ``_valida
-0000f4c0: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
-0000f4d0: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
-0000f4e0: 6e74 6060 206d 6574 686f 642e 0a0a 2020  nt`` method...  
-0000f4f0: 2020 2020 2020 4966 2074 6865 2063 6f6c        If the col
-0000f500: 756d 6e5f 6e61 6d65 2068 6173 2061 6e20  umn_name has an 
-0000f510: 7364 7479 7065 206f 6620 6461 7465 7469  sdtype of dateti
-0000f520: 6d65 2c20 616e 6420 7468 6520 7661 6c75  me, and the valu
-0000f530: 650a 2020 2020 2020 2020 6973 2061 2064  e.        is a d
-0000f540: 6174 6574 696d 6520 7374 7269 6e67 2074  atetime string t
-0000f550: 6861 7420 6d61 7463 6865 7320 7468 6520  hat matches the 
-0000f560: 666f 726d 6174 2c20 7468 656e 206e 6f20  format, then no 
-0000f570: 6572 726f 7220 7368 6f75 6c64 2062 6520  error should be 
-0000f580: 7261 6973 6564 2e0a 0a20 2020 2020 2020  raised...       
-0000f590: 2053 6574 7570 3a0a 2020 2020 2020 2020   Setup:.        
-0000f5a0: 2020 2020 2d20 4d65 7461 6461 7461 2077      - Metadata w
-0000f5b0: 6974 6820 7468 6520 7364 7479 7065 2073  ith the sdtype s
-0000f5c0: 6574 2074 6f20 6461 7465 7469 6d65 2061  et to datetime a
-0000f5d0: 6e64 2061 2064 6174 6574 696d 655f 666f  nd a datetime_fo
-0000f5e0: 726d 6174 2e0a 2020 2020 2020 2020 2020  rmat..          
-0000f5f0: 2020 2d20 4d6f 636b 2074 6865 2060 606d    - Mock the ``m
-0000f600: 6174 6368 6573 5f64 6174 6574 696d 655f  atches_datetime_
-0000f610: 666f 726d 6174 6060 2066 756e 6374 696f  format`` functio
-0000f620: 6e20 746f 2072 6574 7572 6e20 5472 7565  n to return True
-0000f630: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
-0000f640: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-0000f650: 5468 6520 636f 6c75 6d6e 206e 616d 6520  The column name 
-0000f660: 616e 6420 6120 7661 6c75 6520 7365 7420  and a value set 
-0000f670: 746f 2061 2064 6174 6574 696d 6520 6f66  to a datetime of
-0000f680: 2074 6865 2072 6967 6874 2066 6f72 6d61   the right forma
-0000f690: 742e 0a20 2020 2020 2020 2022 2222 0a20  t..        """. 
-0000f6a0: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
-0000f6b0: 2020 2020 2020 206d 6574 6164 6174 6120         metadata 
-0000f6c0: 3d20 4d6f 636b 2829 0a20 2020 2020 2020  = Mock().       
-0000f6d0: 206d 6574 6164 6174 612e 636f 6c75 6d6e   metadata.column
-0000f6e0: 7320 3d20 7b27 6127 3a20 7b27 7364 7479  s = {'a': {'sdty
-0000f6f0: 7065 273a 2027 6461 7465 7469 6d65 272c  pe': 'datetime',
-0000f700: 2027 6461 7465 7469 6d65 5f66 6f72 6d61   'datetime_forma
-0000f710: 7427 3a20 276d 2f64 2f79 277d 7d0a 2020  t': 'm/d/y'}}.  
-0000f720: 2020 2020 2020 6461 7465 7469 6d65 5f66        datetime_f
-0000f730: 6f72 6d61 745f 6d6f 636b 2e72 6574 7572  ormat_mock.retur
-0000f740: 6e5f 7661 6c75 6520 3d20 5472 7565 0a0a  n_value = True..
-0000f750: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
-0000f760: 2020 2020 2020 5363 616c 6172 496e 6571        ScalarIneq
-0000f770: 7561 6c69 7479 2e5f 7661 6c69 6461 7465  uality._validate
-0000f780: 5f6d 6574 6164 6174 615f 7370 6563 6966  _metadata_specif
-0000f790: 6963 5f74 6f5f 636f 6e73 7472 6169 6e74  ic_to_constraint
-0000f7a0: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
-0000f7b0: 7461 6461 7461 2c0a 2020 2020 2020 2020  tadata,.        
-0000f7c0: 2020 2020 636f 6c75 6d6e 5f6e 616d 653d      column_name=
-0000f7d0: 2761 272c 0a20 2020 2020 2020 2020 2020  'a',.           
-0000f7e0: 2072 656c 6174 696f 6e3d 273e 272c 0a20   relation='>',. 
-0000f7f0: 2020 2020 2020 2020 2020 2076 616c 7565             value
-0000f800: 3d27 312f 312f 3230 3230 270a 2020 2020  ='1/1/2020'.    
-0000f810: 2020 2020 290a 0a20 2020 2040 7061 7463      )..    @patc
-0000f820: 6828 2773 6476 2e63 6f6e 7374 7261 696e  h('sdv.constrain
-0000f830: 7473 2e74 6162 756c 6172 2e6d 6174 6368  ts.tabular.match
-0000f840: 6573 5f64 6174 6574 696d 655f 666f 726d  es_datetime_form
-0000f850: 6174 2729 0a20 2020 2064 6566 2074 6573  at').    def tes
-0000f860: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
-0000f870: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
-0000f880: 5f63 6f6e 7374 7261 696e 745f 6461 7465  _constraint_date
-0000f890: 7469 6d65 5f65 7272 6f72 2873 656c 662c  time_error(self,
-0000f8a0: 2064 6174 6574 696d 655f 666f 726d 6174   datetime_format
-0000f8b0: 5f6d 6f63 6b29 3a0a 2020 2020 2020 2020  _mock):.        
-0000f8c0: 2222 2254 6573 7420 7468 6520 6060 5f76  """Test the ``_v
-0000f8d0: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
-0000f8e0: 5f73 7065 6369 6669 635f 746f 5f63 6f6e  _specific_to_con
-0000f8f0: 7374 7261 696e 7460 6020 6d65 7468 6f64  straint`` method
-0000f900: 2e0a 0a20 2020 2020 2020 2049 6620 7468  ...        If th
-0000f910: 6520 636f 6c75 6d6e 5f6e 616d 6520 6861  e column_name ha
-0000f920: 7320 616e 2073 6474 7970 6520 6f66 2064  s an sdtype of d
-0000f930: 6174 6574 696d 652c 2061 6e64 2074 6865  atetime, and the
-0000f940: 2076 616c 7565 0a20 2020 2020 2020 2069   value.        i
-0000f950: 7320 6120 6461 7465 7469 6d65 2073 7472  s a datetime str
-0000f960: 696e 6720 7468 6174 2064 6f65 736e 2774  ing that doesn't
-0000f970: 206d 6174 6368 2074 6865 2066 6f72 6d61   match the forma
-0000f980: 742c 2074 6865 6e20 616e 2065 7272 6f72  t, then an error
-0000f990: 2073 686f 756c 6420 6265 2072 6169 7365   should be raise
-0000f9a0: 642e 0a0a 2020 2020 2020 2020 5365 7475  d...        Setu
-0000f9b0: 703a 0a20 2020 2020 2020 2020 2020 202d  p:.            -
-0000f9c0: 204d 6574 6164 6174 6120 7769 7468 2074   Metadata with t
-0000f9d0: 6865 2073 6474 7970 6520 7365 7420 746f  he sdtype set to
-0000f9e0: 2064 6174 6574 696d 6520 616e 6420 6120   datetime and a 
-0000f9f0: 6461 7465 7469 6d65 5f66 6f72 6d61 742e  datetime_format.
-0000fa00: 0a20 2020 2020 2020 2020 2020 202d 204d  .            - M
-0000fa10: 6f63 6b20 7468 6520 6060 6d61 7463 6865  ock the ``matche
-0000fa20: 735f 6461 7465 7469 6d65 5f66 6f72 6d61  s_datetime_forma
-0000fa30: 7460 6020 6675 6e63 7469 6f6e 2074 6f20  t`` function to 
-0000fa40: 7265 7475 726e 2046 616c 7365 2e0a 0a20  return False... 
-0000fa50: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
-0000fa60: 2020 2020 2020 2020 2020 2d20 5468 6520            - The 
-0000fa70: 636f 6c75 6d6e 206e 616d 6520 616e 6420  column name and 
-0000fa80: 6120 7661 6c75 6520 7365 7420 746f 2061  a value set to a
-0000fa90: 2064 6174 6574 696d 6520 6f66 2074 6865   datetime of the
-0000faa0: 2077 726f 6e67 2066 6f72 6d61 742e 0a0a   wrong format...
-0000fab0: 2020 2020 2020 2020 5369 6465 2065 6666          Side eff
-0000fac0: 6563 743a 0a20 2020 2020 2020 2020 2020  ect:.           
-0000fad0: 202d 2041 2043 6f6e 7374 7261 696e 744d   - A ConstraintM
-0000fae0: 6574 6164 6174 6145 7272 6f72 2073 686f  etadataError sho
-0000faf0: 756c 6420 6265 2072 6169 7365 642e 0a20  uld be raised.. 
-0000fb00: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000fb10: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
-0000fb20: 2020 206d 6574 6164 6174 6120 3d20 4d6f     metadata = Mo
-0000fb30: 636b 2829 0a20 2020 2020 2020 206d 6574  ck().        met
-0000fb40: 6164 6174 612e 636f 6c75 6d6e 7320 3d20  adata.columns = 
-0000fb50: 7b27 6127 3a20 7b27 7364 7479 7065 273a  {'a': {'sdtype':
-0000fb60: 2027 6461 7465 7469 6d65 272c 2027 6461   'datetime', 'da
-0000fb70: 7465 7469 6d65 5f66 6f72 6d61 7427 3a20  tetime_format': 
-0000fb80: 276d 2f64 2f79 277d 7d0a 2020 2020 2020  'm/d/y'}}.      
-0000fb90: 2020 6461 7465 7469 6d65 5f66 6f72 6d61    datetime_forma
-0000fba0: 745f 6d6f 636b 2e72 6574 7572 6e5f 7661  t_mock.return_va
-0000fbb0: 6c75 6520 3d20 4661 6c73 650a 0a20 2020  lue = False..   
-0000fbc0: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
-0000fbd0: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-0000fbe0: 203d 2022 2776 616c 7565 2720 6d75 7374   = "'value' must
-0000fbf0: 2062 6520 6120 6461 7465 7469 6d65 2073   be a datetime s
-0000fc00: 7472 696e 6720 6f66 2074 6865 2072 6967  tring of the rig
-0000fc10: 6874 2066 6f72 6d61 7422 0a20 2020 2020  ht format".     
-0000fc20: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-0000fc30: 6169 7365 7328 436f 6e73 7472 6169 6e74  aises(Constraint
-0000fc40: 4d65 7461 6461 7461 4572 726f 722c 206d  MetadataError, m
-0000fc50: 6174 6368 3d65 7272 6f72 5f6d 6573 7361  atch=error_messa
-0000fc60: 6765 293a 0a20 2020 2020 2020 2020 2020  ge):.           
-0000fc70: 2053 6361 6c61 7249 6e65 7175 616c 6974   ScalarInequalit
-0000fc80: 792e 5f76 616c 6964 6174 655f 6d65 7461  y._validate_meta
-0000fc90: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
-0000fca0: 5f63 6f6e 7374 7261 696e 7428 0a20 2020  _constraint(.   
-0000fcb0: 2020 2020 2020 2020 2020 2020 206d 6574               met
-0000fcc0: 6164 6174 612c 0a20 2020 2020 2020 2020  adata,.         
-0000fcd0: 2020 2020 2020 2063 6f6c 756d 6e5f 6e61         column_na
-0000fce0: 6d65 3d27 6127 2c0a 2020 2020 2020 2020  me='a',.        
-0000fcf0: 2020 2020 2020 2020 7265 6c61 7469 6f6e          relation
-0000fd00: 3d27 3e27 2c0a 2020 2020 2020 2020 2020  ='>',.          
-0000fd10: 2020 2020 2020 7661 6c75 653d 2731 2d31        value='1-1
-0000fd20: 2d32 3032 3027 0a20 2020 2020 2020 2020  -2020'.         
-0000fd30: 2020 2029 0a0a 2020 2020 6465 6620 7465     )..    def te
-0000fd40: 7374 5f5f 7661 6c69 6461 7465 5f6d 6574  st__validate_met
-0000fd50: 6164 6174 615f 7370 6563 6966 6963 5f74  adata_specific_t
-0000fd60: 6f5f 636f 6e73 7472 6169 6e74 5f62 6164  o_constraint_bad
-0000fd70: 5f74 7970 6528 7365 6c66 293a 0a20 2020  _type(self):.   
-0000fd80: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
-0000fd90: 2060 605f 7661 6c69 6461 7465 5f6d 6574   ``_validate_met
-0000fda0: 6164 6174 615f 7370 6563 6966 6963 5f74  adata_specific_t
-0000fdb0: 6f5f 636f 6e73 7472 6169 6e74 6060 206d  o_constraint`` m
-0000fdc0: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
-0000fdd0: 4966 2074 6865 2063 6f6c 756d 6e5f 6e61  If the column_na
-0000fde0: 6d65 2068 6173 2061 6e20 7364 7479 7065  me has an sdtype
-0000fdf0: 2074 6861 7420 6973 206e 6f74 2061 2064   that is not a d
-0000fe00: 6174 6574 696d 6520 7374 7269 6e67 2c20  atetime string, 
-0000fe10: 696e 7420 6f72 0a20 2020 2020 2020 2066  int or.        f
-0000fe20: 6c6f 6174 2074 6865 6e20 616e 2065 7272  loat then an err
-0000fe30: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
-0000fe40: 7365 642e 0a0a 2020 2020 2020 2020 5365  sed...        Se
-0000fe50: 7475 703a 0a20 2020 2020 2020 2020 2020  tup:.           
-0000fe60: 202d 204d 6574 6164 6174 6120 7769 7468   - Metadata with
-0000fe70: 2074 6865 2073 6474 7970 6520 7365 7420   the sdtype set 
-0000fe80: 746f 2063 6174 6567 6f72 6963 616c 2e0a  to categorical..
-0000fe90: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-0000fea0: 2020 2020 2020 2020 2020 2020 2d20 5468              - Th
-0000feb0: 6520 636f 6c75 6d6e 206e 616d 652c 2072  e column name, r
-0000fec0: 656c 6174 696f 6e20 616e 6420 7661 6c75  elation and valu
-0000fed0: 652e 0a0a 2020 2020 2020 2020 5369 6465  e...        Side
-0000fee0: 2065 6666 6563 743a 0a20 2020 2020 2020   effect:.       
-0000fef0: 2020 2020 202d 2041 2043 6f6e 7374 7261       - A Constra
-0000ff00: 696e 744d 6574 6164 6174 6145 7272 6f72  intMetadataError
-0000ff10: 2073 686f 756c 6420 6265 2072 6169 7365   should be raise
-0000ff20: 642e 0a20 2020 2020 2020 2022 2222 0a20  d..        """. 
-0000ff30: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
-0000ff40: 2020 2020 2020 206d 6574 6164 6174 6120         metadata 
-0000ff50: 3d20 4d6f 636b 2829 0a20 2020 2020 2020  = Mock().       
-0000ff60: 206d 6574 6164 6174 612e 636f 6c75 6d6e   metadata.column
-0000ff70: 7320 3d20 7b27 6127 3a20 7b27 7364 7479  s = {'a': {'sdty
-0000ff80: 7065 273a 2027 6361 7465 676f 7269 6361  pe': 'categorica
-0000ff90: 6c27 7d7d 0a0a 2020 2020 2020 2020 2320  l'}}..        # 
-0000ffa0: 5275 6e0a 2020 2020 2020 2020 6572 726f  Run.        erro
-0000ffb0: 725f 6d65 7373 6167 6520 3d20 280a 2020  r_message = (.  
-0000ffc0: 2020 2020 2020 2020 2020 2741 2053 6361            'A Sca
-0000ffd0: 6c61 7249 6e65 7175 616c 6974 7920 636f  larInequality co
-0000ffe0: 6e73 7472 6169 6e74 2069 7320 6265 696e  nstraint is bein
-0000fff0: 6720 6170 706c 6965 6420 746f 2063 6f6c  g applied to col
-00010000: 756d 6e73 2077 6974 6820 6d69 736d 6174  umns with mismat
-00010010: 6368 6564 2073 6474 7970 6573 2e20 270a  ched sdtypes. '.
-00010020: 2020 2020 2020 2020 2020 2020 274e 756d              'Num
-00010030: 6572 6963 616c 2063 6f6c 756d 6e73 206d  erical columns m
-00010040: 7573 7420 6265 2063 6f6d 7061 7265 6420  ust be compared 
-00010050: 746f 2069 6e74 6567 6572 206f 7220 666c  to integer or fl
-00010060: 6f61 7420 7661 6c75 6573 2e20 270a 2020  oat values. '.  
-00010070: 2020 2020 2020 2020 2020 2744 6174 6574            'Datet
-00010080: 696d 6573 2063 6f6c 756d 6e20 6d75 7374  imes column must
-00010090: 2062 6520 636f 6d70 6172 6564 2074 6f20   be compared to 
-000100a0: 6461 7465 7469 6d65 2073 7472 696e 6773  datetime strings
-000100b0: 2e27 0a20 2020 2020 2020 2029 0a20 2020  .'.        ).   
-000100c0: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-000100d0: 2e72 6169 7365 7328 436f 6e73 7472 6169  .raises(Constrai
-000100e0: 6e74 4d65 7461 6461 7461 4572 726f 722c  ntMetadataError,
-000100f0: 206d 6174 6368 3d65 7272 6f72 5f6d 6573   match=error_mes
-00010100: 7361 6765 293a 0a20 2020 2020 2020 2020  sage):.         
-00010110: 2020 2053 6361 6c61 7249 6e65 7175 616c     ScalarInequal
-00010120: 6974 792e 5f76 616c 6964 6174 655f 6d65  ity._validate_me
-00010130: 7461 6461 7461 5f73 7065 6369 6669 635f  tadata_specific_
-00010140: 746f 5f63 6f6e 7374 7261 696e 7428 0a20  to_constraint(. 
-00010150: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00010160: 6574 6164 6174 612c 0a20 2020 2020 2020  etadata,.       
-00010170: 2020 2020 2020 2020 2063 6f6c 756d 6e5f           column_
-00010180: 6e61 6d65 3d27 6127 2c0a 2020 2020 2020  name='a',.      
-00010190: 2020 2020 2020 2020 2020 7265 6c61 7469            relati
-000101a0: 6f6e 3d27 3e27 2c0a 2020 2020 2020 2020  on='>',.        
-000101b0: 2020 2020 2020 2020 7661 6c75 653d 370a          value=7.
-000101c0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-000101d0: 2020 2064 6566 2074 6573 745f 5f76 616c     def test__val
-000101e0: 6964 6174 655f 696e 6974 5f69 6e70 7574  idate_init_input
-000101f0: 735f 696e 636f 7272 6563 745f 636f 6c75  s_incorrect_colu
-00010200: 6d6e 2873 656c 6629 3a0a 2020 2020 2020  mn(self):.      
-00010210: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
-00010220: 5f76 616c 6964 6174 655f 696e 6974 5f69  _validate_init_i
-00010230: 6e70 7574 7360 6020 6d65 7468 6f64 2e0a  nputs`` method..
-00010240: 0a20 2020 2020 2020 2045 6e73 7572 6520  .        Ensure 
-00010250: 7468 6520 6d65 7468 6f64 2072 6169 7365  the method raise
-00010260: 7320 616e 2065 7272 6f72 2077 6865 6e20  s an error when 
-00010270: 7468 6520 636f 6c75 6d6e 206e 616d 6520  the column name 
-00010280: 6973 206e 6f74 2061 2073 7472 696e 672e  is not a string.
-00010290: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
-000102a0: 0a20 2020 2020 2020 202d 2061 206e 6f6e  .        - a non
-000102b0: 2d73 7472 696e 670a 2020 2020 2020 2020  -string.        
-000102c0: 2d20 6120 6e75 6d62 6572 0a20 2020 2020  - a number.     
-000102d0: 2020 202d 2061 6e20 696e 6571 7561 6c69     - an inequali
-000102e0: 7479 0a20 2020 2020 2020 2053 6964 6520  ty.        Side 
-000102f0: 6566 6665 6374 3a0a 2020 2020 2020 2020  effect:.        
-00010300: 2d20 5261 6973 6520 6060 5661 6c75 6545  - Raise ``ValueE
-00010310: 7272 6f72 6060 2062 6563 6175 7365 2074  rror`` because t
-00010320: 6865 2063 6f6c 756d 6e20 6e61 6d65 206d  he column name m
-00010330: 7573 7420 6265 2061 2073 7472 696e 670a  ust be a string.
-00010340: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00010350: 2020 2020 2320 5275 6e20 2f20 4173 7365      # Run / Asse
-00010360: 7274 0a20 2020 2020 2020 2065 7272 5f6d  rt.        err_m
-00010370: 7367 203d 2027 6063 6f6c 756d 6e5f 6e61  sg = '`column_na
-00010380: 6d65 6020 6d75 7374 2062 6520 6120 7374  me` must be a st
-00010390: 7269 6e67 2e27 0a20 2020 2020 2020 2077  ring.'.        w
-000103a0: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-000103b0: 7328 5661 6c75 6545 7272 6f72 2c20 6d61  s(ValueError, ma
-000103c0: 7463 683d 6572 725f 6d73 6729 3a0a 2020  tch=err_msg):.  
-000103d0: 2020 2020 2020 2020 2020 5363 616c 6172            Scalar
-000103e0: 496e 6571 7561 6c69 7479 2e5f 7661 6c69  Inequality._vali
-000103f0: 6461 7465 5f69 6e69 745f 696e 7075 7473  date_init_inputs
-00010400: 2863 6f6c 756d 6e5f 6e61 6d65 3d5b 2761  (column_name=['a
-00010410: 275d 2c20 7661 6c75 653d 312c 2072 656c  '], value=1, rel
-00010420: 6174 696f 6e3d 273e 2729 0a0a 2020 2020  ation='>')..    
-00010430: 6465 6620 7465 7374 5f5f 7661 6c69 6461  def test__valida
-00010440: 7465 5f69 6e69 745f 696e 7075 7473 5f69  te_init_inputs_i
-00010450: 6e63 6f72 7265 6374 5f76 616c 7565 5f64  ncorrect_value_d
-00010460: 6174 6574 696d 6528 7365 6c66 293a 0a20  atetime(self):. 
-00010470: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
-00010480: 6865 2060 605f 7661 6c69 6461 7465 5f69  he ``_validate_i
-00010490: 6e69 745f 696e 7075 7473 6060 206d 6574  nit_inputs`` met
-000104a0: 686f 642e 0a0a 2020 2020 2020 2020 456e  hod...        En
-000104b0: 7375 7265 2074 6865 206d 6574 686f 6420  sure the method 
-000104c0: 7261 6973 6573 2061 6e20 6572 726f 7220  raises an error 
-000104d0: 7768 656e 2074 6865 2060 6076 616c 7565  when the ``value
-000104e0: 6060 2069 7320 6e6f 7420 6120 6060 4461  `` is not a ``Da
-000104f0: 7465 7469 6d65 6060 2072 6570 7265 7365  tetime`` represe
-00010500: 6e74 6564 0a20 2020 2020 2020 2061 7320  nted.        as 
-00010510: 7374 7269 6e67 2e0a 0a20 2020 2020 2020  string...       
-00010520: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
-00010530: 2d20 6120 7374 7269 6e67 0a20 2020 2020  - a string.     
-00010540: 2020 202d 2061 206e 6f6e 2073 7472 696e     - a non strin
-00010550: 6720 6461 7465 7469 6d65 0a20 2020 2020  g datetime.     
-00010560: 2020 202d 2061 6e20 696e 6571 7561 6c69     - an inequali
-00010570: 7479 0a20 2020 2020 2020 2053 6964 6520  ty.        Side 
-00010580: 6566 6665 6374 3a0a 2020 2020 2020 2020  effect:.        
-00010590: 2d20 5261 6973 6520 6060 5661 6c75 6545  - Raise ``ValueE
-000105a0: 7272 6f72 6060 2062 6563 6175 7365 2074  rror`` because t
-000105b0: 6865 2064 6174 6574 696d 6520 6861 7320  he datetime has 
-000105c0: 746f 2062 6520 7265 7072 6573 656e 7465  to be represente
-000105d0: 6420 6173 2061 2073 7472 696e 672e 0a20  d as a string.. 
-000105e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000105f0: 2020 2023 2052 756e 202f 2041 7373 6572     # Run / Asser
-00010600: 740a 2020 2020 2020 2020 7661 6c75 6520  t.        value 
-00010610: 3d20 7064 2e74 6f5f 6461 7465 7469 6d65  = pd.to_datetime
-00010620: 2827 3230 3231 2d30 322d 3031 2729 0a20  ('2021-02-01'). 
-00010630: 2020 2020 2020 2065 7272 5f6d 7367 203d         err_msg =
-00010640: 2027 4461 7465 7469 6d65 206d 7573 7420   'Datetime must 
-00010650: 6265 2072 6570 7265 7365 6e74 6564 2061  be represented a
-00010660: 7320 6120 7374 7269 6e67 2e27 0a20 2020  s a string.'.   
+0000c2b0: 2020 2020 6465 6620 7465 7374 5f5f 6765      def test__ge
+0000c2c0: 745f 6461 7465 7469 6d65 5f64 6966 6628  t_datetime_diff(
+0000c2d0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+0000c2e0: 2222 5465 7374 2074 6865 2060 6049 6e65  ""Test the ``Ine
+0000c2f0: 7175 616c 6974 792e 5f67 6574 5f64 6174  quality._get_dat
+0000c300: 6574 696d 655f 6469 6666 206d 6574 686f  etime_diff metho
+0000c310: 642e 0a0a 2020 2020 2020 2020 5468 6520  d...        The 
+0000c320: 6d65 7468 6f64 2069 7320 6578 7065 6374  method is expect
+0000c330: 6564 2074 6f20 636f 6d70 7574 6520 7468  ed to compute th
+0000c340: 6520 6469 6666 6572 656e 6365 2062 6574  e difference bet
+0000c350: 7765 656e 2074 6865 2068 6967 6820 616e  ween the high an
+0000c360: 6420 6c6f 770a 2020 2020 2020 2020 6461  d low.        da
+0000c370: 7465 7469 6d65 2063 6f6c 756d 6e73 2c20  tetime columns, 
+0000c380: 7472 6561 7469 6e67 206d 6973 7369 6e67  treating missing
+0000c390: 2076 616c 7565 7320 6173 204e 614e 2e0a   values as NaN..
+0000c3a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000c3b0: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
+0000c3c0: 2020 2020 696e 7374 616e 6365 203d 2049      instance = I
+0000c3d0: 6e65 7175 616c 6974 7928 6c6f 775f 636f  nequality(low_co
+0000c3e0: 6c75 6d6e 5f6e 616d 653d 2761 272c 2068  lumn_name='a', h
+0000c3f0: 6967 685f 636f 6c75 6d6e 5f6e 616d 653d  igh_column_name=
+0000c400: 2762 2729 0a20 2020 2020 2020 2069 6e73  'b').        ins
+0000c410: 7461 6e63 652e 5f64 7479 7065 203d 2027  tance._dtype = '
+0000c420: 4f27 0a20 2020 2020 2020 2068 6967 6820  O'.        high 
+0000c430: 3d20 7064 2e53 6572 6965 7328 5b27 3230  = pd.Series(['20
+0000c440: 3232 2d30 322d 3032 272c 2027 272c 2027  22-02-02', '', '
+0000c450: 3230 3233 2d30 312d 3032 275d 292e 746f  2023-01-02']).to
+0000c460: 5f6e 756d 7079 2829 0a20 2020 2020 2020  _numpy().       
+0000c470: 206c 6f77 203d 2070 642e 5365 7269 6573   low = pd.Series
+0000c480: 285b 2732 3032 322d 3032 2d30 3127 2c20  (['2022-02-01', 
+0000c490: 2732 3032 322d 3032 2d30 3227 2c20 2732  '2022-02-02', '2
+0000c4a0: 3032 332d 3031 2d30 3127 5d29 2e74 6f5f  023-01-01']).to_
+0000c4b0: 6e75 6d70 7928 290a 2020 2020 2020 2020  numpy().        
+0000c4c0: 6578 7065 6374 6564 203d 206e 702e 6172  expected = np.ar
+0000c4d0: 7261 7928 5b38 2e36 3465 3133 2c20 6e70  ray([8.64e13, np
+0000c4e0: 2e6e 616e 2c20 382e 3634 6531 335d 290a  .nan, 8.64e13]).
+0000c4f0: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+0000c500: 2020 2020 2020 2064 6966 6620 3d20 696e         diff = in
+0000c510: 7374 616e 6365 2e5f 6765 745f 6461 7465  stance._get_date
+0000c520: 7469 6d65 5f64 6966 6628 6869 6768 2c20  time_diff(high, 
+0000c530: 6c6f 7729 0a0a 2020 2020 2020 2020 2320  low)..        # 
+0000c540: 4173 7365 7274 0a20 2020 2020 2020 2061  Assert.        a
+0000c550: 7373 6572 7420 6e70 2e61 7272 6179 5f65  ssert np.array_e
+0000c560: 7175 616c 2865 7870 6563 7465 642c 2064  qual(expected, d
+0000c570: 6966 662c 2065 7175 616c 5f6e 616e 3d54  iff, equal_nan=T
+0000c580: 7275 6529 0a0a 2020 2020 6465 6620 7465  rue)..    def te
+0000c590: 7374 5f5f 7472 616e 7366 6f72 6d28 7365  st__transform(se
+0000c5a0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0000c5b0: 5465 7374 2074 6865 2060 6049 6e65 7175  Test the ``Inequ
+0000c5c0: 616c 6974 792e 5f74 7261 6e73 666f 726d  ality._transform
+0000c5d0: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
+0000c5e0: 2020 2020 5468 6520 6d65 7468 6f64 2069      The method i
+0000c5f0: 7320 6578 7065 6374 6564 2074 6f20 636f  s expected to co
+0000c600: 6d70 7574 6520 7468 6520 6469 7374 616e  mpute the distan
+0000c610: 6365 2062 6574 7765 656e 2074 6865 2068  ce between the h
+0000c620: 6967 6820 616e 6420 6c6f 7720 636f 6c75  igh and low colu
+0000c630: 6d6e 730a 2020 2020 2020 2020 616e 6420  mns.        and 
+0000c640: 6372 6561 7465 2061 2064 6966 6620 636f  create a diff co
+0000c650: 6c75 6d6e 2077 6974 6820 7468 6520 6c6f  lumn with the lo
+0000c660: 6761 7269 7468 6d20 6f66 2074 6865 2064  garithm of the d
+0000c670: 6973 7461 6e63 6520 2b20 312e 0a0a 2020  istance + 1...  
+0000c680: 2020 2020 2020 5365 7475 703a 0a20 2020        Setup:.   
+0000c690: 2020 2020 202d 2060 605f 6469 6666 5f63       - ``_diff_c
+0000c6a0: 6f6c 756d 6e5f 6e61 6d65 6060 2069 7320  olumn_name`` is 
+0000c6b0: 7365 7420 746f 2060 6027 6123 6227 6060  set to ``'a#b'``
+0000c6c0: 2e0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
+0000c6d0: 0a20 2020 2020 2020 202d 2054 6162 6c65  .        - Table
+0000c6e0: 2077 6974 6820 7477 6f20 636f 6c75 6d6e   with two column
+0000c6f0: 7320 6174 2061 2063 6f6e 7374 616e 7420  s at a constant 
+0000c700: 6469 7374 616e 6365 206f 6620 3320 616e  distance of 3 an
+0000c710: 6420 6f6e 6520 6164 6469 7469 6f6e 616c  d one additional
+0000c720: 2064 756d 6d79 2063 6f6c 756d 6e2e 0a20   dummy column.. 
+0000c730: 2020 2020 2020 204f 7574 7075 743a 0a20         Output:. 
+0000c740: 2020 2020 2020 202d 2053 616d 6520 7461         - Same ta
+0000c750: 626c 6520 7769 7468 2061 2064 6966 6620  ble with a diff 
+0000c760: 636f 6c75 6d6e 206f 6620 7468 6520 6c6f  column of the lo
+0000c770: 6720 6f66 2064 6973 7461 6e63 6573 202b  g of distances +
+0000c780: 2031 2c20 7768 6963 6820 6973 206e 702e   1, which is np.
+0000c790: 6c6f 6728 3429 2e0a 2020 2020 2020 2020  log(4)..        
+0000c7a0: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
+0000c7b0: 7475 700a 2020 2020 2020 2020 696e 7374  tup.        inst
+0000c7c0: 616e 6365 203d 2049 6e65 7175 616c 6974  ance = Inequalit
+0000c7d0: 7928 6c6f 775f 636f 6c75 6d6e 5f6e 616d  y(low_column_nam
+0000c7e0: 653d 2761 272c 2068 6967 685f 636f 6c75  e='a', high_colu
+0000c7f0: 6d6e 5f6e 616d 653d 2762 2729 0a20 2020  mn_name='b').   
+0000c800: 2020 2020 2069 6e73 7461 6e63 652e 5f64       instance._d
+0000c810: 6966 665f 636f 6c75 6d6e 5f6e 616d 6520  iff_column_name 
+0000c820: 3d20 2761 2362 270a 0a20 2020 2020 2020  = 'a#b'..       
+0000c830: 2023 2052 756e 0a20 2020 2020 2020 2074   # Run.        t
+0000c840: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
+0000c850: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
+0000c860: 2020 2020 2020 2027 6127 3a20 5b31 2c20         'a': [1, 
+0000c870: 322c 2033 5d2c 0a20 2020 2020 2020 2020  2, 3],.         
+0000c880: 2020 2027 6227 3a20 5b34 2c20 352c 2036     'b': [4, 5, 6
+0000c890: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
+0000c8a0: 6327 3a20 5b37 2c20 382c 2039 5d2c 0a20  c': [7, 8, 9],. 
+0000c8b0: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
+0000c8c0: 2020 6f75 7420 3d20 696e 7374 616e 6365    out = instance
+0000c8d0: 2e5f 7472 616e 7366 6f72 6d28 7461 626c  ._transform(tabl
+0000c8e0: 655f 6461 7461 290a 0a20 2020 2020 2020  e_data)..       
+0000c8f0: 2023 2041 7373 6572 740a 2020 2020 2020   # Assert.      
+0000c900: 2020 6578 7065 6374 6564 5f6f 7574 203d    expected_out =
+0000c910: 2070 642e 4461 7461 4672 616d 6528 7b0a   pd.DataFrame({.
+0000c920: 2020 2020 2020 2020 2020 2020 2761 273a              'a':
+0000c930: 205b 312c 2032 2c20 335d 2c0a 2020 2020   [1, 2, 3],.    
+0000c940: 2020 2020 2020 2020 2763 273a 205b 372c          'c': [7,
+0000c950: 2038 2c20 395d 2c0a 2020 2020 2020 2020   8, 9],.        
+0000c960: 2020 2020 2761 2362 273a 205b 6e70 2e6c      'a#b': [np.l
+0000c970: 6f67 2834 295d 202a 2033 2c0a 2020 2020  og(4)] * 3,.    
+0000c980: 2020 2020 7d29 0a20 2020 2020 2020 2070      }).        p
+0000c990: 642e 7465 7374 696e 672e 6173 7365 7274  d.testing.assert
+0000c9a0: 5f66 7261 6d65 5f65 7175 616c 286f 7574  _frame_equal(out
+0000c9b0: 2c20 6578 7065 6374 6564 5f6f 7574 290a  , expected_out).
+0000c9c0: 0a20 2020 2064 6566 2074 6573 745f 5f74  .    def test__t
+0000c9d0: 7261 6e73 666f 726d 5f64 6174 6574 696d  ransform_datetim
+0000c9e0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+0000c9f0: 2022 2222 5465 7374 2074 6865 2060 6049   """Test the ``I
+0000ca00: 6e65 7175 616c 6974 792e 5f74 7261 6e73  nequality._trans
+0000ca10: 666f 726d 6060 206d 6574 686f 642e 0a0a  form`` method...
+0000ca20: 2020 2020 2020 2020 5468 6520 6d65 7468          The meth
+0000ca30: 6f64 2069 7320 6578 7065 6374 6564 2074  od is expected t
+0000ca40: 6f20 636f 6d70 7574 6520 7468 6520 6469  o compute the di
+0000ca50: 7374 616e 6365 2062 6574 7765 656e 2074  stance between t
+0000ca60: 6865 2068 6967 6820 616e 6420 6c6f 7720  he high and low 
+0000ca70: 636f 6c75 6d6e 730a 2020 2020 2020 2020  columns.        
+0000ca80: 616e 6420 6372 6561 7465 2061 2064 6966  and create a dif
+0000ca90: 6620 636f 6c75 6d6e 2077 6974 6820 7468  f column with th
+0000caa0: 6520 6c6f 6761 7269 7468 6d20 6f66 2074  e logarithm of t
+0000cab0: 6865 2064 6973 7461 6e63 6520 2b20 312e  he distance + 1.
+0000cac0: 0a0a 2020 2020 2020 2020 5365 7475 703a  ..        Setup:
+0000cad0: 0a20 2020 2020 2020 202d 2060 605f 6469  .        - ``_di
+0000cae0: 6666 5f63 6f6c 756d 6e5f 6e61 6d65 6060  ff_column_name``
+0000caf0: 2069 7320 7365 7420 746f 2060 6027 6123   is set to ``'a#
+0000cb00: 6227 6060 2e0a 2020 2020 2020 2020 496e  b'``..        In
+0000cb10: 7075 743a 0a20 2020 2020 2020 202d 2054  put:.        - T
+0000cb20: 6162 6c65 2077 6974 6820 7477 6f20 6461  able with two da
+0000cb30: 7465 7469 6d65 2063 6f6c 756d 6e73 2061  tetime columns a
+0000cb40: 7420 6120 6469 7374 616e 6365 206f 6620  t a distance of 
+0000cb50: 3320 616e 6420 6f6e 6520 6164 6469 7469  3 and one additi
+0000cb60: 6f6e 616c 2064 756d 6d79 2063 6f6c 756d  onal dummy colum
+0000cb70: 6e2e 0a20 2020 2020 2020 204f 7574 7075  n..        Outpu
+0000cb80: 743a 0a20 2020 2020 2020 202d 2053 616d  t:.        - Sam
+0000cb90: 6520 7461 626c 6520 7769 7468 2061 2064  e table with a d
+0000cba0: 6966 6620 636f 6c75 6d6e 206f 6620 7468  iff column of th
+0000cbb0: 6520 6c6f 6720 6f66 2064 6973 7461 6e63  e log of distanc
+0000cbc0: 6573 202b 2031 2c20 7768 6963 6820 6973  es + 1, which is
+0000cbd0: 206e 702e 6c6f 6728 3429 2e0a 2020 2020   np.log(4)..    
+0000cbe0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000cbf0: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
+0000cc00: 696e 7374 616e 6365 203d 2049 6e65 7175  instance = Inequ
+0000cc10: 616c 6974 7928 6c6f 775f 636f 6c75 6d6e  ality(low_column
+0000cc20: 5f6e 616d 653d 2761 272c 2068 6967 685f  _name='a', high_
+0000cc30: 636f 6c75 6d6e 5f6e 616d 653d 2762 2729  column_name='b')
+0000cc40: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
+0000cc50: 652e 5f64 6966 665f 636f 6c75 6d6e 5f6e  e._diff_column_n
+0000cc60: 616d 6520 3d20 2761 2362 270a 2020 2020  ame = 'a#b'.    
+0000cc70: 2020 2020 696e 7374 616e 6365 2e5f 6973      instance._is
+0000cc80: 5f64 6174 6574 696d 6520 3d20 5472 7565  _datetime = True
+0000cc90: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
+0000cca0: 2020 2020 2020 2020 7461 626c 655f 6461          table_da
+0000ccb0: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
+0000ccc0: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
+0000ccd0: 2761 273a 2070 642e 746f 5f64 6174 6574  'a': pd.to_datet
+0000cce0: 696d 6528 5b27 3230 3230 2d30 312d 3031  ime(['2020-01-01
+0000ccf0: 5430 303a 3030 3a30 3027 2c20 2732 3032  T00:00:00', '202
+0000cd00: 302d 3031 2d30 3254 3030 3a30 303a 3030  0-01-02T00:00:00
+0000cd10: 275d 292c 0a20 2020 2020 2020 2020 2020  ']),.           
+0000cd20: 2027 6227 3a20 7064 2e74 6f5f 6461 7465   'b': pd.to_date
+0000cd30: 7469 6d65 285b 2732 3032 302d 3031 2d30  time(['2020-01-0
+0000cd40: 3154 3030 3a30 303a 3031 272c 2027 3230  1T00:00:01', '20
+0000cd50: 3230 2d30 312d 3032 5430 303a 3030 3a30  20-01-02T00:00:0
+0000cd60: 3127 5d29 2c0a 2020 2020 2020 2020 2020  1']),.          
+0000cd70: 2020 2763 273a 205b 312c 2032 5d2c 0a20    'c': [1, 2],. 
+0000cd80: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
+0000cd90: 2020 6f75 7420 3d20 696e 7374 616e 6365    out = instance
+0000cda0: 2e5f 7472 616e 7366 6f72 6d28 7461 626c  ._transform(tabl
+0000cdb0: 655f 6461 7461 290a 0a20 2020 2020 2020  e_data)..       
+0000cdc0: 2023 2041 7373 6572 740a 2020 2020 2020   # Assert.      
+0000cdd0: 2020 6578 7065 6374 6564 5f6f 7574 203d    expected_out =
+0000cde0: 2070 642e 4461 7461 4672 616d 6528 7b0a   pd.DataFrame({.
+0000cdf0: 2020 2020 2020 2020 2020 2020 2761 273a              'a':
+0000ce00: 2070 642e 746f 5f64 6174 6574 696d 6528   pd.to_datetime(
+0000ce10: 5b27 3230 3230 2d30 312d 3031 5430 303a  ['2020-01-01T00:
+0000ce20: 3030 3a30 3027 2c20 2732 3032 302d 3031  00:00', '2020-01
+0000ce30: 2d30 3254 3030 3a30 303a 3030 275d 292c  -02T00:00:00']),
+0000ce40: 0a20 2020 2020 2020 2020 2020 2027 6327  .            'c'
+0000ce50: 3a20 5b31 2c20 325d 2c0a 2020 2020 2020  : [1, 2],.      
+0000ce60: 2020 2020 2020 2761 2362 273a 205b 6e70        'a#b': [np
+0000ce70: 2e6c 6f67 2831 5f30 3030 5f30 3030 5f30  .log(1_000_000_0
+0000ce80: 3031 292c 206e 702e 6c6f 6728 315f 3030  01), np.log(1_00
+0000ce90: 305f 3030 305f 3030 3129 5d2c 0a20 2020  0_000_001)],.   
+0000cea0: 2020 2020 207d 290a 2020 2020 2020 2020       }).        
+0000ceb0: 7064 2e74 6573 7469 6e67 2e61 7373 6572  pd.testing.asser
+0000cec0: 745f 6672 616d 655f 6571 7561 6c28 6f75  t_frame_equal(ou
+0000ced0: 742c 2065 7870 6563 7465 645f 6f75 7429  t, expected_out)
+0000cee0: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
+0000cef0: 7472 616e 7366 6f72 6d5f 6461 7465 7469  transform_dateti
+0000cf00: 6d65 5f64 7479 7065 5f6f 626a 6563 7428  me_dtype_object(
+0000cf10: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+0000cf20: 2222 5465 7374 2074 6865 2060 6049 6e65  ""Test the ``Ine
+0000cf30: 7175 616c 6974 792e 5f74 7261 6e73 666f  quality._transfo
+0000cf40: 726d 6060 206d 6574 686f 642e 0a0a 2020  rm`` method...  
+0000cf50: 2020 2020 2020 5468 6520 6d65 7468 6f64        The method
+0000cf60: 2069 7320 6578 7065 6374 6564 2074 6f20   is expected to 
+0000cf70: 636f 6d70 7574 6520 7468 6520 6469 7374  compute the dist
+0000cf80: 616e 6365 2062 6574 7765 656e 2074 6865  ance between the
+0000cf90: 2068 6967 6820 616e 6420 6c6f 7720 636f   high and low co
+0000cfa0: 6c75 6d6e 730a 2020 2020 2020 2020 616e  lumns.        an
+0000cfb0: 6420 6372 6561 7465 2061 2064 6966 6620  d create a diff 
+0000cfc0: 636f 6c75 6d6e 2077 6974 6820 7468 6520  column with the 
+0000cfd0: 6c6f 6761 7269 7468 6d20 6f66 2074 6865  logarithm of the
+0000cfe0: 2064 6973 7461 6e63 6520 2b20 3120 6576   distance + 1 ev
+0000cff0: 656e 2077 6865 6e20 7468 6f73 650a 2020  en when those.  
+0000d000: 2020 2020 2020 6172 6520 6672 6f6d 2060        are from `
+0000d010: 605f 6474 7970 6560 6020 6f62 6a65 6374  `_dtype`` object
+0000d020: 2062 7574 2061 7265 2072 6570 7265 7365   but are represe
+0000d030: 6e74 696e 6720 6120 6461 7465 7469 6d65  nting a datetime
+0000d040: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000d050: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
+0000d060: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
+0000d070: 2049 6e65 7175 616c 6974 7928 6c6f 775f   Inequality(low_
+0000d080: 636f 6c75 6d6e 5f6e 616d 653d 2761 272c  column_name='a',
+0000d090: 2068 6967 685f 636f 6c75 6d6e 5f6e 616d   high_column_nam
+0000d0a0: 653d 2762 2729 0a20 2020 2020 2020 2069  e='b').        i
+0000d0b0: 6e73 7461 6e63 652e 5f64 6966 665f 636f  nstance._diff_co
+0000d0c0: 6c75 6d6e 5f6e 616d 6520 3d20 2761 2362  lumn_name = 'a#b
+0000d0d0: 270a 2020 2020 2020 2020 696e 7374 616e  '.        instan
+0000d0e0: 6365 2e5f 6973 5f64 6174 6574 696d 6520  ce._is_datetime 
+0000d0f0: 3d20 5472 7565 0a20 2020 2020 2020 2069  = True.        i
+0000d100: 6e73 7461 6e63 652e 5f64 7479 7065 203d  nstance._dtype =
+0000d110: 2027 4f27 0a0a 2020 2020 2020 2020 2320   'O'..        # 
+0000d120: 5275 6e0a 2020 2020 2020 2020 7461 626c  Run.        tabl
+0000d130: 655f 6461 7461 203d 2070 642e 4461 7461  e_data = pd.Data
+0000d140: 4672 616d 6528 7b0a 2020 2020 2020 2020  Frame({.        
+0000d150: 2020 2020 2761 273a 205b 2732 3032 302d      'a': ['2020-
+0000d160: 3031 2d30 3154 3030 3a30 303a 3030 272c  01-01T00:00:00',
+0000d170: 2027 3230 3230 2d30 312d 3032 5430 303a   '2020-01-02T00:
+0000d180: 3030 3a30 3027 5d2c 0a20 2020 2020 2020  00:00'],.       
+0000d190: 2020 2020 2027 6227 3a20 5b27 3230 3230       'b': ['2020
+0000d1a0: 2d30 312d 3031 5430 303a 3030 3a30 3127  -01-01T00:00:01'
+0000d1b0: 2c20 2732 3032 302d 3031 2d30 3254 3030  , '2020-01-02T00
+0000d1c0: 3a30 303a 3031 275d 2c0a 2020 2020 2020  :00:01'],.      
+0000d1d0: 2020 2020 2020 2763 273a 205b 312c 2032        'c': [1, 2
+0000d1e0: 5d2c 0a20 2020 2020 2020 207d 290a 2020  ],.        }).  
+0000d1f0: 2020 2020 2020 6f75 7420 3d20 696e 7374        out = inst
+0000d200: 616e 6365 2e5f 7472 616e 7366 6f72 6d28  ance._transform(
+0000d210: 7461 626c 655f 6461 7461 290a 0a20 2020  table_data)..   
+0000d220: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
+0000d230: 2020 2020 2020 6578 7065 6374 6564 5f6f        expected_o
+0000d240: 7574 203d 2070 642e 4461 7461 4672 616d  ut = pd.DataFram
+0000d250: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
+0000d260: 2761 273a 205b 2732 3032 302d 3031 2d30  'a': ['2020-01-0
+0000d270: 3154 3030 3a30 303a 3030 272c 2027 3230  1T00:00:00', '20
+0000d280: 3230 2d30 312d 3032 5430 303a 3030 3a30  20-01-02T00:00:0
+0000d290: 3027 5d2c 0a20 2020 2020 2020 2020 2020  0'],.           
+0000d2a0: 2027 6327 3a20 5b31 2c20 325d 2c0a 2020   'c': [1, 2],.  
+0000d2b0: 2020 2020 2020 2020 2020 2761 2362 273a            'a#b':
+0000d2c0: 205b 6e70 2e6c 6f67 2831 5f30 3030 5f30   [np.log(1_000_0
+0000d2d0: 3030 5f30 3031 292c 206e 702e 6c6f 6728  00_001), np.log(
+0000d2e0: 315f 3030 305f 3030 305f 3030 3129 5d2c  1_000_000_001)],
+0000d2f0: 0a20 2020 2020 2020 207d 290a 2020 2020  .        }).    
+0000d300: 2020 2020 7064 2e74 6573 7469 6e67 2e61      pd.testing.a
+0000d310: 7373 6572 745f 6672 616d 655f 6571 7561  ssert_frame_equa
+0000d320: 6c28 6f75 742c 2065 7870 6563 7465 645f  l(out, expected_
+0000d330: 6f75 7429 0a0a 2020 2020 6465 6620 7465  out)..    def te
+0000d340: 7374 5f72 6576 6572 7365 5f74 7261 6e73  st_reverse_trans
+0000d350: 666f 726d 2873 656c 6629 3a0a 2020 2020  form(self):.    
+0000d360: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
+0000d370: 6060 496e 6571 7561 6c69 7479 2e72 6576  ``Inequality.rev
+0000d380: 6572 7365 5f74 7261 6e73 666f 726d 6060  erse_transform``
+0000d390: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
+0000d3a0: 2020 5468 6520 6d65 7468 6f64 2069 7320    The method is 
+0000d3b0: 6578 7065 6374 6564 2074 6f3a 0a20 2020  expected to:.   
+0000d3c0: 2020 2020 2020 2020 202d 2061 7070 6c79           - apply
+0000d3d0: 2061 6e20 6578 706f 6e65 6e74 6961 6c20   an exponential 
+0000d3e0: 746f 2074 6865 2069 6e70 7574 0a20 2020  to the input.   
+0000d3f0: 2020 2020 2020 2020 202d 2073 7562 7472           - subtr
+0000d400: 6163 7420 310a 2020 2020 2020 2020 2020  act 1.          
+0000d410: 2020 2d20 6164 6420 7468 6520 6c6f 7720    - add the low 
+0000d420: 636f 6c75 6d6e 0a20 2020 2020 2020 2020  column.         
+0000d430: 2020 202d 2063 6f6e 7665 7274 2074 6865     - convert the
+0000d440: 206f 7574 7075 7420 746f 2069 6e74 6567   output to integ
+0000d450: 6572 730a 2020 2020 2020 2020 2020 2020  ers.            
+0000d460: 2d20 6164 6420 6261 636b 2074 6865 2064  - add back the d
+0000d470: 726f 7070 6564 2063 6f6c 756d 6e0a 0a20  ropped column.. 
+0000d480: 2020 2020 2020 2053 6574 7570 3a0a 2020         Setup:.  
+0000d490: 2020 2020 2020 2d20 6060 5f64 6966 665f        - ``_diff_
+0000d4a0: 636f 6c75 6d6e 5f6e 616d 6520 3d20 2761  column_name = 'a
+0000d4b0: 2362 2760 600a 2020 2020 2020 2020 2d20  #b'``.        - 
+0000d4c0: 6060 5f64 7479 7065 6060 2061 7320 696e  ``_dtype`` as in
+0000d4d0: 7465 6765 720a 2020 2020 2020 2020 496e  teger.        In
+0000d4e0: 7075 743a 0a20 2020 2020 2020 202d 2054  put:.        - T
+0000d4f0: 6162 6c65 2077 6974 6820 6120 6469 6666  able with a diff
+0000d500: 2063 6f6c 756d 6e20 7468 6174 2063 6f6e   column that con
+0000d510: 7461 696e 7320 7468 6520 636f 6e73 7461  tains the consta
+0000d520: 6e74 206e 702e 6c6f 6728 3429 2e0a 2020  nt np.log(4)..  
+0000d530: 2020 2020 2020 4f75 7470 7574 3a0a 2020        Output:.  
+0000d540: 2020 2020 2020 2d20 5361 6d65 2074 6162        - Same tab
+0000d550: 6c65 2077 6974 6820 7468 6520 6869 6768  le with the high
+0000d560: 2063 6f6c 756d 6e20 7265 706c 6163 6564   column replaced
+0000d570: 2062 7920 7468 6520 6c6f 7720 6f6e 6520   by the low one 
+0000d580: 2b20 3320 7769 7468 2064 6966 6620 636f  + 3 with diff co
+0000d590: 6c75 6d6e 2064 726f 7070 6564 2e0a 2020  lumn dropped..  
+0000d5a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000d5b0: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
+0000d5c0: 2020 696e 7374 616e 6365 203d 2049 6e65    instance = Ine
+0000d5d0: 7175 616c 6974 7928 6c6f 775f 636f 6c75  quality(low_colu
+0000d5e0: 6d6e 5f6e 616d 653d 2761 272c 2068 6967  mn_name='a', hig
+0000d5f0: 685f 636f 6c75 6d6e 5f6e 616d 653d 2762  h_column_name='b
+0000d600: 2729 0a20 2020 2020 2020 2069 6e73 7461  ').        insta
+0000d610: 6e63 652e 5f64 7479 7065 203d 2070 642e  nce._dtype = pd.
+0000d620: 5365 7269 6573 285b 315d 292e 6474 7970  Series([1]).dtyp
+0000d630: 6520 2023 2065 7861 6374 2064 7479 7065  e  # exact dtype
+0000d640: 2028 3332 206f 7220 3634 2920 6465 7065   (32 or 64) depe
+0000d650: 6e64 7320 6f6e 204f 530a 2020 2020 2020  nds on OS.      
+0000d660: 2020 696e 7374 616e 6365 2e5f 6469 6666    instance._diff
+0000d670: 5f63 6f6c 756d 6e5f 6e61 6d65 203d 2027  _column_name = '
+0000d680: 6123 6227 0a0a 2020 2020 2020 2020 2320  a#b'..        # 
+0000d690: 5275 6e0a 2020 2020 2020 2020 7472 616e  Run.        tran
+0000d6a0: 7366 6f72 6d65 6420 3d20 7064 2e44 6174  sformed = pd.Dat
+0000d6b0: 6146 7261 6d65 287b 0a20 2020 2020 2020  aFrame({.       
+0000d6c0: 2020 2020 2027 6127 3a20 5b31 2c20 322c       'a': [1, 2,
+0000d6d0: 2033 5d2c 0a20 2020 2020 2020 2020 2020   3],.           
+0000d6e0: 2027 6327 3a20 5b37 2c20 382c 2039 5d2c   'c': [7, 8, 9],
+0000d6f0: 0a20 2020 2020 2020 2020 2020 2027 6123  .            'a#
+0000d700: 6227 3a20 5b6e 702e 6c6f 6728 3429 5d20  b': [np.log(4)] 
+0000d710: 2a20 332c 0a20 2020 2020 2020 207d 290a  * 3,.        }).
+0000d720: 2020 2020 2020 2020 6f75 7420 3d20 696e          out = in
+0000d730: 7374 616e 6365 2e72 6576 6572 7365 5f74  stance.reverse_t
+0000d740: 7261 6e73 666f 726d 2874 7261 6e73 666f  ransform(transfo
+0000d750: 726d 6564 290a 0a20 2020 2020 2020 2023  rmed)..        #
+0000d760: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
+0000d770: 6578 7065 6374 6564 5f6f 7574 203d 2070  expected_out = p
+0000d780: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
+0000d790: 2020 2020 2020 2020 2020 2761 273a 205b            'a': [
+0000d7a0: 312c 2032 2c20 335d 2c0a 2020 2020 2020  1, 2, 3],.      
+0000d7b0: 2020 2020 2020 2763 273a 205b 372c 2038        'c': [7, 8
+0000d7c0: 2c20 395d 2c0a 2020 2020 2020 2020 2020  , 9],.          
+0000d7d0: 2020 2762 273a 205b 342c 2035 2c20 365d    'b': [4, 5, 6]
+0000d7e0: 2c0a 2020 2020 2020 2020 7d29 0a20 2020  ,.        }).   
+0000d7f0: 2020 2020 2070 642e 7465 7374 696e 672e       pd.testing.
+0000d800: 6173 7365 7274 5f66 7261 6d65 5f65 7175  assert_frame_equ
+0000d810: 616c 286f 7574 2c20 6578 7065 6374 6564  al(out, expected
+0000d820: 5f6f 7574 290a 0a20 2020 2064 6566 2074  _out)..    def t
+0000d830: 6573 745f 7265 7665 7273 655f 7472 616e  est_reverse_tran
+0000d840: 7366 6f72 6d5f 666c 6f61 7473 2873 656c  sform_floats(sel
+0000d850: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+0000d860: 6573 7420 7468 6520 6060 496e 6571 7561  est the ``Inequa
+0000d870: 6c69 7479 2e72 6576 6572 7365 5f74 7261  lity.reverse_tra
+0000d880: 6e73 666f 726d 6060 206d 6574 686f 642e  nsform`` method.
+0000d890: 0a0a 2020 2020 2020 2020 5468 6520 6d65  ..        The me
+0000d8a0: 7468 6f64 2069 7320 6578 7065 6374 6564  thod is expected
+0000d8b0: 2074 6f3a 0a20 2020 2020 2020 2020 2020   to:.           
+0000d8c0: 202d 2061 7070 6c79 2061 6e20 6578 706f   - apply an expo
+0000d8d0: 6e65 6e74 6961 6c20 746f 2074 6865 2069  nential to the i
+0000d8e0: 6e70 7574 0a20 2020 2020 2020 2020 2020  nput.           
+0000d8f0: 202d 2073 7562 7472 6163 7420 310a 2020   - subtract 1.  
+0000d900: 2020 2020 2020 2020 2020 2d20 6164 6420            - add 
+0000d910: 7468 6520 6c6f 7720 636f 6c75 6d6e 0a20  the low column. 
+0000d920: 2020 2020 2020 2020 2020 202d 2063 6f6e             - con
+0000d930: 7665 7274 2074 6865 206f 7574 7075 7420  vert the output 
+0000d940: 746f 2066 6c6f 6174 730a 2020 2020 2020  to floats.      
+0000d950: 2020 2020 2020 2d20 6164 6420 6261 636b        - add back
+0000d960: 2074 6865 2064 726f 7070 6564 2063 6f6c   the dropped col
+0000d970: 756d 6e0a 0a20 2020 2020 2020 2053 6574  umn..        Set
+0000d980: 7570 3a0a 2020 2020 2020 2020 2d20 6060  up:.        - ``
+0000d990: 5f64 6966 665f 636f 6c75 6d6e 5f6e 616d  _diff_column_nam
+0000d9a0: 6520 3d20 2761 2362 2760 600a 2020 2020  e = 'a#b'``.    
+0000d9b0: 2020 2020 2d20 6060 5f64 7479 7065 6060      - ``_dtype``
+0000d9c0: 2061 7320 666c 6f61 740a 2020 2020 2020   as float.      
+0000d9d0: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
+0000d9e0: 202d 2054 6162 6c65 2077 6974 6820 6120   - Table with a 
+0000d9f0: 6469 6666 2063 6f6c 756d 6e20 7468 6174  diff column that
+0000da00: 2063 6f6e 7461 696e 7320 7468 6520 636f   contains the co
+0000da10: 6e73 7461 6e74 206e 702e 6c6f 6728 3429  nstant np.log(4)
+0000da20: 2e0a 2020 2020 2020 2020 4f75 7470 7574  ..        Output
+0000da30: 3a0a 2020 2020 2020 2020 2d20 5361 6d65  :.        - Same
+0000da40: 2074 6162 6c65 2077 6974 6820 7468 6520   table with the 
+0000da50: 6869 6768 2063 6f6c 756d 6e20 7265 706c  high column repl
+0000da60: 6163 6564 2062 7920 7468 6520 6c6f 7720  aced by the low 
+0000da70: 6f6e 6520 2b20 3320 7769 7468 2064 6966  one + 3 with dif
+0000da80: 6620 636f 6c75 6d6e 2064 726f 7070 6564  f column dropped
+0000da90: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000daa0: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
+0000dab0: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
+0000dac0: 2049 6e65 7175 616c 6974 7928 6c6f 775f   Inequality(low_
+0000dad0: 636f 6c75 6d6e 5f6e 616d 653d 2761 272c  column_name='a',
+0000dae0: 2068 6967 685f 636f 6c75 6d6e 5f6e 616d   high_column_nam
+0000daf0: 653d 2762 2729 0a20 2020 2020 2020 2069  e='b').        i
+0000db00: 6e73 7461 6e63 652e 5f64 7479 7065 203d  nstance._dtype =
+0000db10: 206e 702e 6474 7970 6528 2766 6c6f 6174   np.dtype('float
+0000db20: 2729 0a20 2020 2020 2020 2069 6e73 7461  ').        insta
+0000db30: 6e63 652e 5f64 6966 665f 636f 6c75 6d6e  nce._diff_column
+0000db40: 5f6e 616d 6520 3d20 2761 2362 270a 0a20  _name = 'a#b'.. 
+0000db50: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
+0000db60: 2020 2020 2074 7261 6e73 666f 726d 6564       transformed
+0000db70: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
+0000db80: 7b0a 2020 2020 2020 2020 2020 2020 2761  {.            'a
+0000db90: 273a 205b 312e 312c 2032 2e32 2c20 332e  ': [1.1, 2.2, 3.
+0000dba0: 335d 2c0a 2020 2020 2020 2020 2020 2020  3],.            
+0000dbb0: 2763 273a 205b 372c 2038 2c20 395d 2c0a  'c': [7, 8, 9],.
+0000dbc0: 2020 2020 2020 2020 2020 2020 2761 2362              'a#b
+0000dbd0: 273a 205b 6e70 2e6c 6f67 2834 295d 202a  ': [np.log(4)] *
+0000dbe0: 2033 2c0a 2020 2020 2020 2020 7d29 0a20   3,.        }). 
+0000dbf0: 2020 2020 2020 206f 7574 203d 2069 6e73         out = ins
+0000dc00: 7461 6e63 652e 7265 7665 7273 655f 7472  tance.reverse_tr
+0000dc10: 616e 7366 6f72 6d28 7472 616e 7366 6f72  ansform(transfor
+0000dc20: 6d65 6429 0a0a 2020 2020 2020 2020 2320  med)..        # 
+0000dc30: 4173 7365 7274 0a20 2020 2020 2020 2065  Assert.        e
+0000dc40: 7870 6563 7465 645f 6f75 7420 3d20 7064  xpected_out = pd
+0000dc50: 2e44 6174 6146 7261 6d65 287b 0a20 2020  .DataFrame({.   
+0000dc60: 2020 2020 2020 2020 2027 6127 3a20 5b31           'a': [1
+0000dc70: 2e31 2c20 322e 322c 2033 2e33 5d2c 0a20  .1, 2.2, 3.3],. 
+0000dc80: 2020 2020 2020 2020 2020 2027 6327 3a20             'c': 
+0000dc90: 5b37 2c20 382c 2039 5d2c 0a20 2020 2020  [7, 8, 9],.     
+0000dca0: 2020 2020 2020 2027 6227 3a20 5b34 2e31         'b': [4.1
+0000dcb0: 2c20 352e 322c 2036 2e33 5d2c 0a20 2020  , 5.2, 6.3],.   
+0000dcc0: 2020 2020 207d 290a 2020 2020 2020 2020       }).        
+0000dcd0: 7064 2e74 6573 7469 6e67 2e61 7373 6572  pd.testing.asser
+0000dce0: 745f 6672 616d 655f 6571 7561 6c28 6f75  t_frame_equal(ou
+0000dcf0: 742c 2065 7870 6563 7465 645f 6f75 7429  t, expected_out)
+0000dd00: 0a0a 2020 2020 6465 6620 7465 7374 5f72  ..    def test_r
+0000dd10: 6576 6572 7365 5f74 7261 6e73 666f 726d  everse_transform
+0000dd20: 5f64 6174 6574 696d 6528 7365 6c66 293a  _datetime(self):
+0000dd30: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+0000dd40: 2074 6865 2060 6049 6e65 7175 616c 6974   the ``Inequalit
+0000dd50: 792e 7265 7665 7273 655f 7472 616e 7366  y.reverse_transf
+0000dd60: 6f72 6d60 6020 6d65 7468 6f64 2e0a 0a20  orm`` method... 
+0000dd70: 2020 2020 2020 2054 6865 206d 6574 686f         The metho
+0000dd80: 6420 6973 2065 7870 6563 7465 6420 746f  d is expected to
+0000dd90: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+0000dda0: 6170 706c 7920 616e 2065 7870 6f6e 656e  apply an exponen
+0000ddb0: 7469 616c 2074 6f20 7468 6520 696e 7075  tial to the inpu
+0000ddc0: 740a 2020 2020 2020 2020 2020 2020 2d20  t.            - 
+0000ddd0: 7375 6274 7261 6374 2031 0a20 2020 2020  subtract 1.     
+0000dde0: 2020 2020 2020 202d 2061 6464 2074 6865         - add the
+0000ddf0: 206c 6f77 2063 6f6c 756d 6e0a 2020 2020   low column.    
+0000de00: 2020 2020 2020 2020 2d20 636f 6e76 6572          - conver
+0000de10: 7420 7468 6520 6f75 7470 7574 2074 6f20  t the output to 
+0000de20: 6461 7465 7469 6d65 0a20 2020 2020 2020  datetime.       
+0000de30: 2020 2020 202d 2061 6464 2062 6163 6b20       - add back 
+0000de40: 7468 6520 6472 6f70 7065 6420 636f 6c75  the dropped colu
+0000de50: 6d6e 0a0a 2020 2020 2020 2020 5365 7475  mn..        Setu
+0000de60: 703a 0a20 2020 2020 2020 202d 2060 605f  p:.        - ``_
+0000de70: 6469 6666 5f63 6f6c 756d 6e5f 6e61 6d65  diff_column_name
+0000de80: 203d 2027 6123 6227 6060 0a20 2020 2020   = 'a#b'``.     
+0000de90: 2020 202d 2060 605f 6474 7970 6560 6020     - ``_dtype`` 
+0000dea0: 6173 2064 6174 6574 696d 650a 2020 2020  as datetime.    
+0000deb0: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
+0000dec0: 2020 202d 2054 6162 6c65 2077 6974 6820     - Table with 
+0000ded0: 6120 6469 6666 2063 6f6c 756d 6e20 7468  a diff column th
+0000dee0: 6174 2063 6f6e 7461 696e 7320 7468 6520  at contains the 
+0000def0: 636f 6e73 7461 6e74 206e 702e 6c6f 6728  constant np.log(
+0000df00: 3429 2e0a 2020 2020 2020 2020 4f75 7470  4)..        Outp
+0000df10: 7574 3a0a 2020 2020 2020 2020 2d20 5361  ut:.        - Sa
+0000df20: 6d65 2074 6162 6c65 2077 6974 6820 7468  me table with th
+0000df30: 6520 6869 6768 2063 6f6c 756d 6e20 7265  e high column re
+0000df40: 706c 6163 6564 2062 7920 7468 6520 6c6f  placed by the lo
+0000df50: 7720 6f6e 6520 2b20 3173 6563 2077 6974  w one + 1sec wit
+0000df60: 6820 6469 6666 2063 6f6c 756d 6e20 6472  h diff column dr
+0000df70: 6f70 7065 642e 0a20 2020 2020 2020 2022  opped..        "
+0000df80: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
+0000df90: 7570 0a20 2020 2020 2020 2069 6e73 7461  up.        insta
+0000dfa0: 6e63 6520 3d20 496e 6571 7561 6c69 7479  nce = Inequality
+0000dfb0: 286c 6f77 5f63 6f6c 756d 6e5f 6e61 6d65  (low_column_name
+0000dfc0: 3d27 6127 2c20 6869 6768 5f63 6f6c 756d  ='a', high_colum
+0000dfd0: 6e5f 6e61 6d65 3d27 6227 290a 2020 2020  n_name='b').    
+0000dfe0: 2020 2020 696e 7374 616e 6365 2e5f 6474      instance._dt
+0000dff0: 7970 6520 3d20 6e70 2e64 7479 7065 2827  ype = np.dtype('
+0000e000: 3c4d 385b 6e73 5d27 290a 2020 2020 2020  <M8[ns]').      
+0000e010: 2020 696e 7374 616e 6365 2e5f 6469 6666    instance._diff
+0000e020: 5f63 6f6c 756d 6e5f 6e61 6d65 203d 2027  _column_name = '
+0000e030: 6123 6227 0a20 2020 2020 2020 2069 6e73  a#b'.        ins
+0000e040: 7461 6e63 652e 5f69 735f 6461 7465 7469  tance._is_dateti
+0000e050: 6d65 203d 2054 7275 650a 0a20 2020 2020  me = True..     
+0000e060: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
+0000e070: 2074 7261 6e73 666f 726d 6564 203d 2070   transformed = p
+0000e080: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
+0000e090: 2020 2020 2020 2020 2020 2761 273a 2070            'a': p
+0000e0a0: 642e 746f 5f64 6174 6574 696d 6528 5b27  d.to_datetime(['
+0000e0b0: 3230 3230 2d30 312d 3031 5430 303a 3030  2020-01-01T00:00
+0000e0c0: 3a30 3027 2c20 2732 3032 302d 3031 2d30  :00', '2020-01-0
+0000e0d0: 3254 3030 3a30 303a 3030 275d 292c 0a20  2T00:00:00']),. 
+0000e0e0: 2020 2020 2020 2020 2020 2027 6327 3a20             'c': 
+0000e0f0: 5b31 2c20 325d 2c0a 2020 2020 2020 2020  [1, 2],.        
+0000e100: 2020 2020 2761 2362 273a 205b 6e70 2e6c      'a#b': [np.l
+0000e110: 6f67 2831 5f30 3030 5f30 3030 5f30 3031  og(1_000_000_001
+0000e120: 292c 206e 702e 6c6f 6728 315f 3030 305f  ), np.log(1_000_
+0000e130: 3030 305f 3030 3129 5d2c 0a20 2020 2020  000_001)],.     
+0000e140: 2020 207d 290a 2020 2020 2020 2020 6f75     }).        ou
+0000e150: 7420 3d20 696e 7374 616e 6365 2e72 6576  t = instance.rev
+0000e160: 6572 7365 5f74 7261 6e73 666f 726d 2874  erse_transform(t
+0000e170: 7261 6e73 666f 726d 6564 290a 0a20 2020  ransformed)..   
+0000e180: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
+0000e190: 2020 2020 2020 6578 7065 6374 6564 5f6f        expected_o
+0000e1a0: 7574 203d 2070 642e 4461 7461 4672 616d  ut = pd.DataFram
+0000e1b0: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
+0000e1c0: 2761 273a 2070 642e 746f 5f64 6174 6574  'a': pd.to_datet
+0000e1d0: 696d 6528 5b27 3230 3230 2d30 312d 3031  ime(['2020-01-01
+0000e1e0: 5430 303a 3030 3a30 3027 2c20 2732 3032  T00:00:00', '202
+0000e1f0: 302d 3031 2d30 3254 3030 3a30 303a 3030  0-01-02T00:00:00
+0000e200: 275d 292c 0a20 2020 2020 2020 2020 2020  ']),.           
+0000e210: 2027 6327 3a20 5b31 2c20 325d 2c0a 2020   'c': [1, 2],.  
+0000e220: 2020 2020 2020 2020 2020 2762 273a 2070            'b': p
+0000e230: 642e 746f 5f64 6174 6574 696d 6528 5b27  d.to_datetime(['
+0000e240: 3230 3230 2d30 312d 3031 5430 303a 3030  2020-01-01T00:00
+0000e250: 3a30 3127 2c20 2732 3032 302d 3031 2d30  :01', '2020-01-0
+0000e260: 3254 3030 3a30 303a 3031 275d 290a 2020  2T00:00:01']).  
+0000e270: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
+0000e280: 2070 642e 7465 7374 696e 672e 6173 7365   pd.testing.asse
+0000e290: 7274 5f66 7261 6d65 5f65 7175 616c 286f  rt_frame_equal(o
+0000e2a0: 7574 2c20 6578 7065 6374 6564 5f6f 7574  ut, expected_out
+0000e2b0: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+0000e2c0: 7265 7665 7273 655f 7472 616e 7366 6f72  reverse_transfor
+0000e2d0: 6d5f 6461 7465 7469 6d65 5f64 7479 7065  m_datetime_dtype
+0000e2e0: 5f69 735f 6f62 6a65 6374 2873 656c 6629  _is_object(self)
+0000e2f0: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
+0000e300: 7420 7468 6520 6060 496e 6571 7561 6c69  t the ``Inequali
+0000e310: 7479 2e72 6576 6572 7365 5f74 7261 6e73  ty.reverse_trans
+0000e320: 666f 726d 6060 206d 6574 686f 642e 0a0a  form`` method...
+0000e330: 2020 2020 2020 2020 5468 6973 2073 686f          This sho
+0000e340: 756c 6420 6361 7374 2074 6865 2060 606c  uld cast the ``l
+0000e350: 6f77 6060 2063 6f6c 756d 6e20 746f 2060  ow`` column to `
+0000e360: 6064 6174 6574 696d 6560 6020 7768 656e  `datetime`` when
+0000e370: 2074 6865 2060 6064 7479 7065 6060 2069   the ``dtype`` i
+0000e380: 730a 2020 2020 2020 2020 6f62 6a65 6374  s.        object
+0000e390: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000e3a0: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
+0000e3b0: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
+0000e3c0: 2049 6e65 7175 616c 6974 7928 6c6f 775f   Inequality(low_
+0000e3d0: 636f 6c75 6d6e 5f6e 616d 653d 2761 272c  column_name='a',
+0000e3e0: 2068 6967 685f 636f 6c75 6d6e 5f6e 616d   high_column_nam
+0000e3f0: 653d 2762 2729 0a20 2020 2020 2020 2069  e='b').        i
+0000e400: 6e73 7461 6e63 652e 5f64 7479 7065 203d  nstance._dtype =
+0000e410: 206e 702e 6474 7970 6528 274f 2729 0a20   np.dtype('O'). 
+0000e420: 2020 2020 2020 2069 6e73 7461 6e63 652e         instance.
+0000e430: 5f64 6966 665f 636f 6c75 6d6e 5f6e 616d  _diff_column_nam
+0000e440: 6520 3d20 2761 2362 270a 2020 2020 2020  e = 'a#b'.      
+0000e450: 2020 696e 7374 616e 6365 2e5f 6973 5f64    instance._is_d
+0000e460: 6174 6574 696d 6520 3d20 5472 7565 0a0a  atetime = True..
+0000e470: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
+0000e480: 2020 2020 2020 7472 616e 7366 6f72 6d65        transforme
+0000e490: 6420 3d20 7064 2e44 6174 6146 7261 6d65  d = pd.DataFrame
+0000e4a0: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
+0000e4b0: 6127 3a20 5b27 3230 3230 2d30 312d 3031  a': ['2020-01-01
+0000e4c0: 5430 303a 3030 3a30 3027 2c20 2732 3032  T00:00:00', '202
+0000e4d0: 302d 3031 2d30 3254 3030 3a30 303a 3030  0-01-02T00:00:00
+0000e4e0: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
+0000e4f0: 2763 273a 205b 312c 2032 5d2c 0a20 2020  'c': [1, 2],.   
+0000e500: 2020 2020 2020 2020 2027 6123 6227 3a20           'a#b': 
+0000e510: 5b6e 702e 6c6f 6728 315f 3030 305f 3030  [np.log(1_000_00
+0000e520: 305f 3030 3129 2c20 6e70 2e6c 6f67 2831  0_001), np.log(1
+0000e530: 5f30 3030 5f30 3030 5f30 3031 295d 2c0a  _000_000_001)],.
+0000e540: 2020 2020 2020 2020 7d29 0a20 2020 2020          }).     
+0000e550: 2020 206f 7574 203d 2069 6e73 7461 6e63     out = instanc
+0000e560: 652e 7265 7665 7273 655f 7472 616e 7366  e.reverse_transf
+0000e570: 6f72 6d28 7472 616e 7366 6f72 6d65 6429  orm(transformed)
+0000e580: 0a0a 2020 2020 2020 2020 2320 4173 7365  ..        # Asse
+0000e590: 7274 0a20 2020 2020 2020 2065 7870 6563  rt.        expec
+0000e5a0: 7465 645f 6f75 7420 3d20 7064 2e44 6174  ted_out = pd.Dat
+0000e5b0: 6146 7261 6d65 287b 0a20 2020 2020 2020  aFrame({.       
+0000e5c0: 2020 2020 2027 6127 3a20 5b27 3230 3230       'a': ['2020
+0000e5d0: 2d30 312d 3031 5430 303a 3030 3a30 3027  -01-01T00:00:00'
+0000e5e0: 2c20 2732 3032 302d 3031 2d30 3254 3030  , '2020-01-02T00
+0000e5f0: 3a30 303a 3030 275d 2c0a 2020 2020 2020  :00:00'],.      
+0000e600: 2020 2020 2020 2763 273a 205b 312c 2032        'c': [1, 2
+0000e610: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
+0000e620: 6227 3a20 5b70 642e 5469 6d65 7374 616d  b': [pd.Timestam
+0000e630: 7028 2732 3032 302d 3031 2d30 3120 3030  p('2020-01-01 00
+0000e640: 3a30 303a 3031 2729 2c20 7064 2e54 696d  :00:01'), pd.Tim
+0000e650: 6573 7461 6d70 2827 3230 3230 2d30 312d  estamp('2020-01-
+0000e660: 3032 2030 303a 3030 3a30 3127 295d 0a20  02 00:00:01')]. 
+0000e670: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
+0000e680: 2020 6578 7065 6374 6564 5f6f 7574 5b27    expected_out['
+0000e690: 6227 5d20 3d20 6578 7065 6374 6564 5f6f  b'] = expected_o
+0000e6a0: 7574 5b27 6227 5d2e 6173 7479 7065 286e  ut['b'].astype(n
+0000e6b0: 702e 6474 7970 6528 274f 2729 290a 2020  p.dtype('O')).  
+0000e6c0: 2020 2020 2020 7064 2e74 6573 7469 6e67        pd.testing
+0000e6d0: 2e61 7373 6572 745f 6672 616d 655f 6571  .assert_frame_eq
+0000e6e0: 7561 6c28 6f75 742c 2065 7870 6563 7465  ual(out, expecte
+0000e6f0: 645f 6f75 7429 0a0a 0a63 6c61 7373 2054  d_out)...class T
+0000e700: 6573 7453 6361 6c61 7249 6e65 7175 616c  estScalarInequal
+0000e710: 6974 7928 293a 0a0a 2020 2020 6465 6620  ity():..    def 
+0000e720: 7465 7374 5f5f 7661 6c69 6461 7465 5f69  test__validate_i
+0000e730: 6e70 7574 7328 7365 6c66 293a 0a20 2020  nputs(self):.   
+0000e740: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+0000e750: 2060 6053 6361 6c61 7249 6e65 7175 616c   ``ScalarInequal
+0000e760: 6974 792e 5f76 616c 6964 6174 655f 696e  ity._validate_in
+0000e770: 7075 7473 6060 206d 6574 686f 642e 0a0a  puts`` method...
+0000e780: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
+0000e790: 2020 2020 2020 202d 2020 496e 636f 7272         -  Incorr
+0000e7a0: 6563 7420 7061 7261 6d65 7465 7273 2066  ect parameters f
+0000e7b0: 6f72 2074 6865 206d 6574 686f 640a 2020  or the method.  
+0000e7c0: 2020 2020 2020 5261 6973 6573 3a0a 2020        Raises:.  
+0000e7d0: 2020 2020 2020 2d20 4c69 7374 206f 6620        - List of 
+0000e7e0: 5661 6c75 6545 7272 6f72 730a 2020 2020  ValueErrors.    
+0000e7f0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000e800: 2320 5275 6e20 2f20 4173 7365 7274 0a20  # Run / Assert. 
+0000e810: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
+0000e820: 7374 2e72 6169 7365 7328 4167 6772 6567  st.raises(Aggreg
+0000e830: 6174 6543 6f6e 7374 7261 696e 7473 4572  ateConstraintsEr
+0000e840: 726f 7229 2061 7320 6572 726f 723a 0a20  ror) as error:. 
+0000e850: 2020 2020 2020 2020 2020 2053 6361 6c61             Scala
+0000e860: 7249 6e65 7175 616c 6974 792e 5f76 616c  rInequality._val
+0000e870: 6964 6174 655f 696e 7075 7473 280a 2020  idate_inputs(.  
+0000e880: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
+0000e890: 745f 6869 6768 5f63 6f6c 756d 6e3d 4e6f  t_high_column=No
+0000e8a0: 6e65 2c20 6e6f 745f 6c6f 775f 636f 6c75  ne, not_low_colu
+0000e8b0: 6d6e 3d4e 6f6e 652c 2072 656c 6174 696f  mn=None, relatio
+0000e8c0: 6e3d 272b 2729 0a0a 2020 2020 2020 2020  n='+')..        
+0000e8d0: 6572 725f 6d73 6720 3d20 280a 2020 2020  err_msg = (.    
+0000e8e0: 2020 2020 2020 2020 7227 4d69 7373 696e          r'Missin
+0000e8f0: 6720 7265 7175 6972 6564 2076 616c 7565  g required value
+0000e900: 7320 7b28 2e2a 297d 2069 6e20 6120 5363  s {(.*)} in a Sc
+0000e910: 616c 6172 496e 6571 7561 6c69 7479 2063  alarInequality c
+0000e920: 6f6e 7374 7261 696e 742e 270a 2020 2020  onstraint.'.    
+0000e930: 2020 2020 2020 2020 7227 5c6e 5c6e 496e          r'\n\nIn
+0000e940: 7661 6c69 6420 7661 6c75 6573 207b 282e  valid values {(.
+0000e950: 2a29 7d20 6172 6520 7072 6573 656e 7420  *)} are present 
+0000e960: 696e 2061 2053 6361 6c61 7249 6e65 7175  in a ScalarInequ
+0000e970: 616c 6974 7920 636f 6e73 7472 6169 6e74  ality constraint
+0000e980: 2e27 0a20 2020 2020 2020 2020 2020 2072  .'.            r
+0000e990: 275c 6e5c 6e49 6e76 616c 6964 2072 656c  '\n\nInvalid rel
+0000e9a0: 6174 696f 6e20 7661 6c75 6520 7b28 2e2a  ation value {(.*
+0000e9b0: 297d 2069 6e20 6120 5363 616c 6172 496e  )} in a ScalarIn
+0000e9c0: 6571 7561 6c69 7479 2063 6f6e 7374 7261  equality constra
+0000e9d0: 696e 742e 270a 2020 2020 2020 2020 2020  int.'.          
+0000e9e0: 2020 2220 5468 6520 7265 6c61 7469 6f6e    " The relation
+0000e9f0: 206d 7573 7420 6265 206f 6e65 206f 663a   must be one of:
+0000ea00: 2027 3e27 2c20 273e 3d27 2c20 273c 2720   '>', '>=', '<' 
+0000ea10: 6f72 2027 3c3d 272e 220a 2020 2020 2020  or '<='.".      
+0000ea20: 2020 290a 2020 2020 2020 2020 6772 6f75    ).        grou
+0000ea30: 7073 203d 2072 652e 7365 6172 6368 2865  ps = re.search(e
+0000ea40: 7272 5f6d 7367 2c20 7374 7228 6572 726f  rr_msg, str(erro
+0000ea50: 722e 7661 6c75 6529 290a 2020 2020 2020  r.value)).      
+0000ea60: 2020 6173 7365 7274 2067 726f 7570 7320    assert groups 
+0000ea70: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
+0000ea80: 2020 2020 6173 7365 7274 2073 6574 2865      assert set(e
+0000ea90: 7661 6c28 6772 6f75 7073 2e67 726f 7570  val(groups.group
+0000eaa0: 2831 2929 2920 3d3d 207b 2763 6f6c 756d  (1))) == {'colum
+0000eab0: 6e5f 6e61 6d65 272c 2027 7661 6c75 6527  n_name', 'value'
+0000eac0: 7d0a 2020 2020 2020 2020 6173 7365 7274  }.        assert
+0000ead0: 2073 6574 2865 7661 6c28 6772 6f75 7073   set(eval(groups
+0000eae0: 2e67 726f 7570 2832 2929 2920 3d3d 207b  .group(2))) == {
+0000eaf0: 276e 6f74 5f68 6967 685f 636f 6c75 6d6e  'not_high_column
+0000eb00: 272c 2027 6e6f 745f 6c6f 775f 636f 6c75  ', 'not_low_colu
+0000eb10: 6d6e 277d 0a20 2020 2020 2020 2061 7373  mn'}.        ass
+0000eb20: 6572 7420 7374 7228 6576 616c 2867 726f  ert str(eval(gro
+0000eb30: 7570 732e 6772 6f75 7028 3329 2929 203d  ups.group(3))) =
+0000eb40: 3d20 272b 270a 0a20 2020 2064 6566 2074  = '+'..    def t
+0000eb50: 6573 745f 5f76 616c 6964 6174 655f 6d65  est__validate_me
+0000eb60: 7461 6461 7461 5f63 6f6c 756d 6e73 2873  tadata_columns(s
+0000eb70: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+0000eb80: 2254 6573 7420 7468 6520 6060 5f76 616c  "Test the ``_val
+0000eb90: 6964 6174 655f 6d65 7461 6461 7461 5f63  idate_metadata_c
+0000eba0: 6f6c 756d 6e73 6060 206d 6574 686f 642e  olumns`` method.
+0000ebb0: 0a0a 2020 2020 2020 2020 416c 6c20 6f66  ..        All of
+0000ebc0: 2074 6865 2063 6f6c 756d 6e73 2070 6173   the columns pas
+0000ebd0: 7365 6420 696e 2063 6f6c 756d 6e5f 6e61  sed in column_na
+0000ebe0: 6d65 7320 7368 6f75 6c64 2062 6520 696e  mes should be in
+0000ebf0: 2074 6865 206d 6574 6164 6174 612e 0a0a   the metadata...
+0000ec00: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
+0000ec10: 2020 2020 2020 2020 2020 202d 2063 6f6c             - col
+0000ec20: 756d 6e5f 6e61 6d65 2077 6974 6820 636f  umn_name with co
+0000ec30: 6c75 6d6e 2074 6861 7420 6973 2069 6e20  lumn that is in 
+0000ec40: 7468 6520 6d65 7461 6461 7461 2e0a 0a20  the metadata... 
+0000ec50: 2020 2020 2020 2053 6964 6520 6566 6665         Side effe
+0000ec60: 6374 3a0a 2020 2020 2020 2020 2020 2020  ct:.            
+0000ec70: 2d20 4e6f 2065 7272 6f72 2073 686f 756c  - No error shoul
+0000ec80: 6420 6265 2072 6169 7365 642e 0a20 2020  d be raised..   
+0000ec90: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000eca0: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
+0000ecb0: 206d 6574 6164 6174 6120 3d20 4d6f 636b   metadata = Mock
+0000ecc0: 2829 0a20 2020 2020 2020 206d 6574 6164  ().        metad
+0000ecd0: 6174 612e 636f 6c75 6d6e 7320 3d20 7b27  ata.columns = {'
+0000ece0: 6127 3a20 312c 2027 6227 3a20 327d 0a0a  a': 1, 'b': 2}..
+0000ecf0: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
+0000ed00: 2020 2020 2020 5363 616c 6172 496e 6571        ScalarIneq
+0000ed10: 7561 6c69 7479 2e5f 7661 6c69 6461 7465  uality._validate
+0000ed20: 5f6d 6574 6164 6174 615f 636f 6c75 6d6e  _metadata_column
+0000ed30: 7328 6d65 7461 6461 7461 2c20 636f 6c75  s(metadata, colu
+0000ed40: 6d6e 5f6e 616d 653d 2761 2729 0a0a 2020  mn_name='a')..  
+0000ed50: 2020 6465 6620 7465 7374 5f5f 7661 6c69    def test__vali
+0000ed60: 6461 7465 5f6d 6574 6164 6174 615f 636f  date_metadata_co
+0000ed70: 6c75 6d6e 735f 7261 6973 6573 5f65 7272  lumns_raises_err
+0000ed80: 6f72 2873 656c 6629 3a0a 2020 2020 2020  or(self):.      
+0000ed90: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
+0000eda0: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
+0000edb0: 7461 5f63 6f6c 756d 6e73 6060 206d 6574  ta_columns`` met
+0000edc0: 686f 6427 7320 6572 726f 7220 636f 6e64  hod's error cond
+0000edd0: 6974 696f 6e2e 0a0a 2020 2020 2020 2020  ition...        
+0000ede0: 4966 2074 6865 2063 6f6c 756d 6e5f 6e61  If the column_na
+0000edf0: 6d65 2069 7320 6e6f 7420 696e 2074 6865  me is not in the
+0000ee00: 206d 6574 6164 6174 612c 2061 6e20 6572   metadata, an er
+0000ee10: 726f 7220 7368 6f75 6c64 2062 6520 7261  ror should be ra
+0000ee20: 6973 6564 2e0a 0a20 2020 2020 2020 2049  ised...        I
+0000ee30: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
+0000ee40: 2020 2d20 636f 6c75 6d6e 5f6e 616d 6520    - column_name 
+0000ee50: 7468 6174 2069 7320 6e6f 7420 696e 2074  that is not in t
+0000ee60: 6865 206d 6574 6164 6174 612e 0a0a 2020  he metadata...  
+0000ee70: 2020 2020 2020 5369 6465 2065 6666 6563        Side effec
+0000ee80: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
+0000ee90: 2043 6f6e 7374 7261 696e 744d 6574 6164   ConstraintMetad
+0000eea0: 6174 6145 7272 6f72 2073 686f 756c 6420  ataError should 
+0000eeb0: 6265 2072 6169 7365 642e 0a20 2020 2020  be raised..     
+0000eec0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+0000eed0: 2053 6574 7570 0a20 2020 2020 2020 206d   Setup.        m
+0000eee0: 6574 6164 6174 6120 3d20 4d6f 636b 2829  etadata = Mock()
+0000eef0: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+0000ef00: 612e 636f 6c75 6d6e 7320 3d20 7b27 6127  a.columns = {'a'
+0000ef10: 3a20 312c 2027 6227 3a20 327d 0a0a 2020  : 1, 'b': 2}..  
+0000ef20: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+0000ef30: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+0000ef40: 6520 3d20 7265 2e65 7363 6170 6528 0a20  e = re.escape(. 
+0000ef50: 2020 2020 2020 2020 2020 2027 4120 5363             'A Sc
+0000ef60: 616c 6172 496e 6571 7561 6c69 7479 2063  alarInequality c
+0000ef70: 6f6e 7374 7261 696e 7420 6973 2062 6569  onstraint is bei
+0000ef80: 6e67 2061 7070 6c69 6564 2074 6f20 696e  ng applied to in
+0000ef90: 7661 6c69 6420 636f 6c75 6d6e 206e 616d  valid column nam
+0000efa0: 6573 2027 0a20 2020 2020 2020 2020 2020  es '.           
+0000efb0: 2022 7b27 6327 7d2e 2054 6865 2063 6f6c   "{'c'}. The col
+0000efc0: 756d 6e73 206d 7573 7420 6578 6973 7420  umns must exist 
+0000efd0: 696e 2074 6865 2074 6162 6c65 2e22 0a20  in the table.". 
+0000efe0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000eff0: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
+0000f000: 7365 7328 436f 6e73 7472 6169 6e74 4d65  ses(ConstraintMe
+0000f010: 7461 6461 7461 4572 726f 722c 206d 6174  tadataError, mat
+0000f020: 6368 3d65 7272 6f72 5f6d 6573 7361 6765  ch=error_message
+0000f030: 293a 0a20 2020 2020 2020 2020 2020 2053  ):.            S
+0000f040: 6361 6c61 7249 6e65 7175 616c 6974 792e  calarInequality.
+0000f050: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
+0000f060: 7461 5f63 6f6c 756d 6e73 286d 6574 6164  ta_columns(metad
+0000f070: 6174 612c 2063 6f6c 756d 6e5f 6e61 6d65  ata, column_name
+0000f080: 3d27 6327 290a 0a20 2020 2064 6566 2074  ='c')..    def t
+0000f090: 6573 745f 5f76 616c 6964 6174 655f 6d65  est__validate_me
+0000f0a0: 7461 6461 7461 5f73 7065 6369 6669 635f  tadata_specific_
+0000f0b0: 746f 5f63 6f6e 7374 7261 696e 745f 6e75  to_constraint_nu
+0000f0c0: 6d65 7269 6361 6c28 7365 6c66 293a 0a20  merical(self):. 
+0000f0d0: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
+0000f0e0: 6865 2060 605f 7661 6c69 6461 7465 5f6d  he ``_validate_m
+0000f0f0: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
+0000f100: 5f74 6f5f 636f 6e73 7472 6169 6e74 6060  _to_constraint``
+0000f110: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
+0000f120: 2020 4966 2074 6865 2063 6f6c 756d 6e5f    If the column_
+0000f130: 6e61 6d65 2068 6173 2061 6e20 7364 7479  name has an sdty
+0000f140: 7065 206f 6620 6e75 6d65 7269 6361 6c2c  pe of numerical,
+0000f150: 2061 6e64 2074 6865 2076 616c 7565 0a20   and the value. 
+0000f160: 2020 2020 2020 2069 7320 616e 2069 6e74         is an int
+0000f170: 206f 7220 666c 6f61 742c 2074 6865 6e20   or float, then 
+0000f180: 6e6f 2065 7272 6f72 2073 686f 756c 6420  no error should 
+0000f190: 6265 2072 6169 7365 642e 0a0a 2020 2020  be raised...    
+0000f1a0: 2020 2020 5365 7475 703a 0a20 2020 2020      Setup:.     
+0000f1b0: 2020 2020 2020 202d 204d 6574 6164 6174         - Metadat
+0000f1c0: 6120 7769 7468 2074 6865 2073 6474 7970  a with the sdtyp
+0000f1d0: 6520 7365 7420 746f 206e 756d 6572 6963  e set to numeric
+0000f1e0: 616c 2e0a 0a20 2020 2020 2020 2049 6e70  al...        Inp
+0000f1f0: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
+0000f200: 2d20 5468 6520 636f 6c75 6d6e 206e 616d  - The column nam
+0000f210: 6520 616e 6420 6120 7661 6c75 6520 7365  e and a value se
+0000f220: 7420 746f 2061 206e 756d 6265 722e 0a20  t to a number.. 
+0000f230: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000f240: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
+0000f250: 2020 206d 6574 6164 6174 6120 3d20 4d6f     metadata = Mo
+0000f260: 636b 2829 0a20 2020 2020 2020 206d 6574  ck().        met
+0000f270: 6164 6174 612e 636f 6c75 6d6e 7320 3d20  adata.columns = 
+0000f280: 7b27 6127 3a20 7b27 7364 7479 7065 273a  {'a': {'sdtype':
+0000f290: 2027 6e75 6d65 7269 6361 6c27 7d7d 0a0a   'numerical'}}..
+0000f2a0: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
+0000f2b0: 2020 2020 2020 5363 616c 6172 496e 6571        ScalarIneq
+0000f2c0: 7561 6c69 7479 2e5f 7661 6c69 6461 7465  uality._validate
+0000f2d0: 5f6d 6574 6164 6174 615f 7370 6563 6966  _metadata_specif
+0000f2e0: 6963 5f74 6f5f 636f 6e73 7472 6169 6e74  ic_to_constraint
+0000f2f0: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
+0000f300: 7461 6461 7461 2c0a 2020 2020 2020 2020  tadata,.        
+0000f310: 2020 2020 636f 6c75 6d6e 5f6e 616d 653d      column_name=
+0000f320: 2761 272c 0a20 2020 2020 2020 2020 2020  'a',.           
+0000f330: 2072 656c 6174 696f 6e3d 273e 272c 0a20   relation='>',. 
+0000f340: 2020 2020 2020 2020 2020 2076 616c 7565             value
+0000f350: 3d37 0a20 2020 2020 2020 2029 0a0a 2020  =7.        )..  
+0000f360: 2020 6465 6620 7465 7374 5f5f 7661 6c69    def test__vali
+0000f370: 6461 7465 5f6d 6574 6164 6174 615f 7370  date_metadata_sp
+0000f380: 6563 6966 6963 5f74 6f5f 636f 6e73 7472  ecific_to_constr
+0000f390: 6169 6e74 5f6e 756d 6572 6963 616c 5f65  aint_numerical_e
+0000f3a0: 7272 6f72 2873 656c 6629 3a0a 2020 2020  rror(self):.    
+0000f3b0: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
+0000f3c0: 6060 5f76 616c 6964 6174 655f 6d65 7461  ``_validate_meta
+0000f3d0: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
+0000f3e0: 5f63 6f6e 7374 7261 696e 7460 6020 6d65  _constraint`` me
+0000f3f0: 7468 6f64 2e0a 0a20 2020 2020 2020 2049  thod...        I
+0000f400: 6620 7468 6520 636f 6c75 6d6e 5f6e 616d  f the column_nam
+0000f410: 6520 6861 7320 616e 2073 6474 7970 6520  e has an sdtype 
+0000f420: 6f66 206e 756d 6572 6963 616c 2c20 616e  of numerical, an
+0000f430: 6420 7468 6520 7661 6c75 650a 2020 2020  d the value.    
+0000f440: 2020 2020 6973 206e 6f74 2061 6e20 696e      is not an in
+0000f450: 7420 6f72 2066 6c6f 6174 2c20 7468 656e  t or float, then
+0000f460: 2061 6e20 6572 726f 7220 7368 6f75 6c64   an error should
+0000f470: 2062 6520 7261 6973 6564 2e0a 0a20 2020   be raised...   
+0000f480: 2020 2020 2053 6574 7570 3a0a 2020 2020       Setup:.    
+0000f490: 2020 2020 2020 2020 2d20 4d65 7461 6461          - Metada
+0000f4a0: 7461 2077 6974 6820 7468 6520 7364 7479  ta with the sdty
+0000f4b0: 7065 2073 6574 2074 6f20 6e75 6d65 7269  pe set to numeri
+0000f4c0: 6361 6c2e 0a0a 2020 2020 2020 2020 496e  cal...        In
+0000f4d0: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
+0000f4e0: 202d 2054 6865 2063 6f6c 756d 6e20 6e61   - The column na
+0000f4f0: 6d65 2061 6e64 2061 2076 616c 7565 2073  me and a value s
+0000f500: 6574 2074 6f20 6120 7374 7269 6e67 2e0a  et to a string..
+0000f510: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000f520: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
+0000f530: 2020 2020 6d65 7461 6461 7461 203d 204d      metadata = M
+0000f540: 6f63 6b28 290a 2020 2020 2020 2020 6d65  ock().        me
+0000f550: 7461 6461 7461 2e63 6f6c 756d 6e73 203d  tadata.columns =
+0000f560: 207b 2761 273a 207b 2773 6474 7970 6527   {'a': {'sdtype'
+0000f570: 3a20 276e 756d 6572 6963 616c 277d 7d0a  : 'numerical'}}.
+0000f580: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+0000f590: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+0000f5a0: 7361 6765 203d 2022 2776 616c 7565 2720  sage = "'value' 
+0000f5b0: 6d75 7374 2062 6520 616e 2069 6e74 206f  must be an int o
+0000f5c0: 7220 666c 6f61 742e 220a 2020 2020 2020  r float.".      
+0000f5d0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+0000f5e0: 6973 6573 2843 6f6e 7374 7261 696e 744d  ises(ConstraintM
+0000f5f0: 6574 6164 6174 6145 7272 6f72 2c20 6d61  etadataError, ma
+0000f600: 7463 683d 6572 726f 725f 6d65 7373 6167  tch=error_messag
+0000f610: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+0000f620: 5363 616c 6172 496e 6571 7561 6c69 7479  ScalarInequality
+0000f630: 2e5f 7661 6c69 6461 7465 5f6d 6574 6164  ._validate_metad
+0000f640: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
+0000f650: 636f 6e73 7472 6169 6e74 280a 2020 2020  constraint(.    
+0000f660: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+0000f670: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
+0000f680: 2020 2020 2020 636f 6c75 6d6e 5f6e 616d        column_nam
+0000f690: 653d 2761 272c 0a20 2020 2020 2020 2020  e='a',.         
+0000f6a0: 2020 2020 2020 2072 656c 6174 696f 6e3d         relation=
+0000f6b0: 273e 272c 0a20 2020 2020 2020 2020 2020  '>',.           
+0000f6c0: 2020 2020 2076 616c 7565 3d27 3727 0a20       value='7'. 
+0000f6d0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0000f6e0: 2020 4070 6174 6368 2827 7364 762e 636f    @patch('sdv.co
+0000f6f0: 6e73 7472 6169 6e74 732e 7461 6275 6c61  nstraints.tabula
+0000f700: 722e 6d61 7463 6865 735f 6461 7465 7469  r.matches_dateti
+0000f710: 6d65 5f66 6f72 6d61 7427 290a 2020 2020  me_format').    
+0000f720: 6465 6620 7465 7374 5f5f 7661 6c69 6461  def test__valida
+0000f730: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
+0000f740: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
+0000f750: 6e74 5f64 6174 6574 696d 6528 7365 6c66  nt_datetime(self
+0000f760: 2c20 6461 7465 7469 6d65 5f66 6f72 6d61  , datetime_forma
+0000f770: 745f 6d6f 636b 293a 0a20 2020 2020 2020  t_mock):.       
+0000f780: 2022 2222 5465 7374 2074 6865 2060 605f   """Test the ``_
+0000f790: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
+0000f7a0: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
+0000f7b0: 6e73 7472 6169 6e74 6060 206d 6574 686f  nstraint`` metho
+0000f7c0: 642e 0a0a 2020 2020 2020 2020 4966 2074  d...        If t
+0000f7d0: 6865 2063 6f6c 756d 6e5f 6e61 6d65 2068  he column_name h
+0000f7e0: 6173 2061 6e20 7364 7479 7065 206f 6620  as an sdtype of 
+0000f7f0: 6461 7465 7469 6d65 2c20 616e 6420 7468  datetime, and th
+0000f800: 6520 7661 6c75 650a 2020 2020 2020 2020  e value.        
+0000f810: 6973 2061 2064 6174 6574 696d 6520 7374  is a datetime st
+0000f820: 7269 6e67 2074 6861 7420 6d61 7463 6865  ring that matche
+0000f830: 7320 7468 6520 666f 726d 6174 2c20 7468  s the format, th
+0000f840: 656e 206e 6f20 6572 726f 7220 7368 6f75  en no error shou
+0000f850: 6c64 2062 6520 7261 6973 6564 2e0a 0a20  ld be raised... 
+0000f860: 2020 2020 2020 2053 6574 7570 3a0a 2020         Setup:.  
+0000f870: 2020 2020 2020 2020 2020 2d20 4d65 7461            - Meta
+0000f880: 6461 7461 2077 6974 6820 7468 6520 7364  data with the sd
+0000f890: 7479 7065 2073 6574 2074 6f20 6461 7465  type set to date
+0000f8a0: 7469 6d65 2061 6e64 2061 2064 6174 6574  time and a datet
+0000f8b0: 696d 655f 666f 726d 6174 2e0a 2020 2020  ime_format..    
+0000f8c0: 2020 2020 2020 2020 2d20 4d6f 636b 2074          - Mock t
+0000f8d0: 6865 2060 606d 6174 6368 6573 5f64 6174  he ``matches_dat
+0000f8e0: 6574 696d 655f 666f 726d 6174 6060 2066  etime_format`` f
+0000f8f0: 756e 6374 696f 6e20 746f 2072 6574 7572  unction to retur
+0000f900: 6e20 5472 7565 2e0a 0a20 2020 2020 2020  n True...       
+0000f910: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
+0000f920: 2020 2020 2d20 5468 6520 636f 6c75 6d6e      - The column
+0000f930: 206e 616d 6520 616e 6420 6120 7661 6c75   name and a valu
+0000f940: 6520 7365 7420 746f 2061 2064 6174 6574  e set to a datet
+0000f950: 696d 6520 6f66 2074 6865 2072 6967 6874  ime of the right
+0000f960: 2066 6f72 6d61 742e 0a20 2020 2020 2020   format..       
+0000f970: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
+0000f980: 6574 7570 0a20 2020 2020 2020 206d 6574  etup.        met
+0000f990: 6164 6174 6120 3d20 4d6f 636b 2829 0a20  adata = Mock(). 
+0000f9a0: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
+0000f9b0: 636f 6c75 6d6e 7320 3d20 7b27 6127 3a20  columns = {'a': 
+0000f9c0: 7b27 7364 7479 7065 273a 2027 6461 7465  {'sdtype': 'date
+0000f9d0: 7469 6d65 272c 2027 6461 7465 7469 6d65  time', 'datetime
+0000f9e0: 5f66 6f72 6d61 7427 3a20 276d 2f64 2f79  _format': 'm/d/y
+0000f9f0: 277d 7d0a 2020 2020 2020 2020 6461 7465  '}}.        date
+0000fa00: 7469 6d65 5f66 6f72 6d61 745f 6d6f 636b  time_format_mock
+0000fa10: 2e72 6574 7572 6e5f 7661 6c75 6520 3d20  .return_value = 
+0000fa20: 5472 7565 0a0a 2020 2020 2020 2020 2320  True..        # 
+0000fa30: 5275 6e0a 2020 2020 2020 2020 5363 616c  Run.        Scal
+0000fa40: 6172 496e 6571 7561 6c69 7479 2e5f 7661  arInequality._va
+0000fa50: 6c69 6461 7465 5f6d 6574 6164 6174 615f  lidate_metadata_
+0000fa60: 7370 6563 6966 6963 5f74 6f5f 636f 6e73  specific_to_cons
+0000fa70: 7472 6169 6e74 280a 2020 2020 2020 2020  traint(.        
+0000fa80: 2020 2020 6d65 7461 6461 7461 2c0a 2020      metadata,.  
+0000fa90: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+0000faa0: 5f6e 616d 653d 2761 272c 0a20 2020 2020  _name='a',.     
+0000fab0: 2020 2020 2020 2072 656c 6174 696f 6e3d         relation=
+0000fac0: 273e 272c 0a20 2020 2020 2020 2020 2020  '>',.           
+0000fad0: 2076 616c 7565 3d27 312f 312f 3230 3230   value='1/1/2020
+0000fae0: 270a 2020 2020 2020 2020 290a 0a20 2020  '.        )..   
+0000faf0: 2040 7061 7463 6828 2773 6476 2e63 6f6e   @patch('sdv.con
+0000fb00: 7374 7261 696e 7473 2e74 6162 756c 6172  straints.tabular
+0000fb10: 2e6d 6174 6368 6573 5f64 6174 6574 696d  .matches_datetim
+0000fb20: 655f 666f 726d 6174 2729 0a20 2020 2064  e_format').    d
+0000fb30: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
+0000fb40: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+0000fb50: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+0000fb60: 745f 6461 7465 7469 6d65 5f65 7272 6f72  t_datetime_error
+0000fb70: 2873 656c 662c 2064 6174 6574 696d 655f  (self, datetime_
+0000fb80: 666f 726d 6174 5f6d 6f63 6b29 3a0a 2020  format_mock):.  
+0000fb90: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
+0000fba0: 6520 6060 5f76 616c 6964 6174 655f 6d65  e ``_validate_me
+0000fbb0: 7461 6461 7461 5f73 7065 6369 6669 635f  tadata_specific_
+0000fbc0: 746f 5f63 6f6e 7374 7261 696e 7460 6020  to_constraint`` 
+0000fbd0: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
+0000fbe0: 2049 6620 7468 6520 636f 6c75 6d6e 5f6e   If the column_n
+0000fbf0: 616d 6520 6861 7320 616e 2073 6474 7970  ame has an sdtyp
+0000fc00: 6520 6f66 2064 6174 6574 696d 652c 2061  e of datetime, a
+0000fc10: 6e64 2074 6865 2076 616c 7565 0a20 2020  nd the value.   
+0000fc20: 2020 2020 2069 7320 6120 6461 7465 7469       is a dateti
+0000fc30: 6d65 2073 7472 696e 6720 7468 6174 2064  me string that d
+0000fc40: 6f65 736e 2774 206d 6174 6368 2074 6865  oesn't match the
+0000fc50: 2066 6f72 6d61 742c 2074 6865 6e20 616e   format, then an
+0000fc60: 2065 7272 6f72 2073 686f 756c 6420 6265   error should be
+0000fc70: 2072 6169 7365 642e 0a0a 2020 2020 2020   raised...      
+0000fc80: 2020 5365 7475 703a 0a20 2020 2020 2020    Setup:.       
+0000fc90: 2020 2020 202d 204d 6574 6164 6174 6120       - Metadata 
+0000fca0: 7769 7468 2074 6865 2073 6474 7970 6520  with the sdtype 
+0000fcb0: 7365 7420 746f 2064 6174 6574 696d 6520  set to datetime 
+0000fcc0: 616e 6420 6120 6461 7465 7469 6d65 5f66  and a datetime_f
+0000fcd0: 6f72 6d61 742e 0a20 2020 2020 2020 2020  ormat..         
+0000fce0: 2020 202d 204d 6f63 6b20 7468 6520 6060     - Mock the ``
+0000fcf0: 6d61 7463 6865 735f 6461 7465 7469 6d65  matches_datetime
+0000fd00: 5f66 6f72 6d61 7460 6020 6675 6e63 7469  _format`` functi
+0000fd10: 6f6e 2074 6f20 7265 7475 726e 2046 616c  on to return Fal
+0000fd20: 7365 2e0a 0a20 2020 2020 2020 2049 6e70  se...        Inp
+0000fd30: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
+0000fd40: 2d20 5468 6520 636f 6c75 6d6e 206e 616d  - The column nam
+0000fd50: 6520 616e 6420 6120 7661 6c75 6520 7365  e and a value se
+0000fd60: 7420 746f 2061 2064 6174 6574 696d 6520  t to a datetime 
+0000fd70: 6f66 2074 6865 2077 726f 6e67 2066 6f72  of the wrong for
+0000fd80: 6d61 742e 0a0a 2020 2020 2020 2020 5369  mat...        Si
+0000fd90: 6465 2065 6666 6563 743a 0a20 2020 2020  de effect:.     
+0000fda0: 2020 2020 2020 202d 2041 2043 6f6e 7374         - A Const
+0000fdb0: 7261 696e 744d 6574 6164 6174 6145 7272  raintMetadataErr
+0000fdc0: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
+0000fdd0: 7365 642e 0a20 2020 2020 2020 2022 2222  sed..        """
+0000fde0: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+0000fdf0: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+0000fe00: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
+0000fe10: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
+0000fe20: 6d6e 7320 3d20 7b27 6127 3a20 7b27 7364  mns = {'a': {'sd
+0000fe30: 7479 7065 273a 2027 6461 7465 7469 6d65  type': 'datetime
+0000fe40: 272c 2027 6461 7465 7469 6d65 5f66 6f72  ', 'datetime_for
+0000fe50: 6d61 7427 3a20 276d 2f64 2f79 277d 7d0a  mat': 'm/d/y'}}.
+0000fe60: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
+0000fe70: 5f66 6f72 6d61 745f 6d6f 636b 2e72 6574  _format_mock.ret
+0000fe80: 7572 6e5f 7661 6c75 6520 3d20 4661 6c73  urn_value = Fals
+0000fe90: 650a 0a20 2020 2020 2020 2023 2052 756e  e..        # Run
+0000fea0: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
+0000feb0: 6573 7361 6765 203d 2022 2776 616c 7565  essage = "'value
+0000fec0: 2720 6d75 7374 2062 6520 6120 6461 7465  ' must be a date
+0000fed0: 7469 6d65 2073 7472 696e 6720 6f66 2074  time string of t
+0000fee0: 6865 2072 6967 6874 2066 6f72 6d61 7422  he right format"
+0000fef0: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+0000ff00: 7465 7374 2e72 6169 7365 7328 436f 6e73  test.raises(Cons
+0000ff10: 7472 6169 6e74 4d65 7461 6461 7461 4572  traintMetadataEr
+0000ff20: 726f 722c 206d 6174 6368 3d65 7272 6f72  ror, match=error
+0000ff30: 5f6d 6573 7361 6765 293a 0a20 2020 2020  _message):.     
+0000ff40: 2020 2020 2020 2053 6361 6c61 7249 6e65         ScalarIne
+0000ff50: 7175 616c 6974 792e 5f76 616c 6964 6174  quality._validat
+0000ff60: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+0000ff70: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+0000ff80: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+0000ff90: 2020 206d 6574 6164 6174 612c 0a20 2020     metadata,.   
+0000ffa0: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+0000ffb0: 756d 6e5f 6e61 6d65 3d27 6127 2c0a 2020  umn_name='a',.  
+0000ffc0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0000ffd0: 6c61 7469 6f6e 3d27 3e27 2c0a 2020 2020  lation='>',.    
+0000ffe0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+0000fff0: 653d 2731 2d31 2d32 3032 3027 0a20 2020  e='1-1-2020'.   
+00010000: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00010010: 6465 6620 7465 7374 5f5f 7661 6c69 6461  def test__valida
+00010020: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
+00010030: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
+00010040: 6e74 5f62 6164 5f74 7970 6528 7365 6c66  nt_bad_type(self
+00010050: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+00010060: 7374 2074 6865 2060 605f 7661 6c69 6461  st the ``_valida
+00010070: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
+00010080: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
+00010090: 6e74 6060 206d 6574 686f 642e 0a0a 2020  nt`` method...  
+000100a0: 2020 2020 2020 4966 2074 6865 2063 6f6c        If the col
+000100b0: 756d 6e5f 6e61 6d65 2068 6173 2061 6e20  umn_name has an 
+000100c0: 7364 7479 7065 2074 6861 7420 6973 206e  sdtype that is n
+000100d0: 6f74 2061 2064 6174 6574 696d 6520 7374  ot a datetime st
+000100e0: 7269 6e67 2c20 696e 7420 6f72 0a20 2020  ring, int or.   
+000100f0: 2020 2020 2066 6c6f 6174 2074 6865 6e20       float then 
+00010100: 616e 2065 7272 6f72 2073 686f 756c 6420  an error should 
+00010110: 6265 2072 6169 7365 642e 0a0a 2020 2020  be raised...    
+00010120: 2020 2020 5365 7475 703a 0a20 2020 2020      Setup:.     
+00010130: 2020 2020 2020 202d 204d 6574 6164 6174         - Metadat
+00010140: 6120 7769 7468 2074 6865 2073 6474 7970  a with the sdtyp
+00010150: 6520 7365 7420 746f 2063 6174 6567 6f72  e set to categor
+00010160: 6963 616c 2e0a 0a20 2020 2020 2020 2049  ical...        I
+00010170: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
+00010180: 2020 2d20 5468 6520 636f 6c75 6d6e 206e    - The column n
+00010190: 616d 652c 2072 656c 6174 696f 6e20 616e  ame, relation an
+000101a0: 6420 7661 6c75 652e 0a0a 2020 2020 2020  d value...      
+000101b0: 2020 5369 6465 2065 6666 6563 743a 0a20    Side effect:. 
+000101c0: 2020 2020 2020 2020 2020 202d 2041 2043             - A C
+000101d0: 6f6e 7374 7261 696e 744d 6574 6164 6174  onstraintMetadat
+000101e0: 6145 7272 6f72 2073 686f 756c 6420 6265  aError should be
+000101f0: 2072 6169 7365 642e 0a20 2020 2020 2020   raised..       
+00010200: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
+00010210: 6574 7570 0a20 2020 2020 2020 206d 6574  etup.        met
+00010220: 6164 6174 6120 3d20 4d6f 636b 2829 0a20  adata = Mock(). 
+00010230: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
+00010240: 636f 6c75 6d6e 7320 3d20 7b27 6127 3a20  columns = {'a': 
+00010250: 7b27 7364 7479 7065 273a 2027 6361 7465  {'sdtype': 'cate
+00010260: 676f 7269 6361 6c27 7d7d 0a0a 2020 2020  gorical'}}..    
+00010270: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
+00010280: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
+00010290: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+000102a0: 2741 2053 6361 6c61 7249 6e65 7175 616c  'A ScalarInequal
+000102b0: 6974 7920 636f 6e73 7472 6169 6e74 2069  ity constraint i
+000102c0: 7320 6265 696e 6720 6170 706c 6965 6420  s being applied 
+000102d0: 746f 2063 6f6c 756d 6e73 2077 6974 6820  to columns with 
+000102e0: 6d69 736d 6174 6368 6564 2073 6474 7970  mismatched sdtyp
+000102f0: 6573 2e20 270a 2020 2020 2020 2020 2020  es. '.          
+00010300: 2020 274e 756d 6572 6963 616c 2063 6f6c    'Numerical col
+00010310: 756d 6e73 206d 7573 7420 6265 2063 6f6d  umns must be com
+00010320: 7061 7265 6420 746f 2069 6e74 6567 6572  pared to integer
+00010330: 206f 7220 666c 6f61 7420 7661 6c75 6573   or float values
+00010340: 2e20 270a 2020 2020 2020 2020 2020 2020  . '.            
+00010350: 2744 6174 6574 696d 6573 2063 6f6c 756d  'Datetimes colum
+00010360: 6e20 6d75 7374 2062 6520 636f 6d70 6172  n must be compar
+00010370: 6564 2074 6f20 6461 7465 7469 6d65 2073  ed to datetime s
+00010380: 7472 696e 6773 2e27 0a20 2020 2020 2020  trings.'.       
+00010390: 2029 0a20 2020 2020 2020 2077 6974 6820   ).        with 
+000103a0: 7079 7465 7374 2e72 6169 7365 7328 436f  pytest.raises(Co
+000103b0: 6e73 7472 6169 6e74 4d65 7461 6461 7461  nstraintMetadata
+000103c0: 4572 726f 722c 206d 6174 6368 3d65 7272  Error, match=err
+000103d0: 6f72 5f6d 6573 7361 6765 293a 0a20 2020  or_message):.   
+000103e0: 2020 2020 2020 2020 2053 6361 6c61 7249           ScalarI
+000103f0: 6e65 7175 616c 6974 792e 5f76 616c 6964  nequality._valid
+00010400: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
+00010410: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
+00010420: 696e 7428 0a20 2020 2020 2020 2020 2020  int(.           
+00010430: 2020 2020 206d 6574 6164 6174 612c 0a20       metadata,. 
+00010440: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00010450: 6f6c 756d 6e5f 6e61 6d65 3d27 6127 2c0a  olumn_name='a',.
+00010460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010470: 7265 6c61 7469 6f6e 3d27 3e27 2c0a 2020  relation='>',.  
+00010480: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00010490: 6c75 653d 370a 2020 2020 2020 2020 2020  lue=7.          
+000104a0: 2020 290a 0a20 2020 2064 6566 2074 6573    )..    def tes
+000104b0: 745f 5f76 616c 6964 6174 655f 696e 6974  t__validate_init
+000104c0: 5f69 6e70 7574 735f 696e 636f 7272 6563  _inputs_incorrec
+000104d0: 745f 636f 6c75 6d6e 2873 656c 6629 3a0a  t_column(self):.
+000104e0: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
+000104f0: 7468 6520 6060 5f76 616c 6964 6174 655f  the ``_validate_
+00010500: 696e 6974 5f69 6e70 7574 7360 6020 6d65  init_inputs`` me
+00010510: 7468 6f64 2e0a 0a20 2020 2020 2020 2045  thod...        E
+00010520: 6e73 7572 6520 7468 6520 6d65 7468 6f64  nsure the method
+00010530: 2072 6169 7365 7320 616e 2065 7272 6f72   raises an error
+00010540: 2077 6865 6e20 7468 6520 636f 6c75 6d6e   when the column
+00010550: 206e 616d 6520 6973 206e 6f74 2061 2073   name is not a s
+00010560: 7472 696e 672e 0a0a 2020 2020 2020 2020  tring...        
+00010570: 496e 7075 743a 0a20 2020 2020 2020 202d  Input:.        -
+00010580: 2061 206e 6f6e 2d73 7472 696e 670a 2020   a non-string.  
+00010590: 2020 2020 2020 2d20 6120 6e75 6d62 6572        - a number
+000105a0: 0a20 2020 2020 2020 202d 2061 6e20 696e  .        - an in
+000105b0: 6571 7561 6c69 7479 0a20 2020 2020 2020  equality.       
+000105c0: 2053 6964 6520 6566 6665 6374 3a0a 2020   Side effect:.  
+000105d0: 2020 2020 2020 2d20 5261 6973 6520 6060        - Raise ``
+000105e0: 5661 6c75 6545 7272 6f72 6060 2062 6563  ValueError`` bec
+000105f0: 6175 7365 2074 6865 2063 6f6c 756d 6e20  ause the column 
+00010600: 6e61 6d65 206d 7573 7420 6265 2061 2073  name must be a s
+00010610: 7472 696e 670a 2020 2020 2020 2020 2222  tring.        ""
+00010620: 220a 2020 2020 2020 2020 2320 5275 6e20  ".        # Run 
+00010630: 2f20 4173 7365 7274 0a20 2020 2020 2020  / Assert.       
+00010640: 2065 7272 5f6d 7367 203d 2027 6063 6f6c   err_msg = '`col
+00010650: 756d 6e5f 6e61 6d65 6020 6d75 7374 2062  umn_name` must b
+00010660: 6520 6120 7374 7269 6e67 2e27 0a20 2020  e a string.'.   
 00010670: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
 00010680: 2e72 6169 7365 7328 5661 6c75 6545 7272  .raises(ValueErr
 00010690: 6f72 2c20 6d61 7463 683d 6572 725f 6d73  or, match=err_ms
 000106a0: 6729 3a0a 2020 2020 2020 2020 2020 2020  g):.            
 000106b0: 5363 616c 6172 496e 6571 7561 6c69 7479  ScalarInequality
 000106c0: 2e5f 7661 6c69 6461 7465 5f69 6e69 745f  ._validate_init_
 000106d0: 696e 7075 7473 2863 6f6c 756d 6e5f 6e61  inputs(column_na
-000106e0: 6d65 3d27 6127 2c20 7661 6c75 653d 7661  me='a', value=va
-000106f0: 6c75 652c 2072 656c 6174 696f 6e3d 273e  lue, relation='>
-00010700: 2729 0a0a 2020 2020 6465 6620 7465 7374  ')..    def test
-00010710: 5f5f 7661 6c69 6461 7465 5f69 6e69 745f  __validate_init_
-00010720: 696e 7075 7473 5f69 6e63 6f72 7265 6374  inputs_incorrect
-00010730: 5f76 616c 7565 2873 656c 6629 3a0a 2020  _value(self):.  
-00010740: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-00010750: 6520 6060 5f76 616c 6964 6174 655f 696e  e ``_validate_in
-00010760: 6974 5f69 6e70 7574 7360 6020 6d65 7468  it_inputs`` meth
-00010770: 6f64 2e0a 0a20 2020 2020 2020 2045 6e73  od...        Ens
-00010780: 7572 6520 7468 6520 6d65 7468 6f64 2072  ure the method r
-00010790: 6169 7365 7320 616e 2065 7272 6f72 2077  aises an error w
-000107a0: 6865 6e20 7468 6520 7661 6c75 6520 6973  hen the value is
-000107b0: 206e 6f74 206e 756d 6572 6963 616c 2e0a   not numerical..
-000107c0: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-000107d0: 2020 2020 2020 2020 2d20 6120 7374 7269          - a stri
-000107e0: 6e67 0a20 2020 2020 2020 202d 2061 206e  ng.        - a n
-000107f0: 6f6e 2d6e 756d 6265 720a 2020 2020 2020  on-number.      
-00010800: 2020 2d20 616e 2069 6e65 7175 616c 6974    - an inequalit
-00010810: 790a 2020 2020 2020 2020 5369 6465 2065  y.        Side e
-00010820: 6666 6563 743a 0a20 2020 2020 2020 202d  ffect:.        -
-00010830: 2052 6169 7365 2060 6056 616c 7565 4572   Raise ``ValueEr
-00010840: 726f 7260 6020 6265 6361 7573 6520 7468  ror`` because th
-00010850: 6520 7661 6c75 6520 6d75 7374 2062 6520  e value must be 
-00010860: 6120 6e75 6d65 7269 6361 6c0a 2020 2020  a numerical.    
-00010870: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00010880: 2320 5275 6e20 2f20 4173 7365 7274 0a20  # Run / Assert. 
-00010890: 2020 2020 2020 2065 7272 5f6d 7367 203d         err_msg =
-000108a0: 2027 6076 616c 7565 6020 6d75 7374 2062   '`value` must b
-000108b0: 6520 6120 6e75 6d62 6572 206f 7220 6120  e a number or a 
-000108c0: 7374 7269 6e67 2074 6861 7420 7265 7072  string that repr
-000108d0: 6573 656e 7473 2061 2064 6174 6574 696d  esents a datetim
-000108e0: 652e 270a 2020 2020 2020 2020 7769 7468  e.'.        with
-000108f0: 2070 7974 6573 742e 7261 6973 6573 2856   pytest.raises(V
-00010900: 616c 7565 4572 726f 722c 206d 6174 6368  alueError, match
-00010910: 3d65 7272 5f6d 7367 293a 0a20 2020 2020  =err_msg):.     
-00010920: 2020 2020 2020 2053 6361 6c61 7249 6e65         ScalarIne
-00010930: 7175 616c 6974 792e 5f76 616c 6964 6174  quality._validat
-00010940: 655f 696e 6974 5f69 6e70 7574 7328 636f  e_init_inputs(co
-00010950: 6c75 6d6e 5f6e 616d 653d 2761 272c 2076  lumn_name='a', v
-00010960: 616c 7565 3d27 6227 2c20 7265 6c61 7469  alue='b', relati
-00010970: 6f6e 3d27 3e27 290a 0a20 2020 2064 6566  on='>')..    def
-00010980: 2074 6573 745f 5f76 616c 6964 6174 655f   test__validate_
-00010990: 696e 6974 5f69 6e70 7574 735f 696e 636f  init_inputs_inco
-000109a0: 7272 6563 745f 7265 6c61 7469 6f6e 2873  rrect_relation(s
-000109b0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-000109c0: 2254 6573 7420 7468 6520 6060 5f76 616c  "Test the ``_val
-000109d0: 6964 6174 655f 696e 6974 5f69 6e70 7574  idate_init_input
-000109e0: 7360 6020 6d65 7468 6f64 2e0a 0a20 2020  s`` method...   
-000109f0: 2020 2020 2052 6169 7365 2061 6e20 6572       Raise an er
-00010a00: 726f 7220 7768 656e 2074 6865 2072 656c  ror when the rel
-00010a10: 6174 696f 6e20 6973 206e 6f74 2076 616c  ation is not val
-00010a20: 6964 2e0a 0a20 2020 2020 2020 2049 6e70  id...        Inp
-00010a30: 7574 3a0a 2020 2020 2020 2020 2d20 6120  ut:.        - a 
-00010a40: 7374 7269 6e67 0a20 2020 2020 2020 202d  string.        -
-00010a50: 2061 206e 756d 6265 720a 2020 2020 2020   a number.      
-00010a60: 2020 2d20 6120 6e6f 6e2d 696e 6571 7561    - a non-inequa
-00010a70: 6c69 7479 0a20 2020 2020 2020 2053 6964  lity.        Sid
-00010a80: 6520 6566 6665 6374 3a0a 2020 2020 2020  e effect:.      
-00010a90: 2020 2d20 5261 6973 6520 6060 5661 6c75    - Raise ``Valu
-00010aa0: 6545 7272 6f72 6060 2062 6563 6175 7365  eError`` because
-00010ab0: 2074 6865 2072 656c 6174 696f 6e20 6d75   the relation mu
-00010ac0: 7374 2062 6520 616e 2069 6e65 7175 616c  st be an inequal
-00010ad0: 6974 790a 2020 2020 2020 2020 2222 220a  ity.        """.
-00010ae0: 2020 2020 2020 2020 2320 5275 6e20 2f20          # Run / 
-00010af0: 4173 7365 7274 0a20 2020 2020 2020 2065  Assert.        e
-00010b00: 7272 5f6d 7367 203d 2027 6072 656c 6174  rr_msg = '`relat
-00010b10: 696f 6e60 206d 7573 7420 6265 206f 6e65  ion` must be one
-00010b20: 206f 6620 7468 6520 666f 6c6c 6f77 696e   of the followin
-00010b30: 673a 2060 3e60 2c20 603e 3d60 2c20 603c  g: `>`, `>=`, `<
-00010b40: 602c 2060 3c3d 6027 0a20 2020 2020 2020  `, `<=`'.       
-00010b50: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
-00010b60: 7365 7328 5661 6c75 6545 7272 6f72 2c20  ses(ValueError, 
-00010b70: 6d61 7463 683d 6572 725f 6d73 6729 3a0a  match=err_msg):.
-00010b80: 2020 2020 2020 2020 2020 2020 5363 616c              Scal
-00010b90: 6172 496e 6571 7561 6c69 7479 2e5f 7661  arInequality._va
-00010ba0: 6c69 6461 7465 5f69 6e69 745f 696e 7075  lidate_init_inpu
-00010bb0: 7473 2863 6f6c 756d 6e5f 6e61 6d65 3d27  ts(column_name='
-00010bc0: 6127 2c20 7661 6c75 653d 312c 2072 656c  a', value=1, rel
-00010bd0: 6174 696f 6e3d 273d 2729 0a0a 2020 2020  ation='=')..    
-00010be0: 4070 6174 6368 2827 7364 762e 636f 6e73  @patch('sdv.cons
-00010bf0: 7472 6169 6e74 732e 5363 616c 6172 496e  traints.ScalarIn
-00010c00: 6571 7561 6c69 7479 2e5f 7661 6c69 6461  equality._valida
-00010c10: 7465 5f69 6e69 745f 696e 7075 7473 2729  te_init_inputs')
-00010c20: 0a20 2020 2064 6566 2074 6573 745f 5f5f  .    def test___
-00010c30: 696e 6974 5f5f 5f28 7365 6c66 2c20 6d6f  init___(self, mo
-00010c40: 636b 5f76 616c 6964 6174 6529 3a0a 2020  ck_validate):.  
-00010c50: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-00010c60: 6520 6060 5363 616c 6172 496e 6571 7561  e ``ScalarInequa
-00010c70: 6c69 7479 2e5f 5f69 6e69 745f 5f60 6020  lity.__init__`` 
-00010c80: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
-00010c90: 2054 6865 2070 6173 7365 6420 6172 6775   The passed argu
-00010ca0: 6d65 6e74 7320 7368 6f75 6c64 2062 6520  ments should be 
-00010cb0: 7374 6f72 6564 2061 7320 6174 7472 6962  stored as attrib
-00010cc0: 7574 6573 2e0a 0a20 2020 2020 2020 2049  utes...        I
-00010cd0: 6e70 7574 3a0a 2020 2020 2020 2020 2d20  nput:.        - 
-00010ce0: 636f 6c75 6d6e 5f6e 616d 6520 7368 6f75  column_name shou
-00010cf0: 6c64 2062 6520 6120 636f 6c75 6d6e 206e  ld be a column n
-00010d00: 616d 650a 2020 2020 2020 2020 2d20 7661  ame.        - va
-00010d10: 6c75 6520 7368 6f75 6c64 2062 6520 6120  lue should be a 
-00010d20: 6e75 6d62 6572 0a20 2020 2020 2020 202d  number.        -
-00010d30: 2072 656c 6174 696f 6e20 7368 6f75 6c64   relation should
-00010d40: 2062 6520 616e 2069 6e65 7175 616c 6974   be an inequalit
-00010d50: 7920 7379 6d62 6f6c 0a20 2020 2020 2020  y symbol.       
-00010d60: 2053 6964 6520 6566 6665 6374 733a 0a20   Side effects:. 
-00010d70: 2020 2020 2020 202d 205f 636f 6c75 6d6e         - _column
-00010d80: 5f6e 616d 6520 6973 2073 6574 2074 6f20  _name is set to 
-00010d90: 636f 6c75 6d6e 5f6e 616d 650a 2020 2020  column_name.    
-00010da0: 2020 2020 2d20 5f76 616c 7565 2069 7320      - _value is 
-00010db0: 7365 7420 746f 2076 616c 7565 0a20 2020  set to value.   
-00010dc0: 2020 2020 202d 205f 6469 6666 5f63 6f6c       - _diff_col
-00010dd0: 756d 6e5f 6e61 6d65 2069 7320 7365 7420  umn_name is set 
-00010de0: 746f 2027 636f 6c75 6d6e 5f6e 616d 6523  to 'column_name#
-00010df0: 6469 6666 270a 2020 2020 2020 2020 2d20  diff'.        - 
-00010e00: 5f6f 7065 7261 746f 7220 6973 2073 6574  _operator is set
-00010e10: 2074 6f20 7468 6520 6e75 6d70 7920 6f70   to the numpy op
-00010e20: 6572 6174 696f 6e20 636f 7272 6573 706f  eration correspo
-00010e30: 6e64 696e 6720 746f 2074 6865 2069 6e70  nding to the inp
-00010e40: 7574 2072 656c 6174 696f 6e0a 2020 2020  ut relation.    
-00010e50: 2020 2020 2d20 5f64 7479 7065 2061 6e64      - _dtype and
-00010e60: 205f 6973 5f64 6174 6574 696d 6520 6172   _is_datetime ar
-00010e70: 6520 4e6f 6e65 0a20 2020 2020 2020 202d  e None.        -
-00010e80: 205f 7661 6c69 6461 7465 5f69 6e69 745f   _validate_init_
-00010e90: 696e 7075 7473 2069 7320 6361 6c6c 6564  inputs is called
-00010ea0: 206f 6e63 650a 2020 2020 2020 2020 2222   once.        ""
-00010eb0: 220a 2020 2020 2020 2020 2320 5275 6e0a  ".        # Run.
-00010ec0: 2020 2020 2020 2020 696e 7374 616e 6365          instance
-00010ed0: 203d 2053 6361 6c61 7249 6e65 7175 616c   = ScalarInequal
-00010ee0: 6974 7928 636f 6c75 6d6e 5f6e 616d 653d  ity(column_name=
-00010ef0: 2761 272c 2076 616c 7565 3d31 2c20 7265  'a', value=1, re
-00010f00: 6c61 7469 6f6e 3d27 3e27 290a 0a20 2020  lation='>')..   
-00010f10: 2020 2020 2023 2041 7373 6572 7473 0a20       # Asserts. 
-00010f20: 2020 2020 2020 2061 7373 6572 7420 696e         assert in
-00010f30: 7374 616e 6365 2e5f 636f 6c75 6d6e 5f6e  stance._column_n
-00010f40: 616d 6520 3d3d 2027 6127 0a20 2020 2020  ame == 'a'.     
-00010f50: 2020 2061 7373 6572 7420 696e 7374 616e     assert instan
-00010f60: 6365 2e5f 7661 6c75 6520 3d3d 2031 0a20  ce._value == 1. 
-00010f70: 2020 2020 2020 2061 7373 6572 7420 696e         assert in
-00010f80: 7374 616e 6365 2e5f 6469 6666 5f63 6f6c  stance._diff_col
-00010f90: 756d 6e5f 6e61 6d65 203d 3d20 2761 2364  umn_name == 'a#d
-00010fa0: 6966 6627 0a20 2020 2020 2020 2061 7373  iff'.        ass
-00010fb0: 6572 7420 696e 7374 616e 6365 2e5f 6f70  ert instance._op
-00010fc0: 6572 6174 6f72 203d 3d20 6e70 2e67 7265  erator == np.gre
-00010fd0: 6174 6572 0a20 2020 2020 2020 2061 7373  ater.        ass
-00010fe0: 6572 7420 696e 7374 616e 6365 2e5f 6474  ert instance._dt
-00010ff0: 7970 6520 6973 204e 6f6e 650a 2020 2020  ype is None.    
-00011000: 2020 2020 6173 7365 7274 2069 6e73 7461      assert insta
-00011010: 6e63 652e 5f69 735f 6461 7465 7469 6d65  nce._is_datetime
-00011020: 2069 7320 4e6f 6e65 0a20 2020 2020 2020   is None.       
-00011030: 206d 6f63 6b5f 7661 6c69 6461 7465 2e61   mock_validate.a
-00011040: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
-00011050: 655f 7769 7468 2827 6127 2c20 312c 2027  e_with('a', 1, '
-00011060: 3e27 290a 0a20 2020 2064 6566 2074 6573  >')..    def tes
-00011070: 745f 5f67 6574 5f69 735f 6461 7465 7469  t__get_is_dateti
-00011080: 6d65 5f69 6e63 6f72 7265 6374 5f64 6174  me_incorrect_dat
-00011090: 6128 7365 6c66 293a 0a20 2020 2020 2020  a(self):.       
-000110a0: 2022 2222 5465 7374 2074 6865 2060 6053   """Test the ``S
-000110b0: 6361 6c61 7249 6e65 7175 616c 6974 792e  calarInequality.
-000110c0: 5f67 6574 5f69 735f 6461 7465 7469 6d65  _get_is_datetime
-000110d0: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
-000110e0: 2020 2020 456e 7375 7265 2074 6861 7420      Ensure that 
-000110f0: 6966 206f 6e65 206f 6620 636f 6c75 6d6e  if one of column
-00011100: 2f76 616c 7565 2069 7320 6461 7465 7469  /value is dateti
-00011110: 6d65 2c20 626f 7468 206f 6620 7468 656d  me, both of them
-00011120: 2061 7265 2e0a 0a20 2020 2020 2020 2049   are...        I
-00011130: 6e70 7574 3a0a 2020 2020 2020 2020 2d20  nput:.        - 
-00011140: 5461 626c 6520 6461 7461 2e0a 2020 2020  Table data..    
-00011150: 2020 2020 5369 6465 2045 6666 6563 743a      Side Effect:
-00011160: 0a20 2020 2020 2020 202d 2052 6169 7365  .        - Raise
-00011170: 7320 6060 5661 6c75 6545 7272 6f72 6060  s ``ValueError``
-00011180: 2069 6620 6f6e 6c79 206f 6e65 206f 6620   if only one of 
-00011190: 636f 6c75 6d6e 2f76 616c 7565 2069 7320  column/value is 
-000111a0: 6461 7465 7469 6d65 2e0a 2020 2020 2020  datetime..      
-000111b0: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
-000111c0: 5365 7475 7079 0a20 2020 2020 2020 2074  Setupy.        t
-000111d0: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
-000111e0: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
-000111f0: 2020 2020 2020 2027 6127 3a20 7064 2e74         'a': pd.t
-00011200: 6f5f 6461 7465 7469 6d65 285b 2732 3032  o_datetime(['202
-00011210: 302d 3031 2d30 3127 5d29 2c0a 2020 2020  0-01-01']),.    
-00011220: 2020 2020 7d29 0a20 2020 2020 2020 2069      }).        i
-00011230: 6e73 7461 6e63 6520 3d20 5363 616c 6172  nstance = Scalar
-00011240: 496e 6571 7561 6c69 7479 2863 6f6c 756d  Inequality(colum
-00011250: 6e5f 6e61 6d65 3d27 6127 2c20 7661 6c75  n_name='a', valu
-00011260: 653d 312c 2072 656c 6174 696f 6e3d 273c  e=1, relation='<
-00011270: 2729 0a0a 2020 2020 2020 2020 2320 5275  ')..        # Ru
-00011280: 6e20 2f20 4173 7365 7274 0a20 2020 2020  n / Assert.     
-00011290: 2020 2065 7272 5f6d 7367 203d 2027 426f     err_msg = 'Bo
-000112a0: 7468 2063 6f6c 756d 6e20 616e 6420 7661  th column and va
-000112b0: 6c75 6520 6d75 7374 2062 6520 6461 7465  lue must be date
-000112c0: 7469 6d65 2e27 0a20 2020 2020 2020 2077  time.'.        w
-000112d0: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-000112e0: 7328 5661 6c75 6545 7272 6f72 2c20 6d61  s(ValueError, ma
-000112f0: 7463 683d 6572 725f 6d73 6729 3a0a 2020  tch=err_msg):.  
-00011300: 2020 2020 2020 2020 2020 696e 7374 616e            instan
-00011310: 6365 2e5f 6765 745f 6973 5f64 6174 6574  ce._get_is_datet
-00011320: 696d 6528 7461 626c 655f 6461 7461 290a  ime(table_data).
-00011330: 0a20 2020 2064 6566 2074 6573 745f 5f76  .    def test__v
-00011340: 616c 6964 6174 655f 636f 6c75 6d6e 735f  alidate_columns_
-00011350: 6578 6973 745f 696e 636f 7272 6563 745f  exist_incorrect_
-00011360: 636f 6c75 6d6e 7328 7365 6c66 293a 0a20  columns(self):. 
+000106e0: 6d65 3d5b 2761 275d 2c20 7661 6c75 653d  me=['a'], value=
+000106f0: 312c 2072 656c 6174 696f 6e3d 273e 2729  1, relation='>')
+00010700: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
+00010710: 7661 6c69 6461 7465 5f69 6e69 745f 696e  validate_init_in
+00010720: 7075 7473 5f69 6e63 6f72 7265 6374 5f76  puts_incorrect_v
+00010730: 616c 7565 5f64 6174 6574 696d 6528 7365  alue_datetime(se
+00010740: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00010750: 5465 7374 2074 6865 2060 605f 7661 6c69  Test the ``_vali
+00010760: 6461 7465 5f69 6e69 745f 696e 7075 7473  date_init_inputs
+00010770: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
+00010780: 2020 2020 456e 7375 7265 2074 6865 206d      Ensure the m
+00010790: 6574 686f 6420 7261 6973 6573 2061 6e20  ethod raises an 
+000107a0: 6572 726f 7220 7768 656e 2074 6865 2060  error when the `
+000107b0: 6076 616c 7565 6060 2069 7320 6e6f 7420  `value`` is not 
+000107c0: 6120 6060 4461 7465 7469 6d65 6060 2072  a ``Datetime`` r
+000107d0: 6570 7265 7365 6e74 6564 0a20 2020 2020  epresented.     
+000107e0: 2020 2061 7320 7374 7269 6e67 2e0a 0a20     as string... 
+000107f0: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
+00010800: 2020 2020 2020 2d20 6120 7374 7269 6e67        - a string
+00010810: 0a20 2020 2020 2020 202d 2061 206e 6f6e  .        - a non
+00010820: 2073 7472 696e 6720 6461 7465 7469 6d65   string datetime
+00010830: 0a20 2020 2020 2020 202d 2061 6e20 696e  .        - an in
+00010840: 6571 7561 6c69 7479 0a20 2020 2020 2020  equality.       
+00010850: 2053 6964 6520 6566 6665 6374 3a0a 2020   Side effect:.  
+00010860: 2020 2020 2020 2d20 5261 6973 6520 6060        - Raise ``
+00010870: 5661 6c75 6545 7272 6f72 6060 2062 6563  ValueError`` bec
+00010880: 6175 7365 2074 6865 2064 6174 6574 696d  ause the datetim
+00010890: 6520 6861 7320 746f 2062 6520 7265 7072  e has to be repr
+000108a0: 6573 656e 7465 6420 6173 2061 2073 7472  esented as a str
+000108b0: 696e 672e 0a20 2020 2020 2020 2022 2222  ing..        """
+000108c0: 0a20 2020 2020 2020 2023 2052 756e 202f  .        # Run /
+000108d0: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
+000108e0: 7661 6c75 6520 3d20 7064 2e74 6f5f 6461  value = pd.to_da
+000108f0: 7465 7469 6d65 2827 3230 3231 2d30 322d  tetime('2021-02-
+00010900: 3031 2729 0a20 2020 2020 2020 2065 7272  01').        err
+00010910: 5f6d 7367 203d 2027 4461 7465 7469 6d65  _msg = 'Datetime
+00010920: 206d 7573 7420 6265 2072 6570 7265 7365   must be represe
+00010930: 6e74 6564 2061 7320 6120 7374 7269 6e67  nted as a string
+00010940: 2e27 0a20 2020 2020 2020 2077 6974 6820  .'.        with 
+00010950: 7079 7465 7374 2e72 6169 7365 7328 5661  pytest.raises(Va
+00010960: 6c75 6545 7272 6f72 2c20 6d61 7463 683d  lueError, match=
+00010970: 6572 725f 6d73 6729 3a0a 2020 2020 2020  err_msg):.      
+00010980: 2020 2020 2020 5363 616c 6172 496e 6571        ScalarIneq
+00010990: 7561 6c69 7479 2e5f 7661 6c69 6461 7465  uality._validate
+000109a0: 5f69 6e69 745f 696e 7075 7473 2863 6f6c  _init_inputs(col
+000109b0: 756d 6e5f 6e61 6d65 3d27 6127 2c20 7661  umn_name='a', va
+000109c0: 6c75 653d 7661 6c75 652c 2072 656c 6174  lue=value, relat
+000109d0: 696f 6e3d 273e 2729 0a0a 2020 2020 6465  ion='>')..    de
+000109e0: 6620 7465 7374 5f5f 7661 6c69 6461 7465  f test__validate
+000109f0: 5f69 6e69 745f 696e 7075 7473 5f69 6e63  _init_inputs_inc
+00010a00: 6f72 7265 6374 5f76 616c 7565 2873 656c  orrect_value(sel
+00010a10: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+00010a20: 6573 7420 7468 6520 6060 5f76 616c 6964  est the ``_valid
+00010a30: 6174 655f 696e 6974 5f69 6e70 7574 7360  ate_init_inputs`
+00010a40: 6020 6d65 7468 6f64 2e0a 0a20 2020 2020  ` method...     
+00010a50: 2020 2045 6e73 7572 6520 7468 6520 6d65     Ensure the me
+00010a60: 7468 6f64 2072 6169 7365 7320 616e 2065  thod raises an e
+00010a70: 7272 6f72 2077 6865 6e20 7468 6520 7661  rror when the va
+00010a80: 6c75 6520 6973 206e 6f74 206e 756d 6572  lue is not numer
+00010a90: 6963 616c 2e0a 0a20 2020 2020 2020 2049  ical...        I
+00010aa0: 6e70 7574 3a0a 2020 2020 2020 2020 2d20  nput:.        - 
+00010ab0: 6120 7374 7269 6e67 0a20 2020 2020 2020  a string.       
+00010ac0: 202d 2061 206e 6f6e 2d6e 756d 6265 720a   - a non-number.
+00010ad0: 2020 2020 2020 2020 2d20 616e 2069 6e65          - an ine
+00010ae0: 7175 616c 6974 790a 2020 2020 2020 2020  quality.        
+00010af0: 5369 6465 2065 6666 6563 743a 0a20 2020  Side effect:.   
+00010b00: 2020 2020 202d 2052 6169 7365 2060 6056       - Raise ``V
+00010b10: 616c 7565 4572 726f 7260 6020 6265 6361  alueError`` beca
+00010b20: 7573 6520 7468 6520 7661 6c75 6520 6d75  use the value mu
+00010b30: 7374 2062 6520 6120 6e75 6d65 7269 6361  st be a numerica
+00010b40: 6c0a 2020 2020 2020 2020 2222 220a 2020  l.        """.  
+00010b50: 2020 2020 2020 2320 5275 6e20 2f20 4173        # Run / As
+00010b60: 7365 7274 0a20 2020 2020 2020 2065 7272  sert.        err
+00010b70: 5f6d 7367 203d 2027 6076 616c 7565 6020  _msg = '`value` 
+00010b80: 6d75 7374 2062 6520 6120 6e75 6d62 6572  must be a number
+00010b90: 206f 7220 6120 7374 7269 6e67 2074 6861   or a string tha
+00010ba0: 7420 7265 7072 6573 656e 7473 2061 2064  t represents a d
+00010bb0: 6174 6574 696d 652e 270a 2020 2020 2020  atetime.'.      
+00010bc0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+00010bd0: 6973 6573 2856 616c 7565 4572 726f 722c  ises(ValueError,
+00010be0: 206d 6174 6368 3d65 7272 5f6d 7367 293a   match=err_msg):
+00010bf0: 0a20 2020 2020 2020 2020 2020 2053 6361  .            Sca
+00010c00: 6c61 7249 6e65 7175 616c 6974 792e 5f76  larInequality._v
+00010c10: 616c 6964 6174 655f 696e 6974 5f69 6e70  alidate_init_inp
+00010c20: 7574 7328 636f 6c75 6d6e 5f6e 616d 653d  uts(column_name=
+00010c30: 2761 272c 2076 616c 7565 3d27 6227 2c20  'a', value='b', 
+00010c40: 7265 6c61 7469 6f6e 3d27 3e27 290a 0a20  relation='>').. 
+00010c50: 2020 2064 6566 2074 6573 745f 5f76 616c     def test__val
+00010c60: 6964 6174 655f 696e 6974 5f69 6e70 7574  idate_init_input
+00010c70: 735f 696e 636f 7272 6563 745f 7265 6c61  s_incorrect_rela
+00010c80: 7469 6f6e 2873 656c 6629 3a0a 2020 2020  tion(self):.    
+00010c90: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
+00010ca0: 6060 5f76 616c 6964 6174 655f 696e 6974  ``_validate_init
+00010cb0: 5f69 6e70 7574 7360 6020 6d65 7468 6f64  _inputs`` method
+00010cc0: 2e0a 0a20 2020 2020 2020 2052 6169 7365  ...        Raise
+00010cd0: 2061 6e20 6572 726f 7220 7768 656e 2074   an error when t
+00010ce0: 6865 2072 656c 6174 696f 6e20 6973 206e  he relation is n
+00010cf0: 6f74 2076 616c 6964 2e0a 0a20 2020 2020  ot valid...     
+00010d00: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
+00010d10: 2020 2d20 6120 7374 7269 6e67 0a20 2020    - a string.   
+00010d20: 2020 2020 202d 2061 206e 756d 6265 720a       - a number.
+00010d30: 2020 2020 2020 2020 2d20 6120 6e6f 6e2d          - a non-
+00010d40: 696e 6571 7561 6c69 7479 0a20 2020 2020  inequality.     
+00010d50: 2020 2053 6964 6520 6566 6665 6374 3a0a     Side effect:.
+00010d60: 2020 2020 2020 2020 2d20 5261 6973 6520          - Raise 
+00010d70: 6060 5661 6c75 6545 7272 6f72 6060 2062  ``ValueError`` b
+00010d80: 6563 6175 7365 2074 6865 2072 656c 6174  ecause the relat
+00010d90: 696f 6e20 6d75 7374 2062 6520 616e 2069  ion must be an i
+00010da0: 6e65 7175 616c 6974 790a 2020 2020 2020  nequality.      
+00010db0: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+00010dc0: 5275 6e20 2f20 4173 7365 7274 0a20 2020  Run / Assert.   
+00010dd0: 2020 2020 2065 7272 5f6d 7367 203d 2027       err_msg = '
+00010de0: 6072 656c 6174 696f 6e60 206d 7573 7420  `relation` must 
+00010df0: 6265 206f 6e65 206f 6620 7468 6520 666f  be one of the fo
+00010e00: 6c6c 6f77 696e 673a 2060 3e60 2c20 603e  llowing: `>`, `>
+00010e10: 3d60 2c20 603c 602c 2060 3c3d 6027 0a20  =`, `<`, `<=`'. 
+00010e20: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
+00010e30: 7374 2e72 6169 7365 7328 5661 6c75 6545  st.raises(ValueE
+00010e40: 7272 6f72 2c20 6d61 7463 683d 6572 725f  rror, match=err_
+00010e50: 6d73 6729 3a0a 2020 2020 2020 2020 2020  msg):.          
+00010e60: 2020 5363 616c 6172 496e 6571 7561 6c69    ScalarInequali
+00010e70: 7479 2e5f 7661 6c69 6461 7465 5f69 6e69  ty._validate_ini
+00010e80: 745f 696e 7075 7473 2863 6f6c 756d 6e5f  t_inputs(column_
+00010e90: 6e61 6d65 3d27 6127 2c20 7661 6c75 653d  name='a', value=
+00010ea0: 312c 2072 656c 6174 696f 6e3d 273d 2729  1, relation='=')
+00010eb0: 0a0a 2020 2020 4070 6174 6368 2827 7364  ..    @patch('sd
+00010ec0: 762e 636f 6e73 7472 6169 6e74 732e 5363  v.constraints.Sc
+00010ed0: 616c 6172 496e 6571 7561 6c69 7479 2e5f  alarInequality._
+00010ee0: 7661 6c69 6461 7465 5f69 6e69 745f 696e  validate_init_in
+00010ef0: 7075 7473 2729 0a20 2020 2064 6566 2074  puts').    def t
+00010f00: 6573 745f 5f5f 696e 6974 5f5f 5f28 7365  est___init___(se
+00010f10: 6c66 2c20 6d6f 636b 5f76 616c 6964 6174  lf, mock_validat
+00010f20: 6529 3a0a 2020 2020 2020 2020 2222 2254  e):.        """T
+00010f30: 6573 7420 7468 6520 6060 5363 616c 6172  est the ``Scalar
+00010f40: 496e 6571 7561 6c69 7479 2e5f 5f69 6e69  Inequality.__ini
+00010f50: 745f 5f60 6020 6d65 7468 6f64 2e0a 0a20  t__`` method... 
+00010f60: 2020 2020 2020 2054 6865 2070 6173 7365         The passe
+00010f70: 6420 6172 6775 6d65 6e74 7320 7368 6f75  d arguments shou
+00010f80: 6c64 2062 6520 7374 6f72 6564 2061 7320  ld be stored as 
+00010f90: 6174 7472 6962 7574 6573 2e0a 0a20 2020  attributes...   
+00010fa0: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
+00010fb0: 2020 2020 2d20 636f 6c75 6d6e 5f6e 616d      - column_nam
+00010fc0: 6520 7368 6f75 6c64 2062 6520 6120 636f  e should be a co
+00010fd0: 6c75 6d6e 206e 616d 650a 2020 2020 2020  lumn name.      
+00010fe0: 2020 2d20 7661 6c75 6520 7368 6f75 6c64    - value should
+00010ff0: 2062 6520 6120 6e75 6d62 6572 0a20 2020   be a number.   
+00011000: 2020 2020 202d 2072 656c 6174 696f 6e20       - relation 
+00011010: 7368 6f75 6c64 2062 6520 616e 2069 6e65  should be an ine
+00011020: 7175 616c 6974 7920 7379 6d62 6f6c 0a20  quality symbol. 
+00011030: 2020 2020 2020 2053 6964 6520 6566 6665         Side effe
+00011040: 6374 733a 0a20 2020 2020 2020 202d 205f  cts:.        - _
+00011050: 636f 6c75 6d6e 5f6e 616d 6520 6973 2073  column_name is s
+00011060: 6574 2074 6f20 636f 6c75 6d6e 5f6e 616d  et to column_nam
+00011070: 650a 2020 2020 2020 2020 2d20 5f76 616c  e.        - _val
+00011080: 7565 2069 7320 7365 7420 746f 2076 616c  ue is set to val
+00011090: 7565 0a20 2020 2020 2020 202d 205f 6469  ue.        - _di
+000110a0: 6666 5f63 6f6c 756d 6e5f 6e61 6d65 2069  ff_column_name i
+000110b0: 7320 7365 7420 746f 2027 636f 6c75 6d6e  s set to 'column
+000110c0: 5f6e 616d 6523 6469 6666 270a 2020 2020  _name#diff'.    
+000110d0: 2020 2020 2d20 5f6f 7065 7261 746f 7220      - _operator 
+000110e0: 6973 2073 6574 2074 6f20 7468 6520 6e75  is set to the nu
+000110f0: 6d70 7920 6f70 6572 6174 696f 6e20 636f  mpy operation co
+00011100: 7272 6573 706f 6e64 696e 6720 746f 2074  rresponding to t
+00011110: 6865 2069 6e70 7574 2072 656c 6174 696f  he input relatio
+00011120: 6e0a 2020 2020 2020 2020 2d20 5f64 7479  n.        - _dty
+00011130: 7065 2061 6e64 205f 6973 5f64 6174 6574  pe and _is_datet
+00011140: 696d 6520 6172 6520 4e6f 6e65 0a20 2020  ime are None.   
+00011150: 2020 2020 202d 205f 7661 6c69 6461 7465       - _validate
+00011160: 5f69 6e69 745f 696e 7075 7473 2069 7320  _init_inputs is 
+00011170: 6361 6c6c 6564 206f 6e63 650a 2020 2020  called once.    
+00011180: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00011190: 2320 5275 6e0a 2020 2020 2020 2020 696e  # Run.        in
+000111a0: 7374 616e 6365 203d 2053 6361 6c61 7249  stance = ScalarI
+000111b0: 6e65 7175 616c 6974 7928 636f 6c75 6d6e  nequality(column
+000111c0: 5f6e 616d 653d 2761 272c 2076 616c 7565  _name='a', value
+000111d0: 3d31 2c20 7265 6c61 7469 6f6e 3d27 3e27  =1, relation='>'
+000111e0: 290a 0a20 2020 2020 2020 2023 2041 7373  )..        # Ass
+000111f0: 6572 7473 0a20 2020 2020 2020 2061 7373  erts.        ass
+00011200: 6572 7420 696e 7374 616e 6365 2e5f 636f  ert instance._co
+00011210: 6c75 6d6e 5f6e 616d 6520 3d3d 2027 6127  lumn_name == 'a'
+00011220: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00011230: 696e 7374 616e 6365 2e5f 7661 6c75 6520  instance._value 
+00011240: 3d3d 2031 0a20 2020 2020 2020 2061 7373  == 1.        ass
+00011250: 6572 7420 696e 7374 616e 6365 2e5f 6469  ert instance._di
+00011260: 6666 5f63 6f6c 756d 6e5f 6e61 6d65 203d  ff_column_name =
+00011270: 3d20 2761 2364 6966 6627 0a20 2020 2020  = 'a#diff'.     
+00011280: 2020 2061 7373 6572 7420 696e 7374 616e     assert instan
+00011290: 6365 2e5f 6f70 6572 6174 6f72 203d 3d20  ce._operator == 
+000112a0: 6e70 2e67 7265 6174 6572 0a20 2020 2020  np.greater.     
+000112b0: 2020 2061 7373 6572 7420 696e 7374 616e     assert instan
+000112c0: 6365 2e5f 6474 7970 6520 6973 204e 6f6e  ce._dtype is Non
+000112d0: 650a 2020 2020 2020 2020 6173 7365 7274  e.        assert
+000112e0: 2069 6e73 7461 6e63 652e 5f69 735f 6461   instance._is_da
+000112f0: 7465 7469 6d65 2069 7320 4e6f 6e65 0a20  tetime is None. 
+00011300: 2020 2020 2020 206d 6f63 6b5f 7661 6c69         mock_vali
+00011310: 6461 7465 2e61 7373 6572 745f 6361 6c6c  date.assert_call
+00011320: 6564 5f6f 6e63 655f 7769 7468 2827 6127  ed_once_with('a'
+00011330: 2c20 312c 2027 3e27 290a 0a20 2020 2064  , 1, '>')..    d
+00011340: 6566 2074 6573 745f 5f67 6574 5f69 735f  ef test__get_is_
+00011350: 6461 7465 7469 6d65 5f69 6e63 6f72 7265  datetime_incorre
+00011360: 6374 5f64 6174 6128 7365 6c66 293a 0a20  ct_data(self):. 
 00011370: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
 00011380: 6865 2060 6053 6361 6c61 7249 6e65 7175  he ``ScalarInequ
-00011390: 616c 6974 792e 5f76 616c 6964 6174 655f  ality._validate_
-000113a0: 636f 6c75 6d6e 735f 6578 6973 7460 6020  columns_exist`` 
-000113b0: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
-000113c0: 2054 6869 7320 6d65 7468 6f64 2072 6169   This method rai
-000113d0: 7365 7320 616e 2065 7272 6f72 2069 6620  ses an error if 
-000113e0: 6060 636f 6c75 6d6e 5f6e 616d 6560 6020  ``column_name`` 
-000113f0: 646f 6573 206e 6f74 2065 7869 7374 2e0a  does not exist..
-00011400: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-00011410: 2020 2020 2020 2020 2d20 5461 626c 6520          - Table 
-00011420: 7769 7468 2067 6976 656e 2064 6174 612e  with given data.
-00011430: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00011440: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
-00011450: 2020 2020 2074 6162 6c65 5f64 6174 6120       table_data 
-00011460: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
-00011470: 0a20 2020 2020 2020 2020 2020 2027 6127  .            'a'
-00011480: 3a20 5b31 2c20 322c 2034 5d2c 0a20 2020  : [1, 2, 4],.   
-00011490: 2020 2020 2020 2020 2027 6227 3a20 5b34           'b': [4
-000114a0: 2c20 352c 2036 5d0a 2020 2020 2020 2020  , 5, 6].        
-000114b0: 7d29 0a20 2020 2020 2020 2069 6e73 7461  }).        insta
-000114c0: 6e63 6520 3d20 5363 616c 6172 496e 6571  nce = ScalarIneq
-000114d0: 7561 6c69 7479 2863 6f6c 756d 6e5f 6e61  uality(column_na
-000114e0: 6d65 3d27 6327 2c20 7661 6c75 653d 352c  me='c', value=5,
-000114f0: 2072 656c 6174 696f 6e3d 273e 2729 0a0a   relation='>')..
-00011500: 2020 2020 2020 2020 2320 5275 6e20 2f20          # Run / 
-00011510: 4173 7365 7274 0a20 2020 2020 2020 2077  Assert.        w
-00011520: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-00011530: 7328 4b65 7945 7272 6f72 293a 0a20 2020  s(KeyError):.   
-00011540: 2020 2020 2020 2020 2069 6e73 7461 6e63           instanc
-00011550: 652e 5f76 616c 6964 6174 655f 636f 6c75  e._validate_colu
-00011560: 6d6e 735f 6578 6973 7428 7461 626c 655f  mns_exist(table_
-00011570: 6461 7461 290a 0a20 2020 2064 6566 2074  data)..    def t
-00011580: 6573 745f 5f66 6974 2873 656c 6629 3a0a  est__fit(self):.
-00011590: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-000115a0: 7468 6520 6060 5363 616c 6172 496e 6571  the ``ScalarIneq
-000115b0: 7561 6c69 7479 2e5f 6669 7460 6020 6d65  uality._fit`` me
-000115c0: 7468 6f64 2e0a 0a20 2020 2020 2020 2054  thod...        T
-000115d0: 6865 206d 6574 686f 6420 7368 6f75 6c64  he method should
-000115e0: 206c 6561 726e 2074 6865 2060 6064 7479   learn the ``dty
-000115f0: 7065 6060 206f 6620 6060 636f 6c75 6d6e  pe`` of ``column
-00011600: 5f6e 616d 6560 6020 616e 6420 6060 5f69  _name`` and ``_i
-00011610: 735f 6461 7465 7469 6d65 6060 2e0a 0a20  s_datetime``... 
-00011620: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
-00011630: 2020 2020 2020 2d20 5461 626c 6520 6461        - Table da
-00011640: 7461 2077 6974 6820 696e 7465 6765 7273  ta with integers
-00011650: 2e0a 2020 2020 2020 2020 5369 6465 2045  ..        Side E
-00011660: 6666 6563 743a 0a20 2020 2020 2020 202d  ffect:.        -
-00011670: 205f 7661 6c69 6461 7465 5f63 6f6c 756d   _validate_colum
-00011680: 6e73 5f65 7869 7374 2073 686f 756c 6420  ns_exist should 
-00011690: 6265 2063 616c 6c65 6420 6f6e 6365 0a20  be called once. 
-000116a0: 2020 2020 2020 202d 205f 6765 745f 6973         - _get_is
-000116b0: 5f64 6174 6574 696d 6520 7368 6f75 6c64  _datetime should
-000116c0: 2062 6520 6361 6c6c 6564 206f 6e63 650a   be called once.
-000116d0: 2020 2020 2020 2020 2d20 5f69 735f 6461          - _is_da
-000116e0: 7465 7469 6d65 2073 686f 756c 6420 7265  tetime should re
-000116f0: 6365 6976 6520 7468 6520 6f75 7470 7574  ceive the output
-00011700: 206f 6620 5f67 6574 5f69 735f 6461 7465   of _get_is_date
-00011710: 7469 6d65 0a20 2020 2020 2020 202d 205f  time.        - _
-00011720: 6474 7970 6520 7368 6f75 6c64 2062 6520  dtype should be 
-00011730: 6120 6c69 7374 206f 6620 696e 7465 6765  a list of intege
-00011740: 7220 6474 7970 6573 2e0a 2020 2020 2020  r dtypes..      
-00011750: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
-00011760: 5365 7475 700a 2020 2020 2020 2020 7461  Setup.        ta
-00011770: 626c 655f 6461 7461 203d 2070 642e 4461  ble_data = pd.Da
-00011780: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
-00011790: 2020 2020 2020 2761 273a 205b 312c 2032        'a': [1, 2
-000117a0: 2c20 345d 2c0a 2020 2020 2020 2020 2020  , 4],.          
-000117b0: 2020 2762 273a 205b 342c 2035 2c20 365d    'b': [4, 5, 6]
-000117c0: 0a20 2020 2020 2020 207d 290a 2020 2020  .        }).    
-000117d0: 2020 2020 696e 7374 616e 6365 203d 2053      instance = S
-000117e0: 6361 6c61 7249 6e65 7175 616c 6974 7928  calarInequality(
-000117f0: 636f 6c75 6d6e 5f6e 616d 653d 2762 272c  column_name='b',
-00011800: 2076 616c 7565 3d33 2c20 7265 6c61 7469   value=3, relati
-00011810: 6f6e 3d27 3e27 290a 2020 2020 2020 2020  on='>').        
-00011820: 696e 7374 616e 6365 2e5f 7661 6c69 6461  instance._valida
-00011830: 7465 5f63 6f6c 756d 6e73 5f65 7869 7374  te_columns_exist
-00011840: 203d 204d 6f63 6b28 290a 2020 2020 2020   = Mock().      
-00011850: 2020 696e 7374 616e 6365 2e5f 6765 745f    instance._get_
-00011860: 6973 5f64 6174 6574 696d 6520 3d20 4d6f  is_datetime = Mo
-00011870: 636b 2872 6574 7572 6e5f 7661 6c75 653d  ck(return_value=
-00011880: 4661 6c73 6529 0a0a 2020 2020 2020 2020  False)..        
-00011890: 2320 5275 6e0a 2020 2020 2020 2020 696e  # Run.        in
-000118a0: 7374 616e 6365 2e5f 6669 7428 7461 626c  stance._fit(tabl
-000118b0: 655f 6461 7461 290a 0a20 2020 2020 2020  e_data)..       
-000118c0: 2023 2041 7373 6572 740a 2020 2020 2020   # Assert.      
-000118d0: 2020 696e 7374 616e 6365 2e5f 7661 6c69    instance._vali
-000118e0: 6461 7465 5f63 6f6c 756d 6e73 5f65 7869  date_columns_exi
-000118f0: 7374 2e61 7373 6572 745f 6361 6c6c 6564  st.assert_called
-00011900: 5f6f 6e63 655f 7769 7468 2874 6162 6c65  _once_with(table
-00011910: 5f64 6174 6129 0a20 2020 2020 2020 2069  _data).        i
-00011920: 6e73 7461 6e63 652e 5f67 6574 5f69 735f  nstance._get_is_
-00011930: 6461 7465 7469 6d65 2e61 7373 6572 745f  datetime.assert_
-00011940: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
-00011950: 2874 6162 6c65 5f64 6174 6129 0a20 2020  (table_data).   
-00011960: 2020 2020 2061 7373 6572 7420 6e6f 7420       assert not 
-00011970: 696e 7374 616e 6365 2e5f 6973 5f64 6174  instance._is_dat
-00011980: 6574 696d 650a 2020 2020 2020 2020 6173  etime.        as
-00011990: 7365 7274 2069 6e73 7461 6e63 652e 5f64  sert instance._d
-000119a0: 7479 7065 203d 3d20 7064 2e53 6572 6965  type == pd.Serie
-000119b0: 7328 5b31 5d29 2e64 7479 7065 2020 2320  s([1]).dtype  # 
-000119c0: 6578 6163 7420 6474 7970 6520 2833 3220  exact dtype (32 
-000119d0: 6f72 2036 3429 2064 6570 656e 6473 206f  or 64) depends o
-000119e0: 6e20 4f53 0a0a 2020 2020 6465 6620 7465  n OS..    def te
-000119f0: 7374 5f5f 6669 745f 666c 6f61 7473 2873  st__fit_floats(s
-00011a00: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00011a10: 2254 6573 7420 7468 6520 6060 5363 616c  "Test the ``Scal
-00011a20: 6172 496e 6571 7561 6c69 7479 2e5f 6669  arInequality._fi
-00011a30: 7460 6020 6d65 7468 6f64 2e0a 0a20 2020  t`` method...   
-00011a40: 2020 2020 2054 6865 2061 7474 7269 6275       The attribu
-00011a50: 7465 2060 605f 6474 7970 6560 6020 7368  te ``_dtype`` sh
-00011a60: 6f75 6c64 2062 6520 666c 6f61 7420 7768  ould be float wh
-00011a70: 656e 2060 6063 6f6c 756d 6e5f 6e61 6d65  en ``column_name
-00011a80: 6060 2063 6f6e 7461 696e 7320 666c 6f61  `` contains floa
-00011a90: 7473 2e0a 0a20 2020 2020 2020 2049 6e70  ts...        Inp
-00011aa0: 7574 3a0a 2020 2020 2020 2020 2d20 5461  ut:.        - Ta
-00011ab0: 626c 6520 6461 7461 2077 6974 6820 666c  ble data with fl
-00011ac0: 6f61 7473 2e0a 2020 2020 2020 2020 5369  oats..        Si
-00011ad0: 6465 2045 6666 6563 743a 0a20 2020 2020  de Effect:.     
-00011ae0: 2020 202d 205f 6474 7970 6520 7368 6f75     - _dtype shou
-00011af0: 6c64 2062 6520 6120 666c 6f61 7420 6474  ld be a float dt
-00011b00: 7970 652e 0a20 2020 2020 2020 2022 2222  ype..        """
-00011b10: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-00011b20: 0a20 2020 2020 2020 2074 6162 6c65 5f64  .        table_d
-00011b30: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
-00011b40: 6d65 287b 0a20 2020 2020 2020 2020 2020  me({.           
-00011b50: 2027 6127 3a20 5b31 2c20 322c 2034 5d2c   'a': [1, 2, 4],
-00011b60: 0a20 2020 2020 2020 2020 2020 2027 6227  .            'b'
-00011b70: 3a20 5b34 2e2c 2035 2e2c 2036 2e5d 0a20  : [4., 5., 6.]. 
-00011b80: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
-00011b90: 2020 696e 7374 616e 6365 203d 2053 6361    instance = Sca
-00011ba0: 6c61 7249 6e65 7175 616c 6974 7928 636f  larInequality(co
-00011bb0: 6c75 6d6e 5f6e 616d 653d 2762 272c 2076  lumn_name='b', v
-00011bc0: 616c 7565 3d31 302c 2072 656c 6174 696f  alue=10, relatio
-00011bd0: 6e3d 273e 2729 0a0a 2020 2020 2020 2020  n='>')..        
-00011be0: 2320 5275 6e0a 2020 2020 2020 2020 696e  # Run.        in
-00011bf0: 7374 616e 6365 2e5f 6669 7428 7461 626c  stance._fit(tabl
-00011c00: 655f 6461 7461 290a 0a20 2020 2020 2020  e_data)..       
-00011c10: 2023 2041 7373 6572 740a 2020 2020 2020   # Assert.      
-00011c20: 2020 6173 7365 7274 2069 6e73 7461 6e63    assert instanc
-00011c30: 652e 5f64 7479 7065 203d 3d20 6e70 2e64  e._dtype == np.d
-00011c40: 7479 7065 2827 666c 6f61 7427 290a 0a20  type('float').. 
-00011c50: 2020 2064 6566 2074 6573 745f 5f66 6974     def test__fit
-00011c60: 5f64 6174 6574 696d 6528 7365 6c66 293a  _datetime(self):
-00011c70: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-00011c80: 2074 6865 2060 6053 6361 6c61 7249 6e65   the ``ScalarIne
-00011c90: 7175 616c 6974 792e 5f66 6974 6060 206d  quality._fit`` m
-00011ca0: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
-00011cb0: 5468 6520 6174 7472 6962 7574 6520 6060  The attribute ``
-00011cc0: 5f64 7479 7065 6060 2073 686f 756c 6420  _dtype`` should 
-00011cd0: 6265 2064 6174 6574 696d 6520 7768 656e  be datetime when
-00011ce0: 2060 6063 6f6c 756d 6e5f 6e61 6d65 6060   ``column_name``
-00011cf0: 2063 6f6e 7461 696e 7320 6461 7465 7469   contains dateti
-00011d00: 6d65 732e 0a0a 2020 2020 2020 2020 496e  mes...        In
-00011d10: 7075 743a 0a20 2020 2020 2020 202d 2054  put:.        - T
-00011d20: 6162 6c65 2064 6174 6120 7769 7468 2064  able data with d
-00011d30: 6174 6574 696d 6573 2e0a 2020 2020 2020  atetimes..      
-00011d40: 2020 5369 6465 2045 6666 6563 743a 0a20    Side Effect:. 
-00011d50: 2020 2020 2020 202d 205f 6474 7970 6520         - _dtype 
-00011d60: 7368 6f75 6c64 2062 6520 6120 6c69 7374  should be a list
-00011d70: 206f 6620 6461 7465 7469 6d65 2064 7479   of datetime dty
-00011d80: 7065 732e 0a20 2020 2020 2020 2022 2222  pes..        """
-00011d90: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-00011da0: 0a20 2020 2020 2020 2074 6162 6c65 5f64  .        table_d
-00011db0: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
-00011dc0: 6d65 287b 0a20 2020 2020 2020 2020 2020  me({.           
-00011dd0: 2027 6127 3a20 7064 2e74 6f5f 6461 7465   'a': pd.to_date
-00011de0: 7469 6d65 285b 2732 3032 302d 3031 2d30  time(['2020-01-0
-00011df0: 3127 5d29 2c0a 2020 2020 2020 2020 2020  1']),.          
-00011e00: 2020 2762 273a 2070 642e 746f 5f64 6174    'b': pd.to_dat
-00011e10: 6574 696d 6528 5b27 3230 3230 2d30 312d  etime(['2020-01-
-00011e20: 3032 275d 290a 2020 2020 2020 2020 7d29  02']).        })
-00011e30: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-00011e40: 6520 3d20 5363 616c 6172 496e 6571 7561  e = ScalarInequa
-00011e50: 6c69 7479 2863 6f6c 756d 6e5f 6e61 6d65  lity(column_name
-00011e60: 3d27 6227 2c20 7661 6c75 653d 2732 3032  ='b', value='202
-00011e70: 302d 3031 2d30 3127 2c20 7265 6c61 7469  0-01-01', relati
-00011e80: 6f6e 3d27 3e27 290a 0a20 2020 2020 2020  on='>')..       
-00011e90: 2023 2052 756e 0a20 2020 2020 2020 2069   # Run.        i
-00011ea0: 6e73 7461 6e63 652e 5f66 6974 2874 6162  nstance._fit(tab
-00011eb0: 6c65 5f64 6174 6129 0a0a 2020 2020 2020  le_data)..      
-00011ec0: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
-00011ed0: 2020 2061 7373 6572 7420 696e 7374 616e     assert instan
-00011ee0: 6365 2e5f 6474 7970 6520 3d3d 206e 702e  ce._dtype == np.
-00011ef0: 6474 7970 6528 273c 4d38 5b6e 735d 2729  dtype('<M8[ns]')
-00011f00: 0a0a 2020 2020 6465 6620 7465 7374 5f69  ..    def test_i
-00011f10: 735f 7661 6c69 6428 7365 6c66 293a 0a20  s_valid(self):. 
-00011f20: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
-00011f30: 6865 2060 6053 6361 6c61 7249 6e65 7175  he ``ScalarInequ
-00011f40: 616c 6974 792e 6973 5f76 616c 6964 6060  ality.is_valid``
-00011f50: 206d 6574 686f 6420 7769 7468 2060 6072   method with ``r
-00011f60: 656c 6174 696f 6e20 3d20 273e 2760 602e  elation = '>'``.
-00011f70: 0a0a 2020 2020 2020 2020 5468 6520 6d65  ..        The me
-00011f80: 7468 6f64 2073 686f 756c 6420 7265 7475  thod should retu
-00011f90: 726e 2054 7275 6520 7768 656e 2060 6063  rn True when ``c
-00011fa0: 6f6c 756d 6e5f 6e61 6d65 6060 2069 7320  olumn_name`` is 
-00011fb0: 6772 6561 7465 7220 7468 616e 0a20 2020  greater than.   
-00011fc0: 2020 2020 2060 6076 616c 7565 6060 206f       ``value`` o
-00011fd0: 7220 7468 6520 726f 7720 636f 6e74 6169  r the row contai
-00011fe0: 6e73 206e 616e 2c20 6f74 6865 7277 6973  ns nan, otherwis
-00011ff0: 6520 7265 7475 726e 2046 616c 7365 2e0a  e return False..
-00012000: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-00012010: 2020 2020 2020 2020 2d20 5461 626c 6520          - Table 
-00012020: 7769 7468 2061 206d 6978 7475 7265 206f  with a mixture o
-00012030: 6620 7661 6c69 6420 616e 6420 696e 7661  f valid and inva
-00012040: 6c69 6420 726f 7773 2c20 6173 2077 656c  lid rows, as wel
-00012050: 6c20 6173 206e 702e 6e61 6e73 2e0a 2020  l as np.nans..  
-00012060: 2020 2020 2020 4f75 7470 7574 3a0a 2020        Output:.  
-00012070: 2020 2020 2020 2d20 4661 6c73 6520 7368        - False sh
-00012080: 6f75 6c64 2062 6520 7265 7475 726e 6564  ould be returned
-00012090: 2066 6f72 2074 6865 2073 7472 6963 746c   for the strictl
-000120a0: 7920 696e 7661 6c69 6420 726f 7773 2061  y invalid rows a
-000120b0: 6e64 2054 7275 6520 666f 7220 7468 6520  nd True for the 
-000120c0: 7265 7374 2e0a 2020 2020 2020 2020 2222  rest..        ""
-000120d0: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
-000120e0: 700a 2020 2020 2020 2020 696e 7374 616e  p.        instan
-000120f0: 6365 203d 2053 6361 6c61 7249 6e65 7175  ce = ScalarInequ
-00012100: 616c 6974 7928 636f 6c75 6d6e 5f6e 616d  ality(column_nam
-00012110: 653d 2762 272c 2076 616c 7565 3d32 2c20  e='b', value=2, 
-00012120: 7265 6c61 7469 6f6e 3d27 3e27 290a 0a20  relation='>').. 
-00012130: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
-00012140: 2020 2020 2074 6162 6c65 5f64 6174 6120       table_data 
-00012150: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
-00012160: 0a20 2020 2020 2020 2020 2020 2027 6127  .            'a'
-00012170: 3a20 5b31 2c20 6e70 2e6e 616e 2c20 332c  : [1, np.nan, 3,
-00012180: 2034 2c20 4e6f 6e65 5d2c 0a20 2020 2020   4, None],.     
-00012190: 2020 2020 2020 2027 6227 3a20 5b34 2c20         'b': [4, 
-000121a0: 322c 206e 702e 6e61 6e2c 202d 362c 204e  2, np.nan, -6, N
-000121b0: 6f6e 655d 2c0a 2020 2020 2020 2020 7d29  one],.        })
-000121c0: 0a20 2020 2020 2020 206f 7574 203d 2069  .        out = i
-000121d0: 6e73 7461 6e63 652e 6973 5f76 616c 6964  nstance.is_valid
-000121e0: 2874 6162 6c65 5f64 6174 6129 0a0a 2020  (table_data)..  
-000121f0: 2020 2020 2020 2320 4173 7365 7274 0a20        # Assert. 
-00012200: 2020 2020 2020 2065 7870 6563 7465 645f         expected_
-00012210: 6f75 7420 3d20 5b54 7275 652c 2046 616c  out = [True, Fal
-00012220: 7365 2c20 5472 7565 2c20 4661 6c73 652c  se, True, False,
-00012230: 2054 7275 655d 0a20 2020 2020 2020 206e   True].        n
-00012240: 702e 7465 7374 696e 672e 6173 7365 7274  p.testing.assert
-00012250: 5f61 7272 6179 5f65 7175 616c 2865 7870  _array_equal(exp
-00012260: 6563 7465 645f 6f75 742c 206f 7574 290a  ected_out, out).
-00012270: 0a20 2020 2064 6566 2074 6573 745f 6973  .    def test_is
-00012280: 5f76 616c 6964 5f64 6174 6574 696d 6573  _valid_datetimes
-00012290: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000122a0: 2222 2254 6573 7420 7468 6520 6060 5363  """Test the ``Sc
-000122b0: 616c 6172 496e 6571 7561 6c69 7479 2e69  alarInequality.i
-000122c0: 735f 7661 6c69 6460 6020 6d65 7468 6f64  s_valid`` method
-000122d0: 2077 6974 6820 6461 7465 7469 6d65 7320   with datetimes 
-000122e0: 616e 6420 6060 7265 6c61 7469 6f6e 203d  and ``relation =
-000122f0: 2027 3c3d 2760 602e 0a0a 2020 2020 2020   '<='``...      
-00012300: 2020 5468 6520 6d65 7468 6f64 2073 686f    The method sho
-00012310: 756c 6420 7265 7475 726e 2054 7275 6520  uld return True 
-00012320: 7768 656e 2060 6063 6f6c 756d 6e5f 6e61  when ``column_na
-00012330: 6d65 6060 2069 7320 6772 6561 7465 7220  me`` is greater 
-00012340: 6f72 2065 7175 616c 2074 6f0a 2020 2020  or equal to.    
-00012350: 2020 2020 6060 7661 6c75 6560 6020 6f72      ``value`` or
-00012360: 2074 6865 2072 6f77 2063 6f6e 7461 696e   the row contain
-00012370: 7320 6e61 6e2c 206f 7468 6572 7769 7365  s nan, otherwise
-00012380: 2072 6574 7572 6e20 4661 6c73 652e 0a0a   return False...
-00012390: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
-000123a0: 2020 2020 2020 202d 2054 6162 6c65 2077         - Table w
-000123b0: 6974 6820 6461 7465 7469 6d65 7320 616e  ith datetimes an
-000123c0: 6420 6e70 2e6e 616e 732e 0a20 2020 2020  d np.nans..     
-000123d0: 2020 204f 7574 7075 743a 0a20 2020 2020     Output:.     
-000123e0: 2020 202d 2046 616c 7365 2073 686f 756c     - False shoul
-000123f0: 6420 6265 2072 6574 7572 6e65 6420 666f  d be returned fo
-00012400: 7220 7468 6520 7374 7269 6374 6c79 2069  r the strictly i
-00012410: 6e76 616c 6964 2072 6f77 7320 616e 6420  nvalid rows and 
-00012420: 5472 7565 2066 6f72 2074 6865 2072 6573  True for the res
-00012430: 742e 0a20 2020 2020 2020 2022 2222 0a20  t..        """. 
-00012440: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
-00012450: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
-00012460: 3d20 5363 616c 6172 496e 6571 7561 6c69  = ScalarInequali
-00012470: 7479 280a 2020 2020 2020 2020 2020 2020  ty(.            
-00012480: 636f 6c75 6d6e 5f6e 616d 653d 2762 272c  column_name='b',
-00012490: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
-000124a0: 7565 3d27 382f 3331 2f32 3032 3127 2c0a  ue='8/31/2021',.
-000124b0: 2020 2020 2020 2020 2020 2020 7265 6c61              rela
-000124c0: 7469 6f6e 3d27 3e3d 2729 0a0a 2020 2020  tion='>=')..    
-000124d0: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
-000124e0: 2020 7461 626c 655f 6461 7461 203d 2070    table_data = p
-000124f0: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-00012500: 2020 2020 2020 2020 2020 2762 273a 205b            'b': [
-00012510: 6461 7465 7469 6d65 2832 3032 312c 2038  datetime(2021, 8
-00012520: 2c20 3330 292c 2064 6174 6574 696d 6528  , 30), datetime(
-00012530: 3230 3231 2c20 382c 2033 3129 2c20 6461  2021, 8, 31), da
-00012540: 7465 7469 6d65 2832 3032 312c 2039 2c20  tetime(2021, 9, 
-00012550: 3229 2c20 6e70 2e6e 616e 5d2c 0a20 2020  2), np.nan],.   
-00012560: 2020 2020 2020 2020 2027 6327 3a20 5b37           'c': [7
-00012570: 2c20 382c 2039 2c20 3130 5d0a 2020 2020  , 8, 9, 10].    
-00012580: 2020 2020 7d29 0a20 2020 2020 2020 206f      }).        o
-00012590: 7574 203d 2069 6e73 7461 6e63 652e 6973  ut = instance.is
-000125a0: 5f76 616c 6964 2874 6162 6c65 5f64 6174  _valid(table_dat
-000125b0: 6129 0a0a 2020 2020 2020 2020 2320 4173  a)..        # As
-000125c0: 7365 7274 0a20 2020 2020 2020 2065 7870  sert.        exp
-000125d0: 6563 7465 645f 6f75 7420 3d20 5b46 616c  ected_out = [Fal
-000125e0: 7365 2c20 5472 7565 2c20 5472 7565 2c20  se, True, True, 
-000125f0: 5472 7565 5d0a 2020 2020 2020 2020 6e70  True].        np
-00012600: 2e74 6573 7469 6e67 2e61 7373 6572 745f  .testing.assert_
-00012610: 6172 7261 795f 6571 7561 6c28 6578 7065  array_equal(expe
-00012620: 6374 6564 5f6f 7574 2c20 6f75 7429 0a0a  cted_out, out)..
-00012630: 2020 2020 6465 6620 7465 7374 5f69 735f      def test_is_
-00012640: 7661 6c69 645f 6461 7465 7469 6d65 735f  valid_datetimes_
-00012650: 6173 5f6f 626a 6563 7428 7365 6c66 293a  as_object(self):
-00012660: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-00012670: 2074 6865 2060 6053 6361 6c61 7249 6e65   the ``ScalarIne
-00012680: 7175 616c 6974 792e 6973 5f76 616c 6964  quality.is_valid
-00012690: 6060 206d 6574 686f 6420 7769 7468 2064  `` method with d
-000126a0: 6174 6574 696d 6573 2061 6e64 2074 6865  atetimes and the
-000126b0: 6972 2064 7479 7065 2069 7320 6f62 6a65  ir dtype is obje
-000126c0: 6374 2e0a 0a20 2020 2020 2020 2054 6865  ct...        The
-000126d0: 206d 6574 686f 6420 7368 6f75 6c64 2072   method should r
-000126e0: 6574 7572 6e20 5472 7565 2077 6865 6e20  eturn True when 
-000126f0: 6060 636f 6c75 6d6e 5f6e 616d 6560 6020  ``column_name`` 
-00012700: 6973 2067 7265 6174 6572 206f 7220 6571  is greater or eq
-00012710: 7561 6c20 746f 0a20 2020 2020 2020 2060  ual to.        `
-00012720: 6076 616c 7565 6060 206f 7220 7468 6520  `value`` or the 
-00012730: 726f 7720 636f 6e74 6169 6e73 206e 616e  row contains nan
-00012740: 2c20 6576 656e 2077 6865 6e20 7468 6520  , even when the 
-00012750: 6060 6461 7465 7469 6d65 6060 2069 7320  ``datetime`` is 
-00012760: 7061 7373 6564 2061 7320 616e 206f 626a  passed as an obj
-00012770: 6563 742e 0a20 2020 2020 2020 2022 2222  ect..        """
-00012780: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-00012790: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-000127a0: 6520 3d20 5363 616c 6172 496e 6571 7561  e = ScalarInequa
-000127b0: 6c69 7479 280a 2020 2020 2020 2020 2020  lity(.          
-000127c0: 2020 636f 6c75 6d6e 5f6e 616d 653d 2762    column_name='b
-000127d0: 272c 0a20 2020 2020 2020 2020 2020 2076  ',.            v
-000127e0: 616c 7565 3d27 382f 3331 2f32 3032 3127  alue='8/31/2021'
-000127f0: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
-00012800: 6c61 7469 6f6e 3d27 3e3d 270a 2020 2020  lation='>='.    
-00012810: 2020 2020 290a 2020 2020 2020 2020 696e      ).        in
-00012820: 7374 616e 6365 2e5f 6474 7970 6520 3d20  stance._dtype = 
-00012830: 6e70 2e64 7479 7065 2827 4f27 290a 2020  np.dtype('O').  
-00012840: 2020 2020 2020 696e 7374 616e 6365 2e5f        instance._
-00012850: 6973 5f64 6174 6574 696d 6520 3d20 5472  is_datetime = Tr
-00012860: 7565 0a0a 2020 2020 2020 2020 2320 5275  ue..        # Ru
-00012870: 6e0a 2020 2020 2020 2020 7461 626c 655f  n.        table_
-00012880: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
-00012890: 616d 6528 7b0a 2020 2020 2020 2020 2020  ame({.          
-000128a0: 2020 2762 273a 205b 2732 3032 312c 2038    'b': ['2021, 8
-000128b0: 2c20 3330 272c 2027 3230 3231 2c20 382c  , 30', '2021, 8,
-000128c0: 2033 3127 2c20 2732 3032 312c 2039 2c20   31', '2021, 9, 
-000128d0: 3227 2c20 6e70 2e6e 616e 5d2c 0a20 2020  2', np.nan],.   
-000128e0: 2020 2020 2020 2020 2027 6327 3a20 5b37           'c': [7
-000128f0: 2c20 382c 2039 2c20 3130 5d0a 2020 2020  , 8, 9, 10].    
-00012900: 2020 2020 7d29 0a20 2020 2020 2020 206f      }).        o
-00012910: 7574 203d 2069 6e73 7461 6e63 652e 6973  ut = instance.is
-00012920: 5f76 616c 6964 2874 6162 6c65 5f64 6174  _valid(table_dat
-00012930: 6129 0a0a 2020 2020 2020 2020 2320 4173  a)..        # As
-00012940: 7365 7274 0a20 2020 2020 2020 2065 7870  sert.        exp
-00012950: 6563 7465 645f 6f75 7420 3d20 5b46 616c  ected_out = [Fal
-00012960: 7365 2c20 5472 7565 2c20 5472 7565 2c20  se, True, True, 
-00012970: 5472 7565 5d0a 2020 2020 2020 2020 6e70  True].        np
-00012980: 2e74 6573 7469 6e67 2e61 7373 6572 745f  .testing.assert_
-00012990: 6172 7261 795f 6571 7561 6c28 6578 7065  array_equal(expe
-000129a0: 6374 6564 5f6f 7574 2c20 6f75 7429 0a0a  cted_out, out)..
-000129b0: 2020 2020 6465 6620 7465 7374 5f5f 7472      def test__tr
-000129c0: 616e 7366 6f72 6d28 7365 6c66 293a 0a20  ansform(self):. 
-000129d0: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
-000129e0: 6865 2060 6053 6361 6c61 7249 6e65 7175  he ``ScalarInequ
-000129f0: 616c 6974 792e 5f74 7261 6e73 666f 726d  ality._transform
-00012a00: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
-00012a10: 2020 2020 5468 6520 6d65 7468 6f64 2069      The method i
-00012a20: 7320 6578 7065 6374 6564 2074 6f20 636f  s expected to co
-00012a30: 6d70 7574 6520 7468 6520 6469 7374 616e  mpute the distan
-00012a40: 6365 2062 6574 7765 656e 2074 6865 2060  ce between the `
-00012a50: 6063 6f6c 756d 6e5f 6e61 6d65 6060 2061  `column_name`` a
-00012a60: 6e64 2060 6076 616c 7565 6060 0a20 2020  nd ``value``.   
-00012a70: 2020 2020 2061 6e64 2063 7265 6174 6520       and create 
-00012a80: 6120 6469 6666 2063 6f6c 756d 6e20 7769  a diff column wi
-00012a90: 7468 2074 6865 206c 6f67 6172 6974 686d  th the logarithm
-00012aa0: 206f 6620 7468 6520 6469 7374 616e 6365   of the distance
-00012ab0: 202b 2031 2e0a 0a20 2020 2020 2020 2053   + 1...        S
-00012ac0: 6574 7570 3a0a 2020 2020 2020 2020 2d20  etup:.        - 
-00012ad0: 6060 5f64 6966 665f 636f 6c75 6d6e 5f6e  ``_diff_column_n
-00012ae0: 616d 6560 6020 6973 2073 6574 2074 6f20  ame`` is set to 
-00012af0: 6060 2761 2327 6060 2e0a 2020 2020 2020  ``'a#'``..      
-00012b00: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
-00012b10: 202d 2054 6162 6c65 2064 6174 612e 0a20   - Table data.. 
-00012b20: 2020 2020 2020 204f 7574 7075 743a 0a20         Output:. 
-00012b30: 2020 2020 2020 202d 2053 616d 6520 7461         - Same ta
-00012b40: 626c 6520 7769 7468 2061 2064 6966 6620  ble with a diff 
-00012b50: 636f 6c75 6d6e 206f 6620 7468 6520 6c6f  column of the lo
-00012b60: 6720 6f66 2074 6865 2064 6973 7461 6e63  g of the distanc
-00012b70: 6573 202b 2031 0a20 2020 2020 2020 2020  es + 1.         
-00012b80: 2069 6e20 7468 6520 6060 636f 6c75 6d6e   in the ``column
-00012b90: 5f6e 616d 6560 6027 7320 706c 6163 652e  _name``'s place.
-00012ba0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00012bb0: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
-00012bc0: 2020 2020 2069 6e73 7461 6e63 6520 3d20       instance = 
-00012bd0: 5363 616c 6172 496e 6571 7561 6c69 7479  ScalarInequality
-00012be0: 2863 6f6c 756d 6e5f 6e61 6d65 3d27 6127  (column_name='a'
-00012bf0: 2c20 7661 6c75 653d 312c 2072 656c 6174  , value=1, relat
-00012c00: 696f 6e3d 273e 3d27 290a 2020 2020 2020  ion='>=').      
-00012c10: 2020 696e 7374 616e 6365 2e5f 6469 6666    instance._diff
-00012c20: 5f63 6f6c 756d 6e5f 6e61 6d65 203d 2027  _column_name = '
-00012c30: 6123 270a 0a20 2020 2020 2020 2023 2052  a#'..        # R
-00012c40: 756e 0a20 2020 2020 2020 2074 6162 6c65  un.        table
-00012c50: 5f64 6174 6120 3d20 7064 2e44 6174 6146  _data = pd.DataF
-00012c60: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
-00012c70: 2020 2027 6127 3a20 5b31 2c20 322c 2033     'a': [1, 2, 3
-00012c80: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
-00012c90: 6327 3a20 5b37 2c20 382c 2039 5d2c 0a20  c': [7, 8, 9],. 
-00012ca0: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
-00012cb0: 2020 6f75 7420 3d20 696e 7374 616e 6365    out = instance
-00012cc0: 2e5f 7472 616e 7366 6f72 6d28 7461 626c  ._transform(tabl
-00012cd0: 655f 6461 7461 290a 0a20 2020 2020 2020  e_data)..       
-00012ce0: 2023 2041 7373 6572 740a 2020 2020 2020   # Assert.      
-00012cf0: 2020 6578 7065 6374 6564 5f6f 7574 203d    expected_out =
-00012d00: 2070 642e 4461 7461 4672 616d 6528 7b0a   pd.DataFrame({.
-00012d10: 2020 2020 2020 2020 2020 2020 2763 273a              'c':
-00012d20: 205b 372c 2038 2c20 395d 2c0a 2020 2020   [7, 8, 9],.    
-00012d30: 2020 2020 2020 2020 2761 2327 3a20 5b6e          'a#': [n
-00012d40: 702e 6c6f 6728 3129 2c20 6e70 2e6c 6f67  p.log(1), np.log
-00012d50: 2832 292c 206e 702e 6c6f 6728 3329 5d2c  (2), np.log(3)],
-00012d60: 0a20 2020 2020 2020 207d 290a 2020 2020  .        }).    
-00012d70: 2020 2020 7064 2e74 6573 7469 6e67 2e61      pd.testing.a
-00012d80: 7373 6572 745f 6672 616d 655f 6571 7561  ssert_frame_equa
-00012d90: 6c28 6f75 742c 2065 7870 6563 7465 645f  l(out, expected_
-00012da0: 6f75 7429 0a0a 2020 2020 6465 6620 7465  out)..    def te
-00012db0: 7374 5f5f 7472 616e 7366 6f72 6d5f 6461  st__transform_da
-00012dc0: 7465 7469 6d65 2873 656c 6629 3a0a 2020  tetime(self):.  
-00012dd0: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-00012de0: 6520 6060 5363 616c 6172 496e 6571 7561  e ``ScalarInequa
-00012df0: 6c69 7479 2e5f 7472 616e 7366 6f72 6d60  lity._transform`
-00012e00: 6020 6d65 7468 6f64 2e0a 0a20 2020 2020  ` method...     
-00012e10: 2020 2054 6865 206d 6574 686f 6420 6973     The method is
-00012e20: 2065 7870 6563 7465 6420 746f 2063 6f6d   expected to com
-00012e30: 7075 7465 2074 6865 2064 6973 7461 6e63  pute the distanc
-00012e40: 6520 6265 7477 6565 6e20 7468 6520 6060  e between the ``
-00012e50: 636f 6c75 6d6e 5f6e 616d 6560 6020 616e  column_name`` an
-00012e60: 6420 6060 7661 6c75 6560 600a 2020 2020  d ``value``.    
-00012e70: 2020 2020 616e 6420 6372 6561 7465 2061      and create a
-00012e80: 2064 6966 6620 636f 6c75 6d6e 2077 6974   diff column wit
-00012e90: 6820 7468 6520 6c6f 6761 7269 7468 6d20  h the logarithm 
-00012ea0: 6f66 2074 6865 2064 6973 7461 6e63 6520  of the distance 
-00012eb0: 2b20 312e 0a0a 2020 2020 2020 2020 5365  + 1...        Se
-00012ec0: 7475 703a 0a20 2020 2020 2020 202d 2060  tup:.        - `
-00012ed0: 605f 6469 6666 5f63 6f6c 756d 6e5f 6e61  `_diff_column_na
-00012ee0: 6d65 6060 2069 7320 7365 7420 746f 2060  me`` is set to `
-00012ef0: 6027 6123 2760 602e 0a20 2020 2020 2020  `'a#'``..       
-00012f00: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
-00012f10: 2d20 5461 626c 6520 6461 7461 2077 6974  - Table data wit
-00012f20: 6820 6461 7465 7469 6d65 732e 0a20 2020  h datetimes..   
-00012f30: 2020 2020 204f 7574 7075 743a 0a20 2020       Output:.   
-00012f40: 2020 2020 202d 2053 616d 6520 7461 626c       - Same tabl
-00012f50: 6520 7769 7468 2061 2064 6966 6620 636f  e with a diff co
-00012f60: 6c75 6d6e 206f 6620 7468 6520 6c6f 6761  lumn of the loga
-00012f70: 7269 7468 6d73 206f 6620 7468 6520 6469  rithms of the di
-00012f80: 7374 616e 6365 7320 2b20 310a 2020 2020  stances + 1.    
-00012f90: 2020 2020 2020 696e 2074 6865 2060 6063        in the ``c
-00012fa0: 6f6c 756d 6e5f 6e61 6d65 6060 2773 2070  olumn_name``'s p
-00012fb0: 6c61 6365 2e0a 2020 2020 2020 2020 2222  lace..        ""
-00012fc0: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
-00012fd0: 700a 2020 2020 2020 2020 696e 7374 616e  p.        instan
-00012fe0: 6365 203d 2053 6361 6c61 7249 6e65 7175  ce = ScalarInequ
-00012ff0: 616c 6974 7928 0a20 2020 2020 2020 2020  ality(.         
-00013000: 2020 2063 6f6c 756d 6e5f 6e61 6d65 3d27     column_name='
-00013010: 6127 2c0a 2020 2020 2020 2020 2020 2020  a',.            
-00013020: 7661 6c75 653d 2732 3032 302d 3031 2d30  value='2020-01-0
-00013030: 3154 3030 3a30 303a 3030 272c 0a20 2020  1T00:00:00',.   
-00013040: 2020 2020 2020 2020 2072 656c 6174 696f           relatio
-00013050: 6e3d 273e 2729 0a20 2020 2020 2020 2069  n='>').        i
-00013060: 6e73 7461 6e63 652e 5f64 6966 665f 636f  nstance._diff_co
-00013070: 6c75 6d6e 5f6e 616d 6520 3d20 2761 2327  lumn_name = 'a#'
-00013080: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-00013090: 652e 5f69 735f 6461 7465 7469 6d65 203d  e._is_datetime =
-000130a0: 2054 7275 650a 0a20 2020 2020 2020 2023   True..        #
-000130b0: 2052 756e 0a20 2020 2020 2020 2074 6162   Run.        tab
-000130c0: 6c65 5f64 6174 6120 3d20 7064 2e44 6174  le_data = pd.Dat
-000130d0: 6146 7261 6d65 287b 0a20 2020 2020 2020  aFrame({.       
-000130e0: 2020 2020 2027 6127 3a20 7064 2e74 6f5f       'a': pd.to_
-000130f0: 6461 7465 7469 6d65 285b 2732 3032 302d  datetime(['2020-
-00013100: 3031 2d30 3154 3030 3a30 303a 3031 272c  01-01T00:00:01',
-00013110: 2027 3230 3230 2d30 312d 3031 5430 303a   '2020-01-01T00:
-00013120: 3030 3a30 3127 5d29 2c0a 2020 2020 2020  00:01']),.      
-00013130: 2020 2020 2020 2763 273a 205b 312c 2032        'c': [1, 2
-00013140: 5d2c 0a20 2020 2020 2020 207d 290a 2020  ],.        }).  
-00013150: 2020 2020 2020 6f75 7420 3d20 696e 7374        out = inst
-00013160: 616e 6365 2e5f 7472 616e 7366 6f72 6d28  ance._transform(
-00013170: 7461 626c 655f 6461 7461 290a 0a20 2020  table_data)..   
-00013180: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
-00013190: 2020 2020 2020 6578 7065 6374 6564 5f6f        expected_o
-000131a0: 7574 203d 2070 642e 4461 7461 4672 616d  ut = pd.DataFram
-000131b0: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
-000131c0: 2763 273a 205b 312c 2032 5d2c 0a20 2020  'c': [1, 2],.   
-000131d0: 2020 2020 2020 2020 2027 6123 273a 205b           'a#': [
-000131e0: 6e70 2e6c 6f67 2831 5f30 3030 5f30 3030  np.log(1_000_000
-000131f0: 5f30 3031 292c 206e 702e 6c6f 6728 315f  _001), np.log(1_
-00013200: 3030 305f 3030 305f 3030 3129 5d2c 0a20  000_000_001)],. 
-00013210: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
-00013220: 2020 7064 2e74 6573 7469 6e67 2e61 7373    pd.testing.ass
-00013230: 6572 745f 6672 616d 655f 6571 7561 6c28  ert_frame_equal(
-00013240: 6f75 742c 2065 7870 6563 7465 645f 6f75  out, expected_ou
-00013250: 7429 0a0a 2020 2020 6465 6620 7465 7374  t)..    def test
-00013260: 5f72 6576 6572 7365 5f74 7261 6e73 666f  _reverse_transfo
-00013270: 726d 2873 656c 6629 3a0a 2020 2020 2020  rm(self):.      
-00013280: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
-00013290: 5363 616c 6172 496e 6571 7561 6c69 7479  ScalarInequality
-000132a0: 2e72 6576 6572 7365 5f74 7261 6e73 666f  .reverse_transfo
-000132b0: 726d 6060 206d 6574 686f 642e 0a0a 2020  rm`` method...  
-000132c0: 2020 2020 2020 5468 6520 6d65 7468 6f64        The method
-000132d0: 2069 7320 6578 7065 6374 6564 2074 6f3a   is expected to:
-000132e0: 0a20 2020 2020 2020 2020 2020 202d 2061  .            - a
-000132f0: 7070 6c79 2061 6e20 6578 706f 6e65 6e74  pply an exponent
-00013300: 6961 6c20 746f 2074 6865 2069 6e70 7574  ial to the input
-00013310: 0a20 2020 2020 2020 2020 2020 202d 2073  .            - s
-00013320: 7562 7472 6163 7420 310a 2020 2020 2020  ubtract 1.      
-00013330: 2020 2020 2020 2d20 6164 6420 7468 6520        - add the 
-00013340: 6060 636f 6c75 6d6e 5f6e 616d 6560 600a  ``column_name``.
-00013350: 2020 2020 2020 2020 2020 2020 2d20 636f              - co
-00013360: 6e76 6572 7420 7468 6520 6f75 7470 7574  nvert the output
-00013370: 2074 6f20 696e 7465 6765 7273 0a20 2020   to integers.   
-00013380: 2020 2020 2020 2020 202d 2061 6464 2062           - add b
-00013390: 6163 6b20 7468 6520 6472 6f70 7065 6420  ack the dropped 
-000133a0: 636f 6c75 6d6e 0a0a 2020 2020 2020 2020  column..        
-000133b0: 5365 7475 703a 0a20 2020 2020 2020 202d  Setup:.        -
-000133c0: 2060 605f 6469 6666 5f63 6f6c 756d 6e5f   ``_diff_column_
-000133d0: 6e61 6d65 203d 2027 6123 2760 600a 2020  name = 'a#'``.  
-000133e0: 2020 2020 2020 2d20 6060 5f64 7479 7065        - ``_dtype
-000133f0: 6060 2061 7320 696e 7465 6765 720a 2020  `` as integer.  
-00013400: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
-00013410: 2020 2020 202d 2054 6162 6c65 2077 6974       - Table wit
-00013420: 6820 6120 6469 6666 2063 6f6c 756d 6e20  h a diff column 
-00013430: 7468 6174 2063 6f6e 7461 696e 7320 7468  that contains th
-00013440: 6520 636f 6e73 7461 6e74 206e 702e 6c6f  e constant np.lo
-00013450: 6728 3429 2e0a 2020 2020 2020 2020 4f75  g(4)..        Ou
-00013460: 7470 7574 3a0a 2020 2020 2020 2020 2d20  tput:.        - 
-00013470: 5361 6d65 2074 6162 6c65 2077 6974 6820  Same table with 
-00013480: 7468 6520 6869 6768 2063 6f6c 756d 6e20  the high column 
-00013490: 7265 706c 6163 6564 2062 7920 7468 6520  replaced by the 
-000134a0: 6c6f 7720 6f6e 6520 2b20 332c 2061 7320  low one + 3, as 
-000134b0: 696e 740a 2020 2020 2020 2020 616e 6420  int.        and 
-000134c0: 7468 6520 6469 6666 2063 6f6c 756d 6e20  the diff column 
-000134d0: 6472 6f70 7065 642e 0a20 2020 2020 2020  dropped..       
-000134e0: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
-000134f0: 6574 7570 0a20 2020 2020 2020 2069 6e73  etup.        ins
-00013500: 7461 6e63 6520 3d20 5363 616c 6172 496e  tance = ScalarIn
-00013510: 6571 7561 6c69 7479 2863 6f6c 756d 6e5f  equality(column_
-00013520: 6e61 6d65 3d27 6127 2c20 7661 6c75 653d  name='a', value=
-00013530: 312c 2072 656c 6174 696f 6e3d 273e 3d27  1, relation='>='
-00013540: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
-00013550: 6365 2e5f 6474 7970 6520 3d20 7064 2e53  ce._dtype = pd.S
-00013560: 6572 6965 7328 5b31 5d29 2e64 7479 7065  eries([1]).dtype
-00013570: 2020 2320 6578 6163 7420 6474 7970 6520    # exact dtype 
-00013580: 2833 3220 6f72 2036 3429 2064 6570 656e  (32 or 64) depen
-00013590: 6473 206f 6e20 4f53 0a20 2020 2020 2020  ds on OS.       
-000135a0: 2069 6e73 7461 6e63 652e 5f64 6966 665f   instance._diff_
-000135b0: 636f 6c75 6d6e 5f6e 616d 6520 3d20 2761  column_name = 'a
-000135c0: 2327 0a0a 2020 2020 2020 2020 2320 5275  #'..        # Ru
-000135d0: 6e0a 2020 2020 2020 2020 7472 616e 7366  n.        transf
-000135e0: 6f72 6d65 6420 3d20 7064 2e44 6174 6146  ormed = pd.DataF
-000135f0: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
-00013600: 2020 2027 6123 273a 205b 6e70 2e6c 6f67     'a#': [np.log
-00013610: 2831 292c 206e 702e 6c6f 6728 3229 2c20  (1), np.log(2), 
-00013620: 6e70 2e6c 6f67 2833 295d 2c0a 2020 2020  np.log(3)],.    
-00013630: 2020 2020 2020 2020 2763 273a 205b 372c          'c': [7,
-00013640: 2038 2c20 395d 2c0a 2020 2020 2020 2020   8, 9],.        
-00013650: 7d29 0a20 2020 2020 2020 206f 7574 203d  }).        out =
-00013660: 2069 6e73 7461 6e63 652e 7265 7665 7273   instance.revers
-00013670: 655f 7472 616e 7366 6f72 6d28 7472 616e  e_transform(tran
-00013680: 7366 6f72 6d65 6429 0a0a 2020 2020 2020  sformed)..      
-00013690: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
-000136a0: 2020 2065 7870 6563 7465 645f 6f75 7420     expected_out 
-000136b0: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
-000136c0: 0a20 2020 2020 2020 2020 2020 2027 6327  .            'c'
-000136d0: 3a20 5b37 2c20 382c 2039 5d2c 0a20 2020  : [7, 8, 9],.   
-000136e0: 2020 2020 2020 2020 2027 6127 3a20 5b31           'a': [1
-000136f0: 2c20 322c 2033 5d2c 0a20 2020 2020 2020  , 2, 3],.       
-00013700: 207d 290a 2020 2020 2020 2020 7064 2e74   }).        pd.t
-00013710: 6573 7469 6e67 2e61 7373 6572 745f 6672  esting.assert_fr
-00013720: 616d 655f 6571 7561 6c28 6f75 742c 2065  ame_equal(out, e
-00013730: 7870 6563 7465 645f 6f75 7429 0a0a 2020  xpected_out)..  
-00013740: 2020 6465 6620 7465 7374 5f72 6576 6572    def test_rever
-00013750: 7365 5f74 7261 6e73 666f 726d 5f66 6c6f  se_transform_flo
-00013760: 6174 7328 7365 6c66 293a 0a20 2020 2020  ats(self):.     
-00013770: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-00013780: 6053 6361 6c61 7249 6e65 7175 616c 6974  `ScalarInequalit
-00013790: 792e 7265 7665 7273 655f 7472 616e 7366  y.reverse_transf
-000137a0: 6f72 6d60 6020 6d65 7468 6f64 2e0a 0a20  orm`` method... 
-000137b0: 2020 2020 2020 2054 6865 206d 6574 686f         The metho
-000137c0: 6420 6973 2065 7870 6563 7465 6420 746f  d is expected to
-000137d0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-000137e0: 6170 706c 7920 616e 2065 7870 6f6e 656e  apply an exponen
-000137f0: 7469 616c 2074 6f20 7468 6520 696e 7075  tial to the inpu
-00013800: 740a 2020 2020 2020 2020 2020 2020 2d20  t.            - 
-00013810: 7375 6274 7261 6374 2031 0a20 2020 2020  subtract 1.     
-00013820: 2020 2020 2020 202d 2061 6464 2074 6865         - add the
-00013830: 2060 6076 616c 7565 6060 0a20 2020 2020   ``value``.     
-00013840: 2020 2020 2020 202d 2063 6f6e 7665 7274         - convert
-00013850: 2074 6865 206f 7574 7075 7420 746f 2066   the output to f
-00013860: 6c6f 6174 0a20 2020 2020 2020 2020 2020  loat.           
-00013870: 202d 2061 6464 2062 6163 6b20 7468 6520   - add back the 
-00013880: 6472 6f70 7065 6420 636f 6c75 6d6e 0a0a  dropped column..
-00013890: 2020 2020 2020 2020 5365 7475 703a 0a20          Setup:. 
-000138a0: 2020 2020 2020 202d 2060 605f 6469 6666         - ``_diff
-000138b0: 5f63 6f6c 756d 6e5f 6e61 6d65 203d 2027  _column_name = '
-000138c0: 6123 2760 600a 2020 2020 2020 2020 2d20  a#'``.        - 
-000138d0: 6060 5f64 7479 7065 6060 2061 7320 666c  ``_dtype`` as fl
-000138e0: 6f61 740a 2020 2020 2020 2020 496e 7075  oat.        Inpu
-000138f0: 743a 0a20 2020 2020 2020 202d 2054 6162  t:.        - Tab
-00013900: 6c65 2077 6974 6820 6120 6469 6666 2063  le with a diff c
-00013910: 6f6c 756d 6e20 7468 6174 2063 6f6e 7461  olumn that conta
-00013920: 696e 7320 7468 6520 636f 6e73 7461 6e74  ins the constant
-00013930: 206e 702e 6c6f 6728 3429 2e0a 2020 2020   np.log(4)..    
-00013940: 2020 2020 4f75 7470 7574 3a0a 2020 2020      Output:.    
-00013950: 2020 2020 2d20 5361 6d65 2074 6162 6c65      - Same table
-00013960: 2077 6974 6820 7468 6520 6869 6768 2063   with the high c
-00013970: 6f6c 756d 6e20 7265 706c 6163 6564 2062  olumn replaced b
-00013980: 7920 7468 6520 6c6f 7720 6f6e 6520 2b20  y the low one + 
-00013990: 312c 2061 7320 666c 6f61 740a 2020 2020  1, as float.    
-000139a0: 2020 2020 616e 6420 7468 6520 6469 6666      and the diff
-000139b0: 2063 6f6c 756d 6e20 6472 6f70 7065 642e   column dropped.
-000139c0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000139d0: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
-000139e0: 2020 2020 2069 6e73 7461 6e63 6520 3d20       instance = 
-000139f0: 5363 616c 6172 496e 6571 7561 6c69 7479  ScalarInequality
-00013a00: 2863 6f6c 756d 6e5f 6e61 6d65 3d27 6127  (column_name='a'
-00013a10: 2c20 7661 6c75 653d 312c 2072 656c 6174  , value=1, relat
-00013a20: 696f 6e3d 273e 3d27 290a 2020 2020 2020  ion='>=').      
-00013a30: 2020 696e 7374 616e 6365 2e5f 6474 7970    instance._dtyp
-00013a40: 6520 3d20 6e70 2e64 7479 7065 2827 666c  e = np.dtype('fl
-00013a50: 6f61 7427 290a 2020 2020 2020 2020 696e  oat').        in
-00013a60: 7374 616e 6365 2e5f 6469 6666 5f63 6f6c  stance._diff_col
-00013a70: 756d 6e5f 6e61 6d65 203d 2027 6123 270a  umn_name = 'a#'.
-00013a80: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
-00013a90: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
-00013aa0: 6564 203d 2070 642e 4461 7461 4672 616d  ed = pd.DataFram
-00013ab0: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
-00013ac0: 2761 2327 3a20 5b6e 702e 6c6f 6728 312e  'a#': [np.log(1.
-00013ad0: 3129 2c20 6e70 2e6c 6f67 2832 2e31 292c  1), np.log(2.1),
-00013ae0: 206e 702e 6c6f 6728 332e 3329 5d2c 0a20   np.log(3.3)],. 
-00013af0: 2020 2020 2020 2020 2020 2027 6327 3a20             'c': 
-00013b00: 5b37 2c20 382c 2039 5d2c 0a20 2020 2020  [7, 8, 9],.     
-00013b10: 2020 207d 290a 2020 2020 2020 2020 6f75     }).        ou
-00013b20: 7420 3d20 696e 7374 616e 6365 2e72 6576  t = instance.rev
-00013b30: 6572 7365 5f74 7261 6e73 666f 726d 2874  erse_transform(t
-00013b40: 7261 6e73 666f 726d 6564 290a 0a20 2020  ransformed)..   
-00013b50: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
-00013b60: 2020 2020 2020 6578 7065 6374 6564 5f6f        expected_o
-00013b70: 7574 203d 2070 642e 4461 7461 4672 616d  ut = pd.DataFram
-00013b80: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
-00013b90: 2763 273a 205b 372c 2038 2c20 395d 2c0a  'c': [7, 8, 9],.
-00013ba0: 2020 2020 2020 2020 2020 2020 2761 273a              'a':
-00013bb0: 205b 312e 312c 2032 2e31 2c20 332e 335d   [1.1, 2.1, 3.3]
-00013bc0: 2c0a 2020 2020 2020 2020 7d29 0a20 2020  ,.        }).   
-00013bd0: 2020 2020 2070 642e 7465 7374 696e 672e       pd.testing.
-00013be0: 6173 7365 7274 5f66 7261 6d65 5f65 7175  assert_frame_equ
-00013bf0: 616c 286f 7574 2c20 6578 7065 6374 6564  al(out, expected
-00013c00: 5f6f 7574 290a 0a20 2020 2064 6566 2074  _out)..    def t
-00013c10: 6573 745f 7265 7665 7273 655f 7472 616e  est_reverse_tran
-00013c20: 7366 6f72 6d5f 6461 7465 7469 6d65 2873  sform_datetime(s
-00013c30: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00013c40: 2254 6573 7420 7468 6520 6060 5363 616c  "Test the ``Scal
-00013c50: 6172 496e 6571 7561 6c69 7479 2e72 6576  arInequality.rev
-00013c60: 6572 7365 5f74 7261 6e73 666f 726d 6060  erse_transform``
-00013c70: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
-00013c80: 2020 5468 6520 6d65 7468 6f64 2069 7320    The method is 
-00013c90: 6578 7065 6374 6564 2074 6f3a 0a20 2020  expected to:.   
-00013ca0: 2020 2020 2020 2020 202d 2061 7070 6c79           - apply
-00013cb0: 2061 6e20 6578 706f 6e65 6e74 6961 6c20   an exponential 
-00013cc0: 746f 2074 6865 2069 6e70 7574 0a20 2020  to the input.   
-00013cd0: 2020 2020 2020 2020 202d 2073 7562 7472           - subtr
-00013ce0: 6163 7420 310a 2020 2020 2020 2020 2020  act 1.          
-00013cf0: 2020 2d20 6164 6420 7468 6520 6060 636f    - add the ``co
-00013d00: 6c75 6d6e 5f6e 616d 6560 600a 2020 2020  lumn_name``.    
-00013d10: 2020 2020 2020 2020 2d20 636f 6e76 6572          - conver
-00013d20: 7420 7468 6520 6f75 7470 7574 2074 6f20  t the output to 
-00013d30: 6461 7465 7469 6d65 0a20 2020 2020 2020  datetime.       
-00013d40: 2020 2020 202d 2061 6464 2062 6163 6b20       - add back 
-00013d50: 7468 6520 6472 6f70 7065 6420 636f 6c75  the dropped colu
-00013d60: 6d6e 0a0a 2020 2020 2020 2020 5365 7475  mn..        Setu
-00013d70: 703a 0a20 2020 2020 2020 202d 2060 605f  p:.        - ``_
-00013d80: 6469 6666 5f63 6f6c 756d 6e5f 6e61 6d65  diff_column_name
-00013d90: 203d 2027 6123 2760 600a 2020 2020 2020   = 'a#'``.      
-00013da0: 2020 2d20 6060 5f64 7479 7065 6060 2061    - ``_dtype`` a
-00013db0: 7320 6461 7465 7469 6d65 0a20 2020 2020  s datetime.     
-00013dc0: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
-00013dd0: 2020 2d20 5461 626c 6520 7769 7468 2061    - Table with a
-00013de0: 2064 6966 6620 636f 6c75 6d6e 2074 6861   diff column tha
-00013df0: 7420 636f 6e74 6169 6e73 2074 6865 2063  t contains the c
-00013e00: 6f6e 7374 616e 7420 6e70 2e6c 6f67 2834  onstant np.log(4
-00013e10: 292e 0a20 2020 2020 2020 204f 7574 7075  )..        Outpu
-00013e20: 743a 0a20 2020 2020 2020 202d 2053 616d  t:.        - Sam
-00013e30: 6520 7461 626c 6520 7769 7468 2074 6865  e table with the
-00013e40: 2068 6967 6820 636f 6c75 6d6e 2072 6570   high column rep
-00013e50: 6c61 6365 6420 6279 2074 6865 206c 6f77  laced by the low
-00013e60: 206f 6e65 202b 2033 2c20 6173 2064 6174   one + 3, as dat
-00013e70: 6574 696d 650a 2020 2020 2020 2020 616e  etime.        an
-00013e80: 6420 7468 6520 6469 6666 2063 6f6c 756d  d the diff colum
-00013e90: 6e20 6472 6f70 7065 642e 0a20 2020 2020  n dropped..     
-00013ea0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
-00013eb0: 2053 6574 7570 0a20 2020 2020 2020 2069   Setup.        i
-00013ec0: 6e73 7461 6e63 6520 3d20 5363 616c 6172  nstance = Scalar
-00013ed0: 496e 6571 7561 6c69 7479 280a 2020 2020  Inequality(.    
-00013ee0: 2020 2020 2020 2020 636f 6c75 6d6e 5f6e          column_n
-00013ef0: 616d 653d 2761 272c 0a20 2020 2020 2020  ame='a',.       
-00013f00: 2020 2020 2076 616c 7565 3d27 3230 3230       value='2020
-00013f10: 2d30 312d 3031 5430 303a 3030 3a30 3027  -01-01T00:00:00'
-00013f20: 2c0a 2020 2020 2020 2020 2020 2020 7265  ,.            re
-00013f30: 6c61 7469 6f6e 3d27 3e3d 2729 0a20 2020  lation='>=').   
-00013f40: 2020 2020 2069 6e73 7461 6e63 652e 5f64       instance._d
-00013f50: 7479 7065 203d 206e 702e 6474 7970 6528  type = np.dtype(
-00013f60: 273c 4d38 5b6e 735d 2729 0a20 2020 2020  '<M8[ns]').     
-00013f70: 2020 2069 6e73 7461 6e63 652e 5f64 6966     instance._dif
-00013f80: 665f 636f 6c75 6d6e 5f6e 616d 6520 3d20  f_column_name = 
-00013f90: 2761 2327 0a20 2020 2020 2020 2069 6e73  'a#'.        ins
-00013fa0: 7461 6e63 652e 5f69 735f 6461 7465 7469  tance._is_dateti
-00013fb0: 6d65 203d 2054 7275 650a 0a20 2020 2020  me = True..     
-00013fc0: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
-00013fd0: 2074 7261 6e73 666f 726d 6564 203d 2070   transformed = p
-00013fe0: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-00013ff0: 2020 2020 2020 2020 2020 2761 2327 3a20            'a#': 
-00014000: 5b6e 702e 6c6f 6728 315f 3030 305f 3030  [np.log(1_000_00
-00014010: 305f 3030 3129 2c20 6e70 2e6c 6f67 2831  0_001), np.log(1
-00014020: 5f30 3030 5f30 3030 5f30 3031 295d 2c0a  _000_000_001)],.
-00014030: 2020 2020 2020 2020 2020 2020 2763 273a              'c':
-00014040: 205b 312c 2032 5d2c 0a20 2020 2020 2020   [1, 2],.       
-00014050: 207d 290a 2020 2020 2020 2020 6f75 7420   }).        out 
-00014060: 3d20 696e 7374 616e 6365 2e72 6576 6572  = instance.rever
-00014070: 7365 5f74 7261 6e73 666f 726d 2874 7261  se_transform(tra
-00014080: 6e73 666f 726d 6564 290a 0a20 2020 2020  nsformed)..     
-00014090: 2020 2023 2041 7373 6572 740a 2020 2020     # Assert.    
-000140a0: 2020 2020 6578 7065 6374 6564 5f6f 7574      expected_out
-000140b0: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-000140c0: 7b0a 2020 2020 2020 2020 2020 2020 2763  {.            'c
-000140d0: 273a 205b 312c 2032 5d2c 0a20 2020 2020  ': [1, 2],.     
-000140e0: 2020 2020 2020 2027 6127 3a20 7064 2e74         'a': pd.t
-000140f0: 6f5f 6461 7465 7469 6d65 285b 2732 3032  o_datetime(['202
-00014100: 302d 3031 2d30 3154 3030 3a30 303a 3031  0-01-01T00:00:01
-00014110: 272c 2027 3230 3230 2d30 312d 3031 5430  ', '2020-01-01T0
-00014120: 303a 3030 3a30 3127 5d29 2c0a 2020 2020  0:00:01']),.    
-00014130: 2020 2020 7d29 0a20 2020 2020 2020 2070      }).        p
-00014140: 642e 7465 7374 696e 672e 6173 7365 7274  d.testing.assert
-00014150: 5f66 7261 6d65 5f65 7175 616c 286f 7574  _frame_equal(out
-00014160: 2c20 6578 7065 6374 6564 5f6f 7574 290a  , expected_out).
-00014170: 0a20 2020 2064 6566 2074 6573 745f 7265  .    def test_re
-00014180: 7665 7273 655f 7472 616e 7366 6f72 6d5f  verse_transform_
-00014190: 6f70 6572 6174 6f72 5f6c 6573 7328 7365  operator_less(se
-000141a0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-000141b0: 5465 7374 2074 6865 2060 6053 6361 6c61  Test the ``Scala
-000141c0: 7249 6e65 7175 616c 6974 792e 7265 7665  rInequality.reve
-000141d0: 7273 655f 7472 616e 7366 6f72 6d60 6020  rse_transform`` 
-000141e0: 6d65 7468 6f64 2077 6865 6e20 6f70 6572  method when oper
-000141f0: 6174 6f72 2069 7320 6060 6e70 2e6c 6573  ator is ``np.les
-00014200: 7360 602e 2222 220a 2020 2020 2020 2020  s``.""".        
-00014210: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-00014220: 696e 7374 616e 6365 203d 2053 6361 6c61  instance = Scala
-00014230: 7249 6e65 7175 616c 6974 7928 636f 6c75  rInequality(colu
-00014240: 6d6e 5f6e 616d 653d 2761 272c 2076 616c  mn_name='a', val
-00014250: 7565 3d31 2c20 7265 6c61 7469 6f6e 3d27  ue=1, relation='
-00014260: 3c27 290a 2020 2020 2020 2020 696e 7374  <').        inst
-00014270: 616e 6365 2e5f 6474 7970 6520 3d20 6e70  ance._dtype = np
-00014280: 2e64 7479 7065 2827 666c 6f61 7427 290a  .dtype('float').
-00014290: 2020 2020 2020 2020 696e 7374 616e 6365          instance
-000142a0: 2e5f 6469 6666 5f63 6f6c 756d 6e5f 6e61  ._diff_column_na
-000142b0: 6d65 203d 2027 6123 270a 0a20 2020 2020  me = 'a#'..     
-000142c0: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
-000142d0: 2074 7261 6e73 666f 726d 6564 203d 2070   transformed = p
-000142e0: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-000142f0: 2020 2020 2020 2020 2020 2761 2327 3a20            'a#': 
-00014300: 5b6e 702e 6c6f 6728 312e 3129 2c20 6e70  [np.log(1.1), np
-00014310: 2e6c 6f67 2832 2e31 292c 206e 702e 6c6f  .log(2.1), np.lo
-00014320: 6728 332e 3329 5d2c 0a20 2020 2020 2020  g(3.3)],.       
-00014330: 2020 2020 2027 6327 3a20 5b37 2c20 382c       'c': [7, 8,
-00014340: 2039 5d2c 0a20 2020 2020 2020 207d 290a   9],.        }).
-00014350: 2020 2020 2020 2020 6f75 7420 3d20 696e          out = in
-00014360: 7374 616e 6365 2e72 6576 6572 7365 5f74  stance.reverse_t
-00014370: 7261 6e73 666f 726d 2874 7261 6e73 666f  ransform(transfo
-00014380: 726d 6564 290a 0a20 2020 2020 2020 2023  rmed)..        #
-00014390: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-000143a0: 6578 7065 6374 6564 5f6f 7574 203d 2070  expected_out = p
-000143b0: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-000143c0: 2020 2020 2020 2020 2020 2763 273a 205b            'c': [
-000143d0: 372c 2038 2c20 395d 2c0a 2020 2020 2020  7, 8, 9],.      
-000143e0: 2020 2020 2020 2761 273a 205b 302e 392c        'a': [0.9,
-000143f0: 202d 302e 312c 202d 312e 335d 2c0a 2020   -0.1, -1.3],.  
-00014400: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
-00014410: 2070 642e 7465 7374 696e 672e 6173 7365   pd.testing.asse
-00014420: 7274 5f66 7261 6d65 5f65 7175 616c 286f  rt_frame_equal(o
-00014430: 7574 2c20 6578 7065 6374 6564 5f6f 7574  ut, expected_out
-00014440: 290a 0a0a 636c 6173 7320 5465 7374 506f  )...class TestPo
-00014450: 7369 7469 7665 2829 3a0a 0a20 2020 2064  sitive():..    d
-00014460: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
-00014470: 655f 696e 7075 7473 2873 656c 6629 3a0a  e_inputs(self):.
-00014480: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-00014490: 7468 6520 6060 506f 7369 7469 7665 2e5f  the ``Positive._
-000144a0: 7661 6c69 6461 7465 5f69 6e70 7574 7360  validate_inputs`
-000144b0: 6020 6d65 7468 6f64 2e0a 0a20 2020 2020  ` method...     
-000144c0: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
-000144d0: 2020 2d20 2049 6e63 6f72 7265 6374 2070    -  Incorrect p
-000144e0: 6172 616d 6574 6572 7320 666f 7220 7468  arameters for th
-000144f0: 6520 6d65 7468 6f64 0a20 2020 2020 2020  e method.       
-00014500: 2052 6169 7365 733a 0a20 2020 2020 2020   Raises:.       
-00014510: 202d 204c 6973 7420 6f66 2056 616c 7565   - List of Value
-00014520: 4572 726f 7273 0a20 2020 2020 2020 2022  Errors.        "
-00014530: 2222 0a20 2020 2020 2020 2023 2052 756e  "".        # Run
-00014540: 202f 2041 7373 6572 740a 2020 2020 2020   / Assert.      
-00014550: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-00014560: 6973 6573 2841 6767 7265 6761 7465 436f  ises(AggregateCo
-00014570: 6e73 7472 6169 6e74 7345 7272 6f72 2920  nstraintsError) 
-00014580: 6173 2065 7272 6f72 3a0a 2020 2020 2020  as error:.      
-00014590: 2020 2020 2020 506f 7369 7469 7665 2e5f        Positive._
-000145a0: 7661 6c69 6461 7465 5f69 6e70 7574 7328  validate_inputs(
-000145b0: 6e6f 745f 636f 6c75 6d6e 5f6e 616d 653d  not_column_name=
-000145c0: 4e6f 6e65 2c20 736f 6d65 7468 696e 675f  None, something_
-000145d0: 656c 7365 3d4e 6f6e 6529 0a0a 2020 2020  else=None)..    
-000145e0: 2020 2020 6572 725f 6d73 6720 3d20 280a      err_msg = (.
-000145f0: 2020 2020 2020 2020 2020 2020 7227 4d69              r'Mi
-00014600: 7373 696e 6720 7265 7175 6972 6564 2076  ssing required v
-00014610: 616c 7565 7320 7b28 2e2a 297d 2069 6e20  alues {(.*)} in 
-00014620: 6120 506f 7369 7469 7665 2063 6f6e 7374  a Positive const
-00014630: 7261 696e 742e 270a 2020 2020 2020 2020  raint.'.        
-00014640: 2020 2020 7227 5c6e 5c6e 496e 7661 6c69      r'\n\nInvali
-00014650: 6420 7661 6c75 6573 207b 282e 2a29 7d20  d values {(.*)} 
-00014660: 6172 6520 7072 6573 656e 7420 696e 2061  are present in a
-00014670: 2050 6f73 6974 6976 6520 636f 6e73 7472   Positive constr
-00014680: 6169 6e74 2e27 0a20 2020 2020 2020 2029  aint.'.        )
-00014690: 0a20 2020 2020 2020 2067 726f 7570 7320  .        groups 
-000146a0: 3d20 7265 2e73 6561 7263 6828 6572 725f  = re.search(err_
-000146b0: 6d73 672c 2073 7472 2865 7272 6f72 2e76  msg, str(error.v
-000146c0: 616c 7565 2929 0a20 2020 2020 2020 2061  alue)).        a
-000146d0: 7373 6572 7420 6772 6f75 7073 2069 7320  ssert groups is 
-000146e0: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
-000146f0: 2061 7373 6572 7420 7374 7228 6576 616c   assert str(eval
-00014700: 2867 726f 7570 732e 6772 6f75 7028 3129  (groups.group(1)
-00014710: 2929 203d 3d20 2763 6f6c 756d 6e5f 6e61  )) == 'column_na
-00014720: 6d65 270a 2020 2020 2020 2020 6173 7365  me'.        asse
-00014730: 7274 2073 6574 2865 7661 6c28 6772 6f75  rt set(eval(grou
-00014740: 7073 2e67 726f 7570 2832 2929 2920 3d3d  ps.group(2))) ==
-00014750: 207b 2773 6f6d 6574 6869 6e67 5f65 6c73   {'something_els
-00014760: 6527 2c20 276e 6f74 5f63 6f6c 756d 6e5f  e', 'not_column_
-00014770: 6e61 6d65 277d 0a0a 2020 2020 6465 6620  name'}..    def 
-00014780: 7465 7374 5f5f 7661 6c69 6461 7465 5f6d  test__validate_m
-00014790: 6574 6164 6174 615f 636f 6c75 6d6e 7328  etadata_columns(
-000147a0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-000147b0: 2222 5465 7374 2074 6865 2060 605f 7661  ""Test the ``_va
-000147c0: 6c69 6461 7465 5f6d 6574 6164 6174 615f  lidate_metadata_
-000147d0: 636f 6c75 6d6e 7360 6020 6d65 7468 6f64  columns`` method
-000147e0: 2e0a 0a20 2020 2020 2020 2054 6865 2063  ...        The c
-000147f0: 6f6c 756d 6e20 7061 7373 6564 2069 6e20  olumn passed in 
-00014800: 636f 6c75 6d6e 5f6e 616d 6520 7368 6f75  column_name shou
-00014810: 6c64 2062 6520 696e 2074 6865 206d 6574  ld be in the met
-00014820: 6164 6174 612e 0a0a 2020 2020 2020 2020  adata...        
-00014830: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
-00014840: 2020 202d 2063 6f6c 756d 6e5f 6e61 6d65     - column_name
-00014850: 2074 6861 7420 6973 2069 6e20 7468 6520   that is in the 
-00014860: 6d65 7461 6461 7461 2e0a 0a20 2020 2020  metadata...     
-00014870: 2020 2053 6964 6520 6566 6665 6374 3a0a     Side effect:.
-00014880: 2020 2020 2020 2020 2020 2020 2d20 4e6f              - No
-00014890: 2065 7272 6f72 2073 686f 756c 6420 6265   error should be
-000148a0: 2072 6169 7365 642e 0a20 2020 2020 2020   raised..       
-000148b0: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
-000148c0: 6574 7570 0a20 2020 2020 2020 206d 6574  etup.        met
-000148d0: 6164 6174 6120 3d20 4d6f 636b 2829 0a20  adata = Mock(). 
-000148e0: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
-000148f0: 636f 6c75 6d6e 7320 3d20 7b27 6127 3a20  columns = {'a': 
-00014900: 312c 2027 6227 3a20 327d 0a0a 2020 2020  1, 'b': 2}..    
-00014910: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
-00014920: 2020 506f 7369 7469 7665 2e5f 7661 6c69    Positive._vali
-00014930: 6461 7465 5f6d 6574 6164 6174 615f 636f  date_metadata_co
-00014940: 6c75 6d6e 7328 6d65 7461 6461 7461 2c20  lumns(metadata, 
-00014950: 636f 6c75 6d6e 5f6e 616d 653d 2761 2729  column_name='a')
-00014960: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
-00014970: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-00014980: 615f 636f 6c75 6d6e 735f 7261 6973 6573  a_columns_raises
-00014990: 5f65 7272 6f72 2873 656c 6629 3a0a 2020  _error(self):.  
-000149a0: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-000149b0: 6520 6060 5f76 616c 6964 6174 655f 6d65  e ``_validate_me
-000149c0: 7461 6461 7461 5f63 6f6c 756d 6e73 6060  tadata_columns``
-000149d0: 206d 6574 686f 6427 7320 6572 726f 7220   method's error 
-000149e0: 636f 6e64 6974 696f 6e2e 0a0a 2020 2020  condition...    
-000149f0: 2020 2020 4966 2063 6f6c 756d 6e5f 6e61      If column_na
-00014a00: 6d65 2069 7320 6e6f 7420 696e 2074 6865  me is not in the
-00014a10: 206d 6574 6164 6174 612c 2061 6e20 6572   metadata, an er
-00014a20: 726f 7220 7368 6f75 6c64 2062 6520 7261  ror should be ra
-00014a30: 6973 6564 2e0a 0a20 2020 2020 2020 2049  ised...        I
-00014a40: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
-00014a50: 2020 2d20 636f 6c75 6d6e 5f6e 616d 6520    - column_name 
-00014a60: 7468 6174 2069 7320 6e6f 7420 696e 2074  that is not in t
-00014a70: 6865 206d 6574 6164 6174 612e 0a0a 2020  he metadata...  
-00014a80: 2020 2020 2020 5369 6465 2065 6666 6563        Side effec
-00014a90: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-00014aa0: 2043 6f6e 7374 7261 696e 744d 6574 6164   ConstraintMetad
-00014ab0: 6174 6145 7272 6f72 2073 686f 756c 6420  ataError should 
-00014ac0: 6265 2072 6169 7365 642e 0a20 2020 2020  be raised..     
-00014ad0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
-00014ae0: 2053 6574 7570 0a20 2020 2020 2020 206d   Setup.        m
-00014af0: 6574 6164 6174 6120 3d20 4d6f 636b 2829  etadata = Mock()
-00014b00: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
-00014b10: 612e 636f 6c75 6d6e 7320 3d20 7b27 6127  a.columns = {'a'
-00014b20: 3a20 312c 2027 6227 3a20 327d 0a0a 2020  : 1, 'b': 2}..  
-00014b30: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
-00014b40: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
-00014b50: 6520 3d20 7265 2e65 7363 6170 6528 0a20  e = re.escape(. 
-00014b60: 2020 2020 2020 2020 2020 2027 4120 506f             'A Po
-00014b70: 7369 7469 7665 2063 6f6e 7374 7261 696e  sitive constrain
-00014b80: 7420 6973 2062 6569 6e67 2061 7070 6c69  t is being appli
-00014b90: 6564 2074 6f20 696e 7661 6c69 6420 636f  ed to invalid co
-00014ba0: 6c75 6d6e 206e 616d 6573 2027 0a20 2020  lumn names '.   
-00014bb0: 2020 2020 2020 2020 2022 7b27 6327 7d2e           "{'c'}.
-00014bc0: 2054 6865 2063 6f6c 756d 6e73 206d 7573   The columns mus
-00014bd0: 7420 6578 6973 7420 696e 2074 6865 2074  t exist in the t
-00014be0: 6162 6c65 2e22 0a20 2020 2020 2020 2029  able.".        )
-00014bf0: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
-00014c00: 7465 7374 2e72 6169 7365 7328 436f 6e73  test.raises(Cons
-00014c10: 7472 6169 6e74 4d65 7461 6461 7461 4572  traintMetadataEr
-00014c20: 726f 722c 206d 6174 6368 3d65 7272 6f72  ror, match=error
-00014c30: 5f6d 6573 7361 6765 293a 0a20 2020 2020  _message):.     
-00014c40: 2020 2020 2020 2050 6f73 6974 6976 652e         Positive.
-00014c50: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
-00014c60: 7461 5f63 6f6c 756d 6e73 286d 6574 6164  ta_columns(metad
-00014c70: 6174 612c 2063 6f6c 756d 6e5f 6e61 6d65  ata, column_name
-00014c80: 3d27 6327 290a 0a20 2020 2064 6566 2074  ='c')..    def t
-00014c90: 6573 745f 5f76 616c 6964 6174 655f 6d65  est__validate_me
-00014ca0: 7461 6461 7461 5f73 7065 6369 6669 635f  tadata_specific_
-00014cb0: 746f 5f63 6f6e 7374 7261 696e 7428 7365  to_constraint(se
-00014cc0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00014cd0: 2054 6573 7420 7468 6520 6060 5f76 616c   Test the ``_val
-00014ce0: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
-00014cf0: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
-00014d00: 7261 696e 7460 6020 6d65 7468 6f64 2e0a  raint`` method..
-00014d10: 0a20 2020 2020 2020 2049 6620 7468 6520  .        If the 
-00014d20: 636f 6c75 6d6e 206e 616d 6520 7072 6f76  column name prov
-00014d30: 6964 6564 2068 6173 2061 6e20 7364 7479  ided has an sdty
-00014d40: 7065 206f 6620 6e75 6d65 7269 6361 6c2c  pe of numerical,
-00014d50: 2074 6865 6e20 6e6f 2065 7272 6f72 2073   then no error s
-00014d60: 686f 756c 640a 2020 2020 2020 2020 6265  hould.        be
-00014d70: 2072 6169 7365 642e 0a0a 2020 2020 2020   raised...      
-00014d80: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
-00014d90: 2020 2020 202d 204d 6574 6164 6174 6120       - Metadata 
-00014da0: 7769 7468 2074 6865 2063 6f6c 756d 6e27  with the column'
-00014db0: 7320 7364 7479 7065 2073 6574 2074 6f20  s sdtype set to 
-00014dc0: 6e75 6d65 7269 6361 6c2e 0a20 2020 2020  numerical..     
-00014dd0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
-00014de0: 2053 6574 7570 0a20 2020 2020 2020 206d   Setup.        m
-00014df0: 6574 6164 6174 6120 3d20 4d6f 636b 2829  etadata = Mock()
-00014e00: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
-00014e10: 612e 636f 6c75 6d6e 7320 3d20 7b0a 2020  a.columns = {.  
-00014e20: 2020 2020 2020 2020 2020 2761 273a 207b            'a': {
-00014e30: 2773 6474 7970 6527 3a20 276e 756d 6572  'sdtype': 'numer
-00014e40: 6963 616c 277d 0a20 2020 2020 2020 207d  ical'}.        }
-00014e50: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
-00014e60: 2020 2020 2020 2020 506f 7369 7469 7665          Positive
-00014e70: 2e5f 7661 6c69 6461 7465 5f6d 6574 6164  ._validate_metad
-00014e80: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
-00014e90: 636f 6e73 7472 6169 6e74 280a 2020 2020  constraint(.    
-00014ea0: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-00014eb0: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
-00014ec0: 6c75 6d6e 5f6e 616d 653d 2761 270a 2020  lumn_name='a'.  
-00014ed0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00014ee0: 2074 6573 745f 5f76 616c 6964 6174 655f   test__validate_
-00014ef0: 6d65 7461 6461 7461 5f73 7065 6369 6669  metadata_specifi
-00014f00: 635f 746f 5f63 6f6e 7374 7261 696e 745f  c_to_constraint_
-00014f10: 6572 726f 7228 7365 6c66 293a 0a20 2020  error(self):.   
-00014f20: 2020 2020 2022 2222 2054 6573 7420 7468       """ Test th
-00014f30: 6520 6060 5f76 616c 6964 6174 655f 6d65  e ``_validate_me
-00014f40: 7461 6461 7461 5f73 7065 6369 6669 635f  tadata_specific_
-00014f50: 746f 5f63 6f6e 7374 7261 696e 7460 6020  to_constraint`` 
-00014f60: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
-00014f70: 2049 6620 7468 6520 636f 6c75 6d6e 206e   If the column n
-00014f80: 616d 6520 7072 6f76 6964 6564 2064 6f65  ame provided doe
-00014f90: 7320 6e6f 7420 6861 7665 2061 6e20 7364  s not have an sd
-00014fa0: 7479 7065 206f 6620 6e75 6d65 7269 6361  type of numerica
-00014fb0: 6c2c 2074 6865 6e20 616e 2065 7272 6f72  l, then an error
-00014fc0: 2073 686f 756c 640a 2020 2020 2020 2020   should.        
-00014fd0: 6265 2072 6169 7365 642e 0a0a 2020 2020  be raised...    
-00014fe0: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
-00014ff0: 2020 2020 2020 202d 204d 6574 6164 6174         - Metadat
-00015000: 6120 7769 7468 2074 6865 2063 6f6c 756d  a with the colum
-00015010: 6e27 7320 7364 7479 7065 2073 6574 2074  n's sdtype set t
-00015020: 6f20 6461 7465 7469 6d65 2e0a 0a20 2020  o datetime...   
-00015030: 2020 2020 2053 6964 6520 6566 6665 6374       Side effect
-00015040: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-00015050: 5261 6973 6573 2043 6f6e 7374 7261 696e  Raises Constrain
-00015060: 744d 6574 6164 6174 6145 7272 6f72 0a20  tMetadataError. 
-00015070: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00015080: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
-00015090: 2020 206d 6574 6164 6174 6120 3d20 4d6f     metadata = Mo
-000150a0: 636b 2829 0a20 2020 2020 2020 206d 6574  ck().        met
-000150b0: 6164 6174 612e 636f 6c75 6d6e 7320 3d20  adata.columns = 
-000150c0: 7b0a 2020 2020 2020 2020 2020 2020 2761  {.            'a
-000150d0: 273a 207b 2773 6474 7970 6527 3a20 2764  ': {'sdtype': 'd
-000150e0: 6174 6574 696d 6527 7d0a 2020 2020 2020  atetime'}.      
-000150f0: 2020 7d0a 0a20 2020 2020 2020 2023 2052    }..        # R
-00015100: 756e 0a20 2020 2020 2020 2065 7272 6f72  un.        error
-00015110: 5f6d 6573 7361 6765 203d 2028 0a20 2020  _message = (.   
-00015120: 2020 2020 2020 2020 2027 4120 506f 7369           'A Posi
-00015130: 7469 7665 2063 6f6e 7374 7261 696e 7420  tive constraint 
-00015140: 6973 2062 6569 6e67 2061 7070 6c69 6564  is being applied
-00015150: 2074 6f20 616e 2069 6e76 616c 6964 2063   to an invalid c
-00015160: 6f6c 756d 6e20 270a 2020 2020 2020 2020  olumn '.        
-00015170: 2020 2020 2227 6127 2e20 5468 6973 2063      "'a'. This c
-00015180: 6f6e 7374 7261 696e 7420 6973 206f 6e6c  onstraint is onl
-00015190: 7920 6465 6669 6e65 6420 666f 7220 6e75  y defined for nu
-000151a0: 6d65 7269 6361 6c20 636f 6c75 6d6e 732e  merical columns.
-000151b0: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
-000151c0: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
-000151d0: 7261 6973 6573 2843 6f6e 7374 7261 696e  raises(Constrain
-000151e0: 744d 6574 6164 6174 6145 7272 6f72 2c20  tMetadataError, 
-000151f0: 6d61 7463 683d 6572 726f 725f 6d65 7373  match=error_mess
-00015200: 6167 6529 3a0a 2020 2020 2020 2020 2020  age):.          
-00015210: 2020 506f 7369 7469 7665 2e5f 7661 6c69    Positive._vali
-00015220: 6461 7465 5f6d 6574 6164 6174 615f 7370  date_metadata_sp
-00015230: 6563 6966 6963 5f74 6f5f 636f 6e73 7472  ecific_to_constr
-00015240: 6169 6e74 280a 2020 2020 2020 2020 2020  aint(.          
-00015250: 2020 2020 2020 6d65 7461 6461 7461 2c0a        metadata,.
-00015260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015270: 636f 6c75 6d6e 5f6e 616d 653d 2761 270a  column_name='a'.
-00015280: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00015290: 2020 2064 6566 2074 6573 745f 5f69 6e69     def test__ini
-000152a0: 745f 5f28 7365 6c66 293a 0a20 2020 2020  t__(self):.     
-000152b0: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-000152c0: 6050 6f73 6974 6976 652e 5f5f 696e 6974  `Positive.__init
-000152d0: 5f5f 6060 206d 6574 686f 642e 0a0a 2020  __`` method...  
-000152e0: 2020 2020 2020 456e 7375 7265 2074 6865        Ensure the
-000152f0: 2061 7474 7269 6275 7465 7320 6172 6520   attributes are 
-00015300: 636f 7272 6563 746c 7920 7365 742e 0a20  correctly set.. 
-00015310: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00015320: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
-00015330: 2069 6e73 7461 6e63 6520 3d20 506f 7369   instance = Posi
-00015340: 7469 7665 2863 6f6c 756d 6e5f 6e61 6d65  tive(column_name
-00015350: 3d27 6162 6327 290a 0a20 2020 2020 2020  ='abc')..       
-00015360: 2023 2041 7373 6572 7473 0a20 2020 2020   # Asserts.     
-00015370: 2020 2061 7373 6572 7420 696e 7374 616e     assert instan
-00015380: 6365 2e5f 7661 6c75 6520 3d3d 2030 0a20  ce._value == 0. 
-00015390: 2020 2020 2020 2061 7373 6572 7420 696e         assert in
-000153a0: 7374 616e 6365 2e5f 636f 6c75 6d6e 5f6e  stance._column_n
-000153b0: 616d 6520 3d3d 2027 6162 6327 0a20 2020  ame == 'abc'.   
-000153c0: 2020 2020 2061 7373 6572 7420 696e 7374       assert inst
-000153d0: 616e 6365 2e5f 6f70 6572 6174 6f72 203d  ance._operator =
-000153e0: 3d20 6e70 2e67 7265 6174 6572 5f65 7175  = np.greater_equ
-000153f0: 616c 0a0a 2020 2020 6465 6620 7465 7374  al..    def test
-00015400: 5f5f 696e 6974 5f5f 7374 7269 6374 5f74  __init__strict_t
-00015410: 7275 6528 7365 6c66 293a 0a20 2020 2020  rue(self):.     
-00015420: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-00015430: 6050 6f73 6974 6976 652e 5f5f 696e 6974  `Positive.__init
-00015440: 5f5f 6060 206d 6574 686f 642e 0a0a 2020  __`` method...  
-00015450: 2020 2020 2020 456e 7375 7265 2074 6865        Ensure the
-00015460: 2061 7474 7269 6275 7465 7320 6172 6520   attributes are 
-00015470: 636f 7272 6563 746c 7920 7365 7420 7768  correctly set wh
-00015480: 656e 2060 6073 7472 6963 745f 626f 756e  en ``strict_boun
-00015490: 6461 7269 6573 6060 2069 7320 5472 7565  daries`` is True
-000154a0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-000154b0: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
-000154c0: 2020 2020 696e 7374 616e 6365 203d 2050      instance = P
-000154d0: 6f73 6974 6976 6528 636f 6c75 6d6e 5f6e  ositive(column_n
-000154e0: 616d 653d 2761 6263 272c 2073 7472 6963  ame='abc', stric
-000154f0: 745f 626f 756e 6461 7269 6573 3d54 7275  t_boundaries=Tru
-00015500: 6529 0a0a 2020 2020 2020 2020 2320 4173  e)..        # As
-00015510: 7365 7274 730a 2020 2020 2020 2020 6173  serts.        as
-00015520: 7365 7274 2069 6e73 7461 6e63 652e 5f76  sert instance._v
-00015530: 616c 7565 203d 3d20 300a 2020 2020 2020  alue == 0.      
-00015540: 2020 6173 7365 7274 2069 6e73 7461 6e63    assert instanc
-00015550: 652e 5f63 6f6c 756d 6e5f 6e61 6d65 203d  e._column_name =
-00015560: 3d20 2761 6263 270a 2020 2020 2020 2020  = 'abc'.        
-00015570: 6173 7365 7274 2069 6e73 7461 6e63 652e  assert instance.
-00015580: 5f6f 7065 7261 746f 7220 3d3d 206e 702e  _operator == np.
-00015590: 6772 6561 7465 720a 0a0a 636c 6173 7320  greater...class 
-000155a0: 5465 7374 4e65 6761 7469 7665 2829 3a0a  TestNegative():.
-000155b0: 0a20 2020 2064 6566 2074 6573 745f 5f76  .    def test__v
-000155c0: 616c 6964 6174 655f 696e 7075 7473 2873  alidate_inputs(s
-000155d0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-000155e0: 2254 6573 7420 7468 6520 6060 4e65 6761  "Test the ``Nega
-000155f0: 7469 7665 2e5f 7661 6c69 6461 7465 5f69  tive._validate_i
-00015600: 6e70 7574 7360 6020 6d65 7468 6f64 2e0a  nputs`` method..
-00015610: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-00015620: 2020 2020 2020 2020 2d20 2049 6e63 6f72          -  Incor
-00015630: 7265 6374 2070 6172 616d 6574 6572 7320  rect parameters 
-00015640: 666f 7220 7468 6520 6d65 7468 6f64 0a20  for the method. 
-00015650: 2020 2020 2020 2052 6169 7365 733a 0a20         Raises:. 
-00015660: 2020 2020 2020 202d 204c 6973 7420 6f66         - List of
-00015670: 2056 616c 7565 4572 726f 7273 0a20 2020   ValueErrors.   
-00015680: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00015690: 2023 2052 756e 202f 2041 7373 6572 740a   # Run / Assert.
-000156a0: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
-000156b0: 6573 742e 7261 6973 6573 2841 6767 7265  est.raises(Aggre
-000156c0: 6761 7465 436f 6e73 7472 6169 6e74 7345  gateConstraintsE
-000156d0: 7272 6f72 2920 6173 2065 7272 6f72 3a0a  rror) as error:.
-000156e0: 2020 2020 2020 2020 2020 2020 4e65 6761              Nega
-000156f0: 7469 7665 2e5f 7661 6c69 6461 7465 5f69  tive._validate_i
-00015700: 6e70 7574 7328 6e6f 745f 636f 6c75 6d6e  nputs(not_column
-00015710: 5f6e 616d 653d 4e6f 6e65 2c20 736f 6d65  _name=None, some
-00015720: 7468 696e 675f 656c 7365 3d4e 6f6e 6529  thing_else=None)
-00015730: 0a0a 2020 2020 2020 2020 6572 725f 6d73  ..        err_ms
-00015740: 6720 3d20 280a 2020 2020 2020 2020 2020  g = (.          
-00015750: 2020 7227 4d69 7373 696e 6720 7265 7175    r'Missing requ
-00015760: 6972 6564 2076 616c 7565 7320 7b28 2e2a  ired values {(.*
-00015770: 297d 2069 6e20 6120 4e65 6761 7469 7665  )} in a Negative
-00015780: 2063 6f6e 7374 7261 696e 742e 270a 2020   constraint.'.  
-00015790: 2020 2020 2020 2020 2020 7227 5c6e 5c6e            r'\n\n
-000157a0: 496e 7661 6c69 6420 7661 6c75 6573 207b  Invalid values {
-000157b0: 282e 2a29 7d20 6172 6520 7072 6573 656e  (.*)} are presen
-000157c0: 7420 696e 2061 204e 6567 6174 6976 6520  t in a Negative 
-000157d0: 636f 6e73 7472 6169 6e74 2e27 0a20 2020  constraint.'.   
-000157e0: 2020 2020 2029 0a20 2020 2020 2020 2067       ).        g
-000157f0: 726f 7570 7320 3d20 7265 2e73 6561 7263  roups = re.searc
-00015800: 6828 6572 725f 6d73 672c 2073 7472 2865  h(err_msg, str(e
-00015810: 7272 6f72 2e76 616c 7565 2929 0a20 2020  rror.value)).   
-00015820: 2020 2020 2061 7373 6572 7420 6772 6f75       assert grou
-00015830: 7073 2069 7320 6e6f 7420 4e6f 6e65 0a20  ps is not None. 
-00015840: 2020 2020 2020 2061 7373 6572 7420 7374         assert st
-00015850: 7228 6576 616c 2867 726f 7570 732e 6772  r(eval(groups.gr
-00015860: 6f75 7028 3129 2929 203d 3d20 2763 6f6c  oup(1))) == 'col
-00015870: 756d 6e5f 6e61 6d65 270a 2020 2020 2020  umn_name'.      
-00015880: 2020 6173 7365 7274 2073 6574 2865 7661    assert set(eva
-00015890: 6c28 6772 6f75 7073 2e67 726f 7570 2832  l(groups.group(2
-000158a0: 2929 2920 3d3d 207b 2773 6f6d 6574 6869  ))) == {'somethi
-000158b0: 6e67 5f65 6c73 6527 2c20 276e 6f74 5f63  ng_else', 'not_c
-000158c0: 6f6c 756d 6e5f 6e61 6d65 277d 0a0a 2020  olumn_name'}..  
-000158d0: 2020 6465 6620 7465 7374 5f5f 7661 6c69    def test__vali
-000158e0: 6461 7465 5f6d 6574 6164 6174 615f 636f  date_metadata_co
-000158f0: 6c75 6d6e 7328 7365 6c66 293a 0a20 2020  lumns(self):.   
-00015900: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
-00015910: 2060 605f 7661 6c69 6461 7465 5f6d 6574   ``_validate_met
-00015920: 6164 6174 615f 636f 6c75 6d6e 7360 6020  adata_columns`` 
-00015930: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
-00015940: 2054 6865 2063 6f6c 756d 6e20 7061 7373   The column pass
-00015950: 6564 2069 6e20 636f 6c75 6d6e 5f6e 616d  ed in column_nam
-00015960: 6520 7368 6f75 6c64 2062 6520 696e 2074  e should be in t
-00015970: 6865 206d 6574 6164 6174 612e 0a0a 2020  he metadata...  
-00015980: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
-00015990: 2020 2020 2020 2020 202d 2063 6f6c 756d           - colum
-000159a0: 6e5f 6e61 6d65 2074 6861 7420 6973 2069  n_name that is i
-000159b0: 6e20 7468 6520 6d65 7461 6461 7461 2e0a  n the metadata..
-000159c0: 0a20 2020 2020 2020 2053 6964 6520 6566  .        Side ef
-000159d0: 6665 6374 3a0a 2020 2020 2020 2020 2020  fect:.          
-000159e0: 2020 2d20 4e6f 2065 7272 6f72 2073 686f    - No error sho
-000159f0: 756c 6420 6265 2072 6169 7365 642e 0a20  uld be raised.. 
-00015a00: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00015a10: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
-00015a20: 2020 206d 6574 6164 6174 6120 3d20 4d6f     metadata = Mo
-00015a30: 636b 2829 0a20 2020 2020 2020 206d 6574  ck().        met
-00015a40: 6164 6174 612e 636f 6c75 6d6e 7320 3d20  adata.columns = 
-00015a50: 7b27 6127 3a20 312c 2027 6227 3a20 327d  {'a': 1, 'b': 2}
-00015a60: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
-00015a70: 2020 2020 2020 2020 4e65 6761 7469 7665          Negative
-00015a80: 2e5f 7661 6c69 6461 7465 5f6d 6574 6164  ._validate_metad
-00015a90: 6174 615f 636f 6c75 6d6e 7328 6d65 7461  ata_columns(meta
-00015aa0: 6461 7461 2c20 636f 6c75 6d6e 5f6e 616d  data, column_nam
-00015ab0: 653d 2761 2729 0a0a 2020 2020 6465 6620  e='a')..    def 
-00015ac0: 7465 7374 5f5f 7661 6c69 6461 7465 5f6d  test__validate_m
-00015ad0: 6574 6164 6174 615f 636f 6c75 6d6e 735f  etadata_columns_
-00015ae0: 7261 6973 6573 5f65 7272 6f72 2873 656c  raises_error(sel
-00015af0: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
-00015b00: 6573 7420 7468 6520 6060 5f76 616c 6964  est the ``_valid
-00015b10: 6174 655f 6d65 7461 6461 7461 5f63 6f6c  ate_metadata_col
-00015b20: 756d 6e73 6060 206d 6574 686f 6427 7320  umns`` method's 
-00015b30: 6572 726f 7220 636f 6e64 6974 696f 6e2e  error condition.
-00015b40: 0a0a 2020 2020 2020 2020 4966 2063 6f6c  ..        If col
-00015b50: 756d 6e5f 6e61 6d65 2069 7320 6e6f 7420  umn_name is not 
-00015b60: 696e 2074 6865 206d 6574 6164 6174 612c  in the metadata,
-00015b70: 2061 6e20 6572 726f 7220 7368 6f75 6c64   an error should
-00015b80: 2062 6520 7261 6973 6564 2e0a 0a20 2020   be raised...   
-00015b90: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-00015ba0: 2020 2020 2020 2020 2d20 636f 6c75 6d6e          - column
-00015bb0: 5f6e 616d 6520 7468 6174 2069 7320 6e6f  _name that is no
-00015bc0: 7420 696e 2074 6865 206d 6574 6164 6174  t in the metadat
-00015bd0: 612e 0a0a 2020 2020 2020 2020 5369 6465  a...        Side
-00015be0: 2065 6666 6563 743a 0a20 2020 2020 2020   effect:.       
-00015bf0: 2020 2020 202d 2043 6f6e 7374 7261 696e       - Constrain
-00015c00: 744d 6574 6164 6174 6145 7272 6f72 2073  tMetadataError s
-00015c10: 686f 756c 6420 6265 2072 6169 7365 642e  hould be raised.
-00015c20: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00015c30: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
-00015c40: 2020 2020 206d 6574 6164 6174 6120 3d20       metadata = 
-00015c50: 4d6f 636b 2829 0a20 2020 2020 2020 206d  Mock().        m
-00015c60: 6574 6164 6174 612e 636f 6c75 6d6e 7320  etadata.columns 
-00015c70: 3d20 7b27 6127 3a20 312c 2027 6227 3a20  = {'a': 1, 'b': 
-00015c80: 327d 0a0a 2020 2020 2020 2020 2320 5275  2}..        # Ru
-00015c90: 6e0a 2020 2020 2020 2020 6572 726f 725f  n.        error_
-00015ca0: 6d65 7373 6167 6520 3d20 7265 2e65 7363  message = re.esc
-00015cb0: 6170 6528 0a20 2020 2020 2020 2020 2020  ape(.           
-00015cc0: 2027 4120 4e65 6761 7469 7665 2063 6f6e   'A Negative con
-00015cd0: 7374 7261 696e 7420 6973 2062 6569 6e67  straint is being
-00015ce0: 2061 7070 6c69 6564 2074 6f20 696e 7661   applied to inva
-00015cf0: 6c69 6420 636f 6c75 6d6e 206e 616d 6573  lid column names
-00015d00: 2027 0a20 2020 2020 2020 2020 2020 2022   '.            "
-00015d10: 7b27 6327 7d2e 2054 6865 2063 6f6c 756d  {'c'}. The colum
-00015d20: 6e73 206d 7573 7420 6578 6973 7420 696e  ns must exist in
-00015d30: 2074 6865 2074 6162 6c65 2e22 0a20 2020   the table.".   
-00015d40: 2020 2020 2029 0a20 2020 2020 2020 2077       ).        w
-00015d50: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
-00015d60: 7328 436f 6e73 7472 6169 6e74 4d65 7461  s(ConstraintMeta
-00015d70: 6461 7461 4572 726f 722c 206d 6174 6368  dataError, match
-00015d80: 3d65 7272 6f72 5f6d 6573 7361 6765 293a  =error_message):
-00015d90: 0a20 2020 2020 2020 2020 2020 204e 6567  .            Neg
-00015da0: 6174 6976 652e 5f76 616c 6964 6174 655f  ative._validate_
-00015db0: 6d65 7461 6461 7461 5f63 6f6c 756d 6e73  metadata_columns
-00015dc0: 286d 6574 6164 6174 612c 2063 6f6c 756d  (metadata, colum
-00015dd0: 6e5f 6e61 6d65 3d27 6327 290a 0a20 2020  n_name='c')..   
-00015de0: 2064 6566 2074 6573 745f 5f76 616c 6964   def test__valid
-00015df0: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
-00015e00: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
-00015e10: 696e 7428 7365 6c66 293a 0a20 2020 2020  int(self):.     
-00015e20: 2020 2022 2222 2054 6573 7420 7468 6520     """ Test the 
-00015e30: 6060 5f76 616c 6964 6174 655f 6d65 7461  ``_validate_meta
-00015e40: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
-00015e50: 5f63 6f6e 7374 7261 696e 7460 6020 6d65  _constraint`` me
-00015e60: 7468 6f64 2e0a 0a20 2020 2020 2020 2049  thod...        I
-00015e70: 6620 7468 6520 636f 6c75 6d6e 206e 616d  f the column nam
-00015e80: 6520 7072 6f76 6964 6564 2068 6173 2061  e provided has a
-00015e90: 6e20 7364 7479 7065 206f 6620 6e75 6d65  n sdtype of nume
-00015ea0: 7269 6361 6c2c 2074 6865 6e20 6e6f 2065  rical, then no e
-00015eb0: 7272 6f72 2073 686f 756c 640a 2020 2020  rror should.    
-00015ec0: 2020 2020 6265 2072 6169 7365 642e 0a0a      be raised...
-00015ed0: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
-00015ee0: 2020 2020 2020 2020 2020 202d 204d 6574             - Met
-00015ef0: 6164 6174 6120 7769 7468 2074 6865 2063  adata with the c
-00015f00: 6f6c 756d 6e27 7320 7364 7479 7065 2073  olumn's sdtype s
-00015f10: 6574 2074 6f20 6e75 6d65 7269 6361 6c2e  et to numerical.
-00015f20: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00015f30: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
-00015f40: 2020 2020 206d 6574 6164 6174 6120 3d20       metadata = 
-00015f50: 4d6f 636b 2829 0a20 2020 2020 2020 206d  Mock().        m
-00015f60: 6574 6164 6174 612e 636f 6c75 6d6e 7320  etadata.columns 
-00015f70: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-00015f80: 2761 273a 207b 2773 6474 7970 6527 3a20  'a': {'sdtype': 
-00015f90: 276e 756d 6572 6963 616c 277d 0a20 2020  'numerical'}.   
-00015fa0: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
-00015fb0: 2320 5275 6e0a 2020 2020 2020 2020 506f  # Run.        Po
-00015fc0: 7369 7469 7665 2e5f 7661 6c69 6461 7465  sitive._validate
-00015fd0: 5f6d 6574 6164 6174 615f 7370 6563 6966  _metadata_specif
-00015fe0: 6963 5f74 6f5f 636f 6e73 7472 6169 6e74  ic_to_constraint
-00015ff0: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
-00016000: 7461 6461 7461 2c0a 2020 2020 2020 2020  tadata,.        
-00016010: 2020 2020 636f 6c75 6d6e 5f6e 616d 653d      column_name=
-00016020: 2761 270a 2020 2020 2020 2020 290a 0a20  'a'.        ).. 
-00016030: 2020 2064 6566 2074 6573 745f 5f76 616c     def test__val
-00016040: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
-00016050: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
-00016060: 7261 696e 745f 6572 726f 7228 7365 6c66  raint_error(self
-00016070: 293a 0a20 2020 2020 2020 2022 2222 2054  ):.        """ T
-00016080: 6573 7420 7468 6520 6060 5f76 616c 6964  est the ``_valid
-00016090: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
-000160a0: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
-000160b0: 696e 7460 6020 6d65 7468 6f64 2e0a 0a20  int`` method... 
-000160c0: 2020 2020 2020 2049 6620 7468 6520 636f         If the co
-000160d0: 6c75 6d6e 206e 616d 6520 7072 6f76 6964  lumn name provid
-000160e0: 6564 2064 6f65 7320 6e6f 7420 6861 7665  ed does not have
-000160f0: 2061 6e20 7364 7479 7065 206f 6620 6e75   an sdtype of nu
-00016100: 6d65 7269 6361 6c2c 2074 6865 6e20 616e  merical, then an
-00016110: 2065 7272 6f72 2073 686f 756c 640a 2020   error should.  
-00016120: 2020 2020 2020 6265 2072 6169 7365 642e        be raised.
-00016130: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
-00016140: 0a20 2020 2020 2020 2020 2020 202d 204d  .            - M
-00016150: 6574 6164 6174 6120 7769 7468 2074 6865  etadata with the
-00016160: 2063 6f6c 756d 6e27 7320 7364 7479 7065   column's sdtype
-00016170: 2073 6574 2074 6f20 6461 7465 7469 6d65   set to datetime
-00016180: 2e0a 0a20 2020 2020 2020 2053 6964 6520  ...        Side 
-00016190: 6566 6665 6374 3a0a 2020 2020 2020 2020  effect:.        
-000161a0: 2020 2020 2d20 5261 6973 6573 2043 6f6e      - Raises Con
-000161b0: 7374 7261 696e 744d 6574 6164 6174 6145  straintMetadataE
-000161c0: 7272 6f72 0a20 2020 2020 2020 2022 2222  rror.        """
-000161d0: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-000161e0: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
-000161f0: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
-00016200: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
-00016210: 6d6e 7320 3d20 7b0a 2020 2020 2020 2020  mns = {.        
-00016220: 2020 2020 2761 273a 207b 2773 6474 7970      'a': {'sdtyp
-00016230: 6527 3a20 2764 6174 6574 696d 6527 7d0a  e': 'datetime'}.
-00016240: 2020 2020 2020 2020 7d0a 0a20 2020 2020          }..     
-00016250: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
-00016260: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-00016270: 2028 0a20 2020 2020 2020 2020 2020 2027   (.            '
-00016280: 4120 4e65 6761 7469 7665 2063 6f6e 7374  A Negative const
-00016290: 7261 696e 7420 6973 2062 6569 6e67 2061  raint is being a
-000162a0: 7070 6c69 6564 2074 6f20 616e 2069 6e76  pplied to an inv
-000162b0: 616c 6964 2063 6f6c 756d 6e20 270a 2020  alid column '.  
-000162c0: 2020 2020 2020 2020 2020 2227 6127 2e20            "'a'. 
-000162d0: 5468 6973 2063 6f6e 7374 7261 696e 7420  This constraint 
-000162e0: 6973 206f 6e6c 7920 6465 6669 6e65 6420  is only defined 
-000162f0: 666f 7220 6e75 6d65 7269 6361 6c20 636f  for numerical co
-00016300: 6c75 6d6e 732e 220a 2020 2020 2020 2020  lumns.".        
-00016310: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
-00016320: 7974 6573 742e 7261 6973 6573 2843 6f6e  ytest.raises(Con
-00016330: 7374 7261 696e 744d 6574 6164 6174 6145  straintMetadataE
-00016340: 7272 6f72 2c20 6d61 7463 683d 6572 726f  rror, match=erro
-00016350: 725f 6d65 7373 6167 6529 3a0a 2020 2020  r_message):.    
-00016360: 2020 2020 2020 2020 4e65 6761 7469 7665          Negative
-00016370: 2e5f 7661 6c69 6461 7465 5f6d 6574 6164  ._validate_metad
-00016380: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
-00016390: 636f 6e73 7472 6169 6e74 280a 2020 2020  constraint(.    
-000163a0: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-000163b0: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
-000163c0: 2020 2020 2020 636f 6c75 6d6e 5f6e 616d        column_nam
-000163d0: 653d 2761 270a 2020 2020 2020 2020 2020  e='a'.          
-000163e0: 2020 290a 0a20 2020 2064 6566 2074 6573    )..    def tes
-000163f0: 745f 5f69 6e69 745f 5f28 7365 6c66 293a  t__init__(self):
-00016400: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-00016410: 2074 6865 2060 604e 6567 6174 6976 652e   the ``Negative.
-00016420: 5f5f 696e 6974 5f5f 6060 206d 6574 686f  __init__`` metho
-00016430: 642e 0a0a 2020 2020 2020 2020 456e 7375  d...        Ensu
-00016440: 7265 2074 6865 2061 7474 7269 6275 7465  re the attribute
-00016450: 7320 6172 6520 636f 7272 6563 746c 7920  s are correctly 
-00016460: 7365 742e 0a20 2020 2020 2020 2022 2222  set..        """
-00016470: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
-00016480: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
-00016490: 3d20 4e65 6761 7469 7665 2863 6f6c 756d  = Negative(colum
-000164a0: 6e5f 6e61 6d65 3d27 6162 6327 290a 0a20  n_name='abc').. 
-000164b0: 2020 2020 2020 2023 2041 7373 6572 7473         # Asserts
-000164c0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-000164d0: 696e 7374 616e 6365 2e5f 7661 6c75 6520  instance._value 
-000164e0: 3d3d 2030 0a20 2020 2020 2020 2061 7373  == 0.        ass
-000164f0: 6572 7420 696e 7374 616e 6365 2e5f 636f  ert instance._co
-00016500: 6c75 6d6e 5f6e 616d 6520 3d3d 2027 6162  lumn_name == 'ab
-00016510: 6327 0a20 2020 2020 2020 2061 7373 6572  c'.        asser
-00016520: 7420 696e 7374 616e 6365 2e5f 6f70 6572  t instance._oper
-00016530: 6174 6f72 203d 3d20 6e70 2e6c 6573 735f  ator == np.less_
-00016540: 6571 7561 6c0a 0a20 2020 2064 6566 2074  equal..    def t
-00016550: 6573 745f 5f69 6e69 745f 5f73 7472 6963  est__init__stric
-00016560: 745f 7472 7565 2873 656c 6629 3a0a 2020  t_true(self):.  
-00016570: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-00016580: 6520 6060 4e65 6761 7469 7665 2e5f 5f69  e ``Negative.__i
-00016590: 6e69 745f 5f60 6020 6d65 7468 6f64 2e0a  nit__`` method..
-000165a0: 0a20 2020 2020 2020 2045 6e73 7572 6520  .        Ensure 
-000165b0: 7468 6520 6174 7472 6962 7574 6573 2061  the attributes a
-000165c0: 7265 2063 6f72 7265 6374 6c79 2073 6574  re correctly set
-000165d0: 2077 6865 6e20 6060 7374 7269 6374 5f62   when ``strict_b
-000165e0: 6f75 6e64 6172 6965 7360 6020 6973 2054  oundaries`` is T
-000165f0: 7275 652e 0a20 2020 2020 2020 2022 2222  rue..        """
-00016600: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
-00016610: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
-00016620: 3d20 4e65 6761 7469 7665 2863 6f6c 756d  = Negative(colum
-00016630: 6e5f 6e61 6d65 3d27 6162 6327 2c20 7374  n_name='abc', st
-00016640: 7269 6374 5f62 6f75 6e64 6172 6965 733d  rict_boundaries=
-00016650: 5472 7565 290a 0a20 2020 2020 2020 2023  True)..        #
-00016660: 2041 7373 6572 7473 0a20 2020 2020 2020   Asserts.       
-00016670: 2061 7373 6572 7420 696e 7374 616e 6365   assert instance
-00016680: 2e5f 7661 6c75 6520 3d3d 2030 0a20 2020  ._value == 0.   
-00016690: 2020 2020 2061 7373 6572 7420 696e 7374       assert inst
-000166a0: 616e 6365 2e5f 636f 6c75 6d6e 5f6e 616d  ance._column_nam
-000166b0: 6520 3d3d 2027 6162 6327 0a20 2020 2020  e == 'abc'.     
-000166c0: 2020 2061 7373 6572 7420 696e 7374 616e     assert instan
-000166d0: 6365 2e5f 6f70 6572 6174 6f72 203d 3d20  ce._operator == 
-000166e0: 6e70 2e6c 6573 730a 0a0a 636c 6173 7320  np.less...class 
-000166f0: 5465 7374 5261 6e67 6528 293a 0a0a 2020  TestRange():..  
-00016700: 2020 6465 6620 7465 7374 5f5f 7661 6c69    def test__vali
-00016710: 6461 7465 5f69 6e70 7574 7328 7365 6c66  date_inputs(self
-00016720: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-00016730: 7374 2074 6865 2060 6052 616e 6765 2e5f  st the ``Range._
-00016740: 7661 6c69 6461 7465 5f69 6e70 7574 7360  validate_inputs`
-00016750: 6020 6d65 7468 6f64 2e0a 0a20 2020 2020  ` method...     
-00016760: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
-00016770: 2020 2d20 2049 6e63 6f72 7265 6374 2070    -  Incorrect p
-00016780: 6172 616d 6574 6572 7320 666f 7220 7468  arameters for th
-00016790: 6520 6d65 7468 6f64 0a20 2020 2020 2020  e method.       
-000167a0: 2052 6169 7365 733a 0a20 2020 2020 2020   Raises:.       
-000167b0: 202d 204c 6973 7420 6f66 2056 616c 7565   - List of Value
-000167c0: 4572 726f 7273 0a20 2020 2020 2020 2022  Errors.        "
-000167d0: 2222 0a20 2020 2020 2020 2023 2052 756e  "".        # Run
-000167e0: 202f 2041 7373 6572 740a 2020 2020 2020   / Assert.      
-000167f0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
-00016800: 6973 6573 2841 6767 7265 6761 7465 436f  ises(AggregateCo
-00016810: 6e73 7472 6169 6e74 7345 7272 6f72 2920  nstraintsError) 
-00016820: 6173 2065 7272 6f72 3a0a 2020 2020 2020  as error:.      
-00016830: 2020 2020 2020 5261 6e67 652e 5f76 616c        Range._val
-00016840: 6964 6174 655f 696e 7075 7473 286e 6f74  idate_inputs(not
-00016850: 5f68 6967 685f 636f 6c75 6d6e 3d4e 6f6e  _high_column=Non
-00016860: 652c 206e 6f74 5f6c 6f77 5f63 6f6c 756d  e, not_low_colum
-00016870: 6e3d 4e6f 6e65 290a 0a20 2020 2020 2020  n=None)..       
-00016880: 2065 7272 5f6d 7367 203d 2028 0a20 2020   err_msg = (.   
-00016890: 2020 2020 2020 2020 2072 274d 6973 7369           r'Missi
-000168a0: 6e67 2072 6571 7569 7265 6420 7661 6c75  ng required valu
-000168b0: 6573 207b 282e 2a29 7d20 696e 2061 2052  es {(.*)} in a R
-000168c0: 616e 6765 2063 6f6e 7374 7261 696e 742e  ange constraint.
-000168d0: 270a 2020 2020 2020 2020 2020 2020 7227  '.            r'
-000168e0: 5c6e 5c6e 496e 7661 6c69 6420 7661 6c75  \n\nInvalid valu
-000168f0: 6573 207b 282e 2a29 7d20 6172 6520 7072  es {(.*)} are pr
-00016900: 6573 656e 7420 696e 2061 2052 616e 6765  esent in a Range
-00016910: 2063 6f6e 7374 7261 696e 742e 270a 2020   constraint.'.  
-00016920: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00016930: 6772 6f75 7073 203d 2072 652e 7365 6172  groups = re.sear
-00016940: 6368 2865 7272 5f6d 7367 2c20 7374 7228  ch(err_msg, str(
-00016950: 6572 726f 722e 7661 6c75 6529 290a 2020  error.value)).  
-00016960: 2020 2020 2020 6173 7365 7274 2067 726f        assert gro
-00016970: 7570 7320 6973 206e 6f74 204e 6f6e 650a  ups is not None.
-00016980: 2020 2020 2020 2020 6173 7365 7274 2073          assert s
-00016990: 6574 2865 7661 6c28 6772 6f75 7073 2e67  et(eval(groups.g
-000169a0: 726f 7570 2831 2929 2920 3d3d 207b 0a20  roup(1))) == {. 
-000169b0: 2020 2020 2020 2020 2020 2027 6d69 6464             'midd
-000169c0: 6c65 5f63 6f6c 756d 6e5f 6e61 6d65 272c  le_column_name',
-000169d0: 2027 6869 6768 5f63 6f6c 756d 6e5f 6e61   'high_column_na
-000169e0: 6d65 272c 2027 6c6f 775f 636f 6c75 6d6e  me', 'low_column
-000169f0: 5f6e 616d 6527 0a20 2020 2020 2020 207d  _name'.        }
-00016a00: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00016a10: 7365 7428 6576 616c 2867 726f 7570 732e  set(eval(groups.
-00016a20: 6772 6f75 7028 3229 2929 203d 3d20 7b27  group(2))) == {'
-00016a30: 6e6f 745f 6869 6768 5f63 6f6c 756d 6e27  not_high_column'
-00016a40: 2c20 276e 6f74 5f6c 6f77 5f63 6f6c 756d  , 'not_low_colum
-00016a50: 6e27 7d0a 0a20 2020 2064 6566 2074 6573  n'}..    def tes
-00016a60: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
-00016a70: 6461 7461 5f63 6f6c 756d 6e73 2873 656c  data_columns(sel
-00016a80: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
-00016a90: 6573 7420 7468 6520 6060 5f76 616c 6964  est the ``_valid
-00016aa0: 6174 655f 6d65 7461 6461 7461 5f63 6f6c  ate_metadata_col
-00016ab0: 756d 6e73 6060 206d 6574 686f 642e 0a0a  umns`` method...
-00016ac0: 2020 2020 2020 2020 416c 6c20 6f66 2074          All of t
-00016ad0: 6865 2063 6f6c 756d 6e73 2070 6173 7365  he columns passe
-00016ae0: 6420 7368 6f75 6c64 2062 6520 696e 2074  d should be in t
-00016af0: 6865 206d 6574 6164 6174 612e 0a0a 2020  he metadata...  
-00016b00: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
-00016b10: 2020 2020 2020 2020 202d 2068 6967 685f           - high_
-00016b20: 636f 6c75 6d6e 5f6e 616d 652c 206c 6f77  column_name, low
-00016b30: 5f63 6f6c 756d 6e5f 6e61 6d65 2061 6e64  _column_name and
-00016b40: 206d 6964 646c 655f 636f 6c75 6d6e 5f6e   middle_column_n
-00016b50: 616d 6520 7468 6174 2061 7265 2061 6c6c  ame that are all
-00016b60: 2069 6e20 7468 650a 2020 2020 2020 2020   in the.        
-00016b70: 2020 2020 6d65 7461 6461 7461 2e0a 0a20      metadata... 
-00016b80: 2020 2020 2020 2053 6964 6520 6566 6665         Side effe
-00016b90: 6374 3a0a 2020 2020 2020 2020 2020 2020  ct:.            
-00016ba0: 2d20 4e6f 2065 7272 6f72 2073 686f 756c  - No error shoul
-00016bb0: 6420 6265 2072 6169 7365 642e 0a20 2020  d be raised..   
-00016bc0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00016bd0: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
-00016be0: 206d 6574 6164 6174 6120 3d20 4d6f 636b   metadata = Mock
-00016bf0: 2829 0a20 2020 2020 2020 206d 6574 6164  ().        metad
-00016c00: 6174 612e 636f 6c75 6d6e 7320 3d20 7b27  ata.columns = {'
-00016c10: 6127 3a20 312c 2027 6227 3a20 322c 2027  a': 1, 'b': 2, '
-00016c20: 6327 3a20 337d 0a0a 2020 2020 2020 2020  c': 3}..        
-00016c30: 2320 5275 6e0a 2020 2020 2020 2020 5261  # Run.        Ra
-00016c40: 6e67 652e 5f76 616c 6964 6174 655f 6d65  nge._validate_me
-00016c50: 7461 6461 7461 5f63 6f6c 756d 6e73 280a  tadata_columns(.
-00016c60: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
-00016c70: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
-00016c80: 2020 6869 6768 5f63 6f6c 756d 6e5f 6e61    high_column_na
-00016c90: 6d65 3d27 6127 2c0a 2020 2020 2020 2020  me='a',.        
-00016ca0: 2020 2020 6c6f 775f 636f 6c75 6d6e 5f6e      low_column_n
-00016cb0: 616d 653d 2762 272c 0a20 2020 2020 2020  ame='b',.       
-00016cc0: 2020 2020 206d 6964 646c 655f 636f 6c75       middle_colu
-00016cd0: 6d6e 5f6e 616d 653d 2763 270a 2020 2020  mn_name='c'.    
-00016ce0: 2020 2020 290a 0a20 2020 2064 6566 2074      )..    def t
-00016cf0: 6573 745f 5f76 616c 6964 6174 655f 6d65  est__validate_me
-00016d00: 7461 6461 7461 5f63 6f6c 756d 6e73 5f72  tadata_columns_r
-00016d10: 6169 7365 735f 6572 726f 7228 7365 6c66  aises_error(self
-00016d20: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-00016d30: 7374 2074 6865 2060 605f 7661 6c69 6461  st the ``_valida
-00016d40: 7465 5f6d 6574 6164 6174 615f 636f 6c75  te_metadata_colu
-00016d50: 6d6e 7360 6020 6d65 7468 6f64 2773 2065  mns`` method's e
-00016d60: 7272 6f72 2063 6f6e 6469 7469 6f6e 2e0a  rror condition..
-00016d70: 0a20 2020 2020 2020 2049 6620 616e 7920  .        If any 
-00016d80: 636f 6c75 6d6e 7320 7061 7373 6564 2061  columns passed a
-00016d90: 7265 206e 6f74 2069 6e20 7468 6520 6d65  re not in the me
-00016da0: 7461 6461 7461 2c20 616e 2065 7272 6f72  tadata, an error
-00016db0: 2073 686f 756c 6420 6265 2072 6169 7365   should be raise
-00016dc0: 642e 0a0a 2020 2020 2020 2020 496e 7075  d...        Inpu
-00016dd0: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-00016de0: 206c 6f77 5f63 6f6c 756d 6e5f 6e61 6d65   low_column_name
-00016df0: 2074 6861 7420 6973 206e 6f74 2069 6e20   that is not in 
-00016e00: 7468 6520 6d65 7461 6461 7461 2e0a 0a20  the metadata... 
-00016e10: 2020 2020 2020 2053 6964 6520 6566 6665         Side effe
-00016e20: 6374 3a0a 2020 2020 2020 2020 2020 2020  ct:.            
-00016e30: 2d20 436f 6e73 7472 6169 6e74 4d65 7461  - ConstraintMeta
-00016e40: 6461 7461 4572 726f 7220 7368 6f75 6c64  dataError should
-00016e50: 2062 6520 7261 6973 6564 2e0a 2020 2020   be raised..    
-00016e60: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00016e70: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-00016e80: 6d65 7461 6461 7461 203d 204d 6f63 6b28  metadata = Mock(
-00016e90: 290a 2020 2020 2020 2020 6d65 7461 6461  ).        metada
-00016ea0: 7461 2e63 6f6c 756d 6e73 203d 207b 2761  ta.columns = {'a
-00016eb0: 273a 2031 2c20 2762 273a 2032 7d0a 0a20  ': 1, 'b': 2}.. 
-00016ec0: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
-00016ed0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-00016ee0: 6765 203d 2072 652e 6573 6361 7065 280a  ge = re.escape(.
-00016ef0: 2020 2020 2020 2020 2020 2020 2741 2052              'A R
-00016f00: 616e 6765 2063 6f6e 7374 7261 696e 7420  ange constraint 
-00016f10: 6973 2062 6569 6e67 2061 7070 6c69 6564  is being applied
-00016f20: 2074 6f20 696e 7661 6c69 6420 636f 6c75   to invalid colu
-00016f30: 6d6e 206e 616d 6573 2027 0a20 2020 2020  mn names '.     
-00016f40: 2020 2020 2020 2022 7b27 6327 7d2e 2054         "{'c'}. T
-00016f50: 6865 2063 6f6c 756d 6e73 206d 7573 7420  he columns must 
-00016f60: 6578 6973 7420 696e 2074 6865 2074 6162  exist in the tab
-00016f70: 6c65 2e22 0a20 2020 2020 2020 2029 0a20  le.".        ). 
-00016f80: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
-00016f90: 7374 2e72 6169 7365 7328 436f 6e73 7472  st.raises(Constr
-00016fa0: 6169 6e74 4d65 7461 6461 7461 4572 726f  aintMetadataErro
-00016fb0: 722c 206d 6174 6368 3d65 7272 6f72 5f6d  r, match=error_m
-00016fc0: 6573 7361 6765 293a 0a20 2020 2020 2020  essage):.       
-00016fd0: 2020 2020 2052 616e 6765 2e5f 7661 6c69       Range._vali
-00016fe0: 6461 7465 5f6d 6574 6164 6174 615f 636f  date_metadata_co
-00016ff0: 6c75 6d6e 7328 0a20 2020 2020 2020 2020  lumns(.         
-00017000: 2020 2020 2020 206d 6574 6164 6174 612c         metadata,
-00017010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017020: 2068 6967 685f 636f 6c75 6d6e 5f6e 616d   high_column_nam
-00017030: 653d 2761 272c 0a20 2020 2020 2020 2020  e='a',.         
-00017040: 2020 2020 2020 206c 6f77 5f63 6f6c 756d         low_colum
-00017050: 6e5f 6e61 6d65 3d27 6227 2c0a 2020 2020  n_name='b',.    
-00017060: 2020 2020 2020 2020 2020 2020 6d69 6464              midd
-00017070: 6c65 5f63 6f6c 756d 6e5f 6e61 6d65 3d27  le_column_name='
-00017080: 6327 0a20 2020 2020 2020 2020 2020 2029  c'.            )
-00017090: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
-000170a0: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-000170b0: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
-000170c0: 6e73 7472 6169 6e74 5f64 6174 6574 696d  nstraint_datetim
-000170d0: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-000170e0: 2022 2222 5465 7374 2074 6865 2060 605f   """Test the ``_
-000170f0: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-00017100: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
-00017110: 6e73 7472 6169 6e74 6060 2077 6974 6820  nstraint`` with 
-00017120: 6461 7465 7469 6d65 732e 0a0a 2020 2020  datetimes...    
-00017130: 2020 2020 4966 2074 6865 2060 6068 6967      If the ``hig
-00017140: 685f 636f 6c75 6d6e 5f6e 616d 6560 602c  h_column_name``,
-00017150: 2060 606d 6964 646c 655f 636f 6c75 6d6e   ``middle_column
-00017160: 5f6e 616d 6560 6020 616e 6420 6060 6c6f  _name`` and ``lo
-00017170: 775f 636f 6c75 6d6e 5f6e 616d 6560 600a  w_column_name``.
-00017180: 2020 2020 2020 2020 6172 6520 6461 7465          are date
-00017190: 7469 6d65 732c 2074 6865 6e20 7468 6520  times, then the 
-000171a0: 7661 6c69 6461 7469 6f6e 2073 686f 756c  validation shoul
-000171b0: 6420 6e6f 7420 7261 6973 6520 616e 2065  d not raise an e
-000171c0: 7272 6f72 2e0a 0a20 2020 2020 2020 2049  rror...        I
-000171d0: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
-000171e0: 2020 2d20 4d65 7461 6461 7461 2077 6974    - Metadata wit
-000171f0: 6820 7364 7479 7065 7320 7365 7420 746f  h sdtypes set to
-00017200: 2064 6174 6574 696d 6520 666f 7220 7468   datetime for th
-00017210: 6520 6869 6768 2c20 6d69 6464 6c65 2061  e high, middle a
-00017220: 6e64 206c 6f77 2063 6f6c 756d 6e2e 0a20  nd low column.. 
-00017230: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00017240: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
-00017250: 2020 206d 6574 6164 6174 6120 3d20 4d6f     metadata = Mo
-00017260: 636b 2829 0a20 2020 2020 2020 206d 6574  ck().        met
-00017270: 6164 6174 612e 636f 6c75 6d6e 7320 3d20  adata.columns = 
-00017280: 7b0a 2020 2020 2020 2020 2020 2020 2761  {.            'a
-00017290: 273a 207b 2773 6474 7970 6527 3a20 2764  ': {'sdtype': 'd
-000172a0: 6174 6574 696d 6527 7d2c 0a20 2020 2020  atetime'},.     
-000172b0: 2020 2020 2020 2027 6227 3a20 7b27 7364         'b': {'sd
-000172c0: 7479 7065 273a 2027 6461 7465 7469 6d65  type': 'datetime
-000172d0: 277d 2c0a 2020 2020 2020 2020 2020 2020  '},.            
-000172e0: 2763 273a 207b 2773 6474 7970 6527 3a20  'c': {'sdtype': 
-000172f0: 2764 6174 6574 696d 6527 7d0a 2020 2020  'datetime'}.    
-00017300: 2020 2020 7d0a 0a20 2020 2020 2020 2023      }..        #
-00017310: 2052 756e 0a20 2020 2020 2020 2052 616e   Run.        Ran
-00017320: 6765 2e5f 7661 6c69 6461 7465 5f6d 6574  ge._validate_met
-00017330: 6164 6174 615f 7370 6563 6966 6963 5f74  adata_specific_t
-00017340: 6f5f 636f 6e73 7472 6169 6e74 280a 2020  o_constraint(.  
-00017350: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
-00017360: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-00017370: 6869 6768 5f63 6f6c 756d 6e5f 6e61 6d65  high_column_name
-00017380: 3d27 6127 2c0a 2020 2020 2020 2020 2020  ='a',.          
-00017390: 2020 6c6f 775f 636f 6c75 6d6e 5f6e 616d    low_column_nam
-000173a0: 653d 2762 272c 0a20 2020 2020 2020 2020  e='b',.         
-000173b0: 2020 206d 6964 646c 655f 636f 6c75 6d6e     middle_column
-000173c0: 5f6e 616d 653d 2763 270a 2020 2020 2020  _name='c'.      
-000173d0: 2020 290a 0a20 2020 2064 6566 2074 6573    )..    def tes
-000173e0: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
-000173f0: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
-00017400: 5f63 6f6e 7374 7261 696e 745f 6461 7465  _constraint_date
-00017410: 7469 6d65 5f65 7272 6f72 2873 656c 6629  time_error(self)
-00017420: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
-00017430: 7420 7468 6520 6060 5f76 616c 6964 6174  t the ``_validat
-00017440: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
-00017450: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
-00017460: 7460 6020 7769 7468 2064 6174 6574 696d  t`` with datetim
-00017470: 6573 2e0a 0a20 2020 2020 2020 2049 6620  es...        If 
-00017480: 7468 6520 6060 6869 6768 5f63 6f6c 756d  the ``high_colum
-00017490: 6e5f 6e61 6d65 6060 2c20 6060 6d69 6464  n_name``, ``midd
-000174a0: 6c65 5f63 6f6c 756d 6e5f 6e61 6d65 6060  le_column_name``
-000174b0: 2061 6e64 2060 606c 6f77 5f63 6f6c 756d   and ``low_colum
-000174c0: 6e5f 6e61 6d65 6060 0a20 2020 2020 2020  n_name``.       
-000174d0: 2061 7265 206e 6f74 2061 6c6c 2064 6174   are not all dat
-000174e0: 6574 696d 6573 2c20 7468 656e 2074 6865  etimes, then the
-000174f0: 2076 616c 6964 6174 696f 6e20 7368 6f75   validation shou
-00017500: 6c64 2072 6169 7365 2061 6e20 6572 726f  ld raise an erro
-00017510: 722e 0a0a 2020 2020 2020 2020 496e 7075  r...        Inpu
-00017520: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-00017530: 204d 6574 6164 6174 6120 7769 7468 2073   Metadata with s
-00017540: 6474 7970 6573 2073 6574 2074 6f20 6461  dtypes set to da
-00017550: 7465 7469 6d65 2066 6f72 2074 6865 2068  tetime for the h
-00017560: 6967 6820 616e 6420 6c6f 7720 636f 6c75  igh and low colu
-00017570: 6d6e 0a20 2020 2020 2020 2020 2020 2062  mn.            b
-00017580: 7574 206e 6f74 2074 6865 206d 6964 646c  ut not the middl
-00017590: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
-000175a0: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
-000175b0: 2020 2020 2020 206d 6574 6164 6174 6120         metadata 
-000175c0: 3d20 4d6f 636b 2829 0a20 2020 2020 2020  = Mock().       
-000175d0: 206d 6574 6164 6174 612e 636f 6c75 6d6e   metadata.column
-000175e0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-000175f0: 2020 2761 273a 207b 2773 6474 7970 6527    'a': {'sdtype'
-00017600: 3a20 2764 6174 6574 696d 6527 7d2c 0a20  : 'datetime'},. 
-00017610: 2020 2020 2020 2020 2020 2027 6227 3a20             'b': 
-00017620: 7b27 7364 7479 7065 273a 2027 6461 7465  {'sdtype': 'date
-00017630: 7469 6d65 277d 2c0a 2020 2020 2020 2020  time'},.        
-00017640: 2020 2020 2763 273a 207b 2773 6474 7970      'c': {'sdtyp
-00017650: 6527 3a20 276e 756d 6572 6963 616c 277d  e': 'numerical'}
-00017660: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
-00017670: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
-00017680: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-00017690: 3d20 7265 2e65 7363 6170 6528 0a20 2020  = re.escape(.   
-000176a0: 2020 2020 2020 2020 2027 4120 5261 6e67           'A Rang
-000176b0: 6520 636f 6e73 7472 6169 6e74 2069 7320  e constraint is 
-000176c0: 6265 696e 6720 6170 706c 6965 6420 746f  being applied to
-000176d0: 2063 6f6c 756d 6e73 2077 6974 6820 6d69   columns with mi
-000176e0: 736d 6174 6368 6564 2073 6474 7970 6573  smatched sdtypes
-000176f0: 2027 0a20 2020 2020 2020 2020 2020 2022   '.            "
-00017700: 5b27 6127 2c20 2763 272c 2027 6227 5d2e  ['a', 'c', 'b'].
-00017710: 2041 6c6c 2063 6f6c 756d 6e73 206d 7573   All columns mus
-00017720: 7420 6265 2065 6974 6865 7220 6e75 6d65  t be either nume
-00017730: 7269 6361 6c20 6f72 2064 6174 6574 696d  rical or datetim
-00017740: 652e 220a 2020 2020 2020 2020 290a 2020  e.".        ).  
-00017750: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
-00017760: 742e 7261 6973 6573 2843 6f6e 7374 7261  t.raises(Constra
-00017770: 696e 744d 6574 6164 6174 6145 7272 6f72  intMetadataError
-00017780: 2c20 6d61 7463 683d 6572 726f 725f 6d65  , match=error_me
-00017790: 7373 6167 6529 3a0a 2020 2020 2020 2020  ssage):.        
-000177a0: 2020 2020 5261 6e67 652e 5f76 616c 6964      Range._valid
-000177b0: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
-000177c0: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
-000177d0: 696e 7428 0a20 2020 2020 2020 2020 2020  int(.           
-000177e0: 2020 2020 206d 6574 6164 6174 612c 0a20       metadata,. 
-000177f0: 2020 2020 2020 2020 2020 2020 2020 2068                 h
-00017800: 6967 685f 636f 6c75 6d6e 5f6e 616d 653d  igh_column_name=
-00017810: 2761 272c 0a20 2020 2020 2020 2020 2020  'a',.           
-00017820: 2020 2020 206c 6f77 5f63 6f6c 756d 6e5f       low_column_
-00017830: 6e61 6d65 3d27 6227 2c0a 2020 2020 2020  name='b',.      
-00017840: 2020 2020 2020 2020 2020 6d69 6464 6c65            middle
-00017850: 5f63 6f6c 756d 6e5f 6e61 6d65 3d27 6327  _column_name='c'
-00017860: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00017870: 2020 2020 6465 6620 7465 7374 5f5f 7661      def test__va
-00017880: 6c69 6461 7465 5f6d 6574 6164 6174 615f  lidate_metadata_
-00017890: 7370 6563 6966 6963 5f74 6f5f 636f 6e73  specific_to_cons
-000178a0: 7472 6169 6e74 5f6e 756d 6572 6963 616c  traint_numerical
-000178b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000178c0: 2222 2254 6573 7420 7468 6520 6060 5f76  """Test the ``_v
-000178d0: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
-000178e0: 5f73 7065 6369 6669 635f 746f 5f63 6f6e  _specific_to_con
-000178f0: 7374 7261 696e 7460 6020 7769 7468 206e  straint`` with n
-00017900: 756d 6572 6963 616c 2e0a 0a20 2020 2020  umerical...     
-00017910: 2020 2049 6620 7468 6520 6060 6869 6768     If the ``high
-00017920: 5f63 6f6c 756d 6e5f 6e61 6d65 6060 2c20  _column_name``, 
-00017930: 6060 6d69 6464 6c65 5f63 6f6c 756d 6e5f  ``middle_column_
-00017940: 6e61 6d65 6060 2061 6e64 2060 606c 6f77  name`` and ``low
-00017950: 5f63 6f6c 756d 6e5f 6e61 6d65 6060 0a20  _column_name``. 
-00017960: 2020 2020 2020 2061 7265 206e 756d 6572         are numer
-00017970: 6963 616c 2c20 7468 656e 2074 6865 2076  ical, then the v
-00017980: 616c 6964 6174 696f 6e20 7368 6f75 6c64  alidation should
-00017990: 206e 6f74 2072 6169 7365 2061 6e20 6572   not raise an er
-000179a0: 726f 722e 0a0a 2020 2020 2020 2020 496e  ror...        In
-000179b0: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
-000179c0: 202d 204d 6574 6164 6174 6120 7769 7468   - Metadata with
-000179d0: 2073 6474 7970 6573 2073 6574 2074 6f20   sdtypes set to 
-000179e0: 6e75 6d65 7269 6361 6c20 666f 7220 7468  numerical for th
-000179f0: 6520 6869 6768 2c20 6d69 6464 6c65 2061  e high, middle a
-00017a00: 6e64 206c 6f77 2063 6f6c 756d 6e2e 0a20  nd low column.. 
-00017a10: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00017a20: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
-00017a30: 2020 206d 6574 6164 6174 6120 3d20 4d6f     metadata = Mo
-00017a40: 636b 2829 0a20 2020 2020 2020 206d 6574  ck().        met
-00017a50: 6164 6174 612e 636f 6c75 6d6e 7320 3d20  adata.columns = 
-00017a60: 7b0a 2020 2020 2020 2020 2020 2020 2761  {.            'a
-00017a70: 273a 207b 2773 6474 7970 6527 3a20 276e  ': {'sdtype': 'n
-00017a80: 756d 6572 6963 616c 277d 2c0a 2020 2020  umerical'},.    
-00017a90: 2020 2020 2020 2020 2762 273a 207b 2773          'b': {'s
-00017aa0: 6474 7970 6527 3a20 276e 756d 6572 6963  dtype': 'numeric
-00017ab0: 616c 277d 2c0a 2020 2020 2020 2020 2020  al'},.          
-00017ac0: 2020 2763 273a 207b 2773 6474 7970 6527    'c': {'sdtype'
-00017ad0: 3a20 276e 756d 6572 6963 616c 277d 0a20  : 'numerical'}. 
-00017ae0: 2020 2020 2020 207d 0a0a 2020 2020 2020         }..      
-00017af0: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
-00017b00: 5261 6e67 652e 5f76 616c 6964 6174 655f  Range._validate_
-00017b10: 6d65 7461 6461 7461 5f73 7065 6369 6669  metadata_specifi
-00017b20: 635f 746f 5f63 6f6e 7374 7261 696e 7428  c_to_constraint(
-00017b30: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-00017b40: 6164 6174 612c 0a20 2020 2020 2020 2020  adata,.         
-00017b50: 2020 2068 6967 685f 636f 6c75 6d6e 5f6e     high_column_n
-00017b60: 616d 653d 2761 272c 0a20 2020 2020 2020  ame='a',.       
-00017b70: 2020 2020 206c 6f77 5f63 6f6c 756d 6e5f       low_column_
-00017b80: 6e61 6d65 3d27 6227 2c0a 2020 2020 2020  name='b',.      
-00017b90: 2020 2020 2020 6d69 6464 6c65 5f63 6f6c        middle_col
-00017ba0: 756d 6e5f 6e61 6d65 3d27 6327 0a20 2020  umn_name='c'.   
-00017bb0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-00017bc0: 7465 7374 5f5f 7661 6c69 6461 7465 5f6d  test__validate_m
-00017bd0: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
-00017be0: 5f74 6f5f 636f 6e73 7472 6169 6e74 5f6e  _to_constraint_n
-00017bf0: 756d 6572 6963 616c 5f65 7272 6f72 2873  umerical_error(s
-00017c00: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00017c10: 2254 6573 7420 7468 6520 6060 5f76 616c  "Test the ``_val
-00017c20: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
-00017c30: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
-00017c40: 7261 696e 7460 6020 7769 7468 206e 756d  raint`` with num
-00017c50: 6572 6963 616c 2e0a 0a20 2020 2020 2020  erical...       
-00017c60: 2049 6620 7468 6520 6060 6869 6768 5f63   If the ``high_c
-00017c70: 6f6c 756d 6e5f 6e61 6d65 6060 2c20 6060  olumn_name``, ``
-00017c80: 6d69 6464 6c65 5f63 6f6c 756d 6e5f 6e61  middle_column_na
-00017c90: 6d65 6060 2061 6e64 2060 606c 6f77 5f63  me`` and ``low_c
-00017ca0: 6f6c 756d 6e5f 6e61 6d65 6060 0a20 2020  olumn_name``.   
-00017cb0: 2020 2020 2061 7265 206e 6f74 2061 6c6c       are not all
-00017cc0: 206e 756d 6572 6963 616c 2c20 7468 656e   numerical, then
-00017cd0: 2074 6865 2076 616c 6964 6174 696f 6e20   the validation 
-00017ce0: 7368 6f75 6c64 2072 6169 7365 2061 6e20  should raise an 
-00017cf0: 6572 726f 722e 0a0a 2020 2020 2020 2020  error...        
-00017d00: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
-00017d10: 2020 202d 204d 6574 6164 6174 6120 7769     - Metadata wi
-00017d20: 7468 2073 6474 7970 6573 2073 6574 2074  th sdtypes set t
-00017d30: 6f20 6e75 6d65 7269 6361 6c20 666f 7220  o numerical for 
-00017d40: 7468 6520 6869 6768 2061 6e64 206c 6f77  the high and low
-00017d50: 2063 6f6c 756d 6e0a 2020 2020 2020 2020   column.        
-00017d60: 2020 2020 6275 7420 6e6f 7420 7468 6520      but not the 
-00017d70: 6d69 6464 6c65 2e0a 2020 2020 2020 2020  middle..        
-00017d80: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
-00017d90: 7475 700a 2020 2020 2020 2020 6d65 7461  tup.        meta
-00017da0: 6461 7461 203d 204d 6f63 6b28 290a 2020  data = Mock().  
-00017db0: 2020 2020 2020 6d65 7461 6461 7461 2e63        metadata.c
-00017dc0: 6f6c 756d 6e73 203d 207b 0a20 2020 2020  olumns = {.     
-00017dd0: 2020 2020 2020 2027 6127 3a20 7b27 7364         'a': {'sd
-00017de0: 7479 7065 273a 2027 6e75 6d65 7269 6361  type': 'numerica
-00017df0: 6c27 7d2c 0a20 2020 2020 2020 2020 2020  l'},.           
-00017e00: 2027 6227 3a20 7b27 7364 7479 7065 273a   'b': {'sdtype':
-00017e10: 2027 6e75 6d65 7269 6361 6c27 7d2c 0a20   'numerical'},. 
-00017e20: 2020 2020 2020 2020 2020 2027 6327 3a20             'c': 
-00017e30: 7b27 7364 7479 7065 273a 2027 6461 7465  {'sdtype': 'date
-00017e40: 7469 6d65 277d 0a20 2020 2020 2020 207d  time'}.        }
-00017e50: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
-00017e60: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-00017e70: 7373 6167 6520 3d20 7265 2e65 7363 6170  ssage = re.escap
-00017e80: 6528 0a20 2020 2020 2020 2020 2020 2027  e(.            '
-00017e90: 4120 5261 6e67 6520 636f 6e73 7472 6169  A Range constrai
-00017ea0: 6e74 2069 7320 6265 696e 6720 6170 706c  nt is being appl
-00017eb0: 6965 6420 746f 2063 6f6c 756d 6e73 2077  ied to columns w
-00017ec0: 6974 6820 6d69 736d 6174 6368 6564 2073  ith mismatched s
-00017ed0: 6474 7970 6573 2027 0a20 2020 2020 2020  dtypes '.       
-00017ee0: 2020 2020 2022 5b27 6127 2c20 2763 272c       "['a', 'c',
-00017ef0: 2027 6227 5d2e 2041 6c6c 2063 6f6c 756d   'b']. All colum
-00017f00: 6e73 206d 7573 7420 6265 2065 6974 6865  ns must be eithe
-00017f10: 7220 6e75 6d65 7269 6361 6c20 6f72 2064  r numerical or d
-00017f20: 6174 6574 696d 652e 220a 2020 2020 2020  atetime.".      
-00017f30: 2020 290a 2020 2020 2020 2020 7769 7468    ).        with
-00017f40: 2070 7974 6573 742e 7261 6973 6573 2843   pytest.raises(C
-00017f50: 6f6e 7374 7261 696e 744d 6574 6164 6174  onstraintMetadat
-00017f60: 6145 7272 6f72 2c20 6d61 7463 683d 6572  aError, match=er
-00017f70: 726f 725f 6d65 7373 6167 6529 3a0a 2020  ror_message):.  
-00017f80: 2020 2020 2020 2020 2020 5261 6e67 652e            Range.
-00017f90: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
-00017fa0: 7461 5f73 7065 6369 6669 635f 746f 5f63  ta_specific_to_c
-00017fb0: 6f6e 7374 7261 696e 7428 0a20 2020 2020  onstraint(.     
-00017fc0: 2020 2020 2020 2020 2020 206d 6574 6164             metad
-00017fd0: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
-00017fe0: 2020 2020 2068 6967 685f 636f 6c75 6d6e       high_column
-00017ff0: 5f6e 616d 653d 2761 272c 0a20 2020 2020  _name='a',.     
-00018000: 2020 2020 2020 2020 2020 206c 6f77 5f63             low_c
-00018010: 6f6c 756d 6e5f 6e61 6d65 3d27 6227 2c0a  olumn_name='b',.
-00018020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018030: 6d69 6464 6c65 5f63 6f6c 756d 6e5f 6e61  middle_column_na
-00018040: 6d65 3d27 6327 0a20 2020 2020 2020 2020  me='c'.         
-00018050: 2020 2029 0a0a 2020 2020 6465 6620 7465     )..    def te
-00018060: 7374 5f5f 5f69 6e69 745f 5f28 7365 6c66  st___init__(self
-00018070: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-00018080: 7374 2074 6865 2060 6052 616e 6765 2e5f  st the ``Range._
-00018090: 5f69 6e69 745f 5f60 6020 6d65 7468 6f64  _init__`` method
-000180a0: 2e0a 0a20 2020 2020 2020 2054 6865 2069  ...        The i
-000180b0: 6e73 7461 6e63 6520 7368 6f75 6c64 2063  nstance should c
-000180c0: 6f6e 7461 696e 2074 6865 206e 616d 6520  ontain the name 
-000180d0: 6f66 2074 6865 2074 6872 6565 2070 6173  of the three pas
-000180e0: 7365 6420 636f 6c75 6d6e 7320 616e 6420  sed columns and 
-000180f0: 616c 736f 0a20 2020 2020 2020 2075 7365  also.        use
-00018100: 2061 6e20 6f70 6572 6174 6f72 2060 603c   an operator ``<
-00018110: 6060 2069 6620 6060 7374 7269 6374 5f62  `` if ``strict_b
-00018120: 6f75 6e64 6172 6965 7360 6020 6973 2060  oundaries`` is `
-00018130: 6054 7275 6560 6020 6279 2064 6566 6175  `True`` by defau
-00018140: 6c74 2e0a 2020 2020 2020 2020 496e 7075  lt..        Inpu
-00018150: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-00018160: 2054 6872 6565 2063 6f6c 756d 6e20 6e61   Three column na
-00018170: 6d65 732e 0a20 2020 2020 2020 2022 2222  mes..        """
-00018180: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
-00018190: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
-000181a0: 3d20 5261 6e67 6528 2761 6765 5f77 6865  = Range('age_whe
-000181b0: 6e5f 6a6f 696e 6564 272c 2027 6375 7272  n_joined', 'curr
-000181c0: 656e 745f 6167 6527 2c20 2772 6574 6972  ent_age', 'retir
-000181d0: 656d 656e 745f 6167 6527 290a 0a20 2020  ement_age')..   
-000181e0: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
-000181f0: 2020 2020 2020 6173 7365 7274 2069 6e73        assert ins
-00018200: 7461 6e63 652e 6c6f 775f 636f 6c75 6d6e  tance.low_column
-00018210: 5f6e 616d 6520 3d3d 2027 6167 655f 7768  _name == 'age_wh
-00018220: 656e 5f6a 6f69 6e65 6427 0a20 2020 2020  en_joined'.     
-00018230: 2020 2061 7373 6572 7420 696e 7374 616e     assert instan
-00018240: 6365 2e6d 6964 646c 655f 636f 6c75 6d6e  ce.middle_column
-00018250: 5f6e 616d 6520 3d3d 2027 6375 7272 656e  _name == 'curren
-00018260: 745f 6167 6527 0a20 2020 2020 2020 2061  t_age'.        a
-00018270: 7373 6572 7420 696e 7374 616e 6365 2e68  ssert instance.h
-00018280: 6967 685f 636f 6c75 6d6e 5f6e 616d 6520  igh_column_name 
-00018290: 3d3d 2027 7265 7469 7265 6d65 6e74 5f61  == 'retirement_a
-000182a0: 6765 270a 2020 2020 2020 2020 6173 7365  ge'.        asse
-000182b0: 7274 2069 6e73 7461 6e63 652e 5f6f 7065  rt instance._ope
-000182c0: 7261 746f 7220 3d3d 206f 7065 7261 746f  rator == operato
-000182d0: 722e 6c74 0a0a 2020 2020 6465 6620 7465  r.lt..    def te
-000182e0: 7374 5f5f 5f69 6e69 745f 5f73 7472 6963  st___init__stric
-000182f0: 745f 626f 756e 6461 7269 6573 5f66 616c  t_boundaries_fal
-00018300: 7365 2873 656c 6629 3a0a 2020 2020 2020  se(self):.      
-00018310: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
-00018320: 5261 6e67 652e 5f5f 696e 6974 5f5f 6060  Range.__init__``
-00018330: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
-00018340: 2020 5465 7374 2074 6865 2060 605f 5f69    Test the ``__i
-00018350: 6e69 745f 5f60 6020 6d65 7468 6f64 2077  nit__`` method w
-00018360: 6865 6e20 6060 7374 7269 6374 5f62 6f75  hen ``strict_bou
-00018370: 6e64 6172 6965 7360 6020 6973 2060 6046  ndaries`` is ``F
-00018380: 616c 7365 6060 2e0a 0a20 2020 2020 2020  alse``...       
-00018390: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
-000183a0: 2020 2020 2d20 5468 7265 6520 636f 6c75      - Three colu
-000183b0: 6d6e 206e 616d 6573 2e0a 2020 2020 2020  mn names..      
-000183c0: 2020 2020 2020 2d20 6060 7374 7269 6374        - ``strict
-000183d0: 5f62 6f75 6e64 6172 6965 733d 4661 6c73  _boundaries=Fals
-000183e0: 6560 602e 0a0a 2020 2020 2020 2020 5369  e``...        Si
-000183f0: 6465 2045 6666 6563 743a 0a20 2020 2020  de Effect:.     
-00018400: 2020 2020 2020 202d 2060 6069 6e73 7461         - ``insta
-00018410: 6e63 652e 5f6f 7065 7261 746f 7260 6020  nce._operator`` 
-00018420: 7368 6f75 6c64 2062 6520 6060 6f70 6572  should be ``oper
-00018430: 6174 6f72 2e6c 6560 600a 2020 2020 2020  ator.le``.      
-00018440: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
-00018450: 5275 6e0a 2020 2020 2020 2020 696e 7374  Run.        inst
-00018460: 616e 6365 203d 2052 616e 6765 280a 2020  ance = Range(.  
-00018470: 2020 2020 2020 2020 2020 2761 6765 5f77            'age_w
-00018480: 6865 6e5f 6a6f 696e 6564 272c 0a20 2020  hen_joined',.   
-00018490: 2020 2020 2020 2020 2027 6375 7272 656e           'curren
-000184a0: 745f 6167 6527 2c0a 2020 2020 2020 2020  t_age',.        
-000184b0: 2020 2020 2772 6574 6972 656d 656e 745f      'retirement_
-000184c0: 6167 6527 2c0a 2020 2020 2020 2020 2020  age',.          
-000184d0: 2020 7374 7269 6374 5f62 6f75 6e64 6172    strict_boundar
-000184e0: 6965 733d 4661 6c73 650a 2020 2020 2020  ies=False.      
-000184f0: 2020 290a 0a20 2020 2020 2020 2023 2041    )..        # A
-00018500: 7373 6572 740a 2020 2020 2020 2020 6173  ssert.        as
-00018510: 7365 7274 2069 6e73 7461 6e63 652e 6c6f  sert instance.lo
-00018520: 775f 636f 6c75 6d6e 5f6e 616d 6520 3d3d  w_column_name ==
-00018530: 2027 6167 655f 7768 656e 5f6a 6f69 6e65   'age_when_joine
-00018540: 6427 0a20 2020 2020 2020 2061 7373 6572  d'.        asser
-00018550: 7420 696e 7374 616e 6365 2e6d 6964 646c  t instance.middl
-00018560: 655f 636f 6c75 6d6e 5f6e 616d 6520 3d3d  e_column_name ==
-00018570: 2027 6375 7272 656e 745f 6167 6527 0a20   'current_age'. 
-00018580: 2020 2020 2020 2061 7373 6572 7420 696e         assert in
-00018590: 7374 616e 6365 2e68 6967 685f 636f 6c75  stance.high_colu
-000185a0: 6d6e 5f6e 616d 6520 3d3d 2027 7265 7469  mn_name == 'reti
-000185b0: 7265 6d65 6e74 5f61 6765 270a 2020 2020  rement_age'.    
-000185c0: 2020 2020 6173 7365 7274 2069 6e73 7461      assert insta
-000185d0: 6e63 652e 5f6f 7065 7261 746f 7220 3d3d  nce._operator ==
-000185e0: 206f 7065 7261 746f 722e 6c65 0a0a 2020   operator.le..  
-000185f0: 2020 6465 6620 7465 7374 5f5f 6765 745f    def test__get_
-00018600: 6469 6666 5f63 6f6c 756d 6e5f 6e61 6d65  diff_column_name
-00018610: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00018620: 2222 2254 6573 7420 7468 6520 6060 5261  """Test the ``Ra
-00018630: 6e67 652e 5f67 6574 5f64 6966 665f 636f  nge._get_diff_co
-00018640: 6c75 6d6e 5f6e 616d 6560 6020 6d65 7468  lumn_name`` meth
-00018650: 6f64 2e0a 0a20 2020 2020 2020 2054 6869  od...        Thi
-00018660: 7320 6d65 7468 6f64 2073 686f 756c 6420  s method should 
-00018670: 7265 7475 726e 2074 6865 206e 616d 6520  return the name 
-00018680: 666f 7220 7468 6520 6e65 7720 6060 7472  for the new ``tr
-00018690: 616e 7366 6f72 6d5f 636f 6c75 6d6e 6060  ansform_column``
-000186a0: 2e0a 0a20 2020 2020 2020 2053 6574 7570  ...        Setup
-000186b0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-000186c0: 4372 6561 7465 2061 2070 642e 4461 7461  Create a pd.Data
-000186d0: 4672 616d 6520 7769 7468 2074 6872 6565  Frame with three
-000186e0: 2063 6f6c 756d 6e73 2e0a 2020 2020 2020   columns..      
-000186f0: 2020 2020 2020 2d20 496e 7374 616e 6365        - Instance
-00018700: 206f 6620 6060 5261 6e67 6560 6020 636f   of ``Range`` co
-00018710: 6e73 7472 6169 6e74 2077 6974 6820 7468  nstraint with th
-00018720: 6f73 6520 7468 7265 6520 636f 6c75 6d6e  ose three column
-00018730: 206e 616d 6573 2e0a 0a20 2020 2020 2020   names...       
-00018740: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
-00018750: 2020 2020 2d20 7064 2e44 6174 6146 7261      - pd.DataFra
-00018760: 6d65 2077 6974 6820 6060 6167 655f 7768  me with ``age_wh
-00018770: 656e 5f6a 6f69 6e65 6460 602c 2060 6063  en_joined``, ``c
-00018780: 7572 7265 6e74 5f61 6765 6060 2c20 6060  urrent_age``, ``
-00018790: 7265 7469 7265 6d65 6e74 5f61 6765 6060  retirement_age``
-000187a0: 2063 6f6c 756d 6e73 2e0a 0a20 2020 2020   columns...     
-000187b0: 2020 204f 7574 7075 743a 0a20 2020 2020     Output:.     
-000187c0: 2020 2020 2020 202d 2054 6865 2063 6f6c         - The col
-000187d0: 756d 6e20 6e61 6d65 7320 636f 6e63 6174  umn names concat
-000187e0: 656e 6174 6564 2077 6974 6820 6060 2360  enated with ``#`
-000187f0: 6020 7768 6572 6520 7468 6520 6f72 6465  ` where the orde
-00018800: 7220 6973 0a20 2020 2020 2020 2020 2020  r is.           
-00018810: 2020 2074 6865 2060 606d 6964 646c 655f     the ``middle_
-00018820: 636f 6c75 6d6e 5f6e 616d 6560 6020 666f  column_name`` fo
-00018830: 6c6c 6f77 6564 2062 7920 6060 6c6f 7765  llowed by ``lowe
-00018840: 725f 636f 6c75 6d6e 5f6e 616d 6560 6020  r_column_name`` 
-00018850: 616e 6420 656e 6473 2077 6974 6820 7468  and ends with th
-00018860: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00018870: 6060 6869 6768 6572 5f63 6f6c 756d 6e5f  ``higher_column_
-00018880: 6e61 6d65 6060 2e0a 2020 2020 2020 2020  name``..        
-00018890: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
-000188a0: 7475 700a 2020 2020 2020 2020 7461 626c  tup.        tabl
-000188b0: 655f 6461 7461 203d 2070 642e 4461 7461  e_data = pd.Data
-000188c0: 4672 616d 6528 7b0a 2020 2020 2020 2020  Frame({.        
-000188d0: 2020 2020 2761 6765 5f77 6865 6e5f 6a6f      'age_when_jo
-000188e0: 696e 6564 273a 205b 3138 2c20 3139 2c20  ined': [18, 19, 
-000188f0: 3230 5d2c 0a20 2020 2020 2020 2020 2020  20],.           
-00018900: 2027 6375 7272 656e 745f 6167 6527 3a20   'current_age': 
-00018910: 5b32 312c 2032 322c 2032 355d 2c0a 2020  [21, 22, 25],.  
-00018920: 2020 2020 2020 2020 2020 2772 6574 6972            'retir
-00018930: 656d 656e 745f 6167 6527 3a20 5b36 352c  ement_age': [65,
-00018940: 2036 382c 2037 355d 0a20 2020 2020 2020   68, 75].       
-00018950: 207d 290a 2020 2020 2020 2020 696e 7374   }).        inst
-00018960: 616e 6365 203d 2052 616e 6765 2827 6167  ance = Range('ag
-00018970: 655f 7768 656e 5f6a 6f69 6e65 6427 2c20  e_when_joined', 
-00018980: 2763 7572 7265 6e74 5f61 6765 272c 2027  'current_age', '
-00018990: 7265 7469 7265 6d65 6e74 5f61 6765 2729  retirement_age')
-000189a0: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
-000189b0: 2020 2020 2020 2020 7472 616e 7366 6f72          transfor
-000189c0: 6d65 645f 636f 6c75 6d6e 5f6e 616d 6520  med_column_name 
-000189d0: 3d20 696e 7374 616e 6365 2e5f 6765 745f  = instance._get_
-000189e0: 6469 6666 5f63 6f6c 756d 6e5f 6e61 6d65  diff_column_name
-000189f0: 2874 6162 6c65 5f64 6174 6129 0a0a 2020  (table_data)..  
-00018a00: 2020 2020 2020 2320 4173 7365 7274 0a20        # Assert. 
-00018a10: 2020 2020 2020 2061 7373 6572 7420 7472         assert tr
-00018a20: 616e 7366 6f72 6d65 645f 636f 6c75 6d6e  ansformed_column
-00018a30: 5f6e 616d 6520 3d3d 2027 6375 7272 656e  _name == 'curren
-00018a40: 745f 6167 6523 6167 655f 7768 656e 5f6a  t_age#age_when_j
-00018a50: 6f69 6e65 6423 7265 7469 7265 6d65 6e74  oined#retirement
-00018a60: 5f61 6765 270a 0a20 2020 2064 6566 2074  _age'..    def t
-00018a70: 6573 745f 5f67 6574 5f69 735f 6461 7465  est__get_is_date
-00018a80: 7469 6d65 2873 656c 6629 3a0a 2020 2020  time(self):.    
-00018a90: 2020 2020 2222 2254 6573 7420 7468 6174      """Test that
-00018aa0: 2074 6865 206d 6574 686f 6420 6465 7465   the method dete
-00018ab0: 6374 7320 7768 6574 6865 7220 6f72 206e  cts whether or n
-00018ac0: 6f74 2074 6865 2060 6064 6174 6160 6020  ot the ``data`` 
-00018ad0: 6973 2060 6064 6174 6574 696d 6560 602e  is ``datetime``.
-00018ae0: 0a0a 2020 2020 2020 2020 5468 6973 206d  ..        This m
-00018af0: 6574 686f 6420 7368 6f75 6c64 2064 6574  ethod should det
-00018b00: 6563 7420 7768 6574 6865 7220 6f72 206e  ect whether or n
-00018b10: 6f74 2074 6865 2064 6174 6120 6973 2060  ot the data is `
-00018b20: 6064 6174 6574 696d 6560 6020 616e 6420  `datetime`` and 
-00018b30: 6966 2069 6e20 6361 7365 2073 6f6d 6520  if in case some 
-00018b40: 6973 0a20 2020 2020 2020 2062 7574 206f  is.        but o
-00018b50: 7468 6572 2069 7320 6e6f 742c 2072 6169  ther is not, rai
-00018b60: 7365 7320 616e 2065 7272 6f72 2e0a 0a20  ses an error... 
-00018b70: 2020 2020 2020 2053 6574 7570 3a0a 2020         Setup:.  
-00018b80: 2020 2020 2020 2020 2020 2d20 4372 6561            - Crea
-00018b90: 7465 2061 2070 642e 4461 7461 4672 616d  te a pd.DataFram
-00018ba0: 6520 7769 7468 2074 6872 6565 2063 6f6c  e with three col
-00018bb0: 756d 6e73 2074 6861 7420 6172 6520 6461  umns that are da
-00018bc0: 7465 7469 6d65 2064 6174 612e 0a20 2020  tetime data..   
-00018bd0: 2020 2020 2020 2020 202d 2049 6e73 7461           - Insta
-00018be0: 6e63 6520 6f66 2060 6052 616e 6765 6060  nce of ``Range``
-00018bf0: 2063 6f6e 7374 7261 696e 7420 7769 7468   constraint with
-00018c00: 2074 686f 7365 2074 6872 6565 2063 6f6c   those three col
-00018c10: 756d 6e20 6e61 6d65 732e 0a0a 2020 2020  umn names...    
-00018c20: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
-00018c30: 2020 2020 2020 202d 2070 642e 4461 7461         - pd.Data
-00018c40: 4672 616d 6520 7769 7468 2060 606a 6f69  Frame with ``joi
-00018c50: 6e5f 6461 7465 6060 2c20 6060 7072 6f6d  n_date``, ``prom
-00018c60: 6f74 696f 6e5f 6461 7465 6060 2c20 6060  otion_date``, ``
-00018c70: 7265 7469 7265 6d65 6e74 5f64 6174 6560  retirement_date`
-00018c80: 6020 636f 6c75 6d6e 732e 0a0a 2020 2020  ` columns...    
-00018c90: 2020 2020 4f75 7470 7574 3a0a 2020 2020      Output:.    
-00018ca0: 2020 2020 2020 2020 2d20 5468 6520 6f75          - The ou
-00018cb0: 7470 7574 2073 686f 756c 6420 6265 2054  tput should be T
-00018cc0: 7275 652e 0a20 2020 2020 2020 2022 2222  rue..        """
-00018cd0: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-00018ce0: 0a20 2020 2020 2020 2074 6162 6c65 5f64  .        table_d
-00018cf0: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
-00018d00: 6d65 287b 0a20 2020 2020 2020 2020 2020  me({.           
-00018d10: 2027 6a6f 696e 5f64 6174 6527 3a20 7064   'join_date': pd
-00018d20: 2e74 6f5f 6461 7465 7469 6d65 285b 2732  .to_datetime(['2
-00018d30: 3032 312d 3032 2d31 3027 2c20 2732 3032  021-02-10', '202
-00018d40: 312d 3035 2d31 3027 2c20 2732 3032 312d  1-05-10', '2021-
-00018d50: 3038 2d31 3127 5d29 2c0a 2020 2020 2020  08-11']),.      
-00018d60: 2020 2020 2020 2770 726f 6d6f 7469 6f6e        'promotion
-00018d70: 5f64 6174 6527 3a20 7064 2e74 6f5f 6461  _date': pd.to_da
-00018d80: 7465 7469 6d65 285b 2732 3032 322d 3035  tetime(['2022-05
-00018d90: 2d31 3027 2c20 2732 3032 322d 3036 2d31  -10', '2022-06-1
-00018da0: 3027 2c20 2732 3032 322d 3131 2d31 3727  0', '2022-11-17'
-00018db0: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
-00018dc0: 2772 6574 6972 656d 656e 745f 6461 7465  'retirement_date
-00018dd0: 273a 2070 642e 746f 5f64 6174 6574 696d  ': pd.to_datetim
-00018de0: 6528 5b27 3230 3530 2d31 302d 3131 272c  e(['2050-10-11',
-00018df0: 2027 3230 3538 2d31 302d 3034 272c 2027   '2058-10-04', '
-00018e00: 3230 3735 2d31 312d 3134 275d 290a 2020  2075-11-14']).  
-00018e10: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
-00018e20: 2069 6e73 7461 6e63 6520 3d20 5261 6e67   instance = Rang
-00018e30: 6528 276a 6f69 6e5f 6461 7465 272c 2027  e('join_date', '
-00018e40: 7072 6f6d 6f74 696f 6e5f 6461 7465 272c  promotion_date',
-00018e50: 2027 7265 7469 7265 6d65 6e74 5f64 6174   'retirement_dat
-00018e60: 6527 290a 0a20 2020 2020 2020 2023 2052  e')..        # R
-00018e70: 756e 0a20 2020 2020 2020 2069 735f 6461  un.        is_da
-00018e80: 7465 7469 6d65 203d 2069 6e73 7461 6e63  tetime = instanc
-00018e90: 652e 5f67 6574 5f69 735f 6461 7465 7469  e._get_is_dateti
-00018ea0: 6d65 2874 6162 6c65 5f64 6174 6129 0a0a  me(table_data)..
-00018eb0: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
-00018ec0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00018ed0: 6973 5f64 6174 6574 696d 650a 0a20 2020  is_datetime..   
-00018ee0: 2064 6566 2074 6573 745f 5f67 6574 5f69   def test__get_i
-00018ef0: 735f 6461 7465 7469 6d65 5f6e 6f5f 6461  s_datetime_no_da
-00018f00: 7465 7469 6d65 7328 7365 6c66 293a 0a20  tetimes(self):. 
-00018f10: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
-00018f20: 6861 7420 7468 6520 6d65 7468 6f64 2064  hat the method d
-00018f30: 6574 6563 7473 2077 6865 7468 6572 206f  etects whether o
-00018f40: 7220 6e6f 7420 7468 6520 6060 6461 7461  r not the ``data
-00018f50: 6060 2069 7320 6060 6461 7465 7469 6d65  `` is ``datetime
-00018f60: 6060 2e0a 0a20 2020 2020 2020 2054 6869  ``...        Thi
-00018f70: 7320 6d65 7468 6f64 2073 686f 756c 6420  s method should 
-00018f80: 6465 7465 6374 2077 6865 7468 6572 206f  detect whether o
-00018f90: 7220 6e6f 7420 7468 6520 6461 7461 2069  r not the data i
-00018fa0: 7320 6060 6461 7465 7469 6d65 6060 2061  s ``datetime`` a
-00018fb0: 6e64 2069 6620 696e 2063 6173 6520 736f  nd if in case so
-00018fc0: 6d65 2069 730a 2020 2020 2020 2020 6275  me is.        bu
-00018fd0: 7420 6f74 6865 7220 6973 206e 6f74 2c20  t other is not, 
-00018fe0: 7261 6973 6573 2061 6e20 6572 726f 722e  raises an error.
-00018ff0: 0a0a 2020 2020 2020 2020 5365 7475 703a  ..        Setup:
-00019000: 0a20 2020 2020 2020 2020 2020 202d 2043  .            - C
-00019010: 7265 6174 6520 6120 7064 2e44 6174 6146  reate a pd.DataF
-00019020: 7261 6d65 2077 6974 6820 7468 7265 6520  rame with three 
-00019030: 636f 6c75 6d6e 7320 7468 6174 2064 6f20  columns that do 
-00019040: 6e6f 7420 636f 6e74 6169 6e20 6461 7465  not contain date
-00019050: 7469 6d65 2064 6174 612e 0a20 2020 2020  time data..     
-00019060: 2020 2020 2020 202d 2049 6e73 7461 6e63         - Instanc
-00019070: 6520 6f66 2060 6052 616e 6765 6060 2063  e of ``Range`` c
-00019080: 6f6e 7374 7261 696e 7420 7769 7468 2074  onstraint with t
-00019090: 686f 7365 2074 6872 6565 2063 6f6c 756d  hose three colum
-000190a0: 6e20 6e61 6d65 732e 0a0a 2020 2020 2020  n names...      
-000190b0: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
-000190c0: 2020 2020 202d 2070 642e 4461 7461 4672       - pd.DataFr
-000190d0: 616d 6520 7769 7468 2060 6061 6765 5f77  ame with ``age_w
-000190e0: 6865 6e5f 6a6f 696e 6564 6060 2c20 6060  hen_joined``, ``
-000190f0: 6375 7272 656e 745f 6167 6560 602c 2060  current_age``, `
-00019100: 6072 6574 6972 656d 656e 745f 6167 6560  `retirement_age`
-00019110: 6020 636f 6c75 6d6e 732e 0a0a 2020 2020  ` columns...    
-00019120: 2020 2020 4f75 7470 7574 3a0a 2020 2020      Output:.    
-00019130: 2020 2020 2020 2020 2d20 5468 6520 6f75          - The ou
-00019140: 7470 7574 2073 686f 756c 6420 6265 2066  tput should be f
-00019150: 616c 7365 2073 696e 6365 2061 6c6c 2074  alse since all t
-00019160: 6865 2064 6174 6120 6973 2060 6069 6e74  he data is ``int
-00019170: 6060 2e0a 2020 2020 2020 2020 2222 220a  ``..        """.
-00019180: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
-00019190: 2020 2020 2020 2020 7461 626c 655f 6461          table_da
-000191a0: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
-000191b0: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
-000191c0: 2761 6765 5f77 6865 6e5f 6a6f 696e 6564  'age_when_joined
-000191d0: 273a 205b 3138 2c20 3139 2c20 3230 5d2c  ': [18, 19, 20],
-000191e0: 0a20 2020 2020 2020 2020 2020 2027 6375  .            'cu
-000191f0: 7272 656e 745f 6167 6527 3a20 5b32 312c  rrent_age': [21,
-00019200: 2032 322c 2032 355d 2c0a 2020 2020 2020   22, 25],.      
-00019210: 2020 2020 2020 2772 6574 6972 656d 656e        'retiremen
-00019220: 745f 6167 6527 3a20 5b36 352c 2036 382c  t_age': [65, 68,
-00019230: 2037 355d 0a20 2020 2020 2020 207d 290a   75].        }).
-00019240: 2020 2020 2020 2020 696e 7374 616e 6365          instance
-00019250: 203d 2052 616e 6765 2827 6167 655f 7768   = Range('age_wh
-00019260: 656e 5f6a 6f69 6e65 6427 2c20 2763 7572  en_joined', 'cur
-00019270: 7265 6e74 5f61 6765 272c 2027 7265 7469  rent_age', 'reti
-00019280: 7265 6d65 6e74 5f61 6765 2729 0a0a 2020  rement_age')..  
-00019290: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
-000192a0: 2020 2020 6973 5f64 6174 6574 696d 6520      is_datetime 
-000192b0: 3d20 696e 7374 616e 6365 2e5f 6765 745f  = instance._get_
-000192c0: 6973 5f64 6174 6574 696d 6528 7461 626c  is_datetime(tabl
-000192d0: 655f 6461 7461 290a 0a20 2020 2020 2020  e_data)..       
-000192e0: 2023 2041 7373 6572 740a 2020 2020 2020   # Assert.      
-000192f0: 2020 6173 7365 7274 206e 6f74 2069 735f    assert not is_
-00019300: 6461 7465 7469 6d65 0a0a 2020 2020 6465  datetime..    de
-00019310: 6620 7465 7374 5f5f 6765 745f 6973 5f64  f test__get_is_d
-00019320: 6174 6574 696d 655f 7261 6973 6573 5f61  atetime_raises_a
-00019330: 6e5f 6572 726f 7228 7365 6c66 293a 0a20  n_error(self):. 
-00019340: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
-00019350: 6861 7420 7468 6520 6d65 7468 6f64 2064  hat the method d
-00019360: 6574 6563 7473 2077 6865 7468 6572 206f  etects whether o
-00019370: 7220 6e6f 7420 7468 6520 6060 6461 7461  r not the ``data
-00019380: 6060 2069 7320 6060 6461 7465 7469 6d65  `` is ``datetime
-00019390: 6060 2e0a 0a20 2020 2020 2020 2054 6869  ``...        Thi
-000193a0: 7320 6d65 7468 6f64 2073 686f 756c 6420  s method should 
-000193b0: 6465 7465 6374 2077 6865 7468 6572 206f  detect whether o
-000193c0: 7220 6e6f 7420 7468 6520 6461 7461 2069  r not the data i
-000193d0: 7320 6060 6461 7465 7469 6d65 6060 2061  s ``datetime`` a
-000193e0: 6e64 2069 6620 696e 2063 6173 6520 736f  nd if in case so
-000193f0: 6d65 2069 730a 2020 2020 2020 2020 6275  me is.        bu
-00019400: 7420 6f74 6865 7220 6973 206e 6f74 2c20  t other is not, 
-00019410: 7261 6973 6573 2061 6e20 6572 726f 722e  raises an error.
-00019420: 0a0a 2020 2020 2020 2020 5365 7475 703a  ..        Setup:
-00019430: 0a20 2020 2020 2020 2020 2020 202d 2043  .            - C
-00019440: 7265 6174 6520 6120 7064 2e44 6174 6146  reate a pd.DataF
-00019450: 7261 6d65 2077 6974 6820 7468 7265 6520  rame with three 
-00019460: 636f 6c75 6d6e 7320 7468 6174 2063 6f6e  columns that con
-00019470: 7461 696e 2062 6f74 6820 6461 7465 7469  tain both dateti
-00019480: 6d65 2061 6e64 206e 6f6e 0a20 2020 2020  me and non.     
-00019490: 2020 2020 2020 2020 2064 6174 6574 696d           datetim
-000194a0: 6520 6461 7461 2e0a 2020 2020 2020 2020  e data..        
-000194b0: 2020 2020 2d20 496e 7374 616e 6365 206f      - Instance o
-000194c0: 6620 6060 5261 6e67 6560 6020 636f 6e73  f ``Range`` cons
-000194d0: 7472 6169 6e74 2077 6974 6820 7468 6f73  traint with thos
-000194e0: 6520 7468 7265 6520 636f 6c75 6d6e 206e  e three column n
-000194f0: 616d 6573 2e0a 0a20 2020 2020 2020 2049  ames...        I
-00019500: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
-00019510: 2020 2d20 7064 2e44 6174 6146 7261 6d65    - pd.DataFrame
-00019520: 2077 6974 6820 6060 6a6f 696e 5f64 6174   with ``join_dat
-00019530: 6560 602c 2060 6070 726f 6d6f 7469 6f6e  e``, ``promotion
-00019540: 5f64 6174 6560 602c 2060 6063 7572 7265  _date``, ``curre
-00019550: 6e74 5f61 6765 6060 2063 6f6c 756d 6e73  nt_age`` columns
-00019560: 2e0a 0a20 2020 2020 2020 2053 6964 6520  ...        Side 
-00019570: 4566 6665 6374 3a0a 2020 2020 2020 2020  Effect:.        
-00019580: 2020 2020 2d20 5661 6c75 6520 6572 726f      - Value erro
-00019590: 7220 7769 7468 2074 6865 2065 7870 6563  r with the expec
-000195a0: 7465 6420 6d65 7373 6167 6520 7368 6f75  ted message shou
-000195b0: 6c64 2062 6520 7261 6973 6564 2e0a 2020  ld be raised..  
-000195c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000195d0: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
-000195e0: 2020 7461 626c 655f 6461 7461 203d 2070    table_data = p
-000195f0: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-00019600: 2020 2020 2020 2020 2020 276a 6f69 6e5f            'join_
-00019610: 6461 7465 273a 2070 642e 746f 5f64 6174  date': pd.to_dat
-00019620: 6574 696d 6528 5b27 3230 3231 2d30 322d  etime(['2021-02-
-00019630: 3130 272c 2027 3230 3231 2d30 352d 3130  10', '2021-05-10
-00019640: 272c 2027 3230 3231 2d30 382d 3131 275d  ', '2021-08-11']
-00019650: 292c 0a20 2020 2020 2020 2020 2020 2027  ),.            '
-00019660: 7072 6f6d 6f74 696f 6e5f 6461 7465 273a  promotion_date':
-00019670: 2070 642e 746f 5f64 6174 6574 696d 6528   pd.to_datetime(
-00019680: 5b27 3230 3232 2d30 352d 3130 272c 2027  ['2022-05-10', '
-00019690: 3230 3232 2d30 362d 3130 272c 2027 3230  2022-06-10', '20
-000196a0: 3232 2d31 312d 3137 275d 292c 0a20 2020  22-11-17']),.   
-000196b0: 2020 2020 2020 2020 2027 6375 7272 656e           'curren
-000196c0: 745f 6167 6527 3a20 5b32 312c 2032 322c  t_age': [21, 22,
-000196d0: 2032 355d 2c0a 2020 2020 2020 2020 7d29   25],.        })
-000196e0: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-000196f0: 6520 3d20 5261 6e67 6528 276a 6f69 6e5f  e = Range('join_
-00019700: 6461 7465 272c 2027 7072 6f6d 6f74 696f  date', 'promotio
-00019710: 6e5f 6461 7465 272c 2027 6375 7272 656e  n_date', 'curren
-00019720: 745f 6167 6527 290a 2020 2020 2020 2020  t_age').        
-00019730: 6578 7065 6374 6564 5f74 6578 7420 3d20  expected_text = 
-00019740: 2754 6865 2063 6f6e 7374 7261 696e 7420  'The constraint 
-00019750: 636f 6c75 6d6e 2061 6e64 2062 6f75 6e64  column and bound
-00019760: 7320 6d75 7374 2061 6c6c 2062 6520 6461  s must all be da
-00019770: 7465 7469 6d65 2e27 0a0a 2020 2020 2020  tetime.'..      
-00019780: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
-00019790: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-000197a0: 6573 2856 616c 7565 4572 726f 722c 206d  es(ValueError, m
-000197b0: 6174 6368 3d65 7870 6563 7465 645f 7465  atch=expected_te
-000197c0: 7874 293a 0a20 2020 2020 2020 2020 2020  xt):.           
-000197d0: 2069 6e73 7461 6e63 652e 5f67 6574 5f69   instance._get_i
-000197e0: 735f 6461 7465 7469 6d65 2874 6162 6c65  s_datetime(table
-000197f0: 5f64 6174 6129 0a0a 2020 2020 6465 6620  _data)..    def 
-00019800: 7465 7374 5f5f 6669 7428 7365 6c66 293a  test__fit(self):
-00019810: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-00019820: 2074 6865 2060 605f 6669 7460 6020 6d65   the ``_fit`` me
-00019830: 7468 6f64 206f 6620 6060 5261 6e67 6560  thod of ``Range`
-00019840: 602e 0a0a 2020 2020 2020 2020 5465 7374  `...        Test
-00019850: 2074 6861 7420 7468 6520 6060 5f66 6974   that the ``_fit
-00019860: 6060 206d 6574 686f 6420 7374 6f72 6573  `` method stores
-00019870: 2074 6865 2070 726f 7065 7220 7472 616e   the proper tran
-00019880: 7366 6f72 6d61 7469 6f6e 2063 6f6c 756d  sformation colum
-00019890: 6e20 6e61 6d65 2061 6e64 0a20 2020 2020  n name and.     
-000198a0: 2020 206c 6561 726e 7320 7768 6574 6865     learns whethe
-000198b0: 7220 7468 6520 6461 7461 2069 7320 6060  r the data is ``
-000198c0: 6461 7465 7469 6d65 6060 6f72 206e 6f74  datetime``or not
-000198d0: 2061 6e64 2069 7427 7320 6060 6474 7970   and it's ``dtyp
-000198e0: 6560 602e 0a0a 2020 2020 2020 2020 5365  e``...        Se
-000198f0: 7475 703a 0a20 2020 2020 2020 2020 2020  tup:.           
-00019900: 202d 2043 7265 6174 6520 6120 7064 2e44   - Create a pd.D
-00019910: 6174 6146 7261 6d65 2077 6974 6820 7468  ataFrame with th
-00019920: 7265 6520 636f 6c75 6d6e 732e 0a20 2020  ree columns..   
-00019930: 2020 2020 2020 2020 202d 2049 6e73 7461           - Insta
-00019940: 6e63 6520 6f66 2060 6052 616e 6765 6060  nce of ``Range``
-00019950: 2063 6f6e 7374 7261 696e 7420 7769 7468   constraint with
-00019960: 2074 686f 7365 2074 6872 6565 2063 6f6c   those three col
-00019970: 756d 6e20 6e61 6d65 732e 0a0a 2020 2020  umn names...    
-00019980: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
-00019990: 2020 2020 2020 202d 2070 642e 4461 7461         - pd.Data
-000199a0: 4672 616d 6520 7769 7468 2060 606a 6f69  Frame with ``joi
-000199b0: 6e5f 6461 7465 6060 2c20 6060 7072 6f6d  n_date``, ``prom
-000199c0: 6f74 696f 6e5f 6461 7465 6060 2c20 6060  otion_date``, ``
-000199d0: 6375 7272 656e 745f 6167 6560 6020 636f  current_age`` co
-000199e0: 6c75 6d6e 732e 0a0a 2020 2020 2020 2020  lumns...        
-000199f0: 5369 6465 2045 6666 6563 743a 0a20 2020  Side Effect:.   
-00019a00: 2020 2020 2020 2020 202d 2069 6e73 7461           - insta
-00019a10: 6e63 6520 6861 7320 6060 5f74 7261 6e73  nce has ``_trans
-00019a20: 666f 726d 6564 5f63 6f6c 756d 6e60 6020  formed_column`` 
-00019a30: 616e 6420 6060 5f69 735f 6461 7465 7469  and ``_is_dateti
-00019a40: 6d65 6060 2061 6e64 2060 605f 6474 7970  me`` and ``_dtyp
-00019a50: 6560 602e 0a20 2020 2020 2020 2022 2222  e``..        """
-00019a60: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-00019a70: 0a20 2020 2020 2020 2074 6162 6c65 5f64  .        table_d
-00019a80: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
-00019a90: 6d65 287b 0a20 2020 2020 2020 2020 2020  me({.           
-00019aa0: 2027 6167 655f 7768 656e 5f6a 6f69 6e65   'age_when_joine
-00019ab0: 6427 3a20 5b31 382c 2031 392c 2032 305d  d': [18, 19, 20]
-00019ac0: 2c0a 2020 2020 2020 2020 2020 2020 2763  ,.            'c
-00019ad0: 7572 7265 6e74 5f61 6765 273a 205b 3231  urrent_age': [21
-00019ae0: 2c20 3232 2c20 3235 5d2c 0a20 2020 2020  , 22, 25],.     
-00019af0: 2020 2020 2020 2027 7265 7469 7265 6d65         'retireme
-00019b00: 6e74 5f61 6765 273a 205b 3635 2c20 3638  nt_age': [65, 68
-00019b10: 2c20 3735 5d2c 0a20 2020 2020 2020 2020  , 75],.         
-00019b20: 2020 2027 6375 7272 656e 745f 6167 6523     'current_age#
-00019b30: 6167 655f 7768 656e 5f6a 6f69 6e65 6423  age_when_joined#
-00019b40: 7265 7469 7265 6d65 6e74 5f61 6765 273a  retirement_age':
-00019b50: 205b 312c 2032 2c20 335d 0a20 2020 2020   [1, 2, 3].     
-00019b60: 2020 207d 2c20 6474 7970 653d 6e70 2e69     }, dtype=np.i
-00019b70: 6e74 3634 290a 2020 2020 2020 2020 696e  nt64).        in
-00019b80: 7374 616e 6365 203d 2052 616e 6765 2827  stance = Range('
-00019b90: 6167 655f 7768 656e 5f6a 6f69 6e65 6427  age_when_joined'
-00019ba0: 2c20 2763 7572 7265 6e74 5f61 6765 272c  , 'current_age',
-00019bb0: 2027 7265 7469 7265 6d65 6e74 5f61 6765   'retirement_age
-00019bc0: 2729 0a0a 2020 2020 2020 2020 2320 5275  ')..        # Ru
-00019bd0: 6e0a 2020 2020 2020 2020 696e 7374 616e  n.        instan
-00019be0: 6365 2e5f 6669 7428 7461 626c 655f 6461  ce._fit(table_da
-00019bf0: 7461 290a 0a20 2020 2020 2020 2023 2041  ta)..        # A
-00019c00: 7373 6572 740a 2020 2020 2020 2020 6173  ssert.        as
-00019c10: 7365 7274 2069 6e73 7461 6e63 652e 5f74  sert instance._t
-00019c20: 7261 6e73 666f 726d 6564 5f63 6f6c 756d  ransformed_colum
-00019c30: 6e20 3d3d 2027 6375 7272 656e 745f 6167  n == 'current_ag
-00019c40: 6523 2361 6765 5f77 6865 6e5f 6a6f 696e  e##age_when_join
-00019c50: 6564 2323 7265 7469 7265 6d65 6e74 5f61  ed##retirement_a
-00019c60: 6765 270a 2020 2020 2020 2020 6173 7365  ge'.        asse
-00019c70: 7274 2069 6e73 7461 6e63 652e 5f64 7479  rt instance._dty
-00019c80: 7065 203d 3d20 6e70 2e69 6e74 3634 0a20  pe == np.int64. 
-00019c90: 2020 2020 2020 2061 7373 6572 7420 6e6f         assert no
-00019ca0: 7420 696e 7374 616e 6365 2e5f 6973 5f64  t instance._is_d
-00019cb0: 6174 6574 696d 650a 0a20 2020 2064 6566  atetime..    def
-00019cc0: 2074 6573 745f 6973 5f76 616c 6964 5f6c   test_is_valid_l
-00019cd0: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
-00019ce0: 2022 2222 5465 7374 2074 6865 2060 6052   """Test the ``R
-00019cf0: 616e 6765 2e69 735f 7661 6c69 6460 602e  ange.is_valid``.
-00019d00: 0a0a 2020 2020 2020 2020 5468 6973 2074  ..        This t
-00019d10: 6573 7420 656e 7375 7265 7320 7468 6174  est ensures that
-00019d20: 2074 6865 2060 6069 735f 7661 6c69 6460   the ``is_valid`
-00019d30: 6020 6d65 7468 6f64 2077 6f72 6b73 2077  ` method works w
-00019d40: 6974 6820 7468 6520 6f70 6572 6174 6f72  ith the operator
-00019d50: 2060 603c 6060 0a20 2020 2020 2020 2028   ``<``.        (
-00019d60: 6060 3c60 6029 2061 6e64 2076 616c 6964  ``<``) and valid
-00019d70: 6174 6573 2074 6861 7420 7468 6520 6060  ates that the ``
-00019d80: 6d69 6464 6c65 5f63 6f6c 756d 6e5f 6e61  middle_column_na
-00019d90: 6d65 6060 2069 7320 6265 7477 6565 6e20  me`` is between 
-00019da0: 6060 6c6f 775f 636f 6c75 6d6e 5f6e 616d  ``low_column_nam
-00019db0: 6560 6020 616e 640a 2020 2020 2020 2020  e`` and.        
-00019dc0: 6060 6869 6768 5f63 6f6c 756d 6e5f 6e61  ``high_column_na
-00019dd0: 6d65 6060 2e0a 0a20 2020 2020 2020 2053  me``...        S
-00019de0: 6574 7570 3a0a 2020 2020 2020 2020 2020  etup:.          
-00019df0: 2020 2d20 4372 6561 7465 2061 2070 642e    - Create a pd.
-00019e00: 4461 7461 4672 616d 6520 7769 7468 2074  DataFrame with t
-00019e10: 6872 6565 2063 6f6c 756d 6e73 2e0a 2020  hree columns..  
-00019e20: 2020 2020 2020 2020 2020 2d20 496e 7374            - Inst
-00019e30: 616e 6365 206f 6620 6060 5261 6e67 6560  ance of ``Range`
-00019e40: 6020 636f 6e73 7472 6169 6e74 2077 6974  ` constraint wit
-00019e50: 6820 7468 6f73 6520 7468 7265 6520 636f  h those three co
-00019e60: 6c75 6d6e 206e 616d 6573 2e0a 0a20 2020  lumn names...   
-00019e70: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-00019e80: 2020 2020 2020 2020 2d20 7064 2e44 6174          - pd.Dat
-00019e90: 6146 7261 6d65 2077 6974 6820 6060 6167  aFrame with ``ag
-00019ea0: 655f 7768 656e 5f6a 6f69 6e65 6460 602c  e_when_joined``,
-00019eb0: 2060 6063 7572 7265 6e74 5f61 6765 6060   ``current_age``
-00019ec0: 2c20 6060 7265 7469 7265 6d65 6e74 5f61  , ``retirement_a
-00019ed0: 6765 6060 2063 6f6c 756d 6e73 2e0a 2020  ge`` columns..  
-00019ee0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00019ef0: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
-00019f00: 2020 7461 626c 655f 6461 7461 203d 2070    table_data = p
-00019f10: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-00019f20: 2020 2020 2020 2020 2020 2761 6765 5f77            'age_w
-00019f30: 6865 6e5f 6a6f 696e 6564 273a 205b 3138  hen_joined': [18
-00019f40: 2c20 3139 2c20 3230 5d2c 0a20 2020 2020  , 19, 20],.     
-00019f50: 2020 2020 2020 2027 6375 7272 656e 745f         'current_
-00019f60: 6167 6527 3a20 5b32 312c 2032 322c 2032  age': [21, 22, 2
-00019f70: 355d 2c0a 2020 2020 2020 2020 2020 2020  5],.            
-00019f80: 2772 6574 6972 656d 656e 745f 6167 6527  'retirement_age'
-00019f90: 3a20 5b36 352c 2036 382c 2037 355d 0a20  : [65, 68, 75]. 
-00019fa0: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
-00019fb0: 2020 696e 7374 616e 6365 203d 2052 616e    instance = Ran
-00019fc0: 6765 2827 6167 655f 7768 656e 5f6a 6f69  ge('age_when_joi
-00019fd0: 6e65 6427 2c20 2763 7572 7265 6e74 5f61  ned', 'current_a
-00019fe0: 6765 272c 2027 7265 7469 7265 6d65 6e74  ge', 'retirement
-00019ff0: 5f61 6765 2729 0a0a 2020 2020 2020 2020  _age')..        
-0001a000: 2320 5275 6e0a 2020 2020 2020 2020 7265  # Run.        re
-0001a010: 7375 6c74 203d 2069 6e73 7461 6e63 652e  sult = instance.
-0001a020: 6973 5f76 616c 6964 2874 6162 6c65 5f64  is_valid(table_d
-0001a030: 6174 6129 0a0a 2020 2020 2020 2020 2320  ata)..        # 
-0001a040: 4173 7365 7274 0a20 2020 2020 2020 2061  Assert.        a
-0001a050: 7373 6572 7420 616c 6c28 7265 7375 6c74  ssert all(result
-0001a060: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-0001a070: 6973 5f76 616c 6964 5f6c 6528 7365 6c66  is_valid_le(self
-0001a080: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-0001a090: 7374 2074 6865 2060 6052 616e 6765 2e69  st the ``Range.i
-0001a0a0: 735f 7661 6c69 6460 602e 0a0a 2020 2020  s_valid``...    
-0001a0b0: 2020 2020 5468 6973 2074 6573 7420 656e      This test en
-0001a0c0: 7375 7265 7320 7468 6174 2074 6865 2060  sures that the `
-0001a0d0: 6069 735f 7661 6c69 6460 6020 6d65 7468  `is_valid`` meth
-0001a0e0: 6f64 2077 6f72 6b73 2077 6974 6820 7468  od works with th
-0001a0f0: 6520 6f70 6572 6174 6f72 0a20 2020 2020  e operator.     
-0001a100: 2020 2060 603c 3d60 6020 616e 6420 7661     ``<=`` and va
-0001a110: 6c69 6461 7465 7320 7468 6174 2074 6865  lidates that the
-0001a120: 2060 606d 6964 646c 655f 636f 6c75 6d6e   ``middle_column
-0001a130: 5f6e 616d 6560 6020 6973 0a20 2020 2020  _name`` is.     
-0001a140: 2020 2062 6574 7765 656e 2060 606c 6f77     between ``low
-0001a150: 5f63 6f6c 756d 6e5f 6e61 6d65 6060 2061  _column_name`` a
-0001a160: 6e64 2060 6068 6967 685f 636f 6c75 6d6e  nd ``high_column
-0001a170: 5f6e 616d 6560 602e 0a0a 2020 2020 2020  _name``...      
-0001a180: 2020 5365 7475 703a 0a20 2020 2020 2020    Setup:.       
-0001a190: 2020 2020 202d 2043 7265 6174 6520 6120       - Create a 
-0001a1a0: 7064 2e44 6174 6146 7261 6d65 2077 6974  pd.DataFrame wit
-0001a1b0: 6820 7468 7265 6520 636f 6c75 6d6e 732e  h three columns.
-0001a1c0: 0a20 2020 2020 2020 2020 2020 202d 2049  .            - I
-0001a1d0: 6e73 7461 6e63 6520 6f66 2060 6052 616e  nstance of ``Ran
-0001a1e0: 6765 6060 2063 6f6e 7374 7261 696e 7420  ge`` constraint 
-0001a1f0: 7769 7468 2074 686f 7365 2074 6872 6565  with those three
-0001a200: 2063 6f6c 756d 6e20 6e61 6d65 732e 0a0a   column names...
-0001a210: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
-0001a220: 2020 2020 2020 2020 2020 202d 2070 642e             - pd.
-0001a230: 4461 7461 4672 616d 6520 7769 7468 2060  DataFrame with `
-0001a240: 6061 6765 5f77 6865 6e5f 6a6f 696e 6564  `age_when_joined
-0001a250: 6060 2c20 6060 6375 7272 656e 745f 6167  ``, ``current_ag
-0001a260: 6560 602c 2060 6072 6574 6972 656d 656e  e``, ``retiremen
-0001a270: 745f 6167 6560 6020 636f 6c75 6d6e 732e  t_age`` columns.
-0001a280: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001a290: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
-0001a2a0: 2020 2020 2074 6162 6c65 5f64 6174 6120       table_data 
-0001a2b0: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
-0001a2c0: 0a20 2020 2020 2020 2020 2020 2027 6167  .            'ag
-0001a2d0: 655f 7768 656e 5f6a 6f69 6e65 6427 3a20  e_when_joined': 
-0001a2e0: 5b32 312c 2031 392c 2032 305d 2c0a 2020  [21, 19, 20],.  
-0001a2f0: 2020 2020 2020 2020 2020 2763 7572 7265            'curre
-0001a300: 6e74 5f61 6765 273a 205b 3231 2c20 3232  nt_age': [21, 22
-0001a310: 2c20 3235 5d2c 0a20 2020 2020 2020 2020  , 25],.         
-0001a320: 2020 2027 7265 7469 7265 6d65 6e74 5f61     'retirement_a
-0001a330: 6765 273a 205b 3635 2c20 3638 2c20 3735  ge': [65, 68, 75
-0001a340: 5d0a 2020 2020 2020 2020 7d29 0a20 2020  ].        }).   
-0001a350: 2020 2020 2069 6e73 7461 6e63 6520 3d20       instance = 
-0001a360: 5261 6e67 6528 0a20 2020 2020 2020 2020  Range(.         
-0001a370: 2020 2027 6167 655f 7768 656e 5f6a 6f69     'age_when_joi
-0001a380: 6e65 6427 2c0a 2020 2020 2020 2020 2020  ned',.          
-0001a390: 2020 2763 7572 7265 6e74 5f61 6765 272c    'current_age',
-0001a3a0: 0a20 2020 2020 2020 2020 2020 2027 7265  .            're
-0001a3b0: 7469 7265 6d65 6e74 5f61 6765 272c 0a20  tirement_age',. 
-0001a3c0: 2020 2020 2020 2020 2020 2073 7472 6963             stric
-0001a3d0: 745f 626f 756e 6461 7269 6573 3d46 616c  t_boundaries=Fal
-0001a3e0: 7365 0a20 2020 2020 2020 2029 0a0a 2020  se.        )..  
-0001a3f0: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
-0001a400: 2020 2020 7265 7375 6c74 203d 2069 6e73      result = ins
-0001a410: 7461 6e63 652e 6973 5f76 616c 6964 2874  tance.is_valid(t
-0001a420: 6162 6c65 5f64 6174 6129 0a0a 2020 2020  able_data)..    
-0001a430: 2020 2020 2320 4173 7365 7274 0a20 2020      # Assert.   
-0001a440: 2020 2020 2061 7373 6572 7420 616c 6c28       assert all(
-0001a450: 7265 7375 6c74 290a 0a20 2020 2064 6566  result)..    def
-0001a460: 2074 6573 745f 6973 5f76 616c 6964 5f69   test_is_valid_i
-0001a470: 6e76 616c 6964 2873 656c 6629 3a0a 2020  nvalid(self):.  
-0001a480: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-0001a490: 6520 6060 5261 6e67 652e 6973 5f76 616c  e ``Range.is_val
-0001a4a0: 6964 6060 2e0a 0a20 2020 2020 2020 2054  id``...        T
-0001a4b0: 6869 7320 7465 7374 2065 6e73 7572 6573  his test ensures
-0001a4c0: 2074 6861 7420 7468 6520 6060 6973 5f76   that the ``is_v
-0001a4d0: 616c 6964 6060 2066 6169 6c73 2077 6865  alid`` fails whe
-0001a4e0: 6e20 7468 6520 6461 7461 2069 7320 6e6f  n the data is no
-0001a4f0: 7420 696e 2074 6865 2072 616e 6765 2e0a  t in the range..
-0001a500: 0a20 2020 2020 2020 2053 6574 7570 3a0a  .        Setup:.
-0001a510: 2020 2020 2020 2020 2020 2020 2d20 4372              - Cr
-0001a520: 6561 7465 2061 2070 642e 4461 7461 4672  eate a pd.DataFr
-0001a530: 616d 6520 7769 7468 2074 6872 6565 2063  ame with three c
-0001a540: 6f6c 756d 6e73 2e0a 2020 2020 2020 2020  olumns..        
-0001a550: 2020 2020 2d20 496e 7374 616e 6365 206f      - Instance o
-0001a560: 6620 6060 5261 6e67 6560 6020 636f 6e73  f ``Range`` cons
-0001a570: 7472 6169 6e74 2077 6974 6820 7468 6f73  traint with thos
-0001a580: 6520 7468 7265 6520 636f 6c75 6d6e 206e  e three column n
-0001a590: 616d 6573 2e0a 0a20 2020 2020 2020 2049  ames...        I
-0001a5a0: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
-0001a5b0: 2020 2d20 7064 2e44 6174 6146 7261 6d65    - pd.DataFrame
-0001a5c0: 2077 6974 6820 6060 6167 655f 7768 656e   with ``age_when
-0001a5d0: 5f6a 6f69 6e65 6460 602c 2060 6063 7572  _joined``, ``cur
-0001a5e0: 7265 6e74 5f61 6765 6060 2c20 6060 7265  rent_age``, ``re
-0001a5f0: 7469 7265 6d65 6e74 5f61 6765 6060 2063  tirement_age`` c
-0001a600: 6f6c 756d 6e73 2e0a 2020 2020 2020 2020  olumns..        
-0001a610: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
-0001a620: 7475 700a 2020 2020 2020 2020 7461 626c  tup.        tabl
-0001a630: 655f 6461 7461 203d 2070 642e 4461 7461  e_data = pd.Data
-0001a640: 4672 616d 6528 7b0a 2020 2020 2020 2020  Frame({.        
-0001a650: 2020 2020 2761 6765 5f77 6865 6e5f 6a6f      'age_when_jo
-0001a660: 696e 6564 273a 205b 3730 2c20 3139 2c20  ined': [70, 19, 
-0001a670: 3230 5d2c 0a20 2020 2020 2020 2020 2020  20],.           
-0001a680: 2027 6375 7272 656e 745f 6167 6527 3a20   'current_age': 
-0001a690: 5b32 312c 2032 322c 2032 355d 2c0a 2020  [21, 22, 25],.  
-0001a6a0: 2020 2020 2020 2020 2020 2772 6574 6972            'retir
-0001a6b0: 656d 656e 745f 6167 6527 3a20 5b36 352c  ement_age': [65,
-0001a6c0: 2036 382c 2037 355d 0a20 2020 2020 2020   68, 75].       
-0001a6d0: 207d 290a 2020 2020 2020 2020 696e 7374   }).        inst
-0001a6e0: 616e 6365 203d 2052 616e 6765 280a 2020  ance = Range(.  
-0001a6f0: 2020 2020 2020 2020 2020 2761 6765 5f77            'age_w
-0001a700: 6865 6e5f 6a6f 696e 6564 272c 0a20 2020  hen_joined',.   
-0001a710: 2020 2020 2020 2020 2027 6375 7272 656e           'curren
-0001a720: 745f 6167 6527 2c0a 2020 2020 2020 2020  t_age',.        
-0001a730: 2020 2020 2772 6574 6972 656d 656e 745f      'retirement_
-0001a740: 6167 6527 2c0a 2020 2020 2020 2020 2020  age',.          
-0001a750: 2020 7374 7269 6374 5f62 6f75 6e64 6172    strict_boundar
-0001a760: 6965 733d 4661 6c73 650a 2020 2020 2020  ies=False.      
-0001a770: 2020 290a 0a20 2020 2020 2020 2023 2052    )..        # R
-0001a780: 756e 0a20 2020 2020 2020 2072 6573 756c  un.        resul
-0001a790: 7420 3d20 696e 7374 616e 6365 2e69 735f  t = instance.is_
-0001a7a0: 7661 6c69 6428 7461 626c 655f 6461 7461  valid(table_data
-0001a7b0: 290a 0a20 2020 2020 2020 2023 2041 7373  )..        # Ass
-0001a7c0: 6572 740a 2020 2020 2020 2020 6173 7365  ert.        asse
-0001a7d0: 7274 206e 6f74 2061 6c6c 2872 6573 756c  rt not all(resul
-0001a7e0: 7429 0a0a 2020 2020 4070 6174 6368 2827  t)..    @patch('
-0001a7f0: 7364 762e 636f 6e73 7472 6169 6e74 732e  sdv.constraints.
-0001a800: 7461 6275 6c61 722e 6c6f 6769 7427 290a  tabular.logit').
-0001a810: 2020 2020 6465 6620 7465 7374 5f5f 7472      def test__tr
-0001a820: 616e 7366 6f72 6d28 7365 6c66 2c20 6d6f  ansform(self, mo
-0001a830: 636b 5f6c 6f67 6974 293a 0a20 2020 2020  ck_logit):.     
-0001a840: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-0001a850: 6052 616e 6765 2e5f 7472 616e 7366 6f72  `Range._transfor
-0001a860: 6d60 6020 6d65 7468 6f64 2e0a 0a20 2020  m`` method...   
-0001a870: 2020 2020 2049 7420 6973 2065 7870 6563       It is expec
-0001a880: 7465 6420 746f 2063 7265 6174 6520 6120  ted to create a 
-0001a890: 6e65 7720 636f 6c75 6d6e 2073 696d 696c  new column simil
-0001a8a0: 6172 2074 6f20 7468 6520 636f 6e73 7472  ar to the constr
-0001a8b0: 6169 6e74 2060 6063 6f6c 756d 6e60 602c  aint ``column``,
-0001a8c0: 2061 6e64 2074 6865 6e0a 2020 2020 2020   and then.      
-0001a8d0: 2020 7363 616c 6520 616e 6420 6170 706c    scale and appl
-0001a8e0: 7920 6120 6c6f 6769 7420 6675 6e63 7469  y a logit functi
-0001a8f0: 6f6e 2074 6f20 7468 6174 2063 6f6c 756d  on to that colum
-0001a900: 6e2e 0a0a 2020 2020 2020 2020 4d6f 636b  n...        Mock
-0001a910: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-0001a920: 4d6f 636b 2074 6865 2060 606c 6f67 6974  Mock the ``logit
-0001a930: 6060 2066 756e 6374 696f 6e2e 0a20 2020  `` function..   
-0001a940: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-0001a950: 2020 2020 2020 2020 2d20 7064 2e44 6174          - pd.Dat
-0001a960: 6146 7261 6d65 2077 6974 6820 6060 6167  aFrame with ``ag
-0001a970: 655f 7768 656e 5f6a 6f69 6e65 6460 602c  e_when_joined``,
-0001a980: 2060 6063 7572 7265 6e74 5f61 6765 6060   ``current_age``
-0001a990: 2c20 6060 7265 7469 7265 6d65 6e74 5f61  , ``retirement_a
-0001a9a0: 6765 6060 2063 6f6c 756d 6e73 2e0a 0a20  ge`` columns... 
-0001a9b0: 2020 2020 2020 204f 7574 7075 743a 0a20         Output:. 
-0001a9c0: 2020 2020 2020 2020 2020 202d 2070 642e             - pd.
-0001a9d0: 4461 7461 4672 616d 6520 7769 7468 2061  DataFrame with a
-0001a9e0: 6e20 6578 7472 6120 636f 6c75 6d6e 2063  n extra column c
-0001a9f0: 6f6e 7461 696e 696e 6720 7468 6520 7472  ontaining the tr
-0001aa00: 616e 7366 6f72 6d65 6420 6060 636f 6c75  ansformed ``colu
-0001aa10: 6d6e 6060 2e0a 2020 2020 2020 2020 2222  mn``..        ""
-0001aa20: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
-0001aa30: 700a 2020 2020 2020 2020 7461 626c 655f  p.        table_
-0001aa40: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
-0001aa50: 616d 6528 7b0a 2020 2020 2020 2020 2020  ame({.          
-0001aa60: 2020 2761 6765 5f77 6865 6e5f 6a6f 696e    'age_when_join
-0001aa70: 6564 273a 205b 3138 2c20 3139 2c20 3230  ed': [18, 19, 20
-0001aa80: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
-0001aa90: 6375 7272 656e 745f 6167 6527 3a20 5b32  current_age': [2
-0001aaa0: 312c 2032 322c 2032 355d 2c0a 2020 2020  1, 22, 25],.    
-0001aab0: 2020 2020 2020 2020 2772 6574 6972 656d          'retirem
-0001aac0: 656e 745f 6167 6527 3a20 5b36 352c 2036  ent_age': [65, 6
-0001aad0: 382c 2037 355d 0a20 2020 2020 2020 207d  8, 75].        }
-0001aae0: 290a 2020 2020 2020 2020 6d6f 636b 5f6c  ).        mock_l
-0001aaf0: 6f67 6974 2e72 6574 7572 6e5f 7661 6c75  ogit.return_valu
-0001ab00: 6520 3d20 5b31 2c20 322c 2033 5d0a 2020  e = [1, 2, 3].  
-0001ab10: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
-0001ab20: 2052 616e 6765 2827 6167 655f 7768 656e   Range('age_when
-0001ab30: 5f6a 6f69 6e65 6427 2c20 2763 7572 7265  _joined', 'curre
-0001ab40: 6e74 5f61 6765 272c 2027 7265 7469 7265  nt_age', 'retire
-0001ab50: 6d65 6e74 5f61 6765 2729 0a0a 2020 2020  ment_age')..    
-0001ab60: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
-0001ab70: 2020 696e 7374 616e 6365 2e66 6974 2874    instance.fit(t
-0001ab80: 6162 6c65 5f64 6174 6129 0a20 2020 2020  able_data).     
-0001ab90: 2020 206f 7574 203d 2069 6e73 7461 6e63     out = instanc
-0001aba0: 652e 5f74 7261 6e73 666f 726d 2874 6162  e._transform(tab
-0001abb0: 6c65 5f64 6174 6129 0a0a 2020 2020 2020  le_data)..      
-0001abc0: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
-0001abd0: 2020 2065 7870 6563 7465 645f 6f75 7420     expected_out 
-0001abe0: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
-0001abf0: 0a20 2020 2020 2020 2020 2020 2027 6167  .            'ag
-0001ac00: 655f 7768 656e 5f6a 6f69 6e65 6427 3a20  e_when_joined': 
-0001ac10: 5b31 382c 2031 392c 2032 305d 2c0a 2020  [18, 19, 20],.  
-0001ac20: 2020 2020 2020 2020 2020 2772 6574 6972            'retir
-0001ac30: 656d 656e 745f 6167 6527 3a20 5b36 352c  ement_age': [65,
-0001ac40: 2036 382c 2037 355d 2c0a 2020 2020 2020   68, 75],.      
-0001ac50: 2020 2020 2020 2763 7572 7265 6e74 5f61        'current_a
-0001ac60: 6765 2361 6765 5f77 6865 6e5f 6a6f 696e  ge#age_when_join
-0001ac70: 6564 2372 6574 6972 656d 656e 745f 6167  ed#retirement_ag
-0001ac80: 6527 3a20 5b31 2c20 322c 2033 5d0a 2020  e': [1, 2, 3].  
-0001ac90: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
-0001aca0: 206d 6f63 6b5f 6c6f 6769 742e 6173 7365   mock_logit.asse
-0001acb0: 7274 5f63 616c 6c65 645f 6f6e 6365 2829  rt_called_once()
-0001acc0: 0a20 2020 2020 2020 2070 642e 7465 7374  .        pd.test
-0001acd0: 696e 672e 6173 7365 7274 5f66 7261 6d65  ing.assert_frame
-0001ace0: 5f65 7175 616c 2865 7870 6563 7465 645f  _equal(expected_
-0001acf0: 6f75 742c 206f 7574 290a 0a20 2020 2040  out, out)..    @
-0001ad00: 7061 7463 6828 2773 6476 2e63 6f6e 7374  patch('sdv.const
-0001ad10: 7261 696e 7473 2e74 6162 756c 6172 2e73  raints.tabular.s
-0001ad20: 6967 6d6f 6964 2729 0a20 2020 2064 6566  igmoid').    def
-0001ad30: 2074 6573 745f 7265 7665 7273 655f 7472   test_reverse_tr
-0001ad40: 616e 7366 6f72 6d28 7365 6c66 2c20 6d6f  ansform(self, mo
-0001ad50: 636b 5f73 6967 6d6f 6964 293a 0a20 2020  ck_sigmoid):.   
-0001ad60: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
-0001ad70: 2060 6072 6576 6572 7365 5f74 7261 6e73   ``reverse_trans
-0001ad80: 666f 726d 6060 206d 6574 686f 6420 666f  form`` method fo
-0001ad90: 7220 6060 5261 6e67 6560 602e 0a0a 2020  r ``Range``...  
-0001ada0: 2020 2020 2020 4974 2069 7320 6578 7065        It is expe
-0001adb0: 6374 6564 2074 6f20 7265 636f 7665 7220  cted to recover 
-0001adc0: 7468 6520 6f72 6967 696e 616c 2074 6162  the original tab
-0001add0: 6c65 2077 6869 6368 2077 6173 2074 7261  le which was tra
-0001ade0: 6e73 666f 726d 6564 2c20 6275 7420 7769  nsformed, but wi
-0001adf0: 7468 2064 6966 6665 7265 6e74 0a20 2020  th different.   
-0001ae00: 2020 2020 2063 6f6c 756d 6e20 6f72 6465       column orde
-0001ae10: 722e 2049 7420 646f 6573 2073 6f20 6279  r. It does so by
-0001ae20: 2061 7070 6c79 696e 6720 6120 7369 676d   applying a sigm
-0001ae30: 6f69 6420 746f 2074 6865 2074 7261 6e73  oid to the trans
-0001ae40: 666f 726d 6564 2063 6f6c 756d 6e20 616e  formed column an
-0001ae50: 6420 7468 656e 0a20 2020 2020 2020 2073  d then.        s
-0001ae60: 6361 6c69 6e67 2069 7420 6261 636b 2074  caling it back t
-0001ae70: 6f20 7468 6520 6f72 6967 696e 616c 2073  o the original s
-0001ae80: 7061 6365 2e20 4974 2061 6c73 6f20 7265  pace. It also re
-0001ae90: 706c 6163 6573 2074 6865 2074 7261 6e73  places the trans
-0001aea0: 666f 726d 6564 2063 6f6c 756d 6e20 7769  formed column wi
-0001aeb0: 7468 0a20 2020 2020 2020 2061 6e20 6571  th.        an eq
-0001aec0: 7561 6c20 636f 6c75 6d6e 2062 7574 2077  ual column but w
-0001aed0: 6974 6820 7468 6520 6f72 6967 696e 616c  ith the original
-0001aee0: 206e 616d 652e 0a0a 2020 2020 2020 2020   name...        
-0001aef0: 4d6f 636b 3a0a 2020 2020 2020 2020 2020  Mock:.          
-0001af00: 2020 2d20 4d6f 636b 2074 6865 2073 6967    - Mock the sig
-0001af10: 6f6d 6964 2066 756e 6374 696f 6e2e 0a20  omid function.. 
-0001af20: 2020 2020 2020 2053 6574 7570 3a0a 2020         Setup:.  
-0001af30: 2020 2020 2020 2020 2020 2d20 4f72 6967            - Orig
-0001af40: 696e 616c 2074 6162 6c65 2064 6174 612e  inal table data.
-0001af50: 0a20 2020 2020 2020 2020 2020 202d 2041  .            - A
-0001af60: 6e20 6578 7065 6374 6564 2074 7261 6e73  n expected trans
-0001af70: 666f 726d 6564 2064 6174 6120 7769 7468  formed data with
-0001af80: 2074 6865 2065 7870 6563 7465 6420 636f   the expected co
-0001af90: 6c75 6d6e 206e 616d 652e 0a20 2020 2020  lumn name..     
-0001afa0: 2020 2020 2020 202d 2049 6e73 7461 6e63         - Instanc
-0001afb0: 6520 6f66 2052 616e 6765 2063 6f6e 7374  e of Range const
-0001afc0: 7261 696e 742e 0a0a 2020 2020 2020 2020  raint...        
-0001afd0: 4f75 7470 7574 3a0a 2020 2020 2020 2020  Output:.        
-0001afe0: 2020 2020 2d20 4120 7064 2e44 6174 6146      - A pd.DataF
-0001aff0: 7261 6d65 2063 6f6e 7461 696e 696e 6720  rame containing 
-0001b000: 7468 6520 6f72 6967 696e 616c 2064 6174  the original dat
-0001b010: 612e 0a20 2020 2020 2020 2022 2222 0a20  a..        """. 
-0001b020: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
-0001b030: 2020 2020 2020 2074 6162 6c65 5f64 6174         table_dat
-0001b040: 6120 3d20 7064 2e44 6174 6146 7261 6d65  a = pd.DataFrame
-0001b050: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
-0001b060: 6167 655f 7768 656e 5f6a 6f69 6e65 6427  age_when_joined'
-0001b070: 3a20 5b31 382c 2031 392c 2032 305d 2c0a  : [18, 19, 20],.
-0001b080: 2020 2020 2020 2020 2020 2020 2772 6574              'ret
-0001b090: 6972 656d 656e 745f 6167 6527 3a20 5b36  irement_age': [6
-0001b0a0: 352c 2036 382c 2037 355d 2c0a 2020 2020  5, 68, 75],.    
-0001b0b0: 2020 2020 2020 2020 2763 7572 7265 6e74          'current
-0001b0c0: 5f61 6765 273a 205b 3231 2c20 3232 2c20  _age': [21, 22, 
-0001b0d0: 3235 5d2c 0a20 2020 2020 2020 207d 290a  25],.        }).
-0001b0e0: 2020 2020 2020 2020 6d6f 636b 5f73 6967          mock_sig
-0001b0f0: 6d6f 6964 2e72 6574 7572 6e5f 7661 6c75  moid.return_valu
-0001b100: 6520 3d20 7064 2e53 6572 6965 7328 5b32  e = pd.Series([2
-0001b110: 312c 2032 322c 2032 355d 290a 2020 2020  1, 22, 25]).    
-0001b120: 2020 2020 7472 616e 7366 6f72 6d65 645f      transformed_
-0001b130: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
-0001b140: 616d 6528 7b0a 2020 2020 2020 2020 2020  ame({.          
-0001b150: 2020 2761 6765 5f77 6865 6e5f 6a6f 696e    'age_when_join
-0001b160: 6564 273a 205b 3138 2c20 3139 2c20 3230  ed': [18, 19, 20
-0001b170: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
-0001b180: 7265 7469 7265 6d65 6e74 5f61 6765 273a  retirement_age':
-0001b190: 205b 3635 2c20 3638 2c20 3735 5d2c 0a20   [65, 68, 75],. 
-0001b1a0: 2020 2020 2020 2020 2020 2027 6375 7272             'curr
-0001b1b0: 656e 745f 6167 6523 6167 655f 7768 656e  ent_age#age_when
-0001b1c0: 5f6a 6f69 6e65 6423 7265 7469 7265 6d65  _joined#retireme
-0001b1d0: 6e74 5f61 6765 273a 205b 312c 2032 2c20  nt_age': [1, 2, 
-0001b1e0: 335d 0a20 2020 2020 2020 207d 290a 2020  3].        }).  
-0001b1f0: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
-0001b200: 2052 616e 6765 2827 6167 655f 7768 656e   Range('age_when
-0001b210: 5f6a 6f69 6e65 6427 2c20 2763 7572 7265  _joined', 'curre
-0001b220: 6e74 5f61 6765 272c 2027 7265 7469 7265  nt_age', 'retire
-0001b230: 6d65 6e74 5f61 6765 2729 0a0a 2020 2020  ment_age')..    
-0001b240: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
-0001b250: 2020 696e 7374 616e 6365 2e66 6974 2874    instance.fit(t
-0001b260: 6162 6c65 5f64 6174 6129 0a20 2020 2020  able_data).     
-0001b270: 2020 206f 7574 203d 2069 6e73 7461 6e63     out = instanc
-0001b280: 652e 7265 7665 7273 655f 7472 616e 7366  e.reverse_transf
-0001b290: 6f72 6d28 7472 616e 7366 6f72 6d65 645f  orm(transformed_
-0001b2a0: 6461 7461 290a 0a20 2020 2020 2020 2023  data)..        #
-0001b2b0: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-0001b2c0: 6d6f 636b 5f73 6967 6d6f 6964 2e61 7373  mock_sigmoid.ass
-0001b2d0: 6572 745f 6361 6c6c 6564 5f6f 6e63 6528  ert_called_once(
-0001b2e0: 290a 2020 2020 2020 2020 7064 2e74 6573  ).        pd.tes
-0001b2f0: 7469 6e67 2e61 7373 6572 745f 6672 616d  ting.assert_fram
-0001b300: 655f 6571 7561 6c28 7461 626c 655f 6461  e_equal(table_da
-0001b310: 7461 2c20 6f75 7429 0a0a 2020 2020 4070  ta, out)..    @p
-0001b320: 6174 6368 2827 7364 762e 636f 6e73 7472  atch('sdv.constr
-0001b330: 6169 6e74 732e 7461 6275 6c61 722e 7064  aints.tabular.pd
-0001b340: 2729 0a20 2020 2040 7061 7463 6828 2773  ').    @patch('s
-0001b350: 6476 2e63 6f6e 7374 7261 696e 7473 2e74  dv.constraints.t
-0001b360: 6162 756c 6172 2e73 6967 6d6f 6964 2729  abular.sigmoid')
-0001b370: 0a20 2020 2064 6566 2074 6573 745f 7265  .    def test_re
-0001b380: 7665 7273 655f 7472 616e 7366 6f72 6d5f  verse_transform_
-0001b390: 6973 5f64 6174 6574 696d 6528 7365 6c66  is_datetime(self
-0001b3a0: 2c20 6d6f 636b 5f73 6967 6d6f 6964 2c20  , mock_sigmoid, 
-0001b3b0: 6d6f 636b 5f70 6429 3a0a 2020 2020 2020  mock_pd):.      
-0001b3c0: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
-0001b3d0: 7265 7665 7273 655f 7472 616e 7366 6f72  reverse_transfor
-0001b3e0: 6d60 6020 6d65 7468 6f64 2066 6f72 2060  m`` method for `
-0001b3f0: 6052 616e 6765 6060 2e0a 0a20 2020 2020  `Range``...     
-0001b400: 2020 2057 6865 6e20 6060 696e 7374 616e     When ``instan
-0001b410: 6365 2e5f 6973 5f64 6174 6574 696d 6560  ce._is_datetime`
-0001b420: 6020 6973 2060 6054 7275 6560 602c 2074  ` is ``True``, t
-0001b430: 6865 2064 6174 6120 7368 6f75 6c64 2062  he data should b
-0001b440: 6520 636f 6e76 6572 7465 640a 2020 2020  e converted.    
-0001b450: 2020 2020 746f 2060 6070 616e 6461 732e      to ``pandas.
-0001b460: 746f 5f64 6174 6574 696d 6560 602e 0a0a  to_datetime``...
-0001b470: 2020 2020 2020 2020 4d6f 636b 3a0a 2020          Mock:.  
-0001b480: 2020 2020 2020 2020 2020 2d20 4d6f 636b            - Mock
-0001b490: 2074 6865 2073 6967 6d6f 6964 2066 756e   the sigmoid fun
-0001b4a0: 6374 696f 6e2e 0a20 2020 2020 2020 2020  ction..         
-0001b4b0: 2020 202d 204d 6f63 6b20 7061 6e64 6173     - Mock pandas
-0001b4c0: 2e0a 0a20 2020 2020 2020 2053 6574 7570  ...        Setup
-0001b4d0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-0001b4e0: 4f72 6967 696e 616c 2074 6162 6c65 2064  Original table d
-0001b4f0: 6174 612e 0a20 2020 2020 2020 2020 2020  ata..           
-0001b500: 202d 2041 6e20 6578 7065 6374 6564 2074   - An expected t
-0001b510: 7261 6e73 666f 726d 6564 2064 6174 612e  ransformed data.
-0001b520: 0a20 2020 2020 2020 2020 2020 202d 2049  .            - I
-0001b530: 6e73 7461 6e63 6520 6f66 2053 6361 6c61  nstance of Scala
-0001b540: 7252 616e 6765 2063 6f6e 7374 7261 696e  rRange constrain
-0001b550: 742e 0a0a 2020 2020 2020 2020 4f75 7470  t...        Outp
-0001b560: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
-0001b570: 2d20 4120 7064 2e44 6174 6146 7261 6d65  - A pd.DataFrame
-0001b580: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-0001b590: 6f72 6967 696e 616c 2064 6174 612e 0a0a  original data...
-0001b5a0: 2020 2020 2020 2020 5369 6465 2045 6666          Side Eff
-0001b5b0: 6563 7473 3a0a 2020 2020 2020 2020 2020  ects:.          
-0001b5c0: 2020 2d20 6060 6d6f 636b 5f70 6460 6020    - ``mock_pd`` 
-0001b5d0: 6861 7320 746f 2062 6520 6361 6c6c 6564  has to be called
-0001b5e0: 206f 6e63 652e 0a20 2020 2020 2020 2022   once..        "
-0001b5f0: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
-0001b600: 7570 0a20 2020 2020 2020 2074 6162 6c65  up.        table
-0001b610: 5f64 6174 6120 3d20 7064 2e44 6174 6146  _data = pd.DataF
-0001b620: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
-0001b630: 2020 2027 6167 655f 7768 656e 5f6a 6f69     'age_when_joi
-0001b640: 6e65 6427 3a20 5b31 382c 2031 392c 2032  ned': [18, 19, 2
-0001b650: 305d 2c0a 2020 2020 2020 2020 2020 2020  0],.            
-0001b660: 2772 6574 6972 656d 656e 745f 6167 6527  'retirement_age'
-0001b670: 3a20 5b36 352c 2036 382c 2037 355d 2c0a  : [65, 68, 75],.
-0001b680: 2020 2020 2020 2020 2020 2020 2763 7572              'cur
-0001b690: 7265 6e74 5f61 6765 273a 205b 3231 2c20  rent_age': [21, 
-0001b6a0: 3232 2c20 3235 5d2c 0a20 2020 2020 2020  22, 25],.       
-0001b6b0: 207d 290a 2020 2020 2020 2020 6d6f 636b   }).        mock
-0001b6c0: 5f73 6967 6d6f 6964 2e72 6574 7572 6e5f  _sigmoid.return_
-0001b6d0: 7661 6c75 6520 3d20 7064 2e53 6572 6965  value = pd.Serie
-0001b6e0: 7328 5b32 312c 2032 322c 2032 355d 290a  s([21, 22, 25]).
-0001b6f0: 2020 2020 2020 2020 7472 616e 7366 6f72          transfor
-0001b700: 6d65 645f 6461 7461 203d 2070 642e 4461  med_data = pd.Da
-0001b710: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
-0001b720: 2020 2020 2020 2761 6765 5f77 6865 6e5f        'age_when_
-0001b730: 6a6f 696e 6564 273a 205b 3138 2c20 3139  joined': [18, 19
-0001b740: 2c20 3230 5d2c 0a20 2020 2020 2020 2020  , 20],.         
-0001b750: 2020 2027 7265 7469 7265 6d65 6e74 5f61     'retirement_a
-0001b760: 6765 273a 205b 3635 2c20 3638 2c20 3735  ge': [65, 68, 75
-0001b770: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
-0001b780: 6375 7272 656e 745f 6167 6523 6167 655f  current_age#age_
-0001b790: 7768 656e 5f6a 6f69 6e65 6423 7265 7469  when_joined#reti
-0001b7a0: 7265 6d65 6e74 5f61 6765 273a 205b 312c  rement_age': [1,
-0001b7b0: 2032 2c20 335d 0a20 2020 2020 2020 207d   2, 3].        }
-0001b7c0: 290a 2020 2020 2020 2020 6d6f 636b 5f70  ).        mock_p
-0001b7d0: 642e 746f 5f64 6174 6574 696d 652e 7369  d.to_datetime.si
-0001b7e0: 6465 5f65 6666 6563 7420 3d20 6c61 6d62  de_effect = lamb
-0001b7f0: 6461 2078 3a20 780a 0a20 2020 2020 2020  da x: x..       
-0001b800: 2069 6e73 7461 6e63 6520 3d20 5261 6e67   instance = Rang
-0001b810: 6528 2761 6765 5f77 6865 6e5f 6a6f 696e  e('age_when_join
-0001b820: 6564 272c 2027 6375 7272 656e 745f 6167  ed', 'current_ag
-0001b830: 6527 2c20 2772 6574 6972 656d 656e 745f  e', 'retirement_
-0001b840: 6167 6527 290a 2020 2020 2020 2020 696e  age').        in
-0001b850: 7374 616e 6365 2e5f 7472 616e 7366 6f72  stance._transfor
-0001b860: 6d65 645f 636f 6c75 6d6e 203d 2027 6375  med_column = 'cu
-0001b870: 7272 656e 745f 6167 6523 6167 655f 7768  rrent_age#age_wh
-0001b880: 656e 5f6a 6f69 6e65 6423 7265 7469 7265  en_joined#retire
-0001b890: 6d65 6e74 5f61 6765 270a 2020 2020 2020  ment_age'.      
-0001b8a0: 2020 696e 7374 616e 6365 2e5f 6973 5f64    instance._is_d
-0001b8b0: 6174 6574 696d 6520 3d20 5472 7565 0a0a  atetime = True..
-0001b8c0: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
-0001b8d0: 2020 2020 2020 6f75 7420 3d20 696e 7374        out = inst
-0001b8e0: 616e 6365 2e72 6576 6572 7365 5f74 7261  ance.reverse_tra
-0001b8f0: 6e73 666f 726d 2874 7261 6e73 666f 726d  nsform(transform
-0001b900: 6564 5f64 6174 6129 0a0a 2020 2020 2020  ed_data)..      
-0001b910: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
-0001b920: 2020 2070 642e 7465 7374 696e 672e 6173     pd.testing.as
-0001b930: 7365 7274 5f66 7261 6d65 5f65 7175 616c  sert_frame_equal
-0001b940: 2874 6162 6c65 5f64 6174 612c 206f 7574  (table_data, out
-0001b950: 290a 2020 2020 2020 2020 6d6f 636b 5f73  ).        mock_s
-0001b960: 6967 6d6f 6964 2e61 7373 6572 745f 6361  igmoid.assert_ca
-0001b970: 6c6c 6564 5f6f 6e63 6528 290a 2020 2020  lled_once().    
-0001b980: 2020 2020 6d6f 636b 5f70 642e 746f 5f64      mock_pd.to_d
-0001b990: 6174 6574 696d 652e 6173 7365 7274 5f63  atetime.assert_c
-0001b9a0: 616c 6c65 645f 6f6e 6365 2829 0a0a 0a63  alled_once()...c
-0001b9b0: 6c61 7373 2054 6573 7453 6361 6c61 7252  lass TestScalarR
-0001b9c0: 616e 6765 2829 3a0a 0a20 2020 2064 6566  ange():..    def
-0001b9d0: 2074 6573 745f 5f76 616c 6964 6174 655f   test__validate_
-0001b9e0: 696e 7075 7473 2873 656c 6629 3a0a 2020  inputs(self):.  
-0001b9f0: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-0001ba00: 6520 6060 5363 616c 6172 5261 6e67 652e  e ``ScalarRange.
-0001ba10: 5f76 616c 6964 6174 655f 696e 7075 7473  _validate_inputs
-0001ba20: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
-0001ba30: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
-0001ba40: 2020 202d 2020 496e 636f 7272 6563 7420     -  Incorrect 
-0001ba50: 7061 7261 6d65 7465 7273 2066 6f72 2074  parameters for t
-0001ba60: 6865 206d 6574 686f 640a 2020 2020 2020  he method.      
-0001ba70: 2020 5261 6973 6573 3a0a 2020 2020 2020    Raises:.      
-0001ba80: 2020 2d20 4c69 7374 206f 6620 5661 6c75    - List of Valu
-0001ba90: 6545 7272 6f72 730a 2020 2020 2020 2020  eErrors.        
-0001baa0: 2222 220a 2020 2020 2020 2020 2320 5275  """.        # Ru
-0001bab0: 6e20 2f20 4173 7365 7274 0a20 2020 2020  n / Assert.     
-0001bac0: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-0001bad0: 6169 7365 7328 4167 6772 6567 6174 6543  aises(AggregateC
-0001bae0: 6f6e 7374 7261 696e 7473 4572 726f 7229  onstraintsError)
-0001baf0: 2061 7320 6572 726f 723a 0a20 2020 2020   as error:.     
-0001bb00: 2020 2020 2020 2053 6361 6c61 7252 616e         ScalarRan
-0001bb10: 6765 2e5f 7661 6c69 6461 7465 5f69 6e70  ge._validate_inp
-0001bb20: 7574 7328 6e6f 745f 6869 6768 5f63 6f6c  uts(not_high_col
-0001bb30: 756d 6e3d 4e6f 6e65 2c20 6e6f 745f 6c6f  umn=None, not_lo
-0001bb40: 775f 636f 6c75 6d6e 3d4e 6f6e 6529 0a0a  w_column=None)..
-0001bb50: 2020 2020 2020 2020 6572 725f 6d73 6720          err_msg 
-0001bb60: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-0001bb70: 7227 4d69 7373 696e 6720 7265 7175 6972  r'Missing requir
-0001bb80: 6564 2076 616c 7565 7320 7b28 2e2a 297d  ed values {(.*)}
-0001bb90: 2069 6e20 6120 5363 616c 6172 5261 6e67   in a ScalarRang
-0001bba0: 6520 636f 6e73 7472 6169 6e74 2e27 0a20  e constraint.'. 
-0001bbb0: 2020 2020 2020 2020 2020 2072 275c 6e5c             r'\n\
-0001bbc0: 6e49 6e76 616c 6964 2076 616c 7565 7320  nInvalid values 
-0001bbd0: 7b28 2e2a 297d 2061 7265 2070 7265 7365  {(.*)} are prese
-0001bbe0: 6e74 2069 6e20 6120 5363 616c 6172 5261  nt in a ScalarRa
-0001bbf0: 6e67 6520 636f 6e73 7472 6169 6e74 2e27  nge constraint.'
-0001bc00: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0001bc10: 2020 2067 726f 7570 7320 3d20 7265 2e73     groups = re.s
-0001bc20: 6561 7263 6828 6572 725f 6d73 672c 2073  earch(err_msg, s
-0001bc30: 7472 2865 7272 6f72 2e76 616c 7565 2929  tr(error.value))
-0001bc40: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001bc50: 6772 6f75 7073 2069 7320 6e6f 7420 4e6f  groups is not No
-0001bc60: 6e65 0a20 2020 2020 2020 2061 7373 6572  ne.        asser
-0001bc70: 7420 7365 7428 6576 616c 2867 726f 7570  t set(eval(group
-0001bc80: 732e 6772 6f75 7028 3129 2929 203d 3d20  s.group(1))) == 
-0001bc90: 7b27 6c6f 775f 7661 6c75 6527 2c20 2768  {'low_value', 'h
-0001bca0: 6967 685f 7661 6c75 6527 2c20 2763 6f6c  igh_value', 'col
-0001bcb0: 756d 6e5f 6e61 6d65 277d 0a20 2020 2020  umn_name'}.     
-0001bcc0: 2020 2061 7373 6572 7420 7365 7428 6576     assert set(ev
-0001bcd0: 616c 2867 726f 7570 732e 6772 6f75 7028  al(groups.group(
-0001bce0: 3229 2929 203d 3d20 7b27 6e6f 745f 6869  2))) == {'not_hi
-0001bcf0: 6768 5f63 6f6c 756d 6e27 2c20 276e 6f74  gh_column', 'not
-0001bd00: 5f6c 6f77 5f63 6f6c 756d 6e27 7d0a 0a20  _low_column'}.. 
-0001bd10: 2020 2064 6566 2074 6573 745f 5f76 616c     def test__val
-0001bd20: 6964 6174 655f 6d65 7461 6461 7461 5f63  idate_metadata_c
-0001bd30: 6f6c 756d 6e73 2873 656c 6629 3a0a 2020  olumns(self):.  
-0001bd40: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-0001bd50: 6520 6060 5f76 616c 6964 6174 655f 6d65  e ``_validate_me
-0001bd60: 7461 6461 7461 5f63 6f6c 756d 6e73 6060  tadata_columns``
-0001bd70: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
-0001bd80: 2020 5468 6520 636f 6c75 6d6e 2070 6173    The column pas
-0001bd90: 7365 6420 696e 2063 6f6c 756d 6e5f 6e61  sed in column_na
-0001bda0: 6d65 2073 686f 756c 6420 6265 2069 6e20  me should be in 
-0001bdb0: 7468 6520 6d65 7461 6461 7461 2e0a 0a20  the metadata... 
-0001bdc0: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
-0001bdd0: 2020 2020 2020 2020 2020 2d20 636f 6c75            - colu
-0001bde0: 6d6e 5f6e 616d 6520 7468 6174 2069 7320  mn_name that is 
-0001bdf0: 696e 2074 6865 206d 6574 6164 6174 612e  in the metadata.
-0001be00: 0a0a 2020 2020 2020 2020 5369 6465 2065  ..        Side e
-0001be10: 6666 6563 743a 0a20 2020 2020 2020 2020  ffect:.         
-0001be20: 2020 202d 204e 6f20 6572 726f 7220 7368     - No error sh
-0001be30: 6f75 6c64 2062 6520 7261 6973 6564 2e0a  ould be raised..
-0001be40: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001be50: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
-0001be60: 2020 2020 6d65 7461 6461 7461 203d 204d      metadata = M
-0001be70: 6f63 6b28 290a 2020 2020 2020 2020 6d65  ock().        me
-0001be80: 7461 6461 7461 2e63 6f6c 756d 6e73 203d  tadata.columns =
-0001be90: 207b 2761 273a 2031 2c20 2762 273a 2032   {'a': 1, 'b': 2
-0001bea0: 7d0a 0a20 2020 2020 2020 2023 2052 756e  }..        # Run
-0001beb0: 0a20 2020 2020 2020 2053 6361 6c61 7252  .        ScalarR
-0001bec0: 616e 6765 2e5f 7661 6c69 6461 7465 5f6d  ange._validate_m
-0001bed0: 6574 6164 6174 615f 636f 6c75 6d6e 7328  etadata_columns(
-0001bee0: 6d65 7461 6461 7461 2c20 636f 6c75 6d6e  metadata, column
-0001bef0: 5f6e 616d 653d 2761 2729 0a0a 2020 2020  _name='a')..    
-0001bf00: 6465 6620 7465 7374 5f5f 7661 6c69 6461  def test__valida
-0001bf10: 7465 5f6d 6574 6164 6174 615f 636f 6c75  te_metadata_colu
-0001bf20: 6d6e 735f 7261 6973 6573 5f65 7272 6f72  mns_raises_error
-0001bf30: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0001bf40: 2222 2254 6573 7420 7468 6520 6060 5f76  """Test the ``_v
-0001bf50: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
-0001bf60: 5f63 6f6c 756d 6e73 6060 206d 6574 686f  _columns`` metho
-0001bf70: 6427 7320 6572 726f 7220 636f 6e64 6974  d's error condit
-0001bf80: 696f 6e2e 0a0a 2020 2020 2020 2020 4966  ion...        If
-0001bf90: 2063 6f6c 756d 6e5f 6e61 6d65 2069 7320   column_name is 
-0001bfa0: 6e6f 7420 696e 2074 6865 206d 6574 6164  not in the metad
-0001bfb0: 6174 612c 2061 6e20 6572 726f 7220 7368  ata, an error sh
-0001bfc0: 6f75 6c64 2062 6520 7261 6973 6564 2e0a  ould be raised..
-0001bfd0: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-0001bfe0: 2020 2020 2020 2020 2020 2020 2d20 636f              - co
-0001bff0: 6c75 6d6e 5f6e 616d 6520 7468 6174 2069  lumn_name that i
-0001c000: 7320 6e6f 7420 696e 2074 6865 206d 6574  s not in the met
-0001c010: 6164 6174 612e 0a0a 2020 2020 2020 2020  adata...        
-0001c020: 5369 6465 2065 6666 6563 743a 0a20 2020  Side effect:.   
-0001c030: 2020 2020 2020 2020 202d 2043 6f6e 7374           - Const
-0001c040: 7261 696e 744d 6574 6164 6174 6145 7272  raintMetadataErr
-0001c050: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
-0001c060: 7365 642e 0a20 2020 2020 2020 2022 2222  sed..        """
-0001c070: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-0001c080: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
-0001c090: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
-0001c0a0: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
-0001c0b0: 6d6e 7320 3d20 7b27 6127 3a20 312c 2027  mns = {'a': 1, '
-0001c0c0: 6227 3a20 327d 0a0a 2020 2020 2020 2020  b': 2}..        
-0001c0d0: 2320 5275 6e0a 2020 2020 2020 2020 6572  # Run.        er
-0001c0e0: 726f 725f 6d65 7373 6167 6520 3d20 7265  ror_message = re
-0001c0f0: 2e65 7363 6170 6528 0a20 2020 2020 2020  .escape(.       
-0001c100: 2020 2020 2027 4120 5363 616c 6172 5261       'A ScalarRa
-0001c110: 6e67 6520 636f 6e73 7472 6169 6e74 2069  nge constraint i
-0001c120: 7320 6265 696e 6720 6170 706c 6965 6420  s being applied 
-0001c130: 746f 2069 6e76 616c 6964 2063 6f6c 756d  to invalid colum
-0001c140: 6e20 6e61 6d65 7320 270a 2020 2020 2020  n names '.      
-0001c150: 2020 2020 2020 227b 2763 277d 2e20 5468        "{'c'}. Th
-0001c160: 6520 636f 6c75 6d6e 7320 6d75 7374 2065  e columns must e
-0001c170: 7869 7374 2069 6e20 7468 6520 7461 626c  xist in the tabl
-0001c180: 652e 220a 2020 2020 2020 2020 290a 2020  e.".        ).  
-0001c190: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
-0001c1a0: 742e 7261 6973 6573 2843 6f6e 7374 7261  t.raises(Constra
-0001c1b0: 696e 744d 6574 6164 6174 6145 7272 6f72  intMetadataError
-0001c1c0: 2c20 6d61 7463 683d 6572 726f 725f 6d65  , match=error_me
-0001c1d0: 7373 6167 6529 3a0a 2020 2020 2020 2020  ssage):.        
-0001c1e0: 2020 2020 5363 616c 6172 5261 6e67 652e      ScalarRange.
-0001c1f0: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
-0001c200: 7461 5f63 6f6c 756d 6e73 286d 6574 6164  ta_columns(metad
-0001c210: 6174 612c 2063 6f6c 756d 6e5f 6e61 6d65  ata, column_name
-0001c220: 3d27 6327 290a 0a20 2020 2064 6566 2074  ='c')..    def t
-0001c230: 6573 745f 5f76 616c 6964 6174 655f 6d65  est__validate_me
-0001c240: 7461 6461 7461 5f73 7065 6369 6669 635f  tadata_specific_
-0001c250: 746f 5f63 6f6e 7374 7261 696e 745f 6e75  to_constraint_nu
-0001c260: 6d65 7269 6361 6c28 7365 6c66 293a 0a20  merical(self):. 
-0001c270: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
-0001c280: 6865 2060 605f 7661 6c69 6461 7465 5f6d  he ``_validate_m
-0001c290: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
-0001c2a0: 5f74 6f5f 636f 6e73 7472 6169 6e74 6060  _to_constraint``
-0001c2b0: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
-0001c2c0: 2020 4966 2074 6865 2063 6f6c 756d 6e5f    If the column_
-0001c2d0: 6e61 6d65 2068 6173 2061 6e20 7364 7479  name has an sdty
-0001c2e0: 7065 206f 6620 6e75 6d65 7269 6361 6c2c  pe of numerical,
-0001c2f0: 2061 6e64 2074 6865 2068 6967 685f 7661   and the high_va
-0001c300: 6c75 650a 2020 2020 2020 2020 616e 6420  lue.        and 
-0001c310: 6c6f 775f 7661 6c75 6520 6172 6520 696e  low_value are in
-0001c320: 7473 206f 7220 666c 6f61 7473 2c20 7468  ts or floats, th
-0001c330: 656e 206e 6f20 6572 726f 7220 7368 6f75  en no error shou
-0001c340: 6c64 2062 6520 7261 6973 6564 2e0a 0a20  ld be raised... 
-0001c350: 2020 2020 2020 2053 6574 7570 3a0a 2020         Setup:.  
-0001c360: 2020 2020 2020 2020 2020 2d20 4d65 7461            - Meta
-0001c370: 6461 7461 2077 6974 6820 7468 6520 7364  data with the sd
-0001c380: 7479 7065 2073 6574 2074 6f20 6e75 6d65  type set to nume
-0001c390: 7269 6361 6c2e 0a0a 2020 2020 2020 2020  rical...        
-0001c3a0: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
-0001c3b0: 2020 202d 2054 6865 2063 6f6c 756d 6e20     - The column 
-0001c3c0: 6e61 6d65 2061 6e64 2062 6f74 6820 6869  name and both hi
-0001c3d0: 6768 5f76 616c 7565 2061 6e64 206c 6f77  gh_value and low
-0001c3e0: 5f76 616c 7565 2073 6574 2074 6f20 6120  _value set to a 
-0001c3f0: 6e75 6d62 6572 2e0a 2020 2020 2020 2020  number..        
-0001c400: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
-0001c410: 7475 700a 2020 2020 2020 2020 6d65 7461  tup.        meta
-0001c420: 6461 7461 203d 204d 6f63 6b28 290a 2020  data = Mock().  
-0001c430: 2020 2020 2020 6d65 7461 6461 7461 2e63        metadata.c
-0001c440: 6f6c 756d 6e73 203d 207b 2761 273a 207b  olumns = {'a': {
-0001c450: 2773 6474 7970 6527 3a20 276e 756d 6572  'sdtype': 'numer
-0001c460: 6963 616c 277d 7d0a 0a20 2020 2020 2020  ical'}}..       
-0001c470: 2023 2052 756e 0a20 2020 2020 2020 2053   # Run.        S
-0001c480: 6361 6c61 7252 616e 6765 2e5f 7661 6c69  calarRange._vali
-0001c490: 6461 7465 5f6d 6574 6164 6174 615f 7370  date_metadata_sp
-0001c4a0: 6563 6966 6963 5f74 6f5f 636f 6e73 7472  ecific_to_constr
-0001c4b0: 6169 6e74 280a 2020 2020 2020 2020 2020  aint(.          
-0001c4c0: 2020 6d65 7461 6461 7461 2c0a 2020 2020    metadata,.    
-0001c4d0: 2020 2020 2020 2020 636f 6c75 6d6e 5f6e          column_n
-0001c4e0: 616d 653d 2761 272c 0a20 2020 2020 2020  ame='a',.       
-0001c4f0: 2020 2020 2068 6967 685f 7661 6c75 653d       high_value=
-0001c500: 3130 2c0a 2020 2020 2020 2020 2020 2020  10,.            
-0001c510: 6c6f 775f 7661 6c75 653d 350a 2020 2020  low_value=5.    
-0001c520: 2020 2020 290a 0a20 2020 2064 6566 2074      )..    def t
-0001c530: 6573 745f 5f76 616c 6964 6174 655f 6d65  est__validate_me
-0001c540: 7461 6461 7461 5f73 7065 6369 6669 635f  tadata_specific_
-0001c550: 746f 5f63 6f6e 7374 7261 696e 745f 6e75  to_constraint_nu
-0001c560: 6d65 7269 6361 6c5f 6869 6768 5f6e 6f74  merical_high_not
-0001c570: 5f6e 756d 6572 6963 616c 5f65 7272 6f72  _numerical_error
-0001c580: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0001c590: 2222 2254 6573 7420 7468 6520 6060 5f76  """Test the ``_v
-0001c5a0: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
-0001c5b0: 5f73 7065 6369 6669 635f 746f 5f63 6f6e  _specific_to_con
-0001c5c0: 7374 7261 696e 7460 6020 6d65 7468 6f64  straint`` method
-0001c5d0: 2e0a 0a20 2020 2020 2020 2049 6620 7468  ...        If th
-0001c5e0: 6520 636f 6c75 6d6e 5f6e 616d 6520 6861  e column_name ha
-0001c5f0: 7320 616e 2073 6474 7970 6520 6f66 206e  s an sdtype of n
-0001c600: 756d 6572 6963 616c 2c20 616e 6420 7468  umerical, and th
-0001c610: 6520 6869 6768 5f76 616c 7565 0a20 2020  e high_value.   
-0001c620: 2020 2020 2069 7320 6e6f 7420 616e 2069       is not an i
-0001c630: 6e74 206f 7220 666c 6f61 742c 2074 6865  nt or float, the
-0001c640: 6e20 616e 2065 7272 6f72 2073 686f 756c  n an error shoul
-0001c650: 6420 6265 2072 6169 7365 642e 0a0a 2020  d be raised...  
-0001c660: 2020 2020 2020 5365 7475 703a 0a20 2020        Setup:.   
-0001c670: 2020 2020 2020 2020 202d 204d 6574 6164           - Metad
-0001c680: 6174 6120 7769 7468 2074 6865 2073 6474  ata with the sdt
-0001c690: 7970 6520 7365 7420 746f 206e 756d 6572  ype set to numer
-0001c6a0: 6963 616c 2e0a 0a20 2020 2020 2020 2049  ical...        I
-0001c6b0: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
-0001c6c0: 2020 2d20 5468 6520 636f 6c75 6d6e 206e    - The column n
-0001c6d0: 616d 652c 206c 6f77 5f76 616c 7565 2073  ame, low_value s
-0001c6e0: 6574 2074 6f20 6120 6e75 6d62 6572 2061  et to a number a
-0001c6f0: 6e64 2068 6967 685f 7661 6c75 6520 7365  nd high_value se
-0001c700: 7420 746f 2061 2073 7472 696e 672e 0a20  t to a string.. 
-0001c710: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001c720: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
-0001c730: 2020 206d 6574 6164 6174 6120 3d20 4d6f     metadata = Mo
-0001c740: 636b 2829 0a20 2020 2020 2020 206d 6574  ck().        met
-0001c750: 6164 6174 612e 636f 6c75 6d6e 7320 3d20  adata.columns = 
-0001c760: 7b27 6127 3a20 7b27 7364 7479 7065 273a  {'a': {'sdtype':
-0001c770: 2027 6e75 6d65 7269 6361 6c27 7d7d 0a0a   'numerical'}}..
-0001c780: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
-0001c790: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-0001c7a0: 6167 6520 3d20 2242 6f74 6820 2768 6967  age = "Both 'hig
-0001c7b0: 685f 7661 6c75 6527 2061 6e64 2027 6c6f  h_value' and 'lo
-0001c7c0: 775f 7661 6c75 6527 206d 7573 7420 6265  w_value' must be
-0001c7d0: 2069 6e74 7320 6f72 2066 6c6f 6174 7322   ints or floats"
-0001c7e0: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
-0001c7f0: 7465 7374 2e72 6169 7365 7328 436f 6e73  test.raises(Cons
-0001c800: 7472 6169 6e74 4d65 7461 6461 7461 4572  traintMetadataEr
-0001c810: 726f 722c 206d 6174 6368 3d65 7272 6f72  ror, match=error
-0001c820: 5f6d 6573 7361 6765 293a 0a20 2020 2020  _message):.     
-0001c830: 2020 2020 2020 2053 6361 6c61 7252 616e         ScalarRan
-0001c840: 6765 2e5f 7661 6c69 6461 7465 5f6d 6574  ge._validate_met
-0001c850: 6164 6174 615f 7370 6563 6966 6963 5f74  adata_specific_t
-0001c860: 6f5f 636f 6e73 7472 6169 6e74 280a 2020  o_constraint(.  
-0001c870: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-0001c880: 7461 6461 7461 2c0a 2020 2020 2020 2020  tadata,.        
-0001c890: 2020 2020 2020 2020 636f 6c75 6d6e 5f6e          column_n
-0001c8a0: 616d 653d 2761 272c 0a20 2020 2020 2020  ame='a',.       
-0001c8b0: 2020 2020 2020 2020 206c 6f77 5f76 616c           low_val
-0001c8c0: 7565 3d35 2c0a 2020 2020 2020 2020 2020  ue=5,.          
-0001c8d0: 2020 2020 2020 6869 6768 5f76 616c 7565        high_value
-0001c8e0: 3d27 3130 270a 2020 2020 2020 2020 2020  ='10'.          
-0001c8f0: 2020 290a 0a20 2020 2064 6566 2074 6573    )..    def tes
-0001c900: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
-0001c910: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
-0001c920: 5f63 6f6e 7374 7261 696e 745f 6e75 6d65  _constraint_nume
-0001c930: 7269 6361 6c5f 6c6f 775f 6e6f 745f 6e75  rical_low_not_nu
-0001c940: 6d65 7269 6361 6c5f 6572 726f 7228 7365  merical_error(se
-0001c950: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0001c960: 5465 7374 2074 6865 2060 605f 7661 6c69  Test the ``_vali
-0001c970: 6461 7465 5f6d 6574 6164 6174 615f 7370  date_metadata_sp
-0001c980: 6563 6966 6963 5f74 6f5f 636f 6e73 7472  ecific_to_constr
-0001c990: 6169 6e74 6060 206d 6574 686f 642e 0a0a  aint`` method...
-0001c9a0: 2020 2020 2020 2020 4966 2074 6865 2063          If the c
-0001c9b0: 6f6c 756d 6e5f 6e61 6d65 2068 6173 2061  olumn_name has a
-0001c9c0: 6e20 7364 7479 7065 206f 6620 6e75 6d65  n sdtype of nume
-0001c9d0: 7269 6361 6c2c 2061 6e64 2074 6865 206c  rical, and the l
-0001c9e0: 6f77 5f76 616c 7565 0a20 2020 2020 2020  ow_value.       
-0001c9f0: 2069 7320 6e6f 7420 616e 2069 6e74 206f   is not an int o
-0001ca00: 7220 666c 6f61 742c 2074 6865 6e20 616e  r float, then an
-0001ca10: 2065 7272 6f72 2073 686f 756c 6420 6265   error should be
-0001ca20: 2072 6169 7365 642e 0a0a 2020 2020 2020   raised...      
-0001ca30: 2020 5365 7475 703a 0a20 2020 2020 2020    Setup:.       
-0001ca40: 2020 2020 202d 204d 6574 6164 6174 6120       - Metadata 
-0001ca50: 7769 7468 2074 6865 2073 6474 7970 6520  with the sdtype 
-0001ca60: 7365 7420 746f 206e 756d 6572 6963 616c  set to numerical
-0001ca70: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
-0001ca80: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-0001ca90: 5468 6520 636f 6c75 6d6e 206e 616d 652c  The column name,
-0001caa0: 2068 6967 685f 7661 6c75 6520 7365 7420   high_value set 
-0001cab0: 746f 2061 206e 756d 6265 7220 616e 6420  to a number and 
-0001cac0: 6c6f 775f 7661 6c75 6520 7365 7420 746f  low_value set to
-0001cad0: 2061 2073 7472 696e 672e 0a20 2020 2020   a string..     
-0001cae0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
-0001caf0: 2053 6574 7570 0a20 2020 2020 2020 206d   Setup.        m
-0001cb00: 6574 6164 6174 6120 3d20 4d6f 636b 2829  etadata = Mock()
-0001cb10: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
-0001cb20: 612e 636f 6c75 6d6e 7320 3d20 7b27 6127  a.columns = {'a'
-0001cb30: 3a20 7b27 7364 7479 7065 273a 2027 6e75  : {'sdtype': 'nu
-0001cb40: 6d65 7269 6361 6c27 7d7d 0a0a 2020 2020  merical'}}..    
-0001cb50: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
-0001cb60: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-0001cb70: 3d20 2242 6f74 6820 2768 6967 685f 7661  = "Both 'high_va
-0001cb80: 6c75 6527 2061 6e64 2027 6c6f 775f 7661  lue' and 'low_va
-0001cb90: 6c75 6527 206d 7573 7420 6265 2069 6e74  lue' must be int
-0001cba0: 7320 6f72 2066 6c6f 6174 7322 0a20 2020  s or floats".   
-0001cbb0: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-0001cbc0: 2e72 6169 7365 7328 436f 6e73 7472 6169  .raises(Constrai
-0001cbd0: 6e74 4d65 7461 6461 7461 4572 726f 722c  ntMetadataError,
-0001cbe0: 206d 6174 6368 3d65 7272 6f72 5f6d 6573   match=error_mes
-0001cbf0: 7361 6765 293a 0a20 2020 2020 2020 2020  sage):.         
-0001cc00: 2020 2053 6361 6c61 7252 616e 6765 2e5f     ScalarRange._
-0001cc10: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-0001cc20: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
-0001cc30: 6e73 7472 6169 6e74 280a 2020 2020 2020  nstraint(.      
-0001cc40: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
-0001cc50: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-0001cc60: 2020 2020 636f 6c75 6d6e 5f6e 616d 653d      column_name=
-0001cc70: 2761 272c 0a20 2020 2020 2020 2020 2020  'a',.           
-0001cc80: 2020 2020 206c 6f77 5f76 616c 7565 3d27       low_value='
-0001cc90: 3527 2c0a 2020 2020 2020 2020 2020 2020  5',.            
-0001cca0: 2020 2020 6869 6768 5f76 616c 7565 3d31      high_value=1
-0001ccb0: 300a 2020 2020 2020 2020 2020 2020 290a  0.            ).
-0001ccc0: 0a20 2020 2040 7061 7463 6828 2773 6476  .    @patch('sdv
-0001ccd0: 2e63 6f6e 7374 7261 696e 7473 2e74 6162  .constraints.tab
-0001cce0: 756c 6172 2e6d 6174 6368 6573 5f64 6174  ular.matches_dat
-0001ccf0: 6574 696d 655f 666f 726d 6174 2729 0a20  etime_format'). 
-0001cd00: 2020 2064 6566 2074 6573 745f 5f76 616c     def test__val
-0001cd10: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
-0001cd20: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
-0001cd30: 7261 696e 745f 6461 7465 7469 6d65 2873  raint_datetime(s
-0001cd40: 656c 662c 2064 6174 6574 696d 655f 666f  elf, datetime_fo
-0001cd50: 726d 6174 5f6d 6f63 6b29 3a0a 2020 2020  rmat_mock):.    
-0001cd60: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
-0001cd70: 6060 5f76 616c 6964 6174 655f 6d65 7461  ``_validate_meta
-0001cd80: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
-0001cd90: 5f63 6f6e 7374 7261 696e 7460 6020 6d65  _constraint`` me
-0001cda0: 7468 6f64 2e0a 0a20 2020 2020 2020 2049  thod...        I
-0001cdb0: 6620 7468 6520 636f 6c75 6d6e 5f6e 616d  f the column_nam
-0001cdc0: 6520 6861 7320 616e 2073 6474 7970 6520  e has an sdtype 
-0001cdd0: 6f66 2064 6174 6574 696d 652c 2061 6e64  of datetime, and
-0001cde0: 2062 6f74 6820 7468 6520 6869 6768 5f76   both the high_v
-0001cdf0: 616c 7565 2061 6e64 206c 6f77 5f76 616c  alue and low_val
-0001ce00: 7565 0a20 2020 2020 2020 2061 7265 2064  ue.        are d
-0001ce10: 6174 6574 696d 6520 7374 7269 6e67 7320  atetime strings 
-0001ce20: 7468 6174 206d 6174 6368 2074 6865 2066  that match the f
-0001ce30: 6f72 6d61 742c 2074 6865 6e20 6e6f 2065  ormat, then no e
-0001ce40: 7272 6f72 2073 686f 756c 6420 6265 2072  rror should be r
-0001ce50: 6169 7365 642e 0a0a 2020 2020 2020 2020  aised...        
-0001ce60: 5365 7475 703a 0a20 2020 2020 2020 2020  Setup:.         
-0001ce70: 2020 202d 204d 6574 6164 6174 6120 7769     - Metadata wi
-0001ce80: 7468 2074 6865 2073 6474 7970 6520 7365  th the sdtype se
-0001ce90: 7420 746f 2064 6174 6574 696d 6520 616e  t to datetime an
-0001cea0: 6420 6120 6461 7465 7469 6d65 5f66 6f72  d a datetime_for
-0001ceb0: 6d61 742e 0a20 2020 2020 2020 2020 2020  mat..           
-0001cec0: 202d 204d 6f63 6b20 7468 6520 6060 6d61   - Mock the ``ma
-0001ced0: 7463 6865 735f 6461 7465 7469 6d65 5f66  tches_datetime_f
-0001cee0: 6f72 6d61 7460 6020 6675 6e63 7469 6f6e  ormat`` function
-0001cef0: 2074 6f20 7265 7475 726e 2054 7275 652e   to return True.
-0001cf00: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
-0001cf10: 0a20 2020 2020 2020 2020 2020 202d 2054  .            - T
-0001cf20: 6865 2063 6f6c 756d 6e20 6e61 6d65 2061  he column name a
-0001cf30: 6e64 2062 6f74 6820 6c6f 775f 7661 6c75  nd both low_valu
-0001cf40: 6520 616e 6420 6869 6768 5f76 616c 7565  e and high_value
-0001cf50: 2073 6574 2074 6f20 6120 6461 7465 7469   set to a dateti
-0001cf60: 6d65 206f 6620 7468 650a 2020 2020 2020  me of the.      
-0001cf70: 2020 2020 2020 7269 6768 7420 666f 726d        right form
-0001cf80: 6174 2e0a 2020 2020 2020 2020 2222 220a  at..        """.
-0001cf90: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
-0001cfa0: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-0001cfb0: 203d 204d 6f63 6b28 290a 2020 2020 2020   = Mock().      
-0001cfc0: 2020 6d65 7461 6461 7461 2e63 6f6c 756d    metadata.colum
-0001cfd0: 6e73 203d 207b 2761 273a 207b 2773 6474  ns = {'a': {'sdt
-0001cfe0: 7970 6527 3a20 2764 6174 6574 696d 6527  ype': 'datetime'
-0001cff0: 2c20 2764 6174 6574 696d 655f 666f 726d  , 'datetime_form
-0001d000: 6174 273a 2027 6d2f 642f 7927 7d7d 0a20  at': 'm/d/y'}}. 
-0001d010: 2020 2020 2020 2064 6174 6574 696d 655f         datetime_
-0001d020: 666f 726d 6174 5f6d 6f63 6b2e 7265 7475  format_mock.retu
-0001d030: 726e 5f76 616c 7565 203d 2054 7275 650a  rn_value = True.
-0001d040: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
-0001d050: 2020 2020 2020 2053 6361 6c61 7252 616e         ScalarRan
-0001d060: 6765 2e5f 7661 6c69 6461 7465 5f6d 6574  ge._validate_met
-0001d070: 6164 6174 615f 7370 6563 6966 6963 5f74  adata_specific_t
-0001d080: 6f5f 636f 6e73 7472 6169 6e74 280a 2020  o_constraint(.  
-0001d090: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
-0001d0a0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-0001d0b0: 636f 6c75 6d6e 5f6e 616d 653d 2761 272c  column_name='a',
-0001d0c0: 0a20 2020 2020 2020 2020 2020 206c 6f77  .            low
-0001d0d0: 5f76 616c 7565 3d27 312f 312f 3230 3230  _value='1/1/2020
-0001d0e0: 272c 0a20 2020 2020 2020 2020 2020 2068  ',.            h
-0001d0f0: 6967 685f 7661 6c75 653d 2731 2f33 302f  igh_value='1/30/
-0001d100: 3230 3230 270a 2020 2020 2020 2020 290a  2020'.        ).
-0001d110: 0a20 2020 2040 7061 7463 6828 2773 6476  .    @patch('sdv
-0001d120: 2e63 6f6e 7374 7261 696e 7473 2e74 6162  .constraints.tab
-0001d130: 756c 6172 2e6d 6174 6368 6573 5f64 6174  ular.matches_dat
-0001d140: 6574 696d 655f 666f 726d 6174 2729 0a20  etime_format'). 
-0001d150: 2020 2064 6566 2074 6573 745f 5f76 616c     def test__val
-0001d160: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
-0001d170: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
-0001d180: 7261 696e 745f 6869 6768 5f64 6174 6574  raint_high_datet
-0001d190: 696d 655f 6572 726f 7228 0a20 2020 2020  ime_error(.     
-0001d1a0: 2020 2020 2020 2073 656c 662c 2064 6174         self, dat
-0001d1b0: 6574 696d 655f 666f 726d 6174 5f6d 6f63  etime_format_moc
-0001d1c0: 6b29 3a0a 2020 2020 2020 2020 2222 2254  k):.        """T
-0001d1d0: 6573 7420 7468 6520 6060 5f76 616c 6964  est the ``_valid
-0001d1e0: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
-0001d1f0: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
-0001d200: 696e 7460 6020 6d65 7468 6f64 2e0a 0a20  int`` method... 
-0001d210: 2020 2020 2020 2049 6620 7468 6520 636f         If the co
-0001d220: 6c75 6d6e 5f6e 616d 6520 6861 7320 616e  lumn_name has an
-0001d230: 2073 6474 7970 6520 6f66 2064 6174 6574   sdtype of datet
-0001d240: 696d 652c 2061 6e64 2074 6865 2068 6967  ime, and the hig
-0001d250: 685f 7661 6c75 650a 2020 2020 2020 2020  h_value.        
-0001d260: 6973 2061 2064 6174 6574 696d 6520 7374  is a datetime st
-0001d270: 7269 6e67 2074 6861 7420 646f 6573 6e27  ring that doesn'
-0001d280: 7420 6d61 7463 6820 7468 6520 666f 726d  t match the form
-0001d290: 6174 2c20 7468 656e 2061 6e20 6572 726f  at, then an erro
-0001d2a0: 7220 7368 6f75 6c64 2062 6520 7261 6973  r should be rais
-0001d2b0: 6564 2e0a 0a20 2020 2020 2020 2053 6574  ed...        Set
-0001d2c0: 7570 3a0a 2020 2020 2020 2020 2020 2020  up:.            
-0001d2d0: 2d20 4d65 7461 6461 7461 2077 6974 6820  - Metadata with 
-0001d2e0: 7468 6520 7364 7479 7065 2073 6574 2074  the sdtype set t
-0001d2f0: 6f20 6461 7465 7469 6d65 2061 6e64 2061  o datetime and a
-0001d300: 2064 6174 6574 696d 655f 666f 726d 6174   datetime_format
-0001d310: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-0001d320: 4d6f 636b 2074 6865 2060 606d 6174 6368  Mock the ``match
-0001d330: 6573 5f64 6174 6574 696d 655f 666f 726d  es_datetime_form
-0001d340: 6174 6060 2066 756e 6374 696f 6e20 746f  at`` function to
-0001d350: 2072 6574 7572 6e20 4661 6c73 652c 2074   return False, t
-0001d360: 6865 6e20 5472 7565 2e0a 0a20 2020 2020  hen True...     
-0001d370: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
-0001d380: 2020 2020 2020 2d20 5468 6520 636f 6c75        - The colu
-0001d390: 6d6e 206e 616d 652c 2061 206c 6f77 5f76  mn name, a low_v
-0001d3a0: 616c 7565 2073 6574 2074 6f20 6120 6461  alue set to a da
-0001d3b0: 7465 7469 6d65 206f 6620 7468 6520 7269  tetime of the ri
-0001d3c0: 6768 7420 666f 726d 6174 2061 6e64 0a20  ght format and. 
-0001d3d0: 2020 2020 2020 2020 2020 2061 2068 6967             a hig
-0001d3e0: 685f 7661 6c75 6520 7365 7420 746f 2061  h_value set to a
-0001d3f0: 2064 6174 6574 696d 6520 6f66 2074 6865   datetime of the
-0001d400: 2077 726f 6e67 2066 6f72 6d61 742e 0a0a   wrong format...
-0001d410: 2020 2020 2020 2020 5369 6465 2065 6666          Side eff
-0001d420: 6563 743a 0a20 2020 2020 2020 2020 2020  ect:.           
-0001d430: 202d 2041 2043 6f6e 7374 7261 696e 744d   - A ConstraintM
-0001d440: 6574 6164 6174 6145 7272 6f72 2073 686f  etadataError sho
-0001d450: 756c 6420 6265 2072 6169 7365 642e 0a20  uld be raised.. 
-0001d460: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001d470: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
-0001d480: 2020 206d 6574 6164 6174 6120 3d20 4d6f     metadata = Mo
-0001d490: 636b 2829 0a20 2020 2020 2020 206d 6574  ck().        met
-0001d4a0: 6164 6174 612e 636f 6c75 6d6e 7320 3d20  adata.columns = 
-0001d4b0: 7b27 6127 3a20 7b27 7364 7479 7065 273a  {'a': {'sdtype':
-0001d4c0: 2027 6461 7465 7469 6d65 272c 2027 6461   'datetime', 'da
-0001d4d0: 7465 7469 6d65 5f66 6f72 6d61 7427 3a20  tetime_format': 
-0001d4e0: 276d 2f64 2f79 277d 7d0a 2020 2020 2020  'm/d/y'}}.      
-0001d4f0: 2020 6461 7465 7469 6d65 5f66 6f72 6d61    datetime_forma
-0001d500: 745f 6d6f 636b 2e73 6964 655f 6566 6665  t_mock.side_effe
-0001d510: 6374 203d 205b 4661 6c73 652c 2054 7275  ct = [False, Tru
-0001d520: 655d 0a0a 2020 2020 2020 2020 2320 5275  e]..        # Ru
-0001d530: 6e0a 2020 2020 2020 2020 6572 726f 725f  n.        error_
-0001d540: 6d65 7373 6167 6520 3d20 280a 2020 2020  message = (.    
-0001d550: 2020 2020 2020 2020 2242 6f74 6820 2768          "Both 'h
-0001d560: 6967 685f 7661 6c75 6527 2061 6e64 2027  igh_value' and '
-0001d570: 6c6f 775f 7661 6c75 6527 206d 7573 7420  low_value' must 
-0001d580: 6265 2061 2064 6174 6574 696d 6520 7374  be a datetime st
-0001d590: 7269 6e67 206f 6620 7468 6520 7269 6768  ring of the righ
-0001d5a0: 7420 666f 726d 6174 220a 2020 2020 2020  t format".      
-0001d5b0: 2020 290a 2020 2020 2020 2020 7769 7468    ).        with
-0001d5c0: 2070 7974 6573 742e 7261 6973 6573 2843   pytest.raises(C
-0001d5d0: 6f6e 7374 7261 696e 744d 6574 6164 6174  onstraintMetadat
-0001d5e0: 6145 7272 6f72 2c20 6d61 7463 683d 6572  aError, match=er
-0001d5f0: 726f 725f 6d65 7373 6167 6529 3a0a 2020  ror_message):.  
-0001d600: 2020 2020 2020 2020 2020 5363 616c 6172            Scalar
-0001d610: 5261 6e67 652e 5f76 616c 6964 6174 655f  Range._validate_
-0001d620: 6d65 7461 6461 7461 5f73 7065 6369 6669  metadata_specifi
-0001d630: 635f 746f 5f63 6f6e 7374 7261 696e 7428  c_to_constraint(
-0001d640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d650: 206d 6574 6164 6174 612c 0a20 2020 2020   metadata,.     
-0001d660: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-0001d670: 6e5f 6e61 6d65 3d27 6127 2c0a 2020 2020  n_name='a',.    
-0001d680: 2020 2020 2020 2020 2020 2020 6869 6768              high
-0001d690: 5f76 616c 7565 3d27 312f 312f 3230 3139  _value='1/1/2019
-0001d6a0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-0001d6b0: 2020 206c 6f77 5f76 616c 7565 3d27 312d     low_value='1-
-0001d6c0: 312d 3230 3230 270a 2020 2020 2020 2020  1-2020'.        
-0001d6d0: 2020 2020 290a 0a20 2020 2040 7061 7463      )..    @patc
-0001d6e0: 6828 2773 6476 2e63 6f6e 7374 7261 696e  h('sdv.constrain
-0001d6f0: 7473 2e74 6162 756c 6172 2e6d 6174 6368  ts.tabular.match
-0001d700: 6573 5f64 6174 6574 696d 655f 666f 726d  es_datetime_form
-0001d710: 6174 2729 0a20 2020 2064 6566 2074 6573  at').    def tes
-0001d720: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
-0001d730: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
-0001d740: 5f63 6f6e 7374 7261 696e 745f 6c6f 775f  _constraint_low_
-0001d750: 6461 7465 7469 6d65 5f65 7272 6f72 280a  datetime_error(.
-0001d760: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001d770: 2c20 6461 7465 7469 6d65 5f66 6f72 6d61  , datetime_forma
-0001d780: 745f 6d6f 636b 293a 0a20 2020 2020 2020  t_mock):.       
-0001d790: 2022 2222 5465 7374 2074 6865 2060 605f   """Test the ``_
-0001d7a0: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-0001d7b0: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
-0001d7c0: 6e73 7472 6169 6e74 6060 206d 6574 686f  nstraint`` metho
-0001d7d0: 642e 0a0a 2020 2020 2020 2020 4966 2074  d...        If t
-0001d7e0: 6865 2063 6f6c 756d 6e5f 6e61 6d65 2068  he column_name h
-0001d7f0: 6173 2061 6e20 7364 7479 7065 206f 6620  as an sdtype of 
-0001d800: 6461 7465 7469 6d65 2c20 616e 6420 7468  datetime, and th
-0001d810: 6520 6c6f 775f 7661 6c75 650a 2020 2020  e low_value.    
-0001d820: 2020 2020 6973 2061 2064 6174 6574 696d      is a datetim
-0001d830: 6520 7374 7269 6e67 2074 6861 7420 646f  e string that do
-0001d840: 6573 6e27 7420 6d61 7463 6820 7468 6520  esn't match the 
-0001d850: 666f 726d 6174 2c20 7468 656e 2061 6e20  format, then an 
-0001d860: 6572 726f 7220 7368 6f75 6c64 2062 6520  error should be 
-0001d870: 7261 6973 6564 2e0a 0a20 2020 2020 2020  raised...       
-0001d880: 2053 6574 7570 3a0a 2020 2020 2020 2020   Setup:.        
-0001d890: 2020 2020 2d20 4d65 7461 6461 7461 2077      - Metadata w
-0001d8a0: 6974 6820 7468 6520 7364 7479 7065 2073  ith the sdtype s
-0001d8b0: 6574 2074 6f20 6461 7465 7469 6d65 2061  et to datetime a
-0001d8c0: 6e64 2061 2064 6174 6574 696d 655f 666f  nd a datetime_fo
-0001d8d0: 726d 6174 2e0a 2020 2020 2020 2020 2020  rmat..          
-0001d8e0: 2020 2d20 4d6f 636b 2074 6865 2060 606d    - Mock the ``m
-0001d8f0: 6174 6368 6573 5f64 6174 6574 696d 655f  atches_datetime_
-0001d900: 666f 726d 6174 6060 2066 756e 6374 696f  format`` functio
-0001d910: 6e20 746f 2072 6574 7572 6e20 5472 7565  n to return True
-0001d920: 2c20 7468 656e 2046 616c 7365 2e0a 0a20  , then False... 
-0001d930: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
-0001d940: 2020 2020 2020 2020 2020 2d20 5468 6520            - The 
-0001d950: 636f 6c75 6d6e 206e 616d 652c 2061 206c  column name, a l
-0001d960: 6f77 5f76 616c 7565 2073 6574 2074 6f20  ow_value set to 
-0001d970: 6120 6461 7465 7469 6d65 206f 6620 7468  a datetime of th
-0001d980: 6520 7772 6f6e 6720 666f 726d 6174 2061  e wrong format a
-0001d990: 6e64 0a20 2020 2020 2020 2020 2020 2061  nd.            a
-0001d9a0: 2068 6967 685f 7661 6c75 6520 7365 7420   high_value set 
-0001d9b0: 746f 2061 2064 6174 6574 696d 6520 6f66  to a datetime of
-0001d9c0: 2074 6865 2072 6967 6874 2066 6f72 6d61   the right forma
-0001d9d0: 742e 0a0a 2020 2020 2020 2020 5369 6465  t...        Side
-0001d9e0: 2065 6666 6563 743a 0a20 2020 2020 2020   effect:.       
-0001d9f0: 2020 2020 202d 2041 2043 6f6e 7374 7261       - A Constra
-0001da00: 696e 744d 6574 6164 6174 6145 7272 6f72  intMetadataError
-0001da10: 2073 686f 756c 6420 6265 2072 6169 7365   should be raise
-0001da20: 642e 0a20 2020 2020 2020 2022 2222 0a20  d..        """. 
-0001da30: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
-0001da40: 2020 2020 2020 206d 6574 6164 6174 6120         metadata 
-0001da50: 3d20 4d6f 636b 2829 0a20 2020 2020 2020  = Mock().       
-0001da60: 206d 6574 6164 6174 612e 636f 6c75 6d6e   metadata.column
-0001da70: 7320 3d20 7b27 6127 3a20 7b27 7364 7479  s = {'a': {'sdty
-0001da80: 7065 273a 2027 6461 7465 7469 6d65 272c  pe': 'datetime',
-0001da90: 2027 6461 7465 7469 6d65 5f66 6f72 6d61   'datetime_forma
-0001daa0: 7427 3a20 276d 2f64 2f79 277d 7d0a 2020  t': 'm/d/y'}}.  
-0001dab0: 2020 2020 2020 6461 7465 7469 6d65 5f66        datetime_f
-0001dac0: 6f72 6d61 745f 6d6f 636b 2e73 6964 655f  ormat_mock.side_
-0001dad0: 6566 6665 6374 203d 205b 5472 7565 2c20  effect = [True, 
-0001dae0: 4661 6c73 655d 0a0a 2020 2020 2020 2020  False]..        
-0001daf0: 2320 5275 6e0a 2020 2020 2020 2020 6572  # Run.        er
-0001db00: 726f 725f 6d65 7373 6167 6520 3d20 280a  ror_message = (.
-0001db10: 2020 2020 2020 2020 2020 2020 2242 6f74              "Bot
-0001db20: 6820 2768 6967 685f 7661 6c75 6527 2061  h 'high_value' a
-0001db30: 6e64 2027 6c6f 775f 7661 6c75 6527 206d  nd 'low_value' m
-0001db40: 7573 7420 6265 2061 2064 6174 6574 696d  ust be a datetim
-0001db50: 6520 7374 7269 6e67 206f 6620 7468 6520  e string of the 
-0001db60: 7269 6768 7420 666f 726d 6174 220a 2020  right format".  
-0001db70: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001db80: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-0001db90: 6573 2843 6f6e 7374 7261 696e 744d 6574  es(ConstraintMet
-0001dba0: 6164 6174 6145 7272 6f72 2c20 6d61 7463  adataError, matc
-0001dbb0: 683d 6572 726f 725f 6d65 7373 6167 6529  h=error_message)
-0001dbc0: 3a0a 2020 2020 2020 2020 2020 2020 5363  :.            Sc
-0001dbd0: 616c 6172 5261 6e67 652e 5f76 616c 6964  alarRange._valid
-0001dbe0: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
-0001dbf0: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
-0001dc00: 696e 7428 0a20 2020 2020 2020 2020 2020  int(.           
-0001dc10: 2020 2020 206d 6574 6164 6174 612c 0a20       metadata,. 
-0001dc20: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0001dc30: 6f6c 756d 6e5f 6e61 6d65 3d27 6127 2c0a  olumn_name='a',.
-0001dc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dc50: 6869 6768 5f76 616c 7565 3d27 312d 312d  high_value='1-1-
-0001dc60: 3230 3139 272c 0a20 2020 2020 2020 2020  2019',.         
-0001dc70: 2020 2020 2020 206c 6f77 5f76 616c 7565         low_value
-0001dc80: 3d27 312f 312f 3230 3230 270a 2020 2020  ='1/1/2020'.    
-0001dc90: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-0001dca0: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
-0001dcb0: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
-0001dcc0: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
-0001dcd0: 745f 6261 645f 7479 7065 2873 656c 6629  t_bad_type(self)
-0001dce0: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
-0001dcf0: 7420 7468 6520 6060 5f76 616c 6964 6174  t the ``_validat
-0001dd00: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
-0001dd10: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
-0001dd20: 7460 6020 6d65 7468 6f64 2e0a 0a20 2020  t`` method...   
-0001dd30: 2020 2020 2049 6620 7468 6520 636f 6c75       If the colu
-0001dd40: 6d6e 5f6e 616d 6520 6861 7320 616e 2073  mn_name has an s
-0001dd50: 6474 7970 6520 7468 6174 2069 7320 6e6f  dtype that is no
-0001dd60: 7420 6120 6461 7465 7469 6d65 2073 7472  t a datetime str
-0001dd70: 696e 672c 2069 6e74 206f 720a 2020 2020  ing, int or.    
-0001dd80: 2020 2020 666c 6f61 7420 7468 656e 2061      float then a
-0001dd90: 6e20 6572 726f 7220 7368 6f75 6c64 2062  n error should b
-0001dda0: 6520 7261 6973 6564 2e0a 0a20 2020 2020  e raised...     
-0001ddb0: 2020 2053 6574 7570 3a0a 2020 2020 2020     Setup:.      
-0001ddc0: 2020 2020 2020 2d20 4d65 7461 6461 7461        - Metadata
-0001ddd0: 2077 6974 6820 7468 6520 7364 7479 7065   with the sdtype
-0001dde0: 2073 6574 2074 6f20 6361 7465 676f 7269   set to categori
-0001ddf0: 6361 6c2e 0a0a 2020 2020 2020 2020 496e  cal...        In
-0001de00: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
-0001de10: 202d 2054 6865 2063 6f6c 756d 6e20 6e61   - The column na
-0001de20: 6d65 2c20 7265 6c61 7469 6f6e 2061 6e64  me, relation and
-0001de30: 2076 616c 7565 2e0a 0a20 2020 2020 2020   value...       
-0001de40: 2053 6964 6520 6566 6665 6374 3a0a 2020   Side effect:.  
-0001de50: 2020 2020 2020 2020 2020 2d20 4120 436f            - A Co
-0001de60: 6e73 7472 6169 6e74 4d65 7461 6461 7461  nstraintMetadata
-0001de70: 4572 726f 7220 7368 6f75 6c64 2062 6520  Error should be 
-0001de80: 7261 6973 6564 2e0a 2020 2020 2020 2020  raised..        
-0001de90: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
-0001dea0: 7475 700a 2020 2020 2020 2020 6d65 7461  tup.        meta
-0001deb0: 6461 7461 203d 204d 6f63 6b28 290a 2020  data = Mock().  
-0001dec0: 2020 2020 2020 6d65 7461 6461 7461 2e63        metadata.c
-0001ded0: 6f6c 756d 6e73 203d 207b 2761 273a 207b  olumns = {'a': {
-0001dee0: 2773 6474 7970 6527 3a20 2763 6174 6567  'sdtype': 'categ
-0001def0: 6f72 6963 616c 277d 7d0a 0a20 2020 2020  orical'}}..     
-0001df00: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
-0001df10: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-0001df20: 2028 0a20 2020 2020 2020 2020 2020 2027   (.            '
-0001df30: 4120 5363 616c 6172 5261 6e67 6520 636f  A ScalarRange co
-0001df40: 6e73 7472 6169 6e74 2069 7320 6265 696e  nstraint is bein
-0001df50: 6720 6170 706c 6965 6420 746f 2063 6f6c  g applied to col
-0001df60: 756d 6e73 2077 6974 6820 6d69 736d 6174  umns with mismat
-0001df70: 6368 6564 2073 6474 7970 6573 2e20 270a  ched sdtypes. '.
-0001df80: 2020 2020 2020 2020 2020 2020 274e 756d              'Num
-0001df90: 6572 6963 616c 2063 6f6c 756d 6e73 206d  erical columns m
-0001dfa0: 7573 7420 6265 2063 6f6d 7061 7265 6420  ust be compared 
-0001dfb0: 746f 2069 6e74 6567 6572 206f 7220 666c  to integer or fl
-0001dfc0: 6f61 7420 7661 6c75 6573 2e20 270a 2020  oat values. '.  
-0001dfd0: 2020 2020 2020 2020 2020 2744 6174 6574            'Datet
-0001dfe0: 696d 6573 2063 6f6c 756d 6e20 6d75 7374  imes column must
-0001dff0: 2062 6520 636f 6d70 6172 6564 2074 6f20   be compared to 
-0001e000: 6461 7465 7469 6d65 2073 7472 696e 6773  datetime strings
-0001e010: 2e27 0a20 2020 2020 2020 2029 0a20 2020  .'.        ).   
-0001e020: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-0001e030: 2e72 6169 7365 7328 436f 6e73 7472 6169  .raises(Constrai
-0001e040: 6e74 4d65 7461 6461 7461 4572 726f 722c  ntMetadataError,
-0001e050: 206d 6174 6368 3d65 7272 6f72 5f6d 6573   match=error_mes
-0001e060: 7361 6765 293a 0a20 2020 2020 2020 2020  sage):.         
-0001e070: 2020 2053 6361 6c61 7252 616e 6765 2e5f     ScalarRange._
-0001e080: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-0001e090: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
-0001e0a0: 6e73 7472 6169 6e74 280a 2020 2020 2020  nstraint(.      
-0001e0b0: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
-0001e0c0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-0001e0d0: 2020 2020 636f 6c75 6d6e 5f6e 616d 653d      column_name=
-0001e0e0: 2761 272c 0a20 2020 2020 2020 2020 2020  'a',.           
-0001e0f0: 2020 2020 2068 6967 685f 7661 6c75 653d       high_value=
-0001e100: 2731 3027 2c0a 2020 2020 2020 2020 2020  '10',.          
-0001e110: 2020 2020 2020 6c6f 775f 7661 6c75 653d        low_value=
-0001e120: 2737 270a 2020 2020 2020 2020 2020 2020  '7'.            
-0001e130: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-0001e140: 5f76 616c 6964 6174 655f 696e 6974 5f69  _validate_init_i
-0001e150: 6e70 7574 7328 7365 6c66 293a 0a20 2020  nputs(self):.   
-0001e160: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
-0001e170: 2060 605f 7661 6c69 6461 7465 5f69 6e69   ``_validate_ini
-0001e180: 745f 696e 7075 7473 6060 206d 6574 686f  t_inputs`` metho
-0001e190: 642e 0a0a 2020 2020 2020 2020 5468 6520  d...        The 
-0001e1a0: 6d65 7468 6f64 2073 686f 756c 6420 7261  method should ra
-0001e1b0: 6973 6520 616e 2065 7272 6f72 2069 6620  ise an error if 
-0001e1c0: 7468 6520 696e 7075 7473 2061 7265 206e  the inputs are n
-0001e1d0: 6f74 2076 616c 6964 2e0a 0a20 2020 2020  ot valid...     
-0001e1e0: 2020 2053 6574 7570 3a0a 2020 2020 2020     Setup:.      
-0001e1f0: 2020 2020 2020 2d20 6c6f 775f 7661 6c75        - low_valu
-0001e200: 6520 6173 2061 2073 7472 696e 6720 6e6f  e as a string no
-0001e210: 7420 7265 7072 6573 656e 7469 6e67 2061  t representing a
-0001e220: 2064 6174 6574 696d 652e 0a20 2020 2020   datetime..     
-0001e230: 2020 2020 2020 202d 2068 6967 685f 7661         - high_va
-0001e240: 6c75 6520 6173 2061 2069 6e74 2e0a 0a20  lue as a int... 
-0001e250: 2020 2020 2020 2053 6964 6520 4566 6665         Side Effe
-0001e260: 6374 733a 0a20 2020 2020 2020 2020 2020  cts:.           
-0001e270: 2041 2076 616c 7565 2065 7272 6f72 2073   A value error s
-0001e280: 686f 756c 6420 6265 2072 6169 7365 642e  hould be raised.
-0001e290: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001e2a0: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
-0001e2b0: 2020 2020 206c 6f77 5f76 616c 7565 203d       low_value =
-0001e2c0: 2027 6162 6327 0a20 2020 2020 2020 2068   'abc'.        h
-0001e2d0: 6967 685f 7661 6c75 6520 3d20 320a 0a20  igh_value = 2.. 
-0001e2e0: 2020 2020 2020 2023 2052 756e 202f 2041         # Run / A
-0001e2f0: 7373 6572 740a 2020 2020 2020 2020 6572  ssert.        er
-0001e300: 726f 725f 6d73 6720 3d20 280a 2020 2020  ror_msg = (.    
-0001e310: 2020 2020 2020 2020 2760 606c 6f77 5f76          '``low_v
-0001e320: 616c 7565 6060 2061 6e64 2060 6068 6967  alue`` and ``hig
-0001e330: 685f 7661 6c75 6560 6020 6d75 7374 2062  h_value`` must b
-0001e340: 6520 6120 6e75 6d62 6572 206f 7220 6120  e a number or a 
-0001e350: 7374 7269 6e67 2074 6861 7420 270a 2020  string that '.  
-0001e360: 2020 2020 2020 2020 2020 2772 6570 7265            'repre
-0001e370: 7365 6e74 7320 6120 6461 7465 7469 6d65  sents a datetime
-0001e380: 2e27 0a20 2020 2020 2020 2029 0a20 2020  .'.        ).   
-0001e390: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-0001e3a0: 2e72 6169 7365 7328 5661 6c75 6545 7272  .raises(ValueErr
-0001e3b0: 6f72 2c20 6d61 7463 683d 6572 726f 725f  or, match=error_
-0001e3c0: 6d73 6729 3a0a 2020 2020 2020 2020 2020  msg):.          
-0001e3d0: 2020 5363 616c 6172 5261 6e67 652e 5f76    ScalarRange._v
-0001e3e0: 616c 6964 6174 655f 696e 6974 5f69 6e70  alidate_init_inp
-0001e3f0: 7574 7328 6c6f 775f 7661 6c75 652c 2068  uts(low_value, h
-0001e400: 6967 685f 7661 6c75 6529 0a0a 2020 2020  igh_value)..    
-0001e410: 6465 6620 7465 7374 5f5f 7661 6c69 6461  def test__valida
-0001e420: 7465 5f69 6e69 745f 696e 7075 7473 5f64  te_init_inputs_d
-0001e430: 6174 6574 696d 6573 5f6e 6f74 5f73 7472  atetimes_not_str
-0001e440: 696e 6773 2873 656c 6629 3a0a 2020 2020  ings(self):.    
-0001e450: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
-0001e460: 6060 5f76 616c 6964 6174 655f 696e 6974  ``_validate_init
-0001e470: 5f69 6e70 7574 7360 6020 6d65 7468 6f64  _inputs`` method
-0001e480: 2e0a 0a20 2020 2020 2020 2054 6865 206d  ...        The m
-0001e490: 6574 686f 6420 7368 6f75 6c64 2072 6169  ethod should rai
-0001e4a0: 7365 2061 6e20 6572 726f 7220 6966 2074  se an error if t
-0001e4b0: 6865 2064 6174 6574 696d 6573 2061 7265  he datetimes are
-0001e4c0: 206e 6f74 2072 6570 7265 7365 6e74 6564   not represented
-0001e4d0: 2061 7320 7374 7269 6e67 2e0a 0a20 2020   as string...   
-0001e4e0: 2020 2020 2053 6574 7570 3a0a 2020 2020       Setup:.    
-0001e4f0: 2020 2020 2020 2020 2d20 6c6f 775f 7661          - low_va
-0001e500: 6c75 6520 6173 2060 6070 642e 6461 7465  lue as ``pd.date
-0001e510: 7469 6d65 6060 0a20 2020 2020 2020 2020  time``.         
-0001e520: 2020 202d 2068 6967 685f 7661 6c75 6520     - high_value 
-0001e530: 6173 2060 6070 642e 6461 7465 7469 6d65  as ``pd.datetime
-0001e540: 6060 0a0a 2020 2020 2020 2020 5369 6465  ``..        Side
-0001e550: 2045 6666 6563 7473 3a0a 2020 2020 2020   Effects:.      
-0001e560: 2020 2020 2020 4120 7661 6c75 6520 6572        A value er
-0001e570: 726f 7220 7368 6f75 6c64 2062 6520 7261  ror should be ra
-0001e580: 6973 6564 2e0a 2020 2020 2020 2020 2222  ised..        ""
-0001e590: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
-0001e5a0: 700a 2020 2020 2020 2020 6c6f 775f 7661  p.        low_va
-0001e5b0: 6c75 6520 3d20 7064 2e74 6f5f 6461 7465  lue = pd.to_date
-0001e5c0: 7469 6d65 2827 3230 3231 2d30 322d 3032  time('2021-02-02
-0001e5d0: 2729 0a20 2020 2020 2020 2068 6967 685f  ').        high_
-0001e5e0: 7661 6c75 6520 3d20 7064 2e74 6f5f 6461  value = pd.to_da
-0001e5f0: 7465 7469 6d65 2827 3230 3231 2d30 322d  tetime('2021-02-
-0001e600: 3032 2729 0a0a 2020 2020 2020 2020 2320  02')..        # 
-0001e610: 5275 6e20 2f20 4173 7365 7274 0a20 2020  Run / Assert.   
-0001e620: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
-0001e630: 2e72 6169 7365 7328 5661 6c75 6545 7272  .raises(ValueErr
-0001e640: 6f72 2c20 6d61 7463 683d 2744 6174 6574  or, match='Datet
-0001e650: 696d 6520 6d75 7374 2062 6520 7265 7072  ime must be repr
-0001e660: 6573 656e 7465 6420 6173 2061 2073 7472  esented as a str
-0001e670: 696e 672e 2729 3a0a 2020 2020 2020 2020  ing.'):.        
-0001e680: 2020 2020 5363 616c 6172 5261 6e67 652e      ScalarRange.
-0001e690: 5f76 616c 6964 6174 655f 696e 6974 5f69  _validate_init_i
-0001e6a0: 6e70 7574 7328 6c6f 775f 7661 6c75 652c  nputs(low_value,
-0001e6b0: 2068 6967 685f 7661 6c75 6529 0a0a 2020   high_value)..  
-0001e6c0: 2020 6465 6620 7465 7374 5f5f 5f69 6e69    def test___ini
-0001e6d0: 745f 5f28 7365 6c66 293a 0a20 2020 2020  t__(self):.     
-0001e6e0: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-0001e6f0: 6053 6361 6c61 7252 616e 6765 2e5f 5f69  `ScalarRange.__i
-0001e700: 6e69 745f 5f60 6020 6d65 7468 6f64 2e0a  nit__`` method..
-0001e710: 0a20 2020 2020 2020 2054 6865 2069 6e73  .        The ins
-0001e720: 7461 6e63 6520 7368 6f75 6c64 2063 6f6e  tance should con
-0001e730: 7461 696e 2074 6865 206e 616d 6520 6f66  tain the name of
-0001e740: 2074 6865 2074 6872 6565 2070 6173 7365   the three passe
-0001e750: 6420 636f 6c75 6d6e 7320 616e 6420 616c  d columns and al
-0001e760: 736f 0a20 2020 2020 2020 2075 7365 2061  so.        use a
-0001e770: 6e20 6f70 6572 6174 6f72 2060 603c 6060  n operator ``<``
-0001e780: 2069 6620 6060 7374 7269 6374 5f62 6f75   if ``strict_bou
-0001e790: 6e64 6172 6965 7360 6020 6973 2060 6054  ndaries`` is ``T
-0001e7a0: 7275 6560 6020 6279 2064 6566 6175 6c74  rue`` by default
-0001e7b0: 2e0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
-0001e7c0: 0a20 2020 2020 2020 2020 2020 202d 2043  .            - C
-0001e7d0: 6f6c 756d 6e20 6e61 6d65 2e0a 2020 2020  olumn name..    
-0001e7e0: 2020 2020 2020 2020 2d20 4c6f 7765 7220          - Lower 
-0001e7f0: 7661 6c75 652e 0a20 2020 2020 2020 2020  value..         
-0001e800: 2020 202d 2048 6967 6820 7661 6c75 652e     - High value.
-0001e810: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001e820: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
-0001e830: 2020 2069 6e73 7461 6e63 6520 3d20 5363     instance = Sc
-0001e840: 616c 6172 5261 6e67 6528 636f 6c75 6d6e  alarRange(column
-0001e850: 5f6e 616d 653d 2761 6765 5f77 6865 6e5f  _name='age_when_
-0001e860: 6a6f 696e 6564 272c 206c 6f77 5f76 616c  joined', low_val
-0001e870: 7565 3d31 382c 2068 6967 685f 7661 6c75  ue=18, high_valu
-0001e880: 653d 3238 290a 0a20 2020 2020 2020 2023  e=28)..        #
-0001e890: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-0001e8a0: 6173 7365 7274 2069 6e73 7461 6e63 652e  assert instance.
-0001e8b0: 5f63 6f6c 756d 6e5f 6e61 6d65 203d 3d20  _column_name == 
-0001e8c0: 2761 6765 5f77 6865 6e5f 6a6f 696e 6564  'age_when_joined
-0001e8d0: 270a 2020 2020 2020 2020 6173 7365 7274  '.        assert
-0001e8e0: 2069 6e73 7461 6e63 652e 5f6c 6f77 5f76   instance._low_v
-0001e8f0: 616c 7565 203d 3d20 3138 0a20 2020 2020  alue == 18.     
-0001e900: 2020 2061 7373 6572 7420 696e 7374 616e     assert instan
-0001e910: 6365 2e5f 6869 6768 5f76 616c 7565 203d  ce._high_value =
-0001e920: 3d20 3238 0a20 2020 2020 2020 2061 7373  = 28.        ass
-0001e930: 6572 7420 696e 7374 616e 6365 2e5f 6f70  ert instance._op
-0001e940: 6572 6174 6f72 203d 3d20 6f70 6572 6174  erator == operat
-0001e950: 6f72 2e6c 740a 0a20 2020 2064 6566 2074  or.lt..    def t
-0001e960: 6573 745f 5f5f 696e 6974 5f5f 7374 7269  est___init__stri
-0001e970: 6374 5f62 6f75 6e64 6172 6965 735f 6661  ct_boundaries_fa
-0001e980: 6c73 6528 7365 6c66 293a 0a20 2020 2020  lse(self):.     
-0001e990: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-0001e9a0: 6053 6361 6c61 7252 616e 6765 2e5f 5f69  `ScalarRange.__i
-0001e9b0: 6e69 745f 5f60 6020 6d65 7468 6f64 2e0a  nit__`` method..
-0001e9c0: 0a20 2020 2020 2020 2054 6573 7420 7468  .        Test th
-0001e9d0: 6520 6060 5f5f 696e 6974 5f5f 6060 206d  e ``__init__`` m
-0001e9e0: 6574 686f 6420 7768 656e 2060 6073 7472  ethod when ``str
-0001e9f0: 6963 745f 626f 756e 6461 7269 6573 6060  ict_boundaries``
-0001ea00: 2069 7320 6060 4661 6c73 6560 602e 0a0a   is ``False``...
-0001ea10: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
-0001ea20: 2020 2020 2020 2020 2020 202d 2054 6872             - Thr
-0001ea30: 6565 2063 6f6c 756d 6e20 6e61 6d65 732e  ee column names.
-0001ea40: 0a20 2020 2020 2020 2020 2020 202d 2060  .            - `
-0001ea50: 6073 7472 6963 745f 626f 756e 6461 7269  `strict_boundari
-0001ea60: 6573 3d46 616c 7365 6060 2e0a 0a20 2020  es=False``...   
-0001ea70: 2020 2020 2053 6964 6520 4566 6665 6374       Side Effect
-0001ea80: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-0001ea90: 6060 696e 7374 616e 6365 2e5f 6f70 6572  ``instance._oper
-0001eaa0: 6174 6f72 6060 2073 686f 756c 6420 6265  ator`` should be
-0001eab0: 2060 606f 7065 7261 746f 722e 6c65 6060   ``operator.le``
-0001eac0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001ead0: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
-0001eae0: 2020 2069 6e73 7461 6e63 6520 3d20 5363     instance = Sc
-0001eaf0: 616c 6172 5261 6e67 6528 2761 6765 5f77  alarRange('age_w
-0001eb00: 6865 6e5f 6a6f 696e 6564 272c 2031 382c  hen_joined', 18,
-0001eb10: 2032 382c 2073 7472 6963 745f 626f 756e   28, strict_boun
-0001eb20: 6461 7269 6573 3d46 616c 7365 290a 0a20  daries=False).. 
-0001eb30: 2020 2020 2020 2023 2041 7373 6572 740a         # Assert.
-0001eb40: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-0001eb50: 6e73 7461 6e63 652e 5f63 6f6c 756d 6e5f  nstance._column_
-0001eb60: 6e61 6d65 203d 3d20 2761 6765 5f77 6865  name == 'age_whe
-0001eb70: 6e5f 6a6f 696e 6564 270a 2020 2020 2020  n_joined'.      
-0001eb80: 2020 6173 7365 7274 2069 6e73 7461 6e63    assert instanc
-0001eb90: 652e 5f6c 6f77 5f76 616c 7565 203d 3d20  e._low_value == 
-0001eba0: 3138 0a20 2020 2020 2020 2061 7373 6572  18.        asser
-0001ebb0: 7420 696e 7374 616e 6365 2e5f 6869 6768  t instance._high
-0001ebc0: 5f76 616c 7565 203d 3d20 3238 0a20 2020  _value == 28.   
-0001ebd0: 2020 2020 2061 7373 6572 7420 696e 7374       assert inst
-0001ebe0: 616e 6365 2e5f 6f70 6572 6174 6f72 203d  ance._operator =
-0001ebf0: 3d20 6f70 6572 6174 6f72 2e6c 650a 0a20  = operator.le.. 
-0001ec00: 2020 2064 6566 2074 6573 745f 5f67 6574     def test__get
-0001ec10: 5f69 735f 6461 7465 7469 6d65 2873 656c  _is_datetime(sel
-0001ec20: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
-0001ec30: 6573 7420 7468 6174 2074 6865 206d 6574  est that the met
-0001ec40: 686f 6420 6465 7465 6374 7320 7768 6574  hod detects whet
-0001ec50: 6865 7220 6f72 206e 6f74 2074 6865 2060  her or not the `
-0001ec60: 6064 6174 6160 6020 6973 2060 6064 6174  `data`` is ``dat
-0001ec70: 6574 696d 6560 602e 0a0a 2020 2020 2020  etime``...      
-0001ec80: 2020 5468 6973 206d 6574 686f 6420 7368    This method sh
-0001ec90: 6f75 6c64 2064 6574 6563 7420 7768 6574  ould detect whet
-0001eca0: 6865 7220 6f72 206e 6f74 2074 6865 2064  her or not the d
-0001ecb0: 6174 6120 6973 2060 6064 6174 6574 696d  ata is ``datetim
-0001ecc0: 6560 6020 616e 6420 6966 2069 6e20 6361  e`` and if in ca
-0001ecd0: 7365 2073 6f6d 6520 6973 0a20 2020 2020  se some is.     
-0001ece0: 2020 2062 7574 206f 7468 6572 2069 7320     but other is 
-0001ecf0: 6e6f 742c 2072 6169 7365 7320 616e 2065  not, raises an e
-0001ed00: 7272 6f72 2e0a 0a20 2020 2020 2020 2053  rror...        S
-0001ed10: 6574 7570 3a0a 2020 2020 2020 2020 2020  etup:.          
-0001ed20: 2020 2d20 4372 6561 7465 2061 2070 642e    - Create a pd.
-0001ed30: 4461 7461 4672 616d 6520 7769 7468 2061  DataFrame with a
-0001ed40: 2063 6f6c 756d 6e20 7468 6174 2063 6f6e   column that con
-0001ed50: 7461 696e 7320 6461 7465 7469 6d65 2064  tains datetime d
-0001ed60: 6174 612e 0a20 2020 2020 2020 2020 2020  ata..           
-0001ed70: 202d 2049 6e73 7461 6e63 6520 6f66 2060   - Instance of `
-0001ed80: 6053 6361 6c61 7252 616e 6765 6060 2063  `ScalarRange`` c
-0001ed90: 6f6e 7374 7261 696e 7420 7769 7468 206c  onstraint with l
-0001eda0: 6f77 2061 6e64 2068 6967 6820 6173 2064  ow and high as d
-0001edb0: 6174 6574 696d 6520 2874 696d 6573 7461  atetime (timesta
-0001edc0: 6d70 7329 2e0a 0a20 2020 2020 2020 2049  mps)...        I
-0001edd0: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
-0001ede0: 2020 2d20 7064 2e44 6174 6146 7261 6d65    - pd.DataFrame
-0001edf0: 2077 6974 6820 6060 7072 6f6d 6f74 696f   with ``promotio
-0001ee00: 6e5f 6461 7465 6060 2063 6f6c 756d 6e2e  n_date`` column.
-0001ee10: 0a0a 2020 2020 2020 2020 4f75 7470 7574  ..        Output
-0001ee20: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-0001ee30: 5468 6520 6f75 7470 7574 2073 686f 756c  The output shoul
-0001ee40: 6420 6265 2054 7275 652e 0a20 2020 2020  d be True..     
-0001ee50: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
-0001ee60: 2053 6574 7570 0a20 2020 2020 2020 2074   Setup.        t
-0001ee70: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
-0001ee80: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
-0001ee90: 2020 2020 2020 2027 7072 6f6d 6f74 696f         'promotio
-0001eea0: 6e5f 6461 7465 273a 2070 642e 746f 5f64  n_date': pd.to_d
-0001eeb0: 6174 6574 696d 6528 5b27 3230 3232 2d30  atetime(['2022-0
-0001eec0: 352d 3130 272c 2027 3230 3232 2d30 362d  5-10', '2022-06-
-0001eed0: 3130 272c 2027 3230 3232 2d31 312d 3137  10', '2022-11-17
-0001eee0: 275d 292c 0a20 2020 2020 2020 207d 290a  ']),.        }).
-0001eef0: 2020 2020 2020 2020 696e 7374 616e 6365          instance
-0001ef00: 203d 2053 6361 6c61 7252 616e 6765 2827   = ScalarRange('
-0001ef10: 7072 6f6d 6f74 696f 6e5f 6461 7465 272c  promotion_date',
-0001ef20: 2027 3230 3231 2d30 322d 3130 272c 2027   '2021-02-10', '
-0001ef30: 3230 3530 2d31 302d 3131 2729 0a0a 2020  2050-10-11')..  
-0001ef40: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
-0001ef50: 2020 2020 6973 5f64 6174 6574 696d 6520      is_datetime 
-0001ef60: 3d20 696e 7374 616e 6365 2e5f 6765 745f  = instance._get_
-0001ef70: 6973 5f64 6174 6574 696d 6528 7461 626c  is_datetime(tabl
-0001ef80: 655f 6461 7461 290a 0a20 2020 2020 2020  e_data)..       
-0001ef90: 2023 2041 7373 6572 740a 2020 2020 2020   # Assert.      
-0001efa0: 2020 6173 7365 7274 2069 735f 6461 7465    assert is_date
-0001efb0: 7469 6d65 0a0a 2020 2020 6465 6620 7465  time..    def te
-0001efc0: 7374 5f5f 6765 745f 6973 5f64 6174 6574  st__get_is_datet
-0001efd0: 696d 655f 6e6f 5f64 6174 6574 696d 6573  ime_no_datetimes
-0001efe0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0001eff0: 2222 2254 6573 7420 7468 6174 2074 6865  """Test that the
-0001f000: 206d 6574 686f 6420 6465 7465 6374 7320   method detects 
-0001f010: 7768 6574 6865 7220 6f72 206e 6f74 2074  whether or not t
-0001f020: 6865 2060 6064 6174 6160 6020 6973 2060  he ``data`` is `
-0001f030: 6064 6174 6574 696d 6560 602e 0a0a 2020  `datetime``...  
-0001f040: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
-0001f050: 6420 7368 6f75 6c64 2064 6574 6563 7420  d should detect 
-0001f060: 7768 6574 6865 7220 6f72 206e 6f74 2074  whether or not t
-0001f070: 6865 2064 6174 6120 6973 2060 6064 6174  he data is ``dat
-0001f080: 6574 696d 6560 6020 616e 6420 6966 2069  etime`` and if i
-0001f090: 6e20 6361 7365 2073 6f6d 6520 6973 0a20  n case some is. 
-0001f0a0: 2020 2020 2020 2062 7574 206f 7468 6572         but other
-0001f0b0: 2069 7320 6e6f 742c 2072 6169 7365 7320   is not, raises 
-0001f0c0: 616e 2065 7272 6f72 2e0a 0a20 2020 2020  an error...     
-0001f0d0: 2020 2053 6574 7570 3a0a 2020 2020 2020     Setup:.      
-0001f0e0: 2020 2020 2020 2d20 4372 6561 7465 2061        - Create a
-0001f0f0: 2070 642e 4461 7461 4672 616d 6520 7769   pd.DataFrame wi
-0001f100: 7468 2061 2063 6f6c 756d 6e20 7468 6174  th a column that
-0001f110: 2069 7320 6e6f 7420 6461 7461 7469 6d65   is not datatime
-0001f120: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-0001f130: 496e 7374 616e 6365 206f 6620 6060 5363  Instance of ``Sc
-0001f140: 616c 6172 5261 6e67 6560 6020 636f 6e73  alarRange`` cons
-0001f150: 7472 6169 6e74 2077 6974 6820 6c6f 7720  traint with low 
-0001f160: 616e 6420 6869 6768 2061 7320 696e 7465  and high as inte
-0001f170: 6765 7273 2e0a 0a20 2020 2020 2020 2049  gers...        I
-0001f180: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
-0001f190: 2020 2d20 7064 2e44 6174 6146 7261 6d65    - pd.DataFrame
-0001f1a0: 2077 6974 6820 6060 6375 7272 656e 745f   with ``current_
-0001f1b0: 6167 6560 600a 0a20 2020 2020 2020 204f  age``..        O
-0001f1c0: 7574 7075 743a 0a20 2020 2020 2020 2020  utput:.         
-0001f1d0: 2020 202d 2054 6865 206f 7574 7075 7420     - The output 
-0001f1e0: 7368 6f75 6c64 2062 6520 6661 6c73 6520  should be false 
-0001f1f0: 7369 6e63 6520 616c 6c20 7468 6520 6461  since all the da
-0001f200: 7461 2069 7320 6060 696e 7460 602e 0a20  ta is ``int``.. 
-0001f210: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001f220: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
-0001f230: 2020 2074 6162 6c65 5f64 6174 6120 3d20     table_data = 
-0001f240: 7064 2e44 6174 6146 7261 6d65 287b 2763  pd.DataFrame({'c
-0001f250: 7572 7265 6e74 5f61 6765 273a 205b 3231  urrent_age': [21
-0001f260: 2c20 3232 2c20 3235 5d7d 290a 2020 2020  , 22, 25]}).    
-0001f270: 2020 2020 696e 7374 616e 6365 203d 2053      instance = S
-0001f280: 6361 6c61 7252 616e 6765 2827 6375 7272  calarRange('curr
-0001f290: 656e 745f 6167 6527 2c20 3231 2c20 3330  ent_age', 21, 30
-0001f2a0: 290a 0a20 2020 2020 2020 2023 2052 756e  )..        # Run
-0001f2b0: 0a20 2020 2020 2020 2069 735f 6461 7465  .        is_date
-0001f2c0: 7469 6d65 203d 2069 6e73 7461 6e63 652e  time = instance.
-0001f2d0: 5f67 6574 5f69 735f 6461 7465 7469 6d65  _get_is_datetime
-0001f2e0: 2874 6162 6c65 5f64 6174 6129 0a0a 2020  (table_data)..  
-0001f2f0: 2020 2020 2020 2320 4173 7365 7274 0a20        # Assert. 
-0001f300: 2020 2020 2020 2061 7373 6572 7420 6e6f         assert no
-0001f310: 7420 6973 5f64 6174 6574 696d 650a 0a20  t is_datetime.. 
-0001f320: 2020 2064 6566 2074 6573 745f 5f67 6574     def test__get
-0001f330: 5f69 735f 6461 7465 7469 6d65 5f72 6169  _is_datetime_rai
-0001f340: 7365 735f 616e 5f65 7272 6f72 2873 656c  ses_an_error(sel
-0001f350: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
-0001f360: 6573 7420 7468 6174 2074 6865 206d 6574  est that the met
-0001f370: 686f 6420 6465 7465 6374 7320 7768 6574  hod detects whet
-0001f380: 6865 7220 6f72 206e 6f74 2074 6865 2060  her or not the `
-0001f390: 6064 6174 6160 6020 6973 2060 6064 6174  `data`` is ``dat
-0001f3a0: 6574 696d 6560 602e 0a0a 2020 2020 2020  etime``...      
-0001f3b0: 2020 5468 6973 206d 6574 686f 6420 7368    This method sh
-0001f3c0: 6f75 6c64 2064 6574 6563 7420 7768 6574  ould detect whet
-0001f3d0: 6865 7220 6f72 206e 6f74 2074 6865 2064  her or not the d
-0001f3e0: 6174 6120 6973 2060 6064 6174 6574 696d  ata is ``datetim
-0001f3f0: 6560 6020 616e 6420 6966 2069 6e20 6361  e`` and if in ca
-0001f400: 7365 2073 6f6d 6520 6973 0a20 2020 2020  se some is.     
-0001f410: 2020 2062 7574 206f 7468 6572 2069 7320     but other is 
-0001f420: 6e6f 742c 2072 6169 7365 7320 616e 2065  not, raises an e
-0001f430: 7272 6f72 2e0a 0a20 2020 2020 2020 2053  rror...        S
-0001f440: 6574 7570 3a0a 2020 2020 2020 2020 2020  etup:.          
-0001f450: 2020 2d20 4372 6561 7465 2061 2070 642e    - Create a pd.
-0001f460: 4461 7461 4672 616d 6520 7769 7468 2061  DataFrame with a
-0001f470: 2063 6f6c 756d 6e20 7468 6174 2063 6f6e   column that con
-0001f480: 7461 696e 7320 6461 7465 7469 6d65 2064  tains datetime d
-0001f490: 6174 612e 0a20 2020 2020 2020 2020 2020  ata..           
-0001f4a0: 202d 2049 6e73 7461 6e63 6520 6f66 2060   - Instance of `
-0001f4b0: 6053 6361 6c61 7252 616e 6765 6060 2063  `ScalarRange`` c
-0001f4c0: 6f6e 7374 7261 696e 7420 7769 7468 206c  onstraint with l
-0001f4d0: 6f77 2061 6e64 2068 6967 6820 6173 2069  ow and high as i
-0001f4e0: 6e74 6567 6572 732e 0a0a 2020 2020 2020  ntegers...      
-0001f4f0: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
-0001f500: 2020 2020 202d 2070 642e 4461 7461 4672       - pd.DataFr
-0001f510: 616d 6520 7769 7468 2020 6060 7072 6f6d  ame with  ``prom
-0001f520: 6f74 696f 6e5f 6461 7465 6060 2e0a 0a20  otion_date``... 
-0001f530: 2020 2020 2020 204f 7574 7075 743a 0a20         Output:. 
-0001f540: 2020 2020 2020 2020 2020 202d 2054 6865             - The
-0001f550: 206f 7574 7075 7420 7368 6f75 6c64 2062   output should b
-0001f560: 6520 6661 6c73 6520 7369 6e63 6520 616c  e false since al
-0001f570: 6c20 7468 6520 6461 7461 2069 7320 6060  l the data is ``
-0001f580: 696e 7460 602e 0a20 2020 2020 2020 2022  int``..        "
-0001f590: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
-0001f5a0: 7570 0a20 2020 2020 2020 2074 6162 6c65  up.        table
-0001f5b0: 5f64 6174 6120 3d20 7064 2e44 6174 6146  _data = pd.DataF
-0001f5c0: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
-0001f5d0: 2020 2027 7072 6f6d 6f74 696f 6e5f 6461     'promotion_da
-0001f5e0: 7465 273a 2070 642e 746f 5f64 6174 6574  te': pd.to_datet
-0001f5f0: 696d 6528 5b27 3230 3232 2d30 352d 3130  ime(['2022-05-10
-0001f600: 272c 2027 3230 3232 2d30 362d 3130 272c  ', '2022-06-10',
-0001f610: 2027 3230 3232 2d31 312d 3137 275d 292c   '2022-11-17']),
-0001f620: 0a20 2020 2020 2020 207d 290a 2020 2020  .        }).    
-0001f630: 2020 2020 696e 7374 616e 6365 203d 2053      instance = S
-0001f640: 6361 6c61 7252 616e 6765 2827 7072 6f6d  calarRange('prom
-0001f650: 6f74 696f 6e5f 6461 7465 272c 2031 382c  otion_date', 18,
-0001f660: 2032 3529 0a20 2020 2020 2020 2065 7870   25).        exp
-0001f670: 6563 7465 645f 7465 7874 203d 2027 5468  ected_text = 'Th
-0001f680: 6520 636f 6e73 7472 6169 6e74 2063 6f6c  e constraint col
-0001f690: 756d 6e20 616e 6420 626f 756e 6473 206d  umn and bounds m
-0001f6a0: 7573 7420 616c 6c20 6265 2064 6174 6574  ust all be datet
-0001f6b0: 696d 652e 270a 0a20 2020 2020 2020 2023  ime.'..        #
-0001f6c0: 2052 756e 0a20 2020 2020 2020 2077 6974   Run.        wit
-0001f6d0: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
-0001f6e0: 5661 6c75 6545 7272 6f72 2c20 6d61 7463  ValueError, matc
-0001f6f0: 683d 6578 7065 6374 6564 5f74 6578 7429  h=expected_text)
-0001f700: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
-0001f710: 7374 616e 6365 2e5f 6765 745f 6973 5f64  stance._get_is_d
-0001f720: 6174 6574 696d 6528 7461 626c 655f 6461  atetime(table_da
-0001f730: 7461 290a 0a20 2020 2064 6566 2074 6573  ta)..    def tes
-0001f740: 745f 5f67 6574 5f64 6966 665f 636f 6c75  t__get_diff_colu
-0001f750: 6d6e 5f6e 616d 6528 7365 6c66 293a 0a20  mn_name(self):. 
-0001f760: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
-0001f770: 6865 2060 6053 6361 6c61 7252 616e 6765  he ``ScalarRange
-0001f780: 2e5f 6765 745f 6469 6666 5f63 6f6c 756d  ._get_diff_colum
-0001f790: 6e5f 6e61 6d65 6060 206d 6574 686f 642e  n_name`` method.
-0001f7a0: 0a0a 2020 2020 2020 2020 5468 6973 206d  ..        This m
-0001f7b0: 6574 686f 6420 7368 6f75 6c64 2072 6574  ethod should ret
-0001f7c0: 7572 6e20 7468 6520 6e61 6d65 2066 6f72  urn the name for
-0001f7d0: 2074 6865 206e 6577 2060 6074 7261 6e73   the new ``trans
-0001f7e0: 666f 726d 5f63 6f6c 756d 6e60 602e 0a0a  form_column``...
-0001f7f0: 2020 2020 2020 2020 5365 7475 703a 0a20          Setup:. 
-0001f800: 2020 2020 2020 2020 2020 202d 2043 7265             - Cre
-0001f810: 6174 6520 6120 7064 2e44 6174 6146 7261  ate a pd.DataFra
-0001f820: 6d65 2e0a 2020 2020 2020 2020 2020 2020  me..            
-0001f830: 2d20 496e 7374 616e 6365 206f 6620 6060  - Instance of ``
-0001f840: 5363 616c 6172 5261 6e67 6560 6020 636f  ScalarRange`` co
-0001f850: 6e73 7472 6169 6e74 2e0a 0a20 2020 2020  nstraint...     
-0001f860: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
-0001f870: 2020 2020 2020 2d20 7064 2e44 6174 6146        - pd.DataF
-0001f880: 7261 6d65 2077 6974 6820 6060 6375 7272  rame with ``curr
-0001f890: 656e 745f 6167 6560 6020 636f 6c75 6d6e  ent_age`` column
-0001f8a0: 2e0a 0a20 2020 2020 2020 204f 7574 7075  ...        Outpu
-0001f8b0: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-0001f8c0: 2054 6865 2063 6f6c 756d 6e20 6e61 6d65   The column name
-0001f8d0: 2063 6f6e 6361 7465 6e61 7465 6420 7769   concatenated wi
-0001f8e0: 7468 2060 6023 6060 2066 6f6c 6c6f 7765  th ``#`` followe
-0001f8f0: 6420 6279 2074 6865 2060 606c 6f77 6060  d by the ``low``
-0001f900: 2061 6e64 2060 6068 6967 6860 6020 7661   and ``high`` va
-0001f910: 6c75 6573 2e0a 2020 2020 2020 2020 2222  lues..        ""
-0001f920: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
-0001f930: 700a 2020 2020 2020 2020 7461 626c 655f  p.        table_
-0001f940: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
-0001f950: 616d 6528 7b0a 2020 2020 2020 2020 2020  ame({.          
-0001f960: 2020 2763 7572 7265 6e74 5f61 6765 273a    'current_age':
-0001f970: 205b 3231 2c20 3232 2c20 3235 5d2c 0a20   [21, 22, 25],. 
-0001f980: 2020 2020 2020 2020 2020 2027 6375 7272             'curr
-0001f990: 656e 745f 6167 6523 3138 2333 3527 3a20  ent_age#18#35': 
-0001f9a0: 5b31 2c20 322c 2033 5d0a 2020 2020 2020  [1, 2, 3].      
-0001f9b0: 2020 7d29 0a20 2020 2020 2020 2069 6e73    }).        ins
-0001f9c0: 7461 6e63 6520 3d20 5363 616c 6172 5261  tance = ScalarRa
-0001f9d0: 6e67 6528 2763 7572 7265 6e74 5f61 6765  nge('current_age
-0001f9e0: 272c 2031 382c 2033 3529 0a0a 2020 2020  ', 18, 35)..    
-0001f9f0: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
-0001fa00: 2020 7472 616e 7366 6f72 6d65 645f 636f    transformed_co
-0001fa10: 6c75 6d6e 5f6e 616d 6520 3d20 696e 7374  lumn_name = inst
-0001fa20: 616e 6365 2e5f 6765 745f 6469 6666 5f63  ance._get_diff_c
-0001fa30: 6f6c 756d 6e5f 6e61 6d65 2874 6162 6c65  olumn_name(table
-0001fa40: 5f64 6174 6129 0a0a 2020 2020 2020 2020  _data)..        
-0001fa50: 2320 4173 7365 7274 0a20 2020 2020 2020  # Assert.       
-0001fa60: 2061 7373 6572 7420 7472 616e 7366 6f72   assert transfor
-0001fa70: 6d65 645f 636f 6c75 6d6e 5f6e 616d 6520  med_column_name 
-0001fa80: 3d3d 2027 6375 7272 656e 745f 6167 6523  == 'current_age#
-0001fa90: 2331 3823 2333 3527 0a0a 2020 2020 6465  #18##35'..    de
-0001faa0: 6620 7465 7374 5f5f 6669 7428 7365 6c66  f test__fit(self
-0001fab0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-0001fac0: 7374 2074 6865 2060 605f 6669 7460 6020  st the ``_fit`` 
-0001fad0: 6d65 7468 6f64 206f 6620 6060 5363 616c  method of ``Scal
-0001fae0: 6172 5261 6e67 6560 602e 0a0a 2020 2020  arRange``...    
-0001faf0: 2020 2020 5465 7374 2074 6861 7420 7468      Test that th
-0001fb00: 6520 6060 5f66 6974 6060 206d 6574 686f  e ``_fit`` metho
-0001fb10: 6420 7374 6f72 6573 2074 6865 2070 726f  d stores the pro
-0001fb20: 7065 7220 7472 616e 7366 6f72 6d61 7469  per transformati
-0001fb30: 6f6e 2063 6f6c 756d 6e20 6e61 6d65 2061  on column name a
-0001fb40: 6e64 0a20 2020 2020 2020 206c 6561 726e  nd.        learn
-0001fb50: 7320 7768 6574 6865 7220 7468 6520 6461  s whether the da
-0001fb60: 7461 2069 7320 6060 6461 7465 7469 6d65  ta is ``datetime
-0001fb70: 6060 6f72 206e 6f74 2061 6e64 2069 7427  ``or not and it'
-0001fb80: 7320 6060 6474 7970 6560 602e 0a0a 2020  s ``dtype``...  
-0001fb90: 2020 2020 2020 5365 7475 703a 0a20 2020        Setup:.   
-0001fba0: 2020 2020 2020 2020 202d 2043 7265 6174           - Creat
-0001fbb0: 6520 6120 7064 2e44 6174 6146 7261 6d65  e a pd.DataFrame
-0001fbc0: 2077 6974 6820 6120 636f 6c75 6d6e 2e0a   with a column..
-0001fbd0: 2020 2020 2020 2020 2020 2020 2d20 496e              - In
-0001fbe0: 7374 616e 6365 206f 6620 6060 5363 616c  stance of ``Scal
-0001fbf0: 6172 5261 6e67 6560 6020 636f 6e73 7472  arRange`` constr
-0001fc00: 6169 6e74 2077 6974 6820 7468 6f73 6520  aint with those 
-0001fc10: 7468 7265 6520 636f 6c75 6d6e 206e 616d  three column nam
-0001fc20: 6573 2e0a 0a20 2020 2020 2020 2049 6e70  es...        Inp
-0001fc30: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
-0001fc40: 2d20 7064 2e44 6174 6146 7261 6d65 2077  - pd.DataFrame w
-0001fc50: 6974 6820 6060 6375 7272 656e 745f 6167  ith ``current_ag
-0001fc60: 6560 6020 636f 6c75 6d6e 732e 0a0a 2020  e`` columns...  
-0001fc70: 2020 2020 2020 5369 6465 2045 6666 6563        Side Effec
-0001fc80: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-0001fc90: 2069 6e73 7461 6e63 6520 6861 7320 6060   instance has ``
-0001fca0: 5f74 7261 6e73 666f 726d 6564 5f63 6f6c  _transformed_col
-0001fcb0: 756d 6e60 6020 616e 6420 6060 5f69 735f  umn`` and ``_is_
-0001fcc0: 6461 7465 7469 6d65 6060 2061 6e64 2060  datetime`` and `
-0001fcd0: 605f 6474 7970 6560 602e 0a20 2020 2020  `_dtype``..     
-0001fce0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
-0001fcf0: 2053 6574 7570 0a20 2020 2020 2020 2074   Setup.        t
-0001fd00: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
-0001fd10: 6174 6146 7261 6d65 287b 2763 7572 7265  ataFrame({'curre
-0001fd20: 6e74 5f61 6765 273a 205b 3231 2c20 3232  nt_age': [21, 22
-0001fd30: 2c20 3235 5d7d 290a 2020 2020 2020 2020  , 25]}).        
-0001fd40: 696e 7374 616e 6365 203d 2053 6361 6c61  instance = Scala
-0001fd50: 7252 616e 6765 2827 6375 7272 656e 745f  rRange('current_
-0001fd60: 6167 6527 2c20 3138 2c20 3230 290a 0a20  age', 18, 20).. 
-0001fd70: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
-0001fd80: 2020 2020 2069 6e73 7461 6e63 652e 5f66       instance._f
-0001fd90: 6974 2874 6162 6c65 5f64 6174 6129 0a0a  it(table_data)..
-0001fda0: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
-0001fdb0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-0001fdc0: 6e6f 7420 696e 7374 616e 6365 2e5f 6973  not instance._is
-0001fdd0: 5f64 6174 6574 696d 650a 2020 2020 2020  _datetime.      
-0001fde0: 2020 6173 7365 7274 2069 6e73 7461 6e63    assert instanc
-0001fdf0: 652e 5f74 7261 6e73 666f 726d 6564 5f63  e._transformed_c
-0001fe00: 6f6c 756d 6e20 3d3d 2027 6375 7272 656e  olumn == 'curren
-0001fe10: 745f 6167 6523 3138 2332 3027 0a0a 2020  t_age#18#20'..  
-0001fe20: 2020 6465 6620 7465 7374 5f5f 6669 745f    def test__fit_
-0001fe30: 6461 7465 7469 6d65 2873 656c 6629 3a0a  datetime(self):.
-0001fe40: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-0001fe50: 7468 6520 6060 5f66 6974 6060 206d 6574  the ``_fit`` met
-0001fe60: 686f 6420 6f66 2060 6053 6361 6c61 7252  hod of ``ScalarR
-0001fe70: 616e 6765 6060 2077 6865 6e20 6669 7474  ange`` when fitt
-0001fe80: 696e 6720 7769 7468 2060 6064 6174 6574  ing with ``datet
-0001fe90: 696d 6560 6020 6461 7461 2e0a 0a20 2020  ime`` data...   
-0001fea0: 2020 2020 2053 6574 7570 3a0a 2020 2020       Setup:.    
-0001feb0: 2020 2020 2020 2020 2d20 7461 626c 655f          - table_
-0001fec0: 6461 7461 2077 6974 6820 6461 7465 7469  data with dateti
-0001fed0: 6d65 732e 0a0a 2020 2020 2020 2020 5369  mes...        Si
-0001fee0: 6465 2045 6666 6563 7473 3a0a 2020 2020  de Effects:.    
-0001fef0: 2020 2020 2020 2020 2d20 5468 6520 6060          - The ``
-0001ff00: 696e 7374 616e 6365 2e5f 6c6f 775f 7661  instance._low_va
-0001ff10: 6c75 6560 6020 616e 6420 6060 c3ac 6e73  lue`` and ``..ns
-0001ff20: 7461 6e63 652e 5f68 6967 685f 7661 6c75  tance._high_valu
-0001ff30: 6560 6020 6861 7665 2062 6565 6e20 636f  e`` have been co
-0001ff40: 6e76 6572 7465 640a 2020 2020 2020 2020  nverted.        
-0001ff50: 2020 2020 2020 746f 2060 6070 642e 6461        to ``pd.da
-0001ff60: 7465 7469 6d65 6060 0a20 2020 2020 2020  tetime``.       
-0001ff70: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
-0001ff80: 6574 7570 0a20 2020 2020 2020 2074 6162  etup.        tab
-0001ff90: 6c65 5f64 6174 6120 3d20 7064 2e44 6174  le_data = pd.Dat
-0001ffa0: 6146 7261 6d65 287b 0a20 2020 2020 2020  aFrame({.       
-0001ffb0: 2020 2020 2027 6368 6563 6b69 6e27 3a20       'checkin': 
-0001ffc0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0001ffd0: 2020 7064 2e74 6f5f 6461 7465 7469 6d65    pd.to_datetime
-0001ffe0: 2827 3230 3232 2d30 352d 3036 2729 2c0a  ('2022-05-06'),.
-0001fff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020000: 7064 2e74 6f5f 6461 7465 7469 6d65 2827  pd.to_datetime('
-00020010: 3230 3232 2d30 352d 3037 2729 2c0a 2020  2022-05-07'),.  
-00020020: 2020 2020 2020 2020 2020 2020 2020 7064                pd
-00020030: 2e74 6f5f 6461 7465 7469 6d65 2827 3230  .to_datetime('20
-00020040: 3232 2d30 352d 3038 2729 2c0a 2020 2020  22-05-08'),.    
-00020050: 2020 2020 2020 2020 2020 2020 7064 2e74              pd.t
-00020060: 6f5f 6461 7465 7469 6d65 2827 3230 3232  o_datetime('2022
-00020070: 2d30 352d 3039 2729 2c0a 2020 2020 2020  -05-09'),.      
-00020080: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-00020090: 7d29 0a20 2020 2020 2020 2069 6e73 7461  }).        insta
-000200a0: 6e63 6520 3d20 5363 616c 6172 5261 6e67  nce = ScalarRang
-000200b0: 6528 2763 6865 636b 696e 272c 2027 3230  e('checkin', '20
-000200c0: 3232 2d30 352d 3035 272c 2027 3230 3232  22-05-05', '2022
-000200d0: 2d30 362d 3031 2729 0a0a 2020 2020 2020  -06-01')..      
-000200e0: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
-000200f0: 696e 7374 616e 6365 2e5f 6669 7428 7461  instance._fit(ta
-00020100: 626c 655f 6461 7461 290a 0a20 2020 2020  ble_data)..     
-00020110: 2020 2023 2041 7373 6572 740a 2020 2020     # Assert.    
-00020120: 2020 2020 6173 7365 7274 2069 6e73 7461      assert insta
-00020130: 6e63 652e 5f69 735f 6461 7465 7469 6d65  nce._is_datetime
-00020140: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00020150: 696e 7374 616e 6365 2e5f 7472 616e 7366  instance._transf
-00020160: 6f72 6d65 645f 636f 6c75 6d6e 203d 3d20  ormed_column == 
-00020170: 2763 6865 636b 696e 2332 3032 322d 3035  'checkin#2022-05
-00020180: 2d30 3523 3230 3232 2d30 362d 3031 270a  -05#2022-06-01'.
-00020190: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-000201a0: 6e73 7461 6e63 652e 5f6c 6f77 5f76 616c  nstance._low_val
-000201b0: 7565 203d 3d20 7064 2e74 6f5f 6461 7465  ue == pd.to_date
-000201c0: 7469 6d65 2827 3230 3232 2d30 352d 3035  time('2022-05-05
-000201d0: 2729 0a20 2020 2020 2020 2061 7373 6572  ').        asser
-000201e0: 7420 696e 7374 616e 6365 2e5f 6869 6768  t instance._high
-000201f0: 5f76 616c 7565 203d 3d20 7064 2e74 6f5f  _value == pd.to_
-00020200: 6461 7465 7469 6d65 2827 3230 3232 2d30  datetime('2022-0
-00020210: 362d 3031 2729 0a0a 2020 2020 6465 6620  6-01')..    def 
-00020220: 7465 7374 5f69 735f 7661 6c69 645f 6c74  test_is_valid_lt
-00020230: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00020240: 2222 2254 6573 7420 7468 6520 6060 5363  """Test the ``Sc
-00020250: 616c 6172 5261 6e67 652e 6973 5f76 616c  alarRange.is_val
-00020260: 6964 6060 2e0a 0a20 2020 2020 2020 2054  id``...        T
-00020270: 6869 7320 7465 7374 2065 6e73 7572 6573  his test ensures
-00020280: 2074 6861 7420 7468 6520 6060 6973 5f76   that the ``is_v
-00020290: 616c 6964 6060 206d 6574 686f 6420 776f  alid`` method wo
-000202a0: 726b 7320 7769 7468 2074 6865 206f 7065  rks with the ope
-000202b0: 7261 746f 7220 6060 3c60 600a 2020 2020  rator ``<``.    
-000202c0: 2020 2020 2860 603c 6060 2920 616e 6420      (``<``) and 
-000202d0: 7661 6c69 6461 7465 7320 7468 6174 2074  validates that t
-000202e0: 6865 2060 6063 6f6c 756d 6e5f 6e61 6d65  he ``column_name
-000202f0: 6060 2069 7320 6265 7477 6565 6e20 6060  `` is between ``
-00020300: 6c6f 775f 7661 6c75 6560 6020 616e 640a  low_value`` and.
-00020310: 2020 2020 2020 2020 6060 6869 6768 5f76          ``high_v
-00020320: 616c 7565 6060 2e0a 0a20 2020 2020 2020  alue``...       
-00020330: 2053 6574 7570 3a0a 2020 2020 2020 2020   Setup:.        
-00020340: 2020 2020 2d20 4372 6561 7465 2061 2070      - Create a p
-00020350: 642e 4461 7461 4672 616d 652e 0a20 2020  d.DataFrame..   
-00020360: 2020 2020 2020 2020 202d 2049 6e73 7461           - Insta
-00020370: 6e63 6520 6f66 2060 6053 6361 6c61 7252  nce of ``ScalarR
-00020380: 616e 6765 6060 2063 6f6e 7374 7261 696e  ange`` constrain
-00020390: 7420 7769 7468 206c 6f77 2061 6e64 2068  t with low and h
-000203a0: 6967 6820 7661 6c75 6573 2074 6861 7420  igh values that 
-000203b0: 6172 6520 7769 7468 696e 2074 6865 0a20  are within the. 
-000203c0: 2020 2020 2020 2020 2020 2020 2065 7870               exp
-000203d0: 6563 7465 6420 7261 6e67 652e 0a0a 2020  ected range...  
-000203e0: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
-000203f0: 2020 2020 2020 2020 202d 2070 642e 4461           - pd.Da
-00020400: 7461 4672 616d 6520 7769 7468 2060 6063  taFrame with ``c
-00020410: 7572 7265 6e74 5f61 6765 6060 2063 6f6c  urrent_age`` col
-00020420: 756d 6e2e 0a20 2020 2020 2020 2022 2222  umn..        """
-00020430: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-00020440: 0a20 2020 2020 2020 2074 6162 6c65 5f64  .        table_d
-00020450: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
-00020460: 6d65 287b 2763 7572 7265 6e74 5f61 6765  me({'current_age
-00020470: 273a 205b 3231 2c20 3232 2c20 3235 5d7d  ': [21, 22, 25]}
-00020480: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
-00020490: 6365 203d 2053 6361 6c61 7252 616e 6765  ce = ScalarRange
-000204a0: 2827 6375 7272 656e 745f 6167 6527 2c20  ('current_age', 
-000204b0: 3230 2c20 3236 290a 0a20 2020 2020 2020  20, 26)..       
-000204c0: 2023 2052 756e 0a20 2020 2020 2020 2072   # Run.        r
-000204d0: 6573 756c 7420 3d20 696e 7374 616e 6365  esult = instance
-000204e0: 2e69 735f 7661 6c69 6428 7461 626c 655f  .is_valid(table_
-000204f0: 6461 7461 290a 0a20 2020 2020 2020 2023  data)..        #
-00020500: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-00020510: 6173 7365 7274 2061 6c6c 2872 6573 756c  assert all(resul
-00020520: 7429 0a0a 2020 2020 6465 6620 7465 7374  t)..    def test
-00020530: 5f69 735f 7661 6c69 645f 6c65 2873 656c  _is_valid_le(sel
-00020540: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
-00020550: 6573 7420 7468 6520 6060 5363 616c 6172  est the ``Scalar
-00020560: 5261 6e67 652e 6973 5f76 616c 6964 6060  Range.is_valid``
-00020570: 2e0a 0a20 2020 2020 2020 2054 6869 7320  ...        This 
-00020580: 7465 7374 2065 6e73 7572 6573 2074 6861  test ensures tha
-00020590: 7420 7468 6520 6060 6973 5f76 616c 6964  t the ``is_valid
-000205a0: 6060 206d 6574 686f 6420 776f 726b 7320  `` method works 
-000205b0: 7769 7468 2074 6865 206f 7065 7261 746f  with the operato
-000205c0: 720a 2020 2020 2020 2020 6060 3c3d 6060  r.        ``<=``
-000205d0: 2061 6e64 2076 616c 6964 6174 6573 2074   and validates t
-000205e0: 6861 7420 7468 6520 6060 636f 6c75 6d6e  hat the ``column
-000205f0: 5f6e 616d 6560 6020 6973 0a20 2020 2020  _name`` is.     
-00020600: 2020 2062 6574 7765 656e 2060 606c 6f77     between ``low
-00020610: 5f76 616c 7565 6060 2061 6e64 2060 6068  _value`` and ``h
-00020620: 6967 685f 7661 6c75 6560 602e 0a0a 2020  igh_value``...  
-00020630: 2020 2020 2020 5365 7475 703a 0a20 2020        Setup:.   
-00020640: 2020 2020 2020 2020 202d 2043 7265 6174           - Creat
-00020650: 6520 6120 7064 2e44 6174 6146 7261 6d65  e a pd.DataFrame
-00020660: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-00020670: 496e 7374 616e 6365 206f 6620 6060 5363  Instance of ``Sc
-00020680: 616c 6172 5261 6e67 6560 6020 636f 6e73  alarRange`` cons
-00020690: 7472 6169 6e74 2077 6974 6820 6c6f 7720  traint with low 
-000206a0: 616e 6420 6869 6768 2076 616c 7565 7320  and high values 
-000206b0: 7468 6174 2061 7265 2077 6974 6869 6e20  that are within 
-000206c0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-000206d0: 2020 6578 7065 6374 6564 2072 616e 6765    expected range
-000206e0: 2061 6e64 2075 7369 6e67 2060 6073 7472   and using ``str
-000206f0: 6963 745f 626f 756e 6461 7269 6573 6060  ict_boundaries``
-00020700: 2061 7320 6060 4661 6c73 6560 602e 0a0a   as ``False``...
-00020710: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
-00020720: 2020 2020 2020 2020 2020 202d 2070 642e             - pd.
-00020730: 4461 7461 4672 616d 6520 7769 7468 2060  DataFrame with `
-00020740: 6063 7572 7265 6e74 5f61 6765 6060 2063  `current_age`` c
-00020750: 6f6c 756d 6e2e 0a20 2020 2020 2020 2022  olumn..        "
-00020760: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
-00020770: 7570 0a20 2020 2020 2020 2074 6162 6c65  up.        table
-00020780: 5f64 6174 6120 3d20 7064 2e44 6174 6146  _data = pd.DataF
-00020790: 7261 6d65 287b 2763 7572 7265 6e74 5f61  rame({'current_a
-000207a0: 6765 273a 205b 3231 2c20 3232 2c20 3235  ge': [21, 22, 25
-000207b0: 5d7d 290a 2020 2020 2020 2020 696e 7374  ]}).        inst
-000207c0: 616e 6365 203d 2053 6361 6c61 7252 616e  ance = ScalarRan
-000207d0: 6765 2827 6375 7272 656e 745f 6167 6527  ge('current_age'
-000207e0: 2c20 3231 2c20 3235 2c20 7374 7269 6374  , 21, 25, strict
-000207f0: 5f62 6f75 6e64 6172 6965 733d 4661 6c73  _boundaries=Fals
-00020800: 6529 0a0a 2020 2020 2020 2020 2320 5275  e)..        # Ru
-00020810: 6e0a 2020 2020 2020 2020 7265 7375 6c74  n.        result
-00020820: 203d 2069 6e73 7461 6e63 652e 6973 5f76   = instance.is_v
-00020830: 616c 6964 2874 6162 6c65 5f64 6174 6129  alid(table_data)
-00020840: 0a0a 2020 2020 2020 2020 2320 4173 7365  ..        # Asse
-00020850: 7274 0a20 2020 2020 2020 2061 7373 6572  rt.        asser
-00020860: 7420 616c 6c28 7265 7375 6c74 290a 0a20  t all(result).. 
-00020870: 2020 2064 6566 2074 6573 745f 6973 5f76     def test_is_v
-00020880: 616c 6964 5f69 6e76 616c 6964 2873 656c  alid_invalid(sel
-00020890: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
-000208a0: 6573 7420 7468 6520 6060 5363 616c 6172  est the ``Scalar
-000208b0: 5261 6e67 652e 6973 5f76 616c 6964 6060  Range.is_valid``
-000208c0: 2e0a 0a20 2020 2020 2020 2054 6869 7320  ...        This 
-000208d0: 7465 7374 2065 6e73 7572 6573 2074 6861  test ensures tha
-000208e0: 7420 7468 6520 6060 6973 5f76 616c 6964  t the ``is_valid
-000208f0: 6060 2066 6169 6c73 2077 6865 6e20 7468  `` fails when th
-00020900: 6520 6461 7461 2069 7320 6e6f 7420 696e  e data is not in
-00020910: 2074 6865 2072 616e 6765 2e0a 0a20 2020   the range...   
-00020920: 2020 2020 2053 6574 7570 3a0a 2020 2020       Setup:.    
-00020930: 2020 2020 2020 2020 2d20 4372 6561 7465          - Create
-00020940: 2061 2070 642e 4461 7461 4672 616d 6520   a pd.DataFrame 
-00020950: 7769 7468 2060 6063 7572 7265 6e74 5f61  with ``current_a
-00020960: 6765 6060 2063 6f6c 756d 6e2e 0a20 2020  ge`` column..   
-00020970: 2020 2020 2020 2020 202d 2049 6e73 7461           - Insta
-00020980: 6e63 6520 6f66 2060 6053 6361 6c61 7252  nce of ``ScalarR
-00020990: 616e 6765 6060 2063 6f6e 7374 7261 696e  ange`` constrain
-000209a0: 7420 7769 7468 2060 606c 6f77 5f76 616c  t with ``low_val
-000209b0: 7565 6060 2068 6967 6865 7220 7468 616e  ue`` higher than
-000209c0: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-000209d0: 2020 206c 6f77 2076 616c 7565 2069 6e20     low value in 
-000209e0: 6060 6375 7272 656e 745f 6167 6560 6020  ``current_age`` 
-000209f0: 616e 6420 6869 6768 2076 616c 7565 206c  and high value l
-00020a00: 6f77 6572 2074 6861 6e20 7468 6520 6869  ower than the hi
-00020a10: 6768 6572 2076 616c 7565 2069 6e20 7468  gher value in th
-00020a20: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00020a30: 6060 6375 7272 656e 745f 6167 6560 602e  ``current_age``.
-00020a40: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
-00020a50: 0a20 2020 2020 2020 2020 2020 202d 2070  .            - p
-00020a60: 642e 4461 7461 4672 616d 6520 7769 7468  d.DataFrame with
-00020a70: 2060 6063 7572 7265 6e74 5f61 6765 6060   ``current_age``
-00020a80: 2063 6f6c 756d 6e2e 0a20 2020 2020 2020   column..       
-00020a90: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
-00020aa0: 6574 7570 0a20 2020 2020 2020 2074 6162  etup.        tab
-00020ab0: 6c65 5f64 6174 6120 3d20 7064 2e44 6174  le_data = pd.Dat
-00020ac0: 6146 7261 6d65 287b 2763 7572 7265 6e74  aFrame({'current
-00020ad0: 5f61 6765 273a 205b 3231 2c20 3232 2c20  _age': [21, 22, 
-00020ae0: 3235 5d7d 290a 2020 2020 2020 2020 696e  25]}).        in
-00020af0: 7374 616e 6365 203d 2053 6361 6c61 7252  stance = ScalarR
-00020b00: 616e 6765 2827 6375 7272 656e 745f 6167  ange('current_ag
-00020b10: 6527 2c20 3238 2c20 3138 2c20 7374 7269  e', 28, 18, stri
-00020b20: 6374 5f62 6f75 6e64 6172 6965 733d 4661  ct_boundaries=Fa
-00020b30: 6c73 6529 0a0a 2020 2020 2020 2020 2320  lse)..        # 
-00020b40: 5275 6e0a 2020 2020 2020 2020 7265 7375  Run.        resu
-00020b50: 6c74 203d 2069 6e73 7461 6e63 652e 6973  lt = instance.is
-00020b60: 5f76 616c 6964 2874 6162 6c65 5f64 6174  _valid(table_dat
-00020b70: 6129 0a0a 2020 2020 2020 2020 2320 4173  a)..        # As
-00020b80: 7365 7274 0a20 2020 2020 2020 2061 7373  sert.        ass
-00020b90: 6572 7420 6e6f 7420 616c 6c28 7265 7375  ert not all(resu
-00020ba0: 6c74 290a 0a20 2020 2040 7061 7463 6828  lt)..    @patch(
-00020bb0: 2773 6476 2e63 6f6e 7374 7261 696e 7473  'sdv.constraints
-00020bc0: 2e74 6162 756c 6172 2e6c 6f67 6974 2729  .tabular.logit')
-00020bd0: 0a20 2020 2064 6566 2074 6573 745f 5f74  .    def test__t
-00020be0: 7261 6e73 666f 726d 2873 656c 662c 206d  ransform(self, m
-00020bf0: 6f63 6b5f 6c6f 6769 7429 3a0a 2020 2020  ock_logit):.    
-00020c00: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
-00020c10: 6060 5363 616c 6172 5261 6e67 652e 5f74  ``ScalarRange._t
-00020c20: 7261 6e73 666f 726d 6060 206d 6574 686f  ransform`` metho
-00020c30: 642e 0a0a 2020 2020 2020 2020 4974 2069  d...        It i
-00020c40: 7320 6578 7065 6374 6564 2074 6f20 6372  s expected to cr
-00020c50: 6561 7465 2061 206e 6577 2063 6f6c 756d  eate a new colum
-00020c60: 6e20 7369 6d69 6c61 7220 746f 2074 6865  n similar to the
-00020c70: 2063 6f6e 7374 7261 696e 7420 6060 636f   constraint ``co
-00020c80: 6c75 6d6e 6060 2c20 616e 6420 7468 656e  lumn``, and then
-00020c90: 0a20 2020 2020 2020 2073 6361 6c65 2061  .        scale a
-00020ca0: 6e64 2061 7070 6c79 2061 206c 6f67 6974  nd apply a logit
-00020cb0: 2066 756e 6374 696f 6e20 746f 2074 6861   function to tha
-00020cc0: 7420 636f 6c75 6d6e 2e0a 0a20 2020 2020  t column...     
-00020cd0: 2020 204d 6f63 6b3a 0a20 2020 2020 2020     Mock:.       
-00020ce0: 2020 2020 202d 206d 6f63 6b20 7468 6520       - mock the 
-00020cf0: 6c6f 6769 7420 6675 6e63 7469 6f6e 2e0a  logit function..
-00020d00: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
-00020d10: 2020 2020 2020 2020 2020 202d 2070 642e             - pd.
-00020d20: 4461 7461 4672 616d 6520 7769 7468 2060  DataFrame with `
-00020d30: 6063 7572 7265 6e74 5f61 6765 6060 2063  `current_age`` c
-00020d40: 6f6c 756d 6e2e 0a0a 2020 2020 2020 2020  olumn...        
-00020d50: 4f75 7470 7574 3a0a 2020 2020 2020 2020  Output:.        
-00020d60: 2020 2020 2d20 7064 2e44 6174 6146 7261      - pd.DataFra
-00020d70: 6d65 2077 6974 6820 7468 6520 7472 616e  me with the tran
-00020d80: 7366 6f72 6d65 6420 6060 6375 7272 656e  sformed ``curren
-00020d90: 745f 6167 6560 602e 0a20 2020 2020 2020  t_age``..       
-00020da0: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
-00020db0: 6574 7570 0a20 2020 2020 2020 2074 6162  etup.        tab
-00020dc0: 6c65 5f64 6174 6120 3d20 7064 2e44 6174  le_data = pd.Dat
-00020dd0: 6146 7261 6d65 287b 2763 7572 7265 6e74  aFrame({'current
-00020de0: 5f61 6765 273a 205b 3231 2c20 3232 2c20  _age': [21, 22, 
-00020df0: 3235 5d7d 290a 2020 2020 2020 2020 696e  25]}).        in
-00020e00: 7374 616e 6365 203d 2053 6361 6c61 7252  stance = ScalarR
-00020e10: 616e 6765 2827 6375 7272 656e 745f 6167  ange('current_ag
-00020e20: 6527 2c20 3230 2c20 3238 290a 2020 2020  e', 20, 28).    
-00020e30: 2020 2020 6d6f 636b 5f6c 6f67 6974 2e72      mock_logit.r
-00020e40: 6574 7572 6e5f 7661 6c75 6520 3d20 5b31  eturn_value = [1
-00020e50: 2c20 322c 2033 5d0a 0a20 2020 2020 2020  , 2, 3]..       
-00020e60: 2023 2052 756e 0a20 2020 2020 2020 2069   # Run.        i
-00020e70: 6e73 7461 6e63 652e 6669 7428 7461 626c  nstance.fit(tabl
-00020e80: 655f 6461 7461 290a 2020 2020 2020 2020  e_data).        
-00020e90: 6f75 7420 3d20 696e 7374 616e 6365 2e5f  out = instance._
-00020ea0: 7472 616e 7366 6f72 6d28 7461 626c 655f  transform(table_
-00020eb0: 6461 7461 290a 0a20 2020 2020 2020 2023  data)..        #
-00020ec0: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-00020ed0: 6578 7065 6374 6564 5f6f 7574 203d 2070  expected_out = p
-00020ee0: 642e 4461 7461 4672 616d 6528 7b27 6375  d.DataFrame({'cu
-00020ef0: 7272 656e 745f 6167 6523 3230 2332 3827  rrent_age#20#28'
-00020f00: 3a20 5b31 2c20 322c 2033 5d7d 290a 2020  : [1, 2, 3]}).  
-00020f10: 2020 2020 2020 7064 2e74 6573 7469 6e67        pd.testing
-00020f20: 2e61 7373 6572 745f 6672 616d 655f 6571  .assert_frame_eq
-00020f30: 7561 6c28 6578 7065 6374 6564 5f6f 7574  ual(expected_out
-00020f40: 2c20 6f75 7429 0a0a 2020 2020 4070 6174  , out)..    @pat
-00020f50: 6368 2827 7364 762e 636f 6e73 7472 6169  ch('sdv.constrai
-00020f60: 6e74 732e 7461 6275 6c61 722e 7369 676d  nts.tabular.sigm
-00020f70: 6f69 6427 290a 2020 2020 6465 6620 7465  oid').    def te
-00020f80: 7374 5f72 6576 6572 7365 5f74 7261 6e73  st_reverse_trans
-00020f90: 666f 726d 2873 656c 662c 206d 6f63 6b5f  form(self, mock_
-00020fa0: 7369 676d 6f69 6429 3a0a 2020 2020 2020  sigmoid):.      
-00020fb0: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
-00020fc0: 7265 7665 7273 655f 7472 616e 7366 6f72  reverse_transfor
-00020fd0: 6d60 6020 6d65 7468 6f64 2066 6f72 2060  m`` method for `
-00020fe0: 6053 6361 6c61 7252 616e 6765 6060 2e0a  `ScalarRange``..
-00020ff0: 0a20 2020 2020 2020 2049 7420 6973 2065  .        It is e
-00021000: 7870 6563 7465 6420 746f 2072 6563 6f76  xpected to recov
-00021010: 6572 2074 6865 206f 7269 6769 6e61 6c20  er the original 
-00021020: 7461 626c 6520 7768 6963 6820 7761 7320  table which was 
-00021030: 7472 616e 7366 6f72 6d65 642c 2062 7574  transformed, but
-00021040: 2077 6974 6820 6469 6666 6572 656e 740a   with different.
-00021050: 2020 2020 2020 2020 636f 6c75 6d6e 206f          column o
-00021060: 7264 6572 2e20 4974 2064 6f65 7320 736f  rder. It does so
-00021070: 2062 7920 6170 706c 7969 6e67 2061 2073   by applying a s
-00021080: 6967 6d6f 6964 2074 6f20 7468 6520 7472  igmoid to the tr
-00021090: 616e 7366 6f72 6d65 6420 636f 6c75 6d6e  ansformed column
-000210a0: 2061 6e64 2074 6865 6e0a 2020 2020 2020   and then.      
-000210b0: 2020 7363 616c 696e 6720 6974 2062 6163    scaling it bac
-000210c0: 6b20 746f 2074 6865 206f 7269 6769 6e61  k to the origina
-000210d0: 6c20 7370 6163 652e 2049 7420 616c 736f  l space. It also
-000210e0: 2072 6570 6c61 6365 7320 7468 6520 7472   replaces the tr
-000210f0: 616e 7366 6f72 6d65 6420 636f 6c75 6d6e  ansformed column
-00021100: 2077 6974 680a 2020 2020 2020 2020 616e   with.        an
-00021110: 2065 7175 616c 2063 6f6c 756d 6e20 6275   equal column bu
-00021120: 7420 7769 7468 2074 6865 206f 7269 6769  t with the origi
-00021130: 6e61 6c20 6e61 6d65 2e0a 0a20 2020 2020  nal name...     
-00021140: 2020 204d 6f63 6b3a 0a20 2020 2020 2020     Mock:.       
-00021150: 2020 2020 202d 204d 6f63 6b20 7468 6520       - Mock the 
-00021160: 7369 676d 6f69 6420 6675 6e63 7469 6f6e  sigmoid function
-00021170: 2e0a 0a20 2020 2020 2020 2053 6574 7570  ...        Setup
-00021180: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
-00021190: 4f72 6967 696e 616c 2074 6162 6c65 2064  Original table d
-000211a0: 6174 612e 0a20 2020 2020 2020 2020 2020  ata..           
-000211b0: 202d 2041 6e20 6578 7065 6374 6564 2074   - An expected t
-000211c0: 7261 6e73 666f 726d 6564 2064 6174 612e  ransformed data.
-000211d0: 0a20 2020 2020 2020 2020 2020 202d 2049  .            - I
-000211e0: 6e73 7461 6e63 6520 6f66 2053 6361 6c61  nstance of Scala
-000211f0: 7252 616e 6765 2063 6f6e 7374 7261 696e  rRange constrain
-00021200: 742e 0a0a 2020 2020 2020 2020 4f75 7470  t...        Outp
-00021210: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
-00021220: 2d20 4120 7064 2e44 6174 6146 7261 6d65  - A pd.DataFrame
-00021230: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-00021240: 6f72 6967 696e 616c 2064 6174 612e 0a20  original data.. 
-00021250: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00021260: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
-00021270: 2020 2074 6162 6c65 5f64 6174 6120 3d20     table_data = 
-00021280: 7064 2e44 6174 6146 7261 6d65 287b 2763  pd.DataFrame({'c
-00021290: 7572 7265 6e74 5f61 6765 273a 205b 3231  urrent_age': [21
-000212a0: 2c20 3232 2c20 3235 5d7d 290a 2020 2020  , 22, 25]}).    
-000212b0: 2020 2020 7472 616e 7366 6f72 6d65 645f      transformed_
-000212c0: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
-000212d0: 616d 6528 7b27 6375 7272 656e 745f 6167  ame({'current_ag
-000212e0: 6523 3230 2332 3827 3a20 5b31 2c20 322c  e#20#28': [1, 2,
-000212f0: 2033 5d7d 290a 2020 2020 2020 2020 6d6f   3]}).        mo
-00021300: 636b 5f73 6967 6d6f 6964 2e72 6574 7572  ck_sigmoid.retur
-00021310: 6e5f 7661 6c75 6520 3d20 7064 2e53 6572  n_value = pd.Ser
-00021320: 6965 7328 5b32 312c 2032 322c 2032 355d  ies([21, 22, 25]
-00021330: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
-00021340: 6365 203d 2053 6361 6c61 7252 616e 6765  ce = ScalarRange
-00021350: 2827 6375 7272 656e 745f 6167 6527 2c20  ('current_age', 
-00021360: 3230 2c20 3238 290a 0a20 2020 2020 2020  20, 28)..       
-00021370: 2023 2052 756e 0a20 2020 2020 2020 2069   # Run.        i
-00021380: 6e73 7461 6e63 652e 6669 7428 7461 626c  nstance.fit(tabl
-00021390: 655f 6461 7461 290a 2020 2020 2020 2020  e_data).        
-000213a0: 6f75 7420 3d20 696e 7374 616e 6365 2e72  out = instance.r
-000213b0: 6576 6572 7365 5f74 7261 6e73 666f 726d  everse_transform
-000213c0: 2874 7261 6e73 666f 726d 6564 5f64 6174  (transformed_dat
-000213d0: 6129 0a0a 2020 2020 2020 2020 2320 4173  a)..        # As
-000213e0: 7365 7274 0a20 2020 2020 2020 2070 642e  sert.        pd.
-000213f0: 7465 7374 696e 672e 6173 7365 7274 5f66  testing.assert_f
-00021400: 7261 6d65 5f65 7175 616c 2874 6162 6c65  rame_equal(table
-00021410: 5f64 6174 612c 206f 7574 290a 2020 2020  _data, out).    
-00021420: 2020 2020 6d6f 636b 5f73 6967 6d6f 6964      mock_sigmoid
-00021430: 2e61 7373 6572 745f 6361 6c6c 6564 5f6f  .assert_called_o
-00021440: 6e63 6528 290a 0a20 2020 2040 7061 7463  nce()..    @patc
-00021450: 6828 2773 6476 2e63 6f6e 7374 7261 696e  h('sdv.constrain
-00021460: 7473 2e74 6162 756c 6172 2e70 6427 290a  ts.tabular.pd').
-00021470: 2020 2020 4070 6174 6368 2827 7364 762e      @patch('sdv.
-00021480: 636f 6e73 7472 6169 6e74 732e 7461 6275  constraints.tabu
-00021490: 6c61 722e 7369 676d 6f69 6427 290a 2020  lar.sigmoid').  
-000214a0: 2020 6465 6620 7465 7374 5f72 6576 6572    def test_rever
-000214b0: 7365 5f74 7261 6e73 666f 726d 5f69 735f  se_transform_is_
-000214c0: 6461 7465 7469 6d65 2873 656c 662c 206d  datetime(self, m
-000214d0: 6f63 6b5f 7369 676d 6f69 642c 206d 6f63  ock_sigmoid, moc
-000214e0: 6b5f 7064 293a 0a20 2020 2020 2020 2022  k_pd):.        "
-000214f0: 2222 5465 7374 2074 6865 2060 6072 6576  ""Test the ``rev
-00021500: 6572 7365 5f74 7261 6e73 666f 726d 6060  erse_transform``
-00021510: 206d 6574 686f 6420 666f 7220 6060 5363   method for ``Sc
-00021520: 616c 6172 5261 6e67 6560 602e 0a0a 2020  alarRange``...  
-00021530: 2020 2020 2020 5768 656e 2060 6069 6e73        When ``ins
-00021540: 7461 6e63 652e 5f69 735f 6461 7465 7469  tance._is_dateti
-00021550: 6d65 6060 2069 7320 6060 5472 7565 6060  me`` is ``True``
-00021560: 2c20 7468 6520 6461 7461 2073 686f 756c  , the data shoul
-00021570: 6420 6265 2063 6f6e 7665 7274 6564 0a20  d be converted. 
-00021580: 2020 2020 2020 2074 6f20 6060 7061 6e64         to ``pand
-00021590: 6173 2e74 6f5f 6461 7465 7469 6d65 6060  as.to_datetime``
-000215a0: 2e0a 0a20 2020 2020 2020 204d 6f63 6b3a  ...        Mock:
-000215b0: 0a20 2020 2020 2020 2020 2020 202d 204d  .            - M
-000215c0: 6f63 6b20 7468 6520 7369 676d 6f69 6420  ock the sigmoid 
-000215d0: 6675 6e63 7469 6f6e 2e0a 2020 2020 2020  function..      
-000215e0: 2020 2020 2020 2d20 4d6f 636b 2070 616e        - Mock pan
-000215f0: 6461 732e 0a0a 2020 2020 2020 2020 5365  das...        Se
-00021600: 7475 703a 0a20 2020 2020 2020 2020 2020  tup:.           
-00021610: 202d 204f 7269 6769 6e61 6c20 7461 626c   - Original tabl
-00021620: 6520 6461 7461 2e0a 2020 2020 2020 2020  e data..        
-00021630: 2020 2020 2d20 416e 2065 7870 6563 7465      - An expecte
-00021640: 6420 7472 616e 7366 6f72 6d65 6420 6461  d transformed da
-00021650: 7461 2e0a 2020 2020 2020 2020 2020 2020  ta..            
-00021660: 2d20 496e 7374 616e 6365 206f 6620 5363  - Instance of Sc
-00021670: 616c 6172 5261 6e67 6520 636f 6e73 7472  alarRange constr
-00021680: 6169 6e74 2e0a 0a20 2020 2020 2020 204f  aint...        O
-00021690: 7574 7075 743a 0a20 2020 2020 2020 2020  utput:.         
-000216a0: 2020 202d 2041 2070 642e 4461 7461 4672     - A pd.DataFr
-000216b0: 616d 6520 636f 6e74 6169 6e69 6e67 2074  ame containing t
-000216c0: 6865 206f 7269 6769 6e61 6c20 6461 7461  he original data
-000216d0: 2e0a 0a20 2020 2020 2020 2053 6964 6520  ...        Side 
-000216e0: 4566 6665 6374 733a 0a20 2020 2020 2020  Effects:.       
-000216f0: 2020 2020 202d 2060 606d 6f63 6b5f 7064       - ``mock_pd
-00021700: 6060 2068 6173 2074 6f20 6265 2063 616c  `` has to be cal
-00021710: 6c65 6420 6f6e 6365 2e0a 2020 2020 2020  led once..      
-00021720: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
-00021730: 5365 7475 700a 2020 2020 2020 2020 7472  Setup.        tr
-00021740: 616e 7366 6f72 6d65 645f 6461 7461 203d  ansformed_data =
-00021750: 2070 642e 4461 7461 4672 616d 6528 7b27   pd.DataFrame({'
-00021760: 6375 7272 656e 745f 6167 6523 3230 2332  current_age#20#2
-00021770: 3827 3a20 5b31 2c20 322c 2033 5d7d 290a  8': [1, 2, 3]}).
-00021780: 2020 2020 2020 2020 6d6f 636b 5f73 6967          mock_sig
-00021790: 6d6f 6964 2e72 6574 7572 6e5f 7661 6c75  moid.return_valu
-000217a0: 6520 3d20 7064 2e53 6572 6965 7328 5b32  e = pd.Series([2
-000217b0: 312c 2032 322c 2032 355d 290a 2020 2020  1, 22, 25]).    
-000217c0: 2020 2020 696e 7374 616e 6365 203d 2053      instance = S
-000217d0: 6361 6c61 7252 616e 6765 2827 6375 7272  calarRange('curr
-000217e0: 656e 745f 6167 6527 2c20 3230 2c20 3238  ent_age', 20, 28
-000217f0: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
-00021800: 6365 2e5f 7472 616e 7366 6f72 6d65 645f  ce._transformed_
-00021810: 636f 6c75 6d6e 203d 2027 6375 7272 656e  column = 'curren
-00021820: 745f 6167 6523 3230 2332 3827 0a20 2020  t_age#20#28'.   
-00021830: 2020 2020 2069 6e73 7461 6e63 652e 5f69       instance._i
-00021840: 735f 6461 7465 7469 6d65 203d 2054 7275  s_datetime = Tru
-00021850: 650a 2020 2020 2020 2020 6d6f 636b 5f70  e.        mock_p
-00021860: 642e 746f 5f64 6174 6574 696d 652e 7369  d.to_datetime.si
-00021870: 6465 5f65 6666 6563 7420 3d20 6c61 6d62  de_effect = lamb
-00021880: 6461 2078 3a20 7064 2e74 6f5f 6461 7465  da x: pd.to_date
-00021890: 7469 6d65 2827 3230 3231 2d30 322d 3032  time('2021-02-02
-000218a0: 2031 303a 3130 3a35 3927 290a 0a20 2020   10:10:59')..   
-000218b0: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
-000218c0: 2020 206f 7574 7075 7420 3d20 696e 7374     output = inst
-000218d0: 616e 6365 2e72 6576 6572 7365 5f74 7261  ance.reverse_tra
-000218e0: 6e73 666f 726d 2874 7261 6e73 666f 726d  nsform(transform
-000218f0: 6564 5f64 6174 6129 0a0a 2020 2020 2020  ed_data)..      
-00021900: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
-00021910: 2020 2065 7870 6563 7465 645f 6f75 7470     expected_outp
-00021920: 7574 203d 2070 642e 4461 7461 4672 616d  ut = pd.DataFram
-00021930: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
-00021940: 2763 7572 7265 6e74 5f61 6765 273a 205b  'current_age': [
-00021950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021960: 2070 642e 746f 5f64 6174 6574 696d 6528   pd.to_datetime(
-00021970: 2732 3032 312d 3032 2d30 3220 3130 3a31  '2021-02-02 10:1
-00021980: 303a 3539 2729 2c0a 2020 2020 2020 2020  0:59'),.        
-00021990: 2020 2020 2020 2020 7064 2e74 6f5f 6461          pd.to_da
-000219a0: 7465 7469 6d65 2827 3230 3231 2d30 322d  tetime('2021-02-
-000219b0: 3032 2031 303a 3130 3a35 3927 292c 0a20  02 10:10:59'),. 
-000219c0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000219d0: 642e 746f 5f64 6174 6574 696d 6528 2732  d.to_datetime('2
-000219e0: 3032 312d 3032 2d30 3220 3130 3a31 303a  021-02-02 10:10:
-000219f0: 3539 2729 2c0a 2020 2020 2020 2020 2020  59'),.          
-00021a00: 2020 5d0a 2020 2020 2020 2020 7d29 0a20    ].        }). 
-00021a10: 2020 2020 2020 2070 642e 7465 7374 696e         pd.testin
-00021a20: 672e 6173 7365 7274 5f66 7261 6d65 5f65  g.assert_frame_e
-00021a30: 7175 616c 2865 7870 6563 7465 645f 6f75  qual(expected_ou
-00021a40: 7470 7574 2c20 6f75 7470 7574 290a 2020  tput, output).  
-00021a50: 2020 2020 2020 6d6f 636b 5f73 6967 6d6f        mock_sigmo
-00021a60: 6964 2e61 7373 6572 745f 6361 6c6c 6564  id.assert_called
-00021a70: 5f6f 6e63 6528 290a 2020 2020 2020 2020  _once().        
-00021a80: 6173 7365 7274 206d 6f63 6b5f 7064 2e74  assert mock_pd.t
-00021a90: 6f5f 6461 7465 7469 6d65 2e63 616c 6c5f  o_datetime.call_
-00021aa0: 636f 756e 7420 3d3d 2031 0a0a 0a63 6c61  count == 1...cla
-00021ab0: 7373 2054 6573 744f 6e65 486f 7445 6e63  ss TestOneHotEnc
-00021ac0: 6f64 696e 6728 293a 0a0a 2020 2020 6465  oding():..    de
-00021ad0: 6620 7465 7374 5f5f 7661 6c69 6461 7465  f test__validate
-00021ae0: 5f69 6e70 7574 7328 7365 6c66 293a 0a20  _inputs(self):. 
-00021af0: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
-00021b00: 6865 2060 604f 6e65 486f 7445 6e63 6f64  he ``OneHotEncod
-00021b10: 696e 672e 5f76 616c 6964 6174 655f 696e  ing._validate_in
-00021b20: 7075 7473 6060 206d 6574 686f 642e 0a0a  puts`` method...
-00021b30: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
-00021b40: 2020 2020 2020 202d 2020 496e 636f 7272         -  Incorr
-00021b50: 6563 7420 7061 7261 6d65 7465 7273 2066  ect parameters f
-00021b60: 6f72 2074 6865 206d 6574 686f 640a 2020  or the method.  
-00021b70: 2020 2020 2020 5261 6973 6573 3a0a 2020        Raises:.  
-00021b80: 2020 2020 2020 2d20 4c69 7374 206f 6620        - List of 
-00021b90: 5661 6c75 6545 7272 6f72 730a 2020 2020  ValueErrors.    
-00021ba0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00021bb0: 2320 5275 6e20 2f20 4173 7365 7274 0a20  # Run / Assert. 
-00021bc0: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
-00021bd0: 7374 2e72 6169 7365 7328 4167 6772 6567  st.raises(Aggreg
-00021be0: 6174 6543 6f6e 7374 7261 696e 7473 4572  ateConstraintsEr
-00021bf0: 726f 7229 2061 7320 6572 726f 723a 0a20  ror) as error:. 
-00021c00: 2020 2020 2020 2020 2020 204f 6e65 486f             OneHo
-00021c10: 7445 6e63 6f64 696e 672e 5f76 616c 6964  tEncoding._valid
-00021c20: 6174 655f 696e 7075 7473 286e 6f74 5f63  ate_inputs(not_c
-00021c30: 6f6c 756d 6e5f 6e61 6d65 733d 4e6f 6e65  olumn_names=None
-00021c40: 2c20 736f 6d65 7468 696e 675f 656c 7365  , something_else
-00021c50: 3d4e 6f6e 6529 0a0a 2020 2020 2020 2020  =None)..        
-00021c60: 6572 725f 6d73 6720 3d20 280a 2020 2020  err_msg = (.    
-00021c70: 2020 2020 2020 2020 7227 4d69 7373 696e          r'Missin
-00021c80: 6720 7265 7175 6972 6564 2076 616c 7565  g required value
-00021c90: 7320 7b28 2e2a 297d 2069 6e20 6120 4f6e  s {(.*)} in a On
-00021ca0: 6548 6f74 456e 636f 6469 6e67 2063 6f6e  eHotEncoding con
-00021cb0: 7374 7261 696e 742e 270a 2020 2020 2020  straint.'.      
-00021cc0: 2020 2020 2020 7227 5c6e 5c6e 496e 7661        r'\n\nInva
-00021cd0: 6c69 6420 7661 6c75 6573 207b 282e 2a29  lid values {(.*)
-00021ce0: 7d20 6172 6520 7072 6573 656e 7420 696e  } are present in
-00021cf0: 2061 204f 6e65 486f 7445 6e63 6f64 696e   a OneHotEncodin
-00021d00: 6720 636f 6e73 7472 6169 6e74 2e27 0a20  g constraint.'. 
-00021d10: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00021d20: 2067 726f 7570 7320 3d20 7265 2e73 6561   groups = re.sea
-00021d30: 7263 6828 6572 725f 6d73 672c 2073 7472  rch(err_msg, str
-00021d40: 2865 7272 6f72 2e76 616c 7565 2929 0a20  (error.value)). 
-00021d50: 2020 2020 2020 2061 7373 6572 7420 6772         assert gr
-00021d60: 6f75 7073 2069 7320 6e6f 7420 4e6f 6e65  oups is not None
-00021d70: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
-00021d80: 7374 7228 6576 616c 2867 726f 7570 732e  str(eval(groups.
-00021d90: 6772 6f75 7028 3129 2929 203d 3d20 2763  group(1))) == 'c
-00021da0: 6f6c 756d 6e5f 6e61 6d65 7327 0a20 2020  olumn_names'.   
-00021db0: 2020 2020 2061 7373 6572 7420 7365 7428       assert set(
-00021dc0: 6576 616c 2867 726f 7570 732e 6772 6f75  eval(groups.grou
-00021dd0: 7028 3229 2929 203d 3d20 7b27 6e6f 745f  p(2))) == {'not_
-00021de0: 636f 6c75 6d6e 5f6e 616d 6573 272c 2027  column_names', '
-00021df0: 736f 6d65 7468 696e 675f 656c 7365 277d  something_else'}
-00021e00: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
-00021e10: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-00021e20: 615f 636f 6c75 6d6e 7328 7365 6c66 293a  a_columns(self):
-00021e30: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-00021e40: 2074 6865 2060 605f 7661 6c69 6461 7465   the ``_validate
-00021e50: 5f6d 6574 6164 6174 615f 636f 6c75 6d6e  _metadata_column
-00021e60: 7360 6020 6d65 7468 6f64 2e0a 0a20 2020  s`` method...   
-00021e70: 2020 2020 2041 6c6c 206f 6620 7468 6520       All of the 
-00021e80: 636f 6c75 6d6e 7320 7061 7373 6564 2069  columns passed i
-00021e90: 6e20 636f 6c75 6d6e 5f6e 616d 6573 2073  n column_names s
-00021ea0: 686f 756c 6420 6265 2069 6e20 7468 6520  hould be in the 
-00021eb0: 6d65 7461 6461 7461 2e0a 0a20 2020 2020  metadata...     
-00021ec0: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
-00021ed0: 2020 2020 2020 2d20 636f 6c75 6d6e 5f6e        - column_n
-00021ee0: 616d 6573 2077 6974 6820 636f 6c75 6d6e  ames with column
-00021ef0: 7320 7468 6174 2061 7265 2061 6c6c 2069  s that are all i
-00021f00: 6e20 7468 6520 6d65 7461 6461 7461 2e0a  n the metadata..
-00021f10: 0a20 2020 2020 2020 2053 6964 6520 6566  .        Side ef
-00021f20: 6665 6374 3a0a 2020 2020 2020 2020 2020  fect:.          
-00021f30: 2020 2d20 4e6f 2065 7272 6f72 2073 686f    - No error sho
-00021f40: 756c 6420 6265 2072 6169 7365 642e 0a20  uld be raised.. 
-00021f50: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00021f60: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
-00021f70: 2020 206d 6574 6164 6174 6120 3d20 4d6f     metadata = Mo
-00021f80: 636b 2829 0a20 2020 2020 2020 206d 6574  ck().        met
-00021f90: 6164 6174 612e 636f 6c75 6d6e 7320 3d20  adata.columns = 
-00021fa0: 7b27 6127 3a20 312c 2027 6227 3a20 327d  {'a': 1, 'b': 2}
-00021fb0: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
-00021fc0: 2020 2020 2020 2020 4f6e 6548 6f74 456e          OneHotEn
-00021fd0: 636f 6469 6e67 2e5f 7661 6c69 6461 7465  coding._validate
-00021fe0: 5f6d 6574 6164 6174 615f 636f 6c75 6d6e  _metadata_column
-00021ff0: 7328 6d65 7461 6461 7461 2c20 636f 6c75  s(metadata, colu
-00022000: 6d6e 5f6e 616d 6573 3d5b 2761 272c 2027  mn_names=['a', '
-00022010: 6227 5d29 0a0a 2020 2020 6465 6620 7465  b'])..    def te
-00022020: 7374 5f5f 7661 6c69 6461 7465 5f6d 6574  st__validate_met
-00022030: 6164 6174 615f 636f 6c75 6d6e 735f 7261  adata_columns_ra
-00022040: 6973 6573 5f65 7272 6f72 2873 656c 6629  ises_error(self)
-00022050: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
-00022060: 7420 7468 6520 6060 5f76 616c 6964 6174  t the ``_validat
-00022070: 655f 6d65 7461 6461 7461 5f63 6f6c 756d  e_metadata_colum
-00022080: 6e73 6060 206d 6574 686f 6427 7320 6572  ns`` method's er
-00022090: 726f 7220 636f 6e64 6974 696f 6e2e 0a0a  ror condition...
-000220a0: 2020 2020 2020 2020 4966 2061 6e79 2063          If any c
-000220b0: 6f6c 756d 6e73 2069 6e20 636f 6c75 6d6e  olumns in column
-000220c0: 5f6e 616d 6573 2061 7265 206e 6f74 2069  _names are not i
-000220d0: 6e20 7468 6520 6d65 7461 6461 7461 2c20  n the metadata, 
-000220e0: 616e 2065 7272 6f72 2073 686f 756c 6420  an error should 
-000220f0: 6265 2072 6169 7365 642e 0a0a 2020 2020  be raised...    
-00022100: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
-00022110: 2020 2020 2020 202d 2063 6f6c 756d 6e5f         - column_
-00022120: 6e61 6d65 7320 7468 6174 2063 6f6e 7461  names that conta
-00022130: 696e 7320 6120 636f 6c75 6d6e 206e 6f74  ins a column not
-00022140: 2069 6e20 7468 6520 6d65 7461 6461 7461   in the metadata
-00022150: 2e0a 0a20 2020 2020 2020 2053 6964 6520  ...        Side 
-00022160: 6566 6665 6374 3a0a 2020 2020 2020 2020  effect:.        
-00022170: 2020 2020 2d20 436f 6e73 7472 6169 6e74      - Constraint
-00022180: 4d65 7461 6461 7461 4572 726f 7220 7368  MetadataError sh
-00022190: 6f75 6c64 2062 6520 7261 6973 6564 2e0a  ould be raised..
-000221a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000221b0: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
-000221c0: 2020 2020 6d65 7461 6461 7461 203d 204d      metadata = M
-000221d0: 6f63 6b28 290a 2020 2020 2020 2020 6d65  ock().        me
-000221e0: 7461 6461 7461 2e63 6f6c 756d 6e73 203d  tadata.columns =
-000221f0: 207b 2761 273a 2031 2c20 2762 273a 2032   {'a': 1, 'b': 2
-00022200: 7d0a 0a20 2020 2020 2020 2023 2052 756e  }..        # Run
-00022210: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-00022220: 6573 7361 6765 203d 2072 652e 6573 6361  essage = re.esca
-00022230: 7065 280a 2020 2020 2020 2020 2020 2020  pe(.            
-00022240: 2741 204f 6e65 486f 7445 6e63 6f64 696e  'A OneHotEncodin
-00022250: 6720 636f 6e73 7472 6169 6e74 2069 7320  g constraint is 
-00022260: 6265 696e 6720 6170 706c 6965 6420 746f  being applied to
-00022270: 2069 6e76 616c 6964 2063 6f6c 756d 6e20   invalid column 
-00022280: 6e61 6d65 7320 270a 2020 2020 2020 2020  names '.        
-00022290: 2020 2020 227b 2763 277d 2e20 5468 6520      "{'c'}. The 
-000222a0: 636f 6c75 6d6e 7320 6d75 7374 2065 7869  columns must exi
-000222b0: 7374 2069 6e20 7468 6520 7461 626c 652e  st in the table.
-000222c0: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
-000222d0: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
-000222e0: 7261 6973 6573 2843 6f6e 7374 7261 696e  raises(Constrain
-000222f0: 744d 6574 6164 6174 6145 7272 6f72 2c20  tMetadataError, 
-00022300: 6d61 7463 683d 6572 726f 725f 6d65 7373  match=error_mess
-00022310: 6167 6529 3a0a 2020 2020 2020 2020 2020  age):.          
-00022320: 2020 4f6e 6548 6f74 456e 636f 6469 6e67    OneHotEncoding
-00022330: 2e5f 7661 6c69 6461 7465 5f6d 6574 6164  ._validate_metad
-00022340: 6174 615f 636f 6c75 6d6e 7328 6d65 7461  ata_columns(meta
-00022350: 6461 7461 2c20 636f 6c75 6d6e 5f6e 616d  data, column_nam
-00022360: 6573 3d5b 2761 272c 2027 6327 5d29 0a0a  es=['a', 'c'])..
-00022370: 2020 2020 6465 6620 7465 7374 5f72 6576      def test_rev
-00022380: 6572 7365 5f74 7261 6e73 666f 726d 2873  erse_transform(s
-00022390: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-000223a0: 2254 6573 7420 7468 6520 6060 4f6e 6548  "Test the ``OneH
-000223b0: 6f74 456e 636f 6469 6e67 2e72 6576 6572  otEncoding.rever
-000223c0: 7365 5f74 7261 6e73 666f 726d 6060 206d  se_transform`` m
-000223d0: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
-000223e0: 4974 2069 7320 6578 7065 6374 6564 2074  It is expected t
-000223f0: 6f2c 2066 6f72 2065 6163 6820 6f66 2074  o, for each of t
-00022400: 6865 2061 7070 726f 7072 6961 7465 2072  he appropriate r
-00022410: 6f77 732c 2073 6574 2074 6865 2063 6f6c  ows, set the col
-00022420: 756d 6e0a 2020 2020 2020 2020 7769 7468  umn.        with
-00022430: 2074 6865 206c 6172 6765 7374 2076 616c   the largest val
-00022440: 7565 2074 6f20 6f6e 6520 616e 6420 7365  ue to one and se
-00022450: 7420 616c 6c20 6f74 6865 7220 636f 6c75  t all other colu
-00022460: 6d6e 7320 746f 207a 6572 6f2e 0a0a 2020  mns to zero...  
-00022470: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
-00022480: 2020 2020 202d 2054 6162 6c65 2064 6174       - Table dat
-00022490: 6120 7769 7468 2061 6e79 206e 756d 6265  a with any numbe
-000224a0: 7273 2028 7061 6e64 6173 2e44 6174 6146  rs (pandas.DataF
-000224b0: 7261 6d65 290a 2020 2020 2020 2020 4f75  rame).        Ou
-000224c0: 7470 7574 3a0a 2020 2020 2020 2020 2d20  tput:.        - 
-000224d0: 5461 626c 6520 6461 7461 2077 6865 7265  Table data where
-000224e0: 2074 6865 2061 7070 726f 7072 6961 7465   the appropriate
-000224f0: 2072 6f77 7320 6172 6520 6f6e 6520 686f   rows are one ho
-00022500: 7420 2870 616e 6461 732e 4461 7461 4672  t (pandas.DataFr
-00022510: 616d 6529 0a20 2020 2020 2020 2022 2222  ame).        """
-00022520: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-00022530: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-00022540: 6520 3d20 4f6e 6548 6f74 456e 636f 6469  e = OneHotEncodi
-00022550: 6e67 2863 6f6c 756d 6e5f 6e61 6d65 733d  ng(column_names=
-00022560: 5b27 6127 2c20 2762 275d 290a 0a20 2020  ['a', 'b'])..   
-00022570: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
-00022580: 2020 2074 6162 6c65 5f64 6174 6120 3d20     table_data = 
-00022590: 7064 2e44 6174 6146 7261 6d65 287b 0a20  pd.DataFrame({. 
-000225a0: 2020 2020 2020 2020 2020 2027 6127 3a20             'a': 
-000225b0: 5b30 2e31 2c20 302e 352c 2030 2e38 5d2c  [0.1, 0.5, 0.8],
-000225c0: 0a20 2020 2020 2020 2020 2020 2027 6227  .            'b'
-000225d0: 3a20 5b30 2e38 2c20 302e 312c 2030 2e39  : [0.8, 0.1, 0.9
-000225e0: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
-000225f0: 6327 3a20 5b31 2c20 322c 2033 5d0a 2020  c': [1, 2, 3].  
-00022600: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
-00022610: 206f 7574 203d 2069 6e73 7461 6e63 652e   out = instance.
-00022620: 7265 7665 7273 655f 7472 616e 7366 6f72  reverse_transfor
-00022630: 6d28 7461 626c 655f 6461 7461 290a 0a20  m(table_data).. 
-00022640: 2020 2020 2020 2023 2041 7373 6572 740a         # Assert.
-00022650: 2020 2020 2020 2020 6578 7065 6374 6564          expected
-00022660: 5f6f 7574 203d 2070 642e 4461 7461 4672  _out = pd.DataFr
-00022670: 616d 6528 7b0a 2020 2020 2020 2020 2020  ame({.          
-00022680: 2020 2761 273a 205b 302e 302c 2031 2e30    'a': [0.0, 1.0
-00022690: 2c20 302e 305d 2c0a 2020 2020 2020 2020  , 0.0],.        
-000226a0: 2020 2020 2762 273a 205b 312e 302c 2030      'b': [1.0, 0
-000226b0: 2e30 2c20 312e 305d 2c0a 2020 2020 2020  .0, 1.0],.      
-000226c0: 2020 2020 2020 2763 273a 205b 312c 2032        'c': [1, 2
-000226d0: 2c20 335d 0a20 2020 2020 2020 207d 290a  , 3].        }).
-000226e0: 2020 2020 2020 2020 7064 2e74 6573 7469          pd.testi
-000226f0: 6e67 2e61 7373 6572 745f 6672 616d 655f  ng.assert_frame_
-00022700: 6571 7561 6c28 6578 7065 6374 6564 5f6f  equal(expected_o
-00022710: 7574 2c20 6f75 7429 0a0a 2020 2020 6465  ut, out)..    de
-00022720: 6620 7465 7374 5f69 735f 7661 6c69 6428  f test_is_valid(
-00022730: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00022740: 2222 5465 7374 2074 6865 2060 604f 6e65  ""Test the ``One
-00022750: 486f 7445 6e63 6f64 696e 672e 6973 5f76  HotEncoding.is_v
-00022760: 616c 6964 6060 206d 6574 686f 642e 0a0a  alid`` method...
-00022770: 2020 2020 2020 2020 6060 5472 7565 6060          ``True``
-00022780: 2077 6865 6e20 666f 7220 7468 6520 726f   when for the ro
-00022790: 7773 2077 6865 7265 2074 6865 2064 6174  ws where the dat
-000227a0: 6120 6973 206f 6e65 2068 6f74 2c20 6060  a is one hot, ``
-000227b0: 4661 6c73 6560 6020 6f74 6865 7277 6973  False`` otherwis
-000227c0: 652e 0a0a 2020 2020 2020 2020 496e 7075  e...        Inpu
-000227d0: 743a 0a20 2020 2020 2020 202d 2054 6162  t:.        - Tab
-000227e0: 6c65 2064 6174 6120 2870 616e 6461 732e  le data (pandas.
-000227f0: 4461 7461 4672 616d 6529 2063 6f6e 7461  DataFrame) conta
-00022800: 696e 696e 6720 6f6e 6520 7661 6c69 6420  ining one valid 
-00022810: 636f 6c75 6d6e 2c20 6f6e 6520 636f 6c75  column, one colu
-00022820: 6d6e 2077 6974 6820 6120 7375 6d20 6c65  mn with a sum le
-00022830: 7373 0a20 2020 2020 2020 2074 6861 6e20  ss.        than 
-00022840: 312c 206f 6e65 2063 6f6c 756d 6e20 7769  1, one column wi
-00022850: 7468 2061 2073 756d 2067 7265 6174 6572  th a sum greater
-00022860: 2074 6861 6e20 312c 206f 6e65 2063 6f6c   than 1, one col
-00022870: 756d 6e20 7769 7468 2068 616c 7665 7320  umn with halves 
-00022880: 6164 6469 6e67 2074 6f20 6f6e 6520 616e  adding to one an
-00022890: 6420 6f6e 650a 2020 2020 2020 2020 636f  d one.        co
-000228a0: 6c75 6d6e 2077 6974 6820 6e61 6e73 2e0a  lumn with nans..
-000228b0: 2020 2020 2020 2020 4f75 7470 7574 3a0a          Output:.
-000228c0: 2020 2020 2020 2020 2d20 5365 7269 6573          - Series
-000228d0: 206f 6620 6060 5472 7565 6060 2061 6e64   of ``True`` and
-000228e0: 2060 6046 616c 7365 6060 2076 616c 7565   ``False`` value
-000228f0: 7320 2870 616e 6461 732e 5365 7269 6573  s (pandas.Series
-00022900: 290a 2020 2020 2020 2020 2222 220a 2020  ).        """.  
-00022910: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
-00022920: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
-00022930: 204f 6e65 486f 7445 6e63 6f64 696e 6728   OneHotEncoding(
-00022940: 636f 6c75 6d6e 5f6e 616d 6573 3d5b 2761  column_names=['a
-00022950: 272c 2027 6227 2c20 2763 275d 290a 0a20  ', 'b', 'c']).. 
-00022960: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
-00022970: 2020 2020 2074 6162 6c65 5f64 6174 6120       table_data 
-00022980: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
-00022990: 0a20 2020 2020 2020 2020 2020 2027 6127  .            'a'
-000229a0: 3a20 5b31 2e30 2c20 312e 302c 2030 2e30  : [1.0, 1.0, 0.0
-000229b0: 2c20 302e 352c 2031 2e30 5d2c 0a20 2020  , 0.5, 1.0],.   
-000229c0: 2020 2020 2020 2020 2027 6227 3a20 5b30           'b': [0
-000229d0: 2e30 2c20 312e 302c 2030 2e30 2c20 302e  .0, 1.0, 0.0, 0.
-000229e0: 352c 2030 2e30 5d2c 0a20 2020 2020 2020  5, 0.0],.       
-000229f0: 2020 2020 2027 6327 3a20 5b30 2e30 2c20       'c': [0.0, 
-00022a00: 322e 302c 2030 2e30 2c20 302e 302c 206e  2.0, 0.0, 0.0, n
-00022a10: 702e 6e61 6e5d 2c0a 2020 2020 2020 2020  p.nan],.        
-00022a20: 2020 2020 2764 273a 205b 312c 2032 2c20      'd': [1, 2, 
-00022a30: 332c 2034 2c20 355d 0a20 2020 2020 2020  3, 4, 5].       
-00022a40: 207d 290a 2020 2020 2020 2020 6f75 7420   }).        out 
-00022a50: 3d20 696e 7374 616e 6365 2e69 735f 7661  = instance.is_va
-00022a60: 6c69 6428 7461 626c 655f 6461 7461 290a  lid(table_data).
-00022a70: 0a20 2020 2020 2020 2023 2041 7373 6572  .        # Asser
-00022a80: 740a 2020 2020 2020 2020 6578 7065 6374  t.        expect
-00022a90: 6564 5f6f 7574 203d 2070 642e 5365 7269  ed_out = pd.Seri
-00022aa0: 6573 285b 5472 7565 2c20 4661 6c73 652c  es([True, False,
-00022ab0: 2046 616c 7365 2c20 4661 6c73 652c 2046   False, False, F
-00022ac0: 616c 7365 5d29 0a20 2020 2020 2020 2070  alse]).        p
-00022ad0: 642e 7465 7374 696e 672e 6173 7365 7274  d.testing.assert
-00022ae0: 5f73 6572 6965 735f 6571 7561 6c28 6578  _series_equal(ex
-00022af0: 7065 6374 6564 5f6f 7574 2c20 6f75 7429  pected_out, out)
-00022b00: 0a0a 0a63 6c61 7373 2054 6573 7455 6e69  ...class TestUni
-00022b10: 7175 6528 293a 0a0a 2020 2020 6465 6620  que():..    def 
-00022b20: 7465 7374 5f5f 7661 6c69 6461 7465 5f69  test__validate_i
-00022b30: 6e70 7574 7328 7365 6c66 293a 0a20 2020  nputs(self):.   
-00022b40: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
-00022b50: 2060 6055 6e69 7175 652e 5f76 616c 6964   ``Unique._valid
-00022b60: 6174 655f 696e 7075 7473 6060 206d 6574  ate_inputs`` met
-00022b70: 686f 642e 0a0a 2020 2020 2020 2020 496e  hod...        In
-00022b80: 7075 743a 0a20 2020 2020 2020 202d 2020  put:.        -  
-00022b90: 496e 636f 7272 6563 7420 6172 6775 6d65  Incorrect argume
-00022ba0: 6e74 7320 666f 7220 7468 6520 6d65 7468  nts for the meth
-00022bb0: 6f64 0a20 2020 2020 2020 2052 6169 7365  od.        Raise
-00022bc0: 733a 0a20 2020 2020 2020 202d 204c 6973  s:.        - Lis
-00022bd0: 7420 6f66 2056 616c 7565 4572 726f 7273  t of ValueErrors
-00022be0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00022bf0: 2020 2020 2023 2052 756e 202f 2041 7373       # Run / Ass
-00022c00: 6572 740a 2020 2020 2020 2020 7769 7468  ert.        with
-00022c10: 2070 7974 6573 742e 7261 6973 6573 2841   pytest.raises(A
-00022c20: 6767 7265 6761 7465 436f 6e73 7472 6169  ggregateConstrai
-00022c30: 6e74 7345 7272 6f72 2920 6173 2065 7272  ntsError) as err
-00022c40: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
-00022c50: 556e 6971 7565 2e5f 7661 6c69 6461 7465  Unique._validate
-00022c60: 5f69 6e70 7574 7328 6e6f 745f 636f 6c75  _inputs(not_colu
-00022c70: 6d6e 5f6e 616d 6573 3d4e 6f6e 652c 2073  mn_names=None, s
-00022c80: 6f6d 6574 6869 6e67 5f65 6c73 653d 4e6f  omething_else=No
-00022c90: 6e65 290a 0a20 2020 2020 2020 2065 7272  ne)..        err
-00022ca0: 5f6d 7367 203d 2028 0a20 2020 2020 2020  _msg = (.       
-00022cb0: 2020 2020 2072 274d 6973 7369 6e67 2072       r'Missing r
-00022cc0: 6571 7569 7265 6420 7661 6c75 6573 207b  equired values {
-00022cd0: 282e 2a29 7d20 696e 2061 2055 6e69 7175  (.*)} in a Uniqu
-00022ce0: 6520 636f 6e73 7472 6169 6e74 2e27 0a20  e constraint.'. 
-00022cf0: 2020 2020 2020 2020 2020 2072 275c 6e5c             r'\n\
-00022d00: 6e49 6e76 616c 6964 2076 616c 7565 7320  nInvalid values 
-00022d10: 7b28 2e2a 297d 2061 7265 2070 7265 7365  {(.*)} are prese
-00022d20: 6e74 2069 6e20 6120 556e 6971 7565 2063  nt in a Unique c
-00022d30: 6f6e 7374 7261 696e 742e 270a 2020 2020  onstraint.'.    
-00022d40: 2020 2020 290a 2020 2020 2020 2020 6772      ).        gr
-00022d50: 6f75 7073 203d 2072 652e 7365 6172 6368  oups = re.search
-00022d60: 2865 7272 5f6d 7367 2c20 7374 7228 6572  (err_msg, str(er
-00022d70: 726f 722e 7661 6c75 6529 290a 2020 2020  ror.value)).    
-00022d80: 2020 2020 6173 7365 7274 2067 726f 7570      assert group
-00022d90: 7320 6973 206e 6f74 204e 6f6e 650a 2020  s is not None.  
-00022da0: 2020 2020 2020 6173 7365 7274 2073 7472        assert str
-00022db0: 2865 7661 6c28 6772 6f75 7073 2e67 726f  (eval(groups.gro
-00022dc0: 7570 2831 2929 2920 3d3d 2027 636f 6c75  up(1))) == 'colu
-00022dd0: 6d6e 5f6e 616d 6573 270a 2020 2020 2020  mn_names'.      
-00022de0: 2020 6173 7365 7274 2073 6574 2865 7661    assert set(eva
-00022df0: 6c28 6772 6f75 7073 2e67 726f 7570 2832  l(groups.group(2
-00022e00: 2929 2920 3d3d 207b 276e 6f74 5f63 6f6c  ))) == {'not_col
-00022e10: 756d 6e5f 6e61 6d65 7327 2c20 2773 6f6d  umn_names', 'som
-00022e20: 6574 6869 6e67 5f65 6c73 6527 7d0a 0a20  ething_else'}.. 
-00022e30: 2020 2064 6566 2074 6573 745f 5f76 616c     def test__val
-00022e40: 6964 6174 655f 6d65 7461 6461 7461 5f63  idate_metadata_c
-00022e50: 6f6c 756d 6e73 2873 656c 6629 3a0a 2020  olumns(self):.  
-00022e60: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-00022e70: 6520 6060 5f76 616c 6964 6174 655f 6d65  e ``_validate_me
-00022e80: 7461 6461 7461 5f63 6f6c 756d 6e73 6060  tadata_columns``
-00022e90: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
-00022ea0: 2020 416c 6c20 6f66 2074 6865 2063 6f6c    All of the col
-00022eb0: 756d 6e73 2070 6173 7365 6420 696e 2063  umns passed in c
-00022ec0: 6f6c 756d 6e5f 6e61 6d65 7320 7368 6f75  olumn_names shou
-00022ed0: 6c64 2062 6520 696e 2074 6865 206d 6574  ld be in the met
-00022ee0: 6164 6174 612e 0a0a 2020 2020 2020 2020  adata...        
-00022ef0: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
-00022f00: 2020 202d 2063 6f6c 756d 6e5f 6e61 6d65     - column_name
-00022f10: 7320 7769 7468 2063 6f6c 756d 6e73 2074  s with columns t
-00022f20: 6861 7420 6172 6520 616c 6c20 696e 2074  hat are all in t
-00022f30: 6865 206d 6574 6164 6174 612e 0a0a 2020  he metadata...  
-00022f40: 2020 2020 2020 5369 6465 2065 6666 6563        Side effec
-00022f50: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-00022f60: 204e 6f20 6572 726f 7220 7368 6f75 6c64   No error should
-00022f70: 2062 6520 7261 6973 6564 2e0a 2020 2020   be raised..    
-00022f80: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00022f90: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-00022fa0: 6d65 7461 6461 7461 203d 204d 6f63 6b28  metadata = Mock(
-00022fb0: 290a 2020 2020 2020 2020 6d65 7461 6461  ).        metada
-00022fc0: 7461 2e63 6f6c 756d 6e73 203d 207b 2761  ta.columns = {'a
-00022fd0: 273a 2031 2c20 2762 273a 2032 7d0a 0a20  ': 1, 'b': 2}.. 
-00022fe0: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
-00022ff0: 2020 2020 2055 6e69 7175 652e 5f76 616c       Unique._val
-00023000: 6964 6174 655f 6d65 7461 6461 7461 5f63  idate_metadata_c
-00023010: 6f6c 756d 6e73 286d 6574 6164 6174 612c  olumns(metadata,
-00023020: 2063 6f6c 756d 6e5f 6e61 6d65 733d 5b27   column_names=['
-00023030: 6127 2c20 2762 275d 290a 0a20 2020 2064  a', 'b'])..    d
-00023040: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
-00023050: 655f 6d65 7461 6461 7461 5f63 6f6c 756d  e_metadata_colum
-00023060: 6e73 5f72 6169 7365 735f 6572 726f 7228  ns_raises_error(
-00023070: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00023080: 2222 5465 7374 2074 6865 2060 605f 7661  ""Test the ``_va
-00023090: 6c69 6461 7465 5f6d 6574 6164 6174 615f  lidate_metadata_
-000230a0: 636f 6c75 6d6e 7360 6020 6d65 7468 6f64  columns`` method
-000230b0: 2773 2065 7272 6f72 2063 6f6e 6469 7469  's error conditi
-000230c0: 6f6e 2e0a 0a20 2020 2020 2020 2049 6620  on...        If 
-000230d0: 616e 7920 636f 6c75 6d6e 7320 696e 2063  any columns in c
-000230e0: 6f6c 756d 6e5f 6e61 6d65 7320 6172 6520  olumn_names are 
-000230f0: 6e6f 7420 696e 2074 6865 206d 6574 6164  not in the metad
-00023100: 6174 612c 2061 6e20 6572 726f 7220 7368  ata, an error sh
-00023110: 6f75 6c64 2062 6520 7261 6973 6564 2e0a  ould be raised..
-00023120: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-00023130: 2020 2020 2020 2020 2020 2020 2d20 636f              - co
-00023140: 6c75 6d6e 5f6e 616d 6573 2074 6861 7420  lumn_names that 
-00023150: 636f 6e74 6169 6e73 2061 2063 6f6c 756d  contains a colum
-00023160: 6e20 6e6f 7420 696e 2074 6865 206d 6574  n not in the met
-00023170: 6164 6174 612e 0a0a 2020 2020 2020 2020  adata...        
-00023180: 5369 6465 2065 6666 6563 743a 0a20 2020  Side effect:.   
-00023190: 2020 2020 2020 2020 202d 2043 6f6e 7374           - Const
-000231a0: 7261 696e 744d 6574 6164 6174 6145 7272  raintMetadataErr
-000231b0: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
-000231c0: 7365 642e 0a20 2020 2020 2020 2022 2222  sed..        """
-000231d0: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-000231e0: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
-000231f0: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
-00023200: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
-00023210: 6d6e 7320 3d20 7b27 6127 3a20 312c 2027  mns = {'a': 1, '
-00023220: 6227 3a20 327d 0a0a 2020 2020 2020 2020  b': 2}..        
-00023230: 2320 5275 6e0a 2020 2020 2020 2020 6572  # Run.        er
-00023240: 726f 725f 6d65 7373 6167 6520 3d20 7265  ror_message = re
-00023250: 2e65 7363 6170 6528 0a20 2020 2020 2020  .escape(.       
-00023260: 2020 2020 2027 4120 556e 6971 7565 2063       'A Unique c
-00023270: 6f6e 7374 7261 696e 7420 6973 2062 6569  onstraint is bei
-00023280: 6e67 2061 7070 6c69 6564 2074 6f20 696e  ng applied to in
-00023290: 7661 6c69 6420 636f 6c75 6d6e 206e 616d  valid column nam
-000232a0: 6573 2027 0a20 2020 2020 2020 2020 2020  es '.           
-000232b0: 2022 7b27 6327 7d2e 2054 6865 2063 6f6c   "{'c'}. The col
-000232c0: 756d 6e73 206d 7573 7420 6578 6973 7420  umns must exist 
-000232d0: 696e 2074 6865 2074 6162 6c65 2e22 0a20  in the table.". 
-000232e0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000232f0: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
-00023300: 7365 7328 436f 6e73 7472 6169 6e74 4d65  ses(ConstraintMe
-00023310: 7461 6461 7461 4572 726f 722c 206d 6174  tadataError, mat
-00023320: 6368 3d65 7272 6f72 5f6d 6573 7361 6765  ch=error_message
-00023330: 293a 0a20 2020 2020 2020 2020 2020 2055  ):.            U
-00023340: 6e69 7175 652e 5f76 616c 6964 6174 655f  nique._validate_
-00023350: 6d65 7461 6461 7461 5f63 6f6c 756d 6e73  metadata_columns
-00023360: 286d 6574 6164 6174 612c 2063 6f6c 756d  (metadata, colum
-00023370: 6e5f 6e61 6d65 733d 5b27 6127 2c20 2763  n_names=['a', 'c
-00023380: 275d 290a 0a20 2020 2064 6566 2074 6573  '])..    def tes
-00023390: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
-000233a0: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
-000233b0: 5f63 6f6e 7374 7261 696e 7428 7365 6c66  _constraint(self
-000233c0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-000233d0: 7374 2074 6865 2060 605f 7661 6c69 6461  st the ``_valida
-000233e0: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
-000233f0: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
-00023400: 6e74 6060 2e0a 0a20 2020 2020 2020 2049  nt``...        I
-00023410: 6620 6174 206c 6561 7374 206f 6e65 206f  f at least one o
-00023420: 6620 7468 6520 636f 6c75 6d6e 7320 696e  f the columns in
-00023430: 2060 6063 6f6c 756d 6e5f 6e61 6d65 7360   ``column_names`
-00023440: 6020 6973 206e 6f74 2061 206b 6579 2c20  ` is not a key, 
-00023450: 6e6f 2065 7272 6f72 2073 686f 756c 640a  no error should.
-00023460: 2020 2020 2020 2020 6265 2072 6169 7365          be raise
-00023470: 642e 0a0a 2020 2020 2020 2020 496e 7075  d...        Inpu
-00023480: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-00023490: 204d 6574 6164 6174 6120 7769 7468 2070   Metadata with p
-000234a0: 7269 6d61 7279 2061 6e64 2061 6c74 6572  rimary and alter
-000234b0: 6e61 7465 206b 6579 732e 0a20 2020 2020  nate keys..     
-000234c0: 2020 2020 2020 202d 2043 6f6c 756d 6e20         - Column 
-000234d0: 6e61 6d65 7320 7769 7468 206c 6973 7420  names with list 
-000234e0: 6f66 2063 6f6c 756d 6e73 2064 6966 6665  of columns diffe
-000234f0: 7265 6e74 2068 7461 6e20 7468 6520 7072  rent htan the pr
-00023500: 696d 6172 7920 6b65 7920 616e 6420 616c  imary key and al
-00023510: 7465 726e 6174 6520 6b65 7973 2e0a 2020  ternate keys..  
-00023520: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00023530: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
-00023540: 2020 6d65 7461 6461 7461 203d 204d 6f63    metadata = Moc
-00023550: 6b28 290a 2020 2020 2020 2020 6d65 7461  k().        meta
-00023560: 6461 7461 2e70 7269 6d61 7279 5f6b 6579  data.primary_key
-00023570: 203d 2027 6127 0a20 2020 2020 2020 206d   = 'a'.        m
-00023580: 6574 6164 6174 612e 616c 7465 726e 6174  etadata.alternat
-00023590: 655f 6b65 7973 203d 205b 2762 272c 2027  e_keys = ['b', '
-000235a0: 6327 5d0a 0a20 2020 2020 2020 2023 2052  c']..        # R
-000235b0: 756e 0a20 2020 2020 2020 2055 6e69 7175  un.        Uniqu
-000235c0: 652e 5f76 616c 6964 6174 655f 6d65 7461  e._validate_meta
-000235d0: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
-000235e0: 5f63 6f6e 7374 7261 696e 7428 0a20 2020  _constraint(.   
-000235f0: 2020 2020 2020 2020 206d 6574 6164 6174           metadat
-00023600: 612c 0a20 2020 2020 2020 2020 2020 2063  a,.            c
-00023610: 6f6c 756d 6e5f 6e61 6d65 733d 5b27 6127  olumn_names=['a'
-00023620: 2c20 2762 272c 2027 6427 5d0a 2020 2020  , 'b', 'd'].    
-00023630: 2020 2020 290a 0a20 2020 2064 6566 2074      )..    def t
-00023640: 6573 745f 5f76 616c 6964 6174 655f 6d65  est__validate_me
-00023650: 7461 6461 7461 5f73 7065 6369 6669 635f  tadata_specific_
-00023660: 746f 5f63 6f6e 7374 7261 696e 745f 6572  to_constraint_er
-00023670: 726f 7228 7365 6c66 293a 0a20 2020 2020  ror(self):.     
-00023680: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-00023690: 605f 7661 6c69 6461 7465 5f6d 6574 6164  `_validate_metad
-000236a0: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
-000236b0: 636f 6e73 7472 6169 6e74 6060 2e0a 0a20  constraint``... 
-000236c0: 2020 2020 2020 2049 6620 616c 6c20 6f66         If all of
-000236d0: 2074 6865 2063 6f6c 756d 6e73 2069 6e20   the columns in 
-000236e0: 6060 636f 6c75 6d6e 5f6e 616d 6573 6060  ``column_names``
-000236f0: 2061 7265 206b 6579 732c 2061 6e20 6572   are keys, an er
-00023700: 726f 7220 7368 6f75 6c64 0a20 2020 2020  ror should.     
-00023710: 2020 2062 6520 7261 6973 6564 2e0a 0a20     be raised... 
-00023720: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
-00023730: 2020 2020 2020 2020 2020 2d20 4d65 7461            - Meta
-00023740: 6461 7461 2077 6974 6820 7072 696d 6172  data with primar
-00023750: 7920 616e 6420 616c 7465 726e 6174 6520  y and alternate 
-00023760: 6b65 7973 2e0a 2020 2020 2020 2020 2020  keys..          
-00023770: 2020 2d20 436f 6c75 6d6e 206e 616d 6573    - Column names
-00023780: 2077 6974 6820 6c69 7374 206f 6620 636f   with list of co
-00023790: 6c75 6d6e 7320 6469 6666 6572 656e 7420  lumns different 
-000237a0: 6874 616e 2074 6865 2070 7269 6d61 7279  htan the primary
-000237b0: 206b 6579 2061 6e64 2061 6c74 6572 6e61   key and alterna
-000237c0: 7465 206b 6579 732e 0a20 2020 2020 2020  te keys..       
-000237d0: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
-000237e0: 6574 7570 0a20 2020 2020 2020 206d 6574  etup.        met
-000237f0: 6164 6174 6120 3d20 4d6f 636b 2829 0a20  adata = Mock(). 
-00023800: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
-00023810: 7072 696d 6172 795f 6b65 7920 3d20 2761  primary_key = 'a
-00023820: 270a 2020 2020 2020 2020 6d65 7461 6461  '.        metada
-00023830: 7461 2e61 6c74 6572 6e61 7465 5f6b 6579  ta.alternate_key
-00023840: 7320 3d20 5b28 2762 272c 2027 6327 292c  s = [('b', 'c'),
-00023850: 2027 6427 5d0a 0a20 2020 2020 2020 2023   'd']..        #
-00023860: 2052 756e 0a20 2020 2020 2020 2065 7272   Run.        err
-00023870: 6f72 5f6d 6573 7361 6765 203d 2072 652e  or_message = re.
-00023880: 6573 6361 7065 280a 2020 2020 2020 2020  escape(.        
-00023890: 2020 2020 2241 2055 6e69 7175 6520 636f      "A Unique co
-000238a0: 6e73 7472 6169 6e74 2069 7320 6265 696e  nstraint is bein
-000238b0: 6720 6170 706c 6965 6420 746f 2063 6f6c  g applied to col
-000238c0: 756d 6e73 2027 5b27 6127 2c20 2762 272c  umns '['a', 'b',
-000238d0: 2027 6327 5d27 2e20 220a 2020 2020 2020   'c']'. ".      
-000238e0: 2020 2020 2020 2754 6865 7365 2063 6f6c        'These col
-000238f0: 756d 6e73 2061 7265 2061 6c72 6561 6479  umns are already
-00023900: 2061 206b 6579 2066 6f72 2074 6861 7420   a key for that 
-00023910: 7461 626c 652e 270a 2020 2020 2020 2020  table.'.        
-00023920: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
-00023930: 7974 6573 742e 7261 6973 6573 2843 6f6e  ytest.raises(Con
-00023940: 7374 7261 696e 744d 6574 6164 6174 6145  straintMetadataE
-00023950: 7272 6f72 2c20 6d61 7463 683d 6572 726f  rror, match=erro
-00023960: 725f 6d65 7373 6167 6529 3a0a 2020 2020  r_message):.    
-00023970: 2020 2020 2020 2020 556e 6971 7565 2e5f          Unique._
-00023980: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
-00023990: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
-000239a0: 6e73 7472 6169 6e74 280a 2020 2020 2020  nstraint(.      
-000239b0: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
-000239c0: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
-000239d0: 2020 2020 636f 6c75 6d6e 5f6e 616d 6573      column_names
-000239e0: 3d5b 2761 272c 2027 6227 2c20 2763 275d  =['a', 'b', 'c']
-000239f0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00023a00: 2020 2020 6465 6620 7465 7374 5f5f 5f69      def test___i
-00023a10: 6e69 745f 5f28 7365 6c66 293a 0a20 2020  nit__(self):.   
-00023a20: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
-00023a30: 2060 6055 6e69 7175 652e 5f5f 696e 6974   ``Unique.__init
-00023a40: 5f5f 6060 206d 6574 686f 642e 0a0a 2020  __`` method...  
-00023a50: 2020 2020 2020 5468 6520 6060 636f 6c75        The ``colu
-00023a60: 6d6e 5f6e 616d 6573 6060 2073 686f 756c  mn_names`` shoul
-00023a70: 6420 6265 2073 6574 2074 6f20 7468 6f73  d be set to thos
-00023a80: 6520 7072 6f76 6964 6564 2e0a 0a20 2020  e provided...   
-00023a90: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-00023aa0: 2020 2020 2d20 636f 6c75 6d6e 206e 616d      - column nam
-00023ab0: 6573 2074 6f20 6b65 6570 2075 6e69 7175  es to keep uniqu
-00023ac0: 652e 0a20 2020 2020 2020 204f 7574 7075  e..        Outpu
-00023ad0: 743a 0a20 2020 2020 2020 202d 2049 6e73  t:.        - Ins
-00023ae0: 7461 6e63 6520 7769 7468 2060 6063 6f6c  tance with ``col
-00023af0: 756d 6e5f 6e61 6d65 7360 6020 7365 742e  umn_names`` set.
-00023b00: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00023b10: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
-00023b20: 2020 2069 6e73 7461 6e63 6520 3d20 556e     instance = Un
-00023b30: 6971 7565 2863 6f6c 756d 6e5f 6e61 6d65  ique(column_name
-00023b40: 733d 5b27 6127 2c20 2762 275d 290a 0a20  s=['a', 'b']).. 
-00023b50: 2020 2020 2020 2023 2041 7373 6572 740a         # Assert.
-00023b60: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
-00023b70: 6e73 7461 6e63 652e 636f 6c75 6d6e 5f6e  nstance.column_n
-00023b80: 616d 6573 203d 3d20 5b27 6127 2c20 2762  ames == ['a', 'b
-00023b90: 275d 0a0a 2020 2020 6465 6620 7465 7374  ']..    def test
-00023ba0: 5f69 735f 7661 6c69 6428 7365 6c66 293a  _is_valid(self):
-00023bb0: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-00023bc0: 2074 6865 2060 6055 6e69 7175 652e 6973   the ``Unique.is
-00023bd0: 5f76 616c 6964 6060 206d 6574 686f 642e  _valid`` method.
-00023be0: 0a0a 2020 2020 2020 2020 5468 6973 206d  ..        This m
-00023bf0: 6574 686f 6420 7368 6f75 6c64 2072 6574  ethod should ret
-00023c00: 7572 6e20 6120 7064 2e53 6572 6965 7320  urn a pd.Series 
-00023c10: 7768 6572 6520 7468 6520 696e 6465 780a  where the index.
-00023c20: 2020 2020 2020 2020 6f66 2074 6865 2066          of the f
-00023c30: 6972 7374 206f 6363 7572 656e 6365 206f  irst occurence o
-00023c40: 6620 6120 756e 6971 7565 2063 6f6d 6269  f a unique combi
-00023c50: 6e61 7469 6f6e 206f 6620 6060 696e 7374  nation of ``inst
-00023c60: 616e 6365 2e63 6f6c 756d 6e5f 6e61 6d65  ance.column_name
-00023c70: 7360 600a 2020 2020 2020 2020 6973 2073  s``.        is s
-00023c80: 6574 2074 6f20 6060 5472 7565 6060 2c20  et to ``True``, 
-00023c90: 616e 6420 6576 6572 7920 6f74 6865 7220  and every other 
-00023ca0: 6f63 6375 7265 6e63 6520 6973 2073 6574  occurence is set
-00023cb0: 2074 6f20 6060 4661 6c73 6560 602e 0a0a   to ``False``...
-00023cc0: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
-00023cd0: 2020 2020 2020 202d 2044 6174 6146 7261         - DataFra
-00023ce0: 6d65 2077 6974 6820 6d75 6c74 6970 6c65  me with multiple
-00023cf0: 206f 6620 7468 6520 7361 6d65 2063 6f6d   of the same com
-00023d00: 6269 6e61 7469 6f6e 7320 6f66 2063 6f6c  binations of col
-00023d10: 756d 6e73 2e0a 2020 2020 2020 2020 4f75  umns..        Ou
-00023d20: 7470 7574 3a0a 2020 2020 2020 2020 2d20  tput:.        - 
-00023d30: 5365 7269 6573 2077 6974 6820 7468 6520  Series with the 
-00023d40: 696e 6465 7820 6f66 2074 6865 2066 6972  index of the fir
-00023d50: 7374 206f 6363 7572 656e 6365 7320 7365  st occurences se
-00023d60: 7420 746f 2060 6054 7275 6560 602e 0a20  t to ``True``.. 
-00023d70: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00023d80: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
-00023d90: 2020 2069 6e73 7461 6e63 6520 3d20 556e     instance = Un
-00023da0: 6971 7565 2863 6f6c 756d 6e5f 6e61 6d65  ique(column_name
-00023db0: 733d 5b27 6127 2c20 2762 272c 2027 6327  s=['a', 'b', 'c'
-00023dc0: 5d29 0a0a 2020 2020 2020 2020 2320 5275  ])..        # Ru
-00023dd0: 6e0a 2020 2020 2020 2020 6461 7461 203d  n.        data =
-00023de0: 2070 642e 4461 7461 4672 616d 6528 7b0a   pd.DataFrame({.
-00023df0: 2020 2020 2020 2020 2020 2020 2761 273a              'a':
-00023e00: 205b 312c 2031 2c20 322c 2032 2c20 332c   [1, 1, 2, 2, 3,
-00023e10: 2034 5d2c 0a20 2020 2020 2020 2020 2020   4],.           
-00023e20: 2027 6227 3a20 5b35 2c20 352c 2036 2c20   'b': [5, 5, 6, 
-00023e30: 362c 2037 2c20 385d 2c0a 2020 2020 2020  6, 7, 8],.      
-00023e40: 2020 2020 2020 2763 273a 205b 392c 2039        'c': [9, 9
-00023e50: 2c20 3130 2c20 3130 2c20 3132 2c20 3133  , 10, 10, 12, 13
-00023e60: 5d0a 2020 2020 2020 2020 7d29 0a20 2020  ].        }).   
-00023e70: 2020 2020 2076 616c 6964 203d 2069 6e73       valid = ins
-00023e80: 7461 6e63 652e 6973 5f76 616c 6964 2864  tance.is_valid(d
-00023e90: 6174 6129 0a0a 2020 2020 2020 2020 2320  ata)..        # 
-00023ea0: 4173 7365 7274 0a20 2020 2020 2020 2065  Assert.        e
-00023eb0: 7870 6563 7465 6420 3d20 7064 2e53 6572  xpected = pd.Ser
-00023ec0: 6965 7328 5b54 7275 652c 2046 616c 7365  ies([True, False
-00023ed0: 2c20 5472 7565 2c20 4661 6c73 652c 2054  , True, False, T
-00023ee0: 7275 652c 2054 7275 655d 290a 2020 2020  rue, True]).    
-00023ef0: 2020 2020 7064 2e74 6573 7469 6e67 2e61      pd.testing.a
-00023f00: 7373 6572 745f 7365 7269 6573 5f65 7175  ssert_series_equ
-00023f10: 616c 2876 616c 6964 2c20 6578 7065 6374  al(valid, expect
-00023f20: 6564 290a 0a20 2020 2064 6566 2074 6573  ed)..    def tes
-00023f30: 745f 6973 5f76 616c 6964 5f63 7573 746f  t_is_valid_custo
-00023f40: 6d5f 696e 6465 785f 7361 6d65 5f76 616c  m_index_same_val
-00023f50: 7565 7328 7365 6c66 293a 0a20 2020 2020  ues(self):.     
-00023f60: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-00023f70: 6055 6e69 7175 652e 6973 5f76 616c 6964  `Unique.is_valid
-00023f80: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
-00023f90: 2020 2020 5468 6973 206d 6574 686f 6420      This method 
-00023fa0: 7368 6f75 6c64 2072 6574 7572 6e20 6120  should return a 
-00023fb0: 7064 2e53 6572 6965 7320 7768 6572 6520  pd.Series where 
-00023fc0: 7468 6520 696e 6465 780a 2020 2020 2020  the index.      
-00023fd0: 2020 6f66 2074 6865 2066 6972 7374 206f    of the first o
-00023fe0: 6363 7572 656e 6365 206f 6620 6120 756e  ccurence of a un
-00023ff0: 6971 7565 2063 6f6d 6269 6e61 7469 6f6e  ique combination
-00024000: 206f 6620 6060 696e 7374 616e 6365 2e63   of ``instance.c
-00024010: 6f6c 756d 6e5f 6e61 6d65 7360 600a 2020  olumn_names``.  
-00024020: 2020 2020 2020 6973 2073 6574 2074 6f20        is set to 
-00024030: 6060 5472 7565 6060 2c20 616e 6420 6576  ``True``, and ev
-00024040: 6572 7920 6f74 6865 7220 6f63 6375 7265  ery other occure
-00024050: 6e63 6520 6973 2073 6574 2074 6f20 6060  nce is set to ``
-00024060: 4661 6c73 6560 602e 0a0a 2020 2020 2020  False``...      
-00024070: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
-00024080: 202d 2044 6174 6146 7261 6d65 2077 6974   - DataFrame wit
-00024090: 6820 6d75 6c74 6970 6c65 206f 6620 7468  h multiple of th
-000240a0: 6520 7361 6d65 2063 6f6d 6269 6e61 7469  e same combinati
-000240b0: 6f6e 7320 6f66 2063 6f6c 756d 6e73 2e0a  ons of columns..
-000240c0: 2020 2020 2020 2020 2d20 4461 7461 4672          - DataFr
-000240d0: 616d 6520 6861 7320 6120 6375 7374 6f6d  ame has a custom
-000240e0: 2069 6e64 6578 2063 6f6c 756d 6e20 7768   index column wh
-000240f0: 6963 6820 6973 2073 6574 2074 6f20 3020  ich is set to 0 
-00024100: 666f 7220 726f 7773 2e0a 2020 2020 2020  for rows..      
-00024110: 2020 4f75 7470 7574 3a0a 2020 2020 2020    Output:.      
-00024120: 2020 2d20 5365 7269 6573 2077 6974 6820    - Series with 
-00024130: 7468 6520 696e 6465 7820 6f66 2074 6865  the index of the
-00024140: 2066 6972 7374 206f 6363 7572 656e 6365   first occurence
-00024150: 7320 7365 7420 746f 2060 6054 7275 6560  s set to ``True`
-00024160: 602e 0a20 2020 2020 2020 2047 6974 6875  `..        Githu
-00024170: 6220 4973 7375 653a 0a20 2020 2020 2020  b Issue:.       
-00024180: 202d 2050 726f 626c 656d 2069 7320 6465   - Problem is de
-00024190: 7363 7269 6265 6420 696e 3a20 6874 7470  scribed in: http
-000241a0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f73  s://github.com/s
-000241b0: 6476 2d64 6576 2f53 4456 2f69 7373 7565  dv-dev/SDV/issue
-000241c0: 732f 3631 360a 2020 2020 2020 2020 2222  s/616.        ""
-000241d0: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
-000241e0: 700a 2020 2020 2020 2020 696e 7374 616e  p.        instan
-000241f0: 6365 203d 2055 6e69 7175 6528 636f 6c75  ce = Unique(colu
-00024200: 6d6e 5f6e 616d 6573 3d5b 2761 272c 2027  mn_names=['a', '
-00024210: 6227 2c20 2763 275d 290a 0a20 2020 2020  b', 'c'])..     
-00024220: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
-00024230: 2064 6174 6120 3d20 7064 2e44 6174 6146   data = pd.DataF
-00024240: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
-00024250: 2020 2027 6127 3a20 5b31 2c20 312c 2032     'a': [1, 1, 2
-00024260: 2c20 322c 2033 5d2c 0a20 2020 2020 2020  , 2, 3],.       
-00024270: 2020 2020 2027 6227 3a20 5b35 2c20 352c       'b': [5, 5,
-00024280: 2036 2c20 362c 2037 5d2c 0a20 2020 2020   6, 6, 7],.     
-00024290: 2020 2020 2020 2027 6327 3a20 5b38 2c20         'c': [8, 
-000242a0: 382c 2039 2c20 392c 2031 305d 0a20 2020  8, 9, 9, 10].   
-000242b0: 2020 2020 207d 2c20 696e 6465 783d 5b30       }, index=[0
-000242c0: 2c20 302c 2030 2c20 302c 2030 5d29 0a20  , 0, 0, 0, 0]). 
-000242d0: 2020 2020 2020 2076 616c 6964 203d 2069         valid = i
-000242e0: 6e73 7461 6e63 652e 6973 5f76 616c 6964  nstance.is_valid
-000242f0: 2864 6174 6129 0a0a 2020 2020 2020 2020  (data)..        
-00024300: 2320 4173 7365 7274 0a20 2020 2020 2020  # Assert.       
-00024310: 2065 7870 6563 7465 6420 3d20 7064 2e53   expected = pd.S
-00024320: 6572 6965 7328 5b54 7275 652c 2046 616c  eries([True, Fal
-00024330: 7365 2c20 5472 7565 2c20 4661 6c73 652c  se, True, False,
-00024340: 2054 7275 655d 2c20 696e 6465 783d 5b30   True], index=[0
-00024350: 2c20 302c 2030 2c20 302c 2030 5d29 0a20  , 0, 0, 0, 0]). 
-00024360: 2020 2020 2020 2070 642e 7465 7374 696e         pd.testin
-00024370: 672e 6173 7365 7274 5f73 6572 6965 735f  g.assert_series_
-00024380: 6571 7561 6c28 7661 6c69 642c 2065 7870  equal(valid, exp
-00024390: 6563 7465 6429 0a0a 2020 2020 6465 6620  ected)..    def 
-000243a0: 7465 7374 5f69 735f 7661 6c69 645f 6375  test_is_valid_cu
-000243b0: 7374 6f6d 5f69 6e64 6578 5f6e 6f74 5f73  stom_index_not_s
-000243c0: 6f72 7465 6428 7365 6c66 293a 0a20 2020  orted(self):.   
-000243d0: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
-000243e0: 2060 6055 6e69 7175 652e 6973 5f76 616c   ``Unique.is_val
-000243f0: 6964 6060 206d 6574 686f 642e 0a0a 2020  id`` method...  
-00024400: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
-00024410: 6420 7368 6f75 6c64 2072 6574 7572 6e20  d should return 
-00024420: 6120 7064 2e53 6572 6965 7320 7768 6572  a pd.Series wher
-00024430: 6520 7468 6520 696e 6465 780a 2020 2020  e the index.    
-00024440: 2020 2020 6f66 2074 6865 2066 6972 7374      of the first
-00024450: 206f 6363 7572 656e 6365 206f 6620 6120   occurence of a 
-00024460: 756e 6971 7565 2063 6f6d 6269 6e61 7469  unique combinati
-00024470: 6f6e 206f 6620 6060 696e 7374 616e 6365  on of ``instance
-00024480: 2e63 6f6c 756d 6e5f 6e61 6d65 7360 600a  .column_names``.
-00024490: 2020 2020 2020 2020 6973 2073 6574 2074          is set t
-000244a0: 6f20 6060 5472 7565 6060 2c20 616e 6420  o ``True``, and 
-000244b0: 6576 6572 7920 6f74 6865 7220 6f63 6375  every other occu
-000244c0: 7265 6e63 6520 6973 2073 6574 2074 6f20  rence is set to 
-000244d0: 6060 4661 6c73 6560 602e 0a0a 2020 2020  ``False``...    
-000244e0: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
-000244f0: 2020 202d 2044 6174 6146 7261 6d65 2077     - DataFrame w
-00024500: 6974 6820 6d75 6c74 6970 6c65 206f 6620  ith multiple of 
-00024510: 7468 6520 7361 6d65 2063 6f6d 6269 6e61  the same combina
-00024520: 7469 6f6e 7320 6f66 2063 6f6c 756d 6e73  tions of columns
-00024530: 2e0a 2020 2020 2020 2020 2d20 4461 7461  ..        - Data
-00024540: 4672 616d 6520 6861 7320 6120 6375 7374  Frame has a cust
-00024550: 6f6d 2069 6e64 6578 2063 6f6c 756d 6e20  om index column 
-00024560: 7768 6963 6820 6973 2073 6574 2069 6e20  which is set in 
-00024570: 616e 2075 6e73 6f72 7465 6420 7761 792e  an unsorted way.
-00024580: 0a20 2020 2020 2020 204f 7574 7075 743a  .        Output:
-00024590: 0a20 2020 2020 2020 202d 2053 6572 6965  .        - Serie
-000245a0: 7320 7769 7468 2074 6865 2069 6e64 6578  s with the index
-000245b0: 206f 6620 7468 6520 6669 7273 7420 6f63   of the first oc
-000245c0: 6375 7265 6e63 6573 2073 6574 2074 6f20  curences set to 
-000245d0: 6060 5472 7565 6060 2e0a 2020 2020 2020  ``True``..      
-000245e0: 2020 4769 7468 7562 2049 7373 7565 3a0a    Github Issue:.
-000245f0: 2020 2020 2020 2020 2d20 5072 6f62 6c65          - Proble
-00024600: 6d20 6973 2064 6573 6372 6962 6564 2069  m is described i
-00024610: 6e3a 2068 7474 7073 3a2f 2f67 6974 6875  n: https://githu
-00024620: 622e 636f 6d2f 7364 762d 6465 762f 5344  b.com/sdv-dev/SD
-00024630: 562f 6973 7375 6573 2f36 3137 0a20 2020  V/issues/617.   
-00024640: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00024650: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
-00024660: 2069 6e73 7461 6e63 6520 3d20 556e 6971   instance = Uniq
-00024670: 7565 2863 6f6c 756d 6e5f 6e61 6d65 733d  ue(column_names=
-00024680: 5b27 6127 2c20 2762 272c 2027 6327 5d29  ['a', 'b', 'c'])
-00024690: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
-000246a0: 2020 2020 2020 2020 6461 7461 203d 2070          data = p
-000246b0: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
-000246c0: 2020 2020 2020 2020 2020 2761 273a 205b            'a': [
-000246d0: 312c 2031 2c20 322c 2032 2c20 335d 2c0a  1, 1, 2, 2, 3],.
-000246e0: 2020 2020 2020 2020 2020 2020 2762 273a              'b':
-000246f0: 205b 352c 2035 2c20 362c 2036 2c20 375d   [5, 5, 6, 6, 7]
-00024700: 2c0a 2020 2020 2020 2020 2020 2020 2763  ,.            'c
-00024710: 273a 205b 382c 2038 2c20 392c 2039 2c20  ': [8, 8, 9, 9, 
-00024720: 3130 5d0a 2020 2020 2020 2020 7d2c 2069  10].        }, i
-00024730: 6e64 6578 3d5b 322c 2031 2c20 332c 2035  ndex=[2, 1, 3, 5
-00024740: 2c20 345d 290a 2020 2020 2020 2020 7661  , 4]).        va
-00024750: 6c69 6420 3d20 696e 7374 616e 6365 2e69  lid = instance.i
-00024760: 735f 7661 6c69 6428 6461 7461 290a 0a20  s_valid(data).. 
-00024770: 2020 2020 2020 2023 2041 7373 6572 740a         # Assert.
-00024780: 2020 2020 2020 2020 6578 7065 6374 6564          expected
-00024790: 203d 2070 642e 5365 7269 6573 285b 5472   = pd.Series([Tr
-000247a0: 7565 2c20 4661 6c73 652c 2054 7275 652c  ue, False, True,
-000247b0: 2046 616c 7365 2c20 5472 7565 5d2c 2069   False, True], i
-000247c0: 6e64 6578 3d5b 322c 2031 2c20 332c 2035  ndex=[2, 1, 3, 5
-000247d0: 2c20 345d 290a 2020 2020 2020 2020 7064  , 4]).        pd
-000247e0: 2e74 6573 7469 6e67 2e61 7373 6572 745f  .testing.assert_
-000247f0: 7365 7269 6573 5f65 7175 616c 2876 616c  series_equal(val
-00024800: 6964 2c20 6578 7065 6374 6564 290a 0a20  id, expected).. 
-00024810: 2020 2064 6566 2074 6573 745f 6973 5f76     def test_is_v
-00024820: 616c 6964 5f6f 6e65 5f63 6f6c 756d 6e5f  alid_one_column_
-00024830: 6375 7374 6f6d 5f69 6e64 6578 5f6e 6f74  custom_index_not
-00024840: 5f73 6f72 7465 6428 7365 6c66 293a 0a20  _sorted(self):. 
-00024850: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
-00024860: 6865 2060 6055 6e69 7175 652e 6973 5f76  he ``Unique.is_v
-00024870: 616c 6964 6060 206d 6574 686f 642e 0a0a  alid`` method...
-00024880: 2020 2020 2020 2020 5468 6973 206d 6574          This met
-00024890: 686f 6420 7368 6f75 6c64 2072 6574 7572  hod should retur
-000248a0: 6e20 6120 7064 2e53 6572 6965 7320 7768  n a pd.Series wh
-000248b0: 6572 6520 7468 6520 696e 6465 780a 2020  ere the index.  
-000248c0: 2020 2020 2020 6f66 2074 6865 2066 6972        of the fir
-000248d0: 7374 206f 6363 7572 656e 6365 206f 6620  st occurence of 
-000248e0: 6120 756e 6971 7565 2076 616c 7565 206f  a unique value o
-000248f0: 6620 6060 7365 6c66 2e63 6f6c 756d 6e5f  f ``self.column_
-00024900: 6e61 6d65 7360 600a 2020 2020 2020 2020  names``.        
-00024910: 6973 2073 6574 2074 6f20 6060 5472 7565  is set to ``True
-00024920: 6060 2c20 616e 6420 6576 6572 7920 6f74  ``, and every ot
-00024930: 6865 7220 6f63 6375 7265 6e63 6520 6973  her occurence is
-00024940: 2073 6574 2074 6f20 6060 4661 6c73 6560   set to ``False`
-00024950: 602e 0a0a 2020 2020 2020 2020 496e 7075  `...        Inpu
-00024960: 743a 0a20 2020 2020 2020 202d 2044 6174  t:.        - Dat
-00024970: 6146 7261 6d65 2077 6974 6820 6d75 6c74  aFrame with mult
-00024980: 6970 6c65 206f 6363 7572 656e 6365 7320  iple occurences 
-00024990: 6f66 2074 6865 2073 616d 6520 7661 6c75  of the same valu
-000249a0: 6520 6f66 2074 6865 0a20 2020 2020 2020  e of the.       
-000249b0: 206f 6e65 2063 6f6c 756d 6e20 696e 2060   one column in `
-000249c0: 6069 6e73 7461 6e63 652e 636f 6c75 6d6e  `instance.column
-000249d0: 7360 602e 0a20 2020 2020 2020 202d 2044  s``..        - D
-000249e0: 6174 6146 7261 6d65 2068 6173 2061 2063  ataFrame has a c
-000249f0: 7573 746f 6d20 696e 6465 7820 636f 6c75  ustom index colu
-00024a00: 6d6e 2077 6869 6368 2069 7320 7365 7420  mn which is set 
-00024a10: 696e 2061 6e20 756e 736f 7274 6564 2077  in an unsorted w
-00024a20: 6179 2e0a 2020 2020 2020 2020 4f75 7470  ay..        Outp
-00024a30: 7574 3a0a 2020 2020 2020 2020 2d20 5365  ut:.        - Se
-00024a40: 7269 6573 2077 6974 6820 7468 6520 696e  ries with the in
-00024a50: 6465 7820 6f66 2074 6865 2066 6972 7374  dex of the first
-00024a60: 206f 6363 7572 656e 6365 7320 7365 7420   occurences set 
-00024a70: 746f 2060 6054 7275 6560 602e 0a20 2020  to ``True``..   
-00024a80: 2020 2020 2047 6974 6875 6220 4973 7375       Github Issu
-00024a90: 653a 0a20 2020 2020 2020 202d 2050 726f  e:.        - Pro
-00024aa0: 626c 656d 2069 7320 6465 7363 7269 6265  blem is describe
-00024ab0: 6420 696e 3a20 6874 7470 733a 2f2f 6769  d in: https://gi
-00024ac0: 7468 7562 2e63 6f6d 2f73 6476 2d64 6576  thub.com/sdv-dev
-00024ad0: 2f53 4456 2f69 7373 7565 732f 3631 370a  /SDV/issues/617.
-00024ae0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00024af0: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
-00024b00: 2020 2020 696e 7374 616e 6365 203d 2055      instance = U
-00024b10: 6e69 7175 6528 636f 6c75 6d6e 5f6e 616d  nique(column_nam
-00024b20: 6573 3d27 6127 290a 0a20 2020 2020 2020  es='a')..       
-00024b30: 2023 2052 756e 0a20 2020 2020 2020 2064   # Run.        d
-00024b40: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
-00024b50: 6d65 287b 0a20 2020 2020 2020 2020 2020  me({.           
-00024b60: 2027 6127 3a20 5b31 2c20 312c 2031 2c20   'a': [1, 1, 1, 
-00024b70: 322c 2033 2c20 325d 2c0a 2020 2020 2020  2, 3, 2],.      
-00024b80: 2020 2020 2020 2762 273a 205b 312c 2032        'b': [1, 2
-00024b90: 2c20 332c 2034 2c20 352c 2036 5d2c 0a20  , 3, 4, 5, 6],. 
-00024ba0: 2020 2020 2020 2020 2020 2027 6327 3a20             'c': 
-00024bb0: 5b46 616c 7365 2c20 4661 6c73 652c 2054  [False, False, T
-00024bc0: 7275 652c 2046 616c 7365 2c20 4661 6c73  rue, False, Fals
-00024bd0: 652c 2054 7275 655d 0a20 2020 2020 2020  e, True].       
-00024be0: 207d 2c20 696e 6465 783d 5b32 2c20 312c   }, index=[2, 1,
-00024bf0: 2033 2c20 352c 2034 2c20 365d 290a 2020   3, 5, 4, 6]).  
-00024c00: 2020 2020 2020 7661 6c69 6420 3d20 696e        valid = in
-00024c10: 7374 616e 6365 2e69 735f 7661 6c69 6428  stance.is_valid(
-00024c20: 6461 7461 290a 0a20 2020 2020 2020 2023  data)..        #
-00024c30: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
-00024c40: 6578 7065 6374 6564 203d 2070 642e 5365  expected = pd.Se
-00024c50: 7269 6573 285b 5472 7565 2c20 4661 6c73  ries([True, Fals
-00024c60: 652c 2046 616c 7365 2c20 5472 7565 2c20  e, False, True, 
-00024c70: 5472 7565 2c20 4661 6c73 655d 2c20 696e  True, False], in
-00024c80: 6465 783d 5b32 2c20 312c 2033 2c20 352c  dex=[2, 1, 3, 5,
-00024c90: 2034 2c20 365d 290a 2020 2020 2020 2020   4, 6]).        
-00024ca0: 7064 2e74 6573 7469 6e67 2e61 7373 6572  pd.testing.asser
-00024cb0: 745f 7365 7269 6573 5f65 7175 616c 2876  t_series_equal(v
-00024cc0: 616c 6964 2c20 6578 7065 6374 6564 290a  alid, expected).
-00024cd0: 0a20 2020 2064 6566 2074 6573 745f 6973  .    def test_is
-00024ce0: 5f76 616c 6964 5f6f 6e65 5f63 6f6c 756d  _valid_one_colum
-00024cf0: 6e5f 6375 7374 6f6d 5f69 6e64 6578 5f73  n_custom_index_s
-00024d00: 616d 655f 7661 6c75 6573 2873 656c 6629  ame_values(self)
-00024d10: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
-00024d20: 7420 7468 6520 6060 556e 6971 7565 2e69  t the ``Unique.i
-00024d30: 735f 7661 6c69 6460 6020 6d65 7468 6f64  s_valid`` method
-00024d40: 2e0a 0a20 2020 2020 2020 2054 6869 7320  ...        This 
-00024d50: 6d65 7468 6f64 2073 686f 756c 6420 7265  method should re
-00024d60: 7475 726e 2061 2070 642e 5365 7269 6573  turn a pd.Series
-00024d70: 2077 6865 7265 2074 6865 2069 6e64 6578   where the index
-00024d80: 0a20 2020 2020 2020 206f 6620 7468 6520  .        of the 
-00024d90: 6669 7273 7420 6f63 6375 7265 6e63 6520  first occurence 
-00024da0: 6f66 2061 2075 6e69 7175 6520 7661 6c75  of a unique valu
-00024db0: 6520 6f66 2060 6073 656c 662e 636f 6c75  e of ``self.colu
-00024dc0: 6d6e 5f6e 616d 6573 6060 0a20 2020 2020  mn_names``.     
-00024dd0: 2020 2069 7320 7365 7420 746f 2060 6054     is set to ``T
-00024de0: 7275 6560 602c 2061 6e64 2065 7665 7279  rue``, and every
-00024df0: 206f 7468 6572 206f 6363 7572 656e 6365   other occurence
-00024e00: 2069 7320 7365 7420 746f 2060 6046 616c   is set to ``Fal
-00024e10: 7365 6060 2e0a 0a20 2020 2020 2020 2049  se``...        I
-00024e20: 6e70 7574 3a0a 2020 2020 2020 2020 2d20  nput:.        - 
-00024e30: 4461 7461 4672 616d 6520 7769 7468 206d  DataFrame with m
-00024e40: 756c 7469 706c 6520 6f63 6375 7265 6e63  ultiple occurenc
-00024e50: 6573 206f 6620 7468 6520 7361 6d65 2076  es of the same v
-00024e60: 616c 7565 206f 6620 7468 650a 2020 2020  alue of the.    
-00024e70: 2020 2020 6f6e 6520 636f 6c75 6d6e 2069      one column i
-00024e80: 6e20 6060 696e 7374 616e 6365 2e63 6f6c  n ``instance.col
-00024e90: 756d 6e73 6060 2e0a 2020 2020 2020 2020  umns``..        
-00024ea0: 2d20 4461 7461 4672 616d 6520 6861 7320  - DataFrame has 
-00024eb0: 6120 6375 7374 6f6d 2069 6e64 6578 2063  a custom index c
-00024ec0: 6f6c 756d 6e20 7768 6963 6820 6973 2073  olumn which is s
-00024ed0: 6574 2074 6f20 3020 666f 7220 726f 7773  et to 0 for rows
-00024ee0: 2e0a 2020 2020 2020 2020 4f75 7470 7574  ..        Output
-00024ef0: 3a0a 2020 2020 2020 2020 2d20 5365 7269  :.        - Seri
-00024f00: 6573 2077 6974 6820 7468 6520 696e 6465  es with the inde
-00024f10: 7820 6f66 2074 6865 2066 6972 7374 206f  x of the first o
-00024f20: 6363 7572 656e 6365 7320 7365 7420 746f  ccurences set to
-00024f30: 2060 6054 7275 6560 602e 0a20 2020 2020   ``True``..     
-00024f40: 2020 2047 6974 6875 6220 4973 7375 653a     Github Issue:
-00024f50: 0a20 2020 2020 2020 202d 2050 726f 626c  .        - Probl
-00024f60: 656d 2069 7320 6465 7363 7269 6265 6420  em is described 
-00024f70: 696e 3a20 6874 7470 733a 2f2f 6769 7468  in: https://gith
-00024f80: 7562 2e63 6f6d 2f73 6476 2d64 6576 2f53  ub.com/sdv-dev/S
-00024f90: 4456 2f69 7373 7565 732f 3631 360a 2020  DV/issues/616.  
-00024fa0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00024fb0: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
-00024fc0: 2020 696e 7374 616e 6365 203d 2055 6e69    instance = Uni
-00024fd0: 7175 6528 636f 6c75 6d6e 5f6e 616d 6573  que(column_names
-00024fe0: 3d27 6127 290a 0a20 2020 2020 2020 2023  ='a')..        #
-00024ff0: 2052 756e 0a20 2020 2020 2020 2064 6174   Run.        dat
-00025000: 6120 3d20 7064 2e44 6174 6146 7261 6d65  a = pd.DataFrame
-00025010: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
-00025020: 6127 3a20 5b31 2c20 312c 2031 2c20 322c  a': [1, 1, 1, 2,
-00025030: 2033 2c20 325d 2c0a 2020 2020 2020 2020   3, 2],.        
-00025040: 2020 2020 2762 273a 205b 312c 2032 2c20      'b': [1, 2, 
-00025050: 332c 2034 2c20 352c 2036 5d2c 0a20 2020  3, 4, 5, 6],.   
-00025060: 2020 2020 2020 2020 2027 6327 3a20 5b46           'c': [F
-00025070: 616c 7365 2c20 4661 6c73 652c 2054 7275  alse, False, Tru
-00025080: 652c 2046 616c 7365 2c20 4661 6c73 652c  e, False, False,
-00025090: 2054 7275 655d 0a20 2020 2020 2020 207d   True].        }
-000250a0: 2c20 696e 6465 783d 5b30 2c20 302c 2030  , index=[0, 0, 0
-000250b0: 2c20 302c 2030 2c20 305d 290a 2020 2020  , 0, 0, 0]).    
-000250c0: 2020 2020 7661 6c69 6420 3d20 696e 7374      valid = inst
-000250d0: 616e 6365 2e69 735f 7661 6c69 6428 6461  ance.is_valid(da
-000250e0: 7461 290a 0a20 2020 2020 2020 2023 2041  ta)..        # A
-000250f0: 7373 6572 740a 2020 2020 2020 2020 6578  ssert.        ex
-00025100: 7065 6374 6564 203d 2070 642e 5365 7269  pected = pd.Seri
-00025110: 6573 285b 5472 7565 2c20 4661 6c73 652c  es([True, False,
-00025120: 2046 616c 7365 2c20 5472 7565 2c20 5472   False, True, Tr
-00025130: 7565 2c20 4661 6c73 655d 2c20 696e 6465  ue, False], inde
-00025140: 783d 5b30 2c20 302c 2030 2c20 302c 2030  x=[0, 0, 0, 0, 0
-00025150: 2c20 305d 290a 2020 2020 2020 2020 7064  , 0]).        pd
-00025160: 2e74 6573 7469 6e67 2e61 7373 6572 745f  .testing.assert_
-00025170: 7365 7269 6573 5f65 7175 616c 2876 616c  series_equal(val
-00025180: 6964 2c20 6578 7065 6374 6564 290a 0a20  id, expected).. 
-00025190: 2020 2064 6566 2074 6573 745f 6973 5f76     def test_is_v
-000251a0: 616c 6964 5f6f 6e65 5f63 6f6c 756d 6e28  alid_one_column(
-000251b0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-000251c0: 2222 5465 7374 2074 6865 2060 6055 6e69  ""Test the ``Uni
-000251d0: 7175 652e 6973 5f76 616c 6964 6060 206d  que.is_valid`` m
-000251e0: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
-000251f0: 5468 6973 206d 6574 686f 6420 7368 6f75  This method shou
-00025200: 6c64 2072 6574 7572 6e20 6120 7064 2e53  ld return a pd.S
-00025210: 6572 6965 7320 7768 6572 6520 7468 6520  eries where the 
-00025220: 696e 6465 780a 2020 2020 2020 2020 6f66  index.        of
-00025230: 2074 6865 2066 6972 7374 206f 6363 7572   the first occur
-00025240: 656e 6365 206f 6620 6120 756e 6971 7565  ence of a unique
-00025250: 2076 616c 7565 206f 6620 6060 7365 6c66   value of ``self
-00025260: 2e63 6f6c 756d 6e5f 6e61 6d65 7360 600a  .column_names``.
-00025270: 2020 2020 2020 2020 6973 2073 6574 2074          is set t
-00025280: 6f20 6060 5472 7565 6060 2c20 616e 6420  o ``True``, and 
-00025290: 6576 6572 7920 6f74 6865 7220 6f63 6375  every other occu
-000252a0: 7265 6e63 6520 6973 2073 6574 2074 6f20  rence is set to 
-000252b0: 6060 4661 6c73 6560 602e 0a0a 2020 2020  ``False``...    
-000252c0: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
-000252d0: 2020 202d 2044 6174 6146 7261 6d65 2077     - DataFrame w
-000252e0: 6974 6820 6d75 6c74 6970 6c65 206f 6363  ith multiple occ
-000252f0: 7572 656e 6365 7320 6f66 2074 6865 2073  urences of the s
-00025300: 616d 6520 7661 6c75 6520 6f66 2074 6865  ame value of the
-00025310: 0a20 2020 2020 2020 206f 6e65 2063 6f6c  .        one col
-00025320: 756d 6e20 696e 2060 6069 6e73 7461 6e63  umn in ``instanc
-00025330: 652e 636f 6c75 6d6e 7360 602e 0a20 2020  e.columns``..   
-00025340: 2020 2020 204f 7574 7075 743a 0a20 2020       Output:.   
-00025350: 2020 2020 202d 2053 6572 6965 7320 7769       - Series wi
-00025360: 7468 2074 6865 2069 6e64 6578 206f 6620  th the index of 
-00025370: 7468 6520 6669 7273 7420 6f63 6375 7265  the first occure
-00025380: 6e63 6573 2073 6574 2074 6f20 6060 5472  nces set to ``Tr
-00025390: 7565 6060 2e0a 2020 2020 2020 2020 2222  ue``..        ""
-000253a0: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
-000253b0: 700a 2020 2020 2020 2020 696e 7374 616e  p.        instan
-000253c0: 6365 203d 2055 6e69 7175 6528 636f 6c75  ce = Unique(colu
-000253d0: 6d6e 5f6e 616d 6573 3d27 6127 290a 0a20  mn_names='a').. 
-000253e0: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
-000253f0: 2020 2020 2064 6174 6120 3d20 7064 2e44       data = pd.D
-00025400: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
-00025410: 2020 2020 2020 2027 6127 3a20 5b31 2c20         'a': [1, 
-00025420: 312c 2031 2c20 322c 2033 2c20 325d 2c0a  1, 1, 2, 3, 2],.
-00025430: 2020 2020 2020 2020 2020 2020 2762 273a              'b':
-00025440: 205b 312c 2032 2c20 332c 2034 2c20 352c   [1, 2, 3, 4, 5,
-00025450: 2036 5d2c 0a20 2020 2020 2020 2020 2020   6],.           
-00025460: 2027 6327 3a20 5b46 616c 7365 2c20 4661   'c': [False, Fa
-00025470: 6c73 652c 2054 7275 652c 2046 616c 7365  lse, True, False
-00025480: 2c20 4661 6c73 652c 2054 7275 655d 0a20  , False, True]. 
-00025490: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
-000254a0: 2020 7661 6c69 6420 3d20 696e 7374 616e    valid = instan
-000254b0: 6365 2e69 735f 7661 6c69 6428 6461 7461  ce.is_valid(data
-000254c0: 290a 0a20 2020 2020 2020 2023 2041 7373  )..        # Ass
-000254d0: 6572 740a 2020 2020 2020 2020 6578 7065  ert.        expe
-000254e0: 6374 6564 203d 2070 642e 5365 7269 6573  cted = pd.Series
-000254f0: 285b 5472 7565 2c20 4661 6c73 652c 2046  ([True, False, F
-00025500: 616c 7365 2c20 5472 7565 2c20 5472 7565  alse, True, True
-00025510: 2c20 4661 6c73 655d 290a 2020 2020 2020  , False]).      
-00025520: 2020 7064 2e74 6573 7469 6e67 2e61 7373    pd.testing.ass
-00025530: 6572 745f 7365 7269 6573 5f65 7175 616c  ert_series_equal
-00025540: 2876 616c 6964 2c20 6578 7065 6374 6564  (valid, expected
-00025550: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
-00025560: 6973 5f76 616c 6964 5f6f 6e65 5f63 6f6c  is_valid_one_col
-00025570: 756d 6e5f 6e61 6e73 2873 656c 6629 3a0a  umn_nans(self):.
-00025580: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-00025590: 7468 6520 6060 556e 6971 7565 2e69 735f  the ``Unique.is_
-000255a0: 7661 6c69 6460 6020 6d65 7468 6f64 2066  valid`` method f
-000255b0: 6f72 206f 6e65 2063 6f6c 756d 6e20 7769  or one column wi
-000255c0: 7468 206e 616e 732e 0a0a 2020 2020 2020  th nans...      
-000255d0: 2020 5468 6973 206d 6574 686f 6420 7368    This method sh
-000255e0: 6f75 6c64 2072 6574 7572 6e20 6120 7064  ould return a pd
-000255f0: 2e53 6572 6965 7320 7768 6572 6520 7468  .Series where th
-00025600: 6520 696e 6465 780a 2020 2020 2020 2020  e index.        
-00025610: 6f66 2074 6865 2066 6972 7374 206f 6363  of the first occ
-00025620: 7572 656e 6365 206f 6620 6120 756e 6971  urence of a uniq
-00025630: 7565 2076 616c 7565 206f 6620 6060 696e  ue value of ``in
-00025640: 7374 616e 6365 2e63 6f6c 756d 6e5f 6e61  stance.column_na
-00025650: 6d65 7360 600a 2020 2020 2020 2020 6973  mes``.        is
-00025660: 2073 6574 2074 6f20 6060 5472 7565 6060   set to ``True``
-00025670: 2c20 616e 6420 6576 6572 7920 6f74 6865  , and every othe
-00025680: 7220 6f63 6375 7265 6e63 6520 6973 2073  r occurence is s
-00025690: 6574 2074 6f20 6060 4661 6c73 6560 602e  et to ``False``.
-000256a0: 0a20 2020 2020 2020 2060 604e 6f6e 6560  .        ``None`
-000256b0: 602c 2060 606e 702e 6e61 6e60 6020 616e  `, ``np.nan`` an
-000256c0: 6420 6060 666c 6f61 7428 276e 616e 2729  d ``float('nan')
-000256d0: 6060 2073 686f 756c 6420 6265 2074 7265  `` should be tre
-000256e0: 6174 6564 2061 7320 7468 6520 7361 6d65  ated as the same
-000256f0: 2063 6174 6567 6f72 792e 0a0a 2020 2020   category...    
-00025700: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
-00025710: 2020 202d 2044 6174 6146 7261 6d65 2077     - DataFrame w
-00025720: 6974 6820 736f 6d65 2072 6570 6561 7465  ith some repeate
-00025730: 6420 7661 6c75 6573 2c20 736f 6d65 206f  d values, some o
-00025740: 6620 7768 6963 6820 6172 6520 6e61 6e27  f which are nan'
-00025750: 732e 0a20 2020 2020 2020 204f 7574 7075  s..        Outpu
-00025760: 743a 0a20 2020 2020 2020 202d 2053 6572  t:.        - Ser
-00025770: 6965 7320 7769 7468 2074 6865 2069 6e64  ies with the ind
-00025780: 6578 206f 6620 7468 6520 6669 7273 7420  ex of the first 
-00025790: 6f63 6375 7265 6e63 6573 2073 6574 2074  occurences set t
-000257a0: 6f20 6060 5472 7565 6060 2e0a 2020 2020  o ``True``..    
-000257b0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000257c0: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
-000257d0: 696e 7374 616e 6365 203d 2055 6e69 7175  instance = Uniqu
-000257e0: 6528 636f 6c75 6d6e 5f6e 616d 6573 3d5b  e(column_names=[
-000257f0: 2761 275d 290a 0a20 2020 2020 2020 2023  'a'])..        #
-00025800: 2052 756e 0a20 2020 2020 2020 2064 6174   Run.        dat
-00025810: 6120 3d20 7064 2e44 6174 6146 7261 6d65  a = pd.DataFrame
-00025820: 287b 0a20 2020 2020 2020 2020 2020 2027  ({.            '
-00025830: 6127 3a20 5b31 2c20 4e6f 6e65 2c20 322c  a': [1, None, 2,
-00025840: 206e 702e 6e61 6e2c 2066 6c6f 6174 2827   np.nan, float('
-00025850: 6e61 6e27 292c 2031 5d2c 0a20 2020 2020  nan'), 1],.     
-00025860: 2020 2020 2020 2027 6227 3a20 5b6e 702e         'b': [np.
-00025870: 6e61 6e2c 2031 2c20 4e6f 6e65 2c20 666c  nan, 1, None, fl
-00025880: 6f61 7428 276e 616e 2729 2c20 666c 6f61  oat('nan'), floa
-00025890: 7428 276e 616e 2729 2c20 315d 2c0a 2020  t('nan'), 1],.  
-000258a0: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
-000258b0: 2076 616c 6964 203d 2069 6e73 7461 6e63   valid = instanc
-000258c0: 652e 6973 5f76 616c 6964 2864 6174 6129  e.is_valid(data)
-000258d0: 0a0a 2020 2020 2020 2020 2320 4173 7365  ..        # Asse
-000258e0: 7274 0a20 2020 2020 2020 2065 7870 6563  rt.        expec
-000258f0: 7465 6420 3d20 7064 2e53 6572 6965 7328  ted = pd.Series(
-00025900: 5b54 7275 652c 2054 7275 652c 2054 7275  [True, True, Tru
-00025910: 652c 2046 616c 7365 2c20 4661 6c73 652c  e, False, False,
-00025920: 2046 616c 7365 5d29 0a20 2020 2020 2020   False]).       
-00025930: 2070 642e 7465 7374 696e 672e 6173 7365   pd.testing.asse
-00025940: 7274 5f73 6572 6965 735f 6571 7561 6c28  rt_series_equal(
-00025950: 7661 6c69 642c 2065 7870 6563 7465 6429  valid, expected)
-00025960: 0a0a 2020 2020 6465 6620 7465 7374 5f69  ..    def test_i
-00025970: 735f 7661 6c69 645f 6d75 6c74 6970 6c65  s_valid_multiple
-00025980: 5f63 6f6c 756d 6e73 5f6e 616e 7328 7365  _columns_nans(se
-00025990: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-000259a0: 5465 7374 2074 6865 2060 6055 6e69 7175  Test the ``Uniqu
-000259b0: 652e 6973 5f76 616c 6964 6060 206d 6574  e.is_valid`` met
-000259c0: 686f 6420 666f 7220 6d75 6c74 6970 6c65  hod for multiple
-000259d0: 2063 6f6c 756d 6e73 2077 6974 6820 6e61   columns with na
-000259e0: 6e73 2e0a 0a20 2020 2020 2020 2054 6869  ns...        Thi
-000259f0: 7320 6d65 7468 6f64 2073 686f 756c 6420  s method should 
-00025a00: 7265 7475 726e 2061 2070 642e 5365 7269  return a pd.Seri
-00025a10: 6573 2077 6865 7265 2074 6865 2069 6e64  es where the ind
-00025a20: 6578 0a20 2020 2020 2020 206f 6620 7468  ex.        of th
-00025a30: 6520 6669 7273 7420 6f63 6375 7265 6e63  e first occurenc
-00025a40: 6520 6f66 2061 2075 6e69 7175 6520 636f  e of a unique co
-00025a50: 6d62 696e 6174 696f 6e20 6f66 2060 6069  mbination of ``i
-00025a60: 6e73 7461 6e63 652e 636f 6c75 6d6e 5f6e  nstance.column_n
-00025a70: 616d 6573 6060 0a20 2020 2020 2020 2069  ames``.        i
-00025a80: 7320 7365 7420 746f 2060 6054 7275 6560  s set to ``True`
-00025a90: 602c 2061 6e64 2065 7665 7279 206f 7468  `, and every oth
-00025aa0: 6572 206f 6363 7572 656e 6365 2069 7320  er occurence is 
-00025ab0: 7365 7420 746f 2060 6046 616c 7365 6060  set to ``False``
-00025ac0: 2e0a 2020 2020 2020 2020 6060 4e6f 6e65  ..        ``None
-00025ad0: 6060 2c20 6060 6e70 2e6e 616e 6060 2061  ``, ``np.nan`` a
-00025ae0: 6e64 2060 6066 6c6f 6174 2827 6e61 6e27  nd ``float('nan'
-00025af0: 2960 6020 7368 6f75 6c64 2062 6520 7472  )`` should be tr
-00025b00: 6561 7465 6420 6173 2074 6865 2073 616d  eated as the sam
-00025b10: 6520 6361 7465 676f 7279 2e0a 0a20 2020  e category...   
-00025b20: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-00025b30: 2020 2020 2d20 4461 7461 4672 616d 6520      - DataFrame 
-00025b40: 7769 7468 206d 756c 7469 706c 6520 6f66  with multiple of
-00025b50: 2074 6865 2073 616d 6520 636f 6d62 696e   the same combin
-00025b60: 6174 696f 6e73 206f 6620 636f 6c75 6d6e  ations of column
-00025b70: 732c 2073 6f6d 6520 6f66 2077 6869 6368  s, some of which
-00025b80: 2061 7265 206e 616e 2773 2e0a 2020 2020   are nan's..    
-00025b90: 2020 2020 4f75 7470 7574 3a0a 2020 2020      Output:.    
-00025ba0: 2020 2020 2d20 5365 7269 6573 2077 6974      - Series wit
-00025bb0: 6820 7468 6520 696e 6465 7820 6f66 2074  h the index of t
-00025bc0: 6865 2066 6972 7374 206f 6363 7572 656e  he first occuren
-00025bd0: 6365 7320 7365 7420 746f 2060 6054 7275  ces set to ``Tru
-00025be0: 6560 602e 0a20 2020 2020 2020 2022 2222  e``..        """
-00025bf0: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-00025c00: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-00025c10: 6520 3d20 556e 6971 7565 2863 6f6c 756d  e = Unique(colum
-00025c20: 6e5f 6e61 6d65 733d 5b27 6127 2c20 2762  n_names=['a', 'b
-00025c30: 275d 290a 0a20 2020 2020 2020 2023 2052  '])..        # R
-00025c40: 756e 0a20 2020 2020 2020 2064 6174 6120  un.        data 
-00025c50: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
-00025c60: 0a20 2020 2020 2020 2020 2020 2027 6127  .            'a'
-00025c70: 3a20 5b31 2c20 4e6f 6e65 2c20 312c 206e  : [1, None, 1, n
-00025c80: 702e 6e61 6e2c 2066 6c6f 6174 2827 6e61  p.nan, float('na
-00025c90: 6e27 292c 2031 5d2c 0a20 2020 2020 2020  n'), 1],.       
-00025ca0: 2020 2020 2027 6227 3a20 5b6e 702e 6e61       'b': [np.na
-00025cb0: 6e2c 2031 2c20 4e6f 6e65 2c20 666c 6f61  n, 1, None, floa
-00025cc0: 7428 276e 616e 2729 2c20 666c 6f61 7428  t('nan'), float(
-00025cd0: 276e 616e 2729 2c20 315d 2c0a 2020 2020  'nan'), 1],.    
-00025ce0: 2020 2020 7d29 0a20 2020 2020 2020 2076      }).        v
-00025cf0: 616c 6964 203d 2069 6e73 7461 6e63 652e  alid = instance.
-00025d00: 6973 5f76 616c 6964 2864 6174 6129 0a0a  is_valid(data)..
-00025d10: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
-00025d20: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
-00025d30: 6420 3d20 7064 2e53 6572 6965 7328 5b54  d = pd.Series([T
-00025d40: 7275 652c 2054 7275 652c 2046 616c 7365  rue, True, False
-00025d50: 2c20 5472 7565 2c20 4661 6c73 652c 2054  , True, False, T
-00025d60: 7275 655d 290a 2020 2020 2020 2020 7064  rue]).        pd
-00025d70: 2e74 6573 7469 6e67 2e61 7373 6572 745f  .testing.assert_
-00025d80: 7365 7269 6573 5f65 7175 616c 2876 616c  series_equal(val
-00025d90: 6964 2c20 6578 7065 6374 6564 290a 0a0a  id, expected)...
-00025da0: 636c 6173 7320 5465 7374 4669 7865 6449  class TestFixedI
-00025db0: 6e63 7265 6d65 6e74 7328 293a 0a0a 2020  ncrements():..  
-00025dc0: 2020 6465 6620 7465 7374 5f5f 7661 6c69    def test__vali
-00025dd0: 6461 7465 5f69 6e70 7574 7328 7365 6c66  date_inputs(self
-00025de0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-00025df0: 7374 2074 6865 2060 6046 6978 6564 496e  st the ``FixedIn
-00025e00: 6372 656d 656e 7473 2e5f 7661 6c69 6461  crements._valida
-00025e10: 7465 5f69 6e70 7574 7360 6020 6d65 7468  te_inputs`` meth
-00025e20: 6f64 2e0a 0a20 2020 2020 2020 2049 6e70  od...        Inp
-00025e30: 7574 3a0a 2020 2020 2020 2020 2d20 2049  ut:.        -  I
-00025e40: 6e63 6f72 7265 6374 2070 6172 616d 6574  ncorrect paramet
-00025e50: 6572 7320 666f 7220 7468 6520 6d65 7468  ers for the meth
-00025e60: 6f64 0a20 2020 2020 2020 2052 6169 7365  od.        Raise
-00025e70: 733a 0a20 2020 2020 2020 202d 204c 6973  s:.        - Lis
-00025e80: 7420 6f66 2056 616c 7565 4572 726f 7273  t of ValueErrors
-00025e90: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00025ea0: 2020 2020 2065 7272 5f6d 7367 203d 2028       err_msg = (
-00025eb0: 0a20 2020 2020 2020 2020 2020 2072 274d  .            r'M
-00025ec0: 6973 7369 6e67 2072 6571 7569 7265 6420  issing required 
-00025ed0: 7661 6c75 6573 207b 282e 2a29 7d20 696e  values {(.*)} in
-00025ee0: 2061 2046 6978 6564 496e 6372 656d 656e   a FixedIncremen
-00025ef0: 7473 2063 6f6e 7374 7261 696e 742e 270a  ts constraint.'.
-00025f00: 2020 2020 2020 2020 2020 2020 7227 5c6e              r'\n
-00025f10: 5c6e 496e 7661 6c69 6420 7661 6c75 6573  \nInvalid values
-00025f20: 207b 282e 2a29 7d20 6172 6520 7072 6573   {(.*)} are pres
-00025f30: 656e 7420 696e 2061 2046 6978 6564 496e  ent in a FixedIn
-00025f40: 6372 656d 656e 7473 2063 6f6e 7374 7261  crements constra
-00025f50: 696e 742e 270a 2020 2020 2020 2020 2020  int.'.          
-00025f60: 2020 7227 5c6e 5c6e 496e 7661 6c69 6420    r'\n\nInvalid 
-00025f70: 696e 6372 656d 656e 7420 7661 6c75 6520  increment value 
-00025f80: 7b28 2e2a 297d 2069 6e20 6120 4669 7865  {(.*)} in a Fixe
-00025f90: 6449 6e63 7265 6d65 6e74 7320 636f 6e73  dIncrements cons
-00025fa0: 7472 6169 6e74 2e27 0a20 2020 2020 2020  traint.'.       
-00025fb0: 2020 2020 2027 2049 6e63 7265 6d65 6e74       ' Increment
-00025fc0: 7320 6d75 7374 2062 6520 706f 7369 7469  s must be positi
-00025fd0: 7665 2069 6e74 6567 6572 732e 270a 2020  ve integers.'.  
-00025fe0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00025ff0: 2320 5275 6e20 2f20 4173 7365 7274 0a20  # Run / Assert. 
-00026000: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
-00026010: 7374 2e72 6169 7365 7328 4167 6772 6567  st.raises(Aggreg
-00026020: 6174 6543 6f6e 7374 7261 696e 7473 4572  ateConstraintsEr
-00026030: 726f 7229 2061 7320 6572 726f 723a 0a20  ror) as error:. 
-00026040: 2020 2020 2020 2020 2020 2046 6978 6564             Fixed
-00026050: 496e 6372 656d 656e 7473 2e5f 7661 6c69  Increments._vali
-00026060: 6461 7465 5f69 6e70 7574 7328 0a20 2020  date_inputs(.   
-00026070: 2020 2020 2020 2020 2020 2020 206e 6f74               not
-00026080: 5f63 6f6c 756d 6e5f 6e61 6d65 3d4e 6f6e  _column_name=Non
-00026090: 652c 2069 6e63 7265 6d65 6e74 5f76 616c  e, increment_val
-000260a0: 7565 3d2d 312c 2073 6f6d 6574 6869 6e67  ue=-1, something
-000260b0: 5f65 6c73 653d 4e6f 6e65 290a 0a20 2020  _else=None)..   
-000260c0: 2020 2020 2067 726f 7570 7320 3d20 7265       groups = re
-000260d0: 2e73 6561 7263 6828 6572 725f 6d73 672c  .search(err_msg,
-000260e0: 2073 7472 2865 7272 6f72 2e76 616c 7565   str(error.value
-000260f0: 2929 0a20 2020 2020 2020 2061 7373 6572  )).        asser
-00026100: 7420 6772 6f75 7073 2069 7320 6e6f 7420  t groups is not 
-00026110: 4e6f 6e65 0a20 2020 2020 2020 2061 7373  None.        ass
-00026120: 6572 7420 7374 7228 6576 616c 2867 726f  ert str(eval(gro
-00026130: 7570 732e 6772 6f75 7028 3129 2929 203d  ups.group(1))) =
-00026140: 3d20 2763 6f6c 756d 6e5f 6e61 6d65 270a  = 'column_name'.
-00026150: 2020 2020 2020 2020 6173 7365 7274 2073          assert s
-00026160: 6574 2865 7661 6c28 6772 6f75 7073 2e67  et(eval(groups.g
-00026170: 726f 7570 2832 2929 2920 3d3d 207b 2773  roup(2))) == {'s
-00026180: 6f6d 6574 6869 6e67 5f65 6c73 6527 2c20  omething_else', 
-00026190: 276e 6f74 5f63 6f6c 756d 6e5f 6e61 6d65  'not_column_name
-000261a0: 277d 0a20 2020 2020 2020 2061 7373 6572  '}.        asser
-000261b0: 7420 696e 7428 6576 616c 2867 726f 7570  t int(eval(group
-000261c0: 732e 6772 6f75 7028 3329 2929 203d 3d20  s.group(3))) == 
-000261d0: 2d31 0a0a 2020 2020 6465 6620 7465 7374  -1..    def test
-000261e0: 5f5f 7661 6c69 6461 7465 5f6d 6574 6164  __validate_metad
-000261f0: 6174 615f 636f 6c75 6d6e 7328 7365 6c66  ata_columns(self
-00026200: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
-00026210: 7374 2074 6865 2060 605f 7661 6c69 6461  st the ``_valida
-00026220: 7465 5f6d 6574 6164 6174 615f 636f 6c75  te_metadata_colu
-00026230: 6d6e 7360 6020 6d65 7468 6f64 2e0a 0a20  mns`` method... 
-00026240: 2020 2020 2020 2054 6865 2063 6f6c 756d         The colum
-00026250: 6e20 7061 7373 6564 2069 6e20 636f 6c75  n passed in colu
-00026260: 6d6e 5f6e 616d 6520 7368 6f75 6c64 2062  mn_name should b
-00026270: 6520 696e 2074 6865 206d 6574 6164 6174  e in the metadat
-00026280: 612e 0a0a 2020 2020 2020 2020 496e 7075  a...        Inpu
-00026290: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-000262a0: 2063 6f6c 756d 6e5f 6e61 6d65 2074 6861   column_name tha
-000262b0: 7420 6973 2069 6e20 7468 6520 6d65 7461  t is in the meta
-000262c0: 6461 7461 2e0a 0a20 2020 2020 2020 2053  data...        S
-000262d0: 6964 6520 6566 6665 6374 3a0a 2020 2020  ide effect:.    
-000262e0: 2020 2020 2020 2020 2d20 4e6f 2065 7272          - No err
-000262f0: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
-00026300: 7365 642e 0a20 2020 2020 2020 2022 2222  sed..        """
-00026310: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-00026320: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
-00026330: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
-00026340: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
-00026350: 6d6e 7320 3d20 7b27 6127 3a20 312c 2027  mns = {'a': 1, '
-00026360: 6227 3a20 327d 0a0a 2020 2020 2020 2020  b': 2}..        
-00026370: 2320 5275 6e0a 2020 2020 2020 2020 4669  # Run.        Fi
-00026380: 7865 6449 6e63 7265 6d65 6e74 732e 5f76  xedIncrements._v
-00026390: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
-000263a0: 5f63 6f6c 756d 6e73 286d 6574 6164 6174  _columns(metadat
-000263b0: 612c 2063 6f6c 756d 6e5f 6e61 6d65 3d27  a, column_name='
-000263c0: 6127 290a 0a20 2020 2064 6566 2074 6573  a')..    def tes
-000263d0: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
-000263e0: 6461 7461 5f63 6f6c 756d 6e73 5f72 6169  data_columns_rai
-000263f0: 7365 735f 6572 726f 7228 7365 6c66 293a  ses_error(self):
-00026400: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
-00026410: 2074 6865 2060 605f 7661 6c69 6461 7465   the ``_validate
-00026420: 5f6d 6574 6164 6174 615f 636f 6c75 6d6e  _metadata_column
-00026430: 7360 6020 6d65 7468 6f64 2773 2065 7272  s`` method's err
-00026440: 6f72 2063 6f6e 6469 7469 6f6e 2e0a 0a20  or condition... 
-00026450: 2020 2020 2020 2049 6620 636f 6c75 6d6e         If column
-00026460: 5f6e 616d 6520 6973 206e 6f74 2069 6e20  _name is not in 
-00026470: 7468 6520 6d65 7461 6461 7461 2c20 616e  the metadata, an
-00026480: 2065 7272 6f72 2073 686f 756c 6420 6265   error should be
-00026490: 2072 6169 7365 642e 0a0a 2020 2020 2020   raised...      
-000264a0: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
-000264b0: 2020 2020 202d 2063 6f6c 756d 6e5f 6e61       - column_na
-000264c0: 6d65 2074 6861 7420 6973 206e 6f74 2069  me that is not i
-000264d0: 6e20 7468 6520 6d65 7461 6461 7461 2e0a  n the metadata..
-000264e0: 0a20 2020 2020 2020 2053 6964 6520 6566  .        Side ef
-000264f0: 6665 6374 3a0a 2020 2020 2020 2020 2020  fect:.          
-00026500: 2020 2d20 436f 6e73 7472 6169 6e74 4d65    - ConstraintMe
-00026510: 7461 6461 7461 4572 726f 7220 7368 6f75  tadataError shou
-00026520: 6c64 2062 6520 7261 6973 6564 2e0a 2020  ld be raised..  
-00026530: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00026540: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
-00026550: 2020 6d65 7461 6461 7461 203d 204d 6f63    metadata = Moc
-00026560: 6b28 290a 2020 2020 2020 2020 6d65 7461  k().        meta
-00026570: 6461 7461 2e63 6f6c 756d 6e73 203d 207b  data.columns = {
-00026580: 2761 273a 2031 2c20 2762 273a 2032 7d0a  'a': 1, 'b': 2}.
-00026590: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
-000265a0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-000265b0: 7361 6765 203d 2072 652e 6573 6361 7065  sage = re.escape
-000265c0: 280a 2020 2020 2020 2020 2020 2020 2741  (.            'A
-000265d0: 2046 6978 6564 496e 6372 656d 656e 7473   FixedIncrements
-000265e0: 2063 6f6e 7374 7261 696e 7420 6973 2062   constraint is b
-000265f0: 6569 6e67 2061 7070 6c69 6564 2074 6f20  eing applied to 
-00026600: 696e 7661 6c69 6420 636f 6c75 6d6e 206e  invalid column n
-00026610: 616d 6573 2027 0a20 2020 2020 2020 2020  ames '.         
-00026620: 2020 2022 7b27 6327 7d2e 2054 6865 2063     "{'c'}. The c
-00026630: 6f6c 756d 6e73 206d 7573 7420 6578 6973  olumns must exis
-00026640: 7420 696e 2074 6865 2074 6162 6c65 2e22  t in the table."
-00026650: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00026660: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-00026670: 6169 7365 7328 436f 6e73 7472 6169 6e74  aises(Constraint
-00026680: 4d65 7461 6461 7461 4572 726f 722c 206d  MetadataError, m
-00026690: 6174 6368 3d65 7272 6f72 5f6d 6573 7361  atch=error_messa
-000266a0: 6765 293a 0a20 2020 2020 2020 2020 2020  ge):.           
-000266b0: 2046 6978 6564 496e 6372 656d 656e 7473   FixedIncrements
-000266c0: 2e5f 7661 6c69 6461 7465 5f6d 6574 6164  ._validate_metad
-000266d0: 6174 615f 636f 6c75 6d6e 7328 6d65 7461  ata_columns(meta
-000266e0: 6461 7461 2c20 636f 6c75 6d6e 5f6e 616d  data, column_nam
-000266f0: 653d 2763 2729 0a0a 2020 2020 6465 6620  e='c')..    def 
-00026700: 7465 7374 5f5f 5f69 6e69 745f 5f28 7365  test___init__(se
-00026710: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00026720: 5465 7374 2074 6865 2060 6046 6978 6564  Test the ``Fixed
-00026730: 496e 6372 656d 656e 7473 2e5f 5f69 6e69  Increments.__ini
-00026740: 745f 5f60 6020 6d65 7468 6f64 2e0a 0a20  t__`` method... 
-00026750: 2020 2020 2020 2054 6865 2060 6063 6f6c         The ``col
-00026760: 756d 6e5f 6e61 6d65 6060 2061 6e64 2060  umn_name`` and `
-00026770: 6069 6e63 7265 6d65 6e74 5f76 616c 7565  `increment_value
-00026780: 6060 2069 6e73 7461 6e63 6520 7661 7269  `` instance vari
-00026790: 6162 6c65 7320 7368 6f75 6c64 2062 6520  ables should be 
-000267a0: 7365 742e 0a0a 2020 2020 2020 2020 496e  set...        In
-000267b0: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
-000267c0: 202d 2063 6f6c 756d 6e20 6e61 6d65 2061   - column name a
-000267d0: 7320 6120 7374 7269 6e67 2e0a 2020 2020  s a string..    
-000267e0: 2020 2020 2020 2020 2d20 696e 6372 656d          - increm
-000267f0: 656e 745f 7661 6c75 6520 6173 2061 6e20  ent_value as an 
-00026800: 696e 742e 0a0a 2020 2020 2020 2020 4578  int...        Ex
-00026810: 7065 6374 6564 2062 6568 6176 696f 723a  pected behavior:
-00026820: 0a20 2020 2020 2020 2020 2020 202d 2049  .            - I
-00026830: 6e73 7461 6e63 6520 7769 7468 2060 6063  nstance with ``c
-00026840: 6f6c 756d 6e5f 6e61 6d65 6060 2061 6e64  olumn_name`` and
-00026850: 2060 6069 6e63 7265 6d65 6e74 5f76 616c   ``increment_val
-00026860: 7565 6060 2073 6574 2e0a 2020 2020 2020  ue`` set..      
-00026870: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
-00026880: 5275 6e0a 2020 2020 2020 2020 696e 7374  Run.        inst
-00026890: 616e 6365 203d 2046 6978 6564 496e 6372  ance = FixedIncr
-000268a0: 656d 656e 7473 2863 6f6c 756d 6e5f 6e61  ements(column_na
-000268b0: 6d65 3d27 636f 6c75 6d6e 272c 2069 6e63  me='column', inc
-000268c0: 7265 6d65 6e74 5f76 616c 7565 3d35 290a  rement_value=5).
-000268d0: 0a20 2020 2020 2020 2023 2041 7373 6572  .        # Asser
-000268e0: 740a 2020 2020 2020 2020 6173 7365 7274  t.        assert
-000268f0: 2069 6e73 7461 6e63 652e 636f 6c75 6d6e   instance.column
-00026900: 5f6e 616d 6520 3d3d 2027 636f 6c75 6d6e  _name == 'column
-00026910: 270a 2020 2020 2020 2020 6173 7365 7274  '.        assert
-00026920: 2069 6e73 7461 6e63 652e 696e 6372 656d   instance.increm
-00026930: 656e 745f 7661 6c75 6520 3d3d 2035 0a20  ent_value == 5. 
-00026940: 2020 2020 2020 2061 7373 6572 7420 696e         assert in
-00026950: 7374 616e 6365 2e63 6f6e 7374 7261 696e  stance.constrain
-00026960: 745f 636f 6c75 6d6e 7320 3d3d 2028 2763  t_columns == ('c
-00026970: 6f6c 756d 6e27 2c20 290a 0a20 2020 2064  olumn', )..    d
-00026980: 6566 2074 6573 745f 5f5f 696e 6974 5f5f  ef test___init__
-00026990: 5f69 6e63 7265 6d65 6e74 5f76 616c 7565  _increment_value
-000269a0: 5f69 735f 6e65 6761 7469 7665 5f6e 756d  _is_negative_num
-000269b0: 6265 7228 7365 6c66 293a 0a20 2020 2020  ber(self):.     
-000269c0: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-000269d0: 6046 6978 6564 496e 6372 656d 656e 7473  `FixedIncrements
-000269e0: 2e5f 5f69 6e69 745f 5f20 6d65 7468 6f64  .__init__ method
-000269f0: 2077 6974 6820 6120 6e65 6761 7469 7665   with a negative
-00026a00: 2069 6e63 7265 6d65 6e74 2e0a 0a20 2020   increment...   
-00026a10: 2020 2020 2049 6620 7468 6520 6060 696e       If the ``in
-00026a20: 6372 656d 656e 745f 7661 6c75 6560 6020  crement_value`` 
-00026a30: 6973 206c 6573 7320 7468 616e 206f 7220  is less than or 
-00026a40: 6571 7561 6c20 746f 2030 2c20 7468 656e  equal to 0, then
-00026a50: 2061 6e20 6572 726f 7220 7368 6f75 6c64   an error should
-00026a60: 2062 6520 7261 6973 6564 2e0a 0a20 2020   be raised...   
-00026a70: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
-00026a80: 2020 2020 2020 2020 2d20 636f 6c75 6d6e          - column
-00026a90: 206e 616d 6520 6173 2061 2073 7472 696e   name as a strin
-00026aa0: 672e 0a20 2020 2020 2020 2020 2020 202d  g..            -
-00026ab0: 2069 6e63 7265 6d65 6e74 5f76 616c 7565   increment_value
-00026ac0: 2061 7320 2d31 0a0a 2020 2020 2020 2020   as -1..        
-00026ad0: 4578 7065 6374 6564 2062 6568 6176 696f  Expected behavio
-00026ae0: 723a 0a20 2020 2020 2020 2020 2020 202d  r:.            -
-00026af0: 2060 6056 616c 7565 4572 726f 7260 6020   ``ValueError`` 
-00026b00: 7368 6f75 6c64 2062 6520 7261 6973 6564  should be raised
-00026b10: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00026b20: 2020 2020 2020 2320 5275 6e20 2f20 4173        # Run / As
-00026b30: 7365 7274 0a20 2020 2020 2020 2065 7272  sert.        err
-00026b40: 6f72 5f6d 6573 7361 6765 203d 2027 5468  or_message = 'Th
-00026b50: 6520 696e 6372 656d 656e 745f 7661 6c75  e increment_valu
-00026b60: 6520 6d75 7374 2062 6520 6772 6561 7465  e must be greate
-00026b70: 7220 7468 616e 2030 2e27 0a20 2020 2020  r than 0.'.     
-00026b80: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
-00026b90: 6169 7365 7328 5661 6c75 6545 7272 6f72  aises(ValueError
-00026ba0: 2c20 6d61 7463 683d 6572 726f 725f 6d65  , match=error_me
-00026bb0: 7373 6167 6529 3a0a 2020 2020 2020 2020  ssage):.        
-00026bc0: 2020 2020 4669 7865 6449 6e63 7265 6d65      FixedIncreme
-00026bd0: 6e74 7328 636f 6c75 6d6e 5f6e 616d 653d  nts(column_name=
-00026be0: 2763 6f6c 756d 6e27 2c20 696e 6372 656d  'column', increm
-00026bf0: 656e 745f 7661 6c75 653d 2d31 290a 0a20  ent_value=-1).. 
-00026c00: 2020 2064 6566 2074 6573 745f 5f5f 696e     def test___in
-00026c10: 6974 5f5f 5f69 6e63 7265 6d65 6e74 5f76  it___increment_v
-00026c20: 616c 7565 5f69 735f 6465 6369 6d61 6c28  alue_is_decimal(
-00026c30: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00026c40: 2222 5465 7374 2074 6865 2060 6046 6978  ""Test the ``Fix
-00026c50: 6564 496e 6372 656d 656e 7473 2e5f 5f69  edIncrements.__i
-00026c60: 6e69 745f 5f20 6d65 7468 6f64 2077 6974  nit__ method wit
-00026c70: 6820 6120 6465 6369 6d61 6c20 6173 2061  h a decimal as a
-00026c80: 6e20 696e 6372 656d 656e 742e 0a0a 2020  n increment...  
-00026c90: 2020 2020 2020 4966 2074 6865 2060 6069        If the ``i
-00026ca0: 6e63 7265 6d65 6e74 5f76 616c 7565 6060  ncrement_value``
-00026cb0: 2069 7320 6e6f 7420 6120 7768 6f6c 6520   is not a whole 
-00026cc0: 6e75 6d62 6572 2c20 7468 656e 2061 6e20  number, then an 
-00026cd0: 6572 726f 7220 7368 6f75 6c64 2062 6520  error should be 
-00026ce0: 7261 6973 6564 2e0a 0a20 2020 2020 2020  raised...       
-00026cf0: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
-00026d00: 2020 2020 2d20 636f 6c75 6d6e 206e 616d      - column nam
-00026d10: 6520 6173 2061 2073 7472 696e 672e 0a20  e as a string.. 
-00026d20: 2020 2020 2020 2020 2020 202d 2069 6e63             - inc
-00026d30: 7265 6d65 6e74 5f76 616c 7565 2061 7320  rement_value as 
-00026d40: 312e 350a 0a20 2020 2020 2020 2045 7870  1.5..        Exp
-00026d50: 6563 7465 6420 6265 6861 7669 6f72 3a0a  ected behavior:.
-00026d60: 2020 2020 2020 2020 2020 2020 2d20 6060              - ``
-00026d70: 5661 6c75 6545 7272 6f72 6060 2073 686f  ValueError`` sho
-00026d80: 756c 6420 6265 2072 6169 7365 642e 0a20  uld be raised.. 
-00026d90: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00026da0: 2020 2023 2052 756e 202f 2041 7373 6572     # Run / Asser
-00026db0: 740a 2020 2020 2020 2020 6572 726f 725f  t.        error_
-00026dc0: 6d65 7373 6167 6520 3d20 2754 6865 2069  message = 'The i
-00026dd0: 6e63 7265 6d65 6e74 5f76 616c 7565 206d  ncrement_value m
-00026de0: 7573 7420 6265 2061 2077 686f 6c65 206e  ust be a whole n
-00026df0: 756d 6265 722e 270a 2020 2020 2020 2020  umber.'.        
-00026e00: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
-00026e10: 6573 2856 616c 7565 4572 726f 722c 206d  es(ValueError, m
-00026e20: 6174 6368 3d65 7272 6f72 5f6d 6573 7361  atch=error_messa
-00026e30: 6765 293a 0a20 2020 2020 2020 2020 2020  ge):.           
-00026e40: 2046 6978 6564 496e 6372 656d 656e 7473   FixedIncrements
-00026e50: 2863 6f6c 756d 6e5f 6e61 6d65 3d27 636f  (column_name='co
-00026e60: 6c75 6d6e 272c 2069 6e63 7265 6d65 6e74  lumn', increment
-00026e70: 5f76 616c 7565 3d31 2e35 290a 0a20 2020  _value=1.5)..   
-00026e80: 2064 6566 2074 6573 745f 5f66 6974 2873   def test__fit(s
-00026e90: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00026ea0: 2254 6573 7420 7468 6520 6060 4669 7865  "Test the ``Fixe
-00026eb0: 6449 6e63 7265 6d65 6e74 732e 5f66 6974  dIncrements._fit
-00026ec0: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
-00026ed0: 2020 2020 5468 6520 6060 6669 7460 6020      The ``fit`` 
-00026ee0: 6d65 7468 6f64 2073 686f 756c 6420 7374  method should st
-00026ef0: 6f72 6520 7468 6520 6474 7970 6520 6f66  ore the dtype of
-00026f00: 2074 6865 2044 6174 6146 7261 6d65 2e0a   the DataFrame..
-00026f10: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-00026f20: 2020 2020 2020 2020 2020 2020 2d20 4120              - A 
-00026f30: 6060 7061 6e64 6173 2e44 6174 6146 7261  ``pandas.DataFra
-00026f40: 6d65 6060 2077 6974 6820 6120 666c 6f61  me`` with a floa
-00026f50: 7420 6474 7970 652e 0a0a 2020 2020 2020  t dtype...      
-00026f60: 2020 4578 7065 6374 6564 2062 6568 6176    Expected behav
-00026f70: 696f 723a 0a20 2020 2020 2020 2020 2020  ior:.           
-00026f80: 202d 2054 6865 2060 6069 6e73 7461 6e63   - The ``instanc
-00026f90: 652e 5f64 7479 7065 6060 2073 686f 756c  e._dtype`` shoul
-00026fa0: 6420 6265 2073 6574 2074 6f20 666c 6f61  d be set to floa
-00026fb0: 742e 0a20 2020 2020 2020 2022 2222 0a20  t..        """. 
-00026fc0: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
-00026fd0: 2020 2020 2020 2064 6174 6120 3d20 7064         data = pd
-00026fe0: 2e44 6174 6146 7261 6d65 287b 2763 6f6c  .DataFrame({'col
-00026ff0: 756d 6e27 3a20 5b37 2c20 3134 2c20 3231  umn': [7, 14, 21
-00027000: 5d7d 2c20 6474 7970 653d 666c 6f61 7429  ]}, dtype=float)
-00027010: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
-00027020: 6520 3d20 4669 7865 6449 6e63 7265 6d65  e = FixedIncreme
-00027030: 6e74 7328 636f 6c75 6d6e 5f6e 616d 653d  nts(column_name=
-00027040: 2763 6f6c 756d 6e27 2c20 696e 6372 656d  'column', increm
-00027050: 656e 745f 7661 6c75 653d 3729 0a0a 2020  ent_value=7)..  
-00027060: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
-00027070: 2020 2020 696e 7374 616e 6365 2e5f 6669      instance._fi
-00027080: 7428 6461 7461 290a 0a20 2020 2020 2020  t(data)..       
-00027090: 2023 2041 7373 6572 740a 2020 2020 2020   # Assert.      
-000270a0: 2020 6173 7365 7274 2069 6e73 7461 6e63    assert instanc
-000270b0: 652e 5f64 7479 7065 203d 3d20 666c 6f61  e._dtype == floa
-000270c0: 740a 0a20 2020 2064 6566 2074 6573 745f  t..    def test_
-000270d0: 6973 5f76 616c 6964 2873 656c 6629 3a0a  is_valid(self):.
-000270e0: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
-000270f0: 7468 6520 6060 4669 7865 6449 6e63 7265  the ``FixedIncre
-00027100: 6d65 6e74 732e 6973 5f76 616c 6964 6060  ments.is_valid``
-00027110: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
-00027120: 2020 5468 6520 6060 6973 5f76 616c 6964    The ``is_valid
-00027130: 6060 206d 6574 686f 6420 7368 6f75 6c64  `` method should
-00027140: 2072 6574 7572 6e20 6060 5472 7565 6060   return ``True``
-00027150: 2066 6f72 2072 6f77 7320 7468 6174 2061   for rows that a
-00027160: 7265 204e 614e 206f 7220 6576 656e 6c79  re NaN or evenly
-00027170: 2064 6976 6973 6962 6c65 0a20 2020 2020   divisible.     
-00027180: 2020 2062 7920 7468 6520 696e 6372 656d     by the increm
-00027190: 656e 742e 0a0a 2020 2020 2020 2020 496e  ent...        In
-000271a0: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
-000271b0: 202d 2041 2060 6070 616e 6461 732e 4461   - A ``pandas.Da
-000271c0: 7461 4672 616d 6560 6020 7769 7468 206f  taFrame`` with o
-000271d0: 6e65 2063 6f6c 756d 6e20 636f 6e74 6169  ne column contai
-000271e0: 6e69 6e67 2073 6f6d 6520 4e61 4e73 2c20  ning some NaNs, 
-000271f0: 736f 6d65 206e 756d 6265 7273 2074 6861  some numbers tha
-00027200: 7420 6172 650a 2020 2020 2020 2020 2020  t are.          
-00027210: 2020 6469 7669 7369 626c 6520 6279 2074    divisible by t
-00027220: 6865 2069 6e63 7265 6d65 6e74 2061 6e64  he increment and
-00027230: 2073 6f6d 6520 6e75 6d62 6572 7320 7468   some numbers th
-00027240: 6174 2061 7265 206e 6f74 2e0a 0a20 2020  at are not...   
-00027250: 2020 2020 204f 7574 7075 743a 0a20 2020       Output:.   
-00027260: 2020 2020 2020 2020 202d 2041 2060 6070           - A ``p
-00027270: 616e 6461 732e 5365 7269 6573 6060 2077  andas.Series`` w
-00027280: 6865 7265 2061 6c6c 2074 6865 2072 6f77  here all the row
-00027290: 7320 7468 6174 2061 7265 204e 614e 206f  s that are NaN o
-000272a0: 7220 6469 7669 7369 626c 6520 6279 2074  r divisible by t
-000272b0: 6865 2069 6e63 7265 6d65 6e74 2061 7265  he increment are
-000272c0: 0a20 2020 2020 2020 2020 2020 2060 6054  .            ``T
-000272d0: 7275 6560 602e 0a20 2020 2020 2020 2022  rue``..        "
-000272e0: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
-000272f0: 7570 0a20 2020 2020 2020 2064 6174 6120  up.        data 
-00027300: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
-00027310: 2763 6f6c 756d 6e27 3a20 5b37 2c20 3134  'column': [7, 14
-00027320: 2c20 6e70 2e6e 616e 2c20 3230 2c20 382c  , np.nan, 20, 8,
-00027330: 2033 355d 7d2c 2064 7479 7065 3d66 6c6f   35]}, dtype=flo
-00027340: 6174 290a 2020 2020 2020 2020 696e 7374  at).        inst
-00027350: 616e 6365 203d 2046 6978 6564 496e 6372  ance = FixedIncr
-00027360: 656d 656e 7473 2863 6f6c 756d 6e5f 6e61  ements(column_na
-00027370: 6d65 3d27 636f 6c75 6d6e 272c 2069 6e63  me='column', inc
-00027380: 7265 6d65 6e74 5f76 616c 7565 3d37 290a  rement_value=7).
-00027390: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
-000273a0: 2020 2020 2020 2069 735f 7661 6c69 6420         is_valid 
-000273b0: 3d20 696e 7374 616e 6365 2e69 735f 7661  = instance.is_va
-000273c0: 6c69 6428 6461 7461 290a 0a20 2020 2020  lid(data)..     
-000273d0: 2020 2023 2041 7373 6572 740a 2020 2020     # Assert.    
-000273e0: 2020 2020 6578 7065 6374 6564 203d 2070      expected = p
-000273f0: 642e 5365 7269 6573 285b 5472 7565 2c20  d.Series([True, 
-00027400: 5472 7565 2c20 5472 7565 2c20 4661 6c73  True, True, Fals
-00027410: 652c 2046 616c 7365 2c20 5472 7565 5d2c  e, False, True],
-00027420: 206e 616d 653d 2763 6f6c 756d 6e27 290a   name='column').
-00027430: 2020 2020 2020 2020 7064 2e74 6573 7469          pd.testi
-00027440: 6e67 2e61 7373 6572 745f 7365 7269 6573  ng.assert_series
-00027450: 5f65 7175 616c 2869 735f 7661 6c69 642c  _equal(is_valid,
-00027460: 2065 7870 6563 7465 6429 0a0a 2020 2020   expected)..    
-00027470: 6465 6620 7465 7374 5f5f 7472 616e 7366  def test__transf
-00027480: 6f72 6d28 7365 6c66 293a 0a20 2020 2020  orm(self):.     
-00027490: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
-000274a0: 6046 6978 6564 496e 6372 656d 656e 7473  `FixedIncrements
-000274b0: 2e5f 7472 616e 7366 6f72 6d60 6020 6d65  ._transform`` me
-000274c0: 7468 6f64 2e0a 0a20 2020 2020 2020 2054  thod...        T
-000274d0: 6865 2060 605f 7472 616e 7366 6f72 6d60  he ``_transform`
-000274e0: 6020 6d65 7468 6f64 2073 686f 756c 6420  ` method should 
-000274f0: 6469 7669 6465 2061 6c6c 2076 616c 7565  divide all value
-00027500: 7320 696e 2074 6865 2064 6174 6120 6279  s in the data by
-00027510: 2074 6865 2060 6069 6e63 7265 6d65 6e74   the ``increment
-00027520: 5f76 616c 7565 6060 2e0a 0a20 2020 2020  _value``...     
-00027530: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
-00027540: 2020 2020 2020 2d20 4120 6060 7064 2e44        - A ``pd.D
-00027550: 6174 6146 7261 6d65 6060 2077 6974 6820  ataFrame`` with 
-00027560: 6f6e 6520 636f 6c75 6d6e 2063 6f6e 7461  one column conta
-00027570: 696e 696e 6720 4e61 4e73 2061 6e64 2076  ining NaNs and v
-00027580: 616c 7565 7320 6469 7669 7369 626c 6520  alues divisible 
-00027590: 6279 2074 6865 0a20 2020 2020 2020 2020  by the.         
-000275a0: 2020 2060 6069 6e63 7265 6d65 6e74 5f76     ``increment_v
-000275b0: 616c 7565 6060 2e0a 0a20 2020 2020 2020  alue``...       
-000275c0: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
-000275d0: 2020 2020 202d 2041 2060 6070 642e 4461       - A ``pd.Da
-000275e0: 7461 4672 616d 6560 6020 7769 7468 2061  taFrame`` with a
-000275f0: 6c6c 2074 6865 2076 616c 7565 7320 696e  ll the values in
-00027600: 2074 6861 7420 636f 6c75 6d6e 2064 6976   that column div
-00027610: 6964 6564 2062 7920 7468 650a 2020 2020  ided by the.    
-00027620: 2020 2020 2020 2020 6060 696e 6372 656d          ``increm
-00027630: 656e 745f 7661 6c75 6560 6020 616e 6420  ent_value`` and 
-00027640: 7468 6520 4e61 4e73 206c 6566 7420 616c  the NaNs left al
-00027650: 6f6e 652e 0a20 2020 2020 2020 2022 2222  one..        """
-00027660: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
-00027670: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-00027680: 7064 2e44 6174 6146 7261 6d65 287b 2763  pd.DataFrame({'c
-00027690: 6f6c 756d 6e27 3a20 5b37 2c20 3134 2c20  olumn': [7, 14, 
-000276a0: 6e70 2e6e 616e 2c20 3335 5d7d 290a 2020  np.nan, 35]}).  
-000276b0: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
-000276c0: 2046 6978 6564 496e 6372 656d 656e 7473   FixedIncrements
-000276d0: 2863 6f6c 756d 6e5f 6e61 6d65 3d27 636f  (column_name='co
-000276e0: 6c75 6d6e 272c 2069 6e63 7265 6d65 6e74  lumn', increment
-000276f0: 5f76 616c 7565 3d37 290a 0a20 2020 2020  _value=7)..     
-00027700: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
-00027710: 2074 7261 6e73 666f 726d 6564 203d 2069   transformed = i
-00027720: 6e73 7461 6e63 652e 5f74 7261 6e73 666f  nstance._transfo
-00027730: 726d 2864 6174 6129 0a0a 2020 2020 2020  rm(data)..      
-00027740: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
-00027750: 2020 2065 7870 6563 7465 6420 3d20 7064     expected = pd
-00027760: 2e44 6174 6146 7261 6d65 287b 2763 6f6c  .DataFrame({'col
-00027770: 756d 6e27 3a20 5b31 2c20 322c 206e 702e  umn': [1, 2, np.
-00027780: 6e61 6e2c 2035 5d7d 290a 2020 2020 2020  nan, 5]}).      
-00027790: 2020 7064 2e74 6573 7469 6e67 2e61 7373    pd.testing.ass
-000277a0: 6572 745f 6672 616d 655f 6571 7561 6c28  ert_frame_equal(
-000277b0: 7472 616e 7366 6f72 6d65 642c 2065 7870  transformed, exp
-000277c0: 6563 7465 6429 0a0a 2020 2020 6465 6620  ected)..    def 
-000277d0: 7465 7374 5f72 6576 6572 7365 5f74 7261  test_reverse_tra
-000277e0: 6e73 666f 726d 2873 656c 6629 3a0a 2020  nsform(self):.  
-000277f0: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
-00027800: 6520 6060 4669 7865 6449 6e63 7265 6d65  e ``FixedIncreme
-00027810: 6e74 732e 7265 7665 7273 655f 7472 616e  nts.reverse_tran
-00027820: 7366 6f72 6d60 6020 6d65 7468 6f64 2e0a  sform`` method..
-00027830: 0a20 2020 2020 2020 2054 6865 2060 6072  .        The ``r
-00027840: 6576 6572 7365 5f74 7261 6e73 666f 726d  everse_transform
-00027850: 6060 206d 6574 686f 6420 7368 6f75 6c64  `` method should
-00027860: 2072 6f75 6e64 2061 6c6c 2073 616d 706c   round all sampl
-00027870: 6564 2076 616c 7565 7320 746f 2074 6865  ed values to the
-00027880: 206e 6561 7265 7374 2069 6e74 2c0a 2020   nearest int,.  
-00027890: 2020 2020 2020 616e 6420 7468 656e 206d        and then m
-000278a0: 756c 7469 706c 7920 7468 656d 2062 7920  ultiply them by 
-000278b0: 7468 6520 6060 696e 6372 656d 656e 745f  the ``increment_
-000278c0: 7661 6c75 6560 6020 616e 6420 636f 6e76  value`` and conv
-000278d0: 6572 7420 7468 656d 2074 6f20 7468 6520  ert them to the 
-000278e0: 6060 5f64 7479 7065 6060 2e0a 0a20 2020  ``_dtype``...   
-000278f0: 2020 2020 2053 6574 7570 3a0a 2020 2020       Setup:.    
-00027900: 2020 2020 2020 2020 2d20 5365 7420 7468          - Set th
-00027910: 6520 6060 5f64 7479 7065 6060 2074 6f20  e ``_dtype`` to 
-00027920: 696e 7436 342e 0a0a 2020 2020 2020 2020  int64...        
-00027930: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
-00027940: 2020 202d 2041 2060 6070 616e 6461 732e     - A ``pandas.
-00027950: 4461 7461 4672 616d 6560 6020 7769 7468  DataFrame`` with
-00027960: 2066 6c6f 6174 732e 0a0a 2020 2020 2020   floats...      
-00027970: 2020 4f75 7470 7574 3a0a 2020 2020 2020    Output:.      
-00027980: 2020 2020 2020 2d20 4120 6060 7061 6e64        - A ``pand
-00027990: 6173 2e44 6174 6146 7261 6d65 6060 2077  as.DataFrame`` w
-000279a0: 6974 6820 7468 6520 7661 6c75 6573 206d  ith the values m
-000279b0: 756c 7469 706c 6965 6420 6279 2074 6865  ultiplied by the
-000279c0: 2060 6069 6e63 7265 6d65 6e74 5f76 616c   ``increment_val
-000279d0: 7565 6060 2061 6e64 0a20 2020 2020 2020  ue`` and.       
-000279e0: 2020 2020 2063 6f6e 7665 7274 6564 2074       converted t
-000279f0: 6f20 696e 7473 2e0a 2020 2020 2020 2020  o ints..        
-00027a00: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
-00027a10: 7475 700a 2020 2020 2020 2020 6461 7461  tup.        data
-00027a20: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-00027a30: 7b27 636f 6c75 6d6e 273a 205b 312e 332c  {'column': [1.3,
-00027a40: 2033 2e35 2c20 342e 322c 2032 2e31 5d7d   3.5, 4.2, 2.1]}
-00027a50: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
-00027a60: 6365 203d 2046 6978 6564 496e 6372 656d  ce = FixedIncrem
-00027a70: 656e 7473 2863 6f6c 756d 6e5f 6e61 6d65  ents(column_name
-00027a80: 3d27 636f 6c75 6d6e 272c 2069 6e63 7265  ='column', incre
-00027a90: 6d65 6e74 5f76 616c 7565 3d37 290a 2020  ment_value=7).  
-00027aa0: 2020 2020 2020 696e 7374 616e 6365 2e5f        instance._
-00027ab0: 6474 7970 6520 3d20 6e70 2e69 6e74 3634  dtype = np.int64
-00027ac0: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
-00027ad0: 2020 2020 2020 2020 7265 7665 7273 655f          reverse_
-00027ae0: 7472 616e 7366 6f72 6d65 6420 3d20 696e  transformed = in
-00027af0: 7374 616e 6365 2e72 6576 6572 7365 5f74  stance.reverse_t
-00027b00: 7261 6e73 666f 726d 2864 6174 6129 0a0a  ransform(data)..
-00027b10: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
-00027b20: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
-00027b30: 6420 3d20 7064 2e44 6174 6146 7261 6d65  d = pd.DataFrame
-00027b40: 287b 2763 6f6c 756d 6e27 3a20 5b37 2c20  ({'column': [7, 
-00027b50: 3238 2c20 3238 2c20 3134 5d7d 290a 2020  28, 28, 14]}).  
-00027b60: 2020 2020 2020 7064 2e74 6573 7469 6e67        pd.testing
-00027b70: 2e61 7373 6572 745f 6672 616d 655f 6571  .assert_frame_eq
-00027b80: 7561 6c28 6578 7065 6374 6564 2c20 7265  ual(expected, re
-00027b90: 7665 7273 655f 7472 616e 7366 6f72 6d65  verse_transforme
-00027ba0: 6429 0a0a 2020 2020 6465 6620 7465 7374  d)..    def test
-00027bb0: 5f72 6576 6572 7365 5f74 7261 6e73 666f  _reverse_transfo
-00027bc0: 726d 5f6e 616e 7328 7365 6c66 293a 0a20  rm_nans(self):. 
-00027bd0: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
-00027be0: 6865 2060 6046 6978 6564 496e 6372 656d  he ``FixedIncrem
-00027bf0: 656e 7473 2e72 6576 6572 7365 5f74 7261  ents.reverse_tra
-00027c00: 6e73 666f 726d 6060 206d 6574 686f 6420  nsform`` method 
-00027c10: 7769 7468 204e 614e 732e 0a0a 2020 2020  with NaNs...    
-00027c20: 2020 2020 5468 6520 6060 7265 7665 7273      The ``revers
-00027c30: 655f 7472 616e 7366 6f72 6d60 6020 6d65  e_transform`` me
-00027c40: 7468 6f64 2073 686f 756c 6420 6967 6e6f  thod should igno
-00027c50: 7265 2074 6865 204e 614e 2076 616c 7565  re the NaN value
-00027c60: 732e 0a0a 2020 2020 2020 2020 5365 7475  s...        Setu
-00027c70: 703a 0a20 2020 2020 2020 2020 2020 202d  p:.            -
-00027c80: 2053 6574 2074 6865 2060 605f 6474 7970   Set the ``_dtyp
-00027c90: 6560 6020 746f 2066 6c6f 6174 3634 2e0a  e`` to float64..
-00027ca0: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
-00027cb0: 2020 2020 2020 2020 2020 2020 2d20 4120              - A 
-00027cc0: 6060 7061 6e64 6173 2e44 6174 6146 7261  ``pandas.DataFra
-00027cd0: 6d65 6060 2077 6974 6820 666c 6f61 7473  me`` with floats
-00027ce0: 2e0a 0a20 2020 2020 2020 204f 7574 7075  ...        Outpu
-00027cf0: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
-00027d00: 2041 2060 6070 616e 6461 732e 4461 7461   A ``pandas.Data
-00027d10: 4672 616d 6560 6020 7769 7468 2074 6865  Frame`` with the
-00027d20: 2076 616c 7565 7320 6d75 6c74 6970 6c69   values multipli
-00027d30: 6564 2062 7920 7468 6520 6060 696e 6372  ed by the ``incr
-00027d40: 656d 656e 745f 7661 6c75 6560 6020 616e  ement_value`` an
-00027d50: 640a 2020 2020 2020 2020 2020 2020 7468  d.            th
-00027d60: 6520 4e61 4e73 2069 676e 6f72 6564 2e0a  e NaNs ignored..
-00027d70: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00027d80: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
-00027d90: 2020 2020 6461 7461 203d 2070 642e 4461      data = pd.Da
-00027da0: 7461 4672 616d 6528 7b27 636f 6c75 6d6e  taFrame({'column
-00027db0: 273a 205b 312e 332c 2033 2e35 2c20 6e70  ': [1.3, 3.5, np
-00027dc0: 2e6e 616e 2c20 342e 322c 206e 702e 6e61  .nan, 4.2, np.na
-00027dd0: 6e2c 2032 2e31 5d7d 290a 2020 2020 2020  n, 2.1]}).      
-00027de0: 2020 696e 7374 616e 6365 203d 2046 6978    instance = Fix
-00027df0: 6564 496e 6372 656d 656e 7473 2863 6f6c  edIncrements(col
-00027e00: 756d 6e5f 6e61 6d65 3d27 636f 6c75 6d6e  umn_name='column
-00027e10: 272c 2069 6e63 7265 6d65 6e74 5f76 616c  ', increment_val
-00027e20: 7565 3d37 290a 2020 2020 2020 2020 696e  ue=7).        in
-00027e30: 7374 616e 6365 2e5f 6474 7970 6520 3d20  stance._dtype = 
-00027e40: 6e70 2e66 6c6f 6174 3634 0a0a 2020 2020  np.float64..    
-00027e50: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
-00027e60: 2020 7265 7665 7273 655f 7472 616e 7366    reverse_transf
-00027e70: 6f72 6d65 6420 3d20 696e 7374 616e 6365  ormed = instance
-00027e80: 2e72 6576 6572 7365 5f74 7261 6e73 666f  .reverse_transfo
-00027e90: 726d 2864 6174 6129 0a0a 2020 2020 2020  rm(data)..      
-00027ea0: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
-00027eb0: 2020 2065 7870 6563 7465 6420 3d20 7064     expected = pd
-00027ec0: 2e44 6174 6146 7261 6d65 287b 2763 6f6c  .DataFrame({'col
-00027ed0: 756d 6e27 3a20 5b37 2c20 3238 2c20 6e70  umn': [7, 28, np
-00027ee0: 2e6e 616e 2c20 3238 2c20 6e70 2e6e 616e  .nan, 28, np.nan
-00027ef0: 2c20 3134 5d7d 290a 2020 2020 2020 2020  , 14]}).        
-00027f00: 7064 2e74 6573 7469 6e67 2e61 7373 6572  pd.testing.asser
-00027f10: 745f 6672 616d 655f 6571 7561 6c28 6578  t_frame_equal(ex
-00027f20: 7065 6374 6564 2c20 7265 7665 7273 655f  pected, reverse_
-00027f30: 7472 616e 7366 6f72 6d65 6429 0a         transformed).
+00011390: 616c 6974 792e 5f67 6574 5f69 735f 6461  ality._get_is_da
+000113a0: 7465 7469 6d65 6060 206d 6574 686f 642e  tetime`` method.
+000113b0: 0a0a 2020 2020 2020 2020 456e 7375 7265  ..        Ensure
+000113c0: 2074 6861 7420 6966 206f 6e65 206f 6620   that if one of 
+000113d0: 636f 6c75 6d6e 2f76 616c 7565 2069 7320  column/value is 
+000113e0: 6461 7465 7469 6d65 2c20 626f 7468 206f  datetime, both o
+000113f0: 6620 7468 656d 2061 7265 2e0a 0a20 2020  f them are...   
+00011400: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
+00011410: 2020 2020 2d20 5461 626c 6520 6461 7461      - Table data
+00011420: 2e0a 2020 2020 2020 2020 5369 6465 2045  ..        Side E
+00011430: 6666 6563 743a 0a20 2020 2020 2020 202d  ffect:.        -
+00011440: 2052 6169 7365 7320 6060 5661 6c75 6545   Raises ``ValueE
+00011450: 7272 6f72 6060 2069 6620 6f6e 6c79 206f  rror`` if only o
+00011460: 6e65 206f 6620 636f 6c75 6d6e 2f76 616c  ne of column/val
+00011470: 7565 2069 7320 6461 7465 7469 6d65 2e0a  ue is datetime..
+00011480: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00011490: 2020 2020 2320 5365 7475 7079 0a20 2020      # Setupy.   
+000114a0: 2020 2020 2074 6162 6c65 5f64 6174 6120       table_data 
+000114b0: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
+000114c0: 0a20 2020 2020 2020 2020 2020 2027 6127  .            'a'
+000114d0: 3a20 7064 2e74 6f5f 6461 7465 7469 6d65  : pd.to_datetime
+000114e0: 285b 2732 3032 302d 3031 2d30 3127 5d29  (['2020-01-01'])
+000114f0: 2c0a 2020 2020 2020 2020 7d29 0a20 2020  ,.        }).   
+00011500: 2020 2020 2069 6e73 7461 6e63 6520 3d20       instance = 
+00011510: 5363 616c 6172 496e 6571 7561 6c69 7479  ScalarInequality
+00011520: 2863 6f6c 756d 6e5f 6e61 6d65 3d27 6127  (column_name='a'
+00011530: 2c20 7661 6c75 653d 312c 2072 656c 6174  , value=1, relat
+00011540: 696f 6e3d 273c 2729 0a0a 2020 2020 2020  ion='<')..      
+00011550: 2020 2320 5275 6e20 2f20 4173 7365 7274    # Run / Assert
+00011560: 0a20 2020 2020 2020 2065 7272 5f6d 7367  .        err_msg
+00011570: 203d 2027 426f 7468 2063 6f6c 756d 6e20   = 'Both column 
+00011580: 616e 6420 7661 6c75 6520 6d75 7374 2062  and value must b
+00011590: 6520 6461 7465 7469 6d65 2e27 0a20 2020  e datetime.'.   
+000115a0: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
+000115b0: 2e72 6169 7365 7328 5661 6c75 6545 7272  .raises(ValueErr
+000115c0: 6f72 2c20 6d61 7463 683d 6572 725f 6d73  or, match=err_ms
+000115d0: 6729 3a0a 2020 2020 2020 2020 2020 2020  g):.            
+000115e0: 696e 7374 616e 6365 2e5f 6765 745f 6973  instance._get_is
+000115f0: 5f64 6174 6574 696d 6528 7461 626c 655f  _datetime(table_
+00011600: 6461 7461 290a 0a20 2020 2064 6566 2074  data)..    def t
+00011610: 6573 745f 5f76 616c 6964 6174 655f 636f  est__validate_co
+00011620: 6c75 6d6e 735f 6578 6973 745f 696e 636f  lumns_exist_inco
+00011630: 7272 6563 745f 636f 6c75 6d6e 7328 7365  rrect_columns(se
+00011640: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00011650: 5465 7374 2074 6865 2060 6053 6361 6c61  Test the ``Scala
+00011660: 7249 6e65 7175 616c 6974 792e 5f76 616c  rInequality._val
+00011670: 6964 6174 655f 636f 6c75 6d6e 735f 6578  idate_columns_ex
+00011680: 6973 7460 6020 6d65 7468 6f64 2e0a 0a20  ist`` method... 
+00011690: 2020 2020 2020 2054 6869 7320 6d65 7468         This meth
+000116a0: 6f64 2072 6169 7365 7320 616e 2065 7272  od raises an err
+000116b0: 6f72 2069 6620 6060 636f 6c75 6d6e 5f6e  or if ``column_n
+000116c0: 616d 6560 6020 646f 6573 206e 6f74 2065  ame`` does not e
+000116d0: 7869 7374 2e0a 0a20 2020 2020 2020 2049  xist...        I
+000116e0: 6e70 7574 3a0a 2020 2020 2020 2020 2d20  nput:.        - 
+000116f0: 5461 626c 6520 7769 7468 2067 6976 656e  Table with given
+00011700: 2064 6174 612e 0a20 2020 2020 2020 2022   data..        "
+00011710: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
+00011720: 7570 0a20 2020 2020 2020 2074 6162 6c65  up.        table
+00011730: 5f64 6174 6120 3d20 7064 2e44 6174 6146  _data = pd.DataF
+00011740: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
+00011750: 2020 2027 6127 3a20 5b31 2c20 322c 2034     'a': [1, 2, 4
+00011760: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
+00011770: 6227 3a20 5b34 2c20 352c 2036 5d0a 2020  b': [4, 5, 6].  
+00011780: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
+00011790: 2069 6e73 7461 6e63 6520 3d20 5363 616c   instance = Scal
+000117a0: 6172 496e 6571 7561 6c69 7479 2863 6f6c  arInequality(col
+000117b0: 756d 6e5f 6e61 6d65 3d27 6327 2c20 7661  umn_name='c', va
+000117c0: 6c75 653d 352c 2072 656c 6174 696f 6e3d  lue=5, relation=
+000117d0: 273e 2729 0a0a 2020 2020 2020 2020 2320  '>')..        # 
+000117e0: 5275 6e20 2f20 4173 7365 7274 0a20 2020  Run / Assert.   
+000117f0: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
+00011800: 2e72 6169 7365 7328 4b65 7945 7272 6f72  .raises(KeyError
+00011810: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+00011820: 6e73 7461 6e63 652e 5f76 616c 6964 6174  nstance._validat
+00011830: 655f 636f 6c75 6d6e 735f 6578 6973 7428  e_columns_exist(
+00011840: 7461 626c 655f 6461 7461 290a 0a20 2020  table_data)..   
+00011850: 2064 6566 2074 6573 745f 5f66 6974 2873   def test__fit(s
+00011860: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00011870: 2254 6573 7420 7468 6520 6060 5363 616c  "Test the ``Scal
+00011880: 6172 496e 6571 7561 6c69 7479 2e5f 6669  arInequality._fi
+00011890: 7460 6020 6d65 7468 6f64 2e0a 0a20 2020  t`` method...   
+000118a0: 2020 2020 2054 6865 206d 6574 686f 6420       The method 
+000118b0: 7368 6f75 6c64 206c 6561 726e 2074 6865  should learn the
+000118c0: 2060 6064 7479 7065 6060 206f 6620 6060   ``dtype`` of ``
+000118d0: 636f 6c75 6d6e 5f6e 616d 6560 6020 616e  column_name`` an
+000118e0: 6420 6060 5f69 735f 6461 7465 7469 6d65  d ``_is_datetime
+000118f0: 6060 2e0a 0a20 2020 2020 2020 2049 6e70  ``...        Inp
+00011900: 7574 3a0a 2020 2020 2020 2020 2d20 5461  ut:.        - Ta
+00011910: 626c 6520 6461 7461 2077 6974 6820 696e  ble data with in
+00011920: 7465 6765 7273 2e0a 2020 2020 2020 2020  tegers..        
+00011930: 5369 6465 2045 6666 6563 743a 0a20 2020  Side Effect:.   
+00011940: 2020 2020 202d 205f 7661 6c69 6461 7465       - _validate
+00011950: 5f63 6f6c 756d 6e73 5f65 7869 7374 2073  _columns_exist s
+00011960: 686f 756c 6420 6265 2063 616c 6c65 6420  hould be called 
+00011970: 6f6e 6365 0a20 2020 2020 2020 202d 205f  once.        - _
+00011980: 6765 745f 6973 5f64 6174 6574 696d 6520  get_is_datetime 
+00011990: 7368 6f75 6c64 2062 6520 6361 6c6c 6564  should be called
+000119a0: 206f 6e63 650a 2020 2020 2020 2020 2d20   once.        - 
+000119b0: 5f69 735f 6461 7465 7469 6d65 2073 686f  _is_datetime sho
+000119c0: 756c 6420 7265 6365 6976 6520 7468 6520  uld receive the 
+000119d0: 6f75 7470 7574 206f 6620 5f67 6574 5f69  output of _get_i
+000119e0: 735f 6461 7465 7469 6d65 0a20 2020 2020  s_datetime.     
+000119f0: 2020 202d 205f 6474 7970 6520 7368 6f75     - _dtype shou
+00011a00: 6c64 2062 6520 6120 6c69 7374 206f 6620  ld be a list of 
+00011a10: 696e 7465 6765 7220 6474 7970 6573 2e0a  integer dtypes..
+00011a20: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00011a30: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
+00011a40: 2020 2020 7461 626c 655f 6461 7461 203d      table_data =
+00011a50: 2070 642e 4461 7461 4672 616d 6528 7b0a   pd.DataFrame({.
+00011a60: 2020 2020 2020 2020 2020 2020 2761 273a              'a':
+00011a70: 205b 312c 2032 2c20 345d 2c0a 2020 2020   [1, 2, 4],.    
+00011a80: 2020 2020 2020 2020 2762 273a 205b 342c          'b': [4,
+00011a90: 2035 2c20 365d 0a20 2020 2020 2020 207d   5, 6].        }
+00011aa0: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
+00011ab0: 6365 203d 2053 6361 6c61 7249 6e65 7175  ce = ScalarInequ
+00011ac0: 616c 6974 7928 636f 6c75 6d6e 5f6e 616d  ality(column_nam
+00011ad0: 653d 2762 272c 2076 616c 7565 3d33 2c20  e='b', value=3, 
+00011ae0: 7265 6c61 7469 6f6e 3d27 3e27 290a 2020  relation='>').  
+00011af0: 2020 2020 2020 696e 7374 616e 6365 2e5f        instance._
+00011b00: 7661 6c69 6461 7465 5f63 6f6c 756d 6e73  validate_columns
+00011b10: 5f65 7869 7374 203d 204d 6f63 6b28 290a  _exist = Mock().
+00011b20: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+00011b30: 2e5f 6765 745f 6973 5f64 6174 6574 696d  ._get_is_datetim
+00011b40: 6520 3d20 4d6f 636b 2872 6574 7572 6e5f  e = Mock(return_
+00011b50: 7661 6c75 653d 4661 6c73 6529 0a0a 2020  value=False)..  
+00011b60: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+00011b70: 2020 2020 696e 7374 616e 6365 2e5f 6669      instance._fi
+00011b80: 7428 7461 626c 655f 6461 7461 290a 0a20  t(table_data).. 
+00011b90: 2020 2020 2020 2023 2041 7373 6572 740a         # Assert.
+00011ba0: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+00011bb0: 2e5f 7661 6c69 6461 7465 5f63 6f6c 756d  ._validate_colum
+00011bc0: 6e73 5f65 7869 7374 2e61 7373 6572 745f  ns_exist.assert_
+00011bd0: 6361 6c6c 6564 5f6f 6e63 655f 7769 7468  called_once_with
+00011be0: 2874 6162 6c65 5f64 6174 6129 0a20 2020  (table_data).   
+00011bf0: 2020 2020 2069 6e73 7461 6e63 652e 5f67       instance._g
+00011c00: 6574 5f69 735f 6461 7465 7469 6d65 2e61  et_is_datetime.a
+00011c10: 7373 6572 745f 6361 6c6c 6564 5f6f 6e63  ssert_called_onc
+00011c20: 655f 7769 7468 2874 6162 6c65 5f64 6174  e_with(table_dat
+00011c30: 6129 0a20 2020 2020 2020 2061 7373 6572  a).        asser
+00011c40: 7420 6e6f 7420 696e 7374 616e 6365 2e5f  t not instance._
+00011c50: 6973 5f64 6174 6574 696d 650a 2020 2020  is_datetime.    
+00011c60: 2020 2020 6173 7365 7274 2069 6e73 7461      assert insta
+00011c70: 6e63 652e 5f64 7479 7065 203d 3d20 7064  nce._dtype == pd
+00011c80: 2e53 6572 6965 7328 5b31 5d29 2e64 7479  .Series([1]).dty
+00011c90: 7065 2020 2320 6578 6163 7420 6474 7970  pe  # exact dtyp
+00011ca0: 6520 2833 3220 6f72 2036 3429 2064 6570  e (32 or 64) dep
+00011cb0: 656e 6473 206f 6e20 4f53 0a0a 2020 2020  ends on OS..    
+00011cc0: 6465 6620 7465 7374 5f5f 6669 745f 666c  def test__fit_fl
+00011cd0: 6f61 7473 2873 656c 6629 3a0a 2020 2020  oats(self):.    
+00011ce0: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
+00011cf0: 6060 5363 616c 6172 496e 6571 7561 6c69  ``ScalarInequali
+00011d00: 7479 2e5f 6669 7460 6020 6d65 7468 6f64  ty._fit`` method
+00011d10: 2e0a 0a20 2020 2020 2020 2054 6865 2061  ...        The a
+00011d20: 7474 7269 6275 7465 2060 605f 6474 7970  ttribute ``_dtyp
+00011d30: 6560 6020 7368 6f75 6c64 2062 6520 666c  e`` should be fl
+00011d40: 6f61 7420 7768 656e 2060 6063 6f6c 756d  oat when ``colum
+00011d50: 6e5f 6e61 6d65 6060 2063 6f6e 7461 696e  n_name`` contain
+00011d60: 7320 666c 6f61 7473 2e0a 0a20 2020 2020  s floats...     
+00011d70: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
+00011d80: 2020 2d20 5461 626c 6520 6461 7461 2077    - Table data w
+00011d90: 6974 6820 666c 6f61 7473 2e0a 2020 2020  ith floats..    
+00011da0: 2020 2020 5369 6465 2045 6666 6563 743a      Side Effect:
+00011db0: 0a20 2020 2020 2020 202d 205f 6474 7970  .        - _dtyp
+00011dc0: 6520 7368 6f75 6c64 2062 6520 6120 666c  e should be a fl
+00011dd0: 6f61 7420 6474 7970 652e 0a20 2020 2020  oat dtype..     
+00011de0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00011df0: 2053 6574 7570 0a20 2020 2020 2020 2074   Setup.        t
+00011e00: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
+00011e10: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
+00011e20: 2020 2020 2020 2027 6127 3a20 5b31 2c20         'a': [1, 
+00011e30: 322c 2034 5d2c 0a20 2020 2020 2020 2020  2, 4],.         
+00011e40: 2020 2027 6227 3a20 5b34 2e2c 2035 2e2c     'b': [4., 5.,
+00011e50: 2036 2e5d 0a20 2020 2020 2020 207d 290a   6.].        }).
+00011e60: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+00011e70: 203d 2053 6361 6c61 7249 6e65 7175 616c   = ScalarInequal
+00011e80: 6974 7928 636f 6c75 6d6e 5f6e 616d 653d  ity(column_name=
+00011e90: 2762 272c 2076 616c 7565 3d31 302c 2072  'b', value=10, r
+00011ea0: 656c 6174 696f 6e3d 273e 2729 0a0a 2020  elation='>')..  
+00011eb0: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+00011ec0: 2020 2020 696e 7374 616e 6365 2e5f 6669      instance._fi
+00011ed0: 7428 7461 626c 655f 6461 7461 290a 0a20  t(table_data).. 
+00011ee0: 2020 2020 2020 2023 2041 7373 6572 740a         # Assert.
+00011ef0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00011f00: 6e73 7461 6e63 652e 5f64 7479 7065 203d  nstance._dtype =
+00011f10: 3d20 6e70 2e64 7479 7065 2827 666c 6f61  = np.dtype('floa
+00011f20: 7427 290a 0a20 2020 2064 6566 2074 6573  t')..    def tes
+00011f30: 745f 5f66 6974 5f64 6174 6574 696d 6528  t__fit_datetime(
+00011f40: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00011f50: 2222 5465 7374 2074 6865 2060 6053 6361  ""Test the ``Sca
+00011f60: 6c61 7249 6e65 7175 616c 6974 792e 5f66  larInequality._f
+00011f70: 6974 6060 206d 6574 686f 642e 0a0a 2020  it`` method...  
+00011f80: 2020 2020 2020 5468 6520 6174 7472 6962        The attrib
+00011f90: 7574 6520 6060 5f64 7479 7065 6060 2073  ute ``_dtype`` s
+00011fa0: 686f 756c 6420 6265 2064 6174 6574 696d  hould be datetim
+00011fb0: 6520 7768 656e 2060 6063 6f6c 756d 6e5f  e when ``column_
+00011fc0: 6e61 6d65 6060 2063 6f6e 7461 696e 7320  name`` contains 
+00011fd0: 6461 7465 7469 6d65 732e 0a0a 2020 2020  datetimes...    
+00011fe0: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
+00011ff0: 2020 202d 2054 6162 6c65 2064 6174 6120     - Table data 
+00012000: 7769 7468 2064 6174 6574 696d 6573 2e0a  with datetimes..
+00012010: 2020 2020 2020 2020 5369 6465 2045 6666          Side Eff
+00012020: 6563 743a 0a20 2020 2020 2020 202d 205f  ect:.        - _
+00012030: 6474 7970 6520 7368 6f75 6c64 2062 6520  dtype should be 
+00012040: 6120 6c69 7374 206f 6620 6461 7465 7469  a list of dateti
+00012050: 6d65 2064 7479 7065 732e 0a20 2020 2020  me dtypes..     
+00012060: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00012070: 2053 6574 7570 0a20 2020 2020 2020 2074   Setup.        t
+00012080: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
+00012090: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
+000120a0: 2020 2020 2020 2027 6127 3a20 7064 2e74         'a': pd.t
+000120b0: 6f5f 6461 7465 7469 6d65 285b 2732 3032  o_datetime(['202
+000120c0: 302d 3031 2d30 3127 5d29 2c0a 2020 2020  0-01-01']),.    
+000120d0: 2020 2020 2020 2020 2762 273a 2070 642e          'b': pd.
+000120e0: 746f 5f64 6174 6574 696d 6528 5b27 3230  to_datetime(['20
+000120f0: 3230 2d30 312d 3032 275d 290a 2020 2020  20-01-02']).    
+00012100: 2020 2020 7d29 0a20 2020 2020 2020 2069      }).        i
+00012110: 6e73 7461 6e63 6520 3d20 5363 616c 6172  nstance = Scalar
+00012120: 496e 6571 7561 6c69 7479 2863 6f6c 756d  Inequality(colum
+00012130: 6e5f 6e61 6d65 3d27 6227 2c20 7661 6c75  n_name='b', valu
+00012140: 653d 2732 3032 302d 3031 2d30 3127 2c20  e='2020-01-01', 
+00012150: 7265 6c61 7469 6f6e 3d27 3e27 290a 0a20  relation='>').. 
+00012160: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
+00012170: 2020 2020 2069 6e73 7461 6e63 652e 5f66       instance._f
+00012180: 6974 2874 6162 6c65 5f64 6174 6129 0a0a  it(table_data)..
+00012190: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
+000121a0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+000121b0: 696e 7374 616e 6365 2e5f 6474 7970 6520  instance._dtype 
+000121c0: 3d3d 206e 702e 6474 7970 6528 273c 4d38  == np.dtype('<M8
+000121d0: 5b6e 735d 2729 0a0a 2020 2020 6465 6620  [ns]')..    def 
+000121e0: 7465 7374 5f69 735f 7661 6c69 6428 7365  test_is_valid(se
+000121f0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00012200: 5465 7374 2074 6865 2060 6053 6361 6c61  Test the ``Scala
+00012210: 7249 6e65 7175 616c 6974 792e 6973 5f76  rInequality.is_v
+00012220: 616c 6964 6060 206d 6574 686f 6420 7769  alid`` method wi
+00012230: 7468 2060 6072 656c 6174 696f 6e20 3d20  th ``relation = 
+00012240: 273e 2760 602e 0a0a 2020 2020 2020 2020  '>'``...        
+00012250: 5468 6520 6d65 7468 6f64 2073 686f 756c  The method shoul
+00012260: 6420 7265 7475 726e 2054 7275 6520 7768  d return True wh
+00012270: 656e 2060 6063 6f6c 756d 6e5f 6e61 6d65  en ``column_name
+00012280: 6060 2069 7320 6772 6561 7465 7220 7468  `` is greater th
+00012290: 616e 0a20 2020 2020 2020 2060 6076 616c  an.        ``val
+000122a0: 7565 6060 206f 7220 7468 6520 726f 7720  ue`` or the row 
+000122b0: 636f 6e74 6169 6e73 206e 616e 2c20 6f74  contains nan, ot
+000122c0: 6865 7277 6973 6520 7265 7475 726e 2046  herwise return F
+000122d0: 616c 7365 2e0a 0a20 2020 2020 2020 2049  alse...        I
+000122e0: 6e70 7574 3a0a 2020 2020 2020 2020 2d20  nput:.        - 
+000122f0: 5461 626c 6520 7769 7468 2061 206d 6978  Table with a mix
+00012300: 7475 7265 206f 6620 7661 6c69 6420 616e  ture of valid an
+00012310: 6420 696e 7661 6c69 6420 726f 7773 2c20  d invalid rows, 
+00012320: 6173 2077 656c 6c20 6173 206e 702e 6e61  as well as np.na
+00012330: 6e73 2e0a 2020 2020 2020 2020 4f75 7470  ns..        Outp
+00012340: 7574 3a0a 2020 2020 2020 2020 2d20 4661  ut:.        - Fa
+00012350: 6c73 6520 7368 6f75 6c64 2062 6520 7265  lse should be re
+00012360: 7475 726e 6564 2066 6f72 2074 6865 2073  turned for the s
+00012370: 7472 6963 746c 7920 696e 7661 6c69 6420  trictly invalid 
+00012380: 726f 7773 2061 6e64 2054 7275 6520 666f  rows and True fo
+00012390: 7220 7468 6520 7265 7374 2e0a 2020 2020  r the rest..    
+000123a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000123b0: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
+000123c0: 696e 7374 616e 6365 203d 2053 6361 6c61  instance = Scala
+000123d0: 7249 6e65 7175 616c 6974 7928 636f 6c75  rInequality(colu
+000123e0: 6d6e 5f6e 616d 653d 2762 272c 2076 616c  mn_name='b', val
+000123f0: 7565 3d32 2c20 7265 6c61 7469 6f6e 3d27  ue=2, relation='
+00012400: 3e27 290a 0a20 2020 2020 2020 2023 2052  >')..        # R
+00012410: 756e 0a20 2020 2020 2020 2074 6162 6c65  un.        table
+00012420: 5f64 6174 6120 3d20 7064 2e44 6174 6146  _data = pd.DataF
+00012430: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
+00012440: 2020 2027 6127 3a20 5b31 2c20 6e70 2e6e     'a': [1, np.n
+00012450: 616e 2c20 332c 2034 2c20 4e6f 6e65 5d2c  an, 3, 4, None],
+00012460: 0a20 2020 2020 2020 2020 2020 2027 6227  .            'b'
+00012470: 3a20 5b34 2c20 322c 206e 702e 6e61 6e2c  : [4, 2, np.nan,
+00012480: 202d 362c 204e 6f6e 655d 2c0a 2020 2020   -6, None],.    
+00012490: 2020 2020 7d29 0a20 2020 2020 2020 206f      }).        o
+000124a0: 7574 203d 2069 6e73 7461 6e63 652e 6973  ut = instance.is
+000124b0: 5f76 616c 6964 2874 6162 6c65 5f64 6174  _valid(table_dat
+000124c0: 6129 0a0a 2020 2020 2020 2020 2320 4173  a)..        # As
+000124d0: 7365 7274 0a20 2020 2020 2020 2065 7870  sert.        exp
+000124e0: 6563 7465 645f 6f75 7420 3d20 5b54 7275  ected_out = [Tru
+000124f0: 652c 2046 616c 7365 2c20 5472 7565 2c20  e, False, True, 
+00012500: 4661 6c73 652c 2054 7275 655d 0a20 2020  False, True].   
+00012510: 2020 2020 206e 702e 7465 7374 696e 672e       np.testing.
+00012520: 6173 7365 7274 5f61 7272 6179 5f65 7175  assert_array_equ
+00012530: 616c 2865 7870 6563 7465 645f 6f75 742c  al(expected_out,
+00012540: 206f 7574 290a 0a20 2020 2064 6566 2074   out)..    def t
+00012550: 6573 745f 6973 5f76 616c 6964 5f64 6174  est_is_valid_dat
+00012560: 6574 696d 6573 2873 656c 6629 3a0a 2020  etimes(self):.  
+00012570: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
+00012580: 6520 6060 5363 616c 6172 496e 6571 7561  e ``ScalarInequa
+00012590: 6c69 7479 2e69 735f 7661 6c69 6460 6020  lity.is_valid`` 
+000125a0: 6d65 7468 6f64 2077 6974 6820 6461 7465  method with date
+000125b0: 7469 6d65 7320 616e 6420 6060 7265 6c61  times and ``rela
+000125c0: 7469 6f6e 203d 2027 3c3d 2760 602e 0a0a  tion = '<='``...
+000125d0: 2020 2020 2020 2020 5468 6520 6d65 7468          The meth
+000125e0: 6f64 2073 686f 756c 6420 7265 7475 726e  od should return
+000125f0: 2054 7275 6520 7768 656e 2060 6063 6f6c   True when ``col
+00012600: 756d 6e5f 6e61 6d65 6060 2069 7320 6772  umn_name`` is gr
+00012610: 6561 7465 7220 6f72 2065 7175 616c 2074  eater or equal t
+00012620: 6f0a 2020 2020 2020 2020 6060 7661 6c75  o.        ``valu
+00012630: 6560 6020 6f72 2074 6865 2072 6f77 2063  e`` or the row c
+00012640: 6f6e 7461 696e 7320 6e61 6e2c 206f 7468  ontains nan, oth
+00012650: 6572 7769 7365 2072 6574 7572 6e20 4661  erwise return Fa
+00012660: 6c73 652e 0a0a 2020 2020 2020 2020 496e  lse...        In
+00012670: 7075 743a 0a20 2020 2020 2020 202d 2054  put:.        - T
+00012680: 6162 6c65 2077 6974 6820 6461 7465 7469  able with dateti
+00012690: 6d65 7320 616e 6420 6e70 2e6e 616e 732e  mes and np.nans.
+000126a0: 0a20 2020 2020 2020 204f 7574 7075 743a  .        Output:
+000126b0: 0a20 2020 2020 2020 202d 2046 616c 7365  .        - False
+000126c0: 2073 686f 756c 6420 6265 2072 6574 7572   should be retur
+000126d0: 6e65 6420 666f 7220 7468 6520 7374 7269  ned for the stri
+000126e0: 6374 6c79 2069 6e76 616c 6964 2072 6f77  ctly invalid row
+000126f0: 7320 616e 6420 5472 7565 2066 6f72 2074  s and True for t
+00012700: 6865 2072 6573 742e 0a20 2020 2020 2020  he rest..       
+00012710: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
+00012720: 6574 7570 0a20 2020 2020 2020 2069 6e73  etup.        ins
+00012730: 7461 6e63 6520 3d20 5363 616c 6172 496e  tance = ScalarIn
+00012740: 6571 7561 6c69 7479 280a 2020 2020 2020  equality(.      
+00012750: 2020 2020 2020 636f 6c75 6d6e 5f6e 616d        column_nam
+00012760: 653d 2762 272c 0a20 2020 2020 2020 2020  e='b',.         
+00012770: 2020 2076 616c 7565 3d27 382f 3331 2f32     value='8/31/2
+00012780: 3032 3127 2c0a 2020 2020 2020 2020 2020  021',.          
+00012790: 2020 7265 6c61 7469 6f6e 3d27 3e3d 2729    relation='>=')
+000127a0: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
+000127b0: 2020 2020 2020 2020 7461 626c 655f 6461          table_da
+000127c0: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
+000127d0: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
+000127e0: 2762 273a 205b 6461 7465 7469 6d65 2832  'b': [datetime(2
+000127f0: 3032 312c 2038 2c20 3330 292c 2064 6174  021, 8, 30), dat
+00012800: 6574 696d 6528 3230 3231 2c20 382c 2033  etime(2021, 8, 3
+00012810: 3129 2c20 6461 7465 7469 6d65 2832 3032  1), datetime(202
+00012820: 312c 2039 2c20 3229 2c20 6e70 2e6e 616e  1, 9, 2), np.nan
+00012830: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
+00012840: 6327 3a20 5b37 2c20 382c 2039 2c20 3130  c': [7, 8, 9, 10
+00012850: 5d0a 2020 2020 2020 2020 7d29 0a20 2020  ].        }).   
+00012860: 2020 2020 206f 7574 203d 2069 6e73 7461       out = insta
+00012870: 6e63 652e 6973 5f76 616c 6964 2874 6162  nce.is_valid(tab
+00012880: 6c65 5f64 6174 6129 0a0a 2020 2020 2020  le_data)..      
+00012890: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
+000128a0: 2020 2065 7870 6563 7465 645f 6f75 7420     expected_out 
+000128b0: 3d20 5b46 616c 7365 2c20 5472 7565 2c20  = [False, True, 
+000128c0: 5472 7565 2c20 5472 7565 5d0a 2020 2020  True, True].    
+000128d0: 2020 2020 6e70 2e74 6573 7469 6e67 2e61      np.testing.a
+000128e0: 7373 6572 745f 6172 7261 795f 6571 7561  ssert_array_equa
+000128f0: 6c28 6578 7065 6374 6564 5f6f 7574 2c20  l(expected_out, 
+00012900: 6f75 7429 0a0a 2020 2020 6465 6620 7465  out)..    def te
+00012910: 7374 5f69 735f 7661 6c69 645f 6461 7465  st_is_valid_date
+00012920: 7469 6d65 735f 6173 5f6f 626a 6563 7428  times_as_object(
+00012930: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00012940: 2222 5465 7374 2074 6865 2060 6053 6361  ""Test the ``Sca
+00012950: 6c61 7249 6e65 7175 616c 6974 792e 6973  larInequality.is
+00012960: 5f76 616c 6964 6060 206d 6574 686f 6420  _valid`` method 
+00012970: 7769 7468 2064 6174 6574 696d 6573 2061  with datetimes a
+00012980: 6e64 2074 6865 6972 2064 7479 7065 2069  nd their dtype i
+00012990: 7320 6f62 6a65 6374 2e0a 0a20 2020 2020  s object...     
+000129a0: 2020 2054 6865 206d 6574 686f 6420 7368     The method sh
+000129b0: 6f75 6c64 2072 6574 7572 6e20 5472 7565  ould return True
+000129c0: 2077 6865 6e20 6060 636f 6c75 6d6e 5f6e   when ``column_n
+000129d0: 616d 6560 6020 6973 2067 7265 6174 6572  ame`` is greater
+000129e0: 206f 7220 6571 7561 6c20 746f 0a20 2020   or equal to.   
+000129f0: 2020 2020 2060 6076 616c 7565 6060 206f       ``value`` o
+00012a00: 7220 7468 6520 726f 7720 636f 6e74 6169  r the row contai
+00012a10: 6e73 206e 616e 2c20 6576 656e 2077 6865  ns nan, even whe
+00012a20: 6e20 7468 6520 6060 6461 7465 7469 6d65  n the ``datetime
+00012a30: 6060 2069 7320 7061 7373 6564 2061 7320  `` is passed as 
+00012a40: 616e 206f 626a 6563 742e 0a20 2020 2020  an object..     
+00012a50: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00012a60: 2053 6574 7570 0a20 2020 2020 2020 2069   Setup.        i
+00012a70: 6e73 7461 6e63 6520 3d20 5363 616c 6172  nstance = Scalar
+00012a80: 496e 6571 7561 6c69 7479 280a 2020 2020  Inequality(.    
+00012a90: 2020 2020 2020 2020 636f 6c75 6d6e 5f6e          column_n
+00012aa0: 616d 653d 2762 272c 0a20 2020 2020 2020  ame='b',.       
+00012ab0: 2020 2020 2076 616c 7565 3d27 382f 3331       value='8/31
+00012ac0: 2f32 3032 3127 2c0a 2020 2020 2020 2020  /2021',.        
+00012ad0: 2020 2020 7265 6c61 7469 6f6e 3d27 3e3d      relation='>=
+00012ae0: 270a 2020 2020 2020 2020 290a 2020 2020  '.        ).    
+00012af0: 2020 2020 696e 7374 616e 6365 2e5f 6474      instance._dt
+00012b00: 7970 6520 3d20 6e70 2e64 7479 7065 2827  ype = np.dtype('
+00012b10: 4f27 290a 2020 2020 2020 2020 696e 7374  O').        inst
+00012b20: 616e 6365 2e5f 6973 5f64 6174 6574 696d  ance._is_datetim
+00012b30: 6520 3d20 5472 7565 0a0a 2020 2020 2020  e = True..      
+00012b40: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
+00012b50: 7461 626c 655f 6461 7461 203d 2070 642e  table_data = pd.
+00012b60: 4461 7461 4672 616d 6528 7b0a 2020 2020  DataFrame({.    
+00012b70: 2020 2020 2020 2020 2762 273a 205b 2732          'b': ['2
+00012b80: 3032 312c 2038 2c20 3330 272c 2027 3230  021, 8, 30', '20
+00012b90: 3231 2c20 382c 2033 3127 2c20 2732 3032  21, 8, 31', '202
+00012ba0: 312c 2039 2c20 3227 2c20 6e70 2e6e 616e  1, 9, 2', np.nan
+00012bb0: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
+00012bc0: 6327 3a20 5b37 2c20 382c 2039 2c20 3130  c': [7, 8, 9, 10
+00012bd0: 5d0a 2020 2020 2020 2020 7d29 0a20 2020  ].        }).   
+00012be0: 2020 2020 206f 7574 203d 2069 6e73 7461       out = insta
+00012bf0: 6e63 652e 6973 5f76 616c 6964 2874 6162  nce.is_valid(tab
+00012c00: 6c65 5f64 6174 6129 0a0a 2020 2020 2020  le_data)..      
+00012c10: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
+00012c20: 2020 2065 7870 6563 7465 645f 6f75 7420     expected_out 
+00012c30: 3d20 5b46 616c 7365 2c20 5472 7565 2c20  = [False, True, 
+00012c40: 5472 7565 2c20 5472 7565 5d0a 2020 2020  True, True].    
+00012c50: 2020 2020 6e70 2e74 6573 7469 6e67 2e61      np.testing.a
+00012c60: 7373 6572 745f 6172 7261 795f 6571 7561  ssert_array_equa
+00012c70: 6c28 6578 7065 6374 6564 5f6f 7574 2c20  l(expected_out, 
+00012c80: 6f75 7429 0a0a 2020 2020 6465 6620 7465  out)..    def te
+00012c90: 7374 5f5f 7472 616e 7366 6f72 6d28 7365  st__transform(se
+00012ca0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00012cb0: 5465 7374 2074 6865 2060 6053 6361 6c61  Test the ``Scala
+00012cc0: 7249 6e65 7175 616c 6974 792e 5f74 7261  rInequality._tra
+00012cd0: 6e73 666f 726d 6060 206d 6574 686f 642e  nsform`` method.
+00012ce0: 0a0a 2020 2020 2020 2020 5468 6520 6d65  ..        The me
+00012cf0: 7468 6f64 2069 7320 6578 7065 6374 6564  thod is expected
+00012d00: 2074 6f20 636f 6d70 7574 6520 7468 6520   to compute the 
+00012d10: 6469 7374 616e 6365 2062 6574 7765 656e  distance between
+00012d20: 2074 6865 2060 6063 6f6c 756d 6e5f 6e61   the ``column_na
+00012d30: 6d65 6060 2061 6e64 2060 6076 616c 7565  me`` and ``value
+00012d40: 6060 0a20 2020 2020 2020 2061 6e64 2063  ``.        and c
+00012d50: 7265 6174 6520 6120 6469 6666 2063 6f6c  reate a diff col
+00012d60: 756d 6e20 7769 7468 2074 6865 206c 6f67  umn with the log
+00012d70: 6172 6974 686d 206f 6620 7468 6520 6469  arithm of the di
+00012d80: 7374 616e 6365 202b 2031 2e0a 0a20 2020  stance + 1...   
+00012d90: 2020 2020 2053 6574 7570 3a0a 2020 2020       Setup:.    
+00012da0: 2020 2020 2d20 6060 5f64 6966 665f 636f      - ``_diff_co
+00012db0: 6c75 6d6e 5f6e 616d 6560 6020 6973 2073  lumn_name`` is s
+00012dc0: 6574 2074 6f20 6060 2761 2327 6060 2e0a  et to ``'a#'``..
+00012dd0: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
+00012de0: 2020 2020 2020 202d 2054 6162 6c65 2064         - Table d
+00012df0: 6174 612e 0a20 2020 2020 2020 204f 7574  ata..        Out
+00012e00: 7075 743a 0a20 2020 2020 2020 202d 2053  put:.        - S
+00012e10: 616d 6520 7461 626c 6520 7769 7468 2061  ame table with a
+00012e20: 2064 6966 6620 636f 6c75 6d6e 206f 6620   diff column of 
+00012e30: 7468 6520 6c6f 6720 6f66 2074 6865 2064  the log of the d
+00012e40: 6973 7461 6e63 6573 202b 2031 0a20 2020  istances + 1.   
+00012e50: 2020 2020 2020 2069 6e20 7468 6520 6060         in the ``
+00012e60: 636f 6c75 6d6e 5f6e 616d 6560 6027 7320  column_name``'s 
+00012e70: 706c 6163 652e 0a20 2020 2020 2020 2022  place..        "
+00012e80: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
+00012e90: 7570 0a20 2020 2020 2020 2069 6e73 7461  up.        insta
+00012ea0: 6e63 6520 3d20 5363 616c 6172 496e 6571  nce = ScalarIneq
+00012eb0: 7561 6c69 7479 2863 6f6c 756d 6e5f 6e61  uality(column_na
+00012ec0: 6d65 3d27 6127 2c20 7661 6c75 653d 312c  me='a', value=1,
+00012ed0: 2072 656c 6174 696f 6e3d 273e 3d27 290a   relation='>=').
+00012ee0: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+00012ef0: 2e5f 6469 6666 5f63 6f6c 756d 6e5f 6e61  ._diff_column_na
+00012f00: 6d65 203d 2027 6123 270a 0a20 2020 2020  me = 'a#'..     
+00012f10: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
+00012f20: 2074 6162 6c65 5f64 6174 6120 3d20 7064   table_data = pd
+00012f30: 2e44 6174 6146 7261 6d65 287b 0a20 2020  .DataFrame({.   
+00012f40: 2020 2020 2020 2020 2027 6127 3a20 5b31           'a': [1
+00012f50: 2c20 322c 2033 5d2c 0a20 2020 2020 2020  , 2, 3],.       
+00012f60: 2020 2020 2027 6327 3a20 5b37 2c20 382c       'c': [7, 8,
+00012f70: 2039 5d2c 0a20 2020 2020 2020 207d 290a   9],.        }).
+00012f80: 2020 2020 2020 2020 6f75 7420 3d20 696e          out = in
+00012f90: 7374 616e 6365 2e5f 7472 616e 7366 6f72  stance._transfor
+00012fa0: 6d28 7461 626c 655f 6461 7461 290a 0a20  m(table_data).. 
+00012fb0: 2020 2020 2020 2023 2041 7373 6572 740a         # Assert.
+00012fc0: 2020 2020 2020 2020 6578 7065 6374 6564          expected
+00012fd0: 5f6f 7574 203d 2070 642e 4461 7461 4672  _out = pd.DataFr
+00012fe0: 616d 6528 7b0a 2020 2020 2020 2020 2020  ame({.          
+00012ff0: 2020 2763 273a 205b 372c 2038 2c20 395d    'c': [7, 8, 9]
+00013000: 2c0a 2020 2020 2020 2020 2020 2020 2761  ,.            'a
+00013010: 2327 3a20 5b6e 702e 6c6f 6728 3129 2c20  #': [np.log(1), 
+00013020: 6e70 2e6c 6f67 2832 292c 206e 702e 6c6f  np.log(2), np.lo
+00013030: 6728 3329 5d2c 0a20 2020 2020 2020 207d  g(3)],.        }
+00013040: 290a 2020 2020 2020 2020 7064 2e74 6573  ).        pd.tes
+00013050: 7469 6e67 2e61 7373 6572 745f 6672 616d  ting.assert_fram
+00013060: 655f 6571 7561 6c28 6f75 742c 2065 7870  e_equal(out, exp
+00013070: 6563 7465 645f 6f75 7429 0a0a 2020 2020  ected_out)..    
+00013080: 6465 6620 7465 7374 5f5f 7472 616e 7366  def test__transf
+00013090: 6f72 6d5f 6461 7465 7469 6d65 2873 656c  orm_datetime(sel
+000130a0: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+000130b0: 6573 7420 7468 6520 6060 5363 616c 6172  est the ``Scalar
+000130c0: 496e 6571 7561 6c69 7479 2e5f 7472 616e  Inequality._tran
+000130d0: 7366 6f72 6d60 6020 6d65 7468 6f64 2e0a  sform`` method..
+000130e0: 0a20 2020 2020 2020 2054 6865 206d 6574  .        The met
+000130f0: 686f 6420 6973 2065 7870 6563 7465 6420  hod is expected 
+00013100: 746f 2063 6f6d 7075 7465 2074 6865 2064  to compute the d
+00013110: 6973 7461 6e63 6520 6265 7477 6565 6e20  istance between 
+00013120: 7468 6520 6060 636f 6c75 6d6e 5f6e 616d  the ``column_nam
+00013130: 6560 6020 616e 6420 6060 7661 6c75 6560  e`` and ``value`
+00013140: 600a 2020 2020 2020 2020 616e 6420 6372  `.        and cr
+00013150: 6561 7465 2061 2064 6966 6620 636f 6c75  eate a diff colu
+00013160: 6d6e 2077 6974 6820 7468 6520 6c6f 6761  mn with the loga
+00013170: 7269 7468 6d20 6f66 2074 6865 2064 6973  rithm of the dis
+00013180: 7461 6e63 6520 2b20 312e 0a0a 2020 2020  tance + 1...    
+00013190: 2020 2020 5365 7475 703a 0a20 2020 2020      Setup:.     
+000131a0: 2020 202d 2060 605f 6469 6666 5f63 6f6c     - ``_diff_col
+000131b0: 756d 6e5f 6e61 6d65 6060 2069 7320 7365  umn_name`` is se
+000131c0: 7420 746f 2060 6027 6123 2760 602e 0a20  t to ``'a#'``.. 
+000131d0: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
+000131e0: 2020 2020 2020 2d20 5461 626c 6520 6461        - Table da
+000131f0: 7461 2077 6974 6820 6461 7465 7469 6d65  ta with datetime
+00013200: 732e 0a20 2020 2020 2020 204f 7574 7075  s..        Outpu
+00013210: 743a 0a20 2020 2020 2020 202d 2053 616d  t:.        - Sam
+00013220: 6520 7461 626c 6520 7769 7468 2061 2064  e table with a d
+00013230: 6966 6620 636f 6c75 6d6e 206f 6620 7468  iff column of th
+00013240: 6520 6c6f 6761 7269 7468 6d73 206f 6620  e logarithms of 
+00013250: 7468 6520 6469 7374 616e 6365 7320 2b20  the distances + 
+00013260: 310a 2020 2020 2020 2020 2020 696e 2074  1.          in t
+00013270: 6865 2060 6063 6f6c 756d 6e5f 6e61 6d65  he ``column_name
+00013280: 6060 2773 2070 6c61 6365 2e0a 2020 2020  ``'s place..    
+00013290: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000132a0: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
+000132b0: 696e 7374 616e 6365 203d 2053 6361 6c61  instance = Scala
+000132c0: 7249 6e65 7175 616c 6974 7928 0a20 2020  rInequality(.   
+000132d0: 2020 2020 2020 2020 2063 6f6c 756d 6e5f           column_
+000132e0: 6e61 6d65 3d27 6127 2c0a 2020 2020 2020  name='a',.      
+000132f0: 2020 2020 2020 7661 6c75 653d 2732 3032        value='202
+00013300: 302d 3031 2d30 3154 3030 3a30 303a 3030  0-01-01T00:00:00
+00013310: 272c 0a20 2020 2020 2020 2020 2020 2072  ',.            r
+00013320: 656c 6174 696f 6e3d 273e 2729 0a20 2020  elation='>').   
+00013330: 2020 2020 2069 6e73 7461 6e63 652e 5f64       instance._d
+00013340: 6966 665f 636f 6c75 6d6e 5f6e 616d 6520  iff_column_name 
+00013350: 3d20 2761 2327 0a20 2020 2020 2020 2069  = 'a#'.        i
+00013360: 6e73 7461 6e63 652e 5f69 735f 6461 7465  nstance._is_date
+00013370: 7469 6d65 203d 2054 7275 650a 0a20 2020  time = True..   
+00013380: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
+00013390: 2020 2074 6162 6c65 5f64 6174 6120 3d20     table_data = 
+000133a0: 7064 2e44 6174 6146 7261 6d65 287b 0a20  pd.DataFrame({. 
+000133b0: 2020 2020 2020 2020 2020 2027 6127 3a20             'a': 
+000133c0: 7064 2e74 6f5f 6461 7465 7469 6d65 285b  pd.to_datetime([
+000133d0: 2732 3032 302d 3031 2d30 3154 3030 3a30  '2020-01-01T00:0
+000133e0: 303a 3031 272c 2027 3230 3230 2d30 312d  0:01', '2020-01-
+000133f0: 3031 5430 303a 3030 3a30 3127 5d29 2c0a  01T00:00:01']),.
+00013400: 2020 2020 2020 2020 2020 2020 2763 273a              'c':
+00013410: 205b 312c 2032 5d2c 0a20 2020 2020 2020   [1, 2],.       
+00013420: 207d 290a 2020 2020 2020 2020 6f75 7420   }).        out 
+00013430: 3d20 696e 7374 616e 6365 2e5f 7472 616e  = instance._tran
+00013440: 7366 6f72 6d28 7461 626c 655f 6461 7461  sform(table_data
+00013450: 290a 0a20 2020 2020 2020 2023 2041 7373  )..        # Ass
+00013460: 6572 740a 2020 2020 2020 2020 6578 7065  ert.        expe
+00013470: 6374 6564 5f6f 7574 203d 2070 642e 4461  cted_out = pd.Da
+00013480: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
+00013490: 2020 2020 2020 2763 273a 205b 312c 2032        'c': [1, 2
+000134a0: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
+000134b0: 6123 273a 205b 6e70 2e6c 6f67 2831 5f30  a#': [np.log(1_0
+000134c0: 3030 5f30 3030 5f30 3031 292c 206e 702e  00_000_001), np.
+000134d0: 6c6f 6728 315f 3030 305f 3030 305f 3030  log(1_000_000_00
+000134e0: 3129 5d2c 0a20 2020 2020 2020 207d 290a  1)],.        }).
+000134f0: 2020 2020 2020 2020 7064 2e74 6573 7469          pd.testi
+00013500: 6e67 2e61 7373 6572 745f 6672 616d 655f  ng.assert_frame_
+00013510: 6571 7561 6c28 6f75 742c 2065 7870 6563  equal(out, expec
+00013520: 7465 645f 6f75 7429 0a0a 2020 2020 6465  ted_out)..    de
+00013530: 6620 7465 7374 5f72 6576 6572 7365 5f74  f test_reverse_t
+00013540: 7261 6e73 666f 726d 2873 656c 6629 3a0a  ransform(self):.
+00013550: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
+00013560: 7468 6520 6060 5363 616c 6172 496e 6571  the ``ScalarIneq
+00013570: 7561 6c69 7479 2e72 6576 6572 7365 5f74  uality.reverse_t
+00013580: 7261 6e73 666f 726d 6060 206d 6574 686f  ransform`` metho
+00013590: 642e 0a0a 2020 2020 2020 2020 5468 6520  d...        The 
+000135a0: 6d65 7468 6f64 2069 7320 6578 7065 6374  method is expect
+000135b0: 6564 2074 6f3a 0a20 2020 2020 2020 2020  ed to:.         
+000135c0: 2020 202d 2061 7070 6c79 2061 6e20 6578     - apply an ex
+000135d0: 706f 6e65 6e74 6961 6c20 746f 2074 6865  ponential to the
+000135e0: 2069 6e70 7574 0a20 2020 2020 2020 2020   input.         
+000135f0: 2020 202d 2073 7562 7472 6163 7420 310a     - subtract 1.
+00013600: 2020 2020 2020 2020 2020 2020 2d20 6164              - ad
+00013610: 6420 7468 6520 6060 636f 6c75 6d6e 5f6e  d the ``column_n
+00013620: 616d 6560 600a 2020 2020 2020 2020 2020  ame``.          
+00013630: 2020 2d20 636f 6e76 6572 7420 7468 6520    - convert the 
+00013640: 6f75 7470 7574 2074 6f20 696e 7465 6765  output to intege
+00013650: 7273 0a20 2020 2020 2020 2020 2020 202d  rs.            -
+00013660: 2061 6464 2062 6163 6b20 7468 6520 6472   add back the dr
+00013670: 6f70 7065 6420 636f 6c75 6d6e 0a0a 2020  opped column..  
+00013680: 2020 2020 2020 5365 7475 703a 0a20 2020        Setup:.   
+00013690: 2020 2020 202d 2060 605f 6469 6666 5f63       - ``_diff_c
+000136a0: 6f6c 756d 6e5f 6e61 6d65 203d 2027 6123  olumn_name = 'a#
+000136b0: 2760 600a 2020 2020 2020 2020 2d20 6060  '``.        - ``
+000136c0: 5f64 7479 7065 6060 2061 7320 696e 7465  _dtype`` as inte
+000136d0: 6765 720a 2020 2020 2020 2020 496e 7075  ger.        Inpu
+000136e0: 743a 0a20 2020 2020 2020 202d 2054 6162  t:.        - Tab
+000136f0: 6c65 2077 6974 6820 6120 6469 6666 2063  le with a diff c
+00013700: 6f6c 756d 6e20 7468 6174 2063 6f6e 7461  olumn that conta
+00013710: 696e 7320 7468 6520 636f 6e73 7461 6e74  ins the constant
+00013720: 206e 702e 6c6f 6728 3429 2e0a 2020 2020   np.log(4)..    
+00013730: 2020 2020 4f75 7470 7574 3a0a 2020 2020      Output:.    
+00013740: 2020 2020 2d20 5361 6d65 2074 6162 6c65      - Same table
+00013750: 2077 6974 6820 7468 6520 6869 6768 2063   with the high c
+00013760: 6f6c 756d 6e20 7265 706c 6163 6564 2062  olumn replaced b
+00013770: 7920 7468 6520 6c6f 7720 6f6e 6520 2b20  y the low one + 
+00013780: 332c 2061 7320 696e 740a 2020 2020 2020  3, as int.      
+00013790: 2020 616e 6420 7468 6520 6469 6666 2063    and the diff c
+000137a0: 6f6c 756d 6e20 6472 6f70 7065 642e 0a20  olumn dropped.. 
+000137b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000137c0: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
+000137d0: 2020 2069 6e73 7461 6e63 6520 3d20 5363     instance = Sc
+000137e0: 616c 6172 496e 6571 7561 6c69 7479 2863  alarInequality(c
+000137f0: 6f6c 756d 6e5f 6e61 6d65 3d27 6127 2c20  olumn_name='a', 
+00013800: 7661 6c75 653d 312c 2072 656c 6174 696f  value=1, relatio
+00013810: 6e3d 273e 3d27 290a 2020 2020 2020 2020  n='>=').        
+00013820: 696e 7374 616e 6365 2e5f 6474 7970 6520  instance._dtype 
+00013830: 3d20 7064 2e53 6572 6965 7328 5b31 5d29  = pd.Series([1])
+00013840: 2e64 7479 7065 2020 2320 6578 6163 7420  .dtype  # exact 
+00013850: 6474 7970 6520 2833 3220 6f72 2036 3429  dtype (32 or 64)
+00013860: 2064 6570 656e 6473 206f 6e20 4f53 0a20   depends on OS. 
+00013870: 2020 2020 2020 2069 6e73 7461 6e63 652e         instance.
+00013880: 5f64 6966 665f 636f 6c75 6d6e 5f6e 616d  _diff_column_nam
+00013890: 6520 3d20 2761 2327 0a0a 2020 2020 2020  e = 'a#'..      
+000138a0: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
+000138b0: 7472 616e 7366 6f72 6d65 6420 3d20 7064  transformed = pd
+000138c0: 2e44 6174 6146 7261 6d65 287b 0a20 2020  .DataFrame({.   
+000138d0: 2020 2020 2020 2020 2027 6123 273a 205b           'a#': [
+000138e0: 6e70 2e6c 6f67 2831 292c 206e 702e 6c6f  np.log(1), np.lo
+000138f0: 6728 3229 2c20 6e70 2e6c 6f67 2833 295d  g(2), np.log(3)]
+00013900: 2c0a 2020 2020 2020 2020 2020 2020 2763  ,.            'c
+00013910: 273a 205b 372c 2038 2c20 395d 2c0a 2020  ': [7, 8, 9],.  
+00013920: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
+00013930: 206f 7574 203d 2069 6e73 7461 6e63 652e   out = instance.
+00013940: 7265 7665 7273 655f 7472 616e 7366 6f72  reverse_transfor
+00013950: 6d28 7472 616e 7366 6f72 6d65 6429 0a0a  m(transformed)..
+00013960: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
+00013970: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+00013980: 645f 6f75 7420 3d20 7064 2e44 6174 6146  d_out = pd.DataF
+00013990: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
+000139a0: 2020 2027 6327 3a20 5b37 2c20 382c 2039     'c': [7, 8, 9
+000139b0: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
+000139c0: 6127 3a20 5b31 2c20 322c 2033 5d2c 0a20  a': [1, 2, 3],. 
+000139d0: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
+000139e0: 2020 7064 2e74 6573 7469 6e67 2e61 7373    pd.testing.ass
+000139f0: 6572 745f 6672 616d 655f 6571 7561 6c28  ert_frame_equal(
+00013a00: 6f75 742c 2065 7870 6563 7465 645f 6f75  out, expected_ou
+00013a10: 7429 0a0a 2020 2020 6465 6620 7465 7374  t)..    def test
+00013a20: 5f72 6576 6572 7365 5f74 7261 6e73 666f  _reverse_transfo
+00013a30: 726d 5f66 6c6f 6174 7328 7365 6c66 293a  rm_floats(self):
+00013a40: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+00013a50: 2074 6865 2060 6053 6361 6c61 7249 6e65   the ``ScalarIne
+00013a60: 7175 616c 6974 792e 7265 7665 7273 655f  quality.reverse_
+00013a70: 7472 616e 7366 6f72 6d60 6020 6d65 7468  transform`` meth
+00013a80: 6f64 2e0a 0a20 2020 2020 2020 2054 6865  od...        The
+00013a90: 206d 6574 686f 6420 6973 2065 7870 6563   method is expec
+00013aa0: 7465 6420 746f 3a0a 2020 2020 2020 2020  ted to:.        
+00013ab0: 2020 2020 2d20 6170 706c 7920 616e 2065      - apply an e
+00013ac0: 7870 6f6e 656e 7469 616c 2074 6f20 7468  xponential to th
+00013ad0: 6520 696e 7075 740a 2020 2020 2020 2020  e input.        
+00013ae0: 2020 2020 2d20 7375 6274 7261 6374 2031      - subtract 1
+00013af0: 0a20 2020 2020 2020 2020 2020 202d 2061  .            - a
+00013b00: 6464 2074 6865 2060 6076 616c 7565 6060  dd the ``value``
+00013b10: 0a20 2020 2020 2020 2020 2020 202d 2063  .            - c
+00013b20: 6f6e 7665 7274 2074 6865 206f 7574 7075  onvert the outpu
+00013b30: 7420 746f 2066 6c6f 6174 0a20 2020 2020  t to float.     
+00013b40: 2020 2020 2020 202d 2061 6464 2062 6163         - add bac
+00013b50: 6b20 7468 6520 6472 6f70 7065 6420 636f  k the dropped co
+00013b60: 6c75 6d6e 0a0a 2020 2020 2020 2020 5365  lumn..        Se
+00013b70: 7475 703a 0a20 2020 2020 2020 202d 2060  tup:.        - `
+00013b80: 605f 6469 6666 5f63 6f6c 756d 6e5f 6e61  `_diff_column_na
+00013b90: 6d65 203d 2027 6123 2760 600a 2020 2020  me = 'a#'``.    
+00013ba0: 2020 2020 2d20 6060 5f64 7479 7065 6060      - ``_dtype``
+00013bb0: 2061 7320 666c 6f61 740a 2020 2020 2020   as float.      
+00013bc0: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
+00013bd0: 202d 2054 6162 6c65 2077 6974 6820 6120   - Table with a 
+00013be0: 6469 6666 2063 6f6c 756d 6e20 7468 6174  diff column that
+00013bf0: 2063 6f6e 7461 696e 7320 7468 6520 636f   contains the co
+00013c00: 6e73 7461 6e74 206e 702e 6c6f 6728 3429  nstant np.log(4)
+00013c10: 2e0a 2020 2020 2020 2020 4f75 7470 7574  ..        Output
+00013c20: 3a0a 2020 2020 2020 2020 2d20 5361 6d65  :.        - Same
+00013c30: 2074 6162 6c65 2077 6974 6820 7468 6520   table with the 
+00013c40: 6869 6768 2063 6f6c 756d 6e20 7265 706c  high column repl
+00013c50: 6163 6564 2062 7920 7468 6520 6c6f 7720  aced by the low 
+00013c60: 6f6e 6520 2b20 312c 2061 7320 666c 6f61  one + 1, as floa
+00013c70: 740a 2020 2020 2020 2020 616e 6420 7468  t.        and th
+00013c80: 6520 6469 6666 2063 6f6c 756d 6e20 6472  e diff column dr
+00013c90: 6f70 7065 642e 0a20 2020 2020 2020 2022  opped..        "
+00013ca0: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
+00013cb0: 7570 0a20 2020 2020 2020 2069 6e73 7461  up.        insta
+00013cc0: 6e63 6520 3d20 5363 616c 6172 496e 6571  nce = ScalarIneq
+00013cd0: 7561 6c69 7479 2863 6f6c 756d 6e5f 6e61  uality(column_na
+00013ce0: 6d65 3d27 6127 2c20 7661 6c75 653d 312c  me='a', value=1,
+00013cf0: 2072 656c 6174 696f 6e3d 273e 3d27 290a   relation='>=').
+00013d00: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+00013d10: 2e5f 6474 7970 6520 3d20 6e70 2e64 7479  ._dtype = np.dty
+00013d20: 7065 2827 666c 6f61 7427 290a 2020 2020  pe('float').    
+00013d30: 2020 2020 696e 7374 616e 6365 2e5f 6469      instance._di
+00013d40: 6666 5f63 6f6c 756d 6e5f 6e61 6d65 203d  ff_column_name =
+00013d50: 2027 6123 270a 0a20 2020 2020 2020 2023   'a#'..        #
+00013d60: 2052 756e 0a20 2020 2020 2020 2074 7261   Run.        tra
+00013d70: 6e73 666f 726d 6564 203d 2070 642e 4461  nsformed = pd.Da
+00013d80: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
+00013d90: 2020 2020 2020 2761 2327 3a20 5b6e 702e        'a#': [np.
+00013da0: 6c6f 6728 312e 3129 2c20 6e70 2e6c 6f67  log(1.1), np.log
+00013db0: 2832 2e31 292c 206e 702e 6c6f 6728 332e  (2.1), np.log(3.
+00013dc0: 3329 5d2c 0a20 2020 2020 2020 2020 2020  3)],.           
+00013dd0: 2027 6327 3a20 5b37 2c20 382c 2039 5d2c   'c': [7, 8, 9],
+00013de0: 0a20 2020 2020 2020 207d 290a 2020 2020  .        }).    
+00013df0: 2020 2020 6f75 7420 3d20 696e 7374 616e      out = instan
+00013e00: 6365 2e72 6576 6572 7365 5f74 7261 6e73  ce.reverse_trans
+00013e10: 666f 726d 2874 7261 6e73 666f 726d 6564  form(transformed
+00013e20: 290a 0a20 2020 2020 2020 2023 2041 7373  )..        # Ass
+00013e30: 6572 740a 2020 2020 2020 2020 6578 7065  ert.        expe
+00013e40: 6374 6564 5f6f 7574 203d 2070 642e 4461  cted_out = pd.Da
+00013e50: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
+00013e60: 2020 2020 2020 2763 273a 205b 372c 2038        'c': [7, 8
+00013e70: 2c20 395d 2c0a 2020 2020 2020 2020 2020  , 9],.          
+00013e80: 2020 2761 273a 205b 312e 312c 2032 2e31    'a': [1.1, 2.1
+00013e90: 2c20 332e 335d 2c0a 2020 2020 2020 2020  , 3.3],.        
+00013ea0: 7d29 0a20 2020 2020 2020 2070 642e 7465  }).        pd.te
+00013eb0: 7374 696e 672e 6173 7365 7274 5f66 7261  sting.assert_fra
+00013ec0: 6d65 5f65 7175 616c 286f 7574 2c20 6578  me_equal(out, ex
+00013ed0: 7065 6374 6564 5f6f 7574 290a 0a20 2020  pected_out)..   
+00013ee0: 2064 6566 2074 6573 745f 7265 7665 7273   def test_revers
+00013ef0: 655f 7472 616e 7366 6f72 6d5f 6461 7465  e_transform_date
+00013f00: 7469 6d65 2873 656c 6629 3a0a 2020 2020  time(self):.    
+00013f10: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
+00013f20: 6060 5363 616c 6172 496e 6571 7561 6c69  ``ScalarInequali
+00013f30: 7479 2e72 6576 6572 7365 5f74 7261 6e73  ty.reverse_trans
+00013f40: 666f 726d 6060 206d 6574 686f 642e 0a0a  form`` method...
+00013f50: 2020 2020 2020 2020 5468 6520 6d65 7468          The meth
+00013f60: 6f64 2069 7320 6578 7065 6374 6564 2074  od is expected t
+00013f70: 6f3a 0a20 2020 2020 2020 2020 2020 202d  o:.            -
+00013f80: 2061 7070 6c79 2061 6e20 6578 706f 6e65   apply an expone
+00013f90: 6e74 6961 6c20 746f 2074 6865 2069 6e70  ntial to the inp
+00013fa0: 7574 0a20 2020 2020 2020 2020 2020 202d  ut.            -
+00013fb0: 2073 7562 7472 6163 7420 310a 2020 2020   subtract 1.    
+00013fc0: 2020 2020 2020 2020 2d20 6164 6420 7468          - add th
+00013fd0: 6520 6060 636f 6c75 6d6e 5f6e 616d 6560  e ``column_name`
+00013fe0: 600a 2020 2020 2020 2020 2020 2020 2d20  `.            - 
+00013ff0: 636f 6e76 6572 7420 7468 6520 6f75 7470  convert the outp
+00014000: 7574 2074 6f20 6461 7465 7469 6d65 0a20  ut to datetime. 
+00014010: 2020 2020 2020 2020 2020 202d 2061 6464             - add
+00014020: 2062 6163 6b20 7468 6520 6472 6f70 7065   back the droppe
+00014030: 6420 636f 6c75 6d6e 0a0a 2020 2020 2020  d column..      
+00014040: 2020 5365 7475 703a 0a20 2020 2020 2020    Setup:.       
+00014050: 202d 2060 605f 6469 6666 5f63 6f6c 756d   - ``_diff_colum
+00014060: 6e5f 6e61 6d65 203d 2027 6123 2760 600a  n_name = 'a#'``.
+00014070: 2020 2020 2020 2020 2d20 6060 5f64 7479          - ``_dty
+00014080: 7065 6060 2061 7320 6461 7465 7469 6d65  pe`` as datetime
+00014090: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
+000140a0: 2020 2020 2020 2020 2d20 5461 626c 6520          - Table 
+000140b0: 7769 7468 2061 2064 6966 6620 636f 6c75  with a diff colu
+000140c0: 6d6e 2074 6861 7420 636f 6e74 6169 6e73  mn that contains
+000140d0: 2074 6865 2063 6f6e 7374 616e 7420 6e70   the constant np
+000140e0: 2e6c 6f67 2834 292e 0a20 2020 2020 2020  .log(4)..       
+000140f0: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
+00014100: 202d 2053 616d 6520 7461 626c 6520 7769   - Same table wi
+00014110: 7468 2074 6865 2068 6967 6820 636f 6c75  th the high colu
+00014120: 6d6e 2072 6570 6c61 6365 6420 6279 2074  mn replaced by t
+00014130: 6865 206c 6f77 206f 6e65 202b 2033 2c20  he low one + 3, 
+00014140: 6173 2064 6174 6574 696d 650a 2020 2020  as datetime.    
+00014150: 2020 2020 616e 6420 7468 6520 6469 6666      and the diff
+00014160: 2063 6f6c 756d 6e20 6472 6f70 7065 642e   column dropped.
+00014170: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00014180: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
+00014190: 2020 2020 2069 6e73 7461 6e63 6520 3d20       instance = 
+000141a0: 5363 616c 6172 496e 6571 7561 6c69 7479  ScalarInequality
+000141b0: 280a 2020 2020 2020 2020 2020 2020 636f  (.            co
+000141c0: 6c75 6d6e 5f6e 616d 653d 2761 272c 0a20  lumn_name='a',. 
+000141d0: 2020 2020 2020 2020 2020 2076 616c 7565             value
+000141e0: 3d27 3230 3230 2d30 312d 3031 5430 303a  ='2020-01-01T00:
+000141f0: 3030 3a30 3027 2c0a 2020 2020 2020 2020  00:00',.        
+00014200: 2020 2020 7265 6c61 7469 6f6e 3d27 3e3d      relation='>=
+00014210: 2729 0a20 2020 2020 2020 2069 6e73 7461  ').        insta
+00014220: 6e63 652e 5f64 7479 7065 203d 206e 702e  nce._dtype = np.
+00014230: 6474 7970 6528 273c 4d38 5b6e 735d 2729  dtype('<M8[ns]')
+00014240: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
+00014250: 652e 5f64 6966 665f 636f 6c75 6d6e 5f6e  e._diff_column_n
+00014260: 616d 6520 3d20 2761 2327 0a20 2020 2020  ame = 'a#'.     
+00014270: 2020 2069 6e73 7461 6e63 652e 5f69 735f     instance._is_
+00014280: 6461 7465 7469 6d65 203d 2054 7275 650a  datetime = True.
+00014290: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+000142a0: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
+000142b0: 6564 203d 2070 642e 4461 7461 4672 616d  ed = pd.DataFram
+000142c0: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
+000142d0: 2761 2327 3a20 5b6e 702e 6c6f 6728 315f  'a#': [np.log(1_
+000142e0: 3030 305f 3030 305f 3030 3129 2c20 6e70  000_000_001), np
+000142f0: 2e6c 6f67 2831 5f30 3030 5f30 3030 5f30  .log(1_000_000_0
+00014300: 3031 295d 2c0a 2020 2020 2020 2020 2020  01)],.          
+00014310: 2020 2763 273a 205b 312c 2032 5d2c 0a20    'c': [1, 2],. 
+00014320: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
+00014330: 2020 6f75 7420 3d20 696e 7374 616e 6365    out = instance
+00014340: 2e72 6576 6572 7365 5f74 7261 6e73 666f  .reverse_transfo
+00014350: 726d 2874 7261 6e73 666f 726d 6564 290a  rm(transformed).
+00014360: 0a20 2020 2020 2020 2023 2041 7373 6572  .        # Asser
+00014370: 740a 2020 2020 2020 2020 6578 7065 6374  t.        expect
+00014380: 6564 5f6f 7574 203d 2070 642e 4461 7461  ed_out = pd.Data
+00014390: 4672 616d 6528 7b0a 2020 2020 2020 2020  Frame({.        
+000143a0: 2020 2020 2763 273a 205b 312c 2032 5d2c      'c': [1, 2],
+000143b0: 0a20 2020 2020 2020 2020 2020 2027 6127  .            'a'
+000143c0: 3a20 7064 2e74 6f5f 6461 7465 7469 6d65  : pd.to_datetime
+000143d0: 285b 2732 3032 302d 3031 2d30 3154 3030  (['2020-01-01T00
+000143e0: 3a30 303a 3031 272c 2027 3230 3230 2d30  :00:01', '2020-0
+000143f0: 312d 3031 5430 303a 3030 3a30 3127 5d29  1-01T00:00:01'])
+00014400: 2c0a 2020 2020 2020 2020 7d29 0a20 2020  ,.        }).   
+00014410: 2020 2020 2070 642e 7465 7374 696e 672e       pd.testing.
+00014420: 6173 7365 7274 5f66 7261 6d65 5f65 7175  assert_frame_equ
+00014430: 616c 286f 7574 2c20 6578 7065 6374 6564  al(out, expected
+00014440: 5f6f 7574 290a 0a20 2020 2064 6566 2074  _out)..    def t
+00014450: 6573 745f 7265 7665 7273 655f 7472 616e  est_reverse_tran
+00014460: 7366 6f72 6d5f 6f70 6572 6174 6f72 5f6c  sform_operator_l
+00014470: 6573 7328 7365 6c66 293a 0a20 2020 2020  ess(self):.     
+00014480: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
+00014490: 6053 6361 6c61 7249 6e65 7175 616c 6974  `ScalarInequalit
+000144a0: 792e 7265 7665 7273 655f 7472 616e 7366  y.reverse_transf
+000144b0: 6f72 6d60 6020 6d65 7468 6f64 2077 6865  orm`` method whe
+000144c0: 6e20 6f70 6572 6174 6f72 2069 7320 6060  n operator is ``
+000144d0: 6e70 2e6c 6573 7360 602e 2222 220a 2020  np.less``.""".  
+000144e0: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
+000144f0: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
+00014500: 2053 6361 6c61 7249 6e65 7175 616c 6974   ScalarInequalit
+00014510: 7928 636f 6c75 6d6e 5f6e 616d 653d 2761  y(column_name='a
+00014520: 272c 2076 616c 7565 3d31 2c20 7265 6c61  ', value=1, rela
+00014530: 7469 6f6e 3d27 3c27 290a 2020 2020 2020  tion='<').      
+00014540: 2020 696e 7374 616e 6365 2e5f 6474 7970    instance._dtyp
+00014550: 6520 3d20 6e70 2e64 7479 7065 2827 666c  e = np.dtype('fl
+00014560: 6f61 7427 290a 2020 2020 2020 2020 696e  oat').        in
+00014570: 7374 616e 6365 2e5f 6469 6666 5f63 6f6c  stance._diff_col
+00014580: 756d 6e5f 6e61 6d65 203d 2027 6123 270a  umn_name = 'a#'.
+00014590: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+000145a0: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
+000145b0: 6564 203d 2070 642e 4461 7461 4672 616d  ed = pd.DataFram
+000145c0: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
+000145d0: 2761 2327 3a20 5b6e 702e 6c6f 6728 312e  'a#': [np.log(1.
+000145e0: 3129 2c20 6e70 2e6c 6f67 2832 2e31 292c  1), np.log(2.1),
+000145f0: 206e 702e 6c6f 6728 332e 3329 5d2c 0a20   np.log(3.3)],. 
+00014600: 2020 2020 2020 2020 2020 2027 6327 3a20             'c': 
+00014610: 5b37 2c20 382c 2039 5d2c 0a20 2020 2020  [7, 8, 9],.     
+00014620: 2020 207d 290a 2020 2020 2020 2020 6f75     }).        ou
+00014630: 7420 3d20 696e 7374 616e 6365 2e72 6576  t = instance.rev
+00014640: 6572 7365 5f74 7261 6e73 666f 726d 2874  erse_transform(t
+00014650: 7261 6e73 666f 726d 6564 290a 0a20 2020  ransformed)..   
+00014660: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
+00014670: 2020 2020 2020 6578 7065 6374 6564 5f6f        expected_o
+00014680: 7574 203d 2070 642e 4461 7461 4672 616d  ut = pd.DataFram
+00014690: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
+000146a0: 2763 273a 205b 372c 2038 2c20 395d 2c0a  'c': [7, 8, 9],.
+000146b0: 2020 2020 2020 2020 2020 2020 2761 273a              'a':
+000146c0: 205b 302e 392c 202d 302e 312c 202d 312e   [0.9, -0.1, -1.
+000146d0: 335d 2c0a 2020 2020 2020 2020 7d29 0a20  3],.        }). 
+000146e0: 2020 2020 2020 2070 642e 7465 7374 696e         pd.testin
+000146f0: 672e 6173 7365 7274 5f66 7261 6d65 5f65  g.assert_frame_e
+00014700: 7175 616c 286f 7574 2c20 6578 7065 6374  qual(out, expect
+00014710: 6564 5f6f 7574 290a 0a0a 636c 6173 7320  ed_out)...class 
+00014720: 5465 7374 506f 7369 7469 7665 2829 3a0a  TestPositive():.
+00014730: 0a20 2020 2064 6566 2074 6573 745f 5f76  .    def test__v
+00014740: 616c 6964 6174 655f 696e 7075 7473 2873  alidate_inputs(s
+00014750: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00014760: 2254 6573 7420 7468 6520 6060 506f 7369  "Test the ``Posi
+00014770: 7469 7665 2e5f 7661 6c69 6461 7465 5f69  tive._validate_i
+00014780: 6e70 7574 7360 6020 6d65 7468 6f64 2e0a  nputs`` method..
+00014790: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
+000147a0: 2020 2020 2020 2020 2d20 2049 6e63 6f72          -  Incor
+000147b0: 7265 6374 2070 6172 616d 6574 6572 7320  rect parameters 
+000147c0: 666f 7220 7468 6520 6d65 7468 6f64 0a20  for the method. 
+000147d0: 2020 2020 2020 2052 6169 7365 733a 0a20         Raises:. 
+000147e0: 2020 2020 2020 202d 204c 6973 7420 6f66         - List of
+000147f0: 2056 616c 7565 4572 726f 7273 0a20 2020   ValueErrors.   
+00014800: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00014810: 2023 2052 756e 202f 2041 7373 6572 740a   # Run / Assert.
+00014820: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+00014830: 6573 742e 7261 6973 6573 2841 6767 7265  est.raises(Aggre
+00014840: 6761 7465 436f 6e73 7472 6169 6e74 7345  gateConstraintsE
+00014850: 7272 6f72 2920 6173 2065 7272 6f72 3a0a  rror) as error:.
+00014860: 2020 2020 2020 2020 2020 2020 506f 7369              Posi
+00014870: 7469 7665 2e5f 7661 6c69 6461 7465 5f69  tive._validate_i
+00014880: 6e70 7574 7328 6e6f 745f 636f 6c75 6d6e  nputs(not_column
+00014890: 5f6e 616d 653d 4e6f 6e65 2c20 736f 6d65  _name=None, some
+000148a0: 7468 696e 675f 656c 7365 3d4e 6f6e 6529  thing_else=None)
+000148b0: 0a0a 2020 2020 2020 2020 6572 725f 6d73  ..        err_ms
+000148c0: 6720 3d20 280a 2020 2020 2020 2020 2020  g = (.          
+000148d0: 2020 7227 4d69 7373 696e 6720 7265 7175    r'Missing requ
+000148e0: 6972 6564 2076 616c 7565 7320 7b28 2e2a  ired values {(.*
+000148f0: 297d 2069 6e20 6120 506f 7369 7469 7665  )} in a Positive
+00014900: 2063 6f6e 7374 7261 696e 742e 270a 2020   constraint.'.  
+00014910: 2020 2020 2020 2020 2020 7227 5c6e 5c6e            r'\n\n
+00014920: 496e 7661 6c69 6420 7661 6c75 6573 207b  Invalid values {
+00014930: 282e 2a29 7d20 6172 6520 7072 6573 656e  (.*)} are presen
+00014940: 7420 696e 2061 2050 6f73 6974 6976 6520  t in a Positive 
+00014950: 636f 6e73 7472 6169 6e74 2e27 0a20 2020  constraint.'.   
+00014960: 2020 2020 2029 0a20 2020 2020 2020 2067       ).        g
+00014970: 726f 7570 7320 3d20 7265 2e73 6561 7263  roups = re.searc
+00014980: 6828 6572 725f 6d73 672c 2073 7472 2865  h(err_msg, str(e
+00014990: 7272 6f72 2e76 616c 7565 2929 0a20 2020  rror.value)).   
+000149a0: 2020 2020 2061 7373 6572 7420 6772 6f75       assert grou
+000149b0: 7073 2069 7320 6e6f 7420 4e6f 6e65 0a20  ps is not None. 
+000149c0: 2020 2020 2020 2061 7373 6572 7420 7374         assert st
+000149d0: 7228 6576 616c 2867 726f 7570 732e 6772  r(eval(groups.gr
+000149e0: 6f75 7028 3129 2929 203d 3d20 2763 6f6c  oup(1))) == 'col
+000149f0: 756d 6e5f 6e61 6d65 270a 2020 2020 2020  umn_name'.      
+00014a00: 2020 6173 7365 7274 2073 6574 2865 7661    assert set(eva
+00014a10: 6c28 6772 6f75 7073 2e67 726f 7570 2832  l(groups.group(2
+00014a20: 2929 2920 3d3d 207b 2773 6f6d 6574 6869  ))) == {'somethi
+00014a30: 6e67 5f65 6c73 6527 2c20 276e 6f74 5f63  ng_else', 'not_c
+00014a40: 6f6c 756d 6e5f 6e61 6d65 277d 0a0a 2020  olumn_name'}..  
+00014a50: 2020 6465 6620 7465 7374 5f5f 7661 6c69    def test__vali
+00014a60: 6461 7465 5f6d 6574 6164 6174 615f 636f  date_metadata_co
+00014a70: 6c75 6d6e 7328 7365 6c66 293a 0a20 2020  lumns(self):.   
+00014a80: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+00014a90: 2060 605f 7661 6c69 6461 7465 5f6d 6574   ``_validate_met
+00014aa0: 6164 6174 615f 636f 6c75 6d6e 7360 6020  adata_columns`` 
+00014ab0: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
+00014ac0: 2054 6865 2063 6f6c 756d 6e20 7061 7373   The column pass
+00014ad0: 6564 2069 6e20 636f 6c75 6d6e 5f6e 616d  ed in column_nam
+00014ae0: 6520 7368 6f75 6c64 2062 6520 696e 2074  e should be in t
+00014af0: 6865 206d 6574 6164 6174 612e 0a0a 2020  he metadata...  
+00014b00: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
+00014b10: 2020 2020 2020 2020 202d 2063 6f6c 756d           - colum
+00014b20: 6e5f 6e61 6d65 2074 6861 7420 6973 2069  n_name that is i
+00014b30: 6e20 7468 6520 6d65 7461 6461 7461 2e0a  n the metadata..
+00014b40: 0a20 2020 2020 2020 2053 6964 6520 6566  .        Side ef
+00014b50: 6665 6374 3a0a 2020 2020 2020 2020 2020  fect:.          
+00014b60: 2020 2d20 4e6f 2065 7272 6f72 2073 686f    - No error sho
+00014b70: 756c 6420 6265 2072 6169 7365 642e 0a20  uld be raised.. 
+00014b80: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00014b90: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
+00014ba0: 2020 206d 6574 6164 6174 6120 3d20 4d6f     metadata = Mo
+00014bb0: 636b 2829 0a20 2020 2020 2020 206d 6574  ck().        met
+00014bc0: 6164 6174 612e 636f 6c75 6d6e 7320 3d20  adata.columns = 
+00014bd0: 7b27 6127 3a20 312c 2027 6227 3a20 327d  {'a': 1, 'b': 2}
+00014be0: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
+00014bf0: 2020 2020 2020 2020 506f 7369 7469 7665          Positive
+00014c00: 2e5f 7661 6c69 6461 7465 5f6d 6574 6164  ._validate_metad
+00014c10: 6174 615f 636f 6c75 6d6e 7328 6d65 7461  ata_columns(meta
+00014c20: 6461 7461 2c20 636f 6c75 6d6e 5f6e 616d  data, column_nam
+00014c30: 653d 2761 2729 0a0a 2020 2020 6465 6620  e='a')..    def 
+00014c40: 7465 7374 5f5f 7661 6c69 6461 7465 5f6d  test__validate_m
+00014c50: 6574 6164 6174 615f 636f 6c75 6d6e 735f  etadata_columns_
+00014c60: 7261 6973 6573 5f65 7272 6f72 2873 656c  raises_error(sel
+00014c70: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+00014c80: 6573 7420 7468 6520 6060 5f76 616c 6964  est the ``_valid
+00014c90: 6174 655f 6d65 7461 6461 7461 5f63 6f6c  ate_metadata_col
+00014ca0: 756d 6e73 6060 206d 6574 686f 6427 7320  umns`` method's 
+00014cb0: 6572 726f 7220 636f 6e64 6974 696f 6e2e  error condition.
+00014cc0: 0a0a 2020 2020 2020 2020 4966 2063 6f6c  ..        If col
+00014cd0: 756d 6e5f 6e61 6d65 2069 7320 6e6f 7420  umn_name is not 
+00014ce0: 696e 2074 6865 206d 6574 6164 6174 612c  in the metadata,
+00014cf0: 2061 6e20 6572 726f 7220 7368 6f75 6c64   an error should
+00014d00: 2062 6520 7261 6973 6564 2e0a 0a20 2020   be raised...   
+00014d10: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
+00014d20: 2020 2020 2020 2020 2d20 636f 6c75 6d6e          - column
+00014d30: 5f6e 616d 6520 7468 6174 2069 7320 6e6f  _name that is no
+00014d40: 7420 696e 2074 6865 206d 6574 6164 6174  t in the metadat
+00014d50: 612e 0a0a 2020 2020 2020 2020 5369 6465  a...        Side
+00014d60: 2065 6666 6563 743a 0a20 2020 2020 2020   effect:.       
+00014d70: 2020 2020 202d 2043 6f6e 7374 7261 696e       - Constrain
+00014d80: 744d 6574 6164 6174 6145 7272 6f72 2073  tMetadataError s
+00014d90: 686f 756c 6420 6265 2072 6169 7365 642e  hould be raised.
+00014da0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00014db0: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
+00014dc0: 2020 2020 206d 6574 6164 6174 6120 3d20       metadata = 
+00014dd0: 4d6f 636b 2829 0a20 2020 2020 2020 206d  Mock().        m
+00014de0: 6574 6164 6174 612e 636f 6c75 6d6e 7320  etadata.columns 
+00014df0: 3d20 7b27 6127 3a20 312c 2027 6227 3a20  = {'a': 1, 'b': 
+00014e00: 327d 0a0a 2020 2020 2020 2020 2320 5275  2}..        # Ru
+00014e10: 6e0a 2020 2020 2020 2020 6572 726f 725f  n.        error_
+00014e20: 6d65 7373 6167 6520 3d20 7265 2e65 7363  message = re.esc
+00014e30: 6170 6528 0a20 2020 2020 2020 2020 2020  ape(.           
+00014e40: 2027 4120 506f 7369 7469 7665 2063 6f6e   'A Positive con
+00014e50: 7374 7261 696e 7420 6973 2062 6569 6e67  straint is being
+00014e60: 2061 7070 6c69 6564 2074 6f20 696e 7661   applied to inva
+00014e70: 6c69 6420 636f 6c75 6d6e 206e 616d 6573  lid column names
+00014e80: 2027 0a20 2020 2020 2020 2020 2020 2022   '.            "
+00014e90: 7b27 6327 7d2e 2054 6865 2063 6f6c 756d  {'c'}. The colum
+00014ea0: 6e73 206d 7573 7420 6578 6973 7420 696e  ns must exist in
+00014eb0: 2074 6865 2074 6162 6c65 2e22 0a20 2020   the table.".   
+00014ec0: 2020 2020 2029 0a20 2020 2020 2020 2077       ).        w
+00014ed0: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+00014ee0: 7328 436f 6e73 7472 6169 6e74 4d65 7461  s(ConstraintMeta
+00014ef0: 6461 7461 4572 726f 722c 206d 6174 6368  dataError, match
+00014f00: 3d65 7272 6f72 5f6d 6573 7361 6765 293a  =error_message):
+00014f10: 0a20 2020 2020 2020 2020 2020 2050 6f73  .            Pos
+00014f20: 6974 6976 652e 5f76 616c 6964 6174 655f  itive._validate_
+00014f30: 6d65 7461 6461 7461 5f63 6f6c 756d 6e73  metadata_columns
+00014f40: 286d 6574 6164 6174 612c 2063 6f6c 756d  (metadata, colum
+00014f50: 6e5f 6e61 6d65 3d27 6327 290a 0a20 2020  n_name='c')..   
+00014f60: 2064 6566 2074 6573 745f 5f76 616c 6964   def test__valid
+00014f70: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
+00014f80: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
+00014f90: 696e 7428 7365 6c66 293a 0a20 2020 2020  int(self):.     
+00014fa0: 2020 2022 2222 2054 6573 7420 7468 6520     """ Test the 
+00014fb0: 6060 5f76 616c 6964 6174 655f 6d65 7461  ``_validate_meta
+00014fc0: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
+00014fd0: 5f63 6f6e 7374 7261 696e 7460 6020 6d65  _constraint`` me
+00014fe0: 7468 6f64 2e0a 0a20 2020 2020 2020 2049  thod...        I
+00014ff0: 6620 7468 6520 636f 6c75 6d6e 206e 616d  f the column nam
+00015000: 6520 7072 6f76 6964 6564 2068 6173 2061  e provided has a
+00015010: 6e20 7364 7479 7065 206f 6620 6e75 6d65  n sdtype of nume
+00015020: 7269 6361 6c2c 2074 6865 6e20 6e6f 2065  rical, then no e
+00015030: 7272 6f72 2073 686f 756c 640a 2020 2020  rror should.    
+00015040: 2020 2020 6265 2072 6169 7365 642e 0a0a      be raised...
+00015050: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
+00015060: 2020 2020 2020 2020 2020 202d 204d 6574             - Met
+00015070: 6164 6174 6120 7769 7468 2074 6865 2063  adata with the c
+00015080: 6f6c 756d 6e27 7320 7364 7479 7065 2073  olumn's sdtype s
+00015090: 6574 2074 6f20 6e75 6d65 7269 6361 6c2e  et to numerical.
+000150a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000150b0: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
+000150c0: 2020 2020 206d 6574 6164 6174 6120 3d20       metadata = 
+000150d0: 4d6f 636b 2829 0a20 2020 2020 2020 206d  Mock().        m
+000150e0: 6574 6164 6174 612e 636f 6c75 6d6e 7320  etadata.columns 
+000150f0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00015100: 2761 273a 207b 2773 6474 7970 6527 3a20  'a': {'sdtype': 
+00015110: 276e 756d 6572 6963 616c 277d 0a20 2020  'numerical'}.   
+00015120: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
+00015130: 2320 5275 6e0a 2020 2020 2020 2020 506f  # Run.        Po
+00015140: 7369 7469 7665 2e5f 7661 6c69 6461 7465  sitive._validate
+00015150: 5f6d 6574 6164 6174 615f 7370 6563 6966  _metadata_specif
+00015160: 6963 5f74 6f5f 636f 6e73 7472 6169 6e74  ic_to_constraint
+00015170: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
+00015180: 7461 6461 7461 2c0a 2020 2020 2020 2020  tadata,.        
+00015190: 2020 2020 636f 6c75 6d6e 5f6e 616d 653d      column_name=
+000151a0: 2761 270a 2020 2020 2020 2020 290a 0a20  'a'.        ).. 
+000151b0: 2020 2064 6566 2074 6573 745f 5f76 616c     def test__val
+000151c0: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
+000151d0: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
+000151e0: 7261 696e 745f 6572 726f 7228 7365 6c66  raint_error(self
+000151f0: 293a 0a20 2020 2020 2020 2022 2222 2054  ):.        """ T
+00015200: 6573 7420 7468 6520 6060 5f76 616c 6964  est the ``_valid
+00015210: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
+00015220: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
+00015230: 696e 7460 6020 6d65 7468 6f64 2e0a 0a20  int`` method... 
+00015240: 2020 2020 2020 2049 6620 7468 6520 636f         If the co
+00015250: 6c75 6d6e 206e 616d 6520 7072 6f76 6964  lumn name provid
+00015260: 6564 2064 6f65 7320 6e6f 7420 6861 7665  ed does not have
+00015270: 2061 6e20 7364 7479 7065 206f 6620 6e75   an sdtype of nu
+00015280: 6d65 7269 6361 6c2c 2074 6865 6e20 616e  merical, then an
+00015290: 2065 7272 6f72 2073 686f 756c 640a 2020   error should.  
+000152a0: 2020 2020 2020 6265 2072 6169 7365 642e        be raised.
+000152b0: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
+000152c0: 0a20 2020 2020 2020 2020 2020 202d 204d  .            - M
+000152d0: 6574 6164 6174 6120 7769 7468 2074 6865  etadata with the
+000152e0: 2063 6f6c 756d 6e27 7320 7364 7479 7065   column's sdtype
+000152f0: 2073 6574 2074 6f20 6461 7465 7469 6d65   set to datetime
+00015300: 2e0a 0a20 2020 2020 2020 2053 6964 6520  ...        Side 
+00015310: 6566 6665 6374 3a0a 2020 2020 2020 2020  effect:.        
+00015320: 2020 2020 2d20 5261 6973 6573 2043 6f6e      - Raises Con
+00015330: 7374 7261 696e 744d 6574 6164 6174 6145  straintMetadataE
+00015340: 7272 6f72 0a20 2020 2020 2020 2022 2222  rror.        """
+00015350: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+00015360: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+00015370: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
+00015380: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
+00015390: 6d6e 7320 3d20 7b0a 2020 2020 2020 2020  mns = {.        
+000153a0: 2020 2020 2761 273a 207b 2773 6474 7970      'a': {'sdtyp
+000153b0: 6527 3a20 2764 6174 6574 696d 6527 7d0a  e': 'datetime'}.
+000153c0: 2020 2020 2020 2020 7d0a 0a20 2020 2020          }..     
+000153d0: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
+000153e0: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
+000153f0: 2028 0a20 2020 2020 2020 2020 2020 2027   (.            '
+00015400: 4120 506f 7369 7469 7665 2063 6f6e 7374  A Positive const
+00015410: 7261 696e 7420 6973 2062 6569 6e67 2061  raint is being a
+00015420: 7070 6c69 6564 2074 6f20 616e 2069 6e76  pplied to an inv
+00015430: 616c 6964 2063 6f6c 756d 6e20 270a 2020  alid column '.  
+00015440: 2020 2020 2020 2020 2020 2227 6127 2e20            "'a'. 
+00015450: 5468 6973 2063 6f6e 7374 7261 696e 7420  This constraint 
+00015460: 6973 206f 6e6c 7920 6465 6669 6e65 6420  is only defined 
+00015470: 666f 7220 6e75 6d65 7269 6361 6c20 636f  for numerical co
+00015480: 6c75 6d6e 732e 220a 2020 2020 2020 2020  lumns.".        
+00015490: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
+000154a0: 7974 6573 742e 7261 6973 6573 2843 6f6e  ytest.raises(Con
+000154b0: 7374 7261 696e 744d 6574 6164 6174 6145  straintMetadataE
+000154c0: 7272 6f72 2c20 6d61 7463 683d 6572 726f  rror, match=erro
+000154d0: 725f 6d65 7373 6167 6529 3a0a 2020 2020  r_message):.    
+000154e0: 2020 2020 2020 2020 506f 7369 7469 7665          Positive
+000154f0: 2e5f 7661 6c69 6461 7465 5f6d 6574 6164  ._validate_metad
+00015500: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
+00015510: 636f 6e73 7472 6169 6e74 280a 2020 2020  constraint(.    
+00015520: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+00015530: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
+00015540: 2020 2020 2020 636f 6c75 6d6e 5f6e 616d        column_nam
+00015550: 653d 2761 270a 2020 2020 2020 2020 2020  e='a'.          
+00015560: 2020 290a 0a20 2020 2064 6566 2074 6573    )..    def tes
+00015570: 745f 5f69 6e69 745f 5f28 7365 6c66 293a  t__init__(self):
+00015580: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+00015590: 2074 6865 2060 6050 6f73 6974 6976 652e   the ``Positive.
+000155a0: 5f5f 696e 6974 5f5f 6060 206d 6574 686f  __init__`` metho
+000155b0: 642e 0a0a 2020 2020 2020 2020 456e 7375  d...        Ensu
+000155c0: 7265 2074 6865 2061 7474 7269 6275 7465  re the attribute
+000155d0: 7320 6172 6520 636f 7272 6563 746c 7920  s are correctly 
+000155e0: 7365 742e 0a20 2020 2020 2020 2022 2222  set..        """
+000155f0: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+00015600: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
+00015610: 3d20 506f 7369 7469 7665 2863 6f6c 756d  = Positive(colum
+00015620: 6e5f 6e61 6d65 3d27 6162 6327 290a 0a20  n_name='abc').. 
+00015630: 2020 2020 2020 2023 2041 7373 6572 7473         # Asserts
+00015640: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00015650: 696e 7374 616e 6365 2e5f 7661 6c75 6520  instance._value 
+00015660: 3d3d 2030 0a20 2020 2020 2020 2061 7373  == 0.        ass
+00015670: 6572 7420 696e 7374 616e 6365 2e5f 636f  ert instance._co
+00015680: 6c75 6d6e 5f6e 616d 6520 3d3d 2027 6162  lumn_name == 'ab
+00015690: 6327 0a20 2020 2020 2020 2061 7373 6572  c'.        asser
+000156a0: 7420 696e 7374 616e 6365 2e5f 6f70 6572  t instance._oper
+000156b0: 6174 6f72 203d 3d20 6e70 2e67 7265 6174  ator == np.great
+000156c0: 6572 5f65 7175 616c 0a0a 2020 2020 6465  er_equal..    de
+000156d0: 6620 7465 7374 5f5f 696e 6974 5f5f 7374  f test__init__st
+000156e0: 7269 6374 5f74 7275 6528 7365 6c66 293a  rict_true(self):
+000156f0: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+00015700: 2074 6865 2060 6050 6f73 6974 6976 652e   the ``Positive.
+00015710: 5f5f 696e 6974 5f5f 6060 206d 6574 686f  __init__`` metho
+00015720: 642e 0a0a 2020 2020 2020 2020 456e 7375  d...        Ensu
+00015730: 7265 2074 6865 2061 7474 7269 6275 7465  re the attribute
+00015740: 7320 6172 6520 636f 7272 6563 746c 7920  s are correctly 
+00015750: 7365 7420 7768 656e 2060 6073 7472 6963  set when ``stric
+00015760: 745f 626f 756e 6461 7269 6573 6060 2069  t_boundaries`` i
+00015770: 7320 5472 7565 2e0a 2020 2020 2020 2020  s True..        
+00015780: 2222 220a 2020 2020 2020 2020 2320 5275  """.        # Ru
+00015790: 6e0a 2020 2020 2020 2020 696e 7374 616e  n.        instan
+000157a0: 6365 203d 2050 6f73 6974 6976 6528 636f  ce = Positive(co
+000157b0: 6c75 6d6e 5f6e 616d 653d 2761 6263 272c  lumn_name='abc',
+000157c0: 2073 7472 6963 745f 626f 756e 6461 7269   strict_boundari
+000157d0: 6573 3d54 7275 6529 0a0a 2020 2020 2020  es=True)..      
+000157e0: 2020 2320 4173 7365 7274 730a 2020 2020    # Asserts.    
+000157f0: 2020 2020 6173 7365 7274 2069 6e73 7461      assert insta
+00015800: 6e63 652e 5f76 616c 7565 203d 3d20 300a  nce._value == 0.
+00015810: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00015820: 6e73 7461 6e63 652e 5f63 6f6c 756d 6e5f  nstance._column_
+00015830: 6e61 6d65 203d 3d20 2761 6263 270a 2020  name == 'abc'.  
+00015840: 2020 2020 2020 6173 7365 7274 2069 6e73        assert ins
+00015850: 7461 6e63 652e 5f6f 7065 7261 746f 7220  tance._operator 
+00015860: 3d3d 206e 702e 6772 6561 7465 720a 0a0a  == np.greater...
+00015870: 636c 6173 7320 5465 7374 4e65 6761 7469  class TestNegati
+00015880: 7665 2829 3a0a 0a20 2020 2064 6566 2074  ve():..    def t
+00015890: 6573 745f 5f76 616c 6964 6174 655f 696e  est__validate_in
+000158a0: 7075 7473 2873 656c 6629 3a0a 2020 2020  puts(self):.    
+000158b0: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
+000158c0: 6060 4e65 6761 7469 7665 2e5f 7661 6c69  ``Negative._vali
+000158d0: 6461 7465 5f69 6e70 7574 7360 6020 6d65  date_inputs`` me
+000158e0: 7468 6f64 2e0a 0a20 2020 2020 2020 2049  thod...        I
+000158f0: 6e70 7574 3a0a 2020 2020 2020 2020 2d20  nput:.        - 
+00015900: 2049 6e63 6f72 7265 6374 2070 6172 616d   Incorrect param
+00015910: 6574 6572 7320 666f 7220 7468 6520 6d65  eters for the me
+00015920: 7468 6f64 0a20 2020 2020 2020 2052 6169  thod.        Rai
+00015930: 7365 733a 0a20 2020 2020 2020 202d 204c  ses:.        - L
+00015940: 6973 7420 6f66 2056 616c 7565 4572 726f  ist of ValueErro
+00015950: 7273 0a20 2020 2020 2020 2022 2222 0a20  rs.        """. 
+00015960: 2020 2020 2020 2023 2052 756e 202f 2041         # Run / A
+00015970: 7373 6572 740a 2020 2020 2020 2020 7769  ssert.        wi
+00015980: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+00015990: 2841 6767 7265 6761 7465 436f 6e73 7472  (AggregateConstr
+000159a0: 6169 6e74 7345 7272 6f72 2920 6173 2065  aintsError) as e
+000159b0: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
+000159c0: 2020 4e65 6761 7469 7665 2e5f 7661 6c69    Negative._vali
+000159d0: 6461 7465 5f69 6e70 7574 7328 6e6f 745f  date_inputs(not_
+000159e0: 636f 6c75 6d6e 5f6e 616d 653d 4e6f 6e65  column_name=None
+000159f0: 2c20 736f 6d65 7468 696e 675f 656c 7365  , something_else
+00015a00: 3d4e 6f6e 6529 0a0a 2020 2020 2020 2020  =None)..        
+00015a10: 6572 725f 6d73 6720 3d20 280a 2020 2020  err_msg = (.    
+00015a20: 2020 2020 2020 2020 7227 4d69 7373 696e          r'Missin
+00015a30: 6720 7265 7175 6972 6564 2076 616c 7565  g required value
+00015a40: 7320 7b28 2e2a 297d 2069 6e20 6120 4e65  s {(.*)} in a Ne
+00015a50: 6761 7469 7665 2063 6f6e 7374 7261 696e  gative constrain
+00015a60: 742e 270a 2020 2020 2020 2020 2020 2020  t.'.            
+00015a70: 7227 5c6e 5c6e 496e 7661 6c69 6420 7661  r'\n\nInvalid va
+00015a80: 6c75 6573 207b 282e 2a29 7d20 6172 6520  lues {(.*)} are 
+00015a90: 7072 6573 656e 7420 696e 2061 204e 6567  present in a Neg
+00015aa0: 6174 6976 6520 636f 6e73 7472 6169 6e74  ative constraint
+00015ab0: 2e27 0a20 2020 2020 2020 2029 0a20 2020  .'.        ).   
+00015ac0: 2020 2020 2067 726f 7570 7320 3d20 7265       groups = re
+00015ad0: 2e73 6561 7263 6828 6572 725f 6d73 672c  .search(err_msg,
+00015ae0: 2073 7472 2865 7272 6f72 2e76 616c 7565   str(error.value
+00015af0: 2929 0a20 2020 2020 2020 2061 7373 6572  )).        asser
+00015b00: 7420 6772 6f75 7073 2069 7320 6e6f 7420  t groups is not 
+00015b10: 4e6f 6e65 0a20 2020 2020 2020 2061 7373  None.        ass
+00015b20: 6572 7420 7374 7228 6576 616c 2867 726f  ert str(eval(gro
+00015b30: 7570 732e 6772 6f75 7028 3129 2929 203d  ups.group(1))) =
+00015b40: 3d20 2763 6f6c 756d 6e5f 6e61 6d65 270a  = 'column_name'.
+00015b50: 2020 2020 2020 2020 6173 7365 7274 2073          assert s
+00015b60: 6574 2865 7661 6c28 6772 6f75 7073 2e67  et(eval(groups.g
+00015b70: 726f 7570 2832 2929 2920 3d3d 207b 2773  roup(2))) == {'s
+00015b80: 6f6d 6574 6869 6e67 5f65 6c73 6527 2c20  omething_else', 
+00015b90: 276e 6f74 5f63 6f6c 756d 6e5f 6e61 6d65  'not_column_name
+00015ba0: 277d 0a0a 2020 2020 6465 6620 7465 7374  '}..    def test
+00015bb0: 5f5f 7661 6c69 6461 7465 5f6d 6574 6164  __validate_metad
+00015bc0: 6174 615f 636f 6c75 6d6e 7328 7365 6c66  ata_columns(self
+00015bd0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+00015be0: 7374 2074 6865 2060 605f 7661 6c69 6461  st the ``_valida
+00015bf0: 7465 5f6d 6574 6164 6174 615f 636f 6c75  te_metadata_colu
+00015c00: 6d6e 7360 6020 6d65 7468 6f64 2e0a 0a20  mns`` method... 
+00015c10: 2020 2020 2020 2054 6865 2063 6f6c 756d         The colum
+00015c20: 6e20 7061 7373 6564 2069 6e20 636f 6c75  n passed in colu
+00015c30: 6d6e 5f6e 616d 6520 7368 6f75 6c64 2062  mn_name should b
+00015c40: 6520 696e 2074 6865 206d 6574 6164 6174  e in the metadat
+00015c50: 612e 0a0a 2020 2020 2020 2020 496e 7075  a...        Inpu
+00015c60: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
+00015c70: 2063 6f6c 756d 6e5f 6e61 6d65 2074 6861   column_name tha
+00015c80: 7420 6973 2069 6e20 7468 6520 6d65 7461  t is in the meta
+00015c90: 6461 7461 2e0a 0a20 2020 2020 2020 2053  data...        S
+00015ca0: 6964 6520 6566 6665 6374 3a0a 2020 2020  ide effect:.    
+00015cb0: 2020 2020 2020 2020 2d20 4e6f 2065 7272          - No err
+00015cc0: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
+00015cd0: 7365 642e 0a20 2020 2020 2020 2022 2222  sed..        """
+00015ce0: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+00015cf0: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+00015d00: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
+00015d10: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
+00015d20: 6d6e 7320 3d20 7b27 6127 3a20 312c 2027  mns = {'a': 1, '
+00015d30: 6227 3a20 327d 0a0a 2020 2020 2020 2020  b': 2}..        
+00015d40: 2320 5275 6e0a 2020 2020 2020 2020 4e65  # Run.        Ne
+00015d50: 6761 7469 7665 2e5f 7661 6c69 6461 7465  gative._validate
+00015d60: 5f6d 6574 6164 6174 615f 636f 6c75 6d6e  _metadata_column
+00015d70: 7328 6d65 7461 6461 7461 2c20 636f 6c75  s(metadata, colu
+00015d80: 6d6e 5f6e 616d 653d 2761 2729 0a0a 2020  mn_name='a')..  
+00015d90: 2020 6465 6620 7465 7374 5f5f 7661 6c69    def test__vali
+00015da0: 6461 7465 5f6d 6574 6164 6174 615f 636f  date_metadata_co
+00015db0: 6c75 6d6e 735f 7261 6973 6573 5f65 7272  lumns_raises_err
+00015dc0: 6f72 2873 656c 6629 3a0a 2020 2020 2020  or(self):.      
+00015dd0: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
+00015de0: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
+00015df0: 7461 5f63 6f6c 756d 6e73 6060 206d 6574  ta_columns`` met
+00015e00: 686f 6427 7320 6572 726f 7220 636f 6e64  hod's error cond
+00015e10: 6974 696f 6e2e 0a0a 2020 2020 2020 2020  ition...        
+00015e20: 4966 2063 6f6c 756d 6e5f 6e61 6d65 2069  If column_name i
+00015e30: 7320 6e6f 7420 696e 2074 6865 206d 6574  s not in the met
+00015e40: 6164 6174 612c 2061 6e20 6572 726f 7220  adata, an error 
+00015e50: 7368 6f75 6c64 2062 6520 7261 6973 6564  should be raised
+00015e60: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
+00015e70: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+00015e80: 636f 6c75 6d6e 5f6e 616d 6520 7468 6174  column_name that
+00015e90: 2069 7320 6e6f 7420 696e 2074 6865 206d   is not in the m
+00015ea0: 6574 6164 6174 612e 0a0a 2020 2020 2020  etadata...      
+00015eb0: 2020 5369 6465 2065 6666 6563 743a 0a20    Side effect:. 
+00015ec0: 2020 2020 2020 2020 2020 202d 2043 6f6e             - Con
+00015ed0: 7374 7261 696e 744d 6574 6164 6174 6145  straintMetadataE
+00015ee0: 7272 6f72 2073 686f 756c 6420 6265 2072  rror should be r
+00015ef0: 6169 7365 642e 0a20 2020 2020 2020 2022  aised..        "
+00015f00: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
+00015f10: 7570 0a20 2020 2020 2020 206d 6574 6164  up.        metad
+00015f20: 6174 6120 3d20 4d6f 636b 2829 0a20 2020  ata = Mock().   
+00015f30: 2020 2020 206d 6574 6164 6174 612e 636f       metadata.co
+00015f40: 6c75 6d6e 7320 3d20 7b27 6127 3a20 312c  lumns = {'a': 1,
+00015f50: 2027 6227 3a20 327d 0a0a 2020 2020 2020   'b': 2}..      
+00015f60: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
+00015f70: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+00015f80: 7265 2e65 7363 6170 6528 0a20 2020 2020  re.escape(.     
+00015f90: 2020 2020 2020 2027 4120 4e65 6761 7469         'A Negati
+00015fa0: 7665 2063 6f6e 7374 7261 696e 7420 6973  ve constraint is
+00015fb0: 2062 6569 6e67 2061 7070 6c69 6564 2074   being applied t
+00015fc0: 6f20 696e 7661 6c69 6420 636f 6c75 6d6e  o invalid column
+00015fd0: 206e 616d 6573 2027 0a20 2020 2020 2020   names '.       
+00015fe0: 2020 2020 2022 7b27 6327 7d2e 2054 6865       "{'c'}. The
+00015ff0: 2063 6f6c 756d 6e73 206d 7573 7420 6578   columns must ex
+00016000: 6973 7420 696e 2074 6865 2074 6162 6c65  ist in the table
+00016010: 2e22 0a20 2020 2020 2020 2029 0a20 2020  .".        ).   
+00016020: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
+00016030: 2e72 6169 7365 7328 436f 6e73 7472 6169  .raises(Constrai
+00016040: 6e74 4d65 7461 6461 7461 4572 726f 722c  ntMetadataError,
+00016050: 206d 6174 6368 3d65 7272 6f72 5f6d 6573   match=error_mes
+00016060: 7361 6765 293a 0a20 2020 2020 2020 2020  sage):.         
+00016070: 2020 204e 6567 6174 6976 652e 5f76 616c     Negative._val
+00016080: 6964 6174 655f 6d65 7461 6461 7461 5f63  idate_metadata_c
+00016090: 6f6c 756d 6e73 286d 6574 6164 6174 612c  olumns(metadata,
+000160a0: 2063 6f6c 756d 6e5f 6e61 6d65 3d27 6327   column_name='c'
+000160b0: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+000160c0: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
+000160d0: 7461 5f73 7065 6369 6669 635f 746f 5f63  ta_specific_to_c
+000160e0: 6f6e 7374 7261 696e 7428 7365 6c66 293a  onstraint(self):
+000160f0: 0a20 2020 2020 2020 2022 2222 2054 6573  .        """ Tes
+00016100: 7420 7468 6520 6060 5f76 616c 6964 6174  t the ``_validat
+00016110: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+00016120: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+00016130: 7460 6020 6d65 7468 6f64 2e0a 0a20 2020  t`` method...   
+00016140: 2020 2020 2049 6620 7468 6520 636f 6c75       If the colu
+00016150: 6d6e 206e 616d 6520 7072 6f76 6964 6564  mn name provided
+00016160: 2068 6173 2061 6e20 7364 7479 7065 206f   has an sdtype o
+00016170: 6620 6e75 6d65 7269 6361 6c2c 2074 6865  f numerical, the
+00016180: 6e20 6e6f 2065 7272 6f72 2073 686f 756c  n no error shoul
+00016190: 640a 2020 2020 2020 2020 6265 2072 6169  d.        be rai
+000161a0: 7365 642e 0a0a 2020 2020 2020 2020 496e  sed...        In
+000161b0: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
+000161c0: 202d 204d 6574 6164 6174 6120 7769 7468   - Metadata with
+000161d0: 2074 6865 2063 6f6c 756d 6e27 7320 7364   the column's sd
+000161e0: 7479 7065 2073 6574 2074 6f20 6e75 6d65  type set to nume
+000161f0: 7269 6361 6c2e 0a20 2020 2020 2020 2022  rical..        "
+00016200: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
+00016210: 7570 0a20 2020 2020 2020 206d 6574 6164  up.        metad
+00016220: 6174 6120 3d20 4d6f 636b 2829 0a20 2020  ata = Mock().   
+00016230: 2020 2020 206d 6574 6164 6174 612e 636f       metadata.co
+00016240: 6c75 6d6e 7320 3d20 7b0a 2020 2020 2020  lumns = {.      
+00016250: 2020 2020 2020 2761 273a 207b 2773 6474        'a': {'sdt
+00016260: 7970 6527 3a20 276e 756d 6572 6963 616c  ype': 'numerical
+00016270: 277d 0a20 2020 2020 2020 207d 0a0a 2020  '}.        }..  
+00016280: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+00016290: 2020 2020 506f 7369 7469 7665 2e5f 7661      Positive._va
+000162a0: 6c69 6461 7465 5f6d 6574 6164 6174 615f  lidate_metadata_
+000162b0: 7370 6563 6966 6963 5f74 6f5f 636f 6e73  specific_to_cons
+000162c0: 7472 6169 6e74 280a 2020 2020 2020 2020  traint(.        
+000162d0: 2020 2020 6d65 7461 6461 7461 2c0a 2020      metadata,.  
+000162e0: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+000162f0: 5f6e 616d 653d 2761 270a 2020 2020 2020  _name='a'.      
+00016300: 2020 290a 0a20 2020 2064 6566 2074 6573    )..    def tes
+00016310: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
+00016320: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
+00016330: 5f63 6f6e 7374 7261 696e 745f 6572 726f  _constraint_erro
+00016340: 7228 7365 6c66 293a 0a20 2020 2020 2020  r(self):.       
+00016350: 2022 2222 2054 6573 7420 7468 6520 6060   """ Test the ``
+00016360: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
+00016370: 7461 5f73 7065 6369 6669 635f 746f 5f63  ta_specific_to_c
+00016380: 6f6e 7374 7261 696e 7460 6020 6d65 7468  onstraint`` meth
+00016390: 6f64 2e0a 0a20 2020 2020 2020 2049 6620  od...        If 
+000163a0: 7468 6520 636f 6c75 6d6e 206e 616d 6520  the column name 
+000163b0: 7072 6f76 6964 6564 2064 6f65 7320 6e6f  provided does no
+000163c0: 7420 6861 7665 2061 6e20 7364 7479 7065  t have an sdtype
+000163d0: 206f 6620 6e75 6d65 7269 6361 6c2c 2074   of numerical, t
+000163e0: 6865 6e20 616e 2065 7272 6f72 2073 686f  hen an error sho
+000163f0: 756c 640a 2020 2020 2020 2020 6265 2072  uld.        be r
+00016400: 6169 7365 642e 0a0a 2020 2020 2020 2020  aised...        
+00016410: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
+00016420: 2020 202d 204d 6574 6164 6174 6120 7769     - Metadata wi
+00016430: 7468 2074 6865 2063 6f6c 756d 6e27 7320  th the column's 
+00016440: 7364 7479 7065 2073 6574 2074 6f20 6461  sdtype set to da
+00016450: 7465 7469 6d65 2e0a 0a20 2020 2020 2020  tetime...       
+00016460: 2053 6964 6520 6566 6665 6374 3a0a 2020   Side effect:.  
+00016470: 2020 2020 2020 2020 2020 2d20 5261 6973            - Rais
+00016480: 6573 2043 6f6e 7374 7261 696e 744d 6574  es ConstraintMet
+00016490: 6164 6174 6145 7272 6f72 0a20 2020 2020  adataError.     
+000164a0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+000164b0: 2053 6574 7570 0a20 2020 2020 2020 206d   Setup.        m
+000164c0: 6574 6164 6174 6120 3d20 4d6f 636b 2829  etadata = Mock()
+000164d0: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+000164e0: 612e 636f 6c75 6d6e 7320 3d20 7b0a 2020  a.columns = {.  
+000164f0: 2020 2020 2020 2020 2020 2761 273a 207b            'a': {
+00016500: 2773 6474 7970 6527 3a20 2764 6174 6574  'sdtype': 'datet
+00016510: 696d 6527 7d0a 2020 2020 2020 2020 7d0a  ime'}.        }.
+00016520: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+00016530: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00016540: 7361 6765 203d 2028 0a20 2020 2020 2020  sage = (.       
+00016550: 2020 2020 2027 4120 4e65 6761 7469 7665       'A Negative
+00016560: 2063 6f6e 7374 7261 696e 7420 6973 2062   constraint is b
+00016570: 6569 6e67 2061 7070 6c69 6564 2074 6f20  eing applied to 
+00016580: 616e 2069 6e76 616c 6964 2063 6f6c 756d  an invalid colum
+00016590: 6e20 270a 2020 2020 2020 2020 2020 2020  n '.            
+000165a0: 2227 6127 2e20 5468 6973 2063 6f6e 7374  "'a'. This const
+000165b0: 7261 696e 7420 6973 206f 6e6c 7920 6465  raint is only de
+000165c0: 6669 6e65 6420 666f 7220 6e75 6d65 7269  fined for numeri
+000165d0: 6361 6c20 636f 6c75 6d6e 732e 220a 2020  cal columns.".  
+000165e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000165f0: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+00016600: 6573 2843 6f6e 7374 7261 696e 744d 6574  es(ConstraintMet
+00016610: 6164 6174 6145 7272 6f72 2c20 6d61 7463  adataError, matc
+00016620: 683d 6572 726f 725f 6d65 7373 6167 6529  h=error_message)
+00016630: 3a0a 2020 2020 2020 2020 2020 2020 4e65  :.            Ne
+00016640: 6761 7469 7665 2e5f 7661 6c69 6461 7465  gative._validate
+00016650: 5f6d 6574 6164 6174 615f 7370 6563 6966  _metadata_specif
+00016660: 6963 5f74 6f5f 636f 6e73 7472 6169 6e74  ic_to_constraint
+00016670: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00016680: 2020 6d65 7461 6461 7461 2c0a 2020 2020    metadata,.    
+00016690: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+000166a0: 6d6e 5f6e 616d 653d 2761 270a 2020 2020  mn_name='a'.    
+000166b0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+000166c0: 6566 2074 6573 745f 5f69 6e69 745f 5f28  ef test__init__(
+000166d0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+000166e0: 2222 5465 7374 2074 6865 2060 604e 6567  ""Test the ``Neg
+000166f0: 6174 6976 652e 5f5f 696e 6974 5f5f 6060  ative.__init__``
+00016700: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
+00016710: 2020 456e 7375 7265 2074 6865 2061 7474    Ensure the att
+00016720: 7269 6275 7465 7320 6172 6520 636f 7272  ributes are corr
+00016730: 6563 746c 7920 7365 742e 0a20 2020 2020  ectly set..     
+00016740: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00016750: 2052 756e 0a20 2020 2020 2020 2069 6e73   Run.        ins
+00016760: 7461 6e63 6520 3d20 4e65 6761 7469 7665  tance = Negative
+00016770: 2863 6f6c 756d 6e5f 6e61 6d65 3d27 6162  (column_name='ab
+00016780: 6327 290a 0a20 2020 2020 2020 2023 2041  c')..        # A
+00016790: 7373 6572 7473 0a20 2020 2020 2020 2061  sserts.        a
+000167a0: 7373 6572 7420 696e 7374 616e 6365 2e5f  ssert instance._
+000167b0: 7661 6c75 6520 3d3d 2030 0a20 2020 2020  value == 0.     
+000167c0: 2020 2061 7373 6572 7420 696e 7374 616e     assert instan
+000167d0: 6365 2e5f 636f 6c75 6d6e 5f6e 616d 6520  ce._column_name 
+000167e0: 3d3d 2027 6162 6327 0a20 2020 2020 2020  == 'abc'.       
+000167f0: 2061 7373 6572 7420 696e 7374 616e 6365   assert instance
+00016800: 2e5f 6f70 6572 6174 6f72 203d 3d20 6e70  ._operator == np
+00016810: 2e6c 6573 735f 6571 7561 6c0a 0a20 2020  .less_equal..   
+00016820: 2064 6566 2074 6573 745f 5f69 6e69 745f   def test__init_
+00016830: 5f73 7472 6963 745f 7472 7565 2873 656c  _strict_true(sel
+00016840: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+00016850: 6573 7420 7468 6520 6060 4e65 6761 7469  est the ``Negati
+00016860: 7665 2e5f 5f69 6e69 745f 5f60 6020 6d65  ve.__init__`` me
+00016870: 7468 6f64 2e0a 0a20 2020 2020 2020 2045  thod...        E
+00016880: 6e73 7572 6520 7468 6520 6174 7472 6962  nsure the attrib
+00016890: 7574 6573 2061 7265 2063 6f72 7265 6374  utes are correct
+000168a0: 6c79 2073 6574 2077 6865 6e20 6060 7374  ly set when ``st
+000168b0: 7269 6374 5f62 6f75 6e64 6172 6965 7360  rict_boundaries`
+000168c0: 6020 6973 2054 7275 652e 0a20 2020 2020  ` is True..     
+000168d0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+000168e0: 2052 756e 0a20 2020 2020 2020 2069 6e73   Run.        ins
+000168f0: 7461 6e63 6520 3d20 4e65 6761 7469 7665  tance = Negative
+00016900: 2863 6f6c 756d 6e5f 6e61 6d65 3d27 6162  (column_name='ab
+00016910: 6327 2c20 7374 7269 6374 5f62 6f75 6e64  c', strict_bound
+00016920: 6172 6965 733d 5472 7565 290a 0a20 2020  aries=True)..   
+00016930: 2020 2020 2023 2041 7373 6572 7473 0a20       # Asserts. 
+00016940: 2020 2020 2020 2061 7373 6572 7420 696e         assert in
+00016950: 7374 616e 6365 2e5f 7661 6c75 6520 3d3d  stance._value ==
+00016960: 2030 0a20 2020 2020 2020 2061 7373 6572   0.        asser
+00016970: 7420 696e 7374 616e 6365 2e5f 636f 6c75  t instance._colu
+00016980: 6d6e 5f6e 616d 6520 3d3d 2027 6162 6327  mn_name == 'abc'
+00016990: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+000169a0: 696e 7374 616e 6365 2e5f 6f70 6572 6174  instance._operat
+000169b0: 6f72 203d 3d20 6e70 2e6c 6573 730a 0a0a  or == np.less...
+000169c0: 636c 6173 7320 5465 7374 5261 6e67 6528  class TestRange(
+000169d0: 293a 0a0a 2020 2020 6465 6620 7465 7374  ):..    def test
+000169e0: 5f5f 7661 6c69 6461 7465 5f69 6e70 7574  __validate_input
+000169f0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+00016a00: 2022 2222 5465 7374 2074 6865 2060 6052   """Test the ``R
+00016a10: 616e 6765 2e5f 7661 6c69 6461 7465 5f69  ange._validate_i
+00016a20: 6e70 7574 7360 6020 6d65 7468 6f64 2e0a  nputs`` method..
+00016a30: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
+00016a40: 2020 2020 2020 2020 2d20 2049 6e63 6f72          -  Incor
+00016a50: 7265 6374 2070 6172 616d 6574 6572 7320  rect parameters 
+00016a60: 666f 7220 7468 6520 6d65 7468 6f64 0a20  for the method. 
+00016a70: 2020 2020 2020 2052 6169 7365 733a 0a20         Raises:. 
+00016a80: 2020 2020 2020 202d 204c 6973 7420 6f66         - List of
+00016a90: 2056 616c 7565 4572 726f 7273 0a20 2020   ValueErrors.   
+00016aa0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00016ab0: 2023 2052 756e 202f 2041 7373 6572 740a   # Run / Assert.
+00016ac0: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+00016ad0: 6573 742e 7261 6973 6573 2841 6767 7265  est.raises(Aggre
+00016ae0: 6761 7465 436f 6e73 7472 6169 6e74 7345  gateConstraintsE
+00016af0: 7272 6f72 2920 6173 2065 7272 6f72 3a0a  rror) as error:.
+00016b00: 2020 2020 2020 2020 2020 2020 5261 6e67              Rang
+00016b10: 652e 5f76 616c 6964 6174 655f 696e 7075  e._validate_inpu
+00016b20: 7473 286e 6f74 5f68 6967 685f 636f 6c75  ts(not_high_colu
+00016b30: 6d6e 3d4e 6f6e 652c 206e 6f74 5f6c 6f77  mn=None, not_low
+00016b40: 5f63 6f6c 756d 6e3d 4e6f 6e65 290a 0a20  _column=None).. 
+00016b50: 2020 2020 2020 2065 7272 5f6d 7367 203d         err_msg =
+00016b60: 2028 0a20 2020 2020 2020 2020 2020 2072   (.            r
+00016b70: 274d 6973 7369 6e67 2072 6571 7569 7265  'Missing require
+00016b80: 6420 7661 6c75 6573 207b 282e 2a29 7d20  d values {(.*)} 
+00016b90: 696e 2061 2052 616e 6765 2063 6f6e 7374  in a Range const
+00016ba0: 7261 696e 742e 270a 2020 2020 2020 2020  raint.'.        
+00016bb0: 2020 2020 7227 5c6e 5c6e 496e 7661 6c69      r'\n\nInvali
+00016bc0: 6420 7661 6c75 6573 207b 282e 2a29 7d20  d values {(.*)} 
+00016bd0: 6172 6520 7072 6573 656e 7420 696e 2061  are present in a
+00016be0: 2052 616e 6765 2063 6f6e 7374 7261 696e   Range constrain
+00016bf0: 742e 270a 2020 2020 2020 2020 290a 2020  t.'.        ).  
+00016c00: 2020 2020 2020 6772 6f75 7073 203d 2072        groups = r
+00016c10: 652e 7365 6172 6368 2865 7272 5f6d 7367  e.search(err_msg
+00016c20: 2c20 7374 7228 6572 726f 722e 7661 6c75  , str(error.valu
+00016c30: 6529 290a 2020 2020 2020 2020 6173 7365  e)).        asse
+00016c40: 7274 2067 726f 7570 7320 6973 206e 6f74  rt groups is not
+00016c50: 204e 6f6e 650a 2020 2020 2020 2020 6173   None.        as
+00016c60: 7365 7274 2073 6574 2865 7661 6c28 6772  sert set(eval(gr
+00016c70: 6f75 7073 2e67 726f 7570 2831 2929 2920  oups.group(1))) 
+00016c80: 3d3d 207b 0a20 2020 2020 2020 2020 2020  == {.           
+00016c90: 2027 6d69 6464 6c65 5f63 6f6c 756d 6e5f   'middle_column_
+00016ca0: 6e61 6d65 272c 2027 6869 6768 5f63 6f6c  name', 'high_col
+00016cb0: 756d 6e5f 6e61 6d65 272c 2027 6c6f 775f  umn_name', 'low_
+00016cc0: 636f 6c75 6d6e 5f6e 616d 6527 0a20 2020  column_name'.   
+00016cd0: 2020 2020 207d 0a20 2020 2020 2020 2061       }.        a
+00016ce0: 7373 6572 7420 7365 7428 6576 616c 2867  ssert set(eval(g
+00016cf0: 726f 7570 732e 6772 6f75 7028 3229 2929  roups.group(2)))
+00016d00: 203d 3d20 7b27 6e6f 745f 6869 6768 5f63   == {'not_high_c
+00016d10: 6f6c 756d 6e27 2c20 276e 6f74 5f6c 6f77  olumn', 'not_low
+00016d20: 5f63 6f6c 756d 6e27 7d0a 0a20 2020 2064  _column'}..    d
+00016d30: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
+00016d40: 655f 6d65 7461 6461 7461 5f63 6f6c 756d  e_metadata_colum
+00016d50: 6e73 2873 656c 6629 3a0a 2020 2020 2020  ns(self):.      
+00016d60: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
+00016d70: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
+00016d80: 7461 5f63 6f6c 756d 6e73 6060 206d 6574  ta_columns`` met
+00016d90: 686f 642e 0a0a 2020 2020 2020 2020 416c  hod...        Al
+00016da0: 6c20 6f66 2074 6865 2063 6f6c 756d 6e73  l of the columns
+00016db0: 2070 6173 7365 6420 7368 6f75 6c64 2062   passed should b
+00016dc0: 6520 696e 2074 6865 206d 6574 6164 6174  e in the metadat
+00016dd0: 612e 0a0a 2020 2020 2020 2020 496e 7075  a...        Inpu
+00016de0: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
+00016df0: 2068 6967 685f 636f 6c75 6d6e 5f6e 616d   high_column_nam
+00016e00: 652c 206c 6f77 5f63 6f6c 756d 6e5f 6e61  e, low_column_na
+00016e10: 6d65 2061 6e64 206d 6964 646c 655f 636f  me and middle_co
+00016e20: 6c75 6d6e 5f6e 616d 6520 7468 6174 2061  lumn_name that a
+00016e30: 7265 2061 6c6c 2069 6e20 7468 650a 2020  re all in the.  
+00016e40: 2020 2020 2020 2020 2020 6d65 7461 6461            metada
+00016e50: 7461 2e0a 0a20 2020 2020 2020 2053 6964  ta...        Sid
+00016e60: 6520 6566 6665 6374 3a0a 2020 2020 2020  e effect:.      
+00016e70: 2020 2020 2020 2d20 4e6f 2065 7272 6f72        - No error
+00016e80: 2073 686f 756c 6420 6265 2072 6169 7365   should be raise
+00016e90: 642e 0a20 2020 2020 2020 2022 2222 0a20  d..        """. 
+00016ea0: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
+00016eb0: 2020 2020 2020 206d 6574 6164 6174 6120         metadata 
+00016ec0: 3d20 4d6f 636b 2829 0a20 2020 2020 2020  = Mock().       
+00016ed0: 206d 6574 6164 6174 612e 636f 6c75 6d6e   metadata.column
+00016ee0: 7320 3d20 7b27 6127 3a20 312c 2027 6227  s = {'a': 1, 'b'
+00016ef0: 3a20 322c 2027 6327 3a20 337d 0a0a 2020  : 2, 'c': 3}..  
+00016f00: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+00016f10: 2020 2020 5261 6e67 652e 5f76 616c 6964      Range._valid
+00016f20: 6174 655f 6d65 7461 6461 7461 5f63 6f6c  ate_metadata_col
+00016f30: 756d 6e73 280a 2020 2020 2020 2020 2020  umns(.          
+00016f40: 2020 6d65 7461 6461 7461 2c0a 2020 2020    metadata,.    
+00016f50: 2020 2020 2020 2020 6869 6768 5f63 6f6c          high_col
+00016f60: 756d 6e5f 6e61 6d65 3d27 6127 2c0a 2020  umn_name='a',.  
+00016f70: 2020 2020 2020 2020 2020 6c6f 775f 636f            low_co
+00016f80: 6c75 6d6e 5f6e 616d 653d 2762 272c 0a20  lumn_name='b',. 
+00016f90: 2020 2020 2020 2020 2020 206d 6964 646c             middl
+00016fa0: 655f 636f 6c75 6d6e 5f6e 616d 653d 2763  e_column_name='c
+00016fb0: 270a 2020 2020 2020 2020 290a 0a20 2020  '.        )..   
+00016fc0: 2064 6566 2074 6573 745f 5f76 616c 6964   def test__valid
+00016fd0: 6174 655f 6d65 7461 6461 7461 5f63 6f6c  ate_metadata_col
+00016fe0: 756d 6e73 5f72 6169 7365 735f 6572 726f  umns_raises_erro
+00016ff0: 7228 7365 6c66 293a 0a20 2020 2020 2020  r(self):.       
+00017000: 2022 2222 5465 7374 2074 6865 2060 605f   """Test the ``_
+00017010: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
+00017020: 615f 636f 6c75 6d6e 7360 6020 6d65 7468  a_columns`` meth
+00017030: 6f64 2773 2065 7272 6f72 2063 6f6e 6469  od's error condi
+00017040: 7469 6f6e 2e0a 0a20 2020 2020 2020 2049  tion...        I
+00017050: 6620 616e 7920 636f 6c75 6d6e 7320 7061  f any columns pa
+00017060: 7373 6564 2061 7265 206e 6f74 2069 6e20  ssed are not in 
+00017070: 7468 6520 6d65 7461 6461 7461 2c20 616e  the metadata, an
+00017080: 2065 7272 6f72 2073 686f 756c 6420 6265   error should be
+00017090: 2072 6169 7365 642e 0a0a 2020 2020 2020   raised...      
+000170a0: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
+000170b0: 2020 2020 202d 206c 6f77 5f63 6f6c 756d       - low_colum
+000170c0: 6e5f 6e61 6d65 2074 6861 7420 6973 206e  n_name that is n
+000170d0: 6f74 2069 6e20 7468 6520 6d65 7461 6461  ot in the metada
+000170e0: 7461 2e0a 0a20 2020 2020 2020 2053 6964  ta...        Sid
+000170f0: 6520 6566 6665 6374 3a0a 2020 2020 2020  e effect:.      
+00017100: 2020 2020 2020 2d20 436f 6e73 7472 6169        - Constrai
+00017110: 6e74 4d65 7461 6461 7461 4572 726f 7220  ntMetadataError 
+00017120: 7368 6f75 6c64 2062 6520 7261 6973 6564  should be raised
+00017130: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00017140: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
+00017150: 2020 2020 2020 6d65 7461 6461 7461 203d        metadata =
+00017160: 204d 6f63 6b28 290a 2020 2020 2020 2020   Mock().        
+00017170: 6d65 7461 6461 7461 2e63 6f6c 756d 6e73  metadata.columns
+00017180: 203d 207b 2761 273a 2031 2c20 2762 273a   = {'a': 1, 'b':
+00017190: 2032 7d0a 0a20 2020 2020 2020 2023 2052   2}..        # R
+000171a0: 756e 0a20 2020 2020 2020 2065 7272 6f72  un.        error
+000171b0: 5f6d 6573 7361 6765 203d 2072 652e 6573  _message = re.es
+000171c0: 6361 7065 280a 2020 2020 2020 2020 2020  cape(.          
+000171d0: 2020 2741 2052 616e 6765 2063 6f6e 7374    'A Range const
+000171e0: 7261 696e 7420 6973 2062 6569 6e67 2061  raint is being a
+000171f0: 7070 6c69 6564 2074 6f20 696e 7661 6c69  pplied to invali
+00017200: 6420 636f 6c75 6d6e 206e 616d 6573 2027  d column names '
+00017210: 0a20 2020 2020 2020 2020 2020 2022 7b27  .            "{'
+00017220: 6327 7d2e 2054 6865 2063 6f6c 756d 6e73  c'}. The columns
+00017230: 206d 7573 7420 6578 6973 7420 696e 2074   must exist in t
+00017240: 6865 2074 6162 6c65 2e22 0a20 2020 2020  he table.".     
+00017250: 2020 2029 0a20 2020 2020 2020 2077 6974     ).        wit
+00017260: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+00017270: 436f 6e73 7472 6169 6e74 4d65 7461 6461  ConstraintMetada
+00017280: 7461 4572 726f 722c 206d 6174 6368 3d65  taError, match=e
+00017290: 7272 6f72 5f6d 6573 7361 6765 293a 0a20  rror_message):. 
+000172a0: 2020 2020 2020 2020 2020 2052 616e 6765             Range
+000172b0: 2e5f 7661 6c69 6461 7465 5f6d 6574 6164  ._validate_metad
+000172c0: 6174 615f 636f 6c75 6d6e 7328 0a20 2020  ata_columns(.   
+000172d0: 2020 2020 2020 2020 2020 2020 206d 6574               met
+000172e0: 6164 6174 612c 0a20 2020 2020 2020 2020  adata,.         
+000172f0: 2020 2020 2020 2068 6967 685f 636f 6c75         high_colu
+00017300: 6d6e 5f6e 616d 653d 2761 272c 0a20 2020  mn_name='a',.   
+00017310: 2020 2020 2020 2020 2020 2020 206c 6f77               low
+00017320: 5f63 6f6c 756d 6e5f 6e61 6d65 3d27 6227  _column_name='b'
+00017330: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00017340: 2020 6d69 6464 6c65 5f63 6f6c 756d 6e5f    middle_column_
+00017350: 6e61 6d65 3d27 6327 0a20 2020 2020 2020  name='c'.       
+00017360: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00017370: 7465 7374 5f5f 7661 6c69 6461 7465 5f6d  test__validate_m
+00017380: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
+00017390: 5f74 6f5f 636f 6e73 7472 6169 6e74 5f64  _to_constraint_d
+000173a0: 6174 6574 696d 6528 7365 6c66 293a 0a20  atetime(self):. 
+000173b0: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
+000173c0: 6865 2060 605f 7661 6c69 6461 7465 5f6d  he ``_validate_m
+000173d0: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
+000173e0: 5f74 6f5f 636f 6e73 7472 6169 6e74 6060  _to_constraint``
+000173f0: 2077 6974 6820 6461 7465 7469 6d65 732e   with datetimes.
+00017400: 0a0a 2020 2020 2020 2020 4966 2074 6865  ..        If the
+00017410: 2060 6068 6967 685f 636f 6c75 6d6e 5f6e   ``high_column_n
+00017420: 616d 6560 602c 2060 606d 6964 646c 655f  ame``, ``middle_
+00017430: 636f 6c75 6d6e 5f6e 616d 6560 6020 616e  column_name`` an
+00017440: 6420 6060 6c6f 775f 636f 6c75 6d6e 5f6e  d ``low_column_n
+00017450: 616d 6560 600a 2020 2020 2020 2020 6172  ame``.        ar
+00017460: 6520 6461 7465 7469 6d65 732c 2074 6865  e datetimes, the
+00017470: 6e20 7468 6520 7661 6c69 6461 7469 6f6e  n the validation
+00017480: 2073 686f 756c 6420 6e6f 7420 7261 6973   should not rais
+00017490: 6520 616e 2065 7272 6f72 2e0a 0a20 2020  e an error...   
+000174a0: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
+000174b0: 2020 2020 2020 2020 2d20 4d65 7461 6461          - Metada
+000174c0: 7461 2077 6974 6820 7364 7479 7065 7320  ta with sdtypes 
+000174d0: 7365 7420 746f 2064 6174 6574 696d 6520  set to datetime 
+000174e0: 666f 7220 7468 6520 6869 6768 2c20 6d69  for the high, mi
+000174f0: 6464 6c65 2061 6e64 206c 6f77 2063 6f6c  ddle and low col
+00017500: 756d 6e2e 0a20 2020 2020 2020 2022 2222  umn..        """
+00017510: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+00017520: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+00017530: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
+00017540: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
+00017550: 6d6e 7320 3d20 7b0a 2020 2020 2020 2020  mns = {.        
+00017560: 2020 2020 2761 273a 207b 2773 6474 7970      'a': {'sdtyp
+00017570: 6527 3a20 2764 6174 6574 696d 6527 7d2c  e': 'datetime'},
+00017580: 0a20 2020 2020 2020 2020 2020 2027 6227  .            'b'
+00017590: 3a20 7b27 7364 7479 7065 273a 2027 6461  : {'sdtype': 'da
+000175a0: 7465 7469 6d65 277d 2c0a 2020 2020 2020  tetime'},.      
+000175b0: 2020 2020 2020 2763 273a 207b 2773 6474        'c': {'sdt
+000175c0: 7970 6527 3a20 2764 6174 6574 696d 6527  ype': 'datetime'
+000175d0: 7d0a 2020 2020 2020 2020 7d0a 0a20 2020  }.        }..   
+000175e0: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
+000175f0: 2020 2052 616e 6765 2e5f 7661 6c69 6461     Range._valida
+00017600: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
+00017610: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
+00017620: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
+00017630: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
+00017640: 2020 2020 2020 6869 6768 5f63 6f6c 756d        high_colum
+00017650: 6e5f 6e61 6d65 3d27 6127 2c0a 2020 2020  n_name='a',.    
+00017660: 2020 2020 2020 2020 6c6f 775f 636f 6c75          low_colu
+00017670: 6d6e 5f6e 616d 653d 2762 272c 0a20 2020  mn_name='b',.   
+00017680: 2020 2020 2020 2020 206d 6964 646c 655f           middle_
+00017690: 636f 6c75 6d6e 5f6e 616d 653d 2763 270a  column_name='c'.
+000176a0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+000176b0: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
+000176c0: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+000176d0: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+000176e0: 745f 6461 7465 7469 6d65 5f65 7272 6f72  t_datetime_error
+000176f0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00017700: 2222 2254 6573 7420 7468 6520 6060 5f76  """Test the ``_v
+00017710: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
+00017720: 5f73 7065 6369 6669 635f 746f 5f63 6f6e  _specific_to_con
+00017730: 7374 7261 696e 7460 6020 7769 7468 2064  straint`` with d
+00017740: 6174 6574 696d 6573 2e0a 0a20 2020 2020  atetimes...     
+00017750: 2020 2049 6620 7468 6520 6060 6869 6768     If the ``high
+00017760: 5f63 6f6c 756d 6e5f 6e61 6d65 6060 2c20  _column_name``, 
+00017770: 6060 6d69 6464 6c65 5f63 6f6c 756d 6e5f  ``middle_column_
+00017780: 6e61 6d65 6060 2061 6e64 2060 606c 6f77  name`` and ``low
+00017790: 5f63 6f6c 756d 6e5f 6e61 6d65 6060 0a20  _column_name``. 
+000177a0: 2020 2020 2020 2061 7265 206e 6f74 2061         are not a
+000177b0: 6c6c 2064 6174 6574 696d 6573 2c20 7468  ll datetimes, th
+000177c0: 656e 2074 6865 2076 616c 6964 6174 696f  en the validatio
+000177d0: 6e20 7368 6f75 6c64 2072 6169 7365 2061  n should raise a
+000177e0: 6e20 6572 726f 722e 0a0a 2020 2020 2020  n error...      
+000177f0: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
+00017800: 2020 2020 202d 204d 6574 6164 6174 6120       - Metadata 
+00017810: 7769 7468 2073 6474 7970 6573 2073 6574  with sdtypes set
+00017820: 2074 6f20 6461 7465 7469 6d65 2066 6f72   to datetime for
+00017830: 2074 6865 2068 6967 6820 616e 6420 6c6f   the high and lo
+00017840: 7720 636f 6c75 6d6e 0a20 2020 2020 2020  w column.       
+00017850: 2020 2020 2062 7574 206e 6f74 2074 6865       but not the
+00017860: 206d 6964 646c 652e 0a20 2020 2020 2020   middle..       
+00017870: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
+00017880: 6574 7570 0a20 2020 2020 2020 206d 6574  etup.        met
+00017890: 6164 6174 6120 3d20 4d6f 636b 2829 0a20  adata = Mock(). 
+000178a0: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
+000178b0: 636f 6c75 6d6e 7320 3d20 7b0a 2020 2020  columns = {.    
+000178c0: 2020 2020 2020 2020 2761 273a 207b 2773          'a': {'s
+000178d0: 6474 7970 6527 3a20 2764 6174 6574 696d  dtype': 'datetim
+000178e0: 6527 7d2c 0a20 2020 2020 2020 2020 2020  e'},.           
+000178f0: 2027 6227 3a20 7b27 7364 7479 7065 273a   'b': {'sdtype':
+00017900: 2027 6461 7465 7469 6d65 277d 2c0a 2020   'datetime'},.  
+00017910: 2020 2020 2020 2020 2020 2763 273a 207b            'c': {
+00017920: 2773 6474 7970 6527 3a20 276e 756d 6572  'sdtype': 'numer
+00017930: 6963 616c 277d 0a20 2020 2020 2020 207d  ical'}.        }
+00017940: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
+00017950: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+00017960: 7373 6167 6520 3d20 7265 2e65 7363 6170  ssage = re.escap
+00017970: 6528 0a20 2020 2020 2020 2020 2020 2027  e(.            '
+00017980: 4120 5261 6e67 6520 636f 6e73 7472 6169  A Range constrai
+00017990: 6e74 2069 7320 6265 696e 6720 6170 706c  nt is being appl
+000179a0: 6965 6420 746f 2063 6f6c 756d 6e73 2077  ied to columns w
+000179b0: 6974 6820 6d69 736d 6174 6368 6564 2073  ith mismatched s
+000179c0: 6474 7970 6573 2027 0a20 2020 2020 2020  dtypes '.       
+000179d0: 2020 2020 2022 5b27 6127 2c20 2763 272c       "['a', 'c',
+000179e0: 2027 6227 5d2e 2041 6c6c 2063 6f6c 756d   'b']. All colum
+000179f0: 6e73 206d 7573 7420 6265 2065 6974 6865  ns must be eithe
+00017a00: 7220 6e75 6d65 7269 6361 6c20 6f72 2064  r numerical or d
+00017a10: 6174 6574 696d 652e 220a 2020 2020 2020  atetime.".      
+00017a20: 2020 290a 2020 2020 2020 2020 7769 7468    ).        with
+00017a30: 2070 7974 6573 742e 7261 6973 6573 2843   pytest.raises(C
+00017a40: 6f6e 7374 7261 696e 744d 6574 6164 6174  onstraintMetadat
+00017a50: 6145 7272 6f72 2c20 6d61 7463 683d 6572  aError, match=er
+00017a60: 726f 725f 6d65 7373 6167 6529 3a0a 2020  ror_message):.  
+00017a70: 2020 2020 2020 2020 2020 5261 6e67 652e            Range.
+00017a80: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
+00017a90: 7461 5f73 7065 6369 6669 635f 746f 5f63  ta_specific_to_c
+00017aa0: 6f6e 7374 7261 696e 7428 0a20 2020 2020  onstraint(.     
+00017ab0: 2020 2020 2020 2020 2020 206d 6574 6164             metad
+00017ac0: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
+00017ad0: 2020 2020 2068 6967 685f 636f 6c75 6d6e       high_column
+00017ae0: 5f6e 616d 653d 2761 272c 0a20 2020 2020  _name='a',.     
+00017af0: 2020 2020 2020 2020 2020 206c 6f77 5f63             low_c
+00017b00: 6f6c 756d 6e5f 6e61 6d65 3d27 6227 2c0a  olumn_name='b',.
+00017b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017b20: 6d69 6464 6c65 5f63 6f6c 756d 6e5f 6e61  middle_column_na
+00017b30: 6d65 3d27 6327 0a20 2020 2020 2020 2020  me='c'.         
+00017b40: 2020 2029 0a0a 2020 2020 6465 6620 7465     )..    def te
+00017b50: 7374 5f5f 7661 6c69 6461 7465 5f6d 6574  st__validate_met
+00017b60: 6164 6174 615f 7370 6563 6966 6963 5f74  adata_specific_t
+00017b70: 6f5f 636f 6e73 7472 6169 6e74 5f6e 756d  o_constraint_num
+00017b80: 6572 6963 616c 2873 656c 6629 3a0a 2020  erical(self):.  
+00017b90: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
+00017ba0: 6520 6060 5f76 616c 6964 6174 655f 6d65  e ``_validate_me
+00017bb0: 7461 6461 7461 5f73 7065 6369 6669 635f  tadata_specific_
+00017bc0: 746f 5f63 6f6e 7374 7261 696e 7460 6020  to_constraint`` 
+00017bd0: 7769 7468 206e 756d 6572 6963 616c 2e0a  with numerical..
+00017be0: 0a20 2020 2020 2020 2049 6620 7468 6520  .        If the 
+00017bf0: 6060 6869 6768 5f63 6f6c 756d 6e5f 6e61  ``high_column_na
+00017c00: 6d65 6060 2c20 6060 6d69 6464 6c65 5f63  me``, ``middle_c
+00017c10: 6f6c 756d 6e5f 6e61 6d65 6060 2061 6e64  olumn_name`` and
+00017c20: 2060 606c 6f77 5f63 6f6c 756d 6e5f 6e61   ``low_column_na
+00017c30: 6d65 6060 0a20 2020 2020 2020 2061 7265  me``.        are
+00017c40: 206e 756d 6572 6963 616c 2c20 7468 656e   numerical, then
+00017c50: 2074 6865 2076 616c 6964 6174 696f 6e20   the validation 
+00017c60: 7368 6f75 6c64 206e 6f74 2072 6169 7365  should not raise
+00017c70: 2061 6e20 6572 726f 722e 0a0a 2020 2020   an error...    
+00017c80: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
+00017c90: 2020 2020 2020 202d 204d 6574 6164 6174         - Metadat
+00017ca0: 6120 7769 7468 2073 6474 7970 6573 2073  a with sdtypes s
+00017cb0: 6574 2074 6f20 6e75 6d65 7269 6361 6c20  et to numerical 
+00017cc0: 666f 7220 7468 6520 6869 6768 2c20 6d69  for the high, mi
+00017cd0: 6464 6c65 2061 6e64 206c 6f77 2063 6f6c  ddle and low col
+00017ce0: 756d 6e2e 0a20 2020 2020 2020 2022 2222  umn..        """
+00017cf0: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+00017d00: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+00017d10: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
+00017d20: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
+00017d30: 6d6e 7320 3d20 7b0a 2020 2020 2020 2020  mns = {.        
+00017d40: 2020 2020 2761 273a 207b 2773 6474 7970      'a': {'sdtyp
+00017d50: 6527 3a20 276e 756d 6572 6963 616c 277d  e': 'numerical'}
+00017d60: 2c0a 2020 2020 2020 2020 2020 2020 2762  ,.            'b
+00017d70: 273a 207b 2773 6474 7970 6527 3a20 276e  ': {'sdtype': 'n
+00017d80: 756d 6572 6963 616c 277d 2c0a 2020 2020  umerical'},.    
+00017d90: 2020 2020 2020 2020 2763 273a 207b 2773          'c': {'s
+00017da0: 6474 7970 6527 3a20 276e 756d 6572 6963  dtype': 'numeric
+00017db0: 616c 277d 0a20 2020 2020 2020 207d 0a0a  al'}.        }..
+00017dc0: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
+00017dd0: 2020 2020 2020 5261 6e67 652e 5f76 616c        Range._val
+00017de0: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
+00017df0: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
+00017e00: 7261 696e 7428 0a20 2020 2020 2020 2020  raint(.         
+00017e10: 2020 206d 6574 6164 6174 612c 0a20 2020     metadata,.   
+00017e20: 2020 2020 2020 2020 2068 6967 685f 636f           high_co
+00017e30: 6c75 6d6e 5f6e 616d 653d 2761 272c 0a20  lumn_name='a',. 
+00017e40: 2020 2020 2020 2020 2020 206c 6f77 5f63             low_c
+00017e50: 6f6c 756d 6e5f 6e61 6d65 3d27 6227 2c0a  olumn_name='b',.
+00017e60: 2020 2020 2020 2020 2020 2020 6d69 6464              midd
+00017e70: 6c65 5f63 6f6c 756d 6e5f 6e61 6d65 3d27  le_column_name='
+00017e80: 6327 0a20 2020 2020 2020 2029 0a0a 2020  c'.        )..  
+00017e90: 2020 6465 6620 7465 7374 5f5f 7661 6c69    def test__vali
+00017ea0: 6461 7465 5f6d 6574 6164 6174 615f 7370  date_metadata_sp
+00017eb0: 6563 6966 6963 5f74 6f5f 636f 6e73 7472  ecific_to_constr
+00017ec0: 6169 6e74 5f6e 756d 6572 6963 616c 5f65  aint_numerical_e
+00017ed0: 7272 6f72 2873 656c 6629 3a0a 2020 2020  rror(self):.    
+00017ee0: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
+00017ef0: 6060 5f76 616c 6964 6174 655f 6d65 7461  ``_validate_meta
+00017f00: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
+00017f10: 5f63 6f6e 7374 7261 696e 7460 6020 7769  _constraint`` wi
+00017f20: 7468 206e 756d 6572 6963 616c 2e0a 0a20  th numerical... 
+00017f30: 2020 2020 2020 2049 6620 7468 6520 6060         If the ``
+00017f40: 6869 6768 5f63 6f6c 756d 6e5f 6e61 6d65  high_column_name
+00017f50: 6060 2c20 6060 6d69 6464 6c65 5f63 6f6c  ``, ``middle_col
+00017f60: 756d 6e5f 6e61 6d65 6060 2061 6e64 2060  umn_name`` and `
+00017f70: 606c 6f77 5f63 6f6c 756d 6e5f 6e61 6d65  `low_column_name
+00017f80: 6060 0a20 2020 2020 2020 2061 7265 206e  ``.        are n
+00017f90: 6f74 2061 6c6c 206e 756d 6572 6963 616c  ot all numerical
+00017fa0: 2c20 7468 656e 2074 6865 2076 616c 6964  , then the valid
+00017fb0: 6174 696f 6e20 7368 6f75 6c64 2072 6169  ation should rai
+00017fc0: 7365 2061 6e20 6572 726f 722e 0a0a 2020  se an error...  
+00017fd0: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
+00017fe0: 2020 2020 2020 2020 202d 204d 6574 6164           - Metad
+00017ff0: 6174 6120 7769 7468 2073 6474 7970 6573  ata with sdtypes
+00018000: 2073 6574 2074 6f20 6e75 6d65 7269 6361   set to numerica
+00018010: 6c20 666f 7220 7468 6520 6869 6768 2061  l for the high a
+00018020: 6e64 206c 6f77 2063 6f6c 756d 6e0a 2020  nd low column.  
+00018030: 2020 2020 2020 2020 2020 6275 7420 6e6f            but no
+00018040: 7420 7468 6520 6d69 6464 6c65 2e0a 2020  t the middle..  
+00018050: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00018060: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
+00018070: 2020 6d65 7461 6461 7461 203d 204d 6f63    metadata = Moc
+00018080: 6b28 290a 2020 2020 2020 2020 6d65 7461  k().        meta
+00018090: 6461 7461 2e63 6f6c 756d 6e73 203d 207b  data.columns = {
+000180a0: 0a20 2020 2020 2020 2020 2020 2027 6127  .            'a'
+000180b0: 3a20 7b27 7364 7479 7065 273a 2027 6e75  : {'sdtype': 'nu
+000180c0: 6d65 7269 6361 6c27 7d2c 0a20 2020 2020  merical'},.     
+000180d0: 2020 2020 2020 2027 6227 3a20 7b27 7364         'b': {'sd
+000180e0: 7479 7065 273a 2027 6e75 6d65 7269 6361  type': 'numerica
+000180f0: 6c27 7d2c 0a20 2020 2020 2020 2020 2020  l'},.           
+00018100: 2027 6327 3a20 7b27 7364 7479 7065 273a   'c': {'sdtype':
+00018110: 2027 6461 7465 7469 6d65 277d 0a20 2020   'datetime'}.   
+00018120: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
+00018130: 2320 5275 6e0a 2020 2020 2020 2020 6572  # Run.        er
+00018140: 726f 725f 6d65 7373 6167 6520 3d20 7265  ror_message = re
+00018150: 2e65 7363 6170 6528 0a20 2020 2020 2020  .escape(.       
+00018160: 2020 2020 2027 4120 5261 6e67 6520 636f       'A Range co
+00018170: 6e73 7472 6169 6e74 2069 7320 6265 696e  nstraint is bein
+00018180: 6720 6170 706c 6965 6420 746f 2063 6f6c  g applied to col
+00018190: 756d 6e73 2077 6974 6820 6d69 736d 6174  umns with mismat
+000181a0: 6368 6564 2073 6474 7970 6573 2027 0a20  ched sdtypes '. 
+000181b0: 2020 2020 2020 2020 2020 2022 5b27 6127             "['a'
+000181c0: 2c20 2763 272c 2027 6227 5d2e 2041 6c6c  , 'c', 'b']. All
+000181d0: 2063 6f6c 756d 6e73 206d 7573 7420 6265   columns must be
+000181e0: 2065 6974 6865 7220 6e75 6d65 7269 6361   either numerica
+000181f0: 6c20 6f72 2064 6174 6574 696d 652e 220a  l or datetime.".
+00018200: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00018210: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+00018220: 6973 6573 2843 6f6e 7374 7261 696e 744d  ises(ConstraintM
+00018230: 6574 6164 6174 6145 7272 6f72 2c20 6d61  etadataError, ma
+00018240: 7463 683d 6572 726f 725f 6d65 7373 6167  tch=error_messag
+00018250: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00018260: 5261 6e67 652e 5f76 616c 6964 6174 655f  Range._validate_
+00018270: 6d65 7461 6461 7461 5f73 7065 6369 6669  metadata_specifi
+00018280: 635f 746f 5f63 6f6e 7374 7261 696e 7428  c_to_constraint(
+00018290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000182a0: 206d 6574 6164 6174 612c 0a20 2020 2020   metadata,.     
+000182b0: 2020 2020 2020 2020 2020 2068 6967 685f             high_
+000182c0: 636f 6c75 6d6e 5f6e 616d 653d 2761 272c  column_name='a',
+000182d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000182e0: 206c 6f77 5f63 6f6c 756d 6e5f 6e61 6d65   low_column_name
+000182f0: 3d27 6227 2c0a 2020 2020 2020 2020 2020  ='b',.          
+00018300: 2020 2020 2020 6d69 6464 6c65 5f63 6f6c        middle_col
+00018310: 756d 6e5f 6e61 6d65 3d27 6327 0a20 2020  umn_name='c'.   
+00018320: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00018330: 6465 6620 7465 7374 5f5f 5f69 6e69 745f  def test___init_
+00018340: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00018350: 2022 2222 5465 7374 2074 6865 2060 6052   """Test the ``R
+00018360: 616e 6765 2e5f 5f69 6e69 745f 5f60 6020  ange.__init__`` 
+00018370: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
+00018380: 2054 6865 2069 6e73 7461 6e63 6520 7368   The instance sh
+00018390: 6f75 6c64 2063 6f6e 7461 696e 2074 6865  ould contain the
+000183a0: 206e 616d 6520 6f66 2074 6865 2074 6872   name of the thr
+000183b0: 6565 2070 6173 7365 6420 636f 6c75 6d6e  ee passed column
+000183c0: 7320 616e 6420 616c 736f 0a20 2020 2020  s and also.     
+000183d0: 2020 2075 7365 2061 6e20 6f70 6572 6174     use an operat
+000183e0: 6f72 2060 603c 6060 2069 6620 6060 7374  or ``<`` if ``st
+000183f0: 7269 6374 5f62 6f75 6e64 6172 6965 7360  rict_boundaries`
+00018400: 6020 6973 2060 6054 7275 6560 6020 6279  ` is ``True`` by
+00018410: 2064 6566 6175 6c74 2e0a 2020 2020 2020   default..      
+00018420: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
+00018430: 2020 2020 202d 2054 6872 6565 2063 6f6c       - Three col
+00018440: 756d 6e20 6e61 6d65 732e 0a20 2020 2020  umn names..     
+00018450: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00018460: 2052 756e 0a20 2020 2020 2020 2069 6e73   Run.        ins
+00018470: 7461 6e63 6520 3d20 5261 6e67 6528 2761  tance = Range('a
+00018480: 6765 5f77 6865 6e5f 6a6f 696e 6564 272c  ge_when_joined',
+00018490: 2027 6375 7272 656e 745f 6167 6527 2c20   'current_age', 
+000184a0: 2772 6574 6972 656d 656e 745f 6167 6527  'retirement_age'
+000184b0: 290a 0a20 2020 2020 2020 2023 2041 7373  )..        # Ass
+000184c0: 6572 740a 2020 2020 2020 2020 6173 7365  ert.        asse
+000184d0: 7274 2069 6e73 7461 6e63 652e 6c6f 775f  rt instance.low_
+000184e0: 636f 6c75 6d6e 5f6e 616d 6520 3d3d 2027  column_name == '
+000184f0: 6167 655f 7768 656e 5f6a 6f69 6e65 6427  age_when_joined'
+00018500: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00018510: 696e 7374 616e 6365 2e6d 6964 646c 655f  instance.middle_
+00018520: 636f 6c75 6d6e 5f6e 616d 6520 3d3d 2027  column_name == '
+00018530: 6375 7272 656e 745f 6167 6527 0a20 2020  current_age'.   
+00018540: 2020 2020 2061 7373 6572 7420 696e 7374       assert inst
+00018550: 616e 6365 2e68 6967 685f 636f 6c75 6d6e  ance.high_column
+00018560: 5f6e 616d 6520 3d3d 2027 7265 7469 7265  _name == 'retire
+00018570: 6d65 6e74 5f61 6765 270a 2020 2020 2020  ment_age'.      
+00018580: 2020 6173 7365 7274 2069 6e73 7461 6e63    assert instanc
+00018590: 652e 5f6f 7065 7261 746f 7220 3d3d 206f  e._operator == o
+000185a0: 7065 7261 746f 722e 6c74 0a0a 2020 2020  perator.lt..    
+000185b0: 6465 6620 7465 7374 5f5f 5f69 6e69 745f  def test___init_
+000185c0: 5f73 7472 6963 745f 626f 756e 6461 7269  _strict_boundari
+000185d0: 6573 5f66 616c 7365 2873 656c 6629 3a0a  es_false(self):.
+000185e0: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
+000185f0: 7468 6520 6060 5261 6e67 652e 5f5f 696e  the ``Range.__in
+00018600: 6974 5f5f 6060 206d 6574 686f 642e 0a0a  it__`` method...
+00018610: 2020 2020 2020 2020 5465 7374 2074 6865          Test the
+00018620: 2060 605f 5f69 6e69 745f 5f60 6020 6d65   ``__init__`` me
+00018630: 7468 6f64 2077 6865 6e20 6060 7374 7269  thod when ``stri
+00018640: 6374 5f62 6f75 6e64 6172 6965 7360 6020  ct_boundaries`` 
+00018650: 6973 2060 6046 616c 7365 6060 2e0a 0a20  is ``False``... 
+00018660: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
+00018670: 2020 2020 2020 2020 2020 2d20 5468 7265            - Thre
+00018680: 6520 636f 6c75 6d6e 206e 616d 6573 2e0a  e column names..
+00018690: 2020 2020 2020 2020 2020 2020 2d20 6060              - ``
+000186a0: 7374 7269 6374 5f62 6f75 6e64 6172 6965  strict_boundarie
+000186b0: 733d 4661 6c73 6560 602e 0a0a 2020 2020  s=False``...    
+000186c0: 2020 2020 5369 6465 2045 6666 6563 743a      Side Effect:
+000186d0: 0a20 2020 2020 2020 2020 2020 202d 2060  .            - `
+000186e0: 6069 6e73 7461 6e63 652e 5f6f 7065 7261  `instance._opera
+000186f0: 746f 7260 6020 7368 6f75 6c64 2062 6520  tor`` should be 
+00018700: 6060 6f70 6572 6174 6f72 2e6c 6560 600a  ``operator.le``.
+00018710: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00018720: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
+00018730: 2020 696e 7374 616e 6365 203d 2052 616e    instance = Ran
+00018740: 6765 280a 2020 2020 2020 2020 2020 2020  ge(.            
+00018750: 2761 6765 5f77 6865 6e5f 6a6f 696e 6564  'age_when_joined
+00018760: 272c 0a20 2020 2020 2020 2020 2020 2027  ',.            '
+00018770: 6375 7272 656e 745f 6167 6527 2c0a 2020  current_age',.  
+00018780: 2020 2020 2020 2020 2020 2772 6574 6972            'retir
+00018790: 656d 656e 745f 6167 6527 2c0a 2020 2020  ement_age',.    
+000187a0: 2020 2020 2020 2020 7374 7269 6374 5f62          strict_b
+000187b0: 6f75 6e64 6172 6965 733d 4661 6c73 650a  oundaries=False.
+000187c0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+000187d0: 2020 2023 2041 7373 6572 740a 2020 2020     # Assert.    
+000187e0: 2020 2020 6173 7365 7274 2069 6e73 7461      assert insta
+000187f0: 6e63 652e 6c6f 775f 636f 6c75 6d6e 5f6e  nce.low_column_n
+00018800: 616d 6520 3d3d 2027 6167 655f 7768 656e  ame == 'age_when
+00018810: 5f6a 6f69 6e65 6427 0a20 2020 2020 2020  _joined'.       
+00018820: 2061 7373 6572 7420 696e 7374 616e 6365   assert instance
+00018830: 2e6d 6964 646c 655f 636f 6c75 6d6e 5f6e  .middle_column_n
+00018840: 616d 6520 3d3d 2027 6375 7272 656e 745f  ame == 'current_
+00018850: 6167 6527 0a20 2020 2020 2020 2061 7373  age'.        ass
+00018860: 6572 7420 696e 7374 616e 6365 2e68 6967  ert instance.hig
+00018870: 685f 636f 6c75 6d6e 5f6e 616d 6520 3d3d  h_column_name ==
+00018880: 2027 7265 7469 7265 6d65 6e74 5f61 6765   'retirement_age
+00018890: 270a 2020 2020 2020 2020 6173 7365 7274  '.        assert
+000188a0: 2069 6e73 7461 6e63 652e 5f6f 7065 7261   instance._opera
+000188b0: 746f 7220 3d3d 206f 7065 7261 746f 722e  tor == operator.
+000188c0: 6c65 0a0a 2020 2020 6465 6620 7465 7374  le..    def test
+000188d0: 5f5f 6765 745f 6469 6666 5f63 6f6c 756d  __get_diff_colum
+000188e0: 6e5f 6e61 6d65 2873 656c 6629 3a0a 2020  n_name(self):.  
+000188f0: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
+00018900: 6520 6060 5261 6e67 652e 5f67 6574 5f64  e ``Range._get_d
+00018910: 6966 665f 636f 6c75 6d6e 5f6e 616d 6560  iff_column_name`
+00018920: 6020 6d65 7468 6f64 2e0a 0a20 2020 2020  ` method...     
+00018930: 2020 2054 6869 7320 6d65 7468 6f64 2073     This method s
+00018940: 686f 756c 6420 7265 7475 726e 2074 6865  hould return the
+00018950: 206e 616d 6520 666f 7220 7468 6520 6e65   name for the ne
+00018960: 7720 6060 7472 616e 7366 6f72 6d5f 636f  w ``transform_co
+00018970: 6c75 6d6e 6060 2e0a 0a20 2020 2020 2020  lumn``...       
+00018980: 2053 6574 7570 3a0a 2020 2020 2020 2020   Setup:.        
+00018990: 2020 2020 2d20 4372 6561 7465 2061 2070      - Create a p
+000189a0: 642e 4461 7461 4672 616d 6520 7769 7468  d.DataFrame with
+000189b0: 2074 6872 6565 2063 6f6c 756d 6e73 2e0a   three columns..
+000189c0: 2020 2020 2020 2020 2020 2020 2d20 496e              - In
+000189d0: 7374 616e 6365 206f 6620 6060 5261 6e67  stance of ``Rang
+000189e0: 6560 6020 636f 6e73 7472 6169 6e74 2077  e`` constraint w
+000189f0: 6974 6820 7468 6f73 6520 7468 7265 6520  ith those three 
+00018a00: 636f 6c75 6d6e 206e 616d 6573 2e0a 0a20  column names... 
+00018a10: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
+00018a20: 2020 2020 2020 2020 2020 2d20 7064 2e44            - pd.D
+00018a30: 6174 6146 7261 6d65 2077 6974 6820 6060  ataFrame with ``
+00018a40: 6167 655f 7768 656e 5f6a 6f69 6e65 6460  age_when_joined`
+00018a50: 602c 2060 6063 7572 7265 6e74 5f61 6765  `, ``current_age
+00018a60: 6060 2c20 6060 7265 7469 7265 6d65 6e74  ``, ``retirement
+00018a70: 5f61 6765 6060 2063 6f6c 756d 6e73 2e0a  _age`` columns..
+00018a80: 0a20 2020 2020 2020 204f 7574 7075 743a  .        Output:
+00018a90: 0a20 2020 2020 2020 2020 2020 202d 2054  .            - T
+00018aa0: 6865 2063 6f6c 756d 6e20 6e61 6d65 7320  he column names 
+00018ab0: 636f 6e63 6174 656e 6174 6564 2077 6974  concatenated wit
+00018ac0: 6820 6060 2360 6020 7768 6572 6520 7468  h ``#`` where th
+00018ad0: 6520 6f72 6465 7220 6973 0a20 2020 2020  e order is.     
+00018ae0: 2020 2020 2020 2020 2074 6865 2060 606d           the ``m
+00018af0: 6964 646c 655f 636f 6c75 6d6e 5f6e 616d  iddle_column_nam
+00018b00: 6560 6020 666f 6c6c 6f77 6564 2062 7920  e`` followed by 
+00018b10: 6060 6c6f 7765 725f 636f 6c75 6d6e 5f6e  ``lower_column_n
+00018b20: 616d 6560 6020 616e 6420 656e 6473 2077  ame`` and ends w
+00018b30: 6974 6820 7468 650a 2020 2020 2020 2020  ith the.        
+00018b40: 2020 2020 2020 6060 6869 6768 6572 5f63        ``higher_c
+00018b50: 6f6c 756d 6e5f 6e61 6d65 6060 2e0a 2020  olumn_name``..  
+00018b60: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00018b70: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
+00018b80: 2020 7461 626c 655f 6461 7461 203d 2070    table_data = p
+00018b90: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
+00018ba0: 2020 2020 2020 2020 2020 2761 6765 5f77            'age_w
+00018bb0: 6865 6e5f 6a6f 696e 6564 273a 205b 3138  hen_joined': [18
+00018bc0: 2c20 3139 2c20 3230 5d2c 0a20 2020 2020  , 19, 20],.     
+00018bd0: 2020 2020 2020 2027 6375 7272 656e 745f         'current_
+00018be0: 6167 6527 3a20 5b32 312c 2032 322c 2032  age': [21, 22, 2
+00018bf0: 355d 2c0a 2020 2020 2020 2020 2020 2020  5],.            
+00018c00: 2772 6574 6972 656d 656e 745f 6167 6527  'retirement_age'
+00018c10: 3a20 5b36 352c 2036 382c 2037 355d 0a20  : [65, 68, 75]. 
+00018c20: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
+00018c30: 2020 696e 7374 616e 6365 203d 2052 616e    instance = Ran
+00018c40: 6765 2827 6167 655f 7768 656e 5f6a 6f69  ge('age_when_joi
+00018c50: 6e65 6427 2c20 2763 7572 7265 6e74 5f61  ned', 'current_a
+00018c60: 6765 272c 2027 7265 7469 7265 6d65 6e74  ge', 'retirement
+00018c70: 5f61 6765 2729 0a0a 2020 2020 2020 2020  _age')..        
+00018c80: 2320 5275 6e0a 2020 2020 2020 2020 7472  # Run.        tr
+00018c90: 616e 7366 6f72 6d65 645f 636f 6c75 6d6e  ansformed_column
+00018ca0: 5f6e 616d 6520 3d20 696e 7374 616e 6365  _name = instance
+00018cb0: 2e5f 6765 745f 6469 6666 5f63 6f6c 756d  ._get_diff_colum
+00018cc0: 6e5f 6e61 6d65 2874 6162 6c65 5f64 6174  n_name(table_dat
+00018cd0: 6129 0a0a 2020 2020 2020 2020 2320 4173  a)..        # As
+00018ce0: 7365 7274 0a20 2020 2020 2020 2061 7373  sert.        ass
+00018cf0: 6572 7420 7472 616e 7366 6f72 6d65 645f  ert transformed_
+00018d00: 636f 6c75 6d6e 5f6e 616d 6520 3d3d 2027  column_name == '
+00018d10: 6375 7272 656e 745f 6167 6523 6167 655f  current_age#age_
+00018d20: 7768 656e 5f6a 6f69 6e65 6423 7265 7469  when_joined#reti
+00018d30: 7265 6d65 6e74 5f61 6765 270a 0a20 2020  rement_age'..   
+00018d40: 2064 6566 2074 6573 745f 5f67 6574 5f69   def test__get_i
+00018d50: 735f 6461 7465 7469 6d65 2873 656c 6629  s_datetime(self)
+00018d60: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
+00018d70: 7420 7468 6174 2074 6865 206d 6574 686f  t that the metho
+00018d80: 6420 6465 7465 6374 7320 7768 6574 6865  d detects whethe
+00018d90: 7220 6f72 206e 6f74 2074 6865 2060 6064  r or not the ``d
+00018da0: 6174 6160 6020 6973 2060 6064 6174 6574  ata`` is ``datet
+00018db0: 696d 6560 602e 0a0a 2020 2020 2020 2020  ime``...        
+00018dc0: 5468 6973 206d 6574 686f 6420 7368 6f75  This method shou
+00018dd0: 6c64 2064 6574 6563 7420 7768 6574 6865  ld detect whethe
+00018de0: 7220 6f72 206e 6f74 2074 6865 2064 6174  r or not the dat
+00018df0: 6120 6973 2060 6064 6174 6574 696d 6560  a is ``datetime`
+00018e00: 6020 616e 6420 6966 2069 6e20 6361 7365  ` and if in case
+00018e10: 2073 6f6d 6520 6973 0a20 2020 2020 2020   some is.       
+00018e20: 2062 7574 206f 7468 6572 2069 7320 6e6f   but other is no
+00018e30: 742c 2072 6169 7365 7320 616e 2065 7272  t, raises an err
+00018e40: 6f72 2e0a 0a20 2020 2020 2020 2053 6574  or...        Set
+00018e50: 7570 3a0a 2020 2020 2020 2020 2020 2020  up:.            
+00018e60: 2d20 4372 6561 7465 2061 2070 642e 4461  - Create a pd.Da
+00018e70: 7461 4672 616d 6520 7769 7468 2074 6872  taFrame with thr
+00018e80: 6565 2063 6f6c 756d 6e73 2074 6861 7420  ee columns that 
+00018e90: 6172 6520 6461 7465 7469 6d65 2064 6174  are datetime dat
+00018ea0: 612e 0a20 2020 2020 2020 2020 2020 202d  a..            -
+00018eb0: 2049 6e73 7461 6e63 6520 6f66 2060 6052   Instance of ``R
+00018ec0: 616e 6765 6060 2063 6f6e 7374 7261 696e  ange`` constrain
+00018ed0: 7420 7769 7468 2074 686f 7365 2074 6872  t with those thr
+00018ee0: 6565 2063 6f6c 756d 6e20 6e61 6d65 732e  ee column names.
+00018ef0: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
+00018f00: 0a20 2020 2020 2020 2020 2020 202d 2070  .            - p
+00018f10: 642e 4461 7461 4672 616d 6520 7769 7468  d.DataFrame with
+00018f20: 2060 606a 6f69 6e5f 6461 7465 6060 2c20   ``join_date``, 
+00018f30: 6060 7072 6f6d 6f74 696f 6e5f 6461 7465  ``promotion_date
+00018f40: 6060 2c20 6060 7265 7469 7265 6d65 6e74  ``, ``retirement
+00018f50: 5f64 6174 6560 6020 636f 6c75 6d6e 732e  _date`` columns.
+00018f60: 0a0a 2020 2020 2020 2020 4f75 7470 7574  ..        Output
+00018f70: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+00018f80: 5468 6520 6f75 7470 7574 2073 686f 756c  The output shoul
+00018f90: 6420 6265 2054 7275 652e 0a20 2020 2020  d be True..     
+00018fa0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00018fb0: 2053 6574 7570 0a20 2020 2020 2020 2074   Setup.        t
+00018fc0: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
+00018fd0: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
+00018fe0: 2020 2020 2020 2027 6a6f 696e 5f64 6174         'join_dat
+00018ff0: 6527 3a20 7064 2e74 6f5f 6461 7465 7469  e': pd.to_dateti
+00019000: 6d65 285b 2732 3032 312d 3032 2d31 3027  me(['2021-02-10'
+00019010: 2c20 2732 3032 312d 3035 2d31 3027 2c20  , '2021-05-10', 
+00019020: 2732 3032 312d 3038 2d31 3127 5d29 2c0a  '2021-08-11']),.
+00019030: 2020 2020 2020 2020 2020 2020 2770 726f              'pro
+00019040: 6d6f 7469 6f6e 5f64 6174 6527 3a20 7064  motion_date': pd
+00019050: 2e74 6f5f 6461 7465 7469 6d65 285b 2732  .to_datetime(['2
+00019060: 3032 322d 3035 2d31 3027 2c20 2732 3032  022-05-10', '202
+00019070: 322d 3036 2d31 3027 2c20 2732 3032 322d  2-06-10', '2022-
+00019080: 3131 2d31 3727 5d29 2c0a 2020 2020 2020  11-17']),.      
+00019090: 2020 2020 2020 2772 6574 6972 656d 656e        'retiremen
+000190a0: 745f 6461 7465 273a 2070 642e 746f 5f64  t_date': pd.to_d
+000190b0: 6174 6574 696d 6528 5b27 3230 3530 2d31  atetime(['2050-1
+000190c0: 302d 3131 272c 2027 3230 3538 2d31 302d  0-11', '2058-10-
+000190d0: 3034 272c 2027 3230 3735 2d31 312d 3134  04', '2075-11-14
+000190e0: 275d 290a 2020 2020 2020 2020 7d29 0a20  ']).        }). 
+000190f0: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
+00019100: 3d20 5261 6e67 6528 276a 6f69 6e5f 6461  = Range('join_da
+00019110: 7465 272c 2027 7072 6f6d 6f74 696f 6e5f  te', 'promotion_
+00019120: 6461 7465 272c 2027 7265 7469 7265 6d65  date', 'retireme
+00019130: 6e74 5f64 6174 6527 290a 0a20 2020 2020  nt_date')..     
+00019140: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
+00019150: 2069 735f 6461 7465 7469 6d65 203d 2069   is_datetime = i
+00019160: 6e73 7461 6e63 652e 5f67 6574 5f69 735f  nstance._get_is_
+00019170: 6461 7465 7469 6d65 2874 6162 6c65 5f64  datetime(table_d
+00019180: 6174 6129 0a0a 2020 2020 2020 2020 2320  ata)..        # 
+00019190: 4173 7365 7274 0a20 2020 2020 2020 2061  Assert.        a
+000191a0: 7373 6572 7420 6973 5f64 6174 6574 696d  ssert is_datetim
+000191b0: 650a 0a20 2020 2064 6566 2074 6573 745f  e..    def test_
+000191c0: 5f67 6574 5f69 735f 6461 7465 7469 6d65  _get_is_datetime
+000191d0: 5f6e 6f5f 6461 7465 7469 6d65 7328 7365  _no_datetimes(se
+000191e0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+000191f0: 5465 7374 2074 6861 7420 7468 6520 6d65  Test that the me
+00019200: 7468 6f64 2064 6574 6563 7473 2077 6865  thod detects whe
+00019210: 7468 6572 206f 7220 6e6f 7420 7468 6520  ther or not the 
+00019220: 6060 6461 7461 6060 2069 7320 6060 6461  ``data`` is ``da
+00019230: 7465 7469 6d65 6060 2e0a 0a20 2020 2020  tetime``...     
+00019240: 2020 2054 6869 7320 6d65 7468 6f64 2073     This method s
+00019250: 686f 756c 6420 6465 7465 6374 2077 6865  hould detect whe
+00019260: 7468 6572 206f 7220 6e6f 7420 7468 6520  ther or not the 
+00019270: 6461 7461 2069 7320 6060 6461 7465 7469  data is ``dateti
+00019280: 6d65 6060 2061 6e64 2069 6620 696e 2063  me`` and if in c
+00019290: 6173 6520 736f 6d65 2069 730a 2020 2020  ase some is.    
+000192a0: 2020 2020 6275 7420 6f74 6865 7220 6973      but other is
+000192b0: 206e 6f74 2c20 7261 6973 6573 2061 6e20   not, raises an 
+000192c0: 6572 726f 722e 0a0a 2020 2020 2020 2020  error...        
+000192d0: 5365 7475 703a 0a20 2020 2020 2020 2020  Setup:.         
+000192e0: 2020 202d 2043 7265 6174 6520 6120 7064     - Create a pd
+000192f0: 2e44 6174 6146 7261 6d65 2077 6974 6820  .DataFrame with 
+00019300: 7468 7265 6520 636f 6c75 6d6e 7320 7468  three columns th
+00019310: 6174 2064 6f20 6e6f 7420 636f 6e74 6169  at do not contai
+00019320: 6e20 6461 7465 7469 6d65 2064 6174 612e  n datetime data.
+00019330: 0a20 2020 2020 2020 2020 2020 202d 2049  .            - I
+00019340: 6e73 7461 6e63 6520 6f66 2060 6052 616e  nstance of ``Ran
+00019350: 6765 6060 2063 6f6e 7374 7261 696e 7420  ge`` constraint 
+00019360: 7769 7468 2074 686f 7365 2074 6872 6565  with those three
+00019370: 2063 6f6c 756d 6e20 6e61 6d65 732e 0a0a   column names...
+00019380: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
+00019390: 2020 2020 2020 2020 2020 202d 2070 642e             - pd.
+000193a0: 4461 7461 4672 616d 6520 7769 7468 2060  DataFrame with `
+000193b0: 6061 6765 5f77 6865 6e5f 6a6f 696e 6564  `age_when_joined
+000193c0: 6060 2c20 6060 6375 7272 656e 745f 6167  ``, ``current_ag
+000193d0: 6560 602c 2060 6072 6574 6972 656d 656e  e``, ``retiremen
+000193e0: 745f 6167 6560 6020 636f 6c75 6d6e 732e  t_age`` columns.
+000193f0: 0a0a 2020 2020 2020 2020 4f75 7470 7574  ..        Output
+00019400: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+00019410: 5468 6520 6f75 7470 7574 2073 686f 756c  The output shoul
+00019420: 6420 6265 2066 616c 7365 2073 696e 6365  d be false since
+00019430: 2061 6c6c 2074 6865 2064 6174 6120 6973   all the data is
+00019440: 2060 6069 6e74 6060 2e0a 2020 2020 2020   ``int``..      
+00019450: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+00019460: 5365 7475 700a 2020 2020 2020 2020 7461  Setup.        ta
+00019470: 626c 655f 6461 7461 203d 2070 642e 4461  ble_data = pd.Da
+00019480: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
+00019490: 2020 2020 2020 2761 6765 5f77 6865 6e5f        'age_when_
+000194a0: 6a6f 696e 6564 273a 205b 3138 2c20 3139  joined': [18, 19
+000194b0: 2c20 3230 5d2c 0a20 2020 2020 2020 2020  , 20],.         
+000194c0: 2020 2027 6375 7272 656e 745f 6167 6527     'current_age'
+000194d0: 3a20 5b32 312c 2032 322c 2032 355d 2c0a  : [21, 22, 25],.
+000194e0: 2020 2020 2020 2020 2020 2020 2772 6574              'ret
+000194f0: 6972 656d 656e 745f 6167 6527 3a20 5b36  irement_age': [6
+00019500: 352c 2036 382c 2037 355d 0a20 2020 2020  5, 68, 75].     
+00019510: 2020 207d 290a 2020 2020 2020 2020 696e     }).        in
+00019520: 7374 616e 6365 203d 2052 616e 6765 2827  stance = Range('
+00019530: 6167 655f 7768 656e 5f6a 6f69 6e65 6427  age_when_joined'
+00019540: 2c20 2763 7572 7265 6e74 5f61 6765 272c  , 'current_age',
+00019550: 2027 7265 7469 7265 6d65 6e74 5f61 6765   'retirement_age
+00019560: 2729 0a0a 2020 2020 2020 2020 2320 5275  ')..        # Ru
+00019570: 6e0a 2020 2020 2020 2020 6973 5f64 6174  n.        is_dat
+00019580: 6574 696d 6520 3d20 696e 7374 616e 6365  etime = instance
+00019590: 2e5f 6765 745f 6973 5f64 6174 6574 696d  ._get_is_datetim
+000195a0: 6528 7461 626c 655f 6461 7461 290a 0a20  e(table_data).. 
+000195b0: 2020 2020 2020 2023 2041 7373 6572 740a         # Assert.
+000195c0: 2020 2020 2020 2020 6173 7365 7274 206e          assert n
+000195d0: 6f74 2069 735f 6461 7465 7469 6d65 0a0a  ot is_datetime..
+000195e0: 2020 2020 6465 6620 7465 7374 5f5f 6765      def test__ge
+000195f0: 745f 6973 5f64 6174 6574 696d 655f 7261  t_is_datetime_ra
+00019600: 6973 6573 5f61 6e5f 6572 726f 7228 7365  ises_an_error(se
+00019610: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00019620: 5465 7374 2074 6861 7420 7468 6520 6d65  Test that the me
+00019630: 7468 6f64 2064 6574 6563 7473 2077 6865  thod detects whe
+00019640: 7468 6572 206f 7220 6e6f 7420 7468 6520  ther or not the 
+00019650: 6060 6461 7461 6060 2069 7320 6060 6461  ``data`` is ``da
+00019660: 7465 7469 6d65 6060 2e0a 0a20 2020 2020  tetime``...     
+00019670: 2020 2054 6869 7320 6d65 7468 6f64 2073     This method s
+00019680: 686f 756c 6420 6465 7465 6374 2077 6865  hould detect whe
+00019690: 7468 6572 206f 7220 6e6f 7420 7468 6520  ther or not the 
+000196a0: 6461 7461 2069 7320 6060 6461 7465 7469  data is ``dateti
+000196b0: 6d65 6060 2061 6e64 2069 6620 696e 2063  me`` and if in c
+000196c0: 6173 6520 736f 6d65 2069 730a 2020 2020  ase some is.    
+000196d0: 2020 2020 6275 7420 6f74 6865 7220 6973      but other is
+000196e0: 206e 6f74 2c20 7261 6973 6573 2061 6e20   not, raises an 
+000196f0: 6572 726f 722e 0a0a 2020 2020 2020 2020  error...        
+00019700: 5365 7475 703a 0a20 2020 2020 2020 2020  Setup:.         
+00019710: 2020 202d 2043 7265 6174 6520 6120 7064     - Create a pd
+00019720: 2e44 6174 6146 7261 6d65 2077 6974 6820  .DataFrame with 
+00019730: 7468 7265 6520 636f 6c75 6d6e 7320 7468  three columns th
+00019740: 6174 2063 6f6e 7461 696e 2062 6f74 6820  at contain both 
+00019750: 6461 7465 7469 6d65 2061 6e64 206e 6f6e  datetime and non
+00019760: 0a20 2020 2020 2020 2020 2020 2020 2064  .              d
+00019770: 6174 6574 696d 6520 6461 7461 2e0a 2020  atetime data..  
+00019780: 2020 2020 2020 2020 2020 2d20 496e 7374            - Inst
+00019790: 616e 6365 206f 6620 6060 5261 6e67 6560  ance of ``Range`
+000197a0: 6020 636f 6e73 7472 6169 6e74 2077 6974  ` constraint wit
+000197b0: 6820 7468 6f73 6520 7468 7265 6520 636f  h those three co
+000197c0: 6c75 6d6e 206e 616d 6573 2e0a 0a20 2020  lumn names...   
+000197d0: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
+000197e0: 2020 2020 2020 2020 2d20 7064 2e44 6174          - pd.Dat
+000197f0: 6146 7261 6d65 2077 6974 6820 6060 6a6f  aFrame with ``jo
+00019800: 696e 5f64 6174 6560 602c 2060 6070 726f  in_date``, ``pro
+00019810: 6d6f 7469 6f6e 5f64 6174 6560 602c 2060  motion_date``, `
+00019820: 6063 7572 7265 6e74 5f61 6765 6060 2063  `current_age`` c
+00019830: 6f6c 756d 6e73 2e0a 0a20 2020 2020 2020  olumns...       
+00019840: 2053 6964 6520 4566 6665 6374 3a0a 2020   Side Effect:.  
+00019850: 2020 2020 2020 2020 2020 2d20 5661 6c75            - Valu
+00019860: 6520 6572 726f 7220 7769 7468 2074 6865  e error with the
+00019870: 2065 7870 6563 7465 6420 6d65 7373 6167   expected messag
+00019880: 6520 7368 6f75 6c64 2062 6520 7261 6973  e should be rais
+00019890: 6564 2e0a 2020 2020 2020 2020 2222 220a  ed..        """.
+000198a0: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
+000198b0: 2020 2020 2020 2020 7461 626c 655f 6461          table_da
+000198c0: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
+000198d0: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
+000198e0: 276a 6f69 6e5f 6461 7465 273a 2070 642e  'join_date': pd.
+000198f0: 746f 5f64 6174 6574 696d 6528 5b27 3230  to_datetime(['20
+00019900: 3231 2d30 322d 3130 272c 2027 3230 3231  21-02-10', '2021
+00019910: 2d30 352d 3130 272c 2027 3230 3231 2d30  -05-10', '2021-0
+00019920: 382d 3131 275d 292c 0a20 2020 2020 2020  8-11']),.       
+00019930: 2020 2020 2027 7072 6f6d 6f74 696f 6e5f       'promotion_
+00019940: 6461 7465 273a 2070 642e 746f 5f64 6174  date': pd.to_dat
+00019950: 6574 696d 6528 5b27 3230 3232 2d30 352d  etime(['2022-05-
+00019960: 3130 272c 2027 3230 3232 2d30 362d 3130  10', '2022-06-10
+00019970: 272c 2027 3230 3232 2d31 312d 3137 275d  ', '2022-11-17']
+00019980: 292c 0a20 2020 2020 2020 2020 2020 2027  ),.            '
+00019990: 6375 7272 656e 745f 6167 6527 3a20 5b32  current_age': [2
+000199a0: 312c 2032 322c 2032 355d 2c0a 2020 2020  1, 22, 25],.    
+000199b0: 2020 2020 7d29 0a20 2020 2020 2020 2069      }).        i
+000199c0: 6e73 7461 6e63 6520 3d20 5261 6e67 6528  nstance = Range(
+000199d0: 276a 6f69 6e5f 6461 7465 272c 2027 7072  'join_date', 'pr
+000199e0: 6f6d 6f74 696f 6e5f 6461 7465 272c 2027  omotion_date', '
+000199f0: 6375 7272 656e 745f 6167 6527 290a 2020  current_age').  
+00019a00: 2020 2020 2020 6578 7065 6374 6564 5f74        expected_t
+00019a10: 6578 7420 3d20 2754 6865 2063 6f6e 7374  ext = 'The const
+00019a20: 7261 696e 7420 636f 6c75 6d6e 2061 6e64  raint column and
+00019a30: 2062 6f75 6e64 7320 6d75 7374 2061 6c6c   bounds must all
+00019a40: 2062 6520 6461 7465 7469 6d65 2e27 0a0a   be datetime.'..
+00019a50: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
+00019a60: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+00019a70: 742e 7261 6973 6573 2856 616c 7565 4572  t.raises(ValueEr
+00019a80: 726f 722c 206d 6174 6368 3d65 7870 6563  ror, match=expec
+00019a90: 7465 645f 7465 7874 293a 0a20 2020 2020  ted_text):.     
+00019aa0: 2020 2020 2020 2069 6e73 7461 6e63 652e         instance.
+00019ab0: 5f67 6574 5f69 735f 6461 7465 7469 6d65  _get_is_datetime
+00019ac0: 2874 6162 6c65 5f64 6174 6129 0a0a 2020  (table_data)..  
+00019ad0: 2020 6465 6620 7465 7374 5f5f 6669 7428    def test__fit(
+00019ae0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00019af0: 2222 5465 7374 2074 6865 2060 605f 6669  ""Test the ``_fi
+00019b00: 7460 6020 6d65 7468 6f64 206f 6620 6060  t`` method of ``
+00019b10: 5261 6e67 6560 602e 0a0a 2020 2020 2020  Range``...      
+00019b20: 2020 5465 7374 2074 6861 7420 7468 6520    Test that the 
+00019b30: 6060 5f66 6974 6060 206d 6574 686f 6420  ``_fit`` method 
+00019b40: 7374 6f72 6573 2074 6865 2070 726f 7065  stores the prope
+00019b50: 7220 7472 616e 7366 6f72 6d61 7469 6f6e  r transformation
+00019b60: 2063 6f6c 756d 6e20 6e61 6d65 2061 6e64   column name and
+00019b70: 0a20 2020 2020 2020 206c 6561 726e 7320  .        learns 
+00019b80: 7768 6574 6865 7220 7468 6520 6461 7461  whether the data
+00019b90: 2069 7320 6060 6461 7465 7469 6d65 6060   is ``datetime``
+00019ba0: 6f72 206e 6f74 2061 6e64 2069 7427 7320  or not and it's 
+00019bb0: 6060 6474 7970 6560 602e 0a0a 2020 2020  ``dtype``...    
+00019bc0: 2020 2020 5365 7475 703a 0a20 2020 2020      Setup:.     
+00019bd0: 2020 2020 2020 202d 2043 7265 6174 6520         - Create 
+00019be0: 6120 7064 2e44 6174 6146 7261 6d65 2077  a pd.DataFrame w
+00019bf0: 6974 6820 7468 7265 6520 636f 6c75 6d6e  ith three column
+00019c00: 732e 0a20 2020 2020 2020 2020 2020 202d  s..            -
+00019c10: 2049 6e73 7461 6e63 6520 6f66 2060 6052   Instance of ``R
+00019c20: 616e 6765 6060 2063 6f6e 7374 7261 696e  ange`` constrain
+00019c30: 7420 7769 7468 2074 686f 7365 2074 6872  t with those thr
+00019c40: 6565 2063 6f6c 756d 6e20 6e61 6d65 732e  ee column names.
+00019c50: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
+00019c60: 0a20 2020 2020 2020 2020 2020 202d 2070  .            - p
+00019c70: 642e 4461 7461 4672 616d 6520 7769 7468  d.DataFrame with
+00019c80: 2060 606a 6f69 6e5f 6461 7465 6060 2c20   ``join_date``, 
+00019c90: 6060 7072 6f6d 6f74 696f 6e5f 6461 7465  ``promotion_date
+00019ca0: 6060 2c20 6060 6375 7272 656e 745f 6167  ``, ``current_ag
+00019cb0: 6560 6020 636f 6c75 6d6e 732e 0a0a 2020  e`` columns...  
+00019cc0: 2020 2020 2020 5369 6465 2045 6666 6563        Side Effec
+00019cd0: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
+00019ce0: 2069 6e73 7461 6e63 6520 6861 7320 6060   instance has ``
+00019cf0: 5f74 7261 6e73 666f 726d 6564 5f63 6f6c  _transformed_col
+00019d00: 756d 6e60 6020 616e 6420 6060 5f69 735f  umn`` and ``_is_
+00019d10: 6461 7465 7469 6d65 6060 2061 6e64 2060  datetime`` and `
+00019d20: 605f 6474 7970 6560 602e 0a20 2020 2020  `_dtype``..     
+00019d30: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00019d40: 2053 6574 7570 0a20 2020 2020 2020 2074   Setup.        t
+00019d50: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
+00019d60: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
+00019d70: 2020 2020 2020 2027 6167 655f 7768 656e         'age_when
+00019d80: 5f6a 6f69 6e65 6427 3a20 5b31 382c 2031  _joined': [18, 1
+00019d90: 392c 2032 305d 2c0a 2020 2020 2020 2020  9, 20],.        
+00019da0: 2020 2020 2763 7572 7265 6e74 5f61 6765      'current_age
+00019db0: 273a 205b 3231 2c20 3232 2c20 3235 5d2c  ': [21, 22, 25],
+00019dc0: 0a20 2020 2020 2020 2020 2020 2027 7265  .            're
+00019dd0: 7469 7265 6d65 6e74 5f61 6765 273a 205b  tirement_age': [
+00019de0: 3635 2c20 3638 2c20 3735 5d2c 0a20 2020  65, 68, 75],.   
+00019df0: 2020 2020 2020 2020 2027 6375 7272 656e           'curren
+00019e00: 745f 6167 6523 6167 655f 7768 656e 5f6a  t_age#age_when_j
+00019e10: 6f69 6e65 6423 7265 7469 7265 6d65 6e74  oined#retirement
+00019e20: 5f61 6765 273a 205b 312c 2032 2c20 335d  _age': [1, 2, 3]
+00019e30: 0a20 2020 2020 2020 207d 2c20 6474 7970  .        }, dtyp
+00019e40: 653d 6e70 2e69 6e74 3634 290a 2020 2020  e=np.int64).    
+00019e50: 2020 2020 696e 7374 616e 6365 203d 2052      instance = R
+00019e60: 616e 6765 2827 6167 655f 7768 656e 5f6a  ange('age_when_j
+00019e70: 6f69 6e65 6427 2c20 2763 7572 7265 6e74  oined', 'current
+00019e80: 5f61 6765 272c 2027 7265 7469 7265 6d65  _age', 'retireme
+00019e90: 6e74 5f61 6765 2729 0a0a 2020 2020 2020  nt_age')..      
+00019ea0: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
+00019eb0: 696e 7374 616e 6365 2e5f 6669 7428 7461  instance._fit(ta
+00019ec0: 626c 655f 6461 7461 290a 0a20 2020 2020  ble_data)..     
+00019ed0: 2020 2023 2041 7373 6572 740a 2020 2020     # Assert.    
+00019ee0: 2020 2020 6173 7365 7274 2069 6e73 7461      assert insta
+00019ef0: 6e63 652e 5f74 7261 6e73 666f 726d 6564  nce._transformed
+00019f00: 5f63 6f6c 756d 6e20 3d3d 2027 6375 7272  _column == 'curr
+00019f10: 656e 745f 6167 6523 2361 6765 5f77 6865  ent_age##age_whe
+00019f20: 6e5f 6a6f 696e 6564 2323 7265 7469 7265  n_joined##retire
+00019f30: 6d65 6e74 5f61 6765 270a 2020 2020 2020  ment_age'.      
+00019f40: 2020 6173 7365 7274 2069 6e73 7461 6e63    assert instanc
+00019f50: 652e 5f64 7479 7065 203d 3d20 6e70 2e69  e._dtype == np.i
+00019f60: 6e74 3634 0a20 2020 2020 2020 2061 7373  nt64.        ass
+00019f70: 6572 7420 6e6f 7420 696e 7374 616e 6365  ert not instance
+00019f80: 2e5f 6973 5f64 6174 6574 696d 650a 0a20  ._is_datetime.. 
+00019f90: 2020 2064 6566 2074 6573 745f 6973 5f76     def test_is_v
+00019fa0: 616c 6964 5f6c 7428 7365 6c66 293a 0a20  alid_lt(self):. 
+00019fb0: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
+00019fc0: 6865 2060 6052 616e 6765 2e69 735f 7661  he ``Range.is_va
+00019fd0: 6c69 6460 602e 0a0a 2020 2020 2020 2020  lid``...        
+00019fe0: 5468 6973 2074 6573 7420 656e 7375 7265  This test ensure
+00019ff0: 7320 7468 6174 2074 6865 2060 6069 735f  s that the ``is_
+0001a000: 7661 6c69 6460 6020 6d65 7468 6f64 2077  valid`` method w
+0001a010: 6f72 6b73 2077 6974 6820 7468 6520 6f70  orks with the op
+0001a020: 6572 6174 6f72 2060 603c 6060 0a20 2020  erator ``<``.   
+0001a030: 2020 2020 2028 6060 3c60 6029 2061 6e64       (``<``) and
+0001a040: 2076 616c 6964 6174 6573 2074 6861 7420   validates that 
+0001a050: 7468 6520 6060 6d69 6464 6c65 5f63 6f6c  the ``middle_col
+0001a060: 756d 6e5f 6e61 6d65 6060 2069 7320 6265  umn_name`` is be
+0001a070: 7477 6565 6e20 6060 6c6f 775f 636f 6c75  tween ``low_colu
+0001a080: 6d6e 5f6e 616d 6560 6020 616e 640a 2020  mn_name`` and.  
+0001a090: 2020 2020 2020 6060 6869 6768 5f63 6f6c        ``high_col
+0001a0a0: 756d 6e5f 6e61 6d65 6060 2e0a 0a20 2020  umn_name``...   
+0001a0b0: 2020 2020 2053 6574 7570 3a0a 2020 2020       Setup:.    
+0001a0c0: 2020 2020 2020 2020 2d20 4372 6561 7465          - Create
+0001a0d0: 2061 2070 642e 4461 7461 4672 616d 6520   a pd.DataFrame 
+0001a0e0: 7769 7468 2074 6872 6565 2063 6f6c 756d  with three colum
+0001a0f0: 6e73 2e0a 2020 2020 2020 2020 2020 2020  ns..            
+0001a100: 2d20 496e 7374 616e 6365 206f 6620 6060  - Instance of ``
+0001a110: 5261 6e67 6560 6020 636f 6e73 7472 6169  Range`` constrai
+0001a120: 6e74 2077 6974 6820 7468 6f73 6520 7468  nt with those th
+0001a130: 7265 6520 636f 6c75 6d6e 206e 616d 6573  ree column names
+0001a140: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
+0001a150: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+0001a160: 7064 2e44 6174 6146 7261 6d65 2077 6974  pd.DataFrame wit
+0001a170: 6820 6060 6167 655f 7768 656e 5f6a 6f69  h ``age_when_joi
+0001a180: 6e65 6460 602c 2060 6063 7572 7265 6e74  ned``, ``current
+0001a190: 5f61 6765 6060 2c20 6060 7265 7469 7265  _age``, ``retire
+0001a1a0: 6d65 6e74 5f61 6765 6060 2063 6f6c 756d  ment_age`` colum
+0001a1b0: 6e73 2e0a 2020 2020 2020 2020 2222 220a  ns..        """.
+0001a1c0: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
+0001a1d0: 2020 2020 2020 2020 7461 626c 655f 6461          table_da
+0001a1e0: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
+0001a1f0: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
+0001a200: 2761 6765 5f77 6865 6e5f 6a6f 696e 6564  'age_when_joined
+0001a210: 273a 205b 3138 2c20 3139 2c20 3230 5d2c  ': [18, 19, 20],
+0001a220: 0a20 2020 2020 2020 2020 2020 2027 6375  .            'cu
+0001a230: 7272 656e 745f 6167 6527 3a20 5b32 312c  rrent_age': [21,
+0001a240: 2032 322c 2032 355d 2c0a 2020 2020 2020   22, 25],.      
+0001a250: 2020 2020 2020 2772 6574 6972 656d 656e        'retiremen
+0001a260: 745f 6167 6527 3a20 5b36 352c 2036 382c  t_age': [65, 68,
+0001a270: 2037 355d 0a20 2020 2020 2020 207d 290a   75].        }).
+0001a280: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+0001a290: 203d 2052 616e 6765 2827 6167 655f 7768   = Range('age_wh
+0001a2a0: 656e 5f6a 6f69 6e65 6427 2c20 2763 7572  en_joined', 'cur
+0001a2b0: 7265 6e74 5f61 6765 272c 2027 7265 7469  rent_age', 'reti
+0001a2c0: 7265 6d65 6e74 5f61 6765 2729 0a0a 2020  rement_age')..  
+0001a2d0: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+0001a2e0: 2020 2020 7265 7375 6c74 203d 2069 6e73      result = ins
+0001a2f0: 7461 6e63 652e 6973 5f76 616c 6964 2874  tance.is_valid(t
+0001a300: 6162 6c65 5f64 6174 6129 0a0a 2020 2020  able_data)..    
+0001a310: 2020 2020 2320 4173 7365 7274 0a20 2020      # Assert.   
+0001a320: 2020 2020 2061 7373 6572 7420 616c 6c28       assert all(
+0001a330: 7265 7375 6c74 290a 0a20 2020 2064 6566  result)..    def
+0001a340: 2074 6573 745f 6973 5f76 616c 6964 5f6c   test_is_valid_l
+0001a350: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+0001a360: 2022 2222 5465 7374 2074 6865 2060 6052   """Test the ``R
+0001a370: 616e 6765 2e69 735f 7661 6c69 6460 602e  ange.is_valid``.
+0001a380: 0a0a 2020 2020 2020 2020 5468 6973 2074  ..        This t
+0001a390: 6573 7420 656e 7375 7265 7320 7468 6174  est ensures that
+0001a3a0: 2074 6865 2060 6069 735f 7661 6c69 6460   the ``is_valid`
+0001a3b0: 6020 6d65 7468 6f64 2077 6f72 6b73 2077  ` method works w
+0001a3c0: 6974 6820 7468 6520 6f70 6572 6174 6f72  ith the operator
+0001a3d0: 0a20 2020 2020 2020 2060 603c 3d60 6020  .        ``<=`` 
+0001a3e0: 616e 6420 7661 6c69 6461 7465 7320 7468  and validates th
+0001a3f0: 6174 2074 6865 2060 606d 6964 646c 655f  at the ``middle_
+0001a400: 636f 6c75 6d6e 5f6e 616d 6560 6020 6973  column_name`` is
+0001a410: 0a20 2020 2020 2020 2062 6574 7765 656e  .        between
+0001a420: 2060 606c 6f77 5f63 6f6c 756d 6e5f 6e61   ``low_column_na
+0001a430: 6d65 6060 2061 6e64 2060 6068 6967 685f  me`` and ``high_
+0001a440: 636f 6c75 6d6e 5f6e 616d 6560 602e 0a0a  column_name``...
+0001a450: 2020 2020 2020 2020 5365 7475 703a 0a20          Setup:. 
+0001a460: 2020 2020 2020 2020 2020 202d 2043 7265             - Cre
+0001a470: 6174 6520 6120 7064 2e44 6174 6146 7261  ate a pd.DataFra
+0001a480: 6d65 2077 6974 6820 7468 7265 6520 636f  me with three co
+0001a490: 6c75 6d6e 732e 0a20 2020 2020 2020 2020  lumns..         
+0001a4a0: 2020 202d 2049 6e73 7461 6e63 6520 6f66     - Instance of
+0001a4b0: 2060 6052 616e 6765 6060 2063 6f6e 7374   ``Range`` const
+0001a4c0: 7261 696e 7420 7769 7468 2074 686f 7365  raint with those
+0001a4d0: 2074 6872 6565 2063 6f6c 756d 6e20 6e61   three column na
+0001a4e0: 6d65 732e 0a0a 2020 2020 2020 2020 496e  mes...        In
+0001a4f0: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
+0001a500: 202d 2070 642e 4461 7461 4672 616d 6520   - pd.DataFrame 
+0001a510: 7769 7468 2060 6061 6765 5f77 6865 6e5f  with ``age_when_
+0001a520: 6a6f 696e 6564 6060 2c20 6060 6375 7272  joined``, ``curr
+0001a530: 656e 745f 6167 6560 602c 2060 6072 6574  ent_age``, ``ret
+0001a540: 6972 656d 656e 745f 6167 6560 6020 636f  irement_age`` co
+0001a550: 6c75 6d6e 732e 0a20 2020 2020 2020 2022  lumns..        "
+0001a560: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
+0001a570: 7570 0a20 2020 2020 2020 2074 6162 6c65  up.        table
+0001a580: 5f64 6174 6120 3d20 7064 2e44 6174 6146  _data = pd.DataF
+0001a590: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
+0001a5a0: 2020 2027 6167 655f 7768 656e 5f6a 6f69     'age_when_joi
+0001a5b0: 6e65 6427 3a20 5b32 312c 2031 392c 2032  ned': [21, 19, 2
+0001a5c0: 305d 2c0a 2020 2020 2020 2020 2020 2020  0],.            
+0001a5d0: 2763 7572 7265 6e74 5f61 6765 273a 205b  'current_age': [
+0001a5e0: 3231 2c20 3232 2c20 3235 5d2c 0a20 2020  21, 22, 25],.   
+0001a5f0: 2020 2020 2020 2020 2027 7265 7469 7265           'retire
+0001a600: 6d65 6e74 5f61 6765 273a 205b 3635 2c20  ment_age': [65, 
+0001a610: 3638 2c20 3735 5d0a 2020 2020 2020 2020  68, 75].        
+0001a620: 7d29 0a20 2020 2020 2020 2069 6e73 7461  }).        insta
+0001a630: 6e63 6520 3d20 5261 6e67 6528 0a20 2020  nce = Range(.   
+0001a640: 2020 2020 2020 2020 2027 6167 655f 7768           'age_wh
+0001a650: 656e 5f6a 6f69 6e65 6427 2c0a 2020 2020  en_joined',.    
+0001a660: 2020 2020 2020 2020 2763 7572 7265 6e74          'current
+0001a670: 5f61 6765 272c 0a20 2020 2020 2020 2020  _age',.         
+0001a680: 2020 2027 7265 7469 7265 6d65 6e74 5f61     'retirement_a
+0001a690: 6765 272c 0a20 2020 2020 2020 2020 2020  ge',.           
+0001a6a0: 2073 7472 6963 745f 626f 756e 6461 7269   strict_boundari
+0001a6b0: 6573 3d46 616c 7365 0a20 2020 2020 2020  es=False.       
+0001a6c0: 2029 0a0a 2020 2020 2020 2020 2320 5275   )..        # Ru
+0001a6d0: 6e0a 2020 2020 2020 2020 7265 7375 6c74  n.        result
+0001a6e0: 203d 2069 6e73 7461 6e63 652e 6973 5f76   = instance.is_v
+0001a6f0: 616c 6964 2874 6162 6c65 5f64 6174 6129  alid(table_data)
+0001a700: 0a0a 2020 2020 2020 2020 2320 4173 7365  ..        # Asse
+0001a710: 7274 0a20 2020 2020 2020 2061 7373 6572  rt.        asser
+0001a720: 7420 616c 6c28 7265 7375 6c74 290a 0a20  t all(result).. 
+0001a730: 2020 2064 6566 2074 6573 745f 6973 5f76     def test_is_v
+0001a740: 616c 6964 5f69 6e76 616c 6964 2873 656c  alid_invalid(sel
+0001a750: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+0001a760: 6573 7420 7468 6520 6060 5261 6e67 652e  est the ``Range.
+0001a770: 6973 5f76 616c 6964 6060 2e0a 0a20 2020  is_valid``...   
+0001a780: 2020 2020 2054 6869 7320 7465 7374 2065       This test e
+0001a790: 6e73 7572 6573 2074 6861 7420 7468 6520  nsures that the 
+0001a7a0: 6060 6973 5f76 616c 6964 6060 2066 6169  ``is_valid`` fai
+0001a7b0: 6c73 2077 6865 6e20 7468 6520 6461 7461  ls when the data
+0001a7c0: 2069 7320 6e6f 7420 696e 2074 6865 2072   is not in the r
+0001a7d0: 616e 6765 2e0a 0a20 2020 2020 2020 2053  ange...        S
+0001a7e0: 6574 7570 3a0a 2020 2020 2020 2020 2020  etup:.          
+0001a7f0: 2020 2d20 4372 6561 7465 2061 2070 642e    - Create a pd.
+0001a800: 4461 7461 4672 616d 6520 7769 7468 2074  DataFrame with t
+0001a810: 6872 6565 2063 6f6c 756d 6e73 2e0a 2020  hree columns..  
+0001a820: 2020 2020 2020 2020 2020 2d20 496e 7374            - Inst
+0001a830: 616e 6365 206f 6620 6060 5261 6e67 6560  ance of ``Range`
+0001a840: 6020 636f 6e73 7472 6169 6e74 2077 6974  ` constraint wit
+0001a850: 6820 7468 6f73 6520 7468 7265 6520 636f  h those three co
+0001a860: 6c75 6d6e 206e 616d 6573 2e0a 0a20 2020  lumn names...   
+0001a870: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
+0001a880: 2020 2020 2020 2020 2d20 7064 2e44 6174          - pd.Dat
+0001a890: 6146 7261 6d65 2077 6974 6820 6060 6167  aFrame with ``ag
+0001a8a0: 655f 7768 656e 5f6a 6f69 6e65 6460 602c  e_when_joined``,
+0001a8b0: 2060 6063 7572 7265 6e74 5f61 6765 6060   ``current_age``
+0001a8c0: 2c20 6060 7265 7469 7265 6d65 6e74 5f61  , ``retirement_a
+0001a8d0: 6765 6060 2063 6f6c 756d 6e73 2e0a 2020  ge`` columns..  
+0001a8e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001a8f0: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
+0001a900: 2020 7461 626c 655f 6461 7461 203d 2070    table_data = p
+0001a910: 642e 4461 7461 4672 616d 6528 7b0a 2020  d.DataFrame({.  
+0001a920: 2020 2020 2020 2020 2020 2761 6765 5f77            'age_w
+0001a930: 6865 6e5f 6a6f 696e 6564 273a 205b 3730  hen_joined': [70
+0001a940: 2c20 3139 2c20 3230 5d2c 0a20 2020 2020  , 19, 20],.     
+0001a950: 2020 2020 2020 2027 6375 7272 656e 745f         'current_
+0001a960: 6167 6527 3a20 5b32 312c 2032 322c 2032  age': [21, 22, 2
+0001a970: 355d 2c0a 2020 2020 2020 2020 2020 2020  5],.            
+0001a980: 2772 6574 6972 656d 656e 745f 6167 6527  'retirement_age'
+0001a990: 3a20 5b36 352c 2036 382c 2037 355d 0a20  : [65, 68, 75]. 
+0001a9a0: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
+0001a9b0: 2020 696e 7374 616e 6365 203d 2052 616e    instance = Ran
+0001a9c0: 6765 280a 2020 2020 2020 2020 2020 2020  ge(.            
+0001a9d0: 2761 6765 5f77 6865 6e5f 6a6f 696e 6564  'age_when_joined
+0001a9e0: 272c 0a20 2020 2020 2020 2020 2020 2027  ',.            '
+0001a9f0: 6375 7272 656e 745f 6167 6527 2c0a 2020  current_age',.  
+0001aa00: 2020 2020 2020 2020 2020 2772 6574 6972            'retir
+0001aa10: 656d 656e 745f 6167 6527 2c0a 2020 2020  ement_age',.    
+0001aa20: 2020 2020 2020 2020 7374 7269 6374 5f62          strict_b
+0001aa30: 6f75 6e64 6172 6965 733d 4661 6c73 650a  oundaries=False.
+0001aa40: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0001aa50: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
+0001aa60: 2072 6573 756c 7420 3d20 696e 7374 616e   result = instan
+0001aa70: 6365 2e69 735f 7661 6c69 6428 7461 626c  ce.is_valid(tabl
+0001aa80: 655f 6461 7461 290a 0a20 2020 2020 2020  e_data)..       
+0001aa90: 2023 2041 7373 6572 740a 2020 2020 2020   # Assert.      
+0001aaa0: 2020 6173 7365 7274 206e 6f74 2061 6c6c    assert not all
+0001aab0: 2872 6573 756c 7429 0a0a 2020 2020 4070  (result)..    @p
+0001aac0: 6174 6368 2827 7364 762e 636f 6e73 7472  atch('sdv.constr
+0001aad0: 6169 6e74 732e 7461 6275 6c61 722e 6c6f  aints.tabular.lo
+0001aae0: 6769 7427 290a 2020 2020 6465 6620 7465  git').    def te
+0001aaf0: 7374 5f5f 7472 616e 7366 6f72 6d28 7365  st__transform(se
+0001ab00: 6c66 2c20 6d6f 636b 5f6c 6f67 6974 293a  lf, mock_logit):
+0001ab10: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+0001ab20: 2074 6865 2060 6052 616e 6765 2e5f 7472   the ``Range._tr
+0001ab30: 616e 7366 6f72 6d60 6020 6d65 7468 6f64  ansform`` method
+0001ab40: 2e0a 0a20 2020 2020 2020 2049 7420 6973  ...        It is
+0001ab50: 2065 7870 6563 7465 6420 746f 2063 7265   expected to cre
+0001ab60: 6174 6520 6120 6e65 7720 636f 6c75 6d6e  ate a new column
+0001ab70: 2073 696d 696c 6172 2074 6f20 7468 6520   similar to the 
+0001ab80: 636f 6e73 7472 6169 6e74 2060 6063 6f6c  constraint ``col
+0001ab90: 756d 6e60 602c 2061 6e64 2074 6865 6e0a  umn``, and then.
+0001aba0: 2020 2020 2020 2020 7363 616c 6520 616e          scale an
+0001abb0: 6420 6170 706c 7920 6120 6c6f 6769 7420  d apply a logit 
+0001abc0: 6675 6e63 7469 6f6e 2074 6f20 7468 6174  function to that
+0001abd0: 2063 6f6c 756d 6e2e 0a0a 2020 2020 2020   column...      
+0001abe0: 2020 4d6f 636b 3a0a 2020 2020 2020 2020    Mock:.        
+0001abf0: 2020 2020 2d20 4d6f 636b 2074 6865 2060      - Mock the `
+0001ac00: 606c 6f67 6974 6060 2066 756e 6374 696f  `logit`` functio
+0001ac10: 6e2e 0a20 2020 2020 2020 2049 6e70 7574  n..        Input
+0001ac20: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+0001ac30: 7064 2e44 6174 6146 7261 6d65 2077 6974  pd.DataFrame wit
+0001ac40: 6820 6060 6167 655f 7768 656e 5f6a 6f69  h ``age_when_joi
+0001ac50: 6e65 6460 602c 2060 6063 7572 7265 6e74  ned``, ``current
+0001ac60: 5f61 6765 6060 2c20 6060 7265 7469 7265  _age``, ``retire
+0001ac70: 6d65 6e74 5f61 6765 6060 2063 6f6c 756d  ment_age`` colum
+0001ac80: 6e73 2e0a 0a20 2020 2020 2020 204f 7574  ns...        Out
+0001ac90: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
+0001aca0: 202d 2070 642e 4461 7461 4672 616d 6520   - pd.DataFrame 
+0001acb0: 7769 7468 2061 6e20 6578 7472 6120 636f  with an extra co
+0001acc0: 6c75 6d6e 2063 6f6e 7461 696e 696e 6720  lumn containing 
+0001acd0: 7468 6520 7472 616e 7366 6f72 6d65 6420  the transformed 
+0001ace0: 6060 636f 6c75 6d6e 6060 2e0a 2020 2020  ``column``..    
+0001acf0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001ad00: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
+0001ad10: 7461 626c 655f 6461 7461 203d 2070 642e  table_data = pd.
+0001ad20: 4461 7461 4672 616d 6528 7b0a 2020 2020  DataFrame({.    
+0001ad30: 2020 2020 2020 2020 2761 6765 5f77 6865          'age_whe
+0001ad40: 6e5f 6a6f 696e 6564 273a 205b 3138 2c20  n_joined': [18, 
+0001ad50: 3139 2c20 3230 5d2c 0a20 2020 2020 2020  19, 20],.       
+0001ad60: 2020 2020 2027 6375 7272 656e 745f 6167       'current_ag
+0001ad70: 6527 3a20 5b32 312c 2032 322c 2032 355d  e': [21, 22, 25]
+0001ad80: 2c0a 2020 2020 2020 2020 2020 2020 2772  ,.            'r
+0001ad90: 6574 6972 656d 656e 745f 6167 6527 3a20  etirement_age': 
+0001ada0: 5b36 352c 2036 382c 2037 355d 0a20 2020  [65, 68, 75].   
+0001adb0: 2020 2020 207d 290a 2020 2020 2020 2020       }).        
+0001adc0: 6d6f 636b 5f6c 6f67 6974 2e72 6574 7572  mock_logit.retur
+0001add0: 6e5f 7661 6c75 6520 3d20 5b31 2c20 322c  n_value = [1, 2,
+0001ade0: 2033 5d0a 2020 2020 2020 2020 696e 7374   3].        inst
+0001adf0: 616e 6365 203d 2052 616e 6765 2827 6167  ance = Range('ag
+0001ae00: 655f 7768 656e 5f6a 6f69 6e65 6427 2c20  e_when_joined', 
+0001ae10: 2763 7572 7265 6e74 5f61 6765 272c 2027  'current_age', '
+0001ae20: 7265 7469 7265 6d65 6e74 5f61 6765 2729  retirement_age')
+0001ae30: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
+0001ae40: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+0001ae50: 2e66 6974 2874 6162 6c65 5f64 6174 6129  .fit(table_data)
+0001ae60: 0a20 2020 2020 2020 206f 7574 203d 2069  .        out = i
+0001ae70: 6e73 7461 6e63 652e 5f74 7261 6e73 666f  nstance._transfo
+0001ae80: 726d 2874 6162 6c65 5f64 6174 6129 0a0a  rm(table_data)..
+0001ae90: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
+0001aea0: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+0001aeb0: 645f 6f75 7420 3d20 7064 2e44 6174 6146  d_out = pd.DataF
+0001aec0: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
+0001aed0: 2020 2027 6167 655f 7768 656e 5f6a 6f69     'age_when_joi
+0001aee0: 6e65 6427 3a20 5b31 382c 2031 392c 2032  ned': [18, 19, 2
+0001aef0: 305d 2c0a 2020 2020 2020 2020 2020 2020  0],.            
+0001af00: 2772 6574 6972 656d 656e 745f 6167 6527  'retirement_age'
+0001af10: 3a20 5b36 352c 2036 382c 2037 355d 2c0a  : [65, 68, 75],.
+0001af20: 2020 2020 2020 2020 2020 2020 2763 7572              'cur
+0001af30: 7265 6e74 5f61 6765 2361 6765 5f77 6865  rent_age#age_whe
+0001af40: 6e5f 6a6f 696e 6564 2372 6574 6972 656d  n_joined#retirem
+0001af50: 656e 745f 6167 6527 3a20 5b31 2c20 322c  ent_age': [1, 2,
+0001af60: 2033 5d0a 2020 2020 2020 2020 7d29 0a20   3].        }). 
+0001af70: 2020 2020 2020 206d 6f63 6b5f 6c6f 6769         mock_logi
+0001af80: 742e 6173 7365 7274 5f63 616c 6c65 645f  t.assert_called_
+0001af90: 6f6e 6365 2829 0a20 2020 2020 2020 2070  once().        p
+0001afa0: 642e 7465 7374 696e 672e 6173 7365 7274  d.testing.assert
+0001afb0: 5f66 7261 6d65 5f65 7175 616c 2865 7870  _frame_equal(exp
+0001afc0: 6563 7465 645f 6f75 742c 206f 7574 290a  ected_out, out).
+0001afd0: 0a20 2020 2040 7061 7463 6828 2773 6476  .    @patch('sdv
+0001afe0: 2e63 6f6e 7374 7261 696e 7473 2e74 6162  .constraints.tab
+0001aff0: 756c 6172 2e73 6967 6d6f 6964 2729 0a20  ular.sigmoid'). 
+0001b000: 2020 2064 6566 2074 6573 745f 7265 7665     def test_reve
+0001b010: 7273 655f 7472 616e 7366 6f72 6d28 7365  rse_transform(se
+0001b020: 6c66 2c20 6d6f 636b 5f73 6967 6d6f 6964  lf, mock_sigmoid
+0001b030: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+0001b040: 7374 2074 6865 2060 6072 6576 6572 7365  st the ``reverse
+0001b050: 5f74 7261 6e73 666f 726d 6060 206d 6574  _transform`` met
+0001b060: 686f 6420 666f 7220 6060 5261 6e67 6560  hod for ``Range`
+0001b070: 602e 0a0a 2020 2020 2020 2020 4974 2069  `...        It i
+0001b080: 7320 6578 7065 6374 6564 2074 6f20 7265  s expected to re
+0001b090: 636f 7665 7220 7468 6520 6f72 6967 696e  cover the origin
+0001b0a0: 616c 2074 6162 6c65 2077 6869 6368 2077  al table which w
+0001b0b0: 6173 2074 7261 6e73 666f 726d 6564 2c20  as transformed, 
+0001b0c0: 6275 7420 7769 7468 2064 6966 6665 7265  but with differe
+0001b0d0: 6e74 0a20 2020 2020 2020 2063 6f6c 756d  nt.        colum
+0001b0e0: 6e20 6f72 6465 722e 2049 7420 646f 6573  n order. It does
+0001b0f0: 2073 6f20 6279 2061 7070 6c79 696e 6720   so by applying 
+0001b100: 6120 7369 676d 6f69 6420 746f 2074 6865  a sigmoid to the
+0001b110: 2074 7261 6e73 666f 726d 6564 2063 6f6c   transformed col
+0001b120: 756d 6e20 616e 6420 7468 656e 0a20 2020  umn and then.   
+0001b130: 2020 2020 2073 6361 6c69 6e67 2069 7420       scaling it 
+0001b140: 6261 636b 2074 6f20 7468 6520 6f72 6967  back to the orig
+0001b150: 696e 616c 2073 7061 6365 2e20 4974 2061  inal space. It a
+0001b160: 6c73 6f20 7265 706c 6163 6573 2074 6865  lso replaces the
+0001b170: 2074 7261 6e73 666f 726d 6564 2063 6f6c   transformed col
+0001b180: 756d 6e20 7769 7468 0a20 2020 2020 2020  umn with.       
+0001b190: 2061 6e20 6571 7561 6c20 636f 6c75 6d6e   an equal column
+0001b1a0: 2062 7574 2077 6974 6820 7468 6520 6f72   but with the or
+0001b1b0: 6967 696e 616c 206e 616d 652e 0a0a 2020  iginal name...  
+0001b1c0: 2020 2020 2020 4d6f 636b 3a0a 2020 2020        Mock:.    
+0001b1d0: 2020 2020 2020 2020 2d20 4d6f 636b 2074          - Mock t
+0001b1e0: 6865 2073 6967 6f6d 6964 2066 756e 6374  he sigomid funct
+0001b1f0: 696f 6e2e 0a20 2020 2020 2020 2053 6574  ion..        Set
+0001b200: 7570 3a0a 2020 2020 2020 2020 2020 2020  up:.            
+0001b210: 2d20 4f72 6967 696e 616c 2074 6162 6c65  - Original table
+0001b220: 2064 6174 612e 0a20 2020 2020 2020 2020   data..         
+0001b230: 2020 202d 2041 6e20 6578 7065 6374 6564     - An expected
+0001b240: 2074 7261 6e73 666f 726d 6564 2064 6174   transformed dat
+0001b250: 6120 7769 7468 2074 6865 2065 7870 6563  a with the expec
+0001b260: 7465 6420 636f 6c75 6d6e 206e 616d 652e  ted column name.
+0001b270: 0a20 2020 2020 2020 2020 2020 202d 2049  .            - I
+0001b280: 6e73 7461 6e63 6520 6f66 2052 616e 6765  nstance of Range
+0001b290: 2063 6f6e 7374 7261 696e 742e 0a0a 2020   constraint...  
+0001b2a0: 2020 2020 2020 4f75 7470 7574 3a0a 2020        Output:.  
+0001b2b0: 2020 2020 2020 2020 2020 2d20 4120 7064            - A pd
+0001b2c0: 2e44 6174 6146 7261 6d65 2063 6f6e 7461  .DataFrame conta
+0001b2d0: 696e 696e 6720 7468 6520 6f72 6967 696e  ining the origin
+0001b2e0: 616c 2064 6174 612e 0a20 2020 2020 2020  al data..       
+0001b2f0: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
+0001b300: 6574 7570 0a20 2020 2020 2020 2074 6162  etup.        tab
+0001b310: 6c65 5f64 6174 6120 3d20 7064 2e44 6174  le_data = pd.Dat
+0001b320: 6146 7261 6d65 287b 0a20 2020 2020 2020  aFrame({.       
+0001b330: 2020 2020 2027 6167 655f 7768 656e 5f6a       'age_when_j
+0001b340: 6f69 6e65 6427 3a20 5b31 382c 2031 392c  oined': [18, 19,
+0001b350: 2032 305d 2c0a 2020 2020 2020 2020 2020   20],.          
+0001b360: 2020 2772 6574 6972 656d 656e 745f 6167    'retirement_ag
+0001b370: 6527 3a20 5b36 352c 2036 382c 2037 355d  e': [65, 68, 75]
+0001b380: 2c0a 2020 2020 2020 2020 2020 2020 2763  ,.            'c
+0001b390: 7572 7265 6e74 5f61 6765 273a 205b 3231  urrent_age': [21
+0001b3a0: 2c20 3232 2c20 3235 5d2c 0a20 2020 2020  , 22, 25],.     
+0001b3b0: 2020 207d 290a 2020 2020 2020 2020 6d6f     }).        mo
+0001b3c0: 636b 5f73 6967 6d6f 6964 2e72 6574 7572  ck_sigmoid.retur
+0001b3d0: 6e5f 7661 6c75 6520 3d20 7064 2e53 6572  n_value = pd.Ser
+0001b3e0: 6965 7328 5b32 312c 2032 322c 2032 355d  ies([21, 22, 25]
+0001b3f0: 290a 2020 2020 2020 2020 7472 616e 7366  ).        transf
+0001b400: 6f72 6d65 645f 6461 7461 203d 2070 642e  ormed_data = pd.
+0001b410: 4461 7461 4672 616d 6528 7b0a 2020 2020  DataFrame({.    
+0001b420: 2020 2020 2020 2020 2761 6765 5f77 6865          'age_whe
+0001b430: 6e5f 6a6f 696e 6564 273a 205b 3138 2c20  n_joined': [18, 
+0001b440: 3139 2c20 3230 5d2c 0a20 2020 2020 2020  19, 20],.       
+0001b450: 2020 2020 2027 7265 7469 7265 6d65 6e74       'retirement
+0001b460: 5f61 6765 273a 205b 3635 2c20 3638 2c20  _age': [65, 68, 
+0001b470: 3735 5d2c 0a20 2020 2020 2020 2020 2020  75],.           
+0001b480: 2027 6375 7272 656e 745f 6167 6523 6167   'current_age#ag
+0001b490: 655f 7768 656e 5f6a 6f69 6e65 6423 7265  e_when_joined#re
+0001b4a0: 7469 7265 6d65 6e74 5f61 6765 273a 205b  tirement_age': [
+0001b4b0: 312c 2032 2c20 335d 0a20 2020 2020 2020  1, 2, 3].       
+0001b4c0: 207d 290a 2020 2020 2020 2020 696e 7374   }).        inst
+0001b4d0: 616e 6365 203d 2052 616e 6765 2827 6167  ance = Range('ag
+0001b4e0: 655f 7768 656e 5f6a 6f69 6e65 6427 2c20  e_when_joined', 
+0001b4f0: 2763 7572 7265 6e74 5f61 6765 272c 2027  'current_age', '
+0001b500: 7265 7469 7265 6d65 6e74 5f61 6765 2729  retirement_age')
+0001b510: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
+0001b520: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+0001b530: 2e66 6974 2874 6162 6c65 5f64 6174 6129  .fit(table_data)
+0001b540: 0a20 2020 2020 2020 206f 7574 203d 2069  .        out = i
+0001b550: 6e73 7461 6e63 652e 7265 7665 7273 655f  nstance.reverse_
+0001b560: 7472 616e 7366 6f72 6d28 7472 616e 7366  transform(transf
+0001b570: 6f72 6d65 645f 6461 7461 290a 0a20 2020  ormed_data)..   
+0001b580: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
+0001b590: 2020 2020 2020 6d6f 636b 5f73 6967 6d6f        mock_sigmo
+0001b5a0: 6964 2e61 7373 6572 745f 6361 6c6c 6564  id.assert_called
+0001b5b0: 5f6f 6e63 6528 290a 2020 2020 2020 2020  _once().        
+0001b5c0: 7064 2e74 6573 7469 6e67 2e61 7373 6572  pd.testing.asser
+0001b5d0: 745f 6672 616d 655f 6571 7561 6c28 7461  t_frame_equal(ta
+0001b5e0: 626c 655f 6461 7461 2c20 6f75 7429 0a0a  ble_data, out)..
+0001b5f0: 2020 2020 4070 6174 6368 2827 7364 762e      @patch('sdv.
+0001b600: 636f 6e73 7472 6169 6e74 732e 7461 6275  constraints.tabu
+0001b610: 6c61 722e 7064 2729 0a20 2020 2040 7061  lar.pd').    @pa
+0001b620: 7463 6828 2773 6476 2e63 6f6e 7374 7261  tch('sdv.constra
+0001b630: 696e 7473 2e74 6162 756c 6172 2e73 6967  ints.tabular.sig
+0001b640: 6d6f 6964 2729 0a20 2020 2064 6566 2074  moid').    def t
+0001b650: 6573 745f 7265 7665 7273 655f 7472 616e  est_reverse_tran
+0001b660: 7366 6f72 6d5f 6973 5f64 6174 6574 696d  sform_is_datetim
+0001b670: 6528 7365 6c66 2c20 6d6f 636b 5f73 6967  e(self, mock_sig
+0001b680: 6d6f 6964 2c20 6d6f 636b 5f70 6429 3a0a  moid, mock_pd):.
+0001b690: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
+0001b6a0: 7468 6520 6060 7265 7665 7273 655f 7472  the ``reverse_tr
+0001b6b0: 616e 7366 6f72 6d60 6020 6d65 7468 6f64  ansform`` method
+0001b6c0: 2066 6f72 2060 6052 616e 6765 6060 2e0a   for ``Range``..
+0001b6d0: 0a20 2020 2020 2020 2057 6865 6e20 6060  .        When ``
+0001b6e0: 696e 7374 616e 6365 2e5f 6973 5f64 6174  instance._is_dat
+0001b6f0: 6574 696d 6560 6020 6973 2060 6054 7275  etime`` is ``Tru
+0001b700: 6560 602c 2074 6865 2064 6174 6120 7368  e``, the data sh
+0001b710: 6f75 6c64 2062 6520 636f 6e76 6572 7465  ould be converte
+0001b720: 640a 2020 2020 2020 2020 746f 2060 6070  d.        to ``p
+0001b730: 616e 6461 732e 746f 5f64 6174 6574 696d  andas.to_datetim
+0001b740: 6560 602e 0a0a 2020 2020 2020 2020 4d6f  e``...        Mo
+0001b750: 636b 3a0a 2020 2020 2020 2020 2020 2020  ck:.            
+0001b760: 2d20 4d6f 636b 2074 6865 2073 6967 6d6f  - Mock the sigmo
+0001b770: 6964 2066 756e 6374 696f 6e2e 0a20 2020  id function..   
+0001b780: 2020 2020 2020 2020 202d 204d 6f63 6b20           - Mock 
+0001b790: 7061 6e64 6173 2e0a 0a20 2020 2020 2020  pandas...       
+0001b7a0: 2053 6574 7570 3a0a 2020 2020 2020 2020   Setup:.        
+0001b7b0: 2020 2020 2d20 4f72 6967 696e 616c 2074      - Original t
+0001b7c0: 6162 6c65 2064 6174 612e 0a20 2020 2020  able data..     
+0001b7d0: 2020 2020 2020 202d 2041 6e20 6578 7065         - An expe
+0001b7e0: 6374 6564 2074 7261 6e73 666f 726d 6564  cted transformed
+0001b7f0: 2064 6174 612e 0a20 2020 2020 2020 2020   data..         
+0001b800: 2020 202d 2049 6e73 7461 6e63 6520 6f66     - Instance of
+0001b810: 2053 6361 6c61 7252 616e 6765 2063 6f6e   ScalarRange con
+0001b820: 7374 7261 696e 742e 0a0a 2020 2020 2020  straint...      
+0001b830: 2020 4f75 7470 7574 3a0a 2020 2020 2020    Output:.      
+0001b840: 2020 2020 2020 2d20 4120 7064 2e44 6174        - A pd.Dat
+0001b850: 6146 7261 6d65 2063 6f6e 7461 696e 696e  aFrame containin
+0001b860: 6720 7468 6520 6f72 6967 696e 616c 2064  g the original d
+0001b870: 6174 612e 0a0a 2020 2020 2020 2020 5369  ata...        Si
+0001b880: 6465 2045 6666 6563 7473 3a0a 2020 2020  de Effects:.    
+0001b890: 2020 2020 2020 2020 2d20 6060 6d6f 636b          - ``mock
+0001b8a0: 5f70 6460 6020 6861 7320 746f 2062 6520  _pd`` has to be 
+0001b8b0: 6361 6c6c 6564 206f 6e63 652e 0a20 2020  called once..   
+0001b8c0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001b8d0: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
+0001b8e0: 2074 6162 6c65 5f64 6174 6120 3d20 7064   table_data = pd
+0001b8f0: 2e44 6174 6146 7261 6d65 287b 0a20 2020  .DataFrame({.   
+0001b900: 2020 2020 2020 2020 2027 6167 655f 7768           'age_wh
+0001b910: 656e 5f6a 6f69 6e65 6427 3a20 5b31 382c  en_joined': [18,
+0001b920: 2031 392c 2032 305d 2c0a 2020 2020 2020   19, 20],.      
+0001b930: 2020 2020 2020 2772 6574 6972 656d 656e        'retiremen
+0001b940: 745f 6167 6527 3a20 5b36 352c 2036 382c  t_age': [65, 68,
+0001b950: 2037 355d 2c0a 2020 2020 2020 2020 2020   75],.          
+0001b960: 2020 2763 7572 7265 6e74 5f61 6765 273a    'current_age':
+0001b970: 205b 3231 2c20 3232 2c20 3235 5d2c 0a20   [21, 22, 25],. 
+0001b980: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
+0001b990: 2020 6d6f 636b 5f73 6967 6d6f 6964 2e72    mock_sigmoid.r
+0001b9a0: 6574 7572 6e5f 7661 6c75 6520 3d20 7064  eturn_value = pd
+0001b9b0: 2e53 6572 6965 7328 5b32 312c 2032 322c  .Series([21, 22,
+0001b9c0: 2032 355d 290a 2020 2020 2020 2020 7472   25]).        tr
+0001b9d0: 616e 7366 6f72 6d65 645f 6461 7461 203d  ansformed_data =
+0001b9e0: 2070 642e 4461 7461 4672 616d 6528 7b0a   pd.DataFrame({.
+0001b9f0: 2020 2020 2020 2020 2020 2020 2761 6765              'age
+0001ba00: 5f77 6865 6e5f 6a6f 696e 6564 273a 205b  _when_joined': [
+0001ba10: 3138 2c20 3139 2c20 3230 5d2c 0a20 2020  18, 19, 20],.   
+0001ba20: 2020 2020 2020 2020 2027 7265 7469 7265           'retire
+0001ba30: 6d65 6e74 5f61 6765 273a 205b 3635 2c20  ment_age': [65, 
+0001ba40: 3638 2c20 3735 5d2c 0a20 2020 2020 2020  68, 75],.       
+0001ba50: 2020 2020 2027 6375 7272 656e 745f 6167       'current_ag
+0001ba60: 6523 6167 655f 7768 656e 5f6a 6f69 6e65  e#age_when_joine
+0001ba70: 6423 7265 7469 7265 6d65 6e74 5f61 6765  d#retirement_age
+0001ba80: 273a 205b 312c 2032 2c20 335d 0a20 2020  ': [1, 2, 3].   
+0001ba90: 2020 2020 207d 290a 2020 2020 2020 2020       }).        
+0001baa0: 6d6f 636b 5f70 642e 746f 5f64 6174 6574  mock_pd.to_datet
+0001bab0: 696d 652e 7369 6465 5f65 6666 6563 7420  ime.side_effect 
+0001bac0: 3d20 6c61 6d62 6461 2078 3a20 780a 0a20  = lambda x: x.. 
+0001bad0: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
+0001bae0: 3d20 5261 6e67 6528 2761 6765 5f77 6865  = Range('age_whe
+0001baf0: 6e5f 6a6f 696e 6564 272c 2027 6375 7272  n_joined', 'curr
+0001bb00: 656e 745f 6167 6527 2c20 2772 6574 6972  ent_age', 'retir
+0001bb10: 656d 656e 745f 6167 6527 290a 2020 2020  ement_age').    
+0001bb20: 2020 2020 696e 7374 616e 6365 2e5f 7472      instance._tr
+0001bb30: 616e 7366 6f72 6d65 645f 636f 6c75 6d6e  ansformed_column
+0001bb40: 203d 2027 6375 7272 656e 745f 6167 6523   = 'current_age#
+0001bb50: 6167 655f 7768 656e 5f6a 6f69 6e65 6423  age_when_joined#
+0001bb60: 7265 7469 7265 6d65 6e74 5f61 6765 270a  retirement_age'.
+0001bb70: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+0001bb80: 2e5f 6973 5f64 6174 6574 696d 6520 3d20  ._is_datetime = 
+0001bb90: 5472 7565 0a0a 2020 2020 2020 2020 2320  True..        # 
+0001bba0: 5275 6e0a 2020 2020 2020 2020 6f75 7420  Run.        out 
+0001bbb0: 3d20 696e 7374 616e 6365 2e72 6576 6572  = instance.rever
+0001bbc0: 7365 5f74 7261 6e73 666f 726d 2874 7261  se_transform(tra
+0001bbd0: 6e73 666f 726d 6564 5f64 6174 6129 0a0a  nsformed_data)..
+0001bbe0: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
+0001bbf0: 0a20 2020 2020 2020 2070 642e 7465 7374  .        pd.test
+0001bc00: 696e 672e 6173 7365 7274 5f66 7261 6d65  ing.assert_frame
+0001bc10: 5f65 7175 616c 2874 6162 6c65 5f64 6174  _equal(table_dat
+0001bc20: 612c 206f 7574 290a 2020 2020 2020 2020  a, out).        
+0001bc30: 6d6f 636b 5f73 6967 6d6f 6964 2e61 7373  mock_sigmoid.ass
+0001bc40: 6572 745f 6361 6c6c 6564 5f6f 6e63 6528  ert_called_once(
+0001bc50: 290a 2020 2020 2020 2020 6d6f 636b 5f70  ).        mock_p
+0001bc60: 642e 746f 5f64 6174 6574 696d 652e 6173  d.to_datetime.as
+0001bc70: 7365 7274 5f63 616c 6c65 645f 6f6e 6365  sert_called_once
+0001bc80: 2829 0a0a 0a63 6c61 7373 2054 6573 7453  ()...class TestS
+0001bc90: 6361 6c61 7252 616e 6765 2829 3a0a 0a20  calarRange():.. 
+0001bca0: 2020 2064 6566 2074 6573 745f 5f76 616c     def test__val
+0001bcb0: 6964 6174 655f 696e 7075 7473 2873 656c  idate_inputs(sel
+0001bcc0: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+0001bcd0: 6573 7420 7468 6520 6060 5363 616c 6172  est the ``Scalar
+0001bce0: 5261 6e67 652e 5f76 616c 6964 6174 655f  Range._validate_
+0001bcf0: 696e 7075 7473 6060 206d 6574 686f 642e  inputs`` method.
+0001bd00: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
+0001bd10: 0a20 2020 2020 2020 202d 2020 496e 636f  .        -  Inco
+0001bd20: 7272 6563 7420 7061 7261 6d65 7465 7273  rrect parameters
+0001bd30: 2066 6f72 2074 6865 206d 6574 686f 640a   for the method.
+0001bd40: 2020 2020 2020 2020 5261 6973 6573 3a0a          Raises:.
+0001bd50: 2020 2020 2020 2020 2d20 4c69 7374 206f          - List o
+0001bd60: 6620 5661 6c75 6545 7272 6f72 730a 2020  f ValueErrors.  
+0001bd70: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001bd80: 2020 2320 5275 6e20 2f20 4173 7365 7274    # Run / Assert
+0001bd90: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+0001bda0: 7465 7374 2e72 6169 7365 7328 4167 6772  test.raises(Aggr
+0001bdb0: 6567 6174 6543 6f6e 7374 7261 696e 7473  egateConstraints
+0001bdc0: 4572 726f 7229 2061 7320 6572 726f 723a  Error) as error:
+0001bdd0: 0a20 2020 2020 2020 2020 2020 2053 6361  .            Sca
+0001bde0: 6c61 7252 616e 6765 2e5f 7661 6c69 6461  larRange._valida
+0001bdf0: 7465 5f69 6e70 7574 7328 6e6f 745f 6869  te_inputs(not_hi
+0001be00: 6768 5f63 6f6c 756d 6e3d 4e6f 6e65 2c20  gh_column=None, 
+0001be10: 6e6f 745f 6c6f 775f 636f 6c75 6d6e 3d4e  not_low_column=N
+0001be20: 6f6e 6529 0a0a 2020 2020 2020 2020 6572  one)..        er
+0001be30: 725f 6d73 6720 3d20 280a 2020 2020 2020  r_msg = (.      
+0001be40: 2020 2020 2020 7227 4d69 7373 696e 6720        r'Missing 
+0001be50: 7265 7175 6972 6564 2076 616c 7565 7320  required values 
+0001be60: 7b28 2e2a 297d 2069 6e20 6120 5363 616c  {(.*)} in a Scal
+0001be70: 6172 5261 6e67 6520 636f 6e73 7472 6169  arRange constrai
+0001be80: 6e74 2e27 0a20 2020 2020 2020 2020 2020  nt.'.           
+0001be90: 2072 275c 6e5c 6e49 6e76 616c 6964 2076   r'\n\nInvalid v
+0001bea0: 616c 7565 7320 7b28 2e2a 297d 2061 7265  alues {(.*)} are
+0001beb0: 2070 7265 7365 6e74 2069 6e20 6120 5363   present in a Sc
+0001bec0: 616c 6172 5261 6e67 6520 636f 6e73 7472  alarRange constr
+0001bed0: 6169 6e74 2e27 0a20 2020 2020 2020 2029  aint.'.        )
+0001bee0: 0a20 2020 2020 2020 2067 726f 7570 7320  .        groups 
+0001bef0: 3d20 7265 2e73 6561 7263 6828 6572 725f  = re.search(err_
+0001bf00: 6d73 672c 2073 7472 2865 7272 6f72 2e76  msg, str(error.v
+0001bf10: 616c 7565 2929 0a20 2020 2020 2020 2061  alue)).        a
+0001bf20: 7373 6572 7420 6772 6f75 7073 2069 7320  ssert groups is 
+0001bf30: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
+0001bf40: 2061 7373 6572 7420 7365 7428 6576 616c   assert set(eval
+0001bf50: 2867 726f 7570 732e 6772 6f75 7028 3129  (groups.group(1)
+0001bf60: 2929 203d 3d20 7b27 6c6f 775f 7661 6c75  )) == {'low_valu
+0001bf70: 6527 2c20 2768 6967 685f 7661 6c75 6527  e', 'high_value'
+0001bf80: 2c20 2763 6f6c 756d 6e5f 6e61 6d65 277d  , 'column_name'}
+0001bf90: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001bfa0: 7365 7428 6576 616c 2867 726f 7570 732e  set(eval(groups.
+0001bfb0: 6772 6f75 7028 3229 2929 203d 3d20 7b27  group(2))) == {'
+0001bfc0: 6e6f 745f 6869 6768 5f63 6f6c 756d 6e27  not_high_column'
+0001bfd0: 2c20 276e 6f74 5f6c 6f77 5f63 6f6c 756d  , 'not_low_colum
+0001bfe0: 6e27 7d0a 0a20 2020 2064 6566 2074 6573  n'}..    def tes
+0001bff0: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
+0001c000: 6461 7461 5f63 6f6c 756d 6e73 2873 656c  data_columns(sel
+0001c010: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+0001c020: 6573 7420 7468 6520 6060 5f76 616c 6964  est the ``_valid
+0001c030: 6174 655f 6d65 7461 6461 7461 5f63 6f6c  ate_metadata_col
+0001c040: 756d 6e73 6060 206d 6574 686f 642e 0a0a  umns`` method...
+0001c050: 2020 2020 2020 2020 5468 6520 636f 6c75          The colu
+0001c060: 6d6e 2070 6173 7365 6420 696e 2063 6f6c  mn passed in col
+0001c070: 756d 6e5f 6e61 6d65 2073 686f 756c 6420  umn_name should 
+0001c080: 6265 2069 6e20 7468 6520 6d65 7461 6461  be in the metada
+0001c090: 7461 2e0a 0a20 2020 2020 2020 2049 6e70  ta...        Inp
+0001c0a0: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
+0001c0b0: 2d20 636f 6c75 6d6e 5f6e 616d 6520 7468  - column_name th
+0001c0c0: 6174 2069 7320 696e 2074 6865 206d 6574  at is in the met
+0001c0d0: 6164 6174 612e 0a0a 2020 2020 2020 2020  adata...        
+0001c0e0: 5369 6465 2065 6666 6563 743a 0a20 2020  Side effect:.   
+0001c0f0: 2020 2020 2020 2020 202d 204e 6f20 6572           - No er
+0001c100: 726f 7220 7368 6f75 6c64 2062 6520 7261  ror should be ra
+0001c110: 6973 6564 2e0a 2020 2020 2020 2020 2222  ised..        ""
+0001c120: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
+0001c130: 700a 2020 2020 2020 2020 6d65 7461 6461  p.        metada
+0001c140: 7461 203d 204d 6f63 6b28 290a 2020 2020  ta = Mock().    
+0001c150: 2020 2020 6d65 7461 6461 7461 2e63 6f6c      metadata.col
+0001c160: 756d 6e73 203d 207b 2761 273a 2031 2c20  umns = {'a': 1, 
+0001c170: 2762 273a 2032 7d0a 0a20 2020 2020 2020  'b': 2}..       
+0001c180: 2023 2052 756e 0a20 2020 2020 2020 2053   # Run.        S
+0001c190: 6361 6c61 7252 616e 6765 2e5f 7661 6c69  calarRange._vali
+0001c1a0: 6461 7465 5f6d 6574 6164 6174 615f 636f  date_metadata_co
+0001c1b0: 6c75 6d6e 7328 6d65 7461 6461 7461 2c20  lumns(metadata, 
+0001c1c0: 636f 6c75 6d6e 5f6e 616d 653d 2761 2729  column_name='a')
+0001c1d0: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
+0001c1e0: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
+0001c1f0: 615f 636f 6c75 6d6e 735f 7261 6973 6573  a_columns_raises
+0001c200: 5f65 7272 6f72 2873 656c 6629 3a0a 2020  _error(self):.  
+0001c210: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
+0001c220: 6520 6060 5f76 616c 6964 6174 655f 6d65  e ``_validate_me
+0001c230: 7461 6461 7461 5f63 6f6c 756d 6e73 6060  tadata_columns``
+0001c240: 206d 6574 686f 6427 7320 6572 726f 7220   method's error 
+0001c250: 636f 6e64 6974 696f 6e2e 0a0a 2020 2020  condition...    
+0001c260: 2020 2020 4966 2063 6f6c 756d 6e5f 6e61      If column_na
+0001c270: 6d65 2069 7320 6e6f 7420 696e 2074 6865  me is not in the
+0001c280: 206d 6574 6164 6174 612c 2061 6e20 6572   metadata, an er
+0001c290: 726f 7220 7368 6f75 6c64 2062 6520 7261  ror should be ra
+0001c2a0: 6973 6564 2e0a 0a20 2020 2020 2020 2049  ised...        I
+0001c2b0: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
+0001c2c0: 2020 2d20 636f 6c75 6d6e 5f6e 616d 6520    - column_name 
+0001c2d0: 7468 6174 2069 7320 6e6f 7420 696e 2074  that is not in t
+0001c2e0: 6865 206d 6574 6164 6174 612e 0a0a 2020  he metadata...  
+0001c2f0: 2020 2020 2020 5369 6465 2065 6666 6563        Side effec
+0001c300: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
+0001c310: 2043 6f6e 7374 7261 696e 744d 6574 6164   ConstraintMetad
+0001c320: 6174 6145 7272 6f72 2073 686f 756c 6420  ataError should 
+0001c330: 6265 2072 6169 7365 642e 0a20 2020 2020  be raised..     
+0001c340: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+0001c350: 2053 6574 7570 0a20 2020 2020 2020 206d   Setup.        m
+0001c360: 6574 6164 6174 6120 3d20 4d6f 636b 2829  etadata = Mock()
+0001c370: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+0001c380: 612e 636f 6c75 6d6e 7320 3d20 7b27 6127  a.columns = {'a'
+0001c390: 3a20 312c 2027 6227 3a20 327d 0a0a 2020  : 1, 'b': 2}..  
+0001c3a0: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+0001c3b0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+0001c3c0: 6520 3d20 7265 2e65 7363 6170 6528 0a20  e = re.escape(. 
+0001c3d0: 2020 2020 2020 2020 2020 2027 4120 5363             'A Sc
+0001c3e0: 616c 6172 5261 6e67 6520 636f 6e73 7472  alarRange constr
+0001c3f0: 6169 6e74 2069 7320 6265 696e 6720 6170  aint is being ap
+0001c400: 706c 6965 6420 746f 2069 6e76 616c 6964  plied to invalid
+0001c410: 2063 6f6c 756d 6e20 6e61 6d65 7320 270a   column names '.
+0001c420: 2020 2020 2020 2020 2020 2020 227b 2763              "{'c
+0001c430: 277d 2e20 5468 6520 636f 6c75 6d6e 7320  '}. The columns 
+0001c440: 6d75 7374 2065 7869 7374 2069 6e20 7468  must exist in th
+0001c450: 6520 7461 626c 652e 220a 2020 2020 2020  e table.".      
+0001c460: 2020 290a 2020 2020 2020 2020 7769 7468    ).        with
+0001c470: 2070 7974 6573 742e 7261 6973 6573 2843   pytest.raises(C
+0001c480: 6f6e 7374 7261 696e 744d 6574 6164 6174  onstraintMetadat
+0001c490: 6145 7272 6f72 2c20 6d61 7463 683d 6572  aError, match=er
+0001c4a0: 726f 725f 6d65 7373 6167 6529 3a0a 2020  ror_message):.  
+0001c4b0: 2020 2020 2020 2020 2020 5363 616c 6172            Scalar
+0001c4c0: 5261 6e67 652e 5f76 616c 6964 6174 655f  Range._validate_
+0001c4d0: 6d65 7461 6461 7461 5f63 6f6c 756d 6e73  metadata_columns
+0001c4e0: 286d 6574 6164 6174 612c 2063 6f6c 756d  (metadata, colum
+0001c4f0: 6e5f 6e61 6d65 3d27 6327 290a 0a20 2020  n_name='c')..   
+0001c500: 2064 6566 2074 6573 745f 5f76 616c 6964   def test__valid
+0001c510: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
+0001c520: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
+0001c530: 696e 745f 6e75 6d65 7269 6361 6c28 7365  int_numerical(se
+0001c540: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0001c550: 5465 7374 2074 6865 2060 605f 7661 6c69  Test the ``_vali
+0001c560: 6461 7465 5f6d 6574 6164 6174 615f 7370  date_metadata_sp
+0001c570: 6563 6966 6963 5f74 6f5f 636f 6e73 7472  ecific_to_constr
+0001c580: 6169 6e74 6060 206d 6574 686f 642e 0a0a  aint`` method...
+0001c590: 2020 2020 2020 2020 4966 2074 6865 2063          If the c
+0001c5a0: 6f6c 756d 6e5f 6e61 6d65 2068 6173 2061  olumn_name has a
+0001c5b0: 6e20 7364 7479 7065 206f 6620 6e75 6d65  n sdtype of nume
+0001c5c0: 7269 6361 6c2c 2061 6e64 2074 6865 2068  rical, and the h
+0001c5d0: 6967 685f 7661 6c75 650a 2020 2020 2020  igh_value.      
+0001c5e0: 2020 616e 6420 6c6f 775f 7661 6c75 6520    and low_value 
+0001c5f0: 6172 6520 696e 7473 206f 7220 666c 6f61  are ints or floa
+0001c600: 7473 2c20 7468 656e 206e 6f20 6572 726f  ts, then no erro
+0001c610: 7220 7368 6f75 6c64 2062 6520 7261 6973  r should be rais
+0001c620: 6564 2e0a 0a20 2020 2020 2020 2053 6574  ed...        Set
+0001c630: 7570 3a0a 2020 2020 2020 2020 2020 2020  up:.            
+0001c640: 2d20 4d65 7461 6461 7461 2077 6974 6820  - Metadata with 
+0001c650: 7468 6520 7364 7479 7065 2073 6574 2074  the sdtype set t
+0001c660: 6f20 6e75 6d65 7269 6361 6c2e 0a0a 2020  o numerical...  
+0001c670: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
+0001c680: 2020 2020 2020 2020 202d 2054 6865 2063           - The c
+0001c690: 6f6c 756d 6e20 6e61 6d65 2061 6e64 2062  olumn name and b
+0001c6a0: 6f74 6820 6869 6768 5f76 616c 7565 2061  oth high_value a
+0001c6b0: 6e64 206c 6f77 5f76 616c 7565 2073 6574  nd low_value set
+0001c6c0: 2074 6f20 6120 6e75 6d62 6572 2e0a 2020   to a number..  
+0001c6d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001c6e0: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
+0001c6f0: 2020 6d65 7461 6461 7461 203d 204d 6f63    metadata = Moc
+0001c700: 6b28 290a 2020 2020 2020 2020 6d65 7461  k().        meta
+0001c710: 6461 7461 2e63 6f6c 756d 6e73 203d 207b  data.columns = {
+0001c720: 2761 273a 207b 2773 6474 7970 6527 3a20  'a': {'sdtype': 
+0001c730: 276e 756d 6572 6963 616c 277d 7d0a 0a20  'numerical'}}.. 
+0001c740: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
+0001c750: 2020 2020 2053 6361 6c61 7252 616e 6765       ScalarRange
+0001c760: 2e5f 7661 6c69 6461 7465 5f6d 6574 6164  ._validate_metad
+0001c770: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
+0001c780: 636f 6e73 7472 6169 6e74 280a 2020 2020  constraint(.    
+0001c790: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+0001c7a0: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
+0001c7b0: 6c75 6d6e 5f6e 616d 653d 2761 272c 0a20  lumn_name='a',. 
+0001c7c0: 2020 2020 2020 2020 2020 2068 6967 685f             high_
+0001c7d0: 7661 6c75 653d 3130 2c0a 2020 2020 2020  value=10,.      
+0001c7e0: 2020 2020 2020 6c6f 775f 7661 6c75 653d        low_value=
+0001c7f0: 350a 2020 2020 2020 2020 290a 0a20 2020  5.        )..   
+0001c800: 2064 6566 2074 6573 745f 5f76 616c 6964   def test__valid
+0001c810: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
+0001c820: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
+0001c830: 696e 745f 6e75 6d65 7269 6361 6c5f 6869  int_numerical_hi
+0001c840: 6768 5f6e 6f74 5f6e 756d 6572 6963 616c  gh_not_numerical
+0001c850: 5f65 7272 6f72 2873 656c 6629 3a0a 2020  _error(self):.  
+0001c860: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
+0001c870: 6520 6060 5f76 616c 6964 6174 655f 6d65  e ``_validate_me
+0001c880: 7461 6461 7461 5f73 7065 6369 6669 635f  tadata_specific_
+0001c890: 746f 5f63 6f6e 7374 7261 696e 7460 6020  to_constraint`` 
+0001c8a0: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
+0001c8b0: 2049 6620 7468 6520 636f 6c75 6d6e 5f6e   If the column_n
+0001c8c0: 616d 6520 6861 7320 616e 2073 6474 7970  ame has an sdtyp
+0001c8d0: 6520 6f66 206e 756d 6572 6963 616c 2c20  e of numerical, 
+0001c8e0: 616e 6420 7468 6520 6869 6768 5f76 616c  and the high_val
+0001c8f0: 7565 0a20 2020 2020 2020 2069 7320 6e6f  ue.        is no
+0001c900: 7420 616e 2069 6e74 206f 7220 666c 6f61  t an int or floa
+0001c910: 742c 2074 6865 6e20 616e 2065 7272 6f72  t, then an error
+0001c920: 2073 686f 756c 6420 6265 2072 6169 7365   should be raise
+0001c930: 642e 0a0a 2020 2020 2020 2020 5365 7475  d...        Setu
+0001c940: 703a 0a20 2020 2020 2020 2020 2020 202d  p:.            -
+0001c950: 204d 6574 6164 6174 6120 7769 7468 2074   Metadata with t
+0001c960: 6865 2073 6474 7970 6520 7365 7420 746f  he sdtype set to
+0001c970: 206e 756d 6572 6963 616c 2e0a 0a20 2020   numerical...   
+0001c980: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
+0001c990: 2020 2020 2020 2020 2d20 5468 6520 636f          - The co
+0001c9a0: 6c75 6d6e 206e 616d 652c 206c 6f77 5f76  lumn name, low_v
+0001c9b0: 616c 7565 2073 6574 2074 6f20 6120 6e75  alue set to a nu
+0001c9c0: 6d62 6572 2061 6e64 2068 6967 685f 7661  mber and high_va
+0001c9d0: 6c75 6520 7365 7420 746f 2061 2073 7472  lue set to a str
+0001c9e0: 696e 672e 0a20 2020 2020 2020 2022 2222  ing..        """
+0001c9f0: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+0001ca00: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+0001ca10: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
+0001ca20: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
+0001ca30: 6d6e 7320 3d20 7b27 6127 3a20 7b27 7364  mns = {'a': {'sd
+0001ca40: 7479 7065 273a 2027 6e75 6d65 7269 6361  type': 'numerica
+0001ca50: 6c27 7d7d 0a0a 2020 2020 2020 2020 2320  l'}}..        # 
+0001ca60: 5275 6e0a 2020 2020 2020 2020 6572 726f  Run.        erro
+0001ca70: 725f 6d65 7373 6167 6520 3d20 2242 6f74  r_message = "Bot
+0001ca80: 6820 2768 6967 685f 7661 6c75 6527 2061  h 'high_value' a
+0001ca90: 6e64 2027 6c6f 775f 7661 6c75 6527 206d  nd 'low_value' m
+0001caa0: 7573 7420 6265 2069 6e74 7320 6f72 2066  ust be ints or f
+0001cab0: 6c6f 6174 7322 0a20 2020 2020 2020 2077  loats".        w
+0001cac0: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+0001cad0: 7328 436f 6e73 7472 6169 6e74 4d65 7461  s(ConstraintMeta
+0001cae0: 6461 7461 4572 726f 722c 206d 6174 6368  dataError, match
+0001caf0: 3d65 7272 6f72 5f6d 6573 7361 6765 293a  =error_message):
+0001cb00: 0a20 2020 2020 2020 2020 2020 2053 6361  .            Sca
+0001cb10: 6c61 7252 616e 6765 2e5f 7661 6c69 6461  larRange._valida
+0001cb20: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
+0001cb30: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
+0001cb40: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
+0001cb50: 2020 2020 6d65 7461 6461 7461 2c0a 2020      metadata,.  
+0001cb60: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0001cb70: 6c75 6d6e 5f6e 616d 653d 2761 272c 0a20  lumn_name='a',. 
+0001cb80: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0001cb90: 6f77 5f76 616c 7565 3d35 2c0a 2020 2020  ow_value=5,.    
+0001cba0: 2020 2020 2020 2020 2020 2020 6869 6768              high
+0001cbb0: 5f76 616c 7565 3d27 3130 270a 2020 2020  _value='10'.    
+0001cbc0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+0001cbd0: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
+0001cbe0: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+0001cbf0: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+0001cc00: 745f 6e75 6d65 7269 6361 6c5f 6c6f 775f  t_numerical_low_
+0001cc10: 6e6f 745f 6e75 6d65 7269 6361 6c5f 6572  not_numerical_er
+0001cc20: 726f 7228 7365 6c66 293a 0a20 2020 2020  ror(self):.     
+0001cc30: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
+0001cc40: 605f 7661 6c69 6461 7465 5f6d 6574 6164  `_validate_metad
+0001cc50: 6174 615f 7370 6563 6966 6963 5f74 6f5f  ata_specific_to_
+0001cc60: 636f 6e73 7472 6169 6e74 6060 206d 6574  constraint`` met
+0001cc70: 686f 642e 0a0a 2020 2020 2020 2020 4966  hod...        If
+0001cc80: 2074 6865 2063 6f6c 756d 6e5f 6e61 6d65   the column_name
+0001cc90: 2068 6173 2061 6e20 7364 7479 7065 206f   has an sdtype o
+0001cca0: 6620 6e75 6d65 7269 6361 6c2c 2061 6e64  f numerical, and
+0001ccb0: 2074 6865 206c 6f77 5f76 616c 7565 0a20   the low_value. 
+0001ccc0: 2020 2020 2020 2069 7320 6e6f 7420 616e         is not an
+0001ccd0: 2069 6e74 206f 7220 666c 6f61 742c 2074   int or float, t
+0001cce0: 6865 6e20 616e 2065 7272 6f72 2073 686f  hen an error sho
+0001ccf0: 756c 6420 6265 2072 6169 7365 642e 0a0a  uld be raised...
+0001cd00: 2020 2020 2020 2020 5365 7475 703a 0a20          Setup:. 
+0001cd10: 2020 2020 2020 2020 2020 202d 204d 6574             - Met
+0001cd20: 6164 6174 6120 7769 7468 2074 6865 2073  adata with the s
+0001cd30: 6474 7970 6520 7365 7420 746f 206e 756d  dtype set to num
+0001cd40: 6572 6963 616c 2e0a 0a20 2020 2020 2020  erical...       
+0001cd50: 2049 6e70 7574 3a0a 2020 2020 2020 2020   Input:.        
+0001cd60: 2020 2020 2d20 5468 6520 636f 6c75 6d6e      - The column
+0001cd70: 206e 616d 652c 2068 6967 685f 7661 6c75   name, high_valu
+0001cd80: 6520 7365 7420 746f 2061 206e 756d 6265  e set to a numbe
+0001cd90: 7220 616e 6420 6c6f 775f 7661 6c75 6520  r and low_value 
+0001cda0: 7365 7420 746f 2061 2073 7472 696e 672e  set to a string.
+0001cdb0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001cdc0: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
+0001cdd0: 2020 2020 206d 6574 6164 6174 6120 3d20       metadata = 
+0001cde0: 4d6f 636b 2829 0a20 2020 2020 2020 206d  Mock().        m
+0001cdf0: 6574 6164 6174 612e 636f 6c75 6d6e 7320  etadata.columns 
+0001ce00: 3d20 7b27 6127 3a20 7b27 7364 7479 7065  = {'a': {'sdtype
+0001ce10: 273a 2027 6e75 6d65 7269 6361 6c27 7d7d  ': 'numerical'}}
+0001ce20: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
+0001ce30: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+0001ce40: 7373 6167 6520 3d20 2242 6f74 6820 2768  ssage = "Both 'h
+0001ce50: 6967 685f 7661 6c75 6527 2061 6e64 2027  igh_value' and '
+0001ce60: 6c6f 775f 7661 6c75 6527 206d 7573 7420  low_value' must 
+0001ce70: 6265 2069 6e74 7320 6f72 2066 6c6f 6174  be ints or float
+0001ce80: 7322 0a20 2020 2020 2020 2077 6974 6820  s".        with 
+0001ce90: 7079 7465 7374 2e72 6169 7365 7328 436f  pytest.raises(Co
+0001cea0: 6e73 7472 6169 6e74 4d65 7461 6461 7461  nstraintMetadata
+0001ceb0: 4572 726f 722c 206d 6174 6368 3d65 7272  Error, match=err
+0001cec0: 6f72 5f6d 6573 7361 6765 293a 0a20 2020  or_message):.   
+0001ced0: 2020 2020 2020 2020 2053 6361 6c61 7252           ScalarR
+0001cee0: 616e 6765 2e5f 7661 6c69 6461 7465 5f6d  ange._validate_m
+0001cef0: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
+0001cf00: 5f74 6f5f 636f 6e73 7472 6169 6e74 280a  _to_constraint(.
+0001cf10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cf20: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
+0001cf30: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+0001cf40: 5f6e 616d 653d 2761 272c 0a20 2020 2020  _name='a',.     
+0001cf50: 2020 2020 2020 2020 2020 206c 6f77 5f76             low_v
+0001cf60: 616c 7565 3d27 3527 2c0a 2020 2020 2020  alue='5',.      
+0001cf70: 2020 2020 2020 2020 2020 6869 6768 5f76            high_v
+0001cf80: 616c 7565 3d31 300a 2020 2020 2020 2020  alue=10.        
+0001cf90: 2020 2020 290a 0a20 2020 2040 7061 7463      )..    @patc
+0001cfa0: 6828 2773 6476 2e63 6f6e 7374 7261 696e  h('sdv.constrain
+0001cfb0: 7473 2e74 6162 756c 6172 2e6d 6174 6368  ts.tabular.match
+0001cfc0: 6573 5f64 6174 6574 696d 655f 666f 726d  es_datetime_form
+0001cfd0: 6174 2729 0a20 2020 2064 6566 2074 6573  at').    def tes
+0001cfe0: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
+0001cff0: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
+0001d000: 5f63 6f6e 7374 7261 696e 745f 6461 7465  _constraint_date
+0001d010: 7469 6d65 2873 656c 662c 2064 6174 6574  time(self, datet
+0001d020: 696d 655f 666f 726d 6174 5f6d 6f63 6b29  ime_format_mock)
+0001d030: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
+0001d040: 7420 7468 6520 6060 5f76 616c 6964 6174  t the ``_validat
+0001d050: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+0001d060: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+0001d070: 7460 6020 6d65 7468 6f64 2e0a 0a20 2020  t`` method...   
+0001d080: 2020 2020 2049 6620 7468 6520 636f 6c75       If the colu
+0001d090: 6d6e 5f6e 616d 6520 6861 7320 616e 2073  mn_name has an s
+0001d0a0: 6474 7970 6520 6f66 2064 6174 6574 696d  dtype of datetim
+0001d0b0: 652c 2061 6e64 2062 6f74 6820 7468 6520  e, and both the 
+0001d0c0: 6869 6768 5f76 616c 7565 2061 6e64 206c  high_value and l
+0001d0d0: 6f77 5f76 616c 7565 0a20 2020 2020 2020  ow_value.       
+0001d0e0: 2061 7265 2064 6174 6574 696d 6520 7374   are datetime st
+0001d0f0: 7269 6e67 7320 7468 6174 206d 6174 6368  rings that match
+0001d100: 2074 6865 2066 6f72 6d61 742c 2074 6865   the format, the
+0001d110: 6e20 6e6f 2065 7272 6f72 2073 686f 756c  n no error shoul
+0001d120: 6420 6265 2072 6169 7365 642e 0a0a 2020  d be raised...  
+0001d130: 2020 2020 2020 5365 7475 703a 0a20 2020        Setup:.   
+0001d140: 2020 2020 2020 2020 202d 204d 6574 6164           - Metad
+0001d150: 6174 6120 7769 7468 2074 6865 2073 6474  ata with the sdt
+0001d160: 7970 6520 7365 7420 746f 2064 6174 6574  ype set to datet
+0001d170: 696d 6520 616e 6420 6120 6461 7465 7469  ime and a dateti
+0001d180: 6d65 5f66 6f72 6d61 742e 0a20 2020 2020  me_format..     
+0001d190: 2020 2020 2020 202d 204d 6f63 6b20 7468         - Mock th
+0001d1a0: 6520 6060 6d61 7463 6865 735f 6461 7465  e ``matches_date
+0001d1b0: 7469 6d65 5f66 6f72 6d61 7460 6020 6675  time_format`` fu
+0001d1c0: 6e63 7469 6f6e 2074 6f20 7265 7475 726e  nction to return
+0001d1d0: 2054 7275 652e 0a0a 2020 2020 2020 2020   True...        
+0001d1e0: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
+0001d1f0: 2020 202d 2054 6865 2063 6f6c 756d 6e20     - The column 
+0001d200: 6e61 6d65 2061 6e64 2062 6f74 6820 6c6f  name and both lo
+0001d210: 775f 7661 6c75 6520 616e 6420 6869 6768  w_value and high
+0001d220: 5f76 616c 7565 2073 6574 2074 6f20 6120  _value set to a 
+0001d230: 6461 7465 7469 6d65 206f 6620 7468 650a  datetime of the.
+0001d240: 2020 2020 2020 2020 2020 2020 7269 6768              righ
+0001d250: 7420 666f 726d 6174 2e0a 2020 2020 2020  t format..      
+0001d260: 2020 2222 220a 2020 2020 2020 2020 2320    """.        # 
+0001d270: 5365 7475 700a 2020 2020 2020 2020 6d65  Setup.        me
+0001d280: 7461 6461 7461 203d 204d 6f63 6b28 290a  tadata = Mock().
+0001d290: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+0001d2a0: 2e63 6f6c 756d 6e73 203d 207b 2761 273a  .columns = {'a':
+0001d2b0: 207b 2773 6474 7970 6527 3a20 2764 6174   {'sdtype': 'dat
+0001d2c0: 6574 696d 6527 2c20 2764 6174 6574 696d  etime', 'datetim
+0001d2d0: 655f 666f 726d 6174 273a 2027 6d2f 642f  e_format': 'm/d/
+0001d2e0: 7927 7d7d 0a20 2020 2020 2020 2064 6174  y'}}.        dat
+0001d2f0: 6574 696d 655f 666f 726d 6174 5f6d 6f63  etime_format_moc
+0001d300: 6b2e 7265 7475 726e 5f76 616c 7565 203d  k.return_value =
+0001d310: 2054 7275 650a 0a20 2020 2020 2020 2023   True..        #
+0001d320: 2052 756e 0a20 2020 2020 2020 2053 6361   Run.        Sca
+0001d330: 6c61 7252 616e 6765 2e5f 7661 6c69 6461  larRange._valida
+0001d340: 7465 5f6d 6574 6164 6174 615f 7370 6563  te_metadata_spec
+0001d350: 6966 6963 5f74 6f5f 636f 6e73 7472 6169  ific_to_constrai
+0001d360: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
+0001d370: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
+0001d380: 2020 2020 2020 636f 6c75 6d6e 5f6e 616d        column_nam
+0001d390: 653d 2761 272c 0a20 2020 2020 2020 2020  e='a',.         
+0001d3a0: 2020 206c 6f77 5f76 616c 7565 3d27 312f     low_value='1/
+0001d3b0: 312f 3230 3230 272c 0a20 2020 2020 2020  1/2020',.       
+0001d3c0: 2020 2020 2068 6967 685f 7661 6c75 653d       high_value=
+0001d3d0: 2731 2f33 302f 3230 3230 270a 2020 2020  '1/30/2020'.    
+0001d3e0: 2020 2020 290a 0a20 2020 2040 7061 7463      )..    @patc
+0001d3f0: 6828 2773 6476 2e63 6f6e 7374 7261 696e  h('sdv.constrain
+0001d400: 7473 2e74 6162 756c 6172 2e6d 6174 6368  ts.tabular.match
+0001d410: 6573 5f64 6174 6574 696d 655f 666f 726d  es_datetime_form
+0001d420: 6174 2729 0a20 2020 2064 6566 2074 6573  at').    def tes
+0001d430: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
+0001d440: 6461 7461 5f73 7065 6369 6669 635f 746f  data_specific_to
+0001d450: 5f63 6f6e 7374 7261 696e 745f 6869 6768  _constraint_high
+0001d460: 5f64 6174 6574 696d 655f 6572 726f 7228  _datetime_error(
+0001d470: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001d480: 662c 2064 6174 6574 696d 655f 666f 726d  f, datetime_form
+0001d490: 6174 5f6d 6f63 6b29 3a0a 2020 2020 2020  at_mock):.      
+0001d4a0: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
+0001d4b0: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
+0001d4c0: 7461 5f73 7065 6369 6669 635f 746f 5f63  ta_specific_to_c
+0001d4d0: 6f6e 7374 7261 696e 7460 6020 6d65 7468  onstraint`` meth
+0001d4e0: 6f64 2e0a 0a20 2020 2020 2020 2049 6620  od...        If 
+0001d4f0: 7468 6520 636f 6c75 6d6e 5f6e 616d 6520  the column_name 
+0001d500: 6861 7320 616e 2073 6474 7970 6520 6f66  has an sdtype of
+0001d510: 2064 6174 6574 696d 652c 2061 6e64 2074   datetime, and t
+0001d520: 6865 2068 6967 685f 7661 6c75 650a 2020  he high_value.  
+0001d530: 2020 2020 2020 6973 2061 2064 6174 6574        is a datet
+0001d540: 696d 6520 7374 7269 6e67 2074 6861 7420  ime string that 
+0001d550: 646f 6573 6e27 7420 6d61 7463 6820 7468  doesn't match th
+0001d560: 6520 666f 726d 6174 2c20 7468 656e 2061  e format, then a
+0001d570: 6e20 6572 726f 7220 7368 6f75 6c64 2062  n error should b
+0001d580: 6520 7261 6973 6564 2e0a 0a20 2020 2020  e raised...     
+0001d590: 2020 2053 6574 7570 3a0a 2020 2020 2020     Setup:.      
+0001d5a0: 2020 2020 2020 2d20 4d65 7461 6461 7461        - Metadata
+0001d5b0: 2077 6974 6820 7468 6520 7364 7479 7065   with the sdtype
+0001d5c0: 2073 6574 2074 6f20 6461 7465 7469 6d65   set to datetime
+0001d5d0: 2061 6e64 2061 2064 6174 6574 696d 655f   and a datetime_
+0001d5e0: 666f 726d 6174 2e0a 2020 2020 2020 2020  format..        
+0001d5f0: 2020 2020 2d20 4d6f 636b 2074 6865 2060      - Mock the `
+0001d600: 606d 6174 6368 6573 5f64 6174 6574 696d  `matches_datetim
+0001d610: 655f 666f 726d 6174 6060 2066 756e 6374  e_format`` funct
+0001d620: 696f 6e20 746f 2072 6574 7572 6e20 4661  ion to return Fa
+0001d630: 6c73 652c 2074 6865 6e20 5472 7565 2e0a  lse, then True..
+0001d640: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
+0001d650: 2020 2020 2020 2020 2020 2020 2d20 5468              - Th
+0001d660: 6520 636f 6c75 6d6e 206e 616d 652c 2061  e column name, a
+0001d670: 206c 6f77 5f76 616c 7565 2073 6574 2074   low_value set t
+0001d680: 6f20 6120 6461 7465 7469 6d65 206f 6620  o a datetime of 
+0001d690: 7468 6520 7269 6768 7420 666f 726d 6174  the right format
+0001d6a0: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
+0001d6b0: 2061 2068 6967 685f 7661 6c75 6520 7365   a high_value se
+0001d6c0: 7420 746f 2061 2064 6174 6574 696d 6520  t to a datetime 
+0001d6d0: 6f66 2074 6865 2077 726f 6e67 2066 6f72  of the wrong for
+0001d6e0: 6d61 742e 0a0a 2020 2020 2020 2020 5369  mat...        Si
+0001d6f0: 6465 2065 6666 6563 743a 0a20 2020 2020  de effect:.     
+0001d700: 2020 2020 2020 202d 2041 2043 6f6e 7374         - A Const
+0001d710: 7261 696e 744d 6574 6164 6174 6145 7272  raintMetadataErr
+0001d720: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
+0001d730: 7365 642e 0a20 2020 2020 2020 2022 2222  sed..        """
+0001d740: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+0001d750: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+0001d760: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
+0001d770: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
+0001d780: 6d6e 7320 3d20 7b27 6127 3a20 7b27 7364  mns = {'a': {'sd
+0001d790: 7479 7065 273a 2027 6461 7465 7469 6d65  type': 'datetime
+0001d7a0: 272c 2027 6461 7465 7469 6d65 5f66 6f72  ', 'datetime_for
+0001d7b0: 6d61 7427 3a20 276d 2f64 2f79 277d 7d0a  mat': 'm/d/y'}}.
+0001d7c0: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
+0001d7d0: 5f66 6f72 6d61 745f 6d6f 636b 2e73 6964  _format_mock.sid
+0001d7e0: 655f 6566 6665 6374 203d 205b 4661 6c73  e_effect = [Fals
+0001d7f0: 652c 2054 7275 655d 0a0a 2020 2020 2020  e, True]..      
+0001d800: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
+0001d810: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+0001d820: 280a 2020 2020 2020 2020 2020 2020 2242  (.            "B
+0001d830: 6f74 6820 2768 6967 685f 7661 6c75 6527  oth 'high_value'
+0001d840: 2061 6e64 2027 6c6f 775f 7661 6c75 6527   and 'low_value'
+0001d850: 206d 7573 7420 6265 2061 2064 6174 6574   must be a datet
+0001d860: 696d 6520 7374 7269 6e67 206f 6620 7468  ime string of th
+0001d870: 6520 7269 6768 7420 666f 726d 6174 220a  e right format".
+0001d880: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001d890: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+0001d8a0: 6973 6573 2843 6f6e 7374 7261 696e 744d  ises(ConstraintM
+0001d8b0: 6574 6164 6174 6145 7272 6f72 2c20 6d61  etadataError, ma
+0001d8c0: 7463 683d 6572 726f 725f 6d65 7373 6167  tch=error_messag
+0001d8d0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+0001d8e0: 5363 616c 6172 5261 6e67 652e 5f76 616c  ScalarRange._val
+0001d8f0: 6964 6174 655f 6d65 7461 6461 7461 5f73  idate_metadata_s
+0001d900: 7065 6369 6669 635f 746f 5f63 6f6e 7374  pecific_to_const
+0001d910: 7261 696e 7428 0a20 2020 2020 2020 2020  raint(.         
+0001d920: 2020 2020 2020 206d 6574 6164 6174 612c         metadata,
+0001d930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d940: 2063 6f6c 756d 6e5f 6e61 6d65 3d27 6127   column_name='a'
+0001d950: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001d960: 2020 6869 6768 5f76 616c 7565 3d27 312f    high_value='1/
+0001d970: 312f 3230 3139 272c 0a20 2020 2020 2020  1/2019',.       
+0001d980: 2020 2020 2020 2020 206c 6f77 5f76 616c           low_val
+0001d990: 7565 3d27 312d 312d 3230 3230 270a 2020  ue='1-1-2020'.  
+0001d9a0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0001d9b0: 2040 7061 7463 6828 2773 6476 2e63 6f6e   @patch('sdv.con
+0001d9c0: 7374 7261 696e 7473 2e74 6162 756c 6172  straints.tabular
+0001d9d0: 2e6d 6174 6368 6573 5f64 6174 6574 696d  .matches_datetim
+0001d9e0: 655f 666f 726d 6174 2729 0a20 2020 2064  e_format').    d
+0001d9f0: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
+0001da00: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+0001da10: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+0001da20: 745f 6c6f 775f 6461 7465 7469 6d65 5f65  t_low_datetime_e
+0001da30: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0001da40: 2020 7365 6c66 2c20 6461 7465 7469 6d65    self, datetime
+0001da50: 5f66 6f72 6d61 745f 6d6f 636b 293a 0a20  _format_mock):. 
+0001da60: 2020 2020 2020 2022 2222 5465 7374 2074         """Test t
+0001da70: 6865 2060 605f 7661 6c69 6461 7465 5f6d  he ``_validate_m
+0001da80: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
+0001da90: 5f74 6f5f 636f 6e73 7472 6169 6e74 6060  _to_constraint``
+0001daa0: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
+0001dab0: 2020 4966 2074 6865 2063 6f6c 756d 6e5f    If the column_
+0001dac0: 6e61 6d65 2068 6173 2061 6e20 7364 7479  name has an sdty
+0001dad0: 7065 206f 6620 6461 7465 7469 6d65 2c20  pe of datetime, 
+0001dae0: 616e 6420 7468 6520 6c6f 775f 7661 6c75  and the low_valu
+0001daf0: 650a 2020 2020 2020 2020 6973 2061 2064  e.        is a d
+0001db00: 6174 6574 696d 6520 7374 7269 6e67 2074  atetime string t
+0001db10: 6861 7420 646f 6573 6e27 7420 6d61 7463  hat doesn't matc
+0001db20: 6820 7468 6520 666f 726d 6174 2c20 7468  h the format, th
+0001db30: 656e 2061 6e20 6572 726f 7220 7368 6f75  en an error shou
+0001db40: 6c64 2062 6520 7261 6973 6564 2e0a 0a20  ld be raised... 
+0001db50: 2020 2020 2020 2053 6574 7570 3a0a 2020         Setup:.  
+0001db60: 2020 2020 2020 2020 2020 2d20 4d65 7461            - Meta
+0001db70: 6461 7461 2077 6974 6820 7468 6520 7364  data with the sd
+0001db80: 7479 7065 2073 6574 2074 6f20 6461 7465  type set to date
+0001db90: 7469 6d65 2061 6e64 2061 2064 6174 6574  time and a datet
+0001dba0: 696d 655f 666f 726d 6174 2e0a 2020 2020  ime_format..    
+0001dbb0: 2020 2020 2020 2020 2d20 4d6f 636b 2074          - Mock t
+0001dbc0: 6865 2060 606d 6174 6368 6573 5f64 6174  he ``matches_dat
+0001dbd0: 6574 696d 655f 666f 726d 6174 6060 2066  etime_format`` f
+0001dbe0: 756e 6374 696f 6e20 746f 2072 6574 7572  unction to retur
+0001dbf0: 6e20 5472 7565 2c20 7468 656e 2046 616c  n True, then Fal
+0001dc00: 7365 2e0a 0a20 2020 2020 2020 2049 6e70  se...        Inp
+0001dc10: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
+0001dc20: 2d20 5468 6520 636f 6c75 6d6e 206e 616d  - The column nam
+0001dc30: 652c 2061 206c 6f77 5f76 616c 7565 2073  e, a low_value s
+0001dc40: 6574 2074 6f20 6120 6461 7465 7469 6d65  et to a datetime
+0001dc50: 206f 6620 7468 6520 7772 6f6e 6720 666f   of the wrong fo
+0001dc60: 726d 6174 2061 6e64 0a20 2020 2020 2020  rmat and.       
+0001dc70: 2020 2020 2061 2068 6967 685f 7661 6c75       a high_valu
+0001dc80: 6520 7365 7420 746f 2061 2064 6174 6574  e set to a datet
+0001dc90: 696d 6520 6f66 2074 6865 2072 6967 6874  ime of the right
+0001dca0: 2066 6f72 6d61 742e 0a0a 2020 2020 2020   format...      
+0001dcb0: 2020 5369 6465 2065 6666 6563 743a 0a20    Side effect:. 
+0001dcc0: 2020 2020 2020 2020 2020 202d 2041 2043             - A C
+0001dcd0: 6f6e 7374 7261 696e 744d 6574 6164 6174  onstraintMetadat
+0001dce0: 6145 7272 6f72 2073 686f 756c 6420 6265  aError should be
+0001dcf0: 2072 6169 7365 642e 0a20 2020 2020 2020   raised..       
+0001dd00: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
+0001dd10: 6574 7570 0a20 2020 2020 2020 206d 6574  etup.        met
+0001dd20: 6164 6174 6120 3d20 4d6f 636b 2829 0a20  adata = Mock(). 
+0001dd30: 2020 2020 2020 206d 6574 6164 6174 612e         metadata.
+0001dd40: 636f 6c75 6d6e 7320 3d20 7b27 6127 3a20  columns = {'a': 
+0001dd50: 7b27 7364 7479 7065 273a 2027 6461 7465  {'sdtype': 'date
+0001dd60: 7469 6d65 272c 2027 6461 7465 7469 6d65  time', 'datetime
+0001dd70: 5f66 6f72 6d61 7427 3a20 276d 2f64 2f79  _format': 'm/d/y
+0001dd80: 277d 7d0a 2020 2020 2020 2020 6461 7465  '}}.        date
+0001dd90: 7469 6d65 5f66 6f72 6d61 745f 6d6f 636b  time_format_mock
+0001dda0: 2e73 6964 655f 6566 6665 6374 203d 205b  .side_effect = [
+0001ddb0: 5472 7565 2c20 4661 6c73 655d 0a0a 2020  True, False]..  
+0001ddc0: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+0001ddd0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+0001dde0: 6520 3d20 280a 2020 2020 2020 2020 2020  e = (.          
+0001ddf0: 2020 2242 6f74 6820 2768 6967 685f 7661    "Both 'high_va
+0001de00: 6c75 6527 2061 6e64 2027 6c6f 775f 7661  lue' and 'low_va
+0001de10: 6c75 6527 206d 7573 7420 6265 2061 2064  lue' must be a d
+0001de20: 6174 6574 696d 6520 7374 7269 6e67 206f  atetime string o
+0001de30: 6620 7468 6520 7269 6768 7420 666f 726d  f the right form
+0001de40: 6174 220a 2020 2020 2020 2020 290a 2020  at".        ).  
+0001de50: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+0001de60: 742e 7261 6973 6573 2843 6f6e 7374 7261  t.raises(Constra
+0001de70: 696e 744d 6574 6164 6174 6145 7272 6f72  intMetadataError
+0001de80: 2c20 6d61 7463 683d 6572 726f 725f 6d65  , match=error_me
+0001de90: 7373 6167 6529 3a0a 2020 2020 2020 2020  ssage):.        
+0001dea0: 2020 2020 5363 616c 6172 5261 6e67 652e      ScalarRange.
+0001deb0: 5f76 616c 6964 6174 655f 6d65 7461 6461  _validate_metada
+0001dec0: 7461 5f73 7065 6369 6669 635f 746f 5f63  ta_specific_to_c
+0001ded0: 6f6e 7374 7261 696e 7428 0a20 2020 2020  onstraint(.     
+0001dee0: 2020 2020 2020 2020 2020 206d 6574 6164             metad
+0001def0: 6174 612c 0a20 2020 2020 2020 2020 2020  ata,.           
+0001df00: 2020 2020 2063 6f6c 756d 6e5f 6e61 6d65       column_name
+0001df10: 3d27 6127 2c0a 2020 2020 2020 2020 2020  ='a',.          
+0001df20: 2020 2020 2020 6869 6768 5f76 616c 7565        high_value
+0001df30: 3d27 312d 312d 3230 3139 272c 0a20 2020  ='1-1-2019',.   
+0001df40: 2020 2020 2020 2020 2020 2020 206c 6f77               low
+0001df50: 5f76 616c 7565 3d27 312f 312f 3230 3230  _value='1/1/2020
+0001df60: 270a 2020 2020 2020 2020 2020 2020 290a  '.            ).
+0001df70: 0a20 2020 2064 6566 2074 6573 745f 5f76  .    def test__v
+0001df80: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
+0001df90: 5f73 7065 6369 6669 635f 746f 5f63 6f6e  _specific_to_con
+0001dfa0: 7374 7261 696e 745f 6261 645f 7479 7065  straint_bad_type
+0001dfb0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0001dfc0: 2222 2254 6573 7420 7468 6520 6060 5f76  """Test the ``_v
+0001dfd0: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
+0001dfe0: 5f73 7065 6369 6669 635f 746f 5f63 6f6e  _specific_to_con
+0001dff0: 7374 7261 696e 7460 6020 6d65 7468 6f64  straint`` method
+0001e000: 2e0a 0a20 2020 2020 2020 2049 6620 7468  ...        If th
+0001e010: 6520 636f 6c75 6d6e 5f6e 616d 6520 6861  e column_name ha
+0001e020: 7320 616e 2073 6474 7970 6520 7468 6174  s an sdtype that
+0001e030: 2069 7320 6e6f 7420 6120 6461 7465 7469   is not a dateti
+0001e040: 6d65 2073 7472 696e 672c 2069 6e74 206f  me string, int o
+0001e050: 720a 2020 2020 2020 2020 666c 6f61 7420  r.        float 
+0001e060: 7468 656e 2061 6e20 6572 726f 7220 7368  then an error sh
+0001e070: 6f75 6c64 2062 6520 7261 6973 6564 2e0a  ould be raised..
+0001e080: 0a20 2020 2020 2020 2053 6574 7570 3a0a  .        Setup:.
+0001e090: 2020 2020 2020 2020 2020 2020 2d20 4d65              - Me
+0001e0a0: 7461 6461 7461 2077 6974 6820 7468 6520  tadata with the 
+0001e0b0: 7364 7479 7065 2073 6574 2074 6f20 6361  sdtype set to ca
+0001e0c0: 7465 676f 7269 6361 6c2e 0a0a 2020 2020  tegorical...    
+0001e0d0: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
+0001e0e0: 2020 2020 2020 202d 2054 6865 2063 6f6c         - The col
+0001e0f0: 756d 6e20 6e61 6d65 2c20 7265 6c61 7469  umn name, relati
+0001e100: 6f6e 2061 6e64 2076 616c 7565 2e0a 0a20  on and value... 
+0001e110: 2020 2020 2020 2053 6964 6520 6566 6665         Side effe
+0001e120: 6374 3a0a 2020 2020 2020 2020 2020 2020  ct:.            
+0001e130: 2d20 4120 436f 6e73 7472 6169 6e74 4d65  - A ConstraintMe
+0001e140: 7461 6461 7461 4572 726f 7220 7368 6f75  tadataError shou
+0001e150: 6c64 2062 6520 7261 6973 6564 2e0a 2020  ld be raised..  
+0001e160: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001e170: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
+0001e180: 2020 6d65 7461 6461 7461 203d 204d 6f63    metadata = Moc
+0001e190: 6b28 290a 2020 2020 2020 2020 6d65 7461  k().        meta
+0001e1a0: 6461 7461 2e63 6f6c 756d 6e73 203d 207b  data.columns = {
+0001e1b0: 2761 273a 207b 2773 6474 7970 6527 3a20  'a': {'sdtype': 
+0001e1c0: 2763 6174 6567 6f72 6963 616c 277d 7d0a  'categorical'}}.
+0001e1d0: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+0001e1e0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+0001e1f0: 7361 6765 203d 2028 0a20 2020 2020 2020  sage = (.       
+0001e200: 2020 2020 2027 4120 5363 616c 6172 5261       'A ScalarRa
+0001e210: 6e67 6520 636f 6e73 7472 6169 6e74 2069  nge constraint i
+0001e220: 7320 6265 696e 6720 6170 706c 6965 6420  s being applied 
+0001e230: 746f 2063 6f6c 756d 6e73 2077 6974 6820  to columns with 
+0001e240: 6d69 736d 6174 6368 6564 2073 6474 7970  mismatched sdtyp
+0001e250: 6573 2e20 270a 2020 2020 2020 2020 2020  es. '.          
+0001e260: 2020 274e 756d 6572 6963 616c 2063 6f6c    'Numerical col
+0001e270: 756d 6e73 206d 7573 7420 6265 2063 6f6d  umns must be com
+0001e280: 7061 7265 6420 746f 2069 6e74 6567 6572  pared to integer
+0001e290: 206f 7220 666c 6f61 7420 7661 6c75 6573   or float values
+0001e2a0: 2e20 270a 2020 2020 2020 2020 2020 2020  . '.            
+0001e2b0: 2744 6174 6574 696d 6573 2063 6f6c 756d  'Datetimes colum
+0001e2c0: 6e20 6d75 7374 2062 6520 636f 6d70 6172  n must be compar
+0001e2d0: 6564 2074 6f20 6461 7465 7469 6d65 2073  ed to datetime s
+0001e2e0: 7472 696e 6773 2e27 0a20 2020 2020 2020  trings.'.       
+0001e2f0: 2029 0a20 2020 2020 2020 2077 6974 6820   ).        with 
+0001e300: 7079 7465 7374 2e72 6169 7365 7328 436f  pytest.raises(Co
+0001e310: 6e73 7472 6169 6e74 4d65 7461 6461 7461  nstraintMetadata
+0001e320: 4572 726f 722c 206d 6174 6368 3d65 7272  Error, match=err
+0001e330: 6f72 5f6d 6573 7361 6765 293a 0a20 2020  or_message):.   
+0001e340: 2020 2020 2020 2020 2053 6361 6c61 7252           ScalarR
+0001e350: 616e 6765 2e5f 7661 6c69 6461 7465 5f6d  ange._validate_m
+0001e360: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
+0001e370: 5f74 6f5f 636f 6e73 7472 6169 6e74 280a  _to_constraint(.
+0001e380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e390: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
+0001e3a0: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+0001e3b0: 5f6e 616d 653d 2761 272c 0a20 2020 2020  _name='a',.     
+0001e3c0: 2020 2020 2020 2020 2020 2068 6967 685f             high_
+0001e3d0: 7661 6c75 653d 2731 3027 2c0a 2020 2020  value='10',.    
+0001e3e0: 2020 2020 2020 2020 2020 2020 6c6f 775f              low_
+0001e3f0: 7661 6c75 653d 2737 270a 2020 2020 2020  value='7'.      
+0001e400: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+0001e410: 2074 6573 745f 5f76 616c 6964 6174 655f   test__validate_
+0001e420: 696e 6974 5f69 6e70 7574 7328 7365 6c66  init_inputs(self
+0001e430: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+0001e440: 7374 2074 6865 2060 605f 7661 6c69 6461  st the ``_valida
+0001e450: 7465 5f69 6e69 745f 696e 7075 7473 6060  te_init_inputs``
+0001e460: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
+0001e470: 2020 5468 6520 6d65 7468 6f64 2073 686f    The method sho
+0001e480: 756c 6420 7261 6973 6520 616e 2065 7272  uld raise an err
+0001e490: 6f72 2069 6620 7468 6520 696e 7075 7473  or if the inputs
+0001e4a0: 2061 7265 206e 6f74 2076 616c 6964 2e0a   are not valid..
+0001e4b0: 0a20 2020 2020 2020 2053 6574 7570 3a0a  .        Setup:.
+0001e4c0: 2020 2020 2020 2020 2020 2020 2d20 6c6f              - lo
+0001e4d0: 775f 7661 6c75 6520 6173 2061 2073 7472  w_value as a str
+0001e4e0: 696e 6720 6e6f 7420 7265 7072 6573 656e  ing not represen
+0001e4f0: 7469 6e67 2061 2064 6174 6574 696d 652e  ting a datetime.
+0001e500: 0a20 2020 2020 2020 2020 2020 202d 2068  .            - h
+0001e510: 6967 685f 7661 6c75 6520 6173 2061 2069  igh_value as a i
+0001e520: 6e74 2e0a 0a20 2020 2020 2020 2053 6964  nt...        Sid
+0001e530: 6520 4566 6665 6374 733a 0a20 2020 2020  e Effects:.     
+0001e540: 2020 2020 2020 2041 2076 616c 7565 2065         A value e
+0001e550: 7272 6f72 2073 686f 756c 6420 6265 2072  rror should be r
+0001e560: 6169 7365 642e 0a20 2020 2020 2020 2022  aised..        "
+0001e570: 2222 0a20 2020 2020 2020 2023 2053 6574  "".        # Set
+0001e580: 7570 0a20 2020 2020 2020 206c 6f77 5f76  up.        low_v
+0001e590: 616c 7565 203d 2027 6162 6327 0a20 2020  alue = 'abc'.   
+0001e5a0: 2020 2020 2068 6967 685f 7661 6c75 6520       high_value 
+0001e5b0: 3d20 320a 0a20 2020 2020 2020 2023 2052  = 2..        # R
+0001e5c0: 756e 202f 2041 7373 6572 740a 2020 2020  un / Assert.    
+0001e5d0: 2020 2020 6572 726f 725f 6d73 6720 3d20      error_msg = 
+0001e5e0: 280a 2020 2020 2020 2020 2020 2020 2760  (.            '`
+0001e5f0: 606c 6f77 5f76 616c 7565 6060 2061 6e64  `low_value`` and
+0001e600: 2060 6068 6967 685f 7661 6c75 6560 6020   ``high_value`` 
+0001e610: 6d75 7374 2062 6520 6120 6e75 6d62 6572  must be a number
+0001e620: 206f 7220 6120 7374 7269 6e67 2074 6861   or a string tha
+0001e630: 7420 270a 2020 2020 2020 2020 2020 2020  t '.            
+0001e640: 2772 6570 7265 7365 6e74 7320 6120 6461  'represents a da
+0001e650: 7465 7469 6d65 2e27 0a20 2020 2020 2020  tetime.'.       
+0001e660: 2029 0a20 2020 2020 2020 2077 6974 6820   ).        with 
+0001e670: 7079 7465 7374 2e72 6169 7365 7328 5661  pytest.raises(Va
+0001e680: 6c75 6545 7272 6f72 2c20 6d61 7463 683d  lueError, match=
+0001e690: 6572 726f 725f 6d73 6729 3a0a 2020 2020  error_msg):.    
+0001e6a0: 2020 2020 2020 2020 5363 616c 6172 5261          ScalarRa
+0001e6b0: 6e67 652e 5f76 616c 6964 6174 655f 696e  nge._validate_in
+0001e6c0: 6974 5f69 6e70 7574 7328 6c6f 775f 7661  it_inputs(low_va
+0001e6d0: 6c75 652c 2068 6967 685f 7661 6c75 6529  lue, high_value)
+0001e6e0: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
+0001e6f0: 7661 6c69 6461 7465 5f69 6e69 745f 696e  validate_init_in
+0001e700: 7075 7473 5f64 6174 6574 696d 6573 5f6e  puts_datetimes_n
+0001e710: 6f74 5f73 7472 696e 6773 2873 656c 6629  ot_strings(self)
+0001e720: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
+0001e730: 7420 7468 6520 6060 5f76 616c 6964 6174  t the ``_validat
+0001e740: 655f 696e 6974 5f69 6e70 7574 7360 6020  e_init_inputs`` 
+0001e750: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
+0001e760: 2054 6865 206d 6574 686f 6420 7368 6f75   The method shou
+0001e770: 6c64 2072 6169 7365 2061 6e20 6572 726f  ld raise an erro
+0001e780: 7220 6966 2074 6865 2064 6174 6574 696d  r if the datetim
+0001e790: 6573 2061 7265 206e 6f74 2072 6570 7265  es are not repre
+0001e7a0: 7365 6e74 6564 2061 7320 7374 7269 6e67  sented as string
+0001e7b0: 2e0a 0a20 2020 2020 2020 2053 6574 7570  ...        Setup
+0001e7c0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+0001e7d0: 6c6f 775f 7661 6c75 6520 6173 2060 6070  low_value as ``p
+0001e7e0: 642e 6461 7465 7469 6d65 6060 0a20 2020  d.datetime``.   
+0001e7f0: 2020 2020 2020 2020 202d 2068 6967 685f           - high_
+0001e800: 7661 6c75 6520 6173 2060 6070 642e 6461  value as ``pd.da
+0001e810: 7465 7469 6d65 6060 0a0a 2020 2020 2020  tetime``..      
+0001e820: 2020 5369 6465 2045 6666 6563 7473 3a0a    Side Effects:.
+0001e830: 2020 2020 2020 2020 2020 2020 4120 7661              A va
+0001e840: 6c75 6520 6572 726f 7220 7368 6f75 6c64  lue error should
+0001e850: 2062 6520 7261 6973 6564 2e0a 2020 2020   be raised..    
+0001e860: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001e870: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
+0001e880: 6c6f 775f 7661 6c75 6520 3d20 7064 2e74  low_value = pd.t
+0001e890: 6f5f 6461 7465 7469 6d65 2827 3230 3231  o_datetime('2021
+0001e8a0: 2d30 322d 3032 2729 0a20 2020 2020 2020  -02-02').       
+0001e8b0: 2068 6967 685f 7661 6c75 6520 3d20 7064   high_value = pd
+0001e8c0: 2e74 6f5f 6461 7465 7469 6d65 2827 3230  .to_datetime('20
+0001e8d0: 3231 2d30 322d 3032 2729 0a0a 2020 2020  21-02-02')..    
+0001e8e0: 2020 2020 2320 5275 6e20 2f20 4173 7365      # Run / Asse
+0001e8f0: 7274 0a20 2020 2020 2020 2077 6974 6820  rt.        with 
+0001e900: 7079 7465 7374 2e72 6169 7365 7328 5661  pytest.raises(Va
+0001e910: 6c75 6545 7272 6f72 2c20 6d61 7463 683d  lueError, match=
+0001e920: 2744 6174 6574 696d 6520 6d75 7374 2062  'Datetime must b
+0001e930: 6520 7265 7072 6573 656e 7465 6420 6173  e represented as
+0001e940: 2061 2073 7472 696e 672e 2729 3a0a 2020   a string.'):.  
+0001e950: 2020 2020 2020 2020 2020 5363 616c 6172            Scalar
+0001e960: 5261 6e67 652e 5f76 616c 6964 6174 655f  Range._validate_
+0001e970: 696e 6974 5f69 6e70 7574 7328 6c6f 775f  init_inputs(low_
+0001e980: 7661 6c75 652c 2068 6967 685f 7661 6c75  value, high_valu
+0001e990: 6529 0a0a 2020 2020 6465 6620 7465 7374  e)..    def test
+0001e9a0: 5f5f 5f69 6e69 745f 5f28 7365 6c66 293a  ___init__(self):
+0001e9b0: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+0001e9c0: 2074 6865 2060 6053 6361 6c61 7252 616e   the ``ScalarRan
+0001e9d0: 6765 2e5f 5f69 6e69 745f 5f60 6020 6d65  ge.__init__`` me
+0001e9e0: 7468 6f64 2e0a 0a20 2020 2020 2020 2054  thod...        T
+0001e9f0: 6865 2069 6e73 7461 6e63 6520 7368 6f75  he instance shou
+0001ea00: 6c64 2063 6f6e 7461 696e 2074 6865 206e  ld contain the n
+0001ea10: 616d 6520 6f66 2074 6865 2074 6872 6565  ame of the three
+0001ea20: 2070 6173 7365 6420 636f 6c75 6d6e 7320   passed columns 
+0001ea30: 616e 6420 616c 736f 0a20 2020 2020 2020  and also.       
+0001ea40: 2075 7365 2061 6e20 6f70 6572 6174 6f72   use an operator
+0001ea50: 2060 603c 6060 2069 6620 6060 7374 7269   ``<`` if ``stri
+0001ea60: 6374 5f62 6f75 6e64 6172 6965 7360 6020  ct_boundaries`` 
+0001ea70: 6973 2060 6054 7275 6560 6020 6279 2064  is ``True`` by d
+0001ea80: 6566 6175 6c74 2e0a 2020 2020 2020 2020  efault..        
+0001ea90: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
+0001eaa0: 2020 202d 2043 6f6c 756d 6e20 6e61 6d65     - Column name
+0001eab0: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+0001eac0: 4c6f 7765 7220 7661 6c75 652e 0a20 2020  Lower value..   
+0001ead0: 2020 2020 2020 2020 202d 2048 6967 6820           - High 
+0001eae0: 7661 6c75 652e 0a20 2020 2020 2020 2022  value..        "
+0001eaf0: 2222 0a20 2020 2020 2020 2023 2052 756e  "".        # Run
+0001eb00: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
+0001eb10: 6520 3d20 5363 616c 6172 5261 6e67 6528  e = ScalarRange(
+0001eb20: 636f 6c75 6d6e 5f6e 616d 653d 2761 6765  column_name='age
+0001eb30: 5f77 6865 6e5f 6a6f 696e 6564 272c 206c  _when_joined', l
+0001eb40: 6f77 5f76 616c 7565 3d31 382c 2068 6967  ow_value=18, hig
+0001eb50: 685f 7661 6c75 653d 3238 290a 0a20 2020  h_value=28)..   
+0001eb60: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
+0001eb70: 2020 2020 2020 6173 7365 7274 2069 6e73        assert ins
+0001eb80: 7461 6e63 652e 5f63 6f6c 756d 6e5f 6e61  tance._column_na
+0001eb90: 6d65 203d 3d20 2761 6765 5f77 6865 6e5f  me == 'age_when_
+0001eba0: 6a6f 696e 6564 270a 2020 2020 2020 2020  joined'.        
+0001ebb0: 6173 7365 7274 2069 6e73 7461 6e63 652e  assert instance.
+0001ebc0: 5f6c 6f77 5f76 616c 7565 203d 3d20 3138  _low_value == 18
+0001ebd0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+0001ebe0: 696e 7374 616e 6365 2e5f 6869 6768 5f76  instance._high_v
+0001ebf0: 616c 7565 203d 3d20 3238 0a20 2020 2020  alue == 28.     
+0001ec00: 2020 2061 7373 6572 7420 696e 7374 616e     assert instan
+0001ec10: 6365 2e5f 6f70 6572 6174 6f72 203d 3d20  ce._operator == 
+0001ec20: 6f70 6572 6174 6f72 2e6c 740a 0a20 2020  operator.lt..   
+0001ec30: 2064 6566 2074 6573 745f 5f5f 696e 6974   def test___init
+0001ec40: 5f5f 7374 7269 6374 5f62 6f75 6e64 6172  __strict_boundar
+0001ec50: 6965 735f 6661 6c73 6528 7365 6c66 293a  ies_false(self):
+0001ec60: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+0001ec70: 2074 6865 2060 6053 6361 6c61 7252 616e   the ``ScalarRan
+0001ec80: 6765 2e5f 5f69 6e69 745f 5f60 6020 6d65  ge.__init__`` me
+0001ec90: 7468 6f64 2e0a 0a20 2020 2020 2020 2054  thod...        T
+0001eca0: 6573 7420 7468 6520 6060 5f5f 696e 6974  est the ``__init
+0001ecb0: 5f5f 6060 206d 6574 686f 6420 7768 656e  __`` method when
+0001ecc0: 2060 6073 7472 6963 745f 626f 756e 6461   ``strict_bounda
+0001ecd0: 7269 6573 6060 2069 7320 6060 4661 6c73  ries`` is ``Fals
+0001ece0: 6560 602e 0a0a 2020 2020 2020 2020 496e  e``...        In
+0001ecf0: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
+0001ed00: 202d 2054 6872 6565 2063 6f6c 756d 6e20   - Three column 
+0001ed10: 6e61 6d65 732e 0a20 2020 2020 2020 2020  names..         
+0001ed20: 2020 202d 2060 6073 7472 6963 745f 626f     - ``strict_bo
+0001ed30: 756e 6461 7269 6573 3d46 616c 7365 6060  undaries=False``
+0001ed40: 2e0a 0a20 2020 2020 2020 2053 6964 6520  ...        Side 
+0001ed50: 4566 6665 6374 3a0a 2020 2020 2020 2020  Effect:.        
+0001ed60: 2020 2020 2d20 6060 696e 7374 616e 6365      - ``instance
+0001ed70: 2e5f 6f70 6572 6174 6f72 6060 2073 686f  ._operator`` sho
+0001ed80: 756c 6420 6265 2060 606f 7065 7261 746f  uld be ``operato
+0001ed90: 722e 6c65 6060 0a20 2020 2020 2020 2022  r.le``.        "
+0001eda0: 2222 0a20 2020 2020 2020 2023 2052 756e  "".        # Run
+0001edb0: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
+0001edc0: 6520 3d20 5363 616c 6172 5261 6e67 6528  e = ScalarRange(
+0001edd0: 2761 6765 5f77 6865 6e5f 6a6f 696e 6564  'age_when_joined
+0001ede0: 272c 2031 382c 2032 382c 2073 7472 6963  ', 18, 28, stric
+0001edf0: 745f 626f 756e 6461 7269 6573 3d46 616c  t_boundaries=Fal
+0001ee00: 7365 290a 0a20 2020 2020 2020 2023 2041  se)..        # A
+0001ee10: 7373 6572 740a 2020 2020 2020 2020 6173  ssert.        as
+0001ee20: 7365 7274 2069 6e73 7461 6e63 652e 5f63  sert instance._c
+0001ee30: 6f6c 756d 6e5f 6e61 6d65 203d 3d20 2761  olumn_name == 'a
+0001ee40: 6765 5f77 6865 6e5f 6a6f 696e 6564 270a  ge_when_joined'.
+0001ee50: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+0001ee60: 6e73 7461 6e63 652e 5f6c 6f77 5f76 616c  nstance._low_val
+0001ee70: 7565 203d 3d20 3138 0a20 2020 2020 2020  ue == 18.       
+0001ee80: 2061 7373 6572 7420 696e 7374 616e 6365   assert instance
+0001ee90: 2e5f 6869 6768 5f76 616c 7565 203d 3d20  ._high_value == 
+0001eea0: 3238 0a20 2020 2020 2020 2061 7373 6572  28.        asser
+0001eeb0: 7420 696e 7374 616e 6365 2e5f 6f70 6572  t instance._oper
+0001eec0: 6174 6f72 203d 3d20 6f70 6572 6174 6f72  ator == operator
+0001eed0: 2e6c 650a 0a20 2020 2064 6566 2074 6573  .le..    def tes
+0001eee0: 745f 5f67 6574 5f69 735f 6461 7465 7469  t__get_is_dateti
+0001eef0: 6d65 2873 656c 6629 3a0a 2020 2020 2020  me(self):.      
+0001ef00: 2020 2222 2254 6573 7420 7468 6174 2074    """Test that t
+0001ef10: 6865 206d 6574 686f 6420 6465 7465 6374  he method detect
+0001ef20: 7320 7768 6574 6865 7220 6f72 206e 6f74  s whether or not
+0001ef30: 2074 6865 2060 6064 6174 6160 6020 6973   the ``data`` is
+0001ef40: 2060 6064 6174 6574 696d 6560 602e 0a0a   ``datetime``...
+0001ef50: 2020 2020 2020 2020 5468 6973 206d 6574          This met
+0001ef60: 686f 6420 7368 6f75 6c64 2064 6574 6563  hod should detec
+0001ef70: 7420 7768 6574 6865 7220 6f72 206e 6f74  t whether or not
+0001ef80: 2074 6865 2064 6174 6120 6973 2060 6064   the data is ``d
+0001ef90: 6174 6574 696d 6560 6020 616e 6420 6966  atetime`` and if
+0001efa0: 2069 6e20 6361 7365 2073 6f6d 6520 6973   in case some is
+0001efb0: 0a20 2020 2020 2020 2062 7574 206f 7468  .        but oth
+0001efc0: 6572 2069 7320 6e6f 742c 2072 6169 7365  er is not, raise
+0001efd0: 7320 616e 2065 7272 6f72 2e0a 0a20 2020  s an error...   
+0001efe0: 2020 2020 2053 6574 7570 3a0a 2020 2020       Setup:.    
+0001eff0: 2020 2020 2020 2020 2d20 4372 6561 7465          - Create
+0001f000: 2061 2070 642e 4461 7461 4672 616d 6520   a pd.DataFrame 
+0001f010: 7769 7468 2061 2063 6f6c 756d 6e20 7468  with a column th
+0001f020: 6174 2063 6f6e 7461 696e 7320 6461 7465  at contains date
+0001f030: 7469 6d65 2064 6174 612e 0a20 2020 2020  time data..     
+0001f040: 2020 2020 2020 202d 2049 6e73 7461 6e63         - Instanc
+0001f050: 6520 6f66 2060 6053 6361 6c61 7252 616e  e of ``ScalarRan
+0001f060: 6765 6060 2063 6f6e 7374 7261 696e 7420  ge`` constraint 
+0001f070: 7769 7468 206c 6f77 2061 6e64 2068 6967  with low and hig
+0001f080: 6820 6173 2064 6174 6574 696d 6520 2874  h as datetime (t
+0001f090: 696d 6573 7461 6d70 7329 2e0a 0a20 2020  imestamps)...   
+0001f0a0: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
+0001f0b0: 2020 2020 2020 2020 2d20 7064 2e44 6174          - pd.Dat
+0001f0c0: 6146 7261 6d65 2077 6974 6820 6060 7072  aFrame with ``pr
+0001f0d0: 6f6d 6f74 696f 6e5f 6461 7465 6060 2063  omotion_date`` c
+0001f0e0: 6f6c 756d 6e2e 0a0a 2020 2020 2020 2020  olumn...        
+0001f0f0: 4f75 7470 7574 3a0a 2020 2020 2020 2020  Output:.        
+0001f100: 2020 2020 2d20 5468 6520 6f75 7470 7574      - The output
+0001f110: 2073 686f 756c 6420 6265 2054 7275 652e   should be True.
+0001f120: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001f130: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
+0001f140: 2020 2020 2074 6162 6c65 5f64 6174 6120       table_data 
+0001f150: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
+0001f160: 0a20 2020 2020 2020 2020 2020 2027 7072  .            'pr
+0001f170: 6f6d 6f74 696f 6e5f 6461 7465 273a 2070  omotion_date': p
+0001f180: 642e 746f 5f64 6174 6574 696d 6528 5b27  d.to_datetime(['
+0001f190: 3230 3232 2d30 352d 3130 272c 2027 3230  2022-05-10', '20
+0001f1a0: 3232 2d30 362d 3130 272c 2027 3230 3232  22-06-10', '2022
+0001f1b0: 2d31 312d 3137 275d 292c 0a20 2020 2020  -11-17']),.     
+0001f1c0: 2020 207d 290a 2020 2020 2020 2020 696e     }).        in
+0001f1d0: 7374 616e 6365 203d 2053 6361 6c61 7252  stance = ScalarR
+0001f1e0: 616e 6765 2827 7072 6f6d 6f74 696f 6e5f  ange('promotion_
+0001f1f0: 6461 7465 272c 2027 3230 3231 2d30 322d  date', '2021-02-
+0001f200: 3130 272c 2027 3230 3530 2d31 302d 3131  10', '2050-10-11
+0001f210: 2729 0a0a 2020 2020 2020 2020 2320 5275  ')..        # Ru
+0001f220: 6e0a 2020 2020 2020 2020 6973 5f64 6174  n.        is_dat
+0001f230: 6574 696d 6520 3d20 696e 7374 616e 6365  etime = instance
+0001f240: 2e5f 6765 745f 6973 5f64 6174 6574 696d  ._get_is_datetim
+0001f250: 6528 7461 626c 655f 6461 7461 290a 0a20  e(table_data).. 
+0001f260: 2020 2020 2020 2023 2041 7373 6572 740a         # Assert.
+0001f270: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+0001f280: 735f 6461 7465 7469 6d65 0a0a 2020 2020  s_datetime..    
+0001f290: 6465 6620 7465 7374 5f5f 6765 745f 6973  def test__get_is
+0001f2a0: 5f64 6174 6574 696d 655f 6e6f 5f64 6174  _datetime_no_dat
+0001f2b0: 6574 696d 6573 2873 656c 6629 3a0a 2020  etimes(self):.  
+0001f2c0: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
+0001f2d0: 6174 2074 6865 206d 6574 686f 6420 6465  at the method de
+0001f2e0: 7465 6374 7320 7768 6574 6865 7220 6f72  tects whether or
+0001f2f0: 206e 6f74 2074 6865 2060 6064 6174 6160   not the ``data`
+0001f300: 6020 6973 2060 6064 6174 6574 696d 6560  ` is ``datetime`
+0001f310: 602e 0a0a 2020 2020 2020 2020 5468 6973  `...        This
+0001f320: 206d 6574 686f 6420 7368 6f75 6c64 2064   method should d
+0001f330: 6574 6563 7420 7768 6574 6865 7220 6f72  etect whether or
+0001f340: 206e 6f74 2074 6865 2064 6174 6120 6973   not the data is
+0001f350: 2060 6064 6174 6574 696d 6560 6020 616e   ``datetime`` an
+0001f360: 6420 6966 2069 6e20 6361 7365 2073 6f6d  d if in case som
+0001f370: 6520 6973 0a20 2020 2020 2020 2062 7574  e is.        but
+0001f380: 206f 7468 6572 2069 7320 6e6f 742c 2072   other is not, r
+0001f390: 6169 7365 7320 616e 2065 7272 6f72 2e0a  aises an error..
+0001f3a0: 0a20 2020 2020 2020 2053 6574 7570 3a0a  .        Setup:.
+0001f3b0: 2020 2020 2020 2020 2020 2020 2d20 4372              - Cr
+0001f3c0: 6561 7465 2061 2070 642e 4461 7461 4672  eate a pd.DataFr
+0001f3d0: 616d 6520 7769 7468 2061 2063 6f6c 756d  ame with a colum
+0001f3e0: 6e20 7468 6174 2069 7320 6e6f 7420 6461  n that is not da
+0001f3f0: 7461 7469 6d65 2e0a 2020 2020 2020 2020  tatime..        
+0001f400: 2020 2020 2d20 496e 7374 616e 6365 206f      - Instance o
+0001f410: 6620 6060 5363 616c 6172 5261 6e67 6560  f ``ScalarRange`
+0001f420: 6020 636f 6e73 7472 6169 6e74 2077 6974  ` constraint wit
+0001f430: 6820 6c6f 7720 616e 6420 6869 6768 2061  h low and high a
+0001f440: 7320 696e 7465 6765 7273 2e0a 0a20 2020  s integers...   
+0001f450: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
+0001f460: 2020 2020 2020 2020 2d20 7064 2e44 6174          - pd.Dat
+0001f470: 6146 7261 6d65 2077 6974 6820 6060 6375  aFrame with ``cu
+0001f480: 7272 656e 745f 6167 6560 600a 0a20 2020  rrent_age``..   
+0001f490: 2020 2020 204f 7574 7075 743a 0a20 2020       Output:.   
+0001f4a0: 2020 2020 2020 2020 202d 2054 6865 206f           - The o
+0001f4b0: 7574 7075 7420 7368 6f75 6c64 2062 6520  utput should be 
+0001f4c0: 6661 6c73 6520 7369 6e63 6520 616c 6c20  false since all 
+0001f4d0: 7468 6520 6461 7461 2069 7320 6060 696e  the data is ``in
+0001f4e0: 7460 602e 0a20 2020 2020 2020 2022 2222  t``..        """
+0001f4f0: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+0001f500: 0a20 2020 2020 2020 2074 6162 6c65 5f64  .        table_d
+0001f510: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
+0001f520: 6d65 287b 2763 7572 7265 6e74 5f61 6765  me({'current_age
+0001f530: 273a 205b 3231 2c20 3232 2c20 3235 5d7d  ': [21, 22, 25]}
+0001f540: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
+0001f550: 6365 203d 2053 6361 6c61 7252 616e 6765  ce = ScalarRange
+0001f560: 2827 6375 7272 656e 745f 6167 6527 2c20  ('current_age', 
+0001f570: 3231 2c20 3330 290a 0a20 2020 2020 2020  21, 30)..       
+0001f580: 2023 2052 756e 0a20 2020 2020 2020 2069   # Run.        i
+0001f590: 735f 6461 7465 7469 6d65 203d 2069 6e73  s_datetime = ins
+0001f5a0: 7461 6e63 652e 5f67 6574 5f69 735f 6461  tance._get_is_da
+0001f5b0: 7465 7469 6d65 2874 6162 6c65 5f64 6174  tetime(table_dat
+0001f5c0: 6129 0a0a 2020 2020 2020 2020 2320 4173  a)..        # As
+0001f5d0: 7365 7274 0a20 2020 2020 2020 2061 7373  sert.        ass
+0001f5e0: 6572 7420 6e6f 7420 6973 5f64 6174 6574  ert not is_datet
+0001f5f0: 696d 650a 0a20 2020 2064 6566 2074 6573  ime..    def tes
+0001f600: 745f 5f67 6574 5f69 735f 6461 7465 7469  t__get_is_dateti
+0001f610: 6d65 5f72 6169 7365 735f 616e 5f65 7272  me_raises_an_err
+0001f620: 6f72 2873 656c 6629 3a0a 2020 2020 2020  or(self):.      
+0001f630: 2020 2222 2254 6573 7420 7468 6174 2074    """Test that t
+0001f640: 6865 206d 6574 686f 6420 6465 7465 6374  he method detect
+0001f650: 7320 7768 6574 6865 7220 6f72 206e 6f74  s whether or not
+0001f660: 2074 6865 2060 6064 6174 6160 6020 6973   the ``data`` is
+0001f670: 2060 6064 6174 6574 696d 6560 602e 0a0a   ``datetime``...
+0001f680: 2020 2020 2020 2020 5468 6973 206d 6574          This met
+0001f690: 686f 6420 7368 6f75 6c64 2064 6574 6563  hod should detec
+0001f6a0: 7420 7768 6574 6865 7220 6f72 206e 6f74  t whether or not
+0001f6b0: 2074 6865 2064 6174 6120 6973 2060 6064   the data is ``d
+0001f6c0: 6174 6574 696d 6560 6020 616e 6420 6966  atetime`` and if
+0001f6d0: 2069 6e20 6361 7365 2073 6f6d 6520 6973   in case some is
+0001f6e0: 0a20 2020 2020 2020 2062 7574 206f 7468  .        but oth
+0001f6f0: 6572 2069 7320 6e6f 742c 2072 6169 7365  er is not, raise
+0001f700: 7320 616e 2065 7272 6f72 2e0a 0a20 2020  s an error...   
+0001f710: 2020 2020 2053 6574 7570 3a0a 2020 2020       Setup:.    
+0001f720: 2020 2020 2020 2020 2d20 4372 6561 7465          - Create
+0001f730: 2061 2070 642e 4461 7461 4672 616d 6520   a pd.DataFrame 
+0001f740: 7769 7468 2061 2063 6f6c 756d 6e20 7468  with a column th
+0001f750: 6174 2063 6f6e 7461 696e 7320 6461 7465  at contains date
+0001f760: 7469 6d65 2064 6174 612e 0a20 2020 2020  time data..     
+0001f770: 2020 2020 2020 202d 2049 6e73 7461 6e63         - Instanc
+0001f780: 6520 6f66 2060 6053 6361 6c61 7252 616e  e of ``ScalarRan
+0001f790: 6765 6060 2063 6f6e 7374 7261 696e 7420  ge`` constraint 
+0001f7a0: 7769 7468 206c 6f77 2061 6e64 2068 6967  with low and hig
+0001f7b0: 6820 6173 2069 6e74 6567 6572 732e 0a0a  h as integers...
+0001f7c0: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
+0001f7d0: 2020 2020 2020 2020 2020 202d 2070 642e             - pd.
+0001f7e0: 4461 7461 4672 616d 6520 7769 7468 2020  DataFrame with  
+0001f7f0: 6060 7072 6f6d 6f74 696f 6e5f 6461 7465  ``promotion_date
+0001f800: 6060 2e0a 0a20 2020 2020 2020 204f 7574  ``...        Out
+0001f810: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
+0001f820: 202d 2054 6865 206f 7574 7075 7420 7368   - The output sh
+0001f830: 6f75 6c64 2062 6520 6661 6c73 6520 7369  ould be false si
+0001f840: 6e63 6520 616c 6c20 7468 6520 6461 7461  nce all the data
+0001f850: 2069 7320 6060 696e 7460 602e 0a20 2020   is ``int``..   
+0001f860: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0001f870: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
+0001f880: 2074 6162 6c65 5f64 6174 6120 3d20 7064   table_data = pd
+0001f890: 2e44 6174 6146 7261 6d65 287b 0a20 2020  .DataFrame({.   
+0001f8a0: 2020 2020 2020 2020 2027 7072 6f6d 6f74           'promot
+0001f8b0: 696f 6e5f 6461 7465 273a 2070 642e 746f  ion_date': pd.to
+0001f8c0: 5f64 6174 6574 696d 6528 5b27 3230 3232  _datetime(['2022
+0001f8d0: 2d30 352d 3130 272c 2027 3230 3232 2d30  -05-10', '2022-0
+0001f8e0: 362d 3130 272c 2027 3230 3232 2d31 312d  6-10', '2022-11-
+0001f8f0: 3137 275d 292c 0a20 2020 2020 2020 207d  17']),.        }
+0001f900: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
+0001f910: 6365 203d 2053 6361 6c61 7252 616e 6765  ce = ScalarRange
+0001f920: 2827 7072 6f6d 6f74 696f 6e5f 6461 7465  ('promotion_date
+0001f930: 272c 2031 382c 2032 3529 0a20 2020 2020  ', 18, 25).     
+0001f940: 2020 2065 7870 6563 7465 645f 7465 7874     expected_text
+0001f950: 203d 2027 5468 6520 636f 6e73 7472 6169   = 'The constrai
+0001f960: 6e74 2063 6f6c 756d 6e20 616e 6420 626f  nt column and bo
+0001f970: 756e 6473 206d 7573 7420 616c 6c20 6265  unds must all be
+0001f980: 2064 6174 6574 696d 652e 270a 0a20 2020   datetime.'..   
+0001f990: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
+0001f9a0: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
+0001f9b0: 6169 7365 7328 5661 6c75 6545 7272 6f72  aises(ValueError
+0001f9c0: 2c20 6d61 7463 683d 6578 7065 6374 6564  , match=expected
+0001f9d0: 5f74 6578 7429 3a0a 2020 2020 2020 2020  _text):.        
+0001f9e0: 2020 2020 696e 7374 616e 6365 2e5f 6765      instance._ge
+0001f9f0: 745f 6973 5f64 6174 6574 696d 6528 7461  t_is_datetime(ta
+0001fa00: 626c 655f 6461 7461 290a 0a20 2020 2064  ble_data)..    d
+0001fa10: 6566 2074 6573 745f 5f67 6574 5f64 6966  ef test__get_dif
+0001fa20: 665f 636f 6c75 6d6e 5f6e 616d 6528 7365  f_column_name(se
+0001fa30: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0001fa40: 5465 7374 2074 6865 2060 6053 6361 6c61  Test the ``Scala
+0001fa50: 7252 616e 6765 2e5f 6765 745f 6469 6666  rRange._get_diff
+0001fa60: 5f63 6f6c 756d 6e5f 6e61 6d65 6060 206d  _column_name`` m
+0001fa70: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
+0001fa80: 5468 6973 206d 6574 686f 6420 7368 6f75  This method shou
+0001fa90: 6c64 2072 6574 7572 6e20 7468 6520 6e61  ld return the na
+0001faa0: 6d65 2066 6f72 2074 6865 206e 6577 2060  me for the new `
+0001fab0: 6074 7261 6e73 666f 726d 5f63 6f6c 756d  `transform_colum
+0001fac0: 6e60 602e 0a0a 2020 2020 2020 2020 5365  n``...        Se
+0001fad0: 7475 703a 0a20 2020 2020 2020 2020 2020  tup:.           
+0001fae0: 202d 2043 7265 6174 6520 6120 7064 2e44   - Create a pd.D
+0001faf0: 6174 6146 7261 6d65 2e0a 2020 2020 2020  ataFrame..      
+0001fb00: 2020 2020 2020 2d20 496e 7374 616e 6365        - Instance
+0001fb10: 206f 6620 6060 5363 616c 6172 5261 6e67   of ``ScalarRang
+0001fb20: 6560 6020 636f 6e73 7472 6169 6e74 2e0a  e`` constraint..
+0001fb30: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
+0001fb40: 2020 2020 2020 2020 2020 2020 2d20 7064              - pd
+0001fb50: 2e44 6174 6146 7261 6d65 2077 6974 6820  .DataFrame with 
+0001fb60: 6060 6375 7272 656e 745f 6167 6560 6020  ``current_age`` 
+0001fb70: 636f 6c75 6d6e 2e0a 0a20 2020 2020 2020  column...       
+0001fb80: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
+0001fb90: 2020 2020 202d 2054 6865 2063 6f6c 756d       - The colum
+0001fba0: 6e20 6e61 6d65 2063 6f6e 6361 7465 6e61  n name concatena
+0001fbb0: 7465 6420 7769 7468 2060 6023 6060 2066  ted with ``#`` f
+0001fbc0: 6f6c 6c6f 7765 6420 6279 2074 6865 2060  ollowed by the `
+0001fbd0: 606c 6f77 6060 2061 6e64 2060 6068 6967  `low`` and ``hig
+0001fbe0: 6860 6020 7661 6c75 6573 2e0a 2020 2020  h`` values..    
+0001fbf0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001fc00: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
+0001fc10: 7461 626c 655f 6461 7461 203d 2070 642e  table_data = pd.
+0001fc20: 4461 7461 4672 616d 6528 7b0a 2020 2020  DataFrame({.    
+0001fc30: 2020 2020 2020 2020 2763 7572 7265 6e74          'current
+0001fc40: 5f61 6765 273a 205b 3231 2c20 3232 2c20  _age': [21, 22, 
+0001fc50: 3235 5d2c 0a20 2020 2020 2020 2020 2020  25],.           
+0001fc60: 2027 6375 7272 656e 745f 6167 6523 3138   'current_age#18
+0001fc70: 2333 3527 3a20 5b31 2c20 322c 2033 5d0a  #35': [1, 2, 3].
+0001fc80: 2020 2020 2020 2020 7d29 0a20 2020 2020          }).     
+0001fc90: 2020 2069 6e73 7461 6e63 6520 3d20 5363     instance = Sc
+0001fca0: 616c 6172 5261 6e67 6528 2763 7572 7265  alarRange('curre
+0001fcb0: 6e74 5f61 6765 272c 2031 382c 2033 3529  nt_age', 18, 35)
+0001fcc0: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
+0001fcd0: 2020 2020 2020 2020 7472 616e 7366 6f72          transfor
+0001fce0: 6d65 645f 636f 6c75 6d6e 5f6e 616d 6520  med_column_name 
+0001fcf0: 3d20 696e 7374 616e 6365 2e5f 6765 745f  = instance._get_
+0001fd00: 6469 6666 5f63 6f6c 756d 6e5f 6e61 6d65  diff_column_name
+0001fd10: 2874 6162 6c65 5f64 6174 6129 0a0a 2020  (table_data)..  
+0001fd20: 2020 2020 2020 2320 4173 7365 7274 0a20        # Assert. 
+0001fd30: 2020 2020 2020 2061 7373 6572 7420 7472         assert tr
+0001fd40: 616e 7366 6f72 6d65 645f 636f 6c75 6d6e  ansformed_column
+0001fd50: 5f6e 616d 6520 3d3d 2027 6375 7272 656e  _name == 'curren
+0001fd60: 745f 6167 6523 2331 3823 2333 3527 0a0a  t_age##18##35'..
+0001fd70: 2020 2020 6465 6620 7465 7374 5f5f 6669      def test__fi
+0001fd80: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
+0001fd90: 2022 2222 5465 7374 2074 6865 2060 605f   """Test the ``_
+0001fda0: 6669 7460 6020 6d65 7468 6f64 206f 6620  fit`` method of 
+0001fdb0: 6060 5363 616c 6172 5261 6e67 6560 602e  ``ScalarRange``.
+0001fdc0: 0a0a 2020 2020 2020 2020 5465 7374 2074  ..        Test t
+0001fdd0: 6861 7420 7468 6520 6060 5f66 6974 6060  hat the ``_fit``
+0001fde0: 206d 6574 686f 6420 7374 6f72 6573 2074   method stores t
+0001fdf0: 6865 2070 726f 7065 7220 7472 616e 7366  he proper transf
+0001fe00: 6f72 6d61 7469 6f6e 2063 6f6c 756d 6e20  ormation column 
+0001fe10: 6e61 6d65 2061 6e64 0a20 2020 2020 2020  name and.       
+0001fe20: 206c 6561 726e 7320 7768 6574 6865 7220   learns whether 
+0001fe30: 7468 6520 6461 7461 2069 7320 6060 6461  the data is ``da
+0001fe40: 7465 7469 6d65 6060 6f72 206e 6f74 2061  tetime``or not a
+0001fe50: 6e64 2069 7427 7320 6060 6474 7970 6560  nd it's ``dtype`
+0001fe60: 602e 0a0a 2020 2020 2020 2020 5365 7475  `...        Setu
+0001fe70: 703a 0a20 2020 2020 2020 2020 2020 202d  p:.            -
+0001fe80: 2043 7265 6174 6520 6120 7064 2e44 6174   Create a pd.Dat
+0001fe90: 6146 7261 6d65 2077 6974 6820 6120 636f  aFrame with a co
+0001fea0: 6c75 6d6e 2e0a 2020 2020 2020 2020 2020  lumn..          
+0001feb0: 2020 2d20 496e 7374 616e 6365 206f 6620    - Instance of 
+0001fec0: 6060 5363 616c 6172 5261 6e67 6560 6020  ``ScalarRange`` 
+0001fed0: 636f 6e73 7472 6169 6e74 2077 6974 6820  constraint with 
+0001fee0: 7468 6f73 6520 7468 7265 6520 636f 6c75  those three colu
+0001fef0: 6d6e 206e 616d 6573 2e0a 0a20 2020 2020  mn names...     
+0001ff00: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
+0001ff10: 2020 2020 2020 2d20 7064 2e44 6174 6146        - pd.DataF
+0001ff20: 7261 6d65 2077 6974 6820 6060 6375 7272  rame with ``curr
+0001ff30: 656e 745f 6167 6560 6020 636f 6c75 6d6e  ent_age`` column
+0001ff40: 732e 0a0a 2020 2020 2020 2020 5369 6465  s...        Side
+0001ff50: 2045 6666 6563 743a 0a20 2020 2020 2020   Effect:.       
+0001ff60: 2020 2020 202d 2069 6e73 7461 6e63 6520       - instance 
+0001ff70: 6861 7320 6060 5f74 7261 6e73 666f 726d  has ``_transform
+0001ff80: 6564 5f63 6f6c 756d 6e60 6020 616e 6420  ed_column`` and 
+0001ff90: 6060 5f69 735f 6461 7465 7469 6d65 6060  ``_is_datetime``
+0001ffa0: 2061 6e64 2060 605f 6474 7970 6560 602e   and ``_dtype``.
+0001ffb0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001ffc0: 2020 2020 2023 2053 6574 7570 0a20 2020       # Setup.   
+0001ffd0: 2020 2020 2074 6162 6c65 5f64 6174 6120       table_data 
+0001ffe0: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
+0001fff0: 2763 7572 7265 6e74 5f61 6765 273a 205b  'current_age': [
+00020000: 3231 2c20 3232 2c20 3235 5d7d 290a 2020  21, 22, 25]}).  
+00020010: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
+00020020: 2053 6361 6c61 7252 616e 6765 2827 6375   ScalarRange('cu
+00020030: 7272 656e 745f 6167 6527 2c20 3138 2c20  rrent_age', 18, 
+00020040: 3230 290a 0a20 2020 2020 2020 2023 2052  20)..        # R
+00020050: 756e 0a20 2020 2020 2020 2069 6e73 7461  un.        insta
+00020060: 6e63 652e 5f66 6974 2874 6162 6c65 5f64  nce._fit(table_d
+00020070: 6174 6129 0a0a 2020 2020 2020 2020 2320  ata)..        # 
+00020080: 4173 7365 7274 0a20 2020 2020 2020 2061  Assert.        a
+00020090: 7373 6572 7420 6e6f 7420 696e 7374 616e  ssert not instan
+000200a0: 6365 2e5f 6973 5f64 6174 6574 696d 650a  ce._is_datetime.
+000200b0: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+000200c0: 6e73 7461 6e63 652e 5f74 7261 6e73 666f  nstance._transfo
+000200d0: 726d 6564 5f63 6f6c 756d 6e20 3d3d 2027  rmed_column == '
+000200e0: 6375 7272 656e 745f 6167 6523 3138 2332  current_age#18#2
+000200f0: 3027 0a0a 2020 2020 6465 6620 7465 7374  0'..    def test
+00020100: 5f5f 6669 745f 6461 7465 7469 6d65 2873  __fit_datetime(s
+00020110: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00020120: 2254 6573 7420 7468 6520 6060 5f66 6974  "Test the ``_fit
+00020130: 6060 206d 6574 686f 6420 6f66 2060 6053  `` method of ``S
+00020140: 6361 6c61 7252 616e 6765 6060 2077 6865  calarRange`` whe
+00020150: 6e20 6669 7474 696e 6720 7769 7468 2060  n fitting with `
+00020160: 6064 6174 6574 696d 6560 6020 6461 7461  `datetime`` data
+00020170: 2e0a 0a20 2020 2020 2020 2053 6574 7570  ...        Setup
+00020180: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+00020190: 7461 626c 655f 6461 7461 2077 6974 6820  table_data with 
+000201a0: 6461 7465 7469 6d65 732e 0a0a 2020 2020  datetimes...    
+000201b0: 2020 2020 5369 6465 2045 6666 6563 7473      Side Effects
+000201c0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+000201d0: 5468 6520 6060 696e 7374 616e 6365 2e5f  The ``instance._
+000201e0: 6c6f 775f 7661 6c75 6560 6020 616e 6420  low_value`` and 
+000201f0: 6060 c3ac 6e73 7461 6e63 652e 5f68 6967  ``..nstance._hig
+00020200: 685f 7661 6c75 6560 6020 6861 7665 2062  h_value`` have b
+00020210: 6565 6e20 636f 6e76 6572 7465 640a 2020  een converted.  
+00020220: 2020 2020 2020 2020 2020 2020 746f 2060              to `
+00020230: 6070 642e 6461 7465 7469 6d65 6060 0a20  `pd.datetime``. 
+00020240: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00020250: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
+00020260: 2020 2074 6162 6c65 5f64 6174 6120 3d20     table_data = 
+00020270: 7064 2e44 6174 6146 7261 6d65 287b 0a20  pd.DataFrame({. 
+00020280: 2020 2020 2020 2020 2020 2027 6368 6563             'chec
+00020290: 6b69 6e27 3a20 5b0a 2020 2020 2020 2020  kin': [.        
+000202a0: 2020 2020 2020 2020 7064 2e74 6f5f 6461          pd.to_da
+000202b0: 7465 7469 6d65 2827 3230 3232 2d30 352d  tetime('2022-05-
+000202c0: 3036 2729 2c0a 2020 2020 2020 2020 2020  06'),.          
+000202d0: 2020 2020 2020 7064 2e74 6f5f 6461 7465        pd.to_date
+000202e0: 7469 6d65 2827 3230 3232 2d30 352d 3037  time('2022-05-07
+000202f0: 2729 2c0a 2020 2020 2020 2020 2020 2020  '),.            
+00020300: 2020 2020 7064 2e74 6f5f 6461 7465 7469      pd.to_dateti
+00020310: 6d65 2827 3230 3232 2d30 352d 3038 2729  me('2022-05-08')
+00020320: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00020330: 2020 7064 2e74 6f5f 6461 7465 7469 6d65    pd.to_datetime
+00020340: 2827 3230 3232 2d30 352d 3039 2729 2c0a  ('2022-05-09'),.
+00020350: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+00020360: 2020 2020 2020 7d29 0a20 2020 2020 2020        }).       
+00020370: 2069 6e73 7461 6e63 6520 3d20 5363 616c   instance = Scal
+00020380: 6172 5261 6e67 6528 2763 6865 636b 696e  arRange('checkin
+00020390: 272c 2027 3230 3232 2d30 352d 3035 272c  ', '2022-05-05',
+000203a0: 2027 3230 3232 2d30 362d 3031 2729 0a0a   '2022-06-01')..
+000203b0: 2020 2020 2020 2020 2320 5275 6e0a 2020          # Run.  
+000203c0: 2020 2020 2020 696e 7374 616e 6365 2e5f        instance._
+000203d0: 6669 7428 7461 626c 655f 6461 7461 290a  fit(table_data).
+000203e0: 0a20 2020 2020 2020 2023 2041 7373 6572  .        # Asser
+000203f0: 740a 2020 2020 2020 2020 6173 7365 7274  t.        assert
+00020400: 2069 6e73 7461 6e63 652e 5f69 735f 6461   instance._is_da
+00020410: 7465 7469 6d65 0a20 2020 2020 2020 2061  tetime.        a
+00020420: 7373 6572 7420 696e 7374 616e 6365 2e5f  ssert instance._
+00020430: 7472 616e 7366 6f72 6d65 645f 636f 6c75  transformed_colu
+00020440: 6d6e 203d 3d20 2763 6865 636b 696e 2332  mn == 'checkin#2
+00020450: 3032 322d 3035 2d30 3523 3230 3232 2d30  022-05-05#2022-0
+00020460: 362d 3031 270a 2020 2020 2020 2020 6173  6-01'.        as
+00020470: 7365 7274 2069 6e73 7461 6e63 652e 5f6c  sert instance._l
+00020480: 6f77 5f76 616c 7565 203d 3d20 7064 2e74  ow_value == pd.t
+00020490: 6f5f 6461 7465 7469 6d65 2827 3230 3232  o_datetime('2022
+000204a0: 2d30 352d 3035 2729 0a20 2020 2020 2020  -05-05').       
+000204b0: 2061 7373 6572 7420 696e 7374 616e 6365   assert instance
+000204c0: 2e5f 6869 6768 5f76 616c 7565 203d 3d20  ._high_value == 
+000204d0: 7064 2e74 6f5f 6461 7465 7469 6d65 2827  pd.to_datetime('
+000204e0: 3230 3232 2d30 362d 3031 2729 0a0a 2020  2022-06-01')..  
+000204f0: 2020 6465 6620 7465 7374 5f69 735f 7661    def test_is_va
+00020500: 6c69 645f 6c74 2873 656c 6629 3a0a 2020  lid_lt(self):.  
+00020510: 2020 2020 2020 2222 2254 6573 7420 7468        """Test th
+00020520: 6520 6060 5363 616c 6172 5261 6e67 652e  e ``ScalarRange.
+00020530: 6973 5f76 616c 6964 6060 2e0a 0a20 2020  is_valid``...   
+00020540: 2020 2020 2054 6869 7320 7465 7374 2065       This test e
+00020550: 6e73 7572 6573 2074 6861 7420 7468 6520  nsures that the 
+00020560: 6060 6973 5f76 616c 6964 6060 206d 6574  ``is_valid`` met
+00020570: 686f 6420 776f 726b 7320 7769 7468 2074  hod works with t
+00020580: 6865 206f 7065 7261 746f 7220 6060 3c60  he operator ``<`
+00020590: 600a 2020 2020 2020 2020 2860 603c 6060  `.        (``<``
+000205a0: 2920 616e 6420 7661 6c69 6461 7465 7320  ) and validates 
+000205b0: 7468 6174 2074 6865 2060 6063 6f6c 756d  that the ``colum
+000205c0: 6e5f 6e61 6d65 6060 2069 7320 6265 7477  n_name`` is betw
+000205d0: 6565 6e20 6060 6c6f 775f 7661 6c75 6560  een ``low_value`
+000205e0: 6020 616e 640a 2020 2020 2020 2020 6060  ` and.        ``
+000205f0: 6869 6768 5f76 616c 7565 6060 2e0a 0a20  high_value``... 
+00020600: 2020 2020 2020 2053 6574 7570 3a0a 2020         Setup:.  
+00020610: 2020 2020 2020 2020 2020 2d20 4372 6561            - Crea
+00020620: 7465 2061 2070 642e 4461 7461 4672 616d  te a pd.DataFram
+00020630: 652e 0a20 2020 2020 2020 2020 2020 202d  e..            -
+00020640: 2049 6e73 7461 6e63 6520 6f66 2060 6053   Instance of ``S
+00020650: 6361 6c61 7252 616e 6765 6060 2063 6f6e  calarRange`` con
+00020660: 7374 7261 696e 7420 7769 7468 206c 6f77  straint with low
+00020670: 2061 6e64 2068 6967 6820 7661 6c75 6573   and high values
+00020680: 2074 6861 7420 6172 6520 7769 7468 696e   that are within
+00020690: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+000206a0: 2020 2065 7870 6563 7465 6420 7261 6e67     expected rang
+000206b0: 652e 0a0a 2020 2020 2020 2020 496e 7075  e...        Inpu
+000206c0: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
+000206d0: 2070 642e 4461 7461 4672 616d 6520 7769   pd.DataFrame wi
+000206e0: 7468 2060 6063 7572 7265 6e74 5f61 6765  th ``current_age
+000206f0: 6060 2063 6f6c 756d 6e2e 0a20 2020 2020  `` column..     
+00020700: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00020710: 2053 6574 7570 0a20 2020 2020 2020 2074   Setup.        t
+00020720: 6162 6c65 5f64 6174 6120 3d20 7064 2e44  able_data = pd.D
+00020730: 6174 6146 7261 6d65 287b 2763 7572 7265  ataFrame({'curre
+00020740: 6e74 5f61 6765 273a 205b 3231 2c20 3232  nt_age': [21, 22
+00020750: 2c20 3235 5d7d 290a 2020 2020 2020 2020  , 25]}).        
+00020760: 696e 7374 616e 6365 203d 2053 6361 6c61  instance = Scala
+00020770: 7252 616e 6765 2827 6375 7272 656e 745f  rRange('current_
+00020780: 6167 6527 2c20 3230 2c20 3236 290a 0a20  age', 20, 26).. 
+00020790: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
+000207a0: 2020 2020 2072 6573 756c 7420 3d20 696e       result = in
+000207b0: 7374 616e 6365 2e69 735f 7661 6c69 6428  stance.is_valid(
+000207c0: 7461 626c 655f 6461 7461 290a 0a20 2020  table_data)..   
+000207d0: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
+000207e0: 2020 2020 2020 6173 7365 7274 2061 6c6c        assert all
+000207f0: 2872 6573 756c 7429 0a0a 2020 2020 6465  (result)..    de
+00020800: 6620 7465 7374 5f69 735f 7661 6c69 645f  f test_is_valid_
+00020810: 6c65 2873 656c 6629 3a0a 2020 2020 2020  le(self):.      
+00020820: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
+00020830: 5363 616c 6172 5261 6e67 652e 6973 5f76  ScalarRange.is_v
+00020840: 616c 6964 6060 2e0a 0a20 2020 2020 2020  alid``...       
+00020850: 2054 6869 7320 7465 7374 2065 6e73 7572   This test ensur
+00020860: 6573 2074 6861 7420 7468 6520 6060 6973  es that the ``is
+00020870: 5f76 616c 6964 6060 206d 6574 686f 6420  _valid`` method 
+00020880: 776f 726b 7320 7769 7468 2074 6865 206f  works with the o
+00020890: 7065 7261 746f 720a 2020 2020 2020 2020  perator.        
+000208a0: 6060 3c3d 6060 2061 6e64 2076 616c 6964  ``<=`` and valid
+000208b0: 6174 6573 2074 6861 7420 7468 6520 6060  ates that the ``
+000208c0: 636f 6c75 6d6e 5f6e 616d 6560 6020 6973  column_name`` is
+000208d0: 0a20 2020 2020 2020 2062 6574 7765 656e  .        between
+000208e0: 2060 606c 6f77 5f76 616c 7565 6060 2061   ``low_value`` a
+000208f0: 6e64 2060 6068 6967 685f 7661 6c75 6560  nd ``high_value`
+00020900: 602e 0a0a 2020 2020 2020 2020 5365 7475  `...        Setu
+00020910: 703a 0a20 2020 2020 2020 2020 2020 202d  p:.            -
+00020920: 2043 7265 6174 6520 6120 7064 2e44 6174   Create a pd.Dat
+00020930: 6146 7261 6d65 2e0a 2020 2020 2020 2020  aFrame..        
+00020940: 2020 2020 2d20 496e 7374 616e 6365 206f      - Instance o
+00020950: 6620 6060 5363 616c 6172 5261 6e67 6560  f ``ScalarRange`
+00020960: 6020 636f 6e73 7472 6169 6e74 2077 6974  ` constraint wit
+00020970: 6820 6c6f 7720 616e 6420 6869 6768 2076  h low and high v
+00020980: 616c 7565 7320 7468 6174 2061 7265 2077  alues that are w
+00020990: 6974 6869 6e20 7468 650a 2020 2020 2020  ithin the.      
+000209a0: 2020 2020 2020 2020 6578 7065 6374 6564          expected
+000209b0: 2072 616e 6765 2061 6e64 2075 7369 6e67   range and using
+000209c0: 2060 6073 7472 6963 745f 626f 756e 6461   ``strict_bounda
+000209d0: 7269 6573 6060 2061 7320 6060 4661 6c73  ries`` as ``Fals
+000209e0: 6560 602e 0a0a 2020 2020 2020 2020 496e  e``...        In
+000209f0: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
+00020a00: 202d 2070 642e 4461 7461 4672 616d 6520   - pd.DataFrame 
+00020a10: 7769 7468 2060 6063 7572 7265 6e74 5f61  with ``current_a
+00020a20: 6765 6060 2063 6f6c 756d 6e2e 0a20 2020  ge`` column..   
+00020a30: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00020a40: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
+00020a50: 2074 6162 6c65 5f64 6174 6120 3d20 7064   table_data = pd
+00020a60: 2e44 6174 6146 7261 6d65 287b 2763 7572  .DataFrame({'cur
+00020a70: 7265 6e74 5f61 6765 273a 205b 3231 2c20  rent_age': [21, 
+00020a80: 3232 2c20 3235 5d7d 290a 2020 2020 2020  22, 25]}).      
+00020a90: 2020 696e 7374 616e 6365 203d 2053 6361    instance = Sca
+00020aa0: 6c61 7252 616e 6765 2827 6375 7272 656e  larRange('curren
+00020ab0: 745f 6167 6527 2c20 3231 2c20 3235 2c20  t_age', 21, 25, 
+00020ac0: 7374 7269 6374 5f62 6f75 6e64 6172 6965  strict_boundarie
+00020ad0: 733d 4661 6c73 6529 0a0a 2020 2020 2020  s=False)..      
+00020ae0: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
+00020af0: 7265 7375 6c74 203d 2069 6e73 7461 6e63  result = instanc
+00020b00: 652e 6973 5f76 616c 6964 2874 6162 6c65  e.is_valid(table
+00020b10: 5f64 6174 6129 0a0a 2020 2020 2020 2020  _data)..        
+00020b20: 2320 4173 7365 7274 0a20 2020 2020 2020  # Assert.       
+00020b30: 2061 7373 6572 7420 616c 6c28 7265 7375   assert all(resu
+00020b40: 6c74 290a 0a20 2020 2064 6566 2074 6573  lt)..    def tes
+00020b50: 745f 6973 5f76 616c 6964 5f69 6e76 616c  t_is_valid_inval
+00020b60: 6964 2873 656c 6629 3a0a 2020 2020 2020  id(self):.      
+00020b70: 2020 2222 2254 6573 7420 7468 6520 6060    """Test the ``
+00020b80: 5363 616c 6172 5261 6e67 652e 6973 5f76  ScalarRange.is_v
+00020b90: 616c 6964 6060 2e0a 0a20 2020 2020 2020  alid``...       
+00020ba0: 2054 6869 7320 7465 7374 2065 6e73 7572   This test ensur
+00020bb0: 6573 2074 6861 7420 7468 6520 6060 6973  es that the ``is
+00020bc0: 5f76 616c 6964 6060 2066 6169 6c73 2077  _valid`` fails w
+00020bd0: 6865 6e20 7468 6520 6461 7461 2069 7320  hen the data is 
+00020be0: 6e6f 7420 696e 2074 6865 2072 616e 6765  not in the range
+00020bf0: 2e0a 0a20 2020 2020 2020 2053 6574 7570  ...        Setup
+00020c00: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+00020c10: 4372 6561 7465 2061 2070 642e 4461 7461  Create a pd.Data
+00020c20: 4672 616d 6520 7769 7468 2060 6063 7572  Frame with ``cur
+00020c30: 7265 6e74 5f61 6765 6060 2063 6f6c 756d  rent_age`` colum
+00020c40: 6e2e 0a20 2020 2020 2020 2020 2020 202d  n..            -
+00020c50: 2049 6e73 7461 6e63 6520 6f66 2060 6053   Instance of ``S
+00020c60: 6361 6c61 7252 616e 6765 6060 2063 6f6e  calarRange`` con
+00020c70: 7374 7261 696e 7420 7769 7468 2060 606c  straint with ``l
+00020c80: 6f77 5f76 616c 7565 6060 2068 6967 6865  ow_value`` highe
+00020c90: 7220 7468 616e 2074 6865 0a20 2020 2020  r than the.     
+00020ca0: 2020 2020 2020 2020 206c 6f77 2076 616c           low val
+00020cb0: 7565 2069 6e20 6060 6375 7272 656e 745f  ue in ``current_
+00020cc0: 6167 6560 6020 616e 6420 6869 6768 2076  age`` and high v
+00020cd0: 616c 7565 206c 6f77 6572 2074 6861 6e20  alue lower than 
+00020ce0: 7468 6520 6869 6768 6572 2076 616c 7565  the higher value
+00020cf0: 2069 6e20 7468 650a 2020 2020 2020 2020   in the.        
+00020d00: 2020 2020 2020 6060 6375 7272 656e 745f        ``current_
+00020d10: 6167 6560 602e 0a0a 2020 2020 2020 2020  age``...        
+00020d20: 496e 7075 743a 0a20 2020 2020 2020 2020  Input:.         
+00020d30: 2020 202d 2070 642e 4461 7461 4672 616d     - pd.DataFram
+00020d40: 6520 7769 7468 2060 6063 7572 7265 6e74  e with ``current
+00020d50: 5f61 6765 6060 2063 6f6c 756d 6e2e 0a20  _age`` column.. 
+00020d60: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00020d70: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
+00020d80: 2020 2074 6162 6c65 5f64 6174 6120 3d20     table_data = 
+00020d90: 7064 2e44 6174 6146 7261 6d65 287b 2763  pd.DataFrame({'c
+00020da0: 7572 7265 6e74 5f61 6765 273a 205b 3231  urrent_age': [21
+00020db0: 2c20 3232 2c20 3235 5d7d 290a 2020 2020  , 22, 25]}).    
+00020dc0: 2020 2020 696e 7374 616e 6365 203d 2053      instance = S
+00020dd0: 6361 6c61 7252 616e 6765 2827 6375 7272  calarRange('curr
+00020de0: 656e 745f 6167 6527 2c20 3238 2c20 3138  ent_age', 28, 18
+00020df0: 2c20 7374 7269 6374 5f62 6f75 6e64 6172  , strict_boundar
+00020e00: 6965 733d 4661 6c73 6529 0a0a 2020 2020  ies=False)..    
+00020e10: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
+00020e20: 2020 7265 7375 6c74 203d 2069 6e73 7461    result = insta
+00020e30: 6e63 652e 6973 5f76 616c 6964 2874 6162  nce.is_valid(tab
+00020e40: 6c65 5f64 6174 6129 0a0a 2020 2020 2020  le_data)..      
+00020e50: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
+00020e60: 2020 2061 7373 6572 7420 6e6f 7420 616c     assert not al
+00020e70: 6c28 7265 7375 6c74 290a 0a20 2020 2040  l(result)..    @
+00020e80: 7061 7463 6828 2773 6476 2e63 6f6e 7374  patch('sdv.const
+00020e90: 7261 696e 7473 2e74 6162 756c 6172 2e6c  raints.tabular.l
+00020ea0: 6f67 6974 2729 0a20 2020 2064 6566 2074  ogit').    def t
+00020eb0: 6573 745f 5f74 7261 6e73 666f 726d 2873  est__transform(s
+00020ec0: 656c 662c 206d 6f63 6b5f 6c6f 6769 7429  elf, mock_logit)
+00020ed0: 3a0a 2020 2020 2020 2020 2222 2254 6573  :.        """Tes
+00020ee0: 7420 7468 6520 6060 5363 616c 6172 5261  t the ``ScalarRa
+00020ef0: 6e67 652e 5f74 7261 6e73 666f 726d 6060  nge._transform``
+00020f00: 206d 6574 686f 642e 0a0a 2020 2020 2020   method...      
+00020f10: 2020 4974 2069 7320 6578 7065 6374 6564    It is expected
+00020f20: 2074 6f20 6372 6561 7465 2061 206e 6577   to create a new
+00020f30: 2063 6f6c 756d 6e20 7369 6d69 6c61 7220   column similar 
+00020f40: 746f 2074 6865 2063 6f6e 7374 7261 696e  to the constrain
+00020f50: 7420 6060 636f 6c75 6d6e 6060 2c20 616e  t ``column``, an
+00020f60: 6420 7468 656e 0a20 2020 2020 2020 2073  d then.        s
+00020f70: 6361 6c65 2061 6e64 2061 7070 6c79 2061  cale and apply a
+00020f80: 206c 6f67 6974 2066 756e 6374 696f 6e20   logit function 
+00020f90: 746f 2074 6861 7420 636f 6c75 6d6e 2e0a  to that column..
+00020fa0: 0a20 2020 2020 2020 204d 6f63 6b3a 0a20  .        Mock:. 
+00020fb0: 2020 2020 2020 2020 2020 202d 206d 6f63             - moc
+00020fc0: 6b20 7468 6520 6c6f 6769 7420 6675 6e63  k the logit func
+00020fd0: 7469 6f6e 2e0a 2020 2020 2020 2020 496e  tion..        In
+00020fe0: 7075 743a 0a20 2020 2020 2020 2020 2020  put:.           
+00020ff0: 202d 2070 642e 4461 7461 4672 616d 6520   - pd.DataFrame 
+00021000: 7769 7468 2060 6063 7572 7265 6e74 5f61  with ``current_a
+00021010: 6765 6060 2063 6f6c 756d 6e2e 0a0a 2020  ge`` column...  
+00021020: 2020 2020 2020 4f75 7470 7574 3a0a 2020        Output:.  
+00021030: 2020 2020 2020 2020 2020 2d20 7064 2e44            - pd.D
+00021040: 6174 6146 7261 6d65 2077 6974 6820 7468  ataFrame with th
+00021050: 6520 7472 616e 7366 6f72 6d65 6420 6060  e transformed ``
+00021060: 6375 7272 656e 745f 6167 6560 602e 0a20  current_age``.. 
+00021070: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00021080: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
+00021090: 2020 2074 6162 6c65 5f64 6174 6120 3d20     table_data = 
+000210a0: 7064 2e44 6174 6146 7261 6d65 287b 2763  pd.DataFrame({'c
+000210b0: 7572 7265 6e74 5f61 6765 273a 205b 3231  urrent_age': [21
+000210c0: 2c20 3232 2c20 3235 5d7d 290a 2020 2020  , 22, 25]}).    
+000210d0: 2020 2020 696e 7374 616e 6365 203d 2053      instance = S
+000210e0: 6361 6c61 7252 616e 6765 2827 6375 7272  calarRange('curr
+000210f0: 656e 745f 6167 6527 2c20 3230 2c20 3238  ent_age', 20, 28
+00021100: 290a 2020 2020 2020 2020 6d6f 636b 5f6c  ).        mock_l
+00021110: 6f67 6974 2e72 6574 7572 6e5f 7661 6c75  ogit.return_valu
+00021120: 6520 3d20 5b31 2c20 322c 2033 5d0a 0a20  e = [1, 2, 3].. 
+00021130: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
+00021140: 2020 2020 2069 6e73 7461 6e63 652e 6669       instance.fi
+00021150: 7428 7461 626c 655f 6461 7461 290a 2020  t(table_data).  
+00021160: 2020 2020 2020 6f75 7420 3d20 696e 7374        out = inst
+00021170: 616e 6365 2e5f 7472 616e 7366 6f72 6d28  ance._transform(
+00021180: 7461 626c 655f 6461 7461 290a 0a20 2020  table_data)..   
+00021190: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
+000211a0: 2020 2020 2020 6578 7065 6374 6564 5f6f        expected_o
+000211b0: 7574 203d 2070 642e 4461 7461 4672 616d  ut = pd.DataFram
+000211c0: 6528 7b27 6375 7272 656e 745f 6167 6523  e({'current_age#
+000211d0: 3230 2332 3827 3a20 5b31 2c20 322c 2033  20#28': [1, 2, 3
+000211e0: 5d7d 290a 2020 2020 2020 2020 7064 2e74  ]}).        pd.t
+000211f0: 6573 7469 6e67 2e61 7373 6572 745f 6672  esting.assert_fr
+00021200: 616d 655f 6571 7561 6c28 6578 7065 6374  ame_equal(expect
+00021210: 6564 5f6f 7574 2c20 6f75 7429 0a0a 2020  ed_out, out)..  
+00021220: 2020 4070 6174 6368 2827 7364 762e 636f    @patch('sdv.co
+00021230: 6e73 7472 6169 6e74 732e 7461 6275 6c61  nstraints.tabula
+00021240: 722e 7369 676d 6f69 6427 290a 2020 2020  r.sigmoid').    
+00021250: 6465 6620 7465 7374 5f72 6576 6572 7365  def test_reverse
+00021260: 5f74 7261 6e73 666f 726d 2873 656c 662c  _transform(self,
+00021270: 206d 6f63 6b5f 7369 676d 6f69 6429 3a0a   mock_sigmoid):.
+00021280: 2020 2020 2020 2020 2222 2254 6573 7420          """Test 
+00021290: 7468 6520 6060 7265 7665 7273 655f 7472  the ``reverse_tr
+000212a0: 616e 7366 6f72 6d60 6020 6d65 7468 6f64  ansform`` method
+000212b0: 2066 6f72 2060 6053 6361 6c61 7252 616e   for ``ScalarRan
+000212c0: 6765 6060 2e0a 0a20 2020 2020 2020 2049  ge``...        I
+000212d0: 7420 6973 2065 7870 6563 7465 6420 746f  t is expected to
+000212e0: 2072 6563 6f76 6572 2074 6865 206f 7269   recover the ori
+000212f0: 6769 6e61 6c20 7461 626c 6520 7768 6963  ginal table whic
+00021300: 6820 7761 7320 7472 616e 7366 6f72 6d65  h was transforme
+00021310: 642c 2062 7574 2077 6974 6820 6469 6666  d, but with diff
+00021320: 6572 656e 740a 2020 2020 2020 2020 636f  erent.        co
+00021330: 6c75 6d6e 206f 7264 6572 2e20 4974 2064  lumn order. It d
+00021340: 6f65 7320 736f 2062 7920 6170 706c 7969  oes so by applyi
+00021350: 6e67 2061 2073 6967 6d6f 6964 2074 6f20  ng a sigmoid to 
+00021360: 7468 6520 7472 616e 7366 6f72 6d65 6420  the transformed 
+00021370: 636f 6c75 6d6e 2061 6e64 2074 6865 6e0a  column and then.
+00021380: 2020 2020 2020 2020 7363 616c 696e 6720          scaling 
+00021390: 6974 2062 6163 6b20 746f 2074 6865 206f  it back to the o
+000213a0: 7269 6769 6e61 6c20 7370 6163 652e 2049  riginal space. I
+000213b0: 7420 616c 736f 2072 6570 6c61 6365 7320  t also replaces 
+000213c0: 7468 6520 7472 616e 7366 6f72 6d65 6420  the transformed 
+000213d0: 636f 6c75 6d6e 2077 6974 680a 2020 2020  column with.    
+000213e0: 2020 2020 616e 2065 7175 616c 2063 6f6c      an equal col
+000213f0: 756d 6e20 6275 7420 7769 7468 2074 6865  umn but with the
+00021400: 206f 7269 6769 6e61 6c20 6e61 6d65 2e0a   original name..
+00021410: 0a20 2020 2020 2020 204d 6f63 6b3a 0a20  .        Mock:. 
+00021420: 2020 2020 2020 2020 2020 202d 204d 6f63             - Moc
+00021430: 6b20 7468 6520 7369 676d 6f69 6420 6675  k the sigmoid fu
+00021440: 6e63 7469 6f6e 2e0a 0a20 2020 2020 2020  nction...       
+00021450: 2053 6574 7570 3a0a 2020 2020 2020 2020   Setup:.        
+00021460: 2020 2020 2d20 4f72 6967 696e 616c 2074      - Original t
+00021470: 6162 6c65 2064 6174 612e 0a20 2020 2020  able data..     
+00021480: 2020 2020 2020 202d 2041 6e20 6578 7065         - An expe
+00021490: 6374 6564 2074 7261 6e73 666f 726d 6564  cted transformed
+000214a0: 2064 6174 612e 0a20 2020 2020 2020 2020   data..         
+000214b0: 2020 202d 2049 6e73 7461 6e63 6520 6f66     - Instance of
+000214c0: 2053 6361 6c61 7252 616e 6765 2063 6f6e   ScalarRange con
+000214d0: 7374 7261 696e 742e 0a0a 2020 2020 2020  straint...      
+000214e0: 2020 4f75 7470 7574 3a0a 2020 2020 2020    Output:.      
+000214f0: 2020 2020 2020 2d20 4120 7064 2e44 6174        - A pd.Dat
+00021500: 6146 7261 6d65 2063 6f6e 7461 696e 696e  aFrame containin
+00021510: 6720 7468 6520 6f72 6967 696e 616c 2064  g the original d
+00021520: 6174 612e 0a20 2020 2020 2020 2022 2222  ata..        """
+00021530: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+00021540: 0a20 2020 2020 2020 2074 6162 6c65 5f64  .        table_d
+00021550: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
+00021560: 6d65 287b 2763 7572 7265 6e74 5f61 6765  me({'current_age
+00021570: 273a 205b 3231 2c20 3232 2c20 3235 5d7d  ': [21, 22, 25]}
+00021580: 290a 2020 2020 2020 2020 7472 616e 7366  ).        transf
+00021590: 6f72 6d65 645f 6461 7461 203d 2070 642e  ormed_data = pd.
+000215a0: 4461 7461 4672 616d 6528 7b27 6375 7272  DataFrame({'curr
+000215b0: 656e 745f 6167 6523 3230 2332 3827 3a20  ent_age#20#28': 
+000215c0: 5b31 2c20 322c 2033 5d7d 290a 2020 2020  [1, 2, 3]}).    
+000215d0: 2020 2020 6d6f 636b 5f73 6967 6d6f 6964      mock_sigmoid
+000215e0: 2e72 6574 7572 6e5f 7661 6c75 6520 3d20  .return_value = 
+000215f0: 7064 2e53 6572 6965 7328 5b32 312c 2032  pd.Series([21, 2
+00021600: 322c 2032 355d 290a 2020 2020 2020 2020  2, 25]).        
+00021610: 696e 7374 616e 6365 203d 2053 6361 6c61  instance = Scala
+00021620: 7252 616e 6765 2827 6375 7272 656e 745f  rRange('current_
+00021630: 6167 6527 2c20 3230 2c20 3238 290a 0a20  age', 20, 28).. 
+00021640: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
+00021650: 2020 2020 2069 6e73 7461 6e63 652e 6669       instance.fi
+00021660: 7428 7461 626c 655f 6461 7461 290a 2020  t(table_data).  
+00021670: 2020 2020 2020 6f75 7420 3d20 696e 7374        out = inst
+00021680: 616e 6365 2e72 6576 6572 7365 5f74 7261  ance.reverse_tra
+00021690: 6e73 666f 726d 2874 7261 6e73 666f 726d  nsform(transform
+000216a0: 6564 5f64 6174 6129 0a0a 2020 2020 2020  ed_data)..      
+000216b0: 2020 2320 4173 7365 7274 0a20 2020 2020    # Assert.     
+000216c0: 2020 2070 642e 7465 7374 696e 672e 6173     pd.testing.as
+000216d0: 7365 7274 5f66 7261 6d65 5f65 7175 616c  sert_frame_equal
+000216e0: 2874 6162 6c65 5f64 6174 612c 206f 7574  (table_data, out
+000216f0: 290a 2020 2020 2020 2020 6d6f 636b 5f73  ).        mock_s
+00021700: 6967 6d6f 6964 2e61 7373 6572 745f 6361  igmoid.assert_ca
+00021710: 6c6c 6564 5f6f 6e63 6528 290a 0a20 2020  lled_once()..   
+00021720: 2040 7061 7463 6828 2773 6476 2e63 6f6e   @patch('sdv.con
+00021730: 7374 7261 696e 7473 2e74 6162 756c 6172  straints.tabular
+00021740: 2e70 6427 290a 2020 2020 4070 6174 6368  .pd').    @patch
+00021750: 2827 7364 762e 636f 6e73 7472 6169 6e74  ('sdv.constraint
+00021760: 732e 7461 6275 6c61 722e 7369 676d 6f69  s.tabular.sigmoi
+00021770: 6427 290a 2020 2020 6465 6620 7465 7374  d').    def test
+00021780: 5f72 6576 6572 7365 5f74 7261 6e73 666f  _reverse_transfo
+00021790: 726d 5f69 735f 6461 7465 7469 6d65 2873  rm_is_datetime(s
+000217a0: 656c 662c 206d 6f63 6b5f 7369 676d 6f69  elf, mock_sigmoi
+000217b0: 642c 206d 6f63 6b5f 7064 293a 0a20 2020  d, mock_pd):.   
+000217c0: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+000217d0: 2060 6072 6576 6572 7365 5f74 7261 6e73   ``reverse_trans
+000217e0: 666f 726d 6060 206d 6574 686f 6420 666f  form`` method fo
+000217f0: 7220 6060 5363 616c 6172 5261 6e67 6560  r ``ScalarRange`
+00021800: 602e 0a0a 2020 2020 2020 2020 5768 656e  `...        When
+00021810: 2060 6069 6e73 7461 6e63 652e 5f69 735f   ``instance._is_
+00021820: 6461 7465 7469 6d65 6060 2069 7320 6060  datetime`` is ``
+00021830: 5472 7565 6060 2c20 7468 6520 6461 7461  True``, the data
+00021840: 2073 686f 756c 6420 6265 2063 6f6e 7665   should be conve
+00021850: 7274 6564 0a20 2020 2020 2020 2074 6f20  rted.        to 
+00021860: 6060 7061 6e64 6173 2e74 6f5f 6461 7465  ``pandas.to_date
+00021870: 7469 6d65 6060 2e0a 0a20 2020 2020 2020  time``...       
+00021880: 204d 6f63 6b3a 0a20 2020 2020 2020 2020   Mock:.         
+00021890: 2020 202d 204d 6f63 6b20 7468 6520 7369     - Mock the si
+000218a0: 676d 6f69 6420 6675 6e63 7469 6f6e 2e0a  gmoid function..
+000218b0: 2020 2020 2020 2020 2020 2020 2d20 4d6f              - Mo
+000218c0: 636b 2070 616e 6461 732e 0a0a 2020 2020  ck pandas...    
+000218d0: 2020 2020 5365 7475 703a 0a20 2020 2020      Setup:.     
+000218e0: 2020 2020 2020 202d 204f 7269 6769 6e61         - Origina
+000218f0: 6c20 7461 626c 6520 6461 7461 2e0a 2020  l table data..  
+00021900: 2020 2020 2020 2020 2020 2d20 416e 2065            - An e
+00021910: 7870 6563 7465 6420 7472 616e 7366 6f72  xpected transfor
+00021920: 6d65 6420 6461 7461 2e0a 2020 2020 2020  med data..      
+00021930: 2020 2020 2020 2d20 496e 7374 616e 6365        - Instance
+00021940: 206f 6620 5363 616c 6172 5261 6e67 6520   of ScalarRange 
+00021950: 636f 6e73 7472 6169 6e74 2e0a 0a20 2020  constraint...   
+00021960: 2020 2020 204f 7574 7075 743a 0a20 2020       Output:.   
+00021970: 2020 2020 2020 2020 202d 2041 2070 642e           - A pd.
+00021980: 4461 7461 4672 616d 6520 636f 6e74 6169  DataFrame contai
+00021990: 6e69 6e67 2074 6865 206f 7269 6769 6e61  ning the origina
+000219a0: 6c20 6461 7461 2e0a 0a20 2020 2020 2020  l data...       
+000219b0: 2053 6964 6520 4566 6665 6374 733a 0a20   Side Effects:. 
+000219c0: 2020 2020 2020 2020 2020 202d 2060 606d             - ``m
+000219d0: 6f63 6b5f 7064 6060 2068 6173 2074 6f20  ock_pd`` has to 
+000219e0: 6265 2063 616c 6c65 6420 6f6e 6365 2e0a  be called once..
+000219f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00021a00: 2020 2020 2320 5365 7475 700a 2020 2020      # Setup.    
+00021a10: 2020 2020 7472 616e 7366 6f72 6d65 645f      transformed_
+00021a20: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
+00021a30: 616d 6528 7b27 6375 7272 656e 745f 6167  ame({'current_ag
+00021a40: 6523 3230 2332 3827 3a20 5b31 2c20 322c  e#20#28': [1, 2,
+00021a50: 2033 5d7d 290a 2020 2020 2020 2020 6d6f   3]}).        mo
+00021a60: 636b 5f73 6967 6d6f 6964 2e72 6574 7572  ck_sigmoid.retur
+00021a70: 6e5f 7661 6c75 6520 3d20 7064 2e53 6572  n_value = pd.Ser
+00021a80: 6965 7328 5b32 312c 2032 322c 2032 355d  ies([21, 22, 25]
+00021a90: 290a 2020 2020 2020 2020 696e 7374 616e  ).        instan
+00021aa0: 6365 203d 2053 6361 6c61 7252 616e 6765  ce = ScalarRange
+00021ab0: 2827 6375 7272 656e 745f 6167 6527 2c20  ('current_age', 
+00021ac0: 3230 2c20 3238 290a 2020 2020 2020 2020  20, 28).        
+00021ad0: 696e 7374 616e 6365 2e5f 7472 616e 7366  instance._transf
+00021ae0: 6f72 6d65 645f 636f 6c75 6d6e 203d 2027  ormed_column = '
+00021af0: 6375 7272 656e 745f 6167 6523 3230 2332  current_age#20#2
+00021b00: 3827 0a20 2020 2020 2020 2069 6e73 7461  8'.        insta
+00021b10: 6e63 652e 5f69 735f 6461 7465 7469 6d65  nce._is_datetime
+00021b20: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
+00021b30: 6d6f 636b 5f70 642e 746f 5f64 6174 6574  mock_pd.to_datet
+00021b40: 696d 652e 7369 6465 5f65 6666 6563 7420  ime.side_effect 
+00021b50: 3d20 6c61 6d62 6461 2078 3a20 7064 2e74  = lambda x: pd.t
+00021b60: 6f5f 6461 7465 7469 6d65 2827 3230 3231  o_datetime('2021
+00021b70: 2d30 322d 3032 2031 303a 3130 3a35 3927  -02-02 10:10:59'
+00021b80: 290a 0a20 2020 2020 2020 2023 2052 756e  )..        # Run
+00021b90: 0a20 2020 2020 2020 206f 7574 7075 7420  .        output 
+00021ba0: 3d20 696e 7374 616e 6365 2e72 6576 6572  = instance.rever
+00021bb0: 7365 5f74 7261 6e73 666f 726d 2874 7261  se_transform(tra
+00021bc0: 6e73 666f 726d 6564 5f64 6174 6129 0a0a  nsformed_data)..
+00021bd0: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
+00021be0: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+00021bf0: 645f 6f75 7470 7574 203d 2070 642e 4461  d_output = pd.Da
+00021c00: 7461 4672 616d 6528 7b0a 2020 2020 2020  taFrame({.      
+00021c10: 2020 2020 2020 2763 7572 7265 6e74 5f61        'current_a
+00021c20: 6765 273a 205b 0a20 2020 2020 2020 2020  ge': [.         
+00021c30: 2020 2020 2020 2070 642e 746f 5f64 6174         pd.to_dat
+00021c40: 6574 696d 6528 2732 3032 312d 3032 2d30  etime('2021-02-0
+00021c50: 3220 3130 3a31 303a 3539 2729 2c0a 2020  2 10:10:59'),.  
+00021c60: 2020 2020 2020 2020 2020 2020 2020 7064                pd
+00021c70: 2e74 6f5f 6461 7465 7469 6d65 2827 3230  .to_datetime('20
+00021c80: 3231 2d30 322d 3032 2031 303a 3130 3a35  21-02-02 10:10:5
+00021c90: 3927 292c 0a20 2020 2020 2020 2020 2020  9'),.           
+00021ca0: 2020 2020 2070 642e 746f 5f64 6174 6574       pd.to_datet
+00021cb0: 696d 6528 2732 3032 312d 3032 2d30 3220  ime('2021-02-02 
+00021cc0: 3130 3a31 303a 3539 2729 2c0a 2020 2020  10:10:59'),.    
+00021cd0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+00021ce0: 2020 7d29 0a20 2020 2020 2020 2070 642e    }).        pd.
+00021cf0: 7465 7374 696e 672e 6173 7365 7274 5f66  testing.assert_f
+00021d00: 7261 6d65 5f65 7175 616c 2865 7870 6563  rame_equal(expec
+00021d10: 7465 645f 6f75 7470 7574 2c20 6f75 7470  ted_output, outp
+00021d20: 7574 290a 2020 2020 2020 2020 6d6f 636b  ut).        mock
+00021d30: 5f73 6967 6d6f 6964 2e61 7373 6572 745f  _sigmoid.assert_
+00021d40: 6361 6c6c 6564 5f6f 6e63 6528 290a 2020  called_once().  
+00021d50: 2020 2020 2020 6173 7365 7274 206d 6f63        assert moc
+00021d60: 6b5f 7064 2e74 6f5f 6461 7465 7469 6d65  k_pd.to_datetime
+00021d70: 2e63 616c 6c5f 636f 756e 7420 3d3d 2031  .call_count == 1
+00021d80: 0a0a 0a63 6c61 7373 2054 6573 744f 6e65  ...class TestOne
+00021d90: 486f 7445 6e63 6f64 696e 6728 293a 0a0a  HotEncoding():..
+00021da0: 2020 2020 6465 6620 7465 7374 5f5f 7661      def test__va
+00021db0: 6c69 6461 7465 5f69 6e70 7574 7328 7365  lidate_inputs(se
+00021dc0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00021dd0: 5465 7374 2074 6865 2060 604f 6e65 486f  Test the ``OneHo
+00021de0: 7445 6e63 6f64 696e 672e 5f76 616c 6964  tEncoding._valid
+00021df0: 6174 655f 696e 7075 7473 6060 206d 6574  ate_inputs`` met
+00021e00: 686f 642e 0a0a 2020 2020 2020 2020 496e  hod...        In
+00021e10: 7075 743a 0a20 2020 2020 2020 202d 2020  put:.        -  
+00021e20: 496e 636f 7272 6563 7420 7061 7261 6d65  Incorrect parame
+00021e30: 7465 7273 2066 6f72 2074 6865 206d 6574  ters for the met
+00021e40: 686f 640a 2020 2020 2020 2020 5261 6973  hod.        Rais
+00021e50: 6573 3a0a 2020 2020 2020 2020 2d20 4c69  es:.        - Li
+00021e60: 7374 206f 6620 5661 6c75 6545 7272 6f72  st of ValueError
+00021e70: 730a 2020 2020 2020 2020 2222 220a 2020  s.        """.  
+00021e80: 2020 2020 2020 2320 5275 6e20 2f20 4173        # Run / As
+00021e90: 7365 7274 0a20 2020 2020 2020 2077 6974  sert.        wit
+00021ea0: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+00021eb0: 4167 6772 6567 6174 6543 6f6e 7374 7261  AggregateConstra
+00021ec0: 696e 7473 4572 726f 7229 2061 7320 6572  intsError) as er
+00021ed0: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+00021ee0: 204f 6e65 486f 7445 6e63 6f64 696e 672e   OneHotEncoding.
+00021ef0: 5f76 616c 6964 6174 655f 696e 7075 7473  _validate_inputs
+00021f00: 286e 6f74 5f63 6f6c 756d 6e5f 6e61 6d65  (not_column_name
+00021f10: 733d 4e6f 6e65 2c20 736f 6d65 7468 696e  s=None, somethin
+00021f20: 675f 656c 7365 3d4e 6f6e 6529 0a0a 2020  g_else=None)..  
+00021f30: 2020 2020 2020 6572 725f 6d73 6720 3d20        err_msg = 
+00021f40: 280a 2020 2020 2020 2020 2020 2020 7227  (.            r'
+00021f50: 4d69 7373 696e 6720 7265 7175 6972 6564  Missing required
+00021f60: 2076 616c 7565 7320 7b28 2e2a 297d 2069   values {(.*)} i
+00021f70: 6e20 6120 4f6e 6548 6f74 456e 636f 6469  n a OneHotEncodi
+00021f80: 6e67 2063 6f6e 7374 7261 696e 742e 270a  ng constraint.'.
+00021f90: 2020 2020 2020 2020 2020 2020 7227 5c6e              r'\n
+00021fa0: 5c6e 496e 7661 6c69 6420 7661 6c75 6573  \nInvalid values
+00021fb0: 207b 282e 2a29 7d20 6172 6520 7072 6573   {(.*)} are pres
+00021fc0: 656e 7420 696e 2061 204f 6e65 486f 7445  ent in a OneHotE
+00021fd0: 6e63 6f64 696e 6720 636f 6e73 7472 6169  ncoding constrai
+00021fe0: 6e74 2e27 0a20 2020 2020 2020 2029 0a20  nt.'.        ). 
+00021ff0: 2020 2020 2020 2067 726f 7570 7320 3d20         groups = 
+00022000: 7265 2e73 6561 7263 6828 6572 725f 6d73  re.search(err_ms
+00022010: 672c 2073 7472 2865 7272 6f72 2e76 616c  g, str(error.val
+00022020: 7565 2929 0a20 2020 2020 2020 2061 7373  ue)).        ass
+00022030: 6572 7420 6772 6f75 7073 2069 7320 6e6f  ert groups is no
+00022040: 7420 4e6f 6e65 0a20 2020 2020 2020 2061  t None.        a
+00022050: 7373 6572 7420 7374 7228 6576 616c 2867  ssert str(eval(g
+00022060: 726f 7570 732e 6772 6f75 7028 3129 2929  roups.group(1)))
+00022070: 203d 3d20 2763 6f6c 756d 6e5f 6e61 6d65   == 'column_name
+00022080: 7327 0a20 2020 2020 2020 2061 7373 6572  s'.        asser
+00022090: 7420 7365 7428 6576 616c 2867 726f 7570  t set(eval(group
+000220a0: 732e 6772 6f75 7028 3229 2929 203d 3d20  s.group(2))) == 
+000220b0: 7b27 6e6f 745f 636f 6c75 6d6e 5f6e 616d  {'not_column_nam
+000220c0: 6573 272c 2027 736f 6d65 7468 696e 675f  es', 'something_
+000220d0: 656c 7365 277d 0a0a 2020 2020 6465 6620  else'}..    def 
+000220e0: 7465 7374 5f5f 7661 6c69 6461 7465 5f6d  test__validate_m
+000220f0: 6574 6164 6174 615f 636f 6c75 6d6e 7328  etadata_columns(
+00022100: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00022110: 2222 5465 7374 2074 6865 2060 605f 7661  ""Test the ``_va
+00022120: 6c69 6461 7465 5f6d 6574 6164 6174 615f  lidate_metadata_
+00022130: 636f 6c75 6d6e 7360 6020 6d65 7468 6f64  columns`` method
+00022140: 2e0a 0a20 2020 2020 2020 2041 6c6c 206f  ...        All o
+00022150: 6620 7468 6520 636f 6c75 6d6e 7320 7061  f the columns pa
+00022160: 7373 6564 2069 6e20 636f 6c75 6d6e 5f6e  ssed in column_n
+00022170: 616d 6573 2073 686f 756c 6420 6265 2069  ames should be i
+00022180: 6e20 7468 6520 6d65 7461 6461 7461 2e0a  n the metadata..
+00022190: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
+000221a0: 2020 2020 2020 2020 2020 2020 2d20 636f              - co
+000221b0: 6c75 6d6e 5f6e 616d 6573 2077 6974 6820  lumn_names with 
+000221c0: 636f 6c75 6d6e 7320 7468 6174 2061 7265  columns that are
+000221d0: 2061 6c6c 2069 6e20 7468 6520 6d65 7461   all in the meta
+000221e0: 6461 7461 2e0a 0a20 2020 2020 2020 2053  data...        S
+000221f0: 6964 6520 6566 6665 6374 3a0a 2020 2020  ide effect:.    
+00022200: 2020 2020 2020 2020 2d20 4e6f 2065 7272          - No err
+00022210: 6f72 2073 686f 756c 6420 6265 2072 6169  or should be rai
+00022220: 7365 642e 0a20 2020 2020 2020 2022 2222  sed..        """
+00022230: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+00022240: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+00022250: 6120 3d20 4d6f 636b 2829 0a20 2020 2020  a = Mock().     
+00022260: 2020 206d 6574 6164 6174 612e 636f 6c75     metadata.colu
+00022270: 6d6e 7320 3d20 7b27 6127 3a20 312c 2027  mns = {'a': 1, '
+00022280: 6227 3a20 327d 0a0a 2020 2020 2020 2020  b': 2}..        
+00022290: 2320 5275 6e0a 2020 2020 2020 2020 4f6e  # Run.        On
+000222a0: 6548 6f74 456e 636f 6469 6e67 2e5f 7661  eHotEncoding._va
+000222b0: 6c69 6461 7465 5f6d 6574 6164 6174 615f  lidate_metadata_
+000222c0: 636f 6c75 6d6e 7328 6d65 7461 6461 7461  columns(metadata
+000222d0: 2c20 636f 6c75 6d6e 5f6e 616d 6573 3d5b  , column_names=[
+000222e0: 2761 272c 2027 6227 5d29 0a0a 2020 2020  'a', 'b'])..    
+000222f0: 6465 6620 7465 7374 5f5f 7661 6c69 6461  def test__valida
+00022300: 7465 5f6d 6574 6164 6174 615f 636f 6c75  te_metadata_colu
+00022310: 6d6e 735f 7261 6973 6573 5f65 7272 6f72  mns_raises_error
+00022320: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00022330: 2222 2254 6573 7420 7468 6520 6060 5f76  """Test the ``_v
+00022340: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
+00022350: 5f63 6f6c 756d 6e73 6060 206d 6574 686f  _columns`` metho
+00022360: 6427 7320 6572 726f 7220 636f 6e64 6974  d's error condit
+00022370: 696f 6e2e 0a0a 2020 2020 2020 2020 4966  ion...        If
+00022380: 2061 6e79 2063 6f6c 756d 6e73 2069 6e20   any columns in 
+00022390: 636f 6c75 6d6e 5f6e 616d 6573 2061 7265  column_names are
+000223a0: 206e 6f74 2069 6e20 7468 6520 6d65 7461   not in the meta
+000223b0: 6461 7461 2c20 616e 2065 7272 6f72 2073  data, an error s
+000223c0: 686f 756c 6420 6265 2072 6169 7365 642e  hould be raised.
+000223d0: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
+000223e0: 0a20 2020 2020 2020 2020 2020 202d 2063  .            - c
+000223f0: 6f6c 756d 6e5f 6e61 6d65 7320 7468 6174  olumn_names that
+00022400: 2063 6f6e 7461 696e 7320 6120 636f 6c75   contains a colu
+00022410: 6d6e 206e 6f74 2069 6e20 7468 6520 6d65  mn not in the me
+00022420: 7461 6461 7461 2e0a 0a20 2020 2020 2020  tadata...       
+00022430: 2053 6964 6520 6566 6665 6374 3a0a 2020   Side effect:.  
+00022440: 2020 2020 2020 2020 2020 2d20 436f 6e73            - Cons
+00022450: 7472 6169 6e74 4d65 7461 6461 7461 4572  traintMetadataEr
+00022460: 726f 7220 7368 6f75 6c64 2062 6520 7261  ror should be ra
+00022470: 6973 6564 2e0a 2020 2020 2020 2020 2222  ised..        ""
+00022480: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
+00022490: 700a 2020 2020 2020 2020 6d65 7461 6461  p.        metada
+000224a0: 7461 203d 204d 6f63 6b28 290a 2020 2020  ta = Mock().    
+000224b0: 2020 2020 6d65 7461 6461 7461 2e63 6f6c      metadata.col
+000224c0: 756d 6e73 203d 207b 2761 273a 2031 2c20  umns = {'a': 1, 
+000224d0: 2762 273a 2032 7d0a 0a20 2020 2020 2020  'b': 2}..       
+000224e0: 2023 2052 756e 0a20 2020 2020 2020 2065   # Run.        e
+000224f0: 7272 6f72 5f6d 6573 7361 6765 203d 2072  rror_message = r
+00022500: 652e 6573 6361 7065 280a 2020 2020 2020  e.escape(.      
+00022510: 2020 2020 2020 2741 204f 6e65 486f 7445        'A OneHotE
+00022520: 6e63 6f64 696e 6720 636f 6e73 7472 6169  ncoding constrai
+00022530: 6e74 2069 7320 6265 696e 6720 6170 706c  nt is being appl
+00022540: 6965 6420 746f 2069 6e76 616c 6964 2063  ied to invalid c
+00022550: 6f6c 756d 6e20 6e61 6d65 7320 270a 2020  olumn names '.  
+00022560: 2020 2020 2020 2020 2020 227b 2763 277d            "{'c'}
+00022570: 2e20 5468 6520 636f 6c75 6d6e 7320 6d75  . The columns mu
+00022580: 7374 2065 7869 7374 2069 6e20 7468 6520  st exist in the 
+00022590: 7461 626c 652e 220a 2020 2020 2020 2020  table.".        
+000225a0: 290a 2020 2020 2020 2020 7769 7468 2070  ).        with p
+000225b0: 7974 6573 742e 7261 6973 6573 2843 6f6e  ytest.raises(Con
+000225c0: 7374 7261 696e 744d 6574 6164 6174 6145  straintMetadataE
+000225d0: 7272 6f72 2c20 6d61 7463 683d 6572 726f  rror, match=erro
+000225e0: 725f 6d65 7373 6167 6529 3a0a 2020 2020  r_message):.    
+000225f0: 2020 2020 2020 2020 4f6e 6548 6f74 456e          OneHotEn
+00022600: 636f 6469 6e67 2e5f 7661 6c69 6461 7465  coding._validate
+00022610: 5f6d 6574 6164 6174 615f 636f 6c75 6d6e  _metadata_column
+00022620: 7328 6d65 7461 6461 7461 2c20 636f 6c75  s(metadata, colu
+00022630: 6d6e 5f6e 616d 6573 3d5b 2761 272c 2027  mn_names=['a', '
+00022640: 6327 5d29 0a0a 2020 2020 6465 6620 7465  c'])..    def te
+00022650: 7374 5f72 6576 6572 7365 5f74 7261 6e73  st_reverse_trans
+00022660: 666f 726d 2873 656c 6629 3a0a 2020 2020  form(self):.    
+00022670: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
+00022680: 6060 4f6e 6548 6f74 456e 636f 6469 6e67  ``OneHotEncoding
+00022690: 2e72 6576 6572 7365 5f74 7261 6e73 666f  .reverse_transfo
+000226a0: 726d 6060 206d 6574 686f 642e 0a0a 2020  rm`` method...  
+000226b0: 2020 2020 2020 4974 2069 7320 6578 7065        It is expe
+000226c0: 6374 6564 2074 6f2c 2066 6f72 2065 6163  cted to, for eac
+000226d0: 6820 6f66 2074 6865 2061 7070 726f 7072  h of the appropr
+000226e0: 6961 7465 2072 6f77 732c 2073 6574 2074  iate rows, set t
+000226f0: 6865 2063 6f6c 756d 6e0a 2020 2020 2020  he column.      
+00022700: 2020 7769 7468 2074 6865 206c 6172 6765    with the large
+00022710: 7374 2076 616c 7565 2074 6f20 6f6e 6520  st value to one 
+00022720: 616e 6420 7365 7420 616c 6c20 6f74 6865  and set all othe
+00022730: 7220 636f 6c75 6d6e 7320 746f 207a 6572  r columns to zer
+00022740: 6f2e 0a0a 2020 2020 2020 2020 496e 7075  o...        Inpu
+00022750: 743a 0a20 2020 2020 2020 202d 2054 6162  t:.        - Tab
+00022760: 6c65 2064 6174 6120 7769 7468 2061 6e79  le data with any
+00022770: 206e 756d 6265 7273 2028 7061 6e64 6173   numbers (pandas
+00022780: 2e44 6174 6146 7261 6d65 290a 2020 2020  .DataFrame).    
+00022790: 2020 2020 4f75 7470 7574 3a0a 2020 2020      Output:.    
+000227a0: 2020 2020 2d20 5461 626c 6520 6461 7461      - Table data
+000227b0: 2077 6865 7265 2074 6865 2061 7070 726f   where the appro
+000227c0: 7072 6961 7465 2072 6f77 7320 6172 6520  priate rows are 
+000227d0: 6f6e 6520 686f 7420 2870 616e 6461 732e  one hot (pandas.
+000227e0: 4461 7461 4672 616d 6529 0a20 2020 2020  DataFrame).     
+000227f0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00022800: 2053 6574 7570 0a20 2020 2020 2020 2069   Setup.        i
+00022810: 6e73 7461 6e63 6520 3d20 4f6e 6548 6f74  nstance = OneHot
+00022820: 456e 636f 6469 6e67 2863 6f6c 756d 6e5f  Encoding(column_
+00022830: 6e61 6d65 733d 5b27 6127 2c20 2762 275d  names=['a', 'b']
+00022840: 290a 0a20 2020 2020 2020 2023 2052 756e  )..        # Run
+00022850: 0a20 2020 2020 2020 2074 6162 6c65 5f64  .        table_d
+00022860: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
+00022870: 6d65 287b 0a20 2020 2020 2020 2020 2020  me({.           
+00022880: 2027 6127 3a20 5b30 2e31 2c20 302e 352c   'a': [0.1, 0.5,
+00022890: 2030 2e38 5d2c 0a20 2020 2020 2020 2020   0.8],.         
+000228a0: 2020 2027 6227 3a20 5b30 2e38 2c20 302e     'b': [0.8, 0.
+000228b0: 312c 2030 2e39 5d2c 0a20 2020 2020 2020  1, 0.9],.       
+000228c0: 2020 2020 2027 6327 3a20 5b31 2c20 322c       'c': [1, 2,
+000228d0: 2033 5d0a 2020 2020 2020 2020 7d29 0a20   3].        }). 
+000228e0: 2020 2020 2020 206f 7574 203d 2069 6e73         out = ins
+000228f0: 7461 6e63 652e 7265 7665 7273 655f 7472  tance.reverse_tr
+00022900: 616e 7366 6f72 6d28 7461 626c 655f 6461  ansform(table_da
+00022910: 7461 290a 0a20 2020 2020 2020 2023 2041  ta)..        # A
+00022920: 7373 6572 740a 2020 2020 2020 2020 6578  ssert.        ex
+00022930: 7065 6374 6564 5f6f 7574 203d 2070 642e  pected_out = pd.
+00022940: 4461 7461 4672 616d 6528 7b0a 2020 2020  DataFrame({.    
+00022950: 2020 2020 2020 2020 2761 273a 205b 302e          'a': [0.
+00022960: 302c 2031 2e30 2c20 302e 305d 2c0a 2020  0, 1.0, 0.0],.  
+00022970: 2020 2020 2020 2020 2020 2762 273a 205b            'b': [
+00022980: 312e 302c 2030 2e30 2c20 312e 305d 2c0a  1.0, 0.0, 1.0],.
+00022990: 2020 2020 2020 2020 2020 2020 2763 273a              'c':
+000229a0: 205b 312c 2032 2c20 335d 0a20 2020 2020   [1, 2, 3].     
+000229b0: 2020 207d 290a 2020 2020 2020 2020 7064     }).        pd
+000229c0: 2e74 6573 7469 6e67 2e61 7373 6572 745f  .testing.assert_
+000229d0: 6672 616d 655f 6571 7561 6c28 6578 7065  frame_equal(expe
+000229e0: 6374 6564 5f6f 7574 2c20 6f75 7429 0a0a  cted_out, out)..
+000229f0: 2020 2020 6465 6620 7465 7374 5f69 735f      def test_is_
+00022a00: 7661 6c69 6428 7365 6c66 293a 0a20 2020  valid(self):.   
+00022a10: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+00022a20: 2060 604f 6e65 486f 7445 6e63 6f64 696e   ``OneHotEncodin
+00022a30: 672e 6973 5f76 616c 6964 6060 206d 6574  g.is_valid`` met
+00022a40: 686f 642e 0a0a 2020 2020 2020 2020 6060  hod...        ``
+00022a50: 5472 7565 6060 2077 6865 6e20 666f 7220  True`` when for 
+00022a60: 7468 6520 726f 7773 2077 6865 7265 2074  the rows where t
+00022a70: 6865 2064 6174 6120 6973 206f 6e65 2068  he data is one h
+00022a80: 6f74 2c20 6060 4661 6c73 6560 6020 6f74  ot, ``False`` ot
+00022a90: 6865 7277 6973 652e 0a0a 2020 2020 2020  herwise...      
+00022aa0: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
+00022ab0: 202d 2054 6162 6c65 2064 6174 6120 2870   - Table data (p
+00022ac0: 616e 6461 732e 4461 7461 4672 616d 6529  andas.DataFrame)
+00022ad0: 2063 6f6e 7461 696e 696e 6720 6f6e 6520   containing one 
+00022ae0: 7661 6c69 6420 636f 6c75 6d6e 2c20 6f6e  valid column, on
+00022af0: 6520 636f 6c75 6d6e 2077 6974 6820 6120  e column with a 
+00022b00: 7375 6d20 6c65 7373 0a20 2020 2020 2020  sum less.       
+00022b10: 2074 6861 6e20 312c 206f 6e65 2063 6f6c   than 1, one col
+00022b20: 756d 6e20 7769 7468 2061 2073 756d 2067  umn with a sum g
+00022b30: 7265 6174 6572 2074 6861 6e20 312c 206f  reater than 1, o
+00022b40: 6e65 2063 6f6c 756d 6e20 7769 7468 2068  ne column with h
+00022b50: 616c 7665 7320 6164 6469 6e67 2074 6f20  alves adding to 
+00022b60: 6f6e 6520 616e 6420 6f6e 650a 2020 2020  one and one.    
+00022b70: 2020 2020 636f 6c75 6d6e 2077 6974 6820      column with 
+00022b80: 6e61 6e73 2e0a 2020 2020 2020 2020 4f75  nans..        Ou
+00022b90: 7470 7574 3a0a 2020 2020 2020 2020 2d20  tput:.        - 
+00022ba0: 5365 7269 6573 206f 6620 6060 5472 7565  Series of ``True
+00022bb0: 6060 2061 6e64 2060 6046 616c 7365 6060  `` and ``False``
+00022bc0: 2076 616c 7565 7320 2870 616e 6461 732e   values (pandas.
+00022bd0: 5365 7269 6573 290a 2020 2020 2020 2020  Series).        
+00022be0: 2222 220a 2020 2020 2020 2020 2320 5365  """.        # Se
+00022bf0: 7475 700a 2020 2020 2020 2020 696e 7374  tup.        inst
+00022c00: 616e 6365 203d 204f 6e65 486f 7445 6e63  ance = OneHotEnc
+00022c10: 6f64 696e 6728 636f 6c75 6d6e 5f6e 616d  oding(column_nam
+00022c20: 6573 3d5b 2761 272c 2027 6227 2c20 2763  es=['a', 'b', 'c
+00022c30: 275d 290a 0a20 2020 2020 2020 2023 2052  '])..        # R
+00022c40: 756e 0a20 2020 2020 2020 2074 6162 6c65  un.        table
+00022c50: 5f64 6174 6120 3d20 7064 2e44 6174 6146  _data = pd.DataF
+00022c60: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
+00022c70: 2020 2027 6127 3a20 5b31 2e30 2c20 312e     'a': [1.0, 1.
+00022c80: 302c 2030 2e30 2c20 302e 352c 2031 2e30  0, 0.0, 0.5, 1.0
+00022c90: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
+00022ca0: 6227 3a20 5b30 2e30 2c20 312e 302c 2030  b': [0.0, 1.0, 0
+00022cb0: 2e30 2c20 302e 352c 2030 2e30 5d2c 0a20  .0, 0.5, 0.0],. 
+00022cc0: 2020 2020 2020 2020 2020 2027 6327 3a20             'c': 
+00022cd0: 5b30 2e30 2c20 322e 302c 2030 2e30 2c20  [0.0, 2.0, 0.0, 
+00022ce0: 302e 302c 206e 702e 6e61 6e5d 2c0a 2020  0.0, np.nan],.  
+00022cf0: 2020 2020 2020 2020 2020 2764 273a 205b            'd': [
+00022d00: 312c 2032 2c20 332c 2034 2c20 355d 0a20  1, 2, 3, 4, 5]. 
+00022d10: 2020 2020 2020 207d 290a 2020 2020 2020         }).      
+00022d20: 2020 6f75 7420 3d20 696e 7374 616e 6365    out = instance
+00022d30: 2e69 735f 7661 6c69 6428 7461 626c 655f  .is_valid(table_
+00022d40: 6461 7461 290a 0a20 2020 2020 2020 2023  data)..        #
+00022d50: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
+00022d60: 6578 7065 6374 6564 5f6f 7574 203d 2070  expected_out = p
+00022d70: 642e 5365 7269 6573 285b 5472 7565 2c20  d.Series([True, 
+00022d80: 4661 6c73 652c 2046 616c 7365 2c20 4661  False, False, Fa
+00022d90: 6c73 652c 2046 616c 7365 5d29 0a20 2020  lse, False]).   
+00022da0: 2020 2020 2070 642e 7465 7374 696e 672e       pd.testing.
+00022db0: 6173 7365 7274 5f73 6572 6965 735f 6571  assert_series_eq
+00022dc0: 7561 6c28 6578 7065 6374 6564 5f6f 7574  ual(expected_out
+00022dd0: 2c20 6f75 7429 0a0a 0a63 6c61 7373 2054  , out)...class T
+00022de0: 6573 7455 6e69 7175 6528 293a 0a0a 2020  estUnique():..  
+00022df0: 2020 6465 6620 7465 7374 5f5f 7661 6c69    def test__vali
+00022e00: 6461 7465 5f69 6e70 7574 7328 7365 6c66  date_inputs(self
+00022e10: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+00022e20: 7374 2074 6865 2060 6055 6e69 7175 652e  st the ``Unique.
+00022e30: 5f76 616c 6964 6174 655f 696e 7075 7473  _validate_inputs
+00022e40: 6060 206d 6574 686f 642e 0a0a 2020 2020  `` method...    
+00022e50: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
+00022e60: 2020 202d 2020 496e 636f 7272 6563 7420     -  Incorrect 
+00022e70: 6172 6775 6d65 6e74 7320 666f 7220 7468  arguments for th
+00022e80: 6520 6d65 7468 6f64 0a20 2020 2020 2020  e method.       
+00022e90: 2052 6169 7365 733a 0a20 2020 2020 2020   Raises:.       
+00022ea0: 202d 204c 6973 7420 6f66 2056 616c 7565   - List of Value
+00022eb0: 4572 726f 7273 0a20 2020 2020 2020 2022  Errors.        "
+00022ec0: 2222 0a20 2020 2020 2020 2023 2052 756e  "".        # Run
+00022ed0: 202f 2041 7373 6572 740a 2020 2020 2020   / Assert.      
+00022ee0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+00022ef0: 6973 6573 2841 6767 7265 6761 7465 436f  ises(AggregateCo
+00022f00: 6e73 7472 6169 6e74 7345 7272 6f72 2920  nstraintsError) 
+00022f10: 6173 2065 7272 6f72 3a0a 2020 2020 2020  as error:.      
+00022f20: 2020 2020 2020 556e 6971 7565 2e5f 7661        Unique._va
+00022f30: 6c69 6461 7465 5f69 6e70 7574 7328 6e6f  lidate_inputs(no
+00022f40: 745f 636f 6c75 6d6e 5f6e 616d 6573 3d4e  t_column_names=N
+00022f50: 6f6e 652c 2073 6f6d 6574 6869 6e67 5f65  one, something_e
+00022f60: 6c73 653d 4e6f 6e65 290a 0a20 2020 2020  lse=None)..     
+00022f70: 2020 2065 7272 5f6d 7367 203d 2028 0a20     err_msg = (. 
+00022f80: 2020 2020 2020 2020 2020 2072 274d 6973             r'Mis
+00022f90: 7369 6e67 2072 6571 7569 7265 6420 7661  sing required va
+00022fa0: 6c75 6573 207b 282e 2a29 7d20 696e 2061  lues {(.*)} in a
+00022fb0: 2055 6e69 7175 6520 636f 6e73 7472 6169   Unique constrai
+00022fc0: 6e74 2e27 0a20 2020 2020 2020 2020 2020  nt.'.           
+00022fd0: 2072 275c 6e5c 6e49 6e76 616c 6964 2076   r'\n\nInvalid v
+00022fe0: 616c 7565 7320 7b28 2e2a 297d 2061 7265  alues {(.*)} are
+00022ff0: 2070 7265 7365 6e74 2069 6e20 6120 556e   present in a Un
+00023000: 6971 7565 2063 6f6e 7374 7261 696e 742e  ique constraint.
+00023010: 270a 2020 2020 2020 2020 290a 2020 2020  '.        ).    
+00023020: 2020 2020 6772 6f75 7073 203d 2072 652e      groups = re.
+00023030: 7365 6172 6368 2865 7272 5f6d 7367 2c20  search(err_msg, 
+00023040: 7374 7228 6572 726f 722e 7661 6c75 6529  str(error.value)
+00023050: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00023060: 2067 726f 7570 7320 6973 206e 6f74 204e   groups is not N
+00023070: 6f6e 650a 2020 2020 2020 2020 6173 7365  one.        asse
+00023080: 7274 2073 7472 2865 7661 6c28 6772 6f75  rt str(eval(grou
+00023090: 7073 2e67 726f 7570 2831 2929 2920 3d3d  ps.group(1))) ==
+000230a0: 2027 636f 6c75 6d6e 5f6e 616d 6573 270a   'column_names'.
+000230b0: 2020 2020 2020 2020 6173 7365 7274 2073          assert s
+000230c0: 6574 2865 7661 6c28 6772 6f75 7073 2e67  et(eval(groups.g
+000230d0: 726f 7570 2832 2929 2920 3d3d 207b 276e  roup(2))) == {'n
+000230e0: 6f74 5f63 6f6c 756d 6e5f 6e61 6d65 7327  ot_column_names'
+000230f0: 2c20 2773 6f6d 6574 6869 6e67 5f65 6c73  , 'something_els
+00023100: 6527 7d0a 0a20 2020 2064 6566 2074 6573  e'}..    def tes
+00023110: 745f 5f76 616c 6964 6174 655f 6d65 7461  t__validate_meta
+00023120: 6461 7461 5f63 6f6c 756d 6e73 2873 656c  data_columns(sel
+00023130: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+00023140: 6573 7420 7468 6520 6060 5f76 616c 6964  est the ``_valid
+00023150: 6174 655f 6d65 7461 6461 7461 5f63 6f6c  ate_metadata_col
+00023160: 756d 6e73 6060 206d 6574 686f 642e 0a0a  umns`` method...
+00023170: 2020 2020 2020 2020 416c 6c20 6f66 2074          All of t
+00023180: 6865 2063 6f6c 756d 6e73 2070 6173 7365  he columns passe
+00023190: 6420 696e 2063 6f6c 756d 6e5f 6e61 6d65  d in column_name
+000231a0: 7320 7368 6f75 6c64 2062 6520 696e 2074  s should be in t
+000231b0: 6865 206d 6574 6164 6174 612e 0a0a 2020  he metadata...  
+000231c0: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
+000231d0: 2020 2020 2020 2020 202d 2063 6f6c 756d           - colum
+000231e0: 6e5f 6e61 6d65 7320 7769 7468 2063 6f6c  n_names with col
+000231f0: 756d 6e73 2074 6861 7420 6172 6520 616c  umns that are al
+00023200: 6c20 696e 2074 6865 206d 6574 6164 6174  l in the metadat
+00023210: 612e 0a0a 2020 2020 2020 2020 5369 6465  a...        Side
+00023220: 2065 6666 6563 743a 0a20 2020 2020 2020   effect:.       
+00023230: 2020 2020 202d 204e 6f20 6572 726f 7220       - No error 
+00023240: 7368 6f75 6c64 2062 6520 7261 6973 6564  should be raised
+00023250: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00023260: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
+00023270: 2020 2020 2020 6d65 7461 6461 7461 203d        metadata =
+00023280: 204d 6f63 6b28 290a 2020 2020 2020 2020   Mock().        
+00023290: 6d65 7461 6461 7461 2e63 6f6c 756d 6e73  metadata.columns
+000232a0: 203d 207b 2761 273a 2031 2c20 2762 273a   = {'a': 1, 'b':
+000232b0: 2032 7d0a 0a20 2020 2020 2020 2023 2052   2}..        # R
+000232c0: 756e 0a20 2020 2020 2020 2055 6e69 7175  un.        Uniqu
+000232d0: 652e 5f76 616c 6964 6174 655f 6d65 7461  e._validate_meta
+000232e0: 6461 7461 5f63 6f6c 756d 6e73 286d 6574  data_columns(met
+000232f0: 6164 6174 612c 2063 6f6c 756d 6e5f 6e61  adata, column_na
+00023300: 6d65 733d 5b27 6127 2c20 2762 275d 290a  mes=['a', 'b']).
+00023310: 0a20 2020 2064 6566 2074 6573 745f 5f76  .    def test__v
+00023320: 616c 6964 6174 655f 6d65 7461 6461 7461  alidate_metadata
+00023330: 5f63 6f6c 756d 6e73 5f72 6169 7365 735f  _columns_raises_
+00023340: 6572 726f 7228 7365 6c66 293a 0a20 2020  error(self):.   
+00023350: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+00023360: 2060 605f 7661 6c69 6461 7465 5f6d 6574   ``_validate_met
+00023370: 6164 6174 615f 636f 6c75 6d6e 7360 6020  adata_columns`` 
+00023380: 6d65 7468 6f64 2773 2065 7272 6f72 2063  method's error c
+00023390: 6f6e 6469 7469 6f6e 2e0a 0a20 2020 2020  ondition...     
+000233a0: 2020 2049 6620 616e 7920 636f 6c75 6d6e     If any column
+000233b0: 7320 696e 2063 6f6c 756d 6e5f 6e61 6d65  s in column_name
+000233c0: 7320 6172 6520 6e6f 7420 696e 2074 6865  s are not in the
+000233d0: 206d 6574 6164 6174 612c 2061 6e20 6572   metadata, an er
+000233e0: 726f 7220 7368 6f75 6c64 2062 6520 7261  ror should be ra
+000233f0: 6973 6564 2e0a 0a20 2020 2020 2020 2049  ised...        I
+00023400: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
+00023410: 2020 2d20 636f 6c75 6d6e 5f6e 616d 6573    - column_names
+00023420: 2074 6861 7420 636f 6e74 6169 6e73 2061   that contains a
+00023430: 2063 6f6c 756d 6e20 6e6f 7420 696e 2074   column not in t
+00023440: 6865 206d 6574 6164 6174 612e 0a0a 2020  he metadata...  
+00023450: 2020 2020 2020 5369 6465 2065 6666 6563        Side effec
+00023460: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
+00023470: 2043 6f6e 7374 7261 696e 744d 6574 6164   ConstraintMetad
+00023480: 6174 6145 7272 6f72 2073 686f 756c 6420  ataError should 
+00023490: 6265 2072 6169 7365 642e 0a20 2020 2020  be raised..     
+000234a0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+000234b0: 2053 6574 7570 0a20 2020 2020 2020 206d   Setup.        m
+000234c0: 6574 6164 6174 6120 3d20 4d6f 636b 2829  etadata = Mock()
+000234d0: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+000234e0: 612e 636f 6c75 6d6e 7320 3d20 7b27 6127  a.columns = {'a'
+000234f0: 3a20 312c 2027 6227 3a20 327d 0a0a 2020  : 1, 'b': 2}..  
+00023500: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+00023510: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+00023520: 6520 3d20 7265 2e65 7363 6170 6528 0a20  e = re.escape(. 
+00023530: 2020 2020 2020 2020 2020 2027 4120 556e             'A Un
+00023540: 6971 7565 2063 6f6e 7374 7261 696e 7420  ique constraint 
+00023550: 6973 2062 6569 6e67 2061 7070 6c69 6564  is being applied
+00023560: 2074 6f20 696e 7661 6c69 6420 636f 6c75   to invalid colu
+00023570: 6d6e 206e 616d 6573 2027 0a20 2020 2020  mn names '.     
+00023580: 2020 2020 2020 2022 7b27 6327 7d2e 2054         "{'c'}. T
+00023590: 6865 2063 6f6c 756d 6e73 206d 7573 7420  he columns must 
+000235a0: 6578 6973 7420 696e 2074 6865 2074 6162  exist in the tab
+000235b0: 6c65 2e22 0a20 2020 2020 2020 2029 0a20  le.".        ). 
+000235c0: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
+000235d0: 7374 2e72 6169 7365 7328 436f 6e73 7472  st.raises(Constr
+000235e0: 6169 6e74 4d65 7461 6461 7461 4572 726f  aintMetadataErro
+000235f0: 722c 206d 6174 6368 3d65 7272 6f72 5f6d  r, match=error_m
+00023600: 6573 7361 6765 293a 0a20 2020 2020 2020  essage):.       
+00023610: 2020 2020 2055 6e69 7175 652e 5f76 616c       Unique._val
+00023620: 6964 6174 655f 6d65 7461 6461 7461 5f63  idate_metadata_c
+00023630: 6f6c 756d 6e73 286d 6574 6164 6174 612c  olumns(metadata,
+00023640: 2063 6f6c 756d 6e5f 6e61 6d65 733d 5b27   column_names=['
+00023650: 6127 2c20 2763 275d 290a 0a20 2020 2064  a', 'c'])..    d
+00023660: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
+00023670: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+00023680: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+00023690: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
+000236a0: 2022 2222 5465 7374 2074 6865 2060 605f   """Test the ``_
+000236b0: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
+000236c0: 615f 7370 6563 6966 6963 5f74 6f5f 636f  a_specific_to_co
+000236d0: 6e73 7472 6169 6e74 6060 2e0a 0a20 2020  nstraint``...   
+000236e0: 2020 2020 2049 6620 6174 206c 6561 7374       If at least
+000236f0: 206f 6e65 206f 6620 7468 6520 636f 6c75   one of the colu
+00023700: 6d6e 7320 696e 2060 6063 6f6c 756d 6e5f  mns in ``column_
+00023710: 6e61 6d65 7360 6020 6973 206e 6f74 2061  names`` is not a
+00023720: 206b 6579 2c20 6e6f 2065 7272 6f72 2073   key, no error s
+00023730: 686f 756c 640a 2020 2020 2020 2020 6265  hould.        be
+00023740: 2072 6169 7365 642e 0a0a 2020 2020 2020   raised...      
+00023750: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
+00023760: 2020 2020 202d 204d 6574 6164 6174 6120       - Metadata 
+00023770: 7769 7468 2070 7269 6d61 7279 2061 6e64  with primary and
+00023780: 2061 6c74 6572 6e61 7465 206b 6579 732e   alternate keys.
+00023790: 0a20 2020 2020 2020 2020 2020 202d 2043  .            - C
+000237a0: 6f6c 756d 6e20 6e61 6d65 7320 7769 7468  olumn names with
+000237b0: 206c 6973 7420 6f66 2063 6f6c 756d 6e73   list of columns
+000237c0: 2064 6966 6665 7265 6e74 2068 7461 6e20   different htan 
+000237d0: 7468 6520 7072 696d 6172 7920 6b65 7920  the primary key 
+000237e0: 616e 6420 616c 7465 726e 6174 6520 6b65  and alternate ke
+000237f0: 7973 2e0a 2020 2020 2020 2020 2222 220a  ys..        """.
+00023800: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
+00023810: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+00023820: 203d 204d 6f63 6b28 290a 2020 2020 2020   = Mock().      
+00023830: 2020 6d65 7461 6461 7461 2e70 7269 6d61    metadata.prima
+00023840: 7279 5f6b 6579 203d 2027 6127 0a20 2020  ry_key = 'a'.   
+00023850: 2020 2020 206d 6574 6164 6174 612e 616c       metadata.al
+00023860: 7465 726e 6174 655f 6b65 7973 203d 205b  ternate_keys = [
+00023870: 2762 272c 2027 6327 5d0a 0a20 2020 2020  'b', 'c']..     
+00023880: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
+00023890: 2055 6e69 7175 652e 5f76 616c 6964 6174   Unique._validat
+000238a0: 655f 6d65 7461 6461 7461 5f73 7065 6369  e_metadata_speci
+000238b0: 6669 635f 746f 5f63 6f6e 7374 7261 696e  fic_to_constrain
+000238c0: 7428 0a20 2020 2020 2020 2020 2020 206d  t(.            m
+000238d0: 6574 6164 6174 612c 0a20 2020 2020 2020  etadata,.       
+000238e0: 2020 2020 2063 6f6c 756d 6e5f 6e61 6d65       column_name
+000238f0: 733d 5b27 6127 2c20 2762 272c 2027 6427  s=['a', 'b', 'd'
+00023900: 5d0a 2020 2020 2020 2020 290a 0a20 2020  ].        )..   
+00023910: 2064 6566 2074 6573 745f 5f76 616c 6964   def test__valid
+00023920: 6174 655f 6d65 7461 6461 7461 5f73 7065  ate_metadata_spe
+00023930: 6369 6669 635f 746f 5f63 6f6e 7374 7261  cific_to_constra
+00023940: 696e 745f 6572 726f 7228 7365 6c66 293a  int_error(self):
+00023950: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+00023960: 2074 6865 2060 605f 7661 6c69 6461 7465   the ``_validate
+00023970: 5f6d 6574 6164 6174 615f 7370 6563 6966  _metadata_specif
+00023980: 6963 5f74 6f5f 636f 6e73 7472 6169 6e74  ic_to_constraint
+00023990: 6060 2e0a 0a20 2020 2020 2020 2049 6620  ``...        If 
+000239a0: 616c 6c20 6f66 2074 6865 2063 6f6c 756d  all of the colum
+000239b0: 6e73 2069 6e20 6060 636f 6c75 6d6e 5f6e  ns in ``column_n
+000239c0: 616d 6573 6060 2061 7265 206b 6579 732c  ames`` are keys,
+000239d0: 2061 6e20 6572 726f 7220 7368 6f75 6c64   an error should
+000239e0: 0a20 2020 2020 2020 2062 6520 7261 6973  .        be rais
+000239f0: 6564 2e0a 0a20 2020 2020 2020 2049 6e70  ed...        Inp
+00023a00: 7574 3a0a 2020 2020 2020 2020 2020 2020  ut:.            
+00023a10: 2d20 4d65 7461 6461 7461 2077 6974 6820  - Metadata with 
+00023a20: 7072 696d 6172 7920 616e 6420 616c 7465  primary and alte
+00023a30: 726e 6174 6520 6b65 7973 2e0a 2020 2020  rnate keys..    
+00023a40: 2020 2020 2020 2020 2d20 436f 6c75 6d6e          - Column
+00023a50: 206e 616d 6573 2077 6974 6820 6c69 7374   names with list
+00023a60: 206f 6620 636f 6c75 6d6e 7320 6469 6666   of columns diff
+00023a70: 6572 656e 7420 6874 616e 2074 6865 2070  erent htan the p
+00023a80: 7269 6d61 7279 206b 6579 2061 6e64 2061  rimary key and a
+00023a90: 6c74 6572 6e61 7465 206b 6579 732e 0a20  lternate keys.. 
+00023aa0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00023ab0: 2020 2023 2053 6574 7570 0a20 2020 2020     # Setup.     
+00023ac0: 2020 206d 6574 6164 6174 6120 3d20 4d6f     metadata = Mo
+00023ad0: 636b 2829 0a20 2020 2020 2020 206d 6574  ck().        met
+00023ae0: 6164 6174 612e 7072 696d 6172 795f 6b65  adata.primary_ke
+00023af0: 7920 3d20 2761 270a 2020 2020 2020 2020  y = 'a'.        
+00023b00: 6d65 7461 6461 7461 2e61 6c74 6572 6e61  metadata.alterna
+00023b10: 7465 5f6b 6579 7320 3d20 5b28 2762 272c  te_keys = [('b',
+00023b20: 2027 6327 292c 2027 6427 5d0a 0a20 2020   'c'), 'd']..   
+00023b30: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
+00023b40: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+00023b50: 203d 2072 652e 6573 6361 7065 280a 2020   = re.escape(.  
+00023b60: 2020 2020 2020 2020 2020 2241 2055 6e69            "A Uni
+00023b70: 7175 6520 636f 6e73 7472 6169 6e74 2069  que constraint i
+00023b80: 7320 6265 696e 6720 6170 706c 6965 6420  s being applied 
+00023b90: 746f 2063 6f6c 756d 6e73 2027 5b27 6127  to columns '['a'
+00023ba0: 2c20 2762 272c 2027 6327 5d27 2e20 220a  , 'b', 'c']'. ".
+00023bb0: 2020 2020 2020 2020 2020 2020 2754 6865              'The
+00023bc0: 7365 2063 6f6c 756d 6e73 2061 7265 2061  se columns are a
+00023bd0: 6c72 6561 6479 2061 206b 6579 2066 6f72  lready a key for
+00023be0: 2074 6861 7420 7461 626c 652e 270a 2020   that table.'.  
+00023bf0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00023c00: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+00023c10: 6573 2843 6f6e 7374 7261 696e 744d 6574  es(ConstraintMet
+00023c20: 6164 6174 6145 7272 6f72 2c20 6d61 7463  adataError, matc
+00023c30: 683d 6572 726f 725f 6d65 7373 6167 6529  h=error_message)
+00023c40: 3a0a 2020 2020 2020 2020 2020 2020 556e  :.            Un
+00023c50: 6971 7565 2e5f 7661 6c69 6461 7465 5f6d  ique._validate_m
+00023c60: 6574 6164 6174 615f 7370 6563 6966 6963  etadata_specific
+00023c70: 5f74 6f5f 636f 6e73 7472 6169 6e74 280a  _to_constraint(.
+00023c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023c90: 6d65 7461 6461 7461 2c0a 2020 2020 2020  metadata,.      
+00023ca0: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+00023cb0: 5f6e 616d 6573 3d5b 2761 272c 2027 6227  _names=['a', 'b'
+00023cc0: 2c20 2763 275d 0a20 2020 2020 2020 2020  , 'c'].         
+00023cd0: 2020 2029 0a0a 2020 2020 6465 6620 7465     )..    def te
+00023ce0: 7374 5f5f 5f69 6e69 745f 5f28 7365 6c66  st___init__(self
+00023cf0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+00023d00: 7374 2074 6865 2060 6055 6e69 7175 652e  st the ``Unique.
+00023d10: 5f5f 696e 6974 5f5f 6060 206d 6574 686f  __init__`` metho
+00023d20: 642e 0a0a 2020 2020 2020 2020 5468 6520  d...        The 
+00023d30: 6060 636f 6c75 6d6e 5f6e 616d 6573 6060  ``column_names``
+00023d40: 2073 686f 756c 6420 6265 2073 6574 2074   should be set t
+00023d50: 6f20 7468 6f73 6520 7072 6f76 6964 6564  o those provided
+00023d60: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
+00023d70: 3a0a 2020 2020 2020 2020 2d20 636f 6c75  :.        - colu
+00023d80: 6d6e 206e 616d 6573 2074 6f20 6b65 6570  mn names to keep
+00023d90: 2075 6e69 7175 652e 0a20 2020 2020 2020   unique..       
+00023da0: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
+00023db0: 202d 2049 6e73 7461 6e63 6520 7769 7468   - Instance with
+00023dc0: 2060 6063 6f6c 756d 6e5f 6e61 6d65 7360   ``column_names`
+00023dd0: 6020 7365 742e 0a20 2020 2020 2020 2022  ` set..        "
+00023de0: 2222 0a20 2020 2020 2020 2023 2052 756e  "".        # Run
+00023df0: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
+00023e00: 6520 3d20 556e 6971 7565 2863 6f6c 756d  e = Unique(colum
+00023e10: 6e5f 6e61 6d65 733d 5b27 6127 2c20 2762  n_names=['a', 'b
+00023e20: 275d 290a 0a20 2020 2020 2020 2023 2041  '])..        # A
+00023e30: 7373 6572 740a 2020 2020 2020 2020 6173  ssert.        as
+00023e40: 7365 7274 2069 6e73 7461 6e63 652e 636f  sert instance.co
+00023e50: 6c75 6d6e 5f6e 616d 6573 203d 3d20 5b27  lumn_names == ['
+00023e60: 6127 2c20 2762 275d 0a0a 2020 2020 6465  a', 'b']..    de
+00023e70: 6620 7465 7374 5f69 735f 7661 6c69 6428  f test_is_valid(
+00023e80: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00023e90: 2222 5465 7374 2074 6865 2060 6055 6e69  ""Test the ``Uni
+00023ea0: 7175 652e 6973 5f76 616c 6964 6060 206d  que.is_valid`` m
+00023eb0: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
+00023ec0: 5468 6973 206d 6574 686f 6420 7368 6f75  This method shou
+00023ed0: 6c64 2072 6574 7572 6e20 6120 7064 2e53  ld return a pd.S
+00023ee0: 6572 6965 7320 7768 6572 6520 7468 6520  eries where the 
+00023ef0: 696e 6465 780a 2020 2020 2020 2020 6f66  index.        of
+00023f00: 2074 6865 2066 6972 7374 206f 6363 7572   the first occur
+00023f10: 656e 6365 206f 6620 6120 756e 6971 7565  ence of a unique
+00023f20: 2063 6f6d 6269 6e61 7469 6f6e 206f 6620   combination of 
+00023f30: 6060 696e 7374 616e 6365 2e63 6f6c 756d  ``instance.colum
+00023f40: 6e5f 6e61 6d65 7360 600a 2020 2020 2020  n_names``.      
+00023f50: 2020 6973 2073 6574 2074 6f20 6060 5472    is set to ``Tr
+00023f60: 7565 6060 2c20 616e 6420 6576 6572 7920  ue``, and every 
+00023f70: 6f74 6865 7220 6f63 6375 7265 6e63 6520  other occurence 
+00023f80: 6973 2073 6574 2074 6f20 6060 4661 6c73  is set to ``Fals
+00023f90: 6560 602e 0a0a 2020 2020 2020 2020 496e  e``...        In
+00023fa0: 7075 743a 0a20 2020 2020 2020 202d 2044  put:.        - D
+00023fb0: 6174 6146 7261 6d65 2077 6974 6820 6d75  ataFrame with mu
+00023fc0: 6c74 6970 6c65 206f 6620 7468 6520 7361  ltiple of the sa
+00023fd0: 6d65 2063 6f6d 6269 6e61 7469 6f6e 7320  me combinations 
+00023fe0: 6f66 2063 6f6c 756d 6e73 2e0a 2020 2020  of columns..    
+00023ff0: 2020 2020 4f75 7470 7574 3a0a 2020 2020      Output:.    
+00024000: 2020 2020 2d20 5365 7269 6573 2077 6974      - Series wit
+00024010: 6820 7468 6520 696e 6465 7820 6f66 2074  h the index of t
+00024020: 6865 2066 6972 7374 206f 6363 7572 656e  he first occuren
+00024030: 6365 7320 7365 7420 746f 2060 6054 7275  ces set to ``Tru
+00024040: 6560 602e 0a20 2020 2020 2020 2022 2222  e``..        """
+00024050: 0a20 2020 2020 2020 2023 2053 6574 7570  .        # Setup
+00024060: 0a20 2020 2020 2020 2069 6e73 7461 6e63  .        instanc
+00024070: 6520 3d20 556e 6971 7565 2863 6f6c 756d  e = Unique(colum
+00024080: 6e5f 6e61 6d65 733d 5b27 6127 2c20 2762  n_names=['a', 'b
+00024090: 272c 2027 6327 5d29 0a0a 2020 2020 2020  ', 'c'])..      
+000240a0: 2020 2320 5275 6e0a 2020 2020 2020 2020    # Run.        
+000240b0: 6461 7461 203d 2070 642e 4461 7461 4672  data = pd.DataFr
+000240c0: 616d 6528 7b0a 2020 2020 2020 2020 2020  ame({.          
+000240d0: 2020 2761 273a 205b 312c 2031 2c20 322c    'a': [1, 1, 2,
+000240e0: 2032 2c20 332c 2034 5d2c 0a20 2020 2020   2, 3, 4],.     
+000240f0: 2020 2020 2020 2027 6227 3a20 5b35 2c20         'b': [5, 
+00024100: 352c 2036 2c20 362c 2037 2c20 385d 2c0a  5, 6, 6, 7, 8],.
+00024110: 2020 2020 2020 2020 2020 2020 2763 273a              'c':
+00024120: 205b 392c 2039 2c20 3130 2c20 3130 2c20   [9, 9, 10, 10, 
+00024130: 3132 2c20 3133 5d0a 2020 2020 2020 2020  12, 13].        
+00024140: 7d29 0a20 2020 2020 2020 2076 616c 6964  }).        valid
+00024150: 203d 2069 6e73 7461 6e63 652e 6973 5f76   = instance.is_v
+00024160: 616c 6964 2864 6174 6129 0a0a 2020 2020  alid(data)..    
+00024170: 2020 2020 2320 4173 7365 7274 0a20 2020      # Assert.   
+00024180: 2020 2020 2065 7870 6563 7465 6420 3d20       expected = 
+00024190: 7064 2e53 6572 6965 7328 5b54 7275 652c  pd.Series([True,
+000241a0: 2046 616c 7365 2c20 5472 7565 2c20 4661   False, True, Fa
+000241b0: 6c73 652c 2054 7275 652c 2054 7275 655d  lse, True, True]
+000241c0: 290a 2020 2020 2020 2020 7064 2e74 6573  ).        pd.tes
+000241d0: 7469 6e67 2e61 7373 6572 745f 7365 7269  ting.assert_seri
+000241e0: 6573 5f65 7175 616c 2876 616c 6964 2c20  es_equal(valid, 
+000241f0: 6578 7065 6374 6564 290a 0a20 2020 2064  expected)..    d
+00024200: 6566 2074 6573 745f 6973 5f76 616c 6964  ef test_is_valid
+00024210: 5f63 7573 746f 6d5f 696e 6465 785f 7361  _custom_index_sa
+00024220: 6d65 5f76 616c 7565 7328 7365 6c66 293a  me_values(self):
+00024230: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+00024240: 2074 6865 2060 6055 6e69 7175 652e 6973   the ``Unique.is
+00024250: 5f76 616c 6964 6060 206d 6574 686f 642e  _valid`` method.
+00024260: 0a0a 2020 2020 2020 2020 5468 6973 206d  ..        This m
+00024270: 6574 686f 6420 7368 6f75 6c64 2072 6574  ethod should ret
+00024280: 7572 6e20 6120 7064 2e53 6572 6965 7320  urn a pd.Series 
+00024290: 7768 6572 6520 7468 6520 696e 6465 780a  where the index.
+000242a0: 2020 2020 2020 2020 6f66 2074 6865 2066          of the f
+000242b0: 6972 7374 206f 6363 7572 656e 6365 206f  irst occurence o
+000242c0: 6620 6120 756e 6971 7565 2063 6f6d 6269  f a unique combi
+000242d0: 6e61 7469 6f6e 206f 6620 6060 696e 7374  nation of ``inst
+000242e0: 616e 6365 2e63 6f6c 756d 6e5f 6e61 6d65  ance.column_name
+000242f0: 7360 600a 2020 2020 2020 2020 6973 2073  s``.        is s
+00024300: 6574 2074 6f20 6060 5472 7565 6060 2c20  et to ``True``, 
+00024310: 616e 6420 6576 6572 7920 6f74 6865 7220  and every other 
+00024320: 6f63 6375 7265 6e63 6520 6973 2073 6574  occurence is set
+00024330: 2074 6f20 6060 4661 6c73 6560 602e 0a0a   to ``False``...
+00024340: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
+00024350: 2020 2020 2020 202d 2044 6174 6146 7261         - DataFra
+00024360: 6d65 2077 6974 6820 6d75 6c74 6970 6c65  me with multiple
+00024370: 206f 6620 7468 6520 7361 6d65 2063 6f6d   of the same com
+00024380: 6269 6e61 7469 6f6e 7320 6f66 2063 6f6c  binations of col
+00024390: 756d 6e73 2e0a 2020 2020 2020 2020 2d20  umns..        - 
+000243a0: 4461 7461 4672 616d 6520 6861 7320 6120  DataFrame has a 
+000243b0: 6375 7374 6f6d 2069 6e64 6578 2063 6f6c  custom index col
+000243c0: 756d 6e20 7768 6963 6820 6973 2073 6574  umn which is set
+000243d0: 2074 6f20 3020 666f 7220 726f 7773 2e0a   to 0 for rows..
+000243e0: 2020 2020 2020 2020 4f75 7470 7574 3a0a          Output:.
+000243f0: 2020 2020 2020 2020 2d20 5365 7269 6573          - Series
+00024400: 2077 6974 6820 7468 6520 696e 6465 7820   with the index 
+00024410: 6f66 2074 6865 2066 6972 7374 206f 6363  of the first occ
+00024420: 7572 656e 6365 7320 7365 7420 746f 2060  urences set to `
+00024430: 6054 7275 6560 602e 0a20 2020 2020 2020  `True``..       
+00024440: 2047 6974 6875 6220 4973 7375 653a 0a20   Github Issue:. 
+00024450: 2020 2020 2020 202d 2050 726f 626c 656d         - Problem
+00024460: 2069 7320 6465 7363 7269 6265 6420 696e   is described in
+00024470: 3a20 6874 7470 733a 2f2f 6769 7468 7562  : https://github
+00024480: 2e63 6f6d 2f73 6476 2d64 6576 2f53 4456  .com/sdv-dev/SDV
+00024490: 2f69 7373 7565 732f 3631 360a 2020 2020  /issues/616.    
+000244a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000244b0: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
+000244c0: 696e 7374 616e 6365 203d 2055 6e69 7175  instance = Uniqu
+000244d0: 6528 636f 6c75 6d6e 5f6e 616d 6573 3d5b  e(column_names=[
+000244e0: 2761 272c 2027 6227 2c20 2763 275d 290a  'a', 'b', 'c']).
+000244f0: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+00024500: 2020 2020 2020 2064 6174 6120 3d20 7064         data = pd
+00024510: 2e44 6174 6146 7261 6d65 287b 0a20 2020  .DataFrame({.   
+00024520: 2020 2020 2020 2020 2027 6127 3a20 5b31           'a': [1
+00024530: 2c20 312c 2032 2c20 322c 2033 5d2c 0a20  , 1, 2, 2, 3],. 
+00024540: 2020 2020 2020 2020 2020 2027 6227 3a20             'b': 
+00024550: 5b35 2c20 352c 2036 2c20 362c 2037 5d2c  [5, 5, 6, 6, 7],
+00024560: 0a20 2020 2020 2020 2020 2020 2027 6327  .            'c'
+00024570: 3a20 5b38 2c20 382c 2039 2c20 392c 2031  : [8, 8, 9, 9, 1
+00024580: 305d 0a20 2020 2020 2020 207d 2c20 696e  0].        }, in
+00024590: 6465 783d 5b30 2c20 302c 2030 2c20 302c  dex=[0, 0, 0, 0,
+000245a0: 2030 5d29 0a20 2020 2020 2020 2076 616c   0]).        val
+000245b0: 6964 203d 2069 6e73 7461 6e63 652e 6973  id = instance.is
+000245c0: 5f76 616c 6964 2864 6174 6129 0a0a 2020  _valid(data)..  
+000245d0: 2020 2020 2020 2320 4173 7365 7274 0a20        # Assert. 
+000245e0: 2020 2020 2020 2065 7870 6563 7465 6420         expected 
+000245f0: 3d20 7064 2e53 6572 6965 7328 5b54 7275  = pd.Series([Tru
+00024600: 652c 2046 616c 7365 2c20 5472 7565 2c20  e, False, True, 
+00024610: 4661 6c73 652c 2054 7275 655d 2c20 696e  False, True], in
+00024620: 6465 783d 5b30 2c20 302c 2030 2c20 302c  dex=[0, 0, 0, 0,
+00024630: 2030 5d29 0a20 2020 2020 2020 2070 642e   0]).        pd.
+00024640: 7465 7374 696e 672e 6173 7365 7274 5f73  testing.assert_s
+00024650: 6572 6965 735f 6571 7561 6c28 7661 6c69  eries_equal(vali
+00024660: 642c 2065 7870 6563 7465 6429 0a0a 2020  d, expected)..  
+00024670: 2020 6465 6620 7465 7374 5f69 735f 7661    def test_is_va
+00024680: 6c69 645f 6375 7374 6f6d 5f69 6e64 6578  lid_custom_index
+00024690: 5f6e 6f74 5f73 6f72 7465 6428 7365 6c66  _not_sorted(self
+000246a0: 293a 0a20 2020 2020 2020 2022 2222 5465  ):.        """Te
+000246b0: 7374 2074 6865 2060 6055 6e69 7175 652e  st the ``Unique.
+000246c0: 6973 5f76 616c 6964 6060 206d 6574 686f  is_valid`` metho
+000246d0: 642e 0a0a 2020 2020 2020 2020 5468 6973  d...        This
+000246e0: 206d 6574 686f 6420 7368 6f75 6c64 2072   method should r
+000246f0: 6574 7572 6e20 6120 7064 2e53 6572 6965  eturn a pd.Serie
+00024700: 7320 7768 6572 6520 7468 6520 696e 6465  s where the inde
+00024710: 780a 2020 2020 2020 2020 6f66 2074 6865  x.        of the
+00024720: 2066 6972 7374 206f 6363 7572 656e 6365   first occurence
+00024730: 206f 6620 6120 756e 6971 7565 2063 6f6d   of a unique com
+00024740: 6269 6e61 7469 6f6e 206f 6620 6060 696e  bination of ``in
+00024750: 7374 616e 6365 2e63 6f6c 756d 6e5f 6e61  stance.column_na
+00024760: 6d65 7360 600a 2020 2020 2020 2020 6973  mes``.        is
+00024770: 2073 6574 2074 6f20 6060 5472 7565 6060   set to ``True``
+00024780: 2c20 616e 6420 6576 6572 7920 6f74 6865  , and every othe
+00024790: 7220 6f63 6375 7265 6e63 6520 6973 2073  r occurence is s
+000247a0: 6574 2074 6f20 6060 4661 6c73 6560 602e  et to ``False``.
+000247b0: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
+000247c0: 0a20 2020 2020 2020 202d 2044 6174 6146  .        - DataF
+000247d0: 7261 6d65 2077 6974 6820 6d75 6c74 6970  rame with multip
+000247e0: 6c65 206f 6620 7468 6520 7361 6d65 2063  le of the same c
+000247f0: 6f6d 6269 6e61 7469 6f6e 7320 6f66 2063  ombinations of c
+00024800: 6f6c 756d 6e73 2e0a 2020 2020 2020 2020  olumns..        
+00024810: 2d20 4461 7461 4672 616d 6520 6861 7320  - DataFrame has 
+00024820: 6120 6375 7374 6f6d 2069 6e64 6578 2063  a custom index c
+00024830: 6f6c 756d 6e20 7768 6963 6820 6973 2073  olumn which is s
+00024840: 6574 2069 6e20 616e 2075 6e73 6f72 7465  et in an unsorte
+00024850: 6420 7761 792e 0a20 2020 2020 2020 204f  d way..        O
+00024860: 7574 7075 743a 0a20 2020 2020 2020 202d  utput:.        -
+00024870: 2053 6572 6965 7320 7769 7468 2074 6865   Series with the
+00024880: 2069 6e64 6578 206f 6620 7468 6520 6669   index of the fi
+00024890: 7273 7420 6f63 6375 7265 6e63 6573 2073  rst occurences s
+000248a0: 6574 2074 6f20 6060 5472 7565 6060 2e0a  et to ``True``..
+000248b0: 2020 2020 2020 2020 4769 7468 7562 2049          Github I
+000248c0: 7373 7565 3a0a 2020 2020 2020 2020 2d20  ssue:.        - 
+000248d0: 5072 6f62 6c65 6d20 6973 2064 6573 6372  Problem is descr
+000248e0: 6962 6564 2069 6e3a 2068 7474 7073 3a2f  ibed in: https:/
+000248f0: 2f67 6974 6875 622e 636f 6d2f 7364 762d  /github.com/sdv-
+00024900: 6465 762f 5344 562f 6973 7375 6573 2f36  dev/SDV/issues/6
+00024910: 3137 0a20 2020 2020 2020 2022 2222 0a20  17.        """. 
+00024920: 2020 2020 2020 2023 2053 6574 7570 0a20         # Setup. 
+00024930: 2020 2020 2020 2069 6e73 7461 6e63 6520         instance 
+00024940: 3d20 556e 6971 7565 2863 6f6c 756d 6e5f  = Unique(column_
+00024950: 6e61 6d65 733d 5b27 6127 2c20 2762 272c  names=['a', 'b',
+00024960: 2027 6327 5d29 0a0a 2020 2020 2020 2020   'c'])..        
+00024970: 2320 5275 6e0a 2020 2020 2020 2020 6461  # Run.        da
+00024980: 7461 203d 2070 642e 4461 7461 4672 616d  ta = pd.DataFram
+00024990: 6528 7b0a 2020 2020 2020 2020 2020 2020  e({.            
+000249a0: 2761 273a 205b 312c 2031 2c20 322c 2032  'a': [1, 1, 2, 2
+000249b0: 2c20 335d 2c0a 2020 2020 2020 2020 2020  , 3],.          
+000249c0: 2020 2762 273a 205b 352c 2035 2c20 362c    'b': [5, 5, 6,
+000249d0: 2036 2c20 375d 2c0a 2020 2020 2020 2020   6, 7],.        
+000249e0: 2020 2020 2763 273a 205b 382c 2038 2c20      'c': [8, 8, 
+000249f0: 392c 2039 2c20 3130 5d0a 2020 2020 2020  9, 9, 10].      
+00024a00: 2020 7d2c 2069 6e64 6578 3d5b 322c 2031    }, index=[2, 1
+00024a10: 2c20 332c 2035 2c20 345d 290a 2020 2020  , 3, 5, 4]).    
+00024a20: 2020 2020 7661 6c69 6420 3d20 696e 7374      valid = inst
+00024a30: 616e 6365 2e69 735f 7661 6c69 6428 6461  ance.is_valid(da
+00024a40: 7461 290a 0a20 2020 2020 2020 2023 2041  ta)..        # A
+00024a50: 7373 6572 740a 2020 2020 2020 2020 6578  ssert.        ex
+00024a60: 7065 6374 6564 203d 2070 642e 5365 7269  pected = pd.Seri
+00024a70: 6573 285b 5472 7565 2c20 4661 6c73 652c  es([True, False,
+00024a80: 2054 7275 652c 2046 616c 7365 2c20 5472   True, False, Tr
+00024a90: 7565 5d2c 2069 6e64 6578 3d5b 322c 2031  ue], index=[2, 1
+00024aa0: 2c20 332c 2035 2c20 345d 290a 2020 2020  , 3, 5, 4]).    
+00024ab0: 2020 2020 7064 2e74 6573 7469 6e67 2e61      pd.testing.a
+00024ac0: 7373 6572 745f 7365 7269 6573 5f65 7175  ssert_series_equ
+00024ad0: 616c 2876 616c 6964 2c20 6578 7065 6374  al(valid, expect
+00024ae0: 6564 290a 0a20 2020 2064 6566 2074 6573  ed)..    def tes
+00024af0: 745f 6973 5f76 616c 6964 5f6f 6e65 5f63  t_is_valid_one_c
+00024b00: 6f6c 756d 6e5f 6375 7374 6f6d 5f69 6e64  olumn_custom_ind
+00024b10: 6578 5f6e 6f74 5f73 6f72 7465 6428 7365  ex_not_sorted(se
+00024b20: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00024b30: 5465 7374 2074 6865 2060 6055 6e69 7175  Test the ``Uniqu
+00024b40: 652e 6973 5f76 616c 6964 6060 206d 6574  e.is_valid`` met
+00024b50: 686f 642e 0a0a 2020 2020 2020 2020 5468  hod...        Th
+00024b60: 6973 206d 6574 686f 6420 7368 6f75 6c64  is method should
+00024b70: 2072 6574 7572 6e20 6120 7064 2e53 6572   return a pd.Ser
+00024b80: 6965 7320 7768 6572 6520 7468 6520 696e  ies where the in
+00024b90: 6465 780a 2020 2020 2020 2020 6f66 2074  dex.        of t
+00024ba0: 6865 2066 6972 7374 206f 6363 7572 656e  he first occuren
+00024bb0: 6365 206f 6620 6120 756e 6971 7565 2076  ce of a unique v
+00024bc0: 616c 7565 206f 6620 6060 7365 6c66 2e63  alue of ``self.c
+00024bd0: 6f6c 756d 6e5f 6e61 6d65 7360 600a 2020  olumn_names``.  
+00024be0: 2020 2020 2020 6973 2073 6574 2074 6f20        is set to 
+00024bf0: 6060 5472 7565 6060 2c20 616e 6420 6576  ``True``, and ev
+00024c00: 6572 7920 6f74 6865 7220 6f63 6375 7265  ery other occure
+00024c10: 6e63 6520 6973 2073 6574 2074 6f20 6060  nce is set to ``
+00024c20: 4661 6c73 6560 602e 0a0a 2020 2020 2020  False``...      
+00024c30: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
+00024c40: 202d 2044 6174 6146 7261 6d65 2077 6974   - DataFrame wit
+00024c50: 6820 6d75 6c74 6970 6c65 206f 6363 7572  h multiple occur
+00024c60: 656e 6365 7320 6f66 2074 6865 2073 616d  ences of the sam
+00024c70: 6520 7661 6c75 6520 6f66 2074 6865 0a20  e value of the. 
+00024c80: 2020 2020 2020 206f 6e65 2063 6f6c 756d         one colum
+00024c90: 6e20 696e 2060 6069 6e73 7461 6e63 652e  n in ``instance.
+00024ca0: 636f 6c75 6d6e 7360 602e 0a20 2020 2020  columns``..     
+00024cb0: 2020 202d 2044 6174 6146 7261 6d65 2068     - DataFrame h
+00024cc0: 6173 2061 2063 7573 746f 6d20 696e 6465  as a custom inde
+00024cd0: 7820 636f 6c75 6d6e 2077 6869 6368 2069  x column which i
+00024ce0: 7320 7365 7420 696e 2061 6e20 756e 736f  s set in an unso
+00024cf0: 7274 6564 2077 6179 2e0a 2020 2020 2020  rted way..      
+00024d00: 2020 4f75 7470 7574 3a0a 2020 2020 2020    Output:.      
+00024d10: 2020 2d20 5365 7269 6573 2077 6974 6820    - Series with 
+00024d20: 7468 6520 696e 6465 7820 6f66 2074 6865  the index of the
+00024d30: 2066 6972 7374 206f 6363 7572 656e 6365   first occurence
+00024d40: 7320 7365 7420 746f 2060 6054 7275 6560  s set to ``True`
+00024d50: 602e 0a20 2020 2020 2020 2047 6974 6875  `..        Githu
+00024d60: 6220 4973 7375 653a 0a20 2020 2020 2020  b Issue:.       
+00024d70: 202d 2050 726f 626c 656d 2069 7320 6465   - Problem is de
+00024d80: 7363 7269 6265 6420 696e 3a20 6874 7470  scribed in: http
+00024d90: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f73  s://github.com/s
+00024da0: 6476 2d64 6576 2f53 4456 2f69 7373 7565  dv-dev/SDV/issue
+00024db0: 732f 3631 370a 2020 2020 2020 2020 2222  s/617.        ""
+00024dc0: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
+00024dd0: 700a 2020 2020 2020 2020 696e 7374 616e  p.        instan
+00024de0: 6365 203d 2055 6e69 7175 6528 636f 6c75  ce = Unique(colu
+00024df0: 6d6e 5f6e 616d 6573 3d27 6127 290a 0a20  mn_names='a').. 
+00024e00: 2020 2020 2020 2023 2052 756e 0a20 2020         # Run.   
+00024e10: 2020 2020 2064 6174 6120 3d20 7064 2e44       data = pd.D
+00024e20: 6174 6146 7261 6d65 287b 0a20 2020 2020  ataFrame({.     
+00024e30: 2020 2020 2020 2027 6127 3a20 5b31 2c20         'a': [1, 
+00024e40: 312c 2031 2c20 322c 2033 2c20 325d 2c0a  1, 1, 2, 3, 2],.
+00024e50: 2020 2020 2020 2020 2020 2020 2762 273a              'b':
+00024e60: 205b 312c 2032 2c20 332c 2034 2c20 352c   [1, 2, 3, 4, 5,
+00024e70: 2036 5d2c 0a20 2020 2020 2020 2020 2020   6],.           
+00024e80: 2027 6327 3a20 5b46 616c 7365 2c20 4661   'c': [False, Fa
+00024e90: 6c73 652c 2054 7275 652c 2046 616c 7365  lse, True, False
+00024ea0: 2c20 4661 6c73 652c 2054 7275 655d 0a20  , False, True]. 
+00024eb0: 2020 2020 2020 207d 2c20 696e 6465 783d         }, index=
+00024ec0: 5b32 2c20 312c 2033 2c20 352c 2034 2c20  [2, 1, 3, 5, 4, 
+00024ed0: 365d 290a 2020 2020 2020 2020 7661 6c69  6]).        vali
+00024ee0: 6420 3d20 696e 7374 616e 6365 2e69 735f  d = instance.is_
+00024ef0: 7661 6c69 6428 6461 7461 290a 0a20 2020  valid(data)..   
+00024f00: 2020 2020 2023 2041 7373 6572 740a 2020       # Assert.  
+00024f10: 2020 2020 2020 6578 7065 6374 6564 203d        expected =
+00024f20: 2070 642e 5365 7269 6573 285b 5472 7565   pd.Series([True
+00024f30: 2c20 4661 6c73 652c 2046 616c 7365 2c20  , False, False, 
+00024f40: 5472 7565 2c20 5472 7565 2c20 4661 6c73  True, True, Fals
+00024f50: 655d 2c20 696e 6465 783d 5b32 2c20 312c  e], index=[2, 1,
+00024f60: 2033 2c20 352c 2034 2c20 365d 290a 2020   3, 5, 4, 6]).  
+00024f70: 2020 2020 2020 7064 2e74 6573 7469 6e67        pd.testing
+00024f80: 2e61 7373 6572 745f 7365 7269 6573 5f65  .assert_series_e
+00024f90: 7175 616c 2876 616c 6964 2c20 6578 7065  qual(valid, expe
+00024fa0: 6374 6564 290a 0a20 2020 2064 6566 2074  cted)..    def t
+00024fb0: 6573 745f 6973 5f76 616c 6964 5f6f 6e65  est_is_valid_one
+00024fc0: 5f63 6f6c 756d 6e5f 6375 7374 6f6d 5f69  _column_custom_i
+00024fd0: 6e64 6578 5f73 616d 655f 7661 6c75 6573  ndex_same_values
+00024fe0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00024ff0: 2222 2254 6573 7420 7468 6520 6060 556e  """Test the ``Un
+00025000: 6971 7565 2e69 735f 7661 6c69 6460 6020  ique.is_valid`` 
+00025010: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
+00025020: 2054 6869 7320 6d65 7468 6f64 2073 686f   This method sho
+00025030: 756c 6420 7265 7475 726e 2061 2070 642e  uld return a pd.
+00025040: 5365 7269 6573 2077 6865 7265 2074 6865  Series where the
+00025050: 2069 6e64 6578 0a20 2020 2020 2020 206f   index.        o
+00025060: 6620 7468 6520 6669 7273 7420 6f63 6375  f the first occu
+00025070: 7265 6e63 6520 6f66 2061 2075 6e69 7175  rence of a uniqu
+00025080: 6520 7661 6c75 6520 6f66 2060 6073 656c  e value of ``sel
+00025090: 662e 636f 6c75 6d6e 5f6e 616d 6573 6060  f.column_names``
+000250a0: 0a20 2020 2020 2020 2069 7320 7365 7420  .        is set 
+000250b0: 746f 2060 6054 7275 6560 602c 2061 6e64  to ``True``, and
+000250c0: 2065 7665 7279 206f 7468 6572 206f 6363   every other occ
+000250d0: 7572 656e 6365 2069 7320 7365 7420 746f  urence is set to
+000250e0: 2060 6046 616c 7365 6060 2e0a 0a20 2020   ``False``...   
+000250f0: 2020 2020 2049 6e70 7574 3a0a 2020 2020       Input:.    
+00025100: 2020 2020 2d20 4461 7461 4672 616d 6520      - DataFrame 
+00025110: 7769 7468 206d 756c 7469 706c 6520 6f63  with multiple oc
+00025120: 6375 7265 6e63 6573 206f 6620 7468 6520  curences of the 
+00025130: 7361 6d65 2076 616c 7565 206f 6620 7468  same value of th
+00025140: 650a 2020 2020 2020 2020 6f6e 6520 636f  e.        one co
+00025150: 6c75 6d6e 2069 6e20 6060 696e 7374 616e  lumn in ``instan
+00025160: 6365 2e63 6f6c 756d 6e73 6060 2e0a 2020  ce.columns``..  
+00025170: 2020 2020 2020 2d20 4461 7461 4672 616d        - DataFram
+00025180: 6520 6861 7320 6120 6375 7374 6f6d 2069  e has a custom i
+00025190: 6e64 6578 2063 6f6c 756d 6e20 7768 6963  ndex column whic
+000251a0: 6820 6973 2073 6574 2074 6f20 3020 666f  h is set to 0 fo
+000251b0: 7220 726f 7773 2e0a 2020 2020 2020 2020  r rows..        
+000251c0: 4f75 7470 7574 3a0a 2020 2020 2020 2020  Output:.        
+000251d0: 2d20 5365 7269 6573 2077 6974 6820 7468  - Series with th
+000251e0: 6520 696e 6465 7820 6f66 2074 6865 2066  e index of the f
+000251f0: 6972 7374 206f 6363 7572 656e 6365 7320  irst occurences 
+00025200: 7365 7420 746f 2060 6054 7275 6560 602e  set to ``True``.
+00025210: 0a20 2020 2020 2020 2047 6974 6875 6220  .        Github 
+00025220: 4973 7375 653a 0a20 2020 2020 2020 202d  Issue:.        -
+00025230: 2050 726f 626c 656d 2069 7320 6465 7363   Problem is desc
+00025240: 7269 6265 6420 696e 3a20 6874 7470 733a  ribed in: https:
+00025250: 2f2f 6769 7468 7562 2e63 6f6d 2f73 6476  //github.com/sdv
+00025260: 2d64 6576 2f53 4456 2f69 7373 7565 732f  -dev/SDV/issues/
+00025270: 3631 360a 2020 2020 2020 2020 2222 220a  616.        """.
+00025280: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
+00025290: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+000252a0: 203d 2055 6e69 7175 6528 636f 6c75 6d6e   = Unique(column
+000252b0: 5f6e 616d 6573 3d27 6127 290a 0a20 2020  _names='a')..   
+000252c0: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
+000252d0: 2020 2064 6174 6120 3d20 7064 2e44 6174     data = pd.Dat
+000252e0: 6146 7261 6d65 287b 0a20 2020 2020 2020  aFrame({.       
+000252f0: 2020 2020 2027 6127 3a20 5b31 2c20 312c       'a': [1, 1,
+00025300: 2031 2c20 322c 2033 2c20 325d 2c0a 2020   1, 2, 3, 2],.  
+00025310: 2020 2020 2020 2020 2020 2762 273a 205b            'b': [
+00025320: 312c 2032 2c20 332c 2034 2c20 352c 2036  1, 2, 3, 4, 5, 6
+00025330: 5d2c 0a20 2020 2020 2020 2020 2020 2027  ],.            '
+00025340: 6327 3a20 5b46 616c 7365 2c20 4661 6c73  c': [False, Fals
+00025350: 652c 2054 7275 652c 2046 616c 7365 2c20  e, True, False, 
+00025360: 4661 6c73 652c 2054 7275 655d 0a20 2020  False, True].   
+00025370: 2020 2020 207d 2c20 696e 6465 783d 5b30       }, index=[0
+00025380: 2c20 302c 2030 2c20 302c 2030 2c20 305d  , 0, 0, 0, 0, 0]
+00025390: 290a 2020 2020 2020 2020 7661 6c69 6420  ).        valid 
+000253a0: 3d20 696e 7374 616e 6365 2e69 735f 7661  = instance.is_va
+000253b0: 6c69 6428 6461 7461 290a 0a20 2020 2020  lid(data)..     
+000253c0: 2020 2023 2041 7373 6572 740a 2020 2020     # Assert.    
+000253d0: 2020 2020 6578 7065 6374 6564 203d 2070      expected = p
+000253e0: 642e 5365 7269 6573 285b 5472 7565 2c20  d.Series([True, 
+000253f0: 4661 6c73 652c 2046 616c 7365 2c20 5472  False, False, Tr
+00025400: 7565 2c20 5472 7565 2c20 4661 6c73 655d  ue, True, False]
+00025410: 2c20 696e 6465 783d 5b30 2c20 302c 2030  , index=[0, 0, 0
+00025420: 2c20 302c 2030 2c20 305d 290a 2020 2020  , 0, 0, 0]).    
+00025430: 2020 2020 7064 2e74 6573 7469 6e67 2e61      pd.testing.a
+00025440: 7373 6572 745f 7365 7269 6573 5f65 7175  ssert_series_equ
+00025450: 616c 2876 616c 6964 2c20 6578 7065 6374  al(valid, expect
+00025460: 6564 290a 0a20 2020 2064 6566 2074 6573  ed)..    def tes
+00025470: 745f 6973 5f76 616c 6964 5f6f 6e65 5f63  t_is_valid_one_c
+00025480: 6f6c 756d 6e28 7365 6c66 293a 0a20 2020  olumn(self):.   
+00025490: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+000254a0: 2060 6055 6e69 7175 652e 6973 5f76 616c   ``Unique.is_val
+000254b0: 6964 6060 206d 6574 686f 642e 0a0a 2020  id`` method...  
+000254c0: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
+000254d0: 6420 7368 6f75 6c64 2072 6574 7572 6e20  d should return 
+000254e0: 6120 7064 2e53 6572 6965 7320 7768 6572  a pd.Series wher
+000254f0: 6520 7468 6520 696e 6465 780a 2020 2020  e the index.    
+00025500: 2020 2020 6f66 2074 6865 2066 6972 7374      of the first
+00025510: 206f 6363 7572 656e 6365 206f 6620 6120   occurence of a 
+00025520: 756e 6971 7565 2076 616c 7565 206f 6620  unique value of 
+00025530: 6060 7365 6c66 2e63 6f6c 756d 6e5f 6e61  ``self.column_na
+00025540: 6d65 7360 600a 2020 2020 2020 2020 6973  mes``.        is
+00025550: 2073 6574 2074 6f20 6060 5472 7565 6060   set to ``True``
+00025560: 2c20 616e 6420 6576 6572 7920 6f74 6865  , and every othe
+00025570: 7220 6f63 6375 7265 6e63 6520 6973 2073  r occurence is s
+00025580: 6574 2074 6f20 6060 4661 6c73 6560 602e  et to ``False``.
+00025590: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
+000255a0: 0a20 2020 2020 2020 202d 2044 6174 6146  .        - DataF
+000255b0: 7261 6d65 2077 6974 6820 6d75 6c74 6970  rame with multip
+000255c0: 6c65 206f 6363 7572 656e 6365 7320 6f66  le occurences of
+000255d0: 2074 6865 2073 616d 6520 7661 6c75 6520   the same value 
+000255e0: 6f66 2074 6865 0a20 2020 2020 2020 206f  of the.        o
+000255f0: 6e65 2063 6f6c 756d 6e20 696e 2060 6069  ne column in ``i
+00025600: 6e73 7461 6e63 652e 636f 6c75 6d6e 7360  nstance.columns`
+00025610: 602e 0a20 2020 2020 2020 204f 7574 7075  `..        Outpu
+00025620: 743a 0a20 2020 2020 2020 202d 2053 6572  t:.        - Ser
+00025630: 6965 7320 7769 7468 2074 6865 2069 6e64  ies with the ind
+00025640: 6578 206f 6620 7468 6520 6669 7273 7420  ex of the first 
+00025650: 6f63 6375 7265 6e63 6573 2073 6574 2074  occurences set t
+00025660: 6f20 6060 5472 7565 6060 2e0a 2020 2020  o ``True``..    
+00025670: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00025680: 2320 5365 7475 700a 2020 2020 2020 2020  # Setup.        
+00025690: 696e 7374 616e 6365 203d 2055 6e69 7175  instance = Uniqu
+000256a0: 6528 636f 6c75 6d6e 5f6e 616d 6573 3d27  e(column_names='
+000256b0: 6127 290a 0a20 2020 2020 2020 2023 2052  a')..        # R
+000256c0: 756e 0a20 2020 2020 2020 2064 6174 6120  un.        data 
+000256d0: 3d20 7064 2e44 6174 6146 7261 6d65 287b  = pd.DataFrame({
+000256e0: 0a20 2020 2020 2020 2020 2020 2027 6127  .            'a'
+000256f0: 3a20 5b31 2c20 312c 2031 2c20 322c 2033  : [1, 1, 1, 2, 3
+00025700: 2c20 325d 2c0a 2020 2020 2020 2020 2020  , 2],.          
+00025710: 2020 2762 273a 205b 312c 2032 2c20 332c    'b': [1, 2, 3,
+00025720: 2034 2c20 352c 2036 5d2c 0a20 2020 2020   4, 5, 6],.     
+00025730: 2020 2020 2020 2027 6327 3a20 5b46 616c         'c': [Fal
+00025740: 7365 2c20 4661 6c73 652c 2054 7275 652c  se, False, True,
+00025750: 2046 616c 7365 2c20 4661 6c73 652c 2054   False, False, T
+00025760: 7275 655d 0a20 2020 2020 2020 207d 290a  rue].        }).
+00025770: 2020 2020 2020 2020 7661 6c69 6420 3d20          valid = 
+00025780: 696e 7374 616e 6365 2e69 735f 7661 6c69  instance.is_vali
+00025790: 6428 6461 7461 290a 0a20 2020 2020 2020  d(data)..       
+000257a0: 2023 2041 7373 6572 740a 2020 2020 2020   # Assert.      
+000257b0: 2020 6578 7065 6374 6564 203d 2070 642e    expected = pd.
+000257c0: 5365 7269 6573 285b 5472 7565 2c20 4661  Series([True, Fa
+000257d0: 6c73 652c 2046 616c 7365 2c20 5472 7565  lse, False, True
+000257e0: 2c20 5472 7565 2c20 4661 6c73 655d 290a  , True, False]).
+000257f0: 2020 2020 2020 2020 7064 2e74 6573 7469          pd.testi
+00025800: 6e67 2e61 7373 6572 745f 7365 7269 6573  ng.assert_series
+00025810: 5f65 7175 616c 2876 616c 6964 2c20 6578  _equal(valid, ex
+00025820: 7065 6374 6564 290a 0a20 2020 2064 6566  pected)..    def
+00025830: 2074 6573 745f 6973 5f76 616c 6964 5f6f   test_is_valid_o
+00025840: 6e65 5f63 6f6c 756d 6e5f 6e61 6e73 2873  ne_column_nans(s
+00025850: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00025860: 2254 6573 7420 7468 6520 6060 556e 6971  "Test the ``Uniq
+00025870: 7565 2e69 735f 7661 6c69 6460 6020 6d65  ue.is_valid`` me
+00025880: 7468 6f64 2066 6f72 206f 6e65 2063 6f6c  thod for one col
+00025890: 756d 6e20 7769 7468 206e 616e 732e 0a0a  umn with nans...
+000258a0: 2020 2020 2020 2020 5468 6973 206d 6574          This met
+000258b0: 686f 6420 7368 6f75 6c64 2072 6574 7572  hod should retur
+000258c0: 6e20 6120 7064 2e53 6572 6965 7320 7768  n a pd.Series wh
+000258d0: 6572 6520 7468 6520 696e 6465 780a 2020  ere the index.  
+000258e0: 2020 2020 2020 6f66 2074 6865 2066 6972        of the fir
+000258f0: 7374 206f 6363 7572 656e 6365 206f 6620  st occurence of 
+00025900: 6120 756e 6971 7565 2076 616c 7565 206f  a unique value o
+00025910: 6620 6060 696e 7374 616e 6365 2e63 6f6c  f ``instance.col
+00025920: 756d 6e5f 6e61 6d65 7360 600a 2020 2020  umn_names``.    
+00025930: 2020 2020 6973 2073 6574 2074 6f20 6060      is set to ``
+00025940: 5472 7565 6060 2c20 616e 6420 6576 6572  True``, and ever
+00025950: 7920 6f74 6865 7220 6f63 6375 7265 6e63  y other occurenc
+00025960: 6520 6973 2073 6574 2074 6f20 6060 4661  e is set to ``Fa
+00025970: 6c73 6560 602e 0a20 2020 2020 2020 2060  lse``..        `
+00025980: 604e 6f6e 6560 602c 2060 606e 702e 6e61  `None``, ``np.na
+00025990: 6e60 6020 616e 6420 6060 666c 6f61 7428  n`` and ``float(
+000259a0: 276e 616e 2729 6060 2073 686f 756c 6420  'nan')`` should 
+000259b0: 6265 2074 7265 6174 6564 2061 7320 7468  be treated as th
+000259c0: 6520 7361 6d65 2063 6174 6567 6f72 792e  e same category.
+000259d0: 0a0a 2020 2020 2020 2020 496e 7075 743a  ..        Input:
+000259e0: 0a20 2020 2020 2020 202d 2044 6174 6146  .        - DataF
+000259f0: 7261 6d65 2077 6974 6820 736f 6d65 2072  rame with some r
+00025a00: 6570 6561 7465 6420 7661 6c75 6573 2c20  epeated values, 
+00025a10: 736f 6d65 206f 6620 7768 6963 6820 6172  some of which ar
+00025a20: 6520 6e61 6e27 732e 0a20 2020 2020 2020  e nan's..       
+00025a30: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
+00025a40: 202d 2053 6572 6965 7320 7769 7468 2074   - Series with t
+00025a50: 6865 2069 6e64 6578 206f 6620 7468 6520  he index of the 
+00025a60: 6669 7273 7420 6f63 6375 7265 6e63 6573  first occurences
+00025a70: 2073 6574 2074 6f20 6060 5472 7565 6060   set to ``True``
+00025a80: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00025a90: 2020 2020 2020 2320 5365 7475 700a 2020        # Setup.  
+00025aa0: 2020 2020 2020 696e 7374 616e 6365 203d        instance =
+00025ab0: 2055 6e69 7175 6528 636f 6c75 6d6e 5f6e   Unique(column_n
+00025ac0: 616d 6573 3d5b 2761 275d 290a 0a20 2020  ames=['a'])..   
+00025ad0: 2020 2020 2023 2052 756e 0a20 2020 2020       # Run.     
+00025ae0: 2020 2064 6174 6120 3d20 7064 2e44 6174     data = pd.Dat
+00025af0: 6146 7261 6d65 287b 0a20 2020 2020 2020  aFrame({.       
+00025b00: 2020 2020 2027 6127 3a20 5b31 2c20 4e6f       'a': [1, No
+00025b10: 6e65 2c20 322c 206e 702e 6e61 6e2c 2066  ne, 2, np.nan, f
+00025b20: 6c6f 6174 2827 6e61 6e27 292c 2031 5d2c  loat('nan'), 1],
+00025b30: 0a20 2020 2020 2020 2020 2020 2027 6227  .            'b'
+00025b40: 3a20 5b6e 702e 6e61 6e2c 2031 2c20 4e6f  : [np.nan, 1, No
+00025b50: 6e65 2c20 666c 6f61 7428 276e 616e 2729  ne, float('nan')
+00025b60: 2c20 666c 6f61 7428 276e 616e 2729 2c20  , float('nan'), 
+00025b70: 315d 2c0a 2020 2020 2020 2020 7d29 0a20  1],.        }). 
+00025b80: 2020 2020 2020 2076 616c 6964 203d 2069         valid = i
+00025b90: 6e73 7461 6e63 652e 6973 5f76 616c 6964  nstance.is_valid
+00025ba0: 2864 6174 6129 0a0a 2020 2020 2020 2020  (data)..        
+00025bb0: 2320 4173 7365 7274 0a20 2020 2020 2020  # Assert.       
+00025bc0: 2065 7870 6563 7465 6420 3d20 7064 2e53   expected = pd.S
+00025bd0: 6572 6965 7328 5b54 7275 652c 2054 7275  eries([True, Tru
+00025be0: 652c 2054 7275 652c 2046 616c 7365 2c20  e, True, False, 
+00025bf0: 4661 6c73 652c 2046 616c 7365 5d29 0a20  False, False]). 
+00025c00: 2020 2020 2020 2070 642e 7465 7374 696e         pd.testin
+00025c10: 672e 6173 7365 7274 5f73 6572 6965 735f  g.assert_series_
+00025c20: 6571 7561 6c28 7661 6c69 642c 2065 7870  equal(valid, exp
+00025c30: 6563 7465 6429 0a0a 2020 2020 6465 6620  ected)..    def 
+00025c40: 7465 7374 5f69 735f 7661 6c69 645f 6d75  test_is_valid_mu
+00025c50: 6c74 6970 6c65 5f63 6f6c 756d 6e73 5f6e  ltiple_columns_n
+00025c60: 616e 7328 7365 6c66 293a 0a20 2020 2020  ans(self):.     
+00025c70: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
+00025c80: 6055 6e69 7175 652e 6973 5f76 616c 6964  `Unique.is_valid
+00025c90: 6060 206d 6574 686f 6420 666f 7220 6d75  `` method for mu
+00025ca0: 6c74 6970 6c65 2063 6f6c 756d 6e73 2077  ltiple columns w
+00025cb0: 6974 6820 6e61 6e73 2e0a 0a20 2020 2020  ith nans...     
+00025cc0: 2020 2054 6869 7320 6d65 7468 6f64 2073     This method s
+00025cd0: 686f 756c 6420 7265 7475 726e 2061 2070  hould return a p
+00025ce0: 642e 5365 7269 6573 2077 6865 7265 2074  d.Series where t
+00025cf0: 6865 2069 6e64 6578 0a20 2020 2020 2020  he index.       
+00025d00: 206f 6620 7468 6520 6669 7273 7420 6f63   of the first oc
+00025d10: 6375 7265 6e63 6520 6f66 2061 2075 6e69  curence of a uni
+00025d20: 7175 6520 636f 6d62 696e 6174 696f 6e20  que combination 
+00025d30: 6f66 2060 6069 6e73 7461 6e63 652e 636f  of ``instance.co
+00025d40: 6c75 6d6e 5f6e 616d 6573 6060 0a20 2020  lumn_names``.   
+00025d50: 2020 2020 2069 7320 7365 7420 746f 2060       is set to `
+00025d60: 6054 7275 6560 602c 2061 6e64 2065 7665  `True``, and eve
+00025d70: 7279 206f 7468 6572 206f 6363 7572 656e  ry other occuren
+00025d80: 6365 2069 7320 7365 7420 746f 2060 6046  ce is set to ``F
+00025d90: 616c 7365 6060 2e0a 2020 2020 2020 2020  alse``..        
+00025da0: 6060 4e6f 6e65 6060 2c20 6060 6e70 2e6e  ``None``, ``np.n
+00025db0: 616e 6060 2061 6e64 2060 6066 6c6f 6174  an`` and ``float
+00025dc0: 2827 6e61 6e27 2960 6020 7368 6f75 6c64  ('nan')`` should
+00025dd0: 2062 6520 7472 6561 7465 6420 6173 2074   be treated as t
+00025de0: 6865 2073 616d 6520 6361 7465 676f 7279  he same category
+00025df0: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
+00025e00: 3a0a 2020 2020 2020 2020 2d20 4461 7461  :.        - Data
+00025e10: 4672 616d 6520 7769 7468 206d 756c 7469  Frame with multi
+00025e20: 706c 6520 6f66 2074 6865 2073 616d 6520  ple of the same 
+00025e30: 636f 6d62 696e 6174 696f 6e73 206f 6620  combinations of 
+00025e40: 636f 6c75 6d6e 732c 2073 6f6d 6520 6f66  columns, some of
+00025e50: 2077 6869 6368 2061 7265 206e 616e 2773   which are nan's
+00025e60: 2e0a 2020 2020 2020 2020 4f75 7470 7574  ..        Output
+00025e70: 3a0a 2020 2020 2020 2020 2d20 5365 7269  :.        - Seri
+00025e80: 6573 2077 6974 6820 7468 6520 696e 6465  es with the inde
+00025e90: 7820 6f66 2074 6865 2066 6972 7374 206f  x of the first o
+00025ea0: 6363 7572 656e 6365 7320 7365 7420 746f  ccurences set to
+00025eb0: 2060 6054 7275 6560 602e 0a20 2020 2020   ``True``..     
+00025ec0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00025ed0: 2053 6574 7570 0a20 2020 2020 2020 2069   Setup.        i
+00025ee0: 6e73 7461 6e63 6520 3d20 556e 6971 7565  nstance = Unique
+00025ef0: 2863 6f6c 756d 6e5f 6e61 6d65 733d 5b27  (column_names=['
+00025f00: 6127 2c20 2762 275d 290a 0a20 2020 2020  a', 'b'])..     
+00025f10: 2020 2023 2052 756e 0a20 2020 2020 2020     # Run.       
+00025f20: 2064 6174 6120 3d20 7064 2e44 6174 6146   data = pd.DataF
+00025f30: 7261 6d65 287b 0a20 2020 2020 2020 2020  rame({.         
+00025f40: 2020 2027 6127 3a20 5b31 2c20 4e6f 6e65     'a': [1, None
+00025f50: 2c20 312c 206e 702e 6e61 6e2c 2066 6c6f  , 1, np.nan, flo
+00025f60: 6174 2827 6e61 6e27 292c 2031 5d2c 0a20  at('nan'), 1],. 
+00025f70: 2020 2020 2020 2020 2020 2027 6227 3a20             'b': 
+00025f80: 5b6e 702e 6e61 6e2c 2031 2c20 4e6f 6e65  [np.nan, 1, None
+00025f90: 2c20 666c 6f61 7428 276e 616e 2729 2c20  , float('nan'), 
+00025fa0: 666c 6f61 7428 276e 616e 2729 2c20 315d  float('nan'), 1]
+00025fb0: 2c0a 2020 2020 2020 2020 7d29 0a20 2020  ,.        }).   
+00025fc0: 2020 2020 2076 616c 6964 203d 2069 6e73       valid = ins
+00025fd0: 7461 6e63 652e 6973 5f76 616c 6964 2864  tance.is_valid(d
+00025fe0: 6174 6129 0a0a 2020 2020 2020 2020 2320  ata)..        # 
+00025ff0: 4173 7365 7274 0a20 2020 2020 2020 2065  Assert.        e
+00026000: 7870 6563 7465 6420 3d20 7064 2e53 6572  xpected = pd.Ser
+00026010: 6965 7328 5b54 7275 652c 2054 7275 652c  ies([True, True,
+00026020: 2046 616c 7365 2c20 5472 7565 2c20 4661   False, True, Fa
+00026030: 6c73 652c 2054 7275 655d 290a 2020 2020  lse, True]).    
+00026040: 2020 2020 7064 2e74 6573 7469 6e67 2e61      pd.testing.a
+00026050: 7373 6572 745f 7365 7269 6573 5f65 7175  ssert_series_equ
+00026060: 616c 2876 616c 6964 2c20 6578 7065 6374  al(valid, expect
+00026070: 6564 290a 0a0a 636c 6173 7320 5465 7374  ed)...class Test
+00026080: 4669 7865 6449 6e63 7265 6d65 6e74 7328  FixedIncrements(
+00026090: 293a 0a0a 2020 2020 6465 6620 7465 7374  ):..    def test
+000260a0: 5f5f 7661 6c69 6461 7465 5f69 6e70 7574  __validate_input
+000260b0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+000260c0: 2022 2222 5465 7374 2074 6865 2060 6046   """Test the ``F
+000260d0: 6978 6564 496e 6372 656d 656e 7473 2e5f  ixedIncrements._
+000260e0: 7661 6c69 6461 7465 5f69 6e70 7574 7360  validate_inputs`
+000260f0: 6020 6d65 7468 6f64 2e0a 0a20 2020 2020  ` method...     
+00026100: 2020 2049 6e70 7574 3a0a 2020 2020 2020     Input:.      
+00026110: 2020 2d20 2049 6e63 6f72 7265 6374 2070    -  Incorrect p
+00026120: 6172 616d 6574 6572 7320 666f 7220 7468  arameters for th
+00026130: 6520 6d65 7468 6f64 0a20 2020 2020 2020  e method.       
+00026140: 2052 6169 7365 733a 0a20 2020 2020 2020   Raises:.       
+00026150: 202d 204c 6973 7420 6f66 2056 616c 7565   - List of Value
+00026160: 4572 726f 7273 0a20 2020 2020 2020 2022  Errors.        "
+00026170: 2222 0a20 2020 2020 2020 2065 7272 5f6d  "".        err_m
+00026180: 7367 203d 2028 0a20 2020 2020 2020 2020  sg = (.         
+00026190: 2020 2072 274d 6973 7369 6e67 2072 6571     r'Missing req
+000261a0: 7569 7265 6420 7661 6c75 6573 207b 282e  uired values {(.
+000261b0: 2a29 7d20 696e 2061 2046 6978 6564 496e  *)} in a FixedIn
+000261c0: 6372 656d 656e 7473 2063 6f6e 7374 7261  crements constra
+000261d0: 696e 742e 270a 2020 2020 2020 2020 2020  int.'.          
+000261e0: 2020 7227 5c6e 5c6e 496e 7661 6c69 6420    r'\n\nInvalid 
+000261f0: 7661 6c75 6573 207b 282e 2a29 7d20 6172  values {(.*)} ar
+00026200: 6520 7072 6573 656e 7420 696e 2061 2046  e present in a F
+00026210: 6978 6564 496e 6372 656d 656e 7473 2063  ixedIncrements c
+00026220: 6f6e 7374 7261 696e 742e 270a 2020 2020  onstraint.'.    
+00026230: 2020 2020 2020 2020 7227 5c6e 5c6e 496e          r'\n\nIn
+00026240: 7661 6c69 6420 696e 6372 656d 656e 7420  valid increment 
+00026250: 7661 6c75 6520 7b28 2e2a 297d 2069 6e20  value {(.*)} in 
+00026260: 6120 4669 7865 6449 6e63 7265 6d65 6e74  a FixedIncrement
+00026270: 7320 636f 6e73 7472 6169 6e74 2e27 0a20  s constraint.'. 
+00026280: 2020 2020 2020 2020 2020 2027 2049 6e63             ' Inc
+00026290: 7265 6d65 6e74 7320 6d75 7374 2062 6520  rements must be 
+000262a0: 706f 7369 7469 7665 2069 6e74 6567 6572  positive integer
+000262b0: 732e 270a 2020 2020 2020 2020 290a 2020  s.'.        ).  
+000262c0: 2020 2020 2020 2320 5275 6e20 2f20 4173        # Run / As
+000262d0: 7365 7274 0a20 2020 2020 2020 2077 6974  sert.        wit
+000262e0: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+000262f0: 4167 6772 6567 6174 6543 6f6e 7374 7261  AggregateConstra
+00026300: 696e 7473 4572 726f 7229 2061 7320 6572  intsError) as er
+00026310: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+00026320: 2046 6978 6564 496e 6372 656d 656e 7473   FixedIncrements
+00026330: 2e5f 7661 6c69 6461 7465 5f69 6e70 7574  ._validate_input
+00026340: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
+00026350: 2020 206e 6f74 5f63 6f6c 756d 6e5f 6e61     not_column_na
+00026360: 6d65 3d4e 6f6e 652c 2069 6e63 7265 6d65  me=None, increme
+00026370: 6e74 5f76 616c 7565 3d2d 312c 2073 6f6d  nt_value=-1, som
+00026380: 6574 6869 6e67 5f65 6c73 653d 4e6f 6e65  ething_else=None
+00026390: 290a 0a20 2020 2020 2020 2067 726f 7570  )..        group
+000263a0: 7320 3d20 7265 2e73 6561 7263 6828 6572  s = re.search(er
+000263b0: 725f 6d73 672c 2073 7472 2865 7272 6f72  r_msg, str(error
+000263c0: 2e76 616c 7565 2929 0a20 2020 2020 2020  .value)).       
+000263d0: 2061 7373 6572 7420 6772 6f75 7073 2069   assert groups i
+000263e0: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2020  s not None.     
+000263f0: 2020 2061 7373 6572 7420 7374 7228 6576     assert str(ev
+00026400: 616c 2867 726f 7570 732e 6772 6f75 7028  al(groups.group(
+00026410: 3129 2929 203d 3d20 2763 6f6c 756d 6e5f  1))) == 'column_
+00026420: 6e61 6d65 270a 2020 2020 2020 2020 6173  name'.        as
+00026430: 7365 7274 2073 6574 2865 7661 6c28 6772  sert set(eval(gr
+00026440: 6f75 7073 2e67 726f 7570 2832 2929 2920  oups.group(2))) 
+00026450: 3d3d 207b 2773 6f6d 6574 6869 6e67 5f65  == {'something_e
+00026460: 6c73 6527 2c20 276e 6f74 5f63 6f6c 756d  lse', 'not_colum
+00026470: 6e5f 6e61 6d65 277d 0a20 2020 2020 2020  n_name'}.       
+00026480: 2061 7373 6572 7420 696e 7428 6576 616c   assert int(eval
+00026490: 2867 726f 7570 732e 6772 6f75 7028 3329  (groups.group(3)
+000264a0: 2929 203d 3d20 2d31 0a0a 2020 2020 6465  )) == -1..    de
+000264b0: 6620 7465 7374 5f5f 7661 6c69 6461 7465  f test__validate
+000264c0: 5f6d 6574 6164 6174 615f 636f 6c75 6d6e  _metadata_column
+000264d0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
+000264e0: 2022 2222 5465 7374 2074 6865 2060 605f   """Test the ``_
+000264f0: 7661 6c69 6461 7465 5f6d 6574 6164 6174  validate_metadat
+00026500: 615f 636f 6c75 6d6e 7360 6020 6d65 7468  a_columns`` meth
+00026510: 6f64 2e0a 0a20 2020 2020 2020 2054 6865  od...        The
+00026520: 2063 6f6c 756d 6e20 7061 7373 6564 2069   column passed i
+00026530: 6e20 636f 6c75 6d6e 5f6e 616d 6520 7368  n column_name sh
+00026540: 6f75 6c64 2062 6520 696e 2074 6865 206d  ould be in the m
+00026550: 6574 6164 6174 612e 0a0a 2020 2020 2020  etadata...      
+00026560: 2020 496e 7075 743a 0a20 2020 2020 2020    Input:.       
+00026570: 2020 2020 202d 2063 6f6c 756d 6e5f 6e61       - column_na
+00026580: 6d65 2074 6861 7420 6973 2069 6e20 7468  me that is in th
+00026590: 6520 6d65 7461 6461 7461 2e0a 0a20 2020  e metadata...   
+000265a0: 2020 2020 2053 6964 6520 6566 6665 6374       Side effect
+000265b0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+000265c0: 4e6f 2065 7272 6f72 2073 686f 756c 6420  No error should 
+000265d0: 6265 2072 6169 7365 642e 0a20 2020 2020  be raised..     
+000265e0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+000265f0: 2053 6574 7570 0a20 2020 2020 2020 206d   Setup.        m
+00026600: 6574 6164 6174 6120 3d20 4d6f 636b 2829  etadata = Mock()
+00026610: 0a20 2020 2020 2020 206d 6574 6164 6174  .        metadat
+00026620: 612e 636f 6c75 6d6e 7320 3d20 7b27 6127  a.columns = {'a'
+00026630: 3a20 312c 2027 6227 3a20 327d 0a0a 2020  : 1, 'b': 2}..  
+00026640: 2020 2020 2020 2320 5275 6e0a 2020 2020        # Run.    
+00026650: 2020 2020 4669 7865 6449 6e63 7265 6d65      FixedIncreme
+00026660: 6e74 732e 5f76 616c 6964 6174 655f 6d65  nts._validate_me
+00026670: 7461 6461 7461 5f63 6f6c 756d 6e73 286d  tadata_columns(m
+00026680: 6574 6164 6174 612c 2063 6f6c 756d 6e5f  etadata, column_
+00026690: 6e61 6d65 3d27 6127 290a 0a20 2020 2064  name='a')..    d
+000266a0: 6566 2074 6573 745f 5f76 616c 6964 6174  ef test__validat
+000266b0: 655f 6d65 7461 6461 7461 5f63 6f6c 756d  e_metadata_colum
+000266c0: 6e73 5f72 6169 7365 735f 6572 726f 7228  ns_raises_error(
+000266d0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+000266e0: 2222 5465 7374 2074 6865 2060 605f 7661  ""Test the ``_va
+000266f0: 6c69 6461 7465 5f6d 6574 6164 6174 615f  lidate_metadata_
+00026700: 636f 6c75 6d6e 7360 6020 6d65 7468 6f64  columns`` method
+00026710: 2773 2065 7272 6f72 2063 6f6e 6469 7469  's error conditi
+00026720: 6f6e 2e0a 0a20 2020 2020 2020 2049 6620  on...        If 
+00026730: 636f 6c75 6d6e 5f6e 616d 6520 6973 206e  column_name is n
+00026740: 6f74 2069 6e20 7468 6520 6d65 7461 6461  ot in the metada
+00026750: 7461 2c20 616e 2065 7272 6f72 2073 686f  ta, an error sho
+00026760: 756c 6420 6265 2072 6169 7365 642e 0a0a  uld be raised...
+00026770: 2020 2020 2020 2020 496e 7075 743a 0a20          Input:. 
+00026780: 2020 2020 2020 2020 2020 202d 2063 6f6c             - col
+00026790: 756d 6e5f 6e61 6d65 2074 6861 7420 6973  umn_name that is
+000267a0: 206e 6f74 2069 6e20 7468 6520 6d65 7461   not in the meta
+000267b0: 6461 7461 2e0a 0a20 2020 2020 2020 2053  data...        S
+000267c0: 6964 6520 6566 6665 6374 3a0a 2020 2020  ide effect:.    
+000267d0: 2020 2020 2020 2020 2d20 436f 6e73 7472          - Constr
+000267e0: 6169 6e74 4d65 7461 6461 7461 4572 726f  aintMetadataErro
+000267f0: 7220 7368 6f75 6c64 2062 6520 7261 6973  r should be rais
+00026800: 6564 2e0a 2020 2020 2020 2020 2222 220a  ed..        """.
+00026810: 2020 2020 2020 2020 2320 5365 7475 700a          # Setup.
+00026820: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
+00026830: 203d 204d 6f63 6b28 290a 2020 2020 2020   = Mock().      
+00026840: 2020 6d65 7461 6461 7461 2e63 6f6c 756d    metadata.colum
+00026850: 6e73 203d 207b 2761 273a 2031 2c20 2762  ns = {'a': 1, 'b
+00026860: 273a 2032 7d0a 0a20 2020 2020 2020 2023  ': 2}..        #
+00026870: 2052 756e 0a20 2020 2020 2020 2065 7272   Run.        err
+00026880: 6f72 5f6d 6573 7361 6765 203d 2072 652e  or_message = re.
+00026890: 6573 6361 7065 280a 2020 2020 2020 2020  escape(.        
+000268a0: 2020 2020 2741 2046 6978 6564 496e 6372      'A FixedIncr
+000268b0: 656d 656e 7473 2063 6f6e 7374 7261 696e  ements constrain
+000268c0: 7420 6973 2062 6569 6e67 2061 7070 6c69  t is being appli
+000268d0: 6564 2074 6f20 696e 7661 6c69 6420 636f  ed to invalid co
+000268e0: 6c75 6d6e 206e 616d 6573 2027 0a20 2020  lumn names '.   
+000268f0: 2020 2020 2020 2020 2022 7b27 6327 7d2e           "{'c'}.
+00026900: 2054 6865 2063 6f6c 756d 6e73 206d 7573   The columns mus
+00026910: 7420 6578 6973 7420 696e 2074 6865 2074  t exist in the t
+00026920: 6162 6c65 2e22 0a20 2020 2020 2020 2029  able.".        )
+00026930: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+00026940: 7465 7374 2e72 6169 7365 7328 436f 6e73  test.raises(Cons
+00026950: 7472 6169 6e74 4d65 7461 6461 7461 4572  traintMetadataEr
+00026960: 726f 722c 206d 6174 6368 3d65 7272 6f72  ror, match=error
+00026970: 5f6d 6573 7361 6765 293a 0a20 2020 2020  _message):.     
+00026980: 2020 2020 2020 2046 6978 6564 496e 6372         FixedIncr
+00026990: 656d 656e 7473 2e5f 7661 6c69 6461 7465  ements._validate
+000269a0: 5f6d 6574 6164 6174 615f 636f 6c75 6d6e  _metadata_column
+000269b0: 7328 6d65 7461 6461 7461 2c20 636f 6c75  s(metadata, colu
+000269c0: 6d6e 5f6e 616d 653d 2763 2729 0a0a 2020  mn_name='c')..  
+000269d0: 2020 6465 6620 7465 7374 5f5f 5f69 6e69    def test___ini
+000269e0: 745f 5f28 7365 6c66 293a 0a20 2020 2020  t__(self):.     
+000269f0: 2020 2022 2222 5465 7374 2074 6865 2060     """Test the `
+00026a00: 6046 6978 6564 496e 6372 656d 656e 7473  `FixedIncrements
+00026a10: 2e5f 5f69 6e69 745f 5f60 6020 6d65 7468  .__init__`` meth
+00026a20: 6f64 2e0a 0a20 2020 2020 2020 2054 6865  od...        The
+00026a30: 2060 6063 6f6c 756d 6e5f 6e61 6d65 6060   ``column_name``
+00026a40: 2061 6e64 2060 6069 6e63 7265 6d65 6e74   and ``increment
+00026a50: 5f76 616c 7565 6060 2069 6e73 7461 6e63  _value`` instanc
+00026a60: 6520 7661 7269 6162 6c65 7320 7368 6f75  e variables shou
+00026a70: 6c64 2062 6520 7365 742e 0a0a 2020 2020  ld be set...    
+00026a80: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
+00026a90: 2020 2020 2020 202d 2063 6f6c 756d 6e20         - column 
+00026aa0: 6e61 6d65 2061 7320 6120 7374 7269 6e67  name as a string
+00026ab0: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+00026ac0: 696e 6372 656d 656e 745f 7661 6c75 6520  increment_value 
+00026ad0: 6173 2061 6e20 696e 742e 0a0a 2020 2020  as an int...    
+00026ae0: 2020 2020 4578 7065 6374 6564 2062 6568      Expected beh
+00026af0: 6176 696f 723a 0a20 2020 2020 2020 2020  avior:.         
+00026b00: 2020 202d 2049 6e73 7461 6e63 6520 7769     - Instance wi
+00026b10: 7468 2060 6063 6f6c 756d 6e5f 6e61 6d65  th ``column_name
+00026b20: 6060 2061 6e64 2060 6069 6e63 7265 6d65  `` and ``increme
+00026b30: 6e74 5f76 616c 7565 6060 2073 6574 2e0a  nt_value`` set..
+00026b40: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00026b50: 2020 2020 2320 5275 6e0a 2020 2020 2020      # Run.      
+00026b60: 2020 696e 7374 616e 6365 203d 2046 6978    instance = Fix
+00026b70: 6564 496e 6372 656d 656e 7473 2863 6f6c  edIncrements(col
+00026b80: 756d 6e5f 6e61 6d65 3d27 636f 6c75 6d6e  umn_name='column
+00026b90: 272c 2069 6e63 7265 6d65 6e74 5f76 616c  ', increment_val
+00026ba0: 7565 3d35 290a 0a20 2020 2020 2020 2023  ue=5)..        #
+00026bb0: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
+00026bc0: 6173 7365 7274 2069 6e73 7461 6e63 652e  assert instance.
+00026bd0: 636f 6c75 6d6e 5f6e 616d 6520 3d3d 2027  column_name == '
+00026be0: 636f 6c75 6d6e 270a 2020 2020 2020 2020  column'.        
+00026bf0: 6173 7365 7274 2069 6e73 7461 6e63 652e  assert instance.
+00026c00: 696e 6372 656d 656e 745f 7661 6c75 6520  increment_value 
+00026c10: 3d3d 2035 0a20 2020 2020 2020 2061 7373  == 5.        ass
+00026c20: 6572 7420 696e 7374 616e 6365 2e63 6f6e  ert instance.con
+00026c30: 7374 7261 696e 745f 636f 6c75 6d6e 7320  straint_columns 
+00026c40: 3d3d 2028 2763 6f6c 756d 6e27 2c20 290a  == ('column', ).
+00026c50: 0a20 2020 2064 6566 2074 6573 745f 5f5f  .    def test___
+00026c60: 696e 6974 5f5f 5f69 6e63 7265 6d65 6e74  init___increment
+00026c70: 5f76 616c 7565 5f69 735f 6e65 6761 7469  _value_is_negati
+00026c80: 7665 5f6e 756d 6265 7228 7365 6c66 293a  ve_number(self):
+00026c90: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+00026ca0: 2074 6865 2060 6046 6978 6564 496e 6372   the ``FixedIncr
+00026cb0: 656d 656e 7473 2e5f 5f69 6e69 745f 5f20  ements.__init__ 
+00026cc0: 6d65 7468 6f64 2077 6974 6820 6120 6e65  method with a ne
+00026cd0: 6761 7469 7665 2069 6e63 7265 6d65 6e74  gative increment
+00026ce0: 2e0a 0a20 2020 2020 2020 2049 6620 7468  ...        If th
+00026cf0: 6520 6060 696e 6372 656d 656e 745f 7661  e ``increment_va
+00026d00: 6c75 6560 6020 6973 206c 6573 7320 7468  lue`` is less th
+00026d10: 616e 206f 7220 6571 7561 6c20 746f 2030  an or equal to 0
+00026d20: 2c20 7468 656e 2061 6e20 6572 726f 7220  , then an error 
+00026d30: 7368 6f75 6c64 2062 6520 7261 6973 6564  should be raised
+00026d40: 2e0a 0a20 2020 2020 2020 2049 6e70 7574  ...        Input
+00026d50: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+00026d60: 636f 6c75 6d6e 206e 616d 6520 6173 2061  column name as a
+00026d70: 2073 7472 696e 672e 0a20 2020 2020 2020   string..       
+00026d80: 2020 2020 202d 2069 6e63 7265 6d65 6e74       - increment
+00026d90: 5f76 616c 7565 2061 7320 2d31 0a0a 2020  _value as -1..  
+00026da0: 2020 2020 2020 4578 7065 6374 6564 2062        Expected b
+00026db0: 6568 6176 696f 723a 0a20 2020 2020 2020  ehavior:.       
+00026dc0: 2020 2020 202d 2060 6056 616c 7565 4572       - ``ValueEr
+00026dd0: 726f 7260 6020 7368 6f75 6c64 2062 6520  ror`` should be 
+00026de0: 7261 6973 6564 2e0a 2020 2020 2020 2020  raised..        
+00026df0: 2222 220a 2020 2020 2020 2020 2320 5275  """.        # Ru
+00026e00: 6e20 2f20 4173 7365 7274 0a20 2020 2020  n / Assert.     
+00026e10: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+00026e20: 203d 2027 5468 6520 696e 6372 656d 656e   = 'The incremen
+00026e30: 745f 7661 6c75 6520 6d75 7374 2062 6520  t_value must be 
+00026e40: 6772 6561 7465 7220 7468 616e 2030 2e27  greater than 0.'
+00026e50: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+00026e60: 7465 7374 2e72 6169 7365 7328 5661 6c75  test.raises(Valu
+00026e70: 6545 7272 6f72 2c20 6d61 7463 683d 6572  eError, match=er
+00026e80: 726f 725f 6d65 7373 6167 6529 3a0a 2020  ror_message):.  
+00026e90: 2020 2020 2020 2020 2020 4669 7865 6449            FixedI
+00026ea0: 6e63 7265 6d65 6e74 7328 636f 6c75 6d6e  ncrements(column
+00026eb0: 5f6e 616d 653d 2763 6f6c 756d 6e27 2c20  _name='column', 
+00026ec0: 696e 6372 656d 656e 745f 7661 6c75 653d  increment_value=
+00026ed0: 2d31 290a 0a20 2020 2064 6566 2074 6573  -1)..    def tes
+00026ee0: 745f 5f5f 696e 6974 5f5f 5f69 6e63 7265  t___init___incre
+00026ef0: 6d65 6e74 5f76 616c 7565 5f69 735f 6465  ment_value_is_de
+00026f00: 6369 6d61 6c28 7365 6c66 293a 0a20 2020  cimal(self):.   
+00026f10: 2020 2020 2022 2222 5465 7374 2074 6865       """Test the
+00026f20: 2060 6046 6978 6564 496e 6372 656d 656e   ``FixedIncremen
+00026f30: 7473 2e5f 5f69 6e69 745f 5f20 6d65 7468  ts.__init__ meth
+00026f40: 6f64 2077 6974 6820 6120 6465 6369 6d61  od with a decima
+00026f50: 6c20 6173 2061 6e20 696e 6372 656d 656e  l as an incremen
+00026f60: 742e 0a0a 2020 2020 2020 2020 4966 2074  t...        If t
+00026f70: 6865 2060 6069 6e63 7265 6d65 6e74 5f76  he ``increment_v
+00026f80: 616c 7565 6060 2069 7320 6e6f 7420 6120  alue`` is not a 
+00026f90: 7768 6f6c 6520 6e75 6d62 6572 2c20 7468  whole number, th
+00026fa0: 656e 2061 6e20 6572 726f 7220 7368 6f75  en an error shou
+00026fb0: 6c64 2062 6520 7261 6973 6564 2e0a 0a20  ld be raised... 
+00026fc0: 2020 2020 2020 2049 6e70 7574 3a0a 2020         Input:.  
+00026fd0: 2020 2020 2020 2020 2020 2d20 636f 6c75            - colu
+00026fe0: 6d6e 206e 616d 6520 6173 2061 2073 7472  mn name as a str
+00026ff0: 696e 672e 0a20 2020 2020 2020 2020 2020  ing..           
+00027000: 202d 2069 6e63 7265 6d65 6e74 5f76 616c   - increment_val
+00027010: 7565 2061 7320 312e 350a 0a20 2020 2020  ue as 1.5..     
+00027020: 2020 2045 7870 6563 7465 6420 6265 6861     Expected beha
+00027030: 7669 6f72 3a0a 2020 2020 2020 2020 2020  vior:.          
+00027040: 2020 2d20 6060 5661 6c75 6545 7272 6f72    - ``ValueError
+00027050: 6060 2073 686f 756c 6420 6265 2072 6169  `` should be rai
+00027060: 7365 642e 0a20 2020 2020 2020 2022 2222  sed..        """
+00027070: 0a20 2020 2020 2020 2023 2052 756e 202f  .        # Run /
+00027080: 2041 7373 6572 740a 2020 2020 2020 2020   Assert.        
+00027090: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+000270a0: 2754 6865 2069 6e63 7265 6d65 6e74 5f76  'The increment_v
+000270b0: 616c 7565 206d 7573 7420 6265 2061 2077  alue must be a w
+000270c0: 686f 6c65 206e 756d 6265 722e 270a 2020  hole number.'.  
+000270d0: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+000270e0: 742e 7261 6973 6573 2856 616c 7565 4572  t.raises(ValueEr
+000270f0: 726f 722c 206d 6174 6368 3d65 7272 6f72  ror, match=error
+00027100: 5f6d 6573 7361 6765 293a 0a20 2020 2020  _message):.     
+00027110: 2020 2020 2020 2046 6978 6564 496e 6372         FixedIncr
+00027120: 656d 656e 7473 2863 6f6c 756d 6e5f 6e61  ements(column_na
+00027130: 6d65 3d27 636f 6c75 6d6e 272c 2069 6e63  me='column', inc
+00027140: 7265 6d65 6e74 5f76 616c 7565 3d31 2e35  rement_value=1.5
+00027150: 290a 0a20 2020 2064 6566 2074 6573 745f  )..    def test_
+00027160: 5f66 6974 2873 656c 6629 3a0a 2020 2020  _fit(self):.    
+00027170: 2020 2020 2222 2254 6573 7420 7468 6520      """Test the 
+00027180: 6060 4669 7865 6449 6e63 7265 6d65 6e74  ``FixedIncrement
+00027190: 732e 5f66 6974 6060 206d 6574 686f 642e  s._fit`` method.
+000271a0: 0a0a 2020 2020 2020 2020 5468 6520 6060  ..        The ``
+000271b0: 6669 7460 6020 6d65 7468 6f64 2073 686f  fit`` method sho
+000271c0: 756c 6420 7374 6f72 6520 7468 6520 6474  uld store the dt
+000271d0: 7970 6520 6f66 2074 6865 2044 6174 6146  ype of the DataF
+000271e0: 7261 6d65 2e0a 0a20 2020 2020 2020 2049  rame...        I
+000271f0: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
+00027200: 2020 2d20 4120 6060 7061 6e64 6173 2e44    - A ``pandas.D
+00027210: 6174 6146 7261 6d65 6060 2077 6974 6820  ataFrame`` with 
+00027220: 6120 666c 6f61 7420 6474 7970 652e 0a0a  a float dtype...
+00027230: 2020 2020 2020 2020 4578 7065 6374 6564          Expected
+00027240: 2062 6568 6176 696f 723a 0a20 2020 2020   behavior:.     
+00027250: 2020 2020 2020 202d 2054 6865 2060 6069         - The ``i
+00027260: 6e73 7461 6e63 652e 5f64 7479 7065 6060  nstance._dtype``
+00027270: 2073 686f 756c 6420 6265 2073 6574 2074   should be set t
+00027280: 6f20 666c 6f61 742e 0a20 2020 2020 2020  o float..       
+00027290: 2022 2222 0a20 2020 2020 2020 2023 2053   """.        # S
+000272a0: 6574 7570 0a20 2020 2020 2020 2064 6174  etup.        dat
+000272b0: 6120 3d20 7064 2e44 6174 6146 7261 6d65  a = pd.DataFrame
+000272c0: 287b 2763 6f6c 756d 6e27 3a20 5b37 2c20  ({'column': [7, 
+000272d0: 3134 2c20 3231 5d7d 2c20 6474 7970 653d  14, 21]}, dtype=
+000272e0: 666c 6f61 7429 0a20 2020 2020 2020 2069  float).        i
+000272f0: 6e73 7461 6e63 6520 3d20 4669 7865 6449  nstance = FixedI
+00027300: 6e63 7265 6d65 6e74 7328 636f 6c75 6d6e  ncrements(column
+00027310: 5f6e 616d 653d 2763 6f6c 756d 6e27 2c20  _name='column', 
+00027320: 696e 6372 656d 656e 745f 7661 6c75 653d  increment_value=
+00027330: 3729 0a0a 2020 2020 2020 2020 2320 5275  7)..        # Ru
+00027340: 6e0a 2020 2020 2020 2020 696e 7374 616e  n.        instan
+00027350: 6365 2e5f 6669 7428 6461 7461 290a 0a20  ce._fit(data).. 
+00027360: 2020 2020 2020 2023 2041 7373 6572 740a         # Assert.
+00027370: 2020 2020 2020 2020 6173 7365 7274 2069          assert i
+00027380: 6e73 7461 6e63 652e 5f64 7479 7065 203d  nstance._dtype =
+00027390: 3d20 666c 6f61 740a 0a20 2020 2064 6566  = float..    def
+000273a0: 2074 6573 745f 6973 5f76 616c 6964 2873   test_is_valid(s
+000273b0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+000273c0: 2254 6573 7420 7468 6520 6060 4669 7865  "Test the ``Fixe
+000273d0: 6449 6e63 7265 6d65 6e74 732e 6973 5f76  dIncrements.is_v
+000273e0: 616c 6964 6060 206d 6574 686f 642e 0a0a  alid`` method...
+000273f0: 2020 2020 2020 2020 5468 6520 6060 6973          The ``is
+00027400: 5f76 616c 6964 6060 206d 6574 686f 6420  _valid`` method 
+00027410: 7368 6f75 6c64 2072 6574 7572 6e20 6060  should return ``
+00027420: 5472 7565 6060 2066 6f72 2072 6f77 7320  True`` for rows 
+00027430: 7468 6174 2061 7265 204e 614e 206f 7220  that are NaN or 
+00027440: 6576 656e 6c79 2064 6976 6973 6962 6c65  evenly divisible
+00027450: 0a20 2020 2020 2020 2062 7920 7468 6520  .        by the 
+00027460: 696e 6372 656d 656e 742e 0a0a 2020 2020  increment...    
+00027470: 2020 2020 496e 7075 743a 0a20 2020 2020      Input:.     
+00027480: 2020 2020 2020 202d 2041 2060 6070 616e         - A ``pan
+00027490: 6461 732e 4461 7461 4672 616d 6560 6020  das.DataFrame`` 
+000274a0: 7769 7468 206f 6e65 2063 6f6c 756d 6e20  with one column 
+000274b0: 636f 6e74 6169 6e69 6e67 2073 6f6d 6520  containing some 
+000274c0: 4e61 4e73 2c20 736f 6d65 206e 756d 6265  NaNs, some numbe
+000274d0: 7273 2074 6861 7420 6172 650a 2020 2020  rs that are.    
+000274e0: 2020 2020 2020 2020 6469 7669 7369 626c          divisibl
+000274f0: 6520 6279 2074 6865 2069 6e63 7265 6d65  e by the increme
+00027500: 6e74 2061 6e64 2073 6f6d 6520 6e75 6d62  nt and some numb
+00027510: 6572 7320 7468 6174 2061 7265 206e 6f74  ers that are not
+00027520: 2e0a 0a20 2020 2020 2020 204f 7574 7075  ...        Outpu
+00027530: 743a 0a20 2020 2020 2020 2020 2020 202d  t:.            -
+00027540: 2041 2060 6070 616e 6461 732e 5365 7269   A ``pandas.Seri
+00027550: 6573 6060 2077 6865 7265 2061 6c6c 2074  es`` where all t
+00027560: 6865 2072 6f77 7320 7468 6174 2061 7265  he rows that are
+00027570: 204e 614e 206f 7220 6469 7669 7369 626c   NaN or divisibl
+00027580: 6520 6279 2074 6865 2069 6e63 7265 6d65  e by the increme
+00027590: 6e74 2061 7265 0a20 2020 2020 2020 2020  nt are.         
+000275a0: 2020 2060 6054 7275 6560 602e 0a20 2020     ``True``..   
+000275b0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000275c0: 2023 2053 6574 7570 0a20 2020 2020 2020   # Setup.       
+000275d0: 2064 6174 6120 3d20 7064 2e44 6174 6146   data = pd.DataF
+000275e0: 7261 6d65 287b 2763 6f6c 756d 6e27 3a20  rame({'column': 
+000275f0: 5b37 2c20 3134 2c20 6e70 2e6e 616e 2c20  [7, 14, np.nan, 
+00027600: 3230 2c20 382c 2033 355d 7d2c 2064 7479  20, 8, 35]}, dty
+00027610: 7065 3d66 6c6f 6174 290a 2020 2020 2020  pe=float).      
+00027620: 2020 696e 7374 616e 6365 203d 2046 6978    instance = Fix
+00027630: 6564 496e 6372 656d 656e 7473 2863 6f6c  edIncrements(col
+00027640: 756d 6e5f 6e61 6d65 3d27 636f 6c75 6d6e  umn_name='column
+00027650: 272c 2069 6e63 7265 6d65 6e74 5f76 616c  ', increment_val
+00027660: 7565 3d37 290a 0a20 2020 2020 2020 2023  ue=7)..        #
+00027670: 2052 756e 0a20 2020 2020 2020 2069 735f   Run.        is_
+00027680: 7661 6c69 6420 3d20 696e 7374 616e 6365  valid = instance
+00027690: 2e69 735f 7661 6c69 6428 6461 7461 290a  .is_valid(data).
+000276a0: 0a20 2020 2020 2020 2023 2041 7373 6572  .        # Asser
+000276b0: 740a 2020 2020 2020 2020 6578 7065 6374  t.        expect
+000276c0: 6564 203d 2070 642e 5365 7269 6573 285b  ed = pd.Series([
+000276d0: 5472 7565 2c20 5472 7565 2c20 5472 7565  True, True, True
+000276e0: 2c20 4661 6c73 652c 2046 616c 7365 2c20  , False, False, 
+000276f0: 5472 7565 5d2c 206e 616d 653d 2763 6f6c  True], name='col
+00027700: 756d 6e27 290a 2020 2020 2020 2020 7064  umn').        pd
+00027710: 2e74 6573 7469 6e67 2e61 7373 6572 745f  .testing.assert_
+00027720: 7365 7269 6573 5f65 7175 616c 2869 735f  series_equal(is_
+00027730: 7661 6c69 642c 2065 7870 6563 7465 6429  valid, expected)
+00027740: 0a0a 2020 2020 6465 6620 7465 7374 5f5f  ..    def test__
+00027750: 7472 616e 7366 6f72 6d28 7365 6c66 293a  transform(self):
+00027760: 0a20 2020 2020 2020 2022 2222 5465 7374  .        """Test
+00027770: 2074 6865 2060 6046 6978 6564 496e 6372   the ``FixedIncr
+00027780: 656d 656e 7473 2e5f 7472 616e 7366 6f72  ements._transfor
+00027790: 6d60 6020 6d65 7468 6f64 2e0a 0a20 2020  m`` method...   
+000277a0: 2020 2020 2054 6865 2060 605f 7472 616e       The ``_tran
+000277b0: 7366 6f72 6d60 6020 6d65 7468 6f64 2073  sform`` method s
+000277c0: 686f 756c 6420 6469 7669 6465 2061 6c6c  hould divide all
+000277d0: 2076 616c 7565 7320 696e 2074 6865 2064   values in the d
+000277e0: 6174 6120 6279 2074 6865 2060 6069 6e63  ata by the ``inc
+000277f0: 7265 6d65 6e74 5f76 616c 7565 6060 2e0a  rement_value``..
+00027800: 0a20 2020 2020 2020 2049 6e70 7574 3a0a  .        Input:.
+00027810: 2020 2020 2020 2020 2020 2020 2d20 4120              - A 
+00027820: 6060 7064 2e44 6174 6146 7261 6d65 6060  ``pd.DataFrame``
+00027830: 2077 6974 6820 6f6e 6520 636f 6c75 6d6e   with one column
+00027840: 2063 6f6e 7461 696e 696e 6720 4e61 4e73   containing NaNs
+00027850: 2061 6e64 2076 616c 7565 7320 6469 7669   and values divi
+00027860: 7369 626c 6520 6279 2074 6865 0a20 2020  sible by the.   
+00027870: 2020 2020 2020 2020 2060 6069 6e63 7265           ``incre
+00027880: 6d65 6e74 5f76 616c 7565 6060 2e0a 0a20  ment_value``... 
+00027890: 2020 2020 2020 204f 7574 7075 743a 0a20         Output:. 
+000278a0: 2020 2020 2020 2020 2020 202d 2041 2060             - A `
+000278b0: 6070 642e 4461 7461 4672 616d 6560 6020  `pd.DataFrame`` 
+000278c0: 7769 7468 2061 6c6c 2074 6865 2076 616c  with all the val
+000278d0: 7565 7320 696e 2074 6861 7420 636f 6c75  ues in that colu
+000278e0: 6d6e 2064 6976 6964 6564 2062 7920 7468  mn divided by th
+000278f0: 650a 2020 2020 2020 2020 2020 2020 6060  e.            ``
+00027900: 696e 6372 656d 656e 745f 7661 6c75 6560  increment_value`
+00027910: 6020 616e 6420 7468 6520 4e61 4e73 206c  ` and the NaNs l
+00027920: 6566 7420 616c 6f6e 652e 0a20 2020 2020  eft alone..     
+00027930: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+00027940: 2053 6574 7570 0a20 2020 2020 2020 2064   Setup.        d
+00027950: 6174 6120 3d20 7064 2e44 6174 6146 7261  ata = pd.DataFra
+00027960: 6d65 287b 2763 6f6c 756d 6e27 3a20 5b37  me({'column': [7
+00027970: 2c20 3134 2c20 6e70 2e6e 616e 2c20 3335  , 14, np.nan, 35
+00027980: 5d7d 290a 2020 2020 2020 2020 696e 7374  ]}).        inst
+00027990: 616e 6365 203d 2046 6978 6564 496e 6372  ance = FixedIncr
+000279a0: 656d 656e 7473 2863 6f6c 756d 6e5f 6e61  ements(column_na
+000279b0: 6d65 3d27 636f 6c75 6d6e 272c 2069 6e63  me='column', inc
+000279c0: 7265 6d65 6e74 5f76 616c 7565 3d37 290a  rement_value=7).
+000279d0: 0a20 2020 2020 2020 2023 2052 756e 0a20  .        # Run. 
+000279e0: 2020 2020 2020 2074 7261 6e73 666f 726d         transform
+000279f0: 6564 203d 2069 6e73 7461 6e63 652e 5f74  ed = instance._t
+00027a00: 7261 6e73 666f 726d 2864 6174 6129 0a0a  ransform(data)..
+00027a10: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
+00027a20: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+00027a30: 6420 3d20 7064 2e44 6174 6146 7261 6d65  d = pd.DataFrame
+00027a40: 287b 2763 6f6c 756d 6e27 3a20 5b31 2c20  ({'column': [1, 
+00027a50: 322c 206e 702e 6e61 6e2c 2035 5d7d 290a  2, np.nan, 5]}).
+00027a60: 2020 2020 2020 2020 7064 2e74 6573 7469          pd.testi
+00027a70: 6e67 2e61 7373 6572 745f 6672 616d 655f  ng.assert_frame_
+00027a80: 6571 7561 6c28 7472 616e 7366 6f72 6d65  equal(transforme
+00027a90: 642c 2065 7870 6563 7465 6429 0a0a 2020  d, expected)..  
+00027aa0: 2020 6465 6620 7465 7374 5f72 6576 6572    def test_rever
+00027ab0: 7365 5f74 7261 6e73 666f 726d 2873 656c  se_transform(sel
+00027ac0: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+00027ad0: 6573 7420 7468 6520 6060 4669 7865 6449  est the ``FixedI
+00027ae0: 6e63 7265 6d65 6e74 732e 7265 7665 7273  ncrements.revers
+00027af0: 655f 7472 616e 7366 6f72 6d60 6020 6d65  e_transform`` me
+00027b00: 7468 6f64 2e0a 0a20 2020 2020 2020 2054  thod...        T
+00027b10: 6865 2060 6072 6576 6572 7365 5f74 7261  he ``reverse_tra
+00027b20: 6e73 666f 726d 6060 206d 6574 686f 6420  nsform`` method 
+00027b30: 7368 6f75 6c64 2072 6f75 6e64 2061 6c6c  should round all
+00027b40: 2073 616d 706c 6564 2076 616c 7565 7320   sampled values 
+00027b50: 746f 2074 6865 206e 6561 7265 7374 2069  to the nearest i
+00027b60: 6e74 2c0a 2020 2020 2020 2020 616e 6420  nt,.        and 
+00027b70: 7468 656e 206d 756c 7469 706c 7920 7468  then multiply th
+00027b80: 656d 2062 7920 7468 6520 6060 696e 6372  em by the ``incr
+00027b90: 656d 656e 745f 7661 6c75 6560 6020 616e  ement_value`` an
+00027ba0: 6420 636f 6e76 6572 7420 7468 656d 2074  d convert them t
+00027bb0: 6f20 7468 6520 6060 5f64 7479 7065 6060  o the ``_dtype``
+00027bc0: 2e0a 0a20 2020 2020 2020 2053 6574 7570  ...        Setup
+00027bd0: 3a0a 2020 2020 2020 2020 2020 2020 2d20  :.            - 
+00027be0: 5365 7420 7468 6520 6060 5f64 7479 7065  Set the ``_dtype
+00027bf0: 6060 2074 6f20 696e 7436 342e 0a0a 2020  `` to int64...  
+00027c00: 2020 2020 2020 496e 7075 743a 0a20 2020        Input:.   
+00027c10: 2020 2020 2020 2020 202d 2041 2060 6070           - A ``p
+00027c20: 616e 6461 732e 4461 7461 4672 616d 6560  andas.DataFrame`
+00027c30: 6020 7769 7468 2066 6c6f 6174 732e 0a0a  ` with floats...
+00027c40: 2020 2020 2020 2020 4f75 7470 7574 3a0a          Output:.
+00027c50: 2020 2020 2020 2020 2020 2020 2d20 4120              - A 
+00027c60: 6060 7061 6e64 6173 2e44 6174 6146 7261  ``pandas.DataFra
+00027c70: 6d65 6060 2077 6974 6820 7468 6520 7661  me`` with the va
+00027c80: 6c75 6573 206d 756c 7469 706c 6965 6420  lues multiplied 
+00027c90: 6279 2074 6865 2060 6069 6e63 7265 6d65  by the ``increme
+00027ca0: 6e74 5f76 616c 7565 6060 2061 6e64 0a20  nt_value`` and. 
+00027cb0: 2020 2020 2020 2020 2020 2063 6f6e 7665             conve
+00027cc0: 7274 6564 2074 6f20 696e 7473 2e0a 2020  rted to ints..  
+00027cd0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00027ce0: 2020 2320 5365 7475 700a 2020 2020 2020    # Setup.      
+00027cf0: 2020 6461 7461 203d 2070 642e 4461 7461    data = pd.Data
+00027d00: 4672 616d 6528 7b27 636f 6c75 6d6e 273a  Frame({'column':
+00027d10: 205b 312e 332c 2033 2e35 2c20 342e 322c   [1.3, 3.5, 4.2,
+00027d20: 2032 2e31 5d7d 290a 2020 2020 2020 2020   2.1]}).        
+00027d30: 696e 7374 616e 6365 203d 2046 6978 6564  instance = Fixed
+00027d40: 496e 6372 656d 656e 7473 2863 6f6c 756d  Increments(colum
+00027d50: 6e5f 6e61 6d65 3d27 636f 6c75 6d6e 272c  n_name='column',
+00027d60: 2069 6e63 7265 6d65 6e74 5f76 616c 7565   increment_value
+00027d70: 3d37 290a 2020 2020 2020 2020 696e 7374  =7).        inst
+00027d80: 616e 6365 2e5f 6474 7970 6520 3d20 6e70  ance._dtype = np
+00027d90: 2e69 6e74 3634 0a0a 2020 2020 2020 2020  .int64..        
+00027da0: 2320 5275 6e0a 2020 2020 2020 2020 7265  # Run.        re
+00027db0: 7665 7273 655f 7472 616e 7366 6f72 6d65  verse_transforme
+00027dc0: 6420 3d20 696e 7374 616e 6365 2e72 6576  d = instance.rev
+00027dd0: 6572 7365 5f74 7261 6e73 666f 726d 2864  erse_transform(d
+00027de0: 6174 6129 0a0a 2020 2020 2020 2020 2320  ata)..        # 
+00027df0: 4173 7365 7274 0a20 2020 2020 2020 2065  Assert.        e
+00027e00: 7870 6563 7465 6420 3d20 7064 2e44 6174  xpected = pd.Dat
+00027e10: 6146 7261 6d65 287b 2763 6f6c 756d 6e27  aFrame({'column'
+00027e20: 3a20 5b37 2c20 3238 2c20 3238 2c20 3134  : [7, 28, 28, 14
+00027e30: 5d7d 290a 2020 2020 2020 2020 7064 2e74  ]}).        pd.t
+00027e40: 6573 7469 6e67 2e61 7373 6572 745f 6672  esting.assert_fr
+00027e50: 616d 655f 6571 7561 6c28 6578 7065 6374  ame_equal(expect
+00027e60: 6564 2c20 7265 7665 7273 655f 7472 616e  ed, reverse_tran
+00027e70: 7366 6f72 6d65 6429 0a0a 2020 2020 6465  sformed)..    de
+00027e80: 6620 7465 7374 5f72 6576 6572 7365 5f74  f test_reverse_t
+00027e90: 7261 6e73 666f 726d 5f6e 616e 7328 7365  ransform_nans(se
+00027ea0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00027eb0: 5465 7374 2074 6865 2060 6046 6978 6564  Test the ``Fixed
+00027ec0: 496e 6372 656d 656e 7473 2e72 6576 6572  Increments.rever
+00027ed0: 7365 5f74 7261 6e73 666f 726d 6060 206d  se_transform`` m
+00027ee0: 6574 686f 6420 7769 7468 204e 614e 732e  ethod with NaNs.
+00027ef0: 0a0a 2020 2020 2020 2020 5468 6520 6060  ..        The ``
+00027f00: 7265 7665 7273 655f 7472 616e 7366 6f72  reverse_transfor
+00027f10: 6d60 6020 6d65 7468 6f64 2073 686f 756c  m`` method shoul
+00027f20: 6420 6967 6e6f 7265 2074 6865 204e 614e  d ignore the NaN
+00027f30: 2076 616c 7565 732e 0a0a 2020 2020 2020   values...      
+00027f40: 2020 5365 7475 703a 0a20 2020 2020 2020    Setup:.       
+00027f50: 2020 2020 202d 2053 6574 2074 6865 2060       - Set the `
+00027f60: 605f 6474 7970 6560 6020 746f 2066 6c6f  `_dtype`` to flo
+00027f70: 6174 3634 2e0a 0a20 2020 2020 2020 2049  at64...        I
+00027f80: 6e70 7574 3a0a 2020 2020 2020 2020 2020  nput:.          
+00027f90: 2020 2d20 4120 6060 7061 6e64 6173 2e44    - A ``pandas.D
+00027fa0: 6174 6146 7261 6d65 6060 2077 6974 6820  ataFrame`` with 
+00027fb0: 666c 6f61 7473 2e0a 0a20 2020 2020 2020  floats...       
+00027fc0: 204f 7574 7075 743a 0a20 2020 2020 2020   Output:.       
+00027fd0: 2020 2020 202d 2041 2060 6070 616e 6461       - A ``panda
+00027fe0: 732e 4461 7461 4672 616d 6560 6020 7769  s.DataFrame`` wi
+00027ff0: 7468 2074 6865 2076 616c 7565 7320 6d75  th the values mu
+00028000: 6c74 6970 6c69 6564 2062 7920 7468 6520  ltiplied by the 
+00028010: 6060 696e 6372 656d 656e 745f 7661 6c75  ``increment_valu
+00028020: 6560 6020 616e 640a 2020 2020 2020 2020  e`` and.        
+00028030: 2020 2020 7468 6520 4e61 4e73 2069 676e      the NaNs ign
+00028040: 6f72 6564 2e0a 2020 2020 2020 2020 2222  ored..        ""
+00028050: 220a 2020 2020 2020 2020 2320 5365 7475  ".        # Setu
+00028060: 700a 2020 2020 2020 2020 6461 7461 203d  p.        data =
+00028070: 2070 642e 4461 7461 4672 616d 6528 7b27   pd.DataFrame({'
+00028080: 636f 6c75 6d6e 273a 205b 312e 332c 2033  column': [1.3, 3
+00028090: 2e35 2c20 6e70 2e6e 616e 2c20 342e 322c  .5, np.nan, 4.2,
+000280a0: 206e 702e 6e61 6e2c 2032 2e31 5d7d 290a   np.nan, 2.1]}).
+000280b0: 2020 2020 2020 2020 696e 7374 616e 6365          instance
+000280c0: 203d 2046 6978 6564 496e 6372 656d 656e   = FixedIncremen
+000280d0: 7473 2863 6f6c 756d 6e5f 6e61 6d65 3d27  ts(column_name='
+000280e0: 636f 6c75 6d6e 272c 2069 6e63 7265 6d65  column', increme
+000280f0: 6e74 5f76 616c 7565 3d37 290a 2020 2020  nt_value=7).    
+00028100: 2020 2020 696e 7374 616e 6365 2e5f 6474      instance._dt
+00028110: 7970 6520 3d20 6e70 2e66 6c6f 6174 3634  ype = np.float64
+00028120: 0a0a 2020 2020 2020 2020 2320 5275 6e0a  ..        # Run.
+00028130: 2020 2020 2020 2020 7265 7665 7273 655f          reverse_
+00028140: 7472 616e 7366 6f72 6d65 6420 3d20 696e  transformed = in
+00028150: 7374 616e 6365 2e72 6576 6572 7365 5f74  stance.reverse_t
+00028160: 7261 6e73 666f 726d 2864 6174 6129 0a0a  ransform(data)..
+00028170: 2020 2020 2020 2020 2320 4173 7365 7274          # Assert
+00028180: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+00028190: 6420 3d20 7064 2e44 6174 6146 7261 6d65  d = pd.DataFrame
+000281a0: 287b 2763 6f6c 756d 6e27 3a20 5b37 2c20  ({'column': [7, 
+000281b0: 3238 2c20 6e70 2e6e 616e 2c20 3238 2c20  28, np.nan, 28, 
+000281c0: 6e70 2e6e 616e 2c20 3134 5d7d 290a 2020  np.nan, 14]}).  
+000281d0: 2020 2020 2020 7064 2e74 6573 7469 6e67        pd.testing
+000281e0: 2e61 7373 6572 745f 6672 616d 655f 6571  .assert_frame_eq
+000281f0: 7561 6c28 6578 7065 6374 6564 2c20 7265  ual(expected, re
+00028200: 7665 7273 655f 7472 616e 7366 6f72 6d65  verse_transforme
+00028210: 6429 0a                                  d).
```

### Comparing `sdv-1.0.0rc0/tests/unit/constraints/test_utils.py` & `sdv-1.0.1.dev0/tests/unit/constraints/test_utils.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/data_processing/test_data_processor.py` & `sdv-1.0.1.dev0/tests/unit/data_processing/test_data_processor.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/data_processing/test_numerical_formatter.py` & `sdv-1.0.1.dev0/tests/unit/data_processing/test_numerical_formatter.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/data_processing/test_utils.py` & `sdv-1.0.1.dev0/tests/unit/data_processing/test_utils.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/datasets/test_demo.py` & `sdv-1.0.1.dev0/tests/unit/datasets/test_demo.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/datasets/test_local.py` & `sdv-1.0.1.dev0/tests/unit/datasets/test_local.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/evaluation/test_multi_table.py` & `sdv-1.0.1.dev0/tests/unit/evaluation/test_multi_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/evaluation/test_single_table.py` & `sdv-1.0.1.dev0/tests/unit/evaluation/test_single_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/lite/test_single_table.py` & `sdv-1.0.1.dev0/tests/unit/lite/test_single_table.py`

 * *Files 1% similar despite different names*

```diff
@@ -8,15 +8,15 @@
 
 from sdv.lite import SingleTablePreset
 from sdv.metadata import SingleTableMetadata
 from sdv.single_table import GaussianCopulaSynthesizer
 from tests.utils import DataFrameMatcher
 
 
-class TestTabularPreset:
+class TestSingleTablePreset:
 
     def test___init__invalid_name(self):
         """Test the method with an invalid name.
 
         If the name isn't one of the expected presets, a ``ValueError`` should be thrown.
         """
         # Run and Assert
```

### Comparing `sdv-1.0.0rc0/tests/unit/metadata/test_anonymization.py` & `sdv-1.0.1.dev0/tests/unit/metadata/test_anonymization.py`

 * *Files 2% similar despite different names*

```diff
@@ -17,17 +17,19 @@
 
         Output:
             - The faker provider name for that function.
         """
         # Run / Assert
         email_provider = _detect_provider_name('email')
         lexify_provider = _detect_provider_name('lexify')
+        state_provider = _detect_provider_name('state')
 
         assert email_provider == 'internet'
         assert lexify_provider == 'BaseProvider'
+        assert state_provider == 'address.en_US'
 
     @patch('sdv.metadata.anonymization.AnonymizedFaker')
     def test_get_anonymized_transformer_with_existing_sdtype(self, mock_anonymized_faker):
         """Test the ``get_anonymized_transformer`` method.
 
         Test that when calling with an existing ``sdtype`` / ``function_name`` from the
         ``SDTYPE_ANONYMZIERS`` dictionary, their ``provider_name`` and ``function_name`` are being
```

### Comparing `sdv-1.0.0rc0/tests/unit/metadata/test_metadata_upgrader.py` & `sdv-1.0.1.dev0/tests/unit/metadata/test_metadata_upgrader.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/metadata/test_multi_table.py` & `sdv-1.0.1.dev0/tests/unit/metadata/test_multi_table.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/metadata/test_single_table.py` & `sdv-1.0.1.dev0/tests/unit/metadata/test_single_table.py`

 * *Files 2% similar despite different names*

```diff
@@ -1036,15 +1036,15 @@
         # Setup
         instance = SingleTableMetadata()
         instance.add_column('column1', sdtype='categorical')
         instance.add_column('column2', sdtype='categorical')
         instance.add_column('column3', sdtype='id')
 
         err_msg = re.escape(
-            "The primary_keys ['column1', 'column2'] must be type 'id' or a valid Faker function."
+            "The primary_keys ['column1', 'column2'] must be type 'id' or another PII type."
         )
         # Run / Assert
         with pytest.raises(InvalidMetadataError, match=err_msg):
             instance.set_primary_key(('column1', 'column2', 'column3'))
 
     def test_set_primary_key(self):
         """Test that ``set_primary_key`` sets the ``_primary_key`` value."""
@@ -1174,15 +1174,15 @@
         # Setup
         instance = SingleTableMetadata()
         instance.add_column('column1', sdtype='categorical')
         instance.add_column('column2', sdtype='categorical')
         instance.add_column('column3', sdtype='id')
 
         err_msg = re.escape(
-            "The sequence_keys ['column1', 'column2'] must be type 'id' or a valid Faker function."
+            "The sequence_keys ['column1', 'column2'] must be type 'id' or another PII type."
         )
         # Run / Assert
         with pytest.raises(InvalidMetadataError, match=err_msg):
             instance.set_sequence_key(('column1', 'column2', 'column3'))
 
     def test_set_sequence_key(self):
         """Test that ``set_sequence_key`` sets the ``_sequence_key`` value."""
@@ -1288,16 +1288,15 @@
         # Setup
         instance = SingleTableMetadata()
         instance.add_column('column1', sdtype='categorical')
         instance.add_column('column2', sdtype='categorical')
         instance.add_column('column3', sdtype='id')
 
         err_msg = re.escape(
-            "The alternate_keys ['column1', 'column2'] must be type 'id' or a valid Faker "
-            'function.'
+            "The alternate_keys ['column1', 'column2'] must be type 'id' or another PII type."
         )
         # Run / Assert
         with pytest.raises(InvalidMetadataError, match=err_msg):
             instance.add_alternate_keys([('column1', 'column2'), 'column3'])
 
     def test_add_alternate_keys_validation_primary_key(self):
         """Test that ``add_alternate_keys`` crashes when the key is a primary key.
```

### Comparing `sdv-1.0.0rc0/tests/unit/multi_table/test_base.py` & `sdv-1.0.1.dev0/tests/unit/multi_table/test_base.py`

 * *Files 6% similar despite different names*

```diff
@@ -884,47 +884,96 @@
         instance = Mock()
         table_synth_mock = Mock()
         instance._table_synthesizers = {'table': table_synth_mock}
 
         # Run
         BaseMultiTableSynthesizer.load_custom_constraint_classes(
             instance,
-            'table',
             'path/to/file.py',
             ['Custom', 'Constr', 'UpperPlus']
         )
 
         # Assert
         table_synth_mock.load_custom_constraint_classes.assert_called_once_with(
             'path/to/file.py',
             ['Custom', 'Constr', 'UpperPlus']
         )
 
+    def test_load_custom_constraint_classes_multi_tables(self):
+        """Check that ``load_custom_constraint_classes`` is called for every tables."""
+        # Setup
+        instance = Mock()
+        table_synth_mock = Mock()
+        table_synth_mock_2 = Mock()
+        instance._table_synthesizers = {'table': table_synth_mock, 'table_2': table_synth_mock_2}
+
+        # Run
+        BaseMultiTableSynthesizer.load_custom_constraint_classes(
+            instance,
+            'path/to/file.py',
+            ['Custom', 'Constr', 'UpperPlus']
+        )
+
+        # Assert
+        table_synth_mock.load_custom_constraint_classes.assert_called_once_with(
+            'path/to/file.py',
+            ['Custom', 'Constr', 'UpperPlus']
+        )
+        table_synth_mock_2.load_custom_constraint_classes.assert_called_once_with(
+            'path/to/file.py',
+            ['Custom', 'Constr', 'UpperPlus']
+        )
+
     def test_add_custom_constraint_class(self):
         """Test that this method calls the single table synthesizer's version of the method."""
         # Setup
         instance = Mock()
         constraint_mock = Mock()
         table_synth_mock = Mock()
         instance._table_synthesizers = {'table': table_synth_mock}
 
         # Run
         BaseMultiTableSynthesizer.add_custom_constraint_class(
             instance,
-            'table',
             constraint_mock,
             'custom'
         )
 
         # Assert
         table_synth_mock.add_custom_constraint_class.assert_called_once_with(
             constraint_mock,
             'custom'
         )
 
+    def test_add_custom_constraint_class_multi_tables(self):
+        """Check that ``add_custom_constraint_class`` is called for every tables."""
+        # Setup
+        instance = Mock()
+        constraint_mock = Mock()
+        table_synth_mock = Mock()
+        table_synth_mock_2 = Mock()
+        instance._table_synthesizers = {'table': table_synth_mock, 'table_2': table_synth_mock_2}
+
+        # Run
+        BaseMultiTableSynthesizer.add_custom_constraint_class(
+            instance,
+            constraint_mock,
+            'custom'
+        )
+
+        # Assert
+        table_synth_mock.add_custom_constraint_class.assert_called_once_with(
+            constraint_mock,
+            'custom'
+        )
+        table_synth_mock_2.add_custom_constraint_class.assert_called_once_with(
+            constraint_mock,
+            'custom'
+        )
+
     def _pkg_mock(self, lib):
         if lib == 'sdv':
             class Distribution:
                 version = '1.0.0'
 
             return Distribution
```

### Comparing `sdv-1.0.0rc0/tests/unit/multi_table/test_hma.py` & `sdv-1.0.1.dev0/tests/unit/multi_table/test_hma.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/sampling/test_tabular.py` & `sdv-1.0.1.dev0/tests/unit/sampling/test_tabular.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/sequential/test_par.py` & `sdv-1.0.1.dev0/tests/unit/sequential/test_par.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/single_table/test_base.py` & `sdv-1.0.1.dev0/tests/unit/single_table/test_base.py`

 * *Files 2% similar despite different names*

```diff
@@ -573,14 +573,58 @@
             '\n'
             "\nInvalid values found for numerical column 'num2': "
             '[datetime.datetime(1, 1, 1, 0, 0)].'
         )
         with pytest.raises(InvalidDataError, match=err_msg):
             instance.validate(data)
 
+    def test_validate_datetime_sdtype(self):
+        """Test validation for columns with datetime format.
+
+        If the datetime format is provided, then the values must match. Otherwise an error should
+        be raised.
+        """
+        # Setup
+        data = pd.DataFrame({
+            'date_str': [
+                '20220902110443000000',
+                '20220916230356000000',
+                '20220826173917000000',
+                '20220826212135000000',
+                '20220929111311000000'
+            ],
+            'date_int': [
+                20220902110443000000,
+                20220916230356000000,
+                20220826173917000000,
+                20220826212135000000,
+                20220929111311000000
+            ],
+            'bad_date': [
+                2022090,
+                20220916230356000000,
+                2022,
+                20220826212135000000,
+                20220929111311000000
+            ]
+        })
+        metadata = SingleTableMetadata()
+        metadata.add_column('date_str', sdtype='datetime', datetime_format='%Y%m%d%H%M%S%f')
+        metadata.add_column('date_int', sdtype='datetime', datetime_format='%Y%m%d%H%M%S%f')
+        metadata.add_column('bad_date', sdtype='datetime', datetime_format='%Y%m%d%H%M%S%f')
+        instance = BaseSingleTableSynthesizer(metadata)
+
+        # Run and Assert
+        err_msg = re.escape(
+            'The provided data does not match the metadata:'
+            "\nInvalid values found for datetime column 'bad_date': [2022, 2022090]."
+        )
+        with pytest.raises(InvalidDataError, match=err_msg):
+            instance.validate(data)
+
     def test_validate(self):
         """Test the method doesn't crash when the passed data is valid.
 
         Setup:
             ``SingleTableMetadata`` describing at least one valid column of each key and sdtype.
         """
         # Setup
@@ -832,15 +876,14 @@
         """
         # Setup
         data = pd.DataFrame({
             'name': ['John', 'Doe', 'John Doe']
         })
         instance = Mock()
         instance._random_state_set = False
-        instance._data_processor._dtypes = pd.Series()
         instance._data_processor.filter_valid.return_value = data
 
         # Run
         sampled, num_valid = BaseSingleTableSynthesizer._sample_rows(instance, 3)
 
         # Assert
         assert num_valid == 3
@@ -858,15 +901,14 @@
         """Test that sample rows calls with the transformed conditions the ``_sample``."""
         # Setup
         data = pd.DataFrame({
             'name': ['John', 'Doe', 'John Doe'],
             'salary': [90.0, 100.0, 80.0]
         })
         instance = Mock()
-        instance._data_processor._dtypes = pd.Series()
         instance._filter_conditions.return_value = data[data.name == 'John Doe']
         conditions = {'salary': 80.}
         transformed_conditions = {'salary': 80.0}
 
         # Run
         sampled, num_valid = BaseSingleTableSynthesizer._sample_rows(
             instance,
@@ -895,15 +937,14 @@
         })
         data = pd.DataFrame({
             'name': ['John', 'Doe', 'John Doe'],
             'salary': [90.0, 100.0, 80.0]
         })
 
         instance = Mock()
-        instance._data_processor._dtypes = pd.Series()
         instance._data_processor.filter_valid = lambda x: x
         instance._data_processor.reverse_transform.return_value = data
 
         # Run
         sampled, num_valid = BaseSingleTableSynthesizer._sample_rows(
             instance, 3, previous_rows=previous_rows)
 
@@ -923,15 +964,14 @@
         """Test when the model does not support conditional sampling and raises an error."""
         # Setup
         data = pd.DataFrame({
             'name': ['John', 'Doe', 'John Doe'],
             'salary': [90.0, 100.0, 80.0]
         })
         instance = Mock()
-        instance._data_processor._dtypes = pd.Series()
         instance._filter_conditions.return_value = data[data.name == 'John Doe']
         conditions = {'salary': 80.}
         transformed_conditions = {'salary': 80.0}
         instance._sample.side_effect = [NotImplementedError, None]
 
         # Run
         sampled, num_valid = BaseSingleTableSynthesizer._sample_rows(
```

### Comparing `sdv-1.0.0rc0/tests/unit/single_table/test_copulagan.py` & `sdv-1.0.1.dev0/tests/unit/single_table/test_copulagan.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/single_table/test_copulas.py` & `sdv-1.0.1.dev0/tests/unit/single_table/test_copulas.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/single_table/test_ctgan.py` & `sdv-1.0.1.dev0/tests/unit/single_table/test_ctgan.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/unit/single_table/test_utils.py` & `sdv-1.0.1.dev0/tests/unit/single_table/test_utils.py`

 * *Files identical despite different names*

### Comparing `sdv-1.0.0rc0/tests/utils.py` & `sdv-1.0.1.dev0/tests/utils.py`

 * *Files identical despite different names*

