# Comparing `tmp/neon_skill_local_music-0.1.1a1-py3-none-any.whl.zip` & `tmp/neon_skill_local_music-0.1.1a4-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,23 +1,23 @@
-Zip file size: 19197 bytes, number of entries: 21
--rw-r--r--  2.0 unx     1635 b- defN 23-Apr-13 00:21 skill_local_music/LICENSE.md
--rw-r--r--  2.0 unx     1175 b- defN 23-Apr-13 00:21 skill_local_music/README.md
--rw-r--r--  2.0 unx     8205 b- defN 23-Apr-13 00:21 skill_local_music/__init__.py
--rw-r--r--  2.0 unx     1879 b- defN 23-Apr-13 00:21 skill_local_music/skill.json
--rw-r--r--  2.0 unx     1856 b- defN 23-Apr-13 00:21 skill_local_music/version.py
--rw-r--r--  2.0 unx       17 b- defN 23-Apr-13 00:21 skill_local_music/locale/en-us/vocab/local.voc
--rw-r--r--  2.0 unx     1444 b- defN 23-Apr-13 00:21 skill_local_music/neon_skill_local_music.egg-info/PKG-INFO
--rw-r--r--  2.0 unx      425 b- defN 23-Apr-13 00:21 skill_local_music/neon_skill_local_music.egg-info/SOURCES.txt
--rw-r--r--  2.0 unx        1 b- defN 23-Apr-13 00:21 skill_local_music/neon_skill_local_music.egg-info/dependency_links.txt
--rw-r--r--  2.0 unx       87 b- defN 23-Apr-13 00:21 skill_local_music/neon_skill_local_music.egg-info/entry_points.txt
--rw-r--r--  2.0 unx      139 b- defN 23-Apr-13 00:21 skill_local_music/neon_skill_local_music.egg-info/requires.txt
--rw-r--r--  2.0 unx       18 b- defN 23-Apr-13 00:21 skill_local_music/neon_skill_local_music.egg-info/top_level.txt
--rw-r--r--  2.0 unx     5809 b- defN 23-Apr-13 00:21 skill_local_music/test/test_skill.py
--rw-r--r--  2.0 unx      509 b- defN 23-Apr-13 00:21 skill_local_music/ui/music-solid.svg
--rw-r--r--  2.0 unx     9687 b- defN 23-Apr-13 00:21 skill_local_music/util/__init__.py
--rw-r--r--  2.0 unx     1635 b- defN 23-Apr-13 00:21 neon_skill_local_music-0.1.1a1.dist-info/LICENSE.md
--rw-r--r--  2.0 unx     1691 b- defN 23-Apr-13 00:21 neon_skill_local_music-0.1.1a1.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-13 00:21 neon_skill_local_music-0.1.1a1.dist-info/WHEEL
--rw-r--r--  2.0 unx       87 b- defN 23-Apr-13 00:21 neon_skill_local_music-0.1.1a1.dist-info/entry_points.txt
--rw-r--r--  2.0 unx       18 b- defN 23-Apr-13 00:21 neon_skill_local_music-0.1.1a1.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2101 b- defN 23-Apr-13 00:21 neon_skill_local_music-0.1.1a1.dist-info/RECORD
-21 files, 38510 bytes uncompressed, 15627 bytes compressed:  59.4%
+Zip file size: 19231 bytes, number of entries: 21
+-rw-r--r--  2.0 unx     1635 b- defN 23-Apr-19 01:50 skill_local_music/LICENSE.md
+-rw-r--r--  2.0 unx     1182 b- defN 23-Apr-19 01:50 skill_local_music/README.md
+-rw-r--r--  2.0 unx     8205 b- defN 23-Apr-19 01:50 skill_local_music/__init__.py
+-rw-r--r--  2.0 unx     1896 b- defN 23-Apr-19 01:50 skill_local_music/skill.json
+-rw-r--r--  2.0 unx     1856 b- defN 23-Apr-19 01:50 skill_local_music/version.py
+-rw-r--r--  2.0 unx       17 b- defN 23-Apr-19 01:50 skill_local_music/locale/en-us/vocab/local.voc
+-rw-r--r--  2.0 unx     1450 b- defN 23-Apr-19 01:50 skill_local_music/neon_skill_local_music.egg-info/PKG-INFO
+-rw-r--r--  2.0 unx      425 b- defN 23-Apr-19 01:50 skill_local_music/neon_skill_local_music.egg-info/SOURCES.txt
+-rw-r--r--  2.0 unx        1 b- defN 23-Apr-19 01:50 skill_local_music/neon_skill_local_music.egg-info/dependency_links.txt
+-rw-r--r--  2.0 unx       87 b- defN 23-Apr-19 01:50 skill_local_music/neon_skill_local_music.egg-info/entry_points.txt
+-rw-r--r--  2.0 unx      139 b- defN 23-Apr-19 01:50 skill_local_music/neon_skill_local_music.egg-info/requires.txt
+-rw-r--r--  2.0 unx       18 b- defN 23-Apr-19 01:50 skill_local_music/neon_skill_local_music.egg-info/top_level.txt
+-rw-r--r--  2.0 unx     5807 b- defN 23-Apr-19 01:50 skill_local_music/test/test_skill.py
+-rw-r--r--  2.0 unx      509 b- defN 23-Apr-19 01:50 skill_local_music/ui/music-solid.svg
+-rw-r--r--  2.0 unx     9677 b- defN 23-Apr-19 01:50 skill_local_music/util/__init__.py
+-rw-r--r--  2.0 unx     1635 b- defN 23-Apr-19 01:50 neon_skill_local_music-0.1.1a4.dist-info/LICENSE.md
+-rw-r--r--  2.0 unx     1697 b- defN 23-Apr-19 01:50 neon_skill_local_music-0.1.1a4.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Apr-19 01:50 neon_skill_local_music-0.1.1a4.dist-info/WHEEL
+-rw-r--r--  2.0 unx       87 b- defN 23-Apr-19 01:50 neon_skill_local_music-0.1.1a4.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx       18 b- defN 23-Apr-19 01:50 neon_skill_local_music-0.1.1a4.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2101 b- defN 23-Apr-19 01:50 neon_skill_local_music-0.1.1a4.dist-info/RECORD
+21 files, 38534 bytes uncompressed, 15661 bytes compressed:  59.4%
```

## zipnote {}

```diff
@@ -39,26 +39,26 @@
 
 Filename: skill_local_music/ui/music-solid.svg
 Comment: 
 
 Filename: skill_local_music/util/__init__.py
 Comment: 
 
-Filename: neon_skill_local_music-0.1.1a1.dist-info/LICENSE.md
+Filename: neon_skill_local_music-0.1.1a4.dist-info/LICENSE.md
 Comment: 
 
-Filename: neon_skill_local_music-0.1.1a1.dist-info/METADATA
+Filename: neon_skill_local_music-0.1.1a4.dist-info/METADATA
 Comment: 
 
-Filename: neon_skill_local_music-0.1.1a1.dist-info/WHEEL
+Filename: neon_skill_local_music-0.1.1a4.dist-info/WHEEL
 Comment: 
 
-Filename: neon_skill_local_music-0.1.1a1.dist-info/entry_points.txt
+Filename: neon_skill_local_music-0.1.1a4.dist-info/entry_points.txt
 Comment: 
 
-Filename: neon_skill_local_music-0.1.1a1.dist-info/top_level.txt
+Filename: neon_skill_local_music-0.1.1a4.dist-info/top_level.txt
 Comment: 
 
-Filename: neon_skill_local_music-0.1.1a1.dist-info/RECORD
+Filename: neon_skill_local_music-0.1.1a4.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## skill_local_music/README.md

```diff
@@ -34,14 +34,15 @@
 ## Credits
 
 [NeonGeckoCom](https://github.com/NeonGeckoCom)
 [NeonDaniel](https://github.com/NeonDaniel)
 
 ## Category
 **Music**
+Daily
 
 ## Tags
 #music
 #NeonAI
 #NeonGecko Original
 #OCP
-#Common Play
+#Common Play
```

## skill_local_music/skill.json

### Pretty-printed

 * *Similarity: 0.9886363636363636%*

 * *Differences: {"'categories'": "{insert: [(1, 'Daily')]}"}*

```diff
@@ -1,12 +1,13 @@
 {
     "authorname": "NeonGeckoCom",
     "branch": "master",
     "categories": [
-        "Music"
+        "Music",
+        "Daily"
     ],
     "category": "Music",
     "credits": [
         "NeonGeckoCom",
         "NeonDaniel"
     ],
     "description": "Search and play music saved to the local file system. By default, the contents of `/media` will be used, but this can be changed in skill settings. Tagged audio files will have image art and track info parsed from metadata, but you may also organize files in the following format to parse untagged files (i.e. `.wav` files). ``` Artist 1 | |- Album |  | |  |- 01 Song Title.wav |  |- Folder.jpg Artist 2 | |- Album 2 ... ```",
```

## skill_local_music/version.py

```diff
@@ -22,8 +22,8 @@
 # EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 # PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
 # OR PROFITS;  OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 # LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 # SOFTWARE,  EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 
-__version__ = "0.1.1a1"
+__version__ = "0.1.1a4"
```

## skill_local_music/neon_skill_local_music.egg-info/PKG-INFO

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: neon-skill-local-music
-Version: 0.1.1a1
+Version: 0.1.1a4
 Home-page: https://github.com/NeonGeckoCom/skill-local_music
 Author: Neongecko
 Author-email: developers@neon.ai
 License: BSD-3-Clause
 Description-Content-Type: text/markdown
 License-File: LICENSE.md
 
@@ -44,14 +44,15 @@
 ## Credits
 
 [NeonGeckoCom](https://github.com/NeonGeckoCom)
 [NeonDaniel](https://github.com/NeonDaniel)
 
 ## Category
 **Music**
+Daily
 
 ## Tags
 #music
 #NeonAI
 #NeonGecko Original
 #OCP
 #Common Play
```

## skill_local_music/test/test_skill.py

```diff
@@ -116,15 +116,15 @@
 
         mp3_file = join(dirname(__file__), 'test_music', "Test_Track.mp3")
         test_tagged = method(mp3_file, None)
         self.assertEqual(test_tagged.path, mp3_file)
         self.assertEqual(test_tagged.title, "Triple Stage Darkness")
         self.assertEqual(test_tagged.album, "Theodore: An Alternative Music Sampler")
         self.assertEqual(test_tagged.artist, "3rd Bass")
-        # self.assertEqual(test_tagged.genre, "Alternative")
+        self.assertEqual(test_tagged.genre, "Alternative")
 
     def test_download_demo_tracks(self):
         test_dir = join(dirname(__file__), "demo_test")
         self.skill._demo_dir = test_dir
         self.skill._download_demo_tracks()
         self.assertTrue(os.path.isdir(test_dir))
```

## skill_local_music/util/__init__.py

```diff
@@ -116,25 +116,25 @@
                 album_art = join(root, "Folder.jpg")
             for file in files:
                 if file == 'Folder.jpg':
                     continue
                 abs_path = join(root, file)
                 if abs_path in self._songs:
                     LOG.debug(f"Ignoring already indexed track: {abs_path}")
+                    continue
                 self._songs[abs_path] = self._parse_track_from_file(abs_path,
                                                                     album_art)
         LOG.debug("Updated Library")
         try:
             with open(self._db_file, 'wb') as f:
                 pickle.dump(self._songs, f)
         except Exception as e:
             LOG.exception(e)
 
     def _parse_track_from_file(self, file_path: str, album_art: Optional[str]):
-        meta = None
         try:
             meta = ovos_ocp_files_plugin.load(file_path)
             image_bytes = meta.pictures[0].data if meta.pictures else None
             album = meta.tags['album'][0]
             artist = meta.tags['artist'][0]
             genre = meta.tags['genre'][0] if 'genre' in meta.tags \
                 else None  # Handle missing genre tag
@@ -144,58 +144,60 @@
 
             if image_bytes:
                 filename = hashlib.md5(image_bytes).hexdigest()
                 album_art = self._write_album_art(image_bytes,
                                                   filename)
 
             if not isinstance(track_no, int):
-                LOG.debug(f"Handling non-int track_no: {track_no}")
+                # LOG.debug(f"Handling non-int track_no: {track_no}")
                 if track_no.isnumeric():
                     track_no = int(track_no)
                 else:
                     if track_no.split('/')[0].isnumeric():
                         LOG.debug(f"Parsing track_no as int:"
                                   f" {track_no}")
                         track_no = int(track_no.split('/')[0])
                     else:
                         LOG.warning(f"Non-numeric track number:"
                                     f" {track_no}")
                         track_no = 0
-
             song = Track(file_path, title, album, artist, genre,
                          album_art, duration_seconds * 1000, track_no)
             LOG.debug(song)
             return song
-        except ovos_ocp_files_plugin.UnsupportedFormat:
-            return self.song_from_file_path(file_path, album_art)
+        except ovos_ocp_files_plugin.UnsupportedFormat as e:
+            LOG.warning(f"{file_path} unsupported by files plugin: {e}")
+            track = self._parse_id3_tags(file_path)
         except KeyError as e:
             LOG.error(e)
-            from id3parse import ID3
-            tag = ID3.from_file(file_path)
-            if tag:
-                data = dict()
-                for t in ('TPE1', 'TALB', 'TIT2', 'TRCK', 'TCON', 'TIME'):
-                    try:
-                        data[t] = tag.find_frame_by_name(t)
-                    except ValueError:
-                        LOG.debug(f"No tag: {t} for file: "
-                                  f"{basename(file_path)}")
-                        data[t] = None
-                if not data.get('TIT2'):
-                    return self.song_from_file_path(file_path, album_art)
-                return Track(file_path, data.get('TIT2'), data.get('TALB'),
-                             data.get('TPE1'), data.get('TCON'),
-                             data.get('TIME', 0) * 1000, data.get('TRCK'))
-            return self.song_from_file_path(file_path, album_art)
+            track = self._parse_id3_tags(file_path)
 
         except Exception as e:
             LOG.exception(f"{file_path} encountered error: {e}")
-            if meta:
-                LOG.info(f"tags={meta.tags}")
-            return self.song_from_file_path(file_path, album_art)
+            track = self._parse_id3_tags(file_path)
+
+        return track or self.song_from_file_path(file_path, album_art)
+
+    def _parse_id3_tags(self, file_path):
+        from id3parse import ID3
+        tag = ID3.from_file(file_path)
+        if tag:
+            data = dict()
+            for t in ('TPE1', 'TALB', 'TIT2', 'TRCK', 'TCON', 'TIME'):
+                try:
+                    data[t] = tag.find_frame_by_name(t)
+                except ValueError:
+                    LOG.debug(f"No tag: {t} for file: "
+                              f"{basename(file_path)}")
+                    data[t] = None
+            if not data.get('TIT2'):
+                return None
+            return Track(file_path, data.get('TIT2'), data.get('TALB'),
+                         data.get('TPE1'), data.get('TCON'),
+                         data.get('TIME') or 0 * 1000, data.get('TRCK'))
 
     def _write_album_art(self, image_bytes: bytes, filename: str):
         output_file = join(self.cache_path, f'{filename}.jpg')
         if isfile(output_file):
             return output_file
         LOG.info(f"Wrote album art to: {output_file}")
         with open(output_file, 'wb+') as f:
```

## Comparing `neon_skill_local_music-0.1.1a1.dist-info/LICENSE.md` & `neon_skill_local_music-0.1.1a4.dist-info/LICENSE.md`

 * *Files identical despite different names*

## Comparing `neon_skill_local_music-0.1.1a1.dist-info/METADATA` & `neon_skill_local_music-0.1.1a4.dist-info/METADATA`

 * *Files 3% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: neon-skill-local-music
-Version: 0.1.1a1
+Version: 0.1.1a4
 Home-page: https://github.com/NeonGeckoCom/skill-local_music
 Author: Neongecko
 Author-email: developers@neon.ai
 License: BSD-3-Clause
 Description-Content-Type: text/markdown
 License-File: LICENSE.md
 Requires-Dist: ovos-workshop (~=0.0.7)
@@ -50,14 +50,15 @@
 ## Credits
 
 [NeonGeckoCom](https://github.com/NeonGeckoCom)
 [NeonDaniel](https://github.com/NeonDaniel)
 
 ## Category
 **Music**
+Daily
 
 ## Tags
 #music
 #NeonAI
 #NeonGecko Original
 #OCP
 #Common Play
```

