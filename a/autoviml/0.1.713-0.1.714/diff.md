# Comparing `tmp/autoviml-0.1.713.tar.gz` & `tmp/autoviml-0.1.714.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "autoviml-0.1.713.tar", last modified: Wed Mar  8 13:56:10 2023, max compression
+gzip compressed data, was "autoviml-0.1.714.tar", last modified: Wed Apr 19 11:32:58 2023, max compression
```

## Comparing `autoviml-0.1.713.tar` & `autoviml-0.1.714.tar`

 * *Command `'html2text {}'` failed with exit code 1. (No output)*

```diff
@@ -2,16 +2,16 @@
 00000010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00000070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00000080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00000090: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
+00000080: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
+00000090: 3030 3000 3031 3134 3531 0020 7800 0000  000.011451. x...
 000000a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -26,16 +26,16 @@
 00000190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000200: 3238 206d 7469 6d65 3d31 3637 3832 3833  28 mtime=1678283
-00000210: 3737 302e 3739 3839 3931 340a 0000 0000  770.7989914.....
+00000200: 3237 206d 7469 6d65 3d31 3638 3139 3033  27 mtime=1681903
+00000210: 3937 382e 3731 3039 3932 0a00 0000 0000  978.710992......
 00000220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -58,24 +58,24 @@
 00000390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000400: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00000400: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00000410: 2f00 0000 0000 0000 0000 0000 0000 0000  /...............
 00000420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000460: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00000470: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00000480: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
-00000490: 3030 3000 3031 3331 3130 0020 3500 0000  000.013110. 5...
+00000490: 3030 3000 3031 3331 3131 0020 3500 0000  000.013111. 5...
 000004a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000500: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -122,16 +122,16 @@
 00000790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000800: 3238 206d 7469 6d65 3d31 3637 3832 3833  28 mtime=1678283
-00000810: 3737 302e 3830 3039 3839 340a 0000 0000  770.8009894.....
+00000800: 3238 206d 7469 6d65 3d31 3638 3139 3033  28 mtime=1681903
+00000810: 3937 382e 3731 3339 3933 380a 0000 0000  978.7139938.....
 00000820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -154,24 +154,24 @@
 00000990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000a00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00000a00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00000a10: 2f50 4b47 2d49 4e46 4f00 0000 0000 0000  /PKG-INFO.......
 00000a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00000a70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00000a80: 3030 3335 3137 3200 3030 3030 3030 3030  0035172.00000000
-00000a90: 3030 3000 3031 3432 3230 0020 3000 0000  000.014220. 0...
+00000a80: 3030 3335 3137 3400 3030 3030 3030 3030  0035174.00000000
+00000a90: 3030 3000 3031 3432 3233 0020 3000 0000  000.014223. 0...
 00000aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000b00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -189,15 +189,15 @@
 00000bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000c00: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 00000c10: 3a20 322e 310a 4e61 6d65 3a20 6175 746f  : 2.1.Name: auto
 00000c20: 7669 6d6c 0a56 6572 7369 6f6e 3a20 302e  viml.Version: 0.
-00000c30: 312e 3731 330a 5375 6d6d 6172 793a 2041  1.713.Summary: A
+00000c30: 312e 3731 340a 5375 6d6d 6172 793a 2041  1.714.Summary: A
 00000c40: 7574 6f6d 6174 6963 616c 6c79 2042 7569  utomatically Bui
 00000c50: 6c64 2056 6172 6961 6e74 2049 6e74 6572  ld Variant Inter
 00000c60: 7072 6574 6162 6c65 204d 4c20 6d6f 6465  pretable ML mode
 00000c70: 6c73 2066 6173 7420 2d20 6e6f 7720 7769  ls fast - now wi
 00000c80: 7468 2043 6174 426f 6f73 7421 0a48 6f6d  th CatBoost!.Hom
 00000c90: 652d 7061 6765 3a20 6874 7470 733a 2f2f  e-page: https://
 00000ca0: 6769 7468 7562 2e63 6f6d 2f41 7574 6f56  github.com/AutoV
@@ -272,864 +272,864 @@
 000010f0: 7574 6f5f 5669 4d4c 2069 7320 7072 6f6e  uto_ViML is pron
 00001100: 6f75 6e63 6564 2061 7320 2261 7574 6f20  ounced as "auto 
 00001110: 7669 6d61 6c22 2028 6175 746f 7669 6d61  vimal" (autovima
 00001120: 6c20 6c6f 676f 2063 7265 6174 6564 2062  l logo created b
 00001130: 7920 5361 6e6b 6574 2047 6861 6e6d 6172  y Sanket Ghanmar
 00001140: 6529 2e0a 2020 2020 2020 2020 0a20 2020  e)..        .   
 00001150: 2020 2020 2023 2320 5570 6461 7465 2028       ## Update (
-00001160: 4d61 7920 3230 3232 290a 2020 2020 2020  May 2022).      
-00001170: 2020 3c6f 6c3e 0a20 2020 2020 2020 203c    <ol>.        <
-00001180: 6c69 3e3c 623e 4175 746f 5f56 694d 4c20  li><b>Auto_ViML 
-00001190: 6861 7320 6120 6e65 7720 666c 6167 2074  has a new flag t
-000011a0: 6f20 7370 6565 6420 7570 2070 726f 6365  o speed up proce
-000011b0: 7373 696e 6720 7573 696e 6720 4750 5527  ssing using GPU'
-000011c0: 733c 2f62 3e2e 204a 7573 7420 7365 7420  s</b>. Just set 
-000011d0: 7468 6520 6047 5055 5f66 6c61 6760 3d60  the `GPU_flag`=`
-000011e0: 5472 7565 6020 6f6e 2043 6f6c 6162 2061  True` on Colab a
-000011f0: 6e64 206f 7468 6572 2065 6e76 6972 6f6e  nd other environ
-00001200: 6d65 6e74 732e 2042 7574 2064 6f6e 2774  ments. But don't
-00001210: 2066 6f72 6765 7420 746f 2073 6574 2074   forget to set t
-00001220: 6865 2072 756e 7469 6d65 2074 7970 6520  he runtime type 
-00001230: 746f 2062 6520 2247 5055 2220 7768 696c  to be "GPU" whil
-00001240: 6520 7275 6e6e 696e 6720 6f6e 2043 6f6c  e running on Col
-00001250: 6162 2e20 4f74 6865 7277 6973 6520 796f  ab. Otherwise yo
-00001260: 7520 7769 6c6c 2067 6574 2061 6e20 6572  u will get an er
-00001270: 726f 722e 3c2f 6c69 3e0a 2020 2020 2020  ror.</li>.      
-00001280: 2020 3c2f 6f6c 3e0a 2020 2020 2020 2020    </ol>.        
-00001290: 0a20 2020 2020 2020 2023 2320 5570 6461  .        ## Upda
-000012a0: 7465 2028 4d61 7920 3230 3232 290a 2020  te (May 2022).  
-000012b0: 2020 2020 2020 3c6f 6c3e 0a20 2020 2020        <ol>.     
-000012c0: 2020 203c 6c69 3e3c 623e 4175 746f 5f56     <li><b>Auto_V
-000012d0: 694d 4c20 6173 206f 6620 7665 7273 696f  iML as of versio
-000012e0: 6e20 302e 312e 3731 3020 7573 6573 2061  n 0.1.710 uses a
-000012f0: 2076 6572 7920 6869 6768 2070 6572 666f   very high perfo
-00001300: 726d 616e 6365 206c 6962 7261 7279 2063  rmance library c
-00001310: 616c 6c65 6420 6069 6d62 616c 616e 6365  alled `imbalance
-00001320: 645f 656e 7365 6d62 6c65 6020 666f 7220  d_ensemble` for 
-00001330: 496d 6261 6c61 6e63 6564 2064 6174 6173  Imbalanced datas
-00001340: 6574 2070 726f 626c 656d 732e 3c2f 623e  et problems.</b>
-00001350: 2049 7420 7769 6c6c 2070 726f 6475 6365   It will produce
-00001360: 2061 2035 2d31 3025 2062 6f6f 7374 2069   a 5-10% boost i
-00001370: 6e20 796f 7572 2062 616c 616e 6365 645f  n your balanced_
-00001380: 6163 6375 7261 6379 2062 6173 6564 206f  accuracy based o
-00001390: 6e20 6d79 2065 7870 6572 6965 6e63 6520  n my experience 
-000013a0: 7769 7468 2020 6d61 6e79 2064 6174 6173  with  many datas
-000013b0: 6574 7320 4920 6861 7665 2074 7269 6564  ets I have tried
-000013c0: 2e3c 2f6c 693e 0a20 2020 2020 2020 203c  .</li>.        <
-000013d0: 6272 3e0a 2020 2020 2020 2020 3c70 3e49  br>.        <p>I
-000013e0: 6e20 6164 6469 7469 6f6e 2c20 6e65 7720  n addition, new 
-000013f0: 6665 6174 7572 6573 2069 6e20 7468 6973  features in this
-00001400: 2076 6572 7369 6f6e 2061 7265 3a3c 6272   version are:<br
-00001410: 3e0a 2020 2020 2020 2020 3c75 6c3e 0a20  >.        <ul>. 
-00001420: 2020 2020 2020 203c 6c69 3e53 554c 4f56         <li>SULOV
-00001430: 202d 3e20 5573 6573 2074 6865 2053 554c   -> Uses the SUL
-00001440: 4f56 2061 6c67 6f72 6974 686d 2066 6f72  OV algorithm for
-00001450: 2072 656d 6f76 696e 6720 6869 6768 6c79   removing highly
-00001460: 2063 6f72 7265 6c61 7465 6420 6665 6174   correlated feat
-00001470: 7572 6573 2061 7574 6f6d 6174 6963 616c  ures automatical
-00001480: 6c79 2e3c 2f6c 693e 0a20 2020 2020 2020  ly.</li>.       
-00001490: 203c 6c69 3e41 7574 6f5f 4e4c 5020 2d3e   <li>Auto_NLP ->
-000014a0: 2041 7574 6f56 694d 4c20 6175 746f 6d61   AutoViML automa
-000014b0: 7469 6361 6c6c 7920 6465 7465 6374 7320  tically detects 
-000014c0: 5465 7874 2076 6172 6961 626c 6573 2061  Text variables a
-000014d0: 6e64 2064 6f65 7320 4e4c 5020 7072 6f63  nd does NLP proc
-000014e0: 6573 7369 6e67 2075 7369 6e67 2041 7574  essing using Aut
-000014f0: 6f5f 4e4c 503c 2f6c 693e 0a20 2020 2020  o_NLP</li>.     
-00001500: 2020 203c 6c69 3e44 6174 6520 5469 6d65     <li>Date Time
-00001510: 202d 3e20 4974 2061 7574 6f6d 6174 6963   -> It automatic
-00001520: 616c 6c79 2064 6574 6563 7473 2020 6461  ally detects  da
-00001530: 7465 2074 696d 6520 7661 7269 6162 6c65  te time variable
-00001540: 7320 616e 6420 6765 6e65 7261 7465 7320  s and generates 
-00001550: 6e65 7720 6665 6174 7572 6573 3c2f 6c69  new features</li
-00001560: 3e0a 2020 2020 2020 2020 3c6c 693e 6069  >.        <li>`i
-00001570: 6d62 616c 616e 6365 645f 656e 7365 6d62  mbalanced_ensemb
-00001580: 6c65 6020 6c69 6272 6172 7920 2d3e 2055  le` library -> U
-00001590: 7365 7320 696d 6261 6c61 6e63 6564 5f65  ses imbalanced_e
-000015a0: 6e73 656d 626c 6520 6c69 6272 6172 7920  nsemble library 
-000015b0: 666f 7220 696d 6261 6c61 6e63 6564 2064  for imbalanced d
-000015c0: 6174 612e 204a 7573 7420 7365 7420 496d  ata. Just set Im
-000015d0: 6261 6c61 6e63 6564 5f46 6c61 6720 3d20  balanced_Flag = 
-000015e0: 5472 7565 2069 6e20 6172 6775 6d65 6e74  True in argument
-000015f0: 733c 2f6c 693e 0a20 2020 2020 2020 203c  s</li>.        <
-00001600: 6c69 3e46 6561 7475 7265 2053 656c 6563  li>Feature Selec
-00001610: 7469 6f6e 202d 3e20 5765 2075 7365 2074  tion -> We use t
-00001620: 6865 2073 616d 6520 616c 676f 7269 7468  he same algorith
-00001630: 6d20 7468 6174 2066 6561 7475 7265 7769  m that featurewi
-00001640: 7a20 6c69 6272 6172 7920 7573 6573 3a20  z library uses: 
-00001650: 5355 4c4f 5620 616e 6420 5265 6375 7273  SULOV and Recurs
-00001660: 6976 6520 5847 426f 6f73 7420 746f 2073  ive XGBoost to s
-00001670: 656c 6563 7420 6265 7374 2066 6561 7475  elect best featu
-00001680: 7265 7320 6661 7374 2e20 5365 6520 6265  res fast. See be
-00001690: 6c6f 772e 3c2f 6c69 3e0a 2020 2020 2020  low.</li>.      
-000016a0: 2020 3c2f 756c 3e0a 2020 2020 2020 2020    </ul>.        
-000016b0: 0a20 2020 2020 2020 2023 2320 5461 626c  .        ## Tabl
-000016c0: 6520 6f66 2043 6f6e 7465 6e74 730a 2020  e of Contents.  
-000016d0: 2020 2020 2020 3c75 6c3e 0a20 2020 2020        <ul>.     
-000016e0: 2020 203c 6c69 3e3c 6120 6872 6566 3d22     <li><a href="
-000016f0: 2362 6163 6b67 726f 756e 6422 3e42 6163  #background">Bac
-00001700: 6b67 726f 756e 643c 2f61 3e3c 2f6c 693e  kground</a></li>
-00001710: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
-00001720: 6872 6566 3d22 2369 6e73 7461 6c6c 223e  href="#install">
-00001730: 496e 7374 616c 6c3c 2f61 3e3c 2f6c 693e  Install</a></li>
-00001740: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
-00001750: 6872 6566 3d22 2375 7361 6765 223e 5573  href="#usage">Us
-00001760: 6167 653c 2f61 3e3c 2f6c 693e 0a20 2020  age</a></li>.   
-00001770: 2020 2020 203c 6c69 3e3c 6120 6872 6566       <li><a href
-00001780: 3d22 2374 6970 732d 666f 722d 7573 696e  ="#tips-for-usin
-00001790: 672d 6175 746f 5f76 696d 6c22 3e54 6970  g-auto_viml">Tip
-000017a0: 7320 666f 7220 7573 696e 6720 4175 746f  s for using Auto
-000017b0: 5f56 694d 4c3c 2f61 3e3c 2f6c 693e 0a20  _ViML</a></li>. 
-000017c0: 2020 2020 2020 203c 6c69 3e3c 6120 6872         <li><a hr
-000017d0: 6566 3d22 2361 7069 223e 4150 493c 2f61  ef="#api">API</a
-000017e0: 3e3c 2f6c 693e 0a20 2020 2020 2020 203c  ></li>.        <
-000017f0: 6c69 3e3c 6120 6872 6566 3d22 236d 6169  li><a href="#mai
-00001800: 6e74 6169 6e65 7273 223e 4d61 696e 7461  ntainers">Mainta
-00001810: 696e 6572 733c 2f61 3e3c 2f6c 693e 0a20  iners</a></li>. 
-00001820: 2020 2020 2020 203c 6c69 3e3c 6120 6872         <li><a hr
-00001830: 6566 3d22 2363 6f6e 7472 6962 7574 696e  ef="#contributin
-00001840: 6722 3e43 6f6e 7472 6962 7574 696e 673c  g">Contributing<
-00001850: 2f61 3e3c 2f6c 693e 0a20 2020 2020 2020  /a></li>.       
-00001860: 203c 6c69 3e3c 6120 6872 6566 3d22 236c   <li><a href="#l
-00001870: 6963 656e 7365 223e 4c69 6365 6e73 653c  icense">License<
-00001880: 2f61 3e3c 2f6c 693e 0a20 2020 2020 2020  /a></li>.       
-00001890: 203c 2f75 6c3e 0a20 2020 2020 2020 200a   </ul>.        .
-000018a0: 2020 2020 2020 2020 2323 2042 6163 6b67          ## Backg
-000018b0: 726f 756e 640a 2020 2020 2020 2020 3c70  round.        <p
-000018c0: 3e52 6561 6420 7468 6973 203c 6120 6872  >Read this <a hr
-000018d0: 6566 3d22 6874 7470 733a 2f2f 746f 7761  ef="https://towa
-000018e0: 7264 7364 6174 6173 6369 656e 6365 2e63  rdsdatascience.c
-000018f0: 6f6d 2f77 6879 2d61 7574 6f6d 6c2d 6973  om/why-automl-is
-00001900: 2d61 6e2d 6573 7365 6e74 6961 6c2d 6e65  -an-essential-ne
-00001910: 772d 746f 6f6c 2d66 6f72 2d64 6174 612d  w-tool-for-data-
-00001920: 7363 6965 6e74 6973 7473 2d32 6439 6162  scientists-2d9ab
-00001930: 3465 3235 6534 3622 3e4d 6564 6975 6d20  4e25e46">Medium 
-00001940: 6172 7469 636c 6520 746f 206c 6561 726e  article to learn
-00001950: 2068 6f77 2074 6f20 7573 6520 4175 746f   how to use Auto
-00001960: 5f56 694d 4c20 6566 6665 6374 6976 656c  _ViML effectivel
-00001970: 792e 3c2f 613e 0a20 2020 2020 2020 200a  y.</a>.        .
-00001980: 2020 2020 2020 2020 3c70 3e41 7574 6f5f          <p>Auto_
-00001990: 5669 4d4c 2077 6173 2064 6573 6967 6e65  ViML was designe
-000019a0: 6420 666f 7220 6275 696c 6469 6e67 2048  d for building H
-000019b0: 6967 6820 5065 7266 6f72 6d61 6e63 6520  igh Performance 
-000019c0: 496e 7465 7270 7265 7461 626c 6520 4d6f  Interpretable Mo
-000019d0: 6465 6c73 2077 6974 6820 7468 6520 6665  dels with the fe
-000019e0: 7765 7374 2076 6172 6961 626c 6573 206e  west variables n
-000019f0: 6565 6465 642e 0a20 2020 2020 2020 2054  eeded..        T
-00001a00: 6865 2022 5622 2069 6e20 4175 746f 5f56  he "V" in Auto_V
-00001a10: 694d 4c20 7374 616e 6473 2066 6f72 2056  iML stands for V
-00001a20: 6172 6961 6e74 2062 6563 6175 7365 2069  ariant because i
-00001a30: 7420 7472 6965 7320 6d75 6c74 6970 6c65  t tries multiple
-00001a40: 206d 6f64 656c 7320 7769 7468 206d 756c   models with mul
-00001a50: 7469 706c 6520 6665 6174 7572 6573 2074  tiple features t
-00001a60: 6f20 6669 6e64 2079 6f75 2074 6865 2062  o find you the b
-00001a70: 6573 7420 7065 7266 6f72 6d69 6e67 206d  est performing m
-00001a80: 6f64 656c 2066 6f72 2079 6f75 7220 6461  odel for your da
-00001a90: 7461 7365 742e 2054 6865 2022 6922 2069  taset. The "i" i
-00001aa0: 6e20 4175 746f 5f56 694d 4c20 7374 616e  n Auto_ViML stan
-00001ab0: 6473 2066 6f72 2022 696e 7465 7270 7265  ds for "interpre
-00001ac0: 7461 626c 6522 2073 696e 6365 2041 7574  table" since Aut
-00001ad0: 6f5f 5669 4d4c 2073 656c 6563 7473 2074  o_ViML selects t
-00001ae0: 6865 206c 6561 7374 206e 756d 6265 7220  he least number 
-00001af0: 6f66 2066 6561 7475 7265 7320 6e65 6365  of features nece
-00001b00: 7373 6172 7920 746f 2062 7569 6c64 2061  ssary to build a
-00001b10: 2073 696d 706c 6572 2c20 6d6f 7265 2069   simpler, more i
-00001b20: 6e74 6572 7072 6574 6162 6c65 206d 6f64  nterpretable mod
-00001b30: 656c 2e20 496e 206d 6f73 7420 6361 7365  el. In most case
-00001b40: 732c 2041 7574 6f5f 5669 4d4c 2062 7569  s, Auto_ViML bui
-00001b50: 6c64 7320 6d6f 6465 6c73 2077 6974 6820  lds models with 
-00001b60: 3230 252d 3939 2520 6665 7765 7220 6665  20%-99% fewer fe
-00001b70: 6174 7572 6573 2074 6861 6e20 6120 7369  atures than a si
-00001b80: 6d69 6c61 7220 7065 7266 6f72 6d69 6e67  milar performing
-00001b90: 206d 6f64 656c 2077 6974 6820 616c 6c20   model with all 
-00001ba0: 696e 636c 7564 6564 2066 6561 7475 7265  included feature
-00001bb0: 7320 2874 6869 7320 6973 2062 6173 6564  s (this is based
-00001bc0: 206f 6e20 6d79 2074 7269 616c 732e 2059   on my trials. Y
-00001bd0: 6f75 7220 6578 7065 7269 656e 6365 206d  our experience m
-00001be0: 6179 2076 6172 7929 2e3c 6272 3e0a 2020  ay vary).<br>.  
-00001bf0: 2020 2020 2020 3c70 3e0a 2020 2020 2020        <p>.      
-00001c00: 2020 4175 746f 5f56 694d 4c20 6973 2065    Auto_ViML is e
-00001c10: 7665 7279 2044 6174 6120 5363 6965 6e74  very Data Scient
-00001c20: 6973 7427 7320 6d6f 6465 6c20 6163 6365  ist's model acce
-00001c30: 6c65 7261 746f 7220 746f 6f6c 2074 6861  lerator tool tha
-00001c40: 743a 3c6f 6c3e 0a20 2020 2020 2020 203c  t:<ol>.        <
-00001c50: 6c69 3e3c 623e 4865 6c70 7320 796f 7520  li><b>Helps you 
-00001c60: 7769 7468 2064 6174 6120 636c 6561 6e69  with data cleani
-00001c70: 6e67 3c2f 623e 3a20 796f 7520 6361 6e20  ng</b>: you can 
-00001c80: 7365 6e64 2069 6e20 796f 7572 2065 6e74  send in your ent
-00001c90: 6972 6520 6461 7461 6672 616d 6520 6173  ire dataframe as
-00001ca0: 2069 7320 616e 6420 4175 746f 5f56 694d   is and Auto_ViM
-00001cb0: 4c20 7769 6c6c 2073 7567 6765 7374 2063  L will suggest c
-00001cc0: 6861 6e67 6573 2074 6f20 6865 6c70 2077  hanges to help w
-00001cd0: 6974 6820 6d69 7373 696e 6720 7661 6c75  ith missing valu
-00001ce0: 6573 2c20 666f 726d 6174 7469 6e67 2076  es, formatting v
-00001cf0: 6172 6961 626c 6573 2c20 6164 6469 6e67  ariables, adding
-00001d00: 2076 6172 6961 626c 6573 2c20 6574 632e   variables, etc.
-00001d10: 2049 7420 6c6f 7665 7320 6469 7274 7920   It loves dirty 
-00001d20: 6461 7461 2e20 5468 6520 6469 7274 6965  data. The dirtie
-00001d30: 7220 7468 6520 6265 7474 6572 213c 6272  r the better!<br
-00001d40: 3e0a 2020 2020 2020 2020 3c6c 693e 3c62  >.        <li><b
-00001d50: 3e50 6572 666f 726d 7320 4665 6174 7572  >Performs Featur
-00001d60: 6520 5365 6c65 6374 696f 6e3c 2f62 3e3a  e Selection</b>:
-00001d70: 2041 7574 6f5f 5669 4d4c 2073 656c 6563   Auto_ViML selec
-00001d80: 7473 2076 6172 6961 626c 6573 2061 7574  ts variables aut
-00001d90: 6f6d 6174 6963 616c 6c79 2062 7920 6465  omatically by de
-00001da0: 6661 756c 742e 2054 6869 7320 6973 2076  fault. This is v
-00001db0: 6572 7920 6865 6c70 6675 6c20 7768 656e  ery helpful when
-00001dc0: 2079 6f75 2068 6176 6520 6875 6e64 7265   you have hundre
-00001dd0: 6473 2069 6620 6e6f 7420 7468 6f75 7361  ds if not thousa
-00001de0: 6e64 7320 6f66 2076 6172 6961 626c 6573  nds of variables
-00001df0: 2073 696e 6365 2069 7420 6361 6e20 7265   since it can re
-00001e00: 6164 696c 7920 6964 656e 7469 6679 2077  adily identify w
-00001e10: 6869 6368 206f 6620 7468 6f73 6520 6172  hich of those ar
-00001e20: 6520 696d 706f 7274 616e 7420 7661 7269  e important vari
-00001e30: 6162 6c65 7320 7673 2077 6869 6368 2061  ables vs which a
-00001e40: 7265 2075 6e6e 6563 6573 7361 7279 2e20  re unnecessary. 
-00001e50: 596f 7520 6361 6e20 7475 726e 2074 6869  You can turn thi
-00001e60: 7320 6f66 6620 6173 2077 656c 6c20 2873  s off as well (s
-00001e70: 6565 2041 5049 292e 3c62 723e 0a20 2020  ee API).<br>.   
-00001e80: 2020 2020 200a 2020 2020 2020 2020 215b       .        ![
-00001e90: 7867 626f 6f73 745d 2873 756c 6f76 5f78  xgboost](sulov_x
-00001ea0: 6762 6f6f 7374 2e70 6e67 290a 2020 2020  gboost.png).    
-00001eb0: 2020 2020 3c6c 693e 3c62 3e52 656d 6f76      <li><b>Remov
-00001ec0: 6573 2068 6967 686c 7920 636f 7272 656c  es highly correl
-00001ed0: 6174 6564 2066 6561 7475 7265 7320 6175  ated features au
-00001ee0: 746f 6d61 7469 6361 6c6c 793c 2f62 3e2e  tomatically</b>.
-00001ef0: 2049 6620 7477 6f20 7661 7269 6162 6c65   If two variable
-00001f00: 7320 6172 6520 6869 6768 6c79 2063 6f72  s are highly cor
-00001f10: 7265 6c61 7465 6420 696e 2079 6f75 7220  related in your 
-00001f20: 6461 7461 7365 742c 2077 6869 6368 206f  dataset, which o
-00001f30: 6e65 2073 686f 756c 6420 796f 7520 7265  ne should you re
-00001f40: 6d6f 7665 2061 6e64 2077 6869 6368 206f  move and which o
-00001f50: 6e65 2073 686f 756c 6420 796f 7520 6b65  ne should you ke
-00001f60: 6570 3f20 5468 6520 6465 6369 7369 6f6e  ep? The decision
-00001f70: 2069 7320 6e6f 7420 6173 2065 6173 7920   is not as easy 
-00001f80: 6173 2069 7420 6c6f 6f6b 732e 2041 7574  as it looks. Aut
-00001f90: 6f5f 5669 4d4c 2075 7365 7320 7468 6520  o_ViML uses the 
-00001fa0: 5355 4c4f 5620 616c 676f 7269 7468 6d20  SULOV algorithm 
-00001fb0: 746f 2072 656d 6f76 6520 6869 6768 6c79  to remove highly
-00001fc0: 2063 6f72 7265 6c61 7465 6420 6665 6174   correlated feat
-00001fd0: 7572 6573 2e20 596f 7520 6361 6e20 756e  ures. You can un
-00001fe0: 6465 7273 7461 6e64 2053 554c 4f56 2066  derstand SULOV f
-00001ff0: 726f 6d20 7468 6973 2070 6963 7475 7265  rom this picture
-00002000: 206d 6f72 6520 696e 7475 6974 6976 656c   more intuitivel
-00002010: 792e 3c62 723e 0a20 2020 2020 2020 200a  y.<br>.        .
-00002020: 2020 2020 2020 2020 215b 7375 6c6f 765d          ![sulov]
-00002030: 2853 554c 4f56 2e6a 7067 290a 2020 2020  (SULOV.jpg).    
-00002040: 2020 2020 0a20 2020 2020 2020 203c 6c69      .        <li
-00002050: 3e3c 623e 4765 6e65 7261 7465 7320 7065  ><b>Generates pe
-00002060: 7266 6f72 6d61 6e63 6520 7265 7375 6c74  rformance result
-00002070: 7320 6772 6170 6869 6361 6c6c 793c 2f62  s graphically</b
-00002080: 3e2e 204a 7573 7420 7365 7420 7665 7262  >. Just set verb
-00002090: 6f73 6520 3d20 3120 286f 7229 2032 2069  ose = 1 (or) 2 i
-000020a0: 6e73 7465 6164 206f 6620 3020 2873 696c  nstead of 0 (sil
-000020b0: 656e 7429 2e20 596f 7520 7769 6c6c 2067  ent). You will g
-000020c0: 6574 2068 6967 6865 7220 7175 616c 6974  et higher qualit
-000020d0: 7920 6f66 2069 6e73 6967 6874 7320 6173  y of insights as
-000020e0: 2079 6f75 2069 6e63 7265 6173 6520 7665   you increase ve
-000020f0: 7262 6f73 6974 792e 203c 6272 3e0a 2020  rbosity. <br>.  
-00002100: 2020 2020 2020 3c6c 693e 3c62 3e48 616e        <li><b>Han
-00002110: 646c 6573 2074 6578 742c 2064 6174 652d  dles text, date-
-00002120: 7469 6d65 2c20 7374 7275 6374 7320 286c  time, structs (l
-00002130: 6973 7473 2c20 6469 6374 696f 6e61 7269  ists, dictionari
-00002140: 6573 292c 206e 756d 6572 6963 2c20 626f  es), numeric, bo
-00002150: 6f6c 6561 6e2c 2066 6163 746f 7220 616e  olean, factor an
-00002160: 6420 6361 7465 676f 7269 6361 6c3c 2f62  d categorical</b
-00002170: 3e20 7661 7269 6162 6c65 7320 616c 6c20  > variables all 
-00002180: 696e 206f 6e65 206d 6f64 656c 2075 7369  in one model usi
-00002190: 6e67 206f 6e65 2073 7472 6169 6768 7420  ng one straight 
-000021a0: 7072 6f63 6573 732e 3c62 723e 0a20 2020  process.<br>.   
-000021b0: 2020 2020 203c 2f6f 6c3e 0a20 2020 2020       </ol>.     
-000021c0: 2020 2041 7574 6f5f 5669 4d4c 2069 7320     Auto_ViML is 
-000021d0: 6275 696c 7420 7573 696e 6720 7363 696b  built using scik
-000021e0: 6974 2d6c 6561 726e 2c20 6e75 6d70 792c  it-learn, numpy,
-000021f0: 2070 616e 6461 7320 616e 6420 6d61 7470   pandas and matp
-00002200: 6c6f 746c 6962 2e20 4974 2073 686f 756c  lotlib. It shoul
-00002210: 6420 7275 6e20 6f6e 206d 6f73 7420 5079  d run on most Py
-00002220: 7468 6f6e 2033 2041 6e61 636f 6e64 6120  thon 3 Anaconda 
-00002230: 696e 7374 616c 6c61 7469 6f6e 732e 2059  installations. Y
-00002240: 6f75 2077 6f6e 2774 2068 6176 6520 746f  ou won't have to
-00002250: 2069 6d70 6f72 7420 616e 7920 7370 6563   import any spec
-00002260: 6961 6c20 6c69 6272 6172 6965 7320 6f74  ial libraries ot
-00002270: 6865 7220 7468 616e 2022 5847 426f 6f73  her than "XGBoos
-00002280: 7422 2c20 2249 6d62 616c 616e 6365 642d  t", "Imbalanced-
-00002290: 4c65 6172 6e22 2c20 2243 6174 426f 6f73  Learn", "CatBoos
-000022a0: 7422 2c20 616e 6420 2266 6561 7475 7265  t", and "feature
-000022b0: 746f 6f6c 7322 206c 6962 7261 7279 2e20  tools" library. 
-000022c0: 5765 2075 7365 2022 5348 4150 2220 6c69  We use "SHAP" li
-000022d0: 6272 6172 7920 666f 7220 696e 7465 7270  brary for interp
-000022e0: 7265 7461 6269 6c69 7479 2e20 3c62 723e  retability. <br>
-000022f0: 4275 7420 6966 2079 6f75 2064 6f6e 2774  But if you don't
-00002300: 2068 6176 6520 7468 6573 6520 6c69 6272   have these libr
-00002310: 6172 6965 732c 2041 7574 6f5f 5669 4d4c  aries, Auto_ViML
-00002320: 2077 696c 6c20 696e 7374 616c 6c20 7468   will install th
-00002330: 6f73 6520 666f 7220 796f 7520 6175 746f  ose for you auto
-00002340: 6d61 7469 6361 6c6c 792e 0a20 2020 2020  matically..     
-00002350: 2020 200a 2020 2020 2020 2020 2323 2049     .        ## I
-00002360: 6e73 7461 6c6c 0a20 2020 2020 2020 200a  nstall.        .
-00002370: 2020 2020 2020 2020 2a2a 5072 6572 6571          **Prereq
-00002380: 7573 6974 6573 3a2a 2a0a 2020 2020 2020  usites:**.      
-00002390: 2020 0a20 2020 2020 2020 202d 205b 416e    .        - [An
-000023a0: 6163 6f6e 6461 5d28 6874 7470 733a 2f2f  aconda](https://
-000023b0: 646f 6373 2e61 6e61 636f 6e64 612e 636f  docs.anaconda.co
-000023c0: 6d2f 616e 6163 6f6e 6461 2f69 6e73 7461  m/anaconda/insta
-000023d0: 6c6c 2f29 0a20 2020 2020 2020 200a 2020  ll/).        .  
-000023e0: 2020 2020 2020 546f 2063 6c6f 6e65 2041        To clone A
-000023f0: 7574 6f5f 5669 4d4c 2c20 6974 2069 7320  uto_ViML, it is 
-00002400: 6265 7474 6572 2074 6f20 6372 6561 7465  better to create
-00002410: 2061 206e 6577 2065 6e76 6972 6f6e 6d65   a new environme
-00002420: 6e74 2c20 616e 6420 696e 7374 616c 6c20  nt, and install 
-00002430: 7468 6520 7265 7175 6972 6564 2064 6570  the required dep
-00002440: 656e 6465 6e63 6965 733a 0a20 2020 2020  endencies:.     
-00002450: 2020 200a 2020 2020 2020 2020 546f 2069     .        To i
-00002460: 6e73 7461 6c6c 2066 726f 6d20 5079 5069  nstall from PyPi
-00002470: 3a0a 2020 2020 2020 2020 3c70 3e0a 2020  :.        <p>.  
-00002480: 2020 2020 2020 3c63 6f64 653e 2420 7069        <code>$ pi
-00002490: 7020 696e 7374 616c 6c20 6175 746f 7669  p install autovi
-000024a0: 6d6c 202d 2d75 7067 7261 6465 202d 2d69  ml --upgrade --i
-000024b0: 676e 6f72 652d 696e 7374 616c 6c65 643c  gnore-installed<
-000024c0: 2f63 6f64 653e 3c62 723e 0a20 2020 2020  /code><br>.     
-000024d0: 2020 206f 720a 2020 2020 2020 2020 0a20     or.        . 
-000024e0: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
-000024f0: 2020 2070 6970 2069 6e73 7461 6c6c 2067     pip install g
-00002500: 6974 2b68 7474 7073 3a2f 2f67 6974 6875  it+https://githu
-00002510: 622e 636f 6d2f 4175 746f 5669 4d4c 2f41  b.com/AutoViML/A
-00002520: 7574 6f5f 5669 4d4c 2e67 6974 0a20 2020  uto_ViML.git.   
-00002530: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
-00002540: 200a 2020 2020 2020 2020 546f 2069 6e73   .        To ins
-00002550: 7461 6c6c 2066 726f 6d20 736f 7572 6365  tall from source
-00002560: 3a0a 2020 2020 2020 2020 0a20 2020 2020  :.        .     
-00002570: 2020 2060 6060 0a20 2020 2020 2020 2063     ```.        c
-00002580: 6420 3c41 7574 6f56 494d 4c5f 4465 7374  d <AutoVIML_Dest
-00002590: 696e 6174 696f 6e3e 0a20 2020 2020 2020  ination>.       
-000025a0: 2067 6974 2063 6c6f 6e65 2067 6974 4067   git clone git@g
-000025b0: 6974 6875 622e 636f 6d3a 4175 746f 5669  ithub.com:AutoVi
-000025c0: 4d4c 2f41 7574 6f5f 5669 4d4c 2e67 6974  ML/Auto_ViML.git
-000025d0: 0a20 2020 2020 2020 2023 206f 7220 646f  .        # or do
-000025e0: 776e 6c6f 6164 2061 6e64 2075 6e7a 6970  wnload and unzip
-000025f0: 2068 7474 7073 3a2f 2f67 6974 6875 622e   https://github.
-00002600: 636f 6d2f 4175 746f 5669 4d4c 2f41 7574  com/AutoViML/Aut
-00002610: 6f5f 5669 4d4c 2f61 7263 6869 7665 2f6d  o_ViML/archive/m
-00002620: 6173 7465 722e 7a69 700a 2020 2020 2020  aster.zip.      
-00002630: 2020 636f 6e64 6120 6372 6561 7465 202d    conda create -
-00002640: 6e20 3c79 6f75 725f 656e 765f 6e61 6d65  n <your_env_name
-00002650: 3e20 7079 7468 6f6e 3d33 2e37 2061 6e61  > python=3.7 ana
-00002660: 636f 6e64 610a 2020 2020 2020 2020 636f  conda.        co
-00002670: 6e64 6120 6163 7469 7661 7465 203c 796f  nda activate <yo
-00002680: 7572 5f65 6e76 5f6e 616d 653e 2023 204f  ur_env_name> # O
-00002690: 4e20 5749 4e44 4f57 533a 2060 736f 7572  N WINDOWS: `sour
-000026a0: 6365 2061 6374 6976 6174 6520 3c79 6f75  ce activate <you
-000026b0: 725f 656e 765f 6e61 6d65 3e60 0a20 2020  r_env_name>`.   
-000026c0: 2020 2020 2063 6420 4175 746f 5f56 694d       cd Auto_ViM
-000026d0: 4c0a 2020 2020 2020 2020 7069 7020 696e  L.        pip in
-000026e0: 7374 616c 6c20 2d72 2072 6571 7569 7265  stall -r require
-000026f0: 6d65 6e74 732e 7478 740a 2020 2020 2020  ments.txt.      
-00002700: 2020 6060 600a 2020 2020 2020 2020 0a20    ```.        . 
-00002710: 2020 2020 2020 2023 2320 5573 6167 650a         ## Usage.
-00002720: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00002730: 2049 6e20 7468 6520 7361 6d65 2064 6972   In the same dir
-00002740: 6563 746f 7279 2c20 6f70 656e 2061 204a  ectory, open a J
-00002750: 7570 7974 6572 204e 6f74 6562 6f6f 6b20  upyter Notebook 
-00002760: 616e 6420 7573 6520 7468 6973 206c 696e  and use this lin
-00002770: 6520 746f 2069 6d70 6f72 7420 7468 6520  e to import the 
-00002780: 2e70 7920 6669 6c65 3a0a 2020 2020 2020  .py file:.      
-00002790: 2020 0a20 2020 2020 2020 2060 6060 0a20    .        ```. 
-000027a0: 2020 2020 2020 2066 726f 6d20 6175 746f         from auto
-000027b0: 7669 6d6c 2e41 7574 6f5f 5669 4d4c 2069  viml.Auto_ViML i
-000027c0: 6d70 6f72 7420 4175 746f 5f56 694d 4c0a  mport Auto_ViML.
-000027d0: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
-000027e0: 2020 2020 0a20 2020 2020 2020 204c 6f61      .        Loa
-000027f0: 6420 6120 6461 7461 2073 6574 2028 616e  d a data set (an
-00002800: 7920 4353 5620 6f72 2074 6578 7420 6669  y CSV or text fi
-00002810: 6c65 2920 696e 746f 2061 2050 616e 6461  le) into a Panda
-00002820: 7320 6461 7461 6672 616d 6520 616e 6420  s dataframe and 
-00002830: 7370 6c69 7420 6974 2069 6e74 6f20 5472  split it into Tr
-00002840: 6169 6e20 616e 6420 5465 7374 2064 6174  ain and Test dat
-00002850: 6166 7261 6d65 732e 2049 6620 796f 7520  aframes. If you 
-00002860: 646f 6e27 7420 6861 7665 2061 2074 6573  don't have a tes
-00002870: 7420 6461 7461 6672 616d 652c 2079 6f75  t dataframe, you
-00002880: 2063 616e 2073 696d 706c 6520 6173 7369   can simple assi
-00002890: 676e 2074 6865 2074 6573 7420 7661 7269  gn the test vari
-000028a0: 6162 6c65 2062 656c 6f77 2074 6f20 2727  able below to ''
-000028b0: 2028 656d 7074 7920 7374 7269 6e67 293a   (empty string):
-000028c0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-000028d0: 2020 6060 600a 2020 2020 2020 2020 6d6f    ```.        mo
-000028e0: 6465 6c2c 2066 6561 7475 7265 732c 2074  del, features, t
-000028f0: 7261 696e 6d2c 2074 6573 746d 203d 2041  rainm, testm = A
-00002900: 7574 6f5f 5669 4d4c 280a 2020 2020 2020  uto_ViML(.      
-00002910: 2020 2020 2020 7472 6169 6e2c 0a20 2020        train,.   
-00002920: 2020 2020 2020 2020 2074 6172 6765 742c           target,
-00002930: 0a20 2020 2020 2020 2020 2020 2074 6573  .            tes
-00002940: 742c 0a20 2020 2020 2020 2020 2020 2073  t,.            s
-00002950: 616d 706c 655f 7375 626d 6973 7369 6f6e  ample_submission
-00002960: 2c0a 2020 2020 2020 2020 2020 2020 6879  ,.            hy
-00002970: 7065 725f 7061 7261 6d3d 2247 5322 2c0a  per_param="GS",.
-00002980: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-00002990: 7572 655f 7265 6475 6374 696f 6e3d 5472  ure_reduction=Tr
-000029a0: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-000029b0: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
-000029c0: 723d 2277 6569 6768 7465 642d 6631 222c  r="weighted-f1",
-000029d0: 0a20 2020 2020 2020 2020 2020 204b 4d65  .            KMe
-000029e0: 616e 735f 4665 6174 7572 697a 6572 3d46  ans_Featurizer=F
-000029f0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-00002a00: 2020 426f 6f73 7469 6e67 5f46 6c61 673d    Boosting_Flag=
-00002a10: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-00002a20: 2020 2042 696e 6e69 6e67 5f46 6c61 673d     Binning_Flag=
-00002a30: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-00002a40: 2020 2041 6464 5f50 6f6c 793d 4661 6c73     Add_Poly=Fals
-00002a50: 652c 0a20 2020 2020 2020 2020 2020 2053  e,.            S
-00002a60: 7461 636b 696e 675f 466c 6167 3d46 616c  tacking_Flag=Fal
-00002a70: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00002a80: 496d 6261 6c61 6e63 6564 5f46 6c61 673d  Imbalanced_Flag=
-00002a90: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-00002aa0: 2020 2076 6572 626f 7365 3d30 2c0a 2020     verbose=0,.  
-00002ab0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00002ac0: 6060 600a 2020 2020 2020 2020 0a20 2020  ```.        .   
-00002ad0: 2020 2020 2046 696e 616c 6c79 2c20 6974       Finally, it
-00002ae0: 2077 7269 7465 7320 796f 7572 2073 7562   writes your sub
-00002af0: 6d69 7373 696f 6e20 6669 6c65 2074 6f20  mission file to 
-00002b00: 6469 736b 2069 6e20 7468 6520 6375 7272  disk in the curr
-00002b10: 656e 7420 6469 7265 6374 6f72 7920 6361  ent directory ca
-00002b20: 6c6c 6564 2060 6d79 7375 626d 6973 7369  lled `mysubmissi
-00002b30: 6f6e 2e63 7376 602e 0a20 2020 2020 2020  on.csv`..       
-00002b40: 2054 6869 7320 7375 626d 6973 7369 6f6e   This submission
-00002b50: 2066 696c 6520 6973 2072 6561 6479 2066   file is ready f
-00002b60: 6f72 2079 6f75 2074 6f20 7368 6f77 2069  or you to show i
-00002b70: 7420 636c 6965 6e74 7320 6f72 2073 7562  t clients or sub
-00002b80: 6d69 7420 6974 2074 6f20 636f 6d70 6574  mit it to compet
-00002b90: 6974 696f 6e73 2e0a 2020 2020 2020 2020  itions..        
-00002ba0: 4966 206e 6f20 7375 626d 6973 7369 6f6e  If no submission
-00002bb0: 2066 696c 6520 7761 7320 6769 7665 6e2c   file was given,
-00002bc0: 2062 7574 2061 7320 6c6f 6e67 2061 7320   but as long as 
-00002bd0: 796f 7520 6769 7665 2069 7420 6120 7465  you give it a te
-00002be0: 7374 2066 696c 6520 6e61 6d65 2c20 6974  st file name, it
-00002bf0: 2077 696c 6c20 6372 6561 7465 2061 2073   will create a s
-00002c00: 7562 6d69 7373 696f 6e20 6669 6c65 2066  ubmission file f
-00002c10: 6f72 2079 6f75 206e 616d 6564 2060 6d79  or you named `my
-00002c20: 5375 626d 6973 7369 6f6e 2e63 7376 602e  Submission.csv`.
-00002c30: 0a20 2020 2020 2020 2041 7574 6f5f 5669  .        Auto_Vi
-00002c40: 4d4c 2077 6f72 6b73 206f 6e20 616e 7920  ML works on any 
-00002c50: 4d75 6c74 692d 436c 6173 732c 204d 756c  Multi-Class, Mul
-00002c60: 7469 2d4c 6162 656c 2044 6174 6120 5365  ti-Label Data Se
-00002c70: 742e 2053 6f20 796f 7520 6361 6e20 6861  t. So you can ha
-00002c80: 7665 206d 616e 7920 7461 7267 6574 206c  ve many target l
-00002c90: 6162 656c 732e 0a20 2020 2020 2020 2059  abels..        Y
-00002ca0: 6f75 2064 6f6e 2774 2068 6176 6520 746f  ou don't have to
-00002cb0: 2074 656c 6c20 4175 746f 5f56 694d 4c20   tell Auto_ViML 
-00002cc0: 7768 6574 6865 7220 6974 2069 7320 6120  whether it is a 
-00002cd0: 5265 6772 6573 7369 6f6e 206f 7220 436c  Regression or Cl
-00002ce0: 6173 7369 6669 6361 7469 6f6e 2070 726f  assification pro
-00002cf0: 626c 656d 2e0a 2020 2020 2020 2020 0a20  blem..        . 
-00002d00: 2020 2020 2020 2023 2320 5469 7073 2066         ## Tips f
-00002d10: 6f72 2075 7369 6e67 2041 7574 6f5f 5669  or using Auto_Vi
-00002d20: 4d4c 3a0a 2020 2020 2020 2020 312e 2060  ML:.        1. `
-00002d30: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
-00002d40: 7260 3a20 466f 7220 436c 6173 7369 6669  r`: For Classifi
-00002d50: 6361 7469 6f6e 2070 726f 626c 656d 7320  cation problems 
-00002d60: 616e 6420 696d 6261 6c61 6e63 6564 2063  and imbalanced c
-00002d70: 6c61 7373 6573 2c20 6368 6f6f 7365 2073  lasses, choose s
-00002d80: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
-00002d90: 3d22 6261 6c61 6e63 6564 5f61 6363 7572  ="balanced_accur
-00002da0: 6163 7922 2e20 4974 2077 6f72 6b73 2062  acy". It works b
-00002db0: 6574 7465 722e 0a20 2020 2020 2020 2032  etter..        2
-00002dc0: 2e20 6049 6d62 616c 616e 6365 645f 466c  . `Imbalanced_Fl
-00002dd0: 6167 603a 2046 6f72 2049 6d62 616c 616e  ag`: For Imbalan
-00002de0: 6365 6420 436c 6173 7365 7320 283c 3525  ced Classes (<5%
-00002df0: 2073 616d 706c 6573 2069 6e20 7261 7265   samples in rare
-00002e00: 2063 6c61 7373 292c 2063 686f 6f73 6520   class), choose 
-00002e10: 2249 6d62 616c 616e 6365 645f 466c 6167  "Imbalanced_Flag
-00002e20: 223d 5472 7565 2e20 596f 7520 6361 6e20  "=True. You can 
-00002e30: 616c 736f 2073 6574 2074 6869 7320 666c  also set this fl
-00002e40: 6167 2074 6f20 5472 7565 2066 6f72 2052  ag to True for R
-00002e50: 6567 7265 7373 696f 6e20 7072 6f62 6c65  egression proble
-00002e60: 6d73 2077 6865 7265 2074 6865 2074 6172  ms where the tar
-00002e70: 6765 7420 7661 7269 6162 6c65 206d 6967  get variable mig
-00002e80: 6874 2068 6176 6520 736b 6577 6564 2064  ht have skewed d
-00002e90: 6973 7472 6962 7574 696f 6e73 2e0a 2020  istributions..  
-00002ea0: 2020 2020 2020 332e 2060 7461 7267 6574        3. `target
-00002eb0: 603a 2046 6f72 204d 756c 7469 2d4c 6162  `: For Multi-Lab
-00002ec0: 656c 2064 6174 6173 6574 2c20 7468 6520  el dataset, the 
-00002ed0: 7461 7267 6574 2069 6e70 7574 2074 6172  target input tar
-00002ee0: 6765 7420 7661 7269 6162 6c65 2063 616e  get variable can
-00002ef0: 2062 6520 7365 6e74 2069 6e20 6173 2061   be sent in as a
-00002f00: 206c 6973 7420 6f66 2076 6172 6961 626c   list of variabl
-00002f10: 6573 2e0a 2020 2020 2020 2020 342e 2060  es..        4. `
-00002f20: 426f 6f73 7469 6e67 5f46 6c61 6760 3a20  Boosting_Flag`: 
-00002f30: 4974 2069 7320 7265 636f 6d6d 656e 6465  It is recommende
-00002f40: 6420 7468 6174 2079 6f75 2066 6972 7374  d that you first
-00002f50: 2073 6574 2042 6f6f 7374 696e 675f 466c   set Boosting_Fl
-00002f60: 6167 3d4e 6f6e 6520 746f 2067 6574 2061  ag=None to get a
-00002f70: 204c 696e 6561 7220 6d6f 6465 6c2e 204f   Linear model. O
-00002f80: 6e63 6520 796f 7520 756e 6465 7273 7461  nce you understa
-00002f90: 6e64 2074 6861 742c 2074 6865 6e20 796f  nd that, then yo
-00002fa0: 7520 6361 6e20 7472 7920 746f 2073 6574  u can try to set
-00002fb0: 2042 6f6f 7374 696e 675f 466c 6167 3d46   Boosting_Flag=F
-00002fc0: 616c 7365 2074 6f20 6765 7420 6120 5261  alse to get a Ra
-00002fd0: 6e64 6f6d 2046 6f72 6573 7420 6d6f 6465  ndom Forest mode
-00002fe0: 6c2e 2046 696e 616c 6c79 2c20 7472 7920  l. Finally, try 
-00002ff0: 426f 6f73 7469 6e67 5f46 6c61 673d 5472  Boosting_Flag=Tr
-00003000: 7565 2074 6f20 6765 7420 616e 2058 4742  ue to get an XGB
-00003010: 6f6f 7374 206d 6f64 656c 2e20 5468 6973  oost model. This
-00003020: 2069 7320 7468 6520 6f72 6465 7220 7468   is the order th
-00003030: 6174 2077 6520 7265 636f 6d6d 656e 6420  at we recommend 
-00003040: 696e 206f 7264 6572 2074 6f20 7573 6520  in order to use 
-00003050: 4175 746f 5f56 694d 4c2e 2046 696e 616c  Auto_ViML. Final
-00003060: 6c79 2074 7279 2042 6f6f 7374 696e 675f  ly try Boosting_
-00003070: 466c 6167 3d22 4361 7442 6f6f 7374 2220  Flag="CatBoost" 
-00003080: 746f 2067 6574 2061 2063 6f6d 706c 6578  to get a complex
-00003090: 2062 7574 2068 6967 6820 7065 7266 6f72   but high perfor
-000030a0: 6d69 6e67 206d 6f64 656c 2e0a 2020 2020  ming model..    
-000030b0: 2020 2020 352e 2060 4269 6e6e 696e 675f      5. `Binning_
-000030c0: 466c 6167 603a 2042 696e 6e69 6e67 5f46  Flag`: Binning_F
-000030d0: 6c61 673d 5472 7565 2069 6d70 726f 7665  lag=True improve
-000030e0: 7320 6120 4361 7442 6f6f 7374 206d 6f64  s a CatBoost mod
-000030f0: 656c 2073 696e 6365 2069 7420 6164 6473  el since it adds
-00003100: 2074 6f20 7468 6520 6c69 7374 206f 6620   to the list of 
-00003110: 6361 7465 676f 7269 6361 6c20 7661 7273  categorical vars
-00003120: 2069 6e20 6461 7461 0a20 2020 2020 2020   in data.       
-00003130: 2036 2e20 604b 4d65 616e 735f 6665 6174   6. `KMeans_feat
-00003140: 7572 697a 6572 603a 204b 4d65 616e 735f  urizer`: KMeans_
-00003150: 6665 6174 7572 697a 6572 3d54 7275 6520  featurizer=True 
-00003160: 776f 726b 7320 7765 6c6c 2069 6e20 4e4c  works well in NL
-00003170: 5020 616e 6420 4361 7442 6f6f 7374 206d  P and CatBoost m
-00003180: 6f64 656c 7320 7369 6e63 6520 6974 2063  odels since it c
-00003190: 7265 6174 6573 2063 6c75 7374 6572 2076  reates cluster v
-000031a0: 6172 6961 626c 6573 0a20 2020 2020 2020  ariables.       
-000031b0: 2037 2e20 6041 6464 5f50 6f6c 7960 3a20   7. `Add_Poly`: 
-000031c0: 4164 645f 506f 6c79 3d33 2069 6d70 726f  Add_Poly=3 impro
-000031d0: 7665 7320 6365 7274 6169 6e20 6d6f 6465  ves certain mode
-000031e0: 6c73 2077 6865 7265 2074 6865 7265 2069  ls where there i
-000031f0: 7320 6461 7465 2d74 696d 6520 6f72 2063  s date-time or c
-00003200: 6174 6567 6f72 6963 616c 2061 6e64 206e  ategorical and n
-00003210: 756d 6572 6963 2076 6172 6961 626c 6573  umeric variables
-00003220: 0a20 2020 2020 2020 2038 2e20 6066 6561  .        8. `fea
-00003230: 7475 7265 5f72 6564 7563 7469 6f6e 603a  ture_reduction`:
-00003240: 2066 6561 7475 7265 5f72 6564 7563 7469   feature_reducti
-00003250: 6f6e 3d54 7275 6520 6973 2074 6865 2064  on=True is the d
-00003260: 6566 6175 6c74 2061 6e64 2077 6f72 6b73  efault and works
-00003270: 2062 6573 742e 2042 7574 2077 6865 6e20   best. But when 
-00003280: 796f 7520 6861 7665 203c 3130 2066 6561  you have <10 fea
-00003290: 7475 7265 7320 696e 2064 6174 612c 2073  tures in data, s
-000032a0: 6574 2069 7420 746f 2046 616c 7365 0a20  et it to False. 
-000032b0: 2020 2020 2020 2039 2e20 6053 7461 636b         9. `Stack
-000032c0: 696e 675f 466c 6167 603a 2044 6f20 6e6f  ing_Flag`: Do no
-000032d0: 7420 7365 7420 5374 6163 6b69 6e67 5f46  t set Stacking_F
-000032e0: 6c61 673d 5472 7565 2077 6974 6820 4c69  lag=True with Li
-000032f0: 6e65 6172 206d 6f64 656c 7320 7369 6e63  near models sinc
-00003300: 6520 796f 7572 2072 6573 756c 7473 206d  e your results m
-00003310: 6179 206e 6f74 206c 6f6f 6b20 6772 6561  ay not look grea
-00003320: 742e 0a20 2020 2020 2020 2031 302e 2060  t..        10. `
-00003330: 5374 6163 6b69 6e67 5f46 6c61 6760 3a20  Stacking_Flag`: 
-00003340: 5573 6520 5374 6163 6b69 6e67 5f46 6c61  Use Stacking_Fla
-00003350: 673d 5472 7565 206f 6e6c 7920 666f 7220  g=True only for 
-00003360: 636f 6d70 6c65 7820 6d6f 6465 6c73 2061  complex models a
-00003370: 6e64 2061 7320 6120 6c61 7374 2073 7465  nd as a last ste
-00003380: 7020 7769 7468 2042 6f6f 7374 696e 675f  p with Boosting_
-00003390: 466c 6167 3d54 7275 6520 6f72 2043 6174  Flag=True or Cat
-000033a0: 426f 6f73 740a 2020 2020 2020 2020 3131  Boost.        11
-000033b0: 2e20 6068 7970 6572 5f70 6172 616d 603a  . `hyper_param`:
-000033c0: 204c 6561 7665 2068 7970 6572 5f70 6172   Leave hyper_par
-000033d0: 616d 203d 2252 5322 2061 7320 696e 7075  am ="RS" as inpu
-000033e0: 7420 7369 6e63 6520 6974 2072 756e 7320  t since it runs 
-000033f0: 6661 7374 6572 2074 6861 6e20 4772 6964  faster than Grid
-00003400: 5365 6172 6368 4356 2061 6e64 2067 6976  SearchCV and giv
-00003410: 6573 2062 6574 7465 7220 7265 7375 6c74  es better result
-00003420: 7320 756e 6c65 7373 2079 6f75 2068 6176  s unless you hav
-00003430: 6520 6120 736d 616c 6c20 6461 7461 2073  e a small data s
-00003440: 6574 2061 6e64 2063 616e 2061 6666 6f72  et and can affor
-00003450: 6420 746f 2073 7065 6e64 2074 696d 6520  d to spend time 
-00003460: 6f6e 2068 7970 6572 2074 756e 696e 672e  on hyper tuning.
-00003470: 0a20 2020 2020 2020 2031 322e 2060 4b4d  .        12. `KM
-00003480: 6561 6e73 5f46 6561 7475 7269 7a65 7260  eans_Featurizer`
-00003490: 3a20 4b4d 6561 6e73 5f46 6561 7475 7269  : KMeans_Featuri
-000034a0: 7a65 723d 5472 7565 2064 6f65 7320 6e6f  zer=True does no
-000034b0: 7420 776f 726b 2077 656c 6c20 666f 7220  t work well for 
-000034c0: 736d 616c 6c20 6461 7461 2073 6574 732e  small data sets.
-000034d0: 2055 7365 2069 7420 666f 7220 6461 7461   Use it for data
-000034e0: 2073 6574 7320 3e20 3130 2c30 3030 2072   sets > 10,000 r
-000034f0: 6f77 732e 0a20 2020 2020 2020 2031 332e  ows..        13.
-00003500: 2060 4669 6e61 6c20 7468 6f75 6768 7473   `Final thoughts
-00003510: 603a 2046 696e 616c 6c79 2041 7574 6f5f  `: Finally Auto_
-00003520: 5669 4d4c 2069 7320 6d65 616e 7420 746f  ViML is meant to
-00003530: 2062 6520 6120 6261 7365 6c69 6e65 206f   be a baseline o
-00003540: 7220 6368 616c 6c65 6e67 6572 2073 6f6c  r challenger sol
-00003550: 7574 696f 6e20 746f 2079 6f75 7220 6461  ution to your da
-00003560: 7461 2073 6574 2e20 536f 2075 7365 2069  ta set. So use i
-00003570: 7420 666f 7220 6d61 6b69 6e67 2071 7569  t for making qui
-00003580: 636b 206d 6f64 656c 7320 7468 6174 2079  ck models that y
-00003590: 6f75 2063 616e 2063 6f6d 7061 7265 2061  ou can compare a
-000035a0: 6761 696e 7374 206f 7220 696e 2048 6163  gainst or in Hac
-000035b0: 6b61 7468 6f6e 732e 2049 7420 6973 206e  kathons. It is n
-000035c0: 6f74 206d 6561 6e74 2066 6f72 2070 726f  ot meant for pro
-000035d0: 6475 6374 696f 6e21 0a20 2020 2020 2020  duction!.       
-000035e0: 200a 2020 2020 2020 2020 2323 2041 5049   .        ## API
-000035f0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00003600: 2020 2a2a 4172 6775 6d65 6e74 732a 2a0a    **Arguments**.
-00003610: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00003620: 202d 2060 7472 6169 6e60 3a20 636f 756c   - `train`: coul
-00003630: 6420 6265 2061 2064 6174 6170 6174 682b  d be a datapath+
-00003640: 6669 6c65 6e61 6d65 206f 7220 6120 6461  filename or a da
-00003650: 7461 6672 616d 652e 2049 7420 7769 6c6c  taframe. It will
-00003660: 2064 6574 6563 7420 7768 6963 6820 6973   detect which is
-00003670: 2077 6869 6368 2061 6e64 206c 6f61 6420   which and load 
-00003680: 6974 2e0a 2020 2020 2020 2020 2d20 6074  it..        - `t
-00003690: 6573 7460 3a20 636f 756c 6420 6265 2061  est`: could be a
-000036a0: 2064 6174 6170 6174 682b 6669 6c65 6e61   datapath+filena
-000036b0: 6d65 206f 7220 6120 6461 7461 6672 616d  me or a datafram
-000036c0: 652e 2049 6620 796f 7520 646f 6e27 7420  e. If you don't 
-000036d0: 6861 7665 2061 6e79 2c20 6a75 7374 206c  have any, just l
-000036e0: 6561 7665 2069 7420 6173 2022 222e 0a20  eave it as "".. 
-000036f0: 2020 2020 2020 202d 2060 7375 626d 6973         - `submis
-00003700: 7369 6f6e 603a 206d 7573 7420 6265 2061  sion`: must be a
-00003710: 2064 6174 6170 6174 682b 6669 6c65 6e61   datapath+filena
-00003720: 6d65 2e20 4966 2079 6f75 2064 6f6e 2774  me. If you don't
-00003730: 2068 6176 6520 616e 792c 206a 7573 7420   have any, just 
-00003740: 6c65 6176 6520 6974 2061 7320 656d 7074  leave it as empt
-00003750: 7920 7374 7269 6e67 2e0a 2020 2020 2020  y string..      
-00003760: 2020 2d20 6074 6172 6765 7460 3a20 6e61    - `target`: na
-00003770: 6d65 206f 6620 7468 6520 7461 7267 6574  me of the target
-00003780: 2076 6172 6961 626c 6520 696e 2074 6865   variable in the
-00003790: 2064 6174 6120 7365 742e 0a20 2020 2020   data set..     
-000037a0: 2020 202d 2060 7365 7060 3a20 6966 2079     - `sep`: if y
-000037b0: 6f75 2068 6176 6520 6120 7370 6561 7261  ou have a speara
-000037c0: 746f 7220 696e 2074 6865 2066 696c 6520  tor in the file 
-000037d0: 7375 6368 2061 7320 222c 2220 6f72 2022  such as "," or "
-000037e0: 5c74 2220 6d65 6e74 696f 6e20 6974 2068  \t" mention it h
-000037f0: 6572 652e 2044 6566 6175 6c74 2069 7320  ere. Default is 
-00003800: 222c 222e 0a20 2020 2020 2020 202d 2060  ","..        - `
-00003810: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
-00003820: 7260 3a20 6966 2079 6f75 2077 616e 7420  r`: if you want 
-00003830: 796f 7572 206f 776e 2073 636f 7269 6e67  your own scoring
-00003840: 2070 6172 616d 6574 6572 2073 7563 6820   parameter such 
-00003850: 6173 2022 6631 2220 6769 7665 2069 7420  as "f1" give it 
-00003860: 6865 7265 2e20 4966 206e 6f74 2c20 6974  here. If not, it
-00003870: 2077 696c 6c20 6173 7375 6d65 2074 6865   will assume the
-00003880: 2061 7070 726f 7072 6961 7465 2073 636f   appropriate sco
-00003890: 7269 6e67 2070 6172 616d 2066 6f72 2074  ring param for t
-000038a0: 6865 2070 726f 626c 656d 2061 6e64 2069  he problem and i
-000038b0: 7420 7769 6c6c 2062 7569 6c64 2074 6865  t will build the
-000038c0: 206d 6f64 656c 2e0a 2020 2020 2020 2020   model..        
-000038d0: 2d20 6068 7970 6572 5f70 6172 616d 603a  - `hyper_param`:
-000038e0: 2054 756e 696e 6720 6f70 7469 6f6e 7320   Tuning options 
-000038f0: 6172 6520 4772 6964 5365 6172 6368 2028  are GridSearch (
-00003900: 2747 5327 2920 616e 6420 5261 6e64 6f6d  'GS') and Random
-00003910: 697a 6564 5365 6172 6368 2028 2752 5327  izedSearch ('RS'
-00003920: 292e 2044 6566 6175 6c74 2069 7320 2752  ). Default is 'R
-00003930: 5327 2e0a 2020 2020 2020 2020 2d20 6066  S'..        - `f
-00003940: 6561 7475 7265 5f72 6564 7563 7469 6f6e  eature_reduction
-00003950: 603a 2044 6566 6175 6c74 203d 2027 5472  `: Default = 'Tr
-00003960: 7565 2720 6275 7420 6974 2063 616e 2062  ue' but it can b
-00003970: 6520 7365 7420 746f 2046 616c 7365 2069  e set to False i
-00003980: 6620 796f 7520 646f 6e27 7420 7761 6e74  f you don't want
-00003990: 2061 7574 6f6d 6174 6963 2066 6561 7475   automatic featu
-000039a0: 7265 5f72 6564 7563 7469 6f6e 2073 696e  re_reduction sin
-000039b0: 6365 2069 6e20 496d 6167 6520 6461 7461  ce in Image data
-000039c0: 2073 6574 7320 6c69 6b65 2064 6967 6974   sets like digit
-000039d0: 7320 616e 6420 4d4e 4953 542c 2079 6f75  s and MNIST, you
-000039e0: 2067 6574 2062 6574 7465 7220 7265 7375   get better resu
-000039f0: 6c74 7320 7768 656e 2079 6f75 2064 6f6e  lts when you don
-00003a00: 2774 2072 6564 7563 6520 6665 6174 7572  't reduce featur
-00003a10: 6573 2061 7574 6f6d 6174 6963 616c 6c79  es automatically
-00003a20: 2e20 596f 7520 6361 6e20 616c 7761 7973  . You can always
-00003a30: 2074 7279 2062 6f74 6820 616e 6420 7365   try both and se
-00003a40: 652e 0a20 2020 2020 2020 202d 2060 4b4d  e..        - `KM
-00003a50: 6561 6e73 5f46 6561 7475 7269 7a65 7260  eans_Featurizer`
-00003a60: 0a20 2020 2020 2020 2020 202d 2060 5472  .          - `Tr
-00003a70: 7565 603a 2041 6464 7320 6120 636c 7573  ue`: Adds a clus
-00003a80: 7465 7220 6c61 6265 6c20 746f 2066 6561  ter label to fea
-00003a90: 7475 7265 7320 6261 7365 6420 6f6e 204b  tures based on K
-00003aa0: 4d65 616e 732e 2055 7365 2066 6f72 204c  Means. Use for L
-00003ab0: 696e 6561 722e 0a20 2020 2020 2020 2020  inear..         
-00003ac0: 202d 2060 4661 6c73 6520 2864 6566 6175   - `False (defau
-00003ad0: 6c74 2960 2046 6f72 2052 616e 646f 6d20  lt)` For Random 
-00003ae0: 466f 7265 7374 7320 6f72 2058 4742 206d  Forests or XGB m
-00003af0: 6f64 656c 732c 206c 6561 7665 2069 7420  odels, leave it 
-00003b00: 4661 6c73 6520 7369 6e63 6520 6974 206d  False since it m
-00003b10: 6179 206f 7665 7266 6974 2e0a 2020 2020  ay overfit..    
-00003b20: 2020 2020 2d20 6042 6f6f 7374 696e 6720      - `Boosting 
-00003b30: 466c 6167 603a 2079 6f75 2068 6176 6520  Flag`: you have 
-00003b40: 3420 706f 7373 6962 6c65 2063 686f 6963  4 possible choic
-00003b50: 6573 2028 6465 6661 756c 7420 6973 2046  es (default is F
-00003b60: 616c 7365 293a 0a20 2020 2020 2020 2020  alse):.         
-00003b70: 202d 2060 4e6f 6e65 6020 5468 6973 2077   - `None` This w
-00003b80: 696c 6c20 6275 696c 6420 6120 4c69 6e65  ill build a Line
-00003b90: 6172 204d 6f64 656c 0a20 2020 2020 2020  ar Model.       
-00003ba0: 2020 202d 2060 4661 6c73 6560 2054 6869     - `False` Thi
-00003bb0: 7320 7769 6c6c 2062 7569 6c64 2061 2052  s will build a R
-00003bc0: 616e 646f 6d20 466f 7265 7374 206f 7220  andom Forest or 
-00003bd0: 4578 7472 6120 5472 6565 7320 6d6f 6465  Extra Trees mode
-00003be0: 6c20 2861 6c73 6f20 6b6e 6f77 6e20 6173  l (also known as
-00003bf0: 2042 6167 6769 6e67 290a 2020 2020 2020   Bagging).      
-00003c00: 2020 2020 2d20 6054 7275 6560 2054 6869      - `True` Thi
-00003c10: 7320 7769 6c6c 2062 7569 6c64 2061 6e20  s will build an 
-00003c20: 5847 426f 6f73 7420 6d6f 6465 6c0a 2020  XGBoost model.  
-00003c30: 2020 2020 2020 2020 2d20 6043 6174 426f          - `CatBo
-00003c40: 6f73 7460 2054 6869 7320 7769 6c6c 2062  ost` This will b
-00003c50: 7569 6c64 2061 2043 6174 426f 6f73 7420  uild a CatBoost 
-00003c60: 6d6f 6465 6c20 2870 726f 7669 6465 6420  model (provided 
-00003c70: 796f 7520 6861 7665 2043 6174 426f 6f73  you have CatBoos
-00003c80: 7420 696e 7374 616c 6c65 6429 0a20 2020  t installed).   
-00003c90: 2020 2020 202d 2060 4164 645f 506f 6c79       - `Add_Poly
-00003ca0: 603a 2044 6566 6175 6c74 2069 7320 3020  `: Default is 0 
-00003cb0: 7768 6963 6820 6d65 616e 7320 646f 2d6e  which means do-n
-00003cc0: 6f74 6869 6e67 2e20 4275 7420 6974 2068  othing. But it h
-00003cd0: 6173 2074 6872 6565 2069 6e74 6572 6573  as three interes
-00003ce0: 7469 6e67 2073 6574 7469 6e67 733a 0a20  ting settings:. 
-00003cf0: 2020 2020 2020 2020 202d 2060 3160 2041           - `1` A
-00003d00: 6464 2069 6e74 6572 6163 7469 6f6e 2076  dd interaction v
-00003d10: 6172 6961 626c 6573 206f 6e6c 7920 7375  ariables only su
-00003d20: 6368 2061 7320 7831 2a78 322c 2078 322a  ch as x1*x2, x2*
-00003d30: 7833 2c2e 2e2e 7839 5c2a 3130 2065 7463  x3,...x9\*10 etc
-00003d40: 2e0a 2020 2020 2020 2020 2020 2d20 6032  ..          - `2
-00003d50: 6020 4164 6420 496e 7465 7261 6374 696f  ` Add Interactio
-00003d60: 6e73 2061 6e64 2053 7175 6172 6564 2076  ns and Squared v
-00003d70: 6172 6961 626c 6573 2073 7563 6820 6173  ariables such as
-00003d80: 2078 312a 2a32 2c20 7832 2a2a 322c 2065   x1**2, x2**2, e
-00003d90: 7463 2e0a 2020 2020 2020 2020 2020 2d20  tc..          - 
-00003da0: 6033 6020 4164 6473 2062 6f74 6820 496e  `3` Adds both In
-00003db0: 7465 7261 6374 696f 6e73 2061 6e64 2053  teractions and S
-00003dc0: 7175 6172 6564 2076 6172 6961 626c 6573  quared variables
-00003dd0: 2073 7563 6820 6173 2078 312a 7832 2c20   such as x1*x2, 
-00003de0: 7831 2a2a 322c 7832 2a78 332c 2078 322a  x1**2,x2*x3, x2*
-00003df0: 2a32 2c20 6574 632e 0a20 2020 2020 2020  *2, etc..       
-00003e00: 202d 2060 5374 6163 6b69 6e67 5f46 6c61   - `Stacking_Fla
-00003e10: 6760 3a20 4465 6661 756c 7420 6973 2046  g`: Default is F
-00003e20: 616c 7365 2e20 4966 2073 6574 2074 6f20  alse. If set to 
-00003e30: 5472 7565 2c20 6974 2077 696c 6c20 6164  True, it will ad
-00003e40: 6420 616e 2061 6464 6974 696f 6e61 6c20  d an additional 
-00003e50: 6665 6174 7572 6520 7768 6963 6820 6973  feature which is
-00003e60: 2064 6572 6976 6564 2066 726f 6d20 7072   derived from pr
-00003e70: 6564 6963 7469 6f6e 7320 6f66 2061 6e6f  edictions of ano
-00003e80: 7468 6572 206d 6f64 656c 2e20 5468 6973  ther model. This
-00003e90: 2069 7320 7573 6564 2069 6e20 736f 6d65   is used in some
-00003ea0: 2063 6173 6573 2062 7574 206d 6179 2072   cases but may r
-00003eb0: 6573 756c 7420 696e 206f 7665 7266 6974  esult in overfit
-00003ec0: 7469 6e67 2e20 536f 2062 6520 6361 7265  ting. So be care
-00003ed0: 6675 6c20 7475 726e 696e 6720 7468 6973  ful turning this
-00003ee0: 2066 6c61 6720 226f 6e22 2e0a 2020 2020   flag "on"..    
-00003ef0: 2020 2020 2d20 6042 696e 6e69 6e67 5f46      - `Binning_F
-00003f00: 6c61 6760 3a20 4465 6661 756c 7420 6973  lag`: Default is
-00003f10: 2046 616c 7365 2e20 4974 2073 6574 2074   False. It set t
-00003f20: 6f20 5472 7565 2c20 6974 2077 696c 6c20  o True, it will 
-00003f30: 636f 6e76 6572 7420 7468 6520 746f 7020  convert the top 
-00003f40: 6e75 6d65 7269 6320 7661 7269 6162 6c65  numeric variable
-00003f50: 7320 696e 746f 2062 696e 6e65 6420 7661  s into binned va
-00003f60: 7269 6162 6c65 7320 7468 726f 7567 6820  riables through 
-00003f70: 6120 7465 6368 6e69 7175 6520 6b6e 6f77  a technique know
-00003f80: 6e20 6173 2022 456e 7472 6f70 7922 2062  n as "Entropy" b
-00003f90: 696e 6e69 6e67 2e20 5468 6973 2069 7320  inning. This is 
-00003fa0: 7665 7279 2068 656c 7066 756c 2066 6f72  very helpful for
-00003fb0: 2063 6572 7461 696e 2064 6174 6173 6574   certain dataset
-00003fc0: 7320 2865 7370 6563 6961 6c6c 7920 6861  s (especially ha
-00003fd0: 7264 2074 6f20 6275 696c 6420 6d6f 6465  rd to build mode
-00003fe0: 6c73 292e 0a20 2020 2020 2020 202d 2060  ls)..        - `
-00003ff0: 496d 6261 6c61 6e63 6564 5f46 6c61 6760  Imbalanced_Flag`
-00004000: 3a20 4465 6661 756c 7420 6973 2046 616c  : Default is Fal
-00004010: 7365 2e20 5573 6573 2069 6d62 616c 616e  se. Uses imbalan
-00004020: 6365 645f 656e 7365 6d62 6c65 206c 6962  ced_ensemble lib
-00004030: 7261 7279 2066 6f72 2069 6d62 616c 616e  rary for imbalan
-00004040: 6365 6420 6461 7461 2e20 4a75 7374 2073  ced data. Just s
-00004050: 6574 2049 6d62 616c 616e 6365 645f 466c  et Imbalanced_Fl
-00004060: 6167 203d 2054 7275 6520 696e 2061 7267  ag = True in arg
-00004070: 756d 656e 7473 0a20 2020 2020 2020 202d  uments.        -
-00004080: 2060 7665 7262 6f73 6560 3a20 5468 6973   `verbose`: This
-00004090: 2068 6173 2033 2070 6f73 7369 626c 6520   has 3 possible 
-000040a0: 7374 6174 6573 3a0a 2020 2020 2020 2020  states:.        
-000040b0: 2020 2d20 6030 6020 6c69 6d69 7465 6420    - `0` limited 
-000040c0: 6f75 7470 7574 2e20 4772 6561 7420 666f  output. Great fo
-000040d0: 7220 7275 6e6e 696e 6720 7468 6973 2073  r running this s
-000040e0: 696c 656e 746c 7920 616e 6420 6765 7474  ilently and gett
-000040f0: 696e 6720 6661 7374 2072 6573 756c 7473  ing fast results
-00004100: 2e0a 2020 2020 2020 2020 2020 2d20 6031  ..          - `1
-00004110: 6020 6d6f 7265 2063 6861 7274 732e 2047  ` more charts. G
-00004120: 7265 6174 2066 6f72 206b 6e6f 7769 6e67  reat for knowing
-00004130: 2068 6f77 2072 6573 756c 7473 2077 6572   how results wer
-00004140: 6520 616e 6420 6d61 6b69 6e67 2063 6861  e and making cha
-00004150: 6e67 6573 2074 6f20 666c 6167 7320 696e  nges to flags in
-00004160: 2069 6e70 7574 2e0a 2020 2020 2020 2020   input..        
-00004170: 2020 2d20 6032 6020 6c6f 7473 206f 6620    - `2` lots of 
-00004180: 6368 6172 7473 2061 6e64 206f 7574 7075  charts and outpu
-00004190: 742e 2047 7265 6174 2066 6f72 2072 6570  t. Great for rep
-000041a0: 726f 6475 6369 6e67 2077 6861 7420 4175  roducing what Au
-000041b0: 746f 5f56 694d 4c20 646f 6573 206f 6e20  to_ViML does on 
-000041c0: 796f 7572 206f 776e 2e0a 2020 2020 2020  your own..      
-000041d0: 2020 0a20 2020 2020 2020 202a 2a52 6574    .        **Ret
-000041e0: 7572 6e20 7661 6c75 6573 2a2a 0a20 2020  urn values**.   
-000041f0: 2020 2020 200a 2020 2020 2020 2020 2d20       .        - 
-00004200: 606d 6f64 656c 603a 2049 7420 7769 6c6c  `model`: It will
-00004210: 2072 6574 7572 6e20 796f 7572 2074 7261   return your tra
-00004220: 696e 6564 206d 6f64 656c 0a20 2020 2020  ined model.     
-00004230: 2020 202d 2060 6665 6174 7572 6573 603a     - `features`:
-00004240: 2074 6865 2066 6577 6573 7420 6e75 6d62   the fewest numb
-00004250: 6572 206f 6620 6665 6174 7572 6573 2069  er of features i
-00004260: 6e20 796f 7572 206d 6f64 656c 2074 6f20  n your model to 
-00004270: 6d61 6b65 2069 7420 7065 7266 6f72 6d20  make it perform 
-00004280: 7765 6c6c 0a20 2020 2020 2020 202d 2060  well.        - `
-00004290: 7472 6169 6e5f 6d6f 6469 6669 6564 603a  train_modified`:
-000042a0: 2074 6869 7320 6973 2074 6865 206d 6f64   this is the mod
-000042b0: 6966 6965 6420 7472 6169 6e20 6461 7461  ified train data
-000042c0: 6672 616d 6520 6166 7465 7220 7265 6d6f  frame after remo
-000042d0: 7669 6e67 2061 6e64 2061 6464 696e 6720  ving and adding 
-000042e0: 6665 6174 7572 6573 0a20 2020 2020 2020  features.       
-000042f0: 202d 2060 7465 7374 5f6d 6f64 6966 6965   - `test_modifie
-00004300: 6460 3a20 7468 6973 2069 7320 7468 6520  d`: this is the 
-00004310: 6d6f 6469 6669 6564 2074 6573 7420 6461  modified test da
-00004320: 7461 6672 616d 6520 7769 7468 2074 6865  taframe with the
-00004330: 2073 616d 6520 7472 616e 7366 6f72 6d61   same transforma
-00004340: 7469 6f6e 7320 6173 2074 7261 696e 0a20  tions as train. 
-00004350: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00004360: 2323 204d 6169 6e74 6169 6e65 7273 0a20  ## Maintainers. 
-00004370: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00004380: 2a20 5b40 4175 746f 5669 4d4c 5d28 6874  * [@AutoViML](ht
-00004390: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-000043a0: 2f41 7574 6f56 694d 4c29 0a20 2020 2020  /AutoViML).     
-000043b0: 2020 202a 205b 406d 6f72 656e 6f68 3134     * [@morenoh14
-000043c0: 395d 2868 7474 7073 3a2f 2f67 6974 6875  9](https://githu
-000043d0: 622e 636f 6d2f 6d6f 7265 6e6f 6831 3439  b.com/morenoh149
-000043e0: 290a 2020 2020 2020 2020 2a20 5b40 6869  ).        * [@hi
-000043f0: 726f 6e72 6f79 5d28 6874 7470 733a 2f2f  ronroy](https://
-00004400: 6769 7468 7562 2e63 6f6d 2f68 6972 6f6e  github.com/hiron
-00004410: 726f 7929 0a20 2020 2020 2020 200a 2020  roy).        .  
-00004420: 2020 2020 2020 2323 2043 6f6e 7472 6962        ## Contrib
-00004430: 7574 696e 670a 2020 2020 2020 2020 0a20  uting.        . 
-00004440: 2020 2020 2020 2053 6565 205b 7468 6520         See [the 
-00004450: 636f 6e74 7269 6275 7469 6e67 2066 696c  contributing fil
-00004460: 655d 2843 4f4e 5452 4942 5554 494e 472e  e](CONTRIBUTING.
-00004470: 6d64 2921 0a20 2020 2020 2020 200a 2020  md)!.        .  
-00004480: 2020 2020 2020 5052 7320 6163 6365 7074        PRs accept
-00004490: 6564 2e0a 2020 2020 2020 2020 0a20 2020  ed..        .   
-000044a0: 2020 2020 2023 2320 4c69 6365 6e73 650a       ## License.
-000044b0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-000044c0: 2041 7061 6368 6520 4c69 6365 6e73 6520   Apache License 
-000044d0: 322e 3020 c2a9 2032 3032 3020 5261 6d20  2.0 .. 2020 Ram 
-000044e0: 5365 7368 6164 7269 0a20 2020 2020 2020  Seshadri.       
-000044f0: 200a 2020 2020 2020 2020 2323 2044 4953   .        ## DIS
-00004500: 434c 4149 4d45 520a 2020 2020 2020 2020  CLAIMER.        
-00004510: 5468 6973 2070 726f 6a65 6374 2069 7320  This project is 
-00004520: 6e6f 7420 616e 206f 6666 6963 6961 6c20  not an official 
-00004530: 476f 6f67 6c65 2070 726f 6a65 6374 2e20  Google project. 
-00004540: 4974 2069 7320 6e6f 7420 7375 7070 6f72  It is not suppor
-00004550: 7465 6420 6279 2047 6f6f 676c 6520 616e  ted by Google an
-00004560: 6420 476f 6f67 6c65 2073 7065 6369 6669  d Google specifi
-00004570: 6361 6c6c 7920 6469 7363 6c61 696d 7320  cally disclaims 
-00004580: 616c 6c20 7761 7272 616e 7469 6573 2061  all warranties a
-00004590: 7320 746f 2069 7473 2071 7561 6c69 7479  s to its quality
-000045a0: 2c20 6d65 7263 6861 6e74 6162 696c 6974  , merchantabilit
-000045b0: 792c 206f 7220 6669 746e 6573 7320 666f  y, or fitness fo
-000045c0: 7220 6120 7061 7274 6963 756c 6172 2070  r a particular p
-000045d0: 7572 706f 7365 2e0a 2020 2020 2020 2020  urpose..        
-000045e0: 0a50 6c61 7466 6f72 6d3a 2055 4e4b 4e4f  .Platform: UNKNO
-000045f0: 574e 0a43 6c61 7373 6966 6965 723a 2050  WN.Classifier: P
-00004600: 726f 6772 616d 6d69 6e67 204c 616e 6775  rogramming Langu
-00004610: 6167 6520 3a3a 2050 7974 686f 6e20 3a3a  age :: Python ::
-00004620: 2033 0a43 6c61 7373 6966 6965 723a 204f   3.Classifier: O
-00004630: 7065 7261 7469 6e67 2053 7973 7465 6d20  perating System 
-00004640: 3a3a 204f 5320 496e 6465 7065 6e64 656e  :: OS Independen
-00004650: 740a 4465 7363 7269 7074 696f 6e2d 436f  t.Description-Co
-00004660: 6e74 656e 742d 5479 7065 3a20 7465 7874  ntent-Type: text
-00004670: 2f6d 6172 6b64 6f77 6e0a 0000 0000 0000  /markdown.......
+00001160: 4d61 7263 6820 3230 3233 290a 2020 2020  March 2023).    
+00001170: 2020 2020 3c6f 6c3e 0a20 2020 2020 2020      <ol>.       
+00001180: 203c 6c69 3e3c 623e 4175 746f 5f56 694d   <li><b>Auto_ViM
+00001190: 4c20 6861 7320 6120 6e65 7720 666c 6167  L has a new flag
+000011a0: 2074 6f20 7370 6565 6420 7570 2070 726f   to speed up pro
+000011b0: 6365 7373 696e 6720 7573 696e 6720 4750  cessing using GP
+000011c0: 5527 733c 2f62 3e2e 204a 7573 7420 7365  U's</b>. Just se
+000011d0: 7420 7468 6520 6047 5055 5f66 6c61 6760  t the `GPU_flag`
+000011e0: 3d60 5472 7565 6020 6f6e 2043 6f6c 6162  =`True` on Colab
+000011f0: 2061 6e64 206f 7468 6572 2065 6e76 6972   and other envir
+00001200: 6f6e 6d65 6e74 732e 2042 7574 2064 6f6e  onments. But don
+00001210: 2774 2066 6f72 6765 7420 746f 2073 6574  't forget to set
+00001220: 2074 6865 2072 756e 7469 6d65 2074 7970   the runtime typ
+00001230: 6520 746f 2062 6520 2247 5055 2220 7768  e to be "GPU" wh
+00001240: 696c 6520 7275 6e6e 696e 6720 6f6e 2043  ile running on C
+00001250: 6f6c 6162 2e20 4f74 6865 7277 6973 6520  olab. Otherwise 
+00001260: 796f 7520 7769 6c6c 2067 6574 2061 6e20  you will get an 
+00001270: 6572 726f 722e 3c2f 6c69 3e0a 2020 2020  error.</li>.    
+00001280: 2020 2020 3c2f 6f6c 3e0a 2020 2020 2020      </ol>.      
+00001290: 2020 0a20 2020 2020 2020 2023 2320 5570    .        ## Up
+000012a0: 6461 7465 2028 4d61 7920 3230 3232 290a  date (May 2022).
+000012b0: 2020 2020 2020 2020 3c6f 6c3e 0a20 2020          <ol>.   
+000012c0: 2020 2020 203c 6c69 3e3c 623e 4175 746f       <li><b>Auto
+000012d0: 5f56 694d 4c20 6173 206f 6620 7665 7273  _ViML as of vers
+000012e0: 696f 6e20 302e 312e 3731 3020 7573 6573  ion 0.1.710 uses
+000012f0: 2061 2076 6572 7920 6869 6768 2070 6572   a very high per
+00001300: 666f 726d 616e 6365 206c 6962 7261 7279  formance library
+00001310: 2063 616c 6c65 6420 6069 6d62 616c 616e   called `imbalan
+00001320: 6365 645f 656e 7365 6d62 6c65 6020 666f  ced_ensemble` fo
+00001330: 7220 496d 6261 6c61 6e63 6564 2064 6174  r Imbalanced dat
+00001340: 6173 6574 2070 726f 626c 656d 732e 3c2f  aset problems.</
+00001350: 623e 2049 7420 7769 6c6c 2070 726f 6475  b> It will produ
+00001360: 6365 2061 2035 2d31 3025 2062 6f6f 7374  ce a 5-10% boost
+00001370: 2069 6e20 796f 7572 2062 616c 616e 6365   in your balance
+00001380: 645f 6163 6375 7261 6379 2062 6173 6564  d_accuracy based
+00001390: 206f 6e20 6d79 2065 7870 6572 6965 6e63   on my experienc
+000013a0: 6520 7769 7468 2020 6d61 6e79 2064 6174  e with  many dat
+000013b0: 6173 6574 7320 4920 6861 7665 2074 7269  asets I have tri
+000013c0: 6564 2e3c 2f6c 693e 0a20 2020 2020 2020  ed.</li>.       
+000013d0: 203c 6272 3e0a 2020 2020 2020 2020 3c70   <br>.        <p
+000013e0: 3e49 6e20 6164 6469 7469 6f6e 2c20 6e65  >In addition, ne
+000013f0: 7720 6665 6174 7572 6573 2069 6e20 7468  w features in th
+00001400: 6973 2076 6572 7369 6f6e 2061 7265 3a3c  is version are:<
+00001410: 6272 3e0a 2020 2020 2020 2020 3c75 6c3e  br>.        <ul>
+00001420: 0a20 2020 2020 2020 203c 6c69 3e53 554c  .        <li>SUL
+00001430: 4f56 202d 3e20 5573 6573 2074 6865 2053  OV -> Uses the S
+00001440: 554c 4f56 2061 6c67 6f72 6974 686d 2066  ULOV algorithm f
+00001450: 6f72 2072 656d 6f76 696e 6720 6869 6768  or removing high
+00001460: 6c79 2063 6f72 7265 6c61 7465 6420 6665  ly correlated fe
+00001470: 6174 7572 6573 2061 7574 6f6d 6174 6963  atures automatic
+00001480: 616c 6c79 2e3c 2f6c 693e 0a20 2020 2020  ally.</li>.     
+00001490: 2020 203c 6c69 3e41 7574 6f5f 4e4c 5020     <li>Auto_NLP 
+000014a0: 2d3e 2041 7574 6f56 694d 4c20 6175 746f  -> AutoViML auto
+000014b0: 6d61 7469 6361 6c6c 7920 6465 7465 6374  matically detect
+000014c0: 7320 5465 7874 2076 6172 6961 626c 6573  s Text variables
+000014d0: 2061 6e64 2064 6f65 7320 4e4c 5020 7072   and does NLP pr
+000014e0: 6f63 6573 7369 6e67 2075 7369 6e67 2041  ocessing using A
+000014f0: 7574 6f5f 4e4c 503c 2f6c 693e 0a20 2020  uto_NLP</li>.   
+00001500: 2020 2020 203c 6c69 3e44 6174 6520 5469       <li>Date Ti
+00001510: 6d65 202d 3e20 4974 2061 7574 6f6d 6174  me -> It automat
+00001520: 6963 616c 6c79 2064 6574 6563 7473 2020  ically detects  
+00001530: 6461 7465 2074 696d 6520 7661 7269 6162  date time variab
+00001540: 6c65 7320 616e 6420 6765 6e65 7261 7465  les and generate
+00001550: 7320 6e65 7720 6665 6174 7572 6573 3c2f  s new features</
+00001560: 6c69 3e0a 2020 2020 2020 2020 3c6c 693e  li>.        <li>
+00001570: 6069 6d62 616c 616e 6365 645f 656e 7365  `imbalanced_ense
+00001580: 6d62 6c65 6020 6c69 6272 6172 7920 2d3e  mble` library ->
+00001590: 2055 7365 7320 696d 6261 6c61 6e63 6564   Uses imbalanced
+000015a0: 5f65 6e73 656d 626c 6520 6c69 6272 6172  _ensemble librar
+000015b0: 7920 666f 7220 696d 6261 6c61 6e63 6564  y for imbalanced
+000015c0: 2064 6174 612e 204a 7573 7420 7365 7420   data. Just set 
+000015d0: 496d 6261 6c61 6e63 6564 5f46 6c61 6720  Imbalanced_Flag 
+000015e0: 3d20 5472 7565 2069 6e20 6172 6775 6d65  = True in argume
+000015f0: 6e74 733c 2f6c 693e 0a20 2020 2020 2020  nts</li>.       
+00001600: 203c 6c69 3e46 6561 7475 7265 2053 656c   <li>Feature Sel
+00001610: 6563 7469 6f6e 202d 3e20 5765 2075 7365  ection -> We use
+00001620: 2074 6865 2073 616d 6520 616c 676f 7269   the same algori
+00001630: 7468 6d20 7468 6174 2066 6561 7475 7265  thm that feature
+00001640: 7769 7a20 6c69 6272 6172 7920 7573 6573  wiz library uses
+00001650: 3a20 5355 4c4f 5620 616e 6420 5265 6375  : SULOV and Recu
+00001660: 7273 6976 6520 5847 426f 6f73 7420 746f  rsive XGBoost to
+00001670: 2073 656c 6563 7420 6265 7374 2066 6561   select best fea
+00001680: 7475 7265 7320 6661 7374 2e20 5365 6520  tures fast. See 
+00001690: 6265 6c6f 772e 3c2f 6c69 3e0a 2020 2020  below.</li>.    
+000016a0: 2020 2020 3c2f 756c 3e0a 2020 2020 2020      </ul>.      
+000016b0: 2020 0a20 2020 2020 2020 2023 2320 5461    .        ## Ta
+000016c0: 626c 6520 6f66 2043 6f6e 7465 6e74 730a  ble of Contents.
+000016d0: 2020 2020 2020 2020 3c75 6c3e 0a20 2020          <ul>.   
+000016e0: 2020 2020 203c 6c69 3e3c 6120 6872 6566       <li><a href
+000016f0: 3d22 2362 6163 6b67 726f 756e 6422 3e42  ="#background">B
+00001700: 6163 6b67 726f 756e 643c 2f61 3e3c 2f6c  ackground</a></l
+00001710: 693e 0a20 2020 2020 2020 203c 6c69 3e3c  i>.        <li><
+00001720: 6120 6872 6566 3d22 2369 6e73 7461 6c6c  a href="#install
+00001730: 223e 496e 7374 616c 6c3c 2f61 3e3c 2f6c  ">Install</a></l
+00001740: 693e 0a20 2020 2020 2020 203c 6c69 3e3c  i>.        <li><
+00001750: 6120 6872 6566 3d22 2375 7361 6765 223e  a href="#usage">
+00001760: 5573 6167 653c 2f61 3e3c 2f6c 693e 0a20  Usage</a></li>. 
+00001770: 2020 2020 2020 203c 6c69 3e3c 6120 6872         <li><a hr
+00001780: 6566 3d22 2374 6970 732d 666f 722d 7573  ef="#tips-for-us
+00001790: 696e 672d 6175 746f 5f76 696d 6c22 3e54  ing-auto_viml">T
+000017a0: 6970 7320 666f 7220 7573 696e 6720 4175  ips for using Au
+000017b0: 746f 5f56 694d 4c3c 2f61 3e3c 2f6c 693e  to_ViML</a></li>
+000017c0: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
+000017d0: 6872 6566 3d22 2361 7069 223e 4150 493c  href="#api">API<
+000017e0: 2f61 3e3c 2f6c 693e 0a20 2020 2020 2020  /a></li>.       
+000017f0: 203c 6c69 3e3c 6120 6872 6566 3d22 236d   <li><a href="#m
+00001800: 6169 6e74 6169 6e65 7273 223e 4d61 696e  aintainers">Main
+00001810: 7461 696e 6572 733c 2f61 3e3c 2f6c 693e  tainers</a></li>
+00001820: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
+00001830: 6872 6566 3d22 2363 6f6e 7472 6962 7574  href="#contribut
+00001840: 696e 6722 3e43 6f6e 7472 6962 7574 696e  ing">Contributin
+00001850: 673c 2f61 3e3c 2f6c 693e 0a20 2020 2020  g</a></li>.     
+00001860: 2020 203c 6c69 3e3c 6120 6872 6566 3d22     <li><a href="
+00001870: 236c 6963 656e 7365 223e 4c69 6365 6e73  #license">Licens
+00001880: 653c 2f61 3e3c 2f6c 693e 0a20 2020 2020  e</a></li>.     
+00001890: 2020 203c 2f75 6c3e 0a20 2020 2020 2020     </ul>.       
+000018a0: 200a 2020 2020 2020 2020 2323 2042 6163   .        ## Bac
+000018b0: 6b67 726f 756e 640a 2020 2020 2020 2020  kground.        
+000018c0: 3c70 3e52 6561 6420 7468 6973 203c 6120  <p>Read this <a 
+000018d0: 6872 6566 3d22 6874 7470 733a 2f2f 746f  href="https://to
+000018e0: 7761 7264 7364 6174 6173 6369 656e 6365  wardsdatascience
+000018f0: 2e63 6f6d 2f77 6879 2d61 7574 6f6d 6c2d  .com/why-automl-
+00001900: 6973 2d61 6e2d 6573 7365 6e74 6961 6c2d  is-an-essential-
+00001910: 6e65 772d 746f 6f6c 2d66 6f72 2d64 6174  new-tool-for-dat
+00001920: 612d 7363 6965 6e74 6973 7473 2d32 6439  a-scientists-2d9
+00001930: 6162 3465 3235 6534 3622 3e4d 6564 6975  ab4e25e46">Mediu
+00001940: 6d20 6172 7469 636c 6520 746f 206c 6561  m article to lea
+00001950: 726e 2068 6f77 2074 6f20 7573 6520 4175  rn how to use Au
+00001960: 746f 5f56 694d 4c20 6566 6665 6374 6976  to_ViML effectiv
+00001970: 656c 792e 3c2f 613e 0a20 2020 2020 2020  ely.</a>.       
+00001980: 200a 2020 2020 2020 2020 3c70 3e41 7574   .        <p>Aut
+00001990: 6f5f 5669 4d4c 2077 6173 2064 6573 6967  o_ViML was desig
+000019a0: 6e65 6420 666f 7220 6275 696c 6469 6e67  ned for building
+000019b0: 2048 6967 6820 5065 7266 6f72 6d61 6e63   High Performanc
+000019c0: 6520 496e 7465 7270 7265 7461 626c 6520  e Interpretable 
+000019d0: 4d6f 6465 6c73 2077 6974 6820 7468 6520  Models with the 
+000019e0: 6665 7765 7374 2076 6172 6961 626c 6573  fewest variables
+000019f0: 206e 6565 6465 642e 0a20 2020 2020 2020   needed..       
+00001a00: 2054 6865 2022 5622 2069 6e20 4175 746f   The "V" in Auto
+00001a10: 5f56 694d 4c20 7374 616e 6473 2066 6f72  _ViML stands for
+00001a20: 2056 6172 6961 6e74 2062 6563 6175 7365   Variant because
+00001a30: 2069 7420 7472 6965 7320 6d75 6c74 6970   it tries multip
+00001a40: 6c65 206d 6f64 656c 7320 7769 7468 206d  le models with m
+00001a50: 756c 7469 706c 6520 6665 6174 7572 6573  ultiple features
+00001a60: 2074 6f20 6669 6e64 2079 6f75 2074 6865   to find you the
+00001a70: 2062 6573 7420 7065 7266 6f72 6d69 6e67   best performing
+00001a80: 206d 6f64 656c 2066 6f72 2079 6f75 7220   model for your 
+00001a90: 6461 7461 7365 742e 2054 6865 2022 6922  dataset. The "i"
+00001aa0: 2069 6e20 4175 746f 5f56 694d 4c20 7374   in Auto_ViML st
+00001ab0: 616e 6473 2066 6f72 2022 696e 7465 7270  ands for "interp
+00001ac0: 7265 7461 626c 6522 2073 696e 6365 2041  retable" since A
+00001ad0: 7574 6f5f 5669 4d4c 2073 656c 6563 7473  uto_ViML selects
+00001ae0: 2074 6865 206c 6561 7374 206e 756d 6265   the least numbe
+00001af0: 7220 6f66 2066 6561 7475 7265 7320 6e65  r of features ne
+00001b00: 6365 7373 6172 7920 746f 2062 7569 6c64  cessary to build
+00001b10: 2061 2073 696d 706c 6572 2c20 6d6f 7265   a simpler, more
+00001b20: 2069 6e74 6572 7072 6574 6162 6c65 206d   interpretable m
+00001b30: 6f64 656c 2e20 496e 206d 6f73 7420 6361  odel. In most ca
+00001b40: 7365 732c 2041 7574 6f5f 5669 4d4c 2062  ses, Auto_ViML b
+00001b50: 7569 6c64 7320 6d6f 6465 6c73 2077 6974  uilds models wit
+00001b60: 6820 3230 252d 3939 2520 6665 7765 7220  h 20%-99% fewer 
+00001b70: 6665 6174 7572 6573 2074 6861 6e20 6120  features than a 
+00001b80: 7369 6d69 6c61 7220 7065 7266 6f72 6d69  similar performi
+00001b90: 6e67 206d 6f64 656c 2077 6974 6820 616c  ng model with al
+00001ba0: 6c20 696e 636c 7564 6564 2066 6561 7475  l included featu
+00001bb0: 7265 7320 2874 6869 7320 6973 2062 6173  res (this is bas
+00001bc0: 6564 206f 6e20 6d79 2074 7269 616c 732e  ed on my trials.
+00001bd0: 2059 6f75 7220 6578 7065 7269 656e 6365   Your experience
+00001be0: 206d 6179 2076 6172 7929 2e3c 6272 3e0a   may vary).<br>.
+00001bf0: 2020 2020 2020 2020 3c70 3e0a 2020 2020          <p>.    
+00001c00: 2020 2020 4175 746f 5f56 694d 4c20 6973      Auto_ViML is
+00001c10: 2065 7665 7279 2044 6174 6120 5363 6965   every Data Scie
+00001c20: 6e74 6973 7427 7320 6d6f 6465 6c20 6163  ntist's model ac
+00001c30: 6365 6c65 7261 746f 7220 746f 6f6c 2074  celerator tool t
+00001c40: 6861 743a 3c6f 6c3e 0a20 2020 2020 2020  hat:<ol>.       
+00001c50: 203c 6c69 3e3c 623e 4865 6c70 7320 796f   <li><b>Helps yo
+00001c60: 7520 7769 7468 2064 6174 6120 636c 6561  u with data clea
+00001c70: 6e69 6e67 3c2f 623e 3a20 796f 7520 6361  ning</b>: you ca
+00001c80: 6e20 7365 6e64 2069 6e20 796f 7572 2065  n send in your e
+00001c90: 6e74 6972 6520 6461 7461 6672 616d 6520  ntire dataframe 
+00001ca0: 6173 2069 7320 616e 6420 4175 746f 5f56  as is and Auto_V
+00001cb0: 694d 4c20 7769 6c6c 2073 7567 6765 7374  iML will suggest
+00001cc0: 2063 6861 6e67 6573 2074 6f20 6865 6c70   changes to help
+00001cd0: 2077 6974 6820 6d69 7373 696e 6720 7661   with missing va
+00001ce0: 6c75 6573 2c20 666f 726d 6174 7469 6e67  lues, formatting
+00001cf0: 2076 6172 6961 626c 6573 2c20 6164 6469   variables, addi
+00001d00: 6e67 2076 6172 6961 626c 6573 2c20 6574  ng variables, et
+00001d10: 632e 2049 7420 6c6f 7665 7320 6469 7274  c. It loves dirt
+00001d20: 7920 6461 7461 2e20 5468 6520 6469 7274  y data. The dirt
+00001d30: 6965 7220 7468 6520 6265 7474 6572 213c  ier the better!<
+00001d40: 6272 3e0a 2020 2020 2020 2020 3c6c 693e  br>.        <li>
+00001d50: 3c62 3e50 6572 666f 726d 7320 4665 6174  <b>Performs Feat
+00001d60: 7572 6520 5365 6c65 6374 696f 6e3c 2f62  ure Selection</b
+00001d70: 3e3a 2041 7574 6f5f 5669 4d4c 2073 656c  >: Auto_ViML sel
+00001d80: 6563 7473 2076 6172 6961 626c 6573 2061  ects variables a
+00001d90: 7574 6f6d 6174 6963 616c 6c79 2062 7920  utomatically by 
+00001da0: 6465 6661 756c 742e 2054 6869 7320 6973  default. This is
+00001db0: 2076 6572 7920 6865 6c70 6675 6c20 7768   very helpful wh
+00001dc0: 656e 2079 6f75 2068 6176 6520 6875 6e64  en you have hund
+00001dd0: 7265 6473 2069 6620 6e6f 7420 7468 6f75  reds if not thou
+00001de0: 7361 6e64 7320 6f66 2076 6172 6961 626c  sands of variabl
+00001df0: 6573 2073 696e 6365 2069 7420 6361 6e20  es since it can 
+00001e00: 7265 6164 696c 7920 6964 656e 7469 6679  readily identify
+00001e10: 2077 6869 6368 206f 6620 7468 6f73 6520   which of those 
+00001e20: 6172 6520 696d 706f 7274 616e 7420 7661  are important va
+00001e30: 7269 6162 6c65 7320 7673 2077 6869 6368  riables vs which
+00001e40: 2061 7265 2075 6e6e 6563 6573 7361 7279   are unnecessary
+00001e50: 2e20 596f 7520 6361 6e20 7475 726e 2074  . You can turn t
+00001e60: 6869 7320 6f66 6620 6173 2077 656c 6c20  his off as well 
+00001e70: 2873 6565 2041 5049 292e 3c62 723e 0a20  (see API).<br>. 
+00001e80: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00001e90: 215b 7867 626f 6f73 745d 2873 756c 6f76  ![xgboost](sulov
+00001ea0: 5f78 6762 6f6f 7374 2e70 6e67 290a 2020  _xgboost.png).  
+00001eb0: 2020 2020 2020 3c6c 693e 3c62 3e52 656d        <li><b>Rem
+00001ec0: 6f76 6573 2068 6967 686c 7920 636f 7272  oves highly corr
+00001ed0: 656c 6174 6564 2066 6561 7475 7265 7320  elated features 
+00001ee0: 6175 746f 6d61 7469 6361 6c6c 793c 2f62  automatically</b
+00001ef0: 3e2e 2049 6620 7477 6f20 7661 7269 6162  >. If two variab
+00001f00: 6c65 7320 6172 6520 6869 6768 6c79 2063  les are highly c
+00001f10: 6f72 7265 6c61 7465 6420 696e 2079 6f75  orrelated in you
+00001f20: 7220 6461 7461 7365 742c 2077 6869 6368  r dataset, which
+00001f30: 206f 6e65 2073 686f 756c 6420 796f 7520   one should you 
+00001f40: 7265 6d6f 7665 2061 6e64 2077 6869 6368  remove and which
+00001f50: 206f 6e65 2073 686f 756c 6420 796f 7520   one should you 
+00001f60: 6b65 6570 3f20 5468 6520 6465 6369 7369  keep? The decisi
+00001f70: 6f6e 2069 7320 6e6f 7420 6173 2065 6173  on is not as eas
+00001f80: 7920 6173 2069 7420 6c6f 6f6b 732e 2041  y as it looks. A
+00001f90: 7574 6f5f 5669 4d4c 2075 7365 7320 7468  uto_ViML uses th
+00001fa0: 6520 5355 4c4f 5620 616c 676f 7269 7468  e SULOV algorith
+00001fb0: 6d20 746f 2072 656d 6f76 6520 6869 6768  m to remove high
+00001fc0: 6c79 2063 6f72 7265 6c61 7465 6420 6665  ly correlated fe
+00001fd0: 6174 7572 6573 2e20 596f 7520 6361 6e20  atures. You can 
+00001fe0: 756e 6465 7273 7461 6e64 2053 554c 4f56  understand SULOV
+00001ff0: 2066 726f 6d20 7468 6973 2070 6963 7475   from this pictu
+00002000: 7265 206d 6f72 6520 696e 7475 6974 6976  re more intuitiv
+00002010: 656c 792e 3c62 723e 0a20 2020 2020 2020  ely.<br>.       
+00002020: 200a 2020 2020 2020 2020 215b 7375 6c6f   .        ![sulo
+00002030: 765d 2853 554c 4f56 2e6a 7067 290a 2020  v](SULOV.jpg).  
+00002040: 2020 2020 2020 0a20 2020 2020 2020 203c        .        <
+00002050: 6c69 3e3c 623e 4765 6e65 7261 7465 7320  li><b>Generates 
+00002060: 7065 7266 6f72 6d61 6e63 6520 7265 7375  performance resu
+00002070: 6c74 7320 6772 6170 6869 6361 6c6c 793c  lts graphically<
+00002080: 2f62 3e2e 204a 7573 7420 7365 7420 7665  /b>. Just set ve
+00002090: 7262 6f73 6520 3d20 3120 286f 7229 2032  rbose = 1 (or) 2
+000020a0: 2069 6e73 7465 6164 206f 6620 3020 2873   instead of 0 (s
+000020b0: 696c 656e 7429 2e20 596f 7520 7769 6c6c  ilent). You will
+000020c0: 2067 6574 2068 6967 6865 7220 7175 616c   get higher qual
+000020d0: 6974 7920 6f66 2069 6e73 6967 6874 7320  ity of insights 
+000020e0: 6173 2079 6f75 2069 6e63 7265 6173 6520  as you increase 
+000020f0: 7665 7262 6f73 6974 792e 203c 6272 3e0a  verbosity. <br>.
+00002100: 2020 2020 2020 2020 3c6c 693e 3c62 3e48          <li><b>H
+00002110: 616e 646c 6573 2074 6578 742c 2064 6174  andles text, dat
+00002120: 652d 7469 6d65 2c20 7374 7275 6374 7320  e-time, structs 
+00002130: 286c 6973 7473 2c20 6469 6374 696f 6e61  (lists, dictiona
+00002140: 7269 6573 292c 206e 756d 6572 6963 2c20  ries), numeric, 
+00002150: 626f 6f6c 6561 6e2c 2066 6163 746f 7220  boolean, factor 
+00002160: 616e 6420 6361 7465 676f 7269 6361 6c3c  and categorical<
+00002170: 2f62 3e20 7661 7269 6162 6c65 7320 616c  /b> variables al
+00002180: 6c20 696e 206f 6e65 206d 6f64 656c 2075  l in one model u
+00002190: 7369 6e67 206f 6e65 2073 7472 6169 6768  sing one straigh
+000021a0: 7420 7072 6f63 6573 732e 3c62 723e 0a20  t process.<br>. 
+000021b0: 2020 2020 2020 203c 2f6f 6c3e 0a20 2020         </ol>.   
+000021c0: 2020 2020 2041 7574 6f5f 5669 4d4c 2069       Auto_ViML i
+000021d0: 7320 6275 696c 7420 7573 696e 6720 7363  s built using sc
+000021e0: 696b 6974 2d6c 6561 726e 2c20 6e75 6d70  ikit-learn, nump
+000021f0: 792c 2070 616e 6461 7320 616e 6420 6d61  y, pandas and ma
+00002200: 7470 6c6f 746c 6962 2e20 4974 2073 686f  tplotlib. It sho
+00002210: 756c 6420 7275 6e20 6f6e 206d 6f73 7420  uld run on most 
+00002220: 5079 7468 6f6e 2033 2041 6e61 636f 6e64  Python 3 Anacond
+00002230: 6120 696e 7374 616c 6c61 7469 6f6e 732e  a installations.
+00002240: 2059 6f75 2077 6f6e 2774 2068 6176 6520   You won't have 
+00002250: 746f 2069 6d70 6f72 7420 616e 7920 7370  to import any sp
+00002260: 6563 6961 6c20 6c69 6272 6172 6965 7320  ecial libraries 
+00002270: 6f74 6865 7220 7468 616e 2022 5847 426f  other than "XGBo
+00002280: 6f73 7422 2c20 2249 6d62 616c 616e 6365  ost", "Imbalance
+00002290: 642d 4c65 6172 6e22 2c20 2243 6174 426f  d-Learn", "CatBo
+000022a0: 6f73 7422 2c20 616e 6420 2266 6561 7475  ost", and "featu
+000022b0: 7265 746f 6f6c 7322 206c 6962 7261 7279  retools" library
+000022c0: 2e20 5765 2075 7365 2022 5348 4150 2220  . We use "SHAP" 
+000022d0: 6c69 6272 6172 7920 666f 7220 696e 7465  library for inte
+000022e0: 7270 7265 7461 6269 6c69 7479 2e20 3c62  rpretability. <b
+000022f0: 723e 4275 7420 6966 2079 6f75 2064 6f6e  r>But if you don
+00002300: 2774 2068 6176 6520 7468 6573 6520 6c69  't have these li
+00002310: 6272 6172 6965 732c 2041 7574 6f5f 5669  braries, Auto_Vi
+00002320: 4d4c 2077 696c 6c20 696e 7374 616c 6c20  ML will install 
+00002330: 7468 6f73 6520 666f 7220 796f 7520 6175  those for you au
+00002340: 746f 6d61 7469 6361 6c6c 792e 0a20 2020  tomatically..   
+00002350: 2020 2020 200a 2020 2020 2020 2020 2323       .        ##
+00002360: 2049 6e73 7461 6c6c 0a20 2020 2020 2020   Install.       
+00002370: 200a 2020 2020 2020 2020 2a2a 5072 6572   .        **Prer
+00002380: 6571 7573 6974 6573 3a2a 2a0a 2020 2020  equsites:**.    
+00002390: 2020 2020 0a20 2020 2020 2020 202d 205b      .        - [
+000023a0: 416e 6163 6f6e 6461 5d28 6874 7470 733a  Anaconda](https:
+000023b0: 2f2f 646f 6373 2e61 6e61 636f 6e64 612e  //docs.anaconda.
+000023c0: 636f 6d2f 616e 6163 6f6e 6461 2f69 6e73  com/anaconda/ins
+000023d0: 7461 6c6c 2f29 0a20 2020 2020 2020 200a  tall/).        .
+000023e0: 2020 2020 2020 2020 546f 2063 6c6f 6e65          To clone
+000023f0: 2041 7574 6f5f 5669 4d4c 2c20 6974 2069   Auto_ViML, it i
+00002400: 7320 6265 7474 6572 2074 6f20 6372 6561  s better to crea
+00002410: 7465 2061 206e 6577 2065 6e76 6972 6f6e  te a new environ
+00002420: 6d65 6e74 2c20 616e 6420 696e 7374 616c  ment, and instal
+00002430: 6c20 7468 6520 7265 7175 6972 6564 2064  l the required d
+00002440: 6570 656e 6465 6e63 6965 733a 0a20 2020  ependencies:.   
+00002450: 2020 2020 200a 2020 2020 2020 2020 546f       .        To
+00002460: 2069 6e73 7461 6c6c 2066 726f 6d20 5079   install from Py
+00002470: 5069 3a0a 2020 2020 2020 2020 3c70 3e0a  Pi:.        <p>.
+00002480: 2020 2020 2020 2020 3c63 6f64 653e 2420          <code>$ 
+00002490: 7069 7020 696e 7374 616c 6c20 6175 746f  pip install auto
+000024a0: 7669 6d6c 202d 2d75 7067 7261 6465 202d  viml --upgrade -
+000024b0: 2d69 676e 6f72 652d 696e 7374 616c 6c65  -ignore-installe
+000024c0: 643c 2f63 6f64 653e 3c62 723e 0a20 2020  d</code><br>.   
+000024d0: 2020 2020 206f 720a 2020 2020 2020 2020       or.        
+000024e0: 0a20 2020 2020 2020 2060 6060 0a20 2020  .        ```.   
+000024f0: 2020 2020 2070 6970 2069 6e73 7461 6c6c       pip install
+00002500: 2067 6974 2b68 7474 7073 3a2f 2f67 6974   git+https://git
+00002510: 6875 622e 636f 6d2f 4175 746f 5669 4d4c  hub.com/AutoViML
+00002520: 2f41 7574 6f5f 5669 4d4c 2e67 6974 0a20  /Auto_ViML.git. 
+00002530: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
+00002540: 2020 200a 2020 2020 2020 2020 546f 2069     .        To i
+00002550: 6e73 7461 6c6c 2066 726f 6d20 736f 7572  nstall from sour
+00002560: 6365 3a0a 2020 2020 2020 2020 0a20 2020  ce:.        .   
+00002570: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
+00002580: 2063 6420 3c41 7574 6f56 494d 4c5f 4465   cd <AutoVIML_De
+00002590: 7374 696e 6174 696f 6e3e 0a20 2020 2020  stination>.     
+000025a0: 2020 2067 6974 2063 6c6f 6e65 2067 6974     git clone git
+000025b0: 4067 6974 6875 622e 636f 6d3a 4175 746f  @github.com:Auto
+000025c0: 5669 4d4c 2f41 7574 6f5f 5669 4d4c 2e67  ViML/Auto_ViML.g
+000025d0: 6974 0a20 2020 2020 2020 2023 206f 7220  it.        # or 
+000025e0: 646f 776e 6c6f 6164 2061 6e64 2075 6e7a  download and unz
+000025f0: 6970 2068 7474 7073 3a2f 2f67 6974 6875  ip https://githu
+00002600: 622e 636f 6d2f 4175 746f 5669 4d4c 2f41  b.com/AutoViML/A
+00002610: 7574 6f5f 5669 4d4c 2f61 7263 6869 7665  uto_ViML/archive
+00002620: 2f6d 6173 7465 722e 7a69 700a 2020 2020  /master.zip.    
+00002630: 2020 2020 636f 6e64 6120 6372 6561 7465      conda create
+00002640: 202d 6e20 3c79 6f75 725f 656e 765f 6e61   -n <your_env_na
+00002650: 6d65 3e20 7079 7468 6f6e 3d33 2e37 2061  me> python=3.7 a
+00002660: 6e61 636f 6e64 610a 2020 2020 2020 2020  naconda.        
+00002670: 636f 6e64 6120 6163 7469 7661 7465 203c  conda activate <
+00002680: 796f 7572 5f65 6e76 5f6e 616d 653e 2023  your_env_name> #
+00002690: 204f 4e20 5749 4e44 4f57 533a 2060 736f   ON WINDOWS: `so
+000026a0: 7572 6365 2061 6374 6976 6174 6520 3c79  urce activate <y
+000026b0: 6f75 725f 656e 765f 6e61 6d65 3e60 0a20  our_env_name>`. 
+000026c0: 2020 2020 2020 2063 6420 4175 746f 5f56         cd Auto_V
+000026d0: 694d 4c0a 2020 2020 2020 2020 7069 7020  iML.        pip 
+000026e0: 696e 7374 616c 6c20 2d72 2072 6571 7569  install -r requi
+000026f0: 7265 6d65 6e74 732e 7478 740a 2020 2020  rements.txt.    
+00002700: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+00002710: 0a20 2020 2020 2020 2023 2320 5573 6167  .        ## Usag
+00002720: 650a 2020 2020 2020 2020 0a20 2020 2020  e.        .     
+00002730: 2020 2049 6e20 7468 6520 7361 6d65 2064     In the same d
+00002740: 6972 6563 746f 7279 2c20 6f70 656e 2061  irectory, open a
+00002750: 204a 7570 7974 6572 204e 6f74 6562 6f6f   Jupyter Noteboo
+00002760: 6b20 616e 6420 7573 6520 7468 6973 206c  k and use this l
+00002770: 696e 6520 746f 2069 6d70 6f72 7420 7468  ine to import th
+00002780: 6520 2e70 7920 6669 6c65 3a0a 2020 2020  e .py file:.    
+00002790: 2020 2020 0a20 2020 2020 2020 2060 6060      .        ```
+000027a0: 0a20 2020 2020 2020 2066 726f 6d20 6175  .        from au
+000027b0: 746f 7669 6d6c 2e41 7574 6f5f 5669 4d4c  toviml.Auto_ViML
+000027c0: 2069 6d70 6f72 7420 4175 746f 5f56 694d   import Auto_ViM
+000027d0: 4c0a 2020 2020 2020 2020 6060 600a 2020  L.        ```.  
+000027e0: 2020 2020 2020 0a20 2020 2020 2020 204c        .        L
+000027f0: 6f61 6420 6120 6461 7461 2073 6574 2028  oad a data set (
+00002800: 616e 7920 4353 5620 6f72 2074 6578 7420  any CSV or text 
+00002810: 6669 6c65 2920 696e 746f 2061 2050 616e  file) into a Pan
+00002820: 6461 7320 6461 7461 6672 616d 6520 616e  das dataframe an
+00002830: 6420 7370 6c69 7420 6974 2069 6e74 6f20  d split it into 
+00002840: 5472 6169 6e20 616e 6420 5465 7374 2064  Train and Test d
+00002850: 6174 6166 7261 6d65 732e 2049 6620 796f  ataframes. If yo
+00002860: 7520 646f 6e27 7420 6861 7665 2061 2074  u don't have a t
+00002870: 6573 7420 6461 7461 6672 616d 652c 2079  est dataframe, y
+00002880: 6f75 2063 616e 2073 696d 706c 6520 6173  ou can simple as
+00002890: 7369 676e 2074 6865 2074 6573 7420 7661  sign the test va
+000028a0: 7269 6162 6c65 2062 656c 6f77 2074 6f20  riable below to 
+000028b0: 2727 2028 656d 7074 7920 7374 7269 6e67  '' (empty string
+000028c0: 293a 0a20 2020 2020 2020 200a 2020 2020  ):.        .    
+000028d0: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+000028e0: 6d6f 6465 6c2c 2066 6561 7475 7265 732c  model, features,
+000028f0: 2074 7261 696e 6d2c 2074 6573 746d 203d   trainm, testm =
+00002900: 2041 7574 6f5f 5669 4d4c 280a 2020 2020   Auto_ViML(.    
+00002910: 2020 2020 2020 2020 7472 6169 6e2c 0a20          train,. 
+00002920: 2020 2020 2020 2020 2020 2074 6172 6765             targe
+00002930: 742c 0a20 2020 2020 2020 2020 2020 2074  t,.            t
+00002940: 6573 742c 0a20 2020 2020 2020 2020 2020  est,.           
+00002950: 2073 616d 706c 655f 7375 626d 6973 7369   sample_submissi
+00002960: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00002970: 6879 7065 725f 7061 7261 6d3d 2247 5322  hyper_param="GS"
+00002980: 2c0a 2020 2020 2020 2020 2020 2020 6665  ,.            fe
+00002990: 6174 7572 655f 7265 6475 6374 696f 6e3d  ature_reduction=
+000029a0: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+000029b0: 2020 7363 6f72 696e 675f 7061 7261 6d65    scoring_parame
+000029c0: 7465 723d 2277 6569 6768 7465 642d 6631  ter="weighted-f1
+000029d0: 222c 0a20 2020 2020 2020 2020 2020 204b  ",.            K
+000029e0: 4d65 616e 735f 4665 6174 7572 697a 6572  Means_Featurizer
+000029f0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00002a00: 2020 2020 426f 6f73 7469 6e67 5f46 6c61      Boosting_Fla
+00002a10: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
+00002a20: 2020 2020 2042 696e 6e69 6e67 5f46 6c61       Binning_Fla
+00002a30: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
+00002a40: 2020 2020 2041 6464 5f50 6f6c 793d 4661       Add_Poly=Fa
+00002a50: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00002a60: 2053 7461 636b 696e 675f 466c 6167 3d46   Stacking_Flag=F
+00002a70: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+00002a80: 2020 496d 6261 6c61 6e63 6564 5f46 6c61    Imbalanced_Fla
+00002a90: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
+00002aa0: 2020 2020 2076 6572 626f 7365 3d30 2c0a       verbose=0,.
+00002ab0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00002ac0: 2020 6060 600a 2020 2020 2020 2020 0a20    ```.        . 
+00002ad0: 2020 2020 2020 2046 696e 616c 6c79 2c20         Finally, 
+00002ae0: 6974 2077 7269 7465 7320 796f 7572 2073  it writes your s
+00002af0: 7562 6d69 7373 696f 6e20 6669 6c65 2074  ubmission file t
+00002b00: 6f20 6469 736b 2069 6e20 7468 6520 6375  o disk in the cu
+00002b10: 7272 656e 7420 6469 7265 6374 6f72 7920  rrent directory 
+00002b20: 6361 6c6c 6564 2060 6d79 7375 626d 6973  called `mysubmis
+00002b30: 7369 6f6e 2e63 7376 602e 0a20 2020 2020  sion.csv`..     
+00002b40: 2020 2054 6869 7320 7375 626d 6973 7369     This submissi
+00002b50: 6f6e 2066 696c 6520 6973 2072 6561 6479  on file is ready
+00002b60: 2066 6f72 2079 6f75 2074 6f20 7368 6f77   for you to show
+00002b70: 2069 7420 636c 6965 6e74 7320 6f72 2073   it clients or s
+00002b80: 7562 6d69 7420 6974 2074 6f20 636f 6d70  ubmit it to comp
+00002b90: 6574 6974 696f 6e73 2e0a 2020 2020 2020  etitions..      
+00002ba0: 2020 4966 206e 6f20 7375 626d 6973 7369    If no submissi
+00002bb0: 6f6e 2066 696c 6520 7761 7320 6769 7665  on file was give
+00002bc0: 6e2c 2062 7574 2061 7320 6c6f 6e67 2061  n, but as long a
+00002bd0: 7320 796f 7520 6769 7665 2069 7420 6120  s you give it a 
+00002be0: 7465 7374 2066 696c 6520 6e61 6d65 2c20  test file name, 
+00002bf0: 6974 2077 696c 6c20 6372 6561 7465 2061  it will create a
+00002c00: 2073 7562 6d69 7373 696f 6e20 6669 6c65   submission file
+00002c10: 2066 6f72 2079 6f75 206e 616d 6564 2060   for you named `
+00002c20: 6d79 5375 626d 6973 7369 6f6e 2e63 7376  mySubmission.csv
+00002c30: 602e 0a20 2020 2020 2020 2041 7574 6f5f  `..        Auto_
+00002c40: 5669 4d4c 2077 6f72 6b73 206f 6e20 616e  ViML works on an
+00002c50: 7920 4d75 6c74 692d 436c 6173 732c 204d  y Multi-Class, M
+00002c60: 756c 7469 2d4c 6162 656c 2044 6174 6120  ulti-Label Data 
+00002c70: 5365 742e 2053 6f20 796f 7520 6361 6e20  Set. So you can 
+00002c80: 6861 7665 206d 616e 7920 7461 7267 6574  have many target
+00002c90: 206c 6162 656c 732e 0a20 2020 2020 2020   labels..       
+00002ca0: 2059 6f75 2064 6f6e 2774 2068 6176 6520   You don't have 
+00002cb0: 746f 2074 656c 6c20 4175 746f 5f56 694d  to tell Auto_ViM
+00002cc0: 4c20 7768 6574 6865 7220 6974 2069 7320  L whether it is 
+00002cd0: 6120 5265 6772 6573 7369 6f6e 206f 7220  a Regression or 
+00002ce0: 436c 6173 7369 6669 6361 7469 6f6e 2070  Classification p
+00002cf0: 726f 626c 656d 2e0a 2020 2020 2020 2020  roblem..        
+00002d00: 0a20 2020 2020 2020 2023 2320 5469 7073  .        ## Tips
+00002d10: 2066 6f72 2075 7369 6e67 2041 7574 6f5f   for using Auto_
+00002d20: 5669 4d4c 3a0a 2020 2020 2020 2020 312e  ViML:.        1.
+00002d30: 2060 7363 6f72 696e 675f 7061 7261 6d65   `scoring_parame
+00002d40: 7465 7260 3a20 466f 7220 436c 6173 7369  ter`: For Classi
+00002d50: 6669 6361 7469 6f6e 2070 726f 626c 656d  fication problem
+00002d60: 7320 616e 6420 696d 6261 6c61 6e63 6564  s and imbalanced
+00002d70: 2063 6c61 7373 6573 2c20 6368 6f6f 7365   classes, choose
+00002d80: 2073 636f 7269 6e67 5f70 6172 616d 6574   scoring_paramet
+00002d90: 6572 3d22 6261 6c61 6e63 6564 5f61 6363  er="balanced_acc
+00002da0: 7572 6163 7922 2e20 4974 2077 6f72 6b73  uracy". It works
+00002db0: 2062 6574 7465 722e 0a20 2020 2020 2020   better..       
+00002dc0: 2032 2e20 6049 6d62 616c 616e 6365 645f   2. `Imbalanced_
+00002dd0: 466c 6167 603a 2046 6f72 2049 6d62 616c  Flag`: For Imbal
+00002de0: 616e 6365 6420 436c 6173 7365 7320 283c  anced Classes (<
+00002df0: 3525 2073 616d 706c 6573 2069 6e20 7261  5% samples in ra
+00002e00: 7265 2063 6c61 7373 292c 2063 686f 6f73  re class), choos
+00002e10: 6520 2249 6d62 616c 616e 6365 645f 466c  e "Imbalanced_Fl
+00002e20: 6167 223d 5472 7565 2e20 596f 7520 6361  ag"=True. You ca
+00002e30: 6e20 616c 736f 2073 6574 2074 6869 7320  n also set this 
+00002e40: 666c 6167 2074 6f20 5472 7565 2066 6f72  flag to True for
+00002e50: 2052 6567 7265 7373 696f 6e20 7072 6f62   Regression prob
+00002e60: 6c65 6d73 2077 6865 7265 2074 6865 2074  lems where the t
+00002e70: 6172 6765 7420 7661 7269 6162 6c65 206d  arget variable m
+00002e80: 6967 6874 2068 6176 6520 736b 6577 6564  ight have skewed
+00002e90: 2064 6973 7472 6962 7574 696f 6e73 2e0a   distributions..
+00002ea0: 2020 2020 2020 2020 332e 2060 7461 7267          3. `targ
+00002eb0: 6574 603a 2046 6f72 204d 756c 7469 2d4c  et`: For Multi-L
+00002ec0: 6162 656c 2064 6174 6173 6574 2c20 7468  abel dataset, th
+00002ed0: 6520 7461 7267 6574 2069 6e70 7574 2074  e target input t
+00002ee0: 6172 6765 7420 7661 7269 6162 6c65 2063  arget variable c
+00002ef0: 616e 2062 6520 7365 6e74 2069 6e20 6173  an be sent in as
+00002f00: 2061 206c 6973 7420 6f66 2076 6172 6961   a list of varia
+00002f10: 626c 6573 2e0a 2020 2020 2020 2020 342e  bles..        4.
+00002f20: 2060 426f 6f73 7469 6e67 5f46 6c61 6760   `Boosting_Flag`
+00002f30: 3a20 4974 2069 7320 7265 636f 6d6d 656e  : It is recommen
+00002f40: 6465 6420 7468 6174 2079 6f75 2066 6972  ded that you fir
+00002f50: 7374 2073 6574 2042 6f6f 7374 696e 675f  st set Boosting_
+00002f60: 466c 6167 3d4e 6f6e 6520 746f 2067 6574  Flag=None to get
+00002f70: 2061 204c 696e 6561 7220 6d6f 6465 6c2e   a Linear model.
+00002f80: 204f 6e63 6520 796f 7520 756e 6465 7273   Once you unders
+00002f90: 7461 6e64 2074 6861 742c 2074 6865 6e20  tand that, then 
+00002fa0: 796f 7520 6361 6e20 7472 7920 746f 2073  you can try to s
+00002fb0: 6574 2042 6f6f 7374 696e 675f 466c 6167  et Boosting_Flag
+00002fc0: 3d46 616c 7365 2074 6f20 6765 7420 6120  =False to get a 
+00002fd0: 5261 6e64 6f6d 2046 6f72 6573 7420 6d6f  Random Forest mo
+00002fe0: 6465 6c2e 2046 696e 616c 6c79 2c20 7472  del. Finally, tr
+00002ff0: 7920 426f 6f73 7469 6e67 5f46 6c61 673d  y Boosting_Flag=
+00003000: 5472 7565 2074 6f20 6765 7420 616e 2058  True to get an X
+00003010: 4742 6f6f 7374 206d 6f64 656c 2e20 5468  GBoost model. Th
+00003020: 6973 2069 7320 7468 6520 6f72 6465 7220  is is the order 
+00003030: 7468 6174 2077 6520 7265 636f 6d6d 656e  that we recommen
+00003040: 6420 696e 206f 7264 6572 2074 6f20 7573  d in order to us
+00003050: 6520 4175 746f 5f56 694d 4c2e 2046 696e  e Auto_ViML. Fin
+00003060: 616c 6c79 2074 7279 2042 6f6f 7374 696e  ally try Boostin
+00003070: 675f 466c 6167 3d22 4361 7442 6f6f 7374  g_Flag="CatBoost
+00003080: 2220 746f 2067 6574 2061 2063 6f6d 706c  " to get a compl
+00003090: 6578 2062 7574 2068 6967 6820 7065 7266  ex but high perf
+000030a0: 6f72 6d69 6e67 206d 6f64 656c 2e0a 2020  orming model..  
+000030b0: 2020 2020 2020 352e 2060 4269 6e6e 696e        5. `Binnin
+000030c0: 675f 466c 6167 603a 2042 696e 6e69 6e67  g_Flag`: Binning
+000030d0: 5f46 6c61 673d 5472 7565 2069 6d70 726f  _Flag=True impro
+000030e0: 7665 7320 6120 4361 7442 6f6f 7374 206d  ves a CatBoost m
+000030f0: 6f64 656c 2073 696e 6365 2069 7420 6164  odel since it ad
+00003100: 6473 2074 6f20 7468 6520 6c69 7374 206f  ds to the list o
+00003110: 6620 6361 7465 676f 7269 6361 6c20 7661  f categorical va
+00003120: 7273 2069 6e20 6461 7461 0a20 2020 2020  rs in data.     
+00003130: 2020 2036 2e20 604b 4d65 616e 735f 6665     6. `KMeans_fe
+00003140: 6174 7572 697a 6572 603a 204b 4d65 616e  aturizer`: KMean
+00003150: 735f 6665 6174 7572 697a 6572 3d54 7275  s_featurizer=Tru
+00003160: 6520 776f 726b 7320 7765 6c6c 2069 6e20  e works well in 
+00003170: 4e4c 5020 616e 6420 4361 7442 6f6f 7374  NLP and CatBoost
+00003180: 206d 6f64 656c 7320 7369 6e63 6520 6974   models since it
+00003190: 2063 7265 6174 6573 2063 6c75 7374 6572   creates cluster
+000031a0: 2076 6172 6961 626c 6573 0a20 2020 2020   variables.     
+000031b0: 2020 2037 2e20 6041 6464 5f50 6f6c 7960     7. `Add_Poly`
+000031c0: 3a20 4164 645f 506f 6c79 3d33 2069 6d70  : Add_Poly=3 imp
+000031d0: 726f 7665 7320 6365 7274 6169 6e20 6d6f  roves certain mo
+000031e0: 6465 6c73 2077 6865 7265 2074 6865 7265  dels where there
+000031f0: 2069 7320 6461 7465 2d74 696d 6520 6f72   is date-time or
+00003200: 2063 6174 6567 6f72 6963 616c 2061 6e64   categorical and
+00003210: 206e 756d 6572 6963 2076 6172 6961 626c   numeric variabl
+00003220: 6573 0a20 2020 2020 2020 2038 2e20 6066  es.        8. `f
+00003230: 6561 7475 7265 5f72 6564 7563 7469 6f6e  eature_reduction
+00003240: 603a 2066 6561 7475 7265 5f72 6564 7563  `: feature_reduc
+00003250: 7469 6f6e 3d54 7275 6520 6973 2074 6865  tion=True is the
+00003260: 2064 6566 6175 6c74 2061 6e64 2077 6f72   default and wor
+00003270: 6b73 2062 6573 742e 2042 7574 2077 6865  ks best. But whe
+00003280: 6e20 796f 7520 6861 7665 203c 3130 2066  n you have <10 f
+00003290: 6561 7475 7265 7320 696e 2064 6174 612c  eatures in data,
+000032a0: 2073 6574 2069 7420 746f 2046 616c 7365   set it to False
+000032b0: 0a20 2020 2020 2020 2039 2e20 6053 7461  .        9. `Sta
+000032c0: 636b 696e 675f 466c 6167 603a 2044 6f20  cking_Flag`: Do 
+000032d0: 6e6f 7420 7365 7420 5374 6163 6b69 6e67  not set Stacking
+000032e0: 5f46 6c61 673d 5472 7565 2077 6974 6820  _Flag=True with 
+000032f0: 4c69 6e65 6172 206d 6f64 656c 7320 7369  Linear models si
+00003300: 6e63 6520 796f 7572 2072 6573 756c 7473  nce your results
+00003310: 206d 6179 206e 6f74 206c 6f6f 6b20 6772   may not look gr
+00003320: 6561 742e 0a20 2020 2020 2020 2031 302e  eat..        10.
+00003330: 2060 5374 6163 6b69 6e67 5f46 6c61 6760   `Stacking_Flag`
+00003340: 3a20 5573 6520 5374 6163 6b69 6e67 5f46  : Use Stacking_F
+00003350: 6c61 673d 5472 7565 206f 6e6c 7920 666f  lag=True only fo
+00003360: 7220 636f 6d70 6c65 7820 6d6f 6465 6c73  r complex models
+00003370: 2061 6e64 2061 7320 6120 6c61 7374 2073   and as a last s
+00003380: 7465 7020 7769 7468 2042 6f6f 7374 696e  tep with Boostin
+00003390: 675f 466c 6167 3d54 7275 6520 6f72 2043  g_Flag=True or C
+000033a0: 6174 426f 6f73 740a 2020 2020 2020 2020  atBoost.        
+000033b0: 3131 2e20 6068 7970 6572 5f70 6172 616d  11. `hyper_param
+000033c0: 603a 204c 6561 7665 2068 7970 6572 5f70  `: Leave hyper_p
+000033d0: 6172 616d 203d 2252 5322 2061 7320 696e  aram ="RS" as in
+000033e0: 7075 7420 7369 6e63 6520 6974 2072 756e  put since it run
+000033f0: 7320 6661 7374 6572 2074 6861 6e20 4772  s faster than Gr
+00003400: 6964 5365 6172 6368 4356 2061 6e64 2067  idSearchCV and g
+00003410: 6976 6573 2062 6574 7465 7220 7265 7375  ives better resu
+00003420: 6c74 7320 756e 6c65 7373 2079 6f75 2068  lts unless you h
+00003430: 6176 6520 6120 736d 616c 6c20 6461 7461  ave a small data
+00003440: 2073 6574 2061 6e64 2063 616e 2061 6666   set and can aff
+00003450: 6f72 6420 746f 2073 7065 6e64 2074 696d  ord to spend tim
+00003460: 6520 6f6e 2068 7970 6572 2074 756e 696e  e on hyper tunin
+00003470: 672e 0a20 2020 2020 2020 2031 322e 2060  g..        12. `
+00003480: 4b4d 6561 6e73 5f46 6561 7475 7269 7a65  KMeans_Featurize
+00003490: 7260 3a20 4b4d 6561 6e73 5f46 6561 7475  r`: KMeans_Featu
+000034a0: 7269 7a65 723d 5472 7565 2064 6f65 7320  rizer=True does 
+000034b0: 6e6f 7420 776f 726b 2077 656c 6c20 666f  not work well fo
+000034c0: 7220 736d 616c 6c20 6461 7461 2073 6574  r small data set
+000034d0: 732e 2055 7365 2069 7420 666f 7220 6461  s. Use it for da
+000034e0: 7461 2073 6574 7320 3e20 3130 2c30 3030  ta sets > 10,000
+000034f0: 2072 6f77 732e 0a20 2020 2020 2020 2031   rows..        1
+00003500: 332e 2060 4669 6e61 6c20 7468 6f75 6768  3. `Final though
+00003510: 7473 603a 2046 696e 616c 6c79 2041 7574  ts`: Finally Aut
+00003520: 6f5f 5669 4d4c 2069 7320 6d65 616e 7420  o_ViML is meant 
+00003530: 746f 2062 6520 6120 6261 7365 6c69 6e65  to be a baseline
+00003540: 206f 7220 6368 616c 6c65 6e67 6572 2073   or challenger s
+00003550: 6f6c 7574 696f 6e20 746f 2079 6f75 7220  olution to your 
+00003560: 6461 7461 2073 6574 2e20 536f 2075 7365  data set. So use
+00003570: 2069 7420 666f 7220 6d61 6b69 6e67 2071   it for making q
+00003580: 7569 636b 206d 6f64 656c 7320 7468 6174  uick models that
+00003590: 2079 6f75 2063 616e 2063 6f6d 7061 7265   you can compare
+000035a0: 2061 6761 696e 7374 206f 7220 696e 2048   against or in H
+000035b0: 6163 6b61 7468 6f6e 732e 2049 7420 6973  ackathons. It is
+000035c0: 206e 6f74 206d 6561 6e74 2066 6f72 2070   not meant for p
+000035d0: 726f 6475 6374 696f 6e21 0a20 2020 2020  roduction!.     
+000035e0: 2020 200a 2020 2020 2020 2020 2323 2041     .        ## A
+000035f0: 5049 0a20 2020 2020 2020 200a 2020 2020  PI.        .    
+00003600: 2020 2020 2a2a 4172 6775 6d65 6e74 732a      **Arguments*
+00003610: 2a0a 2020 2020 2020 2020 0a20 2020 2020  *.        .     
+00003620: 2020 202d 2060 7472 6169 6e60 3a20 636f     - `train`: co
+00003630: 756c 6420 6265 2061 2064 6174 6170 6174  uld be a datapat
+00003640: 682b 6669 6c65 6e61 6d65 206f 7220 6120  h+filename or a 
+00003650: 6461 7461 6672 616d 652e 2049 7420 7769  dataframe. It wi
+00003660: 6c6c 2064 6574 6563 7420 7768 6963 6820  ll detect which 
+00003670: 6973 2077 6869 6368 2061 6e64 206c 6f61  is which and loa
+00003680: 6420 6974 2e0a 2020 2020 2020 2020 2d20  d it..        - 
+00003690: 6074 6573 7460 3a20 636f 756c 6420 6265  `test`: could be
+000036a0: 2061 2064 6174 6170 6174 682b 6669 6c65   a datapath+file
+000036b0: 6e61 6d65 206f 7220 6120 6461 7461 6672  name or a datafr
+000036c0: 616d 652e 2049 6620 796f 7520 646f 6e27  ame. If you don'
+000036d0: 7420 6861 7665 2061 6e79 2c20 6a75 7374  t have any, just
+000036e0: 206c 6561 7665 2069 7420 6173 2022 222e   leave it as "".
+000036f0: 0a20 2020 2020 2020 202d 2060 7375 626d  .        - `subm
+00003700: 6973 7369 6f6e 603a 206d 7573 7420 6265  ission`: must be
+00003710: 2061 2064 6174 6170 6174 682b 6669 6c65   a datapath+file
+00003720: 6e61 6d65 2e20 4966 2079 6f75 2064 6f6e  name. If you don
+00003730: 2774 2068 6176 6520 616e 792c 206a 7573  't have any, jus
+00003740: 7420 6c65 6176 6520 6974 2061 7320 656d  t leave it as em
+00003750: 7074 7920 7374 7269 6e67 2e0a 2020 2020  pty string..    
+00003760: 2020 2020 2d20 6074 6172 6765 7460 3a20      - `target`: 
+00003770: 6e61 6d65 206f 6620 7468 6520 7461 7267  name of the targ
+00003780: 6574 2076 6172 6961 626c 6520 696e 2074  et variable in t
+00003790: 6865 2064 6174 6120 7365 742e 0a20 2020  he data set..   
+000037a0: 2020 2020 202d 2060 7365 7060 3a20 6966       - `sep`: if
+000037b0: 2079 6f75 2068 6176 6520 6120 7370 6561   you have a spea
+000037c0: 7261 746f 7220 696e 2074 6865 2066 696c  rator in the fil
+000037d0: 6520 7375 6368 2061 7320 222c 2220 6f72  e such as "," or
+000037e0: 2022 5c74 2220 6d65 6e74 696f 6e20 6974   "\t" mention it
+000037f0: 2068 6572 652e 2044 6566 6175 6c74 2069   here. Default i
+00003800: 7320 222c 222e 0a20 2020 2020 2020 202d  s ","..        -
+00003810: 2060 7363 6f72 696e 675f 7061 7261 6d65   `scoring_parame
+00003820: 7465 7260 3a20 6966 2079 6f75 2077 616e  ter`: if you wan
+00003830: 7420 796f 7572 206f 776e 2073 636f 7269  t your own scori
+00003840: 6e67 2070 6172 616d 6574 6572 2073 7563  ng parameter suc
+00003850: 6820 6173 2022 6631 2220 6769 7665 2069  h as "f1" give i
+00003860: 7420 6865 7265 2e20 4966 206e 6f74 2c20  t here. If not, 
+00003870: 6974 2077 696c 6c20 6173 7375 6d65 2074  it will assume t
+00003880: 6865 2061 7070 726f 7072 6961 7465 2073  he appropriate s
+00003890: 636f 7269 6e67 2070 6172 616d 2066 6f72  coring param for
+000038a0: 2074 6865 2070 726f 626c 656d 2061 6e64   the problem and
+000038b0: 2069 7420 7769 6c6c 2062 7569 6c64 2074   it will build t
+000038c0: 6865 206d 6f64 656c 2e0a 2020 2020 2020  he model..      
+000038d0: 2020 2d20 6068 7970 6572 5f70 6172 616d    - `hyper_param
+000038e0: 603a 2054 756e 696e 6720 6f70 7469 6f6e  `: Tuning option
+000038f0: 7320 6172 6520 4772 6964 5365 6172 6368  s are GridSearch
+00003900: 2028 2747 5327 2920 616e 6420 5261 6e64   ('GS') and Rand
+00003910: 6f6d 697a 6564 5365 6172 6368 2028 2752  omizedSearch ('R
+00003920: 5327 292e 2044 6566 6175 6c74 2069 7320  S'). Default is 
+00003930: 2752 5327 2e0a 2020 2020 2020 2020 2d20  'RS'..        - 
+00003940: 6066 6561 7475 7265 5f72 6564 7563 7469  `feature_reducti
+00003950: 6f6e 603a 2044 6566 6175 6c74 203d 2027  on`: Default = '
+00003960: 5472 7565 2720 6275 7420 6974 2063 616e  True' but it can
+00003970: 2062 6520 7365 7420 746f 2046 616c 7365   be set to False
+00003980: 2069 6620 796f 7520 646f 6e27 7420 7761   if you don't wa
+00003990: 6e74 2061 7574 6f6d 6174 6963 2066 6561  nt automatic fea
+000039a0: 7475 7265 5f72 6564 7563 7469 6f6e 2073  ture_reduction s
+000039b0: 696e 6365 2069 6e20 496d 6167 6520 6461  ince in Image da
+000039c0: 7461 2073 6574 7320 6c69 6b65 2064 6967  ta sets like dig
+000039d0: 6974 7320 616e 6420 4d4e 4953 542c 2079  its and MNIST, y
+000039e0: 6f75 2067 6574 2062 6574 7465 7220 7265  ou get better re
+000039f0: 7375 6c74 7320 7768 656e 2079 6f75 2064  sults when you d
+00003a00: 6f6e 2774 2072 6564 7563 6520 6665 6174  on't reduce feat
+00003a10: 7572 6573 2061 7574 6f6d 6174 6963 616c  ures automatical
+00003a20: 6c79 2e20 596f 7520 6361 6e20 616c 7761  ly. You can alwa
+00003a30: 7973 2074 7279 2062 6f74 6820 616e 6420  ys try both and 
+00003a40: 7365 652e 0a20 2020 2020 2020 202d 2060  see..        - `
+00003a50: 4b4d 6561 6e73 5f46 6561 7475 7269 7a65  KMeans_Featurize
+00003a60: 7260 0a20 2020 2020 2020 2020 202d 2060  r`.          - `
+00003a70: 5472 7565 603a 2041 6464 7320 6120 636c  True`: Adds a cl
+00003a80: 7573 7465 7220 6c61 6265 6c20 746f 2066  uster label to f
+00003a90: 6561 7475 7265 7320 6261 7365 6420 6f6e  eatures based on
+00003aa0: 204b 4d65 616e 732e 2055 7365 2066 6f72   KMeans. Use for
+00003ab0: 204c 696e 6561 722e 0a20 2020 2020 2020   Linear..       
+00003ac0: 2020 202d 2060 4661 6c73 6520 2864 6566     - `False (def
+00003ad0: 6175 6c74 2960 2046 6f72 2052 616e 646f  ault)` For Rando
+00003ae0: 6d20 466f 7265 7374 7320 6f72 2058 4742  m Forests or XGB
+00003af0: 206d 6f64 656c 732c 206c 6561 7665 2069   models, leave i
+00003b00: 7420 4661 6c73 6520 7369 6e63 6520 6974  t False since it
+00003b10: 206d 6179 206f 7665 7266 6974 2e0a 2020   may overfit..  
+00003b20: 2020 2020 2020 2d20 6042 6f6f 7374 696e        - `Boostin
+00003b30: 6720 466c 6167 603a 2079 6f75 2068 6176  g Flag`: you hav
+00003b40: 6520 3420 706f 7373 6962 6c65 2063 686f  e 4 possible cho
+00003b50: 6963 6573 2028 6465 6661 756c 7420 6973  ices (default is
+00003b60: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
+00003b70: 2020 202d 2060 4e6f 6e65 6020 5468 6973     - `None` This
+00003b80: 2077 696c 6c20 6275 696c 6420 6120 4c69   will build a Li
+00003b90: 6e65 6172 204d 6f64 656c 0a20 2020 2020  near Model.     
+00003ba0: 2020 2020 202d 2060 4661 6c73 6560 2054       - `False` T
+00003bb0: 6869 7320 7769 6c6c 2062 7569 6c64 2061  his will build a
+00003bc0: 2052 616e 646f 6d20 466f 7265 7374 206f   Random Forest o
+00003bd0: 7220 4578 7472 6120 5472 6565 7320 6d6f  r Extra Trees mo
+00003be0: 6465 6c20 2861 6c73 6f20 6b6e 6f77 6e20  del (also known 
+00003bf0: 6173 2042 6167 6769 6e67 290a 2020 2020  as Bagging).    
+00003c00: 2020 2020 2020 2d20 6054 7275 6560 2054        - `True` T
+00003c10: 6869 7320 7769 6c6c 2062 7569 6c64 2061  his will build a
+00003c20: 6e20 5847 426f 6f73 7420 6d6f 6465 6c0a  n XGBoost model.
+00003c30: 2020 2020 2020 2020 2020 2d20 6043 6174            - `Cat
+00003c40: 426f 6f73 7460 2054 6869 7320 7769 6c6c  Boost` This will
+00003c50: 2062 7569 6c64 2061 2043 6174 426f 6f73   build a CatBoos
+00003c60: 7420 6d6f 6465 6c20 2870 726f 7669 6465  t model (provide
+00003c70: 6420 796f 7520 6861 7665 2043 6174 426f  d you have CatBo
+00003c80: 6f73 7420 696e 7374 616c 6c65 6429 0a20  ost installed). 
+00003c90: 2020 2020 2020 202d 2060 4164 645f 506f         - `Add_Po
+00003ca0: 6c79 603a 2044 6566 6175 6c74 2069 7320  ly`: Default is 
+00003cb0: 3020 7768 6963 6820 6d65 616e 7320 646f  0 which means do
+00003cc0: 2d6e 6f74 6869 6e67 2e20 4275 7420 6974  -nothing. But it
+00003cd0: 2068 6173 2074 6872 6565 2069 6e74 6572   has three inter
+00003ce0: 6573 7469 6e67 2073 6574 7469 6e67 733a  esting settings:
+00003cf0: 0a20 2020 2020 2020 2020 202d 2060 3160  .          - `1`
+00003d00: 2041 6464 2069 6e74 6572 6163 7469 6f6e   Add interaction
+00003d10: 2076 6172 6961 626c 6573 206f 6e6c 7920   variables only 
+00003d20: 7375 6368 2061 7320 7831 2a78 322c 2078  such as x1*x2, x
+00003d30: 322a 7833 2c2e 2e2e 7839 5c2a 3130 2065  2*x3,...x9\*10 e
+00003d40: 7463 2e0a 2020 2020 2020 2020 2020 2d20  tc..          - 
+00003d50: 6032 6020 4164 6420 496e 7465 7261 6374  `2` Add Interact
+00003d60: 696f 6e73 2061 6e64 2053 7175 6172 6564  ions and Squared
+00003d70: 2076 6172 6961 626c 6573 2073 7563 6820   variables such 
+00003d80: 6173 2078 312a 2a32 2c20 7832 2a2a 322c  as x1**2, x2**2,
+00003d90: 2065 7463 2e0a 2020 2020 2020 2020 2020   etc..          
+00003da0: 2d20 6033 6020 4164 6473 2062 6f74 6820  - `3` Adds both 
+00003db0: 496e 7465 7261 6374 696f 6e73 2061 6e64  Interactions and
+00003dc0: 2053 7175 6172 6564 2076 6172 6961 626c   Squared variabl
+00003dd0: 6573 2073 7563 6820 6173 2078 312a 7832  es such as x1*x2
+00003de0: 2c20 7831 2a2a 322c 7832 2a78 332c 2078  , x1**2,x2*x3, x
+00003df0: 322a 2a32 2c20 6574 632e 0a20 2020 2020  2**2, etc..     
+00003e00: 2020 202d 2060 5374 6163 6b69 6e67 5f46     - `Stacking_F
+00003e10: 6c61 6760 3a20 4465 6661 756c 7420 6973  lag`: Default is
+00003e20: 2046 616c 7365 2e20 4966 2073 6574 2074   False. If set t
+00003e30: 6f20 5472 7565 2c20 6974 2077 696c 6c20  o True, it will 
+00003e40: 6164 6420 616e 2061 6464 6974 696f 6e61  add an additiona
+00003e50: 6c20 6665 6174 7572 6520 7768 6963 6820  l feature which 
+00003e60: 6973 2064 6572 6976 6564 2066 726f 6d20  is derived from 
+00003e70: 7072 6564 6963 7469 6f6e 7320 6f66 2061  predictions of a
+00003e80: 6e6f 7468 6572 206d 6f64 656c 2e20 5468  nother model. Th
+00003e90: 6973 2069 7320 7573 6564 2069 6e20 736f  is is used in so
+00003ea0: 6d65 2063 6173 6573 2062 7574 206d 6179  me cases but may
+00003eb0: 2072 6573 756c 7420 696e 206f 7665 7266   result in overf
+00003ec0: 6974 7469 6e67 2e20 536f 2062 6520 6361  itting. So be ca
+00003ed0: 7265 6675 6c20 7475 726e 696e 6720 7468  reful turning th
+00003ee0: 6973 2066 6c61 6720 226f 6e22 2e0a 2020  is flag "on"..  
+00003ef0: 2020 2020 2020 2d20 6042 696e 6e69 6e67        - `Binning
+00003f00: 5f46 6c61 6760 3a20 4465 6661 756c 7420  _Flag`: Default 
+00003f10: 6973 2046 616c 7365 2e20 4974 2073 6574  is False. It set
+00003f20: 2074 6f20 5472 7565 2c20 6974 2077 696c   to True, it wil
+00003f30: 6c20 636f 6e76 6572 7420 7468 6520 746f  l convert the to
+00003f40: 7020 6e75 6d65 7269 6320 7661 7269 6162  p numeric variab
+00003f50: 6c65 7320 696e 746f 2062 696e 6e65 6420  les into binned 
+00003f60: 7661 7269 6162 6c65 7320 7468 726f 7567  variables throug
+00003f70: 6820 6120 7465 6368 6e69 7175 6520 6b6e  h a technique kn
+00003f80: 6f77 6e20 6173 2022 456e 7472 6f70 7922  own as "Entropy"
+00003f90: 2062 696e 6e69 6e67 2e20 5468 6973 2069   binning. This i
+00003fa0: 7320 7665 7279 2068 656c 7066 756c 2066  s very helpful f
+00003fb0: 6f72 2063 6572 7461 696e 2064 6174 6173  or certain datas
+00003fc0: 6574 7320 2865 7370 6563 6961 6c6c 7920  ets (especially 
+00003fd0: 6861 7264 2074 6f20 6275 696c 6420 6d6f  hard to build mo
+00003fe0: 6465 6c73 292e 0a20 2020 2020 2020 202d  dels)..        -
+00003ff0: 2060 496d 6261 6c61 6e63 6564 5f46 6c61   `Imbalanced_Fla
+00004000: 6760 3a20 4465 6661 756c 7420 6973 2046  g`: Default is F
+00004010: 616c 7365 2e20 5573 6573 2069 6d62 616c  alse. Uses imbal
+00004020: 616e 6365 645f 656e 7365 6d62 6c65 206c  anced_ensemble l
+00004030: 6962 7261 7279 2066 6f72 2069 6d62 616c  ibrary for imbal
+00004040: 616e 6365 6420 6461 7461 2e20 4a75 7374  anced data. Just
+00004050: 2073 6574 2049 6d62 616c 616e 6365 645f   set Imbalanced_
+00004060: 466c 6167 203d 2054 7275 6520 696e 2061  Flag = True in a
+00004070: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
+00004080: 202d 2060 7665 7262 6f73 6560 3a20 5468   - `verbose`: Th
+00004090: 6973 2068 6173 2033 2070 6f73 7369 626c  is has 3 possibl
+000040a0: 6520 7374 6174 6573 3a0a 2020 2020 2020  e states:.      
+000040b0: 2020 2020 2d20 6030 6020 6c69 6d69 7465      - `0` limite
+000040c0: 6420 6f75 7470 7574 2e20 4772 6561 7420  d output. Great 
+000040d0: 666f 7220 7275 6e6e 696e 6720 7468 6973  for running this
+000040e0: 2073 696c 656e 746c 7920 616e 6420 6765   silently and ge
+000040f0: 7474 696e 6720 6661 7374 2072 6573 756c  tting fast resul
+00004100: 7473 2e0a 2020 2020 2020 2020 2020 2d20  ts..          - 
+00004110: 6031 6020 6d6f 7265 2063 6861 7274 732e  `1` more charts.
+00004120: 2047 7265 6174 2066 6f72 206b 6e6f 7769   Great for knowi
+00004130: 6e67 2068 6f77 2072 6573 756c 7473 2077  ng how results w
+00004140: 6572 6520 616e 6420 6d61 6b69 6e67 2063  ere and making c
+00004150: 6861 6e67 6573 2074 6f20 666c 6167 7320  hanges to flags 
+00004160: 696e 2069 6e70 7574 2e0a 2020 2020 2020  in input..      
+00004170: 2020 2020 2d20 6032 6020 6c6f 7473 206f      - `2` lots o
+00004180: 6620 6368 6172 7473 2061 6e64 206f 7574  f charts and out
+00004190: 7075 742e 2047 7265 6174 2066 6f72 2072  put. Great for r
+000041a0: 6570 726f 6475 6369 6e67 2077 6861 7420  eproducing what 
+000041b0: 4175 746f 5f56 694d 4c20 646f 6573 206f  Auto_ViML does o
+000041c0: 6e20 796f 7572 206f 776e 2e0a 2020 2020  n your own..    
+000041d0: 2020 2020 0a20 2020 2020 2020 202a 2a52      .        **R
+000041e0: 6574 7572 6e20 7661 6c75 6573 2a2a 0a20  eturn values**. 
+000041f0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00004200: 2d20 606d 6f64 656c 603a 2049 7420 7769  - `model`: It wi
+00004210: 6c6c 2072 6574 7572 6e20 796f 7572 2074  ll return your t
+00004220: 7261 696e 6564 206d 6f64 656c 0a20 2020  rained model.   
+00004230: 2020 2020 202d 2060 6665 6174 7572 6573       - `features
+00004240: 603a 2074 6865 2066 6577 6573 7420 6e75  `: the fewest nu
+00004250: 6d62 6572 206f 6620 6665 6174 7572 6573  mber of features
+00004260: 2069 6e20 796f 7572 206d 6f64 656c 2074   in your model t
+00004270: 6f20 6d61 6b65 2069 7420 7065 7266 6f72  o make it perfor
+00004280: 6d20 7765 6c6c 0a20 2020 2020 2020 202d  m well.        -
+00004290: 2060 7472 6169 6e5f 6d6f 6469 6669 6564   `train_modified
+000042a0: 603a 2074 6869 7320 6973 2074 6865 206d  `: this is the m
+000042b0: 6f64 6966 6965 6420 7472 6169 6e20 6461  odified train da
+000042c0: 7461 6672 616d 6520 6166 7465 7220 7265  taframe after re
+000042d0: 6d6f 7669 6e67 2061 6e64 2061 6464 696e  moving and addin
+000042e0: 6720 6665 6174 7572 6573 0a20 2020 2020  g features.     
+000042f0: 2020 202d 2060 7465 7374 5f6d 6f64 6966     - `test_modif
+00004300: 6965 6460 3a20 7468 6973 2069 7320 7468  ied`: this is th
+00004310: 6520 6d6f 6469 6669 6564 2074 6573 7420  e modified test 
+00004320: 6461 7461 6672 616d 6520 7769 7468 2074  dataframe with t
+00004330: 6865 2073 616d 6520 7472 616e 7366 6f72  he same transfor
+00004340: 6d61 7469 6f6e 7320 6173 2074 7261 696e  mations as train
+00004350: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00004360: 2020 2323 204d 6169 6e74 6169 6e65 7273    ## Maintainers
+00004370: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00004380: 2020 2a20 5b40 4175 746f 5669 4d4c 5d28    * [@AutoViML](
+00004390: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+000043a0: 6f6d 2f41 7574 6f56 694d 4c29 0a20 2020  om/AutoViML).   
+000043b0: 2020 2020 202a 205b 406d 6f72 656e 6f68       * [@morenoh
+000043c0: 3134 395d 2868 7474 7073 3a2f 2f67 6974  149](https://git
+000043d0: 6875 622e 636f 6d2f 6d6f 7265 6e6f 6831  hub.com/morenoh1
+000043e0: 3439 290a 2020 2020 2020 2020 2a20 5b40  49).        * [@
+000043f0: 6869 726f 6e72 6f79 5d28 6874 7470 733a  hironroy](https:
+00004400: 2f2f 6769 7468 7562 2e63 6f6d 2f68 6972  //github.com/hir
+00004410: 6f6e 726f 7929 0a20 2020 2020 2020 200a  onroy).        .
+00004420: 2020 2020 2020 2020 2323 2043 6f6e 7472          ## Contr
+00004430: 6962 7574 696e 670a 2020 2020 2020 2020  ibuting.        
+00004440: 0a20 2020 2020 2020 2053 6565 205b 7468  .        See [th
+00004450: 6520 636f 6e74 7269 6275 7469 6e67 2066  e contributing f
+00004460: 696c 655d 2843 4f4e 5452 4942 5554 494e  ile](CONTRIBUTIN
+00004470: 472e 6d64 2921 0a20 2020 2020 2020 200a  G.md)!.        .
+00004480: 2020 2020 2020 2020 5052 7320 6163 6365          PRs acce
+00004490: 7074 6564 2e0a 2020 2020 2020 2020 0a20  pted..        . 
+000044a0: 2020 2020 2020 2023 2320 4c69 6365 6e73         ## Licens
+000044b0: 650a 2020 2020 2020 2020 0a20 2020 2020  e.        .     
+000044c0: 2020 2041 7061 6368 6520 4c69 6365 6e73     Apache Licens
+000044d0: 6520 322e 3020 c2a9 2032 3032 3020 5261  e 2.0 .. 2020 Ra
+000044e0: 6d20 5365 7368 6164 7269 0a20 2020 2020  m Seshadri.     
+000044f0: 2020 200a 2020 2020 2020 2020 2323 2044     .        ## D
+00004500: 4953 434c 4149 4d45 520a 2020 2020 2020  ISCLAIMER.      
+00004510: 2020 5468 6973 2070 726f 6a65 6374 2069    This project i
+00004520: 7320 6e6f 7420 616e 206f 6666 6963 6961  s not an officia
+00004530: 6c20 476f 6f67 6c65 2070 726f 6a65 6374  l Google project
+00004540: 2e20 4974 2069 7320 6e6f 7420 7375 7070  . It is not supp
+00004550: 6f72 7465 6420 6279 2047 6f6f 676c 6520  orted by Google 
+00004560: 616e 6420 476f 6f67 6c65 2073 7065 6369  and Google speci
+00004570: 6669 6361 6c6c 7920 6469 7363 6c61 696d  fically disclaim
+00004580: 7320 616c 6c20 7761 7272 616e 7469 6573  s all warranties
+00004590: 2061 7320 746f 2069 7473 2071 7561 6c69   as to its quali
+000045a0: 7479 2c20 6d65 7263 6861 6e74 6162 696c  ty, merchantabil
+000045b0: 6974 792c 206f 7220 6669 746e 6573 7320  ity, or fitness 
+000045c0: 666f 7220 6120 7061 7274 6963 756c 6172  for a particular
+000045d0: 2070 7572 706f 7365 2e0a 2020 2020 2020   purpose..      
+000045e0: 2020 0a50 6c61 7466 6f72 6d3a 2055 4e4b    .Platform: UNK
+000045f0: 4e4f 574e 0a43 6c61 7373 6966 6965 723a  NOWN.Classifier:
+00004600: 2050 726f 6772 616d 6d69 6e67 204c 616e   Programming Lan
+00004610: 6775 6167 6520 3a3a 2050 7974 686f 6e20  guage :: Python 
+00004620: 3a3a 2033 0a43 6c61 7373 6966 6965 723a  :: 3.Classifier:
+00004630: 204f 7065 7261 7469 6e67 2053 7973 7465   Operating Syste
+00004640: 6d20 3a3a 204f 5320 496e 6465 7065 6e64  m :: OS Independ
+00004650: 656e 740a 4465 7363 7269 7074 696f 6e2d  ent.Description-
+00004660: 436f 6e74 656e 742d 5479 7065 3a20 7465  Content-Type: te
+00004670: 7874 2f6d 6172 6b64 6f77 6e0a 0000 0000  xt/markdown.....
 00004680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000046a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000046b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000046c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000046d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000046e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1178,16 +1178,16 @@
 00004990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000049a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000049b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000049c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000049d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000049e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000049f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004a00: 3232 206d 7469 6d65 3d31 3637 3832 3830  22 mtime=1678280
-00004a10: 3835 312e 300a 0000 0000 0000 0000 0000  851.0...........
+00004a00: 3232 206d 7469 6d65 3d31 3637 3832 3837  22 mtime=1678287
+00004a10: 3031 302e 300a 0000 0000 0000 0000 0000  010.0...........
 00004a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1210,24 +1210,24 @@
 00004b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00004c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00004c10: 2f52 4541 444d 452e 6d64 0000 0000 0000  /README.md......
 00004c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004c60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00004c70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00004c80: 3030 3331 3535 3400 3030 3030 3030 3030  0031554.00000000
-00004c90: 3030 3000 3031 3434 3032 0020 3000 0000  000.014402. 0...
+00004c80: 3030 3331 3535 3600 3030 3030 3030 3030  0031556.00000000
+00004c90: 3030 3000 3031 3434 3035 0020 3000 0000  000.014405. 0...
 00004ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004d00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -1306,773 +1306,773 @@
 00005190: 6572 2f4c 4943 454e 5345 290d 0a0d 0a41  er/LICENSE)....A
 000051a0: 7574 6f5f 5669 4d4c 2069 7320 7072 6f6e  uto_ViML is pron
 000051b0: 6f75 6e63 6564 2061 7320 2261 7574 6f20  ounced as "auto 
 000051c0: 7669 6d61 6c22 2028 6175 746f 7669 6d61  vimal" (autovima
 000051d0: 6c20 6c6f 676f 2063 7265 6174 6564 2062  l logo created b
 000051e0: 7920 5361 6e6b 6574 2047 6861 6e6d 6172  y Sanket Ghanmar
 000051f0: 6529 2e0d 0a0d 0a23 2320 5570 6461 7465  e).....## Update
-00005200: 2028 4d61 7920 3230 3232 290d 0a3c 6f6c   (May 2022)..<ol
-00005210: 3e0d 0a3c 6c69 3e3c 623e 4175 746f 5f56  >..<li><b>Auto_V
-00005220: 694d 4c20 6861 7320 6120 6e65 7720 666c  iML has a new fl
-00005230: 6167 2074 6f20 7370 6565 6420 7570 2070  ag to speed up p
-00005240: 726f 6365 7373 696e 6720 7573 696e 6720  rocessing using 
-00005250: 4750 5527 733c 2f62 3e2e 204a 7573 7420  GPU's</b>. Just 
-00005260: 7365 7420 7468 6520 6047 5055 5f66 6c61  set the `GPU_fla
-00005270: 6760 3d60 5472 7565 6020 6f6e 2043 6f6c  g`=`True` on Col
-00005280: 6162 2061 6e64 206f 7468 6572 2065 6e76  ab and other env
-00005290: 6972 6f6e 6d65 6e74 732e 2042 7574 2064  ironments. But d
-000052a0: 6f6e 2774 2066 6f72 6765 7420 746f 2073  on't forget to s
-000052b0: 6574 2074 6865 2072 756e 7469 6d65 2074  et the runtime t
-000052c0: 7970 6520 746f 2062 6520 2247 5055 2220  ype to be "GPU" 
-000052d0: 7768 696c 6520 7275 6e6e 696e 6720 6f6e  while running on
-000052e0: 2043 6f6c 6162 2e20 4f74 6865 7277 6973   Colab. Otherwis
-000052f0: 6520 796f 7520 7769 6c6c 2067 6574 2061  e you will get a
-00005300: 6e20 6572 726f 722e 3c2f 6c69 3e0d 0a3c  n error.</li>..<
-00005310: 2f6f 6c3e 0d0a 0d0a 2323 2055 7064 6174  /ol>....## Updat
-00005320: 6520 284d 6179 2032 3032 3229 0d0a 3c6f  e (May 2022)..<o
-00005330: 6c3e 0d0a 3c6c 693e 3c62 3e41 7574 6f5f  l>..<li><b>Auto_
-00005340: 5669 4d4c 2061 7320 6f66 2076 6572 7369  ViML as of versi
-00005350: 6f6e 2030 2e31 2e37 3130 2075 7365 7320  on 0.1.710 uses 
-00005360: 6120 7665 7279 2068 6967 6820 7065 7266  a very high perf
-00005370: 6f72 6d61 6e63 6520 6c69 6272 6172 7920  ormance library 
-00005380: 6361 6c6c 6564 2060 696d 6261 6c61 6e63  called `imbalanc
-00005390: 6564 5f65 6e73 656d 626c 6560 2066 6f72  ed_ensemble` for
-000053a0: 2049 6d62 616c 616e 6365 6420 6461 7461   Imbalanced data
-000053b0: 7365 7420 7072 6f62 6c65 6d73 2e3c 2f62  set problems.</b
-000053c0: 3e20 4974 2077 696c 6c20 7072 6f64 7563  > It will produc
-000053d0: 6520 6120 352d 3130 2520 626f 6f73 7420  e a 5-10% boost 
-000053e0: 696e 2079 6f75 7220 6261 6c61 6e63 6564  in your balanced
-000053f0: 5f61 6363 7572 6163 7920 6261 7365 6420  _accuracy based 
-00005400: 6f6e 206d 7920 6578 7065 7269 656e 6365  on my experience
-00005410: 2077 6974 6820 206d 616e 7920 6461 7461   with  many data
-00005420: 7365 7473 2049 2068 6176 6520 7472 6965  sets I have trie
-00005430: 642e 3c2f 6c69 3e0d 0a3c 6272 3e0d 0a3c  d.</li>..<br>..<
-00005440: 703e 496e 2061 6464 6974 696f 6e2c 206e  p>In addition, n
-00005450: 6577 2066 6561 7475 7265 7320 696e 2074  ew features in t
-00005460: 6869 7320 7665 7273 696f 6e20 6172 653a  his version are:
-00005470: 3c62 723e 0d0a 3c75 6c3e 0d0a 3c6c 693e  <br>..<ul>..<li>
-00005480: 5355 4c4f 5620 2d3e 2055 7365 7320 7468  SULOV -> Uses th
-00005490: 6520 5355 4c4f 5620 616c 676f 7269 7468  e SULOV algorith
-000054a0: 6d20 666f 7220 7265 6d6f 7669 6e67 2068  m for removing h
-000054b0: 6967 686c 7920 636f 7272 656c 6174 6564  ighly correlated
-000054c0: 2066 6561 7475 7265 7320 6175 746f 6d61   features automa
-000054d0: 7469 6361 6c6c 792e 3c2f 6c69 3e0d 0a3c  tically.</li>..<
-000054e0: 6c69 3e41 7574 6f5f 4e4c 5020 2d3e 2041  li>Auto_NLP -> A
-000054f0: 7574 6f56 694d 4c20 6175 746f 6d61 7469  utoViML automati
-00005500: 6361 6c6c 7920 6465 7465 6374 7320 5465  cally detects Te
-00005510: 7874 2076 6172 6961 626c 6573 2061 6e64  xt variables and
-00005520: 2064 6f65 7320 4e4c 5020 7072 6f63 6573   does NLP proces
-00005530: 7369 6e67 2075 7369 6e67 2041 7574 6f5f  sing using Auto_
-00005540: 4e4c 503c 2f6c 693e 0d0a 3c6c 693e 4461  NLP</li>..<li>Da
-00005550: 7465 2054 696d 6520 2d3e 2049 7420 6175  te Time -> It au
-00005560: 746f 6d61 7469 6361 6c6c 7920 6465 7465  tomatically dete
-00005570: 6374 7320 2064 6174 6520 7469 6d65 2076  cts  date time v
-00005580: 6172 6961 626c 6573 2061 6e64 2067 656e  ariables and gen
-00005590: 6572 6174 6573 206e 6577 2066 6561 7475  erates new featu
-000055a0: 7265 733c 2f6c 693e 0d0a 3c6c 693e 6069  res</li>..<li>`i
-000055b0: 6d62 616c 616e 6365 645f 656e 7365 6d62  mbalanced_ensemb
-000055c0: 6c65 6020 6c69 6272 6172 7920 2d3e 2055  le` library -> U
-000055d0: 7365 7320 696d 6261 6c61 6e63 6564 5f65  ses imbalanced_e
-000055e0: 6e73 656d 626c 6520 6c69 6272 6172 7920  nsemble library 
-000055f0: 666f 7220 696d 6261 6c61 6e63 6564 2064  for imbalanced d
-00005600: 6174 612e 204a 7573 7420 7365 7420 496d  ata. Just set Im
-00005610: 6261 6c61 6e63 6564 5f46 6c61 6720 3d20  balanced_Flag = 
-00005620: 5472 7565 2069 6e20 6172 6775 6d65 6e74  True in argument
-00005630: 733c 2f6c 693e 0d0a 3c6c 693e 4665 6174  s</li>..<li>Feat
-00005640: 7572 6520 5365 6c65 6374 696f 6e20 2d3e  ure Selection ->
-00005650: 2057 6520 7573 6520 7468 6520 7361 6d65   We use the same
-00005660: 2061 6c67 6f72 6974 686d 2074 6861 7420   algorithm that 
-00005670: 6665 6174 7572 6577 697a 206c 6962 7261  featurewiz libra
-00005680: 7279 2075 7365 733a 2053 554c 4f56 2061  ry uses: SULOV a
-00005690: 6e64 2052 6563 7572 7369 7665 2058 4742  nd Recursive XGB
-000056a0: 6f6f 7374 2074 6f20 7365 6c65 6374 2062  oost to select b
-000056b0: 6573 7420 6665 6174 7572 6573 2066 6173  est features fas
-000056c0: 742e 2053 6565 2062 656c 6f77 2e3c 2f6c  t. See below.</l
-000056d0: 693e 0d0a 3c2f 756c 3e0d 0a0d 0a23 2320  i>..</ul>....## 
-000056e0: 5461 626c 6520 6f66 2043 6f6e 7465 6e74  Table of Content
-000056f0: 730d 0a3c 756c 3e0d 0a3c 6c69 3e3c 6120  s..<ul>..<li><a 
-00005700: 6872 6566 3d22 2362 6163 6b67 726f 756e  href="#backgroun
-00005710: 6422 3e42 6163 6b67 726f 756e 643c 2f61  d">Background</a
-00005720: 3e3c 2f6c 693e 0d0a 3c6c 693e 3c61 2068  ></li>..<li><a h
-00005730: 7265 663d 2223 696e 7374 616c 6c22 3e49  ref="#install">I
-00005740: 6e73 7461 6c6c 3c2f 613e 3c2f 6c69 3e0d  nstall</a></li>.
-00005750: 0a3c 6c69 3e3c 6120 6872 6566 3d22 2375  .<li><a href="#u
-00005760: 7361 6765 223e 5573 6167 653c 2f61 3e3c  sage">Usage</a><
-00005770: 2f6c 693e 0d0a 3c6c 693e 3c61 2068 7265  /li>..<li><a hre
-00005780: 663d 2223 7469 7073 2d66 6f72 2d75 7369  f="#tips-for-usi
-00005790: 6e67 2d61 7574 6f5f 7669 6d6c 223e 5469  ng-auto_viml">Ti
-000057a0: 7073 2066 6f72 2075 7369 6e67 2041 7574  ps for using Aut
-000057b0: 6f5f 5669 4d4c 3c2f 613e 3c2f 6c69 3e0d  o_ViML</a></li>.
-000057c0: 0a3c 6c69 3e3c 6120 6872 6566 3d22 2361  .<li><a href="#a
-000057d0: 7069 223e 4150 493c 2f61 3e3c 2f6c 693e  pi">API</a></li>
-000057e0: 0d0a 3c6c 693e 3c61 2068 7265 663d 2223  ..<li><a href="#
-000057f0: 6d61 696e 7461 696e 6572 7322 3e4d 6169  maintainers">Mai
-00005800: 6e74 6169 6e65 7273 3c2f 613e 3c2f 6c69  ntainers</a></li
-00005810: 3e0d 0a3c 6c69 3e3c 6120 6872 6566 3d22  >..<li><a href="
-00005820: 2363 6f6e 7472 6962 7574 696e 6722 3e43  #contributing">C
-00005830: 6f6e 7472 6962 7574 696e 673c 2f61 3e3c  ontributing</a><
-00005840: 2f6c 693e 0d0a 3c6c 693e 3c61 2068 7265  /li>..<li><a hre
-00005850: 663d 2223 6c69 6365 6e73 6522 3e4c 6963  f="#license">Lic
-00005860: 656e 7365 3c2f 613e 3c2f 6c69 3e0d 0a3c  ense</a></li>..<
-00005870: 2f75 6c3e 0d0a 0d0a 2323 2042 6163 6b67  /ul>....## Backg
-00005880: 726f 756e 640d 0a3c 703e 5265 6164 2074  round..<p>Read t
-00005890: 6869 7320 3c61 2068 7265 663d 2268 7474  his <a href="htt
-000058a0: 7073 3a2f 2f74 6f77 6172 6473 6461 7461  ps://towardsdata
-000058b0: 7363 6965 6e63 652e 636f 6d2f 7768 792d  science.com/why-
-000058c0: 6175 746f 6d6c 2d69 732d 616e 2d65 7373  automl-is-an-ess
-000058d0: 656e 7469 616c 2d6e 6577 2d74 6f6f 6c2d  ential-new-tool-
-000058e0: 666f 722d 6461 7461 2d73 6369 656e 7469  for-data-scienti
-000058f0: 7374 732d 3264 3961 6234 6532 3565 3436  sts-2d9ab4e25e46
-00005900: 223e 4d65 6469 756d 2061 7274 6963 6c65  ">Medium article
-00005910: 2074 6f20 6c65 6172 6e20 686f 7720 746f   to learn how to
-00005920: 2075 7365 2041 7574 6f5f 5669 4d4c 2065   use Auto_ViML e
-00005930: 6666 6563 7469 7665 6c79 2e3c 2f61 3e0d  ffectively.</a>.
-00005940: 0a0d 0a3c 703e 4175 746f 5f56 694d 4c20  ...<p>Auto_ViML 
-00005950: 7761 7320 6465 7369 676e 6564 2066 6f72  was designed for
-00005960: 2062 7569 6c64 696e 6720 4869 6768 2050   building High P
-00005970: 6572 666f 726d 616e 6365 2049 6e74 6572  erformance Inter
-00005980: 7072 6574 6162 6c65 204d 6f64 656c 7320  pretable Models 
-00005990: 7769 7468 2074 6865 2066 6577 6573 7420  with the fewest 
-000059a0: 7661 7269 6162 6c65 7320 6e65 6564 6564  variables needed
-000059b0: 2e0d 0a54 6865 2022 5622 2069 6e20 4175  ...The "V" in Au
-000059c0: 746f 5f56 694d 4c20 7374 616e 6473 2066  to_ViML stands f
-000059d0: 6f72 2056 6172 6961 6e74 2062 6563 6175  or Variant becau
-000059e0: 7365 2069 7420 7472 6965 7320 6d75 6c74  se it tries mult
-000059f0: 6970 6c65 206d 6f64 656c 7320 7769 7468  iple models with
-00005a00: 206d 756c 7469 706c 6520 6665 6174 7572   multiple featur
-00005a10: 6573 2074 6f20 6669 6e64 2079 6f75 2074  es to find you t
-00005a20: 6865 2062 6573 7420 7065 7266 6f72 6d69  he best performi
-00005a30: 6e67 206d 6f64 656c 2066 6f72 2079 6f75  ng model for you
-00005a40: 7220 6461 7461 7365 742e 2054 6865 2022  r dataset. The "
-00005a50: 6922 2069 6e20 4175 746f 5f56 694d 4c20  i" in Auto_ViML 
-00005a60: 7374 616e 6473 2066 6f72 2022 696e 7465  stands for "inte
-00005a70: 7270 7265 7461 626c 6522 2073 696e 6365  rpretable" since
-00005a80: 2041 7574 6f5f 5669 4d4c 2073 656c 6563   Auto_ViML selec
-00005a90: 7473 2074 6865 206c 6561 7374 206e 756d  ts the least num
-00005aa0: 6265 7220 6f66 2066 6561 7475 7265 7320  ber of features 
-00005ab0: 6e65 6365 7373 6172 7920 746f 2062 7569  necessary to bui
-00005ac0: 6c64 2061 2073 696d 706c 6572 2c20 6d6f  ld a simpler, mo
-00005ad0: 7265 2069 6e74 6572 7072 6574 6162 6c65  re interpretable
-00005ae0: 206d 6f64 656c 2e20 496e 206d 6f73 7420   model. In most 
-00005af0: 6361 7365 732c 2041 7574 6f5f 5669 4d4c  cases, Auto_ViML
-00005b00: 2062 7569 6c64 7320 6d6f 6465 6c73 2077   builds models w
-00005b10: 6974 6820 3230 252d 3939 2520 6665 7765  ith 20%-99% fewe
-00005b20: 7220 6665 6174 7572 6573 2074 6861 6e20  r features than 
-00005b30: 6120 7369 6d69 6c61 7220 7065 7266 6f72  a similar perfor
-00005b40: 6d69 6e67 206d 6f64 656c 2077 6974 6820  ming model with 
-00005b50: 616c 6c20 696e 636c 7564 6564 2066 6561  all included fea
-00005b60: 7475 7265 7320 2874 6869 7320 6973 2062  tures (this is b
-00005b70: 6173 6564 206f 6e20 6d79 2074 7269 616c  ased on my trial
-00005b80: 732e 2059 6f75 7220 6578 7065 7269 656e  s. Your experien
-00005b90: 6365 206d 6179 2076 6172 7929 2e3c 6272  ce may vary).<br
-00005ba0: 3e0d 0a3c 703e 0d0a 4175 746f 5f56 694d  >..<p>..Auto_ViM
-00005bb0: 4c20 6973 2065 7665 7279 2044 6174 6120  L is every Data 
-00005bc0: 5363 6965 6e74 6973 7427 7320 6d6f 6465  Scientist's mode
-00005bd0: 6c20 6163 6365 6c65 7261 746f 7220 746f  l accelerator to
-00005be0: 6f6c 2074 6861 743a 3c6f 6c3e 0d0a 3c6c  ol that:<ol>..<l
-00005bf0: 693e 3c62 3e48 656c 7073 2079 6f75 2077  i><b>Helps you w
-00005c00: 6974 6820 6461 7461 2063 6c65 616e 696e  ith data cleanin
-00005c10: 673c 2f62 3e3a 2079 6f75 2063 616e 2073  g</b>: you can s
-00005c20: 656e 6420 696e 2079 6f75 7220 656e 7469  end in your enti
-00005c30: 7265 2064 6174 6166 7261 6d65 2061 7320  re dataframe as 
-00005c40: 6973 2061 6e64 2041 7574 6f5f 5669 4d4c  is and Auto_ViML
-00005c50: 2077 696c 6c20 7375 6767 6573 7420 6368   will suggest ch
-00005c60: 616e 6765 7320 746f 2068 656c 7020 7769  anges to help wi
-00005c70: 7468 206d 6973 7369 6e67 2076 616c 7565  th missing value
-00005c80: 732c 2066 6f72 6d61 7474 696e 6720 7661  s, formatting va
-00005c90: 7269 6162 6c65 732c 2061 6464 696e 6720  riables, adding 
-00005ca0: 7661 7269 6162 6c65 732c 2065 7463 2e20  variables, etc. 
-00005cb0: 4974 206c 6f76 6573 2064 6972 7479 2064  It loves dirty d
-00005cc0: 6174 612e 2054 6865 2064 6972 7469 6572  ata. The dirtier
-00005cd0: 2074 6865 2062 6574 7465 7221 3c62 723e   the better!<br>
-00005ce0: 0d0a 3c6c 693e 3c62 3e50 6572 666f 726d  ..<li><b>Perform
-00005cf0: 7320 4665 6174 7572 6520 5365 6c65 6374  s Feature Select
-00005d00: 696f 6e3c 2f62 3e3a 2041 7574 6f5f 5669  ion</b>: Auto_Vi
-00005d10: 4d4c 2073 656c 6563 7473 2076 6172 6961  ML selects varia
-00005d20: 626c 6573 2061 7574 6f6d 6174 6963 616c  bles automatical
-00005d30: 6c79 2062 7920 6465 6661 756c 742e 2054  ly by default. T
-00005d40: 6869 7320 6973 2076 6572 7920 6865 6c70  his is very help
-00005d50: 6675 6c20 7768 656e 2079 6f75 2068 6176  ful when you hav
-00005d60: 6520 6875 6e64 7265 6473 2069 6620 6e6f  e hundreds if no
-00005d70: 7420 7468 6f75 7361 6e64 7320 6f66 2076  t thousands of v
-00005d80: 6172 6961 626c 6573 2073 696e 6365 2069  ariables since i
-00005d90: 7420 6361 6e20 7265 6164 696c 7920 6964  t can readily id
-00005da0: 656e 7469 6679 2077 6869 6368 206f 6620  entify which of 
-00005db0: 7468 6f73 6520 6172 6520 696d 706f 7274  those are import
-00005dc0: 616e 7420 7661 7269 6162 6c65 7320 7673  ant variables vs
-00005dd0: 2077 6869 6368 2061 7265 2075 6e6e 6563   which are unnec
-00005de0: 6573 7361 7279 2e20 596f 7520 6361 6e20  essary. You can 
-00005df0: 7475 726e 2074 6869 7320 6f66 6620 6173  turn this off as
-00005e00: 2077 656c 6c20 2873 6565 2041 5049 292e   well (see API).
-00005e10: 3c62 723e 0d0a 0d0a 215b 7867 626f 6f73  <br>....![xgboos
-00005e20: 745d 2873 756c 6f76 5f78 6762 6f6f 7374  t](sulov_xgboost
-00005e30: 2e70 6e67 290d 0a3c 6c69 3e3c 623e 5265  .png)..<li><b>Re
-00005e40: 6d6f 7665 7320 6869 6768 6c79 2063 6f72  moves highly cor
-00005e50: 7265 6c61 7465 6420 6665 6174 7572 6573  related features
-00005e60: 2061 7574 6f6d 6174 6963 616c 6c79 3c2f   automatically</
-00005e70: 623e 2e20 4966 2074 776f 2076 6172 6961  b>. If two varia
-00005e80: 626c 6573 2061 7265 2068 6967 686c 7920  bles are highly 
-00005e90: 636f 7272 656c 6174 6564 2069 6e20 796f  correlated in yo
-00005ea0: 7572 2064 6174 6173 6574 2c20 7768 6963  ur dataset, whic
-00005eb0: 6820 6f6e 6520 7368 6f75 6c64 2079 6f75  h one should you
-00005ec0: 2072 656d 6f76 6520 616e 6420 7768 6963   remove and whic
-00005ed0: 6820 6f6e 6520 7368 6f75 6c64 2079 6f75  h one should you
-00005ee0: 206b 6565 703f 2054 6865 2064 6563 6973   keep? The decis
-00005ef0: 696f 6e20 6973 206e 6f74 2061 7320 6561  ion is not as ea
-00005f00: 7379 2061 7320 6974 206c 6f6f 6b73 2e20  sy as it looks. 
-00005f10: 4175 746f 5f56 694d 4c20 7573 6573 2074  Auto_ViML uses t
-00005f20: 6865 2053 554c 4f56 2061 6c67 6f72 6974  he SULOV algorit
-00005f30: 686d 2074 6f20 7265 6d6f 7665 2068 6967  hm to remove hig
-00005f40: 686c 7920 636f 7272 656c 6174 6564 2066  hly correlated f
-00005f50: 6561 7475 7265 732e 2059 6f75 2063 616e  eatures. You can
-00005f60: 2075 6e64 6572 7374 616e 6420 5355 4c4f   understand SULO
-00005f70: 5620 6672 6f6d 2074 6869 7320 7069 6374  V from this pict
-00005f80: 7572 6520 6d6f 7265 2069 6e74 7569 7469  ure more intuiti
-00005f90: 7665 6c79 2e3c 6272 3e0d 0a0d 0a21 5b73  vely.<br>....![s
-00005fa0: 756c 6f76 5d28 5355 4c4f 562e 6a70 6729  ulov](SULOV.jpg)
-00005fb0: 0d0a 0d0a 3c6c 693e 3c62 3e47 656e 6572  ....<li><b>Gener
-00005fc0: 6174 6573 2070 6572 666f 726d 616e 6365  ates performance
-00005fd0: 2072 6573 756c 7473 2067 7261 7068 6963   results graphic
-00005fe0: 616c 6c79 3c2f 623e 2e20 4a75 7374 2073  ally</b>. Just s
-00005ff0: 6574 2076 6572 626f 7365 203d 2031 2028  et verbose = 1 (
-00006000: 6f72 2920 3220 696e 7374 6561 6420 6f66  or) 2 instead of
-00006010: 2030 2028 7369 6c65 6e74 292e 2059 6f75   0 (silent). You
-00006020: 2077 696c 6c20 6765 7420 6869 6768 6572   will get higher
-00006030: 2071 7561 6c69 7479 206f 6620 696e 7369   quality of insi
-00006040: 6768 7473 2061 7320 796f 7520 696e 6372  ghts as you incr
-00006050: 6561 7365 2076 6572 626f 7369 7479 2e20  ease verbosity. 
-00006060: 3c62 723e 0d0a 3c6c 693e 3c62 3e48 616e  <br>..<li><b>Han
-00006070: 646c 6573 2074 6578 742c 2064 6174 652d  dles text, date-
-00006080: 7469 6d65 2c20 7374 7275 6374 7320 286c  time, structs (l
-00006090: 6973 7473 2c20 6469 6374 696f 6e61 7269  ists, dictionari
-000060a0: 6573 292c 206e 756d 6572 6963 2c20 626f  es), numeric, bo
-000060b0: 6f6c 6561 6e2c 2066 6163 746f 7220 616e  olean, factor an
-000060c0: 6420 6361 7465 676f 7269 6361 6c3c 2f62  d categorical</b
-000060d0: 3e20 7661 7269 6162 6c65 7320 616c 6c20  > variables all 
-000060e0: 696e 206f 6e65 206d 6f64 656c 2075 7369  in one model usi
-000060f0: 6e67 206f 6e65 2073 7472 6169 6768 7420  ng one straight 
-00006100: 7072 6f63 6573 732e 3c62 723e 0d0a 3c2f  process.<br>..</
-00006110: 6f6c 3e0d 0a41 7574 6f5f 5669 4d4c 2069  ol>..Auto_ViML i
-00006120: 7320 6275 696c 7420 7573 696e 6720 7363  s built using sc
-00006130: 696b 6974 2d6c 6561 726e 2c20 6e75 6d70  ikit-learn, nump
-00006140: 792c 2070 616e 6461 7320 616e 6420 6d61  y, pandas and ma
-00006150: 7470 6c6f 746c 6962 2e20 4974 2073 686f  tplotlib. It sho
-00006160: 756c 6420 7275 6e20 6f6e 206d 6f73 7420  uld run on most 
-00006170: 5079 7468 6f6e 2033 2041 6e61 636f 6e64  Python 3 Anacond
-00006180: 6120 696e 7374 616c 6c61 7469 6f6e 732e  a installations.
-00006190: 2059 6f75 2077 6f6e 2774 2068 6176 6520   You won't have 
-000061a0: 746f 2069 6d70 6f72 7420 616e 7920 7370  to import any sp
-000061b0: 6563 6961 6c20 6c69 6272 6172 6965 7320  ecial libraries 
-000061c0: 6f74 6865 7220 7468 616e 2022 5847 426f  other than "XGBo
-000061d0: 6f73 7422 2c20 2249 6d62 616c 616e 6365  ost", "Imbalance
-000061e0: 642d 4c65 6172 6e22 2c20 2243 6174 426f  d-Learn", "CatBo
-000061f0: 6f73 7422 2c20 616e 6420 2266 6561 7475  ost", and "featu
-00006200: 7265 746f 6f6c 7322 206c 6962 7261 7279  retools" library
-00006210: 2e20 5765 2075 7365 2022 5348 4150 2220  . We use "SHAP" 
-00006220: 6c69 6272 6172 7920 666f 7220 696e 7465  library for inte
-00006230: 7270 7265 7461 6269 6c69 7479 2e20 3c62  rpretability. <b
-00006240: 723e 4275 7420 6966 2079 6f75 2064 6f6e  r>But if you don
-00006250: 2774 2068 6176 6520 7468 6573 6520 6c69  't have these li
-00006260: 6272 6172 6965 732c 2041 7574 6f5f 5669  braries, Auto_Vi
-00006270: 4d4c 2077 696c 6c20 696e 7374 616c 6c20  ML will install 
-00006280: 7468 6f73 6520 666f 7220 796f 7520 6175  those for you au
-00006290: 746f 6d61 7469 6361 6c6c 792e 0d0a 0d0a  tomatically.....
-000062a0: 2323 2049 6e73 7461 6c6c 0d0a 0d0a 2a2a  ## Install....**
-000062b0: 5072 6572 6571 7573 6974 6573 3a2a 2a0d  Prerequsites:**.
-000062c0: 0a0d 0a2d 205b 416e 6163 6f6e 6461 5d28  ...- [Anaconda](
-000062d0: 6874 7470 733a 2f2f 646f 6373 2e61 6e61  https://docs.ana
-000062e0: 636f 6e64 612e 636f 6d2f 616e 6163 6f6e  conda.com/anacon
-000062f0: 6461 2f69 6e73 7461 6c6c 2f29 0d0a 0d0a  da/install/)....
-00006300: 546f 2063 6c6f 6e65 2041 7574 6f5f 5669  To clone Auto_Vi
-00006310: 4d4c 2c20 6974 2069 7320 6265 7474 6572  ML, it is better
-00006320: 2074 6f20 6372 6561 7465 2061 206e 6577   to create a new
-00006330: 2065 6e76 6972 6f6e 6d65 6e74 2c20 616e   environment, an
-00006340: 6420 696e 7374 616c 6c20 7468 6520 7265  d install the re
-00006350: 7175 6972 6564 2064 6570 656e 6465 6e63  quired dependenc
-00006360: 6965 733a 0d0a 0d0a 546f 2069 6e73 7461  ies:....To insta
-00006370: 6c6c 2066 726f 6d20 5079 5069 3a0d 0a3c  ll from PyPi:..<
-00006380: 703e 0d0a 3c63 6f64 653e 2420 7069 7020  p>..<code>$ pip 
-00006390: 696e 7374 616c 6c20 6175 746f 7669 6d6c  install autoviml
-000063a0: 202d 2d75 7067 7261 6465 202d 2d69 676e   --upgrade --ign
-000063b0: 6f72 652d 696e 7374 616c 6c65 643c 2f63  ore-installed</c
-000063c0: 6f64 653e 3c62 723e 0d0a 6f72 0d0a 0d0a  ode><br>..or....
-000063d0: 6060 600d 0a70 6970 2069 6e73 7461 6c6c  ```..pip install
-000063e0: 2067 6974 2b68 7474 7073 3a2f 2f67 6974   git+https://git
-000063f0: 6875 622e 636f 6d2f 4175 746f 5669 4d4c  hub.com/AutoViML
-00006400: 2f41 7574 6f5f 5669 4d4c 2e67 6974 0d0a  /Auto_ViML.git..
-00006410: 6060 600d 0a0d 0a54 6f20 696e 7374 616c  ```....To instal
-00006420: 6c20 6672 6f6d 2073 6f75 7263 653a 0d0a  l from source:..
-00006430: 0d0a 6060 600d 0a63 6420 3c41 7574 6f56  ..```..cd <AutoV
-00006440: 494d 4c5f 4465 7374 696e 6174 696f 6e3e  IML_Destination>
-00006450: 0d0a 6769 7420 636c 6f6e 6520 6769 7440  ..git clone git@
-00006460: 6769 7468 7562 2e63 6f6d 3a41 7574 6f56  github.com:AutoV
-00006470: 694d 4c2f 4175 746f 5f56 694d 4c2e 6769  iML/Auto_ViML.gi
-00006480: 740d 0a23 206f 7220 646f 776e 6c6f 6164  t..# or download
-00006490: 2061 6e64 2075 6e7a 6970 2068 7474 7073   and unzip https
-000064a0: 3a2f 2f67 6974 6875 622e 636f 6d2f 4175  ://github.com/Au
-000064b0: 746f 5669 4d4c 2f41 7574 6f5f 5669 4d4c  toViML/Auto_ViML
-000064c0: 2f61 7263 6869 7665 2f6d 6173 7465 722e  /archive/master.
-000064d0: 7a69 700d 0a63 6f6e 6461 2063 7265 6174  zip..conda creat
-000064e0: 6520 2d6e 203c 796f 7572 5f65 6e76 5f6e  e -n <your_env_n
-000064f0: 616d 653e 2070 7974 686f 6e3d 332e 3720  ame> python=3.7 
-00006500: 616e 6163 6f6e 6461 0d0a 636f 6e64 6120  anaconda..conda 
-00006510: 6163 7469 7661 7465 203c 796f 7572 5f65  activate <your_e
-00006520: 6e76 5f6e 616d 653e 2023 204f 4e20 5749  nv_name> # ON WI
-00006530: 4e44 4f57 533a 2060 736f 7572 6365 2061  NDOWS: `source a
-00006540: 6374 6976 6174 6520 3c79 6f75 725f 656e  ctivate <your_en
-00006550: 765f 6e61 6d65 3e60 0d0a 6364 2041 7574  v_name>`..cd Aut
-00006560: 6f5f 5669 4d4c 0d0a 7069 7020 696e 7374  o_ViML..pip inst
-00006570: 616c 6c20 2d72 2072 6571 7569 7265 6d65  all -r requireme
-00006580: 6e74 732e 7478 740d 0a60 6060 0d0a 0d0a  nts.txt..```....
-00006590: 2323 2055 7361 6765 0d0a 0d0a 496e 2074  ## Usage....In t
-000065a0: 6865 2073 616d 6520 6469 7265 6374 6f72  he same director
-000065b0: 792c 206f 7065 6e20 6120 4a75 7079 7465  y, open a Jupyte
-000065c0: 7220 4e6f 7465 626f 6f6b 2061 6e64 2075  r Notebook and u
-000065d0: 7365 2074 6869 7320 6c69 6e65 2074 6f20  se this line to 
-000065e0: 696d 706f 7274 2074 6865 202e 7079 2066  import the .py f
-000065f0: 696c 653a 0d0a 0d0a 6060 600d 0a66 726f  ile:....```..fro
-00006600: 6d20 6175 746f 7669 6d6c 2e41 7574 6f5f  m autoviml.Auto_
-00006610: 5669 4d4c 2069 6d70 6f72 7420 4175 746f  ViML import Auto
-00006620: 5f56 694d 4c0d 0a60 6060 0d0a 0d0a 4c6f  _ViML..```....Lo
-00006630: 6164 2061 2064 6174 6120 7365 7420 2861  ad a data set (a
-00006640: 6e79 2043 5356 206f 7220 7465 7874 2066  ny CSV or text f
-00006650: 696c 6529 2069 6e74 6f20 6120 5061 6e64  ile) into a Pand
-00006660: 6173 2064 6174 6166 7261 6d65 2061 6e64  as dataframe and
-00006670: 2073 706c 6974 2069 7420 696e 746f 2054   split it into T
-00006680: 7261 696e 2061 6e64 2054 6573 7420 6461  rain and Test da
-00006690: 7461 6672 616d 6573 2e20 4966 2079 6f75  taframes. If you
-000066a0: 2064 6f6e 2774 2068 6176 6520 6120 7465   don't have a te
-000066b0: 7374 2064 6174 6166 7261 6d65 2c20 796f  st dataframe, yo
-000066c0: 7520 6361 6e20 7369 6d70 6c65 2061 7373  u can simple ass
-000066d0: 6967 6e20 7468 6520 7465 7374 2076 6172  ign the test var
-000066e0: 6961 626c 6520 6265 6c6f 7720 746f 2027  iable below to '
-000066f0: 2720 2865 6d70 7479 2073 7472 696e 6729  ' (empty string)
-00006700: 3a0d 0a0d 0a60 6060 0d0a 6d6f 6465 6c2c  :....```..model,
-00006710: 2066 6561 7475 7265 732c 2074 7261 696e   features, train
-00006720: 6d2c 2074 6573 746d 203d 2041 7574 6f5f  m, testm = Auto_
-00006730: 5669 4d4c 280d 0a20 2020 2074 7261 696e  ViML(..    train
-00006740: 2c0d 0a20 2020 2074 6172 6765 742c 0d0a  ,..    target,..
-00006750: 2020 2020 7465 7374 2c0d 0a20 2020 2073      test,..    s
-00006760: 616d 706c 655f 7375 626d 6973 7369 6f6e  ample_submission
-00006770: 2c0d 0a20 2020 2068 7970 6572 5f70 6172  ,..    hyper_par
-00006780: 616d 3d22 4753 222c 0d0a 2020 2020 6665  am="GS",..    fe
-00006790: 6174 7572 655f 7265 6475 6374 696f 6e3d  ature_reduction=
-000067a0: 5472 7565 2c0d 0a20 2020 2073 636f 7269  True,..    scori
-000067b0: 6e67 5f70 6172 616d 6574 6572 3d22 7765  ng_parameter="we
-000067c0: 6967 6874 6564 2d66 3122 2c0d 0a20 2020  ighted-f1",..   
-000067d0: 204b 4d65 616e 735f 4665 6174 7572 697a   KMeans_Featuriz
-000067e0: 6572 3d46 616c 7365 2c0d 0a20 2020 2042  er=False,..    B
-000067f0: 6f6f 7374 696e 675f 466c 6167 3d46 616c  oosting_Flag=Fal
-00006800: 7365 2c0d 0a20 2020 2042 696e 6e69 6e67  se,..    Binning
-00006810: 5f46 6c61 673d 4661 6c73 652c 0d0a 2020  _Flag=False,..  
-00006820: 2020 4164 645f 506f 6c79 3d46 616c 7365    Add_Poly=False
-00006830: 2c0d 0a20 2020 2053 7461 636b 696e 675f  ,..    Stacking_
-00006840: 466c 6167 3d46 616c 7365 2c0d 0a20 2020  Flag=False,..   
-00006850: 2049 6d62 616c 616e 6365 645f 466c 6167   Imbalanced_Flag
-00006860: 3d46 616c 7365 2c0d 0a20 2020 2076 6572  =False,..    ver
-00006870: 626f 7365 3d30 2c0d 0a29 0d0a 6060 600d  bose=0,..)..```.
-00006880: 0a0d 0a46 696e 616c 6c79 2c20 6974 2077  ...Finally, it w
-00006890: 7269 7465 7320 796f 7572 2073 7562 6d69  rites your submi
-000068a0: 7373 696f 6e20 6669 6c65 2074 6f20 6469  ssion file to di
-000068b0: 736b 2069 6e20 7468 6520 6375 7272 656e  sk in the curren
-000068c0: 7420 6469 7265 6374 6f72 7920 6361 6c6c  t directory call
-000068d0: 6564 2060 6d79 7375 626d 6973 7369 6f6e  ed `mysubmission
-000068e0: 2e63 7376 602e 0d0a 5468 6973 2073 7562  .csv`...This sub
-000068f0: 6d69 7373 696f 6e20 6669 6c65 2069 7320  mission file is 
-00006900: 7265 6164 7920 666f 7220 796f 7520 746f  ready for you to
-00006910: 2073 686f 7720 6974 2063 6c69 656e 7473   show it clients
-00006920: 206f 7220 7375 626d 6974 2069 7420 746f   or submit it to
-00006930: 2063 6f6d 7065 7469 7469 6f6e 732e 0d0a   competitions...
-00006940: 4966 206e 6f20 7375 626d 6973 7369 6f6e  If no submission
-00006950: 2066 696c 6520 7761 7320 6769 7665 6e2c   file was given,
-00006960: 2062 7574 2061 7320 6c6f 6e67 2061 7320   but as long as 
-00006970: 796f 7520 6769 7665 2069 7420 6120 7465  you give it a te
-00006980: 7374 2066 696c 6520 6e61 6d65 2c20 6974  st file name, it
-00006990: 2077 696c 6c20 6372 6561 7465 2061 2073   will create a s
-000069a0: 7562 6d69 7373 696f 6e20 6669 6c65 2066  ubmission file f
-000069b0: 6f72 2079 6f75 206e 616d 6564 2060 6d79  or you named `my
-000069c0: 5375 626d 6973 7369 6f6e 2e63 7376 602e  Submission.csv`.
-000069d0: 0d0a 4175 746f 5f56 694d 4c20 776f 726b  ..Auto_ViML work
-000069e0: 7320 6f6e 2061 6e79 204d 756c 7469 2d43  s on any Multi-C
-000069f0: 6c61 7373 2c20 4d75 6c74 692d 4c61 6265  lass, Multi-Labe
-00006a00: 6c20 4461 7461 2053 6574 2e20 536f 2079  l Data Set. So y
-00006a10: 6f75 2063 616e 2068 6176 6520 6d61 6e79  ou can have many
-00006a20: 2074 6172 6765 7420 6c61 6265 6c73 2e0d   target labels..
-00006a30: 0a59 6f75 2064 6f6e 2774 2068 6176 6520  .You don't have 
-00006a40: 746f 2074 656c 6c20 4175 746f 5f56 694d  to tell Auto_ViM
-00006a50: 4c20 7768 6574 6865 7220 6974 2069 7320  L whether it is 
-00006a60: 6120 5265 6772 6573 7369 6f6e 206f 7220  a Regression or 
-00006a70: 436c 6173 7369 6669 6361 7469 6f6e 2070  Classification p
-00006a80: 726f 626c 656d 2e0d 0a0d 0a23 2320 5469  roblem.....## Ti
-00006a90: 7073 2066 6f72 2075 7369 6e67 2041 7574  ps for using Aut
-00006aa0: 6f5f 5669 4d4c 3a0d 0a31 2e20 6073 636f  o_ViML:..1. `sco
-00006ab0: 7269 6e67 5f70 6172 616d 6574 6572 603a  ring_parameter`:
-00006ac0: 2046 6f72 2043 6c61 7373 6966 6963 6174   For Classificat
-00006ad0: 696f 6e20 7072 6f62 6c65 6d73 2061 6e64  ion problems and
-00006ae0: 2069 6d62 616c 616e 6365 6420 636c 6173   imbalanced clas
-00006af0: 7365 732c 2063 686f 6f73 6520 7363 6f72  ses, choose scor
-00006b00: 696e 675f 7061 7261 6d65 7465 723d 2262  ing_parameter="b
-00006b10: 616c 616e 6365 645f 6163 6375 7261 6379  alanced_accuracy
-00006b20: 222e 2049 7420 776f 726b 7320 6265 7474  ". It works bett
-00006b30: 6572 2e0d 0a32 2e20 6049 6d62 616c 616e  er...2. `Imbalan
-00006b40: 6365 645f 466c 6167 603a 2046 6f72 2049  ced_Flag`: For I
-00006b50: 6d62 616c 616e 6365 6420 436c 6173 7365  mbalanced Classe
-00006b60: 7320 283c 3525 2073 616d 706c 6573 2069  s (<5% samples i
-00006b70: 6e20 7261 7265 2063 6c61 7373 292c 2063  n rare class), c
-00006b80: 686f 6f73 6520 2249 6d62 616c 616e 6365  hoose "Imbalance
-00006b90: 645f 466c 6167 223d 5472 7565 2e20 596f  d_Flag"=True. Yo
-00006ba0: 7520 6361 6e20 616c 736f 2073 6574 2074  u can also set t
-00006bb0: 6869 7320 666c 6167 2074 6f20 5472 7565  his flag to True
-00006bc0: 2066 6f72 2052 6567 7265 7373 696f 6e20   for Regression 
-00006bd0: 7072 6f62 6c65 6d73 2077 6865 7265 2074  problems where t
-00006be0: 6865 2074 6172 6765 7420 7661 7269 6162  he target variab
-00006bf0: 6c65 206d 6967 6874 2068 6176 6520 736b  le might have sk
-00006c00: 6577 6564 2064 6973 7472 6962 7574 696f  ewed distributio
-00006c10: 6e73 2e0d 0a33 2e20 6074 6172 6765 7460  ns...3. `target`
-00006c20: 3a20 466f 7220 4d75 6c74 692d 4c61 6265  : For Multi-Labe
-00006c30: 6c20 6461 7461 7365 742c 2074 6865 2074  l dataset, the t
-00006c40: 6172 6765 7420 696e 7075 7420 7461 7267  arget input targ
-00006c50: 6574 2076 6172 6961 626c 6520 6361 6e20  et variable can 
-00006c60: 6265 2073 656e 7420 696e 2061 7320 6120  be sent in as a 
-00006c70: 6c69 7374 206f 6620 7661 7269 6162 6c65  list of variable
-00006c80: 732e 0d0a 342e 2060 426f 6f73 7469 6e67  s...4. `Boosting
-00006c90: 5f46 6c61 6760 3a20 4974 2069 7320 7265  _Flag`: It is re
-00006ca0: 636f 6d6d 656e 6465 6420 7468 6174 2079  commended that y
-00006cb0: 6f75 2066 6972 7374 2073 6574 2042 6f6f  ou first set Boo
-00006cc0: 7374 696e 675f 466c 6167 3d4e 6f6e 6520  sting_Flag=None 
-00006cd0: 746f 2067 6574 2061 204c 696e 6561 7220  to get a Linear 
-00006ce0: 6d6f 6465 6c2e 204f 6e63 6520 796f 7520  model. Once you 
-00006cf0: 756e 6465 7273 7461 6e64 2074 6861 742c  understand that,
-00006d00: 2074 6865 6e20 796f 7520 6361 6e20 7472   then you can tr
-00006d10: 7920 746f 2073 6574 2042 6f6f 7374 696e  y to set Boostin
-00006d20: 675f 466c 6167 3d46 616c 7365 2074 6f20  g_Flag=False to 
-00006d30: 6765 7420 6120 5261 6e64 6f6d 2046 6f72  get a Random For
-00006d40: 6573 7420 6d6f 6465 6c2e 2046 696e 616c  est model. Final
-00006d50: 6c79 2c20 7472 7920 426f 6f73 7469 6e67  ly, try Boosting
-00006d60: 5f46 6c61 673d 5472 7565 2074 6f20 6765  _Flag=True to ge
-00006d70: 7420 616e 2058 4742 6f6f 7374 206d 6f64  t an XGBoost mod
-00006d80: 656c 2e20 5468 6973 2069 7320 7468 6520  el. This is the 
-00006d90: 6f72 6465 7220 7468 6174 2077 6520 7265  order that we re
-00006da0: 636f 6d6d 656e 6420 696e 206f 7264 6572  commend in order
-00006db0: 2074 6f20 7573 6520 4175 746f 5f56 694d   to use Auto_ViM
-00006dc0: 4c2e 2046 696e 616c 6c79 2074 7279 2042  L. Finally try B
-00006dd0: 6f6f 7374 696e 675f 466c 6167 3d22 4361  oosting_Flag="Ca
-00006de0: 7442 6f6f 7374 2220 746f 2067 6574 2061  tBoost" to get a
-00006df0: 2063 6f6d 706c 6578 2062 7574 2068 6967   complex but hig
-00006e00: 6820 7065 7266 6f72 6d69 6e67 206d 6f64  h performing mod
-00006e10: 656c 2e0d 0a35 2e20 6042 696e 6e69 6e67  el...5. `Binning
-00006e20: 5f46 6c61 6760 3a20 4269 6e6e 696e 675f  _Flag`: Binning_
-00006e30: 466c 6167 3d54 7275 6520 696d 7072 6f76  Flag=True improv
-00006e40: 6573 2061 2043 6174 426f 6f73 7420 6d6f  es a CatBoost mo
-00006e50: 6465 6c20 7369 6e63 6520 6974 2061 6464  del since it add
-00006e60: 7320 746f 2074 6865 206c 6973 7420 6f66  s to the list of
-00006e70: 2063 6174 6567 6f72 6963 616c 2076 6172   categorical var
-00006e80: 7320 696e 2064 6174 610d 0a36 2e20 604b  s in data..6. `K
-00006e90: 4d65 616e 735f 6665 6174 7572 697a 6572  Means_featurizer
-00006ea0: 603a 204b 4d65 616e 735f 6665 6174 7572  `: KMeans_featur
-00006eb0: 697a 6572 3d54 7275 6520 776f 726b 7320  izer=True works 
-00006ec0: 7765 6c6c 2069 6e20 4e4c 5020 616e 6420  well in NLP and 
-00006ed0: 4361 7442 6f6f 7374 206d 6f64 656c 7320  CatBoost models 
-00006ee0: 7369 6e63 6520 6974 2063 7265 6174 6573  since it creates
-00006ef0: 2063 6c75 7374 6572 2076 6172 6961 626c   cluster variabl
-00006f00: 6573 0d0a 372e 2060 4164 645f 506f 6c79  es..7. `Add_Poly
-00006f10: 603a 2041 6464 5f50 6f6c 793d 3320 696d  `: Add_Poly=3 im
-00006f20: 7072 6f76 6573 2063 6572 7461 696e 206d  proves certain m
-00006f30: 6f64 656c 7320 7768 6572 6520 7468 6572  odels where ther
-00006f40: 6520 6973 2064 6174 652d 7469 6d65 206f  e is date-time o
-00006f50: 7220 6361 7465 676f 7269 6361 6c20 616e  r categorical an
-00006f60: 6420 6e75 6d65 7269 6320 7661 7269 6162  d numeric variab
-00006f70: 6c65 730d 0a38 2e20 6066 6561 7475 7265  les..8. `feature
-00006f80: 5f72 6564 7563 7469 6f6e 603a 2066 6561  _reduction`: fea
-00006f90: 7475 7265 5f72 6564 7563 7469 6f6e 3d54  ture_reduction=T
-00006fa0: 7275 6520 6973 2074 6865 2064 6566 6175  rue is the defau
-00006fb0: 6c74 2061 6e64 2077 6f72 6b73 2062 6573  lt and works bes
-00006fc0: 742e 2042 7574 2077 6865 6e20 796f 7520  t. But when you 
-00006fd0: 6861 7665 203c 3130 2066 6561 7475 7265  have <10 feature
-00006fe0: 7320 696e 2064 6174 612c 2073 6574 2069  s in data, set i
-00006ff0: 7420 746f 2046 616c 7365 0d0a 392e 2060  t to False..9. `
-00007000: 5374 6163 6b69 6e67 5f46 6c61 6760 3a20  Stacking_Flag`: 
-00007010: 446f 206e 6f74 2073 6574 2053 7461 636b  Do not set Stack
-00007020: 696e 675f 466c 6167 3d54 7275 6520 7769  ing_Flag=True wi
-00007030: 7468 204c 696e 6561 7220 6d6f 6465 6c73  th Linear models
-00007040: 2073 696e 6365 2079 6f75 7220 7265 7375   since your resu
-00007050: 6c74 7320 6d61 7920 6e6f 7420 6c6f 6f6b  lts may not look
-00007060: 2067 7265 6174 2e0d 0a31 302e 2060 5374   great...10. `St
-00007070: 6163 6b69 6e67 5f46 6c61 6760 3a20 5573  acking_Flag`: Us
-00007080: 6520 5374 6163 6b69 6e67 5f46 6c61 673d  e Stacking_Flag=
-00007090: 5472 7565 206f 6e6c 7920 666f 7220 636f  True only for co
-000070a0: 6d70 6c65 7820 6d6f 6465 6c73 2061 6e64  mplex models and
-000070b0: 2061 7320 6120 6c61 7374 2073 7465 7020   as a last step 
-000070c0: 7769 7468 2042 6f6f 7374 696e 675f 466c  with Boosting_Fl
-000070d0: 6167 3d54 7275 6520 6f72 2043 6174 426f  ag=True or CatBo
-000070e0: 6f73 740d 0a31 312e 2060 6879 7065 725f  ost..11. `hyper_
-000070f0: 7061 7261 6d60 3a20 4c65 6176 6520 6879  param`: Leave hy
-00007100: 7065 725f 7061 7261 6d20 3d22 5253 2220  per_param ="RS" 
-00007110: 6173 2069 6e70 7574 2073 696e 6365 2069  as input since i
-00007120: 7420 7275 6e73 2066 6173 7465 7220 7468  t runs faster th
-00007130: 616e 2047 7269 6453 6561 7263 6843 5620  an GridSearchCV 
-00007140: 616e 6420 6769 7665 7320 6265 7474 6572  and gives better
-00007150: 2072 6573 756c 7473 2075 6e6c 6573 7320   results unless 
-00007160: 796f 7520 6861 7665 2061 2073 6d61 6c6c  you have a small
-00007170: 2064 6174 6120 7365 7420 616e 6420 6361   data set and ca
-00007180: 6e20 6166 666f 7264 2074 6f20 7370 656e  n afford to spen
-00007190: 6420 7469 6d65 206f 6e20 6879 7065 7220  d time on hyper 
-000071a0: 7475 6e69 6e67 2e0d 0a31 322e 2060 4b4d  tuning...12. `KM
-000071b0: 6561 6e73 5f46 6561 7475 7269 7a65 7260  eans_Featurizer`
-000071c0: 3a20 4b4d 6561 6e73 5f46 6561 7475 7269  : KMeans_Featuri
-000071d0: 7a65 723d 5472 7565 2064 6f65 7320 6e6f  zer=True does no
-000071e0: 7420 776f 726b 2077 656c 6c20 666f 7220  t work well for 
-000071f0: 736d 616c 6c20 6461 7461 2073 6574 732e  small data sets.
-00007200: 2055 7365 2069 7420 666f 7220 6461 7461   Use it for data
-00007210: 2073 6574 7320 3e20 3130 2c30 3030 2072   sets > 10,000 r
-00007220: 6f77 732e 0d0a 3133 2e20 6046 696e 616c  ows...13. `Final
-00007230: 2074 686f 7567 6874 7360 3a20 4669 6e61   thoughts`: Fina
-00007240: 6c6c 7920 4175 746f 5f56 694d 4c20 6973  lly Auto_ViML is
-00007250: 206d 6561 6e74 2074 6f20 6265 2061 2062   meant to be a b
-00007260: 6173 656c 696e 6520 6f72 2063 6861 6c6c  aseline or chall
-00007270: 656e 6765 7220 736f 6c75 7469 6f6e 2074  enger solution t
-00007280: 6f20 796f 7572 2064 6174 6120 7365 742e  o your data set.
-00007290: 2053 6f20 7573 6520 6974 2066 6f72 206d   So use it for m
-000072a0: 616b 696e 6720 7175 6963 6b20 6d6f 6465  aking quick mode
-000072b0: 6c73 2074 6861 7420 796f 7520 6361 6e20  ls that you can 
-000072c0: 636f 6d70 6172 6520 6167 6169 6e73 7420  compare against 
-000072d0: 6f72 2069 6e20 4861 636b 6174 686f 6e73  or in Hackathons
-000072e0: 2e20 4974 2069 7320 6e6f 7420 6d65 616e  . It is not mean
-000072f0: 7420 666f 7220 7072 6f64 7563 7469 6f6e  t for production
-00007300: 210d 0a0d 0a23 2320 4150 490d 0a0d 0a2a  !....## API....*
-00007310: 2a41 7267 756d 656e 7473 2a2a 0d0a 0d0a  *Arguments**....
-00007320: 2d20 6074 7261 696e 603a 2063 6f75 6c64  - `train`: could
-00007330: 2062 6520 6120 6461 7461 7061 7468 2b66   be a datapath+f
-00007340: 696c 656e 616d 6520 6f72 2061 2064 6174  ilename or a dat
-00007350: 6166 7261 6d65 2e20 4974 2077 696c 6c20  aframe. It will 
-00007360: 6465 7465 6374 2077 6869 6368 2069 7320  detect which is 
-00007370: 7768 6963 6820 616e 6420 6c6f 6164 2069  which and load i
-00007380: 742e 0d0a 2d20 6074 6573 7460 3a20 636f  t...- `test`: co
-00007390: 756c 6420 6265 2061 2064 6174 6170 6174  uld be a datapat
-000073a0: 682b 6669 6c65 6e61 6d65 206f 7220 6120  h+filename or a 
-000073b0: 6461 7461 6672 616d 652e 2049 6620 796f  dataframe. If yo
-000073c0: 7520 646f 6e27 7420 6861 7665 2061 6e79  u don't have any
-000073d0: 2c20 6a75 7374 206c 6561 7665 2069 7420  , just leave it 
-000073e0: 6173 2022 222e 0d0a 2d20 6073 7562 6d69  as ""...- `submi
-000073f0: 7373 696f 6e60 3a20 6d75 7374 2062 6520  ssion`: must be 
-00007400: 6120 6461 7461 7061 7468 2b66 696c 656e  a datapath+filen
-00007410: 616d 652e 2049 6620 796f 7520 646f 6e27  ame. If you don'
-00007420: 7420 6861 7665 2061 6e79 2c20 6a75 7374  t have any, just
-00007430: 206c 6561 7665 2069 7420 6173 2065 6d70   leave it as emp
-00007440: 7479 2073 7472 696e 672e 0d0a 2d20 6074  ty string...- `t
-00007450: 6172 6765 7460 3a20 6e61 6d65 206f 6620  arget`: name of 
-00007460: 7468 6520 7461 7267 6574 2076 6172 6961  the target varia
-00007470: 626c 6520 696e 2074 6865 2064 6174 6120  ble in the data 
-00007480: 7365 742e 0d0a 2d20 6073 6570 603a 2069  set...- `sep`: i
-00007490: 6620 796f 7520 6861 7665 2061 2073 7065  f you have a spe
-000074a0: 6172 6174 6f72 2069 6e20 7468 6520 6669  arator in the fi
-000074b0: 6c65 2073 7563 6820 6173 2022 2c22 206f  le such as "," o
-000074c0: 7220 225c 7422 206d 656e 7469 6f6e 2069  r "\t" mention i
-000074d0: 7420 6865 7265 2e20 4465 6661 756c 7420  t here. Default 
-000074e0: 6973 2022 2c22 2e0d 0a2d 2060 7363 6f72  is ","...- `scor
-000074f0: 696e 675f 7061 7261 6d65 7465 7260 3a20  ing_parameter`: 
-00007500: 6966 2079 6f75 2077 616e 7420 796f 7572  if you want your
-00007510: 206f 776e 2073 636f 7269 6e67 2070 6172   own scoring par
-00007520: 616d 6574 6572 2073 7563 6820 6173 2022  ameter such as "
-00007530: 6631 2220 6769 7665 2069 7420 6865 7265  f1" give it here
-00007540: 2e20 4966 206e 6f74 2c20 6974 2077 696c  . If not, it wil
-00007550: 6c20 6173 7375 6d65 2074 6865 2061 7070  l assume the app
-00007560: 726f 7072 6961 7465 2073 636f 7269 6e67  ropriate scoring
-00007570: 2070 6172 616d 2066 6f72 2074 6865 2070   param for the p
-00007580: 726f 626c 656d 2061 6e64 2069 7420 7769  roblem and it wi
-00007590: 6c6c 2062 7569 6c64 2074 6865 206d 6f64  ll build the mod
-000075a0: 656c 2e0d 0a2d 2060 6879 7065 725f 7061  el...- `hyper_pa
-000075b0: 7261 6d60 3a20 5475 6e69 6e67 206f 7074  ram`: Tuning opt
-000075c0: 696f 6e73 2061 7265 2047 7269 6453 6561  ions are GridSea
-000075d0: 7263 6820 2827 4753 2729 2061 6e64 2052  rch ('GS') and R
-000075e0: 616e 646f 6d69 7a65 6453 6561 7263 6820  andomizedSearch 
-000075f0: 2827 5253 2729 2e20 4465 6661 756c 7420  ('RS'). Default 
-00007600: 6973 2027 5253 272e 0d0a 2d20 6066 6561  is 'RS'...- `fea
-00007610: 7475 7265 5f72 6564 7563 7469 6f6e 603a  ture_reduction`:
-00007620: 2044 6566 6175 6c74 203d 2027 5472 7565   Default = 'True
-00007630: 2720 6275 7420 6974 2063 616e 2062 6520  ' but it can be 
-00007640: 7365 7420 746f 2046 616c 7365 2069 6620  set to False if 
-00007650: 796f 7520 646f 6e27 7420 7761 6e74 2061  you don't want a
-00007660: 7574 6f6d 6174 6963 2066 6561 7475 7265  utomatic feature
-00007670: 5f72 6564 7563 7469 6f6e 2073 696e 6365  _reduction since
-00007680: 2069 6e20 496d 6167 6520 6461 7461 2073   in Image data s
-00007690: 6574 7320 6c69 6b65 2064 6967 6974 7320  ets like digits 
-000076a0: 616e 6420 4d4e 4953 542c 2079 6f75 2067  and MNIST, you g
-000076b0: 6574 2062 6574 7465 7220 7265 7375 6c74  et better result
-000076c0: 7320 7768 656e 2079 6f75 2064 6f6e 2774  s when you don't
-000076d0: 2072 6564 7563 6520 6665 6174 7572 6573   reduce features
-000076e0: 2061 7574 6f6d 6174 6963 616c 6c79 2e20   automatically. 
-000076f0: 596f 7520 6361 6e20 616c 7761 7973 2074  You can always t
-00007700: 7279 2062 6f74 6820 616e 6420 7365 652e  ry both and see.
-00007710: 0d0a 2d20 604b 4d65 616e 735f 4665 6174  ..- `KMeans_Feat
-00007720: 7572 697a 6572 600d 0a20 202d 2060 5472  urizer`..  - `Tr
-00007730: 7565 603a 2041 6464 7320 6120 636c 7573  ue`: Adds a clus
-00007740: 7465 7220 6c61 6265 6c20 746f 2066 6561  ter label to fea
-00007750: 7475 7265 7320 6261 7365 6420 6f6e 204b  tures based on K
-00007760: 4d65 616e 732e 2055 7365 2066 6f72 204c  Means. Use for L
-00007770: 696e 6561 722e 0d0a 2020 2d20 6046 616c  inear...  - `Fal
-00007780: 7365 2028 6465 6661 756c 7429 6020 466f  se (default)` Fo
-00007790: 7220 5261 6e64 6f6d 2046 6f72 6573 7473  r Random Forests
-000077a0: 206f 7220 5847 4220 6d6f 6465 6c73 2c20   or XGB models, 
-000077b0: 6c65 6176 6520 6974 2046 616c 7365 2073  leave it False s
-000077c0: 696e 6365 2069 7420 6d61 7920 6f76 6572  ince it may over
-000077d0: 6669 742e 0d0a 2d20 6042 6f6f 7374 696e  fit...- `Boostin
-000077e0: 6720 466c 6167 603a 2079 6f75 2068 6176  g Flag`: you hav
-000077f0: 6520 3420 706f 7373 6962 6c65 2063 686f  e 4 possible cho
-00007800: 6963 6573 2028 6465 6661 756c 7420 6973  ices (default is
-00007810: 2046 616c 7365 293a 0d0a 2020 2d20 604e   False):..  - `N
-00007820: 6f6e 6560 2054 6869 7320 7769 6c6c 2062  one` This will b
-00007830: 7569 6c64 2061 204c 696e 6561 7220 4d6f  uild a Linear Mo
-00007840: 6465 6c0d 0a20 202d 2060 4661 6c73 6560  del..  - `False`
-00007850: 2054 6869 7320 7769 6c6c 2062 7569 6c64   This will build
-00007860: 2061 2052 616e 646f 6d20 466f 7265 7374   a Random Forest
-00007870: 206f 7220 4578 7472 6120 5472 6565 7320   or Extra Trees 
-00007880: 6d6f 6465 6c20 2861 6c73 6f20 6b6e 6f77  model (also know
-00007890: 6e20 6173 2042 6167 6769 6e67 290d 0a20  n as Bagging).. 
-000078a0: 202d 2060 5472 7565 6020 5468 6973 2077   - `True` This w
-000078b0: 696c 6c20 6275 696c 6420 616e 2058 4742  ill build an XGB
-000078c0: 6f6f 7374 206d 6f64 656c 0d0a 2020 2d20  oost model..  - 
-000078d0: 6043 6174 426f 6f73 7460 2054 6869 7320  `CatBoost` This 
-000078e0: 7769 6c6c 2062 7569 6c64 2061 2043 6174  will build a Cat
-000078f0: 426f 6f73 7420 6d6f 6465 6c20 2870 726f  Boost model (pro
-00007900: 7669 6465 6420 796f 7520 6861 7665 2043  vided you have C
-00007910: 6174 426f 6f73 7420 696e 7374 616c 6c65  atBoost installe
-00007920: 6429 0d0a 2d20 6041 6464 5f50 6f6c 7960  d)..- `Add_Poly`
-00007930: 3a20 4465 6661 756c 7420 6973 2030 2077  : Default is 0 w
-00007940: 6869 6368 206d 6561 6e73 2064 6f2d 6e6f  hich means do-no
-00007950: 7468 696e 672e 2042 7574 2069 7420 6861  thing. But it ha
-00007960: 7320 7468 7265 6520 696e 7465 7265 7374  s three interest
-00007970: 696e 6720 7365 7474 696e 6773 3a0d 0a20  ing settings:.. 
-00007980: 202d 2060 3160 2041 6464 2069 6e74 6572   - `1` Add inter
-00007990: 6163 7469 6f6e 2076 6172 6961 626c 6573  action variables
-000079a0: 206f 6e6c 7920 7375 6368 2061 7320 7831   only such as x1
-000079b0: 2a78 322c 2078 322a 7833 2c2e 2e2e 7839  *x2, x2*x3,...x9
-000079c0: 5c2a 3130 2065 7463 2e0d 0a20 202d 2060  \*10 etc...  - `
-000079d0: 3260 2041 6464 2049 6e74 6572 6163 7469  2` Add Interacti
-000079e0: 6f6e 7320 616e 6420 5371 7561 7265 6420  ons and Squared 
-000079f0: 7661 7269 6162 6c65 7320 7375 6368 2061  variables such a
-00007a00: 7320 7831 2a2a 322c 2078 322a 2a32 2c20  s x1**2, x2**2, 
-00007a10: 6574 632e 0d0a 2020 2d20 6033 6020 4164  etc...  - `3` Ad
-00007a20: 6473 2062 6f74 6820 496e 7465 7261 6374  ds both Interact
-00007a30: 696f 6e73 2061 6e64 2053 7175 6172 6564  ions and Squared
-00007a40: 2076 6172 6961 626c 6573 2073 7563 6820   variables such 
-00007a50: 6173 2078 312a 7832 2c20 7831 2a2a 322c  as x1*x2, x1**2,
-00007a60: 7832 2a78 332c 2078 322a 2a32 2c20 6574  x2*x3, x2**2, et
-00007a70: 632e 0d0a 2d20 6053 7461 636b 696e 675f  c...- `Stacking_
-00007a80: 466c 6167 603a 2044 6566 6175 6c74 2069  Flag`: Default i
-00007a90: 7320 4661 6c73 652e 2049 6620 7365 7420  s False. If set 
-00007aa0: 746f 2054 7275 652c 2069 7420 7769 6c6c  to True, it will
-00007ab0: 2061 6464 2061 6e20 6164 6469 7469 6f6e   add an addition
-00007ac0: 616c 2066 6561 7475 7265 2077 6869 6368  al feature which
-00007ad0: 2069 7320 6465 7269 7665 6420 6672 6f6d   is derived from
-00007ae0: 2070 7265 6469 6374 696f 6e73 206f 6620   predictions of 
-00007af0: 616e 6f74 6865 7220 6d6f 6465 6c2e 2054  another model. T
-00007b00: 6869 7320 6973 2075 7365 6420 696e 2073  his is used in s
-00007b10: 6f6d 6520 6361 7365 7320 6275 7420 6d61  ome cases but ma
-00007b20: 7920 7265 7375 6c74 2069 6e20 6f76 6572  y result in over
-00007b30: 6669 7474 696e 672e 2053 6f20 6265 2063  fitting. So be c
-00007b40: 6172 6566 756c 2074 7572 6e69 6e67 2074  areful turning t
-00007b50: 6869 7320 666c 6167 2022 6f6e 222e 0d0a  his flag "on"...
-00007b60: 2d20 6042 696e 6e69 6e67 5f46 6c61 6760  - `Binning_Flag`
-00007b70: 3a20 4465 6661 756c 7420 6973 2046 616c  : Default is Fal
-00007b80: 7365 2e20 4974 2073 6574 2074 6f20 5472  se. It set to Tr
-00007b90: 7565 2c20 6974 2077 696c 6c20 636f 6e76  ue, it will conv
-00007ba0: 6572 7420 7468 6520 746f 7020 6e75 6d65  ert the top nume
-00007bb0: 7269 6320 7661 7269 6162 6c65 7320 696e  ric variables in
-00007bc0: 746f 2062 696e 6e65 6420 7661 7269 6162  to binned variab
-00007bd0: 6c65 7320 7468 726f 7567 6820 6120 7465  les through a te
-00007be0: 6368 6e69 7175 6520 6b6e 6f77 6e20 6173  chnique known as
-00007bf0: 2022 456e 7472 6f70 7922 2062 696e 6e69   "Entropy" binni
-00007c00: 6e67 2e20 5468 6973 2069 7320 7665 7279  ng. This is very
-00007c10: 2068 656c 7066 756c 2066 6f72 2063 6572   helpful for cer
-00007c20: 7461 696e 2064 6174 6173 6574 7320 2865  tain datasets (e
-00007c30: 7370 6563 6961 6c6c 7920 6861 7264 2074  specially hard t
-00007c40: 6f20 6275 696c 6420 6d6f 6465 6c73 292e  o build models).
-00007c50: 0d0a 2d20 6049 6d62 616c 616e 6365 645f  ..- `Imbalanced_
-00007c60: 466c 6167 603a 2044 6566 6175 6c74 2069  Flag`: Default i
-00007c70: 7320 4661 6c73 652e 2055 7365 7320 696d  s False. Uses im
-00007c80: 6261 6c61 6e63 6564 5f65 6e73 656d 626c  balanced_ensembl
-00007c90: 6520 6c69 6272 6172 7920 666f 7220 696d  e library for im
-00007ca0: 6261 6c61 6e63 6564 2064 6174 612e 204a  balanced data. J
-00007cb0: 7573 7420 7365 7420 496d 6261 6c61 6e63  ust set Imbalanc
-00007cc0: 6564 5f46 6c61 6720 3d20 5472 7565 2069  ed_Flag = True i
-00007cd0: 6e20 6172 6775 6d65 6e74 730d 0a2d 2060  n arguments..- `
-00007ce0: 7665 7262 6f73 6560 3a20 5468 6973 2068  verbose`: This h
-00007cf0: 6173 2033 2070 6f73 7369 626c 6520 7374  as 3 possible st
-00007d00: 6174 6573 3a0d 0a20 202d 2060 3060 206c  ates:..  - `0` l
-00007d10: 696d 6974 6564 206f 7574 7075 742e 2047  imited output. G
-00007d20: 7265 6174 2066 6f72 2072 756e 6e69 6e67  reat for running
-00007d30: 2074 6869 7320 7369 6c65 6e74 6c79 2061   this silently a
-00007d40: 6e64 2067 6574 7469 6e67 2066 6173 7420  nd getting fast 
-00007d50: 7265 7375 6c74 732e 0d0a 2020 2d20 6031  results...  - `1
-00007d60: 6020 6d6f 7265 2063 6861 7274 732e 2047  ` more charts. G
-00007d70: 7265 6174 2066 6f72 206b 6e6f 7769 6e67  reat for knowing
-00007d80: 2068 6f77 2072 6573 756c 7473 2077 6572   how results wer
-00007d90: 6520 616e 6420 6d61 6b69 6e67 2063 6861  e and making cha
-00007da0: 6e67 6573 2074 6f20 666c 6167 7320 696e  nges to flags in
-00007db0: 2069 6e70 7574 2e0d 0a20 202d 2060 3260   input...  - `2`
-00007dc0: 206c 6f74 7320 6f66 2063 6861 7274 7320   lots of charts 
-00007dd0: 616e 6420 6f75 7470 7574 2e20 4772 6561  and output. Grea
-00007de0: 7420 666f 7220 7265 7072 6f64 7563 696e  t for reproducin
-00007df0: 6720 7768 6174 2041 7574 6f5f 5669 4d4c  g what Auto_ViML
-00007e00: 2064 6f65 7320 6f6e 2079 6f75 7220 6f77   does on your ow
-00007e10: 6e2e 0d0a 0d0a 2a2a 5265 7475 726e 2076  n.....**Return v
-00007e20: 616c 7565 732a 2a0d 0a0d 0a2d 2060 6d6f  alues**....- `mo
-00007e30: 6465 6c60 3a20 4974 2077 696c 6c20 7265  del`: It will re
-00007e40: 7475 726e 2079 6f75 7220 7472 6169 6e65  turn your traine
-00007e50: 6420 6d6f 6465 6c0d 0a2d 2060 6665 6174  d model..- `feat
-00007e60: 7572 6573 603a 2074 6865 2066 6577 6573  ures`: the fewes
-00007e70: 7420 6e75 6d62 6572 206f 6620 6665 6174  t number of feat
-00007e80: 7572 6573 2069 6e20 796f 7572 206d 6f64  ures in your mod
-00007e90: 656c 2074 6f20 6d61 6b65 2069 7420 7065  el to make it pe
-00007ea0: 7266 6f72 6d20 7765 6c6c 0d0a 2d20 6074  rform well..- `t
-00007eb0: 7261 696e 5f6d 6f64 6966 6965 6460 3a20  rain_modified`: 
-00007ec0: 7468 6973 2069 7320 7468 6520 6d6f 6469  this is the modi
-00007ed0: 6669 6564 2074 7261 696e 2064 6174 6166  fied train dataf
-00007ee0: 7261 6d65 2061 6674 6572 2072 656d 6f76  rame after remov
-00007ef0: 696e 6720 616e 6420 6164 6469 6e67 2066  ing and adding f
-00007f00: 6561 7475 7265 730d 0a2d 2060 7465 7374  eatures..- `test
-00007f10: 5f6d 6f64 6966 6965 6460 3a20 7468 6973  _modified`: this
-00007f20: 2069 7320 7468 6520 6d6f 6469 6669 6564   is the modified
-00007f30: 2074 6573 7420 6461 7461 6672 616d 6520   test dataframe 
-00007f40: 7769 7468 2074 6865 2073 616d 6520 7472  with the same tr
-00007f50: 616e 7366 6f72 6d61 7469 6f6e 7320 6173  ansformations as
-00007f60: 2074 7261 696e 0d0a 0d0a 2323 204d 6169   train....## Mai
-00007f70: 6e74 6169 6e65 7273 0d0a 0d0a 2a20 5b40  ntainers....* [@
-00007f80: 4175 746f 5669 4d4c 5d28 6874 7470 733a  AutoViML](https:
-00007f90: 2f2f 6769 7468 7562 2e63 6f6d 2f41 7574  //github.com/Aut
-00007fa0: 6f56 694d 4c29 0d0a 2a20 5b40 6d6f 7265  oViML)..* [@more
-00007fb0: 6e6f 6831 3439 5d28 6874 7470 733a 2f2f  noh149](https://
-00007fc0: 6769 7468 7562 2e63 6f6d 2f6d 6f72 656e  github.com/moren
-00007fd0: 6f68 3134 3929 0d0a 2a20 5b40 6869 726f  oh149)..* [@hiro
-00007fe0: 6e72 6f79 5d28 6874 7470 733a 2f2f 6769  nroy](https://gi
-00007ff0: 7468 7562 2e63 6f6d 2f68 6972 6f6e 726f  thub.com/hironro
-00008000: 7929 0d0a 0d0a 2323 2043 6f6e 7472 6962  y)....## Contrib
-00008010: 7574 696e 670d 0a0d 0a53 6565 205b 7468  uting....See [th
-00008020: 6520 636f 6e74 7269 6275 7469 6e67 2066  e contributing f
-00008030: 696c 655d 2843 4f4e 5452 4942 5554 494e  ile](CONTRIBUTIN
-00008040: 472e 6d64 2921 0d0a 0d0a 5052 7320 6163  G.md)!....PRs ac
-00008050: 6365 7074 6564 2e0d 0a0d 0a23 2320 4c69  cepted.....## Li
-00008060: 6365 6e73 650d 0a0d 0a41 7061 6368 6520  cense....Apache 
-00008070: 4c69 6365 6e73 6520 322e 3020 c2a9 2032  License 2.0 .. 2
-00008080: 3032 3020 5261 6d20 5365 7368 6164 7269  020 Ram Seshadri
-00008090: 0d0a 0d0a 2323 2044 4953 434c 4149 4d45  ....## DISCLAIME
-000080a0: 520d 0a54 6869 7320 7072 6f6a 6563 7420  R..This project 
-000080b0: 6973 206e 6f74 2061 6e20 6f66 6669 6369  is not an offici
-000080c0: 616c 2047 6f6f 676c 6520 7072 6f6a 6563  al Google projec
-000080d0: 742e 2049 7420 6973 206e 6f74 2073 7570  t. It is not sup
-000080e0: 706f 7274 6564 2062 7920 476f 6f67 6c65  ported by Google
-000080f0: 2061 6e64 2047 6f6f 676c 6520 7370 6563   and Google spec
-00008100: 6966 6963 616c 6c79 2064 6973 636c 6169  ifically disclai
-00008110: 6d73 2061 6c6c 2077 6172 7261 6e74 6965  ms all warrantie
-00008120: 7320 6173 2074 6f20 6974 7320 7175 616c  s as to its qual
-00008130: 6974 792c 206d 6572 6368 616e 7461 6269  ity, merchantabi
-00008140: 6c69 7479 2c20 6f72 2066 6974 6e65 7373  lity, or fitness
-00008150: 2066 6f72 2061 2070 6172 7469 6375 6c61   for a particula
-00008160: 7220 7075 7270 6f73 652e 0d0a 0000 0000  r purpose.......
+00005200: 2028 4d61 7263 6820 3230 3233 290d 0a3c   (March 2023)..<
+00005210: 6f6c 3e0d 0a3c 6c69 3e3c 623e 4175 746f  ol>..<li><b>Auto
+00005220: 5f56 694d 4c20 6861 7320 6120 6e65 7720  _ViML has a new 
+00005230: 666c 6167 2074 6f20 7370 6565 6420 7570  flag to speed up
+00005240: 2070 726f 6365 7373 696e 6720 7573 696e   processing usin
+00005250: 6720 4750 5527 733c 2f62 3e2e 204a 7573  g GPU's</b>. Jus
+00005260: 7420 7365 7420 7468 6520 6047 5055 5f66  t set the `GPU_f
+00005270: 6c61 6760 3d60 5472 7565 6020 6f6e 2043  lag`=`True` on C
+00005280: 6f6c 6162 2061 6e64 206f 7468 6572 2065  olab and other e
+00005290: 6e76 6972 6f6e 6d65 6e74 732e 2042 7574  nvironments. But
+000052a0: 2064 6f6e 2774 2066 6f72 6765 7420 746f   don't forget to
+000052b0: 2073 6574 2074 6865 2072 756e 7469 6d65   set the runtime
+000052c0: 2074 7970 6520 746f 2062 6520 2247 5055   type to be "GPU
+000052d0: 2220 7768 696c 6520 7275 6e6e 696e 6720  " while running 
+000052e0: 6f6e 2043 6f6c 6162 2e20 4f74 6865 7277  on Colab. Otherw
+000052f0: 6973 6520 796f 7520 7769 6c6c 2067 6574  ise you will get
+00005300: 2061 6e20 6572 726f 722e 3c2f 6c69 3e0d   an error.</li>.
+00005310: 0a3c 2f6f 6c3e 0d0a 0d0a 2323 2055 7064  .</ol>....## Upd
+00005320: 6174 6520 284d 6179 2032 3032 3229 0d0a  ate (May 2022)..
+00005330: 3c6f 6c3e 0d0a 3c6c 693e 3c62 3e41 7574  <ol>..<li><b>Aut
+00005340: 6f5f 5669 4d4c 2061 7320 6f66 2076 6572  o_ViML as of ver
+00005350: 7369 6f6e 2030 2e31 2e37 3130 2075 7365  sion 0.1.710 use
+00005360: 7320 6120 7665 7279 2068 6967 6820 7065  s a very high pe
+00005370: 7266 6f72 6d61 6e63 6520 6c69 6272 6172  rformance librar
+00005380: 7920 6361 6c6c 6564 2060 696d 6261 6c61  y called `imbala
+00005390: 6e63 6564 5f65 6e73 656d 626c 6560 2066  nced_ensemble` f
+000053a0: 6f72 2049 6d62 616c 616e 6365 6420 6461  or Imbalanced da
+000053b0: 7461 7365 7420 7072 6f62 6c65 6d73 2e3c  taset problems.<
+000053c0: 2f62 3e20 4974 2077 696c 6c20 7072 6f64  /b> It will prod
+000053d0: 7563 6520 6120 352d 3130 2520 626f 6f73  uce a 5-10% boos
+000053e0: 7420 696e 2079 6f75 7220 6261 6c61 6e63  t in your balanc
+000053f0: 6564 5f61 6363 7572 6163 7920 6261 7365  ed_accuracy base
+00005400: 6420 6f6e 206d 7920 6578 7065 7269 656e  d on my experien
+00005410: 6365 2077 6974 6820 206d 616e 7920 6461  ce with  many da
+00005420: 7461 7365 7473 2049 2068 6176 6520 7472  tasets I have tr
+00005430: 6965 642e 3c2f 6c69 3e0d 0a3c 6272 3e0d  ied.</li>..<br>.
+00005440: 0a3c 703e 496e 2061 6464 6974 696f 6e2c  .<p>In addition,
+00005450: 206e 6577 2066 6561 7475 7265 7320 696e   new features in
+00005460: 2074 6869 7320 7665 7273 696f 6e20 6172   this version ar
+00005470: 653a 3c62 723e 0d0a 3c75 6c3e 0d0a 3c6c  e:<br>..<ul>..<l
+00005480: 693e 5355 4c4f 5620 2d3e 2055 7365 7320  i>SULOV -> Uses 
+00005490: 7468 6520 5355 4c4f 5620 616c 676f 7269  the SULOV algori
+000054a0: 7468 6d20 666f 7220 7265 6d6f 7669 6e67  thm for removing
+000054b0: 2068 6967 686c 7920 636f 7272 656c 6174   highly correlat
+000054c0: 6564 2066 6561 7475 7265 7320 6175 746f  ed features auto
+000054d0: 6d61 7469 6361 6c6c 792e 3c2f 6c69 3e0d  matically.</li>.
+000054e0: 0a3c 6c69 3e41 7574 6f5f 4e4c 5020 2d3e  .<li>Auto_NLP ->
+000054f0: 2041 7574 6f56 694d 4c20 6175 746f 6d61   AutoViML automa
+00005500: 7469 6361 6c6c 7920 6465 7465 6374 7320  tically detects 
+00005510: 5465 7874 2076 6172 6961 626c 6573 2061  Text variables a
+00005520: 6e64 2064 6f65 7320 4e4c 5020 7072 6f63  nd does NLP proc
+00005530: 6573 7369 6e67 2075 7369 6e67 2041 7574  essing using Aut
+00005540: 6f5f 4e4c 503c 2f6c 693e 0d0a 3c6c 693e  o_NLP</li>..<li>
+00005550: 4461 7465 2054 696d 6520 2d3e 2049 7420  Date Time -> It 
+00005560: 6175 746f 6d61 7469 6361 6c6c 7920 6465  automatically de
+00005570: 7465 6374 7320 2064 6174 6520 7469 6d65  tects  date time
+00005580: 2076 6172 6961 626c 6573 2061 6e64 2067   variables and g
+00005590: 656e 6572 6174 6573 206e 6577 2066 6561  enerates new fea
+000055a0: 7475 7265 733c 2f6c 693e 0d0a 3c6c 693e  tures</li>..<li>
+000055b0: 6069 6d62 616c 616e 6365 645f 656e 7365  `imbalanced_ense
+000055c0: 6d62 6c65 6020 6c69 6272 6172 7920 2d3e  mble` library ->
+000055d0: 2055 7365 7320 696d 6261 6c61 6e63 6564   Uses imbalanced
+000055e0: 5f65 6e73 656d 626c 6520 6c69 6272 6172  _ensemble librar
+000055f0: 7920 666f 7220 696d 6261 6c61 6e63 6564  y for imbalanced
+00005600: 2064 6174 612e 204a 7573 7420 7365 7420   data. Just set 
+00005610: 496d 6261 6c61 6e63 6564 5f46 6c61 6720  Imbalanced_Flag 
+00005620: 3d20 5472 7565 2069 6e20 6172 6775 6d65  = True in argume
+00005630: 6e74 733c 2f6c 693e 0d0a 3c6c 693e 4665  nts</li>..<li>Fe
+00005640: 6174 7572 6520 5365 6c65 6374 696f 6e20  ature Selection 
+00005650: 2d3e 2057 6520 7573 6520 7468 6520 7361  -> We use the sa
+00005660: 6d65 2061 6c67 6f72 6974 686d 2074 6861  me algorithm tha
+00005670: 7420 6665 6174 7572 6577 697a 206c 6962  t featurewiz lib
+00005680: 7261 7279 2075 7365 733a 2053 554c 4f56  rary uses: SULOV
+00005690: 2061 6e64 2052 6563 7572 7369 7665 2058   and Recursive X
+000056a0: 4742 6f6f 7374 2074 6f20 7365 6c65 6374  GBoost to select
+000056b0: 2062 6573 7420 6665 6174 7572 6573 2066   best features f
+000056c0: 6173 742e 2053 6565 2062 656c 6f77 2e3c  ast. See below.<
+000056d0: 2f6c 693e 0d0a 3c2f 756c 3e0d 0a0d 0a23  /li>..</ul>....#
+000056e0: 2320 5461 626c 6520 6f66 2043 6f6e 7465  # Table of Conte
+000056f0: 6e74 730d 0a3c 756c 3e0d 0a3c 6c69 3e3c  nts..<ul>..<li><
+00005700: 6120 6872 6566 3d22 2362 6163 6b67 726f  a href="#backgro
+00005710: 756e 6422 3e42 6163 6b67 726f 756e 643c  und">Background<
+00005720: 2f61 3e3c 2f6c 693e 0d0a 3c6c 693e 3c61  /a></li>..<li><a
+00005730: 2068 7265 663d 2223 696e 7374 616c 6c22   href="#install"
+00005740: 3e49 6e73 7461 6c6c 3c2f 613e 3c2f 6c69  >Install</a></li
+00005750: 3e0d 0a3c 6c69 3e3c 6120 6872 6566 3d22  >..<li><a href="
+00005760: 2375 7361 6765 223e 5573 6167 653c 2f61  #usage">Usage</a
+00005770: 3e3c 2f6c 693e 0d0a 3c6c 693e 3c61 2068  ></li>..<li><a h
+00005780: 7265 663d 2223 7469 7073 2d66 6f72 2d75  ref="#tips-for-u
+00005790: 7369 6e67 2d61 7574 6f5f 7669 6d6c 223e  sing-auto_viml">
+000057a0: 5469 7073 2066 6f72 2075 7369 6e67 2041  Tips for using A
+000057b0: 7574 6f5f 5669 4d4c 3c2f 613e 3c2f 6c69  uto_ViML</a></li
+000057c0: 3e0d 0a3c 6c69 3e3c 6120 6872 6566 3d22  >..<li><a href="
+000057d0: 2361 7069 223e 4150 493c 2f61 3e3c 2f6c  #api">API</a></l
+000057e0: 693e 0d0a 3c6c 693e 3c61 2068 7265 663d  i>..<li><a href=
+000057f0: 2223 6d61 696e 7461 696e 6572 7322 3e4d  "#maintainers">M
+00005800: 6169 6e74 6169 6e65 7273 3c2f 613e 3c2f  aintainers</a></
+00005810: 6c69 3e0d 0a3c 6c69 3e3c 6120 6872 6566  li>..<li><a href
+00005820: 3d22 2363 6f6e 7472 6962 7574 696e 6722  ="#contributing"
+00005830: 3e43 6f6e 7472 6962 7574 696e 673c 2f61  >Contributing</a
+00005840: 3e3c 2f6c 693e 0d0a 3c6c 693e 3c61 2068  ></li>..<li><a h
+00005850: 7265 663d 2223 6c69 6365 6e73 6522 3e4c  ref="#license">L
+00005860: 6963 656e 7365 3c2f 613e 3c2f 6c69 3e0d  icense</a></li>.
+00005870: 0a3c 2f75 6c3e 0d0a 0d0a 2323 2042 6163  .</ul>....## Bac
+00005880: 6b67 726f 756e 640d 0a3c 703e 5265 6164  kground..<p>Read
+00005890: 2074 6869 7320 3c61 2068 7265 663d 2268   this <a href="h
+000058a0: 7474 7073 3a2f 2f74 6f77 6172 6473 6461  ttps://towardsda
+000058b0: 7461 7363 6965 6e63 652e 636f 6d2f 7768  tascience.com/wh
+000058c0: 792d 6175 746f 6d6c 2d69 732d 616e 2d65  y-automl-is-an-e
+000058d0: 7373 656e 7469 616c 2d6e 6577 2d74 6f6f  ssential-new-too
+000058e0: 6c2d 666f 722d 6461 7461 2d73 6369 656e  l-for-data-scien
+000058f0: 7469 7374 732d 3264 3961 6234 6532 3565  tists-2d9ab4e25e
+00005900: 3436 223e 4d65 6469 756d 2061 7274 6963  46">Medium artic
+00005910: 6c65 2074 6f20 6c65 6172 6e20 686f 7720  le to learn how 
+00005920: 746f 2075 7365 2041 7574 6f5f 5669 4d4c  to use Auto_ViML
+00005930: 2065 6666 6563 7469 7665 6c79 2e3c 2f61   effectively.</a
+00005940: 3e0d 0a0d 0a3c 703e 4175 746f 5f56 694d  >....<p>Auto_ViM
+00005950: 4c20 7761 7320 6465 7369 676e 6564 2066  L was designed f
+00005960: 6f72 2062 7569 6c64 696e 6720 4869 6768  or building High
+00005970: 2050 6572 666f 726d 616e 6365 2049 6e74   Performance Int
+00005980: 6572 7072 6574 6162 6c65 204d 6f64 656c  erpretable Model
+00005990: 7320 7769 7468 2074 6865 2066 6577 6573  s with the fewes
+000059a0: 7420 7661 7269 6162 6c65 7320 6e65 6564  t variables need
+000059b0: 6564 2e0d 0a54 6865 2022 5622 2069 6e20  ed...The "V" in 
+000059c0: 4175 746f 5f56 694d 4c20 7374 616e 6473  Auto_ViML stands
+000059d0: 2066 6f72 2056 6172 6961 6e74 2062 6563   for Variant bec
+000059e0: 6175 7365 2069 7420 7472 6965 7320 6d75  ause it tries mu
+000059f0: 6c74 6970 6c65 206d 6f64 656c 7320 7769  ltiple models wi
+00005a00: 7468 206d 756c 7469 706c 6520 6665 6174  th multiple feat
+00005a10: 7572 6573 2074 6f20 6669 6e64 2079 6f75  ures to find you
+00005a20: 2074 6865 2062 6573 7420 7065 7266 6f72   the best perfor
+00005a30: 6d69 6e67 206d 6f64 656c 2066 6f72 2079  ming model for y
+00005a40: 6f75 7220 6461 7461 7365 742e 2054 6865  our dataset. The
+00005a50: 2022 6922 2069 6e20 4175 746f 5f56 694d   "i" in Auto_ViM
+00005a60: 4c20 7374 616e 6473 2066 6f72 2022 696e  L stands for "in
+00005a70: 7465 7270 7265 7461 626c 6522 2073 696e  terpretable" sin
+00005a80: 6365 2041 7574 6f5f 5669 4d4c 2073 656c  ce Auto_ViML sel
+00005a90: 6563 7473 2074 6865 206c 6561 7374 206e  ects the least n
+00005aa0: 756d 6265 7220 6f66 2066 6561 7475 7265  umber of feature
+00005ab0: 7320 6e65 6365 7373 6172 7920 746f 2062  s necessary to b
+00005ac0: 7569 6c64 2061 2073 696d 706c 6572 2c20  uild a simpler, 
+00005ad0: 6d6f 7265 2069 6e74 6572 7072 6574 6162  more interpretab
+00005ae0: 6c65 206d 6f64 656c 2e20 496e 206d 6f73  le model. In mos
+00005af0: 7420 6361 7365 732c 2041 7574 6f5f 5669  t cases, Auto_Vi
+00005b00: 4d4c 2062 7569 6c64 7320 6d6f 6465 6c73  ML builds models
+00005b10: 2077 6974 6820 3230 252d 3939 2520 6665   with 20%-99% fe
+00005b20: 7765 7220 6665 6174 7572 6573 2074 6861  wer features tha
+00005b30: 6e20 6120 7369 6d69 6c61 7220 7065 7266  n a similar perf
+00005b40: 6f72 6d69 6e67 206d 6f64 656c 2077 6974  orming model wit
+00005b50: 6820 616c 6c20 696e 636c 7564 6564 2066  h all included f
+00005b60: 6561 7475 7265 7320 2874 6869 7320 6973  eatures (this is
+00005b70: 2062 6173 6564 206f 6e20 6d79 2074 7269   based on my tri
+00005b80: 616c 732e 2059 6f75 7220 6578 7065 7269  als. Your experi
+00005b90: 656e 6365 206d 6179 2076 6172 7929 2e3c  ence may vary).<
+00005ba0: 6272 3e0d 0a3c 703e 0d0a 4175 746f 5f56  br>..<p>..Auto_V
+00005bb0: 694d 4c20 6973 2065 7665 7279 2044 6174  iML is every Dat
+00005bc0: 6120 5363 6965 6e74 6973 7427 7320 6d6f  a Scientist's mo
+00005bd0: 6465 6c20 6163 6365 6c65 7261 746f 7220  del accelerator 
+00005be0: 746f 6f6c 2074 6861 743a 3c6f 6c3e 0d0a  tool that:<ol>..
+00005bf0: 3c6c 693e 3c62 3e48 656c 7073 2079 6f75  <li><b>Helps you
+00005c00: 2077 6974 6820 6461 7461 2063 6c65 616e   with data clean
+00005c10: 696e 673c 2f62 3e3a 2079 6f75 2063 616e  ing</b>: you can
+00005c20: 2073 656e 6420 696e 2079 6f75 7220 656e   send in your en
+00005c30: 7469 7265 2064 6174 6166 7261 6d65 2061  tire dataframe a
+00005c40: 7320 6973 2061 6e64 2041 7574 6f5f 5669  s is and Auto_Vi
+00005c50: 4d4c 2077 696c 6c20 7375 6767 6573 7420  ML will suggest 
+00005c60: 6368 616e 6765 7320 746f 2068 656c 7020  changes to help 
+00005c70: 7769 7468 206d 6973 7369 6e67 2076 616c  with missing val
+00005c80: 7565 732c 2066 6f72 6d61 7474 696e 6720  ues, formatting 
+00005c90: 7661 7269 6162 6c65 732c 2061 6464 696e  variables, addin
+00005ca0: 6720 7661 7269 6162 6c65 732c 2065 7463  g variables, etc
+00005cb0: 2e20 4974 206c 6f76 6573 2064 6972 7479  . It loves dirty
+00005cc0: 2064 6174 612e 2054 6865 2064 6972 7469   data. The dirti
+00005cd0: 6572 2074 6865 2062 6574 7465 7221 3c62  er the better!<b
+00005ce0: 723e 0d0a 3c6c 693e 3c62 3e50 6572 666f  r>..<li><b>Perfo
+00005cf0: 726d 7320 4665 6174 7572 6520 5365 6c65  rms Feature Sele
+00005d00: 6374 696f 6e3c 2f62 3e3a 2041 7574 6f5f  ction</b>: Auto_
+00005d10: 5669 4d4c 2073 656c 6563 7473 2076 6172  ViML selects var
+00005d20: 6961 626c 6573 2061 7574 6f6d 6174 6963  iables automatic
+00005d30: 616c 6c79 2062 7920 6465 6661 756c 742e  ally by default.
+00005d40: 2054 6869 7320 6973 2076 6572 7920 6865   This is very he
+00005d50: 6c70 6675 6c20 7768 656e 2079 6f75 2068  lpful when you h
+00005d60: 6176 6520 6875 6e64 7265 6473 2069 6620  ave hundreds if 
+00005d70: 6e6f 7420 7468 6f75 7361 6e64 7320 6f66  not thousands of
+00005d80: 2076 6172 6961 626c 6573 2073 696e 6365   variables since
+00005d90: 2069 7420 6361 6e20 7265 6164 696c 7920   it can readily 
+00005da0: 6964 656e 7469 6679 2077 6869 6368 206f  identify which o
+00005db0: 6620 7468 6f73 6520 6172 6520 696d 706f  f those are impo
+00005dc0: 7274 616e 7420 7661 7269 6162 6c65 7320  rtant variables 
+00005dd0: 7673 2077 6869 6368 2061 7265 2075 6e6e  vs which are unn
+00005de0: 6563 6573 7361 7279 2e20 596f 7520 6361  ecessary. You ca
+00005df0: 6e20 7475 726e 2074 6869 7320 6f66 6620  n turn this off 
+00005e00: 6173 2077 656c 6c20 2873 6565 2041 5049  as well (see API
+00005e10: 292e 3c62 723e 0d0a 0d0a 215b 7867 626f  ).<br>....![xgbo
+00005e20: 6f73 745d 2873 756c 6f76 5f78 6762 6f6f  ost](sulov_xgboo
+00005e30: 7374 2e70 6e67 290d 0a3c 6c69 3e3c 623e  st.png)..<li><b>
+00005e40: 5265 6d6f 7665 7320 6869 6768 6c79 2063  Removes highly c
+00005e50: 6f72 7265 6c61 7465 6420 6665 6174 7572  orrelated featur
+00005e60: 6573 2061 7574 6f6d 6174 6963 616c 6c79  es automatically
+00005e70: 3c2f 623e 2e20 4966 2074 776f 2076 6172  </b>. If two var
+00005e80: 6961 626c 6573 2061 7265 2068 6967 686c  iables are highl
+00005e90: 7920 636f 7272 656c 6174 6564 2069 6e20  y correlated in 
+00005ea0: 796f 7572 2064 6174 6173 6574 2c20 7768  your dataset, wh
+00005eb0: 6963 6820 6f6e 6520 7368 6f75 6c64 2079  ich one should y
+00005ec0: 6f75 2072 656d 6f76 6520 616e 6420 7768  ou remove and wh
+00005ed0: 6963 6820 6f6e 6520 7368 6f75 6c64 2079  ich one should y
+00005ee0: 6f75 206b 6565 703f 2054 6865 2064 6563  ou keep? The dec
+00005ef0: 6973 696f 6e20 6973 206e 6f74 2061 7320  ision is not as 
+00005f00: 6561 7379 2061 7320 6974 206c 6f6f 6b73  easy as it looks
+00005f10: 2e20 4175 746f 5f56 694d 4c20 7573 6573  . Auto_ViML uses
+00005f20: 2074 6865 2053 554c 4f56 2061 6c67 6f72   the SULOV algor
+00005f30: 6974 686d 2074 6f20 7265 6d6f 7665 2068  ithm to remove h
+00005f40: 6967 686c 7920 636f 7272 656c 6174 6564  ighly correlated
+00005f50: 2066 6561 7475 7265 732e 2059 6f75 2063   features. You c
+00005f60: 616e 2075 6e64 6572 7374 616e 6420 5355  an understand SU
+00005f70: 4c4f 5620 6672 6f6d 2074 6869 7320 7069  LOV from this pi
+00005f80: 6374 7572 6520 6d6f 7265 2069 6e74 7569  cture more intui
+00005f90: 7469 7665 6c79 2e3c 6272 3e0d 0a0d 0a21  tively.<br>....!
+00005fa0: 5b73 756c 6f76 5d28 5355 4c4f 562e 6a70  [sulov](SULOV.jp
+00005fb0: 6729 0d0a 0d0a 3c6c 693e 3c62 3e47 656e  g)....<li><b>Gen
+00005fc0: 6572 6174 6573 2070 6572 666f 726d 616e  erates performan
+00005fd0: 6365 2072 6573 756c 7473 2067 7261 7068  ce results graph
+00005fe0: 6963 616c 6c79 3c2f 623e 2e20 4a75 7374  ically</b>. Just
+00005ff0: 2073 6574 2076 6572 626f 7365 203d 2031   set verbose = 1
+00006000: 2028 6f72 2920 3220 696e 7374 6561 6420   (or) 2 instead 
+00006010: 6f66 2030 2028 7369 6c65 6e74 292e 2059  of 0 (silent). Y
+00006020: 6f75 2077 696c 6c20 6765 7420 6869 6768  ou will get high
+00006030: 6572 2071 7561 6c69 7479 206f 6620 696e  er quality of in
+00006040: 7369 6768 7473 2061 7320 796f 7520 696e  sights as you in
+00006050: 6372 6561 7365 2076 6572 626f 7369 7479  crease verbosity
+00006060: 2e20 3c62 723e 0d0a 3c6c 693e 3c62 3e48  . <br>..<li><b>H
+00006070: 616e 646c 6573 2074 6578 742c 2064 6174  andles text, dat
+00006080: 652d 7469 6d65 2c20 7374 7275 6374 7320  e-time, structs 
+00006090: 286c 6973 7473 2c20 6469 6374 696f 6e61  (lists, dictiona
+000060a0: 7269 6573 292c 206e 756d 6572 6963 2c20  ries), numeric, 
+000060b0: 626f 6f6c 6561 6e2c 2066 6163 746f 7220  boolean, factor 
+000060c0: 616e 6420 6361 7465 676f 7269 6361 6c3c  and categorical<
+000060d0: 2f62 3e20 7661 7269 6162 6c65 7320 616c  /b> variables al
+000060e0: 6c20 696e 206f 6e65 206d 6f64 656c 2075  l in one model u
+000060f0: 7369 6e67 206f 6e65 2073 7472 6169 6768  sing one straigh
+00006100: 7420 7072 6f63 6573 732e 3c62 723e 0d0a  t process.<br>..
+00006110: 3c2f 6f6c 3e0d 0a41 7574 6f5f 5669 4d4c  </ol>..Auto_ViML
+00006120: 2069 7320 6275 696c 7420 7573 696e 6720   is built using 
+00006130: 7363 696b 6974 2d6c 6561 726e 2c20 6e75  scikit-learn, nu
+00006140: 6d70 792c 2070 616e 6461 7320 616e 6420  mpy, pandas and 
+00006150: 6d61 7470 6c6f 746c 6962 2e20 4974 2073  matplotlib. It s
+00006160: 686f 756c 6420 7275 6e20 6f6e 206d 6f73  hould run on mos
+00006170: 7420 5079 7468 6f6e 2033 2041 6e61 636f  t Python 3 Anaco
+00006180: 6e64 6120 696e 7374 616c 6c61 7469 6f6e  nda installation
+00006190: 732e 2059 6f75 2077 6f6e 2774 2068 6176  s. You won't hav
+000061a0: 6520 746f 2069 6d70 6f72 7420 616e 7920  e to import any 
+000061b0: 7370 6563 6961 6c20 6c69 6272 6172 6965  special librarie
+000061c0: 7320 6f74 6865 7220 7468 616e 2022 5847  s other than "XG
+000061d0: 426f 6f73 7422 2c20 2249 6d62 616c 616e  Boost", "Imbalan
+000061e0: 6365 642d 4c65 6172 6e22 2c20 2243 6174  ced-Learn", "Cat
+000061f0: 426f 6f73 7422 2c20 616e 6420 2266 6561  Boost", and "fea
+00006200: 7475 7265 746f 6f6c 7322 206c 6962 7261  turetools" libra
+00006210: 7279 2e20 5765 2075 7365 2022 5348 4150  ry. We use "SHAP
+00006220: 2220 6c69 6272 6172 7920 666f 7220 696e  " library for in
+00006230: 7465 7270 7265 7461 6269 6c69 7479 2e20  terpretability. 
+00006240: 3c62 723e 4275 7420 6966 2079 6f75 2064  <br>But if you d
+00006250: 6f6e 2774 2068 6176 6520 7468 6573 6520  on't have these 
+00006260: 6c69 6272 6172 6965 732c 2041 7574 6f5f  libraries, Auto_
+00006270: 5669 4d4c 2077 696c 6c20 696e 7374 616c  ViML will instal
+00006280: 6c20 7468 6f73 6520 666f 7220 796f 7520  l those for you 
+00006290: 6175 746f 6d61 7469 6361 6c6c 792e 0d0a  automatically...
+000062a0: 0d0a 2323 2049 6e73 7461 6c6c 0d0a 0d0a  ..## Install....
+000062b0: 2a2a 5072 6572 6571 7573 6974 6573 3a2a  **Prerequsites:*
+000062c0: 2a0d 0a0d 0a2d 205b 416e 6163 6f6e 6461  *....- [Anaconda
+000062d0: 5d28 6874 7470 733a 2f2f 646f 6373 2e61  ](https://docs.a
+000062e0: 6e61 636f 6e64 612e 636f 6d2f 616e 6163  naconda.com/anac
+000062f0: 6f6e 6461 2f69 6e73 7461 6c6c 2f29 0d0a  onda/install/)..
+00006300: 0d0a 546f 2063 6c6f 6e65 2041 7574 6f5f  ..To clone Auto_
+00006310: 5669 4d4c 2c20 6974 2069 7320 6265 7474  ViML, it is bett
+00006320: 6572 2074 6f20 6372 6561 7465 2061 206e  er to create a n
+00006330: 6577 2065 6e76 6972 6f6e 6d65 6e74 2c20  ew environment, 
+00006340: 616e 6420 696e 7374 616c 6c20 7468 6520  and install the 
+00006350: 7265 7175 6972 6564 2064 6570 656e 6465  required depende
+00006360: 6e63 6965 733a 0d0a 0d0a 546f 2069 6e73  ncies:....To ins
+00006370: 7461 6c6c 2066 726f 6d20 5079 5069 3a0d  tall from PyPi:.
+00006380: 0a3c 703e 0d0a 3c63 6f64 653e 2420 7069  .<p>..<code>$ pi
+00006390: 7020 696e 7374 616c 6c20 6175 746f 7669  p install autovi
+000063a0: 6d6c 202d 2d75 7067 7261 6465 202d 2d69  ml --upgrade --i
+000063b0: 676e 6f72 652d 696e 7374 616c 6c65 643c  gnore-installed<
+000063c0: 2f63 6f64 653e 3c62 723e 0d0a 6f72 0d0a  /code><br>..or..
+000063d0: 0d0a 6060 600d 0a70 6970 2069 6e73 7461  ..```..pip insta
+000063e0: 6c6c 2067 6974 2b68 7474 7073 3a2f 2f67  ll git+https://g
+000063f0: 6974 6875 622e 636f 6d2f 4175 746f 5669  ithub.com/AutoVi
+00006400: 4d4c 2f41 7574 6f5f 5669 4d4c 2e67 6974  ML/Auto_ViML.git
+00006410: 0d0a 6060 600d 0a0d 0a54 6f20 696e 7374  ..```....To inst
+00006420: 616c 6c20 6672 6f6d 2073 6f75 7263 653a  all from source:
+00006430: 0d0a 0d0a 6060 600d 0a63 6420 3c41 7574  ....```..cd <Aut
+00006440: 6f56 494d 4c5f 4465 7374 696e 6174 696f  oVIML_Destinatio
+00006450: 6e3e 0d0a 6769 7420 636c 6f6e 6520 6769  n>..git clone gi
+00006460: 7440 6769 7468 7562 2e63 6f6d 3a41 7574  t@github.com:Aut
+00006470: 6f56 694d 4c2f 4175 746f 5f56 694d 4c2e  oViML/Auto_ViML.
+00006480: 6769 740d 0a23 206f 7220 646f 776e 6c6f  git..# or downlo
+00006490: 6164 2061 6e64 2075 6e7a 6970 2068 7474  ad and unzip htt
+000064a0: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
+000064b0: 4175 746f 5669 4d4c 2f41 7574 6f5f 5669  AutoViML/Auto_Vi
+000064c0: 4d4c 2f61 7263 6869 7665 2f6d 6173 7465  ML/archive/maste
+000064d0: 722e 7a69 700d 0a63 6f6e 6461 2063 7265  r.zip..conda cre
+000064e0: 6174 6520 2d6e 203c 796f 7572 5f65 6e76  ate -n <your_env
+000064f0: 5f6e 616d 653e 2070 7974 686f 6e3d 332e  _name> python=3.
+00006500: 3720 616e 6163 6f6e 6461 0d0a 636f 6e64  7 anaconda..cond
+00006510: 6120 6163 7469 7661 7465 203c 796f 7572  a activate <your
+00006520: 5f65 6e76 5f6e 616d 653e 2023 204f 4e20  _env_name> # ON 
+00006530: 5749 4e44 4f57 533a 2060 736f 7572 6365  WINDOWS: `source
+00006540: 2061 6374 6976 6174 6520 3c79 6f75 725f   activate <your_
+00006550: 656e 765f 6e61 6d65 3e60 0d0a 6364 2041  env_name>`..cd A
+00006560: 7574 6f5f 5669 4d4c 0d0a 7069 7020 696e  uto_ViML..pip in
+00006570: 7374 616c 6c20 2d72 2072 6571 7569 7265  stall -r require
+00006580: 6d65 6e74 732e 7478 740d 0a60 6060 0d0a  ments.txt..```..
+00006590: 0d0a 2323 2055 7361 6765 0d0a 0d0a 496e  ..## Usage....In
+000065a0: 2074 6865 2073 616d 6520 6469 7265 6374   the same direct
+000065b0: 6f72 792c 206f 7065 6e20 6120 4a75 7079  ory, open a Jupy
+000065c0: 7465 7220 4e6f 7465 626f 6f6b 2061 6e64  ter Notebook and
+000065d0: 2075 7365 2074 6869 7320 6c69 6e65 2074   use this line t
+000065e0: 6f20 696d 706f 7274 2074 6865 202e 7079  o import the .py
+000065f0: 2066 696c 653a 0d0a 0d0a 6060 600d 0a66   file:....```..f
+00006600: 726f 6d20 6175 746f 7669 6d6c 2e41 7574  rom autoviml.Aut
+00006610: 6f5f 5669 4d4c 2069 6d70 6f72 7420 4175  o_ViML import Au
+00006620: 746f 5f56 694d 4c0d 0a60 6060 0d0a 0d0a  to_ViML..```....
+00006630: 4c6f 6164 2061 2064 6174 6120 7365 7420  Load a data set 
+00006640: 2861 6e79 2043 5356 206f 7220 7465 7874  (any CSV or text
+00006650: 2066 696c 6529 2069 6e74 6f20 6120 5061   file) into a Pa
+00006660: 6e64 6173 2064 6174 6166 7261 6d65 2061  ndas dataframe a
+00006670: 6e64 2073 706c 6974 2069 7420 696e 746f  nd split it into
+00006680: 2054 7261 696e 2061 6e64 2054 6573 7420   Train and Test 
+00006690: 6461 7461 6672 616d 6573 2e20 4966 2079  dataframes. If y
+000066a0: 6f75 2064 6f6e 2774 2068 6176 6520 6120  ou don't have a 
+000066b0: 7465 7374 2064 6174 6166 7261 6d65 2c20  test dataframe, 
+000066c0: 796f 7520 6361 6e20 7369 6d70 6c65 2061  you can simple a
+000066d0: 7373 6967 6e20 7468 6520 7465 7374 2076  ssign the test v
+000066e0: 6172 6961 626c 6520 6265 6c6f 7720 746f  ariable below to
+000066f0: 2027 2720 2865 6d70 7479 2073 7472 696e   '' (empty strin
+00006700: 6729 3a0d 0a0d 0a60 6060 0d0a 6d6f 6465  g):....```..mode
+00006710: 6c2c 2066 6561 7475 7265 732c 2074 7261  l, features, tra
+00006720: 696e 6d2c 2074 6573 746d 203d 2041 7574  inm, testm = Aut
+00006730: 6f5f 5669 4d4c 280d 0a20 2020 2074 7261  o_ViML(..    tra
+00006740: 696e 2c0d 0a20 2020 2074 6172 6765 742c  in,..    target,
+00006750: 0d0a 2020 2020 7465 7374 2c0d 0a20 2020  ..    test,..   
+00006760: 2073 616d 706c 655f 7375 626d 6973 7369   sample_submissi
+00006770: 6f6e 2c0d 0a20 2020 2068 7970 6572 5f70  on,..    hyper_p
+00006780: 6172 616d 3d22 4753 222c 0d0a 2020 2020  aram="GS",..    
+00006790: 6665 6174 7572 655f 7265 6475 6374 696f  feature_reductio
+000067a0: 6e3d 5472 7565 2c0d 0a20 2020 2073 636f  n=True,..    sco
+000067b0: 7269 6e67 5f70 6172 616d 6574 6572 3d22  ring_parameter="
+000067c0: 7765 6967 6874 6564 2d66 3122 2c0d 0a20  weighted-f1",.. 
+000067d0: 2020 204b 4d65 616e 735f 4665 6174 7572     KMeans_Featur
+000067e0: 697a 6572 3d46 616c 7365 2c0d 0a20 2020  izer=False,..   
+000067f0: 2042 6f6f 7374 696e 675f 466c 6167 3d46   Boosting_Flag=F
+00006800: 616c 7365 2c0d 0a20 2020 2042 696e 6e69  alse,..    Binni
+00006810: 6e67 5f46 6c61 673d 4661 6c73 652c 0d0a  ng_Flag=False,..
+00006820: 2020 2020 4164 645f 506f 6c79 3d46 616c      Add_Poly=Fal
+00006830: 7365 2c0d 0a20 2020 2053 7461 636b 696e  se,..    Stackin
+00006840: 675f 466c 6167 3d46 616c 7365 2c0d 0a20  g_Flag=False,.. 
+00006850: 2020 2049 6d62 616c 616e 6365 645f 466c     Imbalanced_Fl
+00006860: 6167 3d46 616c 7365 2c0d 0a20 2020 2076  ag=False,..    v
+00006870: 6572 626f 7365 3d30 2c0d 0a29 0d0a 6060  erbose=0,..)..``
+00006880: 600d 0a0d 0a46 696e 616c 6c79 2c20 6974  `....Finally, it
+00006890: 2077 7269 7465 7320 796f 7572 2073 7562   writes your sub
+000068a0: 6d69 7373 696f 6e20 6669 6c65 2074 6f20  mission file to 
+000068b0: 6469 736b 2069 6e20 7468 6520 6375 7272  disk in the curr
+000068c0: 656e 7420 6469 7265 6374 6f72 7920 6361  ent directory ca
+000068d0: 6c6c 6564 2060 6d79 7375 626d 6973 7369  lled `mysubmissi
+000068e0: 6f6e 2e63 7376 602e 0d0a 5468 6973 2073  on.csv`...This s
+000068f0: 7562 6d69 7373 696f 6e20 6669 6c65 2069  ubmission file i
+00006900: 7320 7265 6164 7920 666f 7220 796f 7520  s ready for you 
+00006910: 746f 2073 686f 7720 6974 2063 6c69 656e  to show it clien
+00006920: 7473 206f 7220 7375 626d 6974 2069 7420  ts or submit it 
+00006930: 746f 2063 6f6d 7065 7469 7469 6f6e 732e  to competitions.
+00006940: 0d0a 4966 206e 6f20 7375 626d 6973 7369  ..If no submissi
+00006950: 6f6e 2066 696c 6520 7761 7320 6769 7665  on file was give
+00006960: 6e2c 2062 7574 2061 7320 6c6f 6e67 2061  n, but as long a
+00006970: 7320 796f 7520 6769 7665 2069 7420 6120  s you give it a 
+00006980: 7465 7374 2066 696c 6520 6e61 6d65 2c20  test file name, 
+00006990: 6974 2077 696c 6c20 6372 6561 7465 2061  it will create a
+000069a0: 2073 7562 6d69 7373 696f 6e20 6669 6c65   submission file
+000069b0: 2066 6f72 2079 6f75 206e 616d 6564 2060   for you named `
+000069c0: 6d79 5375 626d 6973 7369 6f6e 2e63 7376  mySubmission.csv
+000069d0: 602e 0d0a 4175 746f 5f56 694d 4c20 776f  `...Auto_ViML wo
+000069e0: 726b 7320 6f6e 2061 6e79 204d 756c 7469  rks on any Multi
+000069f0: 2d43 6c61 7373 2c20 4d75 6c74 692d 4c61  -Class, Multi-La
+00006a00: 6265 6c20 4461 7461 2053 6574 2e20 536f  bel Data Set. So
+00006a10: 2079 6f75 2063 616e 2068 6176 6520 6d61   you can have ma
+00006a20: 6e79 2074 6172 6765 7420 6c61 6265 6c73  ny target labels
+00006a30: 2e0d 0a59 6f75 2064 6f6e 2774 2068 6176  ...You don't hav
+00006a40: 6520 746f 2074 656c 6c20 4175 746f 5f56  e to tell Auto_V
+00006a50: 694d 4c20 7768 6574 6865 7220 6974 2069  iML whether it i
+00006a60: 7320 6120 5265 6772 6573 7369 6f6e 206f  s a Regression o
+00006a70: 7220 436c 6173 7369 6669 6361 7469 6f6e  r Classification
+00006a80: 2070 726f 626c 656d 2e0d 0a0d 0a23 2320   problem.....## 
+00006a90: 5469 7073 2066 6f72 2075 7369 6e67 2041  Tips for using A
+00006aa0: 7574 6f5f 5669 4d4c 3a0d 0a31 2e20 6073  uto_ViML:..1. `s
+00006ab0: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
+00006ac0: 603a 2046 6f72 2043 6c61 7373 6966 6963  `: For Classific
+00006ad0: 6174 696f 6e20 7072 6f62 6c65 6d73 2061  ation problems a
+00006ae0: 6e64 2069 6d62 616c 616e 6365 6420 636c  nd imbalanced cl
+00006af0: 6173 7365 732c 2063 686f 6f73 6520 7363  asses, choose sc
+00006b00: 6f72 696e 675f 7061 7261 6d65 7465 723d  oring_parameter=
+00006b10: 2262 616c 616e 6365 645f 6163 6375 7261  "balanced_accura
+00006b20: 6379 222e 2049 7420 776f 726b 7320 6265  cy". It works be
+00006b30: 7474 6572 2e0d 0a32 2e20 6049 6d62 616c  tter...2. `Imbal
+00006b40: 616e 6365 645f 466c 6167 603a 2046 6f72  anced_Flag`: For
+00006b50: 2049 6d62 616c 616e 6365 6420 436c 6173   Imbalanced Clas
+00006b60: 7365 7320 283c 3525 2073 616d 706c 6573  ses (<5% samples
+00006b70: 2069 6e20 7261 7265 2063 6c61 7373 292c   in rare class),
+00006b80: 2063 686f 6f73 6520 2249 6d62 616c 616e   choose "Imbalan
+00006b90: 6365 645f 466c 6167 223d 5472 7565 2e20  ced_Flag"=True. 
+00006ba0: 596f 7520 6361 6e20 616c 736f 2073 6574  You can also set
+00006bb0: 2074 6869 7320 666c 6167 2074 6f20 5472   this flag to Tr
+00006bc0: 7565 2066 6f72 2052 6567 7265 7373 696f  ue for Regressio
+00006bd0: 6e20 7072 6f62 6c65 6d73 2077 6865 7265  n problems where
+00006be0: 2074 6865 2074 6172 6765 7420 7661 7269   the target vari
+00006bf0: 6162 6c65 206d 6967 6874 2068 6176 6520  able might have 
+00006c00: 736b 6577 6564 2064 6973 7472 6962 7574  skewed distribut
+00006c10: 696f 6e73 2e0d 0a33 2e20 6074 6172 6765  ions...3. `targe
+00006c20: 7460 3a20 466f 7220 4d75 6c74 692d 4c61  t`: For Multi-La
+00006c30: 6265 6c20 6461 7461 7365 742c 2074 6865  bel dataset, the
+00006c40: 2074 6172 6765 7420 696e 7075 7420 7461   target input ta
+00006c50: 7267 6574 2076 6172 6961 626c 6520 6361  rget variable ca
+00006c60: 6e20 6265 2073 656e 7420 696e 2061 7320  n be sent in as 
+00006c70: 6120 6c69 7374 206f 6620 7661 7269 6162  a list of variab
+00006c80: 6c65 732e 0d0a 342e 2060 426f 6f73 7469  les...4. `Boosti
+00006c90: 6e67 5f46 6c61 6760 3a20 4974 2069 7320  ng_Flag`: It is 
+00006ca0: 7265 636f 6d6d 656e 6465 6420 7468 6174  recommended that
+00006cb0: 2079 6f75 2066 6972 7374 2073 6574 2042   you first set B
+00006cc0: 6f6f 7374 696e 675f 466c 6167 3d4e 6f6e  oosting_Flag=Non
+00006cd0: 6520 746f 2067 6574 2061 204c 696e 6561  e to get a Linea
+00006ce0: 7220 6d6f 6465 6c2e 204f 6e63 6520 796f  r model. Once yo
+00006cf0: 7520 756e 6465 7273 7461 6e64 2074 6861  u understand tha
+00006d00: 742c 2074 6865 6e20 796f 7520 6361 6e20  t, then you can 
+00006d10: 7472 7920 746f 2073 6574 2042 6f6f 7374  try to set Boost
+00006d20: 696e 675f 466c 6167 3d46 616c 7365 2074  ing_Flag=False t
+00006d30: 6f20 6765 7420 6120 5261 6e64 6f6d 2046  o get a Random F
+00006d40: 6f72 6573 7420 6d6f 6465 6c2e 2046 696e  orest model. Fin
+00006d50: 616c 6c79 2c20 7472 7920 426f 6f73 7469  ally, try Boosti
+00006d60: 6e67 5f46 6c61 673d 5472 7565 2074 6f20  ng_Flag=True to 
+00006d70: 6765 7420 616e 2058 4742 6f6f 7374 206d  get an XGBoost m
+00006d80: 6f64 656c 2e20 5468 6973 2069 7320 7468  odel. This is th
+00006d90: 6520 6f72 6465 7220 7468 6174 2077 6520  e order that we 
+00006da0: 7265 636f 6d6d 656e 6420 696e 206f 7264  recommend in ord
+00006db0: 6572 2074 6f20 7573 6520 4175 746f 5f56  er to use Auto_V
+00006dc0: 694d 4c2e 2046 696e 616c 6c79 2074 7279  iML. Finally try
+00006dd0: 2042 6f6f 7374 696e 675f 466c 6167 3d22   Boosting_Flag="
+00006de0: 4361 7442 6f6f 7374 2220 746f 2067 6574  CatBoost" to get
+00006df0: 2061 2063 6f6d 706c 6578 2062 7574 2068   a complex but h
+00006e00: 6967 6820 7065 7266 6f72 6d69 6e67 206d  igh performing m
+00006e10: 6f64 656c 2e0d 0a35 2e20 6042 696e 6e69  odel...5. `Binni
+00006e20: 6e67 5f46 6c61 6760 3a20 4269 6e6e 696e  ng_Flag`: Binnin
+00006e30: 675f 466c 6167 3d54 7275 6520 696d 7072  g_Flag=True impr
+00006e40: 6f76 6573 2061 2043 6174 426f 6f73 7420  oves a CatBoost 
+00006e50: 6d6f 6465 6c20 7369 6e63 6520 6974 2061  model since it a
+00006e60: 6464 7320 746f 2074 6865 206c 6973 7420  dds to the list 
+00006e70: 6f66 2063 6174 6567 6f72 6963 616c 2076  of categorical v
+00006e80: 6172 7320 696e 2064 6174 610d 0a36 2e20  ars in data..6. 
+00006e90: 604b 4d65 616e 735f 6665 6174 7572 697a  `KMeans_featuriz
+00006ea0: 6572 603a 204b 4d65 616e 735f 6665 6174  er`: KMeans_feat
+00006eb0: 7572 697a 6572 3d54 7275 6520 776f 726b  urizer=True work
+00006ec0: 7320 7765 6c6c 2069 6e20 4e4c 5020 616e  s well in NLP an
+00006ed0: 6420 4361 7442 6f6f 7374 206d 6f64 656c  d CatBoost model
+00006ee0: 7320 7369 6e63 6520 6974 2063 7265 6174  s since it creat
+00006ef0: 6573 2063 6c75 7374 6572 2076 6172 6961  es cluster varia
+00006f00: 626c 6573 0d0a 372e 2060 4164 645f 506f  bles..7. `Add_Po
+00006f10: 6c79 603a 2041 6464 5f50 6f6c 793d 3320  ly`: Add_Poly=3 
+00006f20: 696d 7072 6f76 6573 2063 6572 7461 696e  improves certain
+00006f30: 206d 6f64 656c 7320 7768 6572 6520 7468   models where th
+00006f40: 6572 6520 6973 2064 6174 652d 7469 6d65  ere is date-time
+00006f50: 206f 7220 6361 7465 676f 7269 6361 6c20   or categorical 
+00006f60: 616e 6420 6e75 6d65 7269 6320 7661 7269  and numeric vari
+00006f70: 6162 6c65 730d 0a38 2e20 6066 6561 7475  ables..8. `featu
+00006f80: 7265 5f72 6564 7563 7469 6f6e 603a 2066  re_reduction`: f
+00006f90: 6561 7475 7265 5f72 6564 7563 7469 6f6e  eature_reduction
+00006fa0: 3d54 7275 6520 6973 2074 6865 2064 6566  =True is the def
+00006fb0: 6175 6c74 2061 6e64 2077 6f72 6b73 2062  ault and works b
+00006fc0: 6573 742e 2042 7574 2077 6865 6e20 796f  est. But when yo
+00006fd0: 7520 6861 7665 203c 3130 2066 6561 7475  u have <10 featu
+00006fe0: 7265 7320 696e 2064 6174 612c 2073 6574  res in data, set
+00006ff0: 2069 7420 746f 2046 616c 7365 0d0a 392e   it to False..9.
+00007000: 2060 5374 6163 6b69 6e67 5f46 6c61 6760   `Stacking_Flag`
+00007010: 3a20 446f 206e 6f74 2073 6574 2053 7461  : Do not set Sta
+00007020: 636b 696e 675f 466c 6167 3d54 7275 6520  cking_Flag=True 
+00007030: 7769 7468 204c 696e 6561 7220 6d6f 6465  with Linear mode
+00007040: 6c73 2073 696e 6365 2079 6f75 7220 7265  ls since your re
+00007050: 7375 6c74 7320 6d61 7920 6e6f 7420 6c6f  sults may not lo
+00007060: 6f6b 2067 7265 6174 2e0d 0a31 302e 2060  ok great...10. `
+00007070: 5374 6163 6b69 6e67 5f46 6c61 6760 3a20  Stacking_Flag`: 
+00007080: 5573 6520 5374 6163 6b69 6e67 5f46 6c61  Use Stacking_Fla
+00007090: 673d 5472 7565 206f 6e6c 7920 666f 7220  g=True only for 
+000070a0: 636f 6d70 6c65 7820 6d6f 6465 6c73 2061  complex models a
+000070b0: 6e64 2061 7320 6120 6c61 7374 2073 7465  nd as a last ste
+000070c0: 7020 7769 7468 2042 6f6f 7374 696e 675f  p with Boosting_
+000070d0: 466c 6167 3d54 7275 6520 6f72 2043 6174  Flag=True or Cat
+000070e0: 426f 6f73 740d 0a31 312e 2060 6879 7065  Boost..11. `hype
+000070f0: 725f 7061 7261 6d60 3a20 4c65 6176 6520  r_param`: Leave 
+00007100: 6879 7065 725f 7061 7261 6d20 3d22 5253  hyper_param ="RS
+00007110: 2220 6173 2069 6e70 7574 2073 696e 6365  " as input since
+00007120: 2069 7420 7275 6e73 2066 6173 7465 7220   it runs faster 
+00007130: 7468 616e 2047 7269 6453 6561 7263 6843  than GridSearchC
+00007140: 5620 616e 6420 6769 7665 7320 6265 7474  V and gives bett
+00007150: 6572 2072 6573 756c 7473 2075 6e6c 6573  er results unles
+00007160: 7320 796f 7520 6861 7665 2061 2073 6d61  s you have a sma
+00007170: 6c6c 2064 6174 6120 7365 7420 616e 6420  ll data set and 
+00007180: 6361 6e20 6166 666f 7264 2074 6f20 7370  can afford to sp
+00007190: 656e 6420 7469 6d65 206f 6e20 6879 7065  end time on hype
+000071a0: 7220 7475 6e69 6e67 2e0d 0a31 322e 2060  r tuning...12. `
+000071b0: 4b4d 6561 6e73 5f46 6561 7475 7269 7a65  KMeans_Featurize
+000071c0: 7260 3a20 4b4d 6561 6e73 5f46 6561 7475  r`: KMeans_Featu
+000071d0: 7269 7a65 723d 5472 7565 2064 6f65 7320  rizer=True does 
+000071e0: 6e6f 7420 776f 726b 2077 656c 6c20 666f  not work well fo
+000071f0: 7220 736d 616c 6c20 6461 7461 2073 6574  r small data set
+00007200: 732e 2055 7365 2069 7420 666f 7220 6461  s. Use it for da
+00007210: 7461 2073 6574 7320 3e20 3130 2c30 3030  ta sets > 10,000
+00007220: 2072 6f77 732e 0d0a 3133 2e20 6046 696e   rows...13. `Fin
+00007230: 616c 2074 686f 7567 6874 7360 3a20 4669  al thoughts`: Fi
+00007240: 6e61 6c6c 7920 4175 746f 5f56 694d 4c20  nally Auto_ViML 
+00007250: 6973 206d 6561 6e74 2074 6f20 6265 2061  is meant to be a
+00007260: 2062 6173 656c 696e 6520 6f72 2063 6861   baseline or cha
+00007270: 6c6c 656e 6765 7220 736f 6c75 7469 6f6e  llenger solution
+00007280: 2074 6f20 796f 7572 2064 6174 6120 7365   to your data se
+00007290: 742e 2053 6f20 7573 6520 6974 2066 6f72  t. So use it for
+000072a0: 206d 616b 696e 6720 7175 6963 6b20 6d6f   making quick mo
+000072b0: 6465 6c73 2074 6861 7420 796f 7520 6361  dels that you ca
+000072c0: 6e20 636f 6d70 6172 6520 6167 6169 6e73  n compare agains
+000072d0: 7420 6f72 2069 6e20 4861 636b 6174 686f  t or in Hackatho
+000072e0: 6e73 2e20 4974 2069 7320 6e6f 7420 6d65  ns. It is not me
+000072f0: 616e 7420 666f 7220 7072 6f64 7563 7469  ant for producti
+00007300: 6f6e 210d 0a0d 0a23 2320 4150 490d 0a0d  on!....## API...
+00007310: 0a2a 2a41 7267 756d 656e 7473 2a2a 0d0a  .**Arguments**..
+00007320: 0d0a 2d20 6074 7261 696e 603a 2063 6f75  ..- `train`: cou
+00007330: 6c64 2062 6520 6120 6461 7461 7061 7468  ld be a datapath
+00007340: 2b66 696c 656e 616d 6520 6f72 2061 2064  +filename or a d
+00007350: 6174 6166 7261 6d65 2e20 4974 2077 696c  ataframe. It wil
+00007360: 6c20 6465 7465 6374 2077 6869 6368 2069  l detect which i
+00007370: 7320 7768 6963 6820 616e 6420 6c6f 6164  s which and load
+00007380: 2069 742e 0d0a 2d20 6074 6573 7460 3a20   it...- `test`: 
+00007390: 636f 756c 6420 6265 2061 2064 6174 6170  could be a datap
+000073a0: 6174 682b 6669 6c65 6e61 6d65 206f 7220  ath+filename or 
+000073b0: 6120 6461 7461 6672 616d 652e 2049 6620  a dataframe. If 
+000073c0: 796f 7520 646f 6e27 7420 6861 7665 2061  you don't have a
+000073d0: 6e79 2c20 6a75 7374 206c 6561 7665 2069  ny, just leave i
+000073e0: 7420 6173 2022 222e 0d0a 2d20 6073 7562  t as ""...- `sub
+000073f0: 6d69 7373 696f 6e60 3a20 6d75 7374 2062  mission`: must b
+00007400: 6520 6120 6461 7461 7061 7468 2b66 696c  e a datapath+fil
+00007410: 656e 616d 652e 2049 6620 796f 7520 646f  ename. If you do
+00007420: 6e27 7420 6861 7665 2061 6e79 2c20 6a75  n't have any, ju
+00007430: 7374 206c 6561 7665 2069 7420 6173 2065  st leave it as e
+00007440: 6d70 7479 2073 7472 696e 672e 0d0a 2d20  mpty string...- 
+00007450: 6074 6172 6765 7460 3a20 6e61 6d65 206f  `target`: name o
+00007460: 6620 7468 6520 7461 7267 6574 2076 6172  f the target var
+00007470: 6961 626c 6520 696e 2074 6865 2064 6174  iable in the dat
+00007480: 6120 7365 742e 0d0a 2d20 6073 6570 603a  a set...- `sep`:
+00007490: 2069 6620 796f 7520 6861 7665 2061 2073   if you have a s
+000074a0: 7065 6172 6174 6f72 2069 6e20 7468 6520  pearator in the 
+000074b0: 6669 6c65 2073 7563 6820 6173 2022 2c22  file such as ","
+000074c0: 206f 7220 225c 7422 206d 656e 7469 6f6e   or "\t" mention
+000074d0: 2069 7420 6865 7265 2e20 4465 6661 756c   it here. Defaul
+000074e0: 7420 6973 2022 2c22 2e0d 0a2d 2060 7363  t is ","...- `sc
+000074f0: 6f72 696e 675f 7061 7261 6d65 7465 7260  oring_parameter`
+00007500: 3a20 6966 2079 6f75 2077 616e 7420 796f  : if you want yo
+00007510: 7572 206f 776e 2073 636f 7269 6e67 2070  ur own scoring p
+00007520: 6172 616d 6574 6572 2073 7563 6820 6173  arameter such as
+00007530: 2022 6631 2220 6769 7665 2069 7420 6865   "f1" give it he
+00007540: 7265 2e20 4966 206e 6f74 2c20 6974 2077  re. If not, it w
+00007550: 696c 6c20 6173 7375 6d65 2074 6865 2061  ill assume the a
+00007560: 7070 726f 7072 6961 7465 2073 636f 7269  ppropriate scori
+00007570: 6e67 2070 6172 616d 2066 6f72 2074 6865  ng param for the
+00007580: 2070 726f 626c 656d 2061 6e64 2069 7420   problem and it 
+00007590: 7769 6c6c 2062 7569 6c64 2074 6865 206d  will build the m
+000075a0: 6f64 656c 2e0d 0a2d 2060 6879 7065 725f  odel...- `hyper_
+000075b0: 7061 7261 6d60 3a20 5475 6e69 6e67 206f  param`: Tuning o
+000075c0: 7074 696f 6e73 2061 7265 2047 7269 6453  ptions are GridS
+000075d0: 6561 7263 6820 2827 4753 2729 2061 6e64  earch ('GS') and
+000075e0: 2052 616e 646f 6d69 7a65 6453 6561 7263   RandomizedSearc
+000075f0: 6820 2827 5253 2729 2e20 4465 6661 756c  h ('RS'). Defaul
+00007600: 7420 6973 2027 5253 272e 0d0a 2d20 6066  t is 'RS'...- `f
+00007610: 6561 7475 7265 5f72 6564 7563 7469 6f6e  eature_reduction
+00007620: 603a 2044 6566 6175 6c74 203d 2027 5472  `: Default = 'Tr
+00007630: 7565 2720 6275 7420 6974 2063 616e 2062  ue' but it can b
+00007640: 6520 7365 7420 746f 2046 616c 7365 2069  e set to False i
+00007650: 6620 796f 7520 646f 6e27 7420 7761 6e74  f you don't want
+00007660: 2061 7574 6f6d 6174 6963 2066 6561 7475   automatic featu
+00007670: 7265 5f72 6564 7563 7469 6f6e 2073 696e  re_reduction sin
+00007680: 6365 2069 6e20 496d 6167 6520 6461 7461  ce in Image data
+00007690: 2073 6574 7320 6c69 6b65 2064 6967 6974   sets like digit
+000076a0: 7320 616e 6420 4d4e 4953 542c 2079 6f75  s and MNIST, you
+000076b0: 2067 6574 2062 6574 7465 7220 7265 7375   get better resu
+000076c0: 6c74 7320 7768 656e 2079 6f75 2064 6f6e  lts when you don
+000076d0: 2774 2072 6564 7563 6520 6665 6174 7572  't reduce featur
+000076e0: 6573 2061 7574 6f6d 6174 6963 616c 6c79  es automatically
+000076f0: 2e20 596f 7520 6361 6e20 616c 7761 7973  . You can always
+00007700: 2074 7279 2062 6f74 6820 616e 6420 7365   try both and se
+00007710: 652e 0d0a 2d20 604b 4d65 616e 735f 4665  e...- `KMeans_Fe
+00007720: 6174 7572 697a 6572 600d 0a20 202d 2060  aturizer`..  - `
+00007730: 5472 7565 603a 2041 6464 7320 6120 636c  True`: Adds a cl
+00007740: 7573 7465 7220 6c61 6265 6c20 746f 2066  uster label to f
+00007750: 6561 7475 7265 7320 6261 7365 6420 6f6e  eatures based on
+00007760: 204b 4d65 616e 732e 2055 7365 2066 6f72   KMeans. Use for
+00007770: 204c 696e 6561 722e 0d0a 2020 2d20 6046   Linear...  - `F
+00007780: 616c 7365 2028 6465 6661 756c 7429 6020  alse (default)` 
+00007790: 466f 7220 5261 6e64 6f6d 2046 6f72 6573  For Random Fores
+000077a0: 7473 206f 7220 5847 4220 6d6f 6465 6c73  ts or XGB models
+000077b0: 2c20 6c65 6176 6520 6974 2046 616c 7365  , leave it False
+000077c0: 2073 696e 6365 2069 7420 6d61 7920 6f76   since it may ov
+000077d0: 6572 6669 742e 0d0a 2d20 6042 6f6f 7374  erfit...- `Boost
+000077e0: 696e 6720 466c 6167 603a 2079 6f75 2068  ing Flag`: you h
+000077f0: 6176 6520 3420 706f 7373 6962 6c65 2063  ave 4 possible c
+00007800: 686f 6963 6573 2028 6465 6661 756c 7420  hoices (default 
+00007810: 6973 2046 616c 7365 293a 0d0a 2020 2d20  is False):..  - 
+00007820: 604e 6f6e 6560 2054 6869 7320 7769 6c6c  `None` This will
+00007830: 2062 7569 6c64 2061 204c 696e 6561 7220   build a Linear 
+00007840: 4d6f 6465 6c0d 0a20 202d 2060 4661 6c73  Model..  - `Fals
+00007850: 6560 2054 6869 7320 7769 6c6c 2062 7569  e` This will bui
+00007860: 6c64 2061 2052 616e 646f 6d20 466f 7265  ld a Random Fore
+00007870: 7374 206f 7220 4578 7472 6120 5472 6565  st or Extra Tree
+00007880: 7320 6d6f 6465 6c20 2861 6c73 6f20 6b6e  s model (also kn
+00007890: 6f77 6e20 6173 2042 6167 6769 6e67 290d  own as Bagging).
+000078a0: 0a20 202d 2060 5472 7565 6020 5468 6973  .  - `True` This
+000078b0: 2077 696c 6c20 6275 696c 6420 616e 2058   will build an X
+000078c0: 4742 6f6f 7374 206d 6f64 656c 0d0a 2020  GBoost model..  
+000078d0: 2d20 6043 6174 426f 6f73 7460 2054 6869  - `CatBoost` Thi
+000078e0: 7320 7769 6c6c 2062 7569 6c64 2061 2043  s will build a C
+000078f0: 6174 426f 6f73 7420 6d6f 6465 6c20 2870  atBoost model (p
+00007900: 726f 7669 6465 6420 796f 7520 6861 7665  rovided you have
+00007910: 2043 6174 426f 6f73 7420 696e 7374 616c   CatBoost instal
+00007920: 6c65 6429 0d0a 2d20 6041 6464 5f50 6f6c  led)..- `Add_Pol
+00007930: 7960 3a20 4465 6661 756c 7420 6973 2030  y`: Default is 0
+00007940: 2077 6869 6368 206d 6561 6e73 2064 6f2d   which means do-
+00007950: 6e6f 7468 696e 672e 2042 7574 2069 7420  nothing. But it 
+00007960: 6861 7320 7468 7265 6520 696e 7465 7265  has three intere
+00007970: 7374 696e 6720 7365 7474 696e 6773 3a0d  sting settings:.
+00007980: 0a20 202d 2060 3160 2041 6464 2069 6e74  .  - `1` Add int
+00007990: 6572 6163 7469 6f6e 2076 6172 6961 626c  eraction variabl
+000079a0: 6573 206f 6e6c 7920 7375 6368 2061 7320  es only such as 
+000079b0: 7831 2a78 322c 2078 322a 7833 2c2e 2e2e  x1*x2, x2*x3,...
+000079c0: 7839 5c2a 3130 2065 7463 2e0d 0a20 202d  x9\*10 etc...  -
+000079d0: 2060 3260 2041 6464 2049 6e74 6572 6163   `2` Add Interac
+000079e0: 7469 6f6e 7320 616e 6420 5371 7561 7265  tions and Square
+000079f0: 6420 7661 7269 6162 6c65 7320 7375 6368  d variables such
+00007a00: 2061 7320 7831 2a2a 322c 2078 322a 2a32   as x1**2, x2**2
+00007a10: 2c20 6574 632e 0d0a 2020 2d20 6033 6020  , etc...  - `3` 
+00007a20: 4164 6473 2062 6f74 6820 496e 7465 7261  Adds both Intera
+00007a30: 6374 696f 6e73 2061 6e64 2053 7175 6172  ctions and Squar
+00007a40: 6564 2076 6172 6961 626c 6573 2073 7563  ed variables suc
+00007a50: 6820 6173 2078 312a 7832 2c20 7831 2a2a  h as x1*x2, x1**
+00007a60: 322c 7832 2a78 332c 2078 322a 2a32 2c20  2,x2*x3, x2**2, 
+00007a70: 6574 632e 0d0a 2d20 6053 7461 636b 696e  etc...- `Stackin
+00007a80: 675f 466c 6167 603a 2044 6566 6175 6c74  g_Flag`: Default
+00007a90: 2069 7320 4661 6c73 652e 2049 6620 7365   is False. If se
+00007aa0: 7420 746f 2054 7275 652c 2069 7420 7769  t to True, it wi
+00007ab0: 6c6c 2061 6464 2061 6e20 6164 6469 7469  ll add an additi
+00007ac0: 6f6e 616c 2066 6561 7475 7265 2077 6869  onal feature whi
+00007ad0: 6368 2069 7320 6465 7269 7665 6420 6672  ch is derived fr
+00007ae0: 6f6d 2070 7265 6469 6374 696f 6e73 206f  om predictions o
+00007af0: 6620 616e 6f74 6865 7220 6d6f 6465 6c2e  f another model.
+00007b00: 2054 6869 7320 6973 2075 7365 6420 696e   This is used in
+00007b10: 2073 6f6d 6520 6361 7365 7320 6275 7420   some cases but 
+00007b20: 6d61 7920 7265 7375 6c74 2069 6e20 6f76  may result in ov
+00007b30: 6572 6669 7474 696e 672e 2053 6f20 6265  erfitting. So be
+00007b40: 2063 6172 6566 756c 2074 7572 6e69 6e67   careful turning
+00007b50: 2074 6869 7320 666c 6167 2022 6f6e 222e   this flag "on".
+00007b60: 0d0a 2d20 6042 696e 6e69 6e67 5f46 6c61  ..- `Binning_Fla
+00007b70: 6760 3a20 4465 6661 756c 7420 6973 2046  g`: Default is F
+00007b80: 616c 7365 2e20 4974 2073 6574 2074 6f20  alse. It set to 
+00007b90: 5472 7565 2c20 6974 2077 696c 6c20 636f  True, it will co
+00007ba0: 6e76 6572 7420 7468 6520 746f 7020 6e75  nvert the top nu
+00007bb0: 6d65 7269 6320 7661 7269 6162 6c65 7320  meric variables 
+00007bc0: 696e 746f 2062 696e 6e65 6420 7661 7269  into binned vari
+00007bd0: 6162 6c65 7320 7468 726f 7567 6820 6120  ables through a 
+00007be0: 7465 6368 6e69 7175 6520 6b6e 6f77 6e20  technique known 
+00007bf0: 6173 2022 456e 7472 6f70 7922 2062 696e  as "Entropy" bin
+00007c00: 6e69 6e67 2e20 5468 6973 2069 7320 7665  ning. This is ve
+00007c10: 7279 2068 656c 7066 756c 2066 6f72 2063  ry helpful for c
+00007c20: 6572 7461 696e 2064 6174 6173 6574 7320  ertain datasets 
+00007c30: 2865 7370 6563 6961 6c6c 7920 6861 7264  (especially hard
+00007c40: 2074 6f20 6275 696c 6420 6d6f 6465 6c73   to build models
+00007c50: 292e 0d0a 2d20 6049 6d62 616c 616e 6365  )...- `Imbalance
+00007c60: 645f 466c 6167 603a 2044 6566 6175 6c74  d_Flag`: Default
+00007c70: 2069 7320 4661 6c73 652e 2055 7365 7320   is False. Uses 
+00007c80: 696d 6261 6c61 6e63 6564 5f65 6e73 656d  imbalanced_ensem
+00007c90: 626c 6520 6c69 6272 6172 7920 666f 7220  ble library for 
+00007ca0: 696d 6261 6c61 6e63 6564 2064 6174 612e  imbalanced data.
+00007cb0: 204a 7573 7420 7365 7420 496d 6261 6c61   Just set Imbala
+00007cc0: 6e63 6564 5f46 6c61 6720 3d20 5472 7565  nced_Flag = True
+00007cd0: 2069 6e20 6172 6775 6d65 6e74 730d 0a2d   in arguments..-
+00007ce0: 2060 7665 7262 6f73 6560 3a20 5468 6973   `verbose`: This
+00007cf0: 2068 6173 2033 2070 6f73 7369 626c 6520   has 3 possible 
+00007d00: 7374 6174 6573 3a0d 0a20 202d 2060 3060  states:..  - `0`
+00007d10: 206c 696d 6974 6564 206f 7574 7075 742e   limited output.
+00007d20: 2047 7265 6174 2066 6f72 2072 756e 6e69   Great for runni
+00007d30: 6e67 2074 6869 7320 7369 6c65 6e74 6c79  ng this silently
+00007d40: 2061 6e64 2067 6574 7469 6e67 2066 6173   and getting fas
+00007d50: 7420 7265 7375 6c74 732e 0d0a 2020 2d20  t results...  - 
+00007d60: 6031 6020 6d6f 7265 2063 6861 7274 732e  `1` more charts.
+00007d70: 2047 7265 6174 2066 6f72 206b 6e6f 7769   Great for knowi
+00007d80: 6e67 2068 6f77 2072 6573 756c 7473 2077  ng how results w
+00007d90: 6572 6520 616e 6420 6d61 6b69 6e67 2063  ere and making c
+00007da0: 6861 6e67 6573 2074 6f20 666c 6167 7320  hanges to flags 
+00007db0: 696e 2069 6e70 7574 2e0d 0a20 202d 2060  in input...  - `
+00007dc0: 3260 206c 6f74 7320 6f66 2063 6861 7274  2` lots of chart
+00007dd0: 7320 616e 6420 6f75 7470 7574 2e20 4772  s and output. Gr
+00007de0: 6561 7420 666f 7220 7265 7072 6f64 7563  eat for reproduc
+00007df0: 696e 6720 7768 6174 2041 7574 6f5f 5669  ing what Auto_Vi
+00007e00: 4d4c 2064 6f65 7320 6f6e 2079 6f75 7220  ML does on your 
+00007e10: 6f77 6e2e 0d0a 0d0a 2a2a 5265 7475 726e  own.....**Return
+00007e20: 2076 616c 7565 732a 2a0d 0a0d 0a2d 2060   values**....- `
+00007e30: 6d6f 6465 6c60 3a20 4974 2077 696c 6c20  model`: It will 
+00007e40: 7265 7475 726e 2079 6f75 7220 7472 6169  return your trai
+00007e50: 6e65 6420 6d6f 6465 6c0d 0a2d 2060 6665  ned model..- `fe
+00007e60: 6174 7572 6573 603a 2074 6865 2066 6577  atures`: the few
+00007e70: 6573 7420 6e75 6d62 6572 206f 6620 6665  est number of fe
+00007e80: 6174 7572 6573 2069 6e20 796f 7572 206d  atures in your m
+00007e90: 6f64 656c 2074 6f20 6d61 6b65 2069 7420  odel to make it 
+00007ea0: 7065 7266 6f72 6d20 7765 6c6c 0d0a 2d20  perform well..- 
+00007eb0: 6074 7261 696e 5f6d 6f64 6966 6965 6460  `train_modified`
+00007ec0: 3a20 7468 6973 2069 7320 7468 6520 6d6f  : this is the mo
+00007ed0: 6469 6669 6564 2074 7261 696e 2064 6174  dified train dat
+00007ee0: 6166 7261 6d65 2061 6674 6572 2072 656d  aframe after rem
+00007ef0: 6f76 696e 6720 616e 6420 6164 6469 6e67  oving and adding
+00007f00: 2066 6561 7475 7265 730d 0a2d 2060 7465   features..- `te
+00007f10: 7374 5f6d 6f64 6966 6965 6460 3a20 7468  st_modified`: th
+00007f20: 6973 2069 7320 7468 6520 6d6f 6469 6669  is is the modifi
+00007f30: 6564 2074 6573 7420 6461 7461 6672 616d  ed test datafram
+00007f40: 6520 7769 7468 2074 6865 2073 616d 6520  e with the same 
+00007f50: 7472 616e 7366 6f72 6d61 7469 6f6e 7320  transformations 
+00007f60: 6173 2074 7261 696e 0d0a 0d0a 2323 204d  as train....## M
+00007f70: 6169 6e74 6169 6e65 7273 0d0a 0d0a 2a20  aintainers....* 
+00007f80: 5b40 4175 746f 5669 4d4c 5d28 6874 7470  [@AutoViML](http
+00007f90: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f41  s://github.com/A
+00007fa0: 7574 6f56 694d 4c29 0d0a 2a20 5b40 6d6f  utoViML)..* [@mo
+00007fb0: 7265 6e6f 6831 3439 5d28 6874 7470 733a  renoh149](https:
+00007fc0: 2f2f 6769 7468 7562 2e63 6f6d 2f6d 6f72  //github.com/mor
+00007fd0: 656e 6f68 3134 3929 0d0a 2a20 5b40 6869  enoh149)..* [@hi
+00007fe0: 726f 6e72 6f79 5d28 6874 7470 733a 2f2f  ronroy](https://
+00007ff0: 6769 7468 7562 2e63 6f6d 2f68 6972 6f6e  github.com/hiron
+00008000: 726f 7929 0d0a 0d0a 2323 2043 6f6e 7472  roy)....## Contr
+00008010: 6962 7574 696e 670d 0a0d 0a53 6565 205b  ibuting....See [
+00008020: 7468 6520 636f 6e74 7269 6275 7469 6e67  the contributing
+00008030: 2066 696c 655d 2843 4f4e 5452 4942 5554   file](CONTRIBUT
+00008040: 494e 472e 6d64 2921 0d0a 0d0a 5052 7320  ING.md)!....PRs 
+00008050: 6163 6365 7074 6564 2e0d 0a0d 0a23 2320  accepted.....## 
+00008060: 4c69 6365 6e73 650d 0a0d 0a41 7061 6368  License....Apach
+00008070: 6520 4c69 6365 6e73 6520 322e 3020 c2a9  e License 2.0 ..
+00008080: 2032 3032 3020 5261 6d20 5365 7368 6164   2020 Ram Seshad
+00008090: 7269 0d0a 0d0a 2323 2044 4953 434c 4149  ri....## DISCLAI
+000080a0: 4d45 520d 0a54 6869 7320 7072 6f6a 6563  MER..This projec
+000080b0: 7420 6973 206e 6f74 2061 6e20 6f66 6669  t is not an offi
+000080c0: 6369 616c 2047 6f6f 676c 6520 7072 6f6a  cial Google proj
+000080d0: 6563 742e 2049 7420 6973 206e 6f74 2073  ect. It is not s
+000080e0: 7570 706f 7274 6564 2062 7920 476f 6f67  upported by Goog
+000080f0: 6c65 2061 6e64 2047 6f6f 676c 6520 7370  le and Google sp
+00008100: 6563 6966 6963 616c 6c79 2064 6973 636c  ecifically discl
+00008110: 6169 6d73 2061 6c6c 2077 6172 7261 6e74  aims all warrant
+00008120: 6965 7320 6173 2074 6f20 6974 7320 7175  ies as to its qu
+00008130: 616c 6974 792c 206d 6572 6368 616e 7461  ality, merchanta
+00008140: 6269 6c69 7479 2c20 6f72 2066 6974 6e65  bility, or fitne
+00008150: 7373 2066 6f72 2061 2070 6172 7469 6375  ss for a particu
+00008160: 6c61 7220 7075 7270 6f73 652e 0d0a 0000  lar purpose.....
 00008170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000081a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000081b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000081c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000081d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2106,16 +2106,16 @@
 00008390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008400: 3238 206d 7469 6d65 3d31 3637 3832 3833  28 mtime=1678283
-00008410: 3737 302e 3638 3039 3838 380a 0000 0000  770.6809888.....
+00008400: 3238 206d 7469 6d65 3d31 3638 3139 3033  28 mtime=1681903
+00008410: 3937 382e 3531 3230 3730 370a 0000 0000  978.5120707.....
 00008420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2138,24 +2138,24 @@
 00008590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00008600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00008610: 2f61 7574 6f76 696d 6c2f 0000 0000 0000  /autoviml/......
 00008620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00008670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00008680: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
-00008690: 3030 3000 3031 3437 3530 0020 3500 0000  000.014750. 5...
+00008690: 3030 3000 3031 3437 3531 0020 3500 0000  000.014751. 5...
 000086a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -2234,24 +2234,24 @@
 00008b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00008c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00008c10: 2f61 7574 6f76 696d 6c2f 4175 746f 5f4e  /autoviml/Auto_N
 00008c20: 4c50 2e70 7900 0000 0000 0000 0000 0000  LP.py...........
 00008c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00008c70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00008c80: 3033 3232 3137 3200 3030 3030 3030 3030  0322172.00000000
-00008c90: 3030 3000 3031 3637 3535 0020 3000 0000  000.016755. 0...
+00008c90: 3030 3000 3031 3637 3536 0020 3000 0000  000.016756. 0...
 00008ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008d00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -9050,16 +9050,16 @@
 00023590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023600: 3232 206d 7469 6d65 3d31 3637 3832 3832  22 mtime=1678282
-00023610: 3436 322e 300a 0000 0000 0000 0000 0000  462.0...........
+00023600: 3232 206d 7469 6d65 3d31 3638 3139 3033  22 mtime=1681903
+00023610: 3736 332e 300a 0000 0000 0000 0000 0000  763.0...........
 00023620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -9082,23 +9082,23 @@
 00023790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00023800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00023810: 2f61 7574 6f76 696d 6c2f 4175 746f 5f56  /autoviml/Auto_V
 00023820: 694d 4c2e 7079 0000 0000 0000 0000 0000  iML.py..........
 00023830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023860: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00023870: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00023880: 3132 3230 3632 3400 3030 3030 3030 3030  1220624.00000000
+00023880: 3132 3230 3630 3500 3030 3030 3030 3030  1220605.00000000
 00023890: 3030 3000 3031 3731 3333 0020 3000 0000  000.017133. 0...
 000238a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -17042,13104 +17042,13104 @@
 00042910: 2072 6620 3d20 5261 6e64 6f6d 466f 7265   rf = RandomFore
 00042920: 7374 436c 6173 7369 6669 6572 286e 5f65  stClassifier(n_e
 00042930: 7374 696d 6174 6f72 733d 3130 302c 2072  stimators=100, r
 00042940: 616e 646f 6d5f 7374 6174 653d 3939 290d  andom_state=99).
 00042950: 0a20 2020 2020 2020 2020 2020 2078 6762  .            xgb
 00042960: 6d20 3d20 5365 6c66 5061 6365 6445 6e73  m = SelfPacedEns
 00042970: 656d 626c 6543 6c61 7373 6966 6965 7228  embleClassifier(
-00042980: 6261 7365 5f65 7374 696d 6174 6f72 3d72  base_estimator=r
-00042990: 662c 206e 5f6a 6f62 733d 2d31 2c20 736f  f, n_jobs=-1, so
-000429a0: 6674 5f72 6573 616d 706c 655f 666c 6167  ft_resample_flag
-000429b0: 3d54 7275 6529 0d0a 2020 2020 2020 2020  =True)..        
-000429c0: 2020 2020 6879 7065 725f 7061 7261 6d20      hyper_param 
-000429d0: 3d20 2749 6d62 270d 0a20 2020 2020 2020  = 'Imb'..       
-000429e0: 2020 2020 206d 6f64 656c 5f6e 616d 6520       model_name 
-000429f0: 3d20 2753 5045 270d 0a20 2020 2020 2020  = 'SPE'..       
-00042a00: 2020 2020 2042 6f6f 7374 696e 675f 466c       Boosting_Fl
-00042a10: 6167 203d 2020 4661 6c73 650d 0a20 2020  ag =  False..   
-00042a20: 2023 2323 2323 2320 2020 4e6f 7720 646f   ######   Now do
-00042a30: 2052 616e 646f 6d69 7a65 6453 6561 7263   RandomizedSearc
-00042a40: 6843 5620 2075 7369 6e67 2023 2045 6172  hCV  using # Ear
-00042a50: 6c79 2d73 746f 7070 696e 6720 2323 2323  ly-stopping ####
-00042a60: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
-00042a70: 2020 6966 206d 6f64 656c 7479 7065 203d    if modeltype =
-00042a80: 3d20 2752 6567 7265 7373 696f 6e27 3a0d  = 'Regression':.
-00042a90: 0a20 2020 2020 2020 2069 6620 6d6f 6465  .        if mode
-00042aa0: 6c5f 6c61 6265 6c20 3d3d 2027 5369 6e67  l_label == 'Sing
-00042ab0: 6c65 5f4c 6162 656c 273a 0d0a 2020 2020  le_Label':..    
-00042ac0: 2020 2020 2020 2020 2373 636f 7265 4675          #scoreFu
-00042ad0: 6e63 7469 6f6e 203d 207b 226d 7365 223a  nction = {"mse":
-00042ae0: 2022 6e65 675f 6d65 616e 5f73 7175 6172   "neg_mean_squar
-00042af0: 6564 5f65 7272 6f72 222c 2022 6d61 6522  ed_error", "mae"
-00042b00: 3a20 226e 6567 5f6d 6561 6e5f 6162 736f  : "neg_mean_abso
-00042b10: 6c75 7465 5f65 7272 6f72 227d 0d0a 2020  lute_error"}..  
-00042b20: 2020 2020 2020 2020 2020 2323 2323 2049            #### I
-00042b30: 2068 6176 6520 7365 7420 7468 6520 5665   have set the Ve
-00042b40: 7262 6f73 6520 746f 2062 6520 4661 6c73  rbose to be Fals
-00042b50: 6520 6865 7265 2073 696e 6365 2069 7420  e here since it 
-00042b60: 7072 6f64 7563 6573 2074 6f6f 206d 7563  produces too muc
-00042b70: 6820 6f75 7470 7574 2023 2323 0d0a 2020  h output ###..  
-00042b80: 2020 2020 2020 2020 2020 6966 2068 7970            if hyp
-00042b90: 6572 5f70 6172 616d 203d 3d20 2747 5327  er_param == 'GS'
-00042ba0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00042bb0: 2020 2023 2323 2320 4920 6861 7665 2073     #### I have s
-00042bc0: 6574 2074 6865 2056 6572 626f 7365 2074  et the Verbose t
-00042bd0: 6f20 6265 2046 616c 7365 2068 6572 6520  o be False here 
-00042be0: 7369 6e63 6520 6974 2070 726f 6475 6365  since it produce
-00042bf0: 7320 746f 6f20 6d75 6368 206f 7574 7075  s too much outpu
-00042c00: 7420 2323 230d 0a20 2020 2020 2020 2020  t ###..         
-00042c10: 2020 2020 2020 2067 7320 3d20 4772 6964         gs = Grid
-00042c20: 5365 6172 6368 4356 2878 6762 6d2c 7061  SearchCV(xgbm,pa
-00042c30: 7261 6d5f 6772 6964 3d72 5f70 6172 616d  ram_grid=r_param
-00042c40: 735b 6d6f 6465 6c5f 6e61 6d65 5d2c 0d0a  s[model_name],..
+00042980: 6573 7469 6d61 746f 723d 7266 2c20 6e5f  estimator=rf, n_
+00042990: 6a6f 6273 3d2d 312c 2073 6f66 745f 7265  jobs=-1, soft_re
+000429a0: 7361 6d70 6c65 5f66 6c61 673d 5472 7565  sample_flag=True
+000429b0: 290d 0a20 2020 2020 2020 2020 2020 2068  )..            h
+000429c0: 7970 6572 5f70 6172 616d 203d 2027 496d  yper_param = 'Im
+000429d0: 6227 0d0a 2020 2020 2020 2020 2020 2020  b'..            
+000429e0: 6d6f 6465 6c5f 6e61 6d65 203d 2027 5350  model_name = 'SP
+000429f0: 4527 0d0a 2020 2020 2020 2020 2020 2020  E'..            
+00042a00: 426f 6f73 7469 6e67 5f46 6c61 6720 3d20  Boosting_Flag = 
+00042a10: 2046 616c 7365 0d0a 2020 2020 2323 2323   False..    ####
+00042a20: 2323 2020 204e 6f77 2064 6f20 5261 6e64  ##   Now do Rand
+00042a30: 6f6d 697a 6564 5365 6172 6368 4356 2020  omizedSearchCV  
+00042a40: 7573 696e 6720 2320 4561 726c 792d 7374  using # Early-st
+00042a50: 6f70 7069 6e67 2023 2323 2323 2323 2323  opping #########
+00042a60: 2323 2323 2323 230d 0a20 2020 2069 6620  #######..    if 
+00042a70: 6d6f 6465 6c74 7970 6520 3d3d 2027 5265  modeltype == 'Re
+00042a80: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
+00042a90: 2020 2020 6966 206d 6f64 656c 5f6c 6162      if model_lab
+00042aa0: 656c 203d 3d20 2753 696e 676c 655f 4c61  el == 'Single_La
+00042ab0: 6265 6c27 3a0d 0a20 2020 2020 2020 2020  bel':..         
+00042ac0: 2020 2023 7363 6f72 6546 756e 6374 696f     #scoreFunctio
+00042ad0: 6e20 3d20 7b22 6d73 6522 3a20 226e 6567  n = {"mse": "neg
+00042ae0: 5f6d 6561 6e5f 7371 7561 7265 645f 6572  _mean_squared_er
+00042af0: 726f 7222 2c20 226d 6165 223a 2022 6e65  ror", "mae": "ne
+00042b00: 675f 6d65 616e 5f61 6273 6f6c 7574 655f  g_mean_absolute_
+00042b10: 6572 726f 7222 7d0d 0a20 2020 2020 2020  error"}..       
+00042b20: 2020 2020 2023 2323 2320 4920 6861 7665       #### I have
+00042b30: 2073 6574 2074 6865 2056 6572 626f 7365   set the Verbose
+00042b40: 2074 6f20 6265 2046 616c 7365 2068 6572   to be False her
+00042b50: 6520 7369 6e63 6520 6974 2070 726f 6475  e since it produ
+00042b60: 6365 7320 746f 6f20 6d75 6368 206f 7574  ces too much out
+00042b70: 7075 7420 2323 230d 0a20 2020 2020 2020  put ###..       
+00042b80: 2020 2020 2069 6620 6879 7065 725f 7061       if hyper_pa
+00042b90: 7261 6d20 3d3d 2027 4753 273a 0d0a 2020  ram == 'GS':..  
+00042ba0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+00042bb0: 2323 2049 2068 6176 6520 7365 7420 7468  ## I have set th
+00042bc0: 6520 5665 7262 6f73 6520 746f 2062 6520  e Verbose to be 
+00042bd0: 4661 6c73 6520 6865 7265 2073 696e 6365  False here since
+00042be0: 2069 7420 7072 6f64 7563 6573 2074 6f6f   it produces too
+00042bf0: 206d 7563 6820 6f75 7470 7574 2023 2323   much output ###
+00042c00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00042c10: 2020 6773 203d 2047 7269 6453 6561 7263    gs = GridSearc
+00042c20: 6843 5628 7867 626d 2c70 6172 616d 5f67  hCV(xgbm,param_g
+00042c30: 7269 643d 725f 7061 7261 6d73 5b6d 6f64  rid=r_params[mod
+00042c40: 656c 5f6e 616d 655d 2c0d 0a20 2020 2020  el_name],..     
 00042c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042c70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00042c80: 636f 7269 6e67 203d 2073 636f 7265 722c  coring = scorer,
-00042c90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00042c70: 2020 2020 2020 2020 2020 7363 6f72 696e            scorin
+00042c80: 6720 3d20 7363 6f72 6572 2c0d 0a20 2020  g = scorer,..   
+00042c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042cc0: 2063 7620 3d20 7363 762c 0d0a 2020 2020   cv = scv,..    
+00042cb0: 2020 2020 2020 2020 2020 2020 6376 203d              cv =
+00042cc0: 2073 6376 2c0d 0a20 2020 2020 2020 2020   scv,..         
 00042cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042cf0: 2020 2020 2020 2020 2020 2072 6566 6974             refit
-00042d00: 203d 2072 6566 6974 5f6d 6574 7269 632c   = refit_metric,
-00042d10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00042cf0: 2020 2020 2020 7265 6669 7420 3d20 7265        refit = re
+00042d00: 6669 745f 6d65 7472 6963 2c0d 0a20 2020  fit_metric,..   
+00042d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042d40: 2072 6574 7572 6e5f 7472 6169 6e5f 7363   return_train_sc
-00042d50: 6f72 6520 3d20 5472 7565 2c0d 0a20 2020  ore = True,..   
+00042d30: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00042d40: 726e 5f74 7261 696e 5f73 636f 7265 203d  rn_train_score =
+00042d50: 2054 7275 652c 0d0a 2020 2020 2020 2020   True,..        
 00042d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042d80: 2020 2020 2020 2020 2020 2020 6e5f 6a6f              n_jo
-00042d90: 6273 3d6e 5f6a 6f62 732c 0d0a 2020 2020  bs=n_jobs,..    
+00042d80: 2020 2020 2020 206e 5f6a 6f62 733d 6e5f         n_jobs=n_
+00042d90: 6a6f 6273 2c0d 0a20 2020 2020 2020 2020  jobs,..         
 00042da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042dc0: 2020 2020 2020 2020 2020 2020 7665 7262              verb
-00042dd0: 6f73 653d 3029 0d0a 2020 2020 2020 2020  ose=0)..        
-00042de0: 2020 2020 656c 6966 2068 7970 6572 5f70      elif hyper_p
-00042df0: 6172 616d 203d 3d20 2752 5327 3a0d 0a20  aram == 'RS':.. 
-00042e00: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-00042e10: 7320 3d20 5261 6e64 6f6d 697a 6564 5365  s = RandomizedSe
-00042e20: 6172 6368 4356 2878 6762 6d2c 0d0a 2020  archCV(xgbm,..  
+00042dc0: 2020 2020 2020 2076 6572 626f 7365 3d30         verbose=0
+00042dd0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00042de0: 6c69 6620 6879 7065 725f 7061 7261 6d20  lif hyper_param 
+00042df0: 3d3d 2027 5253 273a 0d0a 2020 2020 2020  == 'RS':..      
+00042e00: 2020 2020 2020 2020 2020 6773 203d 2052            gs = R
+00042e10: 616e 646f 6d69 7a65 6453 6561 7263 6843  andomizedSearchC
+00042e20: 5628 7867 626d 2c0d 0a20 2020 2020 2020  V(xgbm,..       
 00042e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042e50: 2020 2020 2020 2020 2020 2020 2070 6172               par
-00042e60: 616d 5f64 6973 7472 6962 7574 696f 6e73  am_distributions
-00042e70: 203d 2072 5f70 6172 616d 735b 6d6f 6465   = r_params[mode
-00042e80: 6c5f 6e61 6d65 5d2c 0d0a 2020 2020 2020  l_name],..      
+00042e50: 2020 2020 2020 2020 7061 7261 6d5f 6469          param_di
+00042e60: 7374 7269 6275 7469 6f6e 7320 3d20 725f  stributions = r_
+00042e70: 7061 7261 6d73 5b6d 6f64 656c 5f6e 616d  params[model_nam
+00042e80: 655d 2c0d 0a20 2020 2020 2020 2020 2020  e],..           
 00042e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042eb0: 2020 2020 2020 2020 206e 5f69 7465 7220           n_iter 
-00042ec0: 3d20 6e6f 5f69 7465 722c 0d0a 2020 2020  = no_iter,..    
+00042eb0: 2020 2020 6e5f 6974 6572 203d 206e 6f5f      n_iter = no_
+00042ec0: 6974 6572 2c0d 0a20 2020 2020 2020 2020  iter,..         
 00042ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042ef0: 2020 2020 2020 2020 2020 2073 636f 7269             scori
-00042f00: 6e67 203d 2073 636f 7265 722c 0d0a 2020  ng = scorer,..  
+00042ef0: 2020 2020 2020 7363 6f72 696e 6720 3d20        scoring = 
+00042f00: 7363 6f72 6572 2c0d 0a20 2020 2020 2020  scorer,..       
 00042f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042f30: 2020 2020 2020 2020 2020 2020 2072 6566               ref
-00042f40: 6974 203d 2072 6566 6974 5f6d 6574 7269  it = refit_metri
-00042f50: 632c 0d0a 2020 2020 2020 2020 2020 2020  c,..            
+00042f30: 2020 2020 2020 2020 7265 6669 7420 3d20          refit = 
+00042f40: 7265 6669 745f 6d65 7472 6963 2c0d 0a20  refit_metric,.. 
+00042f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042f80: 2020 2072 6574 7572 6e5f 7472 6169 6e5f     return_train_
-00042f90: 7363 6f72 6520 3d20 5472 7565 2c0d 0a20  score = True,.. 
+00042f70: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00042f80: 7475 726e 5f74 7261 696e 5f73 636f 7265  turn_train_score
+00042f90: 203d 2054 7275 652c 0d0a 2020 2020 2020   = True,..      
 00042fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042fc0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00042fd0: 6e64 6f6d 5f73 7461 7465 203d 2073 6565  ndom_state = see
-00042fe0: 642c 0d0a 2020 2020 2020 2020 2020 2020  d,..            
+00042fc0: 2020 2020 2020 2020 2072 616e 646f 6d5f           random_
+00042fd0: 7374 6174 6520 3d20 7365 6564 2c0d 0a20  state = seed,.. 
+00042fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043010: 2020 2063 7620 3d20 7363 762c 0d0a 2020     cv = scv,..  
+00043000: 2020 2020 2020 2020 2020 2020 2020 6376                cv
+00043010: 203d 2073 6376 2c0d 0a20 2020 2020 2020   = scv,..       
 00043020: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043040: 2020 2020 2020 2020 2020 2020 206e 5f6a               n_j
-00043050: 6f62 733d 6e5f 6a6f 6273 2c0d 0a20 2020  obs=n_jobs,..   
+00043040: 2020 2020 2020 2020 6e5f 6a6f 6273 3d6e          n_jobs=n
+00043050: 5f6a 6f62 732c 0d0a 2020 2020 2020 2020  _jobs,..        
 00043060: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043080: 2020 2020 2020 2020 2020 2020 2076 6572               ver
-00043090: 626f 7365 203d 2030 290d 0a20 2020 2020  bose = 0)..     
-000430a0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-000430b0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-000430c0: 2323 2043 6174 426f 6f73 7420 646f 6573  ## CatBoost does
-000430d0: 206e 6f74 206e 6565 6420 4879 7065 7220   not need Hyper 
-000430e0: 5061 7261 6d65 7465 7220 7475 6e69 6e67  Parameter tuning
-000430f0: 203d 3e20 6974 2773 2067 7265 6174 206f   => it's great o
-00043100: 7574 206f 6620 7468 6520 626f 7821 0d0a  ut of the box!..
-00043110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043120: 6773 203d 2063 6f70 792e 6465 6570 636f  gs = copy.deepco
-00043130: 7079 2878 6762 6d29 0d0a 2020 2020 2020  py(xgbm)..      
-00043140: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00043150: 2020 2020 2023 2323 2320 466f 7220 4d75       #### For Mu
-00043160: 6c74 696c 6162 656c 2052 6567 7265 7373  ltilabel Regress
-00043170: 6f72 7320 796f 7520 6e65 6564 2074 6f20  ors you need to 
-00043180: 646f 2073 6f6d 6520 6879 7065 7220 7061  do some hyper pa
-00043190: 7261 6d65 7465 7220 7475 6e69 6e67 2062  rameter tuning b
-000431a0: 7574 206e 6f74 2074 6f6f 206d 7563 6821  ut not too much!
-000431b0: 2020 2323 2323 0d0a 2020 2020 2020 2020    ####..        
-000431c0: 2020 2020 2323 2323 2042 6574 7465 7220      #### Better 
-000431d0: 746f 2072 6564 7563 6520 7468 6520 6e75  to reduce the nu
-000431e0: 6d62 6572 206f 6620 6974 6572 6174 696f  mber of iteratio
-000431f0: 6e73 2061 6e64 206e 6f20 6879 7065 722d  ns and no hyper-
-00043200: 7061 7261 6d20 7365 6172 6368 696e 6720  param searching 
-00043210: 7369 6e63 6520 6974 2074 616b 6573 2074  since it takes t
-00043220: 6f6f 206c 6f6e 6720 2323 2323 2323 2323  oo long ########
-00043230: 230d 0a20 2020 2020 2020 2020 2020 2023  #..            #
-00043240: 7363 6f72 6572 203d 2027 6e65 675f 6d65  scorer = 'neg_me
-00043250: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
-00043260: 270d 0a20 2020 2020 2020 2020 2020 206e  '..            n
-00043270: 6f5f 6974 6572 203d 2035 0d0a 2020 2020  o_iter = 5..    
-00043280: 2020 2020 2020 2020 6966 2068 7970 6572          if hyper
-00043290: 5f70 6172 616d 203d 3d20 2747 5327 3a0d  _param == 'GS':.
-000432a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000432b0: 2023 2323 2320 4920 6861 7665 2073 6574   #### I have set
-000432c0: 2074 6865 2056 6572 626f 7365 2074 6f20   the Verbose to 
-000432d0: 6265 2046 616c 7365 2068 6572 6520 7369  be False here si
-000432e0: 6e63 6520 6974 2070 726f 6475 6365 7320  nce it produces 
-000432f0: 746f 6f20 6d75 6368 206f 7574 7075 7420  too much output 
-00043300: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-00043310: 2020 2020 2067 7320 3d20 4772 6964 5365       gs = GridSe
-00043320: 6172 6368 4356 2878 6762 6d2c 7061 7261  archCV(xgbm,para
-00043330: 6d5f 6772 6964 3d72 5f70 6172 616d 735b  m_grid=r_params[
-00043340: 6d6f 6465 6c5f 6c61 6265 6c5d 5b6d 6f64  model_label][mod
-00043350: 656c 5f6e 616d 655d 2c0d 0a20 2020 2020  el_name],..     
+00043080: 2020 2020 2020 2020 7665 7262 6f73 6520          verbose 
+00043090: 3d20 3029 0d0a 2020 2020 2020 2020 2020  = 0)..          
+000430a0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+000430b0: 2020 2020 2020 2020 2023 2323 2320 4361           #### Ca
+000430c0: 7442 6f6f 7374 2064 6f65 7320 6e6f 7420  tBoost does not 
+000430d0: 6e65 6564 2048 7970 6572 2050 6172 616d  need Hyper Param
+000430e0: 6574 6572 2074 756e 696e 6720 3d3e 2069  eter tuning => i
+000430f0: 7427 7320 6772 6561 7420 6f75 7420 6f66  t's great out of
+00043100: 2074 6865 2062 6f78 210d 0a20 2020 2020   the box!..     
+00043110: 2020 2020 2020 2020 2020 2067 7320 3d20             gs = 
+00043120: 636f 7079 2e64 6565 7063 6f70 7928 7867  copy.deepcopy(xg
+00043130: 626d 290d 0a20 2020 2020 2020 2065 6c73  bm)..        els
+00043140: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00043150: 2323 2323 2046 6f72 204d 756c 7469 6c61  #### For Multila
+00043160: 6265 6c20 5265 6772 6573 736f 7273 2079  bel Regressors y
+00043170: 6f75 206e 6565 6420 746f 2064 6f20 736f  ou need to do so
+00043180: 6d65 2068 7970 6572 2070 6172 616d 6574  me hyper paramet
+00043190: 6572 2074 756e 696e 6720 6275 7420 6e6f  er tuning but no
+000431a0: 7420 746f 6f20 6d75 6368 2120 2023 2323  t too much!  ###
+000431b0: 230d 0a20 2020 2020 2020 2020 2020 2023  #..            #
+000431c0: 2323 2320 4265 7474 6572 2074 6f20 7265  ### Better to re
+000431d0: 6475 6365 2074 6865 206e 756d 6265 7220  duce the number 
+000431e0: 6f66 2069 7465 7261 7469 6f6e 7320 616e  of iterations an
+000431f0: 6420 6e6f 2068 7970 6572 2d70 6172 616d  d no hyper-param
+00043200: 2073 6561 7263 6869 6e67 2073 696e 6365   searching since
+00043210: 2069 7420 7461 6b65 7320 746f 6f20 6c6f   it takes too lo
+00043220: 6e67 2023 2323 2323 2323 2323 0d0a 2020  ng #########..  
+00043230: 2020 2020 2020 2020 2020 2373 636f 7265            #score
+00043240: 7220 3d20 276e 6567 5f6d 6561 6e5f 7371  r = 'neg_mean_sq
+00043250: 7561 7265 645f 6572 726f 7227 0d0a 2020  uared_error'..  
+00043260: 2020 2020 2020 2020 2020 6e6f 5f69 7465            no_ite
+00043270: 7220 3d20 350d 0a20 2020 2020 2020 2020  r = 5..         
+00043280: 2020 2069 6620 6879 7065 725f 7061 7261     if hyper_para
+00043290: 6d20 3d3d 2027 4753 273a 0d0a 2020 2020  m == 'GS':..    
+000432a0: 2020 2020 2020 2020 2020 2020 2323 2323              ####
+000432b0: 2049 2068 6176 6520 7365 7420 7468 6520   I have set the 
+000432c0: 5665 7262 6f73 6520 746f 2062 6520 4661  Verbose to be Fa
+000432d0: 6c73 6520 6865 7265 2073 696e 6365 2069  lse here since i
+000432e0: 7420 7072 6f64 7563 6573 2074 6f6f 206d  t produces too m
+000432f0: 7563 6820 6f75 7470 7574 2023 2323 0d0a  uch output ###..
+00043300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043310: 6773 203d 2047 7269 6453 6561 7263 6843  gs = GridSearchC
+00043320: 5628 7867 626d 2c70 6172 616d 5f67 7269  V(xgbm,param_gri
+00043330: 643d 725f 7061 7261 6d73 5b6d 6f64 656c  d=r_params[model
+00043340: 5f6c 6162 656c 5d5b 6d6f 6465 6c5f 6e61  _label][model_na
+00043350: 6d65 5d2c 0d0a 2020 2020 2020 2020 2020  me],..          
 00043360: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043380: 2020 2020 2020 2020 2020 7363 6f72 696e            scorin
-00043390: 6720 3d20 7363 6f72 6572 2c0d 0a20 2020  g = scorer,..   
+00043380: 2020 2020 2073 636f 7269 6e67 203d 2073       scoring = s
+00043390: 636f 7265 722c 0d0a 2020 2020 2020 2020  corer,..        
 000433a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000433b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000433c0: 2020 2020 2020 2020 2020 2020 6e5f 6a6f              n_jo
-000433d0: 6273 3d6e 5f6a 6f62 732c 0d0a 2020 2020  bs=n_jobs,..    
+000433c0: 2020 2020 2020 206e 5f6a 6f62 733d 6e5f         n_jobs=n_
+000433d0: 6a6f 6273 2c0d 0a20 2020 2020 2020 2020  jobs,..         
 000433e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000433f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043400: 2020 2020 2020 2020 2020 2063 7620 3d20             cv = 
-00043410: 7363 762c 0d0a 2020 2020 2020 2020 2020  scv,..          
+00043400: 2020 2020 2020 6376 203d 2073 6376 2c0d        cv = scv,.
+00043410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00043420: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043440: 2020 2020 2072 6566 6974 203d 2072 6566       refit = ref
-00043450: 6974 5f6d 6574 7269 632c 0d0a 2020 2020  it_metric,..    
+00043440: 7265 6669 7420 3d20 7265 6669 745f 6d65  refit = refit_me
+00043450: 7472 6963 2c0d 0a20 2020 2020 2020 2020  tric,..         
 00043460: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043480: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00043490: 6e5f 7472 6169 6e5f 7363 6f72 6520 3d20  n_train_score = 
-000434a0: 5472 7565 2c0d 0a20 2020 2020 2020 2020  True,..         
+00043480: 2020 2020 2020 7265 7475 726e 5f74 7261        return_tra
+00043490: 696e 5f73 636f 7265 203d 2054 7275 652c  in_score = True,
+000434a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 000434b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000434c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000434d0: 2020 2020 2020 2076 6572 626f 7365 3d30         verbose=0
-000434e0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-000434f0: 6c69 6620 6879 7065 725f 7061 7261 6d20  lif hyper_param 
-00043500: 3d3d 2027 5253 273a 0d0a 2020 2020 2020  == 'RS':..      
-00043510: 2020 2020 2020 2020 2020 6773 203d 2052            gs = R
-00043520: 616e 646f 6d69 7a65 6453 6561 7263 6843  andomizedSearchC
-00043530: 5628 7867 626d 2c0d 0a20 2020 2020 2020  V(xgbm,..       
+000434d0: 2020 7665 7262 6f73 653d 3029 0d0a 2020    verbose=0)..  
+000434e0: 2020 2020 2020 2020 2020 656c 6966 2068            elif h
+000434f0: 7970 6572 5f70 6172 616d 203d 3d20 2752  yper_param == 'R
+00043500: 5327 3a0d 0a20 2020 2020 2020 2020 2020  S':..           
+00043510: 2020 2020 2067 7320 3d20 5261 6e64 6f6d       gs = Random
+00043520: 697a 6564 5365 6172 6368 4356 2878 6762  izedSearchCV(xgb
+00043530: 6d2c 0d0a 2020 2020 2020 2020 2020 2020  m,..            
 00043540: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043560: 2020 2020 2020 2020 7061 7261 6d5f 6469          param_di
-00043570: 7374 7269 6275 7469 6f6e 7320 3d20 725f  stributions = r_
-00043580: 7061 7261 6d73 5b6d 6f64 656c 5f6c 6162  params[model_lab
-00043590: 656c 5d5b 6d6f 6465 6c5f 6e61 6d65 5d2c  el][model_name],
-000435a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00043560: 2020 2070 6172 616d 5f64 6973 7472 6962     param_distrib
+00043570: 7574 696f 6e73 203d 2072 5f70 6172 616d  utions = r_param
+00043580: 735b 6d6f 6465 6c5f 6c61 6265 6c5d 5b6d  s[model_label][m
+00043590: 6f64 656c 5f6e 616d 655d 2c0d 0a20 2020  odel_name],..   
+000435a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000435b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000435c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000435d0: 206e 5f69 7465 7220 3d20 6e6f 5f69 7465   n_iter = no_ite
-000435e0: 722c 0d0a 2020 2020 2020 2020 2020 2020  r,..            
+000435c0: 2020 2020 2020 2020 2020 2020 6e5f 6974              n_it
+000435d0: 6572 203d 206e 6f5f 6974 6572 2c0d 0a20  er = no_iter,.. 
+000435e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000435f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043610: 2020 2073 636f 7269 6e67 203d 2073 636f     scoring = sco
-00043620: 7265 722c 0d0a 2020 2020 2020 2020 2020  rer,..          
+00043600: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+00043610: 6f72 696e 6720 3d20 7363 6f72 6572 2c0d  oring = scorer,.
+00043620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00043630: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043650: 2020 2020 2072 6566 6974 203d 2072 6566       refit = ref
-00043660: 6974 5f6d 6574 7269 632c 0d0a 2020 2020  it_metric,..    
+00043650: 7265 6669 7420 3d20 7265 6669 745f 6d65  refit = refit_me
+00043660: 7472 6963 2c0d 0a20 2020 2020 2020 2020  tric,..         
 00043670: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043690: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000436a0: 6e5f 7472 6169 6e5f 7363 6f72 6520 3d20  n_train_score = 
-000436b0: 5472 7565 2c0d 0a20 2020 2020 2020 2020  True,..         
+00043690: 2020 2020 2020 7265 7475 726e 5f74 7261        return_tra
+000436a0: 696e 5f73 636f 7265 203d 2054 7275 652c  in_score = True,
+000436b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 000436c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000436d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000436e0: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
-000436f0: 7465 203d 2073 6565 642c 0d0a 2020 2020  te = seed,..    
+000436e0: 2072 616e 646f 6d5f 7374 6174 6520 3d20   random_state = 
+000436f0: 7365 6564 2c0d 0a20 2020 2020 2020 2020  seed,..         
 00043700: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043720: 2020 2020 2020 2020 2020 2063 7620 3d20             cv = 
-00043730: 7363 762c 0d0a 2020 2020 2020 2020 2020  scv,..          
+00043720: 2020 2020 2020 6376 203d 2073 6376 2c0d        cv = scv,.
+00043730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00043740: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043760: 2020 2020 206e 5f6a 6f62 733d 6e5f 6a6f       n_jobs=n_jo
-00043770: 6273 2c0d 0a20 2020 2020 2020 2020 2020  bs,..           
+00043760: 6e5f 6a6f 6273 3d6e 5f6a 6f62 732c 0d0a  n_jobs=n_jobs,..
+00043770: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043780: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000437a0: 2020 2020 2076 6572 626f 7365 203d 2030       verbose = 0
-000437b0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-000437c0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-000437d0: 2020 2020 2020 2323 2323 2043 6174 426f        #### CatBo
-000437e0: 6f73 7420 646f 6573 206e 6f74 206e 6565  ost does not nee
-000437f0: 6420 4879 7065 7220 5061 7261 6d65 7465  d Hyper Paramete
-00043800: 7220 7475 6e69 6e67 203d 3e20 6974 2773  r tuning => it's
-00043810: 2067 7265 6174 206f 7574 206f 6620 7468   great out of th
-00043820: 6520 626f 7821 0d0a 2020 2020 2020 2020  e box!..        
-00043830: 2020 2020 2020 2020 6773 203d 2063 6f70          gs = cop
-00043840: 792e 6465 6570 636f 7079 2878 6762 6d29  y.deepcopy(xgbm)
-00043850: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
-00043860: 2020 2020 2023 2323 2323 2323 2054 6869       ####### Thi
-00043870: 7320 6973 2066 6f72 2043 6c61 7373 6966  s is for Classif
-00043880: 6963 6174 696f 6e20 5072 6f62 6c65 6d73  ication Problems
-00043890: 2023 2323 2323 2323 2323 2323 2323 0d0a   #############..
-000438a0: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
-000438b0: 5f6c 6162 656c 203d 3d20 2753 696e 676c  _label == 'Singl
-000438c0: 655f 4c61 6265 6c27 3a0d 0a20 2020 2020  e_Label':..     
-000438d0: 2020 2020 2020 2069 6620 6879 7065 725f         if hyper_
-000438e0: 7061 7261 6d20 3d3d 2027 4753 273a 0d0a  param == 'GS':..
-000438f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043900: 2323 2323 2049 2068 6176 6520 7365 7420  #### I have set 
-00043910: 7468 6520 5665 7262 6f73 6520 746f 2062  the Verbose to b
-00043920: 6520 4661 6c73 6520 6865 7265 2073 696e  e False here sin
-00043930: 6365 2069 7420 7072 6f64 7563 6573 2074  ce it produces t
-00043940: 6f6f 206d 7563 6820 6f75 7470 7574 2023  oo much output #
-00043950: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-00043960: 2020 2020 6773 203d 2047 7269 6453 6561      gs = GridSea
-00043970: 7263 6843 5628 7867 626d 2c70 6172 616d  rchCV(xgbm,param
-00043980: 5f67 7269 643d 635f 7061 7261 6d73 5b6d  _grid=c_params[m
-00043990: 6f64 656c 5f6e 616d 655d 2c0d 0a20 2020  odel_name],..   
+000437a0: 7665 7262 6f73 6520 3d20 3029 0d0a 2020  verbose = 0)..  
+000437b0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+000437c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000437d0: 2023 2323 2320 4361 7442 6f6f 7374 2064   #### CatBoost d
+000437e0: 6f65 7320 6e6f 7420 6e65 6564 2048 7970  oes not need Hyp
+000437f0: 6572 2050 6172 616d 6574 6572 2074 756e  er Parameter tun
+00043800: 696e 6720 3d3e 2069 7427 7320 6772 6561  ing => it's grea
+00043810: 7420 6f75 7420 6f66 2074 6865 2062 6f78  t out of the box
+00043820: 210d 0a20 2020 2020 2020 2020 2020 2020  !..             
+00043830: 2020 2067 7320 3d20 636f 7079 2e64 6565     gs = copy.dee
+00043840: 7063 6f70 7928 7867 626d 290d 0a20 2020  pcopy(xgbm)..   
+00043850: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00043860: 2323 2323 2323 2320 5468 6973 2069 7320  ####### This is 
+00043870: 666f 7220 436c 6173 7369 6669 6361 7469  for Classificati
+00043880: 6f6e 2050 726f 626c 656d 7320 2323 2323  on Problems ####
+00043890: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
+000438a0: 2020 2069 6620 6d6f 6465 6c5f 6c61 6265     if model_labe
+000438b0: 6c20 3d3d 2027 5369 6e67 6c65 5f4c 6162  l == 'Single_Lab
+000438c0: 656c 273a 0d0a 2020 2020 2020 2020 2020  el':..          
+000438d0: 2020 6966 2068 7970 6572 5f70 6172 616d    if hyper_param
+000438e0: 203d 3d20 2747 5327 3a0d 0a20 2020 2020   == 'GS':..     
+000438f0: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
+00043900: 4920 6861 7665 2073 6574 2074 6865 2056  I have set the V
+00043910: 6572 626f 7365 2074 6f20 6265 2046 616c  erbose to be Fal
+00043920: 7365 2068 6572 6520 7369 6e63 6520 6974  se here since it
+00043930: 2070 726f 6475 6365 7320 746f 6f20 6d75   produces too mu
+00043940: 6368 206f 7574 7075 7420 2323 230d 0a20  ch output ###.. 
+00043950: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+00043960: 7320 3d20 4772 6964 5365 6172 6368 4356  s = GridSearchCV
+00043970: 2878 6762 6d2c 7061 7261 6d5f 6772 6964  (xgbm,param_grid
+00043980: 3d63 5f70 6172 616d 735b 6d6f 6465 6c5f  =c_params[model_
+00043990: 6e61 6d65 5d2c 0d0a 2020 2020 2020 2020  name],..        
 000439a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000439b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000439c0: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
-000439d0: 696e 6720 3d20 7363 6f72 6572 2c0d 0a20  ing = scorer,.. 
+000439c0: 2020 2020 2020 2073 636f 7269 6e67 203d         scoring =
+000439d0: 2073 636f 7265 722c 0d0a 2020 2020 2020   scorer,..      
 000439e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000439f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043a00: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00043a10: 7475 726e 5f74 7261 696e 5f73 636f 7265  turn_train_score
-00043a20: 203d 2054 7275 652c 0d0a 2020 2020 2020   = True,..      
+00043a00: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
+00043a10: 7472 6169 6e5f 7363 6f72 6520 3d20 5472  train_score = Tr
+00043a20: 7565 2c0d 0a20 2020 2020 2020 2020 2020  ue,..           
 00043a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043a50: 2020 2020 2020 2020 206e 5f6a 6f62 733d           n_jobs=
-00043a60: 6e5f 6a6f 6273 2c0d 0a20 2020 2020 2020  n_jobs,..       
+00043a50: 2020 2020 6e5f 6a6f 6273 3d6e 5f6a 6f62      n_jobs=n_job
+00043a60: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
 00043a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043a90: 2020 2020 2020 2020 7265 6669 7420 3d20          refit = 
-00043aa0: 7265 6669 745f 6d65 7472 6963 2c0d 0a20  refit_metric,.. 
+00043a90: 2020 2072 6566 6974 203d 2072 6566 6974     refit = refit
+00043aa0: 5f6d 6574 7269 632c 0d0a 2020 2020 2020  _metric,..      
 00043ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043ad0: 2020 2020 2020 2020 2020 2020 2020 6376                cv
-00043ae0: 203d 2073 6376 2c0d 0a20 2020 2020 2020   = scv,..       
+00043ad0: 2020 2020 2020 2020 2063 7620 3d20 7363           cv = sc
+00043ae0: 762c 0d0a 2020 2020 2020 2020 2020 2020  v,..            
 00043af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043b10: 2020 2020 2020 2020 2076 6572 626f 7365           verbose
-00043b20: 3d30 290d 0a20 2020 2020 2020 2020 2020  =0)..           
-00043b30: 2065 6c69 6620 6879 7065 725f 7061 7261   elif hyper_para
-00043b40: 6d20 3d3d 2027 5253 273a 0d0a 2020 2020  m == 'RS':..    
-00043b50: 2020 2020 2020 2020 2020 2020 2323 2323              ####
-00043b60: 2049 2068 6176 6520 7365 7420 7468 6520   I have set the 
-00043b70: 5665 7262 6f73 6520 746f 2062 6520 4661  Verbose to be Fa
-00043b80: 6c73 6520 6865 7265 2073 696e 6365 2069  lse here since i
-00043b90: 7420 7072 6f64 7563 6573 2074 6f6f 206d  t produces too m
-00043ba0: 7563 6820 6f75 7470 7574 2023 2323 0d0a  uch output ###..
-00043bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043bc0: 6773 203d 2052 616e 646f 6d69 7a65 6453  gs = RandomizedS
-00043bd0: 6561 7263 6843 5628 7867 626d 2c0d 0a20  earchCV(xgbm,.. 
+00043b10: 2020 2020 7665 7262 6f73 653d 3029 0d0a      verbose=0)..
+00043b20: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00043b30: 2068 7970 6572 5f70 6172 616d 203d 3d20   hyper_param == 
+00043b40: 2752 5327 3a0d 0a20 2020 2020 2020 2020  'RS':..         
+00043b50: 2020 2020 2020 2023 2323 2320 4920 6861         #### I ha
+00043b60: 7665 2073 6574 2074 6865 2056 6572 626f  ve set the Verbo
+00043b70: 7365 2074 6f20 6265 2046 616c 7365 2068  se to be False h
+00043b80: 6572 6520 7369 6e63 6520 6974 2070 726f  ere since it pro
+00043b90: 6475 6365 7320 746f 6f20 6d75 6368 206f  duces too much o
+00043ba0: 7574 7075 7420 2323 230d 0a20 2020 2020  utput ###..     
+00043bb0: 2020 2020 2020 2020 2020 2067 7320 3d20             gs = 
+00043bc0: 5261 6e64 6f6d 697a 6564 5365 6172 6368  RandomizedSearch
+00043bd0: 4356 2878 6762 6d2c 0d0a 2020 2020 2020  CV(xgbm,..      
 00043be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043c00: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00043c10: 7261 6d5f 6469 7374 7269 6275 7469 6f6e  ram_distribution
-00043c20: 7320 3d20 635f 7061 7261 6d73 5b6d 6f64  s = c_params[mod
-00043c30: 656c 5f6e 616d 655d 2c0d 0a20 2020 2020  el_name],..     
+00043c00: 2020 2020 2020 2020 2070 6172 616d 5f64           param_d
+00043c10: 6973 7472 6962 7574 696f 6e73 203d 2063  istributions = c
+00043c20: 5f70 6172 616d 735b 6d6f 6465 6c5f 6e61  _params[model_na
+00043c30: 6d65 5d2c 0d0a 2020 2020 2020 2020 2020  me],..          
 00043c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043c60: 2020 2020 2020 2020 2020 6e5f 6974 6572            n_iter
-00043c70: 203d 206e 6f5f 6974 6572 2c0d 0a20 2020   = no_iter,..   
+00043c60: 2020 2020 206e 5f69 7465 7220 3d20 6e6f       n_iter = no
+00043c70: 5f69 7465 722c 0d0a 2020 2020 2020 2020  _iter,..        
 00043c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043ca0: 2020 2020 2020 2020 2020 2020 7363 6f72              scor
-00043cb0: 696e 6720 3d20 7363 6f72 6572 2c0d 0a20  ing = scorer,.. 
+00043ca0: 2020 2020 2020 2073 636f 7269 6e67 203d         scoring =
+00043cb0: 2073 636f 7265 722c 0d0a 2020 2020 2020   scorer,..      
 00043cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043ce0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00043cf0: 6669 7420 3d20 7265 6669 745f 6d65 7472  fit = refit_metr
-00043d00: 6963 2c0d 0a20 2020 2020 2020 2020 2020  ic,..           
+00043ce0: 2020 2020 2020 2020 2072 6566 6974 203d           refit =
+00043cf0: 2072 6566 6974 5f6d 6574 7269 632c 0d0a   refit_metric,..
+00043d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043d30: 2020 2020 7265 7475 726e 5f74 7261 696e      return_train
-00043d40: 5f73 636f 7265 203d 2054 7275 652c 0d0a  _score = True,..
+00043d20: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00043d30: 6574 7572 6e5f 7472 6169 6e5f 7363 6f72  eturn_train_scor
+00043d40: 6520 3d20 5472 7565 2c0d 0a20 2020 2020  e = True,..     
 00043d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043d70: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00043d80: 616e 646f 6d5f 7374 6174 6520 3d20 7365  andom_state = se
-00043d90: 6564 2c0d 0a20 2020 2020 2020 2020 2020  ed,..           
+00043d70: 2020 2020 2020 2020 2020 7261 6e64 6f6d            random
+00043d80: 5f73 7461 7465 203d 2073 6565 642c 0d0a  _state = seed,..
+00043d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043dc0: 2020 2020 6e5f 6a6f 6273 3d6e 5f6a 6f62      n_jobs=n_job
-00043dd0: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
+00043db0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00043dc0: 5f6a 6f62 733d 6e5f 6a6f 6273 2c0d 0a20  _jobs=n_jobs,.. 
+00043dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043e00: 2020 2063 7620 3d20 7363 762c 0d0a 2020     cv = scv,..  
+00043df0: 2020 2020 2020 2020 2020 2020 2020 6376                cv
+00043e00: 203d 2073 6376 2c0d 0a20 2020 2020 2020   = scv,..       
 00043e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00043e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043e30: 2020 2020 2020 2020 2020 2020 2020 7665                ve
-00043e40: 7262 6f73 6520 3d20 3029 0d0a 2020 2020  rbose = 0)..    
-00043e50: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00043e60: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00043e70: 2323 2320 4361 7442 6f6f 7374 2064 6f65  ### CatBoost doe
-00043e80: 7320 6e6f 7420 6e65 6564 2048 7970 6572  s not need Hyper
-00043e90: 2050 6172 616d 6574 6572 2074 756e 696e   Parameter tunin
-00043ea0: 6720 3d3e 2069 7427 7320 6772 6561 7420  g => it's great 
-00043eb0: 6f75 7420 6f66 2074 6865 2062 6f78 210d  out of the box!.
-00043ec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00043ed0: 2067 7320 3d20 636f 7079 2e64 6565 7063   gs = copy.deepc
-00043ee0: 6f70 7928 7867 626d 290d 0a20 2020 2020  opy(xgbm)..     
-00043ef0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00043f00: 2020 2020 2020 2323 2046 6f72 206d 756c        ## For mul
-00043f10: 7469 2d6c 6162 656c 2070 726f 626c 656d  ti-label problem
-00043f20: 732c 2079 6f75 2063 616e 2774 2064 6f20  s, you can't do 
-00043f30: 4772 6964 5365 6172 6368 206f 7220 5261  GridSearch or Ra
-00043f40: 6e64 6f6d 697a 6564 5365 6172 6368 2073  ndomizedSearch s
-00043f50: 696e 6365 2069 7420 7769 6c6c 2074 616b  ince it will tak
-00043f60: 6520 746f 6f20 6c6f 6e67 0d0a 2020 2020  e too long..    
-00043f70: 2020 2020 2020 2020 6773 203d 2063 6f70          gs = cop
-00043f80: 792e 6465 6570 636f 7079 2878 6762 6d29  y.deepcopy(xgbm)
-00043f90: 0d0a 2020 2020 2374 7261 696e 7320 616e  ..    #trains an
-00043fa0: 6420 6f70 7469 6d69 7a65 7320 7468 6520  d optimizes the 
-00043fb0: 6d6f 6465 6c20 2323 2323 2323 2323 230d  model #########.
-00043fc0: 0a20 2020 2065 7661 6c5f 7365 7420 3d20  .    eval_set = 
-00043fd0: 5b28 585f 7472 6169 6e2c 795f 7472 6169  [(X_train,y_trai
-00043fe0: 6e29 2c28 585f 6376 2c79 5f63 7629 5d0d  n),(X_cv,y_cv)].
-00043ff0: 0a20 2020 2070 7269 6e74 2827 4669 6e64  .    print('Find
-00044000: 696e 6720 4265 7374 204d 6f64 656c 2061  ing Best Model a
-00044010: 6e64 2048 7970 6572 2050 6172 616d 6574  nd Hyper Paramet
-00044020: 6572 7320 666f 7220 2573 206d 6f64 656c  ers for %s model
-00044030: 2e2e 2e27 2025 6d6f 6465 6c5f 6e61 6d65  ...' %model_name
-00044040: 290d 0a20 2020 2023 2323 2323 2048 6572  )..    ##### Her
-00044050: 6520 6973 2077 6865 7265 2077 6520 7075  e is where we pu
-00044060: 7420 7468 6520 7061 7274 5f74 7261 696e  t the part_train
-00044070: 2061 6e64 2070 6172 745f 6376 2074 6f67   and part_cv tog
-00044080: 6574 6865 7220 2323 2323 2323 2323 2323  ether ##########
-00044090: 230d 0a20 2020 2069 6620 6d6f 6465 6c74  #..    if modelt
-000440a0: 7970 6520 213d 2027 5265 6772 6573 7369  ype != 'Regressi
-000440b0: 6f6e 273a 0d0a 2020 2020 2020 2020 2323  on':..        ##
-000440c0: 2320 446f 2074 6869 7320 6f6e 6c79 2066  # Do this only f
-000440d0: 6f72 2042 696e 6172 7920 436c 6173 7365  or Binary Classe
-000440e0: 7320 616e 6420 4d75 6c74 692d 436c 6173  s and Multi-Clas
-000440f0: 7365 732c 2062 6f74 6820 6172 6520 6f6b  ses, both are ok
-00044100: 6179 0d0a 2020 2020 2020 2020 6261 7365  ay..        base
-00044110: 6c69 6e65 5f61 6363 7520 3d20 312d 2874  line_accu = 1-(t
-00044120: 7261 696e 5b65 6163 685f 7461 7267 6574  rain[each_target
-00044130: 5d2e 7661 6c75 655f 636f 756e 7473 2831  ].value_counts(1
-00044140: 292e 736f 7274 5f76 616c 7565 7328 2929  ).sort_values())
-00044150: 5b72 6172 655f 636c 6173 735d 0d0a 2020  [rare_class]..  
-00044160: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-00044170: 2042 6173 656c 696e 6520 4163 6375 7261   Baseline Accura
-00044180: 6379 204e 6565 6465 6420 666f 7220 4d6f  cy Needed for Mo
-00044190: 6465 6c20 3d20 2530 2e32 6625 2527 2025  del = %0.2f%%' %
-000441a0: 2862 6173 656c 696e 655f 6163 6375 2a31  (baseline_accu*1
-000441b0: 3030 2929 0d0a 2020 2020 7072 696e 7428  00))..    print(
-000441c0: 2720 2020 2043 5055 2043 6f75 6e74 203d  '    CPU Count =
-000441d0: 2025 7320 696e 2074 6869 7320 6465 7669   %s in this devi
-000441e0: 6365 2720 2543 5055 5f63 6f75 6e74 290d  ce' %CPU_count).
-000441f0: 0a20 2020 2069 6620 6d6f 6465 6c74 7970  .    if modeltyp
-00044200: 6520 3d3d 2027 5265 6772 6573 7369 6f6e  e == 'Regression
-00044210: 273a 0d0a 2020 2020 2020 2020 6966 2042  ':..        if B
-00044220: 6f6f 7374 696e 675f 466c 6167 3a0d 0a20  oosting_Flag:.. 
-00044230: 2020 2020 2020 2020 2020 2069 6620 6d6f             if mo
-00044240: 6465 6c5f 6e61 6d65 2e6c 6f77 6572 2829  del_name.lower()
-00044250: 203d 3d20 2763 6174 626f 6f73 7427 3a0d   == 'catboost':.
-00044260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00044270: 2064 6174 615f 6469 6d20 3d20 6461 7461   data_dim = data
-00044280: 5f64 696d 2a6f 6e65 5f68 6f74 5f73 697a  _dim*one_hot_siz
-00044290: 652f 6c65 6e28 7072 6564 7329 0d0a 2020  e/len(preds)..  
-000442a0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-000442b0: 696e 7428 2755 7369 6e67 2025 7320 4d6f  int('Using %s Mo
-000442c0: 6465 6c2c 2045 7374 696d 6174 6564 2054  del, Estimated T
-000442d0: 7261 696e 696e 6720 7469 6d65 203d 2025  raining time = %
-000442e0: 302e 3366 206d 696e 7327 2025 286d 6f64  0.3f mins' %(mod
-000442f0: 656c 5f6e 616d 652c 6461 7461 5f64 696d  el_name,data_dim
-00044300: 2a6d 6178 5f63 6c61 7373 5f6c 656e 6774  *max_class_lengt
-00044310: 682a 6c65 6e28 7461 7267 6574 292f 2833  h*len(target)/(3
-00044320: 3030 3030 3030 2e2a 4350 555f 636f 756e  000000.*CPU_coun
-00044330: 7429 2929 0d0a 2020 2020 2020 2020 2020  t)))..          
-00044340: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00044350: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00044360: 5573 696e 6720 2573 204d 6f64 656c 2c20  Using %s Model, 
-00044370: 4573 7469 6d61 7465 6420 5472 6169 6e69  Estimated Traini
-00044380: 6e67 2074 696d 6520 3d20 2530 2e33 6620  ng time = %0.3f 
-00044390: 6d69 6e73 2720 2528 6d6f 6465 6c5f 6e61  mins' %(model_na
-000443a0: 6d65 2c64 6174 615f 6469 6d2a 6d61 785f  me,data_dim*max_
-000443b0: 636c 6173 735f 6c65 6e67 7468 2a6c 656e  class_length*len
-000443c0: 2874 6172 6765 7429 2f28 3530 3030 302e  (target)/(50000.
-000443d0: 2a43 5055 5f63 6f75 6e74 2929 290d 0a20  *CPU_count))).. 
-000443e0: 2020 2020 2020 2065 6c69 6620 426f 6f73         elif Boos
-000443f0: 7469 6e67 5f46 6c61 6720 6973 204e 6f6e  ting_Flag is Non
-00044400: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00044410: 7072 696e 7428 2755 7369 6e67 2025 7320  print('Using %s 
-00044420: 4d6f 6465 6c2c 2045 7374 696d 6174 6564  Model, Estimated
-00044430: 2054 7261 696e 696e 6720 7469 6d65 203d   Training time =
-00044440: 2025 302e 3366 206d 696e 7327 2025 286d   %0.3f mins' %(m
-00044450: 6f64 656c 5f6e 616d 652c 6461 7461 5f64  odel_name,data_d
-00044460: 696d 2a6d 6178 5f63 6c61 7373 5f6c 656e  im*max_class_len
-00044470: 6774 682a 6c65 6e28 7461 7267 6574 292f  gth*len(target)/
-00044480: 2838 3030 3030 2e2a 4350 555f 636f 756e  (80000.*CPU_coun
-00044490: 7429 2929 0d0a 2020 2020 2020 2020 656c  t)))..        el
-000444a0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-000444b0: 2070 7269 6e74 2827 5573 696e 6720 2573   print('Using %s
-000444c0: 204d 6f64 656c 2c20 4573 7469 6d61 7465   Model, Estimate
-000444d0: 6420 5472 6169 6e69 6e67 2074 696d 6520  d Training time 
-000444e0: 3d20 2530 2e33 6620 6d69 6e73 2720 2528  = %0.3f mins' %(
-000444f0: 6d6f 6465 6c5f 6e61 6d65 2c64 6174 615f  model_name,data_
-00044500: 6469 6d2a 6d61 785f 636c 6173 735f 6c65  dim*max_class_le
-00044510: 6e67 7468 2a6c 656e 2874 6172 6765 7429  ngth*len(target)
-00044520: 2f28 3430 3030 302e 2a43 5055 5f63 6f75  /(40000.*CPU_cou
-00044530: 6e74 2929 290d 0a20 2020 2065 6c73 653a  nt)))..    else:
-00044540: 0d0a 2020 2020 2020 2020 2323 2323 2320  ..        ##### 
-00044550: 5468 6973 2069 7320 666f 7220 636c 6173  This is for clas
-00044560: 7369 6669 6361 7469 6f6e 2077 6869 6368  sification which
-00044570: 2064 6966 6665 7273 2066 6f72 2047 7269   differs for Gri
-00044580: 6453 6561 7263 6820 7673 2052 616e 646f  dSearch vs Rando
-00044590: 6d69 7a65 6453 6561 7263 6820 2323 2323  mizedSearch ####
-000445a0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-000445b0: 2020 2020 6966 2068 7970 6572 5f70 6172      if hyper_par
-000445c0: 616d 203d 3d20 2747 5327 3a0d 0a20 2020  am == 'GS':..   
-000445d0: 2020 2020 2020 2020 2069 6620 426f 6f73           if Boos
-000445e0: 7469 6e67 5f46 6c61 673a 0d0a 2020 2020  ting_Flag:..    
-000445f0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
-00044600: 6f64 656c 5f6e 616d 652e 6c6f 7765 7228  odel_name.lower(
-00044610: 2920 3d3d 2027 6361 7462 6f6f 7374 273a  ) == 'catboost':
-00044620: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00044630: 2020 2020 2020 6461 7461 5f64 696d 203d        data_dim =
-00044640: 2064 6174 615f 6469 6d2a 6f6e 655f 686f   data_dim*one_ho
-00044650: 745f 7369 7a65 2f6c 656e 2870 7265 6473  t_size/len(preds
-00044660: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00044670: 2020 2020 2020 2070 7269 6e74 2827 5573         print('Us
-00044680: 696e 6720 2573 204d 6f64 656c 2c20 4573  ing %s Model, Es
-00044690: 7469 6d61 7465 6420 5472 6169 6e69 6e67  timated Training
-000446a0: 2074 696d 6520 3d20 2530 2e33 6620 6d69   time = %0.3f mi
-000446b0: 6e73 2720 2528 6d6f 6465 6c5f 6e61 6d65  ns' %(model_name
-000446c0: 2c64 6174 615f 6469 6d2a 6d61 785f 636c  ,data_dim*max_cl
-000446d0: 6173 735f 6c65 6e67 7468 2a6c 656e 2874  ass_length*len(t
-000446e0: 6172 6765 7429 2f28 3330 3030 3030 2e2a  arget)/(300000.*
-000446f0: 4350 555f 636f 756e 7429 2929 0d0a 2020  CPU_count)))..  
-00044700: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00044710: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00044720: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00044730: 5573 696e 6720 2573 204d 6f64 656c 2c20  Using %s Model, 
-00044740: 4573 7469 6d61 7465 6420 5472 6169 6e69  Estimated Traini
-00044750: 6e67 2074 696d 6520 3d20 2530 2e33 6620  ng time = %0.3f 
-00044760: 6d69 6e73 2720 2528 6d6f 6465 6c5f 6e61  mins' %(model_na
-00044770: 6d65 2c64 6174 615f 6469 6d2a 286d 6178  me,data_dim*(max
-00044780: 5f63 6c61 7373 5f6c 656e 6774 682a 2a32  _class_length**2
-00044790: 292a 6c65 6e28 7461 7267 6574 292f 2831  )*len(target)/(1
-000447a0: 3030 3030 302e 2a43 5055 5f63 6f75 6e74  00000.*CPU_count
-000447b0: 2929 290d 0a20 2020 2020 2020 2020 2020  )))..           
-000447c0: 2065 6c69 6620 426f 6f73 7469 6e67 5f46   elif Boosting_F
-000447d0: 6c61 6720 6973 204e 6f6e 653a 0d0a 2020  lag is None:..  
-000447e0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-000447f0: 2323 2041 204c 696e 6561 7220 6d6f 6465  ## A Linear mode
-00044800: 6c20 6973 2075 7375 616c 6c79 2074 6865  l is usually the
-00044810: 2066 6173 7465 7374 2023 2323 2323 2323   fastest #######
-00044820: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
-00044830: 2020 2020 2020 7072 696e 7428 2755 7369        print('Usi
-00044840: 6e67 2025 7320 4d6f 6465 6c2c 2045 7374  ng %s Model, Est
-00044850: 696d 6174 6564 2054 7261 696e 696e 6720  imated Training 
-00044860: 7469 6d65 203d 2025 302e 3366 206d 696e  time = %0.3f min
-00044870: 7327 2025 286d 6f64 656c 5f6e 616d 652c  s' %(model_name,
-00044880: 6461 7461 5f64 696d 2a6d 6178 5f63 6c61  data_dim*max_cla
-00044890: 7373 5f6c 656e 6774 682a 6c65 6e28 7461  ss_length*len(ta
-000448a0: 7267 6574 292f 2835 3030 3030 2e2a 4350  rget)/(50000.*CP
-000448b0: 555f 636f 756e 7429 2929 0d0a 2020 2020  U_count)))..    
-000448c0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-000448d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000448e0: 7269 6e74 2827 5573 696e 6720 2573 204d  rint('Using %s M
-000448f0: 6f64 656c 2c20 4573 7469 6d61 7465 6420  odel, Estimated 
-00044900: 5472 6169 6e69 6e67 2074 696d 6520 3d20  Training time = 
-00044910: 2530 2e33 6620 6d69 6e73 2720 2528 6d6f  %0.3f mins' %(mo
-00044920: 6465 6c5f 6e61 6d65 2c64 6174 615f 6469  del_name,data_di
-00044930: 6d2a 6d61 785f 636c 6173 735f 6c65 6e67  m*max_class_leng
-00044940: 7468 2a6c 656e 2874 6172 6765 7429 2f28  th*len(target)/(
-00044950: 3136 3030 302e 2a43 5055 5f63 6f75 6e74  16000.*CPU_count
-00044960: 2929 290d 0a20 2020 2020 2020 2065 6c73  )))..        els
-00044970: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00044980: 6966 2042 6f6f 7374 696e 675f 466c 6167  if Boosting_Flag
-00044990: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000449a0: 2020 2069 6620 6d6f 6465 6c5f 6e61 6d65     if model_name
-000449b0: 2e6c 6f77 6572 2829 203d 3d20 2763 6174  .lower() == 'cat
-000449c0: 626f 6f73 7427 3a0d 0a20 2020 2020 2020  boost':..       
-000449d0: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-000449e0: 615f 6469 6d20 3d20 6461 7461 5f64 696d  a_dim = data_dim
-000449f0: 2a6f 6e65 5f68 6f74 5f73 697a 652f 6c65  *one_hot_size/le
-00044a00: 6e28 7072 6564 7329 0d0a 2020 2020 2020  n(preds)..      
-00044a10: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00044a20: 696e 7428 2755 7369 6e67 2025 7320 4d6f  int('Using %s Mo
-00044a30: 6465 6c2c 2045 7374 696d 6174 6564 2054  del, Estimated T
-00044a40: 7261 696e 696e 6720 7469 6d65 203d 2025  raining time = %
-00044a50: 302e 3266 206d 696e 7327 2025 286d 6f64  0.2f mins' %(mod
-00044a60: 656c 5f6e 616d 652c 6461 7461 5f64 696d  el_name,data_dim
-00044a70: 2a6d 6178 5f63 6c61 7373 5f6c 656e 6774  *max_class_lengt
-00044a80: 682a 6c65 6e28 7461 7267 6574 292f 2833  h*len(target)/(3
-00044a90: 3030 3030 3030 2e2a 4350 555f 636f 756e  000000.*CPU_coun
-00044aa0: 7429 2929 0d0a 2020 2020 2020 2020 2020  t)))..          
-00044ab0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00044ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044ad0: 2070 7269 6e74 2827 5573 696e 6720 2573   print('Using %s
-00044ae0: 204d 6f64 656c 2c20 4573 7469 6d61 7465   Model, Estimate
-00044af0: 6420 5472 6169 6e69 6e67 2074 696d 6520  d Training time 
-00044b00: 3d20 2530 2e32 6620 6d69 6e73 2720 2528  = %0.2f mins' %(
-00044b10: 6d6f 6465 6c5f 6e61 6d65 2c64 6174 615f  model_name,data_
-00044b20: 6469 6d2a 286d 6178 5f63 6c61 7373 5f6c  dim*(max_class_l
-00044b30: 656e 6774 6829 2a6c 656e 2874 6172 6765  ength)*len(targe
-00044b40: 7429 2a2a 322f 2834 3030 3030 2e2a 4350  t)**2/(40000.*CP
-00044b50: 555f 636f 756e 7429 2929 0d0a 2020 2020  U_count)))..    
-00044b60: 2020 2020 2020 2020 656c 6966 2042 6f6f          elif Boo
-00044b70: 7374 696e 675f 466c 6167 2069 7320 4e6f  sting_Flag is No
-00044b80: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
-00044b90: 2020 2020 2070 7269 6e74 2827 5573 696e       print('Usin
-00044ba0: 6720 2573 204d 6f64 656c 2c20 4573 7469  g %s Model, Esti
-00044bb0: 6d61 7465 6420 5472 6169 6e69 6e67 2074  mated Training t
-00044bc0: 696d 6520 3d20 2530 2e32 6620 6d69 6e73  ime = %0.2f mins
-00044bd0: 2720 2528 6d6f 6465 6c5f 6e61 6d65 2c64  ' %(model_name,d
-00044be0: 6174 615f 6469 6d2a 6d61 785f 636c 6173  ata_dim*max_clas
-00044bf0: 735f 6c65 6e67 7468 2a6c 656e 2874 6172  s_length*len(tar
-00044c00: 6765 7429 2f28 3130 3030 3030 2e2a 4350  get)/(100000.*CP
-00044c10: 555f 636f 756e 7429 2929 0d0a 2020 2020  U_count)))..    
-00044c20: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00044c30: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00044c40: 7269 6e74 2827 5573 696e 6720 2573 204d  rint('Using %s M
-00044c50: 6f64 656c 2c20 4573 7469 6d61 7465 6420  odel, Estimated 
-00044c60: 5472 6169 6e69 6e67 2074 696d 6520 3d20  Training time = 
-00044c70: 2530 2e32 6620 6d69 6e73 2720 2528 6d6f  %0.2f mins' %(mo
-00044c80: 6465 6c5f 6e61 6d65 2c64 6174 615f 6469  del_name,data_di
-00044c90: 6d2a 6d61 785f 636c 6173 735f 6c65 6e67  m*max_class_leng
-00044ca0: 7468 2a6c 656e 2874 6172 6765 7429 2f28  th*len(target)/(
-00044cb0: 3235 3030 302e 2a43 5055 5f63 6f75 6e74  25000.*CPU_count
-00044cc0: 2929 290d 0a20 2020 2023 2323 2323 2053  )))..    ##### S
-00044cd0: 696e 6365 2077 6520 6172 6520 7573 696e  ince we are usin
-00044ce0: 6720 4d75 6c74 6970 6c65 204d 6f64 656c  g Multiple Model
-00044cf0: 7320 6561 6368 2077 6974 6820 6974 7320  s each with its 
-00044d00: 6f77 6e20 7175 6972 6b73 2c20 7765 2068  own quirks, we h
-00044d10: 6176 6520 746f 206d 616b 6520 7375 7265  ave to make sure
-00044d20: 2069 7420 6973 2064 6f6e 6520 7468 6973   it is done this
-00044d30: 2077 6179 0d0a 2020 2020 2323 2323 2320   way..    ##### 
-00044d40: 2323 2323 2323 2323 2323 2323 2020 2020  ############    
-00044d50: 2020 5452 4149 4e49 4e47 204d 4f44 454c    TRAINING MODEL
-00044d60: 2046 4952 5354 2054 494d 4520 5749 5448   FIRST TIME WITH
-00044d70: 2058 5f54 5241 494e 2041 4e44 2054 4553   X_TRAIN AND TES
-00044d80: 5449 4e47 204f 4e20 585f 4356 2023 2323  TING ON X_CV ###
-00044d90: 2323 2323 2323 2323 230d 0a20 2020 206d  #########..    m
-00044da0: 6f64 656c 5f73 7461 7274 5f74 696d 6520  odel_start_time 
-00044db0: 3d20 7469 6d65 2e74 696d 6528 290d 0a20  = time.time().. 
-00044dc0: 2020 2023 2323 2323 2323 2323 2323 2323     #############
+00043e30: 2020 2020 2020 2020 2076 6572 626f 7365           verbose
+00043e40: 203d 2030 290d 0a20 2020 2020 2020 2020   = 0)..         
+00043e50: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00043e60: 2020 2020 2020 2020 2020 2323 2323 2043            #### C
+00043e70: 6174 426f 6f73 7420 646f 6573 206e 6f74  atBoost does not
+00043e80: 206e 6565 6420 4879 7065 7220 5061 7261   need Hyper Para
+00043e90: 6d65 7465 7220 7475 6e69 6e67 203d 3e20  meter tuning => 
+00043ea0: 6974 2773 2067 7265 6174 206f 7574 206f  it's great out o
+00043eb0: 6620 7468 6520 626f 7821 0d0a 2020 2020  f the box!..    
+00043ec0: 2020 2020 2020 2020 2020 2020 6773 203d              gs =
+00043ed0: 2063 6f70 792e 6465 6570 636f 7079 2878   copy.deepcopy(x
+00043ee0: 6762 6d29 0d0a 2020 2020 2020 2020 656c  gbm)..        el
+00043ef0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00043f00: 2023 2320 466f 7220 6d75 6c74 692d 6c61   ## For multi-la
+00043f10: 6265 6c20 7072 6f62 6c65 6d73 2c20 796f  bel problems, yo
+00043f20: 7520 6361 6e27 7420 646f 2047 7269 6453  u can't do GridS
+00043f30: 6561 7263 6820 6f72 2052 616e 646f 6d69  earch or Randomi
+00043f40: 7a65 6453 6561 7263 6820 7369 6e63 6520  zedSearch since 
+00043f50: 6974 2077 696c 6c20 7461 6b65 2074 6f6f  it will take too
+00043f60: 206c 6f6e 670d 0a20 2020 2020 2020 2020   long..         
+00043f70: 2020 2067 7320 3d20 636f 7079 2e64 6565     gs = copy.dee
+00043f80: 7063 6f70 7928 7867 626d 290d 0a20 2020  pcopy(xgbm)..   
+00043f90: 2023 7472 6169 6e73 2061 6e64 206f 7074   #trains and opt
+00043fa0: 696d 697a 6573 2074 6865 206d 6f64 656c  imizes the model
+00043fb0: 2023 2323 2323 2323 2323 0d0a 2020 2020   #########..    
+00043fc0: 6576 616c 5f73 6574 203d 205b 2858 5f74  eval_set = [(X_t
+00043fd0: 7261 696e 2c79 5f74 7261 696e 292c 2858  rain,y_train),(X
+00043fe0: 5f63 762c 795f 6376 295d 0d0a 2020 2020  _cv,y_cv)]..    
+00043ff0: 7072 696e 7428 2746 696e 6469 6e67 2042  print('Finding B
+00044000: 6573 7420 4d6f 6465 6c20 616e 6420 4879  est Model and Hy
+00044010: 7065 7220 5061 7261 6d65 7465 7273 2066  per Parameters f
+00044020: 6f72 2025 7320 6d6f 6465 6c2e 2e2e 2720  or %s model...' 
+00044030: 256d 6f64 656c 5f6e 616d 6529 0d0a 2020  %model_name)..  
+00044040: 2020 2323 2323 2320 4865 7265 2069 7320    ##### Here is 
+00044050: 7768 6572 6520 7765 2070 7574 2074 6865  where we put the
+00044060: 2070 6172 745f 7472 6169 6e20 616e 6420   part_train and 
+00044070: 7061 7274 5f63 7620 746f 6765 7468 6572  part_cv together
+00044080: 2023 2323 2323 2323 2323 2323 0d0a 2020   ###########..  
+00044090: 2020 6966 206d 6f64 656c 7479 7065 2021    if modeltype !
+000440a0: 3d20 2752 6567 7265 7373 696f 6e27 3a0d  = 'Regression':.
+000440b0: 0a20 2020 2020 2020 2023 2323 2044 6f20  .        ### Do 
+000440c0: 7468 6973 206f 6e6c 7920 666f 7220 4269  this only for Bi
+000440d0: 6e61 7279 2043 6c61 7373 6573 2061 6e64  nary Classes and
+000440e0: 204d 756c 7469 2d43 6c61 7373 6573 2c20   Multi-Classes, 
+000440f0: 626f 7468 2061 7265 206f 6b61 790d 0a20  both are okay.. 
+00044100: 2020 2020 2020 2062 6173 656c 696e 655f         baseline_
+00044110: 6163 6375 203d 2031 2d28 7472 6169 6e5b  accu = 1-(train[
+00044120: 6561 6368 5f74 6172 6765 745d 2e76 616c  each_target].val
+00044130: 7565 5f63 6f75 6e74 7328 3129 2e73 6f72  ue_counts(1).sor
+00044140: 745f 7661 6c75 6573 2829 295b 7261 7265  t_values())[rare
+00044150: 5f63 6c61 7373 5d0d 0a20 2020 2020 2020  _class]..       
+00044160: 2070 7269 6e74 2827 2020 2020 4261 7365   print('    Base
+00044170: 6c69 6e65 2041 6363 7572 6163 7920 4e65  line Accuracy Ne
+00044180: 6564 6564 2066 6f72 204d 6f64 656c 203d  eded for Model =
+00044190: 2025 302e 3266 2525 2720 2528 6261 7365   %0.2f%%' %(base
+000441a0: 6c69 6e65 5f61 6363 752a 3130 3029 290d  line_accu*100)).
+000441b0: 0a20 2020 2070 7269 6e74 2827 2020 2020  .    print('    
+000441c0: 4350 5520 436f 756e 7420 3d20 2573 2069  CPU Count = %s i
+000441d0: 6e20 7468 6973 2064 6576 6963 6527 2025  n this device' %
+000441e0: 4350 555f 636f 756e 7429 0d0a 2020 2020  CPU_count)..    
+000441f0: 6966 206d 6f64 656c 7479 7065 203d 3d20  if modeltype == 
+00044200: 2752 6567 7265 7373 696f 6e27 3a0d 0a20  'Regression':.. 
+00044210: 2020 2020 2020 2069 6620 426f 6f73 7469         if Boosti
+00044220: 6e67 5f46 6c61 673a 0d0a 2020 2020 2020  ng_Flag:..      
+00044230: 2020 2020 2020 6966 206d 6f64 656c 5f6e        if model_n
+00044240: 616d 652e 6c6f 7765 7228 2920 3d3d 2027  ame.lower() == '
+00044250: 6361 7462 6f6f 7374 273a 0d0a 2020 2020  catboost':..    
+00044260: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00044270: 5f64 696d 203d 2064 6174 615f 6469 6d2a  _dim = data_dim*
+00044280: 6f6e 655f 686f 745f 7369 7a65 2f6c 656e  one_hot_size/len
+00044290: 2870 7265 6473 290d 0a20 2020 2020 2020  (preds)..       
+000442a0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+000442b0: 5573 696e 6720 2573 204d 6f64 656c 2c20  Using %s Model, 
+000442c0: 4573 7469 6d61 7465 6420 5472 6169 6e69  Estimated Traini
+000442d0: 6e67 2074 696d 6520 3d20 2530 2e33 6620  ng time = %0.3f 
+000442e0: 6d69 6e73 2720 2528 6d6f 6465 6c5f 6e61  mins' %(model_na
+000442f0: 6d65 2c64 6174 615f 6469 6d2a 6d61 785f  me,data_dim*max_
+00044300: 636c 6173 735f 6c65 6e67 7468 2a6c 656e  class_length*len
+00044310: 2874 6172 6765 7429 2f28 3330 3030 3030  (target)/(300000
+00044320: 302e 2a43 5055 5f63 6f75 6e74 2929 290d  0.*CPU_count))).
+00044330: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00044340: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00044350: 2020 2020 7072 696e 7428 2755 7369 6e67      print('Using
+00044360: 2025 7320 4d6f 6465 6c2c 2045 7374 696d   %s Model, Estim
+00044370: 6174 6564 2054 7261 696e 696e 6720 7469  ated Training ti
+00044380: 6d65 203d 2025 302e 3366 206d 696e 7327  me = %0.3f mins'
+00044390: 2025 286d 6f64 656c 5f6e 616d 652c 6461   %(model_name,da
+000443a0: 7461 5f64 696d 2a6d 6178 5f63 6c61 7373  ta_dim*max_class
+000443b0: 5f6c 656e 6774 682a 6c65 6e28 7461 7267  _length*len(targ
+000443c0: 6574 292f 2835 3030 3030 2e2a 4350 555f  et)/(50000.*CPU_
+000443d0: 636f 756e 7429 2929 0d0a 2020 2020 2020  count)))..      
+000443e0: 2020 656c 6966 2042 6f6f 7374 696e 675f    elif Boosting_
+000443f0: 466c 6167 2069 7320 4e6f 6e65 3a0d 0a20  Flag is None:.. 
+00044400: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00044410: 2827 5573 696e 6720 2573 204d 6f64 656c  ('Using %s Model
+00044420: 2c20 4573 7469 6d61 7465 6420 5472 6169  , Estimated Trai
+00044430: 6e69 6e67 2074 696d 6520 3d20 2530 2e33  ning time = %0.3
+00044440: 6620 6d69 6e73 2720 2528 6d6f 6465 6c5f  f mins' %(model_
+00044450: 6e61 6d65 2c64 6174 615f 6469 6d2a 6d61  name,data_dim*ma
+00044460: 785f 636c 6173 735f 6c65 6e67 7468 2a6c  x_class_length*l
+00044470: 656e 2874 6172 6765 7429 2f28 3830 3030  en(target)/(8000
+00044480: 302e 2a43 5055 5f63 6f75 6e74 2929 290d  0.*CPU_count))).
+00044490: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+000444a0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+000444b0: 7428 2755 7369 6e67 2025 7320 4d6f 6465  t('Using %s Mode
+000444c0: 6c2c 2045 7374 696d 6174 6564 2054 7261  l, Estimated Tra
+000444d0: 696e 696e 6720 7469 6d65 203d 2025 302e  ining time = %0.
+000444e0: 3366 206d 696e 7327 2025 286d 6f64 656c  3f mins' %(model
+000444f0: 5f6e 616d 652c 6461 7461 5f64 696d 2a6d  _name,data_dim*m
+00044500: 6178 5f63 6c61 7373 5f6c 656e 6774 682a  ax_class_length*
+00044510: 6c65 6e28 7461 7267 6574 292f 2834 3030  len(target)/(400
+00044520: 3030 2e2a 4350 555f 636f 756e 7429 2929  00.*CPU_count)))
+00044530: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
+00044540: 2020 2020 2023 2323 2323 2054 6869 7320       ##### This 
+00044550: 6973 2066 6f72 2063 6c61 7373 6966 6963  is for classific
+00044560: 6174 696f 6e20 7768 6963 6820 6469 6666  ation which diff
+00044570: 6572 7320 666f 7220 4772 6964 5365 6172  ers for GridSear
+00044580: 6368 2076 7320 5261 6e64 6f6d 697a 6564  ch vs Randomized
+00044590: 5365 6172 6368 2023 2323 2323 2323 2323  Search #########
+000445a0: 2323 2323 230d 0a20 2020 2020 2020 2069  #####..        i
+000445b0: 6620 6879 7065 725f 7061 7261 6d20 3d3d  f hyper_param ==
+000445c0: 2027 4753 273a 0d0a 2020 2020 2020 2020   'GS':..        
+000445d0: 2020 2020 6966 2042 6f6f 7374 696e 675f      if Boosting_
+000445e0: 466c 6167 3a0d 0a20 2020 2020 2020 2020  Flag:..         
+000445f0: 2020 2020 2020 2069 6620 6d6f 6465 6c5f         if model_
+00044600: 6e61 6d65 2e6c 6f77 6572 2829 203d 3d20  name.lower() == 
+00044610: 2763 6174 626f 6f73 7427 3a0d 0a20 2020  'catboost':..   
+00044620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044630: 2064 6174 615f 6469 6d20 3d20 6461 7461   data_dim = data
+00044640: 5f64 696d 2a6f 6e65 5f68 6f74 5f73 697a  _dim*one_hot_siz
+00044650: 652f 6c65 6e28 7072 6564 7329 0d0a 2020  e/len(preds)..  
+00044660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044670: 2020 7072 696e 7428 2755 7369 6e67 2025    print('Using %
+00044680: 7320 4d6f 6465 6c2c 2045 7374 696d 6174  s Model, Estimat
+00044690: 6564 2054 7261 696e 696e 6720 7469 6d65  ed Training time
+000446a0: 203d 2025 302e 3366 206d 696e 7327 2025   = %0.3f mins' %
+000446b0: 286d 6f64 656c 5f6e 616d 652c 6461 7461  (model_name,data
+000446c0: 5f64 696d 2a6d 6178 5f63 6c61 7373 5f6c  _dim*max_class_l
+000446d0: 656e 6774 682a 6c65 6e28 7461 7267 6574  ength*len(target
+000446e0: 292f 2833 3030 3030 302e 2a43 5055 5f63  )/(300000.*CPU_c
+000446f0: 6f75 6e74 2929 290d 0a20 2020 2020 2020  ount)))..       
+00044700: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00044710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044720: 2020 2020 7072 696e 7428 2755 7369 6e67      print('Using
+00044730: 2025 7320 4d6f 6465 6c2c 2045 7374 696d   %s Model, Estim
+00044740: 6174 6564 2054 7261 696e 696e 6720 7469  ated Training ti
+00044750: 6d65 203d 2025 302e 3366 206d 696e 7327  me = %0.3f mins'
+00044760: 2025 286d 6f64 656c 5f6e 616d 652c 6461   %(model_name,da
+00044770: 7461 5f64 696d 2a28 6d61 785f 636c 6173  ta_dim*(max_clas
+00044780: 735f 6c65 6e67 7468 2a2a 3229 2a6c 656e  s_length**2)*len
+00044790: 2874 6172 6765 7429 2f28 3130 3030 3030  (target)/(100000
+000447a0: 2e2a 4350 555f 636f 756e 7429 2929 0d0a  .*CPU_count)))..
+000447b0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+000447c0: 2042 6f6f 7374 696e 675f 466c 6167 2069   Boosting_Flag i
+000447d0: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
+000447e0: 2020 2020 2020 2020 2023 2323 2320 4120           #### A 
+000447f0: 4c69 6e65 6172 206d 6f64 656c 2069 7320  Linear model is 
+00044800: 7573 7561 6c6c 7920 7468 6520 6661 7374  usually the fast
+00044810: 6573 7420 2323 2323 2323 2323 2323 230d  est ###########.
+00044820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00044830: 2070 7269 6e74 2827 5573 696e 6720 2573   print('Using %s
+00044840: 204d 6f64 656c 2c20 4573 7469 6d61 7465   Model, Estimate
+00044850: 6420 5472 6169 6e69 6e67 2074 696d 6520  d Training time 
+00044860: 3d20 2530 2e33 6620 6d69 6e73 2720 2528  = %0.3f mins' %(
+00044870: 6d6f 6465 6c5f 6e61 6d65 2c64 6174 615f  model_name,data_
+00044880: 6469 6d2a 6d61 785f 636c 6173 735f 6c65  dim*max_class_le
+00044890: 6e67 7468 2a6c 656e 2874 6172 6765 7429  ngth*len(target)
+000448a0: 2f28 3530 3030 302e 2a43 5055 5f63 6f75  /(50000.*CPU_cou
+000448b0: 6e74 2929 290d 0a20 2020 2020 2020 2020  nt)))..         
+000448c0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000448d0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+000448e0: 2755 7369 6e67 2025 7320 4d6f 6465 6c2c  'Using %s Model,
+000448f0: 2045 7374 696d 6174 6564 2054 7261 696e   Estimated Train
+00044900: 696e 6720 7469 6d65 203d 2025 302e 3366  ing time = %0.3f
+00044910: 206d 696e 7327 2025 286d 6f64 656c 5f6e   mins' %(model_n
+00044920: 616d 652c 6461 7461 5f64 696d 2a6d 6178  ame,data_dim*max
+00044930: 5f63 6c61 7373 5f6c 656e 6774 682a 6c65  _class_length*le
+00044940: 6e28 7461 7267 6574 292f 2831 3630 3030  n(target)/(16000
+00044950: 2e2a 4350 555f 636f 756e 7429 2929 0d0a  .*CPU_count)))..
+00044960: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00044970: 2020 2020 2020 2020 2020 2069 6620 426f             if Bo
+00044980: 6f73 7469 6e67 5f46 6c61 673a 0d0a 2020  osting_Flag:..  
+00044990: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000449a0: 206d 6f64 656c 5f6e 616d 652e 6c6f 7765   model_name.lowe
+000449b0: 7228 2920 3d3d 2027 6361 7462 6f6f 7374  r() == 'catboost
+000449c0: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+000449d0: 2020 2020 2020 2020 6461 7461 5f64 696d          data_dim
+000449e0: 203d 2064 6174 615f 6469 6d2a 6f6e 655f   = data_dim*one_
+000449f0: 686f 745f 7369 7a65 2f6c 656e 2870 7265  hot_size/len(pre
+00044a00: 6473 290d 0a20 2020 2020 2020 2020 2020  ds)..           
+00044a10: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00044a20: 5573 696e 6720 2573 204d 6f64 656c 2c20  Using %s Model, 
+00044a30: 4573 7469 6d61 7465 6420 5472 6169 6e69  Estimated Traini
+00044a40: 6e67 2074 696d 6520 3d20 2530 2e32 6620  ng time = %0.2f 
+00044a50: 6d69 6e73 2720 2528 6d6f 6465 6c5f 6e61  mins' %(model_na
+00044a60: 6d65 2c64 6174 615f 6469 6d2a 6d61 785f  me,data_dim*max_
+00044a70: 636c 6173 735f 6c65 6e67 7468 2a6c 656e  class_length*len
+00044a80: 2874 6172 6765 7429 2f28 3330 3030 3030  (target)/(300000
+00044a90: 302e 2a43 5055 5f63 6f75 6e74 2929 290d  0.*CPU_count))).
+00044aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00044ab0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00044ac0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00044ad0: 7428 2755 7369 6e67 2025 7320 4d6f 6465  t('Using %s Mode
+00044ae0: 6c2c 2045 7374 696d 6174 6564 2054 7261  l, Estimated Tra
+00044af0: 696e 696e 6720 7469 6d65 203d 2025 302e  ining time = %0.
+00044b00: 3266 206d 696e 7327 2025 286d 6f64 656c  2f mins' %(model
+00044b10: 5f6e 616d 652c 6461 7461 5f64 696d 2a28  _name,data_dim*(
+00044b20: 6d61 785f 636c 6173 735f 6c65 6e67 7468  max_class_length
+00044b30: 292a 6c65 6e28 7461 7267 6574 292a 2a32  )*len(target)**2
+00044b40: 2f28 3430 3030 302e 2a43 5055 5f63 6f75  /(40000.*CPU_cou
+00044b50: 6e74 2929 290d 0a20 2020 2020 2020 2020  nt)))..         
+00044b60: 2020 2065 6c69 6620 426f 6f73 7469 6e67     elif Boosting
+00044b70: 5f46 6c61 6720 6973 204e 6f6e 653a 0d0a  _Flag is None:..
+00044b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044b90: 7072 696e 7428 2755 7369 6e67 2025 7320  print('Using %s 
+00044ba0: 4d6f 6465 6c2c 2045 7374 696d 6174 6564  Model, Estimated
+00044bb0: 2054 7261 696e 696e 6720 7469 6d65 203d   Training time =
+00044bc0: 2025 302e 3266 206d 696e 7327 2025 286d   %0.2f mins' %(m
+00044bd0: 6f64 656c 5f6e 616d 652c 6461 7461 5f64  odel_name,data_d
+00044be0: 696d 2a6d 6178 5f63 6c61 7373 5f6c 656e  im*max_class_len
+00044bf0: 6774 682a 6c65 6e28 7461 7267 6574 292f  gth*len(target)/
+00044c00: 2831 3030 3030 302e 2a43 5055 5f63 6f75  (100000.*CPU_cou
+00044c10: 6e74 2929 290d 0a20 2020 2020 2020 2020  nt)))..         
+00044c20: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00044c30: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00044c40: 2755 7369 6e67 2025 7320 4d6f 6465 6c2c  'Using %s Model,
+00044c50: 2045 7374 696d 6174 6564 2054 7261 696e   Estimated Train
+00044c60: 696e 6720 7469 6d65 203d 2025 302e 3266  ing time = %0.2f
+00044c70: 206d 696e 7327 2025 286d 6f64 656c 5f6e   mins' %(model_n
+00044c80: 616d 652c 6461 7461 5f64 696d 2a6d 6178  ame,data_dim*max
+00044c90: 5f63 6c61 7373 5f6c 656e 6774 682a 6c65  _class_length*le
+00044ca0: 6e28 7461 7267 6574 292f 2832 3530 3030  n(target)/(25000
+00044cb0: 2e2a 4350 555f 636f 756e 7429 2929 0d0a  .*CPU_count)))..
+00044cc0: 2020 2020 2323 2323 2320 5369 6e63 6520      ##### Since 
+00044cd0: 7765 2061 7265 2075 7369 6e67 204d 756c  we are using Mul
+00044ce0: 7469 706c 6520 4d6f 6465 6c73 2065 6163  tiple Models eac
+00044cf0: 6820 7769 7468 2069 7473 206f 776e 2071  h with its own q
+00044d00: 7569 726b 732c 2077 6520 6861 7665 2074  uirks, we have t
+00044d10: 6f20 6d61 6b65 2073 7572 6520 6974 2069  o make sure it i
+00044d20: 7320 646f 6e65 2074 6869 7320 7761 790d  s done this way.
+00044d30: 0a20 2020 2023 2323 2323 2023 2323 2323  .    ##### #####
+00044d40: 2323 2323 2323 2320 2020 2020 2054 5241  #######      TRA
+00044d50: 494e 494e 4720 4d4f 4445 4c20 4649 5253  INING MODEL FIRS
+00044d60: 5420 5449 4d45 2057 4954 4820 585f 5452  T TIME WITH X_TR
+00044d70: 4149 4e20 414e 4420 5445 5354 494e 4720  AIN AND TESTING 
+00044d80: 4f4e 2058 5f43 5620 2323 2323 2323 2323  ON X_CV ########
+00044d90: 2323 2323 0d0a 2020 2020 6d6f 6465 6c5f  ####..    model_
+00044da0: 7374 6172 745f 7469 6d65 203d 2074 696d  start_time = tim
+00044db0: 652e 7469 6d65 2829 0d0a 2020 2020 2323  e.time()..    ##
+00044dc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00044dd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00044de0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00044df0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00044e00: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00044e10: 0a20 2020 2023 2323 2323 2020 2042 4520  .    #####   BE 
-00044e20: 5645 5259 2043 4152 4546 554c 2041 424f  VERY CAREFUL ABO
-00044e30: 5554 204d 4f44 4946 5949 4e47 2054 4849  UT MODIFYING THI
-00044e40: 5320 5345 4354 494f 4e20 4a55 5354 2042  S SECTION JUST B
-00044e50: 4543 4155 5345 2023 2323 2323 2323 2323  ECAUSE #########
-00044e60: 230d 0a20 2020 2023 2323 2320 2020 2049  #..    ####    I
-00044e70: 5420 4150 5045 4152 5320 4c49 4b45 2044  T APPEARS LIKE D
-00044e80: 5550 4c49 4341 5445 4420 434f 4445 2121  UPLICATED CODE!!
-00044e90: 2020 4954 2049 5320 4e4f 5420 2121 2020    IT IS NOT !!  
-00044ea0: 2020 2020 2020 2323 2323 2323 2323 2323        ##########
-00044eb0: 2323 230d 0a20 2020 2023 2323 2323 2323  ###..    #######
+00044e00: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+00044e10: 2323 2323 2320 2020 4245 2056 4552 5920  #####   BE VERY 
+00044e20: 4341 5245 4655 4c20 4142 4f55 5420 4d4f  CAREFUL ABOUT MO
+00044e30: 4449 4659 494e 4720 5448 4953 2053 4543  DIFYING THIS SEC
+00044e40: 5449 4f4e 204a 5553 5420 4245 4341 5553  TION JUST BECAUS
+00044e50: 4520 2323 2323 2323 2323 2323 0d0a 2020  E ##########..  
+00044e60: 2020 2323 2323 2020 2020 4954 2041 5050    ####    IT APP
+00044e70: 4541 5253 204c 494b 4520 4455 504c 4943  EARS LIKE DUPLIC
+00044e80: 4154 4544 2043 4f44 4521 2120 2049 5420  ATED CODE!!  IT 
+00044e90: 4953 204e 4f54 2021 2120 2020 2020 2020  IS NOT !!       
+00044ea0: 2023 2323 2323 2323 2323 2323 2323 0d0a   #############..
+00044eb0: 2020 2020 2323 2323 2323 2323 2323 2323      ############
 00044ec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00044ed0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00044ee0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00044ef0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00044f00: 2323 2323 230d 0a20 2020 2023 2323 2323  #####..    #####
-00044f10: 2054 6869 7320 6973 2077 6865 7265 2079   This is where y
-00044f20: 6f75 2073 7461 7274 2074 7261 696e 696e  ou start trainin
-00044f30: 6720 7468 6520 6d6f 6465 6c20 666f 7220  g the model for 
-00044f40: 4649 5253 5420 5449 4d45 2020 2323 2323  FIRST TIME  ####
-00044f50: 2323 2323 2323 2323 0d0a 2020 2020 6966  ########..    if
-00044f60: 206d 6f64 656c 5f6c 6162 656c 203d 3d20   model_label == 
-00044f70: 2753 696e 676c 655f 4c61 6265 6c27 3a0d  'Single_Label':.
-00044f80: 0a20 2020 2020 2020 2069 6620 496d 6261  .        if Imba
-00044f90: 6c61 6e63 6564 5f46 6c61 673a 0d0a 2020  lanced_Flag:..  
-00044fa0: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
-00044fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044fc0: 7072 696e 7428 2723 2323 2323 2323 2323  print('#########
-00044fd0: 2323 2323 2323 2323 2320 2049 6d62 616c  #########  Imbal
-00044fe0: 616e 6365 6420 4d6f 6465 6c20 5472 6169  anced Model Trai
-00044ff0: 6e69 6e67 2020 2323 2323 2323 2323 2323  ning  ##########
-00045000: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00045010: 2323 2729 0d0a 2020 2020 2020 2020 2020  ##')..          
-00045020: 2020 2020 2020 7072 696e 7428 2749 6d62        print('Imb
-00045030: 616c 616e 6365 6420 5472 6169 6e69 6e67  alanced Training
-00045040: 2075 7369 6e67 2053 4d4f 5445 2052 6172   using SMOTE Rar
-00045050: 6520 436c 6173 7320 4f76 6572 7361 6d70  e Class Oversamp
-00045060: 6c69 6e67 206d 6574 686f 642e 2e2e 2729  ling method...')
-00045070: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00045080: 2020 6966 206d 6f64 656c 7479 7065 203d    if modeltype =
-00045090: 3d20 2752 6567 7265 7373 696f 6e27 3a0d  = 'Regression':.
-000450a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000450b0: 2020 2020 2023 2323 2053 696e 6365 2072       ### Since r
-000450c0: 6172 6520 636c 6173 7320 6973 206e 6565  are class is nee
-000450d0: 6465 6420 696e 2074 6865 206e 6578 7420  ded in the next 
-000450e0: 7374 6570 2c20 6a75 7374 2073 6574 7469  step, just setti
-000450f0: 6e67 2074 6865 2072 6172 655f 636c 6173  ng the rare_clas
-00045100: 7320 6173 2061 7274 6966 6963 6961 6c6c  s as artificiall
-00045110: 7920 302e 0d0a 2020 2020 2020 2020 2020  y 0...          
-00045120: 2020 2020 2020 2020 2020 7261 7265 5f63            rare_c
-00045130: 6c61 7373 203d 2030 0d0a 2020 2020 2020  lass = 0..      
-00045140: 2020 2020 2020 2020 2020 2323 2320 5369            ### Si
-00045150: 6e63 6520 6974 2069 7320 6120 7369 6e67  nce it is a sing
-00045160: 6c65 206c 6162 656c 2070 726f 626c 656d  le label problem
-00045170: 2c20 7765 2075 7365 2065 6163 685f 7461  , we use each_ta
-00045180: 7267 6574 2069 6e73 7465 6164 206f 6620  rget instead of 
-00045190: 7461 7267 6574 0d0a 2020 2020 2020 2020  target..        
-000451a0: 2020 2020 2020 2020 2323 2320 2020 416c          ###   Al
-000451b0: 736f 2064 6f20 6e6f 7420 7573 6520 7468  so do not use th
-000451c0: 6520 4772 6964 5365 6172 6368 4356 206d  e GridSearchCV m
-000451d0: 6f64 656c 2047 5320 6865 7265 2073 696e  odel GS here sin
-000451e0: 6365 2053 4d4f 5445 2063 616e 6e6f 7420  ce SMOTE cannot 
-000451f0: 776f 726b 2077 6974 6820 6974 0d0a 2020  work with it..  
-00045200: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-00045210: 2320 7573 6520 7468 6520 6261 7365 206d  # use the base m
-00045220: 6f64 656c 2074 7261 696e 6564 2077 6974  odel trained wit
-00045230: 6820 534d 4f54 452e 0d0a 2020 2020 2020  h SMOTE...      
-00045240: 2020 2020 2020 2020 2020 6d6f 6465 6c20            model 
-00045250: 3d20 7472 6169 6e69 6e67 5f77 6974 685f  = training_with_
-00045260: 534d 4f54 4528 585f 7472 6169 6e2c 795f  SMOTE(X_train,y_
-00045270: 7472 6169 6e2c 6561 6368 5f74 6172 6765  train,each_targe
-00045280: 742c 6576 616c 5f73 6574 2c20 7867 626d  t,eval_set, xgbm
-00045290: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00044f00: 0d0a 2020 2020 2323 2323 2320 5468 6973  ..    ##### This
+00044f10: 2069 7320 7768 6572 6520 796f 7520 7374   is where you st
+00044f20: 6172 7420 7472 6169 6e69 6e67 2074 6865  art training the
+00044f30: 206d 6f64 656c 2066 6f72 2046 4952 5354   model for FIRST
+00044f40: 2054 494d 4520 2023 2323 2323 2323 2323   TIME  #########
+00044f50: 2323 230d 0a20 2020 2069 6620 6d6f 6465  ###..    if mode
+00044f60: 6c5f 6c61 6265 6c20 3d3d 2027 5369 6e67  l_label == 'Sing
+00044f70: 6c65 5f4c 6162 656c 273a 0d0a 2020 2020  le_Label':..    
+00044f80: 2020 2020 6966 2049 6d62 616c 616e 6365      if Imbalance
+00044f90: 645f 466c 6167 3a0d 0a20 2020 2020 2020  d_Flag:..       
+00044fa0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+00044fb0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00044fc0: 2827 2323 2323 2323 2323 2323 2323 2323  ('##############
+00044fd0: 2323 2323 2020 496d 6261 6c61 6e63 6564  ####  Imbalanced
+00044fe0: 204d 6f64 656c 2054 7261 696e 696e 6720   Model Training 
+00044ff0: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
+00045000: 2323 2323 2323 2323 2323 2323 2327 290d  #############').
+00045010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00045020: 2070 7269 6e74 2827 496d 6261 6c61 6e63   print('Imbalanc
+00045030: 6564 2054 7261 696e 696e 6720 7573 696e  ed Training usin
+00045040: 6720 534d 4f54 4520 5261 7265 2043 6c61  g SMOTE Rare Cla
+00045050: 7373 204f 7665 7273 616d 706c 696e 6720  ss Oversampling 
+00045060: 6d65 7468 6f64 2e2e 2e27 290d 0a20 2020  method...')..   
+00045070: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00045080: 6d6f 6465 6c74 7970 6520 3d3d 2027 5265  modeltype == 'Re
+00045090: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
+000450a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000450b0: 2323 2320 5369 6e63 6520 7261 7265 2063  ### Since rare c
+000450c0: 6c61 7373 2069 7320 6e65 6564 6564 2069  lass is needed i
+000450d0: 6e20 7468 6520 6e65 7874 2073 7465 702c  n the next step,
+000450e0: 206a 7573 7420 7365 7474 696e 6720 7468   just setting th
+000450f0: 6520 7261 7265 5f63 6c61 7373 2061 7320  e rare_class as 
+00045100: 6172 7469 6669 6369 616c 6c79 2030 2e0d  artificially 0..
+00045110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00045120: 2020 2020 2072 6172 655f 636c 6173 7320       rare_class 
+00045130: 3d20 300d 0a20 2020 2020 2020 2020 2020  = 0..           
+00045140: 2020 2020 2023 2323 2053 696e 6365 2069       ### Since i
+00045150: 7420 6973 2061 2073 696e 676c 6520 6c61  t is a single la
+00045160: 6265 6c20 7072 6f62 6c65 6d2c 2077 6520  bel problem, we 
+00045170: 7573 6520 6561 6368 5f74 6172 6765 7420  use each_target 
+00045180: 696e 7374 6561 6420 6f66 2074 6172 6765  instead of targe
+00045190: 740d 0a20 2020 2020 2020 2020 2020 2020  t..             
+000451a0: 2020 2023 2323 2020 2041 6c73 6f20 646f     ###   Also do
+000451b0: 206e 6f74 2075 7365 2074 6865 2047 7269   not use the Gri
+000451c0: 6453 6561 7263 6843 5620 6d6f 6465 6c20  dSearchCV model 
+000451d0: 4753 2068 6572 6520 7369 6e63 6520 534d  GS here since SM
+000451e0: 4f54 4520 6361 6e6e 6f74 2077 6f72 6b20  OTE cannot work 
+000451f0: 7769 7468 2069 740d 0a20 2020 2020 2020  with it..       
+00045200: 2020 2020 2020 2020 2023 2323 2075 7365           ### use
+00045210: 2074 6865 2062 6173 6520 6d6f 6465 6c20   the base model 
+00045220: 7472 6169 6e65 6420 7769 7468 2053 4d4f  trained with SMO
+00045230: 5445 2e0d 0a20 2020 2020 2020 2020 2020  TE...           
+00045240: 2020 2020 206d 6f64 656c 203d 2074 7261       model = tra
+00045250: 696e 696e 675f 7769 7468 5f53 4d4f 5445  ining_with_SMOTE
+00045260: 2858 5f74 7261 696e 2c79 5f74 7261 696e  (X_train,y_train
+00045270: 2c65 6163 685f 7461 7267 6574 2c65 7661  ,each_target,eva
+00045280: 6c5f 7365 742c 2078 6762 6d2c 0d0a 2020  l_set, xgbm,..  
+00045290: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000452a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000452b0: 2020 2020 2020 2020 2020 426f 6f73 7469            Boosti
-000452c0: 6e67 5f46 6c61 672c 2065 7661 6c5f 6d65  ng_Flag, eval_me
-000452d0: 7472 6963 2c0d 0a20 2020 2020 2020 2020  tric,..         
+000452b0: 2020 2020 2042 6f6f 7374 696e 675f 466c       Boosting_Fl
+000452c0: 6167 2c20 6576 616c 5f6d 6574 7269 632c  ag, eval_metric,
+000452d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 000452e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000452f0: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-00045300: 6465 6c74 7970 652c 206d 6f64 656c 5f6e  deltype, model_n
-00045310: 616d 652c 2074 7261 696e 696e 673d 5472  ame, training=Tr
-00045320: 7565 2c0d 0a20 2020 2020 2020 2020 2020  ue,..           
+000452f0: 2020 2020 2020 2020 206d 6f64 656c 7479           modelty
+00045300: 7065 2c20 6d6f 6465 6c5f 6e61 6d65 2c20  pe, model_name, 
+00045310: 7472 6169 6e69 6e67 3d54 7275 652c 0d0a  training=True,..
+00045320: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00045330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045340: 2020 2020 2020 2020 2020 2020 6d69 6e6f              mino
-00045350: 7269 7479 5f63 6c61 7373 3d72 6172 655f  rity_class=rare_
-00045360: 636c 6173 732c 696d 705f 6361 7473 3d69  class,imp_cats=i
-00045370: 6d70 5f63 6174 732c 0d0a 2020 2020 2020  mp_cats,..      
+00045340: 2020 2020 2020 206d 696e 6f72 6974 795f         minority_
+00045350: 636c 6173 733d 7261 7265 5f63 6c61 7373  class=rare_class
+00045360: 2c69 6d70 5f63 6174 733d 696d 705f 6361  ,imp_cats=imp_ca
+00045370: 7473 2c0d 0a20 2020 2020 2020 2020 2020  ts,..           
 00045380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000453a0: 2063 616c 6962 7261 746f 725f 666c 6167   calibrator_flag
-000453b0: 3d63 616c 6962 7261 746f 725f 666c 6167  =calibrator_flag
-000453c0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00045390: 2020 2020 2020 2020 2020 2020 6361 6c69              cali
+000453a0: 6272 6174 6f72 5f66 6c61 673d 6361 6c69  brator_flag=cali
+000453b0: 6272 6174 6f72 5f66 6c61 672c 0d0a 2020  brator_flag,..  
+000453c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000453d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000453e0: 2020 2020 2020 2020 2020 4750 555f 6578            GPU_ex
-000453f0: 6973 7473 3d47 5055 5f65 7869 7374 732c  ists=GPU_exists,
-00045400: 2070 6172 616d 7320 3d20 6370 755f 7061   params = cpu_pa
-00045410: 7261 6d73 2c0d 0a20 2020 2020 2020 2020  rams,..         
+000453e0: 2020 2020 2047 5055 5f65 7869 7374 733d       GPU_exists=
+000453f0: 4750 555f 6578 6973 7473 2c20 7061 7261  GPU_exists, para
+00045400: 6d73 203d 2063 7075 5f70 6172 616d 732c  ms = cpu_params,
+00045410: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 00045420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045430: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-00045440: 6465 6c5f 6c61 6265 6c3d 6d6f 6465 6c5f  del_label=model_
-00045450: 6c61 6265 6c2c 2076 6572 626f 7365 3d76  label, verbose=v
-00045460: 6572 626f 7365 290d 0a20 2020 2020 2020  erbose)..       
-00045470: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
-00045480: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00045490: 696e 7428 2754 7261 696e 696e 6720 6d6f  int('Training mo
-000454a0: 6465 6c20 6669 7273 7420 7469 6d65 2077  del first time w
-000454b0: 6974 6820 534d 4f54 4520 6572 726f 7269  ith SMOTE errori
-000454c0: 6e67 2e20 436f 6e74 696e 7569 6e67 2e2e  ng. Continuing..
-000454d0: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
-000454e0: 2020 2020 2049 6d62 616c 616e 6365 645f       Imbalanced_
-000454f0: 466c 6167 203d 2020 4661 6c73 650d 0a20  Flag =  False.. 
-00045500: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00045510: 6573 745f 7363 6f72 6520 3d20 300d 0a20  est_score = 0.. 
-00045520: 2020 2023 2323 2323 2323 2323 2020 2049     #########   I
-00045530: 4d50 4f52 5441 4e54 2020 2020 494d 504f  MPORTANT    IMPO
-00045540: 5254 414e 5420 2323 2323 2323 2323 2323  RTANT ##########
+00045430: 2020 2020 2020 2020 206d 6f64 656c 5f6c           model_l
+00045440: 6162 656c 3d6d 6f64 656c 5f6c 6162 656c  abel=model_label
+00045450: 2c20 7665 7262 6f73 653d 7665 7262 6f73  , verbose=verbos
+00045460: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00045470: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+00045480: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00045490: 5472 6169 6e69 6e67 206d 6f64 656c 2066  Training model f
+000454a0: 6972 7374 2074 696d 6520 7769 7468 2053  irst time with S
+000454b0: 4d4f 5445 2065 7272 6f72 696e 672e 2043  MOTE erroring. C
+000454c0: 6f6e 7469 6e75 696e 672e 2e2e 2729 0d0a  ontinuing...')..
+000454d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000454e0: 496d 6261 6c61 6e63 6564 5f46 6c61 6720  Imbalanced_Flag 
+000454f0: 3d20 2046 616c 7365 0d0a 2020 2020 2020  =  False..      
+00045500: 2020 2020 2020 2020 2020 6265 7374 5f73            best_s
+00045510: 636f 7265 203d 2030 0d0a 2020 2020 2323  core = 0..    ##
+00045520: 2323 2323 2323 2320 2020 494d 504f 5254  #######   IMPORT
+00045530: 414e 5420 2020 2049 4d50 4f52 5441 4e54  ANT    IMPORTANT
+00045540: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
 00045550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00045560: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
-00045570: 2023 2320 2020 5468 6f75 6768 2074 6869   ##   Though thi
-00045580: 7320 6e65 7874 2073 7465 7020 6c6f 6f6b  s next step look
-00045590: 7320 6c69 6b65 2069 7420 6973 2061 2043  s like it is a C
-000455a0: 6f64 696e 6720 4d69 7374 616b 652c 2064  oding Mistake, d
-000455b0: 6f6e 2774 2063 6861 6e67 6520 6974 210d  on't change it!.
-000455c0: 0a20 2020 2023 2320 2020 5468 6973 2069  .    ##   This i
-000455d0: 7320 666f 7220 6361 7365 2077 6865 6e20  s for case when 
-000455e0: 496d 6261 6c61 6e63 6564 2077 6974 6820  Imbalanced with 
-000455f0: 436c 6173 7369 6669 6361 7469 6f6e 2073  Classification s
-00045600: 7563 6365 6564 732c 0d0a 2020 2020 2323  ucceeds,..    ##
-00045610: 2020 2074 6869 7320 6e65 7874 2073 7465     this next ste
-00045620: 7020 6973 2073 6b69 7070 6564 2023 230d  p is skipped ##.
-00045630: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
+00045560: 2323 2323 2323 0d0a 2020 2020 2323 2020  ######..    ##  
+00045570: 2054 686f 7567 6820 7468 6973 206e 6578   Though this nex
+00045580: 7420 7374 6570 206c 6f6f 6b73 206c 696b  t step looks lik
+00045590: 6520 6974 2069 7320 6120 436f 6469 6e67  e it is a Coding
+000455a0: 204d 6973 7461 6b65 2c20 646f 6e27 7420   Mistake, don't 
+000455b0: 6368 616e 6765 2069 7421 0d0a 2020 2020  change it!..    
+000455c0: 2323 2020 2054 6869 7320 6973 2066 6f72  ##   This is for
+000455d0: 2063 6173 6520 7768 656e 2049 6d62 616c   case when Imbal
+000455e0: 616e 6365 6420 7769 7468 2043 6c61 7373  anced with Class
+000455f0: 6966 6963 6174 696f 6e20 7375 6363 6565  ification succee
+00045600: 6473 2c0d 0a20 2020 2023 2320 2020 7468  ds,..    ##   th
+00045610: 6973 206e 6578 7420 7374 6570 2069 7320  is next step is 
+00045620: 736b 6970 7065 6420 2323 0d0a 2020 2020  skipped ##..    
+00045630: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00045640: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00045650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00045660: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00045670: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00045680: 2020 2020 2323 2320 5468 6520 6d6f 6465      ### The mode
-00045690: 6c20 626c 6f77 7320 7570 2077 6865 6e20  l blows up when 
-000456a0: 796f 7520 7573 6520 6176 6572 6167 652d  you use average-
-000456b0: 7072 6563 6973 696f 6e20 696e 204d 756c  precision in Mul
-000456c0: 7469 2d43 6c61 7373 6573 202d 3e20 6e65  ti-Classes -> ne
-000456d0: 6564 7320 6368 6563 6b69 6e67 210d 0a20  eds checking!.. 
-000456e0: 2020 200d 0a20 2020 2069 6620 6e6f 7420     ..    if not 
-000456f0: 496d 6261 6c61 6e63 6564 5f46 6c61 673a  Imbalanced_Flag:
-00045700: 0d0a 2020 2020 2020 2020 2323 2323 2054  ..        #### T
-00045710: 6869 7320 6973 2066 6f72 2062 6f74 6820  his is for both 
-00045720: 7265 6775 6c61 7220 5265 6772 6573 7369  regular Regressi
-00045730: 6f6e 2061 6e64 2072 6567 756c 6172 2043  on and regular C
-00045740: 6c61 7373 6966 6963 6174 696f 6e20 4d6f  lassification Mo
-00045750: 6465 6c20 5472 6169 6e69 6e67 2e20 4974  del Training. It
-00045760: 2069 7320 6e6f 7420 6120 4d69 7374 616b   is not a Mistak
-00045770: 6520 2323 2323 2323 2323 2323 2323 230d  e #############.
-00045780: 0a20 2020 2020 2020 2023 2323 2049 6e20  .        ### In 
-00045790: 6361 7365 2049 6d62 616c 616e 6365 6420  case Imbalanced 
-000457a0: 7472 6169 6e69 6e67 2066 6169 6c73 2c20  training fails, 
-000457b0: 7468 6973 206d 6574 686f 6420 6973 2061  this method is a
-000457c0: 6c73 6f20 7472 6965 642e 2054 6861 7427  lso tried. That'
-000457d0: 7320 7768 7920 7765 2074 6573 7420 7468  s why we test th
-000457e0: 6520 466c 6167 2068 6572 6521 2120 2023  e Flag here!!  #
-000457f0: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
-00045800: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-00045810: 2020 2020 2020 2020 6d6f 6465 6c20 3d20          model = 
-00045820: 636f 7079 2e64 6565 7063 6f70 7928 6773  copy.deepcopy(gs
-00045830: 290d 0a20 2020 2020 2020 2020 2020 2069  )..            i
-00045840: 6620 6d6f 6465 6c5f 6c61 6265 6c20 3d3d  f model_label ==
-00045850: 2027 5369 6e67 6c65 5f4c 6162 656c 273a   'Single_Label':
-00045860: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00045870: 2020 6966 2042 6f6f 7374 696e 675f 466c    if Boosting_Fl
-00045880: 6167 3a0d 0a20 2020 2020 2020 2020 2020  ag:..           
-00045890: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
-000458a0: 6c5f 6e61 6d65 203d 3d20 2758 4742 6f6f  l_name == 'XGBoo
-000458b0: 7374 273a 0d0a 2020 2020 2020 2020 2020  st':..          
-000458c0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-000458d0: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
-000458e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000458f0: 6966 2020 6d6f 6465 6c74 7970 6520 3d3d  if  modeltype ==
-00045900: 2027 4d75 6c74 695f 436c 6173 7369 6669   'Multi_Classifi
-00045910: 6361 7469 6f6e 273a 0d0a 2020 2020 2020  cation':..      
+00045670: 2323 2323 2323 2323 230d 0a20 2020 2023  #########..    #
+00045680: 2323 2054 6865 206d 6f64 656c 2062 6c6f  ## The model blo
+00045690: 7773 2075 7020 7768 656e 2079 6f75 2075  ws up when you u
+000456a0: 7365 2061 7665 7261 6765 2d70 7265 6369  se average-preci
+000456b0: 7369 6f6e 2069 6e20 4d75 6c74 692d 436c  sion in Multi-Cl
+000456c0: 6173 7365 7320 2d3e 206e 6565 6473 2063  asses -> needs c
+000456d0: 6865 636b 696e 6721 0d0a 2020 2020 0d0a  hecking!..    ..
+000456e0: 2020 2020 6966 206e 6f74 2049 6d62 616c      if not Imbal
+000456f0: 616e 6365 645f 466c 6167 3a0d 0a20 2020  anced_Flag:..   
+00045700: 2020 2020 2023 2323 2320 5468 6973 2069       #### This i
+00045710: 7320 666f 7220 626f 7468 2072 6567 756c  s for both regul
+00045720: 6172 2052 6567 7265 7373 696f 6e20 616e  ar Regression an
+00045730: 6420 7265 6775 6c61 7220 436c 6173 7369  d regular Classi
+00045740: 6669 6361 7469 6f6e 204d 6f64 656c 2054  fication Model T
+00045750: 7261 696e 696e 672e 2049 7420 6973 206e  raining. It is n
+00045760: 6f74 2061 204d 6973 7461 6b65 2023 2323  ot a Mistake ###
+00045770: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+00045780: 2020 2020 2323 2320 496e 2063 6173 6520      ### In case 
+00045790: 496d 6261 6c61 6e63 6564 2074 7261 696e  Imbalanced train
+000457a0: 696e 6720 6661 696c 732c 2074 6869 7320  ing fails, this 
+000457b0: 6d65 7468 6f64 2069 7320 616c 736f 2074  method is also t
+000457c0: 7269 6564 2e20 5468 6174 2773 2077 6879  ried. That's why
+000457d0: 2077 6520 7465 7374 2074 6865 2046 6c61   we test the Fla
+000457e0: 6720 6865 7265 2121 2020 2323 2323 2323  g here!!  ######
+000457f0: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
+00045800: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
+00045810: 2020 206d 6f64 656c 203d 2063 6f70 792e     model = copy.
+00045820: 6465 6570 636f 7079 2867 7329 0d0a 2020  deepcopy(gs)..  
+00045830: 2020 2020 2020 2020 2020 6966 206d 6f64            if mod
+00045840: 656c 5f6c 6162 656c 203d 3d20 2753 696e  el_label == 'Sin
+00045850: 676c 655f 4c61 6265 6c27 3a0d 0a20 2020  gle_Label':..   
+00045860: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00045870: 426f 6f73 7469 6e67 5f46 6c61 673a 0d0a  Boosting_Flag:..
+00045880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045890: 2020 2020 6966 206d 6f64 656c 5f6e 616d      if model_nam
+000458a0: 6520 3d3d 2027 5847 426f 6f73 7427 3a0d  e == 'XGBoost':.
+000458b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000458c0: 2020 2020 2020 2020 2074 7279 3a0d 0a20           try:.. 
+000458d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000458e0: 2020 2020 2020 2020 2020 2069 6620 206d             if  m
+000458f0: 6f64 656c 7479 7065 203d 3d20 274d 756c  odeltype == 'Mul
+00045900: 7469 5f43 6c61 7373 6966 6963 6174 696f  ti_Classificatio
+00045910: 6e27 3a0d 0a20 2020 2020 2020 2020 2020  n':..           
 00045920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045930: 2020 2020 2020 2020 2020 6d6f 6465 6c2e            model.
-00045940: 6669 7428 585f 7472 6169 6e2c 795f 7472  fit(X_train,y_tr
-00045950: 6169 6e29 0d0a 2020 2020 2020 2020 2020  ain)..          
-00045960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045970: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00045930: 2020 2020 206d 6f64 656c 2e66 6974 2858       model.fit(X
+00045940: 5f74 7261 696e 2c79 5f74 7261 696e 290d  _train,y_train).
+00045950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00045960: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00045970: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
 00045980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045990: 2020 2020 2020 2020 2023 2323 2320 5365           #### Se
-000459a0: 7420 7468 6520 5665 7262 6f73 6520 746f  t the Verbose to
-000459b0: 2030 2073 696e 6365 2077 6520 646f 6e27   0 since we don'
-000459c0: 7420 7761 6e74 2074 6f6f 206d 7563 6820  t want too much 
-000459d0: 6f75 7470 7574 2023 230d 0a20 2020 2020  output ##..     
+00045990: 2020 2020 2323 2323 2053 6574 2074 6865      #### Set the
+000459a0: 2056 6572 626f 7365 2074 6f20 3020 7369   Verbose to 0 si
+000459b0: 6e63 6520 7765 2064 6f6e 2774 2077 616e  nce we don't wan
+000459c0: 7420 746f 6f20 6d75 6368 206f 7574 7075  t too much outpu
+000459d0: 7420 2323 0d0a 2020 2020 2020 2020 2020  t ##..          
 000459e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000459f0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-00045a00: 2e66 6974 2858 5f74 7261 696e 2c20 795f  .fit(X_train, y_
-00045a10: 7472 6169 6e2c 2065 6172 6c79 5f73 746f  train, early_sto
-00045a20: 7070 696e 675f 726f 756e 6473 3d65 6172  pping_rounds=ear
-00045a30: 6c79 5f73 746f 7070 696e 672c 0d0a 2020  ly_stopping,..  
+000459f0: 2020 2020 2020 6d6f 6465 6c2e 6669 7428        model.fit(
+00045a00: 585f 7472 6169 6e2c 2079 5f74 7261 696e  X_train, y_train
+00045a10: 2c20 6561 726c 795f 7374 6f70 7069 6e67  , early_stopping
+00045a20: 5f72 6f75 6e64 733d 6561 726c 795f 7374  _rounds=early_st
+00045a30: 6f70 7069 6e67 2c0d 0a20 2020 2020 2020  opping,..       
 00045a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00045a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045a60: 2020 2020 2020 6576 616c 5f6d 6574 7269        eval_metri
-00045a70: 633d 6576 616c 5f6d 6574 7269 632c 6576  c=eval_metric,ev
-00045a80: 616c 5f73 6574 3d65 7661 6c5f 7365 742c  al_set=eval_set,
-00045a90: 7665 7262 6f73 653d 3029 0d0a 2020 2020  verbose=0)..    
-00045aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045ab0: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
+00045a60: 2065 7661 6c5f 6d65 7472 6963 3d65 7661   eval_metric=eva
+00045a70: 6c5f 6d65 7472 6963 2c65 7661 6c5f 7365  l_metric,eval_se
+00045a80: 743d 6576 616c 5f73 6574 2c76 6572 626f  t=eval_set,verbo
+00045a90: 7365 3d30 290d 0a20 2020 2020 2020 2020  se=0)..         
+00045aa0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00045ab0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
 00045ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045ad0: 2020 2020 2020 2020 2023 2323 2320 4f6e           #### On
-00045ae0: 2043 6f6c 6162 2c20 6576 656e 2074 686f   Colab, even tho
-00045af0: 7567 6820 4750 5520 6578 6973 7473 2c20  ugh GPU exists, 
-00045b00: 6d61 6e79 2070 656f 706c 6520 646f 6e27  many people don'
-00045b10: 7420 7475 726e 2069 7420 6f6e 2e0d 0a20  t turn it on... 
+00045ad0: 2020 2020 2323 2323 204f 6e20 436f 6c61      #### On Cola
+00045ae0: 622c 2065 7665 6e20 7468 6f75 6768 2047  b, even though G
+00045af0: 5055 2065 7869 7374 732c 206d 616e 7920  PU exists, many 
+00045b00: 7065 6f70 6c65 2064 6f6e 2774 2074 7572  people don't tur
+00045b10: 6e20 6974 206f 6e2e 0d0a 2020 2020 2020  n it on...      
 00045b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045b30: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
-00045b40: 2049 6e20 7468 6174 2063 6173 652c 2058   In that case, X
-00045b50: 4742 6f6f 7374 2062 6c6f 7773 2075 7020  GBoost blows up 
-00045b60: 7768 656e 2067 7075 5f70 7265 6469 6374  when gpu_predict
-00045b70: 6f72 2069 7320 7573 6564 2e0d 0a20 2020  or is used...   
+00045b30: 2020 2020 2020 2323 2323 2020 496e 2074        ####  In t
+00045b40: 6861 7420 6361 7365 2c20 5847 426f 6f73  hat case, XGBoos
+00045b50: 7420 626c 6f77 7320 7570 2077 6865 6e20  t blows up when 
+00045b60: 6770 755f 7072 6564 6963 746f 7220 6973  gpu_predictor is
+00045b70: 2075 7365 642e 0d0a 2020 2020 2020 2020   used...        
 00045b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045b90: 2020 2020 2020 2020 2023 2323 2320 2054           ####  T
-00045ba0: 6869 7320 6973 2074 6f20 7475 726e 2069  his is to turn i
-00045bb0: 7420 6261 636b 2074 6f20 6370 755f 7072  t back to cpu_pr
-00045bc0: 6564 6963 746f 7220 696e 2063 6173 6520  edictor in case 
-00045bd0: 4750 5520 6572 726f 7273 210d 0a20 2020  GPU errors!..   
+00045b90: 2020 2020 2323 2323 2020 5468 6973 2069      ####  This i
+00045ba0: 7320 746f 2074 7572 6e20 6974 2062 6163  s to turn it bac
+00045bb0: 6b20 746f 2063 7075 5f70 7265 6469 6374  k to cpu_predict
+00045bc0: 6f72 2069 6e20 6361 7365 2047 5055 2065  or in case GPU e
+00045bd0: 7272 6f72 7321 0d0a 2020 2020 2020 2020  rrors!..        
 00045be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045bf0: 2020 2020 2020 2020 2069 6620 4750 555f           if GPU_
-00045c00: 6578 6973 7473 3a0d 0a20 2020 2020 2020  exists:..       
+00045bf0: 2020 2020 6966 2047 5055 5f65 7869 7374      if GPU_exist
+00045c00: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
 00045c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045c20: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00045c30: 4572 726f 723a 2047 5055 2065 7869 7374  Error: GPU exist
-00045c40: 7320 6275 7420 6974 2069 7320 6e6f 7420  s but it is not 
-00045c50: 7475 726e 6564 206f 6e2e 2055 7369 6e67  turned on. Using
-00045c60: 2043 5055 2066 6f72 2070 7265 6469 6374   CPU for predict
-00045c70: 696f 6e73 2e2e 2e27 290d 0a20 2020 2020  ions...')..     
+00045c20: 2020 2020 7072 696e 7428 2745 7272 6f72      print('Error
+00045c30: 3a20 4750 5520 6578 6973 7473 2062 7574  : GPU exists but
+00045c40: 2069 7420 6973 206e 6f74 2074 7572 6e65   it is not turne
+00045c50: 6420 6f6e 2e20 5573 696e 6720 4350 5520  d on. Using CPU 
+00045c60: 666f 7220 7072 6564 6963 7469 6f6e 732e  for predictions.
+00045c70: 2e2e 2729 0d0a 2020 2020 2020 2020 2020  ..')..          
 00045c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045c90: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-00045ca0: 2e65 7374 696d 6174 6f72 2e73 6574 5f70  .estimator.set_p
-00045cb0: 6172 616d 7328 2a2a 6370 755f 7061 7261  arams(**cpu_para
-00045cc0: 6d73 290d 0a20 2020 2020 2020 2020 2020  ms)..           
+00045c90: 2020 2020 2020 6d6f 6465 6c2e 6573 7469        model.esti
+00045ca0: 6d61 746f 722e 7365 745f 7061 7261 6d73  mator.set_params
+00045cb0: 282a 2a63 7075 5f70 6172 616d 7329 0d0a  (**cpu_params)..
+00045cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00045cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045ce0: 2020 2020 2069 6620 206d 6f64 656c 7479       if  modelty
-00045cf0: 7065 203d 3d20 274d 756c 7469 5f43 6c61  pe == 'Multi_Cla
-00045d00: 7373 6966 6963 6174 696f 6e27 3a0d 0a20  ssification':.. 
+00045ce0: 6966 2020 6d6f 6465 6c74 7970 6520 3d3d  if  modeltype ==
+00045cf0: 2027 4d75 6c74 695f 436c 6173 7369 6669   'Multi_Classifi
+00045d00: 6361 7469 6f6e 273a 0d0a 2020 2020 2020  cation':..      
 00045d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045d30: 2020 206d 6f64 656c 2e66 6974 2858 5f74     model.fit(X_t
-00045d40: 7261 696e 2c79 5f74 7261 696e 290d 0a20  rain,y_train).. 
+00045d20: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+00045d30: 6465 6c2e 6669 7428 585f 7472 6169 6e2c  del.fit(X_train,
+00045d40: 795f 7472 6169 6e29 0d0a 2020 2020 2020  y_train)..      
 00045d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045d60: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00045d70: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00045d60: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00045d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00045d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045d90: 2020 2020 2020 2020 2020 6d6f 6465 6c2e            model.
-00045da0: 6669 7428 585f 7472 6169 6e2c 795f 7472  fit(X_train,y_tr
-00045db0: 6169 6e2c 2065 6172 6c79 5f73 746f 7070  ain, early_stopp
-00045dc0: 696e 675f 726f 756e 6473 3d65 6172 6c79  ing_rounds=early
-00045dd0: 5f73 746f 7070 696e 672c 0d0a 2020 2020  _stopping,..    
+00045d90: 2020 2020 206d 6f64 656c 2e66 6974 2858       model.fit(X
+00045da0: 5f74 7261 696e 2c79 5f74 7261 696e 2c20  _train,y_train, 
+00045db0: 6561 726c 795f 7374 6f70 7069 6e67 5f72  early_stopping_r
+00045dc0: 6f75 6e64 733d 6561 726c 795f 7374 6f70  ounds=early_stop
+00045dd0: 7069 6e67 2c0d 0a20 2020 2020 2020 2020  ping,..         
 00045de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045e00: 2020 2020 6576 616c 5f6d 6574 7269 633d      eval_metric=
-00045e10: 6576 616c 5f6d 6574 7269 632c 6576 616c  eval_metric,eval
-00045e20: 5f73 6574 3d65 7661 6c5f 7365 742c 7665  _set=eval_set,ve
-00045e30: 7262 6f73 653d 4661 6c73 6529 0d0a 2020  rbose=False)..  
+00045df0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00045e00: 7661 6c5f 6d65 7472 6963 3d65 7661 6c5f  val_metric=eval_
+00045e10: 6d65 7472 6963 2c65 7661 6c5f 7365 743d  metric,eval_set=
+00045e20: 6576 616c 5f73 6574 2c76 6572 626f 7365  eval_set,verbose
+00045e30: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
 00045e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045e50: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00045e60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00045e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045e80: 206d 6f64 656c 2e66 6974 2858 5f74 7261   model.fit(X_tra
-00045e90: 696e 2c79 5f74 7261 696e 290d 0a20 2020  in,y_train)..   
-00045ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045eb0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00045ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045ed0: 2323 2323 2320 5468 6973 2069 7320 666f  ##### This is fo
-00045ee0: 7220 4361 7462 6f6f 7374 2023 2323 2323  r Catboost #####
-00045ef0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-00045f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045f10: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
+00045e50: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00045e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045e70: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+00045e80: 6c2e 6669 7428 585f 7472 6169 6e2c 795f  l.fit(X_train,y_
+00045e90: 7472 6169 6e29 0d0a 2020 2020 2020 2020  train)..        
+00045ea0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00045eb0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00045ec0: 2020 2020 2020 2020 2020 2023 2323 2323             #####
+00045ed0: 2054 6869 7320 6973 2066 6f72 2043 6174   This is for Cat
+00045ee0: 626f 6f73 7420 2323 2323 2323 2323 2323  boost ##########
+00045ef0: 2323 2323 230d 0a20 2020 2020 2020 2020  #####..         
+00045f00: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00045f10: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
 00045f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045f30: 2020 2020 2020 6d6f 6465 6c2e 6669 7428        model.fit(
-00045f40: 585f 7472 6169 6e2c 2079 5f74 7261 696e  X_train, y_train
-00045f50: 2c20 6361 745f 6665 6174 7572 6573 3d69  , cat_features=i
-00045f60: 6d70 5f63 6174 732c 0d0a 2020 2020 2020  mp_cats,..      
+00045f30: 206d 6f64 656c 2e66 6974 2858 5f74 7261   model.fit(X_tra
+00045f40: 696e 2c20 795f 7472 6169 6e2c 2063 6174  in, y_train, cat
+00045f50: 5f66 6561 7475 7265 733d 696d 705f 6361  _features=imp_ca
+00045f60: 7473 2c0d 0a20 2020 2020 2020 2020 2020  ts,..           
 00045f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045f90: 2020 6576 616c 5f73 6574 3d28 585f 6376    eval_set=(X_cv
-00045fa0: 2c79 5f63 7629 2c20 7573 655f 6265 7374  ,y_cv), use_best
-00045fb0: 5f6d 6f64 656c 3d54 7275 652c 2070 6c6f  _model=True, plo
-00045fc0: 743d 5472 7565 290d 0a20 2020 2020 2020  t=True)..       
-00045fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045fe0: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
+00045f80: 2020 2020 2020 2020 2020 2020 2065 7661               eva
+00045f90: 6c5f 7365 743d 2858 5f63 762c 795f 6376  l_set=(X_cv,y_cv
+00045fa0: 292c 2075 7365 5f62 6573 745f 6d6f 6465  ), use_best_mode
+00045fb0: 6c3d 5472 7565 2c20 706c 6f74 3d54 7275  l=True, plot=Tru
+00045fc0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00045fd0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+00045fe0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
 00045ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046000: 2020 2020 2020 6d6f 6465 6c2e 6669 7428        model.fit(
-00046010: 585f 7472 6169 6e2c 2079 5f74 7261 696e  X_train, y_train
-00046020: 2c20 6361 745f 6665 6174 7572 6573 3d69  , cat_features=i
-00046030: 6d70 5f63 6174 732c 2075 7365 5f62 6573  mp_cats, use_bes
-00046040: 745f 6d6f 6465 6c3d 4661 6c73 652c 2070  t_model=False, p
-00046050: 6c6f 743d 4661 6c73 6529 0d0a 2020 2020  lot=False)..    
-00046060: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00046070: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00046080: 2020 2020 2020 206d 6f64 656c 2e66 6974         model.fit
-00046090: 2858 5f74 7261 696e 2c20 795f 7472 6169  (X_train, y_trai
-000460a0: 6e29 0d0a 2020 2020 2020 2020 2020 2020  n)..            
-000460b0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-000460c0: 2020 2020 2020 206d 6f64 656c 2e66 6974         model.fit
-000460d0: 2858 5f74 7261 696e 2c20 795f 7472 6169  (X_train, y_trai
-000460e0: 6e29 0d0a 2020 2020 2020 2020 6578 6365  n)..        exce
-000460f0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
-00046100: 2070 7269 6e74 2827 5472 6169 6e69 6e67   print('Training
-00046110: 2072 6567 756c 6172 206d 6f64 656c 2066   regular model f
-00046120: 6972 7374 2074 696d 6520 6973 2045 7272  irst time is Err
-00046130: 6f72 696e 673a 2043 6865 636b 2069 6620  oring: Check if 
-00046140: 796f 7572 2049 6e70 7574 2069 7320 636f  your Input is co
-00046150: 7272 6563 742e 2e2e 2729 0d0a 2020 2020  rrect...')..    
-00046160: 2020 2020 2020 2020 7265 7475 726e 0d0a          return..
-00046170: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00046180: 2020 2023 2323 2320 5468 6973 2069 7320     #### This is 
-00046190: 666f 7220 496d 6261 6c61 6e63 6564 2054  for Imbalanced T
-000461a0: 7261 696e 696e 6720 666f 7220 4d75 6c74  raining for Mult
-000461b0: 692d 4c61 6265 6c20 7072 6f62 6c65 6d73  i-Label problems
-000461c0: 2023 2323 2323 2323 230d 0a20 2020 2020   ########..     
-000461d0: 2020 2069 6620 6d6f 6465 6c5f 6c61 6265     if model_labe
-000461e0: 6c20 3d3d 2027 4d75 6c74 695f 4c61 6265  l == 'Multi_Labe
-000461f0: 6c27 3a0d 0a20 2020 2020 2020 2020 2020  l':..           
-00046200: 2069 6620 6d6f 6465 6c74 7970 6520 3d3d   if modeltype ==
-00046210: 2027 5265 6772 6573 7369 6f6e 273a 0d0a   'Regression':..
-00046220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046230: 2323 2320 5369 6e63 6520 7261 7265 2063  ### Since rare c
-00046240: 6c61 7373 2069 7320 6e65 6564 6564 2069  lass is needed i
-00046250: 6e20 7468 6520 6e65 7874 2073 7465 702c  n the next step,
-00046260: 206a 7573 7420 7365 7474 696e 6720 7468   just setting th
-00046270: 6520 7261 7265 5f63 6c61 7373 2061 7320  e rare_class as 
-00046280: 6172 7469 6669 6369 616c 6c79 2030 2e0d  artificially 0..
-00046290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000462a0: 2072 6172 655f 636c 6173 7320 3d20 300d   rare_class = 0.
-000462b0: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-000462c0: 656c 203d 2074 7261 696e 696e 675f 7769  el = training_wi
-000462d0: 7468 5f53 4d4f 5445 2858 5f74 7261 696e  th_SMOTE(X_train
-000462e0: 2c79 5f74 7261 696e 2c65 6163 685f 7461  ,y_train,each_ta
-000462f0: 7267 6574 2c65 7661 6c5f 7365 742c 2078  rget,eval_set, x
-00046300: 6762 6d2c 0d0a 2020 2020 2020 2020 2020  gbm,..          
+00046000: 206d 6f64 656c 2e66 6974 2858 5f74 7261   model.fit(X_tra
+00046010: 696e 2c20 795f 7472 6169 6e2c 2063 6174  in, y_train, cat
+00046020: 5f66 6561 7475 7265 733d 696d 705f 6361  _features=imp_ca
+00046030: 7473 2c20 7573 655f 6265 7374 5f6d 6f64  ts, use_best_mod
+00046040: 656c 3d46 616c 7365 2c20 706c 6f74 3d46  el=False, plot=F
+00046050: 616c 7365 290d 0a20 2020 2020 2020 2020  alse)..         
+00046060: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00046070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046080: 2020 6d6f 6465 6c2e 6669 7428 585f 7472    model.fit(X_tr
+00046090: 6169 6e2c 2079 5f74 7261 696e 290d 0a20  ain, y_train).. 
+000460a0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+000460b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000460c0: 2020 6d6f 6465 6c2e 6669 7428 585f 7472    model.fit(X_tr
+000460d0: 6169 6e2c 2079 5f74 7261 696e 290d 0a20  ain, y_train).. 
+000460e0: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
+000460f0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00046100: 7428 2754 7261 696e 696e 6720 7265 6775  t('Training regu
+00046110: 6c61 7220 6d6f 6465 6c20 6669 7273 7420  lar model first 
+00046120: 7469 6d65 2069 7320 4572 726f 7269 6e67  time is Erroring
+00046130: 3a20 4368 6563 6b20 6966 2079 6f75 7220  : Check if your 
+00046140: 496e 7075 7420 6973 2063 6f72 7265 6374  Input is correct
+00046150: 2e2e 2e27 290d 0a20 2020 2020 2020 2020  ...')..         
+00046160: 2020 2072 6574 7572 6e0d 0a20 2020 2065     return..    e
+00046170: 6c73 653a 0d0a 2020 2020 2020 2020 2323  lse:..        ##
+00046180: 2323 2054 6869 7320 6973 2066 6f72 2049  ## This is for I
+00046190: 6d62 616c 616e 6365 6420 5472 6169 6e69  mbalanced Traini
+000461a0: 6e67 2066 6f72 204d 756c 7469 2d4c 6162  ng for Multi-Lab
+000461b0: 656c 2070 726f 626c 656d 7320 2323 2323  el problems ####
+000461c0: 2323 2323 0d0a 2020 2020 2020 2020 6966  ####..        if
+000461d0: 206d 6f64 656c 5f6c 6162 656c 203d 3d20   model_label == 
+000461e0: 274d 756c 7469 5f4c 6162 656c 273a 0d0a  'Multi_Label':..
+000461f0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+00046200: 6f64 656c 7479 7065 203d 3d20 2752 6567  odeltype == 'Reg
+00046210: 7265 7373 696f 6e27 3a0d 0a20 2020 2020  ression':..     
+00046220: 2020 2020 2020 2020 2020 2023 2323 2053             ### S
+00046230: 696e 6365 2072 6172 6520 636c 6173 7320  ince rare class 
+00046240: 6973 206e 6565 6465 6420 696e 2074 6865  is needed in the
+00046250: 206e 6578 7420 7374 6570 2c20 6a75 7374   next step, just
+00046260: 2073 6574 7469 6e67 2074 6865 2072 6172   setting the rar
+00046270: 655f 636c 6173 7320 6173 2061 7274 6966  e_class as artif
+00046280: 6963 6961 6c6c 7920 302e 0d0a 2020 2020  icially 0...    
+00046290: 2020 2020 2020 2020 2020 2020 7261 7265              rare
+000462a0: 5f63 6c61 7373 203d 2030 0d0a 2020 2020  _class = 0..    
+000462b0: 2020 2020 2020 2020 6d6f 6465 6c20 3d20          model = 
+000462c0: 7472 6169 6e69 6e67 5f77 6974 685f 534d  training_with_SM
+000462d0: 4f54 4528 585f 7472 6169 6e2c 795f 7472  OTE(X_train,y_tr
+000462e0: 6169 6e2c 6561 6368 5f74 6172 6765 742c  ain,each_target,
+000462f0: 6576 616c 5f73 6574 2c20 7867 626d 2c0d  eval_set, xgbm,.
+00046300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00046310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046330: 2042 6f6f 7374 696e 675f 466c 6167 2c20   Boosting_Flag, 
-00046340: 6576 616c 5f6d 6574 7269 632c 0d0a 2020  eval_metric,..  
+00046320: 2020 2020 2020 2020 2020 2020 426f 6f73              Boos
+00046330: 7469 6e67 5f46 6c61 672c 2065 7661 6c5f  ting_Flag, eval_
+00046340: 6d65 7472 6963 2c0d 0a20 2020 2020 2020  metric,..       
 00046350: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00046360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046370: 2020 2020 2020 2020 206d 6f64 656c 7479           modelty
-00046380: 7065 2c20 6d6f 6465 6c5f 6e61 6d65 2c20  pe, model_name, 
-00046390: 7472 6169 6e69 6e67 3d54 7275 652c 0d0a  training=True,..
+00046370: 2020 2020 6d6f 6465 6c74 7970 652c 206d      modeltype, m
+00046380: 6f64 656c 5f6e 616d 652c 2074 7261 696e  odel_name, train
+00046390: 696e 673d 5472 7565 2c0d 0a20 2020 2020  ing=True,..     
 000463a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000463b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000463c0: 2020 2020 2020 2020 2020 206d 696e 6f72             minor
-000463d0: 6974 795f 636c 6173 733d 7261 7265 5f63  ity_class=rare_c
-000463e0: 6c61 7373 2c69 6d70 5f63 6174 733d 696d  lass,imp_cats=im
-000463f0: 705f 6361 7473 2c0d 0a20 2020 2020 2020  p_cats,..       
+000463c0: 2020 2020 2020 6d69 6e6f 7269 7479 5f63        minority_c
+000463d0: 6c61 7373 3d72 6172 655f 636c 6173 732c  lass=rare_class,
+000463e0: 696d 705f 6361 7473 3d69 6d70 5f63 6174  imp_cats=imp_cat
+000463f0: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
 00046400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046420: 2020 2020 6361 6c69 6272 6174 6f72 5f66      calibrator_f
-00046430: 6c61 673d 6361 6c69 6272 6174 6f72 5f66  lag=calibrator_f
-00046440: 6c61 672c 0d0a 2020 2020 2020 2020 2020  lag,..          
+00046410: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00046420: 616c 6962 7261 746f 725f 666c 6167 3d63  alibrator_flag=c
+00046430: 616c 6962 7261 746f 725f 666c 6167 2c0d  alibrator_flag,.
+00046440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00046450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046470: 2047 5055 5f65 7869 7374 733d 4750 555f   GPU_exists=GPU_
-00046480: 6578 6973 7473 2c20 7061 7261 6d73 203d  exists, params =
-00046490: 2063 7075 5f70 6172 616d 732c 0d0a 2020   cpu_params,..  
+00046460: 2020 2020 2020 2020 2020 2020 4750 555f              GPU_
+00046470: 6578 6973 7473 3d47 5055 5f65 7869 7374  exists=GPU_exist
+00046480: 732c 2070 6172 616d 7320 3d20 6370 755f  s, params = cpu_
+00046490: 7061 7261 6d73 2c0d 0a20 2020 2020 2020  params,..       
 000464a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000464b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000464c0: 2020 2020 2020 2020 206d 6f64 656c 5f6c           model_l
-000464d0: 6162 656c 3d6d 6f64 656c 5f6c 6162 656c  abel=model_label
-000464e0: 2c20 7665 7262 6f73 653d 7665 7262 6f73  , verbose=verbos
-000464f0: 6529 0d0a 2020 2020 2323 2323 2323 2323  e)..    ########
-00046500: 2323 2320 2020 4649 5253 5420 5449 4d45  ###   FIRST TIME
-00046510: 204d 4f44 454c 2054 5241 494e 494e 4720   MODEL TRAINING 
-00046520: 434f 4d50 4c45 5445 4420 2323 2323 2323  COMPLETED ######
-00046530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00046540: 2323 2323 0d0a 2020 2020 2323 2020 2054  ####..    ##   T
-00046550: 5241 494e 494e 4720 4f46 204d 4f44 454c  RAINING OF MODEL
-00046560: 5320 434f 4d50 4c45 5445 442e 204e 4f57  S COMPLETED. NOW
-00046570: 2047 4554 204d 4554 5249 4353 206f 6e20   GET METRICS on 
-00046580: 4356 2044 4154 4120 2323 2323 2323 2323  CV DATA ########
-00046590: 2323 2323 2323 230d 0a20 2020 2070 7269  #######..    pri
-000465a0: 6e74 2827 2020 2020 4163 7475 616c 2074  nt('    Actual t
-000465b0: 7261 696e 696e 6720 7469 6d65 2028 696e  raining time (in
-000465c0: 2073 6563 6f6e 6473 293a 2025 302e 3066   seconds): %0.0f
-000465d0: 2720 2528 7469 6d65 2e74 696d 6528 292d  ' %(time.time()-
-000465e0: 6d6f 6465 6c5f 7374 6172 745f 7469 6d65  model_start_time
-000465f0: 2929 0d0a 2020 2020 7072 696e 7428 2723  ))..    print('#
-00046600: 2323 2323 2323 2323 2323 2020 2573 2020  ##########  %s  
-00046610: 4d20 4f20 4420 4520 4c20 2020 5220 4520  M O D E L   R E 
-00046620: 5320 5520 4c20 5420 5320 2323 2323 2323  S U L T S ######
-00046630: 2323 2323 2323 2323 2323 2327 2025 6d6f  ###########' %mo
-00046640: 6465 6c5f 6c61 6265 6c29 0d0a 2020 2020  del_label)..    
-00046650: 7472 793a 0d0a 2020 2020 2020 2020 6966  try:..        if
-00046660: 206d 6f64 656c 5f6c 6162 656c 203d 3d20   model_label == 
-00046670: 2753 696e 676c 655f 4c61 6265 6c27 3a0d  'Single_Label':.
-00046680: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00046690: 6879 7065 725f 7061 7261 6d20 3d3d 2027  hyper_param == '
-000466a0: 5253 2720 6f72 2068 7970 6572 5f70 6172  RS' or hyper_par
-000466b0: 616d 203d 3d20 2747 5327 3a0d 0a20 2020  am == 'GS':..   
-000466c0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000466d0: 6d6f 6465 6c74 7970 6520 3d3d 2027 5265  modeltype == 'Re
-000466e0: 6772 6573 7369 6f6e 2720 616e 6420 496d  gression' and Im
-000466f0: 6261 6c61 6e63 6564 5f46 6c61 673a 0d0a  balanced_Flag:..
-00046700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046710: 2020 2020 2323 2320 4966 2079 6f75 2075      ### If you u
-00046720: 7365 2053 4d4f 5445 2c20 7468 656e 206e  se SMOTE, then n
-00046730: 6f20 4772 6964 5365 6172 6368 4356 2069  o GridSearchCV i
-00046740: 7320 646f 6e65 2e20 4865 6e63 6520 6e6f  s done. Hence no
-00046750: 2062 6573 745f 7363 6f72 655f 0d0a 2020   best_score_..  
-00046760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046770: 2020 6265 7374 5f73 636f 7265 203d 2030    best_score = 0
-00046780: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00046790: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-000467a0: 2020 2020 2020 2020 2020 2020 2062 6573               bes
-000467b0: 745f 7363 6f72 6520 3d20 6d6f 6465 6c2e  t_score = model.
-000467c0: 6265 7374 5f73 636f 7265 5f0d 0a20 2020  best_score_..   
-000467d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000467e0: 2076 616c 6964 6174 696f 6e5f 6d65 7472   validation_metr
-000467f0: 6963 203d 2063 6f70 792e 6465 6570 636f  ic = copy.deepco
-00046800: 7079 2873 636f 7269 6e67 5f70 6172 616d  py(scoring_param
-00046810: 6574 6572 290d 0a20 2020 2020 2020 2020  eter)..         
-00046820: 2020 2065 6c69 6620 6879 7065 725f 7061     elif hyper_pa
-00046830: 7261 6d20 6973 204e 6f6e 653a 0d0a 2020  ram is None:..  
-00046840: 2020 2020 2020 2020 2020 2020 2020 7661                va
-00046850: 6c5f 6b65 7973 203d 206c 6973 7428 6d6f  l_keys = list(mo
-00046860: 6465 6c2e 6265 7374 5f73 636f 7265 5f2e  del.best_score_.
-00046870: 6b65 7973 2829 290d 0a20 2020 2020 2020  keys())..       
-00046880: 2020 2020 2020 2020 2069 6620 2776 616c           if 'val
-00046890: 6964 6174 696f 6e27 2069 6e20 7661 6c5f  idation' in val_
-000468a0: 6b65 7973 3a0d 0a20 2020 2020 2020 2020  keys:..         
-000468b0: 2020 2020 2020 2020 2020 2076 616c 6964             valid
-000468c0: 6174 696f 6e5f 6d65 7472 6963 203d 206c  ation_metric = l
-000468d0: 6973 7428 6d6f 6465 6c2e 6265 7374 5f73  ist(model.best_s
-000468e0: 636f 7265 5f5b 2776 616c 6964 6174 696f  core_['validatio
-000468f0: 6e27 5d2e 6b65 7973 2829 295b 305d 0d0a  n'].keys())[0]..
-00046900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046910: 2020 2020 6265 7374 5f73 636f 7265 203d      best_score =
-00046920: 206d 6f64 656c 2e62 6573 745f 7363 6f72   model.best_scor
-00046930: 655f 5b27 7661 6c69 6461 7469 6f6e 275d  e_['validation']
-00046940: 5b76 616c 6964 6174 696f 6e5f 6d65 7472  [validation_metr
-00046950: 6963 5d0d 0a20 2020 2020 2020 2020 2020  ic]..           
-00046960: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-00046970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046980: 7661 6c69 6461 7469 6f6e 5f6d 6574 7269  validation_metri
-00046990: 6320 3d20 6c69 7374 286d 6f64 656c 2e62  c = list(model.b
-000469a0: 6573 745f 7363 6f72 655f 5b27 6c65 6172  est_score_['lear
-000469b0: 6e27 5d2e 6b65 7973 2829 295b 305d 0d0a  n'].keys())[0]..
-000469c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000469d0: 2020 2020 6265 7374 5f73 636f 7265 203d      best_score =
-000469e0: 206d 6f64 656c 2e62 6573 745f 7363 6f72   model.best_scor
-000469f0: 655f 5b27 6c65 6172 6e27 5d5b 7661 6c69  e_['learn'][vali
-00046a00: 6461 7469 6f6e 5f6d 6574 7269 635d 0d0a  dation_metric]..
-00046a10: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00046a20: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00046a30: 2020 2023 2320 5468 6973 2061 7070 6c69     ## This appli
-00046a40: 6573 206f 6e6c 7920 746f 2053 5045 2063  es only to SPE c
-00046a50: 6c61 7373 6966 6965 7220 2323 2323 2323  lassifier ######
-00046a60: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-00046a70: 2020 2020 7661 6c69 6461 7469 6f6e 5f6d      validation_m
-00046a80: 6574 7269 6320 3d20 2742 616c 616e 6365  etric = 'Balance
-00046a90: 6420 4163 6375 7261 6379 270d 0a20 2020  d Accuracy'..   
-00046aa0: 2020 2020 2020 2020 2020 2020 2062 6573               bes
-00046ab0: 745f 7363 6f72 6520 3d20 6261 6c61 6e63  t_score = balanc
-00046ac0: 6564 5f61 6363 7572 6163 795f 7363 6f72  ed_accuracy_scor
-00046ad0: 6528 795f 6376 2c20 6d6f 6465 6c2e 7072  e(y_cv, model.pr
-00046ae0: 6564 6963 7428 585f 6376 2929 0d0a 2020  edict(X_cv))..  
-00046af0: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
-00046b00: 2020 2070 7269 6e74 2827 4572 726f 723a     print('Error:
-00046b10: 204e 6f74 2061 626c 6520 746f 2070 7269   Not able to pri
-00046b20: 6e74 2076 616c 6964 6174 696f 6e20 6d65  nt validation me
-00046b30: 7472 6963 732e 2043 6f6e 7469 6e75 696e  trics. Continuin
-00046b40: 672e 2e2e 2729 0d0a 2020 2020 2020 2020  g...')..        
-00046b50: 6265 7374 5f73 636f 7265 203d 2030 0d0a  best_score = 0..
-00046b60: 2020 2020 6966 206d 6f64 656c 5f6c 6162      if model_lab
-00046b70: 656c 203d 3d20 2753 696e 676c 655f 4c61  el == 'Single_La
-00046b80: 6265 6c27 3a0d 0a20 2020 2020 2020 2069  bel':..        i
-00046b90: 6620 6d6f 6465 6c74 7970 6520 213d 2027  f modeltype != '
-00046ba0: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
-00046bb0: 2020 2020 2020 2020 2020 2323 2323 2323            ######
-00046bc0: 2323 2323 2323 2323 2054 6869 7320 6973  ######## This is
-00046bd0: 2066 6f72 2043 6c61 7373 6966 6963 6174   for Classificat
-00046be0: 696f 6e20 4f6e 6c79 2021 2120 2323 2323  ion Only !! ####
-00046bf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00046c00: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
-00046c10: 2020 6966 2073 636f 7269 6e67 5f70 6172    if scoring_par
-00046c20: 616d 6574 6572 2069 6e20 5b27 6c6f 676c  ameter in ['logl
-00046c30: 6f73 7327 2c27 6e65 675f 6c6f 675f 6c6f  oss','neg_log_lo
-00046c40: 7373 272c 276c 6f67 5f6c 6f73 7327 2c27  ss','log_loss','
-00046c50: 6c6f 672d 6c6f 7373 272c 2727 5d3a 0d0a  log-loss','']:..
-00046c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046c70: 7072 696e 7428 277b 7d2d 666f 6c64 2043  print('{}-fold C
-00046c80: 726f 7373 2056 616c 6964 6174 696f 6e20  ross Validation 
-00046c90: 7b7d 203d 207b 7d27 2e66 6f72 6d61 7428  {} = {}'.format(
-00046ca0: 6e5f 7370 6c69 7473 2c20 276c 6f67 6c6f  n_splits, 'loglo
-00046cb0: 7373 272c 2062 6573 745f 7363 6f72 6529  ss', best_score)
-00046cc0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00046cd0: 6c69 6620 7363 6f72 696e 675f 7061 7261  lif scoring_para
-00046ce0: 6d65 7465 7220 696e 205b 2761 6363 7572  meter in ['accur
-00046cf0: 6163 7927 2c27 6261 6c61 6e63 6564 2d61  acy','balanced-a
-00046d00: 6363 7572 6163 7927 2c27 6261 6c61 6e63  ccuracy','balanc
-00046d10: 6564 5f61 6363 7572 6163 7927 2c27 726f  ed_accuracy','ro
-00046d20: 635f 6175 6327 2c27 726f 632d 6175 6327  c_auc','roc-auc'
-00046d30: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000464c0: 2020 2020 6d6f 6465 6c5f 6c61 6265 6c3d      model_label=
+000464d0: 6d6f 6465 6c5f 6c61 6265 6c2c 2076 6572  model_label, ver
+000464e0: 626f 7365 3d76 6572 626f 7365 290d 0a20  bose=verbose).. 
+000464f0: 2020 2023 2323 2323 2323 2323 2323 2020     ###########  
+00046500: 2046 4952 5354 2054 494d 4520 4d4f 4445   FIRST TIME MODE
+00046510: 4c20 5452 4149 4e49 4e47 2043 4f4d 504c  L TRAINING COMPL
+00046520: 4554 4544 2023 2323 2323 2323 2323 2323  ETED ###########
+00046530: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+00046540: 0a20 2020 2023 2320 2020 5452 4149 4e49  .    ##   TRAINI
+00046550: 4e47 204f 4620 4d4f 4445 4c53 2043 4f4d  NG OF MODELS COM
+00046560: 504c 4554 4544 2e20 4e4f 5720 4745 5420  PLETED. NOW GET 
+00046570: 4d45 5452 4943 5320 6f6e 2043 5620 4441  METRICS on CV DA
+00046580: 5441 2023 2323 2323 2323 2323 2323 2323  TA #############
+00046590: 2323 0d0a 2020 2020 7072 696e 7428 2720  ##..    print(' 
+000465a0: 2020 2041 6374 7561 6c20 7472 6169 6e69     Actual traini
+000465b0: 6e67 2074 696d 6520 2869 6e20 7365 636f  ng time (in seco
+000465c0: 6e64 7329 3a20 2530 2e30 6627 2025 2874  nds): %0.0f' %(t
+000465d0: 696d 652e 7469 6d65 2829 2d6d 6f64 656c  ime.time()-model
+000465e0: 5f73 7461 7274 5f74 696d 6529 290d 0a20  _start_time)).. 
+000465f0: 2020 2070 7269 6e74 2827 2323 2323 2323     print('######
+00046600: 2323 2323 2320 2025 7320 204d 204f 2044  #####  %s  M O D
+00046610: 2045 204c 2020 2052 2045 2053 2055 204c   E L   R E S U L
+00046620: 2054 2053 2023 2323 2323 2323 2323 2323   T S ###########
+00046630: 2323 2323 2323 2720 256d 6f64 656c 5f6c  ######' %model_l
+00046640: 6162 656c 290d 0a20 2020 2074 7279 3a0d  abel)..    try:.
+00046650: 0a20 2020 2020 2020 2069 6620 6d6f 6465  .        if mode
+00046660: 6c5f 6c61 6265 6c20 3d3d 2027 5369 6e67  l_label == 'Sing
+00046670: 6c65 5f4c 6162 656c 273a 0d0a 2020 2020  le_Label':..    
+00046680: 2020 2020 2020 2020 6966 2068 7970 6572          if hyper
+00046690: 5f70 6172 616d 203d 3d20 2752 5327 206f  _param == 'RS' o
+000466a0: 7220 6879 7065 725f 7061 7261 6d20 3d3d  r hyper_param ==
+000466b0: 2027 4753 273a 0d0a 2020 2020 2020 2020   'GS':..        
+000466c0: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
+000466d0: 7479 7065 203d 3d20 2752 6567 7265 7373  type == 'Regress
+000466e0: 696f 6e27 2061 6e64 2049 6d62 616c 616e  ion' and Imbalan
+000466f0: 6365 645f 466c 6167 3a0d 0a20 2020 2020  ced_Flag:..     
+00046700: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00046710: 2323 2049 6620 796f 7520 7573 6520 534d  ## If you use SM
+00046720: 4f54 452c 2074 6865 6e20 6e6f 2047 7269  OTE, then no Gri
+00046730: 6453 6561 7263 6843 5620 6973 2064 6f6e  dSearchCV is don
+00046740: 652e 2048 656e 6365 206e 6f20 6265 7374  e. Hence no best
+00046750: 5f73 636f 7265 5f0d 0a20 2020 2020 2020  _score_..       
+00046760: 2020 2020 2020 2020 2020 2020 2062 6573               bes
+00046770: 745f 7363 6f72 6520 3d20 300d 0a20 2020  t_score = 0..   
+00046780: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00046790: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+000467a0: 2020 2020 2020 2020 6265 7374 5f73 636f          best_sco
+000467b0: 7265 203d 206d 6f64 656c 2e62 6573 745f  re = model.best_
+000467c0: 7363 6f72 655f 0d0a 2020 2020 2020 2020  score_..        
+000467d0: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
+000467e0: 6461 7469 6f6e 5f6d 6574 7269 6320 3d20  dation_metric = 
+000467f0: 636f 7079 2e64 6565 7063 6f70 7928 7363  copy.deepcopy(sc
+00046800: 6f72 696e 675f 7061 7261 6d65 7465 7229  oring_parameter)
+00046810: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00046820: 6966 2068 7970 6572 5f70 6172 616d 2069  if hyper_param i
+00046830: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
+00046840: 2020 2020 2020 2020 2076 616c 5f6b 6579           val_key
+00046850: 7320 3d20 6c69 7374 286d 6f64 656c 2e62  s = list(model.b
+00046860: 6573 745f 7363 6f72 655f 2e6b 6579 7328  est_score_.keys(
+00046870: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00046880: 2020 2020 6966 2027 7661 6c69 6461 7469      if 'validati
+00046890: 6f6e 2720 696e 2076 616c 5f6b 6579 733a  on' in val_keys:
+000468a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000468b0: 2020 2020 2020 7661 6c69 6461 7469 6f6e        validation
+000468c0: 5f6d 6574 7269 6320 3d20 6c69 7374 286d  _metric = list(m
+000468d0: 6f64 656c 2e62 6573 745f 7363 6f72 655f  odel.best_score_
+000468e0: 5b27 7661 6c69 6461 7469 6f6e 275d 2e6b  ['validation'].k
+000468f0: 6579 7328 2929 5b30 5d0d 0a20 2020 2020  eys())[0]..     
+00046900: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00046910: 6573 745f 7363 6f72 6520 3d20 6d6f 6465  est_score = mode
+00046920: 6c2e 6265 7374 5f73 636f 7265 5f5b 2776  l.best_score_['v
+00046930: 616c 6964 6174 696f 6e27 5d5b 7661 6c69  alidation'][vali
+00046940: 6461 7469 6f6e 5f6d 6574 7269 635d 0d0a  dation_metric]..
+00046950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046960: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00046970: 2020 2020 2020 2020 2020 2076 616c 6964             valid
+00046980: 6174 696f 6e5f 6d65 7472 6963 203d 206c  ation_metric = l
+00046990: 6973 7428 6d6f 6465 6c2e 6265 7374 5f73  ist(model.best_s
+000469a0: 636f 7265 5f5b 276c 6561 726e 275d 2e6b  core_['learn'].k
+000469b0: 6579 7328 2929 5b30 5d0d 0a20 2020 2020  eys())[0]..     
+000469c0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+000469d0: 6573 745f 7363 6f72 6520 3d20 6d6f 6465  est_score = mode
+000469e0: 6c2e 6265 7374 5f73 636f 7265 5f5b 276c  l.best_score_['l
+000469f0: 6561 726e 275d 5b76 616c 6964 6174 696f  earn'][validatio
+00046a00: 6e5f 6d65 7472 6963 5d0d 0a20 2020 2020  n_metric]..     
+00046a10: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00046a20: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+00046a30: 2054 6869 7320 6170 706c 6965 7320 6f6e   This applies on
+00046a40: 6c79 2074 6f20 5350 4520 636c 6173 7369  ly to SPE classi
+00046a50: 6669 6572 2023 2323 2323 2323 230d 0a20  fier ########.. 
+00046a60: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00046a70: 616c 6964 6174 696f 6e5f 6d65 7472 6963  alidation_metric
+00046a80: 203d 2027 4261 6c61 6e63 6564 2041 6363   = 'Balanced Acc
+00046a90: 7572 6163 7927 0d0a 2020 2020 2020 2020  uracy'..        
+00046aa0: 2020 2020 2020 2020 6265 7374 5f73 636f          best_sco
+00046ab0: 7265 203d 2062 616c 616e 6365 645f 6163  re = balanced_ac
+00046ac0: 6375 7261 6379 5f73 636f 7265 2879 5f63  curacy_score(y_c
+00046ad0: 762c 206d 6f64 656c 2e70 7265 6469 6374  v, model.predict
+00046ae0: 2858 5f63 7629 290d 0a20 2020 2065 7863  (X_cv))..    exc
+00046af0: 6570 743a 0d0a 2020 2020 2020 2020 7072  ept:..        pr
+00046b00: 696e 7428 2745 7272 6f72 3a20 4e6f 7420  int('Error: Not 
+00046b10: 6162 6c65 2074 6f20 7072 696e 7420 7661  able to print va
+00046b20: 6c69 6461 7469 6f6e 206d 6574 7269 6373  lidation metrics
+00046b30: 2e20 436f 6e74 696e 7569 6e67 2e2e 2e27  . Continuing...'
+00046b40: 290d 0a20 2020 2020 2020 2062 6573 745f  )..        best_
+00046b50: 7363 6f72 6520 3d20 300d 0a20 2020 2069  score = 0..    i
+00046b60: 6620 6d6f 6465 6c5f 6c61 6265 6c20 3d3d  f model_label ==
+00046b70: 2027 5369 6e67 6c65 5f4c 6162 656c 273a   'Single_Label':
+00046b80: 0d0a 2020 2020 2020 2020 6966 206d 6f64  ..        if mod
+00046b90: 656c 7479 7065 2021 3d20 2752 6567 7265  eltype != 'Regre
+00046ba0: 7373 696f 6e27 3a0d 0a20 2020 2020 2020  ssion':..       
+00046bb0: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
+00046bc0: 2323 2320 5468 6973 2069 7320 666f 7220  ### This is for 
+00046bd0: 436c 6173 7369 6669 6361 7469 6f6e 204f  Classification O
+00046be0: 6e6c 7920 2121 2023 2323 2323 2323 2323  nly !! #########
+00046bf0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+00046c00: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00046c10: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
+00046c20: 7220 696e 205b 276c 6f67 6c6f 7373 272c  r in ['logloss',
+00046c30: 276e 6567 5f6c 6f67 5f6c 6f73 7327 2c27  'neg_log_loss','
+00046c40: 6c6f 675f 6c6f 7373 272c 276c 6f67 2d6c  log_loss','log-l
+00046c50: 6f73 7327 2c27 275d 3a0d 0a20 2020 2020  oss','']:..     
+00046c60: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00046c70: 2827 7b7d 2d66 6f6c 6420 4372 6f73 7320  ('{}-fold Cross 
+00046c80: 5661 6c69 6461 7469 6f6e 207b 7d20 3d20  Validation {} = 
+00046c90: 7b7d 272e 666f 726d 6174 286e 5f73 706c  {}'.format(n_spl
+00046ca0: 6974 732c 2027 6c6f 676c 6f73 7327 2c20  its, 'logloss', 
+00046cb0: 6265 7374 5f73 636f 7265 2929 0d0a 2020  best_score))..  
+00046cc0: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
+00046cd0: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
+00046ce0: 2069 6e20 5b27 6163 6375 7261 6379 272c   in ['accuracy',
+00046cf0: 2762 616c 616e 6365 642d 6163 6375 7261  'balanced-accura
+00046d00: 6379 272c 2762 616c 616e 6365 645f 6163  cy','balanced_ac
+00046d10: 6375 7261 6379 272c 2772 6f63 5f61 7563  curacy','roc_auc
+00046d20: 272c 2772 6f63 2d61 7563 272c 0d0a 2020  ','roc-auc',..  
+00046d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00046d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046d50: 2020 2020 2020 2020 2020 2766 3127 2c27            'f1','
-00046d60: 7072 6563 6973 696f 6e27 2c27 7265 6361  precision','reca
-00046d70: 6c6c 272c 2761 7665 7261 6765 2d70 7265  ll','average-pre
-00046d80: 6369 7369 6f6e 272c 2761 7665 7261 6765  cision','average
-00046d90: 5f70 7265 6369 7369 6f6e 272c 0d0a 2020  _precision',..  
+00046d50: 2020 2020 2027 6631 272c 2770 7265 6369       'f1','preci
+00046d60: 7369 6f6e 272c 2772 6563 616c 6c27 2c27  sion','recall','
+00046d70: 6176 6572 6167 652d 7072 6563 6973 696f  average-precisio
+00046d80: 6e27 2c27 6176 6572 6167 655f 7072 6563  n','average_prec
+00046d90: 6973 696f 6e27 2c0d 0a20 2020 2020 2020  ision',..       
 00046da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046dc0: 2020 2020 2777 6569 6768 7465 645f 6631      'weighted_f1
-00046dd0: 272c 2777 6569 6768 7465 642d 6631 272c  ','weighted-f1',
-00046de0: 2741 5543 275d 3a0d 0a20 2020 2020 2020  'AUC']:..       
-00046df0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-00046e00: 2564 2d66 6f6c 6420 4372 6f73 7320 5661  %d-fold Cross Va
-00046e10: 6c69 6461 7469 6f6e 2020 2573 203d 2025  lidation  %s = %
-00046e20: 302e 3166 2525 2720 2528 6e5f 7370 6c69  0.1f%%' %(n_spli
-00046e30: 7473 2c73 636f 7269 6e67 5f70 6172 616d  ts,scoring_param
-00046e40: 6574 6572 2c20 6265 7374 5f73 636f 7265  eter, best_score
-00046e50: 2a31 3030 2929 0d0a 2020 2020 2020 2020  *100))..        
-00046e60: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00046e70: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00046e80: 2827 2564 2d66 6f6c 6420 4372 6f73 7320  ('%d-fold Cross 
-00046e90: 5661 6c69 6461 7469 6f6e 2020 2573 203d  Validation  %s =
-00046ea0: 2025 302e 3166 2720 2528 6e5f 7370 6c69   %0.1f' %(n_spli
-00046eb0: 7473 2c76 616c 6964 6174 696f 6e5f 6d65  ts,validation_me
-00046ec0: 7472 6963 2c20 6265 7374 5f73 636f 7265  tric, best_score
-00046ed0: 2929 0d0a 2020 2020 2020 2020 656c 7365  ))..        else
-00046ee0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
-00046ef0: 2323 2323 2323 2323 2054 6869 7320 6973  ######## This is
-00046f00: 2066 6f72 2052 6567 7265 7373 696f 6e20   for Regression 
-00046f10: 6f6e 6c79 2023 2323 2323 2323 2323 2323  only ###########
-00046f20: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
-00046f30: 2020 6966 2062 6573 745f 7363 6f72 6520    if best_score 
-00046f40: 3c20 303a 0d0a 2020 2020 2020 2020 2020  < 0:..          
-00046f50: 2020 2020 2020 6265 7374 5f73 636f 7265        best_score
-00046f60: 203d 2062 6573 745f 7363 6f72 652a 2d31   = best_score*-1
-00046f70: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00046f80: 2073 636f 7269 6e67 5f70 6172 616d 6574   scoring_paramet
-00046f90: 6572 203d 3d20 2727 3a0d 0a20 2020 2020  er == '':..     
-00046fa0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00046fb0: 2827 2564 2d66 6f6c 6420 4372 6f73 7320  ('%d-fold Cross 
-00046fc0: 5661 6c69 6461 7469 6f6e 2025 7320 5363  Validation %s Sc
-00046fd0: 6f72 6520 3d20 2530 2e34 6627 2025 286e  ore = %0.4f' %(n
-00046fe0: 5f73 706c 6974 732c 2752 4d53 4527 2c20  _splits,'RMSE', 
-00046ff0: 6265 7374 5f73 636f 7265 2929 0d0a 2020  best_score))..  
-00047000: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00047010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00047020: 2070 7269 6e74 2827 2564 2d66 6f6c 6420   print('%d-fold 
-00047030: 4372 6f73 7320 5661 6c69 6461 7469 6f6e  Cross Validation
-00047040: 2025 7320 5363 6f72 6520 3d20 2530 2e34   %s Score = %0.4
-00047050: 6627 2025 286e 5f73 706c 6974 732c 7661  f' %(n_splits,va
-00047060: 6c69 6461 7469 6f6e 5f6d 6574 7269 632c  lidation_metric,
-00047070: 2062 6573 745f 7363 6f72 6529 290d 0a20   best_score)).. 
-00047080: 2020 2020 2020 2023 2323 2320 5765 206e         #### We n
-00047090: 6f77 206e 6565 6420 746f 2073 6574 2074  ow need to set t
-000470a0: 6865 2042 6573 7420 5061 7261 6d65 7465  he Best Paramete
-000470b0: 7273 2c20 4669 7420 7468 6520 4d6f 6465  rs, Fit the Mode
-000470c0: 6c20 6f6e 2046 756c 6c20 585f 7472 6169  l on Full X_trai
-000470d0: 6e20 616e 6420 5072 6564 6963 7420 6f6e  n and Predict on
-000470e0: 2058 5f63 760d 0a20 2020 2020 2020 2023   X_cv..        #
-000470f0: 2323 2046 696e 6420 7768 6174 2074 6865  ## Find what the
-00047100: 206f 7264 6572 206f 6620 6265 7374 2070   order of best p
-00047110: 6172 616d 7320 6172 6520 616e 6420 7365  arams are and se
-00047120: 7420 7468 6520 7361 6d65 2061 7320 7468  t the same as th
-00047130: 6520 6f72 6967 696e 616c 206d 6f64 656c  e original model
-00047140: 2023 2323 0d0a 2020 2020 2020 2020 6966   ###..        if
-00047150: 2068 7970 6572 5f70 6172 616d 203d 3d20   hyper_param == 
-00047160: 2752 5327 206f 7220 6879 7065 725f 7061  'RS' or hyper_pa
-00047170: 7261 6d20 3d3d 2027 4753 273a 0d0a 2020  ram == 'GS':..  
-00047180: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00047190: 2049 6d62 616c 616e 6365 645f 466c 6167   Imbalanced_Flag
-000471a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000471b0: 2020 2062 6573 745f 7061 7261 6d73 3d20     best_params= 
-000471c0: 6d6f 6465 6c2e 6265 7374 5f70 6172 616d  model.best_param
-000471d0: 735f 0d0a 2020 2020 2020 2020 2020 2020  s_..            
-000471e0: 2020 2020 7072 696e 7428 2720 2020 2042      print('    B
-000471f0: 6573 7420 5061 7261 6d65 7465 7273 2066  est Parameters f
-00047200: 6f72 204d 6f64 656c 203d 2025 7327 2025  or Model = %s' %
-00047210: 6d6f 6465 6c2e 6265 7374 5f70 6172 616d  model.best_param
-00047220: 735f 290d 0a20 2020 2020 2020 2065 6c69  s_)..        eli
-00047230: 6620 6879 7065 725f 7061 7261 6d20 6973  f hyper_param is
-00047240: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-00047250: 2020 2020 2323 2323 2043 6174 426f 6f73      #### CatBoos
-00047260: 7420 646f 6573 206e 6f74 206e 6565 6420  t does not need 
-00047270: 4879 7065 7220 5061 7261 6d65 7465 7220  Hyper Parameter 
-00047280: 7475 6e69 6e67 203d 3e20 6974 2773 2067  tuning => it's g
-00047290: 7265 6174 206f 7574 206f 6620 7468 6520  reat out of the 
-000472a0: 626f 7821 0d0a 2020 2020 2020 2020 2020  box!..          
-000472b0: 2020 2323 2323 2043 6174 426f 6f73 7420    #### CatBoost 
-000472c0: 646f 6573 206e 6f74 206e 6565 6420 746f  does not need to
-000472d0: 6f20 6d61 6e79 2069 7465 7261 7469 6f6e  o many iteration
-000472e0: 732e 204a 7573 7420 6d61 6b65 2073 7572  s. Just make sur
-000472f0: 6520 796f 7520 7365 7420 7468 6520 6974  e you set the it
-00047300: 6572 6174 696f 6e73 206c 6f77 2061 6674  erations low aft
-00047310: 6572 2074 6865 2066 6972 7374 2074 696d  er the first tim
-00047320: 6521 0d0a 2020 2020 2020 2020 2020 2020  e!..            
-00047330: 6966 206e 6f74 2049 6d62 616c 616e 6365  if not Imbalance
-00047340: 645f 466c 6167 3a0d 0a20 2020 2020 2020  d_Flag:..       
-00047350: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
-00047360: 6c2e 6765 745f 6265 7374 5f69 7465 7261  l.get_best_itera
-00047370: 7469 6f6e 2829 203d 3d20 303a 0d0a 2020  tion() == 0:..  
-00047380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047390: 2020 2323 2320 496e 2073 6f6d 6520 736d    ### In some sm
-000473a0: 616c 6c20 6461 7461 2073 6574 732c 2074  all data sets, t
-000473b0: 6865 206e 756d 6265 7220 6f66 2069 7465  he number of ite
-000473c0: 7261 7469 6f6e 7320 6265 636f 6d65 7320  rations becomes 
-000473d0: 7a65 726f 2c20 6865 6e63 6520 7765 2073  zero, hence we s
-000473e0: 6574 2069 7420 6173 2061 2064 6566 6175  et it as a defau
-000473f0: 6c74 206e 756d 6265 720d 0a20 2020 2020  lt number..     
-00047400: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00047410: 6573 745f 7061 7261 6d73 203d 2064 6963  est_params = dic
-00047420: 7428 7a69 7028 5b27 6974 6572 6174 696f  t(zip(['iteratio
-00047430: 6e73 272c 276c 6561 726e 696e 675f 7261  ns','learning_ra
-00047440: 7465 275d 2c5b 3130 3030 2c6d 6f64 656c  te'],[1000,model
-00047450: 2e67 6574 5f61 6c6c 5f70 6172 616d 7328  .get_all_params(
-00047460: 295b 276c 6561 726e 696e 675f 7261 7465  )['learning_rate
-00047470: 275d 5d29 290d 0a20 2020 2020 2020 2020  ']]))..         
-00047480: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00047490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000474a0: 2020 6265 7374 5f70 6172 616d 7320 3d20    best_params = 
-000474b0: 6469 6374 287a 6970 285b 2769 7465 7261  dict(zip(['itera
-000474c0: 7469 6f6e 7327 2c27 6c65 6172 6e69 6e67  tions','learning
-000474d0: 5f72 6174 6527 5d2c 5b6d 6f64 656c 2e67  _rate'],[model.g
-000474e0: 6574 5f62 6573 745f 6974 6572 6174 696f  et_best_iteratio
-000474f0: 6e28 292c 6d6f 6465 6c2e 6765 745f 616c  n(),model.get_al
-00047500: 6c5f 7061 7261 6d73 2829 5b27 6c65 6172  l_params()['lear
-00047510: 6e69 6e67 5f72 6174 6527 5d5d 2929 0d0a  ning_rate']]))..
-00047520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047530: 7072 696e 7428 2720 2020 2025 7320 4265  print('    %s Be
-00047540: 7374 2050 6172 616d 6574 6572 7320 666f  st Parameters fo
-00047550: 7220 4d6f 6465 6c3a 2049 7465 7261 7469  r Model: Iterati
-00047560: 6f6e 7320 3d20 2573 2c20 6c65 6172 6e69  ons = %s, learni
-00047570: 6e67 5f72 6174 6520 3d20 2530 2e32 6627  ng_rate = %0.2f'
-00047580: 2025 280d 0a20 2020 2020 2020 2020 2020   %(..           
+00046db0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00046dc0: 7765 6967 6874 6564 5f66 3127 2c27 7765  weighted_f1','we
+00046dd0: 6967 6874 6564 2d66 3127 2c27 4155 4327  ighted-f1','AUC'
+00046de0: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
+00046df0: 2020 2020 7072 696e 7428 2725 642d 666f      print('%d-fo
+00046e00: 6c64 2043 726f 7373 2056 616c 6964 6174  ld Cross Validat
+00046e10: 696f 6e20 2025 7320 3d20 2530 2e31 6625  ion  %s = %0.1f%
+00046e20: 2527 2025 286e 5f73 706c 6974 732c 7363  %' %(n_splits,sc
+00046e30: 6f72 696e 675f 7061 7261 6d65 7465 722c  oring_parameter,
+00046e40: 2062 6573 745f 7363 6f72 652a 3130 3029   best_score*100)
+00046e50: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00046e60: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00046e70: 2020 2020 2020 7072 696e 7428 2725 642d        print('%d-
+00046e80: 666f 6c64 2043 726f 7373 2056 616c 6964  fold Cross Valid
+00046e90: 6174 696f 6e20 2025 7320 3d20 2530 2e31  ation  %s = %0.1
+00046ea0: 6627 2025 286e 5f73 706c 6974 732c 7661  f' %(n_splits,va
+00046eb0: 6c69 6461 7469 6f6e 5f6d 6574 7269 632c  lidation_metric,
+00046ec0: 2062 6573 745f 7363 6f72 6529 290d 0a20   best_score)).. 
+00046ed0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00046ee0: 2020 2020 2020 2020 2020 2323 2323 2323            ######
+00046ef0: 2323 2320 5468 6973 2069 7320 666f 7220  ### This is for 
+00046f00: 5265 6772 6573 7369 6f6e 206f 6e6c 7920  Regression only 
+00046f10: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+00046f20: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00046f30: 6265 7374 5f73 636f 7265 203c 2030 3a0d  best_score < 0:.
+00046f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00046f50: 2062 6573 745f 7363 6f72 6520 3d20 6265   best_score = be
+00046f60: 7374 5f73 636f 7265 2a2d 310d 0a20 2020  st_score*-1..   
+00046f70: 2020 2020 2020 2020 2069 6620 7363 6f72           if scor
+00046f80: 696e 675f 7061 7261 6d65 7465 7220 3d3d  ing_parameter ==
+00046f90: 2027 273a 0d0a 2020 2020 2020 2020 2020   '':..          
+00046fa0: 2020 2020 2020 7072 696e 7428 2725 642d        print('%d-
+00046fb0: 666f 6c64 2043 726f 7373 2056 616c 6964  fold Cross Valid
+00046fc0: 6174 696f 6e20 2573 2053 636f 7265 203d  ation %s Score =
+00046fd0: 2025 302e 3466 2720 2528 6e5f 7370 6c69   %0.4f' %(n_spli
+00046fe0: 7473 2c27 524d 5345 272c 2062 6573 745f  ts,'RMSE', best_
+00046ff0: 7363 6f72 6529 290d 0a20 2020 2020 2020  score))..       
+00047000: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00047010: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00047020: 7428 2725 642d 666f 6c64 2043 726f 7373  t('%d-fold Cross
+00047030: 2056 616c 6964 6174 696f 6e20 2573 2053   Validation %s S
+00047040: 636f 7265 203d 2025 302e 3466 2720 2528  core = %0.4f' %(
+00047050: 6e5f 7370 6c69 7473 2c76 616c 6964 6174  n_splits,validat
+00047060: 696f 6e5f 6d65 7472 6963 2c20 6265 7374  ion_metric, best
+00047070: 5f73 636f 7265 2929 0d0a 2020 2020 2020  _score))..      
+00047080: 2020 2323 2323 2057 6520 6e6f 7720 6e65    #### We now ne
+00047090: 6564 2074 6f20 7365 7420 7468 6520 4265  ed to set the Be
+000470a0: 7374 2050 6172 616d 6574 6572 732c 2046  st Parameters, F
+000470b0: 6974 2074 6865 204d 6f64 656c 206f 6e20  it the Model on 
+000470c0: 4675 6c6c 2058 5f74 7261 696e 2061 6e64  Full X_train and
+000470d0: 2050 7265 6469 6374 206f 6e20 585f 6376   Predict on X_cv
+000470e0: 0d0a 2020 2020 2020 2020 2323 2320 4669  ..        ### Fi
+000470f0: 6e64 2077 6861 7420 7468 6520 6f72 6465  nd what the orde
+00047100: 7220 6f66 2062 6573 7420 7061 7261 6d73  r of best params
+00047110: 2061 7265 2061 6e64 2073 6574 2074 6865   are and set the
+00047120: 2073 616d 6520 6173 2074 6865 206f 7269   same as the ori
+00047130: 6769 6e61 6c20 6d6f 6465 6c20 2323 230d  ginal model ###.
+00047140: 0a20 2020 2020 2020 2069 6620 6879 7065  .        if hype
+00047150: 725f 7061 7261 6d20 3d3d 2027 5253 2720  r_param == 'RS' 
+00047160: 6f72 2068 7970 6572 5f70 6172 616d 203d  or hyper_param =
+00047170: 3d20 2747 5327 3a0d 0a20 2020 2020 2020  = 'GS':..       
+00047180: 2020 2020 2069 6620 6e6f 7420 496d 6261       if not Imba
+00047190: 6c61 6e63 6564 5f46 6c61 673a 0d0a 2020  lanced_Flag:..  
+000471a0: 2020 2020 2020 2020 2020 2020 2020 6265                be
+000471b0: 7374 5f70 6172 616d 733d 206d 6f64 656c  st_params= model
+000471c0: 2e62 6573 745f 7061 7261 6d73 5f0d 0a20  .best_params_.. 
+000471d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000471e0: 7269 6e74 2827 2020 2020 4265 7374 2050  rint('    Best P
+000471f0: 6172 616d 6574 6572 7320 666f 7220 4d6f  arameters for Mo
+00047200: 6465 6c20 3d20 2573 2720 256d 6f64 656c  del = %s' %model
+00047210: 2e62 6573 745f 7061 7261 6d73 5f29 0d0a  .best_params_)..
+00047220: 2020 2020 2020 2020 656c 6966 2068 7970          elif hyp
+00047230: 6572 5f70 6172 616d 2069 7320 4e6f 6e65  er_param is None
+00047240: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
+00047250: 2323 2320 4361 7442 6f6f 7374 2064 6f65  ### CatBoost doe
+00047260: 7320 6e6f 7420 6e65 6564 2048 7970 6572  s not need Hyper
+00047270: 2050 6172 616d 6574 6572 2074 756e 696e   Parameter tunin
+00047280: 6720 3d3e 2069 7427 7320 6772 6561 7420  g => it's great 
+00047290: 6f75 7420 6f66 2074 6865 2062 6f78 210d  out of the box!.
+000472a0: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
+000472b0: 2320 4361 7442 6f6f 7374 2064 6f65 7320  # CatBoost does 
+000472c0: 6e6f 7420 6e65 6564 2074 6f6f 206d 616e  not need too man
+000472d0: 7920 6974 6572 6174 696f 6e73 2e20 4a75  y iterations. Ju
+000472e0: 7374 206d 616b 6520 7375 7265 2079 6f75  st make sure you
+000472f0: 2073 6574 2074 6865 2069 7465 7261 7469   set the iterati
+00047300: 6f6e 7320 6c6f 7720 6166 7465 7220 7468  ons low after th
+00047310: 6520 6669 7273 7420 7469 6d65 210d 0a20  e first time!.. 
+00047320: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00047330: 7420 496d 6261 6c61 6e63 6564 5f46 6c61  t Imbalanced_Fla
+00047340: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
+00047350: 2020 2020 6966 206d 6f64 656c 2e67 6574      if model.get
+00047360: 5f62 6573 745f 6974 6572 6174 696f 6e28  _best_iteration(
+00047370: 2920 3d3d 2030 3a0d 0a20 2020 2020 2020  ) == 0:..       
+00047380: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00047390: 2049 6e20 736f 6d65 2073 6d61 6c6c 2064   In some small d
+000473a0: 6174 6120 7365 7473 2c20 7468 6520 6e75  ata sets, the nu
+000473b0: 6d62 6572 206f 6620 6974 6572 6174 696f  mber of iteratio
+000473c0: 6e73 2062 6563 6f6d 6573 207a 6572 6f2c  ns becomes zero,
+000473d0: 2068 656e 6365 2077 6520 7365 7420 6974   hence we set it
+000473e0: 2061 7320 6120 6465 6661 756c 7420 6e75   as a default nu
+000473f0: 6d62 6572 0d0a 2020 2020 2020 2020 2020  mber..          
+00047400: 2020 2020 2020 2020 2020 6265 7374 5f70            best_p
+00047410: 6172 616d 7320 3d20 6469 6374 287a 6970  arams = dict(zip
+00047420: 285b 2769 7465 7261 7469 6f6e 7327 2c27  (['iterations','
+00047430: 6c65 6172 6e69 6e67 5f72 6174 6527 5d2c  learning_rate'],
+00047440: 5b31 3030 302c 6d6f 6465 6c2e 6765 745f  [1000,model.get_
+00047450: 616c 6c5f 7061 7261 6d73 2829 5b27 6c65  all_params()['le
+00047460: 6172 6e69 6e67 5f72 6174 6527 5d5d 2929  arning_rate']]))
+00047470: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00047480: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00047490: 2020 2020 2020 2020 2020 2020 2062 6573               bes
+000474a0: 745f 7061 7261 6d73 203d 2064 6963 7428  t_params = dict(
+000474b0: 7a69 7028 5b27 6974 6572 6174 696f 6e73  zip(['iterations
+000474c0: 272c 276c 6561 726e 696e 675f 7261 7465  ','learning_rate
+000474d0: 275d 2c5b 6d6f 6465 6c2e 6765 745f 6265  '],[model.get_be
+000474e0: 7374 5f69 7465 7261 7469 6f6e 2829 2c6d  st_iteration(),m
+000474f0: 6f64 656c 2e67 6574 5f61 6c6c 5f70 6172  odel.get_all_par
+00047500: 616d 7328 295b 276c 6561 726e 696e 675f  ams()['learning_
+00047510: 7261 7465 275d 5d29 290d 0a20 2020 2020  rate']]))..     
+00047520: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00047530: 2827 2020 2020 2573 2042 6573 7420 5061  ('    %s Best Pa
+00047540: 7261 6d65 7465 7273 2066 6f72 204d 6f64  rameters for Mod
+00047550: 656c 3a20 4974 6572 6174 696f 6e73 203d  el: Iterations =
+00047560: 2025 732c 206c 6561 726e 696e 675f 7261   %s, learning_ra
+00047570: 7465 203d 2025 302e 3266 2720 2528 0d0a  te = %0.2f' %(..
+00047580: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00047590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000475a0: 2020 2020 2020 2020 206d 6f64 656c 5f6e           model_n
-000475b0: 616d 652c 206d 6f64 656c 2e67 6574 5f62  ame, model.get_b
-000475c0: 6573 745f 6974 6572 6174 696f 6e28 292c  est_iteration(),
-000475d0: 206d 6f64 656c 2e67 6574 5f61 6c6c 5f70   model.get_all_p
-000475e0: 6172 616d 7328 295b 276c 6561 726e 696e  arams()['learnin
-000475f0: 675f 7261 7465 275d 2929 0d0a 2020 2020  g_rate']))..    
-00047600: 2020 2020 2020 2020 656c 6966 2049 6d62          elif Imb
-00047610: 616c 616e 6365 645f 466c 6167 2061 6e64  alanced_Flag and
-00047620: 206d 6f64 656c 7479 7065 203d 3d20 2752   modeltype == 'R
-00047630: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
-00047640: 2020 2020 2020 2020 2020 2020 2023 2320               ## 
-00047650: 7468 6973 206d 6561 6e73 2072 6567 7265  this means regre
-00047660: 7373 696f 6e20 7265 7361 6d70 6c65 7220  ssion resampler 
-00047670: 6973 2062 6569 6e67 2075 7365 640d 0a20  is being used.. 
-00047680: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00047690: 6620 6d6f 6465 6c2e 6765 745f 6265 7374  f model.get_best
-000476a0: 5f69 7465 7261 7469 6f6e 2829 203d 3d20  _iteration() == 
-000476b0: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-000476c0: 2020 2020 2020 2020 2323 2320 496e 2073          ### In s
-000476d0: 6f6d 6520 736d 616c 6c20 6461 7461 2073  ome small data s
-000476e0: 6574 732c 2074 6865 206e 756d 6265 7220  ets, the number 
-000476f0: 6f66 2069 7465 7261 7469 6f6e 7320 6265  of iterations be
-00047700: 636f 6d65 7320 7a65 726f 2c20 6865 6e63  comes zero, henc
-00047710: 6520 7765 2073 6574 2069 7420 6173 2061  e we set it as a
-00047720: 2064 6566 6175 6c74 206e 756d 6265 720d   default number.
-00047730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00047740: 2020 2020 2062 6573 745f 7061 7261 6d73       best_params
-00047750: 203d 2064 6963 7428 7a69 7028 5b27 6974   = dict(zip(['it
-00047760: 6572 6174 696f 6e73 272c 276c 6561 726e  erations','learn
-00047770: 696e 675f 7261 7465 275d 2c5b 3130 3030  ing_rate'],[1000
-00047780: 2c6d 6f64 656c 2e67 6574 5f61 6c6c 5f70  ,model.get_all_p
-00047790: 6172 616d 7328 295b 276c 6561 726e 696e  arams()['learnin
-000477a0: 675f 7261 7465 275d 5d29 290d 0a20 2020  g_rate']]))..   
-000477b0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-000477c0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-000477d0: 2020 2020 2020 2020 6265 7374 5f70 6172          best_par
-000477e0: 616d 7320 3d20 6469 6374 287a 6970 285b  ams = dict(zip([
-000477f0: 2769 7465 7261 7469 6f6e 7327 2c27 6c65  'iterations','le
-00047800: 6172 6e69 6e67 5f72 6174 6527 5d2c 5b6d  arning_rate'],[m
-00047810: 6f64 656c 2e67 6574 5f62 6573 745f 6974  odel.get_best_it
-00047820: 6572 6174 696f 6e28 292c 6d6f 6465 6c2e  eration(),model.
-00047830: 6765 745f 616c 6c5f 7061 7261 6d73 2829  get_all_params()
-00047840: 5b27 6c65 6172 6e69 6e67 5f72 6174 6527  ['learning_rate'
-00047850: 5d5d 2929 0d0a 2020 2020 2020 2020 2020  ]]))..          
-00047860: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-00047870: 2025 7320 4265 7374 2050 6172 616d 6574   %s Best Paramet
-00047880: 6572 7320 666f 7220 4d6f 6465 6c3a 2049  ers for Model: I
-00047890: 7465 7261 7469 6f6e 7320 3d20 2573 2c20  terations = %s, 
-000478a0: 6c65 6172 6e69 6e67 5f72 6174 6520 3d20  learning_rate = 
-000478b0: 2530 2e32 6627 2025 280d 0a20 2020 2020  %0.2f' %(..     
+000475a0: 2020 2020 6d6f 6465 6c5f 6e61 6d65 2c20      model_name, 
+000475b0: 6d6f 6465 6c2e 6765 745f 6265 7374 5f69  model.get_best_i
+000475c0: 7465 7261 7469 6f6e 2829 2c20 6d6f 6465  teration(), mode
+000475d0: 6c2e 6765 745f 616c 6c5f 7061 7261 6d73  l.get_all_params
+000475e0: 2829 5b27 6c65 6172 6e69 6e67 5f72 6174  ()['learning_rat
+000475f0: 6527 5d29 290d 0a20 2020 2020 2020 2020  e']))..         
+00047600: 2020 2065 6c69 6620 496d 6261 6c61 6e63     elif Imbalanc
+00047610: 6564 5f46 6c61 6720 616e 6420 6d6f 6465  ed_Flag and mode
+00047620: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
+00047630: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
+00047640: 2020 2020 2020 2020 2323 2074 6869 7320          ## this 
+00047650: 6d65 616e 7320 7265 6772 6573 7369 6f6e  means regression
+00047660: 2072 6573 616d 706c 6572 2069 7320 6265   resampler is be
+00047670: 696e 6720 7573 6564 0d0a 2020 2020 2020  ing used..      
+00047680: 2020 2020 2020 2020 2020 6966 206d 6f64            if mod
+00047690: 656c 2e67 6574 5f62 6573 745f 6974 6572  el.get_best_iter
+000476a0: 6174 696f 6e28 2920 3d3d 2030 3a0d 0a20  ation() == 0:.. 
+000476b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000476c0: 2020 2023 2323 2049 6e20 736f 6d65 2073     ### In some s
+000476d0: 6d61 6c6c 2064 6174 6120 7365 7473 2c20  mall data sets, 
+000476e0: 7468 6520 6e75 6d62 6572 206f 6620 6974  the number of it
+000476f0: 6572 6174 696f 6e73 2062 6563 6f6d 6573  erations becomes
+00047700: 207a 6572 6f2c 2068 656e 6365 2077 6520   zero, hence we 
+00047710: 7365 7420 6974 2061 7320 6120 6465 6661  set it as a defa
+00047720: 756c 7420 6e75 6d62 6572 0d0a 2020 2020  ult number..    
+00047730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047740: 6265 7374 5f70 6172 616d 7320 3d20 6469  best_params = di
+00047750: 6374 287a 6970 285b 2769 7465 7261 7469  ct(zip(['iterati
+00047760: 6f6e 7327 2c27 6c65 6172 6e69 6e67 5f72  ons','learning_r
+00047770: 6174 6527 5d2c 5b31 3030 302c 6d6f 6465  ate'],[1000,mode
+00047780: 6c2e 6765 745f 616c 6c5f 7061 7261 6d73  l.get_all_params
+00047790: 2829 5b27 6c65 6172 6e69 6e67 5f72 6174  ()['learning_rat
+000477a0: 6527 5d5d 2929 0d0a 2020 2020 2020 2020  e']]))..        
+000477b0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+000477c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000477d0: 2020 2062 6573 745f 7061 7261 6d73 203d     best_params =
+000477e0: 2064 6963 7428 7a69 7028 5b27 6974 6572   dict(zip(['iter
+000477f0: 6174 696f 6e73 272c 276c 6561 726e 696e  ations','learnin
+00047800: 675f 7261 7465 275d 2c5b 6d6f 6465 6c2e  g_rate'],[model.
+00047810: 6765 745f 6265 7374 5f69 7465 7261 7469  get_best_iterati
+00047820: 6f6e 2829 2c6d 6f64 656c 2e67 6574 5f61  on(),model.get_a
+00047830: 6c6c 5f70 6172 616d 7328 295b 276c 6561  ll_params()['lea
+00047840: 726e 696e 675f 7261 7465 275d 5d29 290d  rning_rate']])).
+00047850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00047860: 2070 7269 6e74 2827 2020 2020 2573 2042   print('    %s B
+00047870: 6573 7420 5061 7261 6d65 7465 7273 2066  est Parameters f
+00047880: 6f72 204d 6f64 656c 3a20 4974 6572 6174  or Model: Iterat
+00047890: 696f 6e73 203d 2025 732c 206c 6561 726e  ions = %s, learn
+000478a0: 696e 675f 7261 7465 203d 2025 302e 3266  ing_rate = %0.2f
+000478b0: 2720 2528 0d0a 2020 2020 2020 2020 2020  ' %(..          
 000478c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000478d0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-000478e0: 6f64 656c 5f6e 616d 652c 206d 6f64 656c  odel_name, model
-000478f0: 2e67 6574 5f62 6573 745f 6974 6572 6174  .get_best_iterat
-00047900: 696f 6e28 292c 206d 6f64 656c 2e67 6574  ion(), model.get
-00047910: 5f61 6c6c 5f70 6172 616d 7328 295b 276c  _all_params()['l
-00047920: 6561 726e 696e 675f 7261 7465 275d 2929  earning_rate']))
-00047930: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00047940: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00047950: 2020 2020 2062 6573 745f 7061 7261 6d73       best_params
-00047960: 203d 207b 7d0d 0a20 2020 2020 2020 2069   = {}..        i
-00047970: 6620 6879 7065 725f 7061 7261 6d20 3d3d  f hyper_param ==
-00047980: 2027 5253 2720 6f72 2068 7970 6572 5f70   'RS' or hyper_p
-00047990: 6172 616d 203d 3d20 2747 5327 3a0d 0a20  aram == 'GS':.. 
-000479a0: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
-000479b0: 496e 2074 6865 2063 6173 6520 6f66 2043  In the case of C
-000479c0: 6174 426f 6f73 742c 2077 6520 646f 6e27  atBoost, we don'
-000479d0: 7420 646f 2061 6e79 2048 7970 6572 2050  t do any Hyper P
-000479e0: 6172 616d 6574 6572 2074 756e 696e 6720  arameter tuning 
-000479f0: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
-00047a00: 2020 2020 2020 2069 6620 6e6f 7420 496d         if not Im
-00047a10: 6261 6c61 6e63 6564 5f46 6c61 673a 0d0a  balanced_Flag:..
-00047a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047a30: 6773 203d 2063 6f70 792e 6465 6570 636f  gs = copy.deepco
-00047a40: 7079 286d 6f64 656c 290d 0a20 2020 2020  py(model)..     
-00047a50: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-00047a60: 203d 2067 732e 6265 7374 5f65 7374 696d   = gs.best_estim
-00047a70: 6174 6f72 5f0d 0a20 2020 2020 2020 2020  ator_..         
-00047a80: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00047a90: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00047aa0: 274e 6f20 6372 6f73 7320 7661 6c69 6461  'No cross valida
-00047ab0: 7469 6f6e 2064 6f6e 6520 7768 656e 2049  tion done when I
-00047ac0: 6d62 616c 616e 6365 645f 466c 6167 2073  mbalanced_Flag s
-00047ad0: 6574 2074 6f20 5472 7565 2e2e 2e27 290d  et to True...').
-00047ae0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00047af0: 6d6f 6465 6c5f 6c61 6265 6c20 3d3d 2027  model_label == '
-00047b00: 5369 6e67 6c65 5f4c 6162 656c 2720 616e  Single_Label' an
-00047b10: 6420 6d6f 6465 6c74 7970 6520 3d3d 2027  d modeltype == '
-00047b20: 4d75 6c74 695f 436c 6173 7369 6669 6361  Multi_Classifica
-00047b30: 7469 6f6e 273a 0d0a 2020 2020 2020 2020  tion':..        
-00047b40: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-00047b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047b60: 2020 6966 2058 5f63 762e 7368 6170 655b    if X_cv.shape[
-00047b70: 305d 203c 3d20 3130 3030 3a0d 0a20 2020  0] <= 1000:..   
+000478d0: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
+000478e0: 6e61 6d65 2c20 6d6f 6465 6c2e 6765 745f  name, model.get_
+000478f0: 6265 7374 5f69 7465 7261 7469 6f6e 2829  best_iteration()
+00047900: 2c20 6d6f 6465 6c2e 6765 745f 616c 6c5f  , model.get_all_
+00047910: 7061 7261 6d73 2829 5b27 6c65 6172 6e69  params()['learni
+00047920: 6e67 5f72 6174 6527 5d29 290d 0a20 2020  ng_rate']))..   
+00047930: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00047940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047950: 6265 7374 5f70 6172 616d 7320 3d20 7b7d  best_params = {}
+00047960: 0d0a 2020 2020 2020 2020 6966 2068 7970  ..        if hyp
+00047970: 6572 5f70 6172 616d 203d 3d20 2752 5327  er_param == 'RS'
+00047980: 206f 7220 6879 7065 725f 7061 7261 6d20   or hyper_param 
+00047990: 3d3d 2027 4753 273a 0d0a 2020 2020 2020  == 'GS':..      
+000479a0: 2020 2020 2020 2323 2323 2049 6e20 7468        #### In th
+000479b0: 6520 6361 7365 206f 6620 4361 7442 6f6f  e case of CatBoo
+000479c0: 7374 2c20 7765 2064 6f6e 2774 2064 6f20  st, we don't do 
+000479d0: 616e 7920 4879 7065 7220 5061 7261 6d65  any Hyper Parame
+000479e0: 7465 7220 7475 6e69 6e67 2023 2323 2323  ter tuning #####
+000479f0: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
+00047a00: 2020 6966 206e 6f74 2049 6d62 616c 616e    if not Imbalan
+00047a10: 6365 645f 466c 6167 3a0d 0a20 2020 2020  ced_Flag:..     
+00047a20: 2020 2020 2020 2020 2020 2067 7320 3d20             gs = 
+00047a30: 636f 7079 2e64 6565 7063 6f70 7928 6d6f  copy.deepcopy(mo
+00047a40: 6465 6c29 0d0a 2020 2020 2020 2020 2020  del)..          
+00047a50: 2020 2020 2020 6d6f 6465 6c20 3d20 6773        model = gs
+00047a60: 2e62 6573 745f 6573 7469 6d61 746f 725f  .best_estimator_
+00047a70: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00047a80: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00047a90: 2020 2020 2070 7269 6e74 2827 4e6f 2063       print('No c
+00047aa0: 726f 7373 2076 616c 6964 6174 696f 6e20  ross validation 
+00047ab0: 646f 6e65 2077 6865 6e20 496d 6261 6c61  done when Imbala
+00047ac0: 6e63 6564 5f46 6c61 6720 7365 7420 746f  nced_Flag set to
+00047ad0: 2054 7275 652e 2e2e 2729 0d0a 2020 2020   True...')..    
+00047ae0: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
+00047af0: 5f6c 6162 656c 203d 3d20 2753 696e 676c  _label == 'Singl
+00047b00: 655f 4c61 6265 6c27 2061 6e64 206d 6f64  e_Label' and mod
+00047b10: 656c 7479 7065 203d 3d20 274d 756c 7469  eltype == 'Multi
+00047b20: 5f43 6c61 7373 6966 6963 6174 696f 6e27  _Classification'
+00047b30: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00047b40: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+00047b50: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00047b60: 585f 6376 2e73 6861 7065 5b30 5d20 3c3d  X_cv.shape[0] <=
+00047b70: 2031 3030 303a 0d0a 2020 2020 2020 2020   1000:..        
 00047b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047b90: 2020 2020 2023 2054 4869 7320 776f 726b       # THis work
-00047ba0: 7320 7765 6c6c 2066 6f72 2073 6d61 6c6c  s well for small
-00047bb0: 2064 6174 6120 7365 7473 2061 6e64 2069   data sets and i
-00047bc0: 7320 7369 6d69 6c61 7220 746f 2070 6172  s similar to par
-00047bd0: 616d 6574 7269 630d 0a20 2020 2020 2020  ametric..       
-00047be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047bf0: 206d 6574 686f 643d 2020 2773 6967 6d6f   method=  'sigmo
-00047c00: 6964 2720 2320 2769 736f 746f 6e69 6327  id' # 'isotonic'
-00047c10: 2023 2023 0d0a 2020 2020 2020 2020 2020   # #..          
-00047c20: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00047c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00047c40: 2020 2020 2020 2020 2023 2054 4869 7320           # THis 
-00047c50: 776f 726b 7320 7765 6c6c 2066 6f72 206c  works well for l
-00047c60: 6172 6765 2064 6174 6120 7365 7473 2061  arge data sets a
-00047c70: 6e64 2069 7320 6e6f 6e2d 7061 7261 6d65  nd is non-parame
-00047c80: 7472 6963 0d0a 2020 2020 2020 2020 2020  tric..          
-00047c90: 2020 2020 2020 2020 2020 2020 2020 6d65                me
-00047ca0: 7468 6f64 3d20 2027 6973 6f74 6f6e 6963  thod=  'isotonic
-00047cb0: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-00047cc0: 2020 2020 2020 2066 726f 6d20 736b 6c65         from skle
-00047cd0: 6172 6e2e 6361 6c69 6272 6174 696f 6e20  arn.calibration 
-00047ce0: 696d 706f 7274 2043 616c 6962 7261 7465  import Calibrate
-00047cf0: 6443 6c61 7373 6966 6965 7243 560d 0a20  dClassifierCV.. 
-00047d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047d10: 2020 206d 6f64 656c 203d 2043 616c 6962     model = Calib
-00047d20: 7261 7465 6443 6c61 7373 6966 6965 7243  ratedClassifierC
-00047d30: 5628 6d6f 6465 6c2c 206d 6574 686f 643d  V(model, method=
-00047d40: 6d65 7468 6f64 2c20 6376 3d6e 5f73 706c  method, cv=n_spl
-00047d50: 6974 7329 0d0a 2020 2020 2020 2020 2020  its)..          
-00047d60: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00047d70: 2070 6572 666f 726d 5f73 6361 6c69 6e67   perform_scaling
-00047d80: 5f66 6c61 673a 0d0a 2020 2020 2020 2020  _flag:..        
-00047d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047da0: 585f 6675 6c20 3d20 585f 7472 6169 6e2e  X_ful = X_train.
-00047db0: 6170 7065 6e64 2858 5f63 7629 0d0a 2020  append(X_cv)..  
+00047b90: 2320 5448 6973 2077 6f72 6b73 2077 656c  # THis works wel
+00047ba0: 6c20 666f 7220 736d 616c 6c20 6461 7461  l for small data
+00047bb0: 2073 6574 7320 616e 6420 6973 2073 696d   sets and is sim
+00047bc0: 696c 6172 2074 6f20 7061 7261 6d65 7472  ilar to parametr
+00047bd0: 6963 0d0a 2020 2020 2020 2020 2020 2020  ic..            
+00047be0: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
+00047bf0: 6f64 3d20 2027 7369 676d 6f69 6427 2023  od=  'sigmoid' #
+00047c00: 2027 6973 6f74 6f6e 6963 2720 2320 230d   'isotonic' # #.
+00047c10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00047c20: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00047c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047c40: 2020 2020 2320 5448 6973 2077 6f72 6b73      # THis works
+00047c50: 2077 656c 6c20 666f 7220 6c61 7267 6520   well for large 
+00047c60: 6461 7461 2073 6574 7320 616e 6420 6973  data sets and is
+00047c70: 206e 6f6e 2d70 6172 616d 6574 7269 630d   non-parametric.
+00047c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00047c90: 2020 2020 2020 2020 206d 6574 686f 643d           method=
+00047ca0: 2020 2769 736f 746f 6e69 6327 0d0a 2020    'isotonic'..  
+00047cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047cc0: 2020 6672 6f6d 2073 6b6c 6561 726e 2e63    from sklearn.c
+00047cd0: 616c 6962 7261 7469 6f6e 2069 6d70 6f72  alibration impor
+00047ce0: 7420 4361 6c69 6272 6174 6564 436c 6173  t CalibratedClas
+00047cf0: 7369 6669 6572 4356 0d0a 2020 2020 2020  sifierCV..      
+00047d00: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+00047d10: 6465 6c20 3d20 4361 6c69 6272 6174 6564  del = Calibrated
+00047d20: 436c 6173 7369 6669 6572 4356 286d 6f64  ClassifierCV(mod
+00047d30: 656c 2c20 6d65 7468 6f64 3d6d 6574 686f  el, method=metho
+00047d40: 642c 2063 763d 6e5f 7370 6c69 7473 290d  d, cv=n_splits).
+00047d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00047d60: 2020 2020 2069 6620 6e6f 7420 7065 7266       if not perf
+00047d70: 6f72 6d5f 7363 616c 696e 675f 666c 6167  orm_scaling_flag
+00047d80: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00047d90: 2020 2020 2020 2020 2020 2058 5f66 756c             X_ful
+00047da0: 203d 2058 5f74 7261 696e 2e61 7070 656e   = X_train.appen
+00047db0: 6428 585f 6376 290d 0a20 2020 2020 2020  d(X_cv)..       
 00047dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047dd0: 2020 2020 2020 795f 6675 6c20 3d20 795f        y_ful = y_
-00047de0: 7472 6169 6e2e 6170 7065 6e64 2879 5f63  train.append(y_c
-00047df0: 7629 0d0a 2020 2020 2020 2020 2020 2020  v)..            
-00047e00: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00047dd0: 2079 5f66 756c 203d 2079 5f74 7261 696e   y_ful = y_train
+00047de0: 2e61 7070 656e 6428 795f 6376 290d 0a20  .append(y_cv).. 
+00047df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047e00: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
 00047e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047e20: 2020 2020 2020 2058 5f66 756c 203d 206e         X_ful = n
-00047e30: 702e 725f 5b58 5f74 7261 696e 2c20 585f  p.r_[X_train, X_
-00047e40: 6376 5d0d 0a20 2020 2020 2020 2020 2020  cv]..           
-00047e50: 2020 2020 2020 2020 2020 2020 2079 5f66               y_f
-00047e60: 756c 203d 206e 702e 725f 5b79 5f74 7261  ul = np.r_[y_tra
-00047e70: 696e 2c20 795f 6376 5d0d 0a20 2020 2020  in, y_cv]..     
-00047e80: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00047e90: 6f64 656c 2e66 6974 2858 5f66 756c 2c20  odel.fit(X_ful, 
-00047ea0: 795f 6675 6c29 0d0a 2020 2020 2020 2020  y_ful)..        
-00047eb0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00047ec0: 7428 2755 7369 6e67 2061 2043 616c 6962  t('Using a Calib
-00047ed0: 7261 7465 6420 436c 6173 7369 6669 6572  rated Classifier
-00047ee0: 2069 6e20 7468 6973 204d 756c 7469 5f43   in this Multi_C
-00047ef0: 6c61 7373 6966 6963 6174 696f 6e20 6461  lassification da
-00047f00: 7461 7365 7420 746f 2069 6d70 726f 7665  taset to improve
-00047f10: 2072 6573 756c 7473 2e2e 2e27 290d 0a20   results...').. 
-00047f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047f30: 2020 2063 616c 6962 7261 746f 725f 666c     calibrator_fl
-00047f40: 6167 203d 2054 7275 650d 0a20 2020 2020  ag = True..     
-00047f50: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-00047f60: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
-00047f70: 2020 2020 2020 2020 6361 6c69 6272 6174          calibrat
-00047f80: 6f72 5f66 6c61 6720 3d20 4661 6c73 650d  or_flag = False.
-00047f90: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00047fa0: 6620 6d6f 6465 6c5f 6c61 6265 6c20 3d3d  f model_label ==
-00047fb0: 2027 4d75 6c74 695f 4c61 6265 6c27 2061   'Multi_Label' a
-00047fc0: 6e64 206d 6f64 656c 7479 7065 203d 3d20  nd modeltype == 
-00047fd0: 2742 696e 6172 795f 436c 6173 7369 6669  'Binary_Classifi
-00047fe0: 6361 7469 6f6e 273a 0d0a 2020 2020 2020  cation':..      
-00047ff0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00048000: 2720 2020 204e 6f20 4772 6964 5365 6172  '    No GridSear
-00048010: 6368 206f 7220 5261 6e64 6f6d 697a 6564  ch or Randomized
-00048020: 5365 6172 6368 2066 6f72 2025 7320 2573  Search for %s %s
-00048030: 2073 696e 6365 2069 7420 7461 6b65 7320   since it takes 
-00048040: 746f 6f20 6c6f 6e67 2720 2528 0d0a 2020  too long' %(..  
+00047e20: 2020 585f 6675 6c20 3d20 6e70 2e72 5f5b    X_ful = np.r_[
+00047e30: 585f 7472 6169 6e2c 2058 5f63 765d 0d0a  X_train, X_cv]..
+00047e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047e50: 2020 2020 2020 2020 795f 6675 6c20 3d20          y_ful = 
+00047e60: 6e70 2e72 5f5b 795f 7472 6169 6e2c 2079  np.r_[y_train, y
+00047e70: 5f63 765d 0d0a 2020 2020 2020 2020 2020  _cv]..          
+00047e80: 2020 2020 2020 2020 2020 6d6f 6465 6c2e            model.
+00047e90: 6669 7428 585f 6675 6c2c 2079 5f66 756c  fit(X_ful, y_ful
+00047ea0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00047eb0: 2020 2020 2020 2070 7269 6e74 2827 5573         print('Us
+00047ec0: 696e 6720 6120 4361 6c69 6272 6174 6564  ing a Calibrated
+00047ed0: 2043 6c61 7373 6966 6965 7220 696e 2074   Classifier in t
+00047ee0: 6869 7320 4d75 6c74 695f 436c 6173 7369  his Multi_Classi
+00047ef0: 6669 6361 7469 6f6e 2064 6174 6173 6574  fication dataset
+00047f00: 2074 6f20 696d 7072 6f76 6520 7265 7375   to improve resu
+00047f10: 6c74 732e 2e2e 2729 0d0a 2020 2020 2020  lts...')..      
+00047f20: 2020 2020 2020 2020 2020 2020 2020 6361                ca
+00047f30: 6c69 6272 6174 6f72 5f66 6c61 6720 3d20  librator_flag = 
+00047f40: 5472 7565 0d0a 2020 2020 2020 2020 2020  True..          
+00047f50: 2020 2020 2020 6578 6365 7074 3a0d 0a20        except:.. 
+00047f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047f70: 2020 2063 616c 6962 7261 746f 725f 666c     calibrator_fl
+00047f80: 6167 203d 2046 616c 7365 0d0a 2020 2020  ag = False..    
+00047f90: 2020 2020 2020 2020 656c 6966 206d 6f64          elif mod
+00047fa0: 656c 5f6c 6162 656c 203d 3d20 274d 756c  el_label == 'Mul
+00047fb0: 7469 5f4c 6162 656c 2720 616e 6420 6d6f  ti_Label' and mo
+00047fc0: 6465 6c74 7970 6520 3d3d 2027 4269 6e61  deltype == 'Bina
+00047fd0: 7279 5f43 6c61 7373 6966 6963 6174 696f  ry_Classificatio
+00047fe0: 6e27 3a0d 0a20 2020 2020 2020 2020 2020  n':..           
+00047ff0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+00048000: 4e6f 2047 7269 6453 6561 7263 6820 6f72  No GridSearch or
+00048010: 2052 616e 646f 6d69 7a65 6453 6561 7263   RandomizedSearc
+00048020: 6820 666f 7220 2573 2025 7320 7369 6e63  h for %s %s sinc
+00048030: 6520 6974 2074 616b 6573 2074 6f6f 206c  e it takes too l
+00048040: 6f6e 6727 2025 280d 0a20 2020 2020 2020  ong' %(..       
 00048050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00048060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00048070: 2020 6d6f 6465 6c5f 6c61 6265 6c2c 6d6f    model_label,mo
-00048080: 6465 6c74 7970 6529 290d 0a20 2020 2020  deltype))..     
-00048090: 2020 2023 6966 206d 6f64 656c 5f6e 616d     #if model_nam
-000480a0: 652e 6c6f 7765 7228 2920 3d3d 2027 6361  e.lower() == 'ca
-000480b0: 7462 6f6f 7374 273a 0d0a 2020 2020 2020  tboost':..      
-000480c0: 2020 2320 2020 2070 7269 6e74 2827 4265    #    print('Be
-000480d0: 7374 204d 6f64 656c 2073 656c 6563 7465  st Model selecte
-000480e0: 6420 616e 6420 6974 7320 7061 7261 6d65  d and its parame
-000480f0: 7465 7273 2061 7265 3a5c 6e20 2020 2025  ters are:\n    %
-00048100: 7327 2025 6d6f 6465 6c2e 6765 745f 616c  s' %model.get_al
-00048110: 6c5f 7061 7261 6d73 2829 290d 0a20 2020  l_params())..   
-00048120: 2020 2020 2023 656c 7365 3a0d 0a20 2020       #else:..   
-00048130: 2020 2020 2023 2020 2020 7072 696e 7428       #    print(
-00048140: 2742 6573 7420 4d6f 6465 6c20 7365 6c65  'Best Model sele
-00048150: 6374 6564 2061 6e64 2069 7473 2061 7474  cted and its att
-00048160: 7269 6275 7465 7320 6172 653a 5c6e 2020  ributes are:\n  
-00048170: 2020 2573 2720 256d 6f64 656c 290d 0a20    %s' %model).. 
-00048180: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00048190: 2020 2323 2323 2323 2323 2049 6620 7468    ######## If th
-000481a0: 6973 2069 7320 6120 6d75 6c74 692d 6c61  is is a multi-la
-000481b0: 6265 6c20 6d6f 6465 6c2c 2074 7279 2074  bel model, try t
-000481c0: 6f20 7365 6520 6966 2069 7420 7765 6e74  o see if it went
-000481d0: 2074 6872 6f67 6820 4753 206f 7220 5253   throgh GS or RS
-000481e0: 2c20 6966 206e 6f74 2c20 7573 6520 6974  , if not, use it
-000481f0: 2061 7320 6973 0d0a 2020 2020 2020 2020   as is..        
-00048200: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-00048210: 2020 6773 203d 2063 6f70 792e 6465 6570    gs = copy.deep
-00048220: 636f 7079 286d 6f64 656c 290d 0a20 2020  copy(model)..   
-00048230: 2020 2020 2020 2020 206d 6f64 656c 203d           model =
-00048240: 2067 732e 6265 7374 5f65 7374 696d 6174   gs.best_estimat
-00048250: 6f72 5f0d 0a20 2020 2020 2020 2065 7863  or_..        exc
-00048260: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
-00048270: 2020 6773 203d 2063 6f70 792e 6465 6570    gs = copy.deep
-00048280: 636f 7079 286d 6f64 656c 290d 0a20 2020  copy(model)..   
-00048290: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-000482a0: 5573 696e 6720 2573 2720 2573 7472 286d  Using %s' %str(m
-000482b0: 6f64 656c 292e 7370 6c69 7428 2228 2229  odel).split("(")
-000482c0: 5b30 5d29 0d0a 2020 2020 2323 2323 2323  [0])..    ######
-000482d0: 2323 2323 2323 2323 2020 2054 6865 7365  ########   These
-000482e0: 2061 7265 2073 6574 7469 6e67 7320 666f   are settings fo
-000482f0: 7220 6d61 6b69 6e67 2073 7572 6520 7072  r making sure pr
-00048300: 6564 6963 7469 6f6e 7320 6173 2073 616d  edictions as sam
-00048310: 6520 7479 7065 2061 7320 7461 7267 6574  e type as target
-00048320: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-00048330: 230d 0a20 2020 2023 2323 204d 616b 6520  #..    ### Make 
-00048340: 7375 7265 2079 6f75 2073 6574 2074 6869  sure you set thi
-00048350: 7320 666c 6167 2061 7320 4661 6c73 6520  s flag as False 
-00048360: 736f 2074 6861 7420 7768 656e 2065 6e73  so that when ens
-00048370: 656d 626c 696e 6720 6973 2063 6f6d 706c  embling is compl
-00048380: 6574 6564 2c20 7468 6973 2066 6c61 6720  eted, this flag 
-00048390: 6973 2054 7275 6520 2323 0d0a 2020 2020  is True ##..    
-000483a0: 7065 7266 6f72 6d65 645f 656e 7365 6d62  performed_ensemb
-000483b0: 6c69 6e67 203d 2046 616c 7365 0d0a 2020  ling = False..  
-000483c0: 2020 6d6f 6469 6679 5f74 6172 6765 7473    modify_targets
-000483d0: 5f66 6c61 6720 3d20 4661 6c73 650d 0a20  _flag = False.. 
-000483e0: 2020 2069 6620 6d6f 6465 6c5f 6c61 6265     if model_labe
-000483f0: 6c20 3d3d 2027 5369 6e67 6c65 5f4c 6162  l == 'Single_Lab
-00048400: 656c 2720 616e 6420 6d6f 6465 6c74 7970  el' and modeltyp
-00048410: 6520 213d 2027 5265 6772 6573 7369 6f6e  e != 'Regression
-00048420: 273a 0d0a 2020 2020 2020 2020 2323 2323  ':..        ####
-00048430: 2323 2323 2323 2323 2020 2054 6869 7320  ########   This 
-00048440: 6973 2066 6f72 2053 696e 676c 6520 4c61  is for Single La
-00048450: 6265 6c20 436c 6173 7369 6669 6361 7469  bel Classificati
-00048460: 6f6e 2050 726f 626c 656d 7320 6f6e 6c79  on Problems only
-00048470: 2023 2323 2323 230d 0a20 2020 2020 2020   ######..       
-00048480: 206d 5f74 6872 6573 6820 3d20 302e 350d   m_thresh = 0.5.
-00048490: 0a20 2020 2020 2020 2079 5f70 726f 6261  .        y_proba
-000484a0: 203d 206d 6f64 656c 2e70 7265 6469 6374   = model.predict
-000484b0: 5f70 726f 6261 2858 5f63 7629 0d0a 2020  _proba(X_cv)..  
-000484c0: 2020 2020 2020 795f 7072 6564 203d 206d        y_pred = m
-000484d0: 6f64 656c 2e70 7265 6469 6374 2858 5f63  odel.predict(X_c
-000484e0: 7629 0d0a 2020 2020 2020 2020 6966 206c  v)..        if l
-000484f0: 656e 2863 6c61 7373 6573 2920 3c3d 2032  en(classes) <= 2
-00048500: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-00048510: 7269 6e74 2827 4669 6e64 696e 6720 4265  rint('Finding Be
-00048520: 7374 2054 6872 6573 686f 6c64 2066 6f72  st Threshold for
-00048530: 2048 6967 6865 7374 2046 3120 5363 6f72   Highest F1 Scor
-00048540: 652e 2e2e 2729 0d0a 2020 2020 2020 2020  e...')..        
-00048550: 2020 2020 7072 6563 6973 696f 6e2c 2072      precision, r
-00048560: 6563 616c 6c2c 2074 6872 6573 686f 6c64  ecall, threshold
-00048570: 7320 3d20 7072 6563 6973 696f 6e5f 7265  s = precision_re
-00048580: 6361 6c6c 5f63 7572 7665 2879 5f63 762c  call_curve(y_cv,
-00048590: 2079 5f70 726f 6261 5b3a 2c72 6172 655f   y_proba[:,rare_
-000485a0: 636c 6173 735d 290d 0a20 2020 2020 2020  class])..       
-000485b0: 2020 2020 2023 7072 6563 6973 696f 6e2c       #precision,
-000485c0: 2072 6563 616c 6c2c 2074 6872 6573 686f   recall, thresho
-000485d0: 6c64 7320 3d20 7072 6563 6973 696f 6e5f  lds = precision_
-000485e0: 7265 6361 6c6c 5f63 7572 7665 2879 5f63  recall_curve(y_c
-000485f0: 762c 2079 5f70 726f 6261 5b3a 2c31 5d29  v, y_proba[:,1])
-00048600: 0d0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
-00048610: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
-00048620: 2020 2020 6631 203d 2028 322a 7072 6563      f1 = (2*prec
-00048630: 6973 696f 6e2a 7265 6361 6c6c 292f 2870  ision*recall)/(p
-00048640: 7265 6369 7369 6f6e 2b72 6563 616c 6c29  recision+recall)
-00048650: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00048660: 2020 6631 203d 206e 702e 6e61 6e5f 746f    f1 = np.nan_to
-00048670: 5f6e 756d 2866 3129 0d0a 2020 2020 2020  _num(f1)..      
-00048680: 2020 2020 2020 2020 2020 6d5f 6964 7820            m_idx 
-00048690: 3d20 6e70 2e61 7267 6d61 7828 6631 290d  = np.argmax(f1).
-000486a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000486b0: 206d 5f74 6872 6573 6820 3d20 7468 7265   m_thresh = thre
-000486c0: 7368 6f6c 6473 5b6d 5f69 6478 5d0d 0a20  sholds[m_idx].. 
-000486d0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-000486e0: 6573 745f 6631 203d 2066 315b 6d5f 6964  est_f1 = f1[m_id
-000486f0: 785d 0d0a 2020 2020 2020 2020 2020 2020  x]..            
-00048700: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
-00048710: 2020 2020 2020 2020 2062 6573 745f 6631           best_f1
-00048720: 203d 2066 315f 7363 6f72 6528 795f 6376   = f1_score(y_cv
-00048730: 2c20 795f 7072 6564 290d 0a20 2020 2020  , y_pred)..     
-00048740: 2020 2020 2020 2020 2020 206d 5f74 6872             m_thr
-00048750: 6573 6820 3d20 302e 350d 0a20 2020 2020  esh = 0.5..     
-00048760: 2020 2020 2020 2023 2072 6574 7269 6576         # retriev
-00048770: 6520 6a75 7374 2074 6865 2070 726f 6261  e just the proba
-00048780: 6269 6c69 7469 6573 2066 6f72 2074 6865  bilities for the
-00048790: 2070 6f73 6974 6976 6520 636c 6173 730d   positive class.
-000487a0: 0a20 2020 2020 2020 2020 2020 2070 6f73  .            pos
-000487b0: 5f70 726f 6273 203d 2079 5f70 726f 6261  _probs = y_proba
-000487c0: 5b3a 2c20 7261 7265 5f63 6c61 7373 5d0d  [:, rare_class].
-000487d0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000487e0: 7665 7262 6f73 6520 3e3d 2031 3a0d 0a20  verbose >= 1:.. 
-000487f0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00048800: 2063 7265 6174 6520 6120 6869 7374 6f67   create a histog
-00048810: 7261 6d20 6f66 2074 6865 2070 7265 6469  ram of the predi
-00048820: 6374 6564 2070 726f 6261 6269 6c69 7469  cted probabiliti
-00048830: 6573 2066 6f72 2074 6865 2052 6172 6520  es for the Rare 
-00048840: 436c 6173 7320 7369 6e63 6520 6974 2077  Class since it w
-00048850: 696c 6c20 6865 6c70 2064 6563 6964 6520  ill help decide 
-00048860: 7468 7265 7368 6f6c 640d 0a20 2020 2020  threshold..     
-00048870: 2020 2020 2020 2020 2020 2070 6c74 2e66             plt.f
-00048880: 6967 7572 6528 6669 6773 697a 653d 2836  igure(figsize=(6
-00048890: 2c36 2929 0d0a 2020 2020 2020 2020 2020  ,6))..          
-000488a0: 2020 2020 2020 706c 742e 6869 7374 2870        plt.hist(p
-000488b0: 6f73 5f70 726f 6273 2c20 6269 6e73 3d42  os_probs, bins=B
-000488c0: 696e 732c 2063 6f6c 6f72 3d27 6727 290d  ins, color='g').
-000488d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000488e0: 2070 6c74 2e74 6974 6c65 2822 4d6f 6465   plt.title("Mode
-000488f0: 6c27 7320 5072 6564 6963 7469 7665 2050  l's Predictive P
-00048900: 726f 6261 6269 6c69 7479 2048 6973 746f  robability Histo
-00048910: 6772 616d 2066 6f72 2052 6172 6520 436c  gram for Rare Cl
-00048920: 6173 733d 2573 2077 6974 6820 7375 6767  ass=%s with sugg
-00048930: 6573 7465 6420 7468 7265 7368 6f6c 6420  ested threshold 
-00048940: 696e 2072 6564 2220 2572 6172 655f 636c  in red" %rare_cl
-00048950: 6173 735f 6f72 6967 290d 0a20 2020 2020  ass_orig)..     
-00048960: 2020 2020 2020 2020 2020 2070 6c74 2e61             plt.a
-00048970: 7876 6c69 6e65 2878 3d6d 5f74 6872 6573  xvline(x=m_thres
-00048980: 682c 2063 6f6c 6f72 3d27 7227 2c20 6c69  h, color='r', li
-00048990: 6e65 7374 796c 653d 272d 2d27 290d 0a20  nestyle='--').. 
-000489a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000489b0: 6c74 2e73 686f 7728 293b 0d0a 2020 2020  lt.show();..    
-000489c0: 2020 2020 2020 2020 7072 696e 7428 2220          print(" 
-000489d0: 2020 2055 7369 6e67 2074 6872 6573 686f     Using thresho
-000489e0: 6c64 3d30 2e35 2e20 486f 7765 7665 722c  ld=0.5. However,
-000489f0: 2025 302e 3366 2070 726f 7669 6465 7320   %0.3f provides 
-00048a00: 6265 7474 6572 2046 313d 2530 2e32 6620  better F1=%0.2f 
-00048a10: 666f 7220 7261 7265 2063 6c61 7373 2e2e  for rare class..
-00048a20: 2e22 2025 286d 5f74 6872 6573 682c 6265  ." %(m_thresh,be
-00048a30: 7374 5f66 3129 290d 0a20 2020 2020 2020  st_f1))..       
-00048a40: 2020 2020 2023 2323 795f 7072 6564 203d       ###y_pred =
-00048a50: 2028 795f 7072 6f62 615b 3a2c 7261 7265   (y_proba[:,rare
-00048a60: 5f63 6c61 7373 5d3e 3d6d 5f74 6872 6573  _class]>=m_thres
-00048a70: 6829 2e61 7374 7970 6528 696e 7429 0d0a  h).astype(int)..
-00048a80: 2020 2020 2020 2020 2020 2020 7072 6564              pred
-00048a90: 6963 7465 6420 3d20 636f 7079 2e64 6565  icted = copy.dee
-00048aa0: 7063 6f70 7928 795f 7072 6f62 6129 0d0a  pcopy(y_proba)..
-00048ab0: 2020 2020 2020 2020 2020 2020 7072 6564              pred
-00048ac0: 6963 7465 6420 5b3a 2c30 5d20 3d20 2870  icted [:,0] = (p
-00048ad0: 7265 6469 6374 6564 205b 3a2c 305d 203e  redicted [:,0] >
-00048ae0: 3d20 2831 2d6d 5f74 6872 6573 6829 292e  = (1-m_thresh)).
-00048af0: 6173 7479 7065 2827 696e 7427 290d 0a20  astype('int').. 
-00048b00: 2020 2020 2020 2020 2020 2070 7265 6469             predi
-00048b10: 6374 6564 205b 3a2c 315d 203d 2028 7072  cted [:,1] = (pr
-00048b20: 6564 6963 7465 6420 5b3a 2c31 5d20 3e20  edicted [:,1] > 
-00048b30: 6d5f 7468 7265 7368 292e 6173 7479 7065  m_thresh).astype
-00048b40: 2827 696e 7427 290d 0a20 2020 2020 2020  ('int')..       
-00048b50: 2020 2020 2069 6620 6d5f 7468 7265 7368       if m_thresh
-00048b60: 2021 3d20 302e 353a 0d0a 2020 2020 2020   != 0.5:..      
-00048b70: 2020 2020 2020 2020 2020 795f 7072 6564            y_pred
-00048b80: 203d 2070 7265 6469 6374 6564 5b3a 2c72   = predicted[:,r
-00048b90: 6172 655f 636c 6173 735d 0d0a 2020 2020  are_class]..    
-00048ba0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00048bb0: 2020 2020 2020 2023 2323 2320 5468 6973         #### This
-00048bc0: 2069 7320 7768 6572 6520 796f 7520 7072   is where you pr
-00048bd0: 6564 6963 7420 666f 7220 4d75 6c74 692d  edict for Multi-
-00048be0: 636c 6173 7320 636c 6173 7369 6669 6361  class classifica
-00048bf0: 7469 6f6e 206d 6f64 656c 7320 2323 2323  tion models ####
-00048c00: 230d 0a20 2020 2020 2020 2020 2020 2079  #..            y
-00048c10: 5f70 7265 6420 3d20 6d6f 6465 6c2e 7072  _pred = model.pr
-00048c20: 6564 6963 7428 585f 6376 290d 0a20 2020  edict(X_cv)..   
-00048c30: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00048c40: 2323 2323 2054 6869 7320 6973 2077 6865  #### This is whe
-00048c50: 7265 2079 6f75 2070 7265 6469 6374 2066  re you predict f
-00048c60: 6f72 204d 756c 7469 2d4f 7574 7075 7420  or Multi-Output 
-00048c70: 4d75 6c74 692d 4c61 6265 6c20 6d6f 6465  Multi-Label mode
-00048c80: 6c73 2023 2323 2323 0d0a 2020 2020 2020  ls #####..      
-00048c90: 2020 795f 7072 6564 203d 206d 6f64 656c    y_pred = model
-00048ca0: 2e70 7265 6469 6374 2858 5f63 7629 0d0a  .predict(X_cv)..
-00048cb0: 2020 2020 2323 2320 2020 5468 6973 2069      ###   This i
-00048cc0: 7320 7768 6572 6520 796f 7520 7072 696e  s where you prin
-00048cd0: 7420 6f75 7420 7468 6520 4669 7273 7420  t out the First 
-00048ce0: 4d6f 6465 6c27 7320 5265 7375 6c74 7320  Model's Results 
-00048cf0: 2323 2323 2323 2323 0d0a 2020 2020 7072  ########..    pr
-00048d00: 696e 7428 2723 2323 2323 2323 2323 2323  int('###########
+00048060: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+00048070: 656c 5f6c 6162 656c 2c6d 6f64 656c 7479  el_label,modelty
+00048080: 7065 2929 0d0a 2020 2020 2020 2020 2369  pe))..        #i
+00048090: 6620 6d6f 6465 6c5f 6e61 6d65 2e6c 6f77  f model_name.low
+000480a0: 6572 2829 203d 3d20 2763 6174 626f 6f73  er() == 'catboos
+000480b0: 7427 3a0d 0a20 2020 2020 2020 2023 2020  t':..        #  
+000480c0: 2020 7072 696e 7428 2742 6573 7420 4d6f    print('Best Mo
+000480d0: 6465 6c20 7365 6c65 6374 6564 2061 6e64  del selected and
+000480e0: 2069 7473 2070 6172 616d 6574 6572 7320   its parameters 
+000480f0: 6172 653a 5c6e 2020 2020 2573 2720 256d  are:\n    %s' %m
+00048100: 6f64 656c 2e67 6574 5f61 6c6c 5f70 6172  odel.get_all_par
+00048110: 616d 7328 2929 0d0a 2020 2020 2020 2020  ams())..        
+00048120: 2365 6c73 653a 0d0a 2020 2020 2020 2020  #else:..        
+00048130: 2320 2020 2070 7269 6e74 2827 4265 7374  #    print('Best
+00048140: 204d 6f64 656c 2073 656c 6563 7465 6420   Model selected 
+00048150: 616e 6420 6974 7320 6174 7472 6962 7574  and its attribut
+00048160: 6573 2061 7265 3a5c 6e20 2020 2025 7327  es are:\n    %s'
+00048170: 2025 6d6f 6465 6c29 0d0a 2020 2020 656c   %model)..    el
+00048180: 7365 3a0d 0a20 2020 2020 2020 2023 2323  se:..        ###
+00048190: 2323 2323 2320 4966 2074 6869 7320 6973  ##### If this is
+000481a0: 2061 206d 756c 7469 2d6c 6162 656c 206d   a multi-label m
+000481b0: 6f64 656c 2c20 7472 7920 746f 2073 6565  odel, try to see
+000481c0: 2069 6620 6974 2077 656e 7420 7468 726f   if it went thro
+000481d0: 6768 2047 5320 6f72 2052 532c 2069 6620  gh GS or RS, if 
+000481e0: 6e6f 742c 2075 7365 2069 7420 6173 2069  not, use it as i
+000481f0: 730d 0a20 2020 2020 2020 2074 7279 3a0d  s..        try:.
+00048200: 0a20 2020 2020 2020 2020 2020 2067 7320  .            gs 
+00048210: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+00048220: 6d6f 6465 6c29 0d0a 2020 2020 2020 2020  model)..        
+00048230: 2020 2020 6d6f 6465 6c20 3d20 6773 2e62      model = gs.b
+00048240: 6573 745f 6573 7469 6d61 746f 725f 0d0a  est_estimator_..
+00048250: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
+00048260: 0a20 2020 2020 2020 2020 2020 2067 7320  .            gs 
+00048270: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+00048280: 6d6f 6465 6c29 0d0a 2020 2020 2020 2020  model)..        
+00048290: 7072 696e 7428 2720 2020 2055 7369 6e67  print('    Using
+000482a0: 2025 7327 2025 7374 7228 6d6f 6465 6c29   %s' %str(model)
+000482b0: 2e73 706c 6974 2822 2822 295b 305d 290d  .split("(")[0]).
+000482c0: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
+000482d0: 2323 2320 2020 5468 6573 6520 6172 6520  ###   These are 
+000482e0: 7365 7474 696e 6773 2066 6f72 206d 616b  settings for mak
+000482f0: 696e 6720 7375 7265 2070 7265 6469 6374  ing sure predict
+00048300: 696f 6e73 2061 7320 7361 6d65 2074 7970  ions as same typ
+00048310: 6520 6173 2074 6172 6765 7420 2323 2323  e as target ####
+00048320: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
+00048330: 2020 2323 2320 4d61 6b65 2073 7572 6520    ### Make sure 
+00048340: 796f 7520 7365 7420 7468 6973 2066 6c61  you set this fla
+00048350: 6720 6173 2046 616c 7365 2073 6f20 7468  g as False so th
+00048360: 6174 2077 6865 6e20 656e 7365 6d62 6c69  at when ensembli
+00048370: 6e67 2069 7320 636f 6d70 6c65 7465 642c  ng is completed,
+00048380: 2074 6869 7320 666c 6167 2069 7320 5472   this flag is Tr
+00048390: 7565 2023 230d 0a20 2020 2070 6572 666f  ue ##..    perfo
+000483a0: 726d 6564 5f65 6e73 656d 626c 696e 6720  rmed_ensembling 
+000483b0: 3d20 4661 6c73 650d 0a20 2020 206d 6f64  = False..    mod
+000483c0: 6966 795f 7461 7267 6574 735f 666c 6167  ify_targets_flag
+000483d0: 203d 2046 616c 7365 0d0a 2020 2020 6966   = False..    if
+000483e0: 206d 6f64 656c 5f6c 6162 656c 203d 3d20   model_label == 
+000483f0: 2753 696e 676c 655f 4c61 6265 6c27 2061  'Single_Label' a
+00048400: 6e64 206d 6f64 656c 7479 7065 2021 3d20  nd modeltype != 
+00048410: 2752 6567 7265 7373 696f 6e27 3a0d 0a20  'Regression':.. 
+00048420: 2020 2020 2020 2023 2323 2323 2323 2323         #########
+00048430: 2323 2320 2020 5468 6973 2069 7320 666f  ###   This is fo
+00048440: 7220 5369 6e67 6c65 204c 6162 656c 2043  r Single Label C
+00048450: 6c61 7373 6966 6963 6174 696f 6e20 5072  lassification Pr
+00048460: 6f62 6c65 6d73 206f 6e6c 7920 2323 2323  oblems only ####
+00048470: 2323 0d0a 2020 2020 2020 2020 6d5f 7468  ##..        m_th
+00048480: 7265 7368 203d 2030 2e35 0d0a 2020 2020  resh = 0.5..    
+00048490: 2020 2020 795f 7072 6f62 6120 3d20 6d6f      y_proba = mo
+000484a0: 6465 6c2e 7072 6564 6963 745f 7072 6f62  del.predict_prob
+000484b0: 6128 585f 6376 290d 0a20 2020 2020 2020  a(X_cv)..       
+000484c0: 2079 5f70 7265 6420 3d20 6d6f 6465 6c2e   y_pred = model.
+000484d0: 7072 6564 6963 7428 585f 6376 290d 0a20  predict(X_cv).. 
+000484e0: 2020 2020 2020 2069 6620 6c65 6e28 636c         if len(cl
+000484f0: 6173 7365 7329 203c 3d20 323a 0d0a 2020  asses) <= 2:..  
+00048500: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00048510: 2746 696e 6469 6e67 2042 6573 7420 5468  'Finding Best Th
+00048520: 7265 7368 6f6c 6420 666f 7220 4869 6768  reshold for High
+00048530: 6573 7420 4631 2053 636f 7265 2e2e 2e27  est F1 Score...'
+00048540: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
+00048550: 7265 6369 7369 6f6e 2c20 7265 6361 6c6c  recision, recall
+00048560: 2c20 7468 7265 7368 6f6c 6473 203d 2070  , thresholds = p
+00048570: 7265 6369 7369 6f6e 5f72 6563 616c 6c5f  recision_recall_
+00048580: 6375 7276 6528 795f 6376 2c20 795f 7072  curve(y_cv, y_pr
+00048590: 6f62 615b 3a2c 7261 7265 5f63 6c61 7373  oba[:,rare_class
+000485a0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+000485b0: 2370 7265 6369 7369 6f6e 2c20 7265 6361  #precision, reca
+000485c0: 6c6c 2c20 7468 7265 7368 6f6c 6473 203d  ll, thresholds =
+000485d0: 2070 7265 6369 7369 6f6e 5f72 6563 616c   precision_recal
+000485e0: 6c5f 6375 7276 6528 795f 6376 2c20 795f  l_curve(y_cv, y_
+000485f0: 7072 6f62 615b 3a2c 315d 290d 0a20 2020  proba[:,1])..   
+00048600: 2020 2020 2020 2020 2074 7279 3a0d 0a20           try:.. 
+00048610: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00048620: 3120 3d20 2832 2a70 7265 6369 7369 6f6e  1 = (2*precision
+00048630: 2a72 6563 616c 6c29 2f28 7072 6563 6973  *recall)/(precis
+00048640: 696f 6e2b 7265 6361 6c6c 290d 0a20 2020  ion+recall)..   
+00048650: 2020 2020 2020 2020 2020 2020 2066 3120               f1 
+00048660: 3d20 6e70 2e6e 616e 5f74 6f5f 6e75 6d28  = np.nan_to_num(
+00048670: 6631 290d 0a20 2020 2020 2020 2020 2020  f1)..           
+00048680: 2020 2020 206d 5f69 6478 203d 206e 702e       m_idx = np.
+00048690: 6172 676d 6178 2866 3129 0d0a 2020 2020  argmax(f1)..    
+000486a0: 2020 2020 2020 2020 2020 2020 6d5f 7468              m_th
+000486b0: 7265 7368 203d 2074 6872 6573 686f 6c64  resh = threshold
+000486c0: 735b 6d5f 6964 785d 0d0a 2020 2020 2020  s[m_idx]..      
+000486d0: 2020 2020 2020 2020 2020 6265 7374 5f66            best_f
+000486e0: 3120 3d20 6631 5b6d 5f69 6478 5d0d 0a20  1 = f1[m_idx].. 
+000486f0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+00048700: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
+00048710: 2020 2020 6265 7374 5f66 3120 3d20 6631      best_f1 = f1
+00048720: 5f73 636f 7265 2879 5f63 762c 2079 5f70  _score(y_cv, y_p
+00048730: 7265 6429 0d0a 2020 2020 2020 2020 2020  red)..          
+00048740: 2020 2020 2020 6d5f 7468 7265 7368 203d        m_thresh =
+00048750: 2030 2e35 0d0a 2020 2020 2020 2020 2020   0.5..          
+00048760: 2020 2320 7265 7472 6965 7665 206a 7573    # retrieve jus
+00048770: 7420 7468 6520 7072 6f62 6162 696c 6974  t the probabilit
+00048780: 6965 7320 666f 7220 7468 6520 706f 7369  ies for the posi
+00048790: 7469 7665 2063 6c61 7373 0d0a 2020 2020  tive class..    
+000487a0: 2020 2020 2020 2020 706f 735f 7072 6f62          pos_prob
+000487b0: 7320 3d20 795f 7072 6f62 615b 3a2c 2072  s = y_proba[:, r
+000487c0: 6172 655f 636c 6173 735d 0d0a 2020 2020  are_class]..    
+000487d0: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
+000487e0: 7365 203e 3d20 313a 0d0a 2020 2020 2020  se >= 1:..      
+000487f0: 2020 2020 2020 2020 2020 2320 6372 6561            # crea
+00048800: 7465 2061 2068 6973 746f 6772 616d 206f  te a histogram o
+00048810: 6620 7468 6520 7072 6564 6963 7465 6420  f the predicted 
+00048820: 7072 6f62 6162 696c 6974 6965 7320 666f  probabilities fo
+00048830: 7220 7468 6520 5261 7265 2043 6c61 7373  r the Rare Class
+00048840: 2073 696e 6365 2069 7420 7769 6c6c 2068   since it will h
+00048850: 656c 7020 6465 6369 6465 2074 6872 6573  elp decide thres
+00048860: 686f 6c64 0d0a 2020 2020 2020 2020 2020  hold..          
+00048870: 2020 2020 2020 706c 742e 6669 6775 7265        plt.figure
+00048880: 2866 6967 7369 7a65 3d28 362c 3629 290d  (figsize=(6,6)).
+00048890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000488a0: 2070 6c74 2e68 6973 7428 706f 735f 7072   plt.hist(pos_pr
+000488b0: 6f62 732c 2062 696e 733d 4269 6e73 2c20  obs, bins=Bins, 
+000488c0: 636f 6c6f 723d 2767 2729 0d0a 2020 2020  color='g')..    
+000488d0: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
+000488e0: 7469 746c 6528 224d 6f64 656c 2773 2050  title("Model's P
+000488f0: 7265 6469 6374 6976 6520 5072 6f62 6162  redictive Probab
+00048900: 696c 6974 7920 4869 7374 6f67 7261 6d20  ility Histogram 
+00048910: 666f 7220 5261 7265 2043 6c61 7373 3d25  for Rare Class=%
+00048920: 7320 7769 7468 2073 7567 6765 7374 6564  s with suggested
+00048930: 2074 6872 6573 686f 6c64 2069 6e20 7265   threshold in re
+00048940: 6422 2025 7261 7265 5f63 6c61 7373 5f6f  d" %rare_class_o
+00048950: 7269 6729 0d0a 2020 2020 2020 2020 2020  rig)..          
+00048960: 2020 2020 2020 706c 742e 6178 766c 696e        plt.axvlin
+00048970: 6528 783d 6d5f 7468 7265 7368 2c20 636f  e(x=m_thresh, co
+00048980: 6c6f 723d 2772 272c 206c 696e 6573 7479  lor='r', linesty
+00048990: 6c65 3d27 2d2d 2729 0d0a 2020 2020 2020  le='--')..      
+000489a0: 2020 2020 2020 2020 2020 706c 742e 7368            plt.sh
+000489b0: 6f77 2829 3b0d 0a20 2020 2020 2020 2020  ow();..         
+000489c0: 2020 2070 7269 6e74 2822 2020 2020 5573     print("    Us
+000489d0: 696e 6720 7468 7265 7368 6f6c 643d 302e  ing threshold=0.
+000489e0: 352e 2048 6f77 6576 6572 2c20 2530 2e33  5. However, %0.3
+000489f0: 6620 7072 6f76 6964 6573 2062 6574 7465  f provides bette
+00048a00: 7220 4631 3d25 302e 3266 2066 6f72 2072  r F1=%0.2f for r
+00048a10: 6172 6520 636c 6173 732e 2e2e 2220 2528  are class..." %(
+00048a20: 6d5f 7468 7265 7368 2c62 6573 745f 6631  m_thresh,best_f1
+00048a30: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00048a40: 2323 2379 5f70 7265 6420 3d20 2879 5f70  ###y_pred = (y_p
+00048a50: 726f 6261 5b3a 2c72 6172 655f 636c 6173  roba[:,rare_clas
+00048a60: 735d 3e3d 6d5f 7468 7265 7368 292e 6173  s]>=m_thresh).as
+00048a70: 7479 7065 2869 6e74 290d 0a20 2020 2020  type(int)..     
+00048a80: 2020 2020 2020 2070 7265 6469 6374 6564         predicted
+00048a90: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
+00048aa0: 2879 5f70 726f 6261 290d 0a20 2020 2020  (y_proba)..     
+00048ab0: 2020 2020 2020 2070 7265 6469 6374 6564         predicted
+00048ac0: 205b 3a2c 305d 203d 2028 7072 6564 6963   [:,0] = (predic
+00048ad0: 7465 6420 5b3a 2c30 5d20 3e3d 2028 312d  ted [:,0] >= (1-
+00048ae0: 6d5f 7468 7265 7368 2929 2e61 7374 7970  m_thresh)).astyp
+00048af0: 6528 2769 6e74 2729 0d0a 2020 2020 2020  e('int')..      
+00048b00: 2020 2020 2020 7072 6564 6963 7465 6420        predicted 
+00048b10: 5b3a 2c31 5d20 3d20 2870 7265 6469 6374  [:,1] = (predict
+00048b20: 6564 205b 3a2c 315d 203e 206d 5f74 6872  ed [:,1] > m_thr
+00048b30: 6573 6829 2e61 7374 7970 6528 2769 6e74  esh).astype('int
+00048b40: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+00048b50: 6966 206d 5f74 6872 6573 6820 213d 2030  if m_thresh != 0
+00048b60: 2e35 3a0d 0a20 2020 2020 2020 2020 2020  .5:..           
+00048b70: 2020 2020 2079 5f70 7265 6420 3d20 7072       y_pred = pr
+00048b80: 6564 6963 7465 645b 3a2c 7261 7265 5f63  edicted[:,rare_c
+00048b90: 6c61 7373 5d0d 0a20 2020 2020 2020 2065  lass]..        e
+00048ba0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00048bb0: 2020 2323 2323 2054 6869 7320 6973 2077    #### This is w
+00048bc0: 6865 7265 2079 6f75 2070 7265 6469 6374  here you predict
+00048bd0: 2066 6f72 204d 756c 7469 2d63 6c61 7373   for Multi-class
+00048be0: 2063 6c61 7373 6966 6963 6174 696f 6e20   classification 
+00048bf0: 6d6f 6465 6c73 2023 2323 2323 0d0a 2020  models #####..  
+00048c00: 2020 2020 2020 2020 2020 795f 7072 6564            y_pred
+00048c10: 203d 206d 6f64 656c 2e70 7265 6469 6374   = model.predict
+00048c20: 2858 5f63 7629 0d0a 2020 2020 656c 7365  (X_cv)..    else
+00048c30: 3a0d 0a20 2020 2020 2020 2023 2323 2320  :..        #### 
+00048c40: 5468 6973 2069 7320 7768 6572 6520 796f  This is where yo
+00048c50: 7520 7072 6564 6963 7420 666f 7220 4d75  u predict for Mu
+00048c60: 6c74 692d 4f75 7470 7574 204d 756c 7469  lti-Output Multi
+00048c70: 2d4c 6162 656c 206d 6f64 656c 7320 2323  -Label models ##
+00048c80: 2323 230d 0a20 2020 2020 2020 2079 5f70  ###..        y_p
+00048c90: 7265 6420 3d20 6d6f 6465 6c2e 7072 6564  red = model.pred
+00048ca0: 6963 7428 585f 6376 290d 0a20 2020 2023  ict(X_cv)..    #
+00048cb0: 2323 2020 2054 6869 7320 6973 2077 6865  ##   This is whe
+00048cc0: 7265 2079 6f75 2070 7269 6e74 206f 7574  re you print out
+00048cd0: 2074 6865 2046 6972 7374 204d 6f64 656c   the First Model
+00048ce0: 2773 2052 6573 756c 7473 2023 2323 2323  's Results #####
+00048cf0: 2323 230d 0a20 2020 2070 7269 6e74 2827  ###..    print('
+00048d00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00048d10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00048d20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00048d30: 2323 2323 2323 2323 2323 2323 2327 290d  #############').
-00048d40: 0a20 2020 2023 2323 2323 2054 6869 7320  .    ##### This 
-00048d50: 6e65 7874 2073 7465 7020 6973 2076 6572  next step is ver
-00048d60: 7920 696d 706f 7274 616e 7420 7369 6e63  y important sinc
-00048d70: 6520 736f 6d65 206d 6f64 656c 7320 6769  e some models gi
-00048d80: 7665 2073 6572 6965 732c 206f 7468 6572  ve series, other
-00048d90: 7320 6769 7665 2061 7272 6179 732e 2056  s give arrays. V
-00048da0: 6572 7920 7061 696e 6675 6c21 0d0a 2020  ery painful!..  
-00048db0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00048dc0: 795f 7072 6564 2c70 642e 5365 7269 6573  y_pred,pd.Series
-00048dd0: 2920 6f72 2069 7369 6e73 7461 6e63 6528  ) or isinstance(
-00048de0: 795f 7072 6564 2c70 642e 4461 7461 4672  y_pred,pd.DataFr
-00048df0: 616d 6529 3a0d 0a20 2020 2020 2020 2079  ame):..        y
-00048e00: 5f70 7265 6420 3d20 795f 7072 6564 2e76  _pred = y_pred.v
-00048e10: 616c 7565 730d 0a20 2020 2069 6620 6973  alues..    if is
-00048e20: 696e 7374 616e 6365 2879 5f63 762c 7064  instance(y_cv,pd
-00048e30: 2e53 6572 6965 7329 206f 7220 6973 696e  .Series) or isin
-00048e40: 7374 616e 6365 2879 5f63 762c 7064 2e44  stance(y_cv,pd.D
-00048e50: 6174 6146 7261 6d65 293a 0d0a 2020 2020  ataFrame):..    
-00048e60: 2020 2020 795f 6376 203d 2079 5f63 762e      y_cv = y_cv.
-00048e70: 7661 6c75 6573 0d0a 2020 2020 7072 696e  values..    prin
-00048e80: 7428 2725 7320 4d6f 6465 6c20 5072 6564  t('%s Model Pred
-00048e90: 6963 7469 6f6e 2052 6573 756c 7473 206f  iction Results o
-00048ea0: 6e20 4865 6c64 204f 7574 2043 5620 4461  n Held Out CV Da
-00048eb0: 7461 2053 6574 3a27 2025 6d6f 6465 6c5f  ta Set:' %model_
-00048ec0: 6e61 6d65 290d 0a20 2020 2023 2323 2323  name)..    #####
-00048ed0: 2320 4d61 6b65 2073 7572 6520 7468 6174  # Make sure that
-00048ee0: 2079 6f75 2063 6861 6e67 6520 7468 6520   you change the 
-00048ef0: 6d6f 6465 6c27 7320 7072 6564 6963 7469  model's predicti
-00048f00: 6f6e 7320 746f 2062 6520 7468 6520 7361  ons to be the sa
-00048f10: 6d65 2074 7970 6520 6173 206f 7269 6769  me type as origi
-00048f20: 6e61 6c20 7461 7267 6574 2023 2323 230d  nal target ####.
-00048f30: 0a20 2020 2069 6e74 5f74 7970 6573 203d  .    int_types =
-00048f40: 205b 6e70 2e69 6e74 382c 206e 702e 696e   [np.int8, np.in
-00048f50: 7431 362c 206e 702e 696e 7433 322c 206e  t16, np.int32, n
-00048f60: 702e 696e 7436 345d 0d0a 2020 2020 7461  p.int64]..    ta
-00048f70: 7267 6574 735f 6e65 6761 7469 7665 5f66  rgets_negative_f
-00048f80: 6c61 6720 3d20 6c65 6e28 795f 6376 3c30  lag = len(y_cv<0
-00048f90: 2920 3d3d 2030 0d0a 2020 2020 6966 2079  ) == 0..    if y
-00048fa0: 5f63 762e 6474 7970 6520 696e 2069 6e74  _cv.dtype in int
-00048fb0: 5f74 7970 6573 3a0d 0a20 2020 2020 2020  _types:..       
-00048fc0: 2079 5f70 7265 6420 3d20 6d6f 6469 6679   y_pred = modify
-00048fd0: 5f61 7272 6179 5f74 6f5f 696e 7465 6765  _array_to_intege
-00048fe0: 7228 795f 7072 6564 2c20 7461 7267 6574  r(y_pred, target
-00048ff0: 735f 6e65 6761 7469 7665 5f66 6c61 6729  s_negative_flag)
-00049000: 0d0a 2020 2020 2020 2020 6d6f 6469 6679  ..        modify
-00049010: 5f74 6172 6765 7473 5f66 6c61 6720 3d20  _targets_flag = 
-00049020: 5472 7565 0d0a 2020 2020 2323 2323 2323  True..    ######
-00049030: 2323 2323 2323 2320 2020 204e 204f 2057  #######    N O W
-00049040: 2020 2050 2052 2049 204e 2054 2020 2041     P R I N T   A
-00049050: 204c 204c 2020 5220 4520 5320 5520 4c20   L L  R E S U L 
-00049060: 5420 5320 2323 2323 2323 2323 2323 2323  T S ############
-00049070: 2323 2323 2323 2323 0d0a 2020 2020 6966  ########..    if
-00049080: 206d 6f64 656c 5f6c 6162 656c 203d 3d20   model_label == 
-00049090: 2753 696e 676c 655f 4c61 6265 6c27 3a0d  'Single_Label':.
-000490a0: 0a20 2020 2020 2020 2069 6620 6d6f 6465  .        if mode
-000490b0: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
-000490c0: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
-000490d0: 2020 2020 726d 736c 655f 6361 6c63 756c      rmsle_calcul
-000490e0: 6174 6564 5f6d 203d 2072 6d73 6528 795f  ated_m = rmse(y_
-000490f0: 6376 2c20 795f 7072 6564 290d 0a20 2020  cv, y_pred)..   
-00049100: 2020 2020 2020 2020 2070 7269 6e74 5f72           print_r
-00049110: 6567 7265 7373 696f 6e5f 6d6f 6465 6c5f  egression_model_
-00049120: 7374 6174 7328 795f 6376 2c20 795f 7072  stats(y_cv, y_pr
-00049130: 6564 2c74 6172 6765 742c 706c 6f74 5f6e  ed,target,plot_n
-00049140: 616d 653d 6d6f 6465 6c5f 6e61 6d65 290d  ame=model_name).
-00049150: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00049160: 2020 2020 2020 2020 2020 2020 6966 206d              if m
-00049170: 6f64 656c 5f6e 616d 6520 3d3d 2027 466f  odel_name == 'Fo
-00049180: 7265 7374 7327 3a0d 0a20 2020 2020 2020  rests':..       
-00049190: 2020 2020 2020 2020 2069 6620 6361 6c69           if cali
-000491a0: 6272 6174 6f72 5f66 6c61 673a 0d0a 2020  brator_flag:..  
-000491b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000491c0: 2020 7072 696e 7428 2720 2020 204f 4f42    print('    OOB
-000491d0: 2053 636f 7265 203d 2025 302e 3366 2720   Score = %0.3f' 
-000491e0: 256d 6f64 656c 2e62 6173 655f 6573 7469  %model.base_esti
-000491f0: 6d61 746f 722e 6f6f 625f 7363 6f72 655f  mator.oob_score_
-00049200: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00049210: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00049220: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00049230: 696e 7428 2720 2020 204f 4f42 2053 636f  int('    OOB Sco
-00049240: 7265 203d 2025 302e 3366 2720 256d 6f64  re = %0.3f' %mod
-00049250: 656c 2e6f 6f62 5f73 636f 7265 5f29 0d0a  el.oob_score_)..
-00049260: 2020 2020 2020 2020 2020 2020 726d 736c              rmsl
-00049270: 655f 6361 6c63 756c 6174 6564 5f6d 203d  e_calculated_m =
-00049280: 2062 616c 616e 6365 645f 6163 6375 7261   balanced_accura
-00049290: 6379 5f73 636f 7265 2879 5f63 762c 795f  cy_score(y_cv,y_
-000492a0: 7072 6564 290d 0a20 2020 2020 2020 2020  pred)..         
-000492b0: 2020 2069 6620 6c65 6e28 636c 6173 7365     if len(classe
-000492c0: 7329 203d 3d20 323a 0d0a 2020 2020 2020  s) == 2:..      
-000492d0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-000492e0: 2720 2020 2052 6567 756c 6172 2041 6363  '    Regular Acc
-000492f0: 7572 6163 7920 5363 6f72 6520 3d20 2530  uracy Score = %0
-00049300: 2e31 6625 2527 2025 2861 6363 7572 6163  .1f%%' %(accurac
-00049310: 795f 7363 6f72 6528 795f 6376 2c79 5f70  y_score(y_cv,y_p
-00049320: 7265 6429 2a31 3030 2929 0d0a 2020 2020  red)*100))..    
-00049330: 2020 2020 2020 2020 2020 2020 795f 7072              y_pr
-00049340: 6f62 6173 203d 206d 6f64 656c 2e70 7265  obas = model.pre
-00049350: 6469 6374 5f70 726f 6261 2858 5f63 7629  dict_proba(X_cv)
-00049360: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00049370: 2020 726d 736c 655f 6361 6c63 756c 6174    rmsle_calculat
-00049380: 6564 5f6d 203d 2070 7269 6e74 5f63 6c61  ed_m = print_cla
-00049390: 7373 6966 6963 6174 696f 6e5f 6d6f 6465  ssification_mode
-000493a0: 6c5f 7374 6174 7328 795f 6376 2c20 795f  l_stats(y_cv, y_
-000493b0: 7072 6f62 6173 2c20 6d5f 7468 7265 7368  probas, m_thresh
-000493c0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-000493d0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-000493e0: 2020 2020 2020 2323 2323 2323 2055 7365        ###### Use
-000493f0: 2061 206e 6963 6520 636c 6173 7369 6669   a nice classifi
-00049400: 6361 7469 6f6e 206d 6174 7269 7820 7072  cation matrix pr
-00049410: 696e 7469 6e67 206d 6f64 756c 6520 6865  inting module he
-00049420: 7265 2023 2323 2323 2323 2323 0d0a 2020  re #########..  
-00049430: 2020 2020 2020 2020 2020 2020 2020 795f                y_
-00049440: 7072 6f62 6173 203d 206d 6f64 656c 2e70  probas = model.p
-00049450: 7265 6469 6374 5f70 726f 6261 2858 5f63  redict_proba(X_c
-00049460: 7629 0d0a 2020 2020 2020 2020 2020 2020  v)..            
-00049470: 2020 2020 7072 696e 745f 636c 6173 7369      print_classi
-00049480: 6669 6361 7469 6f6e 5f6d 6574 7269 6373  fication_metrics
-00049490: 2879 5f63 762c 2079 5f70 726f 6261 7329  (y_cv, y_probas)
-000494a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000494b0: 2020 7072 696e 7428 636c 6173 7369 6669    print(classifi
-000494c0: 6361 7469 6f6e 5f72 6570 6f72 7428 795f  cation_report(y_
-000494d0: 6376 2c79 5f70 7265 6429 290d 0a20 2020  cv,y_pred))..   
-000494e0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-000494f0: 6e74 2863 6f6e 6675 7369 6f6e 5f6d 6174  nt(confusion_mat
-00049500: 7269 7828 795f 6376 2c20 795f 7072 6564  rix(y_cv, y_pred
-00049510: 2929 0d0a 2020 2020 656c 7365 3a0d 0a20  ))..    else:.. 
-00049520: 2020 2020 2020 2069 6620 6d6f 6465 6c74         if modelt
-00049530: 7970 6520 3d3d 2027 5265 6772 6573 7369  ype == 'Regressi
-00049540: 6f6e 273a 0d0a 2020 2020 2020 2020 2020  on':..          
-00049550: 2020 2323 2323 2054 6869 7320 6973 2066    #### This is f
-00049560: 6f72 204d 756c 7469 2d4c 6162 656c 2052  or Multi-Label R
-00049570: 6567 7265 7373 696f 6e20 2323 2323 2323  egression ######
+00048d30: 2323 2323 2323 2323 2729 0d0a 2020 2020  ########')..    
+00048d40: 2323 2323 2320 5468 6973 206e 6578 7420  ##### This next 
+00048d50: 7374 6570 2069 7320 7665 7279 2069 6d70  step is very imp
+00048d60: 6f72 7461 6e74 2073 696e 6365 2073 6f6d  ortant since som
+00048d70: 6520 6d6f 6465 6c73 2067 6976 6520 7365  e models give se
+00048d80: 7269 6573 2c20 6f74 6865 7273 2067 6976  ries, others giv
+00048d90: 6520 6172 7261 7973 2e20 5665 7279 2070  e arrays. Very p
+00048da0: 6169 6e66 756c 210d 0a20 2020 2069 6620  ainful!..    if 
+00048db0: 6973 696e 7374 616e 6365 2879 5f70 7265  isinstance(y_pre
+00048dc0: 642c 7064 2e53 6572 6965 7329 206f 7220  d,pd.Series) or 
+00048dd0: 6973 696e 7374 616e 6365 2879 5f70 7265  isinstance(y_pre
+00048de0: 642c 7064 2e44 6174 6146 7261 6d65 293a  d,pd.DataFrame):
+00048df0: 0d0a 2020 2020 2020 2020 795f 7072 6564  ..        y_pred
+00048e00: 203d 2079 5f70 7265 642e 7661 6c75 6573   = y_pred.values
+00048e10: 0d0a 2020 2020 6966 2069 7369 6e73 7461  ..    if isinsta
+00048e20: 6e63 6528 795f 6376 2c70 642e 5365 7269  nce(y_cv,pd.Seri
+00048e30: 6573 2920 6f72 2069 7369 6e73 7461 6e63  es) or isinstanc
+00048e40: 6528 795f 6376 2c70 642e 4461 7461 4672  e(y_cv,pd.DataFr
+00048e50: 616d 6529 3a0d 0a20 2020 2020 2020 2079  ame):..        y
+00048e60: 5f63 7620 3d20 795f 6376 2e76 616c 7565  _cv = y_cv.value
+00048e70: 730d 0a20 2020 2070 7269 6e74 2827 2573  s..    print('%s
+00048e80: 204d 6f64 656c 2050 7265 6469 6374 696f   Model Predictio
+00048e90: 6e20 5265 7375 6c74 7320 6f6e 2048 656c  n Results on Hel
+00048ea0: 6420 4f75 7420 4356 2044 6174 6120 5365  d Out CV Data Se
+00048eb0: 743a 2720 256d 6f64 656c 5f6e 616d 6529  t:' %model_name)
+00048ec0: 0d0a 2020 2020 2323 2323 2323 204d 616b  ..    ###### Mak
+00048ed0: 6520 7375 7265 2074 6861 7420 796f 7520  e sure that you 
+00048ee0: 6368 616e 6765 2074 6865 206d 6f64 656c  change the model
+00048ef0: 2773 2070 7265 6469 6374 696f 6e73 2074  's predictions t
+00048f00: 6f20 6265 2074 6865 2073 616d 6520 7479  o be the same ty
+00048f10: 7065 2061 7320 6f72 6967 696e 616c 2074  pe as original t
+00048f20: 6172 6765 7420 2323 2323 0d0a 2020 2020  arget ####..    
+00048f30: 696e 745f 7479 7065 7320 3d20 5b6e 702e  int_types = [np.
+00048f40: 696e 7438 2c20 6e70 2e69 6e74 3136 2c20  int8, np.int16, 
+00048f50: 6e70 2e69 6e74 3332 2c20 6e70 2e69 6e74  np.int32, np.int
+00048f60: 3634 5d0d 0a20 2020 2074 6172 6765 7473  64]..    targets
+00048f70: 5f6e 6567 6174 6976 655f 666c 6167 203d  _negative_flag =
+00048f80: 206c 656e 2879 5f63 763c 3029 203d 3d20   len(y_cv<0) == 
+00048f90: 300d 0a20 2020 2069 6620 795f 6376 2e64  0..    if y_cv.d
+00048fa0: 7479 7065 2069 6e20 696e 745f 7479 7065  type in int_type
+00048fb0: 733a 0d0a 2020 2020 2020 2020 795f 7072  s:..        y_pr
+00048fc0: 6564 203d 206d 6f64 6966 795f 6172 7261  ed = modify_arra
+00048fd0: 795f 746f 5f69 6e74 6567 6572 2879 5f70  y_to_integer(y_p
+00048fe0: 7265 642c 2074 6172 6765 7473 5f6e 6567  red, targets_neg
+00048ff0: 6174 6976 655f 666c 6167 290d 0a20 2020  ative_flag)..   
+00049000: 2020 2020 206d 6f64 6966 795f 7461 7267       modify_targ
+00049010: 6574 735f 666c 6167 203d 2054 7275 650d  ets_flag = True.
+00049020: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
+00049030: 2323 2020 2020 4e20 4f20 5720 2020 5020  ##    N O W   P 
+00049040: 5220 4920 4e20 5420 2020 4120 4c20 4c20  R I N T   A L L 
+00049050: 2052 2045 2053 2055 204c 2054 2053 2023   R E S U L T S #
+00049060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00049070: 2323 230d 0a20 2020 2069 6620 6d6f 6465  ###..    if mode
+00049080: 6c5f 6c61 6265 6c20 3d3d 2027 5369 6e67  l_label == 'Sing
+00049090: 6c65 5f4c 6162 656c 273a 0d0a 2020 2020  le_Label':..    
+000490a0: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
+000490b0: 203d 3d20 2752 6567 7265 7373 696f 6e27   == 'Regression'
+000490c0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+000490d0: 6d73 6c65 5f63 616c 6375 6c61 7465 645f  msle_calculated_
+000490e0: 6d20 3d20 726d 7365 2879 5f63 762c 2079  m = rmse(y_cv, y
+000490f0: 5f70 7265 6429 0d0a 2020 2020 2020 2020  _pred)..        
+00049100: 2020 2020 7072 696e 745f 7265 6772 6573      print_regres
+00049110: 7369 6f6e 5f6d 6f64 656c 5f73 7461 7473  sion_model_stats
+00049120: 2879 5f63 762c 2079 5f70 7265 642c 7461  (y_cv, y_pred,ta
+00049130: 7267 6574 2c70 6c6f 745f 6e61 6d65 3d6d  rget,plot_name=m
+00049140: 6f64 656c 5f6e 616d 6529 0d0a 2020 2020  odel_name)..    
+00049150: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00049160: 2020 2020 2020 2069 6620 6d6f 6465 6c5f         if model_
+00049170: 6e61 6d65 203d 3d20 2746 6f72 6573 7473  name == 'Forests
+00049180: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+00049190: 2020 2020 6966 2063 616c 6962 7261 746f      if calibrato
+000491a0: 725f 666c 6167 3a0d 0a20 2020 2020 2020  r_flag:..       
+000491b0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+000491c0: 6e74 2827 2020 2020 4f4f 4220 5363 6f72  nt('    OOB Scor
+000491d0: 6520 3d20 2530 2e33 6627 2025 6d6f 6465  e = %0.3f' %mode
+000491e0: 6c2e 6261 7365 5f65 7374 696d 6174 6f72  l.base_estimator
+000491f0: 2e6f 6f62 5f73 636f 7265 5f29 0d0a 2020  .oob_score_)..  
+00049200: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00049210: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00049220: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00049230: 2020 2020 4f4f 4220 5363 6f72 6520 3d20      OOB Score = 
+00049240: 2530 2e33 6627 2025 6d6f 6465 6c2e 6f6f  %0.3f' %model.oo
+00049250: 625f 7363 6f72 655f 290d 0a20 2020 2020  b_score_)..     
+00049260: 2020 2020 2020 2072 6d73 6c65 5f63 616c         rmsle_cal
+00049270: 6375 6c61 7465 645f 6d20 3d20 6261 6c61  culated_m = bala
+00049280: 6e63 6564 5f61 6363 7572 6163 795f 7363  nced_accuracy_sc
+00049290: 6f72 6528 795f 6376 2c79 5f70 7265 6429  ore(y_cv,y_pred)
+000492a0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000492b0: 206c 656e 2863 6c61 7373 6573 2920 3d3d   len(classes) ==
+000492c0: 2032 3a0d 0a20 2020 2020 2020 2020 2020   2:..           
+000492d0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+000492e0: 5265 6775 6c61 7220 4163 6375 7261 6379  Regular Accuracy
+000492f0: 2053 636f 7265 203d 2025 302e 3166 2525   Score = %0.1f%%
+00049300: 2720 2528 6163 6375 7261 6379 5f73 636f  ' %(accuracy_sco
+00049310: 7265 2879 5f63 762c 795f 7072 6564 292a  re(y_cv,y_pred)*
+00049320: 3130 3029 290d 0a20 2020 2020 2020 2020  100))..         
+00049330: 2020 2020 2020 2079 5f70 726f 6261 7320         y_probas 
+00049340: 3d20 6d6f 6465 6c2e 7072 6564 6963 745f  = model.predict_
+00049350: 7072 6f62 6128 585f 6376 290d 0a20 2020  proba(X_cv)..   
+00049360: 2020 2020 2020 2020 2020 2020 2072 6d73               rms
+00049370: 6c65 5f63 616c 6375 6c61 7465 645f 6d20  le_calculated_m 
+00049380: 3d20 7072 696e 745f 636c 6173 7369 6669  = print_classifi
+00049390: 6361 7469 6f6e 5f6d 6f64 656c 5f73 7461  cation_model_sta
+000493a0: 7473 2879 5f63 762c 2079 5f70 726f 6261  ts(y_cv, y_proba
+000493b0: 732c 206d 5f74 6872 6573 6829 0d0a 2020  s, m_thresh)..  
+000493c0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+000493d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000493e0: 2023 2323 2323 2320 5573 6520 6120 6e69   ###### Use a ni
+000493f0: 6365 2063 6c61 7373 6966 6963 6174 696f  ce classificatio
+00049400: 6e20 6d61 7472 6978 2070 7269 6e74 696e  n matrix printin
+00049410: 6720 6d6f 6475 6c65 2068 6572 6520 2323  g module here ##
+00049420: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
+00049430: 2020 2020 2020 2020 2079 5f70 726f 6261           y_proba
+00049440: 7320 3d20 6d6f 6465 6c2e 7072 6564 6963  s = model.predic
+00049450: 745f 7072 6f62 6128 585f 6376 290d 0a20  t_proba(X_cv).. 
+00049460: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00049470: 7269 6e74 5f63 6c61 7373 6966 6963 6174  rint_classificat
+00049480: 696f 6e5f 6d65 7472 6963 7328 795f 6376  ion_metrics(y_cv
+00049490: 2c20 795f 7072 6f62 6173 290d 0a20 2020  , y_probas)..   
+000494a0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+000494b0: 6e74 2863 6c61 7373 6966 6963 6174 696f  nt(classificatio
+000494c0: 6e5f 7265 706f 7274 2879 5f63 762c 795f  n_report(y_cv,y_
+000494d0: 7072 6564 2929 0d0a 2020 2020 2020 2020  pred))..        
+000494e0: 2020 2020 2020 2020 7072 696e 7428 636f          print(co
+000494f0: 6e66 7573 696f 6e5f 6d61 7472 6978 2879  nfusion_matrix(y
+00049500: 5f63 762c 2079 5f70 7265 6429 290d 0a20  _cv, y_pred)).. 
+00049510: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00049520: 2020 6966 206d 6f64 656c 7479 7065 203d    if modeltype =
+00049530: 3d20 2752 6567 7265 7373 696f 6e27 3a0d  = 'Regression':.
+00049540: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
+00049550: 2320 5468 6973 2069 7320 666f 7220 4d75  # This is for Mu
+00049560: 6c74 692d 4c61 6265 6c20 5265 6772 6573  lti-Label Regres
+00049570: 7369 6f6e 2023 2323 2323 2323 2323 2323  sion ###########
 00049580: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049590: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-000495a0: 2020 2020 2020 2020 7072 696e 745f 7265          print_re
-000495b0: 6772 6573 7369 6f6e 5f6d 6f64 656c 5f73  gression_model_s
-000495c0: 7461 7473 2879 5f63 762c 2079 5f70 7265  tats(y_cv, y_pre
-000495d0: 642c 7461 7267 6574 2c70 6c6f 745f 6e61  d,target,plot_na
-000495e0: 6d65 3d6d 6f64 656c 5f6e 616d 6529 0d0a  me=model_name)..
-000495f0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00049600: 2020 2020 2020 2020 2020 2079 5f70 726f             y_pro
-00049610: 6261 7320 3d20 6d6f 6465 6c2e 7072 6564  bas = model.pred
-00049620: 6963 745f 7072 6f62 6128 585f 6376 290d  ict_proba(X_cv).
-00049630: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
-00049640: 2320 5468 6973 2069 7320 666f 7220 4d75  # This is for Mu
-00049650: 6c74 692d 4c61 6265 6c20 436c 6173 7369  lti-Label Classi
-00049660: 6669 6361 7469 6f6e 2023 2323 2323 2323  fication #######
+00049590: 2323 2323 230d 0a20 2020 2020 2020 2020  #####..         
+000495a0: 2020 2070 7269 6e74 5f72 6567 7265 7373     print_regress
+000495b0: 696f 6e5f 6d6f 6465 6c5f 7374 6174 7328  ion_model_stats(
+000495c0: 795f 6376 2c20 795f 7072 6564 2c74 6172  y_cv, y_pred,tar
+000495d0: 6765 742c 706c 6f74 5f6e 616d 653d 6d6f  get,plot_name=mo
+000495e0: 6465 6c5f 6e61 6d65 290d 0a20 2020 2020  del_name)..     
+000495f0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00049600: 2020 2020 2020 795f 7072 6f62 6173 203d        y_probas =
+00049610: 206d 6f64 656c 2e70 7265 6469 6374 5f70   model.predict_p
+00049620: 726f 6261 2858 5f63 7629 0d0a 2020 2020  roba(X_cv)..    
+00049630: 2020 2020 2020 2020 2323 2323 2054 6869          #### Thi
+00049640: 7320 6973 2066 6f72 204d 756c 7469 2d4c  s is for Multi-L
+00049650: 6162 656c 2043 6c61 7373 6966 6963 6174  abel Classificat
+00049660: 696f 6e20 2323 2323 2323 2323 2323 2323  ion ############
 00049670: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049680: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
-00049690: 2020 2020 2020 2070 7269 6e74 5f63 6c61         print_cla
-000496a0: 7373 6966 6963 6174 696f 6e5f 6d65 7472  ssification_metr
-000496b0: 6963 7328 795f 6376 2c20 795f 7072 6564  ics(y_cv, y_pred
-000496c0: 2c20 4661 6c73 6529 0d0a 2020 2020 2020  , False)..      
-000496d0: 2020 2020 2020 7072 696e 7428 636c 6173        print(clas
-000496e0: 7369 6669 6361 7469 6f6e 5f72 6570 6f72  sification_repor
-000496f0: 7428 795f 6376 2c20 795f 7072 6564 2029  t(y_cv, y_pred )
-00049700: 290d 0a20 2020 2023 2323 2323 2320 2020  )..    ######   
-00049710: 2020 2053 4554 2042 4553 5420 5041 5241     SET BEST PARA
-00049720: 4d45 5445 5253 2048 4552 4520 2323 2323  METERS HERE ####
-00049730: 2323 0d0a 2020 2020 2323 2320 4669 6e64  ##..    ### Find
-00049740: 2077 6861 7420 7468 6520 6f72 6465 7220   what the order 
-00049750: 6f66 2062 6573 7420 7061 7261 6d73 2061  of best params a
-00049760: 7265 2061 6e64 2073 6574 2074 6865 2073  re and set the s
-00049770: 616d 6520 6173 2074 6865 206f 7269 6769  ame as the origi
-00049780: 6e61 6c20 6d6f 6465 6c20 2323 230d 0a20  nal model ###.. 
-00049790: 2020 2023 2320 5468 6973 2069 7320 7768     ## This is wh
-000497a0: 6572 6520 7765 2073 6574 2074 6865 2062  ere we set the b
-000497b0: 6573 7420 7061 7261 6d65 7465 7273 2066  est parameters f
-000497c0: 726f 6d20 7472 6169 6e69 6e67 2074 6f20  rom training to 
-000497d0: 7468 6520 6d6f 6465 6c20 2323 2323 0d0a  the model ####..
-000497e0: 2020 2020 6966 206d 6f64 656c 5f6c 6162      if model_lab
-000497f0: 656c 203d 3d20 2753 696e 676c 655f 4c61  el == 'Single_La
-00049800: 6265 6c27 3a0d 0a20 2020 2020 2020 2023  bel':..        #
-00049810: 2323 2320 596f 7520 646f 2065 6e73 656d  ### You do ensem
-00049820: 626c 696e 6720 6f72 2073 7461 636b 696e  bling or stackin
-00049830: 6720 6f6e 6c79 2066 6f72 2053 696e 676c  g only for Singl
-00049840: 655f 4c61 6265 6c20 7072 6f62 6c65 6d73  e_Label problems
-00049850: 2023 2323 2323 2323 2323 2323 230d 0a20   ############.. 
-00049860: 2020 2020 2020 2069 6620 6d6f 6465 6c74         if modelt
-00049870: 7970 6520 3d3d 2027 5265 6772 6573 7369  ype == 'Regressi
-00049880: 6f6e 273a 0d0a 2020 2020 2020 2020 2020  on':..          
-00049890: 2020 6966 206e 6f74 2053 7461 636b 696e    if not Stackin
-000498a0: 675f 466c 6167 2061 6e64 2058 5f74 7261  g_Flag and X_tra
-000498b0: 696e 2e73 6861 7065 5b30 5d20 3c3d 2065  in.shape[0] <= e
-000498c0: 6e73 656d 626c 655f 6d61 785f 726f 7773  nsemble_max_rows
-000498d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000498e0: 2020 2070 7269 6e74 2827 2323 2323 2323     print('######
-000498f0: 2323 2323 2323 2323 2323 2320 4520 4e20  ########### E N 
-00049900: 5320 4520 4d20 4220 4c20 4520 204d 204f  S E M B L E  M O
-00049910: 2044 2045 204c 2020 2323 2323 2323 2323   D E L  ########
-00049920: 2323 2323 2323 2323 2323 2729 0d0a 2020  ##########')..  
-00049930: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-00049940: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
-00049950: 2020 2020 2020 2020 636f 6c73 203d 205b          cols = [
-00049960: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00049970: 2020 2020 2020 2073 7562 6d20 3d20 7064         subm = pd
-00049980: 2e44 6174 6146 7261 6d65 2829 0d0a 2020  .DataFrame()..  
-00049990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000499a0: 2020 2323 2323 2054 6869 7320 6973 2066    #### This is f
-000499b0: 6f72 2045 6e73 656d 626c 696e 6720 204f  or Ensembling  O
-000499c0: 6e6c 7920 2323 2323 230d 0a20 2020 2020  nly #####..     
-000499d0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-000499e0: 6f64 656c 735f 6c69 7374 2c20 6376 5f65  odels_list, cv_e
-000499f0: 6e73 656d 626c 6573 203d 2051 7569 636b  nsembles = Quick
-00049a00: 4d4c 5f45 6e73 656d 626c 696e 6728 585f  ML_Ensembling(X_
-00049a10: 7472 6169 6e2c 2079 5f74 7261 696e 2c20  train, y_train, 
-00049a20: 585f 6376 2c20 795f 6376 2c0d 0a20 2020  X_cv, y_cv,..   
+00049680: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
+00049690: 2020 7072 696e 745f 636c 6173 7369 6669    print_classifi
+000496a0: 6361 7469 6f6e 5f6d 6574 7269 6373 2879  cation_metrics(y
+000496b0: 5f63 762c 2079 5f70 7265 642c 2046 616c  _cv, y_pred, Fal
+000496c0: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
+000496d0: 2070 7269 6e74 2863 6c61 7373 6966 6963   print(classific
+000496e0: 6174 696f 6e5f 7265 706f 7274 2879 5f63  ation_report(y_c
+000496f0: 762c 2079 5f70 7265 6420 2929 0d0a 2020  v, y_pred ))..  
+00049700: 2020 2323 2323 2323 2020 2020 2020 5345    ######      SE
+00049710: 5420 4245 5354 2050 4152 414d 4554 4552  T BEST PARAMETER
+00049720: 5320 4845 5245 2023 2323 2323 230d 0a20  S HERE ######.. 
+00049730: 2020 2023 2323 2046 696e 6420 7768 6174     ### Find what
+00049740: 2074 6865 206f 7264 6572 206f 6620 6265   the order of be
+00049750: 7374 2070 6172 616d 7320 6172 6520 616e  st params are an
+00049760: 6420 7365 7420 7468 6520 7361 6d65 2061  d set the same a
+00049770: 7320 7468 6520 6f72 6967 696e 616c 206d  s the original m
+00049780: 6f64 656c 2023 2323 0d0a 2020 2020 2323  odel ###..    ##
+00049790: 2054 6869 7320 6973 2077 6865 7265 2077   This is where w
+000497a0: 6520 7365 7420 7468 6520 6265 7374 2070  e set the best p
+000497b0: 6172 616d 6574 6572 7320 6672 6f6d 2074  arameters from t
+000497c0: 7261 696e 696e 6720 746f 2074 6865 206d  raining to the m
+000497d0: 6f64 656c 2023 2323 230d 0a20 2020 2069  odel ####..    i
+000497e0: 6620 6d6f 6465 6c5f 6c61 6265 6c20 3d3d  f model_label ==
+000497f0: 2027 5369 6e67 6c65 5f4c 6162 656c 273a   'Single_Label':
+00049800: 0d0a 2020 2020 2020 2020 2323 2323 2059  ..        #### Y
+00049810: 6f75 2064 6f20 656e 7365 6d62 6c69 6e67  ou do ensembling
+00049820: 206f 7220 7374 6163 6b69 6e67 206f 6e6c   or stacking onl
+00049830: 7920 666f 7220 5369 6e67 6c65 5f4c 6162  y for Single_Lab
+00049840: 656c 2070 726f 626c 656d 7320 2323 2323  el problems ####
+00049850: 2323 2323 2323 2323 0d0a 2020 2020 2020  ########..      
+00049860: 2020 6966 206d 6f64 656c 7479 7065 203d    if modeltype =
+00049870: 3d20 2752 6567 7265 7373 696f 6e27 3a0d  = 'Regression':.
+00049880: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00049890: 6e6f 7420 5374 6163 6b69 6e67 5f46 6c61  not Stacking_Fla
+000498a0: 6720 616e 6420 585f 7472 6169 6e2e 7368  g and X_train.sh
+000498b0: 6170 655b 305d 203c 3d20 656e 7365 6d62  ape[0] <= ensemb
+000498c0: 6c65 5f6d 6178 5f72 6f77 733a 0d0a 2020  le_max_rows:..  
+000498d0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+000498e0: 696e 7428 2723 2323 2323 2323 2323 2323  int('###########
+000498f0: 2323 2323 2323 2045 204e 2053 2045 204d  ###### E N S E M
+00049900: 2042 204c 2045 2020 4d20 4f20 4420 4520   B L E  M O D E 
+00049910: 4c20 2023 2323 2323 2323 2323 2323 2323  L  #############
+00049920: 2323 2323 2327 290d 0a20 2020 2020 2020  #####')..       
+00049930: 2020 2020 2020 2020 2074 7279 3a0d 0a20           try:.. 
+00049940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049950: 2020 2063 6f6c 7320 3d20 5b5d 0d0a 2020     cols = []..  
+00049960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049970: 2020 7375 626d 203d 2070 642e 4461 7461    subm = pd.Data
+00049980: 4672 616d 6528 290d 0a20 2020 2020 2020  Frame()..       
+00049990: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+000499a0: 2320 5468 6973 2069 7320 666f 7220 456e  # This is for En
+000499b0: 7365 6d62 6c69 6e67 2020 4f6e 6c79 2023  sembling  Only #
+000499c0: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
+000499d0: 2020 2020 2020 2020 2020 6d6f 6465 6c73            models
+000499e0: 5f6c 6973 742c 2063 765f 656e 7365 6d62  _list, cv_ensemb
+000499f0: 6c65 7320 3d20 5175 6963 6b4d 4c5f 456e  les = QuickML_En
+00049a00: 7365 6d62 6c69 6e67 2858 5f74 7261 696e  sembling(X_train
+00049a10: 2c20 795f 7472 6169 6e2c 2058 5f63 762c  , y_train, X_cv,
+00049a20: 2079 5f63 762c 0d0a 2020 2020 2020 2020   y_cv,..        
 00049a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00049a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049a50: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-00049a60: 7479 7065 3d6d 6f64 656c 7479 7065 2c20  type=modeltype, 
-00049a70: 426f 6f73 7469 6e67 5f46 6c61 673d 426f  Boosting_Flag=Bo
-00049a80: 6f73 7469 6e67 5f46 6c61 672c 0d0a 2020  osting_Flag,..  
+00049a50: 2020 2020 2020 6d6f 6465 6c74 7970 653d        modeltype=
+00049a60: 6d6f 6465 6c74 7970 652c 2042 6f6f 7374  modeltype, Boost
+00049a70: 696e 675f 466c 6167 3d42 6f6f 7374 696e  ing_Flag=Boostin
+00049a80: 675f 466c 6167 2c0d 0a20 2020 2020 2020  g_Flag,..       
 00049a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00049aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049ab0: 2020 2020 2020 2020 2020 2020 2073 636f               sco
-00049ac0: 7269 6e67 3d27 272c 2076 6572 626f 7365  ring='', verbose
-00049ad0: 3d76 6572 626f 7365 290d 0a20 2020 2020  =verbose)..     
-00049ae0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00049af0: 6f64 656c 735f 6c69 7374 2e61 7070 656e  odels_list.appen
-00049b00: 6428 6d6f 6465 6c5f 6e61 6d65 290d 0a20  d(model_name).. 
-00049b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049b20: 2020 2066 6f72 206d 6f64 656c 732c 2065     for models, e
-00049b30: 6163 6820 696e 207a 6970 286d 6f64 656c  ach in zip(model
-00049b40: 735f 6c69 7374 2c20 7261 6e67 6528 6c65  s_list, range(le
-00049b50: 6e28 6d6f 6465 6c73 5f6c 6973 7429 2929  n(models_list)))
-00049b60: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00049b70: 2020 2020 2020 2020 2020 206e 6577 5f63             new_c
-00049b80: 6f6c 203d 2065 6163 685f 7461 7267 6574  ol = each_target
-00049b90: 2b27 5f27 2b6d 6f64 656c 732b 275f 7072  +'_'+models+'_pr
-00049ba0: 6564 6963 7469 6f6e 7327 0d0a 2020 2020  edictions'..    
-00049bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049bc0: 2020 2020 6966 2065 6163 682b 3120 3d3d      if each+1 ==
-00049bd0: 206c 656e 286d 6f64 656c 735f 6c69 7374   len(models_list
-00049be0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00049bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049c00: 7375 626d 5b6e 6577 5f63 6f6c 5d20 3d20  subm[new_col] = 
-00049c10: 795f 7072 6564 0d0a 2020 2020 2020 2020  y_pred..        
-00049c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049c30: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00049c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049c50: 2020 2073 7562 6d5b 6e65 775f 636f 6c5d     subm[new_col]
-00049c60: 203d 2063 765f 656e 7365 6d62 6c65 735b   = cv_ensembles[
-00049c70: 3a2c 6561 6368 5d0d 0a20 2020 2020 2020  :,each]..       
-00049c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049c90: 2063 6f6c 732e 6170 7065 6e64 286e 6577   cols.append(new
-00049ca0: 5f63 6f6c 290d 0a20 2020 2020 2020 2020  _col)..         
-00049cb0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-00049cc0: 6e28 636f 6c73 2920 3d3d 2035 3a0d 0a20  n(cols) == 5:.. 
+00049ab0: 2020 2020 2020 2020 7363 6f72 696e 673d          scoring=
+00049ac0: 2727 2c20 7665 7262 6f73 653d 7665 7262  '', verbose=verb
+00049ad0: 6f73 6529 0d0a 2020 2020 2020 2020 2020  ose)..          
+00049ae0: 2020 2020 2020 2020 2020 6d6f 6465 6c73            models
+00049af0: 5f6c 6973 742e 6170 7065 6e64 286d 6f64  _list.append(mod
+00049b00: 656c 5f6e 616d 6529 0d0a 2020 2020 2020  el_name)..      
+00049b10: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00049b20: 7220 6d6f 6465 6c73 2c20 6561 6368 2069  r models, each i
+00049b30: 6e20 7a69 7028 6d6f 6465 6c73 5f6c 6973  n zip(models_lis
+00049b40: 742c 2072 616e 6765 286c 656e 286d 6f64  t, range(len(mod
+00049b50: 656c 735f 6c69 7374 2929 293a 0d0a 2020  els_list))):..  
+00049b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049b70: 2020 2020 2020 6e65 775f 636f 6c20 3d20        new_col = 
+00049b80: 6561 6368 5f74 6172 6765 742b 275f 272b  each_target+'_'+
+00049b90: 6d6f 6465 6c73 2b27 5f70 7265 6469 6374  models+'_predict
+00049ba0: 696f 6e73 270d 0a20 2020 2020 2020 2020  ions'..         
+00049bb0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00049bc0: 6620 6561 6368 2b31 203d 3d20 6c65 6e28  f each+1 == len(
+00049bd0: 6d6f 6465 6c73 5f6c 6973 7429 3a0d 0a20  models_list):.. 
+00049be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049bf0: 2020 2020 2020 2020 2020 2073 7562 6d5b             subm[
+00049c00: 6e65 775f 636f 6c5d 203d 2079 5f70 7265  new_col] = y_pre
+00049c10: 640d 0a20 2020 2020 2020 2020 2020 2020  d..             
+00049c20: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00049c30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00049c40: 2020 2020 2020 2020 2020 2020 2020 7375                su
+00049c50: 626d 5b6e 6577 5f63 6f6c 5d20 3d20 6376  bm[new_col] = cv
+00049c60: 5f65 6e73 656d 626c 6573 5b3a 2c65 6163  _ensembles[:,eac
+00049c70: 685d 0d0a 2020 2020 2020 2020 2020 2020  h]..            
+00049c80: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
+00049c90: 2e61 7070 656e 6428 6e65 775f 636f 6c29  .append(new_col)
+00049ca0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00049cb0: 2020 2020 2020 6966 206c 656e 2863 6f6c        if len(col
+00049cc0: 7329 203d 3d20 353a 0d0a 2020 2020 2020  s) == 5:..      
 00049cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049ce0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-00049cf0: 2020 4469 7370 6c61 7969 6e67 2072 6573    Displaying res
-00049d00: 756c 7473 206f 6620 7765 6967 6874 6564  ults of weighted
-00049d10: 2061 7665 7261 6765 2065 6e73 656d 626c   average ensembl
-00049d20: 6520 6f66 2025 6420 7265 6772 6573 736f  e of %d regresso
-00049d30: 7273 2720 256c 656e 2863 6f6c 7329 290d  rs' %len(cols)).
-00049d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00049d50: 2020 2020 2020 2020 2065 6e73 656d 5f70           ensem_p
-00049d60: 7265 6420 3d20 7375 626d 5b63 6f6c 735b  red = subm[cols[
-00049d70: 2d31 5d5d 2a30 2e35 2b30 2e31 3235 2a28  -1]]*0.5+0.125*(
-00049d80: 7375 626d 5b63 6f6c 735b 305d 5d2b 7375  subm[cols[0]]+su
-00049d90: 626d 5b0d 0a20 2020 2020 2020 2020 2020  bm[..           
+00049ce0: 2020 7072 696e 7428 2720 2020 2044 6973    print('    Dis
+00049cf0: 706c 6179 696e 6720 7265 7375 6c74 7320  playing results 
+00049d00: 6f66 2077 6569 6768 7465 6420 6176 6572  of weighted aver
+00049d10: 6167 6520 656e 7365 6d62 6c65 206f 6620  age ensemble of 
+00049d20: 2564 2072 6567 7265 7373 6f72 7327 2025  %d regressors' %
+00049d30: 6c65 6e28 636f 6c73 2929 0d0a 2020 2020  len(cols))..    
+00049d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049d50: 2020 2020 656e 7365 6d5f 7072 6564 203d      ensem_pred =
+00049d60: 2073 7562 6d5b 636f 6c73 5b2d 315d 5d2a   subm[cols[-1]]*
+00049d70: 302e 352b 302e 3132 352a 2873 7562 6d5b  0.5+0.125*(subm[
+00049d80: 636f 6c73 5b30 5d5d 2b73 7562 6d5b 0d0a  cols[0]]+subm[..
+00049d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00049da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049db0: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
-00049dc0: 735b 315d 5d2b 7375 626d 5b63 6f6c 735b  s[1]]+subm[cols[
-00049dd0: 325d 5d2b 7375 626d 5b63 6f6c 735b 335d  2]]+subm[cols[3]
-00049de0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00049df0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00049db0: 2020 2020 2020 2020 636f 6c73 5b31 5d5d          cols[1]]
+00049dc0: 2b73 7562 6d5b 636f 6c73 5b32 5d5d 2b73  +subm[cols[2]]+s
+00049dd0: 7562 6d5b 636f 6c73 5b33 5d5d 290d 0a20  ubm[cols[3]]).. 
+00049de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049df0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
 00049e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049e10: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-00049e20: 2020 4361 6c63 756c 6174 696e 6720 7265    Calculating re
-00049e30: 6775 6c61 7220 6176 6572 6167 6520 656e  gular average en
-00049e40: 7365 6d62 6c65 206f 6620 2564 2072 6567  semble of %d reg
-00049e50: 7265 7373 6f72 7327 2025 6c65 6e28 636f  ressors' %len(co
-00049e60: 6c73 2929 0d0a 2020 2020 2020 2020 2020  ls))..          
-00049e70: 2020 2020 2020 2020 2020 2020 2020 656e                en
-00049e80: 7365 6d5f 7072 6564 203d 2028 7375 626d  sem_pred = (subm
-00049e90: 5b63 6f6c 735d 2e6d 6561 6e28 6178 6973  [cols].mean(axis
-00049ea0: 3d31 2929 0d0a 2020 2020 2020 2020 2020  =1))..          
-00049eb0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00049ec0: 2723 2323 2323 2323 2323 2323 2323 2323  '###############
+00049e10: 2020 7072 696e 7428 2720 2020 2043 616c    print('    Cal
+00049e20: 6375 6c61 7469 6e67 2072 6567 756c 6172  culating regular
+00049e30: 2061 7665 7261 6765 2065 6e73 656d 626c   average ensembl
+00049e40: 6520 6f66 2025 6420 7265 6772 6573 736f  e of %d regresso
+00049e50: 7273 2720 256c 656e 2863 6f6c 7329 290d  rs' %len(cols)).
+00049e60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00049e70: 2020 2020 2020 2020 2065 6e73 656d 5f70           ensem_p
+00049e80: 7265 6420 3d20 2873 7562 6d5b 636f 6c73  red = (subm[cols
+00049e90: 5d2e 6d65 616e 2861 7869 733d 3129 290d  ].mean(axis=1)).
+00049ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00049eb0: 2020 2020 2070 7269 6e74 2827 2323 2323       print('####
+00049ec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00049ed0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00049ee0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00049ef0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00049f00: 2323 2323 2323 2323 2323 2323 2323 2729  ##############')
-00049f10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00049f20: 2020 2020 2020 7065 7266 6f72 6d65 645f        performed_
-00049f30: 656e 7365 6d62 6c69 6e67 203d 2054 7275  ensembling = Tru
-00049f40: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
-00049f50: 2020 2020 2020 2023 2323 2320 5369 6e63         #### Sinc
-00049f60: 6520 7765 2068 6176 6520 6120 6e65 7720  e we have a new 
-00049f70: 656e 7365 6d62 6c65 6420 795f 7072 6564  ensembled y_pred
-00049f80: 2c20 6d61 6b65 2073 7572 6520 6974 2069  , make sure it i
-00049f90: 7320 616e 2061 7272 6179 2062 6566 6f72  s an array befor
-00049fa0: 6520 7072 696e 7469 6e67 2069 7421 0d0a  e printing it!..
-00049fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049fc0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00049fd0: 6528 656e 7365 6d5f 7072 6564 2c70 642e  e(ensem_pred,pd.
-00049fe0: 5365 7269 6573 2920 6f72 2069 7369 6e73  Series) or isins
-00049ff0: 7461 6e63 6528 656e 7365 6d5f 7072 6564  tance(ensem_pred
-0004a000: 2c70 642e 4461 7461 4672 616d 6529 3a0d  ,pd.DataFrame):.
-0004a010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004a020: 2020 2020 2020 2020 2070 7269 6e74 5f72           print_r
-0004a030: 6567 7265 7373 696f 6e5f 6d6f 6465 6c5f  egression_model_
-0004a040: 7374 6174 7328 795f 6376 2c20 656e 7365  stats(y_cv, ense
-0004a050: 6d5f 7072 6564 2e76 616c 7565 732c 2074  m_pred.values, t
-0004a060: 6172 6765 742c 706c 6f74 5f6e 616d 653d  arget,plot_name=
-0004a070: 2745 6e73 656d 626c 6527 290d 0a20 2020  'Ensemble')..   
-0004a080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a090: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-0004a0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a0b0: 7072 696e 745f 7265 6772 6573 7369 6f6e  print_regression
-0004a0c0: 5f6d 6f64 656c 5f73 7461 7473 2879 5f63  _model_stats(y_c
-0004a0d0: 762c 2065 6e73 656d 5f70 7265 642c 2074  v, ensem_pred, t
-0004a0e0: 6172 6765 742c 2070 6c6f 745f 6e61 6d65  arget, plot_name
-0004a0f0: 3d27 456e 7365 6d62 6c65 2729 0d0a 2020  ='Ensemble')..  
-0004a100: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-0004a110: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
-0004a120: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0004a130: 2827 436f 756c 6420 6e6f 7420 636f 6d70  ('Could not comp
-0004a140: 6c65 7465 2045 6e73 656d 626c 696e 6720  lete Ensembling 
-0004a150: 7072 6564 6963 7469 6f6e 7320 6f6e 2068  predictions on h
-0004a160: 656c 6420 6f75 7420 6461 7461 2064 7565  eld out data due
-0004a170: 2074 6f20 4572 726f 7227 290d 0a20 2020   to Error')..   
-0004a180: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0004a190: 2020 2020 2020 2020 2323 2020 5468 6973          ##  This
-0004a1a0: 2069 7320 666f 7220 436c 6173 7369 6669   is for Classifi
-0004a1b0: 6361 7469 6f6e 2050 726f 626c 656d 7320  cation Problems 
-0004a1c0: 4f6e 6c79 2023 0d0a 2020 2020 2020 2020  Only #..        
-0004a1d0: 2020 2020 2323 2320 4669 6e64 2077 6861      ### Find wha
-0004a1e0: 7420 7468 6520 6f72 6465 7220 6f66 2062  t the order of b
-0004a1f0: 6573 7420 7061 7261 6d73 2061 7265 2061  est params are a
-0004a200: 6e64 2073 6574 2074 6865 2073 616d 6520  nd set the same 
-0004a210: 6173 2074 6865 206f 7269 6769 6e61 6c20  as the original 
-0004a220: 6d6f 6465 6c20 2323 230d 0a20 2020 2020  model ###..     
-0004a230: 2020 2020 2020 2023 2320 5468 6973 2069         ## This i
-0004a240: 7320 7768 6572 6520 7765 2073 6574 2074  s where we set t
-0004a250: 6865 2062 6573 7420 7061 7261 6d65 7465  he best paramete
-0004a260: 7273 2066 726f 6d20 7472 6169 6e69 6e67  rs from training
-0004a270: 2074 6f20 7468 6520 6d6f 6465 6c20 2323   to the model ##
-0004a280: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-0004a290: 6966 206e 6f74 2053 7461 636b 696e 675f  if not Stacking_
-0004a2a0: 466c 6167 2061 6e64 2058 5f74 7261 696e  Flag and X_train
-0004a2b0: 2e73 6861 7065 5b30 5d20 3c3d 2065 6e73  .shape[0] <= ens
-0004a2c0: 656d 626c 655f 6d61 785f 726f 7773 3a0d  emble_max_rows:.
-0004a2d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004a2e0: 2070 7269 6e74 2827 2323 2323 2323 2323   print('########
-0004a2f0: 2323 2323 2323 2323 2320 4520 4e20 5320  ######### E N S 
-0004a300: 4520 4d20 4220 4c20 4520 204d 204f 2044  E M B L E  M O D
-0004a310: 2045 204c 2020 2323 2323 2323 2323 2323   E L  ##########
-0004a320: 2323 2323 2323 2323 2729 0d0a 2020 2020  ########')..    
-0004a330: 2020 2020 2020 2020 2020 2020 2323 2323              ####
-0004a340: 2057 6520 646f 2045 6e73 656d 626c 696e   We do Ensemblin
-0004a350: 6720 6f6e 6c79 2069 6620 7468 6520 5374  g only if the St
-0004a360: 6163 6b69 6e67 5f46 6c61 6720 6973 2046  acking_Flag is F
-0004a370: 616c 7365 2e20 4f74 6865 7277 6973 652c  alse. Otherwise,
-0004a380: 2077 6520 646f 6e27 7421 0d0a 2020 2020   we don't!..    
-0004a390: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-0004a3a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004a3b0: 2020 2020 2020 636c 6173 7365 7320 3d20        classes = 
-0004a3c0: 6c61 6265 6c5f 6469 6374 5b65 6163 685f  label_dict[each_
-0004a3d0: 7461 7267 6574 5d5b 2763 6c61 7373 6573  target]['classes
-0004a3e0: 275d 0d0a 2020 2020 2020 2020 2020 2020  ']..            
-0004a3f0: 2020 2020 2020 2020 636f 6c73 203d 205b          cols = [
-0004a400: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-0004a410: 2020 2020 2020 2073 7562 6d20 3d20 7064         subm = pd
-0004a420: 2e44 6174 6146 7261 6d65 2829 0d0a 2020  .DataFrame()..  
-0004a430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a440: 2020 2323 2323 2054 6869 7320 6973 2066    #### This is f
-0004a450: 6f72 2045 6e73 656d 626c 696e 6720 204f  or Ensembling  O
-0004a460: 6e6c 7920 2323 2323 230d 0a20 2020 2020  nly #####..     
-0004a470: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0004a480: 6620 6c65 6e28 636c 6173 7365 7329 203d  f len(classes) =
-0004a490: 3d20 323a 0d0a 2020 2020 2020 2020 2020  = 2:..          
-0004a4a0: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0004a4b0: 6465 6c73 5f6c 6973 742c 2063 765f 656e  dels_list, cv_en
-0004a4c0: 7365 6d62 6c65 7320 3d20 5175 6963 6b4d  sembles = QuickM
-0004a4d0: 4c5f 456e 7365 6d62 6c69 6e67 2858 5f74  L_Ensembling(X_t
-0004a4e0: 7261 696e 2c20 795f 7472 6169 6e2c 2058  rain, y_train, X
-0004a4f0: 5f63 762c 2079 5f63 762c 0d0a 2020 2020  _cv, y_cv,..    
+00049f00: 2323 2323 2323 2323 2327 290d 0a20 2020  #########')..   
+00049f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049f20: 2070 6572 666f 726d 6564 5f65 6e73 656d   performed_ensem
+00049f30: 626c 696e 6720 3d20 5472 7565 0d0a 2020  bling = True..  
+00049f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049f50: 2020 2323 2323 2053 696e 6365 2077 6520    #### Since we 
+00049f60: 6861 7665 2061 206e 6577 2065 6e73 656d  have a new ensem
+00049f70: 626c 6564 2079 5f70 7265 642c 206d 616b  bled y_pred, mak
+00049f80: 6520 7375 7265 2069 7420 6973 2061 6e20  e sure it is an 
+00049f90: 6172 7261 7920 6265 666f 7265 2070 7269  array before pri
+00049fa0: 6e74 696e 6720 6974 210d 0a20 2020 2020  nting it!..     
+00049fb0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00049fc0: 6620 6973 696e 7374 616e 6365 2865 6e73  f isinstance(ens
+00049fd0: 656d 5f70 7265 642c 7064 2e53 6572 6965  em_pred,pd.Serie
+00049fe0: 7329 206f 7220 6973 696e 7374 616e 6365  s) or isinstance
+00049ff0: 2865 6e73 656d 5f70 7265 642c 7064 2e44  (ensem_pred,pd.D
+0004a000: 6174 6146 7261 6d65 293a 0d0a 2020 2020  ataFrame):..    
+0004a010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a020: 2020 2020 7072 696e 745f 7265 6772 6573      print_regres
+0004a030: 7369 6f6e 5f6d 6f64 656c 5f73 7461 7473  sion_model_stats
+0004a040: 2879 5f63 762c 2065 6e73 656d 5f70 7265  (y_cv, ensem_pre
+0004a050: 642e 7661 6c75 6573 2c20 7461 7267 6574  d.values, target
+0004a060: 2c70 6c6f 745f 6e61 6d65 3d27 456e 7365  ,plot_name='Ense
+0004a070: 6d62 6c65 2729 0d0a 2020 2020 2020 2020  mble')..        
+0004a080: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0004a090: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0004a0a0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0004a0b0: 5f72 6567 7265 7373 696f 6e5f 6d6f 6465  _regression_mode
+0004a0c0: 6c5f 7374 6174 7328 795f 6376 2c20 656e  l_stats(y_cv, en
+0004a0d0: 7365 6d5f 7072 6564 2c20 7461 7267 6574  sem_pred, target
+0004a0e0: 2c20 706c 6f74 5f6e 616d 653d 2745 6e73  , plot_name='Ens
+0004a0f0: 656d 626c 6527 290d 0a20 2020 2020 2020  emble')..       
+0004a100: 2020 2020 2020 2020 2065 7863 6570 743a           except:
+0004a110: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004a120: 2020 2020 2020 7072 696e 7428 2743 6f75        print('Cou
+0004a130: 6c64 206e 6f74 2063 6f6d 706c 6574 6520  ld not complete 
+0004a140: 456e 7365 6d62 6c69 6e67 2070 7265 6469  Ensembling predi
+0004a150: 6374 696f 6e73 206f 6e20 6865 6c64 206f  ctions on held o
+0004a160: 7574 2064 6174 6120 6475 6520 746f 2045  ut data due to E
+0004a170: 7272 6f72 2729 0d0a 2020 2020 2020 2020  rror')..        
+0004a180: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0004a190: 2020 2023 2320 2054 6869 7320 6973 2066     ##  This is f
+0004a1a0: 6f72 2043 6c61 7373 6966 6963 6174 696f  or Classificatio
+0004a1b0: 6e20 5072 6f62 6c65 6d73 204f 6e6c 7920  n Problems Only 
+0004a1c0: 230d 0a20 2020 2020 2020 2020 2020 2023  #..            #
+0004a1d0: 2323 2046 696e 6420 7768 6174 2074 6865  ## Find what the
+0004a1e0: 206f 7264 6572 206f 6620 6265 7374 2070   order of best p
+0004a1f0: 6172 616d 7320 6172 6520 616e 6420 7365  arams are and se
+0004a200: 7420 7468 6520 7361 6d65 2061 7320 7468  t the same as th
+0004a210: 6520 6f72 6967 696e 616c 206d 6f64 656c  e original model
+0004a220: 2023 2323 0d0a 2020 2020 2020 2020 2020   ###..          
+0004a230: 2020 2323 2054 6869 7320 6973 2077 6865    ## This is whe
+0004a240: 7265 2077 6520 7365 7420 7468 6520 6265  re we set the be
+0004a250: 7374 2070 6172 616d 6574 6572 7320 6672  st parameters fr
+0004a260: 6f6d 2074 7261 696e 696e 6720 746f 2074  om training to t
+0004a270: 6865 206d 6f64 656c 2023 2323 230d 0a20  he model ####.. 
+0004a280: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+0004a290: 7420 5374 6163 6b69 6e67 5f46 6c61 6720  t Stacking_Flag 
+0004a2a0: 616e 6420 585f 7472 6169 6e2e 7368 6170  and X_train.shap
+0004a2b0: 655b 305d 203c 3d20 656e 7365 6d62 6c65  e[0] <= ensemble
+0004a2c0: 5f6d 6178 5f72 6f77 733a 0d0a 2020 2020  _max_rows:..    
+0004a2d0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0004a2e0: 7428 2723 2323 2323 2323 2323 2323 2323  t('#############
+0004a2f0: 2323 2323 2045 204e 2053 2045 204d 2042  #### E N S E M B
+0004a300: 204c 2045 2020 4d20 4f20 4420 4520 4c20   L E  M O D E L 
+0004a310: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
+0004a320: 2323 2327 290d 0a20 2020 2020 2020 2020  ###')..         
+0004a330: 2020 2020 2020 2023 2323 2320 5765 2064         #### We d
+0004a340: 6f20 456e 7365 6d62 6c69 6e67 206f 6e6c  o Ensembling onl
+0004a350: 7920 6966 2074 6865 2053 7461 636b 696e  y if the Stackin
+0004a360: 675f 466c 6167 2069 7320 4661 6c73 652e  g_Flag is False.
+0004a370: 204f 7468 6572 7769 7365 2c20 7765 2064   Otherwise, we d
+0004a380: 6f6e 2774 210d 0a20 2020 2020 2020 2020  on't!..         
+0004a390: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+0004a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a3b0: 2063 6c61 7373 6573 203d 206c 6162 656c   classes = label
+0004a3c0: 5f64 6963 745b 6561 6368 5f74 6172 6765  _dict[each_targe
+0004a3d0: 745d 5b27 636c 6173 7365 7327 5d0d 0a20  t]['classes'].. 
+0004a3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a3f0: 2020 2063 6f6c 7320 3d20 5b5d 0d0a 2020     cols = []..  
+0004a400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a410: 2020 7375 626d 203d 2070 642e 4461 7461    subm = pd.Data
+0004a420: 4672 616d 6528 290d 0a20 2020 2020 2020  Frame()..       
+0004a430: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+0004a440: 2320 5468 6973 2069 7320 666f 7220 456e  # This is for En
+0004a450: 7365 6d62 6c69 6e67 2020 4f6e 6c79 2023  sembling  Only #
+0004a460: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
+0004a470: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+0004a480: 2863 6c61 7373 6573 2920 3d3d 2032 3a0d  (classes) == 2:.
+0004a490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004a4a0: 2020 2020 2020 2020 206d 6f64 656c 735f           models_
+0004a4b0: 6c69 7374 2c20 6376 5f65 6e73 656d 626c  list, cv_ensembl
+0004a4c0: 6573 203d 2051 7569 636b 4d4c 5f45 6e73  es = QuickML_Ens
+0004a4d0: 656d 626c 696e 6728 585f 7472 6169 6e2c  embling(X_train,
+0004a4e0: 2079 5f74 7261 696e 2c20 585f 6376 2c20   y_train, X_cv, 
+0004a4f0: 795f 6376 2c0d 0a20 2020 2020 2020 2020  y_cv,..         
 0004a500: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004a510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a520: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0004a530: 6465 6c74 7970 653d 2742 696e 6172 795f  deltype='Binary_
-0004a540: 436c 6173 7369 6669 6361 7469 6f6e 272c  Classification',
-0004a550: 2042 6f6f 7374 696e 675f 466c 6167 3d42   Boosting_Flag=B
-0004a560: 6f6f 7374 696e 675f 466c 6167 2c0d 0a20  oosting_Flag,.. 
+0004a520: 2020 2020 2020 2020 206d 6f64 656c 7479           modelty
+0004a530: 7065 3d27 4269 6e61 7279 5f43 6c61 7373  pe='Binary_Class
+0004a540: 6966 6963 6174 696f 6e27 2c20 426f 6f73  ification', Boos
+0004a550: 7469 6e67 5f46 6c61 673d 426f 6f73 7469  ting_Flag=Boosti
+0004a560: 6e67 5f46 6c61 672c 0d0a 2020 2020 2020  ng_Flag,..      
 0004a570: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004a580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a5a0: 2020 7363 6f72 696e 673d 2727 2c20 7665    scoring='', ve
-0004a5b0: 7262 6f73 653d 7665 7262 6f73 6529 0d0a  rbose=verbose)..
-0004a5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a5d0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0004a5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a5f0: 2020 206d 6f64 656c 735f 6c69 7374 2c20     models_list, 
-0004a600: 6376 5f65 6e73 656d 626c 6573 203d 2051  cv_ensembles = Q
-0004a610: 7569 636b 4d4c 5f45 6e73 656d 626c 696e  uickML_Ensemblin
-0004a620: 6728 585f 7472 6169 6e2c 2079 5f74 7261  g(X_train, y_tra
-0004a630: 696e 2c20 585f 6376 2c20 795f 6376 2c0d  in, X_cv, y_cv,.
-0004a640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004a590: 2020 2020 2020 2020 2020 2020 2073 636f               sco
+0004a5a0: 7269 6e67 3d27 272c 2076 6572 626f 7365  ring='', verbose
+0004a5b0: 3d76 6572 626f 7365 290d 0a20 2020 2020  =verbose)..     
+0004a5c0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0004a5d0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0004a5e0: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+0004a5f0: 6465 6c73 5f6c 6973 742c 2063 765f 656e  dels_list, cv_en
+0004a600: 7365 6d62 6c65 7320 3d20 5175 6963 6b4d  sembles = QuickM
+0004a610: 4c5f 456e 7365 6d62 6c69 6e67 2858 5f74  L_Ensembling(X_t
+0004a620: 7261 696e 2c20 795f 7472 6169 6e2c 2058  rain, y_train, X
+0004a630: 5f63 762c 2079 5f63 762c 0d0a 2020 2020  _cv, y_cv,..    
+0004a640: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004a650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a670: 2020 206d 6f64 656c 7479 7065 3d27 4d75     modeltype='Mu
-0004a680: 6c74 695f 436c 6173 7369 6669 6361 7469  lti_Classificati
-0004a690: 6f6e 272c 2042 6f6f 7374 696e 675f 466c  on', Boosting_Fl
-0004a6a0: 6167 3d42 6f6f 7374 696e 675f 466c 6167  ag=Boosting_Flag
-0004a6b0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0004a660: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+0004a670: 6465 6c74 7970 653d 274d 756c 7469 5f43  deltype='Multi_C
+0004a680: 6c61 7373 6966 6963 6174 696f 6e27 2c20  lassification', 
+0004a690: 426f 6f73 7469 6e67 5f46 6c61 673d 426f  Boosting_Flag=Bo
+0004a6a0: 6f73 7469 6e67 5f46 6c61 672c 0d0a 2020  osting_Flag,..  
+0004a6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004a6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004a6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a6e0: 2020 2020 2020 7363 6f72 696e 673d 2727        scoring=''
-0004a6f0: 2c20 7665 7262 6f73 653d 7665 7262 6f73  , verbose=verbos
-0004a700: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-0004a710: 2020 2020 2020 2020 6d6f 6465 6c73 5f6c          models_l
-0004a720: 6973 742e 6170 7065 6e64 286d 6f64 656c  ist.append(model
-0004a730: 5f6e 616d 6529 0d0a 2020 2020 2020 2020  _name)..        
-0004a740: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0004a750: 6d6f 6465 6c73 2c20 6561 6368 2069 6e20  models, each in 
-0004a760: 7a69 7028 6d6f 6465 6c73 5f6c 6973 742c  zip(models_list,
-0004a770: 2072 616e 6765 286c 656e 286d 6f64 656c   range(len(model
-0004a780: 735f 6c69 7374 2929 293a 0d0a 2020 2020  s_list))):..    
-0004a790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a7a0: 2020 2020 6e65 775f 636f 6c20 3d20 6561      new_col = ea
-0004a7b0: 6368 5f74 6172 6765 742b 275f 272b 6d6f  ch_target+'_'+mo
-0004a7c0: 6465 6c73 2b27 5f70 7265 6469 6374 696f  dels+'_predictio
-0004a7d0: 6e73 270d 0a20 2020 2020 2020 2020 2020  ns'..           
-0004a7e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0004a7f0: 6561 6368 2b31 203d 3d20 6c65 6e28 6d6f  each+1 == len(mo
-0004a800: 6465 6c73 5f6c 6973 7429 3a0d 0a20 2020  dels_list):..   
+0004a6e0: 2073 636f 7269 6e67 3d27 272c 2076 6572   scoring='', ver
+0004a6f0: 626f 7365 3d76 6572 626f 7365 290d 0a20  bose=verbose).. 
+0004a700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a710: 2020 206d 6f64 656c 735f 6c69 7374 2e61     models_list.a
+0004a720: 7070 656e 6428 6d6f 6465 6c5f 6e61 6d65  ppend(model_name
+0004a730: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0004a740: 2020 2020 2020 2066 6f72 206d 6f64 656c         for model
+0004a750: 732c 2065 6163 6820 696e 207a 6970 286d  s, each in zip(m
+0004a760: 6f64 656c 735f 6c69 7374 2c20 7261 6e67  odels_list, rang
+0004a770: 6528 6c65 6e28 6d6f 6465 6c73 5f6c 6973  e(len(models_lis
+0004a780: 7429 2929 3a0d 0a20 2020 2020 2020 2020  t))):..         
+0004a790: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0004a7a0: 6577 5f63 6f6c 203d 2065 6163 685f 7461  ew_col = each_ta
+0004a7b0: 7267 6574 2b27 5f27 2b6d 6f64 656c 732b  rget+'_'+models+
+0004a7c0: 275f 7072 6564 6963 7469 6f6e 7327 0d0a  '_predictions'..
+0004a7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a7e0: 2020 2020 2020 2020 6966 2065 6163 682b          if each+
+0004a7f0: 3120 3d3d 206c 656e 286d 6f64 656c 735f  1 == len(models_
+0004a800: 6c69 7374 293a 0d0a 2020 2020 2020 2020  list):..        
 0004a810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a820: 2020 2020 2020 2020 2073 7562 6d5b 6e65           subm[ne
-0004a830: 775f 636f 6c5d 203d 2079 5f70 7265 640d  w_col] = y_pred.
-0004a840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004a850: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0004a820: 2020 2020 7375 626d 5b6e 6577 5f63 6f6c      subm[new_col
+0004a830: 5d20 3d20 795f 7072 6564 0d0a 2020 2020  ] = y_pred..    
+0004a840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a850: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
 0004a860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a870: 2020 2020 2020 2020 2020 2020 7375 626d              subm
-0004a880: 5b6e 6577 5f63 6f6c 5d20 3d20 6376 5f65  [new_col] = cv_e
-0004a890: 6e73 656d 626c 6573 5b3a 2c65 6163 685d  nsembles[:,each]
-0004a8a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004a8b0: 2020 2020 2020 2020 2020 636f 6c73 2e61            cols.a
-0004a8c0: 7070 656e 6428 6e65 775f 636f 6c29 0d0a  ppend(new_col)..
-0004a8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a8e0: 2020 2020 7072 696e 7428 2723 2323 2323      print('#####
+0004a870: 2020 2020 2020 2073 7562 6d5b 6e65 775f         subm[new_
+0004a880: 636f 6c5d 203d 2063 765f 656e 7365 6d62  col] = cv_ensemb
+0004a890: 6c65 735b 3a2c 6561 6368 5d0d 0a20 2020  les[:,each]..   
+0004a8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a8b0: 2020 2020 2063 6f6c 732e 6170 7065 6e64       cols.append
+0004a8c0: 286e 6577 5f63 6f6c 290d 0a20 2020 2020  (new_col)..     
+0004a8d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0004a8e0: 7269 6e74 2827 2323 2323 2323 2323 2323  rint('##########
 0004a8f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004a900: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004a910: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004a920: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004a930: 2323 2323 2323 2323 2729 0d0a 2020 2020  ########')..    
-0004a940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004a950: 6966 206c 656e 2863 6f6c 7329 203d 3d20  if len(cols) == 
-0004a960: 353a 0d0a 2020 2020 2020 2020 2020 2020  5:..            
-0004a970: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0004a980: 7428 2720 2020 2044 6973 706c 6179 696e  t('    Displayin
-0004a990: 6720 7265 7375 6c74 7320 6f66 2077 6569  g results of wei
-0004a9a0: 6768 7465 6420 6176 6572 6167 6520 656e  ghted average en
-0004a9b0: 7365 6d62 6c65 206f 6620 2564 2063 6c61  semble of %d cla
-0004a9c0: 7373 6966 6965 7273 2720 256c 656e 2863  ssifiers' %len(c
-0004a9d0: 6f6c 7329 290d 0a20 2020 2020 2020 2020  ols))..         
-0004a9e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0004a9f0: 6e73 656d 5f70 7265 6420 3d20 6e70 2e72  nsem_pred = np.r
-0004aa00: 6f75 6e64 2873 7562 6d5b 636f 6c73 5b2d  ound(subm[cols[-
-0004aa10: 315d 5d2a 302e 352b 302e 3132 352a 2873  1]]*0.5+0.125*(s
-0004aa20: 7562 6d5b 636f 6c73 5b30 5d5d 2b73 7562  ubm[cols[0]]+sub
-0004aa30: 6d5b 0d0a 2020 2020 2020 2020 2020 2020  m[..            
+0004a930: 2323 2327 290d 0a20 2020 2020 2020 2020  ###')..         
+0004a940: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+0004a950: 6e28 636f 6c73 2920 3d3d 2035 3a0d 0a20  n(cols) == 5:.. 
+0004a960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a970: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+0004a980: 2020 4469 7370 6c61 7969 6e67 2072 6573    Displaying res
+0004a990: 756c 7473 206f 6620 7765 6967 6874 6564  ults of weighted
+0004a9a0: 2061 7665 7261 6765 2065 6e73 656d 626c   average ensembl
+0004a9b0: 6520 6f66 2025 6420 636c 6173 7369 6669  e of %d classifi
+0004a9c0: 6572 7327 2025 6c65 6e28 636f 6c73 2929  ers' %len(cols))
+0004a9d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004a9e0: 2020 2020 2020 2020 2020 656e 7365 6d5f            ensem_
+0004a9f0: 7072 6564 203d 206e 702e 726f 756e 6428  pred = np.round(
+0004aa00: 7375 626d 5b63 6f6c 735b 2d31 5d5d 2a30  subm[cols[-1]]*0
+0004aa10: 2e35 2b30 2e31 3235 2a28 7375 626d 5b63  .5+0.125*(subm[c
+0004aa20: 6f6c 735b 305d 5d2b 7375 626d 5b0d 0a20  ols[0]]+subm[.. 
+0004aa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004aa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004aa50: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
-0004aa60: 5b31 5d5d 2b73 7562 6d5b 636f 6c73 5b32  [1]]+subm[cols[2
-0004aa70: 5d5d 2b73 7562 6d5b 636f 6c73 5b33 5d5d  ]]+subm[cols[3]]
-0004aa80: 2929 2e61 7374 7970 6528 696e 7429 0d0a  )).astype(int)..
-0004aa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004aaa0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0004aab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004aac0: 2020 2070 7269 6e74 2827 2020 2020 4361     print('    Ca
-0004aad0: 6c63 756c 6174 696e 6720 7265 6775 6c61  lculating regula
-0004aae0: 7220 6176 6572 6167 6520 656e 7365 6d62  r average ensemb
-0004aaf0: 6c65 206f 6620 2564 2063 6c61 7373 6966  le of %d classif
-0004ab00: 6965 7273 2720 256c 656e 2863 6f6c 7329  iers' %len(cols)
-0004ab10: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0004ab20: 2020 2020 2020 2020 2020 2065 6e73 656d             ensem
-0004ab30: 5f70 7265 6420 3d20 2873 7562 6d5b 636f  _pred = (subm[co
-0004ab40: 6c73 5d2e 6d65 616e 2861 7869 733d 3129  ls].mean(axis=1)
-0004ab50: 292e 6173 7479 7065 2869 6e74 290d 0a20  ).astype(int).. 
-0004ab60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ab70: 2020 2070 6572 666f 726d 6564 5f65 6e73     performed_ens
-0004ab80: 656d 626c 696e 6720 3d20 5472 7565 0d0a  embling = True..
-0004ab90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004aba0: 2020 2020 2323 2323 2320 5468 6973 206e      ##### This n
-0004abb0: 6578 7420 7374 6570 2069 7320 7665 7279  ext step is very
-0004abc0: 2069 6d70 6f72 7461 6e74 2073 696e 6365   important since
-0004abd0: 2073 6f6d 6520 6d6f 6465 6c73 2067 6976   some models giv
-0004abe0: 6520 7365 7269 6573 2c20 6f74 6865 7273  e series, others
-0004abf0: 2067 6976 6520 6172 7261 7973 2e20 5665   give arrays. Ve
-0004ac00: 7279 2070 6169 6e66 756c 210d 0a20 2020  ry painful!..   
-0004ac10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ac20: 2069 6620 6973 696e 7374 616e 6365 2865   if isinstance(e
-0004ac30: 6e73 656d 5f70 7265 642c 7064 2e53 6572  nsem_pred,pd.Ser
-0004ac40: 6965 7329 3a0d 0a20 2020 2020 2020 2020  ies):..         
-0004ac50: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0004ac60: 6e73 656d 5f70 7265 6420 3d20 656e 7365  nsem_pred = ense
-0004ac70: 6d5f 7072 6564 2e76 616c 7565 730d 0a20  m_pred.values.. 
-0004ac80: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0004ac90: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
-0004aca0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0004acb0: 7428 2743 6f75 6c64 206e 6f74 2063 6f6d  t('Could not com
-0004acc0: 706c 6574 6520 456e 7365 6d62 6c69 6e67  plete Ensembling
-0004acd0: 2070 7265 6469 6374 696f 6e73 206f 6e20   predictions on 
-0004ace0: 6865 6c64 206f 7574 2064 6174 6120 6475  held out data du
-0004acf0: 6520 746f 2045 7272 6f72 2729 0d0a 2020  e to Error')..  
-0004ad00: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-0004ad10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004ad20: 2070 7269 6e74 2827 4e6f 2045 6e73 656d   print('No Ensem
-0004ad30: 626c 696e 6720 6f66 206d 6f64 656c 7320  bling of models 
-0004ad40: 646f 6e65 2073 696e 6365 2053 7461 636b  done since Stack
-0004ad50: 696e 675f 466c 6167 203d 2054 7275 6520  ing_Flag = True 
-0004ad60: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-0004ad70: 6966 2076 6572 626f 7365 203e 3d20 313a  if verbose >= 1:
-0004ad80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004ad90: 2020 6966 206c 656e 2863 6c61 7373 6573    if len(classes
-0004ada0: 2920 3d3d 2032 3a0d 0a20 2020 2020 2020  ) == 2:..       
-0004adb0: 2020 2020 2020 2020 2020 2020 2070 6c6f               plo
-0004adc0: 745f 636c 6173 7369 6669 6361 7469 6f6e  t_classification
-0004add0: 5f72 6573 756c 7473 286d 6f64 656c 2c58  _results(model,X
-0004ade0: 5f63 762c 2079 5f63 762c 2079 5f70 7265  _cv, y_cv, y_pre
-0004adf0: 642c 2063 6c61 7373 6573 2c20 636c 6173  d, classes, clas
-0004ae00: 735f 6e75 6d73 2c20 6561 6368 5f74 6172  s_nums, each_tar
-0004ae10: 6765 7420 290d 0a20 2020 2020 2020 2020  get )..         
-0004ae20: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0004ae30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ae40: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
-0004ae50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ae60: 4472 6177 5f52 4f43 5f4d 435f 4d4c 286d  Draw_ROC_MC_ML(m
-0004ae70: 6f64 656c 2c20 585f 6376 2c20 795f 6376  odel, X_cv, y_cv
-0004ae80: 2c20 6561 6368 5f74 6172 6765 742c 206d  , each_target, m
-0004ae90: 6f64 656c 5f6e 616d 652c 2076 6572 626f  odel_name, verbo
-0004aea0: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
-0004aeb0: 2020 2020 2020 2020 2020 2020 2044 7261               Dra
-0004aec0: 775f 4d43 5f4d 4c5f 5052 5f52 4f43 5f43  w_MC_ML_PR_ROC_C
-0004aed0: 7572 7665 7328 6d6f 6465 6c2c 585f 6376  urves(model,X_cv
-0004aee0: 2c79 5f63 7629 0d0a 2020 2020 2020 2020  ,y_cv)..        
-0004aef0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-0004af00: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
-0004af10: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-0004af20: 6e74 2827 436f 756c 6420 6e6f 7420 706c  nt('Could not pl
-0004af30: 6f74 2050 5220 616e 6420 524f 4320 6375  ot PR and ROC cu
-0004af40: 7276 6573 2e20 436f 6e74 696e 7569 6e67  rves. Continuing
-0004af50: 2e2e 2e27 290d 0a20 2020 2020 2020 2020  ...')..         
-0004af60: 2020 2023 2323 2320 496e 2063 6173 6520     #### In case 
-0004af70: 7468 6572 6520 6172 6520 7370 6563 6961  there are specia
-0004af80: 6c20 7363 6f72 696e 675f 7061 7261 6d65  l scoring_parame
-0004af90: 7465 7220 7265 7175 6573 7473 2c20 796f  ter requests, yo
-0004afa0: 7520 6361 6e20 7072 696e 7420 6974 2068  u can print it h
-0004afb0: 6572 6521 0d0a 2020 2020 2020 2020 2020  ere!..          
-0004afc0: 2020 6966 2073 636f 7269 6e67 5f70 6172    if scoring_par
-0004afd0: 616d 6574 6572 203d 3d20 2772 6f63 5f61  ameter == 'roc_a
-0004afe0: 7563 2720 6f72 2073 636f 7269 6e67 5f70  uc' or scoring_p
-0004aff0: 6172 616d 6574 6572 203d 3d20 2761 7563  arameter == 'auc
-0004b000: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
-0004b010: 2020 2020 6966 206c 656e 2863 6c61 7373      if len(class
-0004b020: 6573 2920 3d3d 2032 3a0d 0a20 2020 2020  es) == 2:..     
-0004b030: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0004b040: 7269 6e74 2827 2020 2020 524f 4320 4155  rint('    ROC AU
-0004b050: 4320 5363 6f72 6520 3d20 2530 2e31 6625  C Score = %0.1f%
-0004b060: 2527 2025 2872 6f63 5f61 7563 5f73 636f  %' %(roc_auc_sco
-0004b070: 7265 2879 5f63 762c 2079 5f70 726f 6261  re(y_cv, y_proba
-0004b080: 5b3a 2c72 6172 655f 636c 6173 735d 292a  [:,rare_class])*
-0004b090: 3130 3029 290d 0a20 2020 2020 2020 2020  100))..         
-0004b0a0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0004b0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b0c0: 2020 7072 696e 7428 2720 2020 204e 6f20    print('    No 
-0004b0d0: 524f 4320 4155 4320 7363 6f72 6520 666f  ROC AUC score fo
-0004b0e0: 7220 6d75 6c74 692d 636c 6173 7320 7072  r multi-class pr
-0004b0f0: 6f62 6c65 6d73 2729 0d0a 2020 2020 2020  oblems')..      
-0004b100: 2020 6966 206e 6f74 2053 7461 636b 696e    if not Stackin
-0004b110: 675f 466c 6167 2061 6e64 2070 6572 666f  g_Flag and perfo
-0004b120: 726d 6564 5f65 6e73 656d 626c 696e 673a  rmed_ensembling:
-0004b130: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0004b140: 206d 6f64 656c 7479 7065 203d 3d20 2752   modeltype == 'R
-0004b150: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
-0004b160: 2020 2020 2020 2020 2020 2020 2072 6d73               rms
-0004b170: 6c65 5f63 616c 6375 6c61 7465 645f 6620  le_calculated_f 
-0004b180: 3d20 726d 7365 2879 5f63 762c 2065 6e73  = rmse(y_cv, ens
-0004b190: 656d 5f70 7265 6429 0d0a 2020 2020 2020  em_pred)..      
-0004b1a0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0004b1b0: 2741 6674 6572 206d 756c 7469 706c 6520  'After multiple 
-0004b1c0: 6d6f 6465 6c73 2c20 456e 7365 6d62 6c65  models, Ensemble
-0004b1d0: 204d 6f64 656c 2052 6573 756c 7473 3a27   Model Results:'
-0004b1e0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0004b1f0: 2020 2070 7269 6e74 2827 2020 2020 524d     print('    RM
-0004b200: 5345 2053 636f 7265 203d 2025 302e 3566  SE Score = %0.5f
-0004b210: 2720 2528 726d 736c 655f 6361 6c63 756c  ' %(rmsle_calcul
-0004b220: 6174 6564 5f66 2c29 290d 0a20 2020 2020  ated_f,))..     
-0004b230: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0004b240: 2827 2323 2323 2323 2323 2323 2323 2323  ('##############
+0004aa50: 2020 2020 2020 2063 6f6c 735b 315d 5d2b         cols[1]]+
+0004aa60: 7375 626d 5b63 6f6c 735b 325d 5d2b 7375  subm[cols[2]]+su
+0004aa70: 626d 5b63 6f6c 735b 335d 5d29 292e 6173  bm[cols[3]])).as
+0004aa80: 7479 7065 2869 6e74 290d 0a20 2020 2020  type(int)..     
+0004aa90: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0004aaa0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0004aab0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0004aac0: 696e 7428 2720 2020 2043 616c 6375 6c61  int('    Calcula
+0004aad0: 7469 6e67 2072 6567 756c 6172 2061 7665  ting regular ave
+0004aae0: 7261 6765 2065 6e73 656d 626c 6520 6f66  rage ensemble of
+0004aaf0: 2025 6420 636c 6173 7369 6669 6572 7327   %d classifiers'
+0004ab00: 2025 6c65 6e28 636f 6c73 2929 0d0a 2020   %len(cols))..  
+0004ab10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ab20: 2020 2020 2020 656e 7365 6d5f 7072 6564        ensem_pred
+0004ab30: 203d 2028 7375 626d 5b63 6f6c 735d 2e6d   = (subm[cols].m
+0004ab40: 6561 6e28 6178 6973 3d31 2929 2e61 7374  ean(axis=1)).ast
+0004ab50: 7970 6528 696e 7429 0d0a 2020 2020 2020  ype(int)..      
+0004ab60: 2020 2020 2020 2020 2020 2020 2020 7065                pe
+0004ab70: 7266 6f72 6d65 645f 656e 7365 6d62 6c69  rformed_ensembli
+0004ab80: 6e67 203d 2054 7275 650d 0a20 2020 2020  ng = True..     
+0004ab90: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0004aba0: 2323 2323 2054 6869 7320 6e65 7874 2073  #### This next s
+0004abb0: 7465 7020 6973 2076 6572 7920 696d 706f  tep is very impo
+0004abc0: 7274 616e 7420 7369 6e63 6520 736f 6d65  rtant since some
+0004abd0: 206d 6f64 656c 7320 6769 7665 2073 6572   models give ser
+0004abe0: 6965 732c 206f 7468 6572 7320 6769 7665  ies, others give
+0004abf0: 2061 7272 6179 732e 2056 6572 7920 7061   arrays. Very pa
+0004ac00: 696e 6675 6c21 0d0a 2020 2020 2020 2020  inful!..        
+0004ac10: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0004ac20: 7369 6e73 7461 6e63 6528 656e 7365 6d5f  sinstance(ensem_
+0004ac30: 7072 6564 2c70 642e 5365 7269 6573 293a  pred,pd.Series):
+0004ac40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004ac50: 2020 2020 2020 2020 2020 656e 7365 6d5f            ensem_
+0004ac60: 7072 6564 203d 2065 6e73 656d 5f70 7265  pred = ensem_pre
+0004ac70: 642e 7661 6c75 6573 0d0a 2020 2020 2020  d.values..      
+0004ac80: 2020 2020 2020 2020 2020 6578 6365 7074            except
+0004ac90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0004aca0: 2020 2020 2020 2070 7269 6e74 2827 436f         print('Co
+0004acb0: 756c 6420 6e6f 7420 636f 6d70 6c65 7465  uld not complete
+0004acc0: 2045 6e73 656d 626c 696e 6720 7072 6564   Ensembling pred
+0004acd0: 6963 7469 6f6e 7320 6f6e 2068 656c 6420  ictions on held 
+0004ace0: 6f75 7420 6461 7461 2064 7565 2074 6f20  out data due to 
+0004acf0: 4572 726f 7227 290d 0a20 2020 2020 2020  Error')..       
+0004ad00: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0004ad10: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0004ad20: 7428 274e 6f20 456e 7365 6d62 6c69 6e67  t('No Ensembling
+0004ad30: 206f 6620 6d6f 6465 6c73 2064 6f6e 6520   of models done 
+0004ad40: 7369 6e63 6520 5374 6163 6b69 6e67 5f46  since Stacking_F
+0004ad50: 6c61 6720 3d20 5472 7565 2027 290d 0a20  lag = True ').. 
+0004ad60: 2020 2020 2020 2020 2020 2069 6620 7665             if ve
+0004ad70: 7262 6f73 6520 3e3d 2031 3a0d 0a20 2020  rbose >= 1:..   
+0004ad80: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0004ad90: 6c65 6e28 636c 6173 7365 7329 203d 3d20  len(classes) == 
+0004ada0: 323a 0d0a 2020 2020 2020 2020 2020 2020  2:..            
+0004adb0: 2020 2020 2020 2020 706c 6f74 5f63 6c61          plot_cla
+0004adc0: 7373 6966 6963 6174 696f 6e5f 7265 7375  ssification_resu
+0004add0: 6c74 7328 6d6f 6465 6c2c 585f 6376 2c20  lts(model,X_cv, 
+0004ade0: 795f 6376 2c20 795f 7072 6564 2c20 636c  y_cv, y_pred, cl
+0004adf0: 6173 7365 732c 2063 6c61 7373 5f6e 756d  asses, class_num
+0004ae00: 732c 2065 6163 685f 7461 7267 6574 2029  s, each_target )
+0004ae10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004ae20: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0004ae30: 2020 2020 2020 2020 2020 2020 2074 7279               try
+0004ae40: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0004ae50: 2020 2020 2020 2020 2020 2044 7261 775f             Draw_
+0004ae60: 524f 435f 4d43 5f4d 4c28 6d6f 6465 6c2c  ROC_MC_ML(model,
+0004ae70: 2058 5f63 762c 2079 5f63 762c 2065 6163   X_cv, y_cv, eac
+0004ae80: 685f 7461 7267 6574 2c20 6d6f 6465 6c5f  h_target, model_
+0004ae90: 6e61 6d65 2c20 7665 7262 6f73 6529 0d0a  name, verbose)..
+0004aea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004aeb0: 2020 2020 2020 2020 4472 6177 5f4d 435f          Draw_MC_
+0004aec0: 4d4c 5f50 525f 524f 435f 4375 7276 6573  ML_PR_ROC_Curves
+0004aed0: 286d 6f64 656c 2c58 5f63 762c 795f 6376  (model,X_cv,y_cv
+0004aee0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+0004aef0: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
+0004af00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004af10: 2020 2020 2020 2020 7072 696e 7428 2743          print('C
+0004af20: 6f75 6c64 206e 6f74 2070 6c6f 7420 5052  ould not plot PR
+0004af30: 2061 6e64 2052 4f43 2063 7572 7665 732e   and ROC curves.
+0004af40: 2043 6f6e 7469 6e75 696e 672e 2e2e 2729   Continuing...')
+0004af50: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+0004af60: 2323 2049 6e20 6361 7365 2074 6865 7265  ## In case there
+0004af70: 2061 7265 2073 7065 6369 616c 2073 636f   are special sco
+0004af80: 7269 6e67 5f70 6172 616d 6574 6572 2072  ring_parameter r
+0004af90: 6571 7565 7374 732c 2079 6f75 2063 616e  equests, you can
+0004afa0: 2070 7269 6e74 2069 7420 6865 7265 210d   print it here!.
+0004afb0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0004afc0: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
+0004afd0: 7220 3d3d 2027 726f 635f 6175 6327 206f  r == 'roc_auc' o
+0004afe0: 7220 7363 6f72 696e 675f 7061 7261 6d65  r scoring_parame
+0004aff0: 7465 7220 3d3d 2027 6175 6327 3a0d 0a20  ter == 'auc':.. 
+0004b000: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0004b010: 6620 6c65 6e28 636c 6173 7365 7329 203d  f len(classes) =
+0004b020: 3d20 323a 0d0a 2020 2020 2020 2020 2020  = 2:..          
+0004b030: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0004b040: 2720 2020 2052 4f43 2041 5543 2053 636f  '    ROC AUC Sco
+0004b050: 7265 203d 2025 302e 3166 2525 2720 2528  re = %0.1f%%' %(
+0004b060: 726f 635f 6175 635f 7363 6f72 6528 795f  roc_auc_score(y_
+0004b070: 6376 2c20 795f 7072 6f62 615b 3a2c 7261  cv, y_proba[:,ra
+0004b080: 7265 5f63 6c61 7373 5d29 2a31 3030 2929  re_class])*100))
+0004b090: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004b0a0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0004b0b0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+0004b0c0: 6e74 2827 2020 2020 4e6f 2052 4f43 2041  nt('    No ROC A
+0004b0d0: 5543 2073 636f 7265 2066 6f72 206d 756c  UC score for mul
+0004b0e0: 7469 2d63 6c61 7373 2070 726f 626c 656d  ti-class problem
+0004b0f0: 7327 290d 0a20 2020 2020 2020 2069 6620  s')..        if 
+0004b100: 6e6f 7420 5374 6163 6b69 6e67 5f46 6c61  not Stacking_Fla
+0004b110: 6720 616e 6420 7065 7266 6f72 6d65 645f  g and performed_
+0004b120: 656e 7365 6d62 6c69 6e67 3a0d 0a20 2020  ensembling:..   
+0004b130: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
+0004b140: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
+0004b150: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
+0004b160: 2020 2020 2020 2020 726d 736c 655f 6361          rmsle_ca
+0004b170: 6c63 756c 6174 6564 5f66 203d 2072 6d73  lculated_f = rms
+0004b180: 6528 795f 6376 2c20 656e 7365 6d5f 7072  e(y_cv, ensem_pr
+0004b190: 6564 290d 0a20 2020 2020 2020 2020 2020  ed)..           
+0004b1a0: 2020 2020 2070 7269 6e74 2827 4166 7465       print('Afte
+0004b1b0: 7220 6d75 6c74 6970 6c65 206d 6f64 656c  r multiple model
+0004b1c0: 732c 2045 6e73 656d 626c 6520 4d6f 6465  s, Ensemble Mode
+0004b1d0: 6c20 5265 7375 6c74 733a 2729 0d0a 2020  l Results:')..  
+0004b1e0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0004b1f0: 696e 7428 2720 2020 2052 4d53 4520 5363  int('    RMSE Sc
+0004b200: 6f72 6520 3d20 2530 2e35 6627 2025 2872  ore = %0.5f' %(r
+0004b210: 6d73 6c65 5f63 616c 6375 6c61 7465 645f  msle_calculated_
+0004b220: 662c 2929 0d0a 2020 2020 2020 2020 2020  f,))..          
+0004b230: 2020 2020 2020 7072 696e 7428 2723 2323        print('###
+0004b240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004b250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004b260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004b270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b280: 2323 2323 2323 2323 2323 2323 2323 2327  ###############'
-0004b290: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0004b2a0: 2020 2069 6620 726d 736c 655f 6361 6c63     if rmsle_calc
-0004b2b0: 756c 6174 6564 5f66 203c 2072 6d73 6c65  ulated_f < rmsle
-0004b2c0: 5f63 616c 6375 6c61 7465 645f 6d3a 0d0a  _calculated_m:..
-0004b2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b2e0: 2020 2020 7072 696e 7428 2745 6e73 656d      print('Ensem
-0004b2f0: 626c 696e 6720 4d6f 6465 6c73 2069 7320  bling Models is 
-0004b300: 6265 7474 6572 2074 6861 6e20 5369 6e67  better than Sing
-0004b310: 6c65 204d 6f64 656c 2066 6f72 2074 6869  le Model for thi
-0004b320: 7320 6461 7461 2073 6574 2e27 290d 0a20  s data set.').. 
-0004b330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b340: 2020 2065 7272 6f72 5f72 6174 652e 6170     error_rate.ap
-0004b350: 7065 6e64 2872 6d73 6c65 5f63 616c 6375  pend(rmsle_calcu
-0004b360: 6c61 7465 645f 6629 0d0a 2020 2020 2020  lated_f)..      
-0004b370: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-0004b380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004b390: 2020 2020 2070 7269 6e74 2827 5369 6e67       print('Sing
-0004b3a0: 6c65 204d 6f64 656c 2069 7320 6265 7474  le Model is bett
-0004b3b0: 6572 2074 6861 6e20 456e 7365 6d62 6c69  er than Ensembli
-0004b3c0: 6e67 204d 6f64 656c 7320 666f 7220 7468  ng Models for th
-0004b3d0: 6973 2064 6174 6120 7365 742e 2729 0d0a  is data set.')..
-0004b3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b3f0: 2020 2020 6572 726f 725f 7261 7465 2e61      error_rate.a
-0004b400: 7070 656e 6428 726d 736c 655f 6361 6c63  ppend(rmsle_calc
-0004b410: 756c 6174 6564 5f6d 290d 0a20 2020 2020  ulated_m)..     
-0004b420: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0004b430: 2020 2020 2020 2020 2020 2020 2020 726d                rm
-0004b440: 736c 655f 6361 6c63 756c 6174 6564 5f66  sle_calculated_f
-0004b450: 203d 2062 616c 616e 6365 645f 6163 6375   = balanced_accu
-0004b460: 7261 6379 5f73 636f 7265 2879 5f63 762c  racy_score(y_cv,
-0004b470: 656e 7365 6d5f 7072 6564 290d 0a20 2020  ensem_pred)..   
-0004b480: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-0004b490: 6e74 2827 4166 7465 7220 6d75 6c74 6970  nt('After multip
-0004b4a0: 6c65 206d 6f64 656c 732c 2045 6e73 656d  le models, Ensem
-0004b4b0: 626c 6520 4d6f 6465 6c20 5265 7375 6c74  ble Model Result
-0004b4c0: 733a 2729 0d0a 2020 2020 2020 2020 2020  s:')..          
-0004b4d0: 2020 2020 2020 7261 7265 5f70 6374 203d        rare_pct =
-0004b4e0: 2079 5f63 765b 795f 6376 3d3d 7261 7265   y_cv[y_cv==rare
-0004b4f0: 5f63 6c61 7373 5d2e 7368 6170 655b 305d  _class].shape[0]
-0004b500: 2f79 5f63 762e 7368 6170 655b 305d 0d0a  /y_cv.shape[0]..
-0004b510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b520: 2370 7269 6e74 2827 2020 2020 4261 6c61  #print('    Bala
-0004b530: 6e63 6564 2041 6363 7572 6163 7920 5363  nced Accuracy Sc
-0004b540: 6f72 6520 3d20 2530 2e33 6625 2527 2025  ore = %0.3f%%' %
-0004b550: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-0004b560: 2020 2023 2020 2020 2020 2020 726d 736c     #        rmsl
-0004b570: 655f 6361 6c63 756c 6174 6564 5f66 2a31  e_calculated_f*1
-0004b580: 3030 2929 0d0a 2020 2020 2020 2020 2020  00))..          
-0004b590: 2020 2020 2020 7072 696e 745f 636c 6173        print_clas
-0004b5a0: 7369 6669 6361 7469 6f6e 5f6d 6574 7269  sification_metri
-0004b5b0: 6373 2879 5f63 762c 2065 6e73 656d 5f70  cs(y_cv, ensem_p
-0004b5c0: 7265 642c 2046 616c 7365 290d 0a20 2020  red, False)..   
-0004b5d0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-0004b5e0: 6e74 2863 6c61 7373 6966 6963 6174 696f  nt(classificatio
-0004b5f0: 6e5f 7265 706f 7274 2879 5f63 762c 656e  n_report(y_cv,en
-0004b600: 7365 6d5f 7072 6564 2929 0d0a 2020 2020  sem_pred))..    
-0004b610: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0004b620: 7428 636f 6e66 7573 696f 6e5f 6d61 7472  t(confusion_matr
-0004b630: 6978 2879 5f63 762c 656e 7365 6d5f 7072  ix(y_cv,ensem_pr
-0004b640: 6564 2929 0d0a 2020 2020 2020 2020 2020  ed))..          
-0004b650: 2020 2020 2020 7072 696e 7428 2723 2323        print('###
+0004b280: 2323 2323 2323 2323 2323 2729 0d0a 2020  ##########')..  
+0004b290: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0004b2a0: 2072 6d73 6c65 5f63 616c 6375 6c61 7465   rmsle_calculate
+0004b2b0: 645f 6620 3c20 726d 736c 655f 6361 6c63  d_f < rmsle_calc
+0004b2c0: 756c 6174 6564 5f6d 3a0d 0a20 2020 2020  ulated_m:..     
+0004b2d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0004b2e0: 7269 6e74 2827 456e 7365 6d62 6c69 6e67  rint('Ensembling
+0004b2f0: 204d 6f64 656c 7320 6973 2062 6574 7465   Models is bette
+0004b300: 7220 7468 616e 2053 696e 676c 6520 4d6f  r than Single Mo
+0004b310: 6465 6c20 666f 7220 7468 6973 2064 6174  del for this dat
+0004b320: 6120 7365 742e 2729 0d0a 2020 2020 2020  a set.')..      
+0004b330: 2020 2020 2020 2020 2020 2020 2020 6572                er
+0004b340: 726f 725f 7261 7465 2e61 7070 656e 6428  ror_rate.append(
+0004b350: 726d 736c 655f 6361 6c63 756c 6174 6564  rmsle_calculated
+0004b360: 5f66 290d 0a20 2020 2020 2020 2020 2020  _f)..           
+0004b370: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+0004b380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004b390: 7072 696e 7428 2753 696e 676c 6520 4d6f  print('Single Mo
+0004b3a0: 6465 6c20 6973 2062 6574 7465 7220 7468  del is better th
+0004b3b0: 616e 2045 6e73 656d 626c 696e 6720 4d6f  an Ensembling Mo
+0004b3c0: 6465 6c73 2066 6f72 2074 6869 7320 6461  dels for this da
+0004b3d0: 7461 2073 6574 2e27 290d 0a20 2020 2020  ta set.')..     
+0004b3e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0004b3f0: 7272 6f72 5f72 6174 652e 6170 7065 6e64  rror_rate.append
+0004b400: 2872 6d73 6c65 5f63 616c 6375 6c61 7465  (rmsle_calculate
+0004b410: 645f 6d29 0d0a 2020 2020 2020 2020 2020  d_m)..          
+0004b420: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0004b430: 2020 2020 2020 2020 2072 6d73 6c65 5f63           rmsle_c
+0004b440: 616c 6375 6c61 7465 645f 6620 3d20 6261  alculated_f = ba
+0004b450: 6c61 6e63 6564 5f61 6363 7572 6163 795f  lanced_accuracy_
+0004b460: 7363 6f72 6528 795f 6376 2c65 6e73 656d  score(y_cv,ensem
+0004b470: 5f70 7265 6429 0d0a 2020 2020 2020 2020  _pred)..        
+0004b480: 2020 2020 2020 2020 7072 696e 7428 2741          print('A
+0004b490: 6674 6572 206d 756c 7469 706c 6520 6d6f  fter multiple mo
+0004b4a0: 6465 6c73 2c20 456e 7365 6d62 6c65 204d  dels, Ensemble M
+0004b4b0: 6f64 656c 2052 6573 756c 7473 3a27 290d  odel Results:').
+0004b4c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004b4d0: 2072 6172 655f 7063 7420 3d20 795f 6376   rare_pct = y_cv
+0004b4e0: 5b79 5f63 763d 3d72 6172 655f 636c 6173  [y_cv==rare_clas
+0004b4f0: 735d 2e73 6861 7065 5b30 5d2f 795f 6376  s].shape[0]/y_cv
+0004b500: 2e73 6861 7065 5b30 5d0d 0a20 2020 2020  .shape[0]..     
+0004b510: 2020 2020 2020 2020 2020 2023 7072 696e             #prin
+0004b520: 7428 2720 2020 2042 616c 616e 6365 6420  t('    Balanced 
+0004b530: 4163 6375 7261 6379 2053 636f 7265 203d  Accuracy Score =
+0004b540: 2025 302e 3366 2525 2720 2528 0d0a 2020   %0.3f%%' %(..  
+0004b550: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0004b560: 2020 2020 2020 2072 6d73 6c65 5f63 616c         rmsle_cal
+0004b570: 6375 6c61 7465 645f 662a 3130 3029 290d  culated_f*100)).
+0004b580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004b590: 2070 7269 6e74 5f63 6c61 7373 6966 6963   print_classific
+0004b5a0: 6174 696f 6e5f 6d65 7472 6963 7328 795f  ation_metrics(y_
+0004b5b0: 6376 2c20 656e 7365 6d5f 7072 6564 2c20  cv, ensem_pred, 
+0004b5c0: 4661 6c73 6529 0d0a 2020 2020 2020 2020  False)..        
+0004b5d0: 2020 2020 2020 2020 7072 696e 7428 636c          print(cl
+0004b5e0: 6173 7369 6669 6361 7469 6f6e 5f72 6570  assification_rep
+0004b5f0: 6f72 7428 795f 6376 2c65 6e73 656d 5f70  ort(y_cv,ensem_p
+0004b600: 7265 6429 290d 0a20 2020 2020 2020 2020  red))..         
+0004b610: 2020 2020 2020 2070 7269 6e74 2863 6f6e         print(con
+0004b620: 6675 7369 6f6e 5f6d 6174 7269 7828 795f  fusion_matrix(y_
+0004b630: 6376 2c65 6e73 656d 5f70 7265 6429 290d  cv,ensem_pred)).
+0004b640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004b650: 2070 7269 6e74 2827 2323 2323 2323 2323   print('########
 0004b660: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004b670: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004b680: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004b690: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b6a0: 2323 2323 2323 2323 2323 2729 0d0a 2020  ##########')..  
-0004b6b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0004b6c0: 2072 6d73 6c65 5f63 616c 6375 6c61 7465   rmsle_calculate
-0004b6d0: 645f 6620 3e20 726d 736c 655f 6361 6c63  d_f > rmsle_calc
-0004b6e0: 756c 6174 6564 5f6d 3a0d 0a20 2020 2020  ulated_m:..     
-0004b6f0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0004b700: 7269 6e74 2827 456e 7365 6d62 6c69 6e67  rint('Ensembling
-0004b710: 204d 6f64 656c 7320 6973 2062 6574 7465   Models is bette
-0004b720: 7220 7468 616e 2053 696e 676c 6520 4d6f  r than Single Mo
-0004b730: 6465 6c20 666f 7220 7468 6973 2064 6174  del for this dat
-0004b740: 6120 7365 742e 2729 0d0a 2020 2020 2020  a set.')..      
-0004b750: 2020 2020 2020 2020 2020 2020 2020 6572                er
-0004b760: 726f 725f 7261 7465 2e61 7070 656e 6428  ror_rate.append(
-0004b770: 726d 736c 655f 6361 6c63 756c 6174 6564  rmsle_calculated
-0004b780: 5f66 290d 0a20 2020 2020 2020 2020 2020  _f)..           
-0004b790: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0004b7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b7b0: 7072 696e 7428 2753 696e 676c 6520 4d6f  print('Single Mo
-0004b7c0: 6465 6c20 6973 2062 6574 7465 7220 7468  del is better th
-0004b7d0: 616e 2045 6e73 656d 626c 696e 6720 4d6f  an Ensembling Mo
-0004b7e0: 6465 6c73 2066 6f72 2074 6869 7320 6461  dels for this da
-0004b7f0: 7461 2073 6574 2e27 290d 0a20 2020 2020  ta set.')..     
-0004b800: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0004b810: 7272 6f72 5f72 6174 652e 6170 7065 6e64  rror_rate.append
-0004b820: 2872 6d73 6c65 5f63 616c 6375 6c61 7465  (rmsle_calculate
-0004b830: 645f 6d29 0d0a 2020 2020 2020 2020 6966  d_m)..        if
-0004b840: 2076 6572 626f 7365 203e 3d20 313a 0d0a   verbose >= 1:..
-0004b850: 2020 2020 2020 2020 2020 2020 6966 2042              if B
-0004b860: 6f6f 7374 696e 675f 466c 6167 3a0d 0a20  oosting_Flag:.. 
-0004b870: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0004b880: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
-0004b890: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
-0004b8a0: 6c5f 6e61 6d65 2e6c 6f77 6572 2829 203d  l_name.lower() =
-0004b8b0: 3d20 2763 6174 626f 6f73 7427 3a0d 0a20  = 'catboost':.. 
+0004b6a0: 2323 2323 2327 290d 0a20 2020 2020 2020  #####')..       
+0004b6b0: 2020 2020 2020 2020 2069 6620 726d 736c           if rmsl
+0004b6c0: 655f 6361 6c63 756c 6174 6564 5f66 203e  e_calculated_f >
+0004b6d0: 2072 6d73 6c65 5f63 616c 6375 6c61 7465   rmsle_calculate
+0004b6e0: 645f 6d3a 0d0a 2020 2020 2020 2020 2020  d_m:..          
+0004b6f0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0004b700: 2745 6e73 656d 626c 696e 6720 4d6f 6465  'Ensembling Mode
+0004b710: 6c73 2069 7320 6265 7474 6572 2074 6861  ls is better tha
+0004b720: 6e20 5369 6e67 6c65 204d 6f64 656c 2066  n Single Model f
+0004b730: 6f72 2074 6869 7320 6461 7461 2073 6574  or this data set
+0004b740: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
+0004b750: 2020 2020 2020 2020 2065 7272 6f72 5f72           error_r
+0004b760: 6174 652e 6170 7065 6e64 2872 6d73 6c65  ate.append(rmsle
+0004b770: 5f63 616c 6375 6c61 7465 645f 6629 0d0a  _calculated_f)..
+0004b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004b790: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0004b7a0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0004b7b0: 2827 5369 6e67 6c65 204d 6f64 656c 2069  ('Single Model i
+0004b7c0: 7320 6265 7474 6572 2074 6861 6e20 456e  s better than En
+0004b7d0: 7365 6d62 6c69 6e67 204d 6f64 656c 7320  sembling Models 
+0004b7e0: 666f 7220 7468 6973 2064 6174 6120 7365  for this data se
+0004b7f0: 742e 2729 0d0a 2020 2020 2020 2020 2020  t.')..          
+0004b800: 2020 2020 2020 2020 2020 6572 726f 725f            error_
+0004b810: 7261 7465 2e61 7070 656e 6428 726d 736c  rate.append(rmsl
+0004b820: 655f 6361 6c63 756c 6174 6564 5f6d 290d  e_calculated_m).
+0004b830: 0a20 2020 2020 2020 2069 6620 7665 7262  .        if verb
+0004b840: 6f73 6520 3e3d 2031 3a0d 0a20 2020 2020  ose >= 1:..     
+0004b850: 2020 2020 2020 2069 6620 426f 6f73 7469         if Boosti
+0004b860: 6e67 5f46 6c61 673a 0d0a 2020 2020 2020  ng_Flag:..      
+0004b870: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
+0004b880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004b890: 2020 2020 6966 206d 6f64 656c 5f6e 616d      if model_nam
+0004b8a0: 652e 6c6f 7765 7228 2920 3d3d 2027 6361  e.lower() == 'ca
+0004b8b0: 7462 6f6f 7374 273a 0d0a 2020 2020 2020  tboost':..      
 0004b8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b8d0: 2020 2020 2020 2070 6c6f 745f 7867 625f         plot_xgb_
-0004b8e0: 6d65 7472 6963 7328 6d6f 6465 6c2c 6361  metrics(model,ca
-0004b8f0: 7462 6f6f 7374 5f73 636f 7269 6e67 2c65  tboost_scoring,e
-0004b900: 7661 6c5f 7365 742c 6d6f 6465 6c74 7970  val_set,modeltyp
-0004b910: 652c 2725 7320 5265 7375 6c74 7327 2025  e,'%s Results' %
-0004b920: 6561 6368 5f74 6172 6765 742c 0d0a 2020  each_target,..  
+0004b8d0: 2020 706c 6f74 5f78 6762 5f6d 6574 7269    plot_xgb_metri
+0004b8e0: 6373 286d 6f64 656c 2c63 6174 626f 6f73  cs(model,catboos
+0004b8f0: 745f 7363 6f72 696e 672c 6576 616c 5f73  t_scoring,eval_s
+0004b900: 6574 2c6d 6f64 656c 7479 7065 2c27 2573  et,modeltype,'%s
+0004b910: 2052 6573 756c 7473 2720 2565 6163 685f   Results' %each_
+0004b920: 7461 7267 6574 2c0d 0a20 2020 2020 2020  target,..       
 0004b930: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004b940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b950: 2020 2020 2020 6d6f 6465 6c5f 6e61 6d65        model_name
-0004b960: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0004b970: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0004b950: 206d 6f64 656c 5f6e 616d 6529 0d0a 2020   model_name)..  
+0004b960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004b970: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
 0004b980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004b990: 2020 2020 2020 706c 6f74 5f78 6762 5f6d        plot_xgb_m
-0004b9a0: 6574 7269 6373 2867 732e 6265 7374 5f65  etrics(gs.best_e
-0004b9b0: 7374 696d 6174 6f72 5f2c 6576 616c 5f6d  stimator_,eval_m
-0004b9c0: 6574 7269 632c 6576 616c 5f73 6574 2c6d  etric,eval_set,m
-0004b9d0: 6f64 656c 7479 7065 2c27 2573 2052 6573  odeltype,'%s Res
-0004b9e0: 756c 7473 2720 2565 6163 685f 7461 7267  ults' %each_targ
-0004b9f0: 6574 2c0d 0a20 2020 2020 2020 2020 2020  et,..           
+0004b990: 2070 6c6f 745f 7867 625f 6d65 7472 6963   plot_xgb_metric
+0004b9a0: 7328 6773 2e62 6573 745f 6573 7469 6d61  s(gs.best_estima
+0004b9b0: 746f 725f 2c65 7661 6c5f 6d65 7472 6963  tor_,eval_metric
+0004b9c0: 2c65 7661 6c5f 7365 742c 6d6f 6465 6c74  ,eval_set,modelt
+0004b9d0: 7970 652c 2725 7320 5265 7375 6c74 7327  ype,'%s Results'
+0004b9e0: 2025 6561 6368 5f74 6172 6765 742c 0d0a   %each_target,..
+0004b9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004ba00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ba10: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-0004ba20: 656c 5f6e 616d 6529 0d0a 2020 2020 2020  el_name)..      
-0004ba30: 2020 2020 2020 2020 2020 6578 6365 7074            except
-0004ba40: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0004ba50: 2020 2020 2020 2070 7269 6e74 2827 436f         print('Co
-0004ba60: 756c 6420 6e6f 7420 706c 6f74 204d 6f64  uld not plot Mod
-0004ba70: 656c 2045 7661 6c75 6174 696f 6e20 5265  el Evaluation Re
-0004ba80: 7375 6c74 7320 4d65 7472 6963 7327 290d  sults Metrics').
-0004ba90: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0004baa0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0004bab0: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-0004bac0: 2020 2020 2020 2020 2020 2020 2020 706c                pl
-0004bad0: 6f74 5f52 535f 7061 7261 6d73 2867 732e  ot_RS_params(gs.
-0004bae0: 6376 5f72 6573 756c 7473 5f2c 2073 636f  cv_results_, sco
-0004baf0: 7269 6e67 5f70 6172 616d 6574 6572 2c20  ring_parameter, 
-0004bb00: 6561 6368 5f74 6172 6765 7429 0d0a 2020  each_target)..  
-0004bb10: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-0004bb20: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
-0004bb30: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0004bb40: 2827 436f 756c 6420 6e6f 7420 706c 6f74  ('Could not plot
-0004bb50: 2043 726f 7373 2056 616c 6964 6174 696f   Cross Validatio
-0004bb60: 6e20 5061 7261 6d65 7465 7273 2729 0d0a  n Parameters')..
-0004bb70: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
-0004bb80: 2020 2054 696d 6520 7461 6b65 6e20 666f     Time taken fo
-0004bb90: 7220 7468 6973 2054 6172 6765 7420 2869  r this Target (i
-0004bba0: 6e20 7365 636f 6e64 7329 203d 2025 302e  n seconds) = %0.
-0004bbb0: 3066 2720 2528 7469 6d65 2e74 696d 6528  0f' %(time.time(
-0004bbc0: 292d 7374 6172 745f 7469 6d65 2929 0d0a  )-start_time))..
-0004bbd0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0004bbe0: 2020 2023 2323 2320 596f 7520 6361 6e20     #### You can 
-0004bbf0: 7573 6520 4a61 6363 6172 6420 5369 6d69  use Jaccard Simi
-0004bc00: 6c61 7269 7479 2066 6f72 204d 756c 7469  larity for Multi
-0004bc10: 2d4c 6162 656c 2050 726f 626c 656d 7320  -Label Problems 
-0004bc20: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
-0004bc30: 2020 2020 2069 6620 7363 6f72 696e 675f       if scoring_
-0004bc40: 7061 7261 6d65 7465 7220 3d3d 2027 6a61  parameter == 'ja
-0004bc50: 6363 6172 6427 3a0d 0a20 2020 2020 2020  ccard':..       
-0004bc60: 2020 2020 2061 6363 755f 616c 6c20 3d20       accu_all = 
-0004bc70: 6a61 6363 6172 645f 7369 6e67 6c65 6c61  jaccard_singlela
-0004bc80: 6265 6c28 795f 6376 2c20 795f 7072 6564  bel(y_cv, y_pred
-0004bc90: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
-0004bca0: 7269 6e74 2827 2020 2020 2020 2020 4d65  rint('        Me
-0004bcb0: 616e 204a 6163 6361 7264 2053 696d 696c  an Jaccard Simil
-0004bcc0: 6172 6974 7920 203d 207b 3a2c 2e31 667d  arity  = {:,.1f}
-0004bcd0: 2527 2e66 6f72 6d61 7428 0d0a 2020 2020  %'.format(..    
+0004ba10: 2020 2020 2020 2020 6d6f 6465 6c5f 6e61          model_na
+0004ba20: 6d65 290d 0a20 2020 2020 2020 2020 2020  me)..           
+0004ba30: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
+0004ba40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ba50: 2020 7072 696e 7428 2743 6f75 6c64 206e    print('Could n
+0004ba60: 6f74 2070 6c6f 7420 4d6f 6465 6c20 4576  ot plot Model Ev
+0004ba70: 616c 7561 7469 6f6e 2052 6573 756c 7473  aluation Results
+0004ba80: 204d 6574 7269 6373 2729 0d0a 2020 2020   Metrics')..    
+0004ba90: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0004baa0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0004bab0: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
+0004bac0: 2020 2020 2020 2020 2070 6c6f 745f 5253           plot_RS
+0004bad0: 5f70 6172 616d 7328 6773 2e63 765f 7265  _params(gs.cv_re
+0004bae0: 7375 6c74 735f 2c20 7363 6f72 696e 675f  sults_, scoring_
+0004baf0: 7061 7261 6d65 7465 722c 2065 6163 685f  parameter, each_
+0004bb00: 7461 7267 6574 290d 0a20 2020 2020 2020  target)..       
+0004bb10: 2020 2020 2020 2020 2065 7863 6570 743a           except:
+0004bb20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004bb30: 2020 2020 2020 7072 696e 7428 2743 6f75        print('Cou
+0004bb40: 6c64 206e 6f74 2070 6c6f 7420 4372 6f73  ld not plot Cros
+0004bb50: 7320 5661 6c69 6461 7469 6f6e 2050 6172  s Validation Par
+0004bb60: 616d 6574 6572 7327 290d 0a20 2020 2020  ameters')..     
+0004bb70: 2020 2070 7269 6e74 2827 2020 2020 5469     print('    Ti
+0004bb80: 6d65 2074 616b 656e 2066 6f72 2074 6869  me taken for thi
+0004bb90: 7320 5461 7267 6574 2028 696e 2073 6563  s Target (in sec
+0004bba0: 6f6e 6473 2920 3d20 2530 2e30 6627 2025  onds) = %0.0f' %
+0004bbb0: 2874 696d 652e 7469 6d65 2829 2d73 7461  (time.time()-sta
+0004bbc0: 7274 5f74 696d 6529 290d 0a20 2020 2065  rt_time))..    e
+0004bbd0: 6c73 653a 0d0a 2020 2020 2020 2020 2323  lse:..        ##
+0004bbe0: 2323 2059 6f75 2063 616e 2075 7365 204a  ## You can use J
+0004bbf0: 6163 6361 7264 2053 696d 696c 6172 6974  accard Similarit
+0004bc00: 7920 666f 7220 4d75 6c74 692d 4c61 6265  y for Multi-Labe
+0004bc10: 6c20 5072 6f62 6c65 6d73 2023 2323 2323  l Problems #####
+0004bc20: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
+0004bc30: 6966 2073 636f 7269 6e67 5f70 6172 616d  if scoring_param
+0004bc40: 6574 6572 203d 3d20 276a 6163 6361 7264  eter == 'jaccard
+0004bc50: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+0004bc60: 6163 6375 5f61 6c6c 203d 206a 6163 6361  accu_all = jacca
+0004bc70: 7264 5f73 696e 676c 656c 6162 656c 2879  rd_singlelabel(y
+0004bc80: 5f63 762c 2079 5f70 7265 6429 0d0a 2020  _cv, y_pred)..  
+0004bc90: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0004bca0: 2720 2020 2020 2020 204d 6561 6e20 4a61  '        Mean Ja
+0004bcb0: 6363 6172 6420 5369 6d69 6c61 7269 7479  ccard Similarity
+0004bcc0: 2020 3d20 7b3a 2c2e 3166 7d25 272e 666f    = {:,.1f}%'.fo
+0004bcd0: 726d 6174 280d 0a20 2020 2020 2020 2020  rmat(..         
 0004bce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004bcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004bd00: 6163 6375 5f61 6c6c 2a31 3030 2929 0d0a  accu_all*100))..
-0004bd10: 2020 2020 2020 2020 2020 2020 2323 2054              ## T
-0004bd20: 6869 7320 6973 2066 6f72 206d 756c 7469  his is for multi
-0004bd30: 2d6c 6162 656c 2070 726f 626c 656d 7320  -label problems 
-0004bd40: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-0004bd50: 6966 206d 756c 7469 6c61 6265 6c5f 636f  if multilabel_co
-0004bd60: 756e 7420 3d3d 2030 3a0d 0a20 2020 2020  unt == 0:..     
-0004bd70: 2020 2020 2020 2020 2020 207a 6970 7065             zippe
-0004bd80: 6420 3d20 636f 7079 2e64 6565 7063 6f70  d = copy.deepcop
-0004bd90: 7928 795f 7072 6564 290d 0a20 2020 2020  y(y_pred)..     
-0004bda0: 2020 2020 2020 2020 2020 206d 756c 7469             multi
-0004bdb0: 6c61 6265 6c5f 636f 756e 7420 2b3d 2031  label_count += 1
-0004bdc0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-0004bdd0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0004bde0: 2020 2020 207a 6970 7065 6420 3d20 7a69       zipped = zi
-0004bdf0: 7028 7a69 7070 6564 2c79 5f70 7265 6429  p(zipped,y_pred)
-0004be00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004be10: 2020 6d75 6c74 696c 6162 656c 5f63 6f75    multilabel_cou
-0004be20: 6e74 202b 3d20 310d 0a20 2020 2020 2020  nt += 1..       
-0004be30: 2065 6c69 6620 7363 6f72 696e 675f 7061   elif scoring_pa
-0004be40: 7261 6d65 7465 7220 3d3d 2027 6261 736b  rameter == 'bask
-0004be50: 6574 5f72 6563 616c 6c27 3a0d 0a20 2020  et_recall':..   
-0004be60: 2020 2020 2020 2020 2069 6620 6d75 6c74           if mult
-0004be70: 696c 6162 656c 5f63 6f75 6e74 203d 3d20  ilabel_count == 
-0004be80: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-0004be90: 2020 2020 7a69 7070 6564 203d 2063 6f70      zipped = cop
-0004bea0: 792e 6465 6570 636f 7079 2879 5f70 7265  y.deepcopy(y_pre
-0004beb0: 6429 0d0a 2020 2020 2020 2020 2020 2020  d)..            
-0004bec0: 2020 2020 6d75 6c74 696c 6162 656c 5f63      multilabel_c
-0004bed0: 6f75 6e74 202b 3d20 310d 0a20 2020 2020  ount += 1..     
-0004bee0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0004bef0: 2020 2020 2020 2020 2020 2020 2020 7a69                zi
-0004bf00: 7070 6564 203d 207a 6970 287a 6970 7065  pped = zip(zippe
-0004bf10: 642c 795f 7072 6564 290d 0a20 2020 2020  d,y_pred)..     
-0004bf20: 2020 2020 2020 2020 2020 206d 756c 7469             multi
-0004bf30: 6c61 6265 6c5f 636f 756e 7420 2b3d 2031  label_count += 1
-0004bf40: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-0004bf50: 2754 7261 696e 696e 6720 6d6f 6465 6c20  'Training model 
-0004bf60: 6f6e 2063 6f6d 706c 6574 6520 5472 6169  on complete Trai
-0004bf70: 6e20 6461 7461 2061 6e64 2050 7265 6469  n data and Predi
-0004bf80: 6374 696e 6720 7573 696e 6720 6769 7665  cting using give
-0004bf90: 6e20 5465 7374 2044 6174 612e 2e2e 2729  n Test Data...')
-0004bfa0: 0d0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
-0004bfb0: 2323 2323 2323 2020 2020 2020 2020 4920  ######        I 
-0004bfc0: 4d20 5020 4f20 5220 5420 4120 4e20 543a  M P O R T A N T:
-0004bfd0: 2043 204f 204d 2042 2049 204e 2049 204e   C O M B I N I N
-0004bfe0: 2047 2020 4420 4120 5420 4120 2323 2323   G  D A T A ####
-0004bff0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c000: 2323 0d0a 2020 2020 2323 2323 2054 6869  ##..    #### Thi
-0004c010: 7320 6973 2053 6563 6f6e 6420 7469 6d65  s is Second time
-0004c020: 3a20 7765 2063 6f6d 6269 6e65 2074 7261  : we combine tra
-0004c030: 696e 2061 6e64 2043 5620 696e 746f 2054  in and CV into T
-0004c040: 7261 696e 2061 6e64 2054 6573 7420 5365  rain and Test Se
-0004c050: 7473 2023 2323 2323 2323 2323 2323 2323  ts #############
-0004c060: 2323 2323 0d0a 2020 2020 7472 6169 6e20  ####..    train 
-0004c070: 3d20 7061 7274 5f74 7261 696e 2e61 7070  = part_train.app
-0004c080: 656e 6428 7061 7274 5f63 7629 0d0a 2020  end(part_cv)..  
-0004c090: 2020 696d 706f 7274 616e 745f 6665 6174    important_feat
-0004c0a0: 7572 6573 203d 205b 7820 666f 7220 7820  ures = [x for x 
-0004c0b0: 696e 206c 6973 7428 7472 6169 6e29 2069  in list(train) i
-0004c0c0: 6620 7820 6e6f 7420 696e 2074 6172 6765  f x not in targe
-0004c0d0: 745d 0d0a 2020 2020 2323 2323 2323 2323  t]..    ########
+0004bcf0: 2020 2020 2020 2020 2020 2061 6363 755f             accu_
+0004bd00: 616c 6c2a 3130 3029 290d 0a20 2020 2020  all*100))..     
+0004bd10: 2020 2020 2020 2023 2320 5468 6973 2069         ## This i
+0004bd20: 7320 666f 7220 6d75 6c74 692d 6c61 6265  s for multi-labe
+0004bd30: 6c20 7072 6f62 6c65 6d73 2023 230d 0a20  l problems ##.. 
+0004bd40: 2020 2020 2020 2020 2020 2069 6620 6d75             if mu
+0004bd50: 6c74 696c 6162 656c 5f63 6f75 6e74 203d  ltilabel_count =
+0004bd60: 3d20 303a 0d0a 2020 2020 2020 2020 2020  = 0:..          
+0004bd70: 2020 2020 2020 7a69 7070 6564 203d 2063        zipped = c
+0004bd80: 6f70 792e 6465 6570 636f 7079 2879 5f70  opy.deepcopy(y_p
+0004bd90: 7265 6429 0d0a 2020 2020 2020 2020 2020  red)..          
+0004bda0: 2020 2020 2020 6d75 6c74 696c 6162 656c        multilabel
+0004bdb0: 5f63 6f75 6e74 202b 3d20 310d 0a20 2020  _count += 1..   
+0004bdc0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0004bdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bde0: 7a69 7070 6564 203d 207a 6970 287a 6970  zipped = zip(zip
+0004bdf0: 7065 642c 795f 7072 6564 290d 0a20 2020  ped,y_pred)..   
+0004be00: 2020 2020 2020 2020 2020 2020 206d 756c               mul
+0004be10: 7469 6c61 6265 6c5f 636f 756e 7420 2b3d  tilabel_count +=
+0004be20: 2031 0d0a 2020 2020 2020 2020 656c 6966   1..        elif
+0004be30: 2073 636f 7269 6e67 5f70 6172 616d 6574   scoring_paramet
+0004be40: 6572 203d 3d20 2762 6173 6b65 745f 7265  er == 'basket_re
+0004be50: 6361 6c6c 273a 0d0a 2020 2020 2020 2020  call':..        
+0004be60: 2020 2020 6966 206d 756c 7469 6c61 6265      if multilabe
+0004be70: 6c5f 636f 756e 7420 3d3d 2030 3a0d 0a20  l_count == 0:.. 
+0004be80: 2020 2020 2020 2020 2020 2020 2020 207a                 z
+0004be90: 6970 7065 6420 3d20 636f 7079 2e64 6565  ipped = copy.dee
+0004bea0: 7063 6f70 7928 795f 7072 6564 290d 0a20  pcopy(y_pred).. 
+0004beb0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0004bec0: 756c 7469 6c61 6265 6c5f 636f 756e 7420  ultilabel_count 
+0004bed0: 2b3d 2031 0d0a 2020 2020 2020 2020 2020  += 1..          
+0004bee0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0004bef0: 2020 2020 2020 2020 207a 6970 7065 6420           zipped 
+0004bf00: 3d20 7a69 7028 7a69 7070 6564 2c79 5f70  = zip(zipped,y_p
+0004bf10: 7265 6429 0d0a 2020 2020 2020 2020 2020  red)..          
+0004bf20: 2020 2020 2020 6d75 6c74 696c 6162 656c        multilabel
+0004bf30: 5f63 6f75 6e74 202b 3d20 310d 0a20 2020  _count += 1..   
+0004bf40: 2020 2020 2070 7269 6e74 2827 5472 6169       print('Trai
+0004bf50: 6e69 6e67 206d 6f64 656c 206f 6e20 636f  ning model on co
+0004bf60: 6d70 6c65 7465 2054 7261 696e 2064 6174  mplete Train dat
+0004bf70: 6120 616e 6420 5072 6564 6963 7469 6e67  a and Predicting
+0004bf80: 2075 7369 6e67 2067 6976 656e 2054 6573   using given Tes
+0004bf90: 7420 4461 7461 2e2e 2e27 290d 0a20 2020  t Data...')..   
+0004bfa0: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
+0004bfb0: 2320 2020 2020 2020 2049 204d 2050 204f  #        I M P O
+0004bfc0: 2052 2054 2041 204e 2054 3a20 4320 4f20   R T A N T: C O 
+0004bfd0: 4d20 4220 4920 4e20 4920 4e20 4720 2044  M B I N I N G  D
+0004bfe0: 2041 2054 2041 2023 2323 2323 2323 2323   A T A #########
+0004bff0: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
+0004c000: 2020 2023 2323 2320 5468 6973 2069 7320     #### This is 
+0004c010: 5365 636f 6e64 2074 696d 653a 2077 6520  Second time: we 
+0004c020: 636f 6d62 696e 6520 7472 6169 6e20 616e  combine train an
+0004c030: 6420 4356 2069 6e74 6f20 5472 6169 6e20  d CV into Train 
+0004c040: 616e 6420 5465 7374 2053 6574 7320 2323  and Test Sets ##
+0004c050: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+0004c060: 0a20 2020 2074 7261 696e 203d 2070 6172  .    train = par
+0004c070: 745f 7472 6169 6e2e 6170 7065 6e64 2870  t_train.append(p
+0004c080: 6172 745f 6376 290d 0a20 2020 2069 6d70  art_cv)..    imp
+0004c090: 6f72 7461 6e74 5f66 6561 7475 7265 7320  ortant_features 
+0004c0a0: 3d20 5b78 2066 6f72 2078 2069 6e20 6c69  = [x for x in li
+0004c0b0: 7374 2874 7261 696e 2920 6966 2078 206e  st(train) if x n
+0004c0c0: 6f74 2069 6e20 7461 7267 6574 5d0d 0a20  ot in target].. 
+0004c0d0: 2020 2023 2323 2323 2323 2323 2323 2323     #############
 0004c0e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004c0f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004c100: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004c110: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c130: 2323 2323 0d0a 2020 2020 6966 206d 6f64  ####..    if mod
-0004c140: 656c 5f6c 6162 656c 203d 3d20 2753 696e  el_label == 'Sin
-0004c150: 676c 655f 4c61 6265 6c27 3a0d 0a20 2020  gle_Label':..   
-0004c160: 2020 2020 2023 2323 2323 2320 4e6f 7720       ###### Now 
-0004c170: 7468 6174 2077 6520 6861 7665 2075 7365  that we have use
-0004c180: 6420 7061 7274 6961 6c20 6461 7461 2074  d partial data t
-0004c190: 6f20 6d61 6b65 2073 7461 636b 696e 6720  o make stacking 
-0004c1a0: 7072 6564 6963 746f 7273 2c20 7765 2063  predictors, we c
-0004c1b0: 616e 2072 656d 6f76 6520 7468 656d 2066  an remove them f
-0004c1c0: 726f 6d20 636f 6e73 6964 6572 6174 696f  rom consideratio
-0004c1d0: 6e21 0d0a 2020 2020 2020 2020 6966 2053  n!..        if S
-0004c1e0: 7461 636b 696e 675f 466c 6167 3a0d 0a20  tacking_Flag:.. 
-0004c1f0: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
-0004c200: 7461 6e74 5f66 6561 7475 7265 7320 3d20  tant_features = 
-0004c210: 6c65 6674 5f73 7562 7472 6163 7428 696d  left_subtract(im
-0004c220: 706f 7274 616e 745f 6665 6174 7572 6573  portant_features
-0004c230: 2c20 6164 6463 6f6c 290d 0a20 2020 2020  , addcol)..     
-0004c240: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-0004c250: 2020 2020 2020 2020 2020 2020 2074 7261               tra
-0004c260: 696e 2e64 726f 7028 6164 6463 6f6c 2c61  in.drop(addcol,a
-0004c270: 7869 733d 312c 2069 6e70 6c61 6365 3d54  xis=1, inplace=T
-0004c280: 7275 6529 0d0a 2020 2020 2020 2020 2020  rue)..          
-0004c290: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
-0004c2a0: 2020 2020 2020 2020 2020 2070 6173 730d             pass.
-0004c2b0: 0a20 2020 2020 2020 2023 2323 2323 2320  .        ###### 
-0004c2c0: 5369 6d69 6c61 726c 7920 7765 2077 696c  Similarly we wil
-0004c2d0: 6c20 6861 7665 2074 6f20 6372 6561 7465  l have to create
-0004c2e0: 204b 4d65 616e 735f 436c 7573 7465 7273   KMeans_Clusters
-0004c2f0: 2061 6761 696e 2075 7369 6e67 2066 756c   again using ful
-0004c300: 6c20 5472 6169 6e20 6461 7461 210d 0a20  l Train data!.. 
-0004c310: 2020 2020 2020 2069 6620 4b4d 6561 6e73         if KMeans
-0004c320: 5f46 6561 7475 7269 7a65 723a 0d0a 2020  _Featurizer:..  
-0004c330: 2020 2020 2020 2020 2020 696d 706f 7274            import
-0004c340: 616e 745f 6665 6174 7572 6573 203d 206c  ant_features = l
-0004c350: 6566 745f 7375 6274 7261 6374 2869 6d70  eft_subtract(imp
-0004c360: 6f72 7461 6e74 5f66 6561 7475 7265 732c  ortant_features,
-0004c370: 206b 6d5f 6c61 6265 6c29 0d0a 2020 2020   km_label)..    
-0004c380: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-0004c390: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-0004c3a0: 6169 6e2e 6472 6f70 286b 6d5f 6c61 6265  ain.drop(km_labe
-0004c3b0: 6c2c 6178 6973 3d31 2c20 696e 706c 6163  l,axis=1, inplac
-0004c3c0: 653d 5472 7565 290d 0a20 2020 2020 2020  e=True)..       
-0004c3d0: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
-0004c3e0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-0004c3f0: 7373 0d0a 2020 2020 2020 2020 2323 2323  ss..        ####
+0004c120: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+0004c130: 0a20 2020 2069 6620 6d6f 6465 6c5f 6c61  .    if model_la
+0004c140: 6265 6c20 3d3d 2027 5369 6e67 6c65 5f4c  bel == 'Single_L
+0004c150: 6162 656c 273a 0d0a 2020 2020 2020 2020  abel':..        
+0004c160: 2323 2323 2323 204e 6f77 2074 6861 7420  ###### Now that 
+0004c170: 7765 2068 6176 6520 7573 6564 2070 6172  we have used par
+0004c180: 7469 616c 2064 6174 6120 746f 206d 616b  tial data to mak
+0004c190: 6520 7374 6163 6b69 6e67 2070 7265 6469  e stacking predi
+0004c1a0: 6374 6f72 732c 2077 6520 6361 6e20 7265  ctors, we can re
+0004c1b0: 6d6f 7665 2074 6865 6d20 6672 6f6d 2063  move them from c
+0004c1c0: 6f6e 7369 6465 7261 7469 6f6e 210d 0a20  onsideration!.. 
+0004c1d0: 2020 2020 2020 2069 6620 5374 6163 6b69         if Stacki
+0004c1e0: 6e67 5f46 6c61 673a 0d0a 2020 2020 2020  ng_Flag:..      
+0004c1f0: 2020 2020 2020 696d 706f 7274 616e 745f        important_
+0004c200: 6665 6174 7572 6573 203d 206c 6566 745f  features = left_
+0004c210: 7375 6274 7261 6374 2869 6d70 6f72 7461  subtract(importa
+0004c220: 6e74 5f66 6561 7475 7265 732c 2061 6464  nt_features, add
+0004c230: 636f 6c29 0d0a 2020 2020 2020 2020 2020  col)..          
+0004c240: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
+0004c250: 2020 2020 2020 2020 7472 6169 6e2e 6472          train.dr
+0004c260: 6f70 2861 6464 636f 6c2c 6178 6973 3d31  op(addcol,axis=1
+0004c270: 2c20 696e 706c 6163 653d 5472 7565 290d  , inplace=True).
+0004c280: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+0004c290: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
+0004c2a0: 2020 2020 2020 7061 7373 0d0a 2020 2020        pass..    
+0004c2b0: 2020 2020 2323 2323 2323 2053 696d 696c      ###### Simil
+0004c2c0: 6172 6c79 2077 6520 7769 6c6c 2068 6176  arly we will hav
+0004c2d0: 6520 746f 2063 7265 6174 6520 4b4d 6561  e to create KMea
+0004c2e0: 6e73 5f43 6c75 7374 6572 7320 6167 6169  ns_Clusters agai
+0004c2f0: 6e20 7573 696e 6720 6675 6c6c 2054 7261  n using full Tra
+0004c300: 696e 2064 6174 6121 0d0a 2020 2020 2020  in data!..      
+0004c310: 2020 6966 204b 4d65 616e 735f 4665 6174    if KMeans_Feat
+0004c320: 7572 697a 6572 3a0d 0a20 2020 2020 2020  urizer:..       
+0004c330: 2020 2020 2069 6d70 6f72 7461 6e74 5f66       important_f
+0004c340: 6561 7475 7265 7320 3d20 6c65 6674 5f73  eatures = left_s
+0004c350: 7562 7472 6163 7428 696d 706f 7274 616e  ubtract(importan
+0004c360: 745f 6665 6174 7572 6573 2c20 6b6d 5f6c  t_features, km_l
+0004c370: 6162 656c 290d 0a20 2020 2020 2020 2020  abel)..         
+0004c380: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+0004c390: 2020 2020 2020 2020 2074 7261 696e 2e64           train.d
+0004c3a0: 726f 7028 6b6d 5f6c 6162 656c 2c61 7869  rop(km_label,axi
+0004c3b0: 733d 312c 2069 6e70 6c61 6365 3d54 7275  s=1, inplace=Tru
+0004c3c0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+0004c3d0: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+0004c3e0: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
+0004c3f0: 2020 2020 2020 2023 2323 2323 2323 2323         #########
 0004c400: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c410: 2323 2323 2323 2042 494e 4e49 4e47 2053  ###### BINNING S
-0004c420: 4543 4f4e 4420 5449 4d45 2020 2323 2323  ECOND TIME  ####
+0004c410: 2320 4249 4e4e 494e 4720 5345 434f 4e44  # BINNING SECOND
+0004c420: 2054 494d 4520 2023 2323 2323 2323 2323   TIME  #########
 0004c430: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c440: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
-0004c450: 2020 2020 206e 6577 5f6e 756d 5f76 6172       new_num_var
-0004c460: 7320 3d20 7472 6169 6e5b 696d 706f 7274  s = train[import
-0004c470: 616e 745f 6665 6174 7572 6573 5d2e 7365  ant_features].se
-0004c480: 6c65 6374 5f64 7479 7065 7328 696e 636c  lect_dtypes(incl
-0004c490: 7564 653d 5b6e 702e 666c 6f61 7436 342c  ude=[np.float64,
-0004c4a0: 6e70 2e66 6c6f 6174 3332 2c6e 702e 666c  np.float32,np.fl
-0004c4b0: 6f61 7431 365d 292e 636f 6c75 6d6e 732e  oat16]).columns.
-0004c4c0: 746f 6c69 7374 2829 0d0a 2020 2020 2020  tolist()..      
-0004c4d0: 2020 2323 204e 6f77 2077 6520 7265 2d75    ## Now we re-u
-0004c4e0: 7365 2074 6865 2073 6176 6564 5f6e 756d  se the saved_num
-0004c4f0: 5f76 6172 7320 7768 6963 6820 636f 6e74  _vars which cont
-0004c500: 6169 6e65 6420 6120 6c69 7374 206f 6620  ained a list of 
-0004c510: 6e75 6d5f 7661 7273 2066 6f72 2062 696e  num_vars for bin
-0004c520: 6e69 6e67 206e 6f77 210d 0a20 2020 2020  ning now!..     
-0004c530: 2020 2023 2323 2323 2320 4f6e 6365 2061     ###### Once a
-0004c540: 6761 696e 2077 6520 646f 2045 6e74 726f  gain we do Entro
-0004c550: 7079 2042 696e 6e69 6e67 206f 6e20 7468  py Binning on th
-0004c560: 6520 4675 6c6c 2054 7261 696e 2044 6174  e Full Train Dat
-0004c570: 6120 5365 7420 2121 0d0a 2020 2020 2020  a Set !!..      
-0004c580: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-0004c590: 2323 2323 2323 2323 2323 2323 2042 494e  ############ BIN
-0004c5a0: 4e49 4e47 2053 4543 4f4e 4420 5449 4d45  NING SECOND TIME
-0004c5b0: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-0004c5c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c5d0: 230d 0a20 2020 2020 2020 2069 6620 4269  #..        if Bi
-0004c5e0: 6e6e 696e 675f 466c 6167 2061 6e64 206c  nning_Flag and l
-0004c5f0: 656e 2873 6176 6564 5f6e 756d 5f76 6172  en(saved_num_var
-0004c600: 7329 203e 2030 3a0d 0a20 2020 2020 2020  s) > 0:..       
-0004c610: 2020 2020 2023 2323 2077 6865 6e20 796f       ### when yo
-0004c620: 7520 6269 6e20 7468 6520 7365 636f 6e64  u bin the second
-0004c630: 2074 696d 652c 2079 6f75 2068 6176 6520   time, you have 
-0004c640: 746f 2073 656e 6420 696e 2069 6d70 6f72  to send in impor
-0004c650: 7461 6e74 5f66 6561 7475 7265 7320 7769  tant_features wi
-0004c660: 7468 206f 7269 6769 6e61 6c0d 0a20 2020  th original..   
-0004c670: 2020 2020 2020 2020 2023 2323 206e 756d           ### num
-0004c680: 6572 6963 2076 6172 6961 626c 6573 2073  eric variables s
-0004c690: 6f20 7468 6174 2069 7420 776f 726b 7320  o that it works 
-0004c6a0: 6f6e 2062 696e 6e69 6e67 206f 6e6c 7920  on binning only 
-0004c6b0: 7468 6f73 652e 204f 7468 6572 7769 7365  those. Otherwise
-0004c6c0: 2069 7420 7769 6c6c 2066 6169 6c2e 0d0a   it will fail...
-0004c6d0: 2020 2020 2020 2020 2020 2020 2369 6d70              #imp
-0004c6e0: 6f72 7461 6e74 5f66 6561 7475 7265 7320  ortant_features 
-0004c6f0: 3d20 6c65 6674 5f73 7562 7472 6163 7428  = left_subtract(
-0004c700: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
-0004c710: 6573 2c62 696e 6e65 645f 6e75 6d5f 7661  es,binned_num_va
-0004c720: 7273 290d 0a20 2020 2020 2020 2020 2020  rs)..           
-0004c730: 2023 7472 6169 6e20 3d20 7472 6169 6e5b   #train = train[
-0004c740: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
-0004c750: 6573 2b5b 6561 6368 5f74 6172 6765 745d  es+[each_target]
-0004c760: 5d0d 0a20 2020 2020 2020 2020 2020 2023  ]..            #
-0004c770: 2323 2044 6f20 456e 7472 6f70 7920 4269  ## Do Entropy Bi
-0004c780: 6e6e 696e 6720 6f6e 6c79 2069 6620 7468  nning only if th
-0004c790: 6572 6520 6172 6520 6e75 6d65 7269 6320  ere are numeric 
-0004c7a0: 7661 7269 6162 6c65 7320 696e 2074 6865  variables in the
-0004c7b0: 2064 6174 6120 7365 7421 2023 2323 2323   data set! #####
-0004c7c0: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-0004c7d0: 2323 2057 6865 6e20 7765 2042 696e 2074  ## When we Bin t
-0004c7e0: 6865 2073 6563 6f6e 6420 6669 7273 7420  he second first 
-0004c7f0: 7469 6d65 2c20 7765 2073 6574 2074 6865  time, we set the
-0004c800: 2065 6e74 726f 7079 5f62 696e 6e69 6e67   entropy_binning
-0004c810: 2066 6c61 6720 746f 2054 7275 6520 736f   flag to True so
-0004c820: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-0004c830: 2323 2020 2020 7468 6174 2061 6c6c 206e  ##    that all n
-0004c840: 756d 6572 6963 2076 6172 6961 626c 6573  umeric variables
-0004c850: 2074 6861 7420 6172 6520 6269 6e6e 6564   that are binned
-0004c860: 2061 7265 2072 656d 6f76 6564 2e20 5468   are removed. Th
-0004c870: 6973 2077 6179 2c20 6f6e 6c79 2062 696e  is way, only bin
-0004c880: 7320 7265 6d61 696e 2e0d 0a20 2020 2020  s remain...     
-0004c890: 2020 2020 2020 2074 7261 696e 2c20 6e75         train, nu
-0004c8a0: 6d5f 7661 7273 2c20 696d 706f 7274 616e  m_vars, importan
-0004c8b0: 745f 6665 6174 7572 6573 2c20 7465 7374  t_features, test
-0004c8c0: 203d 2061 6464 5f65 6e74 726f 7079 5f62   = add_entropy_b
-0004c8d0: 696e 6e69 6e67 2874 7261 696e 2c20 6561  inning(train, ea
-0004c8e0: 6368 5f74 6172 6765 742c 0d0a 2020 2020  ch_target,..    
+0004c440: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
+0004c450: 6e65 775f 6e75 6d5f 7661 7273 203d 2074  new_num_vars = t
+0004c460: 7261 696e 5b69 6d70 6f72 7461 6e74 5f66  rain[important_f
+0004c470: 6561 7475 7265 735d 2e73 656c 6563 745f  eatures].select_
+0004c480: 6474 7970 6573 2869 6e63 6c75 6465 3d5b  dtypes(include=[
+0004c490: 6e70 2e66 6c6f 6174 3634 2c6e 702e 666c  np.float64,np.fl
+0004c4a0: 6f61 7433 322c 6e70 2e66 6c6f 6174 3136  oat32,np.float16
+0004c4b0: 5d29 2e63 6f6c 756d 6e73 2e74 6f6c 6973  ]).columns.tolis
+0004c4c0: 7428 290d 0a20 2020 2020 2020 2023 2320  t()..        ## 
+0004c4d0: 4e6f 7720 7765 2072 652d 7573 6520 7468  Now we re-use th
+0004c4e0: 6520 7361 7665 645f 6e75 6d5f 7661 7273  e saved_num_vars
+0004c4f0: 2077 6869 6368 2063 6f6e 7461 696e 6564   which contained
+0004c500: 2061 206c 6973 7420 6f66 206e 756d 5f76   a list of num_v
+0004c510: 6172 7320 666f 7220 6269 6e6e 696e 6720  ars for binning 
+0004c520: 6e6f 7721 0d0a 2020 2020 2020 2020 2323  now!..        ##
+0004c530: 2323 2323 204f 6e63 6520 6167 6169 6e20  #### Once again 
+0004c540: 7765 2064 6f20 456e 7472 6f70 7920 4269  we do Entropy Bi
+0004c550: 6e6e 696e 6720 6f6e 2074 6865 2046 756c  nning on the Ful
+0004c560: 6c20 5472 6169 6e20 4461 7461 2053 6574  l Train Data Set
+0004c570: 2021 210d 0a20 2020 2020 2020 2023 2323   !!..        ###
+0004c580: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c590: 2323 2323 2323 2320 4249 4e4e 494e 4720  ####### BINNING 
+0004c5a0: 5345 434f 4e44 2054 494d 4520 2023 2323  SECOND TIME  ###
+0004c5b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c5c0: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
+0004c5d0: 2020 2020 2020 6966 2042 696e 6e69 6e67        if Binning
+0004c5e0: 5f46 6c61 6720 616e 6420 6c65 6e28 7361  _Flag and len(sa
+0004c5f0: 7665 645f 6e75 6d5f 7661 7273 2920 3e20  ved_num_vars) > 
+0004c600: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+0004c610: 2323 2320 7768 656e 2079 6f75 2062 696e  ### when you bin
+0004c620: 2074 6865 2073 6563 6f6e 6420 7469 6d65   the second time
+0004c630: 2c20 796f 7520 6861 7665 2074 6f20 7365  , you have to se
+0004c640: 6e64 2069 6e20 696d 706f 7274 616e 745f  nd in important_
+0004c650: 6665 6174 7572 6573 2077 6974 6820 6f72  features with or
+0004c660: 6967 696e 616c 0d0a 2020 2020 2020 2020  iginal..        
+0004c670: 2020 2020 2323 2320 6e75 6d65 7269 6320      ### numeric 
+0004c680: 7661 7269 6162 6c65 7320 736f 2074 6861  variables so tha
+0004c690: 7420 6974 2077 6f72 6b73 206f 6e20 6269  t it works on bi
+0004c6a0: 6e6e 696e 6720 6f6e 6c79 2074 686f 7365  nning only those
+0004c6b0: 2e20 4f74 6865 7277 6973 6520 6974 2077  . Otherwise it w
+0004c6c0: 696c 6c20 6661 696c 2e0d 0a20 2020 2020  ill fail...     
+0004c6d0: 2020 2020 2020 2023 696d 706f 7274 616e         #importan
+0004c6e0: 745f 6665 6174 7572 6573 203d 206c 6566  t_features = lef
+0004c6f0: 745f 7375 6274 7261 6374 2869 6d70 6f72  t_subtract(impor
+0004c700: 7461 6e74 5f66 6561 7475 7265 732c 6269  tant_features,bi
+0004c710: 6e6e 6564 5f6e 756d 5f76 6172 7329 0d0a  nned_num_vars)..
+0004c720: 2020 2020 2020 2020 2020 2020 2374 7261              #tra
+0004c730: 696e 203d 2074 7261 696e 5b69 6d70 6f72  in = train[impor
+0004c740: 7461 6e74 5f66 6561 7475 7265 732b 5b65  tant_features+[e
+0004c750: 6163 685f 7461 7267 6574 5d5d 0d0a 2020  ach_target]]..  
+0004c760: 2020 2020 2020 2020 2020 2323 2320 446f            ### Do
+0004c770: 2045 6e74 726f 7079 2042 696e 6e69 6e67   Entropy Binning
+0004c780: 206f 6e6c 7920 6966 2074 6865 7265 2061   only if there a
+0004c790: 7265 206e 756d 6572 6963 2076 6172 6961  re numeric varia
+0004c7a0: 626c 6573 2069 6e20 7468 6520 6461 7461  bles in the data
+0004c7b0: 2073 6574 2120 2323 2323 230d 0a20 2020   set! #####..   
+0004c7c0: 2020 2020 2020 2020 2023 2323 2320 5768           #### Wh
+0004c7d0: 656e 2077 6520 4269 6e20 7468 6520 7365  en we Bin the se
+0004c7e0: 636f 6e64 2066 6972 7374 2074 696d 652c  cond first time,
+0004c7f0: 2077 6520 7365 7420 7468 6520 656e 7472   we set the entr
+0004c800: 6f70 795f 6269 6e6e 696e 6720 666c 6167  opy_binning flag
+0004c810: 2074 6f20 5472 7565 2073 6f0d 0a20 2020   to True so..   
+0004c820: 2020 2020 2020 2020 2023 2323 2320 2020           ####   
+0004c830: 2074 6861 7420 616c 6c20 6e75 6d65 7269   that all numeri
+0004c840: 6320 7661 7269 6162 6c65 7320 7468 6174  c variables that
+0004c850: 2061 7265 2062 696e 6e65 6420 6172 6520   are binned are 
+0004c860: 7265 6d6f 7665 642e 2054 6869 7320 7761  removed. This wa
+0004c870: 792c 206f 6e6c 7920 6269 6e73 2072 656d  y, only bins rem
+0004c880: 6169 6e2e 0d0a 2020 2020 2020 2020 2020  ain...          
+0004c890: 2020 7472 6169 6e2c 206e 756d 5f76 6172    train, num_var
+0004c8a0: 732c 2069 6d70 6f72 7461 6e74 5f66 6561  s, important_fea
+0004c8b0: 7475 7265 732c 2074 6573 7420 3d20 6164  tures, test = ad
+0004c8c0: 645f 656e 7472 6f70 795f 6269 6e6e 696e  d_entropy_binnin
+0004c8d0: 6728 7472 6169 6e2c 2065 6163 685f 7461  g(train, each_ta
+0004c8e0: 7267 6574 2c0d 0a20 2020 2020 2020 2020  rget,..         
 0004c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004c900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c910: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-0004c920: 7665 645f 6e75 6d5f 7661 7273 2c20 696d  ved_num_vars, im
-0004c930: 706f 7274 616e 745f 6665 6174 7572 6573  portant_features
-0004c940: 2c20 7465 7374 2c0d 0a20 2020 2020 2020  , test,..       
+0004c910: 2020 2020 2020 2020 2073 6176 6564 5f6e           saved_n
+0004c920: 756d 5f76 6172 732c 2069 6d70 6f72 7461  um_vars, importa
+0004c930: 6e74 5f66 6561 7475 7265 732c 2074 6573  nt_features, tes
+0004c940: 742c 0d0a 2020 2020 2020 2020 2020 2020  t,..            
 0004c950: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004c960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c970: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-0004c980: 7479 7065 2c20 2065 6e74 726f 7079 5f62  type,  entropy_b
-0004c990: 696e 6e69 6e67 3d54 7275 652c 7665 7262  inning=True,verb
-0004c9a0: 6f73 653d 7665 7262 6f73 6529 0d0a 2020  ose=verbose)..  
-0004c9b0: 2020 2020 2020 2020 2020 2323 2323 2049            #### I
-0004c9c0: 6e20 7361 7665 645f 6e75 6d5f 7661 7273  n saved_num_vars
-0004c9d0: 2077 6520 7365 6e64 2069 6e20 616c 6c20   we send in all 
-0004c9e0: 7468 6520 636f 6e74 696e 756f 7573 5f76  the continuous_v
-0004c9f0: 6172 7320 6275 7420 7765 2062 696e 206f  ars but we bin o
-0004ca00: 6e6c 7920 7468 6520 746f 7020 6665 7720  nly the top few 
-0004ca10: 7661 7273 2e0d 0a20 2020 2020 2020 2020  vars...         
-0004ca20: 2020 2023 2323 2020 5468 6f73 6520 7468     ###  Those th
-0004ca30: 6174 2061 7265 2062 696e 6e65 6420 6172  at are binned ar
-0004ca40: 6520 7265 6d6f 7665 6420 6672 6f6d 2073  e removed from s
-0004ca50: 6176 6564 5f6e 756d 5f76 6172 7320 616e  aved_num_vars an
-0004ca60: 6420 7468 6520 7265 6d61 696e 696e 6720  d the remaining 
-0004ca70: 6265 636f 6d65 206e 756d 5f76 6172 730d  become num_vars.
-0004ca80: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
-0004ca90: 204f 7572 206a 6f62 2069 7320 746f 2066   Our job is to f
-0004caa0: 696e 6420 7468 6520 6e61 6d65 7320 6f66  ind the names of
-0004cab0: 2074 686f 7365 206f 7269 6769 6e61 6c20   those original 
-0004cac0: 6e75 6d65 7269 6320 7661 7269 6162 6c65  numeric variable
-0004cad0: 7320 7768 6963 6820 7765 7265 2062 696e  s which were bin
-0004cae0: 6e65 642e 0d0a 2020 2020 2020 2020 2020  ned...          
-0004caf0: 2020 2323 2320 6f72 6967 5f6e 756d 5f76    ### orig_num_v
-0004cb00: 6172 7320 636f 6e74 6169 6e73 206f 7269  ars contains ori
-0004cb10: 6769 6e61 6c20 6e75 6d20 7661 7273 2e20  ginal num vars. 
-0004cb20: 6e75 6d5f 7661 7273 2063 6f6e 7461 696e  num_vars contain
-0004cb30: 7320 6269 6e6e 6564 2076 6572 7369 6f6e  s binned version
-0004cb40: 7320 6f66 2074 686f 7365 2076 6172 732e  s of those vars.
-0004cb50: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-0004cb60: 2320 5468 6f73 6520 6269 6e6e 6564 2076  # Those binned v
-0004cb70: 6172 6961 626c 6573 2068 6176 6520 6e6f  ariables have no
-0004cb80: 7720 6265 636f 6d65 2063 6174 6567 6f72  w become categor
-0004cb90: 6963 616c 2076 6172 7320 616e 6420 6d75  ical vars and mu
-0004cba0: 7374 2062 6520 6164 6465 6420 746f 2069  st be added to i
-0004cbb0: 6d70 5f63 6174 732e 0d0a 2020 2020 2020  mp_cats...      
-0004cbc0: 2020 2020 2020 2323 2323 2041 6c73 6f20        #### Also 
-0004cbd0: 6e6f 7465 2074 6861 7420 696d 706f 7274  note that import
-0004cbe0: 616e 745f 6665 6174 7572 6573 2064 6f65  ant_features doe
-0004cbf0: 7320 6e6f 7420 636f 6e74 6169 6e20 6f72  s not contain or
-0004cc00: 6967 5f6e 756d 5f76 6172 7320 7768 6963  ig_num_vars whic
-0004cc10: 6820 6861 7665 2062 6565 6e20 6572 6173  h have been eras
-0004cc20: 6564 2e0d 0a20 2020 2020 2020 2065 6c73  ed...        els
-0004cc30: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0004cc40: 7072 696e 7428 2720 2020 2042 696e 6e69  print('    Binni
-0004cc50: 6e67 5f46 6c61 6720 7365 7420 746f 2046  ng_Flag set to F
-0004cc60: 616c 7365 206f 7220 7468 6572 6520 6172  alse or there ar
-0004cc70: 6520 6e6f 2066 6c6f 6174 2076 6172 7320  e no float vars 
-0004cc80: 696e 2064 6174 6120 7365 7420 746f 2062  in data set to b
-0004cc90: 6520 6269 6e6e 6564 2729 0d0a 2020 2020  e binned')..    
-0004cca0: 2020 2020 2323 2320 4e6f 7720 7765 2061      ### Now we a
-0004ccb0: 6464 2061 6e6f 7468 6572 2046 6561 7475  dd another Featu
-0004ccc0: 7265 2074 6965 6420 746f 204b 4d65 616e  re tied to KMean
-0004ccd0: 7320 636c 7573 7465 7269 6e67 2075 7369  s clustering usi
-0004cce0: 6e67 2050 7265 6469 6374 6f72 2061 6e64  ng Predictor and
-0004ccf0: 2054 6172 6765 7420 7661 7269 6162 6c65   Target variable
-0004cd00: 7320 2323 230d 0a20 2020 2020 2020 2023  s ###..        #
+0004c970: 2020 2020 2020 6d6f 6465 6c74 7970 652c        modeltype,
+0004c980: 2020 656e 7472 6f70 795f 6269 6e6e 696e    entropy_binnin
+0004c990: 673d 5472 7565 2c76 6572 626f 7365 3d76  g=True,verbose=v
+0004c9a0: 6572 626f 7365 290d 0a20 2020 2020 2020  erbose)..       
+0004c9b0: 2020 2020 2023 2323 2320 496e 2073 6176       #### In sav
+0004c9c0: 6564 5f6e 756d 5f76 6172 7320 7765 2073  ed_num_vars we s
+0004c9d0: 656e 6420 696e 2061 6c6c 2074 6865 2063  end in all the c
+0004c9e0: 6f6e 7469 6e75 6f75 735f 7661 7273 2062  ontinuous_vars b
+0004c9f0: 7574 2077 6520 6269 6e20 6f6e 6c79 2074  ut we bin only t
+0004ca00: 6865 2074 6f70 2066 6577 2076 6172 732e  he top few vars.
+0004ca10: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+0004ca20: 2320 2054 686f 7365 2074 6861 7420 6172  #  Those that ar
+0004ca30: 6520 6269 6e6e 6564 2061 7265 2072 656d  e binned are rem
+0004ca40: 6f76 6564 2066 726f 6d20 7361 7665 645f  oved from saved_
+0004ca50: 6e75 6d5f 7661 7273 2061 6e64 2074 6865  num_vars and the
+0004ca60: 2072 656d 6169 6e69 6e67 2062 6563 6f6d   remaining becom
+0004ca70: 6520 6e75 6d5f 7661 7273 0d0a 2020 2020  e num_vars..    
+0004ca80: 2020 2020 2020 2020 2323 2320 4f75 7220          ### Our 
+0004ca90: 6a6f 6220 6973 2074 6f20 6669 6e64 2074  job is to find t
+0004caa0: 6865 206e 616d 6573 206f 6620 7468 6f73  he names of thos
+0004cab0: 6520 6f72 6967 696e 616c 206e 756d 6572  e original numer
+0004cac0: 6963 2076 6172 6961 626c 6573 2077 6869  ic variables whi
+0004cad0: 6368 2077 6572 6520 6269 6e6e 6564 2e0d  ch were binned..
+0004cae0: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
+0004caf0: 206f 7269 675f 6e75 6d5f 7661 7273 2063   orig_num_vars c
+0004cb00: 6f6e 7461 696e 7320 6f72 6967 696e 616c  ontains original
+0004cb10: 206e 756d 2076 6172 732e 206e 756d 5f76   num vars. num_v
+0004cb20: 6172 7320 636f 6e74 6169 6e73 2062 696e  ars contains bin
+0004cb30: 6e65 6420 7665 7273 696f 6e73 206f 6620  ned versions of 
+0004cb40: 7468 6f73 6520 7661 7273 2e0d 0a20 2020  those vars...   
+0004cb50: 2020 2020 2020 2020 2023 2323 2054 686f           ### Tho
+0004cb60: 7365 2062 696e 6e65 6420 7661 7269 6162  se binned variab
+0004cb70: 6c65 7320 6861 7665 206e 6f77 2062 6563  les have now bec
+0004cb80: 6f6d 6520 6361 7465 676f 7269 6361 6c20  ome categorical 
+0004cb90: 7661 7273 2061 6e64 206d 7573 7420 6265  vars and must be
+0004cba0: 2061 6464 6564 2074 6f20 696d 705f 6361   added to imp_ca
+0004cbb0: 7473 2e0d 0a20 2020 2020 2020 2020 2020  ts...           
+0004cbc0: 2023 2323 2320 416c 736f 206e 6f74 6520   #### Also note 
+0004cbd0: 7468 6174 2069 6d70 6f72 7461 6e74 5f66  that important_f
+0004cbe0: 6561 7475 7265 7320 646f 6573 206e 6f74  eatures does not
+0004cbf0: 2063 6f6e 7461 696e 206f 7269 675f 6e75   contain orig_nu
+0004cc00: 6d5f 7661 7273 2077 6869 6368 2068 6176  m_vars which hav
+0004cc10: 6520 6265 656e 2065 7261 7365 642e 0d0a  e been erased...
+0004cc20: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0004cc30: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0004cc40: 2827 2020 2020 4269 6e6e 696e 675f 466c  ('    Binning_Fl
+0004cc50: 6167 2073 6574 2074 6f20 4661 6c73 6520  ag set to False 
+0004cc60: 6f72 2074 6865 7265 2061 7265 206e 6f20  or there are no 
+0004cc70: 666c 6f61 7420 7661 7273 2069 6e20 6461  float vars in da
+0004cc80: 7461 2073 6574 2074 6f20 6265 2062 696e  ta set to be bin
+0004cc90: 6e65 6427 290d 0a20 2020 2020 2020 2023  ned')..        #
+0004cca0: 2323 204e 6f77 2077 6520 6164 6420 616e  ## Now we add an
+0004ccb0: 6f74 6865 7220 4665 6174 7572 6520 7469  other Feature ti
+0004ccc0: 6564 2074 6f20 4b4d 6561 6e73 2063 6c75  ed to KMeans clu
+0004ccd0: 7374 6572 696e 6720 7573 696e 6720 5072  stering using Pr
+0004cce0: 6564 6963 746f 7220 616e 6420 5461 7267  edictor and Targ
+0004ccf0: 6574 2076 6172 6961 626c 6573 2023 2323  et variables ###
+0004cd00: 0d0a 2020 2020 2020 2020 2323 2323 2323  ..        ######
 0004cd10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004cd20: 2323 2323 2323 2020 204b 4d45 414e 5320  ######   KMEANS 
-0004cd30: 2020 5345 434f 4e44 2020 2054 494d 4520    SECOND   TIME 
-0004cd40: 2020 2020 2323 2323 2323 2323 2323 2323      ############
-0004cd50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004cd60: 0d0a 2020 2020 2020 2020 6966 204b 4d65  ..        if KMe
-0004cd70: 616e 735f 4665 6174 7572 697a 6572 2061  ans_Featurizer a
-0004cd80: 6e64 206c 656e 2873 6176 6564 5f6e 756d  nd len(saved_num
-0004cd90: 5f76 6172 7329 203e 2030 3a0d 0a20 2020  _vars) > 0:..   
-0004cda0: 2020 2020 2020 2020 2023 2323 2320 5065           #### Pe
-0004cdb0: 7266 6f72 6d20 4b4d 6561 6e73 2046 6561  rform KMeans Fea
-0004cdc0: 7475 7269 7a65 7220 6f6e 6c79 2069 6620  turizer only if 
-0004cdd0: 7468 6572 6520 6172 6520 6e75 6d65 7269  there are numeri
-0004cde0: 6320 7661 7269 6162 6c65 7320 696e 2064  c variables in d
-0004cdf0: 6174 6120 7365 7421 2023 2323 2323 2323  ata set! #######
-0004ce00: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-0004ce10: 7072 696e 7428 2741 6464 696e 6720 6f6e  print('Adding on
-0004ce20: 6520 6665 6174 7572 6520 6e61 6d65 6420  e feature named 
-0004ce30: 2573 2075 7369 6e67 204b 4d65 616e 735f  %s using KMeans_
-0004ce40: 4665 6174 7572 697a 6572 2e2e 2e27 2025  Featurizer...' %
-0004ce50: 6b6d 5f6c 6162 656c 290d 0a20 2020 2020  km_label)..     
-0004ce60: 2020 2020 2020 2023 2323 2320 4d61 6b65         #### Make
-0004ce70: 2074 6865 206e 756d 6265 7220 6f66 2063   the number of c
-0004ce80: 6c75 7374 6572 7320 6173 2074 6865 2073  lusters as the s
-0004ce90: 616d 6520 6173 206c 6f67 3130 206f 6620  ame as log10 of 
-0004cea0: 6e75 6d62 6572 206f 6620 726f 7773 2069  number of rows i
-0004ceb0: 6e20 5472 6169 6e0d 0a20 2020 2020 2020  n Train..       
-0004cec0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0004ced0: 6365 2874 6573 742c 2073 7472 293a 0d0a  ce(test, str):..
-0004cee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004cef0: 2323 2323 2049 6e20 736f 6d65 2063 6173  #### In some cas
-0004cf00: 6573 2c20 7465 7374 2064 6174 6120 6d61  es, test data ma
-0004cf10: 7920 6e6f 7420 6265 2061 7661 696c 6162  y not be availab
-0004cf20: 6c65 2e20 496e 2074 6861 7420 6361 7365  le. In that case
-0004cf30: 2c20 6a75 7374 2073 656e 6420 696e 2074  , just send in t
-0004cf40: 7261 696e 2061 7320 7465 7374 0d0a 2020  rain as test..  
-0004cf50: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-0004cf60: 6169 6e5f 636c 7573 7465 722c 205f 203d  ain_cluster, _ =
-0004cf70: 2054 7261 6e73 666f 726d 5f4b 4d5f 4665   Transform_KM_Fe
-0004cf80: 6174 7572 6573 2874 7261 696e 5b69 6d70  atures(train[imp
-0004cf90: 6f72 7461 6e74 5f66 6561 7475 7265 735d  ortant_features]
-0004cfa0: 2c20 7472 6169 6e5b 0d0a 2020 2020 2020  , train[..      
+0004cd20: 2320 2020 4b4d 4541 4e53 2020 2053 4543  #   KMEANS   SEC
+0004cd30: 4f4e 4420 2020 5449 4d45 2020 2020 2023  OND   TIME     #
+0004cd40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004cd50: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+0004cd60: 2020 2020 2069 6620 4b4d 6561 6e73 5f46       if KMeans_F
+0004cd70: 6561 7475 7269 7a65 7220 616e 6420 6c65  eaturizer and le
+0004cd80: 6e28 7361 7665 645f 6e75 6d5f 7661 7273  n(saved_num_vars
+0004cd90: 2920 3e20 303a 0d0a 2020 2020 2020 2020  ) > 0:..        
+0004cda0: 2020 2020 2323 2323 2050 6572 666f 726d      #### Perform
+0004cdb0: 204b 4d65 616e 7320 4665 6174 7572 697a   KMeans Featuriz
+0004cdc0: 6572 206f 6e6c 7920 6966 2074 6865 7265  er only if there
+0004cdd0: 2061 7265 206e 756d 6572 6963 2076 6172   are numeric var
+0004cde0: 6961 626c 6573 2069 6e20 6461 7461 2073  iables in data s
+0004cdf0: 6574 2120 2323 2323 2323 2323 230d 0a20  et! #########.. 
+0004ce00: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0004ce10: 2827 4164 6469 6e67 206f 6e65 2066 6561  ('Adding one fea
+0004ce20: 7475 7265 206e 616d 6564 2025 7320 7573  ture named %s us
+0004ce30: 696e 6720 4b4d 6561 6e73 5f46 6561 7475  ing KMeans_Featu
+0004ce40: 7269 7a65 722e 2e2e 2720 256b 6d5f 6c61  rizer...' %km_la
+0004ce50: 6265 6c29 0d0a 2020 2020 2020 2020 2020  bel)..          
+0004ce60: 2020 2323 2323 204d 616b 6520 7468 6520    #### Make the 
+0004ce70: 6e75 6d62 6572 206f 6620 636c 7573 7465  number of cluste
+0004ce80: 7273 2061 7320 7468 6520 7361 6d65 2061  rs as the same a
+0004ce90: 7320 6c6f 6731 3020 6f66 206e 756d 6265  s log10 of numbe
+0004cea0: 7220 6f66 2072 6f77 7320 696e 2054 7261  r of rows in Tra
+0004ceb0: 696e 0d0a 2020 2020 2020 2020 2020 2020  in..            
+0004cec0: 6966 2069 7369 6e73 7461 6e63 6528 7465  if isinstance(te
+0004ced0: 7374 2c20 7374 7229 3a0d 0a20 2020 2020  st, str):..     
+0004cee0: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
+0004cef0: 496e 2073 6f6d 6520 6361 7365 732c 2074  In some cases, t
+0004cf00: 6573 7420 6461 7461 206d 6179 206e 6f74  est data may not
+0004cf10: 2062 6520 6176 6169 6c61 626c 652e 2049   be available. I
+0004cf20: 6e20 7468 6174 2063 6173 652c 206a 7573  n that case, jus
+0004cf30: 7420 7365 6e64 2069 6e20 7472 6169 6e20  t send in train 
+0004cf40: 6173 2074 6573 740d 0a20 2020 2020 2020  as test..       
+0004cf50: 2020 2020 2020 2020 2074 7261 696e 5f63           train_c
+0004cf60: 6c75 7374 6572 2c20 5f20 3d20 5472 616e  luster, _ = Tran
+0004cf70: 7366 6f72 6d5f 4b4d 5f46 6561 7475 7265  sform_KM_Feature
+0004cf80: 7328 7472 6169 6e5b 696d 706f 7274 616e  s(train[importan
+0004cf90: 745f 6665 6174 7572 6573 5d2c 2074 7261  t_features], tra
+0004cfa0: 696e 5b0d 0a20 2020 2020 2020 2020 2020  in[..           
 0004cfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004cfc0: 2020 2020 2020 2020 2020 2020 2020 6561                ea
-0004cfd0: 6368 5f74 6172 6765 745d 2c20 7472 6169  ch_target], trai
-0004cfe0: 6e5b 696d 706f 7274 616e 745f 6665 6174  n[important_feat
-0004cff0: 7572 6573 5d2c 206e 756d 5f63 6c75 7374  ures], num_clust
-0004d000: 6572 7329 0d0a 2020 2020 2020 2020 2020  ers)..          
-0004d010: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0004d020: 2020 2020 2020 2020 2023 2323 2320 4966           #### If
-0004d030: 2074 6573 7420 6461 7461 2069 7320 6176   test data is av
-0004d040: 6169 6c61 626c 652c 2073 656e 6420 696e  ailable, send in
-0004d050: 2074 6573 7420 6461 7461 2074 6f20 6765   test data to ge
-0004d060: 7420 4b4d 2063 6c75 7374 6572 7320 666f  t KM clusters fo
-0004d070: 7220 7465 7374 2023 2323 0d0a 2020 2020  r test ###..    
-0004d080: 2020 2020 2020 2020 2020 2020 7472 6169              trai
-0004d090: 6e5f 636c 7573 7465 722c 2074 6573 745f  n_cluster, test_
-0004d0a0: 636c 7573 7465 7220 3d20 5472 616e 7366  cluster = Transf
-0004d0b0: 6f72 6d5f 4b4d 5f46 6561 7475 7265 7328  orm_KM_Features(
-0004d0c0: 7472 6169 6e5b 696d 706f 7274 616e 745f  train[important_
-0004d0d0: 6665 6174 7572 6573 5d2c 2074 7261 696e  features], train
-0004d0e0: 5b0d 0a20 2020 2020 2020 2020 2020 2020  [..             
+0004cfc0: 2020 2020 2020 2020 2065 6163 685f 7461           each_ta
+0004cfd0: 7267 6574 5d2c 2074 7261 696e 5b69 6d70  rget], train[imp
+0004cfe0: 6f72 7461 6e74 5f66 6561 7475 7265 735d  ortant_features]
+0004cff0: 2c20 6e75 6d5f 636c 7573 7465 7273 290d  , num_clusters).
+0004d000: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0004d010: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0004d020: 2020 2020 2323 2323 2049 6620 7465 7374      #### If test
+0004d030: 2064 6174 6120 6973 2061 7661 696c 6162   data is availab
+0004d040: 6c65 2c20 7365 6e64 2069 6e20 7465 7374  le, send in test
+0004d050: 2064 6174 6120 746f 2067 6574 204b 4d20   data to get KM 
+0004d060: 636c 7573 7465 7273 2066 6f72 2074 6573  clusters for tes
+0004d070: 7420 2323 230d 0a20 2020 2020 2020 2020  t ###..         
+0004d080: 2020 2020 2020 2074 7261 696e 5f63 6c75         train_clu
+0004d090: 7374 6572 2c20 7465 7374 5f63 6c75 7374  ster, test_clust
+0004d0a0: 6572 203d 2054 7261 6e73 666f 726d 5f4b  er = Transform_K
+0004d0b0: 4d5f 4665 6174 7572 6573 2874 7261 696e  M_Features(train
+0004d0c0: 5b69 6d70 6f72 7461 6e74 5f66 6561 7475  [important_featu
+0004d0d0: 7265 735d 2c20 7472 6169 6e5b 0d0a 2020  res], train[..  
+0004d0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004d0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d100: 2020 2020 2020 2065 6163 685f 7461 7267         each_targ
-0004d110: 6574 5d2c 2074 6573 745b 696d 706f 7274  et], test[import
-0004d120: 616e 745f 6665 6174 7572 6573 5d2c 206e  ant_features], n
-0004d130: 756d 5f63 6c75 7374 6572 7329 0d0a 2020  um_clusters)..  
-0004d140: 2020 2020 2020 2020 2020 2323 2323 204e            #### N
-0004d150: 6f77 206d 616b 6520 7375 7265 2074 6861  ow make sure tha
-0004d160: 7420 7468 6520 6361 7420 6665 6174 7572  t the cat featur
-0004d170: 6573 2061 7265 2065 6974 6865 7220 7374  es are either st
-0004d180: 7269 6e67 206f 7220 696e 7465 6765 7273  ring or integers
-0004d190: 2023 2323 2323 230d 0a20 2020 2020 2020   ######..       
-0004d1a0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-0004d1b0: 5573 6564 204b 4d65 616e 7320 746f 206e  Used KMeans to n
-0004d1c0: 6174 7572 616c 6c79 2063 6c75 7374 6572  aturally cluster
-0004d1d0: 2054 7261 696e 2070 7265 6469 6374 6f72   Train predictor
-0004d1e0: 2076 6172 6961 626c 6573 2069 6e74 6f20   variables into 
-0004d1f0: 2564 2063 6c75 7374 6572 7327 2025 6e75  %d clusters' %nu
-0004d200: 6d5f 636c 7573 7465 7273 290d 0a20 2020  m_clusters)..   
-0004d210: 2020 2020 2020 2020 2074 7261 696e 5b6b           train[k
-0004d220: 6d5f 6c61 6265 6c5d 203d 2074 7261 696e  m_label] = train
-0004d230: 5f63 6c75 7374 6572 0d0a 2020 2020 2020  _cluster..      
-0004d240: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-0004d250: 6e73 7461 6e63 6528 7465 7374 2c20 7374  nstance(test, st
-0004d260: 7229 3a0d 0a20 2020 2020 2020 2020 2020  r):..           
-0004d270: 2020 2020 2074 6573 745b 6b6d 5f6c 6162       test[km_lab
-0004d280: 656c 5d20 3d20 7465 7374 5f63 6c75 7374  el] = test_clust
-0004d290: 6572 0d0a 2020 2020 2020 2020 2020 2020  er..            
-0004d2a0: 2358 5f74 7261 696e 2e64 726f 7028 6561  #X_train.drop(ea
-0004d2b0: 6368 5f74 6172 6765 742c 6178 6973 3d31  ch_target,axis=1
-0004d2c0: 2c69 6e70 6c61 6365 3d54 7275 6529 0d0a  ,inplace=True)..
-0004d2d0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0004d2e0: 696d 705f 6361 7420 696e 2069 6d70 5f63  imp_cat in imp_c
-0004d2f0: 6174 733a 0d0a 2020 2020 2020 2020 2020  ats:..          
-0004d300: 2020 2020 2020 7472 6169 6e5b 696d 705f        train[imp_
-0004d310: 6361 745d 203d 2074 7261 696e 5b69 6d70  cat] = train[imp
-0004d320: 5f63 6174 5d2e 6173 7479 7065 2869 6e74  _cat].astype(int
-0004d330: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0004d340: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-0004d350: 616e 6365 2874 6573 742c 2073 7472 293a  ance(test, str):
-0004d360: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004d370: 2020 2020 2020 7465 7374 5b69 6d70 5f63        test[imp_c
-0004d380: 6174 5d20 3d20 7465 7374 5b69 6d70 5f63  at] = test[imp_c
-0004d390: 6174 5d2e 6173 7479 7065 2869 6e74 290d  at].astype(int).
-0004d3a0: 0a20 2020 2020 2020 2020 2020 2073 6176  .            sav
-0004d3b0: 6564 5f6e 756d 5f76 6172 732e 6170 7065  ed_num_vars.appe
-0004d3c0: 6e64 286b 6d5f 6c61 6265 6c29 2023 2323  nd(km_label) ###
-0004d3d0: 2059 6f75 206e 6565 6420 746f 2061 6464   You need to add
-0004d3e0: 2069 7420 746f 2074 6869 7320 7661 7269   it to this vari
-0004d3f0: 6162 6c65 206c 6973 7420 666f 7220 5363  able list for Sc
-0004d400: 616c 696e 6720 6c61 7465 7221 0d0a 2020  aling later!..  
-0004d410: 2020 2020 2020 2020 2020 696d 706f 7274            import
-0004d420: 616e 745f 6665 6174 7572 6573 2e61 7070  ant_features.app
-0004d430: 656e 6428 6b6d 5f6c 6162 656c 290d 0a20  end(km_label).. 
-0004d440: 2020 2020 2020 2023 2323 2323 2323 2323         #########
-0004d450: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004d460: 2320 5354 4143 4b49 4e47 2053 4543 4f4e  # STACKING SECON
-0004d470: 4420 5449 4d45 2020 2323 2323 2323 2323  D TIME  ########
+0004d100: 2020 6561 6368 5f74 6172 6765 745d 2c20    each_target], 
+0004d110: 7465 7374 5b69 6d70 6f72 7461 6e74 5f66  test[important_f
+0004d120: 6561 7475 7265 735d 2c20 6e75 6d5f 636c  eatures], num_cl
+0004d130: 7573 7465 7273 290d 0a20 2020 2020 2020  usters)..       
+0004d140: 2020 2020 2023 2323 2320 4e6f 7720 6d61       #### Now ma
+0004d150: 6b65 2073 7572 6520 7468 6174 2074 6865  ke sure that the
+0004d160: 2063 6174 2066 6561 7475 7265 7320 6172   cat features ar
+0004d170: 6520 6569 7468 6572 2073 7472 696e 6720  e either string 
+0004d180: 6f72 2069 6e74 6567 6572 7320 2323 2323  or integers ####
+0004d190: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
+0004d1a0: 7072 696e 7428 2720 2020 2055 7365 6420  print('    Used 
+0004d1b0: 4b4d 6561 6e73 2074 6f20 6e61 7475 7261  KMeans to natura
+0004d1c0: 6c6c 7920 636c 7573 7465 7220 5472 6169  lly cluster Trai
+0004d1d0: 6e20 7072 6564 6963 746f 7220 7661 7269  n predictor vari
+0004d1e0: 6162 6c65 7320 696e 746f 2025 6420 636c  ables into %d cl
+0004d1f0: 7573 7465 7273 2720 256e 756d 5f63 6c75  usters' %num_clu
+0004d200: 7374 6572 7329 0d0a 2020 2020 2020 2020  sters)..        
+0004d210: 2020 2020 7472 6169 6e5b 6b6d 5f6c 6162      train[km_lab
+0004d220: 656c 5d20 3d20 7472 6169 6e5f 636c 7573  el] = train_clus
+0004d230: 7465 720d 0a20 2020 2020 2020 2020 2020  ter..           
+0004d240: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+0004d250: 6365 2874 6573 742c 2073 7472 293a 0d0a  ce(test, str):..
+0004d260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d270: 7465 7374 5b6b 6d5f 6c61 6265 6c5d 203d  test[km_label] =
+0004d280: 2074 6573 745f 636c 7573 7465 720d 0a20   test_cluster.. 
+0004d290: 2020 2020 2020 2020 2020 2023 585f 7472             #X_tr
+0004d2a0: 6169 6e2e 6472 6f70 2865 6163 685f 7461  ain.drop(each_ta
+0004d2b0: 7267 6574 2c61 7869 733d 312c 696e 706c  rget,axis=1,inpl
+0004d2c0: 6163 653d 5472 7565 290d 0a20 2020 2020  ace=True)..     
+0004d2d0: 2020 2020 2020 2066 6f72 2069 6d70 5f63         for imp_c
+0004d2e0: 6174 2069 6e20 696d 705f 6361 7473 3a0d  at in imp_cats:.
+0004d2f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004d300: 2074 7261 696e 5b69 6d70 5f63 6174 5d20   train[imp_cat] 
+0004d310: 3d20 7472 6169 6e5b 696d 705f 6361 745d  = train[imp_cat]
+0004d320: 2e61 7374 7970 6528 696e 7429 0d0a 2020  .astype(int)..  
+0004d330: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0004d340: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+0004d350: 7465 7374 2c20 7374 7229 3a0d 0a20 2020  test, str):..   
+0004d360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d370: 2074 6573 745b 696d 705f 6361 745d 203d   test[imp_cat] =
+0004d380: 2074 6573 745b 696d 705f 6361 745d 2e61   test[imp_cat].a
+0004d390: 7374 7970 6528 696e 7429 0d0a 2020 2020  stype(int)..    
+0004d3a0: 2020 2020 2020 2020 7361 7665 645f 6e75          saved_nu
+0004d3b0: 6d5f 7661 7273 2e61 7070 656e 6428 6b6d  m_vars.append(km
+0004d3c0: 5f6c 6162 656c 2920 2323 2320 596f 7520  _label) ### You 
+0004d3d0: 6e65 6564 2074 6f20 6164 6420 6974 2074  need to add it t
+0004d3e0: 6f20 7468 6973 2076 6172 6961 626c 6520  o this variable 
+0004d3f0: 6c69 7374 2066 6f72 2053 6361 6c69 6e67  list for Scaling
+0004d400: 206c 6174 6572 210d 0a20 2020 2020 2020   later!..       
+0004d410: 2020 2020 2069 6d70 6f72 7461 6e74 5f66       important_f
+0004d420: 6561 7475 7265 732e 6170 7065 6e64 286b  eatures.append(k
+0004d430: 6d5f 6c61 6265 6c29 0d0a 2020 2020 2020  m_label)..      
+0004d440: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
+0004d450: 2323 2323 2323 2323 2323 2323 2053 5441  ############ STA
+0004d460: 434b 494e 4720 5345 434f 4e44 2054 494d  CKING SECOND TIM
+0004d470: 4520 2023 2323 2323 2323 2323 2323 2323  E  #############
 0004d480: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004d490: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
-0004d4a0: 2023 2323 2323 2323 2323 2054 6869 7320   ######### This 
-0004d4b0: 6973 2077 6865 7265 2079 6f75 2064 6f20  is where you do 
-0004d4c0: 5374 6163 6b69 6e67 206f 6620 4d75 6c74  Stacking of Mult
-0004d4d0: 6920 4d6f 6465 6c20 5265 7375 6c74 7320  i Model Results 
-0004d4e0: 696e 746f 204f 6e65 2043 6f6c 756d 6e20  into One Column 
-0004d4f0: 2323 230d 0a20 2020 2020 2020 2069 6620  ###..        if 
-0004d500: 5374 6163 6b69 6e67 5f46 6c61 673a 0d0a  Stacking_Flag:..
-0004d510: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-0004d520: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004d530: 2020 2323 2323 2049 6e20 6f72 6465 7220    #### In order 
-0004d540: 746f 206a 6f69 6e2c 2079 6f75 206e 6565  to join, you nee
-0004d550: 6420 585f 7472 6169 6e20 746f 2062 6520  d X_train to be 
-0004d560: 6120 5061 6e64 6173 2053 6572 6965 7320  a Pandas Series 
-0004d570: 6865 7265 2023 230d 0a20 2020 2020 2020  here ##..       
-0004d580: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-0004d590: 4341 5554 494f 4e3a 2053 7461 636b 696e  CAUTION: Stackin
-0004d5a0: 6720 6361 6e20 7072 6f64 7563 6520 4869  g can produce Hi
-0004d5b0: 6768 6c79 204f 7665 7266 6974 206d 6f64  ghly Overfit mod
-0004d5c0: 656c 7320 6f6e 2054 7261 696e 696e 6720  els on Training 
-0004d5d0: 4461 7461 2e2e 2e27 290d 0a20 2020 2020  Data...')..     
-0004d5e0: 2020 2020 2020 2020 2020 2023 2323 2049             ### I
-0004d5f0: 6e20 6f72 6465 7220 746f 2061 766f 6964  n order to avoid
-0004d600: 206f 7665 7266 6974 7469 6e67 2c20 7765   overfitting, we
-0004d610: 2061 7265 2067 6f69 6e67 2074 6f20 6c65   are going to le
-0004d620: 6172 6e20 6672 6f6d 2061 2073 6d61 6c6c  arn from a small
-0004d630: 2073 616d 706c 6520 6f66 2064 6174 610d   sample of data.
-0004d640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004d650: 2023 2323 2054 6861 7420 6973 2077 6879   ### That is why
-0004d660: 2077 6520 6172 6520 7573 696e 6720 585f   we are using X_
-0004d670: 6376 2074 6f20 7472 6169 6e20 6f6e 2061  cv to train on a
-0004d680: 6e64 2075 7369 6e67 2069 7420 746f 2070  nd using it to p
-0004d690: 7265 6469 6374 206f 6e20 585f 7472 6169  redict on X_trai
-0004d6a0: 6e21 0d0a 2020 2020 2020 2020 2020 2020  n!..            
-0004d6b0: 2020 2020 6164 6463 6f6c 2c20 7374 6163      addcol, stac
-0004d6c0: 6b73 3120 3d20 5175 6963 6b4d 4c5f 5374  ks1 = QuickML_St
-0004d6d0: 6163 6b69 6e67 2874 7261 696e 5b69 6d70  acking(train[imp
-0004d6e0: 6f72 7461 6e74 5f66 6561 7475 7265 735d  ortant_features]
-0004d6f0: 2c74 7261 696e 5b65 6163 685f 7461 7267  ,train[each_targ
-0004d700: 6574 5d2c 2727 2c0d 0a20 2020 2020 2020  et],'',..       
+0004d490: 2323 0d0a 2020 2020 2020 2020 2323 2323  ##..        ####
+0004d4a0: 2323 2323 2320 5468 6973 2069 7320 7768  ##### This is wh
+0004d4b0: 6572 6520 796f 7520 646f 2053 7461 636b  ere you do Stack
+0004d4c0: 696e 6720 6f66 204d 756c 7469 204d 6f64  ing of Multi Mod
+0004d4d0: 656c 2052 6573 756c 7473 2069 6e74 6f20  el Results into 
+0004d4e0: 4f6e 6520 436f 6c75 6d6e 2023 2323 0d0a  One Column ###..
+0004d4f0: 2020 2020 2020 2020 6966 2053 7461 636b          if Stack
+0004d500: 696e 675f 466c 6167 3a0d 0a20 2020 2020  ing_Flag:..     
+0004d510: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+0004d520: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+0004d530: 2320 496e 206f 7264 6572 2074 6f20 6a6f  # In order to jo
+0004d540: 696e 2c20 796f 7520 6e65 6564 2058 5f74  in, you need X_t
+0004d550: 7261 696e 2074 6f20 6265 2061 2050 616e  rain to be a Pan
+0004d560: 6461 7320 5365 7269 6573 2068 6572 6520  das Series here 
+0004d570: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
+0004d580: 2020 2020 7072 696e 7428 2743 4155 5449      print('CAUTI
+0004d590: 4f4e 3a20 5374 6163 6b69 6e67 2063 616e  ON: Stacking can
+0004d5a0: 2070 726f 6475 6365 2048 6967 686c 7920   produce Highly 
+0004d5b0: 4f76 6572 6669 7420 6d6f 6465 6c73 206f  Overfit models o
+0004d5c0: 6e20 5472 6169 6e69 6e67 2044 6174 612e  n Training Data.
+0004d5d0: 2e2e 2729 0d0a 2020 2020 2020 2020 2020  ..')..          
+0004d5e0: 2020 2020 2020 2323 2320 496e 206f 7264        ### In ord
+0004d5f0: 6572 2074 6f20 6176 6f69 6420 6f76 6572  er to avoid over
+0004d600: 6669 7474 696e 672c 2077 6520 6172 6520  fitting, we are 
+0004d610: 676f 696e 6720 746f 206c 6561 726e 2066  going to learn f
+0004d620: 726f 6d20 6120 736d 616c 6c20 7361 6d70  rom a small samp
+0004d630: 6c65 206f 6620 6461 7461 0d0a 2020 2020  le of data..    
+0004d640: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+0004d650: 5468 6174 2069 7320 7768 7920 7765 2061  That is why we a
+0004d660: 7265 2075 7369 6e67 2058 5f63 7620 746f  re using X_cv to
+0004d670: 2074 7261 696e 206f 6e20 616e 6420 7573   train on and us
+0004d680: 696e 6720 6974 2074 6f20 7072 6564 6963  ing it to predic
+0004d690: 7420 6f6e 2058 5f74 7261 696e 210d 0a20  t on X_train!.. 
+0004d6a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0004d6b0: 6464 636f 6c2c 2073 7461 636b 7331 203d  ddcol, stacks1 =
+0004d6c0: 2051 7569 636b 4d4c 5f53 7461 636b 696e   QuickML_Stackin
+0004d6d0: 6728 7472 6169 6e5b 696d 706f 7274 616e  g(train[importan
+0004d6e0: 745f 6665 6174 7572 6573 5d2c 7472 6169  t_features],trai
+0004d6f0: 6e5b 6561 6368 5f74 6172 6765 745d 2c27  n[each_target],'
+0004d700: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
 0004d710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d720: 2020 2020 2020 206d 6f64 656c 7479 7065         modeltype
-0004d730: 2c20 426f 6f73 7469 6e67 5f46 6c61 672c  , Boosting_Flag,
-0004d740: 2073 636f 7269 6e67 5f70 6172 616d 6574   scoring_paramet
-0004d750: 6572 2c76 6572 626f 7365 290d 0a20 2020  er,verbose)..   
-0004d760: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-0004d770: 2323 2041 6464 696e 6720 6d75 6c74 6970  ## Adding multip
-0004d780: 6c65 2063 6f6c 756d 6e73 2066 6f72 2053  le columns for S
-0004d790: 7461 636b 696e 6720 6973 2062 6573 7421  tacking is best!
-0004d7a0: 2044 6f20 6e6f 7420 646f 2074 6865 2061   Do not do the a
-0004d7b0: 7665 7261 6765 206f 6620 7072 6564 6963  verage of predic
-0004d7c0: 7469 6f6e 7321 0d0a 2020 2020 2020 2020  tions!..        
-0004d7d0: 2020 2020 2020 2020 2323 2323 2054 6865          #### The
-0004d7e0: 2072 6561 736f 6e20 7765 2061 6464 2074   reason we add t
-0004d7f0: 6865 2077 6f72 6420 2250 6172 7469 616c  he word "Partial
-0004d800: 5f54 7261 696e 2220 6973 2074 6f20 7368  _Train" is to sh
-0004d810: 6f77 2074 6861 7420 7468 6573 6520 5374  ow that these St
-0004d820: 6163 6b69 6e67 2072 6573 756c 7473 2061  acking results a
-0004d830: 7265 2066 726f 6d20 5061 7274 6961 6c20  re from Partial 
-0004d840: 5472 6169 6e20 6461 7461 210d 0a20 2020  Train data!..   
-0004d850: 2020 2020 2020 2020 2020 2020 2061 6464               add
-0004d860: 636f 6c73 203d 2063 6f70 792e 6465 6570  cols = copy.deep
-0004d870: 636f 7079 2861 6464 636f 6c29 0d0a 2020  copy(addcol)..  
-0004d880: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-0004d890: 2323 2320 4164 6469 6e67 206d 756c 7469  ### Adding multi
-0004d8a0: 706c 6520 636f 6c75 6d6e 7320 666f 7220  ple columns for 
-0004d8b0: 5374 6163 6b69 6e67 2069 7320 6265 7374  Stacking is best
-0004d8c0: 2120 446f 206e 6f74 2064 6f20 7468 6520  ! Do not do the 
-0004d8d0: 6176 6572 6167 6520 6f66 2070 7265 6469  average of predi
-0004d8e0: 6374 696f 6e73 210d 0a20 2020 2020 2020  ctions!..       
-0004d8f0: 2020 2020 2020 2020 2074 7261 696e 203d           train =
-0004d900: 2074 7261 696e 2e6a 6f69 6e28 7064 2e44   train.join(pd.D
-0004d910: 6174 6146 7261 6d65 2873 7461 636b 7331  ataFrame(stacks1
-0004d920: 2c69 6e64 6578 3d74 7261 696e 2e69 6e64  ,index=train.ind
-0004d930: 6578 2c0d 0a20 2020 2020 2020 2020 2020  ex,..           
+0004d720: 2020 6d6f 6465 6c74 7970 652c 2042 6f6f    modeltype, Boo
+0004d730: 7374 696e 675f 466c 6167 2c20 7363 6f72  sting_Flag, scor
+0004d740: 696e 675f 7061 7261 6d65 7465 722c 7665  ing_parameter,ve
+0004d750: 7262 6f73 6529 0d0a 2020 2020 2020 2020  rbose)..        
+0004d760: 2020 2020 2020 2020 2323 2323 2320 4164          ##### Ad
+0004d770: 6469 6e67 206d 756c 7469 706c 6520 636f  ding multiple co
+0004d780: 6c75 6d6e 7320 666f 7220 5374 6163 6b69  lumns for Stacki
+0004d790: 6e67 2069 7320 6265 7374 2120 446f 206e  ng is best! Do n
+0004d7a0: 6f74 2064 6f20 7468 6520 6176 6572 6167  ot do the averag
+0004d7b0: 6520 6f66 2070 7265 6469 6374 696f 6e73  e of predictions
+0004d7c0: 210d 0a20 2020 2020 2020 2020 2020 2020  !..             
+0004d7d0: 2020 2023 2323 2320 5468 6520 7265 6173     #### The reas
+0004d7e0: 6f6e 2077 6520 6164 6420 7468 6520 776f  on we add the wo
+0004d7f0: 7264 2022 5061 7274 6961 6c5f 5472 6169  rd "Partial_Trai
+0004d800: 6e22 2069 7320 746f 2073 686f 7720 7468  n" is to show th
+0004d810: 6174 2074 6865 7365 2053 7461 636b 696e  at these Stackin
+0004d820: 6720 7265 7375 6c74 7320 6172 6520 6672  g results are fr
+0004d830: 6f6d 2050 6172 7469 616c 2054 7261 696e  om Partial Train
+0004d840: 2064 6174 6121 0d0a 2020 2020 2020 2020   data!..        
+0004d850: 2020 2020 2020 2020 6164 6463 6f6c 7320          addcols 
+0004d860: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+0004d870: 6164 6463 6f6c 290d 0a20 2020 2020 2020  addcol)..       
+0004d880: 2020 2020 2020 2020 2023 2323 2323 2041           ##### A
+0004d890: 6464 696e 6720 6d75 6c74 6970 6c65 2063  dding multiple c
+0004d8a0: 6f6c 756d 6e73 2066 6f72 2053 7461 636b  olumns for Stack
+0004d8b0: 696e 6720 6973 2062 6573 7421 2044 6f20  ing is best! Do 
+0004d8c0: 6e6f 7420 646f 2074 6865 2061 7665 7261  not do the avera
+0004d8d0: 6765 206f 6620 7072 6564 6963 7469 6f6e  ge of prediction
+0004d8e0: 7321 0d0a 2020 2020 2020 2020 2020 2020  s!..            
+0004d8f0: 2020 2020 7472 6169 6e20 3d20 7472 6169      train = trai
+0004d900: 6e2e 6a6f 696e 2870 642e 4461 7461 4672  n.join(pd.DataFr
+0004d910: 616d 6528 7374 6163 6b73 312c 696e 6465  ame(stacks1,inde
+0004d920: 783d 7472 6169 6e2e 696e 6465 782c 0d0a  x=train.index,..
+0004d930: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004d940: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004d950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d960: 2020 2020 2020 2063 6f6c 756d 6e73 3d61         columns=a
-0004d970: 6464 636f 6c73 2929 0d0a 2020 2020 2020  ddcols))..      
-0004d980: 2020 2020 2020 2020 2020 2323 2323 2320            ##### 
-0004d990: 4c65 6176 696e 6720 6d75 6c74 6970 6c65  Leaving multiple
-0004d9a0: 2063 6f6c 756d 6e73 2066 6f72 2053 7461   columns for Sta
-0004d9b0: 636b 696e 6720 6973 2062 6573 7421 2044  cking is best! D
-0004d9c0: 6f20 6e6f 7420 646f 2074 6865 2061 7665  o not do the ave
-0004d9d0: 7261 6765 206f 6620 7072 6564 6963 7469  rage of predicti
-0004d9e0: 6f6e 7321 0d0a 2020 2020 2020 2020 2020  ons!..          
-0004d9f0: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-0004da00: 2041 6464 696e 6720 2564 2053 7461 636b   Adding %d Stack
-0004da10: 696e 6720 6665 6174 7572 6528 7329 2074  ing feature(s) t
-0004da20: 6f20 7472 6169 6e69 6e67 2064 6174 6127  o training data'
-0004da30: 2025 6c65 6e28 6164 6463 6f6c 7329 290d   %len(addcols)).
-0004da40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004da50: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-0004da60: 6365 286f 7269 675f 7465 7374 2c20 7374  ce(orig_test, st
-0004da70: 7229 3a0d 0a20 2020 2020 2020 2020 2020  r):..           
-0004da80: 2020 2020 2020 2020 2023 2323 2049 6e20           ### In 
-0004da90: 6f72 6465 7220 746f 2061 766f 6964 206f  order to avoid o
-0004daa0: 7665 7266 6974 7469 6e67 2c20 7765 2061  verfitting, we a
-0004dab0: 7265 2067 6f69 6e67 2074 6f20 6c65 6172  re going to lear
-0004dac0: 6e20 6672 6f6d 2061 2073 6d61 6c6c 2073  n from a small s
-0004dad0: 616d 706c 6520 6f66 2064 6174 610d 0a20  ample of data.. 
-0004dae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004daf0: 2020 2023 2323 2054 6861 7420 6973 2077     ### That is w
-0004db00: 6879 2077 6520 6172 6520 7573 696e 6720  hy we are using 
-0004db10: 585f 7472 6169 6e20 746f 2074 7261 696e  X_train to train
-0004db20: 206f 6e20 616e 6420 7573 696e 6720 6974   on and using it
-0004db30: 2074 6f20 7072 6564 6963 7420 6f6e 2058   to predict on X
-0004db40: 5f74 6573 740d 0a20 2020 2020 2020 2020  _test..         
-0004db50: 2020 2020 2020 2020 2020 205f 2c20 7374             _, st
-0004db60: 6163 6b73 3220 3d20 5175 6963 6b4d 4c5f  acks2 = QuickML_
-0004db70: 5374 6163 6b69 6e67 2874 7261 696e 5b69  Stacking(train[i
-0004db80: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
-0004db90: 735d 2c74 7261 696e 5b65 6163 685f 7461  s],train[each_ta
-0004dba0: 7267 6574 5d2c 7465 7374 5b69 6d70 6f72  rget],test[impor
-0004dbb0: 7461 6e74 5f66 6561 7475 7265 735d 2c0d  tant_features],.
-0004dbc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004dbd0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0004dbe0: 6f64 656c 7479 7065 2c20 426f 6f73 7469  odeltype, Boosti
-0004dbf0: 6e67 5f46 6c61 672c 2073 636f 7269 6e67  ng_Flag, scoring
-0004dc00: 5f70 6172 616d 6574 6572 2c76 6572 626f  _parameter,verbo
-0004dc10: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
-0004dc20: 2020 2020 2020 2020 2023 2323 2323 2041           ##### A
-0004dc30: 6464 696e 6720 6d75 6c74 6970 6c65 2063  dding multiple c
-0004dc40: 6f6c 756d 6e73 2066 6f72 2053 7461 636b  olumns for Stack
-0004dc50: 696e 6720 6973 2062 6573 7421 2044 6f20  ing is best! Do 
-0004dc60: 6e6f 7420 646f 2074 6865 2061 7665 7261  not do the avera
-0004dc70: 6765 206f 6620 7072 6564 6963 7469 6f6e  ge of prediction
-0004dc80: 7321 0d0a 2020 2020 2020 2020 2020 2020  s!..            
-0004dc90: 2020 2020 2020 2020 7465 7374 203d 2074          test = t
-0004dca0: 6573 742e 6a6f 696e 2870 642e 4461 7461  est.join(pd.Data
-0004dcb0: 4672 616d 6528 7374 6163 6b73 322c 696e  Frame(stacks2,in
-0004dcc0: 6465 783d 7465 7374 2e69 6e64 6578 2c0d  dex=test.index,.
-0004dcd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004d960: 2020 636f 6c75 6d6e 733d 6164 6463 6f6c    columns=addcol
+0004d970: 7329 290d 0a20 2020 2020 2020 2020 2020  s))..           
+0004d980: 2020 2020 2023 2323 2323 204c 6561 7669       ##### Leavi
+0004d990: 6e67 206d 756c 7469 706c 6520 636f 6c75  ng multiple colu
+0004d9a0: 6d6e 7320 666f 7220 5374 6163 6b69 6e67  mns for Stacking
+0004d9b0: 2069 7320 6265 7374 2120 446f 206e 6f74   is best! Do not
+0004d9c0: 2064 6f20 7468 6520 6176 6572 6167 6520   do the average 
+0004d9d0: 6f66 2070 7265 6469 6374 696f 6e73 210d  of predictions!.
+0004d9e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004d9f0: 2070 7269 6e74 2827 2020 2020 4164 6469   print('    Addi
+0004da00: 6e67 2025 6420 5374 6163 6b69 6e67 2066  ng %d Stacking f
+0004da10: 6561 7475 7265 2873 2920 746f 2074 7261  eature(s) to tra
+0004da20: 696e 696e 6720 6461 7461 2720 256c 656e  ining data' %len
+0004da30: 2861 6464 636f 6c73 2929 0d0a 2020 2020  (addcols))..    
+0004da40: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0004da50: 6f74 2069 7369 6e73 7461 6e63 6528 6f72  ot isinstance(or
+0004da60: 6967 5f74 6573 742c 2073 7472 293a 0d0a  ig_test, str):..
+0004da70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004da80: 2020 2020 2323 2320 496e 206f 7264 6572      ### In order
+0004da90: 2074 6f20 6176 6f69 6420 6f76 6572 6669   to avoid overfi
+0004daa0: 7474 696e 672c 2077 6520 6172 6520 676f  tting, we are go
+0004dab0: 696e 6720 746f 206c 6561 726e 2066 726f  ing to learn fro
+0004dac0: 6d20 6120 736d 616c 6c20 7361 6d70 6c65  m a small sample
+0004dad0: 206f 6620 6461 7461 0d0a 2020 2020 2020   of data..      
+0004dae0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+0004daf0: 2320 5468 6174 2069 7320 7768 7920 7765  # That is why we
+0004db00: 2061 7265 2075 7369 6e67 2058 5f74 7261   are using X_tra
+0004db10: 696e 2074 6f20 7472 6169 6e20 6f6e 2061  in to train on a
+0004db20: 6e64 2075 7369 6e67 2069 7420 746f 2070  nd using it to p
+0004db30: 7265 6469 6374 206f 6e20 585f 7465 7374  redict on X_test
+0004db40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004db50: 2020 2020 2020 5f2c 2073 7461 636b 7332        _, stacks2
+0004db60: 203d 2051 7569 636b 4d4c 5f53 7461 636b   = QuickML_Stack
+0004db70: 696e 6728 7472 6169 6e5b 696d 706f 7274  ing(train[import
+0004db80: 616e 745f 6665 6174 7572 6573 5d2c 7472  ant_features],tr
+0004db90: 6169 6e5b 6561 6368 5f74 6172 6765 745d  ain[each_target]
+0004dba0: 2c74 6573 745b 696d 706f 7274 616e 745f  ,test[important_
+0004dbb0: 6665 6174 7572 6573 5d2c 0d0a 2020 2020  features],..    
+0004dbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004dbd0: 2020 2020 2020 2020 2020 6d6f 6465 6c74            modelt
+0004dbe0: 7970 652c 2042 6f6f 7374 696e 675f 466c  ype, Boosting_Fl
+0004dbf0: 6167 2c20 7363 6f72 696e 675f 7061 7261  ag, scoring_para
+0004dc00: 6d65 7465 722c 7665 7262 6f73 6529 0d0a  meter,verbose)..
+0004dc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004dc20: 2020 2020 2323 2323 2320 4164 6469 6e67      ##### Adding
+0004dc30: 206d 756c 7469 706c 6520 636f 6c75 6d6e   multiple column
+0004dc40: 7320 666f 7220 5374 6163 6b69 6e67 2069  s for Stacking i
+0004dc50: 7320 6265 7374 2120 446f 206e 6f74 2064  s best! Do not d
+0004dc60: 6f20 7468 6520 6176 6572 6167 6520 6f66  o the average of
+0004dc70: 2070 7265 6469 6374 696f 6e73 210d 0a20   predictions!.. 
+0004dc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004dc90: 2020 2074 6573 7420 3d20 7465 7374 2e6a     test = test.j
+0004dca0: 6f69 6e28 7064 2e44 6174 6146 7261 6d65  oin(pd.DataFrame
+0004dcb0: 2873 7461 636b 7332 2c69 6e64 6578 3d74  (stacks2,index=t
+0004dcc0: 6573 742e 696e 6465 782c 0d0a 2020 2020  est.index,..    
+0004dcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004dce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004dcf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004dd00: 2020 2020 2020 2063 6f6c 756d 6e73 3d61         columns=a
-0004dd10: 6464 636f 6c73 2929 0d0a 2020 2020 2020  ddcols))..      
-0004dd20: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-0004dd30: 2323 2320 4164 6469 6e67 206d 756c 7469  ### Adding multi
-0004dd40: 706c 6520 636f 6c75 6d6e 7320 666f 7220  ple columns for 
-0004dd50: 5374 6163 6b69 6e67 2069 7320 6265 7374  Stacking is best
-0004dd60: 2120 446f 206e 6f74 2064 6f20 7468 6520  ! Do not do the 
-0004dd70: 6176 6572 6167 6520 6f66 2070 7265 6469  average of predi
-0004dd80: 6374 696f 6e73 210d 0a20 2020 2020 2020  ctions!..       
-0004dd90: 2020 2020 2020 2020 2020 2020 2023 7465               #te
-0004dda0: 7374 203d 2074 6573 742e 6a6f 696e 2870  st = test.join(p
-0004ddb0: 642e 4461 7461 4672 616d 6528 7374 6163  d.DataFrame(stac
-0004ddc0: 6b73 322e 6d65 616e 2861 7869 733d 3129  ks2.mean(axis=1)
-0004ddd0: 2e72 6f75 6e64 2829 2e61 7374 7970 6528  .round().astype(
-0004dde0: 696e 7429 2c0d 0a20 2020 2020 2020 2020  int),..         
-0004ddf0: 2020 2020 2020 2020 2020 2023 2020 2020             #    
+0004dd00: 2020 636f 6c75 6d6e 733d 6164 6463 6f6c    columns=addcol
+0004dd10: 7329 290d 0a20 2020 2020 2020 2020 2020  s))..           
+0004dd20: 2020 2020 2020 2020 2023 2323 2323 2041           ##### A
+0004dd30: 6464 696e 6720 6d75 6c74 6970 6c65 2063  dding multiple c
+0004dd40: 6f6c 756d 6e73 2066 6f72 2053 7461 636b  olumns for Stack
+0004dd50: 696e 6720 6973 2062 6573 7421 2044 6f20  ing is best! Do 
+0004dd60: 6e6f 7420 646f 2074 6865 2061 7665 7261  not do the avera
+0004dd70: 6765 206f 6620 7072 6564 6963 7469 6f6e  ge of prediction
+0004dd80: 7321 0d0a 2020 2020 2020 2020 2020 2020  s!..            
+0004dd90: 2020 2020 2020 2020 2374 6573 7420 3d20          #test = 
+0004dda0: 7465 7374 2e6a 6f69 6e28 7064 2e44 6174  test.join(pd.Dat
+0004ddb0: 6146 7261 6d65 2873 7461 636b 7332 2e6d  aFrame(stacks2.m
+0004ddc0: 6561 6e28 6178 6973 3d31 292e 726f 756e  ean(axis=1).roun
+0004ddd0: 6428 292e 6173 7479 7065 2869 6e74 292c  d().astype(int),
+0004dde0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004ddf0: 2020 2020 2020 2320 2020 2020 2020 2020        #         
 0004de00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004de10: 2020 2020 2020 2020 2063 6f6c 756d 6e73           columns
-0004de20: 3d5b 6164 6463 6f6c 5d2c 696e 6465 783d  =[addcol],index=
-0004de30: 7465 7374 2e69 6e64 6578 2929 0d0a 2020  test.index))..  
-0004de40: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-0004de50: 2323 2323 2020 5765 206d 616b 6520 7375  ####  We make su
-0004de60: 7265 2074 6861 7420 7765 2072 656d 6f76  re that we remov
-0004de70: 6520 746f 6f20 6d61 6e79 2066 6561 7475  e too many featu
-0004de80: 7265 7320 7468 6174 2061 7265 2068 6967  res that are hig
-0004de90: 686c 7920 636f 7272 656c 6174 6564 2021  hly correlated !
-0004dea0: 2023 2323 2323 0d0a 2020 2020 2020 2020   #####..        
-0004deb0: 2020 2020 2020 2020 2361 6464 636f 6c20          #addcol 
-0004dec0: 3d20 7265 6d6f 7665 5f76 6172 6961 626c  = remove_variabl
-0004ded0: 6573 5f75 7369 6e67 5f66 6173 745f 636f  es_using_fast_co
-0004dee0: 7272 656c 6174 696f 6e28 7472 6169 6e2c  rrelation(train,
-0004def0: 6164 6463 6f6c 2c6d 6f64 656c 7479 7065  addcol,modeltype
-0004df00: 2c63 6f72 725f 6c69 6d69 742c 7665 7262  ,corr_limit,verb
-0004df10: 6f73 6529 0d0a 2020 2020 2020 2020 2020  ose)..          
-0004df20: 2020 2020 2020 696d 706f 7274 616e 745f        important_
-0004df30: 6665 6174 7572 6573 202b 3d20 6164 6463  features += addc
-0004df40: 6f6c 730d 0a20 2020 2020 2020 2020 2020  ols..           
-0004df50: 2020 2020 2073 6176 6564 5f6e 756d 5f76       saved_num_v
-0004df60: 6172 732e 6170 7065 6e64 2861 6464 636f  ars.append(addco
-0004df70: 6c29 2023 2323 2059 6f75 206e 6565 6420  l) ### You need 
-0004df80: 746f 2061 6464 2069 7420 666f 7220 6269  to add it for bi
-0004df90: 6e6e 696e 6720 6c61 7465 7221 0d0a 2020  nning later!..  
-0004dfa0: 2020 2020 2020 2020 2020 6578 6365 7074            except
-0004dfb0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0004dfc0: 2020 2070 7269 6e74 2827 4572 726f 7220     print('Error 
-0004dfd0: 696e 2053 7461 636b 696e 6720 7365 636f  in Stacking seco
-0004dfe0: 6e64 2074 696d 652e 2043 6f6e 7469 6e75  nd time. Continu
-0004dff0: 696e 672e 2e2e 2729 0d0a 2020 2020 2323  ing...')..    ##
+0004de10: 2020 2020 636f 6c75 6d6e 733d 5b61 6464      columns=[add
+0004de20: 636f 6c5d 2c69 6e64 6578 3d74 6573 742e  col],index=test.
+0004de30: 696e 6465 7829 290d 0a20 2020 2020 2020  index))..       
+0004de40: 2020 2020 2020 2020 2023 2323 2323 2320           ###### 
+0004de50: 2057 6520 6d61 6b65 2073 7572 6520 7468   We make sure th
+0004de60: 6174 2077 6520 7265 6d6f 7665 2074 6f6f  at we remove too
+0004de70: 206d 616e 7920 6665 6174 7572 6573 2074   many features t
+0004de80: 6861 7420 6172 6520 6869 6768 6c79 2063  hat are highly c
+0004de90: 6f72 7265 6c61 7465 6420 2120 2323 2323  orrelated ! ####
+0004dea0: 230d 0a20 2020 2020 2020 2020 2020 2020  #..             
+0004deb0: 2020 2023 6164 6463 6f6c 203d 2072 656d     #addcol = rem
+0004dec0: 6f76 655f 7661 7269 6162 6c65 735f 7573  ove_variables_us
+0004ded0: 696e 675f 6661 7374 5f63 6f72 7265 6c61  ing_fast_correla
+0004dee0: 7469 6f6e 2874 7261 696e 2c61 6464 636f  tion(train,addco
+0004def0: 6c2c 6d6f 6465 6c74 7970 652c 636f 7272  l,modeltype,corr
+0004df00: 5f6c 696d 6974 2c76 6572 626f 7365 290d  _limit,verbose).
+0004df10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004df20: 2069 6d70 6f72 7461 6e74 5f66 6561 7475   important_featu
+0004df30: 7265 7320 2b3d 2061 6464 636f 6c73 0d0a  res += addcols..
+0004df40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004df50: 7361 7665 645f 6e75 6d5f 7661 7273 2e61  saved_num_vars.a
+0004df60: 7070 656e 6428 6164 6463 6f6c 2920 2323  ppend(addcol) ##
+0004df70: 2320 596f 7520 6e65 6564 2074 6f20 6164  # You need to ad
+0004df80: 6420 6974 2066 6f72 2062 696e 6e69 6e67  d it for binning
+0004df90: 206c 6174 6572 210d 0a20 2020 2020 2020   later!..       
+0004dfa0: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
+0004dfb0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0004dfc0: 696e 7428 2745 7272 6f72 2069 6e20 5374  int('Error in St
+0004dfd0: 6163 6b69 6e67 2073 6563 6f6e 6420 7469  acking second ti
+0004dfe0: 6d65 2e20 436f 6e74 696e 7569 6e67 2e2e  me. Continuing..
+0004dff0: 2e27 290d 0a20 2020 2023 2323 2323 2323  .')..    #######
 0004e000: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004e010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004e020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004e030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004e040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e050: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-0004e060: 6966 206c 656e 2869 6d70 6f72 7461 6e74  if len(important
-0004e070: 5f66 6561 7475 7265 7329 203d 3d20 303a  _features) == 0:
-0004e080: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-0004e090: 274e 6f20 696d 706f 7274 616e 7420 6665  'No important fe
-0004e0a0: 6174 7572 6573 2066 6f75 6e64 2e20 5573  atures found. Us
-0004e0b0: 696e 6720 616c 6c20 696e 7075 7420 6665  ing all input fe
-0004e0c0: 6174 7572 6573 2e2e 2e27 290d 0a20 2020  atures...')..   
-0004e0d0: 2020 2020 2069 6d70 6f72 7461 6e74 5f66       important_f
-0004e0e0: 6561 7475 7265 7320 3d20 636f 7079 2e64  eatures = copy.d
-0004e0f0: 6565 7063 6f70 7928 7361 7665 645f 696d  eepcopy(saved_im
-0004e100: 706f 7274 616e 745f 6665 6174 7572 6573  portant_features
-0004e110: 290d 0a20 2020 2020 2020 2023 696d 706f  )..        #impo
-0004e120: 7274 616e 745f 6665 6174 7572 6573 203d  rtant_features =
-0004e130: 2063 6f70 792e 6465 6570 636f 7079 2872   copy.deepcopy(r
-0004e140: 6564 5f70 7265 6473 290d 0a20 2020 2023  ed_preds)..    #
+0004e050: 2323 2323 230d 0a20 2020 2069 6620 6c65  #####..    if le
+0004e060: 6e28 696d 706f 7274 616e 745f 6665 6174  n(important_feat
+0004e070: 7572 6573 2920 3d3d 2030 3a0d 0a20 2020  ures) == 0:..   
+0004e080: 2020 2020 2070 7269 6e74 2827 4e6f 2069       print('No i
+0004e090: 6d70 6f72 7461 6e74 2066 6561 7475 7265  mportant feature
+0004e0a0: 7320 666f 756e 642e 2055 7369 6e67 2061  s found. Using a
+0004e0b0: 6c6c 2069 6e70 7574 2066 6561 7475 7265  ll input feature
+0004e0c0: 732e 2e2e 2729 0d0a 2020 2020 2020 2020  s...')..        
+0004e0d0: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
+0004e0e0: 6573 203d 2063 6f70 792e 6465 6570 636f  es = copy.deepco
+0004e0f0: 7079 2873 6176 6564 5f69 6d70 6f72 7461  py(saved_importa
+0004e100: 6e74 5f66 6561 7475 7265 7329 0d0a 2020  nt_features)..  
+0004e110: 2020 2020 2020 2369 6d70 6f72 7461 6e74        #important
+0004e120: 5f66 6561 7475 7265 7320 3d20 636f 7079  _features = copy
+0004e130: 2e64 6565 7063 6f70 7928 7265 645f 7072  .deepcopy(red_pr
+0004e140: 6564 7329 0d0a 2020 2020 2323 2323 2323  eds)..    ######
 0004e150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004e160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004e170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004e180: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004e190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e1a0: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
-0004e1b0: 2069 6620 6d6f 6465 6c5f 6e61 6d65 2e6c   if model_name.l
-0004e1c0: 6f77 6572 2829 203d 3d20 2763 6174 626f  ower() == 'catbo
-0004e1d0: 6f73 7427 3a0d 0a20 2020 2020 2020 2070  ost':..        p
-0004e1e0: 7269 6e74 2827 2020 2020 5365 7474 696e  rint('    Settin
-0004e1f0: 6720 6265 7374 2070 6172 616d 7320 666f  g best params fo
-0004e200: 7220 4361 7442 6f6f 7374 206d 6f64 656c  r CatBoost model
-0004e210: 2066 726f 6d20 496e 6974 6961 6c20 5374   from Initial St
-0004e220: 6174 6520 7369 6e63 6520 796f 7520 6361  ate since you ca
-0004e230: 6e6e 6f74 2063 6861 6e67 6520 7061 7261  nnot change para
-0004e240: 6d73 2074 6f20 6120 6669 7474 6564 2043  ms to a fitted C
-0004e250: 6174 626f 6f73 7420 6d6f 6465 6c20 2729  atboost model ')
-0004e260: 0d0a 2020 2020 2020 2020 6966 206d 6f64  ..        if mod
-0004e270: 656c 5f6c 6162 656c 203d 3d20 2753 696e  el_label == 'Sin
-0004e280: 676c 655f 4c61 6265 6c27 3a0d 0a20 2020  gle_Label':..   
-0004e290: 2020 2020 2020 2020 206d 6f64 656c 203d           model =
-0004e2a0: 2078 6762 6d2e 7365 745f 7061 7261 6d73   xgbm.set_params
-0004e2b0: 282a 2a62 6573 745f 7061 7261 6d73 290d  (**best_params).
-0004e2c0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-0004e2d0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
-0004e2e0: 6f64 656c 5f6c 6162 656c 2021 3d20 274d  odel_label != 'M
-0004e2f0: 756c 7469 5f4c 6162 656c 273a 0d0a 2020  ulti_Label':..  
-0004e300: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0004e310: 6465 6c20 3d20 7867 626d 2e73 6574 5f70  del = xgbm.set_p
-0004e320: 6172 616d 7328 2a2a 6265 7374 5f70 6172  arams(**best_par
-0004e330: 616d 7329 0d0a 2020 2020 2020 2020 7072  ams)..        pr
-0004e340: 696e 7428 2720 2020 204e 756d 6265 7220  int('    Number 
-0004e350: 6f66 2043 6174 6567 6f72 6963 616c 2061  of Categorical a
-0004e360: 6e64 2049 6e74 6567 6572 2076 6172 6961  nd Integer varia
-0004e370: 626c 6573 2075 7365 6420 696e 2043 6174  bles used in Cat
-0004e380: 426f 6f73 7420 7472 6169 6e69 6e67 203d  Boost training =
-0004e390: 2025 6427 2025 6c65 6e28 696d 705f 6361   %d' %len(imp_ca
-0004e3a0: 7473 2929 0d0a 2020 2020 2323 2323 2050  ts))..    #### P
-0004e3b0: 6572 666f 726d 2053 6361 6c69 6e67 206f  erform Scaling o
-0004e3c0: 6620 5472 6169 6e20 6461 7461 2061 2073  f Train data a s
-0004e3d0: 6563 6f6e 6420 7469 6d65 2075 7369 6e67  econd time using
-0004e3e0: 2046 554c 4c20 5452 4149 4e20 6461 7461   FULL TRAIN data
-0004e3f0: 2073 6574 2074 6869 7320 7469 6d65 2021   set this time !
-0004e400: 0d0a 2020 2020 2323 2323 2069 6d70 6f72  ..    #### impor
-0004e410: 7461 6e74 5f66 6561 7475 7265 7320 6b65  tant_features ke
-0004e420: 6570 7320 7472 6163 6b20 6f66 2061 6c6c  eps track of all
-0004e430: 2076 6172 6961 626c 6573 2074 6861 7420   variables that 
-0004e440: 7765 206e 6565 6420 746f 2065 6e73 7572  we need to ensur
-0004e450: 6520 7468 6579 2061 7265 2073 6361 6c65  e they are scale
-0004e460: 6421 0d0a 2020 2020 6966 206e 6f74 2070  d!..    if not p
-0004e470: 6572 666f 726d 5f73 6361 6c69 6e67 5f66  erform_scaling_f
-0004e480: 6c61 673a 0d0a 2020 2020 2020 2020 7072  lag:..        pr
-0004e490: 696e 7428 274e 6f20 2573 2073 6361 6c69  int('No %s scali
-0004e4a0: 6e67 2070 6572 666f 726d 6564 2073 696e  ng performed sin
-0004e4b0: 6365 2073 6361 6c69 6e67 2066 6c61 6720  ce scaling flag 
-0004e4c0: 6973 2073 6574 2074 6f20 6661 6c73 6527  is set to false'
-0004e4d0: 2025 7363 616c 696e 6729 0d0a 2020 2020   %scaling)..    
-0004e4e0: 2020 2020 5820 3d20 7472 6169 6e5b 696d      X = train[im
-0004e4f0: 706f 7274 616e 745f 6665 6174 7572 6573  portant_features
-0004e500: 5d0d 0a20 2020 2020 2020 2069 6620 6e6f  ]..        if no
-0004e510: 7420 6973 696e 7374 616e 6365 286f 7269  t isinstance(ori
-0004e520: 675f 7465 7374 2c20 7374 7229 3a0d 0a20  g_test, str):.. 
-0004e530: 2020 2020 2020 2020 2020 2058 5f74 6573             X_tes
-0004e540: 7420 3d20 7465 7374 5b69 6d70 6f72 7461  t = test[importa
-0004e550: 6e74 5f66 6561 7475 7265 735d 0d0a 2020  nt_features]..  
-0004e560: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0004e570: 2070 7269 6e74 2827 5065 7266 6f72 6d69   print('Performi
-0004e580: 6e67 2025 7320 7363 616c 696e 6720 6f66  ng %s scaling of
-0004e590: 2074 7261 696e 2061 6e64 2074 6573 7420   train and test 
-0004e5a0: 6461 7461 2e2e 2e27 2025 7363 616c 696e  data...' %scalin
-0004e5b0: 6729 0d0a 2020 2020 2020 2020 5820 3d20  g)..        X = 
-0004e5c0: 7472 6169 6e5b 696d 706f 7274 616e 745f  train[important_
-0004e5d0: 6665 6174 7572 6573 5d0d 0a20 2020 2020  features]..     
-0004e5e0: 2020 2053 532e 6669 7428 5829 0d0a 2020     SS.fit(X)..  
-0004e5f0: 2020 2020 2020 5820 3d20 7064 2e44 6174        X = pd.Dat
-0004e600: 6146 7261 6d65 2853 532e 7472 616e 7366  aFrame(SS.transf
-0004e610: 6f72 6d28 5829 2c69 6e64 6578 3d6f 7269  orm(X),index=ori
-0004e620: 675f 7472 6169 6e2e 696e 6465 782c 0d0a  g_train.index,..
+0004e1a0: 2323 2323 2323 0d0a 2020 2020 6966 206d  ######..    if m
+0004e1b0: 6f64 656c 5f6e 616d 652e 6c6f 7765 7228  odel_name.lower(
+0004e1c0: 2920 3d3d 2027 6361 7462 6f6f 7374 273a  ) == 'catboost':
+0004e1d0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+0004e1e0: 2720 2020 2053 6574 7469 6e67 2062 6573  '    Setting bes
+0004e1f0: 7420 7061 7261 6d73 2066 6f72 2043 6174  t params for Cat
+0004e200: 426f 6f73 7420 6d6f 6465 6c20 6672 6f6d  Boost model from
+0004e210: 2049 6e69 7469 616c 2053 7461 7465 2073   Initial State s
+0004e220: 696e 6365 2079 6f75 2063 616e 6e6f 7420  ince you cannot 
+0004e230: 6368 616e 6765 2070 6172 616d 7320 746f  change params to
+0004e240: 2061 2066 6974 7465 6420 4361 7462 6f6f   a fitted Catboo
+0004e250: 7374 206d 6f64 656c 2027 290d 0a20 2020  st model ')..   
+0004e260: 2020 2020 2069 6620 6d6f 6465 6c5f 6c61       if model_la
+0004e270: 6265 6c20 3d3d 2027 5369 6e67 6c65 5f4c  bel == 'Single_L
+0004e280: 6162 656c 273a 0d0a 2020 2020 2020 2020  abel':..        
+0004e290: 2020 2020 6d6f 6465 6c20 3d20 7867 626d      model = xgbm
+0004e2a0: 2e73 6574 5f70 6172 616d 7328 2a2a 6265  .set_params(**be
+0004e2b0: 7374 5f70 6172 616d 7329 0d0a 2020 2020  st_params)..    
+0004e2c0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0004e2d0: 2020 2020 2020 2069 6620 6d6f 6465 6c5f         if model_
+0004e2e0: 6c61 6265 6c20 213d 2027 4d75 6c74 695f  label != 'Multi_
+0004e2f0: 4c61 6265 6c27 3a0d 0a20 2020 2020 2020  Label':..       
+0004e300: 2020 2020 2020 2020 206d 6f64 656c 203d           model =
+0004e310: 2078 6762 6d2e 7365 745f 7061 7261 6d73   xgbm.set_params
+0004e320: 282a 2a62 6573 745f 7061 7261 6d73 290d  (**best_params).
+0004e330: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
+0004e340: 2020 2020 4e75 6d62 6572 206f 6620 4361      Number of Ca
+0004e350: 7465 676f 7269 6361 6c20 616e 6420 496e  tegorical and In
+0004e360: 7465 6765 7220 7661 7269 6162 6c65 7320  teger variables 
+0004e370: 7573 6564 2069 6e20 4361 7442 6f6f 7374  used in CatBoost
+0004e380: 2074 7261 696e 696e 6720 3d20 2564 2720   training = %d' 
+0004e390: 256c 656e 2869 6d70 5f63 6174 7329 290d  %len(imp_cats)).
+0004e3a0: 0a20 2020 2023 2323 2320 5065 7266 6f72  .    #### Perfor
+0004e3b0: 6d20 5363 616c 696e 6720 6f66 2054 7261  m Scaling of Tra
+0004e3c0: 696e 2064 6174 6120 6120 7365 636f 6e64  in data a second
+0004e3d0: 2074 696d 6520 7573 696e 6720 4655 4c4c   time using FULL
+0004e3e0: 2054 5241 494e 2064 6174 6120 7365 7420   TRAIN data set 
+0004e3f0: 7468 6973 2074 696d 6520 210d 0a20 2020  this time !..   
+0004e400: 2023 2323 2320 696d 706f 7274 616e 745f   #### important_
+0004e410: 6665 6174 7572 6573 206b 6565 7073 2074  features keeps t
+0004e420: 7261 636b 206f 6620 616c 6c20 7661 7269  rack of all vari
+0004e430: 6162 6c65 7320 7468 6174 2077 6520 6e65  ables that we ne
+0004e440: 6564 2074 6f20 656e 7375 7265 2074 6865  ed to ensure the
+0004e450: 7920 6172 6520 7363 616c 6564 210d 0a20  y are scaled!.. 
+0004e460: 2020 2069 6620 6e6f 7420 7065 7266 6f72     if not perfor
+0004e470: 6d5f 7363 616c 696e 675f 666c 6167 3a0d  m_scaling_flag:.
+0004e480: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
+0004e490: 4e6f 2025 7320 7363 616c 696e 6720 7065  No %s scaling pe
+0004e4a0: 7266 6f72 6d65 6420 7369 6e63 6520 7363  rformed since sc
+0004e4b0: 616c 696e 6720 666c 6167 2069 7320 7365  aling flag is se
+0004e4c0: 7420 746f 2066 616c 7365 2720 2573 6361  t to false' %sca
+0004e4d0: 6c69 6e67 290d 0a20 2020 2020 2020 2058  ling)..        X
+0004e4e0: 203d 2074 7261 696e 5b69 6d70 6f72 7461   = train[importa
+0004e4f0: 6e74 5f66 6561 7475 7265 735d 0d0a 2020  nt_features]..  
+0004e500: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+0004e510: 6e73 7461 6e63 6528 6f72 6967 5f74 6573  nstance(orig_tes
+0004e520: 742c 2073 7472 293a 0d0a 2020 2020 2020  t, str):..      
+0004e530: 2020 2020 2020 585f 7465 7374 203d 2074        X_test = t
+0004e540: 6573 745b 696d 706f 7274 616e 745f 6665  est[important_fe
+0004e550: 6174 7572 6573 5d0d 0a20 2020 2065 6c73  atures]..    els
+0004e560: 653a 0d0a 2020 2020 2020 2020 7072 696e  e:..        prin
+0004e570: 7428 2750 6572 666f 726d 696e 6720 2573  t('Performing %s
+0004e580: 2073 6361 6c69 6e67 206f 6620 7472 6169   scaling of trai
+0004e590: 6e20 616e 6420 7465 7374 2064 6174 612e  n and test data.
+0004e5a0: 2e2e 2720 2573 6361 6c69 6e67 290d 0a20  ..' %scaling).. 
+0004e5b0: 2020 2020 2020 2058 203d 2074 7261 696e         X = train
+0004e5c0: 5b69 6d70 6f72 7461 6e74 5f66 6561 7475  [important_featu
+0004e5d0: 7265 735d 0d0a 2020 2020 2020 2020 5353  res]..        SS
+0004e5e0: 2e66 6974 2858 290d 0a20 2020 2020 2020  .fit(X)..       
+0004e5f0: 2058 203d 2070 642e 4461 7461 4672 616d   X = pd.DataFram
+0004e600: 6528 5353 2e74 7261 6e73 666f 726d 2858  e(SS.transform(X
+0004e610: 292c 696e 6465 783d 6f72 6967 5f74 7261  ),index=orig_tra
+0004e620: 696e 2e69 6e64 6578 2c0d 0a20 2020 2020  in.index,..     
 0004e630: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004e640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004e650: 2020 2020 2020 2020 636f 6c75 6d6e 733d          columns=
-0004e660: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
-0004e670: 6573 290d 0a20 2020 2020 2020 2069 6620  es)..        if 
-0004e680: 6e6f 7420 6973 696e 7374 616e 6365 286f  not isinstance(o
-0004e690: 7269 675f 7465 7374 2c20 7374 7229 3a0d  rig_test, str):.
-0004e6a0: 0a20 2020 2020 2020 2020 2020 2058 5f74  .            X_t
-0004e6b0: 6573 7420 3d20 7064 2e44 6174 6146 7261  est = pd.DataFra
-0004e6c0: 6d65 2853 532e 7472 616e 7366 6f72 6d28  me(SS.transform(
-0004e6d0: 7465 7374 5b69 6d70 6f72 7461 6e74 5f66  test[important_f
-0004e6e0: 6561 7475 7265 735d 292c 696e 6465 783d  eatures]),index=
-0004e6f0: 6f72 6967 5f74 6573 742e 696e 6465 782c  orig_test.index,
-0004e700: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004e650: 2020 2063 6f6c 756d 6e73 3d69 6d70 6f72     columns=impor
+0004e660: 7461 6e74 5f66 6561 7475 7265 7329 0d0a  tant_features)..
+0004e670: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
+0004e680: 7369 6e73 7461 6e63 6528 6f72 6967 5f74  sinstance(orig_t
+0004e690: 6573 742c 2073 7472 293a 0d0a 2020 2020  est, str):..    
+0004e6a0: 2020 2020 2020 2020 585f 7465 7374 203d          X_test =
+0004e6b0: 2070 642e 4461 7461 4672 616d 6528 5353   pd.DataFrame(SS
+0004e6c0: 2e74 7261 6e73 666f 726d 2874 6573 745b  .transform(test[
+0004e6d0: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
+0004e6e0: 6573 5d29 2c69 6e64 6578 3d6f 7269 675f  es]),index=orig_
+0004e6f0: 7465 7374 2e69 6e64 6578 2c0d 0a20 2020  test.index,..   
+0004e700: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004e710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004e720: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
-0004e730: 733d 696d 706f 7274 616e 745f 6665 6174  s=important_feat
-0004e740: 7572 6573 290d 0a20 2020 2070 7269 6e74  ures)..    print
-0004e750: 2827 2323 2323 2323 2323 2323 2323 2323  ('##############
+0004e720: 2020 2020 2063 6f6c 756d 6e73 3d69 6d70       columns=imp
+0004e730: 6f72 7461 6e74 5f66 6561 7475 7265 7329  ortant_features)
+0004e740: 0d0a 2020 2020 7072 696e 7428 2723 2323  ..    print('###
+0004e750: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004e760: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004e770: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004e780: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e790: 2323 2323 2323 2323 2323 2323 2327 290d  #############').
-0004e7a0: 0a20 2020 2070 7269 6e74 2827 2323 2323  .    print('####
-0004e7b0: 2320 2020 4620 4920 4e20 4120 4c20 4920  #   F I N A L I 
-0004e7c0: 5a20 4920 4e20 4720 2020 4d20 4f20 4420  Z I N G   M O D 
-0004e7d0: 4520 4c20 2020 4f20 4e20 2020 2046 2055  E L   O N    F U
-0004e7e0: 204c 204c 2020 2054 2052 2041 2049 204e   L L   T R A I N
-0004e7f0: 2020 2323 2323 2327 290d 0a20 2020 2070    #####')..    p
-0004e800: 7269 6e74 2827 2323 2323 2323 2323 2323  rint('##########
+0004e790: 2323 2323 2323 2323 2729 0d0a 2020 2020  ########')..    
+0004e7a0: 7072 696e 7428 2723 2323 2323 2020 2046  print('#####   F
+0004e7b0: 2049 204e 2041 204c 2049 205a 2049 204e   I N A L I Z I N
+0004e7c0: 2047 2020 204d 204f 2044 2045 204c 2020   G   M O D E L  
+0004e7d0: 204f 204e 2020 2020 4620 5520 4c20 4c20   O N    F U L L 
+0004e7e0: 2020 5420 5220 4120 4920 4e20 2023 2323    T R A I N  ###
+0004e7f0: 2323 2729 0d0a 2020 2020 7072 696e 7428  ##')..    print(
+0004e800: 2723 2323 2323 2323 2323 2323 2323 2323  '###############
 0004e810: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004e820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004e830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004e850: 2327 290d 0a20 2020 2023 2323 2054 6865  #')..    ### The
-0004e860: 206e 6578 7420 3220 6c69 6e65 7320 6172   next 2 lines ar
-0004e870: 6520 6372 7563 6961 6c3a 2069 6620 5820  e crucial: if X 
-0004e880: 616e 6420 7920 6172 6520 6461 7461 6672  and y are datafr
-0004e890: 616d 6573 2c20 7468 656e 206e 6578 7420  ames, then next 
-0004e8a0: 3220 7368 6f75 6c64 2062 6520 6466 2773  2 should be df's
-0004e8b0: 0d0a 2020 2020 2323 2320 2020 5468 6579  ..    ###   They
-0004e8c0: 2073 686f 756c 6420 6e6f 7420 6265 2064   should not be d
-0004e8d0: 662e 7661 6c75 6573 2073 696e 6365 2074  f.values since t
-0004e8e0: 6865 7920 7769 6c6c 2062 6563 6f6d 6520  hey will become 
-0004e8f0: 6e75 6d70 7920 6172 7261 7973 2061 6e64  numpy arrays and
-0004e900: 2058 4742 2077 696c 6c20 6572 726f 722e   XGB will error.
-0004e910: 0d0a 2020 2020 7472 6169 6e6d 203d 2074  ..    trainm = t
-0004e920: 7261 696e 5b69 6d70 6f72 7461 6e74 5f66  rain[important_f
-0004e930: 6561 7475 7265 732b 7461 7267 6574 5d0d  eatures+target].
-0004e940: 0a20 2020 2072 6564 5f70 7265 6473 203d  .    red_preds =
-0004e950: 2063 6f70 792e 6465 6570 636f 7079 2869   copy.deepcopy(i
-0004e960: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
-0004e970: 7329 0d0a 2020 2020 6966 206d 6f64 656c  s)..    if model
-0004e980: 5f6c 6162 656c 203d 3d20 2753 696e 676c  _label == 'Singl
-0004e990: 655f 4c61 6265 6c27 3a0d 0a20 2020 2020  e_Label':..     
-0004e9a0: 2020 2079 203d 2074 7261 696e 6d5b 6561     y = trainm[ea
-0004e9b0: 6368 5f74 6172 6765 745d 0d0a 2020 2020  ch_target]..    
-0004e9c0: 656c 7365 3a0d 0a20 2020 2020 2020 2079  else:..        y
-0004e9d0: 203d 2074 7261 696e 6d5b 7461 7267 6574   = trainm[target
-0004e9e0: 5d0d 0a20 2020 2065 7661 6c5f 7365 7420  ]..    eval_set 
-0004e9f0: 3d20 5b28 295d 0d0a 2020 2020 2323 2323  = [()]..    ####
-0004ea00: 2320 2323 2323 2323 2323 2323 2323 2020  # ############  
-0004ea10: 2020 2020 5452 4149 4e49 4e47 204d 4f44      TRAINING MOD
-0004ea20: 454c 2053 4543 4f4e 4420 5449 4d45 2057  EL SECOND TIME W
-0004ea30: 4954 4820 4655 4c4c 5f54 5241 494e 2041  ITH FULL_TRAIN A
-0004ea40: 4e44 2050 5245 4449 4354 494e 4720 4f4e  ND PREDICTING ON
-0004ea50: 2054 4553 5420 2323 2323 2323 2323 2323   TEST ##########
-0004ea60: 2323 0d0a 2020 2020 6d6f 6465 6c5f 7374  ##..    model_st
-0004ea70: 6172 745f 7469 6d65 203d 2074 696d 652e  art_time = time.
-0004ea80: 7469 6d65 2829 0d0a 2020 2020 6966 206d  time()..    if m
-0004ea90: 6f64 656c 5f6c 6162 656c 203d 3d20 2753  odel_label == 'S
-0004eaa0: 696e 676c 655f 4c61 6265 6c27 3a0d 0a20  ingle_Label':.. 
-0004eab0: 2020 2020 2020 2069 6620 496d 6261 6c61         if Imbala
-0004eac0: 6e63 6564 5f46 6c61 673a 0d0a 2020 2020  nced_Flag:..    
-0004ead0: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-0004eae0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0004eaf0: 696e 7428 2723 2323 2323 2323 2323 2323  int('###########
-0004eb00: 2323 2323 2323 2320 2049 6d62 616c 616e  #######  Imbalan
-0004eb10: 6365 6420 4d6f 6465 6c20 5472 6169 6e69  ced Model Traini
-0004eb20: 6e67 2020 2323 2323 2323 2323 2323 2323  ng  ############
-0004eb30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004eb40: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-0004eb50: 2020 2020 2370 7269 6e74 2827 496d 6261      #print('Imba
-0004eb60: 6c61 6e63 6564 2054 7261 696e 696e 6720  lanced Training 
-0004eb70: 7573 696e 6720 534d 4f54 4520 5261 7265  using SMOTE Rare
-0004eb80: 2043 6c61 7373 204f 7665 7273 616d 706c   Class Oversampl
-0004eb90: 696e 6720 6d65 7468 6f64 2e2e 2e27 290d  ing method...').
-0004eba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004ebb0: 2023 2323 2053 696e 6365 2069 7420 6973   ### Since it is
-0004ebc0: 2061 2073 696e 676c 6520 6c61 6265 6c20   a single label 
-0004ebd0: 7072 6f62 6c65 6d2c 2077 6520 7573 6520  problem, we use 
-0004ebe0: 6561 6368 5f74 6172 6765 7420 696e 7374  each_target inst
-0004ebf0: 6561 6420 6f66 2074 6172 6765 740d 0a20  ead of target.. 
-0004ec00: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0004ec10: 6f64 656c 203d 2074 7261 696e 696e 675f  odel = training_
-0004ec20: 7769 7468 5f53 4d4f 5445 2858 2c79 2c20  with_SMOTE(X,y, 
-0004ec30: 6561 6368 5f74 6172 6765 742c 2065 7661  each_target, eva
-0004ec40: 6c5f 7365 742c 206d 6f64 656c 2c0d 0a20  l_set, model,.. 
+0004e840: 2323 2323 2323 2323 2323 2323 2729 0d0a  ############')..
+0004e850: 2020 2020 2323 2320 5468 6520 6e65 7874      ### The next
+0004e860: 2032 206c 696e 6573 2061 7265 2063 7275   2 lines are cru
+0004e870: 6369 616c 3a20 6966 2058 2061 6e64 2079  cial: if X and y
+0004e880: 2061 7265 2064 6174 6166 7261 6d65 732c   are dataframes,
+0004e890: 2074 6865 6e20 6e65 7874 2032 2073 686f   then next 2 sho
+0004e8a0: 756c 6420 6265 2064 6627 730d 0a20 2020  uld be df's..   
+0004e8b0: 2023 2323 2020 2054 6865 7920 7368 6f75   ###   They shou
+0004e8c0: 6c64 206e 6f74 2062 6520 6466 2e76 616c  ld not be df.val
+0004e8d0: 7565 7320 7369 6e63 6520 7468 6579 2077  ues since they w
+0004e8e0: 696c 6c20 6265 636f 6d65 206e 756d 7079  ill become numpy
+0004e8f0: 2061 7272 6179 7320 616e 6420 5847 4220   arrays and XGB 
+0004e900: 7769 6c6c 2065 7272 6f72 2e0d 0a20 2020  will error...   
+0004e910: 2074 7261 696e 6d20 3d20 7472 6169 6e5b   trainm = train[
+0004e920: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
+0004e930: 6573 2b74 6172 6765 745d 0d0a 2020 2020  es+target]..    
+0004e940: 7265 645f 7072 6564 7320 3d20 636f 7079  red_preds = copy
+0004e950: 2e64 6565 7063 6f70 7928 696d 706f 7274  .deepcopy(import
+0004e960: 616e 745f 6665 6174 7572 6573 290d 0a20  ant_features).. 
+0004e970: 2020 2069 6620 6d6f 6465 6c5f 6c61 6265     if model_labe
+0004e980: 6c20 3d3d 2027 5369 6e67 6c65 5f4c 6162  l == 'Single_Lab
+0004e990: 656c 273a 0d0a 2020 2020 2020 2020 7920  el':..        y 
+0004e9a0: 3d20 7472 6169 6e6d 5b65 6163 685f 7461  = trainm[each_ta
+0004e9b0: 7267 6574 5d0d 0a20 2020 2065 6c73 653a  rget]..    else:
+0004e9c0: 0d0a 2020 2020 2020 2020 7920 3d20 7472  ..        y = tr
+0004e9d0: 6169 6e6d 5b74 6172 6765 745d 0d0a 2020  ainm[target]..  
+0004e9e0: 2020 6576 616c 5f73 6574 203d 205b 2829    eval_set = [()
+0004e9f0: 5d0d 0a20 2020 2023 2323 2323 2023 2323  ]..    ##### ###
+0004ea00: 2323 2323 2323 2323 2320 2020 2020 2054  #########      T
+0004ea10: 5241 494e 494e 4720 4d4f 4445 4c20 5345  RAINING MODEL SE
+0004ea20: 434f 4e44 2054 494d 4520 5749 5448 2046  COND TIME WITH F
+0004ea30: 554c 4c5f 5452 4149 4e20 414e 4420 5052  ULL_TRAIN AND PR
+0004ea40: 4544 4943 5449 4e47 204f 4e20 5445 5354  EDICTING ON TEST
+0004ea50: 2023 2323 2323 2323 2323 2323 230d 0a20   ############.. 
+0004ea60: 2020 206d 6f64 656c 5f73 7461 7274 5f74     model_start_t
+0004ea70: 696d 6520 3d20 7469 6d65 2e74 696d 6528  ime = time.time(
+0004ea80: 290d 0a20 2020 2069 6620 6d6f 6465 6c5f  )..    if model_
+0004ea90: 6c61 6265 6c20 3d3d 2027 5369 6e67 6c65  label == 'Single
+0004eaa0: 5f4c 6162 656c 273a 0d0a 2020 2020 2020  _Label':..      
+0004eab0: 2020 6966 2049 6d62 616c 616e 6365 645f    if Imbalanced_
+0004eac0: 466c 6167 3a0d 0a20 2020 2020 2020 2020  Flag:..         
+0004ead0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+0004eae0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+0004eaf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004eb00: 2323 2020 496d 6261 6c61 6e63 6564 204d  ##  Imbalanced M
+0004eb10: 6f64 656c 2054 7261 696e 696e 6720 2023  odel Training  #
+0004eb20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004eb30: 2323 2323 2323 2323 2323 2327 290d 0a20  ###########').. 
+0004eb40: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0004eb50: 7072 696e 7428 2749 6d62 616c 616e 6365  print('Imbalance
+0004eb60: 6420 5472 6169 6e69 6e67 2075 7369 6e67  d Training using
+0004eb70: 2053 4d4f 5445 2052 6172 6520 436c 6173   SMOTE Rare Clas
+0004eb80: 7320 4f76 6572 7361 6d70 6c69 6e67 206d  s Oversampling m
+0004eb90: 6574 686f 642e 2e2e 2729 0d0a 2020 2020  ethod...')..    
+0004eba0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+0004ebb0: 5369 6e63 6520 6974 2069 7320 6120 7369  Since it is a si
+0004ebc0: 6e67 6c65 206c 6162 656c 2070 726f 626c  ngle label probl
+0004ebd0: 656d 2c20 7765 2075 7365 2065 6163 685f  em, we use each_
+0004ebe0: 7461 7267 6574 2069 6e73 7465 6164 206f  target instead o
+0004ebf0: 6620 7461 7267 6574 0d0a 2020 2020 2020  f target..      
+0004ec00: 2020 2020 2020 2020 2020 6d6f 6465 6c20            model 
+0004ec10: 3d20 7472 6169 6e69 6e67 5f77 6974 685f  = training_with_
+0004ec20: 534d 4f54 4528 582c 792c 2065 6163 685f  SMOTE(X,y, each_
+0004ec30: 7461 7267 6574 2c20 6576 616c 5f73 6574  target, eval_set
+0004ec40: 2c20 6d6f 6465 6c2c 0d0a 2020 2020 2020  , model,..      
 0004ec50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ec60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ec70: 2042 6f6f 7374 696e 675f 466c 6167 2c20   Boosting_Flag, 
-0004ec80: 6576 616c 5f6d 6574 7269 632c 6d6f 6465  eval_metric,mode
-0004ec90: 6c74 7970 652c 206d 6f64 656c 5f6e 616d  ltype, model_nam
-0004eca0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+0004ec60: 2020 2020 2020 2020 2020 2020 426f 6f73              Boos
+0004ec70: 7469 6e67 5f46 6c61 672c 2065 7661 6c5f  ting_Flag, eval_
+0004ec80: 6d65 7472 6963 2c6d 6f64 656c 7479 7065  metric,modeltype
+0004ec90: 2c20 6d6f 6465 6c5f 6e61 6d65 2c0d 0a20  , model_name,.. 
+0004eca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004ecb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ecc0: 2020 2020 2020 7472 6169 6e69 6e67 3d46        training=F
-0004ecd0: 616c 7365 2c20 6d69 6e6f 7269 7479 5f63  alse, minority_c
-0004ece0: 6c61 7373 3d72 6172 655f 636c 6173 732c  lass=rare_class,
-0004ecf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004ed00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ed10: 2020 2020 696d 705f 6361 7473 3d69 6d70      imp_cats=imp
-0004ed20: 5f63 6174 732c 2063 616c 6962 7261 746f  _cats, calibrato
-0004ed30: 725f 666c 6167 3d63 616c 6962 7261 746f  r_flag=calibrato
-0004ed40: 725f 666c 6167 2c0d 0a20 2020 2020 2020  r_flag,..       
+0004ecc0: 2074 7261 696e 696e 673d 4661 6c73 652c   training=False,
+0004ecd0: 206d 696e 6f72 6974 795f 636c 6173 733d   minority_class=
+0004ece0: 7261 7265 5f63 6c61 7373 2c0d 0a20 2020  rare_class,..   
+0004ecf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004ed00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0004ed10: 6d70 5f63 6174 733d 696d 705f 6361 7473  mp_cats=imp_cats
+0004ed20: 2c20 6361 6c69 6272 6174 6f72 5f66 6c61  , calibrator_fla
+0004ed30: 673d 6361 6c69 6272 6174 6f72 5f66 6c61  g=calibrator_fla
+0004ed40: 672c 0d0a 2020 2020 2020 2020 2020 2020  g,..            
 0004ed50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ed60: 2020 2020 2020 2020 2020 2047 5055 5f65             GPU_e
-0004ed70: 7869 7374 733d 4750 555f 6578 6973 7473  xists=GPU_exists
-0004ed80: 2c20 7061 7261 6d73 3d63 7075 5f70 6172  , params=cpu_par
-0004ed90: 616d 732c 0d0a 2020 2020 2020 2020 2020  ams,..          
+0004ed60: 2020 2020 2020 4750 555f 6578 6973 7473        GPU_exists
+0004ed70: 3d47 5055 5f65 7869 7374 732c 2070 6172  =GPU_exists, par
+0004ed80: 616d 733d 6370 755f 7061 7261 6d73 2c0d  ams=cpu_params,.
+0004ed90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0004eda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004edb0: 2020 2020 2020 2020 6d6f 6465 6c5f 6c61          model_la
-0004edc0: 6265 6c3d 6d6f 6465 6c5f 6c61 6265 6c2c  bel=model_label,
-0004edd0: 2076 6572 626f 7365 3d76 6572 626f 7365   verbose=verbose
-0004ede0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0004edf0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
-0004ee00: 2020 2020 2020 2020 7072 696e 7428 2745          print('E
-0004ee10: 7272 6f72 2069 6e20 7472 6169 6e69 6e67  rror in training
-0004ee20: 2049 6d62 616c 616e 6365 6420 6d6f 6465   Imbalanced mode
-0004ee30: 6c20 7365 636f 6e64 2074 696d 652e 2054  l second time. T
-0004ee40: 7279 696e 6720 7265 6775 6c61 7220 6d6f  rying regular mo
-0004ee50: 6465 6c2e 2e27 290d 0a20 2020 2020 2020  del..')..       
-0004ee60: 2020 2020 2020 2020 2049 6d62 616c 616e           Imbalan
-0004ee70: 6365 645f 466c 6167 203d 2020 4661 6c73  ced_Flag =  Fals
-0004ee80: 650d 0a20 2020 2023 2323 2323 2323 2323  e..    #########
-0004ee90: 2020 2049 4d50 4f52 5441 4e54 2020 2020     IMPORTANT    
-0004eea0: 494d 504f 5254 414e 5420 2323 2323 2323  IMPORTANT ######
+0004edb0: 2020 206d 6f64 656c 5f6c 6162 656c 3d6d     model_label=m
+0004edc0: 6f64 656c 5f6c 6162 656c 2c20 7665 7262  odel_label, verb
+0004edd0: 6f73 653d 7665 7262 6f73 6529 0d0a 2020  ose=verbose)..  
+0004ede0: 2020 2020 2020 2020 2020 6578 6365 7074            except
+0004edf0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0004ee00: 2020 2070 7269 6e74 2827 4572 726f 7220     print('Error 
+0004ee10: 696e 2074 7261 696e 696e 6720 496d 6261  in training Imba
+0004ee20: 6c61 6e63 6564 206d 6f64 656c 2073 6563  lanced model sec
+0004ee30: 6f6e 6420 7469 6d65 2e20 5472 7969 6e67  ond time. Trying
+0004ee40: 2072 6567 756c 6172 206d 6f64 656c 2e2e   regular model..
+0004ee50: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+0004ee60: 2020 2020 496d 6261 6c61 6e63 6564 5f46      Imbalanced_F
+0004ee70: 6c61 6720 3d20 2046 616c 7365 0d0a 2020  lag =  False..  
+0004ee80: 2020 2323 2323 2323 2323 2320 2020 494d    #########   IM
+0004ee90: 504f 5254 414e 5420 2020 2049 4d50 4f52  PORTANT    IMPOR
+0004eea0: 5441 4e54 2023 2323 2323 2323 2323 2323  TANT ###########
 0004eeb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004eec0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-0004eed0: 0a20 2020 2023 2323 2320 5468 6973 2069  .    #### This i
-0004eee0: 7320 6e6f 7420 6120 6d69 7374 616b 6521  s not a mistake!
-0004eef0: 2049 6e20 6361 7365 2c20 496d 6261 6c61   In case, Imbala
-0004ef00: 6e63 6564 2054 7261 696e 696e 6720 4661  nced Training Fa
-0004ef10: 696c 730d 0a20 2020 2023 2323 2320 2020  ils..    ####   
-0004ef20: 6f72 2069 6620 7468 6572 6520 6973 206e  or if there is n
-0004ef30: 6f20 666c 6167 2c20 7765 206d 7573 7420  o flag, we must 
-0004ef40: 7374 696c 6c20 7472 6169 6e20 7468 6520  still train the 
-0004ef50: 6d6f 6465 6c21 210d 0a20 2020 2023 2323  model!!..    ###
-0004ef60: 2320 2020 444f 204e 4f54 2054 4f55 4348  #   DO NOT TOUCH
-0004ef70: 2054 4849 5320 4e45 5854 204c 494e 4520   THIS NEXT LINE 
-0004ef80: 5448 494e 4b49 4e47 2049 5420 4953 2041  THINKING IT IS A
-0004ef90: 204d 4953 5441 4b45 210d 0a20 2020 2069   MISTAKE!..    i
-0004efa0: 6620 6e6f 7420 496d 6261 6c61 6e63 6564  f not Imbalanced
-0004efb0: 5f46 6c61 673a 0d0a 2020 2020 2020 2020  _Flag:..        
-0004efc0: 2323 2054 6869 7320 6973 2077 6865 7265  ## This is where
-0004efd0: 2077 6520 7465 7374 2069 6620 7468 6520   we test if the 
-0004efe0: 7072 6576 696f 7573 2074 7261 696e 696e  previous trainin
-0004eff0: 6720 7769 7468 2053 4d4f 5445 2077 656e  g with SMOTE wen
-0004f000: 7420 736d 6f6f 7468 6c79 2e20 4966 206e  t smoothly. If n
-0004f010: 6f74 2c20 7765 2020 7472 7920 7769 7468  ot, we  try with
-0004f020: 2061 2064 6966 6665 7265 6e74 206d 6574   a different met
-0004f030: 686f 6420 6865 7265 2e0d 0a20 2020 2020  hod here...     
-0004f040: 2020 2023 2323 2320 4966 2064 6f77 6e73     #### If downs
-0004f050: 616d 706c 696e 6720 6d6f 6465 6c20 6661  ampling model fa
-0004f060: 696c 6564 2c20 6974 2077 696c 6c20 6a75  iled, it will ju
-0004f070: 7374 2062 6520 616e 2065 6d70 7479 2073  st be an empty s
-0004f080: 7472 696e 672c 2073 6f20 796f 7520 6361  tring, so you ca
-0004f090: 6e20 7472 7920 7265 6775 6c61 7220 6d6f  n try regular mo
-0004f0a0: 6465 6c20 2323 230d 0a20 2020 2020 2020  del ###..       
-0004f0b0: 2069 6620 6d6f 6465 6c5f 6c61 6265 6c20   if model_label 
-0004f0c0: 3d3d 2027 5369 6e67 6c65 5f4c 6162 656c  == 'Single_Label
-0004f0d0: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
-0004f0e0: 6966 2063 616c 6962 7261 746f 725f 666c  if calibrator_fl
-0004f0f0: 6167 3a0d 0a20 2020 2020 2020 2020 2020  ag:..           
-0004f100: 2020 2020 206d 6f64 656c 2e66 6974 2858       model.fit(X
-0004f110: 2c20 7929 0d0a 2020 2020 2020 2020 2020  , y)..          
-0004f120: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0004f130: 2020 2020 2020 2020 2069 6620 426f 6f73           if Boos
-0004f140: 7469 6e67 5f46 6c61 673a 0d0a 2020 2020  ting_Flag:..    
-0004f150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004f160: 2020 2020 2323 2323 2053 6574 2074 6865      #### Set the
-0004f170: 2056 6572 626f 7365 2074 6f20 3020 7369   Verbose to 0 si
-0004f180: 6e63 6520 7765 2064 6f6e 2774 2077 616e  nce we don't wan
-0004f190: 7420 746f 6f20 6d75 6368 206f 7574 7075  t too much outpu
-0004f1a0: 7420 2323 0d0a 2020 2020 2020 2020 2020  t ##..          
-0004f1b0: 2020 2020 2020 2020 2020 6966 206d 6f64            if mod
-0004f1c0: 656c 5f6e 616d 6520 3d3d 2027 5847 426f  el_name == 'XGBo
-0004f1d0: 6f73 7427 3a0d 0a20 2020 2020 2020 2020  ost':..         
-0004f1e0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0004f1f0: 2323 2320 5365 7420 7468 6520 5665 7262  ### Set the Verb
-0004f200: 6f73 6520 746f 2030 2073 696e 6365 2077  ose to 0 since w
-0004f210: 6520 646f 6e27 7420 7761 6e74 2074 6f6f  e don't want too
-0004f220: 206d 7563 6820 6f75 7470 7574 2023 230d   much output ##.
-0004f230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004f240: 2020 2020 2020 2020 206d 6f64 656c 2e66           model.f
-0004f250: 6974 2858 2c20 7929 0d0a 2020 2020 2020  it(X, y)..      
-0004f260: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0004f270: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0004f280: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-0004f290: 656c 2e66 6974 2858 2c20 792c 2063 6174  el.fit(X, y, cat
-0004f2a0: 5f66 6561 7475 7265 733d 696d 705f 6361  _features=imp_ca
-0004f2b0: 7473 2c20 706c 6f74 3d46 616c 7365 290d  ts, plot=False).
-0004f2c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004f2d0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-0004f2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004f2f0: 6d6f 6465 6c2e 6669 7428 582c 2079 290d  model.fit(X, y).
-0004f300: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
-0004f310: 2020 2020 2323 2320 5468 6973 2069 7320      ### This is 
-0004f320: 666f 7220 4d75 6c74 692d 4c61 6265 6c20  for Multi-Label 
-0004f330: 5472 6169 6e69 6e67 2023 2323 2323 2323  Training #######
-0004f340: 2323 0d0a 2020 2020 2020 2020 6d6f 6465  ##..        mode
-0004f350: 6c2e 6669 7428 582c 2079 290d 0a20 2020  l.fit(X, y)..   
-0004f360: 2070 7269 6e74 2827 2020 2020 2041 6374   print('     Act
-0004f370: 7561 6c20 5472 6169 6e69 6e67 2074 696d  ual Training tim
-0004f380: 6520 7461 6b65 6e20 696e 2073 6563 6f6e  e taken in secon
-0004f390: 6473 203d 2025 302e 3066 2720 2528 7469  ds = %0.0f' %(ti
-0004f3a0: 6d65 2e74 696d 6528 292d 6d6f 6465 6c5f  me.time()-model_
-0004f3b0: 7374 6172 745f 7469 6d65 2929 0d0a 2020  start_time))..  
-0004f3c0: 2020 7072 696e 7428 2754 7261 696e 696e    print('Trainin
-0004f3d0: 6720 6f66 206d 6f64 656c 7320 636f 6d70  g of models comp
-0004f3e0: 6c65 7465 642e 204e 6f77 2073 7461 7274  leted. Now start
-0004f3f0: 696e 6720 7072 6564 6963 7469 6f6e 7320  ing predictions 
-0004f400: 6f6e 2074 6573 7420 6461 7461 2e2e 2e27  on test data...'
-0004f410: 290d 0a20 2020 2023 2323 2320 6e65 775f  )..    #### new_
-0004f420: 636f 6c73 2069 7320 746f 206b 6565 7020  cols is to keep 
-0004f430: 7472 6163 6b20 6f66 206e 6577 2070 7265  track of new pre
-0004f440: 6469 6374 696f 6e20 636f 6c75 6d6e 7320  diction columns 
-0004f450: 7765 2061 7265 2063 7265 6174 696e 6720  we are creating 
-0004f460: 2323 2323 230d 0a20 2020 206e 6577 5f63  #####..    new_c
-0004f470: 6f6c 7320 3d20 5b5d 0d0a 2020 2020 6966  ols = []..    if
-0004f480: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-0004f490: 6f72 6967 5f74 6573 742c 2073 7472 293a  orig_test, str):
-0004f4a0: 0d0a 2020 2020 2020 2020 2323 2320 4966  ..        ### If
-0004f4b0: 2074 6865 7265 2069 7320 6120 7465 7374   there is a test
-0004f4c0: 2064 6174 6120 6672 616d 652c 2074 6865   data frame, the
-0004f4d0: 6e20 6c65 7420 7573 2070 7265 6469 6374  n let us predict
-0004f4e0: 206f 6e20 6974 2023 2323 2323 2323 0d0a   on it #######..
-0004f4f0: 2020 2020 2020 2020 2323 2320 5468 6520          ### The 
-0004f500: 6e65 7874 2033 206c 696e 6573 2061 7265  next 3 lines are
-0004f510: 2063 7275 6369 616c 3a20 6966 2058 2061   crucial: if X a
-0004f520: 6e64 2079 2061 7265 2064 6174 6166 7261  nd y are datafra
-0004f530: 6d65 732c 2074 6865 6e20 6e65 7874 2032  mes, then next 2
-0004f540: 2073 686f 756c 6420 6265 2064 6627 730d   should be df's.
-0004f550: 0a20 2020 2020 2020 2023 2323 2020 2054  .        ###   T
-0004f560: 6865 7920 7368 6f75 6c64 206e 6f74 2062  hey should not b
-0004f570: 6520 6466 2e76 616c 7565 7320 7369 6e63  e df.values sinc
-0004f580: 6520 7468 6579 2077 696c 6c20 6265 636f  e they will beco
-0004f590: 6d65 206e 756d 7079 2061 7272 6179 7320  me numpy arrays 
-0004f5a0: 616e 6420 5847 4220 7769 6c6c 2065 7272  and XGB will err
-0004f5b0: 6f72 2e0d 0a20 2020 2020 2020 2074 7279  or...        try
-0004f5c0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
-0004f5d0: 2323 2320 5765 206e 6565 6420 7468 6520  ### We need the 
-0004f5e0: 6964 2063 6f6c 756d 6e73 2074 6f20 6361  id columns to ca
-0004f5f0: 7272 7920 6f76 6572 2069 6e74 6f20 7468  rry over into th
-0004f600: 6520 7072 6564 6963 7469 6f6e 7320 2323  e predictions ##
-0004f610: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
-0004f620: 7465 7374 6d20 3d20 6f72 6967 5f74 6573  testm = orig_tes
-0004f630: 745b 6964 5f63 6f6c 735d 2e6a 6f69 6e28  t[id_cols].join(
-0004f640: 7064 2e44 6174 6146 7261 6d65 2858 5f74  pd.DataFrame(X_t
-0004f650: 6573 742c 2069 6e64 6578 3d6f 7269 675f  est, index=orig_
-0004f660: 7465 7374 2e69 6e64 6578 2c20 636f 6c75  test.index, colu
-0004f670: 6d6e 733d 7265 645f 7072 6564 7329 290d  mns=red_preds)).
-0004f680: 0a20 2020 2020 2020 2065 7863 6570 743a  .        except:
-0004f690: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-0004f6a0: 2320 6966 2066 6f72 2073 6f6d 6520 7265  # if for some re
-0004f6b0: 6173 6f6e 2069 6420 636f 6c75 6d6e 7320  ason id columns 
-0004f6c0: 6172 6520 6e6f 7420 6176 6169 6c61 626c  are not availabl
-0004f6d0: 652c 2074 6865 6e20 646f 2077 6974 686f  e, then do witho
-0004f6e0: 7574 2069 740d 0a20 2020 2020 2020 2020  ut it..         
-0004f6f0: 2020 2074 6573 746d 203d 2070 642e 4461     testm = pd.Da
-0004f700: 7461 4672 616d 6528 585f 7465 7374 2c20  taFrame(X_test, 
-0004f710: 696e 6465 783d 6f72 6967 5f74 6573 742e  index=orig_test.
-0004f720: 696e 6465 782c 2063 6f6c 756d 6e73 3d72  index, columns=r
-0004f730: 6564 5f70 7265 6473 290d 0a20 2020 2065  ed_preds)..    e
-0004f740: 6c73 653a 0d0a 2020 2020 2020 2020 7072  lse:..        pr
-0004f750: 696e 7428 2753 696e 6365 2074 6865 7265  int('Since there
-0004f760: 2069 7320 6e6f 2054 6573 7420 6669 6c65   is no Test file
-0004f770: 2c20 7765 2077 696c 6c20 646f 2061 2066  , we will do a f
-0004f780: 696e 616c 2070 7265 6469 6374 696f 6e20  inal prediction 
-0004f790: 6f6e 2054 7261 696e 2069 7473 656c 6620  on Train itself 
-0004f7a0: 6173 2072 6574 7572 6e20 6974 2061 7320  as return it as 
-0004f7b0: 7465 7374 6d20 6461 7461 6672 616d 6527  testm dataframe'
-0004f7c0: 290d 0a20 2020 2020 2020 206f 7269 675f  )..        orig_
-0004f7d0: 696e 6465 7820 3d20 6f72 6967 5f74 7261  index = orig_tra
-0004f7e0: 696e 2e69 6e64 6578 0d0a 2020 2020 2020  in.index..      
-0004f7f0: 2020 7472 6169 6e6d 203d 2074 7261 696e    trainm = train
-0004f800: 2e72 6569 6e64 6578 2869 6e64 6578 203d  .reindex(index =
-0004f810: 206f 7269 675f 696e 6465 7829 0d0a 2020   orig_index)..  
-0004f820: 2020 2020 2020 6966 206e 6f74 2070 6572        if not per
-0004f830: 666f 726d 5f73 6361 6c69 6e67 5f66 6c61  form_scaling_fla
-0004f840: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
-0004f850: 585f 7465 7374 203d 2074 7261 696e 6d5b  X_test = trainm[
-0004f860: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
-0004f870: 6573 5d0d 0a20 2020 2020 2020 2065 6c73  es]..        els
-0004f880: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0004f890: 585f 7465 7374 203d 2070 642e 4461 7461  X_test = pd.Data
-0004f8a0: 4672 616d 6528 5353 2e74 7261 6e73 666f  Frame(SS.transfo
-0004f8b0: 726d 2874 7261 696e 6d5b 696d 706f 7274  rm(trainm[import
-0004f8c0: 616e 745f 6665 6174 7572 6573 5d29 2c0d  ant_features]),.
-0004f8d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004f8e0: 2020 2020 2069 6e64 6578 3d6f 7269 675f       index=orig_
-0004f8f0: 696e 6465 782c 2063 6f6c 756d 6e73 3d69  index, columns=i
-0004f900: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
-0004f910: 7329 0d0a 2020 2020 2020 2020 7465 7374  s)..        test
-0004f920: 6d20 3d20 6f72 6967 5f74 7261 696e 5b69  m = orig_train[i
-0004f930: 645f 636f 6c73 5d2e 6a6f 696e 2858 5f74  d_cols].join(X_t
-0004f940: 6573 7429 0d0a 2020 2020 2323 2323 2323  est)..    ######
-0004f950: 2323 2323 2323 2020 5468 6973 2069 7320  ######  This is 
-0004f960: 7768 6572 6520 7765 2073 7461 7274 2070  where we start p
-0004f970: 7265 6469 6374 696f 6e73 206f 6e20 7465  redictions on te
-0004f980: 7374 2064 6174 6120 6966 2061 7661 696c  st data if avail
-0004f990: 6162 6c65 2023 2323 2323 2323 2323 2323  able ###########
-0004f9a0: 2323 0d0a 2020 2020 7472 793a 0d0a 2020  ##..    try:..  
-0004f9b0: 2020 2020 2020 795f 7072 6564 203d 206d        y_pred = m
-0004f9c0: 6f64 656c 2e70 7265 6469 6374 2858 5f74  odel.predict(X_t
-0004f9d0: 6573 7429 0d0a 2020 2020 6578 6365 7074  est)..    except
-0004f9e0: 3a0d 0a20 2020 2020 2020 2069 6620 2858  :..        if (X
-0004f9f0: 5f74 7261 696e 2e64 7479 7065 7320 3d3d  _train.dtypes ==
-0004fa00: 2058 5f74 6573 742e 6474 7970 6573 292e   X_test.dtypes).
-0004fa10: 7661 6c75 6573 2e61 6c6c 2829 3a0d 0a20  values.all():.. 
-0004fa20: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-0004fa30: 2827 4d6f 6465 6c20 6572 726f 7269 6e67  ('Model erroring
-0004fa40: 206f 6e20 7072 6564 6963 7469 6f6e 732e   on predictions.
-0004fa50: 2043 6865 636b 2069 6620 7465 7374 2064   Check if test d
-0004fa60: 6174 6120 6861 7320 616e 7920 6469 6666  ata has any diff
-0004fa70: 6572 656e 6365 7320 6672 6f6d 2074 7261  erences from tra
-0004fa80: 696e 2064 6174 6127 290d 0a20 2020 2020  in data')..     
-0004fa90: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0004faa0: 2020 2020 2020 6572 726f 7269 6e67 5f63        erroring_c
-0004fab0: 6f6c 756d 6e20 3d20 585f 7472 6169 6e2e  olumn = X_train.
-0004fac0: 636f 6c75 6d6e 735b 7e28 585f 7472 6169  columns[~(X_trai
-0004fad0: 6e2e 6474 7970 6573 203d 3d20 585f 7465  n.dtypes == X_te
-0004fae0: 7374 2e64 7479 7065 7329 2e76 616c 7565  st.dtypes).value
-0004faf0: 735d 5b30 5d0d 0a20 2020 2020 2020 2020  s][0]..         
-0004fb00: 2020 2070 7269 6e74 2827 4d6f 6465 6c20     print('Model 
-0004fb10: 6572 726f 7269 6e67 2073 696e 6365 2025  erroring since %
-0004fb20: 7320 6861 7320 6120 6469 6666 6572 656e  s has a differen
-0004fb30: 7420 6474 7970 6520 696e 2074 6573 7420  t dtype in test 
-0004fb40: 636f 6d70 6172 6564 2074 6f20 7472 6169  compared to trai
-0004fb50: 6e2e 2046 6978 2069 7420 616e 6420 7265  n. Fix it and re
-0004fb60: 2d72 756e 2e27 2025 6572 726f 7269 6e67  -run.' %erroring
-0004fb70: 5f63 6f6c 756d 6e29 0d0a 2020 2020 2020  _column)..      
-0004fb80: 2020 2020 2020 7265 7475 726e 206d 6f64        return mod
-0004fb90: 656c 2c20 696d 706f 7274 616e 745f 6665  el, important_fe
-0004fba0: 6174 7572 6573 2c20 7472 6169 6e6d 2c20  atures, trainm, 
-0004fbb0: 7465 7374 6d0d 0a20 2020 2023 2323 2323  testm..    #####
-0004fbc0: 2054 6869 7320 6e65 7874 2073 7465 7020   This next step 
-0004fbd0: 6973 2076 6572 7920 696d 706f 7274 616e  is very importan
-0004fbe0: 7420 7369 6e63 6520 736f 6d65 206d 6f64  t since some mod
-0004fbf0: 656c 7320 6769 7665 2073 6572 6965 732c  els give series,
-0004fc00: 206f 7468 6572 7320 6769 7665 2061 7272   others give arr
-0004fc10: 6179 732e 2056 6572 7920 7061 696e 6675  ays. Very painfu
-0004fc20: 6c21 0d0a 2020 2020 6966 2069 7369 6e73  l!..    if isins
-0004fc30: 7461 6e63 6528 795f 7072 6564 2c70 642e  tance(y_pred,pd.
-0004fc40: 5365 7269 6573 2920 6f72 2069 7369 6e73  Series) or isins
-0004fc50: 7461 6e63 6528 795f 7072 6564 2c70 642e  tance(y_pred,pd.
-0004fc60: 4461 7461 4672 616d 6529 203a 0d0a 2020  DataFrame) :..  
-0004fc70: 2020 2020 2020 795f 7072 6564 203d 2079        y_pred = y
-0004fc80: 5f70 7265 642e 7661 6c75 6573 0d0a 2020  _pred.values..  
-0004fc90: 2020 2323 2323 2323 2320 5468 6973 2069    ####### This i
-0004fca0: 7320 7768 6572 6520 796f 7520 6d6f 6469  s where you modi
-0004fcb0: 6679 2070 7265 6469 6374 696f 6e73 206f  fy predictions o
-0004fcc0: 6e20 7465 7374 2064 6174 6120 746f 2062  n test data to b
-0004fcd0: 6520 7361 6d65 2061 7320 6f72 6967 696e  e same as origin
-0004fce0: 616c 2064 6174 6120 7479 7065 2023 2323  al data type ###
-0004fcf0: 2323 0d0a 2020 2020 6966 206d 6f64 6966  ##..    if modif
-0004fd00: 795f 7461 7267 6574 735f 666c 6167 3a0d  y_targets_flag:.
-0004fd10: 0a20 2020 2020 2020 2079 5f70 7265 6420  .        y_pred 
-0004fd20: 3d20 6d6f 6469 6679 5f61 7272 6179 5f74  = modify_array_t
-0004fd30: 6f5f 696e 7465 6765 7228 795f 7072 6564  o_integer(y_pred
-0004fd40: 2c20 7461 7267 6574 735f 6e65 6761 7469  , targets_negati
-0004fd50: 7665 5f66 6c61 6729 0d0a 2020 2020 6966  ve_flag)..    if
-0004fd60: 206d 6f64 656c 7479 7065 203d 3d20 2752   modeltype == 'R
-0004fd70: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
-0004fd80: 2020 2020 2023 2323 2323 2323 2320 2020       ########   
-0004fd90: 5468 6973 2069 7320 666f 7220 5265 6772  This is for Regr
-0004fda0: 6573 7369 6f6e 2050 726f 626c 656d 7320  ession Problems 
-0004fdb0: 4f6e 6c79 2023 2323 2323 2323 2323 2323  Only ###########
-0004fdc0: 0d0a 2020 2020 2020 2020 2323 2323 2323  ..        ######
-0004fdd0: 2020 4966 2053 7461 636b 696e 675f 2046    If Stacking_ F
-0004fde0: 6c61 6720 6973 2046 616c 7365 2c20 7468  lag is False, th
-0004fdf0: 656e 2077 6520 646f 2045 6e73 656d 626c  en we do Ensembl
-0004fe00: 696e 6720 2323 2323 2323 230d 0a20 2020  ing #######..   
-0004fe10: 2020 2020 2069 6620 6e6f 7420 5374 6163       if not Stac
-0004fe20: 6b69 6e67 5f46 6c61 6720 616e 6420 6e6f  king_Flag and no
-0004fe30: 7420 6d6f 6465 6c5f 6c61 6265 6c20 3d3d  t model_label ==
-0004fe40: 2027 4d75 6c74 695f 4c61 6265 6c27 3a0d   'Multi_Label':.
-0004fe50: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-0004fe60: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0004fe70: 2020 206e 6577 5f63 6f6c 7320 3d20 5b5d     new_cols = []
-0004fe80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004fe90: 2020 7375 626d 203d 2070 642e 4461 7461    subm = pd.Data
-0004fea0: 4672 616d 6528 290d 0a20 2020 2020 2020  Frame()..       
-0004feb0: 2020 2020 2020 2020 2023 2323 2320 5468           #### Th
-0004fec0: 6973 2069 7320 666f 7220 456e 7365 6d62  is is for Ensemb
-0004fed0: 6c69 6e67 2020 4f6e 6c79 2023 2323 2323  ling  Only #####
-0004fee0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0004fef0: 2020 2323 2323 2049 6e20 5465 7374 2064    #### In Test d
-0004ff00: 6174 6120 7665 7262 6f73 6520 6973 2073  ata verbose is s
-0004ff10: 6574 2074 6f20 7a65 726f 2073 696e 6365  et to zero since
-0004ff20: 206e 6f20 7265 7375 6c74 7320 6361 6e20   no results can 
-0004ff30: 6265 206f 6274 6169 6e65 6421 0d0a 2020  be obtained!..  
-0004ff40: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0004ff50: 6465 6c73 5f6c 6973 742c 2065 6e73 656d  dels_list, ensem
-0004ff60: 626c 6573 203d 2051 7569 636b 4d4c 5f45  bles = QuickML_E
-0004ff70: 6e73 656d 626c 696e 6728 582c 2079 2c20  nsembling(X, y, 
-0004ff80: 585f 7465 7374 2c20 2727 2c0d 0a20 2020  X_test, '',..   
+0004eec0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+0004eed0: 2323 2323 2054 6869 7320 6973 206e 6f74  #### This is not
+0004eee0: 2061 206d 6973 7461 6b65 2120 496e 2063   a mistake! In c
+0004eef0: 6173 652c 2049 6d62 616c 616e 6365 6420  ase, Imbalanced 
+0004ef00: 5472 6169 6e69 6e67 2046 6169 6c73 0d0a  Training Fails..
+0004ef10: 2020 2020 2323 2323 2020 206f 7220 6966      ####   or if
+0004ef20: 2074 6865 7265 2069 7320 6e6f 2066 6c61   there is no fla
+0004ef30: 672c 2077 6520 6d75 7374 2073 7469 6c6c  g, we must still
+0004ef40: 2074 7261 696e 2074 6865 206d 6f64 656c   train the model
+0004ef50: 2121 0d0a 2020 2020 2323 2323 2020 2044  !!..    ####   D
+0004ef60: 4f20 4e4f 5420 544f 5543 4820 5448 4953  O NOT TOUCH THIS
+0004ef70: 204e 4558 5420 4c49 4e45 2054 4849 4e4b   NEXT LINE THINK
+0004ef80: 494e 4720 4954 2049 5320 4120 4d49 5354  ING IT IS A MIST
+0004ef90: 414b 4521 0d0a 2020 2020 6966 206e 6f74  AKE!..    if not
+0004efa0: 2049 6d62 616c 616e 6365 645f 466c 6167   Imbalanced_Flag
+0004efb0: 3a0d 0a20 2020 2020 2020 2023 2320 5468  :..        ## Th
+0004efc0: 6973 2069 7320 7768 6572 6520 7765 2074  is is where we t
+0004efd0: 6573 7420 6966 2074 6865 2070 7265 7669  est if the previ
+0004efe0: 6f75 7320 7472 6169 6e69 6e67 2077 6974  ous training wit
+0004eff0: 6820 534d 4f54 4520 7765 6e74 2073 6d6f  h SMOTE went smo
+0004f000: 6f74 686c 792e 2049 6620 6e6f 742c 2077  othly. If not, w
+0004f010: 6520 2074 7279 2077 6974 6820 6120 6469  e  try with a di
+0004f020: 6666 6572 656e 7420 6d65 7468 6f64 2068  fferent method h
+0004f030: 6572 652e 0d0a 2020 2020 2020 2020 2323  ere...        ##
+0004f040: 2323 2049 6620 646f 776e 7361 6d70 6c69  ## If downsampli
+0004f050: 6e67 206d 6f64 656c 2066 6169 6c65 642c  ng model failed,
+0004f060: 2069 7420 7769 6c6c 206a 7573 7420 6265   it will just be
+0004f070: 2061 6e20 656d 7074 7920 7374 7269 6e67   an empty string
+0004f080: 2c20 736f 2079 6f75 2063 616e 2074 7279  , so you can try
+0004f090: 2072 6567 756c 6172 206d 6f64 656c 2023   regular model #
+0004f0a0: 2323 0d0a 2020 2020 2020 2020 6966 206d  ##..        if m
+0004f0b0: 6f64 656c 5f6c 6162 656c 203d 3d20 2753  odel_label == 'S
+0004f0c0: 696e 676c 655f 4c61 6265 6c27 3a0d 0a20  ingle_Label':.. 
+0004f0d0: 2020 2020 2020 2020 2020 2069 6620 6361             if ca
+0004f0e0: 6c69 6272 6174 6f72 5f66 6c61 673a 0d0a  librator_flag:..
+0004f0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004f100: 6d6f 6465 6c2e 6669 7428 582c 2079 290d  model.fit(X, y).
+0004f110: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0004f120: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+0004f130: 2020 2020 6966 2042 6f6f 7374 696e 675f      if Boosting_
+0004f140: 466c 6167 3a0d 0a20 2020 2020 2020 2020  Flag:..         
+0004f150: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0004f160: 2323 2320 5365 7420 7468 6520 5665 7262  ### Set the Verb
+0004f170: 6f73 6520 746f 2030 2073 696e 6365 2077  ose to 0 since w
+0004f180: 6520 646f 6e27 7420 7761 6e74 2074 6f6f  e don't want too
+0004f190: 206d 7563 6820 6f75 7470 7574 2023 230d   much output ##.
+0004f1a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004f1b0: 2020 2020 2069 6620 6d6f 6465 6c5f 6e61       if model_na
+0004f1c0: 6d65 203d 3d20 2758 4742 6f6f 7374 273a  me == 'XGBoost':
+0004f1d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0004f1e0: 2020 2020 2020 2020 2020 2323 2323 2053            #### S
+0004f1f0: 6574 2074 6865 2056 6572 626f 7365 2074  et the Verbose t
+0004f200: 6f20 3020 7369 6e63 6520 7765 2064 6f6e  o 0 since we don
+0004f210: 2774 2077 616e 7420 746f 6f20 6d75 6368  't want too much
+0004f220: 206f 7574 7075 7420 2323 0d0a 2020 2020   output ##..    
+0004f230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004f240: 2020 2020 6d6f 6465 6c2e 6669 7428 582c      model.fit(X,
+0004f250: 2079 290d 0a20 2020 2020 2020 2020 2020   y)..           
+0004f260: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0004f270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004f280: 2020 2020 2020 2020 6d6f 6465 6c2e 6669          model.fi
+0004f290: 7428 582c 2079 2c20 6361 745f 6665 6174  t(X, y, cat_feat
+0004f2a0: 7572 6573 3d69 6d70 5f63 6174 732c 2070  ures=imp_cats, p
+0004f2b0: 6c6f 743d 4661 6c73 6529 0d0a 2020 2020  lot=False)..    
+0004f2c0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0004f2d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0004f2e0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+0004f2f0: 2e66 6974 2858 2c20 7929 0d0a 2020 2020  .fit(X, y)..    
+0004f300: 656c 7365 3a0d 0a20 2020 2020 2020 2023  else:..        #
+0004f310: 2323 2054 6869 7320 6973 2066 6f72 204d  ## This is for M
+0004f320: 756c 7469 2d4c 6162 656c 2054 7261 696e  ulti-Label Train
+0004f330: 696e 6720 2323 2323 2323 2323 230d 0a20  ing #########.. 
+0004f340: 2020 2020 2020 206d 6f64 656c 2e66 6974         model.fit
+0004f350: 2858 2c20 7929 0d0a 2020 2020 7072 696e  (X, y)..    prin
+0004f360: 7428 2720 2020 2020 4163 7475 616c 2054  t('     Actual T
+0004f370: 7261 696e 696e 6720 7469 6d65 2074 616b  raining time tak
+0004f380: 656e 2069 6e20 7365 636f 6e64 7320 3d20  en in seconds = 
+0004f390: 2530 2e30 6627 2025 2874 696d 652e 7469  %0.0f' %(time.ti
+0004f3a0: 6d65 2829 2d6d 6f64 656c 5f73 7461 7274  me()-model_start
+0004f3b0: 5f74 696d 6529 290d 0a20 2020 2070 7269  _time))..    pri
+0004f3c0: 6e74 2827 5472 6169 6e69 6e67 206f 6620  nt('Training of 
+0004f3d0: 6d6f 6465 6c73 2063 6f6d 706c 6574 6564  models completed
+0004f3e0: 2e20 4e6f 7720 7374 6172 7469 6e67 2070  . Now starting p
+0004f3f0: 7265 6469 6374 696f 6e73 206f 6e20 7465  redictions on te
+0004f400: 7374 2064 6174 612e 2e2e 2729 0d0a 2020  st data...')..  
+0004f410: 2020 2323 2323 206e 6577 5f63 6f6c 7320    #### new_cols 
+0004f420: 6973 2074 6f20 6b65 6570 2074 7261 636b  is to keep track
+0004f430: 206f 6620 6e65 7720 7072 6564 6963 7469   of new predicti
+0004f440: 6f6e 2063 6f6c 756d 6e73 2077 6520 6172  on columns we ar
+0004f450: 6520 6372 6561 7469 6e67 2023 2323 2323  e creating #####
+0004f460: 0d0a 2020 2020 6e65 775f 636f 6c73 203d  ..    new_cols =
+0004f470: 205b 5d0d 0a20 2020 2069 6620 6e6f 7420   []..    if not 
+0004f480: 6973 696e 7374 616e 6365 286f 7269 675f  isinstance(orig_
+0004f490: 7465 7374 2c20 7374 7229 3a0d 0a20 2020  test, str):..   
+0004f4a0: 2020 2020 2023 2323 2049 6620 7468 6572       ### If ther
+0004f4b0: 6520 6973 2061 2074 6573 7420 6461 7461  e is a test data
+0004f4c0: 2066 7261 6d65 2c20 7468 656e 206c 6574   frame, then let
+0004f4d0: 2075 7320 7072 6564 6963 7420 6f6e 2069   us predict on i
+0004f4e0: 7420 2323 2323 2323 230d 0a20 2020 2020  t #######..     
+0004f4f0: 2020 2023 2323 2054 6865 206e 6578 7420     ### The next 
+0004f500: 3320 6c69 6e65 7320 6172 6520 6372 7563  3 lines are cruc
+0004f510: 6961 6c3a 2069 6620 5820 616e 6420 7920  ial: if X and y 
+0004f520: 6172 6520 6461 7461 6672 616d 6573 2c20  are dataframes, 
+0004f530: 7468 656e 206e 6578 7420 3220 7368 6f75  then next 2 shou
+0004f540: 6c64 2062 6520 6466 2773 0d0a 2020 2020  ld be df's..    
+0004f550: 2020 2020 2323 2320 2020 5468 6579 2073      ###   They s
+0004f560: 686f 756c 6420 6e6f 7420 6265 2064 662e  hould not be df.
+0004f570: 7661 6c75 6573 2073 696e 6365 2074 6865  values since the
+0004f580: 7920 7769 6c6c 2062 6563 6f6d 6520 6e75  y will become nu
+0004f590: 6d70 7920 6172 7261 7973 2061 6e64 2058  mpy arrays and X
+0004f5a0: 4742 2077 696c 6c20 6572 726f 722e 0d0a  GB will error...
+0004f5b0: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
+0004f5c0: 2020 2020 2020 2020 2020 2323 2323 2057            #### W
+0004f5d0: 6520 6e65 6564 2074 6865 2069 6420 636f  e need the id co
+0004f5e0: 6c75 6d6e 7320 746f 2063 6172 7279 206f  lumns to carry o
+0004f5f0: 7665 7220 696e 746f 2074 6865 2070 7265  ver into the pre
+0004f600: 6469 6374 696f 6e73 2023 2323 230d 0a20  dictions ####.. 
+0004f610: 2020 2020 2020 2020 2020 2074 6573 746d             testm
+0004f620: 203d 206f 7269 675f 7465 7374 5b69 645f   = orig_test[id_
+0004f630: 636f 6c73 5d2e 6a6f 696e 2870 642e 4461  cols].join(pd.Da
+0004f640: 7461 4672 616d 6528 585f 7465 7374 2c20  taFrame(X_test, 
+0004f650: 696e 6465 783d 6f72 6967 5f74 6573 742e  index=orig_test.
+0004f660: 696e 6465 782c 2063 6f6c 756d 6e73 3d72  index, columns=r
+0004f670: 6564 5f70 7265 6473 2929 0d0a 2020 2020  ed_preds))..    
+0004f680: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
+0004f690: 2020 2020 2020 2020 2023 2323 2069 6620           ### if 
+0004f6a0: 666f 7220 736f 6d65 2072 6561 736f 6e20  for some reason 
+0004f6b0: 6964 2063 6f6c 756d 6e73 2061 7265 206e  id columns are n
+0004f6c0: 6f74 2061 7661 696c 6162 6c65 2c20 7468  ot available, th
+0004f6d0: 656e 2064 6f20 7769 7468 6f75 7420 6974  en do without it
+0004f6e0: 0d0a 2020 2020 2020 2020 2020 2020 7465  ..            te
+0004f6f0: 7374 6d20 3d20 7064 2e44 6174 6146 7261  stm = pd.DataFra
+0004f700: 6d65 2858 5f74 6573 742c 2069 6e64 6578  me(X_test, index
+0004f710: 3d6f 7269 675f 7465 7374 2e69 6e64 6578  =orig_test.index
+0004f720: 2c20 636f 6c75 6d6e 733d 7265 645f 7072  , columns=red_pr
+0004f730: 6564 7329 0d0a 2020 2020 656c 7365 3a0d  eds)..    else:.
+0004f740: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
+0004f750: 5369 6e63 6520 7468 6572 6520 6973 206e  Since there is n
+0004f760: 6f20 5465 7374 2066 696c 652c 2077 6520  o Test file, we 
+0004f770: 7769 6c6c 2064 6f20 6120 6669 6e61 6c20  will do a final 
+0004f780: 7072 6564 6963 7469 6f6e 206f 6e20 5472  prediction on Tr
+0004f790: 6169 6e20 6974 7365 6c66 2061 7320 7265  ain itself as re
+0004f7a0: 7475 726e 2069 7420 6173 2074 6573 746d  turn it as testm
+0004f7b0: 2064 6174 6166 7261 6d65 2729 0d0a 2020   dataframe')..  
+0004f7c0: 2020 2020 2020 6f72 6967 5f69 6e64 6578        orig_index
+0004f7d0: 203d 206f 7269 675f 7472 6169 6e2e 696e   = orig_train.in
+0004f7e0: 6465 780d 0a20 2020 2020 2020 2074 7261  dex..        tra
+0004f7f0: 696e 6d20 3d20 7472 6169 6e2e 7265 696e  inm = train.rein
+0004f800: 6465 7828 696e 6465 7820 3d20 6f72 6967  dex(index = orig
+0004f810: 5f69 6e64 6578 290d 0a20 2020 2020 2020  _index)..       
+0004f820: 2069 6620 6e6f 7420 7065 7266 6f72 6d5f   if not perform_
+0004f830: 7363 616c 696e 675f 666c 6167 3a0d 0a20  scaling_flag:.. 
+0004f840: 2020 2020 2020 2020 2020 2058 5f74 6573             X_tes
+0004f850: 7420 3d20 7472 6169 6e6d 5b69 6d70 6f72  t = trainm[impor
+0004f860: 7461 6e74 5f66 6561 7475 7265 735d 0d0a  tant_features]..
+0004f870: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0004f880: 2020 2020 2020 2020 2020 2058 5f74 6573             X_tes
+0004f890: 7420 3d20 7064 2e44 6174 6146 7261 6d65  t = pd.DataFrame
+0004f8a0: 2853 532e 7472 616e 7366 6f72 6d28 7472  (SS.transform(tr
+0004f8b0: 6169 6e6d 5b69 6d70 6f72 7461 6e74 5f66  ainm[important_f
+0004f8c0: 6561 7475 7265 735d 292c 0d0a 2020 2020  eatures]),..    
+0004f8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004f8e0: 696e 6465 783d 6f72 6967 5f69 6e64 6578  index=orig_index
+0004f8f0: 2c20 636f 6c75 6d6e 733d 696d 706f 7274  , columns=import
+0004f900: 616e 745f 6665 6174 7572 6573 290d 0a20  ant_features).. 
+0004f910: 2020 2020 2020 2074 6573 746d 203d 206f         testm = o
+0004f920: 7269 675f 7472 6169 6e5b 6964 5f63 6f6c  rig_train[id_col
+0004f930: 735d 2e6a 6f69 6e28 585f 7465 7374 290d  s].join(X_test).
+0004f940: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
+0004f950: 2320 2054 6869 7320 6973 2077 6865 7265  #  This is where
+0004f960: 2077 6520 7374 6172 7420 7072 6564 6963   we start predic
+0004f970: 7469 6f6e 7320 6f6e 2074 6573 7420 6461  tions on test da
+0004f980: 7461 2069 6620 6176 6169 6c61 626c 6520  ta if available 
+0004f990: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
+0004f9a0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+0004f9b0: 2079 5f70 7265 6420 3d20 6d6f 6465 6c2e   y_pred = model.
+0004f9c0: 7072 6564 6963 7428 585f 7465 7374 290d  predict(X_test).
+0004f9d0: 0a20 2020 2065 7863 6570 743a 0d0a 2020  .    except:..  
+0004f9e0: 2020 2020 2020 6966 2028 585f 7472 6169        if (X_trai
+0004f9f0: 6e2e 6474 7970 6573 203d 3d20 585f 7465  n.dtypes == X_te
+0004fa00: 7374 2e64 7479 7065 7329 2e76 616c 7565  st.dtypes).value
+0004fa10: 732e 616c 6c28 293a 0d0a 2020 2020 2020  s.all():..      
+0004fa20: 2020 2020 2020 7072 696e 7428 274d 6f64        print('Mod
+0004fa30: 656c 2065 7272 6f72 696e 6720 6f6e 2070  el erroring on p
+0004fa40: 7265 6469 6374 696f 6e73 2e20 4368 6563  redictions. Chec
+0004fa50: 6b20 6966 2074 6573 7420 6461 7461 2068  k if test data h
+0004fa60: 6173 2061 6e79 2064 6966 6665 7265 6e63  as any differenc
+0004fa70: 6573 2066 726f 6d20 7472 6169 6e20 6461  es from train da
+0004fa80: 7461 2729 0d0a 2020 2020 2020 2020 656c  ta')..        el
+0004fa90: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0004faa0: 2065 7272 6f72 696e 675f 636f 6c75 6d6e   erroring_column
+0004fab0: 203d 2058 5f74 7261 696e 2e63 6f6c 756d   = X_train.colum
+0004fac0: 6e73 5b7e 2858 5f74 7261 696e 2e64 7479  ns[~(X_train.dty
+0004fad0: 7065 7320 3d3d 2058 5f74 6573 742e 6474  pes == X_test.dt
+0004fae0: 7970 6573 292e 7661 6c75 6573 5d5b 305d  ypes).values][0]
+0004faf0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+0004fb00: 696e 7428 274d 6f64 656c 2065 7272 6f72  int('Model error
+0004fb10: 696e 6720 7369 6e63 6520 2573 2068 6173  ing since %s has
+0004fb20: 2061 2064 6966 6665 7265 6e74 2064 7479   a different dty
+0004fb30: 7065 2069 6e20 7465 7374 2063 6f6d 7061  pe in test compa
+0004fb40: 7265 6420 746f 2074 7261 696e 2e20 4669  red to train. Fi
+0004fb50: 7820 6974 2061 6e64 2072 652d 7275 6e2e  x it and re-run.
+0004fb60: 2720 2565 7272 6f72 696e 675f 636f 6c75  ' %erroring_colu
+0004fb70: 6d6e 290d 0a20 2020 2020 2020 2020 2020  mn)..           
+0004fb80: 2072 6574 7572 6e20 6d6f 6465 6c2c 2069   return model, i
+0004fb90: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
+0004fba0: 732c 2074 7261 696e 6d2c 2074 6573 746d  s, trainm, testm
+0004fbb0: 0d0a 2020 2020 2323 2323 2320 5468 6973  ..    ##### This
+0004fbc0: 206e 6578 7420 7374 6570 2069 7320 7665   next step is ve
+0004fbd0: 7279 2069 6d70 6f72 7461 6e74 2073 696e  ry important sin
+0004fbe0: 6365 2073 6f6d 6520 6d6f 6465 6c73 2067  ce some models g
+0004fbf0: 6976 6520 7365 7269 6573 2c20 6f74 6865  ive series, othe
+0004fc00: 7273 2067 6976 6520 6172 7261 7973 2e20  rs give arrays. 
+0004fc10: 5665 7279 2070 6169 6e66 756c 210d 0a20  Very painful!.. 
+0004fc20: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0004fc30: 2879 5f70 7265 642c 7064 2e53 6572 6965  (y_pred,pd.Serie
+0004fc40: 7329 206f 7220 6973 696e 7374 616e 6365  s) or isinstance
+0004fc50: 2879 5f70 7265 642c 7064 2e44 6174 6146  (y_pred,pd.DataF
+0004fc60: 7261 6d65 2920 3a0d 0a20 2020 2020 2020  rame) :..       
+0004fc70: 2079 5f70 7265 6420 3d20 795f 7072 6564   y_pred = y_pred
+0004fc80: 2e76 616c 7565 730d 0a20 2020 2023 2323  .values..    ###
+0004fc90: 2323 2323 2054 6869 7320 6973 2077 6865  #### This is whe
+0004fca0: 7265 2079 6f75 206d 6f64 6966 7920 7072  re you modify pr
+0004fcb0: 6564 6963 7469 6f6e 7320 6f6e 2074 6573  edictions on tes
+0004fcc0: 7420 6461 7461 2074 6f20 6265 2073 616d  t data to be sam
+0004fcd0: 6520 6173 206f 7269 6769 6e61 6c20 6461  e as original da
+0004fce0: 7461 2074 7970 6520 2323 2323 230d 0a20  ta type #####.. 
+0004fcf0: 2020 2069 6620 6d6f 6469 6679 5f74 6172     if modify_tar
+0004fd00: 6765 7473 5f66 6c61 673a 0d0a 2020 2020  gets_flag:..    
+0004fd10: 2020 2020 795f 7072 6564 203d 206d 6f64      y_pred = mod
+0004fd20: 6966 795f 6172 7261 795f 746f 5f69 6e74  ify_array_to_int
+0004fd30: 6567 6572 2879 5f70 7265 642c 2074 6172  eger(y_pred, tar
+0004fd40: 6765 7473 5f6e 6567 6174 6976 655f 666c  gets_negative_fl
+0004fd50: 6167 290d 0a20 2020 2069 6620 6d6f 6465  ag)..    if mode
+0004fd60: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
+0004fd70: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
+0004fd80: 2323 2323 2323 2323 2020 2054 6869 7320  ########   This 
+0004fd90: 6973 2066 6f72 2052 6567 7265 7373 696f  is for Regressio
+0004fda0: 6e20 5072 6f62 6c65 6d73 204f 6e6c 7920  n Problems Only 
+0004fdb0: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+0004fdc0: 2020 2020 2023 2323 2323 2320 2049 6620       ######  If 
+0004fdd0: 5374 6163 6b69 6e67 5f20 466c 6167 2069  Stacking_ Flag i
+0004fde0: 7320 4661 6c73 652c 2074 6865 6e20 7765  s False, then we
+0004fdf0: 2064 6f20 456e 7365 6d62 6c69 6e67 2023   do Ensembling #
+0004fe00: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
+0004fe10: 6966 206e 6f74 2053 7461 636b 696e 675f  if not Stacking_
+0004fe20: 466c 6167 2061 6e64 206e 6f74 206d 6f64  Flag and not mod
+0004fe30: 656c 5f6c 6162 656c 203d 3d20 274d 756c  el_label == 'Mul
+0004fe40: 7469 5f4c 6162 656c 273a 0d0a 2020 2020  ti_Label':..    
+0004fe50: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
+0004fe60: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+0004fe70: 775f 636f 6c73 203d 205b 5d0d 0a20 2020  w_cols = []..   
+0004fe80: 2020 2020 2020 2020 2020 2020 2073 7562               sub
+0004fe90: 6d20 3d20 7064 2e44 6174 6146 7261 6d65  m = pd.DataFrame
+0004fea0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+0004feb0: 2020 2020 2323 2323 2054 6869 7320 6973      #### This is
+0004fec0: 2066 6f72 2045 6e73 656d 626c 696e 6720   for Ensembling 
+0004fed0: 204f 6e6c 7920 2323 2323 230d 0a20 2020   Only #####..   
+0004fee0: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+0004fef0: 2320 496e 2054 6573 7420 6461 7461 2076  # In Test data v
+0004ff00: 6572 626f 7365 2069 7320 7365 7420 746f  erbose is set to
+0004ff10: 207a 6572 6f20 7369 6e63 6520 6e6f 2072   zero since no r
+0004ff20: 6573 756c 7473 2063 616e 2062 6520 6f62  esults can be ob
+0004ff30: 7461 696e 6564 210d 0a20 2020 2020 2020  tained!..       
+0004ff40: 2020 2020 2020 2020 206d 6f64 656c 735f           models_
+0004ff50: 6c69 7374 2c20 656e 7365 6d62 6c65 7320  list, ensembles 
+0004ff60: 3d20 5175 6963 6b4d 4c5f 456e 7365 6d62  = QuickML_Ensemb
+0004ff70: 6c69 6e67 2858 2c20 792c 2058 5f74 6573  ling(X, y, X_tes
+0004ff80: 742c 2027 272c 0d0a 2020 2020 2020 2020  t, '',..        
 0004ff90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0004ffa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ffb0: 2020 2020 2020 206d 6f64 656c 7479 7065         modeltype
-0004ffc0: 3d6d 6f64 656c 7479 7065 2c20 426f 6f73  =modeltype, Boos
-0004ffd0: 7469 6e67 5f46 6c61 673d 426f 6f73 7469  ting_Flag=Boosti
-0004ffe0: 6e67 5f46 6c61 672c 0d0a 2020 2020 2020  ng_Flag,..      
+0004ffb0: 2020 6d6f 6465 6c74 7970 653d 6d6f 6465    modeltype=mode
+0004ffc0: 6c74 7970 652c 2042 6f6f 7374 696e 675f  ltype, Boosting_
+0004ffd0: 466c 6167 3d42 6f6f 7374 696e 675f 466c  Flag=Boosting_Fl
+0004ffe0: 6167 2c0d 0a20 2020 2020 2020 2020 2020  ag,..           
 0004fff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00050000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050010: 2020 2020 2073 636f 7269 6e67 3d27 272c       scoring='',
-00050020: 2076 6572 626f 7365 3d30 290d 0a20 2020   verbose=0)..   
-00050030: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-00050040: 656c 735f 6c69 7374 2e61 7070 656e 6428  els_list.append(
-00050050: 6d6f 6465 6c5f 6e61 6d65 290d 0a20 2020  model_name)..   
-00050060: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00050070: 206d 6f64 656c 732c 2065 6163 6820 696e   models, each in
-00050080: 207a 6970 286d 6f64 656c 735f 6c69 7374   zip(models_list
-00050090: 2c20 7261 6e67 6528 6c65 6e28 6d6f 6465  , range(len(mode
-000500a0: 6c73 5f6c 6973 7429 2929 3a0d 0a20 2020  ls_list))):..   
-000500b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000500c0: 206e 6577 5f63 6f6c 203d 2065 6163 685f   new_col = each_
-000500d0: 7461 7267 6574 2b27 5f27 2b6d 6f64 656c  target+'_'+model
-000500e0: 732b 275f 7072 6564 6963 7469 6f6e 7327  s+'_predictions'
-000500f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00050100: 2020 2020 2020 6966 2065 6163 682b 3120        if each+1 
-00050110: 3d3d 206c 656e 286d 6f64 656c 735f 6c69  == len(models_li
-00050120: 7374 293a 0d0a 2020 2020 2020 2020 2020  st):..          
-00050130: 2020 2020 2020 2020 2020 2020 2020 7375                su
-00050140: 626d 5b6e 6577 5f63 6f6c 5d20 3d20 795f  bm[new_col] = y_
-00050150: 7072 6564 0d0a 2020 2020 2020 2020 2020  pred..          
-00050160: 2020 2020 2020 2020 2020 2020 2020 7465                te
-00050170: 7374 6d5b 6e65 775f 636f 6c5d 203d 2079  stm[new_col] = y
-00050180: 5f70 7265 640d 0a20 2020 2020 2020 2020  _pred..         
-00050190: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000501a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000501b0: 2020 2020 2020 2020 2020 7375 626d 5b6e            subm[n
-000501c0: 6577 5f63 6f6c 5d20 3d20 656e 7365 6d62  ew_col] = ensemb
-000501d0: 6c65 735b 3a2c 6561 6368 5d0d 0a20 2020  les[:,each]..   
+00050010: 7363 6f72 696e 673d 2727 2c20 7665 7262  scoring='', verb
+00050020: 6f73 653d 3029 0d0a 2020 2020 2020 2020  ose=0)..        
+00050030: 2020 2020 2020 2020 6d6f 6465 6c73 5f6c          models_l
+00050040: 6973 742e 6170 7065 6e64 286d 6f64 656c  ist.append(model
+00050050: 5f6e 616d 6529 0d0a 2020 2020 2020 2020  _name)..        
+00050060: 2020 2020 2020 2020 666f 7220 6d6f 6465          for mode
+00050070: 6c73 2c20 6561 6368 2069 6e20 7a69 7028  ls, each in zip(
+00050080: 6d6f 6465 6c73 5f6c 6973 742c 2072 616e  models_list, ran
+00050090: 6765 286c 656e 286d 6f64 656c 735f 6c69  ge(len(models_li
+000500a0: 7374 2929 293a 0d0a 2020 2020 2020 2020  st))):..        
+000500b0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+000500c0: 636f 6c20 3d20 6561 6368 5f74 6172 6765  col = each_targe
+000500d0: 742b 275f 272b 6d6f 6465 6c73 2b27 5f70  t+'_'+models+'_p
+000500e0: 7265 6469 6374 696f 6e73 270d 0a20 2020  redictions'..   
+000500f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050100: 2069 6620 6561 6368 2b31 203d 3d20 6c65   if each+1 == le
+00050110: 6e28 6d6f 6465 6c73 5f6c 6973 7429 3a0d  n(models_list):.
+00050120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00050130: 2020 2020 2020 2020 2073 7562 6d5b 6e65           subm[ne
+00050140: 775f 636f 6c5d 203d 2079 5f70 7265 640d  w_col] = y_pred.
+00050150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00050160: 2020 2020 2020 2020 2074 6573 746d 5b6e           testm[n
+00050170: 6577 5f63 6f6c 5d20 3d20 795f 7072 6564  ew_col] = y_pred
+00050180: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00050190: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+000501a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000501b0: 2020 2020 2073 7562 6d5b 6e65 775f 636f       subm[new_co
+000501c0: 6c5d 203d 2065 6e73 656d 626c 6573 5b3a  l] = ensembles[:
+000501d0: 2c65 6163 685d 0d0a 2020 2020 2020 2020  ,each]..        
 000501e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000501f0: 2020 2020 2074 6573 746d 5b6e 6577 5f63       testm[new_c
-00050200: 6f6c 5d20 3d20 656e 7365 6d62 6c65 735b  ol] = ensembles[
-00050210: 3a2c 6561 6368 5d0d 0a20 2020 2020 2020  :,each]..       
-00050220: 2020 2020 2020 2020 2020 2020 206e 6577               new
-00050230: 5f63 6f6c 732e 6170 7065 6e64 286e 6577  _cols.append(new
-00050240: 5f63 6f6c 290d 0a20 2020 2020 2020 2020  _col)..         
-00050250: 2020 2020 2020 2023 2323 2041 6674 6572         ### After
-00050260: 2074 6869 732c 2079 5f70 7265 6420 6973   this, y_pred is
-00050270: 2061 2053 6572 6965 7320 6672 6f6d 206e   a Series from n
-00050280: 6f77 206f 6e2e 2059 6f75 206e 6565 6420  ow on. You need 
-00050290: 795f 7072 6564 2e76 616c 7565 7320 2023  y_pred.values  #
-000502a0: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-000502b0: 2020 2020 2069 6620 6c65 6e28 6e65 775f       if len(new_
-000502c0: 636f 6c73 2920 3d3d 2035 3a0d 0a20 2020  cols) == 5:..   
-000502d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000502e0: 2070 7269 6e74 2827 2020 2020 4361 6c63   print('    Calc
-000502f0: 756c 6174 696e 6720 7765 6967 6874 6564  ulating weighted
-00050300: 2061 7665 7261 6765 2065 6e73 656d 626c   average ensembl
-00050310: 6520 6f66 2025 6420 7265 6772 6573 736f  e of %d regresso
-00050320: 7273 2720 256c 656e 286e 6577 5f63 6f6c  rs' %len(new_col
-00050330: 7329 290d 0a20 2020 2020 2020 2020 2020  s))..           
-00050340: 2020 2020 2020 2020 2065 6e73 656d 5f70           ensem_p
-00050350: 7265 6420 3d20 7375 626d 5b6e 6577 5f63  red = subm[new_c
-00050360: 6f6c 735b 2d31 5d5d 2a30 2e35 2b30 2e31  ols[-1]]*0.5+0.1
-00050370: 3235 2a28 7375 626d 5b6e 6577 5f63 6f6c  25*(subm[new_col
-00050380: 735b 305d 5d2b 7375 626d 5b0d 0a20 2020  s[0]]+subm[..   
+000501f0: 7465 7374 6d5b 6e65 775f 636f 6c5d 203d  testm[new_col] =
+00050200: 2065 6e73 656d 626c 6573 5b3a 2c65 6163   ensembles[:,eac
+00050210: 685d 0d0a 2020 2020 2020 2020 2020 2020  h]..            
+00050220: 2020 2020 2020 2020 6e65 775f 636f 6c73          new_cols
+00050230: 2e61 7070 656e 6428 6e65 775f 636f 6c29  .append(new_col)
+00050240: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00050250: 2020 2323 2320 4166 7465 7220 7468 6973    ### After this
+00050260: 2c20 795f 7072 6564 2069 7320 6120 5365  , y_pred is a Se
+00050270: 7269 6573 2066 726f 6d20 6e6f 7720 6f6e  ries from now on
+00050280: 2e20 596f 7520 6e65 6564 2079 5f70 7265  . You need y_pre
+00050290: 642e 7661 6c75 6573 2020 2323 2323 0d0a  d.values  ####..
+000502a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000502b0: 6966 206c 656e 286e 6577 5f63 6f6c 7329  if len(new_cols)
+000502c0: 203d 3d20 353a 0d0a 2020 2020 2020 2020   == 5:..        
+000502d0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+000502e0: 7428 2720 2020 2043 616c 6375 6c61 7469  t('    Calculati
+000502f0: 6e67 2077 6569 6768 7465 6420 6176 6572  ng weighted aver
+00050300: 6167 6520 656e 7365 6d62 6c65 206f 6620  age ensemble of 
+00050310: 2564 2072 6567 7265 7373 6f72 7327 2025  %d regressors' %
+00050320: 6c65 6e28 6e65 775f 636f 6c73 2929 0d0a  len(new_cols))..
+00050330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050340: 2020 2020 656e 7365 6d5f 7072 6564 203d      ensem_pred =
+00050350: 2073 7562 6d5b 6e65 775f 636f 6c73 5b2d   subm[new_cols[-
+00050360: 315d 5d2a 302e 352b 302e 3132 352a 2873  1]]*0.5+0.125*(s
+00050370: 7562 6d5b 6e65 775f 636f 6c73 5b30 5d5d  ubm[new_cols[0]]
+00050380: 2b73 7562 6d5b 0d0a 2020 2020 2020 2020  +subm[..        
 00050390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000503a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000503b0: 206e 6577 5f63 6f6c 735b 315d 5d2b 7375   new_cols[1]]+su
-000503c0: 626d 5b6e 6577 5f63 6f6c 735b 325d 5d2b  bm[new_cols[2]]+
-000503d0: 7375 626d 5b6e 6577 5f63 6f6c 735b 335d  subm[new_cols[3]
-000503e0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-000503f0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00050400: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00050410: 7269 6e74 2827 2020 2020 4361 6c63 756c  rint('    Calcul
-00050420: 6174 696e 6720 7265 6775 6c61 7220 6176  ating regular av
-00050430: 6572 6167 6520 656e 7365 6d62 6c65 206f  erage ensemble o
-00050440: 6620 2564 2072 6567 7265 7373 6f72 7327  f %d regressors'
-00050450: 2025 6c65 6e28 636f 6c73 2929 0d0a 2020   %len(cols))..  
-00050460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050470: 2020 656e 7365 6d5f 7072 6564 203d 2028    ensem_pred = (
-00050480: 7375 626d 5b6e 6577 5f63 6f6c 735d 2e6d  subm[new_cols].m
-00050490: 6561 6e28 6178 6973 3d31 2929 0d0a 2020  ean(axis=1))..  
-000504a0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-000504b0: 2323 2320 5468 6973 206e 6578 7420 7374  ### This next st
-000504c0: 6570 2069 7320 7665 7279 2069 6d70 6f72  ep is very impor
-000504d0: 7461 6e74 2073 696e 6365 2073 6f6d 6520  tant since some 
-000504e0: 6d6f 6465 6c73 2067 6976 6520 7365 7269  models give seri
-000504f0: 6573 2c20 6f74 6865 7273 2067 6976 6520  es, others give 
-00050500: 6172 7261 7973 2e20 5665 7279 2070 6169  arrays. Very pai
-00050510: 6e66 756c 210d 0a20 2020 2020 2020 2020  nful!..         
-00050520: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00050530: 616e 6365 2865 6e73 656d 5f70 7265 642c  ance(ensem_pred,
-00050540: 7064 2e53 6572 6965 7329 206f 7220 6973  pd.Series) or is
-00050550: 696e 7374 616e 6365 2865 6e73 656d 5f70  instance(ensem_p
-00050560: 7265 642c 7064 2e44 6174 6146 7261 6d65  red,pd.DataFrame
-00050570: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00050580: 2020 2020 2020 2020 656e 7365 6d5f 7072          ensem_pr
-00050590: 6564 203d 2065 6e73 656d 5f70 7265 642e  ed = ensem_pred.
-000505a0: 7661 6c75 6573 0d0a 2020 2020 2020 2020  values..        
-000505b0: 2020 2020 2020 2020 6e65 775f 636f 6c20          new_col 
-000505c0: 3d20 6561 6368 5f74 6172 6765 742b 275f  = each_target+'_
-000505d0: 456e 7365 6d62 6c65 645f 7072 6564 6963  Ensembled_predic
-000505e0: 7469 6f6e 7327 0d0a 2020 2020 2020 2020  tions'..        
-000505f0: 2020 2020 2020 2020 7465 7374 6d5b 6e65          testm[ne
-00050600: 775f 636f 6c5d 203d 2065 6e73 656d 5f70  w_col] = ensem_p
-00050610: 7265 640d 0a20 2020 2020 2020 2020 2020  red..           
-00050620: 2020 2020 206e 6577 5f63 6f6c 732e 6170       new_cols.ap
-00050630: 7065 6e64 286e 6577 5f63 6f6c 290d 0a20  pend(new_col).. 
-00050640: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00050650: 7269 6e74 2827 436f 6d70 6c65 7465 6420  rint('Completed 
-00050660: 456e 7365 6d62 6c65 2070 7265 6469 6374  Ensemble predict
-00050670: 696f 6e73 206f 6e20 6865 6c64 206f 7574  ions on held out
-00050680: 2064 6174 6127 290d 0a20 2020 2020 2020   data')..       
-00050690: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
-000506a0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-000506b0: 696e 7428 2743 6f75 6c64 206e 6f74 2063  int('Could not c
-000506c0: 6f6d 706c 6574 6520 456e 7365 6d62 6c69  omplete Ensembli
-000506d0: 6e67 2070 7265 6469 6374 696f 6e73 206f  ng predictions o
-000506e0: 6e20 6865 6c64 206f 7574 2064 6174 6120  n held out data 
-000506f0: 6475 6520 746f 2045 7272 6f72 2729 0d0a  due to Error')..
-00050700: 2020 2020 2020 2020 656c 6966 2053 7461          elif Sta
-00050710: 636b 696e 675f 466c 6167 2061 6e64 206e  cking_Flag and n
-00050720: 6f74 206d 6f64 656c 5f6c 6162 656c 203d  ot model_label =
-00050730: 3d20 274d 756c 7469 5f4c 6162 656c 273a  = 'Multi_Label':
-00050740: 0d0a 2020 2020 2020 2020 2020 2020 7374  ..            st
-00050750: 6163 6b5f 636f 6c73 2c20 7374 6163 6b73  ack_cols, stacks
-00050760: 6669 6e61 6c20 3d20 5175 6963 6b4d 4c5f  final = QuickML_
-00050770: 5374 6163 6b69 6e67 2858 2c20 792c 2058  Stacking(X, y, X
-00050780: 5f74 6573 742c 0d0a 2020 2020 2020 2020  _test,..        
-00050790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000507a0: 2020 6d6f 6465 6c74 7970 652c 2042 6f6f    modeltype, Boo
-000507b0: 7374 696e 675f 466c 6167 2c0d 0a20 2020  sting_Flag,..   
+000503a0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+000503b0: 636f 6c73 5b31 5d5d 2b73 7562 6d5b 6e65  cols[1]]+subm[ne
+000503c0: 775f 636f 6c73 5b32 5d5d 2b73 7562 6d5b  w_cols[2]]+subm[
+000503d0: 6e65 775f 636f 6c73 5b33 5d5d 290d 0a20  new_cols[3]]).. 
+000503e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000503f0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00050400: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00050410: 2720 2020 2043 616c 6375 6c61 7469 6e67  '    Calculating
+00050420: 2072 6567 756c 6172 2061 7665 7261 6765   regular average
+00050430: 2065 6e73 656d 626c 6520 6f66 2025 6420   ensemble of %d 
+00050440: 7265 6772 6573 736f 7273 2720 256c 656e  regressors' %len
+00050450: 2863 6f6c 7329 290d 0a20 2020 2020 2020  (cols))..       
+00050460: 2020 2020 2020 2020 2020 2020 2065 6e73               ens
+00050470: 656d 5f70 7265 6420 3d20 2873 7562 6d5b  em_pred = (subm[
+00050480: 6e65 775f 636f 6c73 5d2e 6d65 616e 2861  new_cols].mean(a
+00050490: 7869 733d 3129 290d 0a20 2020 2020 2020  xis=1))..       
+000504a0: 2020 2020 2020 2020 2023 2323 2323 2054           ##### T
+000504b0: 6869 7320 6e65 7874 2073 7465 7020 6973  his next step is
+000504c0: 2076 6572 7920 696d 706f 7274 616e 7420   very important 
+000504d0: 7369 6e63 6520 736f 6d65 206d 6f64 656c  since some model
+000504e0: 7320 6769 7665 2073 6572 6965 732c 206f  s give series, o
+000504f0: 7468 6572 7320 6769 7665 2061 7272 6179  thers give array
+00050500: 732e 2056 6572 7920 7061 696e 6675 6c21  s. Very painful!
+00050510: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00050520: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00050530: 656e 7365 6d5f 7072 6564 2c70 642e 5365  ensem_pred,pd.Se
+00050540: 7269 6573 2920 6f72 2069 7369 6e73 7461  ries) or isinsta
+00050550: 6e63 6528 656e 7365 6d5f 7072 6564 2c70  nce(ensem_pred,p
+00050560: 642e 4461 7461 4672 616d 6529 3a0d 0a20  d.DataFrame):.. 
+00050570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050580: 2020 2065 6e73 656d 5f70 7265 6420 3d20     ensem_pred = 
+00050590: 656e 7365 6d5f 7072 6564 2e76 616c 7565  ensem_pred.value
+000505a0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+000505b0: 2020 206e 6577 5f63 6f6c 203d 2065 6163     new_col = eac
+000505c0: 685f 7461 7267 6574 2b27 5f45 6e73 656d  h_target+'_Ensem
+000505d0: 626c 6564 5f70 7265 6469 6374 696f 6e73  bled_predictions
+000505e0: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
+000505f0: 2020 2074 6573 746d 5b6e 6577 5f63 6f6c     testm[new_col
+00050600: 5d20 3d20 656e 7365 6d5f 7072 6564 0d0a  ] = ensem_pred..
+00050610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050620: 6e65 775f 636f 6c73 2e61 7070 656e 6428  new_cols.append(
+00050630: 6e65 775f 636f 6c29 0d0a 2020 2020 2020  new_col)..      
+00050640: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00050650: 2743 6f6d 706c 6574 6564 2045 6e73 656d  'Completed Ensem
+00050660: 626c 6520 7072 6564 6963 7469 6f6e 7320  ble predictions 
+00050670: 6f6e 2068 656c 6420 6f75 7420 6461 7461  on held out data
+00050680: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+00050690: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+000506a0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+000506b0: 436f 756c 6420 6e6f 7420 636f 6d70 6c65  Could not comple
+000506c0: 7465 2045 6e73 656d 626c 696e 6720 7072  te Ensembling pr
+000506d0: 6564 6963 7469 6f6e 7320 6f6e 2068 656c  edictions on hel
+000506e0: 6420 6f75 7420 6461 7461 2064 7565 2074  d out data due t
+000506f0: 6f20 4572 726f 7227 290d 0a20 2020 2020  o Error')..     
+00050700: 2020 2065 6c69 6620 5374 6163 6b69 6e67     elif Stacking
+00050710: 5f46 6c61 6720 616e 6420 6e6f 7420 6d6f  _Flag and not mo
+00050720: 6465 6c5f 6c61 6265 6c20 3d3d 2027 4d75  del_label == 'Mu
+00050730: 6c74 695f 4c61 6265 6c27 3a0d 0a20 2020  lti_Label':..   
+00050740: 2020 2020 2020 2020 2073 7461 636b 5f63           stack_c
+00050750: 6f6c 732c 2073 7461 636b 7366 696e 616c  ols, stacksfinal
+00050760: 203d 2051 7569 636b 4d4c 5f53 7461 636b   = QuickML_Stack
+00050770: 696e 6728 582c 2079 2c20 585f 7465 7374  ing(X, y, X_test
+00050780: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00050790: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+000507a0: 656c 7479 7065 2c20 426f 6f73 7469 6e67  eltype, Boosting
+000507b0: 5f46 6c61 672c 0d0a 2020 2020 2020 2020  _Flag,..        
 000507c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000507d0: 2020 2020 2020 2073 636f 7269 6e67 5f70         scoring_p
-000507e0: 6172 616d 6574 6572 2c76 6572 626f 7365  arameter,verbose
-000507f0: 3d76 6572 626f 7365 290d 0a20 2020 2020  =verbose)..     
-00050800: 2020 2020 2020 206e 6577 5f63 6f6c 203d         new_col =
-00050810: 2065 6163 685f 7461 7267 6574 2b27 5f53   each_target+'_S
-00050820: 7461 636b 6564 5f27 2b73 7461 636b 5f63  tacked_'+stack_c
-00050830: 6f6c 735b 305d 2e73 706c 6974 2822 5f22  ols[0].split("_"
-00050840: 295b 305d 2b27 5f70 7265 6469 6374 696f  )[0]+'_predictio
-00050850: 6e73 270d 0a20 2020 2020 2020 2020 2020  ns'..           
-00050860: 2069 6620 6c65 6e28 7374 6163 6b5f 636f   if len(stack_co
-00050870: 6c73 2920 3d3d 2031 3a0d 0a20 2020 2020  ls) == 1:..     
-00050880: 2020 2020 2020 2020 2020 2074 6573 746d             testm
-00050890: 5b6e 6577 5f63 6f6c 5d20 3d20 7374 6163  [new_col] = stac
-000508a0: 6b73 6669 6e61 6c0d 0a20 2020 2020 2020  ksfinal..       
-000508b0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-000508c0: 2020 2020 2020 2020 2020 2020 2323 2323              ####
-000508d0: 204a 7573 7420 6176 6572 6167 6520 7468   Just average th
-000508e0: 6520 7072 6564 6963 7469 6f6e 7320 6672  e predictions fr
-000508f0: 6f6d 2065 6163 6820 7374 6163 6b65 6420  om each stacked 
-00050900: 6d6f 6465 6c20 696e 746f 2061 2066 696e  model into a fin
-00050910: 616c 2070 7265 640d 0a20 2020 2020 2020  al pred..       
-00050920: 2020 2020 2020 2020 2074 6573 746d 5b6e           testm[n
-00050930: 6577 5f63 6f6c 5d20 3d20 7374 6163 6b73  ew_col] = stacks
-00050940: 6669 6e61 6c2e 6d65 616e 2861 7869 733d  final.mean(axis=
-00050950: 3129 0d0a 2020 2020 2020 2020 2323 2323  1)..        ####
-00050960: 2323 2054 6869 7320 6170 706c 6965 7320  ## This applies 
-00050970: 746f 2053 696e 676c 655f 4c61 6265 6c20  to Single_Label 
-00050980: 6173 2077 656c 6c20 6173 204d 756c 7469  as well as Multi
-00050990: 5f4c 6162 656c 2070 726f 626c 656d 7320  _Label problems 
-000509a0: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-000509b0: 2020 2020 6966 206d 6f64 656c 5f6c 6162      if model_lab
-000509c0: 656c 203d 3d20 2753 696e 676c 655f 4c61  el == 'Single_La
-000509d0: 6265 6c27 3a0d 0a20 2020 2020 2020 2020  bel':..         
-000509e0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-000509f0: 616e 6365 2873 616d 706c 655f 7375 626d  ance(sample_subm
-00050a00: 6973 7369 6f6e 2c20 7374 7229 3a0d 0a20  ission, str):.. 
-00050a10: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00050a20: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
-00050a30: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
-00050a40: 7375 626d 6973 7369 6f6e 5b65 6163 685f  submission[each_
-00050a50: 7461 7267 6574 5d20 3d20 795f 7072 6564  target] = y_pred
-00050a60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00050a70: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
-00050a80: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00050a90: 2323 2069 6620 666f 7220 736f 6d65 2072  ## if for some r
-00050aa0: 6561 736f 6e2c 2074 6865 2073 616d 706c  eason, the sampl
-00050ab0: 6520 7375 626d 6973 7369 6f6e 2066 696c  e submission fil
-00050ac0: 6520 6861 7320 6120 6469 6666 6572 656e  e has a differen
-00050ad0: 7420 7368 6170 6520 7468 616e 2079 5f70  t shape than y_p
-00050ae0: 7265 642c 0d0a 2020 2020 2020 2020 2020  red,..          
-00050af0: 2020 2020 2020 2020 2020 2323 2320 2074            ###  t
-00050b00: 6869 7320 6d61 7920 6361 7573 6520 616e  his may cause an
-00050b10: 2065 7272 6f72 2061 6e64 2079 6f75 2063   error and you c
-00050b20: 616e 206a 7573 7420 736b 6970 2074 6861  an just skip tha
-00050b30: 7420 7374 6570 210d 0a20 2020 2020 2020  t step!..       
-00050b40: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00050b50: 6e74 2827 4572 726f 723a 2053 616d 706c  nt('Error: Sampl
-00050b60: 6520 7375 626d 6973 7369 6f6e 2066 696c  e submission fil
-00050b70: 6520 6973 2069 6e63 6f72 7265 6374 2e20  e is incorrect. 
-00050b80: 506c 6561 7365 2063 6865 636b 2069 742e  Please check it.
-00050b90: 2063 6f6e 7469 6e75 696e 672e 2e2e 2729   continuing...')
-00050ba0: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-00050bb0: 2323 2049 6620 7468 6572 6520 6973 2061  ## If there is a
-00050bc0: 2074 6573 7420 6669 6c65 2c20 6974 2070   test file, it p
-00050bd0: 726f 6261 626c 7920 646f 6573 6e27 7420  robably doesn't 
-00050be0: 6861 7665 2074 6172 6765 742c 2073 6f20  have target, so 
-00050bf0: 6164 6420 7072 6564 6963 7469 6f6e 7320  add predictions 
-00050c00: 746f 2069 7421 0d0a 2020 2020 2020 2020  to it!..        
-00050c10: 2020 2020 7465 7374 6d5b 6561 6368 5f74      testm[each_t
-00050c20: 6172 6765 742b 275f 7072 6564 6963 7469  arget+'_predicti
-00050c30: 6f6e 7327 5d20 3d20 795f 7072 6564 0d0a  ons'] = y_pred..
-00050c40: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00050c50: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-00050c60: 7420 6973 696e 7374 616e 6365 2873 616d  t isinstance(sam
-00050c70: 706c 655f 7375 626d 6973 7369 6f6e 2c20  ple_submission, 
-00050c80: 7374 7229 3a0d 0a20 2020 2020 2020 2020  str):..         
-00050c90: 2020 2020 2020 2066 6f72 2070 7265 6469         for predi
-00050ca0: 6374 5f63 6f6c 2c20 6920 696e 207a 6970  ct_col, i in zip
-00050cb0: 2874 6172 6765 742c 2072 616e 6765 286c  (target, range(l
-00050cc0: 656e 2874 6172 6765 7429 2929 3a0d 0a20  en(target))):.. 
-00050cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050ce0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-00050cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050d00: 2073 616d 706c 655f 7375 626d 6973 7369   sample_submissi
-00050d10: 6f6e 5b70 7265 6469 6374 5f63 6f6c 5d20  on[predict_col] 
-00050d20: 3d20 795f 7072 6564 5b3a 2c69 5d0d 0a20  = y_pred[:,i].. 
-00050d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050d40: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
-00050d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050d60: 2020 2020 2323 2320 6966 2066 6f72 2073      ### if for s
-00050d70: 6f6d 6520 7265 6173 6f6e 2c20 7468 6520  ome reason, the 
-00050d80: 7361 6d70 6c65 2073 7562 6d69 7373 696f  sample submissio
-00050d90: 6e20 6669 6c65 2068 6173 2061 2064 6966  n file has a dif
-00050da0: 6665 7265 6e74 2073 6861 7065 2074 6861  ferent shape tha
-00050db0: 6e20 795f 7072 6564 2c0d 0a20 2020 2020  n y_pred,..     
-00050dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00050dd0: 2020 2023 2323 2020 7468 6973 206d 6179     ###  this may
-00050de0: 2063 6175 7365 2061 6e20 6572 726f 7220   cause an error 
-00050df0: 616e 6420 796f 7520 6361 6e20 6a75 7374  and you can just
-00050e00: 2073 6b69 7020 7468 6174 2073 7465 7021   skip that step!
-00050e10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00050e20: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00050e30: 2745 7272 6f72 3a20 5361 6d70 6c65 2073  'Error: Sample s
-00050e40: 7562 6d69 7373 696f 6e20 6669 6c65 2069  ubmission file i
-00050e50: 7320 696e 636f 7272 6563 742e 2050 6c65  s incorrect. Ple
-00050e60: 6173 6520 6368 6563 6b20 6974 2e20 636f  ase check it. co
-00050e70: 6e74 696e 7569 6e67 2e2e 2e27 290d 0a20  ntinuing...').. 
-00050e80: 2020 2020 2020 2023 2323 2320 4966 2074         #### If t
-00050e90: 6865 7265 2069 7320 6120 7465 7374 2066  here is a test f
-00050ea0: 696c 652c 2069 7420 7072 6f62 6162 6c79  ile, it probably
-00050eb0: 2064 6f65 736e 2774 2068 6176 6520 7461   doesn't have ta
-00050ec0: 7267 6574 2c20 736f 2061 6464 2070 7265  rget, so add pre
-00050ed0: 6469 6374 696f 6e73 2074 6f20 6974 210d  dictions to it!.
-00050ee0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00050ef0: 2070 7265 6469 6374 5f63 6f6c 2c20 6920   predict_col, i 
-00050f00: 696e 207a 6970 2874 6172 6765 742c 2072  in zip(target, r
-00050f10: 616e 6765 286c 656e 2874 6172 6765 7429  ange(len(target)
-00050f20: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
-00050f30: 2020 2020 2074 6573 746d 5b70 7265 6469       testm[predi
-00050f40: 6374 5f63 6f6c 2b27 5f70 7265 6469 6374  ct_col+'_predict
-00050f50: 696f 6e73 275d 203d 2079 5f70 7265 645b  ions'] = y_pred[
-00050f60: 3a2c 695d 0d0a 2020 2020 656c 7365 3a0d  :,i]..    else:.
-00050f70: 0a20 2020 2020 2020 2069 6620 6d6f 6465  .        if mode
-00050f80: 6c5f 6c61 6265 6c20 3d3d 2027 5369 6e67  l_label == 'Sing
-00050f90: 6c65 5f4c 6162 656c 273a 0d0a 2020 2020  le_Label':..    
-00050fa0: 2020 2020 2020 2020 2323 2323 204f 6e6c          #### Onl
-00050fb0: 7920 6365 7274 6169 6e20 6d75 6c74 692d  y certain multi-
-00050fc0: 6f75 7470 7574 2063 6c61 7373 6966 6965  output classifie
-00050fd0: 7273 2070 726f 7669 6465 2070 726f 6261  rs provide proba
-00050fe0: 732e 2046 6f72 206e 6f77 204c 696e 6561  s. For now Linea
-00050ff0: 7253 5643 2063 616e 2774 2e20 4865 6e63  rSVC can't. Henc
-00051000: 6520 736b 6970 2074 6869 732e 2e2e 0d0a  e skip this.....
-00051010: 2020 2020 2020 2020 2020 2020 7072 6f62              prob
-00051020: 615f 636f 6c73 203d 205b 5d0d 0a20 2020  a_cols = []..   
-00051030: 2020 2020 2020 2020 2023 2323 2323 2323           #######
-00051040: 2320 2020 5468 6973 2069 7320 666f 7220  #   This is for 
-00051050: 626f 7468 2042 696e 6172 7920 616e 6420  both Binary and 
-00051060: 4d75 6c74 6920 436c 6173 7369 6669 6361  Multi Classifica
-00051070: 7469 6f6e 2050 726f 626c 656d 7320 2323  tion Problems ##
-00051080: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
-00051090: 2020 2020 2020 2079 5f70 726f 6261 203d         y_proba =
-000510a0: 206d 6f64 656c 2e70 7265 6469 6374 5f70   model.predict_p
-000510b0: 726f 6261 2858 5f74 6573 7429 0d0a 2020  roba(X_test)..  
-000510c0: 2020 2020 2020 2020 2020 7072 6564 6963            predic
-000510d0: 7465 6420 3d20 636f 7079 2e64 6565 7063  ted = copy.deepc
-000510e0: 6f70 7928 795f 7072 6f62 6129 0d0a 2020  opy(y_proba)..  
-000510f0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-00051100: 2863 6c61 7373 6573 2920 3c3d 2032 3a0d  (classes) <= 2:.
-00051110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00051120: 2070 7265 6469 6374 6564 205b 3a2c 305d   predicted [:,0]
-00051130: 203d 2028 7072 6564 6963 7465 6420 5b3a   = (predicted [:
-00051140: 2c30 5d20 3e3d 2028 312d 6d5f 7468 7265  ,0] >= (1-m_thre
-00051150: 7368 2929 2e61 7374 7970 6528 2769 6e74  sh)).astype('int
-00051160: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-00051170: 2020 2020 7072 6564 6963 7465 6420 5b3a      predicted [:
-00051180: 2c31 5d20 3d20 2870 7265 6469 6374 6564  ,1] = (predicted
-00051190: 205b 3a2c 315d 203e 206d 5f74 6872 6573   [:,1] > m_thres
-000511a0: 6829 2e61 7374 7970 6528 2769 6e74 2729  h).astype('int')
-000511b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000511c0: 2020 6966 2070 7265 6469 6374 6564 5b3a    if predicted[:
-000511d0: 2c72 6172 655f 636c 6173 735d 2e6d 6561  ,rare_class].mea
-000511e0: 6e28 293d 3d30 206f 7220 7072 6564 6963  n()==0 or predic
-000511f0: 7465 645b 3a2c 7261 7265 5f63 6c61 7373  ted[:,rare_class
-00051200: 5d2e 6d65 616e 2829 3d3d 313a 0d0a 2020  ].mean()==1:..  
-00051210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051220: 2020 2323 2320 4966 2074 6865 206d 6f64    ### If the mod
-00051230: 656c 2069 7320 7072 6564 6963 7469 6e67  el is predicting
-00051240: 2061 6c6c 2030 2773 206f 7220 616c 6c20   all 0's or all 
-00051250: 3127 732c 2079 6f75 206e 6565 6420 746f  1's, you need to
-00051260: 2075 7365 2061 2072 6567 756c 6172 2074   use a regular t
-00051270: 6872 6573 686f 6c64 0d0a 2020 2020 2020  hreshold..      
-00051280: 2020 2020 2020 2020 2020 2020 2020 6d5f                m_
-00051290: 7468 7265 7368 203d 2030 2e35 0d0a 2020  thresh = 0.5..  
-000512a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000512b0: 2020 7072 696e 7428 2720 2020 204d 616b    print('    Mak
-000512c0: 696e 6720 7465 7374 2044 6174 6120 7072  ing test Data pr
-000512d0: 6564 6963 7469 6f6e 7320 7573 696e 6720  edictions using 
-000512e0: 7265 6775 6c61 7220 5468 7265 7368 6f6c  regular Threshol
-000512f0: 6420 3d20 2530 2e33 6627 2025 6d5f 7468  d = %0.3f' %m_th
-00051300: 7265 7368 290d 0a20 2020 2020 2020 2020  resh)..         
-00051310: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00051320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051330: 2020 2323 2320 4966 2074 6865 206d 6f64    ### If the mod
-00051340: 656c 2069 7320 676f 6f64 2077 6974 6820  el is good with 
-00051350: 7468 6520 6d6f 6469 6669 6564 2074 6872  the modified thr
-00051360: 6573 686f 6c64 2c20 7468 656e 2079 6f75  eshold, then you
-00051370: 2075 7365 2074 6865 206d 6f64 6966 6965   use the modifie
-00051380: 6420 7468 7265 7368 6f6c 6421 0d0a 2020  d threshold!..  
-00051390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000513a0: 2020 7072 696e 7428 2720 2020 204d 616b    print('    Mak
-000513b0: 696e 6720 7465 7374 2044 6174 6120 7072  ing test Data pr
-000513c0: 6564 6963 7469 6f6e 7320 7573 696e 6720  edictions using 
-000513d0: 6d6f 6469 6669 6564 2054 6872 6573 686f  modified Thresho
-000513e0: 6c64 203d 2025 302e 3366 2720 256d 5f74  ld = %0.3f' %m_t
-000513f0: 6872 6573 6829 0d0a 2020 2020 2020 2020  hresh)..        
-00051400: 2020 2020 2020 2020 2020 2020 795f 7072              y_pr
-00051410: 6564 203d 2070 7265 6469 6374 6564 5b3a  ed = predicted[:
-00051420: 2c72 6172 655f 636c 6173 735d 0d0a 2020  ,rare_class]..  
-00051430: 2020 2020 2020 2020 2020 2323 2320 596f            ### Yo
-00051440: 7520 7769 6c6c 206e 6565 6420 746f 2063  u will need to c
-00051450: 7265 6174 6520 7072 6f62 6162 696c 6974  reate probabilit
-00051460: 6965 7320 666f 7220 6561 6368 2063 6c61  ies for each cla
-00051470: 7373 2068 6572 6520 2023 2323 230d 0a20  ss here  ####.. 
-00051480: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
-00051490: 6163 685f 636c 6173 7320 696e 2063 6c61  ach_class in cla
-000514a0: 7373 6573 3a0d 0a20 2020 2020 2020 2020  sses:..         
-000514b0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-000514c0: 616e 6365 2865 6163 685f 636c 6173 732c  ance(each_class,
-000514d0: 2073 7472 293a 0d0a 2020 2020 2020 2020   str):..        
-000514e0: 2020 2020 2020 2020 2020 2020 7072 6f62              prob
-000514f0: 615f 636f 6c20 3d20 6561 6368 5f74 6172  a_col = each_tar
-00051500: 6765 742b 275f 7072 6f62 615f 272b 6561  get+'_proba_'+ea
-00051510: 6368 5f63 6c61 7373 0d0a 2020 2020 2020  ch_class..      
-00051520: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00051530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00051540: 2020 2020 2070 726f 6261 5f63 6f6c 203d       proba_col =
-00051550: 2065 6163 685f 7461 7267 6574 2b27 5f70   each_target+'_p
-00051560: 726f 6261 5f27 2b73 7472 2865 6163 685f  roba_'+str(each_
-00051570: 636c 6173 7329 0d0a 2020 2020 2020 2020  class)..        
-00051580: 2020 2020 2020 2020 636f 756e 7420 3d20          count = 
-00051590: 696e 7428 6c61 6265 6c5f 6469 6374 5b65  int(label_dict[e
-000515a0: 6163 685f 7461 7267 6574 5d5b 2764 6963  ach_target]['dic
-000515b0: 7469 6f6e 6172 7927 5d5b 6561 6368 5f63  tionary'][each_c
-000515c0: 6c61 7373 5d29 0d0a 2020 2020 2020 2020  lass])..        
-000515d0: 2020 2020 2020 2020 7465 7374 6d5b 7072          testm[pr
-000515e0: 6f62 615f 636f 6c5d 203d 2079 5f70 726f  oba_col] = y_pro
-000515f0: 6261 5b3a 2c63 6f75 6e74 5d0d 0a20 2020  ba[:,count]..   
-00051600: 2020 2020 2020 2020 2020 2020 2070 726f               pro
-00051610: 6261 5f63 6f6c 732e 6170 7065 6e64 2870  ba_cols.append(p
-00051620: 726f 6261 5f63 6f6c 290d 0a20 2020 2020  roba_col)..     
-00051630: 2020 2023 2323 2323 204e 6f77 2074 616b     ##### Now tak
-00051640: 6520 6561 6368 2074 6172 6765 7420 696e  e each target in
-00051650: 2074 6865 206c 6973 7420 6f66 2074 6172   the list of tar
-00051660: 6765 7473 2061 6e64 2061 7070 6c79 2072  gets and apply r
-00051670: 6576 6572 7365 2074 7261 6e73 666f 726d  everse transform
-00051680: 6174 696f 6e20 6f6e 2070 7265 6469 6374  ation on predict
-00051690: 6564 206c 6162 656c 7320 2323 2323 0d0a  ed labels ####..
-000516a0: 2020 2020 2020 2020 666f 7220 6561 6368          for each
-000516b0: 5f74 6172 6765 742c 2069 2069 6e20 7a69  _target, i in zi
-000516c0: 7028 7461 7267 6574 2c20 7261 6e67 6528  p(target, range(
-000516d0: 6c65 6e28 7461 7267 6574 2929 293a 0d0a  len(target))):..
-000516e0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-000516f0: 656e 286c 6162 656c 5f64 6963 745b 6561  en(label_dict[ea
-00051700: 6368 5f74 6172 6765 745d 5b27 7472 616e  ch_target]['tran
-00051710: 7366 6f72 6d65 7227 5d29 203d 3d20 303a  sformer']) == 0:
-00051720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00051730: 2020 2323 2323 2323 2323 2320 204e 4f20    #########  NO 
-00051740: 2020 5420 5220 4120 4e20 5320 4620 4f20    T R A N S F O 
-00051750: 5220 4d20 4520 5220 2020 4c20 4f20 4720  R M E R   L O G 
-00051760: 4920 4320 2042 2045 2047 2049 204e 2053  I C  B E G I N S
-00051770: 2020 2020 4820 4520 5220 4520 2120 2323      H E R E ! ##
-00051780: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00051790: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-000517a0: 2020 2020 2023 2323 2069 6620 7468 6572       ### if ther
-000517b0: 6520 6973 206e 6f20 7472 616e 7366 6f72  e is no transfor
-000517c0: 6d65 722c 2074 6865 6e20 6c65 6176 6520  mer, then leave 
-000517d0: 7468 6520 7072 6564 6963 7465 6420 636c  the predicted cl
-000517e0: 6173 7365 7320 6173 2069 730d 0a20 2020  asses as is..   
-000517f0: 2020 2020 2020 2020 2020 2020 2063 6c61               cla
-00051800: 7373 6573 203d 206c 6162 656c 5f64 6963  sses = label_dic
-00051810: 745b 6561 6368 5f74 6172 6765 745d 5b27  t[each_target]['
-00051820: 636c 6173 7365 7327 5d0d 0a20 2020 2020  classes']..     
-00051830: 2020 2020 2020 2020 2020 2023 2323 2323             #####
-00051840: 2049 6620 7468 6572 6520 6973 206e 6f20   If there is no 
-00051850: 7472 616e 7366 6f72 6d65 722c 2079 6f75  transformer, you
-00051860: 2063 616e 206a 7573 7420 7072 6564 6963   can just predic
-00051870: 7420 7468 6520 636c 6173 7365 7320 6173  t the classes as
-00051880: 2069 7320 616e 6420 7361 7665 2069 7420   is and save it 
-00051890: 6865 7265 2023 2323 0d0a 2020 2020 2020  here ###..      
-000518a0: 2020 2020 2020 2020 2020 7072 6564 6963            predic
-000518b0: 745f 636f 6c73 203d 2065 6163 685f 7461  t_cols = each_ta
-000518c0: 7267 6574 2b27 5f70 7265 6469 6374 696f  rget+'_predictio
-000518d0: 6e73 270d 0a20 2020 2020 2020 2020 2020  ns'..           
-000518e0: 2020 2020 2069 6620 6d6f 6465 6c5f 6c61       if model_la
-000518f0: 6265 6c20 3d3d 2027 5369 6e67 6c65 5f4c  bel == 'Single_L
-00051900: 6162 656c 273a 0d0a 2020 2020 2020 2020  abel':..        
-00051910: 2020 2020 2020 2020 2020 2020 7465 7374              test
-00051920: 6d5b 7072 6564 6963 745f 636f 6c73 5d20  m[predict_cols] 
-00051930: 3d20 795f 7072 6564 0d0a 2020 2020 2020  = y_pred..      
-00051940: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00051950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00051960: 2020 2020 2074 6573 746d 5b70 7265 6469       testm[predi
-00051970: 6374 5f63 6f6c 735d 203d 2079 5f70 7265  ct_cols] = y_pre
-00051980: 645b 3a2c 695d 0d0a 2020 2020 2020 2020  d[:,i]..        
-00051990: 2020 2020 2020 2020 2323 2323 2323 2020          ######  
-000519a0: 4966 2053 7461 636b 696e 675f 466c 6167  If Stacking_Flag
-000519b0: 2069 7320 4661 6c73 652c 2074 6865 6e20   is False, then 
-000519c0: 7765 2064 6f20 456e 7365 6d62 6c69 6e67  we do Ensembling
-000519d0: 2023 2323 2323 2323 0d0a 2020 2020 2020   #######..      
-000519e0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-000519f0: 2053 7461 636b 696e 675f 466c 6167 2061   Stacking_Flag a
-00051a00: 6e64 206d 6f64 656c 5f6c 6162 656c 203d  nd model_label =
-00051a10: 3d20 2753 696e 676c 655f 4c61 6265 6c27  = 'Single_Label'
-00051a20: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00051a30: 2020 2020 2020 2023 2323 2045 6e73 656d         ### Ensem
-00051a40: 626c 696e 6720 6973 206e 6f74 2064 6f6e  bling is not don
-00051a50: 6520 7768 656e 2074 6865 206d 6f64 656c  e when the model
-00051a60: 206e 616d 6520 6973 2043 6174 426f 6f73   name is CatBoos
-00051a70: 7420 2323 2323 0d0a 2020 2020 2020 2020  t ####..        
-00051a80: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-00051a90: 636f 6c73 203d 205b 5d0d 0a20 2020 2020  cols = []..     
-00051aa0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00051ab0: 7562 6d20 3d20 7064 2e44 6174 6146 7261  ubm = pd.DataFra
-00051ac0: 6d65 2829 0d0a 2020 2020 2020 2020 2020  me()..          
-00051ad0: 2020 2020 2020 2020 2020 2323 2323 2054            #### T
-00051ae0: 6869 7320 6973 2066 6f72 2045 6e73 656d  his is for Ensem
-00051af0: 626c 696e 6720 204f 6e6c 7920 2323 2323  bling  Only ####
-00051b00: 230d 0a20 2020 2020 2020 2020 2020 2020  #..             
-00051b10: 2020 2020 2020 2023 2323 2320 496e 2054         #### In T
-00051b20: 6573 7420 6461 7461 2076 6572 626f 7365  est data verbose
-00051b30: 2069 7320 7365 7420 746f 207a 6572 6f20   is set to zero 
-00051b40: 7369 6e63 6520 6e6f 2072 6573 756c 7473  since no results
-00051b50: 2063 616e 2062 6520 6f62 7461 696e 6564   can be obtained
-00051b60: 210d 0a20 2020 2020 2020 2020 2020 2020  !..             
-00051b70: 2020 2020 2020 2069 6620 6c65 6e28 636c         if len(cl
-00051b80: 6173 7365 7329 203d 3d20 323a 0d0a 2020  asses) == 2:..  
+000507d0: 2020 7363 6f72 696e 675f 7061 7261 6d65    scoring_parame
+000507e0: 7465 722c 7665 7262 6f73 653d 7665 7262  ter,verbose=verb
+000507f0: 6f73 6529 0d0a 2020 2020 2020 2020 2020  ose)..          
+00050800: 2020 6e65 775f 636f 6c20 3d20 6561 6368    new_col = each
+00050810: 5f74 6172 6765 742b 275f 5374 6163 6b65  _target+'_Stacke
+00050820: 645f 272b 7374 6163 6b5f 636f 6c73 5b30  d_'+stack_cols[0
+00050830: 5d2e 7370 6c69 7428 225f 2229 5b30 5d2b  ].split("_")[0]+
+00050840: 275f 7072 6564 6963 7469 6f6e 7327 0d0a  '_predictions'..
+00050850: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00050860: 656e 2873 7461 636b 5f63 6f6c 7329 203d  en(stack_cols) =
+00050870: 3d20 313a 0d0a 2020 2020 2020 2020 2020  = 1:..          
+00050880: 2020 2020 2020 7465 7374 6d5b 6e65 775f        testm[new_
+00050890: 636f 6c5d 203d 2073 7461 636b 7366 696e  col] = stacksfin
+000508a0: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
+000508b0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+000508c0: 2020 2020 2020 2023 2323 2320 4a75 7374         #### Just
+000508d0: 2061 7665 7261 6765 2074 6865 2070 7265   average the pre
+000508e0: 6469 6374 696f 6e73 2066 726f 6d20 6561  dictions from ea
+000508f0: 6368 2073 7461 636b 6564 206d 6f64 656c  ch stacked model
+00050900: 2069 6e74 6f20 6120 6669 6e61 6c20 7072   into a final pr
+00050910: 6564 0d0a 2020 2020 2020 2020 2020 2020  ed..            
+00050920: 2020 2020 7465 7374 6d5b 6e65 775f 636f      testm[new_co
+00050930: 6c5d 203d 2073 7461 636b 7366 696e 616c  l] = stacksfinal
+00050940: 2e6d 6561 6e28 6178 6973 3d31 290d 0a20  .mean(axis=1).. 
+00050950: 2020 2020 2020 2023 2323 2323 2320 5468         ###### Th
+00050960: 6973 2061 7070 6c69 6573 2074 6f20 5369  is applies to Si
+00050970: 6e67 6c65 5f4c 6162 656c 2061 7320 7765  ngle_Label as we
+00050980: 6c6c 2061 7320 4d75 6c74 695f 4c61 6265  ll as Multi_Labe
+00050990: 6c20 7072 6f62 6c65 6d73 2023 2323 2323  l problems #####
+000509a0: 2323 2323 230d 0a20 2020 2020 2020 2069  #####..        i
+000509b0: 6620 6d6f 6465 6c5f 6c61 6265 6c20 3d3d  f model_label ==
+000509c0: 2027 5369 6e67 6c65 5f4c 6162 656c 273a   'Single_Label':
+000509d0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000509e0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+000509f0: 7361 6d70 6c65 5f73 7562 6d69 7373 696f  sample_submissio
+00050a00: 6e2c 2073 7472 293a 0d0a 2020 2020 2020  n, str):..      
+00050a10: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
+00050a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050a30: 2020 2020 7361 6d70 6c65 5f73 7562 6d69      sample_submi
+00050a40: 7373 696f 6e5b 6561 6368 5f74 6172 6765  ssion[each_targe
+00050a50: 745d 203d 2079 5f70 7265 640d 0a20 2020  t] = y_pred..   
+00050a60: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+00050a70: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
+00050a80: 2020 2020 2020 2020 2020 2323 2320 6966            ### if
+00050a90: 2066 6f72 2073 6f6d 6520 7265 6173 6f6e   for some reason
+00050aa0: 2c20 7468 6520 7361 6d70 6c65 2073 7562  , the sample sub
+00050ab0: 6d69 7373 696f 6e20 6669 6c65 2068 6173  mission file has
+00050ac0: 2061 2064 6966 6665 7265 6e74 2073 6861   a different sha
+00050ad0: 7065 2074 6861 6e20 795f 7072 6564 2c0d  pe than y_pred,.
+00050ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00050af0: 2020 2020 2023 2323 2020 7468 6973 206d       ###  this m
+00050b00: 6179 2063 6175 7365 2061 6e20 6572 726f  ay cause an erro
+00050b10: 7220 616e 6420 796f 7520 6361 6e20 6a75  r and you can ju
+00050b20: 7374 2073 6b69 7020 7468 6174 2073 7465  st skip that ste
+00050b30: 7021 0d0a 2020 2020 2020 2020 2020 2020  p!..            
+00050b40: 2020 2020 2020 2020 7072 696e 7428 2745          print('E
+00050b50: 7272 6f72 3a20 5361 6d70 6c65 2073 7562  rror: Sample sub
+00050b60: 6d69 7373 696f 6e20 6669 6c65 2069 7320  mission file is 
+00050b70: 696e 636f 7272 6563 742e 2050 6c65 6173  incorrect. Pleas
+00050b80: 6520 6368 6563 6b20 6974 2e20 636f 6e74  e check it. cont
+00050b90: 696e 7569 6e67 2e2e 2e27 290d 0a20 2020  inuing...')..   
+00050ba0: 2020 2020 2020 2020 2023 2323 2320 4966           #### If
+00050bb0: 2074 6865 7265 2069 7320 6120 7465 7374   there is a test
+00050bc0: 2066 696c 652c 2069 7420 7072 6f62 6162   file, it probab
+00050bd0: 6c79 2064 6f65 736e 2774 2068 6176 6520  ly doesn't have 
+00050be0: 7461 7267 6574 2c20 736f 2061 6464 2070  target, so add p
+00050bf0: 7265 6469 6374 696f 6e73 2074 6f20 6974  redictions to it
+00050c00: 210d 0a20 2020 2020 2020 2020 2020 2074  !..            t
+00050c10: 6573 746d 5b65 6163 685f 7461 7267 6574  estm[each_target
+00050c20: 2b27 5f70 7265 6469 6374 696f 6e73 275d  +'_predictions']
+00050c30: 203d 2079 5f70 7265 640d 0a20 2020 2020   = y_pred..     
+00050c40: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00050c50: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+00050c60: 6e73 7461 6e63 6528 7361 6d70 6c65 5f73  nstance(sample_s
+00050c70: 7562 6d69 7373 696f 6e2c 2073 7472 293a  ubmission, str):
+00050c80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00050c90: 2020 666f 7220 7072 6564 6963 745f 636f    for predict_co
+00050ca0: 6c2c 2069 2069 6e20 7a69 7028 7461 7267  l, i in zip(targ
+00050cb0: 6574 2c20 7261 6e67 6528 6c65 6e28 7461  et, range(len(ta
+00050cc0: 7267 6574 2929 293a 0d0a 2020 2020 2020  rget))):..      
+00050cd0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+00050ce0: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
+00050cf0: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+00050d00: 6c65 5f73 7562 6d69 7373 696f 6e5b 7072  le_submission[pr
+00050d10: 6564 6963 745f 636f 6c5d 203d 2079 5f70  edict_col] = y_p
+00050d20: 7265 645b 3a2c 695d 0d0a 2020 2020 2020  red[:,i]..      
+00050d30: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00050d40: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
+00050d50: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00050d60: 2323 2069 6620 666f 7220 736f 6d65 2072  ## if for some r
+00050d70: 6561 736f 6e2c 2074 6865 2073 616d 706c  eason, the sampl
+00050d80: 6520 7375 626d 6973 7369 6f6e 2066 696c  e submission fil
+00050d90: 6520 6861 7320 6120 6469 6666 6572 656e  e has a differen
+00050da0: 7420 7368 6170 6520 7468 616e 2079 5f70  t shape than y_p
+00050db0: 7265 642c 0d0a 2020 2020 2020 2020 2020  red,..          
+00050dc0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+00050dd0: 2320 2074 6869 7320 6d61 7920 6361 7573  #  this may caus
+00050de0: 6520 616e 2065 7272 6f72 2061 6e64 2079  e an error and y
+00050df0: 6f75 2063 616e 206a 7573 7420 736b 6970  ou can just skip
+00050e00: 2074 6861 7420 7374 6570 210d 0a20 2020   that step!..   
+00050e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050e20: 2020 2020 2070 7269 6e74 2827 4572 726f       print('Erro
+00050e30: 723a 2053 616d 706c 6520 7375 626d 6973  r: Sample submis
+00050e40: 7369 6f6e 2066 696c 6520 6973 2069 6e63  sion file is inc
+00050e50: 6f72 7265 6374 2e20 506c 6561 7365 2063  orrect. Please c
+00050e60: 6865 636b 2069 742e 2063 6f6e 7469 6e75  heck it. continu
+00050e70: 696e 672e 2e2e 2729 0d0a 2020 2020 2020  ing...')..      
+00050e80: 2020 2323 2323 2049 6620 7468 6572 6520    #### If there 
+00050e90: 6973 2061 2074 6573 7420 6669 6c65 2c20  is a test file, 
+00050ea0: 6974 2070 726f 6261 626c 7920 646f 6573  it probably does
+00050eb0: 6e27 7420 6861 7665 2074 6172 6765 742c  n't have target,
+00050ec0: 2073 6f20 6164 6420 7072 6564 6963 7469   so add predicti
+00050ed0: 6f6e 7320 746f 2069 7421 0d0a 2020 2020  ons to it!..    
+00050ee0: 2020 2020 2020 2020 666f 7220 7072 6564          for pred
+00050ef0: 6963 745f 636f 6c2c 2069 2069 6e20 7a69  ict_col, i in zi
+00050f00: 7028 7461 7267 6574 2c20 7261 6e67 6528  p(target, range(
+00050f10: 6c65 6e28 7461 7267 6574 2929 293a 0d0a  len(target))):..
+00050f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00050f30: 7465 7374 6d5b 7072 6564 6963 745f 636f  testm[predict_co
+00050f40: 6c2b 275f 7072 6564 6963 7469 6f6e 7327  l+'_predictions'
+00050f50: 5d20 3d20 795f 7072 6564 5b3a 2c69 5d0d  ] = y_pred[:,i].
+00050f60: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
+00050f70: 2020 2020 6966 206d 6f64 656c 5f6c 6162      if model_lab
+00050f80: 656c 203d 3d20 2753 696e 676c 655f 4c61  el == 'Single_La
+00050f90: 6265 6c27 3a0d 0a20 2020 2020 2020 2020  bel':..         
+00050fa0: 2020 2023 2323 2320 4f6e 6c79 2063 6572     #### Only cer
+00050fb0: 7461 696e 206d 756c 7469 2d6f 7574 7075  tain multi-outpu
+00050fc0: 7420 636c 6173 7369 6669 6572 7320 7072  t classifiers pr
+00050fd0: 6f76 6964 6520 7072 6f62 6173 2e20 466f  ovide probas. Fo
+00050fe0: 7220 6e6f 7720 4c69 6e65 6172 5356 4320  r now LinearSVC 
+00050ff0: 6361 6e27 742e 2048 656e 6365 2073 6b69  can't. Hence ski
+00051000: 7020 7468 6973 2e2e 2e0d 0a20 2020 2020  p this.....     
+00051010: 2020 2020 2020 2070 726f 6261 5f63 6f6c         proba_col
+00051020: 7320 3d20 5b5d 0d0a 2020 2020 2020 2020  s = []..        
+00051030: 2020 2020 2323 2323 2323 2323 2020 2054      ########   T
+00051040: 6869 7320 6973 2066 6f72 2062 6f74 6820  his is for both 
+00051050: 4269 6e61 7279 2061 6e64 204d 756c 7469  Binary and Multi
+00051060: 2043 6c61 7373 6966 6963 6174 696f 6e20   Classification 
+00051070: 5072 6f62 6c65 6d73 2023 2323 2323 2323  Problems #######
+00051080: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
+00051090: 2020 795f 7072 6f62 6120 3d20 6d6f 6465    y_proba = mode
+000510a0: 6c2e 7072 6564 6963 745f 7072 6f62 6128  l.predict_proba(
+000510b0: 585f 7465 7374 290d 0a20 2020 2020 2020  X_test)..       
+000510c0: 2020 2020 2070 7265 6469 6374 6564 203d       predicted =
+000510d0: 2063 6f70 792e 6465 6570 636f 7079 2879   copy.deepcopy(y
+000510e0: 5f70 726f 6261 290d 0a20 2020 2020 2020  _proba)..       
+000510f0: 2020 2020 2069 6620 6c65 6e28 636c 6173       if len(clas
+00051100: 7365 7329 203c 3d20 323a 0d0a 2020 2020  ses) <= 2:..    
+00051110: 2020 2020 2020 2020 2020 2020 7072 6564              pred
+00051120: 6963 7465 6420 5b3a 2c30 5d20 3d20 2870  icted [:,0] = (p
+00051130: 7265 6469 6374 6564 205b 3a2c 305d 203e  redicted [:,0] >
+00051140: 3d20 2831 2d6d 5f74 6872 6573 6829 292e  = (1-m_thresh)).
+00051150: 6173 7479 7065 2827 696e 7427 290d 0a20  astype('int').. 
+00051160: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00051170: 7265 6469 6374 6564 205b 3a2c 315d 203d  redicted [:,1] =
+00051180: 2028 7072 6564 6963 7465 6420 5b3a 2c31   (predicted [:,1
+00051190: 5d20 3e20 6d5f 7468 7265 7368 292e 6173  ] > m_thresh).as
+000511a0: 7479 7065 2827 696e 7427 290d 0a20 2020  type('int')..   
+000511b0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000511c0: 7072 6564 6963 7465 645b 3a2c 7261 7265  predicted[:,rare
+000511d0: 5f63 6c61 7373 5d2e 6d65 616e 2829 3d3d  _class].mean()==
+000511e0: 3020 6f72 2070 7265 6469 6374 6564 5b3a  0 or predicted[:
+000511f0: 2c72 6172 655f 636c 6173 735d 2e6d 6561  ,rare_class].mea
+00051200: 6e28 293d 3d31 3a0d 0a20 2020 2020 2020  n()==1:..       
+00051210: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00051220: 2049 6620 7468 6520 6d6f 6465 6c20 6973   If the model is
+00051230: 2070 7265 6469 6374 696e 6720 616c 6c20   predicting all 
+00051240: 3027 7320 6f72 2061 6c6c 2031 2773 2c20  0's or all 1's, 
+00051250: 796f 7520 6e65 6564 2074 6f20 7573 6520  you need to use 
+00051260: 6120 7265 6775 6c61 7220 7468 7265 7368  a regular thresh
+00051270: 6f6c 640d 0a20 2020 2020 2020 2020 2020  old..           
+00051280: 2020 2020 2020 2020 206d 5f74 6872 6573           m_thres
+00051290: 6820 3d20 302e 350d 0a20 2020 2020 2020  h = 0.5..       
+000512a0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+000512b0: 6e74 2827 2020 2020 4d61 6b69 6e67 2074  nt('    Making t
+000512c0: 6573 7420 4461 7461 2070 7265 6469 6374  est Data predict
+000512d0: 696f 6e73 2075 7369 6e67 2072 6567 756c  ions using regul
+000512e0: 6172 2054 6872 6573 686f 6c64 203d 2025  ar Threshold = %
+000512f0: 302e 3366 2720 256d 5f74 6872 6573 6829  0.3f' %m_thresh)
+00051300: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00051310: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00051320: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00051330: 2049 6620 7468 6520 6d6f 6465 6c20 6973   If the model is
+00051340: 2067 6f6f 6420 7769 7468 2074 6865 206d   good with the m
+00051350: 6f64 6966 6965 6420 7468 7265 7368 6f6c  odified threshol
+00051360: 642c 2074 6865 6e20 796f 7520 7573 6520  d, then you use 
+00051370: 7468 6520 6d6f 6469 6669 6564 2074 6872  the modified thr
+00051380: 6573 686f 6c64 210d 0a20 2020 2020 2020  eshold!..       
+00051390: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+000513a0: 6e74 2827 2020 2020 4d61 6b69 6e67 2074  nt('    Making t
+000513b0: 6573 7420 4461 7461 2070 7265 6469 6374  est Data predict
+000513c0: 696f 6e73 2075 7369 6e67 206d 6f64 6966  ions using modif
+000513d0: 6965 6420 5468 7265 7368 6f6c 6420 3d20  ied Threshold = 
+000513e0: 2530 2e33 6627 2025 6d5f 7468 7265 7368  %0.3f' %m_thresh
+000513f0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00051400: 2020 2020 2020 2079 5f70 7265 6420 3d20         y_pred = 
+00051410: 7072 6564 6963 7465 645b 3a2c 7261 7265  predicted[:,rare
+00051420: 5f63 6c61 7373 5d0d 0a20 2020 2020 2020  _class]..       
+00051430: 2020 2020 2023 2323 2059 6f75 2077 696c       ### You wil
+00051440: 6c20 6e65 6564 2074 6f20 6372 6561 7465  l need to create
+00051450: 2070 726f 6261 6269 6c69 7469 6573 2066   probabilities f
+00051460: 6f72 2065 6163 6820 636c 6173 7320 6865  or each class he
+00051470: 7265 2020 2323 2323 0d0a 2020 2020 2020  re  ####..      
+00051480: 2020 2020 2020 666f 7220 6561 6368 5f63        for each_c
+00051490: 6c61 7373 2069 6e20 636c 6173 7365 733a  lass in classes:
+000514a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000514b0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+000514c0: 6561 6368 5f63 6c61 7373 2c20 7374 7229  each_class, str)
+000514d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000514e0: 2020 2020 2020 2070 726f 6261 5f63 6f6c         proba_col
+000514f0: 203d 2065 6163 685f 7461 7267 6574 2b27   = each_target+'
+00051500: 5f70 726f 6261 5f27 2b65 6163 685f 636c  _proba_'+each_cl
+00051510: 6173 730d 0a20 2020 2020 2020 2020 2020  ass..           
+00051520: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00051530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051540: 7072 6f62 615f 636f 6c20 3d20 6561 6368  proba_col = each
+00051550: 5f74 6172 6765 742b 275f 7072 6f62 615f  _target+'_proba_
+00051560: 272b 7374 7228 6561 6368 5f63 6c61 7373  '+str(each_class
+00051570: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00051580: 2020 2063 6f75 6e74 203d 2069 6e74 286c     count = int(l
+00051590: 6162 656c 5f64 6963 745b 6561 6368 5f74  abel_dict[each_t
+000515a0: 6172 6765 745d 5b27 6469 6374 696f 6e61  arget]['dictiona
+000515b0: 7279 275d 5b65 6163 685f 636c 6173 735d  ry'][each_class]
+000515c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000515d0: 2020 2074 6573 746d 5b70 726f 6261 5f63     testm[proba_c
+000515e0: 6f6c 5d20 3d20 795f 7072 6f62 615b 3a2c  ol] = y_proba[:,
+000515f0: 636f 756e 745d 0d0a 2020 2020 2020 2020  count]..        
+00051600: 2020 2020 2020 2020 7072 6f62 615f 636f          proba_co
+00051610: 6c73 2e61 7070 656e 6428 7072 6f62 615f  ls.append(proba_
+00051620: 636f 6c29 0d0a 2020 2020 2020 2020 2323  col)..        ##
+00051630: 2323 2320 4e6f 7720 7461 6b65 2065 6163  ### Now take eac
+00051640: 6820 7461 7267 6574 2069 6e20 7468 6520  h target in the 
+00051650: 6c69 7374 206f 6620 7461 7267 6574 7320  list of targets 
+00051660: 616e 6420 6170 706c 7920 7265 7665 7273  and apply revers
+00051670: 6520 7472 616e 7366 6f72 6d61 7469 6f6e  e transformation
+00051680: 206f 6e20 7072 6564 6963 7465 6420 6c61   on predicted la
+00051690: 6265 6c73 2023 2323 230d 0a20 2020 2020  bels ####..     
+000516a0: 2020 2066 6f72 2065 6163 685f 7461 7267     for each_targ
+000516b0: 6574 2c20 6920 696e 207a 6970 2874 6172  et, i in zip(tar
+000516c0: 6765 742c 2072 616e 6765 286c 656e 2874  get, range(len(t
+000516d0: 6172 6765 7429 2929 3a0d 0a20 2020 2020  arget))):..     
+000516e0: 2020 2020 2020 2069 6620 6c65 6e28 6c61         if len(la
+000516f0: 6265 6c5f 6469 6374 5b65 6163 685f 7461  bel_dict[each_ta
+00051700: 7267 6574 5d5b 2774 7261 6e73 666f 726d  rget]['transform
+00051710: 6572 275d 2920 3d3d 2030 3a0d 0a20 2020  er']) == 0:..   
+00051720: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00051730: 2323 2323 2323 2020 4e4f 2020 2054 2052  ######  NO   T R
+00051740: 2041 204e 2053 2046 204f 2052 204d 2045   A N S F O R M E
+00051750: 2052 2020 204c 204f 2047 2049 2043 2020   R   L O G I C  
+00051760: 4220 4520 4720 4920 4e20 5320 2020 2048  B E G I N S    H
+00051770: 2045 2052 2045 2021 2023 2323 2323 2323   E R E ! #######
+00051780: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00051790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000517a0: 2323 2320 6966 2074 6865 7265 2069 7320  ### if there is 
+000517b0: 6e6f 2074 7261 6e73 666f 726d 6572 2c20  no transformer, 
+000517c0: 7468 656e 206c 6561 7665 2074 6865 2070  then leave the p
+000517d0: 7265 6469 6374 6564 2063 6c61 7373 6573  redicted classes
+000517e0: 2061 7320 6973 0d0a 2020 2020 2020 2020   as is..        
+000517f0: 2020 2020 2020 2020 636c 6173 7365 7320          classes 
+00051800: 3d20 6c61 6265 6c5f 6469 6374 5b65 6163  = label_dict[eac
+00051810: 685f 7461 7267 6574 5d5b 2763 6c61 7373  h_target]['class
+00051820: 6573 275d 0d0a 2020 2020 2020 2020 2020  es']..          
+00051830: 2020 2020 2020 2323 2323 2320 4966 2074        ##### If t
+00051840: 6865 7265 2069 7320 6e6f 2074 7261 6e73  here is no trans
+00051850: 666f 726d 6572 2c20 796f 7520 6361 6e20  former, you can 
+00051860: 6a75 7374 2070 7265 6469 6374 2074 6865  just predict the
+00051870: 2063 6c61 7373 6573 2061 7320 6973 2061   classes as is a
+00051880: 6e64 2073 6176 6520 6974 2068 6572 6520  nd save it here 
+00051890: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+000518a0: 2020 2020 2070 7265 6469 6374 5f63 6f6c       predict_col
+000518b0: 7320 3d20 6561 6368 5f74 6172 6765 742b  s = each_target+
+000518c0: 275f 7072 6564 6963 7469 6f6e 7327 0d0a  '_predictions'..
+000518d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000518e0: 6966 206d 6f64 656c 5f6c 6162 656c 203d  if model_label =
+000518f0: 3d20 2753 696e 676c 655f 4c61 6265 6c27  = 'Single_Label'
+00051900: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00051910: 2020 2020 2020 2074 6573 746d 5b70 7265         testm[pre
+00051920: 6469 6374 5f63 6f6c 735d 203d 2079 5f70  dict_cols] = y_p
+00051930: 7265 640d 0a20 2020 2020 2020 2020 2020  red..           
+00051940: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00051950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051960: 7465 7374 6d5b 7072 6564 6963 745f 636f  testm[predict_co
+00051970: 6c73 5d20 3d20 795f 7072 6564 5b3a 2c69  ls] = y_pred[:,i
+00051980: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+00051990: 2020 2023 2323 2323 2320 2049 6620 5374     ######  If St
+000519a0: 6163 6b69 6e67 5f46 6c61 6720 6973 2046  acking_Flag is F
+000519b0: 616c 7365 2c20 7468 656e 2077 6520 646f  alse, then we do
+000519c0: 2045 6e73 656d 626c 696e 6720 2323 2323   Ensembling ####
+000519d0: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
+000519e0: 2020 2020 2069 6620 6e6f 7420 5374 6163       if not Stac
+000519f0: 6b69 6e67 5f46 6c61 6720 616e 6420 6d6f  king_Flag and mo
+00051a00: 6465 6c5f 6c61 6265 6c20 3d3d 2027 5369  del_label == 'Si
+00051a10: 6e67 6c65 5f4c 6162 656c 273a 0d0a 2020  ngle_Label':..  
+00051a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051a30: 2020 2323 2320 456e 7365 6d62 6c69 6e67    ### Ensembling
+00051a40: 2069 7320 6e6f 7420 646f 6e65 2077 6865   is not done whe
+00051a50: 6e20 7468 6520 6d6f 6465 6c20 6e61 6d65  n the model name
+00051a60: 2069 7320 4361 7442 6f6f 7374 2023 2323   is CatBoost ###
+00051a70: 230d 0a20 2020 2020 2020 2020 2020 2020  #..             
+00051a80: 2020 2020 2020 206e 6577 5f63 6f6c 7320         new_cols 
+00051a90: 3d20 5b5d 0d0a 2020 2020 2020 2020 2020  = []..          
+00051aa0: 2020 2020 2020 2020 2020 7375 626d 203d            subm =
+00051ab0: 2070 642e 4461 7461 4672 616d 6528 290d   pd.DataFrame().
+00051ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00051ad0: 2020 2020 2023 2323 2320 5468 6973 2069       #### This i
+00051ae0: 7320 666f 7220 456e 7365 6d62 6c69 6e67  s for Ensembling
+00051af0: 2020 4f6e 6c79 2023 2323 2323 0d0a 2020    Only #####..  
+00051b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051b10: 2020 2323 2323 2049 6e20 5465 7374 2064    #### In Test d
+00051b20: 6174 6120 7665 7262 6f73 6520 6973 2073  ata verbose is s
+00051b30: 6574 2074 6f20 7a65 726f 2073 696e 6365  et to zero since
+00051b40: 206e 6f20 7265 7375 6c74 7320 6361 6e20   no results can 
+00051b50: 6265 206f 6274 6169 6e65 6421 0d0a 2020  be obtained!..  
+00051b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051b70: 2020 6966 206c 656e 2863 6c61 7373 6573    if len(classes
+00051b80: 2920 3d3d 2032 3a0d 0a20 2020 2020 2020  ) == 2:..       
 00051b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051ba0: 2020 2020 2020 6d6f 6465 6c73 5f6c 6973        models_lis
-00051bb0: 742c 2065 6e73 656d 626c 6573 203d 2051  t, ensembles = Q
-00051bc0: 7569 636b 4d4c 5f45 6e73 656d 626c 696e  uickML_Ensemblin
-00051bd0: 6728 582c 2079 2c20 585f 7465 7374 2c20  g(X, y, X_test, 
-00051be0: 2727 2c0d 0a20 2020 2020 2020 2020 2020  '',..           
+00051ba0: 206d 6f64 656c 735f 6c69 7374 2c20 656e   models_list, en
+00051bb0: 7365 6d62 6c65 7320 3d20 5175 6963 6b4d  sembles = QuickM
+00051bc0: 4c5f 456e 7365 6d62 6c69 6e67 2858 2c20  L_Ensembling(X, 
+00051bd0: 792c 2058 5f74 6573 742c 2027 272c 0d0a  y, X_test, '',..
+00051be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00051bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00051c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051c10: 2020 2020 2020 206d 6f64 656c 7479 7065         modeltype
-00051c20: 3d27 4269 6e61 7279 5f43 6c61 7373 6966  ='Binary_Classif
-00051c30: 6963 6174 696f 6e27 2c20 426f 6f73 7469  ication', Boosti
-00051c40: 6e67 5f46 6c61 673d 426f 6f73 7469 6e67  ng_Flag=Boosting
-00051c50: 5f46 6c61 672c 0d0a 2020 2020 2020 2020  _Flag,..        
+00051c10: 2020 6d6f 6465 6c74 7970 653d 2742 696e    modeltype='Bin
+00051c20: 6172 795f 436c 6173 7369 6669 6361 7469  ary_Classificati
+00051c30: 6f6e 272c 2042 6f6f 7374 696e 675f 466c  on', Boosting_Fl
+00051c40: 6167 3d42 6f6f 7374 696e 675f 466c 6167  ag=Boosting_Flag
+00051c50: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
 00051c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00051c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051c80: 2020 2020 2020 2020 2020 2073 636f 7269             scori
-00051c90: 6e67 3d27 272c 2076 6572 626f 7365 3d30  ng='', verbose=0
-00051ca0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00051cb0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00051c80: 2020 2020 2020 7363 6f72 696e 673d 2727        scoring=''
+00051c90: 2c20 7665 7262 6f73 653d 3029 0d0a 2020  , verbose=0)..  
+00051ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051cb0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
 00051cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051cd0: 2020 2020 2020 6d6f 6465 6c73 5f6c 6973        models_lis
-00051ce0: 742c 2065 6e73 656d 626c 6573 203d 2051  t, ensembles = Q
-00051cf0: 7569 636b 4d4c 5f45 6e73 656d 626c 696e  uickML_Ensemblin
-00051d00: 6728 582c 2079 2c20 585f 7465 7374 2c20  g(X, y, X_test, 
-00051d10: 2727 2c0d 0a20 2020 2020 2020 2020 2020  '',..           
+00051cd0: 206d 6f64 656c 735f 6c69 7374 2c20 656e   models_list, en
+00051ce0: 7365 6d62 6c65 7320 3d20 5175 6963 6b4d  sembles = QuickM
+00051cf0: 4c5f 456e 7365 6d62 6c69 6e67 2858 2c20  L_Ensembling(X, 
+00051d00: 792c 2058 5f74 6573 742c 2027 272c 0d0a  y, X_test, '',..
+00051d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00051d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00051d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051d40: 2020 2020 2020 206d 6f64 656c 7479 7065         modeltype
-00051d50: 3d27 4d75 6c74 695f 436c 6173 7369 6669  ='Multi_Classifi
-00051d60: 6361 7469 6f6e 272c 2042 6f6f 7374 696e  cation', Boostin
-00051d70: 675f 466c 6167 3d42 6f6f 7374 696e 675f  g_Flag=Boosting_
-00051d80: 466c 6167 2c0d 0a20 2020 2020 2020 2020  Flag,..         
+00051d40: 2020 6d6f 6465 6c74 7970 653d 274d 756c    modeltype='Mul
+00051d50: 7469 5f43 6c61 7373 6966 6963 6174 696f  ti_Classificatio
+00051d60: 6e27 2c20 426f 6f73 7469 6e67 5f46 6c61  n', Boosting_Fla
+00051d70: 673d 426f 6f73 7469 6e67 5f46 6c61 672c  g=Boosting_Flag,
+00051d80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 00051d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00051da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051db0: 2020 2020 2020 2020 2020 7363 6f72 696e            scorin
-00051dc0: 673d 2727 2c20 7665 7262 6f73 653d 3029  g='', verbose=0)
-00051dd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00051de0: 2020 2020 2020 6d6f 6465 6c73 5f6c 6973        models_lis
-00051df0: 742e 6170 7065 6e64 286d 6f64 656c 5f6e  t.append(model_n
-00051e00: 616d 6529 0d0a 2020 2020 2020 2020 2020  ame)..          
-00051e10: 2020 2020 2020 2020 2020 666f 7220 6d6f            for mo
-00051e20: 6465 6c73 2c20 6561 6368 2069 6e20 7a69  dels, each in zi
-00051e30: 7028 6d6f 6465 6c73 5f6c 6973 742c 2072  p(models_list, r
-00051e40: 616e 6765 286c 656e 286d 6f64 656c 735f  ange(len(models_
-00051e50: 6c69 7374 2929 293a 0d0a 2020 2020 2020  list))):..      
-00051e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051e70: 2020 6e65 775f 636f 6c20 3d20 6561 6368    new_col = each
-00051e80: 5f74 6172 6765 742b 275f 272b 6d6f 6465  _target+'_'+mode
-00051e90: 6c73 2b27 5f70 7265 6469 6374 696f 6e73  ls+'_predictions
-00051ea0: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-00051eb0: 2020 2020 2020 2020 2020 2069 6620 6561             if ea
-00051ec0: 6368 2b31 203d 3d20 6c65 6e28 6d6f 6465  ch+1 == len(mode
-00051ed0: 6c73 5f6c 6973 7429 3a0d 0a20 2020 2020  ls_list):..     
+00051db0: 2020 2020 2073 636f 7269 6e67 3d27 272c       scoring='',
+00051dc0: 2076 6572 626f 7365 3d30 290d 0a20 2020   verbose=0)..   
+00051dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051de0: 206d 6f64 656c 735f 6c69 7374 2e61 7070   models_list.app
+00051df0: 656e 6428 6d6f 6465 6c5f 6e61 6d65 290d  end(model_name).
+00051e00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00051e10: 2020 2020 2066 6f72 206d 6f64 656c 732c       for models,
+00051e20: 2065 6163 6820 696e 207a 6970 286d 6f64   each in zip(mod
+00051e30: 656c 735f 6c69 7374 2c20 7261 6e67 6528  els_list, range(
+00051e40: 6c65 6e28 6d6f 6465 6c73 5f6c 6973 7429  len(models_list)
+00051e50: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
+00051e60: 2020 2020 2020 2020 2020 2020 206e 6577               new
+00051e70: 5f63 6f6c 203d 2065 6163 685f 7461 7267  _col = each_targ
+00051e80: 6574 2b27 5f27 2b6d 6f64 656c 732b 275f  et+'_'+models+'_
+00051e90: 7072 6564 6963 7469 6f6e 7327 0d0a 2020  predictions'..  
+00051ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051eb0: 2020 2020 2020 6966 2065 6163 682b 3120        if each+1 
+00051ec0: 3d3d 206c 656e 286d 6f64 656c 735f 6c69  == len(models_li
+00051ed0: 7374 293a 0d0a 2020 2020 2020 2020 2020  st):..          
 00051ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051ef0: 2020 2020 2020 2073 7562 6d5b 6e65 775f         subm[new_
-00051f00: 636f 6c5d 203d 2079 5f70 7265 640d 0a20  col] = y_pred.. 
+00051ef0: 2020 7375 626d 5b6e 6577 5f63 6f6c 5d20    subm[new_col] 
+00051f00: 3d20 795f 7072 6564 0d0a 2020 2020 2020  = y_pred..      
 00051f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051f20: 2020 2020 2020 2020 2020 2074 6573 746d             testm
-00051f30: 5b6e 6577 5f63 6f6c 5d20 3d20 795f 7072  [new_col] = y_pr
-00051f40: 6564 0d0a 2020 2020 2020 2020 2020 2020  ed..            
-00051f50: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00051f60: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00051f70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00051f80: 7562 6d5b 6e65 775f 636f 6c5d 203d 2065  ubm[new_col] = e
-00051f90: 6e73 656d 626c 6573 5b3a 2c65 6163 685d  nsembles[:,each]
-00051fa0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00051fb0: 2020 2020 2020 2020 2020 2020 2020 7465                te
-00051fc0: 7374 6d5b 6e65 775f 636f 6c5d 203d 2065  stm[new_col] = e
-00051fd0: 6e73 656d 626c 6573 5b3a 2c65 6163 685d  nsembles[:,each]
-00051fe0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00051ff0: 2020 2020 2020 2020 2020 6e65 775f 636f            new_co
-00052000: 6c73 2e61 7070 656e 6428 6e65 775f 636f  ls.append(new_co
-00052010: 6c29 0d0a 2020 2020 2020 2020 2020 2020  l)..            
-00052020: 2020 2020 2020 2020 2323 2323 2323 2320          ####### 
-00052030: 6e6f 7720 636f 6d62 696e 6520 7468 6520  now combine the 
-00052040: 7072 6564 6963 7469 6f6e 7320 696e 746f  predictions into
-00052050: 206f 6e65 2065 6e73 656d 626c 6564 2070   one ensembled p
-00052060: 7265 6469 6374 696f 6e20 2323 2323 2323  rediction ######
-00052070: 230d 0a20 2020 2020 2020 2020 2020 2020  #..             
-00052080: 2020 2020 2020 206e 6577 5f63 6f6c 203d         new_col =
-00052090: 2065 6163 685f 7461 7267 6574 2b27 5f45   each_target+'_E
-000520a0: 6e73 656d 626c 6564 5f70 7265 6469 6374  nsembled_predict
-000520b0: 696f 6e73 270d 0a20 2020 2020 2020 2020  ions'..         
-000520c0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-000520d0: 6e28 6e65 775f 636f 6c73 2920 3d3d 2035  n(new_cols) == 5
-000520e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000520f0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00052100: 2827 2020 2020 4361 6c63 756c 6174 696e  ('    Calculatin
-00052110: 6720 7765 6967 6874 6564 2061 7665 7261  g weighted avera
-00052120: 6765 2065 6e73 656d 626c 6520 6f66 2025  ge ensemble of %
-00052130: 6420 636c 6173 7369 6669 6572 7327 2025  d classifiers' %
-00052140: 6c65 6e28 6e65 775f 636f 6c73 2929 0d0a  len(new_cols))..
+00051f20: 2020 2020 2020 7465 7374 6d5b 6e65 775f        testm[new_
+00051f30: 636f 6c5d 203d 2079 5f70 7265 640d 0a20  col] = y_pred.. 
+00051f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051f50: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00051f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051f70: 2020 2020 2020 2020 2020 7375 626d 5b6e            subm[n
+00051f80: 6577 5f63 6f6c 5d20 3d20 656e 7365 6d62  ew_col] = ensemb
+00051f90: 6c65 735b 3a2c 6561 6368 5d0d 0a20 2020  les[:,each]..   
+00051fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051fb0: 2020 2020 2020 2020 2074 6573 746d 5b6e           testm[n
+00051fc0: 6577 5f63 6f6c 5d20 3d20 656e 7365 6d62  ew_col] = ensemb
+00051fd0: 6c65 735b 3a2c 6561 6368 5d0d 0a20 2020  les[:,each]..   
+00051fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051ff0: 2020 2020 206e 6577 5f63 6f6c 732e 6170       new_cols.ap
+00052000: 7065 6e64 286e 6577 5f63 6f6c 290d 0a20  pend(new_col).. 
+00052010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052020: 2020 2023 2323 2323 2323 206e 6f77 2063     ####### now c
+00052030: 6f6d 6269 6e65 2074 6865 2070 7265 6469  ombine the predi
+00052040: 6374 696f 6e73 2069 6e74 6f20 6f6e 6520  ctions into one 
+00052050: 656e 7365 6d62 6c65 6420 7072 6564 6963  ensembled predic
+00052060: 7469 6f6e 2023 2323 2323 2323 0d0a 2020  tion #######..  
+00052070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052080: 2020 6e65 775f 636f 6c20 3d20 6561 6368    new_col = each
+00052090: 5f74 6172 6765 742b 275f 456e 7365 6d62  _target+'_Ensemb
+000520a0: 6c65 645f 7072 6564 6963 7469 6f6e 7327  led_predictions'
+000520b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000520c0: 2020 2020 2020 6966 206c 656e 286e 6577        if len(new
+000520d0: 5f63 6f6c 7329 203d 3d20 353a 0d0a 2020  _cols) == 5:..  
+000520e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000520f0: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+00052100: 2043 616c 6375 6c61 7469 6e67 2077 6569   Calculating wei
+00052110: 6768 7465 6420 6176 6572 6167 6520 656e  ghted average en
+00052120: 7365 6d62 6c65 206f 6620 2564 2063 6c61  semble of %d cla
+00052130: 7373 6966 6965 7273 2720 256c 656e 286e  ssifiers' %len(n
+00052140: 6577 5f63 6f6c 7329 290d 0a20 2020 2020  ew_cols))..     
 00052150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052160: 2020 2020 2020 2020 656e 7365 6d5f 7072          ensem_pr
-00052170: 6564 203d 206e 702e 726f 756e 6428 7375  ed = np.round(su
-00052180: 626d 5b6e 6577 5f63 6f6c 735b 2d31 5d5d  bm[new_cols[-1]]
-00052190: 2a30 2e35 2b30 2e31 3235 2a28 7375 626d  *0.5+0.125*(subm
-000521a0: 5b6e 6577 5f63 6f6c 735b 305d 5d2b 7375  [new_cols[0]]+su
-000521b0: 626d 5b0d 0a20 2020 2020 2020 2020 2020  bm[..           
+00052160: 2020 2065 6e73 656d 5f70 7265 6420 3d20     ensem_pred = 
+00052170: 6e70 2e72 6f75 6e64 2873 7562 6d5b 6e65  np.round(subm[ne
+00052180: 775f 636f 6c73 5b2d 315d 5d2a 302e 352b  w_cols[-1]]*0.5+
+00052190: 302e 3132 352a 2873 7562 6d5b 6e65 775f  0.125*(subm[new_
+000521a0: 636f 6c73 5b30 5d5d 2b73 7562 6d5b 0d0a  cols[0]]+subm[..
+000521b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000521c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000521d0: 2020 2020 2020 2020 2020 2020 206e 6577               new
-000521e0: 5f63 6f6c 735b 315d 5d2b 7375 626d 5b6e  _cols[1]]+subm[n
-000521f0: 6577 5f63 6f6c 735b 325d 5d2b 7375 626d  ew_cols[2]]+subm
-00052200: 5b6e 6577 5f63 6f6c 735b 335d 5d29 292e  [new_cols[3]])).
-00052210: 6173 7479 7065 2869 6e74 290d 0a20 2020  astype(int)..   
-00052220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052230: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00052240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052250: 7072 696e 7428 2720 2020 2043 616c 6375  print('    Calcu
-00052260: 6c61 7469 6e67 2061 7665 7261 6765 2065  lating average e
-00052270: 6e73 656d 626c 6520 6f66 2025 6420 636c  nsemble of %d cl
-00052280: 6173 7369 6669 6572 7327 2025 6c65 6e28  assifiers' %len(
-00052290: 6e65 775f 636f 6c73 2929 0d0a 2020 2020  new_cols))..    
-000522a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000522b0: 2020 2020 656e 7365 6d5f 7072 6564 203d      ensem_pred =
-000522c0: 2028 7375 626d 5b6e 6577 5f63 6f6c 735d   (subm[new_cols]
-000522d0: 2e6d 6561 6e28 6178 6973 3d31 2929 2e61  .mean(axis=1)).a
-000522e0: 7374 7970 6528 696e 7429 0d0a 2020 2020  stype(int)..    
-000522f0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00052300: 2053 7461 636b 696e 675f 466c 6167 2061   Stacking_Flag a
-00052310: 6e64 206d 6f64 656c 5f6c 6162 656c 203d  nd model_label =
-00052320: 3d20 2753 696e 676c 655f 4c61 6265 6c27  = 'Single_Label'
-00052330: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00052340: 2020 2020 2020 2073 7461 636b 5f63 6f6c         stack_col
-00052350: 732c 2073 7461 636b 7366 696e 616c 203d  s, stacksfinal =
-00052360: 2051 7569 636b 4d4c 5f53 7461 636b 696e   QuickML_Stackin
-00052370: 6728 582c 2079 2c20 585f 7465 7374 2c0d  g(X, y, X_test,.
-00052380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000521d0: 2020 2020 2020 2020 6e65 775f 636f 6c73          new_cols
+000521e0: 5b31 5d5d 2b73 7562 6d5b 6e65 775f 636f  [1]]+subm[new_co
+000521f0: 6c73 5b32 5d5d 2b73 7562 6d5b 6e65 775f  ls[2]]+subm[new_
+00052200: 636f 6c73 5b33 5d5d 2929 2e61 7374 7970  cols[3]])).astyp
+00052210: 6528 696e 7429 0d0a 2020 2020 2020 2020  e(int)..        
+00052220: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00052230: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00052240: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00052250: 2827 2020 2020 4361 6c63 756c 6174 696e  ('    Calculatin
+00052260: 6720 6176 6572 6167 6520 656e 7365 6d62  g average ensemb
+00052270: 6c65 206f 6620 2564 2063 6c61 7373 6966  le of %d classif
+00052280: 6965 7273 2720 256c 656e 286e 6577 5f63  iers' %len(new_c
+00052290: 6f6c 7329 290d 0a20 2020 2020 2020 2020  ols))..         
+000522a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000522b0: 6e73 656d 5f70 7265 6420 3d20 2873 7562  nsem_pred = (sub
+000522c0: 6d5b 6e65 775f 636f 6c73 5d2e 6d65 616e  m[new_cols].mean
+000522d0: 2861 7869 733d 3129 292e 6173 7479 7065  (axis=1)).astype
+000522e0: 2869 6e74 290d 0a20 2020 2020 2020 2020  (int)..         
+000522f0: 2020 2020 2020 2065 6c69 6620 5374 6163         elif Stac
+00052300: 6b69 6e67 5f46 6c61 6720 616e 6420 6d6f  king_Flag and mo
+00052310: 6465 6c5f 6c61 6265 6c20 3d3d 2027 5369  del_label == 'Si
+00052320: 6e67 6c65 5f4c 6162 656c 273a 0d0a 2020  ngle_Label':..  
+00052330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052340: 2020 7374 6163 6b5f 636f 6c73 2c20 7374    stack_cols, st
+00052350: 6163 6b73 6669 6e61 6c20 3d20 5175 6963  acksfinal = Quic
+00052360: 6b4d 4c5f 5374 6163 6b69 6e67 2858 2c20  kML_Stacking(X, 
+00052370: 792c 2058 5f74 6573 742c 0d0a 2020 2020  y, X_test,..    
+00052380: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00052390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000523a0: 2020 2020 2020 2020 6d6f 6465 6c74 7970          modeltyp
-000523b0: 652c 2042 6f6f 7374 696e 675f 466c 6167  e, Boosting_Flag
-000523c0: 2c73 636f 7269 6e67 5f70 6172 616d 6574  ,scoring_paramet
-000523d0: 6572 2c76 6572 626f 7365 290d 0a20 2020  er,verbose)..   
-000523e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000523f0: 206e 6577 5f63 6f6c 203d 2065 6163 685f   new_col = each_
-00052400: 7461 7267 6574 2b27 5f53 7461 636b 6564  target+'_Stacked
-00052410: 5f27 2b73 7461 636b 5f63 6f6c 735b 305d  _'+stack_cols[0]
-00052420: 2e73 706c 6974 2822 5f22 295b 305d 2b27  .split("_")[0]+'
-00052430: 5f70 7265 6469 6374 696f 6e73 270d 0a20  _predictions'.. 
-00052440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052450: 2020 2065 6e73 656d 5f70 7265 6420 3d20     ensem_pred = 
-00052460: 6e70 2e61 7267 6d61 7828 7374 6163 6b73  np.argmax(stacks
-00052470: 6669 6e61 6c2c 6178 6973 3d31 290d 0a20  final,axis=1).. 
-00052480: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00052490: 6620 6d6f 6465 6c5f 6c61 6265 6c20 3d3d  f model_label ==
-000524a0: 2027 5369 6e67 6c65 5f4c 6162 656c 273a   'Single_Label':
-000524b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000524c0: 2020 2020 2020 2323 2323 2320 5468 6973        ##### This
-000524d0: 206e 6578 7420 7374 6570 2069 7320 7665   next step is ve
-000524e0: 7279 2069 6d70 6f72 7461 6e74 2073 696e  ry important sin
-000524f0: 6365 2073 6f6d 6520 6d6f 6465 6c73 2067  ce some models g
-00052500: 6976 6520 7365 7269 6573 2c20 6f74 6865  ive series, othe
-00052510: 7273 2067 6976 6520 6172 7261 7973 2e20  rs give arrays. 
-00052520: 5665 7279 2070 6169 6e66 756c 210d 0a20  Very painful!.. 
-00052530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052540: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00052550: 2865 6e73 656d 5f70 7265 642c 7064 2e53  (ensem_pred,pd.S
-00052560: 6572 6965 7329 3a0d 0a20 2020 2020 2020  eries):..       
-00052570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052580: 2065 6e73 656d 5f70 7265 6420 3d20 656e   ensem_pred = en
-00052590: 7365 6d5f 7072 6564 2e76 616c 7565 730d  sem_pred.values.
-000525a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000525b0: 2020 2020 2074 6573 746d 5b6e 6577 5f63       testm[new_c
-000525c0: 6f6c 5d20 3d20 656e 7365 6d5f 7072 6564  ol] = ensem_pred
-000525d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000525e0: 2020 2020 2020 6e65 775f 636f 6c73 2e61        new_cols.a
-000525f0: 7070 656e 6428 6e65 775f 636f 6c29 0d0a  ppend(new_col)..
-00052600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052610: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00052620: 6528 7361 6d70 6c65 5f73 7562 6d69 7373  e(sample_submiss
-00052630: 696f 6e2c 2073 7472 293a 0d0a 2020 2020  ion, str):..    
-00052640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052650: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-00052660: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00052670: 206d 6f64 656c 5f6c 6162 656c 203d 3d20   model_label == 
-00052680: 2753 696e 676c 655f 4c61 6265 6c27 3a0d  'Single_Label':.
-00052690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000526a0: 2020 2020 2020 2020 2020 2020 2073 616d               sam
-000526b0: 706c 655f 7375 626d 6973 7369 6f6e 5b65  ple_submission[e
-000526c0: 6163 685f 7461 7267 6574 5d20 3d20 795f  ach_target] = y_
-000526d0: 7072 6564 0d0a 2020 2020 2020 2020 2020  pred..          
-000526e0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-000526f0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00052700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052710: 2073 616d 706c 655f 7375 626d 6973 7369   sample_submissi
-00052720: 6f6e 5b65 6163 685f 7461 7267 6574 5d20  on[each_target] 
-00052730: 3d20 795f 7072 6564 5b3a 2c69 5d0d 0a20  = y_pred[:,i].. 
-00052740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052750: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
-00052760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052770: 2020 2020 7072 696e 7428 2745 7272 6f72      print('Error
-00052780: 3a20 5361 6d70 6c65 2073 7562 6d69 7373  : Sample submiss
-00052790: 696f 6e20 6669 6c65 2069 7320 696e 636f  ion file is inco
-000527a0: 7272 6563 742e 2050 6c65 6173 6520 6368  rrect. Please ch
-000527b0: 6563 6b20 6974 2e20 636f 6e74 696e 7569  eck it. continui
-000527c0: 6e67 2e2e 2e27 290d 0a20 2020 2020 2020  ng...')..       
-000527d0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-000527e0: 2020 2020 2020 2020 2020 2020 2323 2323              ####
-000527f0: 2323 2323 2320 2020 2054 2052 2041 204e  #####    T R A N
-00052800: 2053 2046 204f 2052 204d 2045 2052 2020   S F O R M E R  
-00052810: 204c 204f 2047 2049 2043 2020 4220 4520   L O G I C  B E 
-00052820: 4720 4920 4e20 5320 2020 2048 2045 2052  G I N S    H E R
-00052830: 2045 2021 2023 2323 2323 2323 2323 2323   E ! ###########
-00052840: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-00052850: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-00052860: 6966 2074 6865 7265 2069 7320 6120 7472  if there is a tr
-00052870: 616e 7366 6f72 6d65 722c 2074 6865 6e20  ansformer, then 
-00052880: 796f 7520 6d75 7374 2063 6f6e 7665 7274  you must convert
-00052890: 2074 6865 2070 7265 6469 6374 6564 2063   the predicted c
-000528a0: 6c61 7373 6573 2074 6f20 6f72 6967 2063  lasses to orig c
-000528b0: 6c61 7373 6573 0d0a 2020 2020 2020 2020  lasses..        
-000528c0: 2020 2020 2020 2020 636c 6173 7365 7320          classes 
-000528d0: 3d20 6c61 6265 6c5f 6469 6374 5b65 6163  = label_dict[eac
-000528e0: 685f 7461 7267 6574 5d5b 2763 6c61 7373  h_target]['class
-000528f0: 6573 275d 0d0a 2020 2020 2020 2020 2020  es']..          
-00052900: 2020 2020 2020 6469 6320 3d20 6c61 6265        dic = labe
-00052910: 6c5f 6469 6374 5b65 6163 685f 7461 7267  l_dict[each_targ
-00052920: 6574 5d5b 2764 6963 7469 6f6e 6172 7927  et]['dictionary'
-00052930: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00052940: 2020 2074 7261 6e73 666f 726d 6572 203d     transformer =
-00052950: 206c 6162 656c 5f64 6963 745b 6561 6368   label_dict[each
-00052960: 5f74 6172 6765 745d 5b27 7472 616e 7366  _target]['transf
-00052970: 6f72 6d65 7227 5d0d 0a20 2020 2020 2020  ormer']..       
-00052980: 2020 2020 2020 2020 2063 6c61 7373 5f6e           class_n
-00052990: 756d 7320 3d20 6c61 6265 6c5f 6469 6374  ums = label_dict
-000529a0: 5b65 6163 685f 7461 7267 6574 5d5b 2763  [each_target]['c
-000529b0: 6c61 7373 5f6e 756d 7327 5d0d 0a20 2020  lass_nums']..   
-000529c0: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-000529d0: 2323 2049 6620 7468 6572 6520 6973 2061  ## If there is a
-000529e0: 2074 7261 6e73 666f 726d 6572 2c20 796f   transformer, yo
-000529f0: 7520 6d75 7374 2063 6f6e 7665 7274 2070  u must convert p
-00052a00: 7265 6469 6374 696f 6e73 2074 6f20 6f72  redictions to or
-00052a10: 6967 696e 616c 2063 6c61 7373 6573 0d0a  iginal classes..
-00052a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052a30: 2323 2320 496e 2073 6f6d 6520 6361 7365  ### In some case
-00052a40: 7320 7375 6368 2061 7320 4361 7442 6f6f  s such as CatBoo
-00052a50: 7374 2c20 7468 6520 6f75 7470 7574 2066  st, the output f
-00052a60: 6f72 206d 756c 7469 2d63 6c61 7373 2069  or multi-class i
-00052a70: 7320 322d 4420 7769 7468 2073 6861 7065  s 2-D with shape
-00052a80: 2028 2c31 290d 0a20 2020 2020 2020 2020   (,1)..         
-00052a90: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-00052aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052ab0: 2061 7373 6572 7420 795f 7072 6564 2e73   assert y_pred.s
-00052ac0: 6861 7065 5b31 5d0d 0a20 2020 2020 2020  hape[1]..       
-00052ad0: 2020 2020 2020 2020 2020 2020 2079 5f70               y_p
-00052ae0: 7265 6420 3d20 795f 7072 6564 2e72 6176  red = y_pred.rav
-00052af0: 656c 2829 0d0a 2020 2020 2020 2020 2020  el()..          
-00052b00: 2020 2020 2020 6578 6365 7074 3a0d 0a20        except:.. 
-00052b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052b20: 2020 2070 6173 730d 0a20 2020 2020 2020     pass..       
-00052b30: 2020 2020 2020 2020 2023 2323 2323 2320           ###### 
-00052b40: 4f6e 6365 2079 6f75 2067 6574 2074 6865  Once you get the
-00052b50: 2061 626f 7665 2072 6967 6874 2c20 796f   above right, yo
-00052b60: 7520 6361 6e20 646f 2074 6865 2072 6573  u can do the res
-00052b70: 7420 6561 7379 2023 2323 2323 230d 0a20  t easy ######.. 
-00052b80: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00052b90: 6573 746d 5b65 6163 685f 7461 7267 6574  estm[each_target
-00052ba0: 2b27 5f70 7265 6469 6374 696f 6e73 275d  +'_predictions']
-00052bb0: 203d 2070 642e 5365 7269 6573 2879 5f70   = pd.Series(y_p
-00052bc0: 7265 6429 2e6d 6170 2874 7261 6e73 666f  red).map(transfo
-00052bd0: 726d 6572 292e 7661 6c75 6573 0d0a 2020  rmer).values..  
-00052be0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00052bf0: 7220 6561 6368 5f63 6c61 7373 2069 6e20  r each_class in 
-00052c00: 636c 6173 7365 733a 0d0a 2020 2020 2020  classes:..      
-00052c10: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00052c20: 2069 7369 6e73 7461 6e63 6528 6561 6368   isinstance(each
-00052c30: 5f63 6c61 7373 2c20 7374 7229 3a0d 0a20  _class, str):.. 
+000523a0: 2020 206d 6f64 656c 7479 7065 2c20 426f     modeltype, Bo
+000523b0: 6f73 7469 6e67 5f46 6c61 672c 7363 6f72  osting_Flag,scor
+000523c0: 696e 675f 7061 7261 6d65 7465 722c 7665  ing_parameter,ve
+000523d0: 7262 6f73 6529 0d0a 2020 2020 2020 2020  rbose)..        
+000523e0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+000523f0: 636f 6c20 3d20 6561 6368 5f74 6172 6765  col = each_targe
+00052400: 742b 275f 5374 6163 6b65 645f 272b 7374  t+'_Stacked_'+st
+00052410: 6163 6b5f 636f 6c73 5b30 5d2e 7370 6c69  ack_cols[0].spli
+00052420: 7428 225f 2229 5b30 5d2b 275f 7072 6564  t("_")[0]+'_pred
+00052430: 6963 7469 6f6e 7327 0d0a 2020 2020 2020  ictions'..      
+00052440: 2020 2020 2020 2020 2020 2020 2020 656e                en
+00052450: 7365 6d5f 7072 6564 203d 206e 702e 6172  sem_pred = np.ar
+00052460: 676d 6178 2873 7461 636b 7366 696e 616c  gmax(stacksfinal
+00052470: 2c61 7869 733d 3129 0d0a 2020 2020 2020  ,axis=1)..      
+00052480: 2020 2020 2020 2020 2020 6966 206d 6f64            if mod
+00052490: 656c 5f6c 6162 656c 203d 3d20 2753 696e  el_label == 'Sin
+000524a0: 676c 655f 4c61 6265 6c27 3a0d 0a20 2020  gle_Label':..   
+000524b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000524c0: 2023 2323 2323 2054 6869 7320 6e65 7874   ##### This next
+000524d0: 2073 7465 7020 6973 2076 6572 7920 696d   step is very im
+000524e0: 706f 7274 616e 7420 7369 6e63 6520 736f  portant since so
+000524f0: 6d65 206d 6f64 656c 7320 6769 7665 2073  me models give s
+00052500: 6572 6965 732c 206f 7468 6572 7320 6769  eries, others gi
+00052510: 7665 2061 7272 6179 732e 2056 6572 7920  ve arrays. Very 
+00052520: 7061 696e 6675 6c21 0d0a 2020 2020 2020  painful!..      
+00052530: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00052540: 2069 7369 6e73 7461 6e63 6528 656e 7365   isinstance(ense
+00052550: 6d5f 7072 6564 2c70 642e 5365 7269 6573  m_pred,pd.Series
+00052560: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00052570: 2020 2020 2020 2020 2020 2020 656e 7365              ense
+00052580: 6d5f 7072 6564 203d 2065 6e73 656d 5f70  m_pred = ensem_p
+00052590: 7265 642e 7661 6c75 6573 0d0a 2020 2020  red.values..    
+000525a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000525b0: 7465 7374 6d5b 6e65 775f 636f 6c5d 203d  testm[new_col] =
+000525c0: 2065 6e73 656d 5f70 7265 640d 0a20 2020   ensem_pred..   
+000525d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000525e0: 206e 6577 5f63 6f6c 732e 6170 7065 6e64   new_cols.append
+000525f0: 286e 6577 5f63 6f6c 290d 0a20 2020 2020  (new_col)..     
+00052600: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00052610: 7420 6973 696e 7374 616e 6365 2873 616d  t isinstance(sam
+00052620: 706c 655f 7375 626d 6973 7369 6f6e 2c20  ple_submission, 
+00052630: 7374 7229 3a0d 0a20 2020 2020 2020 2020  str):..         
+00052640: 2020 2020 2020 2020 2020 2074 7279 3a0d             try:.
+00052650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00052660: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
+00052670: 6c5f 6c61 6265 6c20 3d3d 2027 5369 6e67  l_label == 'Sing
+00052680: 6c65 5f4c 6162 656c 273a 0d0a 2020 2020  le_Label':..    
+00052690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000526a0: 2020 2020 2020 2020 7361 6d70 6c65 5f73          sample_s
+000526b0: 7562 6d69 7373 696f 6e5b 6561 6368 5f74  ubmission[each_t
+000526c0: 6172 6765 745d 203d 2079 5f70 7265 640d  arget] = y_pred.
+000526d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000526e0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+000526f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052700: 2020 2020 2020 2020 2020 2020 7361 6d70              samp
+00052710: 6c65 5f73 7562 6d69 7373 696f 6e5b 6561  le_submission[ea
+00052720: 6368 5f74 6172 6765 745d 203d 2079 5f70  ch_target] = y_p
+00052730: 7265 645b 3a2c 695d 0d0a 2020 2020 2020  red[:,i]..      
+00052740: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00052750: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
+00052760: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00052770: 7269 6e74 2827 4572 726f 723a 2053 616d  rint('Error: Sam
+00052780: 706c 6520 7375 626d 6973 7369 6f6e 2066  ple submission f
+00052790: 696c 6520 6973 2069 6e63 6f72 7265 6374  ile is incorrect
+000527a0: 2e20 506c 6561 7365 2063 6865 636b 2069  . Please check i
+000527b0: 742e 2063 6f6e 7469 6e75 696e 672e 2e2e  t. continuing...
+000527c0: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+000527d0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+000527e0: 2020 2020 2020 2023 2323 2323 2323 2323         #########
+000527f0: 2020 2020 5420 5220 4120 4e20 5320 4620      T R A N S F 
+00052800: 4f20 5220 4d20 4520 5220 2020 4c20 4f20  O R M E R   L O 
+00052810: 4720 4920 4320 2042 2045 2047 2049 204e  G I C  B E G I N
+00052820: 2053 2020 2020 4820 4520 5220 4520 2120   S    H E R E ! 
+00052830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00052840: 2323 2323 230d 0a20 2020 2020 2020 2020  #####..         
+00052850: 2020 2020 2020 2023 2323 2069 6620 7468         ### if th
+00052860: 6572 6520 6973 2061 2074 7261 6e73 666f  ere is a transfo
+00052870: 726d 6572 2c20 7468 656e 2079 6f75 206d  rmer, then you m
+00052880: 7573 7420 636f 6e76 6572 7420 7468 6520  ust convert the 
+00052890: 7072 6564 6963 7465 6420 636c 6173 7365  predicted classe
+000528a0: 7320 746f 206f 7269 6720 636c 6173 7365  s to orig classe
+000528b0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+000528c0: 2020 2063 6c61 7373 6573 203d 206c 6162     classes = lab
+000528d0: 656c 5f64 6963 745b 6561 6368 5f74 6172  el_dict[each_tar
+000528e0: 6765 745d 5b27 636c 6173 7365 7327 5d0d  get]['classes'].
+000528f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00052900: 2064 6963 203d 206c 6162 656c 5f64 6963   dic = label_dic
+00052910: 745b 6561 6368 5f74 6172 6765 745d 5b27  t[each_target]['
+00052920: 6469 6374 696f 6e61 7279 275d 0d0a 2020  dictionary']..  
+00052930: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+00052940: 616e 7366 6f72 6d65 7220 3d20 6c61 6265  ansformer = labe
+00052950: 6c5f 6469 6374 5b65 6163 685f 7461 7267  l_dict[each_targ
+00052960: 6574 5d5b 2774 7261 6e73 666f 726d 6572  et]['transformer
+00052970: 275d 0d0a 2020 2020 2020 2020 2020 2020  ']..            
+00052980: 2020 2020 636c 6173 735f 6e75 6d73 203d      class_nums =
+00052990: 206c 6162 656c 5f64 6963 745b 6561 6368   label_dict[each
+000529a0: 5f74 6172 6765 745d 5b27 636c 6173 735f  _target]['class_
+000529b0: 6e75 6d73 275d 0d0a 2020 2020 2020 2020  nums']..        
+000529c0: 2020 2020 2020 2020 2323 2323 2320 4966          ##### If
+000529d0: 2074 6865 7265 2069 7320 6120 7472 616e   there is a tran
+000529e0: 7366 6f72 6d65 722c 2079 6f75 206d 7573  sformer, you mus
+000529f0: 7420 636f 6e76 6572 7420 7072 6564 6963  t convert predic
+00052a00: 7469 6f6e 7320 746f 206f 7269 6769 6e61  tions to origina
+00052a10: 6c20 636c 6173 7365 730d 0a20 2020 2020  l classes..     
+00052a20: 2020 2020 2020 2020 2020 2023 2323 2049             ### I
+00052a30: 6e20 736f 6d65 2063 6173 6573 2073 7563  n some cases suc
+00052a40: 6820 6173 2043 6174 426f 6f73 742c 2074  h as CatBoost, t
+00052a50: 6865 206f 7574 7075 7420 666f 7220 6d75  he output for mu
+00052a60: 6c74 692d 636c 6173 7320 6973 2032 2d44  lti-class is 2-D
+00052a70: 2077 6974 6820 7368 6170 6520 282c 3129   with shape (,1)
+00052a80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00052a90: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
+00052aa0: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+00052ab0: 7274 2079 5f70 7265 642e 7368 6170 655b  rt y_pred.shape[
+00052ac0: 315d 0d0a 2020 2020 2020 2020 2020 2020  1]..            
+00052ad0: 2020 2020 2020 2020 795f 7072 6564 203d          y_pred =
+00052ae0: 2079 5f70 7265 642e 7261 7665 6c28 290d   y_pred.ravel().
+00052af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00052b00: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
+00052b10: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00052b20: 7373 0d0a 2020 2020 2020 2020 2020 2020  ss..            
+00052b30: 2020 2020 2323 2323 2323 204f 6e63 6520      ###### Once 
+00052b40: 796f 7520 6765 7420 7468 6520 6162 6f76  you get the abov
+00052b50: 6520 7269 6768 742c 2079 6f75 2063 616e  e right, you can
+00052b60: 2064 6f20 7468 6520 7265 7374 2065 6173   do the rest eas
+00052b70: 7920 2323 2323 2323 0d0a 2020 2020 2020  y ######..      
+00052b80: 2020 2020 2020 2020 2020 7465 7374 6d5b            testm[
+00052b90: 6561 6368 5f74 6172 6765 742b 275f 7072  each_target+'_pr
+00052ba0: 6564 6963 7469 6f6e 7327 5d20 3d20 7064  edictions'] = pd
+00052bb0: 2e53 6572 6965 7328 795f 7072 6564 292e  .Series(y_pred).
+00052bc0: 6d61 7028 7472 616e 7366 6f72 6d65 7229  map(transformer)
+00052bd0: 2e76 616c 7565 730d 0a20 2020 2020 2020  .values..       
+00052be0: 2020 2020 2020 2020 2066 6f72 2065 6163           for eac
+00052bf0: 685f 636c 6173 7320 696e 2063 6c61 7373  h_class in class
+00052c00: 6573 3a0d 0a20 2020 2020 2020 2020 2020  es:..           
+00052c10: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+00052c20: 7374 616e 6365 2865 6163 685f 636c 6173  stance(each_clas
+00052c30: 732c 2073 7472 293a 0d0a 2020 2020 2020  s, str):..      
 00052c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052c50: 2020 2020 2020 2070 726f 6261 5f63 6f6c         proba_col
-00052c60: 203d 2065 6163 685f 7461 7267 6574 2b27   = each_target+'
-00052c70: 5f70 726f 6261 5f27 2b65 6163 685f 636c  _proba_'+each_cl
-00052c80: 6173 730d 0a20 2020 2020 2020 2020 2020  ass..           
-00052c90: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00052c50: 2020 7072 6f62 615f 636f 6c20 3d20 6561    proba_col = ea
+00052c60: 6368 5f74 6172 6765 742b 275f 7072 6f62  ch_target+'_prob
+00052c70: 615f 272b 6561 6368 5f63 6c61 7373 0d0a  a_'+each_class..
+00052c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052c90: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
 00052ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052cb0: 2020 2020 2020 2020 7072 6f62 615f 636f          proba_co
-00052cc0: 6c20 3d20 6561 6368 5f74 6172 6765 742b  l = each_target+
-00052cd0: 275f 7072 6f62 615f 272b 7374 7228 6561  '_proba_'+str(ea
-00052ce0: 6368 5f63 6c61 7373 290d 0a20 2020 2020  ch_class)..     
-00052cf0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00052d00: 6f75 6e74 203d 206c 6162 656c 5f64 6963  ount = label_dic
-00052d10: 745b 6561 6368 5f74 6172 6765 745d 5b27  t[each_target]['
-00052d20: 6469 6374 696f 6e61 7279 275d 5b65 6163  dictionary'][eac
-00052d30: 685f 636c 6173 735d 0d0a 2020 2020 2020  h_class]..      
-00052d40: 2020 2020 2020 2020 2020 2020 2020 7465                te
-00052d50: 7374 6d5b 7072 6f62 615f 636f 6c5d 203d  stm[proba_col] =
-00052d60: 2079 5f70 726f 6261 5b3a 2c63 6f75 6e74   y_proba[:,count
-00052d70: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00052d80: 2020 2020 2020 2070 726f 6261 5f63 6f6c         proba_col
-00052d90: 732e 6170 7065 6e64 2870 726f 6261 5f63  s.append(proba_c
-00052da0: 6f6c 290d 0a20 2020 2020 2020 2020 2020  ol)..           
-00052db0: 2020 2020 2023 2323 2323 2320 2049 6620       ######  If 
-00052dc0: 5374 6163 6b69 6e67 5f20 466c 6167 2069  Stacking_ Flag i
-00052dd0: 7320 4661 6c73 652c 2074 6865 6e20 7765  s False, then we
-00052de0: 2064 6f20 456e 7365 6d62 6c69 6e67 2023   do Ensembling #
-00052df0: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
-00052e00: 2020 2020 2020 2020 6966 206e 6f74 2053          if not S
-00052e10: 7461 636b 696e 675f 466c 6167 3a0d 0a20  tacking_Flag:.. 
-00052e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052e30: 2020 2073 7562 6d20 3d20 7064 2e44 6174     subm = pd.Dat
-00052e40: 6146 7261 6d65 2829 0d0a 2020 2020 2020  aFrame()..      
-00052e50: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-00052e60: 2323 2054 6869 7320 6973 2066 6f72 2045  ## This is for E
-00052e70: 6e73 656d 626c 696e 6720 204f 6e6c 7920  nsembling  Only 
-00052e80: 2323 2323 230d 0a20 2020 2020 2020 2020  #####..         
-00052e90: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-00052ea0: 6e28 636c 6173 7365 7329 203d 3d20 323a  n(classes) == 2:
-00052eb0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00052ec0: 2020 2020 2020 2020 2020 6d6f 6465 6c73            models
-00052ed0: 5f6c 6973 742c 2065 6e73 656d 626c 6573  _list, ensembles
-00052ee0: 203d 2051 7569 636b 4d4c 5f45 6e73 656d   = QuickML_Ensem
-00052ef0: 626c 696e 6728 582c 2079 2c20 585f 7465  bling(X, y, X_te
-00052f00: 7374 2c20 2727 2c0d 0a20 2020 2020 2020  st, '',..       
+00052cb0: 2020 2070 726f 6261 5f63 6f6c 203d 2065     proba_col = e
+00052cc0: 6163 685f 7461 7267 6574 2b27 5f70 726f  ach_target+'_pro
+00052cd0: 6261 5f27 2b73 7472 2865 6163 685f 636c  ba_'+str(each_cl
+00052ce0: 6173 7329 0d0a 2020 2020 2020 2020 2020  ass)..          
+00052cf0: 2020 2020 2020 2020 2020 636f 756e 7420            count 
+00052d00: 3d20 6c61 6265 6c5f 6469 6374 5b65 6163  = label_dict[eac
+00052d10: 685f 7461 7267 6574 5d5b 2764 6963 7469  h_target]['dicti
+00052d20: 6f6e 6172 7927 5d5b 6561 6368 5f63 6c61  onary'][each_cla
+00052d30: 7373 5d0d 0a20 2020 2020 2020 2020 2020  ss]..           
+00052d40: 2020 2020 2020 2020 2074 6573 746d 5b70           testm[p
+00052d50: 726f 6261 5f63 6f6c 5d20 3d20 795f 7072  roba_col] = y_pr
+00052d60: 6f62 615b 3a2c 636f 756e 745d 0d0a 2020  oba[:,count]..  
+00052d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052d80: 2020 7072 6f62 615f 636f 6c73 2e61 7070    proba_cols.app
+00052d90: 656e 6428 7072 6f62 615f 636f 6c29 0d0a  end(proba_col)..
+00052da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052db0: 2323 2323 2323 2020 4966 2053 7461 636b  ######  If Stack
+00052dc0: 696e 675f 2046 6c61 6720 6973 2046 616c  ing_ Flag is Fal
+00052dd0: 7365 2c20 7468 656e 2077 6520 646f 2045  se, then we do E
+00052de0: 6e73 656d 626c 696e 6720 2323 2323 2323  nsembling ######
+00052df0: 230d 0a20 2020 2020 2020 2020 2020 2020  #..             
+00052e00: 2020 2069 6620 6e6f 7420 5374 6163 6b69     if not Stacki
+00052e10: 6e67 5f46 6c61 673a 0d0a 2020 2020 2020  ng_Flag:..      
+00052e20: 2020 2020 2020 2020 2020 2020 2020 7375                su
+00052e30: 626d 203d 2070 642e 4461 7461 4672 616d  bm = pd.DataFram
+00052e40: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
+00052e50: 2020 2020 2020 2020 2023 2323 2320 5468           #### Th
+00052e60: 6973 2069 7320 666f 7220 456e 7365 6d62  is is for Ensemb
+00052e70: 6c69 6e67 2020 4f6e 6c79 2023 2323 2323  ling  Only #####
+00052e80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00052e90: 2020 2020 2020 6966 206c 656e 2863 6c61        if len(cla
+00052ea0: 7373 6573 2920 3d3d 2032 3a0d 0a20 2020  sses) == 2:..   
+00052eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052ec0: 2020 2020 206d 6f64 656c 735f 6c69 7374       models_list
+00052ed0: 2c20 656e 7365 6d62 6c65 7320 3d20 5175  , ensembles = Qu
+00052ee0: 6963 6b4d 4c5f 456e 7365 6d62 6c69 6e67  ickML_Ensembling
+00052ef0: 2858 2c20 792c 2058 5f74 6573 742c 2027  (X, y, X_test, '
+00052f00: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
 00052f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00052f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052f30: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-00052f40: 7479 7065 3d27 4269 6e61 7279 5f43 6c61  type='Binary_Cla
-00052f50: 7373 6966 6963 6174 696f 6e27 2c20 426f  ssification', Bo
-00052f60: 6f73 7469 6e67 5f46 6c61 673d 426f 6f73  osting_Flag=Boos
-00052f70: 7469 6e67 5f46 6c61 672c 0d0a 2020 2020  ting_Flag,..    
+00052f30: 2020 2020 2020 6d6f 6465 6c74 7970 653d        modeltype=
+00052f40: 2742 696e 6172 795f 436c 6173 7369 6669  'Binary_Classifi
+00052f50: 6361 7469 6f6e 272c 2042 6f6f 7374 696e  cation', Boostin
+00052f60: 675f 466c 6167 3d42 6f6f 7374 696e 675f  g_Flag=Boosting_
+00052f70: 466c 6167 2c0d 0a20 2020 2020 2020 2020  Flag,..         
 00052f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00052f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052fa0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00052fb0: 636f 7269 6e67 3d27 272c 2076 6572 626f  coring='', verbo
-00052fc0: 7365 3d76 6572 626f 7365 290d 0a20 2020  se=verbose)..   
-00052fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00052fe0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00052ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053000: 6d6f 6465 6c73 5f6c 6973 742c 2065 6e73  models_list, ens
-00053010: 656d 626c 6573 203d 2051 7569 636b 4d4c  embles = QuickML
-00053020: 5f45 6e73 656d 626c 696e 6728 582c 2079  _Ensembling(X, y
-00053030: 2c20 585f 7465 7374 2c20 2727 2c0d 0a20  , X_test, '',.. 
+00052fa0: 2020 2020 2020 2020 2020 7363 6f72 696e            scorin
+00052fb0: 673d 2727 2c20 7665 7262 6f73 653d 7665  g='', verbose=ve
+00052fc0: 7262 6f73 6529 0d0a 2020 2020 2020 2020  rbose)..        
+00052fd0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00052fe0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00052ff0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+00053000: 735f 6c69 7374 2c20 656e 7365 6d62 6c65  s_list, ensemble
+00053010: 7320 3d20 5175 6963 6b4d 4c5f 456e 7365  s = QuickML_Ense
+00053020: 6d62 6c69 6e67 2858 2c20 792c 2058 5f74  mbling(X, y, X_t
+00053030: 6573 742c 2027 272c 0d0a 2020 2020 2020  est, '',..      
 00053040: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00053050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053070: 206d 6f64 656c 7479 7065 3d27 4d75 6c74   modeltype='Mult
-00053080: 695f 436c 6173 7369 6669 6361 7469 6f6e  i_Classification
-00053090: 272c 2042 6f6f 7374 696e 675f 466c 6167  ', Boosting_Flag
-000530a0: 3d42 6f6f 7374 696e 675f 466c 6167 2c0d  =Boosting_Flag,.
-000530b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00053060: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
+00053070: 6c74 7970 653d 274d 756c 7469 5f43 6c61  ltype='Multi_Cla
+00053080: 7373 6966 6963 6174 696f 6e27 2c20 426f  ssification', Bo
+00053090: 6f73 7469 6e67 5f46 6c61 673d 426f 6f73  osting_Flag=Boos
+000530a0: 7469 6e67 5f46 6c61 672c 0d0a 2020 2020  ting_Flag,..    
+000530b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000530c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000530d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000530e0: 2020 2020 7363 6f72 696e 673d 2727 2c20      scoring='', 
-000530f0: 7665 7262 6f73 653d 7665 7262 6f73 6529  verbose=verbose)
-00053100: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00053110: 2020 2020 2020 6d6f 6465 6c73 5f6c 6973        models_lis
-00053120: 742e 6170 7065 6e64 286d 6f64 656c 5f6e  t.append(model_n
-00053130: 616d 6529 0d0a 2020 2020 2020 2020 2020  ame)..          
-00053140: 2020 2020 2020 2020 2020 666f 7220 6d6f            for mo
-00053150: 6465 6c73 2c20 6561 6368 2069 6e20 7a69  dels, each in zi
-00053160: 7028 6d6f 6465 6c73 5f6c 6973 742c 2072  p(models_list, r
-00053170: 616e 6765 286c 656e 286d 6f64 656c 735f  ange(len(models_
-00053180: 6c69 7374 2929 293a 0d0a 2020 2020 2020  list))):..      
-00053190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000531a0: 2020 6e65 775f 636f 6c20 3d20 6561 6368    new_col = each
-000531b0: 5f74 6172 6765 742b 275f 272b 6d6f 6465  _target+'_'+mode
-000531c0: 6c73 2b27 5f70 7265 6469 6374 696f 6e73  ls+'_predictions
-000531d0: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-000531e0: 2020 2020 2020 2020 2020 2069 6620 6561             if ea
-000531f0: 6368 2b31 203d 3d20 6c65 6e28 6d6f 6465  ch+1 == len(mode
-00053200: 6c73 5f6c 6973 7429 3a0d 0a20 2020 2020  ls_list):..     
+000530d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000530e0: 636f 7269 6e67 3d27 272c 2076 6572 626f  coring='', verbo
+000530f0: 7365 3d76 6572 626f 7365 290d 0a20 2020  se=verbose)..   
+00053100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053110: 206d 6f64 656c 735f 6c69 7374 2e61 7070   models_list.app
+00053120: 656e 6428 6d6f 6465 6c5f 6e61 6d65 290d  end(model_name).
+00053130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00053140: 2020 2020 2066 6f72 206d 6f64 656c 732c       for models,
+00053150: 2065 6163 6820 696e 207a 6970 286d 6f64   each in zip(mod
+00053160: 656c 735f 6c69 7374 2c20 7261 6e67 6528  els_list, range(
+00053170: 6c65 6e28 6d6f 6465 6c73 5f6c 6973 7429  len(models_list)
+00053180: 2929 3a0d 0a20 2020 2020 2020 2020 2020  )):..           
+00053190: 2020 2020 2020 2020 2020 2020 206e 6577               new
+000531a0: 5f63 6f6c 203d 2065 6163 685f 7461 7267  _col = each_targ
+000531b0: 6574 2b27 5f27 2b6d 6f64 656c 732b 275f  et+'_'+models+'_
+000531c0: 7072 6564 6963 7469 6f6e 7327 0d0a 2020  predictions'..  
+000531d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000531e0: 2020 2020 2020 6966 2065 6163 682b 3120        if each+1 
+000531f0: 3d3d 206c 656e 286d 6f64 656c 735f 6c69  == len(models_li
+00053200: 7374 293a 0d0a 2020 2020 2020 2020 2020  st):..          
 00053210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053220: 2020 2020 2020 2073 7562 6d5b 6e65 775f         subm[new_
-00053230: 636f 6c5d 203d 2079 5f70 7265 640d 0a20  col] = y_pred.. 
+00053220: 2020 7375 626d 5b6e 6577 5f63 6f6c 5d20    subm[new_col] 
+00053230: 3d20 795f 7072 6564 0d0a 2020 2020 2020  = y_pred..      
 00053240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053250: 2020 2020 2020 2020 2020 2074 6573 746d             testm
-00053260: 5b6e 6577 5f63 6f6c 5d20 3d20 7064 2e53  [new_col] = pd.S
-00053270: 6572 6965 7328 795f 7072 6564 292e 6d61  eries(y_pred).ma
-00053280: 7028 7472 616e 7366 6f72 6d65 7229 2e76  p(transformer).v
-00053290: 616c 7565 730d 0a20 2020 2020 2020 2020  alues..         
-000532a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000532b0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-000532c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000532d0: 2020 7375 626d 5b6e 6577 5f63 6f6c 5d20    subm[new_col] 
-000532e0: 3d20 656e 7365 6d62 6c65 735b 3a2c 6561  = ensembles[:,ea
-000532f0: 6368 5d0d 0a20 2020 2020 2020 2020 2020  ch]..           
-00053300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053310: 2074 6573 746d 5b6e 6577 5f63 6f6c 5d20   testm[new_col] 
-00053320: 3d20 7064 2e53 6572 6965 7328 656e 7365  = pd.Series(ense
-00053330: 6d62 6c65 735b 3a2c 6561 6368 5d29 2e6d  mbles[:,each]).m
-00053340: 6170 2874 7261 6e73 666f 726d 6572 292e  ap(transformer).
-00053350: 7661 6c75 6573 0d0a 2020 2020 2020 2020  values..        
-00053360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053370: 6e65 775f 636f 6c73 2e61 7070 656e 6428  new_cols.append(
-00053380: 6e65 775f 636f 6c29 0d0a 2020 2020 2020  new_col)..      
-00053390: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-000533a0: 2320 4166 7465 7220 7468 6973 2c20 795f  # After this, y_
-000533b0: 7072 6564 2069 7320 6120 5365 7269 6573  pred is a Series
-000533c0: 2066 726f 6d20 6e6f 7720 6f6e 2e20 596f   from now on. Yo
-000533d0: 7520 6e65 6564 2079 5f70 7265 642e 7661  u need y_pred.va
-000533e0: 6c75 6573 2020 2323 2323 0d0a 2020 2020  lues  ####..    
-000533f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053400: 6966 206c 656e 286e 6577 5f63 6f6c 7329  if len(new_cols)
-00053410: 203d 3d20 353a 0d0a 2020 2020 2020 2020   == 5:..        
-00053420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053430: 7072 696e 7428 2720 2020 2043 616c 6375  print('    Calcu
-00053440: 6c61 7469 6e67 2077 6569 6768 7465 6420  lating weighted 
-00053450: 6176 6572 6167 6520 656e 7365 6d62 6c65  average ensemble
-00053460: 206f 6620 2564 2063 6c61 7373 6966 6965   of %d classifie
-00053470: 7273 2720 256c 656e 286e 6577 5f63 6f6c  rs' %len(new_col
-00053480: 7329 290d 0a20 2020 2020 2020 2020 2020  s))..           
-00053490: 2020 2020 2020 2020 2020 2020 2065 6e73               ens
-000534a0: 656d 5f70 7265 6420 3d20 6e70 2e72 6f75  em_pred = np.rou
-000534b0: 6e64 2873 7562 6d5b 6e65 775f 636f 6c73  nd(subm[new_cols
-000534c0: 5b2d 315d 5d2a 302e 352b 302e 3132 352a  [-1]]*0.5+0.125*
-000534d0: 2873 7562 6d5b 6e65 775f 636f 6c73 5b30  (subm[new_cols[0
-000534e0: 5d5d 2b73 7562 6d5b 0d0a 2020 2020 2020  ]]+subm[..      
+00053250: 2020 2020 2020 7465 7374 6d5b 6e65 775f        testm[new_
+00053260: 636f 6c5d 203d 2070 642e 5365 7269 6573  col] = pd.Series
+00053270: 2879 5f70 7265 6429 2e6d 6170 2874 7261  (y_pred).map(tra
+00053280: 6e73 666f 726d 6572 292e 7661 6c75 6573  nsformer).values
+00053290: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000532a0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+000532b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000532c0: 2020 2020 2020 2020 2020 2020 2073 7562               sub
+000532d0: 6d5b 6e65 775f 636f 6c5d 203d 2065 6e73  m[new_col] = ens
+000532e0: 656d 626c 6573 5b3a 2c65 6163 685d 0d0a  embles[:,each]..
+000532f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053300: 2020 2020 2020 2020 2020 2020 7465 7374              test
+00053310: 6d5b 6e65 775f 636f 6c5d 203d 2070 642e  m[new_col] = pd.
+00053320: 5365 7269 6573 2865 6e73 656d 626c 6573  Series(ensembles
+00053330: 5b3a 2c65 6163 685d 292e 6d61 7028 7472  [:,each]).map(tr
+00053340: 616e 7366 6f72 6d65 7229 2e76 616c 7565  ansformer).value
+00053350: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+00053360: 2020 2020 2020 2020 2020 206e 6577 5f63             new_c
+00053370: 6f6c 732e 6170 7065 6e64 286e 6577 5f63  ols.append(new_c
+00053380: 6f6c 290d 0a20 2020 2020 2020 2020 2020  ol)..           
+00053390: 2020 2020 2020 2020 2023 2323 2041 6674           ### Aft
+000533a0: 6572 2074 6869 732c 2079 5f70 7265 6420  er this, y_pred 
+000533b0: 6973 2061 2053 6572 6965 7320 6672 6f6d  is a Series from
+000533c0: 206e 6f77 206f 6e2e 2059 6f75 206e 6565   now on. You nee
+000533d0: 6420 795f 7072 6564 2e76 616c 7565 7320  d y_pred.values 
+000533e0: 2023 2323 230d 0a20 2020 2020 2020 2020   ####..         
+000533f0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00053400: 6e28 6e65 775f 636f 6c73 2920 3d3d 2035  n(new_cols) == 5
+00053410: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00053420: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00053430: 2827 2020 2020 4361 6c63 756c 6174 696e  ('    Calculatin
+00053440: 6720 7765 6967 6874 6564 2061 7665 7261  g weighted avera
+00053450: 6765 2065 6e73 656d 626c 6520 6f66 2025  ge ensemble of %
+00053460: 6420 636c 6173 7369 6669 6572 7327 2025  d classifiers' %
+00053470: 6c65 6e28 6e65 775f 636f 6c73 2929 0d0a  len(new_cols))..
+00053480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053490: 2020 2020 2020 2020 656e 7365 6d5f 7072          ensem_pr
+000534a0: 6564 203d 206e 702e 726f 756e 6428 7375  ed = np.round(su
+000534b0: 626d 5b6e 6577 5f63 6f6c 735b 2d31 5d5d  bm[new_cols[-1]]
+000534c0: 2a30 2e35 2b30 2e31 3235 2a28 7375 626d  *0.5+0.125*(subm
+000534d0: 5b6e 6577 5f63 6f6c 735b 305d 5d2b 7375  [new_cols[0]]+su
+000534e0: 626d 5b0d 0a20 2020 2020 2020 2020 2020  bm[..           
 000534f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053510: 2020 6e65 775f 636f 6c73 5b31 5d5d 2b73    new_cols[1]]+s
-00053520: 7562 6d5b 6e65 775f 636f 6c73 5b32 5d5d  ubm[new_cols[2]]
-00053530: 2b73 7562 6d5b 6e65 775f 636f 6c73 5b33  +subm[new_cols[3
-00053540: 5d5d 2929 2e61 7374 7970 6528 696e 7429  ]])).astype(int)
-00053550: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00053560: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00053500: 2020 2020 2020 2020 2020 2020 206e 6577               new
+00053510: 5f63 6f6c 735b 315d 5d2b 7375 626d 5b6e  _cols[1]]+subm[n
+00053520: 6577 5f63 6f6c 735b 325d 5d2b 7375 626d  ew_cols[2]]+subm
+00053530: 5b6e 6577 5f63 6f6c 735b 335d 5d29 292e  [new_cols[3]])).
+00053540: 6173 7479 7065 2869 6e74 290d 0a20 2020  astype(int)..   
+00053550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053560: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
 00053570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053580: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-00053590: 4361 6c63 756c 6174 696e 6720 7265 6775  Calculating regu
-000535a0: 6c61 7220 6176 6572 6167 6520 656e 7365  lar average ense
-000535b0: 6d62 6c65 206f 6620 2564 2063 6c61 7373  mble of %d class
-000535c0: 6966 6965 7273 2720 256c 656e 286e 6577  ifiers' %len(new
-000535d0: 5f63 6f6c 7329 290d 0a20 2020 2020 2020  _cols))..       
-000535e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000535f0: 2065 6e73 656d 5f70 7265 6420 3d20 2873   ensem_pred = (s
-00053600: 7562 6d5b 6e65 775f 636f 6c73 5d2e 6d65  ubm[new_cols].me
-00053610: 616e 2861 7869 733d 3129 292e 6173 7479  an(axis=1)).asty
-00053620: 7065 2869 6e74 290d 0a20 2020 2020 2020  pe(int)..       
-00053630: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-00053640: 6e74 2827 2323 2323 2323 2323 2323 2323  nt('############
+00053580: 7072 696e 7428 2720 2020 2043 616c 6375  print('    Calcu
+00053590: 6c61 7469 6e67 2072 6567 756c 6172 2061  lating regular a
+000535a0: 7665 7261 6765 2065 6e73 656d 626c 6520  verage ensemble 
+000535b0: 6f66 2025 6420 636c 6173 7369 6669 6572  of %d classifier
+000535c0: 7327 2025 6c65 6e28 6e65 775f 636f 6c73  s' %len(new_cols
+000535d0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+000535e0: 2020 2020 2020 2020 2020 2020 656e 7365              ense
+000535f0: 6d5f 7072 6564 203d 2028 7375 626d 5b6e  m_pred = (subm[n
+00053600: 6577 5f63 6f6c 735d 2e6d 6561 6e28 6178  ew_cols].mean(ax
+00053610: 6973 3d31 2929 2e61 7374 7970 6528 696e  is=1)).astype(in
+00053620: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
+00053630: 2020 2020 2020 2020 7072 696e 7428 2723          print('#
+00053640: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00053650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00053660: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00053670: 2323 2323 2323 2323 2323 2323 2729 0d0a  ############')..
-00053680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053690: 2020 2020 2323 2323 2320 5468 6973 206e      ##### This n
-000536a0: 6578 7420 7374 6570 2069 7320 7665 7279  ext step is very
-000536b0: 2069 6d70 6f72 7461 6e74 2073 696e 6365   important since
-000536c0: 2073 6f6d 6520 6d6f 6465 6c73 2067 6976   some models giv
-000536d0: 6520 7365 7269 6573 2c20 6f74 6865 7273  e series, others
-000536e0: 2067 6976 6520 6172 7261 7973 2e20 5665   give arrays. Ve
-000536f0: 7279 2070 6169 6e66 756c 210d 0a20 2020  ry painful!..   
-00053700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053710: 2069 6620 6973 696e 7374 616e 6365 2865   if isinstance(e
-00053720: 6e73 656d 5f70 7265 642c 7064 2e53 6572  nsem_pred,pd.Ser
-00053730: 6965 7329 3a0d 0a20 2020 2020 2020 2020  ies):..         
-00053740: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00053750: 6e73 656d 5f70 7265 6420 3d20 656e 7365  nsem_pred = ense
-00053760: 6d5f 7072 6564 2e76 616c 7565 730d 0a20  m_pred.values.. 
-00053770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053780: 2020 2070 7269 6e74 2827 436f 6d70 6c65     print('Comple
-00053790: 7465 6420 456e 7365 6d62 6c65 2070 7265  ted Ensemble pre
-000537a0: 6469 6374 696f 6e73 206f 6e20 6865 6c64  dictions on held
-000537b0: 206f 7574 2064 6174 6127 290d 0a20 2020   out data')..   
-000537c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000537d0: 206e 6577 5f63 6f6c 203d 2065 6163 685f   new_col = each_
-000537e0: 7461 7267 6574 2b27 5f45 6e73 656d 626c  target+'_Ensembl
-000537f0: 6564 5f70 7265 6469 6374 696f 6e73 270d  ed_predictions'.
-00053800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00053810: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00053820: 2020 2020 2020 2020 2020 2020 7374 6163              stac
-00053830: 6b5f 636f 6c73 2c20 7374 6163 6b73 6669  k_cols, stacksfi
-00053840: 6e61 6c20 3d20 5175 6963 6b4d 4c5f 5374  nal = QuickML_St
-00053850: 6163 6b69 6e67 2858 2c20 792c 2058 5f74  acking(X, y, X_t
-00053860: 6573 742c 0d0a 2020 2020 2020 2020 2020  est,..          
+00053670: 2323 2323 2323 2327 290d 0a20 2020 2020  #######')..     
+00053680: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00053690: 2323 2323 2054 6869 7320 6e65 7874 2073  #### This next s
+000536a0: 7465 7020 6973 2076 6572 7920 696d 706f  tep is very impo
+000536b0: 7274 616e 7420 7369 6e63 6520 736f 6d65  rtant since some
+000536c0: 206d 6f64 656c 7320 6769 7665 2073 6572   models give ser
+000536d0: 6965 732c 206f 7468 6572 7320 6769 7665  ies, others give
+000536e0: 2061 7272 6179 732e 2056 6572 7920 7061   arrays. Very pa
+000536f0: 696e 6675 6c21 0d0a 2020 2020 2020 2020  inful!..        
+00053700: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00053710: 7369 6e73 7461 6e63 6528 656e 7365 6d5f  sinstance(ensem_
+00053720: 7072 6564 2c70 642e 5365 7269 6573 293a  pred,pd.Series):
+00053730: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00053740: 2020 2020 2020 2020 2020 656e 7365 6d5f            ensem_
+00053750: 7072 6564 203d 2065 6e73 656d 5f70 7265  pred = ensem_pre
+00053760: 642e 7661 6c75 6573 0d0a 2020 2020 2020  d.values..      
+00053770: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00053780: 696e 7428 2743 6f6d 706c 6574 6564 2045  int('Completed E
+00053790: 6e73 656d 626c 6520 7072 6564 6963 7469  nsemble predicti
+000537a0: 6f6e 7320 6f6e 2068 656c 6420 6f75 7420  ons on held out 
+000537b0: 6461 7461 2729 0d0a 2020 2020 2020 2020  data')..        
+000537c0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+000537d0: 636f 6c20 3d20 6561 6368 5f74 6172 6765  col = each_targe
+000537e0: 742b 275f 456e 7365 6d62 6c65 645f 7072  t+'_Ensembled_pr
+000537f0: 6564 6963 7469 6f6e 7327 0d0a 2020 2020  edictions'..    
+00053800: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00053810: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00053820: 2020 2020 2020 2073 7461 636b 5f63 6f6c         stack_col
+00053830: 732c 2073 7461 636b 7366 696e 616c 203d  s, stacksfinal =
+00053840: 2051 7569 636b 4d4c 5f53 7461 636b 696e   QuickML_Stackin
+00053850: 6728 582c 2079 2c20 585f 7465 7374 2c0d  g(X, y, X_test,.
+00053860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00053870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053880: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-00053890: 656c 7479 7065 2c20 426f 6f73 7469 6e67  eltype, Boosting
-000538a0: 5f46 6c61 672c 7363 6f72 696e 675f 7061  _Flag,scoring_pa
-000538b0: 7261 6d65 7465 722c 7665 7262 6f73 6529  rameter,verbose)
-000538c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000538d0: 2020 2020 2020 6e65 775f 636f 6c20 3d20        new_col = 
-000538e0: 6561 6368 5f74 6172 6765 742b 275f 5374  each_target+'_St
-000538f0: 6163 6b65 645f 272b 7374 6163 6b5f 636f  acked_'+stack_co
-00053900: 6c73 5b30 5d2e 7370 6c69 7428 225f 2229  ls[0].split("_")
-00053910: 5b30 5d2b 275f 7072 6564 6963 7469 6f6e  [0]+'_prediction
-00053920: 7327 0d0a 2020 2020 2020 2020 2020 2020  s'..            
-00053930: 2020 2020 2020 2020 656e 7365 6d5f 7072          ensem_pr
-00053940: 6564 203d 206e 702e 6172 676d 6178 2873  ed = np.argmax(s
-00053950: 7461 636b 7366 696e 616c 2c61 7869 733d  tacksfinal,axis=
-00053960: 3129 0d0a 2020 2020 2020 2020 2020 2020  1)..            
-00053970: 2020 2020 2020 2020 7072 696e 7428 2723          print('#
+00053880: 2020 2020 2020 2020 6d6f 6465 6c74 7970          modeltyp
+00053890: 652c 2042 6f6f 7374 696e 675f 466c 6167  e, Boosting_Flag
+000538a0: 2c73 636f 7269 6e67 5f70 6172 616d 6574  ,scoring_paramet
+000538b0: 6572 2c76 6572 626f 7365 290d 0a20 2020  er,verbose)..   
+000538c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000538d0: 206e 6577 5f63 6f6c 203d 2065 6163 685f   new_col = each_
+000538e0: 7461 7267 6574 2b27 5f53 7461 636b 6564  target+'_Stacked
+000538f0: 5f27 2b73 7461 636b 5f63 6f6c 735b 305d  _'+stack_cols[0]
+00053900: 2e73 706c 6974 2822 5f22 295b 305d 2b27  .split("_")[0]+'
+00053910: 5f70 7265 6469 6374 696f 6e73 270d 0a20  _predictions'.. 
+00053920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053930: 2020 2065 6e73 656d 5f70 7265 6420 3d20     ensem_pred = 
+00053940: 6e70 2e61 7267 6d61 7828 7374 6163 6b73  np.argmax(stacks
+00053950: 6669 6e61 6c2c 6178 6973 3d31 290d 0a20  final,axis=1).. 
+00053960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053970: 2020 2070 7269 6e74 2827 2323 2323 2323     print('######
 00053980: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00053990: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000539a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000539b0: 2323 2323 2323 2327 290d 0a20 2020 2020  #######')..     
-000539c0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000539d0: 7269 6e74 2827 436f 6d70 6c65 7465 6420  rint('Completed 
-000539e0: 5374 6163 6b65 6420 7072 6564 6963 7469  Stacked predicti
-000539f0: 6f6e 7320 6f6e 2068 656c 6420 6f75 7420  ons on held out 
-00053a00: 6461 7461 2729 0d0a 2020 2020 2020 2020  data')..        
-00053a10: 2020 2020 2020 2020 7465 7374 6d5b 6e65          testm[ne
-00053a20: 775f 636f 6c5d 203d 2070 642e 5365 7269  w_col] = pd.Seri
-00053a30: 6573 2865 6e73 656d 5f70 7265 6429 2e6d  es(ensem_pred).m
-00053a40: 6170 2874 7261 6e73 666f 726d 6572 292e  ap(transformer).
-00053a50: 7661 6c75 6573 0d0a 2020 2020 2020 2020  values..        
-00053a60: 2020 2020 2020 2020 6e65 775f 636f 6c73          new_cols
-00053a70: 2e61 7070 656e 6428 6e65 775f 636f 6c29  .append(new_col)
-00053a80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00053a90: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-00053aa0: 6e63 6528 7361 6d70 6c65 5f73 7562 6d69  nce(sample_submi
-00053ab0: 7373 696f 6e2c 2073 7472 293a 0d0a 2020  ssion, str):..  
-00053ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053ad0: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
-00053ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053af0: 7361 6d70 6c65 5f73 7562 6d69 7373 696f  sample_submissio
-00053b00: 6e5b 6561 6368 5f74 6172 6765 745d 203d  n[each_target] =
-00053b10: 2070 642e 5365 7269 6573 2879 5f70 7265   pd.Series(y_pre
-00053b20: 6429 2e6d 6170 2874 7261 6e73 666f 726d  d).map(transform
-00053b30: 6572 292e 7661 6c75 6573 0d0a 2020 2020  er).values..    
-00053b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053b50: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
-00053b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053b70: 2070 7269 6e74 2827 4572 726f 723a 2053   print('Error: S
-00053b80: 616d 706c 6520 7375 626d 6973 7369 6f6e  ample submission
-00053b90: 2066 696c 6520 6973 2069 6e63 6f72 7265   file is incorre
-00053ba0: 6374 2e20 506c 6561 7365 2063 6865 636b  ct. Please check
-00053bb0: 2069 742e 2063 6f6e 7469 6e75 696e 672e   it. continuing.
-00053bc0: 2e2e 2729 0d0a 2020 2020 2323 2323 2323  ..')..    ######
-00053bd0: 2323 2323 2323 2323 2323 2323 2323 2320  ############### 
-00053be0: 2020 5020 4c20 4f20 5420 2020 4620 4520    P L O T   F E 
-00053bf0: 4120 5420 5520 5220 4520 2020 4920 4d20  A T U R E   I M 
-00053c00: 5020 4f20 5220 5420 4120 4e20 4320 4520  P O R T A N C E 
-00053c10: 5320 2020 4820 4520 5220 4520 2323 2323  S   H E R E ####
-00053c20: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00053c30: 0a20 2020 2069 6620 6d6f 6465 6c5f 6c61  .    if model_la
-00053c40: 6265 6c20 3d3d 2027 5369 6e67 6c65 5f4c  bel == 'Single_L
-00053c50: 6162 656c 273a 0d0a 2020 2020 2020 2020  abel':..        
-00053c60: 6966 2063 616c 6962 7261 746f 725f 666c  if calibrator_fl
-00053c70: 6167 3a0d 0a20 2020 2020 2020 2020 2020  ag:..           
-00053c80: 2070 6c6f 745f 6d6f 6465 6c20 3d20 6d6f   plot_model = mo
-00053c90: 6465 6c2e 6261 7365 5f65 7374 696d 6174  del.base_estimat
-00053ca0: 6f72 0d0a 2020 2020 2020 2020 656c 7365  or..        else
-00053cb0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-00053cc0: 6c6f 745f 6d6f 6465 6c20 3d20 636f 7079  lot_model = copy
-00053cd0: 2e64 6565 7063 6f70 7928 6d6f 6465 6c29  .deepcopy(model)
-00053ce0: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
-00053cf0: 2020 2020 2020 2020 2020 2020 2323 2323              ####
-00053d00: 2323 2320 5468 6973 2069 7320 7768 6572  ### This is wher
-00053d10: 6520 706c 6f74 2066 6561 7475 7265 5f69  e plot feature_i
-00053d20: 6d70 6f72 7461 6e63 6573 5f20 666f 7220  mportances_ for 
-00053d30: 7468 6520 6d6f 6465 6c73 2023 2323 2323  the models #####
-00053d40: 230d 0a20 2020 2020 2020 2020 2020 2069  #..            i
-00053d50: 6620 426f 6f73 7469 6e67 5f46 6c61 6720  f Boosting_Flag 
-00053d60: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-00053d70: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00053d80: 206d 6f64 656c 7479 7065 203d 3d20 2752   modeltype == 'R
-00053d90: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
+000539b0: 2323 2729 0d0a 2020 2020 2020 2020 2020  ##')..          
+000539c0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+000539d0: 2743 6f6d 706c 6574 6564 2053 7461 636b  'Completed Stack
+000539e0: 6564 2070 7265 6469 6374 696f 6e73 206f  ed predictions o
+000539f0: 6e20 6865 6c64 206f 7574 2064 6174 6127  n held out data'
+00053a00: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00053a10: 2020 2074 6573 746d 5b6e 6577 5f63 6f6c     testm[new_col
+00053a20: 5d20 3d20 7064 2e53 6572 6965 7328 656e  ] = pd.Series(en
+00053a30: 7365 6d5f 7072 6564 292e 6d61 7028 7472  sem_pred).map(tr
+00053a40: 616e 7366 6f72 6d65 7229 2e76 616c 7565  ansformer).value
+00053a50: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+00053a60: 2020 206e 6577 5f63 6f6c 732e 6170 7065     new_cols.appe
+00053a70: 6e64 286e 6577 5f63 6f6c 290d 0a20 2020  nd(new_col)..   
+00053a80: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00053a90: 6e6f 7420 6973 696e 7374 616e 6365 2873  not isinstance(s
+00053aa0: 616d 706c 655f 7375 626d 6973 7369 6f6e  ample_submission
+00053ab0: 2c20 7374 7229 3a0d 0a20 2020 2020 2020  , str):..       
+00053ac0: 2020 2020 2020 2020 2020 2020 2074 7279               try
+00053ad0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00053ae0: 2020 2020 2020 2020 2020 2073 616d 706c             sampl
+00053af0: 655f 7375 626d 6973 7369 6f6e 5b65 6163  e_submission[eac
+00053b00: 685f 7461 7267 6574 5d20 3d20 7064 2e53  h_target] = pd.S
+00053b10: 6572 6965 7328 795f 7072 6564 292e 6d61  eries(y_pred).ma
+00053b20: 7028 7472 616e 7366 6f72 6d65 7229 2e76  p(transformer).v
+00053b30: 616c 7565 730d 0a20 2020 2020 2020 2020  alues..         
+00053b40: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+00053b50: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
+00053b60: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00053b70: 7428 2745 7272 6f72 3a20 5361 6d70 6c65  t('Error: Sample
+00053b80: 2073 7562 6d69 7373 696f 6e20 6669 6c65   submission file
+00053b90: 2069 7320 696e 636f 7272 6563 742e 2050   is incorrect. P
+00053ba0: 6c65 6173 6520 6368 6563 6b20 6974 2e20  lease check it. 
+00053bb0: 636f 6e74 696e 7569 6e67 2e2e 2e27 290d  continuing...').
+00053bc0: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
+00053bd0: 2323 2323 2323 2323 2323 2020 2050 204c  ##########   P L
+00053be0: 204f 2054 2020 2046 2045 2041 2054 2055   O T   F E A T U
+00053bf0: 2052 2045 2020 2049 204d 2050 204f 2052   R E   I M P O R
+00053c00: 2054 2041 204e 2043 2045 2053 2020 2048   T A N C E S   H
+00053c10: 2045 2052 2045 2023 2323 2323 2323 2323   E R E #########
+00053c20: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+00053c30: 6966 206d 6f64 656c 5f6c 6162 656c 203d  if model_label =
+00053c40: 3d20 2753 696e 676c 655f 4c61 6265 6c27  = 'Single_Label'
+00053c50: 3a0d 0a20 2020 2020 2020 2069 6620 6361  :..        if ca
+00053c60: 6c69 6272 6174 6f72 5f66 6c61 673a 0d0a  librator_flag:..
+00053c70: 2020 2020 2020 2020 2020 2020 706c 6f74              plot
+00053c80: 5f6d 6f64 656c 203d 206d 6f64 656c 2e62  _model = model.b
+00053c90: 6173 655f 6573 7469 6d61 746f 720d 0a20  ase_estimator.. 
+00053ca0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00053cb0: 2020 2020 2020 2020 2020 706c 6f74 5f6d            plot_m
+00053cc0: 6f64 656c 203d 2063 6f70 792e 6465 6570  odel = copy.deep
+00053cd0: 636f 7079 286d 6f64 656c 290d 0a20 2020  copy(model)..   
+00053ce0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+00053cf0: 2020 2020 2020 2023 2323 2323 2323 2054         ####### T
+00053d00: 6869 7320 6973 2077 6865 7265 2070 6c6f  his is where plo
+00053d10: 7420 6665 6174 7572 655f 696d 706f 7274  t feature_import
+00053d20: 616e 6365 735f 2066 6f72 2074 6865 206d  ances_ for the m
+00053d30: 6f64 656c 7320 2323 2323 2323 0d0a 2020  odels ######..  
+00053d40: 2020 2020 2020 2020 2020 6966 2042 6f6f            if Boo
+00053d50: 7374 696e 675f 466c 6167 2069 7320 4e6f  sting_Flag is No
+00053d60: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+00053d70: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
+00053d80: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
+00053d90: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
 00053da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053db0: 2020 2020 2023 2323 2049 6620 796f 7520       ### If you 
-00053dc0: 7573 6520 4c69 6e65 6172 5356 5220 2074  use LinearSVR  t
-00053dd0: 6865 6e20 7573 6520 616c 6c20 6162 736f  hen use all abso
-00053de0: 6c75 7465 2076 616c 7565 732c 2073 6f20  lute values, so 
-00053df0: 796f 7520 6361 6e20 706c 6f74 2074 6865  you can plot the
-00053e00: 6d20 696e 2064 6563 7265 6173 696e 6720  m in decreasing 
-00053e10: 6f72 6465 7220 6f66 2069 6d70 6f72 7461  order of importa
-00053e20: 6e63 650d 0a20 2020 2020 2020 2020 2020  nce..           
-00053e30: 2020 2020 2020 2020 2020 2020 2069 6d70               imp
-00053e40: 5f66 6561 7475 7265 735f 6466 203d 2070  _features_df = p
-00053e50: 642e 4461 7461 4672 616d 6528 6162 7328  d.DataFrame(abs(
-00053e60: 706c 6f74 5f6d 6f64 656c 2e63 6f65 665f  plot_model.coef_
-00053e70: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
+00053db0: 2323 2320 4966 2079 6f75 2075 7365 204c  ### If you use L
+00053dc0: 696e 6561 7253 5652 2020 7468 656e 2075  inearSVR  then u
+00053dd0: 7365 2061 6c6c 2061 6273 6f6c 7574 6520  se all absolute 
+00053de0: 7661 6c75 6573 2c20 736f 2079 6f75 2063  values, so you c
+00053df0: 616e 2070 6c6f 7420 7468 656d 2069 6e20  an plot them in 
+00053e00: 6465 6372 6561 7369 6e67 206f 7264 6572  decreasing order
+00053e10: 206f 6620 696d 706f 7274 616e 6365 0d0a   of importance..
+00053e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053e30: 2020 2020 2020 2020 696d 705f 6665 6174          imp_feat
+00053e40: 7572 6573 5f64 6620 3d20 7064 2e44 6174  ures_df = pd.Dat
+00053e50: 6146 7261 6d65 2861 6273 2870 6c6f 745f  aFrame(abs(plot_
+00053e60: 6d6f 6465 6c2e 636f 6566 5f29 2c0d 0a20  model.coef_),.. 
+00053e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00053e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053ea0: 636f 6c75 6d6e 733d 5b27 4665 6174 7572  columns=['Featur
-00053eb0: 6520 496d 706f 7274 616e 6365 7327 5d2c  e Importances'],
-00053ec0: 696e 6465 783d 696d 706f 7274 616e 745f  index=important_
-00053ed0: 6665 6174 7572 6573 292e 736f 7274 5f76  features).sort_v
-00053ee0: 616c 7565 7328 0d0a 2020 2020 2020 2020  alues(..        
+00053e90: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+00053ea0: 6e73 3d5b 2746 6561 7475 7265 2049 6d70  ns=['Feature Imp
+00053eb0: 6f72 7461 6e63 6573 275d 2c69 6e64 6578  ortances'],index
+00053ec0: 3d69 6d70 6f72 7461 6e74 5f66 6561 7475  =important_featu
+00053ed0: 7265 7329 2e73 6f72 745f 7661 6c75 6573  res).sort_values
+00053ee0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
 00053ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053f10: 2020 2020 2746 6561 7475 7265 2049 6d70      'Feature Imp
-00053f20: 6f72 7461 6e63 6573 272c 6173 6365 6e64  ortances',ascend
-00053f30: 696e 673d 4661 6c73 6529 0d0a 2020 2020  ing=False)..    
-00053f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00053f50: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00053f60: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00053f70: 2323 2049 6620 796f 7520 646f 6e27 7420  ## If you don't 
-00053f80: 7573 6520 6162 736f 6c75 7465 2076 616c  use absolute val
-00053f90: 7565 732c 2079 6f75 2077 6f6e 2774 2067  ues, you won't g
-00053fa0: 6574 2074 6865 2072 6967 6874 2073 6574  et the right set
-00053fb0: 206f 6620 6665 6174 7572 6573 2069 6e20   of features in 
-00053fc0: 6f72 6465 722e 204d 616b 6520 7375 7265  order. Make sure
-00053fd0: 210d 0a20 2020 2020 2020 2020 2020 2020  !..             
-00053fe0: 2020 2020 2020 2020 2020 2069 6d70 5f66             imp_f
-00053ff0: 6561 7475 7265 735f 6466 203d 2070 642e  eatures_df = pd.
-00054000: 4461 7461 4672 616d 6528 6162 7328 706c  DataFrame(abs(pl
-00054010: 6f74 5f6d 6f64 656c 2e63 6f65 665f 5b30  ot_model.coef_[0
-00054020: 5d29 2c0d 0a20 2020 2020 2020 2020 2020  ]),..           
+00053f00: 2020 2020 2020 2020 2020 2020 2020 2027                 '
+00053f10: 4665 6174 7572 6520 496d 706f 7274 616e  Feature Importan
+00053f20: 6365 7327 2c61 7363 656e 6469 6e67 3d46  ces',ascending=F
+00053f30: 616c 7365 290d 0a20 2020 2020 2020 2020  alse)..         
+00053f40: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00053f50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00053f60: 2020 2020 2020 2020 2020 2323 2320 4966            ### If
+00053f70: 2079 6f75 2064 6f6e 2774 2075 7365 2061   you don't use a
+00053f80: 6273 6f6c 7574 6520 7661 6c75 6573 2c20  bsolute values, 
+00053f90: 796f 7520 776f 6e27 7420 6765 7420 7468  you won't get th
+00053fa0: 6520 7269 6768 7420 7365 7420 6f66 2066  e right set of f
+00053fb0: 6561 7475 7265 7320 696e 206f 7264 6572  eatures in order
+00053fc0: 2e20 4d61 6b65 2073 7572 6521 0d0a 2020  . Make sure!..  
+00053fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00053fe0: 2020 2020 2020 696d 705f 6665 6174 7572        imp_featur
+00053ff0: 6573 5f64 6620 3d20 7064 2e44 6174 6146  es_df = pd.DataF
+00054000: 7261 6d65 2861 6273 2870 6c6f 745f 6d6f  rame(abs(plot_mo
+00054010: 6465 6c2e 636f 6566 5f5b 305d 292c 0d0a  del.coef_[0]),..
+00054020: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00054030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054050: 2063 6f6c 756d 6e73 3d5b 2746 6561 7475   columns=['Featu
-00054060: 7265 2049 6d70 6f72 7461 6e63 6573 275d  re Importances']
-00054070: 2c69 6e64 6578 3d69 6d70 6f72 7461 6e74  ,index=important
-00054080: 5f66 6561 7475 7265 7329 2e73 6f72 745f  _features).sort_
-00054090: 7661 6c75 6573 280d 0a20 2020 2020 2020  values(..       
+00054040: 2020 2020 2020 2020 2020 2020 636f 6c75              colu
+00054050: 6d6e 733d 5b27 4665 6174 7572 6520 496d  mns=['Feature Im
+00054060: 706f 7274 616e 6365 7327 5d2c 696e 6465  portances'],inde
+00054070: 783d 696d 706f 7274 616e 745f 6665 6174  x=important_feat
+00054080: 7572 6573 292e 736f 7274 5f76 616c 7565  ures).sort_value
+00054090: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
 000540a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000540b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000540c0: 2020 2020 2027 4665 6174 7572 6520 496d       'Feature Im
-000540d0: 706f 7274 616e 6365 7327 2c61 7363 656e  portances',ascen
-000540e0: 6469 6e67 3d46 616c 7365 290d 0a20 2020  ding=False)..   
-000540f0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00054100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054110: 6966 206d 6f64 656c 5f6e 616d 652e 6c6f  if model_name.lo
-00054120: 7765 7228 2920 3d3d 2027 7867 626f 6f73  wer() == 'xgboos
-00054130: 7427 3a0d 0a20 2020 2020 2020 2020 2020  t':..           
-00054140: 2020 2020 2020 2020 2023 2323 2323 2020           #####  
-00054150: 5348 4150 2072 6571 7569 7265 7320 7468  SHAP requires th
-00054160: 6973 2073 7465 703a 2058 4742 6f6f 7374  is step: XGBoost
-00054170: 206d 6f64 656c 7320 6d75 7374 2068 6176   models must hav
-00054180: 6520 6265 656e 2022 7072 6564 6963 7465  e been "predicte
-00054190: 6422 0d0a 2020 2020 2020 2020 2020 2020  d"..            
-000541a0: 2020 2020 2020 2020 5f20 3d20 706c 6f74          _ = plot
-000541b0: 5f6d 6f64 656c 2e70 7265 6469 6374 2858  _model.predict(X
-000541c0: 5f74 6573 7429 0d0a 2020 2020 2020 2020  _test)..        
-000541d0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-000541e0: 4974 2069 7320 706f 7373 6962 6c65 2074  It is possible t
-000541f0: 6861 7420 696e 2073 6f6d 6520 6361 7365  hat in some case
-00054200: 732c 2058 4742 6f6f 7374 2068 6173 2066  s, XGBoost has f
-00054210: 6577 6572 2066 6561 7475 7265 7320 7468  ewer features th
-00054220: 616e 2077 6861 7420 7761 7320 7365 6e74  an what was sent
-00054230: 2069 6e2e 0d0a 2020 2020 2020 2020 2020   in...          
-00054240: 2020 2020 2020 2020 2020 2323 2320 496e            ### In
-00054250: 2074 686f 7365 2063 6173 6573 2c20 7765   those cases, we
-00054260: 206e 6565 6420 746f 2069 6465 6e74 6966   need to identif
-00054270: 7920 616e 6420 6b6e 6f77 2077 6869 6368  y and know which
-00054280: 2066 6561 7475 7265 7320 696e 2058 4742   features in XGB
-00054290: 6f6f 7374 2061 7265 2069 6e20 616e 6420  oost are in and 
-000542a0: 7768 6963 6820 6172 6520 6f75 740d 0a20  which are out.. 
-000542b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000542c0: 2020 2023 2323 2320 496e 2074 6861 7420     #### In that 
-000542d0: 6361 7365 2c20 7765 206e 6565 6420 746f  case, we need to
-000542e0: 2066 696e 6420 7468 6f73 6520 6665 6174   find those feat
-000542f0: 7572 6573 2061 6e64 2074 6865 6e20 646f  ures and then do
-00054300: 2061 2066 6561 7475 7265 2069 6d70 6f72   a feature impor
-00054310: 7461 6e63 650d 0a20 2020 2020 2020 2020  tance..         
-00054320: 2020 2020 2020 2020 2020 2064 6963 7466             dictf
-00054330: 203d 2070 6c6f 745f 6d6f 6465 6c2e 6765   = plot_model.ge
-00054340: 745f 626f 6f73 7465 7228 292e 6765 745f  t_booster().get_
-00054350: 7363 6f72 6528 696d 706f 7274 616e 6365  score(importance
-00054360: 5f74 7970 653d 2767 6169 6e27 290d 0a20  _type='gain').. 
-00054370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054380: 2020 2069 6620 6c65 6e28 6c65 6674 5f73     if len(left_s
-00054390: 7562 7472 6163 7428 706c 6f74 5f6d 6f64  ubtract(plot_mod
-000543a0: 656c 2e67 6574 5f62 6f6f 7374 6572 2829  el.get_booster()
-000543b0: 2e66 6561 7475 7265 5f6e 616d 6573 2c69  .feature_names,i
-000543c0: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
-000543d0: 7329 2920 3e20 303a 0d0a 2020 2020 2020  s)) > 0:..      
-000543e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000543f0: 2020 2323 2323 2049 6620 6665 6174 7572    #### If featur
-00054400: 6520 6e61 6d65 7320 6672 6f6d 2058 4742  e names from XGB
-00054410: 6f6f 7374 2061 6e64 2069 6d70 6f72 7461  oost and importa
-00054420: 6e74 5f66 6561 7475 7265 7320 6172 6520  nt_features are 
-00054430: 6e6f 7420 7361 6d65 2c79 6f75 206d 7573  not same,you mus
-00054440: 7420 7472 616e 7366 6f72 6d20 6469 6374  t transform dict
-00054450: 6620 6c69 6b65 2074 6869 7321 0d0a 2020  f like this!..  
+000540c0: 2746 6561 7475 7265 2049 6d70 6f72 7461  'Feature Importa
+000540d0: 6e63 6573 272c 6173 6365 6e64 696e 673d  nces',ascending=
+000540e0: 4661 6c73 6529 0d0a 2020 2020 2020 2020  False)..        
+000540f0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00054100: 2020 2020 2020 2020 2020 2069 6620 6d6f             if mo
+00054110: 6465 6c5f 6e61 6d65 2e6c 6f77 6572 2829  del_name.lower()
+00054120: 203d 3d20 2778 6762 6f6f 7374 273a 0d0a   == 'xgboost':..
+00054130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054140: 2020 2020 2323 2323 2320 2053 4841 5020      #####  SHAP 
+00054150: 7265 7175 6972 6573 2074 6869 7320 7374  requires this st
+00054160: 6570 3a20 5847 426f 6f73 7420 6d6f 6465  ep: XGBoost mode
+00054170: 6c73 206d 7573 7420 6861 7665 2062 6565  ls must have bee
+00054180: 6e20 2270 7265 6469 6374 6564 220d 0a20  n "predicted".. 
+00054190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000541a0: 2020 205f 203d 2070 6c6f 745f 6d6f 6465     _ = plot_mode
+000541b0: 6c2e 7072 6564 6963 7428 585f 7465 7374  l.predict(X_test
+000541c0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+000541d0: 2020 2020 2020 2023 2323 2049 7420 6973         ### It is
+000541e0: 2070 6f73 7369 626c 6520 7468 6174 2069   possible that i
+000541f0: 6e20 736f 6d65 2063 6173 6573 2c20 5847  n some cases, XG
+00054200: 426f 6f73 7420 6861 7320 6665 7765 7220  Boost has fewer 
+00054210: 6665 6174 7572 6573 2074 6861 6e20 7768  features than wh
+00054220: 6174 2077 6173 2073 656e 7420 696e 2e0d  at was sent in..
+00054230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00054240: 2020 2020 2023 2323 2049 6e20 7468 6f73       ### In thos
+00054250: 6520 6361 7365 732c 2077 6520 6e65 6564  e cases, we need
+00054260: 2074 6f20 6964 656e 7469 6679 2061 6e64   to identify and
+00054270: 206b 6e6f 7720 7768 6963 6820 6665 6174   know which feat
+00054280: 7572 6573 2069 6e20 5847 426f 6f73 7420  ures in XGBoost 
+00054290: 6172 6520 696e 2061 6e64 2077 6869 6368  are in and which
+000542a0: 2061 7265 206f 7574 0d0a 2020 2020 2020   are out..      
+000542b0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+000542c0: 2323 2049 6e20 7468 6174 2063 6173 652c  ## In that case,
+000542d0: 2077 6520 6e65 6564 2074 6f20 6669 6e64   we need to find
+000542e0: 2074 686f 7365 2066 6561 7475 7265 7320   those features 
+000542f0: 616e 6420 7468 656e 2064 6f20 6120 6665  and then do a fe
+00054300: 6174 7572 6520 696d 706f 7274 616e 6365  ature importance
+00054310: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00054320: 2020 2020 2020 6469 6374 6620 3d20 706c        dictf = pl
+00054330: 6f74 5f6d 6f64 656c 2e67 6574 5f62 6f6f  ot_model.get_boo
+00054340: 7374 6572 2829 2e67 6574 5f73 636f 7265  ster().get_score
+00054350: 2869 6d70 6f72 7461 6e63 655f 7479 7065  (importance_type
+00054360: 3d27 6761 696e 2729 0d0a 2020 2020 2020  ='gain')..      
+00054370: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00054380: 206c 656e 286c 6566 745f 7375 6274 7261   len(left_subtra
+00054390: 6374 2870 6c6f 745f 6d6f 6465 6c2e 6765  ct(plot_model.ge
+000543a0: 745f 626f 6f73 7465 7228 292e 6665 6174  t_booster().feat
+000543b0: 7572 655f 6e61 6d65 732c 696d 706f 7274  ure_names,import
+000543c0: 616e 745f 6665 6174 7572 6573 2929 203e  ant_features)) >
+000543d0: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
+000543e0: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+000543f0: 2320 4966 2066 6561 7475 7265 206e 616d  # If feature nam
+00054400: 6573 2066 726f 6d20 5847 426f 6f73 7420  es from XGBoost 
+00054410: 616e 6420 696d 706f 7274 616e 745f 6665  and important_fe
+00054420: 6174 7572 6573 2061 7265 206e 6f74 2073  atures are not s
+00054430: 616d 652c 796f 7520 6d75 7374 2074 7261  ame,you must tra
+00054440: 6e73 666f 726d 2064 6963 7466 206c 696b  nsform dictf lik
+00054450: 6520 7468 6973 210d 0a20 2020 2020 2020  e this!..       
 00054460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054470: 2020 2020 2020 6469 6374 6120 3d20 6469        dicta = di
-00054480: 6374 287a 6970 2870 6c6f 745f 6d6f 6465  ct(zip(plot_mode
-00054490: 6c2e 6765 745f 626f 6f73 7465 7228 292e  l.get_booster().
-000544a0: 6665 6174 7572 655f 6e61 6d65 732c 696d  feature_names,im
-000544b0: 706f 7274 616e 745f 6665 6174 7572 6573  portant_features
-000544c0: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-000544d0: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-000544e0: 6469 6374 203d 2064 6963 7428 5b28 782c  dict = dict([(x,
-000544f0: 6469 6374 615b 785d 2920 666f 7220 7820  dicta[x]) for x 
-00054500: 696e 2064 6963 7466 2e6b 6579 7328 295d  in dictf.keys()]
-00054510: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00054520: 2020 2020 2020 2020 2020 2066 6561 7464             featd
-00054530: 6963 7432 203d 2064 6963 7428 5b28 6469  ict2 = dict([(di
-00054540: 6374 615b 785d 2c64 6963 7466 5b78 5d29  cta[x],dictf[x])
-00054550: 2066 6f72 2078 2069 6e20 6665 6174 6469   for x in featdi
-00054560: 6374 2e6b 6579 7328 295d 290d 0a20 2020  ct.keys()])..   
+00054470: 2064 6963 7461 203d 2064 6963 7428 7a69   dicta = dict(zi
+00054480: 7028 706c 6f74 5f6d 6f64 656c 2e67 6574  p(plot_model.get
+00054490: 5f62 6f6f 7374 6572 2829 2e66 6561 7475  _booster().featu
+000544a0: 7265 5f6e 616d 6573 2c69 6d70 6f72 7461  re_names,importa
+000544b0: 6e74 5f66 6561 7475 7265 7329 290d 0a20  nt_features)).. 
+000544c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000544d0: 2020 2020 2020 2066 6561 7464 6963 7420         featdict 
+000544e0: 3d20 6469 6374 285b 2878 2c64 6963 7461  = dict([(x,dicta
+000544f0: 5b78 5d29 2066 6f72 2078 2069 6e20 6469  [x]) for x in di
+00054500: 6374 662e 6b65 7973 2829 5d29 0d0a 2020  ctf.keys()])..  
+00054510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054520: 2020 2020 2020 6665 6174 6469 6374 3220        featdict2 
+00054530: 3d20 6469 6374 285b 2864 6963 7461 5b78  = dict([(dicta[x
+00054540: 5d2c 6469 6374 665b 785d 2920 666f 7220  ],dictf[x]) for 
+00054550: 7820 696e 2066 6561 7464 6963 742e 6b65  x in featdict.ke
+00054560: 7973 2829 5d29 0d0a 2020 2020 2020 2020  ys()])..        
 00054570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054580: 2020 2020 2069 6d70 5f66 6561 7475 7265       imp_feature
-00054590: 735f 6466 203d 2020 7064 2e44 6174 6146  s_df =  pd.DataF
-000545a0: 7261 6d65 2866 6561 7464 6963 7432 2e76  rame(featdict2.v
-000545b0: 616c 7565 7328 292c 696e 6465 783d 6665  alues(),index=fe
-000545c0: 6174 6469 6374 322e 6b65 7973 2829 2c0d  atdict2.keys(),.
-000545d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00054580: 696d 705f 6665 6174 7572 6573 5f64 6620  imp_features_df 
+00054590: 3d20 2070 642e 4461 7461 4672 616d 6528  =  pd.DataFrame(
+000545a0: 6665 6174 6469 6374 322e 7661 6c75 6573  featdict2.values
+000545b0: 2829 2c69 6e64 6578 3d66 6561 7464 6963  (),index=featdic
+000545c0: 7432 2e6b 6579 7328 292c 0d0a 2020 2020  t2.keys(),..    
+000545d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000545e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000545f0: 2020 2020 2020 2020 2063 6f6c 756d 6e73           columns
-00054600: 203d 205b 2746 6561 7475 7265 2049 6d70   = ['Feature Imp
-00054610: 6f72 7461 6e63 6573 275d 292e 736f 7274  ortances']).sort
-00054620: 5f76 616c 7565 7328 2746 6561 7475 7265  _values('Feature
-00054630: 2049 6d70 6f72 7461 6e63 6573 272c 0d0a   Importances',..
+000545f0: 2020 2020 636f 6c75 6d6e 7320 3d20 5b27      columns = ['
+00054600: 4665 6174 7572 6520 496d 706f 7274 616e  Feature Importan
+00054610: 6365 7327 5d29 2e73 6f72 745f 7661 6c75  ces']).sort_valu
+00054620: 6573 2827 4665 6174 7572 6520 496d 706f  es('Feature Impo
+00054630: 7274 616e 6365 7327 2c0d 0a20 2020 2020  rtances',..     
 00054640: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00054650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054660: 2020 2020 2020 2020 6173 6365 6e64 696e          ascendin
-00054670: 673d 4661 6c73 6529 0d0a 2020 2020 2020  g=False)..      
-00054680: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00054690: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-000546a0: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-000546b0: 2320 4966 2074 6865 2066 6561 7475 7265  # If the feature
-000546c0: 206e 616d 6573 2066 726f 6d20 5847 426f   names from XGBo
-000546d0: 6f73 7420 616e 6420 7468 6520 696d 706f  ost and the impo
-000546e0: 7274 616e 745f 6665 6174 7572 6573 2061  rtant_features a
-000546f0: 7265 2073 616d 652c 0d0a 2020 2020 2020  re same,..      
-00054700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054710: 2020 2323 2320 2020 2020 796f 7520 6361    ###     you ca
-00054720: 6e20 706c 6f74 2064 6963 7466 2069 6d6d  n plot dictf imm
-00054730: 6564 6961 7465 6c79 210d 0a20 2020 2020  ediately!..     
-00054740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054750: 2020 2069 6d70 5f66 6561 7475 7265 735f     imp_features_
-00054760: 6466 203d 2020 7064 2e44 6174 6146 7261  df =  pd.DataFra
-00054770: 6d65 2864 6963 7466 2e76 616c 7565 7328  me(dictf.values(
-00054780: 292c 696e 6465 783d 6469 6374 662e 6b65  ),index=dictf.ke
-00054790: 7973 2829 2c0d 0a20 2020 2020 2020 2020  ys(),..         
+00054660: 2020 2061 7363 656e 6469 6e67 3d46 616c     ascending=Fal
+00054670: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
+00054680: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00054690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000546a0: 2020 2020 2020 2020 2323 2323 2049 6620          #### If 
+000546b0: 7468 6520 6665 6174 7572 6520 6e61 6d65  the feature name
+000546c0: 7320 6672 6f6d 2058 4742 6f6f 7374 2061  s from XGBoost a
+000546d0: 6e64 2074 6865 2069 6d70 6f72 7461 6e74  nd the important
+000546e0: 5f66 6561 7475 7265 7320 6172 6520 7361  _features are sa
+000546f0: 6d65 2c0d 0a20 2020 2020 2020 2020 2020  me,..           
+00054700: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00054710: 2020 2020 2079 6f75 2063 616e 2070 6c6f       you can plo
+00054720: 7420 6469 6374 6620 696d 6d65 6469 6174  t dictf immediat
+00054730: 656c 7921 0d0a 2020 2020 2020 2020 2020  ely!..          
+00054740: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00054750: 705f 6665 6174 7572 6573 5f64 6620 3d20  p_features_df = 
+00054760: 2070 642e 4461 7461 4672 616d 6528 6469   pd.DataFrame(di
+00054770: 6374 662e 7661 6c75 6573 2829 2c69 6e64  ctf.values(),ind
+00054780: 6578 3d64 6963 7466 2e6b 6579 7328 292c  ex=dictf.keys(),
+00054790: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 000547a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000547b0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-000547c0: 6f6c 756d 6e73 203d 205b 2746 6561 7475  olumns = ['Featu
-000547d0: 7265 2049 6d70 6f72 7461 6e63 6573 275d  re Importances']
-000547e0: 292e 736f 7274 5f76 616c 7565 7328 2746  ).sort_values('F
-000547f0: 6561 7475 7265 2049 6d70 6f72 7461 6e63  eature Importanc
-00054800: 6573 272c 0d0a 2020 2020 2020 2020 2020  es',..          
+000547b0: 2020 2020 2020 2020 2020 636f 6c75 6d6e            column
+000547c0: 7320 3d20 5b27 4665 6174 7572 6520 496d  s = ['Feature Im
+000547d0: 706f 7274 616e 6365 7327 5d29 2e73 6f72  portances']).sor
+000547e0: 745f 7661 6c75 6573 2827 4665 6174 7572  t_values('Featur
+000547f0: 6520 496d 706f 7274 616e 6365 7327 2c0d  e Importances',.
+00054800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00054810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054820: 2020 2020 2020 2020 2020 2020 2020 6173                as
-00054830: 6365 6e64 696e 673d 4661 6c73 6529 0d0a  cending=False)..
-00054840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054850: 656c 6966 206d 6f64 656c 5f6e 616d 6520  elif model_name 
-00054860: 3d3d 2027 466f 7265 7374 7327 3a0d 0a20  == 'Forests':.. 
-00054870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054880: 2020 2069 6d70 5f66 6561 7475 7265 735f     imp_features_
-00054890: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
-000548a0: 6528 706c 6f74 5f6d 6f64 656c 2e66 6561  e(plot_model.fea
-000548b0: 7475 7265 5f69 6d70 6f72 7461 6e63 6573  ture_importances
-000548c0: 5f2c 2063 6f6c 756d 6e73 3d5b 2746 6561  _, columns=['Fea
-000548d0: 7475 7265 2049 6d70 6f72 7461 6e63 6573  ture Importances
-000548e0: 275d 2c0d 0a20 2020 2020 2020 2020 2020  '],..           
-000548f0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00054900: 6465 783d 696d 706f 7274 616e 745f 6665  dex=important_fe
-00054910: 6174 7572 6573 292e 736f 7274 5f76 616c  atures).sort_val
-00054920: 7565 7328 2746 6561 7475 7265 2049 6d70  ues('Feature Imp
-00054930: 6f72 7461 6e63 6573 272c 0d0a 2020 2020  ortances',..    
+00054820: 2020 2020 2020 2020 2061 7363 656e 6469           ascendi
+00054830: 6e67 3d46 616c 7365 290d 0a20 2020 2020  ng=False)..     
+00054840: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00054850: 6d6f 6465 6c5f 6e61 6d65 203d 3d20 2746  model_name == 'F
+00054860: 6f72 6573 7473 273a 0d0a 2020 2020 2020  orests':..      
+00054870: 2020 2020 2020 2020 2020 2020 2020 696d                im
+00054880: 705f 6665 6174 7572 6573 5f64 6620 3d20  p_features_df = 
+00054890: 7064 2e44 6174 6146 7261 6d65 2870 6c6f  pd.DataFrame(plo
+000548a0: 745f 6d6f 6465 6c2e 6665 6174 7572 655f  t_model.feature_
+000548b0: 696d 706f 7274 616e 6365 735f 2c20 636f  importances_, co
+000548c0: 6c75 6d6e 733d 5b27 4665 6174 7572 6520  lumns=['Feature 
+000548d0: 496d 706f 7274 616e 6365 7327 5d2c 0d0a  Importances'],..
+000548e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000548f0: 2020 2020 2020 2020 2069 6e64 6578 3d69           index=i
+00054900: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
+00054910: 7329 2e73 6f72 745f 7661 6c75 6573 2827  s).sort_values('
+00054920: 4665 6174 7572 6520 496d 706f 7274 616e  Feature Importan
+00054930: 6365 7327 2c0d 0a20 2020 2020 2020 2020  ces',..         
 00054940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054950: 2020 2020 2061 7363 656e 6469 6e67 3d46       ascending=F
-00054960: 616c 7365 290d 0a20 2020 2020 2020 2020  alse)..         
-00054970: 2020 2020 2020 2065 6c69 6620 6d6f 6465         elif mode
-00054980: 6c5f 6e61 6d65 2e6c 6f77 6572 2829 203d  l_name.lower() =
-00054990: 3d20 2763 6174 626f 6f73 7427 3a0d 0a20  = 'catboost':.. 
-000549a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000549b0: 2020 2066 726f 6d20 6361 7462 6f6f 7374     from catboost
-000549c0: 2069 6d70 6f72 7420 506f 6f6c 0d0a 2020   import Pool..  
-000549d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000549e0: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
-000549f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054a00: 696d 705f 6665 6174 7572 6573 5f64 6620  imp_features_df 
-00054a10: 3d20 7064 2e44 6174 6146 7261 6d65 2870  = pd.DataFrame(p
-00054a20: 6c6f 745f 6d6f 6465 6c2e 6765 745f 6665  lot_model.get_fe
-00054a30: 6174 7572 655f 696d 706f 7274 616e 6365  ature_importance
-00054a40: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00054950: 6173 6365 6e64 696e 673d 4661 6c73 6529  ascending=False)
+00054960: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00054970: 2020 656c 6966 206d 6f64 656c 5f6e 616d    elif model_nam
+00054980: 652e 6c6f 7765 7228 2920 3d3d 2027 6361  e.lower() == 'ca
+00054990: 7462 6f6f 7374 273a 0d0a 2020 2020 2020  tboost':..      
+000549a0: 2020 2020 2020 2020 2020 2020 2020 6672                fr
+000549b0: 6f6d 2063 6174 626f 6f73 7420 696d 706f  om catboost impo
+000549c0: 7274 2050 6f6f 6c0d 0a20 2020 2020 2020  rt Pool..       
+000549d0: 2020 2020 2020 2020 2020 2020 2074 7279               try
+000549e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000549f0: 2020 2020 2020 2020 2020 2069 6d70 5f66             imp_f
+00054a00: 6561 7475 7265 735f 6466 203d 2070 642e  eatures_df = pd.
+00054a10: 4461 7461 4672 616d 6528 706c 6f74 5f6d  DataFrame(plot_m
+00054a20: 6f64 656c 2e67 6574 5f66 6561 7475 7265  odel.get_feature
+00054a30: 5f69 6d70 6f72 7461 6e63 6528 0d0a 2020  _importance(..  
+00054a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00054a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054a60: 2020 2020 2020 2050 6f6f 6c28 585f 6376         Pool(X_cv
-00054a70: 2c20 6c61 6265 6c3d 795f 6376 2c63 6174  , label=y_cv,cat
-00054a80: 5f66 6561 7475 7265 733d 696d 705f 6361  _features=imp_ca
-00054a90: 7473 2929 2c0d 0a20 2020 2020 2020 2020  ts)),..         
+00054a60: 2020 506f 6f6c 2858 5f63 762c 206c 6162    Pool(X_cv, lab
+00054a70: 656c 3d79 5f63 762c 6361 745f 6665 6174  el=y_cv,cat_feat
+00054a80: 7572 6573 3d69 6d70 5f63 6174 7329 292c  ures=imp_cats)),
+00054a90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 00054aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054ab0: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
-00054ac0: 6e73 3d5b 2746 6561 7475 7265 2049 6d70  ns=['Feature Imp
-00054ad0: 6f72 7461 6e63 6573 275d 2c0d 0a20 2020  ortances'],..   
+00054ab0: 2020 2020 2020 636f 6c75 6d6e 733d 5b27        columns=['
+00054ac0: 4665 6174 7572 6520 496d 706f 7274 616e  Feature Importan
+00054ad0: 6365 7327 5d2c 0d0a 2020 2020 2020 2020  ces'],..        
 00054ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054b00: 2069 6e64 6578 3d69 6d70 6f72 7461 6e74   index=important
-00054b10: 5f66 6561 7475 7265 7329 2e73 6f72 745f  _features).sort_
-00054b20: 7661 6c75 6573 280d 0a20 2020 2020 2020  values(..       
+00054af0: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+00054b00: 783d 696d 706f 7274 616e 745f 6665 6174  x=important_feat
+00054b10: 7572 6573 292e 736f 7274 5f76 616c 7565  ures).sort_value
+00054b20: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
 00054b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054b40: 2020 2020 2020 2020 2020 2020 2027 4665               'Fe
-00054b50: 6174 7572 6520 496d 706f 7274 616e 6365  ature Importance
-00054b60: 7327 2c61 7363 656e 6469 6e67 3d46 616c  s',ascending=Fal
-00054b70: 7365 290d 0a20 2020 2020 2020 2020 2020  se)..           
-00054b80: 2020 2020 2020 2020 2065 7863 6570 743a           except:
-00054b90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00054ba0: 2020 2020 2020 2020 2020 696d 705f 6665            imp_fe
-00054bb0: 6174 7572 6573 5f64 6620 3d20 7064 2e44  atures_df = pd.D
-00054bc0: 6174 6146 7261 6d65 2870 6c6f 745f 6d6f  ataFrame(plot_mo
-00054bd0: 6465 6c2e 6765 745f 6665 6174 7572 655f  del.get_feature_
-00054be0: 696d 706f 7274 616e 6365 2829 2c0d 0a20  importance(),.. 
+00054b40: 2020 2020 2020 2020 2746 6561 7475 7265          'Feature
+00054b50: 2049 6d70 6f72 7461 6e63 6573 272c 6173   Importances',as
+00054b60: 6365 6e64 696e 673d 4661 6c73 6529 0d0a  cending=False)..
+00054b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054b80: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
+00054b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00054ba0: 2020 2020 2069 6d70 5f66 6561 7475 7265       imp_feature
+00054bb0: 735f 6466 203d 2070 642e 4461 7461 4672  s_df = pd.DataFr
+00054bc0: 616d 6528 706c 6f74 5f6d 6f64 656c 2e67  ame(plot_model.g
+00054bd0: 6574 5f66 6561 7475 7265 5f69 6d70 6f72  et_feature_impor
+00054be0: 7461 6e63 6528 292c 0d0a 2020 2020 2020  tance(),..      
 00054bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00054c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054c10: 2020 2020 2020 2063 6f6c 756d 6e73 3d5b         columns=[
-00054c20: 2746 6561 7475 7265 2049 6d70 6f72 7461  'Feature Importa
-00054c30: 6e63 6573 275d 2c0d 0a20 2020 2020 2020  nces'],..       
+00054c10: 2020 636f 6c75 6d6e 733d 5b27 4665 6174    columns=['Feat
+00054c20: 7572 6520 496d 706f 7274 616e 6365 7327  ure Importances'
+00054c30: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
 00054c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054c60: 2069 6e64 6578 3d69 6d70 6f72 7461 6e74   index=important
-00054c70: 5f66 6561 7475 7265 7329 2e73 6f72 745f  _features).sort_
-00054c80: 7661 6c75 6573 280d 0a20 2020 2020 2020  values(..       
+00054c50: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+00054c60: 783d 696d 706f 7274 616e 745f 6665 6174  x=important_feat
+00054c70: 7572 6573 292e 736f 7274 5f76 616c 7565  ures).sort_value
+00054c80: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
 00054c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054cb0: 2027 4665 6174 7572 6520 496d 706f 7274   'Feature Import
-00054cc0: 616e 6365 7327 2c61 7363 656e 6469 6e67  ances',ascending
-00054cd0: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
-00054ce0: 2020 2020 2023 2323 204e 6f77 2064 7261       ### Now dra
-00054cf0: 7720 7468 6520 6665 6174 7572 6520 696d  w the feature im
-00054d00: 706f 7274 616e 6365 7320 7573 696e 6720  portances using 
-00054d10: 7468 6520 6461 7461 2066 7261 6d65 2061  the data frame a
-00054d20: 626f 7665 210d 0a20 2020 2020 2020 2020  bove!..         
-00054d30: 2020 2068 6569 6768 745f 7369 7a65 203d     height_size =
-00054d40: 2035 0d0a 2020 2020 2020 2020 2020 2020   5..            
-00054d50: 7769 6474 685f 7369 7a65 203d 2031 300d  width_size = 10.
-00054d60: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-00054d70: 6f72 5f73 7472 696e 6720 3d20 6c69 7374  or_string = list
-00054d80: 2827 6279 7263 6d67 6b62 7972 636d 676b  ('byrcmgkbyrcmgk
-00054d90: 6279 7263 6d67 6b62 7972 636d 676b 2729  byrcmgkbyrcmgk')
-00054da0: 5b3a 3135 5d0d 0a20 2020 2020 2020 2020  [:15]..         
-00054db0: 2020 2070 7269 6e74 2827 2020 2020 506c     print('    Pl
-00054dc0: 6f74 7469 6e67 2046 6561 7475 7265 2049  otting Feature I
-00054dd0: 6d70 6f72 7461 6e63 6573 2074 6f20 6578  mportances to ex
-00054de0: 706c 6169 6e20 7468 6520 6f75 7470 7574  plain the output
-00054df0: 206f 6620 6d6f 6465 6c27 290d 0a20 2020   of model')..   
-00054e00: 2020 2020 2020 2020 2069 6d70 5f66 6561           imp_fea
-00054e10: 7475 7265 735f 6466 5b3a 3135 5d2e 706c  tures_df[:15].pl
-00054e20: 6f74 286b 696e 643d 2762 6172 6827 2c74  ot(kind='barh',t
-00054e30: 6974 6c65 3d27 4665 6174 7572 6520 496d  itle='Feature Im
-00054e40: 706f 7274 616e 6365 7320 666f 7220 7072  portances for pr
-00054e50: 6564 6963 7469 6e67 2025 7327 2025 6561  edicting %s' %ea
-00054e60: 6368 5f74 6172 6765 742c 0d0a 2020 2020  ch_target,..    
+00054ca0: 2020 2020 2020 2020 2020 2020 2746 6561              'Fea
+00054cb0: 7475 7265 2049 6d70 6f72 7461 6e63 6573  ture Importances
+00054cc0: 272c 6173 6365 6e64 696e 673d 4661 6c73  ',ascending=Fals
+00054cd0: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00054ce0: 2323 2320 4e6f 7720 6472 6177 2074 6865  ### Now draw the
+00054cf0: 2066 6561 7475 7265 2069 6d70 6f72 7461   feature importa
+00054d00: 6e63 6573 2075 7369 6e67 2074 6865 2064  nces using the d
+00054d10: 6174 6120 6672 616d 6520 6162 6f76 6521  ata frame above!
+00054d20: 0d0a 2020 2020 2020 2020 2020 2020 6865  ..            he
+00054d30: 6967 6874 5f73 697a 6520 3d20 350d 0a20  ight_size = 5.. 
+00054d40: 2020 2020 2020 2020 2020 2077 6964 7468             width
+00054d50: 5f73 697a 6520 3d20 3130 0d0a 2020 2020  _size = 10..    
+00054d60: 2020 2020 2020 2020 636f 6c6f 725f 7374          color_st
+00054d70: 7269 6e67 203d 206c 6973 7428 2762 7972  ring = list('byr
+00054d80: 636d 676b 6279 7263 6d67 6b62 7972 636d  cmgkbyrcmgkbyrcm
+00054d90: 676b 6279 7263 6d67 6b27 295b 3a31 355d  gkbyrcmgk')[:15]
+00054da0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+00054db0: 696e 7428 2720 2020 2050 6c6f 7474 696e  int('    Plottin
+00054dc0: 6720 4665 6174 7572 6520 496d 706f 7274  g Feature Import
+00054dd0: 616e 6365 7320 746f 2065 7870 6c61 696e  ances to explain
+00054de0: 2074 6865 206f 7574 7075 7420 6f66 206d   the output of m
+00054df0: 6f64 656c 2729 0d0a 2020 2020 2020 2020  odel')..        
+00054e00: 2020 2020 696d 705f 6665 6174 7572 6573      imp_features
+00054e10: 5f64 665b 3a31 355d 2e70 6c6f 7428 6b69  _df[:15].plot(ki
+00054e20: 6e64 3d27 6261 7268 272c 7469 746c 653d  nd='barh',title=
+00054e30: 2746 6561 7475 7265 2049 6d70 6f72 7461  'Feature Importa
+00054e40: 6e63 6573 2066 6f72 2070 7265 6469 6374  nces for predict
+00054e50: 696e 6720 2573 2720 2565 6163 685f 7461  ing %s' %each_ta
+00054e60: 7267 6574 2c0d 0a20 2020 2020 2020 2020  rget,..         
 00054e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00054e80: 2020 2020 2020 2020 2020 2020 2066 6967               fig
-00054e90: 7369 7a65 3d28 7769 6474 685f 7369 7a65  size=(width_size
-00054ea0: 2c20 6865 6967 6874 5f73 697a 6529 2c20  , height_size), 
-00054eb0: 636f 6c6f 723d 636f 6c6f 725f 7374 7269  color=color_stri
-00054ec0: 6e67 293b 0d0a 2020 2020 2020 2020 6578  ng);..        ex
-00054ed0: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
-00054ee0: 2020 2070 7269 6e74 2827 436f 756c 6420     print('Could 
-00054ef0: 6e6f 7420 6472 6177 2066 6561 7475 7265  not draw feature
-00054f00: 2069 6d70 6f72 7461 6e63 6520 706c 6f74   importance plot
-00054f10: 2064 7565 2074 6f20 616e 2065 7272 6f72   due to an error
-00054f20: 2729 0d0a 2020 2020 2020 2020 2323 2323  ')..        ####
-00054f30: 2323 2323 2323 2320 2020 4420 5220 4120  #######   D R A 
-00054f40: 5720 2053 4841 5020 2056 414c 5545 5320  W  SHAP  VALUES 
-00054f50: 5553 494e 4720 5452 4545 2042 4153 4544  USING TREE BASED
-00054f60: 204d 4f44 454c 532e 2054 4845 2052 4553   MODELS. THE RES
-00054f70: 5420 5749 4c4c 204e 4f54 2047 4554 2053  T WILL NOT GET S
-00054f80: 4841 5020 2323 2323 2323 2323 2323 2323  HAP ############
-00054f90: 0d0a 2020 2020 2020 2020 6966 2076 6572  ..        if ver
-00054fa0: 626f 7365 203e 3d20 323a 0d0a 2020 2020  bose >= 2:..    
-00054fb0: 2020 2020 2020 2020 7072 696e 7428 2754          print('T
-00054fc0: 7279 696e 6720 746f 2070 6c6f 7420 5348  rying to plot SH
-00054fd0: 4150 2076 616c 7565 7320 6966 2053 4841  AP values if SHA
-00054fe0: 5020 6973 2069 6e73 7461 6c6c 6564 2069  P is installed i
-00054ff0: 6e20 7468 6973 206d 6163 6869 6e65 2e2e  n this machine..
-00055000: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
-00055010: 2058 5f70 6c6f 7420 3d20 585f 6376 5b3a   X_plot = X_cv[:
-00055020: 3130 3030 5d0d 0a20 2020 2020 2020 2020  1000]..         
-00055030: 2020 2079 5f70 6c6f 7420 3d20 795f 6376     y_plot = y_cv
-00055040: 5b3a 3130 3030 5d0d 0a20 2020 2020 2020  [:1000]..       
-00055050: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00055060: 2020 2020 2020 2020 2020 2069 6620 6d6f             if mo
-00055070: 6465 6c5f 6e61 6d65 2e6c 6f77 6572 2829  del_name.lower()
-00055080: 203d 3d20 2763 6174 626f 6f73 7427 3a0d   == 'catboost':.
-00055090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000550a0: 2020 2020 2069 6620 7665 7262 6f73 6520       if verbose 
-000550b0: 3e20 303a 0d0a 2020 2020 2020 2020 2020  > 0:..          
-000550c0: 2020 2020 2020 2020 2020 2020 2020 696d                im
-000550d0: 706f 7274 2073 6861 700d 0a20 2020 2020  port shap..     
-000550e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000550f0: 2020 2066 726f 6d20 6361 7462 6f6f 7374     from catboost
-00055100: 2069 6d70 6f72 7420 506f 6f6c 0d0a 2020   import Pool..  
+00054e80: 2020 2020 2020 2020 6669 6773 697a 653d          figsize=
+00054e90: 2877 6964 7468 5f73 697a 652c 2068 6569  (width_size, hei
+00054ea0: 6768 745f 7369 7a65 292c 2063 6f6c 6f72  ght_size), color
+00054eb0: 3d63 6f6c 6f72 5f73 7472 696e 6729 3b0d  =color_string);.
+00054ec0: 0a20 2020 2020 2020 2065 7863 6570 743a  .        except:
+00054ed0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+00054ee0: 696e 7428 2743 6f75 6c64 206e 6f74 2064  int('Could not d
+00054ef0: 7261 7720 6665 6174 7572 6520 696d 706f  raw feature impo
+00054f00: 7274 616e 6365 2070 6c6f 7420 6475 6520  rtance plot due 
+00054f10: 746f 2061 6e20 6572 726f 7227 290d 0a20  to an error').. 
+00054f20: 2020 2020 2020 2023 2323 2323 2323 2323         #########
+00054f30: 2323 2020 2044 2052 2041 2057 2020 5348  ##   D R A W  SH
+00054f40: 4150 2020 5641 4c55 4553 2055 5349 4e47  AP  VALUES USING
+00054f50: 2054 5245 4520 4241 5345 4420 4d4f 4445   TREE BASED MODE
+00054f60: 4c53 2e20 5448 4520 5245 5354 2057 494c  LS. THE REST WIL
+00054f70: 4c20 4e4f 5420 4745 5420 5348 4150 2023  L NOT GET SHAP #
+00054f80: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+00054f90: 2020 2020 2069 6620 7665 7262 6f73 6520       if verbose 
+00054fa0: 3e3d 2032 3a0d 0a20 2020 2020 2020 2020  >= 2:..         
+00054fb0: 2020 2070 7269 6e74 2827 5472 7969 6e67     print('Trying
+00054fc0: 2074 6f20 706c 6f74 2053 4841 5020 7661   to plot SHAP va
+00054fd0: 6c75 6573 2069 6620 5348 4150 2069 7320  lues if SHAP is 
+00054fe0: 696e 7374 616c 6c65 6420 696e 2074 6869  installed in thi
+00054ff0: 7320 6d61 6368 696e 652e 2e2e 2729 0d0a  s machine...')..
+00055000: 2020 2020 2020 2020 2020 2020 585f 706c              X_pl
+00055010: 6f74 203d 2058 5f63 765b 3a31 3030 305d  ot = X_cv[:1000]
+00055020: 0d0a 2020 2020 2020 2020 2020 2020 795f  ..            y_
+00055030: 706c 6f74 203d 2079 5f63 765b 3a31 3030  plot = y_cv[:100
+00055040: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
+00055050: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+00055060: 2020 2020 2020 6966 206d 6f64 656c 5f6e        if model_n
+00055070: 616d 652e 6c6f 7765 7228 2920 3d3d 2027  ame.lower() == '
+00055080: 6361 7462 6f6f 7374 273a 0d0a 2020 2020  catboost':..    
+00055090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000550a0: 6966 2076 6572 626f 7365 203e 2030 3a0d  if verbose > 0:.
+000550b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000550c0: 2020 2020 2020 2020 2069 6d70 6f72 7420           import 
+000550d0: 7368 6170 0d0a 2020 2020 2020 2020 2020  shap..          
+000550e0: 2020 2020 2020 2020 2020 2020 2020 6672                fr
+000550f0: 6f6d 2063 6174 626f 6f73 7420 696d 706f  om catboost impo
+00055100: 7274 2050 6f6f 6c0d 0a20 2020 2020 2020  rt Pool..       
 00055110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055120: 2020 2020 2020 7368 6170 2e69 6e69 746a        shap.initj
-00055130: 7328 290d 0a20 2020 2020 2020 2020 2020  s()..           
-00055140: 2020 2020 2020 2020 2020 2020 2074 7279               try
-00055150: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00055160: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00055170: 6861 705f 7661 6c75 6573 203d 2070 6c6f  hap_values = plo
-00055180: 745f 6d6f 6465 6c2e 6765 745f 6665 6174  t_model.get_feat
-00055190: 7572 655f 696d 706f 7274 616e 6365 2850  ure_importance(P
-000551a0: 6f6f 6c28 585f 706c 6f74 2c20 6c61 6265  ool(X_plot, labe
-000551b0: 6c3d 795f 706c 6f74 2c0d 0a20 2020 2020  l=y_plot,..     
+00055120: 2073 6861 702e 696e 6974 6a73 2829 0d0a   shap.initjs()..
+00055130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055140: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
+00055150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055160: 2020 2020 2020 2020 2020 7368 6170 5f76            shap_v
+00055170: 616c 7565 7320 3d20 706c 6f74 5f6d 6f64  alues = plot_mod
+00055180: 656c 2e67 6574 5f66 6561 7475 7265 5f69  el.get_feature_i
+00055190: 6d70 6f72 7461 6e63 6528 506f 6f6c 2858  mportance(Pool(X
+000551a0: 5f70 6c6f 742c 206c 6162 656c 3d79 5f70  _plot, label=y_p
+000551b0: 6c6f 742c 0d0a 2020 2020 2020 2020 2020  lot,..          
 000551c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000551d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000551e0: 2020 2020 2020 2063 6174 5f66 6561 7475         cat_featu
-000551f0: 7265 733d 696d 705f 6361 7473 292c 7479  res=imp_cats),ty
-00055200: 7065 3d22 5368 6170 5661 6c75 6573 2229  pe="ShapValues")
-00055210: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00055220: 2020 2020 2020 2020 2020 6578 6365 7074            except
-00055230: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00055240: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00055250: 6861 705f 7661 6c75 6573 203d 2070 6c6f  hap_values = plo
-00055260: 745f 6d6f 6465 6c2e 6765 745f 6665 6174  t_model.get_feat
-00055270: 7572 655f 696d 706f 7274 616e 6365 2874  ure_importance(t
-00055280: 7970 653d 2253 6861 7056 616c 7565 7322  ype="ShapValues"
-00055290: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000552a0: 2020 2020 2020 2020 2020 2073 6861 705f             shap_
-000552b0: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
-000552c0: 6528 6e70 2e63 5f5b 585f 706c 6f74 2e76  e(np.c_[X_plot.v
-000552d0: 616c 7565 732c 795f 706c 6f74 5d2c 636f  alues,y_plot],co
-000552e0: 6c75 6d6e 733d 5b6c 6973 7428 585f 706c  lumns=[list(X_pl
-000552f0: 6f74 292b 5b65 6163 685f 7461 7267 6574  ot)+[each_target
-00055300: 5d5d 290d 0a20 2020 2020 2020 2020 2020  ]])..           
-00055310: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00055320: 6d6f 6465 6c74 7970 6520 3d3d 2027 4d75  modeltype == 'Mu
-00055330: 6c74 695f 436c 6173 7369 6669 6361 7469  lti_Classificati
-00055340: 6f6e 273a 0d0a 2020 2020 2020 2020 2020  on':..          
-00055350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055360: 2020 666f 7220 6561 6368 5f69 2069 6e20    for each_i in 
-00055370: 7261 6e67 6528 6c65 6e28 636c 6173 7365  range(len(classe
-00055380: 7329 293a 0d0a 2020 2020 2020 2020 2020  s)):..          
+000551e0: 2020 6361 745f 6665 6174 7572 6573 3d69    cat_features=i
+000551f0: 6d70 5f63 6174 7329 2c74 7970 653d 2253  mp_cats),type="S
+00055200: 6861 7056 616c 7565 7322 290d 0a20 2020  hapValues")..   
+00055210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055220: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
+00055230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055240: 2020 2020 2020 2020 2020 7368 6170 5f76            shap_v
+00055250: 616c 7565 7320 3d20 706c 6f74 5f6d 6f64  alues = plot_mod
+00055260: 656c 2e67 6574 5f66 6561 7475 7265 5f69  el.get_feature_i
+00055270: 6d70 6f72 7461 6e63 6528 7479 7065 3d22  mportance(type="
+00055280: 5368 6170 5661 6c75 6573 2229 0d0a 2020  ShapValues")..  
+00055290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000552a0: 2020 2020 2020 7368 6170 5f64 6620 3d20        shap_df = 
+000552b0: 7064 2e44 6174 6146 7261 6d65 286e 702e  pd.DataFrame(np.
+000552c0: 635f 5b58 5f70 6c6f 742e 7661 6c75 6573  c_[X_plot.values
+000552d0: 2c79 5f70 6c6f 745d 2c63 6f6c 756d 6e73  ,y_plot],columns
+000552e0: 3d5b 6c69 7374 2858 5f70 6c6f 7429 2b5b  =[list(X_plot)+[
+000552f0: 6561 6368 5f74 6172 6765 745d 5d29 0d0a  each_target]])..
+00055300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055310: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
+00055320: 7479 7065 203d 3d20 274d 756c 7469 5f43  type == 'Multi_C
+00055330: 6c61 7373 6966 6963 6174 696f 6e27 3a0d  lassification':.
+00055340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00055350: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00055360: 2065 6163 685f 6920 696e 2072 616e 6765   each_i in range
+00055370: 286c 656e 2863 6c61 7373 6573 2929 3a0d  (len(classes)):.
+00055380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00055390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000553a0: 2020 2020 2020 2323 2320 5468 6973 2069        ### This i
-000553b0: 7320 6e65 6564 6564 2066 6f72 2043 6174  s needed for Cat
-000553c0: 626f 6f73 7420 6d6f 6465 6c73 2062 7574  boost models but
-000553d0: 2069 7420 6973 2076 6572 7920 6375 6d62   it is very cumb
-000553e0: 6572 736f 6d65 210d 0a20 2020 2020 2020  ersome!..       
+000553a0: 2023 2323 2054 6869 7320 6973 206e 6565   ### This is nee
+000553b0: 6465 6420 666f 7220 4361 7462 6f6f 7374  ded for Catboost
+000553c0: 206d 6f64 656c 7320 6275 7420 6974 2069   models but it i
+000553d0: 7320 7665 7279 2063 756d 6265 7273 6f6d  s very cumbersom
+000553e0: 6521 0d0a 2020 2020 2020 2020 2020 2020  e!..            
 000553f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055400: 2020 2020 2020 2020 2023 2323 2059 6f75           ### You
-00055410: 206e 6565 6420 746f 2063 7963 6c65 2074   need to cycle t
-00055420: 6872 6f75 6768 206d 756c 7469 706c 6520  hrough multiple 
-00055430: 7661 6c75 6573 206f 6620 636c 6173 7365  values of classe
-00055440: 7320 6672 6f6d 2030 2074 6f20 6e5f 636c  s from 0 to n_cl
-00055450: 6173 7365 732d 312e 0d0a 2020 2020 2020  asses-1...      
+00055400: 2020 2020 2323 2320 596f 7520 6e65 6564      ### You need
+00055410: 2074 6f20 6379 636c 6520 7468 726f 7567   to cycle throug
+00055420: 6820 6d75 6c74 6970 6c65 2076 616c 7565  h multiple value
+00055430: 7320 6f66 2063 6c61 7373 6573 2066 726f  s of classes fro
+00055440: 6d20 3020 746f 206e 5f63 6c61 7373 6573  m 0 to n_classes
+00055450: 2d31 2e0d 0a20 2020 2020 2020 2020 2020  -1...           
 00055460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055470: 2020 2020 2020 2020 2020 2323 2320 5468            ### Th
-00055480: 6572 6520 6973 206e 6f20 7761 7920 746f  ere is no way to
-00055490: 2066 6f72 6365 2069 7420 696e 2061 6e20   force it in an 
-000554a0: 4178 203d 3e20 736f 2079 6f75 2061 7265  Ax => so you are
-000554b0: 2073 7475 636b 2070 7269 6e74 696e 6720   stuck printing 
-000554c0: 6d75 6c74 6970 6c65 2063 6861 7274 730d  multiple charts.
-000554d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000554e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000554f0: 2070 6c74 2e66 6967 7572 6528 290d 0a20   plt.figure().. 
+00055470: 2020 2020 2023 2323 2054 6865 7265 2069       ### There i
+00055480: 7320 6e6f 2077 6179 2074 6f20 666f 7263  s no way to forc
+00055490: 6520 6974 2069 6e20 616e 2041 7820 3d3e  e it in an Ax =>
+000554a0: 2073 6f20 796f 7520 6172 6520 7374 7563   so you are stuc
+000554b0: 6b20 7072 696e 7469 6e67 206d 756c 7469  k printing multi
+000554c0: 706c 6520 6368 6172 7473 0d0a 2020 2020  ple charts..    
+000554d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000554e0: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
+000554f0: 6669 6775 7265 2829 0d0a 2020 2020 2020  figure()..      
 00055500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055510: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00055520: 6861 702e 7375 6d6d 6172 795f 706c 6f74  hap.summary_plot
-00055530: 2873 6861 705f 7661 6c75 6573 5b3a 2c65  (shap_values[:,e
-00055540: 6163 685f 692c 3a5d 2c20 7368 6170 5f64  ach_i,:], shap_d
-00055550: 662c 2070 6c6f 745f 7479 7065 3d22 7669  f, plot_type="vi
-00055560: 6f6c 696e 2229 0d0a 2020 2020 2020 2020  olin")..        
-00055570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055580: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00055590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000555a0: 2020 2070 6c74 2e66 6967 7572 6528 290d     plt.figure().
-000555b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000555c0: 2020 2020 2020 2020 2020 2020 2073 6861               sha
-000555d0: 702e 7375 6d6d 6172 795f 706c 6f74 2873  p.summary_plot(s
-000555e0: 6861 705f 7661 6c75 6573 2c20 7368 6170  hap_values, shap
-000555f0: 5f64 662c 2070 6c6f 745f 7479 7065 3d22  _df, plot_type="
-00055600: 7669 6f6c 696e 2229 0d0a 2020 2020 2020  violin")..      
-00055610: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00055620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00055630: 2020 2020 2058 5f70 6c6f 7420 3d20 585f       X_plot = X_
-00055640: 7465 7374 5b3a 3130 3030 5d0d 0a20 2020  test[:1000]..   
-00055650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055660: 2069 6d70 6f72 7420 7368 6170 0d0a 2020   import shap..  
-00055670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055680: 2020 7368 6170 2e69 6e69 746a 7328 290d    shap.initjs().
-00055690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000556a0: 2020 2020 2023 2323 2320 5468 6973 2077       #### This w
-000556b0: 6f72 6b73 2077 656c 6c20 666f 7220 5246  orks well for RF
-000556c0: 4320 616e 6420 5847 426f 6f73 7420 666f  C and XGBoost fo
-000556d0: 7220 6d75 6c74 6963 6c61 7373 2070 726f  r multiclass pro
-000556e0: 626c 656d 7320 2323 2323 230d 0a20 2020  blems #####..   
-000556f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055700: 2023 2323 2320 5468 6973 2070 6c6f 7473   #### This plots
-00055710: 2061 2076 696f 6c69 6e20 706c 6f74 2074   a violin plot t
-00055720: 6861 7420 6973 2064 6966 6665 7265 6e74  hat is different
-00055730: 2066 726f 6d20 7468 6520 6261 7220 6368   from the bar ch
-00055740: 6172 7420 6162 6f76 6521 0d0a 2020 2020  art above!..    
-00055750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055760: 2323 2323 2054 6869 7320 646f 6573 206e  #### This does n
-00055770: 6f74 2077 6f72 6b20 666f 7220 4361 7442  ot work for CatB
-00055780: 6f6f 7374 2073 6f20 7472 7920 736f 6d65  oost so try some
-00055790: 7468 696e 6720 656c 7365 210d 0a20 2020  thing else!..   
-000557a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000557b0: 2069 6620 6d6f 6465 6c5f 6e61 6d65 2e6c   if model_name.l
-000557c0: 6f77 6572 2829 203d 3d20 276c 696e 6561  ower() == 'linea
-000557d0: 7227 3a0d 0a20 2020 2020 2020 2020 2020  r':..           
-000557e0: 2020 2020 2020 2020 2020 2020 2065 7870               exp
-000557f0: 6c61 696e 6572 203d 2073 6861 702e 4c69  lainer = shap.Li
-00055800: 6e65 6172 4578 706c 6169 6e65 7228 706c  nearExplainer(pl
-00055810: 6f74 5f6d 6f64 656c 2c20 585f 706c 6f74  ot_model, X_plot
-00055820: 2c20 6665 6174 7572 655f 6465 7065 6e64  , feature_depend
-00055830: 656e 6365 3d22 696e 6465 7065 6e64 656e  ence="independen
-00055840: 7422 290d 0a20 2020 2020 2020 2020 2020  t")..           
-00055850: 2020 2020 2020 2020 2020 2020 2073 6861               sha
-00055860: 705f 7661 6c75 6573 203d 2065 7870 6c61  p_values = expla
-00055870: 696e 6572 2e73 6861 705f 7661 6c75 6573  iner.shap_values
-00055880: 2858 5f70 6c6f 7429 0d0a 2020 2020 2020  (X_plot)..      
-00055890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000558a0: 2020 706c 742e 6669 6775 7265 2829 0d0a    plt.figure()..
+00055510: 2020 2020 2020 2020 2020 7368 6170 2e73            shap.s
+00055520: 756d 6d61 7279 5f70 6c6f 7428 7368 6170  ummary_plot(shap
+00055530: 5f76 616c 7565 735b 3a2c 6561 6368 5f69  _values[:,each_i
+00055540: 2c3a 5d2c 2073 6861 705f 6466 2c20 706c  ,:], shap_df, pl
+00055550: 6f74 5f74 7970 653d 2276 696f 6c69 6e22  ot_type="violin"
+00055560: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00055570: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00055580: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00055590: 2020 2020 2020 2020 2020 2020 2020 706c                pl
+000555a0: 742e 6669 6775 7265 2829 0d0a 2020 2020  t.figure()..    
+000555b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000555c0: 2020 2020 2020 2020 7368 6170 2e73 756d          shap.sum
+000555d0: 6d61 7279 5f70 6c6f 7428 7368 6170 5f76  mary_plot(shap_v
+000555e0: 616c 7565 732c 2073 6861 705f 6466 2c20  alues, shap_df, 
+000555f0: 706c 6f74 5f74 7970 653d 2276 696f 6c69  plot_type="violi
+00055600: 6e22 290d 0a20 2020 2020 2020 2020 2020  n")..           
+00055610: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+00055620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055630: 585f 706c 6f74 203d 2058 5f74 6573 745b  X_plot = X_test[
+00055640: 3a31 3030 305d 0d0a 2020 2020 2020 2020  :1000]..        
+00055650: 2020 2020 2020 2020 2020 2020 696d 706f              impo
+00055660: 7274 2073 6861 700d 0a20 2020 2020 2020  rt shap..       
+00055670: 2020 2020 2020 2020 2020 2020 2073 6861               sha
+00055680: 702e 696e 6974 6a73 2829 0d0a 2020 2020  p.initjs()..    
+00055690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000556a0: 2323 2323 2054 6869 7320 776f 726b 7320  #### This works 
+000556b0: 7765 6c6c 2066 6f72 2052 4643 2061 6e64  well for RFC and
+000556c0: 2058 4742 6f6f 7374 2066 6f72 206d 756c   XGBoost for mul
+000556d0: 7469 636c 6173 7320 7072 6f62 6c65 6d73  ticlass problems
+000556e0: 2023 2323 2323 0d0a 2020 2020 2020 2020   #####..        
+000556f0: 2020 2020 2020 2020 2020 2020 2323 2323              ####
+00055700: 2054 6869 7320 706c 6f74 7320 6120 7669   This plots a vi
+00055710: 6f6c 696e 2070 6c6f 7420 7468 6174 2069  olin plot that i
+00055720: 7320 6469 6666 6572 656e 7420 6672 6f6d  s different from
+00055730: 2074 6865 2062 6172 2063 6861 7274 2061   the bar chart a
+00055740: 626f 7665 210d 0a20 2020 2020 2020 2020  bove!..         
+00055750: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
+00055760: 5468 6973 2064 6f65 7320 6e6f 7420 776f  This does not wo
+00055770: 726b 2066 6f72 2043 6174 426f 6f73 7420  rk for CatBoost 
+00055780: 736f 2074 7279 2073 6f6d 6574 6869 6e67  so try something
+00055790: 2065 6c73 6521 0d0a 2020 2020 2020 2020   else!..        
+000557a0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+000557b0: 6f64 656c 5f6e 616d 652e 6c6f 7765 7228  odel_name.lower(
+000557c0: 2920 3d3d 2027 6c69 6e65 6172 273a 0d0a  ) == 'linear':..
+000557d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000557e0: 2020 2020 2020 2020 6578 706c 6169 6e65          explaine
+000557f0: 7220 3d20 7368 6170 2e4c 696e 6561 7245  r = shap.LinearE
+00055800: 7870 6c61 696e 6572 2870 6c6f 745f 6d6f  xplainer(plot_mo
+00055810: 6465 6c2c 2058 5f70 6c6f 742c 2066 6561  del, X_plot, fea
+00055820: 7475 7265 5f64 6570 656e 6465 6e63 653d  ture_dependence=
+00055830: 2269 6e64 6570 656e 6465 6e74 2229 0d0a  "independent")..
+00055840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055850: 2020 2020 2020 2020 7368 6170 5f76 616c          shap_val
+00055860: 7565 7320 3d20 6578 706c 6169 6e65 722e  ues = explainer.
+00055870: 7368 6170 5f76 616c 7565 7328 585f 706c  shap_values(X_pl
+00055880: 6f74 290d 0a20 2020 2020 2020 2020 2020  ot)..           
+00055890: 2020 2020 2020 2020 2020 2020 2070 6c74               plt
+000558a0: 2e66 6967 7572 6528 290d 0a20 2020 2020  .figure()..     
 000558b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000558c0: 2020 2020 2020 2020 7368 6170 2e73 756d          shap.sum
-000558d0: 6d61 7279 5f70 6c6f 7428 7368 6170 5f76  mary_plot(shap_v
-000558e0: 616c 7565 732c 2058 5f70 6c6f 742c 2070  alues, X_plot, p
-000558f0: 6c6f 745f 7479 7065 3d22 6261 7222 290d  lot_type="bar").
-00055900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00055910: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
-00055920: 6c74 7970 6520 213d 2027 5265 6772 6573  ltype != 'Regres
-00055930: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
-00055940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055950: 2020 2020 706c 742e 6669 6775 7265 2829      plt.figure()
-00055960: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00055970: 2020 2020 2020 2020 2020 2020 2020 7368                sh
-00055980: 6170 2e73 756d 6d61 7279 5f70 6c6f 7428  ap.summary_plot(
-00055990: 7368 6170 5f76 616c 7565 732c 2058 5f70  shap_values, X_p
-000559a0: 6c6f 7429 0d0a 2020 2020 2020 2020 2020  lot)..          
-000559b0: 2020 2020 2020 2020 2020 656c 6966 206d            elif m
-000559c0: 6f64 656c 5f6e 616d 652e 6c6f 7765 7228  odel_name.lower(
-000559d0: 2920 3d3d 2027 666f 7265 7374 7327 3a0d  ) == 'forests':.
-000559e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000559f0: 2020 2020 2020 2020 2023 2323 2320 5468           #### Th
-00055a00: 6973 2077 6f72 6b73 2077 656c 6c20 666f  is works well fo
-00055a10: 7220 5246 4320 616e 6420 5847 426f 6f73  r RFC and XGBoos
-00055a20: 7420 666f 7220 6d75 6c74 6963 6c61 7373  t for multiclass
-00055a30: 2070 726f 626c 656d 7320 2323 2323 230d   problems #####.
-00055a40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00055a50: 2020 2020 2020 2020 2023 2323 2049 7420           ### It 
-00055a60: 776f 726b 7320 666f 7220 626f 7468 2062  works for both b
-00055a70: 696e 6172 7920 616e 6420 6d75 6c74 692d  inary and multi-
-00055a80: 636c 6173 7320 7072 6f62 6c65 6d73 2023  class problems #
-00055a90: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
-00055aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055ab0: 2023 2323 2048 6f77 6576 6572 2c20 6974   ### However, it
-00055ac0: 2064 6f65 7320 4e4f 5420 776f 726b 2066   does NOT work f
-00055ad0: 6f72 2043 6174 426f 6f73 7420 6d6f 6465  or CatBoost mode
-00055ae0: 6c73 210d 0a20 2020 2020 2020 2020 2020  ls!..           
-00055af0: 2020 2020 2020 2020 2020 2020 2065 7870               exp
-00055b00: 6c61 696e 6572 203d 2073 6861 702e 5472  lainer = shap.Tr
-00055b10: 6565 4578 706c 6169 6e65 7228 706c 6f74  eeExplainer(plot
-00055b20: 5f6d 6f64 656c 290d 0a20 2020 2020 2020  _model)..       
-00055b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055b40: 2073 6861 705f 7661 6c75 6573 203d 2065   shap_values = e
-00055b50: 7870 6c61 696e 6572 2e73 6861 705f 7661  xplainer.shap_va
-00055b60: 6c75 6573 2858 5f70 6c6f 7429 0d0a 2020  lues(X_plot)..  
+000558c0: 2020 2073 6861 702e 7375 6d6d 6172 795f     shap.summary_
+000558d0: 706c 6f74 2873 6861 705f 7661 6c75 6573  plot(shap_values
+000558e0: 2c20 585f 706c 6f74 2c20 706c 6f74 5f74  , X_plot, plot_t
+000558f0: 7970 653d 2262 6172 2229 0d0a 2020 2020  ype="bar")..    
+00055900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055910: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
+00055920: 2021 3d20 2752 6567 7265 7373 696f 6e27   != 'Regression'
+00055930: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00055940: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00055950: 6c74 2e66 6967 7572 6528 290d 0a20 2020  lt.figure()..   
+00055960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055970: 2020 2020 2020 2020 2073 6861 702e 7375           shap.su
+00055980: 6d6d 6172 795f 706c 6f74 2873 6861 705f  mmary_plot(shap_
+00055990: 7661 6c75 6573 2c20 585f 706c 6f74 290d  values, X_plot).
+000559a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000559b0: 2020 2020 2065 6c69 6620 6d6f 6465 6c5f       elif model_
+000559c0: 6e61 6d65 2e6c 6f77 6572 2829 203d 3d20  name.lower() == 
+000559d0: 2766 6f72 6573 7473 273a 0d0a 2020 2020  'forests':..    
+000559e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000559f0: 2020 2020 2323 2323 2054 6869 7320 776f      #### This wo
+00055a00: 726b 7320 7765 6c6c 2066 6f72 2052 4643  rks well for RFC
+00055a10: 2061 6e64 2058 4742 6f6f 7374 2066 6f72   and XGBoost for
+00055a20: 206d 756c 7469 636c 6173 7320 7072 6f62   multiclass prob
+00055a30: 6c65 6d73 2023 2323 2323 0d0a 2020 2020  lems #####..    
+00055a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055a50: 2020 2020 2323 2320 4974 2077 6f72 6b73      ### It works
+00055a60: 2066 6f72 2062 6f74 6820 6269 6e61 7279   for both binary
+00055a70: 2061 6e64 206d 756c 7469 2d63 6c61 7373   and multi-class
+00055a80: 2070 726f 626c 656d 7320 2323 2323 2323   problems ######
+00055a90: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
+00055aa0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+00055ab0: 486f 7765 7665 722c 2069 7420 646f 6573  However, it does
+00055ac0: 204e 4f54 2077 6f72 6b20 666f 7220 4361   NOT work for Ca
+00055ad0: 7442 6f6f 7374 206d 6f64 656c 7321 0d0a  tBoost models!..
+00055ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055af0: 2020 2020 2020 2020 6578 706c 6169 6e65          explaine
+00055b00: 7220 3d20 7368 6170 2e54 7265 6545 7870  r = shap.TreeExp
+00055b10: 6c61 696e 6572 2870 6c6f 745f 6d6f 6465  lainer(plot_mode
+00055b20: 6c29 0d0a 2020 2020 2020 2020 2020 2020  l)..            
+00055b30: 2020 2020 2020 2020 2020 2020 7368 6170              shap
+00055b40: 5f76 616c 7565 7320 3d20 6578 706c 6169  _values = explai
+00055b50: 6e65 722e 7368 6170 5f76 616c 7565 7328  ner.shap_values(
+00055b60: 585f 706c 6f74 290d 0a20 2020 2020 2020  X_plot)..       
 00055b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055b80: 2020 2020 2020 706c 742e 6669 6775 7265        plt.figure
-00055b90: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00055ba0: 2020 2020 2020 2020 2020 2020 7368 6170              shap
-00055bb0: 2e73 756d 6d61 7279 5f70 6c6f 7428 7368  .summary_plot(sh
-00055bc0: 6170 5f76 616c 7565 732c 2058 5f70 6c6f  ap_values, X_plo
-00055bd0: 742c 2070 6c6f 745f 7479 7065 3d22 6261  t, plot_type="ba
-00055be0: 7222 290d 0a20 2020 2020 2020 2020 2020  r")..           
-00055bf0: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-00055c00: 2054 6865 7265 2069 7320 6e6f 2073 696e   There is no sin
-00055c10: 676c 6520 7669 6f6c 696e 2070 6c6f 7420  gle violin plot 
-00055c20: 666f 7220 5261 6e64 6f6d 2046 6f72 6573  for Random Fores
-00055c30: 7473 2069 6e20 5348 4150 0d0a 2020 2020  ts in SHAP..    
-00055c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055c50: 2020 2020 2323 2323 2049 7420 6163 7475      #### It actu
-00055c60: 616c 6c79 2068 6173 206d 756c 7469 706c  ally has multipl
-00055c70: 6520 6f75 7470 7574 7320 736f 2079 6f75  e outputs so you
-00055c80: 2063 616e 206c 6f6f 7020 7468 726f 7567   can loop throug
-00055c90: 6820 6974 2066 6f72 2065 6163 6820 636c  h it for each cl
-00055ca0: 6173 730d 0a20 2020 2020 2020 2020 2020  ass..           
-00055cb0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00055cc0: 6d6f 6465 6c74 7970 6520 213d 2027 5265  modeltype != 'Re
-00055cd0: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
+00055b80: 2070 6c74 2e66 6967 7572 6528 290d 0a20   plt.figure().. 
+00055b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055ba0: 2020 2020 2020 2073 6861 702e 7375 6d6d         shap.summ
+00055bb0: 6172 795f 706c 6f74 2873 6861 705f 7661  ary_plot(shap_va
+00055bc0: 6c75 6573 2c20 585f 706c 6f74 2c20 706c  lues, X_plot, pl
+00055bd0: 6f74 5f74 7970 653d 2262 6172 2229 0d0a  ot_type="bar")..
+00055be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055bf0: 2020 2020 2020 2020 2323 2320 5468 6572          ### Ther
+00055c00: 6520 6973 206e 6f20 7369 6e67 6c65 2076  e is no single v
+00055c10: 696f 6c69 6e20 706c 6f74 2066 6f72 2052  iolin plot for R
+00055c20: 616e 646f 6d20 466f 7265 7374 7320 696e  andom Forests in
+00055c30: 2053 4841 500d 0a20 2020 2020 2020 2020   SHAP..         
+00055c40: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00055c50: 2323 2320 4974 2061 6374 7561 6c6c 7920  ### It actually 
+00055c60: 6861 7320 6d75 6c74 6970 6c65 206f 7574  has multiple out
+00055c70: 7075 7473 2073 6f20 796f 7520 6361 6e20  puts so you can 
+00055c80: 6c6f 6f70 2074 6872 6f75 6768 2069 7420  loop through it 
+00055c90: 666f 7220 6561 6368 2063 6c61 7373 0d0a  for each class..
+00055ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055cb0: 2020 2020 2020 2020 6966 206d 6f64 656c          if model
+00055cc0: 7479 7065 2021 3d20 2752 6567 7265 7373  type != 'Regress
+00055cd0: 696f 6e27 3a0d 0a20 2020 2020 2020 2020  ion':..         
 00055ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055cf0: 2020 2020 2020 2020 666f 7220 6561 6368          for each
-00055d00: 5f69 2069 6e20 7261 6e67 6528 6c65 6e28  _i in range(len(
-00055d10: 636c 6173 7365 7329 293a 0d0a 2020 2020  classes)):..    
+00055cf0: 2020 2066 6f72 2065 6163 685f 6920 696e     for each_i in
+00055d00: 2072 616e 6765 286c 656e 2863 6c61 7373   range(len(class
+00055d10: 6573 2929 3a0d 0a20 2020 2020 2020 2020  es)):..         
 00055d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055d30: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
-00055d40: 6669 6775 7265 2829 0d0a 2020 2020 2020  figure()..      
+00055d30: 2020 2020 2020 2070 6c74 2e66 6967 7572         plt.figur
+00055d40: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
 00055d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055d60: 2020 2020 2020 2020 2020 7368 6170 2e73            shap.s
-00055d70: 756d 6d61 7279 5f70 6c6f 7428 7368 6170  ummary_plot(shap
-00055d80: 5f76 616c 7565 735b 6561 6368 5f69 5d2c  _values[each_i],
-00055d90: 2058 5f70 6c6f 7429 0d0a 2020 2020 2020   X_plot)..      
-00055da0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00055db0: 6966 206d 6f64 656c 5f6e 616d 652e 6c6f  if model_name.lo
-00055dc0: 7765 7228 2920 3d3d 2027 7867 626f 6f73  wer() == 'xgboos
-00055dd0: 7427 3a0d 0a20 2020 2020 2020 2020 2020  t':..           
-00055de0: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-00055df0: 2320 5468 6973 2077 6f72 6b73 2077 656c  # This works wel
-00055e00: 6c20 666f 7220 5246 4320 616e 6420 5847  l for RFC and XG
-00055e10: 426f 6f73 7420 666f 7220 6d75 6c74 6963  Boost for multic
-00055e20: 6c61 7373 2070 726f 626c 656d 7320 2323  lass problems ##
-00055e30: 2323 230d 0a20 2020 2020 2020 2020 2020  ###..           
-00055e40: 2020 2020 2020 2020 2020 2020 2023 2323               ###
-00055e50: 2049 7420 776f 726b 7320 666f 7220 626f   It works for bo
-00055e60: 7468 2062 696e 6172 7920 616e 6420 6d75  th binary and mu
-00055e70: 6c74 692d 636c 6173 7320 7072 6f62 6c65  lti-class proble
-00055e80: 6d73 2023 2323 2323 2323 230d 0a20 2020  ms ########..   
+00055d60: 2020 2020 2073 6861 702e 7375 6d6d 6172       shap.summar
+00055d70: 795f 706c 6f74 2873 6861 705f 7661 6c75  y_plot(shap_valu
+00055d80: 6573 5b65 6163 685f 695d 2c20 585f 706c  es[each_i], X_pl
+00055d90: 6f74 290d 0a20 2020 2020 2020 2020 2020  ot)..           
+00055da0: 2020 2020 2020 2020 2065 6c69 6620 6d6f           elif mo
+00055db0: 6465 6c5f 6e61 6d65 2e6c 6f77 6572 2829  del_name.lower()
+00055dc0: 203d 3d20 2778 6762 6f6f 7374 273a 0d0a   == 'xgboost':..
+00055dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055de0: 2020 2020 2020 2020 2323 2323 2054 6869          #### Thi
+00055df0: 7320 776f 726b 7320 7765 6c6c 2066 6f72  s works well for
+00055e00: 2052 4643 2061 6e64 2058 4742 6f6f 7374   RFC and XGBoost
+00055e10: 2066 6f72 206d 756c 7469 636c 6173 7320   for multiclass 
+00055e20: 7072 6f62 6c65 6d73 2023 2323 2323 0d0a  problems #####..
+00055e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055e40: 2020 2020 2020 2020 2323 2320 4974 2077          ### It w
+00055e50: 6f72 6b73 2066 6f72 2062 6f74 6820 6269  orks for both bi
+00055e60: 6e61 7279 2061 6e64 206d 756c 7469 2d63  nary and multi-c
+00055e70: 6c61 7373 2070 726f 626c 656d 7320 2323  lass problems ##
+00055e80: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
 00055e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055ea0: 2020 2020 2023 2323 2048 6f77 6576 6572       ### However
-00055eb0: 2c20 6974 2064 6f65 7320 4e4f 5420 776f  , it does NOT wo
-00055ec0: 726b 2066 6f72 2043 6174 426f 6f73 7420  rk for CatBoost 
-00055ed0: 6d6f 6465 6c73 210d 0a20 2020 2020 2020  models!..       
-00055ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055ef0: 2065 7870 6c61 696e 6572 203d 2073 6861   explainer = sha
-00055f00: 702e 5472 6565 4578 706c 6169 6e65 7228  p.TreeExplainer(
-00055f10: 706c 6f74 5f6d 6f64 656c 290d 0a20 2020  plot_model)..   
+00055ea0: 2323 2320 486f 7765 7665 722c 2069 7420  ### However, it 
+00055eb0: 646f 6573 204e 4f54 2077 6f72 6b20 666f  does NOT work fo
+00055ec0: 7220 4361 7442 6f6f 7374 206d 6f64 656c  r CatBoost model
+00055ed0: 7321 0d0a 2020 2020 2020 2020 2020 2020  s!..            
+00055ee0: 2020 2020 2020 2020 2020 2020 6578 706c              expl
+00055ef0: 6169 6e65 7220 3d20 7368 6170 2e54 7265  ainer = shap.Tre
+00055f00: 6545 7870 6c61 696e 6572 2870 6c6f 745f  eExplainer(plot_
+00055f10: 6d6f 6465 6c29 0d0a 2020 2020 2020 2020  model)..        
 00055f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055f30: 2020 2020 2073 6861 705f 7661 6c75 6573       shap_values
-00055f40: 203d 2065 7870 6c61 696e 6572 2e73 6861   = explainer.sha
-00055f50: 705f 7661 6c75 6573 2858 5f70 6c6f 7429  p_values(X_plot)
-00055f60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00055f70: 2020 2020 2020 2020 2020 706c 742e 6669            plt.fi
-00055f80: 6775 7265 2829 0d0a 2020 2020 2020 2020  gure()..        
-00055f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055fa0: 7368 6170 2e73 756d 6d61 7279 5f70 6c6f  shap.summary_plo
-00055fb0: 7428 7368 6170 5f76 616c 7565 732c 2058  t(shap_values, X
-00055fc0: 5f70 6c6f 742c 2070 6c6f 745f 7479 7065  _plot, plot_type
-00055fd0: 3d22 6261 7222 290d 0a20 2020 2020 2020  ="bar")..       
-00055fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055ff0: 2069 6620 6d6f 6465 6c74 7970 6520 213d   if modeltype !=
-00056000: 2027 5265 6772 6573 7369 6f6e 273a 0d0a   'Regression':..
+00055f30: 7368 6170 5f76 616c 7565 7320 3d20 6578  shap_values = ex
+00055f40: 706c 6169 6e65 722e 7368 6170 5f76 616c  plainer.shap_val
+00055f50: 7565 7328 585f 706c 6f74 290d 0a20 2020  ues(X_plot)..   
+00055f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00055f70: 2020 2020 2070 6c74 2e66 6967 7572 6528       plt.figure(
+00055f80: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00055f90: 2020 2020 2020 2020 2020 2073 6861 702e             shap.
+00055fa0: 7375 6d6d 6172 795f 706c 6f74 2873 6861  summary_plot(sha
+00055fb0: 705f 7661 6c75 6573 2c20 585f 706c 6f74  p_values, X_plot
+00055fc0: 2c20 706c 6f74 5f74 7970 653d 2262 6172  , plot_type="bar
+00055fd0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+00055fe0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+00055ff0: 6f64 656c 7479 7065 2021 3d20 2752 6567  odeltype != 'Reg
+00056000: 7265 7373 696f 6e27 3a0d 0a20 2020 2020  ression':..     
 00056010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056020: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
-00056030: 6669 6775 7265 2829 0d0a 2020 2020 2020  figure()..      
+00056020: 2020 2020 2020 2070 6c74 2e66 6967 7572         plt.figur
+00056030: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
 00056040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056050: 2020 2020 2020 7368 6170 2e73 756d 6d61        shap.summa
-00056060: 7279 5f70 6c6f 7428 7368 6170 5f76 616c  ry_plot(shap_val
-00056070: 7565 732c 2058 5f70 6c6f 7429 0d0a 2020  ues, X_plot)..  
-00056080: 2020 2020 2020 2020 2020 6578 6365 7074            except
-00056090: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000560a0: 2020 2070 7269 6e74 2827 436f 756c 6420     print('Could 
-000560b0: 6e6f 7420 706c 6f74 2053 4841 5020 7661  not plot SHAP va
-000560c0: 6c75 6573 2073 696e 6365 2053 4841 5020  lues since SHAP 
-000560d0: 6973 206e 6f74 2069 6e73 7461 6c6c 6564  is not installed
-000560e0: 206f 7220 636f 756c 6420 6e6f 7420 696d   or could not im
-000560f0: 706f 7274 2053 4841 5020 696e 2074 6869  port SHAP in thi
-00056100: 7320 6d61 6368 696e 6527 290d 0a20 2020  s machine')..   
-00056110: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00056120: 2323 2323 2323 2323 2323 2323 204e 6f20  ############ No 
-00056130: 506c 6f74 7469 6e67 2066 6561 7475 7265  Plotting feature
-00056140: 2069 6d70 6f72 7461 6e63 6573 2066 6f72   importances for
-00056150: 204d 756c 7469 2d4c 6162 656c 2070 726f   Multi-Label pro
-00056160: 626c 656d 7320 2323 2323 2323 2323 2323  blems ##########
-00056170: 2323 2323 0d0a 2020 2020 2020 2020 7072  ####..        pr
-00056180: 696e 7428 2720 2020 204e 6f20 6665 6174  int('    No feat
-00056190: 7572 6520 696d 706f 7274 616e 6365 2070  ure importance p
-000561a0: 6c6f 7473 2061 7661 696c 6162 6c65 2066  lots available f
-000561b0: 6f72 204d 756c 7469 2d4c 6162 656c 2070  or Multi-Label p
-000561c0: 726f 626c 656d 7327 290d 0a20 2020 2070  roblems')..    p
-000561d0: 7269 6e74 2827 2323 2323 2323 2323 2323  rint('##########
-000561e0: 2323 2323 2320 5020 5220 4520 4420 4920  ##### P R E D I 
-000561f0: 4320 5420 4920 4f20 4e20 204f 204e 2020  C T I O N  O N  
-00056200: 5420 4520 5320 5420 2020 4320 4f20 4d20  T E S T   C O M 
-00056210: 5020 4c20 4520 5420 4520 4420 2023 2323  P L E T E D  ###
-00056220: 2323 2323 2323 2323 2323 2323 2323 2729  ##############')
-00056230: 0d0a 2020 2020 7072 696e 7428 2720 2020  ..    print('   
-00056240: 2054 696d 6520 7461 6b65 6e20 7468 7573   Time taken thus
-00056250: 2066 6172 2028 696e 2073 6563 6f6e 6473   far (in seconds
-00056260: 2920 3d20 2530 2e30 6627 2025 2874 696d  ) = %0.0f' %(tim
-00056270: 652e 7469 6d65 2829 2d73 7461 7274 5f74  e.time()-start_t
-00056280: 696d 6529 290d 0a20 2020 2023 2320 2057  ime))..    ##  W
-00056290: 7269 7465 2074 6865 2074 6573 7420 616e  rite the test an
-000562a0: 6420 7375 626d 6973 7369 6f6e 2066 696c  d submission fil
-000562b0: 6573 2074 6f20 6469 736b 2023 2323 0d0a  es to disk ###..
-000562c0: 2020 2020 7072 696e 7428 2757 7269 7469      print('Writi
-000562d0: 6e67 204f 7574 7075 7420 6669 6c65 7320  ng Output files 
-000562e0: 746f 2064 6973 6b2e 2e2e 2729 0d0a 2020  to disk...')..  
-000562f0: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
+00056050: 2073 6861 702e 7375 6d6d 6172 795f 706c   shap.summary_pl
+00056060: 6f74 2873 6861 705f 7661 6c75 6573 2c20  ot(shap_values, 
+00056070: 585f 706c 6f74 290d 0a20 2020 2020 2020  X_plot)..       
+00056080: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
+00056090: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+000560a0: 696e 7428 2743 6f75 6c64 206e 6f74 2070  int('Could not p
+000560b0: 6c6f 7420 5348 4150 2076 616c 7565 7320  lot SHAP values 
+000560c0: 7369 6e63 6520 5348 4150 2069 7320 6e6f  since SHAP is no
+000560d0: 7420 696e 7374 616c 6c65 6420 6f72 2063  t installed or c
+000560e0: 6f75 6c64 206e 6f74 2069 6d70 6f72 7420  ould not import 
+000560f0: 5348 4150 2069 6e20 7468 6973 206d 6163  SHAP in this mac
+00056100: 6869 6e65 2729 0d0a 2020 2020 656c 7365  hine')..    else
+00056110: 3a0d 0a20 2020 2020 2020 2023 2323 2323  :..        #####
+00056120: 2323 2323 2323 2320 4e6f 2050 6c6f 7474  ####### No Plott
+00056130: 696e 6720 6665 6174 7572 6520 696d 706f  ing feature impo
+00056140: 7274 616e 6365 7320 666f 7220 4d75 6c74  rtances for Mult
+00056150: 692d 4c61 6265 6c20 7072 6f62 6c65 6d73  i-Label problems
+00056160: 2023 2323 2323 2323 2323 2323 2323 230d   ##############.
+00056170: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
+00056180: 2020 2020 4e6f 2066 6561 7475 7265 2069      No feature i
+00056190: 6d70 6f72 7461 6e63 6520 706c 6f74 7320  mportance plots 
+000561a0: 6176 6169 6c61 626c 6520 666f 7220 4d75  available for Mu
+000561b0: 6c74 692d 4c61 6265 6c20 7072 6f62 6c65  lti-Label proble
+000561c0: 6d73 2729 0d0a 2020 2020 7072 696e 7428  ms')..    print(
+000561d0: 2723 2323 2323 2323 2323 2323 2323 2323  '###############
+000561e0: 2050 2052 2045 2044 2049 2043 2054 2049   P R E D I C T I
+000561f0: 204f 204e 2020 4f20 4e20 2054 2045 2053   O N  O N  T E S
+00056200: 2054 2020 2043 204f 204d 2050 204c 2045   T   C O M P L E
+00056210: 2054 2045 2044 2020 2323 2323 2323 2323   T E D  ########
+00056220: 2323 2323 2323 2323 2327 290d 0a20 2020  #########')..   
+00056230: 2070 7269 6e74 2827 2020 2020 5469 6d65   print('    Time
+00056240: 2074 616b 656e 2074 6875 7320 6661 7220   taken thus far 
+00056250: 2869 6e20 7365 636f 6e64 7329 203d 2025  (in seconds) = %
+00056260: 302e 3066 2720 2528 7469 6d65 2e74 696d  0.0f' %(time.tim
+00056270: 6528 292d 7374 6172 745f 7469 6d65 2929  e()-start_time))
+00056280: 0d0a 2020 2020 2323 2020 5772 6974 6520  ..    ##  Write 
+00056290: 7468 6520 7465 7374 2061 6e64 2073 7562  the test and sub
+000562a0: 6d69 7373 696f 6e20 6669 6c65 7320 746f  mission files to
+000562b0: 2064 6973 6b20 2323 230d 0a20 2020 2070   disk ###..    p
+000562c0: 7269 6e74 2827 5772 6974 696e 6720 4f75  rint('Writing Ou
+000562d0: 7470 7574 2066 696c 6573 2074 6f20 6469  tput files to di
+000562e0: 736b 2e2e 2e27 290d 0a20 2020 2023 2323  sk...')..    ###
+000562f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00056300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00056310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00056320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00056330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056340: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00056350: 0a20 2020 2069 6620 6e6f 7420 6973 696e  .    if not isin
-00056360: 7374 616e 6365 2874 6573 746d 2c20 7374  stance(testm, st
-00056370: 7229 3a0d 0a20 2020 2020 2020 2074 7279  r):..        try
-00056380: 3a0d 0a20 2020 2020 2020 2020 2020 2077  :..            w
-00056390: 7269 7465 5f66 696c 655f 746f 5f66 6f6c  rite_file_to_fol
-000563a0: 6465 7228 7465 7374 6d2c 2065 6163 685f  der(testm, each_
-000563b0: 7461 7267 6574 2c20 6561 6368 5f74 6172  target, each_tar
-000563c0: 6765 742b 275f 272b 6d6f 6465 6c74 7970  get+'_'+modeltyp
-000563d0: 652b 275f 272b 2774 6573 745f 6d6f 6469  e+'_'+'test_modi
-000563e0: 6669 6564 2e63 7376 2729 0d0a 2020 2020  fied.csv')..    
-000563f0: 2020 2020 2020 2020 2323 2323 2320 2020          #####   
-00056400: 4420 5220 4120 5720 2020 4b20 4420 4520  D R A W   K D E 
-00056410: 2050 204c 204f 2054 2053 2020 2046 4f52   P L O T S   FOR
-00056420: 2050 524f 4241 4249 4c49 5459 204f 4620   PROBABILITY OF 
-00056430: 5052 4544 4943 5449 4f4e 5320 2d20 7665  PREDICTIONS - ve
-00056440: 7279 2075 7365 6675 6c21 2023 2323 2323  ry useful! #####
-00056450: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
-00056460: 2020 6966 206d 6f64 656c 7479 7065 2021    if modeltype !
-00056470: 3d20 2752 6567 7265 7373 696f 6e27 3a0d  = 'Regression':.
-00056480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00056490: 2069 6620 7665 7262 6f73 6520 3e3d 2032   if verbose >= 2
-000564a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000564b0: 2020 2020 2020 2074 6573 746d 5b70 726f         testm[pro
-000564c0: 6261 5f63 6f6c 735d 2e70 6c6f 7428 6b69  ba_cols].plot(ki
-000564d0: 6e64 3d27 6b64 6527 2c66 6967 7369 7a65  nd='kde',figsize
-000564e0: 3d28 3130 2c36 292c 0d0a 2020 2020 2020  =(10,6),..      
+00056340: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+00056350: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00056360: 6528 7465 7374 6d2c 2073 7472 293a 0d0a  e(testm, str):..
+00056370: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
+00056380: 2020 2020 2020 2020 2020 7772 6974 655f            write_
+00056390: 6669 6c65 5f74 6f5f 666f 6c64 6572 2874  file_to_folder(t
+000563a0: 6573 746d 2c20 6561 6368 5f74 6172 6765  estm, each_targe
+000563b0: 742c 2065 6163 685f 7461 7267 6574 2b27  t, each_target+'
+000563c0: 5f27 2b6d 6f64 656c 7479 7065 2b27 5f27  _'+modeltype+'_'
+000563d0: 2b27 7465 7374 5f6d 6f64 6966 6965 642e  +'test_modified.
+000563e0: 6373 7627 290d 0a20 2020 2020 2020 2020  csv')..         
+000563f0: 2020 2023 2323 2323 2020 2044 2052 2041     #####   D R A
+00056400: 2057 2020 204b 2044 2045 2020 5020 4c20   W   K D E  P L 
+00056410: 4f20 5420 5320 2020 464f 5220 5052 4f42  O T S   FOR PROB
+00056420: 4142 494c 4954 5920 4f46 2050 5245 4449  ABILITY OF PREDI
+00056430: 4354 494f 4e53 202d 2076 6572 7920 7573  CTIONS - very us
+00056440: 6566 756c 2120 2323 2323 2323 2323 230d  eful! #########.
+00056450: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00056460: 6d6f 6465 6c74 7970 6520 213d 2027 5265  modeltype != 'Re
+00056470: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
+00056480: 2020 2020 2020 2020 2020 2020 6966 2076              if v
+00056490: 6572 626f 7365 203e 3d20 323a 0d0a 2020  erbose >= 2:..  
+000564a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000564b0: 2020 7465 7374 6d5b 7072 6f62 615f 636f    testm[proba_co
+000564c0: 6c73 5d2e 706c 6f74 286b 696e 643d 276b  ls].plot(kind='k
+000564d0: 6465 272c 6669 6773 697a 653d 2831 302c  de',figsize=(10,
+000564e0: 3629 2c0d 0a20 2020 2020 2020 2020 2020  6),..           
 000564f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056500: 2020 2020 2020 2020 2020 2020 2020 7469                ti
-00056510: 746c 653d 2750 7265 6469 6374 6976 6520  tle='Predictive 
-00056520: 5072 6f62 6162 696c 6974 7920 4465 6e73  Probability Dens
-00056530: 6974 7920 4368 6172 7420 7769 7468 2073  ity Chart with s
-00056540: 7567 6765 7374 6564 2074 6872 6573 686f  uggested thresho
-00056550: 6c64 2069 6e20 7265 6427 290d 0a20 2020  ld in red')..   
-00056560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056570: 2070 6c74 2e61 7876 6c69 6e65 2878 3d6d   plt.axvline(x=m
-00056580: 5f74 6872 6573 682c 2063 6f6c 6f72 3d27  _thresh, color='
-00056590: 7227 2c20 6c69 6e65 7374 796c 653d 272d  r', linestyle='-
-000565a0: 2d27 293b 0d0a 2020 2020 2020 2020 6578  -');..        ex
-000565b0: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
-000565c0: 2020 2070 7269 6e74 2827 2020 2020 4572     print('    Er
-000565d0: 726f 723a 204e 6f74 2061 626c 6520 746f  ror: Not able to
-000565e0: 2073 6176 6520 7465 7374 206d 6f64 6966   save test modif
-000565f0: 6965 6420 6669 6c65 2e20 536b 6970 7069  ied file. Skippi
-00056600: 6e67 2e2e 2e27 290d 0a20 2020 2023 2323  ng...')..    ###
+00056500: 2020 2020 2020 2020 2074 6974 6c65 3d27           title='
+00056510: 5072 6564 6963 7469 7665 2050 726f 6261  Predictive Proba
+00056520: 6269 6c69 7479 2044 656e 7369 7479 2043  bility Density C
+00056530: 6861 7274 2077 6974 6820 7375 6767 6573  hart with sugges
+00056540: 7465 6420 7468 7265 7368 6f6c 6420 696e  ted threshold in
+00056550: 2072 6564 2729 0d0a 2020 2020 2020 2020   red')..        
+00056560: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
+00056570: 6178 766c 696e 6528 783d 6d5f 7468 7265  axvline(x=m_thre
+00056580: 7368 2c20 636f 6c6f 723d 2772 272c 206c  sh, color='r', l
+00056590: 696e 6573 7479 6c65 3d27 2d2d 2729 3b0d  inestyle='--');.
+000565a0: 0a20 2020 2020 2020 2065 7863 6570 743a  .        except:
+000565b0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+000565c0: 696e 7428 2720 2020 2045 7272 6f72 3a20  int('    Error: 
+000565d0: 4e6f 7420 6162 6c65 2074 6f20 7361 7665  Not able to save
+000565e0: 2074 6573 7420 6d6f 6469 6669 6564 2066   test modified f
+000565f0: 696c 652e 2053 6b69 7070 696e 672e 2e2e  ile. Skipping...
+00056600: 2729 0d0a 2020 2020 2323 2323 2323 2323  ')..    ########
 00056610: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00056620: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00056630: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00056640: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00056650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056660: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-00056670: 6966 2069 7369 6e73 7461 6e63 6528 7361  if isinstance(sa
-00056680: 6d70 6c65 5f73 7562 6d69 7373 696f 6e2c  mple_submission,
-00056690: 2073 7472 293a 0d0a 2020 2020 2020 2020   str):..        
-000566a0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-000566b0: 2020 6966 206c 656e 2869 645f 636f 6c73    if len(id_cols
-000566c0: 2920 3e20 303a 0d0a 2020 2020 2020 2020  ) > 0:..        
-000566d0: 2020 2020 2020 2020 7361 6d70 6c65 5f73          sample_s
-000566e0: 7562 6d69 7373 696f 6e20 3d20 7465 7374  ubmission = test
-000566f0: 6d5b 6964 5f63 6f6c 735d 0d0a 2020 2020  m[id_cols]..    
-00056700: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00056710: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00056720: 616d 706c 655f 7375 626d 6973 7369 6f6e  ample_submission
-00056730: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
-00056740: 696e 6465 783d 7465 7374 6d2e 696e 6465  index=testm.inde
-00056750: 782c 636f 6c75 6d6e 733d 5b5d 290d 0a20  x,columns=[]).. 
-00056760: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-00056770: 6e28 7461 7267 6574 2920 3d3d 2031 3a0d  n(target) == 1:.
-00056780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00056790: 2020 2020 2073 616d 706c 655f 7375 626d       sample_subm
-000567a0: 6973 7369 6f6e 5b65 6163 685f 7461 7267  ission[each_targ
-000567b0: 6574 5d20 3d20 7465 7374 6d5b 6561 6368  et] = testm[each
-000567c0: 5f74 6172 6765 742b 275f 7072 6564 6963  _target+'_predic
-000567d0: 7469 6f6e 7327 5d0d 0a20 2020 2020 2020  tions']..       
-000567e0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-000567f0: 2020 2020 2020 2020 2020 2020 7072 6564              pred
-00056800: 6963 745f 636f 6c73 203d 205b 782b 275f  ict_cols = [x+'_
-00056810: 7072 6564 6963 7469 6f6e 7327 2066 6f72  predictions' for
-00056820: 2078 2069 6e20 7461 7267 6574 5d0d 0a20   x in target].. 
-00056830: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00056840: 6f72 2070 7265 6469 6374 5f63 6f6c 2c20  or predict_col, 
-00056850: 7461 7267 6574 5f63 6f6c 2069 6e20 7a69  target_col in zi
-00056860: 7028 7072 6564 6963 745f 636f 6c73 2c20  p(predict_cols, 
-00056870: 7461 7267 6574 293a 0d0a 2020 2020 2020  target):..      
-00056880: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-00056890: 6d70 6c65 5f73 7562 6d69 7373 696f 6e5b  mple_submission[
-000568a0: 7461 7267 6574 5f63 6f6c 5d20 3d20 7465  target_col] = te
-000568b0: 7374 6d5b 7072 6564 6963 745f 636f 6c5d  stm[predict_col]
-000568c0: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
-000568d0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-000568e0: 7269 6e74 2827 4572 726f 723a 2043 6f75  rint('Error: Cou
-000568f0: 6c64 206e 6f74 2063 7265 6174 6520 7361  ld not create sa
-00056900: 6d70 6c65 2073 7562 6d69 7373 696f 6e20  mple submission 
-00056910: 6669 6c65 2066 726f 6d20 5465 7374 2064  file from Test d
-00056920: 6174 6127 290d 0a20 2020 2074 7279 3a0d  ata')..    try:.
-00056930: 0a20 2020 2020 2020 2077 7269 7465 5f66  .        write_f
-00056940: 696c 655f 746f 5f66 6f6c 6465 7228 7361  ile_to_folder(sa
-00056950: 6d70 6c65 5f73 7562 6d69 7373 696f 6e2c  mple_submission,
-00056960: 2065 6163 685f 7461 7267 6574 2c20 6561   each_target, ea
-00056970: 6368 5f74 6172 6765 742b 275f 272b 6d6f  ch_target+'_'+mo
-00056980: 6465 6c74 7970 652b 275f 272b 2773 7562  deltype+'_'+'sub
-00056990: 6d69 7373 696f 6e2e 6373 7627 290d 0a20  mission.csv').. 
-000569a0: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
-000569b0: 2020 2020 7072 696e 7428 2720 2020 2045      print('    E
-000569c0: 7272 6f72 3a20 4e6f 7420 6162 6c65 2074  rror: Not able t
-000569d0: 6f20 7361 7665 2073 7562 6d69 7373 696f  o save submissio
-000569e0: 6e20 6669 6c65 2e20 536b 6970 7069 6e67  n file. Skipping
-000569f0: 2e2e 2e27 290d 0a20 2020 2023 2323 2323  ...')..    #####
+00056660: 2323 2323 230d 0a20 2020 2069 6620 6973  #####..    if is
+00056670: 696e 7374 616e 6365 2873 616d 706c 655f  instance(sample_
+00056680: 7375 626d 6973 7369 6f6e 2c20 7374 7229  submission, str)
+00056690: 3a0d 0a20 2020 2020 2020 2074 7279 3a0d  :..        try:.
+000566a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000566b0: 6c65 6e28 6964 5f63 6f6c 7329 203e 2030  len(id_cols) > 0
+000566c0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000566d0: 2020 2073 616d 706c 655f 7375 626d 6973     sample_submis
+000566e0: 7369 6f6e 203d 2074 6573 746d 5b69 645f  sion = testm[id_
+000566f0: 636f 6c73 5d0d 0a20 2020 2020 2020 2020  cols]..         
+00056700: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00056710: 2020 2020 2020 2020 2020 7361 6d70 6c65            sample
+00056720: 5f73 7562 6d69 7373 696f 6e20 3d20 7064  _submission = pd
+00056730: 2e44 6174 6146 7261 6d65 2869 6e64 6578  .DataFrame(index
+00056740: 3d74 6573 746d 2e69 6e64 6578 2c63 6f6c  =testm.index,col
+00056750: 756d 6e73 3d5b 5d29 0d0a 2020 2020 2020  umns=[])..      
+00056760: 2020 2020 2020 6966 206c 656e 2874 6172        if len(tar
+00056770: 6765 7429 203d 3d20 313a 0d0a 2020 2020  get) == 1:..    
+00056780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00056790: 7361 6d70 6c65 5f73 7562 6d69 7373 696f  sample_submissio
+000567a0: 6e5b 6561 6368 5f74 6172 6765 745d 203d  n[each_target] =
+000567b0: 2074 6573 746d 5b65 6163 685f 7461 7267   testm[each_targ
+000567c0: 6574 2b27 5f70 7265 6469 6374 696f 6e73  et+'_predictions
+000567d0: 275d 0d0a 2020 2020 2020 2020 2020 2020  ']..            
+000567e0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+000567f0: 2020 2020 2020 2070 7265 6469 6374 5f63         predict_c
+00056800: 6f6c 7320 3d20 5b78 2b27 5f70 7265 6469  ols = [x+'_predi
+00056810: 6374 696f 6e73 2720 666f 7220 7820 696e  ctions' for x in
+00056820: 2074 6172 6765 745d 0d0a 2020 2020 2020   target]..      
+00056830: 2020 2020 2020 2020 2020 666f 7220 7072            for pr
+00056840: 6564 6963 745f 636f 6c2c 2074 6172 6765  edict_col, targe
+00056850: 745f 636f 6c20 696e 207a 6970 2870 7265  t_col in zip(pre
+00056860: 6469 6374 5f63 6f6c 732c 2074 6172 6765  dict_cols, targe
+00056870: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
+00056880: 2020 2020 2020 2020 2073 616d 706c 655f           sample_
+00056890: 7375 626d 6973 7369 6f6e 5b74 6172 6765  submission[targe
+000568a0: 745f 636f 6c5d 203d 2074 6573 746d 5b70  t_col] = testm[p
+000568b0: 7265 6469 6374 5f63 6f6c 5d0d 0a20 2020  redict_col]..   
+000568c0: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
+000568d0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+000568e0: 2745 7272 6f72 3a20 436f 756c 6420 6e6f  'Error: Could no
+000568f0: 7420 6372 6561 7465 2073 616d 706c 6520  t create sample 
+00056900: 7375 626d 6973 7369 6f6e 2066 696c 6520  submission file 
+00056910: 6672 6f6d 2054 6573 7420 6461 7461 2729  from Test data')
+00056920: 0d0a 2020 2020 7472 793a 0d0a 2020 2020  ..    try:..    
+00056930: 2020 2020 7772 6974 655f 6669 6c65 5f74      write_file_t
+00056940: 6f5f 666f 6c64 6572 2873 616d 706c 655f  o_folder(sample_
+00056950: 7375 626d 6973 7369 6f6e 2c20 6561 6368  submission, each
+00056960: 5f74 6172 6765 742c 2065 6163 685f 7461  _target, each_ta
+00056970: 7267 6574 2b27 5f27 2b6d 6f64 656c 7479  rget+'_'+modelty
+00056980: 7065 2b27 5f27 2b27 7375 626d 6973 7369  pe+'_'+'submissi
+00056990: 6f6e 2e63 7376 2729 0d0a 2020 2020 6578  on.csv')..    ex
+000569a0: 6365 7074 3a0d 0a20 2020 2020 2020 2070  cept:..        p
+000569b0: 7269 6e74 2827 2020 2020 4572 726f 723a  rint('    Error:
+000569c0: 204e 6f74 2061 626c 6520 746f 2073 6176   Not able to sav
+000569d0: 6520 7375 626d 6973 7369 6f6e 2066 696c  e submission fil
+000569e0: 652e 2053 6b69 7070 696e 672e 2e2e 2729  e. Skipping...')
+000569f0: 0d0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
 00056a00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00056a10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00056a20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00056a30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00056a40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00056a50: 2323 2323 2323 2323 0d0a 2020 2020 7472  ########..    tr
-00056a60: 793a 0d0a 2020 2020 2020 2020 2323 2323  y:..        ####
-00056a70: 2042 7269 6e67 2074 7261 696e 6d20 6261   Bring trainm ba
-00056a80: 636b 2074 6f20 6974 7320 6f72 6967 696e  ck to its origin
-00056a90: 616c 2069 6e64 6578 2023 2323 2323 2323  al index #######
-00056aa0: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
-00056ab0: 2020 2020 2020 6f72 6967 5f69 6e64 6578        orig_index
-00056ac0: 203d 206f 7269 675f 7472 6169 6e2e 696e   = orig_train.in
-00056ad0: 6465 780d 0a20 2020 2020 2020 2074 7261  dex..        tra
-00056ae0: 696e 6d20 3d20 7472 6169 6e2e 7265 696e  inm = train.rein
-00056af0: 6465 7828 696e 6465 7820 3d20 6f72 6967  dex(index = orig
-00056b00: 5f69 6e64 6578 290d 0a20 2020 2020 2020  _index)..       
-00056b10: 2077 7269 7465 5f66 696c 655f 746f 5f66   write_file_to_f
-00056b20: 6f6c 6465 7228 7472 6169 6e6d 2c20 6561  older(trainm, ea
-00056b30: 6368 5f74 6172 6765 742c 2065 6163 685f  ch_target, each_
-00056b40: 7461 7267 6574 2b27 5f27 2b6d 6f64 656c  target+'_'+model
-00056b50: 7479 7065 2b27 5f27 2b27 7472 6169 6e5f  type+'_'+'train_
-00056b60: 6d6f 6469 6669 6564 2e63 7376 2729 0d0a  modified.csv')..
-00056b70: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
-00056b80: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-00056b90: 4572 726f 723a 204e 6f74 2061 626c 6520  Error: Not able 
-00056ba0: 746f 2073 6176 6520 7472 6169 6e20 6d6f  to save train mo
-00056bb0: 6469 6669 6564 2066 696c 652e 2053 6b69  dified file. Ski
-00056bc0: 7070 696e 672e 2e2e 2729 0d0a 2020 2020  pping...')..    
-00056bd0: 2323 2320 496e 2063 6173 6520 6f66 206d  ### In case of m
-00056be0: 756c 7469 2d6c 6162 656c 206d 6f64 656c  ulti-label model
-00056bf0: 732c 2077 6520 7769 6c6c 2072 6573 6574  s, we will reset
-00056c00: 2074 6865 2073 7461 7274 2074 7261 696e   the start train
-00056c10: 2061 6e64 2074 6573 7420 6461 7461 6672   and test datafr
-00056c20: 616d 6573 2074 6f20 636f 6e74 6169 6e20  ames to contain 
-00056c30: 6e65 7720 6665 6174 7572 6573 2063 7265  new features cre
-00056c40: 6174 6564 0d0a 2020 2020 7374 6172 745f  ated..    start_
-00056c50: 7472 6169 6e20 3d20 7374 6172 745f 7472  train = start_tr
-00056c60: 6169 6e5b 7461 7267 6574 5d2e 6a6f 696e  ain[target].join
-00056c70: 2873 7461 7274 5f74 7261 696e 5b6f 7269  (start_train[ori
-00056c80: 675f 7265 645f 7072 6564 735d 290d 0a20  g_red_preds]).. 
-00056c90: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-00056ca0: 616e 6365 286f 7269 675f 7465 7374 2c20  ance(orig_test, 
-00056cb0: 7374 7229 3a0d 0a20 2020 2020 2020 2073  str):..        s
-00056cc0: 7461 7274 5f74 6573 7420 3d20 7374 6172  tart_test = star
-00056cd0: 745f 7465 7374 5b6f 7269 675f 7265 645f  t_test[orig_red_
-00056ce0: 7072 6564 735d 0d0a 2020 2020 2323 2323  preds]..    ####
-00056cf0: 204f 6e63 6520 6561 6368 2074 6172 6765   Once each targe
-00056d00: 7420 6379 636c 6520 6973 206f 7665 722c  t cycle is over,
-00056d10: 2072 6573 6574 2074 6865 2072 6564 5f70   reset the red_p
-00056d20: 7265 6473 2074 6f20 7468 6520 6f72 6967  reds to the orig
-00056d30: 5f72 6564 5f70 7265 6473 2073 6f20 7765  _red_preds so we
-00056d40: 2063 616e 2073 7461 7274 206f 7665 720d   can start over.
-00056d50: 0a20 2020 2023 7265 645f 7072 6564 7320  .    #red_preds 
-00056d60: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
-00056d70: 6f72 6967 5f72 6564 5f70 7265 6473 290d  orig_red_preds).
-00056d80: 0a20 2020 2069 6620 6d6f 6465 6c5f 6c61  .    if model_la
-00056d90: 6265 6c20 213d 2027 5369 6e67 6c65 5f4c  bel != 'Single_L
-00056da0: 6162 656c 273a 0d0a 2020 2020 2020 2020  abel':..        
-00056db0: 2323 2323 2050 6572 666f 726d 2046 696e  #### Perform Fin
-00056dc0: 616c 204d 756c 7469 2d4c 6162 656c 204f  al Multi-Label O
-00056dd0: 7065 7261 7469 6f6e 7320 6865 7265 2073  perations here s
-00056de0: 696e 6365 2061 6c6c 204c 6162 656c 7320  ince all Labels 
-00056df0: 6172 6520 6669 6e69 7368 6564 2062 7920  are finished by 
-00056e00: 6e6f 7720 2323 230d 0a20 2020 2020 2020  now ###..       
-00056e10: 2023 2323 2320 446f 6e27 7420 6368 616e   #### Don't chan
-00056e20: 6765 2074 6865 2074 6172 6765 7420 6865  ge the target he
-00056e30: 7265 2074 6f20 6561 6368 5f74 6172 6765  re to each_targe
-00056e40: 7420 7369 6e63 6520 7468 6973 2069 7320  t since this is 
-00056e50: 666f 7220 6d75 6c74 692d 6c61 6265 6c20  for multi-label 
-00056e60: 7369 7475 6174 696f 6e73 206f 6e6c 7920  situations only 
-00056e70: 2323 230d 0a20 2020 2020 2020 2069 6620  ###..        if 
-00056e80: 2873 636f 7269 6e67 5f70 6172 616d 6574  (scoring_paramet
-00056e90: 6572 203d 3d20 2762 6173 6b65 745f 7265  er == 'basket_re
-00056ea0: 6361 6c6c 2720 6f72 2073 636f 7269 6e67  call' or scoring
-00056eb0: 5f70 6172 616d 6574 6572 203d 3d20 276a  _parameter == 'j
-00056ec0: 6163 6361 7264 2729 2061 6e64 206d 6f64  accard') and mod
-00056ed0: 656c 7479 7065 2021 3d20 2752 6567 7265  eltype != 'Regre
-00056ee0: 7373 696f 6e27 3a0d 0a20 2020 2020 2020  ssion':..       
-00056ef0: 2020 2020 2079 5f70 7265 6473 203d 206e       y_preds = n
-00056f00: 702e 6172 7261 7928 6c69 7374 287a 6970  p.array(list(zip
-00056f10: 7065 6429 290d 0a20 2020 2020 2020 2020  ped))..         
-00056f20: 2020 205f 2c5f 2c5f 2c79 5f61 6374 7561     _,_,_,y_actua
-00056f30: 6c73 203d 2074 7261 696e 5f74 6573 745f  ls = train_test_
-00056f40: 7370 6c69 7428 7472 6169 6e5b 7265 645f  split(train[red_
-00056f50: 7072 6564 735d 2c20 7472 6169 6e5b 7461  preds], train[ta
-00056f60: 7267 6574 5d2e 7661 6c75 6573 2c0d 0a20  rget].values,.. 
+00056a50: 2323 230d 0a20 2020 2074 7279 3a0d 0a20  ###..    try:.. 
+00056a60: 2020 2020 2020 2023 2323 2320 4272 696e         #### Brin
+00056a70: 6720 7472 6169 6e6d 2062 6163 6b20 746f  g trainm back to
+00056a80: 2069 7473 206f 7269 6769 6e61 6c20 696e   its original in
+00056a90: 6465 7820 2323 2323 2323 2323 2323 2323  dex ############
+00056aa0: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
+00056ab0: 206f 7269 675f 696e 6465 7820 3d20 6f72   orig_index = or
+00056ac0: 6967 5f74 7261 696e 2e69 6e64 6578 0d0a  ig_train.index..
+00056ad0: 2020 2020 2020 2020 7472 6169 6e6d 203d          trainm =
+00056ae0: 2074 7261 696e 2e72 6569 6e64 6578 2869   train.reindex(i
+00056af0: 6e64 6578 203d 206f 7269 675f 696e 6465  ndex = orig_inde
+00056b00: 7829 0d0a 2020 2020 2020 2020 7772 6974  x)..        writ
+00056b10: 655f 6669 6c65 5f74 6f5f 666f 6c64 6572  e_file_to_folder
+00056b20: 2874 7261 696e 6d2c 2065 6163 685f 7461  (trainm, each_ta
+00056b30: 7267 6574 2c20 6561 6368 5f74 6172 6765  rget, each_targe
+00056b40: 742b 275f 272b 6d6f 6465 6c74 7970 652b  t+'_'+modeltype+
+00056b50: 275f 272b 2774 7261 696e 5f6d 6f64 6966  '_'+'train_modif
+00056b60: 6965 642e 6373 7627 290d 0a20 2020 2065  ied.csv')..    e
+00056b70: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
+00056b80: 7072 696e 7428 2720 2020 2045 7272 6f72  print('    Error
+00056b90: 3a20 4e6f 7420 6162 6c65 2074 6f20 7361  : Not able to sa
+00056ba0: 7665 2074 7261 696e 206d 6f64 6966 6965  ve train modifie
+00056bb0: 6420 6669 6c65 2e20 536b 6970 7069 6e67  d file. Skipping
+00056bc0: 2e2e 2e27 290d 0a20 2020 2023 2323 2049  ...')..    ### I
+00056bd0: 6e20 6361 7365 206f 6620 6d75 6c74 692d  n case of multi-
+00056be0: 6c61 6265 6c20 6d6f 6465 6c73 2c20 7765  label models, we
+00056bf0: 2077 696c 6c20 7265 7365 7420 7468 6520   will reset the 
+00056c00: 7374 6172 7420 7472 6169 6e20 616e 6420  start train and 
+00056c10: 7465 7374 2064 6174 6166 7261 6d65 7320  test dataframes 
+00056c20: 746f 2063 6f6e 7461 696e 206e 6577 2066  to contain new f
+00056c30: 6561 7475 7265 7320 6372 6561 7465 640d  eatures created.
+00056c40: 0a20 2020 2073 7461 7274 5f74 7261 696e  .    start_train
+00056c50: 203d 2073 7461 7274 5f74 7261 696e 5b74   = start_train[t
+00056c60: 6172 6765 745d 2e6a 6f69 6e28 7374 6172  arget].join(star
+00056c70: 745f 7472 6169 6e5b 6f72 6967 5f72 6564  t_train[orig_red
+00056c80: 5f70 7265 6473 5d29 0d0a 2020 2020 6966  _preds])..    if
+00056c90: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00056ca0: 6f72 6967 5f74 6573 742c 2073 7472 293a  orig_test, str):
+00056cb0: 0d0a 2020 2020 2020 2020 7374 6172 745f  ..        start_
+00056cc0: 7465 7374 203d 2073 7461 7274 5f74 6573  test = start_tes
+00056cd0: 745b 6f72 6967 5f72 6564 5f70 7265 6473  t[orig_red_preds
+00056ce0: 5d0d 0a20 2020 2023 2323 2320 4f6e 6365  ]..    #### Once
+00056cf0: 2065 6163 6820 7461 7267 6574 2063 7963   each target cyc
+00056d00: 6c65 2069 7320 6f76 6572 2c20 7265 7365  le is over, rese
+00056d10: 7420 7468 6520 7265 645f 7072 6564 7320  t the red_preds 
+00056d20: 746f 2074 6865 206f 7269 675f 7265 645f  to the orig_red_
+00056d30: 7072 6564 7320 736f 2077 6520 6361 6e20  preds so we can 
+00056d40: 7374 6172 7420 6f76 6572 0d0a 2020 2020  start over..    
+00056d50: 2372 6564 5f70 7265 6473 203d 2063 6f70  #red_preds = cop
+00056d60: 792e 6465 6570 636f 7079 286f 7269 675f  y.deepcopy(orig_
+00056d70: 7265 645f 7072 6564 7329 0d0a 2020 2020  red_preds)..    
+00056d80: 6966 206d 6f64 656c 5f6c 6162 656c 2021  if model_label !
+00056d90: 3d20 2753 696e 676c 655f 4c61 6265 6c27  = 'Single_Label'
+00056da0: 3a0d 0a20 2020 2020 2020 2023 2323 2320  :..        #### 
+00056db0: 5065 7266 6f72 6d20 4669 6e61 6c20 4d75  Perform Final Mu
+00056dc0: 6c74 692d 4c61 6265 6c20 4f70 6572 6174  lti-Label Operat
+00056dd0: 696f 6e73 2068 6572 6520 7369 6e63 6520  ions here since 
+00056de0: 616c 6c20 4c61 6265 6c73 2061 7265 2066  all Labels are f
+00056df0: 696e 6973 6865 6420 6279 206e 6f77 2023  inished by now #
+00056e00: 2323 0d0a 2020 2020 2020 2020 2323 2323  ##..        ####
+00056e10: 2044 6f6e 2774 2063 6861 6e67 6520 7468   Don't change th
+00056e20: 6520 7461 7267 6574 2068 6572 6520 746f  e target here to
+00056e30: 2065 6163 685f 7461 7267 6574 2073 696e   each_target sin
+00056e40: 6365 2074 6869 7320 6973 2066 6f72 206d  ce this is for m
+00056e50: 756c 7469 2d6c 6162 656c 2073 6974 7561  ulti-label situa
+00056e60: 7469 6f6e 7320 6f6e 6c79 2023 2323 0d0a  tions only ###..
+00056e70: 2020 2020 2020 2020 6966 2028 7363 6f72          if (scor
+00056e80: 696e 675f 7061 7261 6d65 7465 7220 3d3d  ing_parameter ==
+00056e90: 2027 6261 736b 6574 5f72 6563 616c 6c27   'basket_recall'
+00056ea0: 206f 7220 7363 6f72 696e 675f 7061 7261   or scoring_para
+00056eb0: 6d65 7465 7220 3d3d 2027 6a61 6363 6172  meter == 'jaccar
+00056ec0: 6427 2920 616e 6420 6d6f 6465 6c74 7970  d') and modeltyp
+00056ed0: 6520 213d 2027 5265 6772 6573 7369 6f6e  e != 'Regression
+00056ee0: 273a 0d0a 2020 2020 2020 2020 2020 2020  ':..            
+00056ef0: 795f 7072 6564 7320 3d20 6e70 2e61 7272  y_preds = np.arr
+00056f00: 6179 286c 6973 7428 7a69 7070 6564 2929  ay(list(zipped))
+00056f10: 0d0a 2020 2020 2020 2020 2020 2020 5f2c  ..            _,
+00056f20: 5f2c 5f2c 795f 6163 7475 616c 7320 3d20  _,_,y_actuals = 
+00056f30: 7472 6169 6e5f 7465 7374 5f73 706c 6974  train_test_split
+00056f40: 2874 7261 696e 5b72 6564 5f70 7265 6473  (train[red_preds
+00056f50: 5d2c 2074 7261 696e 5b74 6172 6765 745d  ], train[target]
+00056f60: 2e76 616c 7565 732c 0d0a 2020 2020 2020  .values,..      
 00056f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00056f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00056f90: 2020 2020 2020 2074 6573 745f 7369 7a65         test_size
-00056fa0: 3d74 6573 745f 7369 7a65 2c20 7261 6e64  =test_size, rand
-00056fb0: 6f6d 5f73 7461 7465 3d73 6565 6429 0d0a  om_state=seed)..
-00056fc0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00056fd0: 7428 2753 6861 7065 206f 6620 4163 7475  t('Shape of Actu
-00056fe0: 616c 733a 2025 7320 616e 6420 5072 6564  als: %s and Pred
-00056ff0: 733a 2025 7327 2025 2879 5f61 6374 7561  s: %s' %(y_actua
-00057000: 6c73 2e73 6861 7065 5b30 5d2c 2079 5f70  ls.shape[0], y_p
-00057010: 7265 6473 2e73 6861 7065 5b30 5d29 290d  reds.shape[0])).
-00057020: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00057030: 795f 6163 7475 616c 732e 7368 6170 655b  y_actuals.shape[
-00057040: 305d 203d 3d20 795f 7072 6564 732e 7368  0] == y_preds.sh
-00057050: 6170 655b 305d 3a0d 0a20 2020 2020 2020  ape[0]:..       
-00057060: 2020 2020 2020 2020 2069 6620 7363 6f72           if scor
-00057070: 696e 675f 7061 7261 6d65 7465 7220 3d3d  ing_parameter ==
-00057080: 2027 6261 736b 6574 5f72 6563 616c 6c27   'basket_recall'
-00057090: 2061 6e64 206c 656e 2874 6172 6765 7429   and len(target)
-000570a0: 203e 2031 3a0d 0a20 2020 2020 2020 2020   > 1:..         
-000570b0: 2020 2020 2020 2020 2020 2061 6363 755f             accu_
-000570c0: 616c 6c20 3d20 6261 736b 6574 5f72 6563  all = basket_rec
-000570d0: 616c 6c28 795f 6163 7475 616c 732c 2079  all(y_actuals, y
-000570e0: 5f70 7265 6473 292e 6d65 616e 2829 0d0a  _preds).mean()..
-000570f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057100: 2020 2020 7072 696e 7428 2720 2020 2020      print('     
-00057110: 2020 204d 6561 6e20 4261 736b 6574 2052     Mean Basket R
-00057120: 6563 616c 6c20 3d20 7b3a 2c2e 3166 7d25  ecall = {:,.1f}%
-00057130: 272e 666f 726d 6174 280d 0a20 2020 2020  '.format(..     
+00056f90: 2020 7465 7374 5f73 697a 653d 7465 7374    test_size=test
+00056fa0: 5f73 697a 652c 2072 616e 646f 6d5f 7374  _size, random_st
+00056fb0: 6174 653d 7365 6564 290d 0a20 2020 2020  ate=seed)..     
+00056fc0: 2020 2020 2020 2070 7269 6e74 2827 5368         print('Sh
+00056fd0: 6170 6520 6f66 2041 6374 7561 6c73 3a20  ape of Actuals: 
+00056fe0: 2573 2061 6e64 2050 7265 6473 3a20 2573  %s and Preds: %s
+00056ff0: 2720 2528 795f 6163 7475 616c 732e 7368  ' %(y_actuals.sh
+00057000: 6170 655b 305d 2c20 795f 7072 6564 732e  ape[0], y_preds.
+00057010: 7368 6170 655b 305d 2929 0d0a 2020 2020  shape[0]))..    
+00057020: 2020 2020 2020 2020 6966 2079 5f61 6374          if y_act
+00057030: 7561 6c73 2e73 6861 7065 5b30 5d20 3d3d  uals.shape[0] ==
+00057040: 2079 5f70 7265 6473 2e73 6861 7065 5b30   y_preds.shape[0
+00057050: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
+00057060: 2020 2020 6966 2073 636f 7269 6e67 5f70      if scoring_p
+00057070: 6172 616d 6574 6572 203d 3d20 2762 6173  arameter == 'bas
+00057080: 6b65 745f 7265 6361 6c6c 2720 616e 6420  ket_recall' and 
+00057090: 6c65 6e28 7461 7267 6574 2920 3e20 313a  len(target) > 1:
+000570a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000570b0: 2020 2020 2020 6163 6375 5f61 6c6c 203d        accu_all =
+000570c0: 2062 6173 6b65 745f 7265 6361 6c6c 2879   basket_recall(y
+000570d0: 5f61 6374 7561 6c73 2c20 795f 7072 6564  _actuals, y_pred
+000570e0: 7329 2e6d 6561 6e28 290d 0a20 2020 2020  s).mean()..     
+000570f0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00057100: 7269 6e74 2827 2020 2020 2020 2020 4d65  rint('        Me
+00057110: 616e 2042 6173 6b65 7420 5265 6361 6c6c  an Basket Recall
+00057120: 203d 207b 3a2c 2e31 667d 2527 2e66 6f72   = {:,.1f}%'.for
+00057130: 6d61 7428 0d0a 2020 2020 2020 2020 2020  mat(..          
 00057140: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00057150: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00057160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00057170: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00057180: 6363 755f 616c 6c2a 3130 3029 290d 0a20  ccu_all*100)).. 
-00057190: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000571a0: 6c69 6620 7363 6f72 696e 675f 7061 7261  lif scoring_para
-000571b0: 6d65 7465 7220 3d3d 2027 6a61 6363 6172  meter == 'jaccar
-000571c0: 6427 2061 6e64 206c 656e 2874 6172 6765  d' and len(targe
-000571d0: 7429 203e 2031 3a0d 0a20 2020 2020 2020  t) > 1:..       
-000571e0: 2020 2020 2020 2020 2023 2320 2054 6869           ##  Thi
-000571f0: 7320 7368 6f77 7320 7369 6d69 6c61 7269  s shows similari
-00057200: 7479 2069 6e20 6d75 6c74 692d 6c61 6265  ty in multi-labe
-00057210: 6c20 7369 7475 6174 696f 6e73 2023 2323  l situations ###
-00057220: 230d 0a20 2020 2020 2020 2020 2020 2020  #..             
-00057230: 2020 2020 2020 2061 6363 755f 616c 6c20         accu_all 
-00057240: 3d20 6a61 6363 6172 645f 6d75 6c74 696c  = jaccard_multil
-00057250: 6162 656c 2879 5f61 6374 7561 6c73 2c20  abel(y_actuals, 
-00057260: 795f 7072 6564 7329 0d0a 2020 2020 2020  y_preds)..      
-00057270: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00057280: 696e 7428 2720 2020 2020 2020 204d 6561  int('        Mea
-00057290: 6e20 4a61 6363 6172 6420 5369 6d69 6c61  n Jaccard Simila
-000572a0: 7269 7479 2020 3d20 2573 2720 2528 0d0a  rity  = %s' %(..
+00057170: 2020 2020 2020 2020 2020 6163 6375 5f61            accu_a
+00057180: 6c6c 2a31 3030 2929 0d0a 2020 2020 2020  ll*100))..      
+00057190: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
+000571a0: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
+000571b0: 203d 3d20 276a 6163 6361 7264 2720 616e   == 'jaccard' an
+000571c0: 6420 6c65 6e28 7461 7267 6574 2920 3e20  d len(target) > 
+000571d0: 313a 0d0a 2020 2020 2020 2020 2020 2020  1:..            
+000571e0: 2020 2020 2323 2020 5468 6973 2073 686f      ##  This sho
+000571f0: 7773 2073 696d 696c 6172 6974 7920 696e  ws similarity in
+00057200: 206d 756c 7469 2d6c 6162 656c 2073 6974   multi-label sit
+00057210: 7561 7469 6f6e 7320 2323 2323 0d0a 2020  uations ####..  
+00057220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00057230: 2020 6163 6375 5f61 6c6c 203d 206a 6163    accu_all = jac
+00057240: 6361 7264 5f6d 756c 7469 6c61 6265 6c28  card_multilabel(
+00057250: 795f 6163 7475 616c 732c 2079 5f70 7265  y_actuals, y_pre
+00057260: 6473 290d 0a20 2020 2020 2020 2020 2020  ds)..           
+00057270: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00057280: 2020 2020 2020 2020 4d65 616e 204a 6163          Mean Jac
+00057290: 6361 7264 2053 696d 696c 6172 6974 7920  card Similarity 
+000572a0: 203d 2025 7327 2025 280d 0a20 2020 2020   = %s' %(..     
 000572b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000572c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000572d0: 2020 2020 2020 2020 2020 2020 6163 6375              accu
-000572e0: 5f61 6c6c 2929 0d0a 2020 2020 2020 2020  _all))..        
-000572f0: 2323 2020 2045 4e44 204f 4620 5348 4f57  ##   END OF SHOW
-00057300: 494e 4720 4d45 5452 4943 5320 4c41 4245  ING METRICS LABE
-00057310: 4c20 494e 2041 204d 554c 5449 204c 4142  L IN A MULTI LAB
-00057320: 454c 2044 4154 4120 5345 5420 2120 5748  EL DATA SET ! WH
-00057330: 4557 2021 2023 2323 2323 2323 2323 2323  EW ! ###########
-00057340: 2323 2323 2323 2323 0d0a 2020 2020 7072  ########..    pr
-00057350: 696e 7428 2723 2323 2323 2323 2323 2323  int('###########
-00057360: 2323 2323 2020 4320 4f20 4d20 5020 4c20  ####  C O M P L 
-00057370: 4520 5420 4520 4420 2023 2323 2323 2323  E T E D  #######
-00057380: 2323 2323 2323 2323 2327 290d 0a20 2020  #########')..   
-00057390: 2070 7269 6e74 2827 5469 6d65 2054 616b   print('Time Tak
-000573a0: 656e 2069 6e20 6d69 6e73 203d 2025 302e  en in mins = %0.
-000573b0: 3166 2066 6f72 2074 6865 2045 6e74 6972  1f for the Entir
-000573c0: 6520 5072 6f63 6573 7327 2025 2828 7469  e Process' %((ti
-000573d0: 6d65 2e74 696d 6528 292d 7374 6172 745f  me.time()-start_
-000573e0: 7469 6d65 292f 3630 2929 0d0a 2020 2020  time)/60))..    
-000573f0: 2372 6574 7572 6e20 6d6f 6465 6c2c 2069  #return model, i
-00057400: 6d70 5f66 6561 7475 7265 735f 6466 2e69  mp_features_df.i
-00057410: 6e64 6578 2e74 6f6c 6973 7428 292c 2074  ndex.tolist(), t
-00057420: 7261 696e 6d2c 2074 6573 746d 0d0a 2020  rainm, testm..  
-00057430: 2020 7265 7475 726e 206d 6f64 656c 2c20    return model, 
-00057440: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
-00057450: 6573 2c20 7472 6169 6e6d 2c20 7465 7374  es, trainm, test
-00057460: 6d0d 0a23 2323 2323 2323 2323 2323 2323  m..#############
+000572d0: 2020 2020 2020 2061 6363 755f 616c 6c29         accu_all)
+000572e0: 290d 0a20 2020 2020 2020 2023 2320 2020  )..        ##   
+000572f0: 454e 4420 4f46 2053 484f 5749 4e47 204d  END OF SHOWING M
+00057300: 4554 5249 4353 204c 4142 454c 2049 4e20  ETRICS LABEL IN 
+00057310: 4120 4d55 4c54 4920 4c41 4245 4c20 4441  A MULTI LABEL DA
+00057320: 5441 2053 4554 2021 2057 4845 5720 2120  TA SET ! WHEW ! 
+00057330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00057340: 2323 230d 0a20 2020 2070 7269 6e74 2827  ###..    print('
+00057350: 2323 2323 2323 2323 2323 2323 2323 2320  ############### 
+00057360: 2043 204f 204d 2050 204c 2045 2054 2045   C O M P L E T E
+00057370: 2044 2020 2323 2323 2323 2323 2323 2323   D  ############
+00057380: 2323 2323 2729 0d0a 2020 2020 7072 696e  ####')..    prin
+00057390: 7428 2754 696d 6520 5461 6b65 6e20 696e  t('Time Taken in
+000573a0: 206d 696e 7320 3d20 2530 2e31 6620 666f   mins = %0.1f fo
+000573b0: 7220 7468 6520 456e 7469 7265 2050 726f  r the Entire Pro
+000573c0: 6365 7373 2720 2528 2874 696d 652e 7469  cess' %((time.ti
+000573d0: 6d65 2829 2d73 7461 7274 5f74 696d 6529  me()-start_time)
+000573e0: 2f36 3029 290d 0a20 2020 2023 7265 7475  /60))..    #retu
+000573f0: 726e 206d 6f64 656c 2c20 696d 705f 6665  rn model, imp_fe
+00057400: 6174 7572 6573 5f64 662e 696e 6465 782e  atures_df.index.
+00057410: 746f 6c69 7374 2829 2c20 7472 6169 6e6d  tolist(), trainm
+00057420: 2c20 7465 7374 6d0d 0a20 2020 2072 6574  , testm..    ret
+00057430: 7572 6e20 6d6f 6465 6c2c 2069 6d70 6f72  urn model, impor
+00057440: 7461 6e74 5f66 6561 7475 7265 732c 2074  tant_features, t
+00057450: 7261 696e 6d2c 2074 6573 746d 0d0a 2323  rainm, testm..##
+00057460: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00057470: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00057480: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00057490: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000574a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000574b0: 2323 0d0a 6465 6620 706c 6f74 5f53 4841  ##..def plot_SHA
-000574c0: 505f 7661 6c75 6573 286d 2c58 2c6d 6f64  P_values(m,X,mod
-000574d0: 656c 7479 7065 2c42 6f6f 7374 696e 675f  eltype,Boosting_
-000574e0: 466c 6167 3d46 616c 7365 2c6d 6174 706c  Flag=False,matpl
-000574f0: 6f74 6c69 625f 666c 6167 3d46 616c 7365  otlib_flag=False
-00057500: 2c76 6572 626f 7365 3d30 293a 0d0a 2020  ,verbose=0):..  
-00057510: 2020 696d 706f 7274 2073 6861 700d 0a20    import shap.. 
-00057520: 2020 2023 206c 6f61 6420 4a53 2076 6973     # load JS vis
-00057530: 7561 6c69 7a61 7469 6f6e 2063 6f64 6520  ualization code 
-00057540: 746f 206e 6f74 6562 6f6f 6b0d 0a20 2020  to notebook..   
-00057550: 2069 6620 6e6f 7420 6d61 7470 6c6f 746c   if not matplotl
-00057560: 6962 5f66 6c61 673a 0d0a 2020 2020 2020  ib_flag:..      
-00057570: 2020 7368 6170 2e69 6e69 746a 7328 293b    shap.initjs();
-00057580: 0d0a 2020 2020 2320 6578 706c 6169 6e20  ..    # explain 
-00057590: 7468 6520 6d6f 6465 6c27 7320 7072 6564  the model's pred
-000575a0: 6963 7469 6f6e 7320 7573 696e 6720 5348  ictions using SH
-000575b0: 4150 2076 616c 7565 730d 0a20 2020 2065  AP values..    e
-000575c0: 7870 6c61 696e 6572 203d 2073 6861 702e  xplainer = shap.
-000575d0: 5472 6565 4578 706c 6169 6e65 7228 6d29  TreeExplainer(m)
-000575e0: 0d0a 2020 2020 7368 6170 5f76 616c 7565  ..    shap_value
-000575f0: 7320 3d20 6578 706c 6169 6e65 722e 7368  s = explainer.sh
-00057600: 6170 5f76 616c 7565 7328 5829 0d0a 2020  ap_values(X)..  
-00057610: 2020 6966 206e 6f74 2042 6f6f 7374 696e    if not Boostin
-00057620: 675f 466c 6167 2069 7320 4e6f 6e65 3a0d  g_Flag is None:.
-00057630: 0a20 2020 2020 2020 2069 6620 426f 6f73  .        if Boos
-00057640: 7469 6e67 5f46 6c61 673a 0d0a 2020 2020  ting_Flag:..    
-00057650: 2020 2020 2020 2020 2320 7669 7375 616c          # visual
-00057660: 697a 6520 7468 6520 6669 7273 7420 7072  ize the first pr
-00057670: 6564 6963 7469 6f6e 2773 2065 7870 6c61  ediction's expla
-00057680: 6e61 7469 6f6e 2028 7573 6520 6d61 7470  nation (use matp
-00057690: 6c6f 746c 6962 3d54 7275 6520 746f 2061  lotlib=True to a
-000576a0: 766f 6964 204a 6176 6173 6372 6970 7429  void Javascript)
-000576b0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000576c0: 2076 6572 626f 7365 203e 2030 2061 6e64   verbose > 0 and
-000576d0: 206d 6f64 656c 7479 7065 2021 3d20 274d   modeltype != 'M
-000576e0: 756c 7469 5f43 6c61 7373 6966 6963 6174  ulti_Classificat
-000576f0: 696f 6e27 3a0d 0a20 2020 2020 2020 2020  ion':..         
-00057700: 2020 2020 2020 2073 6861 702e 7375 6d6d         shap.summ
-00057710: 6172 795f 706c 6f74 2873 6861 705f 7661  ary_plot(shap_va
-00057720: 6c75 6573 2c20 582c 2070 6c6f 745f 7479  lues, X, plot_ty
-00057730: 7065 3d22 7669 6f6c 696e 2229 3b0d 0a20  pe="violin");.. 
-00057740: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
-00057750: 6520 3e3d 2031 3a0d 0a20 2020 2020 2020  e >= 1:..       
-00057760: 2020 2020 2073 6861 702e 7375 6d6d 6172       shap.summar
-00057770: 795f 706c 6f74 2873 6861 705f 7661 6c75  y_plot(shap_valu
-00057780: 6573 2c20 582c 2070 6c6f 745f 7479 7065  es, X, plot_type
-00057790: 3d22 6261 7222 293b 0d0a 2020 2020 656c  ="bar");..    el
-000577a0: 7365 3a0d 0a20 2020 2020 2020 2073 6861  se:..        sha
-000577b0: 702e 7375 6d6d 6172 795f 706c 6f74 2873  p.summary_plot(s
-000577c0: 6861 705f 7661 6c75 6573 2c20 582c 2070  hap_values, X, p
-000577d0: 6c6f 745f 7479 7065 3d22 6261 7222 293b  lot_type="bar");
-000577e0: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+000574a0: 2323 2323 2323 2323 2323 2323 230d 0a64  #############..d
+000574b0: 6566 2070 6c6f 745f 5348 4150 5f76 616c  ef plot_SHAP_val
+000574c0: 7565 7328 6d2c 582c 6d6f 6465 6c74 7970  ues(m,X,modeltyp
+000574d0: 652c 426f 6f73 7469 6e67 5f46 6c61 673d  e,Boosting_Flag=
+000574e0: 4661 6c73 652c 6d61 7470 6c6f 746c 6962  False,matplotlib
+000574f0: 5f66 6c61 673d 4661 6c73 652c 7665 7262  _flag=False,verb
+00057500: 6f73 653d 3029 3a0d 0a20 2020 2069 6d70  ose=0):..    imp
+00057510: 6f72 7420 7368 6170 0d0a 2020 2020 2320  ort shap..    # 
+00057520: 6c6f 6164 204a 5320 7669 7375 616c 697a  load JS visualiz
+00057530: 6174 696f 6e20 636f 6465 2074 6f20 6e6f  ation code to no
+00057540: 7465 626f 6f6b 0d0a 2020 2020 6966 206e  tebook..    if n
+00057550: 6f74 206d 6174 706c 6f74 6c69 625f 666c  ot matplotlib_fl
+00057560: 6167 3a0d 0a20 2020 2020 2020 2073 6861  ag:..        sha
+00057570: 702e 696e 6974 6a73 2829 3b0d 0a20 2020  p.initjs();..   
+00057580: 2023 2065 7870 6c61 696e 2074 6865 206d   # explain the m
+00057590: 6f64 656c 2773 2070 7265 6469 6374 696f  odel's predictio
+000575a0: 6e73 2075 7369 6e67 2053 4841 5020 7661  ns using SHAP va
+000575b0: 6c75 6573 0d0a 2020 2020 6578 706c 6169  lues..    explai
+000575c0: 6e65 7220 3d20 7368 6170 2e54 7265 6545  ner = shap.TreeE
+000575d0: 7870 6c61 696e 6572 286d 290d 0a20 2020  xplainer(m)..   
+000575e0: 2073 6861 705f 7661 6c75 6573 203d 2065   shap_values = e
+000575f0: 7870 6c61 696e 6572 2e73 6861 705f 7661  xplainer.shap_va
+00057600: 6c75 6573 2858 290d 0a20 2020 2069 6620  lues(X)..    if 
+00057610: 6e6f 7420 426f 6f73 7469 6e67 5f46 6c61  not Boosting_Fla
+00057620: 6720 6973 204e 6f6e 653a 0d0a 2020 2020  g is None:..    
+00057630: 2020 2020 6966 2042 6f6f 7374 696e 675f      if Boosting_
+00057640: 466c 6167 3a0d 0a20 2020 2020 2020 2020  Flag:..         
+00057650: 2020 2023 2076 6973 7561 6c69 7a65 2074     # visualize t
+00057660: 6865 2066 6972 7374 2070 7265 6469 6374  he first predict
+00057670: 696f 6e27 7320 6578 706c 616e 6174 696f  ion's explanatio
+00057680: 6e20 2875 7365 206d 6174 706c 6f74 6c69  n (use matplotli
+00057690: 623d 5472 7565 2074 6f20 6176 6f69 6420  b=True to avoid 
+000576a0: 4a61 7661 7363 7269 7074 290d 0a20 2020  Javascript)..   
+000576b0: 2020 2020 2020 2020 2069 6620 7665 7262           if verb
+000576c0: 6f73 6520 3e20 3020 616e 6420 6d6f 6465  ose > 0 and mode
+000576d0: 6c74 7970 6520 213d 2027 4d75 6c74 695f  ltype != 'Multi_
+000576e0: 436c 6173 7369 6669 6361 7469 6f6e 273a  Classification':
+000576f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00057700: 2020 7368 6170 2e73 756d 6d61 7279 5f70    shap.summary_p
+00057710: 6c6f 7428 7368 6170 5f76 616c 7565 732c  lot(shap_values,
+00057720: 2058 2c20 706c 6f74 5f74 7970 653d 2276   X, plot_type="v
+00057730: 696f 6c69 6e22 293b 0d0a 2020 2020 2020  iolin");..      
+00057740: 2020 6966 2076 6572 626f 7365 203e 3d20    if verbose >= 
+00057750: 313a 0d0a 2020 2020 2020 2020 2020 2020  1:..            
+00057760: 7368 6170 2e73 756d 6d61 7279 5f70 6c6f  shap.summary_plo
+00057770: 7428 7368 6170 5f76 616c 7565 732c 2058  t(shap_values, X
+00057780: 2c20 706c 6f74 5f74 7970 653d 2262 6172  , plot_type="bar
+00057790: 2229 3b0d 0a20 2020 2065 6c73 653a 0d0a  ");..    else:..
+000577a0: 2020 2020 2020 2020 7368 6170 2e73 756d          shap.sum
+000577b0: 6d61 7279 5f70 6c6f 7428 7368 6170 5f76  mary_plot(shap_v
+000577c0: 616c 7565 732c 2058 2c20 706c 6f74 5f74  alues, X, plot_t
+000577d0: 7970 653d 2262 6172 2229 3b0d 0a23 2323  ype="bar");..###
+000577e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000577f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00057800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00057810: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057830: 2323 0d0a 2323 2323 2323 2323 2323 2323  ##..############
-00057840: 2323 2323 2020 2020 2020 4669 6e64 2074  ####      Find t
-00057850: 6f70 2066 6561 7475 7265 7320 7573 696e  op features usin
-00057860: 6720 5847 4220 2020 2020 2323 2323 2323  g XGB     ######
-00057870: 2323 2323 2323 2323 2323 2323 230d 0a23  #############..#
+00057820: 2323 2323 2323 2323 2323 2323 230d 0a23  #############..#
+00057830: 2323 2323 2323 2323 2323 2323 2323 2320  ############### 
+00057840: 2020 2020 2046 696e 6420 746f 7020 6665       Find top fe
+00057850: 6174 7572 6573 2075 7369 6e67 2058 4742  atures using XGB
+00057860: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
+00057870: 2323 2323 2323 2323 0d0a 2323 2323 2323  ########..######
 00057880: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00057890: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000578a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000578b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000578c0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-000578d0: 0a66 726f 6d20 7867 626f 6f73 7420 696d  .from xgboost im
-000578e0: 706f 7274 2058 4742 436c 6173 7369 6669  port XGBClassifi
-000578f0: 6572 2c20 5847 4252 6567 7265 7373 6f72  er, XGBRegressor
-00057900: 0d0a 6465 6620 6669 6e64 5f74 6f70 5f66  ..def find_top_f
-00057910: 6561 7475 7265 735f 7867 6228 7472 6169  eatures_xgb(trai
-00057920: 6e2c 7072 6564 732c 6e75 6d76 6172 732c  n,preds,numvars,
-00057930: 7461 7267 6574 2c6d 6f64 656c 7479 7065  target,modeltype
-00057940: 2c63 6f72 725f 6c69 6d69 742c 7665 7262  ,corr_limit,verb
-00057950: 6f73 653d 3029 3a0d 0a20 2020 2022 2222  ose=0):..    """
-00057960: 0d0a 2020 2020 5468 6973 2069 7320 6120  ..    This is a 
-00057970: 6661 7374 2075 7469 6c69 7479 2074 6861  fast utility tha
-00057980: 7420 7573 6573 2058 4742 2074 6f20 6669  t uses XGB to fi
-00057990: 6e64 2074 6f70 2066 6561 7475 7265 732e  nd top features.
-000579a0: 2059 6f75 0d0a 2020 2020 4974 2072 6574   You..    It ret
-000579b0: 7572 6e73 2061 206c 6973 7420 6f66 2069  urns a list of i
-000579c0: 6d70 6f72 7461 6e74 2066 6561 7475 7265  mportant feature
-000579d0: 732e 0d0a 2020 2020 5369 6e63 6520 6974  s...    Since it
-000579e0: 2069 7320 5847 422c 2079 6f75 2064 6f6e   is XGB, you don
-000579f0: 7420 6861 7665 2074 6f20 7265 7374 7269  t have to restri
-00057a00: 6374 2074 6865 2069 6e70 7574 2074 6f20  ct the input to 
-00057a10: 6a75 7374 206e 756d 6572 6963 2076 6172  just numeric var
-00057a20: 732e 0d0a 2020 2020 596f 7520 6361 6e20  s...    You can 
-00057a30: 7365 6e64 2069 6e20 616c 6c20 6b69 6e64  send in all kind
-00057a40: 7320 6f66 2076 6172 7320 616e 6420 6974  s of vars and it
-00057a50: 2077 696c 6c20 7461 6b65 2063 6172 6520   will take care 
-00057a60: 6f66 2074 7261 6e73 666f 726d 696e 6720  of transforming 
-00057a70: 6974 2e20 5377 6565 7421 0d0a 2020 2020  it. Sweet!..    
-00057a80: 2222 220d 0a20 2020 2023 2323 2323 2323  """..    #######
-00057a90: 2323 2323 2323 2323 2323 2323 2323 2320  ############### 
-00057aa0: 2020 4920 4d20 5020 4f20 5220 5420 4120    I M P O R T A 
-00057ab0: 4e20 5420 2323 2323 2323 2323 2323 2323  N T ############
+000578c0: 2323 2323 2323 2323 2323 0d0a 6672 6f6d  ##########..from
+000578d0: 2078 6762 6f6f 7374 2069 6d70 6f72 7420   xgboost import 
+000578e0: 5847 4243 6c61 7373 6966 6965 722c 2058  XGBClassifier, X
+000578f0: 4742 5265 6772 6573 736f 720d 0a64 6566  GBRegressor..def
+00057900: 2066 696e 645f 746f 705f 6665 6174 7572   find_top_featur
+00057910: 6573 5f78 6762 2874 7261 696e 2c70 7265  es_xgb(train,pre
+00057920: 6473 2c6e 756d 7661 7273 2c74 6172 6765  ds,numvars,targe
+00057930: 742c 6d6f 6465 6c74 7970 652c 636f 7272  t,modeltype,corr
+00057940: 5f6c 696d 6974 2c76 6572 626f 7365 3d30  _limit,verbose=0
+00057950: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
+00057960: 2054 6869 7320 6973 2061 2066 6173 7420   This is a fast 
+00057970: 7574 696c 6974 7920 7468 6174 2075 7365  utility that use
+00057980: 7320 5847 4220 746f 2066 696e 6420 746f  s XGB to find to
+00057990: 7020 6665 6174 7572 6573 2e20 596f 750d  p features. You.
+000579a0: 0a20 2020 2049 7420 7265 7475 726e 7320  .    It returns 
+000579b0: 6120 6c69 7374 206f 6620 696d 706f 7274  a list of import
+000579c0: 616e 7420 6665 6174 7572 6573 2e0d 0a20  ant features... 
+000579d0: 2020 2053 696e 6365 2069 7420 6973 2058     Since it is X
+000579e0: 4742 2c20 796f 7520 646f 6e74 2068 6176  GB, you dont hav
+000579f0: 6520 746f 2072 6573 7472 6963 7420 7468  e to restrict th
+00057a00: 6520 696e 7075 7420 746f 206a 7573 7420  e input to just 
+00057a10: 6e75 6d65 7269 6320 7661 7273 2e0d 0a20  numeric vars... 
+00057a20: 2020 2059 6f75 2063 616e 2073 656e 6420     You can send 
+00057a30: 696e 2061 6c6c 206b 696e 6473 206f 6620  in all kinds of 
+00057a40: 7661 7273 2061 6e64 2069 7420 7769 6c6c  vars and it will
+00057a50: 2074 616b 6520 6361 7265 206f 6620 7472   take care of tr
+00057a60: 616e 7366 6f72 6d69 6e67 2069 742e 2053  ansforming it. S
+00057a70: 7765 6574 210d 0a20 2020 2022 2222 0d0a  weet!..    """..
+00057a80: 2020 2020 2323 2323 2323 2323 2323 2323      ############
+00057a90: 2323 2323 2323 2323 2323 2020 2049 204d  ##########   I M
+00057aa0: 2050 204f 2052 2054 2041 204e 2054 2023   P O R T A N T #
+00057ab0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00057ac0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057ad0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057ae0: 2323 0d0a 2020 2020 2323 2323 2323 2054  ##..    ###### T
-00057af0: 6869 7320 746f 705f 6e75 6d20 6465 6369  his top_num deci
-00057b00: 6465 7320 686f 7720 6d61 6e79 2074 6f70  des how many top
-00057b10: 5f6e 2066 6561 7475 7265 7320 5847 4220  _n features XGB 
-00057b20: 7365 6c65 6374 7320 696e 2065 6163 6820  selects in each 
-00057b30: 6974 6572 6174 696f 6e2e 0d0a 2020 2020  iteration...    
-00057b40: 2323 2323 2020 5468 6572 6520 6120 746f  ####  There a to
-00057b50: 7461 6c20 6f66 2035 2069 7465 7261 7469  tal of 5 iterati
-00057b60: 6f6e 732e 2048 656e 6365 2035 7831 3020  ons. Hence 5x10 
-00057b70: 6d65 616e 7320 6d61 7869 6d75 6d20 3530  means maximum 50
-00057b80: 2066 6561 7475 6573 2077 696c 6c20 6265   featues will be
-00057b90: 2073 656c 6563 7465 642e 0d0a 2020 2020   selected...    
-00057ba0: 2323 2323 2320 2049 6620 7468 6572 6520  #####  If there 
-00057bb0: 6172 6520 6d6f 7265 2074 6861 6e20 3530  are more than 50
-00057bc0: 2076 6172 6961 626c 6573 2c20 7468 656e   variables, then
-00057bd0: 206d 6178 696d 756d 2035 2a32 3520 3d20   maximum 5*25 = 
-00057be0: 3132 3520 7661 7269 6162 6c65 7320 7769  125 variables wi
-00057bf0: 6c6c 2062 6520 7365 6c65 6374 6564 0d0a  ll be selected..
-00057c00: 2020 2020 6966 206c 656e 2870 7265 6473      if len(preds
-00057c10: 2920 3c3d 2035 303a 0d0a 2020 2020 2020  ) <= 50:..      
-00057c20: 2020 746f 705f 6e75 6d20 3d20 3130 0d0a    top_num = 10..
-00057c30: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00057c40: 2020 2074 6f70 5f6e 756d 203d 2032 350d     top_num = 25.
-00057c50: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
-00057c60: 2323 2323 2323 2323 2323 2320 2020 4920  ###########   I 
-00057c70: 4d20 5020 4f20 5220 5420 4120 4e20 5420  M P O R T A N T 
+00057ad0: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
+00057ae0: 2020 2023 2323 2323 2320 5468 6973 2074     ###### This t
+00057af0: 6f70 5f6e 756d 2064 6563 6964 6573 2068  op_num decides h
+00057b00: 6f77 206d 616e 7920 746f 705f 6e20 6665  ow many top_n fe
+00057b10: 6174 7572 6573 2058 4742 2073 656c 6563  atures XGB selec
+00057b20: 7473 2069 6e20 6561 6368 2069 7465 7261  ts in each itera
+00057b30: 7469 6f6e 2e0d 0a20 2020 2023 2323 2320  tion...    #### 
+00057b40: 2054 6865 7265 2061 2074 6f74 616c 206f   There a total o
+00057b50: 6620 3520 6974 6572 6174 696f 6e73 2e20  f 5 iterations. 
+00057b60: 4865 6e63 6520 3578 3130 206d 6561 6e73  Hence 5x10 means
+00057b70: 206d 6178 696d 756d 2035 3020 6665 6174   maximum 50 feat
+00057b80: 7565 7320 7769 6c6c 2062 6520 7365 6c65  ues will be sele
+00057b90: 6374 6564 2e0d 0a20 2020 2023 2323 2323  cted...    #####
+00057ba0: 2020 4966 2074 6865 7265 2061 7265 206d    If there are m
+00057bb0: 6f72 6520 7468 616e 2035 3020 7661 7269  ore than 50 vari
+00057bc0: 6162 6c65 732c 2074 6865 6e20 6d61 7869  ables, then maxi
+00057bd0: 6d75 6d20 352a 3235 203d 2031 3235 2076  mum 5*25 = 125 v
+00057be0: 6172 6961 626c 6573 2077 696c 6c20 6265  ariables will be
+00057bf0: 2073 656c 6563 7465 640d 0a20 2020 2069   selected..    i
+00057c00: 6620 6c65 6e28 7072 6564 7329 203c 3d20  f len(preds) <= 
+00057c10: 3530 3a0d 0a20 2020 2020 2020 2074 6f70  50:..        top
+00057c20: 5f6e 756d 203d 2031 300d 0a20 2020 2065  _num = 10..    e
+00057c30: 6c73 653a 0d0a 2020 2020 2020 2020 746f  lse:..        to
+00057c40: 705f 6e75 6d20 3d20 3235 0d0a 2020 2020  p_num = 25..    
+00057c50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00057c60: 2323 2323 2323 2020 2049 204d 2050 204f  ######   I M P O
+00057c70: 2052 2054 2041 204e 2054 2023 2323 2323   R T A N T #####
 00057c80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00057c90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057ca0: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00057cb0: 2020 2020 2323 2323 2049 6620 7468 6572      #### If ther
-00057cc0: 6520 6172 6520 6d6f 7265 2074 6861 6e20  e are more than 
-00057cd0: 3330 2063 6174 6567 6f72 6963 616c 2076  30 categorical v
-00057ce0: 6172 6961 626c 6573 2069 6e20 6120 6461  ariables in a da
-00057cf0: 7461 2073 6574 2c20 6974 2069 7320 776f  ta set, it is wo
-00057d00: 7274 6820 7265 6475 6369 6e67 2066 6561  rth reducing fea
-00057d10: 7475 7265 732e 0d0a 2020 2020 2323 2323  tures...    ####
-00057d20: 2020 4f74 6865 7277 6973 652e 2058 4742    Otherwise. XGB
-00057d30: 6f6f 7374 2069 7320 7072 6574 7479 2067  oost is pretty g
-00057d40: 6f6f 6420 6174 2066 696e 6469 6e67 2074  ood at finding t
-00057d50: 6865 2062 6573 7420 6665 6174 7572 6573  he best features
-00057d60: 2077 6865 7468 6572 2063 6174 206f 7220   whether cat or 
-00057d70: 6e75 6d65 7269 6320 210d 0a20 2020 206e  numeric !..    n
-00057d80: 5f73 706c 6974 7320 3d20 350d 0a20 2020  _splits = 5..   
-00057d90: 206d 6178 5f64 6570 7468 203d 2038 0d0a   max_depth = 8..
-00057da0: 2020 2020 6d61 785f 6361 7473 203d 2035      max_cats = 5
-00057db0: 0d0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
-00057dc0: 2323 2323 2323 2323 2323 2323 2020 2049  ############   I
-00057dd0: 204d 2050 204f 2052 2054 2041 204e 2054   M P O R T A N T
-00057de0: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
+00057ca0: 2323 2323 2323 2323 230d 0a20 2020 2023  #########..    #
+00057cb0: 2323 2320 4966 2074 6865 7265 2061 7265  ### If there are
+00057cc0: 206d 6f72 6520 7468 616e 2033 3020 6361   more than 30 ca
+00057cd0: 7465 676f 7269 6361 6c20 7661 7269 6162  tegorical variab
+00057ce0: 6c65 7320 696e 2061 2064 6174 6120 7365  les in a data se
+00057cf0: 742c 2069 7420 6973 2077 6f72 7468 2072  t, it is worth r
+00057d00: 6564 7563 696e 6720 6665 6174 7572 6573  educing features
+00057d10: 2e0d 0a20 2020 2023 2323 2320 204f 7468  ...    ####  Oth
+00057d20: 6572 7769 7365 2e20 5847 426f 6f73 7420  erwise. XGBoost 
+00057d30: 6973 2070 7265 7474 7920 676f 6f64 2061  is pretty good a
+00057d40: 7420 6669 6e64 696e 6720 7468 6520 6265  t finding the be
+00057d50: 7374 2066 6561 7475 7265 7320 7768 6574  st features whet
+00057d60: 6865 7220 6361 7420 6f72 206e 756d 6572  her cat or numer
+00057d70: 6963 2021 0d0a 2020 2020 6e5f 7370 6c69  ic !..    n_spli
+00057d80: 7473 203d 2035 0d0a 2020 2020 6d61 785f  ts = 5..    max_
+00057d90: 6465 7074 6820 3d20 380d 0a20 2020 206d  depth = 8..    m
+00057da0: 6178 5f63 6174 7320 3d20 350d 0a20 2020  ax_cats = 5..   
+00057db0: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
+00057dc0: 2323 2323 2323 2320 2020 4920 4d20 5020  #######   I M P 
+00057dd0: 4f20 5220 5420 4120 4e20 5420 2323 2323  O R T A N T ####
+00057de0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00057df0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00057e00: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00057e10: 0a20 2020 2074 7261 696e 203d 2063 6f70  .    train = cop
-00057e20: 792e 6465 6570 636f 7079 2874 7261 696e  y.deepcopy(train
-00057e30: 290d 0a20 2020 2070 7265 6473 203d 2063  )..    preds = c
-00057e40: 6f70 792e 6465 6570 636f 7079 2870 7265  opy.deepcopy(pre
-00057e50: 6473 290d 0a20 2020 206e 756d 7661 7273  ds)..    numvars
-00057e60: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
-00057e70: 286e 756d 7661 7273 290d 0a20 2020 2073  (numvars)..    s
-00057e80: 7562 7361 6d70 6c65 203d 2020 302e 370d  ubsample =  0.7.
-00057e90: 0a20 2020 2063 6f6c 5f73 7562 5f73 616d  .    col_sub_sam
-00057ea0: 706c 6520 3d20 302e 370d 0a20 2020 2074  ple = 0.7..    t
-00057eb0: 7261 696e 203d 2063 6f70 792e 6465 6570  rain = copy.deep
-00057ec0: 636f 7079 2874 7261 696e 290d 0a20 2020  copy(train)..   
-00057ed0: 2073 7461 7274 5f74 696d 6520 3d20 7469   start_time = ti
-00057ee0: 6d65 2e74 696d 6528 290d 0a20 2020 2074  me.time()..    t
-00057ef0: 6573 745f 7369 7a65 203d 2030 2e32 0d0a  est_size = 0.2..
-00057f00: 2020 2020 7365 6564 203d 2031 0d0a 2020      seed = 1..  
-00057f10: 2020 6561 726c 795f 7374 6f70 7069 6e67    early_stopping
-00057f20: 203d 2035 0d0a 2020 2020 2323 2323 2323   = 5..    ######
-00057f30: 2320 416c 6c20 7468 6520 6465 6661 756c  # All the defaul
-00057f40: 7420 7061 7261 6d65 7465 7273 2061 7265  t parameters are
-00057f50: 2073 6574 2075 7020 6e6f 7720 2323 2323   set up now ####
-00057f60: 2323 2323 230d 0a20 2020 206b 6620 3d20  #####..    kf = 
-00057f70: 4b46 6f6c 6428 6e5f 7370 6c69 7473 3d6e  KFold(n_splits=n
-00057f80: 5f73 706c 6974 7329 0d0a 2020 2020 7265  _splits)..    re
-00057f90: 6d5f 7661 7273 203d 206c 6566 745f 7375  m_vars = left_su
-00057fa0: 6274 7261 6374 2870 7265 6473 2c6e 756d  btract(preds,num
-00057fb0: 7661 7273 290d 0a20 2020 2063 6174 7661  vars)..    catva
-00057fc0: 7273 203d 2063 6f70 792e 6465 6570 636f  rs = copy.deepco
-00057fd0: 7079 2872 656d 5f76 6172 7329 0d0a 2020  py(rem_vars)..  
-00057fe0: 2020 2323 2323 2323 2323 2323 2323 2020    ############  
-00057ff0: 2049 2020 4d20 5020 4f20 5220 5420 4120   I  M P O R T A 
-00058000: 4e20 5420 2120 4920 4d20 5020 4f20 5220  N T ! I M P O R 
-00058010: 5420 4120 4e20 5420 2120 2323 2323 2323  T A N T ! ######
-00058020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00058030: 0d0a 2020 2020 2323 2323 2320 4920 616d  ..    ##### I am
-00058040: 2072 656d 6f76 696e 6720 7468 6520 4361   removing the Ca
-00058050: 7420 5661 7273 2073 656c 6563 7469 6f6e  t Vars selection
-00058060: 2075 7369 6e67 204c 696e 6561 7220 4d65   using Linear Me
-00058070: 7468 6f64 7320 7369 6e63 6520 7468 6579  thods since they
-00058080: 2066 6169 6c20 736f 206f 6674 656e 2e0d   fail so often..
-00058090: 0a20 2020 2023 2323 2323 204c 696e 6561  .    ##### Linea
-000580a0: 7220 6d65 7468 6f64 7320 7375 6368 2061  r methods such a
-000580b0: 7320 4368 6932 206f 7220 4d75 7475 616c  s Chi2 or Mutual
-000580c0: 2049 6e66 6f72 6d61 7469 6f6e 2053 636f   Information Sco
-000580d0: 7265 2061 7265 206e 6f74 2067 7265 6174  re are not great
-000580e0: 0d0a 2020 2020 2323 2323 2020 666f 7220  ..    ####  for 
-000580f0: 6665 6174 7572 6520 7365 6c65 6374 696f  feature selectio
-00058100: 6e20 7369 6e63 6520 7468 6579 2063 616e  n since they can
-00058110: 2774 2068 616e 646c 6520 6c61 7267 6520  't handle large 
-00058120: 6461 7461 2061 6e64 2070 726f 7669 6465  data and provide
-00058130: 0d0a 2020 2020 2323 2323 2020 696e 636f  ..    ####  inco
-00058140: 6e73 6973 7465 6e74 2072 6573 756c 7473  nsistent results
-00058150: 2066 6f72 206c 6172 6765 2064 6174 6120   for large data 
-00058160: 7365 7473 2e20 4865 6e63 6520 4920 616d  sets. Hence I am
-00058170: 2075 7369 6e67 2058 4742 6f6f 7374 2061   using XGBoost a
-00058180: 6c6f 6e65 2e0d 0a20 2020 2023 2323 2320  lone...    #### 
-00058190: 2041 6c73 6f2c 2061 6e6f 7468 6572 206d   Also, another m
-000581a0: 6574 686f 6420 6f66 2075 7369 6e67 2053  ethod of using S
-000581b0: 7065 6172 6d61 6e20 436f 7272 656c 6174  pearman Correlat
-000581c0: 696f 6e20 666f 7220 4361 7456 6172 7320  ion for CatVars 
-000581d0: 7769 7468 2031 3030 2773 0d0a 2020 2020  with 100's..    
-000581e0: 2323 2323 2020 6f66 2076 6172 6961 626c  ####  of variabl
-000581f0: 6573 2069 7320 6578 7472 656d 656c 7920  es is extremely 
-00058200: 736c 6f77 2e20 416c 736f 2c20 6974 2773  slow. Also, it's
-00058210: 2065 6666 6563 7469 7665 6e65 7320 6973   effectivenes is
-00058220: 206e 6f74 2076 6572 7920 636c 6561 722e   not very clear.
-00058230: 0d0a 2020 2020 2323 2323 2020 4865 6e63  ..    ####  Henc
-00058240: 6520 666f 7220 6e6f 772c 2049 2061 6d20  e for now, I am 
-00058250: 6e6f 7420 676f 696e 6720 746f 2075 7365  not going to use
-00058260: 2053 7065 6172 6d61 6e20 6d65 7468 6f64   Spearman method
-00058270: 2e0d 0a20 2020 2023 2323 2323 2323 2323  ...    #########
+00057e00: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+00057e10: 7472 6169 6e20 3d20 636f 7079 2e64 6565  train = copy.dee
+00057e20: 7063 6f70 7928 7472 6169 6e29 0d0a 2020  pcopy(train)..  
+00057e30: 2020 7072 6564 7320 3d20 636f 7079 2e64    preds = copy.d
+00057e40: 6565 7063 6f70 7928 7072 6564 7329 0d0a  eepcopy(preds)..
+00057e50: 2020 2020 6e75 6d76 6172 7320 3d20 636f      numvars = co
+00057e60: 7079 2e64 6565 7063 6f70 7928 6e75 6d76  py.deepcopy(numv
+00057e70: 6172 7329 0d0a 2020 2020 7375 6273 616d  ars)..    subsam
+00057e80: 706c 6520 3d20 2030 2e37 0d0a 2020 2020  ple =  0.7..    
+00057e90: 636f 6c5f 7375 625f 7361 6d70 6c65 203d  col_sub_sample =
+00057ea0: 2030 2e37 0d0a 2020 2020 7472 6169 6e20   0.7..    train 
+00057eb0: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+00057ec0: 7472 6169 6e29 0d0a 2020 2020 7374 6172  train)..    star
+00057ed0: 745f 7469 6d65 203d 2074 696d 652e 7469  t_time = time.ti
+00057ee0: 6d65 2829 0d0a 2020 2020 7465 7374 5f73  me()..    test_s
+00057ef0: 697a 6520 3d20 302e 320d 0a20 2020 2073  ize = 0.2..    s
+00057f00: 6565 6420 3d20 310d 0a20 2020 2065 6172  eed = 1..    ear
+00057f10: 6c79 5f73 746f 7070 696e 6720 3d20 350d  ly_stopping = 5.
+00057f20: 0a20 2020 2023 2323 2323 2323 2041 6c6c  .    ####### All
+00057f30: 2074 6865 2064 6566 6175 6c74 2070 6172   the default par
+00057f40: 616d 6574 6572 7320 6172 6520 7365 7420  ameters are set 
+00057f50: 7570 206e 6f77 2023 2323 2323 2323 2323  up now #########
+00057f60: 0d0a 2020 2020 6b66 203d 204b 466f 6c64  ..    kf = KFold
+00057f70: 286e 5f73 706c 6974 733d 6e5f 7370 6c69  (n_splits=n_spli
+00057f80: 7473 290d 0a20 2020 2072 656d 5f76 6172  ts)..    rem_var
+00057f90: 7320 3d20 6c65 6674 5f73 7562 7472 6163  s = left_subtrac
+00057fa0: 7428 7072 6564 732c 6e75 6d76 6172 7329  t(preds,numvars)
+00057fb0: 0d0a 2020 2020 6361 7476 6172 7320 3d20  ..    catvars = 
+00057fc0: 636f 7079 2e64 6565 7063 6f70 7928 7265  copy.deepcopy(re
+00057fd0: 6d5f 7661 7273 290d 0a20 2020 2023 2323  m_vars)..    ###
+00057fe0: 2323 2323 2323 2323 2320 2020 4920 204d  #########   I  M
+00057ff0: 2050 204f 2052 2054 2041 204e 2054 2021   P O R T A N T !
+00058000: 2049 204d 2050 204f 2052 2054 2041 204e   I M P O R T A N
+00058010: 2054 2021 2023 2323 2323 2323 2323 2323   T ! ###########
+00058020: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+00058030: 2023 2323 2323 2049 2061 6d20 7265 6d6f   ##### I am remo
+00058040: 7669 6e67 2074 6865 2043 6174 2056 6172  ving the Cat Var
+00058050: 7320 7365 6c65 6374 696f 6e20 7573 696e  s selection usin
+00058060: 6720 4c69 6e65 6172 204d 6574 686f 6473  g Linear Methods
+00058070: 2073 696e 6365 2074 6865 7920 6661 696c   since they fail
+00058080: 2073 6f20 6f66 7465 6e2e 0d0a 2020 2020   so often...    
+00058090: 2323 2323 2320 4c69 6e65 6172 206d 6574  ##### Linear met
+000580a0: 686f 6473 2073 7563 6820 6173 2043 6869  hods such as Chi
+000580b0: 3220 6f72 204d 7574 7561 6c20 496e 666f  2 or Mutual Info
+000580c0: 726d 6174 696f 6e20 5363 6f72 6520 6172  rmation Score ar
+000580d0: 6520 6e6f 7420 6772 6561 740d 0a20 2020  e not great..   
+000580e0: 2023 2323 2320 2066 6f72 2066 6561 7475   ####  for featu
+000580f0: 7265 2073 656c 6563 7469 6f6e 2073 696e  re selection sin
+00058100: 6365 2074 6865 7920 6361 6e27 7420 6861  ce they can't ha
+00058110: 6e64 6c65 206c 6172 6765 2064 6174 6120  ndle large data 
+00058120: 616e 6420 7072 6f76 6964 650d 0a20 2020  and provide..   
+00058130: 2023 2323 2320 2069 6e63 6f6e 7369 7374   ####  inconsist
+00058140: 656e 7420 7265 7375 6c74 7320 666f 7220  ent results for 
+00058150: 6c61 7267 6520 6461 7461 2073 6574 732e  large data sets.
+00058160: 2048 656e 6365 2049 2061 6d20 7573 696e   Hence I am usin
+00058170: 6720 5847 426f 6f73 7420 616c 6f6e 652e  g XGBoost alone.
+00058180: 0d0a 2020 2020 2323 2323 2020 416c 736f  ..    ####  Also
+00058190: 2c20 616e 6f74 6865 7220 6d65 7468 6f64  , another method
+000581a0: 206f 6620 7573 696e 6720 5370 6561 726d   of using Spearm
+000581b0: 616e 2043 6f72 7265 6c61 7469 6f6e 2066  an Correlation f
+000581c0: 6f72 2043 6174 5661 7273 2077 6974 6820  or CatVars with 
+000581d0: 3130 3027 730d 0a20 2020 2023 2323 2320  100's..    #### 
+000581e0: 206f 6620 7661 7269 6162 6c65 7320 6973   of variables is
+000581f0: 2065 7874 7265 6d65 6c79 2073 6c6f 772e   extremely slow.
+00058200: 2041 6c73 6f2c 2069 7427 7320 6566 6665   Also, it's effe
+00058210: 6374 6976 656e 6573 2069 7320 6e6f 7420  ctivenes is not 
+00058220: 7665 7279 2063 6c65 6172 2e0d 0a20 2020  very clear...   
+00058230: 2023 2323 2320 2048 656e 6365 2066 6f72   ####  Hence for
+00058240: 206e 6f77 2c20 4920 616d 206e 6f74 2067   now, I am not g
+00058250: 6f69 6e67 2074 6f20 7573 6520 5370 6561  oing to use Spea
+00058260: 726d 616e 206d 6574 686f 642e 0d0a 2020  rman method...  
+00058270: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
 00058280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00058290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000582a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000582b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000582c0: 2323 2323 230d 0a20 2020 2023 6966 206c  #####..    #if l
-000582d0: 656e 2863 6174 7661 7273 2920 3e20 6d61  en(catvars) > ma
-000582e0: 785f 6361 7473 3a0d 0a20 2020 2023 2020  x_cats:..    #  
-000582f0: 2020 7374 6172 745f 7469 6d65 203d 2074    start_time = t
-00058300: 696d 652e 7469 6d65 2829 0d0a 2020 2020  ime.time()..    
-00058310: 2320 2020 2069 6d70 6f72 7461 6e74 5f63  #    important_c
-00058320: 6174 7320 3d20 7265 6d6f 7665 5f76 6172  ats = remove_var
-00058330: 6961 626c 6573 5f75 7369 6e67 5f66 6173  iables_using_fas
-00058340: 745f 636f 7272 656c 6174 696f 6e28 7472  t_correlation(tr
-00058350: 6169 6e2c 6361 7476 6172 732c 6d6f 6465  ain,catvars,mode
-00058360: 6c74 7970 652c 0d0a 2020 2020 2320 2020  ltype,..    #   
+000582c0: 0d0a 2020 2020 2369 6620 6c65 6e28 6361  ..    #if len(ca
+000582d0: 7476 6172 7329 203e 206d 6178 5f63 6174  tvars) > max_cat
+000582e0: 733a 0d0a 2020 2020 2320 2020 2073 7461  s:..    #    sta
+000582f0: 7274 5f74 696d 6520 3d20 7469 6d65 2e74  rt_time = time.t
+00058300: 696d 6528 290d 0a20 2020 2023 2020 2020  ime()..    #    
+00058310: 696d 706f 7274 616e 745f 6361 7473 203d  important_cats =
+00058320: 2072 656d 6f76 655f 7661 7269 6162 6c65   remove_variable
+00058330: 735f 7573 696e 675f 6661 7374 5f63 6f72  s_using_fast_cor
+00058340: 7265 6c61 7469 6f6e 2874 7261 696e 2c63  relation(train,c
+00058350: 6174 7661 7273 2c6d 6f64 656c 7479 7065  atvars,modeltype
+00058360: 2c0d 0a20 2020 2023 2020 2020 2020 2020  ,..    #        
 00058370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00058380: 2020 2020 2020 636f 7272 5f6c 696d 6974        corr_limit
-00058390: 2c76 6572 626f 7365 290d 0a20 2020 2023  ,verbose)..    #
-000583a0: 2020 2020 6966 2076 6572 626f 7365 203e      if verbose >
-000583b0: 3d20 313a 0d0a 2020 2020 2320 2020 2020  = 1:..    #     
-000583c0: 2020 2070 7269 6e74 2827 5469 6d65 2074     print('Time t
-000583d0: 616b 656e 2066 6f72 2072 6564 7563 696e  aken for reducin
-000583e0: 6720 6869 6768 6c79 2063 6f72 7265 6c61  g highly correla
-000583f0: 7465 6420 4361 7465 676f 7269 6361 6c20  ted Categorical 
-00058400: 7661 7273 2077 6173 2025 302e 3066 2073  vars was %0.0f s
-00058410: 6563 6f6e 6473 2720 2528 7469 6d65 2e74  econds' %(time.t
-00058420: 696d 6528 292d 7374 6172 745f 7469 6d65  ime()-start_time
-00058430: 2929 0d0a 2020 2020 2365 6c73 653a 0d0a  ))..    #else:..
-00058440: 2020 2020 696d 706f 7274 616e 745f 6361      important_ca
-00058450: 7473 203d 2063 6f70 792e 6465 6570 636f  ts = copy.deepco
-00058460: 7079 2863 6174 7661 7273 290d 0a20 2020  py(catvars)..   
-00058470: 2070 7269 6e74 2827 2020 2020 2825 6429   print('    (%d)
-00058480: 2063 6174 6567 6f72 6963 616c 2076 6172   categorical var
-00058490: 732e 2e2e 2720 2528 6c65 6e28 6361 7476  s...' %(len(catv
-000584a0: 6172 7329 2929 0d0a 2020 2020 6669 6e61  ars)))..    fina
-000584b0: 6c5f 6c69 7374 203d 2063 6f70 792e 6465  l_list = copy.de
-000584c0: 6570 636f 7079 286e 756d 7661 7273 290d  epcopy(numvars).
-000584d0: 0a20 2020 2069 6620 2069 7369 6e73 7461  .    if  isinsta
-000584e0: 6e63 6528 6669 6e61 6c5f 6c69 7374 2c6e  nce(final_list,n
-000584f0: 702e 6e64 6172 7261 7929 3a0d 0a20 2020  p.ndarray):..   
-00058500: 2020 2020 2066 696e 616c 5f6c 6973 7420       final_list 
-00058510: 3d20 6669 6e61 6c5f 6c69 7374 2e74 6f6c  = final_list.tol
-00058520: 6973 7428 290d 0a20 2020 2070 7265 6473  ist()..    preds
-00058530: 203d 2066 696e 616c 5f6c 6973 742b 696d   = final_list+im
-00058540: 706f 7274 616e 745f 6361 7473 0d0a 2020  portant_cats..  
-00058550: 2020 2323 2323 2323 2359 6f75 206d 7573    #######You mus
-00058560: 7420 636f 6e76 6572 7420 6361 7465 676f  t convert catego
-00058570: 7279 2076 6172 6961 626c 6573 2069 6e74  ry variables int
-00058580: 6f20 696e 7465 6765 7273 2023 2323 2323  o integers #####
-00058590: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-000585a0: 666f 7220 696d 706f 7274 616e 745f 6361  for important_ca
-000585b0: 7420 696e 2069 6d70 6f72 7461 6e74 5f63  t in important_c
-000585c0: 6174 733a 0d0a 2020 2020 2020 2020 6966  ats:..        if
-000585d0: 2073 7472 2874 7261 696e 5b69 6d70 6f72   str(train[impor
-000585e0: 7461 6e74 5f63 6174 5d2e 6474 7970 6529  tant_cat].dtype)
-000585f0: 203d 3d20 2763 6174 6567 6f72 7927 3a0d   == 'category':.
-00058600: 0a20 2020 2020 2020 2020 2020 2074 7261  .            tra
-00058610: 696e 5b69 6d70 6f72 7461 6e74 5f63 6174  in[important_cat
-00058620: 5d20 3d20 7472 6169 6e5b 696d 706f 7274  ] = train[import
-00058630: 616e 745f 6361 745d 2e61 7374 7970 6528  ant_cat].astype(
-00058640: 696e 7429 0d0a 2020 2020 2323 2323 2323  int)..    ######
-00058650: 2323 2020 2020 4472 6f70 204d 6973 7369  ##    Drop Missi
-00058660: 6e67 2076 616c 7565 2072 6f77 7320 7369  ng value rows si
-00058670: 6e63 6520 5847 4220 666f 7220 736f 6d65  nce XGB for some
-00058680: 2072 6561 736f 6e20 2023 2323 2323 2323   reason  #######
-00058690: 2323 0d0a 2020 2020 2323 2323 2323 2323  ##..    ########
-000586a0: 2020 2020 6361 6e27 7420 6861 6e64 6c65      can't handle
-000586b0: 206d 6973 7369 6e67 2076 616c 7565 7320   missing values 
-000586c0: 696e 2065 6172 6c79 2073 746f 7070 696e  in early stoppin
-000586d0: 6720 726f 756e 6473 2023 2323 2323 2323  g rounds #######
-000586e0: 0d0a 2020 2020 7472 6169 6e2e 6472 6f70  ..    train.drop
-000586f0: 6e61 2861 7869 733d 302c 7375 6273 6574  na(axis=0,subset
-00058700: 3d70 7265 6473 2b5b 7461 7267 6574 5d2c  =preds+[target],
-00058710: 696e 706c 6163 653d 5472 7565 290d 0a20  inplace=True).. 
-00058720: 2020 2023 2323 2323 2323 2320 2020 446f     ########   Do
-00058730: 6e74 206d 6f76 6520 7468 6973 2074 7261  nt move this tra
-00058740: 696e 2061 6e64 2079 2064 6566 696e 6974  in and y definit
-00058750: 696f 6e20 616e 7977 6865 7265 2065 6c73  ion anywhere els
-00058760: 6520 2323 2323 2323 2323 0d0a 2020 2020  e ########..    
-00058770: 7920 3d20 7472 6169 6e5b 7461 7267 6574  y = train[target
-00058780: 5d0d 0a20 2020 2070 7269 6e74 2827 2323  ]..    print('##
+00058380: 2063 6f72 725f 6c69 6d69 742c 7665 7262   corr_limit,verb
+00058390: 6f73 6529 0d0a 2020 2020 2320 2020 2069  ose)..    #    i
+000583a0: 6620 7665 7262 6f73 6520 3e3d 2031 3a0d  f verbose >= 1:.
+000583b0: 0a20 2020 2023 2020 2020 2020 2020 7072  .    #        pr
+000583c0: 696e 7428 2754 696d 6520 7461 6b65 6e20  int('Time taken 
+000583d0: 666f 7220 7265 6475 6369 6e67 2068 6967  for reducing hig
+000583e0: 686c 7920 636f 7272 656c 6174 6564 2043  hly correlated C
+000583f0: 6174 6567 6f72 6963 616c 2076 6172 7320  ategorical vars 
+00058400: 7761 7320 2530 2e30 6620 7365 636f 6e64  was %0.0f second
+00058410: 7327 2025 2874 696d 652e 7469 6d65 2829  s' %(time.time()
+00058420: 2d73 7461 7274 5f74 696d 6529 290d 0a20  -start_time)).. 
+00058430: 2020 2023 656c 7365 3a0d 0a20 2020 2069     #else:..    i
+00058440: 6d70 6f72 7461 6e74 5f63 6174 7320 3d20  mportant_cats = 
+00058450: 636f 7079 2e64 6565 7063 6f70 7928 6361  copy.deepcopy(ca
+00058460: 7476 6172 7329 0d0a 2020 2020 7072 696e  tvars)..    prin
+00058470: 7428 2720 2020 2028 2564 2920 6361 7465  t('    (%d) cate
+00058480: 676f 7269 6361 6c20 7661 7273 2e2e 2e27  gorical vars...'
+00058490: 2025 286c 656e 2863 6174 7661 7273 2929   %(len(catvars))
+000584a0: 290d 0a20 2020 2066 696e 616c 5f6c 6973  )..    final_lis
+000584b0: 7420 3d20 636f 7079 2e64 6565 7063 6f70  t = copy.deepcop
+000584c0: 7928 6e75 6d76 6172 7329 0d0a 2020 2020  y(numvars)..    
+000584d0: 6966 2020 6973 696e 7374 616e 6365 2866  if  isinstance(f
+000584e0: 696e 616c 5f6c 6973 742c 6e70 2e6e 6461  inal_list,np.nda
+000584f0: 7272 6179 293a 0d0a 2020 2020 2020 2020  rray):..        
+00058500: 6669 6e61 6c5f 6c69 7374 203d 2066 696e  final_list = fin
+00058510: 616c 5f6c 6973 742e 746f 6c69 7374 2829  al_list.tolist()
+00058520: 0d0a 2020 2020 7072 6564 7320 3d20 6669  ..    preds = fi
+00058530: 6e61 6c5f 6c69 7374 2b69 6d70 6f72 7461  nal_list+importa
+00058540: 6e74 5f63 6174 730d 0a20 2020 2023 2323  nt_cats..    ###
+00058550: 2323 2323 596f 7520 6d75 7374 2063 6f6e  ####You must con
+00058560: 7665 7274 2063 6174 6567 6f72 7920 7661  vert category va
+00058570: 7269 6162 6c65 7320 696e 746f 2069 6e74  riables into int
+00058580: 6567 6572 7320 2323 2323 2323 2323 2323  egers ##########
+00058590: 2323 2323 230d 0a20 2020 2066 6f72 2069  #####..    for i
+000585a0: 6d70 6f72 7461 6e74 5f63 6174 2069 6e20  mportant_cat in 
+000585b0: 696d 706f 7274 616e 745f 6361 7473 3a0d  important_cats:.
+000585c0: 0a20 2020 2020 2020 2069 6620 7374 7228  .        if str(
+000585d0: 7472 6169 6e5b 696d 706f 7274 616e 745f  train[important_
+000585e0: 6361 745d 2e64 7479 7065 2920 3d3d 2027  cat].dtype) == '
+000585f0: 6361 7465 676f 7279 273a 0d0a 2020 2020  category':..    
+00058600: 2020 2020 2020 2020 7472 6169 6e5b 696d          train[im
+00058610: 706f 7274 616e 745f 6361 745d 203d 2074  portant_cat] = t
+00058620: 7261 696e 5b69 6d70 6f72 7461 6e74 5f63  rain[important_c
+00058630: 6174 5d2e 6173 7479 7065 2869 6e74 290d  at].astype(int).
+00058640: 0a20 2020 2023 2323 2323 2323 2320 2020  .    ########   
+00058650: 2044 726f 7020 4d69 7373 696e 6720 7661   Drop Missing va
+00058660: 6c75 6520 726f 7773 2073 696e 6365 2058  lue rows since X
+00058670: 4742 2066 6f72 2073 6f6d 6520 7265 6173  GB for some reas
+00058680: 6f6e 2020 2323 2323 2323 2323 230d 0a20  on  #########.. 
+00058690: 2020 2023 2323 2323 2323 2320 2020 2063     ########    c
+000586a0: 616e 2774 2068 616e 646c 6520 6d69 7373  an't handle miss
+000586b0: 696e 6720 7661 6c75 6573 2069 6e20 6561  ing values in ea
+000586c0: 726c 7920 7374 6f70 7069 6e67 2072 6f75  rly stopping rou
+000586d0: 6e64 7320 2323 2323 2323 230d 0a20 2020  nds #######..   
+000586e0: 2074 7261 696e 2e64 726f 706e 6128 6178   train.dropna(ax
+000586f0: 6973 3d30 2c73 7562 7365 743d 7072 6564  is=0,subset=pred
+00058700: 732b 5b74 6172 6765 745d 2c69 6e70 6c61  s+[target],inpla
+00058710: 6365 3d54 7275 6529 0d0a 2020 2020 2323  ce=True)..    ##
+00058720: 2323 2323 2323 2020 2044 6f6e 7420 6d6f  ######   Dont mo
+00058730: 7665 2074 6869 7320 7472 6169 6e20 616e  ve this train an
+00058740: 6420 7920 6465 6669 6e69 7469 6f6e 2061  d y definition a
+00058750: 6e79 7768 6572 6520 656c 7365 2023 2323  nywhere else ###
+00058760: 2323 2323 230d 0a20 2020 2079 203d 2074  #####..    y = t
+00058770: 7261 696e 5b74 6172 6765 745d 0d0a 2020  rain[target]..  
+00058780: 2020 7072 696e 7428 2723 2323 2323 2323    print('#######
 00058790: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000587a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000587b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000587c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000587d0: 2323 2323 2323 2323 2323 2323 2327 290d  #############').
-000587e0: 0a20 2020 2070 7269 6e74 2827 2323 2323  .    print('####
-000587f0: 2323 2320 2020 2020 4620 4520 4120 5420  ###     F E A T 
-00058800: 5520 5220 4520 2020 5320 4520 4c20 4520  U R E   S E L E 
-00058810: 4320 5420 4920 4f20 4e20 2020 2042 5920  C T I O N    BY 
-00058820: 2020 5820 4720 4220 4f20 4f20 5320 5420    X G B O O S T 
-00058830: 2020 2023 2323 2323 2323 2327 290d 0a20     ########').. 
-00058840: 2020 2070 7269 6e74 2827 2323 2323 2323     print('######
+000587d0: 2323 2323 2323 2323 2729 0d0a 2020 2020  ########')..    
+000587e0: 7072 696e 7428 2723 2323 2323 2323 2020  print('#######  
+000587f0: 2020 2046 2045 2041 2054 2055 2052 2045     F E A T U R E
+00058800: 2020 2053 2045 204c 2045 2043 2054 2049     S E L E C T I
+00058810: 204f 204e 2020 2020 4259 2020 2058 2047   O N    BY   X G
+00058820: 2042 204f 204f 2053 2054 2020 2020 2323   B O O S T    ##
+00058830: 2323 2323 2323 2729 0d0a 2020 2020 7072  ######')..    pr
+00058840: 696e 7428 2723 2323 2323 2323 2323 2323  int('###########
 00058850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00058860: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00058870: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00058880: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00058890: 2323 2323 2323 2323 2327 290d 0a20 2020  #########')..   
-000588a0: 2069 6d70 6f72 7461 6e74 5f66 6561 7475   important_featu
-000588b0: 7265 7320 3d20 5b5d 0d0a 2020 2020 6966  res = []..    if
-000588c0: 206d 6f64 656c 7479 7065 203d 3d20 2752   modeltype == 'R
-000588d0: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
-000588e0: 2020 2020 206f 626a 6563 7469 7665 203d       objective =
-000588f0: 2027 7265 673a 7371 7561 7265 6465 7272   'reg:squarederr
-00058900: 6f72 270d 0a20 2020 2020 2020 206d 6f64  or'..        mod
-00058910: 656c 5f78 6762 203d 2058 4742 5265 6772  el_xgb = XGBRegr
-00058920: 6573 736f 7228 206e 5f65 7374 696d 6174  essor( n_estimat
-00058930: 6f72 733d 3130 302c 7375 6273 616d 706c  ors=100,subsampl
-00058940: 653d 7375 6273 616d 706c 652c 6f62 6a65  e=subsample,obje
-00058950: 6374 6976 653d 6f62 6a65 6374 6976 652c  ctive=objective,
-00058960: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00058970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00058980: 2020 636f 6c73 616d 706c 655f 6279 7472    colsample_bytr
-00058990: 6565 3d63 6f6c 5f73 7562 5f73 616d 706c  ee=col_sub_sampl
-000589a0: 652c 7265 675f 616c 7068 613d 302e 352c  e,reg_alpha=0.5,
-000589b0: 2072 6567 5f6c 616d 6264 613d 302e 352c   reg_lambda=0.5,
-000589c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000589d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000589e0: 2020 2073 6565 643d 312c 7261 6e64 6f6d     seed=1,random
-000589f0: 5f73 7461 7465 3d31 2c6e 5f6a 6f62 733d  _state=1,n_jobs=
-00058a00: 2d31 2c20 6e74 6872 6561 643d 2d31 290d  -1, nthread=-1).
-00058a10: 0a20 2020 2020 2020 2065 7661 6c5f 6d65  .        eval_me
-00058a20: 7472 6963 203d 2027 726d 7365 270d 0a20  tric = 'rmse'.. 
-00058a30: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00058a40: 2020 2323 2323 2054 6869 7320 6973 2066    #### This is f
-00058a50: 6f72 2043 6c61 7373 6966 6965 7273 206f  or Classifiers o
-00058a60: 6e6c 790d 0a20 2020 2020 2020 2063 6c61  nly..        cla
-00058a70: 7373 6573 203d 206e 702e 756e 6971 7565  sses = np.unique
-00058a80: 2874 7261 696e 5b74 6172 6765 745d 2e76  (train[target].v
-00058a90: 616c 7565 7329 0d0a 2020 2020 2020 2020  alues)..        
-00058aa0: 6966 206c 656e 2863 6c61 7373 6573 2920  if len(classes) 
-00058ab0: 3d3d 2032 3a0d 0a20 2020 2020 2020 2020  == 2:..         
-00058ac0: 2020 206d 6f64 656c 5f78 6762 203d 2058     model_xgb = X
-00058ad0: 4742 436c 6173 7369 6669 6572 2862 6173  GBClassifier(bas
-00058ae0: 655f 7363 6f72 653d 302e 352c 2062 6f6f  e_score=0.5, boo
-00058af0: 7374 6572 3d27 6762 7472 6565 272c 2073  ster='gbtree', s
-00058b00: 7562 7361 6d70 6c65 3d73 7562 7361 6d70  ubsample=subsamp
-00058b10: 6c65 2c0d 0a20 2020 2020 2020 2020 2020  le,..           
-00058b20: 2020 2020 2063 6f6c 7361 6d70 6c65 5f62       colsample_b
-00058b30: 7974 7265 653d 636f 6c5f 7375 625f 7361  ytree=col_sub_sa
-00058b40: 6d70 6c65 2c67 616d 6d61 3d31 2c20 6c65  mple,gamma=1, le
-00058b50: 6172 6e69 6e67 5f72 6174 653d 302e 312c  arning_rate=0.1,
-00058b60: 206d 6178 5f64 656c 7461 5f73 7465 703d   max_delta_step=
-00058b70: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
-00058b80: 2020 2020 6d61 785f 6465 7074 683d 6d61      max_depth=ma
-00058b90: 785f 6465 7074 682c 206d 696e 5f63 6869  x_depth, min_chi
-00058ba0: 6c64 5f77 6569 6768 743d 312c 206d 6973  ld_weight=1, mis
-00058bb0: 7369 6e67 3d2d 3939 392c 206e 5f65 7374  sing=-999, n_est
-00058bc0: 696d 6174 6f72 733d 3230 302c 0d0a 2020  imators=200,..  
-00058bd0: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
-00058be0: 6a6f 6273 3d2d 312c 206e 7468 7265 6164  jobs=-1, nthread
-00058bf0: 3d2d 312c 206f 626a 6563 7469 7665 3d27  =-1, objective='
-00058c00: 6269 6e61 7279 3a6c 6f67 6973 7469 6327  binary:logistic'
-00058c10: 2c20 7573 655f 6c61 6265 6c5f 656e 636f  , use_label_enco
-00058c20: 6465 723d 4661 6c73 652c 0d0a 2020 2020  der=False,..    
-00058c30: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
-00058c40: 6f6d 5f73 7461 7465 3d31 2c20 7265 675f  om_state=1, reg_
-00058c50: 616c 7068 613d 302e 352c 2072 6567 5f6c  alpha=0.5, reg_l
-00058c60: 616d 6264 613d 302e 352c 0d0a 2020 2020  ambda=0.5,..    
-00058c70: 2020 2020 2020 2020 2020 2020 7365 6564              seed
-00058c80: 3d31 290d 0a20 2020 2020 2020 2020 2020  =1)..           
-00058c90: 2065 7661 6c5f 6d65 7472 6963 203d 2027   eval_metric = '
-00058ca0: 6c6f 676c 6f73 7327 0d0a 2020 2020 2020  logloss'..      
-00058cb0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00058cc0: 2020 2020 206d 6f64 656c 5f78 6762 203d       model_xgb =
-00058cd0: 2058 4742 436c 6173 7369 6669 6572 2862   XGBClassifier(b
-00058ce0: 6173 655f 7363 6f72 653d 302e 352c 2062  ase_score=0.5, b
-00058cf0: 6f6f 7374 6572 3d27 6762 7472 6565 272c  ooster='gbtree',
-00058d00: 2073 7562 7361 6d70 6c65 3d73 7562 7361   subsample=subsa
-00058d10: 6d70 6c65 2c0d 0a20 2020 2020 2020 2020  mple,..         
-00058d20: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00058d30: 6f6c 7361 6d70 6c65 5f62 7974 7265 653d  olsample_bytree=
-00058d40: 636f 6c5f 7375 625f 7361 6d70 6c65 2c20  col_sub_sample, 
-00058d50: 6761 6d6d 613d 312c 206c 6561 726e 696e  gamma=1, learnin
-00058d60: 675f 7261 7465 3d30 2e31 2c20 6d61 785f  g_rate=0.1, max_
-00058d70: 6465 6c74 615f 7374 6570 3d30 2c0d 0a20  delta_step=0,.. 
-00058d80: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00058d90: 6178 5f64 6570 7468 3d6d 6178 5f64 6570  ax_depth=max_dep
-00058da0: 7468 2c20 6d69 6e5f 6368 696c 645f 7765  th, min_child_we
-00058db0: 6967 6874 3d31 2c20 6d69 7373 696e 673d  ight=1, missing=
-00058dc0: 2d39 3939 2c20 6e5f 6573 7469 6d61 746f  -999, n_estimato
-00058dd0: 7273 3d32 3030 2c0d 0a20 2020 2020 2020  rs=200,..       
-00058de0: 2020 2020 2020 2020 206e 5f6a 6f62 733d           n_jobs=
-00058df0: 2d31 2c20 6e74 6872 6561 643d 2d31 2c20  -1, nthread=-1, 
-00058e00: 6f62 6a65 6374 6976 653d 276d 756c 7469  objective='multi
-00058e10: 3a73 6f66 746d 6178 272c 2075 7365 5f6c  :softmax', use_l
-00058e20: 6162 656c 5f65 6e63 6f64 6572 3d46 616c  abel_encoder=Fal
-00058e30: 7365 2c0d 0a20 2020 2020 2020 2020 2020  se,..           
-00058e40: 2020 2020 2072 616e 646f 6d5f 7374 6174       random_stat
-00058e50: 653d 312c 2072 6567 5f61 6c70 6861 3d30  e=1, reg_alpha=0
-00058e60: 2e35 2c20 7265 675f 6c61 6d62 6461 3d30  .5, reg_lambda=0
-00058e70: 2e35 2c0d 0a20 2020 2020 2020 2020 2020  .5,..           
-00058e80: 2020 2020 2073 6565 643d 3129 0d0a 2020       seed=1)..  
-00058e90: 2020 2020 2020 2020 2020 6576 616c 5f6d            eval_m
-00058ea0: 6574 7269 6320 3d20 276d 6c6f 676c 6f73  etric = 'mloglos
-00058eb0: 7327 0d0a 2020 2020 2323 2323 2020 2054  s'..    ####   T
-00058ec0: 6869 7320 6973 2077 6865 7265 2079 6f75  his is where you
-00058ed0: 2073 7461 7274 2074 6f20 4974 6572 6174   start to Iterat
-00058ee0: 6520 6f6e 2046 696e 6469 6e67 2049 6d70  e on Finding Imp
-00058ef0: 6f72 7461 6e74 2046 6561 7475 7265 7320  ortant Features 
-00058f00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00058f10: 0d0a 2020 2020 7361 7665 5f78 6762 203d  ..    save_xgb =
-00058f20: 2063 6f70 792e 6465 6570 636f 7079 286d   copy.deepcopy(m
-00058f30: 6f64 656c 5f78 6762 290d 0a20 2020 2074  odel_xgb)..    t
-00058f40: 7261 696e 5f70 203d 2074 7261 696e 5b70  rain_p = train[p
-00058f50: 7265 6473 5d0d 0a20 2020 2069 6620 7472  reds]..    if tr
-00058f60: 6169 6e5f 702e 7368 6170 655b 315d 203c  ain_p.shape[1] <
-00058f70: 2031 303a 0d0a 2020 2020 2020 2020 6974   10:..        it
-00058f80: 6572 5f6c 696d 6974 203d 2032 0d0a 2020  er_limit = 2..  
-00058f90: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00058fa0: 2069 7465 725f 6c69 6d69 7420 3d20 696e   iter_limit = in
-00058fb0: 7428 7472 6169 6e5f 702e 7368 6170 655b  t(train_p.shape[
-00058fc0: 315d 2f35 2b30 2e35 290d 0a20 2020 2070  1]/5+0.5)..    p
-00058fd0: 7269 6e74 2827 4375 7272 656e 7420 6e75  rint('Current nu
-00058fe0: 6d62 6572 206f 6620 7072 6564 6963 746f  mber of predicto
-00058ff0: 7273 203d 2025 6420 2720 2528 7472 6169  rs = %d ' %(trai
-00059000: 6e5f 702e 7368 6170 655b 315d 2c29 290d  n_p.shape[1],)).
-00059010: 0a20 2020 2070 7269 6e74 2827 2020 2020  .    print('    
-00059020: 4669 6e64 696e 6720 496d 706f 7274 616e  Finding Importan
-00059030: 7420 4665 6174 7572 6573 2075 7369 6e67  t Features using
-00059040: 2042 6f6f 7374 6564 2054 7265 6573 2061   Boosted Trees a
-00059050: 6c67 6f72 6974 686d 2e2e 2e27 290d 0a20  lgorithm...').. 
-00059060: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-00059070: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-00059080: 302c 7472 6169 6e5f 702e 7368 6170 655b  0,train_p.shape[
-00059090: 315d 2c69 7465 725f 6c69 6d69 7429 3a0d  1],iter_limit):.
-000590a0: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
-000590b0: 5f78 6762 203d 2063 6f70 792e 6465 6570  _xgb = copy.deep
-000590c0: 636f 7079 2873 6176 655f 7867 6229 0d0a  copy(save_xgb)..
-000590d0: 2020 2020 2020 2020 2020 2020 6966 2074              if t
-000590e0: 7261 696e 5f70 2e73 6861 7065 5b31 5d2d  rain_p.shape[1]-
-000590f0: 6920 3c20 323a 0d0a 2020 2020 2020 2020  i < 2:..        
-00059100: 2020 2020 2020 2020 2323 2320 4966 2074          ### If t
-00059110: 6865 7265 2069 7320 6a75 7374 206f 6e65  here is just one
-00059120: 2076 6172 6961 626c 6520 6c65 6674 2c20   variable left, 
-00059130: 7468 656e 206a 7573 7420 736b 6970 2069  then just skip i
-00059140: 7420 2323 2323 230d 0a20 2020 2020 2020  t #####..       
-00059150: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
-00059160: 650d 0a20 2020 2020 2020 2020 2020 2065  e..            e
-00059170: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00059180: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-00059190: 2020 2020 2075 7369 6e67 2025 6420 7661       using %d va
-000591a0: 7269 6162 6c65 732e 2e2e 2720 2528 7472  riables...' %(tr
-000591b0: 6169 6e5f 702e 7368 6170 655b 315d 2d69  ain_p.shape[1]-i
-000591c0: 2929 0d0a 0d0a 2020 2020 2020 2020 2020  ))....          
-000591d0: 2020 6966 2074 7261 696e 5f70 2e73 6861    if train_p.sha
-000591e0: 7065 5b31 5d2d 6920 3c20 6974 6572 5f6c  pe[1]-i < iter_l
-000591f0: 696d 6974 3a0d 0a20 2020 2020 2020 2020  imit:..         
-00059200: 2020 2020 2020 2058 203d 2074 7261 696e         X = train
-00059210: 5f70 2e69 6c6f 635b 3a2c 693a 5d0d 0a20  _p.iloc[:,i:].. 
-00059220: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00059230: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
-00059240: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
-00059250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059260: 2020 7472 6169 6e5f 7061 7274 203d 2069    train_part = i
-00059270: 6e74 2828 312d 7465 7374 5f73 697a 6529  nt((1-test_size)
-00059280: 2a58 2e73 6861 7065 5b30 5d29 0d0a 2020  *X.shape[0])..  
-00059290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000592a0: 2020 585f 7472 6169 6e2c 2058 5f63 762c    X_train, X_cv,
-000592b0: 2079 5f74 7261 696e 2c20 795f 6376 203d   y_train, y_cv =
-000592c0: 2058 5b3a 7472 6169 6e5f 7061 7274 5d2c   X[:train_part],
-000592d0: 585b 7472 6169 6e5f 7061 7274 3a5d 2c79  X[train_part:],y
-000592e0: 5b3a 7472 6169 6e5f 7061 7274 5d2c 795b  [:train_part],y[
-000592f0: 7472 6169 6e5f 7061 7274 3a5d 0d0a 2020  train_part:]..  
-00059300: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00059310: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00059320: 2020 2020 2020 2020 2058 5f74 7261 696e           X_train
-00059330: 2c20 585f 6376 2c20 795f 7472 6169 6e2c  , X_cv, y_train,
-00059340: 2079 5f63 7620 3d20 7472 6169 6e5f 7465   y_cv = train_te
-00059350: 7374 5f73 706c 6974 2858 2c20 792c 0d0a  st_split(X, y,..
+00058890: 2323 2323 2729 0d0a 2020 2020 696d 706f  ####')..    impo
+000588a0: 7274 616e 745f 6665 6174 7572 6573 203d  rtant_features =
+000588b0: 205b 5d0d 0a20 2020 2069 6620 6d6f 6465   []..    if mode
+000588c0: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
+000588d0: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
+000588e0: 6f62 6a65 6374 6976 6520 3d20 2772 6567  objective = 'reg
+000588f0: 3a73 7175 6172 6564 6572 726f 7227 0d0a  :squarederror'..
+00058900: 2020 2020 2020 2020 6d6f 6465 6c5f 7867          model_xg
+00058910: 6220 3d20 5847 4252 6567 7265 7373 6f72  b = XGBRegressor
+00058920: 2820 6e5f 6573 7469 6d61 746f 7273 3d31  ( n_estimators=1
+00058930: 3030 2c73 7562 7361 6d70 6c65 3d73 7562  00,subsample=sub
+00058940: 7361 6d70 6c65 2c6f 626a 6563 7469 7665  sample,objective
+00058950: 3d6f 626a 6563 7469 7665 2c0d 0a20 2020  =objective,..   
+00058960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00058970: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+00058980: 7361 6d70 6c65 5f62 7974 7265 653d 636f  sample_bytree=co
+00058990: 6c5f 7375 625f 7361 6d70 6c65 2c72 6567  l_sub_sample,reg
+000589a0: 5f61 6c70 6861 3d30 2e35 2c20 7265 675f  _alpha=0.5, reg_
+000589b0: 6c61 6d62 6461 3d30 2e35 2c0d 0a20 2020  lambda=0.5,..   
+000589c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000589d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000589e0: 6564 3d31 2c72 616e 646f 6d5f 7374 6174  ed=1,random_stat
+000589f0: 653d 312c 6e5f 6a6f 6273 3d2d 312c 206e  e=1,n_jobs=-1, n
+00058a00: 7468 7265 6164 3d2d 3129 0d0a 2020 2020  thread=-1)..    
+00058a10: 2020 2020 6576 616c 5f6d 6574 7269 6320      eval_metric 
+00058a20: 3d20 2772 6d73 6527 0d0a 2020 2020 656c  = 'rmse'..    el
+00058a30: 7365 3a0d 0a20 2020 2020 2020 2023 2323  se:..        ###
+00058a40: 2320 5468 6973 2069 7320 666f 7220 436c  # This is for Cl
+00058a50: 6173 7369 6669 6572 7320 6f6e 6c79 0d0a  assifiers only..
+00058a60: 2020 2020 2020 2020 636c 6173 7365 7320          classes 
+00058a70: 3d20 6e70 2e75 6e69 7175 6528 7472 6169  = np.unique(trai
+00058a80: 6e5b 7461 7267 6574 5d2e 7661 6c75 6573  n[target].values
+00058a90: 290d 0a20 2020 2020 2020 2069 6620 6c65  )..        if le
+00058aa0: 6e28 636c 6173 7365 7329 203d 3d20 323a  n(classes) == 2:
+00058ab0: 0d0a 2020 2020 2020 2020 2020 2020 6d6f  ..            mo
+00058ac0: 6465 6c5f 7867 6220 3d20 5847 4243 6c61  del_xgb = XGBCla
+00058ad0: 7373 6966 6965 7228 6261 7365 5f73 636f  ssifier(base_sco
+00058ae0: 7265 3d30 2e35 2c20 626f 6f73 7465 723d  re=0.5, booster=
+00058af0: 2767 6274 7265 6527 2c20 7375 6273 616d  'gbtree', subsam
+00058b00: 706c 653d 7375 6273 616d 706c 652c 0d0a  ple=subsample,..
+00058b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00058b20: 636f 6c73 616d 706c 655f 6279 7472 6565  colsample_bytree
+00058b30: 3d63 6f6c 5f73 7562 5f73 616d 706c 652c  =col_sub_sample,
+00058b40: 6761 6d6d 613d 312c 206c 6561 726e 696e  gamma=1, learnin
+00058b50: 675f 7261 7465 3d30 2e31 2c20 6d61 785f  g_rate=0.1, max_
+00058b60: 6465 6c74 615f 7374 6570 3d30 2c0d 0a20  delta_step=0,.. 
+00058b70: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00058b80: 6178 5f64 6570 7468 3d6d 6178 5f64 6570  ax_depth=max_dep
+00058b90: 7468 2c20 6d69 6e5f 6368 696c 645f 7765  th, min_child_we
+00058ba0: 6967 6874 3d31 2c20 6d69 7373 696e 673d  ight=1, missing=
+00058bb0: 2d39 3939 2c20 6e5f 6573 7469 6d61 746f  -999, n_estimato
+00058bc0: 7273 3d32 3030 2c0d 0a20 2020 2020 2020  rs=200,..       
+00058bd0: 2020 2020 2020 2020 206e 5f6a 6f62 733d           n_jobs=
+00058be0: 2d31 2c20 6e74 6872 6561 643d 2d31 2c20  -1, nthread=-1, 
+00058bf0: 6f62 6a65 6374 6976 653d 2762 696e 6172  objective='binar
+00058c00: 793a 6c6f 6769 7374 6963 272c 2075 7365  y:logistic', use
+00058c10: 5f6c 6162 656c 5f65 6e63 6f64 6572 3d46  _label_encoder=F
+00058c20: 616c 7365 2c0d 0a20 2020 2020 2020 2020  alse,..         
+00058c30: 2020 2020 2020 2072 616e 646f 6d5f 7374         random_st
+00058c40: 6174 653d 312c 2072 6567 5f61 6c70 6861  ate=1, reg_alpha
+00058c50: 3d30 2e35 2c20 7265 675f 6c61 6d62 6461  =0.5, reg_lambda
+00058c60: 3d30 2e35 2c0d 0a20 2020 2020 2020 2020  =0.5,..         
+00058c70: 2020 2020 2020 2073 6565 643d 3129 0d0a         seed=1)..
+00058c80: 2020 2020 2020 2020 2020 2020 6576 616c              eval
+00058c90: 5f6d 6574 7269 6320 3d20 276c 6f67 6c6f  _metric = 'loglo
+00058ca0: 7373 270d 0a20 2020 2020 2020 2065 6c73  ss'..        els
+00058cb0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00058cc0: 6d6f 6465 6c5f 7867 6220 3d20 5847 4243  model_xgb = XGBC
+00058cd0: 6c61 7373 6966 6965 7228 6261 7365 5f73  lassifier(base_s
+00058ce0: 636f 7265 3d30 2e35 2c20 626f 6f73 7465  core=0.5, booste
+00058cf0: 723d 2767 6274 7265 6527 2c20 7375 6273  r='gbtree', subs
+00058d00: 616d 706c 653d 7375 6273 616d 706c 652c  ample=subsample,
+00058d10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00058d20: 2020 2020 2020 2020 2020 636f 6c73 616d            colsam
+00058d30: 706c 655f 6279 7472 6565 3d63 6f6c 5f73  ple_bytree=col_s
+00058d40: 7562 5f73 616d 706c 652c 2067 616d 6d61  ub_sample, gamma
+00058d50: 3d31 2c20 6c65 6172 6e69 6e67 5f72 6174  =1, learning_rat
+00058d60: 653d 302e 312c 206d 6178 5f64 656c 7461  e=0.1, max_delta
+00058d70: 5f73 7465 703d 302c 0d0a 2020 2020 2020  _step=0,..      
+00058d80: 2020 2020 2020 2020 2020 6d61 785f 6465            max_de
+00058d90: 7074 683d 6d61 785f 6465 7074 682c 206d  pth=max_depth, m
+00058da0: 696e 5f63 6869 6c64 5f77 6569 6768 743d  in_child_weight=
+00058db0: 312c 206d 6973 7369 6e67 3d2d 3939 392c  1, missing=-999,
+00058dc0: 206e 5f65 7374 696d 6174 6f72 733d 3230   n_estimators=20
+00058dd0: 302c 0d0a 2020 2020 2020 2020 2020 2020  0,..            
+00058de0: 2020 2020 6e5f 6a6f 6273 3d2d 312c 206e      n_jobs=-1, n
+00058df0: 7468 7265 6164 3d2d 312c 206f 626a 6563  thread=-1, objec
+00058e00: 7469 7665 3d27 6d75 6c74 693a 736f 6674  tive='multi:soft
+00058e10: 6d61 7827 2c20 7573 655f 6c61 6265 6c5f  max', use_label_
+00058e20: 656e 636f 6465 723d 4661 6c73 652c 0d0a  encoder=False,..
+00058e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00058e40: 7261 6e64 6f6d 5f73 7461 7465 3d31 2c20  random_state=1, 
+00058e50: 7265 675f 616c 7068 613d 302e 352c 2072  reg_alpha=0.5, r
+00058e60: 6567 5f6c 616d 6264 613d 302e 352c 0d0a  eg_lambda=0.5,..
+00058e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00058e80: 7365 6564 3d31 290d 0a20 2020 2020 2020  seed=1)..       
+00058e90: 2020 2020 2065 7661 6c5f 6d65 7472 6963       eval_metric
+00058ea0: 203d 2027 6d6c 6f67 6c6f 7373 270d 0a20   = 'mlogloss'.. 
+00058eb0: 2020 2023 2323 2320 2020 5468 6973 2069     ####   This i
+00058ec0: 7320 7768 6572 6520 796f 7520 7374 6172  s where you star
+00058ed0: 7420 746f 2049 7465 7261 7465 206f 6e20  t to Iterate on 
+00058ee0: 4669 6e64 696e 6720 496d 706f 7274 616e  Finding Importan
+00058ef0: 7420 4665 6174 7572 6573 2023 2323 2323  t Features #####
+00058f00: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+00058f10: 2073 6176 655f 7867 6220 3d20 636f 7079   save_xgb = copy
+00058f20: 2e64 6565 7063 6f70 7928 6d6f 6465 6c5f  .deepcopy(model_
+00058f30: 7867 6229 0d0a 2020 2020 7472 6169 6e5f  xgb)..    train_
+00058f40: 7020 3d20 7472 6169 6e5b 7072 6564 735d  p = train[preds]
+00058f50: 0d0a 2020 2020 6966 2074 7261 696e 5f70  ..    if train_p
+00058f60: 2e73 6861 7065 5b31 5d20 3c20 3130 3a0d  .shape[1] < 10:.
+00058f70: 0a20 2020 2020 2020 2069 7465 725f 6c69  .        iter_li
+00058f80: 6d69 7420 3d20 320d 0a20 2020 2065 6c73  mit = 2..    els
+00058f90: 653a 0d0a 2020 2020 2020 2020 6974 6572  e:..        iter
+00058fa0: 5f6c 696d 6974 203d 2069 6e74 2874 7261  _limit = int(tra
+00058fb0: 696e 5f70 2e73 6861 7065 5b31 5d2f 352b  in_p.shape[1]/5+
+00058fc0: 302e 3529 0d0a 2020 2020 7072 696e 7428  0.5)..    print(
+00058fd0: 2743 7572 7265 6e74 206e 756d 6265 7220  'Current number 
+00058fe0: 6f66 2070 7265 6469 6374 6f72 7320 3d20  of predictors = 
+00058ff0: 2564 2027 2025 2874 7261 696e 5f70 2e73  %d ' %(train_p.s
+00059000: 6861 7065 5b31 5d2c 2929 0d0a 2020 2020  hape[1],))..    
+00059010: 7072 696e 7428 2720 2020 2046 696e 6469  print('    Findi
+00059020: 6e67 2049 6d70 6f72 7461 6e74 2046 6561  ng Important Fea
+00059030: 7475 7265 7320 7573 696e 6720 426f 6f73  tures using Boos
+00059040: 7465 6420 5472 6565 7320 616c 676f 7269  ted Trees algori
+00059050: 7468 6d2e 2e2e 2729 0d0a 2020 2020 7472  thm...')..    tr
+00059060: 793a 0d0a 2020 2020 2020 2020 666f 7220  y:..        for 
+00059070: 6920 696e 2072 616e 6765 2830 2c74 7261  i in range(0,tra
+00059080: 696e 5f70 2e73 6861 7065 5b31 5d2c 6974  in_p.shape[1],it
+00059090: 6572 5f6c 696d 6974 293a 0d0a 2020 2020  er_limit):..    
+000590a0: 2020 2020 2020 2020 6e65 775f 7867 6220          new_xgb 
+000590b0: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+000590c0: 7361 7665 5f78 6762 290d 0a20 2020 2020  save_xgb)..     
+000590d0: 2020 2020 2020 2069 6620 7472 6169 6e5f         if train_
+000590e0: 702e 7368 6170 655b 315d 2d69 203c 2032  p.shape[1]-i < 2
+000590f0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00059100: 2020 2023 2323 2049 6620 7468 6572 6520     ### If there 
+00059110: 6973 206a 7573 7420 6f6e 6520 7661 7269  is just one vari
+00059120: 6162 6c65 206c 6566 742c 2074 6865 6e20  able left, then 
+00059130: 6a75 7374 2073 6b69 7020 6974 2023 2323  just skip it ###
+00059140: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
+00059150: 2020 2020 636f 6e74 696e 7565 0d0a 2020      continue..  
+00059160: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00059170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00059180: 2070 7269 6e74 2827 2020 2020 2020 2020   print('        
+00059190: 7573 696e 6720 2564 2076 6172 6961 626c  using %d variabl
+000591a0: 6573 2e2e 2e27 2025 2874 7261 696e 5f70  es...' %(train_p
+000591b0: 2e73 6861 7065 5b31 5d2d 6929 290d 0a0d  .shape[1]-i))...
+000591c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000591d0: 7472 6169 6e5f 702e 7368 6170 655b 315d  train_p.shape[1]
+000591e0: 2d69 203c 2069 7465 725f 6c69 6d69 743a  -i < iter_limit:
+000591f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00059200: 2020 5820 3d20 7472 6169 6e5f 702e 696c    X = train_p.il
+00059210: 6f63 5b3a 2c69 3a5d 0d0a 2020 2020 2020  oc[:,i:]..      
+00059220: 2020 2020 2020 2020 2020 6966 206d 6f64            if mod
+00059230: 656c 7479 7065 203d 3d20 2752 6567 7265  eltype == 'Regre
+00059240: 7373 696f 6e27 3a0d 0a20 2020 2020 2020  ssion':..       
+00059250: 2020 2020 2020 2020 2020 2020 2074 7261               tra
+00059260: 696e 5f70 6172 7420 3d20 696e 7428 2831  in_part = int((1
+00059270: 2d74 6573 745f 7369 7a65 292a 582e 7368  -test_size)*X.sh
+00059280: 6170 655b 305d 290d 0a20 2020 2020 2020  ape[0])..       
+00059290: 2020 2020 2020 2020 2020 2020 2058 5f74               X_t
+000592a0: 7261 696e 2c20 585f 6376 2c20 795f 7472  rain, X_cv, y_tr
+000592b0: 6169 6e2c 2079 5f63 7620 3d20 585b 3a74  ain, y_cv = X[:t
+000592c0: 7261 696e 5f70 6172 745d 2c58 5b74 7261  rain_part],X[tra
+000592d0: 696e 5f70 6172 743a 5d2c 795b 3a74 7261  in_part:],y[:tra
+000592e0: 696e 5f70 6172 745d 2c79 5b74 7261 696e  in_part],y[train
+000592f0: 5f70 6172 743a 5d0d 0a20 2020 2020 2020  _part:]..       
+00059300: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00059310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059320: 2020 2020 585f 7472 6169 6e2c 2058 5f63      X_train, X_c
+00059330: 762c 2079 5f74 7261 696e 2c20 795f 6376  v, y_train, y_cv
+00059340: 203d 2074 7261 696e 5f74 6573 745f 7370   = train_test_sp
+00059350: 6c69 7428 582c 2079 2c0d 0a20 2020 2020  lit(X, y,..     
 00059360: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00059370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059390: 7465 7374 5f73 697a 653d 7465 7374 5f73  test_size=test_s
-000593a0: 697a 652c 2072 616e 646f 6d5f 7374 6174  ize, random_stat
-000593b0: 653d 7365 6564 2c20 7374 7261 7469 6679  e=seed, stratify
-000593c0: 3d79 290d 0a20 2020 2020 2020 2020 2020  =y)..           
-000593d0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-000593e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000593f0: 7661 6c5f 7365 7420 3d20 5b28 585f 7472  val_set = [(X_tr
-00059400: 6169 6e2c 795f 7472 6169 6e29 2c28 585f  ain,y_train),(X_
-00059410: 6376 2c79 5f63 7629 5d0d 0a20 2020 2020  cv,y_cv)]..     
-00059420: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00059430: 6f64 656c 5f78 6762 2e66 6974 2858 5f74  odel_xgb.fit(X_t
-00059440: 7261 696e 2c79 5f74 7261 696e 2c65 6172  rain,y_train,ear
-00059450: 6c79 5f73 746f 7070 696e 675f 726f 756e  ly_stopping_roun
-00059460: 6473 3d65 6172 6c79 5f73 746f 7070 696e  ds=early_stoppin
-00059470: 672c 6576 616c 5f73 6574 3d65 7661 6c5f  g,eval_set=eval_
-00059480: 7365 742c 0d0a 2020 2020 2020 2020 2020  set,..          
+00059380: 2020 2020 2020 2020 2020 2074 6573 745f             test_
+00059390: 7369 7a65 3d74 6573 745f 7369 7a65 2c20  size=test_size, 
+000593a0: 7261 6e64 6f6d 5f73 7461 7465 3d73 6565  random_state=see
+000593b0: 642c 2073 7472 6174 6966 793d 7929 0d0a  d, stratify=y)..
+000593c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000593d0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+000593e0: 2020 2020 2020 2020 2020 6576 616c 5f73            eval_s
+000593f0: 6574 203d 205b 2858 5f74 7261 696e 2c79  et = [(X_train,y
+00059400: 5f74 7261 696e 292c 2858 5f63 762c 795f  _train),(X_cv,y_
+00059410: 6376 295d 0d0a 2020 2020 2020 2020 2020  cv)]..          
+00059420: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
+00059430: 7867 622e 6669 7428 585f 7472 6169 6e2c  xgb.fit(X_train,
+00059440: 795f 7472 6169 6e2c 6561 726c 795f 7374  y_train,early_st
+00059450: 6f70 7069 6e67 5f72 6f75 6e64 733d 6561  opping_rounds=ea
+00059460: 726c 795f 7374 6f70 7069 6e67 2c65 7661  rly_stopping,eva
+00059470: 6c5f 7365 743d 6576 616c 5f73 6574 2c0d  l_set=eval_set,.
+00059480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00059490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000594a0: 2020 2020 2020 2020 2020 2020 2020 6576                ev
-000594b0: 616c 5f6d 6574 7269 633d 6576 616c 5f6d  al_metric=eval_m
-000594c0: 6574 7269 632c 7665 7262 6f73 653d 4661  etric,verbose=Fa
-000594d0: 6c73 6529 0d0a 2020 2020 2020 2020 2020  lse)..          
-000594e0: 2020 2020 2020 2020 2020 696d 706f 7274            import
-000594f0: 616e 745f 6665 6174 7572 6573 202b 3d20  ant_features += 
-00059500: 7064 2e53 6572 6965 7328 6d6f 6465 6c5f  pd.Series(model_
-00059510: 7867 622e 6765 745f 626f 6f73 7465 7228  xgb.get_booster(
-00059520: 292e 6765 745f 7363 6f72 6528 0d0a 2020  ).get_score(..  
+000594a0: 2020 2020 2020 2020 2065 7661 6c5f 6d65           eval_me
+000594b0: 7472 6963 3d65 7661 6c5f 6d65 7472 6963  tric=eval_metric
+000594c0: 2c76 6572 626f 7365 3d46 616c 7365 290d  ,verbose=False).
+000594d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000594e0: 2020 2020 2069 6d70 6f72 7461 6e74 5f66       important_f
+000594f0: 6561 7475 7265 7320 2b3d 2070 642e 5365  eatures += pd.Se
+00059500: 7269 6573 286d 6f64 656c 5f78 6762 2e67  ries(model_xgb.g
+00059510: 6574 5f62 6f6f 7374 6572 2829 2e67 6574  et_booster().get
+00059520: 5f73 636f 7265 280d 0a20 2020 2020 2020  _score(..       
 00059530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059540: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00059550: 706f 7274 616e 6365 5f74 7970 653d 2767  portance_type='g
-00059560: 6169 6e27 2929 2e73 6f72 745f 7661 6c75  ain')).sort_valu
-00059570: 6573 2861 7363 656e 6469 6e67 3d46 616c  es(ascending=Fal
-00059580: 7365 295b 3a74 6f70 5f6e 756d 5d2e 696e  se)[:top_num].in
-00059590: 6465 782e 746f 6c69 7374 2829 0d0a 2020  dex.tolist()..  
-000595a0: 2020 2020 2020 2020 2020 2020 2020 6578                ex
-000595b0: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
-000595c0: 2020 2020 2020 2020 2020 206e 6577 5f78             new_x
-000595d0: 6762 2e66 6974 2858 5f74 7261 696e 2c79  gb.fit(X_train,y
-000595e0: 5f74 7261 696e 2c65 6172 6c79 5f73 746f  _train,early_sto
-000595f0: 7070 696e 675f 726f 756e 6473 3d65 6172  pping_rounds=ear
-00059600: 6c79 5f73 746f 7070 696e 672c 6576 616c  ly_stopping,eval
-00059610: 5f73 6574 3d65 7661 6c5f 7365 742c 0d0a  _set=eval_set,..
+00059540: 2020 2020 2020 2020 2069 6d70 6f72 7461           importa
+00059550: 6e63 655f 7479 7065 3d27 6761 696e 2729  nce_type='gain')
+00059560: 292e 736f 7274 5f76 616c 7565 7328 6173  ).sort_values(as
+00059570: 6365 6e64 696e 673d 4661 6c73 6529 5b3a  cending=False)[:
+00059580: 746f 705f 6e75 6d5d 2e69 6e64 6578 2e74  top_num].index.t
+00059590: 6f6c 6973 7428 290d 0a20 2020 2020 2020  olist()..       
+000595a0: 2020 2020 2020 2020 2065 7863 6570 743a           except:
+000595b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000595c0: 2020 2020 2020 6e65 775f 7867 622e 6669        new_xgb.fi
+000595d0: 7428 585f 7472 6169 6e2c 795f 7472 6169  t(X_train,y_trai
+000595e0: 6e2c 6561 726c 795f 7374 6f70 7069 6e67  n,early_stopping
+000595f0: 5f72 6f75 6e64 733d 6561 726c 795f 7374  _rounds=early_st
+00059600: 6f70 7069 6e67 2c65 7661 6c5f 7365 743d  opping,eval_set=
+00059610: 6576 616c 5f73 6574 2c0d 0a20 2020 2020  eval_set,..     
 00059620: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00059630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059640: 2020 2020 2020 2020 6576 616c 5f6d 6574          eval_met
-00059650: 7269 633d 6576 616c 5f6d 6574 7269 632c  ric=eval_metric,
-00059660: 7665 7262 6f73 653d 4661 6c73 6529 0d0a  verbose=False)..
-00059670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059680: 2020 2020 7072 696e 7428 2758 4742 2068      print('XGB h
-00059690: 6173 2061 2062 7567 2069 6e20 7665 7273  as a bug in vers
-000596a0: 696f 6e20 7867 626f 6f73 7420 312e 3032  ion xgboost 1.02
-000596b0: 2066 6f72 2066 6561 7475 7265 2069 6d70   for feature imp
-000596c0: 6f72 7461 6e63 6573 2e20 5472 7920 746f  ortances. Try to
-000596d0: 2069 6e73 7461 6c6c 2076 6572 7369 6f6e   install version
-000596e0: 2030 2e39 3020 6f72 2031 2e31 3020 2d20   0.90 or 1.10 - 
-000596f0: 636f 6e74 696e 7569 6e67 2e2e 2e27 290d  continuing...').
-00059700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00059710: 2020 2020 2069 6d70 6f72 7461 6e74 5f66       important_f
-00059720: 6561 7475 7265 7320 2b3d 2070 642e 5365  eatures += pd.Se
-00059730: 7269 6573 286e 6577 5f78 6762 2e67 6574  ries(new_xgb.get
-00059740: 5f62 6f6f 7374 6572 2829 2e67 6574 5f73  _booster().get_s
-00059750: 636f 7265 280d 0a20 2020 2020 2020 2020  core(..         
+00059640: 2020 2065 7661 6c5f 6d65 7472 6963 3d65     eval_metric=e
+00059650: 7661 6c5f 6d65 7472 6963 2c76 6572 626f  val_metric,verbo
+00059660: 7365 3d46 616c 7365 290d 0a20 2020 2020  se=False)..     
+00059670: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00059680: 7269 6e74 2827 5847 4220 6861 7320 6120  rint('XGB has a 
+00059690: 6275 6720 696e 2076 6572 7369 6f6e 2078  bug in version x
+000596a0: 6762 6f6f 7374 2031 2e30 3220 666f 7220  gboost 1.02 for 
+000596b0: 6665 6174 7572 6520 696d 706f 7274 616e  feature importan
+000596c0: 6365 732e 2054 7279 2074 6f20 696e 7374  ces. Try to inst
+000596d0: 616c 6c20 7665 7273 696f 6e20 302e 3930  all version 0.90
+000596e0: 206f 7220 312e 3130 202d 2063 6f6e 7469   or 1.10 - conti
+000596f0: 6e75 696e 672e 2e2e 2729 0d0a 2020 2020  nuing...')..    
+00059700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059710: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
+00059720: 6573 202b 3d20 7064 2e53 6572 6965 7328  es += pd.Series(
+00059730: 6e65 775f 7867 622e 6765 745f 626f 6f73  new_xgb.get_boos
+00059740: 7465 7228 292e 6765 745f 7363 6f72 6528  ter().get_score(
+00059750: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
 00059760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059770: 2020 2020 2020 2069 6d70 6f72 7461 6e63         importanc
-00059780: 655f 7479 7065 3d27 6761 696e 2729 292e  e_type='gain')).
-00059790: 736f 7274 5f76 616c 7565 7328 6173 6365  sort_values(asce
-000597a0: 6e64 696e 673d 4661 6c73 6529 5b3a 746f  nding=False)[:to
-000597b0: 705f 6e75 6d5d 2e69 6e64 6578 2e74 6f6c  p_num].index.tol
-000597c0: 6973 7428 290d 0a20 2020 2020 2020 2020  ist()..         
-000597d0: 2020 2020 2020 2069 6d70 6f72 7461 6e74         important
-000597e0: 5f66 6561 7475 7265 7320 3d20 6c69 7374  _features = list
-000597f0: 284f 7264 6572 6564 4469 6374 2e66 726f  (OrderedDict.fro
-00059800: 6d6b 6579 7328 696d 706f 7274 616e 745f  mkeys(important_
-00059810: 6665 6174 7572 6573 2929 0d0a 2020 2020  features))..    
-00059820: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00059830: 2020 2020 2020 2020 2020 2020 2020 2058                 X
-00059840: 203d 2074 7261 696e 5f70 5b6c 6973 7428   = train_p[list(
-00059850: 7472 6169 6e5f 702e 636f 6c75 6d6e 732e  train_p.columns.
-00059860: 7661 6c75 6573 295b 693a 7472 6169 6e5f  values)[i:train_
-00059870: 702e 7368 6170 655b 315d 5d5d 0d0a 2020  p.shape[1]]]..  
-00059880: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-00059890: 2323 2053 706c 6974 2068 6572 6520 696e  ## Split here in
-000598a0: 746f 2074 7261 696e 2061 6e64 2074 6573  to train and tes
-000598b0: 7420 2323 2323 230d 0a20 2020 2020 2020  t #####..       
-000598c0: 2020 2020 2020 2020 2069 6620 6d6f 6465           if mode
-000598d0: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
-000598e0: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
-000598f0: 2020 2020 2020 2020 2020 2020 7472 6169              trai
-00059900: 6e5f 7061 7274 203d 2069 6e74 2828 312d  n_part = int((1-
-00059910: 7465 7374 5f73 697a 6529 2a58 2e73 6861  test_size)*X.sha
-00059920: 7065 5b30 5d29 0d0a 2020 2020 2020 2020  pe[0])..        
-00059930: 2020 2020 2020 2020 2020 2020 585f 7472              X_tr
-00059940: 6169 6e2c 2058 5f63 762c 2079 5f74 7261  ain, X_cv, y_tra
-00059950: 696e 2c20 795f 6376 203d 2058 5b3a 7472  in, y_cv = X[:tr
-00059960: 6169 6e5f 7061 7274 5d2c 585b 7472 6169  ain_part],X[trai
-00059970: 6e5f 7061 7274 3a5d 2c79 5b3a 7472 6169  n_part:],y[:trai
-00059980: 6e5f 7061 7274 5d2c 795b 7472 6169 6e5f  n_part],y[train_
-00059990: 7061 7274 3a5d 0d0a 2020 2020 2020 2020  part:]..        
-000599a0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-000599b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000599c0: 2020 2058 5f74 7261 696e 2c20 585f 6376     X_train, X_cv
-000599d0: 2c20 795f 7472 6169 6e2c 2079 5f63 7620  , y_train, y_cv 
-000599e0: 3d20 7472 6169 6e5f 7465 7374 5f73 706c  = train_test_spl
-000599f0: 6974 2858 2c20 792c 0d0a 2020 2020 2020  it(X, y,..      
+00059770: 2020 696d 706f 7274 616e 6365 5f74 7970    importance_typ
+00059780: 653d 2767 6169 6e27 2929 2e73 6f72 745f  e='gain')).sort_
+00059790: 7661 6c75 6573 2861 7363 656e 6469 6e67  values(ascending
+000597a0: 3d46 616c 7365 295b 3a74 6f70 5f6e 756d  =False)[:top_num
+000597b0: 5d2e 696e 6465 782e 746f 6c69 7374 2829  ].index.tolist()
+000597c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000597d0: 2020 696d 706f 7274 616e 745f 6665 6174    important_feat
+000597e0: 7572 6573 203d 206c 6973 7428 4f72 6465  ures = list(Orde
+000597f0: 7265 6444 6963 742e 6672 6f6d 6b65 7973  redDict.fromkeys
+00059800: 2869 6d70 6f72 7461 6e74 5f66 6561 7475  (important_featu
+00059810: 7265 7329 290d 0a20 2020 2020 2020 2020  res))..         
+00059820: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00059830: 2020 2020 2020 2020 2020 5820 3d20 7472            X = tr
+00059840: 6169 6e5f 705b 6c69 7374 2874 7261 696e  ain_p[list(train
+00059850: 5f70 2e63 6f6c 756d 6e73 2e76 616c 7565  _p.columns.value
+00059860: 7329 5b69 3a74 7261 696e 5f70 2e73 6861  s)[i:train_p.sha
+00059870: 7065 5b31 5d5d 5d0d 0a20 2020 2020 2020  pe[1]]]..       
+00059880: 2020 2020 2020 2020 2023 2323 2320 5370           #### Sp
+00059890: 6c69 7420 6865 7265 2069 6e74 6f20 7472  lit here into tr
+000598a0: 6169 6e20 616e 6420 7465 7374 2023 2323  ain and test ###
+000598b0: 2323 0d0a 2020 2020 2020 2020 2020 2020  ##..            
+000598c0: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
+000598d0: 203d 3d20 2752 6567 7265 7373 696f 6e27   == 'Regression'
+000598e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000598f0: 2020 2020 2020 2074 7261 696e 5f70 6172         train_par
+00059900: 7420 3d20 696e 7428 2831 2d74 6573 745f  t = int((1-test_
+00059910: 7369 7a65 292a 582e 7368 6170 655b 305d  size)*X.shape[0]
+00059920: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00059930: 2020 2020 2020 2058 5f74 7261 696e 2c20         X_train, 
+00059940: 585f 6376 2c20 795f 7472 6169 6e2c 2079  X_cv, y_train, y
+00059950: 5f63 7620 3d20 585b 3a74 7261 696e 5f70  _cv = X[:train_p
+00059960: 6172 745d 2c58 5b74 7261 696e 5f70 6172  art],X[train_par
+00059970: 743a 5d2c 795b 3a74 7261 696e 5f70 6172  t:],y[:train_par
+00059980: 745d 2c79 5b74 7261 696e 5f70 6172 743a  t],y[train_part:
+00059990: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
+000599a0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000599b0: 2020 2020 2020 2020 2020 2020 2020 585f                X_
+000599c0: 7472 6169 6e2c 2058 5f63 762c 2079 5f74  train, X_cv, y_t
+000599d0: 7261 696e 2c20 795f 6376 203d 2074 7261  rain, y_cv = tra
+000599e0: 696e 5f74 6573 745f 7370 6c69 7428 582c  in_test_split(X,
+000599f0: 2079 2c0d 0a20 2020 2020 2020 2020 2020   y,..           
 00059a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00059a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059a20: 2020 2020 2020 2020 2020 2020 2020 7465                te
-00059a30: 7374 5f73 697a 653d 7465 7374 5f73 697a  st_size=test_siz
-00059a40: 652c 2072 616e 646f 6d5f 7374 6174 653d  e, random_state=
-00059a50: 7365 6564 2c73 7472 6174 6966 793d 7929  seed,stratify=y)
-00059a60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00059a70: 2020 6576 616c 5f73 6574 203d 205b 2858    eval_set = [(X
-00059a80: 5f74 7261 696e 2c79 5f74 7261 696e 292c  _train,y_train),
-00059a90: 2858 5f63 762c 795f 6376 295d 0d0a 2020  (X_cv,y_cv)]..  
-00059aa0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-00059ab0: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
-00059ac0: 2020 2020 2020 2020 6d6f 6465 6c5f 7867          model_xg
-00059ad0: 622e 6669 7428 585f 7472 6169 6e2c 795f  b.fit(X_train,y_
-00059ae0: 7472 6169 6e2c 6561 726c 795f 7374 6f70  train,early_stop
-00059af0: 7069 6e67 5f72 6f75 6e64 733d 6561 726c  ping_rounds=earl
-00059b00: 795f 7374 6f70 7069 6e67 2c0d 0a20 2020  y_stopping,..   
+00059a20: 2020 2020 2020 2020 2074 6573 745f 7369           test_si
+00059a30: 7a65 3d74 6573 745f 7369 7a65 2c20 7261  ze=test_size, ra
+00059a40: 6e64 6f6d 5f73 7461 7465 3d73 6565 642c  ndom_state=seed,
+00059a50: 7374 7261 7469 6679 3d79 290d 0a20 2020  stratify=y)..   
+00059a60: 2020 2020 2020 2020 2020 2020 2065 7661               eva
+00059a70: 6c5f 7365 7420 3d20 5b28 585f 7472 6169  l_set = [(X_trai
+00059a80: 6e2c 795f 7472 6169 6e29 2c28 585f 6376  n,y_train),(X_cv
+00059a90: 2c79 5f63 7629 5d0d 0a20 2020 2020 2020  ,y_cv)]..       
+00059aa0: 2020 2020 2020 2020 2074 7279 3a0d 0a20           try:.. 
+00059ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059ac0: 2020 206d 6f64 656c 5f78 6762 2e66 6974     model_xgb.fit
+00059ad0: 2858 5f74 7261 696e 2c79 5f74 7261 696e  (X_train,y_train
+00059ae0: 2c65 6172 6c79 5f73 746f 7070 696e 675f  ,early_stopping_
+00059af0: 726f 756e 6473 3d65 6172 6c79 5f73 746f  rounds=early_sto
+00059b00: 7070 696e 672c 0d0a 2020 2020 2020 2020  pping,..        
 00059b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059b20: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00059b30: 7661 6c5f 7365 743d 6576 616c 5f73 6574  val_set=eval_set
-00059b40: 2c65 7661 6c5f 6d65 7472 6963 3d65 7661  ,eval_metric=eva
-00059b50: 6c5f 6d65 7472 6963 2c76 6572 626f 7365  l_metric,verbose
-00059b60: 3d46 616c 7365 290d 0a20 2020 2020 2020  =False)..       
-00059b70: 2020 2020 2020 2020 2020 2020 2069 6d70               imp
-00059b80: 6f72 7461 6e74 5f66 6561 7475 7265 7320  ortant_features 
-00059b90: 2b3d 2070 642e 5365 7269 6573 286d 6f64  += pd.Series(mod
-00059ba0: 656c 5f78 6762 2e67 6574 5f62 6f6f 7374  el_xgb.get_boost
-00059bb0: 6572 2829 2e67 6574 5f73 636f 7265 280d  er().get_score(.
-00059bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00059bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059be0: 2069 6d70 6f72 7461 6e63 655f 7479 7065   importance_type
-00059bf0: 3d27 6761 696e 2729 292e 736f 7274 5f76  ='gain')).sort_v
-00059c00: 616c 7565 7328 6173 6365 6e64 696e 673d  alues(ascending=
-00059c10: 4661 6c73 6529 5b3a 746f 705f 6e75 6d5d  False)[:top_num]
-00059c20: 2e69 6e64 6578 2e74 6f6c 6973 7428 290d  .index.tolist().
-00059c30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00059c40: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
-00059c50: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
-00059c60: 775f 7867 622e 6669 7428 585f 7472 6169  w_xgb.fit(X_trai
-00059c70: 6e2c 795f 7472 6169 6e2c 6561 726c 795f  n,y_train,early_
-00059c80: 7374 6f70 7069 6e67 5f72 6f75 6e64 733d  stopping_rounds=
-00059c90: 6561 726c 795f 7374 6f70 7069 6e67 2c0d  early_stopping,.
-00059ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00059cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059cc0: 2020 2065 7661 6c5f 7365 743d 6576 616c     eval_set=eval
-00059cd0: 5f73 6574 2c65 7661 6c5f 6d65 7472 6963  _set,eval_metric
-00059ce0: 3d65 7661 6c5f 6d65 7472 6963 2c76 6572  =eval_metric,ver
-00059cf0: 626f 7365 3d46 616c 7365 290d 0a20 2020  bose=False)..   
-00059d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059d10: 2069 6d70 6f72 7461 6e74 5f66 6561 7475   important_featu
-00059d20: 7265 7320 2b3d 2070 642e 5365 7269 6573  res += pd.Series
-00059d30: 286d 6f64 656c 5f78 6762 2e67 6574 5f62  (model_xgb.get_b
-00059d40: 6f6f 7374 6572 2829 2e67 6574 5f73 636f  ooster().get_sco
-00059d50: 7265 280d 0a20 2020 2020 2020 2020 2020  re(..           
+00059b20: 2020 2020 2020 2020 2020 6576 616c 5f73            eval_s
+00059b30: 6574 3d65 7661 6c5f 7365 742c 6576 616c  et=eval_set,eval
+00059b40: 5f6d 6574 7269 633d 6576 616c 5f6d 6574  _metric=eval_met
+00059b50: 7269 632c 7665 7262 6f73 653d 4661 6c73  ric,verbose=Fals
+00059b60: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+00059b70: 2020 2020 2020 2020 696d 706f 7274 616e          importan
+00059b80: 745f 6665 6174 7572 6573 202b 3d20 7064  t_features += pd
+00059b90: 2e53 6572 6965 7328 6d6f 6465 6c5f 7867  .Series(model_xg
+00059ba0: 622e 6765 745f 626f 6f73 7465 7228 292e  b.get_booster().
+00059bb0: 6765 745f 7363 6f72 6528 0d0a 2020 2020  get_score(..    
+00059bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059bd0: 2020 2020 2020 2020 2020 2020 696d 706f              impo
+00059be0: 7274 616e 6365 5f74 7970 653d 2767 6169  rtance_type='gai
+00059bf0: 6e27 2929 2e73 6f72 745f 7661 6c75 6573  n')).sort_values
+00059c00: 2861 7363 656e 6469 6e67 3d46 616c 7365  (ascending=False
+00059c10: 295b 3a74 6f70 5f6e 756d 5d2e 696e 6465  )[:top_num].inde
+00059c20: 782e 746f 6c69 7374 2829 0d0a 2020 2020  x.tolist()..    
+00059c30: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+00059c40: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
+00059c50: 2020 2020 2020 2020 206e 6577 5f78 6762           new_xgb
+00059c60: 2e66 6974 2858 5f74 7261 696e 2c79 5f74  .fit(X_train,y_t
+00059c70: 7261 696e 2c65 6172 6c79 5f73 746f 7070  rain,early_stopp
+00059c80: 696e 675f 726f 756e 6473 3d65 6172 6c79  ing_rounds=early
+00059c90: 5f73 746f 7070 696e 672c 0d0a 2020 2020  _stopping,..    
+00059ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059cb0: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+00059cc0: 616c 5f73 6574 3d65 7661 6c5f 7365 742c  al_set=eval_set,
+00059cd0: 6576 616c 5f6d 6574 7269 633d 6576 616c  eval_metric=eval
+00059ce0: 5f6d 6574 7269 632c 7665 7262 6f73 653d  _metric,verbose=
+00059cf0: 4661 6c73 6529 0d0a 2020 2020 2020 2020  False)..        
+00059d00: 2020 2020 2020 2020 2020 2020 696d 706f              impo
+00059d10: 7274 616e 745f 6665 6174 7572 6573 202b  rtant_features +
+00059d20: 3d20 7064 2e53 6572 6965 7328 6d6f 6465  = pd.Series(mode
+00059d30: 6c5f 7867 622e 6765 745f 626f 6f73 7465  l_xgb.get_booste
+00059d40: 7228 292e 6765 745f 7363 6f72 6528 0d0a  r().get_score(..
+00059d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00059d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00059d70: 2020 2020 2069 6d70 6f72 7461 6e63 655f       importance_
-00059d80: 7479 7065 3d27 6761 696e 2729 292e 736f  type='gain')).so
-00059d90: 7274 5f76 616c 7565 7328 6173 6365 6e64  rt_values(ascend
-00059da0: 696e 673d 4661 6c73 6529 5b3a 746f 705f  ing=False)[:top_
-00059db0: 6e75 6d5d 2e69 6e64 6578 2e74 6f6c 6973  num].index.tolis
-00059dc0: 7428 290d 0a20 2020 2020 2020 2020 2020  t()..           
-00059dd0: 2020 2020 2069 6d70 6f72 7461 6e74 5f66       important_f
-00059de0: 6561 7475 7265 7320 3d20 6c69 7374 284f  eatures = list(O
-00059df0: 7264 6572 6564 4469 6374 2e66 726f 6d6b  rderedDict.fromk
-00059e00: 6579 7328 696d 706f 7274 616e 745f 6665  eys(important_fe
-00059e10: 6174 7572 6573 2929 0d0a 2020 2020 6578  atures))..    ex
-00059e20: 6365 7074 3a0d 0a20 2020 2020 2020 2070  cept:..        p
-00059e30: 7269 6e74 2827 4669 6e64 696e 6720 746f  rint('Finding to
-00059e40: 7020 6665 6174 7572 6573 2075 7369 6e67  p features using
-00059e50: 2058 4742 2069 7320 6372 6173 6869 6e67   XGB is crashing
-00059e60: 2e20 436f 6e74 696e 7569 6e67 2077 6974  . Continuing wit
-00059e70: 6820 616c 6c20 7072 6564 6963 746f 7273  h all predictors
-00059e80: 2e2e 2e27 290d 0a20 2020 2020 2020 2069  ...')..        i
-00059e90: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
-00059ea0: 7320 3d20 636f 7079 2e64 6565 7063 6f70  s = copy.deepcop
-00059eb0: 7928 7072 6564 7329 0d0a 2020 2020 2020  y(preds)..      
-00059ec0: 2020 7265 7475 726e 2069 6d70 6f72 7461    return importa
-00059ed0: 6e74 5f66 6561 7475 7265 732c 205b 5d2c  nt_features, [],
-00059ee0: 205b 5d0d 0a20 2020 2069 6d70 6f72 7461   []..    importa
-00059ef0: 6e74 5f66 6561 7475 7265 7320 3d20 6c69  nt_features = li
-00059f00: 7374 284f 7264 6572 6564 4469 6374 2e66  st(OrderedDict.f
-00059f10: 726f 6d6b 6579 7328 696d 706f 7274 616e  romkeys(importan
-00059f20: 745f 6665 6174 7572 6573 2929 0d0a 2020  t_features))..  
-00059f30: 2020 7072 696e 7428 2746 6f75 6e64 2025    print('Found %
-00059f40: 6420 696d 706f 7274 616e 7420 6665 6174  d important feat
-00059f50: 7572 6573 2720 256c 656e 2869 6d70 6f72  ures' %len(impor
-00059f60: 7461 6e74 5f66 6561 7475 7265 7329 290d  tant_features)).
-00059f70: 0a20 2020 2023 7072 696e 7428 2720 2020  .    #print('   
-00059f80: 2054 696d 6520 7461 6b65 6e20 2869 6e20   Time taken (in 
-00059f90: 7365 636f 6e64 7329 203d 2025 302e 3066  seconds) = %0.0f
-00059fa0: 2720 2528 7469 6d65 2e74 696d 6528 292d  ' %(time.time()-
-00059fb0: 7374 6172 745f 7469 6d65 2929 0d0a 2020  start_time))..  
-00059fc0: 2020 6e75 6d76 6172 7320 3d20 5b78 2066    numvars = [x f
-00059fd0: 6f72 2078 2069 6e20 6e75 6d76 6172 7320  or x in numvars 
-00059fe0: 6966 2078 2069 6e20 696d 706f 7274 616e  if x in importan
-00059ff0: 745f 6665 6174 7572 6573 5d0d 0a20 2020  t_features]..   
-0005a000: 2069 6d70 6f72 7461 6e74 5f63 6174 7320   important_cats 
-0005a010: 3d20 5b78 2066 6f72 2078 2069 6e20 696d  = [x for x in im
-0005a020: 706f 7274 616e 745f 6361 7473 2069 6620  portant_cats if 
-0005a030: 7820 696e 2069 6d70 6f72 7461 6e74 5f66  x in important_f
-0005a040: 6561 7475 7265 735d 0d0a 2020 2020 7265  eatures]..    re
-0005a050: 7475 726e 2069 6d70 6f72 7461 6e74 5f66  turn important_f
-0005a060: 6561 7475 7265 732c 206e 756d 7661 7273  eatures, numvars
-0005a070: 2c20 696d 706f 7274 616e 745f 6361 7473  , important_cats
-0005a080: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+00059d70: 696d 706f 7274 616e 6365 5f74 7970 653d  importance_type=
+00059d80: 2767 6169 6e27 2929 2e73 6f72 745f 7661  'gain')).sort_va
+00059d90: 6c75 6573 2861 7363 656e 6469 6e67 3d46  lues(ascending=F
+00059da0: 616c 7365 295b 3a74 6f70 5f6e 756d 5d2e  alse)[:top_num].
+00059db0: 696e 6465 782e 746f 6c69 7374 2829 0d0a  index.tolist()..
+00059dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00059dd0: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
+00059de0: 6573 203d 206c 6973 7428 4f72 6465 7265  es = list(Ordere
+00059df0: 6444 6963 742e 6672 6f6d 6b65 7973 2869  dDict.fromkeys(i
+00059e00: 6d70 6f72 7461 6e74 5f66 6561 7475 7265  mportant_feature
+00059e10: 7329 290d 0a20 2020 2065 7863 6570 743a  s))..    except:
+00059e20: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+00059e30: 2746 696e 6469 6e67 2074 6f70 2066 6561  'Finding top fea
+00059e40: 7475 7265 7320 7573 696e 6720 5847 4220  tures using XGB 
+00059e50: 6973 2063 7261 7368 696e 672e 2043 6f6e  is crashing. Con
+00059e60: 7469 6e75 696e 6720 7769 7468 2061 6c6c  tinuing with all
+00059e70: 2070 7265 6469 6374 6f72 732e 2e2e 2729   predictors...')
+00059e80: 0d0a 2020 2020 2020 2020 696d 706f 7274  ..        import
+00059e90: 616e 745f 6665 6174 7572 6573 203d 2063  ant_features = c
+00059ea0: 6f70 792e 6465 6570 636f 7079 2870 7265  opy.deepcopy(pre
+00059eb0: 6473 290d 0a20 2020 2020 2020 2072 6574  ds)..        ret
+00059ec0: 7572 6e20 696d 706f 7274 616e 745f 6665  urn important_fe
+00059ed0: 6174 7572 6573 2c20 5b5d 2c20 5b5d 0d0a  atures, [], []..
+00059ee0: 2020 2020 696d 706f 7274 616e 745f 6665      important_fe
+00059ef0: 6174 7572 6573 203d 206c 6973 7428 4f72  atures = list(Or
+00059f00: 6465 7265 6444 6963 742e 6672 6f6d 6b65  deredDict.fromke
+00059f10: 7973 2869 6d70 6f72 7461 6e74 5f66 6561  ys(important_fea
+00059f20: 7475 7265 7329 290d 0a20 2020 2070 7269  tures))..    pri
+00059f30: 6e74 2827 466f 756e 6420 2564 2069 6d70  nt('Found %d imp
+00059f40: 6f72 7461 6e74 2066 6561 7475 7265 7327  ortant features'
+00059f50: 2025 6c65 6e28 696d 706f 7274 616e 745f   %len(important_
+00059f60: 6665 6174 7572 6573 2929 0d0a 2020 2020  features))..    
+00059f70: 2370 7269 6e74 2827 2020 2020 5469 6d65  #print('    Time
+00059f80: 2074 616b 656e 2028 696e 2073 6563 6f6e   taken (in secon
+00059f90: 6473 2920 3d20 2530 2e30 6627 2025 2874  ds) = %0.0f' %(t
+00059fa0: 696d 652e 7469 6d65 2829 2d73 7461 7274  ime.time()-start
+00059fb0: 5f74 696d 6529 290d 0a20 2020 206e 756d  _time))..    num
+00059fc0: 7661 7273 203d 205b 7820 666f 7220 7820  vars = [x for x 
+00059fd0: 696e 206e 756d 7661 7273 2069 6620 7820  in numvars if x 
+00059fe0: 696e 2069 6d70 6f72 7461 6e74 5f66 6561  in important_fea
+00059ff0: 7475 7265 735d 0d0a 2020 2020 696d 706f  tures]..    impo
+0005a000: 7274 616e 745f 6361 7473 203d 205b 7820  rtant_cats = [x 
+0005a010: 666f 7220 7820 696e 2069 6d70 6f72 7461  for x in importa
+0005a020: 6e74 5f63 6174 7320 6966 2078 2069 6e20  nt_cats if x in 
+0005a030: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
+0005a040: 6573 5d0d 0a20 2020 2072 6574 7572 6e20  es]..    return 
+0005a050: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
+0005a060: 6573 2c20 6e75 6d76 6172 732c 2069 6d70  es, numvars, imp
+0005a070: 6f72 7461 6e74 5f63 6174 730d 0a23 2323  ortant_cats..###
+0005a080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005a090: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005a0a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005a0b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005a0c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005a0d0: 2323 0d0a 6465 6620 6261 736b 6574 5f72  ##..def basket_r
-0005a0e0: 6563 616c 6c28 6c61 6265 6c2c 2070 7265  ecall(label, pre
-0005a0f0: 6429 3a0d 0a20 2020 2022 2222 0d0a 2020  d):..    """..  
-0005a100: 2020 5468 6973 2074 6573 7473 2074 6865    This tests the
-0005a110: 2072 6563 616c 6c20 6f66 2061 2067 6976   recall of a giv
-0005a120: 656e 2062 6173 6b65 7420 6f66 2069 7465  en basket of ite
-0005a130: 6d73 2069 6e20 6120 6c61 6265 6c20 6279  ms in a label by
-0005a140: 2074 6865 2073 6563 6f6e 6420 6261 736b   the second bask
-0005a150: 6574 2c20 7072 6564 2e0d 0a20 2020 2049  et, pred...    I
-0005a160: 7420 636f 6d70 6172 6573 2074 6865 2032  t compares the 2
-0005a170: 2062 6173 6b65 7473 2028 6172 7261 7973   baskets (arrays
-0005a180: 206f 7220 6c69 7374 7329 206e 616d 6564   or lists) named
-0005a190: 2061 7320 6c61 6265 6c20 616e 6420 7072   as label and pr
-0005a1a0: 6564 2c20 616e 6420 6669 6e64 7320 636f  ed, and finds co
-0005a1b0: 6d6d 6f6e 2069 7465 6d73 0d0a 2020 2020  mmon items..    
-0005a1c0: 6265 7477 6565 6e20 7468 6520 7477 6f2e  between the two.
-0005a1d0: 2054 6865 6e20 6974 2064 6976 6964 6573   Then it divides
-0005a1e0: 2074 6861 7420 6c65 6e67 7468 2062 7920   that length by 
-0005a1f0: 7468 6520 746f 7461 6c20 6e75 6d62 6572  the total number
-0005a200: 206f 6620 6974 656d 7320 696e 2074 6865   of items in the
-0005a210: 206c 6162 656c 2062 6173 6b65 740d 0a20   label basket.. 
-0005a220: 2020 2074 6f20 636f 6d65 2075 7020 7769     to come up wi
-0005a230: 7468 2061 2062 6173 6b65 7420 7265 6361  th a basket reca
-0005a240: 6c6c 2073 636f 7265 2e20 5468 6973 2073  ll score. This s
-0005a250: 636f 7265 206d 6179 2062 6520 7573 6566  core may be usef
-0005a260: 756c 2069 6e20 7265 636f 6d6d 656e 6461  ul in recommenda
-0005a270: 7469 6f6e 2070 726f 626c 656d 730d 0a20  tion problems.. 
-0005a280: 2020 2077 6865 7265 2079 6f75 2061 7265     where you are
-0005a290: 2069 6e74 6572 6573 7465 6420 696e 2066   interested in f
-0005a2a0: 696e 6469 6e67 2068 6f77 206d 616e 7920  inding how many 
-0005a2b0: 6974 656d 7320 696e 2061 2062 6173 6b65  items in a baske
-0005a2c0: 7420 286c 6162 656c 7329 2074 6861 7420  t (labels) that 
-0005a2d0: 796f 7572 0d0a 2020 2020 7072 6564 6963  your..    predic
-0005a2e0: 7469 6f6e 7320 2870 7265 6429 2062 6173  tions (pred) bas
-0005a2f0: 6b65 7420 676f 7420 636f 7272 6563 742e  ket got correct.
-0005a300: 2054 6865 206f 7264 6572 206f 6620 7468   The order of th
-0005a310: 6520 6974 656d 7320 696e 2074 6865 2062  e items in the b
-0005a320: 6173 6b65 7473 2064 6f65 7320 6e6f 7420  askets does not 
-0005a330: 6d61 7474 6572 2e0d 0a20 2020 2022 2222  matter...    """
-0005a340: 0d0a 2020 2020 6966 2069 7369 6e73 7461  ..    if isinsta
-0005a350: 6e63 6528 6c61 6265 6c2c 206c 6973 7429  nce(label, list)
-0005a360: 3a0d 0a20 2020 2020 2020 206c 6162 656c  :..        label
-0005a370: 203d 206e 702e 6172 7261 7928 6c61 6265   = np.array(labe
-0005a380: 6c29 0d0a 2020 2020 6966 2069 7369 6e73  l)..    if isins
-0005a390: 7461 6e63 6528 7072 6564 2c20 6c69 7374  tance(pred, list
-0005a3a0: 293a 0d0a 2020 2020 2020 2020 7072 6564  ):..        pred
-0005a3b0: 203d 206e 702e 6172 7261 7928 7072 6564   = np.array(pred
-0005a3c0: 290d 0a20 2020 2069 6620 6c65 6e28 6c61  )..    if len(la
-0005a3d0: 6265 6c29 203e 2031 3a0d 0a20 2020 2020  bel) > 1:..     
-0005a3e0: 2020 206a 6163 635f 6172 7220 3d20 5b5d     jacc_arr = []
-0005a3f0: 0d0a 2020 2020 2020 2020 666f 7220 726f  ..        for ro
-0005a400: 7731 2c72 6f77 322c 636f 756e 7420 696e  w1,row2,count in
-0005a410: 207a 6970 286c 6162 656c 2c70 7265 642c   zip(label,pred,
-0005a420: 2072 616e 6765 286c 656e 286c 6162 656c   range(len(label
-0005a430: 2929 293a 0d0a 2020 2020 2020 2020 2020  ))):..          
-0005a440: 2020 696e 7465 7273 6563 7469 6f6e 203d    intersection =
-0005a450: 206c 656e 286e 702e 696e 7465 7273 6563   len(np.intersec
-0005a460: 7431 6428 726f 7731 2c72 6f77 3229 290d  t1d(row1,row2)).
-0005a470: 0a20 2020 2020 2020 2020 2020 2075 6e69  .            uni
-0005a480: 6f6e 203d 206c 656e 2872 6f77 3129 0d0a  on = len(row1)..
-0005a490: 2020 2020 2020 2020 2020 2020 6a61 6363              jacc
-0005a4a0: 203d 2066 6c6f 6174 2869 6e74 6572 7365   = float(interse
-0005a4b0: 6374 696f 6e20 2f20 756e 696f 6e29 0d0a  ction / union)..
-0005a4c0: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-0005a4d0: 6f75 6e74 203d 3d20 303a 0d0a 2020 2020  ount == 0:..    
-0005a4e0: 2020 2020 2020 2020 2020 2020 6a61 6363              jacc
-0005a4f0: 5f61 7272 203d 2063 6f70 792e 6465 6570  _arr = copy.deep
-0005a500: 636f 7079 286a 6163 6329 0d0a 2020 2020  copy(jacc)..    
-0005a510: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0005a520: 2020 2020 2020 2020 2020 2020 2020 206a                 j
-0005a530: 6163 635f 6172 7220 3d20 6e70 2e72 5f5b  acc_arr = np.r_[
-0005a540: 6a61 6363 5f61 7272 2c6a 6163 635d 0d0a  jacc_arr,jacc]..
-0005a550: 2020 2020 2020 2020 7265 7475 726e 206a          return j
-0005a560: 6163 635f 6172 720d 0a20 2020 2065 6c73  acc_arr..    els
-0005a570: 653a 0d0a 2020 2020 2020 2020 696e 7465  e:..        inte
-0005a580: 7273 6563 7469 6f6e 203d 206c 656e 286c  rsection = len(l
-0005a590: 6973 7428 7365 7428 6c69 7374 3129 2e69  ist(set(list1).i
-0005a5a0: 6e74 6572 7365 6374 696f 6e28 7365 7428  ntersection(set(
-0005a5b0: 6c69 7374 3229 2929 290d 0a20 2020 2020  list2))))..     
-0005a5c0: 2020 2075 6e69 6f6e 203d 2028 6c65 6e28     union = (len(
-0005a5d0: 6c69 7374 3129 202b 206c 656e 286c 6973  list1) + len(lis
-0005a5e0: 7432 2929 202d 2069 6e74 6572 7365 6374  t2)) - intersect
-0005a5f0: 696f 6e0d 0a20 2020 2020 2020 206a 6163  ion..        jac
-0005a600: 635f 6172 7220 3d20 666c 6f61 7428 696e  c_arr = float(in
-0005a610: 7465 7273 6563 7469 6f6e 202f 2075 6e69  tersection / uni
-0005a620: 6f6e 290d 0a20 2020 2072 6574 7572 6e20  on)..    return 
-0005a630: 6a61 6363 5f61 7272 0d0a 2323 2323 2323  jacc_arr..######
+0005a0c0: 2323 2323 2323 2323 2323 2323 230d 0a64  #############..d
+0005a0d0: 6566 2062 6173 6b65 745f 7265 6361 6c6c  ef basket_recall
+0005a0e0: 286c 6162 656c 2c20 7072 6564 293a 0d0a  (label, pred):..
+0005a0f0: 2020 2020 2222 220d 0a20 2020 2054 6869      """..    Thi
+0005a100: 7320 7465 7374 7320 7468 6520 7265 6361  s tests the reca
+0005a110: 6c6c 206f 6620 6120 6769 7665 6e20 6261  ll of a given ba
+0005a120: 736b 6574 206f 6620 6974 656d 7320 696e  sket of items in
+0005a130: 2061 206c 6162 656c 2062 7920 7468 6520   a label by the 
+0005a140: 7365 636f 6e64 2062 6173 6b65 742c 2070  second basket, p
+0005a150: 7265 642e 0d0a 2020 2020 4974 2063 6f6d  red...    It com
+0005a160: 7061 7265 7320 7468 6520 3220 6261 736b  pares the 2 bask
+0005a170: 6574 7320 2861 7272 6179 7320 6f72 206c  ets (arrays or l
+0005a180: 6973 7473 2920 6e61 6d65 6420 6173 206c  ists) named as l
+0005a190: 6162 656c 2061 6e64 2070 7265 642c 2061  abel and pred, a
+0005a1a0: 6e64 2066 696e 6473 2063 6f6d 6d6f 6e20  nd finds common 
+0005a1b0: 6974 656d 730d 0a20 2020 2062 6574 7765  items..    betwe
+0005a1c0: 656e 2074 6865 2074 776f 2e20 5468 656e  en the two. Then
+0005a1d0: 2069 7420 6469 7669 6465 7320 7468 6174   it divides that
+0005a1e0: 206c 656e 6774 6820 6279 2074 6865 2074   length by the t
+0005a1f0: 6f74 616c 206e 756d 6265 7220 6f66 2069  otal number of i
+0005a200: 7465 6d73 2069 6e20 7468 6520 6c61 6265  tems in the labe
+0005a210: 6c20 6261 736b 6574 0d0a 2020 2020 746f  l basket..    to
+0005a220: 2063 6f6d 6520 7570 2077 6974 6820 6120   come up with a 
+0005a230: 6261 736b 6574 2072 6563 616c 6c20 7363  basket recall sc
+0005a240: 6f72 652e 2054 6869 7320 7363 6f72 6520  ore. This score 
+0005a250: 6d61 7920 6265 2075 7365 6675 6c20 696e  may be useful in
+0005a260: 2072 6563 6f6d 6d65 6e64 6174 696f 6e20   recommendation 
+0005a270: 7072 6f62 6c65 6d73 0d0a 2020 2020 7768  problems..    wh
+0005a280: 6572 6520 796f 7520 6172 6520 696e 7465  ere you are inte
+0005a290: 7265 7374 6564 2069 6e20 6669 6e64 696e  rested in findin
+0005a2a0: 6720 686f 7720 6d61 6e79 2069 7465 6d73  g how many items
+0005a2b0: 2069 6e20 6120 6261 736b 6574 2028 6c61   in a basket (la
+0005a2c0: 6265 6c73 2920 7468 6174 2079 6f75 720d  bels) that your.
+0005a2d0: 0a20 2020 2070 7265 6469 6374 696f 6e73  .    predictions
+0005a2e0: 2028 7072 6564 2920 6261 736b 6574 2067   (pred) basket g
+0005a2f0: 6f74 2063 6f72 7265 6374 2e20 5468 6520  ot correct. The 
+0005a300: 6f72 6465 7220 6f66 2074 6865 2069 7465  order of the ite
+0005a310: 6d73 2069 6e20 7468 6520 6261 736b 6574  ms in the basket
+0005a320: 7320 646f 6573 206e 6f74 206d 6174 7465  s does not matte
+0005a330: 722e 0d0a 2020 2020 2222 220d 0a20 2020  r...    """..   
+0005a340: 2069 6620 6973 696e 7374 616e 6365 286c   if isinstance(l
+0005a350: 6162 656c 2c20 6c69 7374 293a 0d0a 2020  abel, list):..  
+0005a360: 2020 2020 2020 6c61 6265 6c20 3d20 6e70        label = np
+0005a370: 2e61 7272 6179 286c 6162 656c 290d 0a20  .array(label).. 
+0005a380: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0005a390: 2870 7265 642c 206c 6973 7429 3a0d 0a20  (pred, list):.. 
+0005a3a0: 2020 2020 2020 2070 7265 6420 3d20 6e70         pred = np
+0005a3b0: 2e61 7272 6179 2870 7265 6429 0d0a 2020  .array(pred)..  
+0005a3c0: 2020 6966 206c 656e 286c 6162 656c 2920    if len(label) 
+0005a3d0: 3e20 313a 0d0a 2020 2020 2020 2020 6a61  > 1:..        ja
+0005a3e0: 6363 5f61 7272 203d 205b 5d0d 0a20 2020  cc_arr = []..   
+0005a3f0: 2020 2020 2066 6f72 2072 6f77 312c 726f       for row1,ro
+0005a400: 7732 2c63 6f75 6e74 2069 6e20 7a69 7028  w2,count in zip(
+0005a410: 6c61 6265 6c2c 7072 6564 2c20 7261 6e67  label,pred, rang
+0005a420: 6528 6c65 6e28 6c61 6265 6c29 2929 3a0d  e(len(label))):.
+0005a430: 0a20 2020 2020 2020 2020 2020 2069 6e74  .            int
+0005a440: 6572 7365 6374 696f 6e20 3d20 6c65 6e28  ersection = len(
+0005a450: 6e70 2e69 6e74 6572 7365 6374 3164 2872  np.intersect1d(r
+0005a460: 6f77 312c 726f 7732 2929 0d0a 2020 2020  ow1,row2))..    
+0005a470: 2020 2020 2020 2020 756e 696f 6e20 3d20          union = 
+0005a480: 6c65 6e28 726f 7731 290d 0a20 2020 2020  len(row1)..     
+0005a490: 2020 2020 2020 206a 6163 6320 3d20 666c         jacc = fl
+0005a4a0: 6f61 7428 696e 7465 7273 6563 7469 6f6e  oat(intersection
+0005a4b0: 202f 2075 6e69 6f6e 290d 0a20 2020 2020   / union)..     
+0005a4c0: 2020 2020 2020 2069 6620 636f 756e 7420         if count 
+0005a4d0: 3d3d 2030 3a0d 0a20 2020 2020 2020 2020  == 0:..         
+0005a4e0: 2020 2020 2020 206a 6163 635f 6172 7220         jacc_arr 
+0005a4f0: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+0005a500: 6a61 6363 290d 0a20 2020 2020 2020 2020  jacc)..         
+0005a510: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0005a520: 2020 2020 2020 2020 2020 6a61 6363 5f61            jacc_a
+0005a530: 7272 203d 206e 702e 725f 5b6a 6163 635f  rr = np.r_[jacc_
+0005a540: 6172 722c 6a61 6363 5d0d 0a20 2020 2020  arr,jacc]..     
+0005a550: 2020 2072 6574 7572 6e20 6a61 6363 5f61     return jacc_a
+0005a560: 7272 0d0a 2020 2020 656c 7365 3a0d 0a20  rr..    else:.. 
+0005a570: 2020 2020 2020 2069 6e74 6572 7365 6374         intersect
+0005a580: 696f 6e20 3d20 6c65 6e28 6c69 7374 2873  ion = len(list(s
+0005a590: 6574 286c 6973 7431 292e 696e 7465 7273  et(list1).inters
+0005a5a0: 6563 7469 6f6e 2873 6574 286c 6973 7432  ection(set(list2
+0005a5b0: 2929 2929 0d0a 2020 2020 2020 2020 756e  ))))..        un
+0005a5c0: 696f 6e20 3d20 286c 656e 286c 6973 7431  ion = (len(list1
+0005a5d0: 2920 2b20 6c65 6e28 6c69 7374 3229 2920  ) + len(list2)) 
+0005a5e0: 2d20 696e 7465 7273 6563 7469 6f6e 0d0a  - intersection..
+0005a5f0: 2020 2020 2020 2020 6a61 6363 5f61 7272          jacc_arr
+0005a600: 203d 2066 6c6f 6174 2869 6e74 6572 7365   = float(interse
+0005a610: 6374 696f 6e20 2f20 756e 696f 6e29 0d0a  ction / union)..
+0005a620: 2020 2020 7265 7475 726e 206a 6163 635f      return jacc_
+0005a630: 6172 720d 0a23 2323 2323 2323 2323 2323  arr..###########
 0005a640: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005a650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005a660: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005a670: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005a680: 2323 2323 2323 2323 2323 0d0a 6465 6620  ##########..def 
-0005a690: 6a61 6363 6172 645f 7369 6e67 6c65 6c61  jaccard_singlela
-0005a6a0: 6265 6c28 6c61 6265 6c2c 2070 7265 6429  bel(label, pred)
-0005a6b0: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
-0005a6c0: 5468 6973 2063 6f6d 7061 7265 7320 3220  This compares 2 
-0005a6d0: 6261 736b 6574 7320 2863 6f75 6c64 2062  baskets (could b
-0005a6e0: 6520 6c69 7374 7320 6f72 2061 7272 6179  e lists or array
-0005a6f0: 7329 3a20 6c61 6265 6c20 616e 6420 7072  s): label and pr
-0005a700: 6564 2c20 616e 6420 6669 6e64 7320 636f  ed, and finds co
-0005a710: 6d6d 6f6e 2069 7465 6d73 0d0a 2020 2020  mmon items..    
-0005a720: 6265 7477 6565 6e20 7468 6520 7477 6f2e  between the two.
-0005a730: 2054 6865 6e20 6974 2064 6976 6964 6573   Then it divides
-0005a740: 2074 6861 7420 6e75 6d62 6572 2062 7920   that number by 
-0005a750: 6569 7468 6572 2072 6f77 7320 6f72 2063  either rows or c
-0005a760: 6f6c 756d 6e73 2074 6f20 7265 7475 726e  olumns to return
-0005a770: 2025 2e0d 0a20 2020 2020 2020 2023 2323   %...        ###
-0005a780: 204a 6163 6361 7264 5f43 6f6c 756d 6e77   Jaccard_Columnw
-0005a790: 6973 6520 3d20 7468 6973 206d 6561 6e73  ise = this means
-0005a7a0: 2079 6f75 2068 6176 6520 6d75 6c74 692d   you have multi-
-0005a7b0: 6c61 6265 6c73 2061 6e64 2079 6f75 2077  labels and you w
-0005a7c0: 616e 7420 6974 2073 756d 6d65 6420 636f  ant it summed co
-0005a7d0: 6c75 6d6e 7769 7365 0d0a 2020 2020 2020  lumnwise..      
-0005a7e0: 2020 2323 2320 2020 5468 6973 2074 656c    ###   This tel
-0005a7f0: 6c73 2079 6f75 2077 6861 7420 6973 2074  ls you what is t
-0005a800: 6865 2061 7665 7261 6765 2061 6363 7572  he average accur
-0005a810: 6163 7920 666f 7220 6561 6368 2063 6f6c  acy for each col
-0005a820: 756d 6e20 696e 206d 756c 7469 2d6c 6162  umn in multi-lab
-0005a830: 656c 2074 6172 6765 740d 0a20 2020 2020  el target..     
-0005a840: 2020 2023 2323 2020 2049 7420 7769 6c6c     ###   It will
-0005a850: 2072 6574 7572 6e20 6173 206d 616e 7920   return as many 
-0005a860: 746f 7461 6c73 2061 7320 7468 6520 6e75  totals as the nu
-0005a870: 6d62 6572 206f 6620 636f 6c75 6d6e 7320  mber of columns 
-0005a880: 696e 2079 6f75 7220 6d75 6c74 692d 6c61  in your multi-la
-0005a890: 6265 6c20 7461 7267 6574 2e0d 0a20 2020  bel target...   
-0005a8a0: 2020 2020 2023 2323 2020 2054 6f20 6765       ###   To ge
-0005a8b0: 7420 6120 7065 7263 656e 7461 6765 2c20  t a percentage, 
-0005a8c0: 796f 7520 7769 6c6c 2068 6176 6520 746f  you will have to
-0005a8d0: 2064 6976 6964 6520 6974 2062 7920 7468   divide it by th
-0005a8e0: 6520 6e75 6d62 6572 206f 6620 726f 7773  e number of rows
-0005a8f0: 2069 6e20 7468 6520 6461 7461 2073 6574   in the data set
-0005a900: 2e0d 0a20 2020 2020 2020 2023 2323 2020  ...        ###  
-0005a910: 2054 6869 7320 7065 7263 656e 7461 6765   This percentage
-0005a920: 2067 6976 6573 2079 6f75 2074 6865 2025   gives you the %
-0005a930: 206f 6620 726f 7773 2069 6e20 6561 6368   of rows in each
-0005a940: 206c 6162 656c 2079 6f75 2067 6f74 2063   label you got c
-0005a950: 6f72 7265 6374 6c79 3d25 4561 6368 5f4c  orrectly=%Each_L
-0005a960: 6162 656c 2041 6363 7572 6163 790d 0a20  abel Accuracy.. 
-0005a970: 2020 2020 2020 2023 2323 2020 2054 6869         ###   Thi
-0005a980: 7320 7769 6c6c 2067 6976 6520 796f 7520  s will give you 
-0005a990: 6173 206d 616e 7920 7065 7263 656e 7461  as many percenta
-0005a9a0: 6765 7320 6173 2074 6865 7265 2061 7265  ges as there are
-0005a9b0: 206c 6162 656c 7320 696e 2079 6f75 7220   labels in your 
-0005a9c0: 6d75 6c74 692d 6c61 6265 6c20 7461 7267  multi-label targ
-0005a9d0: 6574 2e0d 0a20 2020 2020 2020 2023 2323  et...        ###
-0005a9e0: 204a 6163 6361 7264 5f52 6f77 2d77 6973   Jaccard_Row-wis
-0005a9f0: 6520 3d20 7468 6973 206d 6561 6e73 2079  e = this means y
-0005aa00: 6f75 2068 6176 6520 636f 6d62 6f73 2062  ou have combos b
-0005aa10: 7574 2077 6865 7265 206f 7264 6572 206d  ut where order m
-0005aa20: 6174 7465 7273 2061 6e64 2079 6f75 2077  atters and you w
-0005aa30: 616e 7420 6974 2063 6f6d 7061 7265 6420  ant it compared 
-0005aa40: 726f 772d 7769 7365 0d0a 2020 2020 2020  row-wise..      
-0005aa50: 2020 2323 2320 2020 5468 6973 2074 656c    ###   This tel
-0005aa60: 6c73 2079 6f75 2068 6f77 206d 616e 7920  ls you how many 
-0005aa70: 6c61 6265 6c73 2069 6e20 6561 6368 2072  labels in each r
-0005aa80: 6f77 2064 6964 2079 6f75 2067 6574 2072  ow did you get r
-0005aa90: 6967 6874 2e20 5448 6174 2773 2061 6363  ight. THat's acc
-0005aaa0: 7572 6163 7920 6279 2072 6f77 2e0d 0a20  uracy by row... 
-0005aab0: 2020 2020 2020 2023 2323 2020 2049 7420         ###   It 
-0005aac0: 7769 6c6c 2072 6574 7572 6e20 6173 206d  will return as m
-0005aad0: 616e 7920 746f 7461 6c73 2061 7320 7468  any totals as th
-0005aae0: 6520 6e75 6d62 6572 206f 6620 726f 7773  e number of rows
-0005aaf0: 2069 6e20 796f 7572 2064 6174 6120 7365   in your data se
-0005ab00: 742e 0d0a 2020 2020 2020 2020 2323 2320  t...        ### 
-0005ab10: 2020 546f 2067 6574 2061 2070 6572 6365    To get a perce
-0005ab20: 6e74 6167 652c 2079 6f75 2077 696c 6c20  ntage, you will 
-0005ab30: 6861 7665 2074 6f20 6469 7669 6465 2069  have to divide i
-0005ab40: 7420 6279 2074 6865 206e 756d 6265 7220  t by the number 
-0005ab50: 6f66 206c 6162 656c 7320 696e 2074 6865  of labels in the
-0005ab60: 2064 6174 6120 7365 742e 0d0a 2020 2020   data set...    
-0005ab70: 2020 2020 2323 2320 2020 5468 6973 2070      ###   This p
-0005ab80: 6572 6365 6e74 6167 6520 6769 7665 7320  ercentage gives 
-0005ab90: 796f 7520 7468 6520 2520 6f66 206c 6162  you the % of lab
-0005aba0: 656c 7320 696e 2065 6163 6820 726f 7720  els in each row 
-0005abb0: 796f 7520 676f 7420 636f 7272 6563 746c  you got correctl
-0005abc0: 793d 2543 6f6d 6269 6e65 645f 4c61 6265  y=%Combined_Labe
-0005abd0: 6c5f 4163 6375 7261 6379 0d0a 2020 2020  l_Accuracy..    
-0005abe0: 2020 2020 2323 2320 2020 5468 6973 2077      ###   This w
-0005abf0: 696c 6c20 6769 7665 2079 6f75 2061 2073  ill give you a s
-0005ac00: 696e 676c 6520 7065 7263 656e 7461 6765  ingle percentage
-0005ac10: 206e 756d 6265 7220 666f 7220 7468 6520   number for the 
-0005ac20: 7768 6f6c 6520 6461 7461 2073 6574 0d0a  whole data set..
-0005ac30: 2020 2020 2222 220d 0a20 2020 2069 6620      """..    if 
-0005ac40: 6973 696e 7374 616e 6365 286c 6162 656c  isinstance(label
-0005ac50: 2c20 6c69 7374 293a 0d0a 2020 2020 2020  , list):..      
-0005ac60: 2020 6c61 6265 6c20 3d20 6e70 2e61 7272    label = np.arr
-0005ac70: 6179 286c 6162 656c 290d 0a20 2020 2069  ay(label)..    i
-0005ac80: 6620 6973 696e 7374 616e 6365 2870 7265  f isinstance(pre
-0005ac90: 642c 206c 6973 7429 3a0d 0a20 2020 2020  d, list):..     
-0005aca0: 2020 2070 7265 6420 3d20 6e70 2e61 7272     pred = np.arr
-0005acb0: 6179 2870 7265 6429 0d0a 2020 2020 7472  ay(pred)..    tr
-0005acc0: 793a 0d0a 2020 2020 2020 2020 2323 2320  y:..        ### 
-0005acd0: 5468 6973 2069 7320 666f 7220 4d75 6c74  This is for Mult
-0005ace0: 692d 4c61 6265 6c20 5072 6f62 6c65 6d73  i-Label Problems
-0005acf0: 2023 2323 2323 2052 6574 7572 6e73 2032   ##### Returns 2
-0005ad00: 2072 6573 756c 7473 3a20 6f6e 6520 6e75   results: one nu
-0005ad10: 6d62 6572 2061 6e64 0d0a 2020 2020 2020  mber and..      
-0005ad20: 2020 2323 2320 2020 2074 6865 2073 6563    ###    the sec
-0005ad30: 6f6e 6420 6973 2061 6e20 6172 7261 7920  ond is an array 
-0005ad40: 7769 7468 2061 7320 6d61 6e79 2069 7465  with as many ite
-0005ad50: 6d73 2061 7320 6e75 6d62 6572 206f 6620  ms as number of 
-0005ad60: 6c61 6265 6c73 2069 6e20 7461 7267 6574  labels in target
-0005ad70: 0d0a 2020 2020 2020 2020 6a61 6363 5f65  ..        jacc_e
-0005ad80: 6163 685f 6c61 6265 6c20 3d20 6e70 2e73  ach_label = np.s
-0005ad90: 756d 286c 6162 656c 3d3d 7072 6564 2c61  um(label==pred,a
-0005ada0: 7869 733d 3029 2f6c 6162 656c 2e73 6861  xis=0)/label.sha
-0005adb0: 7065 5b30 5d0d 0a20 2020 2020 2020 2072  pe[0]..        r
-0005adc0: 6574 7572 6e20 206a 6163 635f 6561 6368  eturn  jacc_each
-0005add0: 5f6c 6162 656c 0d0a 2020 2020 6578 6365  _label..    exce
-0005ade0: 7074 3a0d 0a20 2020 2020 2020 2072 6574  pt:..        ret
-0005adf0: 7572 6e20 300d 0a23 2323 2323 2323 2323  urn 0..#########
+0005a680: 2323 2323 230d 0a64 6566 206a 6163 6361  #####..def jacca
+0005a690: 7264 5f73 696e 676c 656c 6162 656c 286c  rd_singlelabel(l
+0005a6a0: 6162 656c 2c20 7072 6564 293a 0d0a 2020  abel, pred):..  
+0005a6b0: 2020 2222 220d 0a20 2020 2054 6869 7320    """..    This 
+0005a6c0: 636f 6d70 6172 6573 2032 2062 6173 6b65  compares 2 baske
+0005a6d0: 7473 2028 636f 756c 6420 6265 206c 6973  ts (could be lis
+0005a6e0: 7473 206f 7220 6172 7261 7973 293a 206c  ts or arrays): l
+0005a6f0: 6162 656c 2061 6e64 2070 7265 642c 2061  abel and pred, a
+0005a700: 6e64 2066 696e 6473 2063 6f6d 6d6f 6e20  nd finds common 
+0005a710: 6974 656d 730d 0a20 2020 2062 6574 7765  items..    betwe
+0005a720: 656e 2074 6865 2074 776f 2e20 5468 656e  en the two. Then
+0005a730: 2069 7420 6469 7669 6465 7320 7468 6174   it divides that
+0005a740: 206e 756d 6265 7220 6279 2065 6974 6865   number by eithe
+0005a750: 7220 726f 7773 206f 7220 636f 6c75 6d6e  r rows or column
+0005a760: 7320 746f 2072 6574 7572 6e20 252e 0d0a  s to return %...
+0005a770: 2020 2020 2020 2020 2323 2320 4a61 6363          ### Jacc
+0005a780: 6172 645f 436f 6c75 6d6e 7769 7365 203d  ard_Columnwise =
+0005a790: 2074 6869 7320 6d65 616e 7320 796f 7520   this means you 
+0005a7a0: 6861 7665 206d 756c 7469 2d6c 6162 656c  have multi-label
+0005a7b0: 7320 616e 6420 796f 7520 7761 6e74 2069  s and you want i
+0005a7c0: 7420 7375 6d6d 6564 2063 6f6c 756d 6e77  t summed columnw
+0005a7d0: 6973 650d 0a20 2020 2020 2020 2023 2323  ise..        ###
+0005a7e0: 2020 2054 6869 7320 7465 6c6c 7320 796f     This tells yo
+0005a7f0: 7520 7768 6174 2069 7320 7468 6520 6176  u what is the av
+0005a800: 6572 6167 6520 6163 6375 7261 6379 2066  erage accuracy f
+0005a810: 6f72 2065 6163 6820 636f 6c75 6d6e 2069  or each column i
+0005a820: 6e20 6d75 6c74 692d 6c61 6265 6c20 7461  n multi-label ta
+0005a830: 7267 6574 0d0a 2020 2020 2020 2020 2323  rget..        ##
+0005a840: 2320 2020 4974 2077 696c 6c20 7265 7475  #   It will retu
+0005a850: 726e 2061 7320 6d61 6e79 2074 6f74 616c  rn as many total
+0005a860: 7320 6173 2074 6865 206e 756d 6265 7220  s as the number 
+0005a870: 6f66 2063 6f6c 756d 6e73 2069 6e20 796f  of columns in yo
+0005a880: 7572 206d 756c 7469 2d6c 6162 656c 2074  ur multi-label t
+0005a890: 6172 6765 742e 0d0a 2020 2020 2020 2020  arget...        
+0005a8a0: 2323 2320 2020 546f 2067 6574 2061 2070  ###   To get a p
+0005a8b0: 6572 6365 6e74 6167 652c 2079 6f75 2077  ercentage, you w
+0005a8c0: 696c 6c20 6861 7665 2074 6f20 6469 7669  ill have to divi
+0005a8d0: 6465 2069 7420 6279 2074 6865 206e 756d  de it by the num
+0005a8e0: 6265 7220 6f66 2072 6f77 7320 696e 2074  ber of rows in t
+0005a8f0: 6865 2064 6174 6120 7365 742e 0d0a 2020  he data set...  
+0005a900: 2020 2020 2020 2323 2320 2020 5468 6973        ###   This
+0005a910: 2070 6572 6365 6e74 6167 6520 6769 7665   percentage give
+0005a920: 7320 796f 7520 7468 6520 2520 6f66 2072  s you the % of r
+0005a930: 6f77 7320 696e 2065 6163 6820 6c61 6265  ows in each labe
+0005a940: 6c20 796f 7520 676f 7420 636f 7272 6563  l you got correc
+0005a950: 746c 793d 2545 6163 685f 4c61 6265 6c20  tly=%Each_Label 
+0005a960: 4163 6375 7261 6379 0d0a 2020 2020 2020  Accuracy..      
+0005a970: 2020 2323 2320 2020 5468 6973 2077 696c    ###   This wil
+0005a980: 6c20 6769 7665 2079 6f75 2061 7320 6d61  l give you as ma
+0005a990: 6e79 2070 6572 6365 6e74 6167 6573 2061  ny percentages a
+0005a9a0: 7320 7468 6572 6520 6172 6520 6c61 6265  s there are labe
+0005a9b0: 6c73 2069 6e20 796f 7572 206d 756c 7469  ls in your multi
+0005a9c0: 2d6c 6162 656c 2074 6172 6765 742e 0d0a  -label target...
+0005a9d0: 2020 2020 2020 2020 2323 2320 4a61 6363          ### Jacc
+0005a9e0: 6172 645f 526f 772d 7769 7365 203d 2074  ard_Row-wise = t
+0005a9f0: 6869 7320 6d65 616e 7320 796f 7520 6861  his means you ha
+0005aa00: 7665 2063 6f6d 626f 7320 6275 7420 7768  ve combos but wh
+0005aa10: 6572 6520 6f72 6465 7220 6d61 7474 6572  ere order matter
+0005aa20: 7320 616e 6420 796f 7520 7761 6e74 2069  s and you want i
+0005aa30: 7420 636f 6d70 6172 6564 2072 6f77 2d77  t compared row-w
+0005aa40: 6973 650d 0a20 2020 2020 2020 2023 2323  ise..        ###
+0005aa50: 2020 2054 6869 7320 7465 6c6c 7320 796f     This tells yo
+0005aa60: 7520 686f 7720 6d61 6e79 206c 6162 656c  u how many label
+0005aa70: 7320 696e 2065 6163 6820 726f 7720 6469  s in each row di
+0005aa80: 6420 796f 7520 6765 7420 7269 6768 742e  d you get right.
+0005aa90: 2054 4861 7427 7320 6163 6375 7261 6379   THat's accuracy
+0005aaa0: 2062 7920 726f 772e 0d0a 2020 2020 2020   by row...      
+0005aab0: 2020 2323 2320 2020 4974 2077 696c 6c20    ###   It will 
+0005aac0: 7265 7475 726e 2061 7320 6d61 6e79 2074  return as many t
+0005aad0: 6f74 616c 7320 6173 2074 6865 206e 756d  otals as the num
+0005aae0: 6265 7220 6f66 2072 6f77 7320 696e 2079  ber of rows in y
+0005aaf0: 6f75 7220 6461 7461 2073 6574 2e0d 0a20  our data set... 
+0005ab00: 2020 2020 2020 2023 2323 2020 2054 6f20         ###   To 
+0005ab10: 6765 7420 6120 7065 7263 656e 7461 6765  get a percentage
+0005ab20: 2c20 796f 7520 7769 6c6c 2068 6176 6520  , you will have 
+0005ab30: 746f 2064 6976 6964 6520 6974 2062 7920  to divide it by 
+0005ab40: 7468 6520 6e75 6d62 6572 206f 6620 6c61  the number of la
+0005ab50: 6265 6c73 2069 6e20 7468 6520 6461 7461  bels in the data
+0005ab60: 2073 6574 2e0d 0a20 2020 2020 2020 2023   set...        #
+0005ab70: 2323 2020 2054 6869 7320 7065 7263 656e  ##   This percen
+0005ab80: 7461 6765 2067 6976 6573 2079 6f75 2074  tage gives you t
+0005ab90: 6865 2025 206f 6620 6c61 6265 6c73 2069  he % of labels i
+0005aba0: 6e20 6561 6368 2072 6f77 2079 6f75 2067  n each row you g
+0005abb0: 6f74 2063 6f72 7265 6374 6c79 3d25 436f  ot correctly=%Co
+0005abc0: 6d62 696e 6564 5f4c 6162 656c 5f41 6363  mbined_Label_Acc
+0005abd0: 7572 6163 790d 0a20 2020 2020 2020 2023  uracy..        #
+0005abe0: 2323 2020 2054 6869 7320 7769 6c6c 2067  ##   This will g
+0005abf0: 6976 6520 796f 7520 6120 7369 6e67 6c65  ive you a single
+0005ac00: 2070 6572 6365 6e74 6167 6520 6e75 6d62   percentage numb
+0005ac10: 6572 2066 6f72 2074 6865 2077 686f 6c65  er for the whole
+0005ac20: 2064 6174 6120 7365 740d 0a20 2020 2022   data set..    "
+0005ac30: 2222 0d0a 2020 2020 6966 2069 7369 6e73  ""..    if isins
+0005ac40: 7461 6e63 6528 6c61 6265 6c2c 206c 6973  tance(label, lis
+0005ac50: 7429 3a0d 0a20 2020 2020 2020 206c 6162  t):..        lab
+0005ac60: 656c 203d 206e 702e 6172 7261 7928 6c61  el = np.array(la
+0005ac70: 6265 6c29 0d0a 2020 2020 6966 2069 7369  bel)..    if isi
+0005ac80: 6e73 7461 6e63 6528 7072 6564 2c20 6c69  nstance(pred, li
+0005ac90: 7374 293a 0d0a 2020 2020 2020 2020 7072  st):..        pr
+0005aca0: 6564 203d 206e 702e 6172 7261 7928 7072  ed = np.array(pr
+0005acb0: 6564 290d 0a20 2020 2074 7279 3a0d 0a20  ed)..    try:.. 
+0005acc0: 2020 2020 2020 2023 2323 2054 6869 7320         ### This 
+0005acd0: 6973 2066 6f72 204d 756c 7469 2d4c 6162  is for Multi-Lab
+0005ace0: 656c 2050 726f 626c 656d 7320 2323 2323  el Problems ####
+0005acf0: 2320 5265 7475 726e 7320 3220 7265 7375  # Returns 2 resu
+0005ad00: 6c74 733a 206f 6e65 206e 756d 6265 7220  lts: one number 
+0005ad10: 616e 640d 0a20 2020 2020 2020 2023 2323  and..        ###
+0005ad20: 2020 2020 7468 6520 7365 636f 6e64 2069      the second i
+0005ad30: 7320 616e 2061 7272 6179 2077 6974 6820  s an array with 
+0005ad40: 6173 206d 616e 7920 6974 656d 7320 6173  as many items as
+0005ad50: 206e 756d 6265 7220 6f66 206c 6162 656c   number of label
+0005ad60: 7320 696e 2074 6172 6765 740d 0a20 2020  s in target..   
+0005ad70: 2020 2020 206a 6163 635f 6561 6368 5f6c       jacc_each_l
+0005ad80: 6162 656c 203d 206e 702e 7375 6d28 6c61  abel = np.sum(la
+0005ad90: 6265 6c3d 3d70 7265 642c 6178 6973 3d30  bel==pred,axis=0
+0005ada0: 292f 6c61 6265 6c2e 7368 6170 655b 305d  )/label.shape[0]
+0005adb0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0005adc0: 2020 6a61 6363 5f65 6163 685f 6c61 6265    jacc_each_labe
+0005add0: 6c0d 0a20 2020 2065 7863 6570 743a 0d0a  l..    except:..
+0005ade0: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
+0005adf0: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
 0005ae00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005ae10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005ae20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005ae30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005ae40: 2323 2323 2323 230d 0a64 6566 206a 6163  #######..def jac
-0005ae50: 6361 7264 5f6d 756c 7469 6c61 6265 6c28  card_multilabel(
-0005ae60: 6c61 6265 6c2c 2070 7265 6429 3a0d 0a20  label, pred):.. 
-0005ae70: 2020 2022 2222 0d0a 2020 2020 5468 6973     """..    This
-0005ae80: 2063 6f6d 7061 7265 7320 3220 6261 736b   compares 2 bask
-0005ae90: 6574 7320 2863 6f75 6c64 2062 6520 6c69  ets (could be li
-0005aea0: 7374 7320 6f72 2061 7272 6179 7329 3a20  sts or arrays): 
-0005aeb0: 6c61 6265 6c20 616e 6420 7072 6564 2c20  label and pred, 
-0005aec0: 616e 6420 6669 6e64 7320 636f 6d6d 6f6e  and finds common
-0005aed0: 2069 7465 6d73 0d0a 2020 2020 6265 7477   items..    betw
-0005aee0: 6565 6e20 7468 6520 7477 6f2e 2054 6865  een the two. The
-0005aef0: 6e20 6974 2064 6976 6964 6573 2074 6861  n it divides tha
-0005af00: 7420 6e75 6d62 6572 2062 7920 6569 7468  t number by eith
-0005af10: 6572 2072 6f77 7320 6f72 2063 6f6c 756d  er rows or colum
-0005af20: 6e73 2074 6f20 7265 7475 726e 2025 2e0d  ns to return %..
-0005af30: 0a20 2020 2020 2020 2023 2323 204a 6163  .        ### Jac
-0005af40: 6361 7264 5f43 6f6c 756d 6e77 6973 6520  card_Columnwise 
-0005af50: 3d20 7468 6973 206d 6561 6e73 2079 6f75  = this means you
-0005af60: 2068 6176 6520 6d75 6c74 692d 6c61 6265   have multi-labe
-0005af70: 6c73 2061 6e64 2079 6f75 2077 616e 7420  ls and you want 
-0005af80: 6974 2073 756d 6d65 6420 636f 6c75 6d6e  it summed column
-0005af90: 7769 7365 0d0a 2020 2020 2020 2020 2323  wise..        ##
-0005afa0: 2320 2020 5468 6973 2074 656c 6c73 2079  #   This tells y
-0005afb0: 6f75 2077 6861 7420 6973 2074 6865 2061  ou what is the a
-0005afc0: 7665 7261 6765 2061 6363 7572 6163 7920  verage accuracy 
-0005afd0: 666f 7220 6561 6368 2063 6f6c 756d 6e20  for each column 
-0005afe0: 696e 206d 756c 7469 2d6c 6162 656c 2074  in multi-label t
-0005aff0: 6172 6765 740d 0a20 2020 2020 2020 2023  arget..        #
-0005b000: 2323 2020 2049 7420 7769 6c6c 2072 6574  ##   It will ret
-0005b010: 7572 6e20 6173 206d 616e 7920 746f 7461  urn as many tota
-0005b020: 6c73 2061 7320 7468 6520 6e75 6d62 6572  ls as the number
-0005b030: 206f 6620 636f 6c75 6d6e 7320 696e 2079   of columns in y
-0005b040: 6f75 7220 6d75 6c74 692d 6c61 6265 6c20  our multi-label 
-0005b050: 7461 7267 6574 2e0d 0a20 2020 2020 2020  target...       
-0005b060: 2023 2323 2020 2054 6f20 6765 7420 6120   ###   To get a 
-0005b070: 7065 7263 656e 7461 6765 2c20 796f 7520  percentage, you 
-0005b080: 7769 6c6c 2068 6176 6520 746f 2064 6976  will have to div
-0005b090: 6964 6520 6974 2062 7920 7468 6520 6e75  ide it by the nu
-0005b0a0: 6d62 6572 206f 6620 726f 7773 2069 6e20  mber of rows in 
-0005b0b0: 7468 6520 6461 7461 2073 6574 2e0d 0a20  the data set... 
-0005b0c0: 2020 2020 2020 2023 2323 2020 2054 6869         ###   Thi
-0005b0d0: 7320 7065 7263 656e 7461 6765 2067 6976  s percentage giv
-0005b0e0: 6573 2079 6f75 2074 6865 2025 206f 6620  es you the % of 
-0005b0f0: 726f 7773 2069 6e20 6561 6368 206c 6162  rows in each lab
-0005b100: 656c 2079 6f75 2067 6f74 2063 6f72 7265  el you got corre
-0005b110: 6374 6c79 3d25 4561 6368 5f4c 6162 656c  ctly=%Each_Label
-0005b120: 2041 6363 7572 6163 790d 0a20 2020 2020   Accuracy..     
-0005b130: 2020 2023 2323 2020 2054 6869 7320 7769     ###   This wi
-0005b140: 6c6c 2067 6976 6520 796f 7520 6173 206d  ll give you as m
-0005b150: 616e 7920 7065 7263 656e 7461 6765 7320  any percentages 
-0005b160: 6173 2074 6865 7265 2061 7265 206c 6162  as there are lab
-0005b170: 656c 7320 696e 2079 6f75 7220 6d75 6c74  els in your mult
-0005b180: 692d 6c61 6265 6c20 7461 7267 6574 2e0d  i-label target..
-0005b190: 0a20 2020 2020 2020 2023 2323 204a 6163  .        ### Jac
-0005b1a0: 6361 7264 5f52 6f77 2d77 6973 6520 3d20  card_Row-wise = 
-0005b1b0: 7468 6973 206d 6561 6e73 2079 6f75 2068  this means you h
-0005b1c0: 6176 6520 636f 6d62 6f73 2062 7574 2077  ave combos but w
-0005b1d0: 6865 7265 206f 7264 6572 206d 6174 7465  here order matte
-0005b1e0: 7273 2061 6e64 2079 6f75 2077 616e 7420  rs and you want 
-0005b1f0: 6974 2063 6f6d 7061 7265 6420 726f 772d  it compared row-
-0005b200: 7769 7365 0d0a 2020 2020 2020 2020 2323  wise..        ##
-0005b210: 2320 2020 5468 6973 2074 656c 6c73 2079  #   This tells y
-0005b220: 6f75 2068 6f77 206d 616e 7920 6c61 6265  ou how many labe
-0005b230: 6c73 2069 6e20 6561 6368 2072 6f77 2064  ls in each row d
-0005b240: 6964 2079 6f75 2067 6574 2072 6967 6874  id you get right
-0005b250: 2e20 5448 6174 2773 2061 6363 7572 6163  . THat's accurac
-0005b260: 7920 6279 2072 6f77 2e0d 0a20 2020 2020  y by row...     
-0005b270: 2020 2023 2323 2020 2049 7420 7769 6c6c     ###   It will
-0005b280: 2072 6574 7572 6e20 6173 206d 616e 7920   return as many 
-0005b290: 746f 7461 6c73 2061 7320 7468 6520 6e75  totals as the nu
-0005b2a0: 6d62 6572 206f 6620 726f 7773 2069 6e20  mber of rows in 
-0005b2b0: 796f 7572 2064 6174 6120 7365 742e 0d0a  your data set...
-0005b2c0: 2020 2020 2020 2020 2323 2320 2020 546f          ###   To
-0005b2d0: 2067 6574 2061 2070 6572 6365 6e74 6167   get a percentag
-0005b2e0: 652c 2079 6f75 2077 696c 6c20 6861 7665  e, you will have
-0005b2f0: 2074 6f20 6469 7669 6465 2069 7420 6279   to divide it by
-0005b300: 2074 6865 206e 756d 6265 7220 6f66 206c   the number of l
-0005b310: 6162 656c 7320 696e 2074 6865 2064 6174  abels in the dat
-0005b320: 6120 7365 742e 0d0a 2020 2020 2020 2020  a set...        
-0005b330: 2323 2320 2020 5468 6973 2070 6572 6365  ###   This perce
-0005b340: 6e74 6167 6520 6769 7665 7320 796f 7520  ntage gives you 
-0005b350: 7468 6520 2520 6f66 206c 6162 656c 7320  the % of labels 
-0005b360: 696e 2065 6163 6820 726f 7720 796f 7520  in each row you 
-0005b370: 676f 7420 636f 7272 6563 746c 793d 2543  got correctly=%C
-0005b380: 6f6d 6269 6e65 645f 4c61 6265 6c5f 4163  ombined_Label_Ac
-0005b390: 6375 7261 6379 0d0a 2020 2020 2020 2020  curacy..        
-0005b3a0: 2323 2320 2020 5468 6973 2077 696c 6c20  ###   This will 
-0005b3b0: 6769 7665 2079 6f75 2061 2073 696e 676c  give you a singl
-0005b3c0: 6520 7065 7263 656e 7461 6765 206e 756d  e percentage num
-0005b3d0: 6265 7220 666f 7220 7468 6520 7768 6f6c  ber for the whol
-0005b3e0: 6520 6461 7461 2073 6574 0d0a 2020 2020  e data set..    
-0005b3f0: 2222 220d 0a20 2020 2069 6620 6973 696e  """..    if isin
-0005b400: 7374 616e 6365 286c 6162 656c 2c20 6c69  stance(label, li
-0005b410: 7374 293a 0d0a 2020 2020 2020 2020 6c61  st):..        la
-0005b420: 6265 6c20 3d20 6e70 2e61 7272 6179 286c  bel = np.array(l
-0005b430: 6162 656c 290d 0a20 2020 2069 6620 6973  abel)..    if is
-0005b440: 696e 7374 616e 6365 2870 7265 642c 206c  instance(pred, l
-0005b450: 6973 7429 3a0d 0a20 2020 2020 2020 2070  ist):..        p
-0005b460: 7265 6420 3d20 6e70 2e61 7272 6179 2870  red = np.array(p
-0005b470: 7265 6429 0d0a 2020 2020 2323 2320 5468  red)..    ### Th
-0005b480: 6973 2069 7320 666f 7220 4d75 6c74 692d  is is for Multi-
-0005b490: 4c61 6265 6c20 5072 6f62 6c65 6d73 2023  Label Problems #
-0005b4a0: 2323 2323 2052 6574 7572 6e73 2032 2072  #### Returns 2 r
-0005b4b0: 6573 756c 7473 3a20 6f6e 6520 6e75 6d62  esults: one numb
-0005b4c0: 6572 2061 6e64 0d0a 2020 2020 2323 2320  er and..    ### 
-0005b4d0: 2020 2074 6865 2073 6563 6f6e 6420 6973     the second is
-0005b4e0: 2061 6e20 6172 7261 7920 7769 7468 2061   an array with a
-0005b4f0: 7320 6d61 6e79 2069 7465 6d73 2061 7320  s many items as 
-0005b500: 6e75 6d62 6572 206f 6620 6c61 6265 6c73  number of labels
-0005b510: 2069 6e20 7461 7267 6574 0d0a 2020 2020   in target..    
-0005b520: 7472 793a 0d0a 2020 2020 2020 2020 6a61  try:..        ja
-0005b530: 6363 5f64 6174 615f 7365 7420 3d20 6e70  cc_data_set = np
-0005b540: 2e73 756d 286c 6162 656c 3d3d 7072 6564  .sum(label==pred
-0005b550: 2c61 7869 733d 3129 2e73 756d 2829 2f6c  ,axis=1).sum()/l
-0005b560: 6162 656c 2e73 6861 7065 5b31 5d0d 0a20  abel.shape[1].. 
-0005b570: 2020 2020 2020 2072 6574 7572 6e20 6a61         return ja
-0005b580: 6363 5f64 6174 615f 7365 740d 0a20 2020  cc_data_set..   
-0005b590: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
-0005b5a0: 2020 7265 7475 726e 2030 0d0a 2323 2323    return 0..####
+0005ae40: 2323 0d0a 6465 6620 6a61 6363 6172 645f  ##..def jaccard_
+0005ae50: 6d75 6c74 696c 6162 656c 286c 6162 656c  multilabel(label
+0005ae60: 2c20 7072 6564 293a 0d0a 2020 2020 2222  , pred):..    ""
+0005ae70: 220d 0a20 2020 2054 6869 7320 636f 6d70  "..    This comp
+0005ae80: 6172 6573 2032 2062 6173 6b65 7473 2028  ares 2 baskets (
+0005ae90: 636f 756c 6420 6265 206c 6973 7473 206f  could be lists o
+0005aea0: 7220 6172 7261 7973 293a 206c 6162 656c  r arrays): label
+0005aeb0: 2061 6e64 2070 7265 642c 2061 6e64 2066   and pred, and f
+0005aec0: 696e 6473 2063 6f6d 6d6f 6e20 6974 656d  inds common item
+0005aed0: 730d 0a20 2020 2062 6574 7765 656e 2074  s..    between t
+0005aee0: 6865 2074 776f 2e20 5468 656e 2069 7420  he two. Then it 
+0005aef0: 6469 7669 6465 7320 7468 6174 206e 756d  divides that num
+0005af00: 6265 7220 6279 2065 6974 6865 7220 726f  ber by either ro
+0005af10: 7773 206f 7220 636f 6c75 6d6e 7320 746f  ws or columns to
+0005af20: 2072 6574 7572 6e20 252e 0d0a 2020 2020   return %...    
+0005af30: 2020 2020 2323 2320 4a61 6363 6172 645f      ### Jaccard_
+0005af40: 436f 6c75 6d6e 7769 7365 203d 2074 6869  Columnwise = thi
+0005af50: 7320 6d65 616e 7320 796f 7520 6861 7665  s means you have
+0005af60: 206d 756c 7469 2d6c 6162 656c 7320 616e   multi-labels an
+0005af70: 6420 796f 7520 7761 6e74 2069 7420 7375  d you want it su
+0005af80: 6d6d 6564 2063 6f6c 756d 6e77 6973 650d  mmed columnwise.
+0005af90: 0a20 2020 2020 2020 2023 2323 2020 2054  .        ###   T
+0005afa0: 6869 7320 7465 6c6c 7320 796f 7520 7768  his tells you wh
+0005afb0: 6174 2069 7320 7468 6520 6176 6572 6167  at is the averag
+0005afc0: 6520 6163 6375 7261 6379 2066 6f72 2065  e accuracy for e
+0005afd0: 6163 6820 636f 6c75 6d6e 2069 6e20 6d75  ach column in mu
+0005afe0: 6c74 692d 6c61 6265 6c20 7461 7267 6574  lti-label target
+0005aff0: 0d0a 2020 2020 2020 2020 2323 2320 2020  ..        ###   
+0005b000: 4974 2077 696c 6c20 7265 7475 726e 2061  It will return a
+0005b010: 7320 6d61 6e79 2074 6f74 616c 7320 6173  s many totals as
+0005b020: 2074 6865 206e 756d 6265 7220 6f66 2063   the number of c
+0005b030: 6f6c 756d 6e73 2069 6e20 796f 7572 206d  olumns in your m
+0005b040: 756c 7469 2d6c 6162 656c 2074 6172 6765  ulti-label targe
+0005b050: 742e 0d0a 2020 2020 2020 2020 2323 2320  t...        ### 
+0005b060: 2020 546f 2067 6574 2061 2070 6572 6365    To get a perce
+0005b070: 6e74 6167 652c 2079 6f75 2077 696c 6c20  ntage, you will 
+0005b080: 6861 7665 2074 6f20 6469 7669 6465 2069  have to divide i
+0005b090: 7420 6279 2074 6865 206e 756d 6265 7220  t by the number 
+0005b0a0: 6f66 2072 6f77 7320 696e 2074 6865 2064  of rows in the d
+0005b0b0: 6174 6120 7365 742e 0d0a 2020 2020 2020  ata set...      
+0005b0c0: 2020 2323 2320 2020 5468 6973 2070 6572    ###   This per
+0005b0d0: 6365 6e74 6167 6520 6769 7665 7320 796f  centage gives yo
+0005b0e0: 7520 7468 6520 2520 6f66 2072 6f77 7320  u the % of rows 
+0005b0f0: 696e 2065 6163 6820 6c61 6265 6c20 796f  in each label yo
+0005b100: 7520 676f 7420 636f 7272 6563 746c 793d  u got correctly=
+0005b110: 2545 6163 685f 4c61 6265 6c20 4163 6375  %Each_Label Accu
+0005b120: 7261 6379 0d0a 2020 2020 2020 2020 2323  racy..        ##
+0005b130: 2320 2020 5468 6973 2077 696c 6c20 6769  #   This will gi
+0005b140: 7665 2079 6f75 2061 7320 6d61 6e79 2070  ve you as many p
+0005b150: 6572 6365 6e74 6167 6573 2061 7320 7468  ercentages as th
+0005b160: 6572 6520 6172 6520 6c61 6265 6c73 2069  ere are labels i
+0005b170: 6e20 796f 7572 206d 756c 7469 2d6c 6162  n your multi-lab
+0005b180: 656c 2074 6172 6765 742e 0d0a 2020 2020  el target...    
+0005b190: 2020 2020 2323 2320 4a61 6363 6172 645f      ### Jaccard_
+0005b1a0: 526f 772d 7769 7365 203d 2074 6869 7320  Row-wise = this 
+0005b1b0: 6d65 616e 7320 796f 7520 6861 7665 2063  means you have c
+0005b1c0: 6f6d 626f 7320 6275 7420 7768 6572 6520  ombos but where 
+0005b1d0: 6f72 6465 7220 6d61 7474 6572 7320 616e  order matters an
+0005b1e0: 6420 796f 7520 7761 6e74 2069 7420 636f  d you want it co
+0005b1f0: 6d70 6172 6564 2072 6f77 2d77 6973 650d  mpared row-wise.
+0005b200: 0a20 2020 2020 2020 2023 2323 2020 2054  .        ###   T
+0005b210: 6869 7320 7465 6c6c 7320 796f 7520 686f  his tells you ho
+0005b220: 7720 6d61 6e79 206c 6162 656c 7320 696e  w many labels in
+0005b230: 2065 6163 6820 726f 7720 6469 6420 796f   each row did yo
+0005b240: 7520 6765 7420 7269 6768 742e 2054 4861  u get right. THa
+0005b250: 7427 7320 6163 6375 7261 6379 2062 7920  t's accuracy by 
+0005b260: 726f 772e 0d0a 2020 2020 2020 2020 2323  row...        ##
+0005b270: 2320 2020 4974 2077 696c 6c20 7265 7475  #   It will retu
+0005b280: 726e 2061 7320 6d61 6e79 2074 6f74 616c  rn as many total
+0005b290: 7320 6173 2074 6865 206e 756d 6265 7220  s as the number 
+0005b2a0: 6f66 2072 6f77 7320 696e 2079 6f75 7220  of rows in your 
+0005b2b0: 6461 7461 2073 6574 2e0d 0a20 2020 2020  data set...     
+0005b2c0: 2020 2023 2323 2020 2054 6f20 6765 7420     ###   To get 
+0005b2d0: 6120 7065 7263 656e 7461 6765 2c20 796f  a percentage, yo
+0005b2e0: 7520 7769 6c6c 2068 6176 6520 746f 2064  u will have to d
+0005b2f0: 6976 6964 6520 6974 2062 7920 7468 6520  ivide it by the 
+0005b300: 6e75 6d62 6572 206f 6620 6c61 6265 6c73  number of labels
+0005b310: 2069 6e20 7468 6520 6461 7461 2073 6574   in the data set
+0005b320: 2e0d 0a20 2020 2020 2020 2023 2323 2020  ...        ###  
+0005b330: 2054 6869 7320 7065 7263 656e 7461 6765   This percentage
+0005b340: 2067 6976 6573 2079 6f75 2074 6865 2025   gives you the %
+0005b350: 206f 6620 6c61 6265 6c73 2069 6e20 6561   of labels in ea
+0005b360: 6368 2072 6f77 2079 6f75 2067 6f74 2063  ch row you got c
+0005b370: 6f72 7265 6374 6c79 3d25 436f 6d62 696e  orrectly=%Combin
+0005b380: 6564 5f4c 6162 656c 5f41 6363 7572 6163  ed_Label_Accurac
+0005b390: 790d 0a20 2020 2020 2020 2023 2323 2020  y..        ###  
+0005b3a0: 2054 6869 7320 7769 6c6c 2067 6976 6520   This will give 
+0005b3b0: 796f 7520 6120 7369 6e67 6c65 2070 6572  you a single per
+0005b3c0: 6365 6e74 6167 6520 6e75 6d62 6572 2066  centage number f
+0005b3d0: 6f72 2074 6865 2077 686f 6c65 2064 6174  or the whole dat
+0005b3e0: 6120 7365 740d 0a20 2020 2022 2222 0d0a  a set..    """..
+0005b3f0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0005b400: 6528 6c61 6265 6c2c 206c 6973 7429 3a0d  e(label, list):.
+0005b410: 0a20 2020 2020 2020 206c 6162 656c 203d  .        label =
+0005b420: 206e 702e 6172 7261 7928 6c61 6265 6c29   np.array(label)
+0005b430: 0d0a 2020 2020 6966 2069 7369 6e73 7461  ..    if isinsta
+0005b440: 6e63 6528 7072 6564 2c20 6c69 7374 293a  nce(pred, list):
+0005b450: 0d0a 2020 2020 2020 2020 7072 6564 203d  ..        pred =
+0005b460: 206e 702e 6172 7261 7928 7072 6564 290d   np.array(pred).
+0005b470: 0a20 2020 2023 2323 2054 6869 7320 6973  .    ### This is
+0005b480: 2066 6f72 204d 756c 7469 2d4c 6162 656c   for Multi-Label
+0005b490: 2050 726f 626c 656d 7320 2323 2323 2320   Problems ##### 
+0005b4a0: 5265 7475 726e 7320 3220 7265 7375 6c74  Returns 2 result
+0005b4b0: 733a 206f 6e65 206e 756d 6265 7220 616e  s: one number an
+0005b4c0: 640d 0a20 2020 2023 2323 2020 2020 7468  d..    ###    th
+0005b4d0: 6520 7365 636f 6e64 2069 7320 616e 2061  e second is an a
+0005b4e0: 7272 6179 2077 6974 6820 6173 206d 616e  rray with as man
+0005b4f0: 7920 6974 656d 7320 6173 206e 756d 6265  y items as numbe
+0005b500: 7220 6f66 206c 6162 656c 7320 696e 2074  r of labels in t
+0005b510: 6172 6765 740d 0a20 2020 2074 7279 3a0d  arget..    try:.
+0005b520: 0a20 2020 2020 2020 206a 6163 635f 6461  .        jacc_da
+0005b530: 7461 5f73 6574 203d 206e 702e 7375 6d28  ta_set = np.sum(
+0005b540: 6c61 6265 6c3d 3d70 7265 642c 6178 6973  label==pred,axis
+0005b550: 3d31 292e 7375 6d28 292f 6c61 6265 6c2e  =1).sum()/label.
+0005b560: 7368 6170 655b 315d 0d0a 2020 2020 2020  shape[1]..      
+0005b570: 2020 7265 7475 726e 206a 6163 635f 6461    return jacc_da
+0005b580: 7461 5f73 6574 0d0a 2020 2020 6578 6365  ta_set..    exce
+0005b590: 7074 3a0d 0a20 2020 2020 2020 2072 6574  pt:..        ret
+0005b5a0: 7572 6e20 300d 0a23 2323 2323 2323 2323  urn 0..#########
 0005b5b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005b5c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005b5d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005b5e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005b5f0: 2323 2323 2323 2323 2323 2323 0d0a 6465  ############..de
-0005b600: 6620 706c 6f74 5f52 535f 7061 7261 6d73  f plot_RS_params
-0005b610: 2863 765f 7265 7375 6c74 732c 2073 636f  (cv_results, sco
-0005b620: 7265 2c20 6d6e 616d 6529 3a0d 0a20 2020  re, mname):..   
-0005b630: 2022 2222 0d0a 2020 2020 2323 2323 2323   """..    ######
-0005b640: 2320 5468 6973 2070 6c6f 7473 2074 6865  # This plots the
-0005b650: 2047 7269 6453 6561 7263 6843 5620 5265   GridSearchCV Re
-0005b660: 7375 6c74 7320 7365 6e74 2069 6e20 2323  sults sent in ##
-0005b670: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-0005b680: 2222 220d 0a20 2020 2064 6620 3d20 7064  """..    df = pd
-0005b690: 2e44 6174 6146 7261 6d65 2863 765f 7265  .DataFrame(cv_re
-0005b6a0: 7375 6c74 7329 0d0a 2020 2020 7061 7261  sults)..    para
-0005b6b0: 6d73 203d 205b 7820 666f 7220 7820 696e  ms = [x for x in
-0005b6c0: 206c 6973 7428 6466 2920 6966 2078 2e73   list(df) if x.s
-0005b6d0: 7461 7274 7377 6974 6828 2770 6172 616d  tartswith('param
-0005b6e0: 5f27 295d 0d0a 2020 2020 7472 6169 6e63  _')]..    trainc
-0005b6f0: 6f6c 7320 3d20 5b27 6d65 616e 5f74 7261  ols = ['mean_tra
-0005b700: 696e 5f73 636f 7265 2720 5d0d 0a20 2020  in_score' ]..   
-0005b710: 2074 6573 7463 6f6c 7320 3d20 5b27 6d65   testcols = ['me
-0005b720: 616e 5f74 6573 745f 7363 6f72 6527 205d  an_test_score' ]
-0005b730: 0d0a 2020 2020 636f 6c73 203d 2074 7261  ..    cols = tra
-0005b740: 696e 636f 6c73 2b74 6573 7463 6f6c 730d  incols+testcols.
-0005b750: 0a20 2020 206e 636f 6c73 203d 2032 0d0a  .    ncols = 2..
-0005b760: 2020 2020 6e6f 706c 6f74 7320 3d20 6c65      noplots = le
-0005b770: 6e28 7061 7261 6d73 290d 0a20 2020 2069  n(params)..    i
-0005b780: 6620 6e6f 706c 6f74 7325 6e63 6f6c 7320  f noplots%ncols 
-0005b790: 3d3d 2030 3a0d 0a20 2020 2020 2020 2072  == 0:..        r
-0005b7a0: 6f77 7320 3d20 6e6f 706c 6f74 732f 6e63  ows = noplots/nc
-0005b7b0: 6f6c 730d 0a20 2020 2065 6c73 653a 0d0a  ols..    else:..
-0005b7c0: 2020 2020 2020 2020 726f 7773 203d 2028          rows = (
-0005b7d0: 6e6f 706c 6f74 732f 6e63 6f6c 7329 2b31  noplots/ncols)+1
-0005b7e0: 0d0a 2020 2020 6865 6967 6874 5f73 697a  ..    height_siz
-0005b7f0: 6520 3d20 350d 0a20 2020 2077 6964 7468  e = 5..    width
-0005b800: 5f73 697a 6520 3d20 3135 0d0a 2020 2020  _size = 15..    
-0005b810: 6669 6720 3d20 706c 742e 6669 6775 7265  fig = plt.figure
-0005b820: 2866 6967 7369 7a65 3d28 7769 6474 685f  (figsize=(width_
-0005b830: 7369 7a65 2c72 6f77 732a 6865 6967 6874  size,rows*height
-0005b840: 5f73 697a 6529 290d 0a20 2020 2066 6967  _size))..    fig
-0005b850: 2e73 7570 7469 746c 6528 2754 7261 696e  .suptitle('Train
-0005b860: 696e 6720 616e 6420 5661 6c69 6461 7469  ing and Validati
-0005b870: 6f6e 3a20 4879 7065 7220 5061 7261 6d65  on: Hyper Parame
-0005b880: 7465 7220 5475 6e69 6e67 2066 6f72 2074  ter Tuning for t
-0005b890: 6172 6765 743d 2573 2720 256d 6e61 6d65  arget=%s' %mname
-0005b8a0: 2c20 666f 6e74 7369 7a65 3d32 302c 793d  , fontsize=20,y=
-0005b8b0: 312e 3031 290d 0a20 2020 2023 2323 2320  1.01)..    #### 
-0005b8c0: 4966 2074 6865 2076 616c 7565 7320 6172  If the values ar
-0005b8d0: 6520 6e65 6761 7469 7665 2c20 636f 6e76  e negative, conv
-0005b8e0: 6572 7420 7468 656d 2074 6f20 706f 7369  ert them to posi
-0005b8f0: 7469 7665 2023 2323 2323 2323 2323 2323  tive ###########
-0005b900: 230d 0a20 2020 2069 6620 6c65 6e28 6466  #..    if len(df
-0005b910: 2e6c 6f63 5b64 665b 636f 6c73 5b30 5d5d  .loc[df[cols[0]]
-0005b920: 3c30 5d29 203e 2030 3a0d 0a20 2020 2020  <0]) > 0:..     
-0005b930: 2020 2064 665b 636f 6c73 5d20 3d20 6466     df[cols] = df
-0005b940: 5b63 6f6c 735d 2a2d 310d 0a20 2020 2066  [cols]*-1..    f
-0005b950: 6f72 2065 6163 685f 7061 7261 6d2c 2063  or each_param, c
-0005b960: 6f75 6e74 2069 6e20 7a69 7028 7061 7261  ount in zip(para
-0005b970: 6d73 2c20 7261 6e67 6528 6e6f 706c 6f74  ms, range(noplot
-0005b980: 7329 293a 0d0a 2020 2020 2020 2020 706c  s)):..        pl
-0005b990: 742e 7375 6270 6c6f 7428 726f 7773 2c6e  t.subplot(rows,n
-0005b9a0: 636f 6c73 2c63 6f75 6e74 2b31 290d 0a20  cols,count+1).. 
-0005b9b0: 2020 2020 2020 2061 7831 203d 2070 6c74         ax1 = plt
-0005b9c0: 2e67 6361 2829 0d0a 2020 2020 2020 2020  .gca()..        
-0005b9d0: 6966 2064 665b 6561 6368 5f70 6172 616d  if df[each_param
-0005b9e0: 5d2e 6474 7970 6520 213d 206f 626a 6563  ].dtype != objec
-0005b9f0: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
-0005ba00: 6466 5b5b 6561 6368 5f70 6172 616d 5d2b  df[[each_param]+
-0005ba10: 636f 6c73 5d2e 6772 6f75 7062 7928 6561  cols].groupby(ea
-0005ba20: 6368 5f70 6172 616d 292e 6d65 616e 2829  ch_param).mean()
-0005ba30: 2e70 6c6f 7428 6b69 6e64 3d27 6c69 6e65  .plot(kind='line
-0005ba40: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
-0005ba50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005ba60: 7469 746c 653d 2725 7320 666f 7220 2573  title='%s for %s
-0005ba70: 2720 2528 6561 6368 5f70 6172 616d 2c6d  ' %(each_param,m
-0005ba80: 6e61 6d65 292c 6178 3d61 7831 290d 0a20  name),ax=ax1).. 
-0005ba90: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0005baa0: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
-0005bab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005bac0: 6466 5b65 6163 685f 7061 7261 6d5d 203d  df[each_param] =
-0005bad0: 2070 642e 746f 5f6e 756d 6572 6963 2864   pd.to_numeric(d
-0005bae0: 665b 6561 6368 5f70 6172 616d 5d29 0d0a  f[each_param])..
-0005baf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005bb00: 6466 5b5b 6561 6368 5f70 6172 616d 5d2b  df[[each_param]+
-0005bb10: 636f 6c73 5d2e 6772 6f75 7062 7928 6561  cols].groupby(ea
-0005bb20: 6368 5f70 6172 616d 292e 6d65 616e 2829  ch_param).mean()
-0005bb30: 2e70 6c6f 7428 6b69 6e64 3d27 6c69 6e65  .plot(kind='line
-0005bb40: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
-0005bb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005bb60: 7469 746c 653d 2725 7320 666f 7220 2573  title='%s for %s
-0005bb70: 2720 2528 6561 6368 5f70 6172 616d 2c6d  ' %(each_param,m
-0005bb80: 6e61 6d65 292c 2061 783d 6178 3129 0d0a  name), ax=ax1)..
-0005bb90: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-0005bba0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
-0005bbb0: 2020 2020 2064 665b 5b65 6163 685f 7061       df[[each_pa
-0005bbc0: 7261 6d5d 2b63 6f6c 735d 2e67 726f 7570  ram]+cols].group
-0005bbd0: 6279 2865 6163 685f 7061 7261 6d29 2e6d  by(each_param).m
-0005bbe0: 6561 6e28 292e 706c 6f74 286b 696e 643d  ean().plot(kind=
-0005bbf0: 2762 6172 272c 7374 6163 6b65 643d 4661  'bar',stacked=Fa
-0005bc00: 6c73 652c 0d0a 2020 2020 2020 2020 2020  lse,..          
-0005bc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005bc20: 2020 7469 746c 653d 2725 7320 666f 7220    title='%s for 
-0005bc30: 2573 2720 2528 6561 6368 5f70 6172 616d  %s' %(each_param
-0005bc40: 2c6d 6e61 6d65 292c 2061 783d 6178 3129  ,mname), ax=ax1)
-0005bc50: 0d0a 2020 2020 2323 2323 2054 6869 7320  ..    #### This 
-0005bc60: 6973 2074 6f20 706c 6f74 2074 6865 2074  is to plot the t
-0005bc70: 6573 745f 6d65 616e 5f73 636f 7265 2061  est_mean_score a
-0005bc80: 6761 696e 7374 2070 6172 616d 7320 746f  gainst params to
-0005bc90: 2073 6565 2068 6f77 2069 7420 696e 6372   see how it incr
-0005bca0: 6561 7365 730d 0a20 2020 2066 6f72 2065  eases..    for e
-0005bcb0: 6163 685f 7061 7261 6d20 696e 2070 6172  ach_param in par
-0005bcc0: 616d 733a 0d0a 2020 2020 2020 2020 2323  ams:..        ##
-0005bcd0: 2323 2054 6869 7320 6973 2074 6f20 6669  ## This is to fi
-0005bce0: 6e64 2077 6869 6368 2070 6172 616d 6574  nd which paramet
-0005bcf0: 6572 7320 6172 6520 6e6f 6e20 7374 7269  ers are non stri
-0005bd00: 6e67 2061 6e64 2063 6f6e 7665 7274 2074  ng and convert t
-0005bd10: 6865 6d20 746f 2073 7472 696e 6773 0d0a  hem to strings..
-0005bd20: 2020 2020 2020 2020 6966 2064 665b 6561          if df[ea
-0005bd30: 6368 5f70 6172 616d 5d2e 6474 7970 6521  ch_param].dtype!
-0005bd40: 3d6f 626a 6563 743a 0d0a 2020 2020 2020  =object:..      
-0005bd50: 2020 2020 2020 2020 6466 5b65 6163 685f          df[each_
-0005bd60: 7061 7261 6d5d 203d 2064 665b 6561 6368  param] = df[each
-0005bd70: 5f70 6172 616d 5d2e 6173 7479 7065 2873  _param].astype(s
-0005bd80: 7472 290d 0a20 2020 2074 7279 3a0d 0a20  tr)..    try:.. 
-0005bd90: 2020 2020 2020 2064 665b 2763 6f6d 6269         df['combi
-0005bda0: 6e65 645f 7061 7261 6d65 7465 7273 275d  ned_parameters']
-0005bdb0: 203d 2064 665b 7061 7261 6d73 5d2e 6170   = df[params].ap
-0005bdc0: 706c 7928 6c61 6d62 6461 2078 3a20 275f  ply(lambda x: '_
-0005bdd0: 5f27 2e6a 6f69 6e28 7829 2c20 6178 6973  _'.join(x), axis
-0005bde0: 3d31 2029 0d0a 2020 2020 6578 6365 7074  =1 )..    except
-0005bdf0: 3a0d 0a20 2020 2020 2020 2064 665b 2763  :..        df['c
-0005be00: 6f6d 6269 6e65 645f 7061 7261 6d65 7465  ombined_paramete
-0005be10: 7273 275d 203d 2064 665b 7061 7261 6d73  rs'] = df[params
-0005be20: 5d2e 6170 706c 7928 6c61 6d62 6461 2078  ].apply(lambda x
-0005be30: 3a20 275f 5f27 2e6a 6f69 6e28 782e 6d61  : '__'.join(x.ma
-0005be40: 7028 7374 7229 292c 2061 7869 733d 3120  p(str)), axis=1 
-0005be50: 290d 0a20 2020 2069 6620 6c65 6e28 7061  )..    if len(pa
-0005be60: 7261 6d73 2920 3d3d 2031 3a0d 0a20 2020  rams) == 1:..   
-0005be70: 2020 2020 2064 665b 2763 6f6d 6269 6e65       df['combine
-0005be80: 645f 7061 7261 6d65 7465 7273 275d 203d  d_parameters'] =
-0005be90: 2063 6f70 792e 6465 6570 636f 7079 2864   copy.deepcopy(d
-0005bea0: 665b 7061 7261 6d73 5d29 0d0a 2020 2020  f[params])..    
-0005beb0: 656c 7365 3a0d 0a20 2020 2020 2020 2064  else:..        d
-0005bec0: 665b 5b27 636f 6d62 696e 6564 5f70 6172  f[['combined_par
-0005bed0: 616d 6574 6572 7327 5d2b 636f 6c73 5d2e  ameters']+cols].
-0005bee0: 6772 6f75 7062 7928 2763 6f6d 6269 6e65  groupby('combine
-0005bef0: 645f 7061 7261 6d65 7465 7273 2729 2e6d  d_parameters').m
-0005bf00: 6561 6e28 292e 736f 7274 5f76 616c 7565  ean().sort_value
-0005bf10: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
-0005bf20: 636f 6c73 5b31 5d29 2e70 6c6f 7428 6669  cols[1]).plot(fi
-0005bf30: 6773 697a 653d 2877 6964 7468 5f73 697a  gsize=(width_siz
-0005bf40: 652c 6865 6967 6874 5f73 697a 6529 2c6b  e,height_size),k
-0005bf50: 696e 643d 276c 696e 6527 2c73 7562 706c  ind='line',subpl
-0005bf60: 6f74 733d 4661 6c73 652c 0d0a 2020 2020  ots=False,..    
+0005b5f0: 2323 2323 2323 230d 0a64 6566 2070 6c6f  #######..def plo
+0005b600: 745f 5253 5f70 6172 616d 7328 6376 5f72  t_RS_params(cv_r
+0005b610: 6573 756c 7473 2c20 7363 6f72 652c 206d  esults, score, m
+0005b620: 6e61 6d65 293a 0d0a 2020 2020 2222 220d  name):..    """.
+0005b630: 0a20 2020 2023 2323 2323 2323 2054 6869  .    ####### Thi
+0005b640: 7320 706c 6f74 7320 7468 6520 4772 6964  s plots the Grid
+0005b650: 5365 6172 6368 4356 2052 6573 756c 7473  SearchCV Results
+0005b660: 2073 656e 7420 696e 2023 2323 2323 2323   sent in #######
+0005b670: 2323 2323 230d 0a20 2020 2022 2222 0d0a  #####..    """..
+0005b680: 2020 2020 6466 203d 2070 642e 4461 7461      df = pd.Data
+0005b690: 4672 616d 6528 6376 5f72 6573 756c 7473  Frame(cv_results
+0005b6a0: 290d 0a20 2020 2070 6172 616d 7320 3d20  )..    params = 
+0005b6b0: 5b78 2066 6f72 2078 2069 6e20 6c69 7374  [x for x in list
+0005b6c0: 2864 6629 2069 6620 782e 7374 6172 7473  (df) if x.starts
+0005b6d0: 7769 7468 2827 7061 7261 6d5f 2729 5d0d  with('param_')].
+0005b6e0: 0a20 2020 2074 7261 696e 636f 6c73 203d  .    traincols =
+0005b6f0: 205b 276d 6561 6e5f 7472 6169 6e5f 7363   ['mean_train_sc
+0005b700: 6f72 6527 205d 0d0a 2020 2020 7465 7374  ore' ]..    test
+0005b710: 636f 6c73 203d 205b 276d 6561 6e5f 7465  cols = ['mean_te
+0005b720: 7374 5f73 636f 7265 2720 5d0d 0a20 2020  st_score' ]..   
+0005b730: 2063 6f6c 7320 3d20 7472 6169 6e63 6f6c   cols = traincol
+0005b740: 732b 7465 7374 636f 6c73 0d0a 2020 2020  s+testcols..    
+0005b750: 6e63 6f6c 7320 3d20 320d 0a20 2020 206e  ncols = 2..    n
+0005b760: 6f70 6c6f 7473 203d 206c 656e 2870 6172  oplots = len(par
+0005b770: 616d 7329 0d0a 2020 2020 6966 206e 6f70  ams)..    if nop
+0005b780: 6c6f 7473 256e 636f 6c73 203d 3d20 303a  lots%ncols == 0:
+0005b790: 0d0a 2020 2020 2020 2020 726f 7773 203d  ..        rows =
+0005b7a0: 206e 6f70 6c6f 7473 2f6e 636f 6c73 0d0a   noplots/ncols..
+0005b7b0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0005b7c0: 2020 2072 6f77 7320 3d20 286e 6f70 6c6f     rows = (noplo
+0005b7d0: 7473 2f6e 636f 6c73 292b 310d 0a20 2020  ts/ncols)+1..   
+0005b7e0: 2068 6569 6768 745f 7369 7a65 203d 2035   height_size = 5
+0005b7f0: 0d0a 2020 2020 7769 6474 685f 7369 7a65  ..    width_size
+0005b800: 203d 2031 350d 0a20 2020 2066 6967 203d   = 15..    fig =
+0005b810: 2070 6c74 2e66 6967 7572 6528 6669 6773   plt.figure(figs
+0005b820: 697a 653d 2877 6964 7468 5f73 697a 652c  ize=(width_size,
+0005b830: 726f 7773 2a68 6569 6768 745f 7369 7a65  rows*height_size
+0005b840: 2929 0d0a 2020 2020 6669 672e 7375 7074  ))..    fig.supt
+0005b850: 6974 6c65 2827 5472 6169 6e69 6e67 2061  itle('Training a
+0005b860: 6e64 2056 616c 6964 6174 696f 6e3a 2048  nd Validation: H
+0005b870: 7970 6572 2050 6172 616d 6574 6572 2054  yper Parameter T
+0005b880: 756e 696e 6720 666f 7220 7461 7267 6574  uning for target
+0005b890: 3d25 7327 2025 6d6e 616d 652c 2066 6f6e  =%s' %mname, fon
+0005b8a0: 7473 697a 653d 3230 2c79 3d31 2e30 3129  tsize=20,y=1.01)
+0005b8b0: 0d0a 2020 2020 2323 2323 2049 6620 7468  ..    #### If th
+0005b8c0: 6520 7661 6c75 6573 2061 7265 206e 6567  e values are neg
+0005b8d0: 6174 6976 652c 2063 6f6e 7665 7274 2074  ative, convert t
+0005b8e0: 6865 6d20 746f 2070 6f73 6974 6976 6520  hem to positive 
+0005b8f0: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
+0005b900: 2020 6966 206c 656e 2864 662e 6c6f 635b    if len(df.loc[
+0005b910: 6466 5b63 6f6c 735b 305d 5d3c 305d 2920  df[cols[0]]<0]) 
+0005b920: 3e20 303a 0d0a 2020 2020 2020 2020 6466  > 0:..        df
+0005b930: 5b63 6f6c 735d 203d 2064 665b 636f 6c73  [cols] = df[cols
+0005b940: 5d2a 2d31 0d0a 2020 2020 666f 7220 6561  ]*-1..    for ea
+0005b950: 6368 5f70 6172 616d 2c20 636f 756e 7420  ch_param, count 
+0005b960: 696e 207a 6970 2870 6172 616d 732c 2072  in zip(params, r
+0005b970: 616e 6765 286e 6f70 6c6f 7473 2929 3a0d  ange(noplots)):.
+0005b980: 0a20 2020 2020 2020 2070 6c74 2e73 7562  .        plt.sub
+0005b990: 706c 6f74 2872 6f77 732c 6e63 6f6c 732c  plot(rows,ncols,
+0005b9a0: 636f 756e 742b 3129 0d0a 2020 2020 2020  count+1)..      
+0005b9b0: 2020 6178 3120 3d20 706c 742e 6763 6128    ax1 = plt.gca(
+0005b9c0: 290d 0a20 2020 2020 2020 2069 6620 6466  )..        if df
+0005b9d0: 5b65 6163 685f 7061 7261 6d5d 2e64 7479  [each_param].dty
+0005b9e0: 7065 2021 3d20 6f62 6a65 6374 3a0d 0a20  pe != object:.. 
+0005b9f0: 2020 2020 2020 2020 2020 2064 665b 5b65             df[[e
+0005ba00: 6163 685f 7061 7261 6d5d 2b63 6f6c 735d  ach_param]+cols]
+0005ba10: 2e67 726f 7570 6279 2865 6163 685f 7061  .groupby(each_pa
+0005ba20: 7261 6d29 2e6d 6561 6e28 292e 706c 6f74  ram).mean().plot
+0005ba30: 286b 696e 643d 276c 696e 6527 2c0d 0a20  (kind='line',.. 
+0005ba40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005ba50: 2020 2020 2020 2020 2020 2074 6974 6c65             title
+0005ba60: 3d27 2573 2066 6f72 2025 7327 2025 2865  ='%s for %s' %(e
+0005ba70: 6163 685f 7061 7261 6d2c 6d6e 616d 6529  ach_param,mname)
+0005ba80: 2c61 783d 6178 3129 0d0a 2020 2020 2020  ,ax=ax1)..      
+0005ba90: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0005baa0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+0005bab0: 2020 2020 2020 2020 2020 2064 665b 6561             df[ea
+0005bac0: 6368 5f70 6172 616d 5d20 3d20 7064 2e74  ch_param] = pd.t
+0005bad0: 6f5f 6e75 6d65 7269 6328 6466 5b65 6163  o_numeric(df[eac
+0005bae0: 685f 7061 7261 6d5d 290d 0a20 2020 2020  h_param])..     
+0005baf0: 2020 2020 2020 2020 2020 2064 665b 5b65             df[[e
+0005bb00: 6163 685f 7061 7261 6d5d 2b63 6f6c 735d  ach_param]+cols]
+0005bb10: 2e67 726f 7570 6279 2865 6163 685f 7061  .groupby(each_pa
+0005bb20: 7261 6d29 2e6d 6561 6e28 292e 706c 6f74  ram).mean().plot
+0005bb30: 286b 696e 643d 276c 696e 6527 2c0d 0a20  (kind='line',.. 
+0005bb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005bb50: 2020 2020 2020 2020 2020 2074 6974 6c65             title
+0005bb60: 3d27 2573 2066 6f72 2025 7327 2025 2865  ='%s for %s' %(e
+0005bb70: 6163 685f 7061 7261 6d2c 6d6e 616d 6529  ach_param,mname)
+0005bb80: 2c20 6178 3d61 7831 290d 0a20 2020 2020  , ax=ax1)..     
+0005bb90: 2020 2020 2020 2065 7863 6570 743a 0d0a         except:..
+0005bba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005bbb0: 6466 5b5b 6561 6368 5f70 6172 616d 5d2b  df[[each_param]+
+0005bbc0: 636f 6c73 5d2e 6772 6f75 7062 7928 6561  cols].groupby(ea
+0005bbd0: 6368 5f70 6172 616d 292e 6d65 616e 2829  ch_param).mean()
+0005bbe0: 2e70 6c6f 7428 6b69 6e64 3d27 6261 7227  .plot(kind='bar'
+0005bbf0: 2c73 7461 636b 6564 3d46 616c 7365 2c0d  ,stacked=False,.
+0005bc00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0005bc10: 2020 2020 2020 2020 2020 2020 2074 6974               tit
+0005bc20: 6c65 3d27 2573 2066 6f72 2025 7327 2025  le='%s for %s' %
+0005bc30: 2865 6163 685f 7061 7261 6d2c 6d6e 616d  (each_param,mnam
+0005bc40: 6529 2c20 6178 3d61 7831 290d 0a20 2020  e), ax=ax1)..   
+0005bc50: 2023 2323 2320 5468 6973 2069 7320 746f   #### This is to
+0005bc60: 2070 6c6f 7420 7468 6520 7465 7374 5f6d   plot the test_m
+0005bc70: 6561 6e5f 7363 6f72 6520 6167 6169 6e73  ean_score agains
+0005bc80: 7420 7061 7261 6d73 2074 6f20 7365 6520  t params to see 
+0005bc90: 686f 7720 6974 2069 6e63 7265 6173 6573  how it increases
+0005bca0: 0d0a 2020 2020 666f 7220 6561 6368 5f70  ..    for each_p
+0005bcb0: 6172 616d 2069 6e20 7061 7261 6d73 3a0d  aram in params:.
+0005bcc0: 0a20 2020 2020 2020 2023 2323 2320 5468  .        #### Th
+0005bcd0: 6973 2069 7320 746f 2066 696e 6420 7768  is is to find wh
+0005bce0: 6963 6820 7061 7261 6d65 7465 7273 2061  ich parameters a
+0005bcf0: 7265 206e 6f6e 2073 7472 696e 6720 616e  re non string an
+0005bd00: 6420 636f 6e76 6572 7420 7468 656d 2074  d convert them t
+0005bd10: 6f20 7374 7269 6e67 730d 0a20 2020 2020  o strings..     
+0005bd20: 2020 2069 6620 6466 5b65 6163 685f 7061     if df[each_pa
+0005bd30: 7261 6d5d 2e64 7479 7065 213d 6f62 6a65  ram].dtype!=obje
+0005bd40: 6374 3a0d 0a20 2020 2020 2020 2020 2020  ct:..           
+0005bd50: 2020 2064 665b 6561 6368 5f70 6172 616d     df[each_param
+0005bd60: 5d20 3d20 6466 5b65 6163 685f 7061 7261  ] = df[each_para
+0005bd70: 6d5d 2e61 7374 7970 6528 7374 7229 0d0a  m].astype(str)..
+0005bd80: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
+0005bd90: 2020 6466 5b27 636f 6d62 696e 6564 5f70    df['combined_p
+0005bda0: 6172 616d 6574 6572 7327 5d20 3d20 6466  arameters'] = df
+0005bdb0: 5b70 6172 616d 735d 2e61 7070 6c79 286c  [params].apply(l
+0005bdc0: 616d 6264 6120 783a 2027 5f5f 272e 6a6f  ambda x: '__'.jo
+0005bdd0: 696e 2878 292c 2061 7869 733d 3120 290d  in(x), axis=1 ).
+0005bde0: 0a20 2020 2065 7863 6570 743a 0d0a 2020  .    except:..  
+0005bdf0: 2020 2020 2020 6466 5b27 636f 6d62 696e        df['combin
+0005be00: 6564 5f70 6172 616d 6574 6572 7327 5d20  ed_parameters'] 
+0005be10: 3d20 6466 5b70 6172 616d 735d 2e61 7070  = df[params].app
+0005be20: 6c79 286c 616d 6264 6120 783a 2027 5f5f  ly(lambda x: '__
+0005be30: 272e 6a6f 696e 2878 2e6d 6170 2873 7472  '.join(x.map(str
+0005be40: 2929 2c20 6178 6973 3d31 2029 0d0a 2020  )), axis=1 )..  
+0005be50: 2020 6966 206c 656e 2870 6172 616d 7329    if len(params)
+0005be60: 203d 3d20 313a 0d0a 2020 2020 2020 2020   == 1:..        
+0005be70: 6466 5b27 636f 6d62 696e 6564 5f70 6172  df['combined_par
+0005be80: 616d 6574 6572 7327 5d20 3d20 636f 7079  ameters'] = copy
+0005be90: 2e64 6565 7063 6f70 7928 6466 5b70 6172  .deepcopy(df[par
+0005bea0: 616d 735d 290d 0a20 2020 2065 6c73 653a  ams])..    else:
+0005beb0: 0d0a 2020 2020 2020 2020 6466 5b5b 2763  ..        df[['c
+0005bec0: 6f6d 6269 6e65 645f 7061 7261 6d65 7465  ombined_paramete
+0005bed0: 7273 275d 2b63 6f6c 735d 2e67 726f 7570  rs']+cols].group
+0005bee0: 6279 2827 636f 6d62 696e 6564 5f70 6172  by('combined_par
+0005bef0: 616d 6574 6572 7327 292e 6d65 616e 2829  ameters').mean()
+0005bf00: 2e73 6f72 745f 7661 6c75 6573 280d 0a20  .sort_values(.. 
+0005bf10: 2020 2020 2020 2020 2020 2063 6f6c 735b             cols[
+0005bf20: 315d 292e 706c 6f74 2866 6967 7369 7a65  1]).plot(figsize
+0005bf30: 3d28 7769 6474 685f 7369 7a65 2c68 6569  =(width_size,hei
+0005bf40: 6768 745f 7369 7a65 292c 6b69 6e64 3d27  ght_size),kind='
+0005bf50: 6c69 6e65 272c 7375 6270 6c6f 7473 3d46  line',subplots=F
+0005bf60: 616c 7365 2c0d 0a20 2020 2020 2020 2020  alse,..         
 0005bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005bf80: 2020 2020 2020 2020 7469 746c 653d 2743          title='C
-0005bf90: 6f6d 6269 6e65 6420 5061 7261 6d65 7465  ombined Paramete
-0005bfa0: 7273 3a20 2573 2073 636f 7265 7320 666f  rs: %s scores fo
-0005bfb0: 7220 2573 2720 2528 7363 6f72 652c 6d6e  r %s' %(score,mn
-0005bfc0: 616d 6529 290d 0a20 2020 2070 6c74 2e78  ame))..    plt.x
-0005bfd0: 7469 636b 7328 726f 7461 7469 6f6e 3d34  ticks(rotation=4
-0005bfe0: 3529 0d0a 2020 2020 706c 742e 7368 6f77  5)..    plt.show
-0005bff0: 2829 3b0d 0a20 2020 2072 6574 7572 6e20  ();..    return 
-0005c000: 6466 0d0a 2323 2323 2323 2323 2323 2323  df..############
+0005bf80: 2020 2074 6974 6c65 3d27 436f 6d62 696e     title='Combin
+0005bf90: 6564 2050 6172 616d 6574 6572 733a 2025  ed Parameters: %
+0005bfa0: 7320 7363 6f72 6573 2066 6f72 2025 7327  s scores for %s'
+0005bfb0: 2025 2873 636f 7265 2c6d 6e61 6d65 2929   %(score,mname))
+0005bfc0: 0d0a 2020 2020 706c 742e 7874 6963 6b73  ..    plt.xticks
+0005bfd0: 2872 6f74 6174 696f 6e3d 3435 290d 0a20  (rotation=45).. 
+0005bfe0: 2020 2070 6c74 2e73 686f 7728 293b 0d0a     plt.show();..
+0005bff0: 2020 2020 7265 7475 726e 2064 660d 0a23      return df..#
+0005c000: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005c010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005c020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005c030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005c040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005c050: 2323 2323 0d0a 6465 6620 706c 6f74 5f78  ####..def plot_x
-0005c060: 6762 5f6d 6574 7269 6373 286d 6f64 656c  gb_metrics(model
-0005c070: 2c65 7661 6c5f 6d65 7472 6963 2c65 7661  ,eval_metric,eva
-0005c080: 6c5f 7365 742c 6d6f 6465 6c74 7970 652c  l_set,modeltype,
-0005c090: 6d6f 6465 6c5f 6c61 6265 6c3d 2727 2c6d  model_label='',m
-0005c0a0: 6f64 656c 5f6e 616d 653d 2222 293a 0d0a  odel_name=""):..
-0005c0b0: 2020 2020 6865 6967 6874 5f73 697a 6520      height_size 
-0005c0c0: 3d20 350d 0a20 2020 2077 6964 7468 5f73  = 5..    width_s
-0005c0d0: 697a 6520 3d20 3130 0d0a 2020 2020 6966  ize = 10..    if
-0005c0e0: 206d 6f64 656c 5f6e 616d 652e 6c6f 7765   model_name.lowe
-0005c0f0: 7228 2920 3d3d 2027 6361 7462 6f6f 7374  r() == 'catboost
-0005c100: 273a 0d0a 2020 2020 2020 2020 7265 7375  ':..        resu
-0005c110: 6c74 7320 3d20 6d6f 6465 6c2e 6765 745f  lts = model.get_
-0005c120: 6576 616c 735f 7265 7375 6c74 2829 0d0a  evals_result()..
-0005c130: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0005c140: 2020 2072 6573 756c 7473 203d 206d 6f64     results = mod
-0005c150: 656c 2e65 7661 6c73 5f72 6573 756c 7428  el.evals_result(
-0005c160: 290d 0a20 2020 2072 6573 5f6b 6579 7320  )..    res_keys 
-0005c170: 3d20 6c69 7374 2872 6573 756c 7473 2e6b  = list(results.k
-0005c180: 6579 7328 2929 0d0a 2020 2020 6576 616c  eys())..    eval
-0005c190: 5f6d 6574 7269 6320 3d20 6c69 7374 2872  _metric = list(r
-0005c1a0: 6573 756c 7473 5b72 6573 5f6b 6579 735b  esults[res_keys[
-0005c1b0: 305d 5d2e 6b65 7973 2829 290d 0a20 2020  0]].keys())..   
-0005c1c0: 2069 6620 6973 696e 7374 616e 6365 2865   if isinstance(e
-0005c1d0: 7661 6c5f 6d65 7472 6963 2c20 6c69 7374  val_metric, list
-0005c1e0: 293a 0d0a 2020 2020 2020 2020 2320 706c  ):..        # pl
-0005c1f0: 6f74 206c 6f67 206c 6f73 730d 0a20 2020  ot log loss..   
-0005c200: 2020 2020 2065 7661 6c5f 6d65 7472 6963       eval_metric
-0005c210: 203d 2065 7661 6c5f 6d65 7472 6963 5b30   = eval_metric[0
-0005c220: 5d0d 0a20 2020 2023 2070 6c6f 7420 6d65  ]..    # plot me
-0005c230: 7472 6963 7320 6e6f 770d 0a20 2020 2066  trics now..    f
-0005c240: 6967 2c20 6178 203d 2070 6c74 2e73 7562  ig, ax = plt.sub
-0005c250: 706c 6f74 7328 6669 6773 697a 653d 2877  plots(figsize=(w
-0005c260: 6964 7468 5f73 697a 652c 2068 6569 6768  idth_size, heigh
-0005c270: 745f 7369 7a65 2929 0d0a 2020 2020 6570  t_size))..    ep
-0005c280: 6f63 6873 203d 206c 656e 2872 6573 756c  ochs = len(resul
-0005c290: 7473 5b72 6573 5f6b 6579 735b 305d 5d5b  ts[res_keys[0]][
-0005c2a0: 6576 616c 5f6d 6574 7269 635d 290d 0a20  eval_metric]).. 
-0005c2b0: 2020 2078 5f61 7869 7320 3d20 7261 6e67     x_axis = rang
-0005c2c0: 6528 302c 2065 706f 6368 7329 0d0a 2020  e(0, epochs)..  
-0005c2d0: 2020 6966 206d 6f64 656c 5f6e 616d 652e    if model_name.
-0005c2e0: 6c6f 7765 7228 2920 3d3d 2027 6361 7462  lower() == 'catb
-0005c2f0: 6f6f 7374 273a 0d0a 2020 2020 2020 2020  oost':..        
-0005c300: 6178 2e70 6c6f 7428 785f 6178 6973 2c20  ax.plot(x_axis, 
-0005c310: 7265 7375 6c74 735b 7265 735f 6b65 7973  results[res_keys
-0005c320: 5b30 5d5d 5b65 7661 6c5f 6d65 7472 6963  [0]][eval_metric
-0005c330: 5d2c 206c 6162 656c 3d27 2573 2720 2572  ], label='%s' %r
-0005c340: 6573 5f6b 6579 735b 305d 290d 0a20 2020  es_keys[0])..   
-0005c350: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-0005c360: 6178 2e70 6c6f 7428 785f 6178 6973 2c20  ax.plot(x_axis, 
-0005c370: 7265 7375 6c74 735b 7265 735f 6b65 7973  results[res_keys
-0005c380: 5b30 5d5d 5b65 7661 6c5f 6d65 7472 6963  [0]][eval_metric
-0005c390: 5d2c 206c 6162 656c 3d27 2573 2720 2572  ], label='%s' %r
-0005c3a0: 6573 5f6b 6579 735b 305d 290d 0a20 2020  es_keys[0])..   
-0005c3b0: 2065 706f 6368 7320 3d20 6c65 6e28 7265   epochs = len(re
-0005c3c0: 7375 6c74 735b 7265 735f 6b65 7973 5b2d  sults[res_keys[-
-0005c3d0: 315d 5d5b 6576 616c 5f6d 6574 7269 635d  1]][eval_metric]
-0005c3e0: 290d 0a20 2020 2078 5f61 7869 7320 3d20  )..    x_axis = 
-0005c3f0: 7261 6e67 6528 302c 2065 706f 6368 7329  range(0, epochs)
-0005c400: 0d0a 2020 2020 6178 2e70 6c6f 7428 785f  ..    ax.plot(x_
-0005c410: 6178 6973 2c20 7265 7375 6c74 735b 7265  axis, results[re
-0005c420: 735f 6b65 7973 5b2d 315d 5d5b 6576 616c  s_keys[-1]][eval
-0005c430: 5f6d 6574 7269 635d 2c20 6c61 6265 6c3d  _metric], label=
-0005c440: 2725 7327 2025 7265 735f 6b65 7973 5b2d  '%s' %res_keys[-
-0005c450: 315d 290d 0a20 2020 2061 782e 6c65 6765  1])..    ax.lege
-0005c460: 6e64 2829 0d0a 2020 2020 706c 742e 796c  nd()..    plt.yl
-0005c470: 6162 656c 2865 7661 6c5f 6d65 7472 6963  abel(eval_metric
-0005c480: 290d 0a20 2020 2070 6c74 2e74 6974 6c65  )..    plt.title
-0005c490: 2827 2573 2054 7261 696e 2061 6e64 2056  ('%s Train and V
-0005c4a0: 616c 6964 6174 696f 6e20 4d65 7472 6963  alidation Metric
-0005c4b0: 7320 6163 726f 7373 2045 706f 6368 7320  s across Epochs 
-0005c4c0: 2845 6172 6c79 2053 746f 7070 696e 6720  (Early Stopping 
-0005c4d0: 696e 2065 6666 6563 7429 2720 256d 6f64  in effect)' %mod
-0005c4e0: 656c 5f6c 6162 656c 290d 0a20 2020 2070  el_label)..    p
-0005c4f0: 6c74 2e73 686f 7728 293b 0d0a 2323 2323  lt.show();..####
+0005c040: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+0005c050: 0a64 6566 2070 6c6f 745f 7867 625f 6d65  .def plot_xgb_me
+0005c060: 7472 6963 7328 6d6f 6465 6c2c 6576 616c  trics(model,eval
+0005c070: 5f6d 6574 7269 632c 6576 616c 5f73 6574  _metric,eval_set
+0005c080: 2c6d 6f64 656c 7479 7065 2c6d 6f64 656c  ,modeltype,model
+0005c090: 5f6c 6162 656c 3d27 272c 6d6f 6465 6c5f  _label='',model_
+0005c0a0: 6e61 6d65 3d22 2229 3a0d 0a20 2020 2068  name=""):..    h
+0005c0b0: 6569 6768 745f 7369 7a65 203d 2035 0d0a  eight_size = 5..
+0005c0c0: 2020 2020 7769 6474 685f 7369 7a65 203d      width_size =
+0005c0d0: 2031 300d 0a20 2020 2069 6620 6d6f 6465   10..    if mode
+0005c0e0: 6c5f 6e61 6d65 2e6c 6f77 6572 2829 203d  l_name.lower() =
+0005c0f0: 3d20 2763 6174 626f 6f73 7427 3a0d 0a20  = 'catboost':.. 
+0005c100: 2020 2020 2020 2072 6573 756c 7473 203d         results =
+0005c110: 206d 6f64 656c 2e67 6574 5f65 7661 6c73   model.get_evals
+0005c120: 5f72 6573 756c 7428 290d 0a20 2020 2065  _result()..    e
+0005c130: 6c73 653a 0d0a 2020 2020 2020 2020 7265  lse:..        re
+0005c140: 7375 6c74 7320 3d20 6d6f 6465 6c2e 6576  sults = model.ev
+0005c150: 616c 735f 7265 7375 6c74 2829 0d0a 2020  als_result()..  
+0005c160: 2020 7265 735f 6b65 7973 203d 206c 6973    res_keys = lis
+0005c170: 7428 7265 7375 6c74 732e 6b65 7973 2829  t(results.keys()
+0005c180: 290d 0a20 2020 2065 7661 6c5f 6d65 7472  )..    eval_metr
+0005c190: 6963 203d 206c 6973 7428 7265 7375 6c74  ic = list(result
+0005c1a0: 735b 7265 735f 6b65 7973 5b30 5d5d 2e6b  s[res_keys[0]].k
+0005c1b0: 6579 7328 2929 0d0a 2020 2020 6966 2069  eys())..    if i
+0005c1c0: 7369 6e73 7461 6e63 6528 6576 616c 5f6d  sinstance(eval_m
+0005c1d0: 6574 7269 632c 206c 6973 7429 3a0d 0a20  etric, list):.. 
+0005c1e0: 2020 2020 2020 2023 2070 6c6f 7420 6c6f         # plot lo
+0005c1f0: 6720 6c6f 7373 0d0a 2020 2020 2020 2020  g loss..        
+0005c200: 6576 616c 5f6d 6574 7269 6320 3d20 6576  eval_metric = ev
+0005c210: 616c 5f6d 6574 7269 635b 305d 0d0a 2020  al_metric[0]..  
+0005c220: 2020 2320 706c 6f74 206d 6574 7269 6373    # plot metrics
+0005c230: 206e 6f77 0d0a 2020 2020 6669 672c 2061   now..    fig, a
+0005c240: 7820 3d20 706c 742e 7375 6270 6c6f 7473  x = plt.subplots
+0005c250: 2866 6967 7369 7a65 3d28 7769 6474 685f  (figsize=(width_
+0005c260: 7369 7a65 2c20 6865 6967 6874 5f73 697a  size, height_siz
+0005c270: 6529 290d 0a20 2020 2065 706f 6368 7320  e))..    epochs 
+0005c280: 3d20 6c65 6e28 7265 7375 6c74 735b 7265  = len(results[re
+0005c290: 735f 6b65 7973 5b30 5d5d 5b65 7661 6c5f  s_keys[0]][eval_
+0005c2a0: 6d65 7472 6963 5d29 0d0a 2020 2020 785f  metric])..    x_
+0005c2b0: 6178 6973 203d 2072 616e 6765 2830 2c20  axis = range(0, 
+0005c2c0: 6570 6f63 6873 290d 0a20 2020 2069 6620  epochs)..    if 
+0005c2d0: 6d6f 6465 6c5f 6e61 6d65 2e6c 6f77 6572  model_name.lower
+0005c2e0: 2829 203d 3d20 2763 6174 626f 6f73 7427  () == 'catboost'
+0005c2f0: 3a0d 0a20 2020 2020 2020 2061 782e 706c  :..        ax.pl
+0005c300: 6f74 2878 5f61 7869 732c 2072 6573 756c  ot(x_axis, resul
+0005c310: 7473 5b72 6573 5f6b 6579 735b 305d 5d5b  ts[res_keys[0]][
+0005c320: 6576 616c 5f6d 6574 7269 635d 2c20 6c61  eval_metric], la
+0005c330: 6265 6c3d 2725 7327 2025 7265 735f 6b65  bel='%s' %res_ke
+0005c340: 7973 5b30 5d29 0d0a 2020 2020 656c 7365  ys[0])..    else
+0005c350: 3a0d 0a20 2020 2020 2020 2061 782e 706c  :..        ax.pl
+0005c360: 6f74 2878 5f61 7869 732c 2072 6573 756c  ot(x_axis, resul
+0005c370: 7473 5b72 6573 5f6b 6579 735b 305d 5d5b  ts[res_keys[0]][
+0005c380: 6576 616c 5f6d 6574 7269 635d 2c20 6c61  eval_metric], la
+0005c390: 6265 6c3d 2725 7327 2025 7265 735f 6b65  bel='%s' %res_ke
+0005c3a0: 7973 5b30 5d29 0d0a 2020 2020 6570 6f63  ys[0])..    epoc
+0005c3b0: 6873 203d 206c 656e 2872 6573 756c 7473  hs = len(results
+0005c3c0: 5b72 6573 5f6b 6579 735b 2d31 5d5d 5b65  [res_keys[-1]][e
+0005c3d0: 7661 6c5f 6d65 7472 6963 5d29 0d0a 2020  val_metric])..  
+0005c3e0: 2020 785f 6178 6973 203d 2072 616e 6765    x_axis = range
+0005c3f0: 2830 2c20 6570 6f63 6873 290d 0a20 2020  (0, epochs)..   
+0005c400: 2061 782e 706c 6f74 2878 5f61 7869 732c   ax.plot(x_axis,
+0005c410: 2072 6573 756c 7473 5b72 6573 5f6b 6579   results[res_key
+0005c420: 735b 2d31 5d5d 5b65 7661 6c5f 6d65 7472  s[-1]][eval_metr
+0005c430: 6963 5d2c 206c 6162 656c 3d27 2573 2720  ic], label='%s' 
+0005c440: 2572 6573 5f6b 6579 735b 2d31 5d29 0d0a  %res_keys[-1])..
+0005c450: 2020 2020 6178 2e6c 6567 656e 6428 290d      ax.legend().
+0005c460: 0a20 2020 2070 6c74 2e79 6c61 6265 6c28  .    plt.ylabel(
+0005c470: 6576 616c 5f6d 6574 7269 6329 0d0a 2020  eval_metric)..  
+0005c480: 2020 706c 742e 7469 746c 6528 2725 7320    plt.title('%s 
+0005c490: 5472 6169 6e20 616e 6420 5661 6c69 6461  Train and Valida
+0005c4a0: 7469 6f6e 204d 6574 7269 6373 2061 6372  tion Metrics acr
+0005c4b0: 6f73 7320 4570 6f63 6873 2028 4561 726c  oss Epochs (Earl
+0005c4c0: 7920 5374 6f70 7069 6e67 2069 6e20 6566  y Stopping in ef
+0005c4d0: 6665 6374 2927 2025 6d6f 6465 6c5f 6c61  fect)' %model_la
+0005c4e0: 6265 6c29 0d0a 2020 2020 706c 742e 7368  bel)..    plt.sh
+0005c4f0: 6f77 2829 3b0d 0a23 2323 2323 2323 2323  ow();..#########
 0005c500: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005c510: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005c520: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005c530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005c540: 2323 2323 2323 2323 2323 2323 230d 0a66  #############..f
-0005c550: 726f 6d20 736b 6c65 6172 6e20 696d 706f  rom sklearn impo
-0005c560: 7274 206d 6574 7269 6373 0d0a 696d 706f  rt metrics..impo
-0005c570: 7274 206d 6174 706c 6f74 6c69 622e 7079  rt matplotlib.py
-0005c580: 706c 6f74 2061 7320 706c 740d 0a69 6d70  plot as plt..imp
-0005c590: 6f72 7420 636f 7079 0d0a 696d 706f 7274  ort copy..import
-0005c5a0: 2070 6462 0d0a 6465 6620 7072 696e 745f   pdb..def print_
-0005c5b0: 636c 6173 7369 6669 6361 7469 6f6e 5f6d  classification_m
-0005c5c0: 6574 7269 6373 2879 5f74 6573 742c 2079  etrics(y_test, y
-0005c5d0: 5f70 726f 6273 2c20 7072 6f62 615f 666c  _probs, proba_fl
-0005c5e0: 6167 3d54 7275 6529 3a0d 0a20 2020 2022  ag=True):..    "
-0005c5f0: 2222 0d0a 2020 2020 2323 2323 2323 2320  ""..    ####### 
-0005c600: 2053 656e 6420 696e 2074 6865 2061 6374   Send in the act
-0005c610: 7561 6c5f 7661 6c75 6573 2061 6e64 2070  ual_values and p
-0005c620: 7265 6469 6374 696f 6e5f 7072 6f62 6162  rediction_probab
-0005c630: 696c 6974 6965 7320 666f 7220 6269 6e61  ilities for bina
-0005c640: 7279 2063 6c61 7373 6573 0d0a 2020 2020  ry classes..    
-0005c650: 5468 6973 2077 696c 6c20 7265 7475 726e  This will return
-0005c660: 2062 6163 6b20 6d65 7472 6963 7320 616e   back metrics an
-0005c670: 6420 7072 696e 7420 7468 656d 2061 6c6c  d print them all
-0005c680: 2069 6e20 6120 6e65 6174 2066 6f72 6d61   in a neat forma
-0005c690: 740d 0a20 2020 2022 2222 0d0a 2020 2020  t..    """..    
-0005c6a0: 795f 7465 7374 203d 2063 6f70 792e 6465  y_test = copy.de
-0005c6b0: 6570 636f 7079 2879 5f74 6573 7429 0d0a  epcopy(y_test)..
-0005c6c0: 2020 2020 6d75 6c74 695f 6c61 6265 6c5f      multi_label_
-0005c6d0: 666c 6167 203d 2046 616c 7365 0d0a 2020  flag = False..  
-0005c6e0: 2020 6d75 6c74 695f 636c 6173 735f 666c    multi_class_fl
-0005c6f0: 6167 203d 2046 616c 7365 0d0a 2020 2020  ag = False..    
-0005c700: 7472 793a 0d0a 2020 2020 2020 2020 6966  try:..        if
-0005c710: 2079 5f74 6573 742e 7368 6170 655b 315d   y_test.shape[1]
-0005c720: 203e 2030 3a0d 0a20 2020 2020 2020 2020   > 0:..         
-0005c730: 2020 206d 756c 7469 5f6c 6162 656c 5f66     multi_label_f
-0005c740: 6c61 6720 3d20 5472 7565 0d0a 2020 2020  lag = True..    
-0005c750: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
-0005c760: 2070 6173 730d 0a20 2020 2023 2323 2323   pass..    #####
-0005c770: 2323 2320 5468 6973 2069 7320 7768 6572  ### This is wher
-0005c780: 6520 796f 7520 7374 6172 7420 7072 696e  e you start prin
-0005c790: 7469 6e67 206d 6574 7269 6373 2023 2323  ting metrics ###
-0005c7a0: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
-0005c7b0: 2020 6966 206c 656e 286e 702e 756e 6971    if len(np.uniq
-0005c7c0: 7565 2879 5f74 6573 7429 2920 3e20 323a  ue(y_test)) > 2:
-0005c7d0: 0d0a 2020 2020 2020 2020 6d75 6c74 695f  ..        multi_
-0005c7e0: 636c 6173 735f 666c 6167 203d 2054 7275  class_flag = Tru
-0005c7f0: 650d 0a20 2020 2020 2020 2070 7269 6e74  e..        print
-0005c800: 2827 4d75 6c74 6920 436c 6173 7320 4d6f  ('Multi Class Mo
-0005c810: 6465 6c20 4d65 7472 6963 7320 5265 706f  del Metrics Repo
-0005c820: 7274 2729 0d0a 2020 2020 2020 2020 7072  rt')..        pr
-0005c830: 696e 7428 2723 2323 2323 2323 2323 2323  int('###########
+0005c540: 2323 2323 2323 2323 0d0a 6672 6f6d 2073  ########..from s
+0005c550: 6b6c 6561 726e 2069 6d70 6f72 7420 6d65  klearn import me
+0005c560: 7472 6963 730d 0a69 6d70 6f72 7420 6d61  trics..import ma
+0005c570: 7470 6c6f 746c 6962 2e70 7970 6c6f 7420  tplotlib.pyplot 
+0005c580: 6173 2070 6c74 0d0a 696d 706f 7274 2063  as plt..import c
+0005c590: 6f70 790d 0a69 6d70 6f72 7420 7064 620d  opy..import pdb.
+0005c5a0: 0a64 6566 2070 7269 6e74 5f63 6c61 7373  .def print_class
+0005c5b0: 6966 6963 6174 696f 6e5f 6d65 7472 6963  ification_metric
+0005c5c0: 7328 795f 7465 7374 2c20 795f 7072 6f62  s(y_test, y_prob
+0005c5d0: 732c 2070 726f 6261 5f66 6c61 673d 5472  s, proba_flag=Tr
+0005c5e0: 7565 293a 0d0a 2020 2020 2222 220d 0a20  ue):..    """.. 
+0005c5f0: 2020 2023 2323 2323 2323 2020 5365 6e64     #######  Send
+0005c600: 2069 6e20 7468 6520 6163 7475 616c 5f76   in the actual_v
+0005c610: 616c 7565 7320 616e 6420 7072 6564 6963  alues and predic
+0005c620: 7469 6f6e 5f70 726f 6261 6269 6c69 7469  tion_probabiliti
+0005c630: 6573 2066 6f72 2062 696e 6172 7920 636c  es for binary cl
+0005c640: 6173 7365 730d 0a20 2020 2054 6869 7320  asses..    This 
+0005c650: 7769 6c6c 2072 6574 7572 6e20 6261 636b  will return back
+0005c660: 206d 6574 7269 6373 2061 6e64 2070 7269   metrics and pri
+0005c670: 6e74 2074 6865 6d20 616c 6c20 696e 2061  nt them all in a
+0005c680: 206e 6561 7420 666f 726d 6174 0d0a 2020   neat format..  
+0005c690: 2020 2222 220d 0a20 2020 2079 5f74 6573    """..    y_tes
+0005c6a0: 7420 3d20 636f 7079 2e64 6565 7063 6f70  t = copy.deepcop
+0005c6b0: 7928 795f 7465 7374 290d 0a20 2020 206d  y(y_test)..    m
+0005c6c0: 756c 7469 5f6c 6162 656c 5f66 6c61 6720  ulti_label_flag 
+0005c6d0: 3d20 4661 6c73 650d 0a20 2020 206d 756c  = False..    mul
+0005c6e0: 7469 5f63 6c61 7373 5f66 6c61 6720 3d20  ti_class_flag = 
+0005c6f0: 4661 6c73 650d 0a20 2020 2074 7279 3a0d  False..    try:.
+0005c700: 0a20 2020 2020 2020 2069 6620 795f 7465  .        if y_te
+0005c710: 7374 2e73 6861 7065 5b31 5d20 3e20 303a  st.shape[1] > 0:
+0005c720: 0d0a 2020 2020 2020 2020 2020 2020 6d75  ..            mu
+0005c730: 6c74 695f 6c61 6265 6c5f 666c 6167 203d  lti_label_flag =
+0005c740: 2054 7275 650d 0a20 2020 2065 7863 6570   True..    excep
+0005c750: 743a 0d0a 2020 2020 2020 2020 7061 7373  t:..        pass
+0005c760: 0d0a 2020 2020 2323 2323 2323 2323 2054  ..    ######## T
+0005c770: 6869 7320 6973 2077 6865 7265 2079 6f75  his is where you
+0005c780: 2073 7461 7274 2070 7269 6e74 696e 6720   start printing 
+0005c790: 6d65 7472 6963 7320 2323 2323 2323 2323  metrics ########
+0005c7a0: 2323 2323 2323 230d 0a20 2020 2069 6620  #######..    if 
+0005c7b0: 6c65 6e28 6e70 2e75 6e69 7175 6528 795f  len(np.unique(y_
+0005c7c0: 7465 7374 2929 203e 2032 3a0d 0a20 2020  test)) > 2:..   
+0005c7d0: 2020 2020 206d 756c 7469 5f63 6c61 7373       multi_class
+0005c7e0: 5f66 6c61 6720 3d20 5472 7565 0d0a 2020  _flag = True..  
+0005c7f0: 2020 2020 2020 7072 696e 7428 274d 756c        print('Mul
+0005c800: 7469 2043 6c61 7373 204d 6f64 656c 204d  ti Class Model M
+0005c810: 6574 7269 6373 2052 6570 6f72 7427 290d  etrics Report').
+0005c820: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
+0005c830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005c840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005c850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005c860: 2323 2323 2323 2323 2323 2729 0d0a 2020  ##########')..  
-0005c870: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0005c880: 2070 7269 6e74 2827 4269 6e61 7279 2043   print('Binary C
-0005c890: 6c61 7373 204d 6f64 656c 204d 6574 7269  lass Model Metri
-0005c8a0: 6373 2052 6570 6f72 7427 290d 0a20 2020  cs Report')..   
-0005c8b0: 2020 2020 2070 7269 6e74 2827 2323 2323       print('####
+0005c860: 2323 2323 2327 290d 0a20 2020 2065 6c73  #####')..    els
+0005c870: 653a 0d0a 2020 2020 2020 2020 7072 696e  e:..        prin
+0005c880: 7428 2742 696e 6172 7920 436c 6173 7320  t('Binary Class 
+0005c890: 4d6f 6465 6c20 4d65 7472 6963 7320 5265  Model Metrics Re
+0005c8a0: 706f 7274 2729 0d0a 2020 2020 2020 2020  port')..        
+0005c8b0: 7072 696e 7428 2723 2323 2323 2323 2323  print('#########
 0005c8c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005c8d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005c8e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005c8f0: 2327 290d 0a20 2020 2023 2323 2320 666f  #')..    #### fo
-0005c900: 7220 736f 6d65 2063 6173 6573 2c20 796f  r some cases, yo
-0005c910: 7520 776f 6e27 7420 6765 7420 7072 6f62  u won't get prob
-0005c920: 612c 2073 6f20 6368 6563 6b20 7468 6520  a, so check the 
-0005c930: 7072 6f62 615f 666c 6167 0d0a 2020 2020  proba_flag..    
-0005c940: 6966 2070 726f 6261 5f66 6c61 673a 0d0a  if proba_flag:..
-0005c950: 2020 2020 2020 2020 6966 206d 756c 7469          if multi
-0005c960: 5f6c 6162 656c 5f66 6c61 673a 0d0a 2020  _label_flag:..  
-0005c970: 2020 2020 2020 2020 2020 795f 7072 6564            y_pred
-0005c980: 7320 3d20 2879 5f70 726f 6273 3e30 2e35  s = (y_probs>0.5
-0005c990: 292e 6173 7479 7065 2869 6e74 290d 0a20  ).astype(int).. 
-0005c9a0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0005c9b0: 2020 2020 2020 2020 2020 795f 7072 6564            y_pred
-0005c9c0: 7320 3d20 795f 7072 6f62 732e 6172 676d  s = y_probs.argm
-0005c9d0: 6178 2861 7869 733d 3129 0d0a 2020 2020  ax(axis=1)..    
-0005c9e0: 656c 7365 3a0d 0a20 2020 2020 2020 2079  else:..        y
-0005c9f0: 5f70 7265 6473 203d 2063 6f70 792e 6465  _preds = copy.de
-0005ca00: 6570 636f 7079 2879 5f70 726f 6273 290d  epcopy(y_probs).
-0005ca10: 0a20 2020 2069 6620 6e6f 7420 6d75 6c74  .    if not mult
-0005ca20: 695f 636c 6173 735f 666c 6167 2020 616e  i_class_flag  an
-0005ca30: 6420 6e6f 7420 6d75 6c74 695f 6c61 6265  d not multi_labe
-0005ca40: 6c5f 666c 6167 3a0d 0a20 2020 2020 2020  l_flag:..       
-0005ca50: 2023 2043 616c 6375 6c61 7465 2063 6f6d   # Calculate com
-0005ca60: 7061 7269 736f 6e20 6d65 7472 6963 7320  parison metrics 
-0005ca70: 666f 7220 4269 6e61 7279 2063 6c61 7373  for Binary class
-0005ca80: 6966 6963 6174 696f 6e20 7265 7375 6c74  ification result
-0005ca90: 732e 0d0a 2020 2020 2020 2020 6163 6375  s...        accu
-0005caa0: 7261 6379 203d 206d 6574 7269 6373 2e61  racy = metrics.a
-0005cab0: 6363 7572 6163 795f 7363 6f72 6528 795f  ccuracy_score(y_
-0005cac0: 7465 7374 2c20 795f 7072 6564 7329 0d0a  test, y_preds)..
-0005cad0: 2020 2020 2020 2020 6261 6c61 6e63 6564          balanced
-0005cae0: 5f61 6363 7572 6163 7920 3d20 6d65 7472  _accuracy = metr
-0005caf0: 6963 732e 6261 6c61 6e63 6564 5f61 6363  ics.balanced_acc
-0005cb00: 7572 6163 795f 7363 6f72 6528 795f 7465  uracy_score(y_te
-0005cb10: 7374 2c20 795f 7072 6564 7329 0d0a 2020  st, y_preds)..  
-0005cb20: 2020 2020 2020 7072 6563 6973 696f 6e20        precision 
-0005cb30: 3d20 6d65 7472 6963 732e 7072 6563 6973  = metrics.precis
-0005cb40: 696f 6e5f 7363 6f72 6528 795f 7465 7374  ion_score(y_test
-0005cb50: 2c20 795f 7072 6564 7329 0d0a 2020 2020  , y_preds)..    
-0005cb60: 2020 2020 6631 5f73 636f 7265 203d 206d      f1_score = m
-0005cb70: 6574 7269 6373 2e66 315f 7363 6f72 6528  etrics.f1_score(
-0005cb80: 795f 7465 7374 2c20 795f 7072 6564 7329  y_test, y_preds)
-0005cb90: 0d0a 2020 2020 2020 2020 7265 6361 6c6c  ..        recall
-0005cba0: 203d 206d 6574 7269 6373 2e72 6563 616c   = metrics.recal
-0005cbb0: 6c5f 7363 6f72 6528 795f 7465 7374 2c20  l_score(y_test, 
-0005cbc0: 795f 7072 6564 7329 0d0a 2020 2020 2020  y_preds)..      
-0005cbd0: 2020 6966 2074 7970 6528 6e70 2e6d 6561    if type(np.mea
-0005cbe0: 6e28 2879 5f74 6573 743d 3d79 5f70 7265  n((y_test==y_pre
-0005cbf0: 6473 2929 2920 3d3d 2070 642e 5365 7269  ds))) == pd.Seri
-0005cc00: 6573 3a0d 0a20 2020 2020 2020 2020 2020  es:..           
-0005cc10: 2070 7269 6e74 2827 2020 2020 4163 6375   print('    Accu
-0005cc20: 7261 6379 2020 2020 2020 2020 2020 3d20  racy          = 
-0005cc30: 2530 2e31 6625 2527 2025 286e 702e 6d65  %0.1f%%' %(np.me
-0005cc40: 616e 2861 6363 7572 6163 7929 2a31 3030  an(accuracy)*100
-0005cc50: 2929 0d0a 2020 2020 2020 2020 656c 7365  ))..        else
-0005cc60: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-0005cc70: 7269 6e74 2827 2020 2020 4163 6375 7261  rint('    Accura
-0005cc80: 6379 2020 2020 2020 2020 2020 3d20 2530  cy          = %0
-0005cc90: 2e31 6625 2527 2025 2861 6363 7572 6163  .1f%%' %(accurac
-0005cca0: 792a 3130 3029 290d 0a20 2020 2020 2020  y*100))..       
-0005ccb0: 2070 7269 6e74 2827 2020 2020 4261 6c61   print('    Bala
-0005ccc0: 6e63 6564 2041 6363 7572 6163 7920 3d20  nced Accuracy = 
-0005ccd0: 2530 2e31 6625 2527 2025 2862 616c 616e  %0.1f%%' %(balan
-0005cce0: 6365 645f 6163 6375 7261 6379 2a31 3030  ced_accuracy*100
-0005ccf0: 2929 0d0a 2020 2020 2020 2020 7072 696e  ))..        prin
-0005cd00: 7428 2720 2020 2050 7265 6369 7369 6f6e  t('    Precision
-0005cd10: 2020 2020 2020 2020 203d 2025 302e 3166           = %0.1f
-0005cd20: 2525 2720 2528 7072 6563 6973 696f 6e2a  %%' %(precision*
-0005cd30: 3130 3029 290d 0a20 2020 2020 2020 2069  100))..        i
-0005cd40: 6620 7072 6f62 615f 666c 6167 3a0d 0a20  f proba_flag:.. 
-0005cd50: 2020 2020 2020 2020 2020 2061 7665 7261             avera
-0005cd60: 6765 5f70 7265 6369 7369 6f6e 203d 206e  ge_precision = n
-0005cd70: 702e 6d65 616e 286d 6574 7269 6373 2e70  p.mean(metrics.p
-0005cd80: 7265 6369 7369 6f6e 5f73 636f 7265 2879  recision_score(y
-0005cd90: 5f74 6573 742c 2079 5f70 7265 6473 2c20  _test, y_preds, 
-0005cda0: 6176 6572 6167 653d 4e6f 6e65 2929 0d0a  average=None))..
-0005cdb0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0005cdc0: 2020 2020 2020 2020 2020 2061 7665 7261             avera
-0005cdd0: 6765 5f70 7265 6369 7369 6f6e 203d 206d  ge_precision = m
-0005cde0: 6574 7269 6373 2e70 7265 6369 7369 6f6e  etrics.precision
-0005cdf0: 5f73 636f 7265 2879 5f74 6573 742c 2079  _score(y_test, y
-0005ce00: 5f70 7265 6473 2c20 6176 6572 6167 653d  _preds, average=
-0005ce10: 276d 6163 726f 2729 0d0a 2020 2020 2020  'macro')..      
-0005ce20: 2020 7072 696e 7428 2720 2020 2041 7665    print('    Ave
-0005ce30: 7261 6765 2050 7265 6369 7369 6f6e 203d  rage Precision =
-0005ce40: 2025 302e 3166 2525 2720 2528 6176 6572   %0.1f%%' %(aver
-0005ce50: 6167 655f 7072 6563 6973 696f 6e2a 3130  age_precision*10
-0005ce60: 3029 290d 0a20 2020 2020 2020 2070 7269  0))..        pri
-0005ce70: 6e74 2827 2020 2020 5265 6361 6c6c 2020  nt('    Recall  
-0005ce80: 2020 2020 2020 2020 2020 3d20 2530 2e31            = %0.1
-0005ce90: 6625 2527 2025 2872 6563 616c 6c2a 3130  f%%' %(recall*10
-0005cea0: 3029 290d 0a20 2020 2020 2020 2070 7269  0))..        pri
-0005ceb0: 6e74 2827 2020 2020 4631 2053 636f 7265  nt('    F1 Score
-0005cec0: 2020 2020 2020 2020 2020 3d20 2530 2e31            = %0.1
-0005ced0: 6625 2527 2025 2866 315f 7363 6f72 652a  f%%' %(f1_score*
-0005cee0: 3130 3029 290d 0a20 2020 2020 2020 2069  100))..        i
-0005cef0: 6620 7072 6f62 615f 666c 6167 3a0d 0a20  f proba_flag:.. 
-0005cf00: 2020 2020 2020 2020 2020 2066 7072 2c20             fpr, 
-0005cf10: 7470 722c 2074 6872 6573 686f 6c64 203d  tpr, threshold =
-0005cf20: 206d 6574 7269 6373 2e72 6f63 5f63 7572   metrics.roc_cur
-0005cf30: 7665 2879 5f74 6573 742c 2079 5f70 726f  ve(y_test, y_pro
-0005cf40: 6273 5b3a 2c31 5d29 0d0a 2020 2020 2020  bs[:,1])..      
-0005cf50: 2020 2020 2020 726f 635f 6175 6320 3d20        roc_auc = 
-0005cf60: 6d65 7472 6963 732e 6175 6328 6670 722c  metrics.auc(fpr,
-0005cf70: 2074 7072 290d 0a20 2020 2020 2020 2020   tpr)..         
-0005cf80: 2020 2070 7269 6e74 2827 2020 2020 524f     print('    RO
-0005cf90: 4320 4155 4320 2020 2020 2020 2020 2020  C AUC           
-0005cfa0: 3d20 2530 2e31 6625 2527 2025 2872 6f63  = %0.1f%%' %(roc
-0005cfb0: 5f61 7563 2a31 3030 2929 0d0a 2020 2020  _auc*100))..    
-0005cfc0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0005cfd0: 2020 2020 2020 2072 6f63 5f61 7563 203d         roc_auc =
-0005cfe0: 2030 0d0a 2020 2020 2020 2020 7072 696e   0..        prin
-0005cff0: 7428 2723 2323 2323 2323 2323 2323 2323  t('#############
+0005c8e0: 2323 2323 2323 2323 2323 2323 2729 0d0a  ############')..
+0005c8f0: 2020 2020 2323 2323 2066 6f72 2073 6f6d      #### for som
+0005c900: 6520 6361 7365 732c 2079 6f75 2077 6f6e  e cases, you won
+0005c910: 2774 2067 6574 2070 726f 6261 2c20 736f  't get proba, so
+0005c920: 2063 6865 636b 2074 6865 2070 726f 6261   check the proba
+0005c930: 5f66 6c61 670d 0a20 2020 2069 6620 7072  _flag..    if pr
+0005c940: 6f62 615f 666c 6167 3a0d 0a20 2020 2020  oba_flag:..     
+0005c950: 2020 2069 6620 6d75 6c74 695f 6c61 6265     if multi_labe
+0005c960: 6c5f 666c 6167 3a0d 0a20 2020 2020 2020  l_flag:..       
+0005c970: 2020 2020 2079 5f70 7265 6473 203d 2028       y_preds = (
+0005c980: 795f 7072 6f62 733e 302e 3529 2e61 7374  y_probs>0.5).ast
+0005c990: 7970 6528 696e 7429 0d0a 2020 2020 2020  ype(int)..      
+0005c9a0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0005c9b0: 2020 2020 2079 5f70 7265 6473 203d 2079       y_preds = y
+0005c9c0: 5f70 726f 6273 2e61 7267 6d61 7828 6178  _probs.argmax(ax
+0005c9d0: 6973 3d31 290d 0a20 2020 2065 6c73 653a  is=1)..    else:
+0005c9e0: 0d0a 2020 2020 2020 2020 795f 7072 6564  ..        y_pred
+0005c9f0: 7320 3d20 636f 7079 2e64 6565 7063 6f70  s = copy.deepcop
+0005ca00: 7928 795f 7072 6f62 7329 0d0a 2020 2020  y(y_probs)..    
+0005ca10: 6966 206e 6f74 206d 756c 7469 5f63 6c61  if not multi_cla
+0005ca20: 7373 5f66 6c61 6720 2061 6e64 206e 6f74  ss_flag  and not
+0005ca30: 206d 756c 7469 5f6c 6162 656c 5f66 6c61   multi_label_fla
+0005ca40: 673a 0d0a 2020 2020 2020 2020 2320 4361  g:..        # Ca
+0005ca50: 6c63 756c 6174 6520 636f 6d70 6172 6973  lculate comparis
+0005ca60: 6f6e 206d 6574 7269 6373 2066 6f72 2042  on metrics for B
+0005ca70: 696e 6172 7920 636c 6173 7369 6669 6361  inary classifica
+0005ca80: 7469 6f6e 2072 6573 756c 7473 2e0d 0a20  tion results... 
+0005ca90: 2020 2020 2020 2061 6363 7572 6163 7920         accuracy 
+0005caa0: 3d20 6d65 7472 6963 732e 6163 6375 7261  = metrics.accura
+0005cab0: 6379 5f73 636f 7265 2879 5f74 6573 742c  cy_score(y_test,
+0005cac0: 2079 5f70 7265 6473 290d 0a20 2020 2020   y_preds)..     
+0005cad0: 2020 2062 616c 616e 6365 645f 6163 6375     balanced_accu
+0005cae0: 7261 6379 203d 206d 6574 7269 6373 2e62  racy = metrics.b
+0005caf0: 616c 616e 6365 645f 6163 6375 7261 6379  alanced_accuracy
+0005cb00: 5f73 636f 7265 2879 5f74 6573 742c 2079  _score(y_test, y
+0005cb10: 5f70 7265 6473 290d 0a20 2020 2020 2020  _preds)..       
+0005cb20: 2070 7265 6369 7369 6f6e 203d 206d 6574   precision = met
+0005cb30: 7269 6373 2e70 7265 6369 7369 6f6e 5f73  rics.precision_s
+0005cb40: 636f 7265 2879 5f74 6573 742c 2079 5f70  core(y_test, y_p
+0005cb50: 7265 6473 290d 0a20 2020 2020 2020 2066  reds)..        f
+0005cb60: 315f 7363 6f72 6520 3d20 6d65 7472 6963  1_score = metric
+0005cb70: 732e 6631 5f73 636f 7265 2879 5f74 6573  s.f1_score(y_tes
+0005cb80: 742c 2079 5f70 7265 6473 290d 0a20 2020  t, y_preds)..   
+0005cb90: 2020 2020 2072 6563 616c 6c20 3d20 6d65       recall = me
+0005cba0: 7472 6963 732e 7265 6361 6c6c 5f73 636f  trics.recall_sco
+0005cbb0: 7265 2879 5f74 6573 742c 2079 5f70 7265  re(y_test, y_pre
+0005cbc0: 6473 290d 0a20 2020 2020 2020 2069 6620  ds)..        if 
+0005cbd0: 7479 7065 286e 702e 6d65 616e 2828 795f  type(np.mean((y_
+0005cbe0: 7465 7374 3d3d 795f 7072 6564 7329 2929  test==y_preds)))
+0005cbf0: 203d 3d20 7064 2e53 6572 6965 733a 0d0a   == pd.Series:..
+0005cc00: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+0005cc10: 7428 2720 2020 2041 6363 7572 6163 7920  t('    Accuracy 
+0005cc20: 2020 2020 2020 2020 203d 2025 302e 3166           = %0.1f
+0005cc30: 2525 2720 2528 6e70 2e6d 6561 6e28 6163  %%' %(np.mean(ac
+0005cc40: 6375 7261 6379 292a 3130 3029 290d 0a20  curacy)*100)).. 
+0005cc50: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0005cc60: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0005cc70: 2720 2020 2041 6363 7572 6163 7920 2020  '    Accuracy   
+0005cc80: 2020 2020 2020 203d 2025 302e 3166 2525         = %0.1f%%
+0005cc90: 2720 2528 6163 6375 7261 6379 2a31 3030  ' %(accuracy*100
+0005cca0: 2929 0d0a 2020 2020 2020 2020 7072 696e  ))..        prin
+0005ccb0: 7428 2720 2020 2042 616c 616e 6365 6420  t('    Balanced 
+0005ccc0: 4163 6375 7261 6379 203d 2025 302e 3166  Accuracy = %0.1f
+0005ccd0: 2525 2720 2528 6261 6c61 6e63 6564 5f61  %%' %(balanced_a
+0005cce0: 6363 7572 6163 792a 3130 3029 290d 0a20  ccuracy*100)).. 
+0005ccf0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+0005cd00: 2020 5072 6563 6973 696f 6e20 2020 2020    Precision     
+0005cd10: 2020 2020 3d20 2530 2e31 6625 2527 2025      = %0.1f%%' %
+0005cd20: 2870 7265 6369 7369 6f6e 2a31 3030 2929  (precision*100))
+0005cd30: 0d0a 2020 2020 2020 2020 6966 2070 726f  ..        if pro
+0005cd40: 6261 5f66 6c61 673a 0d0a 2020 2020 2020  ba_flag:..      
+0005cd50: 2020 2020 2020 6176 6572 6167 655f 7072        average_pr
+0005cd60: 6563 6973 696f 6e20 3d20 6e70 2e6d 6561  ecision = np.mea
+0005cd70: 6e28 6d65 7472 6963 732e 7072 6563 6973  n(metrics.precis
+0005cd80: 696f 6e5f 7363 6f72 6528 795f 7465 7374  ion_score(y_test
+0005cd90: 2c20 795f 7072 6564 732c 2061 7665 7261  , y_preds, avera
+0005cda0: 6765 3d4e 6f6e 6529 290d 0a20 2020 2020  ge=None))..     
+0005cdb0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0005cdc0: 2020 2020 2020 6176 6572 6167 655f 7072        average_pr
+0005cdd0: 6563 6973 696f 6e20 3d20 6d65 7472 6963  ecision = metric
+0005cde0: 732e 7072 6563 6973 696f 6e5f 7363 6f72  s.precision_scor
+0005cdf0: 6528 795f 7465 7374 2c20 795f 7072 6564  e(y_test, y_pred
+0005ce00: 732c 2061 7665 7261 6765 3d27 6d61 6372  s, average='macr
+0005ce10: 6f27 290d 0a20 2020 2020 2020 2070 7269  o')..        pri
+0005ce20: 6e74 2827 2020 2020 4176 6572 6167 6520  nt('    Average 
+0005ce30: 5072 6563 6973 696f 6e20 3d20 2530 2e31  Precision = %0.1
+0005ce40: 6625 2527 2025 2861 7665 7261 6765 5f70  f%%' %(average_p
+0005ce50: 7265 6369 7369 6f6e 2a31 3030 2929 0d0a  recision*100))..
+0005ce60: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+0005ce70: 2020 2052 6563 616c 6c20 2020 2020 2020     Recall       
+0005ce80: 2020 2020 203d 2025 302e 3166 2525 2720       = %0.1f%%' 
+0005ce90: 2528 7265 6361 6c6c 2a31 3030 2929 0d0a  %(recall*100))..
+0005cea0: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+0005ceb0: 2020 2046 3120 5363 6f72 6520 2020 2020     F1 Score     
+0005cec0: 2020 2020 203d 2025 302e 3166 2525 2720       = %0.1f%%' 
+0005ced0: 2528 6631 5f73 636f 7265 2a31 3030 2929  %(f1_score*100))
+0005cee0: 0d0a 2020 2020 2020 2020 6966 2070 726f  ..        if pro
+0005cef0: 6261 5f66 6c61 673a 0d0a 2020 2020 2020  ba_flag:..      
+0005cf00: 2020 2020 2020 6670 722c 2074 7072 2c20        fpr, tpr, 
+0005cf10: 7468 7265 7368 6f6c 6420 3d20 6d65 7472  threshold = metr
+0005cf20: 6963 732e 726f 635f 6375 7276 6528 795f  ics.roc_curve(y_
+0005cf30: 7465 7374 2c20 795f 7072 6f62 735b 3a2c  test, y_probs[:,
+0005cf40: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
+0005cf50: 2072 6f63 5f61 7563 203d 206d 6574 7269   roc_auc = metri
+0005cf60: 6373 2e61 7563 2866 7072 2c20 7470 7229  cs.auc(fpr, tpr)
+0005cf70: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+0005cf80: 696e 7428 2720 2020 2052 4f43 2041 5543  int('    ROC AUC
+0005cf90: 2020 2020 2020 2020 2020 203d 2025 302e             = %0.
+0005cfa0: 3166 2525 2720 2528 726f 635f 6175 632a  1f%%' %(roc_auc*
+0005cfb0: 3130 3029 290d 0a20 2020 2020 2020 2065  100))..        e
+0005cfc0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0005cfd0: 2020 726f 635f 6175 6320 3d20 300d 0a20    roc_auc = 0.. 
+0005cfe0: 2020 2020 2020 2070 7269 6e74 2827 2323         print('##
+0005cff0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005d000: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005d010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005d020: 2323 2323 2323 2323 2729 0d0a 2020 2020  ########')..    
-0005d030: 2020 2020 7265 7475 726e 205b 6163 6375      return [accu
-0005d040: 7261 6379 2c20 6261 6c61 6e63 6564 5f61  racy, balanced_a
-0005d050: 6363 7572 6163 792c 2070 7265 6369 7369  ccuracy, precisi
-0005d060: 6f6e 2c20 6176 6572 6167 655f 7072 6563  on, average_prec
-0005d070: 6973 696f 6e2c 2066 315f 7363 6f72 652c  ision, f1_score,
-0005d080: 2072 6563 616c 6c2c 2072 6f63 5f61 7563   recall, roc_auc
-0005d090: 5d0d 0a20 2020 2065 6c73 653a 0d0a 2020  ]..    else:..  
-0005d0a0: 2020 2020 2020 2320 4361 6c63 756c 6174        # Calculat
-0005d0b0: 6520 636f 6d70 6172 6973 6f6e 206d 6574  e comparison met
-0005d0c0: 7269 6373 2066 6f72 204d 756c 7469 2d43  rics for Multi-C
-0005d0d0: 6c61 7373 2063 6c61 7373 6966 6963 6174  lass classificat
-0005d0e0: 696f 6e20 7265 7375 6c74 732e 0d0a 2020  ion results...  
-0005d0f0: 2020 2020 2020 6163 6375 7261 6379 203d        accuracy =
-0005d100: 206e 702e 6d65 616e 2828 795f 7465 7374   np.mean((y_test
-0005d110: 3d3d 795f 7072 6564 7329 290d 0a20 2020  ==y_preds))..   
-0005d120: 2020 2020 2069 6620 6d75 6c74 695f 6c61       if multi_la
-0005d130: 6265 6c5f 666c 6167 3a0d 0a20 2020 2020  bel_flag:..     
-0005d140: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-0005d150: 7261 6e67 6528 795f 7465 7374 2e73 6861  range(y_test.sha
-0005d160: 7065 5b31 5d29 3a0d 0a20 2020 2020 2020  pe[1]):..       
-0005d170: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-0005d180: 466f 7220 7461 7267 6574 206c 6162 656c  For target label
-0005d190: 3a20 2573 2720 2569 290d 0a20 2020 2020  : %s' %i)..     
-0005d1a0: 2020 2020 2020 2020 2020 2062 616c 616e             balan
-0005d1b0: 6365 645f 6163 6375 7261 6379 203d 206e  ced_accuracy = n
-0005d1c0: 702e 6d65 616e 286d 6574 7269 6373 2e72  p.mean(metrics.r
-0005d1d0: 6563 616c 6c5f 7363 6f72 6528 795f 7465  ecall_score(y_te
-0005d1e0: 7374 5b3a 2c69 5d2c 2079 5f70 7265 6473  st[:,i], y_preds
-0005d1f0: 5b3a 2c69 5d2c 2061 7665 7261 6765 3d4e  [:,i], average=N
-0005d200: 6f6e 6529 290d 0a20 2020 2020 2020 2020  one))..         
-0005d210: 2020 2020 2020 2070 7265 6369 7369 6f6e         precision
-0005d220: 203d 206d 6574 7269 6373 2e70 7265 6369   = metrics.preci
-0005d230: 7369 6f6e 5f73 636f 7265 2879 5f74 6573  sion_score(y_tes
-0005d240: 745b 3a2c 695d 2c20 795f 7072 6564 735b  t[:,i], y_preds[
-0005d250: 3a2c 695d 2c20 6176 6572 6167 653d 4e6f  :,i], average=No
-0005d260: 6e65 290d 0a20 2020 2020 2020 2020 2020  ne)..           
-0005d270: 2020 2020 2061 7665 7261 6765 5f70 7265       average_pre
-0005d280: 6369 7369 6f6e 203d 206d 6574 7269 6373  cision = metrics
-0005d290: 2e70 7265 6369 7369 6f6e 5f73 636f 7265  .precision_score
-0005d2a0: 2879 5f74 6573 745b 3a2c 695d 2c20 795f  (y_test[:,i], y_
-0005d2b0: 7072 6564 735b 3a2c 695d 2c20 6176 6572  preds[:,i], aver
-0005d2c0: 6167 653d 276d 6163 726f 2729 0d0a 2020  age='macro')..  
-0005d2d0: 2020 2020 2020 2020 2020 2020 2020 6631                f1
-0005d2e0: 5f73 636f 7265 203d 206d 6574 7269 6373  _score = metrics
-0005d2f0: 2e66 315f 7363 6f72 6528 795f 7465 7374  .f1_score(y_test
-0005d300: 5b3a 2c69 5d2c 2079 5f70 7265 6473 5b3a  [:,i], y_preds[:
-0005d310: 2c69 5d2c 2061 7665 7261 6765 3d4e 6f6e  ,i], average=Non
-0005d320: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-0005d330: 2020 2020 7265 6361 6c6c 203d 206d 6574      recall = met
-0005d340: 7269 6373 2e72 6563 616c 6c5f 7363 6f72  rics.recall_scor
-0005d350: 6528 795f 7465 7374 5b3a 2c69 5d2c 2079  e(y_test[:,i], y
-0005d360: 5f70 7265 6473 5b3a 2c69 5d2c 2061 7665  _preds[:,i], ave
-0005d370: 7261 6765 3d4e 6f6e 6529 0d0a 2020 2020  rage=None)..    
-0005d380: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0005d390: 7428 2720 2020 2042 616c 616e 6365 6420  t('    Balanced 
-0005d3a0: 4163 6375 7261 6379 2028 6176 6572 6167  Accuracy (averag
-0005d3b0: 6520 7265 6361 6c6c 2920 3d20 2530 2e31  e recall) = %0.1
-0005d3c0: 6625 2527 2025 2862 616c 616e 6365 645f  f%%' %(balanced_
-0005d3d0: 6163 6375 7261 6379 2a31 3030 2929 0d0a  accuracy*100))..
-0005d3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005d3f0: 7072 696e 7428 2720 2020 2041 7665 7261  print('    Avera
-0005d400: 6765 2050 7265 6369 7369 6f6e 2028 6d61  ge Precision (ma
-0005d410: 6372 6f29 203d 2025 302e 3166 2525 2720  cro) = %0.1f%%' 
-0005d420: 2528 6176 6572 6167 655f 7072 6563 6973  %(average_precis
-0005d430: 696f 6e2a 3130 3029 290d 0a20 2020 2020  ion*100))..     
-0005d440: 2020 2020 2020 2020 2020 2023 2323 2074             ### t
-0005d450: 6865 7365 2061 7265 2062 6173 6963 616c  hese are basical
-0005d460: 6c79 206f 6e65 2066 6f72 2065 6163 6820  ly one for each 
-0005d470: 636c 6173 7320 2323 2323 230d 0a20 2020  class #####..   
-0005d480: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-0005d490: 6e74 2827 2020 2020 5072 6563 6973 696f  nt('    Precisio
-0005d4a0: 6e73 2062 7920 636c 6173 733a 2729 0d0a  ns by class:')..
-0005d4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005d4c0: 666f 7220 7072 6563 6973 696f 6e73 2069  for precisions i
-0005d4d0: 6e20 7072 6563 6973 696f 6e3a 0d0a 2020  n precision:..  
-0005d4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005d4f0: 2020 7072 696e 7428 2720 2020 2025 302e    print('    %0.
-0005d500: 3166 2525 2020 2720 2528 7072 6563 6973  1f%%  ' %(precis
-0005d510: 696f 6e73 2a31 3030 292c 656e 643d 2222  ions*100),end=""
-0005d520: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0005d530: 2020 2070 7269 6e74 2827 5c6e 2020 2020     print('\n    
-0005d540: 5265 6361 6c6c 2053 636f 7265 7320 6279  Recall Scores by
-0005d550: 2063 6c61 7373 3a27 290d 0a20 2020 2020   class:')..     
-0005d560: 2020 2020 2020 2020 2020 2066 6f72 2072             for r
-0005d570: 6563 616c 6c73 2069 6e20 7265 6361 6c6c  ecalls in recall
-0005d580: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0005d590: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-0005d5a0: 2020 2530 2e31 6625 2520 2027 2025 2872    %0.1f%%  ' %(r
-0005d5b0: 6563 616c 6c73 2a31 3030 292c 2065 6e64  ecalls*100), end
-0005d5c0: 3d22 2229 0d0a 2020 2020 2020 2020 2020  ="")..          
-0005d5d0: 2020 2020 2020 7072 696e 7428 275c 6e20        print('\n 
-0005d5e0: 2020 2046 3120 5363 6f72 6573 2062 7920     F1 Scores by 
-0005d5f0: 636c 6173 733a 2729 0d0a 2020 2020 2020  class:')..      
-0005d600: 2020 2020 2020 2020 2020 666f 7220 6631            for f1
-0005d610: 5f73 636f 7265 7320 696e 2066 315f 7363  _scores in f1_sc
-0005d620: 6f72 653a 0d0a 2020 2020 2020 2020 2020  ore:..          
-0005d630: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0005d640: 2720 2020 2025 302e 3166 2525 2020 2720  '    %0.1f%%  ' 
-0005d650: 2528 6631 5f73 636f 7265 732a 3130 3029  %(f1_scores*100)
-0005d660: 2c65 6e64 3d22 2229 0d0a 2020 2020 2020  ,end="")..      
-0005d670: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0005d680: 275c 6e23 2323 2323 2323 2323 2323 2323  '\n#############
+0005d020: 2323 2327 290d 0a20 2020 2020 2020 2072  ###')..        r
+0005d030: 6574 7572 6e20 5b61 6363 7572 6163 792c  eturn [accuracy,
+0005d040: 2062 616c 616e 6365 645f 6163 6375 7261   balanced_accura
+0005d050: 6379 2c20 7072 6563 6973 696f 6e2c 2061  cy, precision, a
+0005d060: 7665 7261 6765 5f70 7265 6369 7369 6f6e  verage_precision
+0005d070: 2c20 6631 5f73 636f 7265 2c20 7265 6361  , f1_score, reca
+0005d080: 6c6c 2c20 726f 635f 6175 635d 0d0a 2020  ll, roc_auc]..  
+0005d090: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0005d0a0: 2023 2043 616c 6375 6c61 7465 2063 6f6d   # Calculate com
+0005d0b0: 7061 7269 736f 6e20 6d65 7472 6963 7320  parison metrics 
+0005d0c0: 666f 7220 4d75 6c74 692d 436c 6173 7320  for Multi-Class 
+0005d0d0: 636c 6173 7369 6669 6361 7469 6f6e 2072  classification r
+0005d0e0: 6573 756c 7473 2e0d 0a20 2020 2020 2020  esults...       
+0005d0f0: 2061 6363 7572 6163 7920 3d20 6e70 2e6d   accuracy = np.m
+0005d100: 6561 6e28 2879 5f74 6573 743d 3d79 5f70  ean((y_test==y_p
+0005d110: 7265 6473 2929 0d0a 2020 2020 2020 2020  reds))..        
+0005d120: 6966 206d 756c 7469 5f6c 6162 656c 5f66  if multi_label_f
+0005d130: 6c61 673a 0d0a 2020 2020 2020 2020 2020  lag:..          
+0005d140: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+0005d150: 2879 5f74 6573 742e 7368 6170 655b 315d  (y_test.shape[1]
+0005d160: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0005d170: 2020 2020 7072 696e 7428 2746 6f72 2074      print('For t
+0005d180: 6172 6765 7420 6c61 6265 6c3a 2025 7327  arget label: %s'
+0005d190: 2025 6929 0d0a 2020 2020 2020 2020 2020   %i)..          
+0005d1a0: 2020 2020 2020 6261 6c61 6e63 6564 5f61        balanced_a
+0005d1b0: 6363 7572 6163 7920 3d20 6e70 2e6d 6561  ccuracy = np.mea
+0005d1c0: 6e28 6d65 7472 6963 732e 7265 6361 6c6c  n(metrics.recall
+0005d1d0: 5f73 636f 7265 2879 5f74 6573 745b 3a2c  _score(y_test[:,
+0005d1e0: 695d 2c20 795f 7072 6564 735b 3a2c 695d  i], y_preds[:,i]
+0005d1f0: 2c20 6176 6572 6167 653d 4e6f 6e65 2929  , average=None))
+0005d200: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0005d210: 2020 7072 6563 6973 696f 6e20 3d20 6d65    precision = me
+0005d220: 7472 6963 732e 7072 6563 6973 696f 6e5f  trics.precision_
+0005d230: 7363 6f72 6528 795f 7465 7374 5b3a 2c69  score(y_test[:,i
+0005d240: 5d2c 2079 5f70 7265 6473 5b3a 2c69 5d2c  ], y_preds[:,i],
+0005d250: 2061 7665 7261 6765 3d4e 6f6e 6529 0d0a   average=None)..
+0005d260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005d270: 6176 6572 6167 655f 7072 6563 6973 696f  average_precisio
+0005d280: 6e20 3d20 6d65 7472 6963 732e 7072 6563  n = metrics.prec
+0005d290: 6973 696f 6e5f 7363 6f72 6528 795f 7465  ision_score(y_te
+0005d2a0: 7374 5b3a 2c69 5d2c 2079 5f70 7265 6473  st[:,i], y_preds
+0005d2b0: 5b3a 2c69 5d2c 2061 7665 7261 6765 3d27  [:,i], average='
+0005d2c0: 6d61 6372 6f27 290d 0a20 2020 2020 2020  macro')..       
+0005d2d0: 2020 2020 2020 2020 2066 315f 7363 6f72           f1_scor
+0005d2e0: 6520 3d20 6d65 7472 6963 732e 6631 5f73  e = metrics.f1_s
+0005d2f0: 636f 7265 2879 5f74 6573 745b 3a2c 695d  core(y_test[:,i]
+0005d300: 2c20 795f 7072 6564 735b 3a2c 695d 2c20  , y_preds[:,i], 
+0005d310: 6176 6572 6167 653d 4e6f 6e65 290d 0a20  average=None).. 
+0005d320: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0005d330: 6563 616c 6c20 3d20 6d65 7472 6963 732e  ecall = metrics.
+0005d340: 7265 6361 6c6c 5f73 636f 7265 2879 5f74  recall_score(y_t
+0005d350: 6573 745b 3a2c 695d 2c20 795f 7072 6564  est[:,i], y_pred
+0005d360: 735b 3a2c 695d 2c20 6176 6572 6167 653d  s[:,i], average=
+0005d370: 4e6f 6e65 290d 0a20 2020 2020 2020 2020  None)..         
+0005d380: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+0005d390: 2020 4261 6c61 6e63 6564 2041 6363 7572    Balanced Accur
+0005d3a0: 6163 7920 2861 7665 7261 6765 2072 6563  acy (average rec
+0005d3b0: 616c 6c29 203d 2025 302e 3166 2525 2720  all) = %0.1f%%' 
+0005d3c0: 2528 6261 6c61 6e63 6564 5f61 6363 7572  %(balanced_accur
+0005d3d0: 6163 792a 3130 3029 290d 0a20 2020 2020  acy*100))..     
+0005d3e0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0005d3f0: 2827 2020 2020 4176 6572 6167 6520 5072  ('    Average Pr
+0005d400: 6563 6973 696f 6e20 286d 6163 726f 2920  ecision (macro) 
+0005d410: 3d20 2530 2e31 6625 2527 2025 2861 7665  = %0.1f%%' %(ave
+0005d420: 7261 6765 5f70 7265 6369 7369 6f6e 2a31  rage_precision*1
+0005d430: 3030 2929 0d0a 2020 2020 2020 2020 2020  00))..          
+0005d440: 2020 2020 2020 2323 2320 7468 6573 6520        ### these 
+0005d450: 6172 6520 6261 7369 6361 6c6c 7920 6f6e  are basically on
+0005d460: 6520 666f 7220 6561 6368 2063 6c61 7373  e for each class
+0005d470: 2023 2323 2323 0d0a 2020 2020 2020 2020   #####..        
+0005d480: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+0005d490: 2020 2050 7265 6369 7369 6f6e 7320 6279     Precisions by
+0005d4a0: 2063 6c61 7373 3a27 290d 0a20 2020 2020   class:')..     
+0005d4b0: 2020 2020 2020 2020 2020 2066 6f72 2070             for p
+0005d4c0: 7265 6369 7369 6f6e 7320 696e 2070 7265  recisions in pre
+0005d4d0: 6369 7369 6f6e 3a0d 0a20 2020 2020 2020  cision:..       
+0005d4e0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
+0005d4f0: 6e74 2827 2020 2020 2530 2e31 6625 2520  nt('    %0.1f%% 
+0005d500: 2027 2025 2870 7265 6369 7369 6f6e 732a   ' %(precisions*
+0005d510: 3130 3029 2c65 6e64 3d22 2229 0d0a 2020  100),end="")..  
+0005d520: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+0005d530: 696e 7428 275c 6e20 2020 2052 6563 616c  int('\n    Recal
+0005d540: 6c20 5363 6f72 6573 2062 7920 636c 6173  l Scores by clas
+0005d550: 733a 2729 0d0a 2020 2020 2020 2020 2020  s:')..          
+0005d560: 2020 2020 2020 666f 7220 7265 6361 6c6c        for recall
+0005d570: 7320 696e 2072 6563 616c 6c3a 0d0a 2020  s in recall:..  
+0005d580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005d590: 2020 7072 696e 7428 2720 2020 2025 302e    print('    %0.
+0005d5a0: 3166 2525 2020 2720 2528 7265 6361 6c6c  1f%%  ' %(recall
+0005d5b0: 732a 3130 3029 2c20 656e 643d 2222 290d  s*100), end="").
+0005d5c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0005d5d0: 2070 7269 6e74 2827 5c6e 2020 2020 4631   print('\n    F1
+0005d5e0: 2053 636f 7265 7320 6279 2063 6c61 7373   Scores by class
+0005d5f0: 3a27 290d 0a20 2020 2020 2020 2020 2020  :')..           
+0005d600: 2020 2020 2066 6f72 2066 315f 7363 6f72       for f1_scor
+0005d610: 6573 2069 6e20 6631 5f73 636f 7265 3a0d  es in f1_score:.
+0005d620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0005d630: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+0005d640: 2530 2e31 6625 2520 2027 2025 2866 315f  %0.1f%%  ' %(f1_
+0005d650: 7363 6f72 6573 2a31 3030 292c 656e 643d  scores*100),end=
+0005d660: 2222 290d 0a20 2020 2020 2020 2020 2020  "")..           
+0005d670: 2020 2020 2070 7269 6e74 2827 5c6e 2323       print('\n##
+0005d680: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005d690: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005d6a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005d6b0: 2323 2323 2323 2323 2729 0d0a 2020 2020  ########')..    
-0005d6c0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0005d6d0: 2020 2020 2020 2062 616c 616e 6365 645f         balanced_
-0005d6e0: 6163 6375 7261 6379 203d 206d 6574 7269  accuracy = metri
-0005d6f0: 6373 2e62 616c 616e 6365 645f 6163 6375  cs.balanced_accu
-0005d700: 7261 6379 5f73 636f 7265 2879 5f74 6573  racy_score(y_tes
-0005d710: 742c 2079 5f70 7265 6473 290d 0a20 2020  t, y_preds)..   
-0005d720: 2020 2020 2020 2020 2070 7265 6369 7369           precisi
-0005d730: 6f6e 203d 206d 6574 7269 6373 2e70 7265  on = metrics.pre
-0005d740: 6369 7369 6f6e 5f73 636f 7265 2879 5f74  cision_score(y_t
-0005d750: 6573 742c 2079 5f70 7265 6473 2c20 6176  est, y_preds, av
-0005d760: 6572 6167 6520 3d20 4e6f 6e65 290d 0a20  erage = None).. 
-0005d770: 2020 2020 2020 2020 2020 2061 7665 7261             avera
-0005d780: 6765 5f70 7265 6369 7369 6f6e 203d 206d  ge_precision = m
-0005d790: 6574 7269 6373 2e70 7265 6369 7369 6f6e  etrics.precision
-0005d7a0: 5f73 636f 7265 2879 5f74 6573 742c 2079  _score(y_test, y
-0005d7b0: 5f70 7265 6473 2c61 7665 7261 6765 3d27  _preds,average='
-0005d7c0: 6d61 6372 6f27 290d 0a20 2020 2020 2020  macro')..       
-0005d7d0: 2020 2020 2066 315f 7363 6f72 6520 3d20       f1_score = 
-0005d7e0: 6d65 7472 6963 732e 6631 5f73 636f 7265  metrics.f1_score
-0005d7f0: 2879 5f74 6573 742c 2079 5f70 7265 6473  (y_test, y_preds
-0005d800: 2c20 6176 6572 6167 6520 3d20 4e6f 6e65  , average = None
-0005d810: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
-0005d820: 6563 616c 6c20 3d20 6d65 7472 6963 732e  ecall = metrics.
-0005d830: 7265 6361 6c6c 5f73 636f 7265 2879 5f74  recall_score(y_t
-0005d840: 6573 742c 2079 5f70 7265 6473 2c20 6176  est, y_preds, av
-0005d850: 6572 6167 6520 3d20 4e6f 6e65 290d 0a20  erage = None).. 
-0005d860: 2020 2020 2020 2020 2020 2069 6620 7479             if ty
-0005d870: 7065 286e 702e 6d65 616e 2828 795f 7465  pe(np.mean((y_te
-0005d880: 7374 3d3d 795f 7072 6564 7329 2929 203d  st==y_preds))) =
-0005d890: 3d20 7064 2e53 6572 6965 733a 0d0a 2020  = pd.Series:..  
-0005d8a0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0005d8b0: 696e 7428 2720 2020 2041 6363 7572 6163  int('    Accurac
-0005d8c0: 7920 2020 2020 2020 2020 203d 2025 302e  y          = %0.
-0005d8d0: 3166 2525 2720 2528 6e70 2e6d 6561 6e28  1f%%' %(np.mean(
-0005d8e0: 6163 6375 7261 6379 292a 3130 3029 290d  accuracy)*100)).
-0005d8f0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0005d900: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0005d910: 2020 2020 7072 696e 7428 2720 2020 2041      print('    A
-0005d920: 6363 7572 6163 7920 2020 2020 2020 2020  ccuracy         
-0005d930: 203d 2025 302e 3166 2525 2720 2528 6163   = %0.1f%%' %(ac
-0005d940: 6375 7261 6379 2a31 3030 2929 0d0a 2020  curacy*100))..  
-0005d950: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0005d960: 2720 2020 2042 616c 616e 6365 6420 4163  '    Balanced Ac
-0005d970: 6375 7261 6379 2028 6176 6572 6167 6520  curacy (average 
-0005d980: 7265 6361 6c6c 2920 3d20 2530 2e31 6625  recall) = %0.1f%
-0005d990: 2527 2025 2862 616c 616e 6365 645f 6163  %' %(balanced_ac
-0005d9a0: 6375 7261 6379 2a31 3030 2929 0d0a 2020  curacy*100))..  
-0005d9b0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-0005d9c0: 2720 2020 2041 7665 7261 6765 2050 7265  '    Average Pre
-0005d9d0: 6369 7369 6f6e 2028 6d61 6372 6f29 203d  cision (macro) =
-0005d9e0: 2025 302e 3166 2525 2720 2528 6176 6572   %0.1f%%' %(aver
-0005d9f0: 6167 655f 7072 6563 6973 696f 6e2a 3130  age_precision*10
-0005da00: 3029 290d 0a20 2020 2020 2020 2020 2020  0))..           
-0005da10: 2023 2323 2074 6865 7365 2061 7265 2062   ### these are b
-0005da20: 6173 6963 616c 6c79 206f 6e65 2066 6f72  asically one for
-0005da30: 2065 6163 6820 636c 6173 7320 2323 2323   each class ####
-0005da40: 230d 0a20 2020 2020 2020 2020 2020 2070  #..            p
-0005da50: 7269 6e74 2827 2020 2020 5072 6563 6973  rint('    Precis
-0005da60: 696f 6e73 2062 7920 636c 6173 733a 2729  ions by class:')
-0005da70: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-0005da80: 7220 7072 6563 6973 696f 6e73 2069 6e20  r precisions in 
-0005da90: 7072 6563 6973 696f 6e3a 0d0a 2020 2020  precision:..    
-0005daa0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0005dab0: 7428 2720 2020 2025 302e 3166 2525 2020  t('    %0.1f%%  
-0005dac0: 2720 2528 7072 6563 6973 696f 6e73 2a31  ' %(precisions*1
-0005dad0: 3030 292c 656e 643d 2222 290d 0a20 2020  00),end="")..   
-0005dae0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-0005daf0: 5c6e 2020 2020 5265 6361 6c6c 2053 636f  \n    Recall Sco
-0005db00: 7265 7320 6279 2063 6c61 7373 3a27 290d  res by class:').
-0005db10: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-0005db20: 2072 6563 616c 6c73 2069 6e20 7265 6361   recalls in reca
-0005db30: 6c6c 3a0d 0a20 2020 2020 2020 2020 2020  ll:..           
-0005db40: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-0005db50: 2530 2e31 6625 2520 2027 2025 2872 6563  %0.1f%%  ' %(rec
-0005db60: 616c 6c73 2a31 3030 292c 2065 6e64 3d22  alls*100), end="
-0005db70: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-0005db80: 7072 696e 7428 275c 6e20 2020 2046 3120  print('\n    F1 
-0005db90: 5363 6f72 6573 2062 7920 636c 6173 733a  Scores by class:
-0005dba0: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-0005dbb0: 666f 7220 6631 5f73 636f 7265 7320 696e  for f1_scores in
-0005dbc0: 2066 315f 7363 6f72 653a 0d0a 2020 2020   f1_score:..    
-0005dbd0: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0005dbe0: 7428 2720 2020 2025 302e 3166 2525 2020  t('    %0.1f%%  
-0005dbf0: 2720 2528 6631 5f73 636f 7265 732a 3130  ' %(f1_scores*10
-0005dc00: 3029 2c65 6e64 3d22 2229 0d0a 2020 2020  0),end="")..    
-0005dc10: 2020 2020 2020 2020 2320 5265 7475 726e          # Return
-0005dc20: 206c 6973 7420 6f66 206d 6574 7269 6373   list of metrics
-0005dc30: 2074 6f20 6265 2061 6464 6564 2074 6f20   to be added to 
-0005dc40: 6120 4461 7461 6672 616d 6520 746f 2063  a Dataframe to c
-0005dc50: 6f6d 7061 7265 206d 6f64 656c 732e 0d0a  ompare models...
-0005dc60: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-0005dc70: 7428 275c 6e23 2323 2323 2323 2323 2323  t('\n###########
+0005d6b0: 2323 2327 290d 0a20 2020 2020 2020 2065  ###')..        e
+0005d6c0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0005d6d0: 2020 6261 6c61 6e63 6564 5f61 6363 7572    balanced_accur
+0005d6e0: 6163 7920 3d20 6d65 7472 6963 732e 6261  acy = metrics.ba
+0005d6f0: 6c61 6e63 6564 5f61 6363 7572 6163 795f  lanced_accuracy_
+0005d700: 7363 6f72 6528 795f 7465 7374 2c20 795f  score(y_test, y_
+0005d710: 7072 6564 7329 0d0a 2020 2020 2020 2020  preds)..        
+0005d720: 2020 2020 7072 6563 6973 696f 6e20 3d20      precision = 
+0005d730: 6d65 7472 6963 732e 7072 6563 6973 696f  metrics.precisio
+0005d740: 6e5f 7363 6f72 6528 795f 7465 7374 2c20  n_score(y_test, 
+0005d750: 795f 7072 6564 732c 2061 7665 7261 6765  y_preds, average
+0005d760: 203d 204e 6f6e 6529 0d0a 2020 2020 2020   = None)..      
+0005d770: 2020 2020 2020 6176 6572 6167 655f 7072        average_pr
+0005d780: 6563 6973 696f 6e20 3d20 6d65 7472 6963  ecision = metric
+0005d790: 732e 7072 6563 6973 696f 6e5f 7363 6f72  s.precision_scor
+0005d7a0: 6528 795f 7465 7374 2c20 795f 7072 6564  e(y_test, y_pred
+0005d7b0: 732c 6176 6572 6167 653d 276d 6163 726f  s,average='macro
+0005d7c0: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+0005d7d0: 6631 5f73 636f 7265 203d 206d 6574 7269  f1_score = metri
+0005d7e0: 6373 2e66 315f 7363 6f72 6528 795f 7465  cs.f1_score(y_te
+0005d7f0: 7374 2c20 795f 7072 6564 732c 2061 7665  st, y_preds, ave
+0005d800: 7261 6765 203d 204e 6f6e 6529 0d0a 2020  rage = None)..  
+0005d810: 2020 2020 2020 2020 2020 7265 6361 6c6c            recall
+0005d820: 203d 206d 6574 7269 6373 2e72 6563 616c   = metrics.recal
+0005d830: 6c5f 7363 6f72 6528 795f 7465 7374 2c20  l_score(y_test, 
+0005d840: 795f 7072 6564 732c 2061 7665 7261 6765  y_preds, average
+0005d850: 203d 204e 6f6e 6529 0d0a 2020 2020 2020   = None)..      
+0005d860: 2020 2020 2020 6966 2074 7970 6528 6e70        if type(np
+0005d870: 2e6d 6561 6e28 2879 5f74 6573 743d 3d79  .mean((y_test==y
+0005d880: 5f70 7265 6473 2929 2920 3d3d 2070 642e  _preds))) == pd.
+0005d890: 5365 7269 6573 3a0d 0a20 2020 2020 2020  Series:..       
+0005d8a0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+0005d8b0: 2020 2020 4163 6375 7261 6379 2020 2020      Accuracy    
+0005d8c0: 2020 2020 2020 3d20 2530 2e31 6625 2527        = %0.1f%%'
+0005d8d0: 2025 286e 702e 6d65 616e 2861 6363 7572   %(np.mean(accur
+0005d8e0: 6163 7929 2a31 3030 2929 0d0a 2020 2020  acy)*100))..    
+0005d8f0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+0005d900: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0005d910: 7269 6e74 2827 2020 2020 4163 6375 7261  rint('    Accura
+0005d920: 6379 2020 2020 2020 2020 2020 3d20 2530  cy          = %0
+0005d930: 2e31 6625 2527 2025 2861 6363 7572 6163  .1f%%' %(accurac
+0005d940: 792a 3130 3029 290d 0a20 2020 2020 2020  y*100))..       
+0005d950: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+0005d960: 4261 6c61 6e63 6564 2041 6363 7572 6163  Balanced Accurac
+0005d970: 7920 2861 7665 7261 6765 2072 6563 616c  y (average recal
+0005d980: 6c29 203d 2025 302e 3166 2525 2720 2528  l) = %0.1f%%' %(
+0005d990: 6261 6c61 6e63 6564 5f61 6363 7572 6163  balanced_accurac
+0005d9a0: 792a 3130 3029 290d 0a20 2020 2020 2020  y*100))..       
+0005d9b0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+0005d9c0: 4176 6572 6167 6520 5072 6563 6973 696f  Average Precisio
+0005d9d0: 6e20 286d 6163 726f 2920 3d20 2530 2e31  n (macro) = %0.1
+0005d9e0: 6625 2527 2025 2861 7665 7261 6765 5f70  f%%' %(average_p
+0005d9f0: 7265 6369 7369 6f6e 2a31 3030 2929 0d0a  recision*100))..
+0005da00: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+0005da10: 7468 6573 6520 6172 6520 6261 7369 6361  these are basica
+0005da20: 6c6c 7920 6f6e 6520 666f 7220 6561 6368  lly one for each
+0005da30: 2063 6c61 7373 2023 2323 2323 0d0a 2020   class #####..  
+0005da40: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0005da50: 2720 2020 2050 7265 6369 7369 6f6e 7320  '    Precisions 
+0005da60: 6279 2063 6c61 7373 3a27 290d 0a20 2020  by class:')..   
+0005da70: 2020 2020 2020 2020 2066 6f72 2070 7265           for pre
+0005da80: 6369 7369 6f6e 7320 696e 2070 7265 6369  cisions in preci
+0005da90: 7369 6f6e 3a0d 0a20 2020 2020 2020 2020  sion:..         
+0005daa0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+0005dab0: 2020 2530 2e31 6625 2520 2027 2025 2870    %0.1f%%  ' %(p
+0005dac0: 7265 6369 7369 6f6e 732a 3130 3029 2c65  recisions*100),e
+0005dad0: 6e64 3d22 2229 0d0a 2020 2020 2020 2020  nd="")..        
+0005dae0: 2020 2020 7072 696e 7428 275c 6e20 2020      print('\n   
+0005daf0: 2052 6563 616c 6c20 5363 6f72 6573 2062   Recall Scores b
+0005db00: 7920 636c 6173 733a 2729 0d0a 2020 2020  y class:')..    
+0005db10: 2020 2020 2020 2020 666f 7220 7265 6361          for reca
+0005db20: 6c6c 7320 696e 2072 6563 616c 6c3a 0d0a  lls in recall:..
+0005db30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0005db40: 7072 696e 7428 2720 2020 2025 302e 3166  print('    %0.1f
+0005db50: 2525 2020 2720 2528 7265 6361 6c6c 732a  %%  ' %(recalls*
+0005db60: 3130 3029 2c20 656e 643d 2222 290d 0a20  100), end="").. 
+0005db70: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0005db80: 2827 5c6e 2020 2020 4631 2053 636f 7265  ('\n    F1 Score
+0005db90: 7320 6279 2063 6c61 7373 3a27 290d 0a20  s by class:').. 
+0005dba0: 2020 2020 2020 2020 2020 2066 6f72 2066             for f
+0005dbb0: 315f 7363 6f72 6573 2069 6e20 6631 5f73  1_scores in f1_s
+0005dbc0: 636f 7265 3a0d 0a20 2020 2020 2020 2020  core:..         
+0005dbd0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+0005dbe0: 2020 2530 2e31 6625 2520 2027 2025 2866    %0.1f%%  ' %(f
+0005dbf0: 315f 7363 6f72 6573 2a31 3030 292c 656e  1_scores*100),en
+0005dc00: 643d 2222 290d 0a20 2020 2020 2020 2020  d="")..         
+0005dc10: 2020 2023 2052 6574 7572 6e20 6c69 7374     # Return list
+0005dc20: 206f 6620 6d65 7472 6963 7320 746f 2062   of metrics to b
+0005dc30: 6520 6164 6465 6420 746f 2061 2044 6174  e added to a Dat
+0005dc40: 6166 7261 6d65 2074 6f20 636f 6d70 6172  aframe to compar
+0005dc50: 6520 6d6f 6465 6c73 2e0d 0a20 2020 2020  e models...     
+0005dc60: 2020 2020 2020 2070 7269 6e74 2827 5c6e         print('\n
+0005dc70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005dc80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005dc90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dca0: 2323 2323 2323 2323 2323 2729 0d0a 2020  ##########')..  
-0005dcb0: 2020 2020 2020 7265 7475 726e 205b 6163        return [ac
-0005dcc0: 6375 7261 6379 2c20 6261 6c61 6e63 6564  curacy, balanced
-0005dcd0: 5f61 6363 7572 6163 792c 2070 7265 6369  _accuracy, preci
-0005dce0: 7369 6f6e 2c20 6176 6572 6167 655f 7072  sion, average_pr
-0005dcf0: 6563 6973 696f 6e2c 2066 315f 7363 6f72  ecision, f1_scor
-0005dd00: 652c 2072 6563 616c 6c2c 2030 5d0d 0a23  e, recall, 0]..#
+0005dca0: 2323 2323 2327 290d 0a20 2020 2020 2020  #####')..       
+0005dcb0: 2072 6574 7572 6e20 5b61 6363 7572 6163   return [accurac
+0005dcc0: 792c 2062 616c 616e 6365 645f 6163 6375  y, balanced_accu
+0005dcd0: 7261 6379 2c20 7072 6563 6973 696f 6e2c  racy, precision,
+0005dce0: 2061 7665 7261 6765 5f70 7265 6369 7369   average_precisi
+0005dcf0: 6f6e 2c20 6631 5f73 636f 7265 2c20 7265  on, f1_score, re
+0005dd00: 6361 6c6c 2c20 305d 0d0a 2323 2323 2323  call, 0]..######
 0005dd10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005dd20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005dd30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005dd40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005dd50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dd60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dd70: 230d 0a23 2323 2323 2323 2323 2323 2323  #..#############
+0005dd60: 2323 2323 2323 2323 2323 2323 0d0a 2323  ############..##
+0005dd70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005dd80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005dd90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005dda0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005ddb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005ddc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005ddd0: 2323 2323 230d 0a64 6566 206c 6566 745f  #####..def left_
-0005dde0: 7375 6274 7261 6374 286c 312c 6c32 293a  subtract(l1,l2):
-0005ddf0: 0d0a 2020 2020 6c73 7420 3d20 5b5d 0d0a  ..    lst = []..
-0005de00: 2020 2020 666f 7220 6920 696e 206c 313a      for i in l1:
-0005de10: 0d0a 2020 2020 2020 2020 6966 2069 206e  ..        if i n
-0005de20: 6f74 2069 6e20 6c32 3a0d 0a20 2020 2020  ot in l2:..     
-0005de30: 2020 2020 2020 206c 7374 2e61 7070 656e         lst.appen
-0005de40: 6428 6929 0d0a 2020 2020 7265 7475 726e  d(i)..    return
-0005de50: 206c 7374 0d0a 2323 2323 2323 2323 2323   lst..##########
+0005ddd0: 0d0a 6465 6620 6c65 6674 5f73 7562 7472  ..def left_subtr
+0005dde0: 6163 7428 6c31 2c6c 3229 3a0d 0a20 2020  act(l1,l2):..   
+0005ddf0: 206c 7374 203d 205b 5d0d 0a20 2020 2066   lst = []..    f
+0005de00: 6f72 2069 2069 6e20 6c31 3a0d 0a20 2020  or i in l1:..   
+0005de10: 2020 2020 2069 6620 6920 6e6f 7420 696e       if i not in
+0005de20: 206c 323a 0d0a 2020 2020 2020 2020 2020   l2:..          
+0005de30: 2020 6c73 742e 6170 7065 6e64 2869 290d    lst.append(i).
+0005de40: 0a20 2020 2072 6574 7572 6e20 6c73 740d  .    return lst.
+0005de50: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
 0005de60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005de70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005de80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005de90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dea0: 2323 2323 2323 0d0a 6672 6f6d 2063 6f6c  ######..from col
-0005deb0: 6c65 6374 696f 6e73 2069 6d70 6f72 7420  lections import 
-0005dec0: 436f 756e 7465 720d 0a69 6d70 6f72 7420  Counter..import 
-0005ded0: 7469 6d65 0d0a 6672 6f6d 2073 6b6c 6561  time..from sklea
-0005dee0: 726e 2e66 6561 7475 7265 5f73 656c 6563  rn.feature_selec
-0005def0: 7469 6f6e 2069 6d70 6f72 7420 6368 6932  tion import chi2
-0005df00: 2c20 6d75 7475 616c 5f69 6e66 6f5f 7265  , mutual_info_re
-0005df10: 6772 6573 7369 6f6e 2c20 6d75 7475 616c  gression, mutual
-0005df20: 5f69 6e66 6f5f 636c 6173 7369 660d 0a66  _info_classif..f
-0005df30: 726f 6d20 736b 6c65 6172 6e2e 6665 6174  rom sklearn.feat
-0005df40: 7572 655f 7365 6c65 6374 696f 6e20 696d  ure_selection im
-0005df50: 706f 7274 2053 656c 6563 744b 4265 7374  port SelectKBest
-0005df60: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+0005dea0: 230d 0a66 726f 6d20 636f 6c6c 6563 7469  #..from collecti
+0005deb0: 6f6e 7320 696d 706f 7274 2043 6f75 6e74  ons import Count
+0005dec0: 6572 0d0a 696d 706f 7274 2074 696d 650d  er..import time.
+0005ded0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6665  .from sklearn.fe
+0005dee0: 6174 7572 655f 7365 6c65 6374 696f 6e20  ature_selection 
+0005def0: 696d 706f 7274 2063 6869 322c 206d 7574  import chi2, mut
+0005df00: 7561 6c5f 696e 666f 5f72 6567 7265 7373  ual_info_regress
+0005df10: 696f 6e2c 206d 7574 7561 6c5f 696e 666f  ion, mutual_info
+0005df20: 5f63 6c61 7373 6966 0d0a 6672 6f6d 2073  _classif..from s
+0005df30: 6b6c 6561 726e 2e66 6561 7475 7265 5f73  klearn.feature_s
+0005df40: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
+0005df50: 5365 6c65 6374 4b42 6573 740d 0a23 2323  SelectKBest..###
+0005df60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005df70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005df80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005df90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dfa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005dfb0: 2323 0d0a 6672 6f6d 2063 6f6c 6c65 6374  ##..from collect
-0005dfc0: 696f 6e73 2069 6d70 6f72 7420 6465 6661  ions import defa
-0005dfd0: 756c 7464 6963 740d 0a66 726f 6d20 636f  ultdict..from co
-0005dfe0: 6c6c 6563 7469 6f6e 7320 696d 706f 7274  llections import
-0005dff0: 204f 7264 6572 6564 4469 6374 0d0a 696d   OrderedDict..im
-0005e000: 706f 7274 2074 696d 650d 0a64 6566 2072  port time..def r
-0005e010: 6574 7572 6e5f 6469 6374 696f 6e61 7279  eturn_dictionary
-0005e020: 5f6c 6973 7428 6c73 745f 6f66 5f74 7570  _list(lst_of_tup
-0005e030: 6c65 7329 3a0d 0a20 2020 2022 2222 2052  les):..    """ R
-0005e040: 6574 7572 6e73 2061 2064 6963 7469 6f6e  eturns a diction
-0005e050: 6172 7920 6f66 206c 6973 7473 2069 6620  ary of lists if 
-0005e060: 796f 7520 7365 6e64 2069 6e20 6120 6c69  you send in a li
-0005e070: 7374 206f 6620 5475 706c 6573 2222 220d  st of Tuples""".
-0005e080: 0a20 2020 206f 7244 6963 7420 3d20 6465  .    orDict = de
-0005e090: 6661 756c 7464 6963 7428 6c69 7374 290d  faultdict(list).
-0005e0a0: 0a20 2020 2023 2069 7465 7261 7469 6e67  .    # iterating
-0005e0b0: 206f 7665 7220 6c69 7374 206f 6620 7475   over list of tu
-0005e0c0: 706c 6573 0d0a 2020 2020 666f 7220 6b65  ples..    for ke
-0005e0d0: 792c 2076 616c 2069 6e20 6c73 745f 6f66  y, val in lst_of
-0005e0e0: 5f74 7570 6c65 733a 0d0a 2020 2020 2020  _tuples:..      
-0005e0f0: 2020 6f72 4469 6374 5b6b 6579 5d2e 6170    orDict[key].ap
-0005e100: 7065 6e64 2876 616c 290d 0a20 2020 2072  pend(val)..    r
-0005e110: 6574 7572 6e20 6f72 4469 6374 0d0a 2323  eturn orDict..##
+0005dfa0: 2323 2323 2323 2323 2323 2323 230d 0a66  #############..f
+0005dfb0: 726f 6d20 636f 6c6c 6563 7469 6f6e 7320  rom collections 
+0005dfc0: 696d 706f 7274 2064 6566 6175 6c74 6469  import defaultdi
+0005dfd0: 6374 0d0a 6672 6f6d 2063 6f6c 6c65 6374  ct..from collect
+0005dfe0: 696f 6e73 2069 6d70 6f72 7420 4f72 6465  ions import Orde
+0005dff0: 7265 6444 6963 740d 0a69 6d70 6f72 7420  redDict..import 
+0005e000: 7469 6d65 0d0a 6465 6620 7265 7475 726e  time..def return
+0005e010: 5f64 6963 7469 6f6e 6172 795f 6c69 7374  _dictionary_list
+0005e020: 286c 7374 5f6f 665f 7475 706c 6573 293a  (lst_of_tuples):
+0005e030: 0d0a 2020 2020 2222 2220 5265 7475 726e  ..    """ Return
+0005e040: 7320 6120 6469 6374 696f 6e61 7279 206f  s a dictionary o
+0005e050: 6620 6c69 7374 7320 6966 2079 6f75 2073  f lists if you s
+0005e060: 656e 6420 696e 2061 206c 6973 7420 6f66  end in a list of
+0005e070: 2054 7570 6c65 7322 2222 0d0a 2020 2020   Tuples"""..    
+0005e080: 6f72 4469 6374 203d 2064 6566 6175 6c74  orDict = default
+0005e090: 6469 6374 286c 6973 7429 0d0a 2020 2020  dict(list)..    
+0005e0a0: 2320 6974 6572 6174 696e 6720 6f76 6572  # iterating over
+0005e0b0: 206c 6973 7420 6f66 2074 7570 6c65 730d   list of tuples.
+0005e0c0: 0a20 2020 2066 6f72 206b 6579 2c20 7661  .    for key, va
+0005e0d0: 6c20 696e 206c 7374 5f6f 665f 7475 706c  l in lst_of_tupl
+0005e0e0: 6573 3a0d 0a20 2020 2020 2020 206f 7244  es:..        orD
+0005e0f0: 6963 745b 6b65 795d 2e61 7070 656e 6428  ict[key].append(
+0005e100: 7661 6c29 0d0a 2020 2020 7265 7475 726e  val)..    return
+0005e110: 206f 7244 6963 740d 0a23 2323 2323 2323   orDict..#######
 0005e120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005e130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005e140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005e150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e170: 0d0a 6465 6620 7265 6d6f 7665 5f76 6172  ..def remove_var
-0005e180: 6961 626c 6573 5f75 7369 6e67 5f66 6173  iables_using_fas
-0005e190: 745f 636f 7272 656c 6174 696f 6e28 6466  t_correlation(df
-0005e1a0: 2c20 6e75 6d76 6172 732c 206d 6f64 656c  , numvars, model
-0005e1b0: 7479 7065 2c20 7461 7267 6574 2c0d 0a20  type, target,.. 
+0005e160: 2323 2323 2323 2323 2323 230d 0a64 6566  ###########..def
+0005e170: 2072 656d 6f76 655f 7661 7269 6162 6c65   remove_variable
+0005e180: 735f 7573 696e 675f 6661 7374 5f63 6f72  s_using_fast_cor
+0005e190: 7265 6c61 7469 6f6e 2864 662c 206e 756d  relation(df, num
+0005e1a0: 7661 7273 2c20 6d6f 6465 6c74 7970 652c  vars, modeltype,
+0005e1b0: 2074 6172 6765 742c 0d0a 2020 2020 2020   target,..      
 0005e1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0005e1d0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0005e1e0: 6f72 725f 6c69 6d69 7420 3d20 302e 3730  orr_limit = 0.70
-0005e1f0: 2c76 6572 626f 7365 3d30 293a 0d0a 2020  ,verbose=0):..  
-0005e200: 2020 2222 220d 0a20 2020 2023 2323 2323    """..    #####
+0005e1d0: 2020 2020 2020 2020 2020 636f 7272 5f6c            corr_l
+0005e1e0: 696d 6974 203d 2030 2e37 302c 7665 7262  imit = 0.70,verb
+0005e1f0: 6f73 653d 3029 3a0d 0a20 2020 2022 2222  ose=0):..    """
+0005e200: 0d0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
 0005e210: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005e220: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005e230: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005e240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e250: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
-0005e260: 2020 2023 2323 2320 5448 4953 204d 4554     #### THIS MET
-0005e270: 484f 4420 4953 204b 4e4f 574e 2041 5320  HOD IS KNOWN AS 
-0005e280: 5448 4520 5355 4c4f 5620 4d45 5448 4f44  THE SULOV METHOD
-0005e290: 2069 6e20 484f 4e4f 5220 4f46 206d 7920   in HONOR OF my 
-0005e2a0: 6d6f 7468 6572 2023 2323 2323 2323 2323  mother #########
-0005e2b0: 2323 2323 230d 0a20 2020 2023 2323 2323  #####..    #####
+0005e250: 2323 2323 2323 2323 0d0a 2020 2020 2323  ########..    ##
+0005e260: 2323 2054 4849 5320 4d45 5448 4f44 2049  ## THIS METHOD I
+0005e270: 5320 4b4e 4f57 4e20 4153 2054 4845 2053  S KNOWN AS THE S
+0005e280: 554c 4f56 204d 4554 484f 4420 696e 2048  ULOV METHOD in H
+0005e290: 4f4e 4f52 204f 4620 6d79 206d 6f74 6865  ONOR OF my mothe
+0005e2a0: 7220 2323 2323 2323 2323 2323 2323 2323  r ##############
+0005e2b0: 0d0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
 0005e2c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005e2d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005e2e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005e2f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e300: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
-0005e310: 2020 2053 2055 204c 204f 2056 2072 6566     S U L O V ref
-0005e320: 6572 7320 746f 2053 656c 6563 7420 556e  ers to Select Un
-0005e330: 636f 7272 656c 6174 6564 204c 6973 7420  correlated List 
-0005e340: 6f66 2056 6172 6961 626c 6573 3a20 4372  of Variables: Cr
-0005e350: 6561 7465 6420 6279 2052 616d 2053 6573  eated by Ram Ses
-0005e360: 6861 6472 690d 0a20 2020 2053 554c 4f56  hadri..    SULOV
-0005e370: 2069 7320 6120 6869 6768 6c79 2065 6666   is a highly eff
-0005e380: 6963 6965 6e74 2061 6c67 6f72 6974 6820  icient algorith 
-0005e390: 7468 6174 2075 7365 7320 4d49 5320 746f  that uses MIS to
-0005e3a0: 2062 7265 616b 2074 6965 2d62 7265 616b   break tie-break
-0005e3b0: 6572 7320 616d 6f6e 670d 0a20 2020 2020  ers among..     
-0005e3c0: 6869 6768 6c79 2063 6f72 7265 6c61 7465  highly correlate
-0005e3d0: 6420 7661 7269 6162 6c65 7320 7768 6572  d variables wher
-0005e3e0: 6520 7765 2068 6176 6520 746f 2064 6563  e we have to dec
-0005e3f0: 6964 6520 7768 6963 6820 6f66 2074 776f  ide which of two
-0005e400: 2076 6172 6961 626c 6573 2074 6f20 6472   variables to dr
-0005e410: 6f70 2e20 0d0a 2020 2020 2043 7572 7265  op. ..     Curre
-0005e420: 6e74 6c79 2074 6865 7265 2069 7320 6e6f  ntly there is no
-0005e430: 2063 6c65 6172 2077 6179 2e20 5355 4c4f   clear way. SULO
-0005e440: 5620 7573 6573 204d 4953 2028 6d75 7475  V uses MIS (mutu
-0005e450: 616c 5f69 6e66 6f5f 7363 6f72 6529 2074  al_info_score) t
-0005e460: 6f20 6b65 6570 200d 0a20 2020 2020 7468  o keep ..     th
-0005e470: 6520 6869 6768 6572 204d 4953 2076 6172  e higher MIS var
-0005e480: 6961 626c 652e 2054 6869 7320 6d65 7468  iable. This meth
-0005e490: 6f64 2065 6e61 626c 6573 2061 6e20 6578  od enables an ex
-0005e4a0: 7472 656d 656c 7920 6661 7374 2061 6e64  tremely fast and
-0005e4b0: 2065 6666 6563 7469 7665 2077 6179 0d0a   effective way..
-0005e4c0: 2020 2020 2074 6f20 7365 6c65 6374 2062       to select b
-0005e4d0: 6573 7420 6665 6174 7572 6573 2066 726f  est features fro
-0005e4e0: 6d20 6461 7461 2e20 596f 7520 6e65 6564  m data. You need
-0005e4f0: 2074 6f20 7365 6e64 2069 6e20 6120 6461   to send in a da
-0005e500: 7461 6672 616d 6520 7769 7468 2061 206c  taframe with a l
-0005e510: 6973 7420 0d0a 2020 2020 206f 6620 6e75  ist ..     of nu
-0005e520: 6d65 7269 6320 7661 7269 6162 6c65 7320  meric variables 
-0005e530: 616e 6420 6465 6669 6e65 2061 2074 6872  and define a thr
-0005e540: 6573 686f 6c64 202d 2074 6861 7427 7320  eshold - that's 
-0005e550: 616c 6c2e 0d0a 2020 2020 2054 6869 7320  all...     This 
-0005e560: 7468 7265 7368 6f6c 6420 7769 6c6c 2064  threshold will d
-0005e570: 6566 696e 6520 7468 6520 2268 6967 6820  efine the "high 
-0005e580: 436f 7272 656c 6174 696f 6e22 206d 6172  Correlation" mar
-0005e590: 6b3a 2064 6566 6175 6c74 2069 7320 2e37  k: default is .7
-0005e5a0: 3020 2861 6273 6f6c 7574 6529 2e0d 0a20  0 (absolute)... 
-0005e5b0: 2020 2020 596f 7520 6361 6e20 6368 616e      You can chan
-0005e5c0: 6765 2074 6869 7320 6c69 6d69 742e 2049  ge this limit. I
-0005e5d0: 6620 7477 6f20 7661 7269 6162 6c65 7320  f two variables 
-0005e5e0: 6861 7665 2061 6273 6f6c 7574 6520 636f  have absolute co
-0005e5f0: 7272 656c 6174 696f 6e20 6869 6768 6572  rrelation higher
-0005e600: 2074 6861 6e20 0d0a 2020 2020 206c 696d   than ..     lim
-0005e610: 6974 2c20 7468 6579 2077 696c 6c20 6265  it, they will be
-0005e620: 2072 6564 2d66 6c61 6767 6564 2c20 616e   red-flagged, an
-0005e630: 6420 7573 696e 6720 6120 7365 7269 6573  d using a series
-0005e640: 206f 6620 7469 652d 6272 6561 6b65 7220   of tie-breaker 
-0005e650: 726f 756e 6473 2c20 6f6e 6520 6f66 200d  rounds, one of .
-0005e660: 0a20 2020 2020 7468 656d 2077 696c 6c20  .     them will 
-0005e670: 6265 2073 656c 6563 7465 6420 7369 6e63  be selected sinc
-0005e680: 6520 7468 6520 7361 6d65 2076 6172 6961  e the same varia
-0005e690: 626c 6520 6361 6e20 6265 2063 6f72 7265  ble can be corre
-0005e6a0: 6c61 7465 6420 746f 206d 756c 7469 706c  lated to multipl
-0005e6b0: 6520 7661 7269 6162 6c65 732e 0d0a 2020  e variables...  
-0005e6c0: 2020 2054 6f20 6465 6369 6465 2077 6869     To decide whi
-0005e6d0: 6368 2076 6172 6961 626c 6573 2074 6f20  ch variables to 
-0005e6e0: 6b65 6570 2069 6e20 6b6e 6f63 6b6f 7574  keep in knockout
-0005e6f0: 2072 6f75 6e64 732c 206d 7574 7561 6c20   rounds, mutual 
-0005e700: 696e 666f 726d 6174 696f 6e20 7363 6f72  information scor
-0005e710: 6520 284d 4953 290d 0a20 2020 2020 6973  e (MIS)..     is
-0005e720: 2075 7365 642e 204d 4953 2072 6574 7572   used. MIS retur
-0005e730: 6e73 2061 2072 616e 6b65 6420 6c69 7374  ns a ranked list
-0005e740: 206f 6620 636f 7272 656c 6174 6564 2076   of correlated v
-0005e750: 6172 6961 626c 6573 3a20 7768 656e 2077  ariables: when w
-0005e760: 6520 7365 6c65 6374 206f 6e65 2074 6f0d  e select one to.
-0005e770: 0a20 2020 2020 6b65 6570 2c20 7765 206b  .     keep, we k
-0005e780: 6e6f 636b 206f 7574 2061 6c6c 206f 7468  nock out all oth
-0005e790: 6572 7320 7468 6174 2077 6572 6520 6869  ers that were hi
-0005e7a0: 6768 6c79 2063 6f72 7265 6c61 7465 6420  ghly correlated 
-0005e7b0: 746f 2069 742e 2054 6869 7320 7761 7920  to it. This way 
-0005e7c0: 7765 206b 6e6f 636b 0d0a 2020 2020 206f  we knock..     o
-0005e7d0: 7574 2063 6f72 7265 6c61 7465 6420 7661  ut correlated va
-0005e7e0: 7269 6162 6c65 7320 696e 2065 6163 6820  riables in each 
-0005e7f0: 726f 756e 642e 2049 6e20 7468 6520 656e  round. In the en
-0005e800: 642c 2053 554c 4f56 2067 6976 6573 2075  d, SULOV gives u
-0005e810: 7320 6120 6c69 7374 206f 6620 6c65 6173  s a list of leas
-0005e820: 740d 0a20 2020 2020 636f 7272 656c 6174  t..     correlat
-0005e830: 6564 2076 6172 6961 626c 6573 2074 6861  ed variables tha
-0005e840: 7420 6861 7665 2074 6865 2062 6573 7420  t have the best 
-0005e850: 6d75 7475 616c 2069 6e66 6f72 6d61 7469  mutual informati
-0005e860: 6f6e 2073 636f 7265 2069 6e20 796f 7572  on score in your
-0005e870: 2064 6174 6120 7365 7421 0d0a 2020 2020   data set!..    
+0005e300: 2323 2323 2323 2323 0d0a 2020 2020 5320  ########..    S 
+0005e310: 5520 4c20 4f20 5620 7265 6665 7273 2074  U L O V refers t
+0005e320: 6f20 5365 6c65 6374 2055 6e63 6f72 7265  o Select Uncorre
+0005e330: 6c61 7465 6420 4c69 7374 206f 6620 5661  lated List of Va
+0005e340: 7269 6162 6c65 733a 2043 7265 6174 6564  riables: Created
+0005e350: 2062 7920 5261 6d20 5365 7368 6164 7269   by Ram Seshadri
+0005e360: 0d0a 2020 2020 5355 4c4f 5620 6973 2061  ..    SULOV is a
+0005e370: 2068 6967 686c 7920 6566 6669 6369 656e   highly efficien
+0005e380: 7420 616c 676f 7269 7468 2074 6861 7420  t algorith that 
+0005e390: 7573 6573 204d 4953 2074 6f20 6272 6561  uses MIS to brea
+0005e3a0: 6b20 7469 652d 6272 6561 6b65 7273 2061  k tie-breakers a
+0005e3b0: 6d6f 6e67 0d0a 2020 2020 2068 6967 686c  mong..     highl
+0005e3c0: 7920 636f 7272 656c 6174 6564 2076 6172  y correlated var
+0005e3d0: 6961 626c 6573 2077 6865 7265 2077 6520  iables where we 
+0005e3e0: 6861 7665 2074 6f20 6465 6369 6465 2077  have to decide w
+0005e3f0: 6869 6368 206f 6620 7477 6f20 7661 7269  hich of two vari
+0005e400: 6162 6c65 7320 746f 2064 726f 702e 200d  ables to drop. .
+0005e410: 0a20 2020 2020 4375 7272 656e 746c 7920  .     Currently 
+0005e420: 7468 6572 6520 6973 206e 6f20 636c 6561  there is no clea
+0005e430: 7220 7761 792e 2053 554c 4f56 2075 7365  r way. SULOV use
+0005e440: 7320 4d49 5320 286d 7574 7561 6c5f 696e  s MIS (mutual_in
+0005e450: 666f 5f73 636f 7265 2920 746f 206b 6565  fo_score) to kee
+0005e460: 7020 0d0a 2020 2020 2074 6865 2068 6967  p ..     the hig
+0005e470: 6865 7220 4d49 5320 7661 7269 6162 6c65  her MIS variable
+0005e480: 2e20 5468 6973 206d 6574 686f 6420 656e  . This method en
+0005e490: 6162 6c65 7320 616e 2065 7874 7265 6d65  ables an extreme
+0005e4a0: 6c79 2066 6173 7420 616e 6420 6566 6665  ly fast and effe
+0005e4b0: 6374 6976 6520 7761 790d 0a20 2020 2020  ctive way..     
+0005e4c0: 746f 2073 656c 6563 7420 6265 7374 2066  to select best f
+0005e4d0: 6561 7475 7265 7320 6672 6f6d 2064 6174  eatures from dat
+0005e4e0: 612e 2059 6f75 206e 6565 6420 746f 2073  a. You need to s
+0005e4f0: 656e 6420 696e 2061 2064 6174 6166 7261  end in a datafra
+0005e500: 6d65 2077 6974 6820 6120 6c69 7374 200d  me with a list .
+0005e510: 0a20 2020 2020 6f66 206e 756d 6572 6963  .     of numeric
+0005e520: 2076 6172 6961 626c 6573 2061 6e64 2064   variables and d
+0005e530: 6566 696e 6520 6120 7468 7265 7368 6f6c  efine a threshol
+0005e540: 6420 2d20 7468 6174 2773 2061 6c6c 2e0d  d - that's all..
+0005e550: 0a20 2020 2020 5468 6973 2074 6872 6573  .     This thres
+0005e560: 686f 6c64 2077 696c 6c20 6465 6669 6e65  hold will define
+0005e570: 2074 6865 2022 6869 6768 2043 6f72 7265   the "high Corre
+0005e580: 6c61 7469 6f6e 2220 6d61 726b 3a20 6465  lation" mark: de
+0005e590: 6661 756c 7420 6973 202e 3730 2028 6162  fault is .70 (ab
+0005e5a0: 736f 6c75 7465 292e 0d0a 2020 2020 2059  solute)...     Y
+0005e5b0: 6f75 2063 616e 2063 6861 6e67 6520 7468  ou can change th
+0005e5c0: 6973 206c 696d 6974 2e20 4966 2074 776f  is limit. If two
+0005e5d0: 2076 6172 6961 626c 6573 2068 6176 6520   variables have 
+0005e5e0: 6162 736f 6c75 7465 2063 6f72 7265 6c61  absolute correla
+0005e5f0: 7469 6f6e 2068 6967 6865 7220 7468 616e  tion higher than
+0005e600: 200d 0a20 2020 2020 6c69 6d69 742c 2074   ..     limit, t
+0005e610: 6865 7920 7769 6c6c 2062 6520 7265 642d  hey will be red-
+0005e620: 666c 6167 6765 642c 2061 6e64 2075 7369  flagged, and usi
+0005e630: 6e67 2061 2073 6572 6965 7320 6f66 2074  ng a series of t
+0005e640: 6965 2d62 7265 616b 6572 2072 6f75 6e64  ie-breaker round
+0005e650: 732c 206f 6e65 206f 6620 0d0a 2020 2020  s, one of ..    
+0005e660: 2074 6865 6d20 7769 6c6c 2062 6520 7365   them will be se
+0005e670: 6c65 6374 6564 2073 696e 6365 2074 6865  lected since the
+0005e680: 2073 616d 6520 7661 7269 6162 6c65 2063   same variable c
+0005e690: 616e 2062 6520 636f 7272 656c 6174 6564  an be correlated
+0005e6a0: 2074 6f20 6d75 6c74 6970 6c65 2076 6172   to multiple var
+0005e6b0: 6961 626c 6573 2e0d 0a20 2020 2020 546f  iables...     To
+0005e6c0: 2064 6563 6964 6520 7768 6963 6820 7661   decide which va
+0005e6d0: 7269 6162 6c65 7320 746f 206b 6565 7020  riables to keep 
+0005e6e0: 696e 206b 6e6f 636b 6f75 7420 726f 756e  in knockout roun
+0005e6f0: 6473 2c20 6d75 7475 616c 2069 6e66 6f72  ds, mutual infor
+0005e700: 6d61 7469 6f6e 2073 636f 7265 2028 4d49  mation score (MI
+0005e710: 5329 0d0a 2020 2020 2069 7320 7573 6564  S)..     is used
+0005e720: 2e20 4d49 5320 7265 7475 726e 7320 6120  . MIS returns a 
+0005e730: 7261 6e6b 6564 206c 6973 7420 6f66 2063  ranked list of c
+0005e740: 6f72 7265 6c61 7465 6420 7661 7269 6162  orrelated variab
+0005e750: 6c65 733a 2077 6865 6e20 7765 2073 656c  les: when we sel
+0005e760: 6563 7420 6f6e 6520 746f 0d0a 2020 2020  ect one to..    
+0005e770: 206b 6565 702c 2077 6520 6b6e 6f63 6b20   keep, we knock 
+0005e780: 6f75 7420 616c 6c20 6f74 6865 7273 2074  out all others t
+0005e790: 6861 7420 7765 7265 2068 6967 686c 7920  hat were highly 
+0005e7a0: 636f 7272 656c 6174 6564 2074 6f20 6974  correlated to it
+0005e7b0: 2e20 5468 6973 2077 6179 2077 6520 6b6e  . This way we kn
+0005e7c0: 6f63 6b0d 0a20 2020 2020 6f75 7420 636f  ock..     out co
+0005e7d0: 7272 656c 6174 6564 2076 6172 6961 626c  rrelated variabl
+0005e7e0: 6573 2069 6e20 6561 6368 2072 6f75 6e64  es in each round
+0005e7f0: 2e20 496e 2074 6865 2065 6e64 2c20 5355  . In the end, SU
+0005e800: 4c4f 5620 6769 7665 7320 7573 2061 206c  LOV gives us a l
+0005e810: 6973 7420 6f66 206c 6561 7374 0d0a 2020  ist of least..  
+0005e820: 2020 2063 6f72 7265 6c61 7465 6420 7661     correlated va
+0005e830: 7269 6162 6c65 7320 7468 6174 2068 6176  riables that hav
+0005e840: 6520 7468 6520 6265 7374 206d 7574 7561  e the best mutua
+0005e850: 6c20 696e 666f 726d 6174 696f 6e20 7363  l information sc
+0005e860: 6f72 6520 696e 2079 6f75 7220 6461 7461  ore in your data
+0005e870: 2073 6574 210d 0a20 2020 2023 2323 2323   set!..    #####
 0005e880: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005e890: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005e8a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005e8b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e8c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005e8d0: 2323 0d0a 2020 2020 2222 220d 0a20 2020  ##..    """..   
-0005e8e0: 2064 6620 3d20 636f 7079 2e64 6565 7063   df = copy.deepc
-0005e8f0: 6f70 7928 6466 290d 0a20 2020 2070 7269  opy(df)..    pri
-0005e900: 6e74 2827 5265 6d6f 7669 6e67 2068 6967  nt('Removing hig
-0005e910: 686c 7920 636f 7272 656c 6174 6564 2076  hly correlated v
-0005e920: 6172 6961 626c 6573 2075 7369 6e67 2053  ariables using S
-0005e930: 554c 4f56 206d 6574 686f 6420 616d 6f6e  ULOV method amon
-0005e940: 6720 2825 6429 206e 756d 6572 6963 2076  g (%d) numeric v
-0005e950: 6172 6961 626c 6573 2720 256c 656e 286e  ariables' %len(n
-0005e960: 756d 7661 7273 2929 0d0a 2020 2020 636f  umvars))..    co
-0005e970: 7272 656c 6174 696f 6e5f 6461 7461 6672  rrelation_datafr
-0005e980: 616d 6520 3d20 6466 5b6e 756d 7661 7273  ame = df[numvars
-0005e990: 5d2e 636f 7272 2829 2e61 7374 7970 6528  ].corr().astype(
-0005e9a0: 6e70 2e66 6c6f 6174 3136 290d 0a20 2020  np.float16)..   
-0005e9b0: 2061 203d 2063 6f72 7265 6c61 7469 6f6e   a = correlation
-0005e9c0: 5f64 6174 6166 7261 6d65 2e76 616c 7565  _dataframe.value
-0005e9d0: 730d 0a20 2020 2063 6f6c 5f69 6e64 6578  s..    col_index
-0005e9e0: 203d 2063 6f72 7265 6c61 7469 6f6e 5f64   = correlation_d
-0005e9f0: 6174 6166 7261 6d65 2e63 6f6c 756d 6e73  ataframe.columns
-0005ea00: 2e74 6f6c 6973 7428 290d 0a20 2020 2069  .tolist()..    i
-0005ea10: 6e64 6578 5f74 7269 7570 7065 7220 3d20  ndex_triupper = 
-0005ea20: 6c69 7374 287a 6970 286e 702e 7472 6975  list(zip(np.triu
-0005ea30: 5f69 6e64 6963 6573 5f66 726f 6d28 612c  _indices_from(a,
-0005ea40: 6b3d 3129 5b30 5d2c 6e70 2e74 7269 755f  k=1)[0],np.triu_
-0005ea50: 696e 6469 6365 735f 6672 6f6d 2861 2c6b  indices_from(a,k
-0005ea60: 3d31 295b 315d 2929 0d0a 2020 2020 6869  =1)[1]))..    hi
-0005ea70: 6768 5f63 6f72 725f 696e 6465 785f 6c69  gh_corr_index_li
-0005ea80: 7374 203d 205b 7820 666f 7220 7820 696e  st = [x for x in
-0005ea90: 206e 702e 6172 6777 6865 7265 2861 6273   np.argwhere(abs
-0005eaa0: 2861 5b6e 702e 7472 6975 5f69 6e64 6963  (a[np.triu_indic
-0005eab0: 6573 286c 656e 2861 292c 206b 203d 2031  es(len(a), k = 1
-0005eac0: 295d 293e 3d63 6f72 725f 6c69 6d69 7429  )])>=corr_limit)
-0005ead0: 5d0d 0a20 2020 206c 6f77 5f63 6f72 725f  ]..    low_corr_
-0005eae0: 696e 6465 785f 6c69 7374 203d 2020 5b78  index_list =  [x
-0005eaf0: 2066 6f72 2078 2069 6e20 6e70 2e61 7267   for x in np.arg
-0005eb00: 7768 6572 6528 6162 7328 615b 6e70 2e74  where(abs(a[np.t
-0005eb10: 7269 755f 696e 6469 6365 7328 6c65 6e28  riu_indices(len(
-0005eb20: 6129 2c20 6b20 3d20 3129 5d29 3c63 6f72  a), k = 1)])<cor
-0005eb30: 725f 6c69 6d69 7429 5d0d 0a20 2020 2074  r_limit)]..    t
-0005eb40: 7570 6c65 5f6c 6973 7420 3d20 5b79 2066  uple_list = [y f
-0005eb50: 6f72 2079 2069 6e20 5b69 6e64 6578 5f74  or y in [index_t
-0005eb60: 7269 7570 7065 725b 785b 305d 5d20 666f  riupper[x[0]] fo
-0005eb70: 7220 7820 696e 2068 6967 685f 636f 7272  r x in high_corr
-0005eb80: 5f69 6e64 6578 5f6c 6973 745d 5d0d 0a20  _index_list]].. 
-0005eb90: 2020 2063 6f72 7265 6c61 7465 645f 7061     correlated_pa
-0005eba0: 6972 203d 205b 2863 6f6c 5f69 6e64 6578  ir = [(col_index
-0005ebb0: 5b74 7570 6c65 5b30 5d5d 2c63 6f6c 5f69  [tuple[0]],col_i
-0005ebc0: 6e64 6578 5b74 7570 6c65 5b31 5d5d 2920  ndex[tuple[1]]) 
-0005ebd0: 666f 7220 7475 706c 6520 696e 2074 7570  for tuple in tup
-0005ebe0: 6c65 5f6c 6973 745d 0d0a 2020 2020 636f  le_list]..    co
-0005ebf0: 7272 5f70 6169 725f 6469 6374 203d 2064  rr_pair_dict = d
-0005ec00: 6963 7428 7265 7475 726e 5f64 6963 7469  ict(return_dicti
-0005ec10: 6f6e 6172 795f 6c69 7374 2863 6f72 7265  onary_list(corre
-0005ec20: 6c61 7465 645f 7061 6972 2929 0d0a 2020  lated_pair))..  
-0005ec30: 2020 6b65 7973 5f69 6e5f 6469 6374 203d    keys_in_dict =
-0005ec40: 206c 6973 7428 636f 7272 5f70 6169 725f   list(corr_pair_
-0005ec50: 6469 6374 2e6b 6579 7328 2929 0d0a 2020  dict.keys())..  
-0005ec60: 2020 7265 7665 7273 655f 636f 7272 656c    reverse_correl
-0005ec70: 6174 6564 5f70 6169 7220 3d20 5b28 792c  ated_pair = [(y,
-0005ec80: 7829 2066 6f72 2028 782c 7929 2069 6e20  x) for (x,y) in 
-0005ec90: 636f 7272 656c 6174 6564 5f70 6169 725d  correlated_pair]
-0005eca0: 0d0a 2020 2020 7265 7665 7273 655f 636f  ..    reverse_co
-0005ecb0: 7272 5f70 6169 725f 6469 6374 203d 2064  rr_pair_dict = d
-0005ecc0: 6963 7428 7265 7475 726e 5f64 6963 7469  ict(return_dicti
-0005ecd0: 6f6e 6172 795f 6c69 7374 2872 6576 6572  onary_list(rever
-0005ece0: 7365 5f63 6f72 7265 6c61 7465 645f 7061  se_correlated_pa
-0005ecf0: 6972 2929 0d0a 2020 2020 666f 7220 6b65  ir))..    for ke
-0005ed00: 792c 2076 616c 2069 6e20 7265 7665 7273  y, val in revers
-0005ed10: 655f 636f 7272 5f70 6169 725f 6469 6374  e_corr_pair_dict
-0005ed20: 2e69 7465 6d73 2829 3a0d 0a20 2020 2020  .items():..     
-0005ed30: 2020 2069 6620 6b65 7920 696e 206b 6579     if key in key
-0005ed40: 735f 696e 5f64 6963 743a 0d0a 2020 2020  s_in_dict:..    
-0005ed50: 2020 2020 2020 2020 6966 206c 656e 286b          if len(k
-0005ed60: 6579 2920 3e20 313a 0d0a 2020 2020 2020  ey) > 1:..      
-0005ed70: 2020 2020 2020 2020 2020 636f 7272 5f70            corr_p
-0005ed80: 6169 725f 6469 6374 5b6b 6579 5d20 2b3d  air_dict[key] +=
-0005ed90: 2076 616c 0d0a 2020 2020 2020 2020 656c   val..        el
-0005eda0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0005edb0: 2063 6f72 725f 7061 6972 5f64 6963 745b   corr_pair_dict[
-0005edc0: 6b65 795d 203d 2076 616c 0d0a 2020 2020  key] = val..    
-0005edd0: 666c 6174 5f63 6f72 725f 7061 6972 5f6c  flat_corr_pair_l
-0005ede0: 6973 7420 3d20 5b69 7465 6d20 666f 7220  ist = [item for 
-0005edf0: 7375 626c 6973 7420 696e 2063 6f72 7265  sublist in corre
-0005ee00: 6c61 7465 645f 7061 6972 2066 6f72 2069  lated_pair for i
-0005ee10: 7465 6d20 696e 2073 7562 6c69 7374 5d0d  tem in sublist].
-0005ee20: 0a20 2020 2023 2323 2320 596f 7520 6361  .    #### You ca
-0005ee30: 6e20 6d61 6b65 2069 7420 6120 6469 6374  n make it a dict
-0005ee40: 696f 6e61 7279 206f 7220 6120 7475 706c  ionary or a tupl
-0005ee50: 6520 6f66 206c 6973 7473 2e20 5765 2068  e of lists. We h
-0005ee60: 6176 6520 6368 6f73 656e 2074 6865 206c  ave chosen the l
-0005ee70: 6174 7465 7220 6865 7265 2074 6f20 6b65  atter here to ke
-0005ee80: 6570 206f 7264 6572 2069 6e74 6163 742e  ep order intact.
-0005ee90: 0d0a 2020 2020 636f 7272 5f70 6169 725f  ..    corr_pair_
-0005eea0: 636f 756e 745f 6469 6374 203d 2063 6f75  count_dict = cou
-0005eeb0: 6e74 5f66 7265 715f 696e 5f6c 6973 7428  nt_freq_in_list(
-0005eec0: 666c 6174 5f63 6f72 725f 7061 6972 5f6c  flat_corr_pair_l
-0005eed0: 6973 7429 0d0a 2020 2020 636f 7272 5f6c  ist)..    corr_l
-0005eee0: 6973 7420 3d20 5b6b 2066 6f72 2028 6b2c  ist = [k for (k,
-0005eef0: 7629 2069 6e20 636f 7272 5f70 6169 725f  v) in corr_pair_
-0005ef00: 636f 756e 745f 6469 6374 5d0d 0a20 2020  count_dict]..   
-0005ef10: 2023 2323 2323 2320 5468 6973 2069 7320   ###### This is 
-0005ef20: 666f 7220 6f72 6465 7269 6e67 2074 6865  for ordering the
-0005ef30: 2076 6172 6961 626c 6573 2069 6e20 7468   variables in th
-0005ef40: 6520 6869 6768 6573 7420 746f 206c 6f77  e highest to low
-0005ef50: 6573 7420 696d 706f 7274 616e 6365 2074  est importance t
-0005ef60: 6f20 7461 7267 6574 2023 2323 0d0a 2020  o target ###..  
-0005ef70: 2020 6966 206c 656e 2863 6f72 725f 6c69    if len(corr_li
-0005ef80: 7374 2920 3d3d 2030 3a0d 0a20 2020 2020  st) == 0:..     
-0005ef90: 2020 2066 696e 616c 5f6c 6973 7420 3d20     final_list = 
-0005efa0: 6c69 7374 2863 6f72 7265 6c61 7469 6f6e  list(correlation
-0005efb0: 5f64 6174 6166 7261 6d65 290d 0a20 2020  _dataframe)..   
-0005efc0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
-0005efd0: 4e6f 206e 756d 6572 6963 2076 6172 7320  No numeric vars 
-0005efe0: 7265 6d6f 7665 6420 7369 6e63 6520 6e6f  removed since no
-0005eff0: 6e65 2068 6176 6520 6869 6768 2063 6f72  ne have high cor
-0005f000: 7265 6c61 7469 6f6e 2077 6974 6820 6561  relation with ea
-0005f010: 6368 206f 7468 6572 2069 6e20 7468 6973  ch other in this
-0005f020: 2064 6174 612e 2e2e 2729 0d0a 2020 2020   data...')..    
-0005f030: 656c 7365 3a0d 0a20 2020 2020 2020 206d  else:..        m
-0005f040: 6178 5f66 6561 7473 203d 206c 656e 2863  ax_feats = len(c
-0005f050: 6f72 725f 6c69 7374 290d 0a20 2020 2020  orr_list)..     
-0005f060: 2020 2069 6620 6d6f 6465 6c74 7970 6520     if modeltype 
-0005f070: 3d3d 2027 5265 6772 6573 7369 6f6e 273a  == 'Regression':
-0005f080: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0005f090: 6c5f 6675 6e63 7469 6f6e 203d 206d 7574  l_function = mut
-0005f0a0: 7561 6c5f 696e 666f 5f72 6567 7265 7373  ual_info_regress
-0005f0b0: 696f 6e0d 0a20 2020 2020 2020 2020 2020  ion..           
-0005f0c0: 2066 7320 3d20 5365 6c65 6374 4b42 6573   fs = SelectKBes
-0005f0d0: 7428 7363 6f72 655f 6675 6e63 3d73 656c  t(score_func=sel
-0005f0e0: 5f66 756e 6374 696f 6e2c 206b 3d6d 6178  _function, k=max
-0005f0f0: 5f66 6561 7473 290d 0a20 2020 2020 2020  _feats)..       
-0005f100: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-0005f110: 2020 2020 7365 6c5f 6675 6e63 7469 6f6e      sel_function
-0005f120: 203d 206d 7574 7561 6c5f 696e 666f 5f63   = mutual_info_c
-0005f130: 6c61 7373 6966 0d0a 2020 2020 2020 2020  lassif..        
-0005f140: 2020 2020 6673 203d 2053 656c 6563 744b      fs = SelectK
-0005f150: 4265 7374 2873 636f 7265 5f66 756e 633d  Best(score_func=
-0005f160: 7365 6c5f 6675 6e63 7469 6f6e 2c20 6b3d  sel_function, k=
-0005f170: 6d61 785f 6665 6174 7329 0d0a 2020 2020  max_feats)..    
-0005f180: 2020 2020 6673 2e66 6974 2864 665b 636f      fs.fit(df[co
-0005f190: 7272 5f6c 6973 745d 2e61 7374 7970 6528  rr_list].astype(
-0005f1a0: 6e70 2e66 6c6f 6174 3136 292c 2064 665b  np.float16), df[
-0005f1b0: 7461 7267 6574 5d29 0d0a 2020 2020 2020  target])..      
-0005f1c0: 2020 6d75 7475 616c 5f69 6e66 6f20 3d20    mutual_info = 
-0005f1d0: 6469 6374 287a 6970 2863 6f72 725f 6c69  dict(zip(corr_li
-0005f1e0: 7374 2c66 732e 7363 6f72 6573 5f29 290d  st,fs.scores_)).
-0005f1f0: 0a20 2020 2020 2020 2023 2323 2320 5468  .        #### Th
-0005f200: 6520 6669 7273 7420 7661 7269 6162 6c65  e first variable
-0005f210: 2069 6e20 6c69 7374 2068 6173 2074 6865   in list has the
-0005f220: 2068 6967 6865 7374 2063 6f72 7265 6c61   highest correla
-0005f230: 7469 6f6e 2074 6f20 7468 6520 7461 7267  tion to the targ
-0005f240: 6574 2076 6172 6961 626c 6520 2323 230d  et variable ###.
-0005f250: 0a20 2020 2020 2020 2073 6f72 7465 645f  .        sorted_
-0005f260: 6279 5f6d 7574 7561 6c5f 696e 666f 203d  by_mutual_info =
-0005f270: 5b6b 6579 2066 6f72 2028 6b65 792c 7661  [key for (key,va
-0005f280: 6c29 2069 6e20 736f 7274 6564 286d 7574  l) in sorted(mut
-0005f290: 7561 6c5f 696e 666f 2e69 7465 6d73 2829  ual_info.items()
-0005f2a0: 2c20 6b65 793d 6c61 6d62 6461 206b 763a  , key=lambda kv:
-0005f2b0: 206b 765b 315d 2c72 6576 6572 7365 3d54   kv[1],reverse=T
-0005f2c0: 7275 6529 5d0d 0a20 2020 2020 2020 2023  rue)]..        #
-0005f2d0: 2323 2323 2020 204e 6f77 2077 6520 7365  ####   Now we se
-0005f2e0: 6c65 6374 2074 6865 2066 696e 616c 206c  lect the final l
-0005f2f0: 6973 7420 6f66 2063 6f72 7265 6c61 7465  ist of correlate
-0005f300: 6420 7661 7269 6162 6c65 7320 2323 2323  d variables ####
-0005f310: 2323 2323 2323 230d 0a20 2020 2020 2020  #######..       
-0005f320: 2073 656c 6563 7465 645f 636f 7272 5f6c   selected_corr_l
-0005f330: 6973 7420 3d20 5b5d 0d0a 2020 2020 2020  ist = []..      
-0005f340: 2020 2323 2323 2073 656c 6563 7420 6561    #### select ea
-0005f350: 6368 2076 6172 6961 626c 6520 6279 2074  ch variable by t
-0005f360: 6865 2068 6967 6865 7374 206d 7574 7561  he highest mutua
-0005f370: 6c20 696e 666f 2061 6e64 2073 6565 2077  l info and see w
-0005f380: 6861 7420 7661 7273 2061 7265 2063 6f72  hat vars are cor
-0005f390: 7265 6c61 7465 6420 746f 2069 740d 0a20  related to it.. 
-0005f3a0: 2020 2020 2020 2066 6f72 2065 6163 685f         for each_
-0005f3b0: 636f 7272 5f6e 616d 6520 696e 2073 6f72  corr_name in sor
-0005f3c0: 7465 645f 6279 5f6d 7574 7561 6c5f 696e  ted_by_mutual_in
-0005f3d0: 666f 3a0d 0a20 2020 2020 2020 2020 2020  fo:..           
-0005f3e0: 2023 2323 2061 6464 2074 6865 2073 656c   ### add the sel
-0005f3f0: 6563 7465 6420 7661 7220 746f 2074 6865  ected var to the
-0005f400: 2073 656c 6563 7465 645f 636f 7272 5f6c   selected_corr_l
-0005f410: 6973 740d 0a20 2020 2020 2020 2020 2020  ist..           
-0005f420: 2073 656c 6563 7465 645f 636f 7272 5f6c   selected_corr_l
-0005f430: 6973 742e 6170 7065 6e64 2865 6163 685f  ist.append(each_
-0005f440: 636f 7272 5f6e 616d 6529 0d0a 2020 2020  corr_name)..    
-0005f450: 2020 2020 2020 2020 666f 7220 6561 6368          for each
-0005f460: 5f72 656d 6f76 6520 696e 2063 6f72 725f  _remove in corr_
-0005f470: 7061 6972 5f64 6963 745b 6561 6368 5f63  pair_dict[each_c
-0005f480: 6f72 725f 6e61 6d65 5d3a 0d0a 2020 2020  orr_name]:..    
-0005f490: 2020 2020 2020 2020 2020 2020 2323 2323              ####
-0005f4a0: 204e 6f77 2072 656d 6f76 6520 6561 6368   Now remove each
-0005f4b0: 2076 6172 6961 626c 6520 7468 6174 2069   variable that i
-0005f4c0: 7320 6869 6768 6c79 2063 6f72 7265 6c61  s highly correla
-0005f4d0: 7465 6420 746f 2074 6865 2073 656c 6563  ted to the selec
-0005f4e0: 7465 6420 7661 7269 6162 6c65 0d0a 2020  ted variable..  
-0005f4f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0005f500: 2065 6163 685f 7265 6d6f 7665 2069 6e20   each_remove in 
-0005f510: 736f 7274 6564 5f62 795f 6d75 7475 616c  sorted_by_mutual
-0005f520: 5f69 6e66 6f3a 0d0a 2020 2020 2020 2020  _info:..        
-0005f530: 2020 2020 2020 2020 2020 2020 736f 7274              sort
-0005f540: 6564 5f62 795f 6d75 7475 616c 5f69 6e66  ed_by_mutual_inf
-0005f550: 6f2e 7265 6d6f 7665 2865 6163 685f 7265  o.remove(each_re
-0005f560: 6d6f 7665 290d 0a20 2020 2020 2020 2023  move)..        #
-0005f570: 2323 2323 204e 6f77 2077 6520 636f 6d62  #### Now we comb
-0005f580: 696e 6520 7468 6520 756e 636f 7272 656c  ine the uncorrel
-0005f590: 6174 6564 206c 6973 7420 746f 2074 6865  ated list to the
-0005f5a0: 2073 656c 6563 7465 6420 636f 7272 656c   selected correl
-0005f5b0: 6174 6564 206c 6973 7420 6162 6f76 650d  ated list above.
-0005f5c0: 0a20 2020 2020 2020 2072 656d 5f63 6f6c  .        rem_col
-0005f5d0: 5f6c 6973 7420 3d20 6c65 6674 5f73 7562  _list = left_sub
-0005f5e0: 7472 6163 7428 6c69 7374 2863 6f72 7265  tract(list(corre
-0005f5f0: 6c61 7469 6f6e 5f64 6174 6166 7261 6d65  lation_dataframe
-0005f600: 292c 636f 7272 5f6c 6973 7429 0d0a 2020  ),corr_list)..  
-0005f610: 2020 2020 2020 6669 6e61 6c5f 6c69 7374        final_list
-0005f620: 203d 2072 656d 5f63 6f6c 5f6c 6973 7420   = rem_col_list 
-0005f630: 2b20 7365 6c65 6374 6564 5f63 6f72 725f  + selected_corr_
-0005f640: 6c69 7374 0d0a 2020 2020 2020 2020 7265  list..        re
-0005f650: 6d6f 7665 645f 636f 6c73 203d 206c 6566  moved_cols = lef
-0005f660: 745f 7375 6274 7261 6374 286e 756d 7661  t_subtract(numva
-0005f670: 7273 2c20 6669 6e61 6c5f 6c69 7374 290d  rs, final_list).
-0005f680: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-0005f690: 7265 6d6f 7665 645f 636f 6c73 2920 3e20  removed_cols) > 
-0005f6a0: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
-0005f6b0: 7072 696e 7428 2720 2020 2052 656d 6f76  print('    Remov
-0005f6c0: 696e 6720 2825 6429 2068 6967 686c 7920  ing (%d) highly 
-0005f6d0: 636f 7272 656c 6174 6564 2076 6172 6961  correlated varia
-0005f6e0: 626c 6573 3a27 2025 286c 656e 2872 656d  bles:' %(len(rem
-0005f6f0: 6f76 6564 5f63 6f6c 7329 2929 0d0a 2020  oved_cols)))..  
-0005f700: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-0005f710: 2872 656d 6f76 6564 5f63 6f6c 7329 203c  (removed_cols) <
-0005f720: 3d20 3330 3a0d 0a20 2020 2020 2020 2020  = 30:..         
-0005f730: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-0005f740: 2020 2573 2720 2572 656d 6f76 6564 5f63    %s' %removed_c
-0005f750: 6f6c 7329 0d0a 2020 2020 2020 2020 2020  ols)..          
-0005f760: 2020 6966 206c 656e 2866 696e 616c 5f6c    if len(final_l
-0005f770: 6973 7429 203c 3d20 3330 3a0d 0a20 2020  ist) <= 30:..   
-0005f780: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-0005f790: 6e74 2827 2020 2020 466f 6c6c 6f77 696e  nt('    Followin
-0005f7a0: 6720 2825 6429 2076 6172 7320 7365 6c65  g (%d) vars sele
-0005f7b0: 6374 6564 3a20 2573 2720 2528 6c65 6e28  cted: %s' %(len(
-0005f7c0: 6669 6e61 6c5f 6c69 7374 292c 6669 6e61  final_list),fina
-0005f7d0: 6c5f 6c69 7374 2929 0d0a 2020 2020 7265  l_list))..    re
-0005f7e0: 7475 726e 2066 696e 616c 5f6c 6973 740d  turn final_list.
-0005f7f0: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
+0005e8c0: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
+0005e8d0: 2020 2022 2222 0d0a 2020 2020 6466 203d     """..    df =
+0005e8e0: 2063 6f70 792e 6465 6570 636f 7079 2864   copy.deepcopy(d
+0005e8f0: 6629 0d0a 2020 2020 7072 696e 7428 2752  f)..    print('R
+0005e900: 656d 6f76 696e 6720 6869 6768 6c79 2063  emoving highly c
+0005e910: 6f72 7265 6c61 7465 6420 7661 7269 6162  orrelated variab
+0005e920: 6c65 7320 7573 696e 6720 5355 4c4f 5620  les using SULOV 
+0005e930: 6d65 7468 6f64 2061 6d6f 6e67 2028 2564  method among (%d
+0005e940: 2920 6e75 6d65 7269 6320 7661 7269 6162  ) numeric variab
+0005e950: 6c65 7327 2025 6c65 6e28 6e75 6d76 6172  les' %len(numvar
+0005e960: 7329 290d 0a20 2020 2063 6f72 7265 6c61  s))..    correla
+0005e970: 7469 6f6e 5f64 6174 6166 7261 6d65 203d  tion_dataframe =
+0005e980: 2064 665b 6e75 6d76 6172 735d 2e63 6f72   df[numvars].cor
+0005e990: 7228 292e 6173 7479 7065 286e 702e 666c  r().astype(np.fl
+0005e9a0: 6f61 7431 3629 0d0a 2020 2020 6120 3d20  oat16)..    a = 
+0005e9b0: 636f 7272 656c 6174 696f 6e5f 6461 7461  correlation_data
+0005e9c0: 6672 616d 652e 7661 6c75 6573 0d0a 2020  frame.values..  
+0005e9d0: 2020 636f 6c5f 696e 6465 7820 3d20 636f    col_index = co
+0005e9e0: 7272 656c 6174 696f 6e5f 6461 7461 6672  rrelation_datafr
+0005e9f0: 616d 652e 636f 6c75 6d6e 732e 746f 6c69  ame.columns.toli
+0005ea00: 7374 2829 0d0a 2020 2020 696e 6465 785f  st()..    index_
+0005ea10: 7472 6975 7070 6572 203d 206c 6973 7428  triupper = list(
+0005ea20: 7a69 7028 6e70 2e74 7269 755f 696e 6469  zip(np.triu_indi
+0005ea30: 6365 735f 6672 6f6d 2861 2c6b 3d31 295b  ces_from(a,k=1)[
+0005ea40: 305d 2c6e 702e 7472 6975 5f69 6e64 6963  0],np.triu_indic
+0005ea50: 6573 5f66 726f 6d28 612c 6b3d 3129 5b31  es_from(a,k=1)[1
+0005ea60: 5d29 290d 0a20 2020 2068 6967 685f 636f  ]))..    high_co
+0005ea70: 7272 5f69 6e64 6578 5f6c 6973 7420 3d20  rr_index_list = 
+0005ea80: 5b78 2066 6f72 2078 2069 6e20 6e70 2e61  [x for x in np.a
+0005ea90: 7267 7768 6572 6528 6162 7328 615b 6e70  rgwhere(abs(a[np
+0005eaa0: 2e74 7269 755f 696e 6469 6365 7328 6c65  .triu_indices(le
+0005eab0: 6e28 6129 2c20 6b20 3d20 3129 5d29 3e3d  n(a), k = 1)])>=
+0005eac0: 636f 7272 5f6c 696d 6974 295d 0d0a 2020  corr_limit)]..  
+0005ead0: 2020 6c6f 775f 636f 7272 5f69 6e64 6578    low_corr_index
+0005eae0: 5f6c 6973 7420 3d20 205b 7820 666f 7220  _list =  [x for 
+0005eaf0: 7820 696e 206e 702e 6172 6777 6865 7265  x in np.argwhere
+0005eb00: 2861 6273 2861 5b6e 702e 7472 6975 5f69  (abs(a[np.triu_i
+0005eb10: 6e64 6963 6573 286c 656e 2861 292c 206b  ndices(len(a), k
+0005eb20: 203d 2031 295d 293c 636f 7272 5f6c 696d   = 1)])<corr_lim
+0005eb30: 6974 295d 0d0a 2020 2020 7475 706c 655f  it)]..    tuple_
+0005eb40: 6c69 7374 203d 205b 7920 666f 7220 7920  list = [y for y 
+0005eb50: 696e 205b 696e 6465 785f 7472 6975 7070  in [index_triupp
+0005eb60: 6572 5b78 5b30 5d5d 2066 6f72 2078 2069  er[x[0]] for x i
+0005eb70: 6e20 6869 6768 5f63 6f72 725f 696e 6465  n high_corr_inde
+0005eb80: 785f 6c69 7374 5d5d 0d0a 2020 2020 636f  x_list]]..    co
+0005eb90: 7272 656c 6174 6564 5f70 6169 7220 3d20  rrelated_pair = 
+0005eba0: 5b28 636f 6c5f 696e 6465 785b 7475 706c  [(col_index[tupl
+0005ebb0: 655b 305d 5d2c 636f 6c5f 696e 6465 785b  e[0]],col_index[
+0005ebc0: 7475 706c 655b 315d 5d29 2066 6f72 2074  tuple[1]]) for t
+0005ebd0: 7570 6c65 2069 6e20 7475 706c 655f 6c69  uple in tuple_li
+0005ebe0: 7374 5d0d 0a20 2020 2063 6f72 725f 7061  st]..    corr_pa
+0005ebf0: 6972 5f64 6963 7420 3d20 6469 6374 2872  ir_dict = dict(r
+0005ec00: 6574 7572 6e5f 6469 6374 696f 6e61 7279  eturn_dictionary
+0005ec10: 5f6c 6973 7428 636f 7272 656c 6174 6564  _list(correlated
+0005ec20: 5f70 6169 7229 290d 0a20 2020 206b 6579  _pair))..    key
+0005ec30: 735f 696e 5f64 6963 7420 3d20 6c69 7374  s_in_dict = list
+0005ec40: 2863 6f72 725f 7061 6972 5f64 6963 742e  (corr_pair_dict.
+0005ec50: 6b65 7973 2829 290d 0a20 2020 2072 6576  keys())..    rev
+0005ec60: 6572 7365 5f63 6f72 7265 6c61 7465 645f  erse_correlated_
+0005ec70: 7061 6972 203d 205b 2879 2c78 2920 666f  pair = [(y,x) fo
+0005ec80: 7220 2878 2c79 2920 696e 2063 6f72 7265  r (x,y) in corre
+0005ec90: 6c61 7465 645f 7061 6972 5d0d 0a20 2020  lated_pair]..   
+0005eca0: 2072 6576 6572 7365 5f63 6f72 725f 7061   reverse_corr_pa
+0005ecb0: 6972 5f64 6963 7420 3d20 6469 6374 2872  ir_dict = dict(r
+0005ecc0: 6574 7572 6e5f 6469 6374 696f 6e61 7279  eturn_dictionary
+0005ecd0: 5f6c 6973 7428 7265 7665 7273 655f 636f  _list(reverse_co
+0005ece0: 7272 656c 6174 6564 5f70 6169 7229 290d  rrelated_pair)).
+0005ecf0: 0a20 2020 2066 6f72 206b 6579 2c20 7661  .    for key, va
+0005ed00: 6c20 696e 2072 6576 6572 7365 5f63 6f72  l in reverse_cor
+0005ed10: 725f 7061 6972 5f64 6963 742e 6974 656d  r_pair_dict.item
+0005ed20: 7328 293a 0d0a 2020 2020 2020 2020 6966  s():..        if
+0005ed30: 206b 6579 2069 6e20 6b65 7973 5f69 6e5f   key in keys_in_
+0005ed40: 6469 6374 3a0d 0a20 2020 2020 2020 2020  dict:..         
+0005ed50: 2020 2069 6620 6c65 6e28 6b65 7929 203e     if len(key) >
+0005ed60: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
+0005ed70: 2020 2020 2063 6f72 725f 7061 6972 5f64       corr_pair_d
+0005ed80: 6963 745b 6b65 795d 202b 3d20 7661 6c0d  ict[key] += val.
+0005ed90: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+0005eda0: 2020 2020 2020 2020 2020 2020 636f 7272              corr
+0005edb0: 5f70 6169 725f 6469 6374 5b6b 6579 5d20  _pair_dict[key] 
+0005edc0: 3d20 7661 6c0d 0a20 2020 2066 6c61 745f  = val..    flat_
+0005edd0: 636f 7272 5f70 6169 725f 6c69 7374 203d  corr_pair_list =
+0005ede0: 205b 6974 656d 2066 6f72 2073 7562 6c69   [item for subli
+0005edf0: 7374 2069 6e20 636f 7272 656c 6174 6564  st in correlated
+0005ee00: 5f70 6169 7220 666f 7220 6974 656d 2069  _pair for item i
+0005ee10: 6e20 7375 626c 6973 745d 0d0a 2020 2020  n sublist]..    
+0005ee20: 2323 2323 2059 6f75 2063 616e 206d 616b  #### You can mak
+0005ee30: 6520 6974 2061 2064 6963 7469 6f6e 6172  e it a dictionar
+0005ee40: 7920 6f72 2061 2074 7570 6c65 206f 6620  y or a tuple of 
+0005ee50: 6c69 7374 732e 2057 6520 6861 7665 2063  lists. We have c
+0005ee60: 686f 7365 6e20 7468 6520 6c61 7474 6572  hosen the latter
+0005ee70: 2068 6572 6520 746f 206b 6565 7020 6f72   here to keep or
+0005ee80: 6465 7220 696e 7461 6374 2e0d 0a20 2020  der intact...   
+0005ee90: 2063 6f72 725f 7061 6972 5f63 6f75 6e74   corr_pair_count
+0005eea0: 5f64 6963 7420 3d20 636f 756e 745f 6672  _dict = count_fr
+0005eeb0: 6571 5f69 6e5f 6c69 7374 2866 6c61 745f  eq_in_list(flat_
+0005eec0: 636f 7272 5f70 6169 725f 6c69 7374 290d  corr_pair_list).
+0005eed0: 0a20 2020 2063 6f72 725f 6c69 7374 203d  .    corr_list =
+0005eee0: 205b 6b20 666f 7220 286b 2c76 2920 696e   [k for (k,v) in
+0005eef0: 2063 6f72 725f 7061 6972 5f63 6f75 6e74   corr_pair_count
+0005ef00: 5f64 6963 745d 0d0a 2020 2020 2323 2323  _dict]..    ####
+0005ef10: 2323 2054 6869 7320 6973 2066 6f72 206f  ## This is for o
+0005ef20: 7264 6572 696e 6720 7468 6520 7661 7269  rdering the vari
+0005ef30: 6162 6c65 7320 696e 2074 6865 2068 6967  ables in the hig
+0005ef40: 6865 7374 2074 6f20 6c6f 7765 7374 2069  hest to lowest i
+0005ef50: 6d70 6f72 7461 6e63 6520 746f 2074 6172  mportance to tar
+0005ef60: 6765 7420 2323 230d 0a20 2020 2069 6620  get ###..    if 
+0005ef70: 6c65 6e28 636f 7272 5f6c 6973 7429 203d  len(corr_list) =
+0005ef80: 3d20 303a 0d0a 2020 2020 2020 2020 6669  = 0:..        fi
+0005ef90: 6e61 6c5f 6c69 7374 203d 206c 6973 7428  nal_list = list(
+0005efa0: 636f 7272 656c 6174 696f 6e5f 6461 7461  correlation_data
+0005efb0: 6672 616d 6529 0d0a 2020 2020 2020 2020  frame)..        
+0005efc0: 7072 696e 7428 2720 2020 204e 6f20 6e75  print('    No nu
+0005efd0: 6d65 7269 6320 7661 7273 2072 656d 6f76  meric vars remov
+0005efe0: 6564 2073 696e 6365 206e 6f6e 6520 6861  ed since none ha
+0005eff0: 7665 2068 6967 6820 636f 7272 656c 6174  ve high correlat
+0005f000: 696f 6e20 7769 7468 2065 6163 6820 6f74  ion with each ot
+0005f010: 6865 7220 696e 2074 6869 7320 6461 7461  her in this data
+0005f020: 2e2e 2e27 290d 0a20 2020 2065 6c73 653a  ...')..    else:
+0005f030: 0d0a 2020 2020 2020 2020 6d61 785f 6665  ..        max_fe
+0005f040: 6174 7320 3d20 6c65 6e28 636f 7272 5f6c  ats = len(corr_l
+0005f050: 6973 7429 0d0a 2020 2020 2020 2020 6966  ist)..        if
+0005f060: 206d 6f64 656c 7479 7065 203d 3d20 2752   modeltype == 'R
+0005f070: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
+0005f080: 2020 2020 2020 2020 2073 656c 5f66 756e           sel_fun
+0005f090: 6374 696f 6e20 3d20 6d75 7475 616c 5f69  ction = mutual_i
+0005f0a0: 6e66 6f5f 7265 6772 6573 7369 6f6e 0d0a  nfo_regression..
+0005f0b0: 2020 2020 2020 2020 2020 2020 6673 203d              fs =
+0005f0c0: 2053 656c 6563 744b 4265 7374 2873 636f   SelectKBest(sco
+0005f0d0: 7265 5f66 756e 633d 7365 6c5f 6675 6e63  re_func=sel_func
+0005f0e0: 7469 6f6e 2c20 6b3d 6d61 785f 6665 6174  tion, k=max_feat
+0005f0f0: 7329 0d0a 2020 2020 2020 2020 656c 7365  s)..        else
+0005f100: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+0005f110: 656c 5f66 756e 6374 696f 6e20 3d20 6d75  el_function = mu
+0005f120: 7475 616c 5f69 6e66 6f5f 636c 6173 7369  tual_info_classi
+0005f130: 660d 0a20 2020 2020 2020 2020 2020 2066  f..            f
+0005f140: 7320 3d20 5365 6c65 6374 4b42 6573 7428  s = SelectKBest(
+0005f150: 7363 6f72 655f 6675 6e63 3d73 656c 5f66  score_func=sel_f
+0005f160: 756e 6374 696f 6e2c 206b 3d6d 6178 5f66  unction, k=max_f
+0005f170: 6561 7473 290d 0a20 2020 2020 2020 2066  eats)..        f
+0005f180: 732e 6669 7428 6466 5b63 6f72 725f 6c69  s.fit(df[corr_li
+0005f190: 7374 5d2e 6173 7479 7065 286e 702e 666c  st].astype(np.fl
+0005f1a0: 6f61 7431 3629 2c20 6466 5b74 6172 6765  oat16), df[targe
+0005f1b0: 745d 290d 0a20 2020 2020 2020 206d 7574  t])..        mut
+0005f1c0: 7561 6c5f 696e 666f 203d 2064 6963 7428  ual_info = dict(
+0005f1d0: 7a69 7028 636f 7272 5f6c 6973 742c 6673  zip(corr_list,fs
+0005f1e0: 2e73 636f 7265 735f 2929 0d0a 2020 2020  .scores_))..    
+0005f1f0: 2020 2020 2323 2323 2054 6865 2066 6972      #### The fir
+0005f200: 7374 2076 6172 6961 626c 6520 696e 206c  st variable in l
+0005f210: 6973 7420 6861 7320 7468 6520 6869 6768  ist has the high
+0005f220: 6573 7420 636f 7272 656c 6174 696f 6e20  est correlation 
+0005f230: 746f 2074 6865 2074 6172 6765 7420 7661  to the target va
+0005f240: 7269 6162 6c65 2023 2323 0d0a 2020 2020  riable ###..    
+0005f250: 2020 2020 736f 7274 6564 5f62 795f 6d75      sorted_by_mu
+0005f260: 7475 616c 5f69 6e66 6f20 3d5b 6b65 7920  tual_info =[key 
+0005f270: 666f 7220 286b 6579 2c76 616c 2920 696e  for (key,val) in
+0005f280: 2073 6f72 7465 6428 6d75 7475 616c 5f69   sorted(mutual_i
+0005f290: 6e66 6f2e 6974 656d 7328 292c 206b 6579  nfo.items(), key
+0005f2a0: 3d6c 616d 6264 6120 6b76 3a20 6b76 5b31  =lambda kv: kv[1
+0005f2b0: 5d2c 7265 7665 7273 653d 5472 7565 295d  ],reverse=True)]
+0005f2c0: 0d0a 2020 2020 2020 2020 2323 2323 2320  ..        ##### 
+0005f2d0: 2020 4e6f 7720 7765 2073 656c 6563 7420    Now we select 
+0005f2e0: 7468 6520 6669 6e61 6c20 6c69 7374 206f  the final list o
+0005f2f0: 6620 636f 7272 656c 6174 6564 2076 6172  f correlated var
+0005f300: 6961 626c 6573 2023 2323 2323 2323 2323  iables #########
+0005f310: 2323 0d0a 2020 2020 2020 2020 7365 6c65  ##..        sele
+0005f320: 6374 6564 5f63 6f72 725f 6c69 7374 203d  cted_corr_list =
+0005f330: 205b 5d0d 0a20 2020 2020 2020 2023 2323   []..        ###
+0005f340: 2320 7365 6c65 6374 2065 6163 6820 7661  # select each va
+0005f350: 7269 6162 6c65 2062 7920 7468 6520 6869  riable by the hi
+0005f360: 6768 6573 7420 6d75 7475 616c 2069 6e66  ghest mutual inf
+0005f370: 6f20 616e 6420 7365 6520 7768 6174 2076  o and see what v
+0005f380: 6172 7320 6172 6520 636f 7272 656c 6174  ars are correlat
+0005f390: 6564 2074 6f20 6974 0d0a 2020 2020 2020  ed to it..      
+0005f3a0: 2020 666f 7220 6561 6368 5f63 6f72 725f    for each_corr_
+0005f3b0: 6e61 6d65 2069 6e20 736f 7274 6564 5f62  name in sorted_b
+0005f3c0: 795f 6d75 7475 616c 5f69 6e66 6f3a 0d0a  y_mutual_info:..
+0005f3d0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+0005f3e0: 6164 6420 7468 6520 7365 6c65 6374 6564  add the selected
+0005f3f0: 2076 6172 2074 6f20 7468 6520 7365 6c65   var to the sele
+0005f400: 6374 6564 5f63 6f72 725f 6c69 7374 0d0a  cted_corr_list..
+0005f410: 2020 2020 2020 2020 2020 2020 7365 6c65              sele
+0005f420: 6374 6564 5f63 6f72 725f 6c69 7374 2e61  cted_corr_list.a
+0005f430: 7070 656e 6428 6561 6368 5f63 6f72 725f  ppend(each_corr_
+0005f440: 6e61 6d65 290d 0a20 2020 2020 2020 2020  name)..         
+0005f450: 2020 2066 6f72 2065 6163 685f 7265 6d6f     for each_remo
+0005f460: 7665 2069 6e20 636f 7272 5f70 6169 725f  ve in corr_pair_
+0005f470: 6469 6374 5b65 6163 685f 636f 7272 5f6e  dict[each_corr_n
+0005f480: 616d 655d 3a0d 0a20 2020 2020 2020 2020  ame]:..         
+0005f490: 2020 2020 2020 2023 2323 2320 4e6f 7720         #### Now 
+0005f4a0: 7265 6d6f 7665 2065 6163 6820 7661 7269  remove each vari
+0005f4b0: 6162 6c65 2074 6861 7420 6973 2068 6967  able that is hig
+0005f4c0: 686c 7920 636f 7272 656c 6174 6564 2074  hly correlated t
+0005f4d0: 6f20 7468 6520 7365 6c65 6374 6564 2076  o the selected v
+0005f4e0: 6172 6961 626c 650d 0a20 2020 2020 2020  ariable..       
+0005f4f0: 2020 2020 2020 2020 2069 6620 6561 6368           if each
+0005f500: 5f72 656d 6f76 6520 696e 2073 6f72 7465  _remove in sorte
+0005f510: 645f 6279 5f6d 7574 7561 6c5f 696e 666f  d_by_mutual_info
+0005f520: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0005f530: 2020 2020 2020 2073 6f72 7465 645f 6279         sorted_by
+0005f540: 5f6d 7574 7561 6c5f 696e 666f 2e72 656d  _mutual_info.rem
+0005f550: 6f76 6528 6561 6368 5f72 656d 6f76 6529  ove(each_remove)
+0005f560: 0d0a 2020 2020 2020 2020 2323 2323 2320  ..        ##### 
+0005f570: 4e6f 7720 7765 2063 6f6d 6269 6e65 2074  Now we combine t
+0005f580: 6865 2075 6e63 6f72 7265 6c61 7465 6420  he uncorrelated 
+0005f590: 6c69 7374 2074 6f20 7468 6520 7365 6c65  list to the sele
+0005f5a0: 6374 6564 2063 6f72 7265 6c61 7465 6420  cted correlated 
+0005f5b0: 6c69 7374 2061 626f 7665 0d0a 2020 2020  list above..    
+0005f5c0: 2020 2020 7265 6d5f 636f 6c5f 6c69 7374      rem_col_list
+0005f5d0: 203d 206c 6566 745f 7375 6274 7261 6374   = left_subtract
+0005f5e0: 286c 6973 7428 636f 7272 656c 6174 696f  (list(correlatio
+0005f5f0: 6e5f 6461 7461 6672 616d 6529 2c63 6f72  n_dataframe),cor
+0005f600: 725f 6c69 7374 290d 0a20 2020 2020 2020  r_list)..       
+0005f610: 2066 696e 616c 5f6c 6973 7420 3d20 7265   final_list = re
+0005f620: 6d5f 636f 6c5f 6c69 7374 202b 2073 656c  m_col_list + sel
+0005f630: 6563 7465 645f 636f 7272 5f6c 6973 740d  ected_corr_list.
+0005f640: 0a20 2020 2020 2020 2072 656d 6f76 6564  .        removed
+0005f650: 5f63 6f6c 7320 3d20 6c65 6674 5f73 7562  _cols = left_sub
+0005f660: 7472 6163 7428 6e75 6d76 6172 732c 2066  tract(numvars, f
+0005f670: 696e 616c 5f6c 6973 7429 0d0a 2020 2020  inal_list)..    
+0005f680: 2020 2020 6966 206c 656e 2872 656d 6f76      if len(remov
+0005f690: 6564 5f63 6f6c 7329 203e 2030 3a0d 0a20  ed_cols) > 0:.. 
+0005f6a0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0005f6b0: 2827 2020 2020 5265 6d6f 7669 6e67 2028  ('    Removing (
+0005f6c0: 2564 2920 6869 6768 6c79 2063 6f72 7265  %d) highly corre
+0005f6d0: 6c61 7465 6420 7661 7269 6162 6c65 733a  lated variables:
+0005f6e0: 2720 2528 6c65 6e28 7265 6d6f 7665 645f  ' %(len(removed_
+0005f6f0: 636f 6c73 2929 290d 0a20 2020 2020 2020  cols)))..       
+0005f700: 2020 2020 2069 6620 6c65 6e28 7265 6d6f       if len(remo
+0005f710: 7665 645f 636f 6c73 2920 3c3d 2033 303a  ved_cols) <= 30:
+0005f720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0005f730: 2020 7072 696e 7428 2720 2020 2025 7327    print('    %s'
+0005f740: 2025 7265 6d6f 7665 645f 636f 6c73 290d   %removed_cols).
+0005f750: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0005f760: 6c65 6e28 6669 6e61 6c5f 6c69 7374 2920  len(final_list) 
+0005f770: 3c3d 2033 303a 0d0a 2020 2020 2020 2020  <= 30:..        
+0005f780: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+0005f790: 2020 2046 6f6c 6c6f 7769 6e67 2028 2564     Following (%d
+0005f7a0: 2920 7661 7273 2073 656c 6563 7465 643a  ) vars selected:
+0005f7b0: 2025 7327 2025 286c 656e 2866 696e 616c   %s' %(len(final
+0005f7c0: 5f6c 6973 7429 2c66 696e 616c 5f6c 6973  _list),final_lis
+0005f7d0: 7429 290d 0a20 2020 2072 6574 7572 6e20  t))..    return 
+0005f7e0: 6669 6e61 6c5f 6c69 7374 0d0a 2323 2323  final_list..####
+0005f7f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005f800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005f810: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005f820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005f830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005f840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0005f850: 0d0a 6465 6620 636f 756e 745f 6672 6571  ..def count_freq
-0005f860: 5f69 6e5f 6c69 7374 286c 7374 293a 0d0a  _in_list(lst):..
-0005f870: 2020 2020 2222 220d 0a20 2020 2054 6869      """..    Thi
-0005f880: 7320 636f 756e 7473 2074 6865 2066 7265  s counts the fre
-0005f890: 7175 656e 6379 206f 6620 6974 656d 7320  quency of items 
-0005f8a0: 696e 2061 206c 6973 7420 6275 7420 4d41  in a list but MA
-0005f8b0: 494e 5441 494e 5320 7468 6520 6f72 6465  INTAINS the orde
-0005f8c0: 7220 6f66 2061 7070 6561 7261 6e63 6520  r of appearance 
-0005f8d0: 6f66 2069 7465 6d73 2e0d 0a20 2020 2054  of items...    T
-0005f8e0: 6869 7320 6f72 6465 7220 6973 2076 6572  his order is ver
-0005f8f0: 7920 696d 706f 7274 616e 7420 7768 656e  y important when
-0005f900: 2079 6f75 2061 7265 2064 6f69 6e67 2063   you are doing c
-0005f910: 6572 7461 696e 2066 756e 6374 696f 6e73  ertain functions
-0005f920: 2e20 4865 6e63 6520 7468 6973 2066 756e  . Hence this fun
-0005f930: 6374 696f 6e21 0d0a 2020 2020 2222 220d  ction!..    """.
-0005f940: 0a20 2020 2074 656d 703d 6e70 2e75 6e69  .    temp=np.uni
-0005f950: 7175 6528 6c73 7429 0d0a 2020 2020 7265  que(lst)..    re
-0005f960: 7375 6c74 203d 205b 5d0d 0a20 2020 2066  sult = []..    f
-0005f970: 6f72 2069 2069 6e20 7465 6d70 3a0d 0a20  or i in temp:.. 
-0005f980: 2020 2020 2020 2072 6573 756c 742e 6170         result.ap
-0005f990: 7065 6e64 2828 692c 6c73 742e 636f 756e  pend((i,lst.coun
-0005f9a0: 7428 6929 2929 0d0a 2020 2020 7265 7475  t(i)))..    retu
-0005f9b0: 726e 2072 6573 756c 740d 0a0d 0a64 6566  rn result....def
-0005f9c0: 2066 696e 645f 636f 7272 5f76 6172 7328   find_corr_vars(
-0005f9d0: 636f 7272 656c 6174 696f 6e5f 6461 7461  correlation_data
-0005f9e0: 6672 616d 652c 636f 7272 5f6c 696d 6974  frame,corr_limit
-0005f9f0: 203d 2030 2e37 3029 3a0d 0a20 2020 2022   = 0.70):..    "
-0005fa00: 2222 0d0a 2020 2020 5468 6973 2072 6574  ""..    This ret
-0005fa10: 7572 6e73 2061 2064 6963 7469 6f6e 6172  urns a dictionar
-0005fa20: 7920 6f66 2063 6f75 6e74 7320 6f66 2065  y of counts of e
-0005fa30: 6163 6820 7661 7269 6162 6c65 2061 6e64  ach variable and
-0005fa40: 2068 6f77 206d 616e 7920 7661 7273 2069   how many vars i
-0005fa50: 7420 6973 2063 6f72 7265 6c61 7465 6420  t is correlated 
-0005fa60: 746f 2069 6e20 7468 6520 6461 7461 6672  to in the datafr
-0005fa70: 616d 650d 0a20 2020 2022 2222 0d0a 2020  ame..    """..  
-0005fa80: 2020 666c 6174 7465 6e20 3d20 6c61 6d62    flatten = lamb
-0005fa90: 6461 206c 3a20 5b69 7465 6d20 666f 7220  da l: [item for 
-0005faa0: 7375 626c 6973 7420 696e 206c 2066 6f72  sublist in l for
-0005fab0: 2069 7465 6d20 696e 2073 7562 6c69 7374   item in sublist
-0005fac0: 5d0d 0a20 2020 2066 6c61 7474 656e 5f69  ]..    flatten_i
-0005fad0: 7465 6d73 203d 206c 616d 6264 6120 6469  tems = lambda di
-0005fae0: 633a 205b 7820 666f 7220 7820 696e 2064  c: [x for x in d
-0005faf0: 6963 2e69 7465 6d73 2829 5d0d 0a20 2020  ic.items()]..   
-0005fb00: 2061 203d 2063 6f72 7265 6c61 7469 6f6e   a = correlation
-0005fb10: 5f64 6174 6166 7261 6d65 2e76 616c 7565  _dataframe.value
-0005fb20: 730d 0a20 2020 2063 6f6c 5f69 6e64 6578  s..    col_index
-0005fb30: 203d 2063 6f72 7265 6c61 7469 6f6e 5f64   = correlation_d
-0005fb40: 6174 6166 7261 6d65 2e63 6f6c 756d 6e73  ataframe.columns
-0005fb50: 2e74 6f6c 6973 7428 290d 0a20 2020 2069  .tolist()..    i
-0005fb60: 6e64 6578 5f74 7269 7570 7065 7220 3d20  ndex_triupper = 
-0005fb70: 6c69 7374 287a 6970 286e 702e 7472 6975  list(zip(np.triu
-0005fb80: 5f69 6e64 6963 6573 5f66 726f 6d28 612c  _indices_from(a,
-0005fb90: 6b3d 3129 5b30 5d2c 6e70 2e74 7269 755f  k=1)[0],np.triu_
-0005fba0: 696e 6469 6365 735f 6672 6f6d 2861 2c6b  indices_from(a,k
-0005fbb0: 3d31 295b 315d 2929 0d0a 2020 2020 6869  =1)[1]))..    hi
-0005fbc0: 6768 5f63 6f72 725f 696e 6465 785f 6c69  gh_corr_index_li
-0005fbd0: 7374 203d 205b 7820 666f 7220 7820 696e  st = [x for x in
-0005fbe0: 206e 702e 6172 6777 6865 7265 2861 6273   np.argwhere(abs
-0005fbf0: 2861 5b6e 702e 7472 6975 5f69 6e64 6963  (a[np.triu_indic
-0005fc00: 6573 286c 656e 2861 292c 206b 203d 2031  es(len(a), k = 1
-0005fc10: 295d 293e 3d63 6f72 725f 6c69 6d69 7429  )])>=corr_limit)
-0005fc20: 5d0d 0a20 2020 206c 6f77 5f63 6f72 725f  ]..    low_corr_
-0005fc30: 696e 6465 785f 6c69 7374 203d 2020 5b78  index_list =  [x
-0005fc40: 2066 6f72 2078 2069 6e20 6e70 2e61 7267   for x in np.arg
-0005fc50: 7768 6572 6528 6162 7328 615b 6e70 2e74  where(abs(a[np.t
-0005fc60: 7269 755f 696e 6469 6365 7328 6c65 6e28  riu_indices(len(
-0005fc70: 6129 2c20 6b20 3d20 3129 5d29 3c63 6f72  a), k = 1)])<cor
-0005fc80: 725f 6c69 6d69 7429 5d0d 0a20 2020 2074  r_limit)]..    t
-0005fc90: 7570 6c65 5f6c 6973 7420 3d20 5b79 2066  uple_list = [y f
-0005fca0: 6f72 2079 2069 6e20 5b69 6e64 6578 5f74  or y in [index_t
-0005fcb0: 7269 7570 7065 725b 785b 305d 5d20 666f  riupper[x[0]] fo
-0005fcc0: 7220 7820 696e 2068 6967 685f 636f 7272  r x in high_corr
-0005fcd0: 5f69 6e64 6578 5f6c 6973 745d 5d0d 0a20  _index_list]].. 
-0005fce0: 2020 2063 6f72 7265 6c61 7465 645f 7061     correlated_pa
-0005fcf0: 6972 203d 205b 2863 6f6c 5f69 6e64 6578  ir = [(col_index
-0005fd00: 5b74 7570 6c65 5b30 5d5d 2c63 6f6c 5f69  [tuple[0]],col_i
-0005fd10: 6e64 6578 5b74 7570 6c65 5b31 5d5d 2920  ndex[tuple[1]]) 
-0005fd20: 666f 7220 7475 706c 6520 696e 2074 7570  for tuple in tup
-0005fd30: 6c65 5f6c 6973 745d 0d0a 2020 2020 636f  le_list]..    co
-0005fd40: 7272 656c 6174 6564 5f70 6169 725f 6469  rrelated_pair_di
-0005fd50: 6374 203d 2064 6963 7428 636f 7272 656c  ct = dict(correl
-0005fd60: 6174 6564 5f70 6169 7229 0d0a 2020 2020  ated_pair)..    
-0005fd70: 666c 6174 5f63 6f72 725f 7061 6972 5f6c  flat_corr_pair_l
-0005fd80: 6973 7420 3d20 5b69 7465 6d20 666f 7220  ist = [item for 
-0005fd90: 7375 626c 6973 7420 696e 2063 6f72 7265  sublist in corre
-0005fda0: 6c61 7465 645f 7061 6972 2066 6f72 2069  lated_pair for i
-0005fdb0: 7465 6d20 696e 2073 7562 6c69 7374 5d0d  tem in sublist].
-0005fdc0: 0a20 2020 2023 2323 2320 596f 7520 6361  .    #### You ca
-0005fdd0: 6e20 6d61 6b65 2069 7420 6120 6469 6374  n make it a dict
-0005fde0: 696f 6e61 7279 206f 7220 6120 7475 706c  ionary or a tupl
-0005fdf0: 6520 6f66 206c 6973 7473 2e20 5765 2068  e of lists. We h
-0005fe00: 6176 6520 6368 6f73 656e 2074 6865 206c  ave chosen the l
-0005fe10: 6174 7465 7220 6865 7265 2074 6f20 6b65  atter here to ke
-0005fe20: 6570 206f 7264 6572 2069 6e74 6163 742e  ep order intact.
-0005fe30: 0d0a 2020 2020 2363 6f72 725f 7061 6972  ..    #corr_pair
-0005fe40: 5f63 6f75 6e74 5f64 6963 7420 3d20 436f  _count_dict = Co
-0005fe50: 756e 7465 7228 666c 6174 5f63 6f72 725f  unter(flat_corr_
-0005fe60: 7061 6972 5f6c 6973 7429 0d0a 2020 2020  pair_list)..    
-0005fe70: 636f 7272 5f70 6169 725f 636f 756e 745f  corr_pair_count_
-0005fe80: 6469 6374 203d 2063 6f75 6e74 5f66 7265  dict = count_fre
-0005fe90: 715f 696e 5f6c 6973 7428 666c 6174 5f63  q_in_list(flat_c
-0005fea0: 6f72 725f 7061 6972 5f6c 6973 7429 0d0a  orr_pair_list)..
-0005feb0: 2020 2020 636f 7272 5f6c 6973 7420 3d20      corr_list = 
-0005fec0: 6c69 7374 2873 6574 2866 6c61 7474 656e  list(set(flatten
-0005fed0: 2866 6c61 7474 656e 5f69 7465 6d73 2863  (flatten_items(c
-0005fee0: 6f72 7265 6c61 7465 645f 7061 6972 5f64  orrelated_pair_d
-0005fef0: 6963 7429 2929 290d 0a20 2020 2072 656d  ict))))..    rem
-0005ff00: 5f63 6f6c 5f6c 6973 7420 3d20 6c65 6674  _col_list = left
-0005ff10: 5f73 7562 7472 6163 7428 6c69 7374 2863  _subtract(list(c
-0005ff20: 6f72 7265 6c61 7469 6f6e 5f64 6174 6166  orrelation_dataf
-0005ff30: 7261 6d65 292c 6c69 7374 284f 7264 6572  rame),list(Order
-0005ff40: 6564 4469 6374 2e66 726f 6d6b 6579 7328  edDict.fromkeys(
-0005ff50: 666c 6174 5f63 6f72 725f 7061 6972 5f6c  flat_corr_pair_l
-0005ff60: 6973 7429 2929 0d0a 2020 2020 7265 7475  ist)))..    retu
-0005ff70: 726e 2063 6f72 725f 7061 6972 5f63 6f75  rn corr_pair_cou
-0005ff80: 6e74 5f64 6963 742c 2072 656d 5f63 6f6c  nt_dict, rem_col
-0005ff90: 5f6c 6973 742c 2063 6f72 725f 6c69 7374  _list, corr_list
-0005ffa0: 2c20 636f 7272 656c 6174 6564 5f70 6169  , correlated_pai
-0005ffb0: 725f 6469 6374 0d0a 2323 2323 2323 2323  r_dict..########
+0005f840: 2323 2323 2323 2323 2323 230d 0a64 6566  ###########..def
+0005f850: 2063 6f75 6e74 5f66 7265 715f 696e 5f6c   count_freq_in_l
+0005f860: 6973 7428 6c73 7429 3a0d 0a20 2020 2022  ist(lst):..    "
+0005f870: 2222 0d0a 2020 2020 5468 6973 2063 6f75  ""..    This cou
+0005f880: 6e74 7320 7468 6520 6672 6571 7565 6e63  nts the frequenc
+0005f890: 7920 6f66 2069 7465 6d73 2069 6e20 6120  y of items in a 
+0005f8a0: 6c69 7374 2062 7574 204d 4149 4e54 4149  list but MAINTAI
+0005f8b0: 4e53 2074 6865 206f 7264 6572 206f 6620  NS the order of 
+0005f8c0: 6170 7065 6172 616e 6365 206f 6620 6974  appearance of it
+0005f8d0: 656d 732e 0d0a 2020 2020 5468 6973 206f  ems...    This o
+0005f8e0: 7264 6572 2069 7320 7665 7279 2069 6d70  rder is very imp
+0005f8f0: 6f72 7461 6e74 2077 6865 6e20 796f 7520  ortant when you 
+0005f900: 6172 6520 646f 696e 6720 6365 7274 6169  are doing certai
+0005f910: 6e20 6675 6e63 7469 6f6e 732e 2048 656e  n functions. Hen
+0005f920: 6365 2074 6869 7320 6675 6e63 7469 6f6e  ce this function
+0005f930: 210d 0a20 2020 2022 2222 0d0a 2020 2020  !..    """..    
+0005f940: 7465 6d70 3d6e 702e 756e 6971 7565 286c  temp=np.unique(l
+0005f950: 7374 290d 0a20 2020 2072 6573 756c 7420  st)..    result 
+0005f960: 3d20 5b5d 0d0a 2020 2020 666f 7220 6920  = []..    for i 
+0005f970: 696e 2074 656d 703a 0d0a 2020 2020 2020  in temp:..      
+0005f980: 2020 7265 7375 6c74 2e61 7070 656e 6428    result.append(
+0005f990: 2869 2c6c 7374 2e63 6f75 6e74 2869 2929  (i,lst.count(i))
+0005f9a0: 290d 0a20 2020 2072 6574 7572 6e20 7265  )..    return re
+0005f9b0: 7375 6c74 0d0a 0d0a 6465 6620 6669 6e64  sult....def find
+0005f9c0: 5f63 6f72 725f 7661 7273 2863 6f72 7265  _corr_vars(corre
+0005f9d0: 6c61 7469 6f6e 5f64 6174 6166 7261 6d65  lation_dataframe
+0005f9e0: 2c63 6f72 725f 6c69 6d69 7420 3d20 302e  ,corr_limit = 0.
+0005f9f0: 3730 293a 0d0a 2020 2020 2222 220d 0a20  70):..    """.. 
+0005fa00: 2020 2054 6869 7320 7265 7475 726e 7320     This returns 
+0005fa10: 6120 6469 6374 696f 6e61 7279 206f 6620  a dictionary of 
+0005fa20: 636f 756e 7473 206f 6620 6561 6368 2076  counts of each v
+0005fa30: 6172 6961 626c 6520 616e 6420 686f 7720  ariable and how 
+0005fa40: 6d61 6e79 2076 6172 7320 6974 2069 7320  many vars it is 
+0005fa50: 636f 7272 656c 6174 6564 2074 6f20 696e  correlated to in
+0005fa60: 2074 6865 2064 6174 6166 7261 6d65 0d0a   the dataframe..
+0005fa70: 2020 2020 2222 220d 0a20 2020 2066 6c61      """..    fla
+0005fa80: 7474 656e 203d 206c 616d 6264 6120 6c3a  tten = lambda l:
+0005fa90: 205b 6974 656d 2066 6f72 2073 7562 6c69   [item for subli
+0005faa0: 7374 2069 6e20 6c20 666f 7220 6974 656d  st in l for item
+0005fab0: 2069 6e20 7375 626c 6973 745d 0d0a 2020   in sublist]..  
+0005fac0: 2020 666c 6174 7465 6e5f 6974 656d 7320    flatten_items 
+0005fad0: 3d20 6c61 6d62 6461 2064 6963 3a20 5b78  = lambda dic: [x
+0005fae0: 2066 6f72 2078 2069 6e20 6469 632e 6974   for x in dic.it
+0005faf0: 656d 7328 295d 0d0a 2020 2020 6120 3d20  ems()]..    a = 
+0005fb00: 636f 7272 656c 6174 696f 6e5f 6461 7461  correlation_data
+0005fb10: 6672 616d 652e 7661 6c75 6573 0d0a 2020  frame.values..  
+0005fb20: 2020 636f 6c5f 696e 6465 7820 3d20 636f    col_index = co
+0005fb30: 7272 656c 6174 696f 6e5f 6461 7461 6672  rrelation_datafr
+0005fb40: 616d 652e 636f 6c75 6d6e 732e 746f 6c69  ame.columns.toli
+0005fb50: 7374 2829 0d0a 2020 2020 696e 6465 785f  st()..    index_
+0005fb60: 7472 6975 7070 6572 203d 206c 6973 7428  triupper = list(
+0005fb70: 7a69 7028 6e70 2e74 7269 755f 696e 6469  zip(np.triu_indi
+0005fb80: 6365 735f 6672 6f6d 2861 2c6b 3d31 295b  ces_from(a,k=1)[
+0005fb90: 305d 2c6e 702e 7472 6975 5f69 6e64 6963  0],np.triu_indic
+0005fba0: 6573 5f66 726f 6d28 612c 6b3d 3129 5b31  es_from(a,k=1)[1
+0005fbb0: 5d29 290d 0a20 2020 2068 6967 685f 636f  ]))..    high_co
+0005fbc0: 7272 5f69 6e64 6578 5f6c 6973 7420 3d20  rr_index_list = 
+0005fbd0: 5b78 2066 6f72 2078 2069 6e20 6e70 2e61  [x for x in np.a
+0005fbe0: 7267 7768 6572 6528 6162 7328 615b 6e70  rgwhere(abs(a[np
+0005fbf0: 2e74 7269 755f 696e 6469 6365 7328 6c65  .triu_indices(le
+0005fc00: 6e28 6129 2c20 6b20 3d20 3129 5d29 3e3d  n(a), k = 1)])>=
+0005fc10: 636f 7272 5f6c 696d 6974 295d 0d0a 2020  corr_limit)]..  
+0005fc20: 2020 6c6f 775f 636f 7272 5f69 6e64 6578    low_corr_index
+0005fc30: 5f6c 6973 7420 3d20 205b 7820 666f 7220  _list =  [x for 
+0005fc40: 7820 696e 206e 702e 6172 6777 6865 7265  x in np.argwhere
+0005fc50: 2861 6273 2861 5b6e 702e 7472 6975 5f69  (abs(a[np.triu_i
+0005fc60: 6e64 6963 6573 286c 656e 2861 292c 206b  ndices(len(a), k
+0005fc70: 203d 2031 295d 293c 636f 7272 5f6c 696d   = 1)])<corr_lim
+0005fc80: 6974 295d 0d0a 2020 2020 7475 706c 655f  it)]..    tuple_
+0005fc90: 6c69 7374 203d 205b 7920 666f 7220 7920  list = [y for y 
+0005fca0: 696e 205b 696e 6465 785f 7472 6975 7070  in [index_triupp
+0005fcb0: 6572 5b78 5b30 5d5d 2066 6f72 2078 2069  er[x[0]] for x i
+0005fcc0: 6e20 6869 6768 5f63 6f72 725f 696e 6465  n high_corr_inde
+0005fcd0: 785f 6c69 7374 5d5d 0d0a 2020 2020 636f  x_list]]..    co
+0005fce0: 7272 656c 6174 6564 5f70 6169 7220 3d20  rrelated_pair = 
+0005fcf0: 5b28 636f 6c5f 696e 6465 785b 7475 706c  [(col_index[tupl
+0005fd00: 655b 305d 5d2c 636f 6c5f 696e 6465 785b  e[0]],col_index[
+0005fd10: 7475 706c 655b 315d 5d29 2066 6f72 2074  tuple[1]]) for t
+0005fd20: 7570 6c65 2069 6e20 7475 706c 655f 6c69  uple in tuple_li
+0005fd30: 7374 5d0d 0a20 2020 2063 6f72 7265 6c61  st]..    correla
+0005fd40: 7465 645f 7061 6972 5f64 6963 7420 3d20  ted_pair_dict = 
+0005fd50: 6469 6374 2863 6f72 7265 6c61 7465 645f  dict(correlated_
+0005fd60: 7061 6972 290d 0a20 2020 2066 6c61 745f  pair)..    flat_
+0005fd70: 636f 7272 5f70 6169 725f 6c69 7374 203d  corr_pair_list =
+0005fd80: 205b 6974 656d 2066 6f72 2073 7562 6c69   [item for subli
+0005fd90: 7374 2069 6e20 636f 7272 656c 6174 6564  st in correlated
+0005fda0: 5f70 6169 7220 666f 7220 6974 656d 2069  _pair for item i
+0005fdb0: 6e20 7375 626c 6973 745d 0d0a 2020 2020  n sublist]..    
+0005fdc0: 2323 2323 2059 6f75 2063 616e 206d 616b  #### You can mak
+0005fdd0: 6520 6974 2061 2064 6963 7469 6f6e 6172  e it a dictionar
+0005fde0: 7920 6f72 2061 2074 7570 6c65 206f 6620  y or a tuple of 
+0005fdf0: 6c69 7374 732e 2057 6520 6861 7665 2063  lists. We have c
+0005fe00: 686f 7365 6e20 7468 6520 6c61 7474 6572  hosen the latter
+0005fe10: 2068 6572 6520 746f 206b 6565 7020 6f72   here to keep or
+0005fe20: 6465 7220 696e 7461 6374 2e0d 0a20 2020  der intact...   
+0005fe30: 2023 636f 7272 5f70 6169 725f 636f 756e   #corr_pair_coun
+0005fe40: 745f 6469 6374 203d 2043 6f75 6e74 6572  t_dict = Counter
+0005fe50: 2866 6c61 745f 636f 7272 5f70 6169 725f  (flat_corr_pair_
+0005fe60: 6c69 7374 290d 0a20 2020 2063 6f72 725f  list)..    corr_
+0005fe70: 7061 6972 5f63 6f75 6e74 5f64 6963 7420  pair_count_dict 
+0005fe80: 3d20 636f 756e 745f 6672 6571 5f69 6e5f  = count_freq_in_
+0005fe90: 6c69 7374 2866 6c61 745f 636f 7272 5f70  list(flat_corr_p
+0005fea0: 6169 725f 6c69 7374 290d 0a20 2020 2063  air_list)..    c
+0005feb0: 6f72 725f 6c69 7374 203d 206c 6973 7428  orr_list = list(
+0005fec0: 7365 7428 666c 6174 7465 6e28 666c 6174  set(flatten(flat
+0005fed0: 7465 6e5f 6974 656d 7328 636f 7272 656c  ten_items(correl
+0005fee0: 6174 6564 5f70 6169 725f 6469 6374 2929  ated_pair_dict))
+0005fef0: 2929 0d0a 2020 2020 7265 6d5f 636f 6c5f  ))..    rem_col_
+0005ff00: 6c69 7374 203d 206c 6566 745f 7375 6274  list = left_subt
+0005ff10: 7261 6374 286c 6973 7428 636f 7272 656c  ract(list(correl
+0005ff20: 6174 696f 6e5f 6461 7461 6672 616d 6529  ation_dataframe)
+0005ff30: 2c6c 6973 7428 4f72 6465 7265 6444 6963  ,list(OrderedDic
+0005ff40: 742e 6672 6f6d 6b65 7973 2866 6c61 745f  t.fromkeys(flat_
+0005ff50: 636f 7272 5f70 6169 725f 6c69 7374 2929  corr_pair_list))
+0005ff60: 290d 0a20 2020 2072 6574 7572 6e20 636f  )..    return co
+0005ff70: 7272 5f70 6169 725f 636f 756e 745f 6469  rr_pair_count_di
+0005ff80: 6374 2c20 7265 6d5f 636f 6c5f 6c69 7374  ct, rem_col_list
+0005ff90: 2c20 636f 7272 5f6c 6973 742c 2063 6f72  , corr_list, cor
+0005ffa0: 7265 6c61 7465 645f 7061 6972 5f64 6963  related_pair_dic
+0005ffb0: 740d 0a23 2323 2323 2323 2323 2323 2323  t..#############
 0005ffc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005ffd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005ffe0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0005fff0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00060000: 2323 2323 2323 2323 0d0a 6672 6f6d 2073  ########..from s
-00060010: 6b6c 6561 726e 2e6c 696e 6561 725f 6d6f  klearn.linear_mo
-00060020: 6465 6c20 696d 706f 7274 204c 6f67 6973  del import Logis
-00060030: 7469 6352 6567 7265 7373 696f 6e0d 0a66  ticRegression..f
-00060040: 726f 6d20 736b 6c65 6172 6e2e 7072 6570  rom sklearn.prep
-00060050: 726f 6365 7373 696e 6720 696d 706f 7274  rocessing import
-00060060: 2053 7461 6e64 6172 6453 6361 6c65 720d   StandardScaler.
-00060070: 0a66 726f 6d20 736b 6c65 6172 6e2e 6c69  .from sklearn.li
-00060080: 6e65 6172 5f6d 6f64 656c 2069 6d70 6f72  near_model impor
-00060090: 7420 4c61 7373 6f0d 0a66 726f 6d20 736b  t Lasso..from sk
-000600a0: 6c65 6172 6e2e 7072 6570 726f 6365 7373  learn.preprocess
-000600b0: 696e 6720 696d 706f 7274 2050 6f6c 796e  ing import Polyn
-000600c0: 6f6d 6961 6c46 6561 7475 7265 730d 0a66  omialFeatures..f
-000600d0: 726f 6d20 736b 6c65 6172 6e2e 6d6f 6465  rom sklearn.mode
-000600e0: 6c5f 7365 6c65 6374 696f 6e20 696d 706f  l_selection impo
-000600f0: 7274 2047 7269 6453 6561 7263 6843 560d  rt GridSearchCV.
-00060100: 0a0d 0a64 6566 2061 6464 5f70 6f6c 795f  ...def add_poly_
-00060110: 7661 7273 5f73 656c 6563 7428 6461 7461  vars_select(data
-00060120: 2c6e 756d 7661 7273 2c74 6172 6765 7476  ,numvars,targetv
-00060130: 6172 2c6d 6f64 656c 7479 7065 2c70 6f6c  ar,modeltype,pol
-00060140: 795f 6465 6772 6565 3d32 2c41 6464 5f50  y_degree=2,Add_P
-00060150: 6f6c 793d 322c 6d64 3d27 272c 0d0a 2020  oly=2,md='',..  
+00060000: 2323 230d 0a66 726f 6d20 736b 6c65 6172  ###..from sklear
+00060010: 6e2e 6c69 6e65 6172 5f6d 6f64 656c 2069  n.linear_model i
+00060020: 6d70 6f72 7420 4c6f 6769 7374 6963 5265  mport LogisticRe
+00060030: 6772 6573 7369 6f6e 0d0a 6672 6f6d 2073  gression..from s
+00060040: 6b6c 6561 726e 2e70 7265 7072 6f63 6573  klearn.preproces
+00060050: 7369 6e67 2069 6d70 6f72 7420 5374 616e  sing import Stan
+00060060: 6461 7264 5363 616c 6572 0d0a 6672 6f6d  dardScaler..from
+00060070: 2073 6b6c 6561 726e 2e6c 696e 6561 725f   sklearn.linear_
+00060080: 6d6f 6465 6c20 696d 706f 7274 204c 6173  model import Las
+00060090: 736f 0d0a 6672 6f6d 2073 6b6c 6561 726e  so..from sklearn
+000600a0: 2e70 7265 7072 6f63 6573 7369 6e67 2069  .preprocessing i
+000600b0: 6d70 6f72 7420 506f 6c79 6e6f 6d69 616c  mport Polynomial
+000600c0: 4665 6174 7572 6573 0d0a 6672 6f6d 2073  Features..from s
+000600d0: 6b6c 6561 726e 2e6d 6f64 656c 5f73 656c  klearn.model_sel
+000600e0: 6563 7469 6f6e 2069 6d70 6f72 7420 4772  ection import Gr
+000600f0: 6964 5365 6172 6368 4356 0d0a 0d0a 6465  idSearchCV....de
+00060100: 6620 6164 645f 706f 6c79 5f76 6172 735f  f add_poly_vars_
+00060110: 7365 6c65 6374 2864 6174 612c 6e75 6d76  select(data,numv
+00060120: 6172 732c 7461 7267 6574 7661 722c 6d6f  ars,targetvar,mo
+00060130: 6465 6c74 7970 652c 706f 6c79 5f64 6567  deltype,poly_deg
+00060140: 7265 653d 322c 4164 645f 506f 6c79 3d32  ree=2,Add_Poly=2
+00060150: 2c6d 643d 2727 2c0d 0a20 2020 2020 2020  ,md='',..       
 00060160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00060170: 2020 2020 2020 2020 2020 636f 7272 5f6c            corr_l
-00060180: 696d 6974 3d30 2e37 302c 7363 616c 696e  imit=0.70,scalin
-00060190: 673d 5472 7565 2c20 6669 745f 666c 6167  g=True, fit_flag
-000601a0: 3d46 616c 7365 2c20 7665 7262 6f73 653d  =False, verbose=
-000601b0: 3029 3a0d 0a20 2020 2022 2222 0d0a 2020  0):..    """..  
-000601c0: 2020 2323 2323 2054 6869 7320 6164 6473    #### This adds
-000601d0: 2050 6f6c 796e 6f6d 6961 6c20 616e 6420   Polynomial and 
-000601e0: 496e 7465 7261 6374 696f 6e20 5661 7269  Interaction Vari
-000601f0: 6162 6c65 7320 6f66 2061 6e79 2053 697a  ables of any Siz
-00060200: 6520 746f 2061 2064 6174 6120 7365 7420  e to a data set 
-00060210: 616e 6420 7265 7475 726e 7320 7468 6520  and returns the 
-00060220: 6265 7374 2076 6172 730d 0a20 2020 2061  best vars..    a
-00060230: 6d6f 6e67 2074 686f 7365 2070 6f6c 7920  mong those poly 
-00060240: 616e 6420 696e 7465 7261 6374 696f 6e20  and interaction 
-00060250: 7661 7269 6162 6c65 732e 204e 6f74 6963  variables. Notic
-00060260: 6520 796f 7520 7769 6c6c 2067 6574 2061  e you will get a
-00060270: 206c 6973 7420 6f66 2076 6172 6961 626c   list of variabl
-00060280: 6573 2061 7320 7765 6c6c 2061 7320 7468  es as well as th
-00060290: 6520 6d6f 6469 6669 6564 0d0a 2020 2020  e modified..    
-000602a0: 6461 7461 2073 6574 2077 6974 6820 7468  data set with th
-000602b0: 6520 6f6c 6420 616e 6420 6e65 7720 2861  e old and new (a
-000602c0: 6464 6564 2920 7661 7269 6162 6c65 732e  dded) variables.
-000602d0: 2056 6572 7920 436f 6e76 656e 6965 6e74   Very Convenient
-000602e0: 2077 6865 6e20 796f 7520 7761 6e74 2074   when you want t
-000602f0: 6f20 646f 2071 7569 636b 2074 6573 7469  o do quick testi
-00060300: 6e67 2e0d 0a20 2020 2054 6865 7265 2061  ng...    There a
-00060310: 7265 2033 2073 6574 7469 6e67 7320 666f  re 3 settings fo
-00060320: 7220 4164 645f 506f 6c79 2066 6c61 673a  r Add_Poly flag:
-00060330: 2030 203d 3e20 4e6f 2070 6f6c 7920 6f72   0 => No poly or
-00060340: 2069 6e74 786e 2076 6172 6961 626c 6573   intxn variables
-00060350: 2061 6464 6564 2e20 313d 3e20 4f6e 6c79   added. 1=> Only
-00060360: 2069 6e74 786e 2076 6172 730d 0a20 2020   intxn vars..   
-00060370: 2061 6464 6564 2e20 323d 3e20 6f6e 6c79   added. 2=> only
-00060380: 2070 6f6c 796e 6f6d 6961 6c20 6465 6772   polynomial degr
-00060390: 6565 2028 7371 7561 7265 6429 2076 6172  ee (squared) var
-000603a0: 7320 6164 6465 642e 2033 3d3e 2062 6f74  s added. 3=> bot
-000603b0: 6820 7371 7561 7265 6420 616e 6420 696e  h squared and in
-000603c0: 7478 6e20 7661 7273 2061 6464 6564 2e0d  txn vars added..
-000603d0: 0a20 2020 2049 6620 4669 745f 466c 6167  .    If Fit_Flag
-000603e0: 3d54 7275 652c 2074 6865 6e20 6974 2069  =True, then it i
-000603f0: 7320 6173 7375 6d65 6420 7468 6174 2069  s assumed that i
-00060400: 7420 6973 2054 7261 696e 696e 6720 6461  t is Training da
-00060410: 7461 2061 6e64 2068 656e 6365 2076 6172  ta and hence var
-00060420: 6961 626c 6573 2061 7265 2073 656c 6563  iables are selec
-00060430: 7465 640d 0a20 2020 2049 6620 4669 745f  ted..    If Fit_
-00060440: 466c 6167 3d46 616c 7365 2c20 7468 656e  Flag=False, then
-00060450: 2069 7420 6973 2061 7373 756d 6564 2069   it is assumed i
-00060460: 7420 6973 2054 6573 7420 6461 7461 2061  t is Test data a
-00060470: 6e64 206e 6f20 7661 7269 6162 6c65 7320  nd no variables 
-00060480: 6172 6520 6368 6f73 656e 2062 7574 2077  are chosen but w
-00060490: 6520 6b65 6570 2074 7261 696e 696e 6720  e keep training 
-000604a0: 6f6e 6573 2e0d 0a20 2020 2022 2222 0d0a  ones...    """..
-000604b0: 2020 2020 6461 7461 203d 2063 6f70 792e      data = copy.
-000604c0: 6465 6570 636f 7079 2864 6174 6129 0d0a  deepcopy(data)..
-000604d0: 2020 2020 6e75 6d76 6172 7320 3d20 636f      numvars = co
-000604e0: 7079 2e64 6565 7063 6f70 7928 6e75 6d76  py.deepcopy(numv
-000604f0: 6172 7329 0d0a 2020 2020 746f 6c65 7261  ars)..    tolera
-00060500: 6e63 6520 3d20 302e 3031 0d0a 2020 2020  nce = 0.01..    
-00060510: 6f72 6967 5f64 6174 615f 696e 6465 7820  orig_data_index 
-00060520: 3d20 6461 7461 2e69 6e64 6578 0d0a 2020  = data.index..  
-00060530: 2020 6966 206d 6f64 656c 7479 7065 203d    if modeltype =
-00060540: 3d20 2752 6567 7265 7373 696f 6e27 3a0d  = 'Regression':.
-00060550: 0a20 2020 2020 2020 206c 6d20 3d20 4c61  .        lm = La
-00060560: 7373 6f28 616c 7068 613d 302e 3030 312c  sso(alpha=0.001,
-00060570: 206d 6178 5f69 7465 723d 3230 3030 2c0d   max_iter=2000,.
-00060580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00060590: 2020 6669 745f 696e 7465 7263 6570 743d    fit_intercept=
-000605a0: 5472 7565 2c20 6e6f 726d 616c 697a 653d  True, normalize=
-000605b0: 4661 6c73 6529 0d0a 2020 2020 656c 7365  False)..    else
-000605c0: 3a0d 0a20 2020 2020 2020 2069 6620 6d6f  :..        if mo
-000605d0: 6465 6c74 7970 6520 3d3d 2027 4269 6e61  deltype == 'Bina
-000605e0: 7279 5f43 6c61 7373 6966 6963 6174 696f  ry_Classificatio
-000605f0: 6e27 3a0d 0a20 2020 2020 2020 2020 2020  n':..           
-00060600: 206c 6d20 3d20 4c6f 6769 7374 6963 5265   lm = LogisticRe
-00060610: 6772 6573 7369 6f6e 2843 3d30 2e30 312c  gression(C=0.01,
-00060620: 6669 745f 696e 7465 7263 6570 743d 5472  fit_intercept=Tr
-00060630: 7565 2c74 6f6c 3d74 6f6c 6572 616e 6365  ue,tol=tolerance
-00060640: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00060650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00060660: 2020 206d 6178 5f69 7465 723d 3230 3030     max_iter=2000
-00060670: 2c73 6f6c 7665 723d 276c 6962 6c69 6e65  ,solver='libline
-00060680: 6172 272c 6e5f 6a6f 6273 3d2d 312c 0d0a  ar',n_jobs=-1,..
+00060170: 2020 2020 2063 6f72 725f 6c69 6d69 743d       corr_limit=
+00060180: 302e 3730 2c73 6361 6c69 6e67 3d54 7275  0.70,scaling=Tru
+00060190: 652c 2066 6974 5f66 6c61 673d 4661 6c73  e, fit_flag=Fals
+000601a0: 652c 2076 6572 626f 7365 3d30 293a 0d0a  e, verbose=0):..
+000601b0: 2020 2020 2222 220d 0a20 2020 2023 2323      """..    ###
+000601c0: 2320 5468 6973 2061 6464 7320 506f 6c79  # This adds Poly
+000601d0: 6e6f 6d69 616c 2061 6e64 2049 6e74 6572  nomial and Inter
+000601e0: 6163 7469 6f6e 2056 6172 6961 626c 6573  action Variables
+000601f0: 206f 6620 616e 7920 5369 7a65 2074 6f20   of any Size to 
+00060200: 6120 6461 7461 2073 6574 2061 6e64 2072  a data set and r
+00060210: 6574 7572 6e73 2074 6865 2062 6573 7420  eturns the best 
+00060220: 7661 7273 0d0a 2020 2020 616d 6f6e 6720  vars..    among 
+00060230: 7468 6f73 6520 706f 6c79 2061 6e64 2069  those poly and i
+00060240: 6e74 6572 6163 7469 6f6e 2076 6172 6961  nteraction varia
+00060250: 626c 6573 2e20 4e6f 7469 6365 2079 6f75  bles. Notice you
+00060260: 2077 696c 6c20 6765 7420 6120 6c69 7374   will get a list
+00060270: 206f 6620 7661 7269 6162 6c65 7320 6173   of variables as
+00060280: 2077 656c 6c20 6173 2074 6865 206d 6f64   well as the mod
+00060290: 6966 6965 640d 0a20 2020 2064 6174 6120  ified..    data 
+000602a0: 7365 7420 7769 7468 2074 6865 206f 6c64  set with the old
+000602b0: 2061 6e64 206e 6577 2028 6164 6465 6429   and new (added)
+000602c0: 2076 6172 6961 626c 6573 2e20 5665 7279   variables. Very
+000602d0: 2043 6f6e 7665 6e69 656e 7420 7768 656e   Convenient when
+000602e0: 2079 6f75 2077 616e 7420 746f 2064 6f20   you want to do 
+000602f0: 7175 6963 6b20 7465 7374 696e 672e 0d0a  quick testing...
+00060300: 2020 2020 5468 6572 6520 6172 6520 3320      There are 3 
+00060310: 7365 7474 696e 6773 2066 6f72 2041 6464  settings for Add
+00060320: 5f50 6f6c 7920 666c 6167 3a20 3020 3d3e  _Poly flag: 0 =>
+00060330: 204e 6f20 706f 6c79 206f 7220 696e 7478   No poly or intx
+00060340: 6e20 7661 7269 6162 6c65 7320 6164 6465  n variables adde
+00060350: 642e 2031 3d3e 204f 6e6c 7920 696e 7478  d. 1=> Only intx
+00060360: 6e20 7661 7273 0d0a 2020 2020 6164 6465  n vars..    adde
+00060370: 642e 2032 3d3e 206f 6e6c 7920 706f 6c79  d. 2=> only poly
+00060380: 6e6f 6d69 616c 2064 6567 7265 6520 2873  nomial degree (s
+00060390: 7175 6172 6564 2920 7661 7273 2061 6464  quared) vars add
+000603a0: 6564 2e20 333d 3e20 626f 7468 2073 7175  ed. 3=> both squ
+000603b0: 6172 6564 2061 6e64 2069 6e74 786e 2076  ared and intxn v
+000603c0: 6172 7320 6164 6465 642e 0d0a 2020 2020  ars added...    
+000603d0: 4966 2046 6974 5f46 6c61 673d 5472 7565  If Fit_Flag=True
+000603e0: 2c20 7468 656e 2069 7420 6973 2061 7373  , then it is ass
+000603f0: 756d 6564 2074 6861 7420 6974 2069 7320  umed that it is 
+00060400: 5472 6169 6e69 6e67 2064 6174 6120 616e  Training data an
+00060410: 6420 6865 6e63 6520 7661 7269 6162 6c65  d hence variable
+00060420: 7320 6172 6520 7365 6c65 6374 6564 0d0a  s are selected..
+00060430: 2020 2020 4966 2046 6974 5f46 6c61 673d      If Fit_Flag=
+00060440: 4661 6c73 652c 2074 6865 6e20 6974 2069  False, then it i
+00060450: 7320 6173 7375 6d65 6420 6974 2069 7320  s assumed it is 
+00060460: 5465 7374 2064 6174 6120 616e 6420 6e6f  Test data and no
+00060470: 2076 6172 6961 626c 6573 2061 7265 2063   variables are c
+00060480: 686f 7365 6e20 6275 7420 7765 206b 6565  hosen but we kee
+00060490: 7020 7472 6169 6e69 6e67 206f 6e65 732e  p training ones.
+000604a0: 0d0a 2020 2020 2222 220d 0a20 2020 2064  ..    """..    d
+000604b0: 6174 6120 3d20 636f 7079 2e64 6565 7063  ata = copy.deepc
+000604c0: 6f70 7928 6461 7461 290d 0a20 2020 206e  opy(data)..    n
+000604d0: 756d 7661 7273 203d 2063 6f70 792e 6465  umvars = copy.de
+000604e0: 6570 636f 7079 286e 756d 7661 7273 290d  epcopy(numvars).
+000604f0: 0a20 2020 2074 6f6c 6572 616e 6365 203d  .    tolerance =
+00060500: 2030 2e30 310d 0a20 2020 206f 7269 675f   0.01..    orig_
+00060510: 6461 7461 5f69 6e64 6578 203d 2064 6174  data_index = dat
+00060520: 612e 696e 6465 780d 0a20 2020 2069 6620  a.index..    if 
+00060530: 6d6f 6465 6c74 7970 6520 3d3d 2027 5265  modeltype == 'Re
+00060540: 6772 6573 7369 6f6e 273a 0d0a 2020 2020  gression':..    
+00060550: 2020 2020 6c6d 203d 204c 6173 736f 2861      lm = Lasso(a
+00060560: 6c70 6861 3d30 2e30 3031 2c20 6d61 785f  lpha=0.001, max_
+00060570: 6974 6572 3d32 3030 302c 0d0a 2020 2020  iter=2000,..    
+00060580: 2020 2020 2020 2020 2020 2020 2066 6974               fit
+00060590: 5f69 6e74 6572 6365 7074 3d54 7275 652c  _intercept=True,
+000605a0: 206e 6f72 6d61 6c69 7a65 3d46 616c 7365   normalize=False
+000605b0: 290d 0a20 2020 2065 6c73 653a 0d0a 2020  )..    else:..  
+000605c0: 2020 2020 2020 6966 206d 6f64 656c 7479        if modelty
+000605d0: 7065 203d 3d20 2742 696e 6172 795f 436c  pe == 'Binary_Cl
+000605e0: 6173 7369 6669 6361 7469 6f6e 273a 0d0a  assification':..
+000605f0: 2020 2020 2020 2020 2020 2020 6c6d 203d              lm =
+00060600: 204c 6f67 6973 7469 6352 6567 7265 7373   LogisticRegress
+00060610: 696f 6e28 433d 302e 3031 2c66 6974 5f69  ion(C=0.01,fit_i
+00060620: 6e74 6572 6365 7074 3d54 7275 652c 746f  ntercept=True,to
+00060630: 6c3d 746f 6c65 7261 6e63 652c 0d0a 2020  l=tolerance,..  
+00060640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00060650: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+00060660: 785f 6974 6572 3d32 3030 302c 736f 6c76  x_iter=2000,solv
+00060670: 6572 3d27 6c69 626c 696e 6561 7227 2c6e  er='liblinear',n
+00060680: 5f6a 6f62 733d 2d31 2c0d 0a20 2020 2020  _jobs=-1,..     
 00060690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000606a0: 2020 2020 2020 2020 2020 2020 2020 7065                pe
-000606b0: 6e61 6c74 793d 276c 3227 2c64 7561 6c3d  nalty='l2',dual=
-000606c0: 4661 6c73 652c 2072 616e 646f 6d5f 7374  False, random_st
-000606d0: 6174 653d 3029 0d0a 2020 2020 2020 2020  ate=0)..        
-000606e0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-000606f0: 2020 206c 6d20 3d20 4c6f 6769 7374 6963     lm = Logistic
-00060700: 5265 6772 6573 7369 6f6e 286d 756c 7469  Regression(multi
-00060710: 5f63 6c61 7373 3d27 6f76 7227 2c20 6d61  _class='ovr', ma
-00060720: 785f 6974 6572 3d31 3030 3030 2920 2323  x_iter=10000) ##
-00060730: 206c 6f67 6973 7469 6320 7365 656d 7320   logistic seems 
-00060740: 6265 7374 2061 6d6f 6e67 2061 6c6c 0d0a  best among all..
-00060750: 2020 2020 7072 6564 6963 746f 7273 203d      predictors =
-00060760: 2063 6f70 792e 6465 6570 636f 7079 286e   copy.deepcopy(n
-00060770: 756d 7661 7273 290d 0a20 2020 2023 2323  umvars)..    ###
-00060780: 2320 6e75 6d62 6572 206f 6620 6f72 6967  # number of orig
-00060790: 696e 616c 2066 6561 7475 7265 7320 696e  inal features in
-000607a0: 2064 6174 6120 7365 7420 2323 2323 0d0a   data set ####..
-000607b0: 2020 2020 6e5f 6f72 6967 5f66 6561 7475      n_orig_featu
-000607c0: 7265 7320 3d20 6c65 6e28 7072 6564 6963  res = len(predic
-000607d0: 746f 7273 290d 0a20 2020 2073 656c 6563  tors)..    selec
-000607e0: 7465 6420 3d20 5b5d 0d0a 2020 2020 585f  ted = []..    X_
-000607f0: 6461 7461 203d 2064 6174 615b 7072 6564  data = data[pred
-00060800: 6963 746f 7273 5d0d 0a20 2020 2023 2323  ictors]..    ###
-00060810: 2323 2323 2020 496e 6974 6961 6c20 4d6f  ####  Initial Mo
-00060820: 6465 6c20 7769 7468 2061 6c6c 2069 6e70  del with all inp
-00060830: 7574 2076 6172 6961 626c 6573 2023 2323  ut variables ###
-00060840: 2323 230d 0a20 2020 2069 6620 7363 616c  ###..    if scal
-00060850: 696e 6720 3d3d 2027 5374 616e 6461 7264  ing == 'Standard
-00060860: 273a 0d0a 2020 2020 2020 2020 5853 203d  ':..        XS =
-00060870: 2053 7461 6e64 6172 6453 6361 6c65 7228   StandardScaler(
-00060880: 292e 6669 745f 7472 616e 7366 6f72 6d28  ).fit_transform(
-00060890: 585f 6461 7461 290d 0a20 2020 2065 6c69  X_data)..    eli
-000608a0: 6620 7363 616c 696e 6720 3d3d 2027 4d69  f scaling == 'Mi
-000608b0: 6e4d 6178 273a 0d0a 2020 2020 2020 2020  nMax':..        
-000608c0: 5853 203d 204d 696e 4d61 7853 6361 6c65  XS = MinMaxScale
-000608d0: 7228 292e 6669 745f 7472 616e 7366 6f72  r().fit_transfor
-000608e0: 6d28 585f 6461 7461 290d 0a20 2020 2023  m(X_data)..    #
-000608f0: 2323 2020 6f72 2079 6f75 2063 616e 2075  ##  or you can u
-00060900: 7365 2043 656e 7465 7269 6e67 2077 6869  se Centering whi
-00060910: 6368 2073 696d 706c 7920 7375 6274 7261  ch simply subtra
-00060920: 6374 7320 7468 6520 4d65 616e 3a0d 0a20  cts the Mean:.. 
-00060930: 2020 2065 6c69 6620 7363 616c 696e 6720     elif scaling 
-00060940: 3d3d 2027 4365 6e74 6572 696e 6727 3a0d  == 'Centering':.
-00060950: 0a20 2020 2020 2020 2058 5320 3d20 2858  .        XS = (X
-00060960: 5f64 6174 612d 585f 6461 7461 2e6d 6561  _data-X_data.mea
-00060970: 6e28 2929 0d0a 2020 2020 656c 7365 3a0d  n())..    else:.
-00060980: 0a20 2020 2020 2020 2058 5320 3d20 636f  .        XS = co
-00060990: 7079 2e64 6565 7063 6f70 7928 585f 6461  py.deepcopy(X_da
-000609a0: 7461 290d 0a20 2020 2023 5853 2e63 6f6c  ta)..    #XS.col
-000609b0: 756d 6e73 3d70 7265 6469 6374 6f72 730d  umns=predictors.
-000609c0: 0a20 2020 2058 203d 2063 6f70 792e 6465  .    X = copy.de
-000609d0: 6570 636f 7079 2858 5329 0d0a 2020 2020  epcopy(XS)..    
-000609e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000609f0: 2323 2046 6974 2074 6865 206d 6f64 656c  ## Fit the model
-00060a00: 2061 6674 6572 2073 6361 6c69 6e67 2064   after scaling d
-00060a10: 6174 6120 2323 2323 2323 2323 2323 2323  ata ############
-00060a20: 2323 230d 0a20 2020 2069 6620 6669 745f  ###..    if fit_
-00060a30: 666c 6167 3a0d 0a20 2020 2020 2020 2059  flag:..        Y
-00060a40: 203d 2064 6174 615b 7461 7267 6574 7661   = data[targetva
-00060a50: 725d 0d0a 2020 2020 2020 2020 7072 696e  r]..        prin
-00060a60: 7428 2742 7569 6c64 696e 6720 496e 6974  t('Building Init
-00060a70: 616c 204d 6f64 656c 2077 6974 6820 6769  al Model with gi
-00060a80: 7665 6e20 7661 7269 6162 6c65 732e 2e2e  ven variables...
-00060a90: 2729 0d0a 2020 2020 2020 2020 7072 696e  ')..        prin
-00060aa0: 745f 6d6f 6465 6c5f 6d65 7472 6963 7328  t_model_metrics(
-00060ab0: 6d6f 6465 6c74 7970 652c 6c6d 2c58 2c59  modeltype,lm,X,Y
-00060ac0: 2c46 616c 7365 290d 0a20 2020 2023 2323  ,False)..    ###
-00060ad0: 2323 2323 2320 4865 7265 2069 7320 7768  ##### Here is wh
-00060ae0: 6572 6520 7468 6520 496e 7465 7261 6374  ere the Interact
-00060af0: 696f 6e20 7661 7269 6162 6c65 2073 656c  ion variable sel
-00060b00: 6563 7469 6f6e 2062 6567 696e 7320 2323  ection begins ##
-00060b10: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-00060b20: 2370 7269 6e74 2827 4164 6469 6e67 2050  #print('Adding P
-00060b30: 6f6c 796e 6f6d 6961 6c20 2573 2d64 6567  olynomial %s-deg
-00060b40: 7265 6520 616e 6420 496e 7465 7261 6374  ree and Interact
-00060b50: 696f 6e20 7661 7269 6162 6c65 732e 2e2e  ion variables...
-00060b60: 2720 2570 6f6c 795f 6465 6772 6565 290d  ' %poly_degree).
-00060b70: 0a20 2020 2069 6620 4164 645f 506f 6c79  .    if Add_Poly
-00060b80: 203d 3d20 313a 0d0a 2020 2020 2020 2020   == 1:..        
-00060b90: 2323 2320 4966 2069 7420 6973 2031 2c20  ### If it is 1, 
-00060ba0: 6164 6420 6f6e 6c79 2049 6e74 6572 6163  add only Interac
-00060bb0: 7469 6f6e 2076 6172 6961 626c 6573 2e0d  tion variables..
-00060bc0: 0a20 2020 2020 2020 2070 6f6c 7920 3d20  .        poly = 
-00060bd0: 506f 6c79 6e6f 6d69 616c 4665 6174 7572  PolynomialFeatur
-00060be0: 6573 2864 6567 7265 653d 706f 6c79 5f64  es(degree=poly_d
-00060bf0: 6567 7265 652c 2069 6e63 6c75 6465 5f62  egree, include_b
-00060c00: 6961 7320 3d20 4661 6c73 652c 2069 6e74  ias = False, int
-00060c10: 6572 6163 7469 6f6e 5f6f 6e6c 793d 5472  eraction_only=Tr
-00060c20: 7565 290d 0a20 2020 2065 6c69 6620 4164  ue)..    elif Ad
-00060c30: 645f 506f 6c79 203d 3d20 323a 0d0a 2020  d_Poly == 2:..  
-00060c40: 2020 2020 2020 2323 2323 2049 6620 6974        #### If it
-00060c50: 2069 7320 3220 6f72 2033 2061 6464 2062   is 2 or 3 add b
-00060c60: 6f74 6820 5371 7561 7265 6420 616e 6420  oth Squared and 
-00060c70: 496e 7465 7261 6374 696f 6e20 7661 7269  Interaction vari
-00060c80: 6162 6c65 732e 2057 6520 7769 6c6c 2072  ables. We will r
-00060c90: 656d 6f76 6520 696e 7465 7261 6374 696f  emove interactio
-00060ca0: 6e0d 0a20 2020 2020 2020 2023 2323 2020  n..        ###  
-00060cb0: 2020 2020 2076 6172 6961 626c 6573 206c       variables l
-00060cc0: 6174 6572 2069 6e20 7468 6973 2070 726f  ater in this pro
-00060cd0: 6772 616d 2e20 466f 7220 6e6f 7720 696e  gram. For now in
-00060ce0: 636c 7564 6520 626f 7468 210d 0a20 2020  clude both!..   
-00060cf0: 2020 2020 2070 6f6c 7920 3d20 506f 6c79       poly = Poly
-00060d00: 6e6f 6d69 616c 4665 6174 7572 6573 2864  nomialFeatures(d
-00060d10: 6567 7265 653d 706f 6c79 5f64 6567 7265  egree=poly_degre
-00060d20: 652c 2069 6e63 6c75 6465 5f62 6961 7320  e, include_bias 
-00060d30: 3d20 4661 6c73 652c 2069 6e74 6572 6163  = False, interac
-00060d40: 7469 6f6e 5f6f 6e6c 793d 4661 6c73 6529  tion_only=False)
-00060d50: 0d0a 2020 2020 656c 6966 2041 6464 5f50  ..    elif Add_P
-00060d60: 6f6c 7920 3d3d 2033 3a0d 0a20 2020 2020  oly == 3:..     
-00060d70: 2020 2023 2323 2320 4966 2069 7420 6973     #### If it is
-00060d80: 2032 206f 7220 3320 6164 6420 626f 7468   2 or 3 add both
-00060d90: 2053 7175 6172 6564 2061 6e64 2049 6e74   Squared and Int
-00060da0: 6572 6163 7469 6f6e 2076 6172 6961 626c  eraction variabl
-00060db0: 6573 2e20 5765 2077 696c 6c20 7265 6d6f  es. We will remo
-00060dc0: 7665 2069 6e74 6572 6163 7469 6f6e 0d0a  ve interaction..
-00060dd0: 2020 2020 2020 2020 2323 2320 2020 2020          ###     
-00060de0: 2020 7661 7269 6162 6c65 7320 6c61 7465    variables late
-00060df0: 7220 696e 2074 6869 7320 7072 6f67 7261  r in this progra
-00060e00: 6d2e 2046 6f72 206e 6f77 2069 6e63 6c75  m. For now inclu
-00060e10: 6465 2062 6f74 6821 0d0a 2020 2020 2020  de both!..      
-00060e20: 2020 706f 6c79 203d 2050 6f6c 796e 6f6d    poly = Polynom
-00060e30: 6961 6c46 6561 7475 7265 7328 6465 6772  ialFeatures(degr
-00060e40: 6565 3d70 6f6c 795f 6465 6772 6565 2c20  ee=poly_degree, 
-00060e50: 696e 636c 7564 655f 6269 6173 203d 2046  include_bias = F
-00060e60: 616c 7365 2c20 696e 7465 7261 6374 696f  alse, interactio
-00060e70: 6e5f 6f6e 6c79 3d46 616c 7365 290d 0a20  n_only=False).. 
-00060e80: 2020 2069 6620 6669 745f 666c 6167 3a0d     if fit_flag:.
-00060e90: 0a20 2020 2020 2020 206d 6420 3d20 706f  .        md = po
-00060ea0: 6c79 2e66 6974 2858 2920 2323 2323 2054  ly.fit(X) #### T
-00060eb0: 6869 7320 6465 6669 6e65 7320 7468 6520  his defines the 
-00060ec0: 506f 6c79 6e6f 6d69 616c 2066 6561 7475  Polynomial featu
-00060ed0: 7265 2065 7874 7261 6374 696f 6e0d 0a20  re extraction.. 
-00060ee0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-00060ef0: 2058 5020 3d20 6d64 2e74 7261 6e73 666f   XP = md.transfo
-00060f00: 726d 2858 2920 2323 2323 2054 6869 7320  rm(X) #### This 
-00060f10: 7472 616e 7366 6f72 6d73 2058 2069 6e74  transforms X int
-00060f20: 6f20 6120 506f 6c79 6e6f 6d69 616c 204f  o a Polynomial O
-00060f30: 7264 6572 0d0a 2020 2020 6578 6365 7074  rder..    except
-00060f40: 204d 656d 6f72 7945 7272 6f72 3a0d 0a20   MemoryError:.. 
-00060f50: 2020 2020 2020 2072 6574 7572 6e20 7072         return pr
-00060f60: 6564 6963 746f 7273 2c20 2727 2c20 582c  edictors, '', X,
-00060f70: 206d 642c 205b 5d2c 2064 6963 7428 290d   md, [], dict().
-00060f80: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
+000606a0: 2020 2020 2020 2020 2070 656e 616c 7479           penalty
+000606b0: 3d27 6c32 272c 6475 616c 3d46 616c 7365  ='l2',dual=False
+000606c0: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d30  , random_state=0
+000606d0: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+000606e0: 0d0a 2020 2020 2020 2020 2020 2020 6c6d  ..            lm
+000606f0: 203d 204c 6f67 6973 7469 6352 6567 7265   = LogisticRegre
+00060700: 7373 696f 6e28 6d75 6c74 695f 636c 6173  ssion(multi_clas
+00060710: 733d 276f 7672 272c 206d 6178 5f69 7465  s='ovr', max_ite
+00060720: 723d 3130 3030 3029 2023 2320 6c6f 6769  r=10000) ## logi
+00060730: 7374 6963 2073 6565 6d73 2062 6573 7420  stic seems best 
+00060740: 616d 6f6e 6720 616c 6c0d 0a20 2020 2070  among all..    p
+00060750: 7265 6469 6374 6f72 7320 3d20 636f 7079  redictors = copy
+00060760: 2e64 6565 7063 6f70 7928 6e75 6d76 6172  .deepcopy(numvar
+00060770: 7329 0d0a 2020 2020 2323 2323 206e 756d  s)..    #### num
+00060780: 6265 7220 6f66 206f 7269 6769 6e61 6c20  ber of original 
+00060790: 6665 6174 7572 6573 2069 6e20 6461 7461  features in data
+000607a0: 2073 6574 2023 2323 230d 0a20 2020 206e   set ####..    n
+000607b0: 5f6f 7269 675f 6665 6174 7572 6573 203d  _orig_features =
+000607c0: 206c 656e 2870 7265 6469 6374 6f72 7329   len(predictors)
+000607d0: 0d0a 2020 2020 7365 6c65 6374 6564 203d  ..    selected =
+000607e0: 205b 5d0d 0a20 2020 2058 5f64 6174 6120   []..    X_data 
+000607f0: 3d20 6461 7461 5b70 7265 6469 6374 6f72  = data[predictor
+00060800: 735d 0d0a 2020 2020 2323 2323 2323 2320  s]..    ####### 
+00060810: 2049 6e69 7469 616c 204d 6f64 656c 2077   Initial Model w
+00060820: 6974 6820 616c 6c20 696e 7075 7420 7661  ith all input va
+00060830: 7269 6162 6c65 7320 2323 2323 2323 0d0a  riables ######..
+00060840: 2020 2020 6966 2073 6361 6c69 6e67 203d      if scaling =
+00060850: 3d20 2753 7461 6e64 6172 6427 3a0d 0a20  = 'Standard':.. 
+00060860: 2020 2020 2020 2058 5320 3d20 5374 616e         XS = Stan
+00060870: 6461 7264 5363 616c 6572 2829 2e66 6974  dardScaler().fit
+00060880: 5f74 7261 6e73 666f 726d 2858 5f64 6174  _transform(X_dat
+00060890: 6129 0d0a 2020 2020 656c 6966 2073 6361  a)..    elif sca
+000608a0: 6c69 6e67 203d 3d20 274d 696e 4d61 7827  ling == 'MinMax'
+000608b0: 3a0d 0a20 2020 2020 2020 2058 5320 3d20  :..        XS = 
+000608c0: 4d69 6e4d 6178 5363 616c 6572 2829 2e66  MinMaxScaler().f
+000608d0: 6974 5f74 7261 6e73 666f 726d 2858 5f64  it_transform(X_d
+000608e0: 6174 6129 0d0a 2020 2020 2323 2320 206f  ata)..    ###  o
+000608f0: 7220 796f 7520 6361 6e20 7573 6520 4365  r you can use Ce
+00060900: 6e74 6572 696e 6720 7768 6963 6820 7369  ntering which si
+00060910: 6d70 6c79 2073 7562 7472 6163 7473 2074  mply subtracts t
+00060920: 6865 204d 6561 6e3a 0d0a 2020 2020 656c  he Mean:..    el
+00060930: 6966 2073 6361 6c69 6e67 203d 3d20 2743  if scaling == 'C
+00060940: 656e 7465 7269 6e67 273a 0d0a 2020 2020  entering':..    
+00060950: 2020 2020 5853 203d 2028 585f 6461 7461      XS = (X_data
+00060960: 2d58 5f64 6174 612e 6d65 616e 2829 290d  -X_data.mean()).
+00060970: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
+00060980: 2020 2020 5853 203d 2063 6f70 792e 6465      XS = copy.de
+00060990: 6570 636f 7079 2858 5f64 6174 6129 0d0a  epcopy(X_data)..
+000609a0: 2020 2020 2358 532e 636f 6c75 6d6e 733d      #XS.columns=
+000609b0: 7072 6564 6963 746f 7273 0d0a 2020 2020  predictors..    
+000609c0: 5820 3d20 636f 7079 2e64 6565 7063 6f70  X = copy.deepcop
+000609d0: 7928 5853 290d 0a20 2020 2023 2323 2323  y(XS)..    #####
+000609e0: 2323 2323 2323 2323 2323 2323 2320 4669  ############# Fi
+000609f0: 7420 7468 6520 6d6f 6465 6c20 6166 7465  t the model afte
+00060a00: 7220 7363 616c 696e 6720 6461 7461 2023  r scaling data #
+00060a10: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00060a20: 2020 2020 6966 2066 6974 5f66 6c61 673a      if fit_flag:
+00060a30: 0d0a 2020 2020 2020 2020 5920 3d20 6461  ..        Y = da
+00060a40: 7461 5b74 6172 6765 7476 6172 5d0d 0a20  ta[targetvar].. 
+00060a50: 2020 2020 2020 2070 7269 6e74 2827 4275         print('Bu
+00060a60: 696c 6469 6e67 2049 6e69 7461 6c20 4d6f  ilding Inital Mo
+00060a70: 6465 6c20 7769 7468 2067 6976 656e 2076  del with given v
+00060a80: 6172 6961 626c 6573 2e2e 2e27 290d 0a20  ariables...').. 
+00060a90: 2020 2020 2020 2070 7269 6e74 5f6d 6f64         print_mod
+00060aa0: 656c 5f6d 6574 7269 6373 286d 6f64 656c  el_metrics(model
+00060ab0: 7479 7065 2c6c 6d2c 582c 592c 4661 6c73  type,lm,X,Y,Fals
+00060ac0: 6529 0d0a 2020 2020 2323 2323 2323 2323  e)..    ########
+00060ad0: 2048 6572 6520 6973 2077 6865 7265 2074   Here is where t
+00060ae0: 6865 2049 6e74 6572 6163 7469 6f6e 2076  he Interaction v
+00060af0: 6172 6961 626c 6520 7365 6c65 6374 696f  ariable selectio
+00060b00: 6e20 6265 6769 6e73 2023 2323 2323 2323  n begins #######
+00060b10: 2323 2323 230d 0a20 2020 2023 7072 696e  #####..    #prin
+00060b20: 7428 2741 6464 696e 6720 506f 6c79 6e6f  t('Adding Polyno
+00060b30: 6d69 616c 2025 732d 6465 6772 6565 2061  mial %s-degree a
+00060b40: 6e64 2049 6e74 6572 6163 7469 6f6e 2076  nd Interaction v
+00060b50: 6172 6961 626c 6573 2e2e 2e27 2025 706f  ariables...' %po
+00060b60: 6c79 5f64 6567 7265 6529 0d0a 2020 2020  ly_degree)..    
+00060b70: 6966 2041 6464 5f50 6f6c 7920 3d3d 2031  if Add_Poly == 1
+00060b80: 3a0d 0a20 2020 2020 2020 2023 2323 2049  :..        ### I
+00060b90: 6620 6974 2069 7320 312c 2061 6464 206f  f it is 1, add o
+00060ba0: 6e6c 7920 496e 7465 7261 6374 696f 6e20  nly Interaction 
+00060bb0: 7661 7269 6162 6c65 732e 0d0a 2020 2020  variables...    
+00060bc0: 2020 2020 706f 6c79 203d 2050 6f6c 796e      poly = Polyn
+00060bd0: 6f6d 6961 6c46 6561 7475 7265 7328 6465  omialFeatures(de
+00060be0: 6772 6565 3d70 6f6c 795f 6465 6772 6565  gree=poly_degree
+00060bf0: 2c20 696e 636c 7564 655f 6269 6173 203d  , include_bias =
+00060c00: 2046 616c 7365 2c20 696e 7465 7261 6374   False, interact
+00060c10: 696f 6e5f 6f6e 6c79 3d54 7275 6529 0d0a  ion_only=True)..
+00060c20: 2020 2020 656c 6966 2041 6464 5f50 6f6c      elif Add_Pol
+00060c30: 7920 3d3d 2032 3a0d 0a20 2020 2020 2020  y == 2:..       
+00060c40: 2023 2323 2320 4966 2069 7420 6973 2032   #### If it is 2
+00060c50: 206f 7220 3320 6164 6420 626f 7468 2053   or 3 add both S
+00060c60: 7175 6172 6564 2061 6e64 2049 6e74 6572  quared and Inter
+00060c70: 6163 7469 6f6e 2076 6172 6961 626c 6573  action variables
+00060c80: 2e20 5765 2077 696c 6c20 7265 6d6f 7665  . We will remove
+00060c90: 2069 6e74 6572 6163 7469 6f6e 0d0a 2020   interaction..  
+00060ca0: 2020 2020 2020 2323 2320 2020 2020 2020        ###       
+00060cb0: 7661 7269 6162 6c65 7320 6c61 7465 7220  variables later 
+00060cc0: 696e 2074 6869 7320 7072 6f67 7261 6d2e  in this program.
+00060cd0: 2046 6f72 206e 6f77 2069 6e63 6c75 6465   For now include
+00060ce0: 2062 6f74 6821 0d0a 2020 2020 2020 2020   both!..        
+00060cf0: 706f 6c79 203d 2050 6f6c 796e 6f6d 6961  poly = Polynomia
+00060d00: 6c46 6561 7475 7265 7328 6465 6772 6565  lFeatures(degree
+00060d10: 3d70 6f6c 795f 6465 6772 6565 2c20 696e  =poly_degree, in
+00060d20: 636c 7564 655f 6269 6173 203d 2046 616c  clude_bias = Fal
+00060d30: 7365 2c20 696e 7465 7261 6374 696f 6e5f  se, interaction_
+00060d40: 6f6e 6c79 3d46 616c 7365 290d 0a20 2020  only=False)..   
+00060d50: 2065 6c69 6620 4164 645f 506f 6c79 203d   elif Add_Poly =
+00060d60: 3d20 333a 0d0a 2020 2020 2020 2020 2323  = 3:..        ##
+00060d70: 2323 2049 6620 6974 2069 7320 3220 6f72  ## If it is 2 or
+00060d80: 2033 2061 6464 2062 6f74 6820 5371 7561   3 add both Squa
+00060d90: 7265 6420 616e 6420 496e 7465 7261 6374  red and Interact
+00060da0: 696f 6e20 7661 7269 6162 6c65 732e 2057  ion variables. W
+00060db0: 6520 7769 6c6c 2072 656d 6f76 6520 696e  e will remove in
+00060dc0: 7465 7261 6374 696f 6e0d 0a20 2020 2020  teraction..     
+00060dd0: 2020 2023 2323 2020 2020 2020 2076 6172     ###       var
+00060de0: 6961 626c 6573 206c 6174 6572 2069 6e20  iables later in 
+00060df0: 7468 6973 2070 726f 6772 616d 2e20 466f  this program. Fo
+00060e00: 7220 6e6f 7720 696e 636c 7564 6520 626f  r now include bo
+00060e10: 7468 210d 0a20 2020 2020 2020 2070 6f6c  th!..        pol
+00060e20: 7920 3d20 506f 6c79 6e6f 6d69 616c 4665  y = PolynomialFe
+00060e30: 6174 7572 6573 2864 6567 7265 653d 706f  atures(degree=po
+00060e40: 6c79 5f64 6567 7265 652c 2069 6e63 6c75  ly_degree, inclu
+00060e50: 6465 5f62 6961 7320 3d20 4661 6c73 652c  de_bias = False,
+00060e60: 2069 6e74 6572 6163 7469 6f6e 5f6f 6e6c   interaction_onl
+00060e70: 793d 4661 6c73 6529 0d0a 2020 2020 6966  y=False)..    if
+00060e80: 2066 6974 5f66 6c61 673a 0d0a 2020 2020   fit_flag:..    
+00060e90: 2020 2020 6d64 203d 2070 6f6c 792e 6669      md = poly.fi
+00060ea0: 7428 5829 2023 2323 2320 5468 6973 2064  t(X) #### This d
+00060eb0: 6566 696e 6573 2074 6865 2050 6f6c 796e  efines the Polyn
+00060ec0: 6f6d 6961 6c20 6665 6174 7572 6520 6578  omial feature ex
+00060ed0: 7472 6163 7469 6f6e 0d0a 2020 2020 7472  traction..    tr
+00060ee0: 793a 0d0a 2020 2020 2020 2020 5850 203d  y:..        XP =
+00060ef0: 206d 642e 7472 616e 7366 6f72 6d28 5829   md.transform(X)
+00060f00: 2023 2323 2320 5468 6973 2074 7261 6e73   #### This trans
+00060f10: 666f 726d 7320 5820 696e 746f 2061 2050  forms X into a P
+00060f20: 6f6c 796e 6f6d 6961 6c20 4f72 6465 720d  olynomial Order.
+00060f30: 0a20 2020 2065 7863 6570 7420 4d65 6d6f  .    except Memo
+00060f40: 7279 4572 726f 723a 0d0a 2020 2020 2020  ryError:..      
+00060f50: 2020 7265 7475 726e 2070 7265 6469 6374    return predict
+00060f60: 6f72 732c 2027 272c 2058 2c20 6d64 2c20  ors, '', X, md, 
+00060f70: 5b5d 2c20 6469 6374 2829 0d0a 2020 2020  [], dict()..    
+00060f80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00060f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00060fa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00060fb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00060fc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00060fd0: 2323 2323 2323 0d0a 2020 2020 2323 2323  ######..    ####
-00060fe0: 2320 2020 434f 4e56 4552 5420 582d 5641  #   CONVERT X-VA
-00060ff0: 5249 4142 4c45 5320 4652 4f4d 2050 4f4c  RIABLES FROM POL
-00061000: 5920 414e 4420 494e 5445 5241 4354 494f  Y AND INTERACTIO
-00061010: 4e20 494e 544f 204f 5249 4749 4e41 4c20  N INTO ORIGINAL 
-00061020: 5641 5249 4142 4c45 5320 2323 230d 0a20  VARIABLES ###.. 
-00061030: 2020 2023 2323 2323 2323 2323 2323 2323     #############
+00060fd0: 230d 0a20 2020 2023 2323 2323 2020 2043  #..    #####   C
+00060fe0: 4f4e 5645 5254 2058 2d56 4152 4941 424c  ONVERT X-VARIABL
+00060ff0: 4553 2046 524f 4d20 504f 4c59 2041 4e44  ES FROM POLY AND
+00061000: 2049 4e54 4552 4143 5449 4f4e 2049 4e54   INTERACTION INT
+00061010: 4f20 4f52 4947 494e 414c 2056 4152 4941  O ORIGINAL VARIA
+00061020: 424c 4553 2023 2323 0d0a 2020 2020 2323  BLES ###..    ##
+00061030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00061040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00061050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00061060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00061070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00061080: 2323 2323 0d0a 2020 2020 786e 616d 6573  ####..    xnames
-00061090: 203d 206d 642e 6765 745f 6665 6174 7572   = md.get_featur
-000610a0: 655f 6e61 6d65 7328 2920 2323 2320 786e  e_names() ### xn
-000610b0: 616d 6573 2063 6f6e 7461 696e 7320 616c  ames contains al
-000610c0: 6c20 782d 6f6e 6c79 2c20 506f 6c79 2061  l x-only, Poly a
-000610d0: 6e64 2049 6e74 786e 2076 6172 6961 626c  nd Intxn variabl
-000610e0: 6573 2069 6e20 782d 666f 726d 6174 0d0a  es in x-format..
-000610f0: 2020 2020 6966 206c 656e 2878 6e61 6d65      if len(xname
-00061100: 7329 203e 2033 3030 3a0d 0a20 2020 2020  s) > 300:..     
-00061110: 2020 206d 6178 5f69 7465 7220 3d20 3530     max_iter = 50
-00061120: 3030 0d0a 2020 2020 656c 7365 3a0d 0a20  00..    else:.. 
-00061130: 2020 2020 2020 206d 6178 5f69 7465 7220         max_iter 
-00061140: 3d20 3230 3030 0d0a 2020 2020 2323 2323  = 2000..    ####
-00061150: 2323 2042 5549 4c44 494e 4720 434f 4d50  ## BUILDING COMP
-00061160: 4152 4953 4f4e 204d 4f44 454c 2057 4954  ARISON MODEL WIT
-00061170: 4820 494e 5445 5241 4354 494f 4e20 5641  H INTERACTION VA
-00061180: 5249 4142 4c45 5320 2323 2323 2323 2323  RIABLES ########
-00061190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000611a0: 0d0a 2020 2020 7374 6172 745f 7469 6d65  ..    start_time
-000611b0: 203d 2074 696d 652e 7469 6d65 2829 0d0a   = time.time()..
-000611c0: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
-000611d0: 203d 3d20 2752 6567 7265 7373 696f 6e27   == 'Regression'
-000611e0: 3a0d 0a20 2020 2020 2020 206c 6d20 3d20  :..        lm = 
-000611f0: 4c61 7373 6f28 616c 7068 613d 302e 3030  Lasso(alpha=0.00
-00061200: 312c 206d 6178 5f69 7465 723d 6d61 785f  1, max_iter=max_
-00061210: 6974 6572 2c0d 0a20 2020 2020 2020 2020  iter,..         
-00061220: 2020 2020 2020 2020 6669 745f 696e 7465          fit_inte
-00061230: 7263 6570 743d 5472 7565 2c20 6e6f 726d  rcept=True, norm
-00061240: 616c 697a 653d 4661 6c73 6529 0d0a 2020  alize=False)..  
-00061250: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00061260: 2069 6620 6d6f 6465 6c74 7970 6520 3d3d   if modeltype ==
-00061270: 2027 4269 6e61 7279 5f43 6c61 7373 6966   'Binary_Classif
-00061280: 6963 6174 696f 6e27 3a0d 0a20 2020 2020  ication':..     
-00061290: 2020 2020 2020 206c 6d20 3d20 4c6f 6769         lm = Logi
-000612a0: 7374 6963 5265 6772 6573 7369 6f6e 2843  sticRegression(C
-000612b0: 3d30 2e30 312c 6669 745f 696e 7465 7263  =0.01,fit_interc
-000612c0: 6570 743d 5472 7565 2c20 746f 6c3d 746f  ept=True, tol=to
-000612d0: 6c65 7261 6e63 652c 0d0a 2020 2020 2020  lerance,..      
+00061070: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+00061080: 0a20 2020 2078 6e61 6d65 7320 3d20 6d64  .    xnames = md
+00061090: 2e67 6574 5f66 6561 7475 7265 5f6e 616d  .get_feature_nam
+000610a0: 6573 2829 2023 2323 2078 6e61 6d65 7320  es() ### xnames 
+000610b0: 636f 6e74 6169 6e73 2061 6c6c 2078 2d6f  contains all x-o
+000610c0: 6e6c 792c 2050 6f6c 7920 616e 6420 496e  nly, Poly and In
+000610d0: 7478 6e20 7661 7269 6162 6c65 7320 696e  txn variables in
+000610e0: 2078 2d66 6f72 6d61 740d 0a20 2020 2069   x-format..    i
+000610f0: 6620 6c65 6e28 786e 616d 6573 2920 3e20  f len(xnames) > 
+00061100: 3330 303a 0d0a 2020 2020 2020 2020 6d61  300:..        ma
+00061110: 785f 6974 6572 203d 2035 3030 300d 0a20  x_iter = 5000.. 
+00061120: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00061130: 2020 6d61 785f 6974 6572 203d 2032 3030    max_iter = 200
+00061140: 300d 0a20 2020 2023 2323 2323 2320 4255  0..    ###### BU
+00061150: 494c 4449 4e47 2043 4f4d 5041 5249 534f  ILDING COMPARISO
+00061160: 4e20 4d4f 4445 4c20 5749 5448 2049 4e54  N MODEL WITH INT
+00061170: 4552 4143 5449 4f4e 2056 4152 4941 424c  ERACTION VARIABL
+00061180: 4553 2023 2323 2323 2323 2323 2323 2323  ES #############
+00061190: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+000611a0: 2073 7461 7274 5f74 696d 6520 3d20 7469   start_time = ti
+000611b0: 6d65 2e74 696d 6528 290d 0a20 2020 2069  me.time()..    i
+000611c0: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
+000611d0: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
+000611e0: 2020 2020 2020 6c6d 203d 204c 6173 736f        lm = Lasso
+000611f0: 2861 6c70 6861 3d30 2e30 3031 2c20 6d61  (alpha=0.001, ma
+00061200: 785f 6974 6572 3d6d 6178 5f69 7465 722c  x_iter=max_iter,
+00061210: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00061220: 2020 2066 6974 5f69 6e74 6572 6365 7074     fit_intercept
+00061230: 3d54 7275 652c 206e 6f72 6d61 6c69 7a65  =True, normalize
+00061240: 3d46 616c 7365 290d 0a20 2020 2065 6c73  =False)..    els
+00061250: 653a 0d0a 2020 2020 2020 2020 6966 206d  e:..        if m
+00061260: 6f64 656c 7479 7065 203d 3d20 2742 696e  odeltype == 'Bin
+00061270: 6172 795f 436c 6173 7369 6669 6361 7469  ary_Classificati
+00061280: 6f6e 273a 0d0a 2020 2020 2020 2020 2020  on':..          
+00061290: 2020 6c6d 203d 204c 6f67 6973 7469 6352    lm = LogisticR
+000612a0: 6567 7265 7373 696f 6e28 433d 302e 3031  egression(C=0.01
+000612b0: 2c66 6974 5f69 6e74 6572 6365 7074 3d54  ,fit_intercept=T
+000612c0: 7275 652c 2074 6f6c 3d74 6f6c 6572 616e  rue, tol=toleran
+000612d0: 6365 2c0d 0a20 2020 2020 2020 2020 2020  ce,..           
 000612e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000612f0: 2020 2020 2020 6d61 785f 6974 6572 3d6d        max_iter=m
-00061300: 6178 5f69 7465 722c 736f 6c76 6572 3d27  ax_iter,solver='
-00061310: 6c69 626c 696e 6561 7227 2c6e 5f6a 6f62  liblinear',n_job
-00061320: 733d 2d31 2c0d 0a20 2020 2020 2020 2020  s=-1,..         
-00061330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00061340: 2070 656e 616c 7479 3d27 6c32 272c 6475   penalty='l2',du
-00061350: 616c 3d46 616c 7365 2c20 7261 6e64 6f6d  al=False, random
-00061360: 5f73 7461 7465 3d30 290d 0a20 2020 2020  _state=0)..     
-00061370: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00061380: 2020 2020 2020 6c6d 203d 204c 6f67 6973        lm = Logis
-00061390: 7469 6352 6567 7265 7373 696f 6e28 6d75  ticRegression(mu
-000613a0: 6c74 695f 636c 6173 733d 276f 7672 272c  lti_class='ovr',
-000613b0: 206d 6178 5f69 7465 723d 3130 3030 3029   max_iter=10000)
-000613c0: 2023 2320 6c6f 6769 7374 6963 2073 6565   ## logistic see
-000613d0: 6d73 2062 6573 7420 616d 6f6e 6720 616c  ms best among al
-000613e0: 6c0d 0a20 2020 2023 2323 2323 2323 2323  l..    #########
-000613f0: 2323 2048 6572 6520 7374 6172 7473 2074  ## Here starts t
-00061400: 6865 2063 6f6e 7665 7273 696f 6e20 6f66  he conversion of
-00061410: 2058 2076 6172 6961 626c 6573 2069 6e74   X variables int
-00061420: 6f20 5465 7874 2066 6561 7475 7265 2076  o Text feature v
-00061430: 6172 6961 626c 6520 6e61 6d65 7320 2323  ariable names ##
-00061440: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00061450: 2323 230d 0a20 2020 2058 5031 203d 2070  ###..    XP1 = p
-00061460: 642e 4461 7461 4672 616d 6528 5850 2c69  d.DataFrame(XP,i
-00061470: 6e64 6578 3d6f 7269 675f 6461 7461 5f69  ndex=orig_data_i
-00061480: 6e64 6578 2c20 636f 6c75 6d6e 733d 786e  ndex, columns=xn
-00061490: 616d 6573 2920 2323 2058 5031 2068 6173  ames) ## XP1 has
-000614a0: 2061 6c6c 2074 6865 2058 7661 7273 3a69   all the Xvars:i
-000614b0: 6e63 6c20 6f72 6967 2b70 6f6c 792b 696e  ncl orig+poly+in
-000614c0: 7478 6e20 7661 7273 0d0a 2020 2020 785f  txn vars..    x_
-000614d0: 7661 7273 203d 2078 6e61 6d65 735b 3a6e  vars = xnames[:n
-000614e0: 5f6f 7269 675f 6665 6174 7572 6573 5d20  _orig_features] 
-000614f0: 2023 2323 2078 5f76 6172 7320 636f 6e74   ### x_vars cont
-00061500: 6169 6e20 785f 7661 7269 6162 6c65 7320  ain x_variables 
-00061510: 7375 6368 2061 7320 2778 3127 0d0a 2020  such as 'x1'..  
-00061520: 2020 2323 2323 2046 6561 7475 7265 5f78    #### Feature_x
-00061530: 7661 725f 6469 6374 2077 696c 6c20 6d61  var_dict will ma
-00061540: 7020 7468 6520 585f 7661 7273 2c20 5371  p the X_vars, Sq
-00061550: 7561 7265 645f 7661 7273 2061 6e64 2049  uared_vars and I
-00061560: 6e74 786e 5f76 6172 7320 6261 636b 2074  ntxn_vars back t
-00061570: 6f20 2054 6578 7420 7661 7273 2069 6e20  o  Text vars in 
-00061580: 6f6e 6520 7661 7269 6162 6c65 0d0a 2020  one variable..  
-00061590: 2020 6665 6174 7572 655f 7876 6172 5f64    feature_xvar_d
-000615a0: 6963 7420 3d20 6469 6374 287a 6970 2878  ict = dict(zip(x
-000615b0: 5f76 6172 732c 7072 6564 6963 746f 7273  _vars,predictors
-000615c0: 2929 2023 2323 0d0a 2020 2020 6966 2066  )) ###..    if f
-000615d0: 6974 5f66 6c61 673a 0d0a 2020 2020 2020  it_flag:..      
-000615e0: 2020 2323 2323 2049 6620 7468 6572 6520    #### If there 
-000615f0: 6973 2066 6974 7469 6e67 2074 6f20 6265  is fitting to be
-00061600: 2064 6f6e 652c 2074 6865 6e20 796f 7520   done, then you 
-00061610: 6d75 7374 2064 6f20 7468 6973 2023 2323  must do this ###
-00061620: 0d0a 2020 2020 2020 2020 6966 2041 6464  ..        if Add
-00061630: 5f50 6f6c 7920 3d3d 2031 3a20 2323 2323  _Poly == 1: ####
-00061640: 2054 6869 7320 6164 6473 206f 6e6c 7920   This adds only 
-00061650: 496e 7465 7261 6374 696f 6e20 7661 7269  Interaction vari
-00061660: 6162 6c65 7320 3d3e 206e 6f20 506f 6c79  ables => no Poly
-00061670: 6e6f 6d69 616c 7321 0d0a 2020 2020 2020  nomials!..      
-00061680: 2020 2020 2020 7371 5f76 6172 7320 3d20        sq_vars = 
-00061690: 5b5d 2020 2020 2323 2320 7371 5f76 6172  []    ### sq_var
-000616a0: 7320 636f 6e74 6169 6e20 6f6e 6c79 2078  s contain only x
-000616b0: 2d73 7175 6172 6564 2076 6172 6961 626c  -squared variabl
-000616c0: 6573 2073 7563 6820 6173 2027 785e 3227  es such as 'x^2'
-000616d0: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
-000616e0: 7478 6e5f 7661 7273 203d 206c 6566 745f  txn_vars = left_
-000616f0: 7375 6274 7261 6374 2878 6e61 6d65 732c  subtract(xnames,
-00061700: 2073 715f 7661 7273 2b78 5f76 6172 7329   sq_vars+x_vars)
-00061710: 2023 2323 2069 6e74 786e 5f76 6172 7320   ### intxn_vars 
-00061720: 636f 6e74 6169 6e20 696e 7465 7261 6374  contain interact
-00061730: 696f 6e20 7661 7273 2073 7563 6820 6173  ion vars such as
-00061740: 2027 7831 2078 3227 0d0a 2020 2020 2020   'x1 x2'..      
-00061750: 2020 656c 6966 2041 6464 5f50 6f6c 7920    elif Add_Poly 
-00061760: 3d3d 2032 3a20 2323 2323 2054 6869 7320  == 2: #### This 
-00061770: 6164 6473 206f 6e6c 7920 506f 6c79 6e6f  adds only Polyno
-00061780: 6d69 616c 2076 6172 6961 626c 6573 203d  mial variables =
-00061790: 3e20 6e6f 2049 6e74 6572 6163 7469 6f6e  > no Interaction
-000617a0: 7321 0d0a 2020 2020 2020 2020 2020 2020  s!..            
-000617b0: 7371 5f76 6172 7320 3d20 5b78 2066 6f72  sq_vars = [x for
-000617c0: 2078 2069 6e20 786e 616d 6573 2069 6620   x in xnames if 
-000617d0: 275e 3227 2069 6e20 785d 2020 2020 2323  '^2' in x]    ##
-000617e0: 2320 7371 5f76 6172 7320 636f 6e74 6169  # sq_vars contai
-000617f0: 6e20 6f6e 6c79 2078 2d73 7175 6172 6564  n only x-squared
-00061800: 2076 6172 6961 626c 6573 2073 7563 6820   variables such 
-00061810: 6173 2027 785e 3227 0d0a 2020 2020 2020  as 'x^2'..      
-00061820: 2020 2020 2020 696e 7478 6e5f 7661 7273        intxn_vars
-00061830: 203d 205b 5d20 2323 2320 696e 7478 6e5f   = [] ### intxn_
-00061840: 7661 7273 2063 6f6e 7461 696e 2069 6e74  vars contain int
-00061850: 6572 6163 7469 6f6e 2076 6172 7320 7375  eraction vars su
-00061860: 6368 2061 7320 2778 3120 7832 270d 0a20  ch as 'x1 x2'.. 
-00061870: 2020 2020 2020 2065 6c69 6620 4164 645f         elif Add_
-00061880: 506f 6c79 203d 3d20 333a 2023 2323 2320  Poly == 3: #### 
-00061890: 5468 6973 2061 6464 7320 426f 7468 2049  This adds Both I
-000618a0: 6e74 6572 6163 7469 6f6e 2061 6e64 2050  nteraction and P
-000618b0: 6f6c 796e 6f6d 6961 6c20 7661 7269 6162  olynomial variab
-000618c0: 6c65 7320 3d3e 2042 6573 7420 6f66 2042  les => Best of B
-000618d0: 6f74 6820 776f 726c 6473 210d 0a20 2020  oth worlds!..   
-000618e0: 2020 2020 2020 2020 2073 715f 7661 7273           sq_vars
-000618f0: 203d 205b 7820 666f 7220 7820 696e 2078   = [x for x in x
-00061900: 6e61 6d65 7320 6966 2027 5e32 2720 696e  names if '^2' in
-00061910: 2078 5d20 2020 2023 2323 2073 715f 7661   x]    ### sq_va
-00061920: 7273 2063 6f6e 7461 696e 206f 6e6c 7920  rs contain only 
-00061930: 782d 7371 7561 7265 6420 7661 7269 6162  x-squared variab
-00061940: 6c65 7320 7375 6368 2061 7320 2778 5e32  les such as 'x^2
-00061950: 270d 0a20 2020 2020 2020 2020 2020 2069  '..            i
-00061960: 6e74 786e 5f76 6172 7320 3d20 6c65 6674  ntxn_vars = left
-00061970: 5f73 7562 7472 6163 7428 786e 616d 6573  _subtract(xnames
-00061980: 2c20 7371 5f76 6172 732b 785f 7661 7273  , sq_vars+x_vars
-00061990: 2920 2323 2320 696e 7478 6e5f 7661 7273  ) ### intxn_vars
-000619a0: 2063 6f6e 7461 696e 2069 6e74 6572 6163   contain interac
-000619b0: 7469 6f6e 2076 6172 7320 7375 6368 2061  tion vars such a
-000619c0: 7320 2778 3120 7832 270d 0a20 2020 2020  s 'x1 x2'..     
-000619d0: 2020 2023 2323 2320 2049 7420 6973 206e     ####  It is n
-000619e0: 6f77 2074 696d 6520 746f 2063 7574 2064  ow time to cut d
-000619f0: 6f77 6e20 7468 6520 6f72 6967 696e 616c  own the original
-00061a00: 2078 5f76 6172 6961 626c 6573 2074 6f20   x_variables to 
-00061a10: 6a75 7374 2073 7175 6172 6564 2076 6172  just squared var
-00061a20: 6961 626c 6573 2061 6e64 206f 7269 6769  iables and origi
-00061a30: 6e61 6c73 2068 6572 6520 2323 2323 0d0a  nals here ####..
-00061a40: 2020 2020 2020 2020 6469 6374 5f76 6172          dict_var
-00061a50: 7320 3d20 6469 6374 287a 6970 2870 7265  s = dict(zip(pre
-00061a60: 6469 6374 6f72 732c 785f 7661 7273 2929  dictors,x_vars))
-00061a70: 2023 2323 2074 6869 7320 6973 2061 2064   ### this is a d
-00061a80: 6963 7469 6f6e 6172 7920 6d61 7070 696e  ictionary mappin
-00061a90: 6720 6f72 6967 696e 616c 2076 6172 6961  g original varia
-00061aa0: 626c 6573 2061 6e64 2074 6865 6972 2078  bles and their x
-00061ab0: 2d76 6172 6961 626c 6573 0d0a 2020 2020  -variables..    
-00061ac0: 2020 2020 7265 7665 7273 655f 6469 6374      reverse_dict
-00061ad0: 5f76 6172 7320 3d20 6469 6374 285b 2879  _vars = dict([(y
-00061ae0: 2c78 2920 666f 7220 2878 2c79 2920 696e  ,x) for (x,y) in
-00061af0: 2064 6963 745f 7661 7273 2e69 7465 6d73   dict_vars.items
-00061b00: 2829 5d29 2023 2323 2074 6869 7320 6d61  ()]) ### this ma
-00061b10: 7073 2074 6865 2078 2d76 6172 7320 746f  ps the x-vars to
-00061b20: 206f 7269 6769 6e61 6c20 7661 7273 0d0a   original vars..
-00061b30: 2020 2020 2020 2020 2323 2323 2320 4e6f          ##### No
-00061b40: 7720 6c65 7427 7320 636f 6e76 6572 7420  w let's convert 
-00061b50: 496e 7465 7261 6374 696f 6e20 785f 7661  Interaction x_va
-00061b60: 7269 6162 6c65 7320 696e 746f 2074 6865  riables into the
-00061b70: 6972 2063 6f72 7265 7370 6f6e 6469 6e67  ir corresponding
-00061b80: 2074 6578 7420 7661 7269 6162 6c65 730d   text variables.
-00061b90: 0a20 2020 2020 2020 2069 6e74 786e 5f74  .        intxn_t
-00061ba0: 6578 745f 7661 7273 203d 205b 5d0d 0a20  ext_vars = [].. 
-00061bb0: 2020 2020 2020 2066 6f72 2065 6163 685f         for each_
-00061bc0: 6974 656d 2069 6e20 696e 7478 6e5f 7661  item in intxn_va
-00061bd0: 7273 3a0d 0a20 2020 2020 2020 2020 2020  rs:..           
-00061be0: 2069 6620 6c65 6e28 6561 6368 5f69 7465   if len(each_ite
-00061bf0: 6d2e 7370 6c69 7428 2220 2229 2920 3d3d  m.split(" ")) ==
-00061c00: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
-00061c10: 2020 2020 2069 6e74 786e 5f74 6578 745f       intxn_text_
-00061c20: 7661 7273 2e61 7070 656e 6428 7265 7665  vars.append(reve
-00061c30: 7273 655f 6469 6374 5f76 6172 735b 6561  rse_dict_vars[ea
-00061c40: 6368 5f69 7465 6d5d 290d 0a20 2020 2020  ch_item])..     
-00061c50: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-00061c60: 7265 5f78 7661 725f 6469 6374 5b65 6163  re_xvar_dict[eac
-00061c70: 685f 6974 656d 5d20 3d20 7265 7665 7273  h_item] = revers
-00061c80: 655f 6469 6374 5f76 6172 735b 6561 6368  e_dict_vars[each
-00061c90: 5f69 7465 6d5d 0d0a 2020 2020 2020 2020  _item]..        
-00061ca0: 2020 2020 656c 6966 206c 656e 2865 6163      elif len(eac
-00061cb0: 685f 6974 656d 2e73 706c 6974 2822 2022  h_item.split(" "
-00061cc0: 2929 203d 3d20 323a 0d0a 2020 2020 2020  )) == 2:..      
-00061cd0: 2020 2020 2020 2020 2020 7477 6f5f 6974            two_it
-00061ce0: 656d 735f 6c69 7374 203d 2065 6163 685f  ems_list = each_
-00061cf0: 6974 656d 2e73 706c 6974 2822 2022 290d  item.split(" ").
-00061d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00061d10: 2066 756c 6c5f 696e 7478 6e5f 6e61 6d65   full_intxn_name
-00061d20: 203d 2072 6576 6572 7365 5f64 6963 745f   = reverse_dict_
-00061d30: 7661 7273 5b74 776f 5f69 7465 6d73 5f6c  vars[two_items_l
-00061d40: 6973 745b 305d 5d20 2b22 2022 2b20 7265  ist[0]] +" "+ re
-00061d50: 7665 7273 655f 6469 6374 5f76 6172 735b  verse_dict_vars[
-00061d60: 7477 6f5f 6974 656d 735f 6c69 7374 5b31  two_items_list[1
-00061d70: 5d5d 0d0a 2020 2020 2020 2020 2020 2020  ]]..            
-00061d80: 2020 2020 696e 7478 6e5f 7465 7874 5f76      intxn_text_v
-00061d90: 6172 732e 6170 7065 6e64 2866 756c 6c5f  ars.append(full_
-00061da0: 696e 7478 6e5f 6e61 6d65 290d 0a20 2020  intxn_name)..   
-00061db0: 2020 2020 2020 2020 2020 2020 2066 6561               fea
-00061dc0: 7475 7265 5f78 7661 725f 6469 6374 5b65  ture_xvar_dict[e
-00061dd0: 6163 685f 6974 656d 5d20 3d20 6675 6c6c  ach_item] = full
-00061de0: 5f69 6e74 786e 5f6e 616d 650d 0a20 2020  _intxn_name..   
-00061df0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00061e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00061e10: 7061 7373 0d0a 2020 2020 2020 2020 2323  pass..        ##
-00061e20: 2323 2320 4e6f 7720 6c65 7427 7320 636f  ### Now let's co
-00061e30: 6e76 6572 7420 5371 7561 7265 6420 785f  nvert Squared x_
-00061e40: 7661 7269 6162 6c65 7320 696e 746f 2074  variables into t
-00061e50: 6865 6972 2063 6f72 7265 7370 6f6e 6469  heir correspondi
-00061e60: 6e67 2074 6578 7420 7661 7269 6162 6c65  ng text variable
-00061e70: 730d 0a20 2020 2020 2020 2073 715f 7465  s..        sq_te
-00061e80: 7874 5f76 6172 7320 3d20 5b5d 0d0a 2020  xt_vars = []..  
-00061e90: 2020 2020 2020 666f 7220 6561 6368 5f73        for each_s
-00061ea0: 715f 6974 656d 2069 6e20 7371 5f76 6172  q_item in sq_var
-00061eb0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
-00061ec0: 6966 206c 656e 2865 6163 685f 7371 5f69  if len(each_sq_i
-00061ed0: 7465 6d2e 7370 6c69 7428 225e 2229 2920  tem.split("^")) 
-00061ee0: 3d3d 2032 3a0d 0a20 2020 2020 2020 2020  == 2:..         
-00061ef0: 2020 2020 2020 2074 776f 5f69 7465 6d5f         two_item_
-00061f00: 6c69 7374 203d 2065 6163 685f 7371 5f69  list = each_sq_i
-00061f10: 7465 6d2e 7370 6c69 7428 225e 2229 0d0a  tem.split("^")..
-00061f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00061f30: 6675 6c6c 5f73 715f 6e61 6d65 203d 2072  full_sq_name = r
-00061f40: 6576 6572 7365 5f64 6963 745f 7661 7273  everse_dict_vars
-00061f50: 5b74 776f 5f69 7465 6d5f 6c69 7374 5b30  [two_item_list[0
-00061f60: 5d5d 202b 225e 3222 0d0a 2020 2020 2020  ]] +"^2"..      
-00061f70: 2020 2020 2020 2020 2020 7371 5f74 6578            sq_tex
-00061f80: 745f 7661 7273 2e61 7070 656e 6428 6675  t_vars.append(fu
-00061f90: 6c6c 5f73 715f 6e61 6d65 290d 0a20 2020  ll_sq_name)..   
-00061fa0: 2020 2020 2020 2020 2020 2020 2066 6561               fea
-00061fb0: 7475 7265 5f78 7661 725f 6469 6374 5b65  ture_xvar_dict[e
-00061fc0: 6163 685f 7371 5f69 7465 6d5d 203d 2066  ach_sq_item] = f
-00061fd0: 756c 6c5f 7371 5f6e 616d 650d 0a20 2020  ull_sq_name..   
-00061fe0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00061ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00062000: 7061 7373 0d0a 2020 2020 2020 2020 2323  pass..        ##
-00062010: 2323 204e 6f77 2077 6520 6e65 6564 2074  ## Now we need t
-00062020: 6f20 636f 6d62 696e 6520 7468 6520 785f  o combine the x_
-00062030: 7661 7273 2c20 5371 7561 7265 645f 7661  vars, Squared_va
-00062040: 7273 2061 6e64 2074 6865 2049 6e74 786e  rs and the Intxn
-00062050: 5f76 6172 7320 746f 6765 7468 6572 2061  _vars together a
-00062060: 7320 5465 7874 2076 6172 7320 696e 206f  s Text vars in o
-00062070: 6e65 2076 6172 6961 626c 650d 0a20 2020  ne variable..   
-00062080: 2020 2020 2066 756c 6c5f 785f 7661 7273       full_x_vars
-00062090: 203d 2078 5f76 6172 7320 2b20 7371 5f76   = x_vars + sq_v
-000620a0: 6172 7320 2b20 696e 7478 6e5f 7661 7273  ars + intxn_vars
-000620b0: 0d0a 2020 2020 2020 2020 7465 7874 5f76  ..        text_v
-000620c0: 6172 7320 3d20 7072 6564 6963 746f 7273  ars = predictors
-000620d0: 202b 2073 715f 7465 7874 5f76 6172 7320   + sq_text_vars 
-000620e0: 2b20 696e 7478 6e5f 7465 7874 5f76 6172  + intxn_text_var
-000620f0: 7320 2323 2323 2074 6578 745f 7661 7273  s #### text_vars
-00062100: 206e 6f77 2063 6f6e 7461 696e 7320 616c   now contains al
-00062110: 6c20 7468 6520 7465 7874 2076 6572 7369  l the text versi
-00062120: 6f6e 206f 6620 782d 7661 7269 6162 6c65  on of x-variable
-00062130: 730d 0a20 2020 2020 2020 2069 6620 6c65  s..        if le
-00062140: 6e28 7465 7874 5f76 6172 7329 203d 3d20  n(text_vars) == 
-00062150: 6c65 6e28 6675 6c6c 5f78 5f76 6172 7329  len(full_x_vars)
-00062160: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-00062170: 7269 6e74 2827 5375 6363 6573 7366 756c  rint('Successful
-00062180: 6c79 2074 7261 6e73 666f 726d 6564 2078  ly transformed x
-00062190: 2d76 6172 6961 626c 6573 2069 6e74 6f20  -variables into 
-000621a0: 7465 7874 2d76 6172 6961 626c 6573 2061  text-variables a
-000621b0: 6674 6572 2050 6f6c 796e 6f6d 6961 6c20  fter Polynomial 
-000621c0: 7472 616e 7366 6f72 6d61 7469 6f6e 7327  transformations'
-000621d0: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-000621e0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-000621f0: 696e 7428 2745 7272 6f72 3a20 4e6f 7420  int('Error: Not 
-00062200: 6162 6c65 2074 6f20 7472 616e 7366 6f72  able to transfor
-00062210: 6d20 782d 7661 7269 6162 6c65 7320 696e  m x-variables in
-00062220: 746f 2074 6578 742d 7661 7269 6162 6c65  to text-variable
-00062230: 732e 2043 6f6e 7469 6e75 696e 6720 7769  s. Continuing wi
-00062240: 7468 6f75 7420 506f 6c79 2076 6172 732e  thout Poly vars.
-00062250: 2e2e 2729 0d0a 2020 2020 2020 2020 2020  ..')..          
-00062260: 2020 7265 7475 726e 2070 7265 6469 6374    return predict
-00062270: 6f72 732c 206c 6d2c 2058 5031 2c20 6d64  ors, lm, XP1, md
-00062280: 2c20 785f 7661 7273 2c66 6561 7475 7265  , x_vars,feature
-00062290: 5f78 7661 725f 6469 6374 0d0a 2020 2020  _xvar_dict..    
-000622a0: 2020 2020 6665 6174 7572 655f 7465 7874      feature_text
-000622b0: 7661 725f 6469 6374 2020 3d20 6469 6374  var_dict  = dict
-000622c0: 285b 2879 2c78 2920 666f 7220 2878 2c79  ([(y,x) for (x,y
-000622d0: 2920 696e 2066 6561 7475 7265 5f78 7661  ) in feature_xva
-000622e0: 725f 6469 6374 2e69 7465 6d73 2829 5d29  r_dict.items()])
-000622f0: 0d0a 2020 2020 2020 2020 2323 2323 204e  ..        #### N
-00062300: 6f77 2042 7569 6c64 2061 2044 6174 6120  ow Build a Data 
-00062310: 4672 616d 6520 636f 6e74 6169 6e69 6e67  Frame containing
-00062320: 2063 6f6e 7461 696e 696e 6720 6164 6469   containing addi
-00062330: 7469 6f6e 616c 2050 6f6c 7920 616e 6420  tional Poly and 
-00062340: 496e 7478 6e20 7661 7269 6162 6c65 7320  Intxn variables 
-00062350: 696e 2078 2d66 6f72 6d61 7420 6865 7265  in x-format here
-00062360: 2023 2323 230d 0a20 2020 2020 2020 206e   ####..        n
-00062370: 6577 5f61 6464 785f 7661 7273 203d 2073  ew_addx_vars = s
-00062380: 715f 7661 7273 2b69 6e74 786e 5f76 6172  q_vars+intxn_var
-00062390: 730d 0a20 2020 2020 2020 2069 6620 6c65  s..        if le
-000623a0: 6e28 6e65 775f 6164 6478 5f76 6172 7329  n(new_addx_vars)
-000623b0: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
-000623c0: 2020 2020 7072 696e 7428 2745 7272 6f72      print('Error
-000623d0: 3a20 5468 6572 6520 6172 6520 6e6f 2073  : There are no s
-000623e0: 7175 6172 6564 206f 7220 696e 7465 7261  quared or intera
-000623f0: 6374 696f 6e20 7661 7273 2074 6f20 6164  ction vars to ad
-00062400: 642e 2043 6f6e 7469 6e75 696e 6720 7769  d. Continuing wi
-00062410: 7468 6f75 7420 506f 6c79 2076 6172 732e  thout Poly vars.
-00062420: 2e2e 2729 0d0a 2020 2020 2020 2020 2020  ..')..          
-00062430: 2020 7265 7475 726e 2070 7265 6469 6374    return predict
-00062440: 6f72 732c 206c 6d2c 2058 5031 2c20 6d64  ors, lm, XP1, md
-00062450: 2c20 785f 7661 7273 2c66 6561 7475 7265  , x_vars,feature
-00062460: 5f78 7661 725f 6469 6374 0d0a 2020 2020  _xvar_dict..    
-00062470: 2020 2020 2323 2323 2020 5765 2064 6566      ####  We def
-00062480: 696e 6520 3220 6461 7461 2066 7261 6d65  ine 2 data frame
-00062490: 733a 206f 6e65 2066 6f72 2072 656d 6f76  s: one for remov
-000624a0: 696e 6720 6869 6768 6c79 2063 6f72 7265  ing highly corre
-000624b0: 6c61 7465 6420 7661 7273 2061 6e64 206f  lated vars and o
-000624c0: 7468 6572 2066 6f72 204c 6173 736f 2073  ther for Lasso s
-000624d0: 656c 6563 7469 6f6e 0d0a 2020 2020 2020  election..      
-000624e0: 2020 5850 3220 3d20 5850 315b 6e65 775f    XP2 = XP1[new_
-000624f0: 6164 6478 5f76 6172 735d 2e6a 6f69 6e28  addx_vars].join(
-00062500: 5929 0d0a 2020 2020 2020 2020 5850 3158  Y)..        XP1X
-00062510: 203d 2058 5031 5b6e 6577 5f61 6464 785f   = XP1[new_addx_
-00062520: 7661 7273 5d0d 0a20 2020 2020 2020 206e  vars]..        n
-00062530: 6577 5f61 6464 7465 7874 5f76 6172 7320  ew_addtext_vars 
-00062540: 3d20 5b66 6561 7475 7265 5f78 7661 725f  = [feature_xvar_
-00062550: 6469 6374 5b78 5d20 666f 7220 7820 696e  dict[x] for x in
-00062560: 206e 6577 5f61 6464 785f 7661 7273 5d0d   new_addx_vars].
-00062570: 0a20 2020 2020 2020 2058 5032 2e63 6f6c  .        XP2.col
-00062580: 756d 6e73 203d 206e 6577 5f61 6464 7465  umns = new_addte
-00062590: 7874 5f76 6172 732b 5b74 6172 6765 7476  xt_vars+[targetv
-000625a0: 6172 5d0d 0a20 2020 2020 2020 2058 5031  ar]..        XP1
-000625b0: 582e 636f 6c75 6d6e 7320 3d20 6e65 775f  X.columns = new_
-000625c0: 6164 6474 6578 745f 7661 7273 0d0a 2020  addtext_vars..  
-000625d0: 2020 2020 2020 2323 2323 2323 2323 2323        ##########
+000612f0: 206d 6178 5f69 7465 723d 6d61 785f 6974   max_iter=max_it
+00061300: 6572 2c73 6f6c 7665 723d 276c 6962 6c69  er,solver='libli
+00061310: 6e65 6172 272c 6e5f 6a6f 6273 3d2d 312c  near',n_jobs=-1,
+00061320: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00061330: 2020 2020 2020 2020 2020 2020 7065 6e61              pena
+00061340: 6c74 793d 276c 3227 2c64 7561 6c3d 4661  lty='l2',dual=Fa
+00061350: 6c73 652c 2072 616e 646f 6d5f 7374 6174  lse, random_stat
+00061360: 653d 3029 0d0a 2020 2020 2020 2020 656c  e=0)..        el
+00061370: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00061380: 206c 6d20 3d20 4c6f 6769 7374 6963 5265   lm = LogisticRe
+00061390: 6772 6573 7369 6f6e 286d 756c 7469 5f63  gression(multi_c
+000613a0: 6c61 7373 3d27 6f76 7227 2c20 6d61 785f  lass='ovr', max_
+000613b0: 6974 6572 3d31 3030 3030 2920 2323 206c  iter=10000) ## l
+000613c0: 6f67 6973 7469 6320 7365 656d 7320 6265  ogistic seems be
+000613d0: 7374 2061 6d6f 6e67 2061 6c6c 0d0a 2020  st among all..  
+000613e0: 2020 2323 2323 2323 2323 2323 2320 4865    ########### He
+000613f0: 7265 2073 7461 7274 7320 7468 6520 636f  re starts the co
+00061400: 6e76 6572 7369 6f6e 206f 6620 5820 7661  nversion of X va
+00061410: 7269 6162 6c65 7320 696e 746f 2054 6578  riables into Tex
+00061420: 7420 6665 6174 7572 6520 7661 7269 6162  t feature variab
+00061430: 6c65 206e 616d 6573 2023 2323 2323 2323  le names #######
+00061440: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+00061450: 2020 2020 5850 3120 3d20 7064 2e44 6174      XP1 = pd.Dat
+00061460: 6146 7261 6d65 2858 502c 696e 6465 783d  aFrame(XP,index=
+00061470: 6f72 6967 5f64 6174 615f 696e 6465 782c  orig_data_index,
+00061480: 2063 6f6c 756d 6e73 3d78 6e61 6d65 7329   columns=xnames)
+00061490: 2023 2320 5850 3120 6861 7320 616c 6c20   ## XP1 has all 
+000614a0: 7468 6520 5876 6172 733a 696e 636c 206f  the Xvars:incl o
+000614b0: 7269 672b 706f 6c79 2b69 6e74 786e 2076  rig+poly+intxn v
+000614c0: 6172 730d 0a20 2020 2078 5f76 6172 7320  ars..    x_vars 
+000614d0: 3d20 786e 616d 6573 5b3a 6e5f 6f72 6967  = xnames[:n_orig
+000614e0: 5f66 6561 7475 7265 735d 2020 2323 2320  _features]  ### 
+000614f0: 785f 7661 7273 2063 6f6e 7461 696e 2078  x_vars contain x
+00061500: 5f76 6172 6961 626c 6573 2073 7563 6820  _variables such 
+00061510: 6173 2027 7831 270d 0a20 2020 2023 2323  as 'x1'..    ###
+00061520: 2320 4665 6174 7572 655f 7876 6172 5f64  # Feature_xvar_d
+00061530: 6963 7420 7769 6c6c 206d 6170 2074 6865  ict will map the
+00061540: 2058 5f76 6172 732c 2053 7175 6172 6564   X_vars, Squared
+00061550: 5f76 6172 7320 616e 6420 496e 7478 6e5f  _vars and Intxn_
+00061560: 7661 7273 2062 6163 6b20 746f 2020 5465  vars back to  Te
+00061570: 7874 2076 6172 7320 696e 206f 6e65 2076  xt vars in one v
+00061580: 6172 6961 626c 650d 0a20 2020 2066 6561  ariable..    fea
+00061590: 7475 7265 5f78 7661 725f 6469 6374 203d  ture_xvar_dict =
+000615a0: 2064 6963 7428 7a69 7028 785f 7661 7273   dict(zip(x_vars
+000615b0: 2c70 7265 6469 6374 6f72 7329 2920 2323  ,predictors)) ##
+000615c0: 230d 0a20 2020 2069 6620 6669 745f 666c  #..    if fit_fl
+000615d0: 6167 3a0d 0a20 2020 2020 2020 2023 2323  ag:..        ###
+000615e0: 2320 4966 2074 6865 7265 2069 7320 6669  # If there is fi
+000615f0: 7474 696e 6720 746f 2062 6520 646f 6e65  tting to be done
+00061600: 2c20 7468 656e 2079 6f75 206d 7573 7420  , then you must 
+00061610: 646f 2074 6869 7320 2323 230d 0a20 2020  do this ###..   
+00061620: 2020 2020 2069 6620 4164 645f 506f 6c79       if Add_Poly
+00061630: 203d 3d20 313a 2023 2323 2320 5468 6973   == 1: #### This
+00061640: 2061 6464 7320 6f6e 6c79 2049 6e74 6572   adds only Inter
+00061650: 6163 7469 6f6e 2076 6172 6961 626c 6573  action variables
+00061660: 203d 3e20 6e6f 2050 6f6c 796e 6f6d 6961   => no Polynomia
+00061670: 6c73 210d 0a20 2020 2020 2020 2020 2020  ls!..           
+00061680: 2073 715f 7661 7273 203d 205b 5d20 2020   sq_vars = []   
+00061690: 2023 2323 2073 715f 7661 7273 2063 6f6e   ### sq_vars con
+000616a0: 7461 696e 206f 6e6c 7920 782d 7371 7561  tain only x-squa
+000616b0: 7265 6420 7661 7269 6162 6c65 7320 7375  red variables su
+000616c0: 6368 2061 7320 2778 5e32 270d 0a20 2020  ch as 'x^2'..   
+000616d0: 2020 2020 2020 2020 2069 6e74 786e 5f76           intxn_v
+000616e0: 6172 7320 3d20 6c65 6674 5f73 7562 7472  ars = left_subtr
+000616f0: 6163 7428 786e 616d 6573 2c20 7371 5f76  act(xnames, sq_v
+00061700: 6172 732b 785f 7661 7273 2920 2323 2320  ars+x_vars) ### 
+00061710: 696e 7478 6e5f 7661 7273 2063 6f6e 7461  intxn_vars conta
+00061720: 696e 2069 6e74 6572 6163 7469 6f6e 2076  in interaction v
+00061730: 6172 7320 7375 6368 2061 7320 2778 3120  ars such as 'x1 
+00061740: 7832 270d 0a20 2020 2020 2020 2065 6c69  x2'..        eli
+00061750: 6620 4164 645f 506f 6c79 203d 3d20 323a  f Add_Poly == 2:
+00061760: 2023 2323 2320 5468 6973 2061 6464 7320   #### This adds 
+00061770: 6f6e 6c79 2050 6f6c 796e 6f6d 6961 6c20  only Polynomial 
+00061780: 7661 7269 6162 6c65 7320 3d3e 206e 6f20  variables => no 
+00061790: 496e 7465 7261 6374 696f 6e73 210d 0a20  Interactions!.. 
+000617a0: 2020 2020 2020 2020 2020 2073 715f 7661             sq_va
+000617b0: 7273 203d 205b 7820 666f 7220 7820 696e  rs = [x for x in
+000617c0: 2078 6e61 6d65 7320 6966 2027 5e32 2720   xnames if '^2' 
+000617d0: 696e 2078 5d20 2020 2023 2323 2073 715f  in x]    ### sq_
+000617e0: 7661 7273 2063 6f6e 7461 696e 206f 6e6c  vars contain onl
+000617f0: 7920 782d 7371 7561 7265 6420 7661 7269  y x-squared vari
+00061800: 6162 6c65 7320 7375 6368 2061 7320 2778  ables such as 'x
+00061810: 5e32 270d 0a20 2020 2020 2020 2020 2020  ^2'..           
+00061820: 2069 6e74 786e 5f76 6172 7320 3d20 5b5d   intxn_vars = []
+00061830: 2023 2323 2069 6e74 786e 5f76 6172 7320   ### intxn_vars 
+00061840: 636f 6e74 6169 6e20 696e 7465 7261 6374  contain interact
+00061850: 696f 6e20 7661 7273 2073 7563 6820 6173  ion vars such as
+00061860: 2027 7831 2078 3227 0d0a 2020 2020 2020   'x1 x2'..      
+00061870: 2020 656c 6966 2041 6464 5f50 6f6c 7920    elif Add_Poly 
+00061880: 3d3d 2033 3a20 2323 2323 2054 6869 7320  == 3: #### This 
+00061890: 6164 6473 2042 6f74 6820 496e 7465 7261  adds Both Intera
+000618a0: 6374 696f 6e20 616e 6420 506f 6c79 6e6f  ction and Polyno
+000618b0: 6d69 616c 2076 6172 6961 626c 6573 203d  mial variables =
+000618c0: 3e20 4265 7374 206f 6620 426f 7468 2077  > Best of Both w
+000618d0: 6f72 6c64 7321 0d0a 2020 2020 2020 2020  orlds!..        
+000618e0: 2020 2020 7371 5f76 6172 7320 3d20 5b78      sq_vars = [x
+000618f0: 2066 6f72 2078 2069 6e20 786e 616d 6573   for x in xnames
+00061900: 2069 6620 275e 3227 2069 6e20 785d 2020   if '^2' in x]  
+00061910: 2020 2323 2320 7371 5f76 6172 7320 636f    ### sq_vars co
+00061920: 6e74 6169 6e20 6f6e 6c79 2078 2d73 7175  ntain only x-squ
+00061930: 6172 6564 2076 6172 6961 626c 6573 2073  ared variables s
+00061940: 7563 6820 6173 2027 785e 3227 0d0a 2020  uch as 'x^2'..  
+00061950: 2020 2020 2020 2020 2020 696e 7478 6e5f            intxn_
+00061960: 7661 7273 203d 206c 6566 745f 7375 6274  vars = left_subt
+00061970: 7261 6374 2878 6e61 6d65 732c 2073 715f  ract(xnames, sq_
+00061980: 7661 7273 2b78 5f76 6172 7329 2023 2323  vars+x_vars) ###
+00061990: 2069 6e74 786e 5f76 6172 7320 636f 6e74   intxn_vars cont
+000619a0: 6169 6e20 696e 7465 7261 6374 696f 6e20  ain interaction 
+000619b0: 7661 7273 2073 7563 6820 6173 2027 7831  vars such as 'x1
+000619c0: 2078 3227 0d0a 2020 2020 2020 2020 2323   x2'..        ##
+000619d0: 2323 2020 4974 2069 7320 6e6f 7720 7469  ##  It is now ti
+000619e0: 6d65 2074 6f20 6375 7420 646f 776e 2074  me to cut down t
+000619f0: 6865 206f 7269 6769 6e61 6c20 785f 7661  he original x_va
+00061a00: 7269 6162 6c65 7320 746f 206a 7573 7420  riables to just 
+00061a10: 7371 7561 7265 6420 7661 7269 6162 6c65  squared variable
+00061a20: 7320 616e 6420 6f72 6967 696e 616c 7320  s and originals 
+00061a30: 6865 7265 2023 2323 230d 0a20 2020 2020  here ####..     
+00061a40: 2020 2064 6963 745f 7661 7273 203d 2064     dict_vars = d
+00061a50: 6963 7428 7a69 7028 7072 6564 6963 746f  ict(zip(predicto
+00061a60: 7273 2c78 5f76 6172 7329 2920 2323 2320  rs,x_vars)) ### 
+00061a70: 7468 6973 2069 7320 6120 6469 6374 696f  this is a dictio
+00061a80: 6e61 7279 206d 6170 7069 6e67 206f 7269  nary mapping ori
+00061a90: 6769 6e61 6c20 7661 7269 6162 6c65 7320  ginal variables 
+00061aa0: 616e 6420 7468 6569 7220 782d 7661 7269  and their x-vari
+00061ab0: 6162 6c65 730d 0a20 2020 2020 2020 2072  ables..        r
+00061ac0: 6576 6572 7365 5f64 6963 745f 7661 7273  everse_dict_vars
+00061ad0: 203d 2064 6963 7428 5b28 792c 7829 2066   = dict([(y,x) f
+00061ae0: 6f72 2028 782c 7929 2069 6e20 6469 6374  or (x,y) in dict
+00061af0: 5f76 6172 732e 6974 656d 7328 295d 2920  _vars.items()]) 
+00061b00: 2323 2320 7468 6973 206d 6170 7320 7468  ### this maps th
+00061b10: 6520 782d 7661 7273 2074 6f20 6f72 6967  e x-vars to orig
+00061b20: 696e 616c 2076 6172 730d 0a20 2020 2020  inal vars..     
+00061b30: 2020 2023 2323 2323 204e 6f77 206c 6574     ##### Now let
+00061b40: 2773 2063 6f6e 7665 7274 2049 6e74 6572  's convert Inter
+00061b50: 6163 7469 6f6e 2078 5f76 6172 6961 626c  action x_variabl
+00061b60: 6573 2069 6e74 6f20 7468 6569 7220 636f  es into their co
+00061b70: 7272 6573 706f 6e64 696e 6720 7465 7874  rresponding text
+00061b80: 2076 6172 6961 626c 6573 0d0a 2020 2020   variables..    
+00061b90: 2020 2020 696e 7478 6e5f 7465 7874 5f76      intxn_text_v
+00061ba0: 6172 7320 3d20 5b5d 0d0a 2020 2020 2020  ars = []..      
+00061bb0: 2020 666f 7220 6561 6368 5f69 7465 6d20    for each_item 
+00061bc0: 696e 2069 6e74 786e 5f76 6172 733a 0d0a  in intxn_vars:..
+00061bd0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00061be0: 656e 2865 6163 685f 6974 656d 2e73 706c  en(each_item.spl
+00061bf0: 6974 2822 2022 2929 203d 3d20 313a 0d0a  it(" ")) == 1:..
+00061c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00061c10: 696e 7478 6e5f 7465 7874 5f76 6172 732e  intxn_text_vars.
+00061c20: 6170 7065 6e64 2872 6576 6572 7365 5f64  append(reverse_d
+00061c30: 6963 745f 7661 7273 5b65 6163 685f 6974  ict_vars[each_it
+00061c40: 656d 5d29 0d0a 2020 2020 2020 2020 2020  em])..          
+00061c50: 2020 2020 2020 6665 6174 7572 655f 7876        feature_xv
+00061c60: 6172 5f64 6963 745b 6561 6368 5f69 7465  ar_dict[each_ite
+00061c70: 6d5d 203d 2072 6576 6572 7365 5f64 6963  m] = reverse_dic
+00061c80: 745f 7661 7273 5b65 6163 685f 6974 656d  t_vars[each_item
+00061c90: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
+00061ca0: 6c69 6620 6c65 6e28 6561 6368 5f69 7465  lif len(each_ite
+00061cb0: 6d2e 7370 6c69 7428 2220 2229 2920 3d3d  m.split(" ")) ==
+00061cc0: 2032 3a0d 0a20 2020 2020 2020 2020 2020   2:..           
+00061cd0: 2020 2020 2074 776f 5f69 7465 6d73 5f6c       two_items_l
+00061ce0: 6973 7420 3d20 6561 6368 5f69 7465 6d2e  ist = each_item.
+00061cf0: 7370 6c69 7428 2220 2229 0d0a 2020 2020  split(" ")..    
+00061d00: 2020 2020 2020 2020 2020 2020 6675 6c6c              full
+00061d10: 5f69 6e74 786e 5f6e 616d 6520 3d20 7265  _intxn_name = re
+00061d20: 7665 7273 655f 6469 6374 5f76 6172 735b  verse_dict_vars[
+00061d30: 7477 6f5f 6974 656d 735f 6c69 7374 5b30  two_items_list[0
+00061d40: 5d5d 202b 2220 222b 2072 6576 6572 7365  ]] +" "+ reverse
+00061d50: 5f64 6963 745f 7661 7273 5b74 776f 5f69  _dict_vars[two_i
+00061d60: 7465 6d73 5f6c 6973 745b 315d 5d0d 0a20  tems_list[1]].. 
+00061d70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00061d80: 6e74 786e 5f74 6578 745f 7661 7273 2e61  ntxn_text_vars.a
+00061d90: 7070 656e 6428 6675 6c6c 5f69 6e74 786e  ppend(full_intxn
+00061da0: 5f6e 616d 6529 0d0a 2020 2020 2020 2020  _name)..        
+00061db0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+00061dc0: 7876 6172 5f64 6963 745b 6561 6368 5f69  xvar_dict[each_i
+00061dd0: 7465 6d5d 203d 2066 756c 6c5f 696e 7478  tem] = full_intx
+00061de0: 6e5f 6e61 6d65 0d0a 2020 2020 2020 2020  n_name..        
+00061df0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00061e00: 2020 2020 2020 2020 2020 2070 6173 730d             pass.
+00061e10: 0a20 2020 2020 2020 2023 2323 2323 204e  .        ##### N
+00061e20: 6f77 206c 6574 2773 2063 6f6e 7665 7274  ow let's convert
+00061e30: 2053 7175 6172 6564 2078 5f76 6172 6961   Squared x_varia
+00061e40: 626c 6573 2069 6e74 6f20 7468 6569 7220  bles into their 
+00061e50: 636f 7272 6573 706f 6e64 696e 6720 7465  corresponding te
+00061e60: 7874 2076 6172 6961 626c 6573 0d0a 2020  xt variables..  
+00061e70: 2020 2020 2020 7371 5f74 6578 745f 7661        sq_text_va
+00061e80: 7273 203d 205b 5d0d 0a20 2020 2020 2020  rs = []..       
+00061e90: 2066 6f72 2065 6163 685f 7371 5f69 7465   for each_sq_ite
+00061ea0: 6d20 696e 2073 715f 7661 7273 3a0d 0a20  m in sq_vars:.. 
+00061eb0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00061ec0: 6e28 6561 6368 5f73 715f 6974 656d 2e73  n(each_sq_item.s
+00061ed0: 706c 6974 2822 5e22 2929 203d 3d20 323a  plit("^")) == 2:
+00061ee0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00061ef0: 2020 7477 6f5f 6974 656d 5f6c 6973 7420    two_item_list 
+00061f00: 3d20 6561 6368 5f73 715f 6974 656d 2e73  = each_sq_item.s
+00061f10: 706c 6974 2822 5e22 290d 0a20 2020 2020  plit("^")..     
+00061f20: 2020 2020 2020 2020 2020 2066 756c 6c5f             full_
+00061f30: 7371 5f6e 616d 6520 3d20 7265 7665 7273  sq_name = revers
+00061f40: 655f 6469 6374 5f76 6172 735b 7477 6f5f  e_dict_vars[two_
+00061f50: 6974 656d 5f6c 6973 745b 305d 5d20 2b22  item_list[0]] +"
+00061f60: 5e32 220d 0a20 2020 2020 2020 2020 2020  ^2"..           
+00061f70: 2020 2020 2073 715f 7465 7874 5f76 6172       sq_text_var
+00061f80: 732e 6170 7065 6e64 2866 756c 6c5f 7371  s.append(full_sq
+00061f90: 5f6e 616d 6529 0d0a 2020 2020 2020 2020  _name)..        
+00061fa0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+00061fb0: 7876 6172 5f64 6963 745b 6561 6368 5f73  xvar_dict[each_s
+00061fc0: 715f 6974 656d 5d20 3d20 6675 6c6c 5f73  q_item] = full_s
+00061fd0: 715f 6e61 6d65 0d0a 2020 2020 2020 2020  q_name..        
+00061fe0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00061ff0: 2020 2020 2020 2020 2020 2070 6173 730d             pass.
+00062000: 0a20 2020 2020 2020 2023 2323 2320 4e6f  .        #### No
+00062010: 7720 7765 206e 6565 6420 746f 2063 6f6d  w we need to com
+00062020: 6269 6e65 2074 6865 2078 5f76 6172 732c  bine the x_vars,
+00062030: 2053 7175 6172 6564 5f76 6172 7320 616e   Squared_vars an
+00062040: 6420 7468 6520 496e 7478 6e5f 7661 7273  d the Intxn_vars
+00062050: 2074 6f67 6574 6865 7220 6173 2054 6578   together as Tex
+00062060: 7420 7661 7273 2069 6e20 6f6e 6520 7661  t vars in one va
+00062070: 7269 6162 6c65 0d0a 2020 2020 2020 2020  riable..        
+00062080: 6675 6c6c 5f78 5f76 6172 7320 3d20 785f  full_x_vars = x_
+00062090: 7661 7273 202b 2073 715f 7661 7273 202b  vars + sq_vars +
+000620a0: 2069 6e74 786e 5f76 6172 730d 0a20 2020   intxn_vars..   
+000620b0: 2020 2020 2074 6578 745f 7661 7273 203d       text_vars =
+000620c0: 2070 7265 6469 6374 6f72 7320 2b20 7371   predictors + sq
+000620d0: 5f74 6578 745f 7661 7273 202b 2069 6e74  _text_vars + int
+000620e0: 786e 5f74 6578 745f 7661 7273 2023 2323  xn_text_vars ###
+000620f0: 2320 7465 7874 5f76 6172 7320 6e6f 7720  # text_vars now 
+00062100: 636f 6e74 6169 6e73 2061 6c6c 2074 6865  contains all the
+00062110: 2074 6578 7420 7665 7273 696f 6e20 6f66   text version of
+00062120: 2078 2d76 6172 6961 626c 6573 0d0a 2020   x-variables..  
+00062130: 2020 2020 2020 6966 206c 656e 2874 6578        if len(tex
+00062140: 745f 7661 7273 2920 3d3d 206c 656e 2866  t_vars) == len(f
+00062150: 756c 6c5f 785f 7661 7273 293a 0d0a 2020  ull_x_vars):..  
+00062160: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00062170: 2753 7563 6365 7373 6675 6c6c 7920 7472  'Successfully tr
+00062180: 616e 7366 6f72 6d65 6420 782d 7661 7269  ansformed x-vari
+00062190: 6162 6c65 7320 696e 746f 2074 6578 742d  ables into text-
+000621a0: 7661 7269 6162 6c65 7320 6166 7465 7220  variables after 
+000621b0: 506f 6c79 6e6f 6d69 616c 2074 7261 6e73  Polynomial trans
+000621c0: 666f 726d 6174 696f 6e73 2729 0d0a 2020  formations')..  
+000621d0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+000621e0: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+000621f0: 4572 726f 723a 204e 6f74 2061 626c 6520  Error: Not able 
+00062200: 746f 2074 7261 6e73 666f 726d 2078 2d76  to transform x-v
+00062210: 6172 6961 626c 6573 2069 6e74 6f20 7465  ariables into te
+00062220: 7874 2d76 6172 6961 626c 6573 2e20 436f  xt-variables. Co
+00062230: 6e74 696e 7569 6e67 2077 6974 686f 7574  ntinuing without
+00062240: 2050 6f6c 7920 7661 7273 2e2e 2e27 290d   Poly vars...').
+00062250: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00062260: 7572 6e20 7072 6564 6963 746f 7273 2c20  urn predictors, 
+00062270: 6c6d 2c20 5850 312c 206d 642c 2078 5f76  lm, XP1, md, x_v
+00062280: 6172 732c 6665 6174 7572 655f 7876 6172  ars,feature_xvar
+00062290: 5f64 6963 740d 0a20 2020 2020 2020 2066  _dict..        f
+000622a0: 6561 7475 7265 5f74 6578 7476 6172 5f64  eature_textvar_d
+000622b0: 6963 7420 203d 2064 6963 7428 5b28 792c  ict  = dict([(y,
+000622c0: 7829 2066 6f72 2028 782c 7929 2069 6e20  x) for (x,y) in 
+000622d0: 6665 6174 7572 655f 7876 6172 5f64 6963  feature_xvar_dic
+000622e0: 742e 6974 656d 7328 295d 290d 0a20 2020  t.items()])..   
+000622f0: 2020 2020 2023 2323 2320 4e6f 7720 4275       #### Now Bu
+00062300: 696c 6420 6120 4461 7461 2046 7261 6d65  ild a Data Frame
+00062310: 2063 6f6e 7461 696e 696e 6720 636f 6e74   containing cont
+00062320: 6169 6e69 6e67 2061 6464 6974 696f 6e61  aining additiona
+00062330: 6c20 506f 6c79 2061 6e64 2049 6e74 786e  l Poly and Intxn
+00062340: 2076 6172 6961 626c 6573 2069 6e20 782d   variables in x-
+00062350: 666f 726d 6174 2068 6572 6520 2323 2323  format here ####
+00062360: 0d0a 2020 2020 2020 2020 6e65 775f 6164  ..        new_ad
+00062370: 6478 5f76 6172 7320 3d20 7371 5f76 6172  dx_vars = sq_var
+00062380: 732b 696e 7478 6e5f 7661 7273 0d0a 2020  s+intxn_vars..  
+00062390: 2020 2020 2020 6966 206c 656e 286e 6577        if len(new
+000623a0: 5f61 6464 785f 7661 7273 2920 3d3d 2030  _addx_vars) == 0
+000623b0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+000623c0: 7269 6e74 2827 4572 726f 723a 2054 6865  rint('Error: The
+000623d0: 7265 2061 7265 206e 6f20 7371 7561 7265  re are no square
+000623e0: 6420 6f72 2069 6e74 6572 6163 7469 6f6e  d or interaction
+000623f0: 2076 6172 7320 746f 2061 6464 2e20 436f   vars to add. Co
+00062400: 6e74 696e 7569 6e67 2077 6974 686f 7574  ntinuing without
+00062410: 2050 6f6c 7920 7661 7273 2e2e 2e27 290d   Poly vars...').
+00062420: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00062430: 7572 6e20 7072 6564 6963 746f 7273 2c20  urn predictors, 
+00062440: 6c6d 2c20 5850 312c 206d 642c 2078 5f76  lm, XP1, md, x_v
+00062450: 6172 732c 6665 6174 7572 655f 7876 6172  ars,feature_xvar
+00062460: 5f64 6963 740d 0a20 2020 2020 2020 2023  _dict..        #
+00062470: 2323 2320 2057 6520 6465 6669 6e65 2032  ###  We define 2
+00062480: 2064 6174 6120 6672 616d 6573 3a20 6f6e   data frames: on
+00062490: 6520 666f 7220 7265 6d6f 7669 6e67 2068  e for removing h
+000624a0: 6967 686c 7920 636f 7272 656c 6174 6564  ighly correlated
+000624b0: 2076 6172 7320 616e 6420 6f74 6865 7220   vars and other 
+000624c0: 666f 7220 4c61 7373 6f20 7365 6c65 6374  for Lasso select
+000624d0: 696f 6e0d 0a20 2020 2020 2020 2058 5032  ion..        XP2
+000624e0: 203d 2058 5031 5b6e 6577 5f61 6464 785f   = XP1[new_addx_
+000624f0: 7661 7273 5d2e 6a6f 696e 2859 290d 0a20  vars].join(Y).. 
+00062500: 2020 2020 2020 2058 5031 5820 3d20 5850         XP1X = XP
+00062510: 315b 6e65 775f 6164 6478 5f76 6172 735d  1[new_addx_vars]
+00062520: 0d0a 2020 2020 2020 2020 6e65 775f 6164  ..        new_ad
+00062530: 6474 6578 745f 7661 7273 203d 205b 6665  dtext_vars = [fe
+00062540: 6174 7572 655f 7876 6172 5f64 6963 745b  ature_xvar_dict[
+00062550: 785d 2066 6f72 2078 2069 6e20 6e65 775f  x] for x in new_
+00062560: 6164 6478 5f76 6172 735d 0d0a 2020 2020  addx_vars]..    
+00062570: 2020 2020 5850 322e 636f 6c75 6d6e 7320      XP2.columns 
+00062580: 3d20 6e65 775f 6164 6474 6578 745f 7661  = new_addtext_va
+00062590: 7273 2b5b 7461 7267 6574 7661 725d 0d0a  rs+[targetvar]..
+000625a0: 2020 2020 2020 2020 5850 3158 2e63 6f6c          XP1X.col
+000625b0: 756d 6e73 203d 206e 6577 5f61 6464 7465  umns = new_addte
+000625c0: 7874 5f76 6172 730d 0a20 2020 2020 2020  xt_vars..       
+000625d0: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
 000625e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000625f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00062600: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00062610: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062620: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
-00062630: 2020 2023 2323 2320 2020 2046 4153 5420     ####    FAST 
-00062640: 4645 4154 5552 4520 5245 4455 4354 494f  FEATURE REDUCTIO
-00062650: 4e20 5553 494e 4720 4c31 2052 4547 554c  N USING L1 REGUL
-00062660: 4152 495a 4154 494f 4e20 464f 5220 4c41  ARIZATION FOR LA
-00062670: 5247 4520 4441 5441 2053 4554 5320 2020  RGE DATA SETS   
-00062680: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
-00062690: 2323 2323 2020 2055 7365 204c 6173 736f  ####   Use Lasso
-000626a0: 4356 206f 7220 4c6f 6769 7374 6963 5265  CV or LogisticRe
-000626b0: 6772 6573 7369 6f6e 4356 2074 6f20 5265  gressionCV to Re
-000626c0: 6475 6365 2056 6172 6961 626c 6573 2075  duce Variables u
-000626d0: 7369 6e67 2052 6567 756c 6172 697a 6174  sing Regularizat
-000626e0: 696f 6e0d 0a20 2020 2020 2020 2023 2323  ion..        ###
+00062620: 2323 2323 0d0a 2020 2020 2020 2020 2323  ####..        ##
+00062630: 2323 2020 2020 4641 5354 2046 4541 5455  ##    FAST FEATU
+00062640: 5245 2052 4544 5543 5449 4f4e 2055 5349  RE REDUCTION USI
+00062650: 4e47 204c 3120 5245 4755 4c41 5249 5a41  NG L1 REGULARIZA
+00062660: 5449 4f4e 2046 4f52 204c 4152 4745 2044  TION FOR LARGE D
+00062670: 4154 4120 5345 5453 2020 2023 2323 2323  ATA SETS   #####
+00062680: 230d 0a20 2020 2020 2020 2023 2323 2320  #..        #### 
+00062690: 2020 5573 6520 4c61 7373 6f43 5620 6f72    Use LassoCV or
+000626a0: 204c 6f67 6973 7469 6352 6567 7265 7373   LogisticRegress
+000626b0: 696f 6e43 5620 746f 2052 6564 7563 6520  ionCV to Reduce 
+000626c0: 5661 7269 6162 6c65 7320 7573 696e 6720  Variables using 
+000626d0: 5265 6775 6c61 7269 7a61 7469 6f6e 0d0a  Regularization..
+000626e0: 2020 2020 2020 2020 2323 2323 2323 2323          ########
 000626f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00062700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00062710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00062720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062730: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062740: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-00062750: 2742 7569 6c64 696e 6720 436f 6d70 6172  'Building Compar
-00062760: 6973 6f6e 204d 6f64 656c 2077 6974 6820  ison Model with 
-00062770: 6f6e 6c79 2050 6f6c 7920 616e 6420 496e  only Poly and In
-00062780: 7465 7261 6374 696f 6e20 7661 7269 6162  teraction variab
-00062790: 6c65 732e 2e2e 2729 0d0a 2020 2020 2020  les...')..      
-000627a0: 2020 6c6d 5f70 2c20 5f20 3d20 7072 696e    lm_p, _ = prin
-000627b0: 745f 6d6f 6465 6c5f 6d65 7472 6963 7328  t_model_metrics(
-000627c0: 6d6f 6465 6c74 7970 652c 6c6d 2c58 5031  modeltype,lm,XP1
-000627d0: 582c 592c 5472 7565 290d 0a20 2020 2020  X,Y,True)..     
-000627e0: 2020 2070 7269 6e74 2827 2020 2020 5469     print('    Ti
-000627f0: 6d65 2054 616b 656e 3a20 2530 2e30 6620  me Taken: %0.0f 
-00062800: 2869 6e20 7365 636f 6e64 7329 2720 2528  (in seconds)' %(
-00062810: 7469 6d65 2e74 696d 6528 292d 7374 6172  time.time()-star
-00062820: 745f 7469 6d65 2929 0d0a 2020 2020 2020  t_time))..      
-00062830: 2020 2323 2323 2020 5765 206e 6565 6420    ####  We need 
-00062840: 746f 2062 7569 6c64 2061 2064 6174 6166  to build a dataf
-00062850: 7261 6d65 2074 6f20 686f 6c64 2063 6f65  rame to hold coe
-00062860: 6666 6963 6965 6e74 7320 6672 6f6d 2074  fficients from t
-00062870: 6865 206d 6f64 656c 2066 6f72 2065 6163  he model for eac
-00062880: 6820 7661 7269 6162 6c65 2023 2323 0d0a  h variable ###..
-00062890: 2020 2020 2020 2020 6466 7820 3d20 7064          dfx = pd
-000628a0: 2e44 6174 6146 7261 6d65 285b 6e65 775f  .DataFrame([new_
-000628b0: 6164 6478 5f76 6172 732c 206e 6577 5f61  addx_vars, new_a
-000628c0: 6464 7465 7874 5f76 6172 735d 290d 0a20  ddtext_vars]).. 
-000628d0: 2020 2020 2020 2064 6620 3d20 6466 782e         df = dfx.
-000628e0: 540d 0a20 2020 2020 2020 2064 662e 636f  T..        df.co
-000628f0: 6c75 6d6e 733d 5b27 5820 4e61 6d65 7327  lumns=['X Names'
-00062900: 2c27 496e 7465 7261 6374 696f 6e20 5661  ,'Interaction Va
-00062910: 7269 6162 6c65 204e 616d 6573 275d 0d0a  riable Names']..
-00062920: 2020 2020 2020 2020 2323 2323 2323 2323          ########
-00062930: 2323 2020 4e20 4f20 5720 2020 4220 5520  ##  N O W   B U 
-00062940: 4920 4c20 4420 2054 2048 2045 2020 4d20  I L D  T H E  M 
-00062950: 4f20 4420 4520 4c20 2323 2323 2323 2323  O D E L ########
+00062730: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+00062740: 2020 2020 2070 7269 6e74 2827 4275 696c       print('Buil
+00062750: 6469 6e67 2043 6f6d 7061 7269 736f 6e20  ding Comparison 
+00062760: 4d6f 6465 6c20 7769 7468 206f 6e6c 7920  Model with only 
+00062770: 506f 6c79 2061 6e64 2049 6e74 6572 6163  Poly and Interac
+00062780: 7469 6f6e 2076 6172 6961 626c 6573 2e2e  tion variables..
+00062790: 2e27 290d 0a20 2020 2020 2020 206c 6d5f  .')..        lm_
+000627a0: 702c 205f 203d 2070 7269 6e74 5f6d 6f64  p, _ = print_mod
+000627b0: 656c 5f6d 6574 7269 6373 286d 6f64 656c  el_metrics(model
+000627c0: 7479 7065 2c6c 6d2c 5850 3158 2c59 2c54  type,lm,XP1X,Y,T
+000627d0: 7275 6529 0d0a 2020 2020 2020 2020 7072  rue)..        pr
+000627e0: 696e 7428 2720 2020 2054 696d 6520 5461  int('    Time Ta
+000627f0: 6b65 6e3a 2025 302e 3066 2028 696e 2073  ken: %0.0f (in s
+00062800: 6563 6f6e 6473 2927 2025 2874 696d 652e  econds)' %(time.
+00062810: 7469 6d65 2829 2d73 7461 7274 5f74 696d  time()-start_tim
+00062820: 6529 290d 0a20 2020 2020 2020 2023 2323  e))..        ###
+00062830: 2320 2057 6520 6e65 6564 2074 6f20 6275  #  We need to bu
+00062840: 696c 6420 6120 6461 7461 6672 616d 6520  ild a dataframe 
+00062850: 746f 2068 6f6c 6420 636f 6566 6669 6369  to hold coeffici
+00062860: 656e 7473 2066 726f 6d20 7468 6520 6d6f  ents from the mo
+00062870: 6465 6c20 666f 7220 6561 6368 2076 6172  del for each var
+00062880: 6961 626c 6520 2323 230d 0a20 2020 2020  iable ###..     
+00062890: 2020 2064 6678 203d 2070 642e 4461 7461     dfx = pd.Data
+000628a0: 4672 616d 6528 5b6e 6577 5f61 6464 785f  Frame([new_addx_
+000628b0: 7661 7273 2c20 6e65 775f 6164 6474 6578  vars, new_addtex
+000628c0: 745f 7661 7273 5d29 0d0a 2020 2020 2020  t_vars])..      
+000628d0: 2020 6466 203d 2064 6678 2e54 0d0a 2020    df = dfx.T..  
+000628e0: 2020 2020 2020 6466 2e63 6f6c 756d 6e73        df.columns
+000628f0: 3d5b 2758 204e 616d 6573 272c 2749 6e74  =['X Names','Int
+00062900: 6572 6163 7469 6f6e 2056 6172 6961 626c  eraction Variabl
+00062910: 6520 4e61 6d65 7327 5d0d 0a20 2020 2020  e Names']..     
+00062920: 2020 2023 2323 2323 2323 2323 2320 204e     ##########  N
+00062930: 204f 2057 2020 2042 2055 2049 204c 2044   O W   B U I L D
+00062940: 2020 5420 4820 4520 204d 204f 2044 2045    T H E  M O D E
+00062950: 204c 2023 2323 2323 2323 2323 2323 2323   L #############
 00062960: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00062970: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
-00062980: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
-00062990: 203d 3d20 2752 6567 7265 7373 696f 6e27   == 'Regression'
-000629a0: 3a0d 0a20 2020 2020 2020 2020 2020 2064  :..            d
-000629b0: 665b 2743 6f65 6666 6963 6965 6e74 2056  f['Coefficient V
-000629c0: 616c 7565 7327 5d20 3d20 6c6d 5f70 2e63  alues'] = lm_p.c
-000629d0: 6f65 665f 0d0a 2020 2020 2020 2020 656c  oef_..        el
-000629e0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-000629f0: 2064 665b 2743 6f65 6666 6963 6965 6e74   df['Coefficient
-00062a00: 2056 616c 7565 7327 5d20 3d20 6c6d 5f70   Values'] = lm_p
-00062a10: 2e63 6f65 665f 5b30 5d0d 0a20 2020 2020  .coef_[0]..     
-00062a20: 2020 2023 2323 2320 5468 6973 2070 6172     #### This par
-00062a30: 7420 7365 6c65 6374 7320 7468 6520 746f  t selects the to
-00062a40: 7020 3130 2520 6f66 2069 6e74 6572 6163  p 10% of interac
-00062a50: 7469 6f6e 2076 6172 6961 626c 6573 2063  tion variables c
-00062a60: 7265 6174 6564 2075 7369 6e67 206c 696e  reated using lin
-00062a70: 6561 7220 6d6f 6465 6c69 6e67 2e0d 0a20  ear modeling... 
-00062a80: 2020 2020 2020 2023 2323 2020 2049 7420         ###   It 
-00062a90: 6973 2076 6572 7920 696d 706f 7274 616e  is very importan
-00062aa0: 7420 746f 206c 6561 7665 2074 6865 206e  t to leave the n
-00062ab0: 6578 7420 6c69 6e65 2061 7320 6973 2073  ext line as is s
-00062ac0: 696e 6365 203e 2073 796d 626f 6c20 6973  ince > symbol is
-00062ad0: 2062 6574 7465 7220 7468 616e 203e 3d0d   better than >=.
-00062ae0: 0a20 2020 2020 2020 206c 696d 203d 2061  .        lim = a
-00062af0: 6273 2864 665b 2743 6f65 6666 6963 6965  bs(df['Coefficie
-00062b00: 6e74 2056 616c 7565 7327 5d29 2e71 7561  nt Values']).qua
-00062b10: 6e74 696c 6528 302e 3929 0d0a 2020 2020  ntile(0.9)..    
-00062b20: 2020 2020 6466 3930 203d 2064 665b 6162      df90 = df[ab
-00062b30: 7328 6466 5b27 436f 6566 6669 6369 656e  s(df['Coefficien
-00062b40: 7420 5661 6c75 6573 275d 293e 6c69 6d5d  t Values'])>lim]
-00062b50: 2e73 6f72 745f 7661 6c75 6573 2827 436f  .sort_values('Co
-00062b60: 6566 6669 6369 656e 7420 5661 6c75 6573  efficient Values
-00062b70: 272c 6173 6365 6e64 696e 673d 4661 6c73  ',ascending=Fals
-00062b80: 6529 0d0a 2020 2020 2020 2020 6966 2064  e)..        if d
-00062b90: 665b 2743 6f65 6666 6963 6965 6e74 2056  f['Coefficient V
-00062ba0: 616c 7565 7327 5d2e 7375 6d28 293d 3d30  alues'].sum()==0
-00062bb0: 2e30 206f 7220 6466 3930 5b27 436f 6566  .0 or df90['Coef
-00062bc0: 6669 6369 656e 7420 5661 6c75 6573 275d  ficient Values']
-00062bd0: 2e73 756d 2829 3d3d 302e 303a 0d0a 2020  .sum()==0.0:..  
-00062be0: 2020 2020 2020 2020 2020 2323 2320 5468            ### Th
-00062bf0: 6572 6520 6973 206e 6f20 636f 6566 6669  ere is no coeffi
-00062c00: 6369 656e 7420 7468 6174 2069 7320 6772  cient that is gr
-00062c10: 6561 7465 7220 7468 616e 2030 2068 6572  eater than 0 her
-00062c20: 652e 2053 6f20 7265 6a65 6374 2061 6c6c  e. So reject all
-00062c30: 2076 6172 6961 626c 6573 210d 0a20 2020   variables!..   
-00062c40: 2020 2020 2020 2020 2073 656c 5f78 5f76           sel_x_v
-00062c50: 6172 7320 3d20 5b5d 0d0a 2020 2020 2020  ars = []..      
-00062c60: 2020 2020 2020 7072 696e 7428 275a 6572        print('Zer
-00062c70: 6f20 496e 7465 7261 6374 696f 6e20 616e  o Interaction an
-00062c80: 6420 506f 6c79 6e6f 6d69 616c 2076 6172  d Polynomial var
-00062c90: 6961 626c 6528 7329 2073 656c 6563 7465  iable(s) selecte
-00062ca0: 642e 2e2e 2729 0d0a 2020 2020 2020 2020  d...')..        
-00062cb0: 656c 6966 2064 665b 2743 6f65 6666 6963  elif df['Coeffic
-00062cc0: 6965 6e74 2056 616c 7565 7327 5d2e 7368  ient Values'].sh
-00062cd0: 6170 655b 305d 203d 3d20 6466 3930 5b27  ape[0] == df90['
-00062ce0: 436f 6566 6669 6369 656e 7420 5661 6c75  Coefficient Valu
-00062cf0: 6573 275d 2e73 6861 7065 5b30 5d3a 0d0a  es'].shape[0]:..
-00062d00: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
-00062d10: 5468 6572 6520 6973 206e 6f20 636f 6566  There is no coef
-00062d20: 6669 6369 656e 7420 7468 6174 2069 7320  ficient that is 
-00062d30: 6772 6561 7465 7220 7468 616e 2030 2068  greater than 0 h
-00062d40: 6572 652e 2053 6f20 7265 6a65 6374 2061  ere. So reject a
-00062d50: 6c6c 2076 6172 6961 626c 6573 210d 0a20  ll variables!.. 
-00062d60: 2020 2020 2020 2020 2020 2073 656c 5f78             sel_x
-00062d70: 5f76 6172 7320 3d20 5b5d 0d0a 2020 2020  _vars = []..    
-00062d80: 2020 2020 2020 2020 7072 696e 7428 275a          print('Z
-00062d90: 6572 6f20 496e 7465 7261 6374 696f 6e20  ero Interaction 
-00062da0: 616e 6420 506f 6c79 6e6f 6d69 616c 2076  and Polynomial v
-00062db0: 6172 6961 626c 6528 7329 2073 656c 6563  ariable(s) selec
-00062dc0: 7465 642e 2e2e 2729 0d0a 2020 2020 2020  ted...')..      
-00062dd0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00062de0: 2020 2020 2023 2323 2320 7468 6572 6520       #### there 
-00062df0: 6973 2073 6f6d 6520 636f 6566 6669 6369  is some coeffici
-00062e00: 656e 7473 2061 7420 6c65 6173 7420 7468  ents at least th
-00062e10: 6174 2061 7265 206e 6f6e 2d7a 6572 6f20  at are non-zero 
-00062e20: 616e 6420 6865 6e63 6520 6361 6e20 6265  and hence can be
-00062e30: 2074 7275 7374 6564 210d 0a20 2020 2020   trusted!..     
-00062e40: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
-00062e50: 6520 3e3d 2031 3a0d 0a20 2020 2020 2020  e >= 1:..       
-00062e60: 2020 2020 2020 2020 2064 6639 302e 736f           df90.so
-00062e70: 7274 5f76 616c 7565 7328 2743 6f65 6666  rt_values('Coeff
-00062e80: 6963 6965 6e74 2056 616c 7565 7327 2c61  icient Values',a
-00062e90: 7363 656e 6469 6e67 3d46 616c 7365 295b  scending=False)[
-00062ea0: 3a31 305d 2e70 6c6f 7428 0d0a 2020 2020  :10].plot(..    
-00062eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00062ec0: 6b69 6e64 3d27 6261 7227 2c78 3d27 496e  kind='bar',x='In
-00062ed0: 7465 7261 6374 696f 6e20 5661 7269 6162  teraction Variab
-00062ee0: 6c65 204e 616d 6573 272c 793d 2743 6f65  le Names',y='Coe
-00062ef0: 6666 6963 6965 6e74 2056 616c 7565 7327  fficient Values'
-00062f00: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00062f10: 2020 2020 2020 2074 6974 6c65 3d27 546f         title='To
-00062f20: 7020 3130 2520 5661 7269 6162 6c65 2049  p 10% Variable I
-00062f30: 6e74 6572 6163 7469 6f6e 7320 616e 6420  nteractions and 
-00062f40: 7468 6569 7220 436f 6566 6669 6369 656e  their Coefficien
-00062f50: 7473 2027 290d 0a20 2020 2020 2020 2020  ts ')..         
-00062f60: 2020 2065 6c69 6620 7665 7262 6f73 6520     elif verbose 
-00062f70: 3d3d 2032 3a0d 0a20 2020 2020 2020 2020  == 2:..         
-00062f80: 2020 2020 2020 2064 6639 302e 736f 7274         df90.sort
-00062f90: 5f76 616c 7565 7328 2743 6f65 6666 6963  _values('Coeffic
-00062fa0: 6965 6e74 2056 616c 7565 7327 2c61 7363  ient Values',asc
-00062fb0: 656e 6469 6e67 3d46 616c 7365 292e 706c  ending=False).pl
-00062fc0: 6f74 280d 0a20 2020 2020 2020 2020 2020  ot(..           
-00062fd0: 2020 2020 2020 2020 206b 696e 643d 2762           kind='b
-00062fe0: 6172 272c 783d 2749 6e74 6572 6163 7469  ar',x='Interacti
-00062ff0: 6f6e 2056 6172 6961 626c 6520 4e61 6d65  on Variable Name
-00063000: 7327 2c79 3d27 436f 6566 6669 6369 656e  s',y='Coefficien
-00063010: 7420 5661 6c75 6573 272c 0d0a 2020 2020  t Values',..    
-00063020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00063030: 2020 2020 7469 746c 653d 2741 6c6c 2056      title='All V
-00063040: 6172 6961 626c 6520 496e 7465 7261 6374  ariable Interact
-00063050: 696f 6e73 2061 6e64 2074 6865 6972 2043  ions and their C
-00063060: 6f65 6666 6963 6965 6e74 7327 2c66 6967  oefficients',fig
-00063070: 7369 7a65 3d28 3230 2c31 3029 290d 0a20  size=(20,10)).. 
-00063080: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
-00063090: 6163 7469 6f6e 7320 3d20 6466 3930 5b27  actions = df90['
-000630a0: 496e 7465 7261 6374 696f 6e20 5661 7269  Interaction Vari
-000630b0: 6162 6c65 204e 616d 6573 275d 2e76 616c  able Names'].val
-000630c0: 7565 732e 746f 6c69 7374 2829 0d0a 2020  ues.tolist()..  
-000630d0: 2020 2020 2020 2020 2020 7365 6c5f 785f            sel_x_
-000630e0: 7661 7273 203d 2064 6639 305b 2258 204e  vars = df90["X N
-000630f0: 616d 6573 225d 2e76 616c 7565 732e 746f  ames"].values.to
-00063100: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
-00063110: 2323 2323 2323 2320 4e6f 7720 7765 2068  ####### Now we h
-00063120: 6176 6520 746f 2070 7574 2074 6865 2066  ave to put the f
-00063130: 756c 6c20 6461 7461 6672 616d 6520 746f  ull dataframe to
-00063140: 6765 7468 6572 2077 6974 6820 7365 6c65  gether with sele
-00063150: 6374 6564 2076 6172 6961 626c 6573 2061  cted variables a
-00063160: 6e64 206f 7269 6769 6e61 6c20 7072 6564  nd original pred
-00063170: 6963 746f 7273 210d 0a20 2020 2020 2020  ictors!..       
-00063180: 2023 2323 2320 444f 204e 4f54 2043 4841   #### DO NOT CHA
-00063190: 4e47 4520 5448 4520 4e45 5854 204c 494e  NGE THE NEXT LIN
-000631a0: 4520 4556 454e 2054 484f 5547 4820 4954  E EVEN THOUGH IT
-000631b0: 204d 4947 4854 2042 4520 5445 4d50 5449   MIGHT BE TEMPTI
-000631c0: 4e47 2054 4f20 444f 2053 4f21 2049 7420  NG TO DO SO! It 
-000631d0: 6973 2063 6f72 7265 6374 210d 0a20 2020  is correct!..   
-000631e0: 2020 2020 2066 696e 616c 5f78 5f76 6172       final_x_var
-000631f0: 7320 3d20 785f 7661 7273 202b 2073 656c  s = x_vars + sel
-00063200: 5f78 5f76 6172 730d 0a20 2020 2020 2020  _x_vars..       
-00063210: 2073 656c 5f74 6578 745f 7661 7273 203d   sel_text_vars =
-00063220: 205b 6665 6174 7572 655f 7876 6172 5f64   [feature_xvar_d
-00063230: 6963 745b 785d 2066 6f72 2078 2069 6e20  ict[x] for x in 
-00063240: 7365 6c5f 785f 7661 7273 5d0d 0a20 2020  sel_x_vars]..   
-00063250: 2020 2020 2070 7269 6e74 2827 496e 6974       print('Init
-00063260: 6961 6c6c 7920 6164 6469 6e67 2025 6420  ially adding %d 
-00063270: 7661 7269 6162 6c65 2873 2920 6475 6520  variable(s) due 
-00063280: 746f 2041 6464 5f50 6f6c 7920 3d20 2573  to Add_Poly = %s
-00063290: 2073 6574 7469 6e67 2720 2528 6c65 6e28   setting' %(len(
-000632a0: 7365 6c5f 7465 7874 5f76 6172 7329 2c41  sel_text_vars),A
-000632b0: 6464 5f50 6f6c 7929 290d 0a20 2020 2020  dd_Poly))..     
-000632c0: 2020 2069 6620 7665 7262 6f73 6520 3e20     if verbose > 
-000632d0: 313a 0d0a 2020 2020 2020 2020 2020 2020  1:..            
-000632e0: 6966 206c 656e 2873 656c 5f74 6578 745f  if len(sel_text_
-000632f0: 7661 7273 2920 3c3d 2033 303a 0d0a 2020  vars) <= 30:..  
-00063300: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00063310: 696e 7428 2720 2020 2041 6464 6564 2076  int('    Added v
-00063320: 6172 6961 626c 6573 3a20 2573 2720 2573  ariables: %s' %s
-00063330: 656c 5f74 6578 745f 7661 7273 290d 0a20  el_text_vars).. 
-00063340: 2020 2020 2020 2066 696e 616c 5f74 6578         final_tex
-00063350: 745f 7661 7273 203d 205b 6665 6174 7572  t_vars = [featur
-00063360: 655f 7876 6172 5f64 6963 745b 785d 2066  e_xvar_dict[x] f
-00063370: 6f72 2078 2069 6e20 6669 6e61 6c5f 785f  or x in final_x_
-00063380: 7661 7273 5d0d 0a20 2020 2020 2020 2023  vars]..        #
+00062970: 2323 2323 230d 0a20 2020 2020 2020 2069  #####..        i
+00062980: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
+00062990: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
+000629a0: 2020 2020 2020 2020 2020 6466 5b27 436f            df['Co
+000629b0: 6566 6669 6369 656e 7420 5661 6c75 6573  efficient Values
+000629c0: 275d 203d 206c 6d5f 702e 636f 6566 5f0d  '] = lm_p.coef_.
+000629d0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+000629e0: 2020 2020 2020 2020 2020 2020 6466 5b27              df['
+000629f0: 436f 6566 6669 6369 656e 7420 5661 6c75  Coefficient Valu
+00062a00: 6573 275d 203d 206c 6d5f 702e 636f 6566  es'] = lm_p.coef
+00062a10: 5f5b 305d 0d0a 2020 2020 2020 2020 2323  _[0]..        ##
+00062a20: 2323 2054 6869 7320 7061 7274 2073 656c  ## This part sel
+00062a30: 6563 7473 2074 6865 2074 6f70 2031 3025  ects the top 10%
+00062a40: 206f 6620 696e 7465 7261 6374 696f 6e20   of interaction 
+00062a50: 7661 7269 6162 6c65 7320 6372 6561 7465  variables create
+00062a60: 6420 7573 696e 6720 6c69 6e65 6172 206d  d using linear m
+00062a70: 6f64 656c 696e 672e 0d0a 2020 2020 2020  odeling...      
+00062a80: 2020 2323 2320 2020 4974 2069 7320 7665    ###   It is ve
+00062a90: 7279 2069 6d70 6f72 7461 6e74 2074 6f20  ry important to 
+00062aa0: 6c65 6176 6520 7468 6520 6e65 7874 206c  leave the next l
+00062ab0: 696e 6520 6173 2069 7320 7369 6e63 6520  ine as is since 
+00062ac0: 3e20 7379 6d62 6f6c 2069 7320 6265 7474  > symbol is bett
+00062ad0: 6572 2074 6861 6e20 3e3d 0d0a 2020 2020  er than >=..    
+00062ae0: 2020 2020 6c69 6d20 3d20 6162 7328 6466      lim = abs(df
+00062af0: 5b27 436f 6566 6669 6369 656e 7420 5661  ['Coefficient Va
+00062b00: 6c75 6573 275d 292e 7175 616e 7469 6c65  lues']).quantile
+00062b10: 2830 2e39 290d 0a20 2020 2020 2020 2064  (0.9)..        d
+00062b20: 6639 3020 3d20 6466 5b61 6273 2864 665b  f90 = df[abs(df[
+00062b30: 2743 6f65 6666 6963 6965 6e74 2056 616c  'Coefficient Val
+00062b40: 7565 7327 5d29 3e6c 696d 5d2e 736f 7274  ues'])>lim].sort
+00062b50: 5f76 616c 7565 7328 2743 6f65 6666 6963  _values('Coeffic
+00062b60: 6965 6e74 2056 616c 7565 7327 2c61 7363  ient Values',asc
+00062b70: 656e 6469 6e67 3d46 616c 7365 290d 0a20  ending=False).. 
+00062b80: 2020 2020 2020 2069 6620 6466 5b27 436f         if df['Co
+00062b90: 6566 6669 6369 656e 7420 5661 6c75 6573  efficient Values
+00062ba0: 275d 2e73 756d 2829 3d3d 302e 3020 6f72  '].sum()==0.0 or
+00062bb0: 2064 6639 305b 2743 6f65 6666 6963 6965   df90['Coefficie
+00062bc0: 6e74 2056 616c 7565 7327 5d2e 7375 6d28  nt Values'].sum(
+00062bd0: 293d 3d30 2e30 3a0d 0a20 2020 2020 2020  )==0.0:..       
+00062be0: 2020 2020 2023 2323 2054 6865 7265 2069       ### There i
+00062bf0: 7320 6e6f 2063 6f65 6666 6963 6965 6e74  s no coefficient
+00062c00: 2074 6861 7420 6973 2067 7265 6174 6572   that is greater
+00062c10: 2074 6861 6e20 3020 6865 7265 2e20 536f   than 0 here. So
+00062c20: 2072 656a 6563 7420 616c 6c20 7661 7269   reject all vari
+00062c30: 6162 6c65 7321 0d0a 2020 2020 2020 2020  ables!..        
+00062c40: 2020 2020 7365 6c5f 785f 7661 7273 203d      sel_x_vars =
+00062c50: 205b 5d0d 0a20 2020 2020 2020 2020 2020   []..           
+00062c60: 2070 7269 6e74 2827 5a65 726f 2049 6e74   print('Zero Int
+00062c70: 6572 6163 7469 6f6e 2061 6e64 2050 6f6c  eraction and Pol
+00062c80: 796e 6f6d 6961 6c20 7661 7269 6162 6c65  ynomial variable
+00062c90: 2873 2920 7365 6c65 6374 6564 2e2e 2e27  (s) selected...'
+00062ca0: 290d 0a20 2020 2020 2020 2065 6c69 6620  )..        elif 
+00062cb0: 6466 5b27 436f 6566 6669 6369 656e 7420  df['Coefficient 
+00062cc0: 5661 6c75 6573 275d 2e73 6861 7065 5b30  Values'].shape[0
+00062cd0: 5d20 3d3d 2064 6639 305b 2743 6f65 6666  ] == df90['Coeff
+00062ce0: 6963 6965 6e74 2056 616c 7565 7327 5d2e  icient Values'].
+00062cf0: 7368 6170 655b 305d 3a0d 0a20 2020 2020  shape[0]:..     
+00062d00: 2020 2020 2020 2023 2323 2054 6865 7265         ### There
+00062d10: 2069 7320 6e6f 2063 6f65 6666 6963 6965   is no coefficie
+00062d20: 6e74 2074 6861 7420 6973 2067 7265 6174  nt that is great
+00062d30: 6572 2074 6861 6e20 3020 6865 7265 2e20  er than 0 here. 
+00062d40: 536f 2072 656a 6563 7420 616c 6c20 7661  So reject all va
+00062d50: 7269 6162 6c65 7321 0d0a 2020 2020 2020  riables!..      
+00062d60: 2020 2020 2020 7365 6c5f 785f 7661 7273        sel_x_vars
+00062d70: 203d 205b 5d0d 0a20 2020 2020 2020 2020   = []..         
+00062d80: 2020 2070 7269 6e74 2827 5a65 726f 2049     print('Zero I
+00062d90: 6e74 6572 6163 7469 6f6e 2061 6e64 2050  nteraction and P
+00062da0: 6f6c 796e 6f6d 6961 6c20 7661 7269 6162  olynomial variab
+00062db0: 6c65 2873 2920 7365 6c65 6374 6564 2e2e  le(s) selected..
+00062dc0: 2e27 290d 0a20 2020 2020 2020 2065 6c73  .')..        els
+00062dd0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00062de0: 2323 2323 2074 6865 7265 2069 7320 736f  #### there is so
+00062df0: 6d65 2063 6f65 6666 6963 6965 6e74 7320  me coefficients 
+00062e00: 6174 206c 6561 7374 2074 6861 7420 6172  at least that ar
+00062e10: 6520 6e6f 6e2d 7a65 726f 2061 6e64 2068  e non-zero and h
+00062e20: 656e 6365 2063 616e 2062 6520 7472 7573  ence can be trus
+00062e30: 7465 6421 0d0a 2020 2020 2020 2020 2020  ted!..          
+00062e40: 2020 6966 2076 6572 626f 7365 203e 3d20    if verbose >= 
+00062e50: 313a 0d0a 2020 2020 2020 2020 2020 2020  1:..            
+00062e60: 2020 2020 6466 3930 2e73 6f72 745f 7661      df90.sort_va
+00062e70: 6c75 6573 2827 436f 6566 6669 6369 656e  lues('Coefficien
+00062e80: 7420 5661 6c75 6573 272c 6173 6365 6e64  t Values',ascend
+00062e90: 696e 673d 4661 6c73 6529 5b3a 3130 5d2e  ing=False)[:10].
+00062ea0: 706c 6f74 280d 0a20 2020 2020 2020 2020  plot(..         
+00062eb0: 2020 2020 2020 2020 2020 206b 696e 643d             kind=
+00062ec0: 2762 6172 272c 783d 2749 6e74 6572 6163  'bar',x='Interac
+00062ed0: 7469 6f6e 2056 6172 6961 626c 6520 4e61  tion Variable Na
+00062ee0: 6d65 7327 2c79 3d27 436f 6566 6669 6369  mes',y='Coeffici
+00062ef0: 656e 7420 5661 6c75 6573 272c 0d0a 2020  ent Values',..  
+00062f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00062f10: 2020 7469 746c 653d 2754 6f70 2031 3025    title='Top 10%
+00062f20: 2056 6172 6961 626c 6520 496e 7465 7261   Variable Intera
+00062f30: 6374 696f 6e73 2061 6e64 2074 6865 6972  ctions and their
+00062f40: 2043 6f65 6666 6963 6965 6e74 7320 2729   Coefficients ')
+00062f50: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00062f60: 6966 2076 6572 626f 7365 203d 3d20 323a  if verbose == 2:
+00062f70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00062f80: 2020 6466 3930 2e73 6f72 745f 7661 6c75    df90.sort_valu
+00062f90: 6573 2827 436f 6566 6669 6369 656e 7420  es('Coefficient 
+00062fa0: 5661 6c75 6573 272c 6173 6365 6e64 696e  Values',ascendin
+00062fb0: 673d 4661 6c73 6529 2e70 6c6f 7428 0d0a  g=False).plot(..
+00062fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00062fd0: 2020 2020 6b69 6e64 3d27 6261 7227 2c78      kind='bar',x
+00062fe0: 3d27 496e 7465 7261 6374 696f 6e20 5661  ='Interaction Va
+00062ff0: 7269 6162 6c65 204e 616d 6573 272c 793d  riable Names',y=
+00063000: 2743 6f65 6666 6963 6965 6e74 2056 616c  'Coefficient Val
+00063010: 7565 7327 2c0d 0a20 2020 2020 2020 2020  ues',..         
+00063020: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+00063030: 6974 6c65 3d27 416c 6c20 5661 7269 6162  itle='All Variab
+00063040: 6c65 2049 6e74 6572 6163 7469 6f6e 7320  le Interactions 
+00063050: 616e 6420 7468 6569 7220 436f 6566 6669  and their Coeffi
+00063060: 6369 656e 7473 272c 6669 6773 697a 653d  cients',figsize=
+00063070: 2832 302c 3130 2929 0d0a 2020 2020 2020  (20,10))..      
+00063080: 2020 2020 2020 696e 7465 7261 6374 696f        interactio
+00063090: 6e73 203d 2064 6639 305b 2749 6e74 6572  ns = df90['Inter
+000630a0: 6163 7469 6f6e 2056 6172 6961 626c 6520  action Variable 
+000630b0: 4e61 6d65 7327 5d2e 7661 6c75 6573 2e74  Names'].values.t
+000630c0: 6f6c 6973 7428 290d 0a20 2020 2020 2020  olist()..       
+000630d0: 2020 2020 2073 656c 5f78 5f76 6172 7320       sel_x_vars 
+000630e0: 3d20 6466 3930 5b22 5820 4e61 6d65 7322  = df90["X Names"
+000630f0: 5d2e 7661 6c75 6573 2e74 6f6c 6973 7428  ].values.tolist(
+00063100: 290d 0a20 2020 2020 2020 2023 2323 2323  )..        #####
+00063110: 2323 204e 6f77 2077 6520 6861 7665 2074  ## Now we have t
+00063120: 6f20 7075 7420 7468 6520 6675 6c6c 2064  o put the full d
+00063130: 6174 6166 7261 6d65 2074 6f67 6574 6865  ataframe togethe
+00063140: 7220 7769 7468 2073 656c 6563 7465 6420  r with selected 
+00063150: 7661 7269 6162 6c65 7320 616e 6420 6f72  variables and or
+00063160: 6967 696e 616c 2070 7265 6469 6374 6f72  iginal predictor
+00063170: 7321 0d0a 2020 2020 2020 2020 2323 2323  s!..        ####
+00063180: 2044 4f20 4e4f 5420 4348 414e 4745 2054   DO NOT CHANGE T
+00063190: 4845 204e 4558 5420 4c49 4e45 2045 5645  HE NEXT LINE EVE
+000631a0: 4e20 5448 4f55 4748 2049 5420 4d49 4748  N THOUGH IT MIGH
+000631b0: 5420 4245 2054 454d 5054 494e 4720 544f  T BE TEMPTING TO
+000631c0: 2044 4f20 534f 2120 4974 2069 7320 636f   DO SO! It is co
+000631d0: 7272 6563 7421 0d0a 2020 2020 2020 2020  rrect!..        
+000631e0: 6669 6e61 6c5f 785f 7661 7273 203d 2078  final_x_vars = x
+000631f0: 5f76 6172 7320 2b20 7365 6c5f 785f 7661  _vars + sel_x_va
+00063200: 7273 0d0a 2020 2020 2020 2020 7365 6c5f  rs..        sel_
+00063210: 7465 7874 5f76 6172 7320 3d20 5b66 6561  text_vars = [fea
+00063220: 7475 7265 5f78 7661 725f 6469 6374 5b78  ture_xvar_dict[x
+00063230: 5d20 666f 7220 7820 696e 2073 656c 5f78  ] for x in sel_x
+00063240: 5f76 6172 735d 0d0a 2020 2020 2020 2020  _vars]..        
+00063250: 7072 696e 7428 2749 6e69 7469 616c 6c79  print('Initially
+00063260: 2061 6464 696e 6720 2564 2076 6172 6961   adding %d varia
+00063270: 626c 6528 7329 2064 7565 2074 6f20 4164  ble(s) due to Ad
+00063280: 645f 506f 6c79 203d 2025 7320 7365 7474  d_Poly = %s sett
+00063290: 696e 6727 2025 286c 656e 2873 656c 5f74  ing' %(len(sel_t
+000632a0: 6578 745f 7661 7273 292c 4164 645f 506f  ext_vars),Add_Po
+000632b0: 6c79 2929 0d0a 2020 2020 2020 2020 6966  ly))..        if
+000632c0: 2076 6572 626f 7365 203e 2031 3a0d 0a20   verbose > 1:.. 
+000632d0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+000632e0: 6e28 7365 6c5f 7465 7874 5f76 6172 7329  n(sel_text_vars)
+000632f0: 203c 3d20 3330 3a0d 0a20 2020 2020 2020   <= 30:..       
+00063300: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00063310: 2020 2020 4164 6465 6420 7661 7269 6162      Added variab
+00063320: 6c65 733a 2025 7327 2025 7365 6c5f 7465  les: %s' %sel_te
+00063330: 7874 5f76 6172 7329 0d0a 2020 2020 2020  xt_vars)..      
+00063340: 2020 6669 6e61 6c5f 7465 7874 5f76 6172    final_text_var
+00063350: 7320 3d20 5b66 6561 7475 7265 5f78 7661  s = [feature_xva
+00063360: 725f 6469 6374 5b78 5d20 666f 7220 7820  r_dict[x] for x 
+00063370: 696e 2066 696e 616c 5f78 5f76 6172 735d  in final_x_vars]
+00063380: 0d0a 2020 2020 2020 2020 2323 2323 2323  ..        ######
 00063390: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000633a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000633b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000633c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000633d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000633e0: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
-000633f0: 2020 2066 696e 616c 5f64 6620 3d20 6d64     final_df = md
-00063400: 2e74 7261 6e73 666f 726d 2864 6174 615b  .transform(data[
-00063410: 7072 6564 6963 746f 7273 5d29 0d0a 2020  predictors])..  
-00063420: 2020 2020 2020 786e 616d 6573 203d 206d        xnames = m
-00063430: 642e 6765 745f 6665 6174 7572 655f 6e61  d.get_feature_na
-00063440: 6d65 7328 290d 0a20 2020 2020 2020 2066  mes()..        f
-00063450: 696e 616c 5f64 6620 3d20 7064 2e44 6174  inal_df = pd.Dat
-00063460: 6146 7261 6d65 2866 696e 616c 5f64 662c  aFrame(final_df,
-00063470: 696e 6465 783d 6f72 6967 5f64 6174 615f  index=orig_data_
-00063480: 696e 6465 782c 2063 6f6c 756d 6e73 3d78  index, columns=x
-00063490: 6e61 6d65 7329 0d0a 2020 2020 2020 2020  names)..        
-000634a0: 6669 6e61 6c5f 6466 203d 2066 696e 616c  final_df = final
-000634b0: 5f64 665b 6669 6e61 6c5f 785f 7661 7273  _df[final_x_vars
-000634c0: 5d0d 0a20 2020 2020 2020 2066 696e 616c  ]..        final
-000634d0: 5f64 662e 636f 6c75 6d6e 7320 3d20 6669  _df.columns = fi
-000634e0: 6e61 6c5f 7465 7874 5f76 6172 730d 0a20  nal_text_vars.. 
-000634f0: 2020 2020 2020 2063 6f70 795f 7072 6564         copy_pred
-00063500: 7320 3d20 636f 7079 2e64 6565 7063 6f70  s = copy.deepcop
-00063510: 7928 7072 6564 6963 746f 7273 290d 0a20  y(predictors).. 
-00063520: 2020 2020 2020 2023 2323 2323 2323 2049         ####### I
-00063530: 6620 7468 6520 6f72 6967 696e 616c 2063  f the original c
-00063540: 6f6c 756d 6e27 7320 6474 7970 6520 7761  olumn's dtype wa
-00063550: 7320 696e 7465 6765 722c 2070 7574 2069  s integer, put i
-00063560: 7420 6261 636b 2061 7320 696e 7465 6765  t back as intege
-00063570: 7220 2323 230d 0a20 2020 2020 2020 2066  r ###..        f
-00063580: 6f72 2065 6163 685f 7072 6564 2069 6e20  or each_pred in 
-00063590: 636f 7079 5f70 7265 6473 3a0d 0a20 2020  copy_preds:..   
-000635a0: 2020 2020 2020 2020 2069 6620 6461 7461           if data
-000635b0: 5b65 6163 685f 7072 6564 5d2e 6474 7970  [each_pred].dtyp
-000635c0: 6520 3d3d 2069 6e74 3a0d 0a20 2020 2020  e == int:..     
-000635d0: 2020 2020 2020 2020 2020 2066 696e 616c             final
-000635e0: 5f64 665b 6561 6368 5f70 7265 645d 203d  _df[each_pred] =
-000635f0: 2066 696e 616c 5f64 665b 6561 6368 5f70   final_df[each_p
-00063600: 7265 645d 2e61 7374 7970 6528 696e 7429  red].astype(int)
-00063610: 0d0a 2020 2020 2020 2020 6669 6e61 6c5f  ..        final_
-00063620: 6466 5b74 6172 6765 7476 6172 5d20 3d20  df[targetvar] = 
-00063630: 6461 7461 5b74 6172 6765 7476 6172 5d2e  data[targetvar].
-00063640: 7661 6c75 6573 0d0a 2020 2020 2020 2020  values..        
+000633e0: 2323 2323 0d0a 2020 2020 2020 2020 6669  ####..        fi
+000633f0: 6e61 6c5f 6466 203d 206d 642e 7472 616e  nal_df = md.tran
+00063400: 7366 6f72 6d28 6461 7461 5b70 7265 6469  sform(data[predi
+00063410: 6374 6f72 735d 290d 0a20 2020 2020 2020  ctors])..       
+00063420: 2078 6e61 6d65 7320 3d20 6d64 2e67 6574   xnames = md.get
+00063430: 5f66 6561 7475 7265 5f6e 616d 6573 2829  _feature_names()
+00063440: 0d0a 2020 2020 2020 2020 6669 6e61 6c5f  ..        final_
+00063450: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
+00063460: 6528 6669 6e61 6c5f 6466 2c69 6e64 6578  e(final_df,index
+00063470: 3d6f 7269 675f 6461 7461 5f69 6e64 6578  =orig_data_index
+00063480: 2c20 636f 6c75 6d6e 733d 786e 616d 6573  , columns=xnames
+00063490: 290d 0a20 2020 2020 2020 2066 696e 616c  )..        final
+000634a0: 5f64 6620 3d20 6669 6e61 6c5f 6466 5b66  _df = final_df[f
+000634b0: 696e 616c 5f78 5f76 6172 735d 0d0a 2020  inal_x_vars]..  
+000634c0: 2020 2020 2020 6669 6e61 6c5f 6466 2e63        final_df.c
+000634d0: 6f6c 756d 6e73 203d 2066 696e 616c 5f74  olumns = final_t
+000634e0: 6578 745f 7661 7273 0d0a 2020 2020 2020  ext_vars..      
+000634f0: 2020 636f 7079 5f70 7265 6473 203d 2063    copy_preds = c
+00063500: 6f70 792e 6465 6570 636f 7079 2870 7265  opy.deepcopy(pre
+00063510: 6469 6374 6f72 7329 0d0a 2020 2020 2020  dictors)..      
+00063520: 2020 2323 2323 2323 2320 4966 2074 6865    ####### If the
+00063530: 206f 7269 6769 6e61 6c20 636f 6c75 6d6e   original column
+00063540: 2773 2064 7479 7065 2077 6173 2069 6e74  's dtype was int
+00063550: 6567 6572 2c20 7075 7420 6974 2062 6163  eger, put it bac
+00063560: 6b20 6173 2069 6e74 6567 6572 2023 2323  k as integer ###
+00063570: 0d0a 2020 2020 2020 2020 666f 7220 6561  ..        for ea
+00063580: 6368 5f70 7265 6420 696e 2063 6f70 795f  ch_pred in copy_
+00063590: 7072 6564 733a 0d0a 2020 2020 2020 2020  preds:..        
+000635a0: 2020 2020 6966 2064 6174 615b 6561 6368      if data[each
+000635b0: 5f70 7265 645d 2e64 7479 7065 203d 3d20  _pred].dtype == 
+000635c0: 696e 743a 0d0a 2020 2020 2020 2020 2020  int:..          
+000635d0: 2020 2020 2020 6669 6e61 6c5f 6466 5b65        final_df[e
+000635e0: 6163 685f 7072 6564 5d20 3d20 6669 6e61  ach_pred] = fina
+000635f0: 6c5f 6466 5b65 6163 685f 7072 6564 5d2e  l_df[each_pred].
+00063600: 6173 7479 7065 2869 6e74 290d 0a20 2020  astype(int)..   
+00063610: 2020 2020 2066 696e 616c 5f64 665b 7461       final_df[ta
+00063620: 7267 6574 7661 725d 203d 2064 6174 615b  rgetvar] = data[
+00063630: 7461 7267 6574 7661 725d 2e76 616c 7565  targetvar].value
+00063640: 730d 0a20 2020 2020 2020 2023 2323 2323  s..        #####
 00063650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00063660: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00063670: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063680: 2323 2323 230d 0a20 2020 2020 2020 2072  #####..        r
-00063690: 6574 7572 6e20 6669 6e61 6c5f 7465 7874  eturn final_text
-000636a0: 5f76 6172 732c 206c 6d5f 702c 2066 696e  _vars, lm_p, fin
-000636b0: 616c 5f64 662c 206d 642c 2066 696e 616c  al_df, md, final
-000636c0: 5f78 5f76 6172 732c 6665 6174 7572 655f  _x_vars,feature_
-000636d0: 7876 6172 5f64 6963 740d 0a20 2020 2065  xvar_dict..    e
-000636e0: 6c73 653a 0d0a 2020 2020 2020 2020 2323  lse:..        ##
-000636f0: 2323 204a 7573 7420 7265 7475 726e 2074  ## Just return t
-00063700: 6865 2074 7261 6e73 666f 726d 6564 2064  he transformed d
-00063710: 6174 6166 7261 6d65 2077 6974 6820 616c  ataframe with al
-00063720: 6c20 6f72 6967 2b70 6f6c 792b 696e 7478  l orig+poly+intx
-00063730: 6e20 7661 7273 0d0a 2020 2020 2020 2020  n vars..        
-00063740: 6669 6e61 6c5f 6466 203d 206d 642e 7472  final_df = md.tr
-00063750: 616e 7366 6f72 6d28 6461 7461 5b70 7265  ansform(data[pre
-00063760: 6469 6374 6f72 735d 290d 0a20 2020 2020  dictors])..     
-00063770: 2020 2078 6e61 6d65 7320 3d20 6d64 2e67     xnames = md.g
-00063780: 6574 5f66 6561 7475 7265 5f6e 616d 6573  et_feature_names
-00063790: 2829 0d0a 2020 2020 2020 2020 6669 6e61  ()..        fina
-000637a0: 6c5f 6466 203d 2070 642e 4461 7461 4672  l_df = pd.DataFr
-000637b0: 616d 6528 6669 6e61 6c5f 6466 2c69 6e64  ame(final_df,ind
-000637c0: 6578 3d6f 7269 675f 6461 7461 5f69 6e64  ex=orig_data_ind
-000637d0: 6578 2c20 636f 6c75 6d6e 733d 786e 616d  ex, columns=xnam
-000637e0: 6573 290d 0a20 2020 2020 2020 2072 6574  es)..        ret
-000637f0: 7572 6e20 7072 6564 6963 746f 7273 2c20  urn predictors, 
-00063800: 6c6d 2c20 6669 6e61 6c5f 6466 2c20 6d64  lm, final_df, md
-00063810: 2c20 786e 616d 6573 2c20 2222 0d0a 2323  , xnames, ""..##
+00063680: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00063690: 2066 696e 616c 5f74 6578 745f 7661 7273   final_text_vars
+000636a0: 2c20 6c6d 5f70 2c20 6669 6e61 6c5f 6466  , lm_p, final_df
+000636b0: 2c20 6d64 2c20 6669 6e61 6c5f 785f 7661  , md, final_x_va
+000636c0: 7273 2c66 6561 7475 7265 5f78 7661 725f  rs,feature_xvar_
+000636d0: 6469 6374 0d0a 2020 2020 656c 7365 3a0d  dict..    else:.
+000636e0: 0a20 2020 2020 2020 2023 2323 2320 4a75  .        #### Ju
+000636f0: 7374 2072 6574 7572 6e20 7468 6520 7472  st return the tr
+00063700: 616e 7366 6f72 6d65 6420 6461 7461 6672  ansformed datafr
+00063710: 616d 6520 7769 7468 2061 6c6c 206f 7269  ame with all ori
+00063720: 672b 706f 6c79 2b69 6e74 786e 2076 6172  g+poly+intxn var
+00063730: 730d 0a20 2020 2020 2020 2066 696e 616c  s..        final
+00063740: 5f64 6620 3d20 6d64 2e74 7261 6e73 666f  _df = md.transfo
+00063750: 726d 2864 6174 615b 7072 6564 6963 746f  rm(data[predicto
+00063760: 7273 5d29 0d0a 2020 2020 2020 2020 786e  rs])..        xn
+00063770: 616d 6573 203d 206d 642e 6765 745f 6665  ames = md.get_fe
+00063780: 6174 7572 655f 6e61 6d65 7328 290d 0a20  ature_names().. 
+00063790: 2020 2020 2020 2066 696e 616c 5f64 6620         final_df 
+000637a0: 3d20 7064 2e44 6174 6146 7261 6d65 2866  = pd.DataFrame(f
+000637b0: 696e 616c 5f64 662c 696e 6465 783d 6f72  inal_df,index=or
+000637c0: 6967 5f64 6174 615f 696e 6465 782c 2063  ig_data_index, c
+000637d0: 6f6c 756d 6e73 3d78 6e61 6d65 7329 0d0a  olumns=xnames)..
+000637e0: 2020 2020 2020 2020 7265 7475 726e 2070          return p
+000637f0: 7265 6469 6374 6f72 732c 206c 6d2c 2066  redictors, lm, f
+00063800: 696e 616c 5f64 662c 206d 642c 2078 6e61  inal_df, md, xna
+00063810: 6d65 732c 2022 220d 0a23 2323 2323 2323  mes, ""..#######
 00063820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00063830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00063840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00063850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063860: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063870: 0d0a 2323 2049 6d70 6f72 7420 736b 6c65  ..## Import skle
-00063880: 6172 6e0d 0a66 726f 6d20 736b 6c65 6172  arn..from sklear
-00063890: 6e2e 6d6f 6465 6c5f 7365 6c65 6374 696f  n.model_selectio
-000638a0: 6e20 696d 706f 7274 2063 726f 7373 5f76  n import cross_v
-000638b0: 616c 5f73 636f 7265 2c4b 466f 6c64 2c20  al_score,KFold, 
-000638c0: 5374 7261 7469 6669 6564 4b46 6f6c 640d  StratifiedKFold.
-000638d0: 0a64 6566 2070 7269 6e74 5f6d 6f64 656c  .def print_model
-000638e0: 5f6d 6574 7269 6373 286d 6f64 656c 7479  _metrics(modelty
-000638f0: 7065 2c72 6567 2c58 2c79 2c66 6974 5f66  pe,reg,X,y,fit_f
-00063900: 6c61 673d 4661 6c73 652c 7665 7262 6f73  lag=False,verbos
-00063910: 653d 3129 3a0d 0a20 2020 2023 2323 2049  e=1):..    ### I
-00063920: 6620 6669 745f 666c 6167 2069 7320 7365  f fit_flag is se
-00063930: 7420 746f 2054 7275 652c 2074 6865 6e20  t to True, then 
-00063940: 796f 7520 6d75 7374 2072 6574 7572 6e20  you must return 
-00063950: 6120 6669 7474 6564 206d 6f64 656c 2023  a fitted model #
-00063960: 2323 0d0a 2020 2020 2323 2320 2020 456c  ##..    ###   El
-00063970: 7365 2079 6f75 206d 7573 7420 7265 7475  se you must retu
-00063980: 726e 2074 6865 2063 765f 7363 6f72 6573  rn the cv_scores
-00063990: 2e6d 6561 6e20 6f6e 6c79 2023 2323 230d  .mean only ####.
-000639a0: 0a20 2020 206e 5f73 706c 6974 7320 3d20  .    n_splits = 
-000639b0: 350d 0a20 2020 2069 6620 7665 7262 6f73  5..    if verbos
-000639c0: 653e 303a 0d0a 2020 2020 2020 2020 7072  e>0:..        pr
-000639d0: 696e 7428 224d 6f64 656c 2052 6570 6f72  int("Model Repor
-000639e0: 7420 3a22 290d 0a20 2020 2020 2020 2070  t :")..        p
-000639f0: 7269 6e74 2827 2020 2020 4e75 6d62 6572  rint('    Number
-00063a00: 206f 6620 5661 7269 6162 6c65 7320 3d20   of Variables = 
-00063a10: 272c 582e 7368 6170 655b 315d 290d 0a20  ',X.shape[1]).. 
-00063a20: 2020 2069 6620 6d6f 6465 6c74 7970 6520     if modeltype 
-00063a30: 3d3d 2027 5265 6772 6573 7369 6f6e 273a  == 'Regression':
-00063a40: 0d0a 2020 2020 2020 2020 7363 7620 3d20  ..        scv = 
-00063a50: 4b46 6f6c 6428 6e5f 7370 6c69 7473 3d6e  KFold(n_splits=n
-00063a60: 5f73 706c 6974 7329 0d0a 2020 2020 2020  _splits)..      
-00063a70: 2020 2370 6572 666f 726d 7320 6372 6f73    #performs cros
-00063a80: 7320 7661 6c69 6461 7469 6f6e 0d0a 2020  s validation..  
-00063a90: 2020 2020 2020 6376 5f73 636f 7265 7320        cv_scores 
-00063aa0: 3d20 6372 6f73 735f 7661 6c5f 7363 6f72  = cross_val_scor
-00063ab0: 6528 7265 672c 582c 792e 7661 6c75 6573  e(reg,X,y.values
-00063ac0: 2e72 6176 656c 2829 2c63 763d 7363 762c  .ravel(),cv=scv,
-00063ad0: 7363 6f72 696e 673d 276e 6567 5f6d 6561  scoring='neg_mea
-00063ae0: 6e5f 7371 7561 7265 645f 6572 726f 7227  n_squared_error'
-00063af0: 290d 0a20 2020 2020 2020 2063 765f 7363  )..        cv_sc
-00063b00: 6f72 6573 203d 206e 702e 7371 7274 286e  ores = np.sqrt(n
-00063b10: 702e 6162 7328 6376 5f73 636f 7265 7329  p.abs(cv_scores)
-00063b20: 290d 0a20 2020 2020 2020 2069 6620 7665  )..        if ve
-00063b30: 7262 6f73 653a 0d0a 2020 2020 2020 2020  rbose:..        
-00063b40: 2020 2020 7072 696e 7428 2220 2020 2043      print("    C
-00063b50: 5620 524d 5345 2053 636f 7265 203a 2025  V RMSE Score : %
-00063b60: 2e34 6720 2b2f 2d20 252e 3467 207c 204d  .4g +/- %.4g | M
-00063b70: 696e 203d 2025 2e34 6720 7c20 4d61 7820  in = %.4g | Max 
-00063b80: 3d20 252e 3467 2220 2528 0d0a 2020 2020  = %.4g" %(..    
-00063b90: 2020 2020 2020 2020 2020 2020 6e70 2e6d              np.m
-00063ba0: 6561 6e28 6376 5f73 636f 7265 7329 2c6e  ean(cv_scores),n
-00063bb0: 702e 7374 6428 6376 5f73 636f 7265 7329  p.std(cv_scores)
-00063bc0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00063bd0: 2020 2020 6e70 2e6d 696e 2863 765f 7363      np.min(cv_sc
-00063be0: 6f72 6573 292c 6e70 2e6d 6178 2863 765f  ores),np.max(cv_
-00063bf0: 7363 6f72 6573 2929 290d 0a20 2020 2065  scores)))..    e
-00063c00: 6c73 653a 0d0a 2020 2020 2020 2020 7363  lse:..        sc
-00063c10: 7620 3d20 5374 7261 7469 6669 6564 4b46  v = StratifiedKF
-00063c20: 6f6c 6428 6e5f 7370 6c69 7473 3d6e 5f73  old(n_splits=n_s
-00063c30: 706c 6974 732c 2072 616e 646f 6d5f 7374  plits, random_st
-00063c40: 6174 653d 302c 2073 6875 6666 6c65 3d54  ate=0, shuffle=T
-00063c50: 7275 6529 0d0a 2020 2020 2020 2020 2323  rue)..        ##
-00063c60: 2320 7573 6520 4631 2077 6569 6768 7465  # use F1 weighte
-00063c70: 6420 7369 6e63 6520 6974 2077 6f72 6b73  d since it works
-00063c80: 206f 6e20 6d75 6c74 6970 6c65 2063 6c61   on multiple cla
-00063c90: 7373 6573 2061 7320 7765 6c6c 2061 7320  sses as well as 
-00063ca0: 6269 6e61 7279 2023 230d 0a20 2020 2020  binary ##..     
-00063cb0: 2020 2063 765f 7363 6f72 6573 203d 2063     cv_scores = c
-00063cc0: 726f 7373 5f76 616c 5f73 636f 7265 2872  ross_val_score(r
-00063cd0: 6567 2c58 2c79 2e76 616c 7565 732e 7261  eg,X,y.values.ra
-00063ce0: 7665 6c28 292c 6376 3d73 6376 2c73 636f  vel(),cv=scv,sco
-00063cf0: 7269 6e67 3d27 6631 5f77 6569 6768 7465  ring='f1_weighte
-00063d00: 6427 290d 0a20 2020 2020 2020 2069 6620  d')..        if 
-00063d10: 7665 7262 6f73 653e 303a 0d0a 2020 2020  verbose>0:..    
-00063d20: 2020 2020 2020 2020 7072 696e 7428 2220          print(" 
-00063d30: 2020 2043 5620 5765 6967 6874 6564 2046     CV Weighted F
-00063d40: 3120 5363 6f72 6520 3a20 252e 3467 202b  1 Score : %.4g +
-00063d50: 2f2d 2025 2e34 6720 7c20 4d69 6e20 3d20  /- %.4g | Min = 
-00063d60: 252e 3467 207c 204d 6178 203d 2025 2e34  %.4g | Max = %.4
-00063d70: 6722 2025 2028 0d0a 2020 2020 2020 2020  g" % (..        
-00063d80: 2020 2020 2020 2020 6e70 2e6d 6561 6e28          np.mean(
-00063d90: 6376 5f73 636f 7265 7329 2c6e 702e 7374  cv_scores),np.st
-00063da0: 6428 6376 5f73 636f 7265 7329 2c0d 0a20  d(cv_scores),.. 
-00063db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00063dc0: 6e70 2e6d 696e 2863 765f 7363 6f72 6573  np.min(cv_scores
-00063dd0: 292c 6e70 2e6d 6178 2863 765f 7363 6f72  ),np.max(cv_scor
-00063de0: 6573 2929 290d 0a20 2020 2069 6620 6669  es)))..    if fi
-00063df0: 745f 666c 6167 3a0d 0a20 2020 2020 2020  t_flag:..       
-00063e00: 2072 6574 7572 6e20 7265 672e 6669 7428   return reg.fit(
-00063e10: 582c 7929 2c20 2063 765f 7363 6f72 6573  X,y),  cv_scores
-00063e20: 2e6d 6561 6e28 290d 0a20 2020 2065 6c73  .mean()..    els
-00063e30: 653a 0d0a 2020 2020 2020 2020 7265 7475  e:..        retu
-00063e40: 726e 2020 6376 5f73 636f 7265 732e 6d65  rn  cv_scores.me
-00063e50: 616e 2829 0d0a 2323 2323 2323 2323 2323  an()..##########
+00063860: 2323 2323 2323 2323 2323 230d 0a23 2320  ###########..## 
+00063870: 496d 706f 7274 2073 6b6c 6561 726e 0d0a  Import sklearn..
+00063880: 6672 6f6d 2073 6b6c 6561 726e 2e6d 6f64  from sklearn.mod
+00063890: 656c 5f73 656c 6563 7469 6f6e 2069 6d70  el_selection imp
+000638a0: 6f72 7420 6372 6f73 735f 7661 6c5f 7363  ort cross_val_sc
+000638b0: 6f72 652c 4b46 6f6c 642c 2053 7472 6174  ore,KFold, Strat
+000638c0: 6966 6965 644b 466f 6c64 0d0a 6465 6620  ifiedKFold..def 
+000638d0: 7072 696e 745f 6d6f 6465 6c5f 6d65 7472  print_model_metr
+000638e0: 6963 7328 6d6f 6465 6c74 7970 652c 7265  ics(modeltype,re
+000638f0: 672c 582c 792c 6669 745f 666c 6167 3d46  g,X,y,fit_flag=F
+00063900: 616c 7365 2c76 6572 626f 7365 3d31 293a  alse,verbose=1):
+00063910: 0d0a 2020 2020 2323 2320 4966 2066 6974  ..    ### If fit
+00063920: 5f66 6c61 6720 6973 2073 6574 2074 6f20  _flag is set to 
+00063930: 5472 7565 2c20 7468 656e 2079 6f75 206d  True, then you m
+00063940: 7573 7420 7265 7475 726e 2061 2066 6974  ust return a fit
+00063950: 7465 6420 6d6f 6465 6c20 2323 230d 0a20  ted model ###.. 
+00063960: 2020 2023 2323 2020 2045 6c73 6520 796f     ###   Else yo
+00063970: 7520 6d75 7374 2072 6574 7572 6e20 7468  u must return th
+00063980: 6520 6376 5f73 636f 7265 732e 6d65 616e  e cv_scores.mean
+00063990: 206f 6e6c 7920 2323 2323 0d0a 2020 2020   only ####..    
+000639a0: 6e5f 7370 6c69 7473 203d 2035 0d0a 2020  n_splits = 5..  
+000639b0: 2020 6966 2076 6572 626f 7365 3e30 3a0d    if verbose>0:.
+000639c0: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
+000639d0: 4d6f 6465 6c20 5265 706f 7274 203a 2229  Model Report :")
+000639e0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+000639f0: 2720 2020 204e 756d 6265 7220 6f66 2056  '    Number of V
+00063a00: 6172 6961 626c 6573 203d 2027 2c58 2e73  ariables = ',X.s
+00063a10: 6861 7065 5b31 5d29 0d0a 2020 2020 6966  hape[1])..    if
+00063a20: 206d 6f64 656c 7479 7065 203d 3d20 2752   modeltype == 'R
+00063a30: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
+00063a40: 2020 2020 2073 6376 203d 204b 466f 6c64       scv = KFold
+00063a50: 286e 5f73 706c 6974 733d 6e5f 7370 6c69  (n_splits=n_spli
+00063a60: 7473 290d 0a20 2020 2020 2020 2023 7065  ts)..        #pe
+00063a70: 7266 6f72 6d73 2063 726f 7373 2076 616c  rforms cross val
+00063a80: 6964 6174 696f 6e0d 0a20 2020 2020 2020  idation..       
+00063a90: 2063 765f 7363 6f72 6573 203d 2063 726f   cv_scores = cro
+00063aa0: 7373 5f76 616c 5f73 636f 7265 2872 6567  ss_val_score(reg
+00063ab0: 2c58 2c79 2e76 616c 7565 732e 7261 7665  ,X,y.values.rave
+00063ac0: 6c28 292c 6376 3d73 6376 2c73 636f 7269  l(),cv=scv,scori
+00063ad0: 6e67 3d27 6e65 675f 6d65 616e 5f73 7175  ng='neg_mean_squ
+00063ae0: 6172 6564 5f65 7272 6f72 2729 0d0a 2020  ared_error')..  
+00063af0: 2020 2020 2020 6376 5f73 636f 7265 7320        cv_scores 
+00063b00: 3d20 6e70 2e73 7172 7428 6e70 2e61 6273  = np.sqrt(np.abs
+00063b10: 2863 765f 7363 6f72 6573 2929 0d0a 2020  (cv_scores))..  
+00063b20: 2020 2020 2020 6966 2076 6572 626f 7365        if verbose
+00063b30: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+00063b40: 7269 6e74 2822 2020 2020 4356 2052 4d53  rint("    CV RMS
+00063b50: 4520 5363 6f72 6520 3a20 252e 3467 202b  E Score : %.4g +
+00063b60: 2f2d 2025 2e34 6720 7c20 4d69 6e20 3d20  /- %.4g | Min = 
+00063b70: 252e 3467 207c 204d 6178 203d 2025 2e34  %.4g | Max = %.4
+00063b80: 6722 2025 280d 0a20 2020 2020 2020 2020  g" %(..         
+00063b90: 2020 2020 2020 206e 702e 6d65 616e 2863         np.mean(c
+00063ba0: 765f 7363 6f72 6573 292c 6e70 2e73 7464  v_scores),np.std
+00063bb0: 2863 765f 7363 6f72 6573 292c 0d0a 2020  (cv_scores),..  
+00063bc0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00063bd0: 702e 6d69 6e28 6376 5f73 636f 7265 7329  p.min(cv_scores)
+00063be0: 2c6e 702e 6d61 7828 6376 5f73 636f 7265  ,np.max(cv_score
+00063bf0: 7329 2929 0d0a 2020 2020 656c 7365 3a0d  s)))..    else:.
+00063c00: 0a20 2020 2020 2020 2073 6376 203d 2053  .        scv = S
+00063c10: 7472 6174 6966 6965 644b 466f 6c64 286e  tratifiedKFold(n
+00063c20: 5f73 706c 6974 733d 6e5f 7370 6c69 7473  _splits=n_splits
+00063c30: 2c20 7261 6e64 6f6d 5f73 7461 7465 3d30  , random_state=0
+00063c40: 2c20 7368 7566 666c 653d 5472 7565 290d  , shuffle=True).
+00063c50: 0a20 2020 2020 2020 2023 2323 2075 7365  .        ### use
+00063c60: 2046 3120 7765 6967 6874 6564 2073 696e   F1 weighted sin
+00063c70: 6365 2069 7420 776f 726b 7320 6f6e 206d  ce it works on m
+00063c80: 756c 7469 706c 6520 636c 6173 7365 7320  ultiple classes 
+00063c90: 6173 2077 656c 6c20 6173 2062 696e 6172  as well as binar
+00063ca0: 7920 2323 0d0a 2020 2020 2020 2020 6376  y ##..        cv
+00063cb0: 5f73 636f 7265 7320 3d20 6372 6f73 735f  _scores = cross_
+00063cc0: 7661 6c5f 7363 6f72 6528 7265 672c 582c  val_score(reg,X,
+00063cd0: 792e 7661 6c75 6573 2e72 6176 656c 2829  y.values.ravel()
+00063ce0: 2c63 763d 7363 762c 7363 6f72 696e 673d  ,cv=scv,scoring=
+00063cf0: 2766 315f 7765 6967 6874 6564 2729 0d0a  'f1_weighted')..
+00063d00: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
+00063d10: 7365 3e30 3a0d 0a20 2020 2020 2020 2020  se>0:..         
+00063d20: 2020 2070 7269 6e74 2822 2020 2020 4356     print("    CV
+00063d30: 2057 6569 6768 7465 6420 4631 2053 636f   Weighted F1 Sco
+00063d40: 7265 203a 2025 2e34 6720 2b2f 2d20 252e  re : %.4g +/- %.
+00063d50: 3467 207c 204d 696e 203d 2025 2e34 6720  4g | Min = %.4g 
+00063d60: 7c20 4d61 7820 3d20 252e 3467 2220 2520  | Max = %.4g" % 
+00063d70: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
+00063d80: 2020 206e 702e 6d65 616e 2863 765f 7363     np.mean(cv_sc
+00063d90: 6f72 6573 292c 6e70 2e73 7464 2863 765f  ores),np.std(cv_
+00063da0: 7363 6f72 6573 292c 0d0a 2020 2020 2020  scores),..      
+00063db0: 2020 2020 2020 2020 2020 206e 702e 6d69             np.mi
+00063dc0: 6e28 6376 5f73 636f 7265 7329 2c6e 702e  n(cv_scores),np.
+00063dd0: 6d61 7828 6376 5f73 636f 7265 7329 2929  max(cv_scores)))
+00063de0: 0d0a 2020 2020 6966 2066 6974 5f66 6c61  ..    if fit_fla
+00063df0: 673a 0d0a 2020 2020 2020 2020 7265 7475  g:..        retu
+00063e00: 726e 2072 6567 2e66 6974 2858 2c79 292c  rn reg.fit(X,y),
+00063e10: 2020 6376 5f73 636f 7265 732e 6d65 616e    cv_scores.mean
+00063e20: 2829 0d0a 2020 2020 656c 7365 3a0d 0a20  ()..    else:.. 
+00063e30: 2020 2020 2020 2072 6574 7572 6e20 2063         return  c
+00063e40: 765f 7363 6f72 6573 2e6d 6561 6e28 290d  v_scores.mean().
+00063e50: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
 00063e60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00063e70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00063e80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00063e90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063ea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00063eb0: 2323 2323 0d0a 6465 6620 7365 6c65 6374  ####..def select
-00063ec0: 5f62 6573 745f 7661 7269 6162 6c65 7328  _best_variables(
-00063ed0: 6d64 2c20 7265 672c 2064 662c 6e61 6d65  md, reg, df,name
-00063ee0: 732c 6e5f 6f72 6967 5f66 6561 7475 7265  s,n_orig_feature
-00063ef0: 732c 4164 645f 506f 6c79 2c76 6572 626f  s,Add_Poly,verbo
-00063f00: 7365 3d30 293a 0d0a 2020 2020 2222 220d  se=0):..    """.
-00063f10: 0a20 2020 2054 6869 7320 7072 6f67 7261  .    This progra
-00063f20: 6d20 7365 6c65 6374 7320 7468 6520 746f  m selects the to
-00063f30: 7020 3130 2520 6f66 2069 6e74 6572 6163  p 10% of interac
-00063f40: 7469 6f6e 2076 6172 6961 626c 6573 2063  tion variables c
-00063f50: 7265 6174 6564 2075 7369 6e67 206c 696e  reated using lin
-00063f60: 6561 7220 6d6f 6465 6c69 6e67 2e0d 0a20  ear modeling... 
-00063f70: 2020 2022 2222 0d0a 2020 2020 6466 3930     """..    df90
-00063f80: 203d 2064 665b 6162 7328 6466 5b27 436f   = df[abs(df['Co
-00063f90: 6566 6669 6369 656e 7420 5661 6c75 6573  efficient Values
-00063fa0: 275d 293e 3d64 665b 2743 6f65 6666 6963  '])>=df['Coeffic
-00063fb0: 6965 6e74 2056 616c 7565 7327 5d2e 7175  ient Values'].qu
-00063fc0: 616e 7469 6c65 2830 2e39 3029 5d0d 0a20  antile(0.90)].. 
-00063fd0: 2020 2069 6620 7665 7262 6f73 6520 3e3d     if verbose >=
-00063fe0: 2031 3a0d 0a20 2020 2020 2020 2064 6639   1:..        df9
-00063ff0: 302e 706c 6f74 280d 0a20 2020 2020 2020  0.plot(..       
-00064000: 2020 2020 206b 696e 643d 2762 6172 272c       kind='bar',
-00064010: 783d 2749 6e74 6572 6163 7469 6f6e 2056  x='Interaction V
-00064020: 6172 6961 626c 6520 4e61 6d65 7327 2c79  ariable Names',y
-00064030: 3d27 436f 6566 6669 6369 656e 7420 5661  ='Coefficient Va
-00064040: 6c75 6573 272c 0d0a 2020 2020 2020 2020  lues',..        
-00064050: 2020 2020 7469 746c 653d 2754 6f70 2031      title='Top 1
-00064060: 3025 2056 6172 6961 626c 6520 496e 7465  0% Variable Inte
-00064070: 7261 6374 696f 6e73 2061 6e64 2074 6865  ractions and the
-00064080: 6972 2043 6f65 6666 6963 6965 6e74 7320  ir Coefficients 
-00064090: 2729 0d0a 2020 2020 6966 2076 6572 626f  ')..    if verbo
-000640a0: 7365 203e 3d20 313a 0d0a 2020 2020 2020  se >= 1:..      
-000640b0: 2020 6466 2e70 6c6f 7428 6b69 6e64 3d27    df.plot(kind='
-000640c0: 6261 7227 2c78 3d27 496e 7465 7261 6374  bar',x='Interact
-000640d0: 696f 6e20 5661 7269 6162 6c65 204e 616d  ion Variable Nam
-000640e0: 6573 272c 793d 2743 6f65 6666 6963 6965  es',y='Coefficie
-000640f0: 6e74 2056 616c 7565 7327 2c0d 0a20 2020  nt Values',..   
-00064100: 2020 2020 2020 2020 2020 2020 2074 6974               tit
-00064110: 6c65 3d27 416c 6c20 5661 7269 6162 6c65  le='All Variable
-00064120: 2049 6e74 6572 6163 7469 6f6e 7320 616e   Interactions an
-00064130: 6420 7468 6569 7220 436f 6566 6669 6369  d their Coeffici
-00064140: 656e 7473 272c 6669 6773 697a 653d 2832  ents',figsize=(2
-00064150: 302c 3130 2929 0d0a 2020 2020 696e 7465  0,10))..    inte
-00064160: 7261 6374 696f 6e73 203d 2064 6639 305b  ractions = df90[
-00064170: 2749 6e74 6572 6163 7469 6f6e 2056 6172  'Interaction Var
-00064180: 6961 626c 6520 4e61 6d65 7327 5d2e 7661  iable Names'].va
-00064190: 6c75 6573 2e74 6f6c 6973 7428 290d 0a20  lues.tolist().. 
-000641a0: 2020 2070 7269 6e74 2827 2564 2049 6e74     print('%d Int
-000641b0: 6572 6163 7469 6f6e 2061 6e64 2050 6f6c  eraction and Pol
-000641c0: 796e 6f6d 6961 6c20 7661 7269 6162 6c65  ynomial variable
-000641d0: 2873 2920 7365 6c65 6374 6564 2e2e 2e5c  (s) selected...\
-000641e0: 6e27 2025 6c65 6e28 696e 7465 7261 6374  n' %len(interact
-000641f0: 696f 6e73 2929 0d0a 2020 2020 6669 6e61  ions))..    fina
-00064200: 6c76 6172 7320 3d20 6e61 6d65 7320 2b20  lvars = names + 
-00064210: 696e 7465 7261 6374 696f 6e73 0d0a 2020  interactions..  
-00064220: 2020 2366 696e 616c 7661 7273 5f69 6e64    #finalvars_ind
-00064230: 6578 203d 205b 6466 5b64 665b 2749 6e74  ex = [df[df['Int
-00064240: 6572 6163 7469 6f6e 2056 6172 6961 626c  eraction Variabl
-00064250: 6520 4e61 6d65 7327 5d3d 3d78 5d2e 696e  e Names']==x].in
-00064260: 6465 785b 305d 2066 6f72 2078 2069 6e20  dex[0] for x in 
-00064270: 6669 6e61 6c76 6172 735d 0d0a 2020 2020  finalvars]..    
-00064280: 7265 7475 726e 2066 696e 616c 7661 7273  return finalvars
-00064290: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+00063ea0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+00063eb0: 0a64 6566 2073 656c 6563 745f 6265 7374  .def select_best
+00063ec0: 5f76 6172 6961 626c 6573 286d 642c 2072  _variables(md, r
+00063ed0: 6567 2c20 6466 2c6e 616d 6573 2c6e 5f6f  eg, df,names,n_o
+00063ee0: 7269 675f 6665 6174 7572 6573 2c41 6464  rig_features,Add
+00063ef0: 5f50 6f6c 792c 7665 7262 6f73 653d 3029  _Poly,verbose=0)
+00063f00: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
+00063f10: 5468 6973 2070 726f 6772 616d 2073 656c  This program sel
+00063f20: 6563 7473 2074 6865 2074 6f70 2031 3025  ects the top 10%
+00063f30: 206f 6620 696e 7465 7261 6374 696f 6e20   of interaction 
+00063f40: 7661 7269 6162 6c65 7320 6372 6561 7465  variables create
+00063f50: 6420 7573 696e 6720 6c69 6e65 6172 206d  d using linear m
+00063f60: 6f64 656c 696e 672e 0d0a 2020 2020 2222  odeling...    ""
+00063f70: 220d 0a20 2020 2064 6639 3020 3d20 6466  "..    df90 = df
+00063f80: 5b61 6273 2864 665b 2743 6f65 6666 6963  [abs(df['Coeffic
+00063f90: 6965 6e74 2056 616c 7565 7327 5d29 3e3d  ient Values'])>=
+00063fa0: 6466 5b27 436f 6566 6669 6369 656e 7420  df['Coefficient 
+00063fb0: 5661 6c75 6573 275d 2e71 7561 6e74 696c  Values'].quantil
+00063fc0: 6528 302e 3930 295d 0d0a 2020 2020 6966  e(0.90)]..    if
+00063fd0: 2076 6572 626f 7365 203e 3d20 313a 0d0a   verbose >= 1:..
+00063fe0: 2020 2020 2020 2020 6466 3930 2e70 6c6f          df90.plo
+00063ff0: 7428 0d0a 2020 2020 2020 2020 2020 2020  t(..            
+00064000: 6b69 6e64 3d27 6261 7227 2c78 3d27 496e  kind='bar',x='In
+00064010: 7465 7261 6374 696f 6e20 5661 7269 6162  teraction Variab
+00064020: 6c65 204e 616d 6573 272c 793d 2743 6f65  le Names',y='Coe
+00064030: 6666 6963 6965 6e74 2056 616c 7565 7327  fficient Values'
+00064040: 2c0d 0a20 2020 2020 2020 2020 2020 2074  ,..            t
+00064050: 6974 6c65 3d27 546f 7020 3130 2520 5661  itle='Top 10% Va
+00064060: 7269 6162 6c65 2049 6e74 6572 6163 7469  riable Interacti
+00064070: 6f6e 7320 616e 6420 7468 6569 7220 436f  ons and their Co
+00064080: 6566 6669 6369 656e 7473 2027 290d 0a20  efficients ').. 
+00064090: 2020 2069 6620 7665 7262 6f73 6520 3e3d     if verbose >=
+000640a0: 2031 3a0d 0a20 2020 2020 2020 2064 662e   1:..        df.
+000640b0: 706c 6f74 286b 696e 643d 2762 6172 272c  plot(kind='bar',
+000640c0: 783d 2749 6e74 6572 6163 7469 6f6e 2056  x='Interaction V
+000640d0: 6172 6961 626c 6520 4e61 6d65 7327 2c79  ariable Names',y
+000640e0: 3d27 436f 6566 6669 6369 656e 7420 5661  ='Coefficient Va
+000640f0: 6c75 6573 272c 0d0a 2020 2020 2020 2020  lues',..        
+00064100: 2020 2020 2020 2020 7469 746c 653d 2741          title='A
+00064110: 6c6c 2056 6172 6961 626c 6520 496e 7465  ll Variable Inte
+00064120: 7261 6374 696f 6e73 2061 6e64 2074 6865  ractions and the
+00064130: 6972 2043 6f65 6666 6963 6965 6e74 7327  ir Coefficients'
+00064140: 2c66 6967 7369 7a65 3d28 3230 2c31 3029  ,figsize=(20,10)
+00064150: 290d 0a20 2020 2069 6e74 6572 6163 7469  )..    interacti
+00064160: 6f6e 7320 3d20 6466 3930 5b27 496e 7465  ons = df90['Inte
+00064170: 7261 6374 696f 6e20 5661 7269 6162 6c65  raction Variable
+00064180: 204e 616d 6573 275d 2e76 616c 7565 732e   Names'].values.
+00064190: 746f 6c69 7374 2829 0d0a 2020 2020 7072  tolist()..    pr
+000641a0: 696e 7428 2725 6420 496e 7465 7261 6374  int('%d Interact
+000641b0: 696f 6e20 616e 6420 506f 6c79 6e6f 6d69  ion and Polynomi
+000641c0: 616c 2076 6172 6961 626c 6528 7329 2073  al variable(s) s
+000641d0: 656c 6563 7465 642e 2e2e 5c6e 2720 256c  elected...\n' %l
+000641e0: 656e 2869 6e74 6572 6163 7469 6f6e 7329  en(interactions)
+000641f0: 290d 0a20 2020 2066 696e 616c 7661 7273  )..    finalvars
+00064200: 203d 206e 616d 6573 202b 2069 6e74 6572   = names + inter
+00064210: 6163 7469 6f6e 730d 0a20 2020 2023 6669  actions..    #fi
+00064220: 6e61 6c76 6172 735f 696e 6465 7820 3d20  nalvars_index = 
+00064230: 5b64 665b 6466 5b27 496e 7465 7261 6374  [df[df['Interact
+00064240: 696f 6e20 5661 7269 6162 6c65 204e 616d  ion Variable Nam
+00064250: 6573 275d 3d3d 785d 2e69 6e64 6578 5b30  es']==x].index[0
+00064260: 5d20 666f 7220 7820 696e 2066 696e 616c  ] for x in final
+00064270: 7661 7273 5d0d 0a20 2020 2072 6574 7572  vars]..    retur
+00064280: 6e20 6669 6e61 6c76 6172 730d 0a23 2323  n finalvars..###
+00064290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000642a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000642b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000642c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000642d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000642e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000642f0: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
-00064300: 6574 7269 6373 2069 6d70 6f72 7420 726f  etrics import ro
-00064310: 635f 6375 7276 652c 2061 7563 0d0a 6672  c_curve, auc..fr
-00064320: 6f6d 2073 6369 7079 2069 6d70 6f72 7420  om scipy import 
-00064330: 696e 7465 7270 0d0a 696d 706f 7274 2070  interp..import p
-00064340: 616e 6461 7320 6173 2070 640d 0a64 6566  andas as pd..def
-00064350: 2044 7261 775f 524f 435f 4d43 5f4d 4c28   Draw_ROC_MC_ML(
-00064360: 6d6f 6465 6c2c 2058 5f74 6573 742c 2079  model, X_test, y
-00064370: 5f74 7275 652c 2074 6172 6765 742c 206d  _true, target, m
-00064380: 6f64 656c 5f6e 616d 652c 2076 6572 626f  odel_name, verbo
-00064390: 7365 3d30 293a 0d0a 2020 2020 6669 6773  se=0):..    figs
-000643a0: 697a 6520 3d20 2831 302c 2036 290d 0a20  ize = (10, 6).. 
-000643b0: 2020 2079 5f70 726f 6261 203d 206d 6f64     y_proba = mod
-000643c0: 656c 2e70 7265 6469 6374 5f70 726f 6261  el.predict_proba
-000643d0: 2858 5f74 6573 7429 0d0a 2020 2020 7072  (X_test)..    pr
-000643e0: 6564 6963 7465 6420 3d20 636f 7079 2e64  edicted = copy.d
-000643f0: 6565 7063 6f70 7928 795f 7072 6f62 6129  eepcopy(y_proba)
-00064400: 0d0a 2020 2020 7468 7265 7368 6f6c 6420  ..    threshold 
-00064410: 3d20 302e 3530 0d0a 2020 2020 795f 7072  = 0.50..    y_pr
-00064420: 6564 203d 206d 6f64 656c 2e70 7265 6469  ed = model.predi
-00064430: 6374 2858 5f74 6573 7429 0d0a 2020 2020  ct(X_test)..    
-00064440: 6670 7220 3d20 6469 6374 2829 0d0a 2020  fpr = dict()..  
-00064450: 2020 7470 7220 3d20 6469 6374 2829 0d0a    tpr = dict()..
-00064460: 2020 2020 726f 635f 6175 6320 3d20 6469      roc_auc = di
-00064470: 6374 2829 0d0a 2020 2020 6974 6572 6174  ct()..    iterat
-00064480: 696f 6e73 203d 2030 0d0a 2020 2020 7261  ions = 0..    ra
-00064490: 7265 5f63 6c61 7373 203d 2066 696e 645f  re_class = find_
-000644a0: 7261 7265 5f63 6c61 7373 2879 5f74 7275  rare_class(y_tru
-000644b0: 6529 0d0a 2020 2020 6966 2069 7369 6e73  e)..    if isins
-000644c0: 7461 6e63 6528 7461 7267 6574 2c73 7472  tance(target,str
-000644d0: 293a 0d0a 2020 2020 2020 2020 7461 7267  ):..        targ
-000644e0: 6574 203d 205b 7461 7267 6574 5d0d 0a20  et = [target].. 
-000644f0: 2020 2066 6f72 2074 6172 6720 696e 2074     for targ in t
-00064500: 6172 6765 743a 0d0a 2020 2020 2020 2020  arget:..        
-00064510: 6966 206c 656e 286c 6566 745f 7375 6274  if len(left_subt
-00064520: 7261 6374 286e 702e 756e 6971 7565 2879  ract(np.unique(y
-00064530: 5f74 7275 6529 2c6e 702e 756e 6971 7565  _true),np.unique
-00064540: 2879 5f70 7265 6429 2929 203d 3d20 303a  (y_pred))) == 0:
-00064550: 0d0a 2020 2020 2020 2020 2020 2020 636c  ..            cl
-00064560: 6173 7365 7320 3d20 6c69 7374 2872 616e  asses = list(ran
-00064570: 6765 286c 656e 286e 702e 756e 6971 7565  ge(len(np.unique
-00064580: 2879 5f74 7275 6529 2929 290d 0a20 2020  (y_true))))..   
-00064590: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-000645a0: 2020 2020 2020 2020 636c 6173 7365 7320          classes 
-000645b0: 3d20 6c69 7374 2872 616e 6765 286c 656e  = list(range(len
-000645c0: 286e 702e 756e 6971 7565 2879 5f70 7265  (np.unique(y_pre
-000645d0: 6429 2929 290d 0a20 2020 2020 2020 206e  d))))..        n
-000645e0: 5f63 6c61 7373 6573 203d 206c 656e 2863  _classes = len(c
-000645f0: 6c61 7373 6573 290d 0a20 2020 2020 2020  lasses)..       
-00064600: 2069 6620 6d6f 6465 6c5f 6e61 6d65 2e6c   if model_name.l
-00064610: 6f77 6572 2829 203d 3d20 2763 6174 626f  ower() == 'catbo
-00064620: 6f73 7427 3a0d 0a20 2020 2020 2020 2020  ost':..         
-00064630: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-00064640: 2020 2020 2020 2020 2079 5f70 7265 6420           y_pred 
-00064650: 3d20 2879 5f70 726f 6261 3e30 2e35 292e  = (y_proba>0.5).
-00064660: 6173 7479 7065 2869 6e74 292e 646f 7428  astype(int).dot(
-00064670: 636c 6173 7365 7329 0d0a 2020 2020 2020  classes)..      
-00064680: 2020 2020 2020 6578 6365 7074 3a0d 0a20        except:.. 
-00064690: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000646a0: 6173 730d 0a20 2020 2020 2020 2069 6620  ass..        if 
-000646b0: 6e5f 636c 6173 7365 7320 3d3d 2032 3a0d  n_classes == 2:.
-000646c0: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
-000646d0: 2041 6c77 6179 7320 7365 7420 7261 7265   Always set rare
-000646e0: 5f63 6c61 7373 2074 6f20 3120 7768 656e  _class to 1 when
-000646f0: 2074 6865 7265 2061 7265 206f 6e6c 7920   there are only 
-00064700: 3220 636c 6173 7365 7320 666f 7220 6472  2 classes for dr
-00064710: 6177 696e 6720 524f 4320 4375 7276 6521  awing ROC Curve!
-00064720: 0d0a 2020 2020 2020 2020 2020 2020 795f  ..            y_
-00064730: 7465 7374 203d 2063 6f70 792e 6465 6570  test = copy.deep
-00064740: 636f 7079 2879 5f74 7275 6529 0d0a 2020  copy(y_true)..  
-00064750: 2020 2020 2020 2020 2020 7072 6564 6963            predic
-00064760: 7465 6420 5b3a 2c30 5d20 3d20 2870 7265  ted [:,0] = (pre
-00064770: 6469 6374 6564 205b 3a2c 305d 203e 3d20  dicted [:,0] >= 
-00064780: 2831 2d6d 5f74 6872 6573 6829 292e 6173  (1-m_thresh)).as
-00064790: 7479 7065 2827 696e 7427 290d 0a20 2020  type('int')..   
-000647a0: 2020 2020 2020 2020 2070 7265 6469 6374           predict
-000647b0: 6564 205b 3a2c 315d 203d 2028 7072 6564  ed [:,1] = (pred
-000647c0: 6963 7465 6420 5b3a 2c31 5d20 3e20 7468  icted [:,1] > th
-000647d0: 7265 7368 6f6c 6429 2e61 7374 7970 6528  reshold).astype(
-000647e0: 2769 6e74 2729 0d0a 2020 2020 2020 2020  'int')..        
-000647f0: 2020 2020 795f 7072 6564 203d 2070 7265      y_pred = pre
-00064800: 6469 6374 6564 5b3a 2c72 6172 655f 636c  dicted[:,rare_cl
-00064810: 6173 735d 0d0a 2020 2020 2020 2020 656c  ass]..        el
-00064820: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00064830: 2079 5f74 6573 7420 3d20 6c61 6265 6c5f   y_test = label_
-00064840: 6269 6e61 7269 7a65 2879 5f74 7275 652c  binarize(y_true,
-00064850: 2063 6c61 7373 6573 290d 0a20 2020 2020   classes)..     
-00064860: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-00064870: 2020 2020 2069 6620 6e5f 636c 6173 7365       if n_classe
-00064880: 7320 3e20 323a 0d0a 2020 2020 2020 2020  s > 2:..        
-00064890: 2020 2020 2020 2020 6966 2079 5f74 6573          if y_tes
-000648a0: 742e 7368 6170 655b 315d 203d 3d20 795f  t.shape[1] == y_
-000648b0: 7072 6f62 612e 7368 6170 655b 315d 3a0d  proba.shape[1]:.
-000648c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000648d0: 2020 2020 2063 6c61 7373 6573 203d 206c       classes = l
-000648e0: 6973 7428 7261 6e67 6528 795f 7465 7374  ist(range(y_test
-000648f0: 2e73 6861 7065 5b31 5d29 290d 0a20 2020  .shape[1]))..   
-00064900: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00064910: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00064920: 2020 2020 2020 2020 6966 2079 5f70 726f          if y_pro
-00064930: 6261 2e73 6861 7065 5b31 5d20 3e20 795f  ba.shape[1] > y_
-00064940: 7465 7374 2e73 6861 7065 5b31 5d3a 0d0a  test.shape[1]:..
+000642e0: 2323 2323 2323 2323 2323 230d 0a66 726f  ###########..fro
+000642f0: 6d20 736b 6c65 6172 6e2e 6d65 7472 6963  m sklearn.metric
+00064300: 7320 696d 706f 7274 2072 6f63 5f63 7572  s import roc_cur
+00064310: 7665 2c20 6175 630d 0a66 726f 6d20 7363  ve, auc..from sc
+00064320: 6970 7920 696d 706f 7274 2069 6e74 6572  ipy import inter
+00064330: 700d 0a69 6d70 6f72 7420 7061 6e64 6173  p..import pandas
+00064340: 2061 7320 7064 0d0a 6465 6620 4472 6177   as pd..def Draw
+00064350: 5f52 4f43 5f4d 435f 4d4c 286d 6f64 656c  _ROC_MC_ML(model
+00064360: 2c20 585f 7465 7374 2c20 795f 7472 7565  , X_test, y_true
+00064370: 2c20 7461 7267 6574 2c20 6d6f 6465 6c5f  , target, model_
+00064380: 6e61 6d65 2c20 7665 7262 6f73 653d 3029  name, verbose=0)
+00064390: 3a0d 0a20 2020 2066 6967 7369 7a65 203d  :..    figsize =
+000643a0: 2028 3130 2c20 3629 0d0a 2020 2020 795f   (10, 6)..    y_
+000643b0: 7072 6f62 6120 3d20 6d6f 6465 6c2e 7072  proba = model.pr
+000643c0: 6564 6963 745f 7072 6f62 6128 585f 7465  edict_proba(X_te
+000643d0: 7374 290d 0a20 2020 2070 7265 6469 6374  st)..    predict
+000643e0: 6564 203d 2063 6f70 792e 6465 6570 636f  ed = copy.deepco
+000643f0: 7079 2879 5f70 726f 6261 290d 0a20 2020  py(y_proba)..   
+00064400: 2074 6872 6573 686f 6c64 203d 2030 2e35   threshold = 0.5
+00064410: 300d 0a20 2020 2079 5f70 7265 6420 3d20  0..    y_pred = 
+00064420: 6d6f 6465 6c2e 7072 6564 6963 7428 585f  model.predict(X_
+00064430: 7465 7374 290d 0a20 2020 2066 7072 203d  test)..    fpr =
+00064440: 2064 6963 7428 290d 0a20 2020 2074 7072   dict()..    tpr
+00064450: 203d 2064 6963 7428 290d 0a20 2020 2072   = dict()..    r
+00064460: 6f63 5f61 7563 203d 2064 6963 7428 290d  oc_auc = dict().
+00064470: 0a20 2020 2069 7465 7261 7469 6f6e 7320  .    iterations 
+00064480: 3d20 300d 0a20 2020 2072 6172 655f 636c  = 0..    rare_cl
+00064490: 6173 7320 3d20 6669 6e64 5f72 6172 655f  ass = find_rare_
+000644a0: 636c 6173 7328 795f 7472 7565 290d 0a20  class(y_true).. 
+000644b0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+000644c0: 2874 6172 6765 742c 7374 7229 3a0d 0a20  (target,str):.. 
+000644d0: 2020 2020 2020 2074 6172 6765 7420 3d20         target = 
+000644e0: 5b74 6172 6765 745d 0d0a 2020 2020 666f  [target]..    fo
+000644f0: 7220 7461 7267 2069 6e20 7461 7267 6574  r targ in target
+00064500: 3a0d 0a20 2020 2020 2020 2069 6620 6c65  :..        if le
+00064510: 6e28 6c65 6674 5f73 7562 7472 6163 7428  n(left_subtract(
+00064520: 6e70 2e75 6e69 7175 6528 795f 7472 7565  np.unique(y_true
+00064530: 292c 6e70 2e75 6e69 7175 6528 795f 7072  ),np.unique(y_pr
+00064540: 6564 2929 2920 3d3d 2030 3a0d 0a20 2020  ed))) == 0:..   
+00064550: 2020 2020 2020 2020 2063 6c61 7373 6573           classes
+00064560: 203d 206c 6973 7428 7261 6e67 6528 6c65   = list(range(le
+00064570: 6e28 6e70 2e75 6e69 7175 6528 795f 7472  n(np.unique(y_tr
+00064580: 7565 2929 2929 0d0a 2020 2020 2020 2020  ue))))..        
+00064590: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+000645a0: 2020 2063 6c61 7373 6573 203d 206c 6973     classes = lis
+000645b0: 7428 7261 6e67 6528 6c65 6e28 6e70 2e75  t(range(len(np.u
+000645c0: 6e69 7175 6528 795f 7072 6564 2929 2929  nique(y_pred))))
+000645d0: 0d0a 2020 2020 2020 2020 6e5f 636c 6173  ..        n_clas
+000645e0: 7365 7320 3d20 6c65 6e28 636c 6173 7365  ses = len(classe
+000645f0: 7329 0d0a 2020 2020 2020 2020 6966 206d  s)..        if m
+00064600: 6f64 656c 5f6e 616d 652e 6c6f 7765 7228  odel_name.lower(
+00064610: 2920 3d3d 2027 6361 7462 6f6f 7374 273a  ) == 'catboost':
+00064620: 0d0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
+00064630: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
+00064640: 2020 2020 795f 7072 6564 203d 2028 795f      y_pred = (y_
+00064650: 7072 6f62 613e 302e 3529 2e61 7374 7970  proba>0.5).astyp
+00064660: 6528 696e 7429 2e64 6f74 2863 6c61 7373  e(int).dot(class
+00064670: 6573 290d 0a20 2020 2020 2020 2020 2020  es)..           
+00064680: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
+00064690: 2020 2020 2020 2020 2020 7061 7373 0d0a            pass..
+000646a0: 2020 2020 2020 2020 6966 206e 5f63 6c61          if n_cla
+000646b0: 7373 6573 203d 3d20 323a 0d0a 2020 2020  sses == 2:..    
+000646c0: 2020 2020 2020 2020 2323 2320 416c 7761          ### Alwa
+000646d0: 7973 2073 6574 2072 6172 655f 636c 6173  ys set rare_clas
+000646e0: 7320 746f 2031 2077 6865 6e20 7468 6572  s to 1 when ther
+000646f0: 6520 6172 6520 6f6e 6c79 2032 2063 6c61  e are only 2 cla
+00064700: 7373 6573 2066 6f72 2064 7261 7769 6e67  sses for drawing
+00064710: 2052 4f43 2043 7572 7665 210d 0a20 2020   ROC Curve!..   
+00064720: 2020 2020 2020 2020 2079 5f74 6573 7420           y_test 
+00064730: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+00064740: 795f 7472 7565 290d 0a20 2020 2020 2020  y_true)..       
+00064750: 2020 2020 2070 7265 6469 6374 6564 205b       predicted [
+00064760: 3a2c 305d 203d 2028 7072 6564 6963 7465  :,0] = (predicte
+00064770: 6420 5b3a 2c30 5d20 3e3d 2028 312d 6d5f  d [:,0] >= (1-m_
+00064780: 7468 7265 7368 2929 2e61 7374 7970 6528  thresh)).astype(
+00064790: 2769 6e74 2729 0d0a 2020 2020 2020 2020  'int')..        
+000647a0: 2020 2020 7072 6564 6963 7465 6420 5b3a      predicted [:
+000647b0: 2c31 5d20 3d20 2870 7265 6469 6374 6564  ,1] = (predicted
+000647c0: 205b 3a2c 315d 203e 2074 6872 6573 686f   [:,1] > thresho
+000647d0: 6c64 292e 6173 7479 7065 2827 696e 7427  ld).astype('int'
+000647e0: 290d 0a20 2020 2020 2020 2020 2020 2079  )..            y
+000647f0: 5f70 7265 6420 3d20 7072 6564 6963 7465  _pred = predicte
+00064800: 645b 3a2c 7261 7265 5f63 6c61 7373 5d0d  d[:,rare_class].
+00064810: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00064820: 2020 2020 2020 2020 2020 2020 795f 7465              y_te
+00064830: 7374 203d 206c 6162 656c 5f62 696e 6172  st = label_binar
+00064840: 697a 6528 795f 7472 7565 2c20 636c 6173  ize(y_true, clas
+00064850: 7365 7329 0d0a 2020 2020 2020 2020 7472  ses)..        tr
+00064860: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
+00064870: 6966 206e 5f63 6c61 7373 6573 203e 2032  if n_classes > 2
+00064880: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00064890: 2020 2069 6620 795f 7465 7374 2e73 6861     if y_test.sha
+000648a0: 7065 5b31 5d20 3d3d 2079 5f70 726f 6261  pe[1] == y_proba
+000648b0: 2e73 6861 7065 5b31 5d3a 0d0a 2020 2020  .shape[1]:..    
+000648c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000648d0: 636c 6173 7365 7320 3d20 6c69 7374 2872  classes = list(r
+000648e0: 616e 6765 2879 5f74 6573 742e 7368 6170  ange(y_test.shap
+000648f0: 655b 315d 2929 0d0a 2020 2020 2020 2020  e[1]))..        
+00064900: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00064910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00064920: 2020 2069 6620 795f 7072 6f62 612e 7368     if y_proba.sh
+00064930: 6170 655b 315d 203e 2079 5f74 6573 742e  ape[1] > y_test.
+00064940: 7368 6170 655b 315d 3a0d 0a20 2020 2020  shape[1]:..     
 00064950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00064960: 2020 2020 2020 2020 636c 6173 7365 7320          classes 
-00064970: 3d20 6c69 7374 2872 616e 6765 2879 5f70  = list(range(y_p
-00064980: 726f 6261 2e73 6861 7065 5b31 5d29 290d  roba.shape[1])).
-00064990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000649a0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-000649b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000649c0: 2020 2020 636c 6173 7365 7320 3d20 6c69      classes = li
-000649d0: 7374 2872 616e 6765 2879 5f74 6573 742e  st(range(y_test.
-000649e0: 7368 6170 655b 315d 2929 0d0a 2020 2020  shape[1]))..    
-000649f0: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
-00064a00: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
-00064a10: 2020 2020 2020 2069 6620 6e5f 636c 6173         if n_clas
-00064a20: 7365 7320 3d3d 2032 3a0d 0a20 2020 2020  ses == 2:..     
-00064a30: 2020 2020 2020 2069 7465 7261 7469 6f6e         iteration
-00064a40: 7320 3d20 310d 0a20 2020 2020 2020 2065  s = 1..        e
-00064a50: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00064a60: 2020 6974 6572 6174 696f 6e73 203d 2063    iterations = c
-00064a70: 6f70 792e 6465 6570 636f 7079 286e 5f63  opy.deepcopy(n_c
-00064a80: 6c61 7373 6573 290d 0a20 2020 2020 2020  lasses)..       
-00064a90: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-00064aa0: 2323 2323 2323 2020 2054 6869 7320 6973  ######   This is
-00064ab0: 2077 6865 7265 2079 6f75 2063 616c 6375   where you calcu
-00064ac0: 6c61 7465 2052 4f43 5f41 5543 2066 6f72  late ROC_AUC for
-00064ad0: 2061 6c6c 2063 6c61 7373 6573 2023 2323   all classes ###
-00064ae0: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
-00064af0: 666f 7220 6920 696e 2072 616e 6765 2869  for i in range(i
-00064b00: 7465 7261 7469 6f6e 7329 3a0d 0a20 2020  terations):..   
-00064b10: 2020 2020 2020 2020 2069 6620 6e5f 636c           if n_cl
-00064b20: 6173 7365 733d 3d32 3a0d 0a20 2020 2020  asses==2:..     
-00064b30: 2020 2020 2020 2020 2020 2066 7072 5b72             fpr[r
-00064b40: 6172 655f 636c 6173 735d 2c20 7470 725b  are_class], tpr[
-00064b50: 7261 7265 5f63 6c61 7373 5d2c 205f 203d  rare_class], _ =
-00064b60: 2072 6f63 5f63 7572 7665 2879 5f74 6573   roc_curve(y_tes
-00064b70: 742e 7261 7665 6c28 292c 2079 5f70 726f  t.ravel(), y_pro
-00064b80: 6261 5b3a 2c72 6172 655f 636c 6173 735d  ba[:,rare_class]
-00064b90: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00064ba0: 2020 2072 6f63 5f61 7563 5b72 6172 655f     roc_auc[rare_
-00064bb0: 636c 6173 735d 203d 2061 7563 2866 7072  class] = auc(fpr
-00064bc0: 5b72 6172 655f 636c 6173 735d 2c20 7470  [rare_class], tp
-00064bd0: 725b 7261 7265 5f63 6c61 7373 5d29 0d0a  r[rare_class])..
-00064be0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00064bf0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00064c00: 2020 2066 7072 5b69 5d2c 2074 7072 5b69     fpr[i], tpr[i
-00064c10: 5d2c 205f 203d 2072 6f63 5f63 7572 7665  ], _ = roc_curve
-00064c20: 2879 5f74 6573 745b 3a2c 695d 2c20 795f  (y_test[:,i], y_
-00064c30: 7072 6f62 615b 3a2c 695d 290d 0a20 2020  proba[:,i])..   
-00064c40: 2020 2020 2020 2020 2020 2020 2072 6f63               roc
-00064c50: 5f61 7563 5b69 5d20 3d20 6175 6328 6670  _auc[i] = auc(fp
-00064c60: 725b 695d 2c20 7470 725b 695d 290d 0a20  r[i], tpr[i]).. 
-00064c70: 2020 2020 2020 2023 2323 2043 6f6d 7075         ### Compu
-00064c80: 7465 204d 6963 726f 2041 7665 7261 6765  te Micro Average
-00064c90: 2077 6869 6368 2069 7320 6120 726f 772d   which is a row-
-00064ca0: 6279 2d72 6f77 2073 636f 7265 2023 2323  by-row score ###
-00064cb0: 2323 2323 2323 2323 0d0a 2020 2020 2020  ########..      
-00064cc0: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
-00064cd0: 2020 2020 6966 206e 5f63 6c61 7373 6573      if n_classes
-00064ce0: 203d 3d20 323a 0d0a 2020 2020 2020 2020   == 2:..        
-00064cf0: 2020 2020 2020 2020 6670 725b 226d 6963          fpr["mic
-00064d00: 726f 225d 2c20 7470 725b 226d 6963 726f  ro"], tpr["micro
-00064d10: 225d 2c20 5f20 3d20 726f 635f 6375 7276  "], _ = roc_curv
-00064d20: 6528 795f 7465 7374 2e72 6176 656c 2829  e(y_test.ravel()
-00064d30: 2c20 795f 7072 6564 2e72 6176 656c 2829  , y_pred.ravel()
-00064d40: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00064d50: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00064d60: 2020 2020 2020 6670 725b 226d 6963 726f        fpr["micro
-00064d70: 225d 2c20 7470 725b 226d 6963 726f 225d  "], tpr["micro"]
-00064d80: 2c20 5f20 3d20 726f 635f 6375 7276 6528  , _ = roc_curve(
-00064d90: 795f 7465 7374 2e72 6176 656c 2829 2c6c  y_test.ravel(),l
-00064da0: 6162 656c 5f62 696e 6172 697a 6528 795f  abel_binarize(y_
-00064db0: 7072 6564 2c20 636c 6173 7365 7329 2e72  pred, classes).r
-00064dc0: 6176 656c 2829 290d 0a20 2020 2020 2020  avel())..       
-00064dd0: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
-00064de0: 2020 2020 2020 6966 2079 5f74 6573 742e        if y_test.
-00064df0: 7261 7665 6c28 292e 7368 6170 655b 305d  ravel().shape[0]
-00064e00: 2021 3d20 795f 7072 6564 2e72 6176 656c   != y_pred.ravel
-00064e10: 2829 2e73 6861 7065 5b30 5d3a 0d0a 2020  ().shape[0]:..  
-00064e20: 2020 2020 2020 2020 2020 2020 2020 6670                fp
-00064e30: 725b 226d 6963 726f 225d 2c20 7470 725b  r["micro"], tpr[
-00064e40: 226d 6963 726f 225d 2c20 5f20 3d20 726f  "micro"], _ = ro
-00064e50: 635f 6375 7276 6528 795f 7465 7374 5b3a  c_curve(y_test[:
-00064e60: 2c3a 6e5f 636c 6173 7365 735d 2e72 6176  ,:n_classes].rav
-00064e70: 656c 2829 2c20 795f 7072 6f62 615b 3a2c  el(), y_proba[:,
-00064e80: 3a6e 5f63 6c61 7373 6573 5d2e 7261 7665  :n_classes].rave
-00064e90: 6c28 2929 0d0a 2020 2020 2020 2020 2020  l())..          
-00064ea0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00064eb0: 2020 2020 2020 2020 2066 7072 5b22 6d69           fpr["mi
-00064ec0: 6372 6f22 5d2c 2074 7072 5b22 6d69 6372  cro"], tpr["micr
-00064ed0: 6f22 5d2c 205f 203d 2072 6f63 5f63 7572  o"], _ = roc_cur
-00064ee0: 7665 2879 5f74 6573 742e 7261 7665 6c28  ve(y_test.ravel(
-00064ef0: 292c 2079 5f70 726f 6261 5b3a 2c72 6172  ), y_proba[:,rar
-00064f00: 655f 636c 6173 735d 2e72 6176 656c 2829  e_class].ravel()
-00064f10: 290d 0a20 2020 2020 2020 2074 7279 3a0d  )..        try:.
-00064f20: 0a20 2020 2020 2020 2020 2020 2072 6f63  .            roc
-00064f30: 5f61 7563 5b22 6d69 6372 6f22 5d20 3d20  _auc["micro"] = 
-00064f40: 6175 6328 6670 725b 226d 6963 726f 225d  auc(fpr["micro"]
-00064f50: 2c20 7470 725b 226d 6963 726f 225d 290d  , tpr["micro"]).
-00064f60: 0a20 2020 2020 2020 2065 7863 6570 743a  .        except:
-00064f70: 0d0a 2020 2020 2020 2020 2020 2020 7061  ..            pa
-00064f80: 7373 0d0a 2020 2020 2020 2020 2320 6d69  ss..        # mi
-00064f90: 6372 6f2d 6176 6572 6167 6520 524f 4320  cro-average ROC 
-00064fa0: 6375 7276 6520 616e 6420 524f 4320 6172  curve and ROC ar
-00064fb0: 6561 2068 6173 2062 6565 6e20 636f 6d70  ea has been comp
-00064fc0: 7574 6564 0d0a 2020 2020 2020 2020 6c61  uted..        la
-00064fd0: 6265 6c73 203d 205b 5d0d 0a20 2020 2020  bels = []..     
-00064fe0: 2020 2069 6620 6e5f 636c 6173 7365 7320     if n_classes 
-00064ff0: 3c3d 2032 3a0d 0a20 2020 2020 2020 2020  <= 2:..         
-00065000: 2020 2023 2323 2323 2323 2323 2323 2323     #############
+00064960: 2020 2063 6c61 7373 6573 203d 206c 6973     classes = lis
+00064970: 7428 7261 6e67 6528 795f 7072 6f62 612e  t(range(y_proba.
+00064980: 7368 6170 655b 315d 2929 0d0a 2020 2020  shape[1]))..    
+00064990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000649a0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+000649b0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+000649c0: 6c61 7373 6573 203d 206c 6973 7428 7261  lasses = list(ra
+000649d0: 6e67 6528 795f 7465 7374 2e73 6861 7065  nge(y_test.shape
+000649e0: 5b31 5d29 290d 0a20 2020 2020 2020 2065  [1]))..        e
+000649f0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
+00064a00: 2020 2020 7061 7373 0d0a 2020 2020 2020      pass..      
+00064a10: 2020 6966 206e 5f63 6c61 7373 6573 203d    if n_classes =
+00064a20: 3d20 323a 0d0a 2020 2020 2020 2020 2020  = 2:..          
+00064a30: 2020 6974 6572 6174 696f 6e73 203d 2031    iterations = 1
+00064a40: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00064a50: 0a20 2020 2020 2020 2020 2020 2069 7465  .            ite
+00064a60: 7261 7469 6f6e 7320 3d20 636f 7079 2e64  rations = copy.d
+00064a70: 6565 7063 6f70 7928 6e5f 636c 6173 7365  eepcopy(n_classe
+00064a80: 7329 0d0a 2020 2020 2020 2020 2323 2323  s)..        ####
+00064a90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00064aa0: 2320 2020 5468 6973 2069 7320 7768 6572  #   This is wher
+00064ab0: 6520 796f 7520 6361 6c63 756c 6174 6520  e you calculate 
+00064ac0: 524f 435f 4155 4320 666f 7220 616c 6c20  ROC_AUC for all 
+00064ad0: 636c 6173 7365 7320 2323 2323 2323 2323  classes ########
+00064ae0: 230d 0a20 2020 2020 2020 2066 6f72 2069  #..        for i
+00064af0: 2069 6e20 7261 6e67 6528 6974 6572 6174   in range(iterat
+00064b00: 696f 6e73 293a 0d0a 2020 2020 2020 2020  ions):..        
+00064b10: 2020 2020 6966 206e 5f63 6c61 7373 6573      if n_classes
+00064b20: 3d3d 323a 0d0a 2020 2020 2020 2020 2020  ==2:..          
+00064b30: 2020 2020 2020 6670 725b 7261 7265 5f63        fpr[rare_c
+00064b40: 6c61 7373 5d2c 2074 7072 5b72 6172 655f  lass], tpr[rare_
+00064b50: 636c 6173 735d 2c20 5f20 3d20 726f 635f  class], _ = roc_
+00064b60: 6375 7276 6528 795f 7465 7374 2e72 6176  curve(y_test.rav
+00064b70: 656c 2829 2c20 795f 7072 6f62 615b 3a2c  el(), y_proba[:,
+00064b80: 7261 7265 5f63 6c61 7373 5d29 0d0a 2020  rare_class])..  
+00064b90: 2020 2020 2020 2020 2020 2020 2020 726f                ro
+00064ba0: 635f 6175 635b 7261 7265 5f63 6c61 7373  c_auc[rare_class
+00064bb0: 5d20 3d20 6175 6328 6670 725b 7261 7265  ] = auc(fpr[rare
+00064bc0: 5f63 6c61 7373 5d2c 2074 7072 5b72 6172  _class], tpr[rar
+00064bd0: 655f 636c 6173 735d 290d 0a20 2020 2020  e_class])..     
+00064be0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00064bf0: 2020 2020 2020 2020 2020 2020 2020 6670                fp
+00064c00: 725b 695d 2c20 7470 725b 695d 2c20 5f20  r[i], tpr[i], _ 
+00064c10: 3d20 726f 635f 6375 7276 6528 795f 7465  = roc_curve(y_te
+00064c20: 7374 5b3a 2c69 5d2c 2079 5f70 726f 6261  st[:,i], y_proba
+00064c30: 5b3a 2c69 5d29 0d0a 2020 2020 2020 2020  [:,i])..        
+00064c40: 2020 2020 2020 2020 726f 635f 6175 635b          roc_auc[
+00064c50: 695d 203d 2061 7563 2866 7072 5b69 5d2c  i] = auc(fpr[i],
+00064c60: 2074 7072 5b69 5d29 0d0a 2020 2020 2020   tpr[i])..      
+00064c70: 2020 2323 2320 436f 6d70 7574 6520 4d69    ### Compute Mi
+00064c80: 6372 6f20 4176 6572 6167 6520 7768 6963  cro Average whic
+00064c90: 6820 6973 2061 2072 6f77 2d62 792d 726f  h is a row-by-ro
+00064ca0: 7720 7363 6f72 6520 2323 2323 2323 2323  w score ########
+00064cb0: 2323 230d 0a20 2020 2020 2020 2074 7279  ###..        try
+00064cc0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00064cd0: 6620 6e5f 636c 6173 7365 7320 3d3d 2032  f n_classes == 2
+00064ce0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00064cf0: 2020 2066 7072 5b22 6d69 6372 6f22 5d2c     fpr["micro"],
+00064d00: 2074 7072 5b22 6d69 6372 6f22 5d2c 205f   tpr["micro"], _
+00064d10: 203d 2072 6f63 5f63 7572 7665 2879 5f74   = roc_curve(y_t
+00064d20: 6573 742e 7261 7665 6c28 292c 2079 5f70  est.ravel(), y_p
+00064d30: 7265 642e 7261 7665 6c28 2929 0d0a 2020  red.ravel())..  
+00064d40: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+00064d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00064d60: 2066 7072 5b22 6d69 6372 6f22 5d2c 2074   fpr["micro"], t
+00064d70: 7072 5b22 6d69 6372 6f22 5d2c 205f 203d  pr["micro"], _ =
+00064d80: 2072 6f63 5f63 7572 7665 2879 5f74 6573   roc_curve(y_tes
+00064d90: 742e 7261 7665 6c28 292c 6c61 6265 6c5f  t.ravel(),label_
+00064da0: 6269 6e61 7269 7a65 2879 5f70 7265 642c  binarize(y_pred,
+00064db0: 2063 6c61 7373 6573 292e 7261 7665 6c28   classes).ravel(
+00064dc0: 2929 0d0a 2020 2020 2020 2020 6578 6365  ))..        exce
+00064dd0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
+00064de0: 2069 6620 795f 7465 7374 2e72 6176 656c   if y_test.ravel
+00064df0: 2829 2e73 6861 7065 5b30 5d20 213d 2079  ().shape[0] != y
+00064e00: 5f70 7265 642e 7261 7665 6c28 292e 7368  _pred.ravel().sh
+00064e10: 6170 655b 305d 3a0d 0a20 2020 2020 2020  ape[0]:..       
+00064e20: 2020 2020 2020 2020 2066 7072 5b22 6d69           fpr["mi
+00064e30: 6372 6f22 5d2c 2074 7072 5b22 6d69 6372  cro"], tpr["micr
+00064e40: 6f22 5d2c 205f 203d 2072 6f63 5f63 7572  o"], _ = roc_cur
+00064e50: 7665 2879 5f74 6573 745b 3a2c 3a6e 5f63  ve(y_test[:,:n_c
+00064e60: 6c61 7373 6573 5d2e 7261 7665 6c28 292c  lasses].ravel(),
+00064e70: 2079 5f70 726f 6261 5b3a 2c3a 6e5f 636c   y_proba[:,:n_cl
+00064e80: 6173 7365 735d 2e72 6176 656c 2829 290d  asses].ravel()).
+00064e90: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00064ea0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00064eb0: 2020 2020 6670 725b 226d 6963 726f 225d      fpr["micro"]
+00064ec0: 2c20 7470 725b 226d 6963 726f 225d 2c20  , tpr["micro"], 
+00064ed0: 5f20 3d20 726f 635f 6375 7276 6528 795f  _ = roc_curve(y_
+00064ee0: 7465 7374 2e72 6176 656c 2829 2c20 795f  test.ravel(), y_
+00064ef0: 7072 6f62 615b 3a2c 7261 7265 5f63 6c61  proba[:,rare_cla
+00064f00: 7373 5d2e 7261 7665 6c28 2929 0d0a 2020  ss].ravel())..  
+00064f10: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
+00064f20: 2020 2020 2020 2020 726f 635f 6175 635b          roc_auc[
+00064f30: 226d 6963 726f 225d 203d 2061 7563 2866  "micro"] = auc(f
+00064f40: 7072 5b22 6d69 6372 6f22 5d2c 2074 7072  pr["micro"], tpr
+00064f50: 5b22 6d69 6372 6f22 5d29 0d0a 2020 2020  ["micro"])..    
+00064f60: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
+00064f70: 2020 2020 2020 2020 2070 6173 730d 0a20           pass.. 
+00064f80: 2020 2020 2020 2023 206d 6963 726f 2d61         # micro-a
+00064f90: 7665 7261 6765 2052 4f43 2063 7572 7665  verage ROC curve
+00064fa0: 2061 6e64 2052 4f43 2061 7265 6120 6861   and ROC area ha
+00064fb0: 7320 6265 656e 2063 6f6d 7075 7465 640d  s been computed.
+00064fc0: 0a20 2020 2020 2020 206c 6162 656c 7320  .        labels 
+00064fd0: 3d20 5b5d 0d0a 2020 2020 2020 2020 6966  = []..        if
+00064fe0: 206e 5f63 6c61 7373 6573 203c 3d20 323a   n_classes <= 2:
+00064ff0: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+00065000: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00065010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00065020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00065030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065050: 230d 0a20 2020 2020 2020 2020 2020 2023  #..            #
-00065060: 2050 6c6f 7420 6f66 2061 2052 4f43 2063   Plot of a ROC c
-00065070: 7572 7665 2066 6f72 206f 6e65 2063 6c61  urve for one cla
-00065080: 7373 0d0a 2020 2020 2020 2020 2020 2020  ss..            
-00065090: 706c 742e 6669 6775 7265 2866 6967 7369  plt.figure(figsi
-000650a0: 7a65 3d66 6967 7369 7a65 290d 0a20 2020  ze=figsize)..   
-000650b0: 2020 2020 2020 2020 2070 6c74 2e70 6c6f           plt.plo
-000650c0: 7428 6670 725b 7261 7265 5f63 6c61 7373  t(fpr[rare_class
-000650d0: 5d2c 2074 7072 5b72 6172 655f 636c 6173  ], tpr[rare_clas
-000650e0: 735d 2c20 6c61 6265 6c3d 2752 4f43 2063  s], label='ROC c
-000650f0: 7572 7665 2028 4155 4320 3d20 2530 2e35  urve (AUC = %0.5
-00065100: 6629 2720 2520 726f 635f 6175 635b 7261  f)' % roc_auc[ra
-00065110: 7265 5f63 6c61 7373 5d29 0d0a 2020 2020  re_class])..    
-00065120: 2020 2020 2020 2020 706c 742e 706c 6f74          plt.plot
-00065130: 285b 302c 2031 5d2c 205b 302c 2031 5d2c  ([0, 1], [0, 1],
-00065140: 2027 6b2d 2d27 290d 0a20 2020 2020 2020   'k--')..       
-00065150: 2020 2020 2070 6c74 2e78 6c69 6d28 5b30       plt.xlim([0
-00065160: 2e30 2c20 312e 305d 290d 0a20 2020 2020  .0, 1.0])..     
-00065170: 2020 2020 2020 2070 6c74 2e79 6c69 6d28         plt.ylim(
-00065180: 5b30 2e30 2c20 312e 3035 5d29 0d0a 2020  [0.0, 1.05])..  
-00065190: 2020 2020 2020 2020 2020 706c 742e 786c            plt.xl
-000651a0: 6162 656c 2827 4661 6c73 6520 506f 7369  abel('False Posi
-000651b0: 7469 7665 2052 6174 6527 290d 0a20 2020  tive Rate')..   
-000651c0: 2020 2020 2020 2020 2070 6c74 2e79 6c61           plt.yla
-000651d0: 6265 6c28 2754 7275 6520 506f 7369 7469  bel('True Positi
-000651e0: 7665 2052 6174 6527 290d 0a20 2020 2020  ve Rate')..     
-000651f0: 2020 2020 2020 2070 6c74 2e74 6974 6c65         plt.title
-00065200: 2827 524f 4320 4375 7276 6520 666f 7220  ('ROC Curve for 
-00065210: 5072 6564 6963 7469 6f6e 7320 6f6e 2068  Predictions on h
-00065220: 656c 6420 6f75 7420 6461 7461 2066 6f72  eld out data for
-00065230: 2074 6172 6765 743a 2025 7327 2025 7461   target: %s' %ta
-00065240: 7267 290d 0a20 2020 2020 2020 2020 2020  rg)..           
-00065250: 2070 6c74 2e6c 6567 656e 6428 6c6f 633d   plt.legend(loc=
-00065260: 226c 6f77 6572 2072 6967 6874 2229 0d0a  "lower right")..
-00065270: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
-00065280: 7368 6f77 2829 3b0d 0a20 2020 2020 2020  show();..       
-00065290: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-000652a0: 2320 436f 6d70 7574 6520 6d61 6372 6f2d  # Compute macro-
-000652b0: 6176 6572 6167 6520 524f 4320 6375 7276  average ROC curv
-000652c0: 6520 616e 6420 524f 4320 6172 6561 0d0a  e and ROC area..
-000652d0: 2020 2020 2020 2020 2020 2020 6669 672c              fig,
-000652e0: 2061 7820 3d20 706c 742e 7375 6270 6c6f   ax = plt.subplo
-000652f0: 7473 2866 6967 7369 7a65 3d66 6967 7369  ts(figsize=figsi
-00065300: 7a65 290d 0a20 2020 2020 2020 2020 2020  ze)..           
-00065310: 2063 6f6c 6f72 7320 3d20 6379 636c 6528   colors = cycle(
-00065320: 2762 7972 636d 676b 6279 7263 6d67 6b62  'byrcmgkbyrcmgkb
-00065330: 7972 636d 676b 6279 7263 6d67 6b27 290d  yrcmgkbyrcmgk').
-00065340: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00065350: 2069 2069 6e20 7261 6e67 6528 6974 6572   i in range(iter
-00065360: 6174 696f 6e73 293a 0d0a 0d0a 2020 2020  ations):....    
-00065370: 2020 2020 2020 2020 2020 2020 2320 4669              # Fi
-00065380: 7273 7420 6167 6772 6567 6174 6520 616c  rst aggregate al
-00065390: 6c20 6661 6c73 6520 706f 7369 7469 7665  l false positive
-000653a0: 2072 6174 6573 0d0a 2020 2020 2020 2020   rates..        
-000653b0: 2020 2020 2020 2020 616c 6c5f 6670 7220          all_fpr 
-000653c0: 3d20 6e70 2e75 6e69 7175 6528 6e70 2e63  = np.unique(np.c
-000653d0: 6f6e 6361 7465 6e61 7465 285b 6670 725b  oncatenate([fpr[
-000653e0: 695d 2066 6f72 2069 2069 6e20 7261 6e67  i] for i in rang
-000653f0: 6528 6e5f 636c 6173 7365 7329 5d29 290d  e(n_classes)])).
-00065400: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00065410: 2020 2023 2054 6865 6e20 696e 7465 7270     # Then interp
-00065420: 6f6c 6174 6520 616c 6c20 524f 4320 6375  olate all ROC cu
-00065430: 7276 6573 2061 7420 7468 6973 2070 6f69  rves at this poi
-00065440: 6e74 730d 0a20 2020 2020 2020 2020 2020  nts..           
-00065450: 2020 2020 206d 6561 6e5f 7470 7220 3d20       mean_tpr = 
-00065460: 6e70 2e7a 6572 6f73 5f6c 696b 6528 616c  np.zeros_like(al
-00065470: 6c5f 6670 7229 0d0a 2020 2020 2020 2020  l_fpr)..        
-00065480: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
-00065490: 2072 616e 6765 286e 5f63 6c61 7373 6573   range(n_classes
-000654a0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-000654b0: 2020 2020 2020 2020 6d65 616e 5f74 7072          mean_tpr
-000654c0: 202b 3d20 696e 7465 7270 2861 6c6c 5f66   += interp(all_f
-000654d0: 7072 2c20 6670 725b 6a5d 2c20 7470 725b  pr, fpr[j], tpr[
-000654e0: 6a5d 290d 0a0d 0a20 2020 2020 2020 2020  j])....         
-000654f0: 2020 2020 2020 2023 2046 696e 616c 6c79         # Finally
-00065500: 2061 7665 7261 6765 2069 7420 616e 6420   average it and 
-00065510: 636f 6d70 7574 6520 4155 430d 0a20 2020  compute AUC..   
-00065520: 2020 2020 2020 2020 2020 2020 206d 6561               mea
-00065530: 6e5f 7470 7220 2f3d 206e 5f63 6c61 7373  n_tpr /= n_class
-00065540: 6573 0d0a 0d0a 2020 2020 2020 2020 2020  es....          
-00065550: 2020 2020 2020 6670 725b 226d 6163 726f        fpr["macro
-00065560: 225d 203d 2061 6c6c 5f66 7072 0d0a 2020  "] = all_fpr..  
-00065570: 2020 2020 2020 2020 2020 2020 2020 7470                tp
-00065580: 725b 226d 6163 726f 225d 203d 206d 6561  r["macro"] = mea
-00065590: 6e5f 7470 720d 0a20 2020 2020 2020 2020  n_tpr..         
-000655a0: 2020 2020 2020 2072 6f63 5f61 7563 5b22         roc_auc["
-000655b0: 6d61 6372 6f22 5d20 3d20 6175 6328 6670  macro"] = auc(fp
-000655c0: 725b 226d 6163 726f 225d 2c20 7470 725b  r["macro"], tpr[
-000655d0: 226d 6163 726f 225d 290d 0a0d 0a20 2020  "macro"])....   
-000655e0: 2020 2020 2020 2020 2020 2020 2023 2050               # P
-000655f0: 6c6f 7420 616c 6c20 524f 4320 6375 7276  lot all ROC curv
-00065600: 6573 0d0a 2020 2020 2020 2020 2020 2020  es..            
-00065610: 2020 2020 6c77 203d 2032 0d0a 2020 2020      lw = 2..    
-00065620: 2020 2020 2020 2020 2020 2020 636f 6c6f              colo
-00065630: 7220 3d20 6e65 7874 2863 6f6c 6f72 7329  r = next(colors)
-00065640: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00065650: 2020 6178 2e70 6c6f 7428 6670 725b 695d    ax.plot(fpr[i]
-00065660: 2c20 7470 725b 695d 2c20 636f 6c6f 723d  , tpr[i], color=
-00065670: 636f 6c6f 722c 206c 773d 6c77 290d 0a20  color, lw=lw).. 
-00065680: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00065690: 6162 656c 732e 6170 7065 6e64 2827 524f  abels.append('RO
-000656a0: 4320 6375 7276 6520 6f66 2063 6c61 7373  C curve of class
-000656b0: 2025 6420 2861 7265 6120 3d20 2530 2e32   %d (area = %0.2
-000656c0: 6629 2720 2528 692c 2072 6f63 5f61 7563  f)' %(i, roc_auc
-000656d0: 5b69 5d29 290d 0a20 2020 2020 2020 2020  [i]))..         
-000656e0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-000656f0: 2020 2020 2020 2020 206c 6162 656c 732e           labels.
-00065700: 6170 7065 6e64 2827 6d69 6372 6f2d 6176  append('micro-av
-00065710: 6572 6167 6520 524f 4320 6375 7276 6520  erage ROC curve 
-00065720: 2861 7265 6120 3d20 7b30 3a30 2e32 667d  (area = {0:0.2f}
-00065730: 2927 0d0a 2020 2020 2020 2020 2020 2020  )'..            
-00065740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00065750: 2020 2027 272e 666f 726d 6174 2872 6f63     ''.format(roc
-00065760: 5f61 7563 5b22 6d69 6372 6f22 5d29 290d  _auc["micro"])).
-00065770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00065780: 2061 782e 706c 6f74 2866 7072 5b22 6d69   ax.plot(fpr["mi
-00065790: 6372 6f22 5d2c 2074 7072 5b22 6d69 6372  cro"], tpr["micr
-000657a0: 6f22 5d2c 0d0a 2020 2020 2020 2020 2020  o"],..          
-000657b0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-000657c0: 6f6c 6f72 3d27 6465 6570 7069 6e6b 272c  olor='deeppink',
-000657d0: 206c 696e 6573 7479 6c65 3d27 3a27 2c20   linestyle=':', 
-000657e0: 6c69 6e65 7769 6474 683d 3429 0d0a 2020  linewidth=4)..  
-000657f0: 2020 2020 2020 2020 2020 6578 6365 7074            except
-00065800: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00065810: 2020 2070 6173 730d 0a20 2020 2020 2020     pass..       
-00065820: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00065830: 2020 2020 2020 2020 2020 206c 6162 656c             label
-00065840: 732e 6170 7065 6e64 2827 6d61 6372 6f2d  s.append('macro-
-00065850: 6176 6572 6167 6520 524f 4320 6375 7276  average ROC curv
-00065860: 6520 2861 7265 6120 3d20 7b30 3a30 2e32  e (area = {0:0.2
-00065870: 667d 2927 0d0a 2020 2020 2020 2020 2020  f})'..          
+00065040: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
+00065050: 2020 2020 2020 2020 2020 2320 506c 6f74            # Plot
+00065060: 206f 6620 6120 524f 4320 6375 7276 6520   of a ROC curve 
+00065070: 666f 7220 6f6e 6520 636c 6173 730d 0a20  for one class.. 
+00065080: 2020 2020 2020 2020 2020 2070 6c74 2e66             plt.f
+00065090: 6967 7572 6528 6669 6773 697a 653d 6669  igure(figsize=fi
+000650a0: 6773 697a 6529 0d0a 2020 2020 2020 2020  gsize)..        
+000650b0: 2020 2020 706c 742e 706c 6f74 2866 7072      plt.plot(fpr
+000650c0: 5b72 6172 655f 636c 6173 735d 2c20 7470  [rare_class], tp
+000650d0: 725b 7261 7265 5f63 6c61 7373 5d2c 206c  r[rare_class], l
+000650e0: 6162 656c 3d27 524f 4320 6375 7276 6520  abel='ROC curve 
+000650f0: 2841 5543 203d 2025 302e 3566 2927 2025  (AUC = %0.5f)' %
+00065100: 2072 6f63 5f61 7563 5b72 6172 655f 636c   roc_auc[rare_cl
+00065110: 6173 735d 290d 0a20 2020 2020 2020 2020  ass])..         
+00065120: 2020 2070 6c74 2e70 6c6f 7428 5b30 2c20     plt.plot([0, 
+00065130: 315d 2c20 5b30 2c20 315d 2c20 276b 2d2d  1], [0, 1], 'k--
+00065140: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+00065150: 706c 742e 786c 696d 285b 302e 302c 2031  plt.xlim([0.0, 1
+00065160: 2e30 5d29 0d0a 2020 2020 2020 2020 2020  .0])..          
+00065170: 2020 706c 742e 796c 696d 285b 302e 302c    plt.ylim([0.0,
+00065180: 2031 2e30 355d 290d 0a20 2020 2020 2020   1.05])..       
+00065190: 2020 2020 2070 6c74 2e78 6c61 6265 6c28       plt.xlabel(
+000651a0: 2746 616c 7365 2050 6f73 6974 6976 6520  'False Positive 
+000651b0: 5261 7465 2729 0d0a 2020 2020 2020 2020  Rate')..        
+000651c0: 2020 2020 706c 742e 796c 6162 656c 2827      plt.ylabel('
+000651d0: 5472 7565 2050 6f73 6974 6976 6520 5261  True Positive Ra
+000651e0: 7465 2729 0d0a 2020 2020 2020 2020 2020  te')..          
+000651f0: 2020 706c 742e 7469 746c 6528 2752 4f43    plt.title('ROC
+00065200: 2043 7572 7665 2066 6f72 2050 7265 6469   Curve for Predi
+00065210: 6374 696f 6e73 206f 6e20 6865 6c64 206f  ctions on held o
+00065220: 7574 2064 6174 6120 666f 7220 7461 7267  ut data for targ
+00065230: 6574 3a20 2573 2720 2574 6172 6729 0d0a  et: %s' %targ)..
+00065240: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
+00065250: 6c65 6765 6e64 286c 6f63 3d22 6c6f 7765  legend(loc="lowe
+00065260: 7220 7269 6768 7422 290d 0a20 2020 2020  r right")..     
+00065270: 2020 2020 2020 2070 6c74 2e73 686f 7728         plt.show(
+00065280: 293b 0d0a 2020 2020 2020 2020 656c 7365  );..        else
+00065290: 3a0d 0a20 2020 2020 2020 2023 2043 6f6d  :..        # Com
+000652a0: 7075 7465 206d 6163 726f 2d61 7665 7261  pute macro-avera
+000652b0: 6765 2052 4f43 2063 7572 7665 2061 6e64  ge ROC curve and
+000652c0: 2052 4f43 2061 7265 610d 0a20 2020 2020   ROC area..     
+000652d0: 2020 2020 2020 2066 6967 2c20 6178 203d         fig, ax =
+000652e0: 2070 6c74 2e73 7562 706c 6f74 7328 6669   plt.subplots(fi
+000652f0: 6773 697a 653d 6669 6773 697a 6529 0d0a  gsize=figsize)..
+00065300: 2020 2020 2020 2020 2020 2020 636f 6c6f              colo
+00065310: 7273 203d 2063 7963 6c65 2827 6279 7263  rs = cycle('byrc
+00065320: 6d67 6b62 7972 636d 676b 6279 7263 6d67  mgkbyrcmgkbyrcmg
+00065330: 6b62 7972 636d 676b 2729 0d0a 2020 2020  kbyrcmgk')..    
+00065340: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00065350: 2072 616e 6765 2869 7465 7261 7469 6f6e   range(iteration
+00065360: 7329 3a0d 0a0d 0a20 2020 2020 2020 2020  s):....         
+00065370: 2020 2020 2020 2023 2046 6972 7374 2061         # First a
+00065380: 6767 7265 6761 7465 2061 6c6c 2066 616c  ggregate all fal
+00065390: 7365 2070 6f73 6974 6976 6520 7261 7465  se positive rate
+000653a0: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
+000653b0: 2020 2061 6c6c 5f66 7072 203d 206e 702e     all_fpr = np.
+000653c0: 756e 6971 7565 286e 702e 636f 6e63 6174  unique(np.concat
+000653d0: 656e 6174 6528 5b66 7072 5b69 5d20 666f  enate([fpr[i] fo
+000653e0: 7220 6920 696e 2072 616e 6765 286e 5f63  r i in range(n_c
+000653f0: 6c61 7373 6573 295d 2929 0d0a 0d0a 2020  lasses)]))....  
+00065400: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00065410: 5468 656e 2069 6e74 6572 706f 6c61 7465  Then interpolate
+00065420: 2061 6c6c 2052 4f43 2063 7572 7665 7320   all ROC curves 
+00065430: 6174 2074 6869 7320 706f 696e 7473 0d0a  at this points..
+00065440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00065450: 6d65 616e 5f74 7072 203d 206e 702e 7a65  mean_tpr = np.ze
+00065460: 726f 735f 6c69 6b65 2861 6c6c 5f66 7072  ros_like(all_fpr
+00065470: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00065480: 2020 2066 6f72 206a 2069 6e20 7261 6e67     for j in rang
+00065490: 6528 6e5f 636c 6173 7365 7329 3a0d 0a20  e(n_classes):.. 
+000654a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000654b0: 2020 206d 6561 6e5f 7470 7220 2b3d 2069     mean_tpr += i
+000654c0: 6e74 6572 7028 616c 6c5f 6670 722c 2066  nterp(all_fpr, f
+000654d0: 7072 5b6a 5d2c 2074 7072 5b6a 5d29 0d0a  pr[j], tpr[j])..
+000654e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000654f0: 2020 2320 4669 6e61 6c6c 7920 6176 6572    # Finally aver
+00065500: 6167 6520 6974 2061 6e64 2063 6f6d 7075  age it and compu
+00065510: 7465 2041 5543 0d0a 2020 2020 2020 2020  te AUC..        
+00065520: 2020 2020 2020 2020 6d65 616e 5f74 7072          mean_tpr
+00065530: 202f 3d20 6e5f 636c 6173 7365 730d 0a0d   /= n_classes...
+00065540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00065550: 2066 7072 5b22 6d61 6372 6f22 5d20 3d20   fpr["macro"] = 
+00065560: 616c 6c5f 6670 720d 0a20 2020 2020 2020  all_fpr..       
+00065570: 2020 2020 2020 2020 2074 7072 5b22 6d61           tpr["ma
+00065580: 6372 6f22 5d20 3d20 6d65 616e 5f74 7072  cro"] = mean_tpr
+00065590: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000655a0: 2020 726f 635f 6175 635b 226d 6163 726f    roc_auc["macro
+000655b0: 225d 203d 2061 7563 2866 7072 5b22 6d61  "] = auc(fpr["ma
+000655c0: 6372 6f22 5d2c 2074 7072 5b22 6d61 6372  cro"], tpr["macr
+000655d0: 6f22 5d29 0d0a 0d0a 2020 2020 2020 2020  o"])....        
+000655e0: 2020 2020 2020 2020 2320 506c 6f74 2061          # Plot a
+000655f0: 6c6c 2052 4f43 2063 7572 7665 730d 0a20  ll ROC curves.. 
+00065600: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00065610: 7720 3d20 320d 0a20 2020 2020 2020 2020  w = 2..         
+00065620: 2020 2020 2020 2063 6f6c 6f72 203d 206e         color = n
+00065630: 6578 7428 636f 6c6f 7273 290d 0a20 2020  ext(colors)..   
+00065640: 2020 2020 2020 2020 2020 2020 2061 782e               ax.
+00065650: 706c 6f74 2866 7072 5b69 5d2c 2074 7072  plot(fpr[i], tpr
+00065660: 5b69 5d2c 2063 6f6c 6f72 3d63 6f6c 6f72  [i], color=color
+00065670: 2c20 6c77 3d6c 7729 0d0a 2020 2020 2020  , lw=lw)..      
+00065680: 2020 2020 2020 2020 2020 6c61 6265 6c73            labels
+00065690: 2e61 7070 656e 6428 2752 4f43 2063 7572  .append('ROC cur
+000656a0: 7665 206f 6620 636c 6173 7320 2564 2028  ve of class %d (
+000656b0: 6172 6561 203d 2025 302e 3266 2927 2025  area = %0.2f)' %
+000656c0: 2869 2c20 726f 635f 6175 635b 695d 2929  (i, roc_auc[i]))
+000656d0: 0d0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
+000656e0: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
+000656f0: 2020 2020 6c61 6265 6c73 2e61 7070 656e      labels.appen
+00065700: 6428 276d 6963 726f 2d61 7665 7261 6765  d('micro-average
+00065710: 2052 4f43 2063 7572 7665 2028 6172 6561   ROC curve (area
+00065720: 203d 207b 303a 302e 3266 7d29 270d 0a20   = {0:0.2f})'.. 
+00065730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00065740: 2020 2020 2020 2020 2020 2020 2020 2727                ''
+00065750: 2e66 6f72 6d61 7428 726f 635f 6175 635b  .format(roc_auc[
+00065760: 226d 6963 726f 225d 2929 0d0a 2020 2020  "micro"]))..    
+00065770: 2020 2020 2020 2020 2020 2020 6178 2e70              ax.p
+00065780: 6c6f 7428 6670 725b 226d 6963 726f 225d  lot(fpr["micro"]
+00065790: 2c20 7470 725b 226d 6963 726f 225d 2c0d  , tpr["micro"],.
+000657a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000657b0: 2020 2020 2020 2020 2020 636f 6c6f 723d            color=
+000657c0: 2764 6565 7070 696e 6b27 2c20 6c69 6e65  'deeppink', line
+000657d0: 7374 796c 653d 273a 272c 206c 696e 6577  style=':', linew
+000657e0: 6964 7468 3d34 290d 0a20 2020 2020 2020  idth=4)..       
+000657f0: 2020 2020 2065 7863 6570 743a 0d0a 2020       except:..  
+00065800: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00065810: 7373 0d0a 2020 2020 2020 2020 2020 2020  ss..            
+00065820: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+00065830: 2020 2020 2020 6c61 6265 6c73 2e61 7070        labels.app
+00065840: 656e 6428 276d 6163 726f 2d61 7665 7261  end('macro-avera
+00065850: 6765 2052 4f43 2063 7572 7665 2028 6172  ge ROC curve (ar
+00065860: 6561 203d 207b 303a 302e 3266 7d29 270d  ea = {0:0.2f})'.
+00065870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00065880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00065890: 2020 2020 2027 272e 666f 726d 6174 2872       ''.format(r
-000658a0: 6f63 5f61 7563 5b22 6d61 6372 6f22 5d29  oc_auc["macro"])
-000658b0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-000658c0: 2020 2061 782e 706c 6f74 2866 7072 5b22     ax.plot(fpr["
-000658d0: 6d61 6372 6f22 5d2c 2074 7072 5b22 6d61  macro"], tpr["ma
-000658e0: 6372 6f22 5d2c 0d0a 2020 2020 2020 2020  cro"],..        
-000658f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00065900: 2063 6f6c 6f72 3d27 6e61 7679 272c 206c   color='navy', l
-00065910: 696e 6573 7479 6c65 3d27 3a27 2c20 6c69  inestyle=':', li
-00065920: 6e65 7769 6474 683d 3429 0d0a 2020 2020  newidth=4)..    
-00065930: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
-00065940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00065950: 2070 6173 730d 0a20 2020 2020 2020 2020   pass..         
-00065960: 2020 2061 782e 706c 6f74 285b 302c 2031     ax.plot([0, 1
-00065970: 5d2c 205b 302c 2031 5d2c 2027 6b2d 2d27  ], [0, 1], 'k--'
-00065980: 2c20 6c77 3d6c 7729 0d0a 2020 2020 2020  , lw=lw)..      
-00065990: 2020 2020 2020 6178 2e73 6574 5f78 6c69        ax.set_xli
-000659a0: 6d28 5b30 2e30 2c20 312e 305d 290d 0a20  m([0.0, 1.0]).. 
-000659b0: 2020 2020 2020 2020 2020 2061 782e 7365             ax.se
-000659c0: 745f 796c 696d 285b 302e 302c 2031 2e30  t_ylim([0.0, 1.0
-000659d0: 355d 290d 0a20 2020 2020 2020 2020 2020  5])..           
-000659e0: 2061 782e 7365 745f 786c 6162 656c 2827   ax.set_xlabel('
-000659f0: 4661 6c73 6520 506f 7369 7469 7665 2052  False Positive R
-00065a00: 6174 6527 290d 0a20 2020 2020 2020 2020  ate')..         
-00065a10: 2020 2061 782e 7365 745f 796c 6162 656c     ax.set_ylabel
-00065a20: 2827 5472 7565 2050 6f73 6974 6976 6520  ('True Positive 
-00065a30: 5261 7465 2729 0d0a 2020 2020 2020 2020  Rate')..        
-00065a40: 2020 2020 6178 2e73 6574 5f74 6974 6c65      ax.set_title
-00065a50: 2827 524f 4320 4375 7276 6520 666f 7220  ('ROC Curve for 
-00065a60: 5072 6564 6963 7469 6f6e 7320 6f6e 2068  Predictions on h
-00065a70: 656c 6420 6f75 7420 6461 7461 2066 6f72  eld out data for
-00065a80: 2074 6172 6765 743a 2025 7327 2025 7461   target: %s' %ta
-00065a90: 7267 290d 0a20 2020 2020 2020 2020 2020  rg)..           
-00065aa0: 2070 6c74 2e6c 6567 656e 6428 6c61 6265   plt.legend(labe
-00065ab0: 6c73 2c6c 6f63 3d22 6c6f 7765 7220 7269  ls,loc="lower ri
-00065ac0: 6768 7422 290d 0a20 2020 2020 2020 2020  ght")..         
-00065ad0: 2020 2070 6c74 2e73 686f 7728 293b 0d0a     plt.show();..
-00065ae0: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+00065890: 2727 2e66 6f72 6d61 7428 726f 635f 6175  ''.format(roc_au
+000658a0: 635b 226d 6163 726f 225d 2929 0d0a 2020  c["macro"]))..  
+000658b0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+000658c0: 2e70 6c6f 7428 6670 725b 226d 6163 726f  .plot(fpr["macro
+000658d0: 225d 2c20 7470 725b 226d 6163 726f 225d  "], tpr["macro"]
+000658e0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000658f0: 2020 2020 2020 2020 2020 2020 636f 6c6f              colo
+00065900: 723d 276e 6176 7927 2c20 6c69 6e65 7374  r='navy', linest
+00065910: 796c 653d 273a 272c 206c 696e 6577 6964  yle=':', linewid
+00065920: 7468 3d34 290d 0a20 2020 2020 2020 2020  th=4)..         
+00065930: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
+00065940: 2020 2020 2020 2020 2020 2020 7061 7373              pass
+00065950: 0d0a 2020 2020 2020 2020 2020 2020 6178  ..            ax
+00065960: 2e70 6c6f 7428 5b30 2c20 315d 2c20 5b30  .plot([0, 1], [0
+00065970: 2c20 315d 2c20 276b 2d2d 272c 206c 773d  , 1], 'k--', lw=
+00065980: 6c77 290d 0a20 2020 2020 2020 2020 2020  lw)..           
+00065990: 2061 782e 7365 745f 786c 696d 285b 302e   ax.set_xlim([0.
+000659a0: 302c 2031 2e30 5d29 0d0a 2020 2020 2020  0, 1.0])..      
+000659b0: 2020 2020 2020 6178 2e73 6574 5f79 6c69        ax.set_yli
+000659c0: 6d28 5b30 2e30 2c20 312e 3035 5d29 0d0a  m([0.0, 1.05])..
+000659d0: 2020 2020 2020 2020 2020 2020 6178 2e73              ax.s
+000659e0: 6574 5f78 6c61 6265 6c28 2746 616c 7365  et_xlabel('False
+000659f0: 2050 6f73 6974 6976 6520 5261 7465 2729   Positive Rate')
+00065a00: 0d0a 2020 2020 2020 2020 2020 2020 6178  ..            ax
+00065a10: 2e73 6574 5f79 6c61 6265 6c28 2754 7275  .set_ylabel('Tru
+00065a20: 6520 506f 7369 7469 7665 2052 6174 6527  e Positive Rate'
+00065a30: 290d 0a20 2020 2020 2020 2020 2020 2061  )..            a
+00065a40: 782e 7365 745f 7469 746c 6528 2752 4f43  x.set_title('ROC
+00065a50: 2043 7572 7665 2066 6f72 2050 7265 6469   Curve for Predi
+00065a60: 6374 696f 6e73 206f 6e20 6865 6c64 206f  ctions on held o
+00065a70: 7574 2064 6174 6120 666f 7220 7461 7267  ut data for targ
+00065a80: 6574 3a20 2573 2720 2574 6172 6729 0d0a  et: %s' %targ)..
+00065a90: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
+00065aa0: 6c65 6765 6e64 286c 6162 656c 732c 6c6f  legend(labels,lo
+00065ab0: 633d 226c 6f77 6572 2072 6967 6874 2229  c="lower right")
+00065ac0: 0d0a 2020 2020 2020 2020 2020 2020 706c  ..            pl
+00065ad0: 742e 7368 6f77 2829 3b0d 0a0d 0a23 2323  t.show();....###
+00065ae0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00065af0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00065b00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00065b10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00065b20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065b30: 2323 2323 230d 0a23 2052 656d 6f76 6573  #####..# Removes
-00065b40: 2064 7570 6c69 6361 7465 7320 6672 6f6d   duplicates from
-00065b50: 2061 206c 6973 7420 746f 2072 6574 7572   a list to retur
-00065b60: 6e20 756e 6971 7565 2076 616c 7565 7320  n unique values 
-00065b70: 2d20 5553 4544 204f 4e4c 594f 4e43 450d  - USED ONLYONCE.
-00065b80: 0a64 6566 2066 696e 645f 7265 6d6f 7665  .def find_remove
-00065b90: 5f64 7570 6c69 6361 7465 7328 7661 6c75  _duplicates(valu
-00065ba0: 6573 293a 0d0a 2020 2020 6f75 7470 7574  es):..    output
-00065bb0: 203d 205b 5d0d 0a20 2020 2073 6565 6e20   = []..    seen 
-00065bc0: 3d20 7365 7428 290d 0a20 2020 2066 6f72  = set()..    for
-00065bd0: 2076 616c 7565 2069 6e20 7661 6c75 6573   value in values
-00065be0: 3a0d 0a20 2020 2020 2020 2069 6620 7661  :..        if va
-00065bf0: 6c75 6520 6e6f 7420 696e 2073 6565 6e3a  lue not in seen:
-00065c00: 0d0a 2020 2020 2020 2020 2020 2020 6f75  ..            ou
-00065c10: 7470 7574 2e61 7070 656e 6428 7661 6c75  tput.append(valu
-00065c20: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
-00065c30: 7365 656e 2e61 6464 2876 616c 7565 290d  seen.add(value).
-00065c40: 0a20 2020 2072 6574 7572 6e20 6f75 7470  .    return outp
-00065c50: 7574 0d0a 2323 2323 2323 2323 2323 2323  ut..############
+00065b30: 0d0a 2320 5265 6d6f 7665 7320 6475 706c  ..# Removes dupl
+00065b40: 6963 6174 6573 2066 726f 6d20 6120 6c69  icates from a li
+00065b50: 7374 2074 6f20 7265 7475 726e 2075 6e69  st to return uni
+00065b60: 7175 6520 7661 6c75 6573 202d 2055 5345  que values - USE
+00065b70: 4420 4f4e 4c59 4f4e 4345 0d0a 6465 6620  D ONLYONCE..def 
+00065b80: 6669 6e64 5f72 656d 6f76 655f 6475 706c  find_remove_dupl
+00065b90: 6963 6174 6573 2876 616c 7565 7329 3a0d  icates(values):.
+00065ba0: 0a20 2020 206f 7574 7075 7420 3d20 5b5d  .    output = []
+00065bb0: 0d0a 2020 2020 7365 656e 203d 2073 6574  ..    seen = set
+00065bc0: 2829 0d0a 2020 2020 666f 7220 7661 6c75  ()..    for valu
+00065bd0: 6520 696e 2076 616c 7565 733a 0d0a 2020  e in values:..  
+00065be0: 2020 2020 2020 6966 2076 616c 7565 206e        if value n
+00065bf0: 6f74 2069 6e20 7365 656e 3a0d 0a20 2020  ot in seen:..   
+00065c00: 2020 2020 2020 2020 206f 7574 7075 742e           output.
+00065c10: 6170 7065 6e64 2876 616c 7565 290d 0a20  append(value).. 
+00065c20: 2020 2020 2020 2020 2020 2073 6565 6e2e             seen.
+00065c30: 6164 6428 7661 6c75 6529 0d0a 2020 2020  add(value)..    
+00065c40: 7265 7475 726e 206f 7574 7075 740d 0a23  return output..#
+00065c50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00065c60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00065c70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00065c80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00065c90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00065ca0: 2323 2323 2323 230d 0a64 6566 2073 706c  #######..def spl
-00065cb0: 6974 5f64 6174 615f 6e65 7728 7472 6169  it_data_new(trai
-00065cc0: 6e66 696c 652c 2074 6573 7466 696c 652c  nfile, testfile,
-00065cd0: 2074 6172 6765 742c 7365 702c 206d 6f64   target,sep, mod
-00065ce0: 656c 7479 7065 3d27 5265 6772 6573 7369  eltype='Regressi
-00065cf0: 6f6e 272c 2072 616e 646f 6d73 7461 7465  on', randomstate
-00065d00: 3d30 293a 0d0a 2020 2020 2222 220d 0a20  =0):..    """.. 
-00065d10: 2020 2053 706c 6974 2079 6f75 7220 6669     Split your fi
-00065d20: 6c65 206f 7220 6461 7461 2066 7261 6d65  le or data frame
-00065d30: 2069 6e74 6f20 3220 6f72 2033 2073 706c   into 2 or 3 spl
-00065d40: 6974 732e 2053 7472 6174 6966 6965 6420  its. Stratified 
-00065d50: 6279 2043 6c61 7373 2061 7574 6f6d 6174  by Class automat
-00065d60: 6963 616c 6c79 2e0d 0a20 2020 2041 6464  ically...    Add
-00065d70: 6974 696f 6e61 6c6c 792c 2069 7420 7769  itionally, it wi
-00065d80: 6c6c 2073 7472 6970 206f 7574 206e 6f6e  ll strip out non
-00065d90: 2d6e 756d 6572 6963 2063 6f6c 7320 696e  -numeric cols in
-00065da0: 2079 6f75 7220 6461 7461 2069 6620 796f   your data if yo
-00065db0: 7520 6e65 6564 2069 742e 0d0a 2020 2020  u need it...    
-00065dc0: 2222 220d 0a20 2020 2072 616e 646f 6d73  """..    randoms
-00065dd0: 7461 7465 203d 2039 390d 0a20 2020 2023  tate = 99..    #
-00065de0: 2323 2323 2323 2043 6f64 6573 5f6c 6973  ###### Codes_lis
-00065df0: 7420 636f 6e74 6169 6e73 206d 756c 7469  t contains multi
-00065e00: 706c 6520 656e 636f 6465 7273 2074 6861  ple encoders tha
-00065e10: 7420 6172 6520 7573 6564 2074 6f20 6f70  t are used to op
-00065e20: 656e 2061 2043 5356 2066 696c 650d 0a20  en a CSV file.. 
-00065e30: 2020 2063 6f64 6573 5f6c 6973 7420 3d20     codes_list = 
-00065e40: 5b27 7574 662d 3827 2c27 6973 6f2d 3838  ['utf-8','iso-88
-00065e50: 3539 2d31 272c 2763 7031 3235 3227 2c27  59-1','cp1252','
-00065e60: 6c61 7469 6e31 275d 0d0a 2020 2020 7365  latin1']..    se
-00065e70: 6564 203d 2039 390d 0a20 2020 2069 6620  ed = 99..    if 
-00065e80: 7479 7065 2874 7261 696e 6669 6c65 2920  type(trainfile) 
-00065e90: 3d3d 2073 7472 3a0d 0a20 2020 2020 2020  == str:..       
-00065ea0: 2069 6620 7472 6169 6e66 696c 6520 213d   if trainfile !=
-00065eb0: 2027 273a 0d0a 2020 2020 2020 2020 2020   '':..          
-00065ec0: 2020 2323 2323 2046 6972 7374 206c 6f61    #### First loa
-00065ed0: 6420 7468 6520 5472 6169 6e20 6669 6c65  d the Train file
-00065ee0: 2069 6620 6974 2069 7320 6176 6169 6c61   if it is availa
-00065ef0: 626c 6520 2323 2323 2323 2323 2323 0d0a  ble ##########..
-00065f00: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00065f10: 636f 6465 7820 696e 2063 6f64 6573 5f6c  codex in codes_l
-00065f20: 6973 743a 0d0a 2020 2020 2020 2020 2020  ist:..          
-00065f30: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-00065f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00065f50: 7472 6169 6e64 6620 3d20 7064 2e72 6561  traindf = pd.rea
-00065f60: 645f 6373 7628 7472 6169 6e66 696c 652c  d_csv(trainfile,
-00065f70: 7365 703d 7365 702c 656e 636f 6469 6e67  sep=sep,encoding
-00065f80: 3d63 6f64 6578 2c69 6e64 6578 5f63 6f6c  =codex,index_col
-00065f90: 3d4e 6f6e 6529 0d0a 2020 2020 2020 2020  =None)..        
-00065fa0: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-00065fb0: 6b0d 0a20 2020 2020 2020 2020 2020 2020  k..             
-00065fc0: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
-00065fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00065fe0: 636f 6e74 696e 7565 0d0a 2020 2020 2020  continue..      
-00065ff0: 2020 2020 2020 7072 696e 7428 2754 7261        print('Tra
-00066000: 696e 2064 6174 6120 6769 7665 6e2e 2053  in data given. S
-00066010: 6861 7065 203d 2025 7327 2025 2874 7261  hape = %s' %(tra
-00066020: 696e 6466 2e73 6861 7065 2c29 290d 0a20  indf.shape,)).. 
-00066030: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00066040: 2827 5461 7267 6574 2052 6f77 7320 5472  ('Target Rows Tr
-00066050: 6169 6e20 3d20 2564 2720 256c 656e 2874  ain = %d' %len(t
-00066060: 7261 696e 6466 5b74 7261 696e 6466 5b74  raindf[traindf[t
-00066070: 6172 6765 745d 3d3d 315d 2929 0d0a 2020  arget]==1]))..  
-00066080: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00066090: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-000660a0: 5472 6169 6e66 696c 6520 6973 206e 6f74  Trainfile is not
-000660b0: 2066 6f75 6e64 2e20 4368 6563 6b20 796f   found. Check yo
-000660c0: 7572 2069 6e70 7574 206f 7220 6669 6c65  ur input or file
-000660d0: 2064 6573 7469 6e61 7469 6f6e 2729 0d0a   destination')..
-000660e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000660f0: 726e 0d0a 2020 2020 2020 2020 6966 2020  rn..        if  
-00066100: 7479 7065 2874 6573 7466 696c 6529 203d  type(testfile) =
-00066110: 3d20 7374 723a 0d0a 2020 2020 2020 2020  = str:..        
-00066120: 2020 2020 6966 2074 6573 7466 696c 6520      if testfile 
-00066130: 213d 2027 273a 0d0a 2020 2020 2020 2020  != '':..        
-00066140: 2020 2020 2020 2020 7072 696e 7428 2754          print('T
-00066150: 7261 696e 2066 696c 6520 616e 6420 5465  rain file and Te
-00066160: 7374 2066 696c 6520 6769 7665 6e2e 2729  st file given.')
-00066170: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00066180: 2020 2323 2323 2323 2049 6620 7465 7374    ###### If test
-00066190: 6669 6c65 2069 7320 6176 6169 6c61 626c  file is availabl
-000661a0: 652c 2079 6f75 206e 6565 6420 746f 2063  e, you need to c
-000661b0: 6f6d 6269 6e65 2074 7261 696e 2061 6e64  ombine train and
-000661c0: 2074 6573 7420 6461 7461 7365 7473 0d0a   test datasets..
-000661d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000661e0: 7072 696e 7428 2754 7261 696e 2044 6174  print('Train Dat
-000661f0: 6146 7261 6d65 2061 6e64 2054 6573 7466  aFrame and Testf
-00066200: 696c 6520 6769 7665 6e2e 2729 0d0a 2020  ile given.')..  
-00066210: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00066220: 7220 636f 6465 7820 696e 2063 6f64 6573  r codex in codes
-00066230: 5f6c 6973 743a 0d0a 2020 2020 2020 2020  _list:..        
-00066240: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-00066250: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00066260: 2020 2020 2020 2020 2020 7465 7374 6466            testdf
-00066270: 203d 2070 642e 7265 6164 5f63 7376 2874   = pd.read_csv(t
-00066280: 6573 7466 696c 652c 7365 703d 7365 702c  estfile,sep=sep,
-00066290: 656e 636f 6469 6e67 3d63 6f64 6578 2c69  encoding=codex,i
-000662a0: 6e64 6578 5f63 6f6c 3d4e 6f6e 6529 0d0a  ndex_col=None)..
+00065ca0: 2323 0d0a 6465 6620 7370 6c69 745f 6461  ##..def split_da
+00065cb0: 7461 5f6e 6577 2874 7261 696e 6669 6c65  ta_new(trainfile
+00065cc0: 2c20 7465 7374 6669 6c65 2c20 7461 7267  , testfile, targ
+00065cd0: 6574 2c73 6570 2c20 6d6f 6465 6c74 7970  et,sep, modeltyp
+00065ce0: 653d 2752 6567 7265 7373 696f 6e27 2c20  e='Regression', 
+00065cf0: 7261 6e64 6f6d 7374 6174 653d 3029 3a0d  randomstate=0):.
+00065d00: 0a20 2020 2022 2222 0d0a 2020 2020 5370  .    """..    Sp
+00065d10: 6c69 7420 796f 7572 2066 696c 6520 6f72  lit your file or
+00065d20: 2064 6174 6120 6672 616d 6520 696e 746f   data frame into
+00065d30: 2032 206f 7220 3320 7370 6c69 7473 2e20   2 or 3 splits. 
+00065d40: 5374 7261 7469 6669 6564 2062 7920 436c  Stratified by Cl
+00065d50: 6173 7320 6175 746f 6d61 7469 6361 6c6c  ass automaticall
+00065d60: 792e 0d0a 2020 2020 4164 6469 7469 6f6e  y...    Addition
+00065d70: 616c 6c79 2c20 6974 2077 696c 6c20 7374  ally, it will st
+00065d80: 7269 7020 6f75 7420 6e6f 6e2d 6e75 6d65  rip out non-nume
+00065d90: 7269 6320 636f 6c73 2069 6e20 796f 7572  ric cols in your
+00065da0: 2064 6174 6120 6966 2079 6f75 206e 6565   data if you nee
+00065db0: 6420 6974 2e0d 0a20 2020 2022 2222 0d0a  d it...    """..
+00065dc0: 2020 2020 7261 6e64 6f6d 7374 6174 6520      randomstate 
+00065dd0: 3d20 3939 0d0a 2020 2020 2323 2323 2323  = 99..    ######
+00065de0: 2320 436f 6465 735f 6c69 7374 2063 6f6e  # Codes_list con
+00065df0: 7461 696e 7320 6d75 6c74 6970 6c65 2065  tains multiple e
+00065e00: 6e63 6f64 6572 7320 7468 6174 2061 7265  ncoders that are
+00065e10: 2075 7365 6420 746f 206f 7065 6e20 6120   used to open a 
+00065e20: 4353 5620 6669 6c65 0d0a 2020 2020 636f  CSV file..    co
+00065e30: 6465 735f 6c69 7374 203d 205b 2775 7466  des_list = ['utf
+00065e40: 2d38 272c 2769 736f 2d38 3835 392d 3127  -8','iso-8859-1'
+00065e50: 2c27 6370 3132 3532 272c 276c 6174 696e  ,'cp1252','latin
+00065e60: 3127 5d0d 0a20 2020 2073 6565 6420 3d20  1']..    seed = 
+00065e70: 3939 0d0a 2020 2020 6966 2074 7970 6528  99..    if type(
+00065e80: 7472 6169 6e66 696c 6529 203d 3d20 7374  trainfile) == st
+00065e90: 723a 0d0a 2020 2020 2020 2020 6966 2074  r:..        if t
+00065ea0: 7261 696e 6669 6c65 2021 3d20 2727 3a0d  rainfile != '':.
+00065eb0: 0a20 2020 2020 2020 2020 2020 2023 2323  .            ###
+00065ec0: 2320 4669 7273 7420 6c6f 6164 2074 6865  # First load the
+00065ed0: 2054 7261 696e 2066 696c 6520 6966 2069   Train file if i
+00065ee0: 7420 6973 2061 7661 696c 6162 6c65 2023  t is available #
+00065ef0: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
+00065f00: 2020 2020 2020 2066 6f72 2063 6f64 6578         for codex
+00065f10: 2069 6e20 636f 6465 735f 6c69 7374 3a0d   in codes_list:.
+00065f20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00065f30: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
+00065f40: 2020 2020 2020 2020 2020 2074 7261 696e             train
+00065f50: 6466 203d 2070 642e 7265 6164 5f63 7376  df = pd.read_csv
+00065f60: 2874 7261 696e 6669 6c65 2c73 6570 3d73  (trainfile,sep=s
+00065f70: 6570 2c65 6e63 6f64 696e 673d 636f 6465  ep,encoding=code
+00065f80: 782c 696e 6465 785f 636f 6c3d 4e6f 6e65  x,index_col=None
+00065f90: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00065fa0: 2020 2020 2020 2062 7265 616b 0d0a 2020         break..  
+00065fb0: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00065fc0: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
+00065fd0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+00065fe0: 6e75 650d 0a20 2020 2020 2020 2020 2020  nue..           
+00065ff0: 2070 7269 6e74 2827 5472 6169 6e20 6461   print('Train da
+00066000: 7461 2067 6976 656e 2e20 5368 6170 6520  ta given. Shape 
+00066010: 3d20 2573 2720 2528 7472 6169 6e64 662e  = %s' %(traindf.
+00066020: 7368 6170 652c 2929 0d0a 2020 2020 2020  shape,))..      
+00066030: 2020 2020 2020 7072 696e 7428 2754 6172        print('Tar
+00066040: 6765 7420 526f 7773 2054 7261 696e 203d  get Rows Train =
+00066050: 2025 6427 2025 6c65 6e28 7472 6169 6e64   %d' %len(traind
+00066060: 665b 7472 6169 6e64 665b 7461 7267 6574  f[traindf[target
+00066070: 5d3d 3d31 5d29 290d 0a20 2020 2020 2020  ]==1]))..       
+00066080: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00066090: 2020 2020 7072 696e 7428 2754 7261 696e      print('Train
+000660a0: 6669 6c65 2069 7320 6e6f 7420 666f 756e  file is not foun
+000660b0: 642e 2043 6865 636b 2079 6f75 7220 696e  d. Check your in
+000660c0: 7075 7420 6f72 2066 696c 6520 6465 7374  put or file dest
+000660d0: 696e 6174 696f 6e27 290d 0a20 2020 2020  ination')..     
+000660e0: 2020 2020 2020 2072 6574 7572 6e0d 0a20         return.. 
+000660f0: 2020 2020 2020 2069 6620 2074 7970 6528         if  type(
+00066100: 7465 7374 6669 6c65 2920 3d3d 2073 7472  testfile) == str
+00066110: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
+00066120: 6620 7465 7374 6669 6c65 2021 3d20 2727  f testfile != ''
+00066130: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00066140: 2020 2070 7269 6e74 2827 5472 6169 6e20     print('Train 
+00066150: 6669 6c65 2061 6e64 2054 6573 7420 6669  file and Test fi
+00066160: 6c65 2067 6976 656e 2e27 290d 0a20 2020  le given.')..   
+00066170: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00066180: 2323 2320 4966 2074 6573 7466 696c 6520  ### If testfile 
+00066190: 6973 2061 7661 696c 6162 6c65 2c20 796f  is available, yo
+000661a0: 7520 6e65 6564 2074 6f20 636f 6d62 696e  u need to combin
+000661b0: 6520 7472 6169 6e20 616e 6420 7465 7374  e train and test
+000661c0: 2064 6174 6173 6574 730d 0a20 2020 2020   datasets..     
+000661d0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+000661e0: 2827 5472 6169 6e20 4461 7461 4672 616d  ('Train DataFram
+000661f0: 6520 616e 6420 5465 7374 6669 6c65 2067  e and Testfile g
+00066200: 6976 656e 2e27 290d 0a20 2020 2020 2020  iven.')..       
+00066210: 2020 2020 2020 2020 2066 6f72 2063 6f64           for cod
+00066220: 6578 2069 6e20 636f 6465 735f 6c69 7374  ex in codes_list
+00066230: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00066240: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+00066250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00066260: 2020 2020 2074 6573 7464 6620 3d20 7064       testdf = pd
+00066270: 2e72 6561 645f 6373 7628 7465 7374 6669  .read_csv(testfi
+00066280: 6c65 2c73 6570 3d73 6570 2c65 6e63 6f64  le,sep=sep,encod
+00066290: 696e 673d 636f 6465 782c 696e 6465 785f  ing=codex,index_
+000662a0: 636f 6c3d 4e6f 6e65 290d 0a20 2020 2020  col=None)..     
 000662b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000662c0: 2020 2020 2020 2020 6272 6561 6b0d 0a20          break.. 
-000662d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000662e0: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
-000662f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00066300: 2020 2020 636f 6e74 696e 7565 0d0a 2020      continue..  
-00066310: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00066320: 696e 7428 2754 6573 7420 6461 7461 2067  int('Test data g
-00066330: 6976 656e 2e20 5368 6170 6520 3d20 2573  iven. Shape = %s
-00066340: 2720 2528 7465 7374 6466 2e73 6861 7065  ' %(testdf.shape
-00066350: 2c29 290d 0a20 2020 2020 2020 2020 2020  ,))..           
-00066360: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00066370: 2020 2020 2020 2020 7072 696e 7428 2754          print('T
-00066380: 6573 7466 696c 6520 6973 206e 6f74 2067  estfile is not g
-00066390: 6976 656e 2e20 436f 6e74 696e 7569 6e67  iven. Continuing
-000663a0: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-000663b0: 2020 2020 7465 7374 6466 203d 2027 270d      testdf = ''.
-000663c0: 0a20 2020 2020 2020 2065 6c69 6620 7479  .        elif ty
-000663d0: 7065 2874 6573 7466 696c 6529 203d 3d20  pe(testfile) == 
-000663e0: 7064 2e44 6174 6146 7261 6d65 3a0d 0a20  pd.DataFrame:.. 
-000663f0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00066400: 2827 5472 6169 6e20 6669 6c65 2061 6e64  ('Train file and
-00066410: 2054 6573 7420 6461 7461 6672 616d 6520   Test dataframe 
-00066420: 6769 7665 6e2e 2729 0d0a 2020 2020 2020  given.')..      
-00066430: 2020 2020 2020 7465 7374 6466 203d 2074        testdf = t
-00066440: 6573 7466 696c 655b 3a5d 0d0a 2020 2020  estfile[:]..    
-00066450: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00066460: 2020 2020 2020 2070 7269 6e74 2827 5465         print('Te
-00066470: 7374 6669 6c65 2069 7320 756e 6b6e 6f77  stfile is unknow
-00066480: 6e20 7479 7065 2e27 290d 0a20 2020 2020  n type.')..     
-00066490: 2020 2020 2020 2074 6573 7464 6620 3d20         testdf = 
-000664a0: 2727 0d0a 2020 2020 656c 6966 2074 7970  ''..    elif typ
-000664b0: 6528 7472 6169 6e66 696c 6529 203d 3d20  e(trainfile) == 
-000664c0: 7064 2e44 6174 6146 7261 6d65 3a0d 0a20  pd.DataFrame:.. 
-000664d0: 2020 2020 2020 2074 7261 696e 6466 203d         traindf =
-000664e0: 2074 7261 696e 6669 6c65 5b3a 5d0d 0a20   trainfile[:].. 
-000664f0: 2020 2020 2020 2069 6620 2074 7970 6528         if  type(
-00066500: 7465 7374 6669 6c65 2920 3d3d 2073 7472  testfile) == str
-00066510: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00066520: 6620 7465 7374 6669 6c65 2021 3d20 2727  f testfile != ''
-00066530: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00066540: 2020 2070 7269 6e74 2827 5472 6169 6e20     print('Train 
-00066550: 4461 7461 4672 616d 6520 616e 6420 5465  DataFrame and Te
-00066560: 7374 2066 696c 6520 6769 7665 6e2e 2729  st file given.')
-00066570: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00066580: 2020 2323 2323 2323 2049 6620 7465 7374    ###### If test
-00066590: 6669 6c65 2069 7320 6176 6169 6c61 626c  file is availabl
-000665a0: 652c 2079 6f75 206e 6565 6420 746f 2063  e, you need to c
-000665b0: 6f6d 6269 6e65 2074 7261 696e 2061 6e64  ombine train and
-000665c0: 2074 6573 7420 6461 7461 7365 7473 0d0a   test datasets..
-000665d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000665e0: 7072 696e 7428 2754 7261 696e 2044 6174  print('Train Dat
-000665f0: 6146 7261 6d65 2061 6e64 2054 6573 7466  aFrame and Testf
-00066600: 696c 6520 6769 7665 6e2e 2729 0d0a 2020  ile given.')..  
-00066610: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00066620: 7220 636f 6465 7820 696e 2063 6f64 6573  r codex in codes
-00066630: 5f6c 6973 743a 0d0a 2020 2020 2020 2020  _list:..        
-00066640: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-00066650: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00066660: 2020 2020 2020 2020 2020 7465 7374 6466            testdf
-00066670: 203d 2070 642e 7265 6164 5f63 7376 2874   = pd.read_csv(t
-00066680: 6573 7466 696c 652c 7365 703d 7365 702c  estfile,sep=sep,
-00066690: 656e 636f 6469 6e67 3d63 6f64 6578 2c69  encoding=codex,i
-000666a0: 6e64 6578 5f63 6f6c 3d4e 6f6e 6529 0d0a  ndex_col=None)..
+000662c0: 2020 2062 7265 616b 0d0a 2020 2020 2020     break..      
+000662d0: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+000662e0: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
+000662f0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00066300: 6f6e 7469 6e75 650d 0a20 2020 2020 2020  ontinue..       
+00066310: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00066320: 5465 7374 2064 6174 6120 6769 7665 6e2e  Test data given.
+00066330: 2053 6861 7065 203d 2025 7327 2025 2874   Shape = %s' %(t
+00066340: 6573 7464 662e 7368 6170 652c 2929 0d0a  estdf.shape,))..
+00066350: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00066360: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00066370: 2020 2070 7269 6e74 2827 5465 7374 6669     print('Testfi
+00066380: 6c65 2069 7320 6e6f 7420 6769 7665 6e2e  le is not given.
+00066390: 2043 6f6e 7469 6e75 696e 6727 290d 0a20   Continuing').. 
+000663a0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+000663b0: 6573 7464 6620 3d20 2727 0d0a 2020 2020  estdf = ''..    
+000663c0: 2020 2020 656c 6966 2074 7970 6528 7465      elif type(te
+000663d0: 7374 6669 6c65 2920 3d3d 2070 642e 4461  stfile) == pd.Da
+000663e0: 7461 4672 616d 653a 0d0a 2020 2020 2020  taFrame:..      
+000663f0: 2020 2020 2020 7072 696e 7428 2754 7261        print('Tra
+00066400: 696e 2066 696c 6520 616e 6420 5465 7374  in file and Test
+00066410: 2064 6174 6166 7261 6d65 2067 6976 656e   dataframe given
+00066420: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
+00066430: 2074 6573 7464 6620 3d20 7465 7374 6669   testdf = testfi
+00066440: 6c65 5b3a 5d0d 0a20 2020 2020 2020 2065  le[:]..        e
+00066450: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00066460: 2020 7072 696e 7428 2754 6573 7466 696c    print('Testfil
+00066470: 6520 6973 2075 6e6b 6e6f 776e 2074 7970  e is unknown typ
+00066480: 652e 2729 0d0a 2020 2020 2020 2020 2020  e.')..          
+00066490: 2020 7465 7374 6466 203d 2027 270d 0a20    testdf = ''.. 
+000664a0: 2020 2065 6c69 6620 7479 7065 2874 7261     elif type(tra
+000664b0: 696e 6669 6c65 2920 3d3d 2070 642e 4461  infile) == pd.Da
+000664c0: 7461 4672 616d 653a 0d0a 2020 2020 2020  taFrame:..      
+000664d0: 2020 7472 6169 6e64 6620 3d20 7472 6169    traindf = trai
+000664e0: 6e66 696c 655b 3a5d 0d0a 2020 2020 2020  nfile[:]..      
+000664f0: 2020 6966 2020 7479 7065 2874 6573 7466    if  type(testf
+00066500: 696c 6529 203d 3d20 7374 723a 0d0a 2020  ile) == str:..  
+00066510: 2020 2020 2020 2020 2020 6966 2074 6573            if tes
+00066520: 7466 696c 6520 213d 2027 273a 0d0a 2020  tfile != '':..  
+00066530: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00066540: 696e 7428 2754 7261 696e 2044 6174 6146  int('Train DataF
+00066550: 7261 6d65 2061 6e64 2054 6573 7420 6669  rame and Test fi
+00066560: 6c65 2067 6976 656e 2e27 290d 0a20 2020  le given.')..   
+00066570: 2020 2020 2020 2020 2020 2020 2023 2323               ###
+00066580: 2323 2320 4966 2074 6573 7466 696c 6520  ### If testfile 
+00066590: 6973 2061 7661 696c 6162 6c65 2c20 796f  is available, yo
+000665a0: 7520 6e65 6564 2074 6f20 636f 6d62 696e  u need to combin
+000665b0: 6520 7472 6169 6e20 616e 6420 7465 7374  e train and test
+000665c0: 2064 6174 6173 6574 730d 0a20 2020 2020   datasets..     
+000665d0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+000665e0: 2827 5472 6169 6e20 4461 7461 4672 616d  ('Train DataFram
+000665f0: 6520 616e 6420 5465 7374 6669 6c65 2067  e and Testfile g
+00066600: 6976 656e 2e27 290d 0a20 2020 2020 2020  iven.')..       
+00066610: 2020 2020 2020 2020 2066 6f72 2063 6f64           for cod
+00066620: 6578 2069 6e20 636f 6465 735f 6c69 7374  ex in codes_list
+00066630: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00066640: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+00066650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00066660: 2020 2020 2074 6573 7464 6620 3d20 7064       testdf = pd
+00066670: 2e72 6561 645f 6373 7628 7465 7374 6669  .read_csv(testfi
+00066680: 6c65 2c73 6570 3d73 6570 2c65 6e63 6f64  le,sep=sep,encod
+00066690: 696e 673d 636f 6465 782c 696e 6465 785f  ing=codex,index_
+000666a0: 636f 6c3d 4e6f 6e65 290d 0a20 2020 2020  col=None)..     
 000666b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000666c0: 2020 2020 2020 2020 6272 6561 6b0d 0a20          break.. 
-000666d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000666e0: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
-000666f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00066700: 2020 2020 636f 6e74 696e 7565 0d0a 2020      continue..  
-00066710: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00066720: 696e 7428 2754 7261 696e 2053 6861 7065  int('Train Shape
-00066730: 3a25 7320 5465 7374 2053 6861 7065 3a20  :%s Test Shape: 
-00066740: 2573 2720 2528 7472 6169 6e64 662e 7368  %s' %(traindf.sh
-00066750: 6170 652c 7465 7374 6466 2e73 6861 7065  ape,testdf.shape
-00066760: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-00066770: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00066780: 2020 2020 2020 2070 7269 6e74 2827 4e6f         print('No
-00066790: 2074 6573 7466 696c 652e 2054 7261 696e   testfile. Train
-000667a0: 2053 6861 7065 3a25 7327 2025 2874 7261   Shape:%s' %(tra
-000667b0: 696e 6466 2e73 6861 7065 2c29 290d 0a20  indf.shape,)).. 
-000667c0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-000667d0: 6573 7464 6620 3d20 2727 0d0a 2020 2020  estdf = ''..    
-000667e0: 2020 2020 656c 6966 2074 7970 6528 7465      elif type(te
-000667f0: 7374 6669 6c65 2920 3d3d 2070 642e 4461  stfile) == pd.Da
-00066800: 7461 4672 616d 653a 0d0a 2020 2020 2020  taFrame:..      
-00066810: 2020 2020 2020 7072 696e 7428 2754 7261        print('Tra
-00066820: 696e 2044 6174 6146 7261 6d65 2061 6e64  in DataFrame and
-00066830: 2054 6573 7420 4461 7461 4672 616d 6520   Test DataFrame 
-00066840: 6769 7665 6e2e 2729 0d0a 2020 2020 2020  given.')..      
-00066850: 2020 2020 2020 7465 7374 6466 203d 2074        testdf = t
-00066860: 6573 7466 696c 655b 3a5d 0d0a 2020 2020  estfile[:]..    
-00066870: 656c 7365 3a0d 0a20 2020 2020 2020 2070  else:..        p
-00066880: 7269 6e74 2827 4e6f 2054 7261 696e 206f  rint('No Train o
-00066890: 7220 5465 7374 2066 696c 6520 7072 6f76  r Test file prov
-000668a0: 6964 6564 2e20 456e 642e 2e2e 2729 0d0a  ided. End...')..
-000668b0: 2020 2020 2020 2020 7265 7475 726e 0d0a          return..
-000668c0: 2020 2020 2323 2323 2323 2323 2054 6869      ######## Thi
-000668d0: 7320 6973 2077 6865 7265 2074 6865 2073  s is where the s
-000668e0: 706c 6974 7469 6e67 2062 6567 696e 7320  plitting begins 
-000668f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00066900: 230d 0a20 2020 2069 6620 7461 7267 6574  #..    if target
-00066910: 203d 3d20 2727 3a0d 0a20 2020 2020 2020   == '':..       
-00066920: 2070 7269 6e74 2827 4e6f 2074 6172 6765   print('No targe
-00066930: 7420 7661 7269 6162 6c65 2070 726f 7669  t variable provi
-00066940: 6465 642e 2050 6c65 6173 6520 7072 6f76  ded. Please prov
-00066950: 6964 6520 7461 7267 6574 2076 6172 6961  ide target varia
-00066960: 626c 6527 290d 0a20 2020 2020 2020 2072  ble')..        r
-00066970: 6574 7572 6e20 7472 6169 6e64 662c 204e  eturn traindf, N
-00066980: 6f6e 652c 204e 6f6e 650d 0a20 2020 2065  one, None..    e
-00066990: 6c73 653a 0d0a 2020 2020 2020 2020 7920  lse:..        y 
-000669a0: 3d20 7472 6169 6e64 665b 7461 7267 6574  = traindf[target
-000669b0: 5d0d 0a20 2020 2069 6620 6d6f 6465 6c74  ]..    if modelt
-000669c0: 7970 6520 3d3d 2027 436c 6173 7369 6669  ype == 'Classifi
-000669d0: 6361 7469 6f6e 273a 0d0a 2020 2020 2020  cation':..      
-000669e0: 2020 6966 2074 7261 696e 6466 2e73 6861    if traindf.sha
-000669f0: 7065 5b30 5d20 3c3d 2031 3030 303a 0d0a  pe[0] <= 1000:..
-00066a00: 2020 2020 2020 2020 2020 2020 7373 7320              sss 
-00066a10: 3d20 5374 7261 7469 6669 6564 5368 7566  = StratifiedShuf
-00066a20: 666c 6553 706c 6974 286e 5f73 706c 6974  fleSplit(n_split
-00066a30: 733d 322c 2074 6573 745f 7369 7a65 3d30  s=2, test_size=0
-00066a40: 2e33 302c 2072 616e 646f 6d5f 7374 6174  .30, random_stat
-00066a50: 653d 7261 6e64 6f6d 7374 6174 6529 0d0a  e=randomstate)..
-00066a60: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00066a70: 2020 2020 2020 2020 2020 2073 7373 203d             sss =
-00066a80: 2053 7472 6174 6966 6965 6453 6875 6666   StratifiedShuff
-00066a90: 6c65 5370 6c69 7428 6e5f 7370 6c69 7473  leSplit(n_splits
-00066aa0: 3d32 2c20 7465 7374 5f73 697a 653d 302e  =2, test_size=0.
-00066ab0: 3230 2c20 7261 6e64 6f6d 5f73 7461 7465  20, random_state
-00066ac0: 3d72 616e 646f 6d73 7461 7465 290d 0a20  =randomstate).. 
-00066ad0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00066ae0: 2020 696e 6469 6365 7320 3d20 6e70 2e72    indices = np.r
-00066af0: 616e 646f 6d2e 7065 726d 7574 6174 696f  andom.permutatio
-00066b00: 6e28 7472 6169 6e64 662e 7368 6170 655b  n(traindf.shape[
-00066b10: 305d 290d 0a20 2020 2020 2020 2074 7261  0])..        tra
-00066b20: 696e 5f72 6f77 7320 3d20 696e 7428 302e  in_rows = int(0.
-00066b30: 382a 7472 6169 6e64 662e 7368 6170 655b  8*traindf.shape[
-00066b40: 305d 290d 0a20 2020 2070 7265 6469 6374  0])..    predict
-00066b50: 6f72 7320 3d20 5b78 2066 6f72 2078 2069  ors = [x for x i
-00066b60: 6e20 7472 6169 6e64 6620 6966 2078 206e  n traindf if x n
-00066b70: 6f74 2069 6e20 7461 7267 6574 5d0d 0a20  ot in target].. 
-00066b80: 2020 2023 2323 2323 2073 656c 6563 7420     ##### select 
-00066b90: 6f6e 6c79 2073 7472 696e 6720 636f 6c75  only string colu
-00066ba0: 6d6e 7320 6672 6f6d 2074 6865 2074 7261  mns from the tra
-00066bb0: 696e 2064 6174 610d 0a20 2020 2063 6f6c  in data..    col
-00066bc0: 7320 3d20 636f 7079 2e64 6565 7063 6f70  s = copy.deepcop
-00066bd0: 7928 7072 6564 6963 746f 7273 290d 0a20  y(predictors).. 
-00066be0: 2020 2023 636f 6c73 203d 2073 656c 6563     #cols = selec
-00066bf0: 745f 6e75 6d5f 636f 6c75 6d6e 7328 7472  t_num_columns(tr
-00066c00: 6169 6e64 665b 7072 6564 6963 746f 7273  aindf[predictors
-00066c10: 5d29 2e63 6f6c 756d 6e73 2e74 6f6c 6973  ]).columns.tolis
-00066c20: 7428 290d 0a20 2020 2074 7261 696e 6466  t()..    traindf
-00066c30: 203d 2074 7261 696e 6466 5b63 6f6c 732b   = traindf[cols+
-00066c40: 5b74 6172 6765 745d 5d0d 0a20 2020 2058  [target]]..    X
-00066c50: 203d 2074 7261 696e 6466 5b63 6f6c 735d   = traindf[cols]
-00066c60: 0d0a 2020 2020 6966 2074 7970 6528 7465  ..    if type(te
-00066c70: 7374 6466 2920 3d3d 2073 7472 3a0d 0a20  stdf) == str:.. 
-00066c80: 2020 2020 2020 2023 2323 2320 4966 206e         #### If n
-00066c90: 6f20 7465 7374 2044 6174 6146 7261 6d65  o test DataFrame
-00066ca0: 2069 7320 6769 7665 6e2c 2074 6865 6e20   is given, then 
-00066cb0: 7370 6c69 7420 7468 6520 7472 6169 6e20  split the train 
-00066cc0: 6461 7461 2069 6e74 6f20 7472 6169 6e2c  data into train,
-00066cd0: 2063 7620 616e 6420 7465 7374 2064 6174   cv and test dat
-00066ce0: 6120 2323 2323 2323 230d 0a20 2020 2020  a #######..     
-00066cf0: 2020 2069 6620 6d6f 6465 6c74 7970 6520     if modeltype 
-00066d00: 3d3d 2027 436c 6173 7369 6669 6361 7469  == 'Classificati
-00066d10: 6f6e 273a 0d0a 2020 2020 2020 2020 2020  on':..          
-00066d20: 2020 7472 6169 6e69 6e64 6578 2c20 7465    trainindex, te
-00066d30: 7374 696e 6465 7820 3d20 7373 732e 7370  stindex = sss.sp
-00066d40: 6c69 7428 582c 2079 290d 0a20 2020 2020  lit(X, y)..     
-00066d50: 2020 2020 2020 2074 7261 6461 7461 203d         tradata =
-00066d60: 2074 7261 696e 6466 2e69 6c6f 635b 7472   traindf.iloc[tr
-00066d70: 6169 6e69 6e64 6578 5b30 5d5d 0d0a 2020  ainindex[0]]..  
-00066d80: 2020 2020 2020 2020 2020 7473 6461 7461            tsdata
-00066d90: 203d 2074 7261 696e 6466 2e69 6c6f 635b   = traindf.iloc[
-00066da0: 7472 6169 6e69 6e64 6578 5b31 5d5d 0d0a  trainindex[1]]..
-00066db0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00066dc0: 2020 2020 2020 2020 2020 2074 7261 696e             train
-00066dd0: 696e 675f 6964 782c 2074 6573 745f 6964  ing_idx, test_id
-00066de0: 7820 3d20 696e 6469 6365 735b 3a74 7261  x = indices[:tra
-00066df0: 696e 5f72 6f77 735d 2c20 696e 6469 6365  in_rows], indice
-00066e00: 735b 7472 6169 6e5f 726f 7773 3a5d 0d0a  s[train_rows:]..
-00066e10: 2020 2020 2020 2020 2020 2020 7472 6164              trad
-00066e20: 6174 612c 2074 7364 6174 6120 3d20 7472  ata, tsdata = tr
-00066e30: 6169 6e64 662e 696c 6f63 5b74 7261 696e  aindf.iloc[train
-00066e40: 696e 675f 6964 785d 2c20 7472 6169 6e64  ing_idx], traind
-00066e50: 662e 696c 6f63 5b74 6573 745f 6964 785d  f.iloc[test_idx]
-00066e60: 0d0a 2020 2020 2020 2020 2323 2323 2323  ..        ######
-00066e70: 2323 2323 2323 2323 2323 2323 2323 2320  ############### 
-00066e80: 2020 2043 524f 5353 2056 414c 4944 4154     CROSS VALIDAT
-00066e90: 494f 4e20 504f 5254 494f 4e20 2023 2323  ION PORTION  ###
-00066ea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00066eb0: 2323 2323 0d0a 2020 2020 2020 2020 5820  ####..        X 
-00066ec0: 3d20 7473 6461 7461 5b63 6f6c 735d 0d0a  = tsdata[cols]..
-00066ed0: 2020 2020 2020 2020 7920 3d20 7473 6461          y = tsda
-00066ee0: 7461 5b74 6172 6765 745d 0d0a 2020 2020  ta[target]..    
-00066ef0: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
-00066f00: 203d 3d20 2743 6c61 7373 6966 6963 6174   == 'Classificat
-00066f10: 696f 6e27 3a0d 0a20 2020 2020 2020 2020  ion':..         
-00066f20: 2020 2073 7373 203d 2053 7472 6174 6966     sss = Stratif
-00066f30: 6965 6453 6875 6666 6c65 5370 6c69 7428  iedShuffleSplit(
-00066f40: 6e5f 7370 6c69 7473 3d32 2c20 7465 7374  n_splits=2, test
-00066f50: 5f73 697a 653d 302e 3430 2c20 7261 6e64  _size=0.40, rand
-00066f60: 6f6d 5f73 7461 7465 3d72 616e 646f 6d73  om_state=randoms
-00066f70: 7461 7465 290d 0a20 2020 2020 2020 2020  tate)..         
-00066f80: 2020 2063 7669 6e64 6578 2c20 7473 5f69     cvindex, ts_i
-00066f90: 6e64 6578 203d 2073 7373 2e73 706c 6974  ndex = sss.split
-00066fa0: 2858 2c20 7929 0d0a 2020 2020 2020 2020  (X, y)..        
-00066fb0: 2020 2020 6376 6461 7461 203d 2074 7364      cvdata = tsd
-00066fc0: 6174 612e 696c 6f63 5b63 7669 6e64 6578  ata.iloc[cvindex
-00066fd0: 5b30 5d5d 0d0a 2020 2020 2020 2020 2020  [0]]..          
-00066fe0: 2020 7473 6461 7461 203d 2074 7364 6174    tsdata = tsdat
-00066ff0: 612e 696c 6f63 5b63 7669 6e64 6578 5b31  a.iloc[cvindex[1
-00067000: 5d5d 0d0a 2020 2020 2020 2020 656c 7365  ]]..        else
-00067010: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00067020: 6e64 6963 6573 203d 206e 702e 7261 6e64  ndices = np.rand
-00067030: 6f6d 2e70 6572 6d75 7461 7469 6f6e 2874  om.permutation(t
-00067040: 7364 6174 612e 7368 6170 655b 305d 290d  sdata.shape[0]).
-00067050: 0a20 2020 2020 2020 2020 2020 2074 7261  .            tra
-00067060: 696e 5f72 6f77 7320 3d20 696e 7428 302e  in_rows = int(0.
-00067070: 342a 7473 6461 7461 2e73 6861 7065 5b30  4*tsdata.shape[0
-00067080: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00067090: 7472 6169 6e69 6e67 5f69 6478 2c20 7465  training_idx, te
-000670a0: 7374 5f69 6478 203d 2069 6e64 6963 6573  st_idx = indices
-000670b0: 5b3a 7472 6169 6e5f 726f 7773 5d2c 2069  [:train_rows], i
-000670c0: 6e64 6963 6573 5b74 7261 696e 5f72 6f77  ndices[train_row
-000670d0: 733a 5d0d 0a20 2020 2020 2020 2020 2020  s:]..           
-000670e0: 2063 7664 6174 612c 2074 7364 6174 6120   cvdata, tsdata 
-000670f0: 3d20 7473 6461 7461 2e69 6c6f 635b 7472  = tsdata.iloc[tr
-00067100: 6169 6e69 6e67 5f69 6478 5d2c 2074 7364  aining_idx], tsd
-00067110: 6174 612e 696c 6f63 5b74 6573 745f 6964  ata.iloc[test_id
-00067120: 785d 0d0a 2020 2020 2020 2020 7265 7475  x]..        retu
-00067130: 726e 2074 7261 6461 7461 2c20 6376 6461  rn tradata, cvda
-00067140: 7461 2c20 7473 6461 7461 2c20 636f 6c73  ta, tsdata, cols
-00067150: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
-00067160: 2020 2020 2023 2323 2323 2323 2049 6620       ####### If 
-00067170: 5465 7374 2044 6174 6146 7261 6d65 2069  Test DataFrame i
-00067180: 7320 6769 7665 6e20 7468 656e 206b 6565  s given then kee
-00067190: 7020 7468 6174 2061 7320 7473 6461 7461  p that as tsdata
-000671a0: 2023 2323 2323 2323 230d 0a20 2020 2020   ########..     
-000671b0: 2020 2069 6620 6d6f 6465 6c74 7970 6520     if modeltype 
-000671c0: 3d3d 2027 436c 6173 7369 6669 6361 7469  == 'Classificati
-000671d0: 6f6e 273a 0d0a 2020 2020 2020 2020 2020  on':..          
-000671e0: 2020 7472 6169 6e69 6e64 6578 2c20 7465    trainindex, te
-000671f0: 7374 696e 6465 7820 3d20 7373 732e 7370  stindex = sss.sp
-00067200: 6c69 7428 582c 2079 290d 0a20 2020 2020  lit(X, y)..     
-00067210: 2020 2020 2020 2074 7261 6461 7461 203d         tradata =
-00067220: 2074 7261 696e 6466 2e69 6c6f 635b 7472   traindf.iloc[tr
-00067230: 6169 6e69 6e64 6578 5b30 5d5d 0d0a 2020  ainindex[0]]..  
-00067240: 2020 2020 2020 2020 2020 6376 6461 7461            cvdata
-00067250: 203d 2074 7261 696e 6466 2e69 6c6f 635b   = traindf.iloc[
-00067260: 7472 6169 6e69 6e64 6578 5b31 5d5d 0d0a  trainindex[1]]..
-00067270: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-00067280: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00067290: 2020 6966 206c 656e 2874 6573 7464 665b    if len(testdf[
-000672a0: 7461 7267 6574 5d2e 7661 6c75 655f 636f  target].value_co
-000672b0: 756e 7473 2829 203e 3d20 3229 3a0d 0a20  unts() >= 2):.. 
-000672c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000672d0: 2020 2070 7269 6e74 2827 2020 2020 4e75     print('    Nu
-000672e0: 6d62 6572 206f 6620 5461 7267 6574 2052  mber of Target R
-000672f0: 6f77 7320 696e 2054 6573 7420 4461 7461  ows in Test Data
-00067300: 3a20 2564 2720 256c 656e 2874 6573 7464  : %d' %len(testd
-00067310: 665b 7465 7374 6466 5b74 6172 6765 745d  f[testdf[target]
-00067320: 3d3d 315d 2929 0d0a 2020 2020 2020 2020  ==1]))..        
-00067330: 2020 2020 2020 2020 2020 2020 7473 6461              tsda
-00067340: 7461 203d 2074 6573 7464 665b 3a5d 0d0a  ta = testdf[:]..
-00067350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00067360: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00067370: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00067380: 2827 2020 2020 5465 7374 2064 6174 6120  ('    Test data 
-00067390: 6861 7320 7369 6e67 6c65 2063 6c61 7373  has single class
-000673a0: 2e20 4f76 6572 7772 6974 696e 6720 7072  . Overwriting pr
-000673b0: 6564 6963 7469 6f6e 7320 6f6e 2054 6573  edictions on Tes
-000673c0: 7420 5461 7267 6574 2063 6f6c 756d 6e2e  t Target column.
-000673d0: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-000673e0: 2020 2020 2020 2020 7072 6564 6963 746f          predicto
-000673f0: 7273 203d 205b 7820 666f 7220 7820 696e  rs = [x for x in
-00067400: 206c 6973 7428 7472 6169 6e64 6629 2069   list(traindf) i
-00067410: 6620 7820 6e6f 7420 696e 2074 6172 6765  f x not in targe
-00067420: 745d 0d0a 2020 2020 2020 2020 2020 2020  t]..            
-00067430: 2020 2020 2020 2020 7473 6461 7461 203d          tsdata =
-00067440: 2074 6573 7464 665b 3a5d 0d0a 2020 2020   testdf[:]..    
-00067450: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
-00067460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00067470: 2070 7269 6e74 2827 2020 2020 4e6f 2054   print('    No T
-00067480: 6172 6765 7420 636f 6c75 6d6e 2069 6e20  arget column in 
-00067490: 5465 7374 2064 6174 6127 290d 0a20 2020  Test data')..   
-000674a0: 2020 2020 2020 2020 2020 2020 2074 6573               tes
-000674b0: 7464 665b 7461 7267 6574 5d20 3d20 300d  tdf[target] = 0.
-000674c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000674d0: 2074 7364 6174 6120 3d20 7465 7374 6466   tsdata = testdf
-000674e0: 5b63 6f6c 732b 5b74 6172 6765 745d 5d0d  [cols+[target]].
-000674f0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00067500: 2020 2020 2020 2020 2020 2020 696e 6469              indi
-00067510: 6365 7320 3d20 6e70 2e72 616e 646f 6d2e  ces = np.random.
-00067520: 7065 726d 7574 6174 696f 6e28 7472 6169  permutation(trai
-00067530: 6e64 662e 7368 6170 655b 305d 290d 0a20  ndf.shape[0]).. 
-00067540: 2020 2020 2020 2020 2020 2074 7261 696e             train
-00067550: 5f72 6f77 7320 3d20 696e 7428 302e 382a  _rows = int(0.8*
-00067560: 7472 6169 6e64 662e 7368 6170 655b 305d  traindf.shape[0]
-00067570: 290d 0a20 2020 2020 2020 2020 2020 2074  )..            t
-00067580: 7261 696e 696e 675f 6964 782c 2074 6573  raining_idx, tes
-00067590: 745f 6964 7820 3d20 696e 6469 6365 735b  t_idx = indices[
-000675a0: 3a74 7261 696e 5f72 6f77 735d 2c20 696e  :train_rows], in
-000675b0: 6469 6365 735b 7472 6169 6e5f 726f 7773  dices[train_rows
-000675c0: 3a5d 0d0a 2020 2020 2020 2020 2020 2020  :]..            
-000675d0: 7472 6164 6174 612c 2063 7664 6174 6120  tradata, cvdata 
-000675e0: 3d20 7472 6169 6e64 662e 696c 6f63 5b74  = traindf.iloc[t
-000675f0: 7261 696e 696e 675f 6964 785d 2c20 7472  raining_idx], tr
-00067600: 6169 6e64 662e 696c 6f63 5b74 6573 745f  aindf.iloc[test_
-00067610: 6964 785d 0d0a 2020 2020 2020 2020 2020  idx]..          
-00067620: 2020 7473 6461 7461 203d 2074 6573 7464    tsdata = testd
-00067630: 665b 3a5d 0d0a 2020 2020 2020 2020 7265  f[:]..        re
-00067640: 7475 726e 2074 7261 6461 7461 2c20 6376  turn tradata, cv
-00067650: 6461 7461 2c20 7473 6461 7461 2c20 636f  data, tsdata, co
-00067660: 6c73 0d0a 2323 2323 2323 2323 2323 2323  ls..############
+000666c0: 2020 2062 7265 616b 0d0a 2020 2020 2020     break..      
+000666d0: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+000666e0: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
+000666f0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00066700: 6f6e 7469 6e75 650d 0a20 2020 2020 2020  ontinue..       
+00066710: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00066720: 5472 6169 6e20 5368 6170 653a 2573 2054  Train Shape:%s T
+00066730: 6573 7420 5368 6170 653a 2025 7327 2025  est Shape: %s' %
+00066740: 2874 7261 696e 6466 2e73 6861 7065 2c74  (traindf.shape,t
+00066750: 6573 7464 662e 7368 6170 6529 290d 0a20  estdf.shape)).. 
+00066760: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00066770: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00066780: 2020 7072 696e 7428 274e 6f20 7465 7374    print('No test
+00066790: 6669 6c65 2e20 5472 6169 6e20 5368 6170  file. Train Shap
+000667a0: 653a 2573 2720 2528 7472 6169 6e64 662e  e:%s' %(traindf.
+000667b0: 7368 6170 652c 2929 0d0a 2020 2020 2020  shape,))..      
+000667c0: 2020 2020 2020 2020 2020 7465 7374 6466            testdf
+000667d0: 203d 2027 270d 0a20 2020 2020 2020 2065   = ''..        e
+000667e0: 6c69 6620 7479 7065 2874 6573 7466 696c  lif type(testfil
+000667f0: 6529 203d 3d20 7064 2e44 6174 6146 7261  e) == pd.DataFra
+00066800: 6d65 3a0d 0a20 2020 2020 2020 2020 2020  me:..           
+00066810: 2070 7269 6e74 2827 5472 6169 6e20 4461   print('Train Da
+00066820: 7461 4672 616d 6520 616e 6420 5465 7374  taFrame and Test
+00066830: 2044 6174 6146 7261 6d65 2067 6976 656e   DataFrame given
+00066840: 2e27 290d 0a20 2020 2020 2020 2020 2020  .')..           
+00066850: 2074 6573 7464 6620 3d20 7465 7374 6669   testdf = testfi
+00066860: 6c65 5b3a 5d0d 0a20 2020 2065 6c73 653a  le[:]..    else:
+00066870: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+00066880: 274e 6f20 5472 6169 6e20 6f72 2054 6573  'No Train or Tes
+00066890: 7420 6669 6c65 2070 726f 7669 6465 642e  t file provided.
+000668a0: 2045 6e64 2e2e 2e27 290d 0a20 2020 2020   End...')..     
+000668b0: 2020 2072 6574 7572 6e0d 0a20 2020 2023     return..    #
+000668c0: 2323 2323 2323 2320 5468 6973 2069 7320  ####### This is 
+000668d0: 7768 6572 6520 7468 6520 7370 6c69 7474  where the splitt
+000668e0: 696e 6720 6265 6769 6e73 2023 2323 2323  ing begins #####
+000668f0: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
+00066900: 2020 6966 2074 6172 6765 7420 3d3d 2027    if target == '
+00066910: 273a 0d0a 2020 2020 2020 2020 7072 696e  ':..        prin
+00066920: 7428 274e 6f20 7461 7267 6574 2076 6172  t('No target var
+00066930: 6961 626c 6520 7072 6f76 6964 6564 2e20  iable provided. 
+00066940: 506c 6561 7365 2070 726f 7669 6465 2074  Please provide t
+00066950: 6172 6765 7420 7661 7269 6162 6c65 2729  arget variable')
+00066960: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00066970: 2074 7261 696e 6466 2c20 4e6f 6e65 2c20   traindf, None, 
+00066980: 4e6f 6e65 0d0a 2020 2020 656c 7365 3a0d  None..    else:.
+00066990: 0a20 2020 2020 2020 2079 203d 2074 7261  .        y = tra
+000669a0: 696e 6466 5b74 6172 6765 745d 0d0a 2020  indf[target]..  
+000669b0: 2020 6966 206d 6f64 656c 7479 7065 203d    if modeltype =
+000669c0: 3d20 2743 6c61 7373 6966 6963 6174 696f  = 'Classificatio
+000669d0: 6e27 3a0d 0a20 2020 2020 2020 2069 6620  n':..        if 
+000669e0: 7472 6169 6e64 662e 7368 6170 655b 305d  traindf.shape[0]
+000669f0: 203c 3d20 3130 3030 3a0d 0a20 2020 2020   <= 1000:..     
+00066a00: 2020 2020 2020 2073 7373 203d 2053 7472         sss = Str
+00066a10: 6174 6966 6965 6453 6875 6666 6c65 5370  atifiedShuffleSp
+00066a20: 6c69 7428 6e5f 7370 6c69 7473 3d32 2c20  lit(n_splits=2, 
+00066a30: 7465 7374 5f73 697a 653d 302e 3330 2c20  test_size=0.30, 
+00066a40: 7261 6e64 6f6d 5f73 7461 7465 3d72 616e  random_state=ran
+00066a50: 646f 6d73 7461 7465 290d 0a20 2020 2020  domstate)..     
+00066a60: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00066a70: 2020 2020 2020 7373 7320 3d20 5374 7261        sss = Stra
+00066a80: 7469 6669 6564 5368 7566 666c 6553 706c  tifiedShuffleSpl
+00066a90: 6974 286e 5f73 706c 6974 733d 322c 2074  it(n_splits=2, t
+00066aa0: 6573 745f 7369 7a65 3d30 2e32 302c 2072  est_size=0.20, r
+00066ab0: 616e 646f 6d5f 7374 6174 653d 7261 6e64  andom_state=rand
+00066ac0: 6f6d 7374 6174 6529 0d0a 2020 2020 656c  omstate)..    el
+00066ad0: 7365 3a0d 0a20 2020 2020 2020 2069 6e64  se:..        ind
+00066ae0: 6963 6573 203d 206e 702e 7261 6e64 6f6d  ices = np.random
+00066af0: 2e70 6572 6d75 7461 7469 6f6e 2874 7261  .permutation(tra
+00066b00: 696e 6466 2e73 6861 7065 5b30 5d29 0d0a  indf.shape[0])..
+00066b10: 2020 2020 2020 2020 7472 6169 6e5f 726f          train_ro
+00066b20: 7773 203d 2069 6e74 2830 2e38 2a74 7261  ws = int(0.8*tra
+00066b30: 696e 6466 2e73 6861 7065 5b30 5d29 0d0a  indf.shape[0])..
+00066b40: 2020 2020 7072 6564 6963 746f 7273 203d      predictors =
+00066b50: 205b 7820 666f 7220 7820 696e 2074 7261   [x for x in tra
+00066b60: 696e 6466 2069 6620 7820 6e6f 7420 696e  indf if x not in
+00066b70: 2074 6172 6765 745d 0d0a 2020 2020 2323   target]..    ##
+00066b80: 2323 2320 7365 6c65 6374 206f 6e6c 7920  ### select only 
+00066b90: 7374 7269 6e67 2063 6f6c 756d 6e73 2066  string columns f
+00066ba0: 726f 6d20 7468 6520 7472 6169 6e20 6461  rom the train da
+00066bb0: 7461 0d0a 2020 2020 636f 6c73 203d 2063  ta..    cols = c
+00066bc0: 6f70 792e 6465 6570 636f 7079 2870 7265  opy.deepcopy(pre
+00066bd0: 6469 6374 6f72 7329 0d0a 2020 2020 2363  dictors)..    #c
+00066be0: 6f6c 7320 3d20 7365 6c65 6374 5f6e 756d  ols = select_num
+00066bf0: 5f63 6f6c 756d 6e73 2874 7261 696e 6466  _columns(traindf
+00066c00: 5b70 7265 6469 6374 6f72 735d 292e 636f  [predictors]).co
+00066c10: 6c75 6d6e 732e 746f 6c69 7374 2829 0d0a  lumns.tolist()..
+00066c20: 2020 2020 7472 6169 6e64 6620 3d20 7472      traindf = tr
+00066c30: 6169 6e64 665b 636f 6c73 2b5b 7461 7267  aindf[cols+[targ
+00066c40: 6574 5d5d 0d0a 2020 2020 5820 3d20 7472  et]]..    X = tr
+00066c50: 6169 6e64 665b 636f 6c73 5d0d 0a20 2020  aindf[cols]..   
+00066c60: 2069 6620 7479 7065 2874 6573 7464 6629   if type(testdf)
+00066c70: 203d 3d20 7374 723a 0d0a 2020 2020 2020   == str:..      
+00066c80: 2020 2323 2323 2049 6620 6e6f 2074 6573    #### If no tes
+00066c90: 7420 4461 7461 4672 616d 6520 6973 2067  t DataFrame is g
+00066ca0: 6976 656e 2c20 7468 656e 2073 706c 6974  iven, then split
+00066cb0: 2074 6865 2074 7261 696e 2064 6174 6120   the train data 
+00066cc0: 696e 746f 2074 7261 696e 2c20 6376 2061  into train, cv a
+00066cd0: 6e64 2074 6573 7420 6461 7461 2023 2323  nd test data ###
+00066ce0: 2323 2323 0d0a 2020 2020 2020 2020 6966  ####..        if
+00066cf0: 206d 6f64 656c 7479 7065 203d 3d20 2743   modeltype == 'C
+00066d00: 6c61 7373 6966 6963 6174 696f 6e27 3a0d  lassification':.
+00066d10: 0a20 2020 2020 2020 2020 2020 2074 7261  .            tra
+00066d20: 696e 696e 6465 782c 2074 6573 7469 6e64  inindex, testind
+00066d30: 6578 203d 2073 7373 2e73 706c 6974 2858  ex = sss.split(X
+00066d40: 2c20 7929 0d0a 2020 2020 2020 2020 2020  , y)..          
+00066d50: 2020 7472 6164 6174 6120 3d20 7472 6169    tradata = trai
+00066d60: 6e64 662e 696c 6f63 5b74 7261 696e 696e  ndf.iloc[trainin
+00066d70: 6465 785b 305d 5d0d 0a20 2020 2020 2020  dex[0]]..       
+00066d80: 2020 2020 2074 7364 6174 6120 3d20 7472       tsdata = tr
+00066d90: 6169 6e64 662e 696c 6f63 5b74 7261 696e  aindf.iloc[train
+00066da0: 696e 6465 785b 315d 5d0d 0a20 2020 2020  index[1]]..     
+00066db0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00066dc0: 2020 2020 2020 7472 6169 6e69 6e67 5f69        training_i
+00066dd0: 6478 2c20 7465 7374 5f69 6478 203d 2069  dx, test_idx = i
+00066de0: 6e64 6963 6573 5b3a 7472 6169 6e5f 726f  ndices[:train_ro
+00066df0: 7773 5d2c 2069 6e64 6963 6573 5b74 7261  ws], indices[tra
+00066e00: 696e 5f72 6f77 733a 5d0d 0a20 2020 2020  in_rows:]..     
+00066e10: 2020 2020 2020 2074 7261 6461 7461 2c20         tradata, 
+00066e20: 7473 6461 7461 203d 2074 7261 696e 6466  tsdata = traindf
+00066e30: 2e69 6c6f 635b 7472 6169 6e69 6e67 5f69  .iloc[training_i
+00066e40: 6478 5d2c 2074 7261 696e 6466 2e69 6c6f  dx], traindf.ilo
+00066e50: 635b 7465 7374 5f69 6478 5d0d 0a20 2020  c[test_idx]..   
+00066e60: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
+00066e70: 2323 2323 2323 2323 2323 2020 2020 4352  ##########    CR
+00066e80: 4f53 5320 5641 4c49 4441 5449 4f4e 2050  OSS VALIDATION P
+00066e90: 4f52 5449 4f4e 2020 2323 2323 2323 2323  ORTION  ########
+00066ea0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+00066eb0: 0a20 2020 2020 2020 2058 203d 2074 7364  .        X = tsd
+00066ec0: 6174 615b 636f 6c73 5d0d 0a20 2020 2020  ata[cols]..     
+00066ed0: 2020 2079 203d 2074 7364 6174 615b 7461     y = tsdata[ta
+00066ee0: 7267 6574 5d0d 0a20 2020 2020 2020 2069  rget]..        i
+00066ef0: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
+00066f00: 436c 6173 7369 6669 6361 7469 6f6e 273a  Classification':
+00066f10: 0d0a 2020 2020 2020 2020 2020 2020 7373  ..            ss
+00066f20: 7320 3d20 5374 7261 7469 6669 6564 5368  s = StratifiedSh
+00066f30: 7566 666c 6553 706c 6974 286e 5f73 706c  uffleSplit(n_spl
+00066f40: 6974 733d 322c 2074 6573 745f 7369 7a65  its=2, test_size
+00066f50: 3d30 2e34 302c 2072 616e 646f 6d5f 7374  =0.40, random_st
+00066f60: 6174 653d 7261 6e64 6f6d 7374 6174 6529  ate=randomstate)
+00066f70: 0d0a 2020 2020 2020 2020 2020 2020 6376  ..            cv
+00066f80: 696e 6465 782c 2074 735f 696e 6465 7820  index, ts_index 
+00066f90: 3d20 7373 732e 7370 6c69 7428 582c 2079  = sss.split(X, y
+00066fa0: 290d 0a20 2020 2020 2020 2020 2020 2063  )..            c
+00066fb0: 7664 6174 6120 3d20 7473 6461 7461 2e69  vdata = tsdata.i
+00066fc0: 6c6f 635b 6376 696e 6465 785b 305d 5d0d  loc[cvindex[0]].
+00066fd0: 0a20 2020 2020 2020 2020 2020 2074 7364  .            tsd
+00066fe0: 6174 6120 3d20 7473 6461 7461 2e69 6c6f  ata = tsdata.ilo
+00066ff0: 635b 6376 696e 6465 785b 315d 5d0d 0a20  c[cvindex[1]].. 
+00067000: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00067010: 2020 2020 2020 2020 2020 696e 6469 6365            indice
+00067020: 7320 3d20 6e70 2e72 616e 646f 6d2e 7065  s = np.random.pe
+00067030: 726d 7574 6174 696f 6e28 7473 6461 7461  rmutation(tsdata
+00067040: 2e73 6861 7065 5b30 5d29 0d0a 2020 2020  .shape[0])..    
+00067050: 2020 2020 2020 2020 7472 6169 6e5f 726f          train_ro
+00067060: 7773 203d 2069 6e74 2830 2e34 2a74 7364  ws = int(0.4*tsd
+00067070: 6174 612e 7368 6170 655b 305d 290d 0a20  ata.shape[0]).. 
+00067080: 2020 2020 2020 2020 2020 2074 7261 696e             train
+00067090: 696e 675f 6964 782c 2074 6573 745f 6964  ing_idx, test_id
+000670a0: 7820 3d20 696e 6469 6365 735b 3a74 7261  x = indices[:tra
+000670b0: 696e 5f72 6f77 735d 2c20 696e 6469 6365  in_rows], indice
+000670c0: 735b 7472 6169 6e5f 726f 7773 3a5d 0d0a  s[train_rows:]..
+000670d0: 2020 2020 2020 2020 2020 2020 6376 6461              cvda
+000670e0: 7461 2c20 7473 6461 7461 203d 2074 7364  ta, tsdata = tsd
+000670f0: 6174 612e 696c 6f63 5b74 7261 696e 696e  ata.iloc[trainin
+00067100: 675f 6964 785d 2c20 7473 6461 7461 2e69  g_idx], tsdata.i
+00067110: 6c6f 635b 7465 7374 5f69 6478 5d0d 0a20  loc[test_idx].. 
+00067120: 2020 2020 2020 2072 6574 7572 6e20 7472         return tr
+00067130: 6164 6174 612c 2063 7664 6174 612c 2074  adata, cvdata, t
+00067140: 7364 6174 612c 2063 6f6c 730d 0a20 2020  sdata, cols..   
+00067150: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00067160: 2323 2323 2323 2320 4966 2054 6573 7420  ####### If Test 
+00067170: 4461 7461 4672 616d 6520 6973 2067 6976  DataFrame is giv
+00067180: 656e 2074 6865 6e20 6b65 6570 2074 6861  en then keep tha
+00067190: 7420 6173 2074 7364 6174 6120 2323 2323  t as tsdata ####
+000671a0: 2323 2323 0d0a 2020 2020 2020 2020 6966  ####..        if
+000671b0: 206d 6f64 656c 7479 7065 203d 3d20 2743   modeltype == 'C
+000671c0: 6c61 7373 6966 6963 6174 696f 6e27 3a0d  lassification':.
+000671d0: 0a20 2020 2020 2020 2020 2020 2074 7261  .            tra
+000671e0: 696e 696e 6465 782c 2074 6573 7469 6e64  inindex, testind
+000671f0: 6578 203d 2073 7373 2e73 706c 6974 2858  ex = sss.split(X
+00067200: 2c20 7929 0d0a 2020 2020 2020 2020 2020  , y)..          
+00067210: 2020 7472 6164 6174 6120 3d20 7472 6169    tradata = trai
+00067220: 6e64 662e 696c 6f63 5b74 7261 696e 696e  ndf.iloc[trainin
+00067230: 6465 785b 305d 5d0d 0a20 2020 2020 2020  dex[0]]..       
+00067240: 2020 2020 2063 7664 6174 6120 3d20 7472       cvdata = tr
+00067250: 6169 6e64 662e 696c 6f63 5b74 7261 696e  aindf.iloc[train
+00067260: 696e 6465 785b 315d 5d0d 0a20 2020 2020  index[1]]..     
+00067270: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+00067280: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00067290: 6c65 6e28 7465 7374 6466 5b74 6172 6765  len(testdf[targe
+000672a0: 745d 2e76 616c 7565 5f63 6f75 6e74 7328  t].value_counts(
+000672b0: 2920 3e3d 2032 293a 0d0a 2020 2020 2020  ) >= 2):..      
+000672c0: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+000672d0: 696e 7428 2720 2020 204e 756d 6265 7220  int('    Number 
+000672e0: 6f66 2054 6172 6765 7420 526f 7773 2069  of Target Rows i
+000672f0: 6e20 5465 7374 2044 6174 613a 2025 6427  n Test Data: %d'
+00067300: 2025 6c65 6e28 7465 7374 6466 5b74 6573   %len(testdf[tes
+00067310: 7464 665b 7461 7267 6574 5d3d 3d31 5d29  tdf[target]==1])
+00067320: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00067330: 2020 2020 2020 2074 7364 6174 6120 3d20         tsdata = 
+00067340: 7465 7374 6466 5b3a 5d0d 0a20 2020 2020  testdf[:]..     
+00067350: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00067360: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00067370: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
+00067380: 2054 6573 7420 6461 7461 2068 6173 2073   Test data has s
+00067390: 696e 676c 6520 636c 6173 732e 204f 7665  ingle class. Ove
+000673a0: 7277 7269 7469 6e67 2070 7265 6469 6374  rwriting predict
+000673b0: 696f 6e73 206f 6e20 5465 7374 2054 6172  ions on Test Tar
+000673c0: 6765 7420 636f 6c75 6d6e 2e27 290d 0a20  get column.').. 
+000673d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000673e0: 2020 2070 7265 6469 6374 6f72 7320 3d20     predictors = 
+000673f0: 5b78 2066 6f72 2078 2069 6e20 6c69 7374  [x for x in list
+00067400: 2874 7261 696e 6466 2920 6966 2078 206e  (traindf) if x n
+00067410: 6f74 2069 6e20 7461 7267 6574 5d0d 0a20  ot in target].. 
+00067420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00067430: 2020 2074 7364 6174 6120 3d20 7465 7374     tsdata = test
+00067440: 6466 5b3a 5d0d 0a20 2020 2020 2020 2020  df[:]..         
+00067450: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
+00067460: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00067470: 7428 2720 2020 204e 6f20 5461 7267 6574  t('    No Target
+00067480: 2063 6f6c 756d 6e20 696e 2054 6573 7420   column in Test 
+00067490: 6461 7461 2729 0d0a 2020 2020 2020 2020  data')..        
+000674a0: 2020 2020 2020 2020 7465 7374 6466 5b74          testdf[t
+000674b0: 6172 6765 745d 203d 2030 0d0a 2020 2020  arget] = 0..    
+000674c0: 2020 2020 2020 2020 2020 2020 7473 6461              tsda
+000674d0: 7461 203d 2074 6573 7464 665b 636f 6c73  ta = testdf[cols
+000674e0: 2b5b 7461 7267 6574 5d5d 0d0a 2020 2020  +[target]]..    
+000674f0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00067500: 2020 2020 2020 2069 6e64 6963 6573 203d         indices =
+00067510: 206e 702e 7261 6e64 6f6d 2e70 6572 6d75   np.random.permu
+00067520: 7461 7469 6f6e 2874 7261 696e 6466 2e73  tation(traindf.s
+00067530: 6861 7065 5b30 5d29 0d0a 2020 2020 2020  hape[0])..      
+00067540: 2020 2020 2020 7472 6169 6e5f 726f 7773        train_rows
+00067550: 203d 2069 6e74 2830 2e38 2a74 7261 696e   = int(0.8*train
+00067560: 6466 2e73 6861 7065 5b30 5d29 0d0a 2020  df.shape[0])..  
+00067570: 2020 2020 2020 2020 2020 7472 6169 6e69            traini
+00067580: 6e67 5f69 6478 2c20 7465 7374 5f69 6478  ng_idx, test_idx
+00067590: 203d 2069 6e64 6963 6573 5b3a 7472 6169   = indices[:trai
+000675a0: 6e5f 726f 7773 5d2c 2069 6e64 6963 6573  n_rows], indices
+000675b0: 5b74 7261 696e 5f72 6f77 733a 5d0d 0a20  [train_rows:].. 
+000675c0: 2020 2020 2020 2020 2020 2074 7261 6461             trada
+000675d0: 7461 2c20 6376 6461 7461 203d 2074 7261  ta, cvdata = tra
+000675e0: 696e 6466 2e69 6c6f 635b 7472 6169 6e69  indf.iloc[traini
+000675f0: 6e67 5f69 6478 5d2c 2074 7261 696e 6466  ng_idx], traindf
+00067600: 2e69 6c6f 635b 7465 7374 5f69 6478 5d0d  .iloc[test_idx].
+00067610: 0a20 2020 2020 2020 2020 2020 2074 7364  .            tsd
+00067620: 6174 6120 3d20 7465 7374 6466 5b3a 5d0d  ata = testdf[:].
+00067630: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00067640: 7472 6164 6174 612c 2063 7664 6174 612c  tradata, cvdata,
+00067650: 2074 7364 6174 612c 2063 6f6c 730d 0a23   tsdata, cols..#
+00067660: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00067670: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00067680: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00067690: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000676a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000676b0: 0d0a 6465 6620 6669 6c6c 696e 675f 6d69  ..def filling_mi
-000676c0: 7373 696e 675f 7661 6c75 6573 5f73 696d  ssing_values_sim
-000676d0: 706c 6528 7472 6169 6e2c 2074 6573 742c  ple(train, test,
-000676e0: 2063 6174 732c 206e 756d 7329 3a0d 0a20   cats, nums):.. 
-000676f0: 2020 2023 2323 2320 6966 2079 6f75 2077     #### if you w
-00067700: 616e 7420 746f 2066 696c 6c20 6d69 7373  ant to fill miss
-00067710: 696e 6720 7661 6c75 6573 2075 7369 6e67  ing values using
-00067720: 206d 6561 6e2c 206d 6564 6961 6e20 6d6f   mean, median mo
-00067730: 6465 2c20 676f 2061 6865 6164 210d 0a20  de, go ahead!.. 
-00067740: 2020 2023 2323 2320 2049 2064 6f6e 2774     ####  I don't
-00067750: 2072 6563 6f6d 6d65 6e64 2042 7574 2073   recommend But s
-00067760: 6f6d 6520 7065 6f70 6c65 2073 6565 6d20  ome people seem 
-00067770: 746f 206c 696b 6520 6974 2e20 2323 2323  to like it. ####
-00067780: 230d 0a20 2020 2066 6f72 2076 6172 6d20  #..    for varm 
-00067790: 696e 2063 6174 733a 0d0a 2020 2020 2020  in cats:..      
-000677a0: 2020 6966 2074 7261 696e 5b76 6172 6d5d    if train[varm]
-000677b0: 2e69 736e 756c 6c28 292e 7375 6d28 2920  .isnull().sum() 
-000677c0: 3e20 303a 0d0a 2020 2020 2020 2020 2020  > 0:..          
-000677d0: 2020 6669 6c6c 6e75 6d20 3d20 7472 6169    fillnum = trai
-000677e0: 6e5b 7661 726d 5d2e 6d6f 6465 2829 5b30  n[varm].mode()[0
-000677f0: 5d0d 0a20 2020 2020 2020 2020 2020 2023  ]..            #
-00067800: 2323 2052 656d 656d 6265 7220 7468 6174  ## Remember that
-00067810: 2066 696c 6c6e 6120 6f6e 6c79 2077 6f72   fillna only wor
-00067820: 6b73 2061 7420 6461 7461 6672 616d 6520  ks at dataframe 
-00067830: 6c65 7665 6c21 2023 2323 0d0a 2020 2020  level! ###..    
-00067840: 2020 2020 2020 2020 7472 6169 6e5b 5b76          train[[v
-00067850: 6172 6d5d 5d20 3d20 7472 6169 6e5b 5b76  arm]] = train[[v
-00067860: 6172 6d5d 5d2e 6669 6c6c 6e61 2866 696c  arm]].fillna(fil
-00067870: 6c6e 756d 290d 0a20 2020 2020 2020 2020  lnum)..         
-00067880: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-00067890: 616e 6365 2874 6573 742c 2073 7472 293a  ance(test, str):
-000678a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000678b0: 2020 6966 2074 6573 745b 7661 726d 5d2e    if test[varm].
-000678c0: 6973 6e75 6c6c 2829 2e73 756d 2829 203e  isnull().sum() >
-000678d0: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
-000678e0: 2020 2020 2020 2020 2023 2323 2052 656d           ### Rem
-000678f0: 656d 6265 7220 7468 6174 2066 696c 6c6e  ember that filln
-00067900: 6120 6f6e 6c79 2077 6f72 6b73 2061 7420  a only works at 
-00067910: 6461 7461 6672 616d 6520 6c65 7665 6c21  dataframe level!
-00067920: 2023 2323 0d0a 2020 2020 2020 2020 2020   ###..          
-00067930: 2020 2020 2020 2020 2020 7465 7374 5b5b            test[[
-00067940: 7661 726d 5d5d 203d 2074 6573 745b 5b76  varm]] = test[[v
-00067950: 6172 6d5d 5d2e 6669 6c6c 6e61 2866 696c  arm]].fillna(fil
-00067960: 6c6e 756d 290d 0a20 2020 2066 6f72 206e  lnum)..    for n
-00067970: 756d 2069 6e20 6e75 6d73 3a0d 0a20 2020  um in nums:..   
-00067980: 2020 2020 2069 6620 7472 6169 6e5b 7661       if train[va
-00067990: 726d 5d2e 6973 6e75 6c6c 2829 2e73 756d  rm].isnull().sum
-000679a0: 2829 203e 2030 3a0d 0a20 2020 2020 2020  () > 0:..       
-000679b0: 2020 2020 2066 696c 6c6e 756d 203d 2074       fillnum = t
-000679c0: 7261 696e 5b6e 756d 5d2e 6d65 616e 2829  rain[num].mean()
-000679d0: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-000679e0: 2320 5265 6d65 6d62 6572 2074 6861 7420  # Remember that 
-000679f0: 6669 6c6c 6e61 206f 6e6c 7920 776f 726b  fillna only work
-00067a00: 7320 6174 2064 6174 6166 7261 6d65 206c  s at dataframe l
-00067a10: 6576 656c 2120 2323 230d 0a20 2020 2020  evel! ###..     
-00067a20: 2020 2020 2020 2074 7261 696e 5b5b 6e75         train[[nu
-00067a30: 6d5d 5d20 3d20 7472 6169 6e5b 5b6e 756d  m]] = train[[num
-00067a40: 5d5d 2e66 696c 6c6e 6128 6669 6c6c 6e75  ]].fillna(fillnu
-00067a50: 6d29 0d0a 2020 2020 2020 2020 2020 2020  m)..            
-00067a60: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00067a70: 6528 7465 7374 2c20 7374 7229 3a0d 0a20  e(test, str):.. 
-00067a80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00067a90: 6620 7465 7374 5b76 6172 6d5d 2e69 736e  f test[varm].isn
-00067aa0: 756c 6c28 292e 7375 6d28 2920 3e20 303a  ull().sum() > 0:
-00067ab0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00067ac0: 2020 2020 2020 2323 2320 5265 6d65 6d62        ### Rememb
-00067ad0: 6572 2074 6861 7420 6669 6c6c 6e61 206f  er that fillna o
-00067ae0: 6e6c 7920 776f 726b 7320 6174 2064 6174  nly works at dat
-00067af0: 6166 7261 6d65 206c 6576 656c 2120 2323  aframe level! ##
-00067b00: 230d 0a20 2020 2020 2020 2020 2020 2020  #..             
-00067b10: 2020 2020 2020 2074 6573 745b 5b6e 756d         test[[num
-00067b20: 5d5d 203d 2074 6573 745b 5b6e 756d 5d5d  ]] = test[[num]]
-00067b30: 2e66 696c 6c6e 6128 6669 6c6c 6e75 6d29  .fillna(fillnum)
-00067b40: 0d0a 2020 2020 2323 2320 5468 6973 2069  ..    ### This i
-00067b50: 7320 6120 7369 6d70 6c65 206c 6f67 2074  s a simple log t
-00067b60: 7261 6e73 666f 726d 2066 6f72 2076 6572  ransform for ver
-00067b70: 7920 6c61 7267 6520 6e75 6d65 7269 6320  y large numeric 
-00067b80: 7661 6c75 6573 203d 3e20 6869 6768 6c79  values => highly
-00067b90: 2072 6563 6f6d 6d65 6e64 6564 210d 0a20   recommended!.. 
-00067ba0: 2020 2066 6f72 206e 756d 2069 6e20 6e75     for num in nu
-00067bb0: 6d73 3a0d 0a20 2020 2020 2020 206d 6173  ms:..        mas
-00067bc0: 6b20 3d20 7472 6169 6e5b 6e75 6d5d 3d3d  k = train[num]==
-00067bd0: 300d 0a20 2020 2020 2020 2066 696c 6c6e  0..        filln
-00067be0: 756d 203d 2031 3065 2d35 0d0a 2020 2020  um = 10e-5..    
-00067bf0: 2020 2020 7472 6169 6e2e 6978 5b6d 6173      train.ix[mas
-00067c00: 6b2c 6e75 6d5d 203d 2066 696c 6c6e 756d  k,num] = fillnum
-00067c10: 0d0a 2020 2020 2020 2020 2323 2320 5265  ..        ### Re
-00067c20: 6d65 6d62 6572 2074 6861 7420 6669 6c6c  member that fill
-00067c30: 6e61 206f 6e6c 7920 776f 726b 7320 6174  na only works at
-00067c40: 2064 6174 6166 7261 6d65 206c 6576 656c   dataframe level
-00067c50: 2120 2323 230d 0a20 2020 2020 2020 2074  ! ###..        t
-00067c60: 7261 696e 5b5b 6e75 6d2b 275f 6c6f 6727  rain[[num+'_log'
-00067c70: 5d5d 203d 206e 702e 6c6f 6731 3028 7472  ]] = np.log10(tr
-00067c80: 6169 6e5b 5b6e 756d 5d5d 292e 6669 6c6c  ain[[num]]).fill
-00067c90: 6e61 2830 290d 0a20 2020 2020 2020 2069  na(0)..        i
-00067ca0: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-00067cb0: 2874 6573 742c 2073 7472 293a 0d0a 2020  (test, str):..  
-00067cc0: 2020 2020 2020 2020 2020 6d61 736b 203d            mask =
-00067cd0: 2074 6573 745b 6e75 6d5d 3d3d 300d 0a20   test[num]==0.. 
-00067ce0: 2020 2020 2020 2020 2020 2074 6573 742e             test.
-00067cf0: 6978 5b6d 6173 6b2c 6e75 6d5d 203d 2066  ix[mask,num] = f
-00067d00: 696c 6c6e 756d 0d0a 2020 2020 2020 2020  illnum..        
-00067d10: 2020 2020 2323 2320 5265 6d65 6d62 6572      ### Remember
-00067d20: 2074 6861 7420 6669 6c6c 6e61 206f 6e6c   that fillna onl
-00067d30: 7920 776f 726b 7320 6174 2064 6174 6166  y works at dataf
-00067d40: 7261 6d65 206c 6576 656c 2120 2323 230d  rame level! ###.
-00067d50: 0a20 2020 2020 2020 2020 2020 2074 6573  .            tes
-00067d60: 745b 5b6e 756d 2b27 5f6c 6f67 275d 5d20  t[[num+'_log']] 
-00067d70: 3d20 6e70 2e6c 6f67 3130 2874 6573 745b  = np.log10(test[
-00067d80: 5b6e 756d 5d5d 292e 6669 6c6c 6e61 2830  [num]]).fillna(0
-00067d90: 290d 0a20 2020 2072 6574 7572 6e20 7472  )..    return tr
-00067da0: 6169 6e2c 2074 6573 740d 0a23 2323 2323  ain, test..#####
+000676a0: 2323 2323 2323 2323 2323 230d 0a64 6566  ###########..def
+000676b0: 2066 696c 6c69 6e67 5f6d 6973 7369 6e67   filling_missing
+000676c0: 5f76 616c 7565 735f 7369 6d70 6c65 2874  _values_simple(t
+000676d0: 7261 696e 2c20 7465 7374 2c20 6361 7473  rain, test, cats
+000676e0: 2c20 6e75 6d73 293a 0d0a 2020 2020 2323  , nums):..    ##
+000676f0: 2323 2069 6620 796f 7520 7761 6e74 2074  ## if you want t
+00067700: 6f20 6669 6c6c 206d 6973 7369 6e67 2076  o fill missing v
+00067710: 616c 7565 7320 7573 696e 6720 6d65 616e  alues using mean
+00067720: 2c20 6d65 6469 616e 206d 6f64 652c 2067  , median mode, g
+00067730: 6f20 6168 6561 6421 0d0a 2020 2020 2323  o ahead!..    ##
+00067740: 2323 2020 4920 646f 6e27 7420 7265 636f  ##  I don't reco
+00067750: 6d6d 656e 6420 4275 7420 736f 6d65 2070  mmend But some p
+00067760: 656f 706c 6520 7365 656d 2074 6f20 6c69  eople seem to li
+00067770: 6b65 2069 742e 2023 2323 2323 0d0a 2020  ke it. #####..  
+00067780: 2020 666f 7220 7661 726d 2069 6e20 6361    for varm in ca
+00067790: 7473 3a0d 0a20 2020 2020 2020 2069 6620  ts:..        if 
+000677a0: 7472 6169 6e5b 7661 726d 5d2e 6973 6e75  train[varm].isnu
+000677b0: 6c6c 2829 2e73 756d 2829 203e 2030 3a0d  ll().sum() > 0:.
+000677c0: 0a20 2020 2020 2020 2020 2020 2066 696c  .            fil
+000677d0: 6c6e 756d 203d 2074 7261 696e 5b76 6172  lnum = train[var
+000677e0: 6d5d 2e6d 6f64 6528 295b 305d 0d0a 2020  m].mode()[0]..  
+000677f0: 2020 2020 2020 2020 2020 2323 2320 5265            ### Re
+00067800: 6d65 6d62 6572 2074 6861 7420 6669 6c6c  member that fill
+00067810: 6e61 206f 6e6c 7920 776f 726b 7320 6174  na only works at
+00067820: 2064 6174 6166 7261 6d65 206c 6576 656c   dataframe level
+00067830: 2120 2323 230d 0a20 2020 2020 2020 2020  ! ###..         
+00067840: 2020 2074 7261 696e 5b5b 7661 726d 5d5d     train[[varm]]
+00067850: 203d 2074 7261 696e 5b5b 7661 726d 5d5d   = train[[varm]]
+00067860: 2e66 696c 6c6e 6128 6669 6c6c 6e75 6d29  .fillna(fillnum)
+00067870: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00067880: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00067890: 7465 7374 2c20 7374 7229 3a0d 0a20 2020  test, str):..   
+000678a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000678b0: 7465 7374 5b76 6172 6d5d 2e69 736e 756c  test[varm].isnul
+000678c0: 6c28 292e 7375 6d28 2920 3e20 303a 0d0a  l().sum() > 0:..
+000678d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000678e0: 2020 2020 2323 2320 5265 6d65 6d62 6572      ### Remember
+000678f0: 2074 6861 7420 6669 6c6c 6e61 206f 6e6c   that fillna onl
+00067900: 7920 776f 726b 7320 6174 2064 6174 6166  y works at dataf
+00067910: 7261 6d65 206c 6576 656c 2120 2323 230d  rame level! ###.
+00067920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00067930: 2020 2020 2074 6573 745b 5b76 6172 6d5d       test[[varm]
+00067940: 5d20 3d20 7465 7374 5b5b 7661 726d 5d5d  ] = test[[varm]]
+00067950: 2e66 696c 6c6e 6128 6669 6c6c 6e75 6d29  .fillna(fillnum)
+00067960: 0d0a 2020 2020 666f 7220 6e75 6d20 696e  ..    for num in
+00067970: 206e 756d 733a 0d0a 2020 2020 2020 2020   nums:..        
+00067980: 6966 2074 7261 696e 5b76 6172 6d5d 2e69  if train[varm].i
+00067990: 736e 756c 6c28 292e 7375 6d28 2920 3e20  snull().sum() > 
+000679a0: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+000679b0: 6669 6c6c 6e75 6d20 3d20 7472 6169 6e5b  fillnum = train[
+000679c0: 6e75 6d5d 2e6d 6561 6e28 290d 0a20 2020  num].mean()..   
+000679d0: 2020 2020 2020 2020 2023 2323 2052 656d           ### Rem
+000679e0: 656d 6265 7220 7468 6174 2066 696c 6c6e  ember that filln
+000679f0: 6120 6f6e 6c79 2077 6f72 6b73 2061 7420  a only works at 
+00067a00: 6461 7461 6672 616d 6520 6c65 7665 6c21  dataframe level!
+00067a10: 2023 2323 0d0a 2020 2020 2020 2020 2020   ###..          
+00067a20: 2020 7472 6169 6e5b 5b6e 756d 5d5d 203d    train[[num]] =
+00067a30: 2074 7261 696e 5b5b 6e75 6d5d 5d2e 6669   train[[num]].fi
+00067a40: 6c6c 6e61 2866 696c 6c6e 756d 290d 0a20  llna(fillnum).. 
+00067a50: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+00067a60: 7420 6973 696e 7374 616e 6365 2874 6573  t isinstance(tes
+00067a70: 742c 2073 7472 293a 0d0a 2020 2020 2020  t, str):..      
+00067a80: 2020 2020 2020 2020 2020 6966 2074 6573            if tes
+00067a90: 745b 7661 726d 5d2e 6973 6e75 6c6c 2829  t[varm].isnull()
+00067aa0: 2e73 756d 2829 203e 2030 3a0d 0a20 2020  .sum() > 0:..   
+00067ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00067ac0: 2023 2323 2052 656d 656d 6265 7220 7468   ### Remember th
+00067ad0: 6174 2066 696c 6c6e 6120 6f6e 6c79 2077  at fillna only w
+00067ae0: 6f72 6b73 2061 7420 6461 7461 6672 616d  orks at datafram
+00067af0: 6520 6c65 7665 6c21 2023 2323 0d0a 2020  e level! ###..  
+00067b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00067b10: 2020 7465 7374 5b5b 6e75 6d5d 5d20 3d20    test[[num]] = 
+00067b20: 7465 7374 5b5b 6e75 6d5d 5d2e 6669 6c6c  test[[num]].fill
+00067b30: 6e61 2866 696c 6c6e 756d 290d 0a20 2020  na(fillnum)..   
+00067b40: 2023 2323 2054 6869 7320 6973 2061 2073   ### This is a s
+00067b50: 696d 706c 6520 6c6f 6720 7472 616e 7366  imple log transf
+00067b60: 6f72 6d20 666f 7220 7665 7279 206c 6172  orm for very lar
+00067b70: 6765 206e 756d 6572 6963 2076 616c 7565  ge numeric value
+00067b80: 7320 3d3e 2068 6967 686c 7920 7265 636f  s => highly reco
+00067b90: 6d6d 656e 6465 6421 0d0a 2020 2020 666f  mmended!..    fo
+00067ba0: 7220 6e75 6d20 696e 206e 756d 733a 0d0a  r num in nums:..
+00067bb0: 2020 2020 2020 2020 6d61 736b 203d 2074          mask = t
+00067bc0: 7261 696e 5b6e 756d 5d3d 3d30 0d0a 2020  rain[num]==0..  
+00067bd0: 2020 2020 2020 6669 6c6c 6e75 6d20 3d20        fillnum = 
+00067be0: 3130 652d 350d 0a20 2020 2020 2020 2074  10e-5..        t
+00067bf0: 7261 696e 2e69 785b 6d61 736b 2c6e 756d  rain.ix[mask,num
+00067c00: 5d20 3d20 6669 6c6c 6e75 6d0d 0a20 2020  ] = fillnum..   
+00067c10: 2020 2020 2023 2323 2052 656d 656d 6265       ### Remembe
+00067c20: 7220 7468 6174 2066 696c 6c6e 6120 6f6e  r that fillna on
+00067c30: 6c79 2077 6f72 6b73 2061 7420 6461 7461  ly works at data
+00067c40: 6672 616d 6520 6c65 7665 6c21 2023 2323  frame level! ###
+00067c50: 0d0a 2020 2020 2020 2020 7472 6169 6e5b  ..        train[
+00067c60: 5b6e 756d 2b27 5f6c 6f67 275d 5d20 3d20  [num+'_log']] = 
+00067c70: 6e70 2e6c 6f67 3130 2874 7261 696e 5b5b  np.log10(train[[
+00067c80: 6e75 6d5d 5d29 2e66 696c 6c6e 6128 3029  num]]).fillna(0)
+00067c90: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+00067ca0: 2069 7369 6e73 7461 6e63 6528 7465 7374   isinstance(test
+00067cb0: 2c20 7374 7229 3a0d 0a20 2020 2020 2020  , str):..       
+00067cc0: 2020 2020 206d 6173 6b20 3d20 7465 7374       mask = test
+00067cd0: 5b6e 756d 5d3d 3d30 0d0a 2020 2020 2020  [num]==0..      
+00067ce0: 2020 2020 2020 7465 7374 2e69 785b 6d61        test.ix[ma
+00067cf0: 736b 2c6e 756d 5d20 3d20 6669 6c6c 6e75  sk,num] = fillnu
+00067d00: 6d0d 0a20 2020 2020 2020 2020 2020 2023  m..            #
+00067d10: 2323 2052 656d 656d 6265 7220 7468 6174  ## Remember that
+00067d20: 2066 696c 6c6e 6120 6f6e 6c79 2077 6f72   fillna only wor
+00067d30: 6b73 2061 7420 6461 7461 6672 616d 6520  ks at dataframe 
+00067d40: 6c65 7665 6c21 2023 2323 0d0a 2020 2020  level! ###..    
+00067d50: 2020 2020 2020 2020 7465 7374 5b5b 6e75          test[[nu
+00067d60: 6d2b 275f 6c6f 6727 5d5d 203d 206e 702e  m+'_log']] = np.
+00067d70: 6c6f 6731 3028 7465 7374 5b5b 6e75 6d5d  log10(test[[num]
+00067d80: 5d29 2e66 696c 6c6e 6128 3029 0d0a 2020  ]).fillna(0)..  
+00067d90: 2020 7265 7475 726e 2074 7261 696e 2c20    return train, 
+00067da0: 7465 7374 0d0a 2323 2323 2323 2323 2323  test..##########
 00067db0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00067dc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00067dd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00067de0: 2323 2323 2323 230d 0a69 6d70 6f72 7420  #######..import 
-00067df0: 6f73 0d0a 6465 6620 7772 6974 655f 6669  os..def write_fi
-00067e00: 6c65 5f74 6f5f 666f 6c64 6572 2864 662c  le_to_folder(df,
-00067e10: 2065 6163 685f 7461 7267 6574 2c20 6261   each_target, ba
-00067e20: 7365 5f66 696c 656e 616d 652c 2076 6572  se_filename, ver
-00067e30: 626f 7365 3d31 293a 0d0a 2020 2020 6966  bose=1):..    if
-00067e40: 2069 7369 6e73 7461 6e63 6528 6561 6368   isinstance(each
-00067e50: 5f74 6172 6765 742c 2073 7472 293a 0d0a  _target, str):..
-00067e60: 2020 2020 2020 2020 6469 725f 6e61 6d65          dir_name
-00067e70: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
-00067e80: 2865 6163 685f 7461 7267 6574 290d 0a20  (each_target).. 
-00067e90: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00067ea0: 2020 6469 725f 6e61 6d65 203d 2073 7472    dir_name = str
-00067eb0: 2865 6163 685f 7461 7267 6574 290d 0a20  (each_target).. 
-00067ec0: 2020 2066 696c 656e 616d 6520 3d20 6f73     filename = os
-00067ed0: 2e70 6174 682e 6a6f 696e 2864 6972 5f6e  .path.join(dir_n
-00067ee0: 616d 652c 2062 6173 655f 6669 6c65 6e61  ame, base_filena
-00067ef0: 6d65 290d 0a20 2020 2069 6620 7665 7262  me)..    if verb
-00067f00: 6f73 6520 3e3d 2031 3a0d 0a20 2020 2020  ose >= 1:..     
-00067f10: 2020 2069 6620 6f73 2e6e 616d 6520 3d3d     if os.name ==
-00067f20: 2027 6e74 273a 0d0a 2020 2020 2020 2020   'nt':..        
-00067f30: 2020 2020 7072 696e 7428 2720 2020 2053      print('    S
-00067f40: 6176 696e 6720 7072 6564 6963 7469 6f6e  aving prediction
-00067f50: 7320 746f 202e 5c25 7327 2025 6669 6c65  s to .\%s' %file
-00067f60: 6e61 6d65 290d 0a20 2020 2020 2020 2065  name)..        e
-00067f70: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00067f80: 2020 7072 696e 7428 2720 2020 2053 6176    print('    Sav
-00067f90: 696e 6720 7072 6564 6963 7469 6f6e 7320  ing predictions 
-00067fa0: 746f 202e 2f25 7327 2025 6669 6c65 6e61  to ./%s' %filena
-00067fb0: 6d65 290d 0a20 2020 2020 2020 2069 6620  me)..        if 
-00067fc0: 6e6f 7420 6f73 2e70 6174 682e 6973 6469  not os.path.isdi
-00067fd0: 7228 6469 725f 6e61 6d65 293a 0d0a 2020  r(dir_name):..  
-00067fe0: 2020 2020 2020 2020 2020 6f73 2e6d 6b64            os.mkd
-00067ff0: 6972 2864 6972 5f6e 616d 6529 0d0a 2020  ir(dir_name)..  
-00068000: 2020 2020 2020 6466 2e74 6f5f 6373 7628        df.to_csv(
-00068010: 6669 6c65 6e61 6d65 2c69 6e64 6578 3d46  filename,index=F
-00068020: 616c 7365 290d 0a23 2323 2323 2323 2323  alse)..#########
+00067de0: 2323 0d0a 696d 706f 7274 206f 730d 0a64  ##..import os..d
+00067df0: 6566 2077 7269 7465 5f66 696c 655f 746f  ef write_file_to
+00067e00: 5f66 6f6c 6465 7228 6466 2c20 6561 6368  _folder(df, each
+00067e10: 5f74 6172 6765 742c 2062 6173 655f 6669  _target, base_fi
+00067e20: 6c65 6e61 6d65 2c20 7665 7262 6f73 653d  lename, verbose=
+00067e30: 3129 3a0d 0a20 2020 2069 6620 6973 696e  1):..    if isin
+00067e40: 7374 616e 6365 2865 6163 685f 7461 7267  stance(each_targ
+00067e50: 6574 2c20 7374 7229 3a0d 0a20 2020 2020  et, str):..     
+00067e60: 2020 2064 6972 5f6e 616d 6520 3d20 636f     dir_name = co
+00067e70: 7079 2e64 6565 7063 6f70 7928 6561 6368  py.deepcopy(each
+00067e80: 5f74 6172 6765 7429 0d0a 2020 2020 656c  _target)..    el
+00067e90: 7365 3a0d 0a20 2020 2020 2020 2064 6972  se:..        dir
+00067ea0: 5f6e 616d 6520 3d20 7374 7228 6561 6368  _name = str(each
+00067eb0: 5f74 6172 6765 7429 0d0a 2020 2020 6669  _target)..    fi
+00067ec0: 6c65 6e61 6d65 203d 206f 732e 7061 7468  lename = os.path
+00067ed0: 2e6a 6f69 6e28 6469 725f 6e61 6d65 2c20  .join(dir_name, 
+00067ee0: 6261 7365 5f66 696c 656e 616d 6529 0d0a  base_filename)..
+00067ef0: 2020 2020 6966 2076 6572 626f 7365 203e      if verbose >
+00067f00: 3d20 313a 0d0a 2020 2020 2020 2020 6966  = 1:..        if
+00067f10: 206f 732e 6e61 6d65 203d 3d20 276e 7427   os.name == 'nt'
+00067f20: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+00067f30: 7269 6e74 2827 2020 2020 5361 7669 6e67  rint('    Saving
+00067f40: 2070 7265 6469 6374 696f 6e73 2074 6f20   predictions to 
+00067f50: 2e5c 2573 2720 2566 696c 656e 616d 6529  .\%s' %filename)
+00067f60: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00067f70: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00067f80: 6e74 2827 2020 2020 5361 7669 6e67 2070  nt('    Saving p
+00067f90: 7265 6469 6374 696f 6e73 2074 6f20 2e2f  redictions to ./
+00067fa0: 2573 2720 2566 696c 656e 616d 6529 0d0a  %s' %filename)..
+00067fb0: 2020 2020 2020 2020 6966 206e 6f74 206f          if not o
+00067fc0: 732e 7061 7468 2e69 7364 6972 2864 6972  s.path.isdir(dir
+00067fd0: 5f6e 616d 6529 3a0d 0a20 2020 2020 2020  _name):..       
+00067fe0: 2020 2020 206f 732e 6d6b 6469 7228 6469       os.mkdir(di
+00067ff0: 725f 6e61 6d65 290d 0a20 2020 2020 2020  r_name)..       
+00068000: 2064 662e 746f 5f63 7376 2866 696c 656e   df.to_csv(filen
+00068010: 616d 652c 696e 6465 783d 4661 6c73 6529  ame,index=False)
+00068020: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
 00068030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00068040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00068050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00068060: 2323 2323 230d 0a64 6566 2063 7265 6174  #####..def creat
-00068070: 655f 7473 5f66 6561 7475 7265 7328 6466  e_ts_features(df
-00068080: 2c20 7473 636f 6c29 3a0d 0a20 2020 2022  , tscol):..    "
-00068090: 2222 0d0a 2020 2020 5468 6973 2074 616b  ""..    This tak
-000680a0: 6573 2069 6e20 696e 7075 7420 6120 6461  es in input a da
-000680b0: 7461 6672 616d 6520 616e 6420 6120 6461  taframe and a da
-000680c0: 7465 2076 6172 6961 626c 652e 0d0a 2020  te variable...  
-000680d0: 2020 4974 2074 6865 6e20 6372 6561 7465    It then create
-000680e0: 7320 7469 6d65 2073 6572 6965 7320 6665  s time series fe
-000680f0: 6174 7572 6573 2075 7369 6e67 2074 6865  atures using the
-00068100: 2070 616e 6461 7320 2e64 742e 7765 656b   pandas .dt.week
-00068110: 6461 7920 6b69 6e64 206f 6620 7379 6e74  day kind of synt
-00068120: 6178 2e0d 0a20 2020 2049 7420 616c 736f  ax...    It also
-00068130: 2072 6574 7572 6e73 2074 6865 2064 6174   returns the dat
-00068140: 6120 6672 616d 6520 6f66 2061 6464 6564  a frame of added
-00068150: 2066 6561 7475 7265 7320 7769 7468 2065   features with e
-00068160: 6163 6820 7661 7269 6162 6c65 2061 7320  ach variable as 
-00068170: 616e 2069 6e74 6567 6572 2076 6172 6961  an integer varia
-00068180: 626c 652e 0d0a 2020 2020 2222 220d 0a20  ble...    """.. 
-00068190: 2020 2064 6620 3d20 636f 7079 2e64 6565     df = copy.dee
-000681a0: 7063 6f70 7928 6466 290d 0a20 2020 2064  pcopy(df)..    d
-000681b0: 745f 6164 6473 203d 205b 5d0d 0a20 2020  t_adds = []..   
-000681c0: 2074 7279 3a0d 0a20 2020 2020 2020 2064   try:..        d
-000681d0: 665b 7473 636f 6c2b 275f 686f 7572 275d  f[tscol+'_hour']
-000681e0: 203d 2064 665b 7473 636f 6c5d 2e64 742e   = df[tscol].dt.
-000681f0: 686f 7572 2e66 696c 6c6e 6128 3029 2e61  hour.fillna(0).a
-00068200: 7374 7970 6528 696e 7429 0d0a 2020 2020  stype(int)..    
-00068210: 2020 2020 6466 5b74 7363 6f6c 2b27 5f6d      df[tscol+'_m
-00068220: 696e 7574 6527 5d20 3d20 6466 5b74 7363  inute'] = df[tsc
-00068230: 6f6c 5d2e 6474 2e6d 696e 7574 652e 6669  ol].dt.minute.fi
-00068240: 6c6c 6e61 2830 292e 6173 7479 7065 2869  llna(0).astype(i
-00068250: 6e74 290d 0a20 2020 2020 2020 2064 745f  nt)..        dt_
-00068260: 6164 6473 2e61 7070 656e 6428 7473 636f  adds.append(tsco
-00068270: 6c2b 275f 686f 7572 2729 0d0a 2020 2020  l+'_hour')..    
-00068280: 2020 2020 6474 5f61 6464 732e 6170 7065      dt_adds.appe
-00068290: 6e64 2874 7363 6f6c 2b27 5f6d 696e 7574  nd(tscol+'_minut
-000682a0: 6527 290d 0a20 2020 2065 7863 6570 743a  e')..    except:
-000682b0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-000682c0: 2720 2020 2045 7272 6f72 2069 6e20 6372  '    Error in cr
-000682d0: 6561 7469 6e67 2068 6f75 722d 7365 636f  eating hour-seco
-000682e0: 6e64 2064 6572 6976 6564 2066 6561 7475  nd derived featu
-000682f0: 7265 732e 2043 6f6e 7469 6e75 696e 672e  res. Continuing.
-00068300: 2e2e 2729 0d0a 2020 2020 7472 793a 0d0a  ..')..    try:..
-00068310: 2020 2020 2020 2020 6466 5b74 7363 6f6c          df[tscol
-00068320: 2b27 5f64 6179 6f66 7765 656b 275d 203d  +'_dayofweek'] =
-00068330: 2064 665b 7473 636f 6c5d 2e64 742e 6461   df[tscol].dt.da
-00068340: 796f 6677 6565 6b2e 6669 6c6c 6e61 2830  yofweek.fillna(0
-00068350: 292e 6173 7479 7065 2869 6e74 290d 0a20  ).astype(int).. 
-00068360: 2020 2020 2020 2064 745f 6164 6473 2e61         dt_adds.a
-00068370: 7070 656e 6428 7473 636f 6c2b 275f 6461  ppend(tscol+'_da
-00068380: 796f 6677 6565 6b27 290d 0a20 2020 2020  yofweek')..     
-00068390: 2020 2069 6620 7473 636f 6c2b 275f 686f     if tscol+'_ho
-000683a0: 7572 2720 696e 2064 745f 6164 6473 3a0d  ur' in dt_adds:.
-000683b0: 0a20 2020 2020 2020 2020 2020 2044 4159  .            DAY
-000683c0: 5320 3d20 6469 6374 287a 6970 2872 616e  S = dict(zip(ran
-000683d0: 6765 2837 292c 5b27 5375 6e27 2c20 274d  ge(7),['Sun', 'M
-000683e0: 6f6e 272c 2027 5475 6527 2c20 2757 6564  on', 'Tue', 'Wed
-000683f0: 272c 2027 5468 7527 2c20 2746 7269 272c  ', 'Thu', 'Fri',
-00068400: 2027 5361 7427 5d29 290d 0a20 2020 2020   'Sat']))..     
-00068410: 2020 2020 2020 2064 665b 7473 636f 6c2b         df[tscol+
-00068420: 275f 6461 796f 6677 6565 6b27 5d20 3d20  '_dayofweek'] = 
-00068430: 6466 5b74 7363 6f6c 2b27 5f64 6179 6f66  df[tscol+'_dayof
-00068440: 7765 656b 275d 2e6d 6170 2844 4159 5329  week'].map(DAYS)
-00068450: 0d0a 2020 2020 2020 2020 2020 2020 6466  ..            df
-00068460: 2e6c 6f63 5b3a 2c74 7363 6f6c 2b27 5f64  .loc[:,tscol+'_d
-00068470: 6179 6f66 7765 656b 5f68 6f75 725f 6372  ayofweek_hour_cr
-00068480: 6f73 7327 5d20 3d20 6466 5b74 7363 6f6c  oss'] = df[tscol
-00068490: 2b27 5f64 6179 6f66 7765 656b 275d 202b  +'_dayofweek'] +
-000684a0: 2220 222b 2064 665b 7473 636f 6c2b 275f  " "+ df[tscol+'_
-000684b0: 686f 7572 275d 2e61 7374 7970 6528 7374  hour'].astype(st
-000684c0: 7229 0d0a 2020 2020 2020 2020 2020 2020  r)..            
-000684d0: 6474 5f61 6464 732e 6170 7065 6e64 2874  dt_adds.append(t
-000684e0: 7363 6f6c 2b27 5f64 6179 6f66 7765 656b  scol+'_dayofweek
-000684f0: 5f68 6f75 725f 6372 6f73 7327 290d 0a20  _hour_cross').. 
-00068500: 2020 2020 2020 2064 665b 7473 636f 6c2b         df[tscol+
-00068510: 275f 7175 6172 7465 7227 5d20 3d20 6466  '_quarter'] = df
-00068520: 5b74 7363 6f6c 5d2e 6474 2e71 7561 7274  [tscol].dt.quart
-00068530: 6572 2e66 696c 6c6e 6128 3029 2e61 7374  er.fillna(0).ast
-00068540: 7970 6528 696e 7429 0d0a 2020 2020 2020  ype(int)..      
-00068550: 2020 6474 5f61 6464 732e 6170 7065 6e64    dt_adds.append
-00068560: 2874 7363 6f6c 2b27 5f71 7561 7274 6572  (tscol+'_quarter
-00068570: 2729 0d0a 2020 2020 2020 2020 6466 5b74  ')..        df[t
-00068580: 7363 6f6c 2b27 5f6d 6f6e 7468 275d 203d  scol+'_month'] =
-00068590: 2064 665b 7473 636f 6c5d 2e64 742e 6d6f   df[tscol].dt.mo
-000685a0: 6e74 682e 6669 6c6c 6e61 2830 292e 6173  nth.fillna(0).as
-000685b0: 7479 7065 2869 6e74 290d 0a20 2020 2020  type(int)..     
-000685c0: 2020 204d 4f4e 5448 5320 3d20 6469 6374     MONTHS = dict
-000685d0: 287a 6970 2872 616e 6765 2831 2c31 3329  (zip(range(1,13)
-000685e0: 2c5b 274a 616e 272c 2027 4665 6227 2c20  ,['Jan', 'Feb', 
-000685f0: 274d 6172 272c 2027 4170 7227 2c20 274d  'Mar', 'Apr', 'M
-00068600: 6179 272c 2027 4a75 6e27 2c20 274a 756c  ay', 'Jun', 'Jul
-00068610: 272c 0d0a 2020 2020 2020 2020 2020 2020  ',..            
+00068060: 0d0a 6465 6620 6372 6561 7465 5f74 735f  ..def create_ts_
+00068070: 6665 6174 7572 6573 2864 662c 2074 7363  features(df, tsc
+00068080: 6f6c 293a 0d0a 2020 2020 2222 220d 0a20  ol):..    """.. 
+00068090: 2020 2054 6869 7320 7461 6b65 7320 696e     This takes in
+000680a0: 2069 6e70 7574 2061 2064 6174 6166 7261   input a datafra
+000680b0: 6d65 2061 6e64 2061 2064 6174 6520 7661  me and a date va
+000680c0: 7269 6162 6c65 2e0d 0a20 2020 2049 7420  riable...    It 
+000680d0: 7468 656e 2063 7265 6174 6573 2074 696d  then creates tim
+000680e0: 6520 7365 7269 6573 2066 6561 7475 7265  e series feature
+000680f0: 7320 7573 696e 6720 7468 6520 7061 6e64  s using the pand
+00068100: 6173 202e 6474 2e77 6565 6b64 6179 206b  as .dt.weekday k
+00068110: 696e 6420 6f66 2073 796e 7461 782e 0d0a  ind of syntax...
+00068120: 2020 2020 4974 2061 6c73 6f20 7265 7475      It also retu
+00068130: 726e 7320 7468 6520 6461 7461 2066 7261  rns the data fra
+00068140: 6d65 206f 6620 6164 6465 6420 6665 6174  me of added feat
+00068150: 7572 6573 2077 6974 6820 6561 6368 2076  ures with each v
+00068160: 6172 6961 626c 6520 6173 2061 6e20 696e  ariable as an in
+00068170: 7465 6765 7220 7661 7269 6162 6c65 2e0d  teger variable..
+00068180: 0a20 2020 2022 2222 0d0a 2020 2020 6466  .    """..    df
+00068190: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
+000681a0: 2864 6629 0d0a 2020 2020 6474 5f61 6464  (df)..    dt_add
+000681b0: 7320 3d20 5b5d 0d0a 2020 2020 7472 793a  s = []..    try:
+000681c0: 0d0a 2020 2020 2020 2020 6466 5b74 7363  ..        df[tsc
+000681d0: 6f6c 2b27 5f68 6f75 7227 5d20 3d20 6466  ol+'_hour'] = df
+000681e0: 5b74 7363 6f6c 5d2e 6474 2e68 6f75 722e  [tscol].dt.hour.
+000681f0: 6669 6c6c 6e61 2830 292e 6173 7479 7065  fillna(0).astype
+00068200: 2869 6e74 290d 0a20 2020 2020 2020 2064  (int)..        d
+00068210: 665b 7473 636f 6c2b 275f 6d69 6e75 7465  f[tscol+'_minute
+00068220: 275d 203d 2064 665b 7473 636f 6c5d 2e64  '] = df[tscol].d
+00068230: 742e 6d69 6e75 7465 2e66 696c 6c6e 6128  t.minute.fillna(
+00068240: 3029 2e61 7374 7970 6528 696e 7429 0d0a  0).astype(int)..
+00068250: 2020 2020 2020 2020 6474 5f61 6464 732e          dt_adds.
+00068260: 6170 7065 6e64 2874 7363 6f6c 2b27 5f68  append(tscol+'_h
+00068270: 6f75 7227 290d 0a20 2020 2020 2020 2064  our')..        d
+00068280: 745f 6164 6473 2e61 7070 656e 6428 7473  t_adds.append(ts
+00068290: 636f 6c2b 275f 6d69 6e75 7465 2729 0d0a  col+'_minute')..
+000682a0: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
+000682b0: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+000682c0: 4572 726f 7220 696e 2063 7265 6174 696e  Error in creatin
+000682d0: 6720 686f 7572 2d73 6563 6f6e 6420 6465  g hour-second de
+000682e0: 7269 7665 6420 6665 6174 7572 6573 2e20  rived features. 
+000682f0: 436f 6e74 696e 7569 6e67 2e2e 2e27 290d  Continuing...').
+00068300: 0a20 2020 2074 7279 3a0d 0a20 2020 2020  .    try:..     
+00068310: 2020 2064 665b 7473 636f 6c2b 275f 6461     df[tscol+'_da
+00068320: 796f 6677 6565 6b27 5d20 3d20 6466 5b74  yofweek'] = df[t
+00068330: 7363 6f6c 5d2e 6474 2e64 6179 6f66 7765  scol].dt.dayofwe
+00068340: 656b 2e66 696c 6c6e 6128 3029 2e61 7374  ek.fillna(0).ast
+00068350: 7970 6528 696e 7429 0d0a 2020 2020 2020  ype(int)..      
+00068360: 2020 6474 5f61 6464 732e 6170 7065 6e64    dt_adds.append
+00068370: 2874 7363 6f6c 2b27 5f64 6179 6f66 7765  (tscol+'_dayofwe
+00068380: 656b 2729 0d0a 2020 2020 2020 2020 6966  ek')..        if
+00068390: 2074 7363 6f6c 2b27 5f68 6f75 7227 2069   tscol+'_hour' i
+000683a0: 6e20 6474 5f61 6464 733a 0d0a 2020 2020  n dt_adds:..    
+000683b0: 2020 2020 2020 2020 4441 5953 203d 2064          DAYS = d
+000683c0: 6963 7428 7a69 7028 7261 6e67 6528 3729  ict(zip(range(7)
+000683d0: 2c5b 2753 756e 272c 2027 4d6f 6e27 2c20  ,['Sun', 'Mon', 
+000683e0: 2754 7565 272c 2027 5765 6427 2c20 2754  'Tue', 'Wed', 'T
+000683f0: 6875 272c 2027 4672 6927 2c20 2753 6174  hu', 'Fri', 'Sat
+00068400: 275d 2929 0d0a 2020 2020 2020 2020 2020  ']))..          
+00068410: 2020 6466 5b74 7363 6f6c 2b27 5f64 6179    df[tscol+'_day
+00068420: 6f66 7765 656b 275d 203d 2064 665b 7473  ofweek'] = df[ts
+00068430: 636f 6c2b 275f 6461 796f 6677 6565 6b27  col+'_dayofweek'
+00068440: 5d2e 6d61 7028 4441 5953 290d 0a20 2020  ].map(DAYS)..   
+00068450: 2020 2020 2020 2020 2064 662e 6c6f 635b           df.loc[
+00068460: 3a2c 7473 636f 6c2b 275f 6461 796f 6677  :,tscol+'_dayofw
+00068470: 6565 6b5f 686f 7572 5f63 726f 7373 275d  eek_hour_cross']
+00068480: 203d 2064 665b 7473 636f 6c2b 275f 6461   = df[tscol+'_da
+00068490: 796f 6677 6565 6b27 5d20 2b22 2022 2b20  yofweek'] +" "+ 
+000684a0: 6466 5b74 7363 6f6c 2b27 5f68 6f75 7227  df[tscol+'_hour'
+000684b0: 5d2e 6173 7479 7065 2873 7472 290d 0a20  ].astype(str).. 
+000684c0: 2020 2020 2020 2020 2020 2064 745f 6164             dt_ad
+000684d0: 6473 2e61 7070 656e 6428 7473 636f 6c2b  ds.append(tscol+
+000684e0: 275f 6461 796f 6677 6565 6b5f 686f 7572  '_dayofweek_hour
+000684f0: 5f63 726f 7373 2729 0d0a 2020 2020 2020  _cross')..      
+00068500: 2020 6466 5b74 7363 6f6c 2b27 5f71 7561    df[tscol+'_qua
+00068510: 7274 6572 275d 203d 2064 665b 7473 636f  rter'] = df[tsco
+00068520: 6c5d 2e64 742e 7175 6172 7465 722e 6669  l].dt.quarter.fi
+00068530: 6c6c 6e61 2830 292e 6173 7479 7065 2869  llna(0).astype(i
+00068540: 6e74 290d 0a20 2020 2020 2020 2064 745f  nt)..        dt_
+00068550: 6164 6473 2e61 7070 656e 6428 7473 636f  adds.append(tsco
+00068560: 6c2b 275f 7175 6172 7465 7227 290d 0a20  l+'_quarter').. 
+00068570: 2020 2020 2020 2064 665b 7473 636f 6c2b         df[tscol+
+00068580: 275f 6d6f 6e74 6827 5d20 3d20 6466 5b74  '_month'] = df[t
+00068590: 7363 6f6c 5d2e 6474 2e6d 6f6e 7468 2e66  scol].dt.month.f
+000685a0: 696c 6c6e 6128 3029 2e61 7374 7970 6528  illna(0).astype(
+000685b0: 696e 7429 0d0a 2020 2020 2020 2020 4d4f  int)..        MO
+000685c0: 4e54 4853 203d 2064 6963 7428 7a69 7028  NTHS = dict(zip(
+000685d0: 7261 6e67 6528 312c 3133 292c 5b27 4a61  range(1,13),['Ja
+000685e0: 6e27 2c20 2746 6562 272c 2027 4d61 7227  n', 'Feb', 'Mar'
+000685f0: 2c20 2741 7072 272c 2027 4d61 7927 2c20  , 'Apr', 'May', 
+00068600: 274a 756e 272c 2027 4a75 6c27 2c0d 0a20  'Jun', 'Jul',.. 
+00068610: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00068620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00068630: 2020 2020 2020 2020 2741 7567 272c 2027          'Aug', '
-00068640: 5365 7027 2c20 274f 6374 272c 2027 4e6f  Sep', 'Oct', 'No
-00068650: 7627 2c20 2744 6563 275d 2929 0d0a 2020  v', 'Dec']))..  
-00068660: 2020 2020 2020 6466 5b74 7363 6f6c 2b27        df[tscol+'
-00068670: 5f6d 6f6e 7468 275d 203d 2064 665b 7473  _month'] = df[ts
-00068680: 636f 6c2b 275f 6d6f 6e74 6827 5d2e 6d61  col+'_month'].ma
-00068690: 7028 4d4f 4e54 4853 290d 0a20 2020 2020  p(MONTHS)..     
-000686a0: 2020 2064 745f 6164 6473 2e61 7070 656e     dt_adds.appen
-000686b0: 6428 7473 636f 6c2b 275f 6d6f 6e74 6827  d(tscol+'_month'
-000686c0: 290d 0a20 2020 2020 2020 2023 2323 2320  )..        #### 
-000686d0: 4164 6420 736f 6d65 2066 6561 7475 7265  Add some feature
-000686e0: 7320 666f 7220 6d6f 6e74 6873 2023 2323  s for months ###
+00068630: 2020 2027 4175 6727 2c20 2753 6570 272c     'Aug', 'Sep',
+00068640: 2027 4f63 7427 2c20 274e 6f76 272c 2027   'Oct', 'Nov', '
+00068650: 4465 6327 5d29 290d 0a20 2020 2020 2020  Dec']))..       
+00068660: 2064 665b 7473 636f 6c2b 275f 6d6f 6e74   df[tscol+'_mont
+00068670: 6827 5d20 3d20 6466 5b74 7363 6f6c 2b27  h'] = df[tscol+'
+00068680: 5f6d 6f6e 7468 275d 2e6d 6170 284d 4f4e  _month'].map(MON
+00068690: 5448 5329 0d0a 2020 2020 2020 2020 6474  THS)..        dt
+000686a0: 5f61 6464 732e 6170 7065 6e64 2874 7363  _adds.append(tsc
+000686b0: 6f6c 2b27 5f6d 6f6e 7468 2729 0d0a 2020  ol+'_month')..  
+000686c0: 2020 2020 2020 2323 2323 2041 6464 2073        #### Add s
+000686d0: 6f6d 6520 6665 6174 7572 6573 2066 6f72  ome features for
+000686e0: 206d 6f6e 7468 7320 2323 2323 2323 2323   months ########
 000686f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00068700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00068710: 2323 2323 230d 0a20 2020 2020 2020 2066  #####..        f
-00068720: 6573 7469 7665 7320 3d20 5b27 4f63 7427  estives = ['Oct'
-00068730: 2c27 4e6f 7627 2c27 4465 6327 5d0d 0a20  ,'Nov','Dec'].. 
-00068740: 2020 2020 2020 206e 616d 655f 636f 6c20         name_col 
-00068750: 3d20 7473 636f 6c2b 225f 6973 5f66 6573  = tscol+"_is_fes
-00068760: 7469 7665 220d 0a20 2020 2020 2020 2064  tive"..        d
-00068770: 665b 6e61 6d65 5f63 6f6c 5d20 3d20 300d  f[name_col] = 0.
-00068780: 0a20 2020 2020 2020 2064 665b 6e61 6d65  .        df[name
-00068790: 5f63 6f6c 5d20 3d20 6466 5b74 7363 6f6c  _col] = df[tscol
-000687a0: 2b27 5f6d 6f6e 7468 275d 2e6d 6170 286c  +'_month'].map(l
-000687b0: 616d 6264 6120 783a 2031 2069 6620 7820  ambda x: 1 if x 
-000687c0: 696e 2066 6573 7469 7665 7320 656c 7365  in festives else
-000687d0: 2030 292e 7661 6c75 6573 0d0a 2020 2020   0).values..    
-000687e0: 2020 2020 2323 2320 5265 6d65 6d62 6572      ### Remember
-000687f0: 2074 6861 7420 6669 6c6c 6e61 206f 6e6c   that fillna onl
-00068800: 7920 776f 726b 7320 6174 2064 6174 6166  y works at dataf
-00068810: 7261 6d65 206c 6576 656c 2120 2323 230d  rame level! ###.
-00068820: 0a20 2020 2020 2020 2064 665b 5b6e 616d  .        df[[nam
-00068830: 655f 636f 6c5d 5d20 3d20 6466 5b5b 6e61  e_col]] = df[[na
-00068840: 6d65 5f63 6f6c 5d5d 2e66 696c 6c6e 6128  me_col]].fillna(
-00068850: 3029 0d0a 2020 2020 2020 2020 6474 5f61  0)..        dt_a
-00068860: 6464 732e 6170 7065 6e64 286e 616d 655f  dds.append(name_
-00068870: 636f 6c29 0d0a 2020 2020 2020 2020 7375  col)..        su
-00068880: 6d6d 6572 203d 205b 274a 756e 272c 274a  mmer = ['Jun','J
-00068890: 756c 272c 2741 7567 275d 0d0a 2020 2020  ul','Aug']..    
-000688a0: 2020 2020 6e61 6d65 5f63 6f6c 203d 2074      name_col = t
-000688b0: 7363 6f6c 2b22 5f69 735f 7375 6d6d 6572  scol+"_is_summer
-000688c0: 220d 0a20 2020 2020 2020 2064 665b 6e61  "..        df[na
-000688d0: 6d65 5f63 6f6c 5d20 3d20 300d 0a20 2020  me_col] = 0..   
-000688e0: 2020 2020 2064 665b 6e61 6d65 5f63 6f6c       df[name_col
-000688f0: 5d20 3d20 6466 5b74 7363 6f6c 2b27 5f6d  ] = df[tscol+'_m
-00068900: 6f6e 7468 275d 2e6d 6170 286c 616d 6264  onth'].map(lambd
-00068910: 6120 783a 2031 2069 6620 7820 696e 2073  a x: 1 if x in s
-00068920: 756d 6d65 7220 656c 7365 2030 292e 7661  ummer else 0).va
-00068930: 6c75 6573 0d0a 2020 2020 2020 2020 2323  lues..        ##
-00068940: 2320 5265 6d65 6d62 6572 2074 6861 7420  # Remember that 
-00068950: 6669 6c6c 6e61 206f 6e6c 7920 776f 726b  fillna only work
-00068960: 7320 6174 2064 6174 6166 7261 6d65 206c  s at dataframe l
-00068970: 6576 656c 2120 2323 230d 0a20 2020 2020  evel! ###..     
-00068980: 2020 2064 665b 5b6e 616d 655f 636f 6c5d     df[[name_col]
-00068990: 5d20 3d20 6466 5b5b 6e61 6d65 5f63 6f6c  ] = df[[name_col
-000689a0: 5d5d 2e66 696c 6c6e 6128 3029 0d0a 2020  ]].fillna(0)..  
-000689b0: 2020 2020 2020 6474 5f61 6464 732e 6170        dt_adds.ap
-000689c0: 7065 6e64 286e 616d 655f 636f 6c29 0d0a  pend(name_col)..
-000689d0: 2020 2020 2020 2020 7769 6e74 6572 203d          winter =
-000689e0: 205b 2744 6563 272c 274a 616e 272c 2746   ['Dec','Jan','F
-000689f0: 6562 275d 0d0a 2020 2020 2020 2020 6e61  eb']..        na
-00068a00: 6d65 5f63 6f6c 203d 2074 7363 6f6c 2b22  me_col = tscol+"
-00068a10: 5f69 735f 7769 6e74 6572 220d 0a20 2020  _is_winter"..   
-00068a20: 2020 2020 2064 665b 6e61 6d65 5f63 6f6c       df[name_col
-00068a30: 5d20 3d20 300d 0a20 2020 2020 2020 2064  ] = 0..        d
-00068a40: 665b 6e61 6d65 5f63 6f6c 5d20 3d20 6466  f[name_col] = df
-00068a50: 5b74 7363 6f6c 2b27 5f6d 6f6e 7468 275d  [tscol+'_month']
-00068a60: 2e6d 6170 286c 616d 6264 6120 783a 2031  .map(lambda x: 1
-00068a70: 2069 6620 7820 696e 2077 696e 7465 7220   if x in winter 
-00068a80: 656c 7365 2030 292e 7661 6c75 6573 0d0a  else 0).values..
-00068a90: 2020 2020 2020 2020 2323 2320 5265 6d65          ### Reme
-00068aa0: 6d62 6572 2074 6861 7420 6669 6c6c 6e61  mber that fillna
-00068ab0: 206f 6e6c 7920 776f 726b 7320 6174 2064   only works at d
-00068ac0: 6174 6166 7261 6d65 206c 6576 656c 2120  ataframe level! 
-00068ad0: 2323 230d 0a20 2020 2020 2020 2064 665b  ###..        df[
-00068ae0: 5b6e 616d 655f 636f 6c5d 5d20 3d20 6466  [name_col]] = df
-00068af0: 5b5b 6e61 6d65 5f63 6f6c 5d5d 2e66 696c  [[name_col]].fil
-00068b00: 6c6e 6128 3029 0d0a 2020 2020 2020 2020  lna(0)..        
-00068b10: 6474 5f61 6464 732e 6170 7065 6e64 286e  dt_adds.append(n
-00068b20: 616d 655f 636f 6c29 0d0a 2020 2020 2020  ame_col)..      
-00068b30: 2020 636f 6c64 203d 205b 274f 6374 272c    cold = ['Oct',
-00068b40: 274e 6f76 272c 2744 6563 272c 274a 616e  'Nov','Dec','Jan
-00068b50: 272c 2746 6562 272c 274d 6172 275d 0d0a  ','Feb','Mar']..
-00068b60: 2020 2020 2020 2020 6e61 6d65 5f63 6f6c          name_col
-00068b70: 203d 2074 7363 6f6c 2b22 5f69 735f 636f   = tscol+"_is_co
-00068b80: 6c64 220d 0a20 2020 2020 2020 2064 665b  ld"..        df[
-00068b90: 6e61 6d65 5f63 6f6c 5d20 3d20 300d 0a20  name_col] = 0.. 
-00068ba0: 2020 2020 2020 2064 665b 6e61 6d65 5f63         df[name_c
-00068bb0: 6f6c 5d20 3d20 6466 5b74 7363 6f6c 2b27  ol] = df[tscol+'
-00068bc0: 5f6d 6f6e 7468 275d 2e6d 6170 286c 616d  _month'].map(lam
-00068bd0: 6264 6120 783a 2031 2069 6620 7820 696e  bda x: 1 if x in
-00068be0: 2063 6f6c 6420 656c 7365 2030 292e 7661   cold else 0).va
-00068bf0: 6c75 6573 0d0a 2020 2020 2020 2020 2323  lues..        ##
-00068c00: 2320 5265 6d65 6d62 6572 2074 6861 7420  # Remember that 
-00068c10: 6669 6c6c 6e61 206f 6e6c 7920 776f 726b  fillna only work
-00068c20: 7320 6174 2064 6174 6166 7261 6d65 206c  s at dataframe l
-00068c30: 6576 656c 2120 2323 230d 0a20 2020 2020  evel! ###..     
-00068c40: 2020 2064 665b 5b6e 616d 655f 636f 6c5d     df[[name_col]
-00068c50: 5d20 3d20 6466 5b5b 6e61 6d65 5f63 6f6c  ] = df[[name_col
-00068c60: 5d5d 2e66 696c 6c6e 6128 3029 0d0a 2020  ]].fillna(0)..  
-00068c70: 2020 2020 2020 6474 5f61 6464 732e 6170        dt_adds.ap
-00068c80: 7065 6e64 286e 616d 655f 636f 6c29 0d0a  pend(name_col)..
-00068c90: 2020 2020 2020 2020 7761 726d 203d 205b          warm = [
-00068ca0: 2741 7072 272c 274d 6179 272c 274a 756e  'Apr','May','Jun
-00068cb0: 272c 274a 756c 272c 2741 7567 272c 2753  ','Jul','Aug','S
-00068cc0: 6570 275d 0d0a 2020 2020 2020 2020 6e61  ep']..        na
-00068cd0: 6d65 5f63 6f6c 203d 2074 7363 6f6c 2b22  me_col = tscol+"
-00068ce0: 5f69 735f 7761 726d 220d 0a20 2020 2020  _is_warm"..     
-00068cf0: 2020 2064 665b 6e61 6d65 5f63 6f6c 5d20     df[name_col] 
-00068d00: 3d20 300d 0a20 2020 2020 2020 2064 665b  = 0..        df[
-00068d10: 6e61 6d65 5f63 6f6c 5d20 3d20 6466 5b74  name_col] = df[t
-00068d20: 7363 6f6c 2b27 5f6d 6f6e 7468 275d 2e6d  scol+'_month'].m
-00068d30: 6170 286c 616d 6264 6120 783a 2031 2069  ap(lambda x: 1 i
-00068d40: 6620 7820 696e 2077 6172 6d20 656c 7365  f x in warm else
-00068d50: 2030 292e 7661 6c75 6573 0d0a 2020 2020   0).values..    
-00068d60: 2020 2020 6466 5b5b 6e61 6d65 5f63 6f6c      df[[name_col
-00068d70: 5d5d 203d 2064 665b 5b6e 616d 655f 636f  ]] = df[[name_co
-00068d80: 6c5d 5d2e 6669 6c6c 6e61 2830 290d 0a20  l]].fillna(0).. 
-00068d90: 2020 2020 2020 2064 745f 6164 6473 2e61         dt_adds.a
-00068da0: 7070 656e 6428 6e61 6d65 5f63 6f6c 290d  ppend(name_col).
-00068db0: 0a20 2020 2020 2020 2023 2323 2323 2323  .        #######
+00068710: 0d0a 2020 2020 2020 2020 6665 7374 6976  ..        festiv
+00068720: 6573 203d 205b 274f 6374 272c 274e 6f76  es = ['Oct','Nov
+00068730: 272c 2744 6563 275d 0d0a 2020 2020 2020  ','Dec']..      
+00068740: 2020 6e61 6d65 5f63 6f6c 203d 2074 7363    name_col = tsc
+00068750: 6f6c 2b22 5f69 735f 6665 7374 6976 6522  ol+"_is_festive"
+00068760: 0d0a 2020 2020 2020 2020 6466 5b6e 616d  ..        df[nam
+00068770: 655f 636f 6c5d 203d 2030 0d0a 2020 2020  e_col] = 0..    
+00068780: 2020 2020 6466 5b6e 616d 655f 636f 6c5d      df[name_col]
+00068790: 203d 2064 665b 7473 636f 6c2b 275f 6d6f   = df[tscol+'_mo
+000687a0: 6e74 6827 5d2e 6d61 7028 6c61 6d62 6461  nth'].map(lambda
+000687b0: 2078 3a20 3120 6966 2078 2069 6e20 6665   x: 1 if x in fe
+000687c0: 7374 6976 6573 2065 6c73 6520 3029 2e76  stives else 0).v
+000687d0: 616c 7565 730d 0a20 2020 2020 2020 2023  alues..        #
+000687e0: 2323 2052 656d 656d 6265 7220 7468 6174  ## Remember that
+000687f0: 2066 696c 6c6e 6120 6f6e 6c79 2077 6f72   fillna only wor
+00068800: 6b73 2061 7420 6461 7461 6672 616d 6520  ks at dataframe 
+00068810: 6c65 7665 6c21 2023 2323 0d0a 2020 2020  level! ###..    
+00068820: 2020 2020 6466 5b5b 6e61 6d65 5f63 6f6c      df[[name_col
+00068830: 5d5d 203d 2064 665b 5b6e 616d 655f 636f  ]] = df[[name_co
+00068840: 6c5d 5d2e 6669 6c6c 6e61 2830 290d 0a20  l]].fillna(0).. 
+00068850: 2020 2020 2020 2064 745f 6164 6473 2e61         dt_adds.a
+00068860: 7070 656e 6428 6e61 6d65 5f63 6f6c 290d  ppend(name_col).
+00068870: 0a20 2020 2020 2020 2073 756d 6d65 7220  .        summer 
+00068880: 3d20 5b27 4a75 6e27 2c27 4a75 6c27 2c27  = ['Jun','Jul','
+00068890: 4175 6727 5d0d 0a20 2020 2020 2020 206e  Aug']..        n
+000688a0: 616d 655f 636f 6c20 3d20 7473 636f 6c2b  ame_col = tscol+
+000688b0: 225f 6973 5f73 756d 6d65 7222 0d0a 2020  "_is_summer"..  
+000688c0: 2020 2020 2020 6466 5b6e 616d 655f 636f        df[name_co
+000688d0: 6c5d 203d 2030 0d0a 2020 2020 2020 2020  l] = 0..        
+000688e0: 6466 5b6e 616d 655f 636f 6c5d 203d 2064  df[name_col] = d
+000688f0: 665b 7473 636f 6c2b 275f 6d6f 6e74 6827  f[tscol+'_month'
+00068900: 5d2e 6d61 7028 6c61 6d62 6461 2078 3a20  ].map(lambda x: 
+00068910: 3120 6966 2078 2069 6e20 7375 6d6d 6572  1 if x in summer
+00068920: 2065 6c73 6520 3029 2e76 616c 7565 730d   else 0).values.
+00068930: 0a20 2020 2020 2020 2023 2323 2052 656d  .        ### Rem
+00068940: 656d 6265 7220 7468 6174 2066 696c 6c6e  ember that filln
+00068950: 6120 6f6e 6c79 2077 6f72 6b73 2061 7420  a only works at 
+00068960: 6461 7461 6672 616d 6520 6c65 7665 6c21  dataframe level!
+00068970: 2023 2323 0d0a 2020 2020 2020 2020 6466   ###..        df
+00068980: 5b5b 6e61 6d65 5f63 6f6c 5d5d 203d 2064  [[name_col]] = d
+00068990: 665b 5b6e 616d 655f 636f 6c5d 5d2e 6669  f[[name_col]].fi
+000689a0: 6c6c 6e61 2830 290d 0a20 2020 2020 2020  llna(0)..       
+000689b0: 2064 745f 6164 6473 2e61 7070 656e 6428   dt_adds.append(
+000689c0: 6e61 6d65 5f63 6f6c 290d 0a20 2020 2020  name_col)..     
+000689d0: 2020 2077 696e 7465 7220 3d20 5b27 4465     winter = ['De
+000689e0: 6327 2c27 4a61 6e27 2c27 4665 6227 5d0d  c','Jan','Feb'].
+000689f0: 0a20 2020 2020 2020 206e 616d 655f 636f  .        name_co
+00068a00: 6c20 3d20 7473 636f 6c2b 225f 6973 5f77  l = tscol+"_is_w
+00068a10: 696e 7465 7222 0d0a 2020 2020 2020 2020  inter"..        
+00068a20: 6466 5b6e 616d 655f 636f 6c5d 203d 2030  df[name_col] = 0
+00068a30: 0d0a 2020 2020 2020 2020 6466 5b6e 616d  ..        df[nam
+00068a40: 655f 636f 6c5d 203d 2064 665b 7473 636f  e_col] = df[tsco
+00068a50: 6c2b 275f 6d6f 6e74 6827 5d2e 6d61 7028  l+'_month'].map(
+00068a60: 6c61 6d62 6461 2078 3a20 3120 6966 2078  lambda x: 1 if x
+00068a70: 2069 6e20 7769 6e74 6572 2065 6c73 6520   in winter else 
+00068a80: 3029 2e76 616c 7565 730d 0a20 2020 2020  0).values..     
+00068a90: 2020 2023 2323 2052 656d 656d 6265 7220     ### Remember 
+00068aa0: 7468 6174 2066 696c 6c6e 6120 6f6e 6c79  that fillna only
+00068ab0: 2077 6f72 6b73 2061 7420 6461 7461 6672   works at datafr
+00068ac0: 616d 6520 6c65 7665 6c21 2023 2323 0d0a  ame level! ###..
+00068ad0: 2020 2020 2020 2020 6466 5b5b 6e61 6d65          df[[name
+00068ae0: 5f63 6f6c 5d5d 203d 2064 665b 5b6e 616d  _col]] = df[[nam
+00068af0: 655f 636f 6c5d 5d2e 6669 6c6c 6e61 2830  e_col]].fillna(0
+00068b00: 290d 0a20 2020 2020 2020 2064 745f 6164  )..        dt_ad
+00068b10: 6473 2e61 7070 656e 6428 6e61 6d65 5f63  ds.append(name_c
+00068b20: 6f6c 290d 0a20 2020 2020 2020 2063 6f6c  ol)..        col
+00068b30: 6420 3d20 5b27 4f63 7427 2c27 4e6f 7627  d = ['Oct','Nov'
+00068b40: 2c27 4465 6327 2c27 4a61 6e27 2c27 4665  ,'Dec','Jan','Fe
+00068b50: 6227 2c27 4d61 7227 5d0d 0a20 2020 2020  b','Mar']..     
+00068b60: 2020 206e 616d 655f 636f 6c20 3d20 7473     name_col = ts
+00068b70: 636f 6c2b 225f 6973 5f63 6f6c 6422 0d0a  col+"_is_cold"..
+00068b80: 2020 2020 2020 2020 6466 5b6e 616d 655f          df[name_
+00068b90: 636f 6c5d 203d 2030 0d0a 2020 2020 2020  col] = 0..      
+00068ba0: 2020 6466 5b6e 616d 655f 636f 6c5d 203d    df[name_col] =
+00068bb0: 2064 665b 7473 636f 6c2b 275f 6d6f 6e74   df[tscol+'_mont
+00068bc0: 6827 5d2e 6d61 7028 6c61 6d62 6461 2078  h'].map(lambda x
+00068bd0: 3a20 3120 6966 2078 2069 6e20 636f 6c64  : 1 if x in cold
+00068be0: 2065 6c73 6520 3029 2e76 616c 7565 730d   else 0).values.
+00068bf0: 0a20 2020 2020 2020 2023 2323 2052 656d  .        ### Rem
+00068c00: 656d 6265 7220 7468 6174 2066 696c 6c6e  ember that filln
+00068c10: 6120 6f6e 6c79 2077 6f72 6b73 2061 7420  a only works at 
+00068c20: 6461 7461 6672 616d 6520 6c65 7665 6c21  dataframe level!
+00068c30: 2023 2323 0d0a 2020 2020 2020 2020 6466   ###..        df
+00068c40: 5b5b 6e61 6d65 5f63 6f6c 5d5d 203d 2064  [[name_col]] = d
+00068c50: 665b 5b6e 616d 655f 636f 6c5d 5d2e 6669  f[[name_col]].fi
+00068c60: 6c6c 6e61 2830 290d 0a20 2020 2020 2020  llna(0)..       
+00068c70: 2064 745f 6164 6473 2e61 7070 656e 6428   dt_adds.append(
+00068c80: 6e61 6d65 5f63 6f6c 290d 0a20 2020 2020  name_col)..     
+00068c90: 2020 2077 6172 6d20 3d20 5b27 4170 7227     warm = ['Apr'
+00068ca0: 2c27 4d61 7927 2c27 4a75 6e27 2c27 4a75  ,'May','Jun','Ju
+00068cb0: 6c27 2c27 4175 6727 2c27 5365 7027 5d0d  l','Aug','Sep'].
+00068cc0: 0a20 2020 2020 2020 206e 616d 655f 636f  .        name_co
+00068cd0: 6c20 3d20 7473 636f 6c2b 225f 6973 5f77  l = tscol+"_is_w
+00068ce0: 6172 6d22 0d0a 2020 2020 2020 2020 6466  arm"..        df
+00068cf0: 5b6e 616d 655f 636f 6c5d 203d 2030 0d0a  [name_col] = 0..
+00068d00: 2020 2020 2020 2020 6466 5b6e 616d 655f          df[name_
+00068d10: 636f 6c5d 203d 2064 665b 7473 636f 6c2b  col] = df[tscol+
+00068d20: 275f 6d6f 6e74 6827 5d2e 6d61 7028 6c61  '_month'].map(la
+00068d30: 6d62 6461 2078 3a20 3120 6966 2078 2069  mbda x: 1 if x i
+00068d40: 6e20 7761 726d 2065 6c73 6520 3029 2e76  n warm else 0).v
+00068d50: 616c 7565 730d 0a20 2020 2020 2020 2064  alues..        d
+00068d60: 665b 5b6e 616d 655f 636f 6c5d 5d20 3d20  f[[name_col]] = 
+00068d70: 6466 5b5b 6e61 6d65 5f63 6f6c 5d5d 2e66  df[[name_col]].f
+00068d80: 696c 6c6e 6128 3029 0d0a 2020 2020 2020  illna(0)..      
+00068d90: 2020 6474 5f61 6464 732e 6170 7065 6e64    dt_adds.append
+00068da0: 286e 616d 655f 636f 6c29 0d0a 2020 2020  (name_col)..    
+00068db0: 2020 2020 2323 2323 2323 2323 2323 2323      ############
 00068dc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00068dd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00068de0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00068df0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00068e00: 2323 0d0a 2020 2020 2020 2020 6966 2074  ##..        if t
-00068e10: 7363 6f6c 2b27 5f64 6179 6f66 7765 656b  scol+'_dayofweek
-00068e20: 2720 696e 2064 745f 6164 6473 3a0d 0a20  ' in dt_adds:.. 
-00068e30: 2020 2020 2020 2020 2020 2064 662e 6c6f             df.lo
-00068e40: 635b 3a2c 7473 636f 6c2b 275f 6d6f 6e74  c[:,tscol+'_mont
-00068e50: 685f 6461 796f 6677 6565 6b5f 6372 6f73  h_dayofweek_cros
-00068e60: 7327 5d20 3d20 6466 5b74 7363 6f6c 2b27  s'] = df[tscol+'
-00068e70: 5f6d 6f6e 7468 275d 202b 2220 222b 2064  _month'] +" "+ d
-00068e80: 665b 7473 636f 6c2b 275f 6461 796f 6677  f[tscol+'_dayofw
-00068e90: 6565 6b27 5d0d 0a20 2020 2020 2020 2020  eek']..         
-00068ea0: 2020 2064 745f 6164 6473 2e61 7070 656e     dt_adds.appen
-00068eb0: 6428 7473 636f 6c2b 275f 6d6f 6e74 685f  d(tscol+'_month_
-00068ec0: 6461 796f 6677 6565 6b5f 6372 6f73 7327  dayofweek_cross'
-00068ed0: 290d 0a20 2020 2020 2020 2064 665b 7473  )..        df[ts
-00068ee0: 636f 6c2b 275f 7965 6172 275d 203d 2064  col+'_year'] = d
-00068ef0: 665b 7473 636f 6c5d 2e64 742e 7965 6172  f[tscol].dt.year
-00068f00: 2e66 696c 6c6e 6128 3029 2e61 7374 7970  .fillna(0).astyp
-00068f10: 6528 696e 7429 0d0a 2020 2020 2020 2020  e(int)..        
-00068f20: 6474 5f61 6464 732e 6170 7065 6e64 2874  dt_adds.append(t
-00068f30: 7363 6f6c 2b27 5f79 6561 7227 290d 0a20  scol+'_year').. 
-00068f40: 2020 2020 2020 2074 6f64 6179 203d 2064         today = d
-00068f50: 6174 652e 746f 6461 7928 290d 0a20 2020  ate.today()..   
-00068f60: 2020 2020 2064 665b 7473 636f 6c2b 275f       df[tscol+'_
-00068f70: 6167 655f 696e 5f79 6561 7273 275d 203d  age_in_years'] =
-00068f80: 2074 6f64 6179 2e79 6561 7220 2d20 6466   today.year - df
-00068f90: 5b74 7363 6f6c 5d2e 6474 2e79 6561 722e  [tscol].dt.year.
-00068fa0: 6669 6c6c 6e61 2830 292e 6173 7479 7065  fillna(0).astype
-00068fb0: 2869 6e74 290d 0a20 2020 2020 2020 2064  (int)..        d
-00068fc0: 745f 6164 6473 2e61 7070 656e 6428 7473  t_adds.append(ts
-00068fd0: 636f 6c2b 275f 6167 655f 696e 5f79 6561  col+'_age_in_yea
-00068fe0: 7273 2729 0d0a 2020 2020 2020 2020 6466  rs')..        df
-00068ff0: 5b74 7363 6f6c 2b27 5f64 6179 6f66 7965  [tscol+'_dayofye
-00069000: 6172 275d 203d 2064 665b 7473 636f 6c5d  ar'] = df[tscol]
-00069010: 2e64 742e 6461 796f 6679 6561 722e 6669  .dt.dayofyear.fi
-00069020: 6c6c 6e61 2830 292e 6173 7479 7065 2869  llna(0).astype(i
-00069030: 6e74 290d 0a20 2020 2020 2020 2064 745f  nt)..        dt_
-00069040: 6164 6473 2e61 7070 656e 6428 7473 636f  adds.append(tsco
-00069050: 6c2b 275f 6461 796f 6679 6561 7227 290d  l+'_dayofyear').
-00069060: 0a20 2020 2020 2020 2064 665b 7473 636f  .        df[tsco
-00069070: 6c2b 275f 6461 796f 666d 6f6e 7468 275d  l+'_dayofmonth']
-00069080: 203d 2064 665b 7473 636f 6c5d 2e64 742e   = df[tscol].dt.
-00069090: 6461 792e 6669 6c6c 6e61 2830 292e 6173  day.fillna(0).as
-000690a0: 7479 7065 2869 6e74 290d 0a20 2020 2020  type(int)..     
-000690b0: 2020 2064 745f 6164 6473 2e61 7070 656e     dt_adds.appen
-000690c0: 6428 7473 636f 6c2b 275f 6461 796f 666d  d(tscol+'_dayofm
-000690d0: 6f6e 7468 2729 0d0a 2020 2020 2020 2020  onth')..        
-000690e0: 6466 5b74 7363 6f6c 2b27 5f77 6565 6b6f  df[tscol+'_weeko
-000690f0: 6679 6561 7227 5d20 3d20 6466 5b74 7363  fyear'] = df[tsc
-00069100: 6f6c 5d2e 6474 2e77 6565 6b6f 6679 6561  ol].dt.weekofyea
-00069110: 722e 6669 6c6c 6e61 2830 292e 6173 7479  r.fillna(0).asty
-00069120: 7065 2869 6e74 290d 0a20 2020 2020 2020  pe(int)..       
-00069130: 2064 745f 6164 6473 2e61 7070 656e 6428   dt_adds.append(
-00069140: 7473 636f 6c2b 275f 7765 656b 6f66 7965  tscol+'_weekofye
-00069150: 6172 2729 0d0a 2020 2020 2020 2020 7765  ar')..        we
-00069160: 656b 656e 6473 203d 2028 6466 5b74 7363  ekends = (df[tsc
-00069170: 6f6c 2b27 5f64 6179 6f66 7765 656b 275d  ol+'_dayofweek']
-00069180: 203d 3d20 2753 6174 2729 207c 2028 6466   == 'Sat') | (df
-00069190: 5b74 7363 6f6c 2b27 5f64 6179 6f66 7765  [tscol+'_dayofwe
-000691a0: 656b 275d 203d 3d20 2753 756e 2729 0d0a  ek'] == 'Sun')..
-000691b0: 2020 2020 2020 2020 6466 5b74 7363 6f6c          df[tscol
-000691c0: 2b27 5f74 7970 656f 6664 6179 275d 203d  +'_typeofday'] =
-000691d0: 2027 7765 656b 6461 7927 0d0a 2020 2020   'weekday'..    
-000691e0: 2020 2020 6466 2e6c 6f63 5b77 6565 6b65      df.loc[weeke
-000691f0: 6e64 732c 2074 7363 6f6c 2b27 5f74 7970  nds, tscol+'_typ
-00069200: 656f 6664 6179 275d 203d 2027 7765 656b  eofday'] = 'week
-00069210: 656e 6427 0d0a 2020 2020 2020 2020 6474  end'..        dt
-00069220: 5f61 6464 732e 6170 7065 6e64 2874 7363  _adds.append(tsc
-00069230: 6f6c 2b27 5f74 7970 656f 6664 6179 2729  ol+'_typeofday')
-00069240: 0d0a 2020 2020 2020 2020 6966 2074 7363  ..        if tsc
-00069250: 6f6c 2b27 5f74 7970 656f 6664 6179 2720  ol+'_typeofday' 
-00069260: 696e 2064 745f 6164 6473 3a0d 0a20 2020  in dt_adds:..   
-00069270: 2020 2020 2020 2020 2064 662e 6c6f 635b           df.loc[
-00069280: 3a2c 7473 636f 6c2b 275f 6d6f 6e74 685f  :,tscol+'_month_
-00069290: 7479 7065 6f66 6461 795f 6372 6f73 7327  typeofday_cross'
-000692a0: 5d20 3d20 6466 5b74 7363 6f6c 2b27 5f6d  ] = df[tscol+'_m
-000692b0: 6f6e 7468 275d 202b 2220 222b 2064 665b  onth'] +" "+ df[
-000692c0: 7473 636f 6c2b 275f 7479 7065 6f66 6461  tscol+'_typeofda
-000692d0: 7927 5d0d 0a20 2020 2020 2020 2020 2020  y']..           
-000692e0: 2064 745f 6164 6473 2e61 7070 656e 6428   dt_adds.append(
-000692f0: 7473 636f 6c2b 275f 6d6f 6e74 685f 7479  tscol+'_month_ty
-00069300: 7065 6f66 6461 795f 6372 6f73 7327 290d  peofday_cross').
-00069310: 0a20 2020 2065 7863 6570 743a 0d0a 2020  .    except:..  
-00069320: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-00069330: 2045 7272 6f72 2069 6e20 6372 6561 7469   Error in creati
-00069340: 6e67 2064 6174 6520 7469 6d65 2064 6572  ng date time der
-00069350: 6976 6564 2066 6561 7475 7265 732e 2043  ived features. C
-00069360: 6f6e 7469 6e75 696e 672e 2e2e 2729 0d0a  ontinuing...')..
-00069370: 2020 2020 7072 696e 7428 2720 2020 2041      print('    A
-00069380: 6464 6564 2025 6420 636f 6c75 6d6e 7320  dded %d columns 
-00069390: 6672 6f6d 2025 7320 636f 6c75 6d6e 2720  from %s column' 
-000693a0: 2528 6c65 6e28 6474 5f61 6464 7329 2c74  %(len(dt_adds),t
-000693b0: 7363 6f6c 2929 0d0a 2020 2020 6466 203d  scol))..    df =
-000693c0: 2064 665b 6474 5f61 6464 735d 0d0a 2020   df[dt_adds]..  
-000693d0: 2020 7265 7475 726e 2064 660d 0a23 2323    return df..###
+00068df0: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
+00068e00: 2020 2020 2020 2069 6620 7473 636f 6c2b         if tscol+
+00068e10: 275f 6461 796f 6677 6565 6b27 2069 6e20  '_dayofweek' in 
+00068e20: 6474 5f61 6464 733a 0d0a 2020 2020 2020  dt_adds:..      
+00068e30: 2020 2020 2020 6466 2e6c 6f63 5b3a 2c74        df.loc[:,t
+00068e40: 7363 6f6c 2b27 5f6d 6f6e 7468 5f64 6179  scol+'_month_day
+00068e50: 6f66 7765 656b 5f63 726f 7373 275d 203d  ofweek_cross'] =
+00068e60: 2064 665b 7473 636f 6c2b 275f 6d6f 6e74   df[tscol+'_mont
+00068e70: 6827 5d20 2b22 2022 2b20 6466 5b74 7363  h'] +" "+ df[tsc
+00068e80: 6f6c 2b27 5f64 6179 6f66 7765 656b 275d  ol+'_dayofweek']
+00068e90: 0d0a 2020 2020 2020 2020 2020 2020 6474  ..            dt
+00068ea0: 5f61 6464 732e 6170 7065 6e64 2874 7363  _adds.append(tsc
+00068eb0: 6f6c 2b27 5f6d 6f6e 7468 5f64 6179 6f66  ol+'_month_dayof
+00068ec0: 7765 656b 5f63 726f 7373 2729 0d0a 2020  week_cross')..  
+00068ed0: 2020 2020 2020 6466 5b74 7363 6f6c 2b27        df[tscol+'
+00068ee0: 5f79 6561 7227 5d20 3d20 6466 5b74 7363  _year'] = df[tsc
+00068ef0: 6f6c 5d2e 6474 2e79 6561 722e 6669 6c6c  ol].dt.year.fill
+00068f00: 6e61 2830 292e 6173 7479 7065 2869 6e74  na(0).astype(int
+00068f10: 290d 0a20 2020 2020 2020 2064 745f 6164  )..        dt_ad
+00068f20: 6473 2e61 7070 656e 6428 7473 636f 6c2b  ds.append(tscol+
+00068f30: 275f 7965 6172 2729 0d0a 2020 2020 2020  '_year')..      
+00068f40: 2020 746f 6461 7920 3d20 6461 7465 2e74    today = date.t
+00068f50: 6f64 6179 2829 0d0a 2020 2020 2020 2020  oday()..        
+00068f60: 6466 5b74 7363 6f6c 2b27 5f61 6765 5f69  df[tscol+'_age_i
+00068f70: 6e5f 7965 6172 7327 5d20 3d20 746f 6461  n_years'] = toda
+00068f80: 792e 7965 6172 202d 2064 665b 7473 636f  y.year - df[tsco
+00068f90: 6c5d 2e64 742e 7965 6172 2e66 696c 6c6e  l].dt.year.filln
+00068fa0: 6128 3029 2e61 7374 7970 6528 696e 7429  a(0).astype(int)
+00068fb0: 0d0a 2020 2020 2020 2020 6474 5f61 6464  ..        dt_add
+00068fc0: 732e 6170 7065 6e64 2874 7363 6f6c 2b27  s.append(tscol+'
+00068fd0: 5f61 6765 5f69 6e5f 7965 6172 7327 290d  _age_in_years').
+00068fe0: 0a20 2020 2020 2020 2064 665b 7473 636f  .        df[tsco
+00068ff0: 6c2b 275f 6461 796f 6679 6561 7227 5d20  l+'_dayofyear'] 
+00069000: 3d20 6466 5b74 7363 6f6c 5d2e 6474 2e64  = df[tscol].dt.d
+00069010: 6179 6f66 7965 6172 2e66 696c 6c6e 6128  ayofyear.fillna(
+00069020: 3029 2e61 7374 7970 6528 696e 7429 0d0a  0).astype(int)..
+00069030: 2020 2020 2020 2020 6474 5f61 6464 732e          dt_adds.
+00069040: 6170 7065 6e64 2874 7363 6f6c 2b27 5f64  append(tscol+'_d
+00069050: 6179 6f66 7965 6172 2729 0d0a 2020 2020  ayofyear')..    
+00069060: 2020 2020 6466 5b74 7363 6f6c 2b27 5f64      df[tscol+'_d
+00069070: 6179 6f66 6d6f 6e74 6827 5d20 3d20 6466  ayofmonth'] = df
+00069080: 5b74 7363 6f6c 5d2e 6474 2e64 6179 2e66  [tscol].dt.day.f
+00069090: 696c 6c6e 6128 3029 2e61 7374 7970 6528  illna(0).astype(
+000690a0: 696e 7429 0d0a 2020 2020 2020 2020 6474  int)..        dt
+000690b0: 5f61 6464 732e 6170 7065 6e64 2874 7363  _adds.append(tsc
+000690c0: 6f6c 2b27 5f64 6179 6f66 6d6f 6e74 6827  ol+'_dayofmonth'
+000690d0: 290d 0a20 2020 2020 2020 2064 665b 7473  )..        df[ts
+000690e0: 636f 6c2b 275f 7765 656b 6f66 7965 6172  col+'_weekofyear
+000690f0: 275d 203d 2064 665b 7473 636f 6c5d 2e64  '] = df[tscol].d
+00069100: 742e 7765 656b 6f66 7965 6172 2e66 696c  t.weekofyear.fil
+00069110: 6c6e 6128 3029 2e61 7374 7970 6528 696e  lna(0).astype(in
+00069120: 7429 0d0a 2020 2020 2020 2020 6474 5f61  t)..        dt_a
+00069130: 6464 732e 6170 7065 6e64 2874 7363 6f6c  dds.append(tscol
+00069140: 2b27 5f77 6565 6b6f 6679 6561 7227 290d  +'_weekofyear').
+00069150: 0a20 2020 2020 2020 2077 6565 6b65 6e64  .        weekend
+00069160: 7320 3d20 2864 665b 7473 636f 6c2b 275f  s = (df[tscol+'_
+00069170: 6461 796f 6677 6565 6b27 5d20 3d3d 2027  dayofweek'] == '
+00069180: 5361 7427 2920 7c20 2864 665b 7473 636f  Sat') | (df[tsco
+00069190: 6c2b 275f 6461 796f 6677 6565 6b27 5d20  l+'_dayofweek'] 
+000691a0: 3d3d 2027 5375 6e27 290d 0a20 2020 2020  == 'Sun')..     
+000691b0: 2020 2064 665b 7473 636f 6c2b 275f 7479     df[tscol+'_ty
+000691c0: 7065 6f66 6461 7927 5d20 3d20 2777 6565  peofday'] = 'wee
+000691d0: 6b64 6179 270d 0a20 2020 2020 2020 2064  kday'..        d
+000691e0: 662e 6c6f 635b 7765 656b 656e 6473 2c20  f.loc[weekends, 
+000691f0: 7473 636f 6c2b 275f 7479 7065 6f66 6461  tscol+'_typeofda
+00069200: 7927 5d20 3d20 2777 6565 6b65 6e64 270d  y'] = 'weekend'.
+00069210: 0a20 2020 2020 2020 2064 745f 6164 6473  .        dt_adds
+00069220: 2e61 7070 656e 6428 7473 636f 6c2b 275f  .append(tscol+'_
+00069230: 7479 7065 6f66 6461 7927 290d 0a20 2020  typeofday')..   
+00069240: 2020 2020 2069 6620 7473 636f 6c2b 275f       if tscol+'_
+00069250: 7479 7065 6f66 6461 7927 2069 6e20 6474  typeofday' in dt
+00069260: 5f61 6464 733a 0d0a 2020 2020 2020 2020  _adds:..        
+00069270: 2020 2020 6466 2e6c 6f63 5b3a 2c74 7363      df.loc[:,tsc
+00069280: 6f6c 2b27 5f6d 6f6e 7468 5f74 7970 656f  ol+'_month_typeo
+00069290: 6664 6179 5f63 726f 7373 275d 203d 2064  fday_cross'] = d
+000692a0: 665b 7473 636f 6c2b 275f 6d6f 6e74 6827  f[tscol+'_month'
+000692b0: 5d20 2b22 2022 2b20 6466 5b74 7363 6f6c  ] +" "+ df[tscol
+000692c0: 2b27 5f74 7970 656f 6664 6179 275d 0d0a  +'_typeofday']..
+000692d0: 2020 2020 2020 2020 2020 2020 6474 5f61              dt_a
+000692e0: 6464 732e 6170 7065 6e64 2874 7363 6f6c  dds.append(tscol
+000692f0: 2b27 5f6d 6f6e 7468 5f74 7970 656f 6664  +'_month_typeofd
+00069300: 6179 5f63 726f 7373 2729 0d0a 2020 2020  ay_cross')..    
+00069310: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+00069320: 2070 7269 6e74 2827 2020 2020 4572 726f   print('    Erro
+00069330: 7220 696e 2063 7265 6174 696e 6720 6461  r in creating da
+00069340: 7465 2074 696d 6520 6465 7269 7665 6420  te time derived 
+00069350: 6665 6174 7572 6573 2e20 436f 6e74 696e  features. Contin
+00069360: 7569 6e67 2e2e 2e27 290d 0a20 2020 2070  uing...')..    p
+00069370: 7269 6e74 2827 2020 2020 4164 6465 6420  rint('    Added 
+00069380: 2564 2063 6f6c 756d 6e73 2066 726f 6d20  %d columns from 
+00069390: 2573 2063 6f6c 756d 6e27 2025 286c 656e  %s column' %(len
+000693a0: 2864 745f 6164 6473 292c 7473 636f 6c29  (dt_adds),tscol)
+000693b0: 290d 0a20 2020 2064 6620 3d20 6466 5b64  )..    df = df[d
+000693c0: 745f 6164 6473 5d0d 0a20 2020 2072 6574  t_adds]..    ret
+000693d0: 7572 6e20 6466 0d0a 2323 2323 2323 2323  urn df..########
 000693e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000693f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00069400: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069410: 2323 2323 2323 2323 2323 2323 230d 0a66  #############..f
-00069420: 726f 6d20 6461 7465 7574 696c 2e72 656c  rom dateutil.rel
-00069430: 6174 6976 6564 656c 7461 2069 6d70 6f72  ativedelta impor
-00069440: 7420 7265 6c61 7469 7665 6465 6c74 610d  t relativedelta.
-00069450: 0a66 726f 6d20 6461 7465 7469 6d65 2069  .from datetime i
-00069460: 6d70 6f72 7420 6461 7465 0d0a 2323 2323  mport date..####
-00069470: 2320 5468 6973 2069 7320 6120 6c69 7474  # This is a litt
-00069480: 6c65 2075 7469 6c69 7479 2074 6861 7420  le utility that 
-00069490: 636f 6d70 7574 6573 2061 6765 2066 726f  computes age fro
-000694a0: 6d20 7965 6172 2023 2323 230d 0a64 6566  m year ####..def
-000694b0: 2063 6f6d 7075 7465 5f61 6765 2879 6561   compute_age(yea
-000694c0: 725f 7374 7269 6e67 293a 0d0a 2020 2020  r_string):..    
-000694d0: 746f 6461 7920 3d20 6461 7465 2e74 6f64  today = date.tod
-000694e0: 6179 2829 0d0a 2020 2020 6167 6520 3d20  ay()..    age = 
-000694f0: 7265 6c61 7469 7665 6465 6c74 6128 746f  relativedelta(to
-00069500: 6461 792c 2079 6561 725f 7374 7269 6e67  day, year_string
-00069510: 290d 0a20 2020 2072 6574 7572 6e20 6167  )..    return ag
-00069520: 652e 7965 6172 730d 0a23 2323 2323 2323  e.years..#######
+00069410: 2323 2323 2323 2323 0d0a 6672 6f6d 2064  ########..from d
+00069420: 6174 6575 7469 6c2e 7265 6c61 7469 7665  ateutil.relative
+00069430: 6465 6c74 6120 696d 706f 7274 2072 656c  delta import rel
+00069440: 6174 6976 6564 656c 7461 0d0a 6672 6f6d  ativedelta..from
+00069450: 2064 6174 6574 696d 6520 696d 706f 7274   datetime import
+00069460: 2064 6174 650d 0a23 2323 2323 2054 6869   date..##### Thi
+00069470: 7320 6973 2061 206c 6974 746c 6520 7574  s is a little ut
+00069480: 696c 6974 7920 7468 6174 2063 6f6d 7075  ility that compu
+00069490: 7465 7320 6167 6520 6672 6f6d 2079 6561  tes age from yea
+000694a0: 7220 2323 2323 0d0a 6465 6620 636f 6d70  r ####..def comp
+000694b0: 7574 655f 6167 6528 7965 6172 5f73 7472  ute_age(year_str
+000694c0: 696e 6729 3a0d 0a20 2020 2074 6f64 6179  ing):..    today
+000694d0: 203d 2064 6174 652e 746f 6461 7928 290d   = date.today().
+000694e0: 0a20 2020 2061 6765 203d 2072 656c 6174  .    age = relat
+000694f0: 6976 6564 656c 7461 2874 6f64 6179 2c20  ivedelta(today, 
+00069500: 7965 6172 5f73 7472 696e 6729 0d0a 2020  year_string)..  
+00069510: 2020 7265 7475 726e 2061 6765 2e79 6561    return age.yea
+00069520: 7273 0d0a 2323 2323 2323 2323 2323 2323  rs..############
 00069530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00069540: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00069550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069560: 2323 2323 2323 2323 2323 0d0a 6465 6620  ##########..def 
-00069570: 6372 6561 7465 5f74 696d 655f 7365 7269  create_time_seri
-00069580: 6573 5f66 6561 7475 7265 7328 6474 662c  es_features(dtf,
-00069590: 2074 735f 636f 6c75 6d6e 293a 0d0a 2020   ts_column):..  
-000695a0: 2020 2222 220d 0a20 2020 2054 6869 7320    """..    This 
-000695b0: 6372 6561 7465 7320 6265 7477 6565 6e20  creates between 
-000695c0: 3820 616e 6420 3130 2064 6174 6520 7469  8 and 10 date ti
-000695d0: 6d65 2066 6561 7475 7265 7320 666f 7220  me features for 
-000695e0: 6561 6368 2064 6174 6520 7661 7269 6162  each date variab
-000695f0: 6c65 2e20 5468 6520 6e75 6d62 6572 206f  le. The number o
-00069600: 6620 6665 6174 7572 6573 0d0a 2020 2020  f features..    
-00069610: 6465 7065 6e64 7320 6f6e 2077 6865 7468  depends on wheth
-00069620: 6572 2069 7420 6973 206a 7573 7420 6120  er it is just a 
-00069630: 7965 6172 2076 6172 6961 626c 6520 6f72  year variable or
-00069640: 2061 2079 6561 722b 6d6f 6e74 682b 6461   a year+month+da
-00069650: 7920 616e 6420 7768 6574 6865 7220 6974  y and whether it
-00069660: 2068 6173 2068 6f75 7273 2061 6e64 206d   has hours and m
-00069670: 696e 732b 7365 6373 2e0d 0a20 2020 2053  ins+secs...    S
-00069680: 6f20 7468 6973 2063 616e 2063 7265 6174  o this can creat
-00069690: 6520 616c 6c20 7468 6573 6520 6665 6174  e all these feat
-000696a0: 7572 6573 2075 7369 6e67 206a 7573 7420  ures using just 
-000696b0: 7468 6520 6461 7465 2074 696d 6520 636f  the date time co
-000696c0: 6c75 6d6e 2074 6861 7420 796f 7520 7365  lumn that you se
-000696d0: 6e64 2069 6e2e 0d0a 2020 2020 4974 2072  nd in...    It r
-000696e0: 6574 7572 6e73 2074 6865 2065 6e74 6972  eturns the entir
-000696f0: 6520 6461 7461 6672 616d 6520 7769 7468  e dataframe with
-00069700: 2061 6464 6564 2076 6172 6961 626c 6573   added variables
-00069710: 2061 7320 6f75 7470 7574 2e0d 0a20 2020   as output...   
-00069720: 2022 2222 0d0a 2020 2020 6474 6620 3d20   """..    dtf = 
-00069730: 636f 7079 2e64 6565 7063 6f70 7928 6474  copy.deepcopy(dt
-00069740: 6629 0d0a 2020 2020 2323 2323 2049 6620  f)..    #### If 
-00069750: 666f 7220 736f 6d65 2072 6561 736f 6e20  for some reason 
-00069760: 7473 5f63 6f6c 756d 6e20 6973 206a 7573  ts_column is jus
-00069770: 7420 6120 6e75 6d62 6572 2c20 6d61 6b65  t a number, make
-00069780: 2073 7572 6520 6974 2069 7320 6120 7374   sure it is a st
-00069790: 7269 6e67 2073 6f20 6974 2064 6f65 7320  ring so it does 
-000697a0: 6e6f 7420 626c 6f77 2075 7020 616e 6420  not blow up and 
-000697b0: 636f 6e63 6174 656e 6174 6564 0d0a 2020  concatenated..  
-000697c0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-000697d0: 6e63 6528 7473 5f63 6f6c 756d 6e2c 7374  nce(ts_column,st
-000697e0: 7229 3a0d 0a20 2020 2020 2020 2074 735f  r):..        ts_
-000697f0: 636f 6c75 6d6e 203d 2073 7472 2874 735f  column = str(ts_
-00069800: 636f 6c75 6d6e 290d 0a20 2020 2074 7279  column)..    try
-00069810: 3a0d 0a20 2020 2020 2020 2023 2323 2049  :..        ### I
-00069820: 6e20 736f 6d65 2065 7874 7265 6d65 2063  n some extreme c
-00069830: 6173 6573 2c20 6461 7465 2074 696d 6520  ases, date time 
-00069840: 7661 7273 2061 7265 206e 6f74 2070 726f  vars are not pro
-00069850: 6365 7373 6564 2079 6574 2061 6e64 2068  cessed yet and h
-00069860: 656e 6365 2077 6520 6d75 7374 2066 696c  ence we must fil
-00069870: 6c20 6d69 7373 696e 6720 7661 6c75 6573  l missing values
-00069880: 2068 6572 6521 0d0a 2020 2020 2020 2020   here!..        
-00069890: 6966 2064 7466 5b74 735f 636f 6c75 6d6e  if dtf[ts_column
-000698a0: 5d2e 6973 6e75 6c6c 2829 2e73 756d 2829  ].isnull().sum()
-000698b0: 203e 2030 3a0d 0a20 2020 2020 2020 2020   > 0:..         
-000698c0: 2020 206d 6973 7369 6e67 5f66 6c61 6720     missing_flag 
-000698d0: 3d20 5472 7565 0d0a 2020 2020 2020 2020  = True..        
-000698e0: 2020 2020 6e65 775f 6d69 7373 696e 675f      new_missing_
-000698f0: 636f 6c20 3d20 7473 5f63 6f6c 756d 6e20  col = ts_column 
-00069900: 2b20 275f 4d69 7373 696e 675f 466c 6167  + '_Missing_Flag
-00069910: 270d 0a20 2020 2020 2020 2020 2020 2064  '..            d
-00069920: 7466 5b6e 6577 5f6d 6973 7369 6e67 5f63  tf[new_missing_c
-00069930: 6f6c 5d20 3d20 300d 0a20 2020 2020 2020  ol] = 0..       
-00069940: 2020 2020 2064 7466 2e6c 6f63 5b64 7466       dtf.loc[dtf
-00069950: 5b74 735f 636f 6c75 6d6e 5d2e 6973 6e75  [ts_column].isnu
-00069960: 6c6c 2829 2c6e 6577 5f6d 6973 7369 6e67  ll(),new_missing
-00069970: 5f63 6f6c 5d3d 310d 0a20 2020 2020 2020  _col]=1..       
-00069980: 2020 2020 2023 2323 2052 656d 656d 6265       ### Remembe
-00069990: 7220 7468 6174 2066 696c 6c6e 6120 6f6e  r that fillna on
-000699a0: 6c79 2077 6f72 6b73 2061 7420 7468 6520  ly works at the 
-000699b0: 6461 7461 6672 616d 6520 6c65 7665 6c21  dataframe level!
-000699c0: 0d0a 2020 2020 2020 2020 2020 2020 6474  ..            dt
-000699d0: 665b 5b74 735f 636f 6c75 6d6e 5d5d 203d  f[[ts_column]] =
-000699e0: 2064 7466 5b5b 7473 5f63 6f6c 756d 6e5d   dtf[[ts_column]
-000699f0: 5d2e 6669 6c6c 6e61 286d 6574 686f 643d  ].fillna(method=
-00069a00: 2766 6669 6c6c 2729 0d0a 2020 2020 2020  'ffill')..      
-00069a10: 2020 6966 2064 7466 5b74 735f 636f 6c75    if dtf[ts_colu
-00069a20: 6d6e 5d2e 6474 7970 6520 696e 205b 6e70  mn].dtype in [np
-00069a30: 2e66 6c6f 6174 3634 2c6e 702e 666c 6f61  .float64,np.floa
-00069a40: 7433 322c 6e70 2e66 6c6f 6174 3136 5d3a  t32,np.float16]:
-00069a50: 0d0a 2020 2020 2020 2020 2020 2020 6474  ..            dt
-00069a60: 665b 7473 5f63 6f6c 756d 6e5d 203d 2064  f[ts_column] = d
-00069a70: 7466 5b74 735f 636f 6c75 6d6e 5d2e 6173  tf[ts_column].as
-00069a80: 7479 7065 2869 6e74 290d 0a20 2020 2020  type(int)..     
-00069a90: 2020 2023 2323 2069 6620 7765 2068 6176     ### if we hav
-00069aa0: 6520 616c 7265 6164 7920 666f 756e 6420  e already found 
-00069ab0: 7468 6174 2069 7420 7761 7320 6120 6461  that it was a da
-00069ac0: 7465 2074 696d 6520 7661 722c 2074 6865  te time var, the
-00069ad0: 6e20 6c65 6176 6520 6974 2061 7320 6974  n leave it as it
-00069ae0: 2069 732e 2054 6861 7473 2067 6f6f 6420   is. Thats good 
-00069af0: 656e 6f75 6768 210d 0a20 2020 2020 2020  enough!..       
-00069b00: 2064 6174 655f 6974 656d 7320 3d20 6474   date_items = dt
-00069b10: 665b 7473 5f63 6f6c 756d 6e5d 2e61 7070  f[ts_column].app
-00069b20: 6c79 2873 7472 292e 6170 706c 7928 6c65  ly(str).apply(le
-00069b30: 6e29 2e76 616c 7565 730d 0a20 2020 2020  n).values..     
-00069b40: 2020 2023 2323 2320 496e 2073 6f6d 6520     #### In some 
-00069b50: 6578 7472 656d 6520 6361 7365 732c 0d0a  extreme cases,..
-00069b60: 2020 2020 2020 2020 6966 2061 6c6c 2864          if all(d
-00069b70: 6174 655f 6974 656d 735b 305d 203d 3d20  ate_items[0] == 
-00069b80: 6974 656d 2066 6f72 2069 7465 6d20 696e  item for item in
-00069b90: 2064 6174 655f 6974 656d 7329 3a0d 0a20   date_items):.. 
-00069ba0: 2020 2020 2020 2020 2020 2069 6620 6461             if da
-00069bb0: 7465 5f69 7465 6d73 5b30 5d20 3d3d 2034  te_items[0] == 4
-00069bc0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00069bd0: 2020 2023 2323 2049 6620 6974 2069 7320     ### If it is 
-00069be0: 6a75 7374 2061 2079 6561 7220 7661 7269  just a year vari
-00069bf0: 6162 6c65 2061 6c6f 6e65 2c20 796f 7520  able alone, you 
-00069c00: 7368 6f75 6c64 206c 6561 7665 2069 7420  should leave it 
-00069c10: 6173 206a 7573 7420 6120 7965 6172 210d  as just a year!.
-00069c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00069c30: 2061 6765 5f63 6f6c 203d 2074 735f 636f   age_col = ts_co
-00069c40: 6c75 6d6e 2b27 5f61 6765 5f69 6e5f 7965  lumn+'_age_in_ye
-00069c50: 6172 7327 0d0a 2020 2020 2020 2020 2020  ars'..          
-00069c60: 2020 2020 2020 6474 665b 6167 655f 636f        dtf[age_co
-00069c70: 6c5d 203d 2064 7466 5b74 735f 636f 6c75  l] = dtf[ts_colu
-00069c80: 6d6e 5d2e 6d61 7028 6c61 6d62 6461 2078  mn].map(lambda x
-00069c90: 3a20 7064 2e74 6f5f 6461 7465 7469 6d65  : pd.to_datetime
-00069ca0: 2878 2c66 6f72 6d61 743d 2725 5927 2929  (x,format='%Y'))
-00069cb0: 2e61 7070 6c79 2863 6f6d 7075 7465 5f61  .apply(compute_a
-00069cc0: 6765 292e 7661 6c75 6573 0d0a 2020 2020  ge).values..    
-00069cd0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00069ce0: 726e 2064 7466 5b5b 7473 5f63 6f6c 756d  rn dtf[[ts_colum
-00069cf0: 6e2c 6167 655f 636f 6c5d 5d0d 0a20 2020  n,age_col]]..   
-00069d00: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
-00069d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00069d20: 2323 2320 6966 2069 7420 6973 206e 6f74  ### if it is not
-00069d30: 2061 2079 6561 7220 616c 6f6e 652c 2074   a year alone, t
-00069d40: 6865 6e20 636f 6e76 6572 7420 6974 2069  hen convert it i
-00069d50: 6e74 6f20 6120 6461 7465 2074 696d 6520  nto a date time 
-00069d60: 7661 7269 6162 6c65 0d0a 2020 2020 2020  variable..      
-00069d70: 2020 2020 2020 2020 2020 6474 665b 7473            dtf[ts
-00069d80: 5f63 6f6c 756d 6e5d 203d 2070 642e 746f  _column] = pd.to
-00069d90: 5f64 6174 6574 696d 6528 6474 665b 7473  _datetime(dtf[ts
-00069da0: 5f63 6f6c 756d 6e5d 2c20 696e 6665 725f  _column], infer_
-00069db0: 6461 7465 7469 6d65 5f66 6f72 6d61 743d  datetime_format=
-00069dc0: 5472 7565 290d 0a20 2020 2020 2020 2065  True)..        e
-00069dd0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00069de0: 2020 6474 665b 7473 5f63 6f6c 756d 6e5d    dtf[ts_column]
-00069df0: 203d 2070 642e 746f 5f64 6174 6574 696d   = pd.to_datetim
-00069e00: 6528 6474 665b 7473 5f63 6f6c 756d 6e5d  e(dtf[ts_column]
-00069e10: 2c20 696e 6665 725f 6461 7465 7469 6d65  , infer_datetime
-00069e20: 5f66 6f72 6d61 743d 5472 7565 290d 0a20  _format=True).. 
-00069e30: 2020 2020 2020 2064 7466 203d 2063 7265         dtf = cre
-00069e40: 6174 655f 7473 5f66 6561 7475 7265 7328  ate_ts_features(
-00069e50: 6474 662c 7473 5f63 6f6c 756d 6e29 0d0a  dtf,ts_column)..
-00069e60: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
-00069e70: 2020 2020 2070 7269 6e74 2827 4572 726f       print('Erro
-00069e80: 7220 696e 2050 726f 6365 7373 696e 6720  r in Processing 
-00069e90: 2573 2063 6f6c 756d 6e20 666f 7220 6461  %s column for da
-00069ea0: 7465 2074 696d 6520 6665 6174 7572 6573  te time features
-00069eb0: 2e20 436f 6e74 696e 7569 6e67 2e2e 2e27  . Continuing...'
-00069ec0: 2025 7473 5f63 6f6c 756d 6e29 0d0a 2020   %ts_column)..  
-00069ed0: 2020 7265 7475 726e 2064 7466 0d0a 2323    return dtf..##
+00069560: 2323 2323 230d 0a64 6566 2063 7265 6174  #####..def creat
+00069570: 655f 7469 6d65 5f73 6572 6965 735f 6665  e_time_series_fe
+00069580: 6174 7572 6573 2864 7466 2c20 7473 5f63  atures(dtf, ts_c
+00069590: 6f6c 756d 6e29 3a0d 0a20 2020 2022 2222  olumn):..    """
+000695a0: 0d0a 2020 2020 5468 6973 2063 7265 6174  ..    This creat
+000695b0: 6573 2062 6574 7765 656e 2038 2061 6e64  es between 8 and
+000695c0: 2031 3020 6461 7465 2074 696d 6520 6665   10 date time fe
+000695d0: 6174 7572 6573 2066 6f72 2065 6163 6820  atures for each 
+000695e0: 6461 7465 2076 6172 6961 626c 652e 2054  date variable. T
+000695f0: 6865 206e 756d 6265 7220 6f66 2066 6561  he number of fea
+00069600: 7475 7265 730d 0a20 2020 2064 6570 656e  tures..    depen
+00069610: 6473 206f 6e20 7768 6574 6865 7220 6974  ds on whether it
+00069620: 2069 7320 6a75 7374 2061 2079 6561 7220   is just a year 
+00069630: 7661 7269 6162 6c65 206f 7220 6120 7965  variable or a ye
+00069640: 6172 2b6d 6f6e 7468 2b64 6179 2061 6e64  ar+month+day and
+00069650: 2077 6865 7468 6572 2069 7420 6861 7320   whether it has 
+00069660: 686f 7572 7320 616e 6420 6d69 6e73 2b73  hours and mins+s
+00069670: 6563 732e 0d0a 2020 2020 536f 2074 6869  ecs...    So thi
+00069680: 7320 6361 6e20 6372 6561 7465 2061 6c6c  s can create all
+00069690: 2074 6865 7365 2066 6561 7475 7265 7320   these features 
+000696a0: 7573 696e 6720 6a75 7374 2074 6865 2064  using just the d
+000696b0: 6174 6520 7469 6d65 2063 6f6c 756d 6e20  ate time column 
+000696c0: 7468 6174 2079 6f75 2073 656e 6420 696e  that you send in
+000696d0: 2e0d 0a20 2020 2049 7420 7265 7475 726e  ...    It return
+000696e0: 7320 7468 6520 656e 7469 7265 2064 6174  s the entire dat
+000696f0: 6166 7261 6d65 2077 6974 6820 6164 6465  aframe with adde
+00069700: 6420 7661 7269 6162 6c65 7320 6173 206f  d variables as o
+00069710: 7574 7075 742e 0d0a 2020 2020 2222 220d  utput...    """.
+00069720: 0a20 2020 2064 7466 203d 2063 6f70 792e  .    dtf = copy.
+00069730: 6465 6570 636f 7079 2864 7466 290d 0a20  deepcopy(dtf).. 
+00069740: 2020 2023 2323 2320 4966 2066 6f72 2073     #### If for s
+00069750: 6f6d 6520 7265 6173 6f6e 2074 735f 636f  ome reason ts_co
+00069760: 6c75 6d6e 2069 7320 6a75 7374 2061 206e  lumn is just a n
+00069770: 756d 6265 722c 206d 616b 6520 7375 7265  umber, make sure
+00069780: 2069 7420 6973 2061 2073 7472 696e 6720   it is a string 
+00069790: 736f 2069 7420 646f 6573 206e 6f74 2062  so it does not b
+000697a0: 6c6f 7720 7570 2061 6e64 2063 6f6e 6361  low up and conca
+000697b0: 7465 6e61 7465 640d 0a20 2020 2069 6620  tenated..    if 
+000697c0: 6e6f 7420 6973 696e 7374 616e 6365 2874  not isinstance(t
+000697d0: 735f 636f 6c75 6d6e 2c73 7472 293a 0d0a  s_column,str):..
+000697e0: 2020 2020 2020 2020 7473 5f63 6f6c 756d          ts_colum
+000697f0: 6e20 3d20 7374 7228 7473 5f63 6f6c 756d  n = str(ts_colum
+00069800: 6e29 0d0a 2020 2020 7472 793a 0d0a 2020  n)..    try:..  
+00069810: 2020 2020 2020 2323 2320 496e 2073 6f6d        ### In som
+00069820: 6520 6578 7472 656d 6520 6361 7365 732c  e extreme cases,
+00069830: 2064 6174 6520 7469 6d65 2076 6172 7320   date time vars 
+00069840: 6172 6520 6e6f 7420 7072 6f63 6573 7365  are not processe
+00069850: 6420 7965 7420 616e 6420 6865 6e63 6520  d yet and hence 
+00069860: 7765 206d 7573 7420 6669 6c6c 206d 6973  we must fill mis
+00069870: 7369 6e67 2076 616c 7565 7320 6865 7265  sing values here
+00069880: 210d 0a20 2020 2020 2020 2069 6620 6474  !..        if dt
+00069890: 665b 7473 5f63 6f6c 756d 6e5d 2e69 736e  f[ts_column].isn
+000698a0: 756c 6c28 292e 7375 6d28 2920 3e20 303a  ull().sum() > 0:
+000698b0: 0d0a 2020 2020 2020 2020 2020 2020 6d69  ..            mi
+000698c0: 7373 696e 675f 666c 6167 203d 2054 7275  ssing_flag = Tru
+000698d0: 650d 0a20 2020 2020 2020 2020 2020 206e  e..            n
+000698e0: 6577 5f6d 6973 7369 6e67 5f63 6f6c 203d  ew_missing_col =
+000698f0: 2074 735f 636f 6c75 6d6e 202b 2027 5f4d   ts_column + '_M
+00069900: 6973 7369 6e67 5f46 6c61 6727 0d0a 2020  issing_Flag'..  
+00069910: 2020 2020 2020 2020 2020 6474 665b 6e65            dtf[ne
+00069920: 775f 6d69 7373 696e 675f 636f 6c5d 203d  w_missing_col] =
+00069930: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
+00069940: 6474 662e 6c6f 635b 6474 665b 7473 5f63  dtf.loc[dtf[ts_c
+00069950: 6f6c 756d 6e5d 2e69 736e 756c 6c28 292c  olumn].isnull(),
+00069960: 6e65 775f 6d69 7373 696e 675f 636f 6c5d  new_missing_col]
+00069970: 3d31 0d0a 2020 2020 2020 2020 2020 2020  =1..            
+00069980: 2323 2320 5265 6d65 6d62 6572 2074 6861  ### Remember tha
+00069990: 7420 6669 6c6c 6e61 206f 6e6c 7920 776f  t fillna only wo
+000699a0: 726b 7320 6174 2074 6865 2064 6174 6166  rks at the dataf
+000699b0: 7261 6d65 206c 6576 656c 210d 0a20 2020  rame level!..   
+000699c0: 2020 2020 2020 2020 2064 7466 5b5b 7473           dtf[[ts
+000699d0: 5f63 6f6c 756d 6e5d 5d20 3d20 6474 665b  _column]] = dtf[
+000699e0: 5b74 735f 636f 6c75 6d6e 5d5d 2e66 696c  [ts_column]].fil
+000699f0: 6c6e 6128 6d65 7468 6f64 3d27 6666 696c  lna(method='ffil
+00069a00: 6c27 290d 0a20 2020 2020 2020 2069 6620  l')..        if 
+00069a10: 6474 665b 7473 5f63 6f6c 756d 6e5d 2e64  dtf[ts_column].d
+00069a20: 7479 7065 2069 6e20 5b6e 702e 666c 6f61  type in [np.floa
+00069a30: 7436 342c 6e70 2e66 6c6f 6174 3332 2c6e  t64,np.float32,n
+00069a40: 702e 666c 6f61 7431 365d 3a0d 0a20 2020  p.float16]:..   
+00069a50: 2020 2020 2020 2020 2064 7466 5b74 735f           dtf[ts_
+00069a60: 636f 6c75 6d6e 5d20 3d20 6474 665b 7473  column] = dtf[ts
+00069a70: 5f63 6f6c 756d 6e5d 2e61 7374 7970 6528  _column].astype(
+00069a80: 696e 7429 0d0a 2020 2020 2020 2020 2323  int)..        ##
+00069a90: 2320 6966 2077 6520 6861 7665 2061 6c72  # if we have alr
+00069aa0: 6561 6479 2066 6f75 6e64 2074 6861 7420  eady found that 
+00069ab0: 6974 2077 6173 2061 2064 6174 6520 7469  it was a date ti
+00069ac0: 6d65 2076 6172 2c20 7468 656e 206c 6561  me var, then lea
+00069ad0: 7665 2069 7420 6173 2069 7420 6973 2e20  ve it as it is. 
+00069ae0: 5468 6174 7320 676f 6f64 2065 6e6f 7567  Thats good enoug
+00069af0: 6821 0d0a 2020 2020 2020 2020 6461 7465  h!..        date
+00069b00: 5f69 7465 6d73 203d 2064 7466 5b74 735f  _items = dtf[ts_
+00069b10: 636f 6c75 6d6e 5d2e 6170 706c 7928 7374  column].apply(st
+00069b20: 7229 2e61 7070 6c79 286c 656e 292e 7661  r).apply(len).va
+00069b30: 6c75 6573 0d0a 2020 2020 2020 2020 2323  lues..        ##
+00069b40: 2323 2049 6e20 736f 6d65 2065 7874 7265  ## In some extre
+00069b50: 6d65 2063 6173 6573 2c0d 0a20 2020 2020  me cases,..     
+00069b60: 2020 2069 6620 616c 6c28 6461 7465 5f69     if all(date_i
+00069b70: 7465 6d73 5b30 5d20 3d3d 2069 7465 6d20  tems[0] == item 
+00069b80: 666f 7220 6974 656d 2069 6e20 6461 7465  for item in date
+00069b90: 5f69 7465 6d73 293a 0d0a 2020 2020 2020  _items):..      
+00069ba0: 2020 2020 2020 6966 2064 6174 655f 6974        if date_it
+00069bb0: 656d 735b 305d 203d 3d20 343a 0d0a 2020  ems[0] == 4:..  
+00069bc0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+00069bd0: 2320 4966 2069 7420 6973 206a 7573 7420  # If it is just 
+00069be0: 6120 7965 6172 2076 6172 6961 626c 6520  a year variable 
+00069bf0: 616c 6f6e 652c 2079 6f75 2073 686f 756c  alone, you shoul
+00069c00: 6420 6c65 6176 6520 6974 2061 7320 6a75  d leave it as ju
+00069c10: 7374 2061 2079 6561 7221 0d0a 2020 2020  st a year!..    
+00069c20: 2020 2020 2020 2020 2020 2020 6167 655f              age_
+00069c30: 636f 6c20 3d20 7473 5f63 6f6c 756d 6e2b  col = ts_column+
+00069c40: 275f 6167 655f 696e 5f79 6561 7273 270d  '_age_in_years'.
+00069c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00069c60: 2064 7466 5b61 6765 5f63 6f6c 5d20 3d20   dtf[age_col] = 
+00069c70: 6474 665b 7473 5f63 6f6c 756d 6e5d 2e6d  dtf[ts_column].m
+00069c80: 6170 286c 616d 6264 6120 783a 2070 642e  ap(lambda x: pd.
+00069c90: 746f 5f64 6174 6574 696d 6528 782c 666f  to_datetime(x,fo
+00069ca0: 726d 6174 3d27 2559 2729 292e 6170 706c  rmat='%Y')).appl
+00069cb0: 7928 636f 6d70 7574 655f 6167 6529 2e76  y(compute_age).v
+00069cc0: 616c 7565 730d 0a20 2020 2020 2020 2020  alues..         
+00069cd0: 2020 2020 2020 2072 6574 7572 6e20 6474         return dt
+00069ce0: 665b 5b74 735f 636f 6c75 6d6e 2c61 6765  f[[ts_column,age
+00069cf0: 5f63 6f6c 5d5d 0d0a 2020 2020 2020 2020  _col]]..        
+00069d00: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00069d10: 2020 2020 2020 2020 2020 2023 2323 2069             ### i
+00069d20: 6620 6974 2069 7320 6e6f 7420 6120 7965  f it is not a ye
+00069d30: 6172 2061 6c6f 6e65 2c20 7468 656e 2063  ar alone, then c
+00069d40: 6f6e 7665 7274 2069 7420 696e 746f 2061  onvert it into a
+00069d50: 2064 6174 6520 7469 6d65 2076 6172 6961   date time varia
+00069d60: 626c 650d 0a20 2020 2020 2020 2020 2020  ble..           
+00069d70: 2020 2020 2064 7466 5b74 735f 636f 6c75       dtf[ts_colu
+00069d80: 6d6e 5d20 3d20 7064 2e74 6f5f 6461 7465  mn] = pd.to_date
+00069d90: 7469 6d65 2864 7466 5b74 735f 636f 6c75  time(dtf[ts_colu
+00069da0: 6d6e 5d2c 2069 6e66 6572 5f64 6174 6574  mn], infer_datet
+00069db0: 696d 655f 666f 726d 6174 3d54 7275 6529  ime_format=True)
+00069dc0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+00069dd0: 0a20 2020 2020 2020 2020 2020 2064 7466  .            dtf
+00069de0: 5b74 735f 636f 6c75 6d6e 5d20 3d20 7064  [ts_column] = pd
+00069df0: 2e74 6f5f 6461 7465 7469 6d65 2864 7466  .to_datetime(dtf
+00069e00: 5b74 735f 636f 6c75 6d6e 5d2c 2069 6e66  [ts_column], inf
+00069e10: 6572 5f64 6174 6574 696d 655f 666f 726d  er_datetime_form
+00069e20: 6174 3d54 7275 6529 0d0a 2020 2020 2020  at=True)..      
+00069e30: 2020 6474 6620 3d20 6372 6561 7465 5f74    dtf = create_t
+00069e40: 735f 6665 6174 7572 6573 2864 7466 2c74  s_features(dtf,t
+00069e50: 735f 636f 6c75 6d6e 290d 0a20 2020 2065  s_column)..    e
+00069e60: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
+00069e70: 7072 696e 7428 2745 7272 6f72 2069 6e20  print('Error in 
+00069e80: 5072 6f63 6573 7369 6e67 2025 7320 636f  Processing %s co
+00069e90: 6c75 6d6e 2066 6f72 2064 6174 6520 7469  lumn for date ti
+00069ea0: 6d65 2066 6561 7475 7265 732e 2043 6f6e  me features. Con
+00069eb0: 7469 6e75 696e 672e 2e2e 2720 2574 735f  tinuing...' %ts_
+00069ec0: 636f 6c75 6d6e 290d 0a20 2020 2072 6574  column)..    ret
+00069ed0: 7572 6e20 6474 660d 0a23 2323 2323 2323  urn dtf..#######
 00069ee0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00069ef0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069f00: 2323 2323 2323 0d0a 6672 6f6d 2063 6f6c  ######..from col
-00069f10: 6c65 6374 696f 6e73 2069 6d70 6f72 7420  lections import 
-00069f20: 436f 756e 7465 720d 0a69 6d70 6f72 7420  Counter..import 
-00069f30: 7469 6d65 0d0a 2323 2323 2323 2323 2323  time..##########
+00069f00: 230d 0a66 726f 6d20 636f 6c6c 6563 7469  #..from collecti
+00069f10: 6f6e 7320 696d 706f 7274 2043 6f75 6e74  ons import Count
+00069f20: 6572 0d0a 696d 706f 7274 2074 696d 650d  er..import time.
+00069f30: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
 00069f40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00069f50: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-00069f60: 696d 706f 7274 2077 6172 6e69 6e67 730d  import warnings.
-00069f70: 0a77 6172 6e69 6e67 732e 6669 6c74 6572  .warnings.filter
-00069f80: 7761 726e 696e 6773 2822 6967 6e6f 7265  warnings("ignore
-00069f90: 2229 0d0a 6672 6f6d 2073 6b6c 6561 726e  ")..from sklearn
-00069fa0: 2e65 7863 6570 7469 6f6e 7320 696d 706f  .exceptions impo
-00069fb0: 7274 2044 6174 6143 6f6e 7665 7273 696f  rt DataConversio
-00069fc0: 6e57 6172 6e69 6e67 0d0a 7761 726e 696e  nWarning..warnin
-00069fd0: 6773 2e66 696c 7465 7277 6172 6e69 6e67  gs.filterwarning
-00069fe0: 7328 6163 7469 6f6e 3d27 6967 6e6f 7265  s(action='ignore
-00069ff0: 272c 2063 6174 6567 6f72 793d 4461 7461  ', category=Data
-0006a000: 436f 6e76 6572 7369 6f6e 5761 726e 696e  ConversionWarnin
-0006a010: 6729 0d0a 2323 2323 2323 2323 2323 2323  g)..############
+00069f50: 2323 2323 2323 2323 230d 0a69 6d70 6f72  #########..impor
+00069f60: 7420 7761 726e 696e 6773 0d0a 7761 726e  t warnings..warn
+00069f70: 696e 6773 2e66 696c 7465 7277 6172 6e69  ings.filterwarni
+00069f80: 6e67 7328 2269 676e 6f72 6522 290d 0a66  ngs("ignore")..f
+00069f90: 726f 6d20 736b 6c65 6172 6e2e 6578 6365  rom sklearn.exce
+00069fa0: 7074 696f 6e73 2069 6d70 6f72 7420 4461  ptions import Da
+00069fb0: 7461 436f 6e76 6572 7369 6f6e 5761 726e  taConversionWarn
+00069fc0: 696e 670d 0a77 6172 6e69 6e67 732e 6669  ing..warnings.fi
+00069fd0: 6c74 6572 7761 726e 696e 6773 2861 6374  lterwarnings(act
+00069fe0: 696f 6e3d 2769 676e 6f72 6527 2c20 6361  ion='ignore', ca
+00069ff0: 7465 676f 7279 3d44 6174 6143 6f6e 7665  tegory=DataConve
+0006a000: 7273 696f 6e57 6172 6e69 6e67 290d 0a23  rsionWarning)..#
+0006a010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006a020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006a030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006a040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006a050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a060: 2323 2323 2323 2323 0d0a 6672 6f6d 2073  ########..from s
-0006a070: 6b6c 6561 726e 2e75 7469 6c73 2e63 6c61  klearn.utils.cla
-0006a080: 7373 5f77 6569 6768 7420 696d 706f 7274  ss_weight import
-0006a090: 2063 6f6d 7075 7465 5f63 6c61 7373 5f77   compute_class_w
-0006a0a0: 6569 6768 740d 0a66 726f 6d20 696d 626c  eight..from imbl
-0006a0b0: 6561 726e 2e6f 7665 725f 7361 6d70 6c69  earn.over_sampli
-0006a0c0: 6e67 2069 6d70 6f72 7420 534d 4f54 452c  ng import SMOTE,
-0006a0d0: 2053 4d4f 5445 4e43 0d0a 6672 6f6d 2063   SMOTENC..from c
-0006a0e0: 6f6c 6c65 6374 696f 6e73 2069 6d70 6f72  ollections impor
-0006a0f0: 7420 436f 756e 7465 720d 0a69 6d70 6f72  t Counter..impor
-0006a100: 7420 636f 7079 0d0a 696d 706f 7274 2070  t copy..import p
-0006a110: 6462 0d0a 2323 2323 2323 2323 2323 2323  db..############
+0006a060: 2323 230d 0a66 726f 6d20 736b 6c65 6172  ###..from sklear
+0006a070: 6e2e 7574 696c 732e 636c 6173 735f 7765  n.utils.class_we
+0006a080: 6967 6874 2069 6d70 6f72 7420 636f 6d70  ight import comp
+0006a090: 7574 655f 636c 6173 735f 7765 6967 6874  ute_class_weight
+0006a0a0: 0d0a 6672 6f6d 2069 6d62 6c65 6172 6e2e  ..from imblearn.
+0006a0b0: 6f76 6572 5f73 616d 706c 696e 6720 696d  over_sampling im
+0006a0c0: 706f 7274 2053 4d4f 5445 2c20 534d 4f54  port SMOTE, SMOT
+0006a0d0: 454e 430d 0a66 726f 6d20 636f 6c6c 6563  ENC..from collec
+0006a0e0: 7469 6f6e 7320 696d 706f 7274 2043 6f75  tions import Cou
+0006a0f0: 6e74 6572 0d0a 696d 706f 7274 2063 6f70  nter..import cop
+0006a100: 790d 0a69 6d70 6f72 7420 7064 620d 0a23  y..import pdb..#
+0006a110: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006a120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006a130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006a140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006a150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a160: 2323 2323 2323 2323 2323 230d 0a23 2323  ###########..###
-0006a170: 2052 6567 7265 7373 696f 6e5f 5265 7361   Regression_Resa
-0006a180: 6d70 6c65 7220 6973 2061 206e 6561 7420  mpler is a neat 
-0006a190: 6c69 6272 6172 7920 7468 6174 2072 6574  library that ret
-0006a1a0: 7572 6e73 2061 206e 756d 7079 206c 6973  urns a numpy lis
-0006a1b0: 7420 6f66 2063 6c61 7373 6573 2066 6f72  t of classes for
-0006a1c0: 2065 6163 680d 0a23 2323 2020 636f 7272   each..###  corr
-0006a1d0: 6573 706f 6e64 696e 6720 7361 6d70 6c65  esponding sample
-0006a1e0: 2e20 6672 6f6d 2074 6172 6765 7420 6461  . from target da
-0006a1f0: 7461 2e20 4974 2065 6e61 626c 6573 2072  ta. It enables r
-0006a200: 6567 7265 7369 736f 6e20 7072 6f62 6c65  egresison proble
-0006a210: 6d73 2074 6f20 7573 6520 534d 4f54 452e  ms to use SMOTE.
-0006a220: 0d0a 2323 2320 2049 2068 6176 6520 7573  ..###  I have us
-0006a230: 6564 2061 2073 696d 696c 6172 2063 6f6e  ed a similar con
-0006a240: 6365 7074 2062 7574 2069 6d70 6c65 6d65  cept but impleme
-0006a250: 6e74 6564 2069 7420 6d79 2077 6179 2075  nted it my way u
-0006a260: 7369 6e67 204b 2d4d 6561 6e73 2061 6c67  sing K-Means alg
-0006a270: 6f72 6974 686d 2e0d 0a23 2323 2020 4d79  orithm...###  My
-0006a280: 2073 696e 6365 7265 2074 6861 6e6b 7320   sincere thanks 
-0006a290: 746f 2074 6865 2063 7265 6174 6f72 7320  to the creators 
-0006a2a0: 6f66 2074 6865 206c 6962 7261 7279 3a0d  of the library:.
-0006a2b0: 0a23 2323 2020 2020 2068 7474 7073 3a2f  .###     https:/
-0006a2c0: 2f67 6974 6875 622e 636f 6d2f 6174 6966  /github.com/atif
-0006a2d0: 2d68 6173 7361 6e2f 5265 6772 6573 7369  -hassan/Regressi
-0006a2e0: 6f6e 5f52 6553 616d 706c 696e 672f 0d0a  on_ReSampling/..
+0006a160: 2323 2323 2323 0d0a 2323 2320 5265 6772  ######..### Regr
+0006a170: 6573 7369 6f6e 5f52 6573 616d 706c 6572  ession_Resampler
+0006a180: 2069 7320 6120 6e65 6174 206c 6962 7261   is a neat libra
+0006a190: 7279 2074 6861 7420 7265 7475 726e 7320  ry that returns 
+0006a1a0: 6120 6e75 6d70 7920 6c69 7374 206f 6620  a numpy list of 
+0006a1b0: 636c 6173 7365 7320 666f 7220 6561 6368  classes for each
+0006a1c0: 0d0a 2323 2320 2063 6f72 7265 7370 6f6e  ..###  correspon
+0006a1d0: 6469 6e67 2073 616d 706c 652e 2066 726f  ding sample. fro
+0006a1e0: 6d20 7461 7267 6574 2064 6174 612e 2049  m target data. I
+0006a1f0: 7420 656e 6162 6c65 7320 7265 6772 6573  t enables regres
+0006a200: 6973 6f6e 2070 726f 626c 656d 7320 746f  ison problems to
+0006a210: 2075 7365 2053 4d4f 5445 2e0d 0a23 2323   use SMOTE...###
+0006a220: 2020 4920 6861 7665 2075 7365 6420 6120    I have used a 
+0006a230: 7369 6d69 6c61 7220 636f 6e63 6570 7420  similar concept 
+0006a240: 6275 7420 696d 706c 656d 656e 7465 6420  but implemented 
+0006a250: 6974 206d 7920 7761 7920 7573 696e 6720  it my way using 
+0006a260: 4b2d 4d65 616e 7320 616c 676f 7269 7468  K-Means algorith
+0006a270: 6d2e 0d0a 2323 2320 204d 7920 7369 6e63  m...###  My sinc
+0006a280: 6572 6520 7468 616e 6b73 2074 6f20 7468  ere thanks to th
+0006a290: 6520 6372 6561 746f 7273 206f 6620 7468  e creators of th
+0006a2a0: 6520 6c69 6272 6172 793a 0d0a 2323 2320  e library:..### 
+0006a2b0: 2020 2020 6874 7470 733a 2f2f 6769 7468      https://gith
+0006a2c0: 7562 2e63 6f6d 2f61 7469 662d 6861 7373  ub.com/atif-hass
+0006a2d0: 616e 2f52 6567 7265 7373 696f 6e5f 5265  an/Regression_Re
+0006a2e0: 5361 6d70 6c69 6e67 2f0d 0a23 2323 2323  Sampling/..#####
 0006a2f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006a300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006a310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006a320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006a330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006a340: 2323 2323 2323 230d 0a64 6566 2074 7261  #######..def tra
-0006a350: 696e 696e 675f 7769 7468 5f53 4d4f 5445  ining_with_SMOTE
-0006a360: 2858 5f64 662c 795f 6466 2c74 6172 6765  (X_df,y_df,targe
-0006a370: 742c 6576 616c 5f73 6574 2c6d 6f64 656c  t,eval_set,model
-0006a380: 5f69 6e70 7574 2c42 6f6f 7374 696e 675f  _input,Boosting_
-0006a390: 466c 6167 2c65 7661 6c5f 6d65 7472 6963  Flag,eval_metric
-0006a3a0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0006a340: 2323 0d0a 6465 6620 7472 6169 6e69 6e67  ##..def training
+0006a350: 5f77 6974 685f 534d 4f54 4528 585f 6466  _with_SMOTE(X_df
+0006a360: 2c79 5f64 662c 7461 7267 6574 2c65 7661  ,y_df,target,eva
+0006a370: 6c5f 7365 742c 6d6f 6465 6c5f 696e 7075  l_set,model_inpu
+0006a380: 742c 426f 6f73 7469 6e67 5f46 6c61 672c  t,Boosting_Flag,
+0006a390: 6576 616c 5f6d 6574 7269 632c 0d0a 2020  eval_metric,..  
+0006a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0006a3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006a3c0: 2020 2020 2020 2020 2020 206d 6f64 656c             model
-0006a3d0: 7479 7065 2c20 6d6f 6465 6c5f 6e61 6d65  type, model_name
-0006a3e0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0006a3c0: 2020 2020 2020 6d6f 6465 6c74 7970 652c        modeltype,
+0006a3d0: 206d 6f64 656c 5f6e 616d 652c 0d0a 2020   model_name,..  
+0006a3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0006a3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006a400: 2020 2020 2020 2020 7472 6169 6e69 6e67          training
-0006a410: 3d54 7275 652c 6d69 6e6f 7269 7479 5f63  =True,minority_c
-0006a420: 6c61 7373 3d31 2c69 6d70 5f63 6174 733d  lass=1,imp_cats=
-0006a430: 5b5d 2c0d 0a20 2020 2020 2020 2020 2020  [],..           
+0006a400: 2020 2074 7261 696e 696e 673d 5472 7565     training=True
+0006a410: 2c6d 696e 6f72 6974 795f 636c 6173 733d  ,minority_class=
+0006a420: 312c 696d 705f 6361 7473 3d5b 5d2c 0d0a  1,imp_cats=[],..
+0006a430: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0006a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006a450: 2020 2020 2020 2020 2020 6361 6c69 6272            calibr
-0006a460: 6174 6f72 5f66 6c61 673d 4661 6c73 652c  ator_flag=False,
-0006a470: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0006a450: 2020 2020 2063 616c 6962 7261 746f 725f       calibrator_
+0006a460: 666c 6167 3d46 616c 7365 2c0d 0a20 2020  flag=False,..   
+0006a470: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0006a480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006a490: 2020 2020 2020 2047 5055 5f65 7869 7374         GPU_exist
-0006a4a0: 733d 4661 6c73 652c 2070 6172 616d 733d  s=False, params=
-0006a4b0: 7b7d 2c0d 0a20 2020 2020 2020 2020 2020  {},..           
+0006a490: 2020 4750 555f 6578 6973 7473 3d46 616c    GPU_exists=Fal
+0006a4a0: 7365 2c20 7061 7261 6d73 3d7b 7d2c 0d0a  se, params={},..
+0006a4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0006a4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006a4d0: 2020 2020 2020 2020 2020 6d6f 6465 6c5f            model_
-0006a4e0: 6c61 6265 6c3d 2753 696e 676c 655f 4c61  label='Single_La
-0006a4f0: 6265 6c27 2c20 7665 7262 6f73 653d 3029  bel', verbose=0)
-0006a500: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
-0006a510: 2323 2323 2323 2323 2320 2020 204f 5645  #########    OVE
-0006a520: 5253 414d 504c 494e 4720 4f46 204d 494e  RSAMPLING OF MIN
-0006a530: 4f52 4954 5920 434c 4153 5320 414e 4420  ORITY CLASS AND 
-0006a540: 5452 4149 4e49 4e47 2020 5349 5a45 5320  TRAINING  SIZES 
-0006a550: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-0006a560: 0d0a 2020 2020 2323 2323 2020 534d 4f54  ..    ####  SMOT
-0006a570: 4520 2853 796e 7468 6574 6963 204d 696e  E (Synthetic Min
-0006a580: 6f72 6974 7920 4f76 6572 7361 6d70 6c69  ority Oversampli
-0006a590: 6e67 2054 6563 686e 6971 7565 2920 776f  ng Technique) wo
-0006a5a0: 726b 7320 7765 6c6c 2077 6974 6820 696d  rks well with im
-0006a5b0: 6261 6c61 6e63 6564 2063 6c61 7373 6573  balanced classes
-0006a5c0: 2e0d 0a20 2020 2023 2323 2320 2054 6869  ...    ####  Thi
-0006a5d0: 7320 6973 2061 2067 7265 6174 2077 6179  s is a great way
-0006a5e0: 2074 6f20 7472 6169 6e20 6120 6d6f 6465   to train a mode
-0006a5f0: 6c20 696e 2073 7563 6820 6361 7365 7320  l in such cases 
-0006a600: 7769 7468 2072 6570 6561 7465 6420 7361  with repeated sa
-0006a610: 6d70 6c65 7320 6f66 2072 6172 652d 636c  mples of rare-cl
-0006a620: 6173 730d 0a20 2020 2023 2323 2320 2061  ass..    ####  a
-0006a630: 6c6f 6e67 2077 6974 6820 6261 7463 6865  long with batche
-0006a640: 7320 6f66 206d 616a 6f72 6974 7920 636c  s of majority cl
-0006a650: 6173 7320 616e 6420 6765 7420 7468 6520  ass and get the 
-0006a660: 6d6f 6465 6c20 746f 2064 6966 6665 7265  model to differe
-0006a670: 6e74 6961 7465 2062 6574 7765 656e 2032  ntiate between 2
-0006a680: 2063 6c61 7373 6573 2e0d 0a20 2020 2023   classes...    #
-0006a690: 2323 2320 2054 6869 7320 6361 6e20 616c  ###  This can al
-0006a6a0: 736f 2062 6520 7573 6564 2066 6f72 2052  so be used for R
-0006a6b0: 6567 7265 7373 696f 6e20 7072 6f62 6c65  egression proble
-0006a6c0: 6d73 2062 7920 7573 696e 6720 7468 6520  ms by using the 
-0006a6d0: 6e75 6d65 7269 6320 7461 7267 6574 2076  numeric target v
-0006a6e0: 616c 7565 7320 636f 6e76 6572 7465 640d  alues converted.
-0006a6f0: 0a20 2020 2023 2323 2320 2074 6f20 636c  .    ####  to cl
-0006a700: 7573 7465 7220 6c61 6265 6c73 2075 7369  uster labels usi
-0006a710: 6e67 204b 4d65 616e 732e 2059 6f75 2063  ng KMeans. You c
-0006a720: 616e 2074 6865 6e20 7573 6520 7468 6520  an then use the 
-0006a730: 636c 7573 7465 7220 6c61 6265 6c73 2074  cluster labels t
-0006a740: 6f20 6164 6420 6d6f 7265 2073 616d 706c  o add more sampl
-0006a750: 6573 2e0d 0a20 2020 2023 2323 2323 2323  es...    #######
-0006a760: 2323 2020 2020 4d41 4b45 2053 5552 4520  ##    MAKE SURE 
-0006a770: 594f 5520 5455 4e45 2054 4845 2044 4546  YOU TUNE THE DEF
-0006a780: 4155 4c54 5320 4749 5645 4e20 4845 5245  AULTS GIVEN HERE
-0006a790: 2120 2023 2323 2323 2323 2323 2323 2323  !  #############
-0006a7a0: 2323 0d0a 2020 2020 2222 220d 0a20 2020  ##..    """..   
-0006a7b0: 2058 5f64 6620 3d20 636f 7079 2e64 6565   X_df = copy.dee
-0006a7c0: 7063 6f70 7928 585f 6466 290d 0a20 2020  pcopy(X_df)..   
-0006a7d0: 2079 5f64 6620 3d20 636f 7079 2e64 6565   y_df = copy.dee
-0006a7e0: 7063 6f70 7928 795f 6466 290d 0a20 2020  pcopy(y_df)..   
-0006a7f0: 206d 6f64 656c 5f63 6f70 7920 3d20 636f   model_copy = co
-0006a800: 7079 2e64 6565 7063 6f70 7928 6d6f 6465  py.deepcopy(mode
-0006a810: 6c5f 696e 7075 7429 0d0a 2020 2020 6d6f  l_input)..    mo
-0006a820: 6465 6c20 3d20 636f 7079 2e64 6565 7063  del = copy.deepc
-0006a830: 6f70 7928 6d6f 6465 6c5f 636f 7079 290d  opy(model_copy).
-0006a840: 0a20 2020 2073 7461 7274 5f74 696d 6520  .    start_time 
-0006a850: 3d20 7469 6d65 2e74 696d 6528 290d 0a20  = time.time().. 
-0006a860: 2020 2023 2323 2323 204e 6f77 2077 6520     ##### Now we 
-0006a870: 7769 6c6c 2073 7461 7274 2075 7369 6e67  will start using
-0006a880: 2052 6573 616d 706c 696e 6720 4c69 6272   Resampling Libr
-0006a890: 6172 7920 746f 206d 616b 6520 6461 7461  ary to make data
-0006a8a0: 206d 6f72 6520 6261 6c61 6e63 6564 2023   more balanced #
-0006a8b0: 2323 0d0a 2020 2020 6966 206d 6f64 656c  ##..    if model
-0006a8c0: 7479 7065 203d 3d20 2752 6567 7265 7373  type == 'Regress
-0006a8d0: 696f 6e27 3a0d 0a20 2020 2020 2020 2070  ion':..        p
-0006a8e0: 7269 6e74 2822 5573 696e 6720 5265 6772  rint("Using Regr
-0006a8f0: 6573 7369 6f6e 2052 6573 616d 706c 6572  ession Resampler
-0006a900: 206c 6962 7261 7279 2074 6f20 6d61 6b65   library to make
-0006a910: 2073 6b65 7765 6420 7461 7267 6574 2076   skewed target v
-0006a920: 6172 6961 626c 6520 6d6f 7265 2062 616c  ariable more bal
-0006a930: 616e 6365 642e 2e2e 2229 0d0a 2020 2020  anced...")..    
-0006a940: 656c 7365 3a0d 0a20 2020 2020 2020 2023  else:..        #
-0006a950: 7072 696e 7428 2255 7369 6e67 2053 4d4f  print("Using SMO
-0006a960: 5445 2773 206f 7665 722d 7361 6d70 6c69  TE's over-sampli
-0006a970: 6e67 2074 6563 686e 6971 7565 7320 746f  ng techniques to
-0006a980: 206d 616b 6520 7468 6520 2564 2063 6c61   make the %d cla
-0006a990: 7373 6573 2062 616c 616e 6365 642e 2e2e  sses balanced...
-0006a9a0: 2220 256c 656e 286e 702e 756e 6971 7565  " %len(np.unique
-0006a9b0: 2879 5f64 6629 2929 0d0a 2020 2020 2020  (y_df)))..      
-0006a9c0: 2020 6966 206d 6f64 656c 7479 7065 203d    if modeltype =
-0006a9d0: 3d20 2742 696e 6172 795f 436c 6173 7369  = 'Binary_Classi
-0006a9e0: 6669 6361 7469 6f6e 273a 0d0a 2020 2020  fication':..    
-0006a9f0: 2020 2020 2020 2020 7072 696e 7428 2755          print('U
-0006aa00: 7369 6e67 2053 656c 662d 5061 6365 6420  sing Self-Paced 
-0006aa10: 456e 7365 6d62 6c65 2043 6c61 7373 6966  Ensemble Classif
-0006aa20: 6965 7220 746f 2068 616e 646c 6520 7468  ier to handle th
-0006aa30: 6973 2049 6d62 616c 616e 6365 6420 6461  is Imbalanced da
-0006aa40: 7461 7365 742e 2e2e 2729 0d0a 2020 2020  taset...')..    
-0006aa50: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0006aa60: 2020 2020 2020 2070 7269 6e74 2827 5573         print('Us
-0006aa70: 696e 6720 4f6e 6556 7352 6573 742b 5365  ing OneVsRest+Se
-0006aa80: 6c66 2d50 6163 6564 2045 6e73 656d 626c  lf-Paced Ensembl
-0006aa90: 6520 436c 6173 7369 6669 6572 2074 6f20  e Classifier to 
-0006aaa0: 6861 6e64 6c65 2074 6869 7320 496d 6261  handle this Imba
-0006aab0: 6c61 6e63 6564 2064 6174 6173 6574 2e2e  lanced dataset..
-0006aac0: 2e27 290d 0a20 2020 2074 7279 3a0d 0a20  .')..    try:.. 
-0006aad0: 2020 2020 2020 2023 2323 2323 2323 2323         #########
+0006a4d0: 2020 2020 206d 6f64 656c 5f6c 6162 656c       model_label
+0006a4e0: 3d27 5369 6e67 6c65 5f4c 6162 656c 272c  ='Single_Label',
+0006a4f0: 2076 6572 626f 7365 3d30 293a 0d0a 2020   verbose=0):..  
+0006a500: 2020 2222 220d 0a20 2020 2023 2323 2323    """..    #####
+0006a510: 2323 2323 2020 2020 4f56 4552 5341 4d50  ####    OVERSAMP
+0006a520: 4c49 4e47 204f 4620 4d49 4e4f 5249 5459  LING OF MINORITY
+0006a530: 2043 4c41 5353 2041 4e44 2054 5241 494e   CLASS AND TRAIN
+0006a540: 494e 4720 2053 495a 4553 2020 2323 2323  ING  SIZES  ####
+0006a550: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
+0006a560: 2023 2323 2320 2053 4d4f 5445 2028 5379   ####  SMOTE (Sy
+0006a570: 6e74 6865 7469 6320 4d69 6e6f 7269 7479  nthetic Minority
+0006a580: 204f 7665 7273 616d 706c 696e 6720 5465   Oversampling Te
+0006a590: 6368 6e69 7175 6529 2077 6f72 6b73 2077  chnique) works w
+0006a5a0: 656c 6c20 7769 7468 2069 6d62 616c 616e  ell with imbalan
+0006a5b0: 6365 6420 636c 6173 7365 732e 0d0a 2020  ced classes...  
+0006a5c0: 2020 2323 2323 2020 5468 6973 2069 7320    ####  This is 
+0006a5d0: 6120 6772 6561 7420 7761 7920 746f 2074  a great way to t
+0006a5e0: 7261 696e 2061 206d 6f64 656c 2069 6e20  rain a model in 
+0006a5f0: 7375 6368 2063 6173 6573 2077 6974 6820  such cases with 
+0006a600: 7265 7065 6174 6564 2073 616d 706c 6573  repeated samples
+0006a610: 206f 6620 7261 7265 2d63 6c61 7373 0d0a   of rare-class..
+0006a620: 2020 2020 2323 2323 2020 616c 6f6e 6720      ####  along 
+0006a630: 7769 7468 2062 6174 6368 6573 206f 6620  with batches of 
+0006a640: 6d61 6a6f 7269 7479 2063 6c61 7373 2061  majority class a
+0006a650: 6e64 2067 6574 2074 6865 206d 6f64 656c  nd get the model
+0006a660: 2074 6f20 6469 6666 6572 656e 7469 6174   to differentiat
+0006a670: 6520 6265 7477 6565 6e20 3220 636c 6173  e between 2 clas
+0006a680: 7365 732e 0d0a 2020 2020 2323 2323 2020  ses...    ####  
+0006a690: 5468 6973 2063 616e 2061 6c73 6f20 6265  This can also be
+0006a6a0: 2075 7365 6420 666f 7220 5265 6772 6573   used for Regres
+0006a6b0: 7369 6f6e 2070 726f 626c 656d 7320 6279  sion problems by
+0006a6c0: 2075 7369 6e67 2074 6865 206e 756d 6572   using the numer
+0006a6d0: 6963 2074 6172 6765 7420 7661 6c75 6573  ic target values
+0006a6e0: 2063 6f6e 7665 7274 6564 0d0a 2020 2020   converted..    
+0006a6f0: 2323 2323 2020 746f 2063 6c75 7374 6572  ####  to cluster
+0006a700: 206c 6162 656c 7320 7573 696e 6720 4b4d   labels using KM
+0006a710: 6561 6e73 2e20 596f 7520 6361 6e20 7468  eans. You can th
+0006a720: 656e 2075 7365 2074 6865 2063 6c75 7374  en use the clust
+0006a730: 6572 206c 6162 656c 7320 746f 2061 6464  er labels to add
+0006a740: 206d 6f72 6520 7361 6d70 6c65 732e 0d0a   more samples...
+0006a750: 2020 2020 2323 2323 2323 2323 2320 2020      #########   
+0006a760: 204d 414b 4520 5355 5245 2059 4f55 2054   MAKE SURE YOU T
+0006a770: 554e 4520 5448 4520 4445 4641 554c 5453  UNE THE DEFAULTS
+0006a780: 2047 4956 454e 2048 4552 4521 2020 2323   GIVEN HERE!  ##
+0006a790: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
+0006a7a0: 2020 2022 2222 0d0a 2020 2020 585f 6466     """..    X_df
+0006a7b0: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
+0006a7c0: 2858 5f64 6629 0d0a 2020 2020 795f 6466  (X_df)..    y_df
+0006a7d0: 203d 2063 6f70 792e 6465 6570 636f 7079   = copy.deepcopy
+0006a7e0: 2879 5f64 6629 0d0a 2020 2020 6d6f 6465  (y_df)..    mode
+0006a7f0: 6c5f 636f 7079 203d 2063 6f70 792e 6465  l_copy = copy.de
+0006a800: 6570 636f 7079 286d 6f64 656c 5f69 6e70  epcopy(model_inp
+0006a810: 7574 290d 0a20 2020 206d 6f64 656c 203d  ut)..    model =
+0006a820: 2063 6f70 792e 6465 6570 636f 7079 286d   copy.deepcopy(m
+0006a830: 6f64 656c 5f63 6f70 7929 0d0a 2020 2020  odel_copy)..    
+0006a840: 7374 6172 745f 7469 6d65 203d 2074 696d  start_time = tim
+0006a850: 652e 7469 6d65 2829 0d0a 2020 2020 2323  e.time()..    ##
+0006a860: 2323 2320 4e6f 7720 7765 2077 696c 6c20  ### Now we will 
+0006a870: 7374 6172 7420 7573 696e 6720 5265 7361  start using Resa
+0006a880: 6d70 6c69 6e67 204c 6962 7261 7279 2074  mpling Library t
+0006a890: 6f20 6d61 6b65 2064 6174 6120 6d6f 7265  o make data more
+0006a8a0: 2062 616c 616e 6365 6420 2323 230d 0a20   balanced ###.. 
+0006a8b0: 2020 2069 6620 6d6f 6465 6c74 7970 6520     if modeltype 
+0006a8c0: 3d3d 2027 5265 6772 6573 7369 6f6e 273a  == 'Regression':
+0006a8d0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+0006a8e0: 2255 7369 6e67 2052 6567 7265 7373 696f  "Using Regressio
+0006a8f0: 6e20 5265 7361 6d70 6c65 7220 6c69 6272  n Resampler libr
+0006a900: 6172 7920 746f 206d 616b 6520 736b 6577  ary to make skew
+0006a910: 6564 2074 6172 6765 7420 7661 7269 6162  ed target variab
+0006a920: 6c65 206d 6f72 6520 6261 6c61 6e63 6564  le more balanced
+0006a930: 2e2e 2e22 290d 0a20 2020 2065 6c73 653a  ...")..    else:
+0006a940: 0d0a 2020 2020 2020 2020 2370 7269 6e74  ..        #print
+0006a950: 2822 5573 696e 6720 534d 4f54 4527 7320  ("Using SMOTE's 
+0006a960: 6f76 6572 2d73 616d 706c 696e 6720 7465  over-sampling te
+0006a970: 6368 6e69 7175 6573 2074 6f20 6d61 6b65  chniques to make
+0006a980: 2074 6865 2025 6420 636c 6173 7365 7320   the %d classes 
+0006a990: 6261 6c61 6e63 6564 2e2e 2e22 2025 6c65  balanced..." %le
+0006a9a0: 6e28 6e70 2e75 6e69 7175 6528 795f 6466  n(np.unique(y_df
+0006a9b0: 2929 290d 0a20 2020 2020 2020 2069 6620  )))..        if 
+0006a9c0: 6d6f 6465 6c74 7970 6520 3d3d 2027 4269  modeltype == 'Bi
+0006a9d0: 6e61 7279 5f43 6c61 7373 6966 6963 6174  nary_Classificat
+0006a9e0: 696f 6e27 3a0d 0a20 2020 2020 2020 2020  ion':..         
+0006a9f0: 2020 2070 7269 6e74 2827 5573 696e 6720     print('Using 
+0006aa00: 5365 6c66 2d50 6163 6564 2045 6e73 656d  Self-Paced Ensem
+0006aa10: 626c 6520 436c 6173 7369 6669 6572 2074  ble Classifier t
+0006aa20: 6f20 6861 6e64 6c65 2074 6869 7320 496d  o handle this Im
+0006aa30: 6261 6c61 6e63 6564 2064 6174 6173 6574  balanced dataset
+0006aa40: 2e2e 2e27 290d 0a20 2020 2020 2020 2065  ...')..        e
+0006aa50: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+0006aa60: 2020 7072 696e 7428 2755 7369 6e67 204f    print('Using O
+0006aa70: 6e65 5673 5265 7374 2b53 656c 662d 5061  neVsRest+Self-Pa
+0006aa80: 6365 6420 456e 7365 6d62 6c65 2043 6c61  ced Ensemble Cla
+0006aa90: 7373 6966 6965 7220 746f 2068 616e 646c  ssifier to handl
+0006aaa0: 6520 7468 6973 2049 6d62 616c 616e 6365  e this Imbalance
+0006aab0: 6420 6461 7461 7365 742e 2e2e 2729 0d0a  d dataset...')..
+0006aac0: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
+0006aad0: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
 0006aae0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006aaf0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006ab00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ab10: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-0006ab20: 2020 2020 2020 2020 2320 496e 6974 6961          # Initia
-0006ab30: 6c69 7a65 2074 6865 2072 6573 616d 706c  lize the resampl
-0006ab40: 6572 206f 626a 6563 740d 0a20 2020 2020  er object..     
-0006ab50: 2020 2064 665f 7472 6169 6e20 3d20 585f     df_train = X_
-0006ab60: 6466 2e6a 6f69 6e28 795f 6466 290d 0a20  df.join(y_df).. 
-0006ab70: 2020 2020 2020 2023 2047 656e 6572 6174         # Generat
-0006ab80: 6520 636c 6173 7365 730d 0a20 2020 2020  e classes..     
-0006ab90: 2020 2023 2323 2320 5365 6c65 6374 2074     #### Select t
-0006aba0: 6865 2072 6967 6874 2053 4d4f 5445 2061  he right SMOTE a
-0006abb0: 6c67 6f72 6974 686d 2062 6173 6564 206f  lgorithm based o
-0006abc0: 6e20 7768 6574 6865 7220 7468 6572 6520  n whether there 
-0006abd0: 6172 6520 616e 7920 696d 705f 6361 7473  are any imp_cats
-0006abe0: 2069 6e20 6461 7461 0d0a 2020 2020 2020   in data..      
-0006abf0: 2020 6361 745f 7661 7273 5f69 6e64 6578    cat_vars_index
-0006ac00: 203d 205b 6920 666f 7220 692c 206a 2069   = [i for i, j i
-0006ac10: 6e20 656e 756d 6572 6174 6528 585f 6466  n enumerate(X_df
-0006ac20: 2e63 6f6c 756d 6e73 2920 6966 206a 2069  .columns) if j i
-0006ac30: 6e20 696d 705f 6361 7473 5d0d 0a20 2020  n imp_cats]..   
-0006ac40: 2020 2020 2023 2323 2067 6574 2074 6865       ### get the
-0006ac50: 206e 756d 6265 7220 6f66 204b 5f4e 6569   number of K_Nei
-0006ac60: 6768 626f 7273 2075 7369 6e67 2074 6869  ghbors using thi
-0006ac70: 7320 6361 6c63 756c 6174 696f 6e0d 0a20  s calculation.. 
-0006ac80: 2020 2020 2020 2072 6172 655f 7361 6d70         rare_samp
-0006ac90: 6c65 7320 3d20 7064 2e53 6572 6965 7328  les = pd.Series(
-0006aca0: 436f 756e 7465 7228 795f 6466 2929 2e6d  Counter(y_df)).m
-0006acb0: 696e 2829 0d0a 2020 2020 2020 2020 2370  in()..        #p
-0006acc0: 7269 6e74 2827 2020 2020 4e75 6d62 6572  rint('    Number
-0006acd0: 206f 6620 5261 7265 2043 6c61 7373 2073   of Rare Class s
-0006ace0: 616d 706c 6573 203d 2025 6427 2025 7261  amples = %d' %ra
-0006acf0: 7265 5f73 616d 706c 6573 290d 0a20 2020  re_samples)..   
-0006ad00: 2020 2020 2072 6172 655f 7063 7420 3d20       rare_pct = 
-0006ad10: 7261 7265 5f73 616d 706c 6573 2f79 5f64  rare_samples/y_d
-0006ad20: 662e 7368 6170 655b 305d 0d0a 2020 2020  f.shape[0]..    
-0006ad30: 2020 2020 736d 616c 6c65 7374 5f6b 6e20      smallest_kn 
-0006ad40: 3d20 2072 6172 655f 7361 6d70 6c65 7320  =  rare_samples 
-0006ad50: 2d20 310d 0a20 2020 2020 2020 2069 6620  - 1..        if 
-0006ad60: 736d 616c 6c65 7374 5f6b 6e20 3e20 353a  smallest_kn > 5:
-0006ad70: 0d0a 2020 2020 2020 2020 2020 2020 736d  ..            sm
-0006ad80: 616c 6c65 7374 5f6b 6e20 3d20 350d 0a20  allest_kn = 5.. 
-0006ad90: 2020 2020 2020 2065 6c69 6620 736d 616c         elif smal
-0006ada0: 6c65 7374 5f6b 6e20 3e20 3220 616e 6420  lest_kn > 2 and 
-0006adb0: 736d 616c 6c65 7374 5f6b 6e20 3c20 353a  smallest_kn < 5:
-0006adc0: 0d0a 2020 2020 2020 2020 2020 2020 736d  ..            sm
-0006add0: 616c 6c65 7374 5f6b 6e20 3d20 320d 0a20  allest_kn = 2.. 
-0006ade0: 2020 2020 2020 2065 6c73 6520 3a0d 0a20         else :.. 
-0006adf0: 2020 2020 2020 2020 2020 2073 6d61 6c6c             small
-0006ae00: 6573 745f 6b6e 203d 2031 0d0a 2020 2020  est_kn = 1..    
-0006ae10: 2020 2020 2370 7269 6e74 2827 2020 2020      #print('    
-0006ae20: 4e75 6d62 6572 206f 6620 4b20 4e65 6967  Number of K Neig
-0006ae30: 6862 6f72 7320 7365 6c65 6374 6564 2066  hbors selected f
-0006ae40: 6f72 2053 4d4f 5445 203d 2025 6427 2025  or SMOTE = %d' %
-0006ae50: 736d 616c 6c65 7374 5f6b 6e29 0d0a 2020  smallest_kn)..  
-0006ae60: 2020 2020 2020 2370 7269 6e74 2827 2020        #print('  
-0006ae70: 2020 5063 7420 6f66 2052 6172 6520 436c    Pct of Rare Cl
-0006ae80: 6173 7320 696e 2064 6174 6120 3d20 2530  ass in data = %0
-0006ae90: 2e32 6625 2527 2025 2872 6172 655f 7063  .2f%%' %(rare_pc
-0006aea0: 742a 3130 3029 290d 0a20 2020 2020 2020  t*100))..       
-0006aeb0: 2069 6620 7261 7265 5f70 6374 203e 2030   if rare_pct > 0
-0006aec0: 2e31 303a 0d0a 2020 2020 2020 2020 2020  .10:..          
-0006aed0: 2020 7072 696e 7428 2720 2020 2054 6869    print('    Thi
-0006aee0: 7320 6973 206e 6f74 2061 6e20 496d 6261  s is not an Imba
-0006aef0: 6c61 6e63 6564 2064 6174 6120 7365 742e  lanced data set.
-0006af00: 204e 6f20 6e65 6564 2074 6f20 7573 6520   No need to use 
-0006af10: 534d 4f54 4520 6275 7420 636f 6e74 696e  SMOTE but contin
-0006af20: 7569 6e67 2e2e 2e27 290d 0a20 2020 2065  uing...')..    e
-0006af30: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
-0006af40: 7072 696e 7428 2720 2020 2053 4d4f 5445  print('    SMOTE
-0006af50: 2069 7320 6572 726f 7269 6e67 2e20 436f   is erroring. Co
-0006af60: 6e74 696e 7569 6e67 2077 6974 686f 7574  ntinuing without
-0006af70: 2053 4d4f 5445 2e2e 2e27 290d 0a20 2020   SMOTE...')..   
-0006af80: 2020 2020 2072 6574 7572 6e20 6d6f 6465       return mode
-0006af90: 6c0d 0a20 2020 2020 2020 2023 2323 2323  l..        #####
+0006ab10: 2323 2323 2323 2323 230d 0a20 2020 2020  #########..     
+0006ab20: 2020 2023 2049 6e69 7469 616c 697a 6520     # Initialize 
+0006ab30: 7468 6520 7265 7361 6d70 6c65 7220 6f62  the resampler ob
+0006ab40: 6a65 6374 0d0a 2020 2020 2020 2020 6466  ject..        df
+0006ab50: 5f74 7261 696e 203d 2058 5f64 662e 6a6f  _train = X_df.jo
+0006ab60: 696e 2879 5f64 6629 0d0a 2020 2020 2020  in(y_df)..      
+0006ab70: 2020 2320 4765 6e65 7261 7465 2063 6c61    # Generate cla
+0006ab80: 7373 6573 0d0a 2020 2020 2020 2020 2323  sses..        ##
+0006ab90: 2323 2053 656c 6563 7420 7468 6520 7269  ## Select the ri
+0006aba0: 6768 7420 534d 4f54 4520 616c 676f 7269  ght SMOTE algori
+0006abb0: 7468 6d20 6261 7365 6420 6f6e 2077 6865  thm based on whe
+0006abc0: 7468 6572 2074 6865 7265 2061 7265 2061  ther there are a
+0006abd0: 6e79 2069 6d70 5f63 6174 7320 696e 2064  ny imp_cats in d
+0006abe0: 6174 610d 0a20 2020 2020 2020 2063 6174  ata..        cat
+0006abf0: 5f76 6172 735f 696e 6465 7820 3d20 5b69  _vars_index = [i
+0006ac00: 2066 6f72 2069 2c20 6a20 696e 2065 6e75   for i, j in enu
+0006ac10: 6d65 7261 7465 2858 5f64 662e 636f 6c75  merate(X_df.colu
+0006ac20: 6d6e 7329 2069 6620 6a20 696e 2069 6d70  mns) if j in imp
+0006ac30: 5f63 6174 735d 0d0a 2020 2020 2020 2020  _cats]..        
+0006ac40: 2323 2320 6765 7420 7468 6520 6e75 6d62  ### get the numb
+0006ac50: 6572 206f 6620 4b5f 4e65 6967 6862 6f72  er of K_Neighbor
+0006ac60: 7320 7573 696e 6720 7468 6973 2063 616c  s using this cal
+0006ac70: 6375 6c61 7469 6f6e 0d0a 2020 2020 2020  culation..      
+0006ac80: 2020 7261 7265 5f73 616d 706c 6573 203d    rare_samples =
+0006ac90: 2070 642e 5365 7269 6573 2843 6f75 6e74   pd.Series(Count
+0006aca0: 6572 2879 5f64 6629 292e 6d69 6e28 290d  er(y_df)).min().
+0006acb0: 0a20 2020 2020 2020 2023 7072 696e 7428  .        #print(
+0006acc0: 2720 2020 204e 756d 6265 7220 6f66 2052  '    Number of R
+0006acd0: 6172 6520 436c 6173 7320 7361 6d70 6c65  are Class sample
+0006ace0: 7320 3d20 2564 2720 2572 6172 655f 7361  s = %d' %rare_sa
+0006acf0: 6d70 6c65 7329 0d0a 2020 2020 2020 2020  mples)..        
+0006ad00: 7261 7265 5f70 6374 203d 2072 6172 655f  rare_pct = rare_
+0006ad10: 7361 6d70 6c65 732f 795f 6466 2e73 6861  samples/y_df.sha
+0006ad20: 7065 5b30 5d0d 0a20 2020 2020 2020 2073  pe[0]..        s
+0006ad30: 6d61 6c6c 6573 745f 6b6e 203d 2020 7261  mallest_kn =  ra
+0006ad40: 7265 5f73 616d 706c 6573 202d 2031 0d0a  re_samples - 1..
+0006ad50: 2020 2020 2020 2020 6966 2073 6d61 6c6c          if small
+0006ad60: 6573 745f 6b6e 203e 2035 3a0d 0a20 2020  est_kn > 5:..   
+0006ad70: 2020 2020 2020 2020 2073 6d61 6c6c 6573           smalles
+0006ad80: 745f 6b6e 203d 2035 0d0a 2020 2020 2020  t_kn = 5..      
+0006ad90: 2020 656c 6966 2073 6d61 6c6c 6573 745f    elif smallest_
+0006ada0: 6b6e 203e 2032 2061 6e64 2073 6d61 6c6c  kn > 2 and small
+0006adb0: 6573 745f 6b6e 203c 2035 3a0d 0a20 2020  est_kn < 5:..   
+0006adc0: 2020 2020 2020 2020 2073 6d61 6c6c 6573           smalles
+0006add0: 745f 6b6e 203d 2032 0d0a 2020 2020 2020  t_kn = 2..      
+0006ade0: 2020 656c 7365 203a 0d0a 2020 2020 2020    else :..      
+0006adf0: 2020 2020 2020 736d 616c 6c65 7374 5f6b        smallest_k
+0006ae00: 6e20 3d20 310d 0a20 2020 2020 2020 2023  n = 1..        #
+0006ae10: 7072 696e 7428 2720 2020 204e 756d 6265  print('    Numbe
+0006ae20: 7220 6f66 204b 204e 6569 6768 626f 7273  r of K Neighbors
+0006ae30: 2073 656c 6563 7465 6420 666f 7220 534d   selected for SM
+0006ae40: 4f54 4520 3d20 2564 2720 2573 6d61 6c6c  OTE = %d' %small
+0006ae50: 6573 745f 6b6e 290d 0a20 2020 2020 2020  est_kn)..       
+0006ae60: 2023 7072 696e 7428 2720 2020 2050 6374   #print('    Pct
+0006ae70: 206f 6620 5261 7265 2043 6c61 7373 2069   of Rare Class i
+0006ae80: 6e20 6461 7461 203d 2025 302e 3266 2525  n data = %0.2f%%
+0006ae90: 2720 2528 7261 7265 5f70 6374 2a31 3030  ' %(rare_pct*100
+0006aea0: 2929 0d0a 2020 2020 2020 2020 6966 2072  ))..        if r
+0006aeb0: 6172 655f 7063 7420 3e20 302e 3130 3a0d  are_pct > 0.10:.
+0006aec0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+0006aed0: 6e74 2827 2020 2020 5468 6973 2069 7320  nt('    This is 
+0006aee0: 6e6f 7420 616e 2049 6d62 616c 616e 6365  not an Imbalance
+0006aef0: 6420 6461 7461 2073 6574 2e20 4e6f 206e  d data set. No n
+0006af00: 6565 6420 746f 2075 7365 2053 4d4f 5445  eed to use SMOTE
+0006af10: 2062 7574 2063 6f6e 7469 6e75 696e 672e   but continuing.
+0006af20: 2e2e 2729 0d0a 2020 2020 6578 6365 7074  ..')..    except
+0006af30: 3a0d 0a20 2020 2020 2020 2070 7269 6e74  :..        print
+0006af40: 2827 2020 2020 534d 4f54 4520 6973 2065  ('    SMOTE is e
+0006af50: 7272 6f72 696e 672e 2043 6f6e 7469 6e75  rroring. Continu
+0006af60: 696e 6720 7769 7468 6f75 7420 534d 4f54  ing without SMOT
+0006af70: 452e 2e2e 2729 0d0a 2020 2020 2020 2020  E...')..        
+0006af80: 7265 7475 726e 206d 6f64 656c 0d0a 2020  return model..  
+0006af90: 2020 2020 2020 2323 2323 2323 2323 2323        ##########
 0006afa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006afb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006afc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006afd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006afe0: 2323 0d0a 2020 2020 2323 2320 6e6f 7720  ##..    ### now 
-0006aff0: 7472 6169 6e20 7468 6520 6d6f 6465 6c20  train the model 
-0006b000: 6f6e 2066 756c 6c20 7472 6169 6e20 6461  on full train da
-0006b010: 7461 2023 2323 2323 2323 2323 2323 2323  ta #############
-0006b020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006b030: 2323 230d 0a20 2020 2069 6620 6d6f 6465  ###..    if mode
-0006b040: 6c74 7970 6520 3d3d 2027 5265 6772 6573  ltype == 'Regres
-0006b050: 7369 6f6e 273a 0d0a 2020 2020 2020 2020  sion':..        
-0006b060: 2320 5265 6772 6573 7369 6f6e 2070 726f  # Regression pro
-0006b070: 626c 656d 2074 7572 6e65 6420 696e 746f  blem turned into
-0006b080: 2043 6c61 7373 6966 6963 6174 696f 6e20   Classification 
-0006b090: 7072 6f62 6c65 6d0d 0a20 2020 2020 2020  problem..       
-0006b0a0: 206e 5f63 6c75 7374 6572 7320 3d20 6d61   n_clusters = ma
-0006b0b0: 7828 332c 2069 6e74 286e 702e 6c6f 6731  x(3, int(np.log1
-0006b0c0: 3028 6c65 6e28 795f 6466 2929 2920 2b20  0(len(y_df))) + 
-0006b0d0: 3129 0d0a 2020 2020 2020 2020 2320 5573  1)..        # Us
-0006b0e0: 6520 4b4d 6561 6e73 2074 6f20 6669 6e64  e KMeans to find
-0006b0f0: 206e 6174 7572 616c 2063 6c75 7374 6572   natural cluster
-0006b100: 7320 696e 2079 6f75 7220 6461 7461 0d0a  s in your data..
-0006b110: 2020 2020 2020 2020 6b6d 5f6d 6f64 656c          km_model
-0006b120: 203d 204b 4d65 616e 7328 6e5f 636c 7573   = KMeans(n_clus
-0006b130: 7465 7273 3d6e 5f63 6c75 7374 6572 732c  ters=n_clusters,
-0006b140: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0006b150: 2020 2020 2020 2020 2020 2020 6e5f 696e              n_in
-0006b160: 6974 3d35 2c0d 0a20 2020 2020 2020 2020  it=5,..         
-0006b170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006b180: 2072 616e 646f 6d5f 7374 6174 653d 3939   random_state=99
-0006b190: 290d 0a20 2020 2020 2020 2023 2323 2320  )..        #### 
-0006b1a0: 7265 6d65 6d62 6572 2079 6f75 206d 7573  remember you mus
-0006b1b0: 7420 7072 6564 6963 7420 7573 696e 6720  t predict using 
-0006b1c0: 6f6e 6c79 2070 7265 6469 6374 6f72 2076  only predictor v
-0006b1d0: 6172 6961 626c 6573 210d 0a20 2020 2020  ariables!..     
-0006b1e0: 2020 2059 5f63 6c61 7373 6573 203d 206b     Y_classes = k
-0006b1f0: 6d5f 6d6f 6465 6c2e 6669 745f 7072 6564  m_model.fit_pred
-0006b200: 6963 7428 585f 6466 290d 0a20 2020 2065  ict(X_df)..    e
-0006b210: 6c73 653a 0d0a 2020 2020 2020 2020 595f  lse:..        Y_
-0006b220: 636c 6173 7365 7320 3d20 636f 7079 2e64  classes = copy.d
-0006b230: 6565 7063 6f70 7928 795f 6466 290d 0a20  eepcopy(y_df).. 
-0006b240: 2020 2023 2323 2320 534d 4f54 4520 776f     #### SMOTE wo
-0006b250: 726b 7320 6f6e 6c79 2066 6f72 2053 696e  rks only for Sin
-0006b260: 676c 6520 4c61 6265 6c20 7072 6f62 6c65  gle Label proble
-0006b270: 6d73 2023 2323 230d 0a20 2020 2069 6620  ms ####..    if 
-0006b280: 6d6f 6465 6c5f 6c61 6265 6c20 3d3d 2027  model_label == '
-0006b290: 5369 6e67 6c65 5f4c 6162 656c 273a 0d0a  Single_Label':..
-0006b2a0: 2020 2020 2020 2020 636c 6173 735f 7765          class_we
-0006b2b0: 6967 6874 6564 5f72 6f77 7320 3d20 6765  ighted_rows = ge
-0006b2c0: 745f 636c 6173 735f 6469 7374 7269 6275  t_class_distribu
-0006b2d0: 7469 6f6e 2859 5f63 6c61 7373 6573 290d  tion(Y_classes).
-0006b2e0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-0006b2f0: 696d 705f 6361 7473 2920 3e20 303a 0d0a  imp_cats) > 0:..
-0006b300: 2020 2020 2020 2020 2020 2020 2320 596f              # Yo
-0006b310: 7572 2066 6176 6f75 7269 7465 206f 7665  ur favourite ove
-0006b320: 7273 616d 706c 6572 203d 2053 4d4f 5445  rsampler = SMOTE
-0006b330: 4e43 2069 7320 6265 7474 6572 2074 6861  NC is better tha
-0006b340: 6e20 534d 4f54 4520 696e 206d 6f73 7420  n SMOTE in most 
-0006b350: 6361 7365 7321 0d0a 2020 2020 2020 2020  cases!..        
-0006b360: 2020 2020 736d 6f74 6520 3d20 534d 4f54      smote = SMOT
-0006b370: 454e 4328 6361 7465 676f 7269 6361 6c5f  ENC(categorical_
-0006b380: 6665 6174 7572 6573 3d63 6174 5f76 6172  features=cat_var
-0006b390: 735f 696e 6465 782c 0d0a 2020 2020 2020  s_index,..      
-0006b3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006b3b0: 2020 7361 6d70 6c69 6e67 5f73 7472 6174    sampling_strat
-0006b3c0: 6567 793d 636c 6173 735f 7765 6967 6874  egy=class_weight
-0006b3d0: 6564 5f72 6f77 732c 0d0a 2020 2020 2020  ed_rows,..      
-0006b3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006b3f0: 2020 7261 6e64 6f6d 5f73 7461 7465 3d34    random_state=4
-0006b400: 322c 206b 5f6e 6569 6768 626f 7273 3d73  2, k_neighbors=s
-0006b410: 6d61 6c6c 6573 745f 6b6e 2c20 6e5f 6a6f  mallest_kn, n_jo
-0006b420: 6273 3d2d 3129 0d0a 2020 2020 2020 2020  bs=-1)..        
-0006b430: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0006b440: 2020 2023 2059 6f75 7220 6661 766f 7572     # Your favour
-0006b450: 6974 6520 6f76 6572 7361 6d70 6c65 7220  ite oversampler 
-0006b460: 3d20 534d 4f54 4520 6973 2062 6574 7465  = SMOTE is bette
-0006b470: 7220 7468 616e 2053 4d4f 5445 454e 4e20  r than SMOTEENN 
-0006b480: 696e 206d 6f73 7420 6361 7365 7321 0d0a  in most cases!..
-0006b490: 2020 2020 2020 2020 2020 2020 736d 6f74              smot
-0006b4a0: 6520 3d20 534d 4f54 4528 7261 6e64 6f6d  e = SMOTE(random
-0006b4b0: 5f73 7461 7465 3d32 372c 2073 616d 706c  _state=27, sampl
-0006b4c0: 696e 675f 7374 7261 7465 6779 3d63 6c61  ing_strategy=cla
-0006b4d0: 7373 5f77 6569 6768 7465 645f 726f 7773  ss_weighted_rows
-0006b4e0: 2c20 6e5f 6a6f 6273 3d2d 3129 0d0a 2020  , n_jobs=-1)..  
-0006b4f0: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
-0006b500: 2323 2323 2323 2323 2323 2020 2020 5265  ##########    Re
-0006b510: 6772 6573 7369 6f6e 2052 6573 616d 706c  gression Resampl
-0006b520: 6572 2020 2020 2323 2323 2323 2323 2323  er    ##########
-0006b530: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-0006b540: 0a20 2020 2074 7279 3a0d 0a20 2020 2020  .    try:..     
-0006b550: 2020 2069 6620 6d6f 6465 6c74 7970 6520     if modeltype 
-0006b560: 3d3d 2027 5265 6772 6573 7369 6f6e 273a  == 'Regression':
-0006b570: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-0006b580: 2323 2055 7369 6e67 2072 6567 2072 6573  ## Using reg res
-0006b590: 616d 706c 6572 2077 696c 6c20 6e65 6564  ampler will need
-0006b5a0: 2074 6172 6765 7420 636f 6c75 6d6e 2069   target column i
-0006b5b0: 6e20 6466 5f74 7261 696e 2074 7261 696e  n df_train train
-0006b5c0: 202d 2064 6f6e 2774 2066 6f72 6765 7421   - don't forget!
-0006b5d0: 0d0a 2020 2020 2020 2020 2020 2020 585f  ..            X_
-0006b5e0: 6466 5f72 6573 2c20 795f 6466 5f72 6573  df_res, y_df_res
-0006b5f0: 203d 206b 6d65 616e 735f 7265 7361 6d70   = kmeans_resamp
-0006b600: 6c65 7228 585f 6466 2c20 795f 6466 2c20  ler(X_df, y_df, 
-0006b610: 7461 7267 6574 2c20 736d 6f74 652c 2076  target, smote, v
-0006b620: 6572 626f 7365 290d 0a20 2020 2020 2020  erbose)..       
-0006b630: 2020 2020 2023 2323 2074 6865 2078 5f64       ### the x_d
-0006b640: 665f 7265 7320 6f75 7470 7574 206f 6620  f_res output of 
-0006b650: 7265 7361 6d70 6c65 7220 7769 6c6c 206e  resampler will n
-0006b660: 6f74 2068 6176 6520 7468 6520 7461 7267  ot have the targ
-0006b670: 6574 2073 696e 6365 2069 7420 7769 6c6c  et since it will
-0006b680: 2068 6176 6520 6265 656e 2072 656d 6f76   have been remov
-0006b690: 6564 210d 0a20 2020 2020 2020 2020 2020  ed!..           
-0006b6a0: 2023 2323 2079 5f64 665f 7265 7320 7769   ### y_df_res wi
-0006b6b0: 6c6c 2068 6176 6520 7468 6520 7461 7267  ll have the targ
-0006b6c0: 6574 2063 6f6c 756d 6e20 7769 7468 206e  et column with n
-0006b6d0: 6f77 2065 7874 7261 2072 6f77 7320 666f  ow extra rows fo
-0006b6e0: 7220 7265 6772 6573 7369 6f6e 2074 7261  r regression tra
-0006b6f0: 696e 696e 6721 0d0a 2020 2020 2020 2020  ining!..        
-0006b700: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0006b710: 2020 2023 2323 2320 466f 7220 636c 6173     #### For clas
-0006b720: 7369 6669 6361 7469 6f6e 2070 726f 626c  sification probl
-0006b730: 656d 7320 7369 6d70 6c79 2075 7369 6e67  ems simply using
-0006b740: 2074 6865 206f 7269 6769 6e61 6c20 6461   the original da
-0006b750: 7461 2077 696c 6c20 646f 0d0a 2020 2020  ta will do..    
-0006b760: 2020 2020 2020 2020 2358 5f64 665f 7265          #X_df_re
-0006b770: 732c 2079 5f64 665f 7265 7320 3d20 736d  s, y_df_res = sm
-0006b780: 6f74 652e 6669 745f 7265 7361 6d70 6c65  ote.fit_resample
-0006b790: 2858 5f64 662c 2079 5f64 6629 0d0a 2020  (X_df, y_df)..  
-0006b7a0: 2020 2020 2020 2020 2020 2323 2320 466f            ### Fo
-0006b7b0: 7220 636c 6173 7369 6669 6361 7469 6f6e  r classification
-0006b7c0: 2070 726f 626c 656d 7320 7765 2061 7265   problems we are
-0006b7d0: 2067 6f69 6e67 2074 6f20 7573 6520 5350   going to use SP
-0006b7e0: 4520 6672 6f6d 206e 6f77 206f 6e0d 0a20  E from now on.. 
-0006b7f0: 2020 2020 2020 2020 2020 2069 6620 6d6f             if mo
-0006b800: 6465 6c74 7970 6520 3d3d 2027 4269 6e61  deltype == 'Bina
-0006b810: 7279 5f43 6c61 7373 6966 6963 6174 696f  ry_Classificatio
-0006b820: 6e27 3a0d 0a20 2020 2020 2020 2020 2020  n':..           
-0006b830: 2020 2020 2023 2323 2046 6f72 2042 696e       ### For Bin
-0006b840: 6172 7920 636c 6173 732c 2053 5045 206d  ary class, SPE m
-0006b850: 6f64 656c 2069 7320 6265 7474 6572 2023  odel is better #
-0006b860: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
-0006b870: 2020 2020 2020 2020 2020 2020 2072 6620               rf 
-0006b880: 3d20 5261 6e64 6f6d 466f 7265 7374 436c  = RandomForestCl
-0006b890: 6173 7369 6669 6572 286e 5f65 7374 696d  assifier(n_estim
-0006b8a0: 6174 6f72 733d 3130 302c 2072 616e 646f  ators=100, rando
-0006b8b0: 6d5f 7374 6174 653d 3939 290d 0a20 2020  m_state=99)..   
-0006b8c0: 2020 2020 2020 2020 2020 2020 2073 7065               spe
-0006b8d0: 203d 2053 656c 6650 6163 6564 456e 7365   = SelfPacedEnse
-0006b8e0: 6d62 6c65 436c 6173 7369 6669 6572 2862  mbleClassifier(b
-0006b8f0: 6173 655f 6573 7469 6d61 746f 723d 7266  ase_estimator=rf
-0006b900: 2c20 6e5f 6a6f 6273 3d2d 312c 2073 6f66  , n_jobs=-1, sof
-0006b910: 745f 7265 7361 6d70 6c65 5f66 6c61 673d  t_resample_flag=
-0006b920: 4661 6c73 6529 0d0a 2020 2020 2020 2020  False)..        
-0006b930: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-0006b940: 2020 2020 2020 2020 2020 2023 2320 466f             ## Fo
-0006b950: 7220 6d75 6c74 692d 636c 6173 7320 4f6e  r multi-class On
-0006b960: 6576 7352 6573 7420 6d6f 6465 6c20 6973  evsRest model is
-0006b970: 2062 6574 7465 7220 2023 2323 2323 2323   better  #######
-0006b980: 2323 2323 0d0a 2020 2020 2020 2020 2020  ####..          
-0006b990: 2020 2020 2020 7266 203d 2052 616e 646f        rf = Rando
-0006b9a0: 6d46 6f72 6573 7443 6c61 7373 6966 6965  mForestClassifie
-0006b9b0: 7228 6e5f 6573 7469 6d61 746f 7273 3d31  r(n_estimators=1
-0006b9c0: 3030 2c20 7261 6e64 6f6d 5f73 7461 7465  00, random_state
-0006b9d0: 3d39 3929 0d0a 2020 2020 2020 2020 2020  =99)..          
-0006b9e0: 2020 2020 2020 7370 6520 3d20 5365 6c66        spe = Self
-0006b9f0: 5061 6365 6445 6e73 656d 626c 6543 6c61  PacedEnsembleCla
-0006ba00: 7373 6966 6965 7228 6261 7365 5f65 7374  ssifier(base_est
-0006ba10: 696d 6174 6f72 3d72 662c 206e 5f6a 6f62  imator=rf, n_job
-0006ba20: 733d 2d31 2c20 736f 6674 5f72 6573 616d  s=-1, soft_resam
-0006ba30: 706c 655f 666c 6167 3d46 616c 7365 290d  ple_flag=False).
-0006ba40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0006ba50: 2073 7065 203d 204f 6e65 5673 5265 7374   spe = OneVsRest
-0006ba60: 436c 6173 7369 6669 6572 2865 7374 696d  Classifier(estim
-0006ba70: 6174 6f72 3d73 7065 290d 0a20 2020 2020  ator=spe)..     
-0006ba80: 2020 2020 2020 2073 7065 2e66 6974 2858         spe.fit(X
-0006ba90: 5f64 662c 2079 5f64 6629 0d0a 2020 2020  _df, y_df)..    
-0006baa0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0006bab0: 7065 0d0a 2020 2020 6578 6365 7074 3a0d  pe..    except:.
-0006bac0: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
-0006bad0: 534d 4f54 4520 6f72 2052 6567 7265 7373  SMOTE or Regress
-0006bae0: 696f 6e2d 7265 7361 6d70 6c65 7220 6973  ion-resampler is
-0006baf0: 2065 7272 6f72 696e 672e 2043 6f6e 7469   erroring. Conti
-0006bb00: 6e75 696e 672e 2e2e 2729 0d0a 2020 2020  nuing...')..    
-0006bb10: 2020 2020 6d6f 6465 6c20 3d20 6d6f 6465      model = mode
-0006bb20: 6c5f 7472 6169 6e69 6e67 5f73 6d6f 7465  l_training_smote
-0006bb30: 286d 6f64 656c 2c20 585f 6466 2c20 795f  (model, X_df, y_
-0006bb40: 6466 2c20 6576 616c 5f73 6574 2c20 6576  df, eval_set, ev
-0006bb50: 616c 5f6d 6574 7269 632c 0d0a 2020 2020  al_metric,..    
-0006bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006bb70: 2020 2020 2020 2020 2070 6172 616d 732c           params,
-0006bb80: 2069 6d70 5f63 6174 732c 206d 6f64 656c   imp_cats, model
-0006bb90: 7479 7065 2c0d 0a20 2020 2020 2020 2020  type,..         
-0006bba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006bbb0: 2020 2063 616c 6962 7261 746f 725f 666c     calibrator_fl
-0006bbc0: 6167 2c20 6d6f 6465 6c5f 6e61 6d65 2c20  ag, model_name, 
-0006bbd0: 426f 6f73 7469 6e67 5f46 6c61 672c 206d  Boosting_Flag, m
-0006bbe0: 6f64 656c 5f6c 6162 656c 2c0d 0a20 2020  odel_label,..   
-0006bbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006bc00: 2020 2020 2020 2020 2020 4750 555f 6578            GPU_ex
-0006bc10: 6973 7473 290d 0a20 2020 2020 2020 2070  ists)..        p
-0006bc20: 7269 6e74 2827 2020 2020 4d6f 6465 6c20  rint('    Model 
-0006bc30: 5472 6169 6e69 6e67 2074 696d 6520 7461  Training time ta
-0006bc40: 6b65 6e20 3d20 2530 2e30 6620 7365 636f  ken = %0.0f seco
-0006bc50: 6e64 7327 2025 2874 696d 652e 7469 6d65  nds' %(time.time
-0006bc60: 2829 2d73 7461 7274 5f74 696d 6529 290d  ()-start_time)).
-0006bc70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0006bc80: 7370 650d 0a20 2020 2070 7269 6e74 2827  spe..    print('
-0006bc90: 5472 6169 6e69 6e67 206d 6f64 656c 206e  Training model n
-0006bca0: 6f77 206f 6e20 7265 7361 6d70 6c65 6420  ow on resampled 
-0006bcb0: 7472 6169 6e20 6461 7461 3a20 2573 2e20  train data: %s. 
-0006bcc0: 5468 6973 2077 696c 6c20 7461 6b65 2074  This will take t
-0006bcd0: 696d 652e 2e2e 2720 2528 585f 6466 5f72  ime...' %(X_df_r
-0006bce0: 6573 2e73 6861 7065 2c29 290d 0a20 2020  es.shape,))..   
-0006bcf0: 2023 2046 6974 2074 6865 206d 6f64 656c   # Fit the model
-0006bd00: 2075 7369 6e67 2078 5f74 7261 696e 2061   using x_train a
-0006bd10: 6e64 2079 5f74 7261 696e 2066 756c 6c20  nd y_train full 
-0006bd20: 6461 7461 2073 656e 7420 696e 0d0a 2020  data sent in..  
-0006bd30: 2020 6d6f 6465 6c20 3d20 6d6f 6465 6c5f    model = model_
-0006bd40: 7472 6169 6e69 6e67 5f73 6d6f 7465 286d  training_smote(m
-0006bd50: 6f64 656c 2c20 585f 6466 5f72 6573 2c20  odel, X_df_res, 
-0006bd60: 795f 6466 5f72 6573 2c20 6576 616c 5f73  y_df_res, eval_s
-0006bd70: 6574 2c20 6576 616c 5f6d 6574 7269 632c  et, eval_metric,
-0006bd80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0006bd90: 2020 2020 2020 2020 2020 2070 6172 616d             param
-0006bda0: 732c 2069 6d70 5f63 6174 732c 206d 6f64  s, imp_cats, mod
-0006bdb0: 656c 7479 7065 2c0d 0a20 2020 2020 2020  eltype,..       
-0006bdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006bdd0: 2063 616c 6962 7261 746f 725f 666c 6167   calibrator_flag
-0006bde0: 2c20 6d6f 6465 6c5f 6e61 6d65 2c20 426f  , model_name, Bo
-0006bdf0: 6f73 7469 6e67 5f46 6c61 672c 206d 6f64  osting_Flag, mod
-0006be00: 656c 5f6c 6162 656c 2c0d 0a20 2020 2020  el_label,..     
-0006be10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006be20: 2020 2020 4750 555f 6578 6973 7473 290d      GPU_exists).
-0006be30: 0a20 2020 2070 7269 6e74 2827 2020 2020  .    print('    
-0006be40: 5265 7361 6d70 6c65 6420 6461 7461 2054  Resampled data T
-0006be50: 7261 696e 696e 6720 7469 6d65 2074 616b  raining time tak
-0006be60: 656e 203d 2025 302e 3066 2073 6563 6f6e  en = %0.0f secon
-0006be70: 6473 2720 2528 7469 6d65 2e74 696d 6528  ds' %(time.time(
-0006be80: 292d 7374 6172 745f 7469 6d65 2929 0d0a  )-start_time))..
-0006be90: 2020 2020 234e 6f77 206d 616b 6520 7072      #Now make pr
-0006bea0: 6564 6963 7469 6f6e 7320 6f6e 2068 656c  edictions on hel
-0006beb0: 6420 6f75 7420 6461 7461 0d0a 2020 2020  d out data..    
-0006bec0: 6d6f 6465 6c5f 7374 7220 3d20 7374 7228  model_str = str(
-0006bed0: 6d6f 6465 6c29 2e73 706c 6974 2822 2822  model).split("("
-0006bee0: 295b 305d 0d0a 2020 2020 6966 2074 7261  )[0]..    if tra
-0006bef0: 696e 696e 673a 0d0a 2020 2020 2020 2020  ining:..        
-0006bf00: 785f 7465 7374 203d 2065 7661 6c5f 7365  x_test = eval_se
-0006bf10: 745b 305d 5b30 5d0d 0a20 2020 2020 2020  t[0][0]..       
-0006bf20: 2079 5f74 6573 7420 3d20 6576 616c 5f73   y_test = eval_s
-0006bf30: 6574 5b30 5d5b 315d 0d0a 2020 2020 2020  et[0][1]..      
-0006bf40: 2020 2320 4368 6563 6b20 7468 6520 7363    # Check the sc
-0006bf50: 6f72 650d 0a20 2020 2020 2020 2070 7269  ore..        pri
-0006bf60: 6e74 2827 2323 2323 2323 2323 2323 2323  nt('############
+0006afd0: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
+0006afe0: 2020 2023 2323 206e 6f77 2074 7261 696e     ### now train
+0006aff0: 2074 6865 206d 6f64 656c 206f 6e20 6675   the model on fu
+0006b000: 6c6c 2074 7261 696e 2064 6174 6120 2323  ll train data ##
+0006b010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006b020: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+0006b030: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
+0006b040: 203d 3d20 2752 6567 7265 7373 696f 6e27   == 'Regression'
+0006b050: 3a0d 0a20 2020 2020 2020 2023 2052 6567  :..        # Reg
+0006b060: 7265 7373 696f 6e20 7072 6f62 6c65 6d20  ression problem 
+0006b070: 7475 726e 6564 2069 6e74 6f20 436c 6173  turned into Clas
+0006b080: 7369 6669 6361 7469 6f6e 2070 726f 626c  sification probl
+0006b090: 656d 0d0a 2020 2020 2020 2020 6e5f 636c  em..        n_cl
+0006b0a0: 7573 7465 7273 203d 206d 6178 2833 2c20  usters = max(3, 
+0006b0b0: 696e 7428 6e70 2e6c 6f67 3130 286c 656e  int(np.log10(len
+0006b0c0: 2879 5f64 6629 2929 202b 2031 290d 0a20  (y_df))) + 1).. 
+0006b0d0: 2020 2020 2020 2023 2055 7365 204b 4d65         # Use KMe
+0006b0e0: 616e 7320 746f 2066 696e 6420 6e61 7475  ans to find natu
+0006b0f0: 7261 6c20 636c 7573 7465 7273 2069 6e20  ral clusters in 
+0006b100: 796f 7572 2064 6174 610d 0a20 2020 2020  your data..     
+0006b110: 2020 206b 6d5f 6d6f 6465 6c20 3d20 4b4d     km_model = KM
+0006b120: 6561 6e73 286e 5f63 6c75 7374 6572 733d  eans(n_clusters=
+0006b130: 6e5f 636c 7573 7465 7273 2c0d 0a20 2020  n_clusters,..   
+0006b140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006b150: 2020 2020 2020 206e 5f69 6e69 743d 352c         n_init=5,
+0006b160: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0006b170: 2020 2020 2020 2020 2020 2020 7261 6e64              rand
+0006b180: 6f6d 5f73 7461 7465 3d39 3929 0d0a 2020  om_state=99)..  
+0006b190: 2020 2020 2020 2323 2323 2072 656d 656d        #### remem
+0006b1a0: 6265 7220 796f 7520 6d75 7374 2070 7265  ber you must pre
+0006b1b0: 6469 6374 2075 7369 6e67 206f 6e6c 7920  dict using only 
+0006b1c0: 7072 6564 6963 746f 7220 7661 7269 6162  predictor variab
+0006b1d0: 6c65 7321 0d0a 2020 2020 2020 2020 595f  les!..        Y_
+0006b1e0: 636c 6173 7365 7320 3d20 6b6d 5f6d 6f64  classes = km_mod
+0006b1f0: 656c 2e66 6974 5f70 7265 6469 6374 2858  el.fit_predict(X
+0006b200: 5f64 6629 0d0a 2020 2020 656c 7365 3a0d  _df)..    else:.
+0006b210: 0a20 2020 2020 2020 2059 5f63 6c61 7373  .        Y_class
+0006b220: 6573 203d 2063 6f70 792e 6465 6570 636f  es = copy.deepco
+0006b230: 7079 2879 5f64 6629 0d0a 2020 2020 2323  py(y_df)..    ##
+0006b240: 2323 2053 4d4f 5445 2077 6f72 6b73 206f  ## SMOTE works o
+0006b250: 6e6c 7920 666f 7220 5369 6e67 6c65 204c  nly for Single L
+0006b260: 6162 656c 2070 726f 626c 656d 7320 2323  abel problems ##
+0006b270: 2323 0d0a 2020 2020 6966 206d 6f64 656c  ##..    if model
+0006b280: 5f6c 6162 656c 203d 3d20 2753 696e 676c  _label == 'Singl
+0006b290: 655f 4c61 6265 6c27 3a0d 0a20 2020 2020  e_Label':..     
+0006b2a0: 2020 2063 6c61 7373 5f77 6569 6768 7465     class_weighte
+0006b2b0: 645f 726f 7773 203d 2067 6574 5f63 6c61  d_rows = get_cla
+0006b2c0: 7373 5f64 6973 7472 6962 7574 696f 6e28  ss_distribution(
+0006b2d0: 595f 636c 6173 7365 7329 0d0a 2020 2020  Y_classes)..    
+0006b2e0: 2020 2020 6966 206c 656e 2869 6d70 5f63      if len(imp_c
+0006b2f0: 6174 7329 203e 2030 3a0d 0a20 2020 2020  ats) > 0:..     
+0006b300: 2020 2020 2020 2023 2059 6f75 7220 6661         # Your fa
+0006b310: 766f 7572 6974 6520 6f76 6572 7361 6d70  vourite oversamp
+0006b320: 6c65 7220 3d20 534d 4f54 454e 4320 6973  ler = SMOTENC is
+0006b330: 2062 6574 7465 7220 7468 616e 2053 4d4f   better than SMO
+0006b340: 5445 2069 6e20 6d6f 7374 2063 6173 6573  TE in most cases
+0006b350: 210d 0a20 2020 2020 2020 2020 2020 2073  !..            s
+0006b360: 6d6f 7465 203d 2053 4d4f 5445 4e43 2863  mote = SMOTENC(c
+0006b370: 6174 6567 6f72 6963 616c 5f66 6561 7475  ategorical_featu
+0006b380: 7265 733d 6361 745f 7661 7273 5f69 6e64  res=cat_vars_ind
+0006b390: 6578 2c0d 0a20 2020 2020 2020 2020 2020  ex,..           
+0006b3a0: 2020 2020 2020 2020 2020 2020 2073 616d               sam
+0006b3b0: 706c 696e 675f 7374 7261 7465 6779 3d63  pling_strategy=c
+0006b3c0: 6c61 7373 5f77 6569 6768 7465 645f 726f  lass_weighted_ro
+0006b3d0: 7773 2c0d 0a20 2020 2020 2020 2020 2020  ws,..           
+0006b3e0: 2020 2020 2020 2020 2020 2020 2072 616e               ran
+0006b3f0: 646f 6d5f 7374 6174 653d 3432 2c20 6b5f  dom_state=42, k_
+0006b400: 6e65 6967 6862 6f72 733d 736d 616c 6c65  neighbors=smalle
+0006b410: 7374 5f6b 6e2c 206e 5f6a 6f62 733d 2d31  st_kn, n_jobs=-1
+0006b420: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+0006b430: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0006b440: 596f 7572 2066 6176 6f75 7269 7465 206f  Your favourite o
+0006b450: 7665 7273 616d 706c 6572 203d 2053 4d4f  versampler = SMO
+0006b460: 5445 2069 7320 6265 7474 6572 2074 6861  TE is better tha
+0006b470: 6e20 534d 4f54 4545 4e4e 2069 6e20 6d6f  n SMOTEENN in mo
+0006b480: 7374 2063 6173 6573 210d 0a20 2020 2020  st cases!..     
+0006b490: 2020 2020 2020 2073 6d6f 7465 203d 2053         smote = S
+0006b4a0: 4d4f 5445 2872 616e 646f 6d5f 7374 6174  MOTE(random_stat
+0006b4b0: 653d 3237 2c20 7361 6d70 6c69 6e67 5f73  e=27, sampling_s
+0006b4c0: 7472 6174 6567 793d 636c 6173 735f 7765  trategy=class_we
+0006b4d0: 6967 6874 6564 5f72 6f77 732c 206e 5f6a  ighted_rows, n_j
+0006b4e0: 6f62 733d 2d31 290d 0a20 2020 2023 2323  obs=-1)..    ###
+0006b4f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0006b500: 2323 2323 2320 2020 2052 6567 7265 7373  #####    Regress
+0006b510: 696f 6e20 5265 7361 6d70 6c65 7220 2020  ion Resampler   
+0006b520: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
+0006b530: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+0006b540: 7472 793a 0d0a 2020 2020 2020 2020 6966  try:..        if
+0006b550: 206d 6f64 656c 7479 7065 203d 3d20 2752   modeltype == 'R
+0006b560: 6567 7265 7373 696f 6e27 3a0d 0a20 2020  egression':..   
+0006b570: 2020 2020 2020 2020 2023 2323 2320 5573           #### Us
+0006b580: 696e 6720 7265 6720 7265 7361 6d70 6c65  ing reg resample
+0006b590: 7220 7769 6c6c 206e 6565 6420 7461 7267  r will need targ
+0006b5a0: 6574 2063 6f6c 756d 6e20 696e 2064 665f  et column in df_
+0006b5b0: 7472 6169 6e20 7472 6169 6e20 2d20 646f  train train - do
+0006b5c0: 6e27 7420 666f 7267 6574 210d 0a20 2020  n't forget!..   
+0006b5d0: 2020 2020 2020 2020 2058 5f64 665f 7265           X_df_re
+0006b5e0: 732c 2079 5f64 665f 7265 7320 3d20 6b6d  s, y_df_res = km
+0006b5f0: 6561 6e73 5f72 6573 616d 706c 6572 2858  eans_resampler(X
+0006b600: 5f64 662c 2079 5f64 662c 2074 6172 6765  _df, y_df, targe
+0006b610: 742c 2073 6d6f 7465 2c20 7665 7262 6f73  t, smote, verbos
+0006b620: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+0006b630: 2323 2320 7468 6520 785f 6466 5f72 6573  ### the x_df_res
+0006b640: 206f 7574 7075 7420 6f66 2072 6573 616d   output of resam
+0006b650: 706c 6572 2077 696c 6c20 6e6f 7420 6861  pler will not ha
+0006b660: 7665 2074 6865 2074 6172 6765 7420 7369  ve the target si
+0006b670: 6e63 6520 6974 2077 696c 6c20 6861 7665  nce it will have
+0006b680: 2062 6565 6e20 7265 6d6f 7665 6421 0d0a   been removed!..
+0006b690: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+0006b6a0: 795f 6466 5f72 6573 2077 696c 6c20 6861  y_df_res will ha
+0006b6b0: 7665 2074 6865 2074 6172 6765 7420 636f  ve the target co
+0006b6c0: 6c75 6d6e 2077 6974 6820 6e6f 7720 6578  lumn with now ex
+0006b6d0: 7472 6120 726f 7773 2066 6f72 2072 6567  tra rows for reg
+0006b6e0: 7265 7373 696f 6e20 7472 6169 6e69 6e67  ression training
+0006b6f0: 210d 0a20 2020 2020 2020 2065 6c73 653a  !..        else:
+0006b700: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
+0006b710: 2323 2046 6f72 2063 6c61 7373 6966 6963  ## For classific
+0006b720: 6174 696f 6e20 7072 6f62 6c65 6d73 2073  ation problems s
+0006b730: 696d 706c 7920 7573 696e 6720 7468 6520  imply using the 
+0006b740: 6f72 6967 696e 616c 2064 6174 6120 7769  original data wi
+0006b750: 6c6c 2064 6f0d 0a20 2020 2020 2020 2020  ll do..         
+0006b760: 2020 2023 585f 6466 5f72 6573 2c20 795f     #X_df_res, y_
+0006b770: 6466 5f72 6573 203d 2073 6d6f 7465 2e66  df_res = smote.f
+0006b780: 6974 5f72 6573 616d 706c 6528 585f 6466  it_resample(X_df
+0006b790: 2c20 795f 6466 290d 0a20 2020 2020 2020  , y_df)..       
+0006b7a0: 2020 2020 2023 2323 2046 6f72 2063 6c61       ### For cla
+0006b7b0: 7373 6966 6963 6174 696f 6e20 7072 6f62  ssification prob
+0006b7c0: 6c65 6d73 2077 6520 6172 6520 676f 696e  lems we are goin
+0006b7d0: 6720 746f 2075 7365 2053 5045 2066 726f  g to use SPE fro
+0006b7e0: 6d20 6e6f 7720 6f6e 0d0a 2020 2020 2020  m now on..      
+0006b7f0: 2020 2020 2020 6966 206d 6f64 656c 7479        if modelty
+0006b800: 7065 203d 3d20 2742 696e 6172 795f 436c  pe == 'Binary_Cl
+0006b810: 6173 7369 6669 6361 7469 6f6e 273a 0d0a  assification':..
+0006b820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006b830: 2323 2320 466f 7220 4269 6e61 7279 2063  ### For Binary c
+0006b840: 6c61 7373 2c20 5350 4520 6d6f 6465 6c20  lass, SPE model 
+0006b850: 6973 2062 6574 7465 7220 2323 2323 2323  is better ######
+0006b860: 2323 2323 2323 0d0a 2020 2020 2020 2020  ######..        
+0006b870: 2020 2020 2020 2020 7266 203d 2052 616e          rf = Ran
+0006b880: 646f 6d46 6f72 6573 7443 6c61 7373 6966  domForestClassif
+0006b890: 6965 7228 6e5f 6573 7469 6d61 746f 7273  ier(n_estimators
+0006b8a0: 3d31 3030 2c20 7261 6e64 6f6d 5f73 7461  =100, random_sta
+0006b8b0: 7465 3d39 3929 0d0a 2020 2020 2020 2020  te=99)..        
+0006b8c0: 2020 2020 2020 2020 7370 6520 3d20 5365          spe = Se
+0006b8d0: 6c66 5061 6365 6445 6e73 656d 626c 6543  lfPacedEnsembleC
+0006b8e0: 6c61 7373 6966 6965 7228 6573 7469 6d61  lassifier(estima
+0006b8f0: 746f 723d 7266 2c20 6e5f 6a6f 6273 3d2d  tor=rf, n_jobs=-
+0006b900: 312c 2073 6f66 745f 7265 7361 6d70 6c65  1, soft_resample
+0006b910: 5f66 6c61 673d 4661 6c73 6529 0d0a 2020  _flag=False)..  
+0006b920: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+0006b930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0006b940: 2023 2320 466f 7220 6d75 6c74 692d 636c   ## For multi-cl
+0006b950: 6173 7320 4f6e 6576 7352 6573 7420 6d6f  ass OnevsRest mo
+0006b960: 6465 6c20 6973 2062 6574 7465 7220 2023  del is better  #
+0006b970: 2323 2323 2323 2323 2323 0d0a 2020 2020  ##########..    
+0006b980: 2020 2020 2020 2020 2020 2020 7266 203d              rf =
+0006b990: 2052 616e 646f 6d46 6f72 6573 7443 6c61   RandomForestCla
+0006b9a0: 7373 6966 6965 7228 6e5f 6573 7469 6d61  ssifier(n_estima
+0006b9b0: 746f 7273 3d31 3030 2c20 7261 6e64 6f6d  tors=100, random
+0006b9c0: 5f73 7461 7465 3d39 3929 0d0a 2020 2020  _state=99)..    
+0006b9d0: 2020 2020 2020 2020 2020 2020 7370 6520              spe 
+0006b9e0: 3d20 5365 6c66 5061 6365 6445 6e73 656d  = SelfPacedEnsem
+0006b9f0: 626c 6543 6c61 7373 6966 6965 7228 6573  bleClassifier(es
+0006ba00: 7469 6d61 746f 723d 7266 2c20 6e5f 6a6f  timator=rf, n_jo
+0006ba10: 6273 3d2d 312c 2073 6f66 745f 7265 7361  bs=-1, soft_resa
+0006ba20: 6d70 6c65 5f66 6c61 673d 4661 6c73 6529  mple_flag=False)
+0006ba30: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0006ba40: 2020 7370 6520 3d20 4f6e 6556 7352 6573    spe = OneVsRes
+0006ba50: 7443 6c61 7373 6966 6965 7228 6573 7469  tClassifier(esti
+0006ba60: 6d61 746f 723d 7370 6529 0d0a 2020 2020  mator=spe)..    
+0006ba70: 2020 2020 2020 2020 7370 652e 6669 7428          spe.fit(
+0006ba80: 585f 6466 2c20 795f 6466 290d 0a20 2020  X_df, y_df)..   
+0006ba90: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0006baa0: 7370 650d 0a20 2020 2065 7863 6570 743a  spe..    except:
+0006bab0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+0006bac0: 2753 4d4f 5445 206f 7220 5265 6772 6573  'SMOTE or Regres
+0006bad0: 7369 6f6e 2d72 6573 616d 706c 6572 2069  sion-resampler i
+0006bae0: 7320 6572 726f 7269 6e67 2e20 436f 6e74  s erroring. Cont
+0006baf0: 696e 7569 6e67 2e2e 2e27 290d 0a20 2020  inuing...')..   
+0006bb00: 2020 2020 206d 6f64 656c 203d 206d 6f64       model = mod
+0006bb10: 656c 5f74 7261 696e 696e 675f 736d 6f74  el_training_smot
+0006bb20: 6528 6d6f 6465 6c2c 2058 5f64 662c 2079  e(model, X_df, y
+0006bb30: 5f64 662c 2065 7661 6c5f 7365 742c 2065  _df, eval_set, e
+0006bb40: 7661 6c5f 6d65 7472 6963 2c0d 0a20 2020  val_metric,..   
+0006bb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006bb60: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+0006bb70: 2c20 696d 705f 6361 7473 2c20 6d6f 6465  , imp_cats, mode
+0006bb80: 6c74 7970 652c 0d0a 2020 2020 2020 2020  ltype,..        
+0006bb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006bba0: 2020 2020 6361 6c69 6272 6174 6f72 5f66      calibrator_f
+0006bbb0: 6c61 672c 206d 6f64 656c 5f6e 616d 652c  lag, model_name,
+0006bbc0: 2042 6f6f 7374 696e 675f 466c 6167 2c20   Boosting_Flag, 
+0006bbd0: 6d6f 6465 6c5f 6c61 6265 6c2c 0d0a 2020  model_label,..  
+0006bbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006bbf0: 2020 2020 2020 2020 2020 2047 5055 5f65             GPU_e
+0006bc00: 7869 7374 7329 0d0a 2020 2020 2020 2020  xists)..        
+0006bc10: 7072 696e 7428 2720 2020 204d 6f64 656c  print('    Model
+0006bc20: 2054 7261 696e 696e 6720 7469 6d65 2074   Training time t
+0006bc30: 616b 656e 203d 2025 302e 3066 2073 6563  aken = %0.0f sec
+0006bc40: 6f6e 6473 2720 2528 7469 6d65 2e74 696d  onds' %(time.tim
+0006bc50: 6528 292d 7374 6172 745f 7469 6d65 2929  e()-start_time))
+0006bc60: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0006bc70: 2073 7065 0d0a 2020 2020 7072 696e 7428   spe..    print(
+0006bc80: 2754 7261 696e 696e 6720 6d6f 6465 6c20  'Training model 
+0006bc90: 6e6f 7720 6f6e 2072 6573 616d 706c 6564  now on resampled
+0006bca0: 2074 7261 696e 2064 6174 613a 2025 732e   train data: %s.
+0006bcb0: 2054 6869 7320 7769 6c6c 2074 616b 6520   This will take 
+0006bcc0: 7469 6d65 2e2e 2e27 2025 2858 5f64 665f  time...' %(X_df_
+0006bcd0: 7265 732e 7368 6170 652c 2929 0d0a 2020  res.shape,))..  
+0006bce0: 2020 2320 4669 7420 7468 6520 6d6f 6465    # Fit the mode
+0006bcf0: 6c20 7573 696e 6720 785f 7472 6169 6e20  l using x_train 
+0006bd00: 616e 6420 795f 7472 6169 6e20 6675 6c6c  and y_train full
+0006bd10: 2064 6174 6120 7365 6e74 2069 6e0d 0a20   data sent in.. 
+0006bd20: 2020 206d 6f64 656c 203d 206d 6f64 656c     model = model
+0006bd30: 5f74 7261 696e 696e 675f 736d 6f74 6528  _training_smote(
+0006bd40: 6d6f 6465 6c2c 2058 5f64 665f 7265 732c  model, X_df_res,
+0006bd50: 2079 5f64 665f 7265 732c 2065 7661 6c5f   y_df_res, eval_
+0006bd60: 7365 742c 2065 7661 6c5f 6d65 7472 6963  set, eval_metric
+0006bd70: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0006bd80: 2020 2020 2020 2020 2020 2020 7061 7261              para
+0006bd90: 6d73 2c20 696d 705f 6361 7473 2c20 6d6f  ms, imp_cats, mo
+0006bda0: 6465 6c74 7970 652c 0d0a 2020 2020 2020  deltype,..      
+0006bdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006bdc0: 2020 6361 6c69 6272 6174 6f72 5f66 6c61    calibrator_fla
+0006bdd0: 672c 206d 6f64 656c 5f6e 616d 652c 2042  g, model_name, B
+0006bde0: 6f6f 7374 696e 675f 466c 6167 2c20 6d6f  oosting_Flag, mo
+0006bdf0: 6465 6c5f 6c61 6265 6c2c 0d0a 2020 2020  del_label,..    
+0006be00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006be10: 2020 2020 2047 5055 5f65 7869 7374 7329       GPU_exists)
+0006be20: 0d0a 2020 2020 7072 696e 7428 2720 2020  ..    print('   
+0006be30: 2052 6573 616d 706c 6564 2064 6174 6120   Resampled data 
+0006be40: 5472 6169 6e69 6e67 2074 696d 6520 7461  Training time ta
+0006be50: 6b65 6e20 3d20 2530 2e30 6620 7365 636f  ken = %0.0f seco
+0006be60: 6e64 7327 2025 2874 696d 652e 7469 6d65  nds' %(time.time
+0006be70: 2829 2d73 7461 7274 5f74 696d 6529 290d  ()-start_time)).
+0006be80: 0a20 2020 2023 4e6f 7720 6d61 6b65 2070  .    #Now make p
+0006be90: 7265 6469 6374 696f 6e73 206f 6e20 6865  redictions on he
+0006bea0: 6c64 206f 7574 2064 6174 610d 0a20 2020  ld out data..   
+0006beb0: 206d 6f64 656c 5f73 7472 203d 2073 7472   model_str = str
+0006bec0: 286d 6f64 656c 292e 7370 6c69 7428 2228  (model).split("(
+0006bed0: 2229 5b30 5d0d 0a20 2020 2069 6620 7472  ")[0]..    if tr
+0006bee0: 6169 6e69 6e67 3a0d 0a20 2020 2020 2020  aining:..       
+0006bef0: 2078 5f74 6573 7420 3d20 6576 616c 5f73   x_test = eval_s
+0006bf00: 6574 5b30 5d5b 305d 0d0a 2020 2020 2020  et[0][0]..      
+0006bf10: 2020 795f 7465 7374 203d 2065 7661 6c5f    y_test = eval_
+0006bf20: 7365 745b 305d 5b31 5d0d 0a20 2020 2020  set[0][1]..     
+0006bf30: 2020 2023 2043 6865 636b 2074 6865 2073     # Check the s
+0006bf40: 636f 7265 0d0a 2020 2020 2020 2020 7072  core..        pr
+0006bf50: 696e 7428 2723 2323 2323 2323 2323 2323  int('###########
+0006bf60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006bf70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006bf80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006bf90: 2323 2323 2323 2323 2323 2323 2729 0d0a  ############')..
-0006bfa0: 2020 2020 2020 2020 7072 696e 7428 2752          print('R
-0006bfb0: 6573 616d 706c 6564 206d 6f64 656c 2072  esampled model r
-0006bfc0: 6573 756c 7473 206f 6e20 4865 6c64 206f  esults on Held o
-0006bfd0: 7574 2056 616c 6964 6174 696f 6e20 6461  ut Validation da
-0006bfe0: 7461 3a27 290d 0a20 2020 2020 2020 2069  ta:')..        i
-0006bff0: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
-0006c000: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
-0006c010: 2020 2020 2020 2020 2020 7072 696e 745f            print_
-0006c020: 7265 6772 6573 7369 6f6e 5f6d 6574 7269  regression_metri
-0006c030: 6373 2879 5f74 6573 742c 206d 6f64 656c  cs(y_test, model
-0006c040: 2e70 7265 6469 6374 2878 5f74 6573 7429  .predict(x_test)
-0006c050: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-0006c060: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-0006c070: 696e 7428 636c 6173 7369 6669 6361 7469  int(classificati
-0006c080: 6f6e 5f72 6570 6f72 7428 795f 7465 7374  on_report(y_test
-0006c090: 2c20 6d6f 6465 6c2e 7072 6564 6963 7428  , model.predict(
-0006c0a0: 785f 7465 7374 2929 290d 0a20 2020 2020  x_test)))..     
-0006c0b0: 2020 2070 7269 6e74 2827 2323 2323 2323     print('######
-0006c0c0: 2323 2323 2323 2323 2323 2323 2020 436f  ############  Co
-0006c0d0: 6d70 6c65 7465 6420 496d 6261 6c61 6e63  mpleted Imbalanc
-0006c0e0: 6564 2054 7261 696e 696e 6720 7573 696e  ed Training usin
-0006c0f0: 6720 2573 2023 2323 2323 2323 2323 2323  g %s ###########
-0006c100: 2323 2323 2327 2025 6d6f 6465 6c5f 7374  #####' %model_st
-0006c110: 7229 0d0a 2020 2020 656c 7365 3a0d 0a20  r)..    else:.. 
-0006c120: 2020 2020 2020 2069 6620 7665 7262 6f73         if verbos
-0006c130: 6520 3e3d 2031 3a0d 0a20 2020 2020 2020  e >= 1:..       
-0006c140: 2020 2020 2066 6967 2c20 2861 7831 2c20       fig, (ax1, 
-0006c150: 6178 3229 203d 2070 6c74 2e73 7562 706c  ax2) = plt.subpl
-0006c160: 6f74 7328 312c 2032 2c20 7368 6172 6579  ots(1, 2, sharey
-0006c170: 3d54 7275 652c 6669 6773 697a 653d 2831  =True,figsize=(1
-0006c180: 322c 3529 290d 0a20 2020 2020 2020 2020  2,5))..         
-0006c190: 2020 2069 6620 6d6f 6465 6c74 7970 6520     if modeltype 
-0006c1a0: 3d3d 2027 5265 6772 6573 7369 6f6e 273a  == 'Regression':
-0006c1b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0006c1c0: 2020 795f 6466 2e70 6c6f 7428 6b69 6e64    y_df.plot(kind
-0006c1d0: 3d27 6869 7374 272c 7469 746c 653d 2744  ='hist',title='D
-0006c1e0: 6973 742e 206f 6620 7461 7267 6574 2062  ist. of target b
-0006c1f0: 6566 6f72 6520 5265 6772 6573 7369 6f6e  efore Regression
-0006c200: 2052 6573 616d 706c 6572 272c 2061 783d   Resampler', ax=
-0006c210: 6178 312c 2063 6f6c 6f72 3d27 7227 290d  ax1, color='r').
-0006c220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0006c230: 2070 642e 4461 7461 4672 616d 6528 795f   pd.DataFrame(y_
-0006c240: 6466 5f72 6573 292e 706c 6f74 286b 696e  df_res).plot(kin
-0006c250: 643d 2768 6973 7427 2c74 6974 6c65 3d27  d='hist',title='
-0006c260: 4469 7374 2e20 6f66 2074 6172 6765 7420  Dist. of target 
-0006c270: 6166 7465 7220 5265 6772 6573 7369 6f6e  after Regression
-0006c280: 2052 6573 616d 706c 6572 272c 2061 783d   Resampler', ax=
-0006c290: 6178 322c 2063 6f6c 6f72 3d27 6227 290d  ax2, color='b').
-0006c2a0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-0006c2b0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0006c2c0: 2020 2020 795f 6466 2e76 616c 7565 5f63      y_df.value_c
-0006c2d0: 6f75 6e74 7328 3129 2e70 6c6f 7428 6b69  ounts(1).plot(ki
-0006c2e0: 6e64 3d27 6261 7227 2c74 6974 6c65 3d27  nd='bar',title='
-0006c2f0: 4469 7374 7269 6275 7469 6f6e 206f 6620  Distribution of 
-0006c300: 636c 6173 7365 7320 6265 666f 7265 2053  classes before S
-0006c310: 4d4f 5445 272c 2061 783d 6178 312c 2063  MOTE', ax=ax1, c
-0006c320: 6f6c 6f72 3d27 7227 290d 0a20 2020 2020  olor='r')..     
-0006c330: 2020 2020 2020 2020 2020 2079 5f64 665f             y_df_
-0006c340: 7265 732e 7661 6c75 655f 636f 756e 7473  res.value_counts
-0006c350: 2831 292e 706c 6f74 286b 696e 643d 2762  (1).plot(kind='b
-0006c360: 6172 272c 7469 746c 653d 2744 6973 7472  ar',title='Distr
-0006c370: 6962 7574 696f 6e20 6f66 2063 6c61 7373  ibution of class
-0006c380: 6573 2061 6674 6572 2053 4d4f 5445 272c  es after SMOTE',
-0006c390: 2061 783d 6178 322c 2063 6f6c 6f72 3d27   ax=ax2, color='
-0006c3a0: 6227 290d 0a20 2020 2072 6574 7572 6e20  b')..    return 
-0006c3b0: 6d6f 6465 6c0d 0a23 2323 2323 2323 2323  model..#########
+0006bf80: 2323 2323 2323 2323 2323 2323 2327 290d  #############').
+0006bf90: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
+0006bfa0: 5265 7361 6d70 6c65 6420 6d6f 6465 6c20  Resampled model 
+0006bfb0: 7265 7375 6c74 7320 6f6e 2048 656c 6420  results on Held 
+0006bfc0: 6f75 7420 5661 6c69 6461 7469 6f6e 2064  out Validation d
+0006bfd0: 6174 613a 2729 0d0a 2020 2020 2020 2020  ata:')..        
+0006bfe0: 6966 206d 6f64 656c 7479 7065 203d 3d20  if modeltype == 
+0006bff0: 2752 6567 7265 7373 696f 6e27 3a0d 0a20  'Regression':.. 
+0006c000: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+0006c010: 5f72 6567 7265 7373 696f 6e5f 6d65 7472  _regression_metr
+0006c020: 6963 7328 795f 7465 7374 2c20 6d6f 6465  ics(y_test, mode
+0006c030: 6c2e 7072 6564 6963 7428 785f 7465 7374  l.predict(x_test
+0006c040: 2929 0d0a 2020 2020 2020 2020 656c 7365  ))..        else
+0006c050: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
+0006c060: 7269 6e74 2863 6c61 7373 6966 6963 6174  rint(classificat
+0006c070: 696f 6e5f 7265 706f 7274 2879 5f74 6573  ion_report(y_tes
+0006c080: 742c 206d 6f64 656c 2e70 7265 6469 6374  t, model.predict
+0006c090: 2878 5f74 6573 7429 2929 0d0a 2020 2020  (x_test)))..    
+0006c0a0: 2020 2020 7072 696e 7428 2723 2323 2323      print('#####
+0006c0b0: 2323 2323 2323 2323 2323 2323 2320 2043  #############  C
+0006c0c0: 6f6d 706c 6574 6564 2049 6d62 616c 616e  ompleted Imbalan
+0006c0d0: 6365 6420 5472 6169 6e69 6e67 2075 7369  ced Training usi
+0006c0e0: 6e67 2025 7320 2323 2323 2323 2323 2323  ng %s ##########
+0006c0f0: 2323 2323 2323 2720 256d 6f64 656c 5f73  ######' %model_s
+0006c100: 7472 290d 0a20 2020 2065 6c73 653a 0d0a  tr)..    else:..
+0006c110: 2020 2020 2020 2020 6966 2076 6572 626f          if verbo
+0006c120: 7365 203e 3d20 313a 0d0a 2020 2020 2020  se >= 1:..      
+0006c130: 2020 2020 2020 6669 672c 2028 6178 312c        fig, (ax1,
+0006c140: 2061 7832 2920 3d20 706c 742e 7375 6270   ax2) = plt.subp
+0006c150: 6c6f 7473 2831 2c20 322c 2073 6861 7265  lots(1, 2, share
+0006c160: 793d 5472 7565 2c66 6967 7369 7a65 3d28  y=True,figsize=(
+0006c170: 3132 2c35 2929 0d0a 2020 2020 2020 2020  12,5))..        
+0006c180: 2020 2020 6966 206d 6f64 656c 7479 7065      if modeltype
+0006c190: 203d 3d20 2752 6567 7265 7373 696f 6e27   == 'Regression'
+0006c1a0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0006c1b0: 2020 2079 5f64 662e 706c 6f74 286b 696e     y_df.plot(kin
+0006c1c0: 643d 2768 6973 7427 2c74 6974 6c65 3d27  d='hist',title='
+0006c1d0: 4469 7374 2e20 6f66 2074 6172 6765 7420  Dist. of target 
+0006c1e0: 6265 666f 7265 2052 6567 7265 7373 696f  before Regressio
+0006c1f0: 6e20 5265 7361 6d70 6c65 7227 2c20 6178  n Resampler', ax
+0006c200: 3d61 7831 2c20 636f 6c6f 723d 2772 2729  =ax1, color='r')
+0006c210: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0006c220: 2020 7064 2e44 6174 6146 7261 6d65 2879    pd.DataFrame(y
+0006c230: 5f64 665f 7265 7329 2e70 6c6f 7428 6b69  _df_res).plot(ki
+0006c240: 6e64 3d27 6869 7374 272c 7469 746c 653d  nd='hist',title=
+0006c250: 2744 6973 742e 206f 6620 7461 7267 6574  'Dist. of target
+0006c260: 2061 6674 6572 2052 6567 7265 7373 696f   after Regressio
+0006c270: 6e20 5265 7361 6d70 6c65 7227 2c20 6178  n Resampler', ax
+0006c280: 3d61 7832 2c20 636f 6c6f 723d 2762 2729  =ax2, color='b')
+0006c290: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+0006c2a0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0006c2b0: 2020 2020 2079 5f64 662e 7661 6c75 655f       y_df.value_
+0006c2c0: 636f 756e 7473 2831 292e 706c 6f74 286b  counts(1).plot(k
+0006c2d0: 696e 643d 2762 6172 272c 7469 746c 653d  ind='bar',title=
+0006c2e0: 2744 6973 7472 6962 7574 696f 6e20 6f66  'Distribution of
+0006c2f0: 2063 6c61 7373 6573 2062 6566 6f72 6520   classes before 
+0006c300: 534d 4f54 4527 2c20 6178 3d61 7831 2c20  SMOTE', ax=ax1, 
+0006c310: 636f 6c6f 723d 2772 2729 0d0a 2020 2020  color='r')..    
+0006c320: 2020 2020 2020 2020 2020 2020 795f 6466              y_df
+0006c330: 5f72 6573 2e76 616c 7565 5f63 6f75 6e74  _res.value_count
+0006c340: 7328 3129 2e70 6c6f 7428 6b69 6e64 3d27  s(1).plot(kind='
+0006c350: 6261 7227 2c74 6974 6c65 3d27 4469 7374  bar',title='Dist
+0006c360: 7269 6275 7469 6f6e 206f 6620 636c 6173  ribution of clas
+0006c370: 7365 7320 6166 7465 7220 534d 4f54 4527  ses after SMOTE'
+0006c380: 2c20 6178 3d61 7832 2c20 636f 6c6f 723d  , ax=ax2, color=
+0006c390: 2762 2729 0d0a 2020 2020 7265 7475 726e  'b')..    return
+0006c3a0: 206d 6f64 656c 0d0a 2323 2323 2323 2323   model..########
+0006c3b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006c3c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006c3d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006c3e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006c3f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006c400: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006c410: 2323 2323 230d 0a64 6566 206d 6f64 656c  #####..def model
-0006c420: 5f74 7261 696e 696e 675f 736d 6f74 6528  _training_smote(
-0006c430: 6d6f 6465 6c2c 2078 5f74 7261 696e 2c20  model, x_train, 
-0006c440: 795f 7472 6169 6e2c 2065 7661 6c5f 7365  y_train, eval_se
-0006c450: 742c 2065 7661 6c5f 6d65 7472 6963 2c0d  t, eval_metric,.
-0006c460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0006c470: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-0006c480: 2c20 696d 705f 6361 7473 2c20 6d6f 6465  , imp_cats, mode
-0006c490: 6c74 7970 652c 0d0a 2020 2020 2020 2020  ltype,..        
-0006c4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c4b0: 6361 6c69 6272 6174 6f72 5f66 6c61 672c  calibrator_flag,
-0006c4c0: 206d 6f64 656c 5f6e 616d 652c 2042 6f6f   model_name, Boo
-0006c4d0: 7374 696e 675f 466c 6167 2c20 6d6f 6465  sting_Flag, mode
-0006c4e0: 6c5f 6c61 6265 6c2c 0d0a 2020 2020 2020  l_label,..      
-0006c4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c500: 2020 2047 5055 5f65 7869 7374 7329 3a0d     GPU_exists):.
-0006c510: 0a20 2020 2023 2323 2320 5468 6973 206d  .    #### This m
-0006c520: 6f64 656c 2074 7261 696e 696e 6720 7669  odel training vi
-0006c530: 6120 534d 4f54 4520 6861 7320 746f 2062  a SMOTE has to b
-0006c540: 6520 6d6f 6469 6669 6564 206c 6174 6572  e modified later
-0006c550: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
-0006c560: 2323 2323 230d 0a20 2020 2065 6172 6c79  #####..    early
-0006c570: 5f73 746f 7070 696e 6720 3d20 350d 0a20  _stopping = 5.. 
-0006c580: 2020 2069 6620 6d6f 6465 6c5f 6c61 6265     if model_labe
-0006c590: 6c20 3d3d 2027 5369 6e67 6c65 5f4c 6162  l == 'Single_Lab
-0006c5a0: 656c 273a 0d0a 2020 2020 2020 2020 6966  el':..        if
-0006c5b0: 2042 6f6f 7374 696e 675f 466c 6167 3a0d   Boosting_Flag:.
-0006c5c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0006c5d0: 6d6f 6465 6c5f 6e61 6d65 203d 3d20 2758  model_name == 'X
-0006c5e0: 4742 6f6f 7374 273a 0d0a 2020 2020 2020  GBoost':..      
-0006c5f0: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
-0006c600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c610: 2020 2020 6966 2063 616c 6962 7261 746f      if calibrato
-0006c620: 725f 666c 6167 3a0d 0a20 2020 2020 2020  r_flag:..       
-0006c630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c640: 206d 6f64 656c 2e66 6974 2878 5f74 7261   model.fit(x_tra
-0006c650: 696e 2c20 795f 7472 6169 6e29 0d0a 2020  in, y_train)..  
-0006c660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c670: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0006c680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c690: 2069 6620 6576 616c 5f73 6574 3d3d 5b28   if eval_set==[(
-0006c6a0: 295d 206f 7220 6d6f 6465 6c74 7970 6520  )] or modeltype 
-0006c6b0: 3d3d 2027 4d75 6c74 695f 436c 6173 7369  == 'Multi_Classi
-0006c6c0: 6669 6361 7469 6f6e 273a 0d0a 2020 2020  fication':..    
-0006c6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c6e0: 2020 2020 2020 2020 6d6f 6465 6c2e 6669          model.fi
-0006c6f0: 7428 785f 7472 6169 6e2c 2079 5f74 7261  t(x_train, y_tra
-0006c700: 696e 290d 0a20 2020 2020 2020 2020 2020  in)..           
-0006c710: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0006c720: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-0006c730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c740: 6d6f 6465 6c2e 6669 7428 785f 7472 6169  model.fit(x_trai
-0006c750: 6e2c 2079 5f74 7261 696e 2c65 6172 6c79  n, y_train,early
-0006c760: 5f73 746f 7070 696e 675f 726f 756e 6473  _stopping_rounds
-0006c770: 3d65 6172 6c79 5f73 746f 7070 696e 672c  =early_stopping,
-0006c780: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0006c790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c7a0: 2020 6576 616c 5f6d 6574 7269 633d 6576    eval_metric=ev
-0006c7b0: 616c 5f6d 6574 7269 632c 6576 616c 5f73  al_metric,eval_s
-0006c7c0: 6574 3d65 7661 6c5f 7365 742c 7665 7262  et=eval_set,verb
-0006c7d0: 6f73 653d 4661 6c73 6529 0d0a 2020 2020  ose=False)..    
-0006c7e0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-0006c7f0: 7074 3a0d 0a20 2020 2020 2020 2020 2020  pt:..           
-0006c800: 2020 2020 2020 2020 2023 2323 2320 4f6e           #### On
-0006c810: 2043 6f6c 6162 2c20 6576 656e 2074 686f   Colab, even tho
-0006c820: 7567 6820 4750 5520 6578 6973 7473 2c20  ugh GPU exists, 
-0006c830: 6d61 6e79 2070 656f 706c 6520 646f 6e27  many people don'
-0006c840: 7420 7475 726e 2069 7420 6f6e 2e0d 0a20  t turn it on... 
-0006c850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c860: 2020 2023 2323 2320 2049 6e20 7468 6174     ####  In that
-0006c870: 2063 6173 652c 2058 4742 6f6f 7374 2062   case, XGBoost b
-0006c880: 6c6f 7773 2075 7020 7768 656e 2067 7075  lows up when gpu
-0006c890: 5f70 7265 6469 6374 6f72 2069 7320 7573  _predictor is us
-0006c8a0: 6564 2e0d 0a20 2020 2020 2020 2020 2020  ed...           
-0006c8b0: 2020 2020 2020 2020 2023 2323 2320 2054           ####  T
-0006c8c0: 6869 7320 6973 2074 6f20 7475 726e 2069  his is to turn i
-0006c8d0: 7420 6261 636b 2074 6f20 6370 755f 7072  t back to cpu_pr
-0006c8e0: 6564 6963 746f 7220 696e 2063 6173 6520  edictor in case 
-0006c8f0: 4750 5520 6572 726f 7273 210d 0a20 2020  GPU errors!..   
-0006c900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c910: 2069 6620 4750 555f 6578 6973 7473 3a0d   if GPU_exists:.
-0006c920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0006c930: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
-0006c940: 5761 726e 696e 673a 2047 5055 2065 7869  Warning: GPU exi
-0006c950: 7374 7320 6275 7420 6974 2069 7320 6e6f  sts but it is no
-0006c960: 7420 7475 726e 6564 206f 6e2e 2055 7369  t turned on. Usi
-0006c970: 6e67 2043 5055 2066 6f72 2070 7265 6469  ng CPU for predi
-0006c980: 6374 696f 6e73 2e2e 2e27 290d 0a20 2020  ctions...')..   
-0006c990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c9a0: 2020 2020 2069 6620 6361 6c69 6272 6174       if calibrat
-0006c9b0: 6f72 5f66 6c61 673a 0d0a 2020 2020 2020  or_flag:..      
-0006c9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006c9d0: 2020 2020 2020 6d6f 6465 6c2e 6261 7365        model.base
-0006c9e0: 5f65 7374 696d 6174 6f72 2e73 6574 5f70  _estimator.set_p
-0006c9f0: 6172 616d 7328 2a2a 7061 7261 6d73 290d  arams(**params).
-0006ca00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0006ca10: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
-0006ca20: 656c 2e66 6974 2878 5f74 7261 696e 2c20  el.fit(x_train, 
-0006ca30: 795f 7472 6169 6e29 0d0a 2020 2020 2020  y_train)..      
-0006ca40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006ca50: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0006ca60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006ca70: 2020 2020 206d 6f64 656c 2e65 7374 696d       model.estim
-0006ca80: 6174 6f72 2e73 6574 5f70 6172 616d 7328  ator.set_params(
-0006ca90: 2a2a 7061 7261 6d73 290d 0a20 2020 2020  **params)..     
-0006caa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006cab0: 2020 2020 2020 206d 6f64 656c 2e66 6974         model.fit
-0006cac0: 2878 5f74 7261 696e 2c20 795f 7472 6169  (x_train, y_trai
-0006cad0: 6e29 0d0a 2020 2020 2020 2020 2020 2020  n)..            
-0006cae0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0006caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006cb00: 2020 2020 2020 2069 6620 6576 616c 5f73         if eval_s
-0006cb10: 6574 3d3d 5b28 295d 206f 7220 6d6f 6465  et==[()] or mode
-0006cb20: 6c74 7970 6520 3d3d 2027 4d75 6c74 695f  ltype == 'Multi_
-0006cb30: 436c 6173 7369 6669 6361 7469 6f6e 273a  Classification':
-0006cb40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0006cb50: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
-0006cb60: 6465 6c2e 6669 7428 785f 7472 6169 6e2c  del.fit(x_train,
-0006cb70: 2079 5f74 7261 696e 290d 0a20 2020 2020   y_train)..     
-0006cb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006cb90: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0006cba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006cbb0: 2020 2020 2020 6d6f 6465 6c2e 6669 7428        model.fit(
-0006cbc0: 785f 7472 6169 6e2c 2079 5f74 7261 696e  x_train, y_train
-0006cbd0: 2c20 6561 726c 795f 7374 6f70 7069 6e67  , early_stopping
-0006cbe0: 5f72 6f75 6e64 733d 6561 726c 795f 7374  _rounds=early_st
-0006cbf0: 6f70 7069 6e67 2c0d 0a20 2020 2020 2020  opping,..       
-0006cc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006cc10: 2020 2020 2020 2020 2065 7661 6c5f 6d65           eval_me
-0006cc20: 7472 6963 3d65 7661 6c5f 6d65 7472 6963  tric=eval_metric
-0006cc30: 2c65 7661 6c5f 7365 743d 6576 616c 5f73  ,eval_set=eval_s
-0006cc40: 6574 2c76 6572 626f 7365 3d46 616c 7365  et,verbose=False
-0006cc50: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0006cc60: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0006cc70: 2020 2020 2020 6561 726c 795f 7374 6f70        early_stop
-0006cc80: 7069 6e67 203d 2032 300d 0a20 2020 2020  ping = 20..     
-0006cc90: 2020 2020 2020 2020 2020 2069 6620 6576             if ev
-0006cca0: 616c 5f73 6574 203d 3d20 5b28 295d 3a0d  al_set == [()]:.
-0006ccb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0006ccc0: 2020 2020 206d 6f64 656c 2e66 6974 2878       model.fit(x
-0006ccd0: 5f74 7261 696e 2c20 795f 7472 6169 6e2c  _train, y_train,
-0006cce0: 2063 6174 5f66 6561 7475 7265 733d 696d   cat_features=im
-0006ccf0: 705f 6361 7473 2c70 6c6f 743d 4661 6c73  p_cats,plot=Fals
-0006cd00: 652c 2076 6572 626f 7365 3d31 290d 0a20  e, verbose=1).. 
-0006cd10: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0006cd20: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-0006cd30: 2020 2020 2020 2020 2020 6d6f 6465 6c2e            model.
-0006cd40: 6669 7428 785f 7472 6169 6e2c 2079 5f74  fit(x_train, y_t
-0006cd50: 7261 696e 2c20 6361 745f 6665 6174 7572  rain, cat_featur
-0006cd60: 6573 3d69 6d70 5f63 6174 732c 2076 6572  es=imp_cats, ver
-0006cd70: 626f 7365 3d31 2c0d 0a20 2020 2020 2020  bose=1,..       
-0006cd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006cd90: 2020 2020 2020 2020 2065 7661 6c5f 7365           eval_se
-0006cda0: 743d 6576 616c 5f73 6574 2c20 7573 655f  t=eval_set, use_
-0006cdb0: 6265 7374 5f6d 6f64 656c 3d54 7275 652c  best_model=True,
-0006cdc0: 2070 6c6f 743d 4661 6c73 6529 0d0a 2020   plot=False)..  
-0006cdd0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-0006cde0: 2020 2020 2020 2020 206d 6f64 656c 2e66           model.f
-0006cdf0: 6974 2878 5f74 7261 696e 2c20 795f 7472  it(x_train, y_tr
-0006ce00: 6169 6e29 0d0a 2020 2020 656c 7365 3a0d  ain)..    else:.
-0006ce10: 0a20 2020 2020 2020 206d 6f64 656c 2e66  .        model.f
-0006ce20: 6974 2878 5f74 7261 696e 2c20 795f 7472  it(x_train, y_tr
-0006ce30: 6169 6e29 0d0a 2020 2020 7265 7475 726e  ain)..    return
-0006ce40: 206d 6f64 656c 0d0a 2323 2323 2323 2323   model..########
+0006c400: 2323 2323 2323 0d0a 6465 6620 6d6f 6465  ######..def mode
+0006c410: 6c5f 7472 6169 6e69 6e67 5f73 6d6f 7465  l_training_smote
+0006c420: 286d 6f64 656c 2c20 785f 7472 6169 6e2c  (model, x_train,
+0006c430: 2079 5f74 7261 696e 2c20 6576 616c 5f73   y_train, eval_s
+0006c440: 6574 2c20 6576 616c 5f6d 6574 7269 632c  et, eval_metric,
+0006c450: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0006c460: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0006c470: 732c 2069 6d70 5f63 6174 732c 206d 6f64  s, imp_cats, mod
+0006c480: 656c 7479 7065 2c0d 0a20 2020 2020 2020  eltype,..       
+0006c490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c4a0: 2063 616c 6962 7261 746f 725f 666c 6167   calibrator_flag
+0006c4b0: 2c20 6d6f 6465 6c5f 6e61 6d65 2c20 426f  , model_name, Bo
+0006c4c0: 6f73 7469 6e67 5f46 6c61 672c 206d 6f64  osting_Flag, mod
+0006c4d0: 656c 5f6c 6162 656c 2c0d 0a20 2020 2020  el_label,..     
+0006c4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c4f0: 2020 2020 4750 555f 6578 6973 7473 293a      GPU_exists):
+0006c500: 0d0a 2020 2020 2323 2323 2054 6869 7320  ..    #### This 
+0006c510: 6d6f 6465 6c20 7472 6169 6e69 6e67 2076  model training v
+0006c520: 6961 2053 4d4f 5445 2068 6173 2074 6f20  ia SMOTE has to 
+0006c530: 6265 206d 6f64 6966 6965 6420 6c61 7465  be modified late
+0006c540: 7220 2323 2323 2323 2323 2323 2323 2323  r ##############
+0006c550: 2323 2323 2323 0d0a 2020 2020 6561 726c  ######..    earl
+0006c560: 795f 7374 6f70 7069 6e67 203d 2035 0d0a  y_stopping = 5..
+0006c570: 2020 2020 6966 206d 6f64 656c 5f6c 6162      if model_lab
+0006c580: 656c 203d 3d20 2753 696e 676c 655f 4c61  el == 'Single_La
+0006c590: 6265 6c27 3a0d 0a20 2020 2020 2020 2069  bel':..        i
+0006c5a0: 6620 426f 6f73 7469 6e67 5f46 6c61 673a  f Boosting_Flag:
+0006c5b0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0006c5c0: 206d 6f64 656c 5f6e 616d 6520 3d3d 2027   model_name == '
+0006c5d0: 5847 426f 6f73 7427 3a0d 0a20 2020 2020  XGBoost':..     
+0006c5e0: 2020 2020 2020 2020 2020 2074 7279 3a0d             try:.
+0006c5f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0006c600: 2020 2020 2069 6620 6361 6c69 6272 6174       if calibrat
+0006c610: 6f72 5f66 6c61 673a 0d0a 2020 2020 2020  or_flag:..      
+0006c620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c630: 2020 6d6f 6465 6c2e 6669 7428 785f 7472    model.fit(x_tr
+0006c640: 6169 6e2c 2079 5f74 7261 696e 290d 0a20  ain, y_train).. 
+0006c650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c660: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0006c670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c680: 2020 6966 2065 7661 6c5f 7365 743d 3d5b    if eval_set==[
+0006c690: 2829 5d20 6f72 206d 6f64 656c 7479 7065  ()] or modeltype
+0006c6a0: 203d 3d20 274d 756c 7469 5f43 6c61 7373   == 'Multi_Class
+0006c6b0: 6966 6963 6174 696f 6e27 3a0d 0a20 2020  ification':..   
+0006c6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c6d0: 2020 2020 2020 2020 206d 6f64 656c 2e66           model.f
+0006c6e0: 6974 2878 5f74 7261 696e 2c20 795f 7472  it(x_train, y_tr
+0006c6f0: 6169 6e29 0d0a 2020 2020 2020 2020 2020  ain)..          
+0006c700: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0006c710: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+0006c720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c730: 206d 6f64 656c 2e66 6974 2878 5f74 7261   model.fit(x_tra
+0006c740: 696e 2c20 795f 7472 6169 6e2c 6561 726c  in, y_train,earl
+0006c750: 795f 7374 6f70 7069 6e67 5f72 6f75 6e64  y_stopping_round
+0006c760: 733d 6561 726c 795f 7374 6f70 7069 6e67  s=early_stopping
+0006c770: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0006c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c790: 2020 2065 7661 6c5f 6d65 7472 6963 3d65     eval_metric=e
+0006c7a0: 7661 6c5f 6d65 7472 6963 2c65 7661 6c5f  val_metric,eval_
+0006c7b0: 7365 743d 6576 616c 5f73 6574 2c76 6572  set=eval_set,ver
+0006c7c0: 626f 7365 3d46 616c 7365 290d 0a20 2020  bose=False)..   
+0006c7d0: 2020 2020 2020 2020 2020 2020 2065 7863               exc
+0006c7e0: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
+0006c7f0: 2020 2020 2020 2020 2020 2323 2323 204f            #### O
+0006c800: 6e20 436f 6c61 622c 2065 7665 6e20 7468  n Colab, even th
+0006c810: 6f75 6768 2047 5055 2065 7869 7374 732c  ough GPU exists,
+0006c820: 206d 616e 7920 7065 6f70 6c65 2064 6f6e   many people don
+0006c830: 2774 2074 7572 6e20 6974 206f 6e2e 0d0a  't turn it on...
+0006c840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c850: 2020 2020 2323 2323 2020 496e 2074 6861      ####  In tha
+0006c860: 7420 6361 7365 2c20 5847 426f 6f73 7420  t case, XGBoost 
+0006c870: 626c 6f77 7320 7570 2077 6865 6e20 6770  blows up when gp
+0006c880: 755f 7072 6564 6963 746f 7220 6973 2075  u_predictor is u
+0006c890: 7365 642e 0d0a 2020 2020 2020 2020 2020  sed...          
+0006c8a0: 2020 2020 2020 2020 2020 2323 2323 2020            ####  
+0006c8b0: 5468 6973 2069 7320 746f 2074 7572 6e20  This is to turn 
+0006c8c0: 6974 2062 6163 6b20 746f 2063 7075 5f70  it back to cpu_p
+0006c8d0: 7265 6469 6374 6f72 2069 6e20 6361 7365  redictor in case
+0006c8e0: 2047 5055 2065 7272 6f72 7321 0d0a 2020   GPU errors!..  
+0006c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c900: 2020 6966 2047 5055 5f65 7869 7374 733a    if GPU_exists:
+0006c910: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0006c920: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+0006c930: 2757 6172 6e69 6e67 3a20 4750 5520 6578  'Warning: GPU ex
+0006c940: 6973 7473 2062 7574 2069 7420 6973 206e  ists but it is n
+0006c950: 6f74 2074 7572 6e65 6420 6f6e 2e20 5573  ot turned on. Us
+0006c960: 696e 6720 4350 5520 666f 7220 7072 6564  ing CPU for pred
+0006c970: 6963 7469 6f6e 732e 2e2e 2729 0d0a 2020  ictions...')..  
+0006c980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c990: 2020 2020 2020 6966 2063 616c 6962 7261        if calibra
+0006c9a0: 746f 725f 666c 6167 3a0d 0a20 2020 2020  tor_flag:..     
+0006c9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006c9c0: 2020 2020 2020 206d 6f64 656c 2e62 6173         model.bas
+0006c9d0: 655f 6573 7469 6d61 746f 722e 7365 745f  e_estimator.set_
+0006c9e0: 7061 7261 6d73 282a 2a70 6172 616d 7329  params(**params)
+0006c9f0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0006ca00: 2020 2020 2020 2020 2020 2020 2020 6d6f                mo
+0006ca10: 6465 6c2e 6669 7428 785f 7472 6169 6e2c  del.fit(x_train,
+0006ca20: 2079 5f74 7261 696e 290d 0a20 2020 2020   y_train)..     
+0006ca30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006ca40: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0006ca50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006ca60: 2020 2020 2020 6d6f 6465 6c2e 6573 7469        model.esti
+0006ca70: 6d61 746f 722e 7365 745f 7061 7261 6d73  mator.set_params
+0006ca80: 282a 2a70 6172 616d 7329 0d0a 2020 2020  (**params)..    
+0006ca90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006caa0: 2020 2020 2020 2020 6d6f 6465 6c2e 6669          model.fi
+0006cab0: 7428 785f 7472 6169 6e2c 2079 5f74 7261  t(x_train, y_tra
+0006cac0: 696e 290d 0a20 2020 2020 2020 2020 2020  in)..           
+0006cad0: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+0006cae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006caf0: 2020 2020 2020 2020 6966 2065 7661 6c5f          if eval_
+0006cb00: 7365 743d 3d5b 2829 5d20 6f72 206d 6f64  set==[()] or mod
+0006cb10: 656c 7479 7065 203d 3d20 274d 756c 7469  eltype == 'Multi
+0006cb20: 5f43 6c61 7373 6966 6963 6174 696f 6e27  _Classification'
+0006cb30: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0006cb40: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0006cb50: 6f64 656c 2e66 6974 2878 5f74 7261 696e  odel.fit(x_train
+0006cb60: 2c20 795f 7472 6169 6e29 0d0a 2020 2020  , y_train)..    
+0006cb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006cb80: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0006cb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006cba0: 2020 2020 2020 206d 6f64 656c 2e66 6974         model.fit
+0006cbb0: 2878 5f74 7261 696e 2c20 795f 7472 6169  (x_train, y_trai
+0006cbc0: 6e2c 2065 6172 6c79 5f73 746f 7070 696e  n, early_stoppin
+0006cbd0: 675f 726f 756e 6473 3d65 6172 6c79 5f73  g_rounds=early_s
+0006cbe0: 746f 7070 696e 672c 0d0a 2020 2020 2020  topping,..      
+0006cbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006cc00: 2020 2020 2020 2020 2020 6576 616c 5f6d            eval_m
+0006cc10: 6574 7269 633d 6576 616c 5f6d 6574 7269  etric=eval_metri
+0006cc20: 632c 6576 616c 5f73 6574 3d65 7661 6c5f  c,eval_set=eval_
+0006cc30: 7365 742c 7665 7262 6f73 653d 4661 6c73  set,verbose=Fals
+0006cc40: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+0006cc50: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0006cc60: 2020 2020 2020 2065 6172 6c79 5f73 746f         early_sto
+0006cc70: 7070 696e 6720 3d20 3230 0d0a 2020 2020  pping = 20..    
+0006cc80: 2020 2020 2020 2020 2020 2020 6966 2065              if e
+0006cc90: 7661 6c5f 7365 7420 3d3d 205b 2829 5d3a  val_set == [()]:
+0006cca0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0006ccb0: 2020 2020 2020 6d6f 6465 6c2e 6669 7428        model.fit(
+0006ccc0: 785f 7472 6169 6e2c 2079 5f74 7261 696e  x_train, y_train
+0006ccd0: 2c20 6361 745f 6665 6174 7572 6573 3d69  , cat_features=i
+0006cce0: 6d70 5f63 6174 732c 706c 6f74 3d46 616c  mp_cats,plot=Fal
+0006ccf0: 7365 2c20 7665 7262 6f73 653d 3129 0d0a  se, verbose=1)..
+0006cd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006cd10: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0006cd20: 2020 2020 2020 2020 2020 206d 6f64 656c             model
+0006cd30: 2e66 6974 2878 5f74 7261 696e 2c20 795f  .fit(x_train, y_
+0006cd40: 7472 6169 6e2c 2063 6174 5f66 6561 7475  train, cat_featu
+0006cd50: 7265 733d 696d 705f 6361 7473 2c20 7665  res=imp_cats, ve
+0006cd60: 7262 6f73 653d 312c 0d0a 2020 2020 2020  rbose=1,..      
+0006cd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006cd80: 2020 2020 2020 2020 2020 6576 616c 5f73            eval_s
+0006cd90: 6574 3d65 7661 6c5f 7365 742c 2075 7365  et=eval_set, use
+0006cda0: 5f62 6573 745f 6d6f 6465 6c3d 5472 7565  _best_model=True
+0006cdb0: 2c20 706c 6f74 3d46 616c 7365 290d 0a20  , plot=False).. 
+0006cdc0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+0006cdd0: 2020 2020 2020 2020 2020 6d6f 6465 6c2e            model.
+0006cde0: 6669 7428 785f 7472 6169 6e2c 2079 5f74  fit(x_train, y_t
+0006cdf0: 7261 696e 290d 0a20 2020 2065 6c73 653a  rain)..    else:
+0006ce00: 0d0a 2020 2020 2020 2020 6d6f 6465 6c2e  ..        model.
+0006ce10: 6669 7428 785f 7472 6169 6e2c 2079 5f74  fit(x_train, y_t
+0006ce20: 7261 696e 290d 0a20 2020 2072 6574 7572  rain)..    retur
+0006ce30: 6e20 6d6f 6465 6c0d 0a23 2323 2323 2323  n model..#######
+0006ce40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006ce50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006ce60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006ce70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ce80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ce90: 2323 2323 2323 2323 230d 0a66 726f 6d20  #########..from 
-0006cea0: 736b 6c65 6172 6e2e 6d6f 6465 6c5f 7365  sklearn.model_se
-0006ceb0: 6c65 6374 696f 6e20 696d 706f 7274 2074  lection import t
-0006cec0: 7261 696e 5f74 6573 745f 7370 6c69 740d  rain_test_split.
-0006ced0: 0a69 6d70 6f72 7420 6e75 6d70 7920 6173  .import numpy as
-0006cee0: 206e 700d 0a66 726f 6d20 736b 6c65 6172   np..from sklear
-0006cef0: 6e2e 6d65 7472 6963 7320 696d 706f 7274  n.metrics import
-0006cf00: 2066 315f 7363 6f72 650d 0a69 6d70 6f72   f1_score..impor
-0006cf10: 7420 636f 7079 0d0a 696d 706f 7274 206d  t copy..import m
-0006cf20: 6174 706c 6f74 6c69 622e 7079 706c 6f74  atplotlib.pyplot
-0006cf30: 2061 7320 706c 740d 0a66 726f 6d20 696e   as plt..from in
-0006cf40: 7370 6563 7420 696d 706f 7274 2073 6967  spect import sig
-0006cf50: 6e61 7475 7265 0d0a 6672 6f6d 2073 6b6c  nature..from skl
-0006cf60: 6561 726e 2e70 7265 7072 6f63 6573 7369  earn.preprocessi
-0006cf70: 6e67 2069 6d70 6f72 7420 6c61 6265 6c5f  ng import label_
-0006cf80: 6269 6e61 7269 7a65 0d0a 6672 6f6d 2073  binarize..from s
-0006cf90: 6b6c 6561 726e 2e6d 6574 7269 6373 2069  klearn.metrics i
-0006cfa0: 6d70 6f72 7420 7072 6563 6973 696f 6e5f  mport precision_
-0006cfb0: 7265 6361 6c6c 5f63 7572 7665 0d0a 6672  recall_curve..fr
-0006cfc0: 6f6d 2073 6b6c 6561 726e 2e6d 6574 7269  om sklearn.metri
-0006cfd0: 6373 2069 6d70 6f72 7420 6176 6572 6167  cs import averag
-0006cfe0: 655f 7072 6563 6973 696f 6e5f 7363 6f72  e_precision_scor
-0006cff0: 650d 0a66 726f 6d20 6974 6572 746f 6f6c  e..from itertool
-0006d000: 7320 696d 706f 7274 2063 7963 6c65 0d0a  s import cycle..
+0006ce80: 2323 2323 2323 2323 2323 0d0a 6672 6f6d  ##########..from
+0006ce90: 2073 6b6c 6561 726e 2e6d 6f64 656c 5f73   sklearn.model_s
+0006cea0: 656c 6563 7469 6f6e 2069 6d70 6f72 7420  election import 
+0006ceb0: 7472 6169 6e5f 7465 7374 5f73 706c 6974  train_test_split
+0006cec0: 0d0a 696d 706f 7274 206e 756d 7079 2061  ..import numpy a
+0006ced0: 7320 6e70 0d0a 6672 6f6d 2073 6b6c 6561  s np..from sklea
+0006cee0: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
+0006cef0: 7420 6631 5f73 636f 7265 0d0a 696d 706f  t f1_score..impo
+0006cf00: 7274 2063 6f70 790d 0a69 6d70 6f72 7420  rt copy..import 
+0006cf10: 6d61 7470 6c6f 746c 6962 2e70 7970 6c6f  matplotlib.pyplo
+0006cf20: 7420 6173 2070 6c74 0d0a 6672 6f6d 2069  t as plt..from i
+0006cf30: 6e73 7065 6374 2069 6d70 6f72 7420 7369  nspect import si
+0006cf40: 676e 6174 7572 650d 0a66 726f 6d20 736b  gnature..from sk
+0006cf50: 6c65 6172 6e2e 7072 6570 726f 6365 7373  learn.preprocess
+0006cf60: 696e 6720 696d 706f 7274 206c 6162 656c  ing import label
+0006cf70: 5f62 696e 6172 697a 650d 0a66 726f 6d20  _binarize..from 
+0006cf80: 736b 6c65 6172 6e2e 6d65 7472 6963 7320  sklearn.metrics 
+0006cf90: 696d 706f 7274 2070 7265 6369 7369 6f6e  import precision
+0006cfa0: 5f72 6563 616c 6c5f 6375 7276 650d 0a66  _recall_curve..f
+0006cfb0: 726f 6d20 736b 6c65 6172 6e2e 6d65 7472  rom sklearn.metr
+0006cfc0: 6963 7320 696d 706f 7274 2061 7665 7261  ics import avera
+0006cfd0: 6765 5f70 7265 6369 7369 6f6e 5f73 636f  ge_precision_sco
+0006cfe0: 7265 0d0a 6672 6f6d 2069 7465 7274 6f6f  re..from itertoo
+0006cff0: 6c73 2069 6d70 6f72 7420 6379 636c 650d  ls import cycle.
+0006d000: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
 0006d010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006d020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006d030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006d040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d060: 2323 2323 2323 2323 2323 2323 230d 0a64  #############..d
-0006d070: 6566 206d 756c 7469 5f66 3128 7472 7574  ef multi_f1(trut
-0006d080: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
-0006d090: 0d0a 2020 2020 7265 7475 726e 2066 315f  ..    return f1_
-0006d0a0: 7363 6f72 6528 7472 7574 682c 2070 7265  score(truth, pre
-0006d0b0: 6469 6374 696f 6e73 2c61 7665 7261 6765  dictions,average
-0006d0c0: 3d4e 6f6e 6529 0d0a 6465 6620 6d75 6c74  =None)..def mult
-0006d0d0: 695f 7072 6563 6973 696f 6e28 7472 7574  i_precision(trut
-0006d0e0: 682c 2070 7265 6469 6374 696f 6e73 293a  h, predictions):
-0006d0f0: 0d0a 2020 2020 7265 7475 726e 2070 7265  ..    return pre
-0006d100: 6369 7369 6f6e 5f73 636f 7265 2874 7275  cision_score(tru
-0006d110: 7468 2c20 7072 6564 6963 7469 6f6e 732c  th, predictions,
-0006d120: 6176 6572 6167 653d 4e6f 6e65 290d 0a23  average=None)..#
+0006d050: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+0006d060: 6465 6620 6d75 6c74 695f 6631 2874 7275  def multi_f1(tru
+0006d070: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
+0006d080: 3a0d 0a20 2020 2072 6574 7572 6e20 6631  :..    return f1
+0006d090: 5f73 636f 7265 2874 7275 7468 2c20 7072  _score(truth, pr
+0006d0a0: 6564 6963 7469 6f6e 732c 6176 6572 6167  edictions,averag
+0006d0b0: 653d 4e6f 6e65 290d 0a64 6566 206d 756c  e=None)..def mul
+0006d0c0: 7469 5f70 7265 6369 7369 6f6e 2874 7275  ti_precision(tru
+0006d0d0: 7468 2c20 7072 6564 6963 7469 6f6e 7329  th, predictions)
+0006d0e0: 3a0d 0a20 2020 2072 6574 7572 6e20 7072  :..    return pr
+0006d0f0: 6563 6973 696f 6e5f 7363 6f72 6528 7472  ecision_score(tr
+0006d100: 7574 682c 2070 7265 6469 6374 696f 6e73  uth, predictions
+0006d110: 2c61 7665 7261 6765 3d4e 6f6e 6529 0d0a  ,average=None)..
+0006d120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006d130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006d140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006d150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006d160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d180: 2323 2323 2323 2323 2323 2323 230d 0a64  #############..d
-0006d190: 6566 2044 7261 775f 4d43 5f4d 4c5f 5052  ef Draw_MC_ML_PR
-0006d1a0: 5f52 4f43 5f43 7572 7665 7328 636c 6173  _ROC_Curves(clas
-0006d1b0: 7369 6669 6572 2c58 5f74 6573 742c 795f  sifier,X_test,y_
-0006d1c0: 7465 7374 293a 0d0a 2020 2020 2222 220d  test):..    """.
-0006d1d0: 0a20 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d  .    ===========
+0006d170: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+0006d180: 6465 6620 4472 6177 5f4d 435f 4d4c 5f50  def Draw_MC_ML_P
+0006d190: 525f 524f 435f 4375 7276 6573 2863 6c61  R_ROC_Curves(cla
+0006d1a0: 7373 6966 6965 722c 585f 7465 7374 2c79  ssifier,X_test,y
+0006d1b0: 5f74 6573 7429 3a0d 0a20 2020 2022 2222  _test):..    """
+0006d1c0: 0d0a 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d  ..    ==========
+0006d1d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 0006d1e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 0006d1f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 0006d200: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d210: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d220: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a20  =============.. 
-0006d230: 2020 2050 7265 6369 7369 6f6e 2d52 6563     Precision-Rec
-0006d240: 616c 6c20 4375 7276 6573 3a20 4578 7465  all Curves: Exte
-0006d250: 6e73 696f 6e20 6f66 204f 7269 6769 6e61  nsion of Origina
-0006d260: 6c20 5665 7273 696f 6e20 696e 2053 4b4c  l Version in SKL
-0006d270: 6561 726e 2773 2044 6f63 756d 656e 7461  earn's Documenta
-0006d280: 7469 6f6e 2050 6167 653a 0d0a 2020 2020  tion Page:..    
-0006d290: 6874 7470 733a 2f2f 7363 696b 6974 2d6c  https://scikit-l
-0006d2a0: 6561 726e 2e6f 7267 2f73 7461 626c 652f  earn.org/stable/
-0006d2b0: 6175 746f 5f65 7861 6d70 6c65 732f 6d6f  auto_examples/mo
-0006d2c0: 6465 6c5f 7365 6c65 6374 696f 6e2f 706c  del_selection/pl
-0006d2d0: 6f74 5f70 7265 6369 7369 6f6e 5f72 6563  ot_precision_rec
-0006d2e0: 616c 6c2e 6874 6d6c 0d0a 2020 2020 3d3d  all.html..    ==
+0006d210: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
+0006d220: 2020 2020 5072 6563 6973 696f 6e2d 5265      Precision-Re
+0006d230: 6361 6c6c 2043 7572 7665 733a 2045 7874  call Curves: Ext
+0006d240: 656e 7369 6f6e 206f 6620 4f72 6967 696e  ension of Origin
+0006d250: 616c 2056 6572 7369 6f6e 2069 6e20 534b  al Version in SK
+0006d260: 4c65 6172 6e27 7320 446f 6375 6d65 6e74  Learn's Document
+0006d270: 6174 696f 6e20 5061 6765 3a0d 0a20 2020  ation Page:..   
+0006d280: 2068 7474 7073 3a2f 2f73 6369 6b69 742d   https://scikit-
+0006d290: 6c65 6172 6e2e 6f72 672f 7374 6162 6c65  learn.org/stable
+0006d2a0: 2f61 7574 6f5f 6578 616d 706c 6573 2f6d  /auto_examples/m
+0006d2b0: 6f64 656c 5f73 656c 6563 7469 6f6e 2f70  odel_selection/p
+0006d2c0: 6c6f 745f 7072 6563 6973 696f 6e5f 7265  lot_precision_re
+0006d2d0: 6361 6c6c 2e68 746d 6c0d 0a20 2020 203d  call.html..    =
+0006d2e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 0006d2f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 0006d300: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 0006d310: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 0006d320: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d330: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0006d340: 3d3d 3d3d 3d3d 0d0a 2020 2020 2222 220d  ======..    """.
-0006d350: 0a20 2020 2066 6967 7369 7a65 203d 2028  .    figsize = (
-0006d360: 3130 2c20 3629 0d0a 2020 2020 2323 2323  10, 6)..    ####
+0006d330: 3d3d 3d3d 3d3d 3d0d 0a20 2020 2022 2222  =======..    """
+0006d340: 0d0a 2020 2020 6669 6773 697a 6520 3d20  ..    figsize = 
+0006d350: 2831 302c 2036 290d 0a20 2020 2023 2323  (10, 6)..    ###
+0006d360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006d370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006d380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006d390: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d3a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d3b0: 2323 2323 2323 2323 2323 230d 0a20 2020  ###########..   
-0006d3c0: 2023 2049 6e20 6269 6e61 7279 2063 6c61   # In binary cla
-0006d3d0: 7373 6966 6963 6174 696f 6e20 7365 7474  ssification sett
-0006d3e0: 696e 6773 0d0a 2020 2020 2320 436f 6d70  ings..    # Comp
-0006d3f0: 7574 6520 7468 6520 6176 6572 6167 6520  ute the average 
-0006d400: 7072 6563 6973 696f 6e20 7363 6f72 6520  precision score 
-0006d410: 666f 7220 4269 6e61 7279 2043 6c61 7373  for Binary Class
-0006d420: 6573 0d0a 2020 2020 2323 2323 2323 2323  es..    ########
+0006d3a0: 2323 2323 2323 2323 2323 2323 0d0a 2020  ############..  
+0006d3b0: 2020 2320 496e 2062 696e 6172 7920 636c    # In binary cl
+0006d3c0: 6173 7369 6669 6361 7469 6f6e 2073 6574  assification set
+0006d3d0: 7469 6e67 730d 0a20 2020 2023 2043 6f6d  tings..    # Com
+0006d3e0: 7075 7465 2074 6865 2061 7665 7261 6765  pute the average
+0006d3f0: 2070 7265 6369 7369 6f6e 2073 636f 7265   precision score
+0006d400: 2066 6f72 2042 696e 6172 7920 436c 6173   for Binary Clas
+0006d410: 7365 730d 0a20 2020 2023 2323 2323 2323  ses..    #######
+0006d420: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006d430: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006d440: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006d450: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d460: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d470: 2323 2323 2323 230d 0a20 2020 2079 5f70  #######..    y_p
-0006d480: 7265 6420 3d20 636c 6173 7369 6669 6572  red = classifier
-0006d490: 2e70 7265 6469 6374 2858 5f74 6573 7429  .predict(X_test)
-0006d4a0: 0d0a 2020 2020 6966 206c 656e 286c 6566  ..    if len(lef
-0006d4b0: 745f 7375 6274 7261 6374 286e 702e 756e  t_subtract(np.un
-0006d4c0: 6971 7565 2879 5f74 6573 7429 2c6e 702e  ique(y_test),np.
-0006d4d0: 756e 6971 7565 2879 5f70 7265 6429 2929  unique(y_pred)))
-0006d4e0: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
-0006d4f0: 636c 6173 7365 7320 3d20 6c69 7374 2872  classes = list(r
-0006d500: 616e 6765 286c 656e 286e 702e 756e 6971  ange(len(np.uniq
-0006d510: 7565 2879 5f74 6573 7429 2929 290d 0a20  ue(y_test)))).. 
-0006d520: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-0006d530: 2020 636c 6173 7365 7320 3d20 6c69 7374    classes = list
-0006d540: 2872 616e 6765 286c 656e 286e 702e 756e  (range(len(np.un
-0006d550: 6971 7565 2879 5f70 7265 6429 2929 290d  ique(y_pred)))).
-0006d560: 0a20 2020 2023 636c 6173 7365 7320 3d20  .    #classes = 
-0006d570: 6c69 7374 2872 616e 6765 286c 656e 286e  list(range(len(n
-0006d580: 702e 756e 6971 7565 2879 5f74 6573 7429  p.unique(y_test)
-0006d590: 2929 290d 0a20 2020 206e 5f63 6c61 7373  )))..    n_class
-0006d5a0: 6573 203d 206c 656e 2863 6c61 7373 6573  es = len(classes
-0006d5b0: 290d 0a20 2020 2069 6620 6e5f 636c 6173  )..    if n_clas
-0006d5c0: 7365 7320 3d3d 2032 3a0d 0a20 2020 2020  ses == 2:..     
-0006d5d0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-0006d5e0: 2020 2020 2079 5f73 636f 7265 203d 2063       y_score = c
-0006d5f0: 6c61 7373 6966 6965 722e 6465 6369 7369  lassifier.decisi
-0006d600: 6f6e 5f66 756e 6374 696f 6e28 585f 7465  on_function(X_te
-0006d610: 7374 290d 0a20 2020 2020 2020 2065 7863  st)..        exc
-0006d620: 6570 743a 0d0a 2020 2020 2020 2020 2020  ept:..          
-0006d630: 2020 795f 7363 6f72 6520 3d20 636c 6173    y_score = clas
-0006d640: 7369 6669 6572 2e70 7265 6469 6374 5f70  sifier.predict_p
-0006d650: 726f 6261 2858 5f74 6573 7429 0d0a 2020  roba(X_test)..  
-0006d660: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-0006d670: 2020 2020 2020 2020 6176 6572 6167 655f          average_
-0006d680: 7072 6563 6973 696f 6e20 3d20 6176 6572  precision = aver
-0006d690: 6167 655f 7072 6563 6973 696f 6e5f 7363  age_precision_sc
-0006d6a0: 6f72 6528 795f 7465 7374 2c20 795f 7363  ore(y_test, y_sc
-0006d6b0: 6f72 6529 0d0a 2020 2020 2020 2020 6578  ore)..        ex
-0006d6c0: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
-0006d6d0: 2020 2061 7665 7261 6765 5f70 7265 6369     average_preci
-0006d6e0: 7369 6f6e 203d 206d 756c 7469 5f70 7265  sion = multi_pre
-0006d6f0: 6369 7369 6f6e 2879 5f74 6573 742c 2063  cision(y_test, c
-0006d700: 6c61 7373 6966 6965 722e 7072 6564 6963  lassifier.predic
-0006d710: 7428 585f 7465 7374 2929 2e6d 6561 6e28  t(X_test)).mean(
-0006d720: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
-0006d730: 2827 4176 6572 6167 6520 7072 6563 6973  ('Average precis
-0006d740: 696f 6e2d 7265 6361 6c6c 2073 636f 7265  ion-recall score
-0006d750: 3a20 7b30 3a30 2e32 667d 272e 666f 726d  : {0:0.2f}'.form
-0006d760: 6174 280d 0a20 2020 2020 2020 2020 2020  at(..           
-0006d770: 2020 2061 7665 7261 6765 5f70 7265 6369     average_preci
-0006d780: 7369 6f6e 2929 0d0a 2020 2020 2020 2020  sion))..        
-0006d790: 665f 7363 6f72 6573 203d 206d 756c 7469  f_scores = multi
-0006d7a0: 5f66 3128 795f 7465 7374 2c63 6c61 7373  _f1(y_test,class
-0006d7b0: 6966 6965 722e 7072 6564 6963 7428 585f  ifier.predict(X_
-0006d7c0: 7465 7374 2929 0d0a 2020 2020 2020 2020  test))..        
-0006d7d0: 7072 696e 7428 274d 6163 726f 2046 3120  print('Macro F1 
-0006d7e0: 7363 6f72 652c 2061 7665 7261 6765 6420  score, averaged 
-0006d7f0: 6f76 6572 2061 6c6c 2063 6c61 7373 6573  over all classes
-0006d800: 3a20 7b30 3a30 2e32 667d 270d 0a20 2020  : {0:0.2f}'..   
-0006d810: 2020 2020 2020 2020 2020 202e 666f 726d             .form
-0006d820: 6174 2866 5f73 636f 7265 732e 6d65 616e  at(f_scores.mean
-0006d830: 2829 2929 0d0a 2020 2020 2020 2020 2323  ()))..        ##
+0006d460: 2323 2323 2323 2323 0d0a 2020 2020 795f  ########..    y_
+0006d470: 7072 6564 203d 2063 6c61 7373 6966 6965  pred = classifie
+0006d480: 722e 7072 6564 6963 7428 585f 7465 7374  r.predict(X_test
+0006d490: 290d 0a20 2020 2069 6620 6c65 6e28 6c65  )..    if len(le
+0006d4a0: 6674 5f73 7562 7472 6163 7428 6e70 2e75  ft_subtract(np.u
+0006d4b0: 6e69 7175 6528 795f 7465 7374 292c 6e70  nique(y_test),np
+0006d4c0: 2e75 6e69 7175 6528 795f 7072 6564 2929  .unique(y_pred))
+0006d4d0: 2920 3d3d 2030 3a0d 0a20 2020 2020 2020  ) == 0:..       
+0006d4e0: 2063 6c61 7373 6573 203d 206c 6973 7428   classes = list(
+0006d4f0: 7261 6e67 6528 6c65 6e28 6e70 2e75 6e69  range(len(np.uni
+0006d500: 7175 6528 795f 7465 7374 2929 2929 0d0a  que(y_test))))..
+0006d510: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0006d520: 2020 2063 6c61 7373 6573 203d 206c 6973     classes = lis
+0006d530: 7428 7261 6e67 6528 6c65 6e28 6e70 2e75  t(range(len(np.u
+0006d540: 6e69 7175 6528 795f 7072 6564 2929 2929  nique(y_pred))))
+0006d550: 0d0a 2020 2020 2363 6c61 7373 6573 203d  ..    #classes =
+0006d560: 206c 6973 7428 7261 6e67 6528 6c65 6e28   list(range(len(
+0006d570: 6e70 2e75 6e69 7175 6528 795f 7465 7374  np.unique(y_test
+0006d580: 2929 2929 0d0a 2020 2020 6e5f 636c 6173  ))))..    n_clas
+0006d590: 7365 7320 3d20 6c65 6e28 636c 6173 7365  ses = len(classe
+0006d5a0: 7329 0d0a 2020 2020 6966 206e 5f63 6c61  s)..    if n_cla
+0006d5b0: 7373 6573 203d 3d20 323a 0d0a 2020 2020  sses == 2:..    
+0006d5c0: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
+0006d5d0: 2020 2020 2020 795f 7363 6f72 6520 3d20        y_score = 
+0006d5e0: 636c 6173 7369 6669 6572 2e64 6563 6973  classifier.decis
+0006d5f0: 696f 6e5f 6675 6e63 7469 6f6e 2858 5f74  ion_function(X_t
+0006d600: 6573 7429 0d0a 2020 2020 2020 2020 6578  est)..        ex
+0006d610: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
+0006d620: 2020 2079 5f73 636f 7265 203d 2063 6c61     y_score = cla
+0006d630: 7373 6966 6965 722e 7072 6564 6963 745f  ssifier.predict_
+0006d640: 7072 6f62 6128 585f 7465 7374 290d 0a20  proba(X_test).. 
+0006d650: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+0006d660: 2020 2020 2020 2020 2061 7665 7261 6765           average
+0006d670: 5f70 7265 6369 7369 6f6e 203d 2061 7665  _precision = ave
+0006d680: 7261 6765 5f70 7265 6369 7369 6f6e 5f73  rage_precision_s
+0006d690: 636f 7265 2879 5f74 6573 742c 2079 5f73  core(y_test, y_s
+0006d6a0: 636f 7265 290d 0a20 2020 2020 2020 2065  core)..        e
+0006d6b0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
+0006d6c0: 2020 2020 6176 6572 6167 655f 7072 6563      average_prec
+0006d6d0: 6973 696f 6e20 3d20 6d75 6c74 695f 7072  ision = multi_pr
+0006d6e0: 6563 6973 696f 6e28 795f 7465 7374 2c20  ecision(y_test, 
+0006d6f0: 636c 6173 7369 6669 6572 2e70 7265 6469  classifier.predi
+0006d700: 6374 2858 5f74 6573 7429 292e 6d65 616e  ct(X_test)).mean
+0006d710: 2829 0d0a 2020 2020 2020 2020 7072 696e  ()..        prin
+0006d720: 7428 2741 7665 7261 6765 2070 7265 6369  t('Average preci
+0006d730: 7369 6f6e 2d72 6563 616c 6c20 7363 6f72  sion-recall scor
+0006d740: 653a 207b 303a 302e 3266 7d27 2e66 6f72  e: {0:0.2f}'.for
+0006d750: 6d61 7428 0d0a 2020 2020 2020 2020 2020  mat(..          
+0006d760: 2020 2020 6176 6572 6167 655f 7072 6563      average_prec
+0006d770: 6973 696f 6e29 290d 0a20 2020 2020 2020  ision))..       
+0006d780: 2066 5f73 636f 7265 7320 3d20 6d75 6c74   f_scores = mult
+0006d790: 695f 6631 2879 5f74 6573 742c 636c 6173  i_f1(y_test,clas
+0006d7a0: 7369 6669 6572 2e70 7265 6469 6374 2858  sifier.predict(X
+0006d7b0: 5f74 6573 7429 290d 0a20 2020 2020 2020  _test))..       
+0006d7c0: 2070 7269 6e74 2827 4d61 6372 6f20 4631   print('Macro F1
+0006d7d0: 2073 636f 7265 2c20 6176 6572 6167 6564   score, averaged
+0006d7e0: 206f 7665 7220 616c 6c20 636c 6173 7365   over all classe
+0006d7f0: 733a 207b 303a 302e 3266 7d27 0d0a 2020  s: {0:0.2f}'..  
+0006d800: 2020 2020 2020 2020 2020 2020 2e66 6f72              .for
+0006d810: 6d61 7428 665f 7363 6f72 6573 2e6d 6561  mat(f_scores.mea
+0006d820: 6e28 2929 290d 0a20 2020 2020 2020 2023  n()))..        #
+0006d830: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006d840: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006d850: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006d860: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d870: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006d880: 2323 2323 2323 2323 2323 2323 230d 0a20  #############.. 
-0006d890: 2020 2020 2020 2023 2050 6c6f 7420 7468         # Plot th
-0006d8a0: 6520 5072 6563 6973 696f 6e2d 5265 6361  e Precision-Reca
-0006d8b0: 6c6c 2063 7572 7665 0d0a 2020 2020 2020  ll curve..      
-0006d8c0: 2020 2320 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e    # ............
-0006d8d0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006d8e0: 2e2e 2e2e 0d0a 2020 2020 2020 2020 706c  ......        pl
-0006d8f0: 742e 6669 6775 7265 2866 6967 7369 7a65  t.figure(figsize
-0006d900: 3d66 6967 7369 7a65 290d 0a20 2020 2020  =figsize)..     
-0006d910: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-0006d920: 2020 2020 2023 2323 2054 6869 7320 776f       ### This wo
-0006d930: 726b 7320 666f 7220 4c6f 6769 7374 6963  rks for Logistic
-0006d940: 2052 6567 7265 7373 696f 6e20 616e 6420   Regression and 
-0006d950: 6f74 6865 7220 4c69 6e65 6172 204d 6f64  other Linear Mod
-0006d960: 656c 7320 2323 2323 0d0a 2020 2020 2020  els ####..      
-0006d970: 2020 2020 2020 7072 6563 6973 696f 6e2c        precision,
-0006d980: 2072 6563 616c 6c2c 205f 203d 2070 7265   recall, _ = pre
-0006d990: 6369 7369 6f6e 5f72 6563 616c 6c5f 6375  cision_recall_cu
-0006d9a0: 7276 6528 795f 7465 7374 2c20 795f 7363  rve(y_test, y_sc
-0006d9b0: 6f72 6529 0d0a 2020 2020 2020 2020 6578  ore)..        ex
-0006d9c0: 6365 7074 3a0d 0a20 2020 2020 2020 2020  cept:..         
-0006d9d0: 2020 2023 2323 2054 6869 7320 776f 726b     ### This work
-0006d9e0: 7320 666f 7220 4e6f 6e20 4c69 6e65 6172  s for Non Linear
-0006d9f0: 204d 6f64 656c 7320 7375 6368 2061 7320   Models such as 
-0006da00: 466f 7265 7374 7320 616e 6420 5847 426f  Forests and XGBo
-0006da10: 6f73 7420 2323 2323 230d 0a20 2020 2020  ost #####..     
-0006da20: 2020 2020 2020 2070 7265 6369 7369 6f6e         precision
-0006da30: 2c20 7265 6361 6c6c 2c20 5f20 3d20 7072  , recall, _ = pr
-0006da40: 6563 6973 696f 6e5f 7265 6361 6c6c 5f63  ecision_recall_c
-0006da50: 7572 7665 2879 5f74 6573 742c 2079 5f73  urve(y_test, y_s
-0006da60: 636f 7265 5b3a 2c31 5d29 0d0a 0d0a 2020  core[:,1])....  
-0006da70: 2020 2020 2020 2320 496e 206d 6174 706c        # In matpl
-0006da80: 6f74 6c69 6220 3c20 312e 352c 2070 6c74  otlib < 1.5, plt
-0006da90: 2e66 696c 6c5f 6265 7477 6565 6e20 646f  .fill_between do
-0006daa0: 6573 206e 6f74 2068 6176 6520 6120 2773  es not have a 's
-0006dab0: 7465 7027 2061 7267 756d 656e 740d 0a20  tep' argument.. 
-0006dac0: 2020 2020 2020 2073 7465 705f 6b77 6172         step_kwar
-0006dad0: 6773 203d 2028 7b27 7374 6570 273a 2027  gs = ({'step': '
-0006dae0: 706f 7374 277d 0d0a 2020 2020 2020 2020  post'}..        
-0006daf0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0006db00: 6620 2773 7465 7027 2069 6e20 7369 676e  f 'step' in sign
-0006db10: 6174 7572 6528 706c 742e 6669 6c6c 5f62  ature(plt.fill_b
-0006db20: 6574 7765 656e 292e 7061 7261 6d65 7465  etween).paramete
-0006db30: 7273 0d0a 2020 2020 2020 2020 2020 2020  rs..            
-0006db40: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
-0006db50: 7b7d 290d 0a20 2020 2020 2020 2070 6c74  {})..        plt
-0006db60: 2e73 7465 7028 7265 6361 6c6c 2c20 7072  .step(recall, pr
-0006db70: 6563 6973 696f 6e2c 2063 6f6c 6f72 3d27  ecision, color='
-0006db80: 6727 2c20 616c 7068 613d 302e 322c 0d0a  g', alpha=0.2,..
-0006db90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006dba0: 2077 6865 7265 3d27 706f 7374 2729 0d0a   where='post')..
-0006dbb0: 2020 2020 2020 2020 706c 742e 6669 6c6c          plt.fill
-0006dbc0: 5f62 6574 7765 656e 2872 6563 616c 6c2c  _between(recall,
-0006dbd0: 2070 7265 6369 7369 6f6e 2c20 616c 7068   precision, alph
-0006dbe0: 613d 302e 322c 2063 6f6c 6f72 3d27 6727  a=0.2, color='g'
-0006dbf0: 2c20 2a2a 7374 6570 5f6b 7761 7267 7329  , **step_kwargs)
-0006dc00: 0d0a 0d0a 2020 2020 2020 2020 706c 742e  ....        plt.
-0006dc10: 786c 6162 656c 2827 5265 6361 6c6c 2729  xlabel('Recall')
-0006dc20: 0d0a 2020 2020 2020 2020 706c 742e 796c  ..        plt.yl
-0006dc30: 6162 656c 2827 5072 6563 6973 696f 6e27  abel('Precision'
-0006dc40: 290d 0a20 2020 2020 2020 2070 6c74 2e79  )..        plt.y
-0006dc50: 6c69 6d28 5b30 2e30 2c20 312e 3035 5d29  lim([0.0, 1.05])
-0006dc60: 0d0a 2020 2020 2020 2020 706c 742e 786c  ..        plt.xl
-0006dc70: 696d 285b 302e 302c 2031 2e30 5d29 0d0a  im([0.0, 1.0])..
-0006dc80: 2020 2020 2020 2020 706c 742e 7469 746c          plt.titl
-0006dc90: 6528 2750 7265 6369 7369 6f6e 2d52 6563  e('Precision-Rec
-0006dca0: 616c 6c20 6375 7276 653a 2041 7667 2e50  all curve: Avg.P
-0006dcb0: 7265 6369 7369 6f6e 3d7b 303a 302e 3266  recision={0:0.2f
-0006dcc0: 7d2c 2041 7667 2046 313d 7b31 3a30 2e32  }, Avg F1={1:0.2
-0006dcd0: 667d 272e 666f 726d 6174 280d 0a20 2020  f}'.format(..   
-0006dce0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0006dcf0: 7665 7261 6765 5f70 7265 6369 7369 6f6e  verage_precision
-0006dd00: 2c66 5f73 636f 7265 732e 6d65 616e 2829  ,f_scores.mean()
-0006dd10: 2929 0d0a 2020 2020 2020 2020 706c 742e  ))..        plt.
-0006dd20: 7368 6f77 2829 3b0d 0a20 2020 2020 2020  show();..       
-0006dd30: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
+0006d870: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
+0006d880: 2020 2020 2020 2020 2320 506c 6f74 2074          # Plot t
+0006d890: 6865 2050 7265 6369 7369 6f6e 2d52 6563  he Precision-Rec
+0006d8a0: 616c 6c20 6375 7276 650d 0a20 2020 2020  all curve..     
+0006d8b0: 2020 2023 202e 2e2e 2e2e 2e2e 2e2e 2e2e     # ...........
+0006d8c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
+0006d8d0: 2e2e 2e2e 2e0d 0a20 2020 2020 2020 2070  .......        p
+0006d8e0: 6c74 2e66 6967 7572 6528 6669 6773 697a  lt.figure(figsiz
+0006d8f0: 653d 6669 6773 697a 6529 0d0a 2020 2020  e=figsize)..    
+0006d900: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
+0006d910: 2020 2020 2020 2323 2320 5468 6973 2077        ### This w
+0006d920: 6f72 6b73 2066 6f72 204c 6f67 6973 7469  orks for Logisti
+0006d930: 6320 5265 6772 6573 7369 6f6e 2061 6e64  c Regression and
+0006d940: 206f 7468 6572 204c 696e 6561 7220 4d6f   other Linear Mo
+0006d950: 6465 6c73 2023 2323 230d 0a20 2020 2020  dels ####..     
+0006d960: 2020 2020 2020 2070 7265 6369 7369 6f6e         precision
+0006d970: 2c20 7265 6361 6c6c 2c20 5f20 3d20 7072  , recall, _ = pr
+0006d980: 6563 6973 696f 6e5f 7265 6361 6c6c 5f63  ecision_recall_c
+0006d990: 7572 7665 2879 5f74 6573 742c 2079 5f73  urve(y_test, y_s
+0006d9a0: 636f 7265 290d 0a20 2020 2020 2020 2065  core)..        e
+0006d9b0: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
+0006d9c0: 2020 2020 2323 2320 5468 6973 2077 6f72      ### This wor
+0006d9d0: 6b73 2066 6f72 204e 6f6e 204c 696e 6561  ks for Non Linea
+0006d9e0: 7220 4d6f 6465 6c73 2073 7563 6820 6173  r Models such as
+0006d9f0: 2046 6f72 6573 7473 2061 6e64 2058 4742   Forests and XGB
+0006da00: 6f6f 7374 2023 2323 2323 0d0a 2020 2020  oost #####..    
+0006da10: 2020 2020 2020 2020 7072 6563 6973 696f          precisio
+0006da20: 6e2c 2072 6563 616c 6c2c 205f 203d 2070  n, recall, _ = p
+0006da30: 7265 6369 7369 6f6e 5f72 6563 616c 6c5f  recision_recall_
+0006da40: 6375 7276 6528 795f 7465 7374 2c20 795f  curve(y_test, y_
+0006da50: 7363 6f72 655b 3a2c 315d 290d 0a0d 0a20  score[:,1]).... 
+0006da60: 2020 2020 2020 2023 2049 6e20 6d61 7470         # In matp
+0006da70: 6c6f 746c 6962 203c 2031 2e35 2c20 706c  lotlib < 1.5, pl
+0006da80: 742e 6669 6c6c 5f62 6574 7765 656e 2064  t.fill_between d
+0006da90: 6f65 7320 6e6f 7420 6861 7665 2061 2027  oes not have a '
+0006daa0: 7374 6570 2720 6172 6775 6d65 6e74 0d0a  step' argument..
+0006dab0: 2020 2020 2020 2020 7374 6570 5f6b 7761          step_kwa
+0006dac0: 7267 7320 3d20 287b 2773 7465 7027 3a20  rgs = ({'step': 
+0006dad0: 2770 6f73 7427 7d0d 0a20 2020 2020 2020  'post'}..       
+0006dae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006daf0: 6966 2027 7374 6570 2720 696e 2073 6967  if 'step' in sig
+0006db00: 6e61 7475 7265 2870 6c74 2e66 696c 6c5f  nature(plt.fill_
+0006db10: 6265 7477 6565 6e29 2e70 6172 616d 6574  between).paramet
+0006db20: 6572 730d 0a20 2020 2020 2020 2020 2020  ers..           
+0006db30: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0006db40: 207b 7d29 0d0a 2020 2020 2020 2020 706c   {})..        pl
+0006db50: 742e 7374 6570 2872 6563 616c 6c2c 2070  t.step(recall, p
+0006db60: 7265 6369 7369 6f6e 2c20 636f 6c6f 723d  recision, color=
+0006db70: 2767 272c 2061 6c70 6861 3d30 2e32 2c0d  'g', alpha=0.2,.
+0006db80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0006db90: 2020 7768 6572 653d 2770 6f73 7427 290d    where='post').
+0006dba0: 0a20 2020 2020 2020 2070 6c74 2e66 696c  .        plt.fil
+0006dbb0: 6c5f 6265 7477 6565 6e28 7265 6361 6c6c  l_between(recall
+0006dbc0: 2c20 7072 6563 6973 696f 6e2c 2061 6c70  , precision, alp
+0006dbd0: 6861 3d30 2e32 2c20 636f 6c6f 723d 2767  ha=0.2, color='g
+0006dbe0: 272c 202a 2a73 7465 705f 6b77 6172 6773  ', **step_kwargs
+0006dbf0: 290d 0a0d 0a20 2020 2020 2020 2070 6c74  )....        plt
+0006dc00: 2e78 6c61 6265 6c28 2752 6563 616c 6c27  .xlabel('Recall'
+0006dc10: 290d 0a20 2020 2020 2020 2070 6c74 2e79  )..        plt.y
+0006dc20: 6c61 6265 6c28 2750 7265 6369 7369 6f6e  label('Precision
+0006dc30: 2729 0d0a 2020 2020 2020 2020 706c 742e  ')..        plt.
+0006dc40: 796c 696d 285b 302e 302c 2031 2e30 355d  ylim([0.0, 1.05]
+0006dc50: 290d 0a20 2020 2020 2020 2070 6c74 2e78  )..        plt.x
+0006dc60: 6c69 6d28 5b30 2e30 2c20 312e 305d 290d  lim([0.0, 1.0]).
+0006dc70: 0a20 2020 2020 2020 2070 6c74 2e74 6974  .        plt.tit
+0006dc80: 6c65 2827 5072 6563 6973 696f 6e2d 5265  le('Precision-Re
+0006dc90: 6361 6c6c 2063 7572 7665 3a20 4176 672e  call curve: Avg.
+0006dca0: 5072 6563 6973 696f 6e3d 7b30 3a30 2e32  Precision={0:0.2
+0006dcb0: 667d 2c20 4176 6720 4631 3d7b 313a 302e  f}, Avg F1={1:0.
+0006dcc0: 3266 7d27 2e66 6f72 6d61 7428 0d0a 2020  2f}'.format(..  
+0006dcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006dce0: 6176 6572 6167 655f 7072 6563 6973 696f  average_precisio
+0006dcf0: 6e2c 665f 7363 6f72 6573 2e6d 6561 6e28  n,f_scores.mean(
+0006dd00: 2929 290d 0a20 2020 2020 2020 2070 6c74  )))..        plt
+0006dd10: 2e73 686f 7728 293b 0d0a 2020 2020 2020  .show();..      
+0006dd20: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
+0006dd30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006dd40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006dd50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006dd60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006dd70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006dd80: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
-0006dd90: 2020 2020 2023 2049 6e20 6d75 6c74 692d       # In multi-
-0006dda0: 6c61 6265 6c20 7365 7474 696e 6773 0d0a  label settings..
-0006ddb0: 2020 2020 2020 2020 2320 2d2d 2d2d 2d2d          # ------
-0006ddc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0006ddd0: 2d2d 0d0a 2020 2020 2020 2020 230d 0a20  --..        #.. 
-0006dde0: 2020 2020 2020 2023 2043 7265 6174 6520         # Create 
-0006ddf0: 6d75 6c74 692d 6c61 6265 6c20 6461 7461  multi-label data
-0006de00: 2c20 6669 742c 2061 6e64 2070 7265 6469  , fit, and predi
-0006de10: 6374 0d0a 2020 2020 2020 2020 2320 2e2e  ct..        # ..
+0006dd70: 230d 0a20 2020 2065 6c73 653a 0d0a 2020  #..    else:..  
+0006dd80: 2020 2020 2020 2320 496e 206d 756c 7469        # In multi
+0006dd90: 2d6c 6162 656c 2073 6574 7469 6e67 730d  -label settings.
+0006dda0: 0a20 2020 2020 2020 2023 202d 2d2d 2d2d  .        # -----
+0006ddb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0006ddc0: 2d2d 2d0d 0a20 2020 2020 2020 2023 0d0a  ---..        #..
+0006ddd0: 2020 2020 2020 2020 2320 4372 6561 7465          # Create
+0006dde0: 206d 756c 7469 2d6c 6162 656c 2064 6174   multi-label dat
+0006ddf0: 612c 2066 6974 2c20 616e 6420 7072 6564  a, fit, and pred
+0006de00: 6963 740d 0a20 2020 2020 2020 2023 202e  ict..        # .
+0006de10: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
 0006de20: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006de30: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006de40: 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020  ...........     
-0006de50: 2020 2023 0d0a 2020 2020 2020 2020 2320     #..        # 
-0006de60: 5765 2063 7265 6174 6520 6120 6d75 6c74  We create a mult
-0006de70: 692d 6c61 6265 6c20 6461 7461 7365 742c  i-label dataset,
-0006de80: 2074 6f20 696c 6c75 7374 7261 7465 2074   to illustrate t
-0006de90: 6865 2070 7265 6369 7369 6f6e 2d72 6563  he precision-rec
-0006dea0: 616c 6c20 696e 0d0a 2020 2020 2020 2020  all in..        
-0006deb0: 2320 6d75 6c74 692d 6c61 6265 6c20 7365  # multi-label se
-0006dec0: 7474 696e 6773 0d0a 0d0a 2020 2020 2020  ttings....      
-0006ded0: 2020 2320 5573 6520 6c61 6265 6c5f 6269    # Use label_bi
-0006dee0: 6e61 7269 7a65 2074 6f20 6265 206d 756c  narize to be mul
-0006def0: 7469 2d6c 6162 656c 206c 696b 6520 7365  ti-label like se
-0006df00: 7474 696e 6773 0d0a 2020 2020 2020 2020  ttings..        
-0006df10: 5920 3d20 6c61 6265 6c5f 6269 6e61 7269  Y = label_binari
-0006df20: 7a65 2879 5f74 6573 742c 2063 6c61 7373  ze(y_test, class
-0006df30: 6573 290d 0a20 2020 2020 2020 206e 5f63  es)..        n_c
-0006df40: 6c61 7373 6573 203d 2059 2e73 6861 7065  lasses = Y.shape
-0006df50: 5b31 5d0d 0a20 2020 2020 2020 2059 5f74  [1]..        Y_t
-0006df60: 6573 7420 3d20 636f 7079 2e64 6565 7063  est = copy.deepc
-0006df70: 6f70 7928 5929 0d0a 2020 2020 2020 2020  opy(Y)..        
-0006df80: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-0006df90: 2020 795f 7363 6f72 6520 3d20 636c 6173    y_score = clas
-0006dfa0: 7369 6669 6572 2e64 6563 6973 696f 6e5f  sifier.decision_
-0006dfb0: 6675 6e63 7469 6f6e 2858 5f74 6573 7429  function(X_test)
-0006dfc0: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
-0006dfd0: 3a0d 0a20 2020 2020 2020 2020 2020 2079  :..            y
-0006dfe0: 5f73 636f 7265 203d 2063 6c61 7373 6966  _score = classif
-0006dff0: 6965 722e 7072 6564 6963 745f 7072 6f62  ier.predict_prob
-0006e000: 6128 585f 7465 7374 290d 0a0d 0a20 2020  a(X_test)....   
-0006e010: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
+0006de30: 2e2e 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020  ............    
+0006de40: 2020 2020 230d 0a20 2020 2020 2020 2023      #..        #
+0006de50: 2057 6520 6372 6561 7465 2061 206d 756c   We create a mul
+0006de60: 7469 2d6c 6162 656c 2064 6174 6173 6574  ti-label dataset
+0006de70: 2c20 746f 2069 6c6c 7573 7472 6174 6520  , to illustrate 
+0006de80: 7468 6520 7072 6563 6973 696f 6e2d 7265  the precision-re
+0006de90: 6361 6c6c 2069 6e0d 0a20 2020 2020 2020  call in..       
+0006dea0: 2023 206d 756c 7469 2d6c 6162 656c 2073   # multi-label s
+0006deb0: 6574 7469 6e67 730d 0a0d 0a20 2020 2020  ettings....     
+0006dec0: 2020 2023 2055 7365 206c 6162 656c 5f62     # Use label_b
+0006ded0: 696e 6172 697a 6520 746f 2062 6520 6d75  inarize to be mu
+0006dee0: 6c74 692d 6c61 6265 6c20 6c69 6b65 2073  lti-label like s
+0006def0: 6574 7469 6e67 730d 0a20 2020 2020 2020  ettings..       
+0006df00: 2059 203d 206c 6162 656c 5f62 696e 6172   Y = label_binar
+0006df10: 697a 6528 795f 7465 7374 2c20 636c 6173  ize(y_test, clas
+0006df20: 7365 7329 0d0a 2020 2020 2020 2020 6e5f  ses)..        n_
+0006df30: 636c 6173 7365 7320 3d20 592e 7368 6170  classes = Y.shap
+0006df40: 655b 315d 0d0a 2020 2020 2020 2020 595f  e[1]..        Y_
+0006df50: 7465 7374 203d 2063 6f70 792e 6465 6570  test = copy.deep
+0006df60: 636f 7079 2859 290d 0a20 2020 2020 2020  copy(Y)..       
+0006df70: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
+0006df80: 2020 2079 5f73 636f 7265 203d 2063 6c61     y_score = cla
+0006df90: 7373 6966 6965 722e 6465 6369 7369 6f6e  ssifier.decision
+0006dfa0: 5f66 756e 6374 696f 6e28 585f 7465 7374  _function(X_test
+0006dfb0: 290d 0a20 2020 2020 2020 2065 7863 6570  )..        excep
+0006dfc0: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
+0006dfd0: 795f 7363 6f72 6520 3d20 636c 6173 7369  y_score = classi
+0006dfe0: 6669 6572 2e70 7265 6469 6374 5f70 726f  fier.predict_pro
+0006dff0: 6261 2858 5f74 6573 7429 0d0a 0d0a 2020  ba(X_test)....  
+0006e000: 2020 2020 2020 2323 2323 2323 2323 2323        ##########
+0006e010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006e020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006e030: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006e040: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e060: 2323 2323 0d0a 2020 2020 2020 2020 2320  ####..        # 
-0006e070: 5468 6520 6176 6572 6167 6520 7072 6563  The average prec
-0006e080: 6973 696f 6e20 7363 6f72 6520 696e 206d  ision score in m
-0006e090: 756c 7469 2d6c 6162 656c 2073 6574 7469  ulti-label setti
-0006e0a0: 6e67 730d 0a20 2020 2020 2020 2023 202e  ngs..        # .
+0006e050: 2323 2323 230d 0a20 2020 2020 2020 2023  #####..        #
+0006e060: 2054 6865 2061 7665 7261 6765 2070 7265   The average pre
+0006e070: 6369 7369 6f6e 2073 636f 7265 2069 6e20  cision score in 
+0006e080: 6d75 6c74 692d 6c61 6265 6c20 7365 7474  multi-label sett
+0006e090: 696e 6773 0d0a 2020 2020 2020 2020 2320  ings..        # 
+0006e0a0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
 0006e0b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
 0006e0c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006e0d0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006e0e0: 2e2e 2e0d 0a0d 0a20 2020 2020 2020 2023  .......        #
-0006e0f0: 2046 6f72 2065 6163 6820 636c 6173 730d   For each class.
-0006e100: 0a20 2020 2020 2020 2070 7265 6369 7369  .        precisi
-0006e110: 6f6e 203d 2064 6963 7428 290d 0a20 2020  on = dict()..   
-0006e120: 2020 2020 2072 6563 616c 6c20 3d20 6469       recall = di
-0006e130: 6374 2829 0d0a 2020 2020 2020 2020 6176  ct()..        av
-0006e140: 6572 6167 655f 7072 6563 6973 696f 6e20  erage_precision 
-0006e150: 3d20 6469 6374 2829 0d0a 2020 2020 2020  = dict()..      
-0006e160: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-0006e170: 286e 5f63 6c61 7373 6573 293a 0d0a 2020  (n_classes):..  
-0006e180: 2020 2020 2020 2020 2020 7072 6563 6973            precis
-0006e190: 696f 6e5b 695d 2c20 7265 6361 6c6c 5b69  ion[i], recall[i
-0006e1a0: 5d2c 205f 203d 2070 7265 6369 7369 6f6e  ], _ = precision
-0006e1b0: 5f72 6563 616c 6c5f 6375 7276 6528 595f  _recall_curve(Y_
-0006e1c0: 7465 7374 5b3a 2c20 695d 2c0d 0a20 2020  test[:, i],..   
+0006e0d0: 2e2e 2e2e 0d0a 0d0a 2020 2020 2020 2020  ........        
+0006e0e0: 2320 466f 7220 6561 6368 2063 6c61 7373  # For each class
+0006e0f0: 0d0a 2020 2020 2020 2020 7072 6563 6973  ..        precis
+0006e100: 696f 6e20 3d20 6469 6374 2829 0d0a 2020  ion = dict()..  
+0006e110: 2020 2020 2020 7265 6361 6c6c 203d 2064        recall = d
+0006e120: 6963 7428 290d 0a20 2020 2020 2020 2061  ict()..        a
+0006e130: 7665 7261 6765 5f70 7265 6369 7369 6f6e  verage_precision
+0006e140: 203d 2064 6963 7428 290d 0a20 2020 2020   = dict()..     
+0006e150: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+0006e160: 6528 6e5f 636c 6173 7365 7329 3a0d 0a20  e(n_classes):.. 
+0006e170: 2020 2020 2020 2020 2020 2070 7265 6369             preci
+0006e180: 7369 6f6e 5b69 5d2c 2072 6563 616c 6c5b  sion[i], recall[
+0006e190: 695d 2c20 5f20 3d20 7072 6563 6973 696f  i], _ = precisio
+0006e1a0: 6e5f 7265 6361 6c6c 5f63 7572 7665 2859  n_recall_curve(Y
+0006e1b0: 5f74 6573 745b 3a2c 2069 5d2c 0d0a 2020  _test[:, i],..  
+0006e1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0006e1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0006e1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006e1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006e200: 2020 2020 2020 2020 2020 2020 2079 5f73               y_s
-0006e210: 636f 7265 5b3a 2c20 695d 290d 0a20 2020  core[:, i])..   
-0006e220: 2020 2020 2020 2020 2061 7665 7261 6765           average
-0006e230: 5f70 7265 6369 7369 6f6e 5b69 5d20 3d20  _precision[i] = 
-0006e240: 6176 6572 6167 655f 7072 6563 6973 696f  average_precisio
-0006e250: 6e5f 7363 6f72 6528 595f 7465 7374 5b3a  n_score(Y_test[:
-0006e260: 2c20 695d 2c20 795f 7363 6f72 655b 3a2c  , i], y_score[:,
-0006e270: 2069 5d29 0d0a 0d0a 2020 2020 2020 2020   i])....        
-0006e280: 2320 4120 226d 6963 726f 2d61 7665 7261  # A "micro-avera
-0006e290: 6765 223a 2071 7561 6e74 6966 7969 6e67  ge": quantifying
-0006e2a0: 2073 636f 7265 206f 6e20 616c 6c20 636c   score on all cl
-0006e2b0: 6173 7365 7320 6a6f 696e 746c 790d 0a20  asses jointly.. 
-0006e2c0: 2020 2020 2020 2070 7265 6369 7369 6f6e         precision
-0006e2d0: 5b22 6d69 6372 6f22 5d2c 2072 6563 616c  ["micro"], recal
-0006e2e0: 6c5b 226d 6963 726f 225d 2c20 5f20 3d20  l["micro"], _ = 
-0006e2f0: 7072 6563 6973 696f 6e5f 7265 6361 6c6c  precision_recall
-0006e300: 5f63 7572 7665 2859 5f74 6573 745b 0d0a  _curve(Y_test[..
-0006e310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006e320: 2020 2020 2020 2020 3a2c 3a6e 5f63 6c61          :,:n_cla
-0006e330: 7373 6573 5d2e 7261 7665 6c28 292c 795f  sses].ravel(),y_
-0006e340: 7363 6f72 655b 3a2c 3a6e 5f63 6c61 7373  score[:,:n_class
-0006e350: 6573 5d2e 7261 7665 6c28 2929 0d0a 2020  es].ravel())..  
-0006e360: 2020 2020 2020 6176 6572 6167 655f 7072        average_pr
-0006e370: 6563 6973 696f 6e5b 226d 6963 726f 225d  ecision["micro"]
-0006e380: 203d 2061 7665 7261 6765 5f70 7265 6369   = average_preci
-0006e390: 7369 6f6e 5f73 636f 7265 2859 5f74 6573  sion_score(Y_tes
-0006e3a0: 745b 0d0a 2020 2020 2020 2020 2020 2020  t[..            
-0006e3b0: 2020 2020 2020 2020 2020 2020 3a2c 3a6e              :,:n
-0006e3c0: 5f63 6c61 7373 6573 5d2c 2079 5f73 636f  _classes], y_sco
-0006e3d0: 7265 5b3a 2c3a 6e5f 636c 6173 7365 735d  re[:,:n_classes]
-0006e3e0: 2c61 7665 7261 6765 3d22 6d69 6372 6f22  ,average="micro"
-0006e3f0: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
-0006e400: 2827 4176 6572 6167 6520 7072 6563 6973  ('Average precis
-0006e410: 696f 6e20 7363 6f72 652c 206d 6963 726f  ion score, micro
-0006e420: 2d61 7665 7261 6765 6420 6f76 6572 2061  -averaged over a
-0006e430: 6c6c 2063 6c61 7373 6573 3a20 7b30 3a30  ll classes: {0:0
-0006e440: 2e32 667d 270d 0a20 2020 2020 2020 2020  .2f}'..         
-0006e450: 2020 2020 202e 666f 726d 6174 2861 7665       .format(ave
-0006e460: 7261 6765 5f70 7265 6369 7369 6f6e 5b22  rage_precision["
-0006e470: 6d69 6372 6f22 5d29 290d 0a0d 0a20 2020  micro"]))....   
-0006e480: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
+0006e1f0: 2020 2020 2020 2020 2020 2020 2020 795f                y_
+0006e200: 7363 6f72 655b 3a2c 2069 5d29 0d0a 2020  score[:, i])..  
+0006e210: 2020 2020 2020 2020 2020 6176 6572 6167            averag
+0006e220: 655f 7072 6563 6973 696f 6e5b 695d 203d  e_precision[i] =
+0006e230: 2061 7665 7261 6765 5f70 7265 6369 7369   average_precisi
+0006e240: 6f6e 5f73 636f 7265 2859 5f74 6573 745b  on_score(Y_test[
+0006e250: 3a2c 2069 5d2c 2079 5f73 636f 7265 5b3a  :, i], y_score[:
+0006e260: 2c20 695d 290d 0a0d 0a20 2020 2020 2020  , i])....       
+0006e270: 2023 2041 2022 6d69 6372 6f2d 6176 6572   # A "micro-aver
+0006e280: 6167 6522 3a20 7175 616e 7469 6679 696e  age": quantifyin
+0006e290: 6720 7363 6f72 6520 6f6e 2061 6c6c 2063  g score on all c
+0006e2a0: 6c61 7373 6573 206a 6f69 6e74 6c79 0d0a  lasses jointly..
+0006e2b0: 2020 2020 2020 2020 7072 6563 6973 696f          precisio
+0006e2c0: 6e5b 226d 6963 726f 225d 2c20 7265 6361  n["micro"], reca
+0006e2d0: 6c6c 5b22 6d69 6372 6f22 5d2c 205f 203d  ll["micro"], _ =
+0006e2e0: 2070 7265 6369 7369 6f6e 5f72 6563 616c   precision_recal
+0006e2f0: 6c5f 6375 7276 6528 595f 7465 7374 5b0d  l_curve(Y_test[.
+0006e300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0006e310: 2020 2020 2020 2020 203a 2c3a 6e5f 636c           :,:n_cl
+0006e320: 6173 7365 735d 2e72 6176 656c 2829 2c79  asses].ravel(),y
+0006e330: 5f73 636f 7265 5b3a 2c3a 6e5f 636c 6173  _score[:,:n_clas
+0006e340: 7365 735d 2e72 6176 656c 2829 290d 0a20  ses].ravel()).. 
+0006e350: 2020 2020 2020 2061 7665 7261 6765 5f70         average_p
+0006e360: 7265 6369 7369 6f6e 5b22 6d69 6372 6f22  recision["micro"
+0006e370: 5d20 3d20 6176 6572 6167 655f 7072 6563  ] = average_prec
+0006e380: 6973 696f 6e5f 7363 6f72 6528 595f 7465  ision_score(Y_te
+0006e390: 7374 5b0d 0a20 2020 2020 2020 2020 2020  st[..           
+0006e3a0: 2020 2020 2020 2020 2020 2020 203a 2c3a               :,:
+0006e3b0: 6e5f 636c 6173 7365 735d 2c20 795f 7363  n_classes], y_sc
+0006e3c0: 6f72 655b 3a2c 3a6e 5f63 6c61 7373 6573  ore[:,:n_classes
+0006e3d0: 5d2c 6176 6572 6167 653d 226d 6963 726f  ],average="micro
+0006e3e0: 2229 0d0a 2020 2020 2020 2020 7072 696e  ")..        prin
+0006e3f0: 7428 2741 7665 7261 6765 2070 7265 6369  t('Average preci
+0006e400: 7369 6f6e 2073 636f 7265 2c20 6d69 6372  sion score, micr
+0006e410: 6f2d 6176 6572 6167 6564 206f 7665 7220  o-averaged over 
+0006e420: 616c 6c20 636c 6173 7365 733a 207b 303a  all classes: {0:
+0006e430: 302e 3266 7d27 0d0a 2020 2020 2020 2020  0.2f}'..        
+0006e440: 2020 2020 2020 2e66 6f72 6d61 7428 6176        .format(av
+0006e450: 6572 6167 655f 7072 6563 6973 696f 6e5b  erage_precision[
+0006e460: 226d 6963 726f 225d 2929 0d0a 0d0a 2020  "micro"]))....  
+0006e470: 2020 2020 2020 2323 2323 2323 2323 2323        ##########
+0006e480: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006e490: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006e4a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006e4b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e4c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e4d0: 2323 2323 0d0a 2020 2020 2020 2020 2320  ####..        # 
-0006e4e0: 506c 6f74 2050 7265 6369 7369 6f6e 2d52  Plot Precision-R
-0006e4f0: 6563 616c 6c20 6375 7276 6520 666f 7220  ecall curve for 
-0006e500: 6561 6368 2063 6c61 7373 2061 6e64 2069  each class and i
-0006e510: 736f 2d66 3120 6375 7276 6573 0d0a 2020  so-f1 curves..  
-0006e520: 2020 2020 2020 2320 506c 6f74 2074 6865        # Plot the
-0006e530: 206d 6963 726f 2d61 7665 7261 6765 6420   micro-averaged 
-0006e540: 5072 6563 6973 696f 6e2d 5265 6361 6c6c  Precision-Recall
-0006e550: 2063 7572 7665 0d0a 2020 2020 2020 2020   curve..        
+0006e4c0: 2323 2323 230d 0a20 2020 2020 2020 2023  #####..        #
+0006e4d0: 2050 6c6f 7420 5072 6563 6973 696f 6e2d   Plot Precision-
+0006e4e0: 5265 6361 6c6c 2063 7572 7665 2066 6f72  Recall curve for
+0006e4f0: 2065 6163 6820 636c 6173 7320 616e 6420   each class and 
+0006e500: 6973 6f2d 6631 2063 7572 7665 730d 0a20  iso-f1 curves.. 
+0006e510: 2020 2020 2020 2023 2050 6c6f 7420 7468         # Plot th
+0006e520: 6520 6d69 6372 6f2d 6176 6572 6167 6564  e micro-averaged
+0006e530: 2050 7265 6369 7369 6f6e 2d52 6563 616c   Precision-Recal
+0006e540: 6c20 6375 7276 650d 0a20 2020 2020 2020  l curve..       
+0006e550: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
 0006e560: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006e570: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006e580: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006e590: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006e5a0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-0006e5b0: 0a20 2020 2020 2020 2023 202e 2e2e 2e2e  .        # .....
+0006e5a0: 0d0a 2020 2020 2020 2020 2320 2e2e 2e2e  ..        # ....
+0006e5b0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
 0006e5c0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
 0006e5d0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006e5e0: 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e 2e2e  ................
-0006e5f0: 2e2e 2e2e 2e2e 2e2e 0d0a 2020 2020 2020  ..........      
-0006e600: 2020 230d 0a20 2020 2020 2020 2023 2073    #..        # s
-0006e610: 6574 7570 2070 6c6f 7420 6465 7461 696c  etup plot detail
-0006e620: 730d 0a20 2020 2020 2020 2063 6f6c 6f72  s..        color
-0006e630: 7320 3d20 6379 636c 6528 2762 7972 636d  s = cycle('byrcm
-0006e640: 676b 6279 7263 6d67 6b62 7972 636d 676b  gkbyrcmgkbyrcmgk
-0006e650: 6279 7263 6d67 6b27 290d 0a0d 0a20 2020  byrcmgk')....   
-0006e660: 2020 2020 2070 6c74 2e66 6967 7572 6528       plt.figure(
-0006e670: 6669 6773 697a 653d 6669 6773 697a 6529  figsize=figsize)
-0006e680: 0d0a 2020 2020 2020 2020 665f 7363 6f72  ..        f_scor
-0006e690: 6573 203d 206d 756c 7469 5f66 3128 795f  es = multi_f1(y_
-0006e6a0: 7465 7374 2c63 6c61 7373 6966 6965 722e  test,classifier.
-0006e6b0: 7072 6564 6963 7428 585f 7465 7374 2929  predict(X_test))
-0006e6c0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-0006e6d0: 274d 6163 726f 2046 3120 7363 6f72 652c  'Macro F1 score,
-0006e6e0: 2061 7665 7261 6765 6420 6f76 6572 2061   averaged over a
-0006e6f0: 6c6c 2063 6c61 7373 6573 3a20 7b30 3a30  ll classes: {0:0
-0006e700: 2e32 667d 270d 0a20 2020 2020 2020 2020  .2f}'..         
-0006e710: 2020 2020 202e 666f 726d 6174 2866 5f73       .format(f_s
-0006e720: 636f 7265 732e 6d65 616e 2829 2929 0d0a  cores.mean()))..
-0006e730: 2020 2020 2020 2020 6c69 6e65 7320 3d20          lines = 
-0006e740: 5b5d 0d0a 2020 2020 2020 2020 6c61 6265  []..        labe
-0006e750: 6c73 203d 205b 5d0d 0a20 2020 2020 2020  ls = []..       
-0006e760: 2066 6f72 2066 5f73 636f 7265 2069 6e20   for f_score in 
-0006e770: 665f 7363 6f72 6573 3a0d 0a20 2020 2020  f_scores:..     
-0006e780: 2020 2020 2020 2078 203d 206e 702e 6c69         x = np.li
-0006e790: 6e73 7061 6365 2830 2e30 312c 2031 290d  nspace(0.01, 1).
-0006e7a0: 0a20 2020 2020 2020 2020 2020 2079 203d  .            y =
-0006e7b0: 2066 5f73 636f 7265 202a 2078 202f 2028   f_score * x / (
-0006e7c0: 3220 2a20 7820 2d20 665f 7363 6f72 6529  2 * x - f_score)
-0006e7d0: 0d0a 2020 2020 2020 2020 2020 2020 6c2c  ..            l,
-0006e7e0: 203d 2070 6c74 2e70 6c6f 7428 785b 7920   = plt.plot(x[y 
-0006e7f0: 3e3d 2030 5d2c 2079 5b79 203e 3d20 305d  >= 0], y[y >= 0]
-0006e800: 2c20 636f 6c6f 723d 2767 7261 7927 2c20  , color='gray', 
-0006e810: 616c 7068 613d 302e 3229 0d0a 2020 2020  alpha=0.2)..    
-0006e820: 2020 2020 2020 2020 706c 742e 616e 6e6f          plt.anno
-0006e830: 7461 7465 2827 6631 3d7b 303a 302e 3266  tate('f1={0:0.2f
-0006e840: 7d27 2e66 6f72 6d61 7428 665f 7363 6f72  }'.format(f_scor
-0006e850: 6529 2c20 7879 3d28 302e 392c 2079 5b34  e), xy=(0.9, y[4
-0006e860: 355d 202b 2030 2e30 3229 290d 0a0d 0a20  5] + 0.02)).... 
-0006e870: 2020 2020 2020 206c 696e 6573 2e61 7070         lines.app
-0006e880: 656e 6428 6c29 0d0a 2020 2020 2020 2020  end(l)..        
-0006e890: 6c61 6265 6c73 2e61 7070 656e 6428 2769  labels.append('i
-0006e8a0: 736f 2d66 3120 6375 7276 6573 2729 0d0a  so-f1 curves')..
-0006e8b0: 2020 2020 2020 2020 6c2c 203d 2070 6c74          l, = plt
-0006e8c0: 2e70 6c6f 7428 7265 6361 6c6c 5b22 6d69  .plot(recall["mi
-0006e8d0: 6372 6f22 5d2c 2070 7265 6369 7369 6f6e  cro"], precision
-0006e8e0: 5b22 6d69 6372 6f22 5d2c 2063 6f6c 6f72  ["micro"], color
-0006e8f0: 3d27 676f 6c64 272c 206c 773d 3229 0d0a  ='gold', lw=2)..
-0006e900: 2020 2020 2020 2020 6c69 6e65 732e 6170          lines.ap
-0006e910: 7065 6e64 286c 290d 0a20 2020 2020 2020  pend(l)..       
-0006e920: 206c 6162 656c 732e 6170 7065 6e64 2827   labels.append('
-0006e930: 6d69 6372 6f2d 6176 6572 6167 6520 5072  micro-average Pr
-0006e940: 6563 6973 696f 6e2d 7265 6361 6c6c 2028  ecision-recall (
-0006e950: 6172 6561 203d 207b 303a 302e 3266 7d29  area = {0:0.2f})
-0006e960: 270d 0a20 2020 2020 2020 2020 2020 2020  '..             
-0006e970: 2020 2020 2020 2020 2027 272e 666f 726d           ''.form
-0006e980: 6174 2861 7665 7261 6765 5f70 7265 6369  at(average_preci
-0006e990: 7369 6f6e 5b22 6d69 6372 6f22 5d29 290d  sion["micro"])).
-0006e9a0: 0a0d 0a20 2020 2020 2020 2066 6f72 2069  ...        for i
-0006e9b0: 2c20 636f 6c6f 7220 696e 207a 6970 2872  , color in zip(r
-0006e9c0: 616e 6765 286e 5f63 6c61 7373 6573 292c  ange(n_classes),
-0006e9d0: 2063 6f6c 6f72 7329 3a0d 0a20 2020 2020   colors):..     
-0006e9e0: 2020 2020 2020 206c 2c20 3d20 706c 742e         l, = plt.
-0006e9f0: 706c 6f74 2872 6563 616c 6c5b 695d 2c20  plot(recall[i], 
-0006ea00: 7072 6563 6973 696f 6e5b 695d 2c20 636f  precision[i], co
-0006ea10: 6c6f 723d 636f 6c6f 722c 206c 773d 3129  lor=color, lw=1)
-0006ea20: 0d0a 2020 2020 2020 2020 2020 2020 6c69  ..            li
-0006ea30: 6e65 732e 6170 7065 6e64 286c 290d 0a20  nes.append(l).. 
-0006ea40: 2020 2020 2020 2020 2020 206c 6162 656c             label
-0006ea50: 732e 6170 7065 6e64 2827 5072 6563 6973  s.append('Precis
-0006ea60: 696f 6e2d 7265 6361 6c6c 2066 6f72 2063  ion-recall for c
-0006ea70: 6c61 7373 207b 307d 2028 6172 6561 203d  lass {0} (area =
-0006ea80: 207b 313a 302e 3266 7d29 270d 0a20 2020   {1:0.2f})'..   
-0006ea90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006eaa0: 2020 2020 2020 2027 272e 666f 726d 6174         ''.format
-0006eab0: 2869 2c20 6176 6572 6167 655f 7072 6563  (i, average_prec
-0006eac0: 6973 696f 6e5b 695d 2929 0d0a 0d0a 2020  ision[i]))....  
-0006ead0: 2020 2020 2020 6669 6720 3d20 706c 742e        fig = plt.
-0006eae0: 6763 6628 290d 0a20 2020 2020 2020 2066  gcf()..        f
-0006eaf0: 6967 2e73 7562 706c 6f74 735f 6164 6a75  ig.subplots_adju
-0006eb00: 7374 2862 6f74 746f 6d3d 302e 3235 290d  st(bottom=0.25).
-0006eb10: 0a20 2020 2020 2020 2070 6c74 2e78 6c69  .        plt.xli
-0006eb20: 6d28 5b30 2e30 2c20 312e 305d 290d 0a20  m([0.0, 1.0]).. 
-0006eb30: 2020 2020 2020 2070 6c74 2e79 6c69 6d28         plt.ylim(
-0006eb40: 5b30 2e30 2c20 312e 3035 5d29 0d0a 2020  [0.0, 1.05])..  
-0006eb50: 2020 2020 2020 706c 742e 786c 6162 656c        plt.xlabel
-0006eb60: 2827 5265 6361 6c6c 2729 0d0a 2020 2020  ('Recall')..    
-0006eb70: 2020 2020 706c 742e 796c 6162 656c 2827      plt.ylabel('
-0006eb80: 5072 6563 6973 696f 6e27 290d 0a20 2020  Precision')..   
-0006eb90: 2020 2020 2070 6c74 2e74 6974 6c65 2827       plt.title('
-0006eba0: 4d69 6372 6f20 4176 6720 5072 6563 6973  Micro Avg Precis
-0006ebb0: 696f 6e2d 5265 6361 6c6c 2063 7572 7665  ion-Recall curve
-0006ebc0: 2077 6974 6820 6973 6f2d 6631 2063 7572   with iso-f1 cur
-0006ebd0: 7665 7327 290d 0a20 2020 2020 2020 2070  ves')..        p
-0006ebe0: 6c74 2e6c 6567 656e 6428 6c69 6e65 732c  lt.legend(lines,
-0006ebf0: 206c 6162 656c 732c 206c 6f63 3d27 6c6f   labels, loc='lo
-0006ec00: 7765 7220 6c65 6674 272c 2070 726f 703d  wer left', prop=
-0006ec10: 6469 6374 2873 697a 653d 3130 2929 0d0a  dict(size=10))..
-0006ec20: 2020 2020 2020 2020 706c 742e 7368 6f77          plt.show
-0006ec30: 2829 3b0d 0a23 2323 2323 2323 2323 2323  ();..###########
+0006e5e0: 2e2e 2e2e 2e2e 2e2e 2e0d 0a20 2020 2020  ...........     
+0006e5f0: 2020 2023 0d0a 2020 2020 2020 2020 2320     #..        # 
+0006e600: 7365 7475 7020 706c 6f74 2064 6574 6169  setup plot detai
+0006e610: 6c73 0d0a 2020 2020 2020 2020 636f 6c6f  ls..        colo
+0006e620: 7273 203d 2063 7963 6c65 2827 6279 7263  rs = cycle('byrc
+0006e630: 6d67 6b62 7972 636d 676b 6279 7263 6d67  mgkbyrcmgkbyrcmg
+0006e640: 6b62 7972 636d 676b 2729 0d0a 0d0a 2020  kbyrcmgk')....  
+0006e650: 2020 2020 2020 706c 742e 6669 6775 7265        plt.figure
+0006e660: 2866 6967 7369 7a65 3d66 6967 7369 7a65  (figsize=figsize
+0006e670: 290d 0a20 2020 2020 2020 2066 5f73 636f  )..        f_sco
+0006e680: 7265 7320 3d20 6d75 6c74 695f 6631 2879  res = multi_f1(y
+0006e690: 5f74 6573 742c 636c 6173 7369 6669 6572  _test,classifier
+0006e6a0: 2e70 7265 6469 6374 2858 5f74 6573 7429  .predict(X_test)
+0006e6b0: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
+0006e6c0: 2827 4d61 6372 6f20 4631 2073 636f 7265  ('Macro F1 score
+0006e6d0: 2c20 6176 6572 6167 6564 206f 7665 7220  , averaged over 
+0006e6e0: 616c 6c20 636c 6173 7365 733a 207b 303a  all classes: {0:
+0006e6f0: 302e 3266 7d27 0d0a 2020 2020 2020 2020  0.2f}'..        
+0006e700: 2020 2020 2020 2e66 6f72 6d61 7428 665f        .format(f_
+0006e710: 7363 6f72 6573 2e6d 6561 6e28 2929 290d  scores.mean())).
+0006e720: 0a20 2020 2020 2020 206c 696e 6573 203d  .        lines =
+0006e730: 205b 5d0d 0a20 2020 2020 2020 206c 6162   []..        lab
+0006e740: 656c 7320 3d20 5b5d 0d0a 2020 2020 2020  els = []..      
+0006e750: 2020 666f 7220 665f 7363 6f72 6520 696e    for f_score in
+0006e760: 2066 5f73 636f 7265 733a 0d0a 2020 2020   f_scores:..    
+0006e770: 2020 2020 2020 2020 7820 3d20 6e70 2e6c          x = np.l
+0006e780: 696e 7370 6163 6528 302e 3031 2c20 3129  inspace(0.01, 1)
+0006e790: 0d0a 2020 2020 2020 2020 2020 2020 7920  ..            y 
+0006e7a0: 3d20 665f 7363 6f72 6520 2a20 7820 2f20  = f_score * x / 
+0006e7b0: 2832 202a 2078 202d 2066 5f73 636f 7265  (2 * x - f_score
+0006e7c0: 290d 0a20 2020 2020 2020 2020 2020 206c  )..            l
+0006e7d0: 2c20 3d20 706c 742e 706c 6f74 2878 5b79  , = plt.plot(x[y
+0006e7e0: 203e 3d20 305d 2c20 795b 7920 3e3d 2030   >= 0], y[y >= 0
+0006e7f0: 5d2c 2063 6f6c 6f72 3d27 6772 6179 272c  ], color='gray',
+0006e800: 2061 6c70 6861 3d30 2e32 290d 0a20 2020   alpha=0.2)..   
+0006e810: 2020 2020 2020 2020 2070 6c74 2e61 6e6e           plt.ann
+0006e820: 6f74 6174 6528 2766 313d 7b30 3a30 2e32  otate('f1={0:0.2
+0006e830: 667d 272e 666f 726d 6174 2866 5f73 636f  f}'.format(f_sco
+0006e840: 7265 292c 2078 793d 2830 2e39 2c20 795b  re), xy=(0.9, y[
+0006e850: 3435 5d20 2b20 302e 3032 2929 0d0a 0d0a  45] + 0.02))....
+0006e860: 2020 2020 2020 2020 6c69 6e65 732e 6170          lines.ap
+0006e870: 7065 6e64 286c 290d 0a20 2020 2020 2020  pend(l)..       
+0006e880: 206c 6162 656c 732e 6170 7065 6e64 2827   labels.append('
+0006e890: 6973 6f2d 6631 2063 7572 7665 7327 290d  iso-f1 curves').
+0006e8a0: 0a20 2020 2020 2020 206c 2c20 3d20 706c  .        l, = pl
+0006e8b0: 742e 706c 6f74 2872 6563 616c 6c5b 226d  t.plot(recall["m
+0006e8c0: 6963 726f 225d 2c20 7072 6563 6973 696f  icro"], precisio
+0006e8d0: 6e5b 226d 6963 726f 225d 2c20 636f 6c6f  n["micro"], colo
+0006e8e0: 723d 2767 6f6c 6427 2c20 6c77 3d32 290d  r='gold', lw=2).
+0006e8f0: 0a20 2020 2020 2020 206c 696e 6573 2e61  .        lines.a
+0006e900: 7070 656e 6428 6c29 0d0a 2020 2020 2020  ppend(l)..      
+0006e910: 2020 6c61 6265 6c73 2e61 7070 656e 6428    labels.append(
+0006e920: 276d 6963 726f 2d61 7665 7261 6765 2050  'micro-average P
+0006e930: 7265 6369 7369 6f6e 2d72 6563 616c 6c20  recision-recall 
+0006e940: 2861 7265 6120 3d20 7b30 3a30 2e32 667d  (area = {0:0.2f}
+0006e950: 2927 0d0a 2020 2020 2020 2020 2020 2020  )'..            
+0006e960: 2020 2020 2020 2020 2020 2727 2e66 6f72            ''.for
+0006e970: 6d61 7428 6176 6572 6167 655f 7072 6563  mat(average_prec
+0006e980: 6973 696f 6e5b 226d 6963 726f 225d 2929  ision["micro"]))
+0006e990: 0d0a 0d0a 2020 2020 2020 2020 666f 7220  ....        for 
+0006e9a0: 692c 2063 6f6c 6f72 2069 6e20 7a69 7028  i, color in zip(
+0006e9b0: 7261 6e67 6528 6e5f 636c 6173 7365 7329  range(n_classes)
+0006e9c0: 2c20 636f 6c6f 7273 293a 0d0a 2020 2020  , colors):..    
+0006e9d0: 2020 2020 2020 2020 6c2c 203d 2070 6c74          l, = plt
+0006e9e0: 2e70 6c6f 7428 7265 6361 6c6c 5b69 5d2c  .plot(recall[i],
+0006e9f0: 2070 7265 6369 7369 6f6e 5b69 5d2c 2063   precision[i], c
+0006ea00: 6f6c 6f72 3d63 6f6c 6f72 2c20 6c77 3d31  olor=color, lw=1
+0006ea10: 290d 0a20 2020 2020 2020 2020 2020 206c  )..            l
+0006ea20: 696e 6573 2e61 7070 656e 6428 6c29 0d0a  ines.append(l)..
+0006ea30: 2020 2020 2020 2020 2020 2020 6c61 6265              labe
+0006ea40: 6c73 2e61 7070 656e 6428 2750 7265 6369  ls.append('Preci
+0006ea50: 7369 6f6e 2d72 6563 616c 6c20 666f 7220  sion-recall for 
+0006ea60: 636c 6173 7320 7b30 7d20 2861 7265 6120  class {0} (area 
+0006ea70: 3d20 7b31 3a30 2e32 667d 2927 0d0a 2020  = {1:0.2f})'..  
+0006ea80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006ea90: 2020 2020 2020 2020 2727 2e66 6f72 6d61          ''.forma
+0006eaa0: 7428 692c 2061 7665 7261 6765 5f70 7265  t(i, average_pre
+0006eab0: 6369 7369 6f6e 5b69 5d29 290d 0a0d 0a20  cision[i])).... 
+0006eac0: 2020 2020 2020 2066 6967 203d 2070 6c74         fig = plt
+0006ead0: 2e67 6366 2829 0d0a 2020 2020 2020 2020  .gcf()..        
+0006eae0: 6669 672e 7375 6270 6c6f 7473 5f61 646a  fig.subplots_adj
+0006eaf0: 7573 7428 626f 7474 6f6d 3d30 2e32 3529  ust(bottom=0.25)
+0006eb00: 0d0a 2020 2020 2020 2020 706c 742e 786c  ..        plt.xl
+0006eb10: 696d 285b 302e 302c 2031 2e30 5d29 0d0a  im([0.0, 1.0])..
+0006eb20: 2020 2020 2020 2020 706c 742e 796c 696d          plt.ylim
+0006eb30: 285b 302e 302c 2031 2e30 355d 290d 0a20  ([0.0, 1.05]).. 
+0006eb40: 2020 2020 2020 2070 6c74 2e78 6c61 6265         plt.xlabe
+0006eb50: 6c28 2752 6563 616c 6c27 290d 0a20 2020  l('Recall')..   
+0006eb60: 2020 2020 2070 6c74 2e79 6c61 6265 6c28       plt.ylabel(
+0006eb70: 2750 7265 6369 7369 6f6e 2729 0d0a 2020  'Precision')..  
+0006eb80: 2020 2020 2020 706c 742e 7469 746c 6528        plt.title(
+0006eb90: 274d 6963 726f 2041 7667 2050 7265 6369  'Micro Avg Preci
+0006eba0: 7369 6f6e 2d52 6563 616c 6c20 6375 7276  sion-Recall curv
+0006ebb0: 6520 7769 7468 2069 736f 2d66 3120 6375  e with iso-f1 cu
+0006ebc0: 7276 6573 2729 0d0a 2020 2020 2020 2020  rves')..        
+0006ebd0: 706c 742e 6c65 6765 6e64 286c 696e 6573  plt.legend(lines
+0006ebe0: 2c20 6c61 6265 6c73 2c20 6c6f 633d 276c  , labels, loc='l
+0006ebf0: 6f77 6572 206c 6566 7427 2c20 7072 6f70  ower left', prop
+0006ec00: 3d64 6963 7428 7369 7a65 3d31 3029 290d  =dict(size=10)).
+0006ec10: 0a20 2020 2020 2020 2070 6c74 2e73 686f  .        plt.sho
+0006ec20: 7728 293b 0d0a 2323 2323 2323 2323 2323  w();..##########
+0006ec30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006ec40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006ec50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006ec60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ec70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006ec80: 2323 2323 2323 2323 2323 230d 0a69 6d70  ###########..imp
-0006ec90: 6f72 7420 6d61 7470 6c6f 746c 6962 2e70  ort matplotlib.p
-0006eca0: 7970 6c6f 7420 6173 2070 6c74 0d0a 696d  yplot as plt..im
-0006ecb0: 706f 7274 2073 6561 626f 726e 2061 7320  port seaborn as 
-0006ecc0: 736e 730d 0a64 6566 2064 7261 775f 636f  sns..def draw_co
-0006ecd0: 6e66 7573 696f 6e5f 6d61 7874 7269 7828  nfusion_maxtrix(
-0006ece0: 795f 7465 7374 2c79 5f70 7265 642c 206d  y_test,y_pred, m
-0006ecf0: 6f64 656c 5f6e 616d 653d 274d 6f64 656c  odel_name='Model
-0006ed00: 272c 6178 3d27 2729 3a0d 0a20 2020 2022  ',ax=''):..    "
-0006ed10: 2222 0d0a 2020 2020 5468 6973 2070 6c6f  ""..    This plo
-0006ed20: 7473 2061 2062 6561 7574 6966 756c 2063  ts a beautiful c
-0006ed30: 6f6e 6675 7369 6f6e 206d 6174 7269 7820  onfusion matrix 
-0006ed40: 6261 7365 6420 6f6e 2069 6e70 7574 3a20  based on input: 
-0006ed50: 6772 6f75 6e64 2074 7275 7468 7320 616e  ground truths an
-0006ed60: 6420 7072 6564 6963 7469 6f6e 730d 0a20  d predictions.. 
-0006ed70: 2020 2022 2222 0d0a 2020 2020 2343 6f6e     """..    #Con
-0006ed80: 6675 7369 6f6e 204d 6174 7269 780d 0a20  fusion Matrix.. 
-0006ed90: 2020 2027 2727 506c 6f74 7469 6e67 2043     '''Plotting C
-0006eda0: 4f4e 4655 5349 4f4e 204d 4154 5249 5827  ONFUSION MATRIX'
-0006edb0: 2727 0d0a 2020 2020 696d 706f 7274 2073  ''..    import s
-0006edc0: 6561 626f 726e 2061 7320 736e 730d 0a20  eaborn as sns.. 
-0006edd0: 2020 2073 6e73 2e73 6574 5f73 7479 6c65     sns.set_style
-0006ede0: 2827 6461 726b 6772 6964 2729 0d0a 0d0a  ('darkgrid')....
-0006edf0: 2020 2020 2727 2744 6973 706c 6179 2727      '''Display''
-0006ee00: 270d 0a20 2020 2066 726f 6d20 4950 7974  '..    from IPyt
-0006ee10: 686f 6e2e 636f 7265 2e64 6973 706c 6179  hon.core.display
-0006ee20: 2069 6d70 6f72 7420 6469 7370 6c61 792c   import display,
-0006ee30: 2048 544d 4c0d 0a20 2020 2064 6973 706c   HTML..    displ
-0006ee40: 6179 2848 544d 4c28 223c 7374 796c 653e  ay(HTML("<style>
-0006ee50: 2e63 6f6e 7461 696e 6572 207b 2077 6964  .container { wid
-0006ee60: 7468 3a39 3525 2021 696d 706f 7274 616e  th:95% !importan
-0006ee70: 743b 207d 3c2f 7374 796c 653e 2229 290d  t; }</style>")).
-0006ee80: 0a20 2020 2070 642e 6f70 7469 6f6e 732e  .    pd.options.
-0006ee90: 6469 7370 6c61 792e 666c 6f61 745f 666f  display.float_fo
-0006eea0: 726d 6174 203d 2027 7b3a 2c2e 3266 7d27  rmat = '{:,.2f}'
-0006eeb0: 2e66 6f72 6d61 740d 0a0d 0a20 2020 2023  .format....    #
-0006eec0: 4765 7420 7468 6520 636f 6e66 7573 696f  Get the confusio
-0006eed0: 6e20 6d61 7472 6978 2061 6e64 2070 7574  n matrix and put
-0006eee0: 2069 7420 696e 746f 2061 2064 660d 0a20   it into a df.. 
-0006eef0: 2020 2066 726f 6d20 736b 6c65 6172 6e2e     from sklearn.
-0006ef00: 6d65 7472 6963 7320 696d 706f 7274 2063  metrics import c
-0006ef10: 6f6e 6675 7369 6f6e 5f6d 6174 7269 782c  onfusion_matrix,
-0006ef20: 2066 315f 7363 6f72 650d 0a0d 0a20 2020   f1_score....   
-0006ef30: 2063 6d20 3d20 636f 6e66 7573 696f 6e5f   cm = confusion_
-0006ef40: 6d61 7472 6978 2879 5f74 6573 742c 2079  matrix(y_test, y
-0006ef50: 5f70 7265 6429 0d0a 0d0a 2020 2020 636d  _pred)....    cm
-0006ef60: 5f64 6620 3d20 7064 2e44 6174 6146 7261  _df = pd.DataFra
-0006ef70: 6d65 2863 6d2c 0d0a 2020 2020 2020 2020  me(cm,..        
-0006ef80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006ef90: 2069 6e64 6578 203d 206e 702e 756e 6971   index = np.uniq
-0006efa0: 7565 2879 5f74 6573 7429 2e74 6f6c 6973  ue(y_test).tolis
-0006efb0: 7428 292c 0d0a 2020 2020 2020 2020 2020  t(),..          
-0006efc0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0006efd0: 6f6c 756d 6e73 203d 206e 702e 756e 6971  olumns = np.uniq
-0006efe0: 7565 2879 5f74 6573 7429 2e74 6f6c 6973  ue(y_test).tolis
-0006eff0: 7428 292c 0d0a 2020 2020 2020 2020 2020  t(),..          
-0006f000: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-0006f010: 0a0d 0a20 2020 2073 6e73 2e68 6561 746d  ...    sns.heatm
-0006f020: 6170 2863 6d5f 6466 2c0d 0a20 2020 2020  ap(cm_df,..     
-0006f030: 2020 2020 2020 2020 2020 2063 656e 7465             cente
-0006f040: 723d 302c 0d0a 2020 2020 2020 2020 2020  r=0,..          
-0006f050: 2020 2020 2020 636d 6170 3d73 6e73 2e64        cmap=sns.d
-0006f060: 6976 6572 6769 6e67 5f70 616c 6574 7465  iverging_palette
-0006f070: 2832 3230 2c20 3135 2c20 6173 5f63 6d61  (220, 15, as_cma
-0006f080: 703d 5472 7565 292c 0d0a 2020 2020 2020  p=True),..      
-0006f090: 2020 2020 2020 2020 2020 616e 6e6f 743d            annot=
-0006f0a0: 5472 7565 2c0d 0a20 2020 2020 2020 2020  True,..         
-0006f0b0: 2020 2020 2020 2066 6d74 3d27 6727 2c0d         fmt='g',.
-0006f0c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0006f0d0: 6178 3d61 7829 0d0a 0d0a 2020 2020 6178  ax=ax)....    ax
-0006f0e0: 2e73 6574 5f74 6974 6c65 2827 2025 7320  .set_title(' %s 
-0006f0f0: 5c6e 4631 2053 636f 7265 2861 7667 203d  \nF1 Score(avg =
-0006f100: 206d 6963 726f 293a 2025 302e 3266 205c   micro): %0.2f \
-0006f110: 6e46 3120 5363 6f72 6528 6176 6720 3d20  nF1 Score(avg = 
-0006f120: 6d61 6372 6f29 3a20 2530 2e32 6627 2025  macro): %0.2f' %
-0006f130: 280d 0a20 2020 2020 2020 206d 6f64 656c  (..        model
-0006f140: 5f6e 616d 652c 6631 5f73 636f 7265 2879  _name,f1_score(y
-0006f150: 5f74 6573 742c 2079 5f70 7265 642c 2061  _test, y_pred, a
-0006f160: 7665 7261 6765 3d27 6d69 6372 6f27 292c  verage='micro'),
-0006f170: 6631 5f73 636f 7265 2879 5f74 6573 742c  f1_score(y_test,
-0006f180: 2079 5f70 7265 642c 2061 7665 7261 6765   y_pred, average
-0006f190: 3d27 6d61 6372 6f27 2929 2c0d 0a20 2020  ='macro')),..   
-0006f1a0: 2020 2020 2020 2020 2020 2066 6f6e 7473             fonts
-0006f1b0: 697a 6520 3d20 3133 290d 0a20 2020 2061  ize = 13)..    a
-0006f1c0: 782e 7365 745f 796c 6162 656c 2827 5472  x.set_ylabel('Tr
-0006f1d0: 7565 206c 6162 656c 272c 2066 6f6e 7473  ue label', fonts
-0006f1e0: 697a 6520 3d20 3133 290d 0a20 2020 2061  ize = 13)..    a
-0006f1f0: 782e 7365 745f 786c 6162 656c 2827 5072  x.set_xlabel('Pr
-0006f200: 6564 6963 7465 6420 6c61 6265 6c27 2c20  edicted label', 
-0006f210: 666f 6e74 7369 7a65 203d 2031 3329 0d0a  fontsize = 13)..
+0006ec70: 2323 2323 2323 2323 2323 2323 0d0a 696d  ############..im
+0006ec80: 706f 7274 206d 6174 706c 6f74 6c69 622e  port matplotlib.
+0006ec90: 7079 706c 6f74 2061 7320 706c 740d 0a69  pyplot as plt..i
+0006eca0: 6d70 6f72 7420 7365 6162 6f72 6e20 6173  mport seaborn as
+0006ecb0: 2073 6e73 0d0a 6465 6620 6472 6177 5f63   sns..def draw_c
+0006ecc0: 6f6e 6675 7369 6f6e 5f6d 6178 7472 6978  onfusion_maxtrix
+0006ecd0: 2879 5f74 6573 742c 795f 7072 6564 2c20  (y_test,y_pred, 
+0006ece0: 6d6f 6465 6c5f 6e61 6d65 3d27 4d6f 6465  model_name='Mode
+0006ecf0: 6c27 2c61 783d 2727 293a 0d0a 2020 2020  l',ax=''):..    
+0006ed00: 2222 220d 0a20 2020 2054 6869 7320 706c  """..    This pl
+0006ed10: 6f74 7320 6120 6265 6175 7469 6675 6c20  ots a beautiful 
+0006ed20: 636f 6e66 7573 696f 6e20 6d61 7472 6978  confusion matrix
+0006ed30: 2062 6173 6564 206f 6e20 696e 7075 743a   based on input:
+0006ed40: 2067 726f 756e 6420 7472 7574 6873 2061   ground truths a
+0006ed50: 6e64 2070 7265 6469 6374 696f 6e73 0d0a  nd predictions..
+0006ed60: 2020 2020 2222 220d 0a20 2020 2023 436f      """..    #Co
+0006ed70: 6e66 7573 696f 6e20 4d61 7472 6978 0d0a  nfusion Matrix..
+0006ed80: 2020 2020 2727 2750 6c6f 7474 696e 6720      '''Plotting 
+0006ed90: 434f 4e46 5553 494f 4e20 4d41 5452 4958  CONFUSION MATRIX
+0006eda0: 2727 270d 0a20 2020 2069 6d70 6f72 7420  '''..    import 
+0006edb0: 7365 6162 6f72 6e20 6173 2073 6e73 0d0a  seaborn as sns..
+0006edc0: 2020 2020 736e 732e 7365 745f 7374 796c      sns.set_styl
+0006edd0: 6528 2764 6172 6b67 7269 6427 290d 0a0d  e('darkgrid')...
+0006ede0: 0a20 2020 2027 2727 4469 7370 6c61 7927  .    '''Display'
+0006edf0: 2727 0d0a 2020 2020 6672 6f6d 2049 5079  ''..    from IPy
+0006ee00: 7468 6f6e 2e63 6f72 652e 6469 7370 6c61  thon.core.displa
+0006ee10: 7920 696d 706f 7274 2064 6973 706c 6179  y import display
+0006ee20: 2c20 4854 4d4c 0d0a 2020 2020 6469 7370  , HTML..    disp
+0006ee30: 6c61 7928 4854 4d4c 2822 3c73 7479 6c65  lay(HTML("<style
+0006ee40: 3e2e 636f 6e74 6169 6e65 7220 7b20 7769  >.container { wi
+0006ee50: 6474 683a 3935 2520 2169 6d70 6f72 7461  dth:95% !importa
+0006ee60: 6e74 3b20 7d3c 2f73 7479 6c65 3e22 2929  nt; }</style>"))
+0006ee70: 0d0a 2020 2020 7064 2e6f 7074 696f 6e73  ..    pd.options
+0006ee80: 2e64 6973 706c 6179 2e66 6c6f 6174 5f66  .display.float_f
+0006ee90: 6f72 6d61 7420 3d20 277b 3a2c 2e32 667d  ormat = '{:,.2f}
+0006eea0: 272e 666f 726d 6174 0d0a 0d0a 2020 2020  '.format....    
+0006eeb0: 2347 6574 2074 6865 2063 6f6e 6675 7369  #Get the confusi
+0006eec0: 6f6e 206d 6174 7269 7820 616e 6420 7075  on matrix and pu
+0006eed0: 7420 6974 2069 6e74 6f20 6120 6466 0d0a  t it into a df..
+0006eee0: 2020 2020 6672 6f6d 2073 6b6c 6561 726e      from sklearn
+0006eef0: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
+0006ef00: 636f 6e66 7573 696f 6e5f 6d61 7472 6978  confusion_matrix
+0006ef10: 2c20 6631 5f73 636f 7265 0d0a 0d0a 2020  , f1_score....  
+0006ef20: 2020 636d 203d 2063 6f6e 6675 7369 6f6e    cm = confusion
+0006ef30: 5f6d 6174 7269 7828 795f 7465 7374 2c20  _matrix(y_test, 
+0006ef40: 795f 7072 6564 290d 0a0d 0a20 2020 2063  y_pred)....    c
+0006ef50: 6d5f 6466 203d 2070 642e 4461 7461 4672  m_df = pd.DataFr
+0006ef60: 616d 6528 636d 2c0d 0a20 2020 2020 2020  ame(cm,..       
+0006ef70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006ef80: 2020 696e 6465 7820 3d20 6e70 2e75 6e69    index = np.uni
+0006ef90: 7175 6528 795f 7465 7374 292e 746f 6c69  que(y_test).toli
+0006efa0: 7374 2829 2c0d 0a20 2020 2020 2020 2020  st(),..         
+0006efb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006efc0: 636f 6c75 6d6e 7320 3d20 6e70 2e75 6e69  columns = np.uni
+0006efd0: 7175 6528 795f 7465 7374 292e 746f 6c69  que(y_test).toli
+0006efe0: 7374 2829 2c0d 0a20 2020 2020 2020 2020  st(),..         
+0006eff0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0006f000: 0d0a 0d0a 2020 2020 736e 732e 6865 6174  ....    sns.heat
+0006f010: 6d61 7028 636d 5f64 662c 0d0a 2020 2020  map(cm_df,..    
+0006f020: 2020 2020 2020 2020 2020 2020 6365 6e74              cent
+0006f030: 6572 3d30 2c0d 0a20 2020 2020 2020 2020  er=0,..         
+0006f040: 2020 2020 2020 2063 6d61 703d 736e 732e         cmap=sns.
+0006f050: 6469 7665 7267 696e 675f 7061 6c65 7474  diverging_palett
+0006f060: 6528 3232 302c 2031 352c 2061 735f 636d  e(220, 15, as_cm
+0006f070: 6170 3d54 7275 6529 2c0d 0a20 2020 2020  ap=True),..     
+0006f080: 2020 2020 2020 2020 2020 2061 6e6e 6f74             annot
+0006f090: 3d54 7275 652c 0d0a 2020 2020 2020 2020  =True,..        
+0006f0a0: 2020 2020 2020 2020 666d 743d 2767 272c          fmt='g',
+0006f0b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0006f0c0: 2061 783d 6178 290d 0a0d 0a20 2020 2061   ax=ax)....    a
+0006f0d0: 782e 7365 745f 7469 746c 6528 2720 2573  x.set_title(' %s
+0006f0e0: 205c 6e46 3120 5363 6f72 6528 6176 6720   \nF1 Score(avg 
+0006f0f0: 3d20 6d69 6372 6f29 3a20 2530 2e32 6620  = micro): %0.2f 
+0006f100: 5c6e 4631 2053 636f 7265 2861 7667 203d  \nF1 Score(avg =
+0006f110: 206d 6163 726f 293a 2025 302e 3266 2720   macro): %0.2f' 
+0006f120: 2528 0d0a 2020 2020 2020 2020 6d6f 6465  %(..        mode
+0006f130: 6c5f 6e61 6d65 2c66 315f 7363 6f72 6528  l_name,f1_score(
+0006f140: 795f 7465 7374 2c20 795f 7072 6564 2c20  y_test, y_pred, 
+0006f150: 6176 6572 6167 653d 276d 6963 726f 2729  average='micro')
+0006f160: 2c66 315f 7363 6f72 6528 795f 7465 7374  ,f1_score(y_test
+0006f170: 2c20 795f 7072 6564 2c20 6176 6572 6167  , y_pred, averag
+0006f180: 653d 276d 6163 726f 2729 292c 0d0a 2020  e='macro')),..  
+0006f190: 2020 2020 2020 2020 2020 2020 666f 6e74              font
+0006f1a0: 7369 7a65 203d 2031 3329 0d0a 2020 2020  size = 13)..    
+0006f1b0: 6178 2e73 6574 5f79 6c61 6265 6c28 2754  ax.set_ylabel('T
+0006f1c0: 7275 6520 6c61 6265 6c27 2c20 666f 6e74  rue label', font
+0006f1d0: 7369 7a65 203d 2031 3329 0d0a 2020 2020  size = 13)..    
+0006f1e0: 6178 2e73 6574 5f78 6c61 6265 6c28 2750  ax.set_xlabel('P
+0006f1f0: 7265 6469 6374 6564 206c 6162 656c 272c  redicted label',
+0006f200: 2066 6f6e 7473 697a 6520 3d20 3133 290d   fontsize = 13).
+0006f210: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
 0006f220: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006f230: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006f240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0006f250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006f260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0006f270: 2323 2323 2323 0d0a 6672 6f6d 2073 6b6c  ######..from skl
-0006f280: 6561 726e 2e6d 6574 7269 6373 2069 6d70  earn.metrics imp
-0006f290: 6f72 7420 636c 6173 7369 6669 6361 7469  ort classificati
-0006f2a0: 6f6e 5f72 6570 6f72 742c 2072 6f63 5f63  on_report, roc_c
-0006f2b0: 7572 7665 0d0a 696d 706f 7274 206d 6174  urve..import mat
-0006f2c0: 706c 6f74 6c69 622e 7079 706c 6f74 2061  plotlib.pyplot a
-0006f2d0: 7320 706c 740d 0a69 6d70 6f72 7420 7365  s plt..import se
-0006f2e0: 6162 6f72 6e20 6173 2073 6e73 0d0a 0d0a  aborn as sns....
-0006f2f0: 6672 6f6d 2073 6b6c 6561 726e 2e6d 6574  from sklearn.met
-0006f300: 7269 6373 2069 6d70 6f72 7420 726f 635f  rics import roc_
-0006f310: 6375 7276 652c 2070 7265 6369 7369 6f6e  curve, precision
-0006f320: 5f72 6563 616c 6c5f 6375 7276 650d 0a0d  _recall_curve...
-0006f330: 0a64 6566 2070 6c6f 745f 7072 6563 6973  .def plot_precis
-0006f340: 696f 6e5f 7265 6361 6c6c 5f63 7572 7665  ion_recall_curve
-0006f350: 286d 2c20 785f 7465 7374 632c 2079 5f74  (m, x_testc, y_t
-0006f360: 6573 742c 2061 783d 4e6f 6e65 293a 0d0a  est, ax=None):..
-0006f370: 2020 2020 2323 2323 2054 6869 7320 6973      #### This is
-0006f380: 2061 2073 696d 706c 6520 7761 7920 746f   a simple way to
-0006f390: 2070 6c6f 7420 5052 2063 7572 7665 2066   plot PR curve f
-0006f3a0: 6f72 2062 696e 6172 7920 636c 6173 7365  or binary classe
-0006f3b0: 7320 2323 2323 230d 0a20 2020 2079 5f73  s #####..    y_s
-0006f3c0: 636f 7265 7320 3d20 6d2e 7072 6564 6963  cores = m.predic
-0006f3d0: 745f 7072 6f62 6128 785f 7465 7374 6329  t_proba(x_testc)
-0006f3e0: 5b3a 2c31 5d0d 0a20 2020 2023 2323 2067  [:,1]..    ### g
-0006f3f0: 656e 6572 6174 6520 7468 6520 7072 6563  enerate the prec
-0006f400: 6973 696f 6e20 7265 6361 6c6c 2063 7572  ision recall cur
-0006f410: 7665 2023 2323 2323 2323 2323 230d 0a20  ve ##########.. 
-0006f420: 2020 2070 2c20 722c 2074 6872 6573 686f     p, r, thresho
-0006f430: 6c64 7320 3d20 7072 6563 6973 696f 6e5f  lds = precision_
-0006f440: 7265 6361 6c6c 5f63 7572 7665 2879 5f74  recall_curve(y_t
-0006f450: 6573 742c 2079 5f73 636f 7265 7329 0d0a  est, y_scores)..
-0006f460: 2020 2020 2323 2323 2070 6c6f 7420 7468      #### plot th
-0006f470: 6520 6375 7276 6520 2323 2323 2323 2323  e curve ########
-0006f480: 2323 0d0a 2020 2020 6178 2e73 6574 5f74  ##..    ax.set_t
-0006f490: 6974 6c65 2822 5072 6563 6973 696f 6e20  itle("Precision 
-0006f4a0: 5265 6361 6c6c 2043 7572 7665 2229 0d0a  Recall Curve")..
-0006f4b0: 2020 2020 6178 2e70 6c6f 7428 722c 2070      ax.plot(r, p
-0006f4c0: 2c20 636f 6c6f 723d 2270 7572 706c 6522  , color="purple"
-0006f4d0: 290d 0a20 2020 2061 782e 7365 745f 796c  )..    ax.set_yl
-0006f4e0: 696d 285b 302e 352c 2031 2e30 315d 290d  im([0.5, 1.01]).
-0006f4f0: 0a20 2020 2061 782e 7365 745f 786c 696d  .    ax.set_xlim
-0006f500: 285b 302e 352c 2031 2e30 315d 290d 0a20  ([0.5, 1.01]).. 
-0006f510: 2020 2061 782e 7365 745f 786c 6162 656c     ax.set_xlabel
-0006f520: 2827 5265 6361 6c6c 2729 0d0a 2020 2020  ('Recall')..    
-0006f530: 6178 2e73 6574 5f79 6c61 6265 6c28 2750  ax.set_ylabel('P
-0006f540: 7265 6369 7369 6f6e 2729 0d0a 0d0a 6465  recision')....de
-0006f550: 6620 706c 6f74 5f72 6f63 5f63 7572 7665  f plot_roc_curve
-0006f560: 286d 2c20 785f 7465 7374 632c 2079 5f74  (m, x_testc, y_t
-0006f570: 6573 742c 2061 783d 4e6f 6e65 293a 0d0a  est, ax=None):..
-0006f580: 2020 2020 2323 2323 2054 6869 7320 6973      #### This is
-0006f590: 2061 2073 696d 706c 6520 7761 7920 746f   a simple way to
-0006f5a0: 2070 6c6f 7420 524f 4320 6375 7276 6520   plot ROC curve 
-0006f5b0: 666f 7220 6269 6e61 7279 2063 6c61 7373  for binary class
-0006f5c0: 6573 2023 2323 2323 0d0a 2020 2020 795f  es #####..    y_
-0006f5d0: 7363 6f72 6573 203d 206d 2e70 7265 6469  scores = m.predi
-0006f5e0: 6374 5f70 726f 6261 2878 5f74 6573 7463  ct_proba(x_testc
-0006f5f0: 295b 3a2c 315d 0d0a 2020 2020 2323 2320  )[:,1]..    ### 
-0006f600: 6765 6e65 7261 7465 2074 6865 2070 7265  generate the pre
-0006f610: 6369 7369 6f6e 2072 6563 616c 6c20 6375  cision recall cu
-0006f620: 7276 6520 2323 2323 2323 2323 2323 0d0a  rve ##########..
-0006f630: 2020 2020 6670 722c 2074 7072 2c20 5f20      fpr, tpr, _ 
-0006f640: 3d20 726f 635f 6375 7276 6528 795f 7465  = roc_curve(y_te
-0006f650: 7374 2c20 2079 5f73 636f 7265 7329 0d0a  st,  y_scores)..
-0006f660: 2020 2020 2323 2323 2070 6c6f 7420 7468      #### plot th
-0006f670: 6520 6375 7276 6520 2323 2323 2323 2323  e curve ########
-0006f680: 2323 0d0a 2020 2020 6178 2e73 6574 5f74  ##..    ax.set_t
-0006f690: 6974 6c65 2822 524f 4320 4155 4320 4375  itle("ROC AUC Cu
-0006f6a0: 7276 6522 290d 0a20 2020 2061 782e 706c  rve")..    ax.pl
-0006f6b0: 6f74 2866 7072 2c74 7072 2c20 636f 6c6f  ot(fpr,tpr, colo
-0006f6c0: 723d 2270 7572 706c 6522 290d 0a20 2020  r="purple")..   
-0006f6d0: 2061 782e 7365 745f 796c 696d 285b 302e   ax.set_ylim([0.
-0006f6e0: 302c 2031 2e30 315d 290d 0a20 2020 2061  0, 1.01])..    a
-0006f6f0: 782e 7365 745f 786c 696d 285b 302e 302c  x.set_xlim([0.0,
-0006f700: 2031 2e30 315d 290d 0a20 2020 2061 782e   1.01])..    ax.
-0006f710: 7365 745f 786c 6162 656c 2827 4661 6c73  set_xlabel('Fals
-0006f720: 6520 506f 7369 7469 7665 2052 6174 6527  e Positive Rate'
-0006f730: 290d 0a20 2020 2061 782e 7365 745f 796c  )..    ax.set_yl
-0006f740: 6162 656c 2827 5472 7565 2050 6f73 6974  abel('True Posit
-0006f750: 6976 6520 5261 7465 2729 0d0a 0d0a 0d0a  ive Rate')......
-0006f760: 6465 6620 706c 6f74 5f63 6c61 7373 6966  def plot_classif
-0006f770: 6963 6174 696f 6e5f 7265 7375 6c74 7328  ication_results(
-0006f780: 6d2c 2058 5f74 7275 652c 2079 5f74 7275  m, X_true, y_tru
-0006f790: 652c 2079 5f70 7265 642c 206c 6162 656c  e, y_pred, label
-0006f7a0: 732c 2074 6172 6765 745f 6e61 6d65 732c  s, target_names,
-0006f7b0: 2065 6163 685f 7461 7267 6574 293a 0d0a   each_target):..
-0006f7c0: 2020 2020 2323 2323 2054 6865 7365 2070      #### These p
-0006f7d0: 6c6f 7473 2061 7265 206f 6e6c 7920 666f  lots are only fo
-0006f7e0: 7220 6269 6e61 7279 2063 6c61 7373 6573  r binary classes
-0006f7f0: 2023 2323 2323 2323 2323 2323 2323 0d0a   #############..
-0006f800: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-0006f810: 2020 6669 672c 2061 7865 7320 3d20 706c    fig, axes = pl
-0006f820: 742e 7375 6270 6c6f 7473 2832 2c32 2c66  t.subplots(2,2,f
-0006f830: 6967 7369 7a65 3d28 3135 2c31 3529 290d  igsize=(15,15)).
-0006f840: 0a20 2020 2020 2020 2070 6c6f 745f 726f  .        plot_ro
-0006f850: 635f 6375 7276 6528 6d2c 2058 5f74 7275  c_curve(m, X_tru
-0006f860: 652c 2079 5f74 7275 652c 2061 783d 6178  e, y_true, ax=ax
-0006f870: 6573 5b30 2c31 5d29 0d0a 2020 2020 2020  es[0,1])..      
-0006f880: 2020 6178 6573 5b30 2c31 5d2e 7365 745f    axes[0,1].set_
-0006f890: 7469 746c 6528 2752 4f43 2041 5543 2043  title('ROC AUC C
-0006f8a0: 7572 7665 3a20 2573 2720 2565 6163 685f  urve: %s' %each_
-0006f8b0: 7461 7267 6574 290d 0a20 2020 2020 2020  target)..       
-0006f8c0: 2070 6c6f 745f 7072 6563 6973 696f 6e5f   plot_precision_
-0006f8d0: 7265 6361 6c6c 5f63 7572 7665 286d 2c20  recall_curve(m, 
-0006f8e0: 585f 7472 7565 2c20 795f 7472 7565 2c20  X_true, y_true, 
-0006f8f0: 6178 3d61 7865 735b 312c 305d 290d 0a20  ax=axes[1,0]).. 
-0006f900: 2020 2020 2020 2061 7865 735b 312c 305d         axes[1,0]
-0006f910: 2e73 6574 5f74 6974 6c65 2827 5052 2041  .set_title('PR A
-0006f920: 5543 2043 7572 7665 2066 6f72 3a20 2573  UC Curve for: %s
-0006f930: 2720 2565 6163 685f 7461 7267 6574 290d  ' %each_target).
-0006f940: 0a20 2020 2020 2020 2079 5f70 7265 6420  .        y_pred 
-0006f950: 3d20 6d2e 7072 6564 6963 7428 585f 7472  = m.predict(X_tr
-0006f960: 7565 290d 0a20 2020 2020 2020 2064 7261  ue)..        dra
-0006f970: 775f 636f 6e66 7573 696f 6e5f 6d61 7874  w_confusion_maxt
-0006f980: 7269 7828 795f 7472 7565 2c20 795f 7072  rix(y_true, y_pr
-0006f990: 6564 2c20 2743 6f6e 6675 7369 6f6e 204d  ed, 'Confusion M
-0006f9a0: 6174 7269 7827 2c20 6178 3d61 7865 735b  atrix', ax=axes[
-0006f9b0: 302c 305d 290d 0a20 2020 2020 2020 2074  0,0])..        t
-0006f9c0: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
-0006f9d0: 2063 6c66 5f72 6570 6f72 7420 3d20 636c   clf_report = cl
-0006f9e0: 6173 7369 6669 6361 7469 6f6e 5f72 6570  assification_rep
-0006f9f0: 6f72 7428 795f 7472 7565 2c0d 0a20 2020  ort(y_true,..   
+0006f260: 2323 2323 2323 230d 0a66 726f 6d20 736b  #######..from sk
+0006f270: 6c65 6172 6e2e 6d65 7472 6963 7320 696d  learn.metrics im
+0006f280: 706f 7274 2063 6c61 7373 6966 6963 6174  port classificat
+0006f290: 696f 6e5f 7265 706f 7274 2c20 726f 635f  ion_report, roc_
+0006f2a0: 6375 7276 650d 0a69 6d70 6f72 7420 6d61  curve..import ma
+0006f2b0: 7470 6c6f 746c 6962 2e70 7970 6c6f 7420  tplotlib.pyplot 
+0006f2c0: 6173 2070 6c74 0d0a 696d 706f 7274 2073  as plt..import s
+0006f2d0: 6561 626f 726e 2061 7320 736e 730d 0a0d  eaborn as sns...
+0006f2e0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
+0006f2f0: 7472 6963 7320 696d 706f 7274 2072 6f63  trics import roc
+0006f300: 5f63 7572 7665 2c20 7072 6563 6973 696f  _curve, precisio
+0006f310: 6e5f 7265 6361 6c6c 5f63 7572 7665 0d0a  n_recall_curve..
+0006f320: 0d0a 6465 6620 706c 6f74 5f70 7265 6369  ..def plot_preci
+0006f330: 7369 6f6e 5f72 6563 616c 6c5f 6375 7276  sion_recall_curv
+0006f340: 6528 6d2c 2078 5f74 6573 7463 2c20 795f  e(m, x_testc, y_
+0006f350: 7465 7374 2c20 6178 3d4e 6f6e 6529 3a0d  test, ax=None):.
+0006f360: 0a20 2020 2023 2323 2320 5468 6973 2069  .    #### This i
+0006f370: 7320 6120 7369 6d70 6c65 2077 6179 2074  s a simple way t
+0006f380: 6f20 706c 6f74 2050 5220 6375 7276 6520  o plot PR curve 
+0006f390: 666f 7220 6269 6e61 7279 2063 6c61 7373  for binary class
+0006f3a0: 6573 2023 2323 2323 0d0a 2020 2020 795f  es #####..    y_
+0006f3b0: 7363 6f72 6573 203d 206d 2e70 7265 6469  scores = m.predi
+0006f3c0: 6374 5f70 726f 6261 2878 5f74 6573 7463  ct_proba(x_testc
+0006f3d0: 295b 3a2c 315d 0d0a 2020 2020 2323 2320  )[:,1]..    ### 
+0006f3e0: 6765 6e65 7261 7465 2074 6865 2070 7265  generate the pre
+0006f3f0: 6369 7369 6f6e 2072 6563 616c 6c20 6375  cision recall cu
+0006f400: 7276 6520 2323 2323 2323 2323 2323 0d0a  rve ##########..
+0006f410: 2020 2020 702c 2072 2c20 7468 7265 7368      p, r, thresh
+0006f420: 6f6c 6473 203d 2070 7265 6369 7369 6f6e  olds = precision
+0006f430: 5f72 6563 616c 6c5f 6375 7276 6528 795f  _recall_curve(y_
+0006f440: 7465 7374 2c20 795f 7363 6f72 6573 290d  test, y_scores).
+0006f450: 0a20 2020 2023 2323 2320 706c 6f74 2074  .    #### plot t
+0006f460: 6865 2063 7572 7665 2023 2323 2323 2323  he curve #######
+0006f470: 2323 230d 0a20 2020 2061 782e 7365 745f  ###..    ax.set_
+0006f480: 7469 746c 6528 2250 7265 6369 7369 6f6e  title("Precision
+0006f490: 2052 6563 616c 6c20 4375 7276 6522 290d   Recall Curve").
+0006f4a0: 0a20 2020 2061 782e 706c 6f74 2872 2c20  .    ax.plot(r, 
+0006f4b0: 702c 2063 6f6c 6f72 3d22 7075 7270 6c65  p, color="purple
+0006f4c0: 2229 0d0a 2020 2020 6178 2e73 6574 5f79  ")..    ax.set_y
+0006f4d0: 6c69 6d28 5b30 2e35 2c20 312e 3031 5d29  lim([0.5, 1.01])
+0006f4e0: 0d0a 2020 2020 6178 2e73 6574 5f78 6c69  ..    ax.set_xli
+0006f4f0: 6d28 5b30 2e35 2c20 312e 3031 5d29 0d0a  m([0.5, 1.01])..
+0006f500: 2020 2020 6178 2e73 6574 5f78 6c61 6265      ax.set_xlabe
+0006f510: 6c28 2752 6563 616c 6c27 290d 0a20 2020  l('Recall')..   
+0006f520: 2061 782e 7365 745f 796c 6162 656c 2827   ax.set_ylabel('
+0006f530: 5072 6563 6973 696f 6e27 290d 0a0d 0a64  Precision')....d
+0006f540: 6566 2070 6c6f 745f 726f 635f 6375 7276  ef plot_roc_curv
+0006f550: 6528 6d2c 2078 5f74 6573 7463 2c20 795f  e(m, x_testc, y_
+0006f560: 7465 7374 2c20 6178 3d4e 6f6e 6529 3a0d  test, ax=None):.
+0006f570: 0a20 2020 2023 2323 2320 5468 6973 2069  .    #### This i
+0006f580: 7320 6120 7369 6d70 6c65 2077 6179 2074  s a simple way t
+0006f590: 6f20 706c 6f74 2052 4f43 2063 7572 7665  o plot ROC curve
+0006f5a0: 2066 6f72 2062 696e 6172 7920 636c 6173   for binary clas
+0006f5b0: 7365 7320 2323 2323 230d 0a20 2020 2079  ses #####..    y
+0006f5c0: 5f73 636f 7265 7320 3d20 6d2e 7072 6564  _scores = m.pred
+0006f5d0: 6963 745f 7072 6f62 6128 785f 7465 7374  ict_proba(x_test
+0006f5e0: 6329 5b3a 2c31 5d0d 0a20 2020 2023 2323  c)[:,1]..    ###
+0006f5f0: 2067 656e 6572 6174 6520 7468 6520 7072   generate the pr
+0006f600: 6563 6973 696f 6e20 7265 6361 6c6c 2063  ecision recall c
+0006f610: 7572 7665 2023 2323 2323 2323 2323 230d  urve ##########.
+0006f620: 0a20 2020 2066 7072 2c20 7470 722c 205f  .    fpr, tpr, _
+0006f630: 203d 2072 6f63 5f63 7572 7665 2879 5f74   = roc_curve(y_t
+0006f640: 6573 742c 2020 795f 7363 6f72 6573 290d  est,  y_scores).
+0006f650: 0a20 2020 2023 2323 2320 706c 6f74 2074  .    #### plot t
+0006f660: 6865 2063 7572 7665 2023 2323 2323 2323  he curve #######
+0006f670: 2323 230d 0a20 2020 2061 782e 7365 745f  ###..    ax.set_
+0006f680: 7469 746c 6528 2252 4f43 2041 5543 2043  title("ROC AUC C
+0006f690: 7572 7665 2229 0d0a 2020 2020 6178 2e70  urve")..    ax.p
+0006f6a0: 6c6f 7428 6670 722c 7470 722c 2063 6f6c  lot(fpr,tpr, col
+0006f6b0: 6f72 3d22 7075 7270 6c65 2229 0d0a 2020  or="purple")..  
+0006f6c0: 2020 6178 2e73 6574 5f79 6c69 6d28 5b30    ax.set_ylim([0
+0006f6d0: 2e30 2c20 312e 3031 5d29 0d0a 2020 2020  .0, 1.01])..    
+0006f6e0: 6178 2e73 6574 5f78 6c69 6d28 5b30 2e30  ax.set_xlim([0.0
+0006f6f0: 2c20 312e 3031 5d29 0d0a 2020 2020 6178  , 1.01])..    ax
+0006f700: 2e73 6574 5f78 6c61 6265 6c28 2746 616c  .set_xlabel('Fal
+0006f710: 7365 2050 6f73 6974 6976 6520 5261 7465  se Positive Rate
+0006f720: 2729 0d0a 2020 2020 6178 2e73 6574 5f79  ')..    ax.set_y
+0006f730: 6c61 6265 6c28 2754 7275 6520 506f 7369  label('True Posi
+0006f740: 7469 7665 2052 6174 6527 290d 0a0d 0a0d  tive Rate').....
+0006f750: 0a64 6566 2070 6c6f 745f 636c 6173 7369  .def plot_classi
+0006f760: 6669 6361 7469 6f6e 5f72 6573 756c 7473  fication_results
+0006f770: 286d 2c20 585f 7472 7565 2c20 795f 7472  (m, X_true, y_tr
+0006f780: 7565 2c20 795f 7072 6564 2c20 6c61 6265  ue, y_pred, labe
+0006f790: 6c73 2c20 7461 7267 6574 5f6e 616d 6573  ls, target_names
+0006f7a0: 2c20 6561 6368 5f74 6172 6765 7429 3a0d  , each_target):.
+0006f7b0: 0a20 2020 2023 2323 2320 5468 6573 6520  .    #### These 
+0006f7c0: 706c 6f74 7320 6172 6520 6f6e 6c79 2066  plots are only f
+0006f7d0: 6f72 2062 696e 6172 7920 636c 6173 7365  or binary classe
+0006f7e0: 7320 2323 2323 2323 2323 2323 2323 230d  s #############.
+0006f7f0: 0a20 2020 2074 7279 3a0d 0a20 2020 2020  .    try:..     
+0006f800: 2020 2066 6967 2c20 6178 6573 203d 2070     fig, axes = p
+0006f810: 6c74 2e73 7562 706c 6f74 7328 322c 322c  lt.subplots(2,2,
+0006f820: 6669 6773 697a 653d 2831 352c 3135 2929  figsize=(15,15))
+0006f830: 0d0a 2020 2020 2020 2020 706c 6f74 5f72  ..        plot_r
+0006f840: 6f63 5f63 7572 7665 286d 2c20 585f 7472  oc_curve(m, X_tr
+0006f850: 7565 2c20 795f 7472 7565 2c20 6178 3d61  ue, y_true, ax=a
+0006f860: 7865 735b 302c 315d 290d 0a20 2020 2020  xes[0,1])..     
+0006f870: 2020 2061 7865 735b 302c 315d 2e73 6574     axes[0,1].set
+0006f880: 5f74 6974 6c65 2827 524f 4320 4155 4320  _title('ROC AUC 
+0006f890: 4375 7276 653a 2025 7327 2025 6561 6368  Curve: %s' %each
+0006f8a0: 5f74 6172 6765 7429 0d0a 2020 2020 2020  _target)..      
+0006f8b0: 2020 706c 6f74 5f70 7265 6369 7369 6f6e    plot_precision
+0006f8c0: 5f72 6563 616c 6c5f 6375 7276 6528 6d2c  _recall_curve(m,
+0006f8d0: 2058 5f74 7275 652c 2079 5f74 7275 652c   X_true, y_true,
+0006f8e0: 2061 783d 6178 6573 5b31 2c30 5d29 0d0a   ax=axes[1,0])..
+0006f8f0: 2020 2020 2020 2020 6178 6573 5b31 2c30          axes[1,0
+0006f900: 5d2e 7365 745f 7469 746c 6528 2750 5220  ].set_title('PR 
+0006f910: 4155 4320 4375 7276 6520 666f 723a 2025  AUC Curve for: %
+0006f920: 7327 2025 6561 6368 5f74 6172 6765 7429  s' %each_target)
+0006f930: 0d0a 2020 2020 2020 2020 795f 7072 6564  ..        y_pred
+0006f940: 203d 206d 2e70 7265 6469 6374 2858 5f74   = m.predict(X_t
+0006f950: 7275 6529 0d0a 2020 2020 2020 2020 6472  rue)..        dr
+0006f960: 6177 5f63 6f6e 6675 7369 6f6e 5f6d 6178  aw_confusion_max
+0006f970: 7472 6978 2879 5f74 7275 652c 2079 5f70  trix(y_true, y_p
+0006f980: 7265 642c 2027 436f 6e66 7573 696f 6e20  red, 'Confusion 
+0006f990: 4d61 7472 6978 272c 2061 783d 6178 6573  Matrix', ax=axes
+0006f9a0: 5b30 2c30 5d29 0d0a 2020 2020 2020 2020  [0,0])..        
+0006f9b0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+0006f9c0: 2020 636c 665f 7265 706f 7274 203d 2063    clf_report = c
+0006f9d0: 6c61 7373 6966 6963 6174 696f 6e5f 7265  lassification_re
+0006f9e0: 706f 7274 2879 5f74 7275 652c 0d0a 2020  port(y_true,..  
+0006f9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0006fa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006fa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006fa20: 2020 2020 2020 2020 2020 2020 795f 7072              y_pr
-0006fa30: 6564 2c0d 0a20 2020 2020 2020 2020 2020  ed,..           
+0006fa10: 2020 2020 2020 2020 2020 2020 2079 5f70               y_p
+0006fa20: 7265 642c 0d0a 2020 2020 2020 2020 2020  red,..          
+0006fa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0006fa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006fa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006fa60: 2020 2020 6c61 6265 6c73 3d6c 6162 656c      labels=label
-0006fa70: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
+0006fa50: 2020 2020 206c 6162 656c 733d 6c61 6265       labels=labe
+0006fa60: 6c73 2c0d 0a20 2020 2020 2020 2020 2020  ls,..           
+0006fa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0006fa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006fa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006faa0: 2020 2074 6172 6765 745f 6e61 6d65 733d     target_names=
-0006fab0: 7461 7267 6574 5f6e 616d 6573 2c0d 0a20  target_names,.. 
+0006fa90: 2020 2020 7461 7267 6574 5f6e 616d 6573      target_names
+0006faa0: 3d74 6172 6765 745f 6e61 6d65 732c 0d0a  =target_names,..
+0006fab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0006fac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006fad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0006fae0: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
-0006faf0: 7470 7574 5f64 6963 743d 5472 7565 290d  tput_dict=True).
-0006fb00: 0a20 2020 2020 2020 2065 7863 6570 743a  .        except:
-0006fb10: 0d0a 2020 2020 2020 2020 2020 2020 636c  ..            cl
-0006fb20: 665f 7265 706f 7274 203d 2063 6c61 7373  f_report = class
-0006fb30: 6966 6963 6174 696f 6e5f 7265 706f 7274  ification_report
-0006fb40: 2879 5f74 7275 652c 795f 7072 6564 2c6c  (y_true,y_pred,l
-0006fb50: 6162 656c 733d 7461 7267 6574 5f6e 616d  abels=target_nam
-0006fb60: 6573 2c0d 0a20 2020 2020 2020 2020 2020  es,..           
-0006fb70: 2020 2020 2074 6172 6765 745f 6e61 6d65       target_name
-0006fb80: 733d 6c61 6265 6c73 2c6f 7574 7075 745f  s=labels,output_
-0006fb90: 6469 6374 3d54 7275 6529 0d0a 2020 2020  dict=True)..    
-0006fba0: 2020 2020 736e 732e 6865 6174 6d61 7028      sns.heatmap(
-0006fbb0: 7064 2e44 6174 6146 7261 6d65 2863 6c66  pd.DataFrame(clf
-0006fbc0: 5f72 6570 6f72 7429 2e69 6c6f 635b 3a2c  _report).iloc[:,
-0006fbd0: 203a 5d2e 542c 2061 6e6e 6f74 3d54 7275   :].T, annot=Tru
-0006fbe0: 652c 6178 3d61 7865 735b 312c 315d 2c66  e,ax=axes[1,1],f
-0006fbf0: 6d74 3d27 302e 3266 2729 3b0d 0a20 2020  mt='0.2f');..   
-0006fc00: 2020 2020 2061 7865 735b 312c 315d 2e73       axes[1,1].s
-0006fc10: 6574 5f74 6974 6c65 2827 436c 6173 7369  et_title('Classi
-0006fc20: 6669 6361 7469 6f6e 2052 6570 6f72 743a  fication Report:
-0006fc30: 2025 7327 2025 6561 6368 5f74 6172 6765   %s' %each_targe
-0006fc40: 7429 0d0a 2020 2020 6578 6365 7074 3a0d  t)..    except:.
-0006fc50: 0a20 2020 2020 2020 2070 7269 6e74 2827  .        print('
-0006fc60: 4572 726f 723a 2063 6f75 6c64 206e 6f74  Error: could not
-0006fc70: 2070 6c6f 7420 636c 6173 7369 6669 6361   plot classifica
-0006fc80: 7469 6f6e 2072 6573 756c 7473 2e20 436f  tion results. Co
-0006fc90: 6e74 696e 7569 6e67 2e2e 2e27 290d 0a0d  ntinuing...')...
-0006fca0: 0a66 726f 6d20 736b 6c65 6172 6e2e 6d65  .from sklearn.me
-0006fcb0: 7472 6963 7320 696d 706f 7274 2063 6c61  trics import cla
-0006fcc0: 7373 6966 6963 6174 696f 6e5f 7265 706f  ssification_repo
-0006fcd0: 7274 2c20 636f 6e66 7573 696f 6e5f 6d61  rt, confusion_ma
-0006fce0: 7472 6978 0d0a 6672 6f6d 2073 6b6c 6561  trix..from sklea
-0006fcf0: 726e 2e6d 6574 7269 6373 2069 6d70 6f72  rn.metrics impor
-0006fd00: 7420 6261 6c61 6e63 6564 5f61 6363 7572  t balanced_accur
-0006fd10: 6163 795f 7363 6f72 650d 0a64 6566 2070  acy_score..def p
-0006fd20: 7269 6e74 5f63 6c61 7373 6966 6963 6174  rint_classificat
-0006fd30: 696f 6e5f 6d6f 6465 6c5f 7374 6174 7328  ion_model_stats(
-0006fd40: 795f 7472 7565 2c20 7072 6564 6963 7465  y_true, predicte
-0006fd50: 642c 206d 5f74 6872 6573 683d 302e 3529  d, m_thresh=0.5)
-0006fd60: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
-0006fd70: 5468 6973 2070 7269 6e74 7320 636c 6173  This prints clas
-0006fd80: 7369 6669 6361 7469 6f6e 206d 6574 7269  sification metri
-0006fd90: 6373 2069 6e20 6120 6e69 6365 2066 6f72  cs in a nice for
-0006fda0: 6d61 7420 6f6e 6c79 2066 6f72 2062 696e  mat only for bin
-0006fdb0: 6172 7920 636c 6173 7365 730d 0a20 2020  ary classes..   
-0006fdc0: 2022 2222 0d0a 2020 2020 2320 5573 6520   """..    # Use 
-0006fdd0: 7468 6973 2074 6f20 5465 7374 2043 6c61  this to Test Cla
-0006fde0: 7373 6966 6963 6174 696f 6e20 5072 6f62  ssification Prob
-0006fdf0: 6c65 6d73 204f 6e6c 7920 2323 2323 0d0a  lems Only ####..
-0006fe00: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-0006fe10: 2020 7261 7265 5f63 6c61 7373 203d 2066    rare_class = f
-0006fe20: 696e 645f 7261 7265 5f63 6c61 7373 2879  ind_rare_class(y
-0006fe30: 5f74 7275 6529 0d0a 2020 2020 2020 2020  _true)..        
-0006fe40: 7265 675f 6163 6320 3d20 5b30 2c30 5d0d  reg_acc = [0,0].
-0006fe50: 0a20 2020 2020 2020 2066 6f72 2069 2c74  .        for i,t
-0006fe60: 6872 6573 686f 6c64 2069 6e20 7a69 7028  hreshold in zip(
-0006fe70: 7261 6e67 6528 3229 2c20 5b30 2e35 2c20  range(2), [0.5, 
-0006fe80: 6d5f 7468 7265 7368 5d29 3a0d 0a20 2020  m_thresh]):..   
-0006fe90: 2020 2020 2020 2020 2069 6620 7468 7265           if thre
-0006fea0: 7368 6f6c 6420 213d 2030 2e35 3a0d 0a20  shold != 0.5:.. 
-0006feb0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0006fec0: 7265 6469 6374 6564 205b 3a2c 305d 203d  redicted [:,0] =
-0006fed0: 2028 7072 6564 6963 7465 6420 5b3a 2c30   (predicted [:,0
-0006fee0: 5d20 3e3d 2028 312d 7468 7265 7368 6f6c  ] >= (1-threshol
-0006fef0: 6429 292e 6173 7479 7065 2827 696e 7427  d)).astype('int'
-0006ff00: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0006ff10: 2020 2070 7265 6469 6374 6564 205b 3a2c     predicted [:,
-0006ff20: 315d 203d 2028 7072 6564 6963 7465 6420  1] = (predicted 
-0006ff30: 5b3a 2c31 5d20 3e3d 2074 6872 6573 686f  [:,1] >= thresho
-0006ff40: 6c64 292e 6173 7479 7065 2827 696e 7427  ld).astype('int'
-0006ff50: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-0006ff60: 2020 2079 5f70 7265 6420 3d20 7072 6564     y_pred = pred
-0006ff70: 6963 7465 645b 3a2c 7261 7265 5f63 6c61  icted[:,rare_cla
-0006ff80: 7373 5d0d 0a20 2020 2020 2020 2020 2020  ss]..           
-0006ff90: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-0006ffa0: 2020 2020 2020 2020 795f 7072 6564 203d          y_pred =
-0006ffb0: 2070 7265 6469 6374 6564 2e61 7267 6d61   predicted.argma
-0006ffc0: 7828 6178 6973 3d31 290d 0a20 2020 2020  x(axis=1)..     
-0006ffd0: 2020 2020 2020 2070 7269 6e74 2827 4261         print('Ba
-0006ffe0: 6c61 6e63 6564 2041 6363 7572 6163 7920  lanced Accuracy 
-0006fff0: 3d20 2530 2e32 6625 2520 7769 7468 2054  = %0.2f%% with T
-00070000: 6872 6573 686f 6c64 203d 2025 302e 3266  hreshold = %0.2f
-00070010: 2720 2528 0d0a 2020 2020 2020 2020 2020  ' %(..          
-00070020: 2020 2020 2020 3130 302a 6261 6c61 6e63        100*balanc
-00070030: 6564 5f61 6363 7572 6163 795f 7363 6f72  ed_accuracy_scor
-00070040: 6528 795f 7472 7565 2c20 795f 7072 6564  e(y_true, y_pred
-00070050: 292c 7468 7265 7368 6f6c 6429 290d 0a20  ),threshold)).. 
-00070060: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00070070: 2827 436f 6e66 7573 696f 6e20 4d61 7472  ('Confusion Matr
-00070080: 6978 3a27 290d 0a20 2020 2020 2020 2020  ix:')..         
-00070090: 2020 2070 7269 6e74 2863 6f6e 6675 7369     print(confusi
-000700a0: 6f6e 5f6d 6174 7269 7828 795f 7472 7565  on_matrix(y_true
-000700b0: 2c20 795f 7072 6564 2929 0d0a 2020 2020  , y_pred))..    
-000700c0: 2020 2020 2020 2020 7072 696e 7428 636c          print(cl
-000700d0: 6173 7369 6669 6361 7469 6f6e 5f72 6570  assification_rep
-000700e0: 6f72 7428 795f 7472 7565 2c20 795f 7072  ort(y_true, y_pr
-000700f0: 6564 2929 0d0a 2020 2020 2020 2020 2020  ed))..          
-00070100: 2020 7265 675f 6163 635b 695d 203d 2062    reg_acc[i] = b
-00070110: 616c 616e 6365 645f 6163 6375 7261 6379  alanced_accuracy
-00070120: 5f73 636f 7265 2879 5f74 7275 652c 2079  _score(y_true, y
-00070130: 5f70 7265 6429 0d0a 2020 2020 2020 2020  _pred)..        
-00070140: 7072 696e 7428 2723 2323 2323 2323 2323  print('#########
+0006fad0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0006fae0: 7574 7075 745f 6469 6374 3d54 7275 6529  utput_dict=True)
+0006faf0: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
+0006fb00: 3a0d 0a20 2020 2020 2020 2020 2020 2063  :..            c
+0006fb10: 6c66 5f72 6570 6f72 7420 3d20 636c 6173  lf_report = clas
+0006fb20: 7369 6669 6361 7469 6f6e 5f72 6570 6f72  sification_repor
+0006fb30: 7428 795f 7472 7565 2c79 5f70 7265 642c  t(y_true,y_pred,
+0006fb40: 6c61 6265 6c73 3d74 6172 6765 745f 6e61  labels=target_na
+0006fb50: 6d65 732c 0d0a 2020 2020 2020 2020 2020  mes,..          
+0006fb60: 2020 2020 2020 7461 7267 6574 5f6e 616d        target_nam
+0006fb70: 6573 3d6c 6162 656c 732c 6f75 7470 7574  es=labels,output
+0006fb80: 5f64 6963 743d 5472 7565 290d 0a20 2020  _dict=True)..   
+0006fb90: 2020 2020 2073 6e73 2e68 6561 746d 6170       sns.heatmap
+0006fba0: 2870 642e 4461 7461 4672 616d 6528 636c  (pd.DataFrame(cl
+0006fbb0: 665f 7265 706f 7274 292e 696c 6f63 5b3a  f_report).iloc[:
+0006fbc0: 2c20 3a5d 2e54 2c20 616e 6e6f 743d 5472  , :].T, annot=Tr
+0006fbd0: 7565 2c61 783d 6178 6573 5b31 2c31 5d2c  ue,ax=axes[1,1],
+0006fbe0: 666d 743d 2730 2e32 6627 293b 0d0a 2020  fmt='0.2f');..  
+0006fbf0: 2020 2020 2020 6178 6573 5b31 2c31 5d2e        axes[1,1].
+0006fc00: 7365 745f 7469 746c 6528 2743 6c61 7373  set_title('Class
+0006fc10: 6966 6963 6174 696f 6e20 5265 706f 7274  ification Report
+0006fc20: 3a20 2573 2720 2565 6163 685f 7461 7267  : %s' %each_targ
+0006fc30: 6574 290d 0a20 2020 2065 7863 6570 743a  et)..    except:
+0006fc40: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+0006fc50: 2745 7272 6f72 3a20 636f 756c 6420 6e6f  'Error: could no
+0006fc60: 7420 706c 6f74 2063 6c61 7373 6966 6963  t plot classific
+0006fc70: 6174 696f 6e20 7265 7375 6c74 732e 2043  ation results. C
+0006fc80: 6f6e 7469 6e75 696e 672e 2e2e 2729 0d0a  ontinuing...')..
+0006fc90: 0d0a 6672 6f6d 2073 6b6c 6561 726e 2e6d  ..from sklearn.m
+0006fca0: 6574 7269 6373 2069 6d70 6f72 7420 636c  etrics import cl
+0006fcb0: 6173 7369 6669 6361 7469 6f6e 5f72 6570  assification_rep
+0006fcc0: 6f72 742c 2063 6f6e 6675 7369 6f6e 5f6d  ort, confusion_m
+0006fcd0: 6174 7269 780d 0a66 726f 6d20 736b 6c65  atrix..from skle
+0006fce0: 6172 6e2e 6d65 7472 6963 7320 696d 706f  arn.metrics impo
+0006fcf0: 7274 2062 616c 616e 6365 645f 6163 6375  rt balanced_accu
+0006fd00: 7261 6379 5f73 636f 7265 0d0a 6465 6620  racy_score..def 
+0006fd10: 7072 696e 745f 636c 6173 7369 6669 6361  print_classifica
+0006fd20: 7469 6f6e 5f6d 6f64 656c 5f73 7461 7473  tion_model_stats
+0006fd30: 2879 5f74 7275 652c 2070 7265 6469 6374  (y_true, predict
+0006fd40: 6564 2c20 6d5f 7468 7265 7368 3d30 2e35  ed, m_thresh=0.5
+0006fd50: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
+0006fd60: 2054 6869 7320 7072 696e 7473 2063 6c61   This prints cla
+0006fd70: 7373 6966 6963 6174 696f 6e20 6d65 7472  ssification metr
+0006fd80: 6963 7320 696e 2061 206e 6963 6520 666f  ics in a nice fo
+0006fd90: 726d 6174 206f 6e6c 7920 666f 7220 6269  rmat only for bi
+0006fda0: 6e61 7279 2063 6c61 7373 6573 0d0a 2020  nary classes..  
+0006fdb0: 2020 2222 220d 0a20 2020 2023 2055 7365    """..    # Use
+0006fdc0: 2074 6869 7320 746f 2054 6573 7420 436c   this to Test Cl
+0006fdd0: 6173 7369 6669 6361 7469 6f6e 2050 726f  assification Pro
+0006fde0: 626c 656d 7320 4f6e 6c79 2023 2323 230d  blems Only ####.
+0006fdf0: 0a20 2020 2074 7279 3a0d 0a20 2020 2020  .    try:..     
+0006fe00: 2020 2072 6172 655f 636c 6173 7320 3d20     rare_class = 
+0006fe10: 6669 6e64 5f72 6172 655f 636c 6173 7328  find_rare_class(
+0006fe20: 795f 7472 7565 290d 0a20 2020 2020 2020  y_true)..       
+0006fe30: 2072 6567 5f61 6363 203d 205b 302c 305d   reg_acc = [0,0]
+0006fe40: 0d0a 2020 2020 2020 2020 666f 7220 692c  ..        for i,
+0006fe50: 7468 7265 7368 6f6c 6420 696e 207a 6970  threshold in zip
+0006fe60: 2872 616e 6765 2832 292c 205b 302e 352c  (range(2), [0.5,
+0006fe70: 206d 5f74 6872 6573 685d 293a 0d0a 2020   m_thresh]):..  
+0006fe80: 2020 2020 2020 2020 2020 6966 2074 6872            if thr
+0006fe90: 6573 686f 6c64 2021 3d20 302e 353a 0d0a  eshold != 0.5:..
+0006fea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0006feb0: 7072 6564 6963 7465 6420 5b3a 2c30 5d20  predicted [:,0] 
+0006fec0: 3d20 2870 7265 6469 6374 6564 205b 3a2c  = (predicted [:,
+0006fed0: 305d 203e 3d20 2831 2d74 6872 6573 686f  0] >= (1-thresho
+0006fee0: 6c64 2929 2e61 7374 7970 6528 2769 6e74  ld)).astype('int
+0006fef0: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+0006ff00: 2020 2020 7072 6564 6963 7465 6420 5b3a      predicted [:
+0006ff10: 2c31 5d20 3d20 2870 7265 6469 6374 6564  ,1] = (predicted
+0006ff20: 205b 3a2c 315d 203e 3d20 7468 7265 7368   [:,1] >= thresh
+0006ff30: 6f6c 6429 2e61 7374 7970 6528 2769 6e74  old).astype('int
+0006ff40: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
+0006ff50: 2020 2020 795f 7072 6564 203d 2070 7265      y_pred = pre
+0006ff60: 6469 6374 6564 5b3a 2c72 6172 655f 636c  dicted[:,rare_cl
+0006ff70: 6173 735d 0d0a 2020 2020 2020 2020 2020  ass]..          
+0006ff80: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0006ff90: 2020 2020 2020 2020 2079 5f70 7265 6420           y_pred 
+0006ffa0: 3d20 7072 6564 6963 7465 642e 6172 676d  = predicted.argm
+0006ffb0: 6178 2861 7869 733d 3129 0d0a 2020 2020  ax(axis=1)..    
+0006ffc0: 2020 2020 2020 2020 7072 696e 7428 2742          print('B
+0006ffd0: 616c 616e 6365 6420 4163 6375 7261 6379  alanced Accuracy
+0006ffe0: 203d 2025 302e 3266 2525 2077 6974 6820   = %0.2f%% with 
+0006fff0: 5468 7265 7368 6f6c 6420 3d20 2530 2e32  Threshold = %0.2
+00070000: 6627 2025 280d 0a20 2020 2020 2020 2020  f' %(..         
+00070010: 2020 2020 2020 2031 3030 2a62 616c 616e         100*balan
+00070020: 6365 645f 6163 6375 7261 6379 5f73 636f  ced_accuracy_sco
+00070030: 7265 2879 5f74 7275 652c 2079 5f70 7265  re(y_true, y_pre
+00070040: 6429 2c74 6872 6573 686f 6c64 2929 0d0a  d),threshold))..
+00070050: 2020 2020 2020 2020 2020 2020 7072 696e              prin
+00070060: 7428 2743 6f6e 6675 7369 6f6e 204d 6174  t('Confusion Mat
+00070070: 7269 783a 2729 0d0a 2020 2020 2020 2020  rix:')..        
+00070080: 2020 2020 7072 696e 7428 636f 6e66 7573      print(confus
+00070090: 696f 6e5f 6d61 7472 6978 2879 5f74 7275  ion_matrix(y_tru
+000700a0: 652c 2079 5f70 7265 6429 290d 0a20 2020  e, y_pred))..   
+000700b0: 2020 2020 2020 2020 2070 7269 6e74 2863           print(c
+000700c0: 6c61 7373 6966 6963 6174 696f 6e5f 7265  lassification_re
+000700d0: 706f 7274 2879 5f74 7275 652c 2079 5f70  port(y_true, y_p
+000700e0: 7265 6429 290d 0a20 2020 2020 2020 2020  red))..         
+000700f0: 2020 2072 6567 5f61 6363 5b69 5d20 3d20     reg_acc[i] = 
+00070100: 6261 6c61 6e63 6564 5f61 6363 7572 6163  balanced_accurac
+00070110: 795f 7363 6f72 6528 795f 7472 7565 2c20  y_score(y_true, 
+00070120: 795f 7072 6564 290d 0a20 2020 2020 2020  y_pred)..       
+00070130: 2070 7269 6e74 2827 2323 2323 2323 2323   print('########
+00070140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00070150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00070160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070180: 2323 2323 2323 2323 2323 2323 2729 0d0a  ############')..
-00070190: 2020 2020 2020 2020 6966 2020 7265 675f          if  reg_
-000701a0: 6163 635b 305d 203e 3d20 7265 675f 6163  acc[0] >= reg_ac
-000701b0: 635b 315d 203a 0d0a 2020 2020 2020 2020  c[1] :..        
-000701c0: 2020 2020 7072 696e 7428 2752 6567 756c      print('Regul
-000701d0: 6172 2074 6872 6573 686f 6c64 203d 2025  ar threshold = %
-000701e0: 302e 3266 2069 7320 6265 7474 6572 2720  0.2f is better' 
-000701f0: 2530 2e35 290d 0a20 2020 2020 2020 2020  %0.5)..         
-00070200: 2020 2072 6574 7572 6e20 7265 675f 6163     return reg_ac
-00070210: 635b 305d 0d0a 2020 2020 2020 2020 656c  c[0]..        el
-00070220: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00070230: 2070 7269 6e74 2827 4d6f 6469 6669 6564   print('Modified
-00070240: 2074 6872 6573 686f 6c64 203d 2025 302e   threshold = %0.
-00070250: 3266 2069 7320 6265 7474 6572 2720 256d  2f is better' %m
-00070260: 5f74 6872 6573 6829 0d0a 2020 2020 2020  _thresh)..      
-00070270: 2020 2020 2020 7265 7475 726e 2072 6567        return reg
-00070280: 5f61 6363 5b31 5d0d 0a20 2020 2065 7863  _acc[1]..    exc
-00070290: 6570 743a 0d0a 2020 2020 2020 2020 7072  ept:..        pr
-000702a0: 696e 7428 2745 7272 6f72 3a20 7072 696e  int('Error: prin
-000702b0: 7469 6e67 2063 6c61 7373 6966 6963 6174  ting classificat
-000702c0: 696f 6e20 6d6f 6465 6c20 6d65 7472 6963  ion model metric
-000702d0: 732e 2043 6f6e 7469 6e75 696e 672e 2e2e  s. Continuing...
-000702e0: 2729 0d0a 2020 2020 2020 2020 7265 7475  ')..        retu
-000702f0: 726e 2030 0d0a 2323 2323 2323 2323 2323  rn 0..##########
+00070170: 2323 2323 2323 2323 2323 2323 2327 290d  #############').
+00070180: 0a20 2020 2020 2020 2069 6620 2072 6567  .        if  reg
+00070190: 5f61 6363 5b30 5d20 3e3d 2072 6567 5f61  _acc[0] >= reg_a
+000701a0: 6363 5b31 5d20 3a0d 0a20 2020 2020 2020  cc[1] :..       
+000701b0: 2020 2020 2070 7269 6e74 2827 5265 6775       print('Regu
+000701c0: 6c61 7220 7468 7265 7368 6f6c 6420 3d20  lar threshold = 
+000701d0: 2530 2e32 6620 6973 2062 6574 7465 7227  %0.2f is better'
+000701e0: 2025 302e 3529 0d0a 2020 2020 2020 2020   %0.5)..        
+000701f0: 2020 2020 7265 7475 726e 2072 6567 5f61      return reg_a
+00070200: 6363 5b30 5d0d 0a20 2020 2020 2020 2065  cc[0]..        e
+00070210: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00070220: 2020 7072 696e 7428 274d 6f64 6966 6965    print('Modifie
+00070230: 6420 7468 7265 7368 6f6c 6420 3d20 2530  d threshold = %0
+00070240: 2e32 6620 6973 2062 6574 7465 7227 2025  .2f is better' %
+00070250: 6d5f 7468 7265 7368 290d 0a20 2020 2020  m_thresh)..     
+00070260: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00070270: 675f 6163 635b 315d 0d0a 2020 2020 6578  g_acc[1]..    ex
+00070280: 6365 7074 3a0d 0a20 2020 2020 2020 2070  cept:..        p
+00070290: 7269 6e74 2827 4572 726f 723a 2070 7269  rint('Error: pri
+000702a0: 6e74 696e 6720 636c 6173 7369 6669 6361  nting classifica
+000702b0: 7469 6f6e 206d 6f64 656c 206d 6574 7269  tion model metri
+000702c0: 6373 2e20 436f 6e74 696e 7569 6e67 2e2e  cs. Continuing..
+000702d0: 2e27 290d 0a20 2020 2020 2020 2072 6574  .')..        ret
+000702e0: 7572 6e20 300d 0a23 2323 2323 2323 2323  urn 0..#########
+000702f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00070300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00070310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00070330: 2323 2323 2323 2323 2323 230d 0a23 2323  ###########..###
-00070340: 2323 2020 2020 2052 4547 5245 5353 494f  ##     REGRESSIO
-00070350: 4e20 4348 4152 5453 2041 4e44 204d 4554  N CHARTS AND MET
-00070360: 5249 4353 2041 5245 2050 5249 4e54 4544  RICS ARE PRINTED
-00070370: 2050 4c4f 5454 4544 2048 4552 450d 0a23   PLOTTED HERE..#
+00070320: 2323 2323 2323 2323 2323 2323 0d0a 2323  ############..##
+00070330: 2323 2320 2020 2020 5245 4752 4553 5349  ###     REGRESSI
+00070340: 4f4e 2043 4841 5254 5320 414e 4420 4d45  ON CHARTS AND ME
+00070350: 5452 4943 5320 4152 4520 5052 494e 5445  TRICS ARE PRINTE
+00070360: 4420 504c 4f54 5445 4420 4845 5245 0d0a  D PLOTTED HERE..
+00070370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00070380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00070390: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000703a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000703b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000703c0: 2323 2323 0d0a 696d 706f 7274 2074 696d  ####..import tim
-000703d0: 650d 0a64 6566 2070 6c6f 745f 7265 6772  e..def plot_regr
-000703e0: 6573 7369 6f6e 5f73 6361 7474 6572 7328  ession_scatters(
-000703f0: 6466 2c20 6466 322c 206e 756d 5f76 6172  df, df2, num_var
-00070400: 732c 206b 696e 643d 2773 6361 7474 6572  s, kind='scatter
-00070410: 272c 2070 6c6f 745f 6e61 6d65 3d27 2729  ', plot_name='')
-00070420: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
-00070430: 4772 6561 7420 7761 7920 746f 2070 6c6f  Great way to plo
-00070440: 7420 636f 6e74 696e 756f 7573 2076 6172  t continuous var
-00070450: 6961 626c 6573 2066 6173 742e 204a 7573  iables fast. Jus
-00070460: 7420 7365 6e74 2074 6865 6d20 696e 2061  t sent them in a
-00070470: 6e64 2069 7420 7769 6c6c 2074 616b 6520  nd it will take 
-00070480: 6361 7265 206f 6620 7468 6520 7265 7374  care of the rest
-00070490: 210d 0a20 2020 2022 2222 0d0a 2020 2020  !..    """..    
-000704a0: 6669 6773 697a 6520 3d20 2831 302c 2031  figsize = (10, 1
-000704b0: 3029 0d0a 2020 2020 636f 6c6f 7273 203d  0)..    colors =
-000704c0: 2063 7963 6c65 2827 6279 7263 6d67 6b62   cycle('byrcmgkb
-000704d0: 7972 636d 676b 6279 7263 6d67 6b62 7972  yrcmgkbyrcmgkbyr
-000704e0: 636d 676b 2729 0d0a 2020 2020 6e75 6d5f  cmgk')..    num_
-000704f0: 7661 7273 5f6c 656e 203d 206c 656e 286e  vars_len = len(n
-00070500: 756d 5f76 6172 7329 0d0a 2020 2020 636f  um_vars)..    co
-00070510: 6c20 3d20 320d 0a20 2020 2073 7461 7274  l = 2..    start
-00070520: 5f74 696d 6520 3d20 7469 6d65 2e74 696d  _time = time.tim
-00070530: 6528 290d 0a20 2020 2072 6f77 203d 206c  e()..    row = l
-00070540: 656e 286e 756d 5f76 6172 7329 0d0a 2020  en(num_vars)..  
-00070550: 2020 6669 672c 2061 7820 3d20 706c 742e    fig, ax = plt.
-00070560: 7375 6270 6c6f 7473 2872 6f77 2c20 636f  subplots(row, co
-00070570: 6c29 0d0a 2020 2020 6966 2063 6f6c 203c  l)..    if col <
-00070580: 2032 3a0d 0a20 2020 2020 2020 2066 6967   2:..        fig
-00070590: 2e73 6574 5f73 697a 655f 696e 6368 6573  .set_size_inches
-000705a0: 286d 696e 2831 352c 3829 2c72 6f77 2a35  (min(15,8),row*5
-000705b0: 290d 0a20 2020 2020 2020 2066 6967 2e73  )..        fig.s
-000705c0: 7562 706c 6f74 735f 6164 6a75 7374 2868  ubplots_adjust(h
-000705d0: 7370 6163 653d 302e 3529 2023 2323 2054  space=0.5) ### T
-000705e0: 6869 7320 636f 6e74 726f 6c73 2074 6865  his controls the
-000705f0: 2073 7061 6365 2062 6574 7765 6e20 726f   space betwen ro
-00070600: 7773 0d0a 2020 2020 2020 2020 6669 672e  ws..        fig.
-00070610: 7375 6270 6c6f 7473 5f61 646a 7573 7428  subplots_adjust(
-00070620: 7773 7061 6365 3d30 2e33 2920 2323 2320  wspace=0.3) ### 
-00070630: 5468 6973 2063 6f6e 7472 6f6c 7320 7468  This controls th
-00070640: 6520 7370 6163 6520 6265 7477 6565 6e20  e space between 
-00070650: 636f 6c75 6d6e 730d 0a20 2020 2065 6c73  columns..    els
-00070660: 653a 0d0a 2020 2020 2020 2020 6669 672e  e:..        fig.
-00070670: 7365 745f 7369 7a65 5f69 6e63 6865 7328  set_size_inches(
-00070680: 6d69 6e28 636f 6c2a 3130 2c32 3029 2c72  min(col*10,20),r
-00070690: 6f77 2a35 290d 0a20 2020 2020 2020 2066  ow*5)..        f
-000706a0: 6967 2e73 7562 706c 6f74 735f 6164 6a75  ig.subplots_adju
-000706b0: 7374 2868 7370 6163 653d 302e 3329 2023  st(hspace=0.3) #
-000706c0: 2323 2054 6869 7320 636f 6e74 726f 6c73  ## This controls
-000706d0: 2074 6865 2073 7061 6365 2062 6574 7765   the space betwe
-000706e0: 6e20 726f 7773 0d0a 2020 2020 2020 2020  n rows..        
-000706f0: 6669 672e 7375 6270 6c6f 7473 5f61 646a  fig.subplots_adj
-00070700: 7573 7428 7773 7061 6365 3d30 2e33 2920  ust(wspace=0.3) 
-00070710: 2323 2320 5468 6973 2063 6f6e 7472 6f6c  ### This control
-00070720: 7320 7468 6520 7370 6163 6520 6265 7477  s the space betw
-00070730: 6565 6e20 636f 6c75 6d6e 730d 0a20 2020  een columns..   
-00070740: 2066 6967 2e73 7570 7469 746c 6528 2752   fig.suptitle('R
-00070750: 6567 7265 7373 696f 6e20 4d65 7472 6963  egression Metric
-00070760: 7320 506c 6f74 7320 666f 7220 2573 204d  s Plots for %s M
-00070770: 6f64 656c 2720 2570 6c6f 745f 6e61 6d65  odel' %plot_name
-00070780: 2c20 666f 6e74 7369 7a65 3d32 3029 0d0a  , fontsize=20)..
-00070790: 2020 2020 636f 756e 7465 7220 3d20 300d      counter = 0.
-000707a0: 0a20 2020 2069 6620 726f 7720 3d3d 2031  .    if row == 1
-000707b0: 3a0d 0a20 2020 2020 2020 2061 7820 3d20  :..        ax = 
-000707c0: 6178 2e72 6573 6861 7065 282d 312c 3129  ax.reshape(-1,1)
-000707d0: 2e54 0d0a 2020 2020 666f 7220 6b20 696e  .T..    for k in
-000707e0: 206e 702e 6172 616e 6765 2872 6f77 293a   np.arange(row):
-000707f0: 0d0a 2020 2020 2020 2020 726f 775f 636f  ..        row_co
-00070800: 6c6f 7220 3d20 6e65 7874 2863 6f6c 6f72  lor = next(color
-00070810: 7329 0d0a 2020 2020 2020 2020 666f 7220  s)..        for 
-00070820: 6c20 696e 206e 702e 6172 616e 6765 2863  l in np.arange(c
-00070830: 6f6c 293a 0d0a 2020 2020 2020 2020 2020  ol):..          
-00070840: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
-00070850: 2020 2020 2020 2020 6966 2063 6f6c 3d3d          if col==
-00070860: 313a 0d0a 2020 2020 2020 2020 2020 2020  1:..            
-00070870: 2020 2020 2020 2020 6966 2072 6f77 203d          if row =
-00070880: 3d20 313a 0d0a 2020 2020 2020 2020 2020  = 1:..          
-00070890: 2020 2020 2020 2020 2020 2020 2020 7820                x 
-000708a0: 3d20 6466 5b3a 5d0d 0a20 2020 2020 2020  = df[:]..       
-000708b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000708c0: 2079 203d 2064 6632 5b3a 5d0d 0a20 2020   y = df2[:]..   
-000708d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000708e0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-000708f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070900: 7820 3d20 6466 5b3a 2c6b 5d0d 0a20 2020  x = df[:,k]..   
-00070910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070920: 2020 2020 2079 203d 2064 6632 5b3a 2c6b       y = df2[:,k
-00070930: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00070940: 2020 2020 2020 2061 7831 203d 2061 785b         ax1 = ax[
-00070950: 6b5d 5b6c 5d0d 0a20 2020 2020 2020 2020  k][l]..         
-00070960: 2020 2020 2020 2020 2020 206c 696e 6553             lineS
-00070970: 7461 7274 203d 2078 2e6d 696e 2829 0d0a  tart = x.min()..
-00070980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070990: 2020 2020 6c69 6e65 456e 6420 3d20 782e      lineEnd = x.
-000709a0: 6d61 7828 290d 0a20 2020 2020 2020 2020  max()..         
-000709b0: 2020 2020 2020 2020 2020 2061 7831 2e73             ax1.s
-000709c0: 6361 7474 6572 2878 2c20 792c 2063 6f6c  catter(x, y, col
-000709d0: 6f72 3d72 6f77 5f63 6f6c 6f72 290d 0a20  or=row_color).. 
-000709e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000709f0: 2020 2061 7831 2e70 6c6f 7428 5b6c 696e     ax1.plot([lin
-00070a00: 6553 7461 7274 2c20 6c69 6e65 456e 645d  eStart, lineEnd]
-00070a10: 2c20 5b6c 696e 6553 7461 7274 2c20 6c69  , [lineStart, li
-00070a20: 6e65 456e 645d 2c20 276b 2d27 2c20 636f  neEnd], 'k-', co
-00070a30: 6c6f 723d 726f 775f 636f 6c6f 7229 0d0a  lor=row_color)..
-00070a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070a50: 2020 2020 6178 312e 7365 745f 786c 6162      ax1.set_xlab
-00070a60: 656c 2827 4163 7475 616c 7327 290d 0a20  el('Actuals').. 
-00070a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070a80: 2020 2061 7831 2e73 6574 5f79 6c61 6265     ax1.set_ylabe
-00070a90: 6c28 2750 7265 6469 6374 6564 2729 0d0a  l('Predicted')..
-00070aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070ab0: 2020 2020 6178 312e 7365 745f 7469 746c      ax1.set_titl
-00070ac0: 6528 2750 7265 6469 6374 6564 2076 7320  e('Predicted vs 
-00070ad0: 4163 7475 616c 7320 506c 6f74 2066 6f72  Actuals Plot for
-00070ae0: 2054 6172 6765 7420 3d20 2573 2720 256e   Target = %s' %n
-00070af0: 756d 5f76 6172 735b 6b5d 290d 0a20 2020  um_vars[k])..   
-00070b00: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00070b10: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00070b20: 2020 2020 2020 2020 6966 2072 6f77 203d          if row =
-00070b30: 3d20 313a 0d0a 2020 2020 2020 2020 2020  = 1:..          
-00070b40: 2020 2020 2020 2020 2020 2020 2020 7820                x 
-00070b50: 3d20 6466 5b3a 5d0d 0a20 2020 2020 2020  = df[:]..       
-00070b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070b70: 2079 203d 2064 6632 5b3a 5d0d 0a20 2020   y = df2[:]..   
-00070b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070b90: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00070ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070bb0: 7820 3d20 6466 5b3a 2c6b 5d0d 0a20 2020  x = df[:,k]..   
-00070bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070bd0: 2020 2020 2079 203d 2064 6632 5b3a 2c6b       y = df2[:,k
-00070be0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00070bf0: 2020 2020 2020 206c 696e 6553 7461 7274         lineStart
-00070c00: 203d 2078 2e6d 696e 2829 0d0a 2020 2020   = x.min()..    
-00070c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070c20: 6c69 6e65 456e 6420 3d20 782e 6d61 7828  lineEnd = x.max(
-00070c30: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00070c40: 2020 2020 2020 2069 6620 6c20 3d3d 2030         if l == 0
-00070c50: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00070c60: 2020 2020 2020 2020 2020 2061 7831 203d             ax1 =
-00070c70: 2061 785b 6b5d 5b6c 5d0d 0a20 2020 2020   ax[k][l]..     
-00070c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070c90: 2020 2061 7831 2e73 6361 7474 6572 2878     ax1.scatter(x
-00070ca0: 2c20 792c 2020 636f 6c6f 7220 3d20 726f  , y,  color = ro
-00070cb0: 775f 636f 6c6f 7229 0d0a 2020 2020 2020  w_color)..      
-00070cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070cd0: 2020 6178 312e 706c 6f74 285b 6c69 6e65    ax1.plot([line
-00070ce0: 5374 6172 742c 206c 696e 6545 6e64 5d2c  Start, lineEnd],
-00070cf0: 205b 6c69 6e65 5374 6172 742c 206c 696e   [lineStart, lin
-00070d00: 6545 6e64 5d2c 2027 6b2d 272c 2063 6f6c  eEnd], 'k-', col
-00070d10: 6f72 203d 2072 6f77 5f63 6f6c 6f72 290d  or = row_color).
-00070d20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00070d30: 2020 2020 2020 2020 2061 7831 2e73 6574           ax1.set
-00070d40: 5f78 6c61 6265 6c28 2741 6374 7561 6c73  _xlabel('Actuals
-00070d50: 2729 0d0a 2020 2020 2020 2020 2020 2020  ')..            
-00070d60: 2020 2020 2020 2020 2020 2020 6178 312e              ax1.
-00070d70: 7365 745f 796c 6162 656c 2827 5072 6564  set_ylabel('Pred
-00070d80: 6963 7465 6427 290d 0a20 2020 2020 2020  icted')..       
-00070d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070da0: 2061 7831 2e73 6574 5f74 6974 6c65 2827   ax1.set_title('
-00070db0: 5072 6564 6963 7465 6420 7673 2041 6374  Predicted vs Act
-00070dc0: 7561 6c73 2050 6c6f 7420 666f 7220 5461  uals Plot for Ta
-00070dd0: 7267 6574 203d 2025 7327 2025 6e75 6d5f  rget = %s' %num_
-00070de0: 7661 7273 5b6b 5d29 0d0a 2020 2020 2020  vars[k])..      
-00070df0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00070e00: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00070e10: 2020 2020 2020 2020 2020 2020 2061 7831               ax1
-00070e20: 203d 2061 785b 6b5d 5b6c 5d0d 0a20 2020   = ax[k][l]..   
-00070e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070e40: 2020 2020 2061 7831 2e68 6973 7428 2878       ax1.hist((x
-00070e50: 2d79 292c 2064 656e 7369 7479 3d54 7275  -y), density=Tru
-00070e60: 652c 636f 6c6f 7220 3d20 726f 775f 636f  e,color = row_co
-00070e70: 6c6f 7229 0d0a 2020 2020 2020 2020 2020  lor)..          
-00070e80: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00070e90: 312e 6178 766c 696e 6528 636f 6c6f 723d  1.axvline(color=
-00070ea0: 276b 2729 0d0a 2020 2020 2020 2020 2020  'k')..          
-00070eb0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00070ec0: 312e 7365 745f 7469 746c 6528 2752 6573  1.set_title('Res
-00070ed0: 6964 7561 6c73 2050 6c6f 7420 666f 7220  iduals Plot for 
-00070ee0: 5461 7267 6574 203d 2025 7327 2025 6e75  Target = %s' %nu
-00070ef0: 6d5f 7661 7273 5b6b 5d29 0d0a 2020 2020  m_vars[k])..    
-00070f00: 2020 2020 2020 2020 6578 6365 7074 3a0d          except:.
-00070f10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00070f20: 2069 6620 636f 6c20 3d3d 2031 3a0d 0a20   if col == 1:.. 
-00070f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00070f40: 2020 2063 6f75 6e74 6572 202b 3d20 310d     counter += 1.
-00070f50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00070f60: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00070f70: 2020 2020 2020 2020 2020 2020 6178 5b6b              ax[k
-00070f80: 5d5b 6c5d 2e73 6574 5f74 6974 6c65 2827  ][l].set_title('
-00070f90: 4e6f 2050 7265 6469 6374 6564 2076 7320  No Predicted vs 
-00070fa0: 4163 7475 616c 7320 506c 6f74 2066 6f72  Actuals Plot for
-00070fb0: 2070 6c6f 7420 6173 2025 7320 6973 206e   plot as %s is n
-00070fc0: 6f74 206e 756d 6572 6963 2720 256e 756d  ot numeric' %num
-00070fd0: 5f76 6172 735b 6b5d 290d 0a20 2020 2020  _vars[k])..     
-00070fe0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00070ff0: 6f75 6e74 6572 202b 3d20 310d 0a20 2020  ounter += 1..   
-00071000: 2070 7269 6e74 2827 5265 6772 6573 7369   print('Regressi
-00071010: 6f6e 2050 6c6f 7473 2063 6f6d 706c 6574  on Plots complet
-00071020: 6564 2069 6e20 2530 2e33 6620 7365 636f  ed in %0.3f seco
-00071030: 6e64 7327 2025 2874 696d 652e 7469 6d65  nds' %(time.time
-00071040: 2829 2d73 7461 7274 5f74 696d 6529 290d  ()-start_time)).
-00071050: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
+000703b0: 2323 2323 230d 0a69 6d70 6f72 7420 7469  #####..import ti
+000703c0: 6d65 0d0a 6465 6620 706c 6f74 5f72 6567  me..def plot_reg
+000703d0: 7265 7373 696f 6e5f 7363 6174 7465 7273  ression_scatters
+000703e0: 2864 662c 2064 6632 2c20 6e75 6d5f 7661  (df, df2, num_va
+000703f0: 7273 2c20 6b69 6e64 3d27 7363 6174 7465  rs, kind='scatte
+00070400: 7227 2c20 706c 6f74 5f6e 616d 653d 2727  r', plot_name=''
+00070410: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
+00070420: 2047 7265 6174 2077 6179 2074 6f20 706c   Great way to pl
+00070430: 6f74 2063 6f6e 7469 6e75 6f75 7320 7661  ot continuous va
+00070440: 7269 6162 6c65 7320 6661 7374 2e20 4a75  riables fast. Ju
+00070450: 7374 2073 656e 7420 7468 656d 2069 6e20  st sent them in 
+00070460: 616e 6420 6974 2077 696c 6c20 7461 6b65  and it will take
+00070470: 2063 6172 6520 6f66 2074 6865 2072 6573   care of the res
+00070480: 7421 0d0a 2020 2020 2222 220d 0a20 2020  t!..    """..   
+00070490: 2066 6967 7369 7a65 203d 2028 3130 2c20   figsize = (10, 
+000704a0: 3130 290d 0a20 2020 2063 6f6c 6f72 7320  10)..    colors 
+000704b0: 3d20 6379 636c 6528 2762 7972 636d 676b  = cycle('byrcmgk
+000704c0: 6279 7263 6d67 6b62 7972 636d 676b 6279  byrcmgkbyrcmgkby
+000704d0: 7263 6d67 6b27 290d 0a20 2020 206e 756d  rcmgk')..    num
+000704e0: 5f76 6172 735f 6c65 6e20 3d20 6c65 6e28  _vars_len = len(
+000704f0: 6e75 6d5f 7661 7273 290d 0a20 2020 2063  num_vars)..    c
+00070500: 6f6c 203d 2032 0d0a 2020 2020 7374 6172  ol = 2..    star
+00070510: 745f 7469 6d65 203d 2074 696d 652e 7469  t_time = time.ti
+00070520: 6d65 2829 0d0a 2020 2020 726f 7720 3d20  me()..    row = 
+00070530: 6c65 6e28 6e75 6d5f 7661 7273 290d 0a20  len(num_vars).. 
+00070540: 2020 2066 6967 2c20 6178 203d 2070 6c74     fig, ax = plt
+00070550: 2e73 7562 706c 6f74 7328 726f 772c 2063  .subplots(row, c
+00070560: 6f6c 290d 0a20 2020 2069 6620 636f 6c20  ol)..    if col 
+00070570: 3c20 323a 0d0a 2020 2020 2020 2020 6669  < 2:..        fi
+00070580: 672e 7365 745f 7369 7a65 5f69 6e63 6865  g.set_size_inche
+00070590: 7328 6d69 6e28 3135 2c38 292c 726f 772a  s(min(15,8),row*
+000705a0: 3529 0d0a 2020 2020 2020 2020 6669 672e  5)..        fig.
+000705b0: 7375 6270 6c6f 7473 5f61 646a 7573 7428  subplots_adjust(
+000705c0: 6873 7061 6365 3d30 2e35 2920 2323 2320  hspace=0.5) ### 
+000705d0: 5468 6973 2063 6f6e 7472 6f6c 7320 7468  This controls th
+000705e0: 6520 7370 6163 6520 6265 7477 656e 2072  e space betwen r
+000705f0: 6f77 730d 0a20 2020 2020 2020 2066 6967  ows..        fig
+00070600: 2e73 7562 706c 6f74 735f 6164 6a75 7374  .subplots_adjust
+00070610: 2877 7370 6163 653d 302e 3329 2023 2323  (wspace=0.3) ###
+00070620: 2054 6869 7320 636f 6e74 726f 6c73 2074   This controls t
+00070630: 6865 2073 7061 6365 2062 6574 7765 656e  he space between
+00070640: 2063 6f6c 756d 6e73 0d0a 2020 2020 656c   columns..    el
+00070650: 7365 3a0d 0a20 2020 2020 2020 2066 6967  se:..        fig
+00070660: 2e73 6574 5f73 697a 655f 696e 6368 6573  .set_size_inches
+00070670: 286d 696e 2863 6f6c 2a31 302c 3230 292c  (min(col*10,20),
+00070680: 726f 772a 3529 0d0a 2020 2020 2020 2020  row*5)..        
+00070690: 6669 672e 7375 6270 6c6f 7473 5f61 646a  fig.subplots_adj
+000706a0: 7573 7428 6873 7061 6365 3d30 2e33 2920  ust(hspace=0.3) 
+000706b0: 2323 2320 5468 6973 2063 6f6e 7472 6f6c  ### This control
+000706c0: 7320 7468 6520 7370 6163 6520 6265 7477  s the space betw
+000706d0: 656e 2072 6f77 730d 0a20 2020 2020 2020  en rows..       
+000706e0: 2066 6967 2e73 7562 706c 6f74 735f 6164   fig.subplots_ad
+000706f0: 6a75 7374 2877 7370 6163 653d 302e 3329  just(wspace=0.3)
+00070700: 2023 2323 2054 6869 7320 636f 6e74 726f   ### This contro
+00070710: 6c73 2074 6865 2073 7061 6365 2062 6574  ls the space bet
+00070720: 7765 656e 2063 6f6c 756d 6e73 0d0a 2020  ween columns..  
+00070730: 2020 6669 672e 7375 7074 6974 6c65 2827    fig.suptitle('
+00070740: 5265 6772 6573 7369 6f6e 204d 6574 7269  Regression Metri
+00070750: 6373 2050 6c6f 7473 2066 6f72 2025 7320  cs Plots for %s 
+00070760: 4d6f 6465 6c27 2025 706c 6f74 5f6e 616d  Model' %plot_nam
+00070770: 652c 2066 6f6e 7473 697a 653d 3230 290d  e, fontsize=20).
+00070780: 0a20 2020 2063 6f75 6e74 6572 203d 2030  .    counter = 0
+00070790: 0d0a 2020 2020 6966 2072 6f77 203d 3d20  ..    if row == 
+000707a0: 313a 0d0a 2020 2020 2020 2020 6178 203d  1:..        ax =
+000707b0: 2061 782e 7265 7368 6170 6528 2d31 2c31   ax.reshape(-1,1
+000707c0: 292e 540d 0a20 2020 2066 6f72 206b 2069  ).T..    for k i
+000707d0: 6e20 6e70 2e61 7261 6e67 6528 726f 7729  n np.arange(row)
+000707e0: 3a0d 0a20 2020 2020 2020 2072 6f77 5f63  :..        row_c
+000707f0: 6f6c 6f72 203d 206e 6578 7428 636f 6c6f  olor = next(colo
+00070800: 7273 290d 0a20 2020 2020 2020 2066 6f72  rs)..        for
+00070810: 206c 2069 6e20 6e70 2e61 7261 6e67 6528   l in np.arange(
+00070820: 636f 6c29 3a0d 0a20 2020 2020 2020 2020  col):..         
+00070830: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+00070840: 2020 2020 2020 2020 2069 6620 636f 6c3d           if col=
+00070850: 3d31 3a0d 0a20 2020 2020 2020 2020 2020  =1:..           
+00070860: 2020 2020 2020 2020 2069 6620 726f 7720           if row 
+00070870: 3d3d 2031 3a0d 0a20 2020 2020 2020 2020  == 1:..         
+00070880: 2020 2020 2020 2020 2020 2020 2020 2078                 x
+00070890: 203d 2064 665b 3a5d 0d0a 2020 2020 2020   = df[:]..      
+000708a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000708b0: 2020 7920 3d20 6466 325b 3a5d 0d0a 2020    y = df2[:]..  
+000708c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000708d0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+000708e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000708f0: 2078 203d 2064 665b 3a2c 6b5d 0d0a 2020   x = df[:,k]..  
+00070900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070910: 2020 2020 2020 7920 3d20 6466 325b 3a2c        y = df2[:,
+00070920: 6b5d 0d0a 2020 2020 2020 2020 2020 2020  k]..            
+00070930: 2020 2020 2020 2020 6178 3120 3d20 6178          ax1 = ax
+00070940: 5b6b 5d5b 6c5d 0d0a 2020 2020 2020 2020  [k][l]..        
+00070950: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
+00070960: 5374 6172 7420 3d20 782e 6d69 6e28 290d  Start = x.min().
+00070970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00070980: 2020 2020 206c 696e 6545 6e64 203d 2078       lineEnd = x
+00070990: 2e6d 6178 2829 0d0a 2020 2020 2020 2020  .max()..        
+000709a0: 2020 2020 2020 2020 2020 2020 6178 312e              ax1.
+000709b0: 7363 6174 7465 7228 782c 2079 2c20 636f  scatter(x, y, co
+000709c0: 6c6f 723d 726f 775f 636f 6c6f 7229 0d0a  lor=row_color)..
+000709d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000709e0: 2020 2020 6178 312e 706c 6f74 285b 6c69      ax1.plot([li
+000709f0: 6e65 5374 6172 742c 206c 696e 6545 6e64  neStart, lineEnd
+00070a00: 5d2c 205b 6c69 6e65 5374 6172 742c 206c  ], [lineStart, l
+00070a10: 696e 6545 6e64 5d2c 2027 6b2d 272c 2063  ineEnd], 'k-', c
+00070a20: 6f6c 6f72 3d72 6f77 5f63 6f6c 6f72 290d  olor=row_color).
+00070a30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00070a40: 2020 2020 2061 7831 2e73 6574 5f78 6c61       ax1.set_xla
+00070a50: 6265 6c28 2741 6374 7561 6c73 2729 0d0a  bel('Actuals')..
+00070a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070a70: 2020 2020 6178 312e 7365 745f 796c 6162      ax1.set_ylab
+00070a80: 656c 2827 5072 6564 6963 7465 6427 290d  el('Predicted').
+00070a90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00070aa0: 2020 2020 2061 7831 2e73 6574 5f74 6974       ax1.set_tit
+00070ab0: 6c65 2827 5072 6564 6963 7465 6420 7673  le('Predicted vs
+00070ac0: 2041 6374 7561 6c73 2050 6c6f 7420 666f   Actuals Plot fo
+00070ad0: 7220 5461 7267 6574 203d 2025 7327 2025  r Target = %s' %
+00070ae0: 6e75 6d5f 7661 7273 5b6b 5d29 0d0a 2020  num_vars[k])..  
+00070af0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00070b00: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00070b10: 2020 2020 2020 2020 2069 6620 726f 7720           if row 
+00070b20: 3d3d 2031 3a0d 0a20 2020 2020 2020 2020  == 1:..         
+00070b30: 2020 2020 2020 2020 2020 2020 2020 2078                 x
+00070b40: 203d 2064 665b 3a5d 0d0a 2020 2020 2020   = df[:]..      
+00070b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070b60: 2020 7920 3d20 6466 325b 3a5d 0d0a 2020    y = df2[:]..  
+00070b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070b80: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00070b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070ba0: 2078 203d 2064 665b 3a2c 6b5d 0d0a 2020   x = df[:,k]..  
+00070bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070bc0: 2020 2020 2020 7920 3d20 6466 325b 3a2c        y = df2[:,
+00070bd0: 6b5d 0d0a 2020 2020 2020 2020 2020 2020  k]..            
+00070be0: 2020 2020 2020 2020 6c69 6e65 5374 6172          lineStar
+00070bf0: 7420 3d20 782e 6d69 6e28 290d 0a20 2020  t = x.min()..   
+00070c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070c10: 206c 696e 6545 6e64 203d 2078 2e6d 6178   lineEnd = x.max
+00070c20: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
+00070c30: 2020 2020 2020 2020 6966 206c 203d 3d20          if l == 
+00070c40: 303a 0d0a 2020 2020 2020 2020 2020 2020  0:..            
+00070c50: 2020 2020 2020 2020 2020 2020 6178 3120              ax1 
+00070c60: 3d20 6178 5b6b 5d5b 6c5d 0d0a 2020 2020  = ax[k][l]..    
+00070c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070c80: 2020 2020 6178 312e 7363 6174 7465 7228      ax1.scatter(
+00070c90: 782c 2079 2c20 2063 6f6c 6f72 203d 2072  x, y,  color = r
+00070ca0: 6f77 5f63 6f6c 6f72 290d 0a20 2020 2020  ow_color)..     
+00070cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070cc0: 2020 2061 7831 2e70 6c6f 7428 5b6c 696e     ax1.plot([lin
+00070cd0: 6553 7461 7274 2c20 6c69 6e65 456e 645d  eStart, lineEnd]
+00070ce0: 2c20 5b6c 696e 6553 7461 7274 2c20 6c69  , [lineStart, li
+00070cf0: 6e65 456e 645d 2c20 276b 2d27 2c20 636f  neEnd], 'k-', co
+00070d00: 6c6f 7220 3d20 726f 775f 636f 6c6f 7229  lor = row_color)
+00070d10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00070d20: 2020 2020 2020 2020 2020 6178 312e 7365            ax1.se
+00070d30: 745f 786c 6162 656c 2827 4163 7475 616c  t_xlabel('Actual
+00070d40: 7327 290d 0a20 2020 2020 2020 2020 2020  s')..           
+00070d50: 2020 2020 2020 2020 2020 2020 2061 7831               ax1
+00070d60: 2e73 6574 5f79 6c61 6265 6c28 2750 7265  .set_ylabel('Pre
+00070d70: 6469 6374 6564 2729 0d0a 2020 2020 2020  dicted')..      
+00070d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070d90: 2020 6178 312e 7365 745f 7469 746c 6528    ax1.set_title(
+00070da0: 2750 7265 6469 6374 6564 2076 7320 4163  'Predicted vs Ac
+00070db0: 7475 616c 7320 506c 6f74 2066 6f72 2054  tuals Plot for T
+00070dc0: 6172 6765 7420 3d20 2573 2720 256e 756d  arget = %s' %num
+00070dd0: 5f76 6172 735b 6b5d 290d 0a20 2020 2020  _vars[k])..     
+00070de0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00070df0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00070e00: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00070e10: 3120 3d20 6178 5b6b 5d5b 6c5d 0d0a 2020  1 = ax[k][l]..  
+00070e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070e30: 2020 2020 2020 6178 312e 6869 7374 2828        ax1.hist((
+00070e40: 782d 7929 2c20 6465 6e73 6974 793d 5472  x-y), density=Tr
+00070e50: 7565 2c63 6f6c 6f72 203d 2072 6f77 5f63  ue,color = row_c
+00070e60: 6f6c 6f72 290d 0a20 2020 2020 2020 2020  olor)..         
+00070e70: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00070e80: 7831 2e61 7876 6c69 6e65 2863 6f6c 6f72  x1.axvline(color
+00070e90: 3d27 6b27 290d 0a20 2020 2020 2020 2020  ='k')..         
+00070ea0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00070eb0: 7831 2e73 6574 5f74 6974 6c65 2827 5265  x1.set_title('Re
+00070ec0: 7369 6475 616c 7320 506c 6f74 2066 6f72  siduals Plot for
+00070ed0: 2054 6172 6765 7420 3d20 2573 2720 256e   Target = %s' %n
+00070ee0: 756d 5f76 6172 735b 6b5d 290d 0a20 2020  um_vars[k])..   
+00070ef0: 2020 2020 2020 2020 2065 7863 6570 743a           except:
+00070f00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00070f10: 2020 6966 2063 6f6c 203d 3d20 313a 0d0a    if col == 1:..
+00070f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070f30: 2020 2020 636f 756e 7465 7220 2b3d 2031      counter += 1
+00070f40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00070f50: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00070f60: 2020 2020 2020 2020 2020 2020 2061 785b               ax[
+00070f70: 6b5d 5b6c 5d2e 7365 745f 7469 746c 6528  k][l].set_title(
+00070f80: 274e 6f20 5072 6564 6963 7465 6420 7673  'No Predicted vs
+00070f90: 2041 6374 7561 6c73 2050 6c6f 7420 666f   Actuals Plot fo
+00070fa0: 7220 706c 6f74 2061 7320 2573 2069 7320  r plot as %s is 
+00070fb0: 6e6f 7420 6e75 6d65 7269 6327 2025 6e75  not numeric' %nu
+00070fc0: 6d5f 7661 7273 5b6b 5d29 0d0a 2020 2020  m_vars[k])..    
+00070fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00070fe0: 636f 756e 7465 7220 2b3d 2031 0d0a 2020  counter += 1..  
+00070ff0: 2020 7072 696e 7428 2752 6567 7265 7373    print('Regress
+00071000: 696f 6e20 506c 6f74 7320 636f 6d70 6c65  ion Plots comple
+00071010: 7465 6420 696e 2025 302e 3366 2073 6563  ted in %0.3f sec
+00071020: 6f6e 6473 2720 2528 7469 6d65 2e74 696d  onds' %(time.tim
+00071030: 6528 292d 7374 6172 745f 7469 6d65 2929  e()-start_time))
+00071040: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+00071050: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00071060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00071070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00071080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071090: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000710a0: 230d 0a64 6566 2070 7269 6e74 5f72 6567  #..def print_reg
-000710b0: 7265 7373 696f 6e5f 6d6f 6465 6c5f 7374  ression_model_st
-000710c0: 6174 7328 6163 7475 616c 732c 2070 7265  ats(actuals, pre
-000710d0: 6469 6374 6564 2c20 7461 7267 6574 733d  dicted, targets=
-000710e0: 2727 2c20 706c 6f74 5f6e 616d 653d 2727  '', plot_name=''
-000710f0: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
-00071100: 2054 6869 7320 7072 6f67 7261 6d20 7072   This program pr
-00071110: 696e 7473 2061 6e64 2072 6574 7572 6e73  ints and returns
-00071120: 204d 4145 2c20 524d 5345 2c20 4d41 5045   MAE, RMSE, MAPE
-00071130: 2e0d 0a20 2020 2049 6620 796f 7520 6c69  ...    If you li
-00071140: 6b65 2074 6865 204d 4145 2061 6e64 2052  ke the MAE and R
-00071150: 4d53 4520 746f 2068 6176 6520 6120 7469  MSE to have a ti
-00071160: 746c 6520 6f72 2073 6f6d 6574 6869 6e67  tle or something
-00071170: 2c20 6a75 7374 2067 6976 6520 7468 6174  , just give that
-00071180: 0d0a 2020 2020 696e 2074 6865 2069 6e70  ..    in the inp
-00071190: 7574 2061 7320 2274 6974 6c65 2220 616e  ut as "title" an
-000711a0: 6420 6974 2077 696c 6c20 7072 696e 7420  d it will print 
-000711b0: 7468 6174 2074 6974 6c65 206f 6e20 7468  that title on th
-000711c0: 6520 4d41 4520 616e 6420 524d 5345 2061  e MAE and RMSE a
-000711d0: 7320 610d 0a20 2020 2063 6861 7274 2066  s a..    chart f
-000711e0: 6f72 2074 6861 7420 6d6f 6465 6c2e 2052  or that model. R
-000711f0: 6574 7572 6e73 204d 4145 2c20 4d41 455f  eturns MAE, MAE_
-00071200: 6173 5f70 6572 6365 6e74 6167 652c 2061  as_percentage, a
-00071210: 6e64 2052 4d53 455f 6173 5f70 6572 6365  nd RMSE_as_perce
-00071220: 6e74 6167 650d 0a20 2020 2022 2222 0d0a  ntage..    """..
-00071230: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00071240: 6528 6163 7475 616c 732c 7064 2e53 6572  e(actuals,pd.Ser
-00071250: 6965 7329 206f 7220 6973 696e 7374 616e  ies) or isinstan
-00071260: 6365 2861 6374 7561 6c73 2c70 642e 4461  ce(actuals,pd.Da
-00071270: 7461 4672 616d 6529 3a0d 0a20 2020 2020  taFrame):..     
-00071280: 2020 2061 6374 7561 6c73 203d 2061 6374     actuals = act
-00071290: 7561 6c73 2e76 616c 7565 730d 0a20 2020  uals.values..   
-000712a0: 2069 6620 6973 696e 7374 616e 6365 2870   if isinstance(p
-000712b0: 7265 6469 6374 6564 2c70 642e 5365 7269  redicted,pd.Seri
-000712c0: 6573 2920 6f72 2069 7369 6e73 7461 6e63  es) or isinstanc
-000712d0: 6528 7072 6564 6963 7465 642c 7064 2e44  e(predicted,pd.D
-000712e0: 6174 6146 7261 6d65 293a 0d0a 2020 2020  ataFrame):..    
-000712f0: 2020 2020 7072 6564 6963 7465 6420 3d20      predicted = 
-00071300: 7072 6564 6963 7465 642e 7661 6c75 6573  predicted.values
-00071310: 0d0a 2020 2020 6966 206c 656e 2861 6374  ..    if len(act
-00071320: 7561 6c73 2920 213d 206c 656e 2870 7265  uals) != len(pre
-00071330: 6469 6374 6564 293a 0d0a 2020 2020 2020  dicted):..      
-00071340: 2020 7072 696e 7428 2745 7272 6f72 3a20    print('Error: 
-00071350: 4e75 6d62 6572 206f 6620 6163 7475 616c  Number of actual
-00071360: 7320 616e 6420 7072 6564 6963 7465 6420  s and predicted 
-00071370: 646f 6e74 206d 6174 6368 2e20 436f 6e74  dont match. Cont
-00071380: 696e 7569 6e67 2e2e 2e27 290d 0a20 2020  inuing...')..   
-00071390: 2069 6620 7461 7267 6574 7320 3d3d 2022   if targets == "
-000713a0: 223a 0d0a 2020 2020 2020 2020 7472 793a  ":..        try:
-000713b0: 0d0a 2020 2020 2020 2020 2020 2020 2323  ..            ##
-000713c0: 2320 5468 6973 2069 7320 666f 7220 4d75  # This is for Mu
-000713d0: 6c74 695f 4c61 6265 6c20 5072 6f62 6c65  lti_Label Proble
-000713e0: 6d73 2023 2323 0d0a 2020 2020 2020 2020  ms ###..        
-000713f0: 2020 2020 6173 7365 7274 2061 6374 7561      assert actua
-00071400: 6c73 2e73 6861 7065 5b31 5d0d 0a20 2020  ls.shape[1]..   
-00071410: 2020 2020 2020 2020 206d 756c 7469 5f6c           multi_l
-00071420: 6162 656c 203d 2054 7275 650d 0a20 2020  abel = True..   
-00071430: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-00071440: 7374 616e 6365 2861 6374 7561 6c73 2c70  stance(actuals,p
-00071450: 642e 5365 7269 6573 293a 0d0a 2020 2020  d.Series):..    
-00071460: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
-00071470: 203d 205b 6163 7475 616c 732e 6e61 6d65   = [actuals.name
-00071480: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
-00071490: 6c69 6620 6973 696e 7374 616e 6365 2861  lif isinstance(a
-000714a0: 6374 7561 6c73 2c70 642e 4461 7461 4672  ctuals,pd.DataFr
-000714b0: 616d 6529 3a0d 0a20 2020 2020 2020 2020  ame):..         
-000714c0: 2020 2020 2020 2063 6f6c 7320 3d20 6163         cols = ac
-000714d0: 7475 616c 732e 636f 6c75 6d6e 732e 746f  tuals.columns.to
-000714e0: 6c69 7374 2829 0d0a 2020 2020 2020 2020  list()..        
-000714f0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00071500: 2020 2020 2020 2020 2020 2063 6f6c 7320             cols 
-00071510: 3d20 5b27 7461 7267 6574 5f27 2b73 7472  = ['target_'+str
-00071520: 2869 2920 666f 7220 6920 696e 2072 616e  (i) for i in ran
-00071530: 6765 2861 6374 7561 6c73 2e73 6861 7065  ge(actuals.shape
-00071540: 5b31 5d29 5d0d 0a20 2020 2020 2020 2065  [1])]..        e
-00071550: 7863 6570 743a 0d0a 2020 2020 2020 2020  xcept:..        
-00071560: 2020 2020 2323 2323 2054 4869 7320 6973      #### THis is
-00071570: 2066 6f72 2053 696e 676c 6520 4c61 6265   for Single Labe
-00071580: 6c20 7072 6f62 6c65 6d73 2023 2323 2323  l problems #####
-00071590: 0d0a 2020 2020 2020 2020 2020 2020 6d75  ..            mu
-000715a0: 6c74 695f 6c61 6265 6c20 3d20 4661 6c73  lti_label = Fals
-000715b0: 650d 0a20 2020 2020 2020 2020 2020 2069  e..            i
-000715c0: 6620 6973 696e 7374 616e 6365 2861 6374  f isinstance(act
-000715d0: 7561 6c73 2c70 642e 5365 7269 6573 293a  uals,pd.Series):
-000715e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000715f0: 2020 636f 6c73 203d 205b 6163 7475 616c    cols = [actual
-00071600: 732e 6e61 6d65 5d0d 0a20 2020 2020 2020  s.name]..       
-00071610: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
-00071620: 616e 6365 2861 6374 7561 6c73 2c70 642e  ance(actuals,pd.
-00071630: 4461 7461 4672 616d 6529 3a0d 0a20 2020  DataFrame):..   
-00071640: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
-00071650: 7320 3d20 6163 7475 616c 732e 636f 6c75  s = actuals.colu
-00071660: 6d6e 732e 746f 6c69 7374 2829 0d0a 2020  mns.tolist()..  
-00071670: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00071680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00071690: 2063 6f6c 7320 3d20 5b27 7461 7267 6574   cols = ['target
-000716a0: 5f31 275d 0d0a 2020 2020 656c 7365 3a0d  _1']..    else:.
-000716b0: 0a20 2020 2020 2020 2063 6f6c 7320 3d20  .        cols = 
-000716c0: 636f 7079 2e64 6565 7063 6f70 7928 7461  copy.deepcopy(ta
-000716d0: 7267 6574 7329 0d0a 2020 2020 2020 2020  rgets)..        
-000716e0: 6966 2069 7369 6e73 7461 6e63 6528 7461  if isinstance(ta
-000716f0: 7267 6574 732c 2073 7472 293a 0d0a 2020  rgets, str):..  
-00071700: 2020 2020 2020 2020 2020 636f 6c73 203d            cols =
-00071710: 205b 7461 7267 6574 735d 0d0a 2020 2020   [targets]..    
-00071720: 2020 2020 6966 206c 656e 2863 6f6c 7329      if len(cols)
-00071730: 203d 3d20 313a 0d0a 2020 2020 2020 2020   == 1:..        
-00071740: 2020 2020 6d75 6c74 695f 6c61 6265 6c20      multi_label 
-00071750: 3d20 4661 6c73 650d 0a20 2020 2020 2020  = False..       
-00071760: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00071770: 2020 2020 6d75 6c74 695f 6c61 6265 6c20      multi_label 
-00071780: 3d20 5472 7565 0d0a 2020 2020 7472 793a  = True..    try:
-00071790: 0d0a 2020 2020 2020 2020 706c 6f74 5f72  ..        plot_r
-000717a0: 6567 7265 7373 696f 6e5f 7363 6174 7465  egression_scatte
-000717b0: 7273 2861 6374 7561 6c73 2c70 7265 6469  rs(actuals,predi
-000717c0: 6374 6564 2c63 6f6c 732c 706c 6f74 5f6e  cted,cols,plot_n
-000717d0: 616d 653d 706c 6f74 5f6e 616d 6529 0d0a  ame=plot_name)..
-000717e0: 2020 2020 6578 6365 7074 3a0d 0a20 2020      except:..   
-000717f0: 2020 2020 2070 7269 6e74 2827 436f 756c       print('Coul
-00071800: 6420 6e6f 7420 6472 6177 2072 6567 7265  d not draw regre
-00071810: 7373 696f 6e20 706c 6f74 2062 7574 2063  ssion plot but c
-00071820: 6f6e 7469 6e75 696e 672e 2e2e 2729 0d0a  ontinuing...')..
-00071830: 2020 2020 6966 206d 756c 7469 5f6c 6162      if multi_lab
-00071840: 656c 3a0d 0a20 2020 2020 2020 2066 6f72  el:..        for
-00071850: 2069 2069 6e20 7261 6e67 6528 6163 7475   i in range(actu
-00071860: 616c 732e 7368 6170 655b 315d 293a 0d0a  als.shape[1]):..
-00071870: 2020 2020 2020 2020 2020 2020 6163 7475              actu
-00071880: 616c 735f 7820 3d20 6163 7475 616c 735b  als_x = actuals[
-00071890: 3a2c 695d 0d0a 2020 2020 2020 2020 2020  :,i]..          
-000718a0: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
-000718b0: 2020 2020 2020 2020 7072 6564 6963 7465          predicte
-000718c0: 645f 7820 3d20 7072 6564 6963 7465 645b  d_x = predicted[
-000718d0: 3a2c 695d 0d0a 2020 2020 2020 2020 2020  :,i]..          
-000718e0: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
-000718f0: 2020 2020 2020 2020 2020 2070 7265 6469             predi
-00071900: 6374 6564 5f78 203d 2070 7265 6469 6374  cted_x = predict
-00071910: 6564 5b3a 5d0d 0a20 2020 2020 2020 2020  ed[:]..         
-00071920: 2020 2070 7269 6e74 2827 5265 6772 6573     print('Regres
-00071930: 7369 6f6e 204d 6574 7269 6373 2066 6f72  sion Metrics for
-00071940: 2054 6172 6765 743d 2573 2720 2563 6f6c   Target=%s' %col
-00071950: 735b 695d 290d 0a20 2020 2020 2020 2020  s[i])..         
-00071960: 2020 206d 6165 2c20 6d61 655f 6173 702c     mae, mae_asp,
-00071970: 2072 6d73 655f 6173 7020 3d20 7072 696e   rmse_asp = prin
-00071980: 745f 7265 6772 6573 7369 6f6e 5f6d 6574  t_regression_met
-00071990: 7269 6373 2861 6374 7561 6c73 5f78 2c20  rics(actuals_x, 
-000719a0: 7072 6564 6963 7465 645f 7829 0d0a 2020  predicted_x)..  
-000719b0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-000719c0: 206d 6165 2c20 6d61 655f 6173 702c 2072   mae, mae_asp, r
-000719d0: 6d73 655f 6173 7020 3d20 7072 696e 745f  mse_asp = print_
-000719e0: 7265 6772 6573 7369 6f6e 5f6d 6574 7269  regression_metri
-000719f0: 6373 2861 6374 7561 6c73 2c20 7072 6564  cs(actuals, pred
-00071a00: 6963 7465 6429 0d0a 2020 2020 7265 7475  icted)..    retu
-00071a10: 726e 206d 6165 2c20 6d61 655f 6173 702c  rn mae, mae_asp,
-00071a20: 2072 6d73 655f 6173 700d 0a23 2323 2323   rmse_asp..#####
+00071090: 2323 0d0a 6465 6620 7072 696e 745f 7265  ##..def print_re
+000710a0: 6772 6573 7369 6f6e 5f6d 6f64 656c 5f73  gression_model_s
+000710b0: 7461 7473 2861 6374 7561 6c73 2c20 7072  tats(actuals, pr
+000710c0: 6564 6963 7465 642c 2074 6172 6765 7473  edicted, targets
+000710d0: 3d27 272c 2070 6c6f 745f 6e61 6d65 3d27  ='', plot_name='
+000710e0: 2729 3a0d 0a20 2020 2022 2222 0d0a 2020  '):..    """..  
+000710f0: 2020 5468 6973 2070 726f 6772 616d 2070    This program p
+00071100: 7269 6e74 7320 616e 6420 7265 7475 726e  rints and return
+00071110: 7320 4d41 452c 2052 4d53 452c 204d 4150  s MAE, RMSE, MAP
+00071120: 452e 0d0a 2020 2020 4966 2079 6f75 206c  E...    If you l
+00071130: 696b 6520 7468 6520 4d41 4520 616e 6420  ike the MAE and 
+00071140: 524d 5345 2074 6f20 6861 7665 2061 2074  RMSE to have a t
+00071150: 6974 6c65 206f 7220 736f 6d65 7468 696e  itle or somethin
+00071160: 672c 206a 7573 7420 6769 7665 2074 6861  g, just give tha
+00071170: 740d 0a20 2020 2069 6e20 7468 6520 696e  t..    in the in
+00071180: 7075 7420 6173 2022 7469 746c 6522 2061  put as "title" a
+00071190: 6e64 2069 7420 7769 6c6c 2070 7269 6e74  nd it will print
+000711a0: 2074 6861 7420 7469 746c 6520 6f6e 2074   that title on t
+000711b0: 6865 204d 4145 2061 6e64 2052 4d53 4520  he MAE and RMSE 
+000711c0: 6173 2061 0d0a 2020 2020 6368 6172 7420  as a..    chart 
+000711d0: 666f 7220 7468 6174 206d 6f64 656c 2e20  for that model. 
+000711e0: 5265 7475 726e 7320 4d41 452c 204d 4145  Returns MAE, MAE
+000711f0: 5f61 735f 7065 7263 656e 7461 6765 2c20  _as_percentage, 
+00071200: 616e 6420 524d 5345 5f61 735f 7065 7263  and RMSE_as_perc
+00071210: 656e 7461 6765 0d0a 2020 2020 2222 220d  entage..    """.
+00071220: 0a20 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
+00071230: 6365 2861 6374 7561 6c73 2c70 642e 5365  ce(actuals,pd.Se
+00071240: 7269 6573 2920 6f72 2069 7369 6e73 7461  ries) or isinsta
+00071250: 6e63 6528 6163 7475 616c 732c 7064 2e44  nce(actuals,pd.D
+00071260: 6174 6146 7261 6d65 293a 0d0a 2020 2020  ataFrame):..    
+00071270: 2020 2020 6163 7475 616c 7320 3d20 6163      actuals = ac
+00071280: 7475 616c 732e 7661 6c75 6573 0d0a 2020  tuals.values..  
+00071290: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+000712a0: 7072 6564 6963 7465 642c 7064 2e53 6572  predicted,pd.Ser
+000712b0: 6965 7329 206f 7220 6973 696e 7374 616e  ies) or isinstan
+000712c0: 6365 2870 7265 6469 6374 6564 2c70 642e  ce(predicted,pd.
+000712d0: 4461 7461 4672 616d 6529 3a0d 0a20 2020  DataFrame):..   
+000712e0: 2020 2020 2070 7265 6469 6374 6564 203d       predicted =
+000712f0: 2070 7265 6469 6374 6564 2e76 616c 7565   predicted.value
+00071300: 730d 0a20 2020 2069 6620 6c65 6e28 6163  s..    if len(ac
+00071310: 7475 616c 7329 2021 3d20 6c65 6e28 7072  tuals) != len(pr
+00071320: 6564 6963 7465 6429 3a0d 0a20 2020 2020  edicted):..     
+00071330: 2020 2070 7269 6e74 2827 4572 726f 723a     print('Error:
+00071340: 204e 756d 6265 7220 6f66 2061 6374 7561   Number of actua
+00071350: 6c73 2061 6e64 2070 7265 6469 6374 6564  ls and predicted
+00071360: 2064 6f6e 7420 6d61 7463 682e 2043 6f6e   dont match. Con
+00071370: 7469 6e75 696e 672e 2e2e 2729 0d0a 2020  tinuing...')..  
+00071380: 2020 6966 2074 6172 6765 7473 203d 3d20    if targets == 
+00071390: 2222 3a0d 0a20 2020 2020 2020 2074 7279  "":..        try
+000713a0: 3a0d 0a20 2020 2020 2020 2020 2020 2023  :..            #
+000713b0: 2323 2054 6869 7320 6973 2066 6f72 204d  ## This is for M
+000713c0: 756c 7469 5f4c 6162 656c 2050 726f 626c  ulti_Label Probl
+000713d0: 656d 7320 2323 230d 0a20 2020 2020 2020  ems ###..       
+000713e0: 2020 2020 2061 7373 6572 7420 6163 7475       assert actu
+000713f0: 616c 732e 7368 6170 655b 315d 0d0a 2020  als.shape[1]..  
+00071400: 2020 2020 2020 2020 2020 6d75 6c74 695f            multi_
+00071410: 6c61 6265 6c20 3d20 5472 7565 0d0a 2020  label = True..  
+00071420: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+00071430: 6e73 7461 6e63 6528 6163 7475 616c 732c  nstance(actuals,
+00071440: 7064 2e53 6572 6965 7329 3a0d 0a20 2020  pd.Series):..   
+00071450: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+00071460: 7320 3d20 5b61 6374 7561 6c73 2e6e 616d  s = [actuals.nam
+00071470: 655d 0d0a 2020 2020 2020 2020 2020 2020  e]..            
+00071480: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+00071490: 6163 7475 616c 732c 7064 2e44 6174 6146  actuals,pd.DataF
+000714a0: 7261 6d65 293a 0d0a 2020 2020 2020 2020  rame):..        
+000714b0: 2020 2020 2020 2020 636f 6c73 203d 2061          cols = a
+000714c0: 6374 7561 6c73 2e63 6f6c 756d 6e73 2e74  ctuals.columns.t
+000714d0: 6f6c 6973 7428 290d 0a20 2020 2020 2020  olist()..       
+000714e0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+000714f0: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
+00071500: 203d 205b 2774 6172 6765 745f 272b 7374   = ['target_'+st
+00071510: 7228 6929 2066 6f72 2069 2069 6e20 7261  r(i) for i in ra
+00071520: 6e67 6528 6163 7475 616c 732e 7368 6170  nge(actuals.shap
+00071530: 655b 315d 295d 0d0a 2020 2020 2020 2020  e[1])]..        
+00071540: 6578 6365 7074 3a0d 0a20 2020 2020 2020  except:..       
+00071550: 2020 2020 2023 2323 2320 5448 6973 2069       #### THis i
+00071560: 7320 666f 7220 5369 6e67 6c65 204c 6162  s for Single Lab
+00071570: 656c 2070 726f 626c 656d 7320 2323 2323  el problems ####
+00071580: 230d 0a20 2020 2020 2020 2020 2020 206d  #..            m
+00071590: 756c 7469 5f6c 6162 656c 203d 2046 616c  ulti_label = Fal
+000715a0: 7365 0d0a 2020 2020 2020 2020 2020 2020  se..            
+000715b0: 6966 2069 7369 6e73 7461 6e63 6528 6163  if isinstance(ac
+000715c0: 7475 616c 732c 7064 2e53 6572 6965 7329  tuals,pd.Series)
+000715d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000715e0: 2020 2063 6f6c 7320 3d20 5b61 6374 7561     cols = [actua
+000715f0: 6c73 2e6e 616d 655d 0d0a 2020 2020 2020  ls.name]..      
+00071600: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00071610: 7461 6e63 6528 6163 7475 616c 732c 7064  tance(actuals,pd
+00071620: 2e44 6174 6146 7261 6d65 293a 0d0a 2020  .DataFrame):..  
+00071630: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00071640: 6c73 203d 2061 6374 7561 6c73 2e63 6f6c  ls = actuals.col
+00071650: 756d 6e73 2e74 6f6c 6973 7428 290d 0a20  umns.tolist().. 
+00071660: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00071670: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00071680: 2020 636f 6c73 203d 205b 2774 6172 6765    cols = ['targe
+00071690: 745f 3127 5d0d 0a20 2020 2065 6c73 653a  t_1']..    else:
+000716a0: 0d0a 2020 2020 2020 2020 636f 6c73 203d  ..        cols =
+000716b0: 2063 6f70 792e 6465 6570 636f 7079 2874   copy.deepcopy(t
+000716c0: 6172 6765 7473 290d 0a20 2020 2020 2020  argets)..       
+000716d0: 2069 6620 6973 696e 7374 616e 6365 2874   if isinstance(t
+000716e0: 6172 6765 7473 2c20 7374 7229 3a0d 0a20  argets, str):.. 
+000716f0: 2020 2020 2020 2020 2020 2063 6f6c 7320             cols 
+00071700: 3d20 5b74 6172 6765 7473 5d0d 0a20 2020  = [targets]..   
+00071710: 2020 2020 2069 6620 6c65 6e28 636f 6c73       if len(cols
+00071720: 2920 3d3d 2031 3a0d 0a20 2020 2020 2020  ) == 1:..       
+00071730: 2020 2020 206d 756c 7469 5f6c 6162 656c       multi_label
+00071740: 203d 2046 616c 7365 0d0a 2020 2020 2020   = False..      
+00071750: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00071760: 2020 2020 206d 756c 7469 5f6c 6162 656c       multi_label
+00071770: 203d 2054 7275 650d 0a20 2020 2074 7279   = True..    try
+00071780: 3a0d 0a20 2020 2020 2020 2070 6c6f 745f  :..        plot_
+00071790: 7265 6772 6573 7369 6f6e 5f73 6361 7474  regression_scatt
+000717a0: 6572 7328 6163 7475 616c 732c 7072 6564  ers(actuals,pred
+000717b0: 6963 7465 642c 636f 6c73 2c70 6c6f 745f  icted,cols,plot_
+000717c0: 6e61 6d65 3d70 6c6f 745f 6e61 6d65 290d  name=plot_name).
+000717d0: 0a20 2020 2065 7863 6570 743a 0d0a 2020  .    except:..  
+000717e0: 2020 2020 2020 7072 696e 7428 2743 6f75        print('Cou
+000717f0: 6c64 206e 6f74 2064 7261 7720 7265 6772  ld not draw regr
+00071800: 6573 7369 6f6e 2070 6c6f 7420 6275 7420  ession plot but 
+00071810: 636f 6e74 696e 7569 6e67 2e2e 2e27 290d  continuing...').
+00071820: 0a20 2020 2069 6620 6d75 6c74 695f 6c61  .    if multi_la
+00071830: 6265 6c3a 0d0a 2020 2020 2020 2020 666f  bel:..        fo
+00071840: 7220 6920 696e 2072 616e 6765 2861 6374  r i in range(act
+00071850: 7561 6c73 2e73 6861 7065 5b31 5d29 3a0d  uals.shape[1]):.
+00071860: 0a20 2020 2020 2020 2020 2020 2061 6374  .            act
+00071870: 7561 6c73 5f78 203d 2061 6374 7561 6c73  uals_x = actuals
+00071880: 5b3a 2c69 5d0d 0a20 2020 2020 2020 2020  [:,i]..         
+00071890: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+000718a0: 2020 2020 2020 2020 2070 7265 6469 6374           predict
+000718b0: 6564 5f78 203d 2070 7265 6469 6374 6564  ed_x = predicted
+000718c0: 5b3a 2c69 5d0d 0a20 2020 2020 2020 2020  [:,i]..         
+000718d0: 2020 2065 7863 6570 743a 0d0a 2020 2020     except:..    
+000718e0: 2020 2020 2020 2020 2020 2020 7072 6564              pred
+000718f0: 6963 7465 645f 7820 3d20 7072 6564 6963  icted_x = predic
+00071900: 7465 645b 3a5d 0d0a 2020 2020 2020 2020  ted[:]..        
+00071910: 2020 2020 7072 696e 7428 2752 6567 7265      print('Regre
+00071920: 7373 696f 6e20 4d65 7472 6963 7320 666f  ssion Metrics fo
+00071930: 7220 5461 7267 6574 3d25 7327 2025 636f  r Target=%s' %co
+00071940: 6c73 5b69 5d29 0d0a 2020 2020 2020 2020  ls[i])..        
+00071950: 2020 2020 6d61 652c 206d 6165 5f61 7370      mae, mae_asp
+00071960: 2c20 726d 7365 5f61 7370 203d 2070 7269  , rmse_asp = pri
+00071970: 6e74 5f72 6567 7265 7373 696f 6e5f 6d65  nt_regression_me
+00071980: 7472 6963 7328 6163 7475 616c 735f 782c  trics(actuals_x,
+00071990: 2070 7265 6469 6374 6564 5f78 290d 0a20   predicted_x).. 
+000719a0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+000719b0: 2020 6d61 652c 206d 6165 5f61 7370 2c20    mae, mae_asp, 
+000719c0: 726d 7365 5f61 7370 203d 2070 7269 6e74  rmse_asp = print
+000719d0: 5f72 6567 7265 7373 696f 6e5f 6d65 7472  _regression_metr
+000719e0: 6963 7328 6163 7475 616c 732c 2070 7265  ics(actuals, pre
+000719f0: 6469 6374 6564 290d 0a20 2020 2072 6574  dicted)..    ret
+00071a00: 7572 6e20 6d61 652c 206d 6165 5f61 7370  urn mae, mae_asp
+00071a10: 2c20 726d 7365 5f61 7370 0d0a 2323 2323  , rmse_asp..####
+00071a20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00071a30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00071a40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00071a50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071a60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071a70: 2323 2323 2323 2323 2323 230d 0a64 6566  ###########..def
-00071a80: 2070 7269 6e74 5f72 6567 7265 7373 696f   print_regressio
-00071a90: 6e5f 6d65 7472 6963 7328 6163 7475 616c  n_metrics(actual
-00071aa0: 732c 2070 7265 6469 6374 6564 293a 0d0a  s, predicted):..
-00071ab0: 2020 2020 6d61 6520 3d20 6d65 616e 5f61      mae = mean_a
-00071ac0: 6273 6f6c 7574 655f 6572 726f 7228 6163  bsolute_error(ac
-00071ad0: 7475 616c 732c 2070 7265 6469 6374 6564  tuals, predicted
-00071ae0: 290d 0a20 2020 206d 6165 5f61 7370 203d  )..    mae_asp =
-00071af0: 2028 6d65 616e 5f61 6273 6f6c 7574 655f   (mean_absolute_
-00071b00: 6572 726f 7228 6163 7475 616c 732c 2070  error(actuals, p
-00071b10: 7265 6469 6374 6564 292f 6163 7475 616c  redicted)/actual
-00071b20: 732e 7374 6428 2929 2a31 3030 0d0a 2020  s.std())*100..  
-00071b30: 2020 726d 7365 5f61 7370 203d 2028 6e70    rmse_asp = (np
-00071b40: 2e73 7172 7428 6d65 616e 5f73 7175 6172  .sqrt(mean_squar
-00071b50: 6564 5f65 7272 6f72 2861 6374 7561 6c73  ed_error(actuals
-00071b60: 2c70 7265 6469 6374 6564 2929 2f61 6374  ,predicted))/act
-00071b70: 7561 6c73 2e73 7464 2829 292a 3130 300d  uals.std())*100.
-00071b80: 0a20 2020 2072 6d73 6520 3d20 7072 696e  .    rmse = prin
-00071b90: 745f 726d 7365 2861 6374 7561 6c73 2c20  t_rmse(actuals, 
-00071ba0: 7072 6564 6963 7465 6429 0d0a 2020 2020  predicted)..    
-00071bb0: 5f20 3d20 7072 696e 745f 6d61 7065 2861  _ = print_mape(a
-00071bc0: 6374 7561 6c73 2c20 7072 6564 6963 7465  ctuals, predicte
-00071bd0: 6429 0d0a 2020 2020 6d61 7065 203d 2070  d)..    mape = p
-00071be0: 7269 6e74 5f6d 6170 6528 6163 7475 616c  rint_mape(actual
-00071bf0: 732c 2070 7265 6469 6374 6564 290d 0a20  s, predicted).. 
-00071c00: 2020 2070 7269 6e74 2827 2020 2020 4d41     print('    MA
-00071c10: 4520 3d20 2530 2e34 6627 2025 6d61 6529  E = %0.4f' %mae)
-00071c20: 0d0a 2020 2020 7072 696e 7428 2220 2020  ..    print("   
-00071c30: 204d 4150 4520 3d20 2530 2e30 6625 2520   MAPE = %0.0f%% 
-00071c40: 284d 4150 4520 7769 6c6c 2062 6520 7665  (MAPE will be ve
-00071c50: 7279 2068 6967 6820 7768 656e 207a 6572  ry high when zer
-00071c60: 6f73 2069 6e20 6163 7475 616c 7329 2220  os in actuals)" 
-00071c70: 2528 6d61 7065 2929 0d0a 2020 2020 7072  %(mape))..    pr
-00071c80: 696e 7428 2720 2020 2052 4d53 4520 3d20  int('    RMSE = 
-00071c90: 2530 2e34 6627 2025 726d 7365 290d 0a20  %0.4f' %rmse).. 
-00071ca0: 2020 2070 7269 6e74 2827 2020 2020 4e6f     print('    No
-00071cb0: 726d 616c 697a 6564 204d 4145 2028 6173  rmalized MAE (as
-00071cc0: 2025 2520 7374 6420 6465 7620 6f66 2041   %% std dev of A
-00071cd0: 6374 7561 6c73 2920 3d20 2530 2e30 6625  ctuals) = %0.0f%
-00071ce0: 2527 2025 286d 6165 2f61 6273 2861 6374  %' %(mae/abs(act
-00071cf0: 7561 6c73 292e 7374 6428 292a 3130 3029  uals).std()*100)
-00071d00: 290d 0a20 2020 2023 204e 6f72 6d61 6c69  )..    # Normali
-00071d10: 7a65 6420 524d 5345 2070 7269 6e74 2827  zed RMSE print('
-00071d20: 524d 5345 203d 207b 3a2c 2e4f 667d 272e  RMSE = {:,.Of}'.
-00071d30: 666f 726d 6174 2872 6d73 6529 290d 0a20  format(rmse)).. 
-00071d40: 2020 2023 7072 696e 7428 2720 2020 204e     #print('    N
-00071d50: 6f72 6d61 6c69 7a65 6420 524d 5345 2028  ormalized RMSE (
-00071d60: 2525 206f 6620 4d69 6e4d 6178 206f 6620  %% of MinMax of 
-00071d70: 4163 7475 616c 7329 203d 2025 302e 3066  Actuals) = %0.0f
-00071d80: 2525 2720 2528 3130 302a 726d 7365 2f61  %%' %(100*rmse/a
-00071d90: 6273 2861 6374 7561 6c73 2e6d 6178 2829  bs(actuals.max()
-00071da0: 2d61 6374 7561 6c73 2e6d 696e 2829 2929  -actuals.min()))
-00071db0: 290d 0a20 2020 2070 7269 6e74 2827 2020  )..    print('  
-00071dc0: 2020 4e6f 726d 616c 697a 6564 2052 4d53    Normalized RMS
-00071dd0: 4520 2825 2520 6f66 2053 7464 2044 6576  E (%% of Std Dev
-00071de0: 206f 6620 4163 7475 616c 7329 203d 2025   of Actuals) = %
-00071df0: 302e 3066 2525 2720 2528 3130 302a 726d  0.0f%%' %(100*rm
-00071e00: 7365 2f61 6374 7561 6c73 2e73 7464 2829  se/actuals.std()
-00071e10: 2929 0d0a 2020 2020 7265 7475 726e 206d  ))..    return m
-00071e20: 6165 2c20 6d61 655f 6173 702c 2072 6d73  ae, mae_asp, rms
-00071e30: 655f 6173 700d 0a23 2323 2323 2323 2323  e_asp..#########
+00071a60: 2323 2323 2323 2323 2323 2323 0d0a 6465  ############..de
+00071a70: 6620 7072 696e 745f 7265 6772 6573 7369  f print_regressi
+00071a80: 6f6e 5f6d 6574 7269 6373 2861 6374 7561  on_metrics(actua
+00071a90: 6c73 2c20 7072 6564 6963 7465 6429 3a0d  ls, predicted):.
+00071aa0: 0a20 2020 206d 6165 203d 206d 6561 6e5f  .    mae = mean_
+00071ab0: 6162 736f 6c75 7465 5f65 7272 6f72 2861  absolute_error(a
+00071ac0: 6374 7561 6c73 2c20 7072 6564 6963 7465  ctuals, predicte
+00071ad0: 6429 0d0a 2020 2020 6d61 655f 6173 7020  d)..    mae_asp 
+00071ae0: 3d20 286d 6561 6e5f 6162 736f 6c75 7465  = (mean_absolute
+00071af0: 5f65 7272 6f72 2861 6374 7561 6c73 2c20  _error(actuals, 
+00071b00: 7072 6564 6963 7465 6429 2f61 6374 7561  predicted)/actua
+00071b10: 6c73 2e73 7464 2829 292a 3130 300d 0a20  ls.std())*100.. 
+00071b20: 2020 2072 6d73 655f 6173 7020 3d20 286e     rmse_asp = (n
+00071b30: 702e 7371 7274 286d 6561 6e5f 7371 7561  p.sqrt(mean_squa
+00071b40: 7265 645f 6572 726f 7228 6163 7475 616c  red_error(actual
+00071b50: 732c 7072 6564 6963 7465 6429 292f 6163  s,predicted))/ac
+00071b60: 7475 616c 732e 7374 6428 2929 2a31 3030  tuals.std())*100
+00071b70: 0d0a 2020 2020 726d 7365 203d 2070 7269  ..    rmse = pri
+00071b80: 6e74 5f72 6d73 6528 6163 7475 616c 732c  nt_rmse(actuals,
+00071b90: 2070 7265 6469 6374 6564 290d 0a20 2020   predicted)..   
+00071ba0: 205f 203d 2070 7269 6e74 5f6d 6170 6528   _ = print_mape(
+00071bb0: 6163 7475 616c 732c 2070 7265 6469 6374  actuals, predict
+00071bc0: 6564 290d 0a20 2020 206d 6170 6520 3d20  ed)..    mape = 
+00071bd0: 7072 696e 745f 6d61 7065 2861 6374 7561  print_mape(actua
+00071be0: 6c73 2c20 7072 6564 6963 7465 6429 0d0a  ls, predicted)..
+00071bf0: 2020 2020 7072 696e 7428 2720 2020 204d      print('    M
+00071c00: 4145 203d 2025 302e 3466 2720 256d 6165  AE = %0.4f' %mae
+00071c10: 290d 0a20 2020 2070 7269 6e74 2822 2020  )..    print("  
+00071c20: 2020 4d41 5045 203d 2025 302e 3066 2525    MAPE = %0.0f%%
+00071c30: 2028 4d41 5045 2077 696c 6c20 6265 2076   (MAPE will be v
+00071c40: 6572 7920 6869 6768 2077 6865 6e20 7a65  ery high when ze
+00071c50: 726f 7320 696e 2061 6374 7561 6c73 2922  ros in actuals)"
+00071c60: 2025 286d 6170 6529 290d 0a20 2020 2070   %(mape))..    p
+00071c70: 7269 6e74 2827 2020 2020 524d 5345 203d  rint('    RMSE =
+00071c80: 2025 302e 3466 2720 2572 6d73 6529 0d0a   %0.4f' %rmse)..
+00071c90: 2020 2020 7072 696e 7428 2720 2020 204e      print('    N
+00071ca0: 6f72 6d61 6c69 7a65 6420 4d41 4520 2861  ormalized MAE (a
+00071cb0: 7320 2525 2073 7464 2064 6576 206f 6620  s %% std dev of 
+00071cc0: 4163 7475 616c 7329 203d 2025 302e 3066  Actuals) = %0.0f
+00071cd0: 2525 2720 2528 6d61 652f 6162 7328 6163  %%' %(mae/abs(ac
+00071ce0: 7475 616c 7329 2e73 7464 2829 2a31 3030  tuals).std()*100
+00071cf0: 2929 0d0a 2020 2020 2320 4e6f 726d 616c  ))..    # Normal
+00071d00: 697a 6564 2052 4d53 4520 7072 696e 7428  ized RMSE print(
+00071d10: 2752 4d53 4520 3d20 7b3a 2c2e 4f66 7d27  'RMSE = {:,.Of}'
+00071d20: 2e66 6f72 6d61 7428 726d 7365 2929 0d0a  .format(rmse))..
+00071d30: 2020 2020 2370 7269 6e74 2827 2020 2020      #print('    
+00071d40: 4e6f 726d 616c 697a 6564 2052 4d53 4520  Normalized RMSE 
+00071d50: 2825 2520 6f66 204d 696e 4d61 7820 6f66  (%% of MinMax of
+00071d60: 2041 6374 7561 6c73 2920 3d20 2530 2e30   Actuals) = %0.0
+00071d70: 6625 2527 2025 2831 3030 2a72 6d73 652f  f%%' %(100*rmse/
+00071d80: 6162 7328 6163 7475 616c 732e 6d61 7828  abs(actuals.max(
+00071d90: 292d 6163 7475 616c 732e 6d69 6e28 2929  )-actuals.min())
+00071da0: 2929 0d0a 2020 2020 7072 696e 7428 2720  ))..    print(' 
+00071db0: 2020 204e 6f72 6d61 6c69 7a65 6420 524d     Normalized RM
+00071dc0: 5345 2028 2525 206f 6620 5374 6420 4465  SE (%% of Std De
+00071dd0: 7620 6f66 2041 6374 7561 6c73 2920 3d20  v of Actuals) = 
+00071de0: 2530 2e30 6625 2527 2025 2831 3030 2a72  %0.0f%%' %(100*r
+00071df0: 6d73 652f 6163 7475 616c 732e 7374 6428  mse/actuals.std(
+00071e00: 2929 290d 0a20 2020 2072 6574 7572 6e20  )))..    return 
+00071e10: 6d61 652c 206d 6165 5f61 7370 2c20 726d  mae, mae_asp, rm
+00071e20: 7365 5f61 7370 0d0a 2323 2323 2323 2323  se_asp..########
+00071e30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00071e40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00071e50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00071e60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071e70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00071e80: 2323 2323 2323 230d 0a64 6566 2070 7269  #######..def pri
-00071e90: 6e74 5f73 7461 7469 635f 726d 7365 2861  nt_static_rmse(a
-00071ea0: 6374 7561 6c2c 2070 7265 6469 6374 6564  ctual, predicted
-00071eb0: 2c20 7374 6172 745f 6672 6f6d 3d30 2c76  , start_from=0,v
-00071ec0: 6572 626f 7365 3d30 293a 0d0a 2020 2020  erbose=0):..    
-00071ed0: 2222 220d 0a20 2020 2074 6869 7320 6361  """..    this ca
-00071ee0: 6c63 756c 6174 6573 2074 6865 2072 6174  lculates the rat
-00071ef0: 696f 206f 6620 7468 6520 726d 7365 2065  io of the rmse e
-00071f00: 7272 6f72 2074 6f20 7468 6520 7374 616e  rror to the stan
-00071f10: 6461 7264 2064 6576 6961 7469 6f6e 206f  dard deviation o
-00071f20: 6620 7468 6520 6163 7475 616c 732e 0d0a  f the actuals...
-00071f30: 2020 2020 5468 6973 2072 6174 696f 2073      This ratio s
-00071f40: 686f 756c 6420 6265 2062 656c 6f77 2031  hould be below 1
-00071f50: 2066 6f72 2061 206d 6f64 656c 2074 6f20   for a model to 
-00071f60: 6265 2063 6f6e 7369 6465 7265 6420 7573  be considered us
-00071f70: 6566 756c 2e0d 0a20 2020 2054 6865 2063  eful...    The c
-00071f80: 6f6d 7061 7269 736f 6e20 7374 6172 7473  omparison starts
-00071f90: 2066 726f 6d20 7468 6520 726f 7720 696e   from the row in
-00071fa0: 6469 6361 7465 6420 696e 2074 6865 2022  dicated in the "
-00071fb0: 7374 6172 745f 6672 6f6d 2220 7661 7269  start_from" vari
-00071fc0: 6162 6c65 2e0d 0a20 2020 2022 2222 0d0a  able...    """..
-00071fd0: 2020 2020 726d 7365 203d 206e 702e 7371      rmse = np.sq
-00071fe0: 7274 286d 6561 6e5f 7371 7561 7265 645f  rt(mean_squared_
-00071ff0: 6572 726f 7228 6163 7475 616c 5b73 7461  error(actual[sta
-00072000: 7274 5f66 726f 6d3a 5d2c 7072 6564 6963  rt_from:],predic
-00072010: 7465 645b 7374 6172 745f 6672 6f6d 3a5d  ted[start_from:]
-00072020: 2929 0d0a 2020 2020 7374 645f 6465 7620  ))..    std_dev 
-00072030: 3d20 6163 7475 616c 5b73 7461 7274 5f66  = actual[start_f
-00072040: 726f 6d3a 5d2e 7374 6428 290d 0a20 2020  rom:].std()..   
-00072050: 2069 6620 7665 7262 6f73 6520 3e3d 2031   if verbose >= 1
-00072060: 3a0d 0a20 2020 2020 2020 2070 7269 6e74  :..        print
-00072070: 2827 2020 2020 524d 5345 203d 2025 302e  ('    RMSE = %0.
-00072080: 3266 2720 2572 6d73 6529 0d0a 2020 2020  2f' %rmse)..    
-00072090: 2020 2020 7072 696e 7428 2720 2020 2053      print('    S
-000720a0: 7464 2044 6576 6961 7469 6f6e 206f 6620  td Deviation of 
-000720b0: 4163 7475 616c 7320 3d20 2530 2e32 6627  Actuals = %0.2f'
-000720c0: 2025 2873 7464 5f64 6576 2929 0d0a 2020   %(std_dev))..  
-000720d0: 2020 2020 2020 7072 696e 7428 2720 2020        print('   
-000720e0: 204e 6f72 6d61 6c69 7a65 6420 524d 5345   Normalized RMSE
-000720f0: 203d 2025 302e 3166 2525 2720 2528 726d   = %0.1f%%' %(rm
-00072100: 7365 2a31 3030 2f73 7464 5f64 6576 2929  se*100/std_dev))
-00072110: 0d0a 2020 2020 7265 7475 726e 2072 6d73  ..    return rms
-00072120: 652c 2072 6d73 652f 7374 645f 6465 760d  e, rmse/std_dev.
-00072130: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
+00071e70: 2323 2323 2323 2323 0d0a 6465 6620 7072  ########..def pr
+00071e80: 696e 745f 7374 6174 6963 5f72 6d73 6528  int_static_rmse(
+00071e90: 6163 7475 616c 2c20 7072 6564 6963 7465  actual, predicte
+00071ea0: 642c 2073 7461 7274 5f66 726f 6d3d 302c  d, start_from=0,
+00071eb0: 7665 7262 6f73 653d 3029 3a0d 0a20 2020  verbose=0):..   
+00071ec0: 2022 2222 0d0a 2020 2020 7468 6973 2063   """..    this c
+00071ed0: 616c 6375 6c61 7465 7320 7468 6520 7261  alculates the ra
+00071ee0: 7469 6f20 6f66 2074 6865 2072 6d73 6520  tio of the rmse 
+00071ef0: 6572 726f 7220 746f 2074 6865 2073 7461  error to the sta
+00071f00: 6e64 6172 6420 6465 7669 6174 696f 6e20  ndard deviation 
+00071f10: 6f66 2074 6865 2061 6374 7561 6c73 2e0d  of the actuals..
+00071f20: 0a20 2020 2054 6869 7320 7261 7469 6f20  .    This ratio 
+00071f30: 7368 6f75 6c64 2062 6520 6265 6c6f 7720  should be below 
+00071f40: 3120 666f 7220 6120 6d6f 6465 6c20 746f  1 for a model to
+00071f50: 2062 6520 636f 6e73 6964 6572 6564 2075   be considered u
+00071f60: 7365 6675 6c2e 0d0a 2020 2020 5468 6520  seful...    The 
+00071f70: 636f 6d70 6172 6973 6f6e 2073 7461 7274  comparison start
+00071f80: 7320 6672 6f6d 2074 6865 2072 6f77 2069  s from the row i
+00071f90: 6e64 6963 6174 6564 2069 6e20 7468 6520  ndicated in the 
+00071fa0: 2273 7461 7274 5f66 726f 6d22 2076 6172  "start_from" var
+00071fb0: 6961 626c 652e 0d0a 2020 2020 2222 220d  iable...    """.
+00071fc0: 0a20 2020 2072 6d73 6520 3d20 6e70 2e73  .    rmse = np.s
+00071fd0: 7172 7428 6d65 616e 5f73 7175 6172 6564  qrt(mean_squared
+00071fe0: 5f65 7272 6f72 2861 6374 7561 6c5b 7374  _error(actual[st
+00071ff0: 6172 745f 6672 6f6d 3a5d 2c70 7265 6469  art_from:],predi
+00072000: 6374 6564 5b73 7461 7274 5f66 726f 6d3a  cted[start_from:
+00072010: 5d29 290d 0a20 2020 2073 7464 5f64 6576  ]))..    std_dev
+00072020: 203d 2061 6374 7561 6c5b 7374 6172 745f   = actual[start_
+00072030: 6672 6f6d 3a5d 2e73 7464 2829 0d0a 2020  from:].std()..  
+00072040: 2020 6966 2076 6572 626f 7365 203e 3d20    if verbose >= 
+00072050: 313a 0d0a 2020 2020 2020 2020 7072 696e  1:..        prin
+00072060: 7428 2720 2020 2052 4d53 4520 3d20 2530  t('    RMSE = %0
+00072070: 2e32 6627 2025 726d 7365 290d 0a20 2020  .2f' %rmse)..   
+00072080: 2020 2020 2070 7269 6e74 2827 2020 2020       print('    
+00072090: 5374 6420 4465 7669 6174 696f 6e20 6f66  Std Deviation of
+000720a0: 2041 6374 7561 6c73 203d 2025 302e 3266   Actuals = %0.2f
+000720b0: 2720 2528 7374 645f 6465 7629 290d 0a20  ' %(std_dev)).. 
+000720c0: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
+000720d0: 2020 4e6f 726d 616c 697a 6564 2052 4d53    Normalized RMS
+000720e0: 4520 3d20 2530 2e31 6625 2527 2025 2872  E = %0.1f%%' %(r
+000720f0: 6d73 652a 3130 302f 7374 645f 6465 7629  mse*100/std_dev)
+00072100: 290d 0a20 2020 2072 6574 7572 6e20 726d  )..    return rm
+00072110: 7365 2c20 726d 7365 2f73 7464 5f64 6576  se, rmse/std_dev
+00072120: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+00072130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00072140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00072150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00072160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072180: 230d 0a66 726f 6d20 736b 6c65 6172 6e2e  #..from sklearn.
-00072190: 6d65 7472 6963 7320 696d 706f 7274 206d  metrics import m
-000721a0: 6561 6e5f 7371 7561 7265 645f 6572 726f  ean_squared_erro
-000721b0: 722c 6d65 616e 5f61 6273 6f6c 7574 655f  r,mean_absolute_
-000721c0: 6572 726f 720d 0a64 6566 2070 7269 6e74  error..def print
-000721d0: 5f72 6d73 6528 792c 2079 5f68 6174 293a  _rmse(y, y_hat):
-000721e0: 0d0a 2020 2020 2222 220d 0a20 2020 2043  ..    """..    C
-000721f0: 616c 6375 6c61 7469 6e67 2052 6f6f 7420  alculating Root 
-00072200: 4d65 616e 2053 7175 6172 6520 4572 726f  Mean Square Erro
-00072210: 7220 6874 7470 733a 2f2f 656e 2e77 696b  r https://en.wik
-00072220: 6970 6564 6961 2e6f 7267 2f77 696b 692f  ipedia.org/wiki/
-00072230: 526f 6f74 2d6d 6561 6e2d 7371 7561 7265  Root-mean-square
-00072240: 5f64 6576 6961 7469 6f6e 0d0a 2020 2020  _deviation..    
-00072250: 2222 220d 0a20 2020 206d 7365 203d 206e  """..    mse = n
-00072260: 702e 6d65 616e 2828 7920 2d20 795f 6861  p.mean((y - y_ha
-00072270: 7429 2a2a 3229 0d0a 2020 2020 7265 7475  t)**2)..    retu
-00072280: 726e 206e 702e 7371 7274 286d 7365 290d  rn np.sqrt(mse).
-00072290: 0a0d 0a64 6566 2070 7269 6e74 5f6d 6170  ...def print_map
-000722a0: 6528 792c 2079 5f68 6174 293a 0d0a 2020  e(y, y_hat):..  
-000722b0: 2020 2222 220d 0a20 2020 2043 616c 6375    """..    Calcu
-000722c0: 6c61 7469 6e67 204d 6561 6e20 4162 736f  lating Mean Abso
-000722d0: 6c75 7465 2050 6572 6365 6e74 2045 7272  lute Percent Err
-000722e0: 6f72 2068 7474 7073 3a2f 2f65 6e2e 7769  or https://en.wi
-000722f0: 6b69 7065 6469 612e 6f72 672f 7769 6b69  kipedia.org/wiki
-00072300: 2f4d 6561 6e5f 6162 736f 6c75 7465 5f70  /Mean_absolute_p
-00072310: 6572 6365 6e74 6167 655f 6572 726f 720d  ercentage_error.
-00072320: 0a20 2020 2054 6f20 6176 6f69 6420 696e  .    To avoid in
-00072330: 6669 6e69 7479 2064 7565 2074 6f20 6469  finity due to di
-00072340: 7669 7369 6f6e 2062 7920 7a65 726f 2c20  vision by zero, 
-00072350: 7765 2073 656c 6563 7420 6d61 7828 302e  we select max(0.
-00072360: 3031 2c20 6162 7328 6163 7475 616c 7329  01, abs(actuals)
-00072370: 2920 746f 2073 686f 7720 4d41 5045 2e0d  ) to show MAPE..
-00072380: 0a20 2020 2022 2222 0d0a 2020 2020 2323  .    """..    ##
-00072390: 2320 5768 6572 6576 6572 2074 6865 7265  # Wherever there
-000723a0: 2069 7320 7a65 726f 2c20 7265 706c 6163   is zero, replac
-000723b0: 6520 6974 2077 6974 6820 302e 3030 3120  e it with 0.001 
-000723c0: 736f 2069 7420 646f 6573 6e27 7420 7265  so it doesn't re
-000723d0: 7375 6c74 2069 6e20 6469 7669 7369 6f6e  sult in division
-000723e0: 2062 7920 7a65 726f 0d0a 2020 2020 7065   by zero..    pe
-000723f0: 7263 5f65 7272 203d 2028 3130 302a 286e  rc_err = (100*(n
-00072400: 702e 7768 6572 6528 793d 3d30 2c30 2e30  p.where(y==0,0.0
-00072410: 3031 2c79 2920 2d20 795f 6861 7429 292f  01,y) - y_hat))/
-00072420: 6e70 2e77 6865 7265 2879 3d3d 302c 302e  np.where(y==0,0.
-00072430: 3030 312c 7929 0d0a 2020 2020 7265 7475  001,y)..    retu
-00072440: 726e 206e 702e 6d65 616e 2861 6273 2870  rn np.mean(abs(p
-00072450: 6572 635f 6572 7229 290d 0a23 2323 2323  erc_err))..#####
+00072170: 2323 0d0a 6672 6f6d 2073 6b6c 6561 726e  ##..from sklearn
+00072180: 2e6d 6574 7269 6373 2069 6d70 6f72 7420  .metrics import 
+00072190: 6d65 616e 5f73 7175 6172 6564 5f65 7272  mean_squared_err
+000721a0: 6f72 2c6d 6561 6e5f 6162 736f 6c75 7465  or,mean_absolute
+000721b0: 5f65 7272 6f72 0d0a 6465 6620 7072 696e  _error..def prin
+000721c0: 745f 726d 7365 2879 2c20 795f 6861 7429  t_rmse(y, y_hat)
+000721d0: 3a0d 0a20 2020 2022 2222 0d0a 2020 2020  :..    """..    
+000721e0: 4361 6c63 756c 6174 696e 6720 526f 6f74  Calculating Root
+000721f0: 204d 6561 6e20 5371 7561 7265 2045 7272   Mean Square Err
+00072200: 6f72 2068 7474 7073 3a2f 2f65 6e2e 7769  or https://en.wi
+00072210: 6b69 7065 6469 612e 6f72 672f 7769 6b69  kipedia.org/wiki
+00072220: 2f52 6f6f 742d 6d65 616e 2d73 7175 6172  /Root-mean-squar
+00072230: 655f 6465 7669 6174 696f 6e0d 0a20 2020  e_deviation..   
+00072240: 2022 2222 0d0a 2020 2020 6d73 6520 3d20   """..    mse = 
+00072250: 6e70 2e6d 6561 6e28 2879 202d 2079 5f68  np.mean((y - y_h
+00072260: 6174 292a 2a32 290d 0a20 2020 2072 6574  at)**2)..    ret
+00072270: 7572 6e20 6e70 2e73 7172 7428 6d73 6529  urn np.sqrt(mse)
+00072280: 0d0a 0d0a 6465 6620 7072 696e 745f 6d61  ....def print_ma
+00072290: 7065 2879 2c20 795f 6861 7429 3a0d 0a20  pe(y, y_hat):.. 
+000722a0: 2020 2022 2222 0d0a 2020 2020 4361 6c63     """..    Calc
+000722b0: 756c 6174 696e 6720 4d65 616e 2041 6273  ulating Mean Abs
+000722c0: 6f6c 7574 6520 5065 7263 656e 7420 4572  olute Percent Er
+000722d0: 726f 7220 6874 7470 733a 2f2f 656e 2e77  ror https://en.w
+000722e0: 696b 6970 6564 6961 2e6f 7267 2f77 696b  ikipedia.org/wik
+000722f0: 692f 4d65 616e 5f61 6273 6f6c 7574 655f  i/Mean_absolute_
+00072300: 7065 7263 656e 7461 6765 5f65 7272 6f72  percentage_error
+00072310: 0d0a 2020 2020 546f 2061 766f 6964 2069  ..    To avoid i
+00072320: 6e66 696e 6974 7920 6475 6520 746f 2064  nfinity due to d
+00072330: 6976 6973 696f 6e20 6279 207a 6572 6f2c  ivision by zero,
+00072340: 2077 6520 7365 6c65 6374 206d 6178 2830   we select max(0
+00072350: 2e30 312c 2061 6273 2861 6374 7561 6c73  .01, abs(actuals
+00072360: 2929 2074 6f20 7368 6f77 204d 4150 452e  )) to show MAPE.
+00072370: 0d0a 2020 2020 2222 220d 0a20 2020 2023  ..    """..    #
+00072380: 2323 2057 6865 7265 7665 7220 7468 6572  ## Wherever ther
+00072390: 6520 6973 207a 6572 6f2c 2072 6570 6c61  e is zero, repla
+000723a0: 6365 2069 7420 7769 7468 2030 2e30 3031  ce it with 0.001
+000723b0: 2073 6f20 6974 2064 6f65 736e 2774 2072   so it doesn't r
+000723c0: 6573 756c 7420 696e 2064 6976 6973 696f  esult in divisio
+000723d0: 6e20 6279 207a 6572 6f0d 0a20 2020 2070  n by zero..    p
+000723e0: 6572 635f 6572 7220 3d20 2831 3030 2a28  erc_err = (100*(
+000723f0: 6e70 2e77 6865 7265 2879 3d3d 302c 302e  np.where(y==0,0.
+00072400: 3030 312c 7929 202d 2079 5f68 6174 2929  001,y) - y_hat))
+00072410: 2f6e 702e 7768 6572 6528 793d 3d30 2c30  /np.where(y==0,0
+00072420: 2e30 3031 2c79 290d 0a20 2020 2072 6574  .001,y)..    ret
+00072430: 7572 6e20 6e70 2e6d 6561 6e28 6162 7328  urn np.mean(abs(
+00072440: 7065 7263 5f65 7272 2929 0d0a 2323 2323  perc_err))..####
+00072450: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00072460: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00072470: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00072480: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072490: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000724a0: 2323 2323 2323 2323 2323 230d 0a66 726f  ###########..fro
-000724b0: 6d20 736b 6c65 6172 6e2e 6d65 7472 6963  m sklearn.metric
-000724c0: 7320 696d 706f 7274 206d 6561 6e5f 6162  s import mean_ab
-000724d0: 736f 6c75 7465 5f65 7272 6f72 2c20 6d65  solute_error, me
-000724e0: 616e 5f73 7175 6172 6564 5f65 7272 6f72  an_squared_error
-000724f0: 0d0a 6672 6f6d 2069 7465 7274 6f6f 6c73  ..from itertools
-00072500: 2069 6d70 6f72 7420 6379 636c 650d 0a69   import cycle..i
-00072510: 6d70 6f72 7420 6d61 7470 6c6f 746c 6962  mport matplotlib
-00072520: 2e70 7970 6c6f 7420 6173 2070 6c74 0d0a  .pyplot as plt..
-00072530: 6465 6620 706c 6f74 5f64 6670 6c6f 7428  def plot_dfplot(
-00072540: 6466 706c 6f74 2c70 6c6f 745f 7469 746c  dfplot,plot_titl
-00072550: 653d 2222 293a 0d0a 2020 2020 6669 6773  e=""):..    figs
-00072560: 697a 6520 3d20 2831 302c 2031 3029 0d0a  ize = (10, 10)..
-00072570: 2020 2020 636f 6c6f 7273 203d 2063 7963      colors = cyc
-00072580: 6c65 2827 6279 7263 6d67 6b62 7972 636d  le('byrcmgkbyrcm
-00072590: 676b 6279 7263 6d67 6b62 7972 636d 676b  gkbyrcmgkbyrcmgk
-000725a0: 2729 0d0a 2020 2020 706c 742e 6669 6775  ')..    plt.figu
-000725b0: 7265 2866 6967 7369 7a65 3d66 6967 7369  re(figsize=figsi
-000725c0: 7a65 290d 0a20 2020 2061 6374 7561 6c73  ze)..    actuals
-000725d0: 203d 2064 6670 6c6f 745b 2741 6374 7561   = dfplot['Actua
-000725e0: 6c73 275d 0d0a 2020 2020 7072 6564 6963  ls']..    predic
-000725f0: 7465 6420 3d20 2064 6670 6c6f 745b 2750  ted =  dfplot['P
-00072600: 7265 6469 6374 6564 275d 0d0a 2020 2020  redicted']..    
-00072610: 6c69 6e65 5374 6172 7420 3d20 6163 7475  lineStart = actu
-00072620: 616c 732e 6d69 6e28 290d 0a20 2020 206c  als.min()..    l
-00072630: 696e 6545 6e64 203d 2061 6374 7561 6c73  ineEnd = actuals
-00072640: 2e6d 6178 2829 0d0a 2020 2020 706c 742e  .max()..    plt.
-00072650: 7363 6174 7465 7228 6163 7475 616c 732c  scatter(actuals,
-00072660: 2070 7265 6469 6374 6564 2c20 636f 6c6f   predicted, colo
-00072670: 7220 3d20 6e65 7874 2863 6f6c 6f72 7329  r = next(colors)
-00072680: 2c20 616c 7068 613d 302e 352c 6c61 6265  , alpha=0.5,labe
-00072690: 6c3d 2750 7265 6469 6374 696f 6e73 2729  l='Predictions')
-000726a0: 0d0a 2020 2020 706c 742e 706c 6f74 285b  ..    plt.plot([
-000726b0: 6c69 6e65 5374 6172 742c 206c 696e 6545  lineStart, lineE
-000726c0: 6e64 5d2c 205b 6c69 6e65 5374 6172 742c  nd], [lineStart,
-000726d0: 206c 696e 6545 6e64 5d2c 2027 6b2d 272c   lineEnd], 'k-',
-000726e0: 2063 6f6c 6f72 203d 206e 6578 7428 636f   color = next(co
-000726f0: 6c6f 7273 2929 0d0a 2020 2020 706c 742e  lors))..    plt.
-00072700: 786c 696d 286c 696e 6553 7461 7274 2c20  xlim(lineStart, 
-00072710: 6c69 6e65 456e 6429 0d0a 2020 2020 706c  lineEnd)..    pl
-00072720: 742e 796c 696d 286c 696e 6553 7461 7274  t.ylim(lineStart
-00072730: 2c20 6c69 6e65 456e 6429 0d0a 2020 2020  , lineEnd)..    
-00072740: 706c 742e 786c 6162 656c 2827 4163 7475  plt.xlabel('Actu
-00072750: 616c 2729 0d0a 2020 2020 706c 742e 796c  al')..    plt.yl
-00072760: 6162 656c 2827 5072 6564 6963 7465 6427  abel('Predicted'
-00072770: 290d 0a20 2020 2070 6c74 2e6c 6567 656e  )..    plt.legen
-00072780: 6428 290d 0a20 2020 2070 6c74 2e74 6974  d()..    plt.tit
-00072790: 6c65 2827 5072 6564 6963 7465 6420 7673  le('Predicted vs
-000727a0: 2041 6374 7561 6c73 2066 6f72 2054 6172   Actuals for Tar
-000727b0: 6765 7420 3d20 2573 2720 2570 6c6f 745f  get = %s' %plot_
-000727c0: 7469 746c 652c 2066 6f6e 7473 697a 653d  title, fontsize=
-000727d0: 3132 290d 0a20 2020 2070 6c74 2e73 686f  12)..    plt.sho
-000727e0: 7728 293b 0d0a 2323 2323 2323 2323 2323  w();..##########
+00072490: 2323 2323 2323 2323 2323 2323 0d0a 6672  ############..fr
+000724a0: 6f6d 2073 6b6c 6561 726e 2e6d 6574 7269  om sklearn.metri
+000724b0: 6373 2069 6d70 6f72 7420 6d65 616e 5f61  cs import mean_a
+000724c0: 6273 6f6c 7574 655f 6572 726f 722c 206d  bsolute_error, m
+000724d0: 6561 6e5f 7371 7561 7265 645f 6572 726f  ean_squared_erro
+000724e0: 720d 0a66 726f 6d20 6974 6572 746f 6f6c  r..from itertool
+000724f0: 7320 696d 706f 7274 2063 7963 6c65 0d0a  s import cycle..
+00072500: 696d 706f 7274 206d 6174 706c 6f74 6c69  import matplotli
+00072510: 622e 7079 706c 6f74 2061 7320 706c 740d  b.pyplot as plt.
+00072520: 0a64 6566 2070 6c6f 745f 6466 706c 6f74  .def plot_dfplot
+00072530: 2864 6670 6c6f 742c 706c 6f74 5f74 6974  (dfplot,plot_tit
+00072540: 6c65 3d22 2229 3a0d 0a20 2020 2066 6967  le=""):..    fig
+00072550: 7369 7a65 203d 2028 3130 2c20 3130 290d  size = (10, 10).
+00072560: 0a20 2020 2063 6f6c 6f72 7320 3d20 6379  .    colors = cy
+00072570: 636c 6528 2762 7972 636d 676b 6279 7263  cle('byrcmgkbyrc
+00072580: 6d67 6b62 7972 636d 676b 6279 7263 6d67  mgkbyrcmgkbyrcmg
+00072590: 6b27 290d 0a20 2020 2070 6c74 2e66 6967  k')..    plt.fig
+000725a0: 7572 6528 6669 6773 697a 653d 6669 6773  ure(figsize=figs
+000725b0: 697a 6529 0d0a 2020 2020 6163 7475 616c  ize)..    actual
+000725c0: 7320 3d20 6466 706c 6f74 5b27 4163 7475  s = dfplot['Actu
+000725d0: 616c 7327 5d0d 0a20 2020 2070 7265 6469  als']..    predi
+000725e0: 6374 6564 203d 2020 6466 706c 6f74 5b27  cted =  dfplot['
+000725f0: 5072 6564 6963 7465 6427 5d0d 0a20 2020  Predicted']..   
+00072600: 206c 696e 6553 7461 7274 203d 2061 6374   lineStart = act
+00072610: 7561 6c73 2e6d 696e 2829 0d0a 2020 2020  uals.min()..    
+00072620: 6c69 6e65 456e 6420 3d20 6163 7475 616c  lineEnd = actual
+00072630: 732e 6d61 7828 290d 0a20 2020 2070 6c74  s.max()..    plt
+00072640: 2e73 6361 7474 6572 2861 6374 7561 6c73  .scatter(actuals
+00072650: 2c20 7072 6564 6963 7465 642c 2063 6f6c  , predicted, col
+00072660: 6f72 203d 206e 6578 7428 636f 6c6f 7273  or = next(colors
+00072670: 292c 2061 6c70 6861 3d30 2e35 2c6c 6162  ), alpha=0.5,lab
+00072680: 656c 3d27 5072 6564 6963 7469 6f6e 7327  el='Predictions'
+00072690: 290d 0a20 2020 2070 6c74 2e70 6c6f 7428  )..    plt.plot(
+000726a0: 5b6c 696e 6553 7461 7274 2c20 6c69 6e65  [lineStart, line
+000726b0: 456e 645d 2c20 5b6c 696e 6553 7461 7274  End], [lineStart
+000726c0: 2c20 6c69 6e65 456e 645d 2c20 276b 2d27  , lineEnd], 'k-'
+000726d0: 2c20 636f 6c6f 7220 3d20 6e65 7874 2863  , color = next(c
+000726e0: 6f6c 6f72 7329 290d 0a20 2020 2070 6c74  olors))..    plt
+000726f0: 2e78 6c69 6d28 6c69 6e65 5374 6172 742c  .xlim(lineStart,
+00072700: 206c 696e 6545 6e64 290d 0a20 2020 2070   lineEnd)..    p
+00072710: 6c74 2e79 6c69 6d28 6c69 6e65 5374 6172  lt.ylim(lineStar
+00072720: 742c 206c 696e 6545 6e64 290d 0a20 2020  t, lineEnd)..   
+00072730: 2070 6c74 2e78 6c61 6265 6c28 2741 6374   plt.xlabel('Act
+00072740: 7561 6c27 290d 0a20 2020 2070 6c74 2e79  ual')..    plt.y
+00072750: 6c61 6265 6c28 2750 7265 6469 6374 6564  label('Predicted
+00072760: 2729 0d0a 2020 2020 706c 742e 6c65 6765  ')..    plt.lege
+00072770: 6e64 2829 0d0a 2020 2020 706c 742e 7469  nd()..    plt.ti
+00072780: 746c 6528 2750 7265 6469 6374 6564 2076  tle('Predicted v
+00072790: 7320 4163 7475 616c 7320 666f 7220 5461  s Actuals for Ta
+000727a0: 7267 6574 203d 2025 7327 2025 706c 6f74  rget = %s' %plot
+000727b0: 5f74 6974 6c65 2c20 666f 6e74 7369 7a65  _title, fontsize
+000727c0: 3d31 3229 0d0a 2020 2020 706c 742e 7368  =12)..    plt.sh
+000727d0: 6f77 2829 3b0d 0a23 2323 2323 2323 2323  ow();..#########
+000727e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000727f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00072800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00072810: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072830: 2323 2323 230d 0a66 726f 6d20 636f 6c6c  #####..from coll
-00072840: 6563 7469 6f6e 7320 696d 706f 7274 2064  ections import d
-00072850: 6566 6175 6c74 6469 6374 0d0a 6465 6620  efaultdict..def 
-00072860: 7265 7475 726e 5f6c 6973 745f 6d61 7463  return_list_matc
-00072870: 6869 6e67 5f6b 6579 7328 6469 6374 6f2c  hing_keys(dicto,
-00072880: 6c69 7374 5f6b 6579 7329 3a0d 0a20 2020  list_keys):..   
-00072890: 2027 2727 5265 7475 726e 2061 206c 6973   '''Return a lis
-000728a0: 7420 6f66 2076 616c 7565 7320 6d61 7463  t of values matc
-000728b0: 6869 6e67 206b 6579 7320 696e 2061 2064  hing keys in a d
-000728c0: 6963 7469 6f6e 6172 790d 0a20 2020 2066  ictionary..    f
-000728d0: 726f 6d20 6120 6c69 7374 206f 6620 6b65  rom a list of ke
-000728e0: 7973 2e20 5265 7475 726e 7320 5661 6c75  ys. Returns Valu
-000728f0: 6573 2069 6e20 7468 6520 5361 6d65 206f  es in the Same o
-00072900: 7264 6572 2061 7320 7468 6520 4c69 7374  rder as the List
-00072910: 204b 6579 732e 0d0a 2020 2020 2727 270d   Keys...    '''.
-00072920: 0a20 2020 2072 6573 756c 7473 203d 205b  .    results = [
-00072930: 5d0d 0a20 2020 2066 6f72 2065 6163 6820  ]..    for each 
-00072940: 696e 206c 6973 745f 6b65 7973 3a0d 0a20  in list_keys:.. 
-00072950: 2020 2020 2020 2072 6573 756c 7473 2e61         results.a
-00072960: 7070 656e 6428 6469 6374 6f5b 6561 6368  ppend(dicto[each
-00072970: 5d29 0d0a 2020 2020 7265 7475 726e 2072  ])..    return r
-00072980: 6573 756c 7473 0d0a 2323 2323 2323 2323  esults..########
+00072820: 2323 2323 2323 0d0a 6672 6f6d 2063 6f6c  ######..from col
+00072830: 6c65 6374 696f 6e73 2069 6d70 6f72 7420  lections import 
+00072840: 6465 6661 756c 7464 6963 740d 0a64 6566  defaultdict..def
+00072850: 2072 6574 7572 6e5f 6c69 7374 5f6d 6174   return_list_mat
+00072860: 6368 696e 675f 6b65 7973 2864 6963 746f  ching_keys(dicto
+00072870: 2c6c 6973 745f 6b65 7973 293a 0d0a 2020  ,list_keys):..  
+00072880: 2020 2727 2752 6574 7572 6e20 6120 6c69    '''Return a li
+00072890: 7374 206f 6620 7661 6c75 6573 206d 6174  st of values mat
+000728a0: 6368 696e 6720 6b65 7973 2069 6e20 6120  ching keys in a 
+000728b0: 6469 6374 696f 6e61 7279 0d0a 2020 2020  dictionary..    
+000728c0: 6672 6f6d 2061 206c 6973 7420 6f66 206b  from a list of k
+000728d0: 6579 732e 2052 6574 7572 6e73 2056 616c  eys. Returns Val
+000728e0: 7565 7320 696e 2074 6865 2053 616d 6520  ues in the Same 
+000728f0: 6f72 6465 7220 6173 2074 6865 204c 6973  order as the Lis
+00072900: 7420 4b65 7973 2e0d 0a20 2020 2027 2727  t Keys...    '''
+00072910: 0d0a 2020 2020 7265 7375 6c74 7320 3d20  ..    results = 
+00072920: 5b5d 0d0a 2020 2020 666f 7220 6561 6368  []..    for each
+00072930: 2069 6e20 6c69 7374 5f6b 6579 733a 0d0a   in list_keys:..
+00072940: 2020 2020 2020 2020 7265 7375 6c74 732e          results.
+00072950: 6170 7065 6e64 2864 6963 746f 5b65 6163  append(dicto[eac
+00072960: 685d 290d 0a20 2020 2072 6574 7572 6e20  h])..    return 
+00072970: 7265 7375 6c74 730d 0a23 2323 2323 2323  results..#######
+00072980: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00072990: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000729a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000729b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000729c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000729d0: 2323 2323 2323 2323 2323 0d0a 6465 6620  ##########..def 
-000729e0: 7265 6d6f 7665 5f68 6967 686c 795f 636f  remove_highly_co
-000729f0: 7272 656c 6174 6564 5f76 6172 735f 6661  rrelated_vars_fa
-00072a00: 7374 2864 662c 2063 6f72 725f 6c69 6d69  st(df, corr_limi
-00072a10: 743d 302e 3730 293a 0d0a 2020 2020 2222  t=0.70):..    ""
-00072a20: 220d 0a20 2020 2054 6869 7320 6973 2061  "..    This is a
-00072a30: 2073 696d 706c 6520 6d65 7468 6f64 2074   simple method t
-00072a40: 6f20 7265 6d6f 7665 2068 6967 686c 7920  o remove highly 
-00072a50: 636f 7272 656c 6174 6564 2066 6561 7475  correlated featu
-00072a60: 7265 7320 6661 7374 2075 7369 6e67 2050  res fast using P
-00072a70: 6561 7273 6f6e 2773 2043 6f72 7265 6c61  earson's Correla
-00072a80: 7469 6f6e 2e0d 0a20 2020 2055 7365 2074  tion...    Use t
-00072a90: 6869 7320 6f6e 6c79 2066 6f72 2066 6c6f  his only for flo
-00072aa0: 6174 2061 6e64 2069 6e74 6567 6572 2076  at and integer v
-00072ab0: 6172 6961 626c 6573 2e20 4974 2077 696c  ariables. It wil
-00072ac0: 6c20 6175 746f 6d61 7469 6361 6c6c 7920  l automatically 
-00072ad0: 7365 6c65 6374 2074 686f 7365 206f 6e6c  select those onl
-00072ae0: 792e 0d0a 2020 2020 4974 2063 616e 2062  y...    It can b
-00072af0: 6520 7573 6564 2066 6f72 2076 6572 7920  e used for very 
-00072b00: 6c61 7267 6520 6461 7461 2073 6574 7320  large data sets 
-00072b10: 7768 6572 6520 6665 6174 7572 6577 697a  where featurewiz
-00072b20: 2068 6173 2074 726f 7562 6c65 2077 6974   has trouble wit
-00072b30: 6820 6d65 6d6f 7279 0d0a 2020 2020 2222  h memory..    ""
-00072b40: 220d 0a20 2020 2023 2043 7265 6174 696e  "..    # Creatin
-00072b50: 6720 636f 7272 656c 6174 696f 6e20 6d61  g correlation ma
-00072b60: 7472 6978 0d0a 2020 2020 636f 725f 6d61  trix..    cor_ma
-00072b70: 7472 6978 203d 2064 662e 636f 7272 2829  trix = df.corr()
-00072b80: 2e61 6273 2829 2e61 7374 7970 6528 6e70  .abs().astype(np
-00072b90: 2e66 6c6f 6174 3136 290d 0a20 2020 2023  .float16)..    #
-00072ba0: 2053 656c 6563 7469 6e67 2075 7070 6572   Selecting upper
-00072bb0: 2074 7269 616e 676c 6520 6f66 2063 6f72   triangle of cor
-00072bc0: 7265 6c61 7469 6f6e 206d 6174 7269 780d  relation matrix.
-00072bd0: 0a20 2020 2075 7070 6572 5f74 7269 203d  .    upper_tri =
-00072be0: 2063 6f72 5f6d 6174 7269 782e 7768 6572   cor_matrix.wher
-00072bf0: 6528 6e70 2e74 7269 7528 6e70 2e6f 6e65  e(np.triu(np.one
-00072c00: 7328 636f 725f 6d61 7472 6978 2e73 6861  s(cor_matrix.sha
-00072c10: 7065 292c 0d0a 2020 2020 2020 2020 2020  pe),..          
-00072c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00072c30: 2020 2020 2020 2020 6b3d 3129 2e61 7374          k=1).ast
-00072c40: 7970 6528 6e70 2e62 6f6f 6c29 290d 0a20  ype(np.bool)).. 
-00072c50: 2020 2023 2046 696e 6469 6e67 2069 6e64     # Finding ind
-00072c60: 6578 206f 6620 6665 6174 7572 6520 636f  ex of feature co
-00072c70: 6c75 6d6e 7320 7769 7468 2063 6f72 7265  lumns with corre
-00072c80: 6c61 7469 6f6e 2067 7265 6174 6572 2074  lation greater t
-00072c90: 6861 6e20 302e 3935 0d0a 2020 2020 746f  han 0.95..    to
-00072ca0: 5f64 726f 7020 3d20 5b63 6f6c 756d 6e20  _drop = [column 
-00072cb0: 666f 7220 636f 6c75 6d6e 2069 6e20 7570  for column in up
-00072cc0: 7065 725f 7472 692e 636f 6c75 6d6e 7320  per_tri.columns 
-00072cd0: 6966 2061 6e79 2875 7070 6572 5f74 7269  if any(upper_tri
-00072ce0: 5b63 6f6c 756d 6e5d 203e 2063 6f72 725f  [column] > corr_
-00072cf0: 6c69 6d69 7429 5d0d 0a20 2020 2070 7269  limit)]..    pri
-00072d00: 6e74 2829 3b0d 0a20 2020 2070 7269 6e74  nt();..    print
-00072d10: 2827 4869 6768 6c79 2063 6f72 7265 6c61  ('Highly correla
-00072d20: 7465 6420 636f 6c75 6d6e 7320 746f 2072  ted columns to r
-00072d30: 656d 6f76 653a 2025 7327 2025 746f 5f64  emove: %s' %to_d
-00072d40: 726f 7029 0d0a 2020 2020 7265 7475 726e  rop)..    return
-00072d50: 2074 6f5f 6472 6f70 0d0a 2323 2323 2323   to_drop..######
+000729c0: 2323 2323 2323 2323 2323 230d 0a64 6566  ###########..def
+000729d0: 2072 656d 6f76 655f 6869 6768 6c79 5f63   remove_highly_c
+000729e0: 6f72 7265 6c61 7465 645f 7661 7273 5f66  orrelated_vars_f
+000729f0: 6173 7428 6466 2c20 636f 7272 5f6c 696d  ast(df, corr_lim
+00072a00: 6974 3d30 2e37 3029 3a0d 0a20 2020 2022  it=0.70):..    "
+00072a10: 2222 0d0a 2020 2020 5468 6973 2069 7320  ""..    This is 
+00072a20: 6120 7369 6d70 6c65 206d 6574 686f 6420  a simple method 
+00072a30: 746f 2072 656d 6f76 6520 6869 6768 6c79  to remove highly
+00072a40: 2063 6f72 7265 6c61 7465 6420 6665 6174   correlated feat
+00072a50: 7572 6573 2066 6173 7420 7573 696e 6720  ures fast using 
+00072a60: 5065 6172 736f 6e27 7320 436f 7272 656c  Pearson's Correl
+00072a70: 6174 696f 6e2e 0d0a 2020 2020 5573 6520  ation...    Use 
+00072a80: 7468 6973 206f 6e6c 7920 666f 7220 666c  this only for fl
+00072a90: 6f61 7420 616e 6420 696e 7465 6765 7220  oat and integer 
+00072aa0: 7661 7269 6162 6c65 732e 2049 7420 7769  variables. It wi
+00072ab0: 6c6c 2061 7574 6f6d 6174 6963 616c 6c79  ll automatically
+00072ac0: 2073 656c 6563 7420 7468 6f73 6520 6f6e   select those on
+00072ad0: 6c79 2e0d 0a20 2020 2049 7420 6361 6e20  ly...    It can 
+00072ae0: 6265 2075 7365 6420 666f 7220 7665 7279  be used for very
+00072af0: 206c 6172 6765 2064 6174 6120 7365 7473   large data sets
+00072b00: 2077 6865 7265 2066 6561 7475 7265 7769   where featurewi
+00072b10: 7a20 6861 7320 7472 6f75 626c 6520 7769  z has trouble wi
+00072b20: 7468 206d 656d 6f72 790d 0a20 2020 2022  th memory..    "
+00072b30: 2222 0d0a 2020 2020 2320 4372 6561 7469  ""..    # Creati
+00072b40: 6e67 2063 6f72 7265 6c61 7469 6f6e 206d  ng correlation m
+00072b50: 6174 7269 780d 0a20 2020 2063 6f72 5f6d  atrix..    cor_m
+00072b60: 6174 7269 7820 3d20 6466 2e63 6f72 7228  atrix = df.corr(
+00072b70: 292e 6162 7328 292e 6173 7479 7065 286e  ).abs().astype(n
+00072b80: 702e 666c 6f61 7431 3629 0d0a 2020 2020  p.float16)..    
+00072b90: 2320 5365 6c65 6374 696e 6720 7570 7065  # Selecting uppe
+00072ba0: 7220 7472 6961 6e67 6c65 206f 6620 636f  r triangle of co
+00072bb0: 7272 656c 6174 696f 6e20 6d61 7472 6978  rrelation matrix
+00072bc0: 0d0a 2020 2020 7570 7065 725f 7472 6920  ..    upper_tri 
+00072bd0: 3d20 636f 725f 6d61 7472 6978 2e77 6865  = cor_matrix.whe
+00072be0: 7265 286e 702e 7472 6975 286e 702e 6f6e  re(np.triu(np.on
+00072bf0: 6573 2863 6f72 5f6d 6174 7269 782e 7368  es(cor_matrix.sh
+00072c00: 6170 6529 2c0d 0a20 2020 2020 2020 2020  ape),..         
+00072c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00072c20: 2020 2020 2020 2020 206b 3d31 292e 6173           k=1).as
+00072c30: 7479 7065 286e 702e 626f 6f6c 2929 0d0a  type(np.bool))..
+00072c40: 2020 2020 2320 4669 6e64 696e 6720 696e      # Finding in
+00072c50: 6465 7820 6f66 2066 6561 7475 7265 2063  dex of feature c
+00072c60: 6f6c 756d 6e73 2077 6974 6820 636f 7272  olumns with corr
+00072c70: 656c 6174 696f 6e20 6772 6561 7465 7220  elation greater 
+00072c80: 7468 616e 2030 2e39 350d 0a20 2020 2074  than 0.95..    t
+00072c90: 6f5f 6472 6f70 203d 205b 636f 6c75 6d6e  o_drop = [column
+00072ca0: 2066 6f72 2063 6f6c 756d 6e20 696e 2075   for column in u
+00072cb0: 7070 6572 5f74 7269 2e63 6f6c 756d 6e73  pper_tri.columns
+00072cc0: 2069 6620 616e 7928 7570 7065 725f 7472   if any(upper_tr
+00072cd0: 695b 636f 6c75 6d6e 5d20 3e20 636f 7272  i[column] > corr
+00072ce0: 5f6c 696d 6974 295d 0d0a 2020 2020 7072  _limit)]..    pr
+00072cf0: 696e 7428 293b 0d0a 2020 2020 7072 696e  int();..    prin
+00072d00: 7428 2748 6967 686c 7920 636f 7272 656c  t('Highly correl
+00072d10: 6174 6564 2063 6f6c 756d 6e73 2074 6f20  ated columns to 
+00072d20: 7265 6d6f 7665 3a20 2573 2720 2574 6f5f  remove: %s' %to_
+00072d30: 6472 6f70 290d 0a20 2020 2072 6574 7572  drop)..    retur
+00072d40: 6e20 746f 5f64 726f 700d 0a23 2323 2323  n to_drop..#####
+00072d50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00072d60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00072d70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00072d80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00072d90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00072da0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-00072db0: 0a64 6566 2061 6464 5f65 6e74 726f 7079  .def add_entropy
-00072dc0: 5f62 696e 6e69 6e67 2874 656d 705f 7472  _binning(temp_tr
-00072dd0: 6169 6e2c 2074 6172 672c 206e 756d 5f76  ain, targ, num_v
-00072de0: 6172 732c 2069 6d70 6f72 7461 6e74 5f66  ars, important_f
-00072df0: 6561 7475 7265 732c 2074 656d 705f 7465  eatures, temp_te
-00072e00: 7374 2c0d 0a20 2020 2020 2020 2020 2020  st,..           
-00072e10: 2020 2020 2020 2020 2020 2020 6d6f 6465              mode
-00072e20: 6c74 7970 652c 2065 6e74 726f 7079 5f62  ltype, entropy_b
-00072e30: 696e 6e69 6e67 2c76 6572 626f 7365 3d30  inning,verbose=0
-00072e40: 293a 0d0a 2020 2020 2222 220d 0a20 2020  ):..    """..   
-00072e50: 2020 2020 2023 2323 2323 2320 2020 5468       ######   Th
-00072e60: 6973 2069 7320 7768 6572 6520 7765 2064  is is where we d
-00072e70: 6f20 454e 5452 4f50 5920 4249 4e4e 494e  o ENTROPY BINNIN
-00072e80: 4720 4f46 2043 4f4e 5449 4e55 4f55 5320  G OF CONTINUOUS 
-00072e90: 5641 5253 2023 2323 2323 2323 2323 2323  VARS ###########
-00072ea0: 0d0a 2020 2020 2020 2020 2323 2323 2049  ..        #### I
-00072eb0: 7420 6973 2062 6573 7420 746f 2064 6f20  t is best to do 
-00072ec0: 4269 6e6e 696e 6720 6f6e 204f 4e4c 5920  Binning on ONLY 
-00072ed0: 6f6e 2074 6865 2074 6f70 206d 6f73 7420  on the top most 
-00072ee0: 7661 7269 6162 6c65 7320 6672 6f6d 2049  variables from I
-00072ef0: 6d70 6f72 7461 6e74 5f46 6561 7475 7265  mportant_Feature
-00072f00: 7321 0d0a 2020 2020 2020 2020 2323 2323  s!..        ####
-00072f10: 204d 616b 6520 7375 7265 2074 6861 7420   Make sure that 
-00072f20: 7468 6520 546f 7020 322d 3130 2076 6172  the Top 2-10 var
-00072f30: 7320 6172 6520 616c 6c20 434f 4e54 494e  s are all CONTIN
-00072f40: 554f 5553 2056 4152 5321 204f 7468 6572  UOUS VARS! Other
-00072f50: 7769 7365 2042 696e 6e69 6e67 2069 7320  wise Binning is 
-00072f60: 5761 7374 6521 0d0a 2020 2020 2020 2020  Waste!..        
-00072f70: 2323 2323 2054 6869 7320 6d65 7468 6f64  #### This method
-00072f80: 2065 6e73 7572 6573 2079 6f75 2067 6574   ensures you get
-00072f90: 2074 6865 2042 6573 7420 5265 7375 6c74   the Best Result
-00072fa0: 7320 6279 2067 656e 6572 616c 697a 696e  s by generalizin
-00072fb0: 6720 6f6e 2074 6865 2074 6f70 206e 756d  g on the top num
-00072fc0: 6572 6963 2076 6172 7321 0d0a 2020 2020  eric vars!..    
-00072fd0: 2222 220d 0a20 2020 2074 656d 705f 7472  """..    temp_tr
-00072fe0: 6169 6e20 3d20 636f 7079 2e64 6565 7063  ain = copy.deepc
-00072ff0: 6f70 7928 7465 6d70 5f74 7261 696e 290d  opy(temp_train).
-00073000: 0a20 2020 2074 656d 705f 7465 7374 203d  .    temp_test =
-00073010: 2063 6f70 792e 6465 6570 636f 7079 2874   copy.deepcopy(t
-00073020: 656d 705f 7465 7374 290d 0a20 2020 206d  emp_test)..    m
-00073030: 6178 5f64 6570 7468 203d 2031 300d 0a20  ax_depth = 10.. 
-00073040: 2020 2073 6565 6420 3d20 3939 0d0a 2020     seed = 99..  
-00073050: 2020 6e75 6d5f 7661 7273 203d 2063 6f70    num_vars = cop
-00073060: 792e 6465 6570 636f 7079 286e 756d 5f76  y.deepcopy(num_v
-00073070: 6172 7329 0d0a 2020 2020 636f 6e74 696e  ars)..    contin
-00073080: 756f 7573 5f76 6172 7320 3d20 636f 7079  uous_vars = copy
-00073090: 2e64 6565 7063 6f70 7928 6e75 6d5f 7661  .deepcopy(num_va
-000730a0: 7273 290d 0a20 2020 2069 6d70 6f72 7461  rs)..    importa
-000730b0: 6e74 5f66 6561 7475 7265 7320 3d20 636f  nt_features = co
-000730c0: 7079 2e64 6565 7063 6f70 7928 696d 706f  py.deepcopy(impo
-000730d0: 7274 616e 745f 6665 6174 7572 6573 290d  rtant_features).
-000730e0: 0a20 2020 2070 7269 6e74 2827 4465 7465  .    print('Dete
-000730f0: 726d 696e 696e 6720 7768 6963 6820 6f66  rmining which of
-00073100: 2025 6420 636f 6e74 696e 756f 7573 2076   %d continuous v
-00073110: 6172 6961 626c 6573 2073 686f 756c 6420  ariables should 
-00073120: 6265 2045 6e74 726f 7079 2042 696e 6e65  be Entropy Binne
-00073130: 642e 2e2e 2720 256c 656e 2863 6f6e 7469  d...' %len(conti
-00073140: 6e75 6f75 735f 7661 7273 2929 0d0a 2020  nuous_vars))..  
-00073150: 2020 6966 206c 656e 2863 6f6e 7469 6e75    if len(continu
-00073160: 6f75 735f 7661 7273 2920 3e20 3020 616e  ous_vars) > 0 an
-00073170: 6420 6c65 6e28 636f 6e74 696e 756f 7573  d len(continuous
-00073180: 5f76 6172 7329 203c 3d20 323a 0d0a 2020  _vars) <= 2:..  
-00073190: 2020 2020 2020 6d61 785f 6465 7074 6820        max_depth 
-000731a0: 3d20 2032 0d0a 2020 2020 2020 2020 636f  =  2..        co
-000731b0: 6e74 696e 756f 7573 5f76 6172 7320 3d20  ntinuous_vars = 
-000731c0: 636f 6e74 696e 756f 7573 5f76 6172 735b  continuous_vars[
-000731d0: 3a5d 0d0a 2020 2020 656c 6966 206c 656e  :]..    elif len
-000731e0: 2863 6f6e 7469 6e75 6f75 735f 7661 7273  (continuous_vars
-000731f0: 2920 3e20 3220 616e 6420 6c65 6e28 636f  ) > 2 and len(co
-00073200: 6e74 696e 756f 7573 5f76 6172 7329 203c  ntinuous_vars) <
-00073210: 3d20 353a 0d0a 2020 2020 2020 2020 6d61  = 5:..        ma
-00073220: 785f 6465 7074 6820 3d20 6c65 6e28 636f  x_depth = len(co
-00073230: 6e74 696e 756f 7573 5f76 6172 7329 202d  ntinuous_vars) -
-00073240: 2032 0d0a 2020 2020 2020 2020 636f 6e74   2..        cont
-00073250: 696e 756f 7573 5f76 6172 7320 3d20 636f  inuous_vars = co
-00073260: 6e74 696e 756f 7573 5f76 6172 735b 3a32  ntinuous_vars[:2
-00073270: 5d0d 0a20 2020 2065 6c69 6620 6c65 6e28  ]..    elif len(
-00073280: 636f 6e74 696e 756f 7573 5f76 6172 7329  continuous_vars)
-00073290: 203e 2035 2061 6e64 206c 656e 2863 6f6e   > 5 and len(con
-000732a0: 7469 6e75 6f75 735f 7661 7273 2920 3c3d  tinuous_vars) <=
-000732b0: 2031 303a 0d0a 2020 2020 2020 2020 6d61   10:..        ma
-000732c0: 785f 6465 7074 6820 3d20 350d 0a20 2020  x_depth = 5..   
-000732d0: 2020 2020 2063 6f6e 7469 6e75 6f75 735f       continuous_
-000732e0: 7661 7273 203d 2063 6f6e 7469 6e75 6f75  vars = continuou
-000732f0: 735f 7661 7273 5b3a 355d 0d0a 2020 2020  s_vars[:5]..    
-00073300: 656c 6966 206c 656e 2863 6f6e 7469 6e75  elif len(continu
-00073310: 6f75 735f 7661 7273 2920 3e20 3130 2061  ous_vars) > 10 a
-00073320: 6e64 206c 656e 2863 6f6e 7469 6e75 6f75  nd len(continuou
-00073330: 735f 7661 7273 2920 3c3d 2035 303a 0d0a  s_vars) <= 50:..
-00073340: 2020 2020 2020 2020 6d61 785f 6465 7074          max_dept
-00073350: 6820 3d20 6d61 785f 6465 7074 680d 0a20  h = max_depth.. 
-00073360: 2020 2020 2020 2063 6f6e 7469 6e75 6f75         continuou
-00073370: 735f 7661 7273 203d 2063 6f6e 7469 6e75  s_vars = continu
-00073380: 6f75 735f 7661 7273 5b3a 3130 5d0d 0a20  ous_vars[:10].. 
-00073390: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-000733a0: 2020 6d61 785f 6465 7074 6820 3d20 6d61    max_depth = ma
-000733b0: 785f 6465 7074 680d 0a20 2020 2020 2020  x_depth..       
-000733c0: 2063 6f6e 7469 6e75 6f75 735f 7661 7273   continuous_vars
-000733d0: 203d 2063 6f6e 7469 6e75 6f75 735f 7661   = continuous_va
-000733e0: 7273 5b3a 3530 5d0d 0a20 2020 206e 6577  rs[:50]..    new
-000733f0: 5f62 696e 636f 6c73 203d 205b 5d0d 0a20  _bincols = [].. 
-00073400: 2020 2023 2323 2020 2054 6869 7320 6973     ###   This is
-00073410: 2061 6e20 4177 6573 6f6d 6520 456e 7472   an Awesome Entr
-00073420: 6f70 7920 4261 7365 6420 4269 6e6e 696e  opy Based Binnin
-00073430: 6720 4d65 7468 6f64 2066 6f72 2043 6f6e  g Method for Con
-00073440: 7469 6e75 6f75 7320 5661 7269 6162 6c65  tinuous Variable
-00073450: 7320 2323 2323 2323 2323 2323 230d 0a20  s ###########.. 
-00073460: 2020 2066 726f 6d20 736b 6c65 6172 6e2e     from sklearn.
-00073470: 7472 6565 2069 6d70 6f72 7420 4465 6369  tree import Deci
-00073480: 7369 6f6e 5472 6565 5265 6772 6573 736f  sionTreeRegresso
-00073490: 722c 2044 6563 6973 696f 6e54 7265 6543  r, DecisionTreeC
-000734a0: 6c61 7373 6966 6965 720d 0a20 2020 2069  lassifier..    i
-000734b0: 6620 6d6f 6465 6c74 7970 6520 3d3d 2027  f modeltype == '
-000734c0: 5265 6772 6573 7369 6f6e 273a 0d0a 2020  Regression':..  
-000734d0: 2020 2020 2020 636c 6620 3d20 4465 6369        clf = Deci
-000734e0: 7369 6f6e 5472 6565 5265 6772 6573 736f  sionTreeRegresso
-000734f0: 7228 6372 6974 6572 696f 6e3d 276d 7365  r(criterion='mse
-00073500: 272c 6d69 6e5f 7361 6d70 6c65 735f 6c65  ',min_samples_le
-00073510: 6166 3d32 2c0d 0a20 2020 2020 2020 2020  af=2,..         
-00073520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073530: 2020 2020 2020 2020 2020 206d 6178 5f64             max_d
-00073540: 6570 7468 3d6d 6178 5f64 6570 7468 2c0d  epth=max_depth,.
-00073550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00073560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073570: 2020 2020 2072 616e 646f 6d5f 7374 6174       random_stat
-00073580: 653d 7365 6564 290d 0a20 2020 2065 6c73  e=seed)..    els
-00073590: 653a 0d0a 2020 2020 2020 2020 636c 6620  e:..        clf 
-000735a0: 3d20 4465 6369 7369 6f6e 5472 6565 436c  = DecisionTreeCl
-000735b0: 6173 7369 6669 6572 2863 7269 7465 7269  assifier(criteri
-000735c0: 6f6e 3d27 656e 7472 6f70 7927 2c6d 696e  on='entropy',min
-000735d0: 5f73 616d 706c 6573 5f6c 6561 663d 322c  _samples_leaf=2,
-000735e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000735f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073600: 2020 2020 2020 2020 2020 206d 6178 5f64             max_d
-00073610: 6570 7468 3d6d 6178 5f64 6570 7468 2c0d  epth=max_depth,.
-00073620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00073630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073640: 2020 2020 2020 2020 2020 7261 6e64 6f6d            random
-00073650: 5f73 7461 7465 3d73 6565 6429 0d0a 2020  _state=seed)..  
-00073660: 2020 656e 7472 6f70 795f 7468 7265 7368    entropy_thresh
-00073670: 6f6c 6420 3d20 5b5d 0d0a 2020 2020 2323  old = []..    ##
-00073680: 2323 2323 2320 5468 6973 2069 7320 7768  ##### This is wh
-00073690: 6572 6520 7765 2062 696e 2065 6163 6820  ere we bin each 
-000736a0: 7661 7269 6162 6c65 2074 6872 6f75 6768  variable through
-000736b0: 2061 206d 6574 686f 6420 6b6e 6f77 6e20   a method known 
-000736c0: 6173 2045 6e74 726f 7079 2042 696e 6e69  as Entropy Binni
-000736d0: 6e67 2023 2323 2323 2323 2323 2323 2323  ng #############
-000736e0: 230d 0a20 2020 2066 6f72 2065 6163 685f  #..    for each_
-000736f0: 6e75 6d20 696e 2063 6f6e 7469 6e75 6f75  num in continuou
-00073700: 735f 7661 7273 3a0d 0a20 2020 2020 2020  s_vars:..       
-00073710: 2074 7279 3a0d 0a20 2020 2020 2020 2020   try:..         
-00073720: 2020 2063 6c66 2e66 6974 2874 656d 705f     clf.fit(temp_
-00073730: 7472 6169 6e5b 6561 6368 5f6e 756d 5d2e  train[each_num].
-00073740: 7661 6c75 6573 2e72 6573 6861 7065 282d  values.reshape(-
-00073750: 312c 3129 2c74 656d 705f 7472 6169 6e5b  1,1),temp_train[
-00073760: 7461 7267 5d2e 7661 6c75 6573 290d 0a20  targ].values).. 
-00073770: 2020 2020 2020 2020 2020 2065 6e74 726f             entro
-00073780: 7079 5f74 6872 6573 686f 6c64 203d 2063  py_threshold = c
-00073790: 6c66 2e74 7265 655f 2e74 6872 6573 686f  lf.tree_.thresho
-000737a0: 6c64 5b63 6c66 2e74 7265 655f 2e74 6872  ld[clf.tree_.thr
-000737b0: 6573 686f 6c64 3e2d 325d 0d0a 2020 2020  eshold>-2]..    
-000737c0: 2020 2020 2020 2020 656e 7472 6f70 795f          entropy_
-000737d0: 7468 7265 7368 6f6c 6420 3d20 6e70 2e73  threshold = np.s
-000737e0: 6f72 7428 656e 7472 6f70 795f 7468 7265  ort(entropy_thre
-000737f0: 7368 6f6c 6429 0d0a 2020 2020 2020 2020  shold)..        
-00073800: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00073810: 6528 6561 6368 5f6e 756d 2c20 7374 7229  e(each_num, str)
-00073820: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00073830: 2020 2062 696e 636f 6c20 3d20 6561 6368     bincol = each
-00073840: 5f6e 756d 2b27 5f62 696e 270d 0a20 2020  _num+'_bin'..   
-00073850: 2020 2020 2020 2020 2020 2020 2074 656d               tem
-00073860: 705f 7472 6169 6e5b 6269 6e63 6f6c 5d20  p_train[bincol] 
-00073870: 3d20 6e70 2e64 6967 6974 697a 6528 7465  = np.digitize(te
-00073880: 6d70 5f74 7261 696e 5b65 6163 685f 6e75  mp_train[each_nu
-00073890: 6d5d 2e76 616c 7565 732c 2065 6e74 726f  m].values, entro
-000738a0: 7079 5f74 6872 6573 686f 6c64 290d 0a20  py_threshold).. 
-000738b0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000738c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000738d0: 2020 6269 6e63 6f6c 203d 2027 6269 6e5f    bincol = 'bin_
-000738e0: 272b 7374 7228 6561 6368 5f6e 756d 290d  '+str(each_num).
-000738f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00073900: 2074 656d 705f 7472 6169 6e5b 6269 6e63   temp_train[binc
-00073910: 6f6c 5d20 3d20 6e70 2e64 6967 6974 697a  ol] = np.digitiz
-00073920: 6528 7465 6d70 5f74 7261 696e 5b65 6163  e(temp_train[eac
-00073930: 685f 6e75 6d5d 2e76 616c 7565 732c 2065  h_num].values, e
-00073940: 6e74 726f 7079 5f74 6872 6573 686f 6c64  ntropy_threshold
-00073950: 290d 0a20 2020 2020 2020 2020 2020 2023  )..            #
-00073960: 2323 2320 5765 2044 726f 7020 7468 6520  ### We Drop the 
-00073970: 6f72 6967 696e 616c 2063 6f6e 7469 6e75  original continu
-00073980: 6f75 7320 7661 7269 6162 6c65 2061 6674  ous variable aft
-00073990: 6572 2079 6f75 2068 6176 6520 6372 6561  er you have crea
-000739a0: 7465 6420 7468 6520 6269 6e20 7768 656e  ted the bin when
-000739b0: 2046 6c61 6720 6973 2074 7275 650d 0a20   Flag is true.. 
-000739c0: 2020 2020 2020 2020 2020 2023 2323 2057             ### W
-000739d0: 6520 446f 6e27 7420 6472 6f70 2074 6865  e Don't drop the
-000739e0: 7365 206f 7269 6769 6e61 6c20 6e75 6d65  se original nume
-000739f0: 7269 6320 7661 7273 2073 696e 6365 2074  ric vars since t
-00073a00: 6865 7920 7769 6c6c 2062 6520 7573 6564  hey will be used
-00073a10: 206c 6174 6572 2066 6f72 2066 756c 6c20   later for full 
-00073a20: 7472 6169 6e20 6269 6e6e 696e 670d 0a20  train binning.. 
-00073a30: 2020 2020 2020 2020 2020 2069 6620 7479             if ty
-00073a40: 7065 2874 656d 705f 7465 7374 2920 213d  pe(temp_test) !=
-00073a50: 2073 7472 3a0d 0a20 2020 2020 2020 2020   str:..         
-00073a60: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00073a70: 616e 6365 2865 6163 685f 6e75 6d2c 2073  ance(each_num, s
-00073a80: 7472 293a 0d0a 2020 2020 2020 2020 2020  tr):..          
-00073a90: 2020 2020 2020 2020 2020 6269 6e63 6f6c            bincol
-00073aa0: 203d 2065 6163 685f 6e75 6d2b 275f 6269   = each_num+'_bi
-00073ab0: 6e27 0d0a 2020 2020 2020 2020 2020 2020  n'..            
-00073ac0: 2020 2020 2020 2020 7465 6d70 5f74 6573          temp_tes
-00073ad0: 745b 6269 6e63 6f6c 5d20 3d20 6e70 2e64  t[bincol] = np.d
-00073ae0: 6967 6974 697a 6528 7465 6d70 5f74 6573  igitize(temp_tes
-00073af0: 745b 6561 6368 5f6e 756d 5d2e 7661 6c75  t[each_num].valu
-00073b00: 6573 2c20 656e 7472 6f70 795f 7468 7265  es, entropy_thre
-00073b10: 7368 6f6c 6429 0d0a 2020 2020 2020 2020  shold)..        
-00073b20: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00073b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073b40: 2020 2062 696e 636f 6c20 3d20 2762 696e     bincol = 'bin
-00073b50: 5f27 2b73 7472 2865 6163 685f 6e75 6d29  _'+str(each_num)
-00073b60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00073b70: 2020 2020 2020 7465 6d70 5f74 6573 745b        temp_test[
-00073b80: 6269 6e63 6f6c 5d20 3d20 6e70 2e64 6967  bincol] = np.dig
-00073b90: 6974 697a 6528 7465 6d70 5f74 6573 745b  itize(temp_test[
-00073ba0: 6561 6368 5f6e 756d 5d2e 7661 6c75 6573  each_num].values
-00073bb0: 2c20 656e 7472 6f70 795f 7468 7265 7368  , entropy_thresh
-00073bc0: 6f6c 6429 0d0a 2020 2020 2020 2020 2020  old)..          
-00073bd0: 2020 2020 2020 2323 2323 2057 6520 4472        #### We Dr
-00073be0: 6f70 2074 6865 206f 7269 6769 6e61 6c20  op the original 
-00073bf0: 636f 6e74 696e 756f 7573 2076 6172 6961  continuous varia
-00073c00: 626c 6520 6166 7465 7220 796f 7520 6861  ble after you ha
-00073c10: 7665 2063 7265 6174 6564 2074 6865 2062  ve created the b
-00073c20: 696e 2077 6865 6e20 466c 6167 2069 7320  in when Flag is 
-00073c30: 7472 7565 0d0a 2020 2020 2020 2020 2020  true..          
-00073c40: 2020 2020 2020 2323 2320 5765 2044 6f6e        ### We Don
-00073c50: 2774 2064 726f 7020 7468 6573 6520 6f72  't drop these or
-00073c60: 6967 696e 616c 206e 756d 6572 6963 2076  iginal numeric v
-00073c70: 6172 7320 7369 6e63 6520 7468 6579 2077  ars since they w
-00073c80: 696c 6c20 6265 2075 7365 6420 6c61 7465  ill be used late
-00073c90: 7220 666f 7220 6675 6c6c 2074 7261 696e  r for full train
-00073ca0: 2062 696e 6e69 6e67 0d0a 2020 2020 2020   binning..      
-00073cb0: 2020 2020 2020 6966 2065 6e74 726f 7079        if entropy
-00073cc0: 5f62 696e 6e69 6e67 3a0d 0a20 2020 2020  _binning:..     
-00073cd0: 2020 2020 2020 2020 2020 2023 2323 2049             ### I
-00073ce0: 6e20 7468 6520 7365 636f 6e64 2074 696d  n the second tim
-00073cf0: 652c 2077 6520 646f 6e27 7420 7265 7065  e, we don't repe
-00073d00: 6174 2061 6464 696e 6720 6269 6e6e 6564  at adding binned
-00073d10: 2076 6172 7320 7369 6e63 6520 7468 6579   vars since they
-00073d20: 2068 6176 6520 616c 7265 6164 7920 6265   have already be
-00073d30: 656e 2061 6464 6564 210d 0a20 2020 2020  en added!..     
-00073d40: 2020 2020 2020 2020 2020 2023 2323 2320             #### 
-00073d50: 7765 2061 6c73 6f20 6d61 6b65 2073 7572  we also make sur
-00073d60: 6520 7468 6174 2074 6865 206f 7269 6720  e that the orig 
-00073d70: 6e75 6d20 7661 7273 2077 6869 6368 2068  num vars which h
-00073d80: 6176 6520 6e6f 7720 6265 656e 2062 696e  ave now been bin
-00073d90: 6e65 6420 6172 6520 7265 6d6f 7665 6421  ned are removed!
-00073da0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00073db0: 2020 7465 6d70 5f74 7261 696e 2e64 726f    temp_train.dro
-00073dc0: 7028 6561 6368 5f6e 756d 2c61 7869 733d  p(each_num,axis=
-00073dd0: 312c 696e 706c 6163 653d 5472 7565 290d  1,inplace=True).
-00073de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00073df0: 2069 6620 7479 7065 2874 656d 705f 7465   if type(temp_te
-00073e00: 7374 2920 213d 2073 7472 3a0d 0a20 2020  st) != str:..   
-00073e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00073e20: 2074 656d 705f 7465 7374 2e64 726f 7028   temp_test.drop(
-00073e30: 6561 6368 5f6e 756d 2c61 7869 733d 312c  each_num,axis=1,
-00073e40: 696e 706c 6163 653d 5472 7565 290d 0a20  inplace=True).. 
-00073e50: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00073e60: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00073e70: 2020 2323 2323 2049 6e20 7468 6520 6669    #### In the fi
-00073e80: 7273 7420 7469 6d65 2c20 7765 2061 6464  rst time, we add
-00073e90: 2062 696e 6e65 6420 7661 7273 2074 6f20   binned vars to 
-00073ea0: 2069 6d70 6f72 7461 6e74 5f66 6561 7475   important_featu
-00073eb0: 7265 7320 2023 2323 0d0a 2020 2020 2020  res  ###..      
-00073ec0: 2020 2020 2020 2020 2020 2323 2320 496e            ### In
-00073ed0: 2074 6865 2073 6563 6f6e 6420 7469 6d65   the second time
-00073ee0: 2c20 7765 2064 6f6e 2774 2072 6570 6561  , we don't repea
-00073ef0: 7420 7468 6174 2073 696e 6365 2074 6865  t that since the
-00073f00: 7920 6861 7665 2061 6c72 6561 6479 2062  y have already b
-00073f10: 6565 6e20 6164 6465 6421 0d0a 2020 2020  een added!..    
-00073f20: 2020 2020 2020 2020 2020 2020 696d 706f              impo
-00073f30: 7274 616e 745f 6665 6174 7572 6573 2e61  rtant_features.a
-00073f40: 7070 656e 6428 6269 6e63 6f6c 290d 0a20  ppend(bincol).. 
-00073f50: 2020 2020 2020 2020 2020 206e 756d 5f76             num_v
-00073f60: 6172 732e 6170 7065 6e64 2862 696e 636f  ars.append(binco
-00073f70: 6c29 0d0a 2020 2020 2020 2020 2020 2020  l)..            
-00073f80: 696d 706f 7274 616e 745f 6665 6174 7572  important_featur
-00073f90: 6573 2e72 656d 6f76 6528 6561 6368 5f6e  es.remove(each_n
-00073fa0: 756d 290d 0a20 2020 2020 2020 2020 2020  um)..           
-00073fb0: 2023 2323 2320 4472 6f70 2074 6865 7365   #### Drop these
-00073fc0: 206f 7269 6769 6e61 6c20 636f 6e74 696e   original contin
-00073fd0: 756f 7573 2076 6172 6961 626c 6520 6672  uous variable fr
-00073fe0: 6f6d 2066 7572 7468 6572 2063 6f6e 7369  om further consi
-00073ff0: 6465 7261 7469 6f6e 2074 6861 7427 7320  deration that's 
-00074000: 616c 6c21 2023 2323 0d0a 2020 2020 2020  all! ###..      
-00074010: 2020 2020 2020 6e75 6d5f 7661 7273 2e72        num_vars.r
-00074020: 656d 6f76 6528 6561 6368 5f6e 756d 290d  emove(each_num).
-00074030: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
-00074040: 5f62 696e 636f 6c73 2e61 7070 656e 6428  _bincols.append(
-00074050: 6269 6e63 6f6c 290d 0a20 2020 2020 2020  bincol)..       
-00074060: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
-00074070: 2020 2020 2020 7072 696e 7428 2745 7272        print('Err
-00074080: 6f72 2069 6e20 2573 2064 7572 696e 6720  or in %s during 
-00074090: 456e 7472 6f70 7920 4269 6e6e 696e 6727  Entropy Binning'
-000740a0: 2025 6561 6368 5f6e 756d 290d 0a20 2020   %each_num)..   
-000740b0: 2070 7269 6e74 2827 2020 2020 5365 6c65   print('    Sele
-000740c0: 6374 6564 2061 6e64 2062 696e 6e65 6420  cted and binned 
-000740d0: 6f6e 6c79 2074 6f70 2025 7320 636f 6e74  only top %s cont
-000740e0: 696e 756f 7573 2076 6172 6961 626c 6573  inuous variables
-000740f0: 2e27 2025 286c 656e 286e 6577 5f62 696e  .' %(len(new_bin
-00074100: 636f 6c73 2929 290d 0a20 2020 2069 6620  cols)))..    if 
-00074110: 7665 7262 6f73 6520 616e 6420 6c65 6e28  verbose and len(
-00074120: 6e65 775f 6269 6e63 6f6c 7329 203c 3d20  new_bincols) <= 
-00074130: 3330 3a0d 0a20 2020 2020 2020 2070 7269  30:..        pri
-00074140: 6e74 2827 2020 2020 2573 2720 256e 6577  nt('    %s' %new
-00074150: 5f62 696e 636f 6c73 290d 0a20 2020 2072  _bincols)..    r
-00074160: 6574 7572 6e20 7465 6d70 5f74 7261 696e  eturn temp_train
-00074170: 2c20 6e75 6d5f 7661 7273 2c20 696d 706f  , num_vars, impo
-00074180: 7274 616e 745f 6665 6174 7572 6573 2c20  rtant_features, 
-00074190: 7465 6d70 5f74 6573 740d 0a23 2323 2323  temp_test..#####
+00072da0: 0d0a 6465 6620 6164 645f 656e 7472 6f70  ..def add_entrop
+00072db0: 795f 6269 6e6e 696e 6728 7465 6d70 5f74  y_binning(temp_t
+00072dc0: 7261 696e 2c20 7461 7267 2c20 6e75 6d5f  rain, targ, num_
+00072dd0: 7661 7273 2c20 696d 706f 7274 616e 745f  vars, important_
+00072de0: 6665 6174 7572 6573 2c20 7465 6d70 5f74  features, temp_t
+00072df0: 6573 742c 0d0a 2020 2020 2020 2020 2020  est,..          
+00072e00: 2020 2020 2020 2020 2020 2020 206d 6f64               mod
+00072e10: 656c 7479 7065 2c20 656e 7472 6f70 795f  eltype, entropy_
+00072e20: 6269 6e6e 696e 672c 7665 7262 6f73 653d  binning,verbose=
+00072e30: 3029 3a0d 0a20 2020 2022 2222 0d0a 2020  0):..    """..  
+00072e40: 2020 2020 2020 2323 2323 2323 2020 2054        ######   T
+00072e50: 6869 7320 6973 2077 6865 7265 2077 6520  his is where we 
+00072e60: 646f 2045 4e54 524f 5059 2042 494e 4e49  do ENTROPY BINNI
+00072e70: 4e47 204f 4620 434f 4e54 494e 554f 5553  NG OF CONTINUOUS
+00072e80: 2056 4152 5320 2323 2323 2323 2323 2323   VARS ##########
+00072e90: 230d 0a20 2020 2020 2020 2023 2323 2320  #..        #### 
+00072ea0: 4974 2069 7320 6265 7374 2074 6f20 646f  It is best to do
+00072eb0: 2042 696e 6e69 6e67 206f 6e20 4f4e 4c59   Binning on ONLY
+00072ec0: 206f 6e20 7468 6520 746f 7020 6d6f 7374   on the top most
+00072ed0: 2076 6172 6961 626c 6573 2066 726f 6d20   variables from 
+00072ee0: 496d 706f 7274 616e 745f 4665 6174 7572  Important_Featur
+00072ef0: 6573 210d 0a20 2020 2020 2020 2023 2323  es!..        ###
+00072f00: 2320 4d61 6b65 2073 7572 6520 7468 6174  # Make sure that
+00072f10: 2074 6865 2054 6f70 2032 2d31 3020 7661   the Top 2-10 va
+00072f20: 7273 2061 7265 2061 6c6c 2043 4f4e 5449  rs are all CONTI
+00072f30: 4e55 4f55 5320 5641 5253 2120 4f74 6865  NUOUS VARS! Othe
+00072f40: 7277 6973 6520 4269 6e6e 696e 6720 6973  rwise Binning is
+00072f50: 2057 6173 7465 210d 0a20 2020 2020 2020   Waste!..       
+00072f60: 2023 2323 2320 5468 6973 206d 6574 686f   #### This metho
+00072f70: 6420 656e 7375 7265 7320 796f 7520 6765  d ensures you ge
+00072f80: 7420 7468 6520 4265 7374 2052 6573 756c  t the Best Resul
+00072f90: 7473 2062 7920 6765 6e65 7261 6c69 7a69  ts by generalizi
+00072fa0: 6e67 206f 6e20 7468 6520 746f 7020 6e75  ng on the top nu
+00072fb0: 6d65 7269 6320 7661 7273 210d 0a20 2020  meric vars!..   
+00072fc0: 2022 2222 0d0a 2020 2020 7465 6d70 5f74   """..    temp_t
+00072fd0: 7261 696e 203d 2063 6f70 792e 6465 6570  rain = copy.deep
+00072fe0: 636f 7079 2874 656d 705f 7472 6169 6e29  copy(temp_train)
+00072ff0: 0d0a 2020 2020 7465 6d70 5f74 6573 7420  ..    temp_test 
+00073000: 3d20 636f 7079 2e64 6565 7063 6f70 7928  = copy.deepcopy(
+00073010: 7465 6d70 5f74 6573 7429 0d0a 2020 2020  temp_test)..    
+00073020: 6d61 785f 6465 7074 6820 3d20 3130 0d0a  max_depth = 10..
+00073030: 2020 2020 7365 6564 203d 2039 390d 0a20      seed = 99.. 
+00073040: 2020 206e 756d 5f76 6172 7320 3d20 636f     num_vars = co
+00073050: 7079 2e64 6565 7063 6f70 7928 6e75 6d5f  py.deepcopy(num_
+00073060: 7661 7273 290d 0a20 2020 2063 6f6e 7469  vars)..    conti
+00073070: 6e75 6f75 735f 7661 7273 203d 2063 6f70  nuous_vars = cop
+00073080: 792e 6465 6570 636f 7079 286e 756d 5f76  y.deepcopy(num_v
+00073090: 6172 7329 0d0a 2020 2020 696d 706f 7274  ars)..    import
+000730a0: 616e 745f 6665 6174 7572 6573 203d 2063  ant_features = c
+000730b0: 6f70 792e 6465 6570 636f 7079 2869 6d70  opy.deepcopy(imp
+000730c0: 6f72 7461 6e74 5f66 6561 7475 7265 7329  ortant_features)
+000730d0: 0d0a 2020 2020 7072 696e 7428 2744 6574  ..    print('Det
+000730e0: 6572 6d69 6e69 6e67 2077 6869 6368 206f  ermining which o
+000730f0: 6620 2564 2063 6f6e 7469 6e75 6f75 7320  f %d continuous 
+00073100: 7661 7269 6162 6c65 7320 7368 6f75 6c64  variables should
+00073110: 2062 6520 456e 7472 6f70 7920 4269 6e6e   be Entropy Binn
+00073120: 6564 2e2e 2e27 2025 6c65 6e28 636f 6e74  ed...' %len(cont
+00073130: 696e 756f 7573 5f76 6172 7329 290d 0a20  inuous_vars)).. 
+00073140: 2020 2069 6620 6c65 6e28 636f 6e74 696e     if len(contin
+00073150: 756f 7573 5f76 6172 7329 203e 2030 2061  uous_vars) > 0 a
+00073160: 6e64 206c 656e 2863 6f6e 7469 6e75 6f75  nd len(continuou
+00073170: 735f 7661 7273 2920 3c3d 2032 3a0d 0a20  s_vars) <= 2:.. 
+00073180: 2020 2020 2020 206d 6178 5f64 6570 7468         max_depth
+00073190: 203d 2020 320d 0a20 2020 2020 2020 2063   =  2..        c
+000731a0: 6f6e 7469 6e75 6f75 735f 7661 7273 203d  ontinuous_vars =
+000731b0: 2063 6f6e 7469 6e75 6f75 735f 7661 7273   continuous_vars
+000731c0: 5b3a 5d0d 0a20 2020 2065 6c69 6620 6c65  [:]..    elif le
+000731d0: 6e28 636f 6e74 696e 756f 7573 5f76 6172  n(continuous_var
+000731e0: 7329 203e 2032 2061 6e64 206c 656e 2863  s) > 2 and len(c
+000731f0: 6f6e 7469 6e75 6f75 735f 7661 7273 2920  ontinuous_vars) 
+00073200: 3c3d 2035 3a0d 0a20 2020 2020 2020 206d  <= 5:..        m
+00073210: 6178 5f64 6570 7468 203d 206c 656e 2863  ax_depth = len(c
+00073220: 6f6e 7469 6e75 6f75 735f 7661 7273 2920  ontinuous_vars) 
+00073230: 2d20 320d 0a20 2020 2020 2020 2063 6f6e  - 2..        con
+00073240: 7469 6e75 6f75 735f 7661 7273 203d 2063  tinuous_vars = c
+00073250: 6f6e 7469 6e75 6f75 735f 7661 7273 5b3a  ontinuous_vars[:
+00073260: 325d 0d0a 2020 2020 656c 6966 206c 656e  2]..    elif len
+00073270: 2863 6f6e 7469 6e75 6f75 735f 7661 7273  (continuous_vars
+00073280: 2920 3e20 3520 616e 6420 6c65 6e28 636f  ) > 5 and len(co
+00073290: 6e74 696e 756f 7573 5f76 6172 7329 203c  ntinuous_vars) <
+000732a0: 3d20 3130 3a0d 0a20 2020 2020 2020 206d  = 10:..        m
+000732b0: 6178 5f64 6570 7468 203d 2035 0d0a 2020  ax_depth = 5..  
+000732c0: 2020 2020 2020 636f 6e74 696e 756f 7573        continuous
+000732d0: 5f76 6172 7320 3d20 636f 6e74 696e 756f  _vars = continuo
+000732e0: 7573 5f76 6172 735b 3a35 5d0d 0a20 2020  us_vars[:5]..   
+000732f0: 2065 6c69 6620 6c65 6e28 636f 6e74 696e   elif len(contin
+00073300: 756f 7573 5f76 6172 7329 203e 2031 3020  uous_vars) > 10 
+00073310: 616e 6420 6c65 6e28 636f 6e74 696e 756f  and len(continuo
+00073320: 7573 5f76 6172 7329 203c 3d20 3530 3a0d  us_vars) <= 50:.
+00073330: 0a20 2020 2020 2020 206d 6178 5f64 6570  .        max_dep
+00073340: 7468 203d 206d 6178 5f64 6570 7468 0d0a  th = max_depth..
+00073350: 2020 2020 2020 2020 636f 6e74 696e 756f          continuo
+00073360: 7573 5f76 6172 7320 3d20 636f 6e74 696e  us_vars = contin
+00073370: 756f 7573 5f76 6172 735b 3a31 305d 0d0a  uous_vars[:10]..
+00073380: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00073390: 2020 206d 6178 5f64 6570 7468 203d 206d     max_depth = m
+000733a0: 6178 5f64 6570 7468 0d0a 2020 2020 2020  ax_depth..      
+000733b0: 2020 636f 6e74 696e 756f 7573 5f76 6172    continuous_var
+000733c0: 7320 3d20 636f 6e74 696e 756f 7573 5f76  s = continuous_v
+000733d0: 6172 735b 3a35 305d 0d0a 2020 2020 6e65  ars[:50]..    ne
+000733e0: 775f 6269 6e63 6f6c 7320 3d20 5b5d 0d0a  w_bincols = []..
+000733f0: 2020 2020 2323 2320 2020 5468 6973 2069      ###   This i
+00073400: 7320 616e 2041 7765 736f 6d65 2045 6e74  s an Awesome Ent
+00073410: 726f 7079 2042 6173 6564 2042 696e 6e69  ropy Based Binni
+00073420: 6e67 204d 6574 686f 6420 666f 7220 436f  ng Method for Co
+00073430: 6e74 696e 756f 7573 2056 6172 6961 626c  ntinuous Variabl
+00073440: 6573 2023 2323 2323 2323 2323 2323 0d0a  es ###########..
+00073450: 2020 2020 6672 6f6d 2073 6b6c 6561 726e      from sklearn
+00073460: 2e74 7265 6520 696d 706f 7274 2044 6563  .tree import Dec
+00073470: 6973 696f 6e54 7265 6552 6567 7265 7373  isionTreeRegress
+00073480: 6f72 2c20 4465 6369 7369 6f6e 5472 6565  or, DecisionTree
+00073490: 436c 6173 7369 6669 6572 0d0a 2020 2020  Classifier..    
+000734a0: 6966 206d 6f64 656c 7479 7065 203d 3d20  if modeltype == 
+000734b0: 2752 6567 7265 7373 696f 6e27 3a0d 0a20  'Regression':.. 
+000734c0: 2020 2020 2020 2063 6c66 203d 2044 6563         clf = Dec
+000734d0: 6973 696f 6e54 7265 6552 6567 7265 7373  isionTreeRegress
+000734e0: 6f72 2863 7269 7465 7269 6f6e 3d27 6d73  or(criterion='ms
+000734f0: 6527 2c6d 696e 5f73 616d 706c 6573 5f6c  e',min_samples_l
+00073500: 6561 663d 322c 0d0a 2020 2020 2020 2020  eaf=2,..        
+00073510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073520: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
+00073530: 6465 7074 683d 6d61 785f 6465 7074 682c  depth=max_depth,
+00073540: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00073550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073560: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
+00073570: 7465 3d73 6565 6429 0d0a 2020 2020 656c  te=seed)..    el
+00073580: 7365 3a0d 0a20 2020 2020 2020 2063 6c66  se:..        clf
+00073590: 203d 2044 6563 6973 696f 6e54 7265 6543   = DecisionTreeC
+000735a0: 6c61 7373 6966 6965 7228 6372 6974 6572  lassifier(criter
+000735b0: 696f 6e3d 2765 6e74 726f 7079 272c 6d69  ion='entropy',mi
+000735c0: 6e5f 7361 6d70 6c65 735f 6c65 6166 3d32  n_samples_leaf=2
+000735d0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+000735e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000735f0: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
+00073600: 6465 7074 683d 6d61 785f 6465 7074 682c  depth=max_depth,
+00073610: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00073620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073630: 2020 2020 2020 2020 2020 2072 616e 646f             rando
+00073640: 6d5f 7374 6174 653d 7365 6564 290d 0a20  m_state=seed).. 
+00073650: 2020 2065 6e74 726f 7079 5f74 6872 6573     entropy_thres
+00073660: 686f 6c64 203d 205b 5d0d 0a20 2020 2023  hold = []..    #
+00073670: 2323 2323 2323 2054 6869 7320 6973 2077  ###### This is w
+00073680: 6865 7265 2077 6520 6269 6e20 6561 6368  here we bin each
+00073690: 2076 6172 6961 626c 6520 7468 726f 7567   variable throug
+000736a0: 6820 6120 6d65 7468 6f64 206b 6e6f 776e  h a method known
+000736b0: 2061 7320 456e 7472 6f70 7920 4269 6e6e   as Entropy Binn
+000736c0: 696e 6720 2323 2323 2323 2323 2323 2323  ing ############
+000736d0: 2323 0d0a 2020 2020 666f 7220 6561 6368  ##..    for each
+000736e0: 5f6e 756d 2069 6e20 636f 6e74 696e 756f  _num in continuo
+000736f0: 7573 5f76 6172 733a 0d0a 2020 2020 2020  us_vars:..      
+00073700: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
+00073710: 2020 2020 636c 662e 6669 7428 7465 6d70      clf.fit(temp
+00073720: 5f74 7261 696e 5b65 6163 685f 6e75 6d5d  _train[each_num]
+00073730: 2e76 616c 7565 732e 7265 7368 6170 6528  .values.reshape(
+00073740: 2d31 2c31 292c 7465 6d70 5f74 7261 696e  -1,1),temp_train
+00073750: 5b74 6172 675d 2e76 616c 7565 7329 0d0a  [targ].values)..
+00073760: 2020 2020 2020 2020 2020 2020 656e 7472              entr
+00073770: 6f70 795f 7468 7265 7368 6f6c 6420 3d20  opy_threshold = 
+00073780: 636c 662e 7472 6565 5f2e 7468 7265 7368  clf.tree_.thresh
+00073790: 6f6c 645b 636c 662e 7472 6565 5f2e 7468  old[clf.tree_.th
+000737a0: 7265 7368 6f6c 643e 2d32 5d0d 0a20 2020  reshold>-2]..   
+000737b0: 2020 2020 2020 2020 2065 6e74 726f 7079           entropy
+000737c0: 5f74 6872 6573 686f 6c64 203d 206e 702e  _threshold = np.
+000737d0: 736f 7274 2865 6e74 726f 7079 5f74 6872  sort(entropy_thr
+000737e0: 6573 686f 6c64 290d 0a20 2020 2020 2020  eshold)..       
+000737f0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00073800: 6365 2865 6163 685f 6e75 6d2c 2073 7472  ce(each_num, str
+00073810: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00073820: 2020 2020 6269 6e63 6f6c 203d 2065 6163      bincol = eac
+00073830: 685f 6e75 6d2b 275f 6269 6e27 0d0a 2020  h_num+'_bin'..  
+00073840: 2020 2020 2020 2020 2020 2020 2020 7465                te
+00073850: 6d70 5f74 7261 696e 5b62 696e 636f 6c5d  mp_train[bincol]
+00073860: 203d 206e 702e 6469 6769 7469 7a65 2874   = np.digitize(t
+00073870: 656d 705f 7472 6169 6e5b 6561 6368 5f6e  emp_train[each_n
+00073880: 756d 5d2e 7661 6c75 6573 2c20 656e 7472  um].values, entr
+00073890: 6f70 795f 7468 7265 7368 6f6c 6429 0d0a  opy_threshold)..
+000738a0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000738b0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+000738c0: 2020 2062 696e 636f 6c20 3d20 2762 696e     bincol = 'bin
+000738d0: 5f27 2b73 7472 2865 6163 685f 6e75 6d29  _'+str(each_num)
+000738e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000738f0: 2020 7465 6d70 5f74 7261 696e 5b62 696e    temp_train[bin
+00073900: 636f 6c5d 203d 206e 702e 6469 6769 7469  col] = np.digiti
+00073910: 7a65 2874 656d 705f 7472 6169 6e5b 6561  ze(temp_train[ea
+00073920: 6368 5f6e 756d 5d2e 7661 6c75 6573 2c20  ch_num].values, 
+00073930: 656e 7472 6f70 795f 7468 7265 7368 6f6c  entropy_threshol
+00073940: 6429 0d0a 2020 2020 2020 2020 2020 2020  d)..            
+00073950: 2323 2323 2057 6520 4472 6f70 2074 6865  #### We Drop the
+00073960: 206f 7269 6769 6e61 6c20 636f 6e74 696e   original contin
+00073970: 756f 7573 2076 6172 6961 626c 6520 6166  uous variable af
+00073980: 7465 7220 796f 7520 6861 7665 2063 7265  ter you have cre
+00073990: 6174 6564 2074 6865 2062 696e 2077 6865  ated the bin whe
+000739a0: 6e20 466c 6167 2069 7320 7472 7565 0d0a  n Flag is true..
+000739b0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+000739c0: 5765 2044 6f6e 2774 2064 726f 7020 7468  We Don't drop th
+000739d0: 6573 6520 6f72 6967 696e 616c 206e 756d  ese original num
+000739e0: 6572 6963 2076 6172 7320 7369 6e63 6520  eric vars since 
+000739f0: 7468 6579 2077 696c 6c20 6265 2075 7365  they will be use
+00073a00: 6420 6c61 7465 7220 666f 7220 6675 6c6c  d later for full
+00073a10: 2074 7261 696e 2062 696e 6e69 6e67 0d0a   train binning..
+00073a20: 2020 2020 2020 2020 2020 2020 6966 2074              if t
+00073a30: 7970 6528 7465 6d70 5f74 6573 7429 2021  ype(temp_test) !
+00073a40: 3d20 7374 723a 0d0a 2020 2020 2020 2020  = str:..        
+00073a50: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00073a60: 7461 6e63 6528 6561 6368 5f6e 756d 2c20  tance(each_num, 
+00073a70: 7374 7229 3a0d 0a20 2020 2020 2020 2020  str):..         
+00073a80: 2020 2020 2020 2020 2020 2062 696e 636f             binco
+00073a90: 6c20 3d20 6561 6368 5f6e 756d 2b27 5f62  l = each_num+'_b
+00073aa0: 696e 270d 0a20 2020 2020 2020 2020 2020  in'..           
+00073ab0: 2020 2020 2020 2020 2074 656d 705f 7465           temp_te
+00073ac0: 7374 5b62 696e 636f 6c5d 203d 206e 702e  st[bincol] = np.
+00073ad0: 6469 6769 7469 7a65 2874 656d 705f 7465  digitize(temp_te
+00073ae0: 7374 5b65 6163 685f 6e75 6d5d 2e76 616c  st[each_num].val
+00073af0: 7565 732c 2065 6e74 726f 7079 5f74 6872  ues, entropy_thr
+00073b00: 6573 686f 6c64 290d 0a20 2020 2020 2020  eshold)..       
+00073b10: 2020 2020 2020 2020 2065 6c73 653a 0d0a           else:..
+00073b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073b30: 2020 2020 6269 6e63 6f6c 203d 2027 6269      bincol = 'bi
+00073b40: 6e5f 272b 7374 7228 6561 6368 5f6e 756d  n_'+str(each_num
+00073b50: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00073b60: 2020 2020 2020 2074 656d 705f 7465 7374         temp_test
+00073b70: 5b62 696e 636f 6c5d 203d 206e 702e 6469  [bincol] = np.di
+00073b80: 6769 7469 7a65 2874 656d 705f 7465 7374  gitize(temp_test
+00073b90: 5b65 6163 685f 6e75 6d5d 2e76 616c 7565  [each_num].value
+00073ba0: 732c 2065 6e74 726f 7079 5f74 6872 6573  s, entropy_thres
+00073bb0: 686f 6c64 290d 0a20 2020 2020 2020 2020  hold)..         
+00073bc0: 2020 2020 2020 2023 2323 2320 5765 2044         #### We D
+00073bd0: 726f 7020 7468 6520 6f72 6967 696e 616c  rop the original
+00073be0: 2063 6f6e 7469 6e75 6f75 7320 7661 7269   continuous vari
+00073bf0: 6162 6c65 2061 6674 6572 2079 6f75 2068  able after you h
+00073c00: 6176 6520 6372 6561 7465 6420 7468 6520  ave created the 
+00073c10: 6269 6e20 7768 656e 2046 6c61 6720 6973  bin when Flag is
+00073c20: 2074 7275 650d 0a20 2020 2020 2020 2020   true..         
+00073c30: 2020 2020 2020 2023 2323 2057 6520 446f         ### We Do
+00073c40: 6e27 7420 6472 6f70 2074 6865 7365 206f  n't drop these o
+00073c50: 7269 6769 6e61 6c20 6e75 6d65 7269 6320  riginal numeric 
+00073c60: 7661 7273 2073 696e 6365 2074 6865 7920  vars since they 
+00073c70: 7769 6c6c 2062 6520 7573 6564 206c 6174  will be used lat
+00073c80: 6572 2066 6f72 2066 756c 6c20 7472 6169  er for full trai
+00073c90: 6e20 6269 6e6e 696e 670d 0a20 2020 2020  n binning..     
+00073ca0: 2020 2020 2020 2069 6620 656e 7472 6f70         if entrop
+00073cb0: 795f 6269 6e6e 696e 673a 0d0a 2020 2020  y_binning:..    
+00073cc0: 2020 2020 2020 2020 2020 2020 2323 2320              ### 
+00073cd0: 496e 2074 6865 2073 6563 6f6e 6420 7469  In the second ti
+00073ce0: 6d65 2c20 7765 2064 6f6e 2774 2072 6570  me, we don't rep
+00073cf0: 6561 7420 6164 6469 6e67 2062 696e 6e65  eat adding binne
+00073d00: 6420 7661 7273 2073 696e 6365 2074 6865  d vars since the
+00073d10: 7920 6861 7665 2061 6c72 6561 6479 2062  y have already b
+00073d20: 6565 6e20 6164 6465 6421 0d0a 2020 2020  een added!..    
+00073d30: 2020 2020 2020 2020 2020 2020 2323 2323              ####
+00073d40: 2077 6520 616c 736f 206d 616b 6520 7375   we also make su
+00073d50: 7265 2074 6861 7420 7468 6520 6f72 6967  re that the orig
+00073d60: 206e 756d 2076 6172 7320 7768 6963 6820   num vars which 
+00073d70: 6861 7665 206e 6f77 2062 6565 6e20 6269  have now been bi
+00073d80: 6e6e 6564 2061 7265 2072 656d 6f76 6564  nned are removed
+00073d90: 210d 0a20 2020 2020 2020 2020 2020 2020  !..             
+00073da0: 2020 2074 656d 705f 7472 6169 6e2e 6472     temp_train.dr
+00073db0: 6f70 2865 6163 685f 6e75 6d2c 6178 6973  op(each_num,axis
+00073dc0: 3d31 2c69 6e70 6c61 6365 3d54 7275 6529  =1,inplace=True)
+00073dd0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00073de0: 2020 6966 2074 7970 6528 7465 6d70 5f74    if type(temp_t
+00073df0: 6573 7429 2021 3d20 7374 723a 0d0a 2020  est) != str:..  
+00073e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00073e10: 2020 7465 6d70 5f74 6573 742e 6472 6f70    temp_test.drop
+00073e20: 2865 6163 685f 6e75 6d2c 6178 6973 3d31  (each_num,axis=1
+00073e30: 2c69 6e70 6c61 6365 3d54 7275 6529 0d0a  ,inplace=True)..
+00073e40: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00073e50: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00073e60: 2020 2023 2323 2320 496e 2074 6865 2066     #### In the f
+00073e70: 6972 7374 2074 696d 652c 2077 6520 6164  irst time, we ad
+00073e80: 6420 6269 6e6e 6564 2076 6172 7320 746f  d binned vars to
+00073e90: 2020 696d 706f 7274 616e 745f 6665 6174    important_feat
+00073ea0: 7572 6573 2020 2323 230d 0a20 2020 2020  ures  ###..     
+00073eb0: 2020 2020 2020 2020 2020 2023 2323 2049             ### I
+00073ec0: 6e20 7468 6520 7365 636f 6e64 2074 696d  n the second tim
+00073ed0: 652c 2077 6520 646f 6e27 7420 7265 7065  e, we don't repe
+00073ee0: 6174 2074 6861 7420 7369 6e63 6520 7468  at that since th
+00073ef0: 6579 2068 6176 6520 616c 7265 6164 7920  ey have already 
+00073f00: 6265 656e 2061 6464 6564 210d 0a20 2020  been added!..   
+00073f10: 2020 2020 2020 2020 2020 2020 2069 6d70               imp
+00073f20: 6f72 7461 6e74 5f66 6561 7475 7265 732e  ortant_features.
+00073f30: 6170 7065 6e64 2862 696e 636f 6c29 0d0a  append(bincol)..
+00073f40: 2020 2020 2020 2020 2020 2020 6e75 6d5f              num_
+00073f50: 7661 7273 2e61 7070 656e 6428 6269 6e63  vars.append(binc
+00073f60: 6f6c 290d 0a20 2020 2020 2020 2020 2020  ol)..           
+00073f70: 2069 6d70 6f72 7461 6e74 5f66 6561 7475   important_featu
+00073f80: 7265 732e 7265 6d6f 7665 2865 6163 685f  res.remove(each_
+00073f90: 6e75 6d29 0d0a 2020 2020 2020 2020 2020  num)..          
+00073fa0: 2020 2323 2323 2044 726f 7020 7468 6573    #### Drop thes
+00073fb0: 6520 6f72 6967 696e 616c 2063 6f6e 7469  e original conti
+00073fc0: 6e75 6f75 7320 7661 7269 6162 6c65 2066  nuous variable f
+00073fd0: 726f 6d20 6675 7274 6865 7220 636f 6e73  rom further cons
+00073fe0: 6964 6572 6174 696f 6e20 7468 6174 2773  ideration that's
+00073ff0: 2061 6c6c 2120 2323 230d 0a20 2020 2020   all! ###..     
+00074000: 2020 2020 2020 206e 756d 5f76 6172 732e         num_vars.
+00074010: 7265 6d6f 7665 2865 6163 685f 6e75 6d29  remove(each_num)
+00074020: 0d0a 2020 2020 2020 2020 2020 2020 6e65  ..            ne
+00074030: 775f 6269 6e63 6f6c 732e 6170 7065 6e64  w_bincols.append
+00074040: 2862 696e 636f 6c29 0d0a 2020 2020 2020  (bincol)..      
+00074050: 2020 6578 6365 7074 3a0d 0a20 2020 2020    except:..     
+00074060: 2020 2020 2020 2070 7269 6e74 2827 4572         print('Er
+00074070: 726f 7220 696e 2025 7320 6475 7269 6e67  ror in %s during
+00074080: 2045 6e74 726f 7079 2042 696e 6e69 6e67   Entropy Binning
+00074090: 2720 2565 6163 685f 6e75 6d29 0d0a 2020  ' %each_num)..  
+000740a0: 2020 7072 696e 7428 2720 2020 2053 656c    print('    Sel
+000740b0: 6563 7465 6420 616e 6420 6269 6e6e 6564  ected and binned
+000740c0: 206f 6e6c 7920 746f 7020 2573 2063 6f6e   only top %s con
+000740d0: 7469 6e75 6f75 7320 7661 7269 6162 6c65  tinuous variable
+000740e0: 732e 2720 2528 6c65 6e28 6e65 775f 6269  s.' %(len(new_bi
+000740f0: 6e63 6f6c 7329 2929 0d0a 2020 2020 6966  ncols)))..    if
+00074100: 2076 6572 626f 7365 2061 6e64 206c 656e   verbose and len
+00074110: 286e 6577 5f62 696e 636f 6c73 2920 3c3d  (new_bincols) <=
+00074120: 2033 303a 0d0a 2020 2020 2020 2020 7072   30:..        pr
+00074130: 696e 7428 2720 2020 2025 7327 2025 6e65  int('    %s' %ne
+00074140: 775f 6269 6e63 6f6c 7329 0d0a 2020 2020  w_bincols)..    
+00074150: 7265 7475 726e 2074 656d 705f 7472 6169  return temp_trai
+00074160: 6e2c 206e 756d 5f76 6172 732c 2069 6d70  n, num_vars, imp
+00074170: 6f72 7461 6e74 5f66 6561 7475 7265 732c  ortant_features,
+00074180: 2074 656d 705f 7465 7374 0d0a 2323 2323   temp_test..####
+00074190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000741a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000741b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000741c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000741d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000741e0: 2323 2323 2323 2323 0d0a 6672 6f6d 2073  ########..from s
-000741f0: 6b6c 6561 726e 2e62 6173 6520 696d 706f  klearn.base impo
-00074200: 7274 2042 6173 6545 7374 696d 6174 6f72  rt BaseEstimator
-00074210: 2c20 436c 6173 7369 6669 6572 4d69 7869  , ClassifierMixi
-00074220: 6e2c 2054 7261 6e73 666f 726d 6572 4d69  n, TransformerMi
-00074230: 7869 6e0d 0a66 726f 6d20 696d 626c 6561  xin..from imblea
-00074240: 726e 2e6f 7665 725f 7361 6d70 6c69 6e67  rn.over_sampling
-00074250: 2069 6d70 6f72 7420 534d 4f54 452c 2053   import SMOTE, S
-00074260: 564d 534d 4f54 450d 0a66 726f 6d20 696d  VMSMOTE..from im
-00074270: 626c 6561 726e 2e6f 7665 725f 7361 6d70  blearn.over_samp
-00074280: 6c69 6e67 2069 6d70 6f72 7420 4144 4153  ling import ADAS
-00074290: 594e 2c20 534d 4f54 454e 430d 0a66 726f  YN, SMOTENC..fro
-000742a0: 6d20 736b 6c65 6172 6e2e 636c 7573 7465  m sklearn.cluste
-000742b0: 7220 696d 706f 7274 204b 4d65 616e 730d  r import KMeans.
-000742c0: 0a64 6566 206b 6d65 616e 735f 7265 7361  .def kmeans_resa
-000742d0: 6d70 6c65 7228 785f 7472 6169 6e2c 2079  mpler(x_train, y
-000742e0: 5f74 7261 696e 2c20 7461 7267 6574 2c20  _train, target, 
-000742f0: 736d 6f74 653d 2222 2c20 7665 7262 6f73  smote="", verbos
-00074300: 653d 3029 3a0d 0a20 2020 2022 2222 0d0a  e=0):..    """..
-00074310: 2020 2020 5468 6973 2066 756e 6374 696f      This functio
-00074320: 6e20 636f 6e76 6572 7473 2061 2052 6567  n converts a Reg
-00074330: 7265 7373 696f 6e20 7072 6f62 6c65 6d20  ression problem 
-00074340: 696e 746f 2061 2043 6c61 7373 6966 6963  into a Classific
-00074350: 6174 696f 6e20 7072 6f62 6c65 6d20 746f  ation problem to
-00074360: 2065 6e61 626c 6520 534d 4f54 4521 0d0a   enable SMOTE!..
-00074370: 2020 2020 4974 2069 7320 6120 7665 7279      It is a very
-00074380: 2073 696d 706c 6520 7761 7920 746f 2073   simple way to s
-00074390: 656e 6420 796f 7572 2078 5f74 7261 696e  end your x_train
-000743a0: 2c20 795f 7472 6169 6e20 696e 2061 6e64  , y_train in and
-000743b0: 2067 6574 2062 6163 6b20 616e 206f 7665   get back an ove
-000743c0: 7273 616d 706c 6564 2078 5f74 7261 696e  rsampled x_train
-000743d0: 2c20 795f 7472 6169 6e2e 0d0a 2020 2020  , y_train...    
-000743e0: 5768 7920 6973 2074 6869 7320 6e65 6564  Why is this need
-000743f0: 6564 2069 6e20 4d61 6368 696e 6520 4c65  ed in Machine Le
-00074400: 6172 6e69 6e67 2070 726f 626c 656d 733f  arning problems?
-00074410: 0d0a 2020 2020 2020 2020 2049 6e20 496d  ..         In Im
-00074420: 6261 6c61 6e63 6564 2064 6174 6173 6574  balanced dataset
-00074430: 732c 2065 7370 2e20 736b 6577 6564 2072  s, esp. skewed r
-00074440: 6567 7265 7373 696f 6e20 7072 6f62 6c65  egression proble
-00074450: 6d73 2077 6865 7265 2074 6865 2074 6172  ms where the tar
-00074460: 6765 7420 7661 7269 6162 6c65 2069 7320  get variable is 
-00074470: 736b 6577 6564 2c20 7468 6973 2069 7320  skewed, this is 
-00074480: 6e65 6564 6564 2e0d 0a20 2020 2054 7279  needed...    Try
-00074490: 2074 6869 7320 6f6e 2079 6f75 7220 736b   this on your sk
-000744a0: 6577 6564 2052 6567 7265 7373 696f 6e20  ewed Regression 
-000744b0: 7072 6f62 6c65 6d73 2061 6e64 2073 6565  problems and see
-000744c0: 2077 6861 7420 7265 7375 6c74 7320 796f   what results yo
-000744d0: 7520 6765 742e 2049 7420 7368 6f75 6c64  u get. It should
-000744e0: 2062 6520 6265 7474 6572 2e0d 0a20 2020   be better...   
-000744f0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00074500: 2049 6e70 7574 730d 0a20 2020 202d 2d2d   Inputs..    ---
-00074510: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2078 5f74  -------..    x_t
-00074520: 7261 696e 203a 2070 616e 6461 7320 6461  rain : pandas da
-00074530: 7461 6672 616d 653a 2079 6f75 206d 7573  taframe: you mus
-00074540: 7420 7365 6e64 2069 6e20 7468 6520 6461  t send in the da
-00074550: 7461 2077 6974 6820 7072 6564 6963 746f  ta with predicto
-00074560: 7273 206f 6e6c 792e 0d0a 2020 2020 6d69  rs only...    mi
-00074570: 6e5f 6e5f 7361 6d70 6c65 7320 3a20 696e  n_n_samples : in
-00074580: 742c 2064 6566 6175 6c74 3d35 3a20 6d69  t, default=5: mi
-00074590: 6e20 6e75 6d62 6572 206f 6620 7361 6d70  n number of samp
-000745a0: 6c65 7320 6265 6c6f 7720 7768 6963 6820  les below which 
-000745b0: 796f 7520 636f 6d62 696e 6520 6269 6e73  you combine bins
-000745c0: 0d0a 2020 2020 6269 6e73 203a 2069 6e74  ..    bins : int
-000745d0: 2c20 6465 6661 756c 743d 333a 2068 6f77  , default=3: how
-000745e0: 206d 616e 7920 6269 6e73 2079 6f75 2077   many bins you w
-000745f0: 616e 7420 746f 2073 706c 6974 2074 6172  ant to split tar
-00074600: 6765 7420 696e 746f 0d0a 0d0a 2020 2020  get into....    
-00074610: 4f75 7470 7574 730d 0a20 2020 202d 2d2d  Outputs..    ---
-00074620: 2d2d 2d2d 2d2d 2d0d 0a20 2020 206e 5f66  -------..    n_f
-00074630: 6561 7475 7265 735f 203a 2069 6e74 0d0a  eatures_ : int..
-00074640: 2020 2020 2020 2020 5468 6520 6e75 6d62          The numb
-00074650: 6572 206f 6620 6665 6174 7572 6573 206f  er of features o
-00074660: 6620 7468 6520 6461 7461 2070 6173 7365  f the data passe
-00074670: 6420 746f 203a 6d65 7468 3a60 6669 7460  d to :meth:`fit`
-00074680: 2e0d 0a20 2020 2022 2222 0d0a 2020 2020  ...    """..    
-00074690: 785f 7472 6169 6e5f 6320 3d20 636f 7079  x_train_c = copy
-000746a0: 2e64 6565 7063 6f70 7928 785f 7472 6169  .deepcopy(x_trai
-000746b0: 6e29 0d0a 2020 2020 785f 7472 6169 6e5f  n)..    x_train_
-000746c0: 635b 7461 7267 6574 5d20 3d20 795f 7472  c[target] = y_tr
-000746d0: 6169 6e2e 7661 6c75 6573 0d0a 0d0a 2020  ain.values....  
-000746e0: 2020 2320 5265 6772 6573 7369 6f6e 2070    # Regression p
-000746f0: 726f 626c 656d 2074 7572 6e65 6420 696e  roblem turned in
-00074700: 746f 2043 6c61 7373 6966 6963 6174 696f  to Classificatio
-00074710: 6e20 7072 6f62 6c65 6d0d 0a20 2020 206e  n problem..    n
-00074720: 5f63 6c75 7374 6572 7320 3d20 6d61 7828  _clusters = max(
-00074730: 332c 2069 6e74 286e 702e 6c6f 6731 3028  3, int(np.log10(
-00074740: 6c65 6e28 795f 7472 6169 6e29 2929 202b  len(y_train))) +
-00074750: 2031 290d 0a20 2020 2023 2055 7365 204b   1)..    # Use K
-00074760: 4d65 616e 7320 746f 2066 696e 6420 6e61  Means to find na
-00074770: 7475 7261 6c20 636c 7573 7465 7273 2069  tural clusters i
-00074780: 6e20 796f 7572 2064 6174 610d 0a20 2020  n your data..   
-00074790: 206b 6d5f 6d6f 6465 6c20 3d20 4b4d 6561   km_model = KMea
-000747a0: 6e73 286e 5f63 6c75 7374 6572 733d 6e5f  ns(n_clusters=n_
-000747b0: 636c 7573 7465 7273 2c0d 0a20 2020 2020  clusters,..     
-000747c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000747d0: 206e 5f69 6e69 743d 352c 0d0a 2020 2020   n_init=5,..    
-000747e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000747f0: 2020 7261 6e64 6f6d 5f73 7461 7465 3d39    random_state=9
-00074800: 3929 0d0a 2020 2020 2323 2323 2072 656d  9)..    #### rem
-00074810: 656d 6265 7220 796f 7520 6d75 7374 2070  ember you must p
-00074820: 7265 6469 6374 2075 7369 6e67 206f 6e6c  redict using onl
-00074830: 7920 7072 6564 6963 746f 7220 7661 7269  y predictor vari
-00074840: 6162 6c65 7321 0d0a 2020 2020 795f 7472  ables!..    y_tr
-00074850: 6169 6e5f 6320 3d20 6b6d 5f6d 6f64 656c  ain_c = km_model
-00074860: 2e66 6974 5f70 7265 6469 6374 2878 5f74  .fit_predict(x_t
-00074870: 7261 696e 290d 0a0d 0a20 2020 2069 6620  rain)....    if 
-00074880: 7665 7262 6f73 6520 3e3d 2031 3a0d 0a20  verbose >= 1:.. 
-00074890: 2020 2020 2020 2070 7269 6e74 2827 2020         print('  
-000748a0: 2020 4e75 6d62 6572 206f 6620 636c 7573    Number of clus
-000748b0: 7465 7273 2063 7265 6174 6564 203d 2025  ters created = %
-000748c0: 6427 2025 6e5f 636c 7573 7465 7273 290d  d' %n_clusters).
-000748d0: 0a0d 0a20 2020 2023 2323 2320 4765 6e65  ...    #### Gene
-000748e0: 7261 7465 2074 6865 206f 7665 722d 7361  rate the over-sa
-000748f0: 6d70 6c65 6420 6461 7461 0d0a 2020 2020  mpled data..    
-00074900: 2323 2323 2041 4441 5359 4e20 2f20 534d  #### ADASYN / SM
-00074910: 4f54 4520 6f76 6572 7361 6d70 6c69 6e67  OTE oversampling
-00074920: 2023 2323 2323 0d0a 2020 2020 6966 2069   #####..    if i
-00074930: 7369 6e73 7461 6e63 6528 736d 6f74 652c  sinstance(smote,
-00074940: 2073 7472 293a 0d0a 2020 2020 2020 2020   str):..        
-00074950: 785f 7472 6169 6e5f 6578 742c 205f 203d  x_train_ext, _ =
-00074960: 206f 7665 7273 616d 706c 655f 534d 4f54   oversample_SMOT
-00074970: 4528 785f 7472 6169 6e5f 632c 2079 5f74  E(x_train_c, y_t
-00074980: 7261 696e 5f63 290d 0a20 2020 2065 6c73  rain_c)..    els
-00074990: 653a 0d0a 2020 2020 2020 2020 785f 7472  e:..        x_tr
-000749a0: 6169 6e5f 6578 742c 205f 203d 2073 6d6f  ain_ext, _ = smo
-000749b0: 7465 2e66 6974 5f72 6573 616d 706c 6528  te.fit_resample(
-000749c0: 785f 7472 6169 6e5f 632c 2079 5f74 7261  x_train_c, y_tra
-000749d0: 696e 5f63 290d 0a20 2020 2079 5f74 7261  in_c)..    y_tra
-000749e0: 696e 5f65 7874 203d 2078 5f74 7261 696e  in_ext = x_train
-000749f0: 5f65 7874 5b74 6172 6765 745d 2e76 616c  _ext[target].val
-00074a00: 7565 730d 0a20 2020 2078 5f74 7261 696e  ues..    x_train
-00074a10: 5f65 7874 2e64 726f 7028 7461 7267 6574  _ext.drop(target
-00074a20: 2c20 6178 6973 3d31 2c20 696e 706c 6163  , axis=1, inplac
-00074a30: 653d 5472 7565 290d 0a20 2020 2072 6574  e=True)..    ret
-00074a40: 7572 6e20 2878 5f74 7261 696e 5f65 7874  urn (x_train_ext
-00074a50: 2c20 795f 7472 6169 6e5f 6578 7429 0d0a  , y_train_ext)..
-00074a60: 0d0a 2323 2323 2323 2323 2323 2323 2323  ..##############
+000741d0: 2323 2323 2323 2323 230d 0a66 726f 6d20  #########..from 
+000741e0: 736b 6c65 6172 6e2e 6261 7365 2069 6d70  sklearn.base imp
+000741f0: 6f72 7420 4261 7365 4573 7469 6d61 746f  ort BaseEstimato
+00074200: 722c 2043 6c61 7373 6966 6965 724d 6978  r, ClassifierMix
+00074210: 696e 2c20 5472 616e 7366 6f72 6d65 724d  in, TransformerM
+00074220: 6978 696e 0d0a 6672 6f6d 2069 6d62 6c65  ixin..from imble
+00074230: 6172 6e2e 6f76 6572 5f73 616d 706c 696e  arn.over_samplin
+00074240: 6720 696d 706f 7274 2053 4d4f 5445 2c20  g import SMOTE, 
+00074250: 5356 4d53 4d4f 5445 0d0a 6672 6f6d 2069  SVMSMOTE..from i
+00074260: 6d62 6c65 6172 6e2e 6f76 6572 5f73 616d  mblearn.over_sam
+00074270: 706c 696e 6720 696d 706f 7274 2041 4441  pling import ADA
+00074280: 5359 4e2c 2053 4d4f 5445 4e43 0d0a 6672  SYN, SMOTENC..fr
+00074290: 6f6d 2073 6b6c 6561 726e 2e63 6c75 7374  om sklearn.clust
+000742a0: 6572 2069 6d70 6f72 7420 4b4d 6561 6e73  er import KMeans
+000742b0: 0d0a 6465 6620 6b6d 6561 6e73 5f72 6573  ..def kmeans_res
+000742c0: 616d 706c 6572 2878 5f74 7261 696e 2c20  ampler(x_train, 
+000742d0: 795f 7472 6169 6e2c 2074 6172 6765 742c  y_train, target,
+000742e0: 2073 6d6f 7465 3d22 222c 2076 6572 626f   smote="", verbo
+000742f0: 7365 3d30 293a 0d0a 2020 2020 2222 220d  se=0):..    """.
+00074300: 0a20 2020 2054 6869 7320 6675 6e63 7469  .    This functi
+00074310: 6f6e 2063 6f6e 7665 7274 7320 6120 5265  on converts a Re
+00074320: 6772 6573 7369 6f6e 2070 726f 626c 656d  gression problem
+00074330: 2069 6e74 6f20 6120 436c 6173 7369 6669   into a Classifi
+00074340: 6361 7469 6f6e 2070 726f 626c 656d 2074  cation problem t
+00074350: 6f20 656e 6162 6c65 2053 4d4f 5445 210d  o enable SMOTE!.
+00074360: 0a20 2020 2049 7420 6973 2061 2076 6572  .    It is a ver
+00074370: 7920 7369 6d70 6c65 2077 6179 2074 6f20  y simple way to 
+00074380: 7365 6e64 2079 6f75 7220 785f 7472 6169  send your x_trai
+00074390: 6e2c 2079 5f74 7261 696e 2069 6e20 616e  n, y_train in an
+000743a0: 6420 6765 7420 6261 636b 2061 6e20 6f76  d get back an ov
+000743b0: 6572 7361 6d70 6c65 6420 785f 7472 6169  ersampled x_trai
+000743c0: 6e2c 2079 5f74 7261 696e 2e0d 0a20 2020  n, y_train...   
+000743d0: 2057 6879 2069 7320 7468 6973 206e 6565   Why is this nee
+000743e0: 6465 6420 696e 204d 6163 6869 6e65 204c  ded in Machine L
+000743f0: 6561 726e 696e 6720 7072 6f62 6c65 6d73  earning problems
+00074400: 3f0d 0a20 2020 2020 2020 2020 496e 2049  ?..         In I
+00074410: 6d62 616c 616e 6365 6420 6461 7461 7365  mbalanced datase
+00074420: 7473 2c20 6573 702e 2073 6b65 7765 6420  ts, esp. skewed 
+00074430: 7265 6772 6573 7369 6f6e 2070 726f 626c  regression probl
+00074440: 656d 7320 7768 6572 6520 7468 6520 7461  ems where the ta
+00074450: 7267 6574 2076 6172 6961 626c 6520 6973  rget variable is
+00074460: 2073 6b65 7765 642c 2074 6869 7320 6973   skewed, this is
+00074470: 206e 6565 6465 642e 0d0a 2020 2020 5472   needed...    Tr
+00074480: 7920 7468 6973 206f 6e20 796f 7572 2073  y this on your s
+00074490: 6b65 7765 6420 5265 6772 6573 7369 6f6e  kewed Regression
+000744a0: 2070 726f 626c 656d 7320 616e 6420 7365   problems and se
+000744b0: 6520 7768 6174 2072 6573 756c 7473 2079  e what results y
+000744c0: 6f75 2067 6574 2e20 4974 2073 686f 756c  ou get. It shoul
+000744d0: 6420 6265 2062 6574 7465 722e 0d0a 2020  d be better...  
+000744e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+000744f0: 2020 496e 7075 7473 0d0a 2020 2020 2d2d    Inputs..    --
+00074500: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 785f  --------..    x_
+00074510: 7472 6169 6e20 3a20 7061 6e64 6173 2064  train : pandas d
+00074520: 6174 6166 7261 6d65 3a20 796f 7520 6d75  ataframe: you mu
+00074530: 7374 2073 656e 6420 696e 2074 6865 2064  st send in the d
+00074540: 6174 6120 7769 7468 2070 7265 6469 6374  ata with predict
+00074550: 6f72 7320 6f6e 6c79 2e0d 0a20 2020 206d  ors only...    m
+00074560: 696e 5f6e 5f73 616d 706c 6573 203a 2069  in_n_samples : i
+00074570: 6e74 2c20 6465 6661 756c 743d 353a 206d  nt, default=5: m
+00074580: 696e 206e 756d 6265 7220 6f66 2073 616d  in number of sam
+00074590: 706c 6573 2062 656c 6f77 2077 6869 6368  ples below which
+000745a0: 2079 6f75 2063 6f6d 6269 6e65 2062 696e   you combine bin
+000745b0: 730d 0a20 2020 2062 696e 7320 3a20 696e  s..    bins : in
+000745c0: 742c 2064 6566 6175 6c74 3d33 3a20 686f  t, default=3: ho
+000745d0: 7720 6d61 6e79 2062 696e 7320 796f 7520  w many bins you 
+000745e0: 7761 6e74 2074 6f20 7370 6c69 7420 7461  want to split ta
+000745f0: 7267 6574 2069 6e74 6f0d 0a0d 0a20 2020  rget into....   
+00074600: 204f 7574 7075 7473 0d0a 2020 2020 2d2d   Outputs..    --
+00074610: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 6e5f  --------..    n_
+00074620: 6665 6174 7572 6573 5f20 3a20 696e 740d  features_ : int.
+00074630: 0a20 2020 2020 2020 2054 6865 206e 756d  .        The num
+00074640: 6265 7220 6f66 2066 6561 7475 7265 7320  ber of features 
+00074650: 6f66 2074 6865 2064 6174 6120 7061 7373  of the data pass
+00074660: 6564 2074 6f20 3a6d 6574 683a 6066 6974  ed to :meth:`fit
+00074670: 602e 0d0a 2020 2020 2222 220d 0a20 2020  `...    """..   
+00074680: 2078 5f74 7261 696e 5f63 203d 2063 6f70   x_train_c = cop
+00074690: 792e 6465 6570 636f 7079 2878 5f74 7261  y.deepcopy(x_tra
+000746a0: 696e 290d 0a20 2020 2078 5f74 7261 696e  in)..    x_train
+000746b0: 5f63 5b74 6172 6765 745d 203d 2079 5f74  _c[target] = y_t
+000746c0: 7261 696e 2e76 616c 7565 730d 0a0d 0a20  rain.values.... 
+000746d0: 2020 2023 2052 6567 7265 7373 696f 6e20     # Regression 
+000746e0: 7072 6f62 6c65 6d20 7475 726e 6564 2069  problem turned i
+000746f0: 6e74 6f20 436c 6173 7369 6669 6361 7469  nto Classificati
+00074700: 6f6e 2070 726f 626c 656d 0d0a 2020 2020  on problem..    
+00074710: 6e5f 636c 7573 7465 7273 203d 206d 6178  n_clusters = max
+00074720: 2833 2c20 696e 7428 6e70 2e6c 6f67 3130  (3, int(np.log10
+00074730: 286c 656e 2879 5f74 7261 696e 2929 2920  (len(y_train))) 
+00074740: 2b20 3129 0d0a 2020 2020 2320 5573 6520  + 1)..    # Use 
+00074750: 4b4d 6561 6e73 2074 6f20 6669 6e64 206e  KMeans to find n
+00074760: 6174 7572 616c 2063 6c75 7374 6572 7320  atural clusters 
+00074770: 696e 2079 6f75 7220 6461 7461 0d0a 2020  in your data..  
+00074780: 2020 6b6d 5f6d 6f64 656c 203d 204b 4d65    km_model = KMe
+00074790: 616e 7328 6e5f 636c 7573 7465 7273 3d6e  ans(n_clusters=n
+000747a0: 5f63 6c75 7374 6572 732c 0d0a 2020 2020  _clusters,..    
+000747b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000747c0: 2020 6e5f 696e 6974 3d35 2c0d 0a20 2020    n_init=5,..   
+000747d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000747e0: 2020 2072 616e 646f 6d5f 7374 6174 653d     random_state=
+000747f0: 3939 290d 0a20 2020 2023 2323 2320 7265  99)..    #### re
+00074800: 6d65 6d62 6572 2079 6f75 206d 7573 7420  member you must 
+00074810: 7072 6564 6963 7420 7573 696e 6720 6f6e  predict using on
+00074820: 6c79 2070 7265 6469 6374 6f72 2076 6172  ly predictor var
+00074830: 6961 626c 6573 210d 0a20 2020 2079 5f74  iables!..    y_t
+00074840: 7261 696e 5f63 203d 206b 6d5f 6d6f 6465  rain_c = km_mode
+00074850: 6c2e 6669 745f 7072 6564 6963 7428 785f  l.fit_predict(x_
+00074860: 7472 6169 6e29 0d0a 0d0a 2020 2020 6966  train)....    if
+00074870: 2076 6572 626f 7365 203e 3d20 313a 0d0a   verbose >= 1:..
+00074880: 2020 2020 2020 2020 7072 696e 7428 2720          print(' 
+00074890: 2020 204e 756d 6265 7220 6f66 2063 6c75     Number of clu
+000748a0: 7374 6572 7320 6372 6561 7465 6420 3d20  sters created = 
+000748b0: 2564 2720 256e 5f63 6c75 7374 6572 7329  %d' %n_clusters)
+000748c0: 0d0a 0d0a 2020 2020 2323 2323 2047 656e  ....    #### Gen
+000748d0: 6572 6174 6520 7468 6520 6f76 6572 2d73  erate the over-s
+000748e0: 616d 706c 6564 2064 6174 610d 0a20 2020  ampled data..   
+000748f0: 2023 2323 2320 4144 4153 594e 202f 2053   #### ADASYN / S
+00074900: 4d4f 5445 206f 7665 7273 616d 706c 696e  MOTE oversamplin
+00074910: 6720 2323 2323 230d 0a20 2020 2069 6620  g #####..    if 
+00074920: 6973 696e 7374 616e 6365 2873 6d6f 7465  isinstance(smote
+00074930: 2c20 7374 7229 3a0d 0a20 2020 2020 2020  , str):..       
+00074940: 2078 5f74 7261 696e 5f65 7874 2c20 5f20   x_train_ext, _ 
+00074950: 3d20 6f76 6572 7361 6d70 6c65 5f53 4d4f  = oversample_SMO
+00074960: 5445 2878 5f74 7261 696e 5f63 2c20 795f  TE(x_train_c, y_
+00074970: 7472 6169 6e5f 6329 0d0a 2020 2020 656c  train_c)..    el
+00074980: 7365 3a0d 0a20 2020 2020 2020 2078 5f74  se:..        x_t
+00074990: 7261 696e 5f65 7874 2c20 5f20 3d20 736d  rain_ext, _ = sm
+000749a0: 6f74 652e 6669 745f 7265 7361 6d70 6c65  ote.fit_resample
+000749b0: 2878 5f74 7261 696e 5f63 2c20 795f 7472  (x_train_c, y_tr
+000749c0: 6169 6e5f 6329 0d0a 2020 2020 795f 7472  ain_c)..    y_tr
+000749d0: 6169 6e5f 6578 7420 3d20 785f 7472 6169  ain_ext = x_trai
+000749e0: 6e5f 6578 745b 7461 7267 6574 5d2e 7661  n_ext[target].va
+000749f0: 6c75 6573 0d0a 2020 2020 785f 7472 6169  lues..    x_trai
+00074a00: 6e5f 6578 742e 6472 6f70 2874 6172 6765  n_ext.drop(targe
+00074a10: 742c 2061 7869 733d 312c 2069 6e70 6c61  t, axis=1, inpla
+00074a20: 6365 3d54 7275 6529 0d0a 2020 2020 7265  ce=True)..    re
+00074a30: 7475 726e 2028 785f 7472 6169 6e5f 6578  turn (x_train_ex
+00074a40: 742c 2079 5f74 7261 696e 5f65 7874 290d  t, y_train_ext).
+00074a50: 0a0d 0a23 2323 2323 2323 2323 2323 2323  ...#############
+00074a60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00074a70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00074a80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00074a90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00074aa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00074ab0: 2323 2323 0d0a 6672 6f6d 2073 6b6c 6561  ####..from sklea
-00074ac0: 726e 2e75 7469 6c73 2e63 6c61 7373 5f77  rn.utils.class_w
-00074ad0: 6569 6768 7420 696d 706f 7274 2063 6f6d  eight import com
-00074ae0: 7075 7465 5f63 6c61 7373 5f77 6569 6768  pute_class_weigh
-00074af0: 740d 0a64 6566 2067 6574 5f63 6c61 7373  t..def get_class
-00074b00: 5f64 6973 7472 6962 7574 696f 6e28 795f  _distribution(y_
-00074b10: 696e 7075 7429 3a0d 0a20 2020 2079 5f69  input):..    y_i
-00074b20: 6e70 7574 203d 2063 6f70 792e 6465 6570  nput = copy.deep
-00074b30: 636f 7079 2879 5f69 6e70 7574 290d 0a20  copy(y_input).. 
-00074b40: 2020 2063 6c61 7373 6573 203d 206e 702e     classes = np.
-00074b50: 756e 6971 7565 2879 5f69 6e70 7574 290d  unique(y_input).
-00074b60: 0a20 2020 2078 7020 3d20 436f 756e 7465  .    xp = Counte
-00074b70: 7228 795f 696e 7075 7429 0d0a 2020 2020  r(y_input)..    
-00074b80: 636c 6173 735f 7765 6967 6874 7320 3d20  class_weights = 
-00074b90: 636f 6d70 7574 655f 636c 6173 735f 7765  compute_class_we
-00074ba0: 6967 6874 2827 6261 6c61 6e63 6564 272c  ight('balanced',
-00074bb0: 2063 6c61 7373 6573 3d6e 702e 756e 6971   classes=np.uniq
-00074bc0: 7565 2879 5f69 6e70 7574 292c 2079 3d79  ue(y_input), y=y
-00074bd0: 5f69 6e70 7574 290d 0a20 2020 2069 6620  _input)..    if 
-00074be0: 6c65 6e28 636c 6173 735f 7765 6967 6874  len(class_weight
-00074bf0: 735b 2863 6c61 7373 5f77 6569 6768 7473  s[(class_weights
-00074c00: 3e20 3130 295d 2920 3e20 303a 0d0a 2020  > 10)]) > 0:..  
-00074c10: 2020 2020 2020 636c 6173 735f 7765 6967        class_weig
-00074c20: 6874 7320 3d20 2863 6c61 7373 5f77 6569  hts = (class_wei
-00074c30: 6768 7473 2f31 3029 0d0a 2020 2020 656c  ghts/10)..    el
-00074c40: 7365 3a0d 0a20 2020 2020 2020 2063 6c61  se:..        cla
-00074c50: 7373 5f77 6569 6768 7473 203d 2028 636c  ss_weights = (cl
-00074c60: 6173 735f 7765 6967 6874 7329 0d0a 2020  ass_weights)..  
-00074c70: 2020 7072 696e 7428 2720 2020 2063 6c61    print('    cla
-00074c80: 7373 5f77 6569 6768 7473 203d 2025 7327  ss_weights = %s'
-00074c90: 2025 636c 6173 735f 7765 6967 6874 7329   %class_weights)
-00074ca0: 0d0a 2020 2020 636c 6173 735f 7765 6967  ..    class_weig
-00074cb0: 6874 735b 2863 6c61 7373 5f77 6569 6768  hts[(class_weigh
-00074cc0: 7473 3c31 295d 3d31 0d0a 2020 2020 636c  ts<1)]=1..    cl
-00074cd0: 6173 735f 726f 7773 203d 2063 6c61 7373  ass_rows = class
-00074ce0: 5f77 6569 6768 7473 2a5b 7870 5b78 5d20  _weights*[xp[x] 
-00074cf0: 666f 7220 7820 696e 2063 6c61 7373 6573  for x in classes
-00074d00: 5d0d 0a20 2020 2063 6c61 7373 5f72 6f77  ]..    class_row
-00074d10: 7320 3d20 636c 6173 735f 726f 7773 2e61  s = class_rows.a
-00074d20: 7374 7970 6528 696e 7429 0d0a 2020 2020  stype(int)..    
-00074d30: 636c 6173 735f 7765 6967 6874 6564 5f72  class_weighted_r
-00074d40: 6f77 7320 3d20 6469 6374 287a 6970 2863  ows = dict(zip(c
-00074d50: 6c61 7373 6573 2c63 6c61 7373 5f72 6f77  lasses,class_row
-00074d60: 7329 290d 0a20 2020 2070 7269 6e74 2827  s))..    print('
-00074d70: 2020 2020 636c 6173 735f 7765 6967 6874      class_weight
-00074d80: 6564 5f72 6f77 7320 3d20 2573 2720 2563  ed_rows = %s' %c
-00074d90: 6c61 7373 5f77 6569 6768 7465 645f 726f  lass_weighted_ro
-00074da0: 7773 290d 0a20 2020 2072 6574 7572 6e20  ws)..    return 
-00074db0: 636c 6173 735f 7765 6967 6874 6564 5f72  class_weighted_r
-00074dc0: 6f77 730d 0a0d 0a64 6566 206f 7665 7273  ows....def overs
-00074dd0: 616d 706c 655f 534d 4f54 4528 582c 7929  ample_SMOTE(X,y)
-00074de0: 3a0d 0a20 2020 2023 696e 7075 7420 4461  :..    #input Da
-00074df0: 7461 4672 616d 650d 0a20 2020 2023 5820  taFrame..    #X 
-00074e00: e286 9249 6e64 6570 656e 6465 6e74 2056  ...Independent V
-00074e10: 6172 6961 626c 6520 696e 2044 6174 6146  ariable in DataF
-00074e20: 7261 6d65 5c0d 0a20 2020 2023 7920 e286  rame\..    #y ..
-00074e30: 9264 6570 656e 6465 6e74 2056 6172 6961  .dependent Varia
-00074e40: 626c 6520 696e 2050 616e 6461 7320 4461  ble in Pandas Da
-00074e50: 7461 4672 616d 6520 666f 726d 6174 0d0a  taFrame format..
-00074e60: 2020 2020 2320 4765 7420 7468 6520 636c      # Get the cl
-00074e70: 6173 7320 6469 7374 7269 7562 7469 6f6e  ass distriubtion
-00074e80: 2066 6f72 2070 6572 666f 6d69 6e67 2072   for perfoming r
-00074e90: 656c 6174 6976 6520 7361 6d70 6c69 6e67  elative sampling
-00074ea0: 2069 6e20 7468 6520 6e65 7874 206c 696e   in the next lin
-00074eb0: 650d 0a20 2020 2063 6c61 7373 5f77 6569  e..    class_wei
-00074ec0: 6768 7465 645f 726f 7773 203d 2067 6574  ghted_rows = get
-00074ed0: 5f63 6c61 7373 5f64 6973 7472 6962 7574  _class_distribut
-00074ee0: 696f 6e28 7929 0d0a 2020 2020 736d 6f74  ion(y)..    smot
-00074ef0: 6520 3d20 5356 4d53 4d4f 5445 2820 7261  e = SVMSMOTE( ra
-00074f00: 6e64 6f6d 5f73 7461 7465 3d32 372c 0d0a  ndom_state=27,..
-00074f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00074f20: 2020 7361 6d70 6c69 6e67 5f73 7472 6174    sampling_strat
-00074f30: 6567 793d 636c 6173 735f 7765 6967 6874  egy=class_weight
-00074f40: 6564 5f72 6f77 7329 0d0a 2020 2020 582c  ed_rows)..    X,
-00074f50: 2079 203d 2073 6d6f 7465 2e66 6974 5f72   y = smote.fit_r
-00074f60: 6573 616d 706c 6528 582c 2079 290d 0a20  esample(X, y).. 
-00074f70: 2020 2072 6574 7572 6e28 582c 7929 0d0a     return(X,y)..
-00074f80: 0d0a 6465 6620 6f76 6572 7361 6d70 6c65  ..def oversample
-00074f90: 5f41 4441 5359 4e28 582c 7929 3a0d 0a20  _ADASYN(X,y):.. 
-00074fa0: 2020 2023 696e 7075 7420 4461 7461 4672     #input DataFr
-00074fb0: 616d 650d 0a20 2020 2023 5820 e286 9249  ame..    #X ...I
-00074fc0: 6e64 6570 656e 6465 6e74 2056 6172 6961  ndependent Varia
-00074fd0: 626c 6520 696e 2044 6174 6146 7261 6d65  ble in DataFrame
-00074fe0: 5c0d 0a20 2020 2023 7920 e286 9264 6570  \..    #y ...dep
-00074ff0: 656e 6465 6e74 2056 6172 6961 626c 6520  endent Variable 
-00075000: 696e 2050 616e 6461 7320 4461 7461 4672  in Pandas DataFr
-00075010: 616d 6520 666f 726d 6174 0d0a 2020 2020  ame format..    
-00075020: 2320 4765 7420 7468 6520 636c 6173 7320  # Get the class 
-00075030: 6469 7374 7269 7562 7469 6f6e 2066 6f72  distriubtion for
-00075040: 2070 6572 666f 6d69 6e67 2072 656c 6174   perfoming relat
-00075050: 6976 6520 7361 6d70 6c69 6e67 2069 6e20  ive sampling in 
-00075060: 7468 6520 6e65 7874 206c 696e 650d 0a20  the next line.. 
-00075070: 2020 2063 6c61 7373 5f77 6569 6768 7465     class_weighte
-00075080: 645f 726f 7773 203d 2067 6574 5f63 6c61  d_rows = get_cla
-00075090: 7373 5f64 6973 7472 6962 7574 696f 6e28  ss_distribution(
-000750a0: 7929 0d0a 2020 2020 2320 596f 7572 2066  y)..    # Your f
-000750b0: 6176 6f75 7269 7465 206f 7665 7273 616d  avourite oversam
-000750c0: 706c 6572 0d0a 2020 2020 736d 6f74 6520  pler..    smote 
-000750d0: 3d20 4144 4153 594e 2872 616e 646f 6d5f  = ADASYN(random_
-000750e0: 7374 6174 653d 3237 2c0d 0a20 2020 2020  state=27,..     
-000750f0: 2020 2020 2020 2020 2020 2020 2020 7361                sa
-00075100: 6d70 6c69 6e67 5f73 7472 6174 6567 793d  mpling_strategy=
-00075110: 636c 6173 735f 7765 6967 6874 6564 5f72  class_weighted_r
-00075120: 6f77 7329 0d0a 2020 2020 582c 2079 203d  ows)..    X, y =
-00075130: 2073 6d6f 7465 2e66 6974 5f72 6573 616d   smote.fit_resam
-00075140: 706c 6528 582c 2079 290d 0a20 2020 2072  ple(X, y)..    r
-00075150: 6574 7572 6e28 582c 7929 0d0a 2323 2323  eturn(X,y)..####
+00074aa0: 2323 2323 230d 0a66 726f 6d20 736b 6c65  #####..from skle
+00074ab0: 6172 6e2e 7574 696c 732e 636c 6173 735f  arn.utils.class_
+00074ac0: 7765 6967 6874 2069 6d70 6f72 7420 636f  weight import co
+00074ad0: 6d70 7574 655f 636c 6173 735f 7765 6967  mpute_class_weig
+00074ae0: 6874 0d0a 6465 6620 6765 745f 636c 6173  ht..def get_clas
+00074af0: 735f 6469 7374 7269 6275 7469 6f6e 2879  s_distribution(y
+00074b00: 5f69 6e70 7574 293a 0d0a 2020 2020 795f  _input):..    y_
+00074b10: 696e 7075 7420 3d20 636f 7079 2e64 6565  input = copy.dee
+00074b20: 7063 6f70 7928 795f 696e 7075 7429 0d0a  pcopy(y_input)..
+00074b30: 2020 2020 636c 6173 7365 7320 3d20 6e70      classes = np
+00074b40: 2e75 6e69 7175 6528 795f 696e 7075 7429  .unique(y_input)
+00074b50: 0d0a 2020 2020 7870 203d 2043 6f75 6e74  ..    xp = Count
+00074b60: 6572 2879 5f69 6e70 7574 290d 0a20 2020  er(y_input)..   
+00074b70: 2063 6c61 7373 5f77 6569 6768 7473 203d   class_weights =
+00074b80: 2063 6f6d 7075 7465 5f63 6c61 7373 5f77   compute_class_w
+00074b90: 6569 6768 7428 2762 616c 616e 6365 6427  eight('balanced'
+00074ba0: 2c20 636c 6173 7365 733d 6e70 2e75 6e69  , classes=np.uni
+00074bb0: 7175 6528 795f 696e 7075 7429 2c20 793d  que(y_input), y=
+00074bc0: 795f 696e 7075 7429 0d0a 2020 2020 6966  y_input)..    if
+00074bd0: 206c 656e 2863 6c61 7373 5f77 6569 6768   len(class_weigh
+00074be0: 7473 5b28 636c 6173 735f 7765 6967 6874  ts[(class_weight
+00074bf0: 733e 2031 3029 5d29 203e 2030 3a0d 0a20  s> 10)]) > 0:.. 
+00074c00: 2020 2020 2020 2063 6c61 7373 5f77 6569         class_wei
+00074c10: 6768 7473 203d 2028 636c 6173 735f 7765  ghts = (class_we
+00074c20: 6967 6874 732f 3130 290d 0a20 2020 2065  ights/10)..    e
+00074c30: 6c73 653a 0d0a 2020 2020 2020 2020 636c  lse:..        cl
+00074c40: 6173 735f 7765 6967 6874 7320 3d20 2863  ass_weights = (c
+00074c50: 6c61 7373 5f77 6569 6768 7473 290d 0a20  lass_weights).. 
+00074c60: 2020 2070 7269 6e74 2827 2020 2020 636c     print('    cl
+00074c70: 6173 735f 7765 6967 6874 7320 3d20 2573  ass_weights = %s
+00074c80: 2720 2563 6c61 7373 5f77 6569 6768 7473  ' %class_weights
+00074c90: 290d 0a20 2020 2063 6c61 7373 5f77 6569  )..    class_wei
+00074ca0: 6768 7473 5b28 636c 6173 735f 7765 6967  ghts[(class_weig
+00074cb0: 6874 733c 3129 5d3d 310d 0a20 2020 2063  hts<1)]=1..    c
+00074cc0: 6c61 7373 5f72 6f77 7320 3d20 636c 6173  lass_rows = clas
+00074cd0: 735f 7765 6967 6874 732a 5b78 705b 785d  s_weights*[xp[x]
+00074ce0: 2066 6f72 2078 2069 6e20 636c 6173 7365   for x in classe
+00074cf0: 735d 0d0a 2020 2020 636c 6173 735f 726f  s]..    class_ro
+00074d00: 7773 203d 2063 6c61 7373 5f72 6f77 732e  ws = class_rows.
+00074d10: 6173 7479 7065 2869 6e74 290d 0a20 2020  astype(int)..   
+00074d20: 2063 6c61 7373 5f77 6569 6768 7465 645f   class_weighted_
+00074d30: 726f 7773 203d 2064 6963 7428 7a69 7028  rows = dict(zip(
+00074d40: 636c 6173 7365 732c 636c 6173 735f 726f  classes,class_ro
+00074d50: 7773 2929 0d0a 2020 2020 7072 696e 7428  ws))..    print(
+00074d60: 2720 2020 2063 6c61 7373 5f77 6569 6768  '    class_weigh
+00074d70: 7465 645f 726f 7773 203d 2025 7327 2025  ted_rows = %s' %
+00074d80: 636c 6173 735f 7765 6967 6874 6564 5f72  class_weighted_r
+00074d90: 6f77 7329 0d0a 2020 2020 7265 7475 726e  ows)..    return
+00074da0: 2063 6c61 7373 5f77 6569 6768 7465 645f   class_weighted_
+00074db0: 726f 7773 0d0a 0d0a 6465 6620 6f76 6572  rows....def over
+00074dc0: 7361 6d70 6c65 5f53 4d4f 5445 2858 2c79  sample_SMOTE(X,y
+00074dd0: 293a 0d0a 2020 2020 2369 6e70 7574 2044  ):..    #input D
+00074de0: 6174 6146 7261 6d65 0d0a 2020 2020 2358  ataFrame..    #X
+00074df0: 20e2 8692 496e 6465 7065 6e64 656e 7420   ...Independent 
+00074e00: 5661 7269 6162 6c65 2069 6e20 4461 7461  Variable in Data
+00074e10: 4672 616d 655c 0d0a 2020 2020 2379 20e2  Frame\..    #y .
+00074e20: 8692 6465 7065 6e64 656e 7420 5661 7269  ..dependent Vari
+00074e30: 6162 6c65 2069 6e20 5061 6e64 6173 2044  able in Pandas D
+00074e40: 6174 6146 7261 6d65 2066 6f72 6d61 740d  ataFrame format.
+00074e50: 0a20 2020 2023 2047 6574 2074 6865 2063  .    # Get the c
+00074e60: 6c61 7373 2064 6973 7472 6975 6274 696f  lass distriubtio
+00074e70: 6e20 666f 7220 7065 7266 6f6d 696e 6720  n for perfoming 
+00074e80: 7265 6c61 7469 7665 2073 616d 706c 696e  relative samplin
+00074e90: 6720 696e 2074 6865 206e 6578 7420 6c69  g in the next li
+00074ea0: 6e65 0d0a 2020 2020 636c 6173 735f 7765  ne..    class_we
+00074eb0: 6967 6874 6564 5f72 6f77 7320 3d20 6765  ighted_rows = ge
+00074ec0: 745f 636c 6173 735f 6469 7374 7269 6275  t_class_distribu
+00074ed0: 7469 6f6e 2879 290d 0a20 2020 2073 6d6f  tion(y)..    smo
+00074ee0: 7465 203d 2053 564d 534d 4f54 4528 2072  te = SVMSMOTE( r
+00074ef0: 616e 646f 6d5f 7374 6174 653d 3237 2c0d  andom_state=27,.
+00074f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00074f10: 2020 2073 616d 706c 696e 675f 7374 7261     sampling_stra
+00074f20: 7465 6779 3d63 6c61 7373 5f77 6569 6768  tegy=class_weigh
+00074f30: 7465 645f 726f 7773 290d 0a20 2020 2058  ted_rows)..    X
+00074f40: 2c20 7920 3d20 736d 6f74 652e 6669 745f  , y = smote.fit_
+00074f50: 7265 7361 6d70 6c65 2858 2c20 7929 0d0a  resample(X, y)..
+00074f60: 2020 2020 7265 7475 726e 2858 2c79 290d      return(X,y).
+00074f70: 0a0d 0a64 6566 206f 7665 7273 616d 706c  ...def oversampl
+00074f80: 655f 4144 4153 594e 2858 2c79 293a 0d0a  e_ADASYN(X,y):..
+00074f90: 2020 2020 2369 6e70 7574 2044 6174 6146      #input DataF
+00074fa0: 7261 6d65 0d0a 2020 2020 2358 20e2 8692  rame..    #X ...
+00074fb0: 496e 6465 7065 6e64 656e 7420 5661 7269  Independent Vari
+00074fc0: 6162 6c65 2069 6e20 4461 7461 4672 616d  able in DataFram
+00074fd0: 655c 0d0a 2020 2020 2379 20e2 8692 6465  e\..    #y ...de
+00074fe0: 7065 6e64 656e 7420 5661 7269 6162 6c65  pendent Variable
+00074ff0: 2069 6e20 5061 6e64 6173 2044 6174 6146   in Pandas DataF
+00075000: 7261 6d65 2066 6f72 6d61 740d 0a20 2020  rame format..   
+00075010: 2023 2047 6574 2074 6865 2063 6c61 7373   # Get the class
+00075020: 2064 6973 7472 6975 6274 696f 6e20 666f   distriubtion fo
+00075030: 7220 7065 7266 6f6d 696e 6720 7265 6c61  r perfoming rela
+00075040: 7469 7665 2073 616d 706c 696e 6720 696e  tive sampling in
+00075050: 2074 6865 206e 6578 7420 6c69 6e65 0d0a   the next line..
+00075060: 2020 2020 636c 6173 735f 7765 6967 6874      class_weight
+00075070: 6564 5f72 6f77 7320 3d20 6765 745f 636c  ed_rows = get_cl
+00075080: 6173 735f 6469 7374 7269 6275 7469 6f6e  ass_distribution
+00075090: 2879 290d 0a20 2020 2023 2059 6f75 7220  (y)..    # Your 
+000750a0: 6661 766f 7572 6974 6520 6f76 6572 7361  favourite oversa
+000750b0: 6d70 6c65 720d 0a20 2020 2073 6d6f 7465  mpler..    smote
+000750c0: 203d 2041 4441 5359 4e28 7261 6e64 6f6d   = ADASYN(random
+000750d0: 5f73 7461 7465 3d32 372c 0d0a 2020 2020  _state=27,..    
+000750e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000750f0: 616d 706c 696e 675f 7374 7261 7465 6779  ampling_strategy
+00075100: 3d63 6c61 7373 5f77 6569 6768 7465 645f  =class_weighted_
+00075110: 726f 7773 290d 0a20 2020 2058 2c20 7920  rows)..    X, y 
+00075120: 3d20 736d 6f74 652e 6669 745f 7265 7361  = smote.fit_resa
+00075130: 6d70 6c65 2858 2c20 7929 0d0a 2020 2020  mple(X, y)..    
+00075140: 7265 7475 726e 2858 2c79 290d 0a23 2323  return(X,y)..###
+00075150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00075160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00075170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00075180: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00075190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000751a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000751b0: 2323 2323 2323 230d 0a64 6566 206d 6172  #######..def mar
-000751c0: 7468 6173 5f63 6f6c 756d 6e73 2864 6174  thas_columns(dat
-000751d0: 612c 7665 7262 6f73 653d 3029 3a0d 0a20  a,verbose=0):.. 
-000751e0: 2020 2022 2222 0d0a 2020 2020 5468 6973     """..    This
-000751f0: 2070 726f 6772 616d 2069 7320 6e61 6d65   program is name
-00075200: 6420 2069 6e20 686f 6e6f 7220 6f66 206d  d  in honor of m
-00075210: 7920 6f6e 6520 6f66 2073 7475 6465 6e74  y one of student
-00075220: 732c 204d 6172 7468 612c 2077 686f 2063  s, Martha, who c
-00075230: 616d 6520 7570 2077 6974 6820 7468 6520  ame up with the 
-00075240: 6964 6561 2066 6f72 2069 742e 0d0a 2020  idea for it...  
-00075250: 2020 4974 2773 2061 206e 6561 7420 7761    It's a neat wa
-00075260: 7920 6f66 2070 7269 6e74 696e 6720 6461  y of printing da
-00075270: 7461 2074 7970 6573 2061 6e64 2069 6e66  ta types and inf
-00075280: 6f72 6d61 7469 6f6e 2063 6f6d 7061 7265  ormation compare
-00075290: 6420 746f 2074 6865 2062 6f72 696e 6720  d to the boring 
-000752a0: 6465 7363 7269 6265 2829 2066 756e 6374  describe() funct
-000752b0: 696f 6e20 696e 2050 616e 6461 732e 0d0a  ion in Pandas...
-000752c0: 2020 2020 2222 220d 0a20 2020 2064 6174      """..    dat
-000752d0: 6120 3d20 6461 7461 5b3a 5d0d 0a20 2020  a = data[:]..   
-000752e0: 2070 7269 6e74 2827 4461 7461 2053 6574   print('Data Set
-000752f0: 2053 6861 7065 3a20 2564 2072 6f77 732c   Shape: %d rows,
-00075300: 2025 6420 636f 6c73 2720 2520 6461 7461   %d cols' % data
-00075310: 2e73 6861 7065 290d 0a20 2020 2069 6620  .shape)..    if 
-00075320: 6461 7461 2e73 6861 7065 5b31 5d20 3e20  data.shape[1] > 
-00075330: 3330 3a0d 0a20 2020 2020 2020 2070 7269  30:..        pri
-00075340: 6e74 2827 546f 6f20 6d61 6e79 2063 6f6c  nt('Too many col
-00075350: 756d 6e73 2074 6f20 7072 696e 7427 290d  umns to print').
-00075360: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
-00075370: 2020 2020 6966 2076 6572 626f 7365 3d3d      if verbose==
-00075380: 313a 0d0a 2020 2020 2020 2020 2020 2020  1:..            
-00075390: 7072 696e 7428 2720 2020 2041 6464 6974  print('    Addit
-000753a0: 696f 6e61 6c20 6465 7461 696c 7320 6f6e  ional details on
-000753b0: 2063 6f6c 756d 6e73 3a27 290d 0a20 2020   columns:')..   
-000753c0: 2020 2020 2020 2020 2066 6f72 2063 6f6c           for col
-000753d0: 2069 6e20 6461 7461 2e63 6f6c 756d 6e73   in data.columns
-000753e0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000753f0: 2020 2070 7269 6e74 2827 5c74 2a20 2573     print('\t* %s
-00075400: 3a5c 7425 6420 6d69 7373 696e 672c 2025  :\t%d missing, %
-00075410: 6420 756e 6971 7565 732c 206d 6f73 7420  d uniques, most 
-00075420: 636f 6d6d 6f6e 3a20 2573 2720 2520 280d  common: %s' % (.
-00075430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00075440: 2020 2020 2020 2020 2063 6f6c 2c0d 0a20           col,.. 
-00075450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00075460: 2020 2020 2020 2064 6174 615b 636f 6c5d         data[col]
-00075470: 2e69 736e 756c 6c28 292e 7375 6d28 292c  .isnull().sum(),
-00075480: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00075490: 2020 2020 2020 2020 2020 6461 7461 5b63            data[c
-000754a0: 6f6c 5d2e 6e75 6e69 7175 6528 292c 0d0a  ol].nunique(),..
-000754b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000754c0: 2020 2020 2020 2020 6461 7461 5b63 6f6c          data[col
-000754d0: 5d2e 7661 6c75 655f 636f 756e 7473 2829  ].value_counts()
-000754e0: 2e68 6561 6428 3229 2e74 6f5f 6469 6374  .head(2).to_dict
-000754f0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00075500: 2020 2020 2020 2020 2929 0d0a 2020 2020          ))..    
-00075510: 2020 2020 2020 2020 7072 696e 7428 272d          print('-
+000751a0: 2323 2323 2323 2323 0d0a 6465 6620 6d61  ########..def ma
+000751b0: 7274 6861 735f 636f 6c75 6d6e 7328 6461  rthas_columns(da
+000751c0: 7461 2c76 6572 626f 7365 3d30 293a 0d0a  ta,verbose=0):..
+000751d0: 2020 2020 2222 220d 0a20 2020 2054 6869      """..    Thi
+000751e0: 7320 7072 6f67 7261 6d20 6973 206e 616d  s program is nam
+000751f0: 6564 2020 696e 2068 6f6e 6f72 206f 6620  ed  in honor of 
+00075200: 6d79 206f 6e65 206f 6620 7374 7564 656e  my one of studen
+00075210: 7473 2c20 4d61 7274 6861 2c20 7768 6f20  ts, Martha, who 
+00075220: 6361 6d65 2075 7020 7769 7468 2074 6865  came up with the
+00075230: 2069 6465 6120 666f 7220 6974 2e0d 0a20   idea for it... 
+00075240: 2020 2049 7427 7320 6120 6e65 6174 2077     It's a neat w
+00075250: 6179 206f 6620 7072 696e 7469 6e67 2064  ay of printing d
+00075260: 6174 6120 7479 7065 7320 616e 6420 696e  ata types and in
+00075270: 666f 726d 6174 696f 6e20 636f 6d70 6172  formation compar
+00075280: 6564 2074 6f20 7468 6520 626f 7269 6e67  ed to the boring
+00075290: 2064 6573 6372 6962 6528 2920 6675 6e63   describe() func
+000752a0: 7469 6f6e 2069 6e20 5061 6e64 6173 2e0d  tion in Pandas..
+000752b0: 0a20 2020 2022 2222 0d0a 2020 2020 6461  .    """..    da
+000752c0: 7461 203d 2064 6174 615b 3a5d 0d0a 2020  ta = data[:]..  
+000752d0: 2020 7072 696e 7428 2744 6174 6120 5365    print('Data Se
+000752e0: 7420 5368 6170 653a 2025 6420 726f 7773  t Shape: %d rows
+000752f0: 2c20 2564 2063 6f6c 7327 2025 2064 6174  , %d cols' % dat
+00075300: 612e 7368 6170 6529 0d0a 2020 2020 6966  a.shape)..    if
+00075310: 2064 6174 612e 7368 6170 655b 315d 203e   data.shape[1] >
+00075320: 2033 303a 0d0a 2020 2020 2020 2020 7072   30:..        pr
+00075330: 696e 7428 2754 6f6f 206d 616e 7920 636f  int('Too many co
+00075340: 6c75 6d6e 7320 746f 2070 7269 6e74 2729  lumns to print')
+00075350: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
+00075360: 2020 2020 2069 6620 7665 7262 6f73 653d       if verbose=
+00075370: 3d31 3a0d 0a20 2020 2020 2020 2020 2020  =1:..           
+00075380: 2070 7269 6e74 2827 2020 2020 4164 6469   print('    Addi
+00075390: 7469 6f6e 616c 2064 6574 6169 6c73 206f  tional details o
+000753a0: 6e20 636f 6c75 6d6e 733a 2729 0d0a 2020  n columns:')..  
+000753b0: 2020 2020 2020 2020 2020 666f 7220 636f            for co
+000753c0: 6c20 696e 2064 6174 612e 636f 6c75 6d6e  l in data.column
+000753d0: 733a 0d0a 2020 2020 2020 2020 2020 2020  s:..            
+000753e0: 2020 2020 7072 696e 7428 275c 742a 2025      print('\t* %
+000753f0: 733a 5c74 2564 206d 6973 7369 6e67 2c20  s:\t%d missing, 
+00075400: 2564 2075 6e69 7175 6573 2c20 6d6f 7374  %d uniques, most
+00075410: 2063 6f6d 6d6f 6e3a 2025 7327 2025 2028   common: %s' % (
+00075420: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00075430: 2020 2020 2020 2020 2020 636f 6c2c 0d0a            col,..
+00075440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00075450: 2020 2020 2020 2020 6461 7461 5b63 6f6c          data[col
+00075460: 5d2e 6973 6e75 6c6c 2829 2e73 756d 2829  ].isnull().sum()
+00075470: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00075480: 2020 2020 2020 2020 2020 2064 6174 615b             data[
+00075490: 636f 6c5d 2e6e 756e 6971 7565 2829 2c0d  col].nunique(),.
+000754a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000754b0: 2020 2020 2020 2020 2064 6174 615b 636f           data[co
+000754c0: 6c5d 2e76 616c 7565 5f63 6f75 6e74 7328  l].value_counts(
+000754d0: 292e 6865 6164 2832 292e 746f 5f64 6963  ).head(2).to_dic
+000754e0: 7428 290d 0a20 2020 2020 2020 2020 2020  t()..           
+000754f0: 2020 2020 2020 2020 2029 290d 0a20 2020           ))..   
+00075500: 2020 2020 2020 2020 2070 7269 6e74 2827           print('
+00075510: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00075520: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00075530: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00075540: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00075550: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00075560: 2d2d 2d27 290d 0a23 2323 2323 2323 2323  ---')..#########
+00075550: 2d2d 2d2d 2729 0d0a 2323 2323 2323 2323  ----')..########
+00075560: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00075570: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00075580: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00075590: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000755a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000755b0: 2323 2323 2323 2323 230d 0a64 6566 2067  #########..def g
-000755c0: 6574 5f73 697a 6528 6279 7465 732c 2073  et_size(bytes, s
-000755d0: 7566 6669 783d 2242 2229 3a0d 0a20 2020  uffix="B"):..   
-000755e0: 2022 2222 0d0a 2020 2020 5363 616c 6520   """..    Scale 
-000755f0: 6279 7465 7320 746f 2069 7473 2070 726f  bytes to its pro
-00075600: 7065 7220 666f 726d 6174 0d0a 2020 2020  per format..    
-00075610: 652e 673a 0d0a 2020 2020 2020 2020 3132  e.g:..        12
-00075620: 3533 3635 3620 3d3e 2027 312e 3230 4d42  53656 => '1.20MB
-00075630: 270d 0a20 2020 2020 2020 2031 3235 3336  '..        12536
-00075640: 3536 3637 3820 3d3e 2027 312e 3137 4742  56678 => '1.17GB
-00075650: 270d 0a20 2020 2022 2222 0d0a 2020 2020  '..    """..    
-00075660: 6661 6374 6f72 203d 2031 3032 340d 0a20  factor = 1024.. 
-00075670: 2020 2066 6f72 2075 6e69 7420 696e 205b     for unit in [
-00075680: 2222 2c20 224b 222c 2022 4d22 2c20 2247  "", "K", "M", "G
-00075690: 222c 2022 5422 2c20 2250 225d 3a0d 0a20  ", "T", "P"]:.. 
-000756a0: 2020 2020 2020 2069 6620 6279 7465 7320         if bytes 
-000756b0: 3c20 6661 6374 6f72 3a0d 0a20 2020 2020  < factor:..     
-000756c0: 2020 2020 2020 2072 6574 7572 6e20 6622         return f"
-000756d0: 7b62 7974 6573 3a2e 3266 7d7b 756e 6974  {bytes:.2f}{unit
-000756e0: 7d7b 7375 6666 6978 7d22 0d0a 2020 2020  }{suffix}"..    
-000756f0: 2020 2020 6279 7465 7320 2f3d 2066 6163      bytes /= fac
-00075700: 746f 720d 0a0d 0a64 6566 2070 7269 6e74  tor....def print
-00075710: 5f73 7973 7465 6d5f 696e 666f 2829 3a0d  _system_info():.
-00075720: 0a20 2020 2022 2222 0d0a 2020 2020 5468  .    """..    Th
-00075730: 6973 2070 7269 6e74 7320 7468 6520 696e  is prints the in
-00075740: 666f 726d 6174 696f 6e20 6f6e 2074 6865  formation on the
-00075750: 2068 6172 6477 6172 6520 7275 6e6e 696e   hardware runnin
-00075760: 6720 7468 6520 5079 7468 6f6e 2063 6f64  g the Python cod
-00075770: 6520 0d0a 2020 2020 4d61 6e79 2074 6861  e ..    Many tha
-00075780: 6e6b 7320 746f 3a20 6874 7470 733a 2f2f  nks to: https://
-00075790: 7777 772e 7468 6570 7974 686f 6e63 6f64  www.thepythoncod
-000757a0: 652e 636f 6d2f 6172 7469 636c 652f 6765  e.com/article/ge
-000757b0: 742d 6861 7264 7761 7265 2d73 7973 7465  t-hardware-syste
-000757c0: 6d2d 696e 666f 726d 6174 696f 6e2d 7079  m-information-py
-000757d0: 7468 6f6e 0d0a 2020 2020 2222 220d 0a20  thon..    """.. 
-000757e0: 2020 2069 6d70 6f72 7420 7073 7574 696c     import psutil
-000757f0: 0d0a 2020 2020 696d 706f 7274 2070 6c61  ..    import pla
-00075800: 7466 6f72 6d0d 0a20 2020 2070 7269 6e74  tform..    print
-00075810: 2822 3d22 2a32 302c 2022 5379 7374 656d  ("="*20, "System
-00075820: 2049 6e66 6f72 6d61 7469 6f6e 222c 2022   Information", "
-00075830: 3d22 2a32 3029 0d0a 2020 2020 756e 616d  ="*20)..    unam
-00075840: 6520 3d20 706c 6174 666f 726d 2e75 6e61  e = platform.una
-00075850: 6d65 2829 0d0a 2020 2020 7072 696e 7428  me()..    print(
-00075860: 6622 5379 7374 656d 3a20 7b75 6e61 6d65  f"System: {uname
-00075870: 2e73 7973 7465 6d7d 2229 0d0a 2020 2020  .system}")..    
-00075880: 7072 696e 7428 6622 4e6f 6465 204e 616d  print(f"Node Nam
-00075890: 653a 207b 756e 616d 652e 6e6f 6465 7d22  e: {uname.node}"
-000758a0: 290d 0a20 2020 2070 7269 6e74 2866 2252  )..    print(f"R
-000758b0: 656c 6561 7365 3a20 7b75 6e61 6d65 2e72  elease: {uname.r
-000758c0: 656c 6561 7365 7d22 290d 0a20 2020 2070  elease}")..    p
-000758d0: 7269 6e74 2866 2256 6572 7369 6f6e 3a20  rint(f"Version: 
-000758e0: 7b75 6e61 6d65 2e76 6572 7369 6f6e 7d22  {uname.version}"
-000758f0: 290d 0a20 2020 2070 7269 6e74 2866 224d  )..    print(f"M
-00075900: 6163 6869 6e65 3a20 7b75 6e61 6d65 2e6d  achine: {uname.m
-00075910: 6163 6869 6e65 7d22 290d 0a20 2020 2070  achine}")..    p
-00075920: 7269 6e74 2866 2250 726f 6365 7373 6f72  rint(f"Processor
-00075930: 3a20 7b75 6e61 6d65 2e70 726f 6365 7373  : {uname.process
-00075940: 6f72 7d22 290d 0a20 2020 2070 7269 6e74  or}")..    print
-00075950: 2822 3d22 2a32 322c 2022 4350 5520 496e  ("="*22, "CPU In
-00075960: 666f 726d 6174 696f 6e22 2c20 223d 222a  formation", "="*
-00075970: 3232 290d 0a20 2020 2023 206e 756d 6265  22)..    # numbe
-00075980: 7220 6f66 2063 6f72 6573 0d0a 2020 2020  r of cores..    
-00075990: 7072 696e 7428 2250 6879 7369 6361 6c20  print("Physical 
-000759a0: 636f 7265 733a 222c 2070 7375 7469 6c2e  cores:", psutil.
-000759b0: 6370 755f 636f 756e 7428 6c6f 6769 6361  cpu_count(logica
-000759c0: 6c3d 4661 6c73 6529 290d 0a20 2020 2070  l=False))..    p
-000759d0: 7269 6e74 2822 546f 7461 6c20 636f 7265  rint("Total core
-000759e0: 733a 222c 2070 7375 7469 6c2e 6370 755f  s:", psutil.cpu_
-000759f0: 636f 756e 7428 6c6f 6769 6361 6c3d 5472  count(logical=Tr
-00075a00: 7565 2929 0d0a 2020 2020 7072 696e 7428  ue))..    print(
-00075a10: 223d 222a 3230 2c20 224d 656d 6f72 7920  "="*20, "Memory 
-00075a20: 496e 666f 726d 6174 696f 6e22 2c20 223d  Information", "=
-00075a30: 222a 3230 290d 0a20 2020 2023 2067 6574  "*20)..    # get
-00075a40: 2074 6865 206d 656d 6f72 7920 6465 7461   the memory deta
-00075a50: 696c 730d 0a20 2020 2073 766d 656d 203d  ils..    svmem =
-00075a60: 2070 7375 7469 6c2e 7669 7274 7561 6c5f   psutil.virtual_
-00075a70: 6d65 6d6f 7279 2829 0d0a 2020 2020 7072  memory()..    pr
-00075a80: 696e 7428 6622 546f 7461 6c3a 207b 6765  int(f"Total: {ge
-00075a90: 745f 7369 7a65 2873 766d 656d 2e74 6f74  t_size(svmem.tot
-00075aa0: 616c 297d 2229 0d0a 2020 2020 7072 696e  al)}")..    prin
-00075ab0: 7428 6622 4176 6169 6c61 626c 653a 207b  t(f"Available: {
-00075ac0: 6765 745f 7369 7a65 2873 766d 656d 2e61  get_size(svmem.a
-00075ad0: 7661 696c 6162 6c65 297d 2229 0d0a 2020  vailable)}")..  
-00075ae0: 2020 7072 696e 7428 6622 5573 6564 3a20    print(f"Used: 
-00075af0: 7b67 6574 5f73 697a 6528 7376 6d65 6d2e  {get_size(svmem.
-00075b00: 7573 6564 297d 2229 0d0a 2020 2020 7072  used)}")..    pr
-00075b10: 696e 7428 223d 222a 3138 2c20 2253 7973  int("="*18, "Sys
-00075b20: 7465 6d20 496e 666f 726d 6174 696f 6e20  tem Information 
-00075b30: 456e 6422 2c20 223d 222a 3138 290d 0a23  End", "="*18)..#
+000755a0: 2323 2323 2323 2323 2323 0d0a 6465 6620  ##########..def 
+000755b0: 6765 745f 7369 7a65 2862 7974 6573 2c20  get_size(bytes, 
+000755c0: 7375 6666 6978 3d22 4222 293a 0d0a 2020  suffix="B"):..  
+000755d0: 2020 2222 220d 0a20 2020 2053 6361 6c65    """..    Scale
+000755e0: 2062 7974 6573 2074 6f20 6974 7320 7072   bytes to its pr
+000755f0: 6f70 6572 2066 6f72 6d61 740d 0a20 2020  oper format..   
+00075600: 2065 2e67 3a0d 0a20 2020 2020 2020 2031   e.g:..        1
+00075610: 3235 3336 3536 203d 3e20 2731 2e32 304d  253656 => '1.20M
+00075620: 4227 0d0a 2020 2020 2020 2020 3132 3533  B'..        1253
+00075630: 3635 3636 3738 203d 3e20 2731 2e31 3747  656678 => '1.17G
+00075640: 4227 0d0a 2020 2020 2222 220d 0a20 2020  B'..    """..   
+00075650: 2066 6163 746f 7220 3d20 3130 3234 0d0a   factor = 1024..
+00075660: 2020 2020 666f 7220 756e 6974 2069 6e20      for unit in 
+00075670: 5b22 222c 2022 4b22 2c20 224d 222c 2022  ["", "K", "M", "
+00075680: 4722 2c20 2254 222c 2022 5022 5d3a 0d0a  G", "T", "P"]:..
+00075690: 2020 2020 2020 2020 6966 2062 7974 6573          if bytes
+000756a0: 203c 2066 6163 746f 723a 0d0a 2020 2020   < factor:..    
+000756b0: 2020 2020 2020 2020 7265 7475 726e 2066          return f
+000756c0: 227b 6279 7465 733a 2e32 667d 7b75 6e69  "{bytes:.2f}{uni
+000756d0: 747d 7b73 7566 6669 787d 220d 0a20 2020  t}{suffix}"..   
+000756e0: 2020 2020 2062 7974 6573 202f 3d20 6661       bytes /= fa
+000756f0: 6374 6f72 0d0a 0d0a 6465 6620 7072 696e  ctor....def prin
+00075700: 745f 7379 7374 656d 5f69 6e66 6f28 293a  t_system_info():
+00075710: 0d0a 2020 2020 2222 220d 0a20 2020 2054  ..    """..    T
+00075720: 6869 7320 7072 696e 7473 2074 6865 2069  his prints the i
+00075730: 6e66 6f72 6d61 7469 6f6e 206f 6e20 7468  nformation on th
+00075740: 6520 6861 7264 7761 7265 2072 756e 6e69  e hardware runni
+00075750: 6e67 2074 6865 2050 7974 686f 6e20 636f  ng the Python co
+00075760: 6465 200d 0a20 2020 204d 616e 7920 7468  de ..    Many th
+00075770: 616e 6b73 2074 6f3a 2068 7474 7073 3a2f  anks to: https:/
+00075780: 2f77 7777 2e74 6865 7079 7468 6f6e 636f  /www.thepythonco
+00075790: 6465 2e63 6f6d 2f61 7274 6963 6c65 2f67  de.com/article/g
+000757a0: 6574 2d68 6172 6477 6172 652d 7379 7374  et-hardware-syst
+000757b0: 656d 2d69 6e66 6f72 6d61 7469 6f6e 2d70  em-information-p
+000757c0: 7974 686f 6e0d 0a20 2020 2022 2222 0d0a  ython..    """..
+000757d0: 2020 2020 696d 706f 7274 2070 7375 7469      import psuti
+000757e0: 6c0d 0a20 2020 2069 6d70 6f72 7420 706c  l..    import pl
+000757f0: 6174 666f 726d 0d0a 2020 2020 7072 696e  atform..    prin
+00075800: 7428 223d 222a 3230 2c20 2253 7973 7465  t("="*20, "Syste
+00075810: 6d20 496e 666f 726d 6174 696f 6e22 2c20  m Information", 
+00075820: 223d 222a 3230 290d 0a20 2020 2075 6e61  "="*20)..    una
+00075830: 6d65 203d 2070 6c61 7466 6f72 6d2e 756e  me = platform.un
+00075840: 616d 6528 290d 0a20 2020 2070 7269 6e74  ame()..    print
+00075850: 2866 2253 7973 7465 6d3a 207b 756e 616d  (f"System: {unam
+00075860: 652e 7379 7374 656d 7d22 290d 0a20 2020  e.system}")..   
+00075870: 2070 7269 6e74 2866 224e 6f64 6520 4e61   print(f"Node Na
+00075880: 6d65 3a20 7b75 6e61 6d65 2e6e 6f64 657d  me: {uname.node}
+00075890: 2229 0d0a 2020 2020 7072 696e 7428 6622  ")..    print(f"
+000758a0: 5265 6c65 6173 653a 207b 756e 616d 652e  Release: {uname.
+000758b0: 7265 6c65 6173 657d 2229 0d0a 2020 2020  release}")..    
+000758c0: 7072 696e 7428 6622 5665 7273 696f 6e3a  print(f"Version:
+000758d0: 207b 756e 616d 652e 7665 7273 696f 6e7d   {uname.version}
+000758e0: 2229 0d0a 2020 2020 7072 696e 7428 6622  ")..    print(f"
+000758f0: 4d61 6368 696e 653a 207b 756e 616d 652e  Machine: {uname.
+00075900: 6d61 6368 696e 657d 2229 0d0a 2020 2020  machine}")..    
+00075910: 7072 696e 7428 6622 5072 6f63 6573 736f  print(f"Processo
+00075920: 723a 207b 756e 616d 652e 7072 6f63 6573  r: {uname.proces
+00075930: 736f 727d 2229 0d0a 2020 2020 7072 696e  sor}")..    prin
+00075940: 7428 223d 222a 3232 2c20 2243 5055 2049  t("="*22, "CPU I
+00075950: 6e66 6f72 6d61 7469 6f6e 222c 2022 3d22  nformation", "="
+00075960: 2a32 3229 0d0a 2020 2020 2320 6e75 6d62  *22)..    # numb
+00075970: 6572 206f 6620 636f 7265 730d 0a20 2020  er of cores..   
+00075980: 2070 7269 6e74 2822 5068 7973 6963 616c   print("Physical
+00075990: 2063 6f72 6573 3a22 2c20 7073 7574 696c   cores:", psutil
+000759a0: 2e63 7075 5f63 6f75 6e74 286c 6f67 6963  .cpu_count(logic
+000759b0: 616c 3d46 616c 7365 2929 0d0a 2020 2020  al=False))..    
+000759c0: 7072 696e 7428 2254 6f74 616c 2063 6f72  print("Total cor
+000759d0: 6573 3a22 2c20 7073 7574 696c 2e63 7075  es:", psutil.cpu
+000759e0: 5f63 6f75 6e74 286c 6f67 6963 616c 3d54  _count(logical=T
+000759f0: 7275 6529 290d 0a20 2020 2070 7269 6e74  rue))..    print
+00075a00: 2822 3d22 2a32 302c 2022 4d65 6d6f 7279  ("="*20, "Memory
+00075a10: 2049 6e66 6f72 6d61 7469 6f6e 222c 2022   Information", "
+00075a20: 3d22 2a32 3029 0d0a 2020 2020 2320 6765  ="*20)..    # ge
+00075a30: 7420 7468 6520 6d65 6d6f 7279 2064 6574  t the memory det
+00075a40: 6169 6c73 0d0a 2020 2020 7376 6d65 6d20  ails..    svmem 
+00075a50: 3d20 7073 7574 696c 2e76 6972 7475 616c  = psutil.virtual
+00075a60: 5f6d 656d 6f72 7928 290d 0a20 2020 2070  _memory()..    p
+00075a70: 7269 6e74 2866 2254 6f74 616c 3a20 7b67  rint(f"Total: {g
+00075a80: 6574 5f73 697a 6528 7376 6d65 6d2e 746f  et_size(svmem.to
+00075a90: 7461 6c29 7d22 290d 0a20 2020 2070 7269  tal)}")..    pri
+00075aa0: 6e74 2866 2241 7661 696c 6162 6c65 3a20  nt(f"Available: 
+00075ab0: 7b67 6574 5f73 697a 6528 7376 6d65 6d2e  {get_size(svmem.
+00075ac0: 6176 6169 6c61 626c 6529 7d22 290d 0a20  available)}").. 
+00075ad0: 2020 2070 7269 6e74 2866 2255 7365 643a     print(f"Used:
+00075ae0: 207b 6765 745f 7369 7a65 2873 766d 656d   {get_size(svmem
+00075af0: 2e75 7365 6429 7d22 290d 0a20 2020 2070  .used)}")..    p
+00075b00: 7269 6e74 2822 3d22 2a31 382c 2022 5379  rint("="*18, "Sy
+00075b10: 7374 656d 2049 6e66 6f72 6d61 7469 6f6e  stem Information
+00075b20: 2045 6e64 222c 2022 3d22 2a31 3829 0d0a   End", "="*18)..
+00075b30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00075b40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00075b50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00075b60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00075b70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075b80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00075b90: 2323 2323 0000 0000 0000 0000 0000 0000  ####............
+00075b80: 2323 2323 2300 0000 0000 0000 0000 0000  #####...........
+00075b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00075ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00075bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00075bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00075bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00075be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00075bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00075c00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
@@ -30202,24 +30202,24 @@
 00075f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00075fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00075fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00075fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00075fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00075fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00075ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00076000: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00076000: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00076010: 2f61 7574 6f76 696d 6c2f 5175 6963 6b4d  /autoviml/QuickM
 00076020: 4c5f 456e 7365 6d62 6c69 6e67 2e70 7900  L_Ensembling.py.
 00076030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00076040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00076050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00076060: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00076070: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00076080: 3030 3332 3634 3400 3030 3030 3030 3030  0032644.00000000
-00076090: 3030 3000 3032 3130 3036 0020 3000 0000  000.021006. 0...
+00076090: 3030 3000 3032 3130 3037 0020 3000 0000  000.021007. 0...
 000760a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000760b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000760c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000760d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000760e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000760f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00076100: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -31162,24 +31162,24 @@
 00079b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00079ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00079bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00079bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00079bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00079be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00079bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00079c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00079c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00079c10: 2f61 7574 6f76 696d 6c2f 5175 6963 6b4d  /autoviml/QuickM
 00079c20: 4c5f 5374 6163 6b69 6e67 2e70 7900 0000  L_Stacking.py...
 00079c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00079c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00079c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00079c60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00079c70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00079c80: 3030 3236 3237 3600 3030 3030 3030 3030  0026276.00000000
-00079c90: 3030 3000 3032 3034 3732 0020 3000 0000  000.020472. 0...
+00079c90: 3030 3000 3032 3034 3733 0020 3000 0000  000.020473. 0...
 00079ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00079cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00079cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00079cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00079ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00079cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00079d00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -31994,24 +31994,24 @@
 0007cf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007cfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007cfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007cfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007cfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007cfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007cff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007d000: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+0007d000: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 0007d010: 2f61 7574 6f76 696d 6c2f 5472 616e 7366  /autoviml/Transf
 0007d020: 6f72 6d5f 4b4d 5f46 6561 7475 7265 732e  orm_KM_Features.
 0007d030: 7079 0000 0000 0000 0000 0000 0000 0000  py..............
 0007d040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d060: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 0007d070: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 0007d080: 3030 3135 3332 3300 3030 3030 3030 3030  0015323.00000000
-0007d090: 3030 3000 3032 3135 3331 0020 3000 0000  000.021531. 0...
+0007d090: 3030 3000 3032 3135 3332 0020 3000 0000  000.021532. 0...
 0007d0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007d100: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -32538,24 +32538,24 @@
 0007f190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007f1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007f1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007f1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007f1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007f1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007f1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007f200: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+0007f200: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 0007f210: 2f61 7574 6f76 696d 6c2f 5f5f 696e 6974  /autoviml/__init
 0007f220: 5f5f 2e70 7900 0000 0000 0000 0000 0000  __.py...........
 0007f230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007f240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007f250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007f260: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 0007f270: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 0007f280: 3030 3033 3236 3400 3030 3030 3030 3030  0003264.00000000
-0007f290: 3030 3000 3031 3730 3731 0020 3000 0000  000.017071. 0...
+0007f290: 3030 3000 3031 3730 3732 0020 3000 0000  000.017072. 0...
 0007f2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007f2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007f2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007f2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007f2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007f2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007f300: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -32730,16 +32730,16 @@
 0007fd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0007fe00: 3232 206d 7469 6d65 3d31 3637 3832 3335  22 mtime=1678235
-0007fe10: 3832 372e 300a 0000 0000 0000 0000 0000  827.0...........
+0007fe00: 3232 206d 7469 6d65 3d31 3638 3139 3033  22 mtime=1681903
+0007fe10: 3731 322e 300a 0000 0000 0000 0000 0000  712.0...........
 0007fe20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fe30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fe40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fe50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fe60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fe70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fe80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -32762,24 +32762,24 @@
 0007ff90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007ffa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007ffb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007ffc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007ffd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007ffe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0007fff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080000: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00080000: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00080010: 2f61 7574 6f76 696d 6c2f 5f5f 7665 7273  /autoviml/__vers
 00080020: 696f 6e5f 5f2e 7079 0000 0000 0000 0000  ion__.py........
 00080030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080060: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00080070: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00080080: 3030 3030 3633 3300 3030 3030 3030 3030  0000633.00000000
-00080090: 3030 3000 3031 3736 3130 0020 3000 0000  000.017610. 0...
+00080090: 3030 3000 3031 3736 3131 0020 3000 0000  000.017611. 0...
 000800a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000800b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000800c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000800d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000800e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000800f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080100: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -32813,15 +32813,15 @@
 000802c0: 7461 626c 6520 4d4c 204d 6f64 656c 7320  table ML Models 
 000802d0: 696e 2053 696e 676c 6520 4c69 6e65 206f  in Single Line o
 000802e0: 6620 436f 6465 220d 0a5f 5f75 726c 5f5f  f Code"..__url__
 000802f0: 203d 2022 6874 7470 733a 2f2f 6769 7468   = "https://gith
 00080300: 7562 2e63 6f6d 2f41 7574 6f56 694d 4c2f  ub.com/AutoViML/
 00080310: 4175 746f 5f56 694d 4c2e 6769 7422 0d0a  Auto_ViML.git"..
 00080320: 5f5f 7665 7273 696f 6e5f 5f20 3d20 2230  __version__ = "0
-00080330: 2e31 2e37 3133 220d 0a5f 5f6e 6c70 5f76  .1.713"..__nlp_v
+00080330: 2e31 2e37 3134 220d 0a5f 5f6e 6c70 5f76  .1.714"..__nlp_v
 00080340: 6572 7369 6f6e 5f5f 203d 2022 302e 312e  ersion__ = "0.1.
 00080350: 3031 220d 0a5f 5f6c 6963 656e 7365 5f5f  01"..__license__
 00080360: 203d 2022 4170 6163 6865 204c 6963 656e   = "Apache Licen
 00080370: 7365 2032 2e30 220d 0a5f 5f63 6f70 7972  se 2.0"..__copyr
 00080380: 6967 6874 5f5f 203d 2022 3230 3230 2d32  ight__ = "2020-2
 00080390: 3120 476f 6f67 6c65 220d 0a00 0000 0000  1 Google".......
 000803a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -32890,24 +32890,24 @@
 00080790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000807a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000807b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000807c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000807d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000807e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000807f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00080800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00080800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00080810: 2f61 7574 6f76 696d 6c2f 636c 6173 7369  /autoviml/classi
 00080820: 6679 5f6d 6574 686f 642e 7079 0000 0000  fy_method.py....
 00080830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080860: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00080870: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00080880: 3030 3433 3630 3200 3030 3030 3030 3030  0043602.00000000
-00080890: 3030 3000 3032 3035 3037 0020 3000 0000  000.020507. 0...
+00080890: 3030 3000 3032 3035 3130 0020 3000 0000  000.020510. 0...
 000808a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000808b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000808c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000808d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000808e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000808f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00080900: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -34138,24 +34138,24 @@
 00085590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000855a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000855b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000855c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000855d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000855e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000855f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00085600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00085600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00085610: 2f61 7574 6f76 696d 6c2f 6375 7374 6f6d  /autoviml/custom
 00085620: 5f73 636f 7265 732e 7079 0000 0000 0000  _scores.py......
 00085630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00085640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00085650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00085660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00085670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00085680: 3030 3132 3536 3400 3030 3030 3030 3030  0012564.00000000
-00085690: 3030 3000 3032 3032 3235 0020 3000 0000  000.020225. 0...
+00085690: 3030 3000 3032 3032 3236 0020 3000 0000  000.020226. 0...
 000856a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000856b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000856c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000856d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000856e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000856f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00085700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -34586,24 +34586,24 @@
 00087190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000871a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000871b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000871c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000871d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000871e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000871f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00087200: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00087200: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00087210: 2f61 7574 6f76 696d 6c2f 6375 7374 6f6d  /autoviml/custom
 00087220: 5f73 636f 7265 735f 484f 2e70 7900 0000  _scores_HO.py...
 00087230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00087240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00087250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00087260: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00087270: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00087280: 3030 3230 3630 3500 3030 3030 3030 3030  0020605.00000000
-00087290: 3030 3000 3032 3036 3036 0020 3000 0000  000.020606. 0...
+00087290: 3030 3000 3032 3036 3037 0020 3000 0000  000.020607. 0...
 000872a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000872b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000872c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000872d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000872e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000872f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00087300: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -35226,24 +35226,24 @@
 00089990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000899a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000899b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000899c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000899d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000899e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000899f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00089a00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00089a00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00089a10: 2f61 7574 6f76 696d 6c2f 6665 6174 7572  /autoviml/featur
 00089a20: 655f 656e 6769 6e65 6572 696e 672e 7079  e_engineering.py
 00089a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00089a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00089a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00089a60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00089a70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00089a80: 3030 3433 3237 3000 3030 3030 3030 3030  0043270.00000000
-00089a90: 3030 3000 3032 3133 3430 0020 3000 0000  000.021340. 0...
+00089a90: 3030 3000 3032 3133 3431 0020 3000 0000  000.021341. 0...
 00089aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00089ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00089ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00089ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00089ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00089af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00089b00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -36474,24 +36474,24 @@
 0008e790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008e7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008e7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008e7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008e7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008e7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008e7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0008e800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+0008e800: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 0008e810: 2f61 7574 6f76 696d 6c2f 7375 6c6f 765f  /autoviml/sulov_
 0008e820: 6d65 7468 6f64 2e70 7900 0000 0000 0000  method.py.......
 0008e830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008e840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008e850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008e860: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 0008e870: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 0008e880: 3030 3333 3234 3500 3030 3030 3030 3030  0033245.00000000
-0008e890: 3030 3000 3032 3030 3434 0020 3000 0000  000.020044. 0...
+0008e890: 3030 3000 3032 3030 3435 0020 3000 0000  000.020045. 0...
 0008e8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008e8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008e8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008e8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008e8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008e8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0008e900: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -37410,16 +37410,16 @@
 00092210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00092270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00092280: 3030 3030 3033 3300 3030 3030 3030 3030  0000033.00000000
-00092290: 3030 3000 3031 3134 3531 0020 7800 0000  000.011451. x...
+00092280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00092290: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
 000922a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000922b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000922c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000922d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000922e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000922f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
@@ -37434,16 +37434,16 @@
 00092390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000923a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000923b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000923c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000923d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000923e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000923f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092400: 3237 206d 7469 6d65 3d31 3637 3832 3833  27 mtime=1678283
-00092410: 3737 302e 3737 3939 3838 0a00 0000 0000  770.779988......
+00092400: 3238 206d 7469 6d65 3d31 3638 3139 3033  28 mtime=1681903
+00092410: 3937 382e 3638 3539 3938 370a 0000 0000  978.6859987.....
 00092420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -37466,24 +37466,24 @@
 00092590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000925a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000925b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000925c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000925d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000925e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000925f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00092600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00092610: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
 00092620: 666f 2f00 0000 0000 0000 0000 0000 0000  fo/.............
 00092630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00092670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00092680: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
-00092690: 3030 3000 3031 3634 3432 0020 3500 0000  000.016442. 5...
+00092690: 3030 3000 3031 3634 3433 0020 3500 0000  000.016443. 5...
 000926a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000926b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000926c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000926d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000926e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000926f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -37530,16 +37530,16 @@
 00092990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000929a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000929b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000929c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000929d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000929e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000929f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092a00: 3232 206d 7469 6d65 3d31 3637 3832 3833  22 mtime=1678283
-00092a10: 3736 392e 300a 0000 0000 0000 0000 0000  769.0...........
+00092a00: 3232 206d 7469 6d65 3d31 3638 3139 3033  22 mtime=1681903
+00092a10: 3937 372e 300a 0000 0000 0000 0000 0000  977.0...........
 00092a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -37562,24 +37562,24 @@
 00092b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00092c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00092c00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00092c10: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
 00092c20: 666f 2f50 4b47 2d49 4e46 4f00 0000 0000  fo/PKG-INFO.....
 00092c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092c60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00092c70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
-00092c80: 3030 3335 3137 3200 3030 3030 3030 3030  0035172.00000000
-00092c90: 3030 3000 3031 3735 3532 0020 3000 0000  000.017552. 0...
+00092c80: 3030 3335 3137 3400 3030 3030 3030 3030  0035174.00000000
+00092c90: 3030 3000 3031 3735 3535 0020 3000 0000  000.017555. 0...
 00092ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092d00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -37597,15 +37597,15 @@
 00092dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00092e00: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 00092e10: 3a20 322e 310a 4e61 6d65 3a20 6175 746f  : 2.1.Name: auto
 00092e20: 7669 6d6c 0a56 6572 7369 6f6e 3a20 302e  viml.Version: 0.
-00092e30: 312e 3731 330a 5375 6d6d 6172 793a 2041  1.713.Summary: A
+00092e30: 312e 3731 340a 5375 6d6d 6172 793a 2041  1.714.Summary: A
 00092e40: 7574 6f6d 6174 6963 616c 6c79 2042 7569  utomatically Bui
 00092e50: 6c64 2056 6172 6961 6e74 2049 6e74 6572  ld Variant Inter
 00092e60: 7072 6574 6162 6c65 204d 4c20 6d6f 6465  pretable ML mode
 00092e70: 6c73 2066 6173 7420 2d20 6e6f 7720 7769  ls fast - now wi
 00092e80: 7468 2043 6174 426f 6f73 7421 0a48 6f6d  th CatBoost!.Hom
 00092e90: 652d 7061 6765 3a20 6874 7470 733a 2f2f  e-page: https://
 00092ea0: 6769 7468 7562 2e63 6f6d 2f41 7574 6f56  github.com/AutoV
@@ -37680,864 +37680,864 @@
 000932f0: 7574 6f5f 5669 4d4c 2069 7320 7072 6f6e  uto_ViML is pron
 00093300: 6f75 6e63 6564 2061 7320 2261 7574 6f20  ounced as "auto 
 00093310: 7669 6d61 6c22 2028 6175 746f 7669 6d61  vimal" (autovima
 00093320: 6c20 6c6f 676f 2063 7265 6174 6564 2062  l logo created b
 00093330: 7920 5361 6e6b 6574 2047 6861 6e6d 6172  y Sanket Ghanmar
 00093340: 6529 2e0a 2020 2020 2020 2020 0a20 2020  e)..        .   
 00093350: 2020 2020 2023 2320 5570 6461 7465 2028       ## Update (
-00093360: 4d61 7920 3230 3232 290a 2020 2020 2020  May 2022).      
-00093370: 2020 3c6f 6c3e 0a20 2020 2020 2020 203c    <ol>.        <
-00093380: 6c69 3e3c 623e 4175 746f 5f56 694d 4c20  li><b>Auto_ViML 
-00093390: 6861 7320 6120 6e65 7720 666c 6167 2074  has a new flag t
-000933a0: 6f20 7370 6565 6420 7570 2070 726f 6365  o speed up proce
-000933b0: 7373 696e 6720 7573 696e 6720 4750 5527  ssing using GPU'
-000933c0: 733c 2f62 3e2e 204a 7573 7420 7365 7420  s</b>. Just set 
-000933d0: 7468 6520 6047 5055 5f66 6c61 6760 3d60  the `GPU_flag`=`
-000933e0: 5472 7565 6020 6f6e 2043 6f6c 6162 2061  True` on Colab a
-000933f0: 6e64 206f 7468 6572 2065 6e76 6972 6f6e  nd other environ
-00093400: 6d65 6e74 732e 2042 7574 2064 6f6e 2774  ments. But don't
-00093410: 2066 6f72 6765 7420 746f 2073 6574 2074   forget to set t
-00093420: 6865 2072 756e 7469 6d65 2074 7970 6520  he runtime type 
-00093430: 746f 2062 6520 2247 5055 2220 7768 696c  to be "GPU" whil
-00093440: 6520 7275 6e6e 696e 6720 6f6e 2043 6f6c  e running on Col
-00093450: 6162 2e20 4f74 6865 7277 6973 6520 796f  ab. Otherwise yo
-00093460: 7520 7769 6c6c 2067 6574 2061 6e20 6572  u will get an er
-00093470: 726f 722e 3c2f 6c69 3e0a 2020 2020 2020  ror.</li>.      
-00093480: 2020 3c2f 6f6c 3e0a 2020 2020 2020 2020    </ol>.        
-00093490: 0a20 2020 2020 2020 2023 2320 5570 6461  .        ## Upda
-000934a0: 7465 2028 4d61 7920 3230 3232 290a 2020  te (May 2022).  
-000934b0: 2020 2020 2020 3c6f 6c3e 0a20 2020 2020        <ol>.     
-000934c0: 2020 203c 6c69 3e3c 623e 4175 746f 5f56     <li><b>Auto_V
-000934d0: 694d 4c20 6173 206f 6620 7665 7273 696f  iML as of versio
-000934e0: 6e20 302e 312e 3731 3020 7573 6573 2061  n 0.1.710 uses a
-000934f0: 2076 6572 7920 6869 6768 2070 6572 666f   very high perfo
-00093500: 726d 616e 6365 206c 6962 7261 7279 2063  rmance library c
-00093510: 616c 6c65 6420 6069 6d62 616c 616e 6365  alled `imbalance
-00093520: 645f 656e 7365 6d62 6c65 6020 666f 7220  d_ensemble` for 
-00093530: 496d 6261 6c61 6e63 6564 2064 6174 6173  Imbalanced datas
-00093540: 6574 2070 726f 626c 656d 732e 3c2f 623e  et problems.</b>
-00093550: 2049 7420 7769 6c6c 2070 726f 6475 6365   It will produce
-00093560: 2061 2035 2d31 3025 2062 6f6f 7374 2069   a 5-10% boost i
-00093570: 6e20 796f 7572 2062 616c 616e 6365 645f  n your balanced_
-00093580: 6163 6375 7261 6379 2062 6173 6564 206f  accuracy based o
-00093590: 6e20 6d79 2065 7870 6572 6965 6e63 6520  n my experience 
-000935a0: 7769 7468 2020 6d61 6e79 2064 6174 6173  with  many datas
-000935b0: 6574 7320 4920 6861 7665 2074 7269 6564  ets I have tried
-000935c0: 2e3c 2f6c 693e 0a20 2020 2020 2020 203c  .</li>.        <
-000935d0: 6272 3e0a 2020 2020 2020 2020 3c70 3e49  br>.        <p>I
-000935e0: 6e20 6164 6469 7469 6f6e 2c20 6e65 7720  n addition, new 
-000935f0: 6665 6174 7572 6573 2069 6e20 7468 6973  features in this
-00093600: 2076 6572 7369 6f6e 2061 7265 3a3c 6272   version are:<br
-00093610: 3e0a 2020 2020 2020 2020 3c75 6c3e 0a20  >.        <ul>. 
-00093620: 2020 2020 2020 203c 6c69 3e53 554c 4f56         <li>SULOV
-00093630: 202d 3e20 5573 6573 2074 6865 2053 554c   -> Uses the SUL
-00093640: 4f56 2061 6c67 6f72 6974 686d 2066 6f72  OV algorithm for
-00093650: 2072 656d 6f76 696e 6720 6869 6768 6c79   removing highly
-00093660: 2063 6f72 7265 6c61 7465 6420 6665 6174   correlated feat
-00093670: 7572 6573 2061 7574 6f6d 6174 6963 616c  ures automatical
-00093680: 6c79 2e3c 2f6c 693e 0a20 2020 2020 2020  ly.</li>.       
-00093690: 203c 6c69 3e41 7574 6f5f 4e4c 5020 2d3e   <li>Auto_NLP ->
-000936a0: 2041 7574 6f56 694d 4c20 6175 746f 6d61   AutoViML automa
-000936b0: 7469 6361 6c6c 7920 6465 7465 6374 7320  tically detects 
-000936c0: 5465 7874 2076 6172 6961 626c 6573 2061  Text variables a
-000936d0: 6e64 2064 6f65 7320 4e4c 5020 7072 6f63  nd does NLP proc
-000936e0: 6573 7369 6e67 2075 7369 6e67 2041 7574  essing using Aut
-000936f0: 6f5f 4e4c 503c 2f6c 693e 0a20 2020 2020  o_NLP</li>.     
-00093700: 2020 203c 6c69 3e44 6174 6520 5469 6d65     <li>Date Time
-00093710: 202d 3e20 4974 2061 7574 6f6d 6174 6963   -> It automatic
-00093720: 616c 6c79 2064 6574 6563 7473 2020 6461  ally detects  da
-00093730: 7465 2074 696d 6520 7661 7269 6162 6c65  te time variable
-00093740: 7320 616e 6420 6765 6e65 7261 7465 7320  s and generates 
-00093750: 6e65 7720 6665 6174 7572 6573 3c2f 6c69  new features</li
-00093760: 3e0a 2020 2020 2020 2020 3c6c 693e 6069  >.        <li>`i
-00093770: 6d62 616c 616e 6365 645f 656e 7365 6d62  mbalanced_ensemb
-00093780: 6c65 6020 6c69 6272 6172 7920 2d3e 2055  le` library -> U
-00093790: 7365 7320 696d 6261 6c61 6e63 6564 5f65  ses imbalanced_e
-000937a0: 6e73 656d 626c 6520 6c69 6272 6172 7920  nsemble library 
-000937b0: 666f 7220 696d 6261 6c61 6e63 6564 2064  for imbalanced d
-000937c0: 6174 612e 204a 7573 7420 7365 7420 496d  ata. Just set Im
-000937d0: 6261 6c61 6e63 6564 5f46 6c61 6720 3d20  balanced_Flag = 
-000937e0: 5472 7565 2069 6e20 6172 6775 6d65 6e74  True in argument
-000937f0: 733c 2f6c 693e 0a20 2020 2020 2020 203c  s</li>.        <
-00093800: 6c69 3e46 6561 7475 7265 2053 656c 6563  li>Feature Selec
-00093810: 7469 6f6e 202d 3e20 5765 2075 7365 2074  tion -> We use t
-00093820: 6865 2073 616d 6520 616c 676f 7269 7468  he same algorith
-00093830: 6d20 7468 6174 2066 6561 7475 7265 7769  m that featurewi
-00093840: 7a20 6c69 6272 6172 7920 7573 6573 3a20  z library uses: 
-00093850: 5355 4c4f 5620 616e 6420 5265 6375 7273  SULOV and Recurs
-00093860: 6976 6520 5847 426f 6f73 7420 746f 2073  ive XGBoost to s
-00093870: 656c 6563 7420 6265 7374 2066 6561 7475  elect best featu
-00093880: 7265 7320 6661 7374 2e20 5365 6520 6265  res fast. See be
-00093890: 6c6f 772e 3c2f 6c69 3e0a 2020 2020 2020  low.</li>.      
-000938a0: 2020 3c2f 756c 3e0a 2020 2020 2020 2020    </ul>.        
-000938b0: 0a20 2020 2020 2020 2023 2320 5461 626c  .        ## Tabl
-000938c0: 6520 6f66 2043 6f6e 7465 6e74 730a 2020  e of Contents.  
-000938d0: 2020 2020 2020 3c75 6c3e 0a20 2020 2020        <ul>.     
-000938e0: 2020 203c 6c69 3e3c 6120 6872 6566 3d22     <li><a href="
-000938f0: 2362 6163 6b67 726f 756e 6422 3e42 6163  #background">Bac
-00093900: 6b67 726f 756e 643c 2f61 3e3c 2f6c 693e  kground</a></li>
-00093910: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
-00093920: 6872 6566 3d22 2369 6e73 7461 6c6c 223e  href="#install">
-00093930: 496e 7374 616c 6c3c 2f61 3e3c 2f6c 693e  Install</a></li>
-00093940: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
-00093950: 6872 6566 3d22 2375 7361 6765 223e 5573  href="#usage">Us
-00093960: 6167 653c 2f61 3e3c 2f6c 693e 0a20 2020  age</a></li>.   
-00093970: 2020 2020 203c 6c69 3e3c 6120 6872 6566       <li><a href
-00093980: 3d22 2374 6970 732d 666f 722d 7573 696e  ="#tips-for-usin
-00093990: 672d 6175 746f 5f76 696d 6c22 3e54 6970  g-auto_viml">Tip
-000939a0: 7320 666f 7220 7573 696e 6720 4175 746f  s for using Auto
-000939b0: 5f56 694d 4c3c 2f61 3e3c 2f6c 693e 0a20  _ViML</a></li>. 
-000939c0: 2020 2020 2020 203c 6c69 3e3c 6120 6872         <li><a hr
-000939d0: 6566 3d22 2361 7069 223e 4150 493c 2f61  ef="#api">API</a
-000939e0: 3e3c 2f6c 693e 0a20 2020 2020 2020 203c  ></li>.        <
-000939f0: 6c69 3e3c 6120 6872 6566 3d22 236d 6169  li><a href="#mai
-00093a00: 6e74 6169 6e65 7273 223e 4d61 696e 7461  ntainers">Mainta
-00093a10: 696e 6572 733c 2f61 3e3c 2f6c 693e 0a20  iners</a></li>. 
-00093a20: 2020 2020 2020 203c 6c69 3e3c 6120 6872         <li><a hr
-00093a30: 6566 3d22 2363 6f6e 7472 6962 7574 696e  ef="#contributin
-00093a40: 6722 3e43 6f6e 7472 6962 7574 696e 673c  g">Contributing<
-00093a50: 2f61 3e3c 2f6c 693e 0a20 2020 2020 2020  /a></li>.       
-00093a60: 203c 6c69 3e3c 6120 6872 6566 3d22 236c   <li><a href="#l
-00093a70: 6963 656e 7365 223e 4c69 6365 6e73 653c  icense">License<
-00093a80: 2f61 3e3c 2f6c 693e 0a20 2020 2020 2020  /a></li>.       
-00093a90: 203c 2f75 6c3e 0a20 2020 2020 2020 200a   </ul>.        .
-00093aa0: 2020 2020 2020 2020 2323 2042 6163 6b67          ## Backg
-00093ab0: 726f 756e 640a 2020 2020 2020 2020 3c70  round.        <p
-00093ac0: 3e52 6561 6420 7468 6973 203c 6120 6872  >Read this <a hr
-00093ad0: 6566 3d22 6874 7470 733a 2f2f 746f 7761  ef="https://towa
-00093ae0: 7264 7364 6174 6173 6369 656e 6365 2e63  rdsdatascience.c
-00093af0: 6f6d 2f77 6879 2d61 7574 6f6d 6c2d 6973  om/why-automl-is
-00093b00: 2d61 6e2d 6573 7365 6e74 6961 6c2d 6e65  -an-essential-ne
-00093b10: 772d 746f 6f6c 2d66 6f72 2d64 6174 612d  w-tool-for-data-
-00093b20: 7363 6965 6e74 6973 7473 2d32 6439 6162  scientists-2d9ab
-00093b30: 3465 3235 6534 3622 3e4d 6564 6975 6d20  4e25e46">Medium 
-00093b40: 6172 7469 636c 6520 746f 206c 6561 726e  article to learn
-00093b50: 2068 6f77 2074 6f20 7573 6520 4175 746f   how to use Auto
-00093b60: 5f56 694d 4c20 6566 6665 6374 6976 656c  _ViML effectivel
-00093b70: 792e 3c2f 613e 0a20 2020 2020 2020 200a  y.</a>.        .
-00093b80: 2020 2020 2020 2020 3c70 3e41 7574 6f5f          <p>Auto_
-00093b90: 5669 4d4c 2077 6173 2064 6573 6967 6e65  ViML was designe
-00093ba0: 6420 666f 7220 6275 696c 6469 6e67 2048  d for building H
-00093bb0: 6967 6820 5065 7266 6f72 6d61 6e63 6520  igh Performance 
-00093bc0: 496e 7465 7270 7265 7461 626c 6520 4d6f  Interpretable Mo
-00093bd0: 6465 6c73 2077 6974 6820 7468 6520 6665  dels with the fe
-00093be0: 7765 7374 2076 6172 6961 626c 6573 206e  west variables n
-00093bf0: 6565 6465 642e 0a20 2020 2020 2020 2054  eeded..        T
-00093c00: 6865 2022 5622 2069 6e20 4175 746f 5f56  he "V" in Auto_V
-00093c10: 694d 4c20 7374 616e 6473 2066 6f72 2056  iML stands for V
-00093c20: 6172 6961 6e74 2062 6563 6175 7365 2069  ariant because i
-00093c30: 7420 7472 6965 7320 6d75 6c74 6970 6c65  t tries multiple
-00093c40: 206d 6f64 656c 7320 7769 7468 206d 756c   models with mul
-00093c50: 7469 706c 6520 6665 6174 7572 6573 2074  tiple features t
-00093c60: 6f20 6669 6e64 2079 6f75 2074 6865 2062  o find you the b
-00093c70: 6573 7420 7065 7266 6f72 6d69 6e67 206d  est performing m
-00093c80: 6f64 656c 2066 6f72 2079 6f75 7220 6461  odel for your da
-00093c90: 7461 7365 742e 2054 6865 2022 6922 2069  taset. The "i" i
-00093ca0: 6e20 4175 746f 5f56 694d 4c20 7374 616e  n Auto_ViML stan
-00093cb0: 6473 2066 6f72 2022 696e 7465 7270 7265  ds for "interpre
-00093cc0: 7461 626c 6522 2073 696e 6365 2041 7574  table" since Aut
-00093cd0: 6f5f 5669 4d4c 2073 656c 6563 7473 2074  o_ViML selects t
-00093ce0: 6865 206c 6561 7374 206e 756d 6265 7220  he least number 
-00093cf0: 6f66 2066 6561 7475 7265 7320 6e65 6365  of features nece
-00093d00: 7373 6172 7920 746f 2062 7569 6c64 2061  ssary to build a
-00093d10: 2073 696d 706c 6572 2c20 6d6f 7265 2069   simpler, more i
-00093d20: 6e74 6572 7072 6574 6162 6c65 206d 6f64  nterpretable mod
-00093d30: 656c 2e20 496e 206d 6f73 7420 6361 7365  el. In most case
-00093d40: 732c 2041 7574 6f5f 5669 4d4c 2062 7569  s, Auto_ViML bui
-00093d50: 6c64 7320 6d6f 6465 6c73 2077 6974 6820  lds models with 
-00093d60: 3230 252d 3939 2520 6665 7765 7220 6665  20%-99% fewer fe
-00093d70: 6174 7572 6573 2074 6861 6e20 6120 7369  atures than a si
-00093d80: 6d69 6c61 7220 7065 7266 6f72 6d69 6e67  milar performing
-00093d90: 206d 6f64 656c 2077 6974 6820 616c 6c20   model with all 
-00093da0: 696e 636c 7564 6564 2066 6561 7475 7265  included feature
-00093db0: 7320 2874 6869 7320 6973 2062 6173 6564  s (this is based
-00093dc0: 206f 6e20 6d79 2074 7269 616c 732e 2059   on my trials. Y
-00093dd0: 6f75 7220 6578 7065 7269 656e 6365 206d  our experience m
-00093de0: 6179 2076 6172 7929 2e3c 6272 3e0a 2020  ay vary).<br>.  
-00093df0: 2020 2020 2020 3c70 3e0a 2020 2020 2020        <p>.      
-00093e00: 2020 4175 746f 5f56 694d 4c20 6973 2065    Auto_ViML is e
-00093e10: 7665 7279 2044 6174 6120 5363 6965 6e74  very Data Scient
-00093e20: 6973 7427 7320 6d6f 6465 6c20 6163 6365  ist's model acce
-00093e30: 6c65 7261 746f 7220 746f 6f6c 2074 6861  lerator tool tha
-00093e40: 743a 3c6f 6c3e 0a20 2020 2020 2020 203c  t:<ol>.        <
-00093e50: 6c69 3e3c 623e 4865 6c70 7320 796f 7520  li><b>Helps you 
-00093e60: 7769 7468 2064 6174 6120 636c 6561 6e69  with data cleani
-00093e70: 6e67 3c2f 623e 3a20 796f 7520 6361 6e20  ng</b>: you can 
-00093e80: 7365 6e64 2069 6e20 796f 7572 2065 6e74  send in your ent
-00093e90: 6972 6520 6461 7461 6672 616d 6520 6173  ire dataframe as
-00093ea0: 2069 7320 616e 6420 4175 746f 5f56 694d   is and Auto_ViM
-00093eb0: 4c20 7769 6c6c 2073 7567 6765 7374 2063  L will suggest c
-00093ec0: 6861 6e67 6573 2074 6f20 6865 6c70 2077  hanges to help w
-00093ed0: 6974 6820 6d69 7373 696e 6720 7661 6c75  ith missing valu
-00093ee0: 6573 2c20 666f 726d 6174 7469 6e67 2076  es, formatting v
-00093ef0: 6172 6961 626c 6573 2c20 6164 6469 6e67  ariables, adding
-00093f00: 2076 6172 6961 626c 6573 2c20 6574 632e   variables, etc.
-00093f10: 2049 7420 6c6f 7665 7320 6469 7274 7920   It loves dirty 
-00093f20: 6461 7461 2e20 5468 6520 6469 7274 6965  data. The dirtie
-00093f30: 7220 7468 6520 6265 7474 6572 213c 6272  r the better!<br
-00093f40: 3e0a 2020 2020 2020 2020 3c6c 693e 3c62  >.        <li><b
-00093f50: 3e50 6572 666f 726d 7320 4665 6174 7572  >Performs Featur
-00093f60: 6520 5365 6c65 6374 696f 6e3c 2f62 3e3a  e Selection</b>:
-00093f70: 2041 7574 6f5f 5669 4d4c 2073 656c 6563   Auto_ViML selec
-00093f80: 7473 2076 6172 6961 626c 6573 2061 7574  ts variables aut
-00093f90: 6f6d 6174 6963 616c 6c79 2062 7920 6465  omatically by de
-00093fa0: 6661 756c 742e 2054 6869 7320 6973 2076  fault. This is v
-00093fb0: 6572 7920 6865 6c70 6675 6c20 7768 656e  ery helpful when
-00093fc0: 2079 6f75 2068 6176 6520 6875 6e64 7265   you have hundre
-00093fd0: 6473 2069 6620 6e6f 7420 7468 6f75 7361  ds if not thousa
-00093fe0: 6e64 7320 6f66 2076 6172 6961 626c 6573  nds of variables
-00093ff0: 2073 696e 6365 2069 7420 6361 6e20 7265   since it can re
-00094000: 6164 696c 7920 6964 656e 7469 6679 2077  adily identify w
-00094010: 6869 6368 206f 6620 7468 6f73 6520 6172  hich of those ar
-00094020: 6520 696d 706f 7274 616e 7420 7661 7269  e important vari
-00094030: 6162 6c65 7320 7673 2077 6869 6368 2061  ables vs which a
-00094040: 7265 2075 6e6e 6563 6573 7361 7279 2e20  re unnecessary. 
-00094050: 596f 7520 6361 6e20 7475 726e 2074 6869  You can turn thi
-00094060: 7320 6f66 6620 6173 2077 656c 6c20 2873  s off as well (s
-00094070: 6565 2041 5049 292e 3c62 723e 0a20 2020  ee API).<br>.   
-00094080: 2020 2020 200a 2020 2020 2020 2020 215b       .        ![
-00094090: 7867 626f 6f73 745d 2873 756c 6f76 5f78  xgboost](sulov_x
-000940a0: 6762 6f6f 7374 2e70 6e67 290a 2020 2020  gboost.png).    
-000940b0: 2020 2020 3c6c 693e 3c62 3e52 656d 6f76      <li><b>Remov
-000940c0: 6573 2068 6967 686c 7920 636f 7272 656c  es highly correl
-000940d0: 6174 6564 2066 6561 7475 7265 7320 6175  ated features au
-000940e0: 746f 6d61 7469 6361 6c6c 793c 2f62 3e2e  tomatically</b>.
-000940f0: 2049 6620 7477 6f20 7661 7269 6162 6c65   If two variable
-00094100: 7320 6172 6520 6869 6768 6c79 2063 6f72  s are highly cor
-00094110: 7265 6c61 7465 6420 696e 2079 6f75 7220  related in your 
-00094120: 6461 7461 7365 742c 2077 6869 6368 206f  dataset, which o
-00094130: 6e65 2073 686f 756c 6420 796f 7520 7265  ne should you re
-00094140: 6d6f 7665 2061 6e64 2077 6869 6368 206f  move and which o
-00094150: 6e65 2073 686f 756c 6420 796f 7520 6b65  ne should you ke
-00094160: 6570 3f20 5468 6520 6465 6369 7369 6f6e  ep? The decision
-00094170: 2069 7320 6e6f 7420 6173 2065 6173 7920   is not as easy 
-00094180: 6173 2069 7420 6c6f 6f6b 732e 2041 7574  as it looks. Aut
-00094190: 6f5f 5669 4d4c 2075 7365 7320 7468 6520  o_ViML uses the 
-000941a0: 5355 4c4f 5620 616c 676f 7269 7468 6d20  SULOV algorithm 
-000941b0: 746f 2072 656d 6f76 6520 6869 6768 6c79  to remove highly
-000941c0: 2063 6f72 7265 6c61 7465 6420 6665 6174   correlated feat
-000941d0: 7572 6573 2e20 596f 7520 6361 6e20 756e  ures. You can un
-000941e0: 6465 7273 7461 6e64 2053 554c 4f56 2066  derstand SULOV f
-000941f0: 726f 6d20 7468 6973 2070 6963 7475 7265  rom this picture
-00094200: 206d 6f72 6520 696e 7475 6974 6976 656c   more intuitivel
-00094210: 792e 3c62 723e 0a20 2020 2020 2020 200a  y.<br>.        .
-00094220: 2020 2020 2020 2020 215b 7375 6c6f 765d          ![sulov]
-00094230: 2853 554c 4f56 2e6a 7067 290a 2020 2020  (SULOV.jpg).    
-00094240: 2020 2020 0a20 2020 2020 2020 203c 6c69      .        <li
-00094250: 3e3c 623e 4765 6e65 7261 7465 7320 7065  ><b>Generates pe
-00094260: 7266 6f72 6d61 6e63 6520 7265 7375 6c74  rformance result
-00094270: 7320 6772 6170 6869 6361 6c6c 793c 2f62  s graphically</b
-00094280: 3e2e 204a 7573 7420 7365 7420 7665 7262  >. Just set verb
-00094290: 6f73 6520 3d20 3120 286f 7229 2032 2069  ose = 1 (or) 2 i
-000942a0: 6e73 7465 6164 206f 6620 3020 2873 696c  nstead of 0 (sil
-000942b0: 656e 7429 2e20 596f 7520 7769 6c6c 2067  ent). You will g
-000942c0: 6574 2068 6967 6865 7220 7175 616c 6974  et higher qualit
-000942d0: 7920 6f66 2069 6e73 6967 6874 7320 6173  y of insights as
-000942e0: 2079 6f75 2069 6e63 7265 6173 6520 7665   you increase ve
-000942f0: 7262 6f73 6974 792e 203c 6272 3e0a 2020  rbosity. <br>.  
-00094300: 2020 2020 2020 3c6c 693e 3c62 3e48 616e        <li><b>Han
-00094310: 646c 6573 2074 6578 742c 2064 6174 652d  dles text, date-
-00094320: 7469 6d65 2c20 7374 7275 6374 7320 286c  time, structs (l
-00094330: 6973 7473 2c20 6469 6374 696f 6e61 7269  ists, dictionari
-00094340: 6573 292c 206e 756d 6572 6963 2c20 626f  es), numeric, bo
-00094350: 6f6c 6561 6e2c 2066 6163 746f 7220 616e  olean, factor an
-00094360: 6420 6361 7465 676f 7269 6361 6c3c 2f62  d categorical</b
-00094370: 3e20 7661 7269 6162 6c65 7320 616c 6c20  > variables all 
-00094380: 696e 206f 6e65 206d 6f64 656c 2075 7369  in one model usi
-00094390: 6e67 206f 6e65 2073 7472 6169 6768 7420  ng one straight 
-000943a0: 7072 6f63 6573 732e 3c62 723e 0a20 2020  process.<br>.   
-000943b0: 2020 2020 203c 2f6f 6c3e 0a20 2020 2020       </ol>.     
-000943c0: 2020 2041 7574 6f5f 5669 4d4c 2069 7320     Auto_ViML is 
-000943d0: 6275 696c 7420 7573 696e 6720 7363 696b  built using scik
-000943e0: 6974 2d6c 6561 726e 2c20 6e75 6d70 792c  it-learn, numpy,
-000943f0: 2070 616e 6461 7320 616e 6420 6d61 7470   pandas and matp
-00094400: 6c6f 746c 6962 2e20 4974 2073 686f 756c  lotlib. It shoul
-00094410: 6420 7275 6e20 6f6e 206d 6f73 7420 5079  d run on most Py
-00094420: 7468 6f6e 2033 2041 6e61 636f 6e64 6120  thon 3 Anaconda 
-00094430: 696e 7374 616c 6c61 7469 6f6e 732e 2059  installations. Y
-00094440: 6f75 2077 6f6e 2774 2068 6176 6520 746f  ou won't have to
-00094450: 2069 6d70 6f72 7420 616e 7920 7370 6563   import any spec
-00094460: 6961 6c20 6c69 6272 6172 6965 7320 6f74  ial libraries ot
-00094470: 6865 7220 7468 616e 2022 5847 426f 6f73  her than "XGBoos
-00094480: 7422 2c20 2249 6d62 616c 616e 6365 642d  t", "Imbalanced-
-00094490: 4c65 6172 6e22 2c20 2243 6174 426f 6f73  Learn", "CatBoos
-000944a0: 7422 2c20 616e 6420 2266 6561 7475 7265  t", and "feature
-000944b0: 746f 6f6c 7322 206c 6962 7261 7279 2e20  tools" library. 
-000944c0: 5765 2075 7365 2022 5348 4150 2220 6c69  We use "SHAP" li
-000944d0: 6272 6172 7920 666f 7220 696e 7465 7270  brary for interp
-000944e0: 7265 7461 6269 6c69 7479 2e20 3c62 723e  retability. <br>
-000944f0: 4275 7420 6966 2079 6f75 2064 6f6e 2774  But if you don't
-00094500: 2068 6176 6520 7468 6573 6520 6c69 6272   have these libr
-00094510: 6172 6965 732c 2041 7574 6f5f 5669 4d4c  aries, Auto_ViML
-00094520: 2077 696c 6c20 696e 7374 616c 6c20 7468   will install th
-00094530: 6f73 6520 666f 7220 796f 7520 6175 746f  ose for you auto
-00094540: 6d61 7469 6361 6c6c 792e 0a20 2020 2020  matically..     
-00094550: 2020 200a 2020 2020 2020 2020 2323 2049     .        ## I
-00094560: 6e73 7461 6c6c 0a20 2020 2020 2020 200a  nstall.        .
-00094570: 2020 2020 2020 2020 2a2a 5072 6572 6571          **Prereq
-00094580: 7573 6974 6573 3a2a 2a0a 2020 2020 2020  usites:**.      
-00094590: 2020 0a20 2020 2020 2020 202d 205b 416e    .        - [An
-000945a0: 6163 6f6e 6461 5d28 6874 7470 733a 2f2f  aconda](https://
-000945b0: 646f 6373 2e61 6e61 636f 6e64 612e 636f  docs.anaconda.co
-000945c0: 6d2f 616e 6163 6f6e 6461 2f69 6e73 7461  m/anaconda/insta
-000945d0: 6c6c 2f29 0a20 2020 2020 2020 200a 2020  ll/).        .  
-000945e0: 2020 2020 2020 546f 2063 6c6f 6e65 2041        To clone A
-000945f0: 7574 6f5f 5669 4d4c 2c20 6974 2069 7320  uto_ViML, it is 
-00094600: 6265 7474 6572 2074 6f20 6372 6561 7465  better to create
-00094610: 2061 206e 6577 2065 6e76 6972 6f6e 6d65   a new environme
-00094620: 6e74 2c20 616e 6420 696e 7374 616c 6c20  nt, and install 
-00094630: 7468 6520 7265 7175 6972 6564 2064 6570  the required dep
-00094640: 656e 6465 6e63 6965 733a 0a20 2020 2020  endencies:.     
-00094650: 2020 200a 2020 2020 2020 2020 546f 2069     .        To i
-00094660: 6e73 7461 6c6c 2066 726f 6d20 5079 5069  nstall from PyPi
-00094670: 3a0a 2020 2020 2020 2020 3c70 3e0a 2020  :.        <p>.  
-00094680: 2020 2020 2020 3c63 6f64 653e 2420 7069        <code>$ pi
-00094690: 7020 696e 7374 616c 6c20 6175 746f 7669  p install autovi
-000946a0: 6d6c 202d 2d75 7067 7261 6465 202d 2d69  ml --upgrade --i
-000946b0: 676e 6f72 652d 696e 7374 616c 6c65 643c  gnore-installed<
-000946c0: 2f63 6f64 653e 3c62 723e 0a20 2020 2020  /code><br>.     
-000946d0: 2020 206f 720a 2020 2020 2020 2020 0a20     or.        . 
-000946e0: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
-000946f0: 2020 2070 6970 2069 6e73 7461 6c6c 2067     pip install g
-00094700: 6974 2b68 7474 7073 3a2f 2f67 6974 6875  it+https://githu
-00094710: 622e 636f 6d2f 4175 746f 5669 4d4c 2f41  b.com/AutoViML/A
-00094720: 7574 6f5f 5669 4d4c 2e67 6974 0a20 2020  uto_ViML.git.   
-00094730: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
-00094740: 200a 2020 2020 2020 2020 546f 2069 6e73   .        To ins
-00094750: 7461 6c6c 2066 726f 6d20 736f 7572 6365  tall from source
-00094760: 3a0a 2020 2020 2020 2020 0a20 2020 2020  :.        .     
-00094770: 2020 2060 6060 0a20 2020 2020 2020 2063     ```.        c
-00094780: 6420 3c41 7574 6f56 494d 4c5f 4465 7374  d <AutoVIML_Dest
-00094790: 696e 6174 696f 6e3e 0a20 2020 2020 2020  ination>.       
-000947a0: 2067 6974 2063 6c6f 6e65 2067 6974 4067   git clone git@g
-000947b0: 6974 6875 622e 636f 6d3a 4175 746f 5669  ithub.com:AutoVi
-000947c0: 4d4c 2f41 7574 6f5f 5669 4d4c 2e67 6974  ML/Auto_ViML.git
-000947d0: 0a20 2020 2020 2020 2023 206f 7220 646f  .        # or do
-000947e0: 776e 6c6f 6164 2061 6e64 2075 6e7a 6970  wnload and unzip
-000947f0: 2068 7474 7073 3a2f 2f67 6974 6875 622e   https://github.
-00094800: 636f 6d2f 4175 746f 5669 4d4c 2f41 7574  com/AutoViML/Aut
-00094810: 6f5f 5669 4d4c 2f61 7263 6869 7665 2f6d  o_ViML/archive/m
-00094820: 6173 7465 722e 7a69 700a 2020 2020 2020  aster.zip.      
-00094830: 2020 636f 6e64 6120 6372 6561 7465 202d    conda create -
-00094840: 6e20 3c79 6f75 725f 656e 765f 6e61 6d65  n <your_env_name
-00094850: 3e20 7079 7468 6f6e 3d33 2e37 2061 6e61  > python=3.7 ana
-00094860: 636f 6e64 610a 2020 2020 2020 2020 636f  conda.        co
-00094870: 6e64 6120 6163 7469 7661 7465 203c 796f  nda activate <yo
-00094880: 7572 5f65 6e76 5f6e 616d 653e 2023 204f  ur_env_name> # O
-00094890: 4e20 5749 4e44 4f57 533a 2060 736f 7572  N WINDOWS: `sour
-000948a0: 6365 2061 6374 6976 6174 6520 3c79 6f75  ce activate <you
-000948b0: 725f 656e 765f 6e61 6d65 3e60 0a20 2020  r_env_name>`.   
-000948c0: 2020 2020 2063 6420 4175 746f 5f56 694d       cd Auto_ViM
-000948d0: 4c0a 2020 2020 2020 2020 7069 7020 696e  L.        pip in
-000948e0: 7374 616c 6c20 2d72 2072 6571 7569 7265  stall -r require
-000948f0: 6d65 6e74 732e 7478 740a 2020 2020 2020  ments.txt.      
-00094900: 2020 6060 600a 2020 2020 2020 2020 0a20    ```.        . 
-00094910: 2020 2020 2020 2023 2320 5573 6167 650a         ## Usage.
-00094920: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00094930: 2049 6e20 7468 6520 7361 6d65 2064 6972   In the same dir
-00094940: 6563 746f 7279 2c20 6f70 656e 2061 204a  ectory, open a J
-00094950: 7570 7974 6572 204e 6f74 6562 6f6f 6b20  upyter Notebook 
-00094960: 616e 6420 7573 6520 7468 6973 206c 696e  and use this lin
-00094970: 6520 746f 2069 6d70 6f72 7420 7468 6520  e to import the 
-00094980: 2e70 7920 6669 6c65 3a0a 2020 2020 2020  .py file:.      
-00094990: 2020 0a20 2020 2020 2020 2060 6060 0a20    .        ```. 
-000949a0: 2020 2020 2020 2066 726f 6d20 6175 746f         from auto
-000949b0: 7669 6d6c 2e41 7574 6f5f 5669 4d4c 2069  viml.Auto_ViML i
-000949c0: 6d70 6f72 7420 4175 746f 5f56 694d 4c0a  mport Auto_ViML.
-000949d0: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
-000949e0: 2020 2020 0a20 2020 2020 2020 204c 6f61      .        Loa
-000949f0: 6420 6120 6461 7461 2073 6574 2028 616e  d a data set (an
-00094a00: 7920 4353 5620 6f72 2074 6578 7420 6669  y CSV or text fi
-00094a10: 6c65 2920 696e 746f 2061 2050 616e 6461  le) into a Panda
-00094a20: 7320 6461 7461 6672 616d 6520 616e 6420  s dataframe and 
-00094a30: 7370 6c69 7420 6974 2069 6e74 6f20 5472  split it into Tr
-00094a40: 6169 6e20 616e 6420 5465 7374 2064 6174  ain and Test dat
-00094a50: 6166 7261 6d65 732e 2049 6620 796f 7520  aframes. If you 
-00094a60: 646f 6e27 7420 6861 7665 2061 2074 6573  don't have a tes
-00094a70: 7420 6461 7461 6672 616d 652c 2079 6f75  t dataframe, you
-00094a80: 2063 616e 2073 696d 706c 6520 6173 7369   can simple assi
-00094a90: 676e 2074 6865 2074 6573 7420 7661 7269  gn the test vari
-00094aa0: 6162 6c65 2062 656c 6f77 2074 6f20 2727  able below to ''
-00094ab0: 2028 656d 7074 7920 7374 7269 6e67 293a   (empty string):
-00094ac0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00094ad0: 2020 6060 600a 2020 2020 2020 2020 6d6f    ```.        mo
-00094ae0: 6465 6c2c 2066 6561 7475 7265 732c 2074  del, features, t
-00094af0: 7261 696e 6d2c 2074 6573 746d 203d 2041  rainm, testm = A
-00094b00: 7574 6f5f 5669 4d4c 280a 2020 2020 2020  uto_ViML(.      
-00094b10: 2020 2020 2020 7472 6169 6e2c 0a20 2020        train,.   
-00094b20: 2020 2020 2020 2020 2074 6172 6765 742c           target,
-00094b30: 0a20 2020 2020 2020 2020 2020 2074 6573  .            tes
-00094b40: 742c 0a20 2020 2020 2020 2020 2020 2073  t,.            s
-00094b50: 616d 706c 655f 7375 626d 6973 7369 6f6e  ample_submission
-00094b60: 2c0a 2020 2020 2020 2020 2020 2020 6879  ,.            hy
-00094b70: 7065 725f 7061 7261 6d3d 2247 5322 2c0a  per_param="GS",.
-00094b80: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-00094b90: 7572 655f 7265 6475 6374 696f 6e3d 5472  ure_reduction=Tr
-00094ba0: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-00094bb0: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
-00094bc0: 723d 2277 6569 6768 7465 642d 6631 222c  r="weighted-f1",
-00094bd0: 0a20 2020 2020 2020 2020 2020 204b 4d65  .            KMe
-00094be0: 616e 735f 4665 6174 7572 697a 6572 3d46  ans_Featurizer=F
-00094bf0: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
-00094c00: 2020 426f 6f73 7469 6e67 5f46 6c61 673d    Boosting_Flag=
-00094c10: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-00094c20: 2020 2042 696e 6e69 6e67 5f46 6c61 673d     Binning_Flag=
-00094c30: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-00094c40: 2020 2041 6464 5f50 6f6c 793d 4661 6c73     Add_Poly=Fals
-00094c50: 652c 0a20 2020 2020 2020 2020 2020 2053  e,.            S
-00094c60: 7461 636b 696e 675f 466c 6167 3d46 616c  tacking_Flag=Fal
-00094c70: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00094c80: 496d 6261 6c61 6e63 6564 5f46 6c61 673d  Imbalanced_Flag=
-00094c90: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-00094ca0: 2020 2076 6572 626f 7365 3d30 2c0a 2020     verbose=0,.  
-00094cb0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00094cc0: 6060 600a 2020 2020 2020 2020 0a20 2020  ```.        .   
-00094cd0: 2020 2020 2046 696e 616c 6c79 2c20 6974       Finally, it
-00094ce0: 2077 7269 7465 7320 796f 7572 2073 7562   writes your sub
-00094cf0: 6d69 7373 696f 6e20 6669 6c65 2074 6f20  mission file to 
-00094d00: 6469 736b 2069 6e20 7468 6520 6375 7272  disk in the curr
-00094d10: 656e 7420 6469 7265 6374 6f72 7920 6361  ent directory ca
-00094d20: 6c6c 6564 2060 6d79 7375 626d 6973 7369  lled `mysubmissi
-00094d30: 6f6e 2e63 7376 602e 0a20 2020 2020 2020  on.csv`..       
-00094d40: 2054 6869 7320 7375 626d 6973 7369 6f6e   This submission
-00094d50: 2066 696c 6520 6973 2072 6561 6479 2066   file is ready f
-00094d60: 6f72 2079 6f75 2074 6f20 7368 6f77 2069  or you to show i
-00094d70: 7420 636c 6965 6e74 7320 6f72 2073 7562  t clients or sub
-00094d80: 6d69 7420 6974 2074 6f20 636f 6d70 6574  mit it to compet
-00094d90: 6974 696f 6e73 2e0a 2020 2020 2020 2020  itions..        
-00094da0: 4966 206e 6f20 7375 626d 6973 7369 6f6e  If no submission
-00094db0: 2066 696c 6520 7761 7320 6769 7665 6e2c   file was given,
-00094dc0: 2062 7574 2061 7320 6c6f 6e67 2061 7320   but as long as 
-00094dd0: 796f 7520 6769 7665 2069 7420 6120 7465  you give it a te
-00094de0: 7374 2066 696c 6520 6e61 6d65 2c20 6974  st file name, it
-00094df0: 2077 696c 6c20 6372 6561 7465 2061 2073   will create a s
-00094e00: 7562 6d69 7373 696f 6e20 6669 6c65 2066  ubmission file f
-00094e10: 6f72 2079 6f75 206e 616d 6564 2060 6d79  or you named `my
-00094e20: 5375 626d 6973 7369 6f6e 2e63 7376 602e  Submission.csv`.
-00094e30: 0a20 2020 2020 2020 2041 7574 6f5f 5669  .        Auto_Vi
-00094e40: 4d4c 2077 6f72 6b73 206f 6e20 616e 7920  ML works on any 
-00094e50: 4d75 6c74 692d 436c 6173 732c 204d 756c  Multi-Class, Mul
-00094e60: 7469 2d4c 6162 656c 2044 6174 6120 5365  ti-Label Data Se
-00094e70: 742e 2053 6f20 796f 7520 6361 6e20 6861  t. So you can ha
-00094e80: 7665 206d 616e 7920 7461 7267 6574 206c  ve many target l
-00094e90: 6162 656c 732e 0a20 2020 2020 2020 2059  abels..        Y
-00094ea0: 6f75 2064 6f6e 2774 2068 6176 6520 746f  ou don't have to
-00094eb0: 2074 656c 6c20 4175 746f 5f56 694d 4c20   tell Auto_ViML 
-00094ec0: 7768 6574 6865 7220 6974 2069 7320 6120  whether it is a 
-00094ed0: 5265 6772 6573 7369 6f6e 206f 7220 436c  Regression or Cl
-00094ee0: 6173 7369 6669 6361 7469 6f6e 2070 726f  assification pro
-00094ef0: 626c 656d 2e0a 2020 2020 2020 2020 0a20  blem..        . 
-00094f00: 2020 2020 2020 2023 2320 5469 7073 2066         ## Tips f
-00094f10: 6f72 2075 7369 6e67 2041 7574 6f5f 5669  or using Auto_Vi
-00094f20: 4d4c 3a0a 2020 2020 2020 2020 312e 2060  ML:.        1. `
-00094f30: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
-00094f40: 7260 3a20 466f 7220 436c 6173 7369 6669  r`: For Classifi
-00094f50: 6361 7469 6f6e 2070 726f 626c 656d 7320  cation problems 
-00094f60: 616e 6420 696d 6261 6c61 6e63 6564 2063  and imbalanced c
-00094f70: 6c61 7373 6573 2c20 6368 6f6f 7365 2073  lasses, choose s
-00094f80: 636f 7269 6e67 5f70 6172 616d 6574 6572  coring_parameter
-00094f90: 3d22 6261 6c61 6e63 6564 5f61 6363 7572  ="balanced_accur
-00094fa0: 6163 7922 2e20 4974 2077 6f72 6b73 2062  acy". It works b
-00094fb0: 6574 7465 722e 0a20 2020 2020 2020 2032  etter..        2
-00094fc0: 2e20 6049 6d62 616c 616e 6365 645f 466c  . `Imbalanced_Fl
-00094fd0: 6167 603a 2046 6f72 2049 6d62 616c 616e  ag`: For Imbalan
-00094fe0: 6365 6420 436c 6173 7365 7320 283c 3525  ced Classes (<5%
-00094ff0: 2073 616d 706c 6573 2069 6e20 7261 7265   samples in rare
-00095000: 2063 6c61 7373 292c 2063 686f 6f73 6520   class), choose 
-00095010: 2249 6d62 616c 616e 6365 645f 466c 6167  "Imbalanced_Flag
-00095020: 223d 5472 7565 2e20 596f 7520 6361 6e20  "=True. You can 
-00095030: 616c 736f 2073 6574 2074 6869 7320 666c  also set this fl
-00095040: 6167 2074 6f20 5472 7565 2066 6f72 2052  ag to True for R
-00095050: 6567 7265 7373 696f 6e20 7072 6f62 6c65  egression proble
-00095060: 6d73 2077 6865 7265 2074 6865 2074 6172  ms where the tar
-00095070: 6765 7420 7661 7269 6162 6c65 206d 6967  get variable mig
-00095080: 6874 2068 6176 6520 736b 6577 6564 2064  ht have skewed d
-00095090: 6973 7472 6962 7574 696f 6e73 2e0a 2020  istributions..  
-000950a0: 2020 2020 2020 332e 2060 7461 7267 6574        3. `target
-000950b0: 603a 2046 6f72 204d 756c 7469 2d4c 6162  `: For Multi-Lab
-000950c0: 656c 2064 6174 6173 6574 2c20 7468 6520  el dataset, the 
-000950d0: 7461 7267 6574 2069 6e70 7574 2074 6172  target input tar
-000950e0: 6765 7420 7661 7269 6162 6c65 2063 616e  get variable can
-000950f0: 2062 6520 7365 6e74 2069 6e20 6173 2061   be sent in as a
-00095100: 206c 6973 7420 6f66 2076 6172 6961 626c   list of variabl
-00095110: 6573 2e0a 2020 2020 2020 2020 342e 2060  es..        4. `
-00095120: 426f 6f73 7469 6e67 5f46 6c61 6760 3a20  Boosting_Flag`: 
-00095130: 4974 2069 7320 7265 636f 6d6d 656e 6465  It is recommende
-00095140: 6420 7468 6174 2079 6f75 2066 6972 7374  d that you first
-00095150: 2073 6574 2042 6f6f 7374 696e 675f 466c   set Boosting_Fl
-00095160: 6167 3d4e 6f6e 6520 746f 2067 6574 2061  ag=None to get a
-00095170: 204c 696e 6561 7220 6d6f 6465 6c2e 204f   Linear model. O
-00095180: 6e63 6520 796f 7520 756e 6465 7273 7461  nce you understa
-00095190: 6e64 2074 6861 742c 2074 6865 6e20 796f  nd that, then yo
-000951a0: 7520 6361 6e20 7472 7920 746f 2073 6574  u can try to set
-000951b0: 2042 6f6f 7374 696e 675f 466c 6167 3d46   Boosting_Flag=F
-000951c0: 616c 7365 2074 6f20 6765 7420 6120 5261  alse to get a Ra
-000951d0: 6e64 6f6d 2046 6f72 6573 7420 6d6f 6465  ndom Forest mode
-000951e0: 6c2e 2046 696e 616c 6c79 2c20 7472 7920  l. Finally, try 
-000951f0: 426f 6f73 7469 6e67 5f46 6c61 673d 5472  Boosting_Flag=Tr
-00095200: 7565 2074 6f20 6765 7420 616e 2058 4742  ue to get an XGB
-00095210: 6f6f 7374 206d 6f64 656c 2e20 5468 6973  oost model. This
-00095220: 2069 7320 7468 6520 6f72 6465 7220 7468   is the order th
-00095230: 6174 2077 6520 7265 636f 6d6d 656e 6420  at we recommend 
-00095240: 696e 206f 7264 6572 2074 6f20 7573 6520  in order to use 
-00095250: 4175 746f 5f56 694d 4c2e 2046 696e 616c  Auto_ViML. Final
-00095260: 6c79 2074 7279 2042 6f6f 7374 696e 675f  ly try Boosting_
-00095270: 466c 6167 3d22 4361 7442 6f6f 7374 2220  Flag="CatBoost" 
-00095280: 746f 2067 6574 2061 2063 6f6d 706c 6578  to get a complex
-00095290: 2062 7574 2068 6967 6820 7065 7266 6f72   but high perfor
-000952a0: 6d69 6e67 206d 6f64 656c 2e0a 2020 2020  ming model..    
-000952b0: 2020 2020 352e 2060 4269 6e6e 696e 675f      5. `Binning_
-000952c0: 466c 6167 603a 2042 696e 6e69 6e67 5f46  Flag`: Binning_F
-000952d0: 6c61 673d 5472 7565 2069 6d70 726f 7665  lag=True improve
-000952e0: 7320 6120 4361 7442 6f6f 7374 206d 6f64  s a CatBoost mod
-000952f0: 656c 2073 696e 6365 2069 7420 6164 6473  el since it adds
-00095300: 2074 6f20 7468 6520 6c69 7374 206f 6620   to the list of 
-00095310: 6361 7465 676f 7269 6361 6c20 7661 7273  categorical vars
-00095320: 2069 6e20 6461 7461 0a20 2020 2020 2020   in data.       
-00095330: 2036 2e20 604b 4d65 616e 735f 6665 6174   6. `KMeans_feat
-00095340: 7572 697a 6572 603a 204b 4d65 616e 735f  urizer`: KMeans_
-00095350: 6665 6174 7572 697a 6572 3d54 7275 6520  featurizer=True 
-00095360: 776f 726b 7320 7765 6c6c 2069 6e20 4e4c  works well in NL
-00095370: 5020 616e 6420 4361 7442 6f6f 7374 206d  P and CatBoost m
-00095380: 6f64 656c 7320 7369 6e63 6520 6974 2063  odels since it c
-00095390: 7265 6174 6573 2063 6c75 7374 6572 2076  reates cluster v
-000953a0: 6172 6961 626c 6573 0a20 2020 2020 2020  ariables.       
-000953b0: 2037 2e20 6041 6464 5f50 6f6c 7960 3a20   7. `Add_Poly`: 
-000953c0: 4164 645f 506f 6c79 3d33 2069 6d70 726f  Add_Poly=3 impro
-000953d0: 7665 7320 6365 7274 6169 6e20 6d6f 6465  ves certain mode
-000953e0: 6c73 2077 6865 7265 2074 6865 7265 2069  ls where there i
-000953f0: 7320 6461 7465 2d74 696d 6520 6f72 2063  s date-time or c
-00095400: 6174 6567 6f72 6963 616c 2061 6e64 206e  ategorical and n
-00095410: 756d 6572 6963 2076 6172 6961 626c 6573  umeric variables
-00095420: 0a20 2020 2020 2020 2038 2e20 6066 6561  .        8. `fea
-00095430: 7475 7265 5f72 6564 7563 7469 6f6e 603a  ture_reduction`:
-00095440: 2066 6561 7475 7265 5f72 6564 7563 7469   feature_reducti
-00095450: 6f6e 3d54 7275 6520 6973 2074 6865 2064  on=True is the d
-00095460: 6566 6175 6c74 2061 6e64 2077 6f72 6b73  efault and works
-00095470: 2062 6573 742e 2042 7574 2077 6865 6e20   best. But when 
-00095480: 796f 7520 6861 7665 203c 3130 2066 6561  you have <10 fea
-00095490: 7475 7265 7320 696e 2064 6174 612c 2073  tures in data, s
-000954a0: 6574 2069 7420 746f 2046 616c 7365 0a20  et it to False. 
-000954b0: 2020 2020 2020 2039 2e20 6053 7461 636b         9. `Stack
-000954c0: 696e 675f 466c 6167 603a 2044 6f20 6e6f  ing_Flag`: Do no
-000954d0: 7420 7365 7420 5374 6163 6b69 6e67 5f46  t set Stacking_F
-000954e0: 6c61 673d 5472 7565 2077 6974 6820 4c69  lag=True with Li
-000954f0: 6e65 6172 206d 6f64 656c 7320 7369 6e63  near models sinc
-00095500: 6520 796f 7572 2072 6573 756c 7473 206d  e your results m
-00095510: 6179 206e 6f74 206c 6f6f 6b20 6772 6561  ay not look grea
-00095520: 742e 0a20 2020 2020 2020 2031 302e 2060  t..        10. `
-00095530: 5374 6163 6b69 6e67 5f46 6c61 6760 3a20  Stacking_Flag`: 
-00095540: 5573 6520 5374 6163 6b69 6e67 5f46 6c61  Use Stacking_Fla
-00095550: 673d 5472 7565 206f 6e6c 7920 666f 7220  g=True only for 
-00095560: 636f 6d70 6c65 7820 6d6f 6465 6c73 2061  complex models a
-00095570: 6e64 2061 7320 6120 6c61 7374 2073 7465  nd as a last ste
-00095580: 7020 7769 7468 2042 6f6f 7374 696e 675f  p with Boosting_
-00095590: 466c 6167 3d54 7275 6520 6f72 2043 6174  Flag=True or Cat
-000955a0: 426f 6f73 740a 2020 2020 2020 2020 3131  Boost.        11
-000955b0: 2e20 6068 7970 6572 5f70 6172 616d 603a  . `hyper_param`:
-000955c0: 204c 6561 7665 2068 7970 6572 5f70 6172   Leave hyper_par
-000955d0: 616d 203d 2252 5322 2061 7320 696e 7075  am ="RS" as inpu
-000955e0: 7420 7369 6e63 6520 6974 2072 756e 7320  t since it runs 
-000955f0: 6661 7374 6572 2074 6861 6e20 4772 6964  faster than Grid
-00095600: 5365 6172 6368 4356 2061 6e64 2067 6976  SearchCV and giv
-00095610: 6573 2062 6574 7465 7220 7265 7375 6c74  es better result
-00095620: 7320 756e 6c65 7373 2079 6f75 2068 6176  s unless you hav
-00095630: 6520 6120 736d 616c 6c20 6461 7461 2073  e a small data s
-00095640: 6574 2061 6e64 2063 616e 2061 6666 6f72  et and can affor
-00095650: 6420 746f 2073 7065 6e64 2074 696d 6520  d to spend time 
-00095660: 6f6e 2068 7970 6572 2074 756e 696e 672e  on hyper tuning.
-00095670: 0a20 2020 2020 2020 2031 322e 2060 4b4d  .        12. `KM
-00095680: 6561 6e73 5f46 6561 7475 7269 7a65 7260  eans_Featurizer`
-00095690: 3a20 4b4d 6561 6e73 5f46 6561 7475 7269  : KMeans_Featuri
-000956a0: 7a65 723d 5472 7565 2064 6f65 7320 6e6f  zer=True does no
-000956b0: 7420 776f 726b 2077 656c 6c20 666f 7220  t work well for 
-000956c0: 736d 616c 6c20 6461 7461 2073 6574 732e  small data sets.
-000956d0: 2055 7365 2069 7420 666f 7220 6461 7461   Use it for data
-000956e0: 2073 6574 7320 3e20 3130 2c30 3030 2072   sets > 10,000 r
-000956f0: 6f77 732e 0a20 2020 2020 2020 2031 332e  ows..        13.
-00095700: 2060 4669 6e61 6c20 7468 6f75 6768 7473   `Final thoughts
-00095710: 603a 2046 696e 616c 6c79 2041 7574 6f5f  `: Finally Auto_
-00095720: 5669 4d4c 2069 7320 6d65 616e 7420 746f  ViML is meant to
-00095730: 2062 6520 6120 6261 7365 6c69 6e65 206f   be a baseline o
-00095740: 7220 6368 616c 6c65 6e67 6572 2073 6f6c  r challenger sol
-00095750: 7574 696f 6e20 746f 2079 6f75 7220 6461  ution to your da
-00095760: 7461 2073 6574 2e20 536f 2075 7365 2069  ta set. So use i
-00095770: 7420 666f 7220 6d61 6b69 6e67 2071 7569  t for making qui
-00095780: 636b 206d 6f64 656c 7320 7468 6174 2079  ck models that y
-00095790: 6f75 2063 616e 2063 6f6d 7061 7265 2061  ou can compare a
-000957a0: 6761 696e 7374 206f 7220 696e 2048 6163  gainst or in Hac
-000957b0: 6b61 7468 6f6e 732e 2049 7420 6973 206e  kathons. It is n
-000957c0: 6f74 206d 6561 6e74 2066 6f72 2070 726f  ot meant for pro
-000957d0: 6475 6374 696f 6e21 0a20 2020 2020 2020  duction!.       
-000957e0: 200a 2020 2020 2020 2020 2323 2041 5049   .        ## API
-000957f0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-00095800: 2020 2a2a 4172 6775 6d65 6e74 732a 2a0a    **Arguments**.
-00095810: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00095820: 202d 2060 7472 6169 6e60 3a20 636f 756c   - `train`: coul
-00095830: 6420 6265 2061 2064 6174 6170 6174 682b  d be a datapath+
-00095840: 6669 6c65 6e61 6d65 206f 7220 6120 6461  filename or a da
-00095850: 7461 6672 616d 652e 2049 7420 7769 6c6c  taframe. It will
-00095860: 2064 6574 6563 7420 7768 6963 6820 6973   detect which is
-00095870: 2077 6869 6368 2061 6e64 206c 6f61 6420   which and load 
-00095880: 6974 2e0a 2020 2020 2020 2020 2d20 6074  it..        - `t
-00095890: 6573 7460 3a20 636f 756c 6420 6265 2061  est`: could be a
-000958a0: 2064 6174 6170 6174 682b 6669 6c65 6e61   datapath+filena
-000958b0: 6d65 206f 7220 6120 6461 7461 6672 616d  me or a datafram
-000958c0: 652e 2049 6620 796f 7520 646f 6e27 7420  e. If you don't 
-000958d0: 6861 7665 2061 6e79 2c20 6a75 7374 206c  have any, just l
-000958e0: 6561 7665 2069 7420 6173 2022 222e 0a20  eave it as "".. 
-000958f0: 2020 2020 2020 202d 2060 7375 626d 6973         - `submis
-00095900: 7369 6f6e 603a 206d 7573 7420 6265 2061  sion`: must be a
-00095910: 2064 6174 6170 6174 682b 6669 6c65 6e61   datapath+filena
-00095920: 6d65 2e20 4966 2079 6f75 2064 6f6e 2774  me. If you don't
-00095930: 2068 6176 6520 616e 792c 206a 7573 7420   have any, just 
-00095940: 6c65 6176 6520 6974 2061 7320 656d 7074  leave it as empt
-00095950: 7920 7374 7269 6e67 2e0a 2020 2020 2020  y string..      
-00095960: 2020 2d20 6074 6172 6765 7460 3a20 6e61    - `target`: na
-00095970: 6d65 206f 6620 7468 6520 7461 7267 6574  me of the target
-00095980: 2076 6172 6961 626c 6520 696e 2074 6865   variable in the
-00095990: 2064 6174 6120 7365 742e 0a20 2020 2020   data set..     
-000959a0: 2020 202d 2060 7365 7060 3a20 6966 2079     - `sep`: if y
-000959b0: 6f75 2068 6176 6520 6120 7370 6561 7261  ou have a speara
-000959c0: 746f 7220 696e 2074 6865 2066 696c 6520  tor in the file 
-000959d0: 7375 6368 2061 7320 222c 2220 6f72 2022  such as "," or "
-000959e0: 5c74 2220 6d65 6e74 696f 6e20 6974 2068  \t" mention it h
-000959f0: 6572 652e 2044 6566 6175 6c74 2069 7320  ere. Default is 
-00095a00: 222c 222e 0a20 2020 2020 2020 202d 2060  ","..        - `
-00095a10: 7363 6f72 696e 675f 7061 7261 6d65 7465  scoring_paramete
-00095a20: 7260 3a20 6966 2079 6f75 2077 616e 7420  r`: if you want 
-00095a30: 796f 7572 206f 776e 2073 636f 7269 6e67  your own scoring
-00095a40: 2070 6172 616d 6574 6572 2073 7563 6820   parameter such 
-00095a50: 6173 2022 6631 2220 6769 7665 2069 7420  as "f1" give it 
-00095a60: 6865 7265 2e20 4966 206e 6f74 2c20 6974  here. If not, it
-00095a70: 2077 696c 6c20 6173 7375 6d65 2074 6865   will assume the
-00095a80: 2061 7070 726f 7072 6961 7465 2073 636f   appropriate sco
-00095a90: 7269 6e67 2070 6172 616d 2066 6f72 2074  ring param for t
-00095aa0: 6865 2070 726f 626c 656d 2061 6e64 2069  he problem and i
-00095ab0: 7420 7769 6c6c 2062 7569 6c64 2074 6865  t will build the
-00095ac0: 206d 6f64 656c 2e0a 2020 2020 2020 2020   model..        
-00095ad0: 2d20 6068 7970 6572 5f70 6172 616d 603a  - `hyper_param`:
-00095ae0: 2054 756e 696e 6720 6f70 7469 6f6e 7320   Tuning options 
-00095af0: 6172 6520 4772 6964 5365 6172 6368 2028  are GridSearch (
-00095b00: 2747 5327 2920 616e 6420 5261 6e64 6f6d  'GS') and Random
-00095b10: 697a 6564 5365 6172 6368 2028 2752 5327  izedSearch ('RS'
-00095b20: 292e 2044 6566 6175 6c74 2069 7320 2752  ). Default is 'R
-00095b30: 5327 2e0a 2020 2020 2020 2020 2d20 6066  S'..        - `f
-00095b40: 6561 7475 7265 5f72 6564 7563 7469 6f6e  eature_reduction
-00095b50: 603a 2044 6566 6175 6c74 203d 2027 5472  `: Default = 'Tr
-00095b60: 7565 2720 6275 7420 6974 2063 616e 2062  ue' but it can b
-00095b70: 6520 7365 7420 746f 2046 616c 7365 2069  e set to False i
-00095b80: 6620 796f 7520 646f 6e27 7420 7761 6e74  f you don't want
-00095b90: 2061 7574 6f6d 6174 6963 2066 6561 7475   automatic featu
-00095ba0: 7265 5f72 6564 7563 7469 6f6e 2073 696e  re_reduction sin
-00095bb0: 6365 2069 6e20 496d 6167 6520 6461 7461  ce in Image data
-00095bc0: 2073 6574 7320 6c69 6b65 2064 6967 6974   sets like digit
-00095bd0: 7320 616e 6420 4d4e 4953 542c 2079 6f75  s and MNIST, you
-00095be0: 2067 6574 2062 6574 7465 7220 7265 7375   get better resu
-00095bf0: 6c74 7320 7768 656e 2079 6f75 2064 6f6e  lts when you don
-00095c00: 2774 2072 6564 7563 6520 6665 6174 7572  't reduce featur
-00095c10: 6573 2061 7574 6f6d 6174 6963 616c 6c79  es automatically
-00095c20: 2e20 596f 7520 6361 6e20 616c 7761 7973  . You can always
-00095c30: 2074 7279 2062 6f74 6820 616e 6420 7365   try both and se
-00095c40: 652e 0a20 2020 2020 2020 202d 2060 4b4d  e..        - `KM
-00095c50: 6561 6e73 5f46 6561 7475 7269 7a65 7260  eans_Featurizer`
-00095c60: 0a20 2020 2020 2020 2020 202d 2060 5472  .          - `Tr
-00095c70: 7565 603a 2041 6464 7320 6120 636c 7573  ue`: Adds a clus
-00095c80: 7465 7220 6c61 6265 6c20 746f 2066 6561  ter label to fea
-00095c90: 7475 7265 7320 6261 7365 6420 6f6e 204b  tures based on K
-00095ca0: 4d65 616e 732e 2055 7365 2066 6f72 204c  Means. Use for L
-00095cb0: 696e 6561 722e 0a20 2020 2020 2020 2020  inear..         
-00095cc0: 202d 2060 4661 6c73 6520 2864 6566 6175   - `False (defau
-00095cd0: 6c74 2960 2046 6f72 2052 616e 646f 6d20  lt)` For Random 
-00095ce0: 466f 7265 7374 7320 6f72 2058 4742 206d  Forests or XGB m
-00095cf0: 6f64 656c 732c 206c 6561 7665 2069 7420  odels, leave it 
-00095d00: 4661 6c73 6520 7369 6e63 6520 6974 206d  False since it m
-00095d10: 6179 206f 7665 7266 6974 2e0a 2020 2020  ay overfit..    
-00095d20: 2020 2020 2d20 6042 6f6f 7374 696e 6720      - `Boosting 
-00095d30: 466c 6167 603a 2079 6f75 2068 6176 6520  Flag`: you have 
-00095d40: 3420 706f 7373 6962 6c65 2063 686f 6963  4 possible choic
-00095d50: 6573 2028 6465 6661 756c 7420 6973 2046  es (default is F
-00095d60: 616c 7365 293a 0a20 2020 2020 2020 2020  alse):.         
-00095d70: 202d 2060 4e6f 6e65 6020 5468 6973 2077   - `None` This w
-00095d80: 696c 6c20 6275 696c 6420 6120 4c69 6e65  ill build a Line
-00095d90: 6172 204d 6f64 656c 0a20 2020 2020 2020  ar Model.       
-00095da0: 2020 202d 2060 4661 6c73 6560 2054 6869     - `False` Thi
-00095db0: 7320 7769 6c6c 2062 7569 6c64 2061 2052  s will build a R
-00095dc0: 616e 646f 6d20 466f 7265 7374 206f 7220  andom Forest or 
-00095dd0: 4578 7472 6120 5472 6565 7320 6d6f 6465  Extra Trees mode
-00095de0: 6c20 2861 6c73 6f20 6b6e 6f77 6e20 6173  l (also known as
-00095df0: 2042 6167 6769 6e67 290a 2020 2020 2020   Bagging).      
-00095e00: 2020 2020 2d20 6054 7275 6560 2054 6869      - `True` Thi
-00095e10: 7320 7769 6c6c 2062 7569 6c64 2061 6e20  s will build an 
-00095e20: 5847 426f 6f73 7420 6d6f 6465 6c0a 2020  XGBoost model.  
-00095e30: 2020 2020 2020 2020 2d20 6043 6174 426f          - `CatBo
-00095e40: 6f73 7460 2054 6869 7320 7769 6c6c 2062  ost` This will b
-00095e50: 7569 6c64 2061 2043 6174 426f 6f73 7420  uild a CatBoost 
-00095e60: 6d6f 6465 6c20 2870 726f 7669 6465 6420  model (provided 
-00095e70: 796f 7520 6861 7665 2043 6174 426f 6f73  you have CatBoos
-00095e80: 7420 696e 7374 616c 6c65 6429 0a20 2020  t installed).   
-00095e90: 2020 2020 202d 2060 4164 645f 506f 6c79       - `Add_Poly
-00095ea0: 603a 2044 6566 6175 6c74 2069 7320 3020  `: Default is 0 
-00095eb0: 7768 6963 6820 6d65 616e 7320 646f 2d6e  which means do-n
-00095ec0: 6f74 6869 6e67 2e20 4275 7420 6974 2068  othing. But it h
-00095ed0: 6173 2074 6872 6565 2069 6e74 6572 6573  as three interes
-00095ee0: 7469 6e67 2073 6574 7469 6e67 733a 0a20  ting settings:. 
-00095ef0: 2020 2020 2020 2020 202d 2060 3160 2041           - `1` A
-00095f00: 6464 2069 6e74 6572 6163 7469 6f6e 2076  dd interaction v
-00095f10: 6172 6961 626c 6573 206f 6e6c 7920 7375  ariables only su
-00095f20: 6368 2061 7320 7831 2a78 322c 2078 322a  ch as x1*x2, x2*
-00095f30: 7833 2c2e 2e2e 7839 5c2a 3130 2065 7463  x3,...x9\*10 etc
-00095f40: 2e0a 2020 2020 2020 2020 2020 2d20 6032  ..          - `2
-00095f50: 6020 4164 6420 496e 7465 7261 6374 696f  ` Add Interactio
-00095f60: 6e73 2061 6e64 2053 7175 6172 6564 2076  ns and Squared v
-00095f70: 6172 6961 626c 6573 2073 7563 6820 6173  ariables such as
-00095f80: 2078 312a 2a32 2c20 7832 2a2a 322c 2065   x1**2, x2**2, e
-00095f90: 7463 2e0a 2020 2020 2020 2020 2020 2d20  tc..          - 
-00095fa0: 6033 6020 4164 6473 2062 6f74 6820 496e  `3` Adds both In
-00095fb0: 7465 7261 6374 696f 6e73 2061 6e64 2053  teractions and S
-00095fc0: 7175 6172 6564 2076 6172 6961 626c 6573  quared variables
-00095fd0: 2073 7563 6820 6173 2078 312a 7832 2c20   such as x1*x2, 
-00095fe0: 7831 2a2a 322c 7832 2a78 332c 2078 322a  x1**2,x2*x3, x2*
-00095ff0: 2a32 2c20 6574 632e 0a20 2020 2020 2020  *2, etc..       
-00096000: 202d 2060 5374 6163 6b69 6e67 5f46 6c61   - `Stacking_Fla
-00096010: 6760 3a20 4465 6661 756c 7420 6973 2046  g`: Default is F
-00096020: 616c 7365 2e20 4966 2073 6574 2074 6f20  alse. If set to 
-00096030: 5472 7565 2c20 6974 2077 696c 6c20 6164  True, it will ad
-00096040: 6420 616e 2061 6464 6974 696f 6e61 6c20  d an additional 
-00096050: 6665 6174 7572 6520 7768 6963 6820 6973  feature which is
-00096060: 2064 6572 6976 6564 2066 726f 6d20 7072   derived from pr
-00096070: 6564 6963 7469 6f6e 7320 6f66 2061 6e6f  edictions of ano
-00096080: 7468 6572 206d 6f64 656c 2e20 5468 6973  ther model. This
-00096090: 2069 7320 7573 6564 2069 6e20 736f 6d65   is used in some
-000960a0: 2063 6173 6573 2062 7574 206d 6179 2072   cases but may r
-000960b0: 6573 756c 7420 696e 206f 7665 7266 6974  esult in overfit
-000960c0: 7469 6e67 2e20 536f 2062 6520 6361 7265  ting. So be care
-000960d0: 6675 6c20 7475 726e 696e 6720 7468 6973  ful turning this
-000960e0: 2066 6c61 6720 226f 6e22 2e0a 2020 2020   flag "on"..    
-000960f0: 2020 2020 2d20 6042 696e 6e69 6e67 5f46      - `Binning_F
-00096100: 6c61 6760 3a20 4465 6661 756c 7420 6973  lag`: Default is
-00096110: 2046 616c 7365 2e20 4974 2073 6574 2074   False. It set t
-00096120: 6f20 5472 7565 2c20 6974 2077 696c 6c20  o True, it will 
-00096130: 636f 6e76 6572 7420 7468 6520 746f 7020  convert the top 
-00096140: 6e75 6d65 7269 6320 7661 7269 6162 6c65  numeric variable
-00096150: 7320 696e 746f 2062 696e 6e65 6420 7661  s into binned va
-00096160: 7269 6162 6c65 7320 7468 726f 7567 6820  riables through 
-00096170: 6120 7465 6368 6e69 7175 6520 6b6e 6f77  a technique know
-00096180: 6e20 6173 2022 456e 7472 6f70 7922 2062  n as "Entropy" b
-00096190: 696e 6e69 6e67 2e20 5468 6973 2069 7320  inning. This is 
-000961a0: 7665 7279 2068 656c 7066 756c 2066 6f72  very helpful for
-000961b0: 2063 6572 7461 696e 2064 6174 6173 6574   certain dataset
-000961c0: 7320 2865 7370 6563 6961 6c6c 7920 6861  s (especially ha
-000961d0: 7264 2074 6f20 6275 696c 6420 6d6f 6465  rd to build mode
-000961e0: 6c73 292e 0a20 2020 2020 2020 202d 2060  ls)..        - `
-000961f0: 496d 6261 6c61 6e63 6564 5f46 6c61 6760  Imbalanced_Flag`
-00096200: 3a20 4465 6661 756c 7420 6973 2046 616c  : Default is Fal
-00096210: 7365 2e20 5573 6573 2069 6d62 616c 616e  se. Uses imbalan
-00096220: 6365 645f 656e 7365 6d62 6c65 206c 6962  ced_ensemble lib
-00096230: 7261 7279 2066 6f72 2069 6d62 616c 616e  rary for imbalan
-00096240: 6365 6420 6461 7461 2e20 4a75 7374 2073  ced data. Just s
-00096250: 6574 2049 6d62 616c 616e 6365 645f 466c  et Imbalanced_Fl
-00096260: 6167 203d 2054 7275 6520 696e 2061 7267  ag = True in arg
-00096270: 756d 656e 7473 0a20 2020 2020 2020 202d  uments.        -
-00096280: 2060 7665 7262 6f73 6560 3a20 5468 6973   `verbose`: This
-00096290: 2068 6173 2033 2070 6f73 7369 626c 6520   has 3 possible 
-000962a0: 7374 6174 6573 3a0a 2020 2020 2020 2020  states:.        
-000962b0: 2020 2d20 6030 6020 6c69 6d69 7465 6420    - `0` limited 
-000962c0: 6f75 7470 7574 2e20 4772 6561 7420 666f  output. Great fo
-000962d0: 7220 7275 6e6e 696e 6720 7468 6973 2073  r running this s
-000962e0: 696c 656e 746c 7920 616e 6420 6765 7474  ilently and gett
-000962f0: 696e 6720 6661 7374 2072 6573 756c 7473  ing fast results
-00096300: 2e0a 2020 2020 2020 2020 2020 2d20 6031  ..          - `1
-00096310: 6020 6d6f 7265 2063 6861 7274 732e 2047  ` more charts. G
-00096320: 7265 6174 2066 6f72 206b 6e6f 7769 6e67  reat for knowing
-00096330: 2068 6f77 2072 6573 756c 7473 2077 6572   how results wer
-00096340: 6520 616e 6420 6d61 6b69 6e67 2063 6861  e and making cha
-00096350: 6e67 6573 2074 6f20 666c 6167 7320 696e  nges to flags in
-00096360: 2069 6e70 7574 2e0a 2020 2020 2020 2020   input..        
-00096370: 2020 2d20 6032 6020 6c6f 7473 206f 6620    - `2` lots of 
-00096380: 6368 6172 7473 2061 6e64 206f 7574 7075  charts and outpu
-00096390: 742e 2047 7265 6174 2066 6f72 2072 6570  t. Great for rep
-000963a0: 726f 6475 6369 6e67 2077 6861 7420 4175  roducing what Au
-000963b0: 746f 5f56 694d 4c20 646f 6573 206f 6e20  to_ViML does on 
-000963c0: 796f 7572 206f 776e 2e0a 2020 2020 2020  your own..      
-000963d0: 2020 0a20 2020 2020 2020 202a 2a52 6574    .        **Ret
-000963e0: 7572 6e20 7661 6c75 6573 2a2a 0a20 2020  urn values**.   
-000963f0: 2020 2020 200a 2020 2020 2020 2020 2d20       .        - 
-00096400: 606d 6f64 656c 603a 2049 7420 7769 6c6c  `model`: It will
-00096410: 2072 6574 7572 6e20 796f 7572 2074 7261   return your tra
-00096420: 696e 6564 206d 6f64 656c 0a20 2020 2020  ined model.     
-00096430: 2020 202d 2060 6665 6174 7572 6573 603a     - `features`:
-00096440: 2074 6865 2066 6577 6573 7420 6e75 6d62   the fewest numb
-00096450: 6572 206f 6620 6665 6174 7572 6573 2069  er of features i
-00096460: 6e20 796f 7572 206d 6f64 656c 2074 6f20  n your model to 
-00096470: 6d61 6b65 2069 7420 7065 7266 6f72 6d20  make it perform 
-00096480: 7765 6c6c 0a20 2020 2020 2020 202d 2060  well.        - `
-00096490: 7472 6169 6e5f 6d6f 6469 6669 6564 603a  train_modified`:
-000964a0: 2074 6869 7320 6973 2074 6865 206d 6f64   this is the mod
-000964b0: 6966 6965 6420 7472 6169 6e20 6461 7461  ified train data
-000964c0: 6672 616d 6520 6166 7465 7220 7265 6d6f  frame after remo
-000964d0: 7669 6e67 2061 6e64 2061 6464 696e 6720  ving and adding 
-000964e0: 6665 6174 7572 6573 0a20 2020 2020 2020  features.       
-000964f0: 202d 2060 7465 7374 5f6d 6f64 6966 6965   - `test_modifie
-00096500: 6460 3a20 7468 6973 2069 7320 7468 6520  d`: this is the 
-00096510: 6d6f 6469 6669 6564 2074 6573 7420 6461  modified test da
-00096520: 7461 6672 616d 6520 7769 7468 2074 6865  taframe with the
-00096530: 2073 616d 6520 7472 616e 7366 6f72 6d61   same transforma
-00096540: 7469 6f6e 7320 6173 2074 7261 696e 0a20  tions as train. 
-00096550: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00096560: 2323 204d 6169 6e74 6169 6e65 7273 0a20  ## Maintainers. 
-00096570: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00096580: 2a20 5b40 4175 746f 5669 4d4c 5d28 6874  * [@AutoViML](ht
-00096590: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-000965a0: 2f41 7574 6f56 694d 4c29 0a20 2020 2020  /AutoViML).     
-000965b0: 2020 202a 205b 406d 6f72 656e 6f68 3134     * [@morenoh14
-000965c0: 395d 2868 7474 7073 3a2f 2f67 6974 6875  9](https://githu
-000965d0: 622e 636f 6d2f 6d6f 7265 6e6f 6831 3439  b.com/morenoh149
-000965e0: 290a 2020 2020 2020 2020 2a20 5b40 6869  ).        * [@hi
-000965f0: 726f 6e72 6f79 5d28 6874 7470 733a 2f2f  ronroy](https://
-00096600: 6769 7468 7562 2e63 6f6d 2f68 6972 6f6e  github.com/hiron
-00096610: 726f 7929 0a20 2020 2020 2020 200a 2020  roy).        .  
-00096620: 2020 2020 2020 2323 2043 6f6e 7472 6962        ## Contrib
-00096630: 7574 696e 670a 2020 2020 2020 2020 0a20  uting.        . 
-00096640: 2020 2020 2020 2053 6565 205b 7468 6520         See [the 
-00096650: 636f 6e74 7269 6275 7469 6e67 2066 696c  contributing fil
-00096660: 655d 2843 4f4e 5452 4942 5554 494e 472e  e](CONTRIBUTING.
-00096670: 6d64 2921 0a20 2020 2020 2020 200a 2020  md)!.        .  
-00096680: 2020 2020 2020 5052 7320 6163 6365 7074        PRs accept
-00096690: 6564 2e0a 2020 2020 2020 2020 0a20 2020  ed..        .   
-000966a0: 2020 2020 2023 2320 4c69 6365 6e73 650a       ## License.
-000966b0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-000966c0: 2041 7061 6368 6520 4c69 6365 6e73 6520   Apache License 
-000966d0: 322e 3020 c2a9 2032 3032 3020 5261 6d20  2.0 .. 2020 Ram 
-000966e0: 5365 7368 6164 7269 0a20 2020 2020 2020  Seshadri.       
-000966f0: 200a 2020 2020 2020 2020 2323 2044 4953   .        ## DIS
-00096700: 434c 4149 4d45 520a 2020 2020 2020 2020  CLAIMER.        
-00096710: 5468 6973 2070 726f 6a65 6374 2069 7320  This project is 
-00096720: 6e6f 7420 616e 206f 6666 6963 6961 6c20  not an official 
-00096730: 476f 6f67 6c65 2070 726f 6a65 6374 2e20  Google project. 
-00096740: 4974 2069 7320 6e6f 7420 7375 7070 6f72  It is not suppor
-00096750: 7465 6420 6279 2047 6f6f 676c 6520 616e  ted by Google an
-00096760: 6420 476f 6f67 6c65 2073 7065 6369 6669  d Google specifi
-00096770: 6361 6c6c 7920 6469 7363 6c61 696d 7320  cally disclaims 
-00096780: 616c 6c20 7761 7272 616e 7469 6573 2061  all warranties a
-00096790: 7320 746f 2069 7473 2071 7561 6c69 7479  s to its quality
-000967a0: 2c20 6d65 7263 6861 6e74 6162 696c 6974  , merchantabilit
-000967b0: 792c 206f 7220 6669 746e 6573 7320 666f  y, or fitness fo
-000967c0: 7220 6120 7061 7274 6963 756c 6172 2070  r a particular p
-000967d0: 7572 706f 7365 2e0a 2020 2020 2020 2020  urpose..        
-000967e0: 0a50 6c61 7466 6f72 6d3a 2055 4e4b 4e4f  .Platform: UNKNO
-000967f0: 574e 0a43 6c61 7373 6966 6965 723a 2050  WN.Classifier: P
-00096800: 726f 6772 616d 6d69 6e67 204c 616e 6775  rogramming Langu
-00096810: 6167 6520 3a3a 2050 7974 686f 6e20 3a3a  age :: Python ::
-00096820: 2033 0a43 6c61 7373 6966 6965 723a 204f   3.Classifier: O
-00096830: 7065 7261 7469 6e67 2053 7973 7465 6d20  perating System 
-00096840: 3a3a 204f 5320 496e 6465 7065 6e64 656e  :: OS Independen
-00096850: 740a 4465 7363 7269 7074 696f 6e2d 436f  t.Description-Co
-00096860: 6e74 656e 742d 5479 7065 3a20 7465 7874  ntent-Type: text
-00096870: 2f6d 6172 6b64 6f77 6e0a 0000 0000 0000  /markdown.......
+00093360: 4d61 7263 6820 3230 3233 290a 2020 2020  March 2023).    
+00093370: 2020 2020 3c6f 6c3e 0a20 2020 2020 2020      <ol>.       
+00093380: 203c 6c69 3e3c 623e 4175 746f 5f56 694d   <li><b>Auto_ViM
+00093390: 4c20 6861 7320 6120 6e65 7720 666c 6167  L has a new flag
+000933a0: 2074 6f20 7370 6565 6420 7570 2070 726f   to speed up pro
+000933b0: 6365 7373 696e 6720 7573 696e 6720 4750  cessing using GP
+000933c0: 5527 733c 2f62 3e2e 204a 7573 7420 7365  U's</b>. Just se
+000933d0: 7420 7468 6520 6047 5055 5f66 6c61 6760  t the `GPU_flag`
+000933e0: 3d60 5472 7565 6020 6f6e 2043 6f6c 6162  =`True` on Colab
+000933f0: 2061 6e64 206f 7468 6572 2065 6e76 6972   and other envir
+00093400: 6f6e 6d65 6e74 732e 2042 7574 2064 6f6e  onments. But don
+00093410: 2774 2066 6f72 6765 7420 746f 2073 6574  't forget to set
+00093420: 2074 6865 2072 756e 7469 6d65 2074 7970   the runtime typ
+00093430: 6520 746f 2062 6520 2247 5055 2220 7768  e to be "GPU" wh
+00093440: 696c 6520 7275 6e6e 696e 6720 6f6e 2043  ile running on C
+00093450: 6f6c 6162 2e20 4f74 6865 7277 6973 6520  olab. Otherwise 
+00093460: 796f 7520 7769 6c6c 2067 6574 2061 6e20  you will get an 
+00093470: 6572 726f 722e 3c2f 6c69 3e0a 2020 2020  error.</li>.    
+00093480: 2020 2020 3c2f 6f6c 3e0a 2020 2020 2020      </ol>.      
+00093490: 2020 0a20 2020 2020 2020 2023 2320 5570    .        ## Up
+000934a0: 6461 7465 2028 4d61 7920 3230 3232 290a  date (May 2022).
+000934b0: 2020 2020 2020 2020 3c6f 6c3e 0a20 2020          <ol>.   
+000934c0: 2020 2020 203c 6c69 3e3c 623e 4175 746f       <li><b>Auto
+000934d0: 5f56 694d 4c20 6173 206f 6620 7665 7273  _ViML as of vers
+000934e0: 696f 6e20 302e 312e 3731 3020 7573 6573  ion 0.1.710 uses
+000934f0: 2061 2076 6572 7920 6869 6768 2070 6572   a very high per
+00093500: 666f 726d 616e 6365 206c 6962 7261 7279  formance library
+00093510: 2063 616c 6c65 6420 6069 6d62 616c 616e   called `imbalan
+00093520: 6365 645f 656e 7365 6d62 6c65 6020 666f  ced_ensemble` fo
+00093530: 7220 496d 6261 6c61 6e63 6564 2064 6174  r Imbalanced dat
+00093540: 6173 6574 2070 726f 626c 656d 732e 3c2f  aset problems.</
+00093550: 623e 2049 7420 7769 6c6c 2070 726f 6475  b> It will produ
+00093560: 6365 2061 2035 2d31 3025 2062 6f6f 7374  ce a 5-10% boost
+00093570: 2069 6e20 796f 7572 2062 616c 616e 6365   in your balance
+00093580: 645f 6163 6375 7261 6379 2062 6173 6564  d_accuracy based
+00093590: 206f 6e20 6d79 2065 7870 6572 6965 6e63   on my experienc
+000935a0: 6520 7769 7468 2020 6d61 6e79 2064 6174  e with  many dat
+000935b0: 6173 6574 7320 4920 6861 7665 2074 7269  asets I have tri
+000935c0: 6564 2e3c 2f6c 693e 0a20 2020 2020 2020  ed.</li>.       
+000935d0: 203c 6272 3e0a 2020 2020 2020 2020 3c70   <br>.        <p
+000935e0: 3e49 6e20 6164 6469 7469 6f6e 2c20 6e65  >In addition, ne
+000935f0: 7720 6665 6174 7572 6573 2069 6e20 7468  w features in th
+00093600: 6973 2076 6572 7369 6f6e 2061 7265 3a3c  is version are:<
+00093610: 6272 3e0a 2020 2020 2020 2020 3c75 6c3e  br>.        <ul>
+00093620: 0a20 2020 2020 2020 203c 6c69 3e53 554c  .        <li>SUL
+00093630: 4f56 202d 3e20 5573 6573 2074 6865 2053  OV -> Uses the S
+00093640: 554c 4f56 2061 6c67 6f72 6974 686d 2066  ULOV algorithm f
+00093650: 6f72 2072 656d 6f76 696e 6720 6869 6768  or removing high
+00093660: 6c79 2063 6f72 7265 6c61 7465 6420 6665  ly correlated fe
+00093670: 6174 7572 6573 2061 7574 6f6d 6174 6963  atures automatic
+00093680: 616c 6c79 2e3c 2f6c 693e 0a20 2020 2020  ally.</li>.     
+00093690: 2020 203c 6c69 3e41 7574 6f5f 4e4c 5020     <li>Auto_NLP 
+000936a0: 2d3e 2041 7574 6f56 694d 4c20 6175 746f  -> AutoViML auto
+000936b0: 6d61 7469 6361 6c6c 7920 6465 7465 6374  matically detect
+000936c0: 7320 5465 7874 2076 6172 6961 626c 6573  s Text variables
+000936d0: 2061 6e64 2064 6f65 7320 4e4c 5020 7072   and does NLP pr
+000936e0: 6f63 6573 7369 6e67 2075 7369 6e67 2041  ocessing using A
+000936f0: 7574 6f5f 4e4c 503c 2f6c 693e 0a20 2020  uto_NLP</li>.   
+00093700: 2020 2020 203c 6c69 3e44 6174 6520 5469       <li>Date Ti
+00093710: 6d65 202d 3e20 4974 2061 7574 6f6d 6174  me -> It automat
+00093720: 6963 616c 6c79 2064 6574 6563 7473 2020  ically detects  
+00093730: 6461 7465 2074 696d 6520 7661 7269 6162  date time variab
+00093740: 6c65 7320 616e 6420 6765 6e65 7261 7465  les and generate
+00093750: 7320 6e65 7720 6665 6174 7572 6573 3c2f  s new features</
+00093760: 6c69 3e0a 2020 2020 2020 2020 3c6c 693e  li>.        <li>
+00093770: 6069 6d62 616c 616e 6365 645f 656e 7365  `imbalanced_ense
+00093780: 6d62 6c65 6020 6c69 6272 6172 7920 2d3e  mble` library ->
+00093790: 2055 7365 7320 696d 6261 6c61 6e63 6564   Uses imbalanced
+000937a0: 5f65 6e73 656d 626c 6520 6c69 6272 6172  _ensemble librar
+000937b0: 7920 666f 7220 696d 6261 6c61 6e63 6564  y for imbalanced
+000937c0: 2064 6174 612e 204a 7573 7420 7365 7420   data. Just set 
+000937d0: 496d 6261 6c61 6e63 6564 5f46 6c61 6720  Imbalanced_Flag 
+000937e0: 3d20 5472 7565 2069 6e20 6172 6775 6d65  = True in argume
+000937f0: 6e74 733c 2f6c 693e 0a20 2020 2020 2020  nts</li>.       
+00093800: 203c 6c69 3e46 6561 7475 7265 2053 656c   <li>Feature Sel
+00093810: 6563 7469 6f6e 202d 3e20 5765 2075 7365  ection -> We use
+00093820: 2074 6865 2073 616d 6520 616c 676f 7269   the same algori
+00093830: 7468 6d20 7468 6174 2066 6561 7475 7265  thm that feature
+00093840: 7769 7a20 6c69 6272 6172 7920 7573 6573  wiz library uses
+00093850: 3a20 5355 4c4f 5620 616e 6420 5265 6375  : SULOV and Recu
+00093860: 7273 6976 6520 5847 426f 6f73 7420 746f  rsive XGBoost to
+00093870: 2073 656c 6563 7420 6265 7374 2066 6561   select best fea
+00093880: 7475 7265 7320 6661 7374 2e20 5365 6520  tures fast. See 
+00093890: 6265 6c6f 772e 3c2f 6c69 3e0a 2020 2020  below.</li>.    
+000938a0: 2020 2020 3c2f 756c 3e0a 2020 2020 2020      </ul>.      
+000938b0: 2020 0a20 2020 2020 2020 2023 2320 5461    .        ## Ta
+000938c0: 626c 6520 6f66 2043 6f6e 7465 6e74 730a  ble of Contents.
+000938d0: 2020 2020 2020 2020 3c75 6c3e 0a20 2020          <ul>.   
+000938e0: 2020 2020 203c 6c69 3e3c 6120 6872 6566       <li><a href
+000938f0: 3d22 2362 6163 6b67 726f 756e 6422 3e42  ="#background">B
+00093900: 6163 6b67 726f 756e 643c 2f61 3e3c 2f6c  ackground</a></l
+00093910: 693e 0a20 2020 2020 2020 203c 6c69 3e3c  i>.        <li><
+00093920: 6120 6872 6566 3d22 2369 6e73 7461 6c6c  a href="#install
+00093930: 223e 496e 7374 616c 6c3c 2f61 3e3c 2f6c  ">Install</a></l
+00093940: 693e 0a20 2020 2020 2020 203c 6c69 3e3c  i>.        <li><
+00093950: 6120 6872 6566 3d22 2375 7361 6765 223e  a href="#usage">
+00093960: 5573 6167 653c 2f61 3e3c 2f6c 693e 0a20  Usage</a></li>. 
+00093970: 2020 2020 2020 203c 6c69 3e3c 6120 6872         <li><a hr
+00093980: 6566 3d22 2374 6970 732d 666f 722d 7573  ef="#tips-for-us
+00093990: 696e 672d 6175 746f 5f76 696d 6c22 3e54  ing-auto_viml">T
+000939a0: 6970 7320 666f 7220 7573 696e 6720 4175  ips for using Au
+000939b0: 746f 5f56 694d 4c3c 2f61 3e3c 2f6c 693e  to_ViML</a></li>
+000939c0: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
+000939d0: 6872 6566 3d22 2361 7069 223e 4150 493c  href="#api">API<
+000939e0: 2f61 3e3c 2f6c 693e 0a20 2020 2020 2020  /a></li>.       
+000939f0: 203c 6c69 3e3c 6120 6872 6566 3d22 236d   <li><a href="#m
+00093a00: 6169 6e74 6169 6e65 7273 223e 4d61 696e  aintainers">Main
+00093a10: 7461 696e 6572 733c 2f61 3e3c 2f6c 693e  tainers</a></li>
+00093a20: 0a20 2020 2020 2020 203c 6c69 3e3c 6120  .        <li><a 
+00093a30: 6872 6566 3d22 2363 6f6e 7472 6962 7574  href="#contribut
+00093a40: 696e 6722 3e43 6f6e 7472 6962 7574 696e  ing">Contributin
+00093a50: 673c 2f61 3e3c 2f6c 693e 0a20 2020 2020  g</a></li>.     
+00093a60: 2020 203c 6c69 3e3c 6120 6872 6566 3d22     <li><a href="
+00093a70: 236c 6963 656e 7365 223e 4c69 6365 6e73  #license">Licens
+00093a80: 653c 2f61 3e3c 2f6c 693e 0a20 2020 2020  e</a></li>.     
+00093a90: 2020 203c 2f75 6c3e 0a20 2020 2020 2020     </ul>.       
+00093aa0: 200a 2020 2020 2020 2020 2323 2042 6163   .        ## Bac
+00093ab0: 6b67 726f 756e 640a 2020 2020 2020 2020  kground.        
+00093ac0: 3c70 3e52 6561 6420 7468 6973 203c 6120  <p>Read this <a 
+00093ad0: 6872 6566 3d22 6874 7470 733a 2f2f 746f  href="https://to
+00093ae0: 7761 7264 7364 6174 6173 6369 656e 6365  wardsdatascience
+00093af0: 2e63 6f6d 2f77 6879 2d61 7574 6f6d 6c2d  .com/why-automl-
+00093b00: 6973 2d61 6e2d 6573 7365 6e74 6961 6c2d  is-an-essential-
+00093b10: 6e65 772d 746f 6f6c 2d66 6f72 2d64 6174  new-tool-for-dat
+00093b20: 612d 7363 6965 6e74 6973 7473 2d32 6439  a-scientists-2d9
+00093b30: 6162 3465 3235 6534 3622 3e4d 6564 6975  ab4e25e46">Mediu
+00093b40: 6d20 6172 7469 636c 6520 746f 206c 6561  m article to lea
+00093b50: 726e 2068 6f77 2074 6f20 7573 6520 4175  rn how to use Au
+00093b60: 746f 5f56 694d 4c20 6566 6665 6374 6976  to_ViML effectiv
+00093b70: 656c 792e 3c2f 613e 0a20 2020 2020 2020  ely.</a>.       
+00093b80: 200a 2020 2020 2020 2020 3c70 3e41 7574   .        <p>Aut
+00093b90: 6f5f 5669 4d4c 2077 6173 2064 6573 6967  o_ViML was desig
+00093ba0: 6e65 6420 666f 7220 6275 696c 6469 6e67  ned for building
+00093bb0: 2048 6967 6820 5065 7266 6f72 6d61 6e63   High Performanc
+00093bc0: 6520 496e 7465 7270 7265 7461 626c 6520  e Interpretable 
+00093bd0: 4d6f 6465 6c73 2077 6974 6820 7468 6520  Models with the 
+00093be0: 6665 7765 7374 2076 6172 6961 626c 6573  fewest variables
+00093bf0: 206e 6565 6465 642e 0a20 2020 2020 2020   needed..       
+00093c00: 2054 6865 2022 5622 2069 6e20 4175 746f   The "V" in Auto
+00093c10: 5f56 694d 4c20 7374 616e 6473 2066 6f72  _ViML stands for
+00093c20: 2056 6172 6961 6e74 2062 6563 6175 7365   Variant because
+00093c30: 2069 7420 7472 6965 7320 6d75 6c74 6970   it tries multip
+00093c40: 6c65 206d 6f64 656c 7320 7769 7468 206d  le models with m
+00093c50: 756c 7469 706c 6520 6665 6174 7572 6573  ultiple features
+00093c60: 2074 6f20 6669 6e64 2079 6f75 2074 6865   to find you the
+00093c70: 2062 6573 7420 7065 7266 6f72 6d69 6e67   best performing
+00093c80: 206d 6f64 656c 2066 6f72 2079 6f75 7220   model for your 
+00093c90: 6461 7461 7365 742e 2054 6865 2022 6922  dataset. The "i"
+00093ca0: 2069 6e20 4175 746f 5f56 694d 4c20 7374   in Auto_ViML st
+00093cb0: 616e 6473 2066 6f72 2022 696e 7465 7270  ands for "interp
+00093cc0: 7265 7461 626c 6522 2073 696e 6365 2041  retable" since A
+00093cd0: 7574 6f5f 5669 4d4c 2073 656c 6563 7473  uto_ViML selects
+00093ce0: 2074 6865 206c 6561 7374 206e 756d 6265   the least numbe
+00093cf0: 7220 6f66 2066 6561 7475 7265 7320 6e65  r of features ne
+00093d00: 6365 7373 6172 7920 746f 2062 7569 6c64  cessary to build
+00093d10: 2061 2073 696d 706c 6572 2c20 6d6f 7265   a simpler, more
+00093d20: 2069 6e74 6572 7072 6574 6162 6c65 206d   interpretable m
+00093d30: 6f64 656c 2e20 496e 206d 6f73 7420 6361  odel. In most ca
+00093d40: 7365 732c 2041 7574 6f5f 5669 4d4c 2062  ses, Auto_ViML b
+00093d50: 7569 6c64 7320 6d6f 6465 6c73 2077 6974  uilds models wit
+00093d60: 6820 3230 252d 3939 2520 6665 7765 7220  h 20%-99% fewer 
+00093d70: 6665 6174 7572 6573 2074 6861 6e20 6120  features than a 
+00093d80: 7369 6d69 6c61 7220 7065 7266 6f72 6d69  similar performi
+00093d90: 6e67 206d 6f64 656c 2077 6974 6820 616c  ng model with al
+00093da0: 6c20 696e 636c 7564 6564 2066 6561 7475  l included featu
+00093db0: 7265 7320 2874 6869 7320 6973 2062 6173  res (this is bas
+00093dc0: 6564 206f 6e20 6d79 2074 7269 616c 732e  ed on my trials.
+00093dd0: 2059 6f75 7220 6578 7065 7269 656e 6365   Your experience
+00093de0: 206d 6179 2076 6172 7929 2e3c 6272 3e0a   may vary).<br>.
+00093df0: 2020 2020 2020 2020 3c70 3e0a 2020 2020          <p>.    
+00093e00: 2020 2020 4175 746f 5f56 694d 4c20 6973      Auto_ViML is
+00093e10: 2065 7665 7279 2044 6174 6120 5363 6965   every Data Scie
+00093e20: 6e74 6973 7427 7320 6d6f 6465 6c20 6163  ntist's model ac
+00093e30: 6365 6c65 7261 746f 7220 746f 6f6c 2074  celerator tool t
+00093e40: 6861 743a 3c6f 6c3e 0a20 2020 2020 2020  hat:<ol>.       
+00093e50: 203c 6c69 3e3c 623e 4865 6c70 7320 796f   <li><b>Helps yo
+00093e60: 7520 7769 7468 2064 6174 6120 636c 6561  u with data clea
+00093e70: 6e69 6e67 3c2f 623e 3a20 796f 7520 6361  ning</b>: you ca
+00093e80: 6e20 7365 6e64 2069 6e20 796f 7572 2065  n send in your e
+00093e90: 6e74 6972 6520 6461 7461 6672 616d 6520  ntire dataframe 
+00093ea0: 6173 2069 7320 616e 6420 4175 746f 5f56  as is and Auto_V
+00093eb0: 694d 4c20 7769 6c6c 2073 7567 6765 7374  iML will suggest
+00093ec0: 2063 6861 6e67 6573 2074 6f20 6865 6c70   changes to help
+00093ed0: 2077 6974 6820 6d69 7373 696e 6720 7661   with missing va
+00093ee0: 6c75 6573 2c20 666f 726d 6174 7469 6e67  lues, formatting
+00093ef0: 2076 6172 6961 626c 6573 2c20 6164 6469   variables, addi
+00093f00: 6e67 2076 6172 6961 626c 6573 2c20 6574  ng variables, et
+00093f10: 632e 2049 7420 6c6f 7665 7320 6469 7274  c. It loves dirt
+00093f20: 7920 6461 7461 2e20 5468 6520 6469 7274  y data. The dirt
+00093f30: 6965 7220 7468 6520 6265 7474 6572 213c  ier the better!<
+00093f40: 6272 3e0a 2020 2020 2020 2020 3c6c 693e  br>.        <li>
+00093f50: 3c62 3e50 6572 666f 726d 7320 4665 6174  <b>Performs Feat
+00093f60: 7572 6520 5365 6c65 6374 696f 6e3c 2f62  ure Selection</b
+00093f70: 3e3a 2041 7574 6f5f 5669 4d4c 2073 656c  >: Auto_ViML sel
+00093f80: 6563 7473 2076 6172 6961 626c 6573 2061  ects variables a
+00093f90: 7574 6f6d 6174 6963 616c 6c79 2062 7920  utomatically by 
+00093fa0: 6465 6661 756c 742e 2054 6869 7320 6973  default. This is
+00093fb0: 2076 6572 7920 6865 6c70 6675 6c20 7768   very helpful wh
+00093fc0: 656e 2079 6f75 2068 6176 6520 6875 6e64  en you have hund
+00093fd0: 7265 6473 2069 6620 6e6f 7420 7468 6f75  reds if not thou
+00093fe0: 7361 6e64 7320 6f66 2076 6172 6961 626c  sands of variabl
+00093ff0: 6573 2073 696e 6365 2069 7420 6361 6e20  es since it can 
+00094000: 7265 6164 696c 7920 6964 656e 7469 6679  readily identify
+00094010: 2077 6869 6368 206f 6620 7468 6f73 6520   which of those 
+00094020: 6172 6520 696d 706f 7274 616e 7420 7661  are important va
+00094030: 7269 6162 6c65 7320 7673 2077 6869 6368  riables vs which
+00094040: 2061 7265 2075 6e6e 6563 6573 7361 7279   are unnecessary
+00094050: 2e20 596f 7520 6361 6e20 7475 726e 2074  . You can turn t
+00094060: 6869 7320 6f66 6620 6173 2077 656c 6c20  his off as well 
+00094070: 2873 6565 2041 5049 292e 3c62 723e 0a20  (see API).<br>. 
+00094080: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00094090: 215b 7867 626f 6f73 745d 2873 756c 6f76  ![xgboost](sulov
+000940a0: 5f78 6762 6f6f 7374 2e70 6e67 290a 2020  _xgboost.png).  
+000940b0: 2020 2020 2020 3c6c 693e 3c62 3e52 656d        <li><b>Rem
+000940c0: 6f76 6573 2068 6967 686c 7920 636f 7272  oves highly corr
+000940d0: 656c 6174 6564 2066 6561 7475 7265 7320  elated features 
+000940e0: 6175 746f 6d61 7469 6361 6c6c 793c 2f62  automatically</b
+000940f0: 3e2e 2049 6620 7477 6f20 7661 7269 6162  >. If two variab
+00094100: 6c65 7320 6172 6520 6869 6768 6c79 2063  les are highly c
+00094110: 6f72 7265 6c61 7465 6420 696e 2079 6f75  orrelated in you
+00094120: 7220 6461 7461 7365 742c 2077 6869 6368  r dataset, which
+00094130: 206f 6e65 2073 686f 756c 6420 796f 7520   one should you 
+00094140: 7265 6d6f 7665 2061 6e64 2077 6869 6368  remove and which
+00094150: 206f 6e65 2073 686f 756c 6420 796f 7520   one should you 
+00094160: 6b65 6570 3f20 5468 6520 6465 6369 7369  keep? The decisi
+00094170: 6f6e 2069 7320 6e6f 7420 6173 2065 6173  on is not as eas
+00094180: 7920 6173 2069 7420 6c6f 6f6b 732e 2041  y as it looks. A
+00094190: 7574 6f5f 5669 4d4c 2075 7365 7320 7468  uto_ViML uses th
+000941a0: 6520 5355 4c4f 5620 616c 676f 7269 7468  e SULOV algorith
+000941b0: 6d20 746f 2072 656d 6f76 6520 6869 6768  m to remove high
+000941c0: 6c79 2063 6f72 7265 6c61 7465 6420 6665  ly correlated fe
+000941d0: 6174 7572 6573 2e20 596f 7520 6361 6e20  atures. You can 
+000941e0: 756e 6465 7273 7461 6e64 2053 554c 4f56  understand SULOV
+000941f0: 2066 726f 6d20 7468 6973 2070 6963 7475   from this pictu
+00094200: 7265 206d 6f72 6520 696e 7475 6974 6976  re more intuitiv
+00094210: 656c 792e 3c62 723e 0a20 2020 2020 2020  ely.<br>.       
+00094220: 200a 2020 2020 2020 2020 215b 7375 6c6f   .        ![sulo
+00094230: 765d 2853 554c 4f56 2e6a 7067 290a 2020  v](SULOV.jpg).  
+00094240: 2020 2020 2020 0a20 2020 2020 2020 203c        .        <
+00094250: 6c69 3e3c 623e 4765 6e65 7261 7465 7320  li><b>Generates 
+00094260: 7065 7266 6f72 6d61 6e63 6520 7265 7375  performance resu
+00094270: 6c74 7320 6772 6170 6869 6361 6c6c 793c  lts graphically<
+00094280: 2f62 3e2e 204a 7573 7420 7365 7420 7665  /b>. Just set ve
+00094290: 7262 6f73 6520 3d20 3120 286f 7229 2032  rbose = 1 (or) 2
+000942a0: 2069 6e73 7465 6164 206f 6620 3020 2873   instead of 0 (s
+000942b0: 696c 656e 7429 2e20 596f 7520 7769 6c6c  ilent). You will
+000942c0: 2067 6574 2068 6967 6865 7220 7175 616c   get higher qual
+000942d0: 6974 7920 6f66 2069 6e73 6967 6874 7320  ity of insights 
+000942e0: 6173 2079 6f75 2069 6e63 7265 6173 6520  as you increase 
+000942f0: 7665 7262 6f73 6974 792e 203c 6272 3e0a  verbosity. <br>.
+00094300: 2020 2020 2020 2020 3c6c 693e 3c62 3e48          <li><b>H
+00094310: 616e 646c 6573 2074 6578 742c 2064 6174  andles text, dat
+00094320: 652d 7469 6d65 2c20 7374 7275 6374 7320  e-time, structs 
+00094330: 286c 6973 7473 2c20 6469 6374 696f 6e61  (lists, dictiona
+00094340: 7269 6573 292c 206e 756d 6572 6963 2c20  ries), numeric, 
+00094350: 626f 6f6c 6561 6e2c 2066 6163 746f 7220  boolean, factor 
+00094360: 616e 6420 6361 7465 676f 7269 6361 6c3c  and categorical<
+00094370: 2f62 3e20 7661 7269 6162 6c65 7320 616c  /b> variables al
+00094380: 6c20 696e 206f 6e65 206d 6f64 656c 2075  l in one model u
+00094390: 7369 6e67 206f 6e65 2073 7472 6169 6768  sing one straigh
+000943a0: 7420 7072 6f63 6573 732e 3c62 723e 0a20  t process.<br>. 
+000943b0: 2020 2020 2020 203c 2f6f 6c3e 0a20 2020         </ol>.   
+000943c0: 2020 2020 2041 7574 6f5f 5669 4d4c 2069       Auto_ViML i
+000943d0: 7320 6275 696c 7420 7573 696e 6720 7363  s built using sc
+000943e0: 696b 6974 2d6c 6561 726e 2c20 6e75 6d70  ikit-learn, nump
+000943f0: 792c 2070 616e 6461 7320 616e 6420 6d61  y, pandas and ma
+00094400: 7470 6c6f 746c 6962 2e20 4974 2073 686f  tplotlib. It sho
+00094410: 756c 6420 7275 6e20 6f6e 206d 6f73 7420  uld run on most 
+00094420: 5079 7468 6f6e 2033 2041 6e61 636f 6e64  Python 3 Anacond
+00094430: 6120 696e 7374 616c 6c61 7469 6f6e 732e  a installations.
+00094440: 2059 6f75 2077 6f6e 2774 2068 6176 6520   You won't have 
+00094450: 746f 2069 6d70 6f72 7420 616e 7920 7370  to import any sp
+00094460: 6563 6961 6c20 6c69 6272 6172 6965 7320  ecial libraries 
+00094470: 6f74 6865 7220 7468 616e 2022 5847 426f  other than "XGBo
+00094480: 6f73 7422 2c20 2249 6d62 616c 616e 6365  ost", "Imbalance
+00094490: 642d 4c65 6172 6e22 2c20 2243 6174 426f  d-Learn", "CatBo
+000944a0: 6f73 7422 2c20 616e 6420 2266 6561 7475  ost", and "featu
+000944b0: 7265 746f 6f6c 7322 206c 6962 7261 7279  retools" library
+000944c0: 2e20 5765 2075 7365 2022 5348 4150 2220  . We use "SHAP" 
+000944d0: 6c69 6272 6172 7920 666f 7220 696e 7465  library for inte
+000944e0: 7270 7265 7461 6269 6c69 7479 2e20 3c62  rpretability. <b
+000944f0: 723e 4275 7420 6966 2079 6f75 2064 6f6e  r>But if you don
+00094500: 2774 2068 6176 6520 7468 6573 6520 6c69  't have these li
+00094510: 6272 6172 6965 732c 2041 7574 6f5f 5669  braries, Auto_Vi
+00094520: 4d4c 2077 696c 6c20 696e 7374 616c 6c20  ML will install 
+00094530: 7468 6f73 6520 666f 7220 796f 7520 6175  those for you au
+00094540: 746f 6d61 7469 6361 6c6c 792e 0a20 2020  tomatically..   
+00094550: 2020 2020 200a 2020 2020 2020 2020 2323       .        ##
+00094560: 2049 6e73 7461 6c6c 0a20 2020 2020 2020   Install.       
+00094570: 200a 2020 2020 2020 2020 2a2a 5072 6572   .        **Prer
+00094580: 6571 7573 6974 6573 3a2a 2a0a 2020 2020  equsites:**.    
+00094590: 2020 2020 0a20 2020 2020 2020 202d 205b      .        - [
+000945a0: 416e 6163 6f6e 6461 5d28 6874 7470 733a  Anaconda](https:
+000945b0: 2f2f 646f 6373 2e61 6e61 636f 6e64 612e  //docs.anaconda.
+000945c0: 636f 6d2f 616e 6163 6f6e 6461 2f69 6e73  com/anaconda/ins
+000945d0: 7461 6c6c 2f29 0a20 2020 2020 2020 200a  tall/).        .
+000945e0: 2020 2020 2020 2020 546f 2063 6c6f 6e65          To clone
+000945f0: 2041 7574 6f5f 5669 4d4c 2c20 6974 2069   Auto_ViML, it i
+00094600: 7320 6265 7474 6572 2074 6f20 6372 6561  s better to crea
+00094610: 7465 2061 206e 6577 2065 6e76 6972 6f6e  te a new environ
+00094620: 6d65 6e74 2c20 616e 6420 696e 7374 616c  ment, and instal
+00094630: 6c20 7468 6520 7265 7175 6972 6564 2064  l the required d
+00094640: 6570 656e 6465 6e63 6965 733a 0a20 2020  ependencies:.   
+00094650: 2020 2020 200a 2020 2020 2020 2020 546f       .        To
+00094660: 2069 6e73 7461 6c6c 2066 726f 6d20 5079   install from Py
+00094670: 5069 3a0a 2020 2020 2020 2020 3c70 3e0a  Pi:.        <p>.
+00094680: 2020 2020 2020 2020 3c63 6f64 653e 2420          <code>$ 
+00094690: 7069 7020 696e 7374 616c 6c20 6175 746f  pip install auto
+000946a0: 7669 6d6c 202d 2d75 7067 7261 6465 202d  viml --upgrade -
+000946b0: 2d69 676e 6f72 652d 696e 7374 616c 6c65  -ignore-installe
+000946c0: 643c 2f63 6f64 653e 3c62 723e 0a20 2020  d</code><br>.   
+000946d0: 2020 2020 206f 720a 2020 2020 2020 2020       or.        
+000946e0: 0a20 2020 2020 2020 2060 6060 0a20 2020  .        ```.   
+000946f0: 2020 2020 2070 6970 2069 6e73 7461 6c6c       pip install
+00094700: 2067 6974 2b68 7474 7073 3a2f 2f67 6974   git+https://git
+00094710: 6875 622e 636f 6d2f 4175 746f 5669 4d4c  hub.com/AutoViML
+00094720: 2f41 7574 6f5f 5669 4d4c 2e67 6974 0a20  /Auto_ViML.git. 
+00094730: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
+00094740: 2020 200a 2020 2020 2020 2020 546f 2069     .        To i
+00094750: 6e73 7461 6c6c 2066 726f 6d20 736f 7572  nstall from sour
+00094760: 6365 3a0a 2020 2020 2020 2020 0a20 2020  ce:.        .   
+00094770: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
+00094780: 2063 6420 3c41 7574 6f56 494d 4c5f 4465   cd <AutoVIML_De
+00094790: 7374 696e 6174 696f 6e3e 0a20 2020 2020  stination>.     
+000947a0: 2020 2067 6974 2063 6c6f 6e65 2067 6974     git clone git
+000947b0: 4067 6974 6875 622e 636f 6d3a 4175 746f  @github.com:Auto
+000947c0: 5669 4d4c 2f41 7574 6f5f 5669 4d4c 2e67  ViML/Auto_ViML.g
+000947d0: 6974 0a20 2020 2020 2020 2023 206f 7220  it.        # or 
+000947e0: 646f 776e 6c6f 6164 2061 6e64 2075 6e7a  download and unz
+000947f0: 6970 2068 7474 7073 3a2f 2f67 6974 6875  ip https://githu
+00094800: 622e 636f 6d2f 4175 746f 5669 4d4c 2f41  b.com/AutoViML/A
+00094810: 7574 6f5f 5669 4d4c 2f61 7263 6869 7665  uto_ViML/archive
+00094820: 2f6d 6173 7465 722e 7a69 700a 2020 2020  /master.zip.    
+00094830: 2020 2020 636f 6e64 6120 6372 6561 7465      conda create
+00094840: 202d 6e20 3c79 6f75 725f 656e 765f 6e61   -n <your_env_na
+00094850: 6d65 3e20 7079 7468 6f6e 3d33 2e37 2061  me> python=3.7 a
+00094860: 6e61 636f 6e64 610a 2020 2020 2020 2020  naconda.        
+00094870: 636f 6e64 6120 6163 7469 7661 7465 203c  conda activate <
+00094880: 796f 7572 5f65 6e76 5f6e 616d 653e 2023  your_env_name> #
+00094890: 204f 4e20 5749 4e44 4f57 533a 2060 736f   ON WINDOWS: `so
+000948a0: 7572 6365 2061 6374 6976 6174 6520 3c79  urce activate <y
+000948b0: 6f75 725f 656e 765f 6e61 6d65 3e60 0a20  our_env_name>`. 
+000948c0: 2020 2020 2020 2063 6420 4175 746f 5f56         cd Auto_V
+000948d0: 694d 4c0a 2020 2020 2020 2020 7069 7020  iML.        pip 
+000948e0: 696e 7374 616c 6c20 2d72 2072 6571 7569  install -r requi
+000948f0: 7265 6d65 6e74 732e 7478 740a 2020 2020  rements.txt.    
+00094900: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+00094910: 0a20 2020 2020 2020 2023 2320 5573 6167  .        ## Usag
+00094920: 650a 2020 2020 2020 2020 0a20 2020 2020  e.        .     
+00094930: 2020 2049 6e20 7468 6520 7361 6d65 2064     In the same d
+00094940: 6972 6563 746f 7279 2c20 6f70 656e 2061  irectory, open a
+00094950: 204a 7570 7974 6572 204e 6f74 6562 6f6f   Jupyter Noteboo
+00094960: 6b20 616e 6420 7573 6520 7468 6973 206c  k and use this l
+00094970: 696e 6520 746f 2069 6d70 6f72 7420 7468  ine to import th
+00094980: 6520 2e70 7920 6669 6c65 3a0a 2020 2020  e .py file:.    
+00094990: 2020 2020 0a20 2020 2020 2020 2060 6060      .        ```
+000949a0: 0a20 2020 2020 2020 2066 726f 6d20 6175  .        from au
+000949b0: 746f 7669 6d6c 2e41 7574 6f5f 5669 4d4c  toviml.Auto_ViML
+000949c0: 2069 6d70 6f72 7420 4175 746f 5f56 694d   import Auto_ViM
+000949d0: 4c0a 2020 2020 2020 2020 6060 600a 2020  L.        ```.  
+000949e0: 2020 2020 2020 0a20 2020 2020 2020 204c        .        L
+000949f0: 6f61 6420 6120 6461 7461 2073 6574 2028  oad a data set (
+00094a00: 616e 7920 4353 5620 6f72 2074 6578 7420  any CSV or text 
+00094a10: 6669 6c65 2920 696e 746f 2061 2050 616e  file) into a Pan
+00094a20: 6461 7320 6461 7461 6672 616d 6520 616e  das dataframe an
+00094a30: 6420 7370 6c69 7420 6974 2069 6e74 6f20  d split it into 
+00094a40: 5472 6169 6e20 616e 6420 5465 7374 2064  Train and Test d
+00094a50: 6174 6166 7261 6d65 732e 2049 6620 796f  ataframes. If yo
+00094a60: 7520 646f 6e27 7420 6861 7665 2061 2074  u don't have a t
+00094a70: 6573 7420 6461 7461 6672 616d 652c 2079  est dataframe, y
+00094a80: 6f75 2063 616e 2073 696d 706c 6520 6173  ou can simple as
+00094a90: 7369 676e 2074 6865 2074 6573 7420 7661  sign the test va
+00094aa0: 7269 6162 6c65 2062 656c 6f77 2074 6f20  riable below to 
+00094ab0: 2727 2028 656d 7074 7920 7374 7269 6e67  '' (empty string
+00094ac0: 293a 0a20 2020 2020 2020 200a 2020 2020  ):.        .    
+00094ad0: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+00094ae0: 6d6f 6465 6c2c 2066 6561 7475 7265 732c  model, features,
+00094af0: 2074 7261 696e 6d2c 2074 6573 746d 203d   trainm, testm =
+00094b00: 2041 7574 6f5f 5669 4d4c 280a 2020 2020   Auto_ViML(.    
+00094b10: 2020 2020 2020 2020 7472 6169 6e2c 0a20          train,. 
+00094b20: 2020 2020 2020 2020 2020 2074 6172 6765             targe
+00094b30: 742c 0a20 2020 2020 2020 2020 2020 2074  t,.            t
+00094b40: 6573 742c 0a20 2020 2020 2020 2020 2020  est,.           
+00094b50: 2073 616d 706c 655f 7375 626d 6973 7369   sample_submissi
+00094b60: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00094b70: 6879 7065 725f 7061 7261 6d3d 2247 5322  hyper_param="GS"
+00094b80: 2c0a 2020 2020 2020 2020 2020 2020 6665  ,.            fe
+00094b90: 6174 7572 655f 7265 6475 6374 696f 6e3d  ature_reduction=
+00094ba0: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+00094bb0: 2020 7363 6f72 696e 675f 7061 7261 6d65    scoring_parame
+00094bc0: 7465 723d 2277 6569 6768 7465 642d 6631  ter="weighted-f1
+00094bd0: 222c 0a20 2020 2020 2020 2020 2020 204b  ",.            K
+00094be0: 4d65 616e 735f 4665 6174 7572 697a 6572  Means_Featurizer
+00094bf0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+00094c00: 2020 2020 426f 6f73 7469 6e67 5f46 6c61      Boosting_Fla
+00094c10: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
+00094c20: 2020 2020 2042 696e 6e69 6e67 5f46 6c61       Binning_Fla
+00094c30: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
+00094c40: 2020 2020 2041 6464 5f50 6f6c 793d 4661       Add_Poly=Fa
+00094c50: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00094c60: 2053 7461 636b 696e 675f 466c 6167 3d46   Stacking_Flag=F
+00094c70: 616c 7365 2c0a 2020 2020 2020 2020 2020  alse,.          
+00094c80: 2020 496d 6261 6c61 6e63 6564 5f46 6c61    Imbalanced_Fla
+00094c90: 673d 4661 6c73 652c 0a20 2020 2020 2020  g=False,.       
+00094ca0: 2020 2020 2076 6572 626f 7365 3d30 2c0a       verbose=0,.
+00094cb0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00094cc0: 2020 6060 600a 2020 2020 2020 2020 0a20    ```.        . 
+00094cd0: 2020 2020 2020 2046 696e 616c 6c79 2c20         Finally, 
+00094ce0: 6974 2077 7269 7465 7320 796f 7572 2073  it writes your s
+00094cf0: 7562 6d69 7373 696f 6e20 6669 6c65 2074  ubmission file t
+00094d00: 6f20 6469 736b 2069 6e20 7468 6520 6375  o disk in the cu
+00094d10: 7272 656e 7420 6469 7265 6374 6f72 7920  rrent directory 
+00094d20: 6361 6c6c 6564 2060 6d79 7375 626d 6973  called `mysubmis
+00094d30: 7369 6f6e 2e63 7376 602e 0a20 2020 2020  sion.csv`..     
+00094d40: 2020 2054 6869 7320 7375 626d 6973 7369     This submissi
+00094d50: 6f6e 2066 696c 6520 6973 2072 6561 6479  on file is ready
+00094d60: 2066 6f72 2079 6f75 2074 6f20 7368 6f77   for you to show
+00094d70: 2069 7420 636c 6965 6e74 7320 6f72 2073   it clients or s
+00094d80: 7562 6d69 7420 6974 2074 6f20 636f 6d70  ubmit it to comp
+00094d90: 6574 6974 696f 6e73 2e0a 2020 2020 2020  etitions..      
+00094da0: 2020 4966 206e 6f20 7375 626d 6973 7369    If no submissi
+00094db0: 6f6e 2066 696c 6520 7761 7320 6769 7665  on file was give
+00094dc0: 6e2c 2062 7574 2061 7320 6c6f 6e67 2061  n, but as long a
+00094dd0: 7320 796f 7520 6769 7665 2069 7420 6120  s you give it a 
+00094de0: 7465 7374 2066 696c 6520 6e61 6d65 2c20  test file name, 
+00094df0: 6974 2077 696c 6c20 6372 6561 7465 2061  it will create a
+00094e00: 2073 7562 6d69 7373 696f 6e20 6669 6c65   submission file
+00094e10: 2066 6f72 2079 6f75 206e 616d 6564 2060   for you named `
+00094e20: 6d79 5375 626d 6973 7369 6f6e 2e63 7376  mySubmission.csv
+00094e30: 602e 0a20 2020 2020 2020 2041 7574 6f5f  `..        Auto_
+00094e40: 5669 4d4c 2077 6f72 6b73 206f 6e20 616e  ViML works on an
+00094e50: 7920 4d75 6c74 692d 436c 6173 732c 204d  y Multi-Class, M
+00094e60: 756c 7469 2d4c 6162 656c 2044 6174 6120  ulti-Label Data 
+00094e70: 5365 742e 2053 6f20 796f 7520 6361 6e20  Set. So you can 
+00094e80: 6861 7665 206d 616e 7920 7461 7267 6574  have many target
+00094e90: 206c 6162 656c 732e 0a20 2020 2020 2020   labels..       
+00094ea0: 2059 6f75 2064 6f6e 2774 2068 6176 6520   You don't have 
+00094eb0: 746f 2074 656c 6c20 4175 746f 5f56 694d  to tell Auto_ViM
+00094ec0: 4c20 7768 6574 6865 7220 6974 2069 7320  L whether it is 
+00094ed0: 6120 5265 6772 6573 7369 6f6e 206f 7220  a Regression or 
+00094ee0: 436c 6173 7369 6669 6361 7469 6f6e 2070  Classification p
+00094ef0: 726f 626c 656d 2e0a 2020 2020 2020 2020  roblem..        
+00094f00: 0a20 2020 2020 2020 2023 2320 5469 7073  .        ## Tips
+00094f10: 2066 6f72 2075 7369 6e67 2041 7574 6f5f   for using Auto_
+00094f20: 5669 4d4c 3a0a 2020 2020 2020 2020 312e  ViML:.        1.
+00094f30: 2060 7363 6f72 696e 675f 7061 7261 6d65   `scoring_parame
+00094f40: 7465 7260 3a20 466f 7220 436c 6173 7369  ter`: For Classi
+00094f50: 6669 6361 7469 6f6e 2070 726f 626c 656d  fication problem
+00094f60: 7320 616e 6420 696d 6261 6c61 6e63 6564  s and imbalanced
+00094f70: 2063 6c61 7373 6573 2c20 6368 6f6f 7365   classes, choose
+00094f80: 2073 636f 7269 6e67 5f70 6172 616d 6574   scoring_paramet
+00094f90: 6572 3d22 6261 6c61 6e63 6564 5f61 6363  er="balanced_acc
+00094fa0: 7572 6163 7922 2e20 4974 2077 6f72 6b73  uracy". It works
+00094fb0: 2062 6574 7465 722e 0a20 2020 2020 2020   better..       
+00094fc0: 2032 2e20 6049 6d62 616c 616e 6365 645f   2. `Imbalanced_
+00094fd0: 466c 6167 603a 2046 6f72 2049 6d62 616c  Flag`: For Imbal
+00094fe0: 616e 6365 6420 436c 6173 7365 7320 283c  anced Classes (<
+00094ff0: 3525 2073 616d 706c 6573 2069 6e20 7261  5% samples in ra
+00095000: 7265 2063 6c61 7373 292c 2063 686f 6f73  re class), choos
+00095010: 6520 2249 6d62 616c 616e 6365 645f 466c  e "Imbalanced_Fl
+00095020: 6167 223d 5472 7565 2e20 596f 7520 6361  ag"=True. You ca
+00095030: 6e20 616c 736f 2073 6574 2074 6869 7320  n also set this 
+00095040: 666c 6167 2074 6f20 5472 7565 2066 6f72  flag to True for
+00095050: 2052 6567 7265 7373 696f 6e20 7072 6f62   Regression prob
+00095060: 6c65 6d73 2077 6865 7265 2074 6865 2074  lems where the t
+00095070: 6172 6765 7420 7661 7269 6162 6c65 206d  arget variable m
+00095080: 6967 6874 2068 6176 6520 736b 6577 6564  ight have skewed
+00095090: 2064 6973 7472 6962 7574 696f 6e73 2e0a   distributions..
+000950a0: 2020 2020 2020 2020 332e 2060 7461 7267          3. `targ
+000950b0: 6574 603a 2046 6f72 204d 756c 7469 2d4c  et`: For Multi-L
+000950c0: 6162 656c 2064 6174 6173 6574 2c20 7468  abel dataset, th
+000950d0: 6520 7461 7267 6574 2069 6e70 7574 2074  e target input t
+000950e0: 6172 6765 7420 7661 7269 6162 6c65 2063  arget variable c
+000950f0: 616e 2062 6520 7365 6e74 2069 6e20 6173  an be sent in as
+00095100: 2061 206c 6973 7420 6f66 2076 6172 6961   a list of varia
+00095110: 626c 6573 2e0a 2020 2020 2020 2020 342e  bles..        4.
+00095120: 2060 426f 6f73 7469 6e67 5f46 6c61 6760   `Boosting_Flag`
+00095130: 3a20 4974 2069 7320 7265 636f 6d6d 656e  : It is recommen
+00095140: 6465 6420 7468 6174 2079 6f75 2066 6972  ded that you fir
+00095150: 7374 2073 6574 2042 6f6f 7374 696e 675f  st set Boosting_
+00095160: 466c 6167 3d4e 6f6e 6520 746f 2067 6574  Flag=None to get
+00095170: 2061 204c 696e 6561 7220 6d6f 6465 6c2e   a Linear model.
+00095180: 204f 6e63 6520 796f 7520 756e 6465 7273   Once you unders
+00095190: 7461 6e64 2074 6861 742c 2074 6865 6e20  tand that, then 
+000951a0: 796f 7520 6361 6e20 7472 7920 746f 2073  you can try to s
+000951b0: 6574 2042 6f6f 7374 696e 675f 466c 6167  et Boosting_Flag
+000951c0: 3d46 616c 7365 2074 6f20 6765 7420 6120  =False to get a 
+000951d0: 5261 6e64 6f6d 2046 6f72 6573 7420 6d6f  Random Forest mo
+000951e0: 6465 6c2e 2046 696e 616c 6c79 2c20 7472  del. Finally, tr
+000951f0: 7920 426f 6f73 7469 6e67 5f46 6c61 673d  y Boosting_Flag=
+00095200: 5472 7565 2074 6f20 6765 7420 616e 2058  True to get an X
+00095210: 4742 6f6f 7374 206d 6f64 656c 2e20 5468  GBoost model. Th
+00095220: 6973 2069 7320 7468 6520 6f72 6465 7220  is is the order 
+00095230: 7468 6174 2077 6520 7265 636f 6d6d 656e  that we recommen
+00095240: 6420 696e 206f 7264 6572 2074 6f20 7573  d in order to us
+00095250: 6520 4175 746f 5f56 694d 4c2e 2046 696e  e Auto_ViML. Fin
+00095260: 616c 6c79 2074 7279 2042 6f6f 7374 696e  ally try Boostin
+00095270: 675f 466c 6167 3d22 4361 7442 6f6f 7374  g_Flag="CatBoost
+00095280: 2220 746f 2067 6574 2061 2063 6f6d 706c  " to get a compl
+00095290: 6578 2062 7574 2068 6967 6820 7065 7266  ex but high perf
+000952a0: 6f72 6d69 6e67 206d 6f64 656c 2e0a 2020  orming model..  
+000952b0: 2020 2020 2020 352e 2060 4269 6e6e 696e        5. `Binnin
+000952c0: 675f 466c 6167 603a 2042 696e 6e69 6e67  g_Flag`: Binning
+000952d0: 5f46 6c61 673d 5472 7565 2069 6d70 726f  _Flag=True impro
+000952e0: 7665 7320 6120 4361 7442 6f6f 7374 206d  ves a CatBoost m
+000952f0: 6f64 656c 2073 696e 6365 2069 7420 6164  odel since it ad
+00095300: 6473 2074 6f20 7468 6520 6c69 7374 206f  ds to the list o
+00095310: 6620 6361 7465 676f 7269 6361 6c20 7661  f categorical va
+00095320: 7273 2069 6e20 6461 7461 0a20 2020 2020  rs in data.     
+00095330: 2020 2036 2e20 604b 4d65 616e 735f 6665     6. `KMeans_fe
+00095340: 6174 7572 697a 6572 603a 204b 4d65 616e  aturizer`: KMean
+00095350: 735f 6665 6174 7572 697a 6572 3d54 7275  s_featurizer=Tru
+00095360: 6520 776f 726b 7320 7765 6c6c 2069 6e20  e works well in 
+00095370: 4e4c 5020 616e 6420 4361 7442 6f6f 7374  NLP and CatBoost
+00095380: 206d 6f64 656c 7320 7369 6e63 6520 6974   models since it
+00095390: 2063 7265 6174 6573 2063 6c75 7374 6572   creates cluster
+000953a0: 2076 6172 6961 626c 6573 0a20 2020 2020   variables.     
+000953b0: 2020 2037 2e20 6041 6464 5f50 6f6c 7960     7. `Add_Poly`
+000953c0: 3a20 4164 645f 506f 6c79 3d33 2069 6d70  : Add_Poly=3 imp
+000953d0: 726f 7665 7320 6365 7274 6169 6e20 6d6f  roves certain mo
+000953e0: 6465 6c73 2077 6865 7265 2074 6865 7265  dels where there
+000953f0: 2069 7320 6461 7465 2d74 696d 6520 6f72   is date-time or
+00095400: 2063 6174 6567 6f72 6963 616c 2061 6e64   categorical and
+00095410: 206e 756d 6572 6963 2076 6172 6961 626c   numeric variabl
+00095420: 6573 0a20 2020 2020 2020 2038 2e20 6066  es.        8. `f
+00095430: 6561 7475 7265 5f72 6564 7563 7469 6f6e  eature_reduction
+00095440: 603a 2066 6561 7475 7265 5f72 6564 7563  `: feature_reduc
+00095450: 7469 6f6e 3d54 7275 6520 6973 2074 6865  tion=True is the
+00095460: 2064 6566 6175 6c74 2061 6e64 2077 6f72   default and wor
+00095470: 6b73 2062 6573 742e 2042 7574 2077 6865  ks best. But whe
+00095480: 6e20 796f 7520 6861 7665 203c 3130 2066  n you have <10 f
+00095490: 6561 7475 7265 7320 696e 2064 6174 612c  eatures in data,
+000954a0: 2073 6574 2069 7420 746f 2046 616c 7365   set it to False
+000954b0: 0a20 2020 2020 2020 2039 2e20 6053 7461  .        9. `Sta
+000954c0: 636b 696e 675f 466c 6167 603a 2044 6f20  cking_Flag`: Do 
+000954d0: 6e6f 7420 7365 7420 5374 6163 6b69 6e67  not set Stacking
+000954e0: 5f46 6c61 673d 5472 7565 2077 6974 6820  _Flag=True with 
+000954f0: 4c69 6e65 6172 206d 6f64 656c 7320 7369  Linear models si
+00095500: 6e63 6520 796f 7572 2072 6573 756c 7473  nce your results
+00095510: 206d 6179 206e 6f74 206c 6f6f 6b20 6772   may not look gr
+00095520: 6561 742e 0a20 2020 2020 2020 2031 302e  eat..        10.
+00095530: 2060 5374 6163 6b69 6e67 5f46 6c61 6760   `Stacking_Flag`
+00095540: 3a20 5573 6520 5374 6163 6b69 6e67 5f46  : Use Stacking_F
+00095550: 6c61 673d 5472 7565 206f 6e6c 7920 666f  lag=True only fo
+00095560: 7220 636f 6d70 6c65 7820 6d6f 6465 6c73  r complex models
+00095570: 2061 6e64 2061 7320 6120 6c61 7374 2073   and as a last s
+00095580: 7465 7020 7769 7468 2042 6f6f 7374 696e  tep with Boostin
+00095590: 675f 466c 6167 3d54 7275 6520 6f72 2043  g_Flag=True or C
+000955a0: 6174 426f 6f73 740a 2020 2020 2020 2020  atBoost.        
+000955b0: 3131 2e20 6068 7970 6572 5f70 6172 616d  11. `hyper_param
+000955c0: 603a 204c 6561 7665 2068 7970 6572 5f70  `: Leave hyper_p
+000955d0: 6172 616d 203d 2252 5322 2061 7320 696e  aram ="RS" as in
+000955e0: 7075 7420 7369 6e63 6520 6974 2072 756e  put since it run
+000955f0: 7320 6661 7374 6572 2074 6861 6e20 4772  s faster than Gr
+00095600: 6964 5365 6172 6368 4356 2061 6e64 2067  idSearchCV and g
+00095610: 6976 6573 2062 6574 7465 7220 7265 7375  ives better resu
+00095620: 6c74 7320 756e 6c65 7373 2079 6f75 2068  lts unless you h
+00095630: 6176 6520 6120 736d 616c 6c20 6461 7461  ave a small data
+00095640: 2073 6574 2061 6e64 2063 616e 2061 6666   set and can aff
+00095650: 6f72 6420 746f 2073 7065 6e64 2074 696d  ord to spend tim
+00095660: 6520 6f6e 2068 7970 6572 2074 756e 696e  e on hyper tunin
+00095670: 672e 0a20 2020 2020 2020 2031 322e 2060  g..        12. `
+00095680: 4b4d 6561 6e73 5f46 6561 7475 7269 7a65  KMeans_Featurize
+00095690: 7260 3a20 4b4d 6561 6e73 5f46 6561 7475  r`: KMeans_Featu
+000956a0: 7269 7a65 723d 5472 7565 2064 6f65 7320  rizer=True does 
+000956b0: 6e6f 7420 776f 726b 2077 656c 6c20 666f  not work well fo
+000956c0: 7220 736d 616c 6c20 6461 7461 2073 6574  r small data set
+000956d0: 732e 2055 7365 2069 7420 666f 7220 6461  s. Use it for da
+000956e0: 7461 2073 6574 7320 3e20 3130 2c30 3030  ta sets > 10,000
+000956f0: 2072 6f77 732e 0a20 2020 2020 2020 2031   rows..        1
+00095700: 332e 2060 4669 6e61 6c20 7468 6f75 6768  3. `Final though
+00095710: 7473 603a 2046 696e 616c 6c79 2041 7574  ts`: Finally Aut
+00095720: 6f5f 5669 4d4c 2069 7320 6d65 616e 7420  o_ViML is meant 
+00095730: 746f 2062 6520 6120 6261 7365 6c69 6e65  to be a baseline
+00095740: 206f 7220 6368 616c 6c65 6e67 6572 2073   or challenger s
+00095750: 6f6c 7574 696f 6e20 746f 2079 6f75 7220  olution to your 
+00095760: 6461 7461 2073 6574 2e20 536f 2075 7365  data set. So use
+00095770: 2069 7420 666f 7220 6d61 6b69 6e67 2071   it for making q
+00095780: 7569 636b 206d 6f64 656c 7320 7468 6174  uick models that
+00095790: 2079 6f75 2063 616e 2063 6f6d 7061 7265   you can compare
+000957a0: 2061 6761 696e 7374 206f 7220 696e 2048   against or in H
+000957b0: 6163 6b61 7468 6f6e 732e 2049 7420 6973  ackathons. It is
+000957c0: 206e 6f74 206d 6561 6e74 2066 6f72 2070   not meant for p
+000957d0: 726f 6475 6374 696f 6e21 0a20 2020 2020  roduction!.     
+000957e0: 2020 200a 2020 2020 2020 2020 2323 2041     .        ## A
+000957f0: 5049 0a20 2020 2020 2020 200a 2020 2020  PI.        .    
+00095800: 2020 2020 2a2a 4172 6775 6d65 6e74 732a      **Arguments*
+00095810: 2a0a 2020 2020 2020 2020 0a20 2020 2020  *.        .     
+00095820: 2020 202d 2060 7472 6169 6e60 3a20 636f     - `train`: co
+00095830: 756c 6420 6265 2061 2064 6174 6170 6174  uld be a datapat
+00095840: 682b 6669 6c65 6e61 6d65 206f 7220 6120  h+filename or a 
+00095850: 6461 7461 6672 616d 652e 2049 7420 7769  dataframe. It wi
+00095860: 6c6c 2064 6574 6563 7420 7768 6963 6820  ll detect which 
+00095870: 6973 2077 6869 6368 2061 6e64 206c 6f61  is which and loa
+00095880: 6420 6974 2e0a 2020 2020 2020 2020 2d20  d it..        - 
+00095890: 6074 6573 7460 3a20 636f 756c 6420 6265  `test`: could be
+000958a0: 2061 2064 6174 6170 6174 682b 6669 6c65   a datapath+file
+000958b0: 6e61 6d65 206f 7220 6120 6461 7461 6672  name or a datafr
+000958c0: 616d 652e 2049 6620 796f 7520 646f 6e27  ame. If you don'
+000958d0: 7420 6861 7665 2061 6e79 2c20 6a75 7374  t have any, just
+000958e0: 206c 6561 7665 2069 7420 6173 2022 222e   leave it as "".
+000958f0: 0a20 2020 2020 2020 202d 2060 7375 626d  .        - `subm
+00095900: 6973 7369 6f6e 603a 206d 7573 7420 6265  ission`: must be
+00095910: 2061 2064 6174 6170 6174 682b 6669 6c65   a datapath+file
+00095920: 6e61 6d65 2e20 4966 2079 6f75 2064 6f6e  name. If you don
+00095930: 2774 2068 6176 6520 616e 792c 206a 7573  't have any, jus
+00095940: 7420 6c65 6176 6520 6974 2061 7320 656d  t leave it as em
+00095950: 7074 7920 7374 7269 6e67 2e0a 2020 2020  pty string..    
+00095960: 2020 2020 2d20 6074 6172 6765 7460 3a20      - `target`: 
+00095970: 6e61 6d65 206f 6620 7468 6520 7461 7267  name of the targ
+00095980: 6574 2076 6172 6961 626c 6520 696e 2074  et variable in t
+00095990: 6865 2064 6174 6120 7365 742e 0a20 2020  he data set..   
+000959a0: 2020 2020 202d 2060 7365 7060 3a20 6966       - `sep`: if
+000959b0: 2079 6f75 2068 6176 6520 6120 7370 6561   you have a spea
+000959c0: 7261 746f 7220 696e 2074 6865 2066 696c  rator in the fil
+000959d0: 6520 7375 6368 2061 7320 222c 2220 6f72  e such as "," or
+000959e0: 2022 5c74 2220 6d65 6e74 696f 6e20 6974   "\t" mention it
+000959f0: 2068 6572 652e 2044 6566 6175 6c74 2069   here. Default i
+00095a00: 7320 222c 222e 0a20 2020 2020 2020 202d  s ","..        -
+00095a10: 2060 7363 6f72 696e 675f 7061 7261 6d65   `scoring_parame
+00095a20: 7465 7260 3a20 6966 2079 6f75 2077 616e  ter`: if you wan
+00095a30: 7420 796f 7572 206f 776e 2073 636f 7269  t your own scori
+00095a40: 6e67 2070 6172 616d 6574 6572 2073 7563  ng parameter suc
+00095a50: 6820 6173 2022 6631 2220 6769 7665 2069  h as "f1" give i
+00095a60: 7420 6865 7265 2e20 4966 206e 6f74 2c20  t here. If not, 
+00095a70: 6974 2077 696c 6c20 6173 7375 6d65 2074  it will assume t
+00095a80: 6865 2061 7070 726f 7072 6961 7465 2073  he appropriate s
+00095a90: 636f 7269 6e67 2070 6172 616d 2066 6f72  coring param for
+00095aa0: 2074 6865 2070 726f 626c 656d 2061 6e64   the problem and
+00095ab0: 2069 7420 7769 6c6c 2062 7569 6c64 2074   it will build t
+00095ac0: 6865 206d 6f64 656c 2e0a 2020 2020 2020  he model..      
+00095ad0: 2020 2d20 6068 7970 6572 5f70 6172 616d    - `hyper_param
+00095ae0: 603a 2054 756e 696e 6720 6f70 7469 6f6e  `: Tuning option
+00095af0: 7320 6172 6520 4772 6964 5365 6172 6368  s are GridSearch
+00095b00: 2028 2747 5327 2920 616e 6420 5261 6e64   ('GS') and Rand
+00095b10: 6f6d 697a 6564 5365 6172 6368 2028 2752  omizedSearch ('R
+00095b20: 5327 292e 2044 6566 6175 6c74 2069 7320  S'). Default is 
+00095b30: 2752 5327 2e0a 2020 2020 2020 2020 2d20  'RS'..        - 
+00095b40: 6066 6561 7475 7265 5f72 6564 7563 7469  `feature_reducti
+00095b50: 6f6e 603a 2044 6566 6175 6c74 203d 2027  on`: Default = '
+00095b60: 5472 7565 2720 6275 7420 6974 2063 616e  True' but it can
+00095b70: 2062 6520 7365 7420 746f 2046 616c 7365   be set to False
+00095b80: 2069 6620 796f 7520 646f 6e27 7420 7761   if you don't wa
+00095b90: 6e74 2061 7574 6f6d 6174 6963 2066 6561  nt automatic fea
+00095ba0: 7475 7265 5f72 6564 7563 7469 6f6e 2073  ture_reduction s
+00095bb0: 696e 6365 2069 6e20 496d 6167 6520 6461  ince in Image da
+00095bc0: 7461 2073 6574 7320 6c69 6b65 2064 6967  ta sets like dig
+00095bd0: 6974 7320 616e 6420 4d4e 4953 542c 2079  its and MNIST, y
+00095be0: 6f75 2067 6574 2062 6574 7465 7220 7265  ou get better re
+00095bf0: 7375 6c74 7320 7768 656e 2079 6f75 2064  sults when you d
+00095c00: 6f6e 2774 2072 6564 7563 6520 6665 6174  on't reduce feat
+00095c10: 7572 6573 2061 7574 6f6d 6174 6963 616c  ures automatical
+00095c20: 6c79 2e20 596f 7520 6361 6e20 616c 7761  ly. You can alwa
+00095c30: 7973 2074 7279 2062 6f74 6820 616e 6420  ys try both and 
+00095c40: 7365 652e 0a20 2020 2020 2020 202d 2060  see..        - `
+00095c50: 4b4d 6561 6e73 5f46 6561 7475 7269 7a65  KMeans_Featurize
+00095c60: 7260 0a20 2020 2020 2020 2020 202d 2060  r`.          - `
+00095c70: 5472 7565 603a 2041 6464 7320 6120 636c  True`: Adds a cl
+00095c80: 7573 7465 7220 6c61 6265 6c20 746f 2066  uster label to f
+00095c90: 6561 7475 7265 7320 6261 7365 6420 6f6e  eatures based on
+00095ca0: 204b 4d65 616e 732e 2055 7365 2066 6f72   KMeans. Use for
+00095cb0: 204c 696e 6561 722e 0a20 2020 2020 2020   Linear..       
+00095cc0: 2020 202d 2060 4661 6c73 6520 2864 6566     - `False (def
+00095cd0: 6175 6c74 2960 2046 6f72 2052 616e 646f  ault)` For Rando
+00095ce0: 6d20 466f 7265 7374 7320 6f72 2058 4742  m Forests or XGB
+00095cf0: 206d 6f64 656c 732c 206c 6561 7665 2069   models, leave i
+00095d00: 7420 4661 6c73 6520 7369 6e63 6520 6974  t False since it
+00095d10: 206d 6179 206f 7665 7266 6974 2e0a 2020   may overfit..  
+00095d20: 2020 2020 2020 2d20 6042 6f6f 7374 696e        - `Boostin
+00095d30: 6720 466c 6167 603a 2079 6f75 2068 6176  g Flag`: you hav
+00095d40: 6520 3420 706f 7373 6962 6c65 2063 686f  e 4 possible cho
+00095d50: 6963 6573 2028 6465 6661 756c 7420 6973  ices (default is
+00095d60: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
+00095d70: 2020 202d 2060 4e6f 6e65 6020 5468 6973     - `None` This
+00095d80: 2077 696c 6c20 6275 696c 6420 6120 4c69   will build a Li
+00095d90: 6e65 6172 204d 6f64 656c 0a20 2020 2020  near Model.     
+00095da0: 2020 2020 202d 2060 4661 6c73 6560 2054       - `False` T
+00095db0: 6869 7320 7769 6c6c 2062 7569 6c64 2061  his will build a
+00095dc0: 2052 616e 646f 6d20 466f 7265 7374 206f   Random Forest o
+00095dd0: 7220 4578 7472 6120 5472 6565 7320 6d6f  r Extra Trees mo
+00095de0: 6465 6c20 2861 6c73 6f20 6b6e 6f77 6e20  del (also known 
+00095df0: 6173 2042 6167 6769 6e67 290a 2020 2020  as Bagging).    
+00095e00: 2020 2020 2020 2d20 6054 7275 6560 2054        - `True` T
+00095e10: 6869 7320 7769 6c6c 2062 7569 6c64 2061  his will build a
+00095e20: 6e20 5847 426f 6f73 7420 6d6f 6465 6c0a  n XGBoost model.
+00095e30: 2020 2020 2020 2020 2020 2d20 6043 6174            - `Cat
+00095e40: 426f 6f73 7460 2054 6869 7320 7769 6c6c  Boost` This will
+00095e50: 2062 7569 6c64 2061 2043 6174 426f 6f73   build a CatBoos
+00095e60: 7420 6d6f 6465 6c20 2870 726f 7669 6465  t model (provide
+00095e70: 6420 796f 7520 6861 7665 2043 6174 426f  d you have CatBo
+00095e80: 6f73 7420 696e 7374 616c 6c65 6429 0a20  ost installed). 
+00095e90: 2020 2020 2020 202d 2060 4164 645f 506f         - `Add_Po
+00095ea0: 6c79 603a 2044 6566 6175 6c74 2069 7320  ly`: Default is 
+00095eb0: 3020 7768 6963 6820 6d65 616e 7320 646f  0 which means do
+00095ec0: 2d6e 6f74 6869 6e67 2e20 4275 7420 6974  -nothing. But it
+00095ed0: 2068 6173 2074 6872 6565 2069 6e74 6572   has three inter
+00095ee0: 6573 7469 6e67 2073 6574 7469 6e67 733a  esting settings:
+00095ef0: 0a20 2020 2020 2020 2020 202d 2060 3160  .          - `1`
+00095f00: 2041 6464 2069 6e74 6572 6163 7469 6f6e   Add interaction
+00095f10: 2076 6172 6961 626c 6573 206f 6e6c 7920   variables only 
+00095f20: 7375 6368 2061 7320 7831 2a78 322c 2078  such as x1*x2, x
+00095f30: 322a 7833 2c2e 2e2e 7839 5c2a 3130 2065  2*x3,...x9\*10 e
+00095f40: 7463 2e0a 2020 2020 2020 2020 2020 2d20  tc..          - 
+00095f50: 6032 6020 4164 6420 496e 7465 7261 6374  `2` Add Interact
+00095f60: 696f 6e73 2061 6e64 2053 7175 6172 6564  ions and Squared
+00095f70: 2076 6172 6961 626c 6573 2073 7563 6820   variables such 
+00095f80: 6173 2078 312a 2a32 2c20 7832 2a2a 322c  as x1**2, x2**2,
+00095f90: 2065 7463 2e0a 2020 2020 2020 2020 2020   etc..          
+00095fa0: 2d20 6033 6020 4164 6473 2062 6f74 6820  - `3` Adds both 
+00095fb0: 496e 7465 7261 6374 696f 6e73 2061 6e64  Interactions and
+00095fc0: 2053 7175 6172 6564 2076 6172 6961 626c   Squared variabl
+00095fd0: 6573 2073 7563 6820 6173 2078 312a 7832  es such as x1*x2
+00095fe0: 2c20 7831 2a2a 322c 7832 2a78 332c 2078  , x1**2,x2*x3, x
+00095ff0: 322a 2a32 2c20 6574 632e 0a20 2020 2020  2**2, etc..     
+00096000: 2020 202d 2060 5374 6163 6b69 6e67 5f46     - `Stacking_F
+00096010: 6c61 6760 3a20 4465 6661 756c 7420 6973  lag`: Default is
+00096020: 2046 616c 7365 2e20 4966 2073 6574 2074   False. If set t
+00096030: 6f20 5472 7565 2c20 6974 2077 696c 6c20  o True, it will 
+00096040: 6164 6420 616e 2061 6464 6974 696f 6e61  add an additiona
+00096050: 6c20 6665 6174 7572 6520 7768 6963 6820  l feature which 
+00096060: 6973 2064 6572 6976 6564 2066 726f 6d20  is derived from 
+00096070: 7072 6564 6963 7469 6f6e 7320 6f66 2061  predictions of a
+00096080: 6e6f 7468 6572 206d 6f64 656c 2e20 5468  nother model. Th
+00096090: 6973 2069 7320 7573 6564 2069 6e20 736f  is is used in so
+000960a0: 6d65 2063 6173 6573 2062 7574 206d 6179  me cases but may
+000960b0: 2072 6573 756c 7420 696e 206f 7665 7266   result in overf
+000960c0: 6974 7469 6e67 2e20 536f 2062 6520 6361  itting. So be ca
+000960d0: 7265 6675 6c20 7475 726e 696e 6720 7468  reful turning th
+000960e0: 6973 2066 6c61 6720 226f 6e22 2e0a 2020  is flag "on"..  
+000960f0: 2020 2020 2020 2d20 6042 696e 6e69 6e67        - `Binning
+00096100: 5f46 6c61 6760 3a20 4465 6661 756c 7420  _Flag`: Default 
+00096110: 6973 2046 616c 7365 2e20 4974 2073 6574  is False. It set
+00096120: 2074 6f20 5472 7565 2c20 6974 2077 696c   to True, it wil
+00096130: 6c20 636f 6e76 6572 7420 7468 6520 746f  l convert the to
+00096140: 7020 6e75 6d65 7269 6320 7661 7269 6162  p numeric variab
+00096150: 6c65 7320 696e 746f 2062 696e 6e65 6420  les into binned 
+00096160: 7661 7269 6162 6c65 7320 7468 726f 7567  variables throug
+00096170: 6820 6120 7465 6368 6e69 7175 6520 6b6e  h a technique kn
+00096180: 6f77 6e20 6173 2022 456e 7472 6f70 7922  own as "Entropy"
+00096190: 2062 696e 6e69 6e67 2e20 5468 6973 2069   binning. This i
+000961a0: 7320 7665 7279 2068 656c 7066 756c 2066  s very helpful f
+000961b0: 6f72 2063 6572 7461 696e 2064 6174 6173  or certain datas
+000961c0: 6574 7320 2865 7370 6563 6961 6c6c 7920  ets (especially 
+000961d0: 6861 7264 2074 6f20 6275 696c 6420 6d6f  hard to build mo
+000961e0: 6465 6c73 292e 0a20 2020 2020 2020 202d  dels)..        -
+000961f0: 2060 496d 6261 6c61 6e63 6564 5f46 6c61   `Imbalanced_Fla
+00096200: 6760 3a20 4465 6661 756c 7420 6973 2046  g`: Default is F
+00096210: 616c 7365 2e20 5573 6573 2069 6d62 616c  alse. Uses imbal
+00096220: 616e 6365 645f 656e 7365 6d62 6c65 206c  anced_ensemble l
+00096230: 6962 7261 7279 2066 6f72 2069 6d62 616c  ibrary for imbal
+00096240: 616e 6365 6420 6461 7461 2e20 4a75 7374  anced data. Just
+00096250: 2073 6574 2049 6d62 616c 616e 6365 645f   set Imbalanced_
+00096260: 466c 6167 203d 2054 7275 6520 696e 2061  Flag = True in a
+00096270: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
+00096280: 202d 2060 7665 7262 6f73 6560 3a20 5468   - `verbose`: Th
+00096290: 6973 2068 6173 2033 2070 6f73 7369 626c  is has 3 possibl
+000962a0: 6520 7374 6174 6573 3a0a 2020 2020 2020  e states:.      
+000962b0: 2020 2020 2d20 6030 6020 6c69 6d69 7465      - `0` limite
+000962c0: 6420 6f75 7470 7574 2e20 4772 6561 7420  d output. Great 
+000962d0: 666f 7220 7275 6e6e 696e 6720 7468 6973  for running this
+000962e0: 2073 696c 656e 746c 7920 616e 6420 6765   silently and ge
+000962f0: 7474 696e 6720 6661 7374 2072 6573 756c  tting fast resul
+00096300: 7473 2e0a 2020 2020 2020 2020 2020 2d20  ts..          - 
+00096310: 6031 6020 6d6f 7265 2063 6861 7274 732e  `1` more charts.
+00096320: 2047 7265 6174 2066 6f72 206b 6e6f 7769   Great for knowi
+00096330: 6e67 2068 6f77 2072 6573 756c 7473 2077  ng how results w
+00096340: 6572 6520 616e 6420 6d61 6b69 6e67 2063  ere and making c
+00096350: 6861 6e67 6573 2074 6f20 666c 6167 7320  hanges to flags 
+00096360: 696e 2069 6e70 7574 2e0a 2020 2020 2020  in input..      
+00096370: 2020 2020 2d20 6032 6020 6c6f 7473 206f      - `2` lots o
+00096380: 6620 6368 6172 7473 2061 6e64 206f 7574  f charts and out
+00096390: 7075 742e 2047 7265 6174 2066 6f72 2072  put. Great for r
+000963a0: 6570 726f 6475 6369 6e67 2077 6861 7420  eproducing what 
+000963b0: 4175 746f 5f56 694d 4c20 646f 6573 206f  Auto_ViML does o
+000963c0: 6e20 796f 7572 206f 776e 2e0a 2020 2020  n your own..    
+000963d0: 2020 2020 0a20 2020 2020 2020 202a 2a52      .        **R
+000963e0: 6574 7572 6e20 7661 6c75 6573 2a2a 0a20  eturn values**. 
+000963f0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00096400: 2d20 606d 6f64 656c 603a 2049 7420 7769  - `model`: It wi
+00096410: 6c6c 2072 6574 7572 6e20 796f 7572 2074  ll return your t
+00096420: 7261 696e 6564 206d 6f64 656c 0a20 2020  rained model.   
+00096430: 2020 2020 202d 2060 6665 6174 7572 6573       - `features
+00096440: 603a 2074 6865 2066 6577 6573 7420 6e75  `: the fewest nu
+00096450: 6d62 6572 206f 6620 6665 6174 7572 6573  mber of features
+00096460: 2069 6e20 796f 7572 206d 6f64 656c 2074   in your model t
+00096470: 6f20 6d61 6b65 2069 7420 7065 7266 6f72  o make it perfor
+00096480: 6d20 7765 6c6c 0a20 2020 2020 2020 202d  m well.        -
+00096490: 2060 7472 6169 6e5f 6d6f 6469 6669 6564   `train_modified
+000964a0: 603a 2074 6869 7320 6973 2074 6865 206d  `: this is the m
+000964b0: 6f64 6966 6965 6420 7472 6169 6e20 6461  odified train da
+000964c0: 7461 6672 616d 6520 6166 7465 7220 7265  taframe after re
+000964d0: 6d6f 7669 6e67 2061 6e64 2061 6464 696e  moving and addin
+000964e0: 6720 6665 6174 7572 6573 0a20 2020 2020  g features.     
+000964f0: 2020 202d 2060 7465 7374 5f6d 6f64 6966     - `test_modif
+00096500: 6965 6460 3a20 7468 6973 2069 7320 7468  ied`: this is th
+00096510: 6520 6d6f 6469 6669 6564 2074 6573 7420  e modified test 
+00096520: 6461 7461 6672 616d 6520 7769 7468 2074  dataframe with t
+00096530: 6865 2073 616d 6520 7472 616e 7366 6f72  he same transfor
+00096540: 6d61 7469 6f6e 7320 6173 2074 7261 696e  mations as train
+00096550: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00096560: 2020 2323 204d 6169 6e74 6169 6e65 7273    ## Maintainers
+00096570: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00096580: 2020 2a20 5b40 4175 746f 5669 4d4c 5d28    * [@AutoViML](
+00096590: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+000965a0: 6f6d 2f41 7574 6f56 694d 4c29 0a20 2020  om/AutoViML).   
+000965b0: 2020 2020 202a 205b 406d 6f72 656e 6f68       * [@morenoh
+000965c0: 3134 395d 2868 7474 7073 3a2f 2f67 6974  149](https://git
+000965d0: 6875 622e 636f 6d2f 6d6f 7265 6e6f 6831  hub.com/morenoh1
+000965e0: 3439 290a 2020 2020 2020 2020 2a20 5b40  49).        * [@
+000965f0: 6869 726f 6e72 6f79 5d28 6874 7470 733a  hironroy](https:
+00096600: 2f2f 6769 7468 7562 2e63 6f6d 2f68 6972  //github.com/hir
+00096610: 6f6e 726f 7929 0a20 2020 2020 2020 200a  onroy).        .
+00096620: 2020 2020 2020 2020 2323 2043 6f6e 7472          ## Contr
+00096630: 6962 7574 696e 670a 2020 2020 2020 2020  ibuting.        
+00096640: 0a20 2020 2020 2020 2053 6565 205b 7468  .        See [th
+00096650: 6520 636f 6e74 7269 6275 7469 6e67 2066  e contributing f
+00096660: 696c 655d 2843 4f4e 5452 4942 5554 494e  ile](CONTRIBUTIN
+00096670: 472e 6d64 2921 0a20 2020 2020 2020 200a  G.md)!.        .
+00096680: 2020 2020 2020 2020 5052 7320 6163 6365          PRs acce
+00096690: 7074 6564 2e0a 2020 2020 2020 2020 0a20  pted..        . 
+000966a0: 2020 2020 2020 2023 2320 4c69 6365 6e73         ## Licens
+000966b0: 650a 2020 2020 2020 2020 0a20 2020 2020  e.        .     
+000966c0: 2020 2041 7061 6368 6520 4c69 6365 6e73     Apache Licens
+000966d0: 6520 322e 3020 c2a9 2032 3032 3020 5261  e 2.0 .. 2020 Ra
+000966e0: 6d20 5365 7368 6164 7269 0a20 2020 2020  m Seshadri.     
+000966f0: 2020 200a 2020 2020 2020 2020 2323 2044     .        ## D
+00096700: 4953 434c 4149 4d45 520a 2020 2020 2020  ISCLAIMER.      
+00096710: 2020 5468 6973 2070 726f 6a65 6374 2069    This project i
+00096720: 7320 6e6f 7420 616e 206f 6666 6963 6961  s not an officia
+00096730: 6c20 476f 6f67 6c65 2070 726f 6a65 6374  l Google project
+00096740: 2e20 4974 2069 7320 6e6f 7420 7375 7070  . It is not supp
+00096750: 6f72 7465 6420 6279 2047 6f6f 676c 6520  orted by Google 
+00096760: 616e 6420 476f 6f67 6c65 2073 7065 6369  and Google speci
+00096770: 6669 6361 6c6c 7920 6469 7363 6c61 696d  fically disclaim
+00096780: 7320 616c 6c20 7761 7272 616e 7469 6573  s all warranties
+00096790: 2061 7320 746f 2069 7473 2071 7561 6c69   as to its quali
+000967a0: 7479 2c20 6d65 7263 6861 6e74 6162 696c  ty, merchantabil
+000967b0: 6974 792c 206f 7220 6669 746e 6573 7320  ity, or fitness 
+000967c0: 666f 7220 6120 7061 7274 6963 756c 6172  for a particular
+000967d0: 2070 7572 706f 7365 2e0a 2020 2020 2020   purpose..      
+000967e0: 2020 0a50 6c61 7466 6f72 6d3a 2055 4e4b    .Platform: UNK
+000967f0: 4e4f 574e 0a43 6c61 7373 6966 6965 723a  NOWN.Classifier:
+00096800: 2050 726f 6772 616d 6d69 6e67 204c 616e   Programming Lan
+00096810: 6775 6167 6520 3a3a 2050 7974 686f 6e20  guage :: Python 
+00096820: 3a3a 2033 0a43 6c61 7373 6966 6965 723a  :: 3.Classifier:
+00096830: 204f 7065 7261 7469 6e67 2053 7973 7465   Operating Syste
+00096840: 6d20 3a3a 204f 5320 496e 6465 7065 6e64  m :: OS Independ
+00096850: 656e 740a 4465 7363 7269 7074 696f 6e2d  ent.Description-
+00096860: 436f 6e74 656e 742d 5479 7065 3a20 7465  Content-Type: te
+00096870: 7874 2f6d 6172 6b64 6f77 6e0a 0000 0000  xt/markdown.....
 00096880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000968a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000968b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000968c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000968d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000968e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -38586,16 +38586,16 @@
 00096b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096c00: 3232 206d 7469 6d65 3d31 3637 3832 3833  22 mtime=1678283
-00096c10: 3737 302e 300a 0000 0000 0000 0000 0000  770.0...........
+00096c00: 3232 206d 7469 6d65 3d31 3638 3139 3033  22 mtime=1681903
+00096c10: 3937 372e 300a 0000 0000 0000 0000 0000  977.0...........
 00096c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -38618,24 +38618,24 @@
 00096d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00096e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00096e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00096e10: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
 00096e20: 666f 2f53 4f55 5243 4553 2e74 7874 0000  fo/SOURCES.txt..
 00096e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00096e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00096e80: 3030 3030 3737 3500 3030 3030 3030 3030  0000775.00000000
-00096e90: 3030 3000 3032 3033 3432 0020 3000 0000  000.020342. 0...
+00096e90: 3030 3000 3032 3033 3433 0020 3000 0000  000.020343. 0...
 00096ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00096f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -38714,16 +38714,16 @@
 00097390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000973a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000973b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000973c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000973d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000973e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000973f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097400: 3232 206d 7469 6d65 3d31 3637 3832 3833  22 mtime=1678283
-00097410: 3736 392e 300a 0000 0000 0000 0000 0000  769.0...........
+00097400: 3232 206d 7469 6d65 3d31 3638 3139 3033  22 mtime=1681903
+00097410: 3937 372e 300a 0000 0000 0000 0000 0000  977.0...........
 00097420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -38746,24 +38746,24 @@
 00097590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000975a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000975b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000975c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000975d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000975e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000975f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00097600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00097610: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
 00097620: 666f 2f64 6570 656e 6465 6e63 795f 6c69  fo/dependency_li
 00097630: 6e6b 732e 7478 7400 0000 0000 0000 0000  nks.txt.........
 00097640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00097670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00097680: 3030 3030 3030 3100 3030 3030 3030 3030  0000001.00000000
-00097690: 3030 3000 3032 3235 3133 0020 3000 0000  000.022513. 0...
+00097690: 3030 3000 3032 3235 3134 0020 3000 0000  000.022514. 0...
 000976a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000976b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000976c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000976d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000976e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000976f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -38842,16 +38842,16 @@
 00097b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097c00: 3232 206d 7469 6d65 3d31 3637 3832 3833  22 mtime=1678283
-00097c10: 3736 392e 300a 0000 0000 0000 0000 0000  769.0...........
+00097c00: 3232 206d 7469 6d65 3d31 3638 3139 3033  22 mtime=1681903
+00097c10: 3937 372e 300a 0000 0000 0000 0000 0000  977.0...........
 00097c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -38874,24 +38874,24 @@
 00097d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00097e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00097e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00097e10: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
 00097e20: 666f 2f72 6571 7569 7265 732e 7478 7400  fo/requires.txt.
 00097e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00097e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00097e80: 3030 3030 3336 3700 3030 3030 3030 3030  0000367.00000000
-00097e90: 3030 3000 3032 3130 3533 0020 3000 0000  000.021053. 0...
+00097e90: 3030 3000 3032 3130 3534 0020 3000 0000  000.021054. 0...
 00097ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00097f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -38970,16 +38970,16 @@
 00098390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000983f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098400: 3232 206d 7469 6d65 3d31 3637 3832 3833  22 mtime=1678283
-00098410: 3736 392e 300a 0000 0000 0000 0000 0000  769.0...........
+00098400: 3232 206d 7469 6d65 3d31 3638 3139 3033  22 mtime=1681903
+00098410: 3937 372e 300a 0000 0000 0000 0000 0000  977.0...........
 00098420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -39002,24 +39002,24 @@
 00098590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000985f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00098600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00098610: 2f61 7574 6f76 696d 6c2e 6567 672d 696e  /autoviml.egg-in
 00098620: 666f 2f74 6f70 5f6c 6576 656c 2e74 7874  fo/top_level.txt
 00098630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00098670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00098680: 3030 3030 3031 3100 3030 3030 3030 3030  0000011.00000000
-00098690: 3030 3000 3032 3131 3637 0020 3000 0000  000.021167. 0...
+00098690: 3030 3000 3032 3131 3730 0020 3000 0000  000.021170. 0...
 000986a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000986b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000986c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000986d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000986e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000986f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -39098,16 +39098,16 @@
 00098b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098c00: 3238 206d 7469 6d65 3d31 3637 3832 3833  28 mtime=1678283
-00098c10: 3737 302e 3830 3739 3939 310a 0000 0000  770.8079991.....
+00098c00: 3238 206d 7469 6d65 3d31 3638 3139 3033  28 mtime=1681903
+00098c10: 3937 382e 3731 3832 3532 370a 0000 0000  978.7182527.....
 00098c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -39130,24 +39130,24 @@
 00098d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00098e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00098e00: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00098e10: 2f73 6574 7570 2e63 6667 0000 0000 0000  /setup.cfg......
 00098e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098e60: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00098e70: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00098e80: 3030 3030 3034 3600 3030 3030 3030 3030  0000046.00000000
-00098e90: 3030 3000 3031 3437 3334 0020 3000 0000  000.014734. 0...
+00098e90: 3030 3000 3031 3437 3335 0020 3000 0000  000.014735. 0...
 00098ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00098f00: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -39226,16 +39226,16 @@
 00099390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000993f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099400: 3232 206d 7469 6d65 3d31 3637 3832 3830  22 mtime=1678280
-00099410: 3635 372e 300a 0000 0000 0000 0000 0000  657.0...........
+00099400: 3232 206d 7469 6d65 3d31 3638 3139 3033  22 mtime=1681903
+00099410: 3739 392e 300a 0000 0000 0000 0000 0000  799.0...........
 00099420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -39258,24 +39258,24 @@
 00099590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000995f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00099600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3133  autoviml-0.1.713
+00099600: 6175 746f 7669 6d6c 2d30 2e31 2e37 3134  autoviml-0.1.714
 00099610: 2f73 6574 7570 2e70 7900 0000 0000 0000  /setup.py.......
 00099620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099660: 0000 0000 3030 3030 3737 3700 3030 3031  ....0000777.0001
 00099670: 3735 3000 3030 3031 3735 3000 3030 3030  750.0001750.0000
 00099680: 3030 3032 3331 3100 3030 3030 3030 3030  0002311.00000000
-00099690: 3030 3000 3031 3436 3232 0020 3000 0000  000.014622. 0...
+00099690: 3030 3000 3031 3436 3233 0020 3000 0000  000.014623. 0...
 000996a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000996b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000996c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000996d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000996e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000996f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00099700: 0075 7374 6172 0030 3072 616d 0000 0000  .ustar.00ram....
@@ -39300,15 +39300,15 @@
 00099830: 2065 6e63 6f64 696e 673d 2275 7466 2d38   encoding="utf-8
 00099840: 2229 2061 7320 6668 3a0d 0a20 2020 206c  ") as fh:..    l
 00099850: 6f6e 675f 6465 7363 7269 7074 696f 6e20  ong_description 
 00099860: 3d20 6668 2e72 6561 6428 290d 0a0d 0a73  = fh.read()....s
 00099870: 6574 7570 746f 6f6c 732e 7365 7475 7028  etuptools.setup(
 00099880: 0d0a 2020 2020 6e61 6d65 3d22 6175 746f  ..    name="auto
 00099890: 7669 6d6c 222c 0d0a 2020 2020 7665 7273  viml",..    vers
-000998a0: 696f 6e3d 2230 2e31 2e37 3133 222c 0d0a  ion="0.1.713",..
+000998a0: 696f 6e3d 2230 2e31 2e37 3134 222c 0d0a  ion="0.1.714",..
 000998b0: 2020 2020 6175 7468 6f72 3d22 5261 6d20      author="Ram 
 000998c0: 5365 7368 6164 7269 222c 0d0a 2020 2020  Seshadri",..    
 000998d0: 2320 6175 7468 6f72 5f65 6d61 696c 3d22  # author_email="
 000998e0: 6175 7468 6f72 4065 7861 6d70 6c65 2e63  author@example.c
 000998f0: 6f6d 222c 0d0a 2020 2020 6465 7363 7269  om",..    descri
 00099900: 7074 696f 6e3d 2241 7574 6f6d 6174 6963  ption="Automatic
 00099910: 616c 6c79 2042 7569 6c64 2056 6172 6961  ally Build Varia
```

