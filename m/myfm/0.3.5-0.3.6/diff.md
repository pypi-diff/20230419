# Comparing `tmp/myfm-0.3.5-cp39-cp39-win_amd64.whl.zip` & `tmp/myfm-0.3.6-cp39-cp39-win_amd64.whl.zip`

## zipinfo {}

```diff
@@ -1,37 +1,37 @@
-Zip file size: 299009 bytes, number of entries: 35
--rw-rw-rw-  2.0 fat      748 b- defN 22-Jun-30 23:15 myfm/__init__.py
--rw-rw-rw-  2.0 fat   560128 b- defN 22-Jun-30 23:23 myfm/_myfm.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat    12873 b- defN 22-Jun-30 23:15 myfm/_myfm.pyi
--rw-rw-rw-  2.0 fat    13437 b- defN 22-Jun-30 23:15 myfm/base.py
--rw-rw-rw-  2.0 fat    17945 b- defN 22-Jun-30 23:15 myfm/gibbs.py
--rw-rw-rw-  2.0 fat    12405 b- defN 22-Jun-30 23:15 myfm/variational.py
--rw-rw-rw-  2.0 fat        0 b- defN 22-Jun-30 23:15 myfm/utils/__init__.py
--rw-rw-rw-  2.0 fat     2551 b- defN 22-Jun-30 23:15 myfm/utils/dummy_data.py
--rw-rw-rw-  2.0 fat      282 b- defN 22-Jun-30 23:15 myfm/utils/benchmark_data/__init__.py
--rw-rw-rw-  2.0 fat     3189 b- defN 22-Jun-30 23:15 myfm/utils/benchmark_data/loader_base.py
--rw-rw-rw-  2.0 fat     4039 b- defN 22-Jun-30 23:15 myfm/utils/benchmark_data/movielens100k_data.py
--rw-rw-rw-  2.0 fat      508 b- defN 22-Jun-30 23:15 myfm/utils/benchmark_data/movielens10M_data.py
--rw-rw-rw-  2.0 fat     1167 b- defN 22-Jun-30 23:15 myfm/utils/benchmark_data/movielens1M_data.py
--rw-rw-rw-  2.0 fat      271 b- defN 22-Jun-30 23:15 myfm/utils/callbacks/__init__.py
--rw-rw-rw-  2.0 fat    10158 b- defN 22-Jun-30 23:15 myfm/utils/callbacks/libfm.py
--rw-rw-rw-  2.0 fat      325 b- defN 22-Jun-30 23:15 myfm/utils/encoders/__init__.py
--rw-rw-rw-  2.0 fat     2528 b- defN 22-Jun-30 23:15 myfm/utils/encoders/base.py
--rw-rw-rw-  2.0 fat     2010 b- defN 22-Jun-30 23:15 myfm/utils/encoders/binning.py
--rw-rw-rw-  2.0 fat     3097 b- defN 22-Jun-30 23:15 myfm/utils/encoders/categorical.py
--rw-rw-rw-  2.0 fat     3080 b- defN 22-Jun-30 23:15 myfm/utils/encoders/multi_value.py
--rw-rw-rw-  2.0 fat     6335 b- defN 22-Jun-30 23:15 myfm-0.3.5.data/headers/FM.hpp
--rw-rw-rw-  2.0 fat     5950 b- defN 22-Jun-30 23:15 myfm-0.3.5.data/headers/FMLearningConfig.hpp
--rw-rw-rw-  2.0 fat    20435 b- defN 22-Jun-30 23:15 myfm-0.3.5.data/headers/FMTrainer.hpp
--rw-rw-rw-  2.0 fat     2703 b- defN 22-Jun-30 23:15 myfm-0.3.5.data/headers/Faddeeva.hh
--rw-rw-rw-  2.0 fat     1344 b- defN 22-Jun-30 23:15 myfm-0.3.5.data/headers/HyperParams.hpp
--rw-rw-rw-  2.0 fat    16483 b- defN 22-Jun-30 23:15 myfm-0.3.5.data/headers/OProbitSampler.hpp
--rw-rw-rw-  2.0 fat    17576 b- defN 22-Jun-30 23:15 myfm-0.3.5.data/headers/declare_module.hpp
--rw-rw-rw-  2.0 fat     2388 b- defN 22-Jun-30 23:15 myfm-0.3.5.data/headers/definitions.hpp
--rw-rw-rw-  2.0 fat     5739 b- defN 22-Jun-30 23:15 myfm-0.3.5.data/headers/predictor.hpp
--rw-rw-rw-  2.0 fat     5268 b- defN 22-Jun-30 23:15 myfm-0.3.5.data/headers/util.hpp
--rw-rw-rw-  2.0 fat     1092 b- defN 22-Jun-30 23:23 myfm-0.3.5.dist-info/LICENSE
--rw-rw-rw-  2.0 fat     8283 b- defN 22-Jun-30 23:23 myfm-0.3.5.dist-info/METADATA
--rw-rw-rw-  2.0 fat      100 b- defN 22-Jun-30 23:23 myfm-0.3.5.dist-info/WHEEL
--rw-rw-rw-  2.0 fat        5 b- defN 22-Jun-30 23:23 myfm-0.3.5.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat     3041 b- defN 22-Jun-30 23:23 myfm-0.3.5.dist-info/RECORD
-35 files, 747483 bytes uncompressed, 294123 bytes compressed:  60.7%
+Zip file size: 297494 bytes, number of entries: 35
+-rw-rw-rw-  2.0 fat      748 b- defN 23-Apr-19 02:33 myfm/__init__.py
+-rw-rw-rw-  2.0 fat   549888 b- defN 23-Apr-19 02:41 myfm/_myfm.cp39-win_amd64.pyd
+-rw-rw-rw-  2.0 fat    12875 b- defN 23-Apr-19 02:33 myfm/_myfm.pyi
+-rw-rw-rw-  2.0 fat    13437 b- defN 23-Apr-19 02:33 myfm/base.py
+-rw-rw-rw-  2.0 fat    17945 b- defN 23-Apr-19 02:33 myfm/gibbs.py
+-rw-rw-rw-  2.0 fat    12405 b- defN 23-Apr-19 02:33 myfm/variational.py
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Apr-19 02:33 myfm/utils/__init__.py
+-rw-rw-rw-  2.0 fat     2551 b- defN 23-Apr-19 02:33 myfm/utils/dummy_data.py
+-rw-rw-rw-  2.0 fat      282 b- defN 23-Apr-19 02:33 myfm/utils/benchmark_data/__init__.py
+-rw-rw-rw-  2.0 fat     3189 b- defN 23-Apr-19 02:33 myfm/utils/benchmark_data/loader_base.py
+-rw-rw-rw-  2.0 fat     4039 b- defN 23-Apr-19 02:33 myfm/utils/benchmark_data/movielens100k_data.py
+-rw-rw-rw-  2.0 fat      508 b- defN 23-Apr-19 02:33 myfm/utils/benchmark_data/movielens10M_data.py
+-rw-rw-rw-  2.0 fat     1167 b- defN 23-Apr-19 02:33 myfm/utils/benchmark_data/movielens1M_data.py
+-rw-rw-rw-  2.0 fat      271 b- defN 23-Apr-19 02:33 myfm/utils/callbacks/__init__.py
+-rw-rw-rw-  2.0 fat    10158 b- defN 23-Apr-19 02:33 myfm/utils/callbacks/libfm.py
+-rw-rw-rw-  2.0 fat      325 b- defN 23-Apr-19 02:33 myfm/utils/encoders/__init__.py
+-rw-rw-rw-  2.0 fat     2528 b- defN 23-Apr-19 02:33 myfm/utils/encoders/base.py
+-rw-rw-rw-  2.0 fat     2010 b- defN 23-Apr-19 02:33 myfm/utils/encoders/binning.py
+-rw-rw-rw-  2.0 fat     3097 b- defN 23-Apr-19 02:33 myfm/utils/encoders/categorical.py
+-rw-rw-rw-  2.0 fat     3080 b- defN 23-Apr-19 02:33 myfm/utils/encoders/multi_value.py
+-rw-rw-rw-  2.0 fat     6335 b- defN 23-Apr-19 02:33 myfm-0.3.6.data/headers/FM.hpp
+-rw-rw-rw-  2.0 fat     5950 b- defN 23-Apr-19 02:33 myfm-0.3.6.data/headers/FMLearningConfig.hpp
+-rw-rw-rw-  2.0 fat    20435 b- defN 23-Apr-19 02:33 myfm-0.3.6.data/headers/FMTrainer.hpp
+-rw-rw-rw-  2.0 fat     2703 b- defN 23-Apr-19 02:33 myfm-0.3.6.data/headers/Faddeeva.hh
+-rw-rw-rw-  2.0 fat     1344 b- defN 23-Apr-19 02:33 myfm-0.3.6.data/headers/HyperParams.hpp
+-rw-rw-rw-  2.0 fat    16483 b- defN 23-Apr-19 02:33 myfm-0.3.6.data/headers/OProbitSampler.hpp
+-rw-rw-rw-  2.0 fat    17576 b- defN 23-Apr-19 02:33 myfm-0.3.6.data/headers/declare_module.hpp
+-rw-rw-rw-  2.0 fat     2388 b- defN 23-Apr-19 02:33 myfm-0.3.6.data/headers/definitions.hpp
+-rw-rw-rw-  2.0 fat     5739 b- defN 23-Apr-19 02:33 myfm-0.3.6.data/headers/predictor.hpp
+-rw-rw-rw-  2.0 fat     5268 b- defN 23-Apr-19 02:33 myfm-0.3.6.data/headers/util.hpp
+-rw-rw-rw-  2.0 fat     1092 b- defN 23-Apr-19 02:41 myfm-0.3.6.dist-info/LICENSE
+-rw-rw-rw-  2.0 fat     8498 b- defN 23-Apr-19 02:41 myfm-0.3.6.dist-info/METADATA
+-rw-rw-rw-  2.0 fat      100 b- defN 23-Apr-19 02:41 myfm-0.3.6.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat        5 b- defN 23-Apr-19 02:41 myfm-0.3.6.dist-info/top_level.txt
+-rw-rw-r--  2.0 fat     3041 b- defN 23-Apr-19 02:41 myfm-0.3.6.dist-info/RECORD
+35 files, 737460 bytes uncompressed, 292608 bytes compressed:  60.3%
```

## zipnote {}

```diff
@@ -54,53 +54,53 @@
 
 Filename: myfm/utils/encoders/categorical.py
 Comment: 
 
 Filename: myfm/utils/encoders/multi_value.py
 Comment: 
 
-Filename: myfm-0.3.5.data/headers/FM.hpp
+Filename: myfm-0.3.6.data/headers/FM.hpp
 Comment: 
 
-Filename: myfm-0.3.5.data/headers/FMLearningConfig.hpp
+Filename: myfm-0.3.6.data/headers/FMLearningConfig.hpp
 Comment: 
 
-Filename: myfm-0.3.5.data/headers/FMTrainer.hpp
+Filename: myfm-0.3.6.data/headers/FMTrainer.hpp
 Comment: 
 
-Filename: myfm-0.3.5.data/headers/Faddeeva.hh
+Filename: myfm-0.3.6.data/headers/Faddeeva.hh
 Comment: 
 
-Filename: myfm-0.3.5.data/headers/HyperParams.hpp
+Filename: myfm-0.3.6.data/headers/HyperParams.hpp
 Comment: 
 
-Filename: myfm-0.3.5.data/headers/OProbitSampler.hpp
+Filename: myfm-0.3.6.data/headers/OProbitSampler.hpp
 Comment: 
 
-Filename: myfm-0.3.5.data/headers/declare_module.hpp
+Filename: myfm-0.3.6.data/headers/declare_module.hpp
 Comment: 
 
-Filename: myfm-0.3.5.data/headers/definitions.hpp
+Filename: myfm-0.3.6.data/headers/definitions.hpp
 Comment: 
 
-Filename: myfm-0.3.5.data/headers/predictor.hpp
+Filename: myfm-0.3.6.data/headers/predictor.hpp
 Comment: 
 
-Filename: myfm-0.3.5.data/headers/util.hpp
+Filename: myfm-0.3.6.data/headers/util.hpp
 Comment: 
 
-Filename: myfm-0.3.5.dist-info/LICENSE
+Filename: myfm-0.3.6.dist-info/LICENSE
 Comment: 
 
-Filename: myfm-0.3.5.dist-info/METADATA
+Filename: myfm-0.3.6.dist-info/METADATA
 Comment: 
 
-Filename: myfm-0.3.5.dist-info/WHEEL
+Filename: myfm-0.3.6.dist-info/WHEEL
 Comment: 
 
-Filename: myfm-0.3.5.dist-info/top_level.txt
+Filename: myfm-0.3.6.dist-info/top_level.txt
 Comment: 
 
-Filename: myfm-0.3.5.dist-info/RECORD
+Filename: myfm-0.3.6.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## myfm/_myfm.pyi

```diff
@@ -1,16 +1,17 @@
 """Backend C++ implementation for myfm."""
-import myfm._myfm
-from typing import *
 from typing import Iterable as iterable
 from typing import Iterator as iterator
+from typing import *
+
+import scipy.sparse
 from numpy import float64
 from numpy import typing as npt
 
-import scipy.sparse
+import myfm._myfm
 
 __all__ = [
     "ConfigBuilder",
     "FM",
     "FMHyperParameters",
     "FMLearningConfig",
     "FMTrainer",
```

## Comparing `myfm-0.3.5.data/headers/FM.hpp` & `myfm-0.3.6.data/headers/FM.hpp`

 * *Files identical despite different names*

## Comparing `myfm-0.3.5.data/headers/FMLearningConfig.hpp` & `myfm-0.3.6.data/headers/FMLearningConfig.hpp`

 * *Files identical despite different names*

## Comparing `myfm-0.3.5.data/headers/FMTrainer.hpp` & `myfm-0.3.6.data/headers/FMTrainer.hpp`

 * *Files identical despite different names*

## Comparing `myfm-0.3.5.data/headers/Faddeeva.hh` & `myfm-0.3.6.data/headers/Faddeeva.hh`

 * *Files identical despite different names*

## Comparing `myfm-0.3.5.data/headers/HyperParams.hpp` & `myfm-0.3.6.data/headers/HyperParams.hpp`

 * *Files identical despite different names*

## Comparing `myfm-0.3.5.data/headers/OProbitSampler.hpp` & `myfm-0.3.6.data/headers/OProbitSampler.hpp`

 * *Files identical despite different names*

## Comparing `myfm-0.3.5.data/headers/declare_module.hpp` & `myfm-0.3.6.data/headers/declare_module.hpp`

 * *Files identical despite different names*

## Comparing `myfm-0.3.5.data/headers/definitions.hpp` & `myfm-0.3.6.data/headers/definitions.hpp`

 * *Files identical despite different names*

## Comparing `myfm-0.3.5.data/headers/predictor.hpp` & `myfm-0.3.6.data/headers/predictor.hpp`

 * *Files identical despite different names*

## Comparing `myfm-0.3.5.data/headers/util.hpp` & `myfm-0.3.6.data/headers/util.hpp`

 * *Files identical despite different names*

## Comparing `myfm-0.3.5.dist-info/LICENSE` & `myfm-0.3.6.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `myfm-0.3.5.dist-info/METADATA` & `myfm-0.3.6.dist-info/METADATA`

 * *Files 10% similar despite different names*

```diff
@@ -1,215 +1,215 @@
-Metadata-Version: 2.1
-Name: myfm
-Version: 0.3.5
-Summary: Yet another Bayesian factorization machines.
-Home-page: https://github.com/tohtsky/myfm
-Author: Tomoki Ohtsuki
-Author-email: tomoki.ohtsuki.19937@outlook.jp
-Requires-Python: >=3.6
-Description-Content-Type: text/markdown
-License-File: LICENSE
-Requires-Dist: numpy (>=1.11)
-Requires-Dist: scipy (>=1.0)
-Requires-Dist: tqdm (>=4)
-Requires-Dist: pandas (>=1.0.0)
-Requires-Dist: typing-extensions (>=4.0.0)
-
-# myFM
-[![Python](https://img.shields.io/badge/python-3.7%20%7C%203.8%20%7C%203.9%20%7C%203.10-blue)](https://www.python.org)
-[![pypi](https://img.shields.io/pypi/v/myfm.svg)](https://pypi.python.org/pypi/myfm)
-[![GitHub license](https://img.shields.io/badge/license-MIT-blue.svg)](https://github.com/tohtsky/myFM)
-[![Build](https://github.com/tohtsky/myFM/workflows/Build%20wheel/badge.svg?branch=main)](https://github.com/tohtsky/myfm)
-[![Read the Docs](https://readthedocs.org/projects/myfm/badge/?version=stable)](https://myfm.readthedocs.io/en/stable/)
-[![codecov](https://codecov.io/gh/tohtsky/myfm/branch/main/graph/badge.svg?token=kLgOKTQqcV)](https://codecov.io/gh/tohtsky/myfm)
-
-
-myFM is an implementation of Bayesian [Factorization Machines](https://ieeexplore.ieee.org/abstract/document/5694074/) based on Gibbs sampling, which I believe is a wheel worth reinventing.
-
-Currently this supports most options for libFM MCMC engine, such as
-
-- Grouping of input variables (`-meta` option of [libFM](https://github.com/srendle/libfm))
-- Relation Data format (See the paper ["Scaling Factorization Machines to relational data"](https://dl.acm.org/citation.cfm?id=2488340))
-
-There are also functionalities not present in libFM:
-
-- The gibbs sampler for Ordered probit regression [5] implementing Metropolis-within-Gibbs scheme of [6].
-- Variational inference for regression and binary classification.
-
-Tutorial and reference doc is provided at https://myfm.readthedocs.io/en/latest/.
-
-# Installation
-
-The package is pip-installable.
-
-```
-pip install myfm
-```
-
-There are binaries for major operating systems.
-
-If you are working with less popular OS/architecture, pip will attempt to build myFM from the source (you need a decent C++ compiler!). In that case, in addition to installing python dependencies (`numpy`, `scipy`, `pandas`, ...), the above command will automatically download eigen (ver 3.4.0) to its build directory and use it during the build.
-
-# Examples
-
-## A Toy example
-
-This example is taken from [pyfm](https://github.com/coreylynch/pyFM) with some modification.
-
-```python
-import myfm
-from sklearn.feature_extraction import DictVectorizer
-import numpy as np
-train = [
-	{"user": "1", "item": "5", "age": 19},
-	{"user": "2", "item": "43", "age": 33},
-	{"user": "3", "item": "20", "age": 55},
-	{"user": "4", "item": "10", "age": 20},
-]
-v = DictVectorizer()
-X = v.fit_transform(train)
-print(X.toarray())
-# print
-# [[ 19.   0.   0.   0.   1.   1.   0.   0.   0.]
-#  [ 33.   0.   0.   1.   0.   0.   1.   0.   0.]
-#  [ 55.   0.   1.   0.   0.   0.   0.   1.   0.]
-#  [ 20.   1.   0.   0.   0.   0.   0.   0.   1.]]
-y = np.asarray([0, 1, 1, 0])
-fm = myfm.MyFMClassifier(rank=4)
-fm.fit(X,y)
-fm.predict(v.transform({"user": "1", "item": "10", "age": 24}))
-```
-
-## A Movielens-100k Example
-
-This example will require `pandas` and `scikit-learn`. `movielens100k_loader` is present in `examples/movielens100k_loader.py`.
-
-You will be able to obtain a result comparable to SOTA algorithms like GC-MC. See `examples/ml-100k.ipynb` for the detailed version.
-
-```python
-import numpy as np
-from sklearn.preprocessing import OneHotEncoder
-from sklearn import metrics
-
-import myfm
-from myfm.utils.benchmark_data import MovieLens100kDataManager
-
-data_manager = MovieLens100kDataManager()
-df_train, df_test = data_manager.load_rating_predefined_split(
-    fold=3
-)  # Note the dependence on the fold
-
-def test_myfm(df_train, df_test, rank=8, grouping=None, n_iter=100, samples=95):
-    explanation_columns = ["user_id", "movie_id"]
-    ohe = OneHotEncoder(handle_unknown="ignore")
-    X_train = ohe.fit_transform(df_train[explanation_columns])
-    X_test = ohe.transform(df_test[explanation_columns])
-    y_train = df_train.rating.values
-    y_test = df_test.rating.values
-    fm = myfm.MyFMRegressor(rank=rank, random_seed=114514)
-
-    if grouping:
-        # specify how columns of X_train are grouped
-        group_shapes = [len(category) for category in ohe.categories_]
-        assert sum(group_shapes) == X_train.shape[1]
-    else:
-        group_shapes = None
-
-    fm.fit(
-        X_train,
-        y_train,
-        group_shapes=group_shapes,
-        n_iter=n_iter,
-        n_kept_samples=samples,
-    )
-    prediction = fm.predict(X_test)
-    rmse = ((y_test - prediction) ** 2).mean() ** 0.5
-    mae = np.abs(y_test - prediction).mean()
-    print("rmse={rmse}, mae={mae}".format(rmse=rmse, mae=mae))
-    return fm
-
-
-# basic regression
-test_myfm(df_train, df_test, rank=8)
-# rmse=0.90321, mae=0.71164
-
-# with grouping
-fm = test_myfm(df_train, df_test, rank=8, grouping=True)
-# rmse=0.89594, mae=0.70481
-```
-
-## Examples for Relational Data format
-
-Below is a toy movielens-like example that utilizes relational data format proposed in [3].
-
-This example, however, is too simplistic to exhibit the computational advantage of this data format. For an example with drastically reduced computational complexity, see `examples/ml-100k-extended.ipynb`;
-
-```python
-import pandas as pd
-import numpy as np
-from myfm import MyFMRegressor, RelationBlock
-from sklearn.preprocessing import OneHotEncoder
-
-users = pd.DataFrame([
-    {'user_id': 1, 'age': '20s', 'married': False},
-    {'user_id': 2, 'age': '30s', 'married': False},
-    {'user_id': 3, 'age': '40s', 'married': True}
-]).set_index('user_id')
-
-movies = pd.DataFrame([
-    {'movie_id': 1, 'comedy': True, 'action': False },
-    {'movie_id': 2, 'comedy': False, 'action': True },
-    {'movie_id': 3, 'comedy': True, 'action': True}
-]).set_index('movie_id')
-
-ratings = pd.DataFrame([
-    {'user_id': 1, 'movie_id': 1, 'rating': 2},
-    {'user_id': 1, 'movie_id': 2, 'rating': 5},
-    {'user_id': 2, 'movie_id': 2, 'rating': 4},
-    {'user_id': 2, 'movie_id': 3, 'rating': 3},
-    {'user_id': 3, 'movie_id': 3, 'rating': 3},
-])
-
-user_ids, user_indices = np.unique(ratings.user_id, return_inverse=True)
-movie_ids, movie_indices = np.unique(ratings.movie_id, return_inverse=True)
-
-user_ohe = OneHotEncoder(handle_unknown='ignore').fit(users.reset_index()) # include user id as feature
-movie_ohe = OneHotEncoder(handle_unknown='ignore').fit(movies.reset_index())
-
-X_user = user_ohe.transform(
-    users.reindex(user_ids).reset_index()
-)
-X_movie = movie_ohe.transform(
-    movies.reindex(movie_ids).reset_index()
-)
-
-block_user = RelationBlock(user_indices, X_user)
-block_movie = RelationBlock(movie_indices, X_movie)
-
-fm = MyFMRegressor(rank=2).fit(None, ratings.rating, X_rel=[block_user, block_movie])
-
-prediction_df = pd.DataFrame([
-    dict(user_id=user_id,movie_id=movie_id,
-         user_index=user_index, movie_index=movie_index)
-    for user_index, user_id in enumerate(user_ids)
-    for movie_index, movie_id in enumerate(movie_ids)
-])
-predicted_rating = fm.predict(None, [
-    RelationBlock(prediction_df.user_index, X_user),
-    RelationBlock(prediction_df.movie_index, X_movie)
-])
-
-prediction_df['prediction']  = predicted_rating
-
-print(
-    prediction_df.merge(ratings.rename(columns={'rating':'ground_truth'}), how='left')
-)
-```
-
-# References
-
-1. Rendle, Steffen. "Factorization machines." 2010 IEEE International Conference on Data Mining. IEEE, 2010.
-1. Rendle, Steffen. "Factorization machines with libfm." ACM Transactions on Intelligent Systems and Technology (TIST) 3.3 (2012): 57.
-1. Rendle, Steffen. "Scaling factorization machines to relational data." Proceedings of the VLDB Endowment. Vol. 6. No. 5. VLDB Endowment, 2013.
-1. Bayer, Immanuel. "fastfm: A library for factorization machines." arXiv preprint arXiv:1505.00641 (2015).
-1. Albert, James H., and Siddhartha Chib. "Bayesian analysis of binary and polychotomous response data." Journal of the American statistical Association 88.422 (1993): 669-679.
-1. Albert, James H., and Siddhartha Chib. "Sequential ordinal modeling with applications to survival data." Biometrics 57.3 (2001): 829-836.
+Metadata-Version: 2.1
+Name: myfm
+Version: 0.3.6
+Summary: Yet another Bayesian factorization machines.
+Home-page: https://github.com/tohtsky/myfm
+Author: Tomoki Ohtsuki
+Author-email: tomoki.ohtsuki.19937@outlook.jp
+Requires-Python: >=3.6
+Description-Content-Type: text/markdown
+License-File: LICENSE
+Requires-Dist: numpy (>=1.11)
+Requires-Dist: scipy (>=1.0)
+Requires-Dist: tqdm (>=4)
+Requires-Dist: pandas (>=1.0.0)
+Requires-Dist: typing-extensions (>=4.0.0)
+
+# myFM
+[![Python](https://img.shields.io/badge/python-3.7%20%7C%203.8%20%7C%203.9%20%7C%203.10-blue)](https://www.python.org)
+[![pypi](https://img.shields.io/pypi/v/myfm.svg)](https://pypi.python.org/pypi/myfm)
+[![GitHub license](https://img.shields.io/badge/license-MIT-blue.svg)](https://github.com/tohtsky/myFM)
+[![Build](https://github.com/tohtsky/myFM/workflows/Build%20wheel/badge.svg?branch=main)](https://github.com/tohtsky/myfm)
+[![Read the Docs](https://readthedocs.org/projects/myfm/badge/?version=stable)](https://myfm.readthedocs.io/en/stable/)
+[![codecov](https://codecov.io/gh/tohtsky/myfm/branch/main/graph/badge.svg?token=kLgOKTQqcV)](https://codecov.io/gh/tohtsky/myfm)
+
+
+myFM is an implementation of Bayesian [Factorization Machines](https://ieeexplore.ieee.org/abstract/document/5694074/) based on Gibbs sampling, which I believe is a wheel worth reinventing.
+
+Currently this supports most options for libFM MCMC engine, such as
+
+- Grouping of input variables (`-meta` option of [libFM](https://github.com/srendle/libfm))
+- Relation Data format (See the paper ["Scaling Factorization Machines to relational data"](https://dl.acm.org/citation.cfm?id=2488340))
+
+There are also functionalities not present in libFM:
+
+- The gibbs sampler for Ordered probit regression [5] implementing Metropolis-within-Gibbs scheme of [6].
+- Variational inference for regression and binary classification.
+
+Tutorial and reference doc is provided at https://myfm.readthedocs.io/en/latest/.
+
+# Installation
+
+The package is pip-installable.
+
+```
+pip install myfm
+```
+
+There are binaries for major operating systems.
+
+If you are working with less popular OS/architecture, pip will attempt to build myFM from the source (you need a decent C++ compiler!). In that case, in addition to installing python dependencies (`numpy`, `scipy`, `pandas`, ...), the above command will automatically download eigen (ver 3.4.0) to its build directory and use it during the build.
+
+# Examples
+
+## A Toy example
+
+This example is taken from [pyfm](https://github.com/coreylynch/pyFM) with some modification.
+
+```python
+import myfm
+from sklearn.feature_extraction import DictVectorizer
+import numpy as np
+train = [
+	{"user": "1", "item": "5", "age": 19},
+	{"user": "2", "item": "43", "age": 33},
+	{"user": "3", "item": "20", "age": 55},
+	{"user": "4", "item": "10", "age": 20},
+]
+v = DictVectorizer()
+X = v.fit_transform(train)
+print(X.toarray())
+# print
+# [[ 19.   0.   0.   0.   1.   1.   0.   0.   0.]
+#  [ 33.   0.   0.   1.   0.   0.   1.   0.   0.]
+#  [ 55.   0.   1.   0.   0.   0.   0.   1.   0.]
+#  [ 20.   1.   0.   0.   0.   0.   0.   0.   1.]]
+y = np.asarray([0, 1, 1, 0])
+fm = myfm.MyFMClassifier(rank=4)
+fm.fit(X,y)
+fm.predict(v.transform({"user": "1", "item": "10", "age": 24}))
+```
+
+## A Movielens-100k Example
+
+This example will require `pandas` and `scikit-learn`. `movielens100k_loader` is present in `examples/movielens100k_loader.py`.
+
+You will be able to obtain a result comparable to SOTA algorithms like GC-MC. See `examples/ml-100k.ipynb` for the detailed version.
+
+```python
+import numpy as np
+from sklearn.preprocessing import OneHotEncoder
+from sklearn import metrics
+
+import myfm
+from myfm.utils.benchmark_data import MovieLens100kDataManager
+
+data_manager = MovieLens100kDataManager()
+df_train, df_test = data_manager.load_rating_predefined_split(
+    fold=3
+)  # Note the dependence on the fold
+
+def test_myfm(df_train, df_test, rank=8, grouping=None, n_iter=100, samples=95):
+    explanation_columns = ["user_id", "movie_id"]
+    ohe = OneHotEncoder(handle_unknown="ignore")
+    X_train = ohe.fit_transform(df_train[explanation_columns])
+    X_test = ohe.transform(df_test[explanation_columns])
+    y_train = df_train.rating.values
+    y_test = df_test.rating.values
+    fm = myfm.MyFMRegressor(rank=rank, random_seed=114514)
+
+    if grouping:
+        # specify how columns of X_train are grouped
+        group_shapes = [len(category) for category in ohe.categories_]
+        assert sum(group_shapes) == X_train.shape[1]
+    else:
+        group_shapes = None
+
+    fm.fit(
+        X_train,
+        y_train,
+        group_shapes=group_shapes,
+        n_iter=n_iter,
+        n_kept_samples=samples,
+    )
+    prediction = fm.predict(X_test)
+    rmse = ((y_test - prediction) ** 2).mean() ** 0.5
+    mae = np.abs(y_test - prediction).mean()
+    print("rmse={rmse}, mae={mae}".format(rmse=rmse, mae=mae))
+    return fm
+
+
+# basic regression
+test_myfm(df_train, df_test, rank=8)
+# rmse=0.90321, mae=0.71164
+
+# with grouping
+fm = test_myfm(df_train, df_test, rank=8, grouping=True)
+# rmse=0.89594, mae=0.70481
+```
+
+## Examples for Relational Data format
+
+Below is a toy movielens-like example that utilizes relational data format proposed in [3].
+
+This example, however, is too simplistic to exhibit the computational advantage of this data format. For an example with drastically reduced computational complexity, see `examples/ml-100k-extended.ipynb`;
+
+```python
+import pandas as pd
+import numpy as np
+from myfm import MyFMRegressor, RelationBlock
+from sklearn.preprocessing import OneHotEncoder
+
+users = pd.DataFrame([
+    {'user_id': 1, 'age': '20s', 'married': False},
+    {'user_id': 2, 'age': '30s', 'married': False},
+    {'user_id': 3, 'age': '40s', 'married': True}
+]).set_index('user_id')
+
+movies = pd.DataFrame([
+    {'movie_id': 1, 'comedy': True, 'action': False },
+    {'movie_id': 2, 'comedy': False, 'action': True },
+    {'movie_id': 3, 'comedy': True, 'action': True}
+]).set_index('movie_id')
+
+ratings = pd.DataFrame([
+    {'user_id': 1, 'movie_id': 1, 'rating': 2},
+    {'user_id': 1, 'movie_id': 2, 'rating': 5},
+    {'user_id': 2, 'movie_id': 2, 'rating': 4},
+    {'user_id': 2, 'movie_id': 3, 'rating': 3},
+    {'user_id': 3, 'movie_id': 3, 'rating': 3},
+])
+
+user_ids, user_indices = np.unique(ratings.user_id, return_inverse=True)
+movie_ids, movie_indices = np.unique(ratings.movie_id, return_inverse=True)
+
+user_ohe = OneHotEncoder(handle_unknown='ignore').fit(users.reset_index()) # include user id as feature
+movie_ohe = OneHotEncoder(handle_unknown='ignore').fit(movies.reset_index())
+
+X_user = user_ohe.transform(
+    users.reindex(user_ids).reset_index()
+)
+X_movie = movie_ohe.transform(
+    movies.reindex(movie_ids).reset_index()
+)
+
+block_user = RelationBlock(user_indices, X_user)
+block_movie = RelationBlock(movie_indices, X_movie)
+
+fm = MyFMRegressor(rank=2).fit(None, ratings.rating, X_rel=[block_user, block_movie])
+
+prediction_df = pd.DataFrame([
+    dict(user_id=user_id,movie_id=movie_id,
+         user_index=user_index, movie_index=movie_index)
+    for user_index, user_id in enumerate(user_ids)
+    for movie_index, movie_id in enumerate(movie_ids)
+])
+predicted_rating = fm.predict(None, [
+    RelationBlock(prediction_df.user_index, X_user),
+    RelationBlock(prediction_df.movie_index, X_movie)
+])
+
+prediction_df['prediction']  = predicted_rating
+
+print(
+    prediction_df.merge(ratings.rename(columns={'rating':'ground_truth'}), how='left')
+)
+```
+
+# References
+
+1. Rendle, Steffen. "Factorization machines." 2010 IEEE International Conference on Data Mining. IEEE, 2010.
+1. Rendle, Steffen. "Factorization machines with libfm." ACM Transactions on Intelligent Systems and Technology (TIST) 3.3 (2012): 57.
+1. Rendle, Steffen. "Scaling factorization machines to relational data." Proceedings of the VLDB Endowment. Vol. 6. No. 5. VLDB Endowment, 2013.
+1. Bayer, Immanuel. "fastfm: A library for factorization machines." arXiv preprint arXiv:1505.00641 (2015).
+1. Albert, James H., and Siddhartha Chib. "Bayesian analysis of binary and polychotomous response data." Journal of the American statistical Association 88.422 (1993): 669-679.
+1. Albert, James H., and Siddhartha Chib. "Sequential ordinal modeling with applications to survival data." Biometrics 57.3 (2001): 829-836.
```

## Comparing `myfm-0.3.5.dist-info/RECORD` & `myfm-0.3.6.dist-info/RECORD`

 * *Files 8% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 myfm/__init__.py,sha256=G_GWZDjU4uhXvU7Td8hXQcQf1H3tzMpmColDo85w2wk,748
-myfm/_myfm.cp39-win_amd64.pyd,sha256=XrZVwzUybOdK2_Q1dKbDHcxhcPlyt-MsQ99fel6MojQ,560128
-myfm/_myfm.pyi,sha256=cvSKUaSub3gM8XD75nPjgQF-hCYwcMaXO3SPyVUVf8M,12873
+myfm/_myfm.cp39-win_amd64.pyd,sha256=91cfcwfYourAHqX24gUSJHHPwL23_d0XxbFGG4nHHyE,549888
+myfm/_myfm.pyi,sha256=GUSezWDE2Ij-1fPntlSr0ImWA8pDbp7MQ-gQ0u62rKA,12875
 myfm/base.py,sha256=beDA-QpVnplyOHXSvkid0SIMp2Nc8vprnKA-Mvk6WgQ,13437
 myfm/gibbs.py,sha256=_h5e5B85kxH967FeFMdI47Hbu8yvoqKymJJleV3zy-Y,17945
 myfm/variational.py,sha256=AspEIrBYJftn1noodts91ZIrOVhbUaDvTFZfXsXnKP8,12405
 myfm/utils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 myfm/utils/dummy_data.py,sha256=BvuudxJiWKe3rSymbXIUu_tqteNpMe9khvvo9eCi3Xs,2551
 myfm/utils/benchmark_data/__init__.py,sha256=4CkZJRi6XGmocOl04mCc_udZ69dSKI7brAMbd9pRV1U,282
 myfm/utils/benchmark_data/loader_base.py,sha256=K7VdN04fVRMVOrbJsN_PPcYyzw_-RNup8uwTPZj2zz4,3189
@@ -14,22 +14,22 @@
 myfm/utils/callbacks/__init__.py,sha256=0lCxvkZ0geWMnTduwjkbXnycn9FkgyDB9K-fjA9NGso,271
 myfm/utils/callbacks/libfm.py,sha256=_6O3G-oBCF_SkgBoHeCRTwD4JsnHJ7wQ2YP3zbvCtCk,10158
 myfm/utils/encoders/__init__.py,sha256=EO1ZvVz8MSlpz0xNIdAdKvVOKIvrdxiPQOTt1GJN0z0,325
 myfm/utils/encoders/base.py,sha256=6ughsh8FilE0HJ6dGPT9vlb0UA6zwhI7vJoouAUD79g,2528
 myfm/utils/encoders/binning.py,sha256=zCaifY1PCvRInoDYUB-1Ed01XZCn70c7sPdFVswENVw,2010
 myfm/utils/encoders/categorical.py,sha256=1-v22n4998u3brnIzsL1E8_40zAGexk05ZfMax2In5Q,3097
 myfm/utils/encoders/multi_value.py,sha256=Amm7wtyxsRllWMBP0SUGsDq--0et708JP7pn1V9f2HI,3080
-myfm-0.3.5.data/headers/FM.hpp,sha256=xj14gudEkmYu015woUWnnKIQKYooYPyWIj1rhBXehXA,6335
-myfm-0.3.5.data/headers/FMLearningConfig.hpp,sha256=HVQRLJtggJcxvzfWGEEV2-aUGFAVtfnxIwOBOdIZVd8,5950
-myfm-0.3.5.data/headers/FMTrainer.hpp,sha256=7Ev5xq3Nqa0OW-nYO_MBwR59vu_H09TXoSrsbVW04NY,20435
-myfm-0.3.5.data/headers/Faddeeva.hh,sha256=aAOr6ABGBxfetqdKYnzBPkQwmuqv_9ax8udpwiDxJkE,2703
-myfm-0.3.5.data/headers/HyperParams.hpp,sha256=hOXoSf65bsfSAkWOZ-GJXijQ8iy7Fv9dqXSDx3P3rpQ,1344
-myfm-0.3.5.data/headers/OProbitSampler.hpp,sha256=_ie5oT6YME1GY9oh3OU5NtBHnxjCiXtJABhySxtejyc,16483
-myfm-0.3.5.data/headers/declare_module.hpp,sha256=c3tf0fzVouLsBia6Lfd3AMM_tFJ39ULL0M-CjpLz9rY,17576
-myfm-0.3.5.data/headers/definitions.hpp,sha256=BzxWsAz9UOKf3Pv5uCWVBPKH7L2x6pupB-37AIaqs2c,2388
-myfm-0.3.5.data/headers/predictor.hpp,sha256=mdKCLGBpGZjXxMbUg2neL6QHGUZ5QwFVFPNK8JVXO8U,5739
-myfm-0.3.5.data/headers/util.hpp,sha256=jTvEzixZd1KTNFK4QBhIaglxP1vohO8lauvIH26eVSA,5268
-myfm-0.3.5.dist-info/LICENSE,sha256=DkQx6JxygLFxl5UVHrpR1cWbeXuME5zHyNH1BfoB6ao,1092
-myfm-0.3.5.dist-info/METADATA,sha256=v4K6YIdBWLRNJqFZugV561HxhXsJHBR_fM3K0_4iPaA,8283
-myfm-0.3.5.dist-info/WHEEL,sha256=fVcVlLzi8CGi_Ul8vjMdn8gER25dn5GBg9E6k9z41-Y,100
-myfm-0.3.5.dist-info/top_level.txt,sha256=LdVUPthD49fWYojSEyZTAIVWdWD7sjRVWNnMLWm3Z0s,5
-myfm-0.3.5.dist-info/RECORD,,
+myfm-0.3.6.data/headers/FM.hpp,sha256=xj14gudEkmYu015woUWnnKIQKYooYPyWIj1rhBXehXA,6335
+myfm-0.3.6.data/headers/FMLearningConfig.hpp,sha256=HVQRLJtggJcxvzfWGEEV2-aUGFAVtfnxIwOBOdIZVd8,5950
+myfm-0.3.6.data/headers/FMTrainer.hpp,sha256=7Ev5xq3Nqa0OW-nYO_MBwR59vu_H09TXoSrsbVW04NY,20435
+myfm-0.3.6.data/headers/Faddeeva.hh,sha256=aAOr6ABGBxfetqdKYnzBPkQwmuqv_9ax8udpwiDxJkE,2703
+myfm-0.3.6.data/headers/HyperParams.hpp,sha256=hOXoSf65bsfSAkWOZ-GJXijQ8iy7Fv9dqXSDx3P3rpQ,1344
+myfm-0.3.6.data/headers/OProbitSampler.hpp,sha256=_ie5oT6YME1GY9oh3OU5NtBHnxjCiXtJABhySxtejyc,16483
+myfm-0.3.6.data/headers/declare_module.hpp,sha256=c3tf0fzVouLsBia6Lfd3AMM_tFJ39ULL0M-CjpLz9rY,17576
+myfm-0.3.6.data/headers/definitions.hpp,sha256=BzxWsAz9UOKf3Pv5uCWVBPKH7L2x6pupB-37AIaqs2c,2388
+myfm-0.3.6.data/headers/predictor.hpp,sha256=mdKCLGBpGZjXxMbUg2neL6QHGUZ5QwFVFPNK8JVXO8U,5739
+myfm-0.3.6.data/headers/util.hpp,sha256=jTvEzixZd1KTNFK4QBhIaglxP1vohO8lauvIH26eVSA,5268
+myfm-0.3.6.dist-info/LICENSE,sha256=DkQx6JxygLFxl5UVHrpR1cWbeXuME5zHyNH1BfoB6ao,1092
+myfm-0.3.6.dist-info/METADATA,sha256=S3_k8BWPAvx1-U2rWFNWeL550yPvkmurCfKGXaSBvgI,8498
+myfm-0.3.6.dist-info/WHEEL,sha256=eep6QWEFiQfg2wcclssb_WY-D33AnLYLnEKGA9Rn-VU,100
+myfm-0.3.6.dist-info/top_level.txt,sha256=LdVUPthD49fWYojSEyZTAIVWdWD7sjRVWNnMLWm3Z0s,5
+myfm-0.3.6.dist-info/RECORD,,
```

