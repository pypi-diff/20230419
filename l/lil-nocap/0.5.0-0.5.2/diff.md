# Comparing `tmp/lil_nocap-0.5.0.tar.gz` & `tmp/lil_nocap-0.5.2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "lil_nocap-0.5.0.tar", max compression
+gzip compressed data, was "lil_nocap-0.5.2.tar", max compression
```

## Comparing `lil_nocap-0.5.0.tar` & `lil_nocap-0.5.2.tar`

### file list

```diff
@@ -1,10 +1,9 @@
--rw-r--r--   0        0        0      880 2023-03-29 18:43:43.824841 lil_nocap-0.5.0/README.md
--rw-r--r--   0        0        0    24576 2023-04-13 14:10:51.196482 lil_nocap-0.5.0/lil_nocap/.__init__.py.swp
--rw-r--r--   0        0        0    12288 2023-04-13 14:33:01.005102 lil_nocap-0.5.0/lil_nocap/.nocap.py.swp
--rw-r--r--   0        0        0     9805 2023-04-13 14:10:45.247746 lil_nocap-0.5.0/lil_nocap/__init__.py
--rw-r--r--   0        0        0        0 2023-03-23 15:05:43.219167 lil_nocap-0.5.0/lil_nocap/opinions.jsonl
--rw-r--r--   0        0        0      324 2023-03-20 15:40:07.101005 lil_nocap-0.5.0/lil_nocap/test.py
--rw-r--r--   0        0        0        0 2023-03-20 15:34:19.022580 lil_nocap-0.5.0/lil_nocap/test.txt
--rw-r--r--   0        0        0      498 2023-04-13 14:37:03.461610 lil_nocap-0.5.0/pyproject.toml
--rw-r--r--   0        0        0     1732 1970-01-01 00:00:00.000000 lil_nocap-0.5.0/setup.py
--rw-r--r--   0        0        0     1597 1970-01-01 00:00:00.000000 lil_nocap-0.5.0/PKG-INFO
+-rw-r--r--   0        0        0      880 2023-03-29 18:43:43.824841 lil_nocap-0.5.2/README.md
+-rw-r--r--   0        0        0    32768 2023-04-19 16:04:36.367887 lil_nocap-0.5.2/lil_nocap/.__init__.py.swp
+-rw-r--r--   0        0        0    11350 2023-04-19 16:03:31.938655 lil_nocap-0.5.2/lil_nocap/__init__.py
+-rw-r--r--   0        0        0        0 2023-03-23 15:05:43.219167 lil_nocap-0.5.2/lil_nocap/opinions.jsonl
+-rw-r--r--   0        0        0      324 2023-03-20 15:40:07.101005 lil_nocap-0.5.2/lil_nocap/test.py
+-rw-r--r--   0        0        0        0 2023-03-20 15:34:19.022580 lil_nocap-0.5.2/lil_nocap/test.txt
+-rw-r--r--   0        0        0      498 2023-04-19 16:04:16.946304 lil_nocap-0.5.2/pyproject.toml
+-rw-r--r--   0        0        0     1732 1970-01-01 00:00:00.000000 lil_nocap-0.5.2/setup.py
+-rw-r--r--   0        0        0     1597 1970-01-01 00:00:00.000000 lil_nocap-0.5.2/PKG-INFO
```

### Comparing `lil_nocap-0.5.0/README.md` & `lil_nocap-0.5.2/README.md`

 * *Files identical despite different names*

### Comparing `lil_nocap-0.5.0/lil_nocap/.__init__.py.swp` & `lil_nocap-0.5.2/lil_nocap/.__init__.py.swp`

 * *Files 22% similar despite different names*

```diff
@@ -1,9 +1,9 @@
 00000000: 6230 5649 4d20 382e 3200 0000 0010 0000  b0VIM 8.2.......
-00000010: 650d 3864 bc7a be00 c451 0000 7361 6265  e.8d.z...Q..sabe
+00000010: d310 4064 f591 c800 8243 0000 7361 6265  ..@d.....C..sabe
 00000020: 6c6f 7365 7468 756d 686c 616d 6269 0000  losethumhlambi..
 00000030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000040: 0000 0000 484c 5343 3032 5a56 3342 434d  ....HLSC02ZV3BCM
 00000050: 4436 5400 0000 0000 0000 0000 0000 0000  D6T.............
 00000060: 0000 0000 0000 0000 0000 0000 7e73 6162  ............~sab
 00000070: 656c 6f73 6574 6875 6d68 6c61 6d62 692f  elosethumhlambi/
 00000080: 446f 6375 6d65 6e74 732f 4769 7448 7562  Documents/GitHub
@@ -250,27 +250,27 @@
 00000f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001000: 7470 0400 7f00 0000 0200 0000 0000 0000  tp..............
-00001010: 6900 0000 0000 0000 0100 0000 0000 0000  i...............
-00001020: 0100 0000 0000 0000 0400 0000 0000 0000  ................
-00001030: 2d00 0000 0000 0000 6c00 0000 0000 0000  -.......l.......
-00001040: 0100 0000 0000 0000 0500 0000 0000 0000  ................
-00001050: 4600 0000 0000 0000 9800 0000 0000 0000  F...............
-00001060: 0100 0000 0000 0000 0300 0000 0000 0000  ................
-00001070: 5400 0000 0000 0000 de00 0000 0000 0000  T...............
-00001080: 0100 0000 0000 0000 0000 0000 0000 0000  ................
-00001090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000010a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000010b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000010c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00001000: 7470 0600 7f00 0000 0200 0000 0000 0000  tp..............
+00001010: 1500 0000 0000 0000 0100 0000 0000 0000  ................
+00001020: 0100 0000 0000 0000 0300 0000 0000 0000  ................
+00001030: 5e00 0000 0000 0000 0f00 0000 0000 0000  ^...............
+00001040: 0100 0000 0000 0000 0400 0000 0000 0000  ................
+00001050: 2c00 0000 0000 0000 6b00 0000 0000 0000  ,.......k.......
+00001060: 0100 0000 0000 0000 0600 0000 0000 0000  ................
+00001070: 2500 0000 0000 0000 9e00 0000 0000 0000  %...............
+00001080: 0100 0000 0000 0000 0700 0000 0000 0000  ................
+00001090: 6100 0000 0000 0000 b000 0000 0000 0000  a...............
+000010a0: 0100 0000 0000 0000 0500 0000 0000 0000  ................
+000010b0: 3800 0000 0000 0000 dd00 0000 0000 0000  8...............
+000010c0: 0100 0000 0000 0000 0000 0000 0000 0000  ................
 000010d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -506,690 +506,690 @@
 00001f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002000: 6164 0000 4100 0000 0102 0000 0010 0000  ad..A...........
-00002010: 6900 0000 0000 0000 f00f 0000 dc0f 0000  i...............
-00002020: c90f 0000 bd0f 0000 8f0f 0000 730f 0000  ............s...
-00002030: 560f 0000 4a0f 0000 3c0f 0000 320f 0000  V...J...<...2...
-00002040: 250f 0000 1b0f 0000 1a0f 0000 0d0f 0000  %...............
-00002050: b10e 0000 8d0e 0000 590e 0000 390e 0000  ........Y...9...
-00002060: 170e 0000 f30d 0000 f20d 0000 c60d 0000  ................
-00002070: 860d 0000 560d 0000 280d 0000 270d 0000  ....V...(...'...
-00002080: f60c 0000 c90c 0000 c80c 0000 b30c 0000  ................
-00002090: 6a0c 0000 180c 0000 d00b 0000 880b 0000  j...............
-000020a0: 3a0b 0000 1e0b 0000 fb0a 0000 f60a 0000  :...............
-000020b0: cf0a 0000 ae0a 0000 890a 0000 680a 0000  ............h...
-000020c0: 420a 0000 200a 0000 fd09 0000 e709 0000  B... ...........
-000020d0: d709 0000 c109 0000 7b09 0000 2109 0000  ........{...!...
-000020e0: 0209 0000 f008 0000 d008 0000 b208 0000  ................
-000020f0: 9a08 0000 9908 0000 5c08 0000 e207 0000  ........\.......
-00002100: c207 0000 9807 0000 6b07 0000 3907 0000  ........k...9...
-00002110: 0907 0000 fb06 0000 dd06 0000 8706 0000  ................
-00002120: 1306 0000 0906 0000 9a05 0000 7c05 0000  ............|...
-00002130: 3d05 0000 2f05 0000 2e05 0000 1705 0000  =.../...........
-00002140: f704 0000 df04 0000 de04 0000 ae04 0000  ................
-00002150: 8704 0000 8404 0000 5504 0000 2e04 0000  ........U.......
-00002160: 2004 0000 0404 0000 ee03 0000 d003 0000   ...............
-00002170: b003 0000 9303 0000 7203 0000 6d03 0000  ........r...m...
-00002180: 5103 0000 3f03 0000 2103 0000 0f03 0000  Q...?...!.......
-00002190: f002 0000 dd02 0000 be02 0000 aa02 0000  ................
-000021a0: 8c02 0000 7902 0000 5a02 0000 4702 0000  ....y...Z...G...
-000021b0: 3702 0000 3602 0000 0102 0000 0002 0000  7...6...........
-000021c0: e801 0000 e701 0000 0000 0000 0000 0000  ................
-000021d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000021e0: 0000 0000 0000 0000 2020 6465 6620 6765  ........  def ge
-000021f0: 745f 6369 7461 7469 6f6e 7328 7365 6c66  t_citations(self
-00002200: 2020 2064 6566 2067 6574 5f63 6974 6174     def get_citat
-00002210: 696f 6e73 2873 656c 662c 206f 7069 6e69  ions(self, opini
-00002220: 6f6e 5f69 642c 2064 665f 6369 7461 7469  on_id, df_citati
-00002230: 6f6e 7329 3a00 0020 2020 2072 6574 7572  ons):..    retur
-00002240: 6e20 7465 7874 0020 2020 2020 2020 2074  n text.        t
-00002250: 6578 7420 3d20 686c 6100 2020 2020 656c  ext = hla.    el
-00002260: 6966 2069 7369 6e73 7461 6e63 6528 686c  if isinstance(hl
-00002270: 612c 2073 7472 293a 0020 2020 2020 2020  a, str):.       
-00002280: 2074 6578 7420 3d20 7868 2000 2020 2020   text = xh .    
-00002290: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
-000022a0: 7868 2c20 7374 7229 3a00 2020 2020 2020  xh, str):.      
-000022b0: 2020 7465 7874 203d 2068 6c63 2000 2020    text = hlc .  
-000022c0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-000022d0: 6528 686c 632c 2073 7472 293a 0020 2020  e(hlc, str):.   
-000022e0: 2020 2020 2074 6578 7420 3d20 686c 6200       text = hlb.
-000022f0: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-00002300: 6e63 6528 686c 622c 2073 7472 293a 0020  nce(hlb, str):. 
-00002310: 2020 2020 2020 2074 6578 7420 3d20 686c         text = hl
-00002320: 0020 2020 2065 6c69 6620 6973 696e 7374  .    elif isinst
-00002330: 616e 6365 2868 6c2c 2073 7472 293a 0020  ance(hl, str):. 
-00002340: 2020 2020 2020 2074 6578 7420 3d20 7074         text = pt
-00002350: 0020 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
-00002360: 6365 2870 742c 2073 7472 293a 0020 2020  ce(pt, str):.   
-00002370: 2000 2020 2020 686c 6120 3d20 6f70 696e   .    hla = opin
-00002380: 696f 6e2e 6874 6d6c 5f61 6e6f 6e5f 3230  ion.html_anon_20
-00002390: 3230 0020 2020 2078 6820 3d20 6f70 696e  20.    xh = opin
-000023a0: 696f 6e2e 786d 6c5f 6861 7276 6172 6400  ion.xml_harvard.
-000023b0: 2020 2020 686c 6320 3d20 6f70 696e 696f      hlc = opinio
-000023c0: 6e2e 6874 6d6c 5f63 6f6c 756d 6269 6100  n.html_columbia.
-000023d0: 2020 2020 686c 6220 3d20 6f70 696e 696f      hlb = opinio
-000023e0: 6e2e 6874 6d6c 5f6c 6177 626f 7800 2020  n.html_lawbox.  
-000023f0: 2020 686c 203d 206f 7069 6e69 6f6e 2e68    hl = opinion.h
-00002400: 746d 6c00 2020 2020 7074 203d 206f 7069  tml.    pt = opi
-00002410: 6e69 6f6e 2e70 6c61 696e 5f74 6578 7400  nion.plain_text.
-00002420: 2020 2020 7465 7874 203d 2027 2700 2020      text = ''.  
-00002430: 6465 6620 6765 745f 6f70 696e 696f 6e5f  def get_opinion_
-00002440: 7465 7874 2873 656c 662c 206f 7069 6e69  text(self, opini
-00002450: 6f6e 293a 0020 2023 2061 6363 6570 7473  on):.  # accepts
-00002460: 2061 2073 6572 6965 7320 2d2d 2061 2072   a series -- a r
-00002470: 6f77 2066 726f 6d20 6120 6461 7461 6672  ow from a datafr
-00002480: 616d 6500 2020 0020 2020 2072 6574 7572  ame.  .    retur
-00002490: 6e20 6466 2e6c 6f63 5b64 665b 636f 6c75  n df.loc[df[colu
-000024a0: 6d6e 5d20 3d3d 206d 6174 6368 5d00 2020  mn] == match].  
-000024b0: 6465 6620 6466 5f72 6f77 5f62 795f 7661  def df_row_by_va
-000024c0: 6c75 6528 7365 6c66 2c20 6466 2c20 636f  lue(self, df, co
-000024d0: 6c75 6d6e 2c20 6d61 7463 6829 3a00 0020  lumn, match):.. 
-000024e0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-000024f0: 636c 6965 6e74 0020 2064 6566 2067 6574  client.  def get
-00002500: 5f63 6c75 7374 6572 5f63 6c69 656e 7428  _cluster_client(
-00002510: 7365 6c66 293a 0020 2023 2067 6574 2063  self):.  # get c
-00002520: 6c75 7374 6572 2063 6c69 656e 7400 0020  luster client.. 
-00002530: 2020 2072 6574 7572 6e20 6466 0020 2020     return df.   
-00002540: 2070 7269 6e74 2866 277b 6669 6c65 6e61   print(f'{filena
-00002550: 6d65 7d20 7265 6164 2069 6e20 7b69 6e74  me} read in {int
-00002560: 2828 656e 642d 7374 6172 7429 2f36 3029  ((end-start)/60)
-00002570: 7d20 6d69 6e75 7465 7327 2900 2020 2020  } minutes').    
-00002580: 656e 6420 3d20 7469 6d65 2e70 6572 665f  end = time.perf_
-00002590: 636f 756e 7465 7228 2900 2020 2020 2020  counter().      
-000025a0: 2020 6466 203d 2070 642e 7265 6164 5f63    df = pd.read_c
-000025b0: 7376 2866 696c 656e 616d 652c 2064 7479  sv(filename, dty
-000025c0: 7065 3d64 7479 7065 2c20 7061 7273 655f  pe=dtype, parse_
-000025d0: 6461 7465 733d 7061 7273 655f 6461 7465  dates=parse_date
-000025e0: 732c 2075 7365 636f 6c73 3d75 7365 636f  s, usecols=useco
-000025f0: 6c73 2c20 696e 6465 785f 636f 6c3d 696e  ls, index_col=in
-00002600: 6465 785f 636f 6c29 0020 2020 2065 6c73  dex_col).    els
-00002610: 653a 0020 2020 2020 2020 2020 2020 2020  e:.             
-00002620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002630: 2020 2020 2020 2020 2020 6474 7970 653d            dtype=
-00002640: 6474 7970 652c 2070 6172 7365 5f64 6174  dtype, parse_dat
-00002650: 6573 3d70 6172 7365 5f64 6174 6573 2c20  es=parse_dates, 
-00002660: 7573 6563 6f6c 733d 7573 6563 6f6c 732c  usecols=usecols,
-00002670: 2069 6e64 6578 5f63 6f6c 3d69 6e64 6578   index_col=index
-00002680: 5f63 6f6c 2929 0020 2020 2020 2020 2064  _col)).        d
-00002690: 6620 3d20 7064 2e63 6f6e 6361 7428 7365  f = pd.concat(se
-000026a0: 6c66 2e72 6561 645f 6373 765f 6173 5f64  lf.read_csv_as_d
-000026b0: 6673 2866 696c 656e 616d 652c 206e 756d  fs(filename, num
-000026c0: 5f64 6673 3d31 302a 2a35 2c20 6d61 785f  _dfs=10**5, max_
-000026d0: 726f 7773 3d31 302a 2a37 2c20 0020 2020  rows=10**7, .   
-000026e0: 2069 6620 6669 6c65 5f73 697a 655f 6762   if file_size_gb
-000026f0: 203e 206d 6178 5f67 623a 0020 2020 2064   > max_gb:.    d
-00002700: 6620 3d20 4e6f 6e65 0020 2020 2070 7269  f = None.    pri
-00002710: 6e74 2822 4669 6c65 2053 697a 6520 6973  nt("File Size is
-00002720: 203a 222c 2066 696c 655f 7369 7a65 5f67   :", file_size_g
-00002730: 622c 2022 4742 2229 0020 2020 2070 7269  b, "GB").    pri
-00002740: 6e74 2866 2749 6d70 6f72 7469 6e67 207b  nt(f'Importing {
-00002750: 6669 6c65 6e61 6d65 7d20 6173 2061 2064  filename} as a d
-00002760: 6174 6166 7261 6d65 2729 0020 2020 2066  ataframe').    f
-00002770: 696c 655f 7369 7a65 5f67 6220 3d20 726f  ile_size_gb = ro
-00002780: 756e 6428 6669 6c65 5f73 697a 652f 3130  und(file_size/10
-00002790: 2a2a 392c 2032 2900 2020 2020 6669 6c65  **9, 2).    file
-000027a0: 5f73 697a 6520 3d20 6f73 2e70 6174 682e  _size = os.path.
-000027b0: 6765 7473 697a 6528 6669 6c65 6e61 6d65  getsize(filename
-000027c0: 2900 2020 2020 7374 6172 7420 3d20 7469  ).    start = ti
-000027d0: 6d65 2e70 6572 665f 636f 756e 7465 7228  me.perf_counter(
-000027e0: 2900 2020 6465 6620 6373 765f 746f 5f64  ).  def csv_to_d
-000027f0: 6628 7365 6c66 2c20 6669 6c65 6e61 6d65  f(self, filename
-00002800: 2c20 6474 7970 6520 3d20 4e6f 6e65 2c20  , dtype = None, 
-00002810: 7061 7273 655f 6461 7465 7320 3d20 4e6f  parse_dates = No
-00002820: 6e65 2c20 6d61 785f 6762 3d35 2c20 6e75  ne, max_gb=5, nu
-00002830: 6d5f 6466 733d 3130 2a2a 332c 2075 7365  m_dfs=10**3, use
-00002840: 636f 6c73 3d4e 6f6e 652c 2069 6e64 6578  cols=None, index
-00002850: 5f63 6f6c 3d4e 6f6e 6529 3a00 2020 2320  _col=None):.  # 
-00002860: 6765 7420 6120 706f 7465 6e74 6961 6c6c  get a potentiall
-00002870: 7920 6c61 7267 6520 6373 7620 616e 6420  y large csv and 
-00002880: 7475 726e 2069 7420 696e 746f 2061 2044  turn it into a D
-00002890: 6174 6146 7261 6d65 0000 2020 2020 7265  ataFrame..    re
-000028a0: 7475 726e 2064 6673 5f6f 7069 6e69 6f6e  turn dfs_opinion
-000028b0: 7300 2020 2020 2020 2020 636f 756e 7465  s.        counte
-000028c0: 7220 3d20 636f 756e 7465 7220 2b20 3100  r = counter + 1.
-000028d0: 2020 2020 2020 2020 6466 735f 6f70 696e          dfs_opin
-000028e0: 696f 6e73 2e61 7070 656e 6428 6466 2900  ions.append(df).
-000028f0: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-00002900: 6b00 2020 2020 2020 2020 6966 2063 6f75  k.        if cou
-00002910: 6e74 6572 203e 3d20 6e75 6d5f 6466 733a  nter >= num_dfs:
-00002920: 0020 2020 2020 2020 2020 2020 2020 2020  .               
-00002930: 2020 2020 2020 2020 2020 2070 6172 7365             parse
-00002940: 5f64 6174 6573 3d70 6172 7365 5f64 6174  _dates=parse_dat
-00002950: 6573 2c20 7573 6563 6f6c 733d 7573 6563  es, usecols=usec
-00002960: 6f6c 732c 2069 6e64 6578 5f63 6f6c 3d69  ols, index_col=i
-00002970: 6e64 6578 5f63 6f6c 293a 0020 2020 2066  ndex_col):.    f
-00002980: 6f72 2064 6620 696e 2070 642e 7265 6164  or df in pd.read
-00002990: 5f63 7376 2866 696c 656e 616d 652c 2063  _csv(filename, c
-000029a0: 6875 6e6b 7369 7a65 3d6d 6178 5f72 6f77  hunksize=max_row
-000029b0: 732c 2064 7479 7065 3d64 7479 7065 2c20  s, dtype=dtype, 
-000029c0: 0020 2020 2064 6673 5f6f 7069 6e69 6f6e  .    dfs_opinion
-000029d0: 7320 3d20 5b5d 0020 2020 2063 6f75 6e74  s = [].    count
-000029e0: 6572 203d 2030 0020 2020 2020 2020 2020  er = 0.         
-000029f0: 2020 2020 2020 2020 2020 293a 0020 2020            ):.   
-00002a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002a10: 2069 6e64 6578 5f63 6f6c 3d4e 6f6e 6500   index_col=None.
-00002a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002a30: 2020 2020 7573 6563 6f6c 733d 4e6f 6e65      usecols=None
-00002a40: 2c00 2020 2020 2020 2020 2020 2020 2020  ,.              
-00002a50: 2020 2020 2020 7061 7273 655f 6461 7465        parse_date
-00002a60: 733d 4e6f 6e65 2c00 2020 2020 2020 2020  s=None,.        
-00002a70: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
-00002a80: 653d 4e6f 6e65 2c20 0020 2020 2020 2020  e=None, .       
-00002a90: 2020 2020 2020 2020 2020 2020 206d 6178               max
-00002aa0: 5f72 6f77 733d 3130 2a2a 352c 2000 2020  _rows=10**5, .  
-00002ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002ac0: 2020 6e75 6d5f 6466 733d 3130 2c20 0020    num_dfs=10, . 
-00002ad0: 2064 6566 2072 6561 645f 6373 765f 6173   def read_csv_as
-00002ae0: 5f64 6673 2873 656c 662c 2066 696c 656e  _dfs(self, filen
-00002af0: 616d 652c 2000 2020 2020 0020 2020 204e  ame, .    .    N
-00002b00: 6f43 6170 286f 2c20 6f63 2c20 632c 2064  oCap(o, oc, c, d
-00002b10: 2c20 636d 292e 7374 6172 7428 2900 2020  , cm).start().  
-00002b20: 6465 6620 636c 6928 6f2c 206f 632c 2063  def cli(o, oc, c
-00002b30: 2c20 642c 2063 6d29 3a00 2020 4063 6c69  , d, cm):.  @cli
-00002b40: 636b 2e6f 7074 696f 6e28 272d 636d 272c  ck.option('-cm',
-00002b50: 2068 656c 703d 226c 6f63 616c 2070 6174   help="local pat
-00002b60: 6820 746f 2063 6974 6174 696f 6e20 6d61  h to citation ma
-00002b70: 7020 6669 6c65 222c 2072 6571 7569 7265  p file", require
-00002b80: 643d 5472 7565 2900 2020 4063 6c69 636b  d=True).  @click
-00002b90: 2e6f 7074 696f 6e28 272d 6427 2c20 6865  .option('-d', he
-00002ba0: 6c70 3d22 6c6f 6361 6c20 7061 7468 2074  lp="local path t
-00002bb0: 6f20 646f 636b 6574 7320 6669 6c65 222c  o dockets file",
-00002bc0: 2072 6571 7569 7265 643d 5472 7565 2900   required=True).
-00002bd0: 2020 4063 6c69 636b 2e6f 7074 696f 6e28    @click.option(
-00002be0: 272d 6327 2c20 6865 6c70 3d22 6c6f 6361  '-c', help="loca
-00002bf0: 6c20 7061 7468 2074 6f20 636f 7572 7473  l path to courts
-00002c00: 2066 696c 6520 222c 2072 6571 7569 7265   file ", require
-00002c10: 643d 5472 7565 2900 2020 4063 6c69 636b  d=True).  @click
-00002c20: 2e6f 7074 696f 6e28 272d 6f63 272c 2068  .option('-oc', h
-00002c30: 656c 703d 226c 6f63 616c 2070 6174 6820  elp="local path 
-00002c40: 746f 206f 7069 6e69 6f6e 2063 6c75 7374  to opinion clust
-00002c50: 6572 7320 6669 6c65 222c 2072 6571 7569  ers file", requi
-00002c60: 7265 643d 5472 7565 2900 2020 4063 6c69  red=True).  @cli
-00002c70: 636b 2e6f 7074 696f 6e28 272d 6f27 2c20  ck.option('-o', 
-00002c80: 6865 6c70 3d22 6c6f 6361 6c20 7061 7468  help="local path
-00002c90: 2074 6f20 6f70 696e 696f 6e73 2066 696c   to opinions fil
-00002ca0: 6522 2c20 7265 7175 6972 6564 3d54 7275  e", required=Tru
-00002cb0: 6529 0020 2040 636c 6963 6b2e 636f 6d6d  e).  @click.comm
-00002cc0: 616e 6428 2920 2000 0020 2020 2073 656c  and()  ..    sel
-00002cd0: 662e 4461 7461 4672 616d 6520 3d20 7064  f.DataFrame = pd
-00002ce0: 2e63 6f72 652e 6672 616d 652e 4461 7461  .core.frame.Data
-00002cf0: 4672 616d 6500 2020 2020 2373 656c 662e  Frame.    #self.
-00002d00: 5f64 665f 6f70 696e 696f 6e73 203d 2073  _df_opinions = s
-00002d10: 656c 662e 696e 6974 5f6f 7069 6e69 6f6e  elf.init_opinion
-00002d20: 735f 6466 2829 0000 2020 2020 7365 6c66  s_df()..    self
-00002d30: 2e5f 6466 5f64 6f63 6b65 7473 203d 2073  ._df_dockets = s
-00002d40: 656c 662e 696e 6974 5f64 6f63 6b65 7473  elf.init_dockets
-00002d50: 5f64 6628 2900 2020 2020 7365 6c66 2e5f  _df().    self._
-00002d60: 6466 5f63 6974 6174 696f 6e20 3d20 7365  df_citation = se
-00002d70: 6c66 2e69 6e69 745f 6369 7461 7469 6f6e  lf.init_citation
-00002d80: 5f64 6628 2900 2020 2020 7365 6c66 2e5f  _df().    self._
-00002d90: 6466 5f6f 7069 6e69 6f6e 5f63 6c75 7374  df_opinion_clust
-00002da0: 6572 7320 3d20 7365 6c66 2e69 6e69 745f  ers = self.init_
-00002db0: 6f70 696e 696f 6e5f 636c 7573 7465 7273  opinion_clusters
-00002dc0: 5f64 6628 2900 2020 2020 7365 6c66 2e5f  _df().    self._
-00002dd0: 6466 5f63 6f75 7274 7320 3d20 7365 6c66  df_courts = self
-00002de0: 2e69 6e69 745f 636f 7572 7473 5f64 6628  .init_courts_df(
-00002df0: 2900 0020 2020 2073 656c 662e 5f63 6974  )..    self._cit
-00002e00: 6174 696f 6e5f 666e 203d 2063 6974 6174  ation_fn = citat
-00002e10: 696f 6e5f 666e 0020 2020 2073 656c 662e  ion_fn.    self.
-00002e20: 5f64 6f63 6b65 7473 5f66 6e20 3d20 646f  _dockets_fn = do
-00002e30: 636b 6574 735f 666e 0020 2020 2073 656c  ckets_fn.    sel
-00002e40: 662e 5f63 6f75 7274 735f 666e 203d 2063  f._courts_fn = c
-00002e50: 6f75 7274 735f 666e 0020 2020 2073 656c  ourts_fn.    sel
-00002e60: 662e 5f6f 7069 6e69 6f6e 5f63 6c75 7374  f._opinion_clust
-00002e70: 6572 735f 666e 203d 206f 7069 6e69 6f6e  ers_fn = opinion
-00002e80: 5f63 6c75 7374 6572 735f 666e 0020 2020  _clusters_fn.   
-00002e90: 2073 656c 662e 5f6f 7069 6e69 6f6e 735f   self._opinions_
-00002ea0: 666e 203d 206f 7069 6e69 6f6e 735f 666e  fn = opinions_fn
-00002eb0: 0020 2064 6566 205f 5f69 6e69 745f 5f28  .  def __init__(
-00002ec0: 7365 6c66 2c20 6f70 696e 696f 6e73 5f66  self, opinions_f
-00002ed0: 6e2c 206f 7069 6e69 6f6e 5f63 6c75 7374  n, opinion_clust
-00002ee0: 6572 735f 666e 2c20 636f 7572 7473 5f66  ers_fn, courts_f
-00002ef0: 6e2c 2064 6f63 6b65 7473 5f66 6e2c 2063  n, dockets_fn, c
-00002f00: 6974 6174 696f 6e5f 666e 293a 0063 6c61  itation_fn):.cla
-00002f10: 7373 204e 6f43 6170 3a00 0069 6d70 6f72  ss NoCap:..impor
-00002f20: 7420 7265 0069 6d70 6f72 7420 636c 6963  t re.import clic
-00002f30: 6b00 696d 706f 7274 206f 7300 696d 706f  k.import os.impo
-00002f40: 7274 2074 696d 6569 7400 696d 706f 7274  rt timeit.import
-00002f50: 2074 696d 6500 696d 706f 7274 206d 756c   time.import mul
-00002f60: 7469 7072 6f63 6573 7369 6e67 2061 7320  tiprocessing as 
-00002f70: 6d70 0069 6d70 6f72 7420 6461 736b 2e64  mp.import dask.d
-00002f80: 6174 6166 7261 6d65 2061 7320 6464 0066  ataframe as dd.f
-00002f90: 726f 6d20 6461 736b 2e64 6973 7472 6962  rom dask.distrib
-00002fa0: 7574 6564 2069 6d70 6f72 7420 436c 6965  uted import Clie
-00002fb0: 6e74 2c20 7072 6f67 7265 7373 0069 6d70  nt, progress.imp
-00002fc0: 6f72 7420 6461 736b 0069 6d70 6f72 7420  ort dask.import 
-00002fd0: 6e75 6d70 7920 6173 206e 7000 696d 706f  numpy as np.impo
+00002000: 6164 0000 e60d 0000 560e 0000 0010 0000  ad......V.......
+00002010: 1500 0000 0000 0000 f00f 0000 dc0f 0000  ................
+00002020: b40f 0000 a10f 0000 950f 0000 7f0f 0000  ................
+00002030: 510f 0000 350f 0000 0b0f 0000 ee0e 0000  Q...5...........
+00002040: e20e 0000 d40e 0000 ca0e 0000 bd0e 0000  ................
+00002050: b30e 0000 a40e 0000 8a0e 0000 6e0e 0000  ............n...
+00002060: 620e 0000 570e 0000 560e 0000 c80d 0000  b...W...V.......
+00002070: 9c0d 0000 5c0d 0000 2c0d 0000 fe0c 0000  ....\...,.......
+00002080: fd0c 0000 cc0c 0000 9f0c 0000 9e0c 0000  ................
+00002090: 890c 0000 400c 0000 ee0b 0000 a60b 0000  ....@...........
+000020a0: 5e0b 0000 100b 0000 f40a 0000 d10a 0000  ^...............
+000020b0: cc0a 0000 a50a 0000 840a 0000 5f0a 0000  ............_...
+000020c0: 3e0a 0000 180a 0000 f609 0000 d309 0000  >...............
+000020d0: bd09 0000 ad09 0000 9709 0000 5109 0000  ............Q...
+000020e0: f708 0000 d808 0000 c608 0000 a608 0000  ................
+000020f0: 8808 0000 7008 0000 6f08 0000 3208 0000  ....p...o...2...
+00002100: b807 0000 9807 0000 6e07 0000 4107 0000  ........n...A...
+00002110: 0f07 0000 df06 0000 d106 0000 b306 0000  ................
+00002120: 5d06 0000 e905 0000 df05 0000 7005 0000  ]...........p...
+00002130: 5205 0000 1305 0000 0505 0000 0405 0000  R...............
+00002140: ed04 0000 cd04 0000 b504 0000 b404 0000  ................
+00002150: 8404 0000 5d04 0000 5a04 0000 2b04 0000  ....]...Z...+...
+00002160: 0404 0000 f603 0000 d703 0000 be03 0000  ................
+00002170: 9d03 0000 7a03 0000 5a03 0000 3603 0000  ....z...Z...6...
+00002180: 3103 0000 1503 0000 0303 0000 e502 0000  1...............
+00002190: d302 0000 b402 0000 a102 0000 8202 0000  ................
+000021a0: 6e02 0000 5002 0000 3d02 0000 1e02 0000  n...P...=.......
+000021b0: 0b02 0000 fb01 0000 fa01 0000 c501 0000  ................
+000021c0: ed01 0000 0020 2064 6566 2067 6574 5f63  .....  def get_c
+000021d0: 6974 6174 696f 6e73 2873 656c 662c 206f  itations(self, o
+000021e0: 7069 6e69 6f6e 5f69 642c 2064 665f 6369  pinion_id, df_ci
+000021f0: 7461 7469 6f6e 7329 3a00 0020 2020 2072  tations):..    r
+00002200: 6574 7572 6e20 7465 7874 0020 2020 2020  eturn text.     
+00002210: 2020 2074 6578 7420 3d20 686c 6100 2020     text = hla.  
+00002220: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+00002230: 6528 686c 612c 2073 7472 293a 0020 2020  e(hla, str):.   
+00002240: 2020 2020 2074 6578 7420 3d20 7868 2000       text = xh .
+00002250: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00002260: 6e63 6528 7868 2c20 7374 7229 3a00 2020  nce(xh, str):.  
+00002270: 2020 2020 2020 7465 7874 203d 2068 6c63        text = hlc
+00002280: 2000 2020 2020 656c 6966 2069 7369 6e73   .    elif isins
+00002290: 7461 6e63 6528 686c 632c 2073 7472 293a  tance(hlc, str):
+000022a0: 0020 2020 2020 2020 2074 6578 7420 3d20  .        text = 
+000022b0: 686c 6200 2020 2020 656c 6966 2069 7369  hlb.    elif isi
+000022c0: 6e73 7461 6e63 6528 686c 622c 2073 7472  nstance(hlb, str
+000022d0: 293a 0020 2020 2020 2020 2074 6578 7420  ):.        text 
+000022e0: 3d20 686c 0020 2020 2065 6c69 6620 6973  = hl.    elif is
+000022f0: 696e 7374 616e 6365 2868 6c2c 2073 7472  instance(hl, str
+00002300: 293a 0020 2020 2020 2020 2074 6578 7420  ):.        text 
+00002310: 3d20 7074 0020 2020 2069 6620 6973 696e  = pt.    if isin
+00002320: 7374 616e 6365 2870 742c 2073 7472 293a  stance(pt, str):
+00002330: 0020 2020 2000 2020 2020 686c 6120 3d20  .    .    hla = 
+00002340: 6f70 696e 696f 6e5b 2768 746d 6c5f 616e  opinion['html_an
+00002350: 6f6e 5f32 3032 3027 5d00 2020 2020 7868  on_2020'].    xh
+00002360: 203d 206f 7069 6e69 6f6e 5b27 786d 6c5f   = opinion['xml_
+00002370: 6861 7276 6172 6427 5d00 2020 2020 686c  harvard'].    hl
+00002380: 6320 3d20 6f70 696e 696f 6e5b 2768 746d  c = opinion['htm
+00002390: 6c5f 636f 6c75 6d62 6961 275d 0020 2020  l_columbia'].   
+000023a0: 2068 6c62 203d 206f 7069 6e69 6f6e 5b27   hlb = opinion['
+000023b0: 6874 6d6c 5f6c 6177 626f 7827 5d00 2020  html_lawbox'].  
+000023c0: 2020 686c 203d 206f 7069 6e69 6f6e 5b27    hl = opinion['
+000023d0: 6874 6d6c 275d 0020 2020 2070 7420 3d20  html'].    pt = 
+000023e0: 6f70 696e 696f 6e5b 2770 6c61 696e 5f74  opinion['plain_t
+000023f0: 6578 7427 5d00 2020 2020 7465 7874 203d  ext'].    text =
+00002400: 2027 2700 2020 6465 6620 6765 745f 6f70   ''.  def get_op
+00002410: 696e 696f 6e5f 7465 7874 2873 656c 662c  inion_text(self,
+00002420: 206f 7069 6e69 6f6e 293a 0020 2023 2061   opinion):.  # a
+00002430: 6363 6570 7473 2061 2073 6572 6965 7320  ccepts a series 
+00002440: 2d2d 2061 2072 6f77 2066 726f 6d20 6120  -- a row from a 
+00002450: 6461 7461 6672 616d 6500 2020 0020 2020  dataframe.  .   
+00002460: 2072 6574 7572 6e20 6466 2e6c 6f63 5b64   return df.loc[d
+00002470: 665b 636f 6c75 6d6e 5d20 3d3d 206d 6174  f[column] == mat
+00002480: 6368 5d00 2020 6465 6620 6466 5f72 6f77  ch].  def df_row
+00002490: 5f62 795f 7661 6c75 6528 7365 6c66 2c20  _by_value(self, 
+000024a0: 6466 2c20 636f 6c75 6d6e 2c20 6d61 7463  df, column, matc
+000024b0: 6829 3a00 0020 2020 2072 6574 7572 6e20  h):..    return 
+000024c0: 7365 6c66 2e5f 636c 6965 6e74 0020 2064  self._client.  d
+000024d0: 6566 2067 6574 5f63 6c75 7374 6572 5f63  ef get_cluster_c
+000024e0: 6c69 656e 7428 7365 6c66 293a 0020 2023  lient(self):.  #
+000024f0: 2067 6574 2063 6c75 7374 6572 2063 6c69   get cluster cli
+00002500: 656e 7400 0020 2020 2072 6574 7572 6e20  ent..    return 
+00002510: 6466 0020 2020 2070 7269 6e74 2866 277b  df.    print(f'{
+00002520: 6669 6c65 6e61 6d65 7d20 7265 6164 2069  filename} read i
+00002530: 6e20 7b69 6e74 2828 656e 642d 7374 6172  n {int((end-star
+00002540: 7429 2f36 3029 7d20 6d69 6e75 7465 7327  t)/60)} minutes'
+00002550: 2900 2020 2020 656e 6420 3d20 7469 6d65  ).    end = time
+00002560: 2e70 6572 665f 636f 756e 7465 7228 2900  .perf_counter().
+00002570: 2020 2020 2020 2020 6466 203d 2070 642e          df = pd.
+00002580: 7265 6164 5f63 7376 2866 696c 656e 616d  read_csv(filenam
+00002590: 652c 2064 7479 7065 3d64 7479 7065 2c20  e, dtype=dtype, 
+000025a0: 7061 7273 655f 6461 7465 733d 7061 7273  parse_dates=pars
+000025b0: 655f 6461 7465 732c 2075 7365 636f 6c73  e_dates, usecols
+000025c0: 3d75 7365 636f 6c73 2c20 696e 6465 785f  =usecols, index_
+000025d0: 636f 6c3d 696e 6465 785f 636f 6c29 0020  col=index_col). 
+000025e0: 2020 2065 6c73 653a 0020 2020 2020 2020     else:.       
+000025f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002610: 6474 7970 653d 6474 7970 652c 2070 6172  dtype=dtype, par
+00002620: 7365 5f64 6174 6573 3d70 6172 7365 5f64  se_dates=parse_d
+00002630: 6174 6573 2c20 7573 6563 6f6c 733d 7573  ates, usecols=us
+00002640: 6563 6f6c 732c 2069 6e64 6578 5f63 6f6c  ecols, index_col
+00002650: 3d69 6e64 6578 5f63 6f6c 2929 0020 2020  =index_col)).   
+00002660: 2020 2020 2064 6620 3d20 7064 2e63 6f6e       df = pd.con
+00002670: 6361 7428 7365 6c66 2e72 6561 645f 6373  cat(self.read_cs
+00002680: 765f 6173 5f64 6673 2866 696c 656e 616d  v_as_dfs(filenam
+00002690: 652c 206e 756d 5f64 6673 3d31 302a 2a35  e, num_dfs=10**5
+000026a0: 2c20 6d61 785f 726f 7773 3d31 302a 2a37  , max_rows=10**7
+000026b0: 2c20 0020 2020 2069 6620 6669 6c65 5f73  , .    if file_s
+000026c0: 697a 655f 6762 203e 206d 6178 5f67 623a  ize_gb > max_gb:
+000026d0: 0020 2020 2064 6620 3d20 4e6f 6e65 0020  .    df = None. 
+000026e0: 2020 2070 7269 6e74 2822 4669 6c65 2053     print("File S
+000026f0: 697a 6520 6973 203a 222c 2066 696c 655f  ize is :", file_
+00002700: 7369 7a65 5f67 622c 2022 4742 2229 0020  size_gb, "GB"). 
+00002710: 2020 2070 7269 6e74 2866 2749 6d70 6f72     print(f'Impor
+00002720: 7469 6e67 207b 6669 6c65 6e61 6d65 7d20  ting {filename} 
+00002730: 6173 2061 2064 6174 6166 7261 6d65 2729  as a dataframe')
+00002740: 0020 2020 2066 696c 655f 7369 7a65 5f67  .    file_size_g
+00002750: 6220 3d20 726f 756e 6428 6669 6c65 5f73  b = round(file_s
+00002760: 697a 652f 3130 2a2a 392c 2032 2900 2020  ize/10**9, 2).  
+00002770: 2020 6669 6c65 5f73 697a 6520 3d20 6f73    file_size = os
+00002780: 2e70 6174 682e 6765 7473 697a 6528 6669  .path.getsize(fi
+00002790: 6c65 6e61 6d65 2900 2020 2020 7374 6172  lename).    star
+000027a0: 7420 3d20 7469 6d65 2e70 6572 665f 636f  t = time.perf_co
+000027b0: 756e 7465 7228 2900 2020 6465 6620 6373  unter().  def cs
+000027c0: 765f 746f 5f64 6628 7365 6c66 2c20 6669  v_to_df(self, fi
+000027d0: 6c65 6e61 6d65 2c20 6474 7970 6520 3d20  lename, dtype = 
+000027e0: 4e6f 6e65 2c20 7061 7273 655f 6461 7465  None, parse_date
+000027f0: 7320 3d20 4e6f 6e65 2c20 6d61 785f 6762  s = None, max_gb
+00002800: 3d35 2c20 6e75 6d5f 6466 733d 3130 2a2a  =5, num_dfs=10**
+00002810: 332c 2075 7365 636f 6c73 3d4e 6f6e 652c  3, usecols=None,
+00002820: 2069 6e64 6578 5f63 6f6c 3d4e 6f6e 6529   index_col=None)
+00002830: 3a00 2020 2320 6765 7420 6120 706f 7465  :.  # get a pote
+00002840: 6e74 6961 6c6c 7920 6c61 7267 6520 6373  ntially large cs
+00002850: 7620 616e 6420 7475 726e 2069 7420 696e  v and turn it in
+00002860: 746f 2061 2044 6174 6146 7261 6d65 0000  to a DataFrame..
+00002870: 2020 2020 7265 7475 726e 2064 6673 5f6f      return dfs_o
+00002880: 7069 6e69 6f6e 7300 2020 2020 2020 2020  pinions.        
+00002890: 636f 756e 7465 7220 3d20 636f 756e 7465  counter = counte
+000028a0: 7220 2b20 3100 2020 2020 2020 2020 6466  r + 1.        df
+000028b0: 735f 6f70 696e 696f 6e73 2e61 7070 656e  s_opinions.appen
+000028c0: 6428 6466 2900 2020 2020 2020 2020 2020  d(df).          
+000028d0: 2020 6272 6561 6b00 2020 2020 2020 2020    break.        
+000028e0: 6966 2063 6f75 6e74 6572 203e 3d20 6e75  if counter >= nu
+000028f0: 6d5f 6466 733a 0020 2020 2020 2020 2020  m_dfs:.         
+00002900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002910: 2070 6172 7365 5f64 6174 6573 3d70 6172   parse_dates=par
+00002920: 7365 5f64 6174 6573 2c20 7573 6563 6f6c  se_dates, usecol
+00002930: 733d 7573 6563 6f6c 732c 2069 6e64 6578  s=usecols, index
+00002940: 5f63 6f6c 3d69 6e64 6578 5f63 6f6c 293a  _col=index_col):
+00002950: 0020 2020 2066 6f72 2064 6620 696e 2070  .    for df in p
+00002960: 642e 7265 6164 5f63 7376 2866 696c 656e  d.read_csv(filen
+00002970: 616d 652c 2063 6875 6e6b 7369 7a65 3d6d  ame, chunksize=m
+00002980: 6178 5f72 6f77 732c 2064 7479 7065 3d64  ax_rows, dtype=d
+00002990: 7479 7065 2c20 0020 2020 2064 6673 5f6f  type, .    dfs_o
+000029a0: 7069 6e69 6f6e 7320 3d20 5b5d 0020 2020  pinions = [].   
+000029b0: 2063 6f75 6e74 6572 203d 2030 0020 2020   counter = 0.   
+000029c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000029d0: 293a 0020 2020 2020 2020 2020 2020 2020  ):.             
+000029e0: 2020 2020 2020 2069 6e64 6578 5f63 6f6c         index_col
+000029f0: 3d4e 6f6e 6500 2020 2020 2020 2020 2020  =None.          
+00002a00: 2020 2020 2020 2020 2020 7573 6563 6f6c            usecol
+00002a10: 733d 4e6f 6e65 2c00 2020 2020 2020 2020  s=None,.        
+00002a20: 2020 2020 2020 2020 2020 2020 7061 7273              pars
+00002a30: 655f 6461 7465 733d 4e6f 6e65 2c00 2020  e_dates=None,.  
+00002a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002a50: 2020 6474 7970 653d 4e6f 6e65 2c20 0020    dtype=None, . 
+00002a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002a70: 2020 206d 6178 5f72 6f77 733d 3130 2a2a     max_rows=10**
+00002a80: 352c 2000 2020 2020 2020 2020 2020 2020  5, .            
+00002a90: 2020 2020 2020 2020 6e75 6d5f 6466 733d          num_dfs=
+00002aa0: 3130 2c20 0020 2064 6566 2072 6561 645f  10, .  def read_
+00002ab0: 6373 765f 6173 5f64 6673 2873 656c 662c  csv_as_dfs(self,
+00002ac0: 2066 696c 656e 616d 652c 2000 2020 2020   filename, .    
+00002ad0: 0020 2020 204e 6f43 6170 286f 2c20 6f63  .    NoCap(o, oc
+00002ae0: 2c20 632c 2064 2c20 636d 292e 7374 6172  , c, d, cm).star
+00002af0: 7428 2900 2020 6465 6620 636c 6928 6f2c  t().  def cli(o,
+00002b00: 206f 632c 2063 2c20 642c 2063 6d29 3a00   oc, c, d, cm):.
+00002b10: 2020 4063 6c69 636b 2e6f 7074 696f 6e28    @click.option(
+00002b20: 272d 636d 272c 2068 656c 703d 226c 6f63  '-cm', help="loc
+00002b30: 616c 2070 6174 6820 746f 2063 6974 6174  al path to citat
+00002b40: 696f 6e20 6d61 7020 6669 6c65 222c 2072  ion map file", r
+00002b50: 6571 7569 7265 643d 5472 7565 2900 2020  equired=True).  
+00002b60: 4063 6c69 636b 2e6f 7074 696f 6e28 272d  @click.option('-
+00002b70: 6427 2c20 6865 6c70 3d22 6c6f 6361 6c20  d', help="local 
+00002b80: 7061 7468 2074 6f20 646f 636b 6574 7320  path to dockets 
+00002b90: 6669 6c65 222c 2072 6571 7569 7265 643d  file", required=
+00002ba0: 5472 7565 2900 2020 4063 6c69 636b 2e6f  True).  @click.o
+00002bb0: 7074 696f 6e28 272d 6327 2c20 6865 6c70  ption('-c', help
+00002bc0: 3d22 6c6f 6361 6c20 7061 7468 2074 6f20  ="local path to 
+00002bd0: 636f 7572 7473 2066 696c 6520 222c 2072  courts file ", r
+00002be0: 6571 7569 7265 643d 5472 7565 2900 2020  equired=True).  
+00002bf0: 4063 6c69 636b 2e6f 7074 696f 6e28 272d  @click.option('-
+00002c00: 6f63 272c 2068 656c 703d 226c 6f63 616c  oc', help="local
+00002c10: 2070 6174 6820 746f 206f 7069 6e69 6f6e   path to opinion
+00002c20: 2063 6c75 7374 6572 7320 6669 6c65 222c   clusters file",
+00002c30: 2072 6571 7569 7265 643d 5472 7565 2900   required=True).
+00002c40: 2020 4063 6c69 636b 2e6f 7074 696f 6e28    @click.option(
+00002c50: 272d 6f27 2c20 6865 6c70 3d22 6c6f 6361  '-o', help="loca
+00002c60: 6c20 7061 7468 2074 6f20 6f70 696e 696f  l path to opinio
+00002c70: 6e73 2066 696c 6522 2c20 7265 7175 6972  ns file", requir
+00002c80: 6564 3d54 7275 6529 0020 2040 636c 6963  ed=True).  @clic
+00002c90: 6b2e 636f 6d6d 616e 6428 2920 2000 0020  k.command()  .. 
+00002ca0: 2020 2073 656c 662e 4461 7461 4672 616d     self.DataFram
+00002cb0: 6520 3d20 7064 2e63 6f72 652e 6672 616d  e = pd.core.fram
+00002cc0: 652e 4461 7461 4672 616d 6500 2020 2020  e.DataFrame.    
+00002cd0: 2373 656c 662e 5f64 665f 6f70 696e 696f  #self._df_opinio
+00002ce0: 6e73 203d 2073 656c 662e 696e 6974 5f6f  ns = self.init_o
+00002cf0: 7069 6e69 6f6e 735f 6466 2829 0000 2020  pinions_df()..  
+00002d00: 2020 7365 6c66 2e5f 6466 5f64 6f63 6b65    self._df_docke
+00002d10: 7473 203d 2073 656c 662e 696e 6974 5f64  ts = self.init_d
+00002d20: 6f63 6b65 7473 5f64 6628 2900 2020 2020  ockets_df().    
+00002d30: 7365 6c66 2e5f 6466 5f63 6974 6174 696f  self._df_citatio
+00002d40: 6e20 3d20 7365 6c66 2e69 6e69 745f 6369  n = self.init_ci
+00002d50: 7461 7469 6f6e 5f64 6628 2900 2020 2020  tation_df().    
+00002d60: 7365 6c66 2e5f 6466 5f6f 7069 6e69 6f6e  self._df_opinion
+00002d70: 5f63 6c75 7374 6572 7320 3d20 7365 6c66  _clusters = self
+00002d80: 2e69 6e69 745f 6f70 696e 696f 6e5f 636c  .init_opinion_cl
+00002d90: 7573 7465 7273 5f64 6628 2900 2020 2020  usters_df().    
+00002da0: 7365 6c66 2e5f 6466 5f63 6f75 7274 7320  self._df_courts 
+00002db0: 3d20 7365 6c66 2e69 6e69 745f 636f 7572  = self.init_cour
+00002dc0: 7473 5f64 6628 2900 0020 2020 2073 656c  ts_df()..    sel
+00002dd0: 662e 5f63 6974 6174 696f 6e5f 666e 203d  f._citation_fn =
+00002de0: 2063 6974 6174 696f 6e5f 666e 0020 2020   citation_fn.   
+00002df0: 2073 656c 662e 5f64 6f63 6b65 7473 5f66   self._dockets_f
+00002e00: 6e20 3d20 646f 636b 6574 735f 666e 0020  n = dockets_fn. 
+00002e10: 2020 2073 656c 662e 5f63 6f75 7274 735f     self._courts_
+00002e20: 666e 203d 2063 6f75 7274 735f 666e 0020  fn = courts_fn. 
+00002e30: 2020 2073 656c 662e 5f6f 7069 6e69 6f6e     self._opinion
+00002e40: 5f63 6c75 7374 6572 735f 666e 2000 6366  _clusters_fn .cf
+00002e50: 672e 7365 7428 0069 6d70 6f72 7420 6373  g.set(.import cs
+00002e60: 7600 696d 706f 7274 206a 736f 6e00 6c6f  v.import json.lo
+00002e70: 672e 7365 744c 6576 656c 286c 6f67 6769  g.setLevel(loggi
+00002e80: 6e67 2e44 4542 5547 2900 6c6f 6720 3d20  ng.DEBUG).log = 
+00002e90: 6c6f 6767 696e 672e 6765 744c 6f67 6765  logging.getLogge
+00002ea0: 7228 2900 696d 706f 7274 206c 6f67 6769  r().import loggi
+00002eb0: 6e67 0069 6d70 6f72 7420 7265 0069 6d70  ng.import re.imp
+00002ec0: 6f72 7420 636c 6963 6b00 696d 706f 7274  ort click.import
+00002ed0: 206f 7300 696d 706f 7274 2074 696d 6569   os.import timei
+00002ee0: 7400 696d 706f 7274 2074 696d 6500 696d  t.import time.im
+00002ef0: 706f 7274 206d 756c 7469 7072 6f63 6573  port multiproces
+00002f00: 7369 6e67 2061 7320 6d70 0066 726f 6d20  sing as mp.from 
+00002f10: 6461 736b 2e64 6973 7472 6962 7574 6564  dask.distributed
+00002f20: 2069 6d70 6f72 7420 6173 5f63 6f6d 706c   import as_compl
+00002f30: 6574 6564 0069 6d70 6f72 7420 6461 736b  eted.import dask
+00002f40: 2e64 6174 6166 7261 6d65 2061 7320 6464  .dataframe as dd
+00002f50: 0066 726f 6d20 6461 736b 2e64 6973 7472  .from dask.distr
+00002f60: 6962 7574 6564 2069 6d70 6f72 7420 436c  ibuted import Cl
+00002f70: 6965 6e74 2c20 7072 6f67 7265 7373 0069  ient, progress.i
+00002f80: 6d70 6f72 7420 6461 736b 2e62 6167 2061  mport dask.bag a
+00002f90: 7320 6462 0069 6d70 6f72 7420 6461 736b  s db.import dask
+00002fa0: 0069 6d70 6f72 7420 6e75 6d70 7920 6173  .import numpy as
+00002fb0: 206e 7000 6672 6f6d 2070 616e 6461 732e   np.from pandas.
+00002fc0: 5f6c 6962 732e 6d69 7373 696e 6720 696d  _libs.missing im
+00002fd0: 706f 7274 204e 4154 7970 6500 696d 706f  port NAType.impo
 00002fe0: 7274 2070 616e 6461 7320 6173 2070 6400  rt pandas as pd.
 00002ff0: 2321 2f75 7372 2f62 696e 2f65 6e76 2000  #!/usr/bin/env .
-00003000: 6164 0000 5c04 0000 c805 0000 0010 0000  ad..\...........
-00003010: 5400 0000 0000 0000 c40f 0000 8f0f 0000  T...............
-00003020: 650f 0000 2c0f 0000 0c0f 0000 ed0e 0000  e...,...........
-00003030: b40e 0000 710e 0000 510e 0000 2f0e 0000  ....q...Q.../...
-00003040: f80d 0000 dd0d 0000 a40d 0000 790d 0000  ............y...
-00003050: 6b0d 0000 610d 0000 5b0d 0000 4c0d 0000  k...a...[...L...
-00003060: 4b0d 0000 300d 0000 270d 0000 150d 0000  K...0...'.......
-00003070: fb0c 0000 df0c 0000 c50c 0000 aa0c 0000  ................
-00003080: 900c 0000 7c0c 0000 610c 0000 440c 0000  ....|...a...D...
-00003090: 270c 0000 130c 0000 d60b 0000 c20b 0000  '...............
-000030a0: b40b 0000 b30b 0000 8f0b 0000 7e0b 0000  ............~...
-000030b0: 590b 0000 3d0b 0000 090b 0000 ec0a 0000  Y...=...........
-000030c0: c90a 0000 c40a 0000 b10a 0000 910a 0000  ................
-000030d0: 7f0a 0000 680a 0000 460a 0000 270a 0000  ....h...F...'...
-000030e0: 080a 0000 ef09 0000 cf09 0000 ad09 0000  ................
-000030f0: 8a09 0000 6209 0000 4409 0000 3e09 0000  ....b...D...>...
-00003100: 2e09 0000 1d09 0000 0109 0000 e808 0000  ................
-00003110: cf08 0000 b508 0000 9c08 0000 8908 0000  ................
-00003120: 6f08 0000 5308 0000 3608 0000 1308 0000  o...S...6.......
-00003130: 0708 0000 d407 0000 a707 0000 6c07 0000  ............l...
-00003140: 3c07 0000 eb06 0000 7006 0000 4c06 0000  <.......p...L...
-00003150: 2a06 0000 0c06 0000 f205 0000 f105 0000  *...............
-00003160: d605 0000 c805 0000 a105 0000 9505 0000  ................
-00003170: e005 0000 7105 0000 6a05 0000 0000 0000  ....q...j.......
-00003180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003000: 6164 0000 e500 0000 7902 0000 0010 0000  ad......y.......
+00003010: 5e00 0000 0000 0000 f30f 0000 970f 0000  ^...............
+00003020: 790f 0000 550f 0000 210f 0000 010f 0000  y...U...!.......
+00003030: df0e 0000 bb0e 0000 ba0e 0000 8e0e 0000  ................
+00003040: 4e0e 0000 1e0e 0000 d50d 0000 d40d 0000  N...............
+00003050: a30d 0000 760d 0000 750d 0000 600d 0000  ....v...u...`...
+00003060: 170d 0000 c50c 0000 7d0c 0000 350c 0000  ........}...5...
+00003070: e70b 0000 cb0b 0000 a80b 0000 a30b 0000  ................
+00003080: 7c0b 0000 5b0b 0000 360b 0000 150b 0000  |...[...6.......
+00003090: ef0a 0000 cd0a 0000 aa0a 0000 940a 0000  ................
+000030a0: 840a 0000 6e0a 0000 280a 0000 ce09 0000  ....n...(.......
+000030b0: af09 0000 9d09 0000 7d09 0000 5f09 0000  ........}..._...
+000030c0: 4709 0000 4609 0000 0909 0000 8f08 0000  G...F...........
+000030d0: 6f08 0000 4508 0000 1808 0000 e207 0000  o...E...........
+000030e0: af07 0000 9c07 0000 8e07 0000 7007 0000  ............p...
+000030f0: 1a07 0000 a606 0000 9c06 0000 2d06 0000  ............-...
+00003100: 0f06 0000 c705 0000 b905 0000 b805 0000  ................
+00003110: a105 0000 8105 0000 6905 0000 6805 0000  ........i...h...
+00003120: 3805 0000 1105 0000 0e05 0000 df04 0000  8...............
+00003130: b804 0000 aa04 0000 8b04 0000 7204 0000  ............r...
+00003140: 5104 0000 2e04 0000 0e04 0000 ea03 0000  Q...............
+00003150: e503 0000 c903 0000 b703 0000 9903 0000  ................
+00003160: 8703 0000 6803 0000 5503 0000 3603 0000  ....h...U...6...
+00003170: 2203 0000 0403 0000 f102 0000 d202 0000  "...............
+00003180: bf02 0000 af02 0000 ae02 0000 7902 0000  ............y...
+00003190: 8902 0000 9202 0000 5e02 0000 3f02 0000  ........^...?...
 000031a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000031b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000031c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000031d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000031e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000031f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000032a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000032b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000032c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000032d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000032e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000032f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000033a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000033b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000033c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000033d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000033e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000033f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000034a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000034b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000034c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000034d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000034e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000034f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003560: 0000 0000 0000 0000 0000 0020 204e 6f43  ...........  NoC
-00003570: 6120 204e 6f43 6170 2e63 6c69 2829 0069  a  NoCap.cli().i
-00003580: 6620 5f5f 6e61 6d20 204e 6f43 6170 2e63  f __nam  NoCap.c
-00003590: 6c69 2829 0020 204e 6f43 6170 2e63 6c69  li().  NoCap.cli
-000035a0: 2820 204e 6f43 6170 2e63 6c69 2829 0069  (  NoCap.cli().i
-000035b0: 6620 5f5f 6e61 6d65 5f5f 203d 3d20 275f  f __name__ == '_
-000035c0: 5f20 204e 6f43 2020 2020 4e6f 4361 702e  _  NoC    NoCap.
-000035d0: 636c 6928 2900 6966 205f 5f6e 616d 655f  cli().if __name_
-000035e0: 5f20 3d3d 2027 5f5f 6d61 696e 5f5f 273a  _ == '__main__':
-000035f0: 0000 2020 2020 7072 696e 7428 2865 6e64  ..    print((end
-00003600: 2d73 7461 7274 292f 3630 2900 2020 2020  -start)/60).    
-00003610: 656e 6420 3d20 7469 6d65 2e70 6572 665f  end = time.perf_
-00003620: 636f 756e 7465 7228 2900 2020 2020 2020  counter().      
-00003630: 7365 6c66 2e70 726f 6365 7373 5f64 6628  self.process_df(
-00003640: 6466 2c20 636c 6965 6e74 2900 2020 2020  df, client).    
-00003650: 2020 7072 696e 7428 274e 6f77 2072 6561    print('Now rea
-00003660: 6469 6e67 206f 7069 6e69 6f6e 7327 2900  ding opinions').
-00003670: 2020 2020 666f 7220 6466 2069 6e20 7064      for df in pd
-00003680: 2e72 6561 645f 6373 7628 7365 6c66 2e5f  .read_csv(self._
-00003690: 6f70 696e 696f 6e73 5f66 6e2c 2063 6875  opinions_fn, chu
-000036a0: 6e6b 7369 7a65 3d6d 6178 5f72 6f77 732c  nksize=max_rows,
-000036b0: 2064 7479 7065 3d6f 7069 6e69 6f6e 5f64   dtype=opinion_d
-000036c0: 7479 7065 732c 2070 6172 7365 5f64 6174  types, parse_dat
-000036d0: 6573 3d4e 6f6e 652c 2075 7365 636f 6c73  es=None, usecols
-000036e0: 3d75 7365 636f 6c73 293a 0020 2020 2063  =usecols):.    c
-000036f0: 6c69 656e 7420 3d20 436c 6965 6e74 2874  lient = Client(t
-00003700: 6872 6561 6473 5f70 6572 5f77 6f72 6b65  hreads_per_worke
-00003710: 723d 342c 206e 5f77 6f72 6b65 7273 203d  r=4, n_workers =
-00003720: 2069 6e74 286d 702e 6370 755f 636f 756e   int(mp.cpu_coun
-00003730: 7428 2920 2a20 2e33 3529 2900 2020 2020  t() * .35)).    
-00003740: 7072 696e 7428 2246 696c 6520 5369 7a65  print("File Size
-00003750: 2069 7320 3a22 2c20 6669 6c65 5f73 697a   is :", file_siz
-00003760: 655f 6762 2c20 2247 4222 2900 2020 2020  e_gb, "GB").    
-00003770: 7072 696e 7428 6627 496d 706f 7274 696e  print(f'Importin
-00003780: 6720 7b73 656c 662e 5f6f 7069 6e69 6f6e  g {self._opinion
-00003790: 735f 666e 7d20 6173 2061 2064 6174 6166  s_fn} as a dataf
-000037a0: 7261 6d65 2729 0020 2020 2066 696c 655f  rame').    file_
-000037b0: 7369 7a65 5f67 6220 3d20 726f 756e 6428  size_gb = round(
-000037c0: 6669 6c65 5f73 697a 652f 3130 2a2a 392c  file_size/10**9,
-000037d0: 2032 2900 2020 2020 6669 6c65 5f73 697a   2).    file_siz
-000037e0: 6520 3d20 6f73 2e70 6174 682e 6765 7473  e = os.path.gets
-000037f0: 697a 6528 7365 6c66 2e5f 6f70 696e 696f  ize(self._opinio
-00003800: 6e73 5f66 6e29 0020 2020 2020 2020 2020  ns_fn).         
-00003810: 205d 0020 2020 2020 2020 2020 2020 276c   ].           'l
-00003820: 6f63 616c 5f70 6174 6827 2020 2020 2020  ocal_path'      
-00003830: 2020 2020 2000 2020 2020 2020 2020 2020       .          
-00003840: 2027 6874 6d6c 5f61 6e6f 6e5f 3230 3230   'html_anon_2020
-00003850: 272c 0020 2020 2020 2020 2020 2020 2768  ',.           'h
-00003860: 746d 6c5f 636f 6c75 6d62 6961 272c 0020  tml_columbia',. 
-00003870: 2020 2020 2020 2020 2020 2768 746d 6c5f            'html_
-00003880: 6c61 7762 6f78 272c 0020 2020 2020 2020  lawbox',.       
-00003890: 2020 2020 2768 746d 6c27 2c00 2020 2020      'html',.    
-000038a0: 2020 2020 2020 2027 706c 6169 6e5f 7465         'plain_te
-000038b0: 7874 272c 0020 2020 2020 2020 2020 2020  xt',.           
-000038c0: 2778 6d6c 5f68 6172 7661 7264 272c 0020  'xml_harvard',. 
-000038d0: 2020 2020 2020 2020 2020 2763 6c75 7374            'clust
-000038e0: 6572 5f69 6427 2c00 2020 2020 2020 2020  er_id',.        
-000038f0: 2020 2027 6c6f 6361 6c5f 7061 7468 272c     'local_path',
-00003900: 0020 2020 2020 2020 2020 2020 2764 6f77  .           'dow
-00003910: 6e6c 6f61 645f 7572 6c27 2c20 0020 2020  nload_url', .   
-00003920: 2020 2020 2020 2020 2769 6427 2c00 2020          'id',.  
-00003930: 2020 7573 6563 6f6c 7320 3d20 5b00 2020    usecols = [.  
-00003940: 2020 7d00 2020 2020 2020 2020 276c 6f63    }.        'loc
-00003950: 616c 5f70 6174 6827 3a27 7374 7269 6e67  al_path':'string
-00003960: 2700 2020 2020 2020 2020 2768 746d 6c5f  '.        'html_
-00003970: 7769 7468 5f63 6974 6174 696f 6e73 273a  with_citations':
-00003980: 2773 7472 696e 6727 2c00 2020 2020 2020  'string',.      
-00003990: 2020 2768 746d 6c5f 616e 6f6e 5f32 3032    'html_anon_202
-000039a0: 3027 3a27 7374 7269 6e67 272c 0020 2020  0':'string',.   
-000039b0: 2020 2020 2027 6874 6d6c 5f63 6f6c 756d       'html_colum
-000039c0: 6269 6127 3a27 7374 7269 6e67 272c 0020  bia':'string',. 
-000039d0: 2020 2020 2020 2027 6874 6d6c 5f6c 6177         'html_law
-000039e0: 626f 7827 3a27 7374 7269 6e67 272c 0020  box':'string',. 
-000039f0: 2020 2020 2020 2027 6874 6d6c 273a 2773         'html':'s
-00003a00: 7472 696e 6727 2c00 2020 2020 2020 2020  tring',.        
-00003a10: 2770 6c61 696e 5f74 6578 7427 3a27 7374  'plain_text':'st
-00003a20: 7269 6e67 272c 0020 2020 2020 2020 2027  ring',.        '
-00003a30: 6c6f 6361 6c5f 7061 7468 273a 2773 7472  local_path':'str
-00003a40: 696e 6727 2c00 2020 2020 2020 2020 2764  ing',.        'd
-00003a50: 6f77 6e6c 6f61 645f 7572 6c27 3a20 2773  ownload_url': 's
-00003a60: 7472 696e 6727 2c00 2020 2020 6f70 696e  tring',.    opin
-00003a70: 696f 6e5f 6474 7970 6573 203d 207b 0020  ion_dtypes = {. 
-00003a80: 2020 206d 6178 5f72 6f77 7320 3d20 3530     max_rows = 50
-00003a90: 0020 2020 2073 7461 7274 203d 2074 696d  .    start = tim
-00003aa0: 652e 7065 7266 5f63 6f75 6e74 6572 2829  e.perf_counter()
-00003ab0: 0020 2064 6566 2073 7461 7274 2873 656c  .  def start(sel
-00003ac0: 6629 3a00 2020 2020 0020 2020 2023 7265  f):.    .    #re
-00003ad0: 7475 726e 2063 6c69 656e 742e 6761 7468  turn client.gath
-00003ae0: 6572 2866 7574 7572 6573 2900 2020 2020  er(futures).    
-00003af0: 2020 6675 7475 7265 732e 6170 7065 6e64    futures.append
-00003b00: 2866 7574 7572 6529 0020 2020 2020 2066  (future).      f
-00003b10: 7574 7572 6520 3d20 636c 6965 6e74 2e73  uture = client.s
-00003b20: 7562 6d69 7428 7365 6c66 2e70 726f 6365  ubmit(self.proce
-00003b30: 7373 5f72 6f77 2c20 726f 7729 0020 2020  ss_row, row).   
-00003b40: 2020 2073 656c 662e 7072 6f63 6573 735f     self.process_
-00003b50: 726f 7728 726f 7729 0020 2020 2066 6f72  row(row).    for
-00003b60: 2069 6e64 6578 2c20 726f 7720 696e 2064   index, row in d
-00003b70: 662e 6974 6572 726f 7773 2829 3a00 2020  f.iterrows():.  
-00003b80: 2020 6675 7475 7265 7320 3d20 5b5d 0020    futures = []. 
-00003b90: 2064 6566 2070 726f 6365 7373 5f64 6628   def process_df(
-00003ba0: 7365 6c66 2c20 6466 2c20 636c 6965 6e74  self, df, client
-00003bb0: 293a 0000 2020 2020 2020 2020 2020 2920  ):..          ) 
-00003bc0: 2000 2020 2020 2020 2020 2020 2020 6178   .            ax
-00003bd0: 6973 3d31 2c00 2020 2020 2020 2020 2020  is=1,.          
-00003be0: 2020 6c61 6d62 6461 2072 6f77 3a20 7072    lambda row: pr
-00003bf0: 696e 7428 6627 7b73 656c 662e 7072 6f63  int(f'{self.proc
-00003c00: 6573 735f 726f 7728 726f 7729 7d5c 6e27  ess_row(row)}\n'
-00003c10: 292c 0020 2020 2020 2020 2020 205d 5d2e  ),.          ]].
-00003c20: 6170 706c 7928 0020 2020 2020 2020 2020  apply(.         
-00003c30: 2020 2027 6874 6d6c 5f61 6e6f 6e5f 3230     'html_anon_20
-00003c40: 3230 2700 2020 2020 2020 2020 2020 2020  20'.            
-00003c50: 2768 746d 6c5f 636f 6c75 6d62 6961 272c  'html_columbia',
-00003c60: 0020 2020 2020 2020 2020 2020 2027 6874  .            'ht
-00003c70: 6d6c 5f6c 6177 626f 7827 2c00 2020 2020  ml_lawbox',.    
-00003c80: 2020 2020 2020 2020 2768 746d 6c27 2c00          'html',.
-00003c90: 2020 2020 2020 2020 2020 2020 2770 6c61              'pla
-00003ca0: 696e 5f74 6578 7427 2c00 2020 2020 2020  in_text',.      
-00003cb0: 2020 2020 2020 2778 6d6c 5f68 6172 7661        'xml_harva
-00003cc0: 7264 272c 0020 2020 2020 2020 2020 2020  rd',.           
-00003cd0: 2027 636c 7573 7465 725f 6964 272c 0020   'cluster_id',. 
-00003ce0: 2020 2020 2020 2020 2020 2027 646f 776e             'down
-00003cf0: 6c6f 6164 5f75 726c 272c 0020 2020 2020  load_url',.     
-00003d00: 2020 2020 2020 2027 6c6f 6361 6c5f 7061         'local_pa
-00003d10: 7468 272c 0020 2020 2020 2020 2020 2020  th',.           
-00003d20: 2027 6964 272c 0020 2020 2064 665b 5b00   'id',.    df[[.
-00003d30: 2020 6465 6620 5f74 6178 6f6e 6966 7928    def _taxonify(
-00003d40: 7365 6c66 2c20 6466 293a 0000 2020 2020  self, df):..    
-00003d50: 7265 7475 726e 206f 626a 0020 2020 207d  return obj.    }
-00003d60: 0020 2020 2020 2020 207d 0020 2020 2020  .        }.     
-00003d70: 2020 2020 2020 207d 0020 2020 2020 2020         }.       
-00003d80: 2020 2020 2020 2020 2027 6175 7468 6f72           'author
-00003d90: 273a 2027 272c 2027 7479 7065 273a 2027  ': '', 'type': '
-00003da0: 277d 5d00 2020 2020 2020 2020 2020 2020  '}].            
-00003db0: 2020 2020 2774 6578 7427 3a20 7365 6c66      'text': self
-00003dc0: 2e67 6574 5f6f 7069 6e69 6f6e 5f74 6578  .get_opinion_tex
-00003dd0: 7428 6f70 696e 696f 6e29 2c20 0020 2020  t(opinion), .   
-00003de0: 2020 2020 2020 2020 2027 6f70 696e 696f           'opinio
-00003df0: 6e73 273a 205b 7b00 2020 2020 2020 2020  ns': [{.        
-00003e00: 2020 2020 2768 6561 645f 6d61 7474 6572      'head_matter
-00003e10: 273a 2727 2c20 2341 736b 2043 4c20 6162  ':'', #Ask CL ab
-00003e20: 6f75 7420 636f 7079 7269 6768 742c 0020  out copyright,. 
-00003e30: 2020 2020 2020 2020 2020 2027 6a75 6467             'judg
-00003e40: 6573 273a 206a 7564 6765 5f6c 6973 742c  es': judge_list,
-00003e50: 0020 2020 2020 2020 2027 6361 7365 626f  .        'casebo
-00003e60: 6479 2720 3a20 7b27 6461 7461 273a 207b  dy' : {'data': {
-00003e70: 0020 2020 2020 2020 2027 6a75 7269 7364  .        'jurisd
-00003e80: 6963 7469 6f6e 2720 3a20 7b27 6e61 6d65  iction' : {'name
-00003e90: 273a 2063 6f75 7274 5f72 6f77 2e6a 7572  ': court_row.jur
-00003ea0: 6973 6469 6374 696f 6e2e 696c 6f63 5b30  isdiction.iloc[0
-00003eb0: 5d7d 2c00 2020 2020 2020 2020 2763 6f75  ]},.        'cou
-00003ec0: 7274 2720 3a20 7b27 6e61 6d65 273a 2063  rt' : {'name': c
-00003ed0: 6f75 7274 5f72 6f77 2e66 756c 6c5f 6e61  ourt_row.full_na
-00003ee0: 6d65 2e69 6c6f 635b 305d 7d2c 0020 2020  me.iloc[0]},.   
-00003ef0: 2020 2020 2027 6369 7465 735f 746f 2720       'cites_to' 
-00003f00: 3a20 6369 7465 735f 746f 2c00 2020 2020  : cites_to,.    
-00003f10: 2020 2020 2763 6974 6174 696f 6e73 2720      'citations' 
-00003f20: 3a20 6369 7465 645f 6279 2c00 2020 2020  : cited_by,.    
-00003f30: 2020 2020 2764 6f63 6b65 745f 6e75 6d62      'docket_numb
-00003f40: 6572 2720 3a20 636c 7573 7465 725f 726f  er' : cluster_ro
-00003f50: 772e 646f 636b 6574 5f69 642e 696c 6f63  w.docket_id.iloc
-00003f60: 5b30 5d2c 0020 2020 2020 2020 2027 6465  [0],.        'de
-00003f70: 6369 7369 6f6e 5f64 6174 6527 3a20 6461  cision_date': da
-00003f80: 7465 5f74 6572 6d69 6e61 7465 642c 0020  te_terminated,. 
-00003f90: 2020 2020 2020 2027 6e61 6d65 2720 3a20         'name' : 
-00003fa0: 636c 7573 7465 725f 726f 772e 6361 7365  cluster_row.case
-00003fb0: 5f6e 616d 655f 6675 6c6c 2e69 6c6f 635b  _name_full.iloc[
-00003fc0: 305d 2c00 2020 2020 2020 2020 276e 616d  0],.        'nam
-00003fd0: 655f 6162 6272 6576 6961 7469 6f6e 273a  e_abbreviation':
-00003fe0: 2063 6c75 7374 6572 5f72 6f77 2e63 6173   cluster_row.cas
-00003ff0: 655f 6e61 6d65 2e69 6c6f 635b 305d 2c00  e_name.iloc[0],.
-00004000: 6164 0000 5609 0000 260a 0000 0010 0000  ad..V...&.......
-00004010: 2d00 0000 0000 0000 950f 0000 2a0f 0000  -...........*...
+00003230: 0000 0000 0000 0000 0000 0000 0000 0020  ............... 
+00003240: 2020 6465 6620 6765 745f 6369 7461 7469    def get_citati
+00003250: 6f6e 7328 7365 6c66 2c20 6f70 696e 2020  ons(self, opin  
+00003260: 6465 6620 2064 6566 2067 6574 5f63 6974  def  def get_cit
+00003270: 6174 696f 2020 2020 6420 2064 6566 2067  atio    d  def g
+00003280: 6574 5f63 6974 6174 696f 6e73 2873 656c  et_citations(sel
+00003290: 662c 206f 7069 6e69 6f6e 5f69 642c 2064  f, opinion_id, d
+000032a0: 665f 6369 7461 7469 6f6e 7329 3a00 0020  f_citations):.. 
+000032b0: 2020 2072 6574 7572 6e20 7465 7874 0020     return text. 
+000032c0: 2020 2020 2020 2074 6578 7420 3d20 686c         text = hl
+000032d0: 6100 2020 2020 656c 6966 2069 7369 6e73  a.    elif isins
+000032e0: 7461 6e63 6528 686c 612c 2073 7472 293a  tance(hla, str):
+000032f0: 0020 2020 2020 2020 2074 6578 7420 3d20  .        text = 
+00003300: 7868 2000 2020 2020 656c 6966 2069 7369  xh .    elif isi
+00003310: 6e73 7461 6e63 6528 7868 2c20 7374 7229  nstance(xh, str)
+00003320: 3a00 2020 2020 2020 2020 7465 7874 203d  :.        text =
+00003330: 2068 6c63 2000 2020 2020 656c 6966 2069   hlc .    elif i
+00003340: 7369 6e73 7461 6e63 6528 686c 632c 2073  sinstance(hlc, s
+00003350: 7472 293a 0020 2020 2020 2020 2074 6578  tr):.        tex
+00003360: 7420 3d20 686c 6200 2020 2020 656c 6966  t = hlb.    elif
+00003370: 2069 7369 6e73 7461 6e63 6528 686c 622c   isinstance(hlb,
+00003380: 2073 7472 293a 0020 2020 2020 2020 2074   str):.        t
+00003390: 6578 7420 3d20 686c 0020 2020 2065 6c69  ext = hl.    eli
+000033a0: 6620 6973 696e 7374 616e 6365 2868 6c2c  f isinstance(hl,
+000033b0: 2073 7472 293a 0020 2020 2020 2020 2074   str):.        t
+000033c0: 6578 7420 3d20 7074 0020 2020 2069 6620  ext = pt.    if 
+000033d0: 6973 696e 7374 616e 6365 2870 742c 2073  isinstance(pt, s
+000033e0: 7472 293a 0020 2020 2000 2020 2020 686c  tr):.    .    hl
+000033f0: 6120 3d20 6f70 696e 696f 6e5b 2768 746d  a = opinion['htm
+00003400: 6c5f 616e 6f6e 5f32 3032 3027 5d00 2020  l_anon_2020'].  
+00003410: 2020 7868 203d 206f 7069 6e69 6f6e 5b27    xh = opinion['
+00003420: 786d 6c5f 6861 7276 6172 6427 5d00 2020  xml_harvard'].  
+00003430: 2020 686c 6320 3d20 6f70 696e 696f 6e5b    hlc = opinion[
+00003440: 2768 746d 6c5f 636f 6c75 6d62 6961 275d  'html_columbia']
+00003450: 0020 2020 2068 6c62 203d 206f 7069 6e69  .    hlb = opini
+00003460: 6f6e 5b27 6874 6d6c 5f6c 6177 626f 7827  on['html_lawbox'
+00003470: 5d00 2020 2020 686c 203d 206f 7069 6e69  ].    hl = opini
+00003480: 6f6e 5b27 6874 6d6c 275d 0020 2020 2070  on['html'].    p
+00003490: 7420 3d20 6f70 696e 696f 6e5b 2770 6c61  t = opinion['pla
+000034a0: 696e 5f74 6578 7427 5d00 2020 2020 7465  in_text'].    te
+000034b0: 7874 203d 2027 2700 2020 6465 6620 6765  xt = ''.  def ge
+000034c0: 745f 6f70 696e 696f 6e5f 7465 7874 2873  t_opinion_text(s
+000034d0: 656c 662c 206f 7069 6e69 6f6e 293a 0020  elf, opinion):. 
+000034e0: 2023 2061 6363 6570 7473 2061 2073 6572   # accepts a ser
+000034f0: 6965 7320 2d2d 2061 2072 6f77 2066 726f  ies -- a row fro
+00003500: 6d20 6120 6461 7461 6672 616d 6500 2020  m a dataframe.  
+00003510: 0020 2020 2072 6574 7572 6e20 6466 2e6c  .    return df.l
+00003520: 6f63 5b64 665b 636f 6c75 6d6e 5d20 3d3d  oc[df[column] ==
+00003530: 206d 6174 6368 5d00 2020 6465 6620 6466   match].  def df
+00003540: 5f72 6f77 5f62 795f 7661 6c75 6528 7365  _row_by_value(se
+00003550: 6c66 2c20 6466 2c20 636f 6c75 6d6e 2c20  lf, df, column, 
+00003560: 6d61 7463 6829 3a00 0020 2020 2072 6574  match):..    ret
+00003570: 7572 6e20 7365 6c66 2e5f 636c 6965 6e74  urn self._client
+00003580: 0020 2064 6566 2067 6574 5f63 6c75 7374  .  def get_clust
+00003590: 6572 5f63 6c69 656e 7428 7365 6c66 293a  er_client(self):
+000035a0: 0020 2023 2067 6574 2063 6c75 7374 6572  .  # get cluster
+000035b0: 2063 6c69 656e 7400 0020 2020 2072 6574   client..    ret
+000035c0: 7572 6e20 6466 0020 2020 206c 6f67 2e64  urn df.    log.d
+000035d0: 6562 7567 2866 277b 6669 6c65 6e61 6d65  ebug(f'{filename
+000035e0: 7d20 7265 6164 2069 6e20 7b73 7472 2869  } read in {str(i
+000035f0: 6e74 2828 656e 642d 7374 6172 7429 2f36  nt((end-start)/6
+00003600: 3029 297d 206d 696e 7574 6573 2729 0020  0))} minutes'). 
+00003610: 2020 2065 6e64 203d 2074 696d 652e 7065     end = time.pe
+00003620: 7266 5f63 6f75 6e74 6572 2829 0020 2020  rf_counter().   
+00003630: 2020 2020 2064 6620 3d20 7064 2e72 6561       df = pd.rea
+00003640: 645f 6373 7628 6669 6c65 6e61 6d65 2c20  d_csv(filename, 
+00003650: 6474 7970 653d 6474 7970 652c 2070 6172  dtype=dtype, par
+00003660: 7365 5f64 6174 6573 3d70 6172 7365 5f64  se_dates=parse_d
+00003670: 6174 6573 2c20 7573 6563 6f6c 733d 7573  ates, usecols=us
+00003680: 6563 6f6c 732c 2069 6e64 6578 5f63 6f6c  ecols, index_col
+00003690: 3d69 6e64 6578 5f63 6f6c 2900 2020 2020  =index_col).    
+000036a0: 656c 7365 3a00 2020 2020 2020 2020 2020  else:.          
+000036b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000036c0: 2020 2020 2020 2020 2020 2020 2064 7479               dty
+000036d0: 7065 3d64 7479 7065 2c20 7061 7273 655f  pe=dtype, parse_
+000036e0: 6461 7465 733d 7061 7273 655f 6461 7465  dates=parse_date
+000036f0: 732c 2075 7365 636f 6c73 3d75 7365 636f  s, usecols=useco
+00003700: 6c73 2c20 696e 6465 785f 636f 6c3d 696e  ls, index_col=in
+00003710: 6465 785f 636f 6c29 2900 2020 2020 2020  dex_col)).      
+00003720: 2020 6466 203d 2070 642e 636f 6e63 6174    df = pd.concat
+00003730: 2873 656c 662e 7265 6164 5f63 7376 5f61  (self.read_csv_a
+00003740: 735f 6466 7328 6669 6c65 6e61 6d65 2c20  s_dfs(filename, 
+00003750: 6e75 6d5f 6466 733d 3130 2a2a 352c 206d  num_dfs=10**5, m
+00003760: 6178 5f72 6f77 733d 3130 2a2a 372c 2000  ax_rows=10**7, .
+00003770: 2020 2020 6966 2066 696c 655f 7369 7a65      if file_size
+00003780: 5f67 6220 3e20 6d61 785f 6762 3a00 2020  _gb > max_gb:.  
+00003790: 2020 6466 203d 204e 6f6e 6500 2020 2020    df = None.    
+000037a0: 6c6f 672e 6465 6275 6728 6d73 6729 0020  log.debug(msg). 
+000037b0: 2020 206d 7367 203d 2066 2246 696c 6520     msg = f"File 
+000037c0: 5369 7a65 2069 7320 3a20 7b73 7472 2866  Size is : {str(f
+000037d0: 696c 655f 7369 7a65 5f67 6229 7d20 4742  ile_size_gb)} GB
+000037e0: 2200 2020 2020 6c6f 672e 6465 6275 6728  ".    log.debug(
+000037f0: 6627 496d 706f 7274 696e 6720 7b66 696c  f'Importing {fil
+00003800: 656e 616d 657d 2061 7320 6120 6461 7461  ename} as a data
+00003810: 6672 616d 6527 2900 2020 2020 6669 6c65  frame').    file
+00003820: 5f73 697a 655f 6762 203d 2072 6f75 6e64  _size_gb = round
+00003830: 2866 696c 655f 7369 7a65 2f31 302a 2a39  (file_size/10**9
+00003840: 2c20 3229 0020 2020 2066 696c 655f 7369  , 2).    file_si
+00003850: 7a65 203d 206f 732e 7061 7468 2e67 6574  ze = os.path.get
+00003860: 7369 7a65 2866 696c 656e 616d 6529 0020  size(filename). 
+00003870: 2020 2073 7461 7274 203d 2074 696d 652e     start = time.
+00003880: 7065 7266 5f63 6f75 6e74 6572 2829 0020  perf_counter(). 
+00003890: 2064 6566 2063 7376 5f74 6f5f 6466 2873   def csv_to_df(s
+000038a0: 656c 662c 2066 696c 656e 616d 652c 2064  elf, filename, d
+000038b0: 7479 7065 203d 204e 6f6e 652c 2070 6172  type = None, par
+000038c0: 7365 5f64 6174 6573 203d 204e 6f6e 652c  se_dates = None,
+000038d0: 206d 6178 5f67 623d 352c 206e 756d 5f64   max_gb=5, num_d
+000038e0: 6673 3d31 302a 2a33 2c20 7573 6563 6f6c  fs=10**3, usecol
+000038f0: 733d 4e6f 6e65 2c20 696e 6465 785f 636f  s=None, index_co
+00003900: 6c3d 4e6f 6e65 293a 0020 2023 2067 6574  l=None):.  # get
+00003910: 2061 2070 6f74 656e 7469 616c 6c79 206c   a potentially l
+00003920: 6172 6765 2063 7376 2061 6e64 2074 7572  arge csv and tur
+00003930: 6e20 6974 2069 6e74 6f20 6120 4461 7461  n it into a Data
+00003940: 4672 616d 6500 0020 2020 2072 6574 7572  Frame..    retur
+00003950: 6e20 6466 735f 6f70 696e 696f 6e73 0020  n dfs_opinions. 
+00003960: 2020 2020 2020 2063 6f75 6e74 6572 203d         counter =
+00003970: 2063 6f75 6e74 6572 202b 2031 0020 2020   counter + 1.   
+00003980: 2020 2020 2064 6673 5f6f 7069 6e69 6f6e       dfs_opinion
+00003990: 732e 6170 7065 6e64 2864 6629 0020 2020  s.append(df).   
+000039a0: 2020 2020 2020 2020 2062 7265 616b 0020           break. 
+000039b0: 2020 2020 2020 2069 6620 636f 756e 7465         if counte
+000039c0: 7220 3e3d 206e 756d 5f64 6673 3a00 2020  r >= num_dfs:.  
+000039d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000039e0: 2020 2020 2020 2020 7061 7273 655f 6461          parse_da
+000039f0: 7465 733d 7061 7273 655f 6461 7465 732c  tes=parse_dates,
+00003a00: 2075 7365 636f 6c73 3d75 7365 636f 6c73   usecols=usecols
+00003a10: 2c20 696e 6465 785f 636f 6c3d 696e 6465  , index_col=inde
+00003a20: 785f 636f 6c29 3a00 2020 2020 666f 7220  x_col):.    for 
+00003a30: 6466 2069 6e20 7064 2e72 6561 645f 6373  df in pd.read_cs
+00003a40: 7628 6669 6c65 6e61 6d65 2c20 6368 756e  v(filename, chun
+00003a50: 6b73 697a 653d 6d61 785f 726f 7773 2c20  ksize=max_rows, 
+00003a60: 6474 7970 653d 6474 7970 652c 2000 2020  dtype=dtype, .  
+00003a70: 2020 6466 735f 6f70 696e 696f 6e73 203d    dfs_opinions =
+00003a80: 205b 5d00 2020 2020 636f 756e 7465 7220   [].    counter 
+00003a90: 3d20 3000 2020 2020 2020 2020 2020 2020  = 0.            
+00003aa0: 2020 2020 2020 2029 3a00 2020 2020 2020         ):.      
+00003ab0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00003ac0: 6465 785f 636f 6c3d 4e6f 6e65 0020 2020  dex_col=None.   
+00003ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003ae0: 2075 7365 636f 6c73 3d4e 6f6e 652c 0020   usecols=None,. 
+00003af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003b00: 2020 2070 6172 7365 5f64 6174 6573 3d4e     parse_dates=N
+00003b10: 6f6e 652c 0020 2020 2020 2020 2020 2020  one,.           
+00003b20: 2020 2020 2020 2020 2064 7479 7065 3d4e           dtype=N
+00003b30: 6f6e 652c 2000 2020 2020 2020 2020 2020  one, .          
+00003b40: 2020 2020 2020 2020 2020 6d61 785f 726f            max_ro
+00003b50: 7773 3d31 302a 2a35 2c20 0020 2020 2020  ws=10**5, .     
+00003b60: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00003b70: 756d 5f64 6673 3d31 302c 2000 2020 6465  um_dfs=10, .  de
+00003b80: 6620 7265 6164 5f63 7376 5f61 735f 6466  f read_csv_as_df
+00003b90: 7328 7365 6c66 2c20 6669 6c65 6e61 6d65  s(self, filename
+00003ba0: 2c20 0020 2020 2000 2020 2020 4e6f 4361  , .    .    NoCa
+00003bb0: 7028 6f2c 206f 632c 2063 2c20 642c 2063  p(o, oc, c, d, c
+00003bc0: 6d29 2e73 7461 7274 2829 0020 2064 6566  m).start().  def
+00003bd0: 2063 6c69 286f 2c20 6f63 2c20 632c 2064   cli(o, oc, c, d
+00003be0: 2c20 636d 293a 0020 2040 636c 6963 6b2e  , cm):.  @click.
+00003bf0: 6f70 7469 6f6e 2827 2d63 6d27 2c20 6865  option('-cm', he
+00003c00: 6c70 3d22 6c6f 6361 6c20 7061 7468 2074  lp="local path t
+00003c10: 6f20 6369 7461 7469 6f6e 206d 6170 2066  o citation map f
+00003c20: 696c 6522 2c20 7265 7175 6972 6564 3d54  ile", required=T
+00003c30: 7275 6529 0020 2040 636c 6963 6b2e 6f70  rue).  @click.op
+00003c40: 7469 6f6e 2827 2d64 272c 2068 656c 703d  tion('-d', help=
+00003c50: 226c 6f63 616c 2070 6174 6820 746f 2064  "local path to d
+00003c60: 6f63 6b65 7473 2066 696c 6522 2c20 7265  ockets file", re
+00003c70: 7175 6972 6564 3d54 7275 6529 0020 2040  quired=True).  @
+00003c80: 636c 6963 6b2e 6f70 7469 6f6e 2827 2d63  click.option('-c
+00003c90: 272c 2068 656c 703d 226c 6f63 616c 2070  ', help="local p
+00003ca0: 6174 6820 746f 2063 6f75 7274 7320 6669  ath to courts fi
+00003cb0: 6c65 2022 2c20 7265 7175 6972 6564 3d54  le ", required=T
+00003cc0: 7275 6529 0020 2040 636c 6963 6b2e 6f70  rue).  @click.op
+00003cd0: 7469 6f6e 2827 2d6f 6327 2c20 6865 6c70  tion('-oc', help
+00003ce0: 3d22 6c6f 6361 6c20 7061 7468 2074 6f20  ="local path to 
+00003cf0: 6f70 696e 696f 6e20 636c 7573 7465 7273  opinion clusters
+00003d00: 2066 696c 6522 2c20 7265 7175 6972 6564   file", required
+00003d10: 3d54 7275 6529 0020 2040 636c 6963 6b2e  =True).  @click.
+00003d20: 6f70 7469 6f6e 2827 2d6f 272c 2068 656c  option('-o', hel
+00003d30: 703d 226c 6f63 616c 2070 6174 6820 746f  p="local path to
+00003d40: 206f 7069 6e69 6f6e 7320 6669 6c65 222c   opinions file",
+00003d50: 2072 6571 7569 7265 643d 5472 7565 2900   required=True).
+00003d60: 2020 4063 6c69 636b 2e63 6f6d 6d61 6e64    @click.command
+00003d70: 2829 2020 0000 2020 2020 7365 6c66 2e44  ()  ..    self.D
+00003d80: 6174 6146 7261 6d65 203d 2070 642e 636f  ataFrame = pd.co
+00003d90: 7265 2e66 7261 6d65 2e44 6174 6146 7261  re.frame.DataFra
+00003da0: 6d65 0020 2020 2023 7365 6c66 2e5f 6466  me.    #self._df
+00003db0: 5f6f 7069 6e69 6f6e 7320 3d20 7365 6c66  _opinions = self
+00003dc0: 2e69 6e69 745f 6f70 696e 696f 6e73 5f64  .init_opinions_d
+00003dd0: 6628 2900 0020 2020 2073 656c 662e 5f64  f()..    self._d
+00003de0: 665f 646f 636b 6574 7320 3d20 7365 6c66  f_dockets = self
+00003df0: 2e69 6e69 745f 646f 636b 6574 735f 6469  .init_dockets_di
+00003e00: 6374 2829 2023 2073 656c 662e 696e 6974  ct() # self.init
+00003e10: 5f64 6f63 6b65 7473 5f64 6628 2900 2020  _dockets_df().  
+00003e20: 2020 7365 6c66 2e5f 6466 5f63 6974 6174    self._df_citat
+00003e30: 696f 6e20 3d20 7365 6c66 2e69 6e69 745f  ion = self.init_
+00003e40: 6369 7461 7469 6f6e 5f64 6628 2900 2020  citation_df().  
+00003e50: 2020 7365 6c66 2e5f 6466 5f6f 7069 6e69    self._df_opini
+00003e60: 6f6e 5f63 6c75 7374 6572 7320 3d20 7365  on_clusters = se
+00003e70: 6c66 2e69 6e69 745f 6f70 696e 696f 6e5f  lf.init_opinion_
+00003e80: 636c 7573 7465 7273 5f64 6628 2900 2020  clusters_df().  
+00003e90: 2020 7365 6c66 2e5f 6466 5f63 6f75 7274    self._df_court
+00003ea0: 7320 3d20 7365 6c66 2e69 6e69 745f 636f  s = self.init_co
+00003eb0: 7572 7473 5f64 6628 2900 0020 2020 2073  urts_df()..    s
+00003ec0: 656c 662e 5f63 6974 6174 696f 6e5f 666e  elf._citation_fn
+00003ed0: 203d 2063 6974 6174 696f 6e5f 666e 0020   = citation_fn. 
+00003ee0: 2020 2073 656c 662e 5f64 6f63 6b65 7473     self._dockets
+00003ef0: 5f66 6e20 3d20 646f 636b 6574 735f 666e  _fn = dockets_fn
+00003f00: 0020 2020 2073 656c 662e 5f63 6f75 7274  .    self._court
+00003f10: 735f 666e 203d 2063 6f75 7274 735f 666e  s_fn = courts_fn
+00003f20: 0020 2020 2073 656c 662e 5f6f 7069 6e69  .    self._opini
+00003f30: 6f6e 5f63 6c75 7374 6572 735f 666e 203d  on_clusters_fn =
+00003f40: 206f 7069 6e69 6f6e 5f63 6c75 7374 6572   opinion_cluster
+00003f50: 735f 666e 0020 2020 2073 656c 662e 5f6f  s_fn.    self._o
+00003f60: 7069 6e69 6f6e 735f 666e 203d 206f 7069  pinions_fn = opi
+00003f70: 6e69 6f6e 735f 666e 0020 2020 206c 6f67  nions_fn.    log
+00003f80: 2e64 6562 7567 2827 496e 6974 6961 6c69  .debug('Initiali
+00003f90: 7a69 6e67 2729 0020 2064 6566 205f 5f69  zing').  def __i
+00003fa0: 6e69 745f 5f28 7365 6c66 2c20 6f70 696e  nit__(self, opin
+00003fb0: 696f 6e73 5f66 6e2c 206f 7069 6e69 6f6e  ions_fn, opinion
+00003fc0: 5f63 6c75 7374 6572 735f 666e 2c20 636f  _clusters_fn, co
+00003fd0: 7572 7473 5f66 6e2c 2064 6f63 6b65 7473  urts_fn, dockets
+00003fe0: 5f66 6e2c 2063 6974 6174 696f 6e5f 666e  _fn, citation_fn
+00003ff0: 293a 0063 6c61 7373 204e 6f43 6170 3a00  ):.class NoCap:.
+00004000: 6164 0000 6d09 0000 390a 0000 0010 0000  ad..m...9.......
+00004010: 2c00 0000 0000 0000 950f 0000 2a0f 0000  ,...........*...
 00004020: 1d0f 0000 000f 0000 e40e 0000 de0e 0000  ................
 00004030: dd0e 0000 c40e 0000 9f0e 0000 6f0e 0000  ............o...
 00004040: 600e 0000 440e 0000 250e 0000 1f0e 0000  `...D...%.......
 00004050: cf0d 0000 ce0d 0000 b30d 0000 8c0d 0000  ................
 00004060: 730d 0000 510d 0000 320d 0000 130d 0000  s...Q...2.......
 00004070: fa0c 0000 da0c 0000 b80c 0000 950c 0000  ................
 00004080: 6d0c 0000 4f0c 0000 460c 0000 450c 0000  m...O...F...E...
 00004090: ea0b 0000 e90b 0000 c60b 0000 970b 0000  ................
 000040a0: 4a0b 0000 390b 0000 1e0b 0000 000b 0000  J...9...........
 000040b0: de0a 0000 d60a 0000 7a0a 0000 790a 0000  ........z...y...
-000040c0: 5f0a 0000 390a 0000 260a 0000 250a 0000  _...9...&...%...
-000040d0: 020a 0000 010a 0000 9109 0000 6609 0000  ............f...
-000040e0: 6509 0000 4609 0000 1f09 0000 ea08 0000  e...F...........
-000040f0: e908 0000 dc08 0000 c108 0000 a408 0000  ................
-00004100: a308 0000 8608 0000 6708 0000 6408 0000  ........g...d...
-00004110: 4808 0000 2a08 0000 2908 0000 0408 0000  H...*...).......
-00004120: dd07 0000 dc07 0000 bf07 0000 b407 0000  ................
-00004130: ad07 0000 a107 0000 7707 0000 5307 0000  ........w...S...
-00004140: 3107 0000 0a07 0000 eb06 0000 c406 0000  1...............
-00004150: c306 0000 a306 0000 a206 0000 4e06 0000  ............N...
-00004160: e505 0000 e405 0000 9d05 0000 6f05 0000  ............o...
-00004170: 3005 0000 2f05 0000 1005 0000 eb04 0000  0.../...........
-00004180: db04 0000 b104 0000 7504 0000 5d04 0000  ........u...]...
-00004190: 4e04 0000 4d04 0000 3104 0000 f303 0000  N...M...1.......
-000041a0: ca03 0000 a103 0000 a003 0000 9403 0000  ................
-000041b0: 7403 0000 6103 0000 5303 0000 3e03 0000  t...a...S...>...
-000041c0: f502 0000 ca02 0000 c402 0000 bb02 0000  ................
-000041d0: 7802 0000 3b02 0000 3a02 0000 2e02 0000  x...;...:.......
-000041e0: 1402 0000 ec01 0000 0000 0000 2020 2020  ............    
-000041f0: 2020 2020 2775 726c 273a 206f 7069 6e69      'url': opini
-00004200: 6f6e 5b27 646f 776e 6c6f 6164 5f75 726c  on['download_url
-00004210: 275d 2c00 2020 2020 2020 2020 2769 6427  '],.        'id'
-00004220: 3a20 636c 7573 7465 725f 6964 2c00 2020  : cluster_id,.  
-00004230: 2020 6f62 6a20 3d20 7b00 0020 2020 2064    obj = {..    d
-00004240: 6174 655f 7465 726d 696e 6174 6564 203d  ate_terminated =
-00004250: 206c 6973 7428 646f 636b 6574 5f72 6f77   list(docket_row
-00004260: 5b27 6461 7465 5f74 6572 6d69 6e61 7465  ['date_terminate
-00004270: 6427 5d29 5b30 5d00 2020 2020 2320 736f  d'])[0].    # so
-00004280: 6d65 7469 6d65 7320 6461 7465 5f74 6572  metimes date_ter
-00004290: 6d69 6e61 7465 6420 6d61 7920 6265 206d  minated may be m
-000042a0: 6973 7369 6e67 2061 6e64 2072 6563 6f72  issing and recor
-000042b0: 6465 6420 6173 204e 614e 0020 2020 2020  ded as NaN.     
-000042c0: 2020 2000 2020 2020 5d00 2020 2020 2020     .    ].      
-000042d0: 2020 6966 206e 6f74 2072 652e 6d61 7463    if not re.matc
-000042e0: 6828 275b 636a 5d3f 6a5c 2e27 2c20 6a75  h('[cj]?j\.', ju
-000042f0: 6467 6529 0020 2020 2020 2020 2020 2020  dge).           
-00004300: 2028 6a75 6467 6573 2e69 6c6f 635b 305d   (judges.iloc[0]
-00004310: 2e73 706c 6974 2827 2c27 2920 6966 206a  .split(',') if j
-00004320: 7564 6765 732e 6e6f 746e 6128 292e 626f  udges.notna().bo
-00004330: 6f6c 2829 2065 6c73 6520 5b5d 2900 2020  ol() else []).  
-00004340: 2020 2020 2020 666f 7220 6a75 6467 6520        for judge 
-00004350: 696e 0020 2020 2020 2020 206a 7564 6765  in.        judge
-00004360: 0020 2020 206a 7564 6765 5f6c 6973 7420  .    judge_list 
-00004370: 3d20 5b00 2020 2020 6a75 6467 6573 203d  = [.    judges =
-00004380: 2063 6c75 7374 6572 5f72 6f77 2e6a 7564   cluster_row.jud
-00004390: 6765 7300 2020 2020 236a 7564 6765 7300  ges.    #judges.
-000043a0: 0020 2020 2063 6974 6564 5f62 7920 3d20  .    cited_by = 
-000043b0: 6369 7461 7469 6f6e 5f69 6e66 6f5b 2763  citation_info['c
-000043c0: 6974 6564 5f62 7927 5d00 2020 2020 6369  ited_by'].    ci
-000043d0: 7465 735f 746f 203d 2063 6974 6174 696f  tes_to = citatio
-000043e0: 6e5f 696e 666f 5b27 6369 7465 735f 746f  n_info['cites_to
-000043f0: 275d 0020 2020 2063 6974 6174 696f 6e5f  '].    citation_
-00004400: 696e 666f 203d 2073 656c 662e 6765 745f  info = self.get_
-00004410: 6369 7461 7469 6f6e 7328 6f70 696e 696f  citations(opinio
-00004420: 6e5f 6964 2c20 6369 7461 7469 6f6e 7329  n_id, citations)
-00004430: 0020 2020 2023 2067 6574 206f 7069 6e69  .    # get opini
-00004440: 6f6e 7320 6369 7465 6420 746f 0000 2020  ons cited to..  
-00004450: 2020 2020 2020 7265 7475 726e 0020 2020        return.   
-00004460: 2069 6620 636f 7572 745f 726f 772e 656d   if court_row.em
-00004470: 7074 793a 0020 2020 2063 6f75 7274 5f72  pty:.    court_r
-00004480: 6f77 3a20 7365 6c66 2e44 6174 6146 7261  ow: self.DataFra
-00004490: 6d65 203d 2063 6f75 7274 735b 636f 7572  me = courts[cour
-000044a0: 7473 5b27 6964 275d 203d 3d20 6369 645d  ts['id'] == cid]
-000044b0: 0020 2020 2063 6964 203d 206c 6973 7428  .    cid = list(
-000044c0: 646f 636b 6574 5f72 6f77 5b27 636f 7572  docket_row['cour
-000044d0: 745f 6964 275d 295b 305d 0020 2020 2020  t_id'])[0].     
-000044e0: 2020 2072 6574 7572 6e20 0020 2020 2069     return .    i
-000044f0: 6620 6c65 6e28 646f 636b 6574 5f72 6f77  f len(docket_row
-00004500: 2e63 6f6c 756d 6e73 2920 3d3d 2030 3a00  .columns) == 0:.
-00004510: 2020 2020 2320 7265 7475 726e 2065 6172      # return ear
-00004520: 6c79 2069 6620 7468 6572 6527 7320 0000  ly if there's ..
-00004530: 2020 2020 646f 636b 6574 5f72 6f77 203d      docket_row =
-00004540: 2064 6f63 6b65 7473 5b64 6f63 6b65 7473   dockets[dockets
-00004550: 5b27 6964 275d 203d 3d20 646f 636b 6574  ['id'] == docket
-00004560: 5f69 645d 2e63 6f6d 7075 7465 2829 0020  _id].compute(). 
-00004570: 2020 2064 6f63 6b65 745f 6964 203d 2069     docket_id = i
-00004580: 6e74 2863 6c75 7374 6572 5f72 6f77 5b27  nt(cluster_row['
-00004590: 646f 636b 6574 5f69 6427 5d29 0020 2020  docket_id']).   
-000045a0: 2023 2067 6574 2063 6f72 7265 7370 6f6e   # get correspon
-000045b0: 6469 6e67 2072 6f77 2066 726f 6d20 646f  ding row from do
-000045c0: 636b 6574 2064 6620 6261 7365 6420 6f6e  cket df based on
-000045d0: 2063 6c75 7374 6572 206f 7069 6e69 6f6e   cluster opinion
-000045e0: 2069 6400 0020 2020 2063 6c75 7374 6572   id..    cluster
-000045f0: 5f72 6f77 3a20 7365 6c66 2e44 6174 6146  _row: self.DataF
-00004600: 7261 6d65 203d 2073 656c 662e 6466 5f72  rame = self.df_r
-00004610: 6f77 5f62 795f 7661 6c75 6528 7365 6c66  ow_by_value(self
-00004620: 2e67 6574 5f6f 7069 6e69 6f6e 735f 636c  .get_opinions_cl
-00004630: 7573 7465 725f 6466 2829 2c20 2769 6427  uster_df(), 'id'
-00004640: 2c20 636c 7573 7465 725f 6964 2900 2020  , cluster_id).  
-00004650: 2020 2320 6765 7420 6561 6368 2063 6f72    # get each cor
-00004660: 7265 7370 6f6e 6469 6e67 2072 6f77 2066  responding row f
-00004670: 726f 6d20 636c 7573 7465 7273 2c20 646f  rom clusters, do
-00004680: 636b 6574 732c 2063 6f75 7274 7320 6261  ckets, courts ba
-00004690: 7365 6420 6f6e 206f 7069 6e69 6f6e 2069  sed on opinion i
-000046a0: 6400 0020 2020 2069 6d70 6f72 7420 7064  d..    import pd
-000046b0: 623b 2070 6462 2e73 6574 5f74 7261 6365  b; pdb.set_trace
-000046c0: 2829 0000 2020 2020 636c 7573 7465 725f  ()..    cluster_
-000046d0: 6964 203d 206f 7069 6e69 6f6e 5b27 636c  id = opinion['cl
-000046e0: 7573 7465 725f 6964 275d 0020 2020 206f  uster_id'].    o
-000046f0: 7069 6e69 6f6e 5f69 6420 3d20 6f70 696e  pinion_id = opin
-00004700: 696f 6e5b 2769 6427 5d00 2020 2020 6369  ion['id'].    ci
-00004710: 7461 7469 6f6e 7320 3d20 7365 6c66 2e67  tations = self.g
-00004720: 6574 5f63 6974 6174 696f 6e5f 6466 2829  et_citation_df()
-00004730: 0020 2020 2063 6f75 7274 7320 3d20 7365  .    courts = se
-00004740: 6c66 2e67 6574 5f63 6f75 7274 735f 6466  lf.get_courts_df
-00004750: 2829 0020 2020 2064 6f63 6b65 7473 203d  ().    dockets =
-00004760: 2073 656c 662e 6765 745f 646f 636b 6574   self.get_docket
-00004770: 735f 6466 2829 0020 2064 6566 2070 726f  s_df().  def pro
-00004780: 6365 7373 5f72 6f77 2873 656c 662c 206f  cess_row(self, o
-00004790: 7069 6e69 6f6e 2920 2d3e 2064 6963 743a  pinion) -> dict:
-000047a0: 0020 2023 2070 726f 6365 7373 0020 2020  .  # process.   
-000047b0: 2020 2000 2020 2020 2020 7061 7373 0020     .      pass. 
-000047c0: 2064 6566 2067 6574 5f6f 7069 6e69 6f6e   def get_opinion
-000047d0: 735f 6466 2873 656c 6629 3a00 0020 2020  s_df(self):..   
-000047e0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-000047f0: 6466 5f6f 7069 6e69 6f6e 5f63 6c75 7374  df_opinion_clust
-00004800: 6572 7300 2020 6465 6620 6765 745f 6f70  ers.  def get_op
-00004810: 696e 696f 6e73 5f63 6c75 7374 6572 5f64  inions_cluster_d
-00004820: 6628 7365 6c66 293a 0000 2020 2020 2020  f(self):..      
-00004830: 7265 7475 726e 2073 656c 662e 5f64 665f  return self._df_
-00004840: 646f 636b 6574 7300 2020 6465 6620 6765  dockets.  def ge
-00004850: 745f 646f 636b 6574 735f 6466 2873 656c  t_dockets_df(sel
-00004860: 6629 3a00 2020 0020 2020 2020 2072 6574  f):.  .      ret
-00004870: 7572 6e20 7365 6c66 2e5f 6466 5f63 6974  urn self._df_cit
-00004880: 6174 696f 6e00 2020 6465 6620 6765 745f  ation.  def get_
-00004890: 6369 7461 7469 6f6e 5f64 6628 7365 6c66  citation_df(self
-000048a0: 293a 0000 2020 2020 2020 7265 7475 726e  ):..      return
-000048b0: 2073 656c 662e 5f64 665f 636f 7572 7473   self._df_courts
-000048c0: 0020 2064 6566 2067 6574 5f63 6f75 7274  .  def get_court
-000048d0: 735f 6466 2873 656c 6629 3a00 2020 2323  s_df(self):.  ##
-000048e0: 2047 6574 7465 7273 0000 2020 2020 2020   Getters..      
-000048f0: 7265 7475 726e 2073 656c 662e 6373 765f  return self.csv_
-00004900: 746f 5f64 6628 666e 206f 7220 7365 6c66  to_df(fn or self
-00004910: 2e5f 6369 7461 7469 6f6e 5f66 6e29 0020  ._citation_fn). 
-00004920: 2064 6566 2069 6e69 745f 6369 7461 7469   def init_citati
-00004930: 6f6e 5f64 6628 7365 6c66 2c20 666e 3d4e  on_df(self, fn=N
-00004940: 6f6e 6529 3a00 2020 2320 696e 6974 6961  one):.  # initia
-00004950: 6c69 7a65 2063 6974 6174 696f 6e20 6d61  lize citation ma
-00004960: 7020 6466 0000 2020 2020 2020 2020 2020  p df..          
-00004970: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00004980: 6c6f 636b 7369 7a65 3d22 3332 4d42 2229  locksize="32MB")
-00004990: 0020 2020 2020 2072 6574 7572 6e20 6464  .      return dd
-000049a0: 2e72 6561 645f 6373 7628 666e 206f 7220  .read_csv(fn or 
-000049b0: 7365 6c66 2e5f 646f 636b 6574 735f 666e  self._dockets_fn
-000049c0: 2c20 6474 7970 653d 6d79 5f74 7970 6573  , dtype=my_types
-000049d0: 2c20 7573 6563 6f6c 733d 5b27 636f 7572  , usecols=['cour
-000049e0: 745f 6964 272c 2027 6964 272c 2027 6461  t_id', 'id', 'da
-000049f0: 7465 5f74 6572 6d69 6e61 7465 6427 5d2c  te_terminated'],
-00004a00: 0000 2020 2020 2020 7d20 0020 2020 2020  ..      } .     
-00004a10: 2027 636f 7572 745f 6964 273a 2027 7374   'court_id': 'st
-00004a20: 7269 6e67 2700 2020 2020 2020 6d79 5f74  ring'.      my_t
-00004a30: 7970 6573 203d 207b 0020 2064 6566 2069  ypes = {.  def i
+000040c0: 5f0a 0000 390a 0000 380a 0000 100a 0000  _...9...8.......
+000040d0: fa09 0000 dc09 0000 b309 0000 9809 0000  ................
+000040e0: 4509 0000 2d09 0000 2c09 0000 2209 0000  E...-...,..."...
+000040f0: fb08 0000 c608 0000 c508 0000 b808 0000  ................
+00004100: 9d08 0000 8008 0000 7f08 0000 6208 0000  ............b...
+00004110: 4308 0000 4008 0000 2408 0000 0608 0000  C...@...$.......
+00004120: 0508 0000 e007 0000 b907 0000 b807 0000  ................
+00004130: 9b07 0000 9007 0000 8907 0000 7d07 0000  ............}...
+00004140: 5307 0000 3907 0000 2007 0000 fb06 0000  S...9... .......
+00004150: d806 0000 b006 0000 9006 0000 6806 0000  ............h...
+00004160: 6706 0000 1306 0000 a905 0000 a805 0000  g...............
+00004170: 6105 0000 3205 0000 f204 0000 f104 0000  a...2...........
+00004180: d204 0000 ac04 0000 9b04 0000 7004 0000  ............p...
+00004190: 3304 0000 1a04 0000 0a04 0000 0904 0000  3...............
+000041a0: ed03 0000 ad03 0000 8303 0000 5903 0000  ............Y...
+000041b0: 5803 0000 4c03 0000 2b03 0000 1803 0000  X...L...+.......
+000041c0: 0903 0000 f302 0000 a902 0000 7d02 0000  ............}...
+000041d0: 7602 0000 6c02 0000 2802 0000 ea01 0000  v...l...(.......
+000041e0: e901 0000 0000 0000 0000 2020 2020 2364  ..........    #d
+000041f0: 6174 655f 7465 726d 696e 6174 6564 203d  ate_terminated =
+00004200: 206c 6973 7428 646f 636b 6574 5f72 6f77   list(docket_row
+00004210: 5b27 6461 7465 5f74 6572 6d69 6e61 7465  ['date_terminate
+00004220: 6427 5d29 5b30 5d00 2020 2020 2323 2073  d'])[0].    ## s
+00004230: 6f6d 6574 696d 6573 2064 6174 655f 7465  ometimes date_te
+00004240: 726d 696e 6174 6564 206d 6179 2062 6520  rminated may be 
+00004250: 6d69 7373 696e 6720 616e 6420 7265 636f  missing and reco
+00004260: 7264 6564 2061 7320 4e61 4e00 2020 2020  rded as NaN.    
+00004270: 2320 2020 2000 2020 2020 235d 0020 2020  #    .    #].   
+00004280: 2023 2020 2020 6966 206e 6f74 2072 652e   #    if not re.
+00004290: 6d61 7463 6828 275b 636a 5d3f 6a5c 2e27  match('[cj]?j\.'
+000042a0: 2c20 6a75 6467 6529 0020 2020 2023 2020  , judge).    #  
+000042b0: 2020 2020 2020 286a 7564 6765 732e 696c        (judges.il
+000042c0: 6f63 5b30 5d2e 7370 6c69 7428 272c 2729  oc[0].split(',')
+000042d0: 2069 6620 6a75 6467 6573 2e6e 6f74 6e61   if judges.notna
+000042e0: 2829 2e62 6f6f 6c28 2920 656c 7365 205b  ().bool() else [
+000042f0: 5d29 0020 2020 2023 2020 2020 666f 7220  ]).    #    for 
+00004300: 6a75 6467 6520 696e 0020 2020 2023 2020  judge in.    #  
+00004310: 2020 6a75 6467 6500 2020 2020 236a 7564    judge.    #jud
+00004320: 655f 6c69 7374 203d 205b 0020 2020 2023  e_list = [.    #
+00004330: 6a75 6467 6573 203d 2063 6c75 7374 6572  judges = cluster
+00004340: 5f72 6f77 2e6a 7564 6765 7300 2020 2020  _row.judges.    
+00004350: 236a 7564 6765 7300 0020 2020 2023 6369  #judges..    #ci
+00004360: 7465 645f 6279 203d 2063 6974 6174 696f  ted_by = citatio
+00004370: 6e5f 696e 666f 5b27 6369 7465 645f 6279  n_info['cited_by
+00004380: 275d 0020 2020 2023 6369 7465 735f 746f  '].    #cites_to
+00004390: 203d 2063 6974 6174 696f 6e5f 696e 666f   = citation_info
+000043a0: 5b27 6369 7465 735f 746f 275d 0020 2020  ['cites_to'].   
+000043b0: 2023 2063 6974 6174 696f 6e5f 696e 666f   # citation_info
+000043c0: 203d 2073 656c 662e 6765 745f 6369 7461   = self.get_cita
+000043d0: 7469 6f6e 7328 6f70 696e 696f 6e5f 6964  tions(opinion_id
+000043e0: 2c20 6369 7461 7469 6f6e 7329 0020 2020  , citations).   
+000043f0: 2023 2067 6574 206f 7069 6e69 6f6e 7320   # get opinions 
+00004400: 6369 7465 6420 746f 0000 2020 2020 2320  cited to..    # 
+00004410: 2020 2072 6574 7572 6e00 2020 2020 2369     return.    #i
+00004420: 6620 636f 7572 745f 726f 772e 656d 7074  f court_row.empt
+00004430: 793a 0020 2020 2023 636f 7572 745f 726f  y:.    #court_ro
+00004440: 773a 2073 656c 662e 4461 7461 4672 616d  w: self.DataFram
+00004450: 6520 3d20 636f 7572 7473 5b63 6f75 7274  e = courts[court
+00004460: 735b 2769 6427 5d20 3d3d 2063 6964 5d00  s['id'] == cid].
+00004470: 2020 2020 2363 6964 203d 206c 6973 7428      #cid = list(
+00004480: 646f 636b 6574 5f72 6f77 5b27 636f 7572  docket_row['cour
+00004490: 745f 6964 275d 295b 305d 0020 2020 2023  t_id'])[0].    #
+000044a0: 2020 2020 7265 7475 726e 2000 2020 2020      return .    
+000044b0: 2369 6620 6c65 6e28 646f 636b 6574 5f72  #if len(docket_r
+000044c0: 6f77 2e63 6f6c 756d 6e73 2920 3d3d 2030  ow.columns) == 0
+000044d0: 3a00 2020 2020 2320 7265 7475 726e 2065  :.    # return e
+000044e0: 6172 6c79 2069 6620 7468 6572 6527 7320  arly if there's 
+000044f0: 0000 2020 2020 2364 6f63 6b65 745f 726f  ..    #docket_ro
+00004500: 7720 3d20 646f 636b 6574 735b 646f 636b  w = dockets[dock
+00004510: 6574 735b 2769 6427 5d20 3d3d 2064 6f63  ets['id'] == doc
+00004520: 6b65 745f 6964 5d2e 636f 6d70 7574 6528  ket_id].compute(
+00004530: 2900 2020 2020 2364 6f63 6b65 745f 6964  ).    #docket_id
+00004540: 203d 2069 6e74 2863 6c75 7374 6572 5f72   = int(cluster_r
+00004550: 6f77 5b27 646f 636b 6574 5f69 6427 5d29  ow['docket_id'])
+00004560: 0020 2020 2023 2067 6574 2063 6f72 7265  .    # get corre
+00004570: 7370 6f6e 6469 6e67 2072 6f77 2066 726f  sponding row fro
+00004580: 6d20 646f 636b 6574 2064 6620 6261 7365  m docket df base
+00004590: 6420 6f6e 2063 6c75 7374 6572 206f 7069  d on cluster opi
+000045a0: 6e69 6f6e 2069 6400 0020 2020 2023 636c  nion id..    #cl
+000045b0: 7573 7465 725f 726f 773a 2073 656c 662e  uster_row: self.
+000045c0: 4461 7461 4672 616d 6520 3d20 7365 6c66  DataFrame = self
+000045d0: 2e64 665f 726f 775f 6279 5f76 616c 7565  .df_row_by_value
+000045e0: 2873 656c 662e 6765 745f 6f70 696e 696f  (self.get_opinio
+000045f0: 6e73 5f63 6c75 7374 6572 5f64 6628 292c  ns_cluster_df(),
+00004600: 2027 6964 272c 2063 6c75 7374 6572 5f69   'id', cluster_i
+00004610: 6429 0020 2020 2023 2067 6574 2065 6163  d).    # get eac
+00004620: 6820 636f 7272 6573 706f 6e64 696e 6720  h corresponding 
+00004630: 726f 7720 6672 6f6d 2063 6c75 7374 6572  row from cluster
+00004640: 732c 2064 6f63 6b65 7473 2c20 636f 7572  s, dockets, cour
+00004650: 7473 2062 6173 6564 206f 6e20 6f70 696e  ts based on opin
+00004660: 696f 6e20 6964 0000 2020 2020 2363 6c75  ion id..    #clu
+00004670: 7374 6572 5f69 6420 3d20 6f70 696e 696f  ster_id = opinio
+00004680: 6e5b 2763 6c75 7374 6572 5f69 6427 5d00  n['cluster_id'].
+00004690: 2020 2020 236f 7069 6e69 6f6e 5f69 6420      #opinion_id 
+000046a0: 3d20 6f70 696e 696f 6e5b 2769 6427 5d00  = opinion['id'].
+000046b0: 2020 2020 2363 6974 6174 696f 6e73 203d      #citations =
+000046c0: 2073 656c 662e 6765 745f 6369 7461 7469   self.get_citati
+000046d0: 6f6e 5f64 6628 2900 2020 2020 2363 6f75  on_df().    #cou
+000046e0: 7274 7320 3d20 7365 6c66 2e67 6574 5f63  rts = self.get_c
+000046f0: 6f75 7274 735f 6466 2829 0020 2020 2023  ourts_df().    #
+00004700: 646f 636b 6574 7320 3d20 7365 6c66 2e67  dockets = self.g
+00004710: 6574 5f64 6f63 6b65 7473 5f64 6628 2900  et_dockets_df().
+00004720: 2020 2020 7265 7475 726e 206f 7069 6e69      return opini
+00004730: 6f6e 5b27 6964 275d 0020 2020 2023 7072  on['id'].    #pr
+00004740: 696e 7428 6f70 696e 696f 6e5b 2769 6427  int(opinion['id'
+00004750: 5d29 0020 2064 6566 2070 726f 6365 7373  ]).  def process
+00004760: 5f72 6f77 2873 656c 662c 206f 7069 6e69  _row(self, opini
+00004770: 6f6e 2920 2d3e 2064 6963 743a 0020 2023  on) -> dict:.  #
+00004780: 2070 726f 6365 7373 0020 2020 2020 2000   process.      .
+00004790: 2020 2020 2020 7061 7373 0020 2064 6566        pass.  def
+000047a0: 2067 6574 5f6f 7069 6e69 6f6e 735f 6466   get_opinions_df
+000047b0: 2873 656c 6629 3a00 0020 2020 2020 2072  (self):..      r
+000047c0: 6574 7572 6e20 7365 6c66 2e5f 6466 5f6f  eturn self._df_o
+000047d0: 7069 6e69 6f6e 5f63 6c75 7374 6572 7300  pinion_clusters.
+000047e0: 2020 6465 6620 6765 745f 6f70 696e 696f    def get_opinio
+000047f0: 6e73 5f63 6c75 7374 6572 5f64 6628 7365  ns_cluster_df(se
+00004800: 6c66 293a 0000 2020 2020 2020 7265 7475  lf):..      retu
+00004810: 726e 2073 656c 662e 5f64 665f 646f 636b  rn self._df_dock
+00004820: 6574 7300 2020 6465 6620 6765 745f 646f  ets.  def get_do
+00004830: 636b 6574 735f 6466 2873 656c 6629 3a00  ckets_df(self):.
+00004840: 2020 0020 2020 2020 2072 6574 7572 6e20    .      return 
+00004850: 7365 6c66 2e5f 6466 5f63 6974 6174 696f  self._df_citatio
+00004860: 6e00 2020 6465 6620 6765 745f 6369 7461  n.  def get_cita
+00004870: 7469 6f6e 5f64 6628 7365 6c66 293a 0000  tion_df(self):..
+00004880: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00004890: 662e 5f64 665f 636f 7572 7473 0020 2064  f._df_courts.  d
+000048a0: 6566 2067 6574 5f63 6f75 7274 735f 6466  ef get_courts_df
+000048b0: 2873 656c 6629 3a00 2020 2323 2047 6574  (self):.  ## Get
+000048c0: 7465 7273 0000 2020 2020 2020 7265 7475  ters..      retu
+000048d0: 726e 2073 656c 662e 6373 765f 746f 5f64  rn self.csv_to_d
+000048e0: 6628 666e 206f 7220 2020 6465 6620 696e  f(fn or   def in
+000048f0: 6974 5f64 6f63 6b65 7473 5f64 2020 6465  it_dockets_d  de
+00004900: 6620 2064 6566 2069 6e69 7420 2020 6465  f  def init   de
+00004910: 2020 2064 6566 2069 6e69 745f 646f 636b     def init_dock
+00004920: 6574 735f 6466 2873 656c 662c 2020 2064  ets_df(self,   d
+00004930: 6566 2069 6e69 745f 646f 636b 6574 735f  ef init_dockets_
+00004940: 6466 2873 6520 2064 6566 2069 6e69 745f  df(se  def init_
+00004950: 646f 636b 6574 735f 6466 2873 656c 662c  dockets_df(self,
+00004960: 2066 6e3d 4e6f 6e65 293a 0020 2023 2069   fn=None):.  # i
+00004970: 6e69 7469 616c 697a 6520 646f 636b 6574  nitialize docket
+00004980: 7320 6466 0000 2020 2020 2020 2020 2020  s df..          
+00004990: 2020 646f 636b 6574 2020 6465 6620 696e    docket  def in
+000049a0: 6974 5f64 6f63 6b65 7473 5f64 6628 7365  it_dockets_df(se
+000049b0: 6c66 2c20 2064 6566 2069 6e69 745f 646f  lf,  def init_do
+000049c0: 636b 6574 735f 6466 2873 656c 662c 2066  ckets_df(self, f
+000049d0: 6e3d 4e6f 6e65 293a 0020 2023 2020 6465  n=None):.  #  de
+000049e0: 6620 696e 6974 5f64 6f63 6b65 7473 5f64  f init_dockets_d
+000049f0: 6628 7365 6c66 2c20 666e 2020 6465 6620  f(self, fn  def 
+00004a00: 696e 6974 5f64 6f63 6b65 7473 5f64 6628  init_dockets_df(
+00004a10: 2020 6465 6620 696e 6974 5f64 6f63 6b65    def init_docke
+00004a20: 7473 5f64 6628 7365 6c66 2c20 666e 3d4e  ts_df(self, fn=N
+00004a30: 6f6e 6529 3a00 2020 2020 2064 6566 2069  one):.     def i
 00004a40: 6e69 745f 646f 636b 6574 735f 6466 2873  nit_dockets_df(s
 00004a50: 656c 662c 2066 6e3d 4e6f 6e65 293a 0020  elf, fn=None):. 
 00004a60: 2023 2069 6e69 7469 616c 697a 6520 646f   # initialize do
 00004a70: 636b 6574 7320 6466 0000 2020 2020 2020  ckets df..      
 00004a80: 7265 7475 726e 2073 656c 662e 6373 765f  return self.csv_
 00004a90: 746f 5f64 6628 666e 206f 7220 7365 6c66  to_df(fn or self
 00004aa0: 2e5f 6f70 696e 696f 6e5f 636c 7573 7465  ._opinion_cluste
@@ -1274,36 +1274,36 @@
 00004f90: 7374 2829 0020 2020 2063 6974 6573 5f74  st().    cites_t
 00004fa0: 6f20 3d20 6466 5f63 6974 6174 696f 6e73  o = df_citations
 00004fb0: 5b64 665f 6369 7461 7469 6f6e 735b 2763  [df_citations['c
 00004fc0: 6974 696e 675f 6f70 696e 696f 6e5f 6964  iting_opinion_id
 00004fd0: 275d 203d 3d20 6f70 696e 696f 6e5f 6964  '] == opinion_id
 00004fe0: 5d5b 2763 6974 6564 5f6f 7069 6e69 6f6e  ]['cited_opinion
 00004ff0: 5f69 6427 5d2e 746f 5f6c 6973 7428 2900  _id'].to_list().
-00005000: 6164 0000 9006 0000 c407 0000 0010 0000  ad..............
-00005010: 4600 0000 0000 0000 e40f 0000 c20f 0000  F...............
-00005020: b90f 0000 b80f 0000 480f 0000 1d0f 0000  ........H.......
-00005030: 1c0f 0000 fd0e 0000 d60e 0000 a10e 0000  ................
-00005040: a00e 0000 930e 0000 780e 0000 5b0e 0000  ........x...[...
-00005050: 5a0e 0000 3d0e 0000 1e0e 0000 1b0e 0000  Z...=...........
-00005060: ff0d 0000 e10d 0000 e00d 0000 bb0d 0000  ................
-00005070: 940d 0000 930d 0000 760d 0000 6b0d 0000  ........v...k...
-00005080: 640d 0000 580d 0000 2e0d 0000 0a0d 0000  d...X...........
-00005090: e80c 0000 c10c 0000 a20c 0000 7b0c 0000  ............{...
-000050a0: 7a0c 0000 260c 0000 bd0b 0000 bc0b 0000  z...&...........
-000050b0: 750b 0000 470b 0000 080b 0000 070b 0000  u...G...........
-000050c0: e80a 0000 c30a 0000 b30a 0000 890a 0000  ................
-000050d0: 4d0a 0000 350a 0000 260a 0000 250a 0000  M...5...&...%...
-000050e0: 090a 0000 cb09 0000 a209 0000 7909 0000  ............y...
-000050f0: 7809 0000 6c09 0000 4c09 0000 3909 0000  x...l...L...9...
-00005100: 2b09 0000 1609 0000 cd08 0000 a208 0000  +...............
-00005110: 9c08 0000 9308 0000 5008 0000 1308 0000  ........P.......
-00005120: 1208 0000 0608 0000 ec07 0000 c407 0000  ................
-00005130: c307 0000 a307 0000 0000 0000 0000 0000  ................
-00005140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005000: 6164 0000 3008 0000 2c09 0000 0010 0000  ad..0...,.......
+00005010: 3800 0000 0000 0000 ff0f 0000 e30f 0000  8...............
+00005020: bb0f 0000 800f 0000 5c0f 0000 570f 0000  ........\...W...
+00005030: 0e0f 0000 dd0e 0000 960e 0000 830e 0000  ................
+00005040: 7e0e 0000 6c0e 0000 5a0e 0000 570e 0000  ~...l...Z...W...
+00005050: 440e 0000 240e 0000 100e 0000 f90d 0000  D...$...........
+00005060: d70d 0000 b80d 0000 990d 0000 800d 0000  ................
+00005070: 600d 0000 3e0d 0000 1b0d 0000 f30c 0000  `...>...........
+00005080: d50c 0000 cf0c 0000 bf0c 0000 ae0c 0000  ................
+00005090: 920c 0000 790c 0000 600c 0000 460c 0000  ....y...`...F...
+000050a0: 2d0c 0000 1a0c 0000 000c 0000 e40b 0000  -...............
+000050b0: c70b 0000 a40b 0000 980b 0000 650b 0000  ............e...
+000050c0: 380b 0000 f90a 0000 c60a 0000 b30a 0000  8...............
+000050d0: 610a 0000 e609 0000 b309 0000 ac09 0000  a...............
+000050e0: 9209 0000 7409 0000 5609 0000 5509 0000  ....t...V...U...
+000050f0: 3a09 0000 2c09 0000 2b09 0000 e208 0000  :...,...+.......
+00005100: af08 0000 b708 0000 ac08 0000 9d08 0000  ................
+00005110: 7108 0000 3708 0000 1b08 0000 e307 0000  q...7...........
+00005120: c007 0000 9f07 0000 5b07 0000 2107 0000  ........[...!...
+00005130: 0107 0000 e006 0000 a606 0000 7b06 0000  ............{...
+00005140: 4506 0000 0806 0000 df05 0000 c405 0000  E...............
+00005150: b805 0000 c805 0000 b305 0000 0000 0000  ................
 00005160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000051a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000051b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000051c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1365,172 +1365,684 @@
 00005540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000055a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000055b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000055c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000055d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000055e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000055f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000056a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000056b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000056c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000056d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000056e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000056f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000057a0: 0000 0020 2020 2020 2020 2027 7572 6c27  ...        'url'
-000057b0: 3a20 6f70 696e 696f 6e5b 2764 6f77 6e6c  : opinion['downl
-000057c0: 6f61 6420 2020 2020 2020 2020 2775 726c  oad         'url
-000057d0: 273a 206f 7069 6e69 6f6e 5b27 646f 776e  ': opinion['down
-000057e0: 6c6f 6164 5f75 726c 275d 2c00 2020 2020  load_url'],.    
-000057f0: 2020 2020 2769 6427 3a20 636c 7573 7465      'id': cluste
-00005800: 725f 6964 2c00 2020 2020 6f62 6a20 3d20  r_id,.    obj = 
-00005810: 7b00 0020 2020 2064 6174 655f 7465 726d  {..    date_term
-00005820: 696e 6174 6564 203d 206c 6973 7428 646f  inated = list(do
-00005830: 636b 6574 5f72 6f77 5b27 6461 7465 5f74  cket_row['date_t
-00005840: 6572 6d69 6e61 7465 6427 5d29 5b30 5d00  erminated'])[0].
-00005850: 2020 2020 2320 736f 6d65 7469 6d65 7320      # sometimes 
-00005860: 6461 7465 5f74 6572 6d69 6e61 7465 6420  date_terminated 
-00005870: 6d61 7920 6265 206d 6973 7369 6e67 2061  may be missing a
-00005880: 6e64 2072 6563 6f72 6465 6420 6173 204e  nd recorded as N
-00005890: 614e 0020 2020 2020 2020 2000 2020 2020  aN.        .    
-000058a0: 5d00 2020 2020 2020 2020 6966 206e 6f74  ].        if not
-000058b0: 2072 652e 6d61 7463 6828 275b 636a 5d3f   re.match('[cj]?
-000058c0: 6a5c 2e27 2c20 6a75 6467 6529 0020 2020  j\.', judge).   
-000058d0: 2020 2020 2020 2020 2028 6a75 6467 6573           (judges
-000058e0: 2e69 6c6f 635b 305d 2e73 706c 6974 2827  .iloc[0].split('
-000058f0: 2c27 2920 6966 206a 7564 6765 732e 6e6f  ,') if judges.no
-00005900: 746e 6128 292e 626f 6f6c 2829 2065 6c73  tna().bool() els
-00005910: 6520 5b5d 2900 2020 2020 2020 2020 666f  e []).        fo
-00005920: 7220 6a75 6467 6520 696e 0020 2020 2020  r judge in.     
-00005930: 2020 206a 7564 6765 0020 2020 206a 7564     judge.    jud
-00005940: 6765 5f6c 6973 7420 3d20 5b00 2020 2020  ge_list = [.    
-00005950: 6a75 6467 6573 203d 2063 6c75 7374 6572  judges = cluster
-00005960: 5f72 6f77 2e6a 7564 6765 7300 2020 2020  _row.judges.    
-00005970: 236a 7564 6765 7300 0020 2020 2063 6974  #judges..    cit
-00005980: 6564 5f62 7920 3d20 6369 7461 7469 6f6e  ed_by = citation
-00005990: 5f69 6e66 6f5b 2763 6974 6564 5f62 7927  _info['cited_by'
-000059a0: 5d00 2020 2020 6369 7465 735f 746f 203d  ].    cites_to =
-000059b0: 2063 6974 6174 696f 6e5f 696e 666f 5b27   citation_info['
-000059c0: 6369 7465 735f 746f 275d 0020 2020 2063  cites_to'].    c
-000059d0: 6974 6174 696f 6e5f 696e 666f 203d 2073  itation_info = s
-000059e0: 656c 662e 6765 745f 6369 7461 7469 6f6e  elf.get_citation
-000059f0: 7328 6f70 696e 696f 6e5f 6964 2c20 6369  s(opinion_id, ci
-00005a00: 7461 7469 6f6e 7329 0020 2020 2023 2067  tations).    # g
-00005a10: 6574 206f 7069 6e69 6f6e 7320 6369 7465  et opinions cite
-00005a20: 6420 746f 0000 2020 2020 2020 2020 7265  d to..        re
-00005a30: 7475 726e 0020 2020 2069 6620 636f 7572  turn.    if cour
-00005a40: 745f 726f 772e 656d 7074 793a 0020 2020  t_row.empty:.   
-00005a50: 2063 6f75 7274 5f72 6f77 3a20 7365 6c66   court_row: self
-00005a60: 2e44 6174 6146 7261 6d65 203d 2063 6f75  .DataFrame = cou
-00005a70: 7274 735b 636f 7572 7473 5b27 6964 275d  rts[courts['id']
-00005a80: 203d 3d20 6369 645d 0020 2020 2063 6964   == cid].    cid
-00005a90: 203d 206c 6973 7428 646f 636b 6574 5f72   = list(docket_r
-00005aa0: 6f77 5b27 636f 7572 745f 6964 275d 295b  ow['court_id'])[
-00005ab0: 305d 0020 2020 2020 2020 2072 6574 7572  0].        retur
-00005ac0: 6e20 0020 2020 2069 6620 6c65 6e28 646f  n .    if len(do
-00005ad0: 636b 6574 5f72 6f77 2e63 6f6c 756d 6e73  cket_row.columns
-00005ae0: 2920 3d3d 2030 3a00 2020 2020 2320 7265  ) == 0:.    # re
-00005af0: 7475 726e 2065 6172 6c79 2069 6620 7468  turn early if th
-00005b00: 6572 6527 7320 0000 2020 2020 646f 636b  ere's ..    dock
-00005b10: 6574 5f72 6f77 203d 2064 6f63 6b65 7473  et_row = dockets
-00005b20: 5b64 6f63 6b65 7473 5b27 6964 275d 203d  [dockets['id'] =
-00005b30: 3d20 646f 636b 6574 5f69 645d 2e63 6f6d  = docket_id].com
-00005b40: 7075 7465 2829 0020 2020 2064 6f63 6b65  pute().    docke
-00005b50: 745f 6964 203d 2069 6e74 2863 6c75 7374  t_id = int(clust
-00005b60: 6572 5f72 6f77 5b27 646f 636b 6574 5f69  er_row['docket_i
-00005b70: 6427 5d29 0020 2020 2023 2067 6574 2063  d']).    # get c
-00005b80: 6f72 7265 7370 6f6e 6469 6e67 2072 6f77  orresponding row
-00005b90: 2066 726f 6d20 646f 636b 6574 2064 6620   from docket df 
-00005ba0: 6261 7365 6420 6f6e 2063 6c75 7374 6572  based on cluster
-00005bb0: 206f 7069 6e69 6f6e 2069 6400 0020 2020   opinion id..   
-00005bc0: 2063 6c75 7374 6572 5f72 6f77 3a20 7365   cluster_row: se
-00005bd0: 6c66 2e44 6174 6146 7261 6d65 203d 2073  lf.DataFrame = s
-00005be0: 656c 662e 6466 5f72 6f77 5f62 795f 7661  elf.df_row_by_va
-00005bf0: 6c75 6528 7365 6c66 2e67 6574 5f6f 7069  lue(self.get_opi
-00005c00: 6e69 6f6e 735f 636c 7573 7465 725f 6466  nions_cluster_df
-00005c10: 2829 2c20 2769 6427 2c20 636c 7573 7465  (), 'id', cluste
-00005c20: 725f 6964 2900 2020 2020 2320 6765 7420  r_id).    # get 
-00005c30: 6561 6368 2063 6f72 7265 7370 6f6e 6469  each correspondi
-00005c40: 6e67 2072 6f77 2066 726f 6d20 636c 7573  ng row from clus
-00005c50: 7465 7273 2c20 646f 636b 6574 732c 2063  ters, dockets, c
-00005c60: 6f75 7274 7320 6261 7365 6420 6f6e 206f  ourts based on o
-00005c70: 7069 6e69 6f6e 2069 6400 0020 2020 2063  pinion id..    c
-00005c80: 6c75 7374 6572 5f69 6420 3d20 6f70 696e  luster_id = opin
-00005c90: 696f 6e5b 2763 6c75 7374 6572 5f69 6427  ion['cluster_id'
-00005ca0: 5d00 2020 2020 6f70 696e 696f 6e5f 6964  ].    opinion_id
-00005cb0: 203d 206f 7069 6e69 6f6e 5b27 6964 275d   = opinion['id']
-00005cc0: 0020 2020 2063 6974 6174 696f 6e73 203d  .    citations =
-00005cd0: 2073 656c 662e 6765 745f 6369 7461 7469   self.get_citati
-00005ce0: 6f6e 5f64 6628 2900 2020 2020 636f 7572  on_df().    cour
-00005cf0: 7473 203d 2073 656c 662e 6765 745f 636f  ts = self.get_co
-00005d00: 7572 7473 5f64 6628 2900 2020 2020 646f  urts_df().    do
-00005d10: 636b 6574 7320 3d20 7365 6c66 2e67 6574  ckets = self.get
-00005d20: 5f64 6f63 6b65 7473 5f64 6628 2900 2020  _dockets_df().  
-00005d30: 6465 6620 7072 6f63 6573 735f 726f 7728  def process_row(
-00005d40: 7365 6c66 2c20 6f70 696e 696f 6e29 202d  self, opinion) -
-00005d50: 3e20 6469 6374 3a00 2020 2320 7072 6f63  > dict:.  # proc
-00005d60: 6573 7300 2020 2020 2020 0020 2020 2020  ess.      .     
-00005d70: 2070 6173 7300 2020 6465 6620 6765 745f   pass.  def get_
-00005d80: 6f70 696e 696f 6e73 5f64 6628 7365 6c66  opinions_df(self
-00005d90: 293a 0000 2020 2020 2020 7265 7475 726e  ):..      return
-00005da0: 2073 656c 662e 5f64 665f 6f70 696e 696f   self._df_opinio
-00005db0: 6e5f 636c 7573 7465 7273 0020 2064 6566  n_clusters.  def
-00005dc0: 2067 6574 5f6f 7069 6e69 6f6e 735f 636c   get_opinions_cl
-00005dd0: 7573 7465 725f 6466 2873 656c 6629 3a00  uster_df(self):.
-00005de0: 0020 2020 2020 2072 6574 7572 6e20 7365  .      return se
-00005df0: 6c66 2e5f 6466 5f64 6f63 6b65 7473 0020  lf._df_dockets. 
-00005e00: 2064 6566 2067 6574 5f64 6f63 6b65 7473   def get_dockets
-00005e10: 5f64 6628 7365 6c66 293a 0020 2000 2020  _df(self):.  .  
-00005e20: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00005e30: 5f64 665f 6369 7461 7469 6f6e 0020 2064  _df_citation.  d
-00005e40: 6566 2067 6574 5f63 6974 6174 696f 6e5f  ef get_citation_
-00005e50: 6466 2873 656c 6629 3a00 0020 2020 2020  df(self):..     
-00005e60: 2072 6574 7572 6e20 7365 6c66 2e5f 6466   return self._df
-00005e70: 5f63 6f75 7274 7300 2020 6465 6620 6765  _courts.  def ge
-00005e80: 745f 636f 7572 7473 5f64 6628 7365 6c66  t_courts_df(self
-00005e90: 293a 0020 2023 2320 4765 7474 6572 7300  ):.  ## Getters.
-00005ea0: 0020 2020 2020 2072 6574 7572 6e20 7365  .      return se
-00005eb0: 6c66 2e63 7376 5f74 6f5f 6466 2866 6e20  lf.csv_to_df(fn 
-00005ec0: 6f72 2073 656c 662e 5f63 6974 6174 696f  or self._citatio
-00005ed0: 6e5f 666e 2900 2020 6465 6620 696e 6974  n_fn).  def init
-00005ee0: 5f63 6974 6174 696f 6e5f 6466 2873 656c  _citation_df(sel
-00005ef0: 662c 2066 6e3d 4e6f 6e65 293a 0020 2023  f, fn=None):.  #
-00005f00: 2069 6e69 7469 616c 697a 6520 6369 7461   initialize cita
-00005f10: 7469 6f6e 206d 6170 2064 6600 0020 2020  tion map df..   
-00005f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005f30: 2020 2020 2020 626c 6f63 6b73 697a 653d        blocksize=
-00005f40: 2233 324d 4222 2900 2020 2020 2020 7265  "32MB").      re
-00005f50: 7475 726e 2064 642e 7265 6164 5f63 7376  turn dd.read_csv
-00005f60: 2866 6e20 6f72 2073 656c 662e 5f64 6f63  (fn or self._doc
-00005f70: 6b65 7473 5f66 6e2c 2064 7479 7065 3d6d  kets_fn, dtype=m
-00005f80: 795f 7479 7065 732c 2075 7365 636f 6c73  y_types, usecols
-00005f90: 3d5b 2763 6f75 7274 5f69 6427 2c20 2769  =['court_id', 'i
-00005fa0: 6427 2c20 2764 6174 655f 7465 726d 696e  d', 'date_termin
-00005fb0: 6174 6564 275d 2c00 0020 2020 2020 207d  ated'],..      }
-00005fc0: 2000 2020 2020 2020 2764 6174 655f 7465   .      'date_te
-00005fd0: 726d 696e 6174 6564 273a 2027 7374 7269  rminated': 'stri
-00005fe0: 6e67 2700 2020 2020 2020 2763 6f75 7274  ng'.      'court
-00005ff0: 5f69 6427 3a20 2773 7472 696e 6727 2c00  _id': 'string',.
+000055b0: 0000 0020 204e 6f20 2020 4e6f 4361 702e  ...  No   NoCap.
+000055c0: 636c 6928 2020 4e6f 4361 702e 636c 6928  cli(  NoCap.cli(
+000055d0: 2900 6966 205f 5f6e 616d 655f 5f20 3d20  ).if __name__ = 
+000055e0: 204e 6f43 6170 2e63 6c69 2829 0069 6620   NoCap.cli().if 
+000055f0: 5f5f 6e61 6d65 5f5f 203d 3d20 275f 5f6d  __name__ == '__m
+00005600: 6169 6e5f 5f27 3a00 2020 4e6f 4361 702e  ain__':.  NoCap.
+00005610: 636c 6928 2900 6966 205f 5f6e 616d 655f  cli().if __name_
+00005620: 5f20 3d3d 2027 5f5f 6d61 696e 5f5f 273a  _ == '__main__':
+00005630: 0000 2020 2020 6c6f 672e 6465 6275 6728  ..    log.debug(
+00005640: 2865 6e64 2d20 204e 6f43 6170 2e63 6c69  (end-  NoCap.cli
+00005650: 2829 0069 6620 5f5f 6e61 6d65 5f5f 203d  ().if __name__ =
+00005660: 3d20 275f 5f6d 6169 6e5f 5f27 3a00 0020  = '__main__':.. 
+00005670: 2020 206c 6f67 2e64 6562 7520 204e 6f43     log.debu  NoC
+00005680: 6170 2e63 6c69 2829 0069 6620 5f5f 6e61  ap.cli().if __na
+00005690: 6d65 5f5f 203d 3d20 275f 5f6d 6169 6e5f  me__ == '__main_
+000056a0: 5f27 3a00 0020 2020 4e6f 4361 702e 636c  _':..   NoCap.cl
+000056b0: 6928 2900 6966 205f 5f6e 616d 655f 5f20  i().if __name__ 
+000056c0: 3d3d 2027 5f5f 6d61 696e 5f5f 273a 0000  == '__main__':..
+000056d0: 2020 2020 6c6f 672e 6465 6275 6728 2865      log.debug((e
+000056e0: 2020 4e6f 4361 702e 636c 6928 2900 6966    NoCap.cli().if
+000056f0: 205f 5f6e 616d 655f 5f20 3d3d 2027 5f5f   __name__ == '__
+00005700: 6d20 204e 6f43 6170 2e63 6c69 2829 0069  m  NoCap.cli().i
+00005710: 6620 5f5f 6e61 6d65 5f5f 203d 3d20 275f  f __name__ == '_
+00005720: 5f20 204e 6f43 6170 2e63 6c69 2829 0069  _  NoCap.cli().i
+00005730: 6620 5f5f 6e61 6d65 5f5f 203d 3d20 275f  f __name__ == '_
+00005740: 5f6d 6169 6e5f 5f27 3a00 0020 2020 206c  _main__':..    l
+00005750: 6f67 2e64 6562 7567 2828 6520 204e 6f43  og.debug((e  NoC
+00005760: 6170 2e63 6c69 2829 0069 6620 5f5f 6e61  ap.cli().if __na
+00005770: 6d65 5f5f 203d 3d20 275f 5f6d 6169 6e5f  me__ == '__main_
+00005780: 5f27 3a00 0020 2020 206c 6f67 2e64 6562  _':..    log.deb
+00005790: 7567 2828 656e 642d 7374 6172 7429 2f20  ug((end-start)/ 
+000057a0: 204e 6f43 6170 2e63 6c69 2829 0069 6620   NoCap.cli().if 
+000057b0: 5f5f 6e61 6d65 5f5f 203d 3d20 275f 5f6d  __name__ == '__m
+000057c0: 2020 4e6f 4361 702e 636c 6928 2900 6966    NoCap.cli().if
+000057d0: 205f 5f6e 616d 655f 5f20 3d3d 2027 5f5f   __name__ == '__
+000057e0: 6d61 6920 204e 6f43 6170 2e63 6c69 2829  mai  NoCap.cli()
+000057f0: 0069 6620 5f5f 6e61 6d65 5f5f 203d 3d20  .if __name__ == 
+00005800: 275f 5f6d 6169 6e5f 5f27 3a00 0020 2020  '__main__':..   
+00005810: 206c 6f67 2e64 6562 7567 2820 204e 6f43   log.debug(  NoC
+00005820: 6170 2e63 6c69 2829 0069 6620 5f5f 6e61  ap.cli().if __na
+00005830: 6d65 5f5f 203d 3d20 204e 6f43 6170 2e63  me__ ==  NoCap.c
+00005840: 6c69 2829 0069 6620 5f5f 6e61 6d65 5f5f  li().if __name__
+00005850: 203d 3d20 275f 5f6d 6169 6e5f 5f27 3a00   == '__main__':.
+00005860: 0020 2020 206c 6f67 2e64 6562 7567 2828  .    log.debug((
+00005870: 6520 204e 6f43 6170 2e63 6c69 2829 0069  e  NoCap.cli().i
+00005880: 6620 5f5f 6e61 6d65 5f5f 203d 3d20 275f  f __name__ == '_
+00005890: 5f6d 6169 6e5f 5f27 3a00 0020 2020 204e  _main__':..    N
+000058a0: 6f43 6170 2e63 6c69 2829 0069 2020 4e20  oCap.cli().i  N 
+000058b0: 204e 6f43 6170 2e63 6c69 2829 0069 6620   NoCap.cli().if 
+000058c0: 5f5f 6e61 6d65 5f5f 203d 3d20 275f 5f20  __name__ == '__ 
+000058d0: 204e 6f43 6170 2e63 6c69 2829 0069 6620   NoCap.cli().if 
+000058e0: 5f5f 2020 4e6f 4361 702e 636c 6928 2900  __  NoCap.cli().
+000058f0: 6966 205f 5f6e 6120 204e 6f43 6170 2e63  if __na  NoCap.c
+00005900: 6c69 2829 0069 2020 204e 6f43 6170 2e63  li().i   NoCap.c
+00005910: 6c69 2829 0069 6620 5f5f 6e61 6d65 5f5f  li().if __name__
+00005920: 203d 3d20 275f 5f6d 6169 2020 2020 4e6f   == '__mai    No
+00005930: 4361 702e 636c 6928 2900 6966 205f 5f6e  Cap.cli().if __n
+00005940: 616d 655f 5f20 3d3d 2027 5f5f 6d61 696e  ame__ == '__main
+00005950: 5f5f 273a 0000 2020 2020 6c6f 672e 6465  __':..    log.de
+00005960: 6275 6728 2865 6e64 2d73 7461 7274 292f  bug((end-start)/
+00005970: 3630 2900 2020 2020 656e 6420 3d20 7469  60).    end = ti
+00005980: 6d65 2e70 6572 665f 636f 756e 7465 7228  me.perf_counter(
+00005990: 2900 2020 2020 2020 7365 6c66 2e70 726f  ).      self.pro
+000059a0: 6365 7373 5f64 6628 6466 2900 2020 2020  cess_df(df).    
+000059b0: 2020 0020 2020 2020 206c 6f67 2e64 6562    .      log.deb
+000059c0: 7567 2866 274e 6f77 2072 6561 6469 6e67  ug(f'Now reading
+000059d0: 207b 6c65 6e28 6466 297d 206f 7069 6e69   {len(df)} opini
+000059e0: 6f6e 7327 2900 2020 2020 666f 7220 6466  ons').    for df
+000059f0: 2069 6e20 7064 2e72 6561 645f 6373 7628   in pd.read_csv(
+00005a00: 7365 6c66 2e5f 6f70 696e 696f 6e73 5f66  self._opinions_f
+00005a10: 6e2c 2063 6875 6e6b 7369 7a65 3d6d 6178  n, chunksize=max
+00005a20: 5f72 6f77 732c 2064 7479 7065 3d6f 7069  _rows, dtype=opi
+00005a30: 6e69 6f6e 5f64 7479 7065 732c 2070 6172  nion_dtypes, par
+00005a40: 7365 5f64 6174 6573 3d4e 6f6e 652c 2075  se_dates=None, u
+00005a50: 7365 636f 6c73 3d75 7365 636f 6c73 293a  secols=usecols):
+00005a60: 0020 2020 2023 636c 6965 6e74 203d 2043  .    #client = C
+00005a70: 6c69 656e 7428 7468 7265 6164 735f 7065  lient(threads_pe
+00005a80: 725f 776f 726b 6572 3d34 2c20 6e5f 776f  r_worker=4, n_wo
+00005a90: 726b 6572 7320 3d20 696e 7428 6d70 2e63  rkers = int(mp.c
+00005aa0: 7075 5f63 6f75 6e74 2829 202a 202e 3430  pu_count() * .40
+00005ab0: 2929 0020 2020 206c 6f67 2e64 6562 7567  )).    log.debug
+00005ac0: 286d 7367 2900 2020 2020 6d73 6720 3d20  (msg).    msg = 
+00005ad0: 6622 4669 6c65 2053 697a 6520 6973 203a  f"File Size is :
+00005ae0: 207b 7374 7228 6669 6c65 5f73 697a 655f   {str(file_size_
+00005af0: 6762 297d 2047 4222 0020 2020 206c 6f67  gb)} GB".    log
+00005b00: 2e64 6562 7567 2866 2749 6d70 6f72 7469  .debug(f'Importi
+00005b10: 6e67 207b 7365 6c66 2e5f 6f70 696e 696f  ng {self._opinio
+00005b20: 6e73 5f66 6e7d 2061 7320 6120 6461 7461  ns_fn} as a data
+00005b30: 6672 616d 6527 2900 2020 2020 6669 6c65  frame').    file
+00005b40: 5f73 697a 655f 6762 203d 2072 6f75 6e64  _size_gb = round
+00005b50: 2866 696c 655f 7369 7a65 2f31 302a 2a39  (file_size/10**9
+00005b60: 2c20 3229 0020 2020 2066 696c 655f 7369  , 2).    file_si
+00005b70: 7a65 203d 206f 732e 7061 7468 2e67 6574  ze = os.path.get
+00005b80: 7369 7a65 2873 656c 662e 5f6f 7069 6e69  size(self._opini
+00005b90: 6f6e 735f 666e 2900 2020 2020 2020 2020  ons_fn).        
+00005ba0: 2020 5d00 2020 2020 2020 2020 2020 2027    ].           '
+00005bb0: 6c6f 6361 6c5f 7061 7468 2720 2020 2020  local_path'     
+00005bc0: 2020 2020 2020 0020 2020 2020 2020 2020        .         
+00005bd0: 2020 2768 746d 6c5f 616e 6f6e 5f32 3032    'html_anon_202
+00005be0: 3027 2c00 2020 2020 2020 2020 2020 2027  0',.           '
+00005bf0: 6874 6d6c 5f63 6f6c 756d 6269 6127 2c00  html_columbia',.
+00005c00: 2020 2020 2020 2020 2020 2027 6874 6d6c             'html
+00005c10: 5f6c 6177 626f 7827 2c00 2020 2020 2020  _lawbox',.      
+00005c20: 2020 2020 2027 6874 6d6c 272c 0020 2020       'html',.   
+00005c30: 2020 2020 2020 2020 2770 6c61 696e 5f74          'plain_t
+00005c40: 6578 7427 2c00 2020 2020 2020 2020 2020  ext',.          
+00005c50: 2027 786d 6c5f 6861 7276 6172 6427 2c00   'xml_harvard',.
+00005c60: 2020 2020 2020 2020 2020 2027 636c 7573             'clus
+00005c70: 7465 725f 6964 272c 0020 2020 2020 2020  ter_id',.       
+00005c80: 2020 2020 276c 6f63 616c 5f70 6174 6827      'local_path'
+00005c90: 2c00 2020 2020 2020 2020 2020 2027 646f  ,.           'do
+00005ca0: 776e 6c6f 6164 5f75 726c 272c 2000 2020  wnload_url', .  
+00005cb0: 2020 2020 2020 2020 2027 6964 272c 0020           'id',. 
+00005cc0: 2020 2075 7365 636f 6c73 203d 205b 0020     usecols = [. 
+00005cd0: 2020 207d 0020 2020 2020 2020 2027 6c6f     }.        'lo
+00005ce0: 6361 6c5f 7061 7468 273a 2773 7472 696e  cal_path':'strin
+00005cf0: 6727 0020 2020 2020 2020 2027 6874 6d6c  g'.        'html
+00005d00: 5f77 6974 685f 6369 7461 7469 6f6e 7327  _with_citations'
+00005d10: 3a27 7374 7269 6e67 272c 0020 2020 2020  :'string',.     
+00005d20: 2020 2027 6874 6d6c 5f61 6e6f 6e5f 3230     'html_anon_20
+00005d30: 3230 273a 2773 7472 696e 6727 2c00 2020  20':'string',.  
+00005d40: 2020 2020 2020 2768 746d 6c5f 636f 6c75        'html_colu
+00005d50: 6d62 6961 273a 2773 7472 696e 6727 2c00  mbia':'string',.
+00005d60: 2020 2020 2020 2020 2768 746d 6c5f 6c61          'html_la
+00005d70: 7762 6f78 273a 2773 7472 696e 6727 2c00  wbox':'string',.
+00005d80: 2020 2020 2020 2020 2768 746d 6c27 3a27          'html':'
+00005d90: 7374 7269 6e67 272c 0020 2020 2020 2020  string',.       
+00005da0: 2027 706c 6169 6e5f 7465 7874 273a 2773   'plain_text':'s
+00005db0: 7472 696e 6727 2c00 2020 2020 2020 2020  tring',.        
+00005dc0: 276c 6f63 616c 5f70 6174 6827 3a27 7374  'local_path':'st
+00005dd0: 7269 6e67 272c 0020 2020 2020 2020 2027  ring',.        '
+00005de0: 646f 776e 6c6f 6164 5f75 726c 273a 2027  download_url': '
+00005df0: 7374 7269 6e67 272c 0020 2020 206f 7069  string',.    opi
+00005e00: 6e69 6f6e 5f64 7479 7065 7320 3d20 7b00  nion_dtypes = {.
+00005e10: 2020 2020 6d61 785f 726f 7773 203d 2031      max_rows = 1
+00005e20: 3030 3000 2020 2020 7374 6172 7420 3d20  000.    start = 
+00005e30: 7469 6d65 2e70 6572 665f 636f 756e 7465  time.perf_counte
+00005e40: 7228 2900 2020 6465 6620 7374 6172 7428  r().  def start(
+00005e50: 7365 6c66 293a 0020 2000 2020 2020 7072  self):.  .    pr
+00005e60: 696e 7428 2774 6573 7427 2900 2020 6465  int('test').  de
+00005e70: 6620 7465 7374 2873 656c 6629 3a00 2020  f test(self):.  
+00005e80: 2020 0020 2020 2070 7269 6e74 2872 6573    .    print(res
+00005e90: 756c 7473 2900 2020 2020 7265 7375 6c74  ults).    result
+00005ea0: 7320 3d20 6462 2e6d 6170 2873 656c 662e  s = db.map(self.
+00005eb0: 7072 6f63 6573 735f 726f 772c 2062 292e  process_row, b).
+00005ec0: 746f 5f74 6578 7466 696c 6573 2827 6461  to_textfiles('da
+00005ed0: 7461 2f2a 2e6a 736f 6e6c 2729 0020 2020  ta/*.jsonl').   
+00005ee0: 2023 7072 696e 7428 6c69 7374 286d 6170   #print(list(map
+00005ef0: 2873 656c 662e 7072 6f63 6573 735f 726f  (self.process_ro
+00005f00: 772c 2064 665f 6469 6374 2929 2900 2020  w, df_dict))).  
+00005f10: 2020 6220 3d20 6462 2e66 726f 6d5f 7365    b = db.from_se
+00005f20: 7175 656e 6365 2864 665f 6469 6374 2c20  quence(df_dict, 
+00005f30: 6e70 6172 7469 7469 6f6e 733d 696e 7428  npartitions=int(
+00005f40: 6d70 2e63 7075 5f63 6f75 6e74 2829 202a  mp.cpu_count() *
+00005f50: 202e 3830 2929 0020 2020 2000 2020 2020   .80)).    .    
+00005f60: 6466 5f64 6963 7420 3d20 6466 2e74 6f5f  df_dict = df.to_
+00005f70: 6469 6374 2827 7265 636f 7264 7327 2900  dict('records').
+00005f80: 2020 2020 6c6f 672e 6465 6275 6728 2770      log.debug('p
+00005f90: 7269 6e74 696e 6720 6d69 6e69 206f 7069  rinting mini opi
+00005fa0: 6e69 6f6e 2064 6174 6166 7261 6d65 2061  nion dataframe a
+00005fb0: 7320 6120 6469 6374 2729 0020 2020 206c  s a dict').    l
+00005fc0: 6f67 2e64 6562 7567 2827 7072 6f63 6573  og.debug('proces
+00005fd0: 735f 6466 3a20 636c 6965 6e74 2e6d 6170  s_df: client.map
+00005fe0: 2729 0020 2064 6566 2070 726f 6365 7373  ').  def process
+00005ff0: 5f64 6628 7365 6c66 2c20 6466 293a 0000  _df(self, df):..
+00006000: 6164 0000 be0a 0000 6e0b 0000 0010 0000  ad......n.......
+00006010: 2500 0000 0000 0000 ed0f 0000 d10f 0000  %...............
+00006020: af0f 0000 a60f 0000 a50f 0000 800f 0000  ................
+00006030: 4b0f 0000 1c0f 0000 e50e 0000 b00e 0000  K...............
+00006040: 9b0e 0000 9a0e 0000 2a0e 0000 ff0d 0000  ........*.......
+00006050: fe0d 0000 fd0d 0000 e10d 0000 b90d 0000  ................
+00006060: 990d 0000 750d 0000 480d 0000 1d0d 0000  ....u...H.......
+00006070: ea0c 0000 d70c 0000 d60c 0000 b60c 0000  ................
+00006080: a00c 0000 820c 0000 590c 0000 3e0c 0000  ........Y...>...
+00006090: eb0b 0000 ea0b 0000 cc0b 0000 8a0b 0000  ................
+000060a0: 890b 0000 710b 0000 6e0b 0000 0a0c 0000  ....q...n.......
+000060b0: e20b 0000 c60b 0000 9d0b 0000 7f0b 0000  ................
+000060c0: 570b 0000 370b 0000 130b 0000 fd0a 0000  W...7...........
+000060d0: ca0a 0000 c70a 0000 bb0a 0000 910a 0000  ................
+000060e0: 740a 0000 500a 0000 2e0a 0000 070a 0000  t...P...........
+000060f0: e809 0000 c109 0000 c009 0000 6c09 0000  ............l...
+00006100: 0309 0000 0209 0000 bb08 0000 8d08 0000  ................
+00006110: 4e08 0000 4d08 0000 2e08 0000 0908 0000  N...M...........
+00006120: f907 0000 cf07 0000 9307 0000 7b07 0000  ............{...
+00006130: 6c07 0000 6b07 0000 4f07 0000 1107 0000  l...k...O.......
+00006140: e806 0000 bf06 0000 be06 0000 b106 0000  ................
+00006150: 9106 0000 7e06 0000 7006 0000 5b06 0000  ....~...p...[...
+00006160: 1206 0000 e705 0000 e105 0000 d705 0000  ................
+00006170: 9305 0000 5605 0000 2e05 0000 0705 0000  ....V...........
+00006180: 0605 0000 fa04 0000 e004 0000 cc04 0000  ................
+00006190: 9004 0000 5b04 0000 2c04 0000 f303 0000  ....[...,.......
+000061a0: d303 0000 b403 0000 7b03 0000 3803 0000  ........{...8...
+000061b0: 1803 0000 f602 0000 bf02 0000 a402 0000  ................
+000061c0: 6b02 0000 4002 0000 3202 0000 2802 0000  k...@...2...(...
+000061d0: 2202 0000 f301 0000 0000 0000 0000 0000  "...............
+000061e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000061f0: 0000 0020 2020 2072 6574 7572 6e20 6a73  ...    return js
+00006200: 6f6e 2e64 756d 7073 286f 626a 2c20 636c  on.dumps(obj, cl
+00006210: 733d 7365 6c66 2e4e 7045 6e63 6f64 6572  s=self.NpEncoder
+00006220: 2900 2020 2020 7d00 2020 2020 2020 2020  ).    }.        
+00006230: 7d00 2020 2020 2020 2020 2020 2020 7d00  }.            }.
+00006240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006250: 2761 7574 686f 7227 3a20 2727 2c20 2774  'author': '', 't
+00006260: 7970 6527 3a20 2727 7d5d 0020 2020 2020  ype': ''}].     
+00006270: 2020 2020 2020 2020 2020 2027 7465 7874             'text
+00006280: 273a 2073 656c 662e 6765 745f 6f70 696e  ': self.get_opin
+00006290: 696f 6e5f 7465 7874 286f 7069 6e69 6f6e  ion_text(opinion
+000062a0: 292c 2000 2020 2020 2020 2020 2020 2020  ), .            
+000062b0: 276f 7069 6e69 6f6e 7327 3a20 5b7b 0020  'opinions': [{. 
+000062c0: 2020 2020 2020 2020 2020 2027 6865 6164             'head
+000062d0: 5f6d 6174 7465 7227 3a27 272c 2023 4173  _matter':'', #As
+000062e0: 6b20 434c 2061 626f 7574 2063 6f70 7972  k CL about copyr
+000062f0: 6967 6874 2c00 2020 2020 2020 2020 2020  ight,.          
+00006300: 2020 276a 7564 6765 7327 3a20 6a75 6467    'judges': judg
+00006310: 655f 6c69 7374 2c00 2020 2020 2020 2020  e_list,.        
+00006320: 2763 6173 6562 6f64 7927 203a 207b 2764  'casebody' : {'d
+00006330: 6174 6127 3a20 7b00 2020 2020 2020 2020  ata': {.        
+00006340: 276a 7572 6973 6469 6374 696f 6e27 203a  'jurisdiction' :
+00006350: 207b 276e 616d 6527 3a20 636f 7572 745f   {'name': court_
+00006360: 726f 772e 6a75 7269 7364 6963 7469 6f6e  row.jurisdiction
+00006370: 2e69 6c6f 635b 305d 7d2c 0020 2020 2020  .iloc[0]},.     
+00006380: 2020 2027 636f 7572 7427 203a 207b 276e     'court' : {'n
+00006390: 616d 6527 3a20 636f 7572 745f 726f 772e  ame': court_row.
+000063a0: 6675 6c6c 5f6e 616d 652e 696c 6f63 5b30  full_name.iloc[0
+000063b0: 5d7d 2c00 2020 2020 2020 2020 2763 6974  ]},.        'cit
+000063c0: 6573 5f74 6f27 203a 2063 6974 6573 5f74  es_to' : cites_t
+000063d0: 6f2c 0020 2020 2020 2020 2027 6369 7461  o,.        'cita
+000063e0: 7469 6f6e 7327 203a 2063 6974 6564 5f62  tions' : cited_b
+000063f0: 792c 0020 2020 2020 2020 2027 646f 636b  y,.        'dock
+00006400: 6574 5f6e 756d 6265 7227 203a 2063 6c75  et_number' : clu
+00006410: 7374 6572 5f72 6f77 2e64 6f63 6b65 745f  ster_row.docket_
+00006420: 6964 2e69 6c6f 635b 305d 2c00 2020 2020  id.iloc[0],.    
+00006430: 2020 2020 2764 6563 6973 696f 6e5f 6461      'decision_da
+00006440: 7465 273a 2027 272c 2023 6461 7465 5f74  te': '', #date_t
+00006450: 6572 6d69 6e61 7465 642c 0020 2020 2020  erminated,.     
+00006460: 2020 2027 6e61 6d65 2720 3a20 636c 7573     'name' : clus
+00006470: 7465 725f 726f 772e 6361 7365 5f6e 616d  ter_row.case_nam
+00006480: 655f 6675 6c6c 2e69 6c6f 635b 305d 2c00  e_full.iloc[0],.
+00006490: 2020 2020 2020 2020 276e 616d 655f 6162          'name_ab
+000064a0: 6272 6576 6961 7469 6f6e 273a 2063 6c75  breviation': clu
+000064b0: 7374 6572 5f72 6f77 2e63 6173 655f 6e61  ster_row.case_na
+000064c0: 6d65 2e69 6c6f 635b 305d 2c00 2020 2020  me.iloc[0],.    
+000064d0: 2020 2020 2775 726c 273a 2075 726c 2c00      'url': url,.
+000064e0: 2020 2020 2020 2020 2769 6427 3a20 636c          'id': cl
+000064f0: 7573 7465 725f 6964 2c00 2020 2020 6f62  uster_id,.    ob
+00006500: 6a20 3d20 7b00 0020 2020 2075 726c 203d  j = {..    url =
+00006510: 2027 2720 2320 6f70 696e 696f 6e5b 2764   '' # opinion['d
+00006520: 6f77 6e6c 6f61 645f 7572 6c27 5d00 2020  ownload_url'].  
+00006530: 2020 2323 2064 6f77 6e6c 6f61 6420 7572    ## download ur
+00006540: 6c20 6d61 7920 616c 736f 2062 6520 6d69  l may also be mi
+00006550: 7373 696e 6700 2020 2020 6461 7465 5f74  ssing.    date_t
+00006560: 6572 6d69 6e61 7465 6420 3d20 6c69 7374  erminated = list
+00006570: 2864 6f63 6b65 745f 726f 775b 2764 6174  (docket_row['dat
+00006580: 655f 7465 726d 696e 6174 6564 275d 295b  e_terminated'])[
+00006590: 305d 0020 2020 2023 2320 736f 6d65 7469  0].    ## someti
+000065a0: 6d65 7320 6461 7465 5f74 6572 6d69 6e61  mes date_termina
+000065b0: 7465 6420 6d61 7920 6265 206d 6973 7369  ted may be missi
+000065c0: 6e67 2061 6e64 2072 6563 6f72 6465 6420  ng and recorded 
+000065d0: 6173 204e 614e 0020 2020 2023 2020 2020  as NaN.    #    
+000065e0: 0020 2020 205d 0020 2020 2020 2020 2069  .    ].        i
+000065f0: 6620 6e6f 7420 7265 2e6d 6174 6368 2827  f not re.match('
+00006600: 5b63 6a5d 3f6a 5c2e 272c 206a 7564 6765  [cj]?j\.', judge
+00006610: 2900 2020 2020 2020 2020 2020 2020 286a  ).            (j
+00006620: 7564 6765 732e 696c 6f63 5b30 5d2e 7370  udges.iloc[0].sp
+00006630: 6c69 7428 272c 2729 2069 6620 6a75 6467  lit(',') if judg
+00006640: 6573 2e6e 6f74 6e61 2829 2e62 6f6f 6c28  es.notna().bool(
+00006650: 2920 656c 7365 205b 5d29 0020 2020 2020  ) else []).     
+00006660: 2020 2066 6f72 206a 7564 6765 2069 6e00     for judge in.
+00006670: 2020 2020 2020 2020 6a75 6467 6500 2020          judge.  
+00006680: 2020 6a75 6467 655f 6c69 7374 203d 205b    judge_list = [
+00006690: 0020 2020 206a 7564 6765 7320 3d20 636c  .    judges = cl
+000066a0: 7573 7465 725f 726f 772e 6a75 6467 6573  uster_row.judges
+000066b0: 0020 2020 2023 206a 7564 6765 7300 0020  .    # judges.. 
+000066c0: 2020 2063 6974 6564 5f62 7920 3d20 6369     cited_by = ci
+000066d0: 7461 7469 6f6e 5f69 6e66 6f5b 2763 6974  tation_info['cit
+000066e0: 6564 5f62 7927 5d00 2020 2020 6369 7465  ed_by'].    cite
+000066f0: 735f 746f 203d 2063 6974 6174 696f 6e5f  s_to = citation_
+00006700: 696e 666f 5b27 6369 7465 735f 746f 275d  info['cites_to']
+00006710: 0020 2020 2063 6974 6174 696f 6e5f 696e  .    citation_in
+00006720: 666f 203d 2073 656c 662e 6765 745f 6369  fo = self.get_ci
+00006730: 7461 7469 6f6e 7328 6f70 696e 696f 6e5f  tations(opinion_
+00006740: 6964 2c20 6369 7461 7469 6f6e 7329 0020  id, citations). 
+00006750: 2020 2023 2067 6574 206f 7069 6e69 6f6e     # get opinion
+00006760: 7320 6369 7465 6420 746f 0000 2020 2020  s cited to..    
+00006770: 2020 2020 7265 7475 726e 0020 2020 2069      return.    i
+00006780: 6620 636f 7572 745f 726f 772e 656d 7074  f court_row.empt
+00006790: 793a 0020 2020 2063 6f75 7274 5f72 6f77  y:.    court_row
+000067a0: 3a20 7365 6c66 2e44 6174 6146 7261 6d65  : self.DataFrame
+000067b0: 203d 2063 6f75 7274 735b 636f 7572 7473   = courts[courts
+000067c0: 5b27 6964 275d 203d 3d20 6369 645d 0020  ['id'] == cid]. 
+000067d0: 2020 2063 6964 203d 206c 6973 7428 646f     cid = list(do
+000067e0: 636b 6574 5f72 6f77 5b27 636f 7572 745f  cket_row['court_
+000067f0: 6964 275d 295b 305d 0020 2020 2020 2020  id'])[0].       
+00006800: 2072 6574 7572 6e20 0020 2020 2069 6620   return .    if 
+00006810: 6c65 6e28 646f 636b 6574 5f72 6f77 2e63  len(docket_row.c
+00006820: 6f6c 756d 6e73 2920 3d3d 2030 3a00 2020  olumns) == 0:.  
+00006830: 2020 2320 7265 7475 726e 2065 6172 6c79    # return early
+00006840: 2069 6620 7468 6572 6527 7320 0000 2020   if there's ..  
+00006850: 2020 646f 636b 6574 5f72 6f77 203d 2064    docket_row = d
+00006860: 6f63 6b65 7473 5b64 6f63 6b65 7473 5b27  ockets[dockets['
+00006870: 6964 275d 203d 3d20 646f 636b 6574 5f69  id'] == docket_i
+00006880: 645d 2e63 6f6d 7075 7465 2829 0020 2020  d].compute().   
+00006890: 2064 6f63 6b65 745f 6964 203d 2069 6e74   docket_id = int
+000068a0: 2863 6c75 7374 6572 5f72 6f77 5b27 646f  (cluster_row['do
+000068b0: 636b 6574 5f69 6427 5d29 0020 2020 2023  cket_id']).    #
+000068c0: 2067 6574 2063 6f72 7265 7370 6f6e 6469   get correspondi
+000068d0: 6e67 2072 6f77 2066 726f 6d20 646f 636b  ng row from dock
+000068e0: 6574 2064 6620 6261 7365 6420 6f6e 2063  et df based on c
+000068f0: 6c75 7374 6572 206f 7069 6e69 6f6e 2069  luster opinion i
+00006900: 6400 0020 2020 2063 6c75 7374 6572 5f72  d..    cluster_r
+00006910: 6f77 3a20 7365 6c66 2e44 6174 6146 7261  ow: self.DataFra
+00006920: 6d65 203d 2073 656c 662e 6466 5f72 6f77  me = self.df_row
+00006930: 5f62 795f 7661 6c75 6528 7365 6c66 2e67  _by_value(self.g
+00006940: 6574 5f6f 7069 6e69 6f6e 735f 636c 7573  et_opinions_clus
+00006950: 7465 725f 6466 2829 2c20 2769 6427 2c20  ter_df(), 'id', 
+00006960: 636c 7573 7465 725f 6964 2900 2020 2020  cluster_id).    
+00006970: 2320 6765 7420 6561 6368 2063 6f72 7265  # get each corre
+00006980: 7370 6f6e 6469 6e67 2072 6f77 2066 726f  sponding row fro
+00006990: 6d20 636c 7573 7465 7273 2c20 646f 636b  m clusters, dock
+000069a0: 6574 732c 2063 6f75 7274 7320 6261 7365  ets, courts base
+000069b0: 6420 6f6e 206f 7069 6e69 6f6e 2069 6400  d on opinion id.
+000069c0: 0020 2020 2063 6c75 7374 6572 5f69 6420  .    cluster_id 
+000069d0: 3d20 6f70 696e 696f 6e5b 2763 6c75 7374  = opinion['clust
+000069e0: 6572 5f69 6427 5d00 2020 2020 6f70 696e  er_id'].    opin
+000069f0: 696f 6e5f 6964 203d 206f 7069 6e69 6f6e  ion_id = opinion
+00006a00: 5b27 6964 275d 0020 2020 2063 6974 6174  ['id'].    citat
+00006a10: 696f 6e73 203d 2073 656c 662e 6765 745f  ions = self.get_
+00006a20: 6369 7461 7469 6f6e 5f64 6628 2900 2020  citation_df().  
+00006a30: 2020 636f 7572 7473 203d 2073 656c 662e    courts = self.
+00006a40: 6765 745f 636f 7572 7473 5f64 6628 2900  get_courts_df().
+00006a50: 2020 2020 646f 636b 6574 7320 3d20 7365      dockets = se
+00006a60: 6c66 2e67 6574 5f64 6f63 6b65 7473 5f64  lf.get_dockets_d
+00006a70: 6628 2900 2020 2020 6c6f 672e 6465 6275  f().    log.debu
+00006a80: 6728 2770 726f 6365 7373 5f72 6f77 2729  g('process_row')
+00006a90: 0020 2064 6566 2070 726f 6365 7373 5f72  .  def process_r
+00006aa0: 6f77 2873 656c 662c 206f 7069 6e69 6f6e  ow(self, opinion
+00006ab0: 2920 2d3e 2064 6963 743a 0020 2023 2070  ) -> dict:.  # p
+00006ac0: 726f 6365 7373 0020 2000 2020 2020 2020  rocess.  .      
+00006ad0: 2020 7265 7475 726e 2073 7570 6572 284e    return super(N
+00006ae0: 7045 6e63 6f64 6572 2c20 7365 6c66 292e  pEncoder, self).
+00006af0: 6465 6661 756c 7428 6f62 6a29 0020 2020  default(obj).   
+00006b00: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00006b10: 2727 0020 2020 2020 2020 2069 6620 6973  ''.        if is
+00006b20: 696e 7374 616e 6365 286f 626a 2c20 2020  instance(obj,   
+00006b30: 2020 2020 2020 2020 0020 2020 2072 6574          .    ret
+00006b40: 7572 6e20 646f 636b 6574 735f 6469 6374  urn dockets_dict
+00006b50: 0000 2020 2020 6c6f 672e 6465 6275 6720  ..    log.debug 
+00006b60: 2000 2020 2020 7265 7475 726e 2064 2020   .    return d  
+00006b70: 0020 2020 2072 6574 7572 6e20 646f 636b  .    return dock
+00006b80: 6574 735f 6469 6374 0000 2020 2020 6c6f  ets_dict..    lo
+00006b90: 672e 6465 6275 6728 6627 7b66 6e7d 2072  g.debug(f'{fn} r
+00006ba0: 6561 6420 696e 207b 7374 7228 696e 7428  ead in {str(int(
+00006bb0: 2865 6e64 2d73 7461 7274 292f 3630 2929  (end-start)/60))
+00006bc0: 7d20 6d69 6e75 7465 7327 2900 2020 2020  } minutes').    
+00006bd0: 656e 6420 3d20 7469 6d65 2e70 6572 665f  end = time.perf_
+00006be0: 636f 756e 7465 7228 2900 0020 2020 2020  counter()..     
+00006bf0: 2020 2020 2020 2064 6f63 6b65 7473 5f64         dockets_d
+00006c00: 6963 745b 696e 7428 726f 775b 2769 6427  ict[int(row['id'
+00006c10: 5d29 5d20 3d20 726f 775b 2763 6f75 7274  ])] = row['court
+00006c20: 5f69 6427 5d2c 2072 6f77 5b27 6461 7465  _id'], row['date
+00006c30: 5f74 6572 6d69 6e61 7465 6427 5d00 2020  _terminated'].  
+00006c40: 2020 2020 2020 666f 7220 726f 7720 696e        for row in
+00006c50: 2072 6561 6465 723a 0020 2020 2020 2020   reader:.       
+00006c60: 2072 6561 6465 7220 3d20 6373 762e 4469   reader = csv.Di
+00006c70: 6374 5265 6164 6572 2864 6f63 6b65 7473  ctReader(dockets
+00006c80: 2900 2020 2020 7769 7468 206f 7065 6e28  ).    with open(
+00006c90: 666e 2920 6173 2064 6f63 6b65 7473 3a00  fn) as dockets:.
+00006ca0: 2020 2020 646f 636b 6574 735f 6469 6374      dockets_dict
+00006cb0: 203d 207b 7d00 2020 2020 7374 6172 7420   = {}.    start 
+00006cc0: 3d20 7469 6d65 2e70 6572 665f 636f 756e  = time.perf_coun
+00006cd0: 7465 7228 2900 0020 2020 206c 6f67 2e64  ter()..    log.d
+00006ce0: 6562 7567 286d 7367 2900 2020 2020 6d73  ebug(msg).    ms
+00006cf0: 6720 3d20 6622 4669 6c65 2053 697a 6520  g = f"File Size 
+00006d00: 6973 203a 207b 7374 7228 6669 6c65 5f73  is : {str(file_s
+00006d10: 697a 655f 6762 297d 2047 4222 0020 2020  ize_gb)} GB".   
+00006d20: 206c 6f67 2e64 6562 7567 2866 2749 6d70   log.debug(f'Imp
+00006d30: 6f72 7469 6e67 207b 666e 7d20 6173 2061  orting {fn} as a
+00006d40: 2044 6963 7427 2900 2020 2020 6669 6c65   Dict').    file
+00006d50: 5f73 697a 655f 6762 203d 2072 6f75 6e64  _size_gb = round
+00006d60: 2866 696c 655f 7369 7a65 2f31 302a 2a39  (file_size/10**9
+00006d70: 2c20 3229 0020 2020 2066 696c 655f 7369  , 2).    file_si
+00006d80: 7a65 203d 206f 732e 7061 7468 2e67 6574  ze = os.path.get
+00006d90: 7369 7a65 2866 6e29 0020 2020 2066 6e20  size(fn).    fn 
+00006da0: 3d20 666e 206f 7220 7365 6c66 2e5f 646f  = fn or self._do
+00006db0: 636b 6574 735f 666e 0020 2064 6566 2069  ckets_fn.  def i
+00006dc0: 6e69 745f 646f 636b 6574 735f 6469 6374  nit_dockets_dict
+00006dd0: 2873 656c 662c 2066 6e3d 4e6f 6e65 293a  (self, fn=None):
+00006de0: 0020 2023 2069 6e69 7469 616c 697a 6520  .  # initialize 
+00006df0: 646f 636b 6574 7320 6469 6374 0000 0020  dockets dict... 
+00006e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006e10: 2020 2020 2020 2020 626c 6f63 6b73 697a          blocksiz
+00006e20: 653d 2233 324d 4222 2900 2020 2020 2020  e="32MB").      
+00006e30: 7265 7475 726e 2064 642e 7265 6164 5f63  return dd.read_c
+00006e40: 7376 2866 6e20 6f72 2073 656c 662e 5f64  sv(fn or self._d
+00006e50: 6f63 6b65 7473 5f66 6e2c 2064 7479 7065  ockets_fn, dtype
+00006e60: 3d6d 795f 7479 7065 732c 2075 7365 636f  =my_types, useco
+00006e70: 6c73 3d5b 2763 6f75 7274 5f69 6427 2c20  ls=['court_id', 
+00006e80: 2769 6427 2c20 2764 6174 655f 7465 726d  'id', 'date_term
+00006e90: 696e 6174 6564 275d 2c00 0020 2020 2020  inated'],..     
+00006ea0: 206c 6f67 2e64 6562 7567 286d 7367 2900   log.debug(msg).
+00006eb0: 2020 2020 2020 6d73 6720 3d20 6622 4669        msg = f"Fi
+00006ec0: 6c65 2053 697a 6520 6973 203a 207b 7374  le Size is : {st
+00006ed0: 7228 6669 6c65 5f73 697a 655f 6762 297d  r(file_size_gb)}
+00006ee0: 2047 4222 0020 2020 2020 206c 6f67 2e64   GB".      log.d
+00006ef0: 6562 7567 2866 2749 6d70 6f72 7469 6e67  ebug(f'Importing
+00006f00: 207b 666e 7d20 6173 2061 2044 6173 6b20   {fn} as a Dask 
+00006f10: 4461 7461 6672 616d 6527 2900 2020 2020  Dataframe').    
+00006f20: 2020 6669 6c65 5f73 697a 655f 6762 203d    file_size_gb =
+00006f30: 2072 6f75 6e64 2866 696c 655f 7369 7a65   round(file_size
+00006f40: 2f31 302a 2a39 2c20 3229 0020 2020 2020  /10**9, 2).     
+00006f50: 2066 696c 655f 7369 7a65 203d 206f 732e   file_size = os.
+00006f60: 7061 7468 2e67 6574 7369 7a65 2873 656c  path.getsize(sel
+00006f70: 662e 5f6f 7069 6e69 6f6e 735f 666e 2900  f._opinions_fn).
+00006f80: 2020 2020 2020 6c6f 672e 6465 6275 6728        log.debug(
+00006f90: 2769 6d70 6f72 7469 6e67 2064 6f63 6b65  'importing docke
+00006fa0: 7473 2729 0000 2020 2020 2020 7d20 0020  ts')..      } . 
+00006fb0: 2020 2020 2027 6461 7465 5f74 6572 6d69       'date_termi
+00006fc0: 6e61 7465 6427 3a20 2773 7472 696e 6727  nated': 'string'
+00006fd0: 0020 2020 2020 2027 636f 7572 745f 6964  .      'court_id
+00006fe0: 273a 2027 7374 7269 6e67 272c 0020 2020  ': 'string',.   
+00006ff0: 2020 206d 795f 7479 7065 7320 3d20 7b00     my_types = {.
+00007000: 6164 0000 6802 0000 0804 0000 0010 0000  ad..h...........
+00007010: 6100 0000 0000 0000 e10f 0000 ba0f 0000  a...............
+00007020: 850f 0000 840f 0000 770f 0000 5c0f 0000  ........w...\...
+00007030: 3f0f 0000 3e0f 0000 210f 0000 020f 0000  ?...>...!.......
+00007040: ff0e 0000 e30e 0000 c50e 0000 c40e 0000  ................
+00007050: 9f0e 0000 780e 0000 770e 0000 5a0e 0000  ....x...w...Z...
+00007060: 4f0e 0000 4e0e 0000 290e 0000 0d0e 0000  O...N...).......
+00007070: e50d 0000 c90d 0000 a00d 0000 820d 0000  ................
+00007080: 5a0d 0000 3a0d 0000 160d 0000 000d 0000  Z...:...........
+00007090: cd0c 0000 ca0c 0000 be0c 0000 940c 0000  ................
+000070a0: 770c 0000 530c 0000 310c 0000 0a0c 0000  w...S...1.......
+000070b0: eb0b 0000 c40b 0000 c30b 0000 6f0b 0000  ............o...
+000070c0: 060b 0000 050b 0000 be0a 0000 900a 0000  ................
+000070d0: 500a 0000 2c0a 0000 280a 0000 090a 0000  P...,...(.......
+000070e0: f209 0000 e309 0000 cb09 0000 8f09 0000  ................
+000070f0: 7709 0000 6809 0000 6709 0000 4b09 0000  w...h...g...K...
+00007100: 0d09 0000 e408 0000 bb08 0000 ba08 0000  ................
+00007110: ad08 0000 8d08 0000 7a08 0000 6c08 0000  ........z...l...
+00007120: 5708 0000 0e08 0000 e307 0000 dd07 0000  W...............
+00007130: d307 0000 8f07 0000 6b07 0000 4307 0000  ........k...C...
+00007140: 1c07 0000 1b07 0000 0f07 0000 f506 0000  ................
+00007150: e106 0000 a506 0000 7006 0000 4106 0000  ........p...A...
+00007160: 0806 0000 e805 0000 c905 0000 9005 0000  ................
+00007170: 4d05 0000 2d05 0000 0b05 0000 d404 0000  M...-...........
+00007180: b904 0000 8004 0000 5504 0000 4704 0000  ........U...G...
+00007190: 3d04 0000 3704 0000 0804 0000 e803 0000  =...7...........
+000071a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000071b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000071c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000071d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000071e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000071f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000072a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000072b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000072c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000072d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000072e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000072f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000073a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000073b0: 0000 0000 0000 0000 0000 0000 0020 2020  .............   
+000073c0: 2072 2020 2020 7265 7475 726e 206a 7320   r    return js 
+000073d0: 2020 2072 2020 2020 7265 7475 726e 206a     r    return j
+000073e0: 736f 6e2e 6475 6d70 2020 2020 7265 7420  son.dump    ret 
+000073f0: 2020 2072 6574 7572 6e20 6a73 6f6e 2e64     return json.d
+00007400: 756d 7073 286f 626a 2020 2020 7265 7475  umps(obj    retu
+00007410: 726e 206a 736f 6e2e 6475 6d70 7328 6f62  rn json.dumps(ob
+00007420: 6a2c 2063 6c73 3d73 656c 662e 4e70 456e  j, cls=self.NpEn
+00007430: 636f 6465 7229 0020 2020 207d 0020 2020  coder).    }.   
+00007440: 2020 2020 207d 0020 2020 2020 2020 2020       }.         
+00007450: 2020 207d 0020 2020 2020 2020 2020 2020     }.           
+00007460: 2020 2020 2027 6175 7468 6f72 273a 2027       'author': '
+00007470: 272c 2027 7479 7065 273a 2027 277d 5d00  ', 'type': ''}].
+00007480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007490: 2774 6578 7427 3a20 7365 6c66 2e67 6574  'text': self.get
+000074a0: 5f6f 7069 6e69 6f6e 5f74 6578 7428 6f70  _opinion_text(op
+000074b0: 696e 696f 6e29 2c20 0020 2020 2020 2020  inion), .       
+000074c0: 2020 2020 2027 6f70 696e 696f 6e73 273a       'opinions':
+000074d0: 205b 7b00 2020 2020 2020 2020 2020 2020   [{.            
+000074e0: 2768 6561 645f 6d61 7474 6572 273a 2727  'head_matter':''
+000074f0: 2c20 2341 736b 2043 4c20 6162 6f75 7420  , #Ask CL about 
+00007500: 636f 7079 7269 6768 742c 0020 2020 2020  copyright,.     
+00007510: 2020 2020 2020 2027 6a75 6467 6573 273a         'judges':
+00007520: 206a 7564 6765 5f6c 6973 742c 0020 2020   judge_list,.   
+00007530: 2020 2020 2027 6361 7365 626f 6479 2720       'casebody' 
+00007540: 3a20 7b27 6461 7461 273a 207b 0020 2020  : {'data': {.   
+00007550: 2020 2020 2027 6a75 7269 7364 6963 7469       'jurisdicti
+00007560: 6f6e 2720 3a20 7b27 6e61 6d65 273a 2063  on' : {'name': c
+00007570: 6f75 7274 5f72 6f77 2e6a 7572 6973 6469  ourt_row.jurisdi
+00007580: 6374 696f 6e2e 696c 6f63 5b30 5d7d 2c00  ction.iloc[0]},.
+00007590: 2020 2020 2020 2020 2763 6f75 7274 2720          'court' 
+000075a0: 3a20 7b27 6e61 6d65 273a 2063 6f75 7274  : {'name': court
+000075b0: 5f72 6f77 2e66 756c 6c5f 6e61 6d65 2e69  _row.full_name.i
+000075c0: 6c6f 635b 305d 7d2c 0020 2020 2020 2020  loc[0]},.       
+000075d0: 2027 6369 7465 735f 746f 2720 3a20 6369   'cites_to' : ci
+000075e0: 7465 735f 746f 2c00 2020 2020 2020 2020  tes_to,.        
+000075f0: 2763 6974 6174 696f 6e73 2720 3a20 6369  'citations' : ci
+00007600: 7465 645f 6279 2c00 2020 2020 2020 2020  ted_by,.        
+00007610: 2764 6f63 6b65 745f 6e75 6d62 6572 2720  'docket_number' 
+00007620: 3a20 636c 7573 7465 725f 726f 772e 646f  : cluster_row.do
+00007630: 636b 6574 5f69 642e 696c 6f63 5b30 5d2c  cket_id.iloc[0],
+00007640: 0020 2020 2020 2020 2027 6465 6369 7369  .        'decisi
+00007650: 6f6e 5f64 6174 6527 3a20 2727 2c20 2364  on_date': '', #d
+00007660: 6174 655f 7465 726d 696e 6174 6564 2c00  ate_terminated,.
+00007670: 2020 2020 2020 2020 276e 616d 6527 203a          'name' :
+00007680: 2063 6c75 7374 6572 5f72 6f77 2e63 6173   cluster_row.cas
+00007690: 655f 6e61 6d65 5f66 756c 6c2e 696c 6f63  e_name_full.iloc
+000076a0: 5b30 5d2c 0020 2020 2020 2020 2027 6e61  [0],.        'na
+000076b0: 6d65 5f61 6262 7265 7669 6174 696f 6e27  me_abbreviation'
+000076c0: 3a20 636c 7573 7465 725f 726f 772e 6361  : cluster_row.ca
+000076d0: 7365 5f6e 616d 652e 696c 6f63 5b30 5d2c  se_name.iloc[0],
+000076e0: 0020 2020 2020 2020 2027 7572 6c27 3a20  .        'url': 
+000076f0: 7572 6c2c 0020 2020 2020 2020 2027 6964  url,.        'id
+00007700: 273a 2063 6c75 7374 6572 5f69 642c 0020  ': cluster_id,. 
+00007710: 2020 206f 626a 203d 207b 0000 2020 2020     obj = {..    
+00007720: 7572 6c20 3d20 2727 2023 206f 7069 6e69  url = '' # opini
+00007730: 6f6e 5b27 646f 776e 6c6f 6164 5f75 726c  on['download_url
+00007740: 275d 0020 2020 2023 2320 646f 776e 6c6f  '].    ## downlo
+00007750: 6164 2075 726c 206d 6179 2061 6c73 6f20  ad url may also 
+00007760: 6265 206d 6973 7369 6e67 0020 2020 2064  be missing.    d
+00007770: 6174 655f 7465 726d 696e 6174 6564 203d  ate_terminated =
+00007780: 2064 6f63 6b65 745f 726f 775b 315d 0020   docket_row[1]. 
+00007790: 2020 2023 2320 736f 6d65 7469 6d65 7320     ## sometimes 
+000077a0: 6461 7465 5f74 6572 6d69 6e61 7465 6420  date_terminated 
+000077b0: 6d61 7920 6265 206d 6973 7369 6e67 2061  may be missing a
+000077c0: 6e64 2072 6563 6f72 6465 6420 6173 204e  nd recorded as N
+000077d0: 614e 0020 2020 2023 2020 2020 0020 2020  aN.    #    .   
+000077e0: 205d 0020 2020 2020 2020 2069 6620 6e6f   ].        if no
+000077f0: 7420 7265 2e6d 6174 6368 2827 5b63 6a5d  t re.match('[cj]
+00007800: 3f6a 5c2e 272c 206a 7564 6765 2900 2020  ?j\.', judge).  
+00007810: 2020 2020 2020 2020 2020 286a 7564 6765            (judge
+00007820: 732e 696c 6f63 5b30 5d2e 7370 6c69 7428  s.iloc[0].split(
+00007830: 272c 2729 2069 6620 6a75 6467 6573 2e6e  ',') if judges.n
+00007840: 6f74 6e61 2829 2e62 6f6f 6c28 2920 656c  otna().bool() el
+00007850: 7365 205b 5d29 0020 2020 2020 2020 2066  se []).        f
+00007860: 6f72 206a 7564 6765 2069 6e00 2020 2020  or judge in.    
+00007870: 2020 2020 6a75 6467 6500 2020 2020 6a75      judge.    ju
+00007880: 6467 655f 6c69 7374 203d 205b 0020 2020  dge_list = [.   
+00007890: 206a 7564 6765 7320 3d20 636c 7573 7465   judges = cluste
+000078a0: 725f 726f 772e 6a75 6467 6573 0020 2020  r_row.judges.   
+000078b0: 2023 206a 7564 6765 7300 0020 2020 2063   # judges..    c
+000078c0: 6974 6564 5f62 7920 3d20 6369 7461 7469  ited_by = citati
+000078d0: 6f6e 5f69 6e66 6f5b 2763 6974 6564 5f62  on_info['cited_b
+000078e0: 7927 5d00 2020 2020 6369 7465 735f 746f  y'].    cites_to
+000078f0: 203d 2063 6974 6174 696f 6e5f 696e 666f   = citation_info
+00007900: 5b27 6369 7465 735f 746f 275d 0020 2020  ['cites_to'].   
+00007910: 2063 6974 6174 696f 6e5f 696e 666f 203d   citation_info =
+00007920: 2073 656c 662e 6765 745f 6369 7461 7469   self.get_citati
+00007930: 6f6e 7328 6f70 696e 696f 6e5f 6964 2c20  ons(opinion_id, 
+00007940: 6369 7461 7469 6f6e 7329 0020 2020 2023  citations).    #
+00007950: 2067 6574 206f 7069 6e69 6f6e 7320 6369   get opinions ci
+00007960: 7465 6420 746f 0000 2020 2020 2020 2020  ted to..        
+00007970: 7265 7475 726e 0020 2020 2069 6620 636f  return.    if co
+00007980: 7572 745f 726f 772e 656d 7074 793a 0020  urt_row.empty:. 
+00007990: 2020 2063 6f75 7274 5f72 6f77 3a20 7365     court_row: se
+000079a0: 6c66 2e44 6174 6146 7261 6d65 203d 2063  lf.DataFrame = c
+000079b0: 6f75 7274 735b 636f 7572 7473 5b27 6964  ourts[courts['id
+000079c0: 275d 203d 3d20 6369 645d 0020 2020 2063  '] == cid].    c
+000079d0: 6964 203d 2064 6f63 6b65 745f 726f 775b  id = docket_row[
+000079e0: 305d 0020 2020 2020 2020 2072 6574 7572  0].        retur
+000079f0: 6e00 2020 2020 6966 206e 6f74 2064 6f63  n.    if not doc
+00007a00: 6b65 745f 726f 773a 0020 2020 2023 2072  ket_row:.    # r
+00007a10: 6574 7572 6e20 6561 726c 7920 6966 2074  eturn early if t
+00007a20: 6865 7265 2773 2000 2020 2000 2020 2020  here's .   .    
+00007a30: 646f 636b 6574 5f72 6f77 203d 2064 6f63  docket_row = doc
+00007a40: 6b65 7473 5b64 6f63 6b65 745f 6964 5d00  kets[docket_id].
+00007a50: 2020 2020 2364 6f63 6b65 745f 726f 7720      #docket_row 
+00007a60: 3d20 646f 636b 6574 735b 646f 636b 6574  = dockets[docket
+00007a70: 735b 2769 6427 5d20 3d3d 2064 6f63 6b65  s['id'] == docke
+00007a80: 745f 6964 5d2e 636f 6d70 7574 6528 2900  t_id].compute().
+00007a90: 2020 2020 646f 636b 6574 5f69 6420 3d20      docket_id = 
+00007aa0: 696e 7428 636c 7573 7465 725f 726f 775b  int(cluster_row[
+00007ab0: 2764 6f63 6b65 745f 6964 275d 2900 2020  'docket_id']).  
+00007ac0: 2020 2320 6765 7420 636f 7272 6573 706f    # get correspo
+00007ad0: 6e64 696e 6720 726f 7720 6672 6f6d 2064  nding row from d
+00007ae0: 6f63 6b65 7420 6466 2062 6173 6564 206f  ocket df based o
+00007af0: 6e20 636c 7573 7465 7220 6f70 696e 696f  n cluster opinio
+00007b00: 6e20 6964 0000 2020 2020 636c 7573 7465  n id..    cluste
+00007b10: 725f 726f 773a 2073 656c 662e 4461 7461  r_row: self.Data
+00007b20: 4672 616d 6520 3d20 7365 6c66 2e64 665f  Frame = self.df_
+00007b30: 726f 775f 6279 5f76 616c 7565 2873 656c  row_by_value(sel
+00007b40: 662e 6765 745f 6f70 696e 696f 6e73 5f63  f.get_opinions_c
+00007b50: 6c75 7374 6572 5f64 6628 292c 2027 6964  luster_df(), 'id
+00007b60: 272c 2063 6c75 7374 6572 5f69 6429 0020  ', cluster_id). 
+00007b70: 2020 2023 2067 6574 2065 6163 6820 636f     # get each co
+00007b80: 7272 6573 706f 6e64 696e 6720 726f 7720  rresponding row 
+00007b90: 6672 6f6d 2063 6c75 7374 6572 732c 2064  from clusters, d
+00007ba0: 6f63 6b65 7473 2c20 636f 7572 7473 2062  ockets, courts b
+00007bb0: 6173 6564 206f 6e20 6f70 696e 696f 6e20  ased on opinion 
+00007bc0: 6964 0000 2020 2020 636c 7573 7465 725f  id..    cluster_
+00007bd0: 6964 203d 206f 7069 6e69 6f6e 5b27 636c  id = opinion['cl
+00007be0: 7573 7465 725f 6964 275d 0020 2020 206f  uster_id'].    o
+00007bf0: 7069 6e69 6f6e 5f69 6420 3d20 6f70 696e  pinion_id = opin
+00007c00: 696f 6e5b 2769 6427 5d00 2020 2020 6369  ion['id'].    ci
+00007c10: 7461 7469 6f6e 7320 3d20 7365 6c66 2e67  tations = self.g
+00007c20: 6574 5f63 6974 6174 696f 6e5f 6466 2829  et_citation_df()
+00007c30: 0020 2020 2063 6f75 7274 7320 3d20 7365  .    courts = se
+00007c40: 6c66 2e67 6574 5f63 6f75 7274 735f 6466  lf.get_courts_df
+00007c50: 2829 0020 2020 2064 6f63 6b65 7473 203d  ().    dockets =
+00007c60: 2073 656c 662e 6765 745f 646f 636b 6574   self.get_docket
+00007c70: 735f 6466 2829 0020 2020 206c 6f67 2e64  s_df().    log.d
+00007c80: 6562 7567 2827 7072 6f63 6573 735f 726f  ebug('process_ro
+00007c90: 7727 2900 2020 6465 6620 7072 6f63 6573  w').  def proces
+00007ca0: 735f 726f 7728 7365 6c66 2c20 6f70 696e  s_row(self, opin
+00007cb0: 696f 6e29 202d 3e20 6469 6374 3a00 2020  ion) -> dict:.  
+00007cc0: 2320 7072 6f63 6573 7300 2020 0020 2020  # process.  .   
+00007cd0: 2020 2020 2072 6574 7572 6e20 7375 7065       return supe
+00007ce0: 7228 4e70 456e 636f 6465 722c 2073 656c  r(NpEncoder, sel
+00007cf0: 6629 2e64 6566 6175 6c74 286f 626a 2900  f).default(obj).
+00007d00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00007d10: 726e 2027 2700 2020 2020 2020 2020 6966  rn ''.        if
+00007d20: 2069 7369 6e73 7461 6e63 6528 6f62 6a2c   isinstance(obj,
+00007d30: 204e 4154 7970 6529 3a00 2020 2020 2020   NAType):.      
+00007d40: 2020 2020 2020 7265 7475 726e 206f 626a        return obj
+00007d50: 2e74 6f6c 6973 7428 2900 2020 2020 2020  .tolist().      
+00007d60: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00007d70: 6f62 6a2c 206e 702e 6e64 6172 7261 7929  obj, np.ndarray)
+00007d80: 3a00 2020 2020 2020 2020 2020 2020 7265  :.            re
+00007d90: 7475 726e 2066 6c6f 6174 286f 626a 2900  turn float(obj).
+00007da0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00007db0: 7461 6e63 6528 6f62 6a2c 206e 702e 666c  tance(obj, np.fl
+00007dc0: 6f61 7469 6e67 293a 0020 2020 2020 2020  oating):.       
+00007dd0: 2020 2020 2072 6574 7572 6e20 696e 7428       return int(
+00007de0: 6f62 6a29 0020 2020 2020 2020 2069 6620  obj).        if 
+00007df0: 6973 696e 7374 616e 6365 286f 626a 2c20  isinstance(obj, 
+00007e00: 6e70 2e69 6e74 6567 6572 293a 0020 2020  np.integer):.   
+00007e10: 2064 6566 2064 6566 6175 6c74 2873 656c   def default(sel
+00007e20: 662c 206f 626a 293a 0020 2063 6c61 7373  f, obj):.  class
+00007e30: 204e 7045 6e63 6f64 6572 286a 736f 6e2e   NpEncoder(json.
+00007e40: 4a53 4f4e 456e 636f 6465 7229 3a00 0020  JSONEncoder):.. 
+00007e50: 2020 2020 2070 6173 7300 2020 6465 6620       pass.  def 
+00007e60: 6765 745f 6f70 696e 696f 6e73 5f64 6628  get_opinions_df(
+00007e70: 7365 6c66 293a 0000 2020 2020 2020 7265  self):..      re
+00007e80: 7475 726e 2073 656c 662e 5f64 665f 6f70  turn self._df_op
+00007e90: 696e 696f 6e5f 636c 7573 7465 7273 0020  inion_clusters. 
+00007ea0: 2064 6566 2067 6574 5f6f 7069 6e69 6f6e   def get_opinion
+00007eb0: 735f 636c 7573 7465 725f 6466 2873 656c  s_cluster_df(sel
+00007ec0: 6629 3a00 0020 2020 2020 2072 6574 7572  f):..      retur
+00007ed0: 6e20 7365 6c66 2e5f 6466 5f64 6f63 6b65  n self._df_docke
+00007ee0: 7473 0020 2064 6566 2067 6574 5f64 6f63  ts.  def get_doc
+00007ef0: 6b65 7473 5f64 6628 7365 6c66 293a 0020  kets_df(self):. 
+00007f00: 2000 2020 2020 2020 7265 7475 726e 2073   .      return s
+00007f10: 656c 662e 5f64 665f 6369 7461 7469 6f6e  elf._df_citation
+00007f20: 0020 2064 6566 2067 6574 5f63 6974 6174  .  def get_citat
+00007f30: 696f 6e5f 6466 2873 656c 6629 3a00 0020  ion_df(self):.. 
+00007f40: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00007f50: 2e5f 6466 5f63 6f75 7274 7300 2020 6465  ._df_courts.  de
+00007f60: 6620 6765 745f 636f 7572 7473 5f64 6628  f get_courts_df(
+00007f70: 7365 6c66 293a 0020 2023 2320 4765 7474  self):.  ## Gett
+00007f80: 6572 7300 0020 2020 2020 2072 6574 7572  ers..      retur
+00007f90: 6e20 7365 6c66 2e63 7376 5f74 6f5f 6466  n self.csv_to_df
+00007fa0: 2866 6e20 6f72 2073 656c 662e 5f63 6974  (fn or self._cit
+00007fb0: 6174 696f 6e5f 666e 2900 2020 6465 6620  ation_fn).  def 
+00007fc0: 696e 6974 5f63 6974 6174 696f 6e5f 6466  init_citation_df
+00007fd0: 2873 656c 662c 2066 6e3d 4e6f 6e65 293a  (self, fn=None):
+00007fe0: 0020 2023 2069 6e69 7469 616c 697a 6520  .  # initialize 
+00007ff0: 6369 7461 7469 6f6e 206d 6170 2064 6600  citation map df.
```

### Comparing `lil_nocap-0.5.0/lil_nocap/__init__.py` & `lil_nocap-0.5.2/lil_nocap/__init__.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,32 +1,41 @@
 #!/usr/bin/env 
 import pandas as pd
+from pandas._libs.missing import NAType
 import numpy as np
 import dask
+import dask.bag as db
 from dask.distributed import Client, progress
 import dask.dataframe as dd
+from dask.distributed import as_completed
 import multiprocessing as mp
 import time
 import timeit
 import os
 import click
 import re
+import logging
+log = logging.getLogger()
+log.setLevel(logging.DEBUG)
+import json
+import csv
 
 class NoCap:
   def __init__(self, opinions_fn, opinion_clusters_fn, courts_fn, dockets_fn, citation_fn):
+    log.debug('Initializing')
     self._opinions_fn = opinions_fn
     self._opinion_clusters_fn = opinion_clusters_fn
     self._courts_fn = courts_fn
     self._dockets_fn = dockets_fn
     self._citation_fn = citation_fn
 
     self._df_courts = self.init_courts_df()
     self._df_opinion_clusters = self.init_opinion_clusters_df()
     self._df_citation = self.init_citation_df()
-    self._df_dockets = self.init_dockets_df()
+    self._df_dockets = self.init_dockets_dict() # self.init_dockets_df()
 
     #self._df_opinions = self.init_opinions_df()
     self.DataFrame = pd.core.frame.DataFrame
 
   @click.command()  
   @click.option('-o', help="local path to opinions file", required=True)
   @click.option('-oc', help="local path to opinion clusters file", required=True)
@@ -55,42 +64,43 @@
     return dfs_opinions
 
   # get a potentially large csv and turn it into a DataFrame
   def csv_to_df(self, filename, dtype = None, parse_dates = None, max_gb=5, num_dfs=10**3, usecols=None, index_col=None):
     start = time.perf_counter()
     file_size = os.path.getsize(filename)
     file_size_gb = round(file_size/10**9, 2)
-    print(f'Importing {filename} as a dataframe')
-    print("File Size is :", file_size_gb, "GB")
+    log.debug(f'Importing {filename} as a dataframe')
+    msg = f"File Size is : {str(file_size_gb)} GB"
+    log.debug(msg)
     df = None
     if file_size_gb > max_gb:
         df = pd.concat(self.read_csv_as_dfs(filename, num_dfs=10**5, max_rows=10**7, 
                                        dtype=dtype, parse_dates=parse_dates, usecols=usecols, index_col=index_col))
     else:
         df = pd.read_csv(filename, dtype=dtype, parse_dates=parse_dates, usecols=usecols, index_col=index_col)
     end = time.perf_counter()
-    print(f'{filename} read in {int((end-start)/60)} minutes')
+    log.debug(f'{filename} read in {str(int((end-start)/60))} minutes')
     return df
 
   # get cluster client
   def get_cluster_client(self):
     return self._client
 
   def df_row_by_value(self, df, column, match):
     return df.loc[df[column] == match]
   
   # accepts a series -- a row from a dataframe
   def get_opinion_text(self, opinion):
     text = ''
-    pt = opinion.plain_text
-    hl = opinion.html
-    hlb = opinion.html_lawbox
-    hlc = opinion.html_columbia
-    xh = opinion.xml_harvard
-    hla = opinion.html_anon_2020
+    pt = opinion['plain_text']
+    hl = opinion['html']
+    hlb = opinion['html_lawbox']
+    hlc = opinion['html_columbia']
+    xh = opinion['xml_harvard']
+    hla = opinion['html_anon_2020']
     
     if isinstance(pt, str):
         text = pt
     elif isinstance(hl, str):
         text = hl
     elif isinstance(hlb, str):
         text = hlb
@@ -148,17 +158,46 @@
   # initialize dockets df
   def init_dockets_df(self, fn=None):
       my_types = {
       'court_id': 'string',
       'date_terminated': 'string'
       } 
 
+      log.debug('importing dockets')
+      file_size = os.path.getsize(self._opinions_fn)
+      file_size_gb = round(file_size/10**9, 2)
+      log.debug(f'Importing {fn} as a Dask Dataframe')
+      msg = f"File Size is : {str(file_size_gb)} GB"
+      log.debug(msg)
+
       return dd.read_csv(fn or self._dockets_fn, dtype=my_types, usecols=['court_id', 'id', 'date_terminated'],
                          blocksize="32MB")
 
+
+  # initialize dockets dict
+  def init_dockets_dict(self, fn=None):
+    fn = fn or self._dockets_fn
+    file_size = os.path.getsize(fn)
+    file_size_gb = round(file_size/10**9, 2)
+    log.debug(f'Importing {fn} as a Dict')
+    msg = f"File Size is : {str(file_size_gb)} GB"
+    log.debug(msg)
+
+    start = time.perf_counter()
+    dockets_dict = {}
+    with open(fn) as dockets:
+        reader = csv.DictReader(dockets)
+        for row in reader:
+            dockets_dict[int(row['id'])] = row['court_id'], row['date_terminated']
+
+    end = time.perf_counter()
+    log.debug(f'{fn} read in {str(int((end-start)/60))} minutes')
+
+    return dockets_dict
+  
   # initialize citation map df
   def init_citation_df(self, fn=None):
       return self.csv_to_df(fn or self._citation_fn)
 
   ## Getters
   def get_courts_df(self):
       return self._df_courts
@@ -170,105 +209,109 @@
       return self._df_dockets
 
   def get_opinions_cluster_df(self):
       return self._df_opinion_clusters
 
   def get_opinions_df(self):
       pass
-      
+
+  class NpEncoder(json.JSONEncoder):
+    def default(self, obj):
+        if isinstance(obj, np.integer):
+            return int(obj)
+        if isinstance(obj, np.floating):
+            return float(obj)
+        if isinstance(obj, np.ndarray):
+            return obj.tolist()
+        if isinstance(obj, NAType):
+            return ''
+        return super(NpEncoder, self).default(obj)
+  
   # process
   def process_row(self, opinion) -> dict:
+    log.debug('process_row')
     dockets = self.get_dockets_df()
     courts = self.get_courts_df()
     citations = self.get_citation_df()
     opinion_id = opinion['id']
     cluster_id = opinion['cluster_id']
 
     # get each corresponding row from clusters, dockets, courts based on opinion id
     cluster_row: self.DataFrame = self.df_row_by_value(self.get_opinions_cluster_df(), 'id', cluster_id)
 
     # get corresponding row from docket df based on cluster opinion id
     docket_id = int(cluster_row['docket_id'])
-    docket_row = dockets[dockets['id'] == docket_id].compute()
-
+    #docket_row = dockets[dockets['id'] == docket_id].compute()
+    docket_row = dockets[docket_id]
+   
     # return early if there's 
-    if len(docket_row.columns) == 0:
-        return 
-    cid = list(docket_row['court_id'])[0]
+    if not docket_row:
+        return
+    cid = docket_row[0]
     court_row: self.DataFrame = courts[courts['id'] == cid]
     if court_row.empty:
         return
 
     # get opinions cited to
     citation_info = self.get_citations(opinion_id, citations)
     cites_to = citation_info['cites_to']
     cited_by = citation_info['cited_by']
 
-    #judges
+    # judges
     judges = cluster_row.judges
     judge_list = [
         judge
         for judge in
             (judges.iloc[0].split(',') if judges.notna().bool() else [])
         if not re.match('[cj]?j\.', judge)
     ]
-        
-    # sometimes date_terminated may be missing and recorded as NaN
-    date_terminated = list(docket_row['date_terminated'])[0]
+    #    
+    ## sometimes date_terminated may be missing and recorded as NaN
+    date_terminated = docket_row[1]
+    ## download url may also be missing
+    url = '' # opinion['download_url']
 
     obj = {
         'id': cluster_id,
-        'url': opinion['download_url'],
+        'url': url,
         'name_abbreviation': cluster_row.case_name.iloc[0],
         'name' : cluster_row.case_name_full.iloc[0],
-        'decision_date': date_terminated,
+        'decision_date': '', #date_terminated,
         'docket_number' : cluster_row.docket_id.iloc[0],
         'citations' : cited_by,
         'cites_to' : cites_to,
         'court' : {'name': court_row.full_name.iloc[0]},
         'jurisdiction' : {'name': court_row.jurisdiction.iloc[0]},
         'casebody' : {'data': {
             'judges': judge_list,
             'head_matter':'', #Ask CL about copyright,
             'opinions': [{
                 'text': self.get_opinion_text(opinion), 
                 'author': '', 'type': ''}]
             }
         }
     }
-    return obj
+    return json.dumps(obj, cls=self.NpEncoder)
 
-  def _taxonify(self, df):
-    df[[
-            'id',
-            'local_path',
-            'download_url',
-            'cluster_id',
-            'xml_harvard',
-            'plain_text',
-            'html',
-            'html_lawbox',
-            'html_columbia',
-            'html_anon_2020'
-          ]].apply(
-            lambda row: print(f'{self.process_row(row)}\n'),
-            axis=1,
-          )  
-
-  def process_df(self, df, client):
-    futures = []
-    for index, row in df.iterrows():
-      self.process_row(row)
-      future = client.submit(self.process_row, row)
-      futures.append(future)
-    #return client.gather(futures)
+  def process_df(self, df):
+    log.debug('process_df: client.map')
+    log.debug('printing mini opinion dataframe as a dict')
+    df_dict = df.to_dict('records')
+    
+    b = db.from_sequence(df_dict, npartitions=int(mp.cpu_count() * .80))
+    #print(list(map(self.process_row, df_dict)))
+    results = db.map(self.process_row, b).to_textfiles('data/*.jsonl')
+    print(results)
     
+  def test(self):
+    print('test')
+  
   def start(self):
     start = time.perf_counter()
-    max_rows = 50
+    max_rows = 1000
     opinion_dtypes = {
         'download_url': 'string',
         'local_path':'string',
         'plain_text':'string',
         'html':'string',
         'html_lawbox':'string',
         'html_columbia':'string',
@@ -287,18 +330,20 @@
            'html_lawbox',
            'html_columbia',
            'html_anon_2020',
            'local_path'           
           ]
     file_size = os.path.getsize(self._opinions_fn)
     file_size_gb = round(file_size/10**9, 2)
-    print(f'Importing {self._opinions_fn} as a dataframe')
-    print("File Size is :", file_size_gb, "GB")
-    client = Client(threads_per_worker=4, n_workers = int(mp.cpu_count() * .35))
+    log.debug(f'Importing {self._opinions_fn} as a dataframe')
+    msg = f"File Size is : {str(file_size_gb)} GB"
+    log.debug(msg)
+    #client = Client(threads_per_worker=4, n_workers = int(mp.cpu_count() * .40))
     for df in pd.read_csv(self._opinions_fn, chunksize=max_rows, dtype=opinion_dtypes, parse_dates=None, usecols=usecols):
-      print('Now reading opinions')
-      self.process_df(df, client)
+      log.debug(f'Now reading {len(df)} opinions')
+      
+      self.process_df(df)
     end = time.perf_counter()
-    print((end-start)/60)
+    log.debug((end-start)/60)
 
 if __name__ == '__main__':
   NoCap.cli()
```

### Comparing `lil_nocap-0.5.0/setup.py` & `lil_nocap-0.5.2/setup.py`

 * *Files 0% similar despite different names*

```diff
@@ -14,15 +14,15 @@
  'pandas>=1.5.3,<2.0.0']
 
 entry_points = \
 {'console_scripts': ['nocap = lil_nocap.__init__:NoCap.cli']}
 
 setup_kwargs = {
     'name': 'lil-nocap',
-    'version': '0.5.0',
+    'version': '0.5.2',
     'description': 'A package for downloading bulk files from courtlistener',
     'long_description': "# Easy Bulk export, no cap\nThis repository provides scripts and notebooks that make it easy to export data in bulk from CourtListener's freely available downloads.\n\n##\n* [x] Create first version of notebook suitable for Data Scientists\n  * [x] Create the appropriate _dtypes_ to optimize panda storage\n  * [x] Select necessary cols _usecols_, for example 'created_by' date field indicating a database _insert_ isn't necessary\n  * [x] Read the _opinions.csv_ (190+gb) chunk at a time from disk while converting into JSON\n* [ ] Create a standalone script that can be piped to other tools\n  * [x] Create PyPi library using [Poetry](https://python-poetry.org/): [package](https://pypi.org/project/lil-nocap)\n  * [x] Output script using [json lines](https://jsonlines.org/examples/) format\n* [ ] Improve speed by using [DASK DataFrame](https://docs.dask.org/en/stable/dataframe.html)\n\n",
     'author': 'sabzo',
     'author_email': 'sabelo@sabelo.io',
     'maintainer': 'None',
     'maintainer_email': 'None',
     'url': 'None',
```

### Comparing `lil_nocap-0.5.0/PKG-INFO` & `lil_nocap-0.5.2/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: lil-nocap
-Version: 0.5.0
+Version: 0.5.2
 Summary: A package for downloading bulk files from courtlistener
 License: MIT
 Author: sabzo
 Author-email: sabelo@sabelo.io
 Requires-Python: >=3.8,<4.0
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Programming Language :: Python :: 3
```

