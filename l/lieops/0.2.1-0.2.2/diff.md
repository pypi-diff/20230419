# Comparing `tmp/lieops-0.2.1.tar.gz` & `tmp/lieops-0.2.2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "lieops-0.2.1.tar", max compression
+gzip compressed data, was "lieops-0.2.2.tar", max compression
```

## Comparing `lieops-0.2.1.tar` & `lieops-0.2.2.tar`

### file list

```diff
@@ -1,122 +1,123 @@
--rw-r--r--   0        0        0    35149 2022-11-09 21:25:15.602818 lieops-0.2.1/LICENSE
--rw-r--r--   0        0        0      801 2022-12-19 15:30:31.591120 lieops-0.2.1/lieops/.ipynb_checkpoints/__init__-checkpoint.py
--rw-r--r--   0        0        0      300 2022-12-12 17:11:21.336115 lieops-0.2.1/lieops/.ipynb_checkpoints/_checks-checkpoint.py
--rw-r--r--   0        0        0      809 2023-02-25 10:56:33.009539 lieops-0.2.1/lieops/__init__.py
--rw-r--r--   0        0        0      161 2023-01-26 14:07:24.174354 lieops-0.2.1/lieops/core/.ipynb_checkpoints/__init__-checkpoint.py
--rw-r--r--   0        0        0     9679 2023-02-16 10:56:49.830853 lieops-0.2.1/lieops/core/.ipynb_checkpoints/birkhoff-checkpoint.py
--rw-r--r--   0        0        0    17900 2023-02-19 12:04:00.069011 lieops-0.2.1/lieops/core/.ipynb_checkpoints/dragt-checkpoint.py
--rwxr-xr-x   0        0        0     8731 2023-02-21 09:49:03.951590 lieops-0.2.1/lieops/core/.ipynb_checkpoints/forest-checkpoint.py
--rw-r--r--   0        0        0     7390 2023-01-26 14:05:50.470620 lieops-0.2.1/lieops/core/.ipynb_checkpoints/hadamard-checkpoint.py
--rw-r--r--   0        0        0    29638 2023-02-24 10:12:32.051397 lieops-0.2.1/lieops/core/.ipynb_checkpoints/lie-checkpoint.py
--rw-r--r--   0        0        0    30739 2023-02-19 11:41:37.185220 lieops-0.2.1/lieops/core/.ipynb_checkpoints/poly-checkpoint.py
--rw-r--r--   0        0        0    16133 2023-02-24 10:08:05.368472 lieops-0.2.1/lieops/core/.ipynb_checkpoints/tools-checkpoint.py
--rw-r--r--   0        0        0      161 2023-01-26 14:07:24.174354 lieops-0.2.1/lieops/core/__init__.py
--rw-r--r--   0        0        0      378 2023-01-26 14:07:35.382319 lieops-0.2.1/lieops/core/__pycache__/__init__.cpython-310.pyc
--rw-r--r--   0        0        0     6749 2023-02-16 10:58:36.962145 lieops-0.2.1/lieops/core/__pycache__/birkhoff.cpython-310.pyc
--rw-r--r--   0        0        0    11253 2023-02-19 12:04:06.353045 lieops-0.2.1/lieops/core/__pycache__/dragt.cpython-310.pyc
--rw-r--r--   0        0        0     6535 2023-02-21 09:50:48.492461 lieops-0.2.1/lieops/core/__pycache__/forest.cpython-310.pyc
--rw-r--r--   0        0        0     6898 2023-01-26 14:08:05.306223 lieops-0.2.1/lieops/core/__pycache__/hadamard.cpython-310.pyc
--rw-r--r--   0        0        0    25282 2023-02-24 10:12:50.288409 lieops-0.2.1/lieops/core/__pycache__/lie.cpython-310.pyc
--rw-r--r--   0        0        0    31841 2022-11-09 21:46:24.347247 lieops-0.2.1/lieops/core/__pycache__/magnus.cpython-310.pyc
--rw-r--r--   0        0        0    31263 2023-02-19 11:41:41.973189 lieops-0.2.1/lieops/core/__pycache__/poly.cpython-310.pyc
--rw-r--r--   0        0        0    14488 2023-02-24 10:09:56.070995 lieops-0.2.1/lieops/core/__pycache__/tools.cpython-310.pyc
--rw-r--r--   0        0        0     9679 2023-02-16 10:56:49.830853 lieops-0.2.1/lieops/core/birkhoff.py
--rw-r--r--   0        0        0       94 2022-12-16 10:31:24.547662 lieops-0.2.1/lieops/core/combine/.ipynb_checkpoints/__init__-checkpoint.py
--rw-r--r--   0        0        0     5073 2022-11-29 22:17:54.832224 lieops-0.2.1/lieops/core/combine/.ipynb_checkpoints/bch-checkpoint.py
--rw-r--r--   0        0        0    45016 2023-02-15 19:38:23.203839 lieops-0.2.1/lieops/core/combine/.ipynb_checkpoints/magnus-checkpoint.py
--rw-r--r--   0        0        0       94 2022-12-16 10:31:24.547662 lieops-0.2.1/lieops/core/combine/__init__.py
--rw-r--r--   0        0        0      288 2022-12-16 10:35:38.430619 lieops-0.2.1/lieops/core/combine/__pycache__/__init__.cpython-310.pyc
--rw-r--r--   0        0        0     4761 2022-12-16 10:35:38.430619 lieops-0.2.1/lieops/core/combine/__pycache__/bch.cpython-310.pyc
--rw-r--r--   0        0        0     4763 2022-11-30 13:11:35.080656 lieops-0.2.1/lieops/core/combine/__pycache__/bruteforce.cpython-310.pyc
--rw-r--r--   0        0        0    35711 2023-02-15 19:38:35.635856 lieops-0.2.1/lieops/core/combine/__pycache__/magnus.cpython-310.pyc
--rw-r--r--   0        0        0     5073 2022-11-29 22:17:54.832224 lieops-0.2.1/lieops/core/combine/bch.py
--rw-r--r--   0        0        0  6023709 2022-11-29 22:17:54.832224 lieops-0.2.1/lieops/core/combine/bch20.csv
--rw-r--r--   0        0        0    45016 2023-02-15 19:38:23.203839 lieops-0.2.1/lieops/core/combine/magnus.py
--rw-r--r--   0        0        0    17900 2023-02-19 12:04:00.069011 lieops-0.2.1/lieops/core/dragt.py
--rwxr-xr-x   0        0        0     8731 2023-02-21 09:49:03.951590 lieops-0.2.1/lieops/core/forest.py
--rw-r--r--   0        0        0      951 2022-11-24 10:09:56.095195 lieops-0.2.1/lieops/core/generators/.ipynb_checkpoints/__init__-checkpoint.py
--rw-r--r--   0        0        0      701 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/core/generators/.ipynb_checkpoints/genfunc-checkpoint.py
--rw-r--r--   0        0        0      951 2022-11-24 10:09:56.095195 lieops-0.2.1/lieops/core/generators/__init__.py
--rw-r--r--   0        0        0     1341 2022-11-24 10:10:15.643538 lieops-0.2.1/lieops/core/generators/__pycache__/__init__.cpython-310.pyc
--rw-r--r--   0        0        0     1176 2022-11-09 21:46:24.339247 lieops-0.2.1/lieops/core/generators/__pycache__/genfunc.cpython-310.pyc
--rw-r--r--   0        0        0      701 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/core/generators/genfunc.py
--rw-r--r--   0        0        0     7390 2023-01-26 14:05:50.470620 lieops-0.2.1/lieops/core/hadamard.py
--rw-r--r--   0        0        0    29638 2023-02-24 10:12:32.051397 lieops-0.2.1/lieops/core/lie.py
--rw-r--r--   0        0        0    30739 2023-02-19 11:41:37.185220 lieops-0.2.1/lieops/core/poly.py
--rw-r--r--   0        0        0    16133 2023-02-24 10:08:05.368472 lieops-0.2.1/lieops/core/tools.py
--rw-r--r--   0        0        0       18 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/linalg/.ipynb_checkpoints/__init__-checkpoint.py
--rw-r--r--   0        0        0     4763 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/linalg/.ipynb_checkpoints/checks-checkpoint.py
--rw-r--r--   0        0        0    16671 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/linalg/.ipynb_checkpoints/common-checkpoint.py
--rw-r--r--   0        0        0     6943 2022-12-26 10:57:16.590605 lieops-0.2.1/lieops/linalg/.ipynb_checkpoints/matrix-checkpoint.py
--rw-r--r--   0        0        0     2926 2023-02-16 16:11:53.683530 lieops-0.2.1/lieops/linalg/.ipynb_checkpoints/misc-checkpoint.py
--rw-r--r--   0        0        0    17063 2023-02-16 11:04:53.608666 lieops-0.2.1/lieops/linalg/.ipynb_checkpoints/nf-checkpoint.py
--rw-r--r--   0        0        0       18 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/linalg/__init__.py
--rw-r--r--   0        0        0      199 2022-11-09 21:46:24.283247 lieops-0.2.1/lieops/linalg/__pycache__/__init__.cpython-310.pyc
--rw-r--r--   0        0        0     5572 2023-01-24 09:09:05.708561 lieops-0.2.1/lieops/linalg/__pycache__/checks.cpython-310.pyc
--rw-r--r--   0        0        0    14056 2022-11-09 21:46:24.327247 lieops-0.2.1/lieops/linalg/__pycache__/common.cpython-310.pyc
--rw-r--r--   0        0        0     8149 2023-01-04 21:02:29.494171 lieops-0.2.1/lieops/linalg/__pycache__/matrix.cpython-310.pyc
--rw-r--r--   0        0        0     2560 2023-02-16 17:00:44.987385 lieops-0.2.1/lieops/linalg/__pycache__/misc.cpython-310.pyc
--rw-r--r--   0        0        0    12635 2023-02-16 17:00:44.983385 lieops-0.2.1/lieops/linalg/__pycache__/nf.cpython-310.pyc
--rw-r--r--   0        0        0       28 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/linalg/bch/.ipynb_checkpoints/__init__-checkpoint.py
--rw-r--r--   0        0        0     4357 2022-11-29 22:17:54.832224 lieops-0.2.1/lieops/linalg/bch/.ipynb_checkpoints/bch_2x2-checkpoint.py
--rw-r--r--   0        0        0       28 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/linalg/bch/__init__.py
--rw-r--r--   0        0        0      212 2022-11-09 21:46:24.455246 lieops-0.2.1/lieops/linalg/bch/__pycache__/__init__.cpython-310.pyc
--rw-r--r--   0        0        0     3026 2022-11-30 11:37:44.281584 lieops-0.2.1/lieops/linalg/bch/__pycache__/bch_2x2.cpython-310.pyc
--rw-r--r--   0        0        0     4357 2022-11-29 22:17:54.832224 lieops-0.2.1/lieops/linalg/bch/bch_2x2.py
--rw-r--r--   0        0        0     5285 2023-01-24 09:08:05.814791 lieops-0.2.1/lieops/linalg/checks.py
--rw-r--r--   0        0        0    16671 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/linalg/common.py
--rw-r--r--   0        0        0      625 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/linalg/congruence/.ipynb_checkpoints/common-checkpoint.py
--rw-r--r--   0        0        0     5749 2023-02-16 11:22:24.603560 lieops-0.2.1/lieops/linalg/congruence/.ipynb_checkpoints/takagi-checkpoint.py
--rw-r--r--   0        0        0        0 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/linalg/congruence/__init__.py
--rw-r--r--   0        0        0      191 2022-11-09 21:46:24.327247 lieops-0.2.1/lieops/linalg/congruence/__pycache__/__init__.cpython-310.pyc
--rw-r--r--   0        0        0      922 2022-11-09 21:46:24.339247 lieops-0.2.1/lieops/linalg/congruence/__pycache__/common.cpython-310.pyc
--rw-r--r--   0        0        0     1895 2022-11-09 21:46:24.339247 lieops-0.2.1/lieops/linalg/congruence/__pycache__/symmetric.cpython-310.pyc
--rw-r--r--   0        0        0     4532 2023-02-16 17:00:44.975385 lieops-0.2.1/lieops/linalg/congruence/__pycache__/takagi.cpython-310.pyc
--rw-r--r--   0        0        0     5990 2022-11-09 21:46:24.339247 lieops-0.2.1/lieops/linalg/congruence/__pycache__/williamson.cpython-310.pyc
--rw-r--r--   0        0        0     5527 2022-11-09 21:46:24.339247 lieops-0.2.1/lieops/linalg/congruence/__pycache__/youla.cpython-310.pyc
--rw-r--r--   0        0        0      625 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/linalg/congruence/common.py
--rw-r--r--   0        0        0     1648 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/linalg/congruence/symmetric.py
--rw-r--r--   0        0        0     5749 2023-02-16 16:59:29.275905 lieops-0.2.1/lieops/linalg/congruence/takagi.py
--rw-r--r--   0        0        0     7212 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/linalg/congruence/williamson.py
--rw-r--r--   0        0        0     5414 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/linalg/congruence/youla.py
--rw-r--r--   0        0        0     6943 2023-01-04 21:02:22.086490 lieops-0.2.1/lieops/linalg/matrix.py
--rw-r--r--   0        0        0     2926 2023-02-16 16:59:29.275905 lieops-0.2.1/lieops/linalg/misc.py
--rw-r--r--   0        0        0    17063 2023-02-16 16:59:29.275905 lieops-0.2.1/lieops/linalg/nf.py
--rw-r--r--   0        0        0     8376 2023-02-16 17:07:53.654270 lieops-0.2.1/lieops/linalg/similarity/.ipynb_checkpoints/common-checkpoint.py
--rw-r--r--   0        0        0     5510 2023-01-13 12:49:35.289726 lieops-0.2.1/lieops/linalg/similarity/.ipynb_checkpoints/simultaneous-checkpoint.py
--rw-r--r--   0        0        0    12740 2023-01-13 13:15:05.289573 lieops-0.2.1/lieops/linalg/similarity/.ipynb_checkpoints/symplectic-checkpoint.py
--rw-r--r--   0        0        0       65 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/linalg/similarity/__init__.py
--rw-r--r--   0        0        0      277 2022-11-09 21:46:24.327247 lieops-0.2.1/lieops/linalg/similarity/__pycache__/__init__.cpython-310.pyc
--rw-r--r--   0        0        0     5886 2023-02-16 17:13:38.431748 lieops-0.2.1/lieops/linalg/similarity/__pycache__/common.cpython-310.pyc
--rw-r--r--   0        0        0     5041 2023-01-13 12:51:13.762984 lieops-0.2.1/lieops/linalg/similarity/__pycache__/simultaneous.cpython-310.pyc
--rw-r--r--   0        0        0     8619 2023-01-13 13:15:11.041562 lieops-0.2.1/lieops/linalg/similarity/__pycache__/symplectic.cpython-310.pyc
--rw-r--r--   0        0        0     8376 2023-02-16 17:07:53.654270 lieops-0.2.1/lieops/linalg/similarity/common.py
--rw-r--r--   0        0        0     5510 2023-01-13 12:49:35.289726 lieops-0.2.1/lieops/linalg/similarity/simultaneous.py
--rw-r--r--   0        0        0    12740 2023-01-13 13:15:05.289573 lieops-0.2.1/lieops/linalg/similarity/symplectic.py
--rw-r--r--   0        0        0      166 2023-01-03 14:11:50.474050 lieops-0.2.1/lieops/solver/.ipynb_checkpoints/__init__-checkpoint.py
--rw-r--r--   0        0        0     3008 2022-12-21 11:14:57.534013 lieops-0.2.1/lieops/solver/.ipynb_checkpoints/bruteforce-checkpoint.py
--rw-r--r--   0        0        0     8380 2023-02-19 12:04:41.817220 lieops-0.2.1/lieops/solver/.ipynb_checkpoints/channell-checkpoint.py
--rw-r--r--   0        0        0     3685 2022-11-25 10:56:17.919842 lieops-0.2.1/lieops/solver/.ipynb_checkpoints/common-checkpoint.py
--rw-r--r--   0        0        0     3560 2023-01-15 17:13:05.779449 lieops-0.2.1/lieops/solver/.ipynb_checkpoints/flow2by2-checkpoint.py
--rw-r--r--   0        0        0     6911 2023-01-18 13:21:39.504328 lieops-0.2.1/lieops/solver/.ipynb_checkpoints/heyoka-checkpoint.py
--rw-r--r--   0        0        0    25729 2022-12-15 19:15:52.499010 lieops-0.2.1/lieops/solver/.ipynb_checkpoints/splitting-checkpoint.py
--rw-r--r--   0        0        0     9341 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/solver/.ipynb_checkpoints/tao-checkpoint.py
--rw-r--r--   0        0        0      166 2023-01-04 21:02:22.086490 lieops-0.2.1/lieops/solver/__init__.py
--rw-r--r--   0        0        0      319 2023-01-04 21:02:29.626165 lieops-0.2.1/lieops/solver/__pycache__/__init__.cpython-310.pyc
--rw-r--r--   0        0        0     3471 2023-01-10 09:34:44.920518 lieops-0.2.1/lieops/solver/__pycache__/bruteforce.cpython-310.pyc
--rw-r--r--   0        0        0     6012 2023-02-19 12:05:32.061429 lieops-0.2.1/lieops/solver/__pycache__/channell.cpython-310.pyc
--rw-r--r--   0        0        0     4414 2022-12-13 15:36:31.011187 lieops-0.2.1/lieops/solver/__pycache__/common.cpython-310.pyc
--rw-r--r--   0        0        0     3310 2023-01-17 09:42:40.078749 lieops-0.2.1/lieops/solver/__pycache__/flow2by2.cpython-310.pyc
--rw-r--r--   0        0        0     6684 2023-01-18 13:23:01.803235 lieops-0.2.1/lieops/solver/__pycache__/heyoka.cpython-310.pyc
--rw-r--r--   0        0        0    18193 2022-12-15 19:18:52.310452 lieops-0.2.1/lieops/solver/__pycache__/splitting.cpython-310.pyc
--rw-r--r--   0        0        0     8770 2022-11-09 21:46:24.447246 lieops-0.2.1/lieops/solver/__pycache__/tao.cpython-310.pyc
--rw-r--r--   0        0        0     3014 2023-01-10 09:34:22.918743 lieops-0.2.1/lieops/solver/bruteforce.py
--rw-r--r--   0        0        0     8380 2023-02-19 12:04:41.817220 lieops-0.2.1/lieops/solver/channell.py
--rw-r--r--   0        0        0     3782 2022-12-13 15:19:37.362628 lieops-0.2.1/lieops/solver/common.py
--rw-r--r--   0        0        0     3556 2023-01-17 09:42:11.863645 lieops-0.2.1/lieops/solver/flow2by2.py
--rw-r--r--   0        0        0     6911 2023-01-18 13:21:39.504328 lieops-0.2.1/lieops/solver/heyoka.py
--rw-r--r--   0        0        0    25729 2022-12-15 19:15:52.499010 lieops-0.2.1/lieops/solver/splitting.py
--rw-r--r--   0        0        0     9341 2022-11-09 21:25:15.602818 lieops-0.2.1/lieops/solver/tao.py
--rw-r--r--   0        0        0      929 2023-02-25 10:59:06.933311 lieops-0.2.1/pyproject.toml
--rw-r--r--   0        0        0     1451 2023-02-25 10:59:34.533172 lieops-0.2.1/setup.py
--rw-r--r--   0        0        0     1000 2023-02-25 10:59:34.533381 lieops-0.2.1/PKG-INFO
+-rw-r--r--   0        0        0    35149 2022-11-09 21:25:15.602818 lieops-0.2.2/LICENSE
+-rw-r--r--   0        0        0      801 2022-12-19 15:30:31.591120 lieops-0.2.2/lieops/.ipynb_checkpoints/__init__-checkpoint.py
+-rw-r--r--   0        0        0      300 2022-12-12 17:11:21.336115 lieops-0.2.2/lieops/.ipynb_checkpoints/_checks-checkpoint.py
+-rw-r--r--   0        0        0      809 2023-04-19 17:56:07.216595 lieops-0.2.2/lieops/__init__.py
+-rw-r--r--   0        0        0      161 2023-01-26 14:07:24.174354 lieops-0.2.2/lieops/core/.ipynb_checkpoints/__init__-checkpoint.py
+-rw-r--r--   0        0        0    10039 2023-04-18 08:13:28.001584 lieops-0.2.2/lieops/core/.ipynb_checkpoints/birkhoff-checkpoint.py
+-rw-r--r--   0        0        0    18883 2023-04-14 17:33:33.425376 lieops-0.2.2/lieops/core/.ipynb_checkpoints/dragt-checkpoint.py
+-rwxr-xr-x   0        0        0    10414 2023-04-14 17:31:09.069614 lieops-0.2.2/lieops/core/.ipynb_checkpoints/forest-checkpoint.py
+-rw-r--r--   0        0        0     7390 2023-01-26 14:05:50.470620 lieops-0.2.2/lieops/core/.ipynb_checkpoints/hadamard-checkpoint.py
+-rw-r--r--   0        0        0    30219 2023-04-18 08:19:54.450014 lieops-0.2.2/lieops/core/.ipynb_checkpoints/lie-checkpoint.py
+-rw-r--r--   0        0        0    31227 2023-04-18 07:50:12.106943 lieops-0.2.2/lieops/core/.ipynb_checkpoints/poly-checkpoint.py
+-rw-r--r--   0        0        0    17908 2023-04-19 12:39:29.340021 lieops-0.2.2/lieops/core/.ipynb_checkpoints/tools-checkpoint.py
+-rw-r--r--   0        0        0      161 2023-01-26 14:07:24.174354 lieops-0.2.2/lieops/core/__init__.py
+-rw-r--r--   0        0        0      378 2023-01-26 14:07:35.382319 lieops-0.2.2/lieops/core/__pycache__/__init__.cpython-310.pyc
+-rw-r--r--   0        0        0     7071 2023-04-18 08:13:37.621550 lieops-0.2.2/lieops/core/__pycache__/birkhoff.cpython-310.pyc
+-rw-r--r--   0        0        0    11846 2023-04-14 17:33:46.809347 lieops-0.2.2/lieops/core/__pycache__/dragt.cpython-310.pyc
+-rw-r--r--   0        0        0     8211 2023-04-14 17:31:18.857567 lieops-0.2.2/lieops/core/__pycache__/forest.cpython-310.pyc
+-rw-r--r--   0        0        0     6898 2023-01-26 14:08:05.306223 lieops-0.2.2/lieops/core/__pycache__/hadamard.cpython-310.pyc
+-rw-r--r--   0        0        0    25822 2023-04-18 08:19:59.913938 lieops-0.2.2/lieops/core/__pycache__/lie.cpython-310.pyc
+-rw-r--r--   0        0        0    31841 2022-11-09 21:46:24.347247 lieops-0.2.2/lieops/core/__pycache__/magnus.cpython-310.pyc
+-rw-r--r--   0        0        0    31465 2023-04-18 07:50:17.083096 lieops-0.2.2/lieops/core/__pycache__/poly.cpython-310.pyc
+-rw-r--r--   0        0        0    15565 2023-04-19 14:45:11.330820 lieops-0.2.2/lieops/core/__pycache__/tools.cpython-310.pyc
+-rw-r--r--   0        0        0    10039 2023-04-18 08:13:28.001584 lieops-0.2.2/lieops/core/birkhoff.py
+-rw-r--r--   0        0        0       94 2022-12-16 10:31:24.547662 lieops-0.2.2/lieops/core/combine/.ipynb_checkpoints/__init__-checkpoint.py
+-rw-r--r--   0        0        0     5073 2022-11-29 22:17:54.832224 lieops-0.2.2/lieops/core/combine/.ipynb_checkpoints/bch-checkpoint.py
+-rw-r--r--   0        0        0    45016 2023-02-15 19:38:23.203839 lieops-0.2.2/lieops/core/combine/.ipynb_checkpoints/magnus-checkpoint.py
+-rw-r--r--   0        0        0       94 2022-12-16 10:31:24.547662 lieops-0.2.2/lieops/core/combine/__init__.py
+-rw-r--r--   0        0        0      288 2022-12-16 10:35:38.430619 lieops-0.2.2/lieops/core/combine/__pycache__/__init__.cpython-310.pyc
+-rw-r--r--   0        0        0     4761 2022-12-16 10:35:38.430619 lieops-0.2.2/lieops/core/combine/__pycache__/bch.cpython-310.pyc
+-rw-r--r--   0        0        0     4763 2022-11-30 13:11:35.080656 lieops-0.2.2/lieops/core/combine/__pycache__/bruteforce.cpython-310.pyc
+-rw-r--r--   0        0        0    35711 2023-02-15 19:38:35.635856 lieops-0.2.2/lieops/core/combine/__pycache__/magnus.cpython-310.pyc
+-rw-r--r--   0        0        0     5073 2022-11-29 22:17:54.832224 lieops-0.2.2/lieops/core/combine/bch.py
+-rw-r--r--   0        0        0  6023709 2022-11-29 22:17:54.832224 lieops-0.2.2/lieops/core/combine/bch20.csv
+-rw-r--r--   0        0        0    45016 2023-02-15 19:38:23.203839 lieops-0.2.2/lieops/core/combine/magnus.py
+-rw-r--r--   0        0        0    18883 2023-04-14 17:33:33.425376 lieops-0.2.2/lieops/core/dragt.py
+-rwxr-xr-x   0        0        0    10414 2023-04-14 17:31:09.069614 lieops-0.2.2/lieops/core/forest.py
+-rw-r--r--   0        0        0      951 2022-11-24 10:09:56.095195 lieops-0.2.2/lieops/core/generators/.ipynb_checkpoints/__init__-checkpoint.py
+-rw-r--r--   0        0        0      701 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/core/generators/.ipynb_checkpoints/genfunc-checkpoint.py
+-rw-r--r--   0        0        0      951 2022-11-24 10:09:56.095195 lieops-0.2.2/lieops/core/generators/__init__.py
+-rw-r--r--   0        0        0     1341 2022-11-24 10:10:15.643538 lieops-0.2.2/lieops/core/generators/__pycache__/__init__.cpython-310.pyc
+-rw-r--r--   0        0        0     1176 2022-11-09 21:46:24.339247 lieops-0.2.2/lieops/core/generators/__pycache__/genfunc.cpython-310.pyc
+-rw-r--r--   0        0        0      701 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/core/generators/genfunc.py
+-rw-r--r--   0        0        0     7390 2023-01-26 14:05:50.470620 lieops-0.2.2/lieops/core/hadamard.py
+-rw-r--r--   0        0        0    30219 2023-04-18 08:19:54.450014 lieops-0.2.2/lieops/core/lie.py
+-rw-r--r--   0        0        0    31227 2023-04-18 07:50:12.106943 lieops-0.2.2/lieops/core/poly.py
+-rw-r--r--   0        0        0    17908 2023-04-19 12:39:29.340021 lieops-0.2.2/lieops/core/tools.py
+-rw-r--r--   0        0        0       18 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/linalg/.ipynb_checkpoints/__init__-checkpoint.py
+-rw-r--r--   0        0        0     4763 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/linalg/.ipynb_checkpoints/checks-checkpoint.py
+-rw-r--r--   0        0        0    19242 2023-04-06 17:25:41.628050 lieops-0.2.2/lieops/linalg/.ipynb_checkpoints/common-checkpoint.py
+-rw-r--r--   0        0        0    11817 2023-04-06 18:11:06.621183 lieops-0.2.2/lieops/linalg/.ipynb_checkpoints/matrix-checkpoint.py
+-rw-r--r--   0        0        0     2926 2023-02-16 16:11:53.683530 lieops-0.2.2/lieops/linalg/.ipynb_checkpoints/misc-checkpoint.py
+-rw-r--r--   0        0        0    17831 2023-04-18 07:59:52.379927 lieops-0.2.2/lieops/linalg/.ipynb_checkpoints/nf-checkpoint.py
+-rw-r--r--   0        0        0       18 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/linalg/__init__.py
+-rw-r--r--   0        0        0      199 2022-11-09 21:46:24.283247 lieops-0.2.2/lieops/linalg/__pycache__/__init__.cpython-310.pyc
+-rw-r--r--   0        0        0     5572 2023-01-24 09:09:05.708561 lieops-0.2.2/lieops/linalg/__pycache__/checks.cpython-310.pyc
+-rw-r--r--   0        0        0    15904 2023-04-06 17:25:49.203860 lieops-0.2.2/lieops/linalg/__pycache__/common.cpython-310.pyc
+-rw-r--r--   0        0        0    12012 2023-04-06 18:11:45.503820 lieops-0.2.2/lieops/linalg/__pycache__/matrix.cpython-310.pyc
+-rw-r--r--   0        0        0     2560 2023-02-16 17:00:44.987385 lieops-0.2.2/lieops/linalg/__pycache__/misc.cpython-310.pyc
+-rw-r--r--   0        0        0    13138 2023-04-18 08:00:13.555439 lieops-0.2.2/lieops/linalg/__pycache__/nf.cpython-310.pyc
+-rw-r--r--   0        0        0       28 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/linalg/bch/.ipynb_checkpoints/__init__-checkpoint.py
+-rw-r--r--   0        0        0     4357 2022-11-29 22:17:54.832224 lieops-0.2.2/lieops/linalg/bch/.ipynb_checkpoints/bch_2x2-checkpoint.py
+-rw-r--r--   0        0        0       28 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/linalg/bch/__init__.py
+-rw-r--r--   0        0        0      212 2022-11-09 21:46:24.455246 lieops-0.2.2/lieops/linalg/bch/__pycache__/__init__.cpython-310.pyc
+-rw-r--r--   0        0        0     3026 2022-11-30 11:37:44.281584 lieops-0.2.2/lieops/linalg/bch/__pycache__/bch_2x2.cpython-310.pyc
+-rw-r--r--   0        0        0     4357 2022-11-29 22:17:54.832224 lieops-0.2.2/lieops/linalg/bch/bch_2x2.py
+-rw-r--r--   0        0        0     5285 2023-01-24 09:08:05.814791 lieops-0.2.2/lieops/linalg/checks.py
+-rw-r--r--   0        0        0    19242 2023-04-06 17:25:41.628050 lieops-0.2.2/lieops/linalg/common.py
+-rw-r--r--   0        0        0      625 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/linalg/congruence/.ipynb_checkpoints/common-checkpoint.py
+-rw-r--r--   0        0        0     5898 2023-04-04 13:07:06.030498 lieops-0.2.2/lieops/linalg/congruence/.ipynb_checkpoints/takagi-checkpoint.py
+-rw-r--r--   0        0        0     7212 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/linalg/congruence/.ipynb_checkpoints/williamson-checkpoint.py
+-rw-r--r--   0        0        0        0 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/linalg/congruence/__init__.py
+-rw-r--r--   0        0        0      191 2022-11-09 21:46:24.327247 lieops-0.2.2/lieops/linalg/congruence/__pycache__/__init__.cpython-310.pyc
+-rw-r--r--   0        0        0      922 2022-11-09 21:46:24.339247 lieops-0.2.2/lieops/linalg/congruence/__pycache__/common.cpython-310.pyc
+-rw-r--r--   0        0        0     1895 2022-11-09 21:46:24.339247 lieops-0.2.2/lieops/linalg/congruence/__pycache__/symmetric.cpython-310.pyc
+-rw-r--r--   0        0        0     4650 2023-04-04 13:07:16.826445 lieops-0.2.2/lieops/linalg/congruence/__pycache__/takagi.cpython-310.pyc
+-rw-r--r--   0        0        0     5990 2022-11-09 21:46:24.339247 lieops-0.2.2/lieops/linalg/congruence/__pycache__/williamson.cpython-310.pyc
+-rw-r--r--   0        0        0     5527 2022-11-09 21:46:24.339247 lieops-0.2.2/lieops/linalg/congruence/__pycache__/youla.cpython-310.pyc
+-rw-r--r--   0        0        0      625 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/linalg/congruence/common.py
+-rw-r--r--   0        0        0     1648 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/linalg/congruence/symmetric.py
+-rw-r--r--   0        0        0     5898 2023-04-04 13:07:06.030498 lieops-0.2.2/lieops/linalg/congruence/takagi.py
+-rw-r--r--   0        0        0     7212 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/linalg/congruence/williamson.py
+-rw-r--r--   0        0        0     5414 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/linalg/congruence/youla.py
+-rw-r--r--   0        0        0    11817 2023-04-06 18:11:06.621183 lieops-0.2.2/lieops/linalg/matrix.py
+-rw-r--r--   0        0        0     2926 2023-02-16 16:59:29.275905 lieops-0.2.2/lieops/linalg/misc.py
+-rw-r--r--   0        0        0    17831 2023-04-18 07:59:52.379927 lieops-0.2.2/lieops/linalg/nf.py
+-rw-r--r--   0        0        0     8376 2023-02-16 17:07:53.654270 lieops-0.2.2/lieops/linalg/similarity/.ipynb_checkpoints/common-checkpoint.py
+-rw-r--r--   0        0        0     5510 2023-01-13 12:49:35.289726 lieops-0.2.2/lieops/linalg/similarity/.ipynb_checkpoints/simultaneous-checkpoint.py
+-rw-r--r--   0        0        0    12740 2023-01-13 13:15:05.289573 lieops-0.2.2/lieops/linalg/similarity/.ipynb_checkpoints/symplectic-checkpoint.py
+-rw-r--r--   0        0        0       65 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/linalg/similarity/__init__.py
+-rw-r--r--   0        0        0      277 2022-11-09 21:46:24.327247 lieops-0.2.2/lieops/linalg/similarity/__pycache__/__init__.cpython-310.pyc
+-rw-r--r--   0        0        0     5886 2023-02-16 17:13:38.431748 lieops-0.2.2/lieops/linalg/similarity/__pycache__/common.cpython-310.pyc
+-rw-r--r--   0        0        0     5041 2023-01-13 12:51:13.762984 lieops-0.2.2/lieops/linalg/similarity/__pycache__/simultaneous.cpython-310.pyc
+-rw-r--r--   0        0        0     8619 2023-01-13 13:15:11.041562 lieops-0.2.2/lieops/linalg/similarity/__pycache__/symplectic.cpython-310.pyc
+-rw-r--r--   0        0        0     8376 2023-02-16 17:07:53.654270 lieops-0.2.2/lieops/linalg/similarity/common.py
+-rw-r--r--   0        0        0     5510 2023-01-13 12:49:35.289726 lieops-0.2.2/lieops/linalg/similarity/simultaneous.py
+-rw-r--r--   0        0        0    12740 2023-01-13 13:15:05.289573 lieops-0.2.2/lieops/linalg/similarity/symplectic.py
+-rw-r--r--   0        0        0      166 2023-01-03 14:11:50.474050 lieops-0.2.2/lieops/solver/.ipynb_checkpoints/__init__-checkpoint.py
+-rw-r--r--   0        0        0     3008 2022-12-21 11:14:57.534013 lieops-0.2.2/lieops/solver/.ipynb_checkpoints/bruteforce-checkpoint.py
+-rw-r--r--   0        0        0     8380 2023-02-19 12:04:41.817220 lieops-0.2.2/lieops/solver/.ipynb_checkpoints/channell-checkpoint.py
+-rw-r--r--   0        0        0     3810 2023-04-18 08:13:19.261611 lieops-0.2.2/lieops/solver/.ipynb_checkpoints/common-checkpoint.py
+-rw-r--r--   0        0        0     4466 2023-04-11 15:16:54.122450 lieops-0.2.2/lieops/solver/.ipynb_checkpoints/flow2by2-checkpoint.py
+-rw-r--r--   0        0        0     6911 2023-04-18 08:17:05.612067 lieops-0.2.2/lieops/solver/.ipynb_checkpoints/heyoka-checkpoint.py
+-rw-r--r--   0        0        0    25729 2022-12-15 19:15:52.499010 lieops-0.2.2/lieops/solver/.ipynb_checkpoints/splitting-checkpoint.py
+-rw-r--r--   0        0        0     9341 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/solver/.ipynb_checkpoints/tao-checkpoint.py
+-rw-r--r--   0        0        0      166 2023-01-04 21:02:22.086490 lieops-0.2.2/lieops/solver/__init__.py
+-rw-r--r--   0        0        0      319 2023-01-04 21:02:29.626165 lieops-0.2.2/lieops/solver/__pycache__/__init__.cpython-310.pyc
+-rw-r--r--   0        0        0     3471 2023-01-10 09:34:44.920518 lieops-0.2.2/lieops/solver/__pycache__/bruteforce.cpython-310.pyc
+-rw-r--r--   0        0        0     6012 2023-02-19 12:05:32.061429 lieops-0.2.2/lieops/solver/__pycache__/channell.cpython-310.pyc
+-rw-r--r--   0        0        0     4382 2023-04-18 08:13:37.565550 lieops-0.2.2/lieops/solver/__pycache__/common.cpython-310.pyc
+-rw-r--r--   0        0        0     4182 2023-04-11 15:16:59.114425 lieops-0.2.2/lieops/solver/__pycache__/flow2by2.cpython-310.pyc
+-rw-r--r--   0        0        0     6645 2023-04-18 08:20:00.069936 lieops-0.2.2/lieops/solver/__pycache__/heyoka.cpython-310.pyc
+-rw-r--r--   0        0        0    18193 2022-12-15 19:18:52.310452 lieops-0.2.2/lieops/solver/__pycache__/splitting.cpython-310.pyc
+-rw-r--r--   0        0        0     8770 2022-11-09 21:46:24.447246 lieops-0.2.2/lieops/solver/__pycache__/tao.cpython-310.pyc
+-rw-r--r--   0        0        0     3014 2023-01-10 09:34:22.918743 lieops-0.2.2/lieops/solver/bruteforce.py
+-rw-r--r--   0        0        0     8380 2023-02-19 12:04:41.817220 lieops-0.2.2/lieops/solver/channell.py
+-rw-r--r--   0        0        0     3810 2023-04-18 08:13:19.261611 lieops-0.2.2/lieops/solver/common.py
+-rw-r--r--   0        0        0     4466 2023-04-11 15:16:54.122450 lieops-0.2.2/lieops/solver/flow2by2.py
+-rw-r--r--   0        0        0     6911 2023-04-18 08:17:05.612067 lieops-0.2.2/lieops/solver/heyoka.py
+-rw-r--r--   0        0        0    25729 2022-12-15 19:15:52.499010 lieops-0.2.2/lieops/solver/splitting.py
+-rw-r--r--   0        0        0     9341 2022-11-09 21:25:15.602818 lieops-0.2.2/lieops/solver/tao.py
+-rw-r--r--   0        0        0      929 2023-04-19 17:57:05.548264 lieops-0.2.2/pyproject.toml
+-rw-r--r--   0        0        0     1451 2023-04-19 17:57:25.013190 lieops-0.2.2/setup.py
+-rw-r--r--   0        0        0     1000 2023-04-19 17:57:25.013425 lieops-0.2.2/PKG-INFO
```

### Comparing `lieops-0.2.1/LICENSE` & `lieops-0.2.2/LICENSE`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/.ipynb_checkpoints/__init__-checkpoint.py` & `lieops-0.2.2/lieops/.ipynb_checkpoints/__init__-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/__init__.py` & `lieops-0.2.2/lieops/__init__.py`

 * *Files 1% similar despite different names*

```diff
@@ -12,12 +12,12 @@
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
     GNU General Public License for more details.
 
     You should have received a copy of the GNU General Public License
     along with this program.  If not, see <https://www.gnu.org/licenses/>.
 '''
 
-__version__ = '0.2.1'
+__version__ = '0.2.2'
 
 from lieops.core import *
 from lieops.linalg import *
```

### Comparing `lieops-0.2.1/lieops/core/.ipynb_checkpoints/birkhoff-checkpoint.py` & `lieops-0.2.2/lieops/core/.ipynb_checkpoints/birkhoff-checkpoint.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,10 +1,11 @@
 import lieops.core.lie
 from lieops.solver.common import getRealHamiltonFunction
 from lieops.linalg.nf import first_order_nf_expansion
+from lieops.linalg.matrix import emat
 from lieops.core.tools import ad2poly
 
 def homological_eq(mu, Z, **kwargs):
     '''
     Let e[k], k = 1, ..., len(mu) be actions, H0 := sum_k mu[k]*e[k] and Z a
     polynomial of degree n. Then this routine will solve 
     the homological equation 
@@ -38,15 +39,15 @@
         om = sum([(powers[k] - powers[Z.dim + k])*mu[k] for k in range(len(mu))])
         if om != 0:
             chi[powers] = 1j/om*value
         else:
             Q[powers] = value
     return chi, Q
 
-def bnf(H, order: int=1, tol=1e-12, cmplx=True, **kwargs):
+def bnf(H, order: int=1, tol_drop=0, tol=1e-12, cmplx=True, **kwargs):
     '''
     Compute the Birkhoff normal form of a given Hamiltonian up to a specific order.
     
     Attention: Constants and any gradients of H at z will be ignored. If there is 
     a non-zero gradient, a warning is issued by default.
     
     Parameters
@@ -64,26 +65,30 @@
         k homogeneous Lie-polynomials, where the smallest one will have power k + 2 and the 
         succeeding ones will have increased powers by 1.
     
     cmplx: boolean, optional
         If false, assume that the coefficients of the second-order terms of the Hamiltonian are real.
         In this case a check will be done and an error will be raised if that is not the case.
         
+    tol_drop: float, optional
+        Tolerance below which values in the Hamiltonian are set to zero.
+        
     tol: float, optional
-        Tolerance below which values are assumed to be zero.
+        Tolerance for consistency checks.
         
     **kwargs
         Keyword arguments are passed to lieops.linalg.nf.first_order_nf_expansion routine.
         
     Returns
     -------
     dict
         A dictionary with the following keys:
         nfdict : The output of lieops.linalg.nf.first_order_nf_expansion.
-        H      : Dictionary denoting the used Hamiltonian.
+        H_func : Callable denoting the Hamiltonian in (q, p)-coordinates whose derivatives will be calculated.
+        H      : Dictionary denoting the Hamiltonian used at the start of the normal form procedure.
         H0     : Dictionary denoting the second-order coefficients of H.
         mu     : List of the tunes used (coefficients of H0).
         chi    : List of poly objects, denoting the Lie-polynomials of degree >= 3 which map to normal form.
         chi0   : List of the two Lie-polynomials of degree 2 which map the given Hamiltonian 
                  to its first-order normal form equivalent. This means that the list "chi0 + chi" performs the 
                  entire map up to the desired order (see also the example below). Not supported if mpmath has been used.                 
         Hk     : List of poly objects, corresponding to the transformed Hamiltonians.
@@ -115,15 +120,15 @@
         # assume that H is given as a function, depending on phase space coordinates.
         kwargs['power'] = power
         Hinp = H
         if isinstance(H, lieops.core.lie.poly):
             # we have to transfom the call-routine of H: H depend on (xi, eta)-coordinates, but the nf routines later on assume (q, p)-coordinates.
             # In principle, one can change this transformation somewhere else, but this may cause the normal form routines
             # to either yield inconsistent output at a general point z -- or it may introduce additional complexity.
-            Hinp = getRealHamiltonFunction(H, tol=tol, **kwargs)
+            Hinp = getRealHamiltonFunction(H, tol_drop=tol_drop)
         taylor_coeffs, nfdict = first_order_nf_expansion(Hinp, tol=tol, **kwargs)
         # N.B. while Hinp is given in terms of (q, p) variables, taylor_coeffs correspond to the Taylor-expansion
         # of the Hamiltonian around z=(q0, p0) with respect to the normal form (xi, eta) coordinates (see first_order_nf_expansion routine).
     else:
         # Attention: In this case we assume that H is already in complex normal form (CNF): Off-diagonal entries will be ignored (see code below).
         taylor_coeffs = H
         nfdict = {}
@@ -146,15 +151,15 @@
         if not cmplx:
             # by default we assume that the coefficients in front of the 2nd order terms are real.
             assert muj.imag < tol, f'Imaginary part of entry {j} above tolerance: {muj.imag} >= {tol}. Check input or try cmplx=True option.'
             muj = muj.real
         H0_values[tpl] = muj
         mu.append(muj)
     H0 = lieops.core.lie.poly(values=H0_values, dim=dim, max_power=max_power)
-    assert len({k: v for k, v in taylor_coeffs.items() if sum(k) == 2 and abs(v) >= tol}) == 0 # All other 2nd order Taylor coefficients must be zero.
+    assert len({k: v for k, v in taylor_coeffs.items() if sum(k) == 2 and (abs(v) >= tol).all()}) == 0 # All other 2nd order Taylor coefficients must be zero.
 
     # For H, we take the values of H0 and add only higher-order terms (so we skip any gradients (and constants). 
     # Note that the skipping of gradients leads to an artificial normal form which may not have any relation
     # to the original problem. By default, the user will be informed if there is a non-zero gradient 
     # in 'first_order_nf_expansion' routine.
     H = H0.update({k: v for k, v in taylor_coeffs.items() if sum(k) > 2})
         
@@ -187,14 +192,15 @@
         Zk_all.append(Zk)
         Qk_all.append(Q)
 
     # assemble output
     out = {}
     out['nfdict'] = nfdict
     out['H'] = H
+    out['H_func'] = Hinp
     out['H0'] = H0
     out['mu'] = mu
     out['lchi_inv'] = lchi_all
     out['chi'] = chi_all
     out['Hk'] = Hk_all
     out['Zk'] = Zk_all
     out['Qk'] = Qk_all
@@ -203,11 +209,12 @@
     out['max_power'] = max_power
     
     out['chi0'] = []
     for clabel in ['C1', 'C2']:
         if clabel in nfdict.keys():
             # In this case we can also compute the polynomials which provide the transformation to first-order normal form:
             C = nfdict[clabel]
-            Cp = ad2poly(C.transpose()) # transposition required (see e.g. Sec. 8.3.5 "Dual role of the Phase-Space Coordinates" in Dragt's book)
+            C = emat(C).transpose().matrix # transposition required (see e.g. Sec. 8.3.5 "Dual role of the Phase-Space Coordinates" in Dragt's book)
+            Cp = ad2poly(C)
             out['chi0'].append(Cp)
         
     return out
```

### Comparing `lieops-0.2.1/lieops/core/.ipynb_checkpoints/dragt-checkpoint.py` & `lieops-0.2.2/lieops/core/.ipynb_checkpoints/dragt-checkpoint.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,17 +1,29 @@
 import numpy as np
 from scipy.linalg import expm, logm
 from tqdm import tqdm
 import warnings
 
-from lieops.linalg.matrix import create_J
+from njet.common import check_zero
+
+from lieops.linalg.matrix import create_J, emat
 from lieops.linalg.nf import symlogs
+from lieops.linalg.common import ndsupport
+
 from lieops.core.lie import create_coords, lexp
 from lieops.core.tools import const2poly, poly2vec, ad2poly
 
+@ndsupport
+def logm_nd(X, **kwargs):
+    return logm(X, **kwargs)
+
+@ndsupport
+def expm_nd(X, **kwargs):
+    return expm(X, **kwargs)
+
 def _integrate_k(p, k: int):
     '''
     Let p be a Lie polynomial. Then this routine will
     compute the integral of p*dz_k, where z_k denotes the k-th component.
     '''
     integral_values = {}
     dim = p.dim
@@ -162,15 +174,15 @@
         start = offset
         final = [e(*offset) for e in p]
 
     if order == 0: # In this case we can immediately return a first-order polynomial, which will provide the translation:
         diff = [final[k] - start[k] for k in range(dim2)]
         return [const2poly(*diff, poisson_factor=pf)]
 
-    start_is_nonzero = any([e != 0 for e in start])
+    start_is_nonzero = any([not check_zero(e) for e in start])
     if start_is_nonzero:
         # preparation step in case of translations, see Ref. [1], Eq. (7.7.17)
         h1 = const2poly(*start, poisson_factor=pf, max_power=max_power) # E.g.: lexp(h1)(xi) = xi + start[0] 
         p = lexp(h1)(*p, method='2flow')
         # the application of exp(:h1:), where h1 is a first-order polynomial, has produced a new Taylor map of max_deg - 1.
         # Therefore we should reduce the requested order by one if the order is larger or equal max_deg, to avoid an error with the final step: 
         # Due to truncation at the original map may not admit a symplectomorphism at the its final requested order.
@@ -180,35 +192,43 @@
             order = order - 1
 
     if order > max_deg and warn:
         warnings.warn(f'Requested order {order} > {max_deg} (maximal degree of Taylor map).')
         
     # Determine the linear part of the map
     R = np.array([poly2vec(e.homogeneous_part(1)).tolist() for e in p])
-    J = create_J(dim)
+    R = emat(R)
+    J = emat(create_J(dim))
+    Rtr = R.transpose()    
+    Ri = -J@Rtr@J # The inverse of R. 
+    
     if tol_checks > 0:
         # Symplecticity check of the map; it is crucial to check symplecticity this point *before* applying logm or symlogs etc. to avoid subtle errors produced from 'almost symplectic' maps
-        assert np.linalg.norm(R.transpose()@J@R - J) < tol_checks, f'Map not symplectic within a tolerance of {tol_checks}.'
-    
+        RtrJR = Rtr@J@R
+        JJ = create_J(dim, shape=R.shape[2:])
+        check = np.sqrt(np.linalg.norm(RtrJR.matrix - JJ)**2/np.prod(R.shape[2:])) # Division by the number of matrices as measure (seems to be good enough rather than computing the norms individually)
+        assert check < tol_checks, f'Symplecticity check fails: {check} >= {tol_checks} (tol_checks).'
+        
     # Compute the 2nd-order polynomial(s) of the Dragt/Finn factorization
     if comb2:
         try:
-            A = logm(R.transpose()) # Explanation why we have to use transpose will follow at (++)
-            SA = ad2poly(A, poisson_factor=pf, tol=tol, max_power=max_power).above(tol)
+            A = logm_nd(Rtr.matrix) # Explanation why we have to use transpose will follow at (++)
+            SA = ad2poly(A, poisson_factor=pf, tol=tol_checks, max_power=max_power).above(tol)
             SB = SA*0
             B = A*0
         except:
             if warn:
-                warnings.warn(f"Map appears to require two 2nd-order polynomials (tol: {tol}).")
+                warnings.warn(f"Map requires two 2nd-order polynomials (tol: {tol}).")
             comb2 = False
+            
     if not comb2:
-        A, B = symlogs(R.transpose(), tol2=tol_checks) # This means: exp(A) o exp(B) = R.transpose(). Explanation why we have to use transpose will follow at (++)
+        A, B = symlogs(Rtr.matrix, tol2=tol_checks) # This means: exp(A) o exp(B) = R.transpose(). Explanation why we have to use transpose will follow at (++)
         SA = ad2poly(A, poisson_factor=pf, tol=tol_checks, max_power=max_power).above(tol)
         SB = ad2poly(B, poisson_factor=pf, tol=tol_checks, max_power=max_power).above(tol)
-        
+                
     # (++) 
     # Let us assume that we would have taken "symlogs(R) = A, B" (i.e. exp(A) o exp(B) = R) and consider a 1-dim case.
     # In the following the '~' symbol means that we identify the (1, 0)-key with xi and the (0, 1)-key with eta.
     # By definition of ad2poly:
     # SA@xi ~ A@[1, 0]
     # SA@eta ~ A@[0, 1]
     # SB@xi ~ B@[1, 0]
@@ -231,15 +251,21 @@
     # lexp(SA')(*lexp(SB')(*xieta)) = R        (1)
     # This is the reason why we had to use .transpose() in the construction of SA and SB above.
     # See also Sec. 8.3.5 "Dual role of the Phase-Space Coordinates" in Dragt's book [1]. In that
     # section, the transposition can be found as well.
         
     if tol_checks > 0:
         # check if symlogs gives correct results
-        assert np.linalg.norm(expm(A)@expm(B) - R.transpose()) < tol_checks
+        # Calculate expm(A)@expm(B). In case of multi-dimensional arrays, we can not simply use
+        # the matrix multiplication operator '@' however, but instead need to multiply by hand:
+        expA, expB = expm_nd(A), expm_nd(B)
+        expA, expB = emat(expA), emat(expB)
+        expAexpB = expA@expB
+        check = np.sqrt(np.linalg.norm(expAexpB.matrix - Rtr.matrix)**2/np.prod(R.shape[2:])) # Division by the number of matrices.
+        assert check < tol_checks
         xieta = create_coords(dim, poisson_factor=pf, max_power=max_power) # for the two checks at (+) below
         # Now it holds with
         # op_result := lexp(SA)(*lexp(SB)(*xieta, power=30), power=30)
         # 1) p[k] == op_result[k]    (2)
         # 2) with
         # op_matrix = np.array([poly2vec(op) for op in op_result])
         # R == op_matrix
@@ -253,16 +279,15 @@
         # [e(*xieta0) for e in p]        (3)
         # Instead, due to the pull-back property of the lexp-operators, the correct way to obtain
         # the result (3) would be:
         # lexp(SB)(*lexp(SA)(*xieta0))   (4)
         # Note the difference of the order: Now SB and SA in Eq. (4) are reversed in comparison to Eq. (1).
 
     # Ensure that the Poincare-Lemma is met for the first step; See Ref. [1], Eq. (7.6.17):
-    Ri = -J@R.transpose()@J
-    p_new = [sum([p[k]*Ri[l, k] for k in range(dim2)]) for l in range(dim2)] # multiply Ri from right to prevent operator overloading from numpy.
+    p_new = [sum([p[k]*Ri.matrix[l, k] for k in range(dim2)]) for l in range(dim2)] # multiply Ri from right to prevent operator overloading from numpy.
     if tol > 0:
         # not dropping small values may result in a slow-down of the code. Therefore:
         p_new = [e.above(tol) for e in p_new]
         
     # Construct & collect the chain of operators of the Dragt/Finn factorization.
     # We shall collect these operators in a list 'f_all' so that the first operator 
     # in f_all is exectued first, if applied to *numbers* (see the 'Attention' section above). Hence:
@@ -325,15 +350,15 @@
         if len(f_nl) > 0:
             f_hdm = lexp(-SB)(*lexp(-SA)(*f_nl, outl1=True, method='2flow'), outl1=True, method='2flow') # the outl1 parameters are True here to cope with special cases that SA or its input is zero. In this case the Lie-operators would return a Lie-polynomial. That would cause a problem with the use of '*' here and f_hdm may also not be a list ...
         f_all = f_all + [f.above(tol) for f in f_hdm if f.above(tol) != 0] # Every entry in f_nl is non-zero (wrt. tol) by construction. Since the lexp(-SB) and lexp(-SA) operators are invertible, the elements in f_hdm are therefore also non-zero. However, the lexp-operators may still generate many small terms which should be removed here.
         
     if start_is_nonzero:
         f_all.insert(0, -h1)
             
-    if any([e != 0 for e in final]):
+    if any([not check_zero(e) for e in final]):
         g1 = const2poly(*final, poisson_factor=pf, max_power=max_power)
         if start_is_nonzero and len(f_all) == 1:
             # in this case only a single term (-h1) of order 1 is contained in f_all thus far. We shall combine this term with g1 (such a case may happen for a first-order polynomial + offset as input)
             f_all[0] += g1
         else:
             f_all.append(g1)
```

### Comparing `lieops-0.2.1/lieops/core/.ipynb_checkpoints/forest-checkpoint.py` & `lieops-0.2.2/lieops/core/.ipynb_checkpoints/forest-checkpoint.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,13 +1,13 @@
 import warnings
 import numpy as np
 from tqdm import tqdm
 
 from lieops.core import lexp, create_coords, poly
-from lieops.core.tools import ad2poly, poly2ad, tpsa
+from lieops.core.tools import ad2poly, poly2ad, tpsa, taylor_map
 from lieops.core.dragt import dragtfinn
 
 twopi = float(np.pi*2)
 
 def _rot_kernel(fk, mu):
     '''
     In case that R in Eq. (4.34), Ref. [1], consist of a rotation, we can
@@ -15,20 +15,24 @@
     '''
     dim = len(mu)
     a = {}
     for powers, value in fk.items():
         m1 = powers[:dim]
         m2 = powers[dim:]
         z = sum([(m1[k] - m2[k])*mu[k] for k in range(dim)])*1j
-        if z.real != 0 or (z.real == 0 and (z.imag/twopi)%1 != 0): # I.e. exp(z) != 1
-            a[powers] = value/(1 - np.exp(-z)) # for the -1 sign in front of z see my notes regarding Normal form (Lie_techniques.pdf); this -1 is due to the fact that R^(-1) must be considered.
+        
+        cond = np.logical_or(z.real != 0, np.logical_and(z.real == 0, (z.imag/twopi)%1 != 0)) # I.e. exp(z) != 1
+        a[powers] = np.divide(value, 1 - np.exp(-z), out=np.zeros_like(value), where=cond)
+        # Remarks:
+        # 1) for the -1 sign in front of z see my notes regarding Normal form (Lie_techniques.pdf); this -1 is due to the fact that R^(-1) must be considered.
+        # 2) The poly class will check the values "a" above by zero. Only non-zero terms will be stored.
     return poly(values=a, dim=dim, max_power=fk.max_power)
 
     
-def fnf(*p, order: int=1, mode='quick', **kwargs):
+def fnf(*p, order: int=1, mode='conj', **kwargs):
     '''
     Obtain maps to Normal form for a given chain of Lie-operators. The concept
     is outlined in Sec. 4.4 in Ref. [1].
     
     Attention:
     I)
     First-order Lie-polynomials in the resulting Dragt/Finn expansion will be dropped.
@@ -59,54 +63,72 @@
         
     tol: float, optional
         A small number to identify polynomials which should be zero. Required in dragtfinn to
         identify if the two 2nd order polynomials can be combined.
         
     mode: str, optional
         Control the way of how the successive Taylor maps are computed:
-        'quick': The Taylor map of the next step (for the map M' = exp(:ak:) M exp(-:ak:)) is computed
-                 from the previous Taylor map by pull-back using the maps exp(:ak:) and exp(-:ak:).
-                 Note that if first-order elements in the Dragt/Finn factorization are detected,
-                 one TPSA calculation will be done for this interior part.
+        'conj': The Taylor map of the next step (for the map M' = exp(:ak:) M exp(-:ak:)) is computed
+                from the previous Taylor map by conjugation with the map exp(:ak:).
+                Note that if first-order elements in the Dragt/Finn factorization are detected,
+                one TPSA calculation will be done for this interior part.
         'tpsa': The Taylor map of the next step is computed by using TPSA on M'.
-                
+        
+    Returns
+    -------
+    dict
+        A dictionary containing the following keys:
+         'dragtfinn': The output of the Dragt/Finn factorization of the given Taylor map
+            'bnfout': The output of the Birkhoff normal form routine for order 1, used in the first step
+                      in the normalization.
+            'nf_all': A list X of lists, where each element E of X contains the Lie-polynomials n_j
+                      which represent one step in the normalization procedure according to Ref. [1], 
+                      Eq. (4.31). The last elements of X therefore yield the entire normalization.
+        'normalform': The last element of 'nf_all'.
+               'chi': The normalizing Lie-polynomials in ascending order. This means that
+                      "N = chi[::-1] o M o chi[::-1]**(-1)"
+                      is the normalized form of M (the lowest orders needs to be applied on M first).
+            'tm_all': A list of Taylor-maps which were used in each step in the normalization procedure,
+                      see the discussion in Ref. [1] around Eq. (4.31).
+        'taylor_map': The last element in 'tm_all'.               
         
     Reference(s)
     ------------
     [1] E. Forest: "Beam Dynamics - A New Attitude and Framework", harwood academic publishers (1998).
     '''
     #####################
     # Progress user input
     #####################
-    tol = kwargs.get('tol', 0)
+    tol = kwargs.pop('tol', 0)
     disable_tqdm = kwargs.get('disable_tqdm', False) # show progress bar (if requested) in the loop below
     kwargs['disable_tqdm'] = True # never show progress bars within the loop(s) itself
     
     # Compute the Dragt/Finn factorization up to a specific order
     kwargs['pos2'] = 'left'
     kwargs['comb2'] = True
-    df = dragtfinn(*p, order=order, **kwargs)
+    df = dragtfinn(*p, order=order, tol=tol, **kwargs)
 
     nterms_1 = [f for f in df if f.maxdeg() > 1]
     df_orders = [f.maxdeg() for f in nterms_1]
     
     # R^(-1) != 1, otherwise the normal form will be identical to the input
     if 2 not in df_orders:
         warnings.warn('No 2nd-order terms found => Normal form identical to input.')
         return {'dragtfinn': df, 'nterms': [nterms_1], 'chi': [], 'nmaps': [p]}
     
-    # If first-order elements in the Dragt/Finn factorization have been found, and the mode was 'quick',
+    # If first-order elements in the Dragt/Finn factorization have been found, and the mode is 'conj',
     # then we will re-calculate the tpsa map p for this inner part (& raise a warning):
-    kwargs['taylor_map'] = True
+    default_max_power = kwargs.get('max_power', min([f.max_power for f in df]))
     if len(nterms_1) < len(df):
         warnings.warn('Non-zero kicks detected. Will normalize only the interior.')
-        if mode == 'quick':
-            warnings.warn("mode == 'quick' with non-zero kicks. Performing TPSA for the interior ...")
-            tpsa_out = tpsa(*[lexp(a) for a in nterms_1], order=order, **kwargs)
-            p = tpsa_out['taylor_map']
+        if mode == 'conj':
+            warnings.warn(f"mode == '{mode}' with non-zero kicks. Performing TPSA for the interior ...")
+            position = [0]*df[0].dim*2
+            tpsa_out = tpsa(*[lexp(a) for a in nterms_1], order=order, position=position, **kwargs)
+            p = taylor_map(*tpsa_out._evaluation, max_power=default_max_power)
 
     ###############################
     # II) First-order normalization
     ###############################
     i1 = df_orders.index(2)
     i2 = len(df_orders) - 1 - df_orders[::-1].index(2)
     if i1 < i2:
@@ -155,38 +177,41 @@
     all_nmaps = [nmap]
     all_nterms = [nterms_1] # to collect the successive Dragt/Finn polynomials at each iteration step
     chi = [w.copy() for w in chi0s] # to collect the maps to normal form
     nterms_k = nterms_1 # 'Running' D/F-factorization
     for k in tqdm(range(3, order + 2), disable=disable_tqdm): # k will run up and including order + 1, because 'dragtfinn' for a specific order refers to the order of the Taylor map, and therefore produces a chain of Hamiltonians up and including order + 1.
         
         # find the term of order k in the current Dragt/Finn factorization
-        orders_k = [f.maxdeg() for f in nterms_k]
-        if k in orders_k:
-            fk = nterms_k[orders_k.index(k)]
-        else:
-            # Then fk = 0, so ak = 0 as well and we just continue (lexp(ak) = 1).
+        fk_all = [f for f in nterms_k if f.maxdeg() == k]
+        if len(fk_all) == 0:
+            # Then fk = 0, so ak = 0 as well, and we just continue (lexp(ak) = 1).
             continue
+        elif len(fk_all) == 1:
+            fk = fk_all[0]
+        else:
+            raise RuntimeError(f'More than one term in the Dragt/Finn factorization at order {k} found.')
         
         ak = _rot_kernel(fk, tunes)
         chi.append(ak)
 
-        if mode == 'quick':
+        if mode == 'conj':
             xietaf = lexp(ak)(*xieta, **kwargs)
             xietaf2 = lexp(-ak)(*xieta, **kwargs)
             final_coords = [coord(*xietaf) for coord in nmap]
             nmap = [ww(*final_coords) for ww in xietaf2]
         elif mode == 'tpsa':
             # This mode is experimental and may require the removal of small non-zero operators at each step to reduce errors.
-            operators = [lexp(ak)] + [lexp(f) for f in nterms_k] + [lexp(-ak)] # or [lexp(lexp(ak)(f, **kwargs)) for f in nterms_k], but first checks indicated that this may increase numerical errors           
-            tpsa_out = tpsa(*operators, order=order, **kwargs)
-            nmap = tpsa_out['taylor_map']
+            operators = [lexp(ak)] + [lexp(f) for f in nterms_k] + [lexp(-ak)] # or [lexp(lexp(ak)(f, **kwargs)) for f in nterms_k]
+            position = [0]*df[0].dim*2
+            tpsa_out = tpsa(*operators, order=order, position=position, **kwargs)
+            nmap = taylor_map(*tpsa_out._evaluation, max_power=default_max_power)
             
         all_nmaps.append(nmap)
 
-        nterms_k = dragtfinn(*nmap, order=order, **kwargs)
+        nterms_k = dragtfinn(*nmap, order=order, tol=tol, **kwargs)
         all_nterms.append(nterms_k)
         
     out = {}
     out['dragtfinn'] = df
     out['bnfout'] = nfdict
     out['nf_all'] = all_nterms
     out['normalform'] = all_nterms[-1]
```

### Comparing `lieops-0.2.1/lieops/core/.ipynb_checkpoints/hadamard-checkpoint.py` & `lieops-0.2.2/lieops/core/.ipynb_checkpoints/hadamard-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/.ipynb_checkpoints/lie-checkpoint.py` & `lieops-0.2.2/lieops/core/.ipynb_checkpoints/lie-checkpoint.py`

 * *Files 2% similar despite different names*

```diff
@@ -4,16 +4,14 @@
 
 from lieops.linalg.nf import first_order_nf_expansion
 
 from .generators import genexp
 from .combine import magnus
 from .poly import _poly
 
-from lieops.core.tools import symcheck
-
 from lieops.solver import get_2flow, channell, heyoka
 from lieops.solver.splitting import recursive_monomial_split
 from lieops.solver.bruteforce import calcFlow as BFcalcFlow
 
 import lieops.core.tools
 import lieops.core.birkhoff
 
@@ -44,15 +42,15 @@
         -------
         lieoperator
             Class of type lieoperator, modeling the flow of the current Lie polynomial.
         '''
         kwargs['max_power'] = kwargs.get('max_power', self.max_power)
         return lexp(self, *args, **kwargs)
     
-    def bnf(self, order: int=1, power=10, **kwargs):
+    def bnf(self, order: int=1, **kwargs):
         '''
         Compute the Birkhoff normal form of the current Lie exponential operator.
         
         Example
         ------- 
         nf = self.bnf()
         echi1 = nf['chi'][0].flow(t=1) # exp(:chi1:)
@@ -67,15 +65,15 @@
         order: int, optional
             Order up to which the normal form should be computed.
             
         **kwargs
             Optional arguments passed to 'lieops.core.birkhoff.bnf' routine.
         '''
         kwargs['max_power'] = kwargs.get('max_power', self.max_power)
-        return lieops.core.birkhoff.bnf(self, order=order, power=power, n_args=self.dim*2, **kwargs)
+        return lieops.core.birkhoff.bnf(self, order=order, n_args=self.dim*2, **kwargs)
     
     def calcFlow(self, *args, **kwargs):
         '''
         Compute the flow of the current Lie polynomial. Shortcut for self.lexp and then calcFlow on
         the respective object.
         
         Parameters
@@ -269,14 +267,15 @@
             
         **kwargs
             Optional arguments passed to flow subroutines.
         '''
         self._flow_method = kwargs.get('method', self._flow_method)
         update = self._update_flow_parameters(**kwargs)
         if update or not self._flow_method in self._flow.keys():
+            _ = kwargs.pop('method', None) # do not pass the keyword 'method' to the underlying flow input parameters
             self._calcFlowFromParameters(**kwargs)
         # set the current flow function to the requested method.
         self.flow = self._flow[self._flow_method]['flow'] 
         
     def _calcFlowFromParameters(self, **kwargs):
         if self._flow_method == 'bruteforce':
             flow_parameters = self.get_flow_parameters()
@@ -389,15 +388,24 @@
             if kwargs.get('warn', False):
                 warnings.warn('No order provided for TPSA calculation. Attempting to set order based on max_power ...')
             assert self.argument.max_power < np.inf, f'max_power of {self.__class__.__name__}.argument can not be infinite.'
             order = self.argument.max_power + 1 # TODO: check if this is sufficient; see the comment in lieops.core.poly._poly concerning max_power
         kwargs['order'] = order
         
         # 2. Run TPSA
-        return lieops.core.tools.tpsa(self, position=position, **kwargs)
+        self._tpsa = lieops.core.tools.tpsa(self, position=position, **kwargs)
+        return self._tpsa
+    
+    def taylor_map(self, **kwargs):
+        '''
+        Return the Taylor map from a given TPSA evaluation, using the
+        dimensionn and max_power of the current Lie-operator.
+        '''
+        assert hasattr(self, '_tpsa'), 'TPSA calculation required in advance.'
+        return lieops.core.tools.taylor_map(*self._tpsa._evaluation, dim=self.argument.dim, max_power=kwargs.get('max_power', self.argument.max_power))
 
     
 class lexp(lieoperator):
     
     def __init__(self, argument, *args, **kwargs):
         '''
         Class to describe Lie operators of the form
@@ -628,19 +636,20 @@
             parameters = self._flow_parameters[method]
             assert 'components' in parameters.keys()
             
             if 'xietaf' in flow_out.keys():
                 xietaf = flow_out['xietaf']
             elif 'flow' in flow_out.keys():
                 # compute the final xi/eta-coordinates from the bare flow function, using TPSA
-                kwargs['taylor_map'] = True
-                tpsa_out = self.tpsa(**kwargs)
-                xietaf = tpsa_out['taylor_map'] # TODO: check if components = xieta (otherwise xietaf is misleading description).
+                zero = (0,)*self.argument.dim*2
+                dchain = self.tpsa(*zero, **kwargs)
+                xietaf = self.taylor_map()
+                # TODO: check if components = xieta (otherwise xietaf is misleading description).
                 flow_out['xietaf'] = xietaf
-                flow_out['dflow'] = tpsa_out['DA']
+                flow_out['dflow'] = dchain
                 self._flow[method].update(flow_out)
             else:
                 raise RuntimeError(f"No result(s) field present for method '{method}'.")
             # Compute the result by pullback: exp(:f:)Q(xi_1, ..., eta_n) = Q(exp(:f:) xi_1, ..., exp(:f:)eta_n) holds:
             final_components = [c(*xietaf) for c in parameters['components']]
             self._flow[method]['taylor_map'] = final_components
             return final_components
@@ -648,24 +657,25 @@
             return lieoperator._calcPolyFromFlow(self, **kwargs)
     
     def __call__(self, *z, **kwargs):
         if isinstance(z[0], type(self)):
             return self.bch(*z, **kwargs) # Baker-Campbell-Hausdorff (using Magnus/combine routine)
         else:
             return lieoperator.__call__(self, *z, **kwargs)
-        
-    def tpsa(self, *args, **kwargs):
+
+    def taylor_map(self, tol=0, **kwargs):
         '''
-        See lieops.core.tools.tpsa for a description.
+        Return the Taylor map from a given TPSA evaluation, using the
+        dimensionn and max_power of the current Lie-operator.
+        
+        Moreover, perform a symplecticity check if a tolerance is given.
         
         Parameters
-        ----------        
+        ----------
         tol: float, optional
-            If > 0, perform a check on symplecticity of the map.
-        '''
-        tol = kwargs.get('tol', 0)
-        tpsa_out = lieoperator.tpsa(self, *args, **kwargs)
-        if tol > 0 and 'taylor_map' in tpsa_out.keys(): # check if map is symplectic
-            _ = symcheck(tpsa_out['taylor_map'], tol=tol)
-        return tpsa_out
-
-
+            If > 0, perform a symplecticity check on the results.
+        '''        
+        tm = lieoperator.taylor_map(self, **kwargs)
+        if tol > 0:
+            _ = lieops.core.tools.symcheck(tm, tol=tol)
+        return tm
+
```

### Comparing `lieops-0.2.1/lieops/core/.ipynb_checkpoints/poly-checkpoint.py` & `lieops-0.2.2/lieops/core/.ipynb_checkpoints/poly-checkpoint.py`

 * *Files 2% similar despite different names*

```diff
@@ -179,15 +179,21 @@
             
         Returns
         -------
         poly
             A polynomial having the same keys/values as the current polynomial, but the absolute values are larger
             than the requested threshold.
         '''
-        return self.extract(value_cond=lambda x: abs(x) > tol)
+        def value_cond(x):
+            result = abs(x) > tol
+            if not hasattr(result, '__iter__'):
+                return result
+            else:
+                return result.all() # assuming a numpy array
+        return self.extract(value_cond=value_cond)
     
     def below(self, tol: float):
         '''
         Drop values above a given threshold.
         
         Parameters
         ----------
@@ -196,45 +202,58 @@
             
         Returns
         -------
         poly
             A polynomial having the same keys/values as the current polynomial, but the absolute values are smaller
             than the requested threshold.
         '''
-        return self.extract(value_cond=lambda x: abs(x) < tol)
+        def value_cond(x):
+            result = abs(x) < tol
+            if not hasattr(result, '__iter__'):
+                return result
+            else:
+                return result.all() # assuming a numpy array
+        return self.extract(value_cond=value_cond)
     
     def monomials(self):
         '''
         Return a list of the monomials of the current polynomial.
         '''
         return [self.__class__(values={k: v}, dim=self.dim, max_power=self.max_power) for k, v in self.items()]
     
     def truncate(self, k):
         '''
         Truncate the current polynomial with respect to a total power.
         '''
         return self.extract(key_cond=lambda x: sum(x) <= k)
+    
+    def _prepare_input(self, *z):
+        '''
+        Consistency check & input preparation prior to evaluation.
+        '''
+        if len(z) == self.dim and self._poisson_factor == -1j:
+            # for xi/eta-variables we conveniently conjugate the remaining components if they are not explicitly given
+            z = [e for e in z] + [e.conjugate() for e in z]
+        dim2 = self.dim*2
+        assert len(z) == dim2, f'Number of input parameters: {len(z)}, expected: {dim2} (or {self.dim})'
+        return z
         
     def __call__(self, *z):
         '''
         Evaluate the polynomial at a specific position z.
         
         Parameters
         ----------
         z: subscriptable
             The point at which the polynomial should be evaluated. It is assumed that len(z) == self.dim,
             in which case the components of z are assumed to be xi-values. Otherwise, it is assumed that len(z) == 2*self.dim,
             where z = (xi, eta) denote a set of complex conjugated coordinates.
         '''        
         # prepare input vector
-        if len(z) == self.dim and self._poisson_factor == -1j:
-            # for xi/eta-variables we conveniently conjugate the remaining components if they are not explicitly given
-            z = [e for e in z] + [e.conjugate() for e in z]
-        dim2 = self.dim*2
-        assert len(z) == dim2, f'Number of input parameters: {len(z)}, expected: {dim2} (or {self.dim})'
+        z = self._prepare_input(*z)
         
         # compute the occuring powers ahead of evaluation
         z_powers = {}
         j = 0
         for we in zip(*self.keys()):
             z_powers[j] = {k: z[j]**int(k) for k in np.unique(we)} # need to convert k to int, 
             # otherwise we get a conversion to some numpy array if z is not a float (e.g. an njet).
@@ -252,15 +271,15 @@
             for j in range(self.dim):
                 prod *= z_powers[j][k[j]]*z_powers[j + self.dim][k[j + self.dim]]
             result += prod*v # v needs to stay on the right-hand side here, because prod may be a jet class (if we compute the derivative(s) of the Lie polynomial)
             
         return result
         
     def __add__(self, other):
-        if other == 0:
+        if check_zero(other):
             return self
         add_values = {k: v for k, v in self.items()}
         if not isinstance(self, type(other)):
             # Treat other object as constant.
             zero_tpl = (0,)*self.dim*2
             add_values[zero_tpl] = add_values.get(zero_tpl, 0) + other
             max_power = self.max_power
@@ -598,37 +617,37 @@
         '''
         if len(cargs) > 0:
             out = {key: getattr(v, name)(*args, **cargs[key]) for key, v in self.items()}
         else:
             out = {key: getattr(v, name)(*args, **kwargs) for key, v in self.items()}
         return self.__class__(values=out, dim=self.dim, max_power=self.max_power)
     
-    def realBasis(self, **kwargs):
+    def realBasis(self):
         '''
         Note that it holds xi = (q + 1j*p)/sqrt2, eta = (q - 1j*p)/sqrt2.
         '''
         sqrt2 = float(np.sqrt(2))
         def trf(q, p):
             xi = (q + p*1j)/sqrt2
             eta = (q - p*1j)/sqrt2 # = xi.conjugate()
             return xi, eta
-        return self.transform(trf=trf, poisson_factor=1, **kwargs)
+        return self.transform(trf=trf, poisson_factor=1)
         
-    def complexBasis(self, **kwargs):
+    def complexBasis(self):
         '''
         Note that it holds xi = (q + 1j*p)/sqrt2, eta = (q - 1j*p)/sqrt2.
         '''
         sqrt2 = float(np.sqrt(2))
         def trf(xi, eta):
             q = (xi + eta)/sqrt2
             p = (xi - eta)/sqrt2/1j
             return q, p
-        return self.transform(trf=trf, poisson_factor=-1j, **kwargs)
+        return self.transform(trf=trf, poisson_factor=-1j)
         
-    def transform(self, trf, poisson_factor, mult_drv=False, mult_prm=False, **kwargs):
+    def transform(self, trf, poisson_factor, mult_drv=False, mult_prm=False):
         '''
         Cast the current polynomial into a different form.
         
         Parameters
         ----------
         trf: callable
             A linear transformation mapping a pair of new variables q2, p2 to original variables q1, p1.
@@ -639,21 +658,18 @@
         1 = {q1, p1}_{q1, p1} and -1j = {q1, p1}_{xi, eta}. Therefore, if transforming from q/p to xi/eta,
         the poisson factor f has to be -1j.
         
         At the moment only 2d transformations are supported; more sophisticated transformations require
         some overwork in the poisson bracket routine self.__matmul__.
         
         mult_drv: boolean, optional
-            Control of factorial and permutation coefficients. See njet.poly.jetpoly.get_taylor_coefficients for details.
+            Control of factorial and permutation coefficients. See njet.poly.jetpoly.taylor_coefficients for details.
             
         mult_prm: boolean, optional
-            Control of factorial and permutation coefficients. See njet.poly.jetpoly.get_taylor_coefficients for details.
-            
-        **kwargs
-            Arguments passed to self.__class__.
+            Control of factorial and permutation coefficients. See njet.poly.jetpoly.taylor_coefficients for details.
 
         Returns
         -------
         dict
             The coefficients of the polynomial with respect to the real q and p coordinates.
             The keys correspond to the powers with respect to (q_1, ..., q_dim, p1, ..., p_dim).
         ''' 
@@ -667,17 +683,17 @@
             q2k, p2k = trf(qk, pk)
             q2.append(q2k)
             p2.append(p2k)
         h1 = self(*(q2 + p2))
         if h1 == 0:
             rbv = {(0,)*self.dim*2: 0}
         else:
-            rbv = h1.get_taylor_coefficients(2*self.dim, facts=factorials(self.maxdeg()), 
+            rbv = h1.taylor_coefficients(2*self.dim, facts=factorials(self.maxdeg()), 
                                           mult_drv=mult_drv, mult_prm=mult_prm)
-        return self.__class__(values=rbv, poisson_factor=poisson_factor)
+        return self.__class__(values=rbv, poisson_factor=poisson_factor, max_power=self.max_power)
     
     def split(self, keys, scheme, check=False, **kwargs):
         '''
         Split the Hamiltonian with respect to a set of keys. 
         Return a list of polynomials according to the requested number of slices and the splitting.
         
         Parameters
```

### Comparing `lieops-0.2.1/lieops/core/.ipynb_checkpoints/tools-checkpoint.py` & `lieops-0.2.2/lieops/core/.ipynb_checkpoints/tools-checkpoint.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,12 +1,13 @@
 # collection of specialized tools operating on polynomials
 import numpy as np
 import warnings
 
-from njet import derive, get_taylor_coefficients
+from njet import derive, taylor_coefficients
+from njet.extras import cderive
 
 import lieops.core.lie
 from lieops.linalg.matrix import create_J
 
 def poly2ad(pin):
     '''
     Compute a (2n)x(2n)-matrix representation of a homogenous second-order polynomial A,
@@ -30,39 +31,48 @@
     array-like
         A complex matrix corresponding to the representation.
     '''
     assert pin.maxdeg() == 2 and pin.mindeg() == 2
     dim = pin.dim
     dim2 = dim*2
     poisson_factor = pin._poisson_factor
-    A = np.zeros([dim2, dim2], dtype=np.complex128)
+    
+    # Determine shape of input values
+    val0 = next(iter(pin))
+    if hasattr(val0, 'shape'):
+        A = np.zeros([dim2, dim2] + list(val0.shape), dtype=np.complex128)
+        zero = np.zeros(val0.shape)
+    else:
+        A = np.zeros([dim2, dim2], dtype=np.complex128)
+        zero = 0
+    
     for i in range(dim):
         for j in range(dim):
             mixed_key = [0]*dim2 # key belonging to xi_i*eta_j
             mixed_key[i] += 1
             mixed_key[j + dim] += 1
-            A[i, j] = pin.get(tuple(mixed_key), 0)*-poisson_factor
-            A[j + dim, i + dim] = pin.get(tuple(mixed_key), 0)*poisson_factor
+            A[i, j, ...] = pin.get(tuple(mixed_key), zero)*-poisson_factor
+            A[j + dim, i + dim, ...] = pin.get(tuple(mixed_key), zero)*poisson_factor
             
             if i != j: # if i and j are different, than the key in the polynomial already
                 # corresponds to the sum of the ij and the ji-coefficient. But if they are equal,
                 # then the values has to be multiplied by 2, because we have to use the ij + ji-components.
                 ff = 1
             else:
                 ff = 2
                 
             hom_key_xi = [0]*dim2 # key belonging to xi_i*xi_j
             hom_key_xi[i] += 1
             hom_key_xi[j] += 1
-            A[i, j + dim] = pin.get(tuple(hom_key_xi), 0)*poisson_factor*ff
+            A[i, j + dim, ...] = pin.get(tuple(hom_key_xi), zero)*poisson_factor*ff
 
             hom_key_eta = [0]*dim2 # key belonging to eta_i*eta_j
             hom_key_eta[i + dim] += 1
             hom_key_eta[j + dim] += 1
-            A[i + dim, j] = pin.get(tuple(hom_key_eta), 0)*-poisson_factor*ff
+            A[i + dim, j, ...] = pin.get(tuple(hom_key_eta), zero)*-poisson_factor*ff
     return A
 
 def ad2poly(A, tol=0, poisson_factor=-1j, **kwargs):
     '''
     Transform a complex (2n)x(2n)-matrix representation of a polynomial back to 
     its polynomial xi/eta-representation. This is the inverse of the 'poly2ad' routine.
     
@@ -103,17 +113,17 @@
             if tol > 0:
                 # Check if the given matrix is an element of sp(2n; C). If this check fails,
                 # no valid polynomial representation can be obtained.
                 error_msg = f'{A}\nMatrix not in sp(2n; C), the Lie-algebra of complex symplectic matrices (tol: {tol}).'
                 c1 = abs(A[i, j] + A[j + dim, i + dim])
                 c2 = abs(A[i, j + dim] - A[j, i + dim])
                 c3 = abs(A[i + dim, j] - A[j + dim, i])
-                assert c1 < tol, error_msg + f'({c1}).'
-                assert c2 < tol, error_msg + f'({c2}).'
-                assert c3 < tol, error_msg + f'({c3}).'
+                assert (c1 < tol).all(), error_msg + f'({c1}).'
+                assert (c2 < tol).all(), error_msg + f'({c2}).'
+                assert (c3 < tol).all(), error_msg + f'({c3}).'
             
             mixed_key = [0]*dim2 # key belonging to a coefficient of mixed xi/eta variables.
             mixed_key[i] += 1
             mixed_key[j + dim] += 1            
             values[tuple(mixed_key)] = A[i, j]*-1/poisson_factor
             
             # The factor 'ff' comes from the fact that the poly objects terms of the form xi_i*xi_j (for i != j) and xi_j*xi_i are equal.
@@ -136,19 +146,28 @@
 def poly2vec(p):
     '''
     Map a first-order polynomial to its respective vector in matrix representation 
     (see also 'poly2ad' routine)
     '''
     assert p.maxdeg() == 1 and p.mindeg() == 1
     dim = p.dim
-    out = np.zeros(dim*2, dtype=np.complex128)
+    
+    # Determine the shape of the zeros to be filled:
+    v0 = next(iter(p))
+    if hasattr(v0, 'shape'):
+        zeros = np.zeros(v0.shape, dtype=np.complex128)
+    else:
+        zeros = 0
+        
+    out = [zeros]*dim*2
     for k, v in p.items():
         j = list(k).index(1)
         out[j] = v
-    return out
+        
+    return np.array(out, dtype=np.complex128)
 
 def vec2poly(v):
     '''
     The inverse of 'poly2vec' routine.
     '''
     dim2 = len(v)
     assert dim2%2 == 0, 'Dimension must be even.'
@@ -175,31 +194,39 @@
     array-like
         A complex matrix corresponding to the representation.
     '''
     assert pin.maxdeg() <= 2 and pin.mindeg() >= 1 # Regarding the second condition: Constants have no effect as 'ad' and therefore 'ad' can not be inverted. Since we want poly3ad to be invertible, we have to restrict to polynomials without such constant terms.
     dim = pin.dim
     dim2 = dim*2
     poisson_factor = pin._poisson_factor
-    # extended space: (xi/eta)-phase space + constants.
-    pmat = np.zeros([dim2 + 1, dim2 + 1], dtype=np.complex128) 
+    
+    # Determine shape of input values; extended space: (xi/eta)-phase space + constants.
+    val0 = next(iter(pin))
+    if hasattr(val0, 'shape'):
+        pmat = np.zeros([dim2 + 1, dim2 + 1] + list(val0.shape), dtype=np.complex128)
+        zero = np.zeros(val0.shape)
+    else:
+        pmat = np.zeros([dim2 + 1, dim2 + 1], dtype=np.complex128)
+        zero = 0
+        
     # 1. Add the representation with respect to 2x2-matrices:
     pin2 = pin.homogeneous_part(2)
     if len(pin2) != 0:
-        pmat[:dim2, :dim2] = poly2ad(pin2)
+        pmat[:dim2, :dim2, ...] = poly2ad(pin2)
     # 2. Add the representation with respect to the scalar:
     pin1 = pin.homogeneous_part(1)
     if len(pin1) != 0:
         for k in range(dim):
             xi_key = [0]*dim2
             xi_key[k] = 1
-            pmat[dim2, k + dim] = pin1.get(tuple(xi_key), 0)*poisson_factor
+            pmat[dim2, k + dim, ...] = pin1.get(tuple(xi_key), zero)*poisson_factor
 
             eta_key = [0]*dim2
             eta_key[k + dim] = 1
-            pmat[dim2, k] = pin1.get(tuple(eta_key), 0)*-poisson_factor
+            pmat[dim2, k, ...] = pin1.get(tuple(eta_key), zero)*-poisson_factor
     return pmat
 
 def ad3poly(A, **kwargs):
     '''
     The inverse of the 'poly3ad' routine.
     '''
     assert A.shape[0] == A.shape[1]
@@ -240,22 +267,22 @@
     p1 = vec2poly(vec[:-1], **kwargs)
     p1[(0,)*n2] = vec[-1]
     return p1
 
 def const2poly(*const, poisson_factor=-1j, **kwargs):
     '''
     Let c_1, ..., c_{2n} be constants. Then compute a first-order polynomial g_1
-    so that {g_1, z_j} = z_j + c_j holds.
+    so that {g_1, z_j} = z_j + c_j holds, where the z_j are canonical coordinates.
     '''
     dim2 = len(const)
     assert dim2%2 == 0, 'Dimension must be even.'
     dim = dim2//2
     J = create_J(dim)
-    xieta = lieops.core.lie.create_coords(dim, poisson_factor=poisson_factor, **kwargs)
-    return sum([xieta[k]*(J@const)[k] for k in range(dim2)])/poisson_factor
+    xieta = lieops.core.lie.create_coords(dim, poisson_factor=poisson_factor, **kwargs)    
+    return sum([xieta[k]*(np.tensordot(J, const, axes=(1, 0)))[k] for k in range(dim2)])/poisson_factor
 
 def poly2const(p1):
     '''
     The inverse of the 'const2poly' routine.
     '''
     assert p1.mindeg() == 1 and p1.maxdeg() == 1
     xieta = lieops.core.lie.create_coords(p1.dim, poisson_factor=p1._poisson_factor, max_power=p1.max_power)
@@ -286,15 +313,15 @@
     poly
         The poly object {X, C} (or {f(X), C}, if a function has been provided).
     '''
     assert len(mu) == C.dim
     return lieops.core.lie.poly(values={powers: v*func(sum([(powers[k] - powers[k + C.dim])*mu[k] for k in range(C.dim)])*1j) for powers, v in C.items()}, 
                 dim=C.dim, max_power=C.max_power)
 
-def get_taylor_map(*evaluation, **kwargs):
+def taylor_map(*evaluation, **kwargs):
     '''
     Obtain the Taylor map from a given jet evaluation in terms of lieops.core.lie.poly objects.
     
     Parameters
     ----------
     evaluation(s):
         n-jet objects containing polyjet objects.
@@ -311,74 +338,89 @@
         
     Returns
     -------
     list
         A list of poly objects, representing the Taylor map.
     '''
     n_args = kwargs.get('dim2', len(evaluation))
-    tc = get_taylor_coefficients(evaluation, mult_prm=True, mult_drv=False, n_args=n_args, output_format=1)
+    tc = taylor_coefficients(evaluation, mult_prm=True, mult_drv=False, n_args=n_args, output_format=1)
     return [lieops.core.lie.poly(values=e, **kwargs) for e in tc]
 
-def tpsa(*ops, position=[], order: int, taylor_map=False, **kwargs):
+def tpsa(*ops, position=[], ordering=None, mode='auto', **kwargs):
     '''
-    Pass n-jets through the flow functions of a chain of Lie-operators.
+    Pass n-jets through the flow functions of a chain of Lie-operators
+    to compute the result for every cycle.
 
     Parameters
     ----------
     *ops: lieoperator(s)
         An operator or a list of operators which should be derived. In case a list
-        is given, the first element of the list will be called first.
+        is given, the first element of the list will be processed first.
     
-    position: list
-        An optional point of reference. By default the position will be the origin.
-
     order: int
-        The number of derivatives we want to take into account.
-        
-    taylor_map: boolean, optional
-        If true, also compute the taylor map.
+        The number of derivatives which should be taken into account.
+
+    position: list, optional
+        An optional point of reference. If nothing specified, no evaluation of the
+        internal 'derive' (or 'cderive') object will be made. Otherwise, a
+        jet-evaluation at the requested position will be made.
+        
+    ordering: list, optional
+        A list defining an optinonal ordering of the operators. See njet.extras.cderive for
+        details. If nothing provided, the ordering from the given operators is used and
+        an njet.derive object will be used instead.
+        
+    mode: str, optional
+        Control the type of output.
+        'default': return an object of type njet.derive. 
+          'chain': Return an object of type njet.extras.cderive.
+           'auto': Select the result based on the number of unique elements in the given chain.
 
     **kwargs
-        Optional keyworded arguments passed to njet.derive class (and therefore the underlying
-        operators of this beamline).
+        Optional keyworded arguments passed to njet.extras.cderive or njet.derive class.
         
     Returns
     -------
-    dict
-        A dictionary containing the results of the TPSA run.
-                DA: njet derive object, containing the jet evaluation results.
-             input: The input parameters used.
-        taylor_map: (Only if taylor_map == True) A list of poly objects, representing the Taylor map of 
-                    the given operators at 'position'.
+    derive or cderive
+        An njet.derive or njet.extras.cderive object, containing the results of the TPSA calculation,
+        depending on the 'mode' parameter.
     '''
     assert len(ops) > 0, 'No operator provided.'
     dim = ops[0].argument.dim
     assert all([op.argument.dim == dim for op in ops]), 'Not all operator dimensions are equal.'
     n_args = dim*2
+    assert 'order' in kwargs.keys()
+    order = kwargs.pop('order')
     
-    def chain(*z, **kwargs1):
-        for op in ops:
-            z = op(*z, **kwargs1)
-        return z
-    
-    dchain = derive(chain, n_args=n_args, order=order)
-    if len(position) == 0:
-        position = (0,)*n_args
-    dchain.eval(*position, **kwargs) # N.B. the plain jet output is stored in dchain._evaluation. From here one can use ".get_taylor_coefficients" with other parameters -- if desired -- or re-use the jets for further processing.
-    out = {}
-    out['DA'] = dchain # chain = dchain.func
-    out['input'] = kwargs.copy()
-    out['input']['position'] = position
-    out['input']['taylor_map'] = taylor_map
-    out['input']['order'] = order
-
-    if taylor_map:
-        out['taylor_map'] = get_taylor_map(*dchain._evaluation, dim=dim, max_power=kwargs.get('max_power', order))
-        
-    return out
+    if mode == 'auto':
+        mode = 'default'
+        if ordering is not None:
+            # A direct derivative might be faster if the length of the unique elements
+            # in the chain equals the given ordering. The cderive class probes the chain 
+            # first and so it may produce a calculation overhead.
+            if len(ordering) > len(ops):
+                mode = 'chain'
+    
+    if mode == 'default':
+        if ordering is None:
+            ordering = range(len(ops))
+            
+        def chain(*z, **kwargs1):
+            for k in range(len(ordering)):
+                z = ops[ordering[k]](*z, **kwargs1)
+            return z
+        dchain = derive(chain, n_args=n_args, order=order)
+    elif mode == 'chain':
+        dchain = cderive(*ops, n_args=n_args, order=order, ordering=ordering)
+    else:
+        raise RuntimeError(f"Output format '{mode}' not recognized.")
+
+    if len(position) > 0:
+        _ = dchain.eval(*position, **kwargs) # N.B. the plain jet output is stored in dchain._evaluation. From here one can use ".taylor_coefficients" with other parameters -- if desired -- or re-use the jets for further processing.
+    return dchain
 
 def symcheck(p, tol, warn=True):
     '''
     Check whether a given Taylor map, described as a set of Lie-polynomials, describes a symplectomorphism.
     
     Parameters
     ----------
@@ -416,14 +458,14 @@
                 # The reason is that if N denotes the maximal power up to which our checks should run,
                 # then N = k + l - 2 for the two components of max order k and l. The smallest non-trivial
                 # power has k = 1, leading to N = l - 1. So the maximal order N of the check 
                 # can not exceed l - 1, where l is the maximal order of the map which we have determined. 
                 check_order = abs(check.homogeneous_part(order))
                 if len(check_order) == 0:
                     continue
-                max_error = max(check_order)
+                max_error = np.amax(list(check_order.values()))
                 if max_error > tol:
                     result[order] = max([result.get(order, 0), max_error])
                     if warn:
                         warnings.warn(f'Taylor map non-symplectic at order {order} for components {(k, l)}. Error: {max_error} (tol: {tol})')
                         
     return result
```

### Comparing `lieops-0.2.1/lieops/core/__pycache__/birkhoff.cpython-310.pyc` & `lieops-0.2.2/lieops/core/__pycache__/birkhoff.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.10, timestamp-based, .py timestamp: Thu Feb 16 10:56:49 2023 UTC, .py size: 9679 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 14% similar despite different names*

```diff
@@ -1,422 +1,442 @@
-00000000: 6f0d 0d0a 0000 0000 f10b ee63 cf25 0000  o..........c.%..
+00000000: 6f0d 0d0a 0000 0000 2851 3e64 3727 0000  o.......(Q>d7'..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0004 0000 0040 0000 0073 4800 0000 6400  .....@...sH...d.
+00000020: 0004 0000 0040 0000 0073 5400 0000 6400  .....@...sT...d.
 00000030: 6401 6c00 5a01 6400 6402 6c02 6d03 5a03  d.l.Z.d.d.l.m.Z.
 00000040: 0100 6400 6403 6c04 6d05 5a05 0100 6400  ..d.d.l.m.Z...d.
-00000050: 6404 6c06 6d07 5a07 0100 6405 6406 8400  d.l.m.Z...d.d...
-00000060: 5a08 640d 640a 6509 6602 640b 640c 8405  Z.d.d.e.f.d.d...
-00000070: 5a0a 6401 5300 290e e900 0000 004e 2901  Z.d.S.)......N).
-00000080: da17 6765 7452 6561 6c48 616d 696c 746f  ..getRealHamilto
-00000090: 6e46 756e 6374 696f 6e29 01da 1866 6972  nFunction)...fir
-000000a0: 7374 5f6f 7264 6572 5f6e 665f 6578 7061  st_order_nf_expa
-000000b0: 6e73 696f 6e29 01da 0761 6432 706f 6c79  nsion)...ad2poly
-000000c0: 6302 0000 0000 0000 0000 0000 0007 0000  c...............
-000000d0: 0006 0000 000b 0000 0073 9800 0000 7400  .........s....t.
-000000e0: 6a01 6a02 6a03 6407 6900 8800 6a04 6401  j.j.j.d.i...j.d.
-000000f0: 9c02 7c02 a401 8e01 7400 6a01 6a02 6a03  ..|.....t.j.j.j.
-00000100: 6407 6900 8800 6a04 6401 9c02 7c02 a401  d.i...j.d...|...
-00000110: 8e01 0202 7d03 7d04 8800 a005 a100 4400  ....}.}.......D.
-00000120: 5d26 5c02 8902 7d05 7406 8700 8701 8702  ]&\...}.t.......
-00000130: 6603 6402 6403 8408 7407 7408 8801 8301  f.d.d...t.t.....
-00000140: 8301 4400 8301 8301 7d06 7c06 6404 6b03  ..D.....}.|.d.k.
-00000150: 7243 6405 7c06 1b00 7c05 1400 7c03 8802  rCd.|...|...|...
-00000160: 3c00 7121 7c05 7c04 8802 3c00 7121 7c03  <.q!|.|...<.q!|.
-00000170: 7c04 6602 5300 2908 61f3 0200 000a 2020  |.f.S.).a.....  
-00000180: 2020 4c65 7420 655b 6b5d 2c20 6b20 3d20    Let e[k], k = 
-00000190: 312c 202e 2e2e 2c20 6c65 6e28 6d75 2920  1, ..., len(mu) 
-000001a0: 6265 2061 6374 696f 6e73 2c20 4830 203a  be actions, H0 :
-000001b0: 3d20 7375 6d5f 6b20 6d75 5b6b 5d2a 655b  = sum_k mu[k]*e[
-000001c0: 6b5d 2061 6e64 205a 2061 0a20 2020 2070  k] and Z a.    p
-000001d0: 6f6c 796e 6f6d 6961 6c20 6f66 2064 6567  olynomial of deg
-000001e0: 7265 6520 6e2e 2054 6865 6e20 7468 6973  ree n. Then this
-000001f0: 2072 6f75 7469 6e65 2077 696c 6c20 736f   routine will so
-00000200: 6c76 6520 0a20 2020 2074 6865 2068 6f6d  lve .    the hom
-00000210: 6f6c 6f67 6963 616c 2065 7175 6174 696f  ological equatio
-00000220: 6e20 0a20 2020 207b 4830 2c20 6368 697d  n .    {H0, chi}
-00000230: 202b 205a 203d 2051 2077 6974 680a 2020   + Z = Q with.  
-00000240: 2020 7b48 302c 2051 7d20 3d20 302e 0a0a    {H0, Q} = 0...
-00000250: 2020 2020 4174 7465 6e74 696f 6e3a 204e      Attention: N
-00000260: 6f20 6368 6563 6b20 7768 6574 6865 7220  o check whether 
-00000270: 5a20 6973 2061 6374 7561 6c6c 7920 686f  Z is actually ho
-00000280: 6d6f 6765 6e65 6f75 7320 6f72 2072 6561  mogeneous or rea
-00000290: 6c2c 2062 7574 2069 6620 6f6e 6520 6f66  l, but if one of
-000002a0: 0a20 2020 2074 6865 7365 2070 726f 7065  .    these prope
-000002b0: 7274 6965 7320 686f 6c64 2c20 7468 656e  rties hold, then
-000002c0: 2061 6c73 6f20 6368 6920 616e 6420 5120   also chi and Q 
-000002d0: 7769 6c6c 2061 646d 6974 2073 7563 6820  will admit such 
-000002e0: 7072 6f70 6572 7469 6573 2e0a 2020 2020  properties..    
-000002f0: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
-00000300: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00000310: 2020 206d 753a 206c 6973 740a 2020 2020     mu: list.    
-00000320: 2020 2020 6c69 7374 206f 6620 666c 6f61      list of floa
-00000330: 7473 2028 7475 6e65 7329 2e0a 2020 2020  ts (tunes)..    
-00000340: 2020 2020 0a20 2020 205a 3a20 706f 6c79      .    Z: poly
-00000350: 0a20 2020 2020 2020 2050 6f6c 796e 6f6d  .        Polynom
-00000360: 6961 6c20 6f66 2064 6567 7265 6520 6e2e  ial of degree n.
-00000370: 0a20 2020 2020 2020 200a 2020 2020 2a2a  .        .    **
-00000380: 6b77 6172 6773 0a20 2020 2020 2020 2041  kwargs.        A
-00000390: 7267 756d 656e 7473 2070 6173 7365 6420  rguments passed 
-000003a0: 746f 2070 6f6c 7920 696e 6974 6961 6c69  to poly initiali
-000003b0: 7a61 7469 6f6e 2e0a 2020 2020 2020 2020  zation..        
-000003c0: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
-000003d0: 202d 2d2d 2d2d 2d2d 0a20 2020 2063 6869   -------.    chi
-000003e0: 3a20 706f 6c79 0a20 2020 2020 2020 2050  : poly.        P
-000003f0: 6f6c 796e 6f6d 6961 6c20 6f66 2064 6567  olynomial of deg
-00000400: 7265 6520 6e20 7769 7468 2074 6865 2061  ree n with the a
-00000410: 626f 7665 2070 726f 7065 7274 792e 0a20  bove property.. 
-00000420: 2020 2020 2020 200a 2020 2020 513a 2070         .    Q: p
-00000430: 6f6c 790a 2020 2020 2020 2020 506f 6c79  oly.        Poly
-00000440: 6e6f 6d69 616c 206f 6620 6465 6772 6565  nomial of degree
-00000450: 206e 2077 6974 6820 7468 6520 6162 6f76   n with the abov
-00000460: 6520 7072 6f70 6572 7479 2e0a 2020 2020  e property..    
-00000470: 2902 da06 7661 6c75 6573 da03 6469 6d63  )...values..dimc
-00000480: 0100 0000 0000 0000 0000 0000 0200 0000  ................
-00000490: 0600 0000 1300 0000 732a 0000 0067 007c  ........s*...g.|
-000004a0: 005d 117d 0188 027c 0119 0088 0288 006a  .].}...|.......j
-000004b0: 007c 0117 0019 0018 0088 017c 0119 0014  .|.........|....
-000004c0: 0091 0271 0253 00a9 0029 0172 0600 0000  ...q.S...).r....
-000004d0: a902 da02 2e30 da01 6ba9 03da 015a da02  .....0..k....Z..
-000004e0: 6d75 da06 706f 7765 7273 7207 0000 00fa  mu..powersr.....
-000004f0: 552f 686f 6d65 2f6d 616c 7465 2f6d 696e  U/home/malte/min
-00000500: 6963 6f6e 6461 332f 656e 7673 2f77 6f72  iconda3/envs/wor
-00000510: 6b2f 6c69 622f 7079 7468 6f6e 332e 3130  k/lib/python3.10
-00000520: 2f73 6974 652d 7061 636b 6167 6573 2f6c  /site-packages/l
-00000530: 6965 6f70 732f 636f 7265 2f62 6972 6b68  ieops/core/birkh
-00000540: 6f66 662e 7079 da0a 3c6c 6973 7463 6f6d  off.py..<listcom
-00000550: 703e 2600 0000 7302 0000 002a 007a 2268  p>&...s....*.z"h
-00000560: 6f6d 6f6c 6f67 6963 616c 5f65 712e 3c6c  omological_eq.<l
-00000570: 6f63 616c 733e 2e3c 6c69 7374 636f 6d70  ocals>.<listcomp
-00000580: 3e72 0100 0000 7900 0000 0000 0000 0000  >r....y.........
-00000590: 0000 0000 00f0 3f4e 7207 0000 0029 09da  ......?Nr....)..
-000005a0: 066c 6965 6f70 73da 0463 6f72 65da 036c  .lieops..core..l
-000005b0: 6965 da04 706f 6c79 7206 0000 00da 0569  ie..polyr......i
-000005c0: 7465 6d73 da03 7375 6dda 0572 616e 6765  tems..sum..range
-000005d0: da03 6c65 6e29 0772 0d00 0000 720c 0000  ..len).r....r...
-000005e0: 00da 066b 7761 7267 73da 0363 6869 da01  ...kwargs..chi..
-000005f0: 51da 0576 616c 7565 da02 6f6d 7207 0000  Q..value..omr...
-00000600: 0072 0b00 0000 720f 0000 00da 0e68 6f6d  .r....r......hom
-00000610: 6f6c 6f67 6963 616c 5f65 7106 0000 0073  ological_eq....s
-00000620: 0e00 0000 3a1e 1001 2201 0801 1201 0a02  ....:...".......
-00000630: 0801 721e 0000 00e9 0100 0000 e711 ea2d  ..r............-
-00000640: 8199 9771 3d54 da05 6f72 6465 7263 0400  ...q=T..orderc..
-00000650: 0000 0000 0000 0000 0000 2100 0000 0900  ..........!.....
-00000660: 0000 0b00 0000 73f8 0200 007c 0164 0117  ......s....|.d..
-00000670: 007d 057c 04a0 0064 027c 0164 0117 00a1  .}.|...d.|.d....
-00000680: 027d 067c 04a0 0064 037c 0164 0117 00a1  .}.|...d.|.d....
-00000690: 027d 0774 017c 0064 0483 0272 3e7c 057c  .}.t.|.d...r>|.|
-000006a0: 0464 033c 007c 007d 0874 027c 0074 036a  .d.<.|.}.t.|.t.j
-000006b0: 046a 056a 0683 0272 3174 077c 0066 0164  .j.j...r1t.|.f.d
-000006c0: 0588 0269 017c 04a4 018e 017d 0874 087c  ...i.|.....}.t.|
-000006d0: 0866 0164 0588 0269 017c 04a4 018e 015c  .f.d...i.|.....\
-000006e0: 027d 097d 0a6e 047c 007d 0969 007d 0a74  .}.}.n.|.}.i.}.t
-000006f0: 0974 0a74 0b7c 0983 0183 0183 017d 0b7c  .t.t.|.......}.|
-00000700: 0b64 011a 0089 0069 007d 0c67 007d 0d74  .d.....i.}.g.}.t
-00000710: 0c88 0083 0144 005d 3b89 0174 0d87 0087  .....D.];..t....
-00000720: 0166 0264 0664 0784 0874 0c7c 0b83 0144  .f.d.d...t.|...D
-00000730: 0083 0183 017d 0e7c 097c 0e19 007d 0f7c  .....}.|.|...}.|
-00000740: 09a0 0e7c 0ea1 0101 007c 0373 887c 0f6a  ...|.....|.s.|.j
-00000750: 0f88 026b 0073 854a 0064 0888 019b 0064  ...k.s.J.d.....d
-00000760: 097c 0f6a 0f9b 0064 0a88 029b 0064 0b9d  .|.j...d.....d..
-00000770: 0783 0182 017c 0f6a 107d 0f7c 0f7c 0c7c  .....|.j.}.|.|.|
-00000780: 0e3c 007c 0da0 117c 0fa1 0101 0071 5674  .<.|...|.....qVt
-00000790: 036a 046a 056a 067c 0c88 007c 0664 0c8d  .j.j.j.|...|.d..
-000007a0: 037d 1074 0987 0266 0164 0d64 0e84 087c  .}.t...f.d.d...|
-000007b0: 09a0 12a1 0044 0083 0183 0164 0f6b 0273  .....D.....d.k.s
-000007c0: ad4a 0082 017c 10a0 1364 1064 0e84 007c  .J...|...d.d...|
-000007d0: 09a0 12a1 0044 0083 01a1 017d 0074 036a  .....D.....}.t.j
-000007e0: 046a 056a 0688 007c 0664 118d 027d 117c  .j.j...|.d...}.|
-000007f0: 00a0 1464 12a1 017d 127c 00a0 15a1 007d  ...d...}.|.....}
-00000800: 1367 007c 0067 0102 027d 147d 1567 0067  .g.|.g...}.}.g.g
-00000810: 0002 027d 167d 1767 007d 1874 0c64 127c  ...}.}.g.}.t.d.|
-00000820: 0564 1317 0083 0244 005d 467d 1974 167c  .d.....D.]F}.t.|
-00000830: 0d7c 127c 0664 148d 035c 027d 1a7d 1b74  .|.|.d...\.}.}.t
-00000840: 097c 1a83 0164 0f6b 0272 f201 006e 3474  .|...d.k.r...n4t
-00000850: 036a 046a 056a 177c 1a0b 007c 0764 158d  .j.j.j.|...|.d..
-00000860: 027d 1c7c 1c7c 1383 017d 137c 13a0 147c  .}.|.|...}.|...|
-00000870: 1964 1317 00a1 017d 127c 117c 1b37 007d  .d.....}.|.|.7.}
-00000880: 117c 18a0 117c 1ca1 0101 007c 14a0 117c  .|...|.....|...|
-00000890: 1a0b 00a1 0101 007c 15a0 117c 13a1 0101  .......|...|....
-000008a0: 007c 16a0 117c 11a1 0101 007c 17a0 117c  .|...|.....|...|
-000008b0: 1ba1 0101 0071 df69 007d 1d7c 0a7c 1d64  .....q.i.}.|.|.d
-000008c0: 163c 007c 007c 1d64 173c 007c 107c 1d64  .<.|.|.d.<.|.|.d
-000008d0: 183c 007c 0d7c 1d64 193c 007c 187c 1d64  .<.|.|.d.<.|.|.d
-000008e0: 1a3c 007c 147c 1d64 1b3c 007c 157c 1d64  .<.|.|.d.<.|.|.d
-000008f0: 1c3c 007c 167c 1d64 1d3c 007c 177c 1d64  .<.|.|.d.<.|.|.d
-00000900: 1e3c 007c 017c 1d64 1f3c 007c 077c 1d64  .<.|.|.d.<.|.|.d
-00000910: 203c 007c 067c 1d64 023c 0067 007c 1d64   <.|.|.d.<.g.|.d
-00000920: 213c 0064 2244 005d 1b7d 1e7c 1e7c 0aa0  !<.d"D.].}.|.|..
-00000930: 18a1 0076 0090 0172 787c 0a7c 1e19 007d  ...v...rx|.|...}
-00000940: 1f74 197c 1fa0 1aa1 0083 017d 207c 1d64  .t.|.......} |.d
-00000950: 2119 00a0 117c 20a1 0101 0090 0171 5e7c  !....| ......q^|
-00000960: 1d53 0029 2361 3e0b 0000 0a20 2020 2043  .S.)#a>....    C
-00000970: 6f6d 7075 7465 2074 6865 2042 6972 6b68  ompute the Birkh
-00000980: 6f66 6620 6e6f 726d 616c 2066 6f72 6d20  off normal form 
-00000990: 6f66 2061 2067 6976 656e 2048 616d 696c  of a given Hamil
-000009a0: 746f 6e69 616e 2075 7020 746f 2061 2073  tonian up to a s
-000009b0: 7065 6369 6669 6320 6f72 6465 722e 0a20  pecific order.. 
-000009c0: 2020 200a 2020 2020 4174 7465 6e74 696f     .    Attentio
-000009d0: 6e3a 2043 6f6e 7374 616e 7473 2061 6e64  n: Constants and
-000009e0: 2061 6e79 2067 7261 6469 656e 7473 206f   any gradients o
-000009f0: 6620 4820 6174 207a 2077 696c 6c20 6265  f H at z will be
-00000a00: 2069 676e 6f72 6564 2e20 4966 2074 6865   ignored. If the
-00000a10: 7265 2069 7320 0a20 2020 2061 206e 6f6e  re is .    a non
-00000a20: 2d7a 6572 6f20 6772 6164 6965 6e74 2c20  -zero gradient, 
-00000a30: 6120 7761 726e 696e 6720 6973 2069 7373  a warning is iss
-00000a40: 7565 6420 6279 2064 6566 6175 6c74 2e0a  ued by default..
-00000a50: 2020 2020 0a20 2020 2050 6172 616d 6574      .    Paramet
-00000a60: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-00000a70: 2d2d 0a20 2020 2048 3a20 6361 6c6c 6162  --.    H: callab
-00000a80: 6c65 206f 7220 6469 6374 0a20 2020 2020  le or dict.     
-00000a90: 2020 2044 6566 696e 6573 2074 6865 2048     Defines the H
-00000aa0: 616d 696c 746f 6e69 616e 2074 6f20 6265  amiltonian to be
-00000ab0: 206e 6f72 6d61 6c69 7a65 642e 200a 2020   normalized. .  
-00000ac0: 2020 2020 2020 4929 2049 6620 4820 6973        I) If H is
-00000ad0: 2063 616c 6c61 626c 652c 2074 6865 6e20   callable, then 
-00000ae0: 6120 7472 616e 7366 6f72 6d61 7469 6f6e  a transformation
-00000af0: 2074 6f20 636f 6d70 6c65 7820 6e6f 726d   to complex norm
-00000b00: 616c 2066 6f72 6d20 6973 2070 6572 666f  al form is perfo
-00000b10: 726d 6564 2070 7269 6f72 2074 6f0a 2020  rmed prior to.  
-00000b20: 2020 2020 2020 2020 2061 7070 6c79 696e           applyin
-00000b30: 6720 7468 6520 6765 6e65 7261 6c20 616c  g the general al
-00000b40: 676f 7269 7468 6d2e 0a20 2020 2020 2020  gorithm..       
-00000b50: 2049 4929 2049 6620 4820 6973 2061 2064   II) If H is a d
-00000b60: 6963 7469 6f6e 6172 7920 2865 2e67 2e20  ictionary (e.g. 
-00000b70: 6672 6f6d 2070 6f6c 792e 6974 656d 7328  from poly.items(
-00000b80: 2929 2c20 7468 656e 2069 7473 206f 6666  )), then its off
-00000b90: 2d64 6961 676f 6e61 6c20 656e 7472 6965  -diagonal entrie
-00000ba0: 730a 2020 2020 2020 2020 2020 2020 6172  s.            ar
-00000bb0: 6520 6967 6e6f 7265 6420 2873 6f20 6974  e ignored (so it
-00000bc0: 2069 7320 6173 7375 6d65 6420 7468 6174   is assumed that
-00000bd0: 2048 2068 6173 2061 6c72 6561 6479 2062   H has already b
-00000be0: 6565 6e20 7072 6570 6172 6564 2074 6f20  een prepared to 
-00000bf0: 6265 2069 6e20 6669 7273 742d 6f72 6465  be in first-orde
-00000c00: 720a 2020 2020 2020 2020 2020 2020 6e6f  r.            no
-00000c10: 726d 616c 2066 6f72 6d29 2e0a 2020 2020  rmal form)..    
-00000c20: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-00000c30: 206f 7264 6572 3a20 696e 740a 2020 2020   order: int.    
-00000c40: 2020 2020 5468 6520 6f72 6465 7220 7570      The order up
-00000c50: 2074 6f20 7768 6963 6820 7765 2062 7569   to which we bui
-00000c60: 6c64 2074 6865 206e 6f72 6d61 6c20 666f  ld the normal fo
-00000c70: 726d 2e20 4865 7265 206f 7264 6572 203d  rm. Here order =
-00000c80: 206b 206d 6561 6e73 2074 6861 7420 7765   k means that we
-00000c90: 2063 6f6d 7075 7465 0a20 2020 2020 2020   compute.       
-00000ca0: 206b 2068 6f6d 6f67 656e 656f 7573 204c   k homogeneous L
-00000cb0: 6965 2d70 6f6c 796e 6f6d 6961 6c73 2c20  ie-polynomials, 
-00000cc0: 7768 6572 6520 7468 6520 736d 616c 6c65  where the smalle
-00000cd0: 7374 206f 6e65 2077 696c 6c20 6861 7665  st one will have
-00000ce0: 2070 6f77 6572 206b 202b 2032 2061 6e64   power k + 2 and
-00000cf0: 2074 6865 200a 2020 2020 2020 2020 7375   the .        su
-00000d00: 6363 6565 6469 6e67 206f 6e65 7320 7769  cceeding ones wi
-00000d10: 6c6c 2068 6176 6520 696e 6372 6561 7365  ll have increase
-00000d20: 6420 706f 7765 7273 2062 7920 312e 0a20  d powers by 1.. 
-00000d30: 2020 200a 2020 2020 636d 706c 783a 2062     .    cmplx: b
-00000d40: 6f6f 6c65 616e 2c20 6f70 7469 6f6e 616c  oolean, optional
-00000d50: 0a20 2020 2020 2020 2049 6620 6661 6c73  .        If fals
-00000d60: 652c 2061 7373 756d 6520 7468 6174 2074  e, assume that t
-00000d70: 6865 2063 6f65 6666 6963 6965 6e74 7320  he coefficients 
-00000d80: 6f66 2074 6865 2073 6563 6f6e 642d 6f72  of the second-or
-00000d90: 6465 7220 7465 726d 7320 6f66 2074 6865  der terms of the
-00000da0: 2048 616d 696c 746f 6e69 616e 2061 7265   Hamiltonian are
-00000db0: 2072 6561 6c2e 0a20 2020 2020 2020 2049   real..        I
-00000dc0: 6e20 7468 6973 2063 6173 6520 6120 6368  n this case a ch
-00000dd0: 6563 6b20 7769 6c6c 2062 6520 646f 6e65  eck will be done
-00000de0: 2061 6e64 2061 6e20 6572 726f 7220 7769   and an error wi
-00000df0: 6c6c 2062 6520 7261 6973 6564 2069 6620  ll be raised if 
-00000e00: 7468 6174 2069 7320 6e6f 7420 7468 6520  that is not the 
-00000e10: 6361 7365 2e0a 2020 2020 2020 2020 0a20  case..        . 
-00000e20: 2020 2074 6f6c 3a20 666c 6f61 742c 206f     tol: float, o
-00000e30: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-00000e40: 546f 6c65 7261 6e63 6520 6265 6c6f 7720  Tolerance below 
-00000e50: 7768 6963 6820 7661 6c75 6573 2061 7265  which values are
-00000e60: 2061 7373 756d 6564 2074 6f20 6265 207a   assumed to be z
-00000e70: 6572 6f2e 0a20 2020 2020 2020 200a 2020  ero..        .  
-00000e80: 2020 2a2a 6b77 6172 6773 0a20 2020 2020    **kwargs.     
-00000e90: 2020 204b 6579 776f 7264 2061 7267 756d     Keyword argum
-00000ea0: 656e 7473 2061 7265 2070 6173 7365 6420  ents are passed 
-00000eb0: 746f 206c 6965 6f70 732e 6c69 6e61 6c67  to lieops.linalg
-00000ec0: 2e6e 662e 6669 7273 745f 6f72 6465 725f  .nf.first_order_
-00000ed0: 6e66 5f65 7870 616e 7369 6f6e 2072 6f75  nf_expansion rou
-00000ee0: 7469 6e65 2e0a 2020 2020 2020 2020 0a20  tine..        . 
-00000ef0: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
-00000f00: 2d2d 2d2d 2d2d 0a20 2020 2064 6963 740a  ------.    dict.
-00000f10: 2020 2020 2020 2020 4120 6469 6374 696f          A dictio
-00000f20: 6e61 7279 2077 6974 6820 7468 6520 666f  nary with the fo
-00000f30: 6c6c 6f77 696e 6720 6b65 7973 3a0a 2020  llowing keys:.  
-00000f40: 2020 2020 2020 6e66 6469 6374 203a 2054        nfdict : T
-00000f50: 6865 206f 7574 7075 7420 6f66 206c 6965  he output of lie
-00000f60: 6f70 732e 6c69 6e61 6c67 2e6e 662e 6669  ops.linalg.nf.fi
-00000f70: 7273 745f 6f72 6465 725f 6e66 5f65 7870  rst_order_nf_exp
-00000f80: 616e 7369 6f6e 2e0a 2020 2020 2020 2020  ansion..        
-00000f90: 4820 2020 2020 203a 2044 6963 7469 6f6e  H      : Diction
-00000fa0: 6172 7920 6465 6e6f 7469 6e67 2074 6865  ary denoting the
-00000fb0: 2075 7365 6420 4861 6d69 6c74 6f6e 6961   used Hamiltonia
-00000fc0: 6e2e 0a20 2020 2020 2020 2048 3020 2020  n..        H0   
-00000fd0: 2020 3a20 4469 6374 696f 6e61 7279 2064    : Dictionary d
-00000fe0: 656e 6f74 696e 6720 7468 6520 7365 636f  enoting the seco
-00000ff0: 6e64 2d6f 7264 6572 2063 6f65 6666 6963  nd-order coeffic
-00001000: 6965 6e74 7320 6f66 2048 2e0a 2020 2020  ients of H..    
-00001010: 2020 2020 6d75 2020 2020 203a 204c 6973      mu     : Lis
-00001020: 7420 6f66 2074 6865 2074 756e 6573 2075  t of the tunes u
-00001030: 7365 6420 2863 6f65 6666 6963 6965 6e74  sed (coefficient
-00001040: 7320 6f66 2048 3029 2e0a 2020 2020 2020  s of H0)..      
-00001050: 2020 6368 6920 2020 203a 204c 6973 7420    chi    : List 
-00001060: 6f66 2070 6f6c 7920 6f62 6a65 6374 732c  of poly objects,
-00001070: 2064 656e 6f74 696e 6720 7468 6520 4c69   denoting the Li
-00001080: 652d 706f 6c79 6e6f 6d69 616c 7320 6f66  e-polynomials of
-00001090: 2064 6567 7265 6520 3e3d 2033 2077 6869   degree >= 3 whi
-000010a0: 6368 206d 6170 2074 6f20 6e6f 726d 616c  ch map to normal
-000010b0: 2066 6f72 6d2e 0a20 2020 2020 2020 2063   form..        c
-000010c0: 6869 3020 2020 3a20 4c69 7374 206f 6620  hi0   : List of 
-000010d0: 7468 6520 7477 6f20 4c69 652d 706f 6c79  the two Lie-poly
-000010e0: 6e6f 6d69 616c 7320 6f66 2064 6567 7265  nomials of degre
-000010f0: 6520 3220 7768 6963 6820 6d61 7020 7468  e 2 which map th
-00001100: 6520 6769 7665 6e20 4861 6d69 6c74 6f6e  e given Hamilton
-00001110: 6961 6e20 0a20 2020 2020 2020 2020 2020  ian .           
-00001120: 2020 2020 2020 746f 2069 7473 2066 6972        to its fir
-00001130: 7374 2d6f 7264 6572 206e 6f72 6d61 6c20  st-order normal 
-00001140: 666f 726d 2065 7175 6976 616c 656e 742e  form equivalent.
-00001150: 2054 6869 7320 6d65 616e 7320 7468 6174   This means that
-00001160: 2074 6865 206c 6973 7420 2263 6869 3020   the list "chi0 
-00001170: 2b20 6368 6922 2070 6572 666f 726d 7320  + chi" performs 
-00001180: 7468 6520 0a20 2020 2020 2020 2020 2020  the .           
-00001190: 2020 2020 2020 656e 7469 7265 206d 6170        entire map
-000011a0: 2075 7020 746f 2074 6865 2064 6573 6972   up to the desir
-000011b0: 6564 206f 7264 6572 2028 7365 6520 616c  ed order (see al
-000011c0: 736f 2074 6865 2065 7861 6d70 6c65 2062  so the example b
-000011d0: 656c 6f77 292e 204e 6f74 2073 7570 706f  elow). Not suppo
-000011e0: 7274 6564 2069 6620 6d70 6d61 7468 2068  rted if mpmath h
-000011f0: 6173 2062 6565 6e20 7573 6564 2e20 2020  as been used.   
-00001200: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
-00001210: 2020 2020 2020 2048 6b20 2020 2020 3a20         Hk     : 
-00001220: 4c69 7374 206f 6620 706f 6c79 206f 626a  List of poly obj
-00001230: 6563 7473 2c20 636f 7272 6573 706f 6e64  ects, correspond
-00001240: 696e 6720 746f 2074 6865 2074 7261 6e73  ing to the trans
-00001250: 666f 726d 6564 2048 616d 696c 746f 6e69  formed Hamiltoni
-00001260: 616e 732e 0a20 2020 2020 2020 205a 6b20  ans..        Zk 
-00001270: 2020 2020 3a20 4c69 7374 206f 6620 706f      : List of po
-00001280: 6c79 206f 626a 6563 7473 2c20 6e6f 7461  ly objects, nota
-00001290: 7469 6f6e 2073 6565 204c 656d 2e20 312e  tion see Lem. 1.
-000012a0: 342e 352e 2069 6e20 5265 662e 205b 315d  4.5. in Ref. [1]
-000012b0: 2e20 0a20 2020 2020 2020 2051 6b20 2020  . .        Qk   
-000012c0: 2020 3a20 4c69 7374 206f 6620 706f 6c79    : List of poly
-000012d0: 206f 626a 6563 7473 2c20 6e6f 7461 7469   objects, notati
-000012e0: 6f6e 2073 6565 204c 656d 2e20 312e 342e  on see Lem. 1.4.
-000012f0: 352e 2069 6e20 5265 662e 205b 315d 2e0a  5. in Ref. [1]..
-00001300: 2020 2020 2020 2020 0a20 2020 2045 7861          .    Exa
-00001310: 6d70 6c65 0a20 2020 202d 2d2d 2d2d 2d2d  mple.    -------
-00001320: 2020 2020 2020 0a20 2020 206e 6664 6963        .    nfdic
-00001330: 7420 3d20 4831 2e62 6e66 286f 7264 6572  t = H1.bnf(order
-00001340: 3d34 290a 2020 2020 7720 3d20 4831 2e63  =4).    w = H1.c
-00001350: 6f70 7928 290a 2020 2020 666f 7220 6320  opy().    for c 
-00001360: 696e 206e 6664 6963 745b 2763 6869 3027  in nfdict['chi0'
-00001370: 5d20 2b20 6e66 6469 6374 5b27 6368 6927  ] + nfdict['chi'
-00001380: 5d3a 0a20 2020 2020 2020 2077 203d 2063  ]:.        w = c
-00001390: 2e6c 6578 7028 706f 7765 723d 3130 2928  .lexp(power=10)(
-000013a0: 7729 0a20 2020 2020 2020 2070 7269 6e74  w).        print
-000013b0: 2028 772e 6162 6f76 6528 3165 2d31 3229   (w.above(1e-12)
-000013c0: 2920 2320 6578 616d 706c 650a 0a20 2020  ) # example..   
-000013d0: 2052 6566 6572 656e 6365 730a 2020 2020   References.    
-000013e0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 205b  ----------.    [
-000013f0: 315d 3a20 4d2e 2054 6974 7a65 3a20 2253  1]: M. Titze: "S
-00001400: 7061 6365 2043 6861 7267 6520 4d6f 6465  pace Charge Mode
-00001410: 6c69 6e67 2061 7420 7468 6520 496e 7465  ling at the Inte
-00001420: 6765 7220 5265 736f 6e61 6e63 6520 666f  ger Resonance fo
-00001430: 7220 7468 6520 4345 524e 2050 5320 616e  r the CERN PS an
-00001440: 6420 5350 5322 2c20 5068 4420 5468 6573  d SPS", PhD Thes
-00001450: 6973 2028 3230 3139 292e 0a20 2020 205b  is (2019)..    [
-00001460: 325d 3a20 422e 2047 7265 6265 7274 2e20  2]: B. Grebert. 
-00001470: 2242 6972 6b68 6f66 6620 6e6f 726d 616c  "Birkhoff normal
-00001480: 2066 6f72 6d20 616e 6420 4861 6d69 6c74   form and Hamilt
-00001490: 6f6e 6961 6e20 5044 4573 222e 2028 3230  onian PDEs". (20
-000014a0: 3036 290a 2020 2020 e902 0000 00da 096d  06).    .......m
-000014b0: 6178 5f70 6f77 6572 da05 706f 7765 72da  ax_power..power.
-000014c0: 085f 5f63 616c 6c5f 5fda 0374 6f6c 6301  .__call__..tolc.
-000014d0: 0000 0000 0000 0000 0000 0002 0000 0005  ................
-000014e0: 0000 0013 0000 0073 2800 0000 6700 7c00  .......s(...g.|.
-000014f0: 5d10 7d01 7c01 8801 6b03 7210 7c01 8801  ].}.|...k.r.|...
-00001500: 8800 1700 6b03 7210 6400 6e01 6401 9102  ....k.r.d.n.d...
-00001510: 7102 5300 2902 7201 0000 0072 1f00 0000  q.S.).r....r....
-00001520: 7207 0000 0072 0800 0000 2902 7206 0000  r....r....).r...
-00001530: 00da 016a 7207 0000 0072 0f00 0000 7210  ...jr....r....r.
-00001540: 0000 008e 0000 0073 0200 0000 2800 7a17  .......s....(.z.
-00001550: 626e 662e 3c6c 6f63 616c 733e 2e3c 6c69  bnf.<locals>.<li
-00001560: 7374 636f 6d70 3e7a 1849 6d61 6769 6e61  stcomp>z.Imagina
-00001570: 7279 2070 6172 7420 6f66 2065 6e74 7279  ry part of entry
-00001580: 207a 1220 6162 6f76 6520 746f 6c65 7261   z. above tolera
-00001590: 6e63 653a 207a 0420 3e3d 207a 272e 2043  nce: z. >= z'. C
-000015a0: 6865 636b 2069 6e70 7574 206f 7220 7472  heck input or tr
-000015b0: 7920 636d 706c 783d 5472 7565 206f 7074  y cmplx=True opt
-000015c0: 696f 6e2e 2903 7205 0000 0072 0600 0000  ion.).r....r....
-000015d0: 7223 0000 0063 0100 0000 0000 0000 0000  r#...c..........
-000015e0: 0000 0300 0000 0400 0000 1300 0000 732e  ..............s.
-000015f0: 0000 0069 007c 005d 135c 027d 017d 0274  ...i.|.].\.}.}.t
-00001600: 007c 0183 0164 006b 0272 0274 017c 0283  .|...d.k.r.t.|..
-00001610: 0188 006b 0572 027c 017c 0293 0271 0253  ...k.r.|.|...q.S
-00001620: 00a9 0172 2200 0000 2902 7216 0000 00da  ...r"...).r.....
-00001630: 0361 6273 a903 7209 0000 0072 0a00 0000  .abs..r....r....
-00001640: da01 7629 0172 2600 0000 7207 0000 0072  ..v).r&...r....r
-00001650: 0f00 0000 da0a 3c64 6963 7463 6f6d 703e  ......<dictcomp>
-00001660: 9900 0000 7302 0000 002e 007a 1762 6e66  ....s......z.bnf
-00001670: 2e3c 6c6f 6361 6c73 3e2e 3c64 6963 7463  .<locals>.<dictc
-00001680: 6f6d 703e 7201 0000 0063 0100 0000 0000  omp>r....c......
-00001690: 0000 0000 0000 0300 0000 0400 0000 5300  ..............S.
-000016a0: 0000 7322 0000 0069 007c 005d 0d5c 027d  ..s"...i.|.].\.}
-000016b0: 017d 0274 007c 0183 0164 006b 0472 027c  .}.t.|...d.k.r.|
-000016c0: 017c 0293 0271 0253 0072 2800 0000 2901  .|...q.S.r(...).
-000016d0: 7216 0000 0072 2a00 0000 7207 0000 0072  r....r*...r....r
-000016e0: 0700 0000 720f 0000 0072 2c00 0000 9f00  ....r....r,.....
-000016f0: 0000 7302 0000 0022 0029 0272 0600 0000  ..s....".).r....
-00001700: 7223 0000 00e9 0300 0000 721f 0000 0029  r#........r....)
-00001710: 0372 0d00 0000 720c 0000 0072 2300 0000  .r....r....r#...
-00001720: 2901 7224 0000 00da 066e 6664 6963 74da  ).r$.....nfdict.
-00001730: 0148 da02 4830 720d 0000 00da 086c 6368  .H..H0r......lch
-00001740: 695f 696e 7672 1a00 0000 da02 486b da02  i_invr......Hk..
-00001750: 5a6b da02 516b 7221 0000 00da 086c 6f5f  Zk..Qkr!.....lo_
-00001760: 706f 7765 72da 0463 6869 3029 02da 0243  power..chi0)...C
-00001770: 31da 0243 3229 1bda 0367 6574 da07 6861  1..C2)...get..ha
-00001780: 7361 7474 72da 0a69 7369 6e73 7461 6e63  sattr..isinstanc
-00001790: 6572 1100 0000 7212 0000 0072 1300 0000  er....r....r....
-000017a0: 7214 0000 0072 0200 0000 7203 0000 0072  r....r....r....r
-000017b0: 1800 0000 da04 6e65 7874 da04 6974 6572  ......next..iter
-000017c0: 7217 0000 00da 0574 7570 6c65 da03 706f  r......tuple..po
-000017d0: 70da 0469 6d61 67da 0472 6561 6cda 0661  p..imag..real..a
-000017e0: 7070 656e 6472 1500 0000 da06 7570 6461  ppendr......upda
-000017f0: 7465 da10 686f 6d6f 6765 6e65 6f75 735f  te..homogeneous_
-00001800: 7061 7274 da04 636f 7079 721e 0000 00da  part..copyr.....
-00001810: 046c 6578 70da 046b 6579 7372 0400 0000  .lexp..keysr....
-00001820: da09 7472 616e 7370 6f73 6529 2172 2f00  ..transpose)!r/.
-00001830: 0000 7221 0000 0072 2600 0000 da05 636d  ..r!...r&.....cm
-00001840: 706c 7872 1900 0000 7224 0000 0072 2300  plxr....r$...r#.
-00001850: 0000 7235 0000 00da 0448 696e 70da 0d74  ..r5.....Hinp..t
-00001860: 6179 6c6f 725f 636f 6566 6673 722e 0000  aylor_coeffsr...
-00001870: 00da 0464 696d 32da 0948 305f 7661 6c75  ...dim2..H0_valu
-00001880: 6573 720d 0000 00da 0374 706c da03 6d75  esr......tpl..mu
-00001890: 6a72 3000 0000 7233 0000 00da 0250 6b72  jr0...r3.....Pkr
-000018a0: 3200 0000 da07 6368 695f 616c 6cda 0648  2.....chi_all..H
-000018b0: 6b5f 616c 6cda 065a 6b5f 616c 6cda 0651  k_all..Zk_all..Q
-000018c0: 6b5f 616c 6cda 086c 6368 695f 616c 6c72  k_all..lchi_allr
-000018d0: 0a00 0000 721a 0000 0072 1b00 0000 da04  ....r....r......
-000018e0: 6c63 6869 da03 6f75 74da 0663 6c61 6265  lchi..out..clabe
-000018f0: 6cda 0143 da02 4370 7207 0000 0029 0372  l..C..Cpr....).r
-00001900: 0600 0000 7227 0000 0072 2600 0000 720f  ....r'...r&...r.
-00001910: 0000 00da 0362 6e66 2d00 0000 7386 0000  .....bnf-...s...
-00001920: 0008 3d10 0110 010a 0608 0204 0110 0114  ..=.............
-00001930: 041a 0104 0504 0110 0608 0104 0304 010c  ................
-00001940: 011c 0108 010a 0204 0128 0206 0108 010c  .........(......
-00001950: 0114 0122 0118 0612 070a 0108 010c 020a  ..."............
-00001960: 0104 0112 0112 010c 0104 0214 0108 010e  ................
-00001970: 0208 010a 020c 010a 010a 010c 0104 0308  ................
-00001980: 0108 0108 0108 0108 0108 0108 0108 0108  ................
-00001990: 0108 0108 0108 0108 0208 010e 0108 020c  ................
-000019a0: 010e 0104 8004 0272 5b00 0000 2903 721f  .......r[...).r.
-000019b0: 0000 0072 2000 0000 5429 0bda 0f6c 6965  ...r ...T)...lie
-000019c0: 6f70 732e 636f 7265 2e6c 6965 7211 0000  ops.core.lier...
-000019d0: 005a 146c 6965 6f70 732e 736f 6c76 6572  .Z.lieops.solver
-000019e0: 2e63 6f6d 6d6f 6e72 0200 0000 da10 6c69  .commonr......li
-000019f0: 656f 7073 2e6c 696e 616c 672e 6e66 7203  eops.linalg.nfr.
-00001a00: 0000 00da 116c 6965 6f70 732e 636f 7265  .....lieops.core
-00001a10: 2e74 6f6f 6c73 7204 0000 0072 1e00 0000  .toolsr....r....
-00001a20: da03 696e 7472 5b00 0000 7207 0000 0072  ..intr[...r....r
-00001a30: 0700 0000 7207 0000 0072 0f00 0000 da08  ....r....r......
-00001a40: 3c6d 6f64 756c 653e 0100 0000 730c 0000  <module>....s...
-00001a50: 0008 000c 010c 010c 0108 0214 27         ............'
+00000050: 6404 6c06 6d07 5a07 0100 6400 6405 6c08  d.l.m.Z...d.d.l.
+00000060: 6d09 5a09 0100 6406 6407 8400 5a0a 640e  m.Z...d.d...Z.d.
+00000070: 640b 650b 6602 640c 640d 8405 5a0c 6401  d.e.f.d.d...Z.d.
+00000080: 5300 290f e900 0000 004e 2901 da17 6765  S.)......N)...ge
+00000090: 7452 6561 6c48 616d 696c 746f 6e46 756e  tRealHamiltonFun
+000000a0: 6374 696f 6e29 01da 1866 6972 7374 5f6f  ction)...first_o
+000000b0: 7264 6572 5f6e 665f 6578 7061 6e73 696f  rder_nf_expansio
+000000c0: 6e29 01da 0465 6d61 7429 01da 0761 6432  n)...emat)...ad2
+000000d0: 706f 6c79 6302 0000 0000 0000 0000 0000  polyc...........
+000000e0: 0007 0000 0006 0000 000b 0000 0073 9800  .............s..
+000000f0: 0000 7400 6a01 6a02 6a03 6407 6900 8800  ..t.j.j.j.d.i...
+00000100: 6a04 6401 9c02 7c02 a401 8e01 7400 6a01  j.d...|.....t.j.
+00000110: 6a02 6a03 6407 6900 8800 6a04 6401 9c02  j.j.d.i...j.d...
+00000120: 7c02 a401 8e01 0202 7d03 7d04 8800 a005  |.......}.}.....
+00000130: a100 4400 5d26 5c02 8902 7d05 7406 8700  ..D.]&\...}.t...
+00000140: 8701 8702 6603 6402 6403 8408 7407 7408  ....f.d.d...t.t.
+00000150: 8801 8301 8301 4400 8301 8301 7d06 7c06  ......D.....}.|.
+00000160: 6404 6b03 7243 6405 7c06 1b00 7c05 1400  d.k.rCd.|...|...
+00000170: 7c03 8802 3c00 7121 7c05 7c04 8802 3c00  |...<.q!|.|...<.
+00000180: 7121 7c03 7c04 6602 5300 2908 61f3 0200  q!|.|.f.S.).a...
+00000190: 000a 2020 2020 4c65 7420 655b 6b5d 2c20  ..    Let e[k], 
+000001a0: 6b20 3d20 312c 202e 2e2e 2c20 6c65 6e28  k = 1, ..., len(
+000001b0: 6d75 2920 6265 2061 6374 696f 6e73 2c20  mu) be actions, 
+000001c0: 4830 203a 3d20 7375 6d5f 6b20 6d75 5b6b  H0 := sum_k mu[k
+000001d0: 5d2a 655b 6b5d 2061 6e64 205a 2061 0a20  ]*e[k] and Z a. 
+000001e0: 2020 2070 6f6c 796e 6f6d 6961 6c20 6f66     polynomial of
+000001f0: 2064 6567 7265 6520 6e2e 2054 6865 6e20   degree n. Then 
+00000200: 7468 6973 2072 6f75 7469 6e65 2077 696c  this routine wil
+00000210: 6c20 736f 6c76 6520 0a20 2020 2074 6865  l solve .    the
+00000220: 2068 6f6d 6f6c 6f67 6963 616c 2065 7175   homological equ
+00000230: 6174 696f 6e20 0a20 2020 207b 4830 2c20  ation .    {H0, 
+00000240: 6368 697d 202b 205a 203d 2051 2077 6974  chi} + Z = Q wit
+00000250: 680a 2020 2020 7b48 302c 2051 7d20 3d20  h.    {H0, Q} = 
+00000260: 302e 0a0a 2020 2020 4174 7465 6e74 696f  0...    Attentio
+00000270: 6e3a 204e 6f20 6368 6563 6b20 7768 6574  n: No check whet
+00000280: 6865 7220 5a20 6973 2061 6374 7561 6c6c  her Z is actuall
+00000290: 7920 686f 6d6f 6765 6e65 6f75 7320 6f72  y homogeneous or
+000002a0: 2072 6561 6c2c 2062 7574 2069 6620 6f6e   real, but if on
+000002b0: 6520 6f66 0a20 2020 2074 6865 7365 2070  e of.    these p
+000002c0: 726f 7065 7274 6965 7320 686f 6c64 2c20  roperties hold, 
+000002d0: 7468 656e 2061 6c73 6f20 6368 6920 616e  then also chi an
+000002e0: 6420 5120 7769 6c6c 2061 646d 6974 2073  d Q will admit s
+000002f0: 7563 6820 7072 6f70 6572 7469 6573 2e0a  uch properties..
+00000300: 2020 2020 0a20 2020 2050 6172 616d 6574      .    Paramet
+00000310: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
+00000320: 2d2d 0a20 2020 206d 753a 206c 6973 740a  --.    mu: list.
+00000330: 2020 2020 2020 2020 6c69 7374 206f 6620          list of 
+00000340: 666c 6f61 7473 2028 7475 6e65 7329 2e0a  floats (tunes)..
+00000350: 2020 2020 2020 2020 0a20 2020 205a 3a20          .    Z: 
+00000360: 706f 6c79 0a20 2020 2020 2020 2050 6f6c  poly.        Pol
+00000370: 796e 6f6d 6961 6c20 6f66 2064 6567 7265  ynomial of degre
+00000380: 6520 6e2e 0a20 2020 2020 2020 200a 2020  e n..        .  
+00000390: 2020 2a2a 6b77 6172 6773 0a20 2020 2020    **kwargs.     
+000003a0: 2020 2041 7267 756d 656e 7473 2070 6173     Arguments pas
+000003b0: 7365 6420 746f 2070 6f6c 7920 696e 6974  sed to poly init
+000003c0: 6961 6c69 7a61 7469 6f6e 2e0a 2020 2020  ialization..    
+000003d0: 2020 2020 0a20 2020 2052 6574 7572 6e73      .    Returns
+000003e0: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
+000003f0: 2063 6869 3a20 706f 6c79 0a20 2020 2020   chi: poly.     
+00000400: 2020 2050 6f6c 796e 6f6d 6961 6c20 6f66     Polynomial of
+00000410: 2064 6567 7265 6520 6e20 7769 7468 2074   degree n with t
+00000420: 6865 2061 626f 7665 2070 726f 7065 7274  he above propert
+00000430: 792e 0a20 2020 2020 2020 200a 2020 2020  y..        .    
+00000440: 513a 2070 6f6c 790a 2020 2020 2020 2020  Q: poly.        
+00000450: 506f 6c79 6e6f 6d69 616c 206f 6620 6465  Polynomial of de
+00000460: 6772 6565 206e 2077 6974 6820 7468 6520  gree n with the 
+00000470: 6162 6f76 6520 7072 6f70 6572 7479 2e0a  above property..
+00000480: 2020 2020 2902 da06 7661 6c75 6573 da03      )...values..
+00000490: 6469 6d63 0100 0000 0000 0000 0000 0000  dimc............
+000004a0: 0200 0000 0600 0000 1300 0000 732a 0000  ............s*..
+000004b0: 0067 007c 005d 117d 0188 027c 0119 0088  .g.|.].}...|....
+000004c0: 0288 006a 007c 0117 0019 0018 0088 017c  ...j.|.........|
+000004d0: 0119 0014 0091 0271 0253 00a9 0029 0172  .......q.S...).r
+000004e0: 0700 0000 a902 da02 2e30 da01 6ba9 03da  .........0..k...
+000004f0: 015a da02 6d75 da06 706f 7765 7273 7208  .Z..mu..powersr.
+00000500: 0000 00fa 2e2f 686f 6d65 2f6d 616c 7465  ...../home/malte
+00000510: 2f67 6974 2f6c 6965 6f70 732f 6c69 656f  /git/lieops/lieo
+00000520: 7073 2f63 6f72 652f 6269 726b 686f 6666  ps/core/birkhoff
+00000530: 2e70 79da 0a3c 6c69 7374 636f 6d70 3e27  .py..<listcomp>'
+00000540: 0000 0073 0200 0000 2a00 7a22 686f 6d6f  ...s....*.z"homo
+00000550: 6c6f 6769 6361 6c5f 6571 2e3c 6c6f 6361  logical_eq.<loca
+00000560: 6c73 3e2e 3c6c 6973 7463 6f6d 703e 7201  ls>.<listcomp>r.
+00000570: 0000 0079 0000 0000 0000 0000 0000 0000  ...y............
+00000580: 0000 f03f 4e72 0800 0000 2909 da06 6c69  ...?Nr....)...li
+00000590: 656f 7073 da04 636f 7265 da03 6c69 65da  eops..core..lie.
+000005a0: 0470 6f6c 7972 0700 0000 da05 6974 656d  .polyr......item
+000005b0: 73da 0373 756d da05 7261 6e67 65da 036c  s..sum..range..l
+000005c0: 656e 2907 720e 0000 0072 0d00 0000 da06  en).r....r......
+000005d0: 6b77 6172 6773 da03 6368 69da 0151 da05  kwargs..chi..Q..
+000005e0: 7661 6c75 65da 026f 6d72 0800 0000 720c  value..omr....r.
+000005f0: 0000 0072 1000 0000 da0e 686f 6d6f 6c6f  ...r......homolo
+00000600: 6769 6361 6c5f 6571 0700 0000 730e 0000  gical_eq....s...
+00000610: 003a 1e10 0122 0108 0112 010a 0208 0172  .:...".........r
+00000620: 1f00 0000 e901 0000 00e7 11ea 2d81 9997  ............-...
+00000630: 713d 54da 056f 7264 6572 6305 0000 0000  q=T..orderc.....
+00000640: 0000 0000 0000 0022 0000 0009 0000 000b  ......."........
+00000650: 0000 0073 0203 0000 7c01 6401 1700 7d06  ...s....|.d...}.
+00000660: 7c05 a000 6402 7c01 6401 1700 a102 7d07  |...d.|.d.....}.
+00000670: 7c05 a000 6403 7c01 6401 1700 a102 7d08  |...d.|.d.....}.
+00000680: 7401 7c00 6404 8302 723a 7c06 7c05 6403  t.|.d...r:|.|.d.
+00000690: 3c00 7c00 7d09 7402 7c00 7403 6a04 6a05  <.|.}.t.|.t.j.j.
+000006a0: 6a06 8302 722d 7407 7c00 7c02 6405 8d02  j...r-t.|.|.d...
+000006b0: 7d09 7408 7c09 6601 6406 8802 6901 7c05  }.t.|.f.d...i.|.
+000006c0: a401 8e01 5c02 7d0a 7d0b 6e04 7c00 7d0a  ....\.}.}.n.|.}.
+000006d0: 6900 7d0b 7409 740a 740b 7c0a 8301 8301  i.}.t.t.t.|.....
+000006e0: 8301 7d0c 7c0c 6401 1a00 8900 6900 7d0d  ..}.|.d.....i.}.
+000006f0: 6700 7d0e 740c 8800 8301 4400 5d3b 8901  g.}.t.....D.];..
+00000700: 740d 8700 8701 6602 6407 6408 8408 740c  t.....f.d.d...t.
+00000710: 7c0c 8301 4400 8301 8301 7d0f 7c0a 7c0f  |...D.....}.|.|.
+00000720: 1900 7d10 7c0a a00e 7c0f a101 0100 7c04  ..}.|...|.....|.
+00000730: 7384 7c10 6a0f 8802 6b00 7381 4a00 6409  s.|.j...k.s.J.d.
+00000740: 8801 9b00 640a 7c10 6a0f 9b00 640b 8802  ....d.|.j...d...
+00000750: 9b00 640c 9d07 8301 8201 7c10 6a10 7d10  ..d.......|.j.}.
+00000760: 7c10 7c0d 7c0f 3c00 7c0e a011 7c10 a101  |.|.|.<.|...|...
+00000770: 0100 7152 7403 6a04 6a05 6a06 7c0d 8800  ..qRt.j.j.j.|...
+00000780: 7c07 640d 8d03 7d11 7409 8702 6601 640e  |.d...}.t...f.d.
+00000790: 640f 8408 7c0a a012 a100 4400 8301 8301  d...|.....D.....
+000007a0: 6410 6b02 73a9 4a00 8201 7c11 a013 6411  d.k.s.J...|...d.
+000007b0: 640f 8400 7c0a a012 a100 4400 8301 a101  d...|.....D.....
+000007c0: 7d00 7403 6a04 6a05 6a06 8800 7c07 6412  }.t.j.j.j...|.d.
+000007d0: 8d02 7d12 7c00 a014 6413 a101 7d13 7c00  ..}.|...d...}.|.
+000007e0: a015 a100 7d14 6700 7c00 6701 0202 7d15  ....}.g.|.g...}.
+000007f0: 7d16 6700 6700 0202 7d17 7d18 6700 7d19  }.g.g...}.}.g.}.
+00000800: 740c 6413 7c06 6414 1700 8302 4400 5d46  t.d.|.d.....D.]F
+00000810: 7d1a 7416 7c0e 7c13 7c07 6415 8d03 5c02  }.t.|.|.|.d...\.
+00000820: 7d1b 7d1c 7409 7c1b 8301 6410 6b02 72ee  }.}.t.|...d.k.r.
+00000830: 0100 6e34 7403 6a04 6a05 6a17 7c1b 0b00  ..n4t.j.j.j.|...
+00000840: 7c08 6416 8d02 7d1d 7c1d 7c14 8301 7d14  |.d...}.|.|...}.
+00000850: 7c14 a014 7c1a 6414 1700 a101 7d13 7c12  |...|.d.....}.|.
+00000860: 7c1c 3700 7d12 7c19 a011 7c1d a101 0100  |.7.}.|...|.....
+00000870: 7c15 a011 7c1b 0b00 a101 0100 7c16 a011  |...|.......|...
+00000880: 7c14 a101 0100 7c17 a011 7c12 a101 0100  |.....|...|.....
+00000890: 7c18 a011 7c1c a101 0100 71db 6900 7d1e  |...|.....q.i.}.
+000008a0: 7c0b 7c1e 6417 3c00 7c00 7c1e 6418 3c00  |.|.d.<.|.|.d.<.
+000008b0: 7c09 7c1e 6419 3c00 7c11 7c1e 641a 3c00  |.|.d.<.|.|.d.<.
+000008c0: 7c0e 7c1e 641b 3c00 7c19 7c1e 641c 3c00  |.|.d.<.|.|.d.<.
+000008d0: 7c15 7c1e 641d 3c00 7c16 7c1e 641e 3c00  |.|.d.<.|.|.d.<.
+000008e0: 7c17 7c1e 641f 3c00 7c18 7c1e 6420 3c00  |.|.d.<.|.|.d <.
+000008f0: 7c01 7c1e 6421 3c00 7c08 7c1e 6422 3c00  |.|.d!<.|.|.d"<.
+00000900: 7c07 7c1e 6402 3c00 6700 7c1e 6423 3c00  |.|.d.<.g.|.d#<.
+00000910: 6424 4400 5d20 7d1f 7c1f 7c0b a018 a100  d$D.] }.|.|.....
+00000920: 7600 9001 727d 7c0b 7c1f 1900 7d20 7419  v...r}|.|...} t.
+00000930: 7c20 8301 a01a a100 6a1b 7d20 741c 7c20  | ......j.} t.| 
+00000940: 8301 7d21 7c1e 6423 1900 a011 7c21 a101  ..}!|.d#....|!..
+00000950: 0100 9001 715e 7c1e 5300 2925 6134 0c00  ....q^|.S.)%a4..
+00000960: 000a 2020 2020 436f 6d70 7574 6520 7468  ..    Compute th
+00000970: 6520 4269 726b 686f 6666 206e 6f72 6d61  e Birkhoff norma
+00000980: 6c20 666f 726d 206f 6620 6120 6769 7665  l form of a give
+00000990: 6e20 4861 6d69 6c74 6f6e 6961 6e20 7570  n Hamiltonian up
+000009a0: 2074 6f20 6120 7370 6563 6966 6963 206f   to a specific o
+000009b0: 7264 6572 2e0a 2020 2020 0a20 2020 2041  rder..    .    A
+000009c0: 7474 656e 7469 6f6e 3a20 436f 6e73 7461  ttention: Consta
+000009d0: 6e74 7320 616e 6420 616e 7920 6772 6164  nts and any grad
+000009e0: 6965 6e74 7320 6f66 2048 2061 7420 7a20  ients of H at z 
+000009f0: 7769 6c6c 2062 6520 6967 6e6f 7265 642e  will be ignored.
+00000a00: 2049 6620 7468 6572 6520 6973 200a 2020   If there is .  
+00000a10: 2020 6120 6e6f 6e2d 7a65 726f 2067 7261    a non-zero gra
+00000a20: 6469 656e 742c 2061 2077 6172 6e69 6e67  dient, a warning
+00000a30: 2069 7320 6973 7375 6564 2062 7920 6465   is issued by de
+00000a40: 6661 756c 742e 0a20 2020 200a 2020 2020  fault..    .    
+00000a50: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
+00000a60: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 483a  ---------.    H:
+00000a70: 2063 616c 6c61 626c 6520 6f72 2064 6963   callable or dic
+00000a80: 740a 2020 2020 2020 2020 4465 6669 6e65  t.        Define
+00000a90: 7320 7468 6520 4861 6d69 6c74 6f6e 6961  s the Hamiltonia
+00000aa0: 6e20 746f 2062 6520 6e6f 726d 616c 697a  n to be normaliz
+00000ab0: 6564 2e20 0a20 2020 2020 2020 2049 2920  ed. .        I) 
+00000ac0: 4966 2048 2069 7320 6361 6c6c 6162 6c65  If H is callable
+00000ad0: 2c20 7468 656e 2061 2074 7261 6e73 666f  , then a transfo
+00000ae0: 726d 6174 696f 6e20 746f 2063 6f6d 706c  rmation to compl
+00000af0: 6578 206e 6f72 6d61 6c20 666f 726d 2069  ex normal form i
+00000b00: 7320 7065 7266 6f72 6d65 6420 7072 696f  s performed prio
+00000b10: 7220 746f 0a20 2020 2020 2020 2020 2020  r to.           
+00000b20: 6170 706c 7969 6e67 2074 6865 2067 656e  applying the gen
+00000b30: 6572 616c 2061 6c67 6f72 6974 686d 2e0a  eral algorithm..
+00000b40: 2020 2020 2020 2020 4949 2920 4966 2048          II) If H
+00000b50: 2069 7320 6120 6469 6374 696f 6e61 7279   is a dictionary
+00000b60: 2028 652e 672e 2066 726f 6d20 706f 6c79   (e.g. from poly
+00000b70: 2e69 7465 6d73 2829 292c 2074 6865 6e20  .items()), then 
+00000b80: 6974 7320 6f66 662d 6469 6167 6f6e 616c  its off-diagonal
+00000b90: 2065 6e74 7269 6573 0a20 2020 2020 2020   entries.       
+00000ba0: 2020 2020 2061 7265 2069 676e 6f72 6564       are ignored
+00000bb0: 2028 736f 2069 7420 6973 2061 7373 756d   (so it is assum
+00000bc0: 6564 2074 6861 7420 4820 6861 7320 616c  ed that H has al
+00000bd0: 7265 6164 7920 6265 656e 2070 7265 7061  ready been prepa
+00000be0: 7265 6420 746f 2062 6520 696e 2066 6972  red to be in fir
+00000bf0: 7374 2d6f 7264 6572 0a20 2020 2020 2020  st-order.       
+00000c00: 2020 2020 206e 6f72 6d61 6c20 666f 726d       normal form
+00000c10: 292e 0a20 2020 2020 2020 2020 2020 2020  )..             
+00000c20: 2020 200a 2020 2020 6f72 6465 723a 2069     .    order: i
+00000c30: 6e74 0a20 2020 2020 2020 2054 6865 206f  nt.        The o
+00000c40: 7264 6572 2075 7020 746f 2077 6869 6368  rder up to which
+00000c50: 2077 6520 6275 696c 6420 7468 6520 6e6f   we build the no
+00000c60: 726d 616c 2066 6f72 6d2e 2048 6572 6520  rmal form. Here 
+00000c70: 6f72 6465 7220 3d20 6b20 6d65 616e 7320  order = k means 
+00000c80: 7468 6174 2077 6520 636f 6d70 7574 650a  that we compute.
+00000c90: 2020 2020 2020 2020 6b20 686f 6d6f 6765          k homoge
+00000ca0: 6e65 6f75 7320 4c69 652d 706f 6c79 6e6f  neous Lie-polyno
+00000cb0: 6d69 616c 732c 2077 6865 7265 2074 6865  mials, where the
+00000cc0: 2073 6d61 6c6c 6573 7420 6f6e 6520 7769   smallest one wi
+00000cd0: 6c6c 2068 6176 6520 706f 7765 7220 6b20  ll have power k 
+00000ce0: 2b20 3220 616e 6420 7468 6520 0a20 2020  + 2 and the .   
+00000cf0: 2020 2020 2073 7563 6365 6564 696e 6720       succeeding 
+00000d00: 6f6e 6573 2077 696c 6c20 6861 7665 2069  ones will have i
+00000d10: 6e63 7265 6173 6564 2070 6f77 6572 7320  ncreased powers 
+00000d20: 6279 2031 2e0a 2020 2020 0a20 2020 2063  by 1..    .    c
+00000d30: 6d70 6c78 3a20 626f 6f6c 6561 6e2c 206f  mplx: boolean, o
+00000d40: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00000d50: 4966 2066 616c 7365 2c20 6173 7375 6d65  If false, assume
+00000d60: 2074 6861 7420 7468 6520 636f 6566 6669   that the coeffi
+00000d70: 6369 656e 7473 206f 6620 7468 6520 7365  cients of the se
+00000d80: 636f 6e64 2d6f 7264 6572 2074 6572 6d73  cond-order terms
+00000d90: 206f 6620 7468 6520 4861 6d69 6c74 6f6e   of the Hamilton
+00000da0: 6961 6e20 6172 6520 7265 616c 2e0a 2020  ian are real..  
+00000db0: 2020 2020 2020 496e 2074 6869 7320 6361        In this ca
+00000dc0: 7365 2061 2063 6865 636b 2077 696c 6c20  se a check will 
+00000dd0: 6265 2064 6f6e 6520 616e 6420 616e 2065  be done and an e
+00000de0: 7272 6f72 2077 696c 6c20 6265 2072 6169  rror will be rai
+00000df0: 7365 6420 6966 2074 6861 7420 6973 206e  sed if that is n
+00000e00: 6f74 2074 6865 2063 6173 652e 0a20 2020  ot the case..   
+00000e10: 2020 2020 200a 2020 2020 746f 6c5f 6472       .    tol_dr
+00000e20: 6f70 3a20 666c 6f61 742c 206f 7074 696f  op: float, optio
+00000e30: 6e61 6c0a 2020 2020 2020 2020 546f 6c65  nal.        Tole
+00000e40: 7261 6e63 6520 6265 6c6f 7720 7768 6963  rance below whic
+00000e50: 6820 7661 6c75 6573 2069 6e20 7468 6520  h values in the 
+00000e60: 4861 6d69 6c74 6f6e 6961 6e20 6172 6520  Hamiltonian are 
+00000e70: 7365 7420 746f 207a 6572 6f2e 0a20 2020  set to zero..   
+00000e80: 2020 2020 200a 2020 2020 746f 6c3a 2066       .    tol: f
+00000e90: 6c6f 6174 2c20 6f70 7469 6f6e 616c 0a20  loat, optional. 
+00000ea0: 2020 2020 2020 2054 6f6c 6572 616e 6365         Tolerance
+00000eb0: 2066 6f72 2063 6f6e 7369 7374 656e 6379   for consistency
+00000ec0: 2063 6865 636b 732e 0a20 2020 2020 2020   checks..       
+00000ed0: 200a 2020 2020 2a2a 6b77 6172 6773 0a20   .    **kwargs. 
+00000ee0: 2020 2020 2020 204b 6579 776f 7264 2061         Keyword a
+00000ef0: 7267 756d 656e 7473 2061 7265 2070 6173  rguments are pas
+00000f00: 7365 6420 746f 206c 6965 6f70 732e 6c69  sed to lieops.li
+00000f10: 6e61 6c67 2e6e 662e 6669 7273 745f 6f72  nalg.nf.first_or
+00000f20: 6465 725f 6e66 5f65 7870 616e 7369 6f6e  der_nf_expansion
+00000f30: 2072 6f75 7469 6e65 2e0a 2020 2020 2020   routine..      
+00000f40: 2020 0a20 2020 2052 6574 7572 6e73 0a20    .    Returns. 
+00000f50: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2064     -------.    d
+00000f60: 6963 740a 2020 2020 2020 2020 4120 6469  ict.        A di
+00000f70: 6374 696f 6e61 7279 2077 6974 6820 7468  ctionary with th
+00000f80: 6520 666f 6c6c 6f77 696e 6720 6b65 7973  e following keys
+00000f90: 3a0a 2020 2020 2020 2020 6e66 6469 6374  :.        nfdict
+00000fa0: 203a 2054 6865 206f 7574 7075 7420 6f66   : The output of
+00000fb0: 206c 6965 6f70 732e 6c69 6e61 6c67 2e6e   lieops.linalg.n
+00000fc0: 662e 6669 7273 745f 6f72 6465 725f 6e66  f.first_order_nf
+00000fd0: 5f65 7870 616e 7369 6f6e 2e0a 2020 2020  _expansion..    
+00000fe0: 2020 2020 485f 6675 6e63 203a 2043 616c      H_func : Cal
+00000ff0: 6c61 626c 6520 6465 6e6f 7469 6e67 2074  lable denoting t
+00001000: 6865 2048 616d 696c 746f 6e69 616e 2069  he Hamiltonian i
+00001010: 6e20 2871 2c20 7029 2d63 6f6f 7264 696e  n (q, p)-coordin
+00001020: 6174 6573 2077 686f 7365 2064 6572 6976  ates whose deriv
+00001030: 6174 6976 6573 2077 696c 6c20 6265 2063  atives will be c
+00001040: 616c 6375 6c61 7465 642e 0a20 2020 2020  alculated..     
+00001050: 2020 2048 2020 2020 2020 3a20 4469 6374     H      : Dict
+00001060: 696f 6e61 7279 2064 656e 6f74 696e 6720  ionary denoting 
+00001070: 7468 6520 4861 6d69 6c74 6f6e 6961 6e20  the Hamiltonian 
+00001080: 7573 6564 2061 7420 7468 6520 7374 6172  used at the star
+00001090: 7420 6f66 2074 6865 206e 6f72 6d61 6c20  t of the normal 
+000010a0: 666f 726d 2070 726f 6365 6475 7265 2e0a  form procedure..
+000010b0: 2020 2020 2020 2020 4830 2020 2020 203a          H0     :
+000010c0: 2044 6963 7469 6f6e 6172 7920 6465 6e6f   Dictionary deno
+000010d0: 7469 6e67 2074 6865 2073 6563 6f6e 642d  ting the second-
+000010e0: 6f72 6465 7220 636f 6566 6669 6369 656e  order coefficien
+000010f0: 7473 206f 6620 482e 0a20 2020 2020 2020  ts of H..       
+00001100: 206d 7520 2020 2020 3a20 4c69 7374 206f   mu     : List o
+00001110: 6620 7468 6520 7475 6e65 7320 7573 6564  f the tunes used
+00001120: 2028 636f 6566 6669 6369 656e 7473 206f   (coefficients o
+00001130: 6620 4830 292e 0a20 2020 2020 2020 2063  f H0)..        c
+00001140: 6869 2020 2020 3a20 4c69 7374 206f 6620  hi    : List of 
+00001150: 706f 6c79 206f 626a 6563 7473 2c20 6465  poly objects, de
+00001160: 6e6f 7469 6e67 2074 6865 204c 6965 2d70  noting the Lie-p
+00001170: 6f6c 796e 6f6d 6961 6c73 206f 6620 6465  olynomials of de
+00001180: 6772 6565 203e 3d20 3320 7768 6963 6820  gree >= 3 which 
+00001190: 6d61 7020 746f 206e 6f72 6d61 6c20 666f  map to normal fo
+000011a0: 726d 2e0a 2020 2020 2020 2020 6368 6930  rm..        chi0
+000011b0: 2020 203a 204c 6973 7420 6f66 2074 6865     : List of the
+000011c0: 2074 776f 204c 6965 2d70 6f6c 796e 6f6d   two Lie-polynom
+000011d0: 6961 6c73 206f 6620 6465 6772 6565 2032  ials of degree 2
+000011e0: 2077 6869 6368 206d 6170 2074 6865 2067   which map the g
+000011f0: 6976 656e 2048 616d 696c 746f 6e69 616e  iven Hamiltonian
+00001200: 200a 2020 2020 2020 2020 2020 2020 2020   .              
+00001210: 2020 2074 6f20 6974 7320 6669 7273 742d     to its first-
+00001220: 6f72 6465 7220 6e6f 726d 616c 2066 6f72  order normal for
+00001230: 6d20 6571 7569 7661 6c65 6e74 2e20 5468  m equivalent. Th
+00001240: 6973 206d 6561 6e73 2074 6861 7420 7468  is means that th
+00001250: 6520 6c69 7374 2022 6368 6930 202b 2063  e list "chi0 + c
+00001260: 6869 2220 7065 7266 6f72 6d73 2074 6865  hi" performs the
+00001270: 200a 2020 2020 2020 2020 2020 2020 2020   .              
+00001280: 2020 2065 6e74 6972 6520 6d61 7020 7570     entire map up
+00001290: 2074 6f20 7468 6520 6465 7369 7265 6420   to the desired 
+000012a0: 6f72 6465 7220 2873 6565 2061 6c73 6f20  order (see also 
+000012b0: 7468 6520 6578 616d 706c 6520 6265 6c6f  the example belo
+000012c0: 7729 2e20 4e6f 7420 7375 7070 6f72 7465  w). Not supporte
+000012d0: 6420 6966 206d 706d 6174 6820 6861 7320  d if mpmath has 
+000012e0: 6265 656e 2075 7365 642e 2020 2020 2020  been used.      
+000012f0: 2020 2020 2020 2020 2020 200a 2020 2020             .    
+00001300: 2020 2020 486b 2020 2020 203a 204c 6973      Hk     : Lis
+00001310: 7420 6f66 2070 6f6c 7920 6f62 6a65 6374  t of poly object
+00001320: 732c 2063 6f72 7265 7370 6f6e 6469 6e67  s, corresponding
+00001330: 2074 6f20 7468 6520 7472 616e 7366 6f72   to the transfor
+00001340: 6d65 6420 4861 6d69 6c74 6f6e 6961 6e73  med Hamiltonians
+00001350: 2e0a 2020 2020 2020 2020 5a6b 2020 2020  ..        Zk    
+00001360: 203a 204c 6973 7420 6f66 2070 6f6c 7920   : List of poly 
+00001370: 6f62 6a65 6374 732c 206e 6f74 6174 696f  objects, notatio
+00001380: 6e20 7365 6520 4c65 6d2e 2031 2e34 2e35  n see Lem. 1.4.5
+00001390: 2e20 696e 2052 6566 2e20 5b31 5d2e 200a  . in Ref. [1]. .
+000013a0: 2020 2020 2020 2020 516b 2020 2020 203a          Qk     :
+000013b0: 204c 6973 7420 6f66 2070 6f6c 7920 6f62   List of poly ob
+000013c0: 6a65 6374 732c 206e 6f74 6174 696f 6e20  jects, notation 
+000013d0: 7365 6520 4c65 6d2e 2031 2e34 2e35 2e20  see Lem. 1.4.5. 
+000013e0: 696e 2052 6566 2e20 5b31 5d2e 0a20 2020  in Ref. [1]..   
+000013f0: 2020 2020 200a 2020 2020 4578 616d 706c       .    Exampl
+00001400: 650a 2020 2020 2d2d 2d2d 2d2d 2d20 2020  e.    -------   
+00001410: 2020 200a 2020 2020 6e66 6469 6374 203d     .    nfdict =
+00001420: 2048 312e 626e 6628 6f72 6465 723d 3429   H1.bnf(order=4)
+00001430: 0a20 2020 2077 203d 2048 312e 636f 7079  .    w = H1.copy
+00001440: 2829 0a20 2020 2066 6f72 2063 2069 6e20  ().    for c in 
+00001450: 6e66 6469 6374 5b27 6368 6930 275d 202b  nfdict['chi0'] +
+00001460: 206e 6664 6963 745b 2763 6869 275d 3a0a   nfdict['chi']:.
+00001470: 2020 2020 2020 2020 7720 3d20 632e 6c65          w = c.le
+00001480: 7870 2870 6f77 6572 3d31 3029 2877 290a  xp(power=10)(w).
+00001490: 2020 2020 2020 2020 7072 696e 7420 2877          print (w
+000014a0: 2e61 626f 7665 2831 652d 3132 2929 2023  .above(1e-12)) #
+000014b0: 2065 7861 6d70 6c65 0a0a 2020 2020 5265   example..    Re
+000014c0: 6665 7265 6e63 6573 0a20 2020 202d 2d2d  ferences.    ---
+000014d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 5b31 5d3a  -------.    [1]:
+000014e0: 204d 2e20 5469 747a 653a 2022 5370 6163   M. Titze: "Spac
+000014f0: 6520 4368 6172 6765 204d 6f64 656c 696e  e Charge Modelin
+00001500: 6720 6174 2074 6865 2049 6e74 6567 6572  g at the Integer
+00001510: 2052 6573 6f6e 616e 6365 2066 6f72 2074   Resonance for t
+00001520: 6865 2043 4552 4e20 5053 2061 6e64 2053  he CERN PS and S
+00001530: 5053 222c 2050 6844 2054 6865 7369 7320  PS", PhD Thesis 
+00001540: 2832 3031 3929 2e0a 2020 2020 5b32 5d3a  (2019)..    [2]:
+00001550: 2042 2e20 4772 6562 6572 742e 2022 4269   B. Grebert. "Bi
+00001560: 726b 686f 6666 206e 6f72 6d61 6c20 666f  rkhoff normal fo
+00001570: 726d 2061 6e64 2048 616d 696c 746f 6e69  rm and Hamiltoni
+00001580: 616e 2050 4445 7322 2e20 2832 3030 3629  an PDEs". (2006)
+00001590: 0a20 2020 20e9 0200 0000 da09 6d61 785f  .    .......max_
+000015a0: 706f 7765 72da 0570 6f77 6572 da08 5f5f  power..power..__
+000015b0: 6361 6c6c 5f5f 2901 da08 746f 6c5f 6472  call__)...tol_dr
+000015c0: 6f70 da03 746f 6c63 0100 0000 0000 0000  op..tolc........
+000015d0: 0000 0000 0200 0000 0500 0000 1300 0000  ................
+000015e0: 7328 0000 0067 007c 005d 107d 017c 0188  s(...g.|.].}.|..
+000015f0: 016b 0372 107c 0188 0188 0017 006b 0372  .k.r.|.......k.r
+00001600: 1064 006e 0164 0191 0271 0253 0029 0272  .d.n.d...q.S.).r
+00001610: 0100 0000 7220 0000 0072 0800 0000 7209  ....r ...r....r.
+00001620: 0000 0029 0272 0700 0000 da01 6a72 0800  ...).r......jr..
+00001630: 0000 7210 0000 0072 1100 0000 9300 0000  ..r....r........
+00001640: 7302 0000 0028 007a 1762 6e66 2e3c 6c6f  s....(.z.bnf.<lo
+00001650: 6361 6c73 3e2e 3c6c 6973 7463 6f6d 703e  cals>.<listcomp>
+00001660: 7a18 496d 6167 696e 6172 7920 7061 7274  z.Imaginary part
+00001670: 206f 6620 656e 7472 7920 7a12 2061 626f   of entry z. abo
+00001680: 7665 2074 6f6c 6572 616e 6365 3a20 7a04  ve tolerance: z.
+00001690: 203e 3d20 7a27 2e20 4368 6563 6b20 696e   >= z'. Check in
+000016a0: 7075 7420 6f72 2074 7279 2063 6d70 6c78  put or try cmplx
+000016b0: 3d54 7275 6520 6f70 7469 6f6e 2e29 0372  =True option.).r
+000016c0: 0600 0000 7207 0000 0072 2400 0000 6301  ....r....r$...c.
+000016d0: 0000 0000 0000 0000 0000 0003 0000 0004  ................
+000016e0: 0000 0013 0000 0073 3200 0000 6900 7c00  .......s2...i.|.
+000016f0: 5d15 5c02 7d01 7d02 7400 7c01 8301 6400  ].\.}.}.t.|...d.
+00001700: 6b02 7202 7401 7c02 8301 8800 6b05 a002  k.r.t.|.....k...
+00001710: a100 7202 7c01 7c02 9302 7102 5300 a901  ..r.|.|...q.S...
+00001720: 7223 0000 0029 0372 1700 0000 da03 6162  r#...).r......ab
+00001730: 73da 0361 6c6c a903 720a 0000 0072 0b00  s..all..r....r..
+00001740: 0000 da01 7629 0172 2800 0000 7208 0000  ....v).r(...r...
+00001750: 0072 1000 0000 da0a 3c64 6963 7463 6f6d  .r......<dictcom
+00001760: 703e 9e00 0000 7302 0000 0032 007a 1762  p>....s....2.z.b
+00001770: 6e66 2e3c 6c6f 6361 6c73 3e2e 3c64 6963  nf.<locals>.<dic
+00001780: 7463 6f6d 703e 7201 0000 0063 0100 0000  tcomp>r....c....
+00001790: 0000 0000 0000 0000 0300 0000 0400 0000  ................
+000017a0: 5300 0000 7322 0000 0069 007c 005d 0d5c  S...s"...i.|.].\
+000017b0: 027d 017d 0274 007c 0183 0164 006b 0472  .}.}.t.|...d.k.r
+000017c0: 027c 017c 0293 0271 0253 0072 2a00 0000  .|.|...q.S.r*...
+000017d0: 2901 7217 0000 0072 2d00 0000 7208 0000  ).r....r-...r...
+000017e0: 0072 0800 0000 7210 0000 0072 2f00 0000  .r....r....r/...
+000017f0: a400 0000 7302 0000 0022 0029 0272 0700  ....s....".).r..
+00001800: 0000 7224 0000 00e9 0300 0000 7220 0000  ..r$........r ..
+00001810: 0029 0372 0e00 0000 720d 0000 0072 2400  .).r....r....r$.
+00001820: 0000 2901 7225 0000 00da 066e 6664 6963  ..).r%.....nfdic
+00001830: 74da 0148 5a06 485f 6675 6e63 da02 4830  t..HZ.H_func..H0
+00001840: 720e 0000 005a 086c 6368 695f 696e 7672  r....Z.lchi_invr
+00001850: 1b00 0000 da02 486b da02 5a6b da02 516b  ......Hk..Zk..Qk
+00001860: 7222 0000 00da 086c 6f5f 706f 7765 725a  r".....lo_powerZ
+00001870: 0463 6869 3029 02da 0243 31da 0243 3229  .chi0)...C1..C2)
+00001880: 1dda 0367 6574 da07 6861 7361 7474 72da  ...get..hasattr.
+00001890: 0a69 7369 6e73 7461 6e63 6572 1200 0000  .isinstancer....
+000018a0: 7213 0000 0072 1400 0000 7215 0000 0072  r....r....r....r
+000018b0: 0200 0000 7203 0000 0072 1900 0000 da04  ....r....r......
+000018c0: 6e65 7874 da04 6974 6572 7218 0000 00da  next..iterr.....
+000018d0: 0574 7570 6c65 da03 706f 70da 0469 6d61  .tuple..pop..ima
+000018e0: 67da 0472 6561 6cda 0661 7070 656e 6472  g..real..appendr
+000018f0: 1600 0000 da06 7570 6461 7465 da10 686f  ......update..ho
+00001900: 6d6f 6765 6e65 6f75 735f 7061 7274 da04  mogeneous_part..
+00001910: 636f 7079 721f 0000 00da 046c 6578 70da  copyr......lexp.
+00001920: 046b 6579 7372 0400 0000 da09 7472 616e  .keysr......tran
+00001930: 7370 6f73 65da 066d 6174 7269 7872 0500  spose..matrixr..
+00001940: 0000 2922 7232 0000 0072 2200 0000 7227  ..)"r2...r"...r'
+00001950: 0000 0072 2800 0000 da05 636d 706c 7872  ...r(.....cmplxr
+00001960: 1a00 0000 7225 0000 0072 2400 0000 7237  ....r%...r$...r7
+00001970: 0000 005a 0448 696e 70da 0d74 6179 6c6f  ...Z.Hinp..taylo
+00001980: 725f 636f 6566 6673 7231 0000 00da 0464  r_coeffsr1.....d
+00001990: 696d 325a 0948 305f 7661 6c75 6573 720e  im2Z.H0_valuesr.
+000019a0: 0000 00da 0374 706c da03 6d75 6a72 3300  .....tpl..mujr3.
+000019b0: 0000 7235 0000 00da 0250 6b72 3400 0000  ..r5.....Pkr4...
+000019c0: da07 6368 695f 616c 6cda 0648 6b5f 616c  ..chi_all..Hk_al
+000019d0: 6cda 065a 6b5f 616c 6cda 0651 6b5f 616c  l..Zk_all..Qk_al
+000019e0: 6c5a 086c 6368 695f 616c 6c72 0b00 0000  lZ.lchi_allr....
+000019f0: 721b 0000 0072 1c00 0000 5a04 6c63 6869  r....r....Z.lchi
+00001a00: da03 6f75 745a 0663 6c61 6265 6cda 0143  ..outZ.clabel..C
+00001a10: da02 4370 7208 0000 0029 0372 0700 0000  ..Cpr....).r....
+00001a20: 7229 0000 0072 2800 0000 7210 0000 00da  r)...r(...r.....
+00001a30: 0362 6e66 2e00 0000 738a 0000 0008 4110  .bnf....s.....A.
+00001a40: 0110 010a 0608 0204 0110 010c 041a 0104  ................
+00001a50: 0504 0110 0608 0104 0304 010c 011c 0108  ................
+00001a60: 010a 0204 0128 0206 0108 010c 0114 0122  .....(........."
+00001a70: 0118 0612 070a 0108 010c 020a 0104 0112  ................
+00001a80: 0112 010c 0104 0214 0108 010e 0208 010a  ................
+00001a90: 020c 010a 010a 010c 0104 0308 0108 0108  ................
+00001aa0: 0108 0108 0108 0108 0108 0108 0108 0108  ................
+00001ab0: 0108 0108 0108 0208 010e 0108 020e 0108  ................
+00001ac0: 010e 0104 8004 0272 5800 0000 2904 7220  .......rX...).r 
+00001ad0: 0000 0072 0100 0000 7221 0000 0054 290d  ...r....r!...T).
+00001ae0: 5a0f 6c69 656f 7073 2e63 6f72 652e 6c69  Z.lieops.core.li
+00001af0: 6572 1200 0000 5a14 6c69 656f 7073 2e73  er....Z.lieops.s
+00001b00: 6f6c 7665 722e 636f 6d6d 6f6e 7202 0000  olver.commonr...
+00001b10: 00da 106c 6965 6f70 732e 6c69 6e61 6c67  ...lieops.linalg
+00001b20: 2e6e 6672 0300 0000 da14 6c69 656f 7073  .nfr......lieops
+00001b30: 2e6c 696e 616c 672e 6d61 7472 6978 7204  .linalg.matrixr.
+00001b40: 0000 00da 116c 6965 6f70 732e 636f 7265  .....lieops.core
+00001b50: 2e74 6f6f 6c73 7205 0000 0072 1f00 0000  .toolsr....r....
+00001b60: da03 696e 7472 5800 0000 7208 0000 0072  ..intrX...r....r
+00001b70: 0800 0000 7208 0000 0072 1000 0000 da08  ....r....r......
+00001b80: 3c6d 6f64 756c 653e 0100 0000 730e 0000  <module>....s...
+00001b90: 0008 000c 010c 010c 010c 0108 0214 27    ..............'
```

### Comparing `lieops-0.2.1/lieops/core/__pycache__/dragt.cpython-310.pyc` & `lieops-0.2.2/lieops/core/__pycache__/dragt.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.10, timestamp-based, .py timestamp: Sun Feb 19 12:04:00 2023 UTC, .py size: 17900 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 16% similar despite different names*

```diff
@@ -1,704 +1,741 @@
-00000000: 6f0d 0d0a 0000 0000 3010 f263 ec45 0000  o.......0..c.E..
+00000000: 6f0d 0d0a 0000 0000 6d8e 3964 c349 0000  o.......m.9d.I..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 000a 0000 0040 0000 0073 a800 0000 6400  .....@...s....d.
+00000020: 000a 0000 0040 0000 0073 dc00 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a01 6400 6402 6c02 6d03 5a03  d.l.Z.d.d.l.m.Z.
 00000040: 6d04 5a04 0100 6400 6403 6c05 6d05 5a05  m.Z...d.d.l.m.Z.
 00000050: 0100 6400 6401 6c06 5a06 6400 6404 6c07  ..d.d.l.Z.d.d.l.
 00000060: 6d08 5a08 0100 6400 6405 6c09 6d0a 5a0a  m.Z...d.d.l.m.Z.
-00000070: 0100 6400 6406 6c0b 6d0c 5a0c 6d0d 5a0d  ..d.d.l.m.Z.m.Z.
-00000080: 0100 6400 6407 6c0e 6d0f 5a0f 6d10 5a10  ..d.d.l.m.Z.m.Z.
-00000090: 6d11 5a11 0100 6408 6512 6602 6409 640a  m.Z...d.e.f.d.d.
-000000a0: 8404 5a13 640b 640c 8400 5a14 640d 640e  ..Z.d.d...Z.d.d.
-000000b0: 8400 5a15 640f 6700 6410 6411 6412 6400  ..Z.d.g.d.d.d.d.
-000000c0: 6413 6413 6411 6414 9c09 6415 6416 8402  d.d.d.d...d.d...
-000000d0: 5a16 6401 5300 2917 e900 0000 004e 2902  Z.d.S.)......N).
-000000e0: da04 6578 706d da04 6c6f 676d 2901 da04  ..expm..logm)...
-000000f0: 7471 646d 2901 da08 6372 6561 7465 5f4a  tqdm)...create_J
-00000100: 2901 da07 7379 6d6c 6f67 7329 02da 0d63  )...symlogs)...c
-00000110: 7265 6174 655f 636f 6f72 6473 da04 6c65  reate_coords..le
-00000120: 7870 2903 da0a 636f 6e73 7432 706f 6c79  xp)...const2poly
-00000130: da08 706f 6c79 3276 6563 da07 6164 3270  ..poly2vec..ad2p
-00000140: 6f6c 79da 016b 6302 0000 0000 0000 0000  oly..kc.........
-00000150: 0000 0007 0000 0005 0000 0043 0000 0073  ...........C...s
-00000160: 6400 0000 6900 7d02 7c00 6a00 7d03 7c00  d...i.}.|.j.}.|.
-00000170: a001 a100 4400 5d1f 5c02 7d04 7d05 6401  ....D.].\.}.}.d.
-00000180: 6402 8400 7c04 4400 8301 7d06 7c06 7c01  d...|.D...}.|.|.
-00000190: 0500 1900 6403 3700 0300 3c00 7c05 7402  ....d.7...<.|.t.
-000001a0: 7c04 8301 6403 1700 1b00 7c02 7403 7c06  |...d.....|.t.|.
-000001b0: 8301 3c00 7109 7c00 6a04 7c02 7c03 7c00  ..<.q.|.j.|.|.|.
-000001c0: 6a05 6404 8d03 5300 2905 7a85 0a20 2020  j.d...S.).z..   
-000001d0: 204c 6574 2070 2062 6520 6120 4c69 6520   Let p be a Lie 
-000001e0: 706f 6c79 6e6f 6d69 616c 2e20 5468 656e  polynomial. Then
-000001f0: 2074 6869 7320 726f 7574 696e 6520 7769   this routine wi
-00000200: 6c6c 0a20 2020 2063 6f6d 7075 7465 2074  ll.    compute t
-00000210: 6865 2069 6e74 6567 7261 6c20 6f66 2070  he integral of p
-00000220: 2a64 7a5f 6b2c 2077 6865 7265 207a 5f6b  *dz_k, where z_k
-00000230: 2064 656e 6f74 6573 2074 6865 206b 2d74   denotes the k-t
-00000240: 6820 636f 6d70 6f6e 656e 742e 0a20 2020  h component..   
-00000250: 2063 0100 0000 0000 0000 0000 0000 0200   c..............
-00000260: 0000 0300 0000 5300 0000 7310 0000 0067  ......S...s....g
-00000270: 007c 005d 047d 017c 0191 0271 0253 00a9  .|.].}.|...q.S..
-00000280: 0072 0d00 0000 2902 da02 2e30 da01 7072  .r....)....0..pr
-00000290: 0d00 0000 720d 0000 00fa 522f 686f 6d65  ....r.....R/home
-000002a0: 2f6d 616c 7465 2f6d 696e 6963 6f6e 6461  /malte/miniconda
-000002b0: 332f 656e 7673 2f77 6f72 6b2f 6c69 622f  3/envs/work/lib/
-000002c0: 7079 7468 6f6e 332e 3130 2f73 6974 652d  python3.10/site-
-000002d0: 7061 636b 6167 6573 2f6c 6965 6f70 732f  packages/lieops/
-000002e0: 636f 7265 2f64 7261 6774 2e70 79da 0a3c  core/dragt.py..<
-000002f0: 6c69 7374 636f 6d70 3e13 0000 0073 0200  listcomp>....s..
-00000300: 0000 1000 7a20 5f69 6e74 6567 7261 7465  ....z _integrate
-00000310: 5f6b 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973  _k.<locals>.<lis
-00000320: 7463 6f6d 703e e901 0000 0029 03da 0676  tcomp>.....)...v
-00000330: 616c 7565 73da 0364 696d da09 6d61 785f  alues..dim..max_
-00000340: 706f 7765 7229 0672 1400 0000 da05 6974  power).r......it
-00000350: 656d 73da 0373 756d da05 7475 706c 65da  ems..sum..tuple.
-00000360: 095f 5f63 6c61 7373 5f5f 7215 0000 0029  .__class__r....)
-00000370: 0772 0f00 0000 720c 0000 00da 0f69 6e74  .r....r......int
-00000380: 6567 7261 6c5f 7661 6c75 6573 7214 0000  egral_valuesr...
-00000390: 00da 0670 6f77 6572 7372 1300 0000 5a0a  ...powersr....Z.
-000003a0: 706f 7765 7273 5f61 6464 720d 0000 0072  powers_addr....r
-000003b0: 0d00 0000 7210 0000 00da 0c5f 696e 7465  ....r......_inte
-000003c0: 6772 6174 655f 6b0b 0000 0073 0e00 0000  grate_k....s....
-000003d0: 0405 0601 1001 0e01 1001 1a01 1201 721c  ..............r.
-000003e0: 0000 0063 0000 0000 0000 0000 0000 0000  ...c............
-000003f0: 0200 0000 0500 0000 0700 0000 7328 0000  ............s(..
-00000400: 0088 0064 0119 006a 007d 0174 0187 0066  ...d...j.}.t...f
-00000410: 0164 0264 0384 0874 027c 0164 0414 0083  .d.d...t.|.d....
-00000420: 0144 0083 0183 0153 0029 057a 750a 2020  .D.....S.).zu.  
-00000430: 2020 4c65 7420 705f 312c 202e 2e2e 2c20    Let p_1, ..., 
-00000440: 705f 6e20 6265 2073 6f6d 6520 4c69 6520  p_n be some Lie 
-00000450: 706f 6c79 6e6f 6d69 616c 732e 0a20 2020  polynomials..   
-00000460: 2054 6865 6e20 7468 6973 2072 6f75 7469   Then this routi
-00000470: 6e65 2077 696c 6c20 636f 6d70 7574 6520  ne will compute 
-00000480: 7468 6520 286c 696e 6529 2069 6e74 6567  the (line) integ
-00000490: 7261 6c20 705f 6b2a 647a 5f6b 2e0a 2020  ral p_k*dz_k..  
-000004a0: 2020 7201 0000 0063 0100 0000 0000 0000    r....c........
-000004b0: 0000 0000 0200 0000 0500 0000 1300 0000  ................
-000004c0: 731a 0000 0067 007c 005d 097d 0174 0088  s....g.|.].}.t..
-000004d0: 007c 0119 007c 0183 0291 0271 0253 0072  .|...|.....q.S.r
-000004e0: 0d00 0000 2901 721c 0000 00a9 0272 0e00  ....).r......r..
-000004f0: 0000 720c 0000 00a9 0172 0f00 0000 720d  ..r......r....r.
-00000500: 0000 0072 1000 0000 7211 0000 001e 0000  ...r....r.......
-00000510: 0073 0200 0000 1a00 7a1e 5f69 6e74 6567  .s......z._integ
-00000520: 7261 7465 2e3c 6c6f 6361 6c73 3e2e 3c6c  rate.<locals>.<l
-00000530: 6973 7463 6f6d 703e e902 0000 0029 0372  istcomp>.....).r
-00000540: 1400 0000 7217 0000 00da 0572 616e 6765  ....r......range
-00000550: 2902 720f 0000 0072 1400 0000 720d 0000  ).r....r....r...
-00000560: 0072 1e00 0000 7210 0000 00da 0a5f 696e  .r....r......_in
-00000570: 7465 6772 6174 6518 0000 0073 0400 0000  tegrate....s....
-00000580: 0a05 1e01 7221 0000 0063 0000 0000 0000  ....r!...c......
-00000590: 0000 0000 0000 0300 0000 0400 0000 0700  ................
-000005a0: 0000 735c 0000 0088 0264 0119 006a 007d  ..s\.....d...j.}
-000005b0: 017c 0164 0214 0089 0174 0188 0283 0188  .|.d.....t......
-000005c0: 016b 0273 114a 0082 0188 0264 0119 006a  .k.s.J.....d...j
-000005d0: 027d 0274 037c 0183 01a0 04a1 0089 0074  .}.t.|.........t
-000005e0: 0587 0087 0187 0266 0364 0364 0484 0874  .......f.d.d...t
-000005f0: 0688 0183 0144 0083 018e 000b 007c 021b  .....D.......|..
-00000600: 0053 0029 0561 0e04 0000 0a20 2020 204c  .S.).a.....    L
-00000610: 6574 2067 5f31 2c20 2e2e 2e2c 2067 5f6e  et g_1, ..., g_n
-00000620: 2062 6520 4c69 6520 706f 6c79 6e6f 6d69   be Lie polynomi
-00000630: 616c 7320 616e 6420 7a5f 6a20 7468 6520  als and z_j the 
-00000640: 636f 6f72 6469 6e61 7465 7320 2869 6e20  coordinates (in 
-00000650: 6f75 7220 7365 7474 696e 6720 636f 6d70  our setting comp
-00000660: 6c65 7820 7869 2f65 7461 2d63 6f6f 7264  lex xi/eta-coord
-00000670: 696e 6174 6573 292c 0a20 2020 2073 6174  inates),.    sat
-00000680: 6973 6679 696e 670a 2020 2020 7b67 5f69  isfying.    {g_i
-00000690: 2c20 7a5f 6a7d 203d 207b 675f 6a2c 207a  , z_j} = {g_j, z
-000006a0: 5f69 7d2e 2020 2020 2831 290a 2020 2020  _i}.    (1).    
-000006b0: 4265 6361 7573 6520 7468 6520 4c69 6520  Because the Lie 
-000006c0: 706f 6c79 6e6f 6d69 616c 7320 6172 6520  polynomials are 
-000006d0: 616e 616c 7974 6963 2066 756e 6374 696f  analytic functio
-000006e0: 6e73 2062 7920 636f 6e73 7472 7563 7469  ns by constructi
-000006f0: 6f6e 2c20 7468 6572 6520 6d75 7374 2065  on, there must e
-00000700: 7869 7374 2061 200a 2020 2020 706f 7465  xist a .    pote
-00000710: 6e74 6961 6c20 4820 2848 616d 696c 746f  ntial H (Hamilto
-00000720: 6e69 616e 2920 736f 2074 6861 740a 2020  nian) so that.  
-00000730: 2020 675f 6a20 3d20 7b48 2c20 7a5f 6a7d    g_j = {H, z_j}
-00000740: 2020 2020 2028 3229 0a20 2020 2068 6f6c       (2).    hol
-00000750: 6473 2e20 5468 6973 2069 7320 7468 6520  ds. This is the 
-00000760: 2773 796d 706c 6563 7469 6327 2076 6172  'symplectic' var
-00000770: 6961 6e74 206f 6620 7468 6520 506f 696e  iant of the Poin
-00000780: 6361 7265 204c 656d 6d61 2e0a 2020 2020  care Lemma..    
-00000790: 4f62 7669 6f75 736c 792c 2074 6865 2064  Obviously, the d
-000007a0: 6567 7265 6520 6f66 2048 2069 7320 7468  egree of H is th
-000007b0: 656e 2067 6976 656e 2062 7920 6d61 7828  en given by max(
-000007c0: 5b64 6567 2867 5f6a 2920 666f 7220 6a20  [deg(g_j) for j 
-000007d0: 696e 2031 2c20 2e2e 2e2c 206e 5d29 202b  in 1, ..., n]) +
-000007e0: 2031 2e0a 2020 2020 0a20 2020 2057 6520   1..    .    We 
-000007f0: 7368 616c 6c20 666f 6c6c 6f77 2074 6865  shall follow the
-00000800: 2073 7465 7073 206f 7574 6c69 6e65 6420   steps outlined 
-00000810: 696e 2052 6566 2e20 5b31 5d2c 204c 656d  in Ref. [1], Lem
-00000820: 6d61 2036 2e32 2069 6e20 5365 6374 696f  ma 6.2 in Sectio
-00000830: 6e20 3720 2846 6163 746f 7269 7a61 7469  n 7 (Factorizati
-00000840: 6f6e 2054 6865 6f72 656d 292e 0a20 2020  on Theorem)..   
-00000850: 200a 2020 2020 5061 7261 6d65 7465 7273   .    Parameters
-00000860: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-00000870: 2020 2020 673a 2070 6f6c 790a 2020 2020      g: poly.    
-00000880: 2020 2020 4f6e 6520 6f72 206d 6f72 6520      One or more 
-00000890: 4c69 6520 706f 6c79 6e6f 6d69 616c 7320  Lie polynomials 
-000008a0: 6861 7669 6e67 2070 726f 7065 7274 7920  having property 
-000008b0: 2831 2920 6162 6f76 6520 2857 6172 6e69  (1) above (Warni
-000008c0: 6e67 3a20 4e6f 2063 6865 636b 2061 6761  ng: No check aga
-000008d0: 696e 7374 2074 6869 7320 7072 6f70 6572  inst this proper
-000008e0: 7479 2068 6572 652e 290a 2020 2020 2020  ty here.).      
-000008f0: 2020 0a20 2020 2052 6574 7572 6e73 0a20    .    Returns. 
-00000900: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2070     -------.    p
-00000910: 6f6c 790a 2020 2020 2020 2020 4120 4c69  oly.        A Li
-00000920: 6520 706f 6c79 6e6f 6d69 616c 2048 2073  e polynomial H s
-00000930: 6174 6973 6679 696e 6720 4571 2e20 2832  atisfying Eq. (2
-00000940: 2920 6162 6f76 652e 0a20 2020 200a 2020  ) above..    .  
-00000950: 2020 5265 6665 7265 6e63 6573 0a20 2020    References.   
-00000960: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00000970: 5b31 5d20 412e 2044 7261 6774 3a20 224c  [1] A. Dragt: "L
-00000980: 6965 204d 6574 686f 6473 2066 6f72 204e  ie Methods for N
-00000990: 6f6e 6c69 6e65 6172 2044 796e 616d 6963  onlinear Dynamic
-000009a0: 7320 7769 7468 2041 7070 6c69 6361 7469  s with Applicati
-000009b0: 6f6e 7320 746f 2041 6363 656c 6572 6174  ons to Accelerat
-000009c0: 6f72 2050 6879 7369 6373 222c 2055 6e69  or Physics", Uni
-000009d0: 7665 7273 6974 7920 6f66 204d 6172 796c  versity of Maryl
-000009e0: 616e 642c 2032 3032 302c 0a20 2020 2020  and, 2020,.     
-000009f0: 2020 2068 7474 703a 2f2f 7777 772e 7068     http://www.ph
-00000a00: 7973 6963 732e 756d 642e 6564 752f 6473  ysics.umd.edu/ds
-00000a10: 6174 2f0a 2020 2020 7201 0000 0072 1f00  at/.    r....r..
-00000a20: 0000 6301 0000 0000 0000 0000 0000 0001  ..c.............
-00000a30: 0000 0006 0000 0013 0000 0073 2a00 0000  ...........s*...
-00000a40: 6700 7c00 5d11 8900 7400 8701 8703 8700  g.|.]...t.......
-00000a50: 6603 6400 6401 8408 7401 8802 8301 4400  f.d.d...t.....D.
-00000a60: 8301 8301 9102 7102 5300 2902 6301 0000  ......q.S.).c...
-00000a70: 0000 0000 0000 0000 0002 0000 0006 0000  ................
-00000a80: 0013 0000 0073 2000 0000 6700 7c00 5d0c  .....s ...g.|.].
-00000a90: 7d01 8801 7c01 1900 8800 8802 7c01 6602  }...|.......|.f.
-00000aa0: 1900 1400 9102 7102 5300 720d 0000 0072  ......q.S.r....r
-00000ab0: 0d00 0000 721d 0000 0029 03da 044a 696e  ....r....)...Jin
-00000ac0: 76da 0167 da01 6c72 0d00 0000 7210 0000  v..g..lr....r...
-00000ad0: 0072 1100 0000 4700 0000 f302 0000 0020  .r....G........ 
-00000ae0: 007a 2a73 796d 706f 696e 6361 7265 2e3c  .z*sympoincare.<
-00000af0: 6c6f 6361 6c73 3e2e 3c6c 6973 7463 6f6d  locals>.<listcom
-00000b00: 703e 2e3c 6c69 7374 636f 6d70 3ea9 0272  p>.<listcomp>..r
-00000b10: 1700 0000 7220 0000 00a9 0172 0e00 0000  ....r .....r....
-00000b20: a903 7222 0000 00da 0464 696d 3272 2300  ..r".....dim2r#.
-00000b30: 0000 a901 7224 0000 0072 1000 0000 7211  ....r$...r....r.
-00000b40: 0000 0047 0000 00f3 0200 0000 2a00 7a1f  ...G........*.z.
-00000b50: 7379 6d70 6f69 6e63 6172 652e 3c6c 6f63  sympoincare.<loc
-00000b60: 616c 733e 2e3c 6c69 7374 636f 6d70 3e29  als>.<listcomp>)
-00000b70: 0772 1400 0000 da03 6c65 6eda 0f5f 706f  .r......len.._po
-00000b80: 6973 736f 6e5f 6661 6374 6f72 7205 0000  isson_factorr...
-00000b90: 00da 0974 7261 6e73 706f 7365 7221 0000  ...transposer!..
-00000ba0: 0072 2000 0000 2903 7223 0000 0072 1400  .r ...).r#...r..
-00000bb0: 0000 da02 7066 720d 0000 0072 2800 0000  ....pfr....r(...
-00000bc0: 7210 0000 00da 0b73 796d 706f 696e 6361  r......sympoinca
-00000bd0: 7265 2000 0000 730c 0000 000a 1c08 0110  re ...s.........
-00000be0: 020a 010c 0224 0572 3000 0000 da04 6175  .....$.r0.....au
-00000bf0: 746f da05 7269 6768 7454 678d edb5 a0f7  to..rightTg.....
-00000c00: c6b0 3e46 2909 da05 6f72 6465 72da 066f  ..>F)...order..o
-00000c10: 6666 7365 74da 0470 6f73 32da 0563 6f6d  ffset..pos2..com
-00000c20: 6232 da03 746f 6cda 0a74 6f6c 5f63 6865  b2..tol..tol_che
-00000c30: 636b 73da 0c64 6973 6162 6c65 5f74 7164  cks..disable_tqd
-00000c40: 6dda 0b66 6f72 6365 5f6f 7264 6572 da04  m..force_order..
-00000c50: 7761 726e 6300 0000 0000 0000 0009 0000  warnc...........
-00000c60: 0023 0000 000d 0000 000f 0000 0073 5c06  .#...........s\.
-00000c70: 0000 8806 6401 1900 6a00 8901 8801 6402  ....d...j.....d.
-00000c80: 1400 8902 7401 8701 6601 6403 6404 8408  ....t...f.d.d...
-00000c90: 8806 4400 8301 8301 7316 4a00 8201 8806  ..D.....s.J.....
-00000ca0: 6401 1900 6a02 8907 7401 8707 6601 6405  d...j...t...f.d.
-00000cb0: 6404 8408 8806 4400 8301 8301 7328 4a00  d.....D.....s(J.
-00000cc0: 8201 7403 8806 8301 8802 6b02 733a 4a00  ..t.......k.s:J.
-00000cd0: 6406 7403 8806 8301 9b00 6407 8802 9b00  d.t.......d.....
-00000ce0: 9d04 8301 8201 7404 6402 6701 6408 6404  ......t.d.g.d.d.
-00000cf0: 8400 8806 4400 8301 1700 8301 7d0b 7404  ....D.......}.t.
-00000d00: 6409 6404 8400 8806 4400 8301 8301 7d0c  d.d.....D.....}.
-00000d10: 7c00 640a 6b02 7263 7c08 7261 7405 a006  |.d.k.rc|.rat...
-00000d20: 640b 7c00 9b00 640c 7c0b 9b00 640d 9d05  d.|...d.|...d...
-00000d30: a101 0100 7c0b 7d00 7c00 7c0b 640e 1700  ....|.}.|.|.d...
-00000d40: 6b00 726e 7c00 7407 6a08 6b00 7378 4a00  k.rn|.t.j.k.sxJ.
-00000d50: 640f 7c0b 640e 1700 9b00 6410 9d03 8301  d.|.d.....d.....
-00000d60: 8201 7403 7c0a 8301 6401 6b02 7285 7c08  ..t.|...d.k.r.|.
-00000d70: 7285 7405 a006 6411 a101 0100 7403 8805  r.t...d.....t...
-00000d80: 8301 6401 6b02 729a 6401 6701 8802 1400  ..d.k.r.d.g.....
-00000d90: 8908 8702 6601 6412 6404 8408 8806 4400  ....f.d.d.....D.
-00000da0: 8301 8903 6e1e 7403 8805 8301 8802 6b02  ....n.t.......k.
-00000db0: 73ad 4a00 6413 7403 8805 8301 9b00 6414  s.J.d.t.......d.
-00000dc0: 8802 9b00 6410 9d05 8301 8201 8805 8908  ....d...........
-00000dd0: 8705 6601 6415 6404 8408 8806 4400 8301  ..f.d.d.....D...
-00000de0: 8903 7c00 6401 6b02 72d0 8703 8708 6602  ..|.d.k.r.....f.
-00000df0: 6416 6404 8408 7409 8802 8301 4400 8301  d.d...t.....D...
-00000e00: 7d0d 740a 7c0d 6417 8807 6901 8e01 6701  }.t.|.d...i...g.
-00000e10: 5300 740b 6418 6404 8400 8808 4400 8301  S.t.d.d.....D...
-00000e20: 8301 7d0e 7c0e 9001 7208 740a 8808 8807  ..}.|...r.t.....
-00000e30: 7c0b 6419 9c02 8e01 7d0f 740c 7c0f 8301  |.d.....}.t.|...
-00000e40: 8806 641a 641b 6901 8e01 8906 7c00 7c0c  ..d.d.i.....|.|.
-00000e50: 6b05 9001 7208 7c07 9001 7308 7c08 9001  k...r.|...s.|...
-00000e60: 7204 7405 a006 641c 7c00 9b00 641d 7c0c  r.t...d.|...d.|.
-00000e70: 9b00 641e 9d05 a101 0100 7c00 640e 1800  ..d.......|.d...
-00000e80: 7d00 7c00 7c0c 6b04 9001 721c 7c08 9001  }.|.|.k...r.|...
-00000e90: 721c 7405 a006 641c 7c00 9b00 641f 7c0c  r.t...d.|...d.|.
-00000ea0: 9b00 6420 9d05 a101 0100 7407 a00d 6421  ..d ......t...d!
-00000eb0: 6404 8400 8806 4400 8301 a101 7d10 740e  d.....D.....}.t.
-00000ec0: 8801 8301 7d11 7c05 6401 6b04 9001 7248  ....}.|.d.k...rH
-00000ed0: 7407 6a0f a010 7c10 a011 a100 7c11 1000  t.j...|.....|...
-00000ee0: 7c10 1000 7c11 1800 a101 7c05 6b00 9001  |...|.....|.k...
-00000ef0: 7348 4a00 6422 7c05 9b00 6410 9d03 8301  sHJ.d"|...d.....
-00000f00: 8201 7c03 9001 7279 7a1b 7412 7c10 a011  ..|...ryz.t.|...
-00000f10: a100 8301 7d12 7413 7c12 8807 8809 7c0b  ....}.t.|.....|.
-00000f20: 6423 8d04 a014 8809 a101 7d13 7c13 6401  d#........}.|.d.
-00000f30: 1400 7d14 7c12 6401 1400 7d15 5700 6e12  ..}.|.d...}.W.n.
-00000f40: 0100 0100 0100 7c08 9001 7276 7405 a006  ......|...rvt...
-00000f50: 6424 8809 9b00 6425 9d03 a101 0100 6426  d$....d%......d&
-00000f60: 7d03 5900 7c03 9001 739c 7415 7c10 a011  }.Y.|...s.t.|...
-00000f70: a100 7c05 6427 8d02 5c02 7d12 7d15 7413  ..|.d'..\.}.}.t.
-00000f80: 7c12 8807 7c05 7c0b 6423 8d04 a014 8809  |...|.|.d#......
-00000f90: a101 7d13 7413 7c15 8807 7c05 7c0b 6423  ..}.t.|...|.|.d#
-00000fa0: 8d04 a014 8809 a101 7d14 7c05 6401 6b04  ........}.|.d.k.
-00000fb0: 9001 72bd 7407 6a0f a010 7416 7c12 8301  ..r.t.j...t.|...
-00000fc0: 7416 7c15 8301 1000 7c10 a011 a100 1800  t.|.....|.......
-00000fd0: a101 7c05 6b00 9001 73b6 4a00 8201 7417  ..|.k...s.J...t.
-00000fe0: 8801 8807 7c0b 6419 8d03 7d16 7c11 0b00  ....|.d...}.|...
-00000ff0: 7c10 a011 a100 1000 7c11 1000 8900 8700  |.......|.......
-00001000: 8702 8706 6603 6428 6404 8408 7409 8802  ....f.d(d...t...
-00001010: 8301 4400 8301 7d17 8809 6401 6b04 9001  ..D...}...d.k...
-00001020: 72e1 8709 6601 6429 6404 8408 7c17 4400  r...f.d)d...|.D.
-00001030: 8301 7d17 6700 7d18 7c13 6401 6b03 9001  ..}.g.}.|.d.k...
-00001040: 72ed 7c18 a018 7c13 a101 0100 7c14 6401  r.|...|.....|.d.
-00001050: 6b03 9001 72f7 7c18 a018 7c14 a101 0100  k...r.|...|.....
-00001060: 6700 7d19 7419 7409 6402 7c00 640e 1700  g.}.t.t.d.|.d...
-00001070: 8302 7c06 642a 8d02 4400 5dc0 8904 8704  ..|.d*..D.].....
-00001080: 6601 642b 6404 8408 7c17 4400 8301 7d1a  f.d+d...|.D...}.
-00001090: 7403 7c1a 8301 6401 6b02 9002 7324 7403  t.|...d.k...s$t.
-000010a0: 642c 6404 8400 7c1a 4400 8301 8301 7403  d,d...|.D.....t.
-000010b0: 7c17 8301 6b02 9002 7226 9002 7104 7c05  |...k...r&..q.|.
-000010c0: 6401 6b04 9002 7263 7409 8802 8301 4400  d.k...rct.....D.
-000010d0: 5d33 7d1b 7409 7c1b 8301 4400 5d2b 7d1c  ]3}.t.|...D.]+}.
-000010e0: 7c16 7c1c 1900 7c1a 7c1b 1900 1000 7c1a  |.|...|.|.....|.
-000010f0: 7c1c 1900 7c16 7c1b 1900 1000 1700 7d1d  |...|.|.......}.
-00001100: 7c1d a014 7c05 a101 6401 6b02 9002 735f  |...|...d.k...s_
-00001110: 4a00 642d 8804 9b00 642e 7c05 9b00 642f  J.d-....d.|...d/
-00001120: 7c0a 9b00 6430 7c1d 9b00 9d08 8301 8201  |...d0|.........
-00001130: 9002 7135 9002 712f 741a 7c1a 8e00 a014  ..q5..q/t.|.....
-00001140: 8809 a101 7d1e 7c1e 6401 6b02 9002 7271  ....}.|.d.k...rq
-00001150: 9002 7104 740c 7c1e 0b00 8301 7d1f 7c1f  ..q.t.|.....}.|.
-00001160: 7c17 6900 7c0a a401 8e01 7d17 7c05 6401  |.i.|.....}.|.d.
-00001170: 6b04 9002 72be 7409 8802 8301 4400 5d37  k...r.t.....D.]7
-00001180: 7d1b 7c17 7c1b 1900 7c16 7c1b 1900 1800  }.|.|...|.|.....
-00001190: a014 7c05 a101 6a1b 6431 6432 8400 6433  ..|...j.d1d2..d3
-000011a0: 8d01 7d20 7c20 6401 6b03 9002 72bc 7c20  ..} | d.k...r.| 
-000011b0: a01c a100 8804 640e 1700 6b05 9002 73bc  ......d...k...s.
-000011c0: 4a00 6434 8804 640e 1700 9b00 6435 8804  J.d4..d.....d5..
-000011d0: 9b00 642e 7c05 9b00 6430 7c20 a01d 8804  ..d.|...d0| ....
-000011e0: a101 9b00 9d08 8301 8201 9002 7186 7c19  ............q.|.
-000011f0: a018 7c1e a101 0100 9002 7104 7c02 6436  ..|.......q.|.d6
-00001200: 6b02 9002 72cf 7c19 7c18 1700 7d18 6e28  k...r.|.|...}.n(
-00001210: 6700 7d21 7403 7c19 8301 6401 6b04 9002  g.}!t.|...d.k...
-00001220: 72ec 740c 7c14 0b00 8301 740c 7c13 0b00  r.t.|.....t.|...
-00001230: 8301 7c19 6437 641b 6438 9c02 8e01 6437  ..|.d7d.d8....d7
-00001240: 641b 6438 9c02 8e01 7d21 7c18 8709 6601  d.d8....}!|...f.
-00001250: 6439 6404 8408 7c21 4400 8301 1700 7d18  d9d...|!D.....}.
-00001260: 7c0e 9003 7201 7c18 a01e 6401 7c0f 0b00  |...r.|...d.|...
-00001270: a102 0100 740b 643a 6404 8400 8803 4400  ....t.d:d.....D.
-00001280: 8301 8301 9003 722c 740a 8803 8807 7c0b  ......r,t.....|.
-00001290: 6419 9c02 8e01 7d22 7c0e 9003 7227 7403  d.....}"|...r't.
-000012a0: 7c18 8301 640e 6b02 9003 7227 7c18 6401  |...d.k...r'|.d.
-000012b0: 0500 1900 7c22 3700 0300 3c00 7c18 5300  ....|"7...<.|.S.
-000012c0: 7c18 a018 7c22 a101 0100 7c18 5300 293b  |...|"....|.S.);
-000012d0: 6147 0b00 000a 2020 2020 4c65 7420 705f  aG....    Let p_
-000012e0: 312c 202e 2e2e 2c20 705f 6e20 6265 2070  1, ..., p_n be p
-000012f0: 6f6c 796e 6f6d 6961 6c73 2072 6570 7265  olynomials repre
-00001300: 7365 6e74 696e 6720 7468 6520 5461 796c  senting the Tayl
-00001310: 6f72 2065 7870 616e 7369 6f6e 7320 6f66  or expansions of
-00001320: 0a20 2020 2074 6865 2063 6f6d 706f 6e65  .    the compone
-00001330: 6e74 7320 6f66 2061 2073 796d 706c 6563  nts of a symplec
-00001340: 7469 6320 6d61 7020 4d2e 200a 2020 2020  tic map M. .    
-00001350: 2020 2020 0a20 2020 2054 6865 6e20 7468      .    Then th
-00001360: 6973 2072 6f75 7469 6e65 2077 696c 6c20  is routine will 
-00001370: 6669 6e64 2070 6f6c 796e 6f6d 6961 6c73  find polynomials
-00001380: 2066 5f31 2c20 675f 312c 2066 325f 612c   f_1, g_1, f2_a,
-00001390: 2066 325f 622c 2066 332c 2066 342c 2066   f2_b, f3, f4, f
-000013a0: 352c 202e 2e2e 2c0a 2020 2020 7768 6572  5, ...,.    wher
-000013b0: 6520 665f 6b20 6973 2061 2068 6f6d 6f67  e f_k is a homog
-000013c0: 656e 656f 7573 2070 6f6c 796e 6f6d 6961  eneous polynomia
-000013d0: 6c20 6f66 2064 6567 7265 6520 6b2c 2073  l of degree k, s
-000013e0: 6f20 7468 6174 0a20 2020 204d 207e 2065  o that.    M ~ e
-000013f0: 7870 283a 6631 3a29 206f 2065 7870 283a  xp(:f1:) o exp(:
-00001400: 6632 5f61 3a29 206f 2065 7870 283a 6632  f2_a:) o exp(:f2
-00001410: 5f62 3a29 206f 2065 7870 283a 6633 3a29  _b:) o exp(:f3:)
-00001420: 206f 2065 7870 283a 6634 3a29 206f 202e   o exp(:f4:) o .
-00001430: 2e2e 206f 2065 7870 283a 666e 3a29 206f  .. o exp(:fn:) o
-00001440: 2065 7870 283a 6731 3a29 0a20 2020 2068   exp(:g1:).    h
-00001450: 6f6c 6473 2e20 5468 6520 706f 7369 7469  olds. The positi
-00001460: 6f6e 206f 6620 7468 6520 6368 6169 6e20  on of the chain 
-00001470: 6f66 2032 6e64 206f 7264 6572 2070 6f6c  of 2nd order pol
-00001480: 796e 6f6d 6961 6c73 2063 616e 2068 6572  ynomials can her
-00001490: 6562 7920 6265 2063 686f 7365 6e2c 0a20  eby be chosen,. 
-000014a0: 2020 2062 7920 7072 6f76 6964 696e 6720     by providing 
-000014b0: 6120 2770 6f73 3227 2d70 6172 616d 6574  a 'pos2'-paramet
-000014c0: 6572 2e0a 2020 2020 0a20 2020 2050 6172  er..    .    Par
-000014d0: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
-000014e0: 2d2d 2d2d 2d2d 0a20 2020 2070 3a20 706f  ------.    p: po
-000014f0: 6c79 0a20 2020 2020 2020 2050 6f6c 796e  ly.        Polyn
-00001500: 6f6d 6961 6c73 2072 6570 7265 7365 6e74  omials represent
-00001510: 696e 6720 7468 6520 636f 6d70 6f6e 656e  ing the componen
-00001520: 7473 206f 6620 7468 6520 7379 6d70 6c65  ts of the symple
-00001530: 6374 6963 206d 6170 204d 2e0a 2020 2020  ctic map M..    
-00001540: 2020 2020 0a20 2020 206f 7264 6572 3a20      .    order: 
-00001550: 696e 742c 206f 7074 696f 6e61 6c0a 2020  int, optional.  
-00001560: 2020 2020 2020 5468 6520 6d61 7869 6d61        The maxima
-00001570: 6c20 6465 6772 6565 206f 6620 7468 6520  l degree of the 
-00001580: 6170 7072 6f78 696d 6174 6564 206d 6170  approximated map
-00001590: 2028 3d20 6d61 7869 6d61 6c20 6465 6772   (= maximal degr
-000015a0: 6565 206f 6620 7468 6520 706f 6c79 6e6f  ee of the polyno
-000015b0: 6d69 616c 7320 666b 2061 626f 7665 202d  mials fk above -
-000015c0: 2031 292e 0a20 2020 2020 2020 200a 2020   1)..        .  
-000015d0: 2020 6f66 6673 6574 3a20 7375 6273 6372    offset: subscr
-000015e0: 6970 7461 626c 652c 206f 7074 696f 6e61  iptable, optiona
-000015f0: 6c0a 2020 2020 2020 2020 416e 206f 7074  l.        An opt
-00001600: 696f 6e61 6c20 706f 696e 7420 6f66 2072  ional point of r
-00001610: 6566 6572 656e 6365 2061 726f 756e 6420  eference around 
-00001620: 7768 6963 6820 7468 6520 6d61 7020 7368  which the map sh
-00001630: 6f75 6c64 2062 6520 7265 7072 6573 656e  ould be represen
-00001640: 7465 642e 0a20 2020 2020 2020 2042 7920  ted..        By 
-00001650: 6465 6661 756c 742c 2074 6869 7320 706f  default, this po
-00001660: 696e 7420 6973 207a 6572 6f2e 0a20 2020  int is zero..   
-00001670: 2020 2020 200a 2020 2020 706f 7332 3a20       .    pos2: 
-00001680: 7374 722c 206f 7074 696f 6e61 6c0a 2020  str, optional.  
-00001690: 2020 2020 2020 4569 7468 6572 2027 6c65        Either 'le
-000016a0: 6674 2720 6f72 2027 7269 6768 7427 2028  ft' or 'right' (
-000016b0: 6465 6661 756c 7429 2e20 5468 6520 6f75  default). The ou
-000016c0: 7463 6f6d 6520 7769 6c6c 2064 6574 6572  tcome will deter
-000016d0: 6d69 6e65 2074 6865 2072 6570 7265 7365  mine the represe
-000016e0: 6e74 6174 696f 6e20 6f66 204d 3a0a 2020  ntation of M:.  
-000016f0: 2020 2020 2020 706f 7332 203d 3d20 2772        pos2 == 'r
-00001700: 6967 6874 273a 0a20 2020 2020 2020 204d  ight':.        M
-00001710: 207e 2065 7870 283a 6631 3a29 206f 2065   ~ exp(:f1:) o e
-00001720: 7870 283a 6633 3a29 206f 2065 7870 283a  xp(:f3:) o exp(:
-00001730: 6634 3a29 206f 202e 2e2e 206f 2065 7870  f4:) o ... o exp
-00001740: 283a 666e 3a29 206f 2065 7870 283a 6632  (:fn:) o exp(:f2
-00001750: 5f61 3a29 206f 2065 7870 283a 6632 5f62  _a:) o exp(:f2_b
-00001760: 3a29 206f 2065 7870 283a 6731 3a29 0a20  :) o exp(:g1:). 
-00001770: 2020 2020 2020 2070 6f73 3220 3d3d 2027         pos2 == '
-00001780: 6c65 6674 273a 0a20 2020 2020 2020 204d  left':.        M
-00001790: 207e 2065 7870 283a 6631 3a29 206f 2065   ~ exp(:f1:) o e
-000017a0: 7870 283a 6632 5f61 3a29 206f 2065 7870  xp(:f2_a:) o exp
-000017b0: 283a 6632 5f62 3a29 206f 2065 7870 283a  (:f2_b:) o exp(:
-000017c0: 6633 3a29 206f 2065 7870 283a 6634 3a29  f3:) o exp(:f4:)
-000017d0: 206f 202e 2e2e 206f 2065 7870 283a 666e   o ... o exp(:fn
-000017e0: 3a29 206f 2065 7870 283a 6731 3a29 0a20  :) o exp(:g1:). 
-000017f0: 2020 2020 2020 200a 2020 2020 636f 6d62         .    comb
-00001800: 323a 2062 6f6f 6c65 616e 2c20 6f70 7469  2: boolean, opti
-00001810: 6f6e 616c 0a20 2020 2020 2020 2049 6620  onal.        If 
-00001820: 7472 7565 2c20 7468 656e 2074 7279 2074  true, then try t
-00001830: 6f20 6669 6e64 2061 2073 696e 676c 6520  o find a single 
-00001840: 326e 642d 6f72 6465 7220 706f 6c79 6e6f  2nd-order polyno
-00001850: 6d69 616c 2c20 6279 2061 7070 6c79 696e  mial, by applyin
-00001860: 6720 7363 6970 792e 6c69 6e61 6c67 2e6c  g scipy.linalg.l
-00001870: 6f67 6d2e 0a20 2020 2020 2020 2049 6620  ogm..        If 
-00001880: 7468 6973 2066 6169 6c73 2028 7768 6963  this fails (whic
-00001890: 6820 6973 2074 6865 2063 6173 6520 6966  h is the case if
-000018a0: 2074 6865 206d 6174 7269 7820 6c6f 6761   the matrix loga
-000018b0: 7269 7468 6d20 6861 7320 6e6f 2072 6570  rithm has no rep
-000018c0: 7265 7365 6e74 6174 696f 6e20 696e 2074  resentation in t
-000018d0: 6572 6d73 206f 6620 6120 4c69 652d 706f  erms of a Lie-po
-000018e0: 6c79 6e6f 6d69 616c 292c 200a 2020 2020  lynomial), .    
-000018f0: 2020 2020 7468 656e 2077 6520 7769 6c6c      then we will
-00001900: 2066 616c 6c20 6261 636b 2074 6f20 7468   fall back to th
-00001910: 6520 2263 6f6d 6232 3d46 616c 7365 222d  e "comb2=False"-
-00001920: 6361 7365 2061 6e64 2061 2077 6172 6e69  case and a warni
-00001930: 6e67 2077 696c 6c20 6265 2069 7373 7565  ng will be issue
-00001940: 642e 0a20 2020 2020 2020 2049 6620 6661  d..        If fa
-00001950: 6c73 652c 2074 6865 6e20 6c69 656f 7073  lse, then lieops
-00001960: 2e6c 696e 616c 672e 7379 6d6c 6f67 7320  .linalg.symlogs 
-00001970: 7769 6c6c 2062 6520 7573 6564 2028 7768  will be used (wh
-00001980: 6963 6820 6d61 7920 7072 6f64 7563 6520  ich may produce 
-00001990: 7477 6f20 4c69 652d 706f 6c79 6e6f 6d69  two Lie-polynomi
-000019a0: 616c 7320 6576 656e 0a20 2020 2020 2020  als even.       
-000019b0: 2069 6e20 6365 7274 6169 6e20 6361 7365   in certain case
-000019c0: 7320 696e 2077 6869 6368 2074 6865 7265  s in which there
-000019d0: 2077 6f75 6c64 2061 6c72 6561 6479 2065   would already e
-000019e0: 7869 7374 2061 2073 696e 676c 6520 6f6e  xist a single on
-000019f0: 6520 646f 696e 6720 7468 6520 6a6f 6229  e doing the job)
-00001a00: 2e0a 0a20 2020 2074 6f6c 3a20 666c 6f61  ...    tol: floa
-00001a10: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-00001a20: 2020 2020 4964 656e 7469 6679 2073 6d61      Identify sma
-00001a30: 6c6c 2066 6b20 616e 6420 6472 6f70 2074  ll fk and drop t
-00001a40: 6865 6d20 6966 2061 6c6c 2074 6865 6972  hem if all their
-00001a50: 2076 616c 7565 7320 6172 6520 6265 6c6f   values are belo
-00001a60: 7720 7468 6973 2074 6872 6573 686f 6c64  w this threshold
-00001a70: 2e0a 2020 2020 2020 2020 0a20 2020 2074  ..        .    t
-00001a80: 6f6c 5f63 6865 636b 733a 2066 6c6f 6174  ol_checks: float
-00001a90: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00001aa0: 2020 2049 6620 3e20 302c 2070 6572 666f     If > 0, perfo
-00001ab0: 726d 2063 6572 7461 696e 2063 6f6e 7369  rm certain consi
-00001ac0: 7374 656e 6379 2063 6865 636b 7320 6475  stency checks du
-00001ad0: 7269 6e67 2074 6865 2063 616c 6375 6c61  ring the calcula
-00001ae0: 7469 6f6e 2e0a 2020 2020 2020 2020 2020  tion..          
-00001af0: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
-00001b00: 2020 2064 6973 6162 6c65 5f74 7164 6d3a     disable_tqdm:
-00001b10: 2062 6f6f 6c65 616e 2c20 6f70 7469 6f6e   boolean, option
-00001b20: 616c 0a20 2020 2020 2020 2049 6620 7472  al.        If tr
-00001b30: 7565 2c20 6469 7361 626c 6520 7468 6520  ue, disable the 
-00001b40: 7471 646d 2073 7461 7475 7320 6261 7220  tqdm status bar 
-00001b50: 7072 696e 746f 7574 2e0a 2020 2020 2020  printout..      
-00001b60: 2020 0a20 2020 2066 6f72 6365 5f6f 7264    .    force_ord
-00001b70: 6572 3a20 626f 6f6c 6561 6e2c 206f 7074  er: boolean, opt
-00001b80: 696f 6e61 6c0a 2020 2020 2020 2020 4966  ional.        If
-00001b90: 2074 7275 652c 2064 6f20 6e6f 7420 6368   true, do not ch
-00001ba0: 616e 6765 2074 6865 206f 7264 6572 2062  ange the order b
-00001bb0: 7920 2d31 2069 6e20 6361 7365 2031 2920  y -1 in case 1) 
-00001bc0: 616e 206f 6666 7365 7420 6973 2064 6574  an offset is det
-00001bd0: 6563 7465 6420 616e 6420 3229 206f 7264  ected and 2) ord
-00001be0: 6572 203e 3d20 6465 6772 6565 206f 6620  er >= degree of 
-00001bf0: 7468 6520 5461 796c 6f72 206d 6170 2e0a  the Taylor map..
-00001c00: 2020 2020 2020 2020 4465 6661 756c 743a          Default:
-00001c10: 2028 6661 6c73 6529 0a20 2020 2020 2020   (false).       
-00001c20: 200a 2020 2020 7761 726e 3a20 626f 6f6c   .    warn: bool
-00001c30: 6561 6e2c 206f 7074 696f 6e61 6c0a 2020  ean, optional.  
-00001c40: 2020 2020 2020 5375 7072 6573 7320 6f72        Supress or
-00001c50: 2073 686f 7720 7761 726e 696e 6773 2e0a   show warnings..
-00001c60: 2020 2020 2020 2020 0a20 2020 202a 2a6b          .    **k
-00001c70: 7761 7267 730a 2020 2020 2020 2020 4675  wargs.        Fu
-00001c80: 7274 6865 7220 696e 7075 7420 7061 7261  rther input para
-00001c90: 6d65 7465 7273 2070 6173 7365 6420 746f  meters passed to
-00001ca0: 206c 6965 6f70 732e 636f 7265 2e6c 6965   lieops.core.lie
-00001cb0: 2e6c 6578 7020 666c 6f77 2063 616c 6375  .lexp flow calcu
-00001cc0: 6c61 7469 6f6e 2e0a 2020 2020 0a20 2020  lation..    .   
-00001cd0: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
-00001ce0: 2d2d 2d2d 0a20 2020 206c 6973 740a 2020  ----.    list.  
-00001cf0: 2020 2020 2020 4120 6c69 7374 206f 6620        A list of 
-00001d00: 706f 6c79 206f 626a 6563 7473 205b 6631  poly objects [f1
-00001d10: 2c20 6632 5f61 2c20 6632 5f62 2c20 6633  , f2_a, f2_b, f3
-00001d20: 2c20 6634 2c20 2e2e 2e5d 2069 6e20 7468  , f4, ...] in th
-00001d30: 6520 6f72 6465 7220 6465 7363 7269 6265  e order describe
-00001d40: 6420 6162 6f76 652e 0a20 2020 2020 2020  d above..       
-00001d50: 200a 2020 2020 5265 6665 7265 6e63 6573   .    References
-00001d60: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-00001d70: 2020 2020 5b31 5d20 412e 2044 7261 6774      [1] A. Dragt
-00001d80: 3a20 224c 6965 204d 6574 686f 6473 2066  : "Lie Methods f
-00001d90: 6f72 204e 6f6e 6c69 6e65 6172 2044 796e  or Nonlinear Dyn
-00001da0: 616d 6963 7320 7769 7468 2041 7070 6c69  amics with Appli
-00001db0: 6361 7469 6f6e 7320 746f 2041 6363 656c  cations to Accel
-00001dc0: 6572 6174 6f72 2050 6879 7369 6373 222c  erator Physics",
-00001dd0: 2055 6e69 7665 7273 6974 7920 6f66 204d   University of M
-00001de0: 6172 796c 616e 642c 2032 3032 302c 0a20  aryland, 2020,. 
-00001df0: 2020 2020 2020 2068 7474 703a 2f2f 7777         http://ww
-00001e00: 772e 7068 7973 6963 732e 756d 642e 6564  w.physics.umd.ed
-00001e10: 752f 6473 6174 2f0a 2020 2020 7201 0000  u/dsat/.    r...
-00001e20: 0072 1f00 0000 6301 0000 0000 0000 0000  .r....c.........
-00001e30: 0000 0002 0000 0004 0000 0013 0000 00f3  ................
-00001e40: 1600 0000 6700 7c00 5d07 7d01 7c01 6a00  ....g.|.].}.|.j.
-00001e50: 8800 6b02 9102 7102 5300 720d 0000 00a9  ..k...q.S.r.....
-00001e60: 0172 1400 0000 a902 720e 0000 00da 0165  .r......r......e
-00001e70: 723d 0000 0072 0d00 0000 7210 0000 0072  r=...r....r....r
-00001e80: 1100 0000 8e00 0000 f302 0000 0016 007a  ...............z
-00001e90: 1d64 7261 6774 6669 6e6e 2e3c 6c6f 6361  .dragtfinn.<loca
-00001ea0: 6c73 3e2e 3c6c 6973 7463 6f6d 703e 6301  ls>.<listcomp>c.
-00001eb0: 0000 0000 0000 0000 0000 0002 0000 0004  ................
-00001ec0: 0000 0013 0000 0072 3c00 0000 720d 0000  .......r<...r...
-00001ed0: 0029 0172 2d00 0000 723e 0000 0029 0172  .).r-...r>...).r
-00001ee0: 2f00 0000 720d 0000 0072 1000 0000 7211  /...r....r....r.
-00001ef0: 0000 0090 0000 0072 4000 0000 7a16 506f  .......r@...z.Po
-00001f00: 6c79 6e6f 6d69 616c 7320 7265 6365 6976  lynomials receiv
-00001f10: 6564 3a20 7a0b 2045 7870 6563 7465 643a  ed: z. Expected:
-00001f20: 2063 0100 0000 0000 0000 0000 0000 0200   c..............
-00001f30: 0000 0300 0000 5300 0000 7312 0000 0067  ......S...s....g
-00001f40: 007c 005d 057d 017c 016a 0091 0271 0253  .|.].}.|.j...q.S
-00001f50: 0072 0d00 0000 2901 7215 0000 0072 3e00  .r....).r....r>.
-00001f60: 0000 720d 0000 0072 0d00 0000 7210 0000  ..r....r....r...
-00001f70: 0072 1100 0000 9200 0000 7302 0000 0012  .r........s.....
-00001f80: 0063 0100 0000 0000 0000 0000 0000 0200  .c..............
-00001f90: 0000 0400 0000 5300 0000 7314 0000 0067  ......S...s....g
-00001fa0: 007c 005d 067d 017c 01a0 00a1 0091 0271  .|.].}.|.......q
-00001fb0: 0253 0072 0d00 0000 2901 da06 6d61 7864  .S.r....)...maxd
-00001fc0: 6567 723e 0000 0072 0d00 0000 720d 0000  egr>...r....r...
-00001fd0: 0072 1000 0000 7211 0000 0093 0000 00f3  .r....r.........
-00001fe0: 0200 0000 1400 7231 0000 007a 0a6f 7264  ......r1...z.ord
-00001ff0: 6572 203d 3d20 277a 1427 3a20 5365 7474  er == 'z.': Sett
-00002000: 696e 6720 6f72 6465 7220 746f 207a 1d20  ing order to z. 
-00002010: 286d 6178 5f70 6f77 6572 2069 6e20 706f  (max_power in po
-00002020: 6c79 206f 626a 6563 7473 292e 7212 0000  ly objects).r...
-00002030: 007a 3752 6571 7565 7374 6564 206f 7264  .z7Requested ord
-00002040: 6572 206f 6620 7468 6520 4472 6167 742d  er of the Dragt-
-00002050: 4669 6e6e 2073 6572 6965 7320 6361 6e20  Finn series can 
-00002060: 6e6f 7420 6265 203e 3d20 da01 2e7a 174e  not be >= ...z.N
-00002070: 6f20 666c 6f77 2070 6172 616d 6574 6572  o flow parameter
-00002080: 7320 7365 742e 6301 0000 0000 0000 0000  s set.c.........
-00002090: 0000 0002 0000 0006 0000 0013 0000 0073  ...............s
-000020a0: 1c00 0000 6700 7c00 5d0a 7d01 7c01 a000  ....g.|.].}.|...
-000020b0: 6400 8800 1400 6401 a102 9102 7102 5300  d.....d.....q.S.
-000020c0: 2902 a901 7201 0000 0072 0100 0000 2901  )...r....r....).
-000020d0: da03 6765 7472 3e00 0000 2901 7229 0000  ..getr>...).r)..
-000020e0: 0072 0d00 0000 7210 0000 0072 1100 0000  .r....r....r....
-000020f0: 9f00 0000 f302 0000 001c 007a 1b52 6566  ...........z.Ref
-00002100: 6572 656e 6365 2070 6f69 6e74 2064 696d  erence point dim
-00002110: 656e 7369 6f6e 3a20 7a0c 2c20 6578 7065  ension: z., expe
-00002120: 6374 6564 3a20 6301 0000 0000 0000 0000  cted: c.........
-00002130: 0000 0002 0000 0004 0000 0013 0000 0073  ...............s
-00002140: 1400 0000 6700 7c00 5d06 7d01 7c01 8800  ....g.|.].}.|...
-00002150: 8e00 9102 7102 5300 720d 0000 0072 0d00  ....q.S.r....r..
-00002160: 0000 723e 0000 0029 0172 3400 0000 720d  ..r>...).r4...r.
-00002170: 0000 0072 1000 0000 7211 0000 00a3 0000  ...r....r.......
-00002180: 0072 4200 0000 6301 0000 0000 0000 0000  .rB...c.........
-00002190: 0000 0002 0000 0005 0000 0013 0000 0073  ...............s
-000021a0: 1c00 0000 6700 7c00 5d0a 7d01 8800 7c01  ....g.|.].}...|.
-000021b0: 1900 8801 7c01 1900 1800 9102 7102 5300  ....|.......q.S.
-000021c0: 720d 0000 0072 0d00 0000 721d 0000 0029  r....r....r....)
-000021d0: 02da 0566 696e 616c da05 7374 6172 7472  ...final..startr
-000021e0: 0d00 0000 7210 0000 0072 1100 0000 a600  ....r....r......
-000021f0: 0000 7246 0000 00da 0e70 6f69 7373 6f6e  ..rF.....poisson
-00002200: 5f66 6163 746f 7263 0100 0000 0000 0000  _factorc........
-00002210: 0000 0000 0200 0000 0400 0000 5300 0000  ............S...
-00002220: f314 0000 0067 007c 005d 067d 017c 0164  .....g.|.].}.|.d
-00002230: 006b 0391 0271 0253 0072 4400 0000 720d  .k...q.S.rD...r.
-00002240: 0000 0072 3e00 0000 720d 0000 0072 0d00  ...r>...r....r..
-00002250: 0000 7210 0000 0072 1100 0000 a900 0000  ..r....r........
-00002260: 7242 0000 0029 0272 4900 0000 7215 0000  rB...).rI...r...
-00002270: 00da 066d 6574 686f 64da 0532 666c 6f77  ...method..2flow
-00002280: 7a10 5265 7175 6573 7465 6420 6f72 6465  z.Requested orde
-00002290: 7220 7a04 203e 3d20 7a4f 2028 6d61 7869  r z. >= zO (maxi
-000022a0: 6d61 6c20 6465 6772 6565 206f 6620 5461  mal degree of Ta
-000022b0: 796c 6f72 206d 6170 2920 2620 6e6f 6e2d  ylor map) & non-
-000022c0: 7a65 726f 206f 6666 7365 7420 6465 7465  zero offset dete
-000022d0: 6374 6564 2e20 4f72 6465 7220 7265 6475  cted. Order redu
-000022e0: 6365 6420 6279 2031 2e7a 0320 3e20 7a20  ced by 1.z. > z 
-000022f0: 2028 6d61 7869 6d61 6c20 6465 6772 6565   (maximal degree
-00002300: 206f 6620 5461 796c 6f72 206d 6170 292e   of Taylor map).
-00002310: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
-00002320: 0006 0000 0053 0000 0073 1e00 0000 6700  .....S...s....g.
-00002330: 7c00 5d0b 7d01 7400 7c01 a001 6400 a101  |.].}.t.|...d...
-00002340: 8301 a002 a100 9102 7102 5300 2901 7212  ........q.S.).r.
-00002350: 0000 0029 0372 0a00 0000 da10 686f 6d6f  ...).r......homo
-00002360: 6765 6e65 6f75 735f 7061 7274 da06 746f  geneous_part..to
-00002370: 6c69 7374 723e 0000 0072 0d00 0000 720d  listr>...r....r.
-00002380: 0000 0072 1000 0000 7211 0000 00ba 0000  ...r....r.......
-00002390: 0073 0200 0000 1e00 7a29 4d61 7020 6e6f  .s......z)Map no
-000023a0: 7420 7379 6d70 6c65 6374 6963 2077 6974  t symplectic wit
-000023b0: 6869 6e20 6120 746f 6c65 7261 6e63 6520  hin a tolerance 
-000023c0: 6f66 2029 0372 4900 0000 7237 0000 0072  of ).rI...r7...r
-000023d0: 1500 0000 7a37 4d61 7020 6170 7065 6172  ....z7Map appear
-000023e0: 7320 746f 2072 6571 7569 7265 2074 776f  s to require two
-000023f0: 2032 6e64 2d6f 7264 6572 2070 6f6c 796e   2nd-order polyn
-00002400: 6f6d 6961 6c73 2028 746f 6c3a 207a 0229  omials (tol: z.)
-00002410: 2e46 2901 da04 746f 6c32 6301 0000 0000  .F)...tol2c.....
-00002420: 0000 0000 0000 0001 0000 0006 0000 0013  ................
-00002430: 0000 0073 2a00 0000 6700 7c00 5d11 8900  ...s*...g.|.]...
-00002440: 7400 8701 8700 8703 6603 6400 6401 8408  t.......f.d.d...
-00002450: 7401 8802 8301 4400 8301 8301 9102 7102  t.....D.......q.
-00002460: 5300 2902 6301 0000 0000 0000 0000 0000  S.).c...........
-00002470: 0002 0000 0006 0000 0013 0000 0073 2000  .............s .
-00002480: 0000 6700 7c00 5d0c 7d01 8802 7c01 1900  ..g.|.].}...|...
-00002490: 8800 8801 7c01 6602 1900 1400 9102 7102  ....|.f.......q.
-000024a0: 5300 720d 0000 0072 0d00 0000 721d 0000  S.r....r....r...
-000024b0: 0029 03da 0252 6972 2400 0000 720f 0000  .)...Rir$...r...
-000024c0: 0072 0d00 0000 7210 0000 0072 1100 0000  .r....r....r....
-000024d0: 0501 0000 7225 0000 007a 2864 7261 6774  ....r%...z(dragt
-000024e0: 6669 6e6e 2e3c 6c6f 6361 6c73 3e2e 3c6c  finn.<locals>.<l
-000024f0: 6973 7463 6f6d 703e 2e3c 6c69 7374 636f  istcomp>.<listco
-00002500: 6d70 3e72 2600 0000 7227 0000 0029 0372  mp>r&...r'...).r
-00002510: 5000 0000 7229 0000 0072 0f00 0000 722a  P...r)...r....r*
-00002520: 0000 0072 1000 0000 7211 0000 0005 0100  ...r....r.......
-00002530: 0072 2b00 0000 6301 0000 0000 0000 0000  .r+...c.........
-00002540: 0000 0002 0000 0005 0000 0013 0000 00f3  ................
-00002550: 1600 0000 6700 7c00 5d07 7d01 7c01 a000  ....g.|.].}.|...
-00002560: 8800 a101 9102 7102 5300 720d 0000 00a9  ......q.S.r.....
-00002570: 01da 0561 626f 7665 723e 0000 00a9 0172  ...abover>.....r
-00002580: 3700 0000 720d 0000 0072 1000 0000 7211  7...r....r....r.
-00002590: 0000 0008 0100 0072 4000 0000 2901 da07  .......r@...)...
-000025a0: 6469 7361 626c 6563 0100 0000 0000 0000  disablec........
-000025b0: 0000 0000 0200 0000 0500 0000 1300 0000  ................
-000025c0: 7251 0000 0072 0d00 0000 2901 724d 0000  rQ...r....).rM..
-000025d0: 0072 3e00 0000 2901 720c 0000 0072 0d00  .r>...).r....r..
-000025e0: 0000 7210 0000 0072 1100 0000 1501 0000  ..r....r........
-000025f0: 7240 0000 0063 0100 0000 0000 0000 0000  r@...c..........
-00002600: 0000 0200 0000 0400 0000 5300 0000 7318  ..........S...s.
-00002610: 0000 0067 007c 005d 087d 017c 0164 006b  ...g.|.].}.|.d.k
-00002620: 0272 027c 0191 0271 0253 0072 4400 0000  .r.|...q.S.rD...
-00002630: 720d 0000 0029 0272 0e00 0000 da02 656b  r....).r......ek
-00002640: 720d 0000 0072 0d00 0000 7210 0000 0072  r....r....r....r
-00002650: 1100 0000 1701 0000 7302 0000 0018 007a  ........s......z
-00002660: 2e50 6f69 6e63 6172 6520 4c65 6d6d 6120  .Poincare Lemma 
-00002670: 7072 6572 6571 7569 7369 7473 206e 6f74  prerequisits not
-00002680: 206d 6574 2066 6f72 206f 7264 6572 207a   met for order z
-00002690: 0720 2874 6f6c 3a20 7a0e 2c20 666c 6f77  . (tol: z., flow
-000026a0: 2069 6e70 7574 3a20 7a03 293a 0a63 0100   input: z.):.c..
-000026b0: 0000 0000 0000 0000 0000 0100 0000 0200  ................
-000026c0: 0000 5300 0000 730c 0000 0074 007c 0083  ..S...s....t.|..
-000026d0: 0164 016b 0553 0029 024e 7212 0000 0029  .d.k.S.).Nr....)
-000026e0: 0172 1700 0000 2901 da03 6b65 7972 0d00  .r....)...keyr..
-000026f0: 0000 720d 0000 0072 1000 0000 da08 3c6c  ..r....r......<l
-00002700: 616d 6264 613e 2b01 0000 7302 0000 000c  ambda>+...s.....
-00002710: 007a 1b64 7261 6774 6669 6e6e 2e3c 6c6f  .z.dragtfinn.<lo
-00002720: 6361 6c73 3e2e 3c6c 616d 6264 613e 2901  cals>.<lambda>).
-00002730: da08 6b65 795f 636f 6e64 7a16 4c69 6520  ..key_condz.Lie 
-00002740: 6f70 6572 6174 6f72 206f 6620 6f72 6465  operator of orde
-00002750: 7220 7a38 2064 6f65 7320 6e6f 7420 7072  r z8 does not pr
-00002760: 6f70 6572 6c79 2063 616e 6365 6c20 7468  operly cancel th
-00002770: 6520 5461 796c 6f72 2d6d 6170 2074 6572  e Taylor-map ter
-00002780: 6d73 206f 6620 6f72 6465 7220 7232 0000  ms of order r2..
-00002790: 0054 2902 da05 6f75 746c 3172 4b00 0000  .T)...outl1rK...
-000027a0: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
-000027b0: 0005 0000 0013 0000 0073 2400 0000 6700  .........s$...g.
-000027c0: 7c00 5d0e 7d01 7c01 a000 8800 a101 6400  |.].}.|.......d.
-000027d0: 6b03 7202 7c01 a000 8800 a101 9102 7102  k.r.|.........q.
-000027e0: 5300 7244 0000 0072 5200 0000 2902 720e  S.rD...rR...).r.
-000027f0: 0000 00da 0166 7254 0000 0072 0d00 0000  .....frT...r....
-00002800: 7210 0000 0072 1100 0000 4701 0000 7302  r....r....G...s.
-00002810: 0000 0024 0063 0100 0000 0000 0000 0000  ...$.c..........
-00002820: 0000 0200 0000 0400 0000 5300 0000 724a  ..........S...rJ
-00002830: 0000 0072 4400 0000 720d 0000 0072 3e00  ...rD...r....r>.
-00002840: 0000 720d 0000 0072 0d00 0000 7210 0000  ..r....r....r...
-00002850: 0072 1100 0000 4c01 0000 7242 0000 0029  .r....L...rB...)
-00002860: 1f72 1400 0000 da03 616c 6c72 2d00 0000  .r......allr-...
-00002870: 722c 0000 00da 036d 6178 da08 7761 726e  r,.....max..warn
-00002880: 696e 6773 723b 0000 00da 026e 70da 0369  ingsr;.....np..i
-00002890: 6e66 7220 0000 0072 0900 0000 da03 616e  nfr ...r......an
-000028a0: 7972 0800 0000 da05 6172 7261 7972 0500  yr......arrayr..
-000028b0: 0000 da06 6c69 6e61 6c67 da04 6e6f 726d  ....linalg..norm
-000028c0: 722e 0000 0072 0300 0000 720b 0000 0072  r....r....r....r
-000028d0: 5300 0000 7206 0000 0072 0200 0000 7207  S...r....r....r.
-000028e0: 0000 00da 0661 7070 656e 6472 0400 0000  .....appendr....
-000028f0: 7230 0000 00da 0765 7874 7261 6374 da06  r0.....extract..
-00002900: 6d69 6e64 6567 da08 7472 756e 6361 7465  mindeg..truncate
-00002910: da06 696e 7365 7274 2923 7233 0000 0072  ..insert)#r3...r
-00002920: 3400 0000 7235 0000 0072 3600 0000 7237  4...r5...r6...r7
-00002930: 0000 0072 3800 0000 7239 0000 0072 3a00  ...r8...r9...r:.
-00002940: 0000 723b 0000 0072 0f00 0000 da06 6b77  ..r;...r......kw
-00002950: 6172 6773 7215 0000 00da 076d 6178 5f64  argsr......max_d
-00002960: 6567 da04 6469 6666 da10 7374 6172 745f  eg..diff..start_
-00002970: 6973 5f6e 6f6e 7a65 726f da02 6831 da01  is_nonzero..h1..
-00002980: 52da 014a da01 41da 0253 41da 0253 42da  R..J..A..SA..SB.
-00002990: 0142 da05 7869 6574 61da 0570 5f6e 6577  .B..xieta..p_new
-000029a0: da05 665f 616c 6cda 0466 5f6e 6cda 0267  ..f_all..f_nl..g
-000029b0: 6bda 0169 da01 6ada 047a 6572 6fda 0266  k..i..j..zero..f
-000029c0: 6bda 026c 6bda 0972 656d 6169 6e64 6572  k..lk..remainder
-000029d0: da05 665f 6864 6dda 0267 3172 0d00 0000  ..f_hdm..g1r....
-000029e0: 290a 7250 0000 0072 1400 0000 7229 0000  ).rP...r....r)..
-000029f0: 0072 4700 0000 720c 0000 0072 3400 0000  .rG...r....r4...
-00002a00: 720f 0000 0072 2f00 0000 7248 0000 0072  r....r/...rH...r
-00002a10: 3700 0000 7210 0000 00da 0964 7261 6774  7...r......dragt
-00002a20: 6669 6e6e 4900 0000 73cc 0000 000a 4308  finnI...s.....C.
-00002a30: 011a 010a 011a 0124 0118 0112 0108 0104  .......$........
-00002a40: 0118 0104 012a 0110 010a 010c 030a 0114  .....*..........
-00002a50: 0126 0204 0112 0108 0218 0110 0112 0206  .&..............
-00002a60: 0110 0212 0110 0406 0118 0108 0110 0218  ................
-00002a70: 0114 0308 010a 0132 0206 0302 010c 0116  .......2........
-00002a80: 0108 010c 0106 0106 0112 0106 0106 0114  ................
-00002a90: 0116 0116 010a 1e2a 020e 0112 151a 010a  .......*........
-00002aa0: 0112 0204 050a 010a 010a 010a 0104 021a  ................
-00002ab0: 0112 012a 0204 020a 020c 010c 0120 0134  ...*......... .4
-00002ac0: 0104 fe0e 040a 0104 020a 010e 010a 020c  ................
-00002ad0: 0222 010a 013c 0104 800e 020a 060a 0504  ."...<..........
-00002ae0: 0a0e 0128 0116 0106 020e 0114 0210 0114  ...(............
-00002af0: 0110 0204 040a fe04 0272 8200 0000 2917  .........r....).
-00002b00: da05 6e75 6d70 7972 5f00 0000 da0c 7363  ..numpyr_.....sc
-00002b10: 6970 792e 6c69 6e61 6c67 7202 0000 0072  ipy.linalgr....r
-00002b20: 0300 0000 7204 0000 0072 5e00 0000 da14  ....r....r^.....
-00002b30: 6c69 656f 7073 2e6c 696e 616c 672e 6d61  lieops.linalg.ma
-00002b40: 7472 6978 7205 0000 00da 106c 6965 6f70  trixr......lieop
-00002b50: 732e 6c69 6e61 6c67 2e6e 6672 0600 0000  s.linalg.nfr....
-00002b60: da0f 6c69 656f 7073 2e63 6f72 652e 6c69  ..lieops.core.li
-00002b70: 6572 0700 0000 7208 0000 00da 116c 6965  er....r......lie
-00002b80: 6f70 732e 636f 7265 2e74 6f6f 6c73 7209  ops.core.toolsr.
-00002b90: 0000 0072 0a00 0000 720b 0000 00da 0369  ...r....r......i
-00002ba0: 6e74 721c 0000 0072 2100 0000 7230 0000  ntr....r!...r0..
-00002bb0: 0072 8200 0000 720d 0000 0072 0d00 0000  .r....r....r....
-00002bc0: 720d 0000 0072 1000 0000 da08 3c6d 6f64  r....r......<mod
-00002bd0: 756c 653e 0100 0000 7318 0000 0008 0010  ule>....s.......
-00002be0: 010c 0108 010c 020c 0110 0114 010e 0208  ................
-00002bf0: 0d08 0822 29                             ...")
+00000070: 6d0b 5a0b 0100 6400 6406 6c0c 6d0d 5a0d  m.Z...d.d.l.m.Z.
+00000080: 0100 6400 6407 6c0e 6d0f 5a0f 0100 6400  ..d.d.l.m.Z...d.
+00000090: 6408 6c10 6d11 5a11 6d12 5a12 0100 6400  d.l.m.Z.m.Z...d.
+000000a0: 6409 6c13 6d14 5a14 6d15 5a15 6d16 5a16  d.l.m.Z.m.Z.m.Z.
+000000b0: 0100 650f 640a 640b 8400 8301 5a17 650f  ..e.d.d.....Z.e.
+000000c0: 640c 640d 8400 8301 5a18 640e 6519 6602  d.d.....Z.d.e.f.
+000000d0: 640f 6410 8404 5a1a 6411 6412 8400 5a1b  d.d...Z.d.d...Z.
+000000e0: 6413 6414 8400 5a1c 6415 6700 6416 6417  d.d...Z.d.g.d.d.
+000000f0: 6418 6400 6419 6419 6417 641a 9c09 641b  d.d.d.d.d.d...d.
+00000100: 641c 8402 5a1d 6401 5300 291d e900 0000  d...Z.d.S.).....
+00000110: 004e 2902 da04 6578 706d da04 6c6f 676d  .N)...expm..logm
+00000120: 2901 da04 7471 646d a901 da0a 6368 6563  )...tqdm....chec
+00000130: 6b5f 7a65 726f 2902 da08 6372 6561 7465  k_zero)...create
+00000140: 5f4a da04 656d 6174 2901 da07 7379 6d6c  _J..emat)...syml
+00000150: 6f67 7329 01da 096e 6473 7570 706f 7274  ogs)...ndsupport
+00000160: 2902 da0d 6372 6561 7465 5f63 6f6f 7264  )...create_coord
+00000170: 73da 046c 6578 7029 03da 0a63 6f6e 7374  s..lexp)...const
+00000180: 3270 6f6c 79da 0870 6f6c 7932 7665 63da  2poly..poly2vec.
+00000190: 0761 6432 706f 6c79 6301 0000 0000 0000  .ad2polyc.......
+000001a0: 0000 0000 0002 0000 0004 0000 004b 0000  .............K..
+000001b0: 00f3 1000 0000 7400 7c00 6601 6900 7c01  ......t.|.f.i.|.
+000001c0: a401 8e01 5300 a901 4e29 0172 0300 0000  ....S...N).r....
+000001d0: a902 da01 58da 066b 7761 7267 73a9 0072  ....X..kwargs..r
+000001e0: 1500 0000 fa52 2f68 6f6d 652f 6d61 6c74  .....R/home/malt
+000001f0: 652f 6d69 6e69 636f 6e64 6133 2f65 6e76  e/miniconda3/env
+00000200: 732f 776f 726b 2f6c 6962 2f70 7974 686f  s/work/lib/pytho
+00000210: 6e33 2e31 302f 7369 7465 2d70 6163 6b61  n3.10/site-packa
+00000220: 6765 732f 6c69 656f 7073 2f63 6f72 652f  ges/lieops/core/
+00000230: 6472 6167 742e 7079 da07 6c6f 676d 5f6e  dragt.py..logm_n
+00000240: 640f 0000 00f3 0200 0000 1002 7217 0000  d...........r...
+00000250: 0063 0100 0000 0000 0000 0000 0000 0200  .c..............
+00000260: 0000 0400 0000 4b00 0000 7210 0000 0072  ......K...r....r
+00000270: 1100 0000 2901 7202 0000 0072 1200 0000  ....).r....r....
+00000280: 7215 0000 0072 1500 0000 7216 0000 00da  r....r....r.....
+00000290: 0765 7870 6d5f 6e64 1300 0000 7218 0000  .expm_nd....r...
+000002a0: 0072 1900 0000 da01 6b63 0200 0000 0000  .r......kc......
+000002b0: 0000 0000 0000 0700 0000 0500 0000 4300  ..............C.
+000002c0: 0000 7364 0000 0069 007d 027c 006a 007d  ..sd...i.}.|.j.}
+000002d0: 037c 00a0 01a1 0044 005d 1f5c 027d 047d  .|.....D.].\.}.}
+000002e0: 0564 0164 0284 007c 0444 0083 017d 067c  .d.d...|.D...}.|
+000002f0: 067c 0105 0019 0064 0337 0003 003c 007c  .|.....d.7...<.|
+00000300: 0574 027c 0483 0164 0317 001b 007c 0274  .t.|...d.....|.t
+00000310: 037c 0683 013c 0071 097c 006a 047c 027c  .|...<.q.|.j.|.|
+00000320: 037c 006a 0564 048d 0353 0029 057a 850a  .|.j.d...S.).z..
+00000330: 2020 2020 4c65 7420 7020 6265 2061 204c      Let p be a L
+00000340: 6965 2070 6f6c 796e 6f6d 6961 6c2e 2054  ie polynomial. T
+00000350: 6865 6e20 7468 6973 2072 6f75 7469 6e65  hen this routine
+00000360: 2077 696c 6c0a 2020 2020 636f 6d70 7574   will.    comput
+00000370: 6520 7468 6520 696e 7465 6772 616c 206f  e the integral o
+00000380: 6620 702a 647a 5f6b 2c20 7768 6572 6520  f p*dz_k, where 
+00000390: 7a5f 6b20 6465 6e6f 7465 7320 7468 6520  z_k denotes the 
+000003a0: 6b2d 7468 2063 6f6d 706f 6e65 6e74 2e0a  k-th component..
+000003b0: 2020 2020 6301 0000 0000 0000 0000 0000      c...........
+000003c0: 0002 0000 0003 0000 0053 0000 0073 1000  .........S...s..
+000003d0: 0000 6700 7c00 5d04 7d01 7c01 9102 7102  ..g.|.].}.|...q.
+000003e0: 5300 7215 0000 0072 1500 0000 2902 da02  S.r....r....)...
+000003f0: 2e30 da01 7072 1500 0000 7215 0000 0072  .0..pr....r....r
+00000400: 1600 0000 da0a 3c6c 6973 7463 6f6d 703e  ......<listcomp>
+00000410: 1f00 0000 7302 0000 0010 007a 205f 696e  ....s......z _in
+00000420: 7465 6772 6174 655f 6b2e 3c6c 6f63 616c  tegrate_k.<local
+00000430: 733e 2e3c 6c69 7374 636f 6d70 3ee9 0100  s>.<listcomp>...
+00000440: 0000 2903 da06 7661 6c75 6573 da03 6469  ..)...values..di
+00000450: 6dda 096d 6178 5f70 6f77 6572 2906 7220  m..max_power).r 
+00000460: 0000 00da 0569 7465 6d73 da03 7375 6dda  .....items..sum.
+00000470: 0574 7570 6c65 da09 5f5f 636c 6173 735f  .tuple..__class_
+00000480: 5f72 2100 0000 2907 721c 0000 0072 1a00  _r!...).r....r..
+00000490: 0000 da0f 696e 7465 6772 616c 5f76 616c  ....integral_val
+000004a0: 7565 7372 2000 0000 da06 706f 7765 7273  uesr .....powers
+000004b0: 721f 0000 00da 0a70 6f77 6572 735f 6164  r......powers_ad
+000004c0: 6472 1500 0000 7215 0000 0072 1600 0000  dr....r....r....
+000004d0: da0c 5f69 6e74 6567 7261 7465 5f6b 1700  .._integrate_k..
+000004e0: 0000 730e 0000 0004 0506 0110 010e 0110  ..s.............
+000004f0: 011a 0112 0172 2900 0000 6300 0000 0000  .....r)...c.....
+00000500: 0000 0000 0000 0002 0000 0005 0000 0007  ................
+00000510: 0000 0073 2800 0000 8800 6401 1900 6a00  ...s(.....d...j.
+00000520: 7d01 7401 8700 6601 6402 6403 8408 7402  }.t...f.d.d...t.
+00000530: 7c01 6404 1400 8301 4400 8301 8301 5300  |.d.....D.....S.
+00000540: 2905 7a75 0a20 2020 204c 6574 2070 5f31  ).zu.    Let p_1
+00000550: 2c20 2e2e 2e2c 2070 5f6e 2062 6520 736f  , ..., p_n be so
+00000560: 6d65 204c 6965 2070 6f6c 796e 6f6d 6961  me Lie polynomia
+00000570: 6c73 2e0a 2020 2020 5468 656e 2074 6869  ls..    Then thi
+00000580: 7320 726f 7574 696e 6520 7769 6c6c 2063  s routine will c
+00000590: 6f6d 7075 7465 2074 6865 2028 6c69 6e65  ompute the (line
+000005a0: 2920 696e 7465 6772 616c 2070 5f6b 2a64  ) integral p_k*d
+000005b0: 7a5f 6b2e 0a20 2020 2072 0100 0000 6301  z_k..    r....c.
+000005c0: 0000 0000 0000 0000 0000 0002 0000 0005  ................
+000005d0: 0000 0013 0000 0073 1a00 0000 6700 7c00  .......s....g.|.
+000005e0: 5d09 7d01 7400 8800 7c01 1900 7c01 8302  ].}.t...|...|...
+000005f0: 9102 7102 5300 7215 0000 0029 0172 2900  ..q.S.r....).r).
+00000600: 0000 a902 721b 0000 0072 1a00 0000 a901  ....r....r......
+00000610: 721c 0000 0072 1500 0000 7216 0000 0072  r....r....r....r
+00000620: 1d00 0000 2a00 0000 7302 0000 001a 007a  ....*...s......z
+00000630: 1e5f 696e 7465 6772 6174 652e 3c6c 6f63  ._integrate.<loc
+00000640: 616c 733e 2e3c 6c69 7374 636f 6d70 3ee9  als>.<listcomp>.
+00000650: 0200 0000 2903 7220 0000 0072 2300 0000  ....).r ...r#...
+00000660: da05 7261 6e67 6529 0272 1c00 0000 7220  ..range).r....r 
+00000670: 0000 0072 1500 0000 722b 0000 0072 1600  ...r....r+...r..
+00000680: 0000 da0a 5f69 6e74 6567 7261 7465 2400  ...._integrate$.
+00000690: 0000 7304 0000 000a 051e 0172 2e00 0000  ..s........r....
+000006a0: 6300 0000 0000 0000 0000 0000 0003 0000  c...............
+000006b0: 0004 0000 0007 0000 0073 5c00 0000 8802  .........s\.....
+000006c0: 6401 1900 6a00 7d01 7c01 6402 1400 8901  d...j.}.|.d.....
+000006d0: 7401 8802 8301 8801 6b02 7311 4a00 8201  t.......k.s.J...
+000006e0: 8802 6401 1900 6a02 7d02 7403 7c01 8301  ..d...j.}.t.|...
+000006f0: a004 a100 8900 7405 8700 8701 8702 6603  ......t.......f.
+00000700: 6403 6404 8408 7406 8801 8301 4400 8301  d.d...t.....D...
+00000710: 8e00 0b00 7c02 1b00 5300 2905 610e 0400  ....|...S.).a...
+00000720: 000a 2020 2020 4c65 7420 675f 312c 202e  ..    Let g_1, .
+00000730: 2e2e 2c20 675f 6e20 6265 204c 6965 2070  .., g_n be Lie p
+00000740: 6f6c 796e 6f6d 6961 6c73 2061 6e64 207a  olynomials and z
+00000750: 5f6a 2074 6865 2063 6f6f 7264 696e 6174  _j the coordinat
+00000760: 6573 2028 696e 206f 7572 2073 6574 7469  es (in our setti
+00000770: 6e67 2063 6f6d 706c 6578 2078 692f 6574  ng complex xi/et
+00000780: 612d 636f 6f72 6469 6e61 7465 7329 2c0a  a-coordinates),.
+00000790: 2020 2020 7361 7469 7366 7969 6e67 0a20      satisfying. 
+000007a0: 2020 207b 675f 692c 207a 5f6a 7d20 3d20     {g_i, z_j} = 
+000007b0: 7b67 5f6a 2c20 7a5f 697d 2e20 2020 2028  {g_j, z_i}.    (
+000007c0: 3129 0a20 2020 2042 6563 6175 7365 2074  1).    Because t
+000007d0: 6865 204c 6965 2070 6f6c 796e 6f6d 6961  he Lie polynomia
+000007e0: 6c73 2061 7265 2061 6e61 6c79 7469 6320  ls are analytic 
+000007f0: 6675 6e63 7469 6f6e 7320 6279 2063 6f6e  functions by con
+00000800: 7374 7275 6374 696f 6e2c 2074 6865 7265  struction, there
+00000810: 206d 7573 7420 6578 6973 7420 6120 0a20   must exist a . 
+00000820: 2020 2070 6f74 656e 7469 616c 2048 2028     potential H (
+00000830: 4861 6d69 6c74 6f6e 6961 6e29 2073 6f20  Hamiltonian) so 
+00000840: 7468 6174 0a20 2020 2067 5f6a 203d 207b  that.    g_j = {
+00000850: 482c 207a 5f6a 7d20 2020 2020 2832 290a  H, z_j}     (2).
+00000860: 2020 2020 686f 6c64 732e 2054 6869 7320      holds. This 
+00000870: 6973 2074 6865 2027 7379 6d70 6c65 6374  is the 'symplect
+00000880: 6963 2720 7661 7269 616e 7420 6f66 2074  ic' variant of t
+00000890: 6865 2050 6f69 6e63 6172 6520 4c65 6d6d  he Poincare Lemm
+000008a0: 612e 0a20 2020 204f 6276 696f 7573 6c79  a..    Obviously
+000008b0: 2c20 7468 6520 6465 6772 6565 206f 6620  , the degree of 
+000008c0: 4820 6973 2074 6865 6e20 6769 7665 6e20  H is then given 
+000008d0: 6279 206d 6178 285b 6465 6728 675f 6a29  by max([deg(g_j)
+000008e0: 2066 6f72 206a 2069 6e20 312c 202e 2e2e   for j in 1, ...
+000008f0: 2c20 6e5d 2920 2b20 312e 0a20 2020 200a  , n]) + 1..    .
+00000900: 2020 2020 5765 2073 6861 6c6c 2066 6f6c      We shall fol
+00000910: 6c6f 7720 7468 6520 7374 6570 7320 6f75  low the steps ou
+00000920: 746c 696e 6564 2069 6e20 5265 662e 205b  tlined in Ref. [
+00000930: 315d 2c20 4c65 6d6d 6120 362e 3220 696e  1], Lemma 6.2 in
+00000940: 2053 6563 7469 6f6e 2037 2028 4661 6374   Section 7 (Fact
+00000950: 6f72 697a 6174 696f 6e20 5468 656f 7265  orization Theore
+00000960: 6d29 2e0a 2020 2020 0a20 2020 2050 6172  m)..    .    Par
+00000970: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00000980: 2d2d 2d2d 2d2d 0a20 2020 2067 3a20 706f  ------.    g: po
+00000990: 6c79 0a20 2020 2020 2020 204f 6e65 206f  ly.        One o
+000009a0: 7220 6d6f 7265 204c 6965 2070 6f6c 796e  r more Lie polyn
+000009b0: 6f6d 6961 6c73 2068 6176 696e 6720 7072  omials having pr
+000009c0: 6f70 6572 7479 2028 3129 2061 626f 7665  operty (1) above
+000009d0: 2028 5761 726e 696e 673a 204e 6f20 6368   (Warning: No ch
+000009e0: 6563 6b20 6167 6169 6e73 7420 7468 6973  eck against this
+000009f0: 2070 726f 7065 7274 7920 6865 7265 2e29   property here.)
+00000a00: 0a20 2020 2020 2020 200a 2020 2020 5265  .        .    Re
+00000a10: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
+00000a20: 2d0a 2020 2020 706f 6c79 0a20 2020 2020  -.    poly.     
+00000a30: 2020 2041 204c 6965 2070 6f6c 796e 6f6d     A Lie polynom
+00000a40: 6961 6c20 4820 7361 7469 7366 7969 6e67  ial H satisfying
+00000a50: 2045 712e 2028 3229 2061 626f 7665 2e0a   Eq. (2) above..
+00000a60: 2020 2020 0a20 2020 2052 6566 6572 656e      .    Referen
+00000a70: 6365 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ces.    --------
+00000a80: 2d2d 0a20 2020 205b 315d 2041 2e20 4472  --.    [1] A. Dr
+00000a90: 6167 743a 2022 4c69 6520 4d65 7468 6f64  agt: "Lie Method
+00000aa0: 7320 666f 7220 4e6f 6e6c 696e 6561 7220  s for Nonlinear 
+00000ab0: 4479 6e61 6d69 6373 2077 6974 6820 4170  Dynamics with Ap
+00000ac0: 706c 6963 6174 696f 6e73 2074 6f20 4163  plications to Ac
+00000ad0: 6365 6c65 7261 746f 7220 5068 7973 6963  celerator Physic
+00000ae0: 7322 2c20 556e 6976 6572 7369 7479 206f  s", University o
+00000af0: 6620 4d61 7279 6c61 6e64 2c20 3230 3230  f Maryland, 2020
+00000b00: 2c0a 2020 2020 2020 2020 6874 7470 3a2f  ,.        http:/
+00000b10: 2f77 7777 2e70 6879 7369 6373 2e75 6d64  /www.physics.umd
+00000b20: 2e65 6475 2f64 7361 742f 0a20 2020 2072  .edu/dsat/.    r
+00000b30: 0100 0000 722c 0000 0063 0100 0000 0000  ....r,...c......
+00000b40: 0000 0000 0000 0100 0000 0600 0000 1300  ................
+00000b50: 0000 732a 0000 0067 007c 005d 1189 0074  ..s*...g.|.]...t
+00000b60: 0087 0187 0387 0066 0364 0064 0184 0874  .......f.d.d...t
+00000b70: 0188 0283 0144 0083 0183 0191 0271 0253  .....D.......q.S
+00000b80: 0029 0263 0100 0000 0000 0000 0000 0000  .).c............
+00000b90: 0200 0000 0600 0000 1300 0000 7320 0000  ............s ..
+00000ba0: 0067 007c 005d 0c7d 0188 017c 0119 0088  .g.|.].}...|....
+00000bb0: 0088 027c 0166 0219 0014 0091 0271 0253  ...|.f.......q.S
+00000bc0: 0072 1500 0000 7215 0000 0072 2a00 0000  .r....r....r*...
+00000bd0: 2903 da04 4a69 6e76 da01 67da 016c 7215  )...Jinv..g..lr.
+00000be0: 0000 0072 1600 0000 721d 0000 0053 0000  ...r....r....S..
+00000bf0: 0073 0200 0000 2000 7a2a 7379 6d70 6f69  .s.... .z*sympoi
+00000c00: 6e63 6172 652e 3c6c 6f63 616c 733e 2e3c  ncare.<locals>.<
+00000c10: 6c69 7374 636f 6d70 3e2e 3c6c 6973 7463  listcomp>.<listc
+00000c20: 6f6d 703e a902 7223 0000 0072 2d00 0000  omp>..r#...r-...
+00000c30: a901 721b 0000 00a9 0372 2f00 0000 da04  ..r......r/.....
+00000c40: 6469 6d32 7230 0000 00a9 0172 3100 0000  dim2r0.....r1...
+00000c50: 7216 0000 0072 1d00 0000 5300 0000 f302  r....r....S.....
+00000c60: 0000 002a 007a 1f73 796d 706f 696e 6361  ...*.z.sympoinca
+00000c70: 7265 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973  re.<locals>.<lis
+00000c80: 7463 6f6d 703e 2907 7220 0000 00da 036c  tcomp>).r .....l
+00000c90: 656e da0f 5f70 6f69 7373 6f6e 5f66 6163  en.._poisson_fac
+00000ca0: 746f 7272 0700 0000 da09 7472 616e 7370  torr......transp
+00000cb0: 6f73 6572 2e00 0000 722d 0000 0029 0372  oser....r-...).r
+00000cc0: 3000 0000 7220 0000 00da 0270 6672 1500  0...r .....pfr..
+00000cd0: 0000 7234 0000 0072 1600 0000 da0b 7379  ..r4...r......sy
+00000ce0: 6d70 6f69 6e63 6172 652c 0000 0073 0c00  mpoincare,...s..
+00000cf0: 0000 0a1c 0801 1002 0a01 0c02 2405 723c  ............$.r<
+00000d00: 0000 00da 0461 7574 6fda 0572 6967 6874  .....auto..right
+00000d10: 5467 8ded b5a0 f7c6 b03e 4629 09da 056f  Tg.......>F)...o
+00000d20: 7264 6572 da06 6f66 6673 6574 da04 706f  rder..offset..po
+00000d30: 7332 da05 636f 6d62 32da 0374 6f6c da0a  s2..comb2..tol..
+00000d40: 746f 6c5f 6368 6563 6b73 da0c 6469 7361  tol_checks..disa
+00000d50: 626c 655f 7471 646d da0b 666f 7263 655f  ble_tqdm..force_
+00000d60: 6f72 6465 72da 0477 6172 6e63 0000 0000  order..warnc....
+00000d70: 0000 0000 0900 0000 2a00 0000 0d00 0000  ........*.......
+00000d80: 0f00 0000 73ea 0600 0088 0664 0119 006a  ....s......d...j
+00000d90: 0089 0188 0164 0214 0089 0274 0187 0166  .....d.....t...f
+00000da0: 0164 0364 0484 0888 0644 0083 0183 0173  .d.d.....D.....s
+00000db0: 164a 0082 0188 0664 0119 006a 0289 0774  .J.....d...j...t
+00000dc0: 0187 0766 0164 0564 0484 0888 0644 0083  ...f.d.d.....D..
+00000dd0: 0183 0173 284a 0082 0174 0388 0683 0188  ...s(J...t......
+00000de0: 026b 0273 3a4a 0064 0674 0388 0683 019b  .k.s:J.d.t......
+00000df0: 0064 0788 029b 009d 0483 0182 0174 0464  .d...........t.d
+00000e00: 0267 0164 0864 0484 0088 0644 0083 0117  .g.d.d.....D....
+00000e10: 0083 017d 0b74 0464 0964 0484 0088 0644  ...}.t.d.d.....D
+00000e20: 0083 0183 017d 0c7c 0064 0a6b 0272 637c  .....}.|.d.k.rc|
+00000e30: 0872 6174 05a0 0664 0b7c 009b 0064 0c7c  .rat...d.|...d.|
+00000e40: 0b9b 0064 0d9d 05a1 0101 007c 0b7d 007c  ...d.......|.}.|
+00000e50: 007c 0b64 0e17 006b 0072 6e7c 0074 076a  .|.d...k.rn|.t.j
+00000e60: 086b 0073 784a 0064 0f7c 0b64 0e17 009b  .k.sxJ.d.|.d....
+00000e70: 0064 109d 0383 0182 0174 037c 0a83 0164  .d.......t.|...d
+00000e80: 016b 0272 857c 0872 8574 05a0 0664 11a1  .k.r.|.r.t...d..
+00000e90: 0101 0074 0388 0583 0164 016b 0272 9a64  ...t.....d.k.r.d
+00000ea0: 0167 0188 0214 0089 0887 0266 0164 1264  .g.........f.d.d
+00000eb0: 0484 0888 0644 0083 0189 036e 1e74 0388  .....D.....n.t..
+00000ec0: 0583 0188 026b 0273 ad4a 0064 1374 0388  .....k.s.J.d.t..
+00000ed0: 0583 019b 0064 1488 029b 0064 109d 0583  .....d.....d....
+00000ee0: 0182 0188 0589 0887 0566 0164 1564 0484  .........f.d.d..
+00000ef0: 0888 0644 0083 0189 037c 0064 016b 0272  ...D.....|.d.k.r
+00000f00: d087 0387 0866 0264 1664 0484 0874 0988  .....f.d.d...t..
+00000f10: 0283 0144 0083 017d 0d74 0a7c 0d64 1788  ...D...}.t.|.d..
+00000f20: 0769 018e 0167 0153 0074 0b64 1864 0484  .i...g.S.t.d.d..
+00000f30: 0088 0844 0083 0183 017d 0e7c 0e90 0172  ...D.....}.|...r
+00000f40: 0874 0a88 0888 077c 0b64 199c 028e 017d  .t.....|.d.....}
+00000f50: 0f74 0c7c 0f83 0188 0664 1a64 1b69 018e  .t.|.....d.d.i..
+00000f60: 0189 067c 007c 0c6b 0590 0172 087c 0790  ...|.|.k...r.|..
+00000f70: 0173 087c 0890 0172 0474 05a0 0664 1c7c  .s.|...r.t...d.|
+00000f80: 009b 0064 1d7c 0c9b 0064 1e9d 05a1 0101  ...d.|...d......
+00000f90: 007c 0064 0e18 007d 007c 007c 0c6b 0490  .|.d...}.|.|.k..
+00000fa0: 0172 1c7c 0890 0172 1c74 05a0 0664 1c7c  .r.|...r.t...d.|
+00000fb0: 009b 0064 1f7c 0c9b 0064 209d 05a1 0101  ...d.|...d .....
+00000fc0: 0074 07a0 0d64 2164 0484 0088 0644 0083  .t...d!d.....D..
+00000fd0: 01a1 017d 1074 0e7c 1083 017d 1074 0e74  ...}.t.|...}.t.t
+00000fe0: 0f88 0183 0183 017d 117c 10a0 10a1 007d  .......}.|.....}
+00000ff0: 127c 110b 007c 1210 007c 1110 0089 007c  .|...|...|.....|
+00001000: 0564 016b 0490 0172 797c 127c 1110 007c  .d.k...ry|.|...|
+00001010: 1010 007d 1374 0f88 017c 106a 1164 0264  ...}.t...|.j.d.d
+00001020: 2285 0219 0064 238d 027d 1474 07a0 1274  "....d#..}.t...t
+00001030: 076a 13a0 147c 136a 157c 1418 00a1 0164  .j...|.j.|.....d
+00001040: 0213 0074 07a0 167c 106a 1164 0264 2285  ...t...|.j.d.d".
+00001050: 0219 00a1 011b 00a1 017d 157c 157c 056b  .........}.|.|.k
+00001060: 0090 0173 794a 0064 247c 159b 0064 1d7c  ...syJ.d$|...d.|
+00001070: 059b 0064 259d 0583 0182 017c 0390 0172  ...d%......|...r
+00001080: a97a 1a74 177c 126a 1583 017d 1674 187c  .z.t.|.j...}.t.|
+00001090: 1688 077c 057c 0b64 268d 04a0 1988 09a1  ...|.|.d&.......
+000010a0: 017d 177c 1764 0114 007d 187c 1664 0114  .}.|.d...}.|.d..
+000010b0: 007d 1957 006e 1201 0001 0001 007c 0890  .}.W.n.......|..
+000010c0: 0172 a674 05a0 0664 2788 099b 0064 289d  .r.t...d'....d(.
+000010d0: 03a1 0101 0064 297d 0359 007c 0390 0173  .....d)}.Y.|...s
+000010e0: cb74 1a7c 126a 157c 0564 2a8d 025c 027d  .t.|.j.|.d*..\.}
+000010f0: 167d 1974 187c 1688 077c 057c 0b64 268d  .}.t.|...|.|.d&.
+00001100: 04a0 1988 09a1 017d 1774 187c 1988 077c  .......}.t.|...|
+00001110: 057c 0b64 268d 04a0 1988 09a1 017d 187c  .|.d&........}.|
+00001120: 0564 016b 0490 0272 0d74 1b7c 1683 0174  .d.k...r.t.|...t
+00001130: 1b7c 1983 0102 027d 1a7d 1b74 0e7c 1a83  .|.....}.}.t.|..
+00001140: 0174 0e7c 1b83 0102 027d 1a7d 1b7c 1a7c  .t.|.....}.}.|.|
+00001150: 1b10 007d 1c74 07a0 1274 076a 13a0 147c  ...}.t...t.j...|
+00001160: 1c6a 157c 126a 1518 00a1 0164 0213 0074  .j.|.j.....d...t
+00001170: 07a0 167c 106a 1164 0264 2285 0219 00a1  ...|.j.d.d".....
+00001180: 011b 00a1 017d 157c 157c 056b 0090 0273  .....}.|.|.k...s
+00001190: 064a 0082 0174 1c88 0188 077c 0b64 198d  .J...t.....|.d..
+000011a0: 037d 1d87 0087 0287 0666 0364 2b64 0484  .}.......f.d+d..
+000011b0: 0874 0988 0283 0144 0083 017d 1e88 0964  .t.....D...}...d
+000011c0: 016b 0490 0272 2887 0966 0164 2c64 0484  .k...r(..f.d,d..
+000011d0: 087c 1e44 0083 017d 1e67 007d 1f7c 1764  .|.D...}.g.}.|.d
+000011e0: 016b 0390 0272 347c 1fa0 1d7c 17a1 0101  .k...r4|...|....
+000011f0: 007c 1864 016b 0390 0272 3e7c 1fa0 1d7c  .|.d.k...r>|...|
+00001200: 18a1 0101 0067 007d 2074 1e74 0964 027c  .....g.} t.t.d.|
+00001210: 0064 0e17 0083 027c 0664 2d8d 0244 005d  .d.....|.d-..D.]
+00001220: c089 0487 0466 0164 2e64 0484 087c 1e44  .....f.d.d...|.D
+00001230: 0083 017d 2174 037c 2183 0164 016b 0290  ...}!t.|!..d.k..
+00001240: 0273 6b74 0364 2f64 0484 007c 2144 0083  .skt.d/d...|!D..
+00001250: 0183 0174 037c 1e83 016b 0290 0272 6d90  ...t.|...k...rm.
+00001260: 0271 4b7c 0564 016b 0490 0272 aa74 0988  .qK|.d.k...r.t..
+00001270: 0283 0144 005d 337d 2274 097c 2283 0144  ...D.]3}"t.|"..D
+00001280: 005d 2b7d 237c 1d7c 2319 007c 217c 2219  .]+}#|.|#..|!|".
+00001290: 0010 007c 217c 2319 007c 1d7c 2219 0010  ...|!|#..|.|"...
+000012a0: 0017 007d 247c 24a0 197c 05a1 0164 016b  ...}$|$..|...d.k
+000012b0: 0290 0273 a64a 0064 3088 049b 0064 317c  ...s.J.d0....d1|
+000012c0: 059b 0064 327c 0a9b 0064 337c 249b 009d  ...d2|...d3|$...
+000012d0: 0883 0182 0190 0271 7c90 0271 7674 1f7c  .......q|..qvt.|
+000012e0: 218e 00a0 1988 09a1 017d 257c 2564 016b  !........}%|%d.k
+000012f0: 0290 0272 b890 0271 4b74 0c7c 250b 0083  ...r...qKt.|%...
+00001300: 017d 267c 267c 1e69 007c 0aa4 018e 017d  .}&|&|.i.|.....}
+00001310: 1e7c 0564 016b 0490 0372 0574 0988 0283  .|.d.k...r.t....
+00001320: 0144 005d 377d 227c 1e7c 2219 007c 1d7c  .D.]7}"|.|"..|.|
+00001330: 2219 0018 00a0 197c 05a1 016a 2064 3464  "......|...j d4d
+00001340: 3584 0064 368d 017d 277c 2764 016b 0390  5..d6..}'|'d.k..
+00001350: 0372 037c 27a0 21a1 0088 0464 0e17 006b  .r.|'.!....d...k
+00001360: 0590 0373 034a 0064 3788 0464 0e17 009b  ...s.J.d7..d....
+00001370: 0064 3888 049b 0064 317c 059b 0064 337c  .d8....d1|...d3|
+00001380: 27a0 2288 04a1 019b 009d 0883 0182 0190  '.".............
+00001390: 0271 cd7c 20a0 1d7c 25a1 0101 0090 0271  .q.| ..|%......q
+000013a0: 4b7c 0264 396b 0290 0372 167c 207c 1f17  K|.d9k...r.| |..
+000013b0: 007d 1f6e 2867 007d 2874 037c 2083 0164  .}.n(g.}(t.| ..d
+000013c0: 016b 0490 0372 3374 0c7c 180b 0083 0174  .k...r3t.|.....t
+000013d0: 0c7c 170b 0083 017c 2064 3a64 1b64 3b9c  .|.....| d:d.d;.
+000013e0: 028e 0164 3a64 1b64 3b9c 028e 017d 287c  ...d:d.d;....}(|
+000013f0: 1f87 0966 0164 3c64 0484 087c 2844 0083  ...f.d<d...|(D..
+00001400: 0117 007d 1f7c 0e90 0372 487c 1fa0 2364  ...}.|...rH|..#d
+00001410: 017c 0f0b 00a1 0201 0074 0b64 3d64 0484  .|.......t.d=d..
+00001420: 0088 0344 0083 0183 0190 0372 7374 0a88  ...D.......rst..
+00001430: 0388 077c 0b64 199c 028e 017d 297c 0e90  ...|.d.....})|..
+00001440: 0372 6e74 037c 1f83 0164 0e6b 0290 0372  .rnt.|...d.k...r
+00001450: 6e7c 1f64 0105 0019 007c 2937 0003 003c  n|.d.....|)7...<
+00001460: 007c 1f53 007c 1fa0 1d7c 29a1 0101 007c  .|.S.|...|)....|
+00001470: 1f53 0029 3e61 470b 0000 0a20 2020 204c  .S.)>aG....    L
+00001480: 6574 2070 5f31 2c20 2e2e 2e2c 2070 5f6e  et p_1, ..., p_n
+00001490: 2062 6520 706f 6c79 6e6f 6d69 616c 7320   be polynomials 
+000014a0: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
+000014b0: 2054 6179 6c6f 7220 6578 7061 6e73 696f   Taylor expansio
+000014c0: 6e73 206f 660a 2020 2020 7468 6520 636f  ns of.    the co
+000014d0: 6d70 6f6e 656e 7473 206f 6620 6120 7379  mponents of a sy
+000014e0: 6d70 6c65 6374 6963 206d 6170 204d 2e20  mplectic map M. 
+000014f0: 0a20 2020 2020 2020 200a 2020 2020 5468  .        .    Th
+00001500: 656e 2074 6869 7320 726f 7574 696e 6520  en this routine 
+00001510: 7769 6c6c 2066 696e 6420 706f 6c79 6e6f  will find polyno
+00001520: 6d69 616c 7320 665f 312c 2067 5f31 2c20  mials f_1, g_1, 
+00001530: 6632 5f61 2c20 6632 5f62 2c20 6633 2c20  f2_a, f2_b, f3, 
+00001540: 6634 2c20 6635 2c20 2e2e 2e2c 0a20 2020  f4, f5, ...,.   
+00001550: 2077 6865 7265 2066 5f6b 2069 7320 6120   where f_k is a 
+00001560: 686f 6d6f 6765 6e65 6f75 7320 706f 6c79  homogeneous poly
+00001570: 6e6f 6d69 616c 206f 6620 6465 6772 6565  nomial of degree
+00001580: 206b 2c20 736f 2074 6861 740a 2020 2020   k, so that.    
+00001590: 4d20 7e20 6578 7028 3a66 313a 2920 6f20  M ~ exp(:f1:) o 
+000015a0: 6578 7028 3a66 325f 613a 2920 6f20 6578  exp(:f2_a:) o ex
+000015b0: 7028 3a66 325f 623a 2920 6f20 6578 7028  p(:f2_b:) o exp(
+000015c0: 3a66 333a 2920 6f20 6578 7028 3a66 343a  :f3:) o exp(:f4:
+000015d0: 2920 6f20 2e2e 2e20 6f20 6578 7028 3a66  ) o ... o exp(:f
+000015e0: 6e3a 2920 6f20 6578 7028 3a67 313a 290a  n:) o exp(:g1:).
+000015f0: 2020 2020 686f 6c64 732e 2054 6865 2070      holds. The p
+00001600: 6f73 6974 696f 6e20 6f66 2074 6865 2063  osition of the c
+00001610: 6861 696e 206f 6620 326e 6420 6f72 6465  hain of 2nd orde
+00001620: 7220 706f 6c79 6e6f 6d69 616c 7320 6361  r polynomials ca
+00001630: 6e20 6865 7265 6279 2062 6520 6368 6f73  n hereby be chos
+00001640: 656e 2c0a 2020 2020 6279 2070 726f 7669  en,.    by provi
+00001650: 6469 6e67 2061 2027 706f 7332 272d 7061  ding a 'pos2'-pa
+00001660: 7261 6d65 7465 722e 0a20 2020 200a 2020  rameter..    .  
+00001670: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00001680: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00001690: 703a 2070 6f6c 790a 2020 2020 2020 2020  p: poly.        
+000016a0: 506f 6c79 6e6f 6d69 616c 7320 7265 7072  Polynomials repr
+000016b0: 6573 656e 7469 6e67 2074 6865 2063 6f6d  esenting the com
+000016c0: 706f 6e65 6e74 7320 6f66 2074 6865 2073  ponents of the s
+000016d0: 796d 706c 6563 7469 6320 6d61 7020 4d2e  ymplectic map M.
+000016e0: 0a20 2020 2020 2020 200a 2020 2020 6f72  .        .    or
+000016f0: 6465 723a 2069 6e74 2c20 6f70 7469 6f6e  der: int, option
+00001700: 616c 0a20 2020 2020 2020 2054 6865 206d  al.        The m
+00001710: 6178 696d 616c 2064 6567 7265 6520 6f66  aximal degree of
+00001720: 2074 6865 2061 7070 726f 7869 6d61 7465   the approximate
+00001730: 6420 6d61 7020 283d 206d 6178 696d 616c  d map (= maximal
+00001740: 2064 6567 7265 6520 6f66 2074 6865 2070   degree of the p
+00001750: 6f6c 796e 6f6d 6961 6c73 2066 6b20 6162  olynomials fk ab
+00001760: 6f76 6520 2d20 3129 2e0a 2020 2020 2020  ove - 1)..      
+00001770: 2020 0a20 2020 206f 6666 7365 743a 2073    .    offset: s
+00001780: 7562 7363 7269 7074 6162 6c65 2c20 6f70  ubscriptable, op
+00001790: 7469 6f6e 616c 0a20 2020 2020 2020 2041  tional.        A
+000017a0: 6e20 6f70 7469 6f6e 616c 2070 6f69 6e74  n optional point
+000017b0: 206f 6620 7265 6665 7265 6e63 6520 6172   of reference ar
+000017c0: 6f75 6e64 2077 6869 6368 2074 6865 206d  ound which the m
+000017d0: 6170 2073 686f 756c 6420 6265 2072 6570  ap should be rep
+000017e0: 7265 7365 6e74 6564 2e0a 2020 2020 2020  resented..      
+000017f0: 2020 4279 2064 6566 6175 6c74 2c20 7468    By default, th
+00001800: 6973 2070 6f69 6e74 2069 7320 7a65 726f  is point is zero
+00001810: 2e0a 2020 2020 2020 2020 0a20 2020 2070  ..        .    p
+00001820: 6f73 323a 2073 7472 2c20 6f70 7469 6f6e  os2: str, option
+00001830: 616c 0a20 2020 2020 2020 2045 6974 6865  al.        Eithe
+00001840: 7220 276c 6566 7427 206f 7220 2772 6967  r 'left' or 'rig
+00001850: 6874 2720 2864 6566 6175 6c74 292e 2054  ht' (default). T
+00001860: 6865 206f 7574 636f 6d65 2077 696c 6c20  he outcome will 
+00001870: 6465 7465 726d 696e 6520 7468 6520 7265  determine the re
+00001880: 7072 6573 656e 7461 7469 6f6e 206f 6620  presentation of 
+00001890: 4d3a 0a20 2020 2020 2020 2070 6f73 3220  M:.        pos2 
+000018a0: 3d3d 2027 7269 6768 7427 3a0a 2020 2020  == 'right':.    
+000018b0: 2020 2020 4d20 7e20 6578 7028 3a66 313a      M ~ exp(:f1:
+000018c0: 2920 6f20 6578 7028 3a66 333a 2920 6f20  ) o exp(:f3:) o 
+000018d0: 6578 7028 3a66 343a 2920 6f20 2e2e 2e20  exp(:f4:) o ... 
+000018e0: 6f20 6578 7028 3a66 6e3a 2920 6f20 6578  o exp(:fn:) o ex
+000018f0: 7028 3a66 325f 613a 2920 6f20 6578 7028  p(:f2_a:) o exp(
+00001900: 3a66 325f 623a 2920 6f20 6578 7028 3a67  :f2_b:) o exp(:g
+00001910: 313a 290a 2020 2020 2020 2020 706f 7332  1:).        pos2
+00001920: 203d 3d20 276c 6566 7427 3a0a 2020 2020   == 'left':.    
+00001930: 2020 2020 4d20 7e20 6578 7028 3a66 313a      M ~ exp(:f1:
+00001940: 2920 6f20 6578 7028 3a66 325f 613a 2920  ) o exp(:f2_a:) 
+00001950: 6f20 6578 7028 3a66 325f 623a 2920 6f20  o exp(:f2_b:) o 
+00001960: 6578 7028 3a66 333a 2920 6f20 6578 7028  exp(:f3:) o exp(
+00001970: 3a66 343a 2920 6f20 2e2e 2e20 6f20 6578  :f4:) o ... o ex
+00001980: 7028 3a66 6e3a 2920 6f20 6578 7028 3a67  p(:fn:) o exp(:g
+00001990: 313a 290a 2020 2020 2020 2020 0a20 2020  1:).        .   
+000019a0: 2063 6f6d 6232 3a20 626f 6f6c 6561 6e2c   comb2: boolean,
+000019b0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+000019c0: 2020 4966 2074 7275 652c 2074 6865 6e20    If true, then 
+000019d0: 7472 7920 746f 2066 696e 6420 6120 7369  try to find a si
+000019e0: 6e67 6c65 2032 6e64 2d6f 7264 6572 2070  ngle 2nd-order p
+000019f0: 6f6c 796e 6f6d 6961 6c2c 2062 7920 6170  olynomial, by ap
+00001a00: 706c 7969 6e67 2073 6369 7079 2e6c 696e  plying scipy.lin
+00001a10: 616c 672e 6c6f 676d 2e0a 2020 2020 2020  alg.logm..      
+00001a20: 2020 4966 2074 6869 7320 6661 696c 7320    If this fails 
+00001a30: 2877 6869 6368 2069 7320 7468 6520 6361  (which is the ca
+00001a40: 7365 2069 6620 7468 6520 6d61 7472 6978  se if the matrix
+00001a50: 206c 6f67 6172 6974 686d 2068 6173 206e   logarithm has n
+00001a60: 6f20 7265 7072 6573 656e 7461 7469 6f6e  o representation
+00001a70: 2069 6e20 7465 726d 7320 6f66 2061 204c   in terms of a L
+00001a80: 6965 2d70 6f6c 796e 6f6d 6961 6c29 2c20  ie-polynomial), 
+00001a90: 0a20 2020 2020 2020 2074 6865 6e20 7765  .        then we
+00001aa0: 2077 696c 6c20 6661 6c6c 2062 6163 6b20   will fall back 
+00001ab0: 746f 2074 6865 2022 636f 6d62 323d 4661  to the "comb2=Fa
+00001ac0: 6c73 6522 2d63 6173 6520 616e 6420 6120  lse"-case and a 
+00001ad0: 7761 726e 696e 6720 7769 6c6c 2062 6520  warning will be 
+00001ae0: 6973 7375 6564 2e0a 2020 2020 2020 2020  issued..        
+00001af0: 4966 2066 616c 7365 2c20 7468 656e 206c  If false, then l
+00001b00: 6965 6f70 732e 6c69 6e61 6c67 2e73 796d  ieops.linalg.sym
+00001b10: 6c6f 6773 2077 696c 6c20 6265 2075 7365  logs will be use
+00001b20: 6420 2877 6869 6368 206d 6179 2070 726f  d (which may pro
+00001b30: 6475 6365 2074 776f 204c 6965 2d70 6f6c  duce two Lie-pol
+00001b40: 796e 6f6d 6961 6c73 2065 7665 6e0a 2020  ynomials even.  
+00001b50: 2020 2020 2020 696e 2063 6572 7461 696e        in certain
+00001b60: 2063 6173 6573 2069 6e20 7768 6963 6820   cases in which 
+00001b70: 7468 6572 6520 776f 756c 6420 616c 7265  there would alre
+00001b80: 6164 7920 6578 6973 7420 6120 7369 6e67  ady exist a sing
+00001b90: 6c65 206f 6e65 2064 6f69 6e67 2074 6865  le one doing the
+00001ba0: 206a 6f62 292e 0a0a 2020 2020 746f 6c3a   job)...    tol:
+00001bb0: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
+00001bc0: 0a20 2020 2020 2020 2049 6465 6e74 6966  .        Identif
+00001bd0: 7920 736d 616c 6c20 666b 2061 6e64 2064  y small fk and d
+00001be0: 726f 7020 7468 656d 2069 6620 616c 6c20  rop them if all 
+00001bf0: 7468 6569 7220 7661 6c75 6573 2061 7265  their values are
+00001c00: 2062 656c 6f77 2074 6869 7320 7468 7265   below this thre
+00001c10: 7368 6f6c 642e 0a20 2020 2020 2020 200a  shold..        .
+00001c20: 2020 2020 746f 6c5f 6368 6563 6b73 3a20      tol_checks: 
+00001c30: 666c 6f61 742c 206f 7074 696f 6e61 6c0a  float, optional.
+00001c40: 2020 2020 2020 2020 4966 203e 2030 2c20          If > 0, 
+00001c50: 7065 7266 6f72 6d20 6365 7274 6169 6e20  perform certain 
+00001c60: 636f 6e73 6973 7465 6e63 7920 6368 6563  consistency chec
+00001c70: 6b73 2064 7572 696e 6720 7468 6520 6361  ks during the ca
+00001c80: 6c63 756c 6174 696f 6e2e 0a20 2020 2020  lculation..     
+00001c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001ca0: 2020 200a 2020 2020 6469 7361 626c 655f     .    disable_
+00001cb0: 7471 646d 3a20 626f 6f6c 6561 6e2c 206f  tqdm: boolean, o
+00001cc0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00001cd0: 4966 2074 7275 652c 2064 6973 6162 6c65  If true, disable
+00001ce0: 2074 6865 2074 7164 6d20 7374 6174 7573   the tqdm status
+00001cf0: 2062 6172 2070 7269 6e74 6f75 742e 0a20   bar printout.. 
+00001d00: 2020 2020 2020 200a 2020 2020 666f 7263         .    forc
+00001d10: 655f 6f72 6465 723a 2062 6f6f 6c65 616e  e_order: boolean
+00001d20: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00001d30: 2020 2049 6620 7472 7565 2c20 646f 206e     If true, do n
+00001d40: 6f74 2063 6861 6e67 6520 7468 6520 6f72  ot change the or
+00001d50: 6465 7220 6279 202d 3120 696e 2063 6173  der by -1 in cas
+00001d60: 6520 3129 2061 6e20 6f66 6673 6574 2069  e 1) an offset i
+00001d70: 7320 6465 7465 6374 6564 2061 6e64 2032  s detected and 2
+00001d80: 2920 6f72 6465 7220 3e3d 2064 6567 7265  ) order >= degre
+00001d90: 6520 6f66 2074 6865 2054 6179 6c6f 7220  e of the Taylor 
+00001da0: 6d61 702e 0a20 2020 2020 2020 2044 6566  map..        Def
+00001db0: 6175 6c74 3a20 2866 616c 7365 290a 2020  ault: (false).  
+00001dc0: 2020 2020 2020 0a20 2020 2077 6172 6e3a        .    warn:
+00001dd0: 2062 6f6f 6c65 616e 2c20 6f70 7469 6f6e   boolean, option
+00001de0: 616c 0a20 2020 2020 2020 2053 7570 7265  al.        Supre
+00001df0: 7373 206f 7220 7368 6f77 2077 6172 6e69  ss or show warni
+00001e00: 6e67 732e 0a20 2020 2020 2020 200a 2020  ngs..        .  
+00001e10: 2020 2a2a 6b77 6172 6773 0a20 2020 2020    **kwargs.     
+00001e20: 2020 2046 7572 7468 6572 2069 6e70 7574     Further input
+00001e30: 2070 6172 616d 6574 6572 7320 7061 7373   parameters pass
+00001e40: 6564 2074 6f20 6c69 656f 7073 2e63 6f72  ed to lieops.cor
+00001e50: 652e 6c69 652e 6c65 7870 2066 6c6f 7720  e.lie.lexp flow 
+00001e60: 6361 6c63 756c 6174 696f 6e2e 0a20 2020  calculation..   
+00001e70: 200a 2020 2020 5265 7475 726e 730a 2020   .    Returns.  
+00001e80: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6c69    -------.    li
+00001e90: 7374 0a20 2020 2020 2020 2041 206c 6973  st.        A lis
+00001ea0: 7420 6f66 2070 6f6c 7920 6f62 6a65 6374  t of poly object
+00001eb0: 7320 5b66 312c 2066 325f 612c 2066 325f  s [f1, f2_a, f2_
+00001ec0: 622c 2066 332c 2066 342c 202e 2e2e 5d20  b, f3, f4, ...] 
+00001ed0: 696e 2074 6865 206f 7264 6572 2064 6573  in the order des
+00001ee0: 6372 6962 6564 2061 626f 7665 2e0a 2020  cribed above..  
+00001ef0: 2020 2020 2020 0a20 2020 2052 6566 6572        .    Refer
+00001f00: 656e 6365 730a 2020 2020 2d2d 2d2d 2d2d  ences.    ------
+00001f10: 2d2d 2d2d 0a20 2020 205b 315d 2041 2e20  ----.    [1] A. 
+00001f20: 4472 6167 743a 2022 4c69 6520 4d65 7468  Dragt: "Lie Meth
+00001f30: 6f64 7320 666f 7220 4e6f 6e6c 696e 6561  ods for Nonlinea
+00001f40: 7220 4479 6e61 6d69 6373 2077 6974 6820  r Dynamics with 
+00001f50: 4170 706c 6963 6174 696f 6e73 2074 6f20  Applications to 
+00001f60: 4163 6365 6c65 7261 746f 7220 5068 7973  Accelerator Phys
+00001f70: 6963 7322 2c20 556e 6976 6572 7369 7479  ics", University
+00001f80: 206f 6620 4d61 7279 6c61 6e64 2c20 3230   of Maryland, 20
+00001f90: 3230 2c0a 2020 2020 2020 2020 6874 7470  20,.        http
+00001fa0: 3a2f 2f77 7777 2e70 6879 7369 6373 2e75  ://www.physics.u
+00001fb0: 6d64 2e65 6475 2f64 7361 742f 0a20 2020  md.edu/dsat/.   
+00001fc0: 2072 0100 0000 722c 0000 0063 0100 0000   r....r,...c....
+00001fd0: 0000 0000 0000 0000 0200 0000 0400 0000  ................
+00001fe0: 1300 0000 f316 0000 0067 007c 005d 077d  .........g.|.].}
+00001ff0: 017c 016a 0088 006b 0291 0271 0253 0072  .|.j...k...q.S.r
+00002000: 1500 0000 a901 7220 0000 00a9 0272 1b00  ......r .....r..
+00002010: 0000 da01 6572 4900 0000 7215 0000 0072  ....erI...r....r
+00002020: 1600 0000 721d 0000 009a 0000 00f3 0200  ....r...........
+00002030: 0000 1600 7a1d 6472 6167 7466 696e 6e2e  ....z.dragtfinn.
+00002040: 3c6c 6f63 616c 733e 2e3c 6c69 7374 636f  <locals>.<listco
+00002050: 6d70 3e63 0100 0000 0000 0000 0000 0000  mp>c............
+00002060: 0200 0000 0400 0000 1300 0000 7248 0000  ............rH..
+00002070: 0072 1500 0000 2901 7239 0000 0072 4a00  .r....).r9...rJ.
+00002080: 0000 2901 723b 0000 0072 1500 0000 7216  ..).r;...r....r.
+00002090: 0000 0072 1d00 0000 9c00 0000 724c 0000  ...r........rL..
+000020a0: 007a 1650 6f6c 796e 6f6d 6961 6c73 2072  .z.Polynomials r
+000020b0: 6563 6569 7665 643a 207a 0b20 4578 7065  eceived: z. Expe
+000020c0: 6374 6564 3a20 6301 0000 0000 0000 0000  cted: c.........
+000020d0: 0000 0002 0000 0003 0000 0053 0000 0073  ...........S...s
+000020e0: 1200 0000 6700 7c00 5d05 7d01 7c01 6a00  ....g.|.].}.|.j.
+000020f0: 9102 7102 5300 7215 0000 0029 0172 2100  ..q.S.r....).r!.
+00002100: 0000 724a 0000 0072 1500 0000 7215 0000  ..rJ...r....r...
+00002110: 0072 1600 0000 721d 0000 009e 0000 0073  .r....r........s
+00002120: 0200 0000 1200 6301 0000 0000 0000 0000  ......c.........
+00002130: 0000 0002 0000 0004 0000 0053 0000 0073  ...........S...s
+00002140: 1400 0000 6700 7c00 5d06 7d01 7c01 a000  ....g.|.].}.|...
+00002150: a100 9102 7102 5300 7215 0000 0029 01da  ....q.S.r....)..
+00002160: 066d 6178 6465 6772 4a00 0000 7215 0000  .maxdegrJ...r...
+00002170: 0072 1500 0000 7216 0000 0072 1d00 0000  .r....r....r....
+00002180: 9f00 0000 f302 0000 0014 0072 3d00 0000  ...........r=...
+00002190: 7a0a 6f72 6465 7220 3d3d 2027 7a14 273a  z.order == 'z.':
+000021a0: 2053 6574 7469 6e67 206f 7264 6572 2074   Setting order t
+000021b0: 6f20 7a1d 2028 6d61 785f 706f 7765 7220  o z. (max_power 
+000021c0: 696e 2070 6f6c 7920 6f62 6a65 6374 7329  in poly objects)
+000021d0: 2e72 1e00 0000 7a37 5265 7175 6573 7465  .r....z7Requeste
+000021e0: 6420 6f72 6465 7220 6f66 2074 6865 2044  d order of the D
+000021f0: 7261 6774 2d46 696e 6e20 7365 7269 6573  ragt-Finn series
+00002200: 2063 616e 206e 6f74 2062 6520 3e3d 20da   can not be >= .
+00002210: 012e 7a17 4e6f 2066 6c6f 7720 7061 7261  ..z.No flow para
+00002220: 6d65 7465 7273 2073 6574 2e63 0100 0000  meters set.c....
+00002230: 0000 0000 0000 0000 0200 0000 0600 0000  ................
+00002240: 1300 0000 731c 0000 0067 007c 005d 0a7d  ....s....g.|.].}
+00002250: 017c 01a0 0064 0088 0014 0064 01a1 0291  .|...d.....d....
+00002260: 0271 0253 0029 02a9 0172 0100 0000 7201  .q.S.)...r....r.
+00002270: 0000 0029 01da 0367 6574 724a 0000 0029  ...)...getrJ...)
+00002280: 0172 3500 0000 7215 0000 0072 1600 0000  .r5...r....r....
+00002290: 721d 0000 00ab 0000 00f3 0200 0000 1c00  r...............
+000022a0: 7a1b 5265 6665 7265 6e63 6520 706f 696e  z.Reference poin
+000022b0: 7420 6469 6d65 6e73 696f 6e3a 207a 0c2c  t dimension: z.,
+000022c0: 2065 7870 6563 7465 643a 2063 0100 0000   expected: c....
+000022d0: 0000 0000 0000 0000 0200 0000 0400 0000  ................
+000022e0: 1300 0000 7314 0000 0067 007c 005d 067d  ....s....g.|.].}
+000022f0: 017c 0188 008e 0091 0271 0253 0072 1500  .|.......q.S.r..
+00002300: 0000 7215 0000 0072 4a00 0000 2901 7240  ..r....rJ...).r@
+00002310: 0000 0072 1500 0000 7216 0000 0072 1d00  ...r....r....r..
+00002320: 0000 af00 0000 724e 0000 0063 0100 0000  ......rN...c....
+00002330: 0000 0000 0000 0000 0200 0000 0500 0000  ................
+00002340: 1300 0000 731c 0000 0067 007c 005d 0a7d  ....s....g.|.].}
+00002350: 0188 007c 0119 0088 017c 0119 0018 0091  ...|.....|......
+00002360: 0271 0253 0072 1500 0000 7215 0000 0072  .q.S.r....r....r
+00002370: 2a00 0000 2902 da05 6669 6e61 6cda 0573  *...)...final..s
+00002380: 7461 7274 7215 0000 0072 1600 0000 721d  tartr....r....r.
+00002390: 0000 00b2 0000 0072 5200 0000 da0e 706f  .......rR.....po
+000023a0: 6973 736f 6e5f 6661 6374 6f72 6301 0000  isson_factorc...
+000023b0: 0000 0000 0000 0000 0002 0000 0004 0000  ................
+000023c0: 0053 0000 00f3 1600 0000 6700 7c00 5d07  .S........g.|.].
+000023d0: 7d01 7400 7c01 8301 0c00 9102 7102 5300  }.t.|.......q.S.
+000023e0: 7215 0000 0072 0500 0000 724a 0000 0072  r....r....rJ...r
+000023f0: 1500 0000 7215 0000 0072 1600 0000 721d  ....r....r....r.
+00002400: 0000 00b5 0000 0072 4c00 0000 2902 7255  .......rL...).rU
+00002410: 0000 0072 2100 0000 da06 6d65 7468 6f64  ...r!.....method
+00002420: da05 3266 6c6f 777a 1052 6571 7565 7374  ..2flowz.Request
+00002430: 6564 206f 7264 6572 207a 0420 3e3d 207a  ed order z. >= z
+00002440: 4f20 286d 6178 696d 616c 2064 6567 7265  O (maximal degre
+00002450: 6520 6f66 2054 6179 6c6f 7220 6d61 7029  e of Taylor map)
+00002460: 2026 206e 6f6e 2d7a 6572 6f20 6f66 6673   & non-zero offs
+00002470: 6574 2064 6574 6563 7465 642e 204f 7264  et detected. Ord
+00002480: 6572 2072 6564 7563 6564 2062 7920 312e  er reduced by 1.
+00002490: 7a03 203e 207a 2020 286d 6178 696d 616c  z. > z  (maximal
+000024a0: 2064 6567 7265 6520 6f66 2054 6179 6c6f   degree of Taylo
+000024b0: 7220 6d61 7029 2e63 0100 0000 0000 0000  r map).c........
+000024c0: 0000 0000 0200 0000 0600 0000 5300 0000  ............S...
+000024d0: 731e 0000 0067 007c 005d 0b7d 0174 007c  s....g.|.].}.t.|
+000024e0: 01a0 0164 00a1 0183 01a0 02a1 0091 0271  ...d...........q
+000024f0: 0253 0029 0172 1e00 0000 2903 720e 0000  .S.).r....).r...
+00002500: 00da 1068 6f6d 6f67 656e 656f 7573 5f70  ...homogeneous_p
+00002510: 6172 74da 0674 6f6c 6973 7472 4a00 0000  art..tolistrJ...
+00002520: 7215 0000 0072 1500 0000 7216 0000 0072  r....r....r....r
+00002530: 1d00 0000 c600 0000 7302 0000 001e 004e  ........s......N
+00002540: 2901 da05 7368 6170 657a 1b53 796d 706c  )...shapez.Sympl
+00002550: 6563 7469 6369 7479 2063 6865 636b 2066  ecticity check f
+00002560: 6169 6c73 3a20 7a0e 2028 746f 6c5f 6368  ails: z. (tol_ch
+00002570: 6563 6b73 292e 2903 7255 0000 0072 4300  ecks).).rU...rC.
+00002580: 0000 7221 0000 007a 2d4d 6170 2072 6571  ..r!...z-Map req
+00002590: 7569 7265 7320 7477 6f20 326e 642d 6f72  uires two 2nd-or
+000025a0: 6465 7220 706f 6c79 6e6f 6d69 616c 7320  der polynomials 
+000025b0: 2874 6f6c 3a20 7a02 292e 4629 01da 0474  (tol: z.).F)...t
+000025c0: 6f6c 3263 0100 0000 0000 0000 0000 0000  ol2c............
+000025d0: 0100 0000 0600 0000 1300 0000 732a 0000  ............s*..
+000025e0: 0067 007c 005d 1189 0074 0087 0187 0087  .g.|.]...t......
+000025f0: 0366 0364 0064 0184 0874 0188 0283 0144  .f.d.d...t.....D
+00002600: 0083 0183 0191 0271 0253 0029 0263 0100  .......q.S.).c..
+00002610: 0000 0000 0000 0000 0000 0200 0000 0600  ................
+00002620: 0000 1300 0000 7322 0000 0067 007c 005d  ......s"...g.|.]
+00002630: 0d7d 0188 027c 0119 0088 006a 0088 017c  .}...|.....j...|
+00002640: 0166 0219 0014 0091 0271 0253 0072 1500  .f.......q.S.r..
+00002650: 0000 2901 da06 6d61 7472 6978 722a 0000  ..)...matrixr*..
+00002660: 0029 03da 0252 6972 3100 0000 721c 0000  .)...Rir1...r...
+00002670: 0072 1500 0000 7216 0000 0072 1d00 0000  .r....r....r....
+00002680: 1e01 0000 7302 0000 0022 007a 2864 7261  ....s....".z(dra
+00002690: 6774 6669 6e6e 2e3c 6c6f 6361 6c73 3e2e  gtfinn.<locals>.
+000026a0: 3c6c 6973 7463 6f6d 703e 2e3c 6c69 7374  <listcomp>.<list
+000026b0: 636f 6d70 3e72 3200 0000 7233 0000 0029  comp>r2...r3...)
+000026c0: 0372 5e00 0000 7235 0000 0072 1c00 0000  .r^...r5...r....
+000026d0: 7236 0000 0072 1600 0000 721d 0000 001e  r6...r....r.....
+000026e0: 0100 0072 3700 0000 6301 0000 0000 0000  ...r7...c.......
+000026f0: 0000 0000 0002 0000 0005 0000 0013 0000  ................
+00002700: 00f3 1600 0000 6700 7c00 5d07 7d01 7c01  ......g.|.].}.|.
+00002710: a000 8800 a101 9102 7102 5300 7215 0000  ........q.S.r...
+00002720: 00a9 01da 0561 626f 7665 724a 0000 00a9  .....aboverJ....
+00002730: 0172 4300 0000 7215 0000 0072 1600 0000  .rC...r....r....
+00002740: 721d 0000 0021 0100 0072 4c00 0000 2901  r....!...rL...).
+00002750: da07 6469 7361 626c 6563 0100 0000 0000  ..disablec......
+00002760: 0000 0000 0000 0200 0000 0500 0000 1300  ................
+00002770: 0000 725f 0000 0072 1500 0000 2901 7259  ..r_...r....).rY
+00002780: 0000 0072 4a00 0000 2901 721a 0000 0072  ...rJ...).r....r
+00002790: 1500 0000 7216 0000 0072 1d00 0000 2e01  ....r....r......
+000027a0: 0000 724c 0000 0063 0100 0000 0000 0000  ..rL...c........
+000027b0: 0000 0000 0200 0000 0400 0000 5300 0000  ............S...
+000027c0: 7318 0000 0067 007c 005d 087d 017c 0164  s....g.|.].}.|.d
+000027d0: 006b 0272 027c 0191 0271 0253 0072 5000  .k.r.|...q.S.rP.
+000027e0: 0000 7215 0000 0029 0272 1b00 0000 da02  ..r....).r......
+000027f0: 656b 7215 0000 0072 1500 0000 7216 0000  ekr....r....r...
+00002800: 0072 1d00 0000 3001 0000 7302 0000 0018  .r....0...s.....
+00002810: 007a 2e50 6f69 6e63 6172 6520 4c65 6d6d  .z.Poincare Lemm
+00002820: 6120 7072 6572 6571 7569 7369 7473 206e  a prerequisits n
+00002830: 6f74 206d 6574 2066 6f72 206f 7264 6572  ot met for order
+00002840: 207a 0720 2874 6f6c 3a20 7a0e 2c20 666c   z. (tol: z., fl
+00002850: 6f77 2069 6e70 7574 3a20 7a03 293a 0a63  ow input: z.):.c
+00002860: 0100 0000 0000 0000 0000 0000 0100 0000  ................
+00002870: 0200 0000 5300 0000 730c 0000 0074 007c  ....S...s....t.|
+00002880: 0083 0164 016b 0553 0029 024e 721e 0000  ...d.k.S.).Nr...
+00002890: 0029 0172 2300 0000 2901 da03 6b65 7972  .).r#...)...keyr
+000028a0: 1500 0000 7215 0000 0072 1600 0000 da08  ....r....r......
+000028b0: 3c6c 616d 6264 613e 4401 0000 7302 0000  <lambda>D...s...
+000028c0: 000c 007a 1b64 7261 6774 6669 6e6e 2e3c  ...z.dragtfinn.<
+000028d0: 6c6f 6361 6c73 3e2e 3c6c 616d 6264 613e  locals>.<lambda>
+000028e0: 2901 da08 6b65 795f 636f 6e64 7a16 4c69  )...key_condz.Li
+000028f0: 6520 6f70 6572 6174 6f72 206f 6620 6f72  e operator of or
+00002900: 6465 7220 7a38 2064 6f65 7320 6e6f 7420  der z8 does not 
+00002910: 7072 6f70 6572 6c79 2063 616e 6365 6c20  properly cancel 
+00002920: 7468 6520 5461 796c 6f72 2d6d 6170 2074  the Taylor-map t
+00002930: 6572 6d73 206f 6620 6f72 6465 7220 723e  erms of order r>
+00002940: 0000 0054 2902 da05 6f75 746c 3172 5700  ...T)...outl1rW.
+00002950: 0000 6301 0000 0000 0000 0000 0000 0002  ..c.............
+00002960: 0000 0005 0000 0013 0000 0073 2400 0000  ...........s$...
+00002970: 6700 7c00 5d0e 7d01 7c01 a000 8800 a101  g.|.].}.|.......
+00002980: 6400 6b03 7202 7c01 a000 8800 a101 9102  d.k.r.|.........
+00002990: 7102 5300 7250 0000 0072 6000 0000 2902  q.S.rP...r`...).
+000029a0: 721b 0000 00da 0166 7262 0000 0072 1500  r......frb...r..
+000029b0: 0000 7216 0000 0072 1d00 0000 6001 0000  ..r....r....`...
+000029c0: 7302 0000 0024 0063 0100 0000 0000 0000  s....$.c........
+000029d0: 0000 0000 0200 0000 0400 0000 5300 0000  ............S...
+000029e0: 7256 0000 0072 1500 0000 7205 0000 0072  rV...r....r....r
+000029f0: 4a00 0000 7215 0000 0072 1500 0000 7216  J...r....r....r.
+00002a00: 0000 0072 1d00 0000 6501 0000 724c 0000  ...r....e...rL..
+00002a10: 0029 2472 2000 0000 da03 616c 6c72 3900  .)$r .....allr9.
+00002a20: 0000 7238 0000 00da 036d 6178 da08 7761  ..r8.....max..wa
+00002a30: 726e 696e 6773 7247 0000 00da 026e 70da  rningsrG.....np.
+00002a40: 0369 6e66 722d 0000 0072 0d00 0000 da03  .infr-...r......
+00002a50: 616e 7972 0c00 0000 da05 6172 7261 7972  anyr......arrayr
+00002a60: 0800 0000 7207 0000 0072 3a00 0000 725b  ....r....r:...r[
+00002a70: 0000 00da 0473 7172 74da 066c 696e 616c  .....sqrt..linal
+00002a80: 67da 046e 6f72 6d72 5d00 0000 da04 7072  g..normr].....pr
+00002a90: 6f64 7217 0000 0072 0f00 0000 7261 0000  odr....r....ra..
+00002aa0: 0072 0900 0000 7219 0000 0072 0b00 0000  .r....r....r....
+00002ab0: da06 6170 7065 6e64 7204 0000 0072 3c00  ..appendr....r<.
+00002ac0: 0000 da07 6578 7472 6163 74da 066d 696e  ....extract..min
+00002ad0: 6465 67da 0874 7275 6e63 6174 65da 0669  deg..truncate..i
+00002ae0: 6e73 6572 7429 2a72 3f00 0000 7240 0000  nsert)*r?...r@..
+00002af0: 0072 4100 0000 7242 0000 0072 4300 0000  .rA...rB...rC...
+00002b00: 7244 0000 0072 4500 0000 7246 0000 0072  rD...rE...rF...r
+00002b10: 4700 0000 721c 0000 0072 1400 0000 7221  G...r....r....r!
+00002b20: 0000 00da 076d 6178 5f64 6567 da04 6469  .....max_deg..di
+00002b30: 6666 da10 7374 6172 745f 6973 5f6e 6f6e  ff..start_is_non
+00002b40: 7a65 726f da02 6831 da01 52da 014a da03  zero..h1..R..J..
+00002b50: 5274 72da 0552 7472 4a52 da02 4a4a da05  Rtr..RtrJR..JJ..
+00002b60: 6368 6563 6bda 0141 da02 5341 da02 5342  check..A..SA..SB
+00002b70: da01 42da 0465 7870 41da 0465 7870 42da  ..B..expA..expB.
+00002b80: 0865 7870 4165 7870 42da 0578 6965 7461  .expAexpB..xieta
+00002b90: da05 705f 6e65 77da 0566 5f61 6c6c da04  ..p_new..f_all..
+00002ba0: 665f 6e6c da02 676b da01 69da 016a da04  f_nl..gk..i..j..
+00002bb0: 7a65 726f da02 666b da02 6c6b da09 7265  zero..fk..lk..re
+00002bc0: 6d61 696e 6465 72da 0566 5f68 646d da02  mainder..f_hdm..
+00002bd0: 6731 7215 0000 0029 0a72 5e00 0000 7220  g1r....).r^...r 
+00002be0: 0000 0072 3500 0000 7253 0000 0072 1a00  ...r5...rS...r..
+00002bf0: 0000 7240 0000 0072 1c00 0000 723b 0000  ..r@...r....r;..
+00002c00: 0072 5400 0000 7243 0000 0072 1600 0000  .rT...rC...r....
+00002c10: da09 6472 6167 7466 696e 6e55 0000 0073  ..dragtfinnU...s
+00002c20: de00 0000 0a43 0801 1a01 0a01 1a01 2401  .....C........$.
+00002c30: 1801 1201 0801 0401 1801 0401 2a01 1001  ............*...
+00002c40: 0a01 0c03 0a01 1401 2602 0401 1201 0802  ........&.......
+00002c50: 1801 1001 1202 0601 1002 1201 1004 0601  ................
+00002c60: 1801 0801 1002 1801 1403 0801 0c01 0801  ................
+00002c70: 0e01 0a02 0c02 1601 3001 2001 0603 0201  ........0. .....
+00002c80: 0a01 1601 0801 0c01 0601 0601 1201 0601  ................
+00002c90: 0602 1201 1601 1601 0a1e 1204 1201 0801  ................
+00002ca0: 3201 0e01 0e01 1a15 0a01 1202 0405 0a01  2...............
+00002cb0: 0a01 0a01 0a01 0402 1a01 1201 2a02 0402  ............*...
+00002cc0: 0a02 0c01 0c01 2001 3401 04fe 0e04 0a01  ...... .4.......
+00002cd0: 0402 0a01 0e01 0a02 0c02 2201 0a01 3c01  .........."...<.
+00002ce0: 0480 0e02 0a06 0a05 040a 0e01 2801 1601  ............(...
+00002cf0: 0602 0e01 1402 1001 1401 1002 0404 0afe  ................
+00002d00: 0402 7298 0000 0029 1eda 056e 756d 7079  ..r....)...numpy
+00002d10: 726d 0000 00da 0c73 6369 7079 2e6c 696e  rm.....scipy.lin
+00002d20: 616c 6772 0200 0000 7203 0000 0072 0400  algr....r....r..
+00002d30: 0000 726c 0000 00da 0b6e 6a65 742e 636f  ..rl.....njet.co
+00002d40: 6d6d 6f6e 7206 0000 00da 146c 6965 6f70  mmonr......lieop
+00002d50: 732e 6c69 6e61 6c67 2e6d 6174 7269 7872  s.linalg.matrixr
+00002d60: 0700 0000 7208 0000 00da 106c 6965 6f70  ....r......lieop
+00002d70: 732e 6c69 6e61 6c67 2e6e 6672 0900 0000  s.linalg.nfr....
+00002d80: da14 6c69 656f 7073 2e6c 696e 616c 672e  ..lieops.linalg.
+00002d90: 636f 6d6d 6f6e 720a 0000 00da 0f6c 6965  commonr......lie
+00002da0: 6f70 732e 636f 7265 2e6c 6965 720b 0000  ops.core.lier...
+00002db0: 0072 0c00 0000 da11 6c69 656f 7073 2e63  .r......lieops.c
+00002dc0: 6f72 652e 746f 6f6c 7372 0d00 0000 720e  ore.toolsr....r.
+00002dd0: 0000 0072 0f00 0000 7217 0000 0072 1900  ...r....r....r..
+00002de0: 0000 da03 696e 7472 2900 0000 722e 0000  ....intr)...r...
+00002df0: 0072 3c00 0000 7298 0000 0072 1500 0000  .r<...r....r....
+00002e00: 7215 0000 0072 1500 0000 7216 0000 00da  r....r....r.....
+00002e10: 083c 6d6f 6475 6c65 3e01 0000 0073 2400  .<module>....s$.
+00002e20: 0000 0800 1001 0c01 0801 0c02 1002 0c01  ................
+00002e30: 0c01 1002 1401 0202 0a01 0203 0a01 0e03  ................
+00002e40: 080d 0808 2229                           ....")
```

### Comparing `lieops-0.2.1/lieops/core/__pycache__/hadamard.cpython-310.pyc` & `lieops-0.2.2/lieops/core/__pycache__/hadamard.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/__pycache__/lie.cpython-310.pyc` & `lieops-0.2.2/lieops/core/__pycache__/lie.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.10, timestamp-based, .py timestamp: Fri Feb 24 10:12:32 2023 UTC, .py size: 29638 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 9% similar despite different names*

```diff
@@ -1,1581 +1,1614 @@
-00000000: 6f0d 0d0a 0000 0000 908d f863 c673 0000  o..........c.s..
+00000000: 6f0d 0d0a 0000 0000 aa52 3e64 0b76 0000  o........R>d.v..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0004 0000 0040 0000 0073 cc00 0000 6400  .....@...s....d.
+00000020: 0004 0000 0040 0000 0073 c000 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a01 6400 6401 6c02 5a02 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6401 6c03 5a03 6400 6402 6c04 6d05 5a05  d.l.Z.d.d.l.m.Z.
 00000050: 0100 6403 6404 6c06 6d07 5a07 0100 6403  ..d.d.l.m.Z...d.
 00000060: 6405 6c08 6d09 5a09 0100 6403 6406 6c0a  d.l.m.Z...d.d.l.
 00000070: 6d0b 5a0b 0100 6400 6407 6c0c 6d0d 5a0d  m.Z...d.d.l.m.Z.
-00000080: 0100 6400 6408 6c0e 6d0f 5a0f 6d10 5a10  ..d.d.l.m.Z.m.Z.
-00000090: 6d11 5a11 0100 6400 6409 6c12 6d13 5a13  m.Z...d.d.l.m.Z.
-000000a0: 0100 6400 640a 6c14 6d15 5a16 0100 6400  ..d.d.l.m.Z...d.
-000000b0: 6401 6c0c 5a17 6400 6401 6c18 5a17 4700  d.l.Z.d.d.l.Z.G.
-000000c0: 640b 640c 8400 640c 650b 8303 5a0a 6414  d.d...d.e...Z.d.
-000000d0: 640e 640f 8401 5a19 4700 6410 6411 8400  d.d...Z.G.d.d...
-000000e0: 6411 8302 5a1a 4700 6412 6413 8400 6413  d...Z.G.d.d...d.
-000000f0: 651a 8303 5a1b 6401 5300 2915 e900 0000  e...Z.d.S.).....
-00000100: 004e 2901 da18 6669 7273 745f 6f72 6465  .N)...first_orde
-00000110: 725f 6e66 5f65 7870 616e 7369 6f6e e901  r_nf_expansion..
-00000120: 0000 0029 01da 0667 656e 6578 7029 01da  ...)...genexp)..
-00000130: 066d 6167 6e75 7329 01da 055f 706f 6c79  .magnus)..._poly
-00000140: 2901 da08 7379 6d63 6865 636b 2903 da09  )...symcheck)...
-00000150: 6765 745f 3266 6c6f 77da 0863 6861 6e6e  get_2flow..chann
-00000160: 656c 6cda 0668 6579 6f6b 6129 01da 1872  ell..heyoka)...r
-00000170: 6563 7572 7369 7665 5f6d 6f6e 6f6d 6961  ecursive_monomia
-00000180: 6c5f 7370 6c69 7429 01da 0863 616c 6346  l_split)...calcF
-00000190: 6c6f 7763 0000 0000 0000 0000 0000 0000  lowc............
-000001a0: 0000 0000 0400 0000 4000 0000 7334 0000  ........@...s4..
-000001b0: 0065 005a 0164 005a 0264 0164 0284 005a  .e.Z.d.Z.d.d...Z
-000001c0: 0364 0d64 0565 0466 0264 0664 0784 055a  .d.d.e.f.d.d...Z
-000001d0: 0564 0864 0984 005a 0664 0a64 0b84 005a  .d.d...Z.d.d...Z
-000001e0: 0764 0c53 0029 0eda 0470 6f6c 7963 0100  .d.S.)...polyc..
-000001f0: 0000 0000 0000 0000 0000 0300 0000 0400  ................
-00000200: 0000 4f00 0000 7328 0000 007c 02a0 0064  ..O...s(...|...d
-00000210: 017c 006a 01a1 027c 0264 013c 0074 027c  .|.j...|.d.<.t.|
-00000220: 0067 017c 01a2 0152 0069 007c 02a4 018e  .g.|...R.i.|....
-00000230: 0153 0029 0261 2e03 0000 0a20 2020 2020  .S.).a.....     
-00000240: 2020 204c 6574 2066 3a20 525e 6e20 2d3e     Let f: R^n ->
-00000250: 2052 2062 6520 6120 6469 6666 6572 656e   R be a differen
-00000260: 7469 6162 6c65 2066 756e 6374 696f 6e20  tiable function 
-00000270: 616e 6420 3a78 3a20 7468 6520 6375 7272  and :x: the curr
-00000280: 656e 7420 706f 6c79 6e6f 6d69 616c 204c  ent polynomial L
-00000290: 6965 206d 6170 2e20 0a20 2020 2020 2020  ie map. .       
-000002a0: 2054 6865 6e20 7468 6973 2072 6f75 7469   Then this routi
-000002b0: 6e65 2077 696c 6c20 636f 6d70 7574 6520  ne will compute 
-000002c0: 7468 6520 636f 6d70 6f6e 656e 7473 206f  the components o
-000002d0: 6620 4d3a 2052 5e6e 202d 3e20 525e 6e2c  f M: R^n -> R^n,
-000002e0: 0a20 2020 2020 2020 2077 6865 7265 204d  .        where M
-000002f0: 2069 7320 7468 6520 6d61 7020 7361 7469   is the map sati
-00000300: 7366 7969 6e67 0a20 2020 2020 2020 2065  sfying.        e
-00000310: 7870 283a 783a 2920 6620 3d20 6620 6f20  xp(:x:) f = f o 
-00000320: 4d0a 0a20 2020 2020 2020 204e 6f74 6520  M..        Note 
-00000330: 7468 6174 2074 6865 2064 6567 7265 6520  that the degree 
-00000340: 746f 2077 6869 6368 2070 6f77 6572 7320  to which powers 
-00000350: 6172 6520 6469 7363 6172 6465 6420 6973  are discarded is
-00000360: 2067 6976 656e 2062 7920 7365 6c66 2e6d   given by self.m
-00000370: 6178 5f70 6f77 6572 2e0a 0a20 2020 2020  ax_power...     
-00000380: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00000390: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-000003a0: 0a20 2020 2020 2020 2074 3a20 666c 6f61  .        t: floa
-000003b0: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-000003c0: 2020 2020 2020 2020 5468 6520 666c 6f77          The flow
-000003d0: 2070 6172 616d 6574 6572 2074 2073 6f20   parameter t so 
-000003e0: 7468 6174 2077 6520 6861 7665 2074 6865  that we have the
-000003f0: 2066 6f6c 6c6f 7769 6e67 2069 6e74 6572   following inter
-00000400: 7072 6574 6174 696f 6e3a 0a20 2020 2020  pretation:.     
-00000410: 2020 2020 2020 2073 656c 662e 666c 6f77         self.flow
-00000420: 2874 2920 3d20 6c65 7870 2874 2a3a 7365  (t) = lexp(t*:se
-00000430: 6c66 3a29 0a20 2020 2020 2020 200a 2020  lf:).        .  
-00000440: 2020 2020 2020 2a61 7267 730a 2020 2020        *args.    
-00000450: 2020 2020 2020 2020 4172 6775 6d65 6e74          Argument
-00000460: 7320 7061 7373 6564 2074 6f20 6c69 656f  s passed to lieo
-00000470: 7065 7261 746f 7220 636c 6173 732e 0a0a  perator class...
-00000480: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
-00000490: 0a20 2020 2020 2020 2020 2020 2041 6464  .            Add
-000004a0: 6974 696f 6e61 6c20 6172 6775 6d65 6e74  itional argument
-000004b0: 7320 6172 6520 7061 7373 6564 2074 6f20  s are passed to 
-000004c0: 6c69 656f 7065 7261 746f 7220 636c 6173  lieoperator clas
-000004d0: 732e 0a0a 2020 2020 2020 2020 5265 7475  s...        Retu
-000004e0: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-000004f0: 2d2d 2d0a 2020 2020 2020 2020 6c69 656f  ---.        lieo
-00000500: 7065 7261 746f 720a 2020 2020 2020 2020  perator.        
-00000510: 2020 2020 436c 6173 7320 6f66 2074 7970      Class of typ
-00000520: 6520 6c69 656f 7065 7261 746f 722c 206d  e lieoperator, m
-00000530: 6f64 656c 696e 6720 7468 6520 666c 6f77  odeling the flow
-00000540: 206f 6620 7468 6520 6375 7272 656e 7420   of the current 
-00000550: 4c69 6520 706f 6c79 6e6f 6d69 616c 2e0a  Lie polynomial..
-00000560: 2020 2020 2020 2020 da09 6d61 785f 706f          ..max_po
-00000570: 7765 7229 03da 0367 6574 720e 0000 00da  wer)...getr.....
-00000580: 046c 6578 7029 03da 0473 656c 66da 0461  .lexp)...self..a
-00000590: 7267 73da 066b 7761 7267 73a9 0072 1400  rgs..kwargs..r..
-000005a0: 0000 fa50 2f68 6f6d 652f 6d61 6c74 652f  ...P/home/malte/
-000005b0: 6d69 6e69 636f 6e64 6133 2f65 6e76 732f  miniconda3/envs/
-000005c0: 776f 726b 2f6c 6962 2f70 7974 686f 6e33  work/lib/python3
-000005d0: 2e31 302f 7369 7465 2d70 6163 6b61 6765  .10/site-package
-000005e0: 732f 6c69 656f 7073 2f63 6f72 652f 6c69  s/lieops/core/li
-000005f0: 652e 7079 7210 0000 0016 0000 0073 0400  e.pyr........s..
-00000600: 0000 121a 1601 7a09 706f 6c79 2e6c 6578  ......z.poly.lex
-00000610: 7072 0300 0000 e90a 0000 00da 056f 7264  pr...........ord
-00000620: 6572 6303 0000 0000 0000 0000 0000 0004  erc.............
-00000630: 0000 0006 0000 004b 0000 0073 3600 0000  .......K...s6...
-00000640: 7c03 a000 6401 7c00 6a01 a102 7c03 6401  |...d.|.j...|.d.
-00000650: 3c00 7402 6a03 6a04 6a05 7c00 6601 7c01  <.t.j.j.j.|.f.|.
-00000660: 7c02 7c00 6a06 6402 1400 6403 9c03 7c03  |.|.j.d...d...|.
-00000670: a401 8e01 5300 2904 616c 0200 000a 2020  ....S.).al....  
-00000680: 2020 2020 2020 436f 6d70 7574 6520 7468        Compute th
-00000690: 6520 4269 726b 686f 6666 206e 6f72 6d61  e Birkhoff norma
-000006a0: 6c20 666f 726d 206f 6620 7468 6520 6375  l form of the cu
-000006b0: 7272 656e 7420 4c69 6520 6578 706f 6e65  rrent Lie expone
-000006c0: 6e74 6961 6c20 6f70 6572 6174 6f72 2e0a  ntial operator..
-000006d0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-000006e0: 2045 7861 6d70 6c65 0a20 2020 2020 2020   Example.       
-000006f0: 202d 2d2d 2d2d 2d2d 200a 2020 2020 2020   ------- .      
-00000700: 2020 6e66 203d 2073 656c 662e 626e 6628    nf = self.bnf(
-00000710: 290a 2020 2020 2020 2020 6563 6869 3120  ).        echi1 
-00000720: 3d20 6e66 5b27 6368 6927 5d5b 305d 2e66  = nf['chi'][0].f
-00000730: 6c6f 7728 743d 3129 2023 2065 7870 283a  low(t=1) # exp(:
-00000740: 6368 6931 3a29 0a20 2020 2020 2020 2065  chi1:).        e
-00000750: 6368 6931 6920 3d20 6e66 5b27 6368 6927  chi1i = nf['chi'
-00000760: 5d5b 305d 2e66 6c6f 7728 743d 2d31 2920  ][0].flow(t=-1) 
-00000770: 2320 6578 7028 2d3a 6368 6931 3a29 0a20  # exp(-:chi1:). 
-00000780: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00000790: 5468 656e 2074 6865 206d 6170 200a 2020  Then the map .  
-000007a0: 2020 2020 2020 2020 7a20 2d3e 2065 7870          z -> exp
-000007b0: 283a 6368 6931 3a29 2873 656c 6628 6578  (:chi1:)(self(ex
-000007c0: 7028 2d3a 6368 6931 3a29 287a 2929 2920  p(-:chi1:)(z))) 
-000007d0: 0a20 2020 2020 2020 2077 696c 6c20 6265  .        will be
-000007e0: 2069 6e20 4e46 2e0a 2020 2020 2020 2020   in NF..        
-000007f0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00000800: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00000810: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206f  ------.        o
-00000820: 7264 6572 3a20 696e 742c 206f 7074 696f  rder: int, optio
-00000830: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00000840: 4f72 6465 7220 7570 2074 6f20 7768 6963  Order up to whic
-00000850: 6820 7468 6520 6e6f 726d 616c 2066 6f72  h the normal for
-00000860: 6d20 7368 6f75 6c64 2062 6520 636f 6d70  m should be comp
-00000870: 7574 6564 2e0a 2020 2020 2020 2020 2020  uted..          
-00000880: 2020 0a20 2020 2020 2020 202a 2a6b 7761    .        **kwa
-00000890: 7267 730a 2020 2020 2020 2020 2020 2020  rgs.            
-000008a0: 4f70 7469 6f6e 616c 2061 7267 756d 656e  Optional argumen
-000008b0: 7473 2070 6173 7365 6420 746f 2027 6c69  ts passed to 'li
-000008c0: 656f 7073 2e63 6f72 652e 6269 726b 686f  eops.core.birkho
-000008d0: 6666 2e62 6e66 2720 726f 7574 696e 652e  ff.bnf' routine.
-000008e0: 0a20 2020 2020 2020 2072 0e00 0000 e902  .        r......
-000008f0: 0000 0029 0372 1700 0000 da05 706f 7765  ...).r......powe
-00000900: 72da 066e 5f61 7267 7329 0772 0f00 0000  r..n_args).r....
-00000910: 720e 0000 00da 066c 6965 6f70 73da 0463  r......lieops..c
-00000920: 6f72 65da 0862 6972 6b68 6f66 66da 0362  ore..birkhoff..b
-00000930: 6e66 da03 6469 6d29 0472 1100 0000 7217  nf..dim).r....r.
-00000940: 0000 0072 1900 0000 7213 0000 0072 1400  ...r....r....r..
-00000950: 0000 7214 0000 0072 1500 0000 721e 0000  ..r....r....r...
-00000960: 0033 0000 0073 0400 0000 1216 2401 7a08  .3...s......$.z.
-00000970: 706f 6c79 2e62 6e66 6301 0000 0000 0000  poly.bnfc.......
-00000980: 0000 0000 0004 0000 0004 0000 004f 0000  .............O..
-00000990: 0073 2400 0000 7c00 6a00 7c01 6900 7c02  .s$...|.j.|.i.|.
-000009a0: a401 8e01 7d03 7c03 6a01 6402 6900 7c02  ....}.|.j.d.i.|.
-000009b0: a401 8e01 0100 7c03 5300 2903 6136 0200  ......|.S.).a6..
-000009c0: 000a 2020 2020 2020 2020 436f 6d70 7574  ..        Comput
-000009d0: 6520 7468 6520 666c 6f77 206f 6620 7468  e the flow of th
-000009e0: 6520 6375 7272 656e 7420 4c69 6520 706f  e current Lie po
-000009f0: 6c79 6e6f 6d69 616c 2e20 5368 6f72 7463  lynomial. Shortc
-00000a00: 7574 2066 6f72 2073 656c 662e 6c65 7870  ut for self.lexp
-00000a10: 2061 6e64 2074 6865 6e20 6361 6c63 466c   and then calcFl
-00000a20: 6f77 206f 6e0a 2020 2020 2020 2020 7468  ow on.        th
-00000a30: 6520 7265 7370 6563 7469 7665 206f 626a  e respective obj
-00000a40: 6563 742e 0a20 2020 2020 2020 200a 2020  ect..        .  
-00000a50: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00000a60: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00000a70: 2d2d 2d0a 2020 2020 2020 2020 2a61 7267  ---.        *arg
+00000080: 6d0e 5a0e 6d0f 5a0f 0100 6400 6408 6c10  m.Z.m.Z...d.d.l.
+00000090: 6d11 5a11 0100 6400 6409 6c12 6d13 5a14  m.Z...d.d.l.m.Z.
+000000a0: 0100 6400 6401 6c15 5a16 6400 6401 6c17  ..d.d.l.Z.d.d.l.
+000000b0: 5a16 4700 640a 640b 8400 640b 650b 8303  Z.G.d.d...d.e...
+000000c0: 5a0a 6413 640d 640e 8401 5a18 4700 640f  Z.d.d.d...Z.G.d.
+000000d0: 6410 8400 6410 8302 5a19 4700 6411 6412  d...d...Z.G.d.d.
+000000e0: 8400 6412 6519 8303 5a1a 6401 5300 2914  ..d.e...Z.d.S.).
+000000f0: e900 0000 004e 2901 da18 6669 7273 745f  .....N)...first_
+00000100: 6f72 6465 725f 6e66 5f65 7870 616e 7369  order_nf_expansi
+00000110: 6f6e e901 0000 0029 01da 0667 656e 6578  on.....)...genex
+00000120: 7029 01da 066d 6167 6e75 7329 01da 055f  p)...magnus)..._
+00000130: 706f 6c79 2903 da09 6765 745f 3266 6c6f  poly)...get_2flo
+00000140: 77da 0863 6861 6e6e 656c 6cda 0668 6579  w..channell..hey
+00000150: 6f6b 6129 01da 1872 6563 7572 7369 7665  oka)...recursive
+00000160: 5f6d 6f6e 6f6d 6961 6c5f 7370 6c69 7429  _monomial_split)
+00000170: 01da 0863 616c 6346 6c6f 7763 0000 0000  ...calcFlowc....
+00000180: 0000 0000 0000 0000 0000 0000 0400 0000  ................
+00000190: 4000 0000 7334 0000 0065 005a 0164 005a  @...s4...e.Z.d.Z
+000001a0: 0264 0164 0284 005a 0364 0c64 0465 0466  .d.d...Z.d.d.e.f
+000001b0: 0264 0564 0684 055a 0564 0764 0884 005a  .d.d...Z.d.d...Z
+000001c0: 0664 0964 0a84 005a 0764 0b53 0029 0dda  .d.d...Z.d.S.)..
+000001d0: 0470 6f6c 7963 0100 0000 0000 0000 0000  .polyc..........
+000001e0: 0000 0300 0000 0400 0000 4f00 0000 7328  ..........O...s(
+000001f0: 0000 007c 02a0 0064 017c 006a 01a1 027c  ...|...d.|.j...|
+00000200: 0264 013c 0074 027c 0067 017c 01a2 0152  .d.<.t.|.g.|...R
+00000210: 0069 007c 02a4 018e 0153 0029 0261 2e03  .i.|.....S.).a..
+00000220: 0000 0a20 2020 2020 2020 204c 6574 2066  ...        Let f
+00000230: 3a20 525e 6e20 2d3e 2052 2062 6520 6120  : R^n -> R be a 
+00000240: 6469 6666 6572 656e 7469 6162 6c65 2066  differentiable f
+00000250: 756e 6374 696f 6e20 616e 6420 3a78 3a20  unction and :x: 
+00000260: 7468 6520 6375 7272 656e 7420 706f 6c79  the current poly
+00000270: 6e6f 6d69 616c 204c 6965 206d 6170 2e20  nomial Lie map. 
+00000280: 0a20 2020 2020 2020 2054 6865 6e20 7468  .        Then th
+00000290: 6973 2072 6f75 7469 6e65 2077 696c 6c20  is routine will 
+000002a0: 636f 6d70 7574 6520 7468 6520 636f 6d70  compute the comp
+000002b0: 6f6e 656e 7473 206f 6620 4d3a 2052 5e6e  onents of M: R^n
+000002c0: 202d 3e20 525e 6e2c 0a20 2020 2020 2020   -> R^n,.       
+000002d0: 2077 6865 7265 204d 2069 7320 7468 6520   where M is the 
+000002e0: 6d61 7020 7361 7469 7366 7969 6e67 0a20  map satisfying. 
+000002f0: 2020 2020 2020 2065 7870 283a 783a 2920         exp(:x:) 
+00000300: 6620 3d20 6620 6f20 4d0a 0a20 2020 2020  f = f o M..     
+00000310: 2020 204e 6f74 6520 7468 6174 2074 6865     Note that the
+00000320: 2064 6567 7265 6520 746f 2077 6869 6368   degree to which
+00000330: 2070 6f77 6572 7320 6172 6520 6469 7363   powers are disc
+00000340: 6172 6465 6420 6973 2067 6976 656e 2062  arded is given b
+00000350: 7920 7365 6c66 2e6d 6178 5f70 6f77 6572  y self.max_power
+00000360: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00000370: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00000380: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00000390: 2074 3a20 666c 6f61 742c 206f 7074 696f   t: float, optio
+000003a0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+000003b0: 5468 6520 666c 6f77 2070 6172 616d 6574  The flow paramet
+000003c0: 6572 2074 2073 6f20 7468 6174 2077 6520  er t so that we 
+000003d0: 6861 7665 2074 6865 2066 6f6c 6c6f 7769  have the followi
+000003e0: 6e67 2069 6e74 6572 7072 6574 6174 696f  ng interpretatio
+000003f0: 6e3a 0a20 2020 2020 2020 2020 2020 2073  n:.            s
+00000400: 656c 662e 666c 6f77 2874 2920 3d20 6c65  elf.flow(t) = le
+00000410: 7870 2874 2a3a 7365 6c66 3a29 0a20 2020  xp(t*:self:).   
+00000420: 2020 2020 200a 2020 2020 2020 2020 2a61       .        *a
+00000430: 7267 730a 2020 2020 2020 2020 2020 2020  rgs.            
+00000440: 4172 6775 6d65 6e74 7320 7061 7373 6564  Arguments passed
+00000450: 2074 6f20 6c69 656f 7065 7261 746f 7220   to lieoperator 
+00000460: 636c 6173 732e 0a0a 2020 2020 2020 2020  class...        
+00000470: 2a2a 6b77 6172 6773 0a20 2020 2020 2020  **kwargs.       
+00000480: 2020 2020 2041 6464 6974 696f 6e61 6c20       Additional 
+00000490: 6172 6775 6d65 6e74 7320 6172 6520 7061  arguments are pa
+000004a0: 7373 6564 2074 6f20 6c69 656f 7065 7261  ssed to lieopera
+000004b0: 746f 7220 636c 6173 732e 0a0a 2020 2020  tor class...    
+000004c0: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+000004d0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+000004e0: 2020 2020 6c69 656f 7065 7261 746f 720a      lieoperator.
+000004f0: 2020 2020 2020 2020 2020 2020 436c 6173              Clas
+00000500: 7320 6f66 2074 7970 6520 6c69 656f 7065  s of type lieope
+00000510: 7261 746f 722c 206d 6f64 656c 696e 6720  rator, modeling 
+00000520: 7468 6520 666c 6f77 206f 6620 7468 6520  the flow of the 
+00000530: 6375 7272 656e 7420 4c69 6520 706f 6c79  current Lie poly
+00000540: 6e6f 6d69 616c 2e0a 2020 2020 2020 2020  nomial..        
+00000550: da09 6d61 785f 706f 7765 7229 03da 0367  ..max_power)...g
+00000560: 6574 720d 0000 00da 046c 6578 7029 03da  etr......lexp)..
+00000570: 0473 656c 66da 0461 7267 73da 066b 7761  .self..args..kwa
+00000580: 7267 73a9 0072 1300 0000 fa29 2f68 6f6d  rgs..r.....)/hom
+00000590: 652f 6d61 6c74 652f 6769 742f 6c69 656f  e/malte/git/lieo
+000005a0: 7073 2f6c 6965 6f70 732f 636f 7265 2f6c  ps/lieops/core/l
+000005b0: 6965 2e70 7972 0f00 0000 1400 0000 7304  ie.pyr........s.
+000005c0: 0000 0012 1a16 017a 0970 6f6c 792e 6c65  .......z.poly.le
+000005d0: 7870 7203 0000 00da 056f 7264 6572 6302  xpr......orderc.
+000005e0: 0000 0000 0000 0000 0000 0003 0000 0005  ................
+000005f0: 0000 004b 0000 0073 3400 0000 7c02 a000  ...K...s4...|...
+00000600: 6401 7c00 6a01 a102 7c02 6401 3c00 7402  d.|.j...|.d.<.t.
+00000610: 6a03 6a04 6a05 7c00 6601 7c01 7c00 6a06  j.j.j.|.f.|.|.j.
+00000620: 6402 1400 6403 9c02 7c02 a401 8e01 5300  d...d...|.....S.
+00000630: 2904 616c 0200 000a 2020 2020 2020 2020  ).al....        
+00000640: 436f 6d70 7574 6520 7468 6520 4269 726b  Compute the Birk
+00000650: 686f 6666 206e 6f72 6d61 6c20 666f 726d  hoff normal form
+00000660: 206f 6620 7468 6520 6375 7272 656e 7420   of the current 
+00000670: 4c69 6520 6578 706f 6e65 6e74 6961 6c20  Lie exponential 
+00000680: 6f70 6572 6174 6f72 2e0a 2020 2020 2020  operator..      
+00000690: 2020 0a20 2020 2020 2020 2045 7861 6d70    .        Examp
+000006a0: 6c65 0a20 2020 2020 2020 202d 2d2d 2d2d  le.        -----
+000006b0: 2d2d 200a 2020 2020 2020 2020 6e66 203d  -- .        nf =
+000006c0: 2073 656c 662e 626e 6628 290a 2020 2020   self.bnf().    
+000006d0: 2020 2020 6563 6869 3120 3d20 6e66 5b27      echi1 = nf['
+000006e0: 6368 6927 5d5b 305d 2e66 6c6f 7728 743d  chi'][0].flow(t=
+000006f0: 3129 2023 2065 7870 283a 6368 6931 3a29  1) # exp(:chi1:)
+00000700: 0a20 2020 2020 2020 2065 6368 6931 6920  .        echi1i 
+00000710: 3d20 6e66 5b27 6368 6927 5d5b 305d 2e66  = nf['chi'][0].f
+00000720: 6c6f 7728 743d 2d31 2920 2320 6578 7028  low(t=-1) # exp(
+00000730: 2d3a 6368 6931 3a29 0a20 2020 2020 2020  -:chi1:).       
+00000740: 200a 2020 2020 2020 2020 5468 656e 2074   .        Then t
+00000750: 6865 206d 6170 200a 2020 2020 2020 2020  he map .        
+00000760: 2020 7a20 2d3e 2065 7870 283a 6368 6931    z -> exp(:chi1
+00000770: 3a29 2873 656c 6628 6578 7028 2d3a 6368  :)(self(exp(-:ch
+00000780: 6931 3a29 287a 2929 2920 0a20 2020 2020  i1:)(z))) .     
+00000790: 2020 2077 696c 6c20 6265 2069 6e20 4e46     will be in NF
+000007a0: 2e0a 2020 2020 2020 2020 0a20 2020 2020  ..        .     
+000007b0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+000007c0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000007d0: 0a20 2020 2020 2020 206f 7264 6572 3a20  .        order: 
+000007e0: 696e 742c 206f 7074 696f 6e61 6c0a 2020  int, optional.  
+000007f0: 2020 2020 2020 2020 2020 4f72 6465 7220            Order 
+00000800: 7570 2074 6f20 7768 6963 6820 7468 6520  up to which the 
+00000810: 6e6f 726d 616c 2066 6f72 6d20 7368 6f75  normal form shou
+00000820: 6c64 2062 6520 636f 6d70 7574 6564 2e0a  ld be computed..
+00000830: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
+00000840: 2020 2020 202a 2a6b 7761 7267 730a 2020       **kwargs.  
+00000850: 2020 2020 2020 2020 2020 4f70 7469 6f6e            Option
+00000860: 616c 2061 7267 756d 656e 7473 2070 6173  al arguments pas
+00000870: 7365 6420 746f 2027 6c69 656f 7073 2e63  sed to 'lieops.c
+00000880: 6f72 652e 6269 726b 686f 6666 2e62 6e66  ore.birkhoff.bnf
+00000890: 2720 726f 7574 696e 652e 0a20 2020 2020  ' routine..     
+000008a0: 2020 2072 0d00 0000 e902 0000 0029 0272     r.........).r
+000008b0: 1500 0000 da06 6e5f 6172 6773 2907 720e  ......n_args).r.
+000008c0: 0000 0072 0d00 0000 da06 6c69 656f 7073  ...r......lieops
+000008d0: da04 636f 7265 da08 6269 726b 686f 6666  ..core..birkhoff
+000008e0: da03 626e 66da 0364 696d 2903 7210 0000  ..bnf..dim).r...
+000008f0: 0072 1500 0000 7212 0000 0072 1300 0000  .r....r....r....
+00000900: 7213 0000 0072 1400 0000 721b 0000 0031  r....r....r....1
+00000910: 0000 0073 0400 0000 1216 2201 7a08 706f  ...s......".z.po
+00000920: 6c79 2e62 6e66 6301 0000 0000 0000 0000  ly.bnfc.........
+00000930: 0000 0004 0000 0004 0000 004f 0000 0073  ...........O...s
+00000940: 2400 0000 7c00 6a00 7c01 6900 7c02 a401  $...|.j.|.i.|...
+00000950: 8e01 7d03 7c03 6a01 6402 6900 7c02 a401  ..}.|.j.d.i.|...
+00000960: 8e01 0100 7c03 5300 2903 6136 0200 000a  ....|.S.).a6....
+00000970: 2020 2020 2020 2020 436f 6d70 7574 6520          Compute 
+00000980: 7468 6520 666c 6f77 206f 6620 7468 6520  the flow of the 
+00000990: 6375 7272 656e 7420 4c69 6520 706f 6c79  current Lie poly
+000009a0: 6e6f 6d69 616c 2e20 5368 6f72 7463 7574  nomial. Shortcut
+000009b0: 2066 6f72 2073 656c 662e 6c65 7870 2061   for self.lexp a
+000009c0: 6e64 2074 6865 6e20 6361 6c63 466c 6f77  nd then calcFlow
+000009d0: 206f 6e0a 2020 2020 2020 2020 7468 6520   on.        the 
+000009e0: 7265 7370 6563 7469 7665 206f 626a 6563  respective objec
+000009f0: 742e 0a20 2020 2020 2020 200a 2020 2020  t..        .    
+00000a00: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00000a10: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00000a20: 2d0a 2020 2020 2020 2020 2a61 7267 730a  -.        *args.
+00000a30: 2020 2020 2020 2020 2020 2020 4f70 7469              Opti
+00000a40: 6f6e 616c 2061 7267 756d 656e 7473 2070  onal arguments p
+00000a50: 6173 7365 6420 746f 2073 656c 662e 6c65  assed to self.le
+00000a60: 7870 2e0a 2020 2020 2020 2020 2020 2020  xp..            
+00000a70: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
 00000a80: 730a 2020 2020 2020 2020 2020 2020 4f70  s.            Op
-00000a90: 7469 6f6e 616c 2061 7267 756d 656e 7473  tional arguments
-00000aa0: 2070 6173 7365 6420 746f 2073 656c 662e   passed to self.
-00000ab0: 6c65 7870 2e0a 2020 2020 2020 2020 2020  lexp..          
-00000ac0: 2020 0a20 2020 2020 2020 202a 2a6b 7761    .        **kwa
-00000ad0: 7267 730a 2020 2020 2020 2020 2020 2020  rgs.            
-00000ae0: 4f70 7469 6f6e 616c 206b 6579 776f 7264  Optional keyword
-00000af0: 6564 2061 7267 756d 656e 7473 2070 6173  ed arguments pas
-00000b00: 7365 6420 746f 2073 656c 662e 6c65 7870  sed to self.lexp
-00000b10: 2061 6e64 206c 6965 6f70 6572 6174 6f72   and lieoperator
-00000b20: 2e63 616c 6346 6c6f 772e 0a20 2020 2020  .calcFlow..     
-00000b30: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00000b40: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-00000b50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00000b60: 6c6f 2c20 6c65 7870 0a20 2020 2020 2020  lo, lexp.       
-00000b70: 2020 2020 2041 206c 6578 7020 286c 6965       A lexp (lie
-00000b80: 6f70 6572 6174 6f72 2920 6f62 6a65 6374  operator) object
-00000b90: 2c20 636f 6e74 6169 6e69 6e67 2074 6865  , containing the
-00000ba0: 2066 6c6f 7720 6675 6e63 7469 6f6e 206f   flow function o
-00000bb0: 6620 7468 6520 6375 7272 656e 7420 4c69  f the current Li
-00000bc0: 6520 706f 6c79 6e6f 6d69 616c 0a20 2020  e polynomial.   
-00000bd0: 2020 2020 2020 2020 2069 6e20 6f6e 6520           in one 
-00000be0: 6f66 2069 7473 2066 6965 6c64 732e 0a20  of its fields.. 
-00000bf0: 2020 2020 2020 204e 7214 0000 0029 0272         Nr....).r
-00000c00: 1000 0000 720c 0000 0029 0472 1100 0000  ....r....).r....
-00000c10: 7212 0000 0072 1300 0000 da02 6c6f 7214  r....r......lor.
-00000c20: 0000 0072 1400 0000 7215 0000 0072 0c00  ...r....r....r..
-00000c30: 0000 4c00 0000 7306 0000 0010 1310 0104  ..L...s.........
-00000c40: 017a 0d70 6f6c 792e 6361 6c63 466c 6f77  .z.poly.calcFlow
-00000c50: 6302 0000 0000 0000 0000 0000 0002 0000  c...............
-00000c60: 0004 0000 0043 0000 0073 2000 0000 7400  .....C...s ...t.
-00000c70: 7c01 7401 8302 720a 7c01 7c00 8301 0b00  |.t...r.|.|.....
-00000c80: 5300 7402 a003 7c00 7c01 a102 5300 a901  S.t...|.|...S...
-00000c90: 4e29 04da 0a69 7369 6e73 7461 6e63 65da  N)...isinstance.
-00000ca0: 0b6c 6965 6f70 6572 6174 6f72 7206 0000  .lieoperatorr...
-00000cb0: 00da 0a5f 5f6d 6174 6d75 6c5f 5fa9 0272  ...__matmul__..r
-00000cc0: 1100 0000 da05 6f74 6865 7272 1400 0000  ......otherr....
-00000cd0: 7214 0000 0072 1500 0000 7224 0000 0063  r....r....r$...c
-00000ce0: 0000 0073 0600 0000 0a01 0a01 0c02 7a0f  ...s..........z.
-00000cf0: 706f 6c79 2e5f 5f6d 6174 6d75 6c5f 5f4e  poly.__matmul__N
-00000d00: 2902 7203 0000 0072 1600 0000 2908 da08  ).r....r....)...
-00000d10: 5f5f 6e61 6d65 5f5f da0a 5f5f 6d6f 6475  __name__..__modu
-00000d20: 6c65 5f5f da0c 5f5f 7175 616c 6e61 6d65  le__..__qualname
-00000d30: 5f5f 7210 0000 00da 0369 6e74 721e 0000  __r......intr...
-00000d40: 0072 0c00 0000 7224 0000 0072 1400 0000  .r....r$...r....
-00000d50: 7214 0000 0072 1400 0000 7215 0000 0072  r....r....r....r
-00000d60: 0d00 0000 1400 0000 730a 0000 0008 0008  ........s.......
-00000d70: 0210 1d08 190c 1772 0d00 0000 4663 0200  .......r....Fc..
-00000d80: 0000 0000 0000 0000 0000 0900 0000 0800  ................
-00000d90: 0000 0b00 0000 7316 0100 0067 0067 0002  ......s....g.g..
-00000da0: 027d 037d 0474 007c 0083 0144 005d 7d89  .}.}.t.|...D.]}.
-00000db0: 0087 0066 0164 0164 0284 0874 007c 0083  ...f.d.d...t.|..
-00000dc0: 0144 0083 017d 057c 0173 3574 0164 0b7c  .D...}.|.s5t.d.|
-00000dd0: 0564 0367 017c 0014 007c 0064 049c 037c  .d.g.|...|.d...|
-00000de0: 02a4 018e 017d 0674 0164 0b64 0367 017c  .....}.t.d.d.g.|
-00000df0: 0014 007c 057c 0064 049c 037c 02a4 018e  ...|.|.d...|....
-00000e00: 017d 076e 4774 0274 03a0 0464 05a1 0183  .}.nGt.t...d....
-00000e10: 017d 0874 0164 0b74 057c 0564 0367 017c  .}.t.d.t.|.d.g.|
-00000e20: 0014 0017 0083 0164 067c 081b 0074 0564  .......d.|...t.d
-00000e30: 0367 017c 0014 007c 0517 0083 0164 067c  .g.|...|.....d.|
-00000e40: 081b 0069 027c 0064 079c 027c 02a4 018e  ...i.|.d...|....
-00000e50: 017d 0674 0164 0b74 057c 0564 0367 017c  .}.t.d.t.|.d.g.|
-00000e60: 0014 0017 0083 0164 087c 081b 0074 0564  .......d.|...t.d
-00000e70: 0367 017c 0014 007c 0517 0083 0164 097c  .g.|...|.....d.|
-00000e80: 081b 0069 027c 0064 079c 027c 02a4 018e  ...i.|.d...|....
-00000e90: 017d 077c 03a0 067c 06a1 0101 007c 04a0  .}.|...|.....|..
-00000ea0: 067c 07a1 0101 0071 097c 037c 0417 0053  .|.....q.|.|...S
-00000eb0: 0029 0c61 b202 0000 0a20 2020 2043 7265  .).a.....    Cre
-00000ec0: 6174 6520 6120 7365 7420 6f66 2063 6f6d  ate a set of com
-00000ed0: 706c 6578 2028 7869 2c20 6574 6129 2d4c  plex (xi, eta)-L
-00000ee0: 6965 2070 6f6c 796e 6f6d 6961 6c73 2066  ie polynomials f
-00000ef0: 6f72 2061 2067 6976 656e 2064 696d 656e  or a given dimen
-00000f00: 7369 6f6e 2e0a 2020 2020 0a20 2020 2050  sion..    .    P
-00000f10: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-00000f20: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064 696d  --------.    dim
-00000f30: 3a20 696e 740a 2020 2020 2020 2020 5468  : int.        Th
-00000f40: 6520 7265 7175 6573 7465 6420 6469 6d65  e requested dime
-00000f50: 6e73 696f 6e2e 0a20 2020 2020 2020 200a  nsion..        .
-00000f60: 2020 2020 7265 616c 3a20 626f 6f6c 6561      real: boolea
-00000f70: 6e2c 206f 7074 696f 6e61 6c0a 2020 2020  n, optional.    
-00000f80: 2020 2020 4966 2074 7275 652c 2063 7265      If true, cre
-00000f90: 6174 6520 7265 616c 2d76 616c 7565 6420  ate real-valued 
-00000fa0: 636f 6f72 6469 6e61 7465 7320 7120 616e  coordinates q an
-00000fb0: 6420 7020 696e 7374 6561 642e 200a 2020  d p instead. .  
-00000fc0: 2020 2020 2020 0a20 2020 2020 2020 204e        .        N
-00000fd0: 6f74 6520 7468 6174 2069 7420 686f 6c64  ote that it hold
-00000fe0: 733a 0a20 2020 2020 2020 2071 203d 2028  s:.        q = (
-00000ff0: 7869 202b 2065 7461 292f 7371 7274 2832  xi + eta)/sqrt(2
-00001000: 290a 2020 2020 2020 2020 7020 3d20 2878  ).        p = (x
-00001010: 6920 2d20 6574 6129 2f73 7172 7428 3229  i - eta)/sqrt(2)
-00001020: 2f31 6a0a 2020 2020 2020 2020 0a20 2020  /1j.        .   
-00001030: 202a 2a6b 7761 7267 730a 2020 2020 2020   **kwargs.      
-00001040: 2020 4f70 7469 6f6e 616c 2061 7267 756d    Optional argum
-00001050: 656e 7473 2070 6173 7365 6420 746f 2070  ents passed to p
-00001060: 6f6c 7920 636c 6173 732e 0a20 2020 2020  oly class..     
-00001070: 2020 200a 2020 2020 5265 7475 726e 730a     .    Returns.
-00001080: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00001090: 6c69 7374 0a20 2020 2020 2020 204c 6973  list.        Lis
-000010a0: 7420 6f66 206c 656e 6774 6820 322a 6469  t of length 2*di
-000010b0: 6d20 7769 7468 2070 6f6c 7920 656e 7472  m with poly entr
-000010c0: 6965 732c 2063 6f72 7265 7370 6f6e 6469  ies, correspondi
-000010d0: 6e67 2074 6f20 7468 6520 7869 5f6b 2061  ng to the xi_k a
-000010e0: 6e64 2065 7461 5f6b 204c 6965 2070 6f6c  nd eta_k Lie pol
-000010f0: 796e 6f6d 6961 6c73 2e20 4865 7265 6279  ynomials. Hereby
-00001100: 2074 6865 2066 6972 7374 0a20 2020 2020   the first.     
-00001110: 2020 2064 696d 2065 6e74 7269 6573 2062     dim entries b
-00001120: 656c 6f6e 6720 746f 2074 6865 2078 692d  elong to the xi-
-00001130: 7661 6c75 6573 2c20 7768 696c 6520 7468  values, while th
-00001140: 6520 6c61 7374 2064 696d 2065 6e74 7269  e last dim entri
-00001150: 6573 2074 6f20 7468 6520 6574 612d 7661  es to the eta-va
-00001160: 6c75 6573 2e0a 2020 2020 6301 0000 0000  lues..    c.....
-00001170: 0000 0000 0000 0002 0000 0004 0000 0013  ................
-00001180: 0000 0073 1c00 0000 6700 7c00 5d0a 7d01  ...s....g.|.].}.
-00001190: 7c01 8800 6b03 720a 6400 6e01 6401 9102  |...k.r.d.n.d...
-000011a0: 7102 5300 2902 7201 0000 0072 0300 0000  q.S.).r....r....
-000011b0: 7214 0000 0029 02da 022e 30da 0169 a901  r....)....0..i..
-000011c0: da01 6b72 1400 0000 7215 0000 00da 0a3c  ..kr....r......<
-000011d0: 6c69 7374 636f 6d70 3e85 0000 00f3 0200  listcomp>.......
-000011e0: 0000 1c00 7a21 6372 6561 7465 5f63 6f6f  ....z!create_coo
-000011f0: 7264 732e 3c6c 6f63 616c 733e 2e3c 6c69  rds.<locals>.<li
-00001200: 7374 636f 6d70 3e72 0100 0000 2903 da01  stcomp>r....)...
-00001210: 61da 0162 721f 0000 0072 1800 0000 7203  a..br....r....r.
-00001220: 0000 0029 02da 0676 616c 7565 7372 1f00  ...)...valuesr..
-00001230: 0000 7900 0000 0000 0000 8000 0000 0000  ..y.............
-00001240: 00f0 bf79 0000 0000 0000 0000 0000 0000  ...y............
-00001250: 0000 f03f 4e72 1400 0000 2907 da05 7261  ...?Nr....)...ra
-00001260: 6e67 6572 0d00 0000 da05 666c 6f61 74da  nger......float.
-00001270: 026e 70da 0473 7172 74da 0574 7570 6c65  .np..sqrt..tuple
-00001280: da06 6170 7065 6e64 2909 721f 0000 00da  ..append).r.....
-00001290: 0472 6561 6c72 1300 0000 da07 7265 7375  .realr......resu
-000012a0: 6c74 78da 0772 6573 756c 7479 da02 656b  ltx..resulty..ek
-000012b0: da04 7869 5f6b da05 6574 615f 6bda 0573  ..xi_k..eta_k..s
-000012c0: 7172 7432 7214 0000 0072 2d00 0000 7215  qrt2r....r-...r.
-000012d0: 0000 00da 0d63 7265 6174 655f 636f 6f72  .....create_coor
-000012e0: 6473 6a00 0000 7330 0000 000a 190c 0116  dsj...s0........
-000012f0: 0104 011c 011e 010e 021a 0116 0102 ff02  ................
-00001300: 0204 fe02 0206 fe1a 0316 0102 ff02 0204  ................
-00001310: fe02 0206 fe0a 030c 0108 0172 4100 0000  ...........rA...
-00001320: 6300 0000 0000 0000 0000 0000 0000 0000  c...............
-00001330: 0003 0000 0040 0000 0073 9000 0000 6500  .....@...s....e.
-00001340: 5a01 6400 5a02 6401 5a03 6402 6403 8400  Z.d.Z.d.Z.d.d...
-00001350: 5a04 6404 6405 8400 5a05 6406 6407 8400  Z.d.d...Z.d.d...
-00001360: 5a06 6408 6409 8400 5a07 640a 640b 8400  Z.d.d...Z.d.d...
-00001370: 5a08 640c 640d 8400 5a09 6423 640f 6410  Z.d.d...Z.d#d.d.
-00001380: 8401 5a0a 6411 6412 8400 5a0b 6413 6414  ..Z.d.d...Z.d.d.
-00001390: 8400 5a0c 6415 6416 8400 5a0d 6417 6418  ..Z.d.d...Z.d.d.
-000013a0: 8400 5a0e 640e 6419 9c01 641a 641b 8402  ..Z.d.d...d.d...
-000013b0: 5a0f 641c 641d 8400 5a10 641e 641f 8400  Z.d.d...Z.d.d...
-000013c0: 5a11 6420 6421 8400 5a12 6422 5300 2924  Z.d d!..Z.d"S.)$
-000013d0: 7223 0000 0061 2201 0000 0a20 2020 2043  r#...a"....    C
-000013e0: 6c61 7373 2074 6f20 636f 6e73 7472 7563  lass to construc
-000013f0: 7420 616e 6420 776f 726b 2077 6974 6820  t and work with 
-00001400: 616e 206f 7065 7261 746f 7220 6f66 2074  an operator of t
-00001410: 6865 2066 6f72 6d20 6728 3a78 3a29 2e0a  he form g(:x:)..
-00001420: 2020 2020 0a20 2020 2050 6172 616d 6574      .    Paramet
-00001430: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-00001440: 2d2d 0a20 2020 2078 3a20 706f 6c79 0a20  --.    x: poly. 
-00001450: 2020 2020 2020 2054 6865 2066 756e 6374         The funct
-00001460: 696f 6e20 696e 2074 6865 2061 7267 756d  ion in the argum
-00001470: 656e 7420 6f66 2074 6865 204c 6965 206f  ent of the Lie o
-00001480: 7065 7261 746f 722e 0a20 2020 200a 2020  perator..    .  
-00001490: 2020 2a2a 6b77 6172 6773 0a20 2020 2020    **kwargs.     
-000014a0: 2020 204f 7074 696f 6e61 6c20 6172 6775     Optional argu
-000014b0: 6d65 6e74 7320 6d61 7920 6265 2070 6173  ments may be pas
-000014c0: 7365 6420 746f 2073 656c 662e 7365 745f  sed to self.set_
-000014d0: 6765 6e65 7261 746f 7220 616e 6420 2870  generator and (p
-000014e0: 6f73 7369 626c 6529 2073 656c 662e 6361  ossible) self.ca
-000014f0: 6c63 466c 6f77 2e0a 2020 2020 6302 0000  lcFlow..    c...
-00001500: 0000 0000 0000 0000 0003 0000 0004 0000  ................
-00001510: 004b 0000 0073 5c00 0000 6401 6402 6901  .K...s\...d.d.i.
-00001520: 7c00 5f00 6900 7c00 5f01 6403 7c00 5f02  |._.i.|._.d.|._.
-00001530: 6403 7c00 6a00 a003 a100 6901 7c00 5f04  d.|.j.....i.|._.
-00001540: 7c00 6a05 7c01 6601 6900 7c02 a401 8e01  |.j.|.f.i.|.....
-00001550: 0100 6404 7c02 a006 a100 7600 722c 7c00  ..d.|.....v.r,|.
-00001560: 6a07 6405 6900 7c02 a401 8e01 0100 6400  j.d.i.|.......d.
-00001570: 5300 6400 5300 2906 4eda 0174 7203 0000  S.d.S.).N..tr...
-00001580: 00da 0a62 7275 7465 666f 7263 65da 0967  ...bruteforce..g
-00001590: 656e 6572 6174 6f72 7214 0000 0029 08da  eneratorr....)..
-000015a0: 185f 6465 6661 756c 745f 666c 6f77 5f70  ._default_flow_p
-000015b0: 6172 616d 6574 6572 73da 055f 666c 6f77  arameters.._flow
-000015c0: da0c 5f66 6c6f 775f 6d65 7468 6f64 da04  .._flow_method..
-000015d0: 636f 7079 da10 5f66 6c6f 775f 7061 7261  copy.._flow_para
-000015e0: 6d65 7465 7273 da0c 7365 745f 6172 6775  meters..set_argu
-000015f0: 6d65 6e74 da04 6b65 7973 da0d 7365 745f  ment..keys..set_
-00001600: 6765 6e65 7261 746f 72a9 0372 1100 0000  generator..r....
-00001610: da08 6172 6775 6d65 6e74 7213 0000 0072  ..argumentr....r
-00001620: 1400 0000 7214 0000 0072 1500 0000 da08  ....r....r......
-00001630: 5f5f 696e 6974 5f5f a100 0000 7310 0000  __init__....s...
-00001640: 000a 0106 0106 0310 0112 020c 0114 0104  ................
-00001650: ff7a 146c 6965 6f70 6572 6174 6f72 2e5f  .z.lieoperator._
-00001660: 5f69 6e69 745f 5f63 0200 0000 0000 0000  _init__c........
-00001670: 0000 0000 0300 0000 0300 0000 4b00 0000  ............K...
-00001680: 7326 0000 0074 007c 0174 0183 0273 074a  s&...t.|.t...s.J
-00001690: 0082 017c 017c 005f 0264 017c 006a 026a  ...|.|._.d.|.j.j
-000016a0: 0314 007c 005f 0464 0053 0029 024e 7218  ...|._.d.S.).Nr.
-000016b0: 0000 0029 0572 2200 0000 720d 0000 0072  ...).r"...r....r
-000016c0: 4e00 0000 721f 0000 0072 1a00 0000 724d  N...r....r....rM
-000016d0: 0000 0072 1400 0000 7214 0000 0072 1500  ...r....r....r..
-000016e0: 0000 724a 0000 00ad 0000 0073 0600 0000  ..rJ.......s....
-000016f0: 0e01 0601 1201 7a18 6c69 656f 7065 7261  ......z.lieopera
-00001700: 746f 722e 7365 745f 6172 6775 6d65 6e74  tor.set_argument
-00001710: 6301 0000 0000 0000 0000 0000 0001 0000  c...............
-00001720: 0004 0000 0043 0000 0073 1400 0000 7c00  .....C...s....|.
-00001730: 6a00 7c00 6a01 1900 a002 6401 6402 a102  j.|.j.....d.d...
-00001740: 5300 2903 7a56 0a20 2020 2020 2020 2052  S.).zV.        R
-00001750: 6574 7572 6e20 7468 6520 636f 6d70 6f6e  eturn the compon
-00001760: 656e 7473 2077 6869 6368 2068 6173 2062  ents which has b
-00001770: 6565 6e20 7365 7420 696e 2074 6865 2063  een set in the c
-00001780: 7572 7265 6e74 2066 6c6f 7720 6d65 7468  urrent flow meth
-00001790: 6f64 2e0a 2020 2020 2020 2020 da0a 636f  od..        ..co
-000017a0: 6d70 6f6e 656e 7473 4e29 0372 4900 0000  mponentsN).rI...
-000017b0: 7247 0000 0072 0f00 0000 a901 7211 0000  rG...r......r...
-000017c0: 0072 1400 0000 7214 0000 0072 1500 0000  .r....r....r....
-000017d0: da0e 6765 745f 636f 6d70 6f6e 656e 7473  ..get_components
-000017e0: b200 0000 7302 0000 0014 047a 1a6c 6965  ....s......z.lie
-000017f0: 6f70 6572 6174 6f72 2e67 6574 5f63 6f6d  operator.get_com
-00001800: 706f 6e65 6e74 7363 0100 0000 0000 0000  ponentsc........
-00001810: 0000 0000 0300 0000 0400 0000 4b00 0000  ............K...
-00001820: 7362 0000 0064 017c 01a0 00a1 0076 0072  sb...d.|.....v.r
-00001830: 127c 0164 0119 007c 006a 017c 006a 0219  .|.d...|.j.|.j..
-00001840: 0064 013c 0064 0453 007c 01a0 0364 027c  .d.<.d.S.|...d.|
-00001850: 006a 046a 05a1 027d 027c 01a0 0364 037c  .j.j...}.|...d.|
-00001860: 006a 046a 06a1 027d 0274 0764 0569 007c  .j.j...}.t.d.i.|
-00001870: 01a4 018e 017c 006a 017c 006a 0219 0064  .....|.j.|.j...d
-00001880: 013c 0064 0453 0029 067a 420a 2020 2020  .<.d.S.).zB.    
-00001890: 2020 2020 5365 7420 6769 7665 6e20 636f      Set given co
-000018a0: 6d70 6f6e 656e 7473 2074 6f20 7468 6520  mponents to the 
-000018b0: 6375 7272 656e 7420 666c 6f77 206d 6574  current flow met
-000018c0: 686f 642e 0a20 2020 2020 2020 2072 5000  hod..        rP.
-000018d0: 0000 721f 0000 0072 0e00 0000 4e72 1400  ..r....r....Nr..
-000018e0: 0000 2908 724b 0000 0072 4900 0000 7247  ..).rK...rI...rG
-000018f0: 0000 00da 0a73 6574 6465 6661 756c 7472  .....setdefaultr
-00001900: 4e00 0000 721f 0000 0072 0e00 0000 7241  N...r....r....rA
-00001910: 0000 0029 0372 1100 0000 7213 0000 00da  ...).r....r.....
-00001920: 015f 7214 0000 0072 1400 0000 7215 0000  ._r....r....r...
-00001930: 00da 0e73 6574 5f63 6f6d 706f 6e65 6e74  ...set_component
-00001940: 73b8 0000 0073 0a00 0000 0c04 1801 1002  s....s..........
-00001950: 1001 1e01 7a1a 6c69 656f 7065 7261 746f  ....z.lieoperato
-00001960: 722e 7365 745f 636f 6d70 6f6e 656e 7473  r.set_components
-00001970: 6301 0000 0000 0000 0000 0000 0001 0000  c...............
-00001980: 0005 0000 0043 0000 0073 1600 0000 7c00  .....C...s....|.
-00001990: 6a00 a001 7c00 6a02 7c00 6a03 a004 a100  j...|.j.|.j.....
-000019a0: a102 5300 2901 7a49 0a20 2020 2020 2020  ..S.).zI.       
-000019b0: 2052 6574 7572 6e20 7468 6520 666c 6f77   Return the flow
-000019c0: 2070 6172 616d 6574 6572 7320 666f 7220   parameters for 
-000019d0: 7468 6520 6375 7272 656e 7420 666c 6f77  the current flow
-000019e0: 206d 6574 686f 642e 0a20 2020 2020 2020   method..       
-000019f0: 2029 0572 4900 0000 720f 0000 0072 4700   ).rI...r....rG.
-00001a00: 0000 7245 0000 0072 4800 0000 7251 0000  ..rE...rH...rQ..
-00001a10: 0072 1400 0000 7214 0000 0072 1500 0000  .r....r....r....
-00001a20: da13 6765 745f 666c 6f77 5f70 6172 616d  ..get_flow_param
-00001a30: 6574 6572 73c3 0000 0073 0200 0000 1604  eters....s......
-00001a40: 7a1f 6c69 656f 7065 7261 746f 722e 6765  z.lieoperator.ge
-00001a50: 745f 666c 6f77 5f70 6172 616d 6574 6572  t_flow_parameter
-00001a60: 7363 0200 0000 0000 0000 0000 0000 0300  sc..............
-00001a70: 0000 0400 0000 4b00 0000 734a 0000 0074  ......K...sJ...t
-00001a80: 007c 0164 0183 0272 097c 017c 005f 016e  .|.d...r.|.|._.n
-00001a90: 1274 007c 0164 0283 0272 177c 0164 0669  .t.|.d...r.|.d.i
-00001aa0: 007c 02a4 018e 017c 005f 016e 0474 0264  .|.....|._.n.t.d
-00001ab0: 0383 0182 0174 037c 006a 0183 0164 0418  .....t.|.j...d..
-00001ac0: 007c 005f 0464 0553 0029 0761 f801 0000  .|._.d.S.).a....
-00001ad0: 0a20 2020 2020 2020 2044 6566 696e 6520  .        Define 
-00001ae0: 7468 6520 6765 6e65 7261 7469 6e67 2073  the generating s
-00001af0: 6572 6965 7320 666f 7220 7468 6520 6675  eries for the fu
-00001b00: 6e63 7469 6f6e 2067 2e0a 2020 2020 2020  nction g..      
-00001b10: 2020 0a20 2020 2020 2020 2050 6172 616d    .        Param
-00001b20: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-00001b30: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00001b40: 2067 656e 6572 6174 6f72 3a20 7375 6273   generator: subs
-00001b50: 6372 6970 7461 626c 6520 6f72 2063 616c  criptable or cal
-00001b60: 6c61 626c 650a 2020 2020 2020 2020 2020  lable.          
-00001b70: 2020 4966 2073 7562 7363 7269 7074 6162    If subscriptab
-00001b80: 6c65 2c20 6765 6e65 7261 746f 725b 6b5d  le, generator[k]
-00001b90: 203d 3a20 615f 6b20 6465 6669 6e65 7320   =: a_k defines 
-00001ba0: 7468 6520 6765 6e65 7261 7469 6e67 2073  the generating s
-00001bb0: 6572 6965 7320 666f 7220 7468 6520 6675  eries for the fu
-00001bc0: 6e63 7469 6f6e 0a20 2020 2020 2020 2020  nction.         
-00001bd0: 2020 2067 2073 6f20 7468 6174 2074 6865     g so that the
-00001be0: 204c 6965 206f 7065 7261 746f 7220 636f   Lie operator co
-00001bf0: 7272 6573 706f 6e64 7320 746f 2067 283a  rresponds to g(:
-00001c00: 783a 292e 0a20 2020 2020 2020 2020 2020  x:)..           
-00001c10: 200a 2020 2020 2020 2020 2020 2020 6728   .            g(
-00001c20: 7a29 203d 2073 756d 5f6b 2061 5f6b 2a7a  z) = sum_k a_k*z
-00001c30: 2a2a 6b2e 0a20 2020 2020 2020 2020 2020  **k..           
-00001c40: 200a 2020 2020 2020 2020 2020 2020 4966   .            If
-00001c50: 2067 2069 7320 6120 6361 6c6c 6162 6c65   g is a callable
-00001c60: 206f 626a 6563 742c 2074 6865 6e20 6164   object, then ad
-00001c70: 6469 7469 6f6e 616c 2061 7267 756d 656e  ditional argumen
-00001c80: 7473 2061 7265 2070 6173 7365 6420 746f  ts are passed to
-00001c90: 2074 6869 7320 6361 6c6c 6162 6c65 2074   this callable t
-00001ca0: 6f0a 2020 2020 2020 2020 2020 2020 6372  o.            cr
-00001cb0: 6561 7465 2074 6865 2061 5f6b 2773 2e0a  eate the a_k's..
-00001cc0: 2020 2020 2020 2020 da08 5f5f 6974 6572          ..__iter
-00001cd0: 5f5f da08 5f5f 6361 6c6c 5f5f 7a1f 496e  __..__call__z.In
-00001ce0: 7075 7420 6765 6e65 7261 746f 7220 6e6f  put generator no
-00001cf0: 7420 7265 636f 676e 697a 6564 2e72 0300  t recognized.r..
-00001d00: 0000 4e72 1400 0000 2905 da07 6861 7361  ..Nr....)...hasa
-00001d10: 7474 7272 4400 0000 da13 4e6f 7449 6d70  ttrrD.....NotImp
-00001d20: 6c65 6d65 6e74 6564 4572 726f 72da 036c  lementedError..l
-00001d30: 656e 7219 0000 0029 0372 1100 0000 7244  enr....).r....rD
-00001d40: 0000 0072 1300 0000 7214 0000 0072 1400  ...r....r....r..
-00001d50: 0000 7215 0000 0072 4c00 0000 c900 0000  ..r....rL.......
-00001d60: 730c 0000 000a 0f08 020a 0112 0108 0214  s...............
-00001d70: 017a 196c 6965 6f70 6572 6174 6f72 2e73  .z.lieoperator.s
-00001d80: 6574 5f67 656e 6572 6174 6f72 4663 0200  et_generatorFc..
-00001d90: 0000 0000 0000 0000 0000 0600 0000 0400  ................
-00001da0: 0000 0b00 0000 73de 0000 007c 02a0 0064  ......s....|...d
-00001db0: 017c 006a 01a1 027c 005f 017c 00a0 02a1  .|.j...|._.|....
-00001dc0: 007d 037c 0170 167c 02a0 03a1 007c 03a0  .}.|.p.|.....|..
-00001dd0: 03a1 006b 010c 007d 0164 027c 02a0 04a1  ...k...}.d.|....
-00001de0: 0076 0072 507c 0264 0219 0089 0064 027c  .v.rP|.d.....d.|
-00001df0: 03a0 04a1 0076 0172 2e88 007c 0364 023c  .....v.r...|.d.<
-00001e00: 0064 037d 016e 227c 0364 0219 0089 0174  .d.}.n"|.d.....t
-00001e10: 0574 0688 0083 0174 0688 0183 0167 0283  .t.....t.....g..
-00001e20: 017d 0474 0787 0087 0166 0264 0464 0584  .}.t.....f.d.d..
-00001e30: 0874 087c 0483 0144 0083 0183 0172 5088  .t.|...D.....rP.
-00001e40: 007c 0364 023c 0064 037d 017c 0172 6d7c  .|.d.<.d.}.|.rm|
-00001e50: 03a0 097c 02a1 0101 007c 037c 006a 0a7c  ...|.....|.|.j.|
-00001e60: 006a 013c 007c 006a 017c 006a 0ba0 04a1  .j.<.|.j.|.j....
-00001e70: 0076 0072 6d7c 006a 0ba0 0c7c 006a 0164  .v.rm|.j...|.j.d
-00001e80: 06a1 027d 057c 0153 0029 0761 3e01 0000  ...}.|.S.).a>...
-00001e90: 0a20 2020 2020 2020 2055 7064 6174 6520  .        Update 
-00001ea0: 7365 6c66 2e5f 666c 6f77 5f70 6172 616d  self._flow_param
-00001eb0: 6574 6572 7320 6966 206e 6563 6573 7361  eters if necessa
-00001ec0: 7279 3b20 7265 7475 726e 2062 6f6f 6c65  ry; return boole
-00001ed0: 616e 2069 6620 7468 6579 2068 6176 6520  an if they have 
-00001ee0: 6265 656e 2075 7064 6174 6564 200a 2020  been updated .  
-00001ef0: 2020 2020 2020 2861 6e64 2074 6865 7265        (and there
-00001f00: 666f 7265 2073 656c 662e 666c 6f77 206d  fore self.flow m
-00001f10: 6179 2068 6176 6520 746f 2062 6520 7265  ay have to be re
-00001f20: 2d63 616c 6375 6c61 7465 6429 2e0a 2020  -calculated)..  
-00001f30: 2020 2020 2020 0a20 2020 2020 2020 2054        .        T
-00001f40: 6869 7320 696e 7465 726e 616c 2072 6f75  his internal rou
-00001f50: 7469 6e65 2069 7320 696e 6465 6e64 6564  tine is indended
-00001f60: 2074 6f20 6865 6c70 2069 6e20 6465 7465   to help in dete
-00001f70: 726d 696e 696e 6720 7768 656e 2074 6f20  rmining when to 
-00001f80: 7265 2d63 616c 6375 6c61 7465 0a20 2020  re-calculate.   
-00001f90: 2020 2020 2074 6865 2066 6c6f 7720 616e       the flow an
-00001fa0: 6420 7468 7573 2073 7065 6564 696e 6720  d thus speeding 
-00001fb0: 7570 2066 6c6f 7720 6361 6c63 756c 6174  up flow calculat
-00001fc0: 696f 6e73 2e0a 2020 2020 2020 2020 da06  ions..        ..
-00001fd0: 6d65 7468 6f64 7250 0000 0054 6301 0000  methodrP...Tc...
-00001fe0: 0000 0000 0000 0000 0002 0000 0008 0000  ................
-00001ff0: 0013 0000 0073 3800 0000 6700 7c00 5d18  .....s8...g.|.].
-00002000: 7d01 7400 7401 8801 7c01 6400 8502 1900  }.t.t...|.d.....
-00002010: 8301 6400 8302 7400 7401 8800 7c01 6400  ..d...t.t...|.d.
-00002020: 8502 1900 8301 6400 8302 6b03 9102 7102  ......d...k...q.
-00002030: 5300 7221 0000 0029 02da 046e 6578 74da  S.r!...)...next.
-00002040: 0469 7465 72a9 0272 2b00 0000 722e 0000  .iter..r+...r...
-00002050: 00a9 0272 5000 0000 da12 6375 7272 656e  ...rP.....curren
-00002060: 745f 636f 6d70 6f6e 656e 7473 7214 0000  t_componentsr...
-00002070: 0072 1500 0000 722f 0000 00f5 0000 0073  .r....r/.......s
-00002080: 0200 0000 3800 7a37 6c69 656f 7065 7261  ....8.z7lieopera
-00002090: 746f 722e 5f75 7064 6174 655f 666c 6f77  tor._update_flow
-000020a0: 5f70 6172 616d 6574 6572 732e 3c6c 6f63  _parameters.<loc
-000020b0: 616c 733e 2e3c 6c69 7374 636f 6d70 3e4e  als>.<listcomp>N
-000020c0: 290d 720f 0000 0072 4700 0000 7256 0000  ).r....rG...rV..
-000020d0: 00da 0569 7465 6d73 724b 0000 00da 036d  ...itemsrK.....m
-000020e0: 6178 725b 0000 00da 0361 6e79 7234 0000  axr[.....anyr4..
-000020f0: 00da 0675 7064 6174 6572 4900 0000 7246  ...updaterI...rF
-00002100: 0000 00da 0370 6f70 2906 7211 0000 0072  .....pop).r....r
-00002110: 6500 0000 7213 0000 00da 1263 7572 7265  e...r......curre
-00002120: 6e74 5f70 6172 616d 6574 6572 73da 016e  nt_parameters..n
-00002130: 7254 0000 0072 1400 0000 7260 0000 0072  rT...r....r`...r
-00002140: 1500 0000 da17 5f75 7064 6174 655f 666c  ......_update_fl
-00002150: 6f77 5f70 6172 616d 6574 6572 73e1 0000  ow_parameters...
-00002160: 0073 2600 0000 1008 0801 1601 0c01 0801  .s&.............
-00002170: 0c01 0801 0601 0802 1402 1c01 0801 0401  ................
-00002180: 0402 0a01 0c01 1001 1002 0401 7a23 6c69  ............z#li
-00002190: 656f 7065 7261 746f 722e 5f75 7064 6174  eoperator._updat
-000021a0: 655f 666c 6f77 5f70 6172 616d 6574 6572  e_flow_parameter
-000021b0: 7363 0100 0000 0000 0000 0000 0000 0300  sc..............
-000021c0: 0000 0400 0000 4b00 0000 735a 0000 007c  ......K...sZ...|
-000021d0: 01a0 0064 017c 006a 01a1 027c 005f 017c  ...d.|.j...|._.|
-000021e0: 006a 0264 0469 007c 01a4 018e 017d 027c  .j.d.i.|.....}.|
-000021f0: 0273 1a7c 006a 017c 006a 03a0 04a1 0076  .s.|.j.|.j.....v
-00002200: 0172 227c 006a 0564 0469 007c 01a4 018e  .r"|.j.d.i.|....
-00002210: 0101 007c 006a 037c 006a 0119 0064 0219  ...|.j.|.j...d..
-00002220: 007c 005f 0664 0353 0029 0561 0d02 0000  .|._.d.S.).a....
-00002230: 0a20 2020 2020 2020 2043 6f6d 7075 7465  .        Compute
-00002240: 2074 6865 2066 756e 6374 696f 6e28 7329   the function(s)
-00002250: 205b 6728 743a 783a 295d 7920 666f 7220   [g(t:x:)]y for 
-00002260: 6120 6769 7665 6e20 7061 7261 6d65 7465  a given paramete
-00002270: 7220 742c 2066 6f72 2065 7665 7279 2079  r t, for every y
-00002280: 2069 6e20 7365 6c66 2e63 6f6d 706f 6e65   in self.compone
-00002290: 6e74 732e 0a20 2020 2020 2020 2054 6865  nts..        The
-000022a0: 2072 6573 756c 7420 7769 6c6c 2062 6520   result will be 
-000022b0: 7772 6974 7465 6e20 746f 2073 656c 662e  written to self.
-000022c0: 666c 6f77 2e0a 2020 2020 2020 2020 0a20  flow..        . 
-000022d0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-000022e0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-000022f0: 2d2d 2d2d 0a20 2020 2020 2020 206d 6574  ----.        met
-00002300: 686f 643a 2073 7472 2c20 6f70 7469 6f6e  hod: str, option
-00002310: 616c 0a20 2020 2020 2020 2020 2020 2054  al.            T
-00002320: 6865 206d 6574 686f 6420 746f 2062 6520  he method to be 
-00002330: 6170 706c 6965 6420 696e 2063 616c 6375  applied in calcu
-00002340: 6c61 7469 6e67 2074 6865 2066 6c6f 772e  lating the flow.
-00002350: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
-00002360: 2020 2020 2020 7570 6461 7465 3a20 626f        update: bo
-00002370: 6f6c 6561 6e2c 206f 7074 696f 6e61 6c0a  olean, optional.
-00002380: 2020 2020 2020 2020 2020 2020 416e 2069              An i
-00002390: 6e74 6572 6e61 6c20 7377 6974 6368 2074  nternal switch t
-000023a0: 6f20 666f 7263 6520 7468 6520 6361 6c63  o force the calc
-000023b0: 756c 6174 696f 6e20 6f66 2074 6865 2063  ulation of the c
-000023c0: 7572 7265 6e74 2066 6c6f 7720 2864 6566  urrent flow (def
-000023d0: 6175 6c74 3d54 7275 6529 2e0a 2020 2020  ault=True)..    
-000023e0: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-000023f0: 202a 2a6b 7761 7267 730a 2020 2020 2020   **kwargs.      
-00002400: 2020 2020 2020 4f70 7469 6f6e 616c 2061        Optional a
-00002410: 7267 756d 656e 7473 2070 6173 7365 6420  rguments passed 
-00002420: 746f 2066 6c6f 7720 7375 6272 6f75 7469  to flow subrouti
-00002430: 6e65 732e 0a20 2020 2020 2020 2072 5c00  nes..        r\.
-00002440: 0000 da04 666c 6f77 4e72 1400 0000 2907  ....flowNr....).
-00002450: 720f 0000 0072 4700 0000 7269 0000 0072  r....rG...ri...r
-00002460: 4600 0000 724b 0000 00da 175f 6361 6c63  F...rK....._calc
-00002470: 466c 6f77 4672 6f6d 5061 7261 6d65 7465  FlowFromParamete
-00002480: 7273 726a 0000 0029 0372 1100 0000 7213  rsrj...).r....r.
-00002490: 0000 0072 6500 0000 7214 0000 0072 1400  ...re...r....r..
-000024a0: 0000 7215 0000 0072 0c00 0000 0101 0000  ..r....r........
-000024b0: 730a 0000 0010 1010 0114 0110 0116 027a  s..............z
-000024c0: 146c 6965 6f70 6572 6174 6f72 2e63 616c  .lieoperator.cal
-000024d0: 6346 6c6f 7763 0100 0000 0000 0000 0000  cFlowc..........
-000024e0: 0000 0300 0000 0400 0000 4b00 0000 7354  ..........K...sT
-000024f0: 0000 007c 006a 0064 016b 0272 217c 00a0  ...|.j.d.k.r!|..
-00002500: 01a1 007d 0264 027c 02a0 02a1 0076 0172  ...}.d.|.....v.r
-00002510: 177c 006a 0364 0569 007c 01a4 018e 0101  .|.j.d.i.|......
-00002520: 007c 006a 0464 0569 007c 01a4 018e 0101  .|.j.d.i.|......
-00002530: 0064 0053 0074 0564 037c 006a 009b 0064  .d.S.t.d.|.j...d
-00002540: 049d 0383 0182 0129 064e 7243 0000 0072  .......).NrC...r
-00002550: 5000 0000 7a08 6d65 7468 6f64 2027 7a11  P...z.method 'z.
-00002560: 2720 6e6f 7420 7265 636f 676e 697a 6564  ' not recognized
-00002570: 2e72 1400 0000 2906 7247 0000 0072 5600  .r....).rG...rV.
-00002580: 0000 724b 0000 0072 5500 0000 da14 5f63  ..rK...rU....._c
-00002590: 616c 6346 6c6f 775f 6272 7574 6566 6f72  alcFlow_brutefor
-000025a0: 6365 725a 0000 0029 0372 1100 0000 7213  cerZ...).r....r.
-000025b0: 0000 00da 0f66 6c6f 775f 7061 7261 6d65  .....flow_parame
-000025c0: 7465 7273 7214 0000 0072 1400 0000 7215  tersr....r....r.
-000025d0: 0000 0072 6b00 0000 1801 0000 730c 0000  ...rk.......s...
-000025e0: 000a 0108 010c 0110 0114 0112 027a 236c  .............z#l
-000025f0: 6965 6f70 6572 6174 6f72 2e5f 6361 6c63  ieoperator._calc
-00002600: 466c 6f77 4672 6f6d 5061 7261 6d65 7465  FlowFromParamete
-00002610: 7273 6301 0000 0000 0000 0000 0000 0003  rsc.............
-00002620: 0000 0004 0000 000b 0000 0073 3c00 0000  ...........s<...
-00002630: 6900 7d02 7400 6407 6401 7c00 6901 7c01  i.}.t.d.d.|.i.|.
-00002640: a401 8e01 8900 8700 6601 6402 6403 8408  ........f.d.d...
-00002650: 7c02 6404 3c00 8800 7c02 6405 3c00 7c02  |.d.<...|.d.<.|.
-00002660: 7c00 6a01 6406 3c00 6400 5300 2908 4e72  |.j.d.<.d.S.).Nr
-00002670: 2000 0000 6300 0000 0000 0000 0000 0000   ...c...........
-00002680: 0001 0000 0004 0000 0017 0000 00f3 1c00  ................
-00002690: 0000 8701 8700 6602 6401 6402 8408 7400  ......f.d.d...t.
-000026a0: 7401 8801 8301 8301 4400 8301 5300 2903  t.......D...S.).
-000026b0: 4e63 0100 0000 0000 0000 0000 0000 0200  Nc..............
-000026c0: 0000 0400 0000 1300 0000 f318 0000 0067  ...............g
-000026d0: 007c 005d 087d 0188 007c 0119 0088 018e  .|.].}...|......
-000026e0: 0091 0271 0253 0072 1400 0000 7214 0000  ...q.S.r....r...
-000026f0: 0072 5f00 0000 a902 da10 6669 6e61 6c5f  .r_.......final_
-00002700: 636f 6d70 6f6e 656e 7473 da01 7a72 1400  components..zr..
-00002710: 0000 7215 0000 0072 2f00 0000 2501 0000  ..r....r/...%...
-00002720: f302 0000 0018 007a 466c 6965 6f70 6572  .......zFlieoper
-00002730: 6174 6f72 2e5f 6361 6c63 466c 6f77 5f62  ator._calcFlow_b
-00002740: 7275 7465 666f 7263 652e 3c6c 6f63 616c  ruteforce.<local
-00002750: 733e 2e3c 6c61 6d62 6461 3e2e 3c6c 6f63  s>.<lambda>.<loc
-00002760: 616c 733e 2e3c 6c69 7374 636f 6d70 3ea9  als>.<listcomp>.
-00002770: 0272 3400 0000 725b 0000 00a9 0172 7200  .r4...r[.....rr.
-00002780: 0000 a901 7271 0000 0072 7500 0000 7215  ....rq...ru...r.
-00002790: 0000 00da 083c 6c61 6d62 6461 3e25 0100  .....<lambda>%..
-000027a0: 0072 3000 0000 7a32 6c69 656f 7065 7261  .r0...z2lieopera
-000027b0: 746f 722e 5f63 616c 6346 6c6f 775f 6272  tor._calcFlow_br
-000027c0: 7574 6566 6f72 6365 2e3c 6c6f 6361 6c73  uteforce.<locals
-000027d0: 3e2e 3c6c 616d 6264 613e 726a 0000 00da  >.<lambda>rj....
-000027e0: 0a74 6179 6c6f 725f 6d61 7072 4300 0000  .taylor_maprC...
-000027f0: 7214 0000 0029 02da 0a42 4663 616c 6346  r....)...BFcalcF
-00002800: 6c6f 7772 4600 0000 a903 7211 0000 0072  lowrF.....r....r
-00002810: 1300 0000 da06 7265 7375 6c74 7214 0000  ......resultr...
-00002820: 0072 7600 0000 7215 0000 0072 6c00 0000  .rv...r....rl...
-00002830: 2101 0000 730a 0000 0004 0212 0110 0108  !...s...........
-00002840: 010e 017a 206c 6965 6f70 6572 6174 6f72  ...z lieoperator
-00002850: 2e5f 6361 6c63 466c 6f77 5f62 7275 7465  ._calcFlow_brute
-00002860: 666f 7263 6563 0100 0000 0000 0000 0000  forcec..........
-00002870: 0000 0300 0000 0400 0000 4b00 0000 7336  ..........K...s6
-00002880: 0000 007c 006a 00a0 017c 006a 0269 00a1  ...|.j...|.j.i..
-00002890: 027d 0264 017c 02a0 03a1 0076 0072 127c  .}.d.|.....v.r.|
-000028a0: 0264 0119 0053 0074 0464 027c 006a 029b  .d...S.t.d.|.j..
-000028b0: 0064 039d 0383 0182 0129 047a 920a 2020  .d.......).z..  
-000028c0: 2020 2020 2020 4966 2073 656c 662e 666c        If self.fl
-000028d0: 6f77 2068 6173 2062 6565 6e20 636f 6d70  ow has been comp
-000028e0: 7574 6564 2c20 636f 6d70 7574 6520 286f  uted, compute (o
-000028f0: 7220 7265 7475 726e 2920 7468 6520 7265  r return) the re
-00002900: 7375 6c74 696e 6720 706f 6c79 6e6f 6d69  sulting polynomi
-00002910: 616c 2067 283a 783a 293a 793a 2c20 0a20  al g(:x:):y:, . 
-00002920: 2020 2020 2020 2066 6f72 2065 7665 7279         for every
-00002930: 2079 2069 6e20 7365 6c66 2e63 6f6d 706f   y in self.compo
-00002940: 6e65 6e74 732e 0a20 2020 2020 2020 2072  nents..        r
-00002950: 7800 0000 7a24 506f 6c79 6e6f 6d69 616c  x...z$Polynomial
-00002960: 2061 7070 726f 7869 6d61 7469 6f6e 206f   approximation o
-00002970: 6620 6d65 7468 6f64 2027 7a2f 2720 6361  f method 'z/' ca
-00002980: 6e20 6e6f 7420 6265 2066 6f75 6e64 2069  n not be found i
-00002990: 6e20 6f75 7470 7574 2064 6963 7420 2773  n output dict 's
-000029a0: 656c 662e 5f66 6c6f 7727 2e29 0572 4600  elf._flow'.).rF.
-000029b0: 0000 720f 0000 0072 4700 0000 724b 0000  ..r....rG...rK..
-000029c0: 00da 0c52 756e 7469 6d65 4572 726f 7272  ...RuntimeErrorr
-000029d0: 7a00 0000 7214 0000 0072 1400 0000 7215  z...r....r....r.
-000029e0: 0000 00da 115f 6361 6c63 506f 6c79 4672  ....._calcPolyFr
-000029f0: 6f6d 466c 6f77 2901 0000 7308 0000 0010  omFlow)...s.....
-00002a00: 050c 0108 0112 027a 1d6c 6965 6f70 6572  .......z.lieoper
-00002a10: 6174 6f72 2e5f 6361 6c63 506f 6c79 4672  ator._calcPolyFr
-00002a20: 6f6d 466c 6f77 2901 da05 6f75 746c 3163  omFlow)...outl1c
-00002a30: 0100 0000 0000 0000 0100 0000 0500 0000  ................
-00002a40: 0400 0000 0f00 0000 7386 0000 0074 0088  ........s....t..
-00002a50: 0064 0119 0074 0183 0272 3674 0287 0066  .d...t...r6t...f
-00002a60: 0164 0264 0384 0888 0044 0083 0183 0173  .d.d.....D.....s
-00002a70: 164a 0064 0483 0182 017c 006a 0364 0864  .J.d.....|.j.d.d
-00002a80: 0588 0069 017c 03a4 018e 0101 007c 006a  ...i.|.......|.j
-00002a90: 0464 0869 007c 03a4 018e 017d 0474 057c  .d.i.|.....}.t.|
-00002aa0: 0483 0164 066b 0272 347c 0173 347c 0464  ...d.k.r4|.s4|.d
-00002ab0: 0119 007d 047c 0453 007c 006a 0364 0869  ...}.|.S.|.j.d.i
-00002ac0: 007c 03a4 018e 0101 007c 006a 0688 008e  .|.......|.j....
-00002ad0: 0053 0029 0961 6504 0000 0a20 2020 2020  .S.).ae....     
-00002ae0: 2020 2043 6f6d 7075 7465 2074 6865 2072     Compute the r
-00002af0: 6573 756c 7420 6f66 2074 6865 2063 7572  esult of the cur
-00002b00: 7265 6e74 204c 6965 206f 7065 7261 746f  rent Lie operato
-00002b10: 7220 6728 3a78 3a29 2c20 6170 706c 6965  r g(:x:), applie
-00002b20: 6420 746f 2065 6974 6865 7220 0a20 2020  d to either .   
-00002b30: 2020 2020 2031 2920 6120 7370 6563 6966       1) a specif
-00002b40: 6963 2070 6f69 6e74 0a20 2020 2020 2020  ic point.       
-00002b50: 2032 2920 616e 6f74 6865 7220 4c69 6520   2) another Lie 
-00002b60: 706f 6c79 6e6f 6d69 616c 0a20 2020 2020  polynomial.     
-00002b70: 2020 200a 2020 2020 2020 2020 5061 7261     .        Para
-00002b80: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-00002b90: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00002ba0: 2020 7a3a 2073 7562 7363 7269 7074 6162    z: subscriptab
-00002bb0: 6c65 206f 7220 706f 6c79 206f 7220 6c69  le or poly or li
-00002bc0: 656f 7065 7261 746f 720a 2020 2020 2020  eoperator.      
-00002bd0: 2020 2020 2020 0a20 2020 2020 2020 206f        .        o
-00002be0: 7574 6c31 3a20 626f 6f6c 6561 6e2c 206f  utl1: boolean, o
-00002bf0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-00002c00: 2020 2020 4465 7465 726d 696e 6520 7468      Determine th
-00002c10: 6520 6f75 7470 7574 2066 6f72 6d61 7420  e output format 
-00002c20: 696e 2063 6173 6520 7468 6520 6f75 7470  in case the outp
-00002c30: 7574 2077 6f75 6c64 2062 6520 6120 7369  ut would be a si
-00002c40: 6e67 6c65 204c 6965 2070 6f6c 796e 6f6d  ngle Lie polynom
-00002c50: 6961 6c2e 0a20 2020 2020 2020 2020 2020  ial..           
-00002c60: 2054 6865 2064 6566 6175 6c74 2062 6568   The default beh
-00002c70: 6176 696f 7220 6973 2074 6f20 7265 7475  avior is to retu
-00002c80: 726e 2061 2073 696e 676c 6520 656c 656d  rn a single elem
-00002c90: 656e 742e 2049 6620 6120 6c69 7374 206f  ent. If a list o
-00002ca0: 6620 6c65 6e67 7468 2031 2073 686f 756c  f length 1 shoul
-00002cb0: 6420 6265 2072 6574 7572 6e65 640a 2020  d be returned.  
-00002cc0: 2020 2020 2020 2020 2020 696e 7374 6561            instea
-00002cd0: 642c 2063 6861 6e67 6520 7468 6973 2070  d, change this p
-00002ce0: 6172 616d 6574 6572 2074 6f20 5472 7565  arameter to True
-00002cf0: 2e0a 2020 2020 2020 2020 2020 2020 0a20  ..            . 
-00002d00: 2020 2020 2020 202a 2a6b 7761 7267 730a         **kwargs.
-00002d10: 2020 2020 2020 2020 2020 2020 4f70 7469              Opti
-00002d20: 6f6e 616c 2061 7267 756d 656e 7473 2070  onal arguments p
-00002d30: 6173 7365 6420 746f 2073 656c 662e 6361  assed to self.ca
-00002d40: 6c63 466c 6f77 2e20 4e6f 7465 2074 6861  lcFlow. Note tha
-00002d50: 7420 6966 2061 6e20 6164 6469 7469 6f6e  t if an addition
-00002d60: 616c 2070 6172 616d 6574 6572 2074 2069  al parameter t i
-00002d70: 7320 7061 7373 6564 2c20 0a20 2020 2020  s passed, .     
-00002d80: 2020 2020 2020 2074 6865 6e20 7468 6520         then the 
-00002d90: 7265 7370 6563 7469 7665 2072 6573 756c  respective resul
-00002da0: 7473 2066 6f72 2067 2874 2a3a 783a 2920  ts for g(t*:x:) 
-00002db0: 6172 6520 6361 6c63 756c 6174 6564 2e0a  are calculated..
-00002dc0: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-00002dd0: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-00002de0: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-00002df0: 2020 2020 206c 6973 7420 6f72 2070 6f6c       list or pol
-00002e00: 7920 6f72 206c 6965 6f70 6572 6174 6f72  y or lieoperator
-00002e10: 0a20 2020 2020 2020 2020 2020 2031 2920  .            1) 
-00002e20: 4966 207a 2069 7320 6120 6c69 7374 2c20  If z is a list, 
-00002e30: 7468 656e 2074 6865 2076 616c 7565 7320  then the values 
-00002e40: 2867 283a 783a 2979 2928 7a29 2066 6f72  (g(:x:)y)(z) for
-00002e50: 2074 6865 2063 7572 7265 6e74 2070 6f6c   the current pol
-00002e60: 7920 656c 656d 656e 7473 2079 2069 6e20  y elements y in 
-00002e70: 7365 6c66 2e63 6f6d 706f 6e65 6e74 730a  self.components.
-00002e80: 2020 2020 2020 2020 2020 2020 6172 6520              are 
-00002e90: 7265 7475 726e 6564 2028 7365 6520 7365  returned (see se
-00002ea0: 6c66 2e65 7661 6c75 6174 6529 2e0a 2020  lf.evaluate)..  
-00002eb0: 2020 2020 2020 2020 2020 3229 2049 6620            2) If 
-00002ec0: 7a20 6973 2061 204c 6965 2070 6f6c 796e  z is a Lie polyn
-00002ed0: 6f6d 6961 6c2c 2074 6865 6e20 7468 6520  omial, then the 
-00002ee0: 6f72 6269 7420 6f66 2067 283a 783a 297a  orbit of g(:x:)z
-00002ef0: 2077 696c 6c20 6265 2063 6f6d 7075 7465   will be compute
-00002f00: 6420 616e 6420 7468 6520 666c 6f77 2072  d and the flow r
-00002f10: 6574 7572 6e65 6420 6173 200a 2020 2020  eturned as .    
-00002f20: 2020 2020 2020 2020 2020 2070 6f6c 7920             poly 
-00002f30: 636c 6173 732e 0a20 2020 2020 2020 2072  class..        r
-00002f40: 0100 0000 6301 0000 0000 0000 0000 0000  ....c...........
-00002f50: 0002 0000 0005 0000 0013 0000 0073 1c00  .............s..
-00002f60: 0000 6700 7c00 5d0a 7d01 7c01 6a00 8800  ..g.|.].}.|.j...
-00002f70: 6400 1900 6a00 6b02 9102 7102 5300 2901  d...j.k...q.S.).
-00002f80: 7201 0000 0029 0172 1f00 0000 2902 722b  r....).r....).r+
-00002f90: 0000 00da 0170 7275 0000 0072 1400 0000  .....pru...r....
-00002fa0: 7215 0000 0072 2f00 0000 5001 0000 7230  r....r/...P...r0
-00002fb0: 0000 007a 286c 6965 6f70 6572 6174 6f72  ...z(lieoperator
-00002fc0: 2e5f 5f63 616c 6c5f 5f2e 3c6c 6f63 616c  .__call__.<local
-00002fd0: 733e 2e3c 6c69 7374 636f 6d70 3e7a 2441  s>.<listcomp>z$A
-00002fe0: 7267 756d 656e 7473 2068 6176 6520 6469  rguments have di
-00002ff0: 6666 6572 656e 7420 6469 6d65 6e73 696f  fferent dimensio
-00003000: 6e73 2e72 5000 0000 7203 0000 004e 7214  ns.rP...r....Nr.
-00003010: 0000 0029 0772 2200 0000 720d 0000 00da  ...).r"...r.....
-00003020: 0361 6c6c 720c 0000 0072 7d00 0000 725b  .allr....r}...r[
-00003030: 0000 0072 6a00 0000 2905 7211 0000 0072  ...rj...).r....r
-00003040: 7e00 0000 7272 0000 0072 1300 0000 727b  ~...rr...r....r{
-00003050: 0000 0072 1400 0000 7275 0000 0072 1500  ...r....ru...r..
-00003060: 0000 7258 0000 0034 0100 0073 1200 0000  ..rX...4...s....
-00003070: 0e1b 1e01 1401 1001 1001 0801 0401 1002  ................
-00003080: 0a01 7a14 6c69 656f 7065 7261 746f 722e  ..z.lieoperator.
-00003090: 5f5f 6361 6c6c 5f5f 6302 0000 0000 0000  __call__c.......
-000030a0: 0000 0000 0002 0000 0004 0000 0043 0000  .............C..
-000030b0: 0073 2600 0000 7400 7c01 7401 8302 7209  .s&...t.|.t...r.
-000030c0: 7c00 7c01 8301 5300 7402 6401 7c01 6a03  |.|...S.t.d.|.j.
-000030d0: 6a04 9b00 6402 9d03 8301 8201 2903 4e7a  j...d.......).Nz
-000030e0: 124f 7065 7261 7469 6f6e 206f 6e20 7479  .Operation on ty
-000030f0: 7065 207a 0f20 6e6f 7420 7375 7070 6f72  pe z. not suppor
-00003100: 7465 642e 2905 7222 0000 0072 0d00 0000  ted.).r"...r....
-00003110: 725a 0000 00da 095f 5f63 6c61 7373 5f5f  rZ.....__class__
-00003120: 7227 0000 0072 2500 0000 7214 0000 0072  r'...r%...r....r
-00003130: 1400 0000 7215 0000 0072 2400 0000 5a01  ....r....r$...Z.
-00003140: 0000 7306 0000 000a 0108 0114 027a 166c  ..s..........z.l
-00003150: 6965 6f70 6572 6174 6f72 2e5f 5f6d 6174  ieoperator.__mat
-00003160: 6d75 6c5f 5f63 0100 0000 0000 0000 0000  mul__c..........
-00003170: 0000 0200 0000 0500 0000 4300 0000 7324  ..........C...s$
-00003180: 0000 007c 00a0 007c 006a 01a1 017d 017c  ...|...|.j...}.|
-00003190: 016a 02a0 0374 04a0 057c 006a 02a1 01a1  .j...t...|.j....
-000031a0: 0101 007c 0153 0029 017a a80a 2020 2020  ...|.S.).z..    
-000031b0: 2020 2020 4372 6561 7465 2061 2063 6f70      Create a cop
-000031c0: 7920 6f66 2074 6865 2063 7572 7265 6e74  y of the current
-000031d0: 204c 6965 206f 7065 7261 746f 720a 2020   Lie operator.  
-000031e0: 2020 2020 2020 0a20 2020 2020 2020 2052        .        R
-000031f0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-00003200: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206c  ------.        l
-00003210: 6965 6f70 6572 6174 6f72 0a20 2020 2020  ieoperator.     
-00003220: 2020 2020 2020 2041 2063 6f70 7920 6f66         A copy of
-00003230: 2074 6865 2063 7572 7265 6e74 204c 6965   the current Lie
-00003240: 206f 7065 7261 746f 722e 0a20 2020 2020   operator..     
-00003250: 2020 2029 0672 8100 0000 724e 0000 00da     ).r....rN....
-00003260: 085f 5f64 6963 745f 5f72 6500 0000 7248  .__dict__re...rH
-00003270: 0000 00da 0864 6565 7063 6f70 7929 0272  .....deepcopy).r
-00003280: 1100 0000 da03 6f75 7472 1400 0000 7214  ......outr....r.
-00003290: 0000 0072 1500 0000 7248 0000 0060 0100  ...r....rH...`..
-000032a0: 0073 0600 0000 0c09 1401 0401 7a10 6c69  .s..........z.li
-000032b0: 656f 7065 7261 746f 722e 636f 7079 6301  eoperator.copyc.
-000032c0: 0000 0000 0000 0000 0000 0004 0000 0006  ................
-000032d0: 0000 004f 0000 0073 be00 0000 7400 7c00  ...O...s....t.|.
-000032e0: 6401 8302 7317 7a0a 7c00 6a01 640d 6900  d...s.z.|.j.d.i.
-000032f0: 7c02 a401 8e01 0100 5700 6e07 0100 0100  |.......W.n.....
-00003300: 0100 7402 6402 8301 8201 6403 7c02 a003  ..t.d.....d.|...
-00003310: a100 7600 7222 7c02 6403 1900 7d03 6e2c  ..v.r"|.d...}.n,
-00003320: 7c00 6a04 a005 a100 6404 6b01 722c 6405  |.j.....d.k.r,d.
-00003330: 7d03 6e22 7c02 a006 6406 6407 a102 7237  }.n"|...d.d...r7
-00003340: 7407 a008 6408 a101 0100 7c00 6a04 6a09  t...d.....|.j.j.
-00003350: 740a 6a0b 6b00 7348 4a00 6409 7c00 6a0c  t.j.k.sHJ.d.|.j.
-00003360: 6a0d 9b00 640a 9d03 8301 8201 7c00 6a04  j...d.......|.j.
-00003370: 6a09 6405 1700 7d03 7c03 7c02 6403 3c00  j.d...}.|.|.d.<.
-00003380: 740e 6a0f 6a10 6a11 7c00 6601 640b 7c01  t.j.j.j.|.f.d.|.
-00003390: 6901 7c02 a401 8e01 5300 290e 6184 0100  i.|.....S.).a...
-000033a0: 000a 2020 2020 2020 2020 5061 7373 206e  ..        Pass n
-000033b0: 2d6a 6574 7320 7468 726f 7567 6820 7468  -jets through th
-000033c0: 6520 666c 6f77 2066 756e 6374 696f 6e2c  e flow function,
-000033d0: 2067 6976 656e 2062 7920 7468 6520 6375   given by the cu
-000033e0: 7272 656e 7420 4c69 6520 6f70 6572 6174  rrent Lie operat
-000033f0: 6f72 2e0a 2020 2020 2020 2020 0a20 2020  or..        .   
-00003400: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-00003410: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00003420: 2d2d 0a20 2020 2020 2020 202a 706f 7369  --.        *posi
-00003430: 7469 6f6e 3a20 666c 6f61 7420 6f72 2061  tion: float or a
-00003440: 7272 6179 2c20 6f70 7469 6f6e 616c 0a20  rray, optional. 
-00003450: 2020 2020 2020 2020 2020 2041 6e20 6f70             An op
-00003460: 7469 6f6e 616c 2070 6f69 6e74 206f 6620  tional point of 
-00003470: 7265 6665 7265 6e63 652e 2042 7920 6465  reference. By de
-00003480: 6661 756c 7420 7468 6520 706f 7369 7469  fault the positi
-00003490: 6f6e 2077 696c 6c20 6265 2074 6865 206f  on will be the o
-000034a0: 7269 6769 6e2e 0a20 2020 2020 2020 2020  rigin..         
-000034b0: 2020 2020 2020 2020 2020 200a 2020 2020             .    
-000034c0: 2020 2020 6f72 6465 723a 2069 6e74 2c20      order: int, 
-000034d0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-000034e0: 2020 2020 2054 6865 206e 756d 6265 7220       The number 
-000034f0: 6f66 2064 6572 6976 6174 6976 6573 2077  of derivatives w
-00003500: 6520 7761 6e74 2074 6f20 7461 6b65 2069  e want to take i
-00003510: 6e74 6f20 6163 636f 756e 742e 0a20 2020  nto account..   
-00003520: 2020 2020 2072 6a00 0000 7a1e 466c 6f77       rj...z.Flow
-00003530: 2068 6173 2074 6f20 6265 2063 6f6d 7075   has to be compu
-00003540: 7465 6420 6669 7273 742e 7217 0000 0072  ted first.r....r
-00003550: 1800 0000 7203 0000 00da 0477 6172 6e46  ....r......warnF
-00003560: 7a56 4e6f 206f 7264 6572 2070 726f 7669  zVNo order provi
-00003570: 6465 6420 666f 7220 5450 5341 2063 616c  ded for TPSA cal
-00003580: 6375 6c61 7469 6f6e 2e20 4174 7465 6d70  culation. Attemp
-00003590: 7469 6e67 2074 6f20 7365 7420 6f72 6465  ting to set orde
-000035a0: 7220 6261 7365 6420 6f6e 206d 6178 5f70  r based on max_p
-000035b0: 6f77 6572 202e 2e2e 7a0d 6d61 785f 706f  ower ...z.max_po
-000035c0: 7765 7220 6f66 207a 1e2e 6172 6775 6d65  wer of z..argume
-000035d0: 6e74 2063 616e 206e 6f74 2062 6520 696e  nt can not be in
-000035e0: 6669 6e69 7465 2eda 0870 6f73 6974 696f  finite...positio
-000035f0: 6e4e 7214 0000 0029 1272 5900 0000 720c  nNr....).rY...r.
-00003600: 0000 0072 7c00 0000 724b 0000 0072 4e00  ...r|...rK...rN.
-00003610: 0000 da06 6d61 7864 6567 720f 0000 00da  ....maxdegr.....
-00003620: 0877 6172 6e69 6e67 7372 8500 0000 720e  .warningsr....r.
-00003630: 0000 0072 3600 0000 da03 696e 6672 8100  ...r6.....infr..
-00003640: 0000 7227 0000 0072 1b00 0000 721c 0000  ..r'...r....r...
-00003650: 00da 0574 6f6f 6c73 da04 7470 7361 2904  ...tools..tpsa).
-00003660: 7211 0000 0072 8600 0000 7213 0000 0072  r....r....r....r
-00003670: 1700 0000 7214 0000 0072 1400 0000 7215  ....r....r....r.
-00003680: 0000 0072 8b00 0000 6d01 0000 731e 0000  ...r....m...s...
-00003690: 000a 0c02 0114 0106 0108 010c 030a 010e  ................
-000036a0: 0106 010c 020a 0122 010c 0108 011a 037a  .......".......z
-000036b0: 106c 6965 6f70 6572 6174 6f72 2e74 7073  .lieoperator.tps
-000036c0: 614e a901 4629 1372 2700 0000 7228 0000  aN..F).r'...r(..
-000036d0: 0072 2900 0000 da07 5f5f 646f 635f 5f72  .r).....__doc__r
-000036e0: 4f00 0000 724a 0000 0072 5200 0000 7255  O...rJ...rR...rU
-000036f0: 0000 0072 5600 0000 724c 0000 0072 6900  ...rV...rL...ri.
-00003700: 0000 720c 0000 0072 6b00 0000 726c 0000  ..r....rk...rl..
-00003710: 0072 7d00 0000 7258 0000 0072 2400 0000  .r}...rX...r$...
-00003720: 7248 0000 0072 8b00 0000 7214 0000 0072  rH...r....r....r
-00003730: 1400 0000 7214 0000 0072 1500 0000 7223  ....r....r....r#
-00003740: 0000 0095 0000 0073 2200 0000 0800 0401  .......s".......
-00003750: 080b 080c 0805 0806 080b 0806 0a18 0820  ............... 
-00003760: 0817 0809 0808 0e0b 0826 0806 0c0d 7223  .........&....r#
-00003770: 0000 0063 0000 0000 0000 0000 0000 0000  ...c............
-00003780: 0000 0000 0400 0000 4000 0000 7398 0000  ........@...s...
-00003790: 0065 005a 0164 005a 0264 0164 0284 005a  .e.Z.d.Z.d.d...Z
-000037a0: 0364 0364 0484 005a 0464 0564 0684 005a  .d.d...Z.d.d...Z
-000037b0: 0564 0764 0884 005a 0664 0964 0a84 005a  .d.d...Z.d.d...Z
-000037c0: 0764 0b64 0c84 005a 0864 2564 0e64 0f84  .d.d...Z.d%d.d..
-000037d0: 015a 0964 1064 1184 005a 0a64 2564 1264  .Z.d.d...Z.d%d.d
-000037e0: 1384 015a 0b64 1464 1584 005a 0c64 1664  ...Z.d.d...Z.d.d
-000037f0: 1784 005a 0d64 2664 1965 0e66 0264 1a64  ...Z.d&d.e.f.d.d
-00003800: 1b84 055a 0f64 1c64 1d84 005a 1064 1e64  ...Z.d.d...Z.d.d
-00003810: 1f84 005a 1164 2064 2184 005a 1264 2264  ...Z.d d!..Z.d"d
-00003820: 2384 005a 1364 2453 0029 2772 1000 0000  #..Z.d$S.)'r....
-00003830: 6302 0000 0000 0000 0000 0000 0004 0000  c...............
-00003840: 0004 0000 004f 0000 0073 4000 0000 6401  .....O...s@...d.
-00003850: 7c00 5f00 6402 7c03 a001 a100 7600 7210  |._.d.|.....v.r.
-00003860: 7c00 a002 7c03 6402 1900 a101 0100 7403  |...|.d.......t.
-00003870: 6a04 7c00 6701 7c02 a201 5200 6403 7c01  j.|.g.|...R.d.|.
-00003880: 6901 7c03 a401 8e01 0100 6404 5300 2905  i.|.......d.S.).
-00003890: 611f 0100 000a 2020 2020 2020 2020 436c  a.....        Cl
-000038a0: 6173 7320 746f 2064 6573 6372 6962 6520  ass to describe 
-000038b0: 4c69 6520 6f70 6572 6174 6f72 7320 6f66  Lie operators of
-000038c0: 2074 6865 2066 6f72 6d0a 2020 2020 2020   the form.      
-000038d0: 2020 2020 6578 7028 3a78 3a29 2c0a 2020      exp(:x:),.  
-000038e0: 2020 2020 2020 7768 6572 6520 3a78 3a20        where :x: 
-000038f0: 6973 2061 2070 6f6c 7920 636c 6173 732e  is a poly class.
-00003900: 0a0a 2020 2020 2020 2020 496e 2063 6f6e  ..        In con
-00003910: 7472 6173 7420 746f 2061 2067 656e 6572  trast to a gener
-00003920: 616c 204c 6965 206f 7065 7261 746f 722c  al Lie operator,
-00003930: 2077 6520 6e6f 7720 6861 7665 2074 6865   we now have the
-00003940: 2061 6464 6974 696f 6e61 6c20 706f 7373   additional poss
-00003950: 6962 696c 6974 7920 746f 2063 6f6d 6269  ibility to combi
-00003960: 6e65 2073 6576 6572 616c 206f 6620 7468  ne several of th
-00003970: 6573 6520 6f70 6572 6174 6f72 7320 7573  ese operators us
-00003980: 696e 6720 7468 6520 6c69 656f 7073 2e63  ing the lieops.c
-00003990: 6f72 652e 636f 6d62 696e 652e 6d61 676e  ore.combine.magn
-000039a0: 7573 2072 6f75 7469 6e65 2e0a 2020 2020  us routine..    
-000039b0: 2020 2020 e906 0000 0072 1900 0000 724e      .....r....rN
-000039c0: 0000 004e 2905 da12 5f62 6368 5f6f 7264  ...N)..._bch_ord
-000039d0: 6572 5f64 6566 6175 6c74 724b 0000 0072  er_defaultrK...r
-000039e0: 4c00 0000 7223 0000 0072 4f00 0000 2904  L...r#...rO...).
-000039f0: 7211 0000 0072 4e00 0000 7212 0000 0072  r....rN...r....r
-00003a00: 1300 0000 7214 0000 0072 1400 0000 7215  ....r....r....r.
-00003a10: 0000 0072 4f00 0000 9101 0000 7308 0000  ...rO.......s...
-00003a20: 0006 080c 010e 0120 017a 0d6c 6578 702e  ....... .z.lexp.
-00003a30: 5f5f 696e 6974 5f5f 6302 0000 0000 0000  __init__c.......
-00003a40: 0000 0000 0004 0000 0006 0000 004b 0000  .............K..
-00003a50: 0073 a000 0000 7400 7c01 7401 8302 7212  .s....t.|.t...r.
-00003a60: 7402 6a03 7c00 6601 6401 7c01 6901 7c02  t.j.|.f.d.|.i.|.
-00003a70: a401 8e01 0100 6400 5300 7404 7c01 6402  ......d.S.t.|.d.
-00003a80: 8302 7246 7405 a006 6403 a101 0100 6404  ..rFt...d.....d.
-00003a90: 7c02 a007 a100 7600 7326 4a00 6405 8301  |.....v.s&J.d...
-00003aa0: 8201 7c02 6404 1900 7c00 5f08 7409 7c01  ..|.d...|._.t.|.
-00003ab0: 6601 6900 7c02 a401 8e01 5c02 7d03 7c00  f.i.|.....\.}.|.
-00003ac0: 5f0a 7402 6a03 7c00 7401 640a 6406 7c03  _.t.j.|.t.d.d.|.
-00003ad0: 6901 7c02 a401 8e01 6407 8d02 0100 6400  i.|.....d.....d.
-00003ae0: 5300 740b 6408 7c01 6a0c 6a0d 9b00 6409  S.t.d.|.j.j...d.
-00003af0: 9d03 8301 8201 290b 4e72 4e00 0000 7258  ......).NrN...rX
-00003b00: 0000 007a 2d4c 6965 206f 7065 7261 746f  ...z-Lie operato
-00003b10: 7220 7769 7468 2067 656e 6572 616c 2063  r with general c
-00003b20: 616c 6c61 626c 6520 696e 6974 6961 7465  allable initiate
-00003b30: 642e 7217 0000 007a 514c 6965 206f 7065  d.r....zQLie ope
-00003b40: 7261 746f 7220 696e 6974 6961 7465 6420  rator initiated 
-00003b50: 7769 7468 2067 656e 6572 616c 2063 616c  with general cal
-00003b60: 6c61 626c 6520 7265 7175 6972 6573 2027  lable requires '
-00003b70: 6f72 6465 7227 2061 7267 756d 656e 7420  order' argument 
-00003b80: 746f 2062 6520 7365 742e 7233 0000 00a9  to be set.r3....
-00003b90: 0172 4e00 0000 7a12 4172 6775 6d65 6e74  .rN...z.Argument
-00003ba0: 206f 6620 7479 7065 2027 7a10 2720 6e6f   of type 'z.' no
-00003bb0: 7420 7375 7070 6f72 7465 642e 7214 0000  t supported.r...
-00003bc0: 0029 0e72 2200 0000 720d 0000 0072 2300  .).r"...r....r#.
-00003bd0: 0000 724a 0000 0072 5900 0000 7288 0000  ..rJ...rY...r...
-00003be0: 0072 8500 0000 724b 0000 0072 1700 0000  .r....rK...r....
-00003bf0: 7202 0000 00da 066e 6664 6963 74da 0954  r......nfdict..T
-00003c00: 7970 6545 7272 6f72 7281 0000 0072 2700  ypeErrorr....r'.
-00003c10: 0000 2904 7211 0000 00da 0148 7213 0000  ..).r......Hr...
-00003c20: 00da 0d74 6179 6c6f 725f 636f 6566 6673  ...taylor_coeffs
-00003c30: 7214 0000 0072 1400 0000 7215 0000 0072  r....r....r....r
-00003c40: 4a00 0000 9e01 0000 7312 0000 000a 011a  J.......s.......
-00003c50: 010a 010a 0114 010a 0116 0220 0114 027a  ........... ...z
-00003c60: 116c 6578 702e 7365 745f 6172 6775 6d65  .lexp.set_argume
-00003c70: 6e74 6302 0000 0000 0000 0000 0000 0003  ntc.............
-00003c80: 0000 0005 0000 004b 0000 0073 1e00 0000  .......K...s....
-00003c90: 7400 6a01 7c00 6601 6401 7402 7c01 8301  t.j.|.f.d.t.|...
-00003ca0: 6901 7c02 a401 8e01 0100 6400 5300 2902  i.|.......d.S.).
-00003cb0: 4e72 4400 0000 2903 7223 0000 0072 4c00  NrD...).r#...rL.
-00003cc0: 0000 7204 0000 0029 0372 1100 0000 7219  ..r....).r....r.
-00003cd0: 0000 0072 1300 0000 7214 0000 0072 1400  ...r....r....r..
-00003ce0: 0000 7215 0000 0072 4c00 0000 ab01 0000  ..r....rL.......
-00003cf0: 7302 0000 001e 017a 126c 6578 702e 7365  s......z.lexp.se
-00003d00: 745f 6765 6e65 7261 746f 7263 0100 0000  t_generatorc....
-00003d10: 0000 0000 0000 0000 0700 0000 0500 0000  ................
-00003d20: 4f00 0000 73a2 0000 0074 007c 0074 017c  O...s....t.|.t.|
-00003d30: 0164 0119 0083 0183 0273 0b4a 0082 017c  .d.......s.J...|
-00003d40: 02a0 0264 027c 006a 03a1 027d 037c 02a0  ...d.|.j...}.|..
-00003d50: 0264 0364 04a1 027d 0374 047c 006a 0567  .d.d...}.t.|.j.g
-00003d60: 0164 0564 0684 007c 0144 0083 01a2 0152  .d.d...|.D.....R
-00003d70: 0069 007c 02a4 018e 015c 037d 047d 037d  .i.|.....\.}.}.}
-00003d80: 0374 067c 0483 0164 016b 0472 3974 077c  .t.|...d.k.r9t.|
-00003d90: 04a0 08a1 0083 017d 056e 0374 0983 007d  .......}.n.t...}
-00003da0: 0569 007d 0674 0a7c 0064 0783 0272 4864  .i.}.t.|.d...rHd
-00003db0: 077c 006a 0b69 017d 067c 006a 0c7c 0566  .|.j.i.}.|.j.|.f
-00003dc0: 0169 007c 06a4 018e 0153 0029 0861 9303  .i.|.....S.).a..
-00003dd0: 0000 0a20 2020 2020 2020 2043 6f6d 7075  ...        Compu
-00003de0: 7465 2074 6865 2063 6f6d 706f 7369 7469  te the compositi
-00003df0: 6f6e 206f 6620 7468 6520 6375 7272 656e  on of the curren
-00003e00: 7420 4c69 6520 6f70 6572 6174 6f72 2065  t Lie operator e
-00003e10: 7870 283a 783a 2920 7769 7468 206f 7468  xp(:x:) with oth
-00003e20: 6572 206f 6e65 7320 6578 7028 3a79 5f31  er ones exp(:y_1
-00003e30: 3a29 2c0a 2020 2020 2020 2020 2e2e 2e2c  :),.        ...,
-00003e40: 2065 7870 283a 795f 4e3a 290a 2020 2020   exp(:y_N:).    
-00003e50: 2020 2020 746f 2072 6574 7572 6e20 7468      to return th
-00003e60: 6520 4c69 6520 6f70 6572 6174 6f72 2065  e Lie operator e
-00003e70: 7870 283a 7a3a 2920 6769 7665 6e20 6173  xp(:z:) given as
-00003e80: 0a20 2020 2020 2020 2020 2020 6578 7028  .           exp(
-00003e90: 3a7a 3a29 203d 2065 7870 283a 783a 2920  :z:) = exp(:x:) 
-00003ea0: 6578 7028 3a79 5f31 3a29 2065 7870 283a  exp(:y_1:) exp(:
-00003eb0: 795f 323a 2920 2e2e 2e20 6578 7028 3a79  y_2:) ... exp(:y
-00003ec0: 5f4e 3a29 2e0a 2020 2020 2020 2020 2020  _N:)..          
-00003ed0: 200a 2020 2020 2020 2020 5061 7261 6d65   .        Parame
-00003ee0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-00003ef0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00003f00: 7a3a 206c 6965 6f70 6572 6174 6f72 730a  z: lieoperators.
-00003f10: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00003f20: 4c69 6520 6f70 6572 6174 6f72 7320 7a20  Lie operators z 
-00003f30: 3d20 6578 7028 3a79 3a29 2074 6f20 6265  = exp(:y:) to be
-00003f40: 2063 6f6d 706f 7365 6420 7769 7468 2074   composed with t
-00003f50: 6865 2063 7572 7265 6e74 204c 6965 206f  he current Lie o
-00003f60: 7065 7261 746f 7220 6672 6f6d 2074 6865  perator from the
-00003f70: 2072 6967 6874 2e0a 2020 2020 2020 2020   right..        
-00003f80: 2020 2020 0a20 2020 2020 2020 206f 7264      .        ord
-00003f90: 6572 3a20 696e 742c 206f 7074 696f 6e61  er: int, optiona
-00003fa0: 6c0a 2020 2020 2020 2020 2020 2020 5468  l.            Th
-00003fb0: 6520 6f72 6465 7220 696e 2074 6865 2069  e order in the i
-00003fc0: 6e74 6567 7261 7469 6f6e 2076 6172 6961  ntegration varia
-00003fd0: 626c 652c 2074 6f20 636f 6e74 726f 6c20  ble, to control 
-00003fe0: 7468 6520 6465 6772 6565 206f 6620 6163  the degree of ac
-00003ff0: 6375 7261 6379 206f 6620 7468 6520 7265  curacy of the re
-00004000: 7375 6c74 2e0a 2020 2020 2020 2020 2020  sult..          
-00004010: 2020 5365 6520 616c 736f 206c 6965 2e63    See also lie.c
-00004020: 6f72 652e 636f 6d62 696e 652e 6d61 676e  ore.combine.magn
-00004030: 7573 2072 6f75 7469 6e65 2e20 4966 206e  us routine. If n
-00004040: 6f74 6869 6e67 2073 7065 6369 6669 6564  othing specified
-00004050: 2c20 7365 6c66 2e5f 6263 685f 6f72 6465  , self._bch_orde
-00004060: 725f 6465 6661 756c 7420 7769 6c6c 2062  r_default will b
-00004070: 6520 7573 6564 2e0a 2020 2020 2020 2020  e used..        
-00004080: 2020 2020 0a20 2020 2020 2020 202a 2a6b      .        **k
-00004090: 7761 7267 730a 2020 2020 2020 2020 2020  wargs.          
-000040a0: 2020 4164 6469 7469 6f6e 616c 2070 6172    Additional par
-000040b0: 616d 6574 6572 7320 7365 6e74 2074 6f20  ameters sent to 
-000040c0: 6c69 652e 636f 7265 2e63 6f6d 6269 6e65  lie.core.combine
-000040d0: 2e6d 6167 6e75 7320 726f 7574 696e 652e  .magnus routine.
-000040e0: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
-000040f0: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
-00004100: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-00004110: 2020 2020 2020 6c69 656f 7065 7261 746f        lieoperato
-00004120: 720a 2020 2020 2020 2020 2020 2020 5468  r.            Th
-00004130: 6520 7265 7375 6c74 696e 6720 4c69 6520  e resulting Lie 
-00004140: 6f70 6572 6174 6f72 206f 6620 7468 6520  operator of the 
-00004150: 636f 6d70 6f73 6974 696f 6e2e 0a20 2020  composition..   
-00004160: 2020 2020 2072 0100 0000 7217 0000 00da       r....r.....
-00004170: 0c64 6973 6162 6c65 5f74 7164 6d54 6301  .disable_tqdmTc.
-00004180: 0000 0000 0000 0000 0000 0002 0000 0003  ................
-00004190: 0000 0053 0000 0073 1200 0000 6700 7c00  ...S...s....g.|.
-000041a0: 5d05 7d01 7c01 6a00 9102 7102 5300 7214  ].}.|.j...q.S.r.
-000041b0: 0000 0072 9000 0000 2902 722b 0000 0072  ...r....).r+...r
-000041c0: 2600 0000 7214 0000 0072 1400 0000 7215  &...r....r....r.
-000041d0: 0000 0072 2f00 0000 c901 0000 f302 0000  ...r/...........
-000041e0: 0012 007a 1c6c 6578 702e 6263 682e 3c6c  ...z.lexp.bch.<l
-000041f0: 6f63 616c 733e 2e3c 6c69 7374 636f 6d70  ocals>.<listcomp
-00004200: 3e72 1900 0000 290d 7222 0000 00da 0474  >r....).r".....t
-00004210: 7970 6572 5300 0000 728f 0000 0072 0500  yperS...r....r..
-00004220: 0000 724e 0000 0072 5b00 0000 da03 7375  ..rN...r[.....su
-00004230: 6d72 3300 0000 720d 0000 0072 5900 0000  mr3...r....rY...
-00004240: 7219 0000 0072 8100 0000 2907 7211 0000  r....r....).r...
-00004250: 0072 7200 0000 7213 0000 0072 5400 0000  .rr...r....rT...
-00004260: da04 636f 6d62 da04 6f75 7470 da0b 6f75  ..comb..outp..ou
-00004270: 7470 5f6b 7761 7267 7372 1400 0000 7214  tp_kwargsr....r.
-00004280: 0000 0072 1500 0000 da03 6263 68ae 0100  ...r......bch...
-00004290: 0073 1600 0000 1618 0e01 0c01 2801 0c01  .s..........(...
-000042a0: 0e01 0602 0402 0a01 0a01 1201 7a08 6c65  ............z.le
-000042b0: 7870 2e62 6368 6302 0000 0000 0000 0000  xp.bchc.........
-000042c0: 0000 0002 0000 0004 0000 0043 0000 0073  ...........C...s
-000042d0: 2400 0000 7400 7c00 7401 7c01 8301 8302  $...t.|.t.|.....
-000042e0: 720c 7c00 a002 7c01 a101 5300 7403 a004  r.|...|...S.t...
-000042f0: 7c00 7c01 a102 5300 7221 0000 0029 0572  |.|...S.r!...).r
-00004300: 2200 0000 7297 0000 0072 9c00 0000 7223  "...r....r....r#
-00004310: 0000 0072 2400 0000 7225 0000 0072 1400  ...r$...r%...r..
-00004320: 0000 7214 0000 0072 1500 0000 7224 0000  ..r....r....r$..
-00004330: 00d4 0100 0073 0600 0000 0e01 0a01 0c02  .....s..........
-00004340: 7a0f 6c65 7870 2e5f 5f6d 6174 6d75 6c5f  z.lexp.__matmul_
-00004350: 5f63 0200 0000 0000 0000 0000 0000 0300  _c..............
-00004360: 0000 0400 0000 4300 0000 7330 0000 0069  ......C...s0...i
-00004370: 007d 0274 007c 0064 0183 0272 0c64 017c  .}.t.|.d...r.d.|
-00004380: 006a 0169 017d 027c 006a 027c 006a 037c  .j.i.}.|.j.|.j.|
-00004390: 0114 0066 0169 007c 02a4 018e 0153 0029  ...f.i.|.....S.)
-000043a0: 024e 7219 0000 0029 0472 5900 0000 7219  .Nr....).rY...r.
-000043b0: 0000 0072 8100 0000 724e 0000 0029 0372  ...r....rN...).r
-000043c0: 1100 0000 7219 0000 0072 9b00 0000 7214  ....r....r....r.
-000043d0: 0000 0072 1400 0000 7215 0000 00da 075f  ...r....r......_
-000043e0: 5f70 6f77 5f5f da01 0000 7308 0000 0004  _pow__....s.....
-000043f0: 010a 010a 0118 017a 0c6c 6578 702e 5f5f  .......z.lexp.__
-00004400: 706f 775f 5f46 6302 0000 0000 0000 0000  pow__Fc.........
-00004410: 0000 0004 0000 0004 0000 004b 0000 0073  ...........K...s
-00004420: 3c00 0000 6401 7c02 a000 a100 7600 7213  <...d.|.....v.r.
-00004430: 7c00 a001 7c02 6401 1900 a101 0100 7c02  |...|.d.......|.
-00004440: a002 6402 6403 a102 7d03 7403 6a04 7c00  ..d.d...}.t.j.|.
-00004450: 6601 6404 7c01 6901 7c02 a401 8e01 5300  f.d.|.i.|.....S.
-00004460: 2905 4e72 1900 0000 725c 0000 0072 4300  ).Nr....r\...rC.
-00004470: 0000 7265 0000 0029 0572 4b00 0000 724c  ..re...).rK...rL
-00004480: 0000 0072 5300 0000 7223 0000 0072 6900  ...rS...r#...ri.
-00004490: 0000 2904 7211 0000 0072 6500 0000 7213  ..).r....re...r.
-000044a0: 0000 0072 5400 0000 7214 0000 0072 1400  ...rT...r....r..
-000044b0: 0000 7215 0000 0072 6900 0000 e001 0000  ..r....ri.......
-000044c0: 7308 0000 000c 010e 020c 0116 017a 1c6c  s............z.l
-000044d0: 6578 702e 5f75 7064 6174 655f 666c 6f77  exp._update_flow
-000044e0: 5f70 6172 616d 6574 6572 7363 0100 0000  _parametersc....
-000044f0: 0000 0000 0000 0000 0200 0000 0400 0000  ................
-00004500: 4b00 0000 738e 0000 007c 006a 0064 016b  K...s....|.j.d.k
-00004510: 0272 0f7c 006a 0164 0569 007c 01a4 018e  .r.|.j.d.i.|....
-00004520: 0101 0064 0053 007c 006a 0064 026b 0272  ...d.S.|.j.d.k.r
-00004530: 1e7c 006a 0264 0569 007c 01a4 018e 0101  .|.j.d.i.|......
-00004540: 0064 0053 007c 006a 0064 036b 0272 2d7c  .d.S.|.j.d.k.r-|
-00004550: 006a 0364 0569 007c 01a4 018e 0101 0064  .j.d.i.|.......d
-00004560: 0053 007c 006a 0064 046b 0272 3c7c 006a  .S.|.j.d.k.r<|.j
-00004570: 0464 0569 007c 01a4 018e 0101 0064 0053  .d.i.|.......d.S
-00004580: 0074 056a 067c 0066 0169 007c 01a4 018e  .t.j.|.f.i.|....
-00004590: 0101 0064 0053 0029 064e da05 3266 6c6f  ...d.S.).N..2flo
-000045a0: 7772 0900 0000 da04 6e6a 6574 720a 0000  wr......njetr...
-000045b0: 0072 1400 0000 2907 7247 0000 00da 0f5f  .r....).rG....._
-000045c0: 6361 6c63 466c 6f77 5f32 666c 6f77 da12  calcFlow_2flow..
-000045d0: 5f63 616c 6346 6c6f 775f 6368 616e 6e65  _calcFlow_channe
-000045e0: 6c6c da0e 5f63 616c 6346 6c6f 775f 6e6a  ll.._calcFlow_nj
-000045f0: 6574 da10 5f63 616c 6346 6c6f 775f 6865  et.._calcFlow_he
-00004600: 796f 6b61 7223 0000 0072 6b00 0000 a902  yokar#...rk.....
-00004610: 7211 0000 0072 1300 0000 7214 0000 0072  r....r....r....r
-00004620: 1400 0000 7215 0000 0072 6b00 0000 e701  ....r....rk.....
-00004630: 0000 7312 0000 000a 0114 010a 0114 010a  ..s.............
-00004640: 0114 010a 0114 0216 027a 1c6c 6578 702e  .........z.lexp.
-00004650: 5f63 616c 6346 6c6f 7746 726f 6d50 6172  _calcFlowFromPar
-00004660: 616d 6574 6572 7363 0200 0000 0000 0000  ametersc........
-00004670: 0000 0000 0700 0000 0500 0000 0b00 0000  ................
-00004680: 739e 0000 007c 0172 447c 02a0 0064 017c  s....|.rD|...d.|
-00004690: 006a 0164 0119 00a1 027d 0374 027c 006a  .j.d.....}.t.|.j
-000046a0: 036a 047c 006a 036a 0564 028d 027d 047c  .j.|.j.j.d...}.|
-000046b0: 02a0 0664 037c 006a 0164 0419 0064 0319  ...d.|.j.d...d..
-000046c0: 00a1 027d 0574 0764 0b7c 007c 0464 059c  ...}.t.d.|.|.d..
-000046d0: 027c 02a4 018e 0189 0187 0166 0164 0664  .|.........f.d.d
-000046e0: 0784 087c 0344 0083 0189 0087 0066 0164  ...|.D.......f.d
-000046f0: 0864 0984 087d 0688 0188 007c 0664 0a9c  .d...}.....|.d..
-00004700: 037c 006a 0864 043c 0064 0053 0074 096a  .|.j.d.<.d.S.t.j
-00004710: 0a7c 0066 0169 007c 02a4 018e 0101 0064  .|.f.i.|.......d
-00004720: 0053 0029 0c4e 7250 0000 00a9 0172 0e00  .S.).NrP.....r..
-00004730: 0000 7242 0000 0072 4300 0000 2902 7220  ..rB...rC...).r 
-00004740: 0000 0072 5000 0000 6301 0000 0000 0000  ...rP...c.......
-00004750: 0000 0000 0002 0000 0004 0000 0013 0000  ................
-00004760: 00f3 1400 0000 6700 7c00 5d06 7d01 7c01  ......g.|.].}.|.
-00004770: 8800 8e00 9102 7102 5300 7214 0000 0072  ......q.S.r....r
-00004780: 1400 0000 a902 722b 0000 00da 0163 a901  ......r+.....c..
-00004790: da06 7869 6574 6166 7214 0000 0072 1500  ..xietafr....r..
-000047a0: 0000 722f 0000 0000 0200 00f3 0200 0000  ..r/............
-000047b0: 1400 7a2d 6c65 7870 2e5f 6361 6c63 466c  ..z-lexp._calcFl
-000047c0: 6f77 5f62 7275 7465 666f 7263 652e 3c6c  ow_bruteforce.<l
-000047d0: 6f63 616c 733e 2e3c 6c69 7374 636f 6d70  ocals>.<listcomp
-000047e0: 3e63 0000 0000 0000 0000 0000 0000 0100  >c..............
-000047f0: 0000 0400 0000 1700 0000 726e 0000 0029  ..........rn...)
-00004800: 034e 6301 0000 0000 0000 0000 0000 0002  .Nc.............
-00004810: 0000 0004 0000 0013 0000 0072 6f00 0000  ...........ro...
-00004820: 7214 0000 0072 1400 0000 725f 0000 0072  r....r....r_...r
-00004830: 7000 0000 7214 0000 0072 1500 0000 722f  p...r....r....r/
-00004840: 0000 0001 0200 0072 7300 0000 7a3f 6c65  .......rs...z?le
-00004850: 7870 2e5f 6361 6c63 466c 6f77 5f62 7275  xp._calcFlow_bru
-00004860: 7465 666f 7263 652e 3c6c 6f63 616c 733e  teforce.<locals>
-00004870: 2e3c 6c61 6d62 6461 3e2e 3c6c 6f63 616c  .<lambda>.<local
-00004880: 733e 2e3c 6c69 7374 636f 6d70 3e72 7400  s>.<listcomp>rt.
-00004890: 0000 7275 0000 0072 7600 0000 7275 0000  ..ru...rv...ru..
-000048a0: 0072 1500 0000 7277 0000 0001 0200 0072  .r....rw.......r
-000048b0: 3000 0000 7a2b 6c65 7870 2e5f 6361 6c63  0...z+lexp._calc
-000048c0: 466c 6f77 5f62 7275 7465 666f 7263 652e  Flow_bruteforce.
-000048d0: 3c6c 6f63 616c 733e 2e3c 6c61 6d62 6461  <locals>.<lambda
-000048e0: 3e29 0372 aa00 0000 7278 0000 0072 6a00  >).r....rx...rj.
-000048f0: 0000 7214 0000 0029 0b72 6600 0000 7249  ..r....).rf...rI
-00004900: 0000 0072 4100 0000 724e 0000 0072 1f00  ...rA...rN...r..
-00004910: 0000 720e 0000 0072 5300 0000 7279 0000  ..r....rS...ry..
-00004920: 0072 4600 0000 7223 0000 0072 6c00 0000  .rF...r#...rl...
-00004930: 2907 7211 0000 00da 0870 756c 6c62 6163  ).r......pullbac
-00004940: 6b72 1300 0000 da14 7265 7175 6573 7465  kr......requeste
-00004950: 645f 636f 6d70 6f6e 656e 7473 da05 7869  d_components..xi
-00004960: 6574 6172 5400 0000 726a 0000 0072 1400  etarT...rj...r..
-00004970: 0000 2902 7271 0000 0072 aa00 0000 7215  ..).rq...r....r.
-00004980: 0000 0072 6c00 0000 f401 0000 7312 0000  ...rl.......s...
-00004990: 0004 0112 0714 0116 0114 0112 010c 0116  ................
-000049a0: 0116 027a 196c 6578 702e 5f63 616c 6346  ...z.lexp._calcF
-000049b0: 6c6f 775f 6272 7574 6566 6f72 6365 6301  low_bruteforcec.
-000049c0: 0000 0000 0000 0000 0000 0004 0000 0004  ................
-000049d0: 0000 004b 0000 0073 5c00 0000 7c01 a000  ...K...s\...|...
-000049e0: 7c00 6a01 6401 1900 a101 0100 7c01 a002  |.j.d.......|...
-000049f0: 6402 a101 7d02 7403 7c00 6a04 7c00 6a01  d...}.t.|.j.|.j.
-00004a00: 6401 1900 6402 1900 1400 6601 6900 7c01  d...d.....f.i.|.
-00004a10: a401 8e01 7d03 7c03 6a05 6405 6900 7c01  ....}.|.j.d.i.|.
-00004a20: a401 8e01 0100 6403 7c03 6901 7c00 6a06  ......d.|.i.|.j.
-00004a30: 6401 3c00 6404 5300 2906 7aa0 0a20 2020  d.<.d.S.).z..   
-00004a40: 2020 2020 2043 6f6d 7075 7465 2066 6c6f       Compute flo
-00004a50: 7720 7573 696e 6720 7468 6520 616c 676f  w using the algo
-00004a60: 7269 7468 6d20 6279 2050 2e20 4368 616e  rithm by P. Chan
-00004a70: 6e65 6c6c 2e0a 2020 2020 2020 2020 0a20  nell..        . 
-00004a80: 2020 2020 2020 2054 6869 7320 726f 7574         This rout
-00004a90: 696e 6520 6d61 7920 6e65 6564 2074 6f20  ine may need to 
-00004aa0: 7573 6520 6120 736c 6963 696e 6720 6f72  use a slicing or
-00004ab0: 2073 706c 6974 7469 6e67 2074 6f20 696d   splitting to im
-00004ac0: 7072 6f76 6520 6974 7320 6163 6375 7261  prove its accura
-00004ad0: 6379 2e0a 2020 2020 2020 2020 7209 0000  cy..        r...
-00004ae0: 0072 4200 0000 726a 0000 004e 7214 0000  .rB...rj...Nr...
-00004af0: 0029 0772 6500 0000 7249 0000 0072 6600  .).re...rI...rf.
-00004b00: 0000 7209 0000 0072 4e00 0000 da09 6361  ..r....rN.....ca
-00004b10: 6c63 466c 6f77 7372 4600 0000 2904 7211  lcFlowsrF...).r.
-00004b20: 0000 0072 1300 0000 7254 0000 0072 6a00  ...r....rT...rj.
-00004b30: 0000 7214 0000 0072 1400 0000 7215 0000  ..r....r....r...
-00004b40: 0072 a100 0000 0602 0000 730a 0000 0010  .r........s.....
-00004b50: 060a 0120 0110 0112 017a 176c 6578 702e  ... .....z.lexp.
-00004b60: 5f63 616c 6346 6c6f 775f 6368 616e 6e65  _calcFlow_channe
-00004b70: 6c6c 6301 0000 0000 0000 0000 0000 0003  llc.............
-00004b80: 0000 0006 0000 000b 0000 0073 6c00 0000  ...........sl...
-00004b90: 7400 7c00 6a01 7c00 6a02 6401 1900 6402  t.|.j.|.j.d...d.
-00004ba0: 1900 1400 7c01 a003 6403 6404 a102 6405  ....|...d.d...d.
-00004bb0: 8d02 8900 7404 7c00 6a01 6a05 7c00 6a01  ....t.|.j.j.|.j.
-00004bc0: 6a06 6406 8d02 7d02 8700 6601 6407 6408  j.d...}...f.d.d.
-00004bd0: 8408 7c02 4400 8301 8901 8701 6601 6409  ..|.D.......f.d.
-00004be0: 640a 8408 8900 7c02 8801 8800 640b 9c03  d.....|.....d...
-00004bf0: 7c00 6a07 6401 3c00 640c 5300 290d 6131  |.j.d.<.d.S.).a1
-00004c00: 0100 000a 2020 2020 2020 2020 436f 6d70  ....        Comp
-00004c10: 7574 6520 7468 6520 666c 6f77 2069 6e20  ute the flow in 
-00004c20: 6361 7365 2073 656c 662e 6172 6775 6d65  case self.argume
-00004c30: 6e74 2069 7320 6f66 206f 7264 6572 203c  nt is of order <
-00004c40: 3d20 322c 2062 7920 7573 696e 670a 2020  = 2, by using.  
-00004c50: 2020 2020 2020 616e 2065 7861 6374 2069        an exact i
-00004c60: 6e74 6567 7261 7469 6f6e 2c20 7365 6520  ntegration, see 
-00004c70: 6c69 656f 7073 2e73 6f6c 7665 722e 6765  lieops.solver.ge
-00004c80: 745f 3266 6c6f 772e 0a20 2020 2020 2020  t_2flow..       
-00004c90: 200a 2020 2020 2020 2020 5061 7261 6d65   .        Parame
-00004ca0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-00004cb0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00004cc0: 746f 6c3a 2066 6c6f 6174 2c20 6f70 7469  tol: float, opti
-00004cd0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00004ce0: 2041 2064 6566 6175 6c74 2074 6f6c 6572   A default toler
-00004cf0: 616e 6365 2075 7365 6420 666f 7220 7468  ance used for th
-00004d00: 6520 6c69 656f 7073 2e73 6f6c 7665 722e  e lieops.solver.
-00004d10: 666c 6f77 3262 7932 2e67 6574 5f32 666c  flow2by2.get_2fl
-00004d20: 6f77 2072 6f75 7469 6e65 2e0a 2020 2020  ow routine..    
-00004d30: 2020 2020 729e 0000 0072 4200 0000 da03      r....rB.....
-00004d40: 746f 6c67 11ea 2d81 9997 713d a901 72b0  tolg..-...q=..r.
-00004d50: 0000 0072 a500 0000 6301 0000 0000 0000  ...r....c.......
-00004d60: 0000 0000 0002 0000 0004 0000 0013 0000  ................
-00004d70: 0073 1400 0000 6700 7c00 5d06 7d01 8800  .s....g.|.].}...
-00004d80: 7c01 8301 9102 7102 5300 7214 0000 0072  |.....q.S.r....r
-00004d90: 1400 0000 2902 722b 0000 00da 0278 6529  ....).r+.....xe)
-00004da0: 0172 6a00 0000 7214 0000 0072 1500 0000  .rj...r....r....
-00004db0: 722f 0000 001f 0200 0072 ab00 0000 7a28  r/.......r....z(
-00004dc0: 6c65 7870 2e5f 6361 6c63 466c 6f77 5f32  lexp._calcFlow_2
-00004dd0: 666c 6f77 2e3c 6c6f 6361 6c73 3e2e 3c6c  flow.<locals>.<l
-00004de0: 6973 7463 6f6d 703e 6300 0000 0000 0000  istcomp>c.......
-00004df0: 0000 0000 0001 0000 0003 0000 0017 0000  ................
-00004e00: 0073 1200 0000 8700 6601 6401 6402 8408  .s......f.d.d...
-00004e10: 8801 4400 8301 5300 2903 4e63 0100 0000  ..D...S.).Nc....
-00004e20: 0000 0000 0000 0000 0200 0000 0400 0000  ................
-00004e30: 1300 0000 72a6 0000 0072 1400 0000 7214  ....r....r....r.
-00004e40: 0000 0029 0272 2b00 0000 da03 7865 6672  ...).r+.....xefr
-00004e50: 7500 0000 7214 0000 0072 1500 0000 722f  u...r....r....r/
-00004e60: 0000 0020 0200 0072 ab00 0000 7a3a 6c65  ... ...r....z:le
-00004e70: 7870 2e5f 6361 6c63 466c 6f77 5f32 666c  xp._calcFlow_2fl
-00004e80: 6f77 2e3c 6c6f 6361 6c73 3e2e 3c6c 616d  ow.<locals>.<lam
-00004e90: 6264 613e 2e3c 6c6f 6361 6c73 3e2e 3c6c  bda>.<locals>.<l
-00004ea0: 6973 7463 6f6d 703e 7214 0000 0072 7500  istcomp>r....ru.
-00004eb0: 0000 72a9 0000 0072 7500 0000 7215 0000  ..r....ru...r...
-00004ec0: 0072 7700 0000 2002 0000 7296 0000 007a  .rw... ...r....z
-00004ed0: 266c 6578 702e 5f63 616c 6346 6c6f 775f  &lexp._calcFlow_
-00004ee0: 3266 6c6f 772e 3c6c 6f63 616c 733e 2e3c  2flow.<locals>.<
-00004ef0: 6c61 6d62 6461 3e29 0372 ae00 0000 72aa  lambda>).r....r.
-00004f00: 0000 0072 6a00 0000 4e29 0872 0800 0000  ...rj...N).r....
-00004f10: 724e 0000 0072 4900 0000 720f 0000 0072  rN...rI...r....r
-00004f20: 4100 0000 721f 0000 0072 0e00 0000 7246  A...r....r....rF
-00004f30: 0000 0029 0372 1100 0000 7213 0000 0072  ...).r....r....r
-00004f40: ae00 0000 7214 0000 0029 0272 6a00 0000  ....r....).rj...
-00004f50: 72aa 0000 0072 1500 0000 72a0 0000 0012  r....r....r.....
-00004f60: 0200 0073 0a00 0000 240a 1402 1201 0c01  ...s....$.......
-00004f70: 1601 7a14 6c65 7870 2e5f 6361 6c63 466c  ..z.lexp._calcFl
-00004f80: 6f77 5f32 666c 6f77 7203 0000 00da 086e  ow_2flowr......n
-00004f90: 5f73 6c69 6365 7363 0200 0000 0000 0000  _slicesc........
-00004fa0: 0000 0000 0a00 0000 0800 0000 0b00 0000  ................
-00004fb0: 734c 0100 007c 02a0 0088 016a 0164 0119  sL...|.....j.d..
-00004fc0: 00a1 0101 007c 02a0 0264 0264 03a1 027d  .....|...d.d...}
-00004fd0: 037c 0364 016b 0373 164a 0064 0483 0182  .|.d.k.s.J.d....
-00004fe0: 017c 0364 036b 0272 2d7a 0b7c 02a0 0364  .|.d.k.r-z.|...d
-00004ff0: 0574 0488 0164 0583 02a1 027d 0457 006e  .t...d.....}.W.n
-00005000: 0701 0001 0001 0074 0564 0683 0182 0174  .......t.d.....t
-00005010: 067c 02a0 0264 0788 016a 076a 08a1 027c  .|...d...j.j...|
-00005020: 02a0 0264 0888 016a 076a 09a1 0264 098d  ...d...j.j...d..
-00005030: 027d 057c 02a0 0a64 0a64 0ba1 027d 047c  .}.|...d.d...}.|
-00005040: 02a0 0a64 0c64 0ba1 027d 0464 0d7c 02a0  ...d.d...}.d.|..
-00005050: 0ba1 0076 0072 5f7c 0264 0d19 0088 016a  ...v.r_|.d.....j
-00005060: 077c 011b 0066 0169 007c 02a4 018e 017d  .|...f.i.|.....}
-00005070: 066e 0688 016a 077c 011b 0067 017d 067c  .n...j.|...g.}.|
-00005080: 02a0 0a64 0e64 0fa1 027d 0487 0166 0164  ...d.d...}...f.d
-00005090: 1064 1184 087c 0644 0083 0189 0088 0044  .d...|.D.......D
-000050a0: 005d 0d7d 077c 076a 0c64 177c 037c 0564  .].}.|.j.d.|.|.d
-000050b0: 129c 027c 02a4 018e 0101 0071 7669 007d  ...|.......qvi.}
-000050c0: 0888 007c 0864 133c 0088 007c 0114 0089  ...|.d.<...|....
-000050d0: 0087 0066 0164 1464 1584 087d 097c 08a0  ...f.d.d...}.|..
-000050e0: 007c 097c 0588 007c 017c 0364 169c 05a1  .|.|...|.|.d....
-000050f0: 0101 007c 0888 016a 0d64 013c 0064 0b53  ...|...j.d.<.d.S
-00005100: 0029 1861 ab05 0000 0a20 2020 2020 2020  .).a.....       
-00005110: 2053 706c 6974 2061 6e64 2f6f 7220 736c   Split and/or sl
-00005120: 6963 6520 7468 6520 6375 7272 656e 7420  ice the current 
-00005130: 6c69 6520 6f70 6572 6174 6f72 2061 6e64  lie operator and
-00005140: 2063 6f6d 7075 7465 2069 7473 2072 6573   compute its res
-00005150: 756c 7469 6e67 2066 6c6f 772c 2072 6561  ulting flow, rea
-00005160: 6479 2074 6f0a 2020 2020 2020 2020 7461  dy to.        ta
-00005170: 6b65 2061 6e20 6e6a 6574 2e0a 2020 2020  ke an njet..    
-00005180: 2020 2020 0a20 2020 2020 2020 2054 6865      .        The
-00005190: 2066 6c6f 7720 6d61 7073 2061 7265 2068   flow maps are h
-000051a0: 6572 6562 7920 6361 6c63 756c 6174 6564  ereby calculated
-000051b0: 2062 7920 616e 7920 6f74 6865 7220 6d65   by any other me
-000051c0: 7468 6f64 2064 6574 6572 6d69 6e65 6420  thod determined 
-000051d0: 6279 2074 6865 2075 7365 722e 200a 2020  by the user. .  
-000051e0: 2020 2020 2020 0a20 2020 2020 2020 2050        .        P
-000051f0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00005200: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00005210: 2020 2020 2070 6f77 6572 3a20 696e 742c       power: int,
-00005220: 2028 6f70 7469 6f6e 616c 290a 2020 2020   (optional).    
-00005230: 2020 2020 2020 2020 436f 6e74 726f 6c20          Control 
-00005240: 7468 6520 6e75 6d62 6572 206f 6620 6e65  the number of ne
-00005250: 7374 6564 2063 6f6d 6d75 7461 746f 7273  sted commutators
-00005260: 2069 6e20 6361 7365 2027 666c 6f77 5f6d   in case 'flow_m
-00005270: 6574 686f 6427 203d 3d20 2762 7275 7465  ethod' == 'brute
-00005280: 666f 7263 6527 2e0a 2020 2020 2020 2020  force'..        
-00005290: 2020 2020 5265 7175 6972 6564 2069 6620      Required if 
-000052a0: 2766 6c6f 775f 6d65 7468 6f64 2720 6973  'flow_method' is
-000052b0: 206e 6f74 2073 7065 6369 6669 6564 2028   not specified (
-000052c0: 6465 6661 756c 7429 2e0a 0a20 2020 2020  default)...     
-000052d0: 2020 2066 6c6f 775f 6d65 7468 6f64 3a20     flow_method: 
-000052e0: 7374 722c 206f 7074 696f 6e61 6c0a 2020  str, optional.  
-000052f0: 2020 2020 2020 2020 2020 5468 6520 6d65            The me
-00005300: 7468 6f64 2074 6f20 636f 6d70 7574 6520  thod to compute 
-00005310: 7468 6520 666c 6f77 206f 6620 7468 6520  the flow of the 
-00005320: 696e 6469 7669 6475 616c 2073 6c69 6365  individual slice
-00005330: 732c 2075 7365 6420 696e 2063 616c 6375  s, used in calcu
-00005340: 6c61 7469 6e67 2074 6865 206f 7574 636f  lating the outco
-00005350: 6d65 0a20 2020 2020 2020 2020 2020 206f  me.            o
-00005360: 6620 7061 7373 696e 6720 7468 6520 6a65  f passing the je
-00005370: 7473 2074 6872 6f75 6768 2074 6865 7365  ts through these
-00005380: 2073 6c69 6365 732e 0a20 2020 2020 2020   slices..       
-00005390: 2020 2020 200a 2020 2020 2020 2020 7370       .        sp
-000053a0: 6c69 745f 6d65 7468 6f64 3a20 7374 722c  lit_method: str,
-000053b0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-000053c0: 2020 2020 2020 4375 7374 6f6d 697a 6564        Customized
-000053d0: 2073 706c 6974 7469 6e67 206d 6574 686f   splitting metho
-000053e0: 6420 6f66 2074 6865 2068 616d 696c 746f  d of the hamilto
-000053f0: 6e69 616e 732e 2053 6565 206c 6965 6f70  nians. See lieop
-00005400: 732e 736f 6c76 6572 2e73 706c 6974 7469  s.solver.splitti
-00005410: 6e67 2066 6f72 2065 7861 6d70 6c65 732e  ng for examples.
-00005420: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
-00005430: 2020 2020 2020 6e5f 736c 6963 6573 3a20        n_slices: 
-00005440: 696e 742c 206f 7074 696f 6e61 6c0a 2020  int, optional.  
-00005450: 2020 2020 2020 2020 2020 536c 6963 6520            Slice 
-00005460: 7468 6520 6861 6d69 6c74 6f6e 6961 6e20  the hamiltonian 
-00005470: 756e 6966 6f72 6d6c 7920 696e 746f 206e  uniformly into n
-00005480: 5f73 6c69 6365 7320 7061 7274 7320 6265  _slices parts be
-00005490: 666f 7265 2070 6173 7369 6e67 2074 6865  fore passing the
-000054a0: 206e 6a65 7473 2e0a 2020 2020 2020 2020   njets..        
-000054b0: 2020 2020 0a20 2020 2020 2020 206f 7264      .        ord
-000054c0: 6572 3a20 696e 742c 206f 7074 696f 6e61  er: int, optiona
-000054d0: 6c0a 2020 2020 2020 2020 2020 2020 436f  l.            Co
-000054e0: 6e74 726f 6c20 7468 6520 6f72 6465 7220  ntrol the order 
-000054f0: 6f66 2074 6865 206e 6a65 7473 2070 6173  of the njets pas
-00005500: 7365 6420 7468 726f 7567 6820 7468 6520  sed through the 
-00005510: 4c69 6520 6f70 6572 6174 6f72 2e20 4966  Lie operator. If
-00005520: 206e 6f74 6869 6e67 2073 7065 6369 6669   nothing specifi
-00005530: 6564 2c0a 2020 2020 2020 2020 2020 2020  ed,.            
-00005540: 6120 7265 6173 6f6e 6162 6c65 206f 7264  a reasonable ord
-00005550: 6572 2077 696c 6c20 6265 2061 7474 656d  er will be attem
-00005560: 7074 6564 2c20 6465 7065 6e64 696e 6720  pted, depending 
-00005570: 6f6e 206d 6178 5f70 6f77 6572 206f 6620  on max_power of 
-00005580: 7468 6520 6375 7272 656e 7420 4c69 6520  the current Lie 
-00005590: 6f70 6572 6174 6f72 2061 7267 756d 656e  operator argumen
-000055a0: 742e 0a20 2020 2020 2020 2020 2020 200a  t..            .
-000055b0: 2020 2020 2020 2020 636f 6d70 6f6e 656e          componen
-000055c0: 7473 3a20 6c69 7374 2c20 6f70 7469 6f6e  ts: list, option
-000055d0: 616c 0a20 2020 2020 2020 2020 2020 2041  al.            A
-000055e0: 206c 6973 7420 6f66 2070 6f6c 7920 6f62   list of poly ob
-000055f0: 6a65 6374 7320 7768 6963 6820 746f 2061  jects which to a
-00005600: 7070 6c79 2074 6865 204c 6965 206f 7065  pply the Lie ope
-00005610: 7261 746f 7220 6f6e 746f 2e20 4279 2064  rator onto. By d
-00005620: 6566 6175 6c74 2c20 7365 6c66 2e63 6f6d  efault, self.com
-00005630: 706f 6e65 6e74 7320 6172 6520 7461 6b65  ponents are take
-00005640: 6e2e 2020 2020 2020 2020 2020 200a 2020  n.           .  
-00005650: 2020 2020 2020 2a2a 6b77 6172 6773 0a20        **kwargs. 
-00005660: 2020 2020 2020 2020 2020 204f 7074 696f             Optio
-00005670: 6e61 6c20 6b65 7977 6f72 6465 6420 6172  nal keyworded ar
-00005680: 6775 6d65 6e74 7320 7061 7373 6564 2074  guments passed t
-00005690: 6f20 7468 6520 666c 6f77 5f6d 6574 686f  o the flow_metho
-000056a0: 6420 726f 7574 696e 652e 0a20 2020 2020  d routine..     
-000056b0: 2020 2072 9f00 0000 da0b 666c 6f77 5f6d     r......flow_m
-000056c0: 6574 686f 6472 4300 0000 7a30 4172 6775  ethodrC...z0Argu
-000056d0: 6d65 6e74 2027 666c 6f77 5f6d 6574 686f  ment 'flow_metho
-000056e0: 6427 2063 616e 206e 6f74 2062 6520 276e  d' can not be 'n
-000056f0: 6a65 7427 2069 7473 656c 662e 7219 0000  jet' itself.r...
-00005700: 007a 4444 6566 6175 6c74 2066 6c6f 775f  .zDDefault flow_
-00005710: 6d65 7468 6f64 3a20 6272 7574 6566 6f72  method: brutefor
-00005720: 6365 2072 6571 7569 7265 7320 2770 6f77  ce requires 'pow
-00005730: 6572 2720 6172 6775 6d65 6e74 2074 6f20  er' argument to 
-00005740: 6265 2073 6574 2e72 1f00 0000 720e 0000  be set.r....r...
-00005750: 0029 0272 1f00 0000 720e 0000 0072 5c00  .).r....r....r\.
-00005760: 0000 4e72 5000 0000 da0c 7370 6c69 745f  ..NrP.....split_
-00005770: 6d65 7468 6f64 728b 0000 0046 6301 0000  methodr....Fc...
-00005780: 0000 0000 0000 0000 0002 0000 0005 0000  ................
-00005790: 0013 0000 0073 1600 0000 6700 7c00 5d07  .....s....g.|.].
-000057a0: 7d01 8800 a000 7c01 a101 9102 7102 5300  }.....|.....q.S.
-000057b0: 7214 0000 0029 0172 8100 0000 2902 722b  r....).r....).r+
-000057c0: 0000 00da 0168 7251 0000 0072 1400 0000  .....hrQ...r....
-000057d0: 7215 0000 0072 2f00 0000 5b02 0000 7302  r....r/...[...s.
-000057e0: 0000 0016 007a 276c 6578 702e 5f63 616c  .....z'lexp._cal
-000057f0: 6346 6c6f 775f 6e6a 6574 2e3c 6c6f 6361  cFlow_njet.<loca
-00005800: 6c73 3e2e 3c6c 6973 7463 6f6d 703e 2902  ls>.<listcomp>).
-00005810: 725c 0000 0072 5000 0000 da10 756e 6971  r\...rP.....uniq
-00005820: 7565 5f6f 7065 7261 746f 7273 6300 0000  ue_operatorsc...
-00005830: 0000 0000 0000 0000 0002 0000 0003 0000  ................
-00005840: 0017 0000 0073 1600 0000 8800 4400 5d06  .....s......D.].
-00005850: 7d01 7c01 7c00 8e00 7d00 7102 7c00 5300  }.|.|...}.q.|.S.
-00005860: 7221 0000 0072 1400 0000 2902 7272 0000  r!...r....).rr..
-00005870: 00da 026f 7029 01da 096f 7065 7261 746f  ...op)...operato
-00005880: 7273 7214 0000 0072 1500 0000 da09 6c6f  rsr....r......lo
-00005890: 5f63 6f6e 6361 7461 0200 0073 0600 0000  _concata...s....
-000058a0: 0801 0a01 0401 7a26 6c65 7870 2e5f 6361  ......z&lexp._ca
-000058b0: 6c63 466c 6f77 5f6e 6a65 742e 3c6c 6f63  lcFlow_njet.<loc
-000058c0: 616c 733e 2e6c 6f5f 636f 6e63 6174 2905  als>.lo_concat).
-000058d0: 726a 0000 0072 ae00 0000 72ba 0000 0072  rj...r....r....r
-000058e0: b400 0000 72b5 0000 0072 1400 0000 290e  ....r....r....).
-000058f0: 7265 0000 0072 4900 0000 720f 0000 0072  re...rI...r....r
-00005900: 5300 0000 da07 6765 7461 7474 7272 7c00  S.....getattrr|.
-00005910: 0000 7241 0000 0072 4e00 0000 721f 0000  ..rA...rN...r...
-00005920: 0072 0e00 0000 7266 0000 0072 4b00 0000  .r....rf...rK...
-00005930: 720c 0000 0072 4600 0000 290a 7211 0000  r....rF...).r...
-00005940: 0072 b400 0000 7213 0000 0072 b500 0000  .r....r....r....
-00005950: 7254 0000 0072 ae00 0000 da0c 6861 6d69  rT...r......hami
-00005960: 6c74 6f6e 6961 6e73 72b9 0000 0072 7b00  ltoniansr....r{.
-00005970: 0000 72bb 0000 0072 1400 0000 2902 72ba  ..r....r....).r.
-00005980: 0000 0072 1100 0000 7215 0000 0072 a200  ...r....r....r..
-00005990: 0000 2302 0000 7330 0000 0010 200c 0310  ..#...s0.... ...
-000059a0: 0108 0102 0116 0106 0108 0124 030c 010c  ...........$....
-000059b0: 010c 011c 020c 020c 0412 0108 0118 0104  ................
-000059c0: 0108 0108 010c 0116 040e 017a 136c 6578  ...........z.lex
-000059d0: 702e 5f63 616c 6346 6c6f 775f 6e6a 6574  p._calcFlow_njet
-000059e0: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
-000059f0: 0005 0000 004b 0000 0073 2e00 0000 6401  .....K...s....d.
-00005a00: 7400 7c00 6a01 7c00 6a02 6402 1900 6403  t.|.j.|.j.d...d.
-00005a10: 1900 1400 6601 6900 7c01 a401 8e01 6901  ....f.i.|.....i.
-00005a20: 7c00 6a03 6402 3c00 6400 5300 2904 4e72  |.j.d.<.d.S.).Nr
-00005a30: 6a00 0000 720a 0000 0072 4200 0000 2904  j...r....rB...).
-00005a40: 720a 0000 0072 4e00 0000 7249 0000 0072  r....rN...rI...r
-00005a50: 4600 0000 72a4 0000 0072 1400 0000 7214  F...r....r....r.
-00005a60: 0000 0072 1500 0000 72a3 0000 0068 0200  ...r....r....h..
-00005a70: 0073 0200 0000 2e01 7a15 6c65 7870 2e5f  .s......z.lexp._
-00005a80: 6361 6c63 466c 6f77 5f68 6579 6f6b 6163  calcFlow_heyokac
-00005a90: 0100 0000 0000 0000 0000 0000 0700 0000  ................
-00005aa0: 0400 0000 0b00 0000 73e8 0000 007c 006a  ........s....|.j
-00005ab0: 007d 027c 006a 017c 0219 007d 0364 017c  .}.|.j.|...}.d.|
-00005ac0: 03a0 02a1 0076 0172 6b7c 006a 037c 0219  .....v.rk|.j.|..
-00005ad0: 007d 0464 027c 04a0 02a1 0076 0073 1b4a  .}.d.|.....v.s.J
-00005ae0: 0082 0164 037c 03a0 02a1 0076 0072 267c  ...d.|.....v.r&|
-00005af0: 0364 0319 0089 006e 3164 047c 03a0 02a1  .d.....n1d.|....
-00005b00: 0076 0072 4f64 057c 0164 013c 007c 006a  .v.rOd.|.d.<.|.j
-00005b10: 0464 0d69 007c 01a4 018e 017d 057c 0564  .d.i.|.....}.|.d
-00005b20: 0119 0089 0088 007c 0364 033c 007c 0564  .......|.d.<.|.d
-00005b30: 0619 007c 0364 073c 007c 006a 017c 0219  ...|.d.<.|.j.|..
-00005b40: 00a0 057c 03a1 0101 006e 0874 0664 087c  ...|.....n.t.d.|
-00005b50: 029b 0064 099d 0383 0182 0187 0066 0164  ...d.........f.d
-00005b60: 0a64 0b84 087c 0464 0219 0044 0083 017d  .d...|.d...D...}
-00005b70: 067c 067c 006a 017c 0219 0064 013c 007c  .|.|.j.|...d.<.|
-00005b80: 0653 0074 076a 087c 0066 0169 007c 01a4  .S.t.j.|.f.i.|..
-00005b90: 018e 0153 0029 0e61 1601 0000 0a20 2020  ...S.).a.....   
-00005ba0: 2020 2020 2049 6620 7365 6c66 2e66 6c6f       If self.flo
-00005bb0: 7720 6861 7320 6265 656e 2063 6f6d 7075  w has been compu
-00005bc0: 7465 642c 2063 6f6d 7075 7465 2028 6f72  ted, compute (or
-00005bd0: 2072 6574 7572 6e29 2074 6865 2072 6573   return) the res
-00005be0: 756c 7469 6e67 2070 6f6c 796e 6f6d 6961  ulting polynomia
-00005bf0: 6c20 6578 7028 3a78 3a29 3a79 3a2c 200a  l exp(:x:):y:, .
-00005c00: 2020 2020 2020 2020 666f 7220 6576 6572          for ever
-00005c10: 7920 7920 696e 2073 656c 662e 636f 6d70  y y in self.comp
-00005c20: 6f6e 656e 7473 2e20 5468 6973 2077 696c  onents. This wil
-00005c30: 6c20 6265 2064 6f6e 6520 6279 2070 756c  l be done by pul
-00005c40: 6c69 6e67 2062 6163 6b20 7468 6520 706f  ling back the po
-00005c50: 6c79 6e6f 6d69 616c 203a 793a 2c20 7573  lynomial :y:, us
-00005c60: 696e 6720 7468 650a 2020 2020 2020 2020  ing the.        
-00005c70: 7661 6c75 6573 2065 7870 283a 783a 297a  values exp(:x:)z
-00005c80: 5f6a 2c20 7768 6572 6520 7a5f 6a20 6172  _j, where z_j ar
-00005c90: 6520 7468 6520 7869 2f65 7461 2063 6f6f  e the xi/eta coo
-00005ca0: 7264 696e 6174 6573 2e0a 2020 2020 2020  rdinates..      
-00005cb0: 2020 7278 0000 0072 5000 0000 72aa 0000    rx...rP...r...
-00005cc0: 0072 6a00 0000 54da 0244 41da 0564 666c  .rj...T..DA..dfl
-00005cd0: 6f77 7a27 4e6f 2072 6573 756c 7428 7329  owz'No result(s)
-00005ce0: 2066 6965 6c64 2070 7265 7365 6e74 2066   field present f
-00005cf0: 6f72 206d 6574 686f 6420 277a 0227 2e63  or method 'z.'.c
-00005d00: 0100 0000 0000 0000 0000 0000 0200 0000  ................
-00005d10: 0400 0000 1300 0000 72a6 0000 0072 1400  ........r....r..
-00005d20: 0000 7214 0000 0072 a700 0000 72a9 0000  ..r....r....r...
-00005d30: 0072 1400 0000 7215 0000 0072 2f00 0000  .r....r....r/...
-00005d40: 8402 0000 72ab 0000 007a 2a6c 6578 702e  ....r....z*lexp.
-00005d50: 5f63 616c 6350 6f6c 7946 726f 6d46 6c6f  _calcPolyFromFlo
-00005d60: 772e 3c6c 6f63 616c 733e 2e3c 6c69 7374  w.<locals>.<list
-00005d70: 636f 6d70 3e4e 7214 0000 0029 0972 4700  comp>Nr....).rG.
-00005d80: 0000 7246 0000 0072 4b00 0000 7249 0000  ..rF...rK...rI..
-00005d90: 0072 8b00 0000 7265 0000 0072 7c00 0000  .r....re...r|...
-00005da0: 7223 0000 0072 7d00 0000 2907 7211 0000  r#...r}...).r...
-00005db0: 0072 1300 0000 725c 0000 00da 0866 6c6f  .r....r\.....flo
-00005dc0: 775f 6f75 74da 0a70 6172 616d 6574 6572  w_out..parameter
-00005dd0: 73da 0874 7073 615f 6f75 7472 7100 0000  s..tpsa_outrq...
-00005de0: 7214 0000 0072 a900 0000 7215 0000 0072  r....r....r....r
-00005df0: 7d00 0000 6b02 0000 7326 0000 0006 060a  }...k...s&......
-00005e00: 010c 010a 0110 010c 020a 010c 0108 0210  ................
-00005e10: 0108 0108 010c 0112 0110 0216 020e 0104  ................
-00005e20: 0112 027a 166c 6578 702e 5f63 616c 6350  ...z.lexp._calcP
-00005e30: 6f6c 7946 726f 6d46 6c6f 7763 0100 0000  olyFromFlowc....
-00005e40: 0000 0000 0000 0000 0300 0000 0400 0000  ................
-00005e50: 4f00 0000 733a 0000 0074 007c 0164 0119  O...s:...t.|.d..
-00005e60: 0074 017c 0083 0183 0272 117c 006a 027c  .t.|.....r.|.j.|
-00005e70: 0169 007c 02a4 018e 0153 0074 036a 047c  .i.|.....S.t.j.|
-00005e80: 0067 017c 01a2 0152 0069 007c 02a4 018e  .g.|...R.i.|....
-00005e90: 0153 0029 024e 7201 0000 0029 0572 2200  .S.).Nr....).r".
-00005ea0: 0000 7297 0000 0072 9c00 0000 7223 0000  ..r....r....r#..
-00005eb0: 0072 5800 0000 2903 7211 0000 0072 7200  .rX...).r....rr.
-00005ec0: 0000 7213 0000 0072 1400 0000 7214 0000  ..r....r....r...
-00005ed0: 0072 1500 0000 7258 0000 008a 0200 0073  .r....rX.......s
-00005ee0: 0600 0000 1201 1001 1802 7a0d 6c65 7870  ..........z.lexp
-00005ef0: 2e5f 5f63 616c 6c5f 5f63 0100 0000 0000  .__call__c......
-00005f00: 0000 0000 0000 0600 0000 0400 0000 4f00  ..............O.
-00005f10: 0000 734c 0000 007c 02a0 0064 0164 02a1  ..sL...|...d.d..
-00005f20: 027d 0374 016a 027c 0067 017c 01a2 0152  .}.t.j.|.g.|...R
-00005f30: 0069 007c 02a4 018e 017d 047c 0364 026b  .i.|.....}.|.d.k
-00005f40: 0472 2464 037c 04a0 03a1 0076 0072 2474  .r$d.|.....v.r$t
-00005f50: 047c 0464 0319 007c 0364 048d 027d 057c  .|.d...|.d...}.|
-00005f60: 0453 0029 057a d40a 2020 2020 2020 2020  .S.).z..        
-00005f70: 5365 6520 6c69 656f 7073 2e63 6f72 652e  See lieops.core.
-00005f80: 746f 6f6c 732e 7470 7361 2066 6f72 2061  tools.tpsa for a
-00005f90: 2064 6573 6372 6970 7469 6f6e 2e0a 2020   description..  
-00005fa0: 2020 2020 2020 0a20 2020 2020 2020 2050        .        P
-00005fb0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00005fc0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 2020 2020    ----------    
-00005fd0: 2020 2020 0a20 2020 2020 2020 2074 6f6c      .        tol
-00005fe0: 3a20 666c 6f61 742c 206f 7074 696f 6e61  : float, optiona
-00005ff0: 6c0a 2020 2020 2020 2020 2020 2020 4966  l.            If
-00006000: 203e 2030 2c20 7065 7266 6f72 6d20 6120   > 0, perform a 
-00006010: 6368 6563 6b20 6f6e 2073 796d 706c 6563  check on symplec
-00006020: 7469 6369 7479 206f 6620 7468 6520 6d61  ticity of the ma
-00006030: 702e 0a20 2020 2020 2020 2072 b000 0000  p..        r....
-00006040: 7201 0000 0072 7800 0000 72b1 0000 0029  r....rx...r....)
-00006050: 0572 0f00 0000 7223 0000 0072 8b00 0000  .r....r#...r....
-00006060: 724b 0000 0072 0700 0000 2906 7211 0000  rK...r....).r...
-00006070: 0072 1200 0000 7213 0000 0072 b000 0000  .r....r....r....
-00006080: 72c2 0000 0072 5400 0000 7214 0000 0072  r....rT...r....r
-00006090: 1400 0000 7215 0000 0072 8b00 0000 9002  ....r....r......
-000060a0: 0000 730a 0000 000c 0918 0114 0110 0104  ..s.............
-000060b0: 017a 096c 6578 702e 7470 7361 4e72 8c00  .z.lexp.tpsaNr..
-000060c0: 0000 2901 7203 0000 0029 1472 2700 0000  ..).r....).r'...
-000060d0: 7228 0000 0072 2900 0000 724f 0000 0072  r(...r)...rO...r
-000060e0: 4a00 0000 724c 0000 0072 9c00 0000 7224  J...rL...r....r$
-000060f0: 0000 0072 9d00 0000 7269 0000 0072 6b00  ...r....ri...rk.
-00006100: 0000 726c 0000 0072 a100 0000 72a0 0000  ..rl...r....r...
-00006110: 0072 2a00 0000 72a2 0000 0072 a300 0000  .r*...r....r....
-00006120: 727d 0000 0072 5800 0000 728b 0000 0072  r}...rX...r....r
-00006130: 1400 0000 7214 0000 0072 1400 0000 7215  ....r....r....r.
-00006140: 0000 0072 1000 0000 8f01 0000 7322 0000  ...r........s"..
-00006150: 0008 0008 0208 0d08 0d08 0308 2608 060a  ............&...
-00006160: 0608 070a 0d08 1208 0c10 1108 4508 0308  ............E...
-00006170: 1f0c 0672 1000 0000 728c 0000 0029 1cda  ...r....r....)..
-00006180: 056e 756d 7079 7236 0000 0072 4800 0000  .numpyr6...rH...
-00006190: 7288 0000 00da 106c 6965 6f70 732e 6c69  r......lieops.li
-000061a0: 6e61 6c67 2e6e 6672 0200 0000 da0a 6765  nalg.nfr......ge
-000061b0: 6e65 7261 746f 7273 7204 0000 00da 0763  neratorsr......c
-000061c0: 6f6d 6269 6e65 7205 0000 0072 0d00 0000  ombiner....r....
-000061d0: 7206 0000 00da 116c 6965 6f70 732e 636f  r......lieops.co
-000061e0: 7265 2e74 6f6f 6c73 7207 0000 00da 0d6c  re.toolsr......l
-000061f0: 6965 6f70 732e 736f 6c76 6572 7208 0000  ieops.solverr...
-00006200: 0072 0900 0000 720a 0000 00da 176c 6965  .r....r......lie
-00006210: 6f70 732e 736f 6c76 6572 2e73 706c 6974  ops.solver.split
-00006220: 7469 6e67 720b 0000 00da 186c 6965 6f70  tingr......lieop
-00006230: 732e 736f 6c76 6572 2e62 7275 7465 666f  s.solver.brutefo
-00006240: 7263 6572 0c00 0000 7279 0000 0072 1b00  rcer....ry...r..
-00006250: 0000 da14 6c69 656f 7073 2e63 6f72 652e  ....lieops.core.
-00006260: 6269 726b 686f 6666 7241 0000 0072 2300  birkhoffrA...r#.
-00006270: 0000 7210 0000 0072 1400 0000 7214 0000  ..r....r....r...
-00006280: 0072 1400 0000 7215 0000 00da 083c 6d6f  .r....r......<mo
-00006290: 6475 6c65 3e01 0000 0073 2400 0000 0800  dule>....s$.....
-000062a0: 0801 0801 0c02 0c02 0c01 0c01 0c02 1402  ................
-000062b0: 0c01 0c01 0802 0801 1002 0a56 0e2b 007f  ...........V.+..
-000062c0: 147b                                     .{
+00000a90: 7469 6f6e 616c 206b 6579 776f 7264 6564  tional keyworded
+00000aa0: 2061 7267 756d 656e 7473 2070 6173 7365   arguments passe
+00000ab0: 6420 746f 2073 656c 662e 6c65 7870 2061  d to self.lexp a
+00000ac0: 6e64 206c 6965 6f70 6572 6174 6f72 2e63  nd lieoperator.c
+00000ad0: 616c 6346 6c6f 772e 0a20 2020 2020 2020  alcFlow..       
+00000ae0: 2020 2020 200a 2020 2020 2020 2020 5265       .        Re
+00000af0: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
+00000b00: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6c6f  -----.        lo
+00000b10: 2c20 6c65 7870 0a20 2020 2020 2020 2020  , lexp.         
+00000b20: 2020 2041 206c 6578 7020 286c 6965 6f70     A lexp (lieop
+00000b30: 6572 6174 6f72 2920 6f62 6a65 6374 2c20  erator) object, 
+00000b40: 636f 6e74 6169 6e69 6e67 2074 6865 2066  containing the f
+00000b50: 6c6f 7720 6675 6e63 7469 6f6e 206f 6620  low function of 
+00000b60: 7468 6520 6375 7272 656e 7420 4c69 6520  the current Lie 
+00000b70: 706f 6c79 6e6f 6d69 616c 0a20 2020 2020  polynomial.     
+00000b80: 2020 2020 2020 2069 6e20 6f6e 6520 6f66         in one of
+00000b90: 2069 7473 2066 6965 6c64 732e 0a20 2020   its fields..   
+00000ba0: 2020 2020 204e 7213 0000 0029 0272 0f00       Nr....).r..
+00000bb0: 0000 720b 0000 0029 0472 1000 0000 7211  ..r....).r....r.
+00000bc0: 0000 0072 1200 0000 da02 6c6f 7213 0000  ...r......lor...
+00000bd0: 0072 1300 0000 7214 0000 0072 0b00 0000  .r....r....r....
+00000be0: 4a00 0000 7306 0000 0010 1310 0104 017a  J...s..........z
+00000bf0: 0d70 6f6c 792e 6361 6c63 466c 6f77 6302  .poly.calcFlowc.
+00000c00: 0000 0000 0000 0000 0000 0002 0000 0004  ................
+00000c10: 0000 0043 0000 0073 2000 0000 7400 7c01  ...C...s ...t.|.
+00000c20: 7401 8302 720a 7c01 7c00 8301 0b00 5300  t...r.|.|.....S.
+00000c30: 7402 a003 7c00 7c01 a102 5300 a901 4e29  t...|.|...S...N)
+00000c40: 04da 0a69 7369 6e73 7461 6e63 65da 0b6c  ...isinstance..l
+00000c50: 6965 6f70 6572 6174 6f72 7206 0000 00da  ieoperatorr.....
+00000c60: 0a5f 5f6d 6174 6d75 6c5f 5fa9 0272 1000  .__matmul__..r..
+00000c70: 0000 da05 6f74 6865 7272 1300 0000 7213  ....otherr....r.
+00000c80: 0000 0072 1400 0000 7221 0000 0061 0000  ...r....r!...a..
+00000c90: 0073 0600 0000 0a01 0a01 0c02 7a0f 706f  .s..........z.po
+00000ca0: 6c79 2e5f 5f6d 6174 6d75 6c5f 5f4e a901  ly.__matmul__N..
+00000cb0: 7203 0000 0029 08da 085f 5f6e 616d 655f  r....)...__name_
+00000cc0: 5fda 0a5f 5f6d 6f64 756c 655f 5fda 0c5f  _..__module__.._
+00000cd0: 5f71 7561 6c6e 616d 655f 5f72 0f00 0000  _qualname__r....
+00000ce0: da03 696e 7472 1b00 0000 720b 0000 0072  ..intr....r....r
+00000cf0: 2100 0000 7213 0000 0072 1300 0000 7213  !...r....r....r.
+00000d00: 0000 0072 1400 0000 720c 0000 0012 0000  ...r....r.......
+00000d10: 0073 0a00 0000 0800 0802 101d 0819 0c17  .s..............
+00000d20: 720c 0000 0046 6302 0000 0000 0000 0000  r....Fc.........
+00000d30: 0000 0009 0000 0008 0000 000b 0000 0073  ...............s
+00000d40: 1601 0000 6700 6700 0202 7d03 7d04 7400  ....g.g...}.}.t.
+00000d50: 7c00 8301 4400 5d7d 8900 8700 6601 6401  |...D.]}....f.d.
+00000d60: 6402 8408 7400 7c00 8301 4400 8301 7d05  d...t.|...D...}.
+00000d70: 7c01 7335 7401 640b 7c05 6403 6701 7c00  |.s5t.d.|.d.g.|.
+00000d80: 1400 7c00 6404 9c03 7c02 a401 8e01 7d06  ..|.d...|.....}.
+00000d90: 7401 640b 6403 6701 7c00 1400 7c05 7c00  t.d.d.g.|...|.|.
+00000da0: 6404 9c03 7c02 a401 8e01 7d07 6e47 7402  d...|.....}.nGt.
+00000db0: 7403 a004 6405 a101 8301 7d08 7401 640b  t...d.....}.t.d.
+00000dc0: 7405 7c05 6403 6701 7c00 1400 1700 8301  t.|.d.g.|.......
+00000dd0: 6406 7c08 1b00 7405 6403 6701 7c00 1400  d.|...t.d.g.|...
+00000de0: 7c05 1700 8301 6406 7c08 1b00 6902 7c00  |.....d.|...i.|.
+00000df0: 6407 9c02 7c02 a401 8e01 7d06 7401 640b  d...|.....}.t.d.
+00000e00: 7405 7c05 6403 6701 7c00 1400 1700 8301  t.|.d.g.|.......
+00000e10: 6408 7c08 1b00 7405 6403 6701 7c00 1400  d.|...t.d.g.|...
+00000e20: 7c05 1700 8301 6409 7c08 1b00 6902 7c00  |.....d.|...i.|.
+00000e30: 6407 9c02 7c02 a401 8e01 7d07 7c03 a006  d...|.....}.|...
+00000e40: 7c06 a101 0100 7c04 a006 7c07 a101 0100  |.....|...|.....
+00000e50: 7109 7c03 7c04 1700 5300 290c 61b2 0200  q.|.|...S.).a...
+00000e60: 000a 2020 2020 4372 6561 7465 2061 2073  ..    Create a s
+00000e70: 6574 206f 6620 636f 6d70 6c65 7820 2878  et of complex (x
+00000e80: 692c 2065 7461 292d 4c69 6520 706f 6c79  i, eta)-Lie poly
+00000e90: 6e6f 6d69 616c 7320 666f 7220 6120 6769  nomials for a gi
+00000ea0: 7665 6e20 6469 6d65 6e73 696f 6e2e 0a20  ven dimension.. 
+00000eb0: 2020 200a 2020 2020 5061 7261 6d65 7465     .    Paramete
+00000ec0: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+00000ed0: 2d0a 2020 2020 6469 6d3a 2069 6e74 0a20  -.    dim: int. 
+00000ee0: 2020 2020 2020 2054 6865 2072 6571 7565         The reque
+00000ef0: 7374 6564 2064 696d 656e 7369 6f6e 2e0a  sted dimension..
+00000f00: 2020 2020 2020 2020 0a20 2020 2072 6561          .    rea
+00000f10: 6c3a 2062 6f6f 6c65 616e 2c20 6f70 7469  l: boolean, opti
+00000f20: 6f6e 616c 0a20 2020 2020 2020 2049 6620  onal.        If 
+00000f30: 7472 7565 2c20 6372 6561 7465 2072 6561  true, create rea
+00000f40: 6c2d 7661 6c75 6564 2063 6f6f 7264 696e  l-valued coordin
+00000f50: 6174 6573 2071 2061 6e64 2070 2069 6e73  ates q and p ins
+00000f60: 7465 6164 2e20 0a20 2020 2020 2020 200a  tead. .        .
+00000f70: 2020 2020 2020 2020 4e6f 7465 2074 6861          Note tha
+00000f80: 7420 6974 2068 6f6c 6473 3a0a 2020 2020  t it holds:.    
+00000f90: 2020 2020 7120 3d20 2878 6920 2b20 6574      q = (xi + et
+00000fa0: 6129 2f73 7172 7428 3229 0a20 2020 2020  a)/sqrt(2).     
+00000fb0: 2020 2070 203d 2028 7869 202d 2065 7461     p = (xi - eta
+00000fc0: 292f 7371 7274 2832 292f 316a 0a20 2020  )/sqrt(2)/1j.   
+00000fd0: 2020 2020 200a 2020 2020 2a2a 6b77 6172       .    **kwar
+00000fe0: 6773 0a20 2020 2020 2020 204f 7074 696f  gs.        Optio
+00000ff0: 6e61 6c20 6172 6775 6d65 6e74 7320 7061  nal arguments pa
+00001000: 7373 6564 2074 6f20 706f 6c79 2063 6c61  ssed to poly cla
+00001010: 7373 2e0a 2020 2020 2020 2020 0a20 2020  ss..        .   
+00001020: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
+00001030: 2d2d 2d2d 0a20 2020 206c 6973 740a 2020  ----.    list.  
+00001040: 2020 2020 2020 4c69 7374 206f 6620 6c65        List of le
+00001050: 6e67 7468 2032 2a64 696d 2077 6974 6820  ngth 2*dim with 
+00001060: 706f 6c79 2065 6e74 7269 6573 2c20 636f  poly entries, co
+00001070: 7272 6573 706f 6e64 696e 6720 746f 2074  rresponding to t
+00001080: 6865 2078 695f 6b20 616e 6420 6574 615f  he xi_k and eta_
+00001090: 6b20 4c69 6520 706f 6c79 6e6f 6d69 616c  k Lie polynomial
+000010a0: 732e 2048 6572 6562 7920 7468 6520 6669  s. Hereby the fi
+000010b0: 7273 740a 2020 2020 2020 2020 6469 6d20  rst.        dim 
+000010c0: 656e 7472 6965 7320 6265 6c6f 6e67 2074  entries belong t
+000010d0: 6f20 7468 6520 7869 2d76 616c 7565 732c  o the xi-values,
+000010e0: 2077 6869 6c65 2074 6865 206c 6173 7420   while the last 
+000010f0: 6469 6d20 656e 7472 6965 7320 746f 2074  dim entries to t
+00001100: 6865 2065 7461 2d76 616c 7565 732e 0a20  he eta-values.. 
+00001110: 2020 2063 0100 0000 0000 0000 0000 0000     c............
+00001120: 0200 0000 0400 0000 1300 0000 731c 0000  ............s...
+00001130: 0067 007c 005d 0a7d 017c 0188 006b 0372  .g.|.].}.|...k.r
+00001140: 0a64 006e 0164 0191 0271 0253 0029 0272  .d.n.d...q.S.).r
+00001150: 0100 0000 7203 0000 0072 1300 0000 2902  ....r....r....).
+00001160: da02 2e30 da01 69a9 01da 016b 7213 0000  ...0..i....kr...
+00001170: 0072 1400 0000 da0a 3c6c 6973 7463 6f6d  .r......<listcom
+00001180: 703e 8300 0000 f302 0000 001c 007a 2163  p>...........z!c
+00001190: 7265 6174 655f 636f 6f72 6473 2e3c 6c6f  reate_coords.<lo
+000011a0: 6361 6c73 3e2e 3c6c 6973 7463 6f6d 703e  cals>.<listcomp>
+000011b0: 7201 0000 0029 03da 0161 da01 6272 1c00  r....)...a..br..
+000011c0: 0000 7216 0000 0072 0300 0000 2902 da06  ..r....r....)...
+000011d0: 7661 6c75 6573 721c 0000 0079 0000 0000  valuesr....y....
+000011e0: 0000 0080 0000 0000 0000 f0bf 7900 0000  ............y...
+000011f0: 0000 0000 0000 0000 0000 00f0 3f4e 7213  ............?Nr.
+00001200: 0000 0029 07da 0572 616e 6765 720c 0000  ...)...ranger...
+00001210: 00da 0566 6c6f 6174 da02 6e70 da04 7371  ...float..np..sq
+00001220: 7274 da05 7475 706c 65da 0661 7070 656e  rt..tuple..appen
+00001230: 6429 0972 1c00 0000 da04 7265 616c 7212  d).r......realr.
+00001240: 0000 005a 0772 6573 756c 7478 5a07 7265  ...Z.resultxZ.re
+00001250: 7375 6c74 79da 0265 6b5a 0478 695f 6b5a  sulty..ekZ.xi_kZ
+00001260: 0565 7461 5f6b da05 7371 7274 3272 1300  .eta_k..sqrt2r..
+00001270: 0000 722b 0000 0072 1400 0000 da0d 6372  ..r+...r......cr
+00001280: 6561 7465 5f63 6f6f 7264 7368 0000 0073  eate_coordsh...s
+00001290: 3000 0000 0a19 0c01 1601 0401 1c01 1e01  0...............
+000012a0: 0e02 1a01 1601 02ff 0202 04fe 0202 06fe  ................
+000012b0: 1a03 1601 02ff 0202 04fe 0202 06fe 0a03  ................
+000012c0: 0c01 0801 723b 0000 0063 0000 0000 0000  ....r;...c......
+000012d0: 0000 0000 0000 0000 0000 0300 0000 4000  ..............@.
+000012e0: 0000 7398 0000 0065 005a 0164 005a 0264  ..s....e.Z.d.Z.d
+000012f0: 015a 0364 0264 0384 005a 0464 0464 0584  .Z.d.d...Z.d.d..
+00001300: 005a 0564 0664 0784 005a 0664 0864 0984  .Z.d.d...Z.d.d..
+00001310: 005a 0764 0a64 0b84 005a 0864 0c64 0d84  .Z.d.d...Z.d.d..
+00001320: 005a 0964 2564 0f64 1084 015a 0a64 1164  .Z.d%d.d...Z.d.d
+00001330: 1284 005a 0b64 1364 1484 005a 0c64 1564  ...Z.d.d...Z.d.d
+00001340: 1684 005a 0d64 1764 1884 005a 0e64 0e64  ...Z.d.d...Z.d.d
+00001350: 199c 0164 1a64 1b84 025a 0f64 1c64 1d84  ...d.d...Z.d.d..
+00001360: 005a 1064 1e64 1f84 005a 1164 2064 2184  .Z.d.d...Z.d d!.
+00001370: 005a 1264 2264 2384 005a 1364 2453 0029  .Z.d"d#..Z.d$S.)
+00001380: 2672 2000 0000 6122 0100 000a 2020 2020  &r ...a"....    
+00001390: 436c 6173 7320 746f 2063 6f6e 7374 7275  Class to constru
+000013a0: 6374 2061 6e64 2077 6f72 6b20 7769 7468  ct and work with
+000013b0: 2061 6e20 6f70 6572 6174 6f72 206f 6620   an operator of 
+000013c0: 7468 6520 666f 726d 2067 283a 783a 292e  the form g(:x:).
+000013d0: 0a20 2020 200a 2020 2020 5061 7261 6d65  .    .    Parame
+000013e0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+000013f0: 2d2d 2d0a 2020 2020 783a 2070 6f6c 790a  ---.    x: poly.
+00001400: 2020 2020 2020 2020 5468 6520 6675 6e63          The func
+00001410: 7469 6f6e 2069 6e20 7468 6520 6172 6775  tion in the argu
+00001420: 6d65 6e74 206f 6620 7468 6520 4c69 6520  ment of the Lie 
+00001430: 6f70 6572 6174 6f72 2e0a 2020 2020 0a20  operator..    . 
+00001440: 2020 202a 2a6b 7761 7267 730a 2020 2020     **kwargs.    
+00001450: 2020 2020 4f70 7469 6f6e 616c 2061 7267      Optional arg
+00001460: 756d 656e 7473 206d 6179 2062 6520 7061  uments may be pa
+00001470: 7373 6564 2074 6f20 7365 6c66 2e73 6574  ssed to self.set
+00001480: 5f67 656e 6572 6174 6f72 2061 6e64 2028  _generator and (
+00001490: 706f 7373 6962 6c65 2920 7365 6c66 2e63  possible) self.c
+000014a0: 616c 6346 6c6f 772e 0a20 2020 2063 0200  alcFlow..    c..
+000014b0: 0000 0000 0000 0000 0000 0300 0000 0400  ................
+000014c0: 0000 4b00 0000 735c 0000 0064 0164 0269  ..K...s\...d.d.i
+000014d0: 017c 005f 0069 007c 005f 0164 037c 005f  .|._.i.|._.d.|._
+000014e0: 0264 037c 006a 00a0 03a1 0069 017c 005f  .d.|.j.....i.|._
+000014f0: 047c 006a 057c 0166 0169 007c 02a4 018e  .|.j.|.f.i.|....
+00001500: 0101 0064 047c 02a0 06a1 0076 0072 2c7c  ...d.|.....v.r,|
+00001510: 006a 0764 0569 007c 02a4 018e 0101 0064  .j.d.i.|.......d
+00001520: 0053 0064 0053 0029 064e da01 7472 0300  .S.d.S.).N..tr..
+00001530: 0000 da0a 6272 7574 6566 6f72 6365 da09  ....bruteforce..
+00001540: 6765 6e65 7261 746f 7272 1300 0000 2908  generatorr....).
+00001550: da18 5f64 6566 6175 6c74 5f66 6c6f 775f  .._default_flow_
+00001560: 7061 7261 6d65 7465 7273 da05 5f66 6c6f  parameters.._flo
+00001570: 77da 0c5f 666c 6f77 5f6d 6574 686f 64da  w.._flow_method.
+00001580: 0463 6f70 79da 105f 666c 6f77 5f70 6172  .copy.._flow_par
+00001590: 616d 6574 6572 73da 0c73 6574 5f61 7267  ameters..set_arg
+000015a0: 756d 656e 74da 046b 6579 73da 0d73 6574  ument..keys..set
+000015b0: 5f67 656e 6572 6174 6f72 a903 7210 0000  _generator..r...
+000015c0: 00da 0861 7267 756d 656e 7472 1200 0000  ...argumentr....
+000015d0: 7213 0000 0072 1300 0000 7214 0000 00da  r....r....r.....
+000015e0: 085f 5f69 6e69 745f 5f9f 0000 0073 1000  .__init__....s..
+000015f0: 0000 0a01 0601 0603 1001 1202 0c01 1401  ................
+00001600: 04ff 7a14 6c69 656f 7065 7261 746f 722e  ..z.lieoperator.
+00001610: 5f5f 696e 6974 5f5f 6302 0000 0000 0000  __init__c.......
+00001620: 0000 0000 0003 0000 0003 0000 004b 0000  .............K..
+00001630: 0073 2600 0000 7400 7c01 7401 8302 7307  .s&...t.|.t...s.
+00001640: 4a00 8201 7c01 7c00 5f02 6401 7c00 6a02  J...|.|._.d.|.j.
+00001650: 6a03 1400 7c00 5f04 6400 5300 2902 4e72  j...|._.d.S.).Nr
+00001660: 1600 0000 2905 721f 0000 0072 0c00 0000  ....).r....r....
+00001670: 7248 0000 0072 1c00 0000 7217 0000 0072  rH...r....r....r
+00001680: 4700 0000 7213 0000 0072 1300 0000 7214  G...r....r....r.
+00001690: 0000 0072 4400 0000 ab00 0000 7306 0000  ...rD.......s...
+000016a0: 000e 0106 0112 017a 186c 6965 6f70 6572  .......z.lieoper
+000016b0: 6174 6f72 2e73 6574 5f61 7267 756d 656e  ator.set_argumen
+000016c0: 7463 0100 0000 0000 0000 0000 0000 0100  tc..............
+000016d0: 0000 0400 0000 4300 0000 7314 0000 007c  ......C...s....|
+000016e0: 006a 007c 006a 0119 00a0 0264 0164 02a1  .j.|.j.....d.d..
+000016f0: 0253 0029 037a 560a 2020 2020 2020 2020  .S.).zV.        
+00001700: 5265 7475 726e 2074 6865 2063 6f6d 706f  Return the compo
+00001710: 6e65 6e74 7320 7768 6963 6820 6861 7320  nents which has 
+00001720: 6265 656e 2073 6574 2069 6e20 7468 6520  been set in the 
+00001730: 6375 7272 656e 7420 666c 6f77 206d 6574  current flow met
+00001740: 686f 642e 0a20 2020 2020 2020 20da 0a63  hod..        ..c
+00001750: 6f6d 706f 6e65 6e74 734e 2903 7243 0000  omponentsN).rC..
+00001760: 0072 4100 0000 720e 0000 00a9 0172 1000  .rA...r......r..
+00001770: 0000 7213 0000 0072 1300 0000 7214 0000  ..r....r....r...
+00001780: 00da 0e67 6574 5f63 6f6d 706f 6e65 6e74  ...get_component
+00001790: 73b0 0000 0073 0200 0000 1404 7a1a 6c69  s....s......z.li
+000017a0: 656f 7065 7261 746f 722e 6765 745f 636f  eoperator.get_co
+000017b0: 6d70 6f6e 656e 7473 6301 0000 0000 0000  mponentsc.......
+000017c0: 0000 0000 0003 0000 0004 0000 004b 0000  .............K..
+000017d0: 0073 6200 0000 6401 7c01 a000 a100 7600  .sb...d.|.....v.
+000017e0: 7212 7c01 6401 1900 7c00 6a01 7c00 6a02  r.|.d...|.j.|.j.
+000017f0: 1900 6401 3c00 6404 5300 7c01 a003 6402  ..d.<.d.S.|...d.
+00001800: 7c00 6a04 6a05 a102 7d02 7c01 a003 6403  |.j.j...}.|...d.
+00001810: 7c00 6a04 6a06 a102 7d02 7407 6405 6900  |.j.j...}.t.d.i.
+00001820: 7c01 a401 8e01 7c00 6a01 7c00 6a02 1900  |.....|.j.|.j...
+00001830: 6401 3c00 6404 5300 2906 7a42 0a20 2020  d.<.d.S.).zB.   
+00001840: 2020 2020 2053 6574 2067 6976 656e 2063       Set given c
+00001850: 6f6d 706f 6e65 6e74 7320 746f 2074 6865  omponents to the
+00001860: 2063 7572 7265 6e74 2066 6c6f 7720 6d65   current flow me
+00001870: 7468 6f64 2e0a 2020 2020 2020 2020 724a  thod..        rJ
+00001880: 0000 0072 1c00 0000 720d 0000 004e 7213  ...r....r....Nr.
+00001890: 0000 0029 0872 4500 0000 7243 0000 0072  ...).rE...rC...r
+000018a0: 4100 0000 da0a 7365 7464 6566 6175 6c74  A.....setdefault
+000018b0: 7248 0000 0072 1c00 0000 720d 0000 0072  rH...r....r....r
+000018c0: 3b00 0000 2903 7210 0000 0072 1200 0000  ;...).r....r....
+000018d0: da01 5f72 1300 0000 7213 0000 0072 1400  .._r....r....r..
+000018e0: 0000 da0e 7365 745f 636f 6d70 6f6e 656e  ....set_componen
+000018f0: 7473 b600 0000 730a 0000 000c 0418 0110  ts....s.........
+00001900: 0210 011e 017a 1a6c 6965 6f70 6572 6174  .....z.lieoperat
+00001910: 6f72 2e73 6574 5f63 6f6d 706f 6e65 6e74  or.set_component
+00001920: 7363 0100 0000 0000 0000 0000 0000 0100  sc..............
+00001930: 0000 0500 0000 4300 0000 7316 0000 007c  ......C...s....|
+00001940: 006a 00a0 017c 006a 027c 006a 03a0 04a1  .j...|.j.|.j....
+00001950: 00a1 0253 0029 017a 490a 2020 2020 2020  ...S.).zI.      
+00001960: 2020 5265 7475 726e 2074 6865 2066 6c6f    Return the flo
+00001970: 7720 7061 7261 6d65 7465 7273 2066 6f72  w parameters for
+00001980: 2074 6865 2063 7572 7265 6e74 2066 6c6f   the current flo
+00001990: 7720 6d65 7468 6f64 2e0a 2020 2020 2020  w method..      
+000019a0: 2020 2905 7243 0000 0072 0e00 0000 7241    ).rC...r....rA
+000019b0: 0000 0072 3f00 0000 7242 0000 0072 4b00  ...r?...rB...rK.
+000019c0: 0000 7213 0000 0072 1300 0000 7214 0000  ..r....r....r...
+000019d0: 00da 1367 6574 5f66 6c6f 775f 7061 7261  ...get_flow_para
+000019e0: 6d65 7465 7273 c100 0000 7302 0000 0016  meters....s.....
+000019f0: 047a 1f6c 6965 6f70 6572 6174 6f72 2e67  .z.lieoperator.g
+00001a00: 6574 5f66 6c6f 775f 7061 7261 6d65 7465  et_flow_paramete
+00001a10: 7273 6302 0000 0000 0000 0000 0000 0003  rsc.............
+00001a20: 0000 0004 0000 004b 0000 0073 4a00 0000  .......K...sJ...
+00001a30: 7400 7c01 6401 8302 7209 7c01 7c00 5f01  t.|.d...r.|.|._.
+00001a40: 6e12 7400 7c01 6402 8302 7217 7c01 6406  n.t.|.d...r.|.d.
+00001a50: 6900 7c02 a401 8e01 7c00 5f01 6e04 7402  i.|.....|._.n.t.
+00001a60: 6403 8301 8201 7403 7c00 6a01 8301 6404  d.....t.|.j...d.
+00001a70: 1800 7c00 5f04 6405 5300 2907 61f8 0100  ..|._.d.S.).a...
+00001a80: 000a 2020 2020 2020 2020 4465 6669 6e65  ..        Define
+00001a90: 2074 6865 2067 656e 6572 6174 696e 6720   the generating 
+00001aa0: 7365 7269 6573 2066 6f72 2074 6865 2066  series for the f
+00001ab0: 756e 6374 696f 6e20 672e 0a20 2020 2020  unction g..     
+00001ac0: 2020 200a 2020 2020 2020 2020 5061 7261     .        Para
+00001ad0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+00001ae0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00001af0: 2020 6765 6e65 7261 746f 723a 2073 7562    generator: sub
+00001b00: 7363 7269 7074 6162 6c65 206f 7220 6361  scriptable or ca
+00001b10: 6c6c 6162 6c65 0a20 2020 2020 2020 2020  llable.         
+00001b20: 2020 2049 6620 7375 6273 6372 6970 7461     If subscripta
+00001b30: 626c 652c 2067 656e 6572 6174 6f72 5b6b  ble, generator[k
+00001b40: 5d20 3d3a 2061 5f6b 2064 6566 696e 6573  ] =: a_k defines
+00001b50: 2074 6865 2067 656e 6572 6174 696e 6720   the generating 
+00001b60: 7365 7269 6573 2066 6f72 2074 6865 2066  series for the f
+00001b70: 756e 6374 696f 6e0a 2020 2020 2020 2020  unction.        
+00001b80: 2020 2020 6720 736f 2074 6861 7420 7468      g so that th
+00001b90: 6520 4c69 6520 6f70 6572 6174 6f72 2063  e Lie operator c
+00001ba0: 6f72 7265 7370 6f6e 6473 2074 6f20 6728  orresponds to g(
+00001bb0: 3a78 3a29 2e0a 2020 2020 2020 2020 2020  :x:)..          
+00001bc0: 2020 0a20 2020 2020 2020 2020 2020 2067    .            g
+00001bd0: 287a 2920 3d20 7375 6d5f 6b20 615f 6b2a  (z) = sum_k a_k*
+00001be0: 7a2a 2a6b 2e0a 2020 2020 2020 2020 2020  z**k..          
+00001bf0: 2020 0a20 2020 2020 2020 2020 2020 2049    .            I
+00001c00: 6620 6720 6973 2061 2063 616c 6c61 626c  f g is a callabl
+00001c10: 6520 6f62 6a65 6374 2c20 7468 656e 2061  e object, then a
+00001c20: 6464 6974 696f 6e61 6c20 6172 6775 6d65  dditional argume
+00001c30: 6e74 7320 6172 6520 7061 7373 6564 2074  nts are passed t
+00001c40: 6f20 7468 6973 2063 616c 6c61 626c 6520  o this callable 
+00001c50: 746f 0a20 2020 2020 2020 2020 2020 2063  to.            c
+00001c60: 7265 6174 6520 7468 6520 615f 6b27 732e  reate the a_k's.
+00001c70: 0a20 2020 2020 2020 20da 085f 5f69 7465  .        ..__ite
+00001c80: 725f 5fda 085f 5f63 616c 6c5f 5f7a 1f49  r__..__call__z.I
+00001c90: 6e70 7574 2067 656e 6572 6174 6f72 206e  nput generator n
+00001ca0: 6f74 2072 6563 6f67 6e69 7a65 642e 7203  ot recognized.r.
+00001cb0: 0000 004e 7213 0000 0029 05da 0768 6173  ...Nr....)...has
+00001cc0: 6174 7472 723e 0000 00da 134e 6f74 496d  attrr>.....NotIm
+00001cd0: 706c 656d 656e 7465 6445 7272 6f72 da03  plementedError..
+00001ce0: 6c65 6eda 0570 6f77 6572 2903 7210 0000  len..power).r...
+00001cf0: 0072 3e00 0000 7212 0000 0072 1300 0000  .r>...r....r....
+00001d00: 7213 0000 0072 1400 0000 7246 0000 00c7  r....r....rF....
+00001d10: 0000 0073 0c00 0000 0a0f 0802 0a01 1201  ...s............
+00001d20: 0802 1401 7a19 6c69 656f 7065 7261 746f  ....z.lieoperato
+00001d30: 722e 7365 745f 6765 6e65 7261 746f 7246  r.set_generatorF
+00001d40: 6302 0000 0000 0000 0000 0000 0006 0000  c...............
+00001d50: 0004 0000 000b 0000 0073 de00 0000 7c02  .........s....|.
+00001d60: a000 6401 7c00 6a01 a102 7c00 5f01 7c00  ..d.|.j...|._.|.
+00001d70: a002 a100 7d03 7c01 7016 7c02 a003 a100  ....}.|.p.|.....
+00001d80: 7c03 a003 a100 6b01 0c00 7d01 6402 7c02  |.....k...}.d.|.
+00001d90: a004 a100 7600 7250 7c02 6402 1900 8900  ....v.rP|.d.....
+00001da0: 6402 7c03 a004 a100 7601 722e 8800 7c03  d.|.....v.r...|.
+00001db0: 6402 3c00 6403 7d01 6e22 7c03 6402 1900  d.<.d.}.n"|.d...
+00001dc0: 8901 7405 7406 8800 8301 7406 8801 8301  ..t.t.....t.....
+00001dd0: 6702 8301 7d04 7407 8700 8701 6602 6404  g...}.t.....f.d.
+00001de0: 6405 8408 7408 7c04 8301 4400 8301 8301  d...t.|...D.....
+00001df0: 7250 8800 7c03 6402 3c00 6403 7d01 7c01  rP..|.d.<.d.}.|.
+00001e00: 726d 7c03 a009 7c02 a101 0100 7c03 7c00  rm|...|.....|.|.
+00001e10: 6a0a 7c00 6a01 3c00 7c00 6a01 7c00 6a0b  j.|.j.<.|.j.|.j.
+00001e20: a004 a100 7600 726d 7c00 6a0b a00c 7c00  ....v.rm|.j...|.
+00001e30: 6a01 6406 a102 7d05 7c01 5300 2907 613e  j.d...}.|.S.).a>
+00001e40: 0100 000a 2020 2020 2020 2020 5570 6461  ....        Upda
+00001e50: 7465 2073 656c 662e 5f66 6c6f 775f 7061  te self._flow_pa
+00001e60: 7261 6d65 7465 7273 2069 6620 6e65 6365  rameters if nece
+00001e70: 7373 6172 793b 2072 6574 7572 6e20 626f  ssary; return bo
+00001e80: 6f6c 6561 6e20 6966 2074 6865 7920 6861  olean if they ha
+00001e90: 7665 2062 6565 6e20 7570 6461 7465 6420  ve been updated 
+00001ea0: 0a20 2020 2020 2020 2028 616e 6420 7468  .        (and th
+00001eb0: 6572 6566 6f72 6520 7365 6c66 2e66 6c6f  erefore self.flo
+00001ec0: 7720 6d61 7920 6861 7665 2074 6f20 6265  w may have to be
+00001ed0: 2072 652d 6361 6c63 756c 6174 6564 292e   re-calculated).
+00001ee0: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00001ef0: 2020 5468 6973 2069 6e74 6572 6e61 6c20    This internal 
+00001f00: 726f 7574 696e 6520 6973 2069 6e64 656e  routine is inden
+00001f10: 6465 6420 746f 2068 656c 7020 696e 2064  ded to help in d
+00001f20: 6574 6572 6d69 6e69 6e67 2077 6865 6e20  etermining when 
+00001f30: 746f 2072 652d 6361 6c63 756c 6174 650a  to re-calculate.
+00001f40: 2020 2020 2020 2020 7468 6520 666c 6f77          the flow
+00001f50: 2061 6e64 2074 6875 7320 7370 6565 6469   and thus speedi
+00001f60: 6e67 2075 7020 666c 6f77 2063 616c 6375  ng up flow calcu
+00001f70: 6c61 7469 6f6e 732e 0a20 2020 2020 2020  lations..       
+00001f80: 20da 066d 6574 686f 6472 4a00 0000 5463   ..methodrJ...Tc
+00001f90: 0100 0000 0000 0000 0000 0000 0200 0000  ................
+00001fa0: 0800 0000 1300 0000 7338 0000 0067 007c  ........s8...g.|
+00001fb0: 005d 187d 0174 0074 0188 017c 0164 0085  .].}.t.t...|.d..
+00001fc0: 0219 0083 0164 0083 0274 0074 0188 007c  .....d...t.t...|
+00001fd0: 0164 0085 0219 0083 0164 0083 026b 0391  .d.......d...k..
+00001fe0: 0271 0253 0072 1e00 0000 2902 da04 6e65  .q.S.r....)...ne
+00001ff0: 7874 da04 6974 6572 a902 7229 0000 0072  xt..iter..r)...r
+00002000: 2c00 0000 a902 724a 0000 005a 1263 7572  ,.....rJ...Z.cur
+00002010: 7265 6e74 5f63 6f6d 706f 6e65 6e74 7372  rent_componentsr
+00002020: 1300 0000 7214 0000 0072 2d00 0000 f300  ....r....r-.....
+00002030: 0000 7302 0000 0038 007a 376c 6965 6f70  ..s....8.z7lieop
+00002040: 6572 6174 6f72 2e5f 7570 6461 7465 5f66  erator._update_f
+00002050: 6c6f 775f 7061 7261 6d65 7465 7273 2e3c  low_parameters.<
+00002060: 6c6f 6361 6c73 3e2e 3c6c 6973 7463 6f6d  locals>.<listcom
+00002070: 703e 4e29 0d72 0e00 0000 7241 0000 0072  p>N).r....rA...r
+00002080: 5000 0000 da05 6974 656d 7372 4500 0000  P.....itemsrE...
+00002090: da03 6d61 7872 5500 0000 da03 616e 7972  ..maxrU.....anyr
+000020a0: 3200 0000 da06 7570 6461 7465 7243 0000  2.....updaterC..
+000020b0: 0072 4000 0000 da03 706f 7029 0672 1000  .r@.....pop).r..
+000020c0: 0000 725f 0000 0072 1200 0000 5a12 6375  ..r_...r....Z.cu
+000020d0: 7272 656e 745f 7061 7261 6d65 7465 7273  rrent_parameters
+000020e0: da01 6e72 4e00 0000 7213 0000 0072 5b00  ..nrN...r....r[.
+000020f0: 0000 7214 0000 00da 175f 7570 6461 7465  ..r......_update
+00002100: 5f66 6c6f 775f 7061 7261 6d65 7465 7273  _flow_parameters
+00002110: df00 0000 7326 0000 0010 0808 0116 010c  ....s&..........
+00002120: 0108 010c 0108 0106 0108 0214 021c 0108  ................
+00002130: 0104 0104 020a 010c 0110 0110 0204 017a  ...............z
+00002140: 236c 6965 6f70 6572 6174 6f72 2e5f 7570  #lieoperator._up
+00002150: 6461 7465 5f66 6c6f 775f 7061 7261 6d65  date_flow_parame
+00002160: 7465 7273 6301 0000 0000 0000 0000 0000  tersc...........
+00002170: 0004 0000 0004 0000 004b 0000 0073 6600  .........K...sf.
+00002180: 0000 7c01 a000 6401 7c00 6a01 a102 7c00  ..|...d.|.j...|.
+00002190: 5f01 7c00 6a02 6404 6900 7c01 a401 8e01  _.|.j.d.i.|.....
+000021a0: 7d02 7c02 731a 7c00 6a01 7c00 6a03 a004  }.|.s.|.j.|.j...
+000021b0: a100 7601 7228 7c01 a005 6401 6402 a102  ..v.r(|...d.d...
+000021c0: 7d03 7c00 6a06 6404 6900 7c01 a401 8e01  }.|.j.d.i.|.....
+000021d0: 0100 7c00 6a03 7c00 6a01 1900 6403 1900  ..|.j.|.j...d...
+000021e0: 7c00 5f07 6402 5300 2905 610d 0200 000a  |._.d.S.).a.....
+000021f0: 2020 2020 2020 2020 436f 6d70 7574 6520          Compute 
+00002200: 7468 6520 6675 6e63 7469 6f6e 2873 2920  the function(s) 
+00002210: 5b67 2874 3a78 3a29 5d79 2066 6f72 2061  [g(t:x:)]y for a
+00002220: 2067 6976 656e 2070 6172 616d 6574 6572   given parameter
+00002230: 2074 2c20 666f 7220 6576 6572 7920 7920   t, for every y 
+00002240: 696e 2073 656c 662e 636f 6d70 6f6e 656e  in self.componen
+00002250: 7473 2e0a 2020 2020 2020 2020 5468 6520  ts..        The 
+00002260: 7265 7375 6c74 2077 696c 6c20 6265 2077  result will be w
+00002270: 7269 7474 656e 2074 6f20 7365 6c66 2e66  ritten to self.f
+00002280: 6c6f 772e 0a20 2020 2020 2020 200a 2020  low..        .  
+00002290: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+000022a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000022b0: 2d2d 2d0a 2020 2020 2020 2020 6d65 7468  ---.        meth
+000022c0: 6f64 3a20 7374 722c 206f 7074 696f 6e61  od: str, optiona
+000022d0: 6c0a 2020 2020 2020 2020 2020 2020 5468  l.            Th
+000022e0: 6520 6d65 7468 6f64 2074 6f20 6265 2061  e method to be a
+000022f0: 7070 6c69 6564 2069 6e20 6361 6c63 756c  pplied in calcul
+00002300: 6174 696e 6720 7468 6520 666c 6f77 2e0a  ating the flow..
+00002310: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
+00002320: 2020 2020 2075 7064 6174 653a 2062 6f6f       update: boo
+00002330: 6c65 616e 2c20 6f70 7469 6f6e 616c 0a20  lean, optional. 
+00002340: 2020 2020 2020 2020 2020 2041 6e20 696e             An in
+00002350: 7465 726e 616c 2073 7769 7463 6820 746f  ternal switch to
+00002360: 2066 6f72 6365 2074 6865 2063 616c 6375   force the calcu
+00002370: 6c61 7469 6f6e 206f 6620 7468 6520 6375  lation of the cu
+00002380: 7272 656e 7420 666c 6f77 2028 6465 6661  rrent flow (defa
+00002390: 756c 743d 5472 7565 292e 0a20 2020 2020  ult=True)..     
+000023a0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+000023b0: 2a2a 6b77 6172 6773 0a20 2020 2020 2020  **kwargs.       
+000023c0: 2020 2020 204f 7074 696f 6e61 6c20 6172       Optional ar
+000023d0: 6775 6d65 6e74 7320 7061 7373 6564 2074  guments passed t
+000023e0: 6f20 666c 6f77 2073 7562 726f 7574 696e  o flow subroutin
+000023f0: 6573 2e0a 2020 2020 2020 2020 7257 0000  es..        rW..
+00002400: 004e da04 666c 6f77 7213 0000 0029 0872  .N..flowr....).r
+00002410: 0e00 0000 7241 0000 0072 6200 0000 7240  ....rA...rb...r@
+00002420: 0000 0072 4500 0000 7260 0000 00da 175f  ...rE...r`....._
+00002430: 6361 6c63 466c 6f77 4672 6f6d 5061 7261  calcFlowFromPara
+00002440: 6d65 7465 7273 7263 0000 0029 0472 1000  metersrc...).r..
+00002450: 0000 7212 0000 0072 5f00 0000 724e 0000  ..r....r_...rN..
+00002460: 0072 1300 0000 7213 0000 0072 1400 0000  .r....r....r....
+00002470: 720b 0000 00ff 0000 0073 0c00 0000 1010  r........s......
+00002480: 1001 1401 0c01 1001 1602 7a14 6c69 656f  ..........z.lieo
+00002490: 7065 7261 746f 722e 6361 6c63 466c 6f77  perator.calcFlow
+000024a0: 6301 0000 0000 0000 0000 0000 0003 0000  c...............
+000024b0: 0004 0000 004b 0000 0073 5400 0000 7c00  .....K...sT...|.
+000024c0: 6a00 6401 6b02 7221 7c00 a001 a100 7d02  j.d.k.r!|.....}.
+000024d0: 6402 7c02 a002 a100 7601 7217 7c00 6a03  d.|.....v.r.|.j.
+000024e0: 6405 6900 7c01 a401 8e01 0100 7c00 6a04  d.i.|.......|.j.
+000024f0: 6405 6900 7c01 a401 8e01 0100 6400 5300  d.i.|.......d.S.
+00002500: 7405 6403 7c00 6a00 9b00 6404 9d03 8301  t.d.|.j...d.....
+00002510: 8201 2906 4e72 3d00 0000 724a 0000 007a  ..).Nr=...rJ...z
+00002520: 086d 6574 686f 6420 277a 1127 206e 6f74  .method 'z.' not
+00002530: 2072 6563 6f67 6e69 7a65 642e 7213 0000   recognized.r...
+00002540: 0029 0672 4100 0000 7250 0000 0072 4500  .).rA...rP...rE.
+00002550: 0000 724f 0000 00da 145f 6361 6c63 466c  ..rO....._calcFl
+00002560: 6f77 5f62 7275 7465 666f 7263 6572 5400  ow_bruteforcerT.
+00002570: 0000 2903 7210 0000 0072 1200 0000 5a0f  ..).r....r....Z.
+00002580: 666c 6f77 5f70 6172 616d 6574 6572 7372  flow_parametersr
+00002590: 1300 0000 7213 0000 0072 1400 0000 7264  ....r....r....rd
+000025a0: 0000 0017 0100 0073 0c00 0000 0a01 0801  .......s........
+000025b0: 0c01 1001 1401 1202 7a23 6c69 656f 7065  ........z#lieope
+000025c0: 7261 746f 722e 5f63 616c 6346 6c6f 7746  rator._calcFlowF
+000025d0: 726f 6d50 6172 616d 6574 6572 7363 0100  romParametersc..
+000025e0: 0000 0000 0000 0000 0000 0300 0000 0400  ................
+000025f0: 0000 0b00 0000 733c 0000 0069 007d 0274  ......s<...i.}.t
+00002600: 0064 0764 017c 0069 017c 01a4 018e 0189  .d.d.|.i.|......
+00002610: 0087 0066 0164 0264 0384 087c 0264 043c  ...f.d.d...|.d.<
+00002620: 0088 007c 0264 053c 007c 027c 006a 0164  ...|.d.<.|.|.j.d
+00002630: 063c 0064 0053 0029 084e 721d 0000 0063  .<.d.S.).Nr....c
+00002640: 0000 0000 0000 0000 0000 0000 0100 0000  ................
+00002650: 0400 0000 1700 0000 f31c 0000 0087 0187  ................
+00002660: 0066 0264 0164 0284 0874 0074 0188 0183  .f.d.d...t.t....
+00002670: 0183 0144 0083 0153 0029 034e 6301 0000  ...D...S.).Nc...
+00002680: 0000 0000 0000 0000 0002 0000 0004 0000  ................
+00002690: 0013 0000 00f3 1800 0000 6700 7c00 5d08  ..........g.|.].
+000026a0: 7d01 8800 7c01 1900 8801 8e00 9102 7102  }...|.........q.
+000026b0: 5300 7213 0000 0072 1300 0000 725a 0000  S.r....r....rZ..
+000026c0: 00a9 02da 1066 696e 616c 5f63 6f6d 706f  .....final_compo
+000026d0: 6e65 6e74 73da 017a 7213 0000 0072 1400  nents..zr....r..
+000026e0: 0000 722d 0000 0024 0100 00f3 0200 0000  ..r-...$........
+000026f0: 1800 7a46 6c69 656f 7065 7261 746f 722e  ..zFlieoperator.
+00002700: 5f63 616c 6346 6c6f 775f 6272 7574 6566  _calcFlow_brutef
+00002710: 6f72 6365 2e3c 6c6f 6361 6c73 3e2e 3c6c  orce.<locals>.<l
+00002720: 616d 6264 613e 2e3c 6c6f 6361 6c73 3e2e  ambda>.<locals>.
+00002730: 3c6c 6973 7463 6f6d 703e a902 7232 0000  <listcomp>..r2..
+00002740: 0072 5500 0000 a901 726a 0000 00a9 0172  .rU.....rj.....r
+00002750: 6900 0000 726d 0000 0072 1400 0000 da08  i...rm...r......
+00002760: 3c6c 616d 6264 613e 2401 0000 722e 0000  <lambda>$...r...
+00002770: 007a 326c 6965 6f70 6572 6174 6f72 2e5f  .z2lieoperator._
+00002780: 6361 6c63 466c 6f77 5f62 7275 7465 666f  calcFlow_brutefo
+00002790: 7263 652e 3c6c 6f63 616c 733e 2e3c 6c61  rce.<locals>.<la
+000027a0: 6d62 6461 3e72 6300 0000 da0a 7461 796c  mbda>rc.....tayl
+000027b0: 6f72 5f6d 6170 723d 0000 0072 1300 0000  or_mapr=...r....
+000027c0: 2902 da0a 4246 6361 6c63 466c 6f77 7240  )...BFcalcFlowr@
+000027d0: 0000 00a9 0372 1000 0000 7212 0000 00da  .....r....r.....
+000027e0: 0672 6573 756c 7472 1300 0000 726e 0000  .resultr....rn..
+000027f0: 0072 1400 0000 7265 0000 0020 0100 0073  .r....re... ...s
+00002800: 0a00 0000 0402 1201 1001 0801 0e01 7a20  ..............z 
+00002810: 6c69 656f 7065 7261 746f 722e 5f63 616c  lieoperator._cal
+00002820: 6346 6c6f 775f 6272 7574 6566 6f72 6365  cFlow_bruteforce
+00002830: 6301 0000 0000 0000 0000 0000 0003 0000  c...............
+00002840: 0004 0000 004b 0000 0073 3600 0000 7c00  .....K...s6...|.
+00002850: 6a00 a001 7c00 6a02 6900 a102 7d02 6401  j...|.j.i...}.d.
+00002860: 7c02 a003 a100 7600 7212 7c02 6401 1900  |.....v.r.|.d...
+00002870: 5300 7404 6402 7c00 6a02 9b00 6403 9d03  S.t.d.|.j...d...
+00002880: 8301 8201 2904 7a92 0a20 2020 2020 2020  ....).z..       
+00002890: 2049 6620 7365 6c66 2e66 6c6f 7720 6861   If self.flow ha
+000028a0: 7320 6265 656e 2063 6f6d 7075 7465 642c  s been computed,
+000028b0: 2063 6f6d 7075 7465 2028 6f72 2072 6574   compute (or ret
+000028c0: 7572 6e29 2074 6865 2072 6573 756c 7469  urn) the resulti
+000028d0: 6e67 2070 6f6c 796e 6f6d 6961 6c20 6728  ng polynomial g(
+000028e0: 3a78 3a29 3a79 3a2c 200a 2020 2020 2020  :x:):y:, .      
+000028f0: 2020 666f 7220 6576 6572 7920 7920 696e    for every y in
+00002900: 2073 656c 662e 636f 6d70 6f6e 656e 7473   self.components
+00002910: 2e0a 2020 2020 2020 2020 7270 0000 007a  ..        rp...z
+00002920: 2450 6f6c 796e 6f6d 6961 6c20 6170 7072  $Polynomial appr
+00002930: 6f78 696d 6174 696f 6e20 6f66 206d 6574  oximation of met
+00002940: 686f 6420 277a 2f27 2063 616e 206e 6f74  hod 'z/' can not
+00002950: 2062 6520 666f 756e 6420 696e 206f 7574   be found in out
+00002960: 7075 7420 6469 6374 2027 7365 6c66 2e5f  put dict 'self._
+00002970: 666c 6f77 272e 2905 7240 0000 0072 0e00  flow'.).r@...r..
+00002980: 0000 7241 0000 0072 4500 0000 da0c 5275  ..rA...rE.....Ru
+00002990: 6e74 696d 6545 7272 6f72 7272 0000 0072  ntimeErrorrr...r
+000029a0: 1300 0000 7213 0000 0072 1400 0000 da11  ....r....r......
+000029b0: 5f63 616c 6350 6f6c 7946 726f 6d46 6c6f  _calcPolyFromFlo
+000029c0: 7728 0100 0073 0800 0000 1005 0c01 0801  w(...s..........
+000029d0: 1202 7a1d 6c69 656f 7065 7261 746f 722e  ..z.lieoperator.
+000029e0: 5f63 616c 6350 6f6c 7946 726f 6d46 6c6f  _calcPolyFromFlo
+000029f0: 7729 01da 056f 7574 6c31 6301 0000 0000  w)...outl1c.....
+00002a00: 0000 0001 0000 0005 0000 0004 0000 000f  ................
+00002a10: 0000 0073 8600 0000 7400 8800 6401 1900  ...s....t...d...
+00002a20: 7401 8302 7236 7402 8700 6601 6402 6403  t...r6t...f.d.d.
+00002a30: 8408 8800 4400 8301 8301 7316 4a00 6404  ....D.....s.J.d.
+00002a40: 8301 8201 7c00 6a03 6408 6405 8800 6901  ....|.j.d.d...i.
+00002a50: 7c03 a401 8e01 0100 7c00 6a04 6408 6900  |.......|.j.d.i.
+00002a60: 7c03 a401 8e01 7d04 7405 7c04 8301 6406  |.....}.t.|...d.
+00002a70: 6b02 7234 7c01 7334 7c04 6401 1900 7d04  k.r4|.s4|.d...}.
+00002a80: 7c04 5300 7c00 6a03 6408 6900 7c03 a401  |.S.|.j.d.i.|...
+00002a90: 8e01 0100 7c00 6a06 8800 8e00 5300 2909  ....|.j.....S.).
+00002aa0: 6165 0400 000a 2020 2020 2020 2020 436f  ae....        Co
+00002ab0: 6d70 7574 6520 7468 6520 7265 7375 6c74  mpute the result
+00002ac0: 206f 6620 7468 6520 6375 7272 656e 7420   of the current 
+00002ad0: 4c69 6520 6f70 6572 6174 6f72 2067 283a  Lie operator g(:
+00002ae0: 783a 292c 2061 7070 6c69 6564 2074 6f20  x:), applied to 
+00002af0: 6569 7468 6572 200a 2020 2020 2020 2020  either .        
+00002b00: 3129 2061 2073 7065 6369 6669 6320 706f  1) a specific po
+00002b10: 696e 740a 2020 2020 2020 2020 3229 2061  int.        2) a
+00002b20: 6e6f 7468 6572 204c 6965 2070 6f6c 796e  nother Lie polyn
+00002b30: 6f6d 6961 6c0a 2020 2020 2020 2020 0a20  omial.        . 
+00002b40: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00002b50: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00002b60: 2d2d 2d2d 0a20 2020 2020 2020 207a 3a20  ----.        z: 
+00002b70: 7375 6273 6372 6970 7461 626c 6520 6f72  subscriptable or
+00002b80: 2070 6f6c 7920 6f72 206c 6965 6f70 6572   poly or lieoper
+00002b90: 6174 6f72 0a20 2020 2020 2020 2020 2020  ator.           
+00002ba0: 200a 2020 2020 2020 2020 6f75 746c 313a   .        outl1:
+00002bb0: 2062 6f6f 6c65 616e 2c20 6f70 7469 6f6e   boolean, option
+00002bc0: 616c 0a20 2020 2020 2020 2020 2020 2044  al.            D
+00002bd0: 6574 6572 6d69 6e65 2074 6865 206f 7574  etermine the out
+00002be0: 7075 7420 666f 726d 6174 2069 6e20 6361  put format in ca
+00002bf0: 7365 2074 6865 206f 7574 7075 7420 776f  se the output wo
+00002c00: 756c 6420 6265 2061 2073 696e 676c 6520  uld be a single 
+00002c10: 4c69 6520 706f 6c79 6e6f 6d69 616c 2e0a  Lie polynomial..
+00002c20: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+00002c30: 6465 6661 756c 7420 6265 6861 7669 6f72  default behavior
+00002c40: 2069 7320 746f 2072 6574 7572 6e20 6120   is to return a 
+00002c50: 7369 6e67 6c65 2065 6c65 6d65 6e74 2e20  single element. 
+00002c60: 4966 2061 206c 6973 7420 6f66 206c 656e  If a list of len
+00002c70: 6774 6820 3120 7368 6f75 6c64 2062 6520  gth 1 should be 
+00002c80: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
+00002c90: 2020 2020 2069 6e73 7465 6164 2c20 6368       instead, ch
+00002ca0: 616e 6765 2074 6869 7320 7061 7261 6d65  ange this parame
+00002cb0: 7465 7220 746f 2054 7275 652e 0a20 2020  ter to True..   
+00002cc0: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+00002cd0: 2020 2a2a 6b77 6172 6773 0a20 2020 2020    **kwargs.     
+00002ce0: 2020 2020 2020 204f 7074 696f 6e61 6c20         Optional 
+00002cf0: 6172 6775 6d65 6e74 7320 7061 7373 6564  arguments passed
+00002d00: 2074 6f20 7365 6c66 2e63 616c 6346 6c6f   to self.calcFlo
+00002d10: 772e 204e 6f74 6520 7468 6174 2069 6620  w. Note that if 
+00002d20: 616e 2061 6464 6974 696f 6e61 6c20 7061  an additional pa
+00002d30: 7261 6d65 7465 7220 7420 6973 2070 6173  rameter t is pas
+00002d40: 7365 642c 200a 2020 2020 2020 2020 2020  sed, .          
+00002d50: 2020 7468 656e 2074 6865 2072 6573 7065    then the respe
+00002d60: 6374 6976 6520 7265 7375 6c74 7320 666f  ctive results fo
+00002d70: 7220 6728 742a 3a78 3a29 2061 7265 2063  r g(t*:x:) are c
+00002d80: 616c 6375 6c61 7465 642e 0a20 2020 2020  alculated..     
+00002d90: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00002da0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+00002db0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00002dc0: 6c69 7374 206f 7220 706f 6c79 206f 7220  list or poly or 
+00002dd0: 6c69 656f 7065 7261 746f 720a 2020 2020  lieoperator.    
+00002de0: 2020 2020 2020 2020 3129 2049 6620 7a20          1) If z 
+00002df0: 6973 2061 206c 6973 742c 2074 6865 6e20  is a list, then 
+00002e00: 7468 6520 7661 6c75 6573 2028 6728 3a78  the values (g(:x
+00002e10: 3a29 7929 287a 2920 666f 7220 7468 6520  :)y)(z) for the 
+00002e20: 6375 7272 656e 7420 706f 6c79 2065 6c65  current poly ele
+00002e30: 6d65 6e74 7320 7920 696e 2073 656c 662e  ments y in self.
+00002e40: 636f 6d70 6f6e 656e 7473 0a20 2020 2020  components.     
+00002e50: 2020 2020 2020 2061 7265 2072 6574 7572         are retur
+00002e60: 6e65 6420 2873 6565 2073 656c 662e 6576  ned (see self.ev
+00002e70: 616c 7561 7465 292e 0a20 2020 2020 2020  aluate)..       
+00002e80: 2020 2020 2032 2920 4966 207a 2069 7320       2) If z is 
+00002e90: 6120 4c69 6520 706f 6c79 6e6f 6d69 616c  a Lie polynomial
+00002ea0: 2c20 7468 656e 2074 6865 206f 7262 6974  , then the orbit
+00002eb0: 206f 6620 6728 3a78 3a29 7a20 7769 6c6c   of g(:x:)z will
+00002ec0: 2062 6520 636f 6d70 7574 6564 2061 6e64   be computed and
+00002ed0: 2074 6865 2066 6c6f 7720 7265 7475 726e   the flow return
+00002ee0: 6564 2061 7320 0a20 2020 2020 2020 2020  ed as .         
+00002ef0: 2020 2020 2020 706f 6c79 2063 6c61 7373        poly class
+00002f00: 2e0a 2020 2020 2020 2020 7201 0000 0063  ..        r....c
+00002f10: 0100 0000 0000 0000 0000 0000 0200 0000  ................
+00002f20: 0500 0000 1300 0000 731c 0000 0067 007c  ........s....g.|
+00002f30: 005d 0a7d 017c 016a 0088 0064 0019 006a  .].}.|.j...d...j
+00002f40: 006b 0291 0271 0253 00a9 0172 0100 0000  .k...q.S...r....
+00002f50: 2901 721c 0000 0029 0272 2900 0000 da01  ).r....).r).....
+00002f60: 7072 6d00 0000 7213 0000 0072 1400 0000  prm...r....r....
+00002f70: 722d 0000 004f 0100 0072 2e00 0000 7a28  r-...O...r....z(
+00002f80: 6c69 656f 7065 7261 746f 722e 5f5f 6361  lieoperator.__ca
+00002f90: 6c6c 5f5f 2e3c 6c6f 6361 6c73 3e2e 3c6c  ll__.<locals>.<l
+00002fa0: 6973 7463 6f6d 703e 7a24 4172 6775 6d65  istcomp>z$Argume
+00002fb0: 6e74 7320 6861 7665 2064 6966 6665 7265  nts have differe
+00002fc0: 6e74 2064 696d 656e 7369 6f6e 732e 724a  nt dimensions.rJ
+00002fd0: 0000 0072 0300 0000 4e72 1300 0000 2907  ...r....Nr....).
+00002fe0: 721f 0000 0072 0c00 0000 da03 616c 6c72  r....r......allr
+00002ff0: 0b00 0000 7275 0000 0072 5500 0000 7263  ....ru...rU...rc
+00003000: 0000 0029 0572 1000 0000 7276 0000 0072  ...).r....rv...r
+00003010: 6a00 0000 7212 0000 0072 7300 0000 7213  j...r....rs...r.
+00003020: 0000 0072 6d00 0000 7214 0000 0072 5200  ...rm...r....rR.
+00003030: 0000 3301 0000 7312 0000 000e 1b1e 0114  ..3...s.........
+00003040: 0110 0110 0108 0104 0110 020a 017a 146c  .............z.l
+00003050: 6965 6f70 6572 6174 6f72 2e5f 5f63 616c  ieoperator.__cal
+00003060: 6c5f 5f63 0200 0000 0000 0000 0000 0000  l__c............
+00003070: 0200 0000 0400 0000 4300 0000 7326 0000  ........C...s&..
+00003080: 0074 007c 0174 0183 0272 097c 007c 0183  .t.|.t...r.|.|..
+00003090: 0153 0074 0264 017c 016a 036a 049b 0064  .S.t.d.|.j.j...d
+000030a0: 029d 0383 0182 0129 034e 7a12 4f70 6572  .......).Nz.Oper
+000030b0: 6174 696f 6e20 6f6e 2074 7970 6520 7a0f  ation on type z.
+000030c0: 206e 6f74 2073 7570 706f 7274 6564 2e29   not supported.)
+000030d0: 0572 1f00 0000 720c 0000 0072 5400 0000  .r....r....rT...
+000030e0: da09 5f5f 636c 6173 735f 5f72 2500 0000  ..__class__r%...
+000030f0: 7222 0000 0072 1300 0000 7213 0000 0072  r"...r....r....r
+00003100: 1400 0000 7221 0000 0059 0100 0073 0600  ....r!...Y...s..
+00003110: 0000 0a01 0801 1402 7a16 6c69 656f 7065  ........z.lieope
+00003120: 7261 746f 722e 5f5f 6d61 746d 756c 5f5f  rator.__matmul__
+00003130: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
+00003140: 0005 0000 0043 0000 0073 2400 0000 7c00  .....C...s$...|.
+00003150: a000 7c00 6a01 a101 7d01 7c01 6a02 a003  ..|.j...}.|.j...
+00003160: 7404 a005 7c00 6a02 a101 a101 0100 7c01  t...|.j.......|.
+00003170: 5300 2901 7aa8 0a20 2020 2020 2020 2043  S.).z..        C
+00003180: 7265 6174 6520 6120 636f 7079 206f 6620  reate a copy of 
+00003190: 7468 6520 6375 7272 656e 7420 4c69 6520  the current Lie 
+000031a0: 6f70 6572 6174 6f72 0a20 2020 2020 2020  operator.       
+000031b0: 200a 2020 2020 2020 2020 5265 7475 726e   .        Return
+000031c0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+000031d0: 2d0a 2020 2020 2020 2020 6c69 656f 7065  -.        lieope
+000031e0: 7261 746f 720a 2020 2020 2020 2020 2020  rator.          
+000031f0: 2020 4120 636f 7079 206f 6620 7468 6520    A copy of the 
+00003200: 6375 7272 656e 7420 4c69 6520 6f70 6572  current Lie oper
+00003210: 6174 6f72 2e0a 2020 2020 2020 2020 2906  ator..        ).
+00003220: 727a 0000 0072 4800 0000 da08 5f5f 6469  rz...rH.....__di
+00003230: 6374 5f5f 725f 0000 0072 4200 0000 da08  ct__r_...rB.....
+00003240: 6465 6570 636f 7079 2902 7210 0000 00da  deepcopy).r.....
+00003250: 036f 7574 7213 0000 0072 1300 0000 7214  .outr....r....r.
+00003260: 0000 0072 4200 0000 5f01 0000 7306 0000  ...rB..._...s...
+00003270: 000c 0914 0104 017a 106c 6965 6f70 6572  .......z.lieoper
+00003280: 6174 6f72 2e63 6f70 7963 0100 0000 0000  ator.copyc......
+00003290: 0000 0000 0000 0400 0000 0600 0000 4f00  ..............O.
+000032a0: 0000 73c6 0000 0074 007c 0064 0183 0273  ..s....t.|.d...s
+000032b0: 177a 0a7c 006a 0164 0d69 007c 02a4 018e  .z.|.j.d.i.|....
+000032c0: 0101 0057 006e 0701 0001 0001 0074 0264  ...W.n.......t.d
+000032d0: 0283 0182 0164 037c 02a0 03a1 0076 0072  .....d.|.....v.r
+000032e0: 227c 0264 0319 007d 036e 2c7c 006a 04a0  "|.d...}.n,|.j..
+000032f0: 05a1 0064 046b 0172 2c64 057d 036e 227c  ...d.k.r,d.}.n"|
+00003300: 02a0 0664 0664 07a1 0272 3774 07a0 0864  ...d.d...r7t...d
+00003310: 08a1 0101 007c 006a 046a 0974 0a6a 0b6b  .....|.j.j.t.j.k
+00003320: 0073 484a 0064 097c 006a 0c6a 0d9b 0064  .sHJ.d.|.j.j...d
+00003330: 0a9d 0383 0182 017c 006a 046a 0964 0517  .......|.j.j.d..
+00003340: 007d 037c 037c 0264 033c 0074 0e6a 0f6a  .}.|.|.d.<.t.j.j
+00003350: 106a 117c 0066 0164 0b7c 0169 017c 02a4  .j.|.f.d.|.i.|..
+00003360: 018e 017c 005f 127c 006a 1253 0029 0e61  ...|._.|.j.S.).a
+00003370: 8401 0000 0a20 2020 2020 2020 2050 6173  .....        Pas
+00003380: 7320 6e2d 6a65 7473 2074 6872 6f75 6768  s n-jets through
+00003390: 2074 6865 2066 6c6f 7720 6675 6e63 7469   the flow functi
+000033a0: 6f6e 2c20 6769 7665 6e20 6279 2074 6865  on, given by the
+000033b0: 2063 7572 7265 6e74 204c 6965 206f 7065   current Lie ope
+000033c0: 7261 746f 722e 0a20 2020 2020 2020 200a  rator..        .
+000033d0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+000033e0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+000033f0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 2a70  -----.        *p
+00003400: 6f73 6974 696f 6e3a 2066 6c6f 6174 206f  osition: float o
+00003410: 7220 6172 7261 792c 206f 7074 696f 6e61  r array, optiona
+00003420: 6c0a 2020 2020 2020 2020 2020 2020 416e  l.            An
+00003430: 206f 7074 696f 6e61 6c20 706f 696e 7420   optional point 
+00003440: 6f66 2072 6566 6572 656e 6365 2e20 4279  of reference. By
+00003450: 2064 6566 6175 6c74 2074 6865 2070 6f73   default the pos
+00003460: 6974 696f 6e20 7769 6c6c 2062 6520 7468  ition will be th
+00003470: 6520 6f72 6967 696e 2e0a 2020 2020 2020  e origin..      
+00003480: 2020 2020 2020 2020 2020 2020 2020 0a20                . 
+00003490: 2020 2020 2020 206f 7264 6572 3a20 696e         order: in
+000034a0: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
+000034b0: 2020 2020 2020 2020 5468 6520 6e75 6d62          The numb
+000034c0: 6572 206f 6620 6465 7269 7661 7469 7665  er of derivative
+000034d0: 7320 7765 2077 616e 7420 746f 2074 616b  s we want to tak
+000034e0: 6520 696e 746f 2061 6363 6f75 6e74 2e0a  e into account..
+000034f0: 2020 2020 2020 2020 7263 0000 007a 1e46          rc...z.F
+00003500: 6c6f 7720 6861 7320 746f 2062 6520 636f  low has to be co
+00003510: 6d70 7574 6564 2066 6972 7374 2e72 1500  mputed first.r..
+00003520: 0000 7216 0000 0072 0300 0000 da04 7761  ..r....r......wa
+00003530: 726e 467a 564e 6f20 6f72 6465 7220 7072  rnFzVNo order pr
+00003540: 6f76 6964 6564 2066 6f72 2054 5053 4120  ovided for TPSA 
+00003550: 6361 6c63 756c 6174 696f 6e2e 2041 7474  calculation. Att
+00003560: 656d 7074 696e 6720 746f 2073 6574 206f  empting to set o
+00003570: 7264 6572 2062 6173 6564 206f 6e20 6d61  rder based on ma
+00003580: 785f 706f 7765 7220 2e2e 2e7a 0d6d 6178  x_power ...z.max
+00003590: 5f70 6f77 6572 206f 6620 7a1e 2e61 7267  _power of z..arg
+000035a0: 756d 656e 7420 6361 6e20 6e6f 7420 6265  ument can not be
+000035b0: 2069 6e66 696e 6974 652e da08 706f 7369   infinite...posi
+000035c0: 7469 6f6e 4e72 1300 0000 2913 7253 0000  tionNr....).rS..
+000035d0: 0072 0b00 0000 7274 0000 0072 4500 0000  .r....rt...rE...
+000035e0: 7248 0000 00da 066d 6178 6465 6772 0e00  rH.....maxdegr..
+000035f0: 0000 da08 7761 726e 696e 6773 727e 0000  ....warningsr~..
+00003600: 0072 0d00 0000 7234 0000 00da 0369 6e66  .r....r4.....inf
+00003610: 727a 0000 0072 2500 0000 7218 0000 0072  rz...r%...r....r
+00003620: 1900 0000 da05 746f 6f6c 73da 0474 7073  ......tools..tps
+00003630: 61da 055f 7470 7361 2904 7210 0000 0072  a.._tpsa).r....r
+00003640: 7f00 0000 7212 0000 0072 1500 0000 7213  ....r....r....r.
+00003650: 0000 0072 1300 0000 7214 0000 0072 8400  ...r....r....r..
+00003660: 0000 6c01 0000 7320 0000 000a 0c02 0114  ..l...s ........
+00003670: 0106 0108 010c 030a 010e 0106 010c 020a  ................
+00003680: 0122 010c 0108 011c 0306 017a 106c 6965  .".........z.lie
+00003690: 6f70 6572 6174 6f72 2e74 7073 6163 0100  operator.tpsac..
+000036a0: 0000 0000 0000 0000 0000 0200 0000 0700  ................
+000036b0: 0000 4b00 0000 733c 0000 0074 007c 0064  ..K...s<...t.|.d
+000036c0: 0183 0273 094a 0064 0283 0182 0174 016a  ...s.J.d.....t.j
+000036d0: 026a 036a 047c 006a 056a 067c 006a 076a  .j.j.|.j.j.|.j.j
+000036e0: 087c 01a0 0964 037c 006a 076a 0aa1 0264  .|...d.|.j.j...d
+000036f0: 049c 028e 0153 0029 057a 8d0a 2020 2020  .....S.).z..    
+00003700: 2020 2020 5265 7475 726e 2074 6865 2054      Return the T
+00003710: 6179 6c6f 7220 6d61 7020 6672 6f6d 2061  aylor map from a
+00003720: 2067 6976 656e 2054 5053 4120 6576 616c   given TPSA eval
+00003730: 7561 7469 6f6e 2c20 7573 696e 6720 7468  uation, using th
+00003740: 650a 2020 2020 2020 2020 6469 6d65 6e73  e.        dimens
+00003750: 696f 6e6e 2061 6e64 206d 6178 5f70 6f77  ionn and max_pow
+00003760: 6572 206f 6620 7468 6520 6375 7272 656e  er of the curren
+00003770: 7420 4c69 652d 6f70 6572 6174 6f72 2e0a  t Lie-operator..
+00003780: 2020 2020 2020 2020 7285 0000 007a 2554          r....z%T
+00003790: 5053 4120 6361 6c63 756c 6174 696f 6e20  PSA calculation 
+000037a0: 7265 7175 6972 6564 2069 6e20 6164 7661  required in adva
+000037b0: 6e63 652e 720d 0000 00a9 0272 1c00 0000  nce.r......r....
+000037c0: 720d 0000 0029 0b72 5300 0000 7218 0000  r....).rS...r...
+000037d0: 0072 1900 0000 7283 0000 0072 7000 0000  .r....r....rp...
+000037e0: 7285 0000 00da 0b5f 6576 616c 7561 7469  r......_evaluati
+000037f0: 6f6e 7248 0000 0072 1c00 0000 720e 0000  onrH...r....r...
+00003800: 0072 0d00 0000 a902 7210 0000 0072 1200  .r......r....r..
+00003810: 0000 7213 0000 0072 1300 0000 7214 0000  ..r....r....r...
+00003820: 0072 7000 0000 8e01 0000 7304 0000 0012  .rp.......s.....
+00003830: 052a 017a 166c 6965 6f70 6572 6174 6f72  .*.z.lieoperator
+00003840: 2e74 6179 6c6f 725f 6d61 704e a901 4629  .taylor_mapN..F)
+00003850: 1472 2500 0000 7226 0000 0072 2700 0000  .r%...r&...r'...
+00003860: da07 5f5f 646f 635f 5f72 4900 0000 7244  ..__doc__rI...rD
+00003870: 0000 0072 4c00 0000 724f 0000 0072 5000  ...rL...rO...rP.
+00003880: 0000 7246 0000 0072 6200 0000 720b 0000  ..rF...rb...r...
+00003890: 0072 6400 0000 7265 0000 0072 7500 0000  .rd...re...ru...
+000038a0: 7252 0000 0072 2100 0000 7242 0000 0072  rR...r!...rB...r
+000038b0: 8400 0000 7270 0000 0072 1300 0000 7213  ....rp...r....r.
+000038c0: 0000 0072 1300 0000 7214 0000 0072 2000  ...r....r....r .
+000038d0: 0000 9300 0000 7324 0000 0008 0004 0108  ......s$........
+000038e0: 0b08 0c08 0508 0608 0b08 060a 1808 2008  .............. .
+000038f0: 1808 0908 080e 0b08 2608 0608 0d0c 2272  ........&....."r
+00003900: 2000 0000 6300 0000 0000 0000 0000 0000   ...c...........
+00003910: 0000 0000 0004 0000 0040 0000 0073 9a00  .........@...s..
+00003920: 0000 6500 5a01 6400 5a02 6401 6402 8400  ..e.Z.d.Z.d.d...
+00003930: 5a03 6403 6404 8400 5a04 6405 6406 8400  Z.d.d...Z.d.d...
+00003940: 5a05 6407 6408 8400 5a06 6409 640a 8400  Z.d.d...Z.d.d...
+00003950: 5a07 640b 640c 8400 5a08 6426 640e 640f  Z.d.d...Z.d&d.d.
+00003960: 8401 5a09 6410 6411 8400 5a0a 6426 6412  ..Z.d.d...Z.d&d.
+00003970: 6413 8401 5a0b 6414 6415 8400 5a0c 6416  d...Z.d.d...Z.d.
+00003980: 6417 8400 5a0d 6427 6419 650e 6602 641a  d...Z.d'd.e.f.d.
+00003990: 641b 8405 5a0f 641c 641d 8400 5a10 641e  d...Z.d.d...Z.d.
+000039a0: 641f 8400 5a11 6420 6421 8400 5a12 6428  d...Z.d d!..Z.d(
+000039b0: 6423 6424 8401 5a13 6425 5300 2929 720f  d#d$..Z.d%S.))r.
+000039c0: 0000 0063 0200 0000 0000 0000 0000 0000  ...c............
+000039d0: 0400 0000 0400 0000 4f00 0000 7340 0000  ........O...s@..
+000039e0: 0064 017c 005f 0064 027c 03a0 01a1 0076  .d.|._.d.|.....v
+000039f0: 0072 107c 00a0 027c 0364 0219 00a1 0101  .r.|...|.d......
+00003a00: 0074 036a 047c 0067 017c 02a2 0152 0064  .t.j.|.g.|...R.d
+00003a10: 037c 0169 017c 03a4 018e 0101 0064 0453  .|.i.|.......d.S
+00003a20: 0029 0561 1f01 0000 0a20 2020 2020 2020  .).a.....       
+00003a30: 2043 6c61 7373 2074 6f20 6465 7363 7269   Class to descri
+00003a40: 6265 204c 6965 206f 7065 7261 746f 7273  be Lie operators
+00003a50: 206f 6620 7468 6520 666f 726d 0a20 2020   of the form.   
+00003a60: 2020 2020 2020 2065 7870 283a 783a 292c         exp(:x:),
+00003a70: 0a20 2020 2020 2020 2077 6865 7265 203a  .        where :
+00003a80: 783a 2069 7320 6120 706f 6c79 2063 6c61  x: is a poly cla
+00003a90: 7373 2e0a 0a20 2020 2020 2020 2049 6e20  ss...        In 
+00003aa0: 636f 6e74 7261 7374 2074 6f20 6120 6765  contrast to a ge
+00003ab0: 6e65 7261 6c20 4c69 6520 6f70 6572 6174  neral Lie operat
+00003ac0: 6f72 2c20 7765 206e 6f77 2068 6176 6520  or, we now have 
+00003ad0: 7468 6520 6164 6469 7469 6f6e 616c 2070  the additional p
+00003ae0: 6f73 7369 6269 6c69 7479 2074 6f20 636f  ossibility to co
+00003af0: 6d62 696e 6520 7365 7665 7261 6c20 6f66  mbine several of
+00003b00: 2074 6865 7365 206f 7065 7261 746f 7273   these operators
+00003b10: 2075 7369 6e67 2074 6865 206c 6965 6f70   using the lieop
+00003b20: 732e 636f 7265 2e63 6f6d 6269 6e65 2e6d  s.core.combine.m
+00003b30: 6167 6e75 7320 726f 7574 696e 652e 0a20  agnus routine.. 
+00003b40: 2020 2020 2020 20e9 0600 0000 7256 0000         .....rV..
+00003b50: 0072 4800 0000 4e29 05da 125f 6263 685f  .rH...N)..._bch_
+00003b60: 6f72 6465 725f 6465 6661 756c 7472 4500  order_defaultrE.
+00003b70: 0000 7246 0000 0072 2000 0000 7249 0000  ..rF...r ...rI..
+00003b80: 0029 0472 1000 0000 7248 0000 0072 1100  .).r....rH...r..
+00003b90: 0000 7212 0000 0072 1300 0000 7213 0000  ..r....r....r...
+00003ba0: 0072 1400 0000 7249 0000 0099 0100 0073  .r....rI.......s
+00003bb0: 0800 0000 0608 0c01 0e01 2001 7a0d 6c65  .......... .z.le
+00003bc0: 7870 2e5f 5f69 6e69 745f 5f63 0200 0000  xp.__init__c....
+00003bd0: 0000 0000 0000 0000 0400 0000 0600 0000  ................
+00003be0: 4b00 0000 73a0 0000 0074 007c 0174 0183  K...s....t.|.t..
+00003bf0: 0272 1274 026a 037c 0066 0164 017c 0169  .r.t.j.|.f.d.|.i
+00003c00: 017c 02a4 018e 0101 0064 0053 0074 047c  .|.......d.S.t.|
+00003c10: 0164 0283 0272 4674 05a0 0664 03a1 0101  .d...rFt...d....
+00003c20: 0064 047c 02a0 07a1 0076 0073 264a 0064  .d.|.....v.s&J.d
+00003c30: 0583 0182 017c 0264 0419 007c 005f 0874  .....|.d...|._.t
+00003c40: 097c 0166 0169 007c 02a4 018e 015c 027d  .|.f.i.|.....\.}
+00003c50: 037c 005f 0a74 026a 037c 0074 0164 0a64  .|._.t.j.|.t.d.d
+00003c60: 067c 0369 017c 02a4 018e 0164 078d 0201  .|.i.|.....d....
+00003c70: 0064 0053 0074 0b64 087c 016a 0c6a 0d9b  .d.S.t.d.|.j.j..
+00003c80: 0064 099d 0383 0182 0129 0b4e 7248 0000  .d.......).NrH..
+00003c90: 0072 5200 0000 7a2d 4c69 6520 6f70 6572  .rR...z-Lie oper
+00003ca0: 6174 6f72 2077 6974 6820 6765 6e65 7261  ator with genera
+00003cb0: 6c20 6361 6c6c 6162 6c65 2069 6e69 7469  l callable initi
+00003cc0: 6174 6564 2e72 1500 0000 7a51 4c69 6520  ated.r....zQLie 
+00003cd0: 6f70 6572 6174 6f72 2069 6e69 7469 6174  operator initiat
+00003ce0: 6564 2077 6974 6820 6765 6e65 7261 6c20  ed with general 
+00003cf0: 6361 6c6c 6162 6c65 2072 6571 7569 7265  callable require
+00003d00: 7320 276f 7264 6572 2720 6172 6775 6d65  s 'order' argume
+00003d10: 6e74 2074 6f20 6265 2073 6574 2e72 3100  nt to be set.r1.
+00003d20: 0000 a901 7248 0000 007a 1241 7267 756d  ....rH...z.Argum
+00003d30: 656e 7420 6f66 2074 7970 6520 277a 1027  ent of type 'z.'
+00003d40: 206e 6f74 2073 7570 706f 7274 6564 2e72   not supported.r
+00003d50: 1300 0000 290e 721f 0000 0072 0c00 0000  ....).r....r....
+00003d60: 7220 0000 0072 4400 0000 7253 0000 0072  r ...rD...rS...r
+00003d70: 8100 0000 727e 0000 0072 4500 0000 7215  ....r~...rE...r.
+00003d80: 0000 0072 0200 0000 da06 6e66 6469 6374  ...r......nfdict
+00003d90: da09 5479 7065 4572 726f 7272 7a00 0000  ..TypeErrorrz...
+00003da0: 7225 0000 0029 0472 1000 0000 da01 4872  r%...).r......Hr
+00003db0: 1200 0000 da0d 7461 796c 6f72 5f63 6f65  ......taylor_coe
+00003dc0: 6666 7372 1300 0000 7213 0000 0072 1400  ffsr....r....r..
+00003dd0: 0000 7244 0000 00a6 0100 0073 1200 0000  ..rD.......s....
+00003de0: 0a01 1a01 0a01 0a01 1401 0a01 1602 2001  .............. .
+00003df0: 1402 7a11 6c65 7870 2e73 6574 5f61 7267  ..z.lexp.set_arg
+00003e00: 756d 656e 7463 0200 0000 0000 0000 0000  umentc..........
+00003e10: 0000 0300 0000 0500 0000 4b00 0000 731e  ..........K...s.
+00003e20: 0000 0074 006a 017c 0066 0164 0174 027c  ...t.j.|.f.d.t.|
+00003e30: 0183 0169 017c 02a4 018e 0101 0064 0053  ...i.|.......d.S
+00003e40: 0029 024e 723e 0000 0029 0372 2000 0000  .).Nr>...).r ...
+00003e50: 7246 0000 0072 0400 0000 2903 7210 0000  rF...r....).r...
+00003e60: 0072 5600 0000 7212 0000 0072 1300 0000  .rV...r....r....
+00003e70: 7213 0000 0072 1400 0000 7246 0000 00b3  r....r....rF....
+00003e80: 0100 0073 0200 0000 1e01 7a12 6c65 7870  ...s......z.lexp
+00003e90: 2e73 6574 5f67 656e 6572 6174 6f72 6301  .set_generatorc.
+00003ea0: 0000 0000 0000 0000 0000 0007 0000 0005  ................
+00003eb0: 0000 004f 0000 0073 a200 0000 7400 7c00  ...O...s....t.|.
+00003ec0: 7401 7c01 6401 1900 8301 8302 730b 4a00  t.|.d.......s.J.
+00003ed0: 8201 7c02 a002 6402 7c00 6a03 a102 7d03  ..|...d.|.j...}.
+00003ee0: 7c02 a002 6403 6404 a102 7d03 7404 7c00  |...d.d...}.t.|.
+00003ef0: 6a05 6701 6405 6406 8400 7c01 4400 8301  j.g.d.d...|.D...
+00003f00: a201 5200 6900 7c02 a401 8e01 5c03 7d04  ..R.i.|.....\.}.
+00003f10: 7d03 7d03 7406 7c04 8301 6401 6b04 7239  }.}.t.|...d.k.r9
+00003f20: 7407 7c04 a008 a100 8301 7d05 6e03 7409  t.|.......}.n.t.
+00003f30: 8300 7d05 6900 7d06 740a 7c00 6407 8302  ..}.i.}.t.|.d...
+00003f40: 7248 6407 7c00 6a0b 6901 7d06 7c00 6a0c  rHd.|.j.i.}.|.j.
+00003f50: 7c05 6601 6900 7c06 a401 8e01 5300 2908  |.f.i.|.....S.).
+00003f60: 6193 0300 000a 2020 2020 2020 2020 436f  a.....        Co
+00003f70: 6d70 7574 6520 7468 6520 636f 6d70 6f73  mpute the compos
+00003f80: 6974 696f 6e20 6f66 2074 6865 2063 7572  ition of the cur
+00003f90: 7265 6e74 204c 6965 206f 7065 7261 746f  rent Lie operato
+00003fa0: 7220 6578 7028 3a78 3a29 2077 6974 6820  r exp(:x:) with 
+00003fb0: 6f74 6865 7220 6f6e 6573 2065 7870 283a  other ones exp(:
+00003fc0: 795f 313a 292c 0a20 2020 2020 2020 202e  y_1:),.        .
+00003fd0: 2e2e 2c20 6578 7028 3a79 5f4e 3a29 0a20  .., exp(:y_N:). 
+00003fe0: 2020 2020 2020 2074 6f20 7265 7475 726e         to return
+00003ff0: 2074 6865 204c 6965 206f 7065 7261 746f   the Lie operato
+00004000: 7220 6578 7028 3a7a 3a29 2067 6976 656e  r exp(:z:) given
+00004010: 2061 730a 2020 2020 2020 2020 2020 2065   as.           e
+00004020: 7870 283a 7a3a 2920 3d20 6578 7028 3a78  xp(:z:) = exp(:x
+00004030: 3a29 2065 7870 283a 795f 313a 2920 6578  :) exp(:y_1:) ex
+00004040: 7028 3a79 5f32 3a29 202e 2e2e 2065 7870  p(:y_2:) ... exp
+00004050: 283a 795f 4e3a 292e 0a20 2020 2020 2020  (:y_N:)..       
+00004060: 2020 2020 0a20 2020 2020 2020 2050 6172      .        Par
+00004070: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+00004080: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00004090: 2020 207a 3a20 6c69 656f 7065 7261 746f     z: lieoperato
+000040a0: 7273 0a20 2020 2020 2020 2020 2020 2054  rs.            T
+000040b0: 6865 204c 6965 206f 7065 7261 746f 7273  he Lie operators
+000040c0: 207a 203d 2065 7870 283a 793a 2920 746f   z = exp(:y:) to
+000040d0: 2062 6520 636f 6d70 6f73 6564 2077 6974   be composed wit
+000040e0: 6820 7468 6520 6375 7272 656e 7420 4c69  h the current Li
+000040f0: 6520 6f70 6572 6174 6f72 2066 726f 6d20  e operator from 
+00004100: 7468 6520 7269 6768 742e 0a20 2020 2020  the right..     
+00004110: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00004120: 6f72 6465 723a 2069 6e74 2c20 6f70 7469  order: int, opti
+00004130: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+00004140: 2054 6865 206f 7264 6572 2069 6e20 7468   The order in th
+00004150: 6520 696e 7465 6772 6174 696f 6e20 7661  e integration va
+00004160: 7269 6162 6c65 2c20 746f 2063 6f6e 7472  riable, to contr
+00004170: 6f6c 2074 6865 2064 6567 7265 6520 6f66  ol the degree of
+00004180: 2061 6363 7572 6163 7920 6f66 2074 6865   accuracy of the
+00004190: 2072 6573 756c 742e 0a20 2020 2020 2020   result..       
+000041a0: 2020 2020 2053 6565 2061 6c73 6f20 6c69       See also li
+000041b0: 652e 636f 7265 2e63 6f6d 6269 6e65 2e6d  e.core.combine.m
+000041c0: 6167 6e75 7320 726f 7574 696e 652e 2049  agnus routine. I
+000041d0: 6620 6e6f 7468 696e 6720 7370 6563 6966  f nothing specif
+000041e0: 6965 642c 2073 656c 662e 5f62 6368 5f6f  ied, self._bch_o
+000041f0: 7264 6572 5f64 6566 6175 6c74 2077 696c  rder_default wil
+00004200: 6c20 6265 2075 7365 642e 0a20 2020 2020  l be used..     
+00004210: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00004220: 2a2a 6b77 6172 6773 0a20 2020 2020 2020  **kwargs.       
+00004230: 2020 2020 2041 6464 6974 696f 6e61 6c20       Additional 
+00004240: 7061 7261 6d65 7465 7273 2073 656e 7420  parameters sent 
+00004250: 746f 206c 6965 2e63 6f72 652e 636f 6d62  to lie.core.comb
+00004260: 696e 652e 6d61 676e 7573 2072 6f75 7469  ine.magnus routi
+00004270: 6e65 2e0a 2020 2020 2020 2020 2020 2020  ne..            
+00004280: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00004290: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000042a0: 0a20 2020 2020 2020 206c 6965 6f70 6572  .        lieoper
+000042b0: 6174 6f72 0a20 2020 2020 2020 2020 2020  ator.           
+000042c0: 2054 6865 2072 6573 756c 7469 6e67 204c   The resulting L
+000042d0: 6965 206f 7065 7261 746f 7220 6f66 2074  ie operator of t
+000042e0: 6865 2063 6f6d 706f 7369 7469 6f6e 2e0a  he composition..
+000042f0: 2020 2020 2020 2020 7201 0000 0072 1500          r....r..
+00004300: 0000 5a0c 6469 7361 626c 655f 7471 646d  ..Z.disable_tqdm
+00004310: 5463 0100 0000 0000 0000 0000 0000 0200  Tc..............
+00004320: 0000 0300 0000 5300 0000 7312 0000 0067  ......S...s....g
+00004330: 007c 005d 057d 017c 016a 0091 0271 0253  .|.].}.|.j...q.S
+00004340: 0072 1300 0000 728d 0000 0029 0272 2900  .r....r....).r).
+00004350: 0000 7223 0000 0072 1300 0000 7213 0000  ..r#...r....r...
+00004360: 0072 1400 0000 722d 0000 00d1 0100 00f3  .r....r-........
+00004370: 0200 0000 1200 7a1c 6c65 7870 2e62 6368  ......z.lexp.bch
+00004380: 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973 7463  .<locals>.<listc
+00004390: 6f6d 703e 7256 0000 0029 0d72 1f00 0000  omp>rV...).r....
+000043a0: da04 7479 7065 724d 0000 0072 8c00 0000  ..typerM...r....
+000043b0: 7205 0000 0072 4800 0000 7255 0000 00da  r....rH...rU....
+000043c0: 0373 756d 7231 0000 0072 0c00 0000 7253  .sumr1...r....rS
+000043d0: 0000 0072 5600 0000 727a 0000 0029 0772  ...rV...rz...).r
+000043e0: 1000 0000 726a 0000 0072 1200 0000 724e  ....rj...r....rN
+000043f0: 0000 00da 0463 6f6d 625a 046f 7574 70da  .....combZ.outp.
+00004400: 0b6f 7574 705f 6b77 6172 6773 7213 0000  .outp_kwargsr...
+00004410: 0072 1300 0000 7214 0000 00da 0362 6368  .r....r......bch
+00004420: b601 0000 7316 0000 0016 180e 010c 0128  ....s..........(
+00004430: 010c 010e 0106 0204 020a 010a 0112 017a  ...............z
+00004440: 086c 6578 702e 6263 6863 0200 0000 0000  .lexp.bchc......
+00004450: 0000 0000 0000 0200 0000 0400 0000 4300  ..............C.
+00004460: 0000 7324 0000 0074 007c 0074 017c 0183  ..s$...t.|.t.|..
+00004470: 0183 0272 0c7c 00a0 027c 01a1 0153 0074  ...r.|...|...S.t
+00004480: 03a0 047c 007c 01a1 0253 0072 1e00 0000  ...|.|...S.r....
+00004490: 2905 721f 0000 0072 9300 0000 7297 0000  ).r....r....r...
+000044a0: 0072 2000 0000 7221 0000 0072 2200 0000  .r ...r!...r"...
+000044b0: 7213 0000 0072 1300 0000 7214 0000 0072  r....r....r....r
+000044c0: 2100 0000 dc01 0000 7306 0000 000e 010a  !.......s.......
+000044d0: 010c 027a 0f6c 6578 702e 5f5f 6d61 746d  ...z.lexp.__matm
+000044e0: 756c 5f5f 6302 0000 0000 0000 0000 0000  ul__c...........
+000044f0: 0003 0000 0004 0000 0043 0000 0073 3000  .........C...s0.
+00004500: 0000 6900 7d02 7400 7c00 6401 8302 720c  ..i.}.t.|.d...r.
+00004510: 6401 7c00 6a01 6901 7d02 7c00 6a02 7c00  d.|.j.i.}.|.j.|.
+00004520: 6a03 7c01 1400 6601 6900 7c02 a401 8e01  j.|...f.i.|.....
+00004530: 5300 2902 4e72 5600 0000 2904 7253 0000  S.).NrV...).rS..
+00004540: 0072 5600 0000 727a 0000 0072 4800 0000  .rV...rz...rH...
+00004550: 2903 7210 0000 0072 5600 0000 7296 0000  ).r....rV...r...
+00004560: 0072 1300 0000 7213 0000 0072 1400 0000  .r....r....r....
+00004570: da07 5f5f 706f 775f 5fe2 0100 0073 0800  ..__pow__....s..
+00004580: 0000 0401 0a01 0a01 1801 7a0c 6c65 7870  ..........z.lexp
+00004590: 2e5f 5f70 6f77 5f5f 4663 0200 0000 0000  .__pow__Fc......
+000045a0: 0000 0000 0000 0400 0000 0400 0000 4b00  ..............K.
+000045b0: 0000 733c 0000 0064 017c 02a0 00a1 0076  ..s<...d.|.....v
+000045c0: 0072 137c 00a0 017c 0264 0119 00a1 0101  .r.|...|.d......
+000045d0: 007c 02a0 0264 0264 03a1 027d 0374 036a  .|...d.d...}.t.j
+000045e0: 047c 0066 0164 047c 0169 017c 02a4 018e  .|.f.d.|.i.|....
+000045f0: 0153 0029 054e 7256 0000 0072 5700 0000  .S.).NrV...rW...
+00004600: 723d 0000 0072 5f00 0000 2905 7245 0000  r=...r_...).rE..
+00004610: 0072 4600 0000 724d 0000 0072 2000 0000  .rF...rM...r ...
+00004620: 7262 0000 0029 0472 1000 0000 725f 0000  rb...).r....r_..
+00004630: 0072 1200 0000 724e 0000 0072 1300 0000  .r....rN...r....
+00004640: 7213 0000 0072 1400 0000 7262 0000 00e8  r....r....rb....
+00004650: 0100 0073 0800 0000 0c01 0e02 0c01 1601  ...s............
+00004660: 7a1c 6c65 7870 2e5f 7570 6461 7465 5f66  z.lexp._update_f
+00004670: 6c6f 775f 7061 7261 6d65 7465 7273 6301  low_parametersc.
+00004680: 0000 0000 0000 0000 0000 0002 0000 0004  ................
+00004690: 0000 004b 0000 0073 8e00 0000 7c00 6a00  ...K...s....|.j.
+000046a0: 6401 6b02 720f 7c00 6a01 6405 6900 7c01  d.k.r.|.j.d.i.|.
+000046b0: a401 8e01 0100 6400 5300 7c00 6a00 6402  ......d.S.|.j.d.
+000046c0: 6b02 721e 7c00 6a02 6405 6900 7c01 a401  k.r.|.j.d.i.|...
+000046d0: 8e01 0100 6400 5300 7c00 6a00 6403 6b02  ....d.S.|.j.d.k.
+000046e0: 722d 7c00 6a03 6405 6900 7c01 a401 8e01  r-|.j.d.i.|.....
+000046f0: 0100 6400 5300 7c00 6a00 6404 6b02 723c  ..d.S.|.j.d.k.r<
+00004700: 7c00 6a04 6405 6900 7c01 a401 8e01 0100  |.j.d.i.|.......
+00004710: 6400 5300 7405 6a06 7c00 6601 6900 7c01  d.S.t.j.|.f.i.|.
+00004720: a401 8e01 0100 6400 5300 2906 4eda 0532  ......d.S.).N..2
+00004730: 666c 6f77 7208 0000 00da 046e 6a65 7472  flowr......njetr
+00004740: 0900 0000 7213 0000 0029 0772 4100 0000  ....r....).rA...
+00004750: da0f 5f63 616c 6346 6c6f 775f 3266 6c6f  .._calcFlow_2flo
+00004760: 77da 125f 6361 6c63 466c 6f77 5f63 6861  w.._calcFlow_cha
+00004770: 6e6e 656c 6cda 0e5f 6361 6c63 466c 6f77  nnell.._calcFlow
+00004780: 5f6e 6a65 74da 105f 6361 6c63 466c 6f77  _njet.._calcFlow
+00004790: 5f68 6579 6f6b 6172 2000 0000 7264 0000  _heyokar ...rd..
+000047a0: 0072 8800 0000 7213 0000 0072 1300 0000  .r....r....r....
+000047b0: 7214 0000 0072 6400 0000 ef01 0000 7312  r....rd.......s.
+000047c0: 0000 000a 0114 010a 0114 010a 0114 010a  ................
+000047d0: 0114 0216 027a 1c6c 6578 702e 5f63 616c  .....z.lexp._cal
+000047e0: 6346 6c6f 7746 726f 6d50 6172 616d 6574  cFlowFromParamet
+000047f0: 6572 7363 0200 0000 0000 0000 0000 0000  ersc............
+00004800: 0700 0000 0500 0000 0b00 0000 739e 0000  ............s...
+00004810: 007c 0172 447c 02a0 0064 017c 006a 0164  .|.rD|...d.|.j.d
+00004820: 0119 00a1 027d 0374 027c 006a 036a 047c  .....}.t.|.j.j.|
+00004830: 006a 036a 0564 028d 027d 047c 02a0 0664  .j.j.d...}.|...d
+00004840: 037c 006a 0164 0419 0064 0319 00a1 027d  .|.j.d...d.....}
+00004850: 0574 0764 0b7c 007c 0464 059c 027c 02a4  .t.d.|.|.d...|..
+00004860: 018e 0189 0187 0166 0164 0664 0784 087c  .......f.d.d...|
+00004870: 0344 0083 0189 0087 0066 0164 0864 0984  .D.......f.d.d..
+00004880: 087d 0688 0188 007c 0664 0a9c 037c 006a  .}.....|.d...|.j
+00004890: 0864 043c 0064 0053 0074 096a 0a7c 0066  .d.<.d.S.t.j.|.f
+000048a0: 0169 007c 02a4 018e 0101 0064 0053 0029  .i.|.......d.S.)
+000048b0: 0c4e 724a 0000 00a9 0172 0d00 0000 723c  .NrJ.....r....r<
+000048c0: 0000 0072 3d00 0000 2902 721d 0000 0072  ...r=...).r....r
+000048d0: 4a00 0000 6301 0000 0000 0000 0000 0000  J...c...........
+000048e0: 0002 0000 0004 0000 0013 0000 00f3 1400  ................
+000048f0: 0000 6700 7c00 5d06 7d01 7c01 8800 8e00  ..g.|.].}.|.....
+00004900: 9102 7102 5300 7213 0000 0072 1300 0000  ..q.S.r....r....
+00004910: a902 7229 0000 00da 0163 a901 da06 7869  ..r).....c....xi
+00004920: 6574 6166 7213 0000 0072 1400 0000 722d  etafr....r....r-
+00004930: 0000 0008 0200 00f3 0200 0000 1400 7a2d  ..............z-
+00004940: 6c65 7870 2e5f 6361 6c63 466c 6f77 5f62  lexp._calcFlow_b
+00004950: 7275 7465 666f 7263 652e 3c6c 6f63 616c  ruteforce.<local
+00004960: 733e 2e3c 6c69 7374 636f 6d70 3e63 0000  s>.<listcomp>c..
+00004970: 0000 0000 0000 0000 0000 0100 0000 0400  ................
+00004980: 0000 1700 0000 7266 0000 0029 034e 6301  ......rf...).Nc.
+00004990: 0000 0000 0000 0000 0000 0002 0000 0004  ................
+000049a0: 0000 0013 0000 0072 6700 0000 7213 0000  .......rg...r...
+000049b0: 0072 1300 0000 725a 0000 0072 6800 0000  .r....rZ...rh...
+000049c0: 7213 0000 0072 1400 0000 722d 0000 0009  r....r....r-....
+000049d0: 0200 0072 6b00 0000 7a3f 6c65 7870 2e5f  ...rk...z?lexp._
+000049e0: 6361 6c63 466c 6f77 5f62 7275 7465 666f  calcFlow_brutefo
+000049f0: 7263 652e 3c6c 6f63 616c 733e 2e3c 6c61  rce.<locals>.<la
+00004a00: 6d62 6461 3e2e 3c6c 6f63 616c 733e 2e3c  mbda>.<locals>.<
+00004a10: 6c69 7374 636f 6d70 3e72 6c00 0000 726d  listcomp>rl...rm
+00004a20: 0000 0072 6e00 0000 726d 0000 0072 1400  ...rn...rm...r..
+00004a30: 0000 726f 0000 0009 0200 0072 2e00 0000  ..ro.......r....
+00004a40: 7a2b 6c65 7870 2e5f 6361 6c63 466c 6f77  z+lexp._calcFlow
+00004a50: 5f62 7275 7465 666f 7263 652e 3c6c 6f63  _bruteforce.<loc
+00004a60: 616c 733e 2e3c 6c61 6d62 6461 3e29 0372  als>.<lambda>).r
+00004a70: a400 0000 7270 0000 0072 6300 0000 7213  ....rp...rc...r.
+00004a80: 0000 0029 0b72 6000 0000 7243 0000 0072  ...).r`...rC...r
+00004a90: 3b00 0000 7248 0000 0072 1c00 0000 720d  ;...rH...r....r.
+00004aa0: 0000 0072 4d00 0000 7271 0000 0072 4000  ...rM...rq...r@.
+00004ab0: 0000 7220 0000 0072 6500 0000 2907 7210  ..r ...re...).r.
+00004ac0: 0000 005a 0870 756c 6c62 6163 6b72 1200  ...Z.pullbackr..
+00004ad0: 0000 5a14 7265 7175 6573 7465 645f 636f  ..Z.requested_co
+00004ae0: 6d70 6f6e 656e 7473 da05 7869 6574 6172  mponents..xietar
+00004af0: 4e00 0000 7263 0000 0072 1300 0000 2902  N...rc...r....).
+00004b00: 7269 0000 0072 a400 0000 7214 0000 0072  ri...r....r....r
+00004b10: 6500 0000 fc01 0000 7312 0000 0004 0112  e.......s.......
+00004b20: 0714 0116 0114 0112 010c 0116 0116 027a  ...............z
+00004b30: 196c 6578 702e 5f63 616c 6346 6c6f 775f  .lexp._calcFlow_
+00004b40: 6272 7574 6566 6f72 6365 6301 0000 0000  bruteforcec.....
+00004b50: 0000 0000 0000 0004 0000 0004 0000 004b  ...............K
+00004b60: 0000 0073 5c00 0000 7c01 a000 7c00 6a01  ...s\...|...|.j.
+00004b70: 6401 1900 a101 0100 7c01 a002 6402 a101  d.......|...d...
+00004b80: 7d02 7403 7c00 6a04 7c00 6a01 6401 1900  }.t.|.j.|.j.d...
+00004b90: 6402 1900 1400 6601 6900 7c01 a401 8e01  d.....f.i.|.....
+00004ba0: 7d03 7c03 6a05 6405 6900 7c01 a401 8e01  }.|.j.d.i.|.....
+00004bb0: 0100 6403 7c03 6901 7c00 6a06 6401 3c00  ..d.|.i.|.j.d.<.
+00004bc0: 6404 5300 2906 7aa0 0a20 2020 2020 2020  d.S.).z..       
+00004bd0: 2043 6f6d 7075 7465 2066 6c6f 7720 7573   Compute flow us
+00004be0: 696e 6720 7468 6520 616c 676f 7269 7468  ing the algorith
+00004bf0: 6d20 6279 2050 2e20 4368 616e 6e65 6c6c  m by P. Channell
+00004c00: 2e0a 2020 2020 2020 2020 0a20 2020 2020  ..        .     
+00004c10: 2020 2054 6869 7320 726f 7574 696e 6520     This routine 
+00004c20: 6d61 7920 6e65 6564 2074 6f20 7573 6520  may need to use 
+00004c30: 6120 736c 6963 696e 6720 6f72 2073 706c  a slicing or spl
+00004c40: 6974 7469 6e67 2074 6f20 696d 7072 6f76  itting to improv
+00004c50: 6520 6974 7320 6163 6375 7261 6379 2e0a  e its accuracy..
+00004c60: 2020 2020 2020 2020 7208 0000 0072 3c00          r....r<.
+00004c70: 0000 7263 0000 004e 7213 0000 0029 0772  ..rc...Nr....).r
+00004c80: 5f00 0000 7243 0000 0072 6000 0000 7208  _...rC...r`...r.
+00004c90: 0000 0072 4800 0000 5a09 6361 6c63 466c  ...rH...Z.calcFl
+00004ca0: 6f77 7372 4000 0000 2904 7210 0000 0072  owsr@...).r....r
+00004cb0: 1200 0000 724e 0000 0072 6300 0000 7213  ....rN...rc...r.
+00004cc0: 0000 0072 1300 0000 7214 0000 0072 9c00  ...r....r....r..
+00004cd0: 0000 0e02 0000 730a 0000 0010 060a 0120  ......s........ 
+00004ce0: 0110 0112 017a 176c 6578 702e 5f63 616c  .....z.lexp._cal
+00004cf0: 6346 6c6f 775f 6368 616e 6e65 6c6c 6301  cFlow_channellc.
+00004d00: 0000 0000 0000 0000 0000 0003 0000 0006  ................
+00004d10: 0000 000b 0000 0073 6c00 0000 7400 7c00  .......sl...t.|.
+00004d20: 6a01 7c00 6a02 6401 1900 6402 1900 1400  j.|.j.d...d.....
+00004d30: 7c01 a003 6403 6404 a102 6405 8d02 8900  |...d.d...d.....
+00004d40: 7404 7c00 6a01 6a05 7c00 6a01 6a06 6406  t.|.j.j.|.j.j.d.
+00004d50: 8d02 7d02 8700 6601 6407 6408 8408 7c02  ..}...f.d.d...|.
+00004d60: 4400 8301 8901 8701 6601 6409 640a 8408  D.......f.d.d...
+00004d70: 8900 7c02 8801 8800 640b 9c03 7c00 6a07  ..|.....d...|.j.
+00004d80: 6401 3c00 640c 5300 290d 6131 0100 000a  d.<.d.S.).a1....
+00004d90: 2020 2020 2020 2020 436f 6d70 7574 6520          Compute 
+00004da0: 7468 6520 666c 6f77 2069 6e20 6361 7365  the flow in case
+00004db0: 2073 656c 662e 6172 6775 6d65 6e74 2069   self.argument i
+00004dc0: 7320 6f66 206f 7264 6572 203c 3d20 322c  s of order <= 2,
+00004dd0: 2062 7920 7573 696e 670a 2020 2020 2020   by using.      
+00004de0: 2020 616e 2065 7861 6374 2069 6e74 6567    an exact integ
+00004df0: 7261 7469 6f6e 2c20 7365 6520 6c69 656f  ration, see lieo
+00004e00: 7073 2e73 6f6c 7665 722e 6765 745f 3266  ps.solver.get_2f
+00004e10: 6c6f 772e 0a20 2020 2020 2020 200a 2020  low..        .  
+00004e20: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00004e30: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00004e40: 2d2d 2d0a 2020 2020 2020 2020 746f 6c3a  ---.        tol:
+00004e50: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
+00004e60: 0a20 2020 2020 2020 2020 2020 2041 2064  .            A d
+00004e70: 6566 6175 6c74 2074 6f6c 6572 616e 6365  efault tolerance
+00004e80: 2075 7365 6420 666f 7220 7468 6520 6c69   used for the li
+00004e90: 656f 7073 2e73 6f6c 7665 722e 666c 6f77  eops.solver.flow
+00004ea0: 3262 7932 2e67 6574 5f32 666c 6f77 2072  2by2.get_2flow r
+00004eb0: 6f75 7469 6e65 2e0a 2020 2020 2020 2020  outine..        
+00004ec0: 7299 0000 0072 3c00 0000 da03 746f 6c67  r....r<.....tolg
+00004ed0: 11ea 2d81 9997 713d a901 72a7 0000 0072  ..-...q=..r....r
+00004ee0: 9f00 0000 6301 0000 0000 0000 0000 0000  ....c...........
+00004ef0: 0002 0000 0004 0000 0013 0000 0073 1400  .............s..
+00004f00: 0000 6700 7c00 5d06 7d01 8800 7c01 8301  ..g.|.].}...|...
+00004f10: 9102 7102 5300 7213 0000 0072 1300 0000  ..q.S.r....r....
+00004f20: 2902 7229 0000 00da 0278 6529 0172 6300  ).r).....xe).rc.
+00004f30: 0000 7213 0000 0072 1400 0000 722d 0000  ..r....r....r-..
+00004f40: 0027 0200 0072 a500 0000 7a28 6c65 7870  .'...r....z(lexp
+00004f50: 2e5f 6361 6c63 466c 6f77 5f32 666c 6f77  ._calcFlow_2flow
+00004f60: 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973 7463  .<locals>.<listc
+00004f70: 6f6d 703e 6300 0000 0000 0000 0000 0000  omp>c...........
+00004f80: 0001 0000 0003 0000 0017 0000 0073 1200  .............s..
+00004f90: 0000 8700 6601 6401 6402 8408 8801 4400  ....f.d.d.....D.
+00004fa0: 8301 5300 2903 4e63 0100 0000 0000 0000  ..S.).Nc........
+00004fb0: 0000 0000 0200 0000 0400 0000 1300 0000  ................
+00004fc0: 72a0 0000 0072 1300 0000 7213 0000 0029  r....r....r....)
+00004fd0: 0272 2900 0000 5a03 7865 6672 6d00 0000  .r)...Z.xefrm...
+00004fe0: 7213 0000 0072 1400 0000 722d 0000 0028  r....r....r-...(
+00004ff0: 0200 0072 a500 0000 7a3a 6c65 7870 2e5f  ...r....z:lexp._
+00005000: 6361 6c63 466c 6f77 5f32 666c 6f77 2e3c  calcFlow_2flow.<
+00005010: 6c6f 6361 6c73 3e2e 3c6c 616d 6264 613e  locals>.<lambda>
+00005020: 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973 7463  .<locals>.<listc
+00005030: 6f6d 703e 7213 0000 0072 6d00 0000 72a3  omp>r....rm...r.
+00005040: 0000 0072 6d00 0000 7214 0000 0072 6f00  ...rm...r....ro.
+00005050: 0000 2802 0000 7292 0000 007a 266c 6578  ..(...r....z&lex
+00005060: 702e 5f63 616c 6346 6c6f 775f 3266 6c6f  p._calcFlow_2flo
+00005070: 772e 3c6c 6f63 616c 733e 2e3c 6c61 6d62  w.<locals>.<lamb
+00005080: 6461 3e29 0372 a600 0000 72a4 0000 0072  da>).r....r....r
+00005090: 6300 0000 4e29 0872 0700 0000 7248 0000  c...N).r....rH..
+000050a0: 0072 4300 0000 720e 0000 0072 3b00 0000  .rC...r....r;...
+000050b0: 721c 0000 0072 0d00 0000 7240 0000 0029  r....r....r@...)
+000050c0: 0372 1000 0000 7212 0000 0072 a600 0000  .r....r....r....
+000050d0: 7213 0000 0029 0272 6300 0000 72a4 0000  r....).rc...r...
+000050e0: 0072 1400 0000 729b 0000 001a 0200 0073  .r....r........s
+000050f0: 0a00 0000 240a 1402 1201 0c01 1601 7a14  ....$.........z.
+00005100: 6c65 7870 2e5f 6361 6c63 466c 6f77 5f32  lexp._calcFlow_2
+00005110: 666c 6f77 7203 0000 00da 086e 5f73 6c69  flowr......n_sli
+00005120: 6365 7363 0200 0000 0000 0000 0000 0000  cesc............
+00005130: 0a00 0000 0800 0000 0b00 0000 734c 0100  ............sL..
+00005140: 007c 02a0 0088 016a 0164 0119 00a1 0101  .|.....j.d......
+00005150: 007c 02a0 0264 0264 03a1 027d 037c 0364  .|...d.d...}.|.d
+00005160: 016b 0373 164a 0064 0483 0182 017c 0364  .k.s.J.d.....|.d
+00005170: 036b 0272 2d7a 0b7c 02a0 0364 0574 0488  .k.r-z.|...d.t..
+00005180: 0164 0583 02a1 027d 0457 006e 0701 0001  .d.....}.W.n....
+00005190: 0001 0074 0564 0683 0182 0174 067c 02a0  ...t.d.....t.|..
+000051a0: 0264 0788 016a 076a 08a1 027c 02a0 0264  .d...j.j...|...d
+000051b0: 0888 016a 076a 09a1 0264 098d 027d 057c  ...j.j...d...}.|
+000051c0: 02a0 0a64 0a64 0ba1 027d 047c 02a0 0a64  ...d.d...}.|...d
+000051d0: 0c64 0ba1 027d 0464 0d7c 02a0 0ba1 0076  .d...}.d.|.....v
+000051e0: 0072 5f7c 0264 0d19 0088 016a 077c 011b  .r_|.d.....j.|..
+000051f0: 0066 0169 007c 02a4 018e 017d 066e 0688  .f.i.|.....}.n..
+00005200: 016a 077c 011b 0067 017d 067c 02a0 0a64  .j.|...g.}.|...d
+00005210: 0e64 0fa1 027d 0487 0166 0164 1064 1184  .d...}...f.d.d..
+00005220: 087c 0644 0083 0189 0088 0044 005d 0d7d  .|.D.......D.].}
+00005230: 077c 076a 0c64 177c 037c 0564 129c 027c  .|.j.d.|.|.d...|
+00005240: 02a4 018e 0101 0071 7669 007d 0888 007c  .......qvi.}...|
+00005250: 0864 133c 0088 007c 0114 0089 0087 0066  .d.<...|.......f
+00005260: 0164 1464 1584 087d 097c 08a0 007c 097c  .d.d...}.|...|.|
+00005270: 0588 007c 017c 0364 169c 05a1 0101 007c  ...|.|.d.......|
+00005280: 0888 016a 0d64 013c 0064 0b53 0029 1861  ...j.d.<.d.S.).a
+00005290: ab05 0000 0a20 2020 2020 2020 2053 706c  .....        Spl
+000052a0: 6974 2061 6e64 2f6f 7220 736c 6963 6520  it and/or slice 
+000052b0: 7468 6520 6375 7272 656e 7420 6c69 6520  the current lie 
+000052c0: 6f70 6572 6174 6f72 2061 6e64 2063 6f6d  operator and com
+000052d0: 7075 7465 2069 7473 2072 6573 756c 7469  pute its resulti
+000052e0: 6e67 2066 6c6f 772c 2072 6561 6479 2074  ng flow, ready t
+000052f0: 6f0a 2020 2020 2020 2020 7461 6b65 2061  o.        take a
+00005300: 6e20 6e6a 6574 2e0a 2020 2020 2020 2020  n njet..        
+00005310: 0a20 2020 2020 2020 2054 6865 2066 6c6f  .        The flo
+00005320: 7720 6d61 7073 2061 7265 2068 6572 6562  w maps are hereb
+00005330: 7920 6361 6c63 756c 6174 6564 2062 7920  y calculated by 
+00005340: 616e 7920 6f74 6865 7220 6d65 7468 6f64  any other method
+00005350: 2064 6574 6572 6d69 6e65 6420 6279 2074   determined by t
+00005360: 6865 2075 7365 722e 200a 2020 2020 2020  he user. .      
+00005370: 2020 0a20 2020 2020 2020 2050 6172 616d    .        Param
+00005380: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00005390: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+000053a0: 2070 6f77 6572 3a20 696e 742c 2028 6f70   power: int, (op
+000053b0: 7469 6f6e 616c 290a 2020 2020 2020 2020  tional).        
+000053c0: 2020 2020 436f 6e74 726f 6c20 7468 6520      Control the 
+000053d0: 6e75 6d62 6572 206f 6620 6e65 7374 6564  number of nested
+000053e0: 2063 6f6d 6d75 7461 746f 7273 2069 6e20   commutators in 
+000053f0: 6361 7365 2027 666c 6f77 5f6d 6574 686f  case 'flow_metho
+00005400: 6427 203d 3d20 2762 7275 7465 666f 7263  d' == 'bruteforc
+00005410: 6527 2e0a 2020 2020 2020 2020 2020 2020  e'..            
+00005420: 5265 7175 6972 6564 2069 6620 2766 6c6f  Required if 'flo
+00005430: 775f 6d65 7468 6f64 2720 6973 206e 6f74  w_method' is not
+00005440: 2073 7065 6369 6669 6564 2028 6465 6661   specified (defa
+00005450: 756c 7429 2e0a 0a20 2020 2020 2020 2066  ult)...        f
+00005460: 6c6f 775f 6d65 7468 6f64 3a20 7374 722c  low_method: str,
+00005470: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00005480: 2020 2020 2020 5468 6520 6d65 7468 6f64        The method
+00005490: 2074 6f20 636f 6d70 7574 6520 7468 6520   to compute the 
+000054a0: 666c 6f77 206f 6620 7468 6520 696e 6469  flow of the indi
+000054b0: 7669 6475 616c 2073 6c69 6365 732c 2075  vidual slices, u
+000054c0: 7365 6420 696e 2063 616c 6375 6c61 7469  sed in calculati
+000054d0: 6e67 2074 6865 206f 7574 636f 6d65 0a20  ng the outcome. 
+000054e0: 2020 2020 2020 2020 2020 206f 6620 7061             of pa
+000054f0: 7373 696e 6720 7468 6520 6a65 7473 2074  ssing the jets t
+00005500: 6872 6f75 6768 2074 6865 7365 2073 6c69  hrough these sli
+00005510: 6365 732e 0a20 2020 2020 2020 2020 2020  ces..           
+00005520: 200a 2020 2020 2020 2020 7370 6c69 745f   .        split_
+00005530: 6d65 7468 6f64 3a20 7374 722c 206f 7074  method: str, opt
+00005540: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00005550: 2020 4375 7374 6f6d 697a 6564 2073 706c    Customized spl
+00005560: 6974 7469 6e67 206d 6574 686f 6420 6f66  itting method of
+00005570: 2074 6865 2068 616d 696c 746f 6e69 616e   the hamiltonian
+00005580: 732e 2053 6565 206c 6965 6f70 732e 736f  s. See lieops.so
+00005590: 6c76 6572 2e73 706c 6974 7469 6e67 2066  lver.splitting f
+000055a0: 6f72 2065 7861 6d70 6c65 732e 0a20 2020  or examples..   
+000055b0: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+000055c0: 2020 6e5f 736c 6963 6573 3a20 696e 742c    n_slices: int,
+000055d0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+000055e0: 2020 2020 2020 536c 6963 6520 7468 6520        Slice the 
+000055f0: 6861 6d69 6c74 6f6e 6961 6e20 756e 6966  hamiltonian unif
+00005600: 6f72 6d6c 7920 696e 746f 206e 5f73 6c69  ormly into n_sli
+00005610: 6365 7320 7061 7274 7320 6265 666f 7265  ces parts before
+00005620: 2070 6173 7369 6e67 2074 6865 206e 6a65   passing the nje
+00005630: 7473 2e0a 2020 2020 2020 2020 2020 2020  ts..            
+00005640: 0a20 2020 2020 2020 206f 7264 6572 3a20  .        order: 
+00005650: 696e 742c 206f 7074 696f 6e61 6c0a 2020  int, optional.  
+00005660: 2020 2020 2020 2020 2020 436f 6e74 726f            Contro
+00005670: 6c20 7468 6520 6f72 6465 7220 6f66 2074  l the order of t
+00005680: 6865 206e 6a65 7473 2070 6173 7365 6420  he njets passed 
+00005690: 7468 726f 7567 6820 7468 6520 4c69 6520  through the Lie 
+000056a0: 6f70 6572 6174 6f72 2e20 4966 206e 6f74  operator. If not
+000056b0: 6869 6e67 2073 7065 6369 6669 6564 2c0a  hing specified,.
+000056c0: 2020 2020 2020 2020 2020 2020 6120 7265              a re
+000056d0: 6173 6f6e 6162 6c65 206f 7264 6572 2077  asonable order w
+000056e0: 696c 6c20 6265 2061 7474 656d 7074 6564  ill be attempted
+000056f0: 2c20 6465 7065 6e64 696e 6720 6f6e 206d  , depending on m
+00005700: 6178 5f70 6f77 6572 206f 6620 7468 6520  ax_power of the 
+00005710: 6375 7272 656e 7420 4c69 6520 6f70 6572  current Lie oper
+00005720: 6174 6f72 2061 7267 756d 656e 742e 0a20  ator argument.. 
+00005730: 2020 2020 2020 2020 2020 200a 2020 2020             .    
+00005740: 2020 2020 636f 6d70 6f6e 656e 7473 3a20      components: 
+00005750: 6c69 7374 2c20 6f70 7469 6f6e 616c 0a20  list, optional. 
+00005760: 2020 2020 2020 2020 2020 2041 206c 6973             A lis
+00005770: 7420 6f66 2070 6f6c 7920 6f62 6a65 6374  t of poly object
+00005780: 7320 7768 6963 6820 746f 2061 7070 6c79  s which to apply
+00005790: 2074 6865 204c 6965 206f 7065 7261 746f   the Lie operato
+000057a0: 7220 6f6e 746f 2e20 4279 2064 6566 6175  r onto. By defau
+000057b0: 6c74 2c20 7365 6c66 2e63 6f6d 706f 6e65  lt, self.compone
+000057c0: 6e74 7320 6172 6520 7461 6b65 6e2e 2020  nts are taken.  
+000057d0: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+000057e0: 2020 2a2a 6b77 6172 6773 0a20 2020 2020    **kwargs.     
+000057f0: 2020 2020 2020 204f 7074 696f 6e61 6c20         Optional 
+00005800: 6b65 7977 6f72 6465 6420 6172 6775 6d65  keyworded argume
+00005810: 6e74 7320 7061 7373 6564 2074 6f20 7468  nts passed to th
+00005820: 6520 666c 6f77 5f6d 6574 686f 6420 726f  e flow_method ro
+00005830: 7574 696e 652e 0a20 2020 2020 2020 2072  utine..        r
+00005840: 9a00 0000 da0b 666c 6f77 5f6d 6574 686f  ......flow_metho
+00005850: 6472 3d00 0000 7a30 4172 6775 6d65 6e74  dr=...z0Argument
+00005860: 2027 666c 6f77 5f6d 6574 686f 6427 2063   'flow_method' c
+00005870: 616e 206e 6f74 2062 6520 276e 6a65 7427  an not be 'njet'
+00005880: 2069 7473 656c 662e 7256 0000 007a 4444   itself.rV...zDD
+00005890: 6566 6175 6c74 2066 6c6f 775f 6d65 7468  efault flow_meth
+000058a0: 6f64 3a20 6272 7574 6566 6f72 6365 2072  od: bruteforce r
+000058b0: 6571 7569 7265 7320 2770 6f77 6572 2720  equires 'power' 
+000058c0: 6172 6775 6d65 6e74 2074 6f20 6265 2073  argument to be s
+000058d0: 6574 2e72 1c00 0000 720d 0000 0072 8600  et.r....r....r..
+000058e0: 0000 7257 0000 004e 724a 0000 005a 0c73  ..rW...NrJ...Z.s
+000058f0: 706c 6974 5f6d 6574 686f 6472 8400 0000  plit_methodr....
+00005900: 4663 0100 0000 0000 0000 0000 0000 0200  Fc..............
+00005910: 0000 0500 0000 1300 0000 7316 0000 0067  ..........s....g
+00005920: 007c 005d 077d 0188 00a0 007c 01a1 0191  .|.].}.....|....
+00005930: 0271 0253 0072 1300 0000 2901 727a 0000  .q.S.r....).rz..
+00005940: 0029 0272 2900 0000 da01 6872 4b00 0000  .).r).....hrK...
+00005950: 7213 0000 0072 1400 0000 722d 0000 0063  r....r....r-...c
+00005960: 0200 0073 0200 0000 1600 7a27 6c65 7870  ...s......z'lexp
+00005970: 2e5f 6361 6c63 466c 6f77 5f6e 6a65 742e  ._calcFlow_njet.
+00005980: 3c6c 6f63 616c 733e 2e3c 6c69 7374 636f  <locals>.<listco
+00005990: 6d70 3e29 0272 5700 0000 724a 0000 005a  mp>).rW...rJ...Z
+000059a0: 1075 6e69 7175 655f 6f70 6572 6174 6f72  .unique_operator
+000059b0: 7363 0000 0000 0000 0000 0000 0000 0200  sc..............
+000059c0: 0000 0300 0000 1700 0000 7316 0000 0088  ..........s.....
+000059d0: 0044 005d 067d 017c 017c 008e 007d 0071  .D.].}.|.|...}.q
+000059e0: 027c 0053 0072 1e00 0000 7213 0000 0029  .|.S.r....r....)
+000059f0: 0272 6a00 0000 da02 6f70 2901 da09 6f70  .rj.....op)...op
+00005a00: 6572 6174 6f72 7372 1300 0000 7214 0000  eratorsr....r...
+00005a10: 00da 096c 6f5f 636f 6e63 6174 6902 0000  ...lo_concati...
+00005a20: 7306 0000 0008 010a 0104 017a 266c 6578  s..........z&lex
+00005a30: 702e 5f63 616c 6346 6c6f 775f 6e6a 6574  p._calcFlow_njet
+00005a40: 2e3c 6c6f 6361 6c73 3e2e 6c6f 5f63 6f6e  .<locals>.lo_con
+00005a50: 6361 7429 0572 6300 0000 72a6 0000 0072  cat).rc...r....r
+00005a60: ae00 0000 72aa 0000 0072 ab00 0000 7213  ....r....r....r.
+00005a70: 0000 0029 0e72 5f00 0000 7243 0000 0072  ...).r_...rC...r
+00005a80: 0e00 0000 724d 0000 00da 0767 6574 6174  ....rM.....getat
+00005a90: 7472 7274 0000 0072 3b00 0000 7248 0000  trrt...r;...rH..
+00005aa0: 0072 1c00 0000 720d 0000 0072 6000 0000  .r....r....r`...
+00005ab0: 7245 0000 0072 0b00 0000 7240 0000 0029  rE...r....r@...)
+00005ac0: 0a72 1000 0000 72aa 0000 0072 1200 0000  .r....r....r....
+00005ad0: 72ab 0000 0072 4e00 0000 72a6 0000 005a  r....rN...r....Z
+00005ae0: 0c68 616d 696c 746f 6e69 616e 7372 ad00  .hamiltoniansr..
+00005af0: 0000 7273 0000 0072 af00 0000 7213 0000  ..rs...r....r...
+00005b00: 0029 0272 ae00 0000 7210 0000 0072 1400  .).r....r....r..
+00005b10: 0000 729d 0000 002b 0200 0073 3000 0000  ..r....+...s0...
+00005b20: 1020 0c03 1001 0801 0201 1601 0601 0801  . ..............
+00005b30: 2403 0c01 0c01 0c01 1c02 0c02 0c04 1201  $...............
+00005b40: 0801 1801 0401 0801 0801 0c01 1604 0e01  ................
+00005b50: 7a13 6c65 7870 2e5f 6361 6c63 466c 6f77  z.lexp._calcFlow
+00005b60: 5f6e 6a65 7463 0100 0000 0000 0000 0000  _njetc..........
+00005b70: 0000 0200 0000 0500 0000 4b00 0000 732e  ..........K...s.
+00005b80: 0000 0064 0174 007c 006a 017c 006a 0264  ...d.t.|.j.|.j.d
+00005b90: 0219 0064 0319 0014 0066 0169 007c 01a4  ...d.....f.i.|..
+00005ba0: 018e 0169 017c 006a 0364 023c 0064 0053  ...i.|.j.d.<.d.S
+00005bb0: 0029 044e 7263 0000 0072 0900 0000 723c  .).Nrc...r....r<
+00005bc0: 0000 0029 0472 0900 0000 7248 0000 0072  ...).r....rH...r
+00005bd0: 4300 0000 7240 0000 0072 8800 0000 7213  C...r@...r....r.
+00005be0: 0000 0072 1300 0000 7214 0000 0072 9e00  ...r....r....r..
+00005bf0: 0000 7002 0000 7302 0000 002e 017a 156c  ..p...s......z.l
+00005c00: 6578 702e 5f63 616c 6346 6c6f 775f 6865  exp._calcFlow_he
+00005c10: 796f 6b61 6301 0000 0000 0000 0000 0000  yokac...........
+00005c20: 0008 0000 0004 0000 000b 0000 0073 ec00  .............s..
+00005c30: 0000 7c00 6a00 7d02 7c00 6a01 7c02 1900  ..|.j.}.|.j.|...
+00005c40: 7d03 6401 7c03 a002 a100 7601 726d 7c00  }.d.|.....v.rm|.
+00005c50: 6a03 7c02 1900 7d04 6402 7c04 a002 a100  j.|...}.d.|.....
+00005c60: 7600 731b 4a00 8201 6403 7c03 a002 a100  v.s.J...d.|.....
+00005c70: 7600 7226 7c03 6403 1900 8900 6e33 6404  v.r&|.d.....n3d.
+00005c80: 7c03 a002 a100 7600 7251 6405 7c00 6a04  |.....v.rQd.|.j.
+00005c90: 6a05 1400 6406 1400 7d05 7c00 6a06 7c05  j...d...}.|.j.|.
+00005ca0: 6900 7c01 a401 8e01 7d06 7c00 a007 a100  i.|.....}.|.....
+00005cb0: 8900 8800 7c03 6403 3c00 7c06 7c03 6407  ....|.d.<.|.|.d.
+00005cc0: 3c00 7c00 6a01 7c02 1900 a008 7c03 a101  <.|.j.|.....|...
+00005cd0: 0100 6e08 7409 6408 7c02 9b00 6409 9d03  ..n.t.d.|...d...
+00005ce0: 8301 8201 8700 6601 640a 640b 8408 7c04  ......f.d.d...|.
+00005cf0: 6402 1900 4400 8301 7d07 7c07 7c00 6a01  d...D...}.|.|.j.
+00005d00: 7c02 1900 6401 3c00 7c07 5300 740a 6a0b  |...d.<.|.S.t.j.
+00005d10: 7c00 6601 6900 7c01 a401 8e01 5300 290c  |.f.i.|.....S.).
+00005d20: 6116 0100 000a 2020 2020 2020 2020 4966  a.....        If
+00005d30: 2073 656c 662e 666c 6f77 2068 6173 2062   self.flow has b
+00005d40: 6565 6e20 636f 6d70 7574 6564 2c20 636f  een computed, co
+00005d50: 6d70 7574 6520 286f 7220 7265 7475 726e  mpute (or return
+00005d60: 2920 7468 6520 7265 7375 6c74 696e 6720  ) the resulting 
+00005d70: 706f 6c79 6e6f 6d69 616c 2065 7870 283a  polynomial exp(:
+00005d80: 783a 293a 793a 2c20 0a20 2020 2020 2020  x:):y:, .       
+00005d90: 2066 6f72 2065 7665 7279 2079 2069 6e20   for every y in 
+00005da0: 7365 6c66 2e63 6f6d 706f 6e65 6e74 732e  self.components.
+00005db0: 2054 6869 7320 7769 6c6c 2062 6520 646f   This will be do
+00005dc0: 6e65 2062 7920 7075 6c6c 696e 6720 6261  ne by pulling ba
+00005dd0: 636b 2074 6865 2070 6f6c 796e 6f6d 6961  ck the polynomia
+00005de0: 6c20 3a79 3a2c 2075 7369 6e67 2074 6865  l :y:, using the
+00005df0: 0a20 2020 2020 2020 2076 616c 7565 7320  .        values 
+00005e00: 6578 7028 3a78 3a29 7a5f 6a2c 2077 6865  exp(:x:)z_j, whe
+00005e10: 7265 207a 5f6a 2061 7265 2074 6865 2078  re z_j are the x
+00005e20: 692f 6574 6120 636f 6f72 6469 6e61 7465  i/eta coordinate
+00005e30: 732e 0a20 2020 2020 2020 2072 7000 0000  s..        rp...
+00005e40: 724a 0000 0072 a400 0000 7263 0000 0072  rJ...r....rc...r
+00005e50: 7700 0000 7216 0000 005a 0564 666c 6f77  w...r....Z.dflow
+00005e60: 7a27 4e6f 2072 6573 756c 7428 7329 2066  z'No result(s) f
+00005e70: 6965 6c64 2070 7265 7365 6e74 2066 6f72  ield present for
+00005e80: 206d 6574 686f 6420 277a 0227 2e63 0100   method 'z.'.c..
+00005e90: 0000 0000 0000 0000 0000 0200 0000 0400  ................
+00005ea0: 0000 1300 0000 72a0 0000 0072 1300 0000  ......r....r....
+00005eb0: 7213 0000 0072 a100 0000 72a3 0000 0072  r....r....r....r
+00005ec0: 1300 0000 7214 0000 0072 2d00 0000 8d02  ....r....r-.....
+00005ed0: 0000 72a5 0000 007a 2a6c 6578 702e 5f63  ..r....z*lexp._c
+00005ee0: 616c 6350 6f6c 7946 726f 6d46 6c6f 772e  alcPolyFromFlow.
+00005ef0: 3c6c 6f63 616c 733e 2e3c 6c69 7374 636f  <locals>.<listco
+00005f00: 6d70 3e29 0c72 4100 0000 7240 0000 0072  mp>).rA...r@...r
+00005f10: 4500 0000 7243 0000 0072 4800 0000 721c  E...rC...rH...r.
+00005f20: 0000 0072 8400 0000 7270 0000 0072 5f00  ...r....rp...r_.
+00005f30: 0000 7274 0000 0072 2000 0000 7275 0000  ..rt...r ...ru..
+00005f40: 0029 0872 1000 0000 7212 0000 0072 5700  .).r....r....rW.
+00005f50: 0000 5a08 666c 6f77 5f6f 7574 da0a 7061  ..Z.flow_out..pa
+00005f60: 7261 6d65 7465 7273 da04 7a65 726f 5a06  rameters..zeroZ.
+00005f70: 6463 6861 696e 7269 0000 0072 1300 0000  dchainri...r....
+00005f80: 72a3 0000 0072 1400 0000 7275 0000 0073  r....r....ru...s
+00005f90: 0200 0073 2600 0000 0606 0a01 0c01 0a01  ...s&...........
+00005fa0: 1001 0c02 0a01 0c01 1002 1001 0801 0802  ................
+00005fb0: 0801 1201 1002 1602 0e01 0401 1202 7a16  ..............z.
+00005fc0: 6c65 7870 2e5f 6361 6c63 506f 6c79 4672  lexp._calcPolyFr
+00005fd0: 6f6d 466c 6f77 6301 0000 0000 0000 0000  omFlowc.........
+00005fe0: 0000 0003 0000 0004 0000 004f 0000 0073  ...........O...s
+00005ff0: 3a00 0000 7400 7c01 6401 1900 7401 7c00  :...t.|.d...t.|.
+00006000: 8301 8302 7211 7c00 6a02 7c01 6900 7c02  ....r.|.j.|.i.|.
+00006010: a401 8e01 5300 7403 6a04 7c00 6701 7c01  ....S.t.j.|.g.|.
+00006020: a201 5200 6900 7c02 a401 8e01 5300 2902  ..R.i.|.....S.).
+00006030: 4e72 0100 0000 2905 721f 0000 0072 9300  Nr....).r....r..
+00006040: 0000 7297 0000 0072 2000 0000 7252 0000  ..r....r ...rR..
+00006050: 0029 0372 1000 0000 726a 0000 0072 1200  .).r....rj...r..
+00006060: 0000 7213 0000 0072 1300 0000 7214 0000  ..r....r....r...
+00006070: 0072 5200 0000 9302 0000 7306 0000 0012  .rR.......s.....
+00006080: 0110 0118 027a 0d6c 6578 702e 5f5f 6361  .....z.lexp.__ca
+00006090: 6c6c 5f5f 7201 0000 0063 0200 0000 0000  ll__r....c......
+000060a0: 0000 0000 0000 0500 0000 0400 0000 4b00  ..............K.
+000060b0: 0000 7330 0000 0074 006a 017c 0066 0169  ..s0...t.j.|.f.i
+000060c0: 007c 02a4 018e 017d 037c 0164 016b 0472  .|.....}.|.d.k.r
+000060d0: 1674 026a 036a 046a 057c 037c 0164 028d  .t.j.j.j.|.|.d..
+000060e0: 027d 047c 0353 0029 0361 6d01 0000 0a20  .}.|.S.).am.... 
+000060f0: 2020 2020 2020 2052 6574 7572 6e20 7468         Return th
+00006100: 6520 5461 796c 6f72 206d 6170 2066 726f  e Taylor map fro
+00006110: 6d20 6120 6769 7665 6e20 5450 5341 2065  m a given TPSA e
+00006120: 7661 6c75 6174 696f 6e2c 2075 7369 6e67  valuation, using
+00006130: 2074 6865 0a20 2020 2020 2020 2064 696d   the.        dim
+00006140: 656e 7369 6f6e 6e20 616e 6420 6d61 785f  ensionn and max_
+00006150: 706f 7765 7220 6f66 2074 6865 2063 7572  power of the cur
+00006160: 7265 6e74 204c 6965 2d6f 7065 7261 746f  rent Lie-operato
+00006170: 722e 0a20 2020 2020 2020 200a 2020 2020  r..        .    
+00006180: 2020 2020 4d6f 7265 6f76 6572 2c20 7065      Moreover, pe
+00006190: 7266 6f72 6d20 6120 7379 6d70 6c65 6374  rform a symplect
+000061a0: 6963 6974 7920 6368 6563 6b20 6966 2061  icity check if a
+000061b0: 2074 6f6c 6572 616e 6365 2069 7320 6769   tolerance is gi
+000061c0: 7665 6e2e 0a20 2020 2020 2020 200a 2020  ven..        .  
+000061d0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+000061e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000061f0: 2d2d 2d0a 2020 2020 2020 2020 746f 6c3a  ---.        tol:
+00006200: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
+00006210: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00006220: 3e20 302c 2070 6572 666f 726d 2061 2073  > 0, perform a s
+00006230: 796d 706c 6563 7469 6369 7479 2063 6865  ymplecticity che
+00006240: 636b 206f 6e20 7468 6520 7265 7375 6c74  ck on the result
+00006250: 732e 0a20 2020 2020 2020 2072 0100 0000  s..        r....
+00006260: 72a8 0000 0029 0672 2000 0000 7270 0000  r....).r ...rp..
+00006270: 0072 1800 0000 7219 0000 0072 8300 0000  .r....r....r....
+00006280: 5a08 7379 6d63 6865 636b 2905 7210 0000  Z.symcheck).r...
+00006290: 0072 a700 0000 7212 0000 00da 0274 6d72  .r....r......tmr
+000062a0: 4e00 0000 7213 0000 0072 1300 0000 7214  N...r....r....r.
+000062b0: 0000 0072 7000 0000 9902 0000 7308 0000  ...rp.......s...
+000062c0: 0012 0c08 0112 0104 017a 0f6c 6578 702e  .........z.lexp.
+000062d0: 7461 796c 6f72 5f6d 6170 4e72 8900 0000  taylor_mapNr....
+000062e0: 7224 0000 0072 7700 0000 2914 7225 0000  r$...rw...).r%..
+000062f0: 0072 2600 0000 7227 0000 0072 4900 0000  .r&...r'...rI...
+00006300: 7244 0000 0072 4600 0000 7297 0000 0072  rD...rF...r....r
+00006310: 2100 0000 7298 0000 0072 6200 0000 7264  !...r....rb...rd
+00006320: 0000 0072 6500 0000 729c 0000 0072 9b00  ...re...r....r..
+00006330: 0000 7228 0000 0072 9d00 0000 729e 0000  ..r(...r....r...
+00006340: 0072 7500 0000 7252 0000 0072 7000 0000  .ru...rR...rp...
+00006350: 7213 0000 0072 1300 0000 7213 0000 0072  r....r....r....r
+00006360: 1400 0000 720f 0000 0097 0100 0073 2200  ....r........s".
+00006370: 0000 0800 0802 080d 080d 0803 0826 0806  .............&..
+00006380: 0a06 0807 0a0d 0812 080c 1011 0845 0803  .............E..
+00006390: 0820 0e06 720f 0000 0072 8900 0000 291b  . ..r....r....).
+000063a0: da05 6e75 6d70 7972 3400 0000 7242 0000  ..numpyr4...rB..
+000063b0: 0072 8100 0000 da10 6c69 656f 7073 2e6c  .r......lieops.l
+000063c0: 696e 616c 672e 6e66 7202 0000 00da 0a67  inalg.nfr......g
+000063d0: 656e 6572 6174 6f72 7372 0400 0000 da07  eneratorsr......
+000063e0: 636f 6d62 696e 6572 0500 0000 720c 0000  combiner....r...
+000063f0: 0072 0600 0000 5a0d 6c69 656f 7073 2e73  .r....Z.lieops.s
+00006400: 6f6c 7665 7272 0700 0000 7208 0000 0072  olverr....r....r
+00006410: 0900 0000 5a17 6c69 656f 7073 2e73 6f6c  ....Z.lieops.sol
+00006420: 7665 722e 7370 6c69 7474 696e 6772 0a00  ver.splittingr..
+00006430: 0000 5a18 6c69 656f 7073 2e73 6f6c 7665  ..Z.lieops.solve
+00006440: 722e 6272 7574 6566 6f72 6365 720b 0000  r.bruteforcer...
+00006450: 0072 7100 0000 5a11 6c69 656f 7073 2e63  .rq...Z.lieops.c
+00006460: 6f72 652e 746f 6f6c 7372 1800 0000 da14  ore.toolsr......
+00006470: 6c69 656f 7073 2e63 6f72 652e 6269 726b  lieops.core.birk
+00006480: 686f 6666 723b 0000 0072 2000 0000 720f  hoffr;...r ...r.
+00006490: 0000 0072 1300 0000 7213 0000 0072 1300  ...r....r....r..
+000064a0: 0000 7214 0000 00da 083c 6d6f 6475 6c65  ..r......<module
+000064b0: 3e01 0000 0073 2400 0000 0800 0801 0801  >....s$.........
+000064c0: 0c02 0c02 0c01 0c01 1402 0c01 0c01 0802  ................
+000064d0: 0801 1002 0a56 0e2b 007f 007f 1406       .....V.+......
```

### Comparing `lieops-0.2.1/lieops/core/__pycache__/magnus.cpython-310.pyc` & `lieops-0.2.2/lieops/core/__pycache__/magnus.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/__pycache__/poly.cpython-310.pyc` & `lieops-0.2.2/lieops/core/__pycache__/poly.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.10, timestamp-based, .py timestamp: Sun Feb 19 11:41:37 2023 UTC, .py size: 30739 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 3% similar despite different names*

```diff
@@ -1,19 +1,19 @@
-00000000: 6f0d 0d0a 0000 0000 f10a f263 1378 0000  o..........c.x..
+00000000: 6f0d 0d0a 0000 0000 b44b 3e64 fb79 0000  o........K>d.y..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0003 0000 0040 0000 0073 4200 0000 6400  .....@...sB...d.
 00000030: 6401 6c00 5a01 6400 6402 6c02 6d03 5a03  d.l.Z.d.d.l.m.Z.
 00000040: 6d04 5a04 0100 6400 6403 6c05 6d06 5a06  m.Z...d.d.l.m.Z.
 00000050: 6d07 5a07 0100 4700 6404 6405 8400 6405  m.Z...G.d.d...d.
 00000060: 8302 5a08 6406 6407 8400 5a09 6401 5300  ..Z.d.d...Z.d.S.
 00000070: 2908 e900 0000 004e 2902 da06 6465 7269  )......N)...deri
 00000080: 7665 da07 6a65 7470 6f6c 7929 02da 0a63  ve..jetpoly)...c
 00000090: 6865 636b 5f7a 6572 6fda 0a66 6163 746f  heck_zero..facto
 000000a0: 7269 616c 7363 0000 0000 0000 0000 0000  rialsc..........
-000000b0: 0000 0000 0000 0400 0000 4000 0000 73da  ..........@...s.
+000000b0: 0000 0000 0000 0400 0000 4000 0000 73e2  ..........@...s.
 000000c0: 0100 0065 005a 0164 005a 0264 015a 0364  ...e.Z.d.Z.d.Z.d
 000000d0: 0264 0384 005a 0465 0564 0483 0166 0164  .d...Z.e.d...f.d
 000000e0: 0564 0684 015a 0667 0067 0064 0766 0364  .d...Z.g.g.d.f.d
 000000f0: 0864 0984 015a 0764 0a64 0b84 005a 0864  .d...Z.d.d...Z.d
 00000100: 0c64 0d84 005a 0964 0e64 0f84 005a 0a64  .d...Z.d.d...Z.d
 00000110: 1064 1184 0064 1064 1184 0064 129c 0264  .d...d.d...d...d
 00000120: 1364 1484 025a 0b64 1565 0c66 0264 1664  .d...Z.d.e.f.d.d
@@ -28,1927 +28,1940 @@
 000001b0: 1b64 3564 3684 005a 1c64 3764 3884 005a  .d5d6..Z.d7d8..Z
 000001c0: 1d64 3964 3a84 005a 1e64 3b64 3c84 005a  .d9d:..Z.d;d<..Z
 000001d0: 1f64 3d64 3e84 005a 2064 3f64 4084 005a  .d=d>..Z d?d@..Z
 000001e0: 2164 4164 4284 005a 2264 4364 4484 005a  !dAdB..Z"dCdD..Z
 000001f0: 2364 4564 4684 005a 2464 4764 4884 005a  #dEdF..Z$dGdH..Z
 00000200: 2564 4964 4a84 005a 2664 4b64 4c84 005a  %dIdJ..Z&dKdL..Z
 00000210: 2764 4d64 4e84 005a 2864 4f64 5084 005a  'dMdN..Z(dOdP..Z
-00000220: 2964 6e64 5165 0c66 0264 5264 5384 055a  )dndQe.f.dRdS..Z
-00000230: 2a64 5464 5584 005a 2b64 5664 5784 005a  *dTdU..Z+dVdW..Z
+00000220: 2964 5164 5284 005a 2a64 7064 5365 0c66  )dQdR..Z*dpdSe.f
+00000230: 0264 5464 5584 055a 2b64 5664 5784 005a  .dTdU..Z+dVdW..Z
 00000240: 2c64 5864 5984 005a 2d64 5a64 5b84 005a  ,dXdY..Z-dZd[..Z
 00000250: 2e64 5c64 5d84 005a 2f64 5e64 5f84 005a  .d\d]..Z/d^d_..Z
-00000260: 3064 6064 6184 005a 3169 0066 0164 6264  0d`da..Z1i.f.dbd
-00000270: 6384 015a 3264 6464 6584 005a 3364 6664  c..Z2ddde..Z3dfd
-00000280: 6784 005a 3464 6f64 6964 6a84 015a 3564  g..Z4dodidj..Z5d
-00000290: 7064 6b64 6c84 015a 3664 6d53 0029 71da  pdkdl..Z6dmS.)q.
-000002a0: 055f 706f 6c79 6140 0900 000a 2020 2020  ._polya@....    
-000002b0: 436c 6173 7320 746f 206d 6f64 656c 2074  Class to model t
-000002c0: 6865 204c 6965 206f 7065 7261 746f 7220  he Lie operator 
-000002d0: 3a70 3a2c 2077 6865 7265 2070 2069 7320  :p:, where p is 
-000002e0: 6120 706f 6c79 6e6f 6d69 616c 2067 6976  a polynomial giv
-000002f0: 656e 2069 6e20 7465 726d 7320 6f66 0a20  en in terms of. 
-00000300: 2020 2063 6f6d 706c 6578 2028 7869 2c20     complex (xi, 
-00000310: 6574 6129 2d63 6f6f 7264 696e 6174 6573  eta)-coordinates
-00000320: 2e20 466f 7220 7468 6520 6e6f 7461 7469  . For the notati
-00000330: 6f6e 206f 6620 7468 6573 6520 636f 6f72  on of these coor
-00000340: 6469 6e61 7465 7320 7365 6520 5265 662e  dinates see Ref.
-00000350: 205b 315d 2070 2e20 3333 206f 6e77 6172   [1] p. 33 onwar
-00000360: 6473 2e0a 2020 2020 496e 2074 6865 206c  ds..    In the l
-00000370: 6974 6572 6174 7572 6520 7468 6973 2070  iterature this p
-00000380: 6f6c 796e 6f6d 6961 6c20 6974 7365 6c66  olynomial itself
-00000390: 206d 6179 2062 6520 6361 6c6c 6564 2061   may be called a
-000003a0: 2022 4c69 6520 706f 6c79 6e6f 6d69 616c   "Lie polynomial
-000003b0: 222c 2073 6565 2065 2e67 2e20 5265 662e  ", see e.g. Ref.
-000003c0: 205b 325d 2e0a 2020 2020 0a20 2020 2050   [2]..    .    P
-000003d0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-000003e0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2076 616c  --------.    val
-000003f0: 7565 733a 2064 6963 742c 206f 7074 696f  ues: dict, optio
-00000400: 6e61 6c0a 2020 2020 2020 2020 4120 6469  nal.        A di
-00000410: 6374 696f 6e61 7279 2061 7373 6967 6e69  ctionary assigni
-00000420: 6e67 2074 6865 2070 6f77 6572 7320 6f66  ng the powers of
-00000430: 2074 6865 2078 692d 2061 6e64 2065 7461   the xi- and eta
-00000440: 2d76 6172 6961 626c 6573 2074 6f20 636f  -variables to co
-00000450: 6566 6669 6369 656e 7473 2c20 6d6f 6465  efficients, mode
-00000460: 6c69 6e67 206d 6f6e 6f6d 6961 6c73 2e0a  ling monomials..
-00000470: 2020 2020 2020 2020 4e6f 7465 2074 6861          Note tha
-00000480: 7420 6974 2069 7320 696e 7465 726e 616c  t it is internal
-00000490: 6c79 2061 7373 756d 6564 2074 6861 7420  ly assumed that 
-000004a0: 6576 6572 7920 636f 6566 6669 6369 656e  every coefficien
-000004b0: 7420 6973 206e 6f6e 2d7a 6572 6f20 616e  t is non-zero an
-000004c0: 6420 736f 207a 6572 6f2d 636f 6566 6669  d so zero-coeffi
-000004d0: 6369 656e 7473 2077 696c 6c0a 2020 2020  cients will.    
-000004e0: 2020 2020 6265 2064 6973 6361 7264 6564      be discarded
-000004f0: 2e20 506f 7765 7273 2077 6869 6368 2064  . Powers which d
-00000500: 6f20 6e6f 7420 6170 7065 6172 2069 6e20  o not appear in 
-00000510: 7468 6520 6469 6374 696f 6e61 7279 2061  the dictionary a
-00000520: 7265 2061 7373 756d 6564 2074 6f20 6265  re assumed to be
-00000530: 207a 6572 6f2e 0a20 2020 2020 2020 200a   zero..        .
-00000540: 2020 2020 613a 2074 7570 6c65 2c20 6f70      a: tuple, op
-00000550: 7469 6f6e 616c 0a20 2020 2020 2020 2049  tional.        I
-00000560: 6620 6e6f 2076 616c 7565 7320 7370 6563  f no values spec
-00000570: 6966 6965 642c 2074 6865 6e20 6f6e 6520  ified, then one 
-00000580: 6361 6e20 7370 6563 6966 7920 6120 7475  can specify a tu
-00000590: 706c 6520 6f66 2069 6e74 6567 6572 7320  ple of integers 
-000005a0: 6120 3d20 2861 312c 202e 2e2e 2c20 616e  a = (a1, ..., an
-000005b0: 2920 0a20 2020 2020 2020 2074 6f20 7365  ) .        to se
-000005c0: 7420 7468 6520 706f 7765 7273 206f 6620  t the powers of 
-000005d0: 7468 6520 6d6f 6e6f 6d69 616c 2078 6920  the monomial xi 
-000005e0: 3d20 7869 5f31 2a2a 6131 202a 202e 2e2e  = xi_1**a1 * ...
-000005f0: 202a 2078 695f 6e2a 2a61 6e2e 0a20 2020   * xi_n**an..   
-00000600: 2020 2020 200a 2020 2020 623a 2074 7570       .    b: tup
-00000610: 6c65 2c20 6f70 7469 6f6e 616c 0a20 2020  le, optional.   
-00000620: 2020 2020 2053 696d 696c 6172 2074 6f20       Similar to 
-00000630: 2761 272c 2074 6869 7320 7475 706c 6520  'a', this tuple 
-00000640: 7769 6c6c 2064 6566 696e 6520 7468 6520  will define the 
-00000650: 706f 7765 7273 206f 6620 7468 6520 6d6f  powers of the mo
-00000660: 6e6f 6d69 616c 2062 656c 6f6e 6769 6e67  nomial belonging
-00000670: 2074 6f20 7468 6520 6574 612d 7661 7269   to the eta-vari
-00000680: 6162 6c65 732e 0a20 2020 200a 2020 2020  ables..    .    
-00000690: 6d61 785f 706f 7765 723a 2069 6e74 2c20  max_power: int, 
-000006a0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-000006b0: 2041 6e20 696e 7465 6765 7220 6265 796f   An integer beyo
-000006c0: 6e64 2077 6520 646f 206e 6f74 2070 6572  nd we do not per
-000006d0: 666f 726d 2063 616c 6375 6c61 7469 6f6e  form calculation
-000006e0: 732e 2049 6e20 7061 7274 6963 756c 6172  s. In particular
-000006f0: 2069 7420 6973 2061 7373 756d 6564 2066   it is assumed f
-00000700: 6f72 2074 6865 2070 6f69 7373 6f6e 0a20  or the poisson. 
-00000710: 2020 2020 2020 2062 7261 636b 6574 2074         bracket t
-00000720: 6861 7420 7465 726d 7320 6265 796f 6e64  hat terms beyond
-00000730: 2074 6861 7420 696e 7465 6765 7220 6172   that integer ar
-00000740: 6520 7a65 726f 2e0a 2020 2020 2020 2020  e zero..        
-00000750: 4174 7465 6e74 696f 6e3a 0a20 2020 2020  Attention:.     
-00000760: 2020 2054 6865 2070 6f69 7373 6f6e 2062     The poisson b
-00000770: 7261 636b 6574 206f 6620 7477 6f20 686f  racket of two ho
-00000780: 6d6f 6765 6e65 6f75 7320 4c69 6520 706f  mogeneous Lie po
-00000790: 6c79 6e6f 6d69 616c 7320 6f66 206f 7264  lynomials of ord
-000007a0: 6572 7320 6e20 616e 6420 6d20 6861 7320  ers n and m has 
-000007b0: 6f72 6465 7220 4b20 3d20 6d20 2b20 6e20  order K = m + n 
-000007c0: 2d20 322e 200a 2020 2020 2020 2020 466f  - 2. .        Fo
-000007d0: 7220 6120 6765 6e65 7261 6c20 706f 6c79  r a general poly
-000007e0: 6e6f 6d69 616c 2c20 7765 2068 6176 6520  nomial, we have 
-000007f0: 696e 206f 7264 6572 204b 2061 2063 6f6e  in order K a con
-00000800: 7472 6962 7574 696f 6e20 6f66 206d 2077  tribution of m w
-00000810: 6869 6368 2063 6f75 6c64 2062 6520 652e  hich could be e.
-00000820: 672e 206f 6620 6f72 6465 7220 4b20 2b20  g. of order K + 
-00000830: 3120 0a20 2020 2020 2020 2028 7769 7468  1 .        (with
-00000840: 206e 203d 2031 292e 2054 6869 7320 6d65   n = 1). This me
-00000850: 616e 7320 7468 6174 206f 7264 6572 7320  ans that orders 
-00000860: 4b20 2b20 3120 7769 6c6c 2069 6e20 6765  K + 1 will in ge
-00000870: 6e65 7261 6c0a 2020 2020 2020 2020 636f  neral.        co
-00000880: 6e74 7269 6275 7465 2074 6f20 7468 6520  ntribute to the 
-00000890: 4b2d 7468 206f 7264 6572 2069 6e20 7468  K-th order in th
-000008a0: 6520 706f 6973 736f 6e20 6272 6163 6b65  e poisson bracke
-000008b0: 742c 206d 616b 696e 6720 7265 7065 6174  t, making repeat
-000008c0: 6564 2061 7070 6c69 6361 7469 6f6e 206f  ed application o
-000008d0: 660a 2020 2020 2020 2020 706f 6973 736f  f.        poisso
-000008e0: 6e20 6272 6163 6b65 7473 206e 6f74 2072  n brackets not r
-000008f0: 656c 6961 626c 6520 6966 206d 6178 5f70  eliable if max_p
-00000900: 6f77 6572 2069 7320 7365 7420 746f 6f20  ower is set too 
-00000910: 736d 616c 6c2e 0a0a 2020 2020 2020 2020  small...        
-00000920: 5370 6563 6966 6963 6961 6c6c 792c 2069  Specificially, i
-00000930: 6620 7765 2073 6574 206d 6178 5f70 6f77  f we set max_pow
-00000940: 6572 203d 204b 2066 6f72 2074 776f 204c  er = K for two L
-00000950: 6965 2070 6f6c 796e 6f6d 6961 6c73 2061  ie polynomials a
-00000960: 2061 6e64 2062 2c20 7468 656e 2069 6e20   and b, then in 
-00000970: 7b61 2c20 627d 206f 6e6c 7920 7468 6f73  {a, b} only thos
-00000980: 6520 706f 7765 7273 2075 7020 616e 6420  e powers up and 
-00000990: 696e 636c 7564 696e 6720 4b20 2d20 3120  including K - 1 
-000009a0: 6361 6e20 6265 2065 7870 6563 7465 6420  can be expected 
-000009b0: 746f 2062 6520 636f 7272 6563 742e 0a20  to be correct.. 
-000009c0: 2020 2020 2020 200a 2020 2020 6469 6d3a         .    dim:
-000009d0: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
-000009e0: 2020 2020 2020 2054 6865 206e 756d 6265         The numbe
-000009f0: 7220 6f66 2078 692d 2028 6f72 2065 7461  r of xi- (or eta
-00000a00: 2d29 2076 6172 6961 626c 6573 2e20 5769  -) variables. Wi
-00000a10: 6c6c 2062 6520 6465 7465 726d 696e 6564  ll be determined
-00000a20: 2061 7574 6f6d 6174 6963 616c 6c79 2066   automatically f
-00000a30: 726f 6d20 7468 6520 696e 7075 742c 2069  rom the input, i
-00000a40: 6620 6e6f 7468 696e 670a 2020 2020 2020  f nothing.      
-00000a50: 2020 7370 6563 6966 6965 642e 0a20 2020    specified..   
-00000a60: 2020 2020 200a 2020 2020 2a2a 6b77 6172       .    **kwar
-00000a70: 6773 0a20 2020 2020 2020 204f 7074 696f  gs.        Optio
-00000a80: 6e61 6c20 6172 6775 6d65 6e74 7320 7061  nal arguments pa
-00000a90: 7373 6564 2074 6f20 7365 6c66 2e73 6574  ssed to self.set
-00000aa0: 5f6d 6f6e 696d 6961 6c20 616e 6420 7365  _monimial and se
-00000ab0: 6c66 2e73 6574 5f6d 6178 5f70 6f77 6572  lf.set_max_power
-00000ac0: 0a20 2020 2020 2020 200a 2020 2020 5265  .        .    Re
-00000ad0: 6665 7265 6e63 6528 7329 3a0a 2020 2020  ference(s):.    
-00000ae0: 2020 2020 5b31 5d20 5469 747a 652c 204d      [1] Titze, M
-00000af0: 2e20 2253 7061 6365 2043 6861 7267 6520  . "Space Charge 
-00000b00: 4d6f 6465 6c69 6e67 2061 7420 7468 6520  Modeling at the 
-00000b10: 496e 7465 6765 7220 5265 736f 6e61 6e63  Integer Resonanc
-00000b20: 6520 666f 7220 7468 6520 4345 524e 2050  e for the CERN P
-00000b30: 5320 616e 6420 5350 5322 2028 3230 3139  S and SPS" (2019
-00000b40: 292e 0a20 2020 2020 2020 205b 325d 2043  )..        [2] C
-00000b50: 6173 6173 2c20 462e 2061 6e64 204d 7572  asas, F. and Mur
-00000b60: 7561 2c20 4d2e 2022 416e 2065 6666 6963  ua, M. "An effic
-00000b70: 6965 6e74 2061 6c67 6f72 6974 686d 2066  ient algorithm f
-00000b80: 6f72 2063 6f6d 7075 7469 6e67 2074 6865  or computing the
-00000b90: 2042 616b 6572 2d43 616d 7062 656c 6c2d   Baker-Campbell-
-00000ba0: 4861 7573 646f 7266 6620 7365 7269 6573  Hausdorff series
-00000bb0: 2061 6e64 2073 6f6d 6520 6f66 2069 7473   and some of its
-00000bc0: 2061 7070 6c69 6361 7469 6f6e 7322 2028   applications" (
-00000bd0: 3230 3038 2920 6172 5869 763a 3038 3130  2008) arXiv:0810
-00000be0: 2e32 3635 362e 0a20 2020 2063 0100 0000  .2656..    c....
-00000bf0: 0000 0000 0000 0000 0200 0000 0700 0000  ................
-00000c00: 4b00 0000 73b6 0000 007c 01a0 0064 0164  K...s....|...d.d
-00000c10: 02a1 027c 005f 0164 037c 01a0 02a1 0076  ...|._.d.|.....v
-00000c20: 0072 1a64 0464 0584 007c 0164 0319 00a0  .r.d.d...|.d....
-00000c30: 03a1 0044 0083 017c 005f 046e 1864 067c  ...D...|._.n.d.|
-00000c40: 01a0 02a1 0076 0073 2664 077c 01a0 02a1  .....v.s&d.|....
-00000c50: 0076 0072 2f7c 006a 0564 0b69 007c 01a4  .v.r/|.j.d.i.|..
-00000c60: 018e 0101 006e 0369 007c 005f 0474 067c  .....n.i.|._.t.|
-00000c70: 006a 0483 0164 086b 0272 417c 01a0 0064  .j...d.k.rA|...d
-00000c80: 0964 08a1 027c 005f 076e 107c 01a0 0064  .d...|._.n.|...d
-00000c90: 0974 0674 0874 097c 006a 0483 0183 0183  .t.t.t.|.j......
-00000ca0: 0164 0a1a 00a1 027c 005f 077c 006a 0a64  .d.....|._.|.j.d
-00000cb0: 0b69 007c 01a4 018e 0101 0064 0053 0029  .i.|.......d.S.)
-00000cc0: 0c4e da0e 706f 6973 736f 6e5f 6661 6374  .N..poisson_fact
-00000cd0: 6f72 f900 0000 0000 0000 8000 0000 0000  or..............
-00000ce0: 00f0 bfda 0676 616c 7565 7363 0100 0000  .....valuesc....
-00000cf0: 0000 0000 0000 0000 0300 0000 0400 0000  ................
-00000d00: 5300 0000 731e 0000 0069 007c 005d 0b5c  S...s....i.|.].\
-00000d10: 027d 017d 0274 007c 0283 0173 027c 017c  .}.}.t.|...s.|.|
-00000d20: 0293 0271 0253 00a9 0029 0172 0400 0000  ...q.S...).r....
-00000d30: a903 da02 2e30 da01 6bda 0176 720a 0000  .....0..k..vr...
-00000d40: 0072 0a00 0000 fa51 2f68 6f6d 652f 6d61  .r.....Q/home/ma
-00000d50: 6c74 652f 6d69 6e69 636f 6e64 6133 2f65  lte/miniconda3/e
-00000d60: 6e76 732f 776f 726b 2f6c 6962 2f70 7974  nvs/work/lib/pyt
-00000d70: 686f 6e33 2e31 302f 7369 7465 2d70 6163  hon3.10/site-pac
-00000d80: 6b61 6765 732f 6c69 656f 7073 2f63 6f72  kages/lieops/cor
-00000d90: 652f 706f 6c79 2e70 79da 0a3c 6469 6374  e/poly.py..<dict
-00000da0: 636f 6d70 3e43 0000 00f3 0200 0000 1e00  comp>C..........
-00000db0: 7a22 5f70 6f6c 792e 5f5f 696e 6974 5f5f  z"_poly.__init__
-00000dc0: 2e3c 6c6f 6361 6c73 3e2e 3c64 6963 7463  .<locals>.<dictc
-00000dd0: 6f6d 703e da01 61da 0162 7201 0000 00da  omp>..a..br.....
-00000de0: 0364 696d e902 0000 0072 0a00 0000 290b  .dim.....r....).
-00000df0: da03 6765 74da 0f5f 706f 6973 736f 6e5f  ..get.._poisson_
-00000e00: 6661 6374 6f72 da04 6b65 7973 da05 6974  factor..keys..it
-00000e10: 656d 73da 075f 7661 6c75 6573 da0c 7365  ems.._values..se
-00000e20: 745f 6d6f 6e6f 6d69 616c da03 6c65 6e72  t_monomial..lenr
-00000e30: 1400 0000 da04 6e65 7874 da04 6974 6572  ......next..iter
-00000e40: da0d 7365 745f 6d61 785f 706f 7765 72a9  ..set_max_power.
-00000e50: 02da 0473 656c 66da 066b 7761 7267 7372  ...self..kwargsr
-00000e60: 0a00 0000 720a 0000 0072 0f00 0000 da08  ....r....r......
-00000e70: 5f5f 696e 6974 5f5f 3500 0000 7314 0000  __init__5...s...
-00000e80: 000e 020c 0b1a 0118 0112 0106 020e 0210  ................
-00000e90: 0120 0214 027a 0e5f 706f 6c79 2e5f 5f69  . ...z._poly.__i
-00000ea0: 6e69 745f 5fda 0369 6e66 6302 0000 0000  nit__..infc.....
-00000eb0: 0000 0000 0000 0003 0000 0003 0000 000b  ................
-00000ec0: 0000 0073 2200 0000 8800 7c00 5f00 8700  ...s".....|._...
-00000ed0: 6601 6401 6402 8408 7c00 a001 a100 4400  f.d.d...|.....D.
-00000ee0: 8301 7c00 5f02 6403 5300 2904 61b7 0100  ..|._.d.S.).a...
-00000ef0: 000a 2020 2020 2020 2020 5365 7420 7468  ..        Set th
-00000f00: 6520 6d61 7869 6d61 6c20 706f 7765 7220  e maximal power 
-00000f10: 746f 2062 6520 7461 6b65 6e20 696e 746f  to be taken into
-00000f20: 2063 6f6e 7369 6465 7261 7469 6f6e 2e0a   consideration..
-00000f30: 2020 2020 2020 2020 4174 7465 6e74 696f          Attentio
-00000f40: 6e3a 2054 6869 7320 6f70 6572 6174 696f  n: This operatio
-00000f50: 6e20 7769 6c6c 2064 6973 6361 7264 2074  n will discard t
-00000f60: 6865 2063 7572 7265 6e74 2076 616c 7565  he current value
-00000f70: 7320 2a77 6974 686f 7574 2a20 7265 636f  s *without* reco
-00000f80: 7665 7279 2e0a 2020 2020 2020 2020 0a20  very..        . 
-00000f90: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00000fa0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00000fb0: 2d2d 2d2d 0a20 2020 2020 2020 206d 6178  ----.        max
-00000fc0: 5f70 6f77 6572 3a20 696e 742c 206f 7074  _power: int, opt
-00000fd0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-00000fe0: 2020 4120 7661 6c75 6520 3e20 3020 6d65    A value > 0 me
-00000ff0: 616e 7320 7468 6174 2061 6e79 2063 616c  ans that any cal
-00001000: 6375 6c61 7469 6f6e 7320 6c65 6164 696e  culations leadin
-00001010: 6720 746f 2065 7870 7265 7373 696f 6e73  g to expressions
-00001020: 2062 6579 6f6e 6420 7468 6973 200a 2020   beyond this .  
-00001030: 2020 2020 2020 2020 2020 6465 6772 6565            degree
-00001040: 2077 696c 6c20 6265 2064 6973 6361 7264   will be discard
-00001050: 6564 2e20 466f 7220 6269 6e61 7279 206f  ed. For binary o
-00001060: 7065 7261 7469 6f6e 7320 7468 6520 6d69  perations the mi
-00001070: 6e69 6d75 6d20 6f66 2062 6f74 6820 0a20  nimum of both . 
-00001080: 2020 2020 2020 2020 2020 206d 6178 5f70             max_p
-00001090: 6f77 6572 7320 6172 6520 7573 6564 2e0a  owers are used..
-000010a0: 2020 2020 2020 2020 6301 0000 0000 0000          c.......
-000010b0: 0000 0000 0003 0000 0004 0000 0013 0000  ................
-000010c0: 0073 2200 0000 6900 7c00 5d0d 5c02 7d01  .s"...i.|.].\.}.
-000010d0: 7d02 7400 7c01 8301 8800 6b01 7202 7c01  }.t.|.....k.r.|.
-000010e0: 7c02 9302 7102 5300 720a 0000 00a9 01da  |...q.S.r.......
-000010f0: 0373 756d 720b 0000 00a9 01da 096d 6178  .sumr........max
-00001100: 5f70 6f77 6572 720a 0000 0072 0f00 0000  _powerr....r....
-00001110: 7210 0000 005d 0000 0073 0200 0000 2200  r....]...s....".
-00001120: 7a27 5f70 6f6c 792e 7365 745f 6d61 785f  z'_poly.set_max_
-00001130: 706f 7765 722e 3c6c 6f63 616c 733e 2e3c  power.<locals>.<
-00001140: 6469 6374 636f 6d70 3e4e 2903 7228 0000  dictcomp>N).r(..
-00001150: 0072 1900 0000 721a 0000 0029 0372 2100  .r....r....).r!.
-00001160: 0000 7228 0000 0072 2200 0000 720a 0000  ..r(...r"...r...
-00001170: 0072 2700 0000 720f 0000 0072 1f00 0000  .r'...r....r....
-00001180: 5000 0000 7304 0000 0006 0c1c 017a 135f  P...s........z._
-00001190: 706f 6c79 2e73 6574 5f6d 6178 5f70 6f77  poly.set_max_pow
-000011a0: 6572 e901 0000 0063 0400 0000 0000 0000  er.....c........
-000011b0: 0000 0000 0600 0000 0500 0000 4b00 0000  ............K...
-000011c0: 736e 0000 0074 0074 017c 0183 0174 017c  sn...t.t.|...t.|
-000011d0: 0283 0167 0283 017d 0574 017c 0183 017c  ...g...}.t.|...|
-000011e0: 056b 0072 1b7c 0164 0167 017c 0574 017c  .k.r.|.d.g.|.t.|
-000011f0: 0183 0118 0014 0037 007d 0174 017c 0283  .......7.}.t.|..
-00001200: 017c 056b 0072 2c7c 0264 0167 017c 0574  .|.k.r,|.d.g.|.t
-00001210: 017c 0283 0118 0014 0037 007d 0274 027c  .|.......7.}.t.|
-00001220: 017c 0217 0083 017c 0369 017c 005f 0364  .|.....|.i.|._.d
-00001230: 0053 0029 024e 7201 0000 0029 04da 036d  .S.).Nr....)...m
-00001240: 6178 721c 0000 00da 0574 7570 6c65 721a  axr......tupler.
-00001250: 0000 0029 0672 2100 0000 7212 0000 0072  ...).r!...r....r
-00001260: 1300 0000 da05 7661 6c75 6572 2200 0000  ......valuer"...
-00001270: 7214 0000 0072 0a00 0000 720a 0000 0072  r....r....r....r
-00001280: 0f00 0000 721b 0000 005f 0000 0073 0c00  ....r...._...s..
-00001290: 0000 1401 0c01 1601 0c01 1601 1601 7a12  ..............z.
-000012a0: 5f70 6f6c 792e 7365 745f 6d6f 6e6f 6d69  _poly.set_monomi
-000012b0: 616c 6301 0000 0000 0000 0000 0000 0001  alc.............
-000012c0: 0000 0004 0000 0043 0000 00f3 2800 0000  .......C....(...
-000012d0: 7400 7c00 6a01 8301 6401 6b02 7209 6401  t.|.j...d.k.r.d.
-000012e0: 5300 7402 6402 6403 8400 7c00 a003 a100  S.t.d.d...|.....
-000012f0: 4400 8301 8301 5300 2904 7a47 0a20 2020  D.....S.).zG.   
-00001300: 2020 2020 204f 6274 6169 6e20 7468 6520       Obtain the 
-00001310: 6d61 7869 6d61 6c20 6465 6772 6565 206f  maximal degree o
-00001320: 6620 7468 6520 6375 7272 656e 7420 706f  f the current po
-00001330: 6c79 6e6f 6d69 616c 2e20 0a20 2020 2020  lynomial. .     
-00001340: 2020 2072 0100 0000 6301 0000 0000 0000     r....c.......
-00001350: 0000 0000 0003 0000 0004 0000 0053 0000  .............S..
-00001360: 00f3 1800 0000 6700 7c00 5d08 5c02 7d01  ......g.|.].\.}.
-00001370: 7d02 7400 7c01 8301 9102 7102 5300 720a  }.t.|.....q.S.r.
-00001380: 0000 0072 2500 0000 720b 0000 0072 0a00  ...r%...r....r..
-00001390: 0000 720a 0000 0072 0f00 0000 da0a 3c6c  ..r....r......<l
-000013a0: 6973 7463 6f6d 703e 6e00 0000 f302 0000  istcomp>n.......
-000013b0: 0018 007a 205f 706f 6c79 2e6d 6178 6465  ...z _poly.maxde
-000013c0: 672e 3c6c 6f63 616c 733e 2e3c 6c69 7374  g.<locals>.<list
-000013d0: 636f 6d70 3e29 0472 1c00 0000 721a 0000  comp>).r....r...
-000013e0: 0072 2a00 0000 7219 0000 00a9 0172 2100  .r*...r......r!.
-000013f0: 0000 720a 0000 0072 0a00 0000 720f 0000  ..r....r....r...
-00001400: 00da 066d 6178 6465 6767 0000 00f3 0600  ...maxdegg......
-00001410: 0000 0e04 0401 1602 7a0c 5f70 6f6c 792e  ........z._poly.
-00001420: 6d61 7864 6567 6301 0000 0000 0000 0000  maxdegc.........
-00001430: 0000 0001 0000 0004 0000 0043 0000 0072  ...........C...r
-00001440: 2d00 0000 2904 7a47 0a20 2020 2020 2020  -...).zG.       
-00001450: 204f 6274 6169 6e20 7468 6520 6d69 6e69   Obtain the mini
-00001460: 6d61 6c20 6465 6772 6565 206f 6620 7468  mal degree of th
-00001470: 6520 6375 7272 656e 7420 706f 6c79 6e6f  e current polyno
-00001480: 6d69 616c 2e20 0a20 2020 2020 2020 2072  mial. .        r
-00001490: 0100 0000 6301 0000 0000 0000 0000 0000  ....c...........
-000014a0: 0003 0000 0004 0000 0053 0000 0072 2e00  .........S...r..
-000014b0: 0000 720a 0000 0072 2500 0000 720b 0000  ..r....r%...r...
-000014c0: 0072 0a00 0000 720a 0000 0072 0f00 0000  .r....r....r....
-000014d0: 722f 0000 0077 0000 0072 3000 0000 7a20  r/...w...r0...z 
-000014e0: 5f70 6f6c 792e 6d69 6e64 6567 2e3c 6c6f  _poly.mindeg.<lo
-000014f0: 6361 6c73 3e2e 3c6c 6973 7463 6f6d 703e  cals>.<listcomp>
-00001500: 2904 721c 0000 0072 1a00 0000 da03 6d69  ).r....r......mi
-00001510: 6e72 1900 0000 7231 0000 0072 0a00 0000  nr....r1...r....
-00001520: 720a 0000 0072 0f00 0000 da06 6d69 6e64  r....r......mind
-00001530: 6567 7000 0000 7233 0000 007a 0c5f 706f  egp...r3...z._po
-00001540: 6c79 2e6d 696e 6465 6763 0100 0000 0000  ly.mindegc......
-00001550: 0000 0000 0000 0400 0000 0500 0000 4300  ..............C.
-00001560: 0000 7344 0000 0069 007d 017c 00a0 00a1  ..sD...i.}.|....
-00001570: 0044 005d 115c 027d 027d 0374 017c 0364  .D.].\.}.}.t.|.d
-00001580: 0183 0272 137c 03a0 02a1 007d 037c 037c  ...r.|.....}.|.|
-00001590: 017c 023c 0071 067c 006a 037c 017c 006a  .|.<.q.|.j.|.|.j
-000015a0: 047c 006a 0564 028d 0353 0029 034e da04  .|.j.d...S.).N..
-000015b0: 636f 7079 a903 7209 0000 0072 1400 0000  copy..r....r....
-000015c0: 7228 0000 0029 0672 1900 0000 da07 6861  r(...).r......ha
-000015d0: 7361 7474 7272 3600 0000 da09 5f5f 636c  sattrr6.....__cl
-000015e0: 6173 735f 5f72 1400 0000 7228 0000 0029  ass__r....r(...)
-000015f0: 0472 2100 0000 da0a 6e65 775f 7661 6c75  .r!.....new_valu
-00001600: 6573 720d 0000 0072 0e00 0000 720a 0000  esr....r....r...
-00001610: 0072 0a00 0000 720f 0000 0072 3600 0000  .r....r....r6...
-00001620: 7900 0000 730c 0000 0004 0110 010a 0108  y...s...........
-00001630: 010a 0114 017a 0a5f 706f 6c79 2e63 6f70  .....z._poly.cop
-00001640: 7963 0100 0000 0000 0000 0000 0000 0100  yc..............
-00001650: 0000 0100 0000 4300 0000 7304 0000 0064  ......C...s....d
-00001660: 0153 0029 024e 5472 0a00 0000 a901 da01  .S.).NTr........
-00001670: 7872 0a00 0000 720a 0000 0072 0f00 0000  xr....r....r....
-00001680: da08 3c6c 616d 6264 613e 8100 0000 7302  ..<lambda>....s.
-00001690: 0000 0004 007a 0e5f 706f 6c79 2e3c 6c61  .....z._poly.<la
-000016a0: 6d62 6461 3ea9 02da 086b 6579 5f63 6f6e  mbda>....key_con
-000016b0: 64da 0a76 616c 7565 5f63 6f6e 6463 0100  d..value_condc..
-000016c0: 0000 0000 0000 0200 0000 0400 0000 0500  ................
-000016d0: 0000 0700 0000 7356 0000 0074 007c 0383  ......sV...t.|..
-000016e0: 0164 016b 0272 1a88 016a 0187 0087 0266  .d.k.r...j.....f
-000016f0: 0264 0264 0384 0888 01a0 02a1 0044 0083  .d.d.........D..
-00001700: 0188 016a 0388 016a 0464 048d 0353 0088  ...j...j.d...S..
-00001710: 016a 0187 0166 0164 0564 0384 087c 0344  .j...f.d.d...|.D
-00001720: 0083 0188 016a 0388 016a 0464 048d 0353  .....j...j.d...S
-00001730: 0029 0661 1f03 0000 0a20 2020 2020 2020  .).a.....       
-00001740: 2045 7874 7261 6374 2061 204c 6965 2070   Extract a Lie p
-00001750: 6f6c 796e 6f6d 6961 6c20 6672 6f6d 2074  olynomial from t
-00001760: 6865 2063 7572 7265 6e74 204c 6965 2070  he current Lie p
-00001770: 6f6c 796e 6f6d 6961 6c2c 2062 6173 6564  olynomial, based
-00001780: 206f 6e20 6120 636f 6e64 6974 696f 6e2e   on a condition.
-00001790: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-000017a0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-000017b0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-000017c0: 2020 2020 2020 2020 6b65 795f 636f 6e64          key_cond
-000017d0: 3a20 6361 6c6c 6162 6c65 2c20 6f70 7469  : callable, opti
-000017e0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-000017f0: 2041 2066 756e 6374 696f 6e20 7768 6963   A function whic
-00001800: 6820 6d61 7073 2061 2067 6976 656e 2074  h maps a given t
-00001810: 7570 6c65 2028 616e 2069 6e64 6578 2920  uple (an index) 
-00001820: 746f 2061 2062 6f6f 6c65 616e 2e20 6b65  to a boolean. ke
-00001830: 795f 636f 6e64 2069 7320 7573 6564 2074  y_cond is used t
-00001840: 6f20 656e 666f 7263 6520 6120 636f 6e64  o enforce a cond
-00001850: 6974 696f 6e0a 2020 2020 2020 2020 2020  ition.          
-00001860: 2020 6f6e 2074 6865 206b 6579 7320 6f66    on the keys of
-00001870: 2074 6865 2063 7572 7265 6e74 2070 6f6c   the current pol
-00001880: 796e 6f6d 6961 6c2e 2046 6f72 2065 7861  ynomial. For exa
-00001890: 6d70 6c65 2027 6b65 795f 636f 6e64 203d  mple 'key_cond =
-000018a0: 206c 616d 6264 6120 783a 2073 756d 2878   lambda x: sum(x
-000018b0: 2920 3d3d 206b 2720 776f 756c 640a 2020  ) == k' would.  
-000018c0: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
-000018d0: 7468 6520 686f 6d6f 6765 6e65 6f75 7320  the homogeneous 
-000018e0: 7061 7274 206f 6620 7468 6520 6375 7272  part of the curr
-000018f0: 656e 7420 4c69 6520 706f 6c79 6e6f 6d69  ent Lie polynomi
-00001900: 616c 2028 7468 6973 2069 7320 7265 616c  al (this is real
-00001910: 697a 6564 2069 6e20 2773 656c 662e 686f  ized in 'self.ho
-00001920: 6d6f 6765 6e65 6f75 735f 7061 7274 2729  mogeneous_part')
-00001930: 2e0a 0a20 2020 2020 2020 2076 616c 7565  ...        value
-00001940: 5f63 6f6e 643a 2063 616c 6c61 626c 652c  _cond: callable,
-00001950: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00001960: 2020 2020 2020 4120 6675 6e63 7469 6f6e        A function
-00001970: 2077 6869 6368 206d 6170 7320 6120 6769   which maps a gi
-00001980: 7665 6e20 7661 6c75 6520 746f 2061 2062  ven value to a b
-00001990: 6f6f 6c65 616e 2e20 7661 6c75 655f 636f  oolean. value_co
-000019a0: 6e64 2069 7320 7573 6564 2074 6f20 656e  nd is used to en
-000019b0: 666f 7263 6520 6120 636f 6e64 6974 696f  force a conditio
-000019c0: 6e20 6f6e 2074 6865 2076 616c 7565 7320  n on the values 
-000019d0: 6f66 2074 6865 0a20 2020 2020 2020 2020  of the.         
-000019e0: 2020 2063 7572 7265 6e74 2070 6f6c 796e     current polyn
-000019f0: 6f6d 6961 6c2e 0a0a 2020 2020 2020 2020  omial...        
-00001a00: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-00001a10: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00001a20: 706f 6c79 0a20 2020 2020 2020 2020 2020  poly.           
-00001a30: 2054 6865 2065 7874 7261 6374 6564 204c   The extracted L
-00001a40: 6965 2070 6f6c 796e 6f6d 6961 6c2e 0a20  ie polynomial.. 
-00001a50: 2020 2020 2020 2072 0100 0000 6301 0000         r....c...
-00001a60: 0000 0000 0000 0000 0003 0000 0004 0000  ................
-00001a70: 0013 0000 0073 2600 0000 6900 7c00 5d0f  .....s&...i.|.].
-00001a80: 5c02 7d01 7d02 8800 7c01 8301 7202 8801  \.}.}...|...r...
-00001a90: 7c02 8301 7202 7c01 7c02 9302 7102 5300  |...r.|.|...q.S.
-00001aa0: 720a 0000 0072 0a00 0000 2903 720c 0000  r....r....).r...
-00001ab0: 00da 046b 6579 63da 0676 616c 7565 6372  ...keyc..valuecr
-00001ac0: 3e00 0000 720a 0000 0072 0f00 0000 7210  >...r....r....r.
-00001ad0: 0000 0096 0000 00f3 0200 0000 2600 7a21  ............&.z!
-00001ae0: 5f70 6f6c 792e 6578 7472 6163 742e 3c6c  _poly.extract.<l
-00001af0: 6f63 616c 733e 2e3c 6469 6374 636f 6d70  ocals>.<dictcomp
-00001b00: 3e72 3700 0000 6301 0000 0000 0000 0000  >r7...c.........
-00001b10: 0000 0002 0000 0005 0000 0013 0000 0073  ...............s
-00001b20: 1600 0000 6900 7c00 5d07 7d01 7c01 8800  ....i.|.].}.|...
-00001b30: 7c01 1900 9302 7102 5300 720a 0000 0072  |.....q.S.r....r
-00001b40: 0a00 0000 2902 720c 0000 00da 036b 6579  ....).r......key
-00001b50: 7231 0000 0072 0a00 0000 720f 0000 0072  r1...r....r....r
-00001b60: 1000 0000 9900 0000 f302 0000 0016 0029  ...............)
-00001b70: 0572 1c00 0000 7239 0000 0072 1900 0000  .r....r9...r....
-00001b80: 7214 0000 0072 2800 0000 2904 7221 0000  r....r(...).r!..
-00001b90: 0072 3f00 0000 7240 0000 0072 1800 0000  .r?...r@...r....
-00001ba0: 720a 0000 0029 0372 3f00 0000 7221 0000  r....).r?...r!..
-00001bb0: 0072 4000 0000 720f 0000 00da 0765 7874  .r@...r......ext
-00001bc0: 7261 6374 8100 0000 730a 0000 000c 141a  ract....s.......
-00001bd0: 0108 0106 ff22 037a 0d5f 706f 6c79 2e65  .....".z._poly.e
-00001be0: 7874 7261 6374 720d 0000 0063 0200 0000  xtractr....c....
-00001bf0: 0000 0000 0000 0000 0200 0000 0400 0000  ................
-00001c00: 0300 0000 f314 0000 007c 006a 0087 0066  .........|.j...f
-00001c10: 0164 0164 0284 0864 038d 0153 0029 0461  .d.d...d...S.).a
-00001c20: 1901 0000 0a20 2020 2020 2020 2045 7874  .....        Ext
-00001c30: 7261 6374 2074 6865 2068 6f6d 6f67 656e  ract the homogen
-00001c40: 656f 7573 2070 6172 7420 6f66 206f 7264  eous part of ord
-00001c50: 6572 206b 2066 726f 6d20 7468 6520 6375  er k from the cu
-00001c60: 7272 656e 7420 4c69 6520 706f 6c79 6e6f  rrent Lie polyno
-00001c70: 6d69 616c 2e0a 2020 2020 2020 2020 0a20  mial..        . 
-00001c80: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00001c90: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00001ca0: 2d2d 2d2d 0a20 2020 2020 2020 206b 3a20  ----.        k: 
-00001cb0: 696e 740a 2020 2020 2020 2020 2020 2020  int.            
-00001cc0: 5468 6520 7265 7175 6573 7465 6420 6f72  The requested or
-00001cd0: 6465 722e 0a20 2020 2020 2020 2020 2020  der..           
-00001ce0: 200a 2020 2020 2020 2020 5265 7475 726e   .        Return
-00001cf0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00001d00: 2d0a 2020 2020 2020 2020 706f 6c79 0a20  -.        poly. 
-00001d10: 2020 2020 2020 2020 2020 2054 6865 2065             The e
-00001d20: 7874 7261 6374 6564 2070 6f6c 796e 6f6d  xtracted polynom
-00001d30: 6961 6c2e 0a20 2020 2020 2020 2063 0100  ial..        c..
-00001d40: 0000 0000 0000 0000 0000 0100 0000 0200  ................
-00001d50: 0000 1300 0000 730c 0000 0074 007c 0083  ......s....t.|..
-00001d60: 0188 006b 0253 00a9 014e 7225 0000 0072  ...k.S...Nr%...r
-00001d70: 3b00 0000 a901 720d 0000 0072 0a00 0000  ;.....r....r....
-00001d80: 720f 0000 0072 3d00 0000 a900 0000 f302  r....r=.........
-00001d90: 0000 000c 007a 285f 706f 6c79 2e68 6f6d  .....z(_poly.hom
-00001da0: 6f67 656e 656f 7573 5f70 6172 742e 3c6c  ogeneous_part.<l
-00001db0: 6f63 616c 733e 2e3c 6c61 6d62 6461 3ea9  ocals>.<lambda>.
-00001dc0: 0172 3f00 0000 a901 7246 0000 00a9 0272  .r?.....rF.....r
-00001dd0: 2100 0000 720d 0000 0072 0a00 0000 7249  !...r....r....rI
-00001de0: 0000 0072 0f00 0000 da10 686f 6d6f 6765  ...r......homoge
-00001df0: 6e65 6f75 735f 7061 7274 9b00 0000 7302  neous_part....s.
-00001e00: 0000 0014 0e7a 165f 706f 6c79 2e68 6f6d  .....z._poly.hom
-00001e10: 6f67 656e 656f 7573 5f70 6172 74da 0374  ogeneous_part..t
-00001e20: 6f6c 6302 0000 0000 0000 0000 0000 0002  olc.............
-00001e30: 0000 0004 0000 0003 0000 0072 4700 0000  ...........rG...
-00001e40: 2904 616a 0100 000a 2020 2020 2020 2020  ).aj....        
-00001e50: 4472 6f70 2076 616c 7565 7320 6265 6c6f  Drop values belo
-00001e60: 7720 6120 6769 7665 6e20 7468 7265 7368  w a given thresh
-00001e70: 6f6c 642e 0a20 2020 2020 2020 200a 2020  old..        .  
-00001e80: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00001e90: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00001ea0: 2d2d 2d0a 2020 2020 2020 2020 746f 6c3a  ---.        tol:
-00001eb0: 2066 6c6f 6174 0a20 2020 2020 2020 2020   float.         
-00001ec0: 2020 2054 6865 2074 6872 6573 686f 6c64     The threshold
-00001ed0: 2e0a 2020 2020 2020 2020 2020 2020 0a20  ..            . 
-00001ee0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-00001ef0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-00001f00: 2020 2020 2020 2070 6f6c 790a 2020 2020         poly.    
-00001f10: 2020 2020 2020 2020 4120 706f 6c79 6e6f          A polyno
-00001f20: 6d69 616c 2068 6176 696e 6720 7468 6520  mial having the 
-00001f30: 7361 6d65 206b 6579 732f 7661 6c75 6573  same keys/values
-00001f40: 2061 7320 7468 6520 6375 7272 656e 7420   as the current 
-00001f50: 706f 6c79 6e6f 6d69 616c 2c20 6275 7420  polynomial, but 
-00001f60: 7468 6520 6162 736f 6c75 7465 2076 616c  the absolute val
-00001f70: 7565 7320 6172 6520 6c61 7267 6572 0a20  ues are larger. 
-00001f80: 2020 2020 2020 2020 2020 2074 6861 6e20             than 
-00001f90: 7468 6520 7265 7175 6573 7465 6420 7468  the requested th
-00001fa0: 7265 7368 6f6c 642e 0a20 2020 2020 2020  reshold..       
-00001fb0: 2063 0100 0000 0000 0000 0000 0000 0100   c..............
-00001fc0: 0000 0200 0000 1300 0000 730c 0000 0074  ..........s....t
-00001fd0: 007c 0083 0188 006b 0453 0072 4800 0000  .|.....k.S.rH...
-00001fe0: a901 da03 6162 7372 3b00 0000 a901 724f  ....absr;.....rO
-00001ff0: 0000 0072 0a00 0000 720f 0000 0072 3d00  ...r....r....r=.
-00002000: 0000 ba00 0000 724a 0000 007a 1d5f 706f  ......rJ...z._po
-00002010: 6c79 2e61 626f 7665 2e3c 6c6f 6361 6c73  ly.above.<locals
-00002020: 3e2e 3c6c 616d 6264 613e a901 7240 0000  >.<lambda>..r@..
-00002030: 0072 4c00 0000 a902 7221 0000 0072 4f00  .rL.....r!...rO.
-00002040: 0000 720a 0000 0072 5200 0000 720f 0000  ..r....rR...r...
-00002050: 00da 0561 626f 7665 ab00 0000 f302 0000  ...above........
-00002060: 0014 0f7a 0b5f 706f 6c79 2e61 626f 7665  ...z._poly.above
-00002070: 6302 0000 0000 0000 0000 0000 0002 0000  c...............
-00002080: 0004 0000 0003 0000 0072 4700 0000 2904  .........rG...).
-00002090: 616b 0100 000a 2020 2020 2020 2020 4472  ak....        Dr
-000020a0: 6f70 2076 616c 7565 7320 6162 6f76 6520  op values above 
-000020b0: 6120 6769 7665 6e20 7468 7265 7368 6f6c  a given threshol
-000020c0: 642e 0a20 2020 2020 2020 200a 2020 2020  d..        .    
-000020d0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-000020e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-000020f0: 2d0a 2020 2020 2020 2020 746f 6c3a 2066  -.        tol: f
-00002100: 6c6f 6174 0a20 2020 2020 2020 2020 2020  loat.           
-00002110: 2054 6865 2074 6872 6573 686f 6c64 2e0a   The threshold..
-00002120: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-00002130: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-00002140: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-00002150: 2020 2020 2070 6f6c 790a 2020 2020 2020       poly.      
-00002160: 2020 2020 2020 4120 706f 6c79 6e6f 6d69        A polynomi
-00002170: 616c 2068 6176 696e 6720 7468 6520 7361  al having the sa
-00002180: 6d65 206b 6579 732f 7661 6c75 6573 2061  me keys/values a
-00002190: 7320 7468 6520 6375 7272 656e 7420 706f  s the current po
-000021a0: 6c79 6e6f 6d69 616c 2c20 6275 7420 7468  lynomial, but th
-000021b0: 6520 6162 736f 6c75 7465 2076 616c 7565  e absolute value
-000021c0: 7320 6172 6520 736d 616c 6c65 720a 2020  s are smaller.  
-000021d0: 2020 2020 2020 2020 2020 7468 616e 2074            than t
-000021e0: 6865 2072 6571 7565 7374 6564 2074 6872  he requested thr
-000021f0: 6573 686f 6c64 2e0a 2020 2020 2020 2020  eshold..        
-00002200: 6301 0000 0000 0000 0000 0000 0001 0000  c...............
-00002210: 0002 0000 0013 0000 0073 0c00 0000 7400  .........s....t.
-00002220: 7c00 8301 8800 6b00 5300 7248 0000 0072  |.....k.S.rH...r
-00002230: 5000 0000 723b 0000 0072 5200 0000 720a  P...r;...rR...r.
-00002240: 0000 0072 0f00 0000 723d 0000 00cb 0000  ...r....r=......
-00002250: 0072 4a00 0000 7a1d 5f70 6f6c 792e 6265  .rJ...z._poly.be
-00002260: 6c6f 772e 3c6c 6f63 616c 733e 2e3c 6c61  low.<locals>.<la
-00002270: 6d62 6461 3e72 5300 0000 724c 0000 0072  mbda>rS...rL...r
-00002280: 5400 0000 720a 0000 0072 5200 0000 720f  T...r....rR...r.
-00002290: 0000 00da 0562 656c 6f77 bc00 0000 7256  .....below....rV
-000022a0: 0000 007a 0b5f 706f 6c79 2e62 656c 6f77  ...z._poly.below
-000022b0: 6301 0000 0000 0000 0000 0000 0001 0000  c...............
-000022c0: 0003 0000 0003 0000 0073 1600 0000 8700  .........s......
-000022d0: 6601 6401 6402 8408 8800 a000 a100 4400  f.d.d.........D.
-000022e0: 8301 5300 2903 7a4b 0a20 2020 2020 2020  ..S.).zK.       
-000022f0: 2052 6574 7572 6e20 6120 6c69 7374 206f   Return a list o
-00002300: 6620 7468 6520 6d6f 6e6f 6d69 616c 7320  f the monomials 
-00002310: 6f66 2074 6865 2063 7572 7265 6e74 2070  of the current p
-00002320: 6f6c 796e 6f6d 6961 6c2e 0a20 2020 2020  olynomial..     
-00002330: 2020 2063 0100 0000 0000 0000 0000 0000     c............
-00002340: 0300 0000 0700 0000 1300 0000 7328 0000  ............s(..
-00002350: 0067 007c 005d 105c 027d 017d 0288 006a  .g.|.].\.}.}...j
-00002360: 007c 017c 0269 0188 006a 0188 006a 0264  .|.|.i...j...j.d
-00002370: 008d 0391 0271 0253 0029 0172 3700 0000  .....q.S.).r7...
-00002380: 2903 7239 0000 0072 1400 0000 7228 0000  ).r9...r....r(..
-00002390: 0072 0b00 0000 7231 0000 0072 0a00 0000  .r....r1...r....
-000023a0: 720f 0000 0072 2f00 0000 d100 0000 f302  r....r/.........
-000023b0: 0000 0028 007a 235f 706f 6c79 2e6d 6f6e  ...(.z#_poly.mon
-000023c0: 6f6d 6961 6c73 2e3c 6c6f 6361 6c73 3e2e  omials.<locals>.
-000023d0: 3c6c 6973 7463 6f6d 703e 2901 7219 0000  <listcomp>).r...
-000023e0: 0072 3100 0000 720a 0000 0072 3100 0000  .r1...r....r1...
-000023f0: 720f 0000 00da 096d 6f6e 6f6d 6961 6c73  r......monomials
-00002400: cd00 0000 7302 0000 0016 047a 0f5f 706f  ....s......z._po
-00002410: 6c79 2e6d 6f6e 6f6d 6961 6c73 6302 0000  ly.monomialsc...
-00002420: 0000 0000 0000 0000 0002 0000 0004 0000  ................
-00002430: 0003 0000 0072 4700 0000 2904 7a50 0a20  .....rG...).zP. 
-00002440: 2020 2020 2020 2054 7275 6e63 6174 6520         Truncate 
-00002450: 7468 6520 6375 7272 656e 7420 706f 6c79  the current poly
-00002460: 6e6f 6d69 616c 2077 6974 6820 7265 7370  nomial with resp
-00002470: 6563 7420 746f 2061 2074 6f74 616c 2070  ect to a total p
-00002480: 6f77 6572 2e0a 2020 2020 2020 2020 6301  ower..        c.
-00002490: 0000 0000 0000 0000 0000 0001 0000 0002  ................
-000024a0: 0000 0013 0000 0073 0c00 0000 7400 7c00  .......s....t.|.
-000024b0: 8301 8800 6b01 5300 7248 0000 0072 2500  ....k.S.rH...r%.
-000024c0: 0000 723b 0000 0072 4900 0000 720a 0000  ..r;...rI...r...
-000024d0: 0072 0f00 0000 723d 0000 00d7 0000 0072  .r....r=.......r
-000024e0: 4a00 0000 7a20 5f70 6f6c 792e 7472 756e  J...z _poly.trun
-000024f0: 6361 7465 2e3c 6c6f 6361 6c73 3e2e 3c6c  cate.<locals>.<l
-00002500: 616d 6264 613e 724b 0000 0072 4c00 0000  ambda>rK...rL...
-00002510: 724d 0000 0072 0a00 0000 7249 0000 0072  rM...r....rI...r
-00002520: 0f00 0000 da08 7472 756e 6361 7465 d300  ......truncate..
-00002530: 0000 7302 0000 0014 047a 0e5f 706f 6c79  ..s......z._poly
-00002540: 2e74 7275 6e63 6174 6563 0100 0000 0000  .truncatec......
-00002550: 0000 0000 0000 0900 0000 0800 0000 0700  ................
-00002560: 0000 733e 0100 0074 0088 0183 017c 006a  ..s>...t.....|.j
-00002570: 016b 0272 1a7c 006a 0264 016b 0272 1a64  .k.r.|.j.d.k.r.d
-00002580: 0264 0384 0088 0144 0083 0164 0464 0384  .d.....D...d.d..
-00002590: 0088 0144 0083 0117 0089 017c 006a 0164  ...D.......|.j.d
-000025a0: 0514 007d 0274 0088 0183 017c 026b 0273  ...}.t.....|.k.s
-000025b0: 364a 0064 0674 0088 0183 019b 0064 077c  6J.d.t.......d.|
-000025c0: 029b 0064 087c 006a 019b 0064 099d 0783  ...d.|.j...d....
-000025d0: 0182 0169 007d 0364 0a89 0074 037c 00a0  ...i.}.d...t.|..
-000025e0: 04a1 008e 0044 005d 157d 0487 0087 0166  .....D.].}.....f
-000025f0: 0264 0b64 0c84 0874 05a0 067c 04a1 0144  .d.d...t...|...D
-00002600: 0083 017c 0388 003c 0088 0064 0d37 0089  ...|...<...d.7..
-00002610: 0071 4074 077c 0074 0888 0164 0a19 0083  .q@t.|.t...d....
-00002620: 0183 0272 6a7c 006a 0969 007c 006a 017c  ...rj|.j.i.|.j.|
-00002630: 006a 0a64 0e8d 037d 056e 0264 0a7d 057c  .j.d...}.n.d.}.|
-00002640: 00a0 0ba1 0044 005d 2c5c 027d 067d 0764  .....D.],\.}.}.d
-00002650: 0d7d 0874 0c7c 006a 0183 0144 005d 1a89  .}.t.|.j...D.]..
-00002660: 007c 087c 0388 0019 007c 0688 0019 0019  .|.|.....|......
-00002670: 007c 0388 007c 006a 0117 0019 007c 0688  .|...|.j.....|..
-00002680: 007c 006a 0117 0019 0019 0014 0039 007d  .|.j.........9.}
-00002690: 0871 7b7c 057c 087c 0714 0037 007d 0571  .q{|.|.|...7.}.q
-000026a0: 707c 0553 0029 0f61 c401 0000 0a20 2020  p|.S.).a.....   
-000026b0: 2020 2020 2045 7661 6c75 6174 6520 7468       Evaluate th
-000026c0: 6520 706f 6c79 6e6f 6d69 616c 2061 7420  e polynomial at 
-000026d0: 6120 7370 6563 6966 6963 2070 6f73 6974  a specific posit
-000026e0: 696f 6e20 7a2e 0a20 2020 2020 2020 200a  ion z..        .
-000026f0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00002700: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00002710: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7a3a  -----.        z:
-00002720: 2073 7562 7363 7269 7074 6162 6c65 0a20   subscriptable. 
-00002730: 2020 2020 2020 2020 2020 2054 6865 2070             The p
-00002740: 6f69 6e74 2061 7420 7768 6963 6820 7468  oint at which th
-00002750: 6520 706f 6c79 6e6f 6d69 616c 2073 686f  e polynomial sho
-00002760: 756c 6420 6265 2065 7661 6c75 6174 6564  uld be evaluated
-00002770: 2e20 4974 2069 7320 6173 7375 6d65 6420  . It is assumed 
-00002780: 7468 6174 206c 656e 287a 2920 3d3d 2073  that len(z) == s
-00002790: 656c 662e 6469 6d2c 0a20 2020 2020 2020  elf.dim,.       
-000027a0: 2020 2020 2069 6e20 7768 6963 6820 6361       in which ca
-000027b0: 7365 2074 6865 2063 6f6d 706f 6e65 6e74  se the component
-000027c0: 7320 6f66 207a 2061 7265 2061 7373 756d  s of z are assum
-000027d0: 6564 2074 6f20 6265 2078 692d 7661 6c75  ed to be xi-valu
-000027e0: 6573 2e20 4f74 6865 7277 6973 652c 2069  es. Otherwise, i
-000027f0: 7420 6973 2061 7373 756d 6564 2074 6861  t is assumed tha
-00002800: 7420 6c65 6e28 7a29 203d 3d20 322a 7365  t len(z) == 2*se
-00002810: 6c66 2e64 696d 2c0a 2020 2020 2020 2020  lf.dim,.        
-00002820: 2020 2020 7768 6572 6520 7a20 3d20 2878      where z = (x
-00002830: 692c 2065 7461 2920 6465 6e6f 7465 2061  i, eta) denote a
-00002840: 2073 6574 206f 6620 636f 6d70 6c65 7820   set of complex 
-00002850: 636f 6e6a 7567 6174 6564 2063 6f6f 7264  conjugated coord
-00002860: 696e 6174 6573 2e0a 2020 2020 2020 2020  inates..        
-00002870: 7208 0000 0063 0100 0000 0000 0000 0000  r....c..........
-00002880: 0000 0200 0000 0300 0000 5300 0000 7310  ..........S...s.
-00002890: 0000 0067 007c 005d 047d 017c 0191 0271  ...g.|.].}.|...q
-000028a0: 0253 0072 0a00 0000 720a 0000 00a9 0272  .S.r....r......r
-000028b0: 0c00 0000 da01 6572 0a00 0000 720a 0000  ......er....r...
-000028c0: 0072 0f00 0000 722f 0000 00e7 0000 0073  .r....r/.......s
-000028d0: 0200 0000 1000 7a22 5f70 6f6c 792e 5f5f  ......z"_poly.__
-000028e0: 6361 6c6c 5f5f 2e3c 6c6f 6361 6c73 3e2e  call__.<locals>.
-000028f0: 3c6c 6973 7463 6f6d 703e 6301 0000 0000  <listcomp>c.....
-00002900: 0000 0000 0000 0002 0000 0004 0000 0053  ...............S
-00002910: 0000 0073 1400 0000 6700 7c00 5d06 7d01  ...s....g.|.].}.
-00002920: 7c01 a000 a100 9102 7102 5300 720a 0000  |.......q.S.r...
-00002930: 0029 01da 0963 6f6e 6a75 6761 7465 725b  .)...conjugater[
-00002940: 0000 0072 0a00 0000 720a 0000 0072 0f00  ...r....r....r..
-00002950: 0000 722f 0000 00e7 0000 0073 0200 0000  ..r/.......s....
-00002960: 1400 7215 0000 007a 1c4e 756d 6265 7220  ..r....z.Number 
-00002970: 6f66 2069 6e70 7574 2070 6172 616d 6574  of input paramet
-00002980: 6572 733a 207a 0c2c 2065 7870 6563 7465  ers: z., expecte
-00002990: 643a 207a 0520 286f 7220 fa01 2972 0100  d: z. (or ..)r..
-000029a0: 0000 6301 0000 0000 0000 0000 0000 0002  ..c.............
-000029b0: 0000 0006 0000 0013 0000 0073 1e00 0000  ...........s....
-000029c0: 6900 7c00 5d0b 7d01 7c01 8801 8800 1900  i.|.].}.|.......
-000029d0: 7400 7c01 8301 1300 9302 7102 5300 720a  t.|.......q.S.r.
-000029e0: 0000 0029 01da 0369 6e74 a902 720c 0000  ...)...int..r...
-000029f0: 0072 0d00 0000 a902 da01 6ada 017a 720a  .r........j..zr.
-00002a00: 0000 0072 0f00 0000 7210 0000 00ef 0000  ...r....r.......
-00002a10: 0072 1100 0000 7a22 5f70 6f6c 792e 5f5f  .r....z"_poly.__
-00002a20: 6361 6c6c 5f5f 2e3c 6c6f 6361 6c73 3e2e  call__.<locals>.
-00002a30: 3c64 6963 7463 6f6d 703e 7229 0000 0072  <dictcomp>r)...r
-00002a40: 3700 0000 290d 721c 0000 0072 1400 0000  7...).r....r....
-00002a50: 7217 0000 00da 037a 6970 7218 0000 00da  r......zipr.....
-00002a60: 026e 70da 0675 6e69 7175 65da 0a69 7369  .np..unique..isi
-00002a70: 6e73 7461 6e63 65da 0474 7970 6572 3900  nstance..typer9.
-00002a80: 0000 7228 0000 0072 1900 0000 da05 7261  ..r(...r......ra
-00002a90: 6e67 6529 0972 2100 0000 7263 0000 00da  nge).r!...rc....
-00002aa0: 0464 696d 32da 087a 5f70 6f77 6572 73da  .dim2..z_powers.
-00002ab0: 0277 65da 0672 6573 756c 7472 0d00 0000  .we..resultr....
-00002ac0: 720e 0000 00da 0470 726f 6472 0a00 0000  r......prodr....
-00002ad0: 7261 0000 0072 0f00 0000 da08 5f5f 6361  ra...r......__ca
-00002ae0: 6c6c 5f5f d900 0000 7324 0000 0018 0c1c  ll__....s$......
-00002af0: 020a 012e 0104 0304 0110 011e 010a 0212  ................
-00002b00: 0316 0204 0210 0204 010e 0132 010e 0104  ...........2....
-00002b10: 027a 0e5f 706f 6c79 2e5f 5f63 616c 6c5f  .z._poly.__call_
-00002b20: 5f63 0200 0000 0000 0000 0000 0000 0700  _c..............
-00002b30: 0000 0500 0000 4300 0000 73c2 0000 007c  ......C...s....|
-00002b40: 0164 016b 0272 067c 0053 0064 0264 0384  .d.k.r.|.S.d.d..
-00002b50: 007c 00a0 00a1 0044 0083 017d 0274 017c  .|.....D...}.t.|
-00002b60: 0074 027c 0183 0183 0273 2b64 047c 006a  .t.|.....s+d.|.j
-00002b70: 0314 0064 0514 007d 037c 02a0 047c 0364  ...d...}.|...|.d
-00002b80: 01a1 027c 0117 007c 027c 033c 007c 006a  ...|...|.|.<.|.j
-00002b90: 057d 046e 2d7c 006a 037c 016a 036b 0273  .}.n-|.j.|.j.k.s
-00002ba0: 3d4a 0064 067c 006a 039b 0064 077c 016a  =J.d.|.j...d.|.j
-00002bb0: 039b 009d 0483 0182 017c 01a0 00a1 0044  .........|.....D
-00002bc0: 005d 0e5c 027d 057d 067c 02a0 047c 0564  .].\.}.}.|...|.d
-00002bd0: 01a1 027c 0617 007c 027c 053c 0071 4174  ...|...|.|.<.qAt
-00002be0: 067c 006a 057c 016a 0567 0283 017d 047c  .|.j.|.j.g...}.|
-00002bf0: 006a 077c 027c 006a 037c 0464 088d 0353  .j.|.|.j.|.d...S
-00002c00: 0029 094e 7201 0000 0063 0100 0000 0000  .).Nr....c......
-00002c10: 0000 0000 0000 0300 0000 0400 0000 5300  ..............S.
-00002c20: 0000 f316 0000 0069 007c 005d 075c 027d  .......i.|.].\.}
-00002c30: 017d 027c 017c 0293 0271 0253 0072 0a00  .}.|.|...q.S.r..
-00002c40: 0000 720a 0000 0072 0b00 0000 720a 0000  ..r....r....r...
-00002c50: 0072 0a00 0000 720f 0000 0072 1000 0000  .r....r....r....
-00002c60: 0501 0000 7245 0000 007a 215f 706f 6c79  ....rE...z!_poly
-00002c70: 2e5f 5f61 6464 5f5f 2e3c 6c6f 6361 6c73  .__add__.<locals
-00002c80: 3e2e 3c64 6963 7463 6f6d 703e a901 7201  >.<dictcomp>..r.
-00002c90: 0000 0072 1500 0000 fa19 4469 6d65 6e73  ...r......Dimens
-00002ca0: 696f 6e73 2064 6f20 6e6f 7420 6167 7265  ions do not agre
-00002cb0: 653a 20fa 0420 213d 2072 3700 0000 2908  e: .. != r7...).
-00002cc0: 7219 0000 0072 6700 0000 7268 0000 0072  r....rg...rh...r
-00002cd0: 1400 0000 7216 0000 0072 2800 0000 7234  ....r....r(...r4
-00002ce0: 0000 0072 3900 0000 2907 7221 0000 00da  ...r9...).r!....
-00002cf0: 056f 7468 6572 da0a 6164 645f 7661 6c75  .other..add_valu
-00002d00: 6573 da08 7a65 726f 5f74 706c 7228 0000  es..zero_tplr(..
-00002d10: 0072 0d00 0000 720e 0000 0072 0a00 0000  .r....r....r....
-00002d20: 720a 0000 0072 0f00 0000 da07 5f5f 6164  r....r......__ad
-00002d30: 645f 5f02 0100 0073 1800 0000 0801 0401  d__....s........
-00002d40: 1201 0e01 0e02 1401 0801 2402 1001 1601  ..........$.....
-00002d50: 1001 1201 7a0d 5f70 6f6c 792e 5f5f 6164  ....z._poly.__ad
-00002d60: 645f 5f63 0200 0000 0000 0000 0000 0000  d__c............
-00002d70: 0200 0000 0200 0000 4300 0000 7308 0000  ........C...s...
-00002d80: 007c 007c 0117 0053 0072 4800 0000 720a  .|.|...S.rH...r.
-00002d90: 0000 00a9 0272 2100 0000 7274 0000 0072  .....r!...rt...r
-00002da0: 0a00 0000 720a 0000 0072 0f00 0000 da08  ....r....r......
-00002db0: 5f5f 7261 6464 5f5f 1201 0000 7302 0000  __radd__....s...
-00002dc0: 0008 017a 0e5f 706f 6c79 2e5f 5f72 6164  ...z._poly.__rad
-00002dd0: 645f 5f63 0100 0000 0000 0000 0000 0000  d__c............
-00002de0: 0100 0000 0500 0000 4300 0000 7322 0000  ........C...s"..
-00002df0: 007c 006a 0064 0164 0284 007c 00a0 01a1  .|.j.d.d...|....
-00002e00: 0044 0083 017c 006a 027c 006a 0364 038d  .D...|.j.|.j.d..
-00002e10: 0353 0029 044e 6301 0000 0000 0000 0000  .S.).Nc.........
-00002e20: 0000 0003 0000 0004 0000 0053 0000 0073  ...........S...s
-00002e30: 1800 0000 6900 7c00 5d08 5c02 7d01 7d02  ....i.|.].\.}.}.
-00002e40: 7c01 7c02 0b00 9302 7102 5300 720a 0000  |.|.....q.S.r...
-00002e50: 0072 0a00 0000 720b 0000 0072 0a00 0000  .r....r....r....
-00002e60: 720a 0000 0072 0f00 0000 7210 0000 0016  r....r....r.....
-00002e70: 0100 0072 3000 0000 7a21 5f70 6f6c 792e  ...r0...z!_poly.
-00002e80: 5f5f 6e65 675f 5f2e 3c6c 6f63 616c 733e  __neg__.<locals>
-00002e90: 2e3c 6469 6374 636f 6d70 3e72 3700 0000  .<dictcomp>r7...
-00002ea0: a904 7239 0000 0072 1900 0000 7214 0000  ..r9...r....r...
-00002eb0: 0072 2800 0000 7231 0000 0072 0a00 0000  .r(...r1...r....
-00002ec0: 720a 0000 0072 0f00 0000 da07 5f5f 6e65  r....r......__ne
-00002ed0: 675f 5f15 0100 0073 0600 0000 1401 0801  g__....s........
-00002ee0: 06ff 7a0d 5f70 6f6c 792e 5f5f 6e65 675f  ..z._poly.__neg_
-00002ef0: 5f63 0200 0000 0000 0000 0000 0000 0200  _c..............
-00002f00: 0000 0200 0000 4300 0000 730a 0000 007c  ......C...s....|
-00002f10: 007c 010b 0017 0053 0072 4800 0000 720a  .|.....S.rH...r.
-00002f20: 0000 0072 7800 0000 720a 0000 0072 0a00  ...rx...r....r..
-00002f30: 0000 720f 0000 00da 075f 5f73 7562 5f5f  ..r......__sub__
-00002f40: 1901 0000 f302 0000 000a 017a 0d5f 706f  ...........z._po
-00002f50: 6c79 2e5f 5f73 7562 5f5f 6302 0000 0000  ly.__sub__c.....
-00002f60: 0000 0000 0000 0002 0000 0002 0000 0043  ...............C
-00002f70: 0000 0073 0a00 0000 7c00 0b00 7c01 1700  ...s....|...|...
-00002f80: 5300 7248 0000 0072 0a00 0000 7278 0000  S.rH...r....rx..
-00002f90: 0072 0a00 0000 720a 0000 0072 0f00 0000  .r....r....r....
-00002fa0: da08 5f5f 7273 7562 5f5f 1c01 0000 727d  ..__rsub__....r}
-00002fb0: 0000 007a 0e5f 706f 6c79 2e5f 5f72 7375  ...z._poly.__rsu
-00002fc0: 625f 5f63 0200 0000 0000 0000 0000 0000  b__c............
-00002fd0: 0200 0000 0300 0000 4300 0000 f30a 0000  ........C.......
-00002fe0: 007c 00a0 007c 01a1 0153 0072 4800 0000  .|...|...S.rH...
-00002ff0: 2901 da07 706f 6973 736f 6e72 7800 0000  )...poissonrx...
-00003000: 720a 0000 0072 0a00 0000 720f 0000 00da  r....r....r.....
-00003010: 0a5f 5f6d 6174 6d75 6c5f 5f1f 0100 0072  .__matmul__....r
-00003020: 7d00 0000 7a10 5f70 6f6c 792e 5f5f 6d61  }...z._poly.__ma
-00003030: 746d 756c 5f5f 6302 0000 0000 0000 0000  tmul__c.........
-00003040: 0000 000c 0000 0008 0000 0003 0000 0073  ...............s
-00003050: 9001 0000 7400 7c00 7401 7c01 8301 8302  ....t.|.t.|.....
-00003060: 7316 7402 6401 7c00 6a03 6a04 9b00 6402  s.t.d.|.j.j...d.
-00003070: 7c01 6a03 6a04 9b00 6403 9d05 8301 8201  |.j.j...d.......
-00003080: 7c00 6a05 7c01 6a05 6b02 7328 4a00 6404  |.j.|.j.k.s(J.d.
-00003090: 7c00 6a05 9b00 6405 7c01 6a05 9b00 9d04  |.j...d.|.j.....
-000030a0: 8301 8201 7406 7c00 6a07 7c01 6a07 6702  ....t.|.j.|.j.g.
-000030b0: 8301 7d02 6900 7d03 7c00 a008 a100 4400  ..}.i.}.|.....D.
-000030c0: 5d88 5c02 7d04 7d05 7409 7c04 8301 7d06  ].\.}.}.t.|...}.
-000030d0: 7c01 a008 a100 4400 5d7b 5c02 7d07 7d08  |.....D.]{\.}.}.
-000030e0: 7409 7c07 8301 7d09 7c06 7c09 1700 6406  t.|...}.|.|...d.
-000030f0: 1800 7c02 6b04 7253 7142 7c04 6407 7c00  ..|.k.rSqB|.d.|.
-00003100: 6a05 8502 1900 7c04 7c00 6a05 6407 8502  j.....|.|.j.d...
-00003110: 1900 0202 8900 8901 7c07 6407 7c00 6a05  ........|.d.|.j.
-00003120: 8502 1900 7c07 7c00 6a05 6407 8502 1900  ....|.|.j.d.....
-00003130: 0202 8902 8903 740a 7c00 6a05 8301 4400  ......t.|.j...D.
-00003140: 5d46 8904 8800 8804 1900 8803 8804 1900  ]F..............
-00003150: 1400 8801 8804 1900 8802 8804 1900 1400  ................
-00003160: 1800 7d0a 7c0a 6408 6b02 728d 7176 740b  ..}.|.d.k.r.qvt.
-00003170: 8700 8702 8704 6603 6409 640a 8408 740a  ......f.d.d...t.
-00003180: 7c00 6a05 8301 4400 8301 8701 8703 8704  |.j...D.........
-00003190: 6603 640b 640a 8408 740a 7c00 6a05 8301  f.d.d...t.|.j...
-000031a0: 4400 8301 1700 8301 7d0b 7c05 7c08 1400  D.......}.|.|...
-000031b0: 7c0a 1400 7c00 6a0c 1400 7c03 a00d 7c0b  |...|.j...|...|.
-000031c0: 6408 a102 1700 7c03 7c0b 3c00 7176 7142  d.....|.|.<.qvqB
-000031d0: 7136 7c00 6a03 7c03 7c00 6a05 7c02 640c  q6|.j.|.|.j.|.d.
-000031e0: 8d03 5300 290d 7a3b 0a20 2020 2020 2020  ..S.).z;.       
-000031f0: 2043 6f6d 7075 7465 2074 6865 2050 6f69   Compute the Poi
-00003200: 7373 6f6e 2d62 7261 636b 6574 207b 7365  sson-bracket {se
-00003210: 6c66 2c20 6f74 6865 727d 0a20 2020 2020  lf, other}.     
-00003220: 2020 207a 2a75 6e73 7570 706f 7274 6564     z*unsupported
-00003230: 206f 7065 7261 6e64 2074 7970 6528 7329   operand type(s)
-00003240: 2066 6f72 2070 6f69 7373 6f6e 3a20 277a   for poisson: 'z
-00003250: 0727 2061 6e64 2027 fa02 272e 7272 0000  .' and '..'.rr..
-00003260: 0072 7300 0000 7215 0000 004e 7201 0000  .rs...r....Nr...
-00003270: 0063 0100 0000 0000 0000 0000 0000 0200  .c..............
-00003280: 0000 0500 0000 1300 0000 f338 0000 0067  ...........8...g
-00003290: 007c 005d 187d 017c 0188 026b 0372 1088  .|.].}.|...k.r..
-000032a0: 007c 0119 0088 017c 0119 0017 006e 0988  .|.....|.....n..
-000032b0: 007c 0119 0088 017c 0119 0017 0064 0018  .|.....|.....d..
-000032c0: 0091 0271 0253 00a9 0172 2900 0000 720a  ...q.S...r)...r.
-000032d0: 0000 00a9 0272 0c00 0000 7262 0000 0029  .....r....rb...)
-000032e0: 0372 1200 0000 da01 6372 0d00 0000 720a  .r......cr....r.
-000032f0: 0000 0072 0f00 0000 722f 0000 0037 0100  ...r....r/...7..
-00003300: 00f3 0200 0000 3800 7a21 5f70 6f6c 792e  ......8.z!_poly.
-00003310: 706f 6973 736f 6e2e 3c6c 6f63 616c 733e  poisson.<locals>
-00003320: 2e3c 6c69 7374 636f 6d70 3e63 0100 0000  .<listcomp>c....
-00003330: 0000 0000 0000 0000 0200 0000 0500 0000  ................
-00003340: 1300 0000 7283 0000 0072 8400 0000 720a  ....r....r....r.
-00003350: 0000 0072 8500 0000 2903 7213 0000 00da  ...r....).r.....
-00003360: 0164 720d 0000 0072 0a00 0000 720f 0000  .dr....r....r...
-00003370: 0072 2f00 0000 3801 0000 7287 0000 0072  .r/...8...r....r
-00003380: 3700 0000 290e 7267 0000 0072 6800 0000  7...).rg...rh...
-00003390: da09 5479 7065 4572 726f 7272 3900 0000  ..TypeErrorr9...
-000033a0: da08 5f5f 6e61 6d65 5f5f 7214 0000 0072  ..__name__r....r
-000033b0: 3400 0000 7228 0000 0072 1900 0000 7226  4...r(...r....r&
-000033c0: 0000 0072 6900 0000 722b 0000 0072 1700  ...ri...r+...r..
-000033d0: 0000 7216 0000 0029 0c72 2100 0000 7274  ..r....).r!...rt
-000033e0: 0000 0072 2800 0000 da0e 706f 6973 736f  ...r(.....poisso
-000033f0: 6e5f 7661 6c75 6573 da02 7431 da02 7631  n_values..t1..v1
-00003400: da06 706f 7765 7231 da02 7432 da02 7632  ..power1..t2..v2
-00003410: da06 706f 7765 7232 da03 6465 74da 096e  ..power2..det..n
-00003420: 6577 5f70 6f77 6572 720a 0000 0029 0572  ew_powerr....).r
-00003430: 1200 0000 7213 0000 0072 8600 0000 7288  ....r....r....r.
-00003440: 0000 0072 0d00 0000 720f 0000 0072 8000  ...r....r....r..
-00003450: 0000 2201 0000 7330 0000 000e 041e 0124  .."...s0.......$
-00003460: 0110 0104 0110 0108 0110 0108 0110 0102  ................
-00003470: 011e 011e 010e 0120 0108 0102 011c 011a  ....... ........
-00003480: 0106 ff24 0202 fa02 fa12 0d7a 0d5f 706f  ...$.......z._po
-00003490: 6c79 2e70 6f69 7373 6f6e 6302 0000 0000  ly.poissonc.....
-000034a0: 0000 0000 0000 000a 0000 0006 0000 0003  ................
-000034b0: 0000 0073 ea00 0000 7400 7c00 7401 8800  ...s....t.|.t...
-000034c0: 8301 8302 7262 7c00 6a02 8800 6a02 6b02  ....rb|.j...j.k.
-000034d0: 730f 4a00 8201 6401 7c00 6a02 1400 7d02  s.J...d.|.j...}.
-000034e0: 7403 7c00 6a04 8800 6a04 6702 8301 7d03  t.|.j...j.g...}.
-000034f0: 6900 7d04 7c00 a005 a100 4400 5d36 5c02  i.}.|.....D.]6\.
-00003500: 8901 7d05 7406 8801 8301 7d06 8800 a005  ..}.t.....}.....
-00003510: a100 4400 5d29 5c02 8902 7d07 7406 8802  ..D.])\...}.t...
-00003520: 8301 7d08 7c06 7c08 1700 7c03 6b04 723d  ..}.|.|...|.k.r=
-00003530: 712e 7407 8701 8702 6602 6402 6403 8408  q.t.....f.d.d...
-00003540: 7408 7c02 8301 4400 8301 8301 7d09 7c04  t.|...D.....}.|.
-00003550: a009 7c09 6404 a102 7c05 7c07 1400 1700  ..|.d...|.|.....
-00003560: 7c04 7c09 3c00 712e 7122 7c00 6a0a 7c04  |.|.<.q.q"|.j.|.
-00003570: 7c00 6a02 7c03 6405 8d03 5300 7c00 6a0a  |.j.|.d...S.|.j.
-00003580: 8700 6601 6406 6407 8408 7c00 a005 a100  ..f.d.d...|.....
-00003590: 4400 8301 7c00 6a02 7c00 6a04 6405 8d03  D...|.j.|.j.d...
-000035a0: 5300 2908 4e72 1500 0000 6301 0000 0000  S.).Nr....c.....
-000035b0: 0000 0000 0000 0002 0000 0005 0000 0013  ................
-000035c0: 0000 0073 1c00 0000 6700 7c00 5d0a 7d01  ...s....g.|.].}.
-000035d0: 8800 7c01 1900 8801 7c01 1900 1700 9102  ..|.....|.......
-000035e0: 7102 5300 720a 0000 0072 0a00 0000 7260  q.S.r....r....r`
-000035f0: 0000 0029 0272 8c00 0000 728f 0000 0072  ...).r....r....r
-00003600: 0a00 0000 720f 0000 0072 2f00 0000 4801  ....r....r/...H.
-00003610: 0000 f302 0000 001c 007a 215f 706f 6c79  .........z!_poly
-00003620: 2e5f 5f6d 756c 5f5f 2e3c 6c6f 6361 6c73  .__mul__.<locals
-00003630: 3e2e 3c6c 6973 7463 6f6d 703e 7201 0000  >.<listcomp>r...
-00003640: 0072 3700 0000 6301 0000 0000 0000 0000  .r7...c.........
-00003650: 0000 0003 0000 0005 0000 0013 0000 0073  ...............s
-00003660: 1a00 0000 6900 7c00 5d09 5c02 7d01 7d02  ....i.|.].\.}.}.
-00003670: 7c01 7c02 8800 1400 9302 7102 5300 720a  |.|.......q.S.r.
-00003680: 0000 0072 0a00 0000 720b 0000 00a9 0172  ...r....r......r
-00003690: 7400 0000 720a 0000 0072 0f00 0000 7210  t...r....r....r.
-000036a0: 0000 004c 0100 00f3 0200 0000 1a00 7a21  ...L..........z!
-000036b0: 5f70 6f6c 792e 5f5f 6d75 6c5f 5f2e 3c6c  _poly.__mul__.<l
-000036c0: 6f63 616c 733e 2e3c 6469 6374 636f 6d70  ocals>.<dictcomp
-000036d0: 3e29 0b72 6700 0000 7268 0000 0072 1400  >).rg...rh...r..
-000036e0: 0000 7234 0000 0072 2800 0000 7219 0000  ..r4...r(...r...
-000036f0: 0072 2600 0000 722b 0000 0072 6900 0000  .r&...r+...ri...
-00003700: 7216 0000 0072 3900 0000 290a 7221 0000  r....r9...).r!..
-00003710: 0072 7400 0000 726a 0000 0072 2800 0000  .rt...rj...r(...
-00003720: da0b 6d75 6c74 5f76 616c 7565 7372 8d00  ..mult_valuesr..
-00003730: 0000 728e 0000 0072 9000 0000 7291 0000  ..r....r....r...
-00003740: 00da 0870 726f 645f 7470 6c72 0a00 0000  ...prod_tplr....
-00003750: 2903 7274 0000 0072 8c00 0000 728f 0000  ).rt...r....r...
-00003760: 0072 0f00 0000 da07 5f5f 6d75 6c5f 5f3c  .r......__mul__<
-00003770: 0100 0073 2000 0000 0e01 1001 0a01 1001  ...s ...........
-00003780: 0401 1001 0801 1001 0801 0c01 0201 1c01  ................
-00003790: 1a01 02fb 1206 2602 7a0d 5f70 6f6c 792e  ......&.z._poly.
-000037a0: 5f5f 6d75 6c5f 5f63 0200 0000 0000 0000  __mul__c........
-000037b0: 0000 0000 0200 0000 0300 0000 4300 0000  ............C...
-000037c0: 727f 0000 0072 4800 0000 2901 7299 0000  r....rH...).r...
-000037d0: 0072 7800 0000 720a 0000 0072 0a00 0000  .rx...r....r....
-000037e0: 720f 0000 00da 085f 5f72 6d75 6c5f 5f4e  r......__rmul__N
-000037f0: 0100 0072 7d00 0000 7a0e 5f70 6f6c 792e  ...r}...z._poly.
-00003800: 5f5f 726d 756c 5f5f 6302 0000 0000 0000  __rmul__c.......
-00003810: 0000 0000 0002 0000 0005 0000 0003 0000  ................
-00003820: 0073 3c00 0000 7400 7c00 7401 8800 8301  .s<...t.|.t.....
-00003830: 8302 731a 7c00 6a02 8700 6601 6401 6402  ..s.|.j...f.d.d.
-00003840: 8408 7c00 a003 a100 4400 8301 7c00 6a04  ..|.....D...|.j.
-00003850: 7c00 6a05 6403 8d03 5300 7406 6404 8301  |.j.d...S.t.d...
-00003860: 8201 2905 4e63 0100 0000 0000 0000 0000  ..).Nc..........
-00003870: 0000 0300 0000 0500 0000 1300 0000 731a  ..............s.
-00003880: 0000 0069 007c 005d 095c 027d 017d 027c  ...i.|.].\.}.}.|
-00003890: 017c 0288 001b 0093 0271 0253 0072 0a00  .|.......q.S.r..
-000038a0: 0000 720a 0000 0072 0b00 0000 7295 0000  ..r....r....r...
-000038b0: 0072 0a00 0000 720f 0000 0072 1000 0000  .r....r....r....
-000038c0: 5501 0000 7296 0000 007a 255f 706f 6c79  U...r....z%_poly
-000038d0: 2e5f 5f74 7275 6564 6976 5f5f 2e3c 6c6f  .__truediv__.<lo
-000038e0: 6361 6c73 3e2e 3c64 6963 7463 6f6d 703e  cals>.<dictcomp>
-000038f0: 7237 0000 007a 2944 6976 6973 696f 6e20  r7...z)Division 
-00003900: 6279 204c 6965 2070 6f6c 796e 6f6d 6961  by Lie polynomia
-00003910: 6c20 6e6f 7420 7375 7070 6f72 7465 642e  l not supported.
-00003920: 2907 7267 0000 0072 6800 0000 7239 0000  ).rg...rh...r9..
-00003930: 0072 1900 0000 7214 0000 0072 2800 0000  .r....r....r(...
-00003940: da13 4e6f 7449 6d70 6c65 6d65 6e74 6564  ..NotImplemented
-00003950: 4572 726f 7272 7800 0000 720a 0000 0072  Errorrx...r....r
-00003960: 9500 0000 720f 0000 00da 0b5f 5f74 7275  ....r......__tru
-00003970: 6564 6976 5f5f 5101 0000 7306 0000 000e  ediv__Q...s.....
-00003980: 0226 0208 027a 115f 706f 6c79 2e5f 5f74  .&...z._poly.__t
-00003990: 7275 6564 6976 5f5f 6302 0000 0000 0000  ruediv__c.......
-000039a0: 0000 0000 0004 0000 0005 0000 0043 0000  .............C..
-000039b0: 0073 8200 0000 7400 7c01 8301 7401 6b02  .s....t.|...t.k.
-000039c0: 7308 4a00 8201 7c01 6401 6b05 730e 4a00  s.J...|.d.k.s.J.
-000039d0: 8201 7c01 6401 6b02 7223 7c00 6a02 6402  ..|.d.k.r#|.j.d.
-000039e0: 7c00 6a03 1400 6403 1400 6404 6901 7c00  |.j...d...d.i.|.
-000039f0: 6a03 7c00 6a04 6405 8d03 5300 7c01 6404  j.|.j.d...S.|.d.
-00003a00: 6b02 7229 7c00 5300 7c01 6403 1600 7d02  k.r)|.S.|.d...}.
-00003a10: 7c00 7c01 6403 1a00 1300 7d03 7c02 6404  |.|.d.....}.|.d.
-00003a20: 6b02 723d 7c00 7c03 1400 7c03 1400 5300  k.r=|.|...|...S.
-00003a30: 7c03 7c03 1400 5300 2906 4e72 0100 0000  |.|...S.).Nr....
-00003a40: 7271 0000 0072 1500 0000 7229 0000 0072  rq...r....r)...r
-00003a50: 3700 0000 2905 7268 0000 0072 5f00 0000  7...).rh...r_...
-00003a60: 7239 0000 0072 1400 0000 7228 0000 0029  r9...r....r(...)
-00003a70: 0472 2100 0000 7274 0000 00da 0972 656d  .r!...rt.....rem
-00003a80: 6169 6e64 6572 da04 6861 6c66 720a 0000  ainder..halfr...
-00003a90: 0072 0a00 0000 720f 0000 00da 075f 5f70  .r....r......__p
-00003aa0: 6f77 5f5f 5901 0000 731a 0000 0010 010c  ow__Y...s.......
-00003ab0: 0108 0114 0108 0106 ff08 0204 0108 020c  ................
-00003ac0: 0108 010c 0108 027a 0d5f 706f 6c79 2e5f  .......z._poly._
-00003ad0: 5f70 6f77 5f5f 6301 0000 0000 0000 0000  _pow__c.........
-00003ae0: 0000 0001 0000 0005 0000 0003 0000 0073  ...............s
-00003af0: 2600 0000 8800 6a00 8700 6601 6401 6402  &.....j...f.d.d.
-00003b00: 8408 8800 a001 a100 4400 8301 8800 6a02  ........D.....j.
-00003b10: 8800 6a03 6403 8d03 5300 2904 4e63 0100  ..j.d...S.).Nc..
-00003b20: 0000 0000 0000 0000 0000 0300 0000 0600  ................
-00003b30: 0000 1300 0000 7332 0000 0069 007c 005d  ......s2...i.|.]
-00003b40: 155c 027d 017d 027c 0188 006a 0064 0085  .\.}.}.|...j.d..
-00003b50: 0219 007c 0164 0088 006a 0085 0219 0017  ...|.d...j......
-00003b60: 007c 02a0 01a1 0093 0271 0253 0072 4800  .|.......q.S.rH.
-00003b70: 0000 2902 7214 0000 0072 5d00 0000 720b  ..).r....r]...r.
-00003b80: 0000 0072 3100 0000 720a 0000 0072 0f00  ...r1...r....r..
-00003b90: 0000 7210 0000 006a 0100 0073 0200 0000  ..r....j...s....
-00003ba0: 3200 7a23 5f70 6f6c 792e 636f 6e6a 7567  2.z#_poly.conjug
-00003bb0: 6174 652e 3c6c 6f63 616c 733e 2e3c 6469  ate.<locals>.<di
-00003bc0: 6374 636f 6d70 3e72 3700 0000 727a 0000  ctcomp>r7...rz..
-00003bd0: 0072 3100 0000 720a 0000 0072 3100 0000  .r1...r....r1...
-00003be0: 720f 0000 0072 5d00 0000 6901 0000 7306  r....r]...i...s.
-00003bf0: 0000 0018 0108 0106 ff7a 0f5f 706f 6c79  .........z._poly
-00003c00: 2e63 6f6e 6a75 6761 7465 6301 0000 0000  .conjugatec.....
-00003c10: 0000 0000 0000 0001 0000 0002 0000 0043  ...............C
-00003c20: 0000 0073 0a00 0000 7400 7c00 6a01 8301  ...s....t.|.j...
-00003c30: 5300 7248 0000 0029 0272 1c00 0000 721a  S.rH...).r....r.
-00003c40: 0000 0072 3100 0000 720a 0000 0072 0a00  ...r1...r....r..
-00003c50: 0000 720f 0000 00da 075f 5f6c 656e 5f5f  ..r......__len__
-00003c60: 6d01 0000 727d 0000 007a 0d5f 706f 6c79  m...r}...z._poly
-00003c70: 2e5f 5f6c 656e 5f5f 6302 0000 0000 0000  .__len__c.......
-00003c80: 0000 0000 0002 0000 0005 0000 0043 0000  .............C..
-00003c90: 0073 4a00 0000 7400 7c00 7401 7c01 8301  .sJ...t.|.t.|...
-00003ca0: 8302 720d 7c00 6a02 7c01 6a02 6b02 5300  ..r.|.j.|.j.k.S.
-00003cb0: 7c00 a003 a100 6401 6b03 7215 6402 5300  |.....d.k.r.d.S.
-00003cc0: 7c00 a004 7405 6401 6701 6403 1400 7c00  |...t.d.g.d...|.
-00003cd0: 6a06 1400 8301 6401 a102 7c01 6b02 5300  j.....d...|.k.S.
-00003ce0: 2904 4e72 0100 0000 4672 1500 0000 2907  ).Nr....Fr....).
-00003cf0: 7267 0000 0072 6800 0000 721a 0000 0072  rg...rh...r....r
-00003d00: 3200 0000 7216 0000 0072 2b00 0000 7214  2...r....r+...r.
-00003d10: 0000 0072 7800 0000 720a 0000 0072 0a00  ...rx...r....r..
-00003d20: 0000 720f 0000 00da 065f 5f65 715f 5f70  ..r......__eq__p
-00003d30: 0100 0073 0a00 0000 0e01 0c01 0c02 0401  ...s............
-00003d40: 2002 7a0c 5f70 6f6c 792e 5f5f 6571 5f5f   .z._poly.__eq__
-00003d50: 6301 0000 0000 0000 0000 0000 0001 0000  c...............
-00003d60: 0002 0000 0043 0000 00f3 0a00 0000 7c00  .....C........|.
-00003d70: 6a00 a001 a100 5300 7248 0000 00a9 0272  j.....S.rH.....r
-00003d80: 1a00 0000 7218 0000 0072 3100 0000 720a  ....r....r1...r.
-00003d90: 0000 0072 0a00 0000 720f 0000 0072 1800  ...r....r....r..
-00003da0: 0000 7901 0000 727d 0000 007a 0a5f 706f  ..y...r}...z._po
-00003db0: 6c79 2e6b 6579 7363 0100 0000 0000 0000  ly.keysc........
-00003dc0: 0000 0000 0300 0000 0400 0000 4f00 0000  ............O...
-00003dd0: 7312 0000 007c 006a 006a 017c 0169 007c  s....|.j.j.|.i.|
-00003de0: 02a4 018e 0153 0072 4800 0000 2902 721a  .....S.rH...).r.
-00003df0: 0000 0072 1600 0000 2903 7221 0000 00da  ...r....).r!....
-00003e00: 0461 7267 7372 2200 0000 720a 0000 0072  .argsr"...r....r
-00003e10: 0a00 0000 720f 0000 0072 1600 0000 7c01  ....r....r....|.
-00003e20: 0000 7302 0000 0012 017a 095f 706f 6c79  ..s......z._poly
-00003e30: 2e67 6574 6301 0000 0000 0000 0000 0000  .getc...........
-00003e40: 0001 0000 0002 0000 0043 0000 0072 a200  .........C...r..
-00003e50: 0000 7248 0000 0029 0272 1a00 0000 7219  ..rH...).r....r.
-00003e60: 0000 0072 3100 0000 720a 0000 0072 0a00  ...r1...r....r..
-00003e70: 0000 720f 0000 0072 1900 0000 7f01 0000  ..r....r........
-00003e80: 727d 0000 007a 0b5f 706f 6c79 2e69 7465  r}...z._poly.ite
-00003e90: 6d73 6301 0000 0000 0000 0000 0000 0001  msc.............
-00003ea0: 0000 0002 0000 0043 0000 0072 a200 0000  .......C...r....
-00003eb0: 7248 0000 0029 0272 1a00 0000 7209 0000  rH...).r....r...
-00003ec0: 0072 3100 0000 720a 0000 0072 0a00 0000  .r1...r....r....
-00003ed0: 720f 0000 0072 0900 0000 8201 0000 727d  r....r........r}
-00003ee0: 0000 007a 0c5f 706f 6c79 2e76 616c 7565  ...z._poly.value
-00003ef0: 7363 0100 0000 0000 0000 0000 0000 0200  sc..............
-00003f00: 0000 0300 0000 6300 0000 7322 0000 0081  ......c...s"....
-00003f10: 007c 006a 00a0 01a1 0044 005d 087d 017c  .|.j.....D.].}.|
-00003f20: 006a 007c 0119 0056 0001 0071 0664 0053  .j.|...V...q.d.S
-00003f30: 0072 4800 0000 72a3 0000 00a9 0272 2100  .rH...r......r!.
-00003f40: 0000 7244 0000 0072 0a00 0000 720a 0000  ..rD...r....r...
-00003f50: 0072 0f00 0000 da08 5f5f 6974 6572 5f5f  .r......__iter__
-00003f60: 8501 0000 7308 0000 0002 800e 010e 0104  ....s...........
-00003f70: ff7a 0e5f 706f 6c79 2e5f 5f69 7465 725f  .z._poly.__iter_
-00003f80: 5f63 0200 0000 0000 0000 0000 0000 0200  _c..............
-00003f90: 0000 0200 0000 4300 0000 730a 0000 007c  ......C...s....|
-00003fa0: 006a 007c 0119 0053 0072 4800 0000 a901  .j.|...S.rH.....
-00003fb0: 721a 0000 0072 a500 0000 720a 0000 0072  r....r....r....r
-00003fc0: 0a00 0000 720f 0000 00da 0b5f 5f67 6574  ....r......__get
-00003fd0: 6974 656d 5f5f 8901 0000 727d 0000 007a  item__....r}...z
-00003fe0: 115f 706f 6c79 2e5f 5f67 6574 6974 656d  ._poly.__getitem
-00003ff0: 5f5f 6303 0000 0000 0000 0000 0000 0003  __c.............
-00004000: 0000 0003 0000 0043 0000 0073 0e00 0000  .......C...s....
-00004010: 7c02 7c00 6a00 7c01 3c00 6400 5300 7248  |.|.j.|.<.d.S.rH
-00004020: 0000 0072 a700 0000 2903 7221 0000 0072  ...r....).r!...r
-00004030: 4400 0000 7274 0000 0072 0a00 0000 720a  D...rt...r....r.
-00004040: 0000 0072 0f00 0000 da0b 5f5f 7365 7469  ...r......__seti
-00004050: 7465 6d5f 5f8c 0100 0073 0200 0000 0e01  tem__....s......
-00004060: 7a11 5f70 6f6c 792e 5f5f 7365 7469 7465  z._poly.__setite
-00004070: 6d5f 5f63 0100 0000 0000 0000 0000 0000  m__c............
-00004080: 0400 0000 0500 0000 4f00 0000 7338 0000  ........O...s8..
-00004090: 0064 0164 0284 007c 006a 00a0 01a1 0044  .d.d...|.j.....D
-000040a0: 0083 017d 037c 036a 027c 0169 007c 02a4  ...}.|.j.|.i.|..
-000040b0: 018e 0101 007c 006a 037c 037c 006a 047c  .....|.j.|.|.j.|
-000040c0: 006a 0564 038d 0353 0029 044e 6301 0000  .j.d...S.).Nc...
-000040d0: 0000 0000 0000 0000 0003 0000 0004 0000  ................
-000040e0: 0053 0000 0072 7000 0000 720a 0000 0072  .S...rp...r....r
-000040f0: 0a00 0000 720b 0000 0072 0a00 0000 720a  ....r....r....r.
-00004100: 0000 0072 0f00 0000 7210 0000 0090 0100  ...r....r.......
-00004110: 0072 4500 0000 7a1d 5f70 6f6c 792e 706f  .rE...z._poly.po
-00004120: 702e 3c6c 6f63 616c 733e 2e3c 6469 6374  p.<locals>.<dict
-00004130: 636f 6d70 3e72 3700 0000 2906 721a 0000  comp>r7...).r...
-00004140: 0072 1900 0000 da03 706f 7072 3900 0000  .r......popr9...
-00004150: 7214 0000 0072 2800 0000 2904 7221 0000  r....r(...).r!..
-00004160: 0072 a400 0000 7222 0000 0072 3a00 0000  .r....r"...r:...
-00004170: 720a 0000 0072 0a00 0000 720f 0000 0072  r....r....r....r
-00004180: aa00 0000 8f01 0000 7306 0000 0014 0110  ........s.......
-00004190: 0114 017a 095f 706f 6c79 2e70 6f70 6302  ...z._poly.popc.
-000041a0: 0000 0000 0000 0000 0000 0003 0000 0005  ................
-000041b0: 0000 0043 0000 0073 3000 0000 6401 6402  ...C...s0...d.d.
-000041c0: 8400 7c00 a000 a100 4400 8301 7d02 7c02  ..|.....D...}.|.
-000041d0: a001 7c01 a101 0100 7c00 6a02 7c02 7c00  ..|.....|.j.|.|.
-000041e0: 6a03 7c00 6a04 6403 8d03 5300 2904 4e63  j.|.j.d...S.).Nc
-000041f0: 0100 0000 0000 0000 0000 0000 0300 0000  ................
-00004200: 0400 0000 5300 0000 7270 0000 0072 0a00  ....S...rp...r..
-00004210: 0000 720a 0000 0072 0b00 0000 720a 0000  ..r....r....r...
-00004220: 0072 0a00 0000 720f 0000 0072 1000 0000  .r....r....r....
-00004230: 9501 0000 7245 0000 007a 205f 706f 6c79  ....rE...z _poly
-00004240: 2e75 7064 6174 652e 3c6c 6f63 616c 733e  .update.<locals>
-00004250: 2e3c 6469 6374 636f 6d70 3e72 3700 0000  .<dictcomp>r7...
-00004260: 2905 7219 0000 00da 0675 7064 6174 6572  ).r......updater
-00004270: 3900 0000 7214 0000 0072 2800 0000 2903  9...r....r(...).
-00004280: 7221 0000 0072 8800 0000 723a 0000 0072  r!...r....r:...r
-00004290: 0a00 0000 720a 0000 0072 0f00 0000 72ab  ....r....r....r.
-000042a0: 0000 0094 0100 0073 0600 0000 1201 0a01  .......s........
-000042b0: 1401 7a0c 5f70 6f6c 792e 7570 6461 7465  ..z._poly.update
-000042c0: da05 706f 7765 7263 0300 0000 0000 0000  ..powerc........
-000042d0: 0000 0000 0900 0000 0600 0000 4300 0000  ............C...
-000042e0: 73e0 0000 0074 007c 0074 017c 0183 0183  s....t.|.t.|....
-000042f0: 0273 1674 0264 017c 006a 036a 049b 0064  .s.t.d.|.j.j...d
-00004300: 027c 016a 036a 049b 0064 039d 0583 0182  .|.j.j...d......
-00004310: 017c 0264 046b 0573 1c4a 0082 0174 057c  .|.d.k.s.J...t.|
-00004320: 006a 067c 016a 0667 0283 017d 037c 00a0  .j.|.j.g...}.|..
-00004330: 07a1 007d 047c 0464 056b 0472 427c 0374  ...}.|.d.k.rB|.t
-00004340: 0864 0683 016b 0072 427c 01a0 07a1 007d  .d...k.rB|.....}
-00004350: 0574 057c 037c 0518 007c 0464 0518 001a  .t.|.|...|.d....
-00004360: 007c 0267 0283 017d 027c 006a 0364 0764  .|.g...}.|.j.d.d
-00004370: 0884 007c 01a0 09a1 0044 0083 017c 016a  ...|.....D...|.j
-00004380: 0a7c 0364 098d 037d 067c 0667 017d 0774  .|.d...}.|.g.}.t
-00004390: 0b7c 0283 0144 005d 147d 087c 007c 0610  .|...D.].}.|.|..
-000043a0: 007d 0674 0c7c 0683 0164 046b 0272 6801  .}.t.|...d.k.rh.
-000043b0: 007c 0753 007c 07a0 0d7c 06a1 0101 0071  .|.S.|...|.....q
-000043c0: 597c 0753 0029 0a61 b903 0000 0a20 2020  Y|.S.).a.....   
-000043d0: 2020 2020 2043 6f6d 7075 7465 2072 6570       Compute rep
-000043e0: 6561 7465 6420 506f 6973 736f 6e2d 6272  eated Poisson-br
-000043f0: 6163 6b65 7473 2e0a 2020 2020 2020 2020  ackets..        
-00004400: 452e 672e 206c 6574 2078 203d 2073 656c  E.g. let x = sel
-00004410: 662e 2054 6865 6e20 7b78 2c20 7b78 2c20  f. Then {x, {x, 
-00004420: 7b78 2c20 7b78 2c20 7b78 2c20 7b78 2c20  {x, {x, {x, {x, 
-00004430: 797d 7d7d 7d7d 7d20 3d3a 2078 2a2a 3628  y}}}}}} =: x**6(
-00004440: 7929 0a20 2020 2020 2020 2053 7065 6369  y).        Speci
-00004450: 616c 2063 6173 653a 2078 2a2a 3028 7929  al case: x**0(y)
-00004460: 203a 3d20 790a 2020 2020 2020 2020 0a20   := y.        . 
-00004470: 2020 2020 2020 204c 6574 207a 2062 6520         Let z be 
-00004480: 6120 686f 6d6f 6765 6e65 6f75 7320 4c69  a homogeneous Li
-00004490: 6520 706f 6c79 6e6f 6d69 616c 2061 6e64  e polynomial and
-000044a0: 2064 6567 287a 2920 7468 6520 6465 6772   deg(z) the degr
-000044b0: 6565 206f 6620 7a2e 2054 6865 6e20 6974  ee of z. Then it
-000044c0: 2068 6f6c 6473 0a20 2020 2020 2020 2064   holds.        d
-000044d0: 6567 2878 2a2a 6d28 7929 2920 3d20 6465  eg(x**m(y)) = de
-000044e0: 6728 7929 202b 206d 2a28 6465 6728 7829  g(y) + m*(deg(x)
-000044f0: 202d 2032 292e 0a20 2020 2020 2020 2054   - 2)..        T
-00004500: 6869 7320 616c 736f 2068 6f6c 6473 2066  his also holds f
-00004510: 6f72 2074 6865 206d 6178 696d 616c 2064  or the maximal d
-00004520: 6567 7265 6573 2061 6e64 206d 696e 696d  egrees and minim
-00004530: 616c 2064 6567 7265 6573 2069 6e20 6361  al degrees in ca
-00004540: 7365 2074 6861 7420 782c 2061 6e64 2079  se that x, and y
-00004550: 0a20 2020 2020 2020 2061 7265 2069 6e68  .        are inh
-00004560: 6f6d 6f67 656e 656f 7573 2e0a 2020 2020  omogeneous..    
-00004570: 2020 2020 0a20 2020 2020 2020 2054 6865      .        The
-00004580: 7265 666f 7265 2c20 6966 2078 2061 6e64  refore, if x and
-00004590: 2079 2062 6f74 6820 6861 7665 206e 6f6e   y both have non
-000045a0: 2d7a 6572 6f20 6d61 785f 706f 7765 7220  -zero max_power 
-000045b0: 6669 656c 6473 2c20 2773 656c 662e 706f  fields, 'self.po
-000045c0: 7765 7227 2077 696c 6c20 6e6f 7420 6576  wer' will not ev
-000045d0: 616c 7561 7465 0a20 2020 2020 2020 2074  aluate.        t
-000045e0: 6572 6d73 2078 2a2a 6d20 7769 7468 0a20  erms x**m with. 
-000045f0: 2020 2020 2020 206d 203e 3d20 6d69 6e28         m >= min(
-00004600: 5b28 6d61 785f 706f 7765 7220 2d20 6d69  [(max_power - mi
-00004610: 6e64 6567 2879 2929 2f2f 286d 696e 6465  ndeg(y))//(minde
-00004620: 6728 7829 202d 2032 292c 2070 6f77 6572  g(x) - 2), power
-00004630: 5d29 2e0a 2020 2020 2020 2020 0a20 2020  ])..        .   
-00004640: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-00004650: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00004660: 2d2d 0a20 2020 2020 2020 2079 3a20 706f  --.        y: po
-00004670: 6c79 0a20 2020 2020 2020 2020 2020 204c  ly.            L
-00004680: 6965 2070 6f6c 796e 6f6d 6961 6c20 7768  ie polynomial wh
-00004690: 6963 6820 7765 2077 616e 7420 746f 2065  ich we want to e
-000046a0: 7661 6c75 6174 6520 6f6e 0a0a 2020 2020  valuate on..    
-000046b0: 2020 2020 706f 7765 723a 2069 6e74 2c20      power: int, 
-000046c0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-000046d0: 2020 2020 204e 756d 6265 7220 6f66 2072       Number of r
-000046e0: 6570 6561 7465 6420 6272 6163 6b65 7473  epeated brackets
-000046f0: 2028 6465 6661 756c 743a 2031 292e 0a0a   (default: 1)...
-00004700: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00004710: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00004720: 0a20 2020 2020 2020 206c 6973 740a 2020  .        list.  
-00004730: 2020 2020 2020 2020 2020 4c69 7374 205b            List [
-00004740: 782a 2a6b 2879 2920 666f 7220 6b20 696e  x**k(y) for k in
-00004750: 2072 616e 6765 286e 202b 2031 295d 2c20   range(n + 1)], 
-00004760: 6966 206e 2069 7320 7468 6520 706f 7765  if n is the powe
-00004770: 7220 7265 7175 6573 7465 642e 0a20 2020  r requested..   
-00004780: 2020 2020 207a 2a75 6e73 7570 706f 7274       z*unsupport
-00004790: 6564 206f 7065 7261 6e64 2074 7970 6528  ed operand type(
-000047a0: 7329 2066 6f72 2061 646a 6f69 6e74 3a20  s) for adjoint: 
-000047b0: 277a 0627 206f 6e20 2772 8200 0000 7201  'z.' on 'r....r.
-000047c0: 0000 0072 1500 0000 7224 0000 0063 0100  ...r....r$...c..
-000047d0: 0000 0000 0000 0000 0000 0300 0000 0400  ................
-000047e0: 0000 5300 0000 7270 0000 0072 0a00 0000  ..S...rp...r....
-000047f0: 720a 0000 0072 0b00 0000 720a 0000 0072  r....r....r....r
-00004800: 0a00 0000 720f 0000 0072 1000 0000 c101  ....r....r......
-00004810: 0000 7245 0000 007a 1c5f 706f 6c79 2e61  ..rE...z._poly.a
-00004820: 642e 3c6c 6f63 616c 733e 2e3c 6469 6374  d.<locals>.<dict
-00004830: 636f 6d70 3e72 3700 0000 290e 7267 0000  comp>r7...).rg..
-00004840: 0072 6800 0000 7289 0000 0072 3900 0000  .rh...r....r9...
-00004850: 728a 0000 0072 3400 0000 7228 0000 0072  r....r4...r(...r
-00004860: 3500 0000 da05 666c 6f61 7472 1900 0000  5.....floatr....
-00004870: 7214 0000 0072 6900 0000 721c 0000 00da  r....ri...r.....
-00004880: 0661 7070 656e 6429 0972 2100 0000 da01  .append).r!.....
-00004890: 7972 ac00 0000 7228 0000 00da 086d 696e  yr....r(.....min
-000048a0: 6465 675f 78da 086d 696e 6465 675f 7972  deg_x..mindeg_yr
-000048b0: 6d00 0000 da0b 616c 6c5f 7265 7375 6c74  m.....all_result
-000048c0: 7372 0d00 0000 720a 0000 0072 0a00 0000  sr....r....r....
-000048d0: 720f 0000 00da 0261 6499 0100 0073 2600  r......ad....s&.
-000048e0: 0000 0e1d 1e01 0c01 1003 0801 1401 0801  ................
-000048f0: 1801 1402 0601 06ff 0602 0c02 0801 0c01  ................
-00004900: 0201 0402 0cff 0401 7a08 5f70 6f6c 792e  ........z._poly.
-00004910: 6164 6301 0000 0000 0000 0000 0000 0001  adc.............
-00004920: 0000 0003 0000 0043 0000 0073 0a00 0000  .......C...s....
-00004930: 7c00 a000 7401 a101 5300 7248 0000 0029  |...t...S.rH...)
-00004940: 02da 0561 7070 6c79 7251 0000 0072 3100  ...applyrQ...r1.
-00004950: 0000 720a 0000 0072 0a00 0000 720f 0000  ..r....r....r...
-00004960: 00da 075f 5f61 6273 5f5f cc01 0000 727d  ...__abs__....r}
-00004970: 0000 007a 0d5f 706f 6c79 2e5f 5f61 6273  ...z._poly.__abs
-00004980: 5f5f 6301 0000 0000 0000 0000 0000 0004  __c.............
-00004990: 0000 0006 0000 0043 0000 0073 4a00 0000  .......C...sJ...
-000049a0: 6401 7d01 7c00 a000 a100 4400 5d10 5c02  d.}.|.....D.].\.
-000049b0: 7d02 7d03 7c01 7c02 9b00 6402 7401 7c03  }.}.|.|...d.t.|.
-000049c0: 8301 9b00 6403 9d04 3700 7d01 7106 7402  ....d...7.}.q.t.
-000049d0: 7c01 8301 6404 6b04 7223 7c01 6400 6405  |...d.k.r#|.d.d.
-000049e0: 8502 1900 5300 6406 5300 2907 4eda 007a  ....S.d.S.).N..z
-000049f0: 023a 20fa 0120 7201 0000 00e9 ffff ffff  .: .. r.........
-00004a00: da01 3029 0372 1900 0000 da03 7374 7272  ..0).r......strr
-00004a10: 1c00 0000 2904 7221 0000 00da 036f 7574  ....).r!.....out
-00004a20: 720d 0000 0072 0e00 0000 720a 0000 0072  r....r....r....r
-00004a30: 0a00 0000 720f 0000 00da 075f 5f73 7472  ....r......__str
-00004a40: 5f5f cf01 0000 730c 0000 0004 0110 011a  __....s.........
-00004a50: 010c 010c 0104 027a 0d5f 706f 6c79 2e5f  .......z._poly._
-00004a60: 5f73 7472 5f5f 6301 0000 0000 0000 0000  _str__c.........
-00004a70: 0000 0001 0000 0003 0000 0043 0000 0073  ...........C...s
-00004a80: 1000 0000 6401 7c00 a000 a100 9b00 6402  ....d.|.......d.
-00004a90: 9d03 5300 2903 4e7a 063c 7361 6d70 3e7a  ..S.).Nz.<samp>z
-00004aa0: 073c 2f73 616d 703e 2901 72bc 0000 0072  .</samp>).r....r
-00004ab0: 3100 0000 720a 0000 0072 0a00 0000 720f  1...r....r....r.
-00004ac0: 0000 00da 0b5f 7265 7072 5f68 746d 6c5f  ....._repr_html_
-00004ad0: d801 0000 7302 0000 0010 017a 115f 706f  ....s......z._po
-00004ae0: 6c79 2e5f 7265 7072 5f68 746d 6c5f 6301  ly._repr_html_c.
-00004af0: 0000 0000 0000 0000 0000 0002 0000 0005  ................
-00004b00: 0000 004b 0000 0073 2600 0000 7c01 a000  ...K...s&...|...
-00004b10: 6401 6402 7c00 6a01 1400 a102 7c01 6401  d.d.|.j.....|.d.
-00004b20: 3c00 7402 7c00 6601 6900 7c01 a401 8e01  <.t.|.f.i.|.....
-00004b30: 5300 2903 6169 0200 000a 2020 2020 2020  S.).ai....      
-00004b40: 2020 4465 7269 7665 2074 6865 2063 7572    Derive the cur
-00004b50: 7265 6e74 204c 6965 2070 6f6c 796e 6f6d  rent Lie polynom
-00004b60: 6961 6c2e 0a20 2020 2020 2020 200a 2020  ial..        .  
-00004b70: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00004b80: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00004b90: 2d2d 2d0a 2020 2020 2020 2020 6f72 6465  ---.        orde
-00004ba0: 723a 2069 6e74 0a20 2020 2020 2020 2020  r: int.         
-00004bb0: 2020 2054 6865 206f 7264 6572 2062 7920     The order by 
-00004bc0: 7768 6963 6820 7765 2061 7265 2067 6f69  which we are goi
-00004bd0: 6e67 2074 6f20 6465 7269 7665 2074 6865  ng to derive the
-00004be0: 2070 6f6c 796e 6f6d 6961 6c2e 0a20 2020   polynomial..   
-00004bf0: 2020 2020 2020 2020 200a 2020 2020 2020           .      
-00004c00: 2020 2a2a 6b77 6172 6773 0a20 2020 2020    **kwargs.     
-00004c10: 2020 2020 2020 204f 7074 696f 6e61 6c20         Optional 
-00004c20: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
-00004c30: 7320 7061 7373 6564 2074 6f20 6e6a 6574  s passed to njet
-00004c40: 2e64 6572 6976 650a 2020 2020 2020 2020  .derive.        
-00004c50: 2020 2020 0a20 2020 2020 2020 2052 6574      .        Ret
-00004c60: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
-00004c70: 2d2d 2d2d 0a20 2020 2020 2020 2064 6572  ----.        der
-00004c80: 6976 650a 2020 2020 2020 2020 2020 2020  ive.            
-00004c90: 4120 636c 6173 7320 6f66 2074 7970 6520  A class of type 
-00004ca0: 6e6a 6574 2e61 642e 6465 7269 7665 2077  njet.ad.derive w
-00004cb0: 6974 6820 6e5f 6172 6773 3d32 2a73 656c  ith n_args=2*sel
-00004cc0: 662e 6469 6d20 7061 7261 6d65 7465 7273  f.dim parameters
-00004cd0: 2e0a 2020 2020 2020 2020 2020 2020 4e6f  ..            No
-00004ce0: 7465 2074 6861 7420 6120 6675 6e63 7469  te that a functi
-00004cf0: 6f6e 2065 7661 6c75 6174 696f 6e20 7368  on evaluation sh
-00004d00: 6f75 6c64 2062 6520 636f 6e73 6973 7465  ould be consiste
-00004d10: 6e74 2077 6974 6820 7468 6520 6661 6374  nt with the fact
-00004d20: 2074 6861 7420 0a20 2020 2020 2020 2020   that .         
-00004d30: 2020 2074 6865 206c 6173 7420 7365 6c66     the last self
-00004d40: 2e64 696d 2065 6e74 7269 6573 2061 7265  .dim entries are
-00004d50: 2074 6865 2063 6f6d 706c 6578 2063 6f6e   the complex con
-00004d60: 6a75 6761 7465 2076 616c 7565 7320 6f66  jugate values of
-00004d70: 2074 6865 200a 2020 2020 2020 2020 2020   the .          
-00004d80: 2020 6669 7273 7420 7365 6c66 2e64 696d    first self.dim
-00004d90: 2065 6e74 7269 6573 2e0a 2020 2020 2020   entries..      
-00004da0: 2020 da06 6e5f 6172 6773 7215 0000 0029    ..n_argsr....)
-00004db0: 0372 1600 0000 7214 0000 0072 0200 0000  .r....r....r....
-00004dc0: 7220 0000 0072 0a00 0000 720a 0000 0072  r ...r....r....r
-00004dd0: 0f00 0000 7202 0000 00db 0100 0073 0400  ....r........s..
-00004de0: 0000 1614 1001 7a0c 5f70 6f6c 792e 6465  ......z._poly.de
-00004df0: 7269 7665 6302 0000 0000 0000 0000 0000  rivec...........
-00004e00: 0003 0000 0004 0000 004b 0000 0073 2a00  .........K...s*.
-00004e10: 0000 6401 7c02 a000 a100 7601 720b 7c00  ..d.|.....v.r.|.
-00004e20: 6a01 7c02 6401 3c00 7402 7c00 6701 7c01  j.|.d.<.t.|.g.|.
-00004e30: 6602 6900 7c02 a401 8e01 5300 2902 61ad  f.i.|.....S.).a.
-00004e40: 0300 000a 2020 2020 2020 2020 4c65 7420  ....        Let 
-00004e50: 3a78 3a20 7265 7072 6573 656e 7420 7468  :x: represent th
-00004e60: 6520 6375 7272 656e 7420 4c69 6520 706f  e current Lie po
-00004e70: 6c79 6e6f 6d69 616c 2e20 4465 7065 6e64  lynomial. Depend
-00004e80: 696e 6720 6f6e 2074 6865 2069 6e70 7574  ing on the input
-00004e90: 2c0a 2020 2020 2020 2020 7468 6973 2072  ,.        this r
-00004ea0: 6f75 7469 6e65 2077 696c 6c20 6569 7468  outine will eith
-00004eb0: 6572 2072 6574 7572 6e20 7468 6520 6d61  er return the ma
-00004ec0: 7020 6628 7829 206f 7220 7468 6520 4c69  p f(x) or the Li
-00004ed0: 6520 706f 6c79 6e6f 6d69 616c 203a 6628  e polynomial :f(
-00004ee0: 7829 3a2e 0a20 2020 2020 2020 200a 2020  x):..        .  
-00004ef0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00004f00: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00004f10: 2d2d 2d0a 2020 2020 2020 2020 663a 2063  ---.        f: c
-00004f20: 616c 6c61 626c 650a 2020 2020 2020 2020  allable.        
-00004f30: 2020 2020 4120 6675 6e63 7469 6f6e 2064      A function d
-00004f40: 6570 656e 6469 6e67 206f 6e20 6120 7369  epending on a si
-00004f50: 6e67 6c65 2070 6172 616d 6574 6572 2e20  ngle parameter. 
-00004f60: 4974 206e 6565 6473 2074 6f20 6265 2073  It needs to be s
-00004f70: 7570 706f 7274 6564 2062 7920 7468 6520  upported by the 
-00004f80: 6e6a 6574 206d 6f64 756c 652e 0a20 2020  njet module..   
-00004f90: 2020 2020 2020 2020 200a 2020 2020 2020           .      
-00004fa0: 2020 2a2a 6b77 6172 6773 0a20 2020 2020    **kwargs.     
-00004fb0: 2020 2020 2020 2041 6464 6974 696f 6e61         Additiona
-00004fc0: 6c20 7061 7261 6d65 7465 7273 2070 6173  l parameters pas
-00004fd0: 7365 6420 746f 206c 6965 2e63 6f6e 7374  sed to lie.const
-00004fe0: 7275 6374 2072 6f75 7469 6e65 2e0a 2020  ruct routine..  
-00004ff0: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
-00005000: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-00005010: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-00005020: 2020 2063 616c 6c61 626c 6520 6f72 2070     callable or p
-00005030: 6f6c 790a 2020 2020 2020 2020 2020 2020  oly.            
-00005040: 5468 6520 6f75 7470 7574 2064 6570 656e  The output depen
-00005050: 6473 206f 6e20 7468 6520 6f70 7469 6f6e  ds on the option
-00005060: 616c 2061 7267 756d 656e 7420 2770 6f77  al argument 'pow
-00005070: 6572 272e 0a20 2020 2020 2020 2020 2020  er'..           
-00005080: 200a 2020 2020 2020 2020 2020 2020 4966   .            If
-00005090: 206e 6f20 6172 6775 6d65 6e74 2027 706f   no argument 'po
-000050a0: 7765 7227 2068 6173 2062 6565 6e20 7061  wer' has been pa
-000050b0: 7373 6564 2c20 7468 656e 2069 7420 7769  ssed, then it wi
-000050c0: 6c6c 0a20 2020 2020 2020 2020 2020 2062  ll.            b
-000050d0: 6520 7461 6b65 6e20 6672 6f6d 2074 6865  e taken from the
-000050e0: 2063 7572 7265 6e74 2076 616c 7565 2073   current value s
-000050f0: 656c 662e 6d61 785f 706f 7765 722e 0a20  elf.max_power.. 
-00005100: 2020 2020 2020 2020 2020 200a 2020 2020             .    
-00005110: 2020 2020 2020 2020 4966 2070 6f77 6572          If power
-00005120: 203c 2066 6c6f 6174 2827 696e 6627 292c   < float('inf'),
-00005130: 2074 6865 6e20 7468 6520 4c69 6520 706f   then the Lie po
-00005140: 6c79 6e6f 6d69 616c 203a 6628 7829 3a20  lynomial :f(x): 
-00005150: 6973 2072 6574 7572 6e65 642c 0a20 2020  is returned,.   
-00005160: 2020 2020 2020 2020 2077 6865 7265 2066           where f
-00005170: 2068 6173 2062 6565 6e20 6578 7061 6e64   has been expand
-00005180: 6564 2075 7020 746f 2074 6865 2073 7065  ed up to the spe
-00005190: 6369 6669 6564 2070 6f77 6572 2e20 4966  cified power. If
-000051a0: 2070 6f77 6572 203d 3d20 666c 6f61 7428   power == float(
-000051b0: 2769 6e66 2729 2c0a 2020 2020 2020 2020  'inf'),.        
-000051c0: 2020 2020 7468 656e 2074 6865 2066 756e      then the fun
-000051d0: 6374 696f 6e20 6628 7829 2069 7320 7265  ction f(x) is re
-000051e0: 7475 726e 6564 2e0a 2020 2020 2020 2020  turned..        
-000051f0: 72ac 0000 0029 0372 1800 0000 7228 0000  r....).r....r(..
-00005200: 00da 0963 6f6e 7374 7275 6374 2903 7221  ...construct).r!
-00005210: 0000 00da 0166 7222 0000 0072 0a00 0000  .....fr"...r....
-00005220: 720a 0000 0072 0f00 0000 72bf 0000 00f2  r....r....r.....
-00005230: 0100 0073 0600 0000 0c19 0a01 1401 7a0f  ...s..........z.
-00005240: 5f70 6f6c 792e 636f 6e73 7472 7563 7463  _poly.constructc
-00005250: 0100 0000 0000 0000 0000 0000 0400 0000  ................
-00005260: 0800 0000 0300 0000 7380 0000 0064 017c  ........s....d.|
-00005270: 006a 0014 0064 0214 007d 0169 007d 027c  .j...d...}.i.}.|
-00005280: 017c 00a0 01a1 0076 0072 197c 006a 027c  .|.....v.r.|.j.|
-00005290: 0119 007c 0274 0364 0367 0183 013c 007c  ...|.t.d.g...<.|
-000052a0: 00a0 04a1 0044 005d 1d5c 0289 007d 0374  .....D.].\...}.t
-000052b0: 0588 0083 0164 046b 0272 2871 1d7c 037c  .....d.k.r(q.|.|
-000052c0: 0274 0387 0066 0164 0564 0684 0874 067c  .t...f.d.d...t.|
-000052d0: 006a 0064 0214 0083 0144 0083 0183 013c  .j.d.....D.....<
-000052e0: 0071 1d74 077c 0264 078d 0153 0029 087a  .q.t.|.d...S.).z
-000052f0: e10a 2020 2020 2020 2020 4d61 7020 7468  ..        Map th
-00005300: 6520 6375 7272 656e 7420 4c69 6520 706f  e current Lie po
-00005310: 6c79 6e6f 6d69 616c 2074 6f20 616e 206e  lynomial to an n
-00005320: 6a65 7420 6a65 7470 6f6c 7920 636c 6173  jet jetpoly clas
-00005330: 732e 0a20 2020 2020 2020 200a 2020 2020  s..        .    
-00005340: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-00005350: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00005360: 2020 2020 6a65 7470 6f6c 790a 2020 2020      jetpoly.    
-00005370: 2020 2020 2020 2020 4120 6a65 7470 6f6c          A jetpol
-00005380: 7920 636c 6173 7320 6f66 2073 656c 662e  y class of self.
-00005390: 6469 6d2a 3220 7661 7269 6162 6c65 732c  dim*2 variables,
-000053a0: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
-000053b0: 6520 6375 7272 656e 7420 4c69 6520 706f  e current Lie po
-000053c0: 6c79 6e6f 6d69 616c 2e0a 2020 2020 2020  lynomial..      
-000053d0: 2020 7271 0000 0072 1500 0000 2902 7201    rq...r....).r.
-000053e0: 0000 0072 0100 0000 7201 0000 0063 0100  ...r....r....c..
-000053f0: 0000 0000 0000 0000 0000 0200 0000 0500  ................
-00005400: 0000 1300 0000 7324 0000 0067 007c 005d  ......s$...g.|.]
-00005410: 0e7d 0188 007c 0119 0064 006b 0372 027c  .}...|...d.k.r.|
-00005420: 0188 007c 0119 0066 0291 0271 0253 0072  ...|...f...q.S.r
-00005430: 7100 0000 720a 0000 0072 8500 0000 a901  q...r....r......
-00005440: 7244 0000 0072 0a00 0000 720f 0000 0072  rD...r....r....r
-00005450: 2f00 0000 2402 0000 7302 0000 0024 007a  /...$...s....$.z
-00005460: 245f 706f 6c79 2e74 6f5f 6a65 7470 6f6c  $_poly.to_jetpol
-00005470: 792e 3c6c 6f63 616c 733e 2e3c 6c69 7374  y.<locals>.<list
-00005480: 636f 6d70 3e29 0172 0900 0000 2908 7214  comp>).r....).r.
-00005490: 0000 0072 1800 0000 721a 0000 00da 0966  ...r....r......f
-000054a0: 726f 7a65 6e73 6574 7219 0000 0072 2600  rozensetr....r&.
-000054b0: 0000 7269 0000 0072 0300 0000 2904 7221  ..ri...r....).r!
-000054c0: 0000 00da 0c63 6f6e 7374 616e 745f 6b65  .....constant_ke
-000054d0: 79da 086a 7076 616c 7565 7372 0e00 0000  y..jpvaluesr....
-000054e0: 720a 0000 0072 c100 0000 720f 0000 00da  r....r....r.....
-000054f0: 0a74 6f5f 6a65 7470 6f6c 790f 0200 0073  .to_jetpoly....s
-00005500: 1200 0000 0e0e 0401 0c01 1401 1001 0c01  ................
-00005510: 0201 2601 0a01 7a10 5f70 6f6c 792e 746f  ..&...z._poly.to
-00005520: 5f6a 6574 706f 6c79 6302 0000 0000 0000  _jetpolyc.......
-00005530: 0000 0000 0005 0000 0005 0000 000f 0000  ................
-00005540: 0073 2e00 0000 8700 8701 8702 6603 6401  .s..........f.d.
-00005550: 6402 8408 7c00 a000 a100 4400 8301 7d04  d...|.....D...}.
-00005560: 7c00 6a01 7c04 7c00 6a02 7c00 6a03 6403  |.j.|.|.j.|.j.d.
-00005570: 8d03 5300 2904 61de 0100 000a 2020 2020  ..S.).a.....    
-00005580: 2020 2020 4170 706c 7920 616e 206f 7065      Apply an ope
-00005590: 7261 746f 7220 746f 2074 6865 2063 6f65  rator to the coe
-000055a0: 6666 6963 6965 6e74 7320 6f66 2074 6865  fficients of the
-000055b0: 2063 7572 7265 6e74 204c 6965 2d70 6f6c   current Lie-pol
-000055c0: 796e 6f6d 6961 6c2e 0a20 2020 2020 2020  ynomial..       
-000055d0: 200a 2020 2020 2020 2020 5061 7261 6d65   .        Parame
-000055e0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-000055f0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00005600: 6f70 6572 6174 6f72 3a20 6361 6c6c 6162  operator: callab
-00005610: 6c65 0a20 2020 2020 2020 2020 2020 2054  le.            T
-00005620: 6865 206f 7065 7261 746f 722e 0a20 2020  he operator..   
-00005630: 2020 2020 2020 2020 200a 2020 2020 2020           .      
-00005640: 2020 2a61 7267 730a 2020 2020 2020 2020    *args.        
-00005650: 2020 2020 4f70 7469 6f6e 616c 2070 6172      Optional par
-00005660: 616d 6574 6572 7320 7061 7373 6564 2074  ameters passed t
-00005670: 6f20 7468 6520 6f70 6572 6174 6f72 2e0a  o the operator..
-00005680: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-00005690: 2020 2020 202a 2a6b 7761 7267 730a 2020       **kwargs.  
-000056a0: 2020 2020 2020 2020 2020 4f70 7469 6f6e            Option
-000056b0: 616c 206b 6579 776f 7264 6564 2070 6172  al keyworded par
-000056c0: 616d 6574 6572 7320 7061 7373 6564 2074  ameters passed t
-000056d0: 6f20 7468 6520 6f70 6572 6174 6f72 2e0a  o the operator..
-000056e0: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-000056f0: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-00005700: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-00005710: 2020 2020 2070 6f6c 790a 2020 2020 2020       poly.      
-00005720: 2020 2020 2020 4120 4c69 652d 706f 6c79        A Lie-poly
-00005730: 6e6f 6d69 616c 2068 6176 696e 6720 7468  nomial having th
-00005740: 6520 6d61 7070 6564 2076 616c 7565 732e  e mapped values.
-00005750: 0a20 2020 2020 2020 2063 0100 0000 0000  .        c......
-00005760: 0000 0000 0000 0300 0000 0700 0000 1300  ................
-00005770: 0000 7328 0000 0069 007c 005d 105c 027d  ..s(...i.|.].\.}
-00005780: 017d 027c 0188 027c 0267 0188 00a2 0152  .}.|...|.g.....R
-00005790: 0069 0088 01a4 018e 0193 0271 0253 0072  .i.........q.S.r
-000057a0: 0a00 0000 720a 0000 0072 0b00 0000 a903  ....r....r......
-000057b0: 72a4 0000 0072 2200 0000 da08 6f70 6572  r....r".....oper
-000057c0: 6174 6f72 720a 0000 0072 0f00 0000 7210  atorr....r....r.
-000057d0: 0000 003b 0200 0072 5800 0000 7a1f 5f70  ...;...rX...z._p
-000057e0: 6f6c 792e 6170 706c 792e 3c6c 6f63 616c  oly.apply.<local
-000057f0: 733e 2e3c 6469 6374 636f 6d70 3e72 3700  s>.<dictcomp>r7.
-00005800: 0000 2904 7219 0000 0072 3900 0000 7214  ..).r....r9...r.
-00005810: 0000 0072 2800 0000 2905 7221 0000 0072  ...r(...).r!...r
-00005820: c700 0000 72a4 0000 0072 2200 0000 723a  ....r....r"...r:
-00005830: 0000 0072 0a00 0000 72c6 0000 0072 0f00  ...r....r....r..
-00005840: 0000 72b4 0000 0027 0200 0073 0400 0000  ..r....'...s....
-00005850: 1a14 1401 7a0b 5f70 6f6c 792e 6170 706c  ....z._poly.appl
-00005860: 7963 0300 0000 0000 0000 0000 0000 0600  yc..............
-00005870: 0000 0500 0000 0f00 0000 7356 0000 0074  ..........sV...t
-00005880: 0088 0183 0164 016b 0472 1487 0087 0187  .....d.k.r......
-00005890: 0366 0364 0264 0384 087c 00a0 01a1 0044  .f.d.d...|.....D
-000058a0: 0083 017d 056e 0d87 0087 0287 0366 0364  ...}.n.......f.d
-000058b0: 0464 0384 087c 00a0 01a1 0044 0083 017d  .d...|.....D...}
-000058c0: 057c 006a 027c 057c 006a 037c 006a 0464  .|.j.|.|.j.|.j.d
-000058d0: 058d 0353 0029 0661 5e03 0000 0a20 2020  ...S.).a^....   
-000058e0: 2020 2020 2041 7070 6c79 2061 2063 6c61       Apply a cla
-000058f0: 7373 2066 756e 6374 696f 6e20 6f66 2074  ss function of t
-00005900: 6865 2063 6f65 6666 6963 6965 6e74 7320  he coefficients 
-00005910: 6f66 2074 6865 2063 7572 7265 6e74 204c  of the current L
-00005920: 6965 2d70 6f6c 796e 6f6d 6961 6c2e 0a20  ie-polynomial.. 
-00005930: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00005940: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-00005950: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00005960: 2020 2020 2020 6e61 6d65 3a20 7374 720a        name: str.
-00005970: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00005980: 6e61 6d65 206f 6620 7468 6520 636c 6173  name of the clas
-00005990: 7320 6675 6e63 7469 6f6e 2027 6e61 6d65  s function 'name
-000059a0: 272e 0a20 2020 2020 2020 2020 2020 200a  '..            .
-000059b0: 2020 2020 2020 2020 6361 7267 733a 2064          cargs: d
-000059c0: 6963 742c 206f 7074 696f 6e61 6c0a 2020  ict, optional.  
-000059d0: 2020 2020 2020 2020 2020 4469 6374 696f            Dictio
-000059e0: 6e61 7279 206f 6620 6b65 7977 6f72 6473  nary of keywords
-000059f0: 2077 6869 6368 206d 6179 2064 6570 656e   which may depen
-00005a00: 6420 6f6e 2073 656c 662e 7661 6c75 6573  d on self.values
-00005a10: 2e6b 6579 7328 292e 2054 6869 7320 6d65  .keys(). This me
-00005a20: 616e 7320 7468 6174 2074 6865 206b 6579  ans that the key
-00005a30: 7320 6f66 0a20 2020 2020 2020 2020 2020  s of.           
-00005a40: 2063 6172 6773 206d 7573 7420 636f 7272   cargs must corr
-00005a50: 6573 706f 6e64 2074 6f20 7365 6c66 2e76  espond to self.v
-00005a60: 616c 7565 732e 6b65 7973 2829 2e20 5468  alues.keys(). Th
-00005a70: 6520 6974 656d 7320 6f66 2063 6172 6773  e items of cargs
-00005a80: 2063 6f72 7265 7370 6f6e 6420 746f 2061   correspond to a
-00005a90: 2073 6574 206f 6620 6b65 7977 6f72 6465   set of keyworde
-00005aa0: 640a 2020 2020 2020 2020 2020 2020 6172  d.            ar
-00005ab0: 6775 6d65 6e74 7320 666f 7220 7468 6520  guments for the 
-00005ac0: 636c 6173 7320 6675 6e63 7469 6f6e 2027  class function '
-00005ad0: 6e61 6d65 272e 0a20 2020 2020 2020 2020  name'..         
-00005ae0: 2020 200a 2020 2020 2020 2020 2a61 7267     .        *arg
-00005af0: 733a 0a20 2020 2020 2020 2020 2020 2041  s:.            A
-00005b00: 7267 756d 656e 7473 206f 6620 7468 6520  rguments of the 
-00005b10: 636c 6173 7320 6675 6e63 7469 6f6e 2027  class function '
-00005b20: 6e61 6d65 272e 0a20 2020 2020 2020 2020  name'..         
-00005b30: 2020 200a 2020 2020 2020 2020 2a2a 6b77     .        **kw
-00005b40: 6172 6773 3a0a 2020 2020 2020 2020 2020  args:.          
-00005b50: 2020 4b65 7977 6f72 6465 6420 6172 6775    Keyworded argu
-00005b60: 6d65 6e74 7320 6f66 2074 6865 2063 6c61  ments of the cla
-00005b70: 7373 2066 756e 6374 696f 6e20 276e 616d  ss function 'nam
-00005b80: 6527 2e0a 2020 2020 2020 2020 2020 2020  e'..            
-00005b90: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00005ba0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00005bb0: 0a20 2020 2020 2020 2070 6f6c 790a 2020  .        poly.  
-00005bc0: 2020 2020 2020 2020 2020 4120 4c69 652d            A Lie-
-00005bd0: 706f 6c79 6e6f 6d69 616c 2069 6e20 7768  polynomial in wh
-00005be0: 6963 6820 6576 6572 7920 656e 7472 7920  ich every entry 
-00005bf0: 696e 2069 7473 2076 616c 7565 7320 636f  in its values co
-00005c00: 6e74 6169 6e20 7468 6520 7265 7375 6c74  ntain the result
-00005c10: 206f 6620 7468 6520 7265 7175 6573 7465   of the requeste
-00005c20: 6420 636c 6173 7320 6675 6e63 7469 6f6e  d class function
-00005c30: 2e0a 2020 2020 2020 2020 7201 0000 0063  ..        r....c
-00005c40: 0100 0000 0000 0000 0000 0000 0300 0000  ................
-00005c50: 0800 0000 1300 0000 732a 0000 0069 007c  ........s*...i.|
-00005c60: 005d 115c 027d 017d 027c 0174 007c 0288  .].\.}.}.|.t.|..
-00005c70: 0283 0288 0069 0088 017c 0119 00a4 018e  .....i...|......
-00005c80: 0193 0271 0253 0072 0a00 0000 a901 da07  ...q.S.r........
-00005c90: 6765 7461 7474 72a9 0372 0c00 0000 7244  getattr..r....rD
-00005ca0: 0000 0072 0e00 0000 2903 72a4 0000 00da  ...r....).r.....
-00005cb0: 0563 6172 6773 da04 6e61 6d65 720a 0000  .cargs..namer...
-00005cc0: 0072 0f00 0000 7210 0000 0058 0200 0073  .r....r....X...s
-00005cd0: 0200 0000 2a00 7a28 5f70 6f6c 792e 6170  ....*.z(_poly.ap
-00005ce0: 706c 7943 6c61 7373 4675 6e63 2e3c 6c6f  plyClassFunc.<lo
-00005cf0: 6361 6c73 3e2e 3c64 6963 7463 6f6d 703e  cals>.<dictcomp>
-00005d00: 6301 0000 0000 0000 0000 0000 0003 0000  c...............
-00005d10: 0007 0000 0013 0000 0073 2600 0000 6900  .........s&...i.
-00005d20: 7c00 5d0f 5c02 7d01 7d02 7c01 7400 7c02  |.].\.}.}.|.t.|.
-00005d30: 8802 8302 8800 6900 8801 a401 8e01 9302  ......i.........
-00005d40: 7102 5300 720a 0000 0072 c800 0000 72ca  q.S.r....r....r.
-00005d50: 0000 0029 0372 a400 0000 7222 0000 0072  ...).r....r"...r
-00005d60: cc00 0000 720a 0000 0072 0f00 0000 7210  ....r....r....r.
-00005d70: 0000 005a 0200 0072 4300 0000 7237 0000  ...Z...rC...r7..
-00005d80: 0029 0572 1c00 0000 7219 0000 0072 3900  .).r....r....r9.
-00005d90: 0000 7214 0000 0072 2800 0000 2906 7221  ..r....r(...).r!
-00005da0: 0000 0072 cc00 0000 72cb 0000 0072 a400  ...r....r....r..
-00005db0: 0000 7222 0000 0072 bb00 0000 720a 0000  ..r"...r....r...
-00005dc0: 0029 0472 a400 0000 72cb 0000 0072 2200  .).r....r....r".
-00005dd0: 0000 72cc 0000 0072 0f00 0000 da0e 6170  ..r....r......ap
-00005de0: 706c 7943 6c61 7373 4675 6e63 3e02 0000  plyClassFunc>...
-00005df0: 7308 0000 000c 191c 011a 0214 017a 145f  s............z._
-00005e00: 706f 6c79 2e61 7070 6c79 436c 6173 7346  poly.applyClassF
-00005e10: 756e 6363 0100 0000 0000 0000 0000 0000  uncc............
-00005e20: 0300 0000 0500 0000 0b00 0000 f330 0000  .............0..
-00005e30: 0074 0074 01a0 0264 01a1 0183 0189 0087  .t.t...d........
-00005e40: 0066 0164 0264 0384 087d 027c 006a 0364  .f.d.d...}.|.j.d
-00005e50: 077c 0264 0464 059c 027c 01a4 018e 0153  .|.d.d...|.....S
-00005e60: 0029 08fa 530a 2020 2020 2020 2020 4e6f  .)..S.        No
-00005e70: 7465 2074 6861 7420 6974 2068 6f6c 6473  te that it holds
-00005e80: 2078 6920 3d20 2871 202b 2031 6a2a 7029   xi = (q + 1j*p)
-00005e90: 2f73 7172 7432 2c20 6574 6120 3d20 2871  /sqrt2, eta = (q
-00005ea0: 202d 2031 6a2a 7029 2f73 7172 7432 2e0a   - 1j*p)/sqrt2..
-00005eb0: 2020 2020 2020 2020 7215 0000 0063 0200          r....c..
-00005ec0: 0000 0000 0000 0000 0000 0400 0000 0300  ................
-00005ed0: 0000 1300 0000 7328 0000 007c 007c 0164  ......s(...|.|.d
-00005ee0: 0114 0017 0088 001b 007d 027c 007c 0164  .........}.|.|.d
-00005ef0: 0114 0018 0088 001b 007d 037c 027c 0366  .........}.|.|.f
-00005f00: 0253 00a9 024e 7900 0000 0000 0000 0000  .S...Ny.........
-00005f10: 0000 0000 00f0 3f72 0a00 0000 2904 da01  ......?r....)...
-00005f20: 71da 0170 da02 7869 da03 6574 61a9 01da  q..p..xi..eta...
-00005f30: 0573 7172 7432 720a 0000 0072 0f00 0000  .sqrt2r....r....
-00005f40: da03 7472 6662 0200 0073 0600 0000 1001  ..trfb...s......
-00005f50: 1001 0801 7a1c 5f70 6f6c 792e 7265 616c  ....z._poly.real
-00005f60: 4261 7369 732e 3c6c 6f63 616c 733e 2e74  Basis.<locals>.t
-00005f70: 7266 7229 0000 00a9 0272 d700 0000 7207  rfr).....r....r.
-00005f80: 0000 004e 720a 0000 00a9 0472 ad00 0000  ...Nr......r....
-00005f90: 7265 0000 00da 0473 7172 74da 0974 7261  re.....sqrt..tra
-00005fa0: 6e73 666f 726d a903 7221 0000 0072 2200  nsform..r!...r".
-00005fb0: 0000 72d7 0000 0072 0a00 0000 72d5 0000  ..r....r....r...
-00005fc0: 0072 0f00 0000 da09 7265 616c 4261 7369  .r......realBasi
-00005fd0: 735d 0200 00f3 0600 0000 0e04 0c01 1604  s]..............
-00005fe0: 7a0f 5f70 6f6c 792e 7265 616c 4261 7369  z._poly.realBasi
-00005ff0: 7363 0100 0000 0000 0000 0000 0000 0300  sc..............
-00006000: 0000 0500 0000 0b00 0000 72ce 0000 0029  ..........r....)
-00006010: 0872 cf00 0000 7215 0000 0063 0200 0000  .r....r....c....
-00006020: 0000 0000 0000 0000 0400 0000 0200 0000  ................
-00006030: 1300 0000 7324 0000 007c 007c 0117 0088  ....s$...|.|....
-00006040: 001b 007d 027c 007c 0118 0088 001b 0064  ...}.|.|.......d
-00006050: 011b 007d 037c 027c 0366 0253 0072 d000  ...}.|.|.f.S.r..
-00006060: 0000 720a 0000 0029 0472 d300 0000 72d4  ..r....).r....r.
-00006070: 0000 0072 d100 0000 72d2 0000 0072 d500  ...r....r....r..
-00006080: 0000 720a 0000 0072 0f00 0000 72d7 0000  ..r....r....r...
-00006090: 006d 0200 0073 0600 0000 0c01 1001 0801  .m...s..........
-000060a0: 7a1f 5f70 6f6c 792e 636f 6d70 6c65 7842  z._poly.complexB
-000060b0: 6173 6973 2e3c 6c6f 6361 6c73 3e2e 7472  asis.<locals>.tr
-000060c0: 6672 0800 0000 72d8 0000 004e 720a 0000  fr....r....Nr...
-000060d0: 0072 d900 0000 72dc 0000 0072 0a00 0000  .r....r....r....
-000060e0: 72d5 0000 0072 0f00 0000 da0c 636f 6d70  r....r......comp
-000060f0: 6c65 7842 6173 6973 6802 0000 72de 0000  lexBasish...r...
-00006100: 007a 125f 706f 6c79 2e63 6f6d 706c 6578  .z._poly.complex
-00006110: 4261 7369 7346 6305 0000 0000 0000 0000  BasisFc.........
-00006120: 0000 0010 0000 0006 0000 004b 0000 0073  ...........K...s
-00006130: d000 0000 7c00 6a00 6401 6b04 7307 4a00  ....|.j.d.k.s.J.
-00006140: 8201 7401 7402 a003 6402 a101 8301 7d06  ..t.t...d.....}.
-00006150: 6700 6700 0202 7d07 7d08 7404 7c00 6a00  g.g...}.}.t.|.j.
-00006160: 8301 4400 5d24 7d09 7405 6403 7c09 6403  ..D.]$}.t.d.|.d.
-00006170: 6404 8d03 7d0a 7405 6403 7c09 7c00 6a00  d...}.t.d.|.|.j.
-00006180: 1700 6403 6404 8d03 7d0b 7c01 7c0a 7c0b  ..d.d...}.|.|.|.
-00006190: 8302 5c02 7d0c 7d0d 7c07 a006 7c0c a101  ..\.}.}.|...|...
-000061a0: 0100 7c08 a006 7c0d a101 0100 7118 7c00  ..|...|.....q.|.
-000061b0: 7c07 7c08 1700 8e00 7d0e 7c0e 6401 6b02  |.|.....}.|.d.k.
-000061c0: 7251 6405 7c00 6a00 1400 6402 1400 6401  rQd.|.j...d...d.
-000061d0: 6901 7d0f 6e10 7c0e 6a07 6402 7c00 6a00  i.}.n.|.j.d.|.j.
-000061e0: 1400 7408 7c00 a009 a100 8301 7c03 7c04  ..t.|.......|.|.
-000061f0: 6406 8d04 7d0f 7c00 6a0a 7c0f 7c02 6407  d...}.|.j.|.|.d.
-00006200: 8d02 5300 2908 61eb 0500 000a 2020 2020  ..S.).a.....    
-00006210: 2020 2020 4361 7374 2074 6865 2063 7572      Cast the cur
-00006220: 7265 6e74 2070 6f6c 796e 6f6d 6961 6c20  rent polynomial 
-00006230: 696e 746f 2061 2064 6966 6665 7265 6e74  into a different
-00006240: 2066 6f72 6d2e 0a20 2020 2020 2020 200a   form..        .
-00006250: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00006260: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00006270: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7472  -----.        tr
-00006280: 663a 2063 616c 6c61 626c 650a 2020 2020  f: callable.    
-00006290: 2020 2020 2020 2020 4120 6c69 6e65 6172          A linear
-000062a0: 2074 7261 6e73 666f 726d 6174 696f 6e20   transformation 
-000062b0: 6d61 7070 696e 6720 6120 7061 6972 206f  mapping a pair o
-000062c0: 6620 6e65 7720 7661 7269 6162 6c65 7320  f new variables 
-000062d0: 7132 2c20 7032 2074 6f20 6f72 6967 696e  q2, p2 to origin
-000062e0: 616c 2076 6172 6961 626c 6573 2071 312c  al variables q1,
-000062f0: 2070 312e 0a20 2020 2020 2020 2020 2020   p1..           
-00006300: 200a 2020 2020 2020 2020 706f 6973 736f   .        poisso
-00006310: 6e5f 6661 6374 6f72 3a20 5468 6520 6661  n_factor: The fa
-00006320: 6374 6f72 2066 2073 6f20 7468 6174 207b  ctor f so that {
-00006330: 7131 2c20 7031 7d5f 7b71 312c 2070 317d  q1, p1}_{q1, p1}
-00006340: 203d 2066 2a7b 7131 2c20 7031 7d5f 7b71   = f*{q1, p1}_{q
-00006350: 322c 2070 327d 2068 6f6c 642c 2077 6865  2, p2} hold, whe
-00006360: 7265 0a20 2020 2020 2020 2074 6865 2062  re.        the b
-00006370: 7261 636b 6574 7320 6172 6520 6769 7665  rackets are give
-00006380: 6e20 7769 7468 2072 6573 7065 6374 2074  n with respect t
-00006390: 6f20 7468 6520 6f6c 642f 6e65 7720 636f  o the old/new co
-000063a0: 6f72 6469 6e61 7465 732e 2046 6f72 2065  ordinates. For e
-000063b0: 7861 6d70 6c65 2c20 6966 2071 3120 3d20  xample, if q1 = 
-000063c0: 712c 2070 3120 3d20 700a 2020 2020 2020  q, p1 = p.      
-000063d0: 2020 616e 6420 7132 203d 2078 6920 3d20    and q2 = xi = 
-000063e0: 2871 202b 2070 2a31 6a29 2f73 7172 7432  (q + p*1j)/sqrt2
-000063f0: 2c20 7032 203d 2065 7461 203d 2028 7120  , p2 = eta = (q 
-00006400: 2d20 702a 316a 292f 7371 7274 322c 2074  - p*1j)/sqrt2, t
-00006410: 6865 6e0a 2020 2020 2020 2020 3120 3d20  hen.        1 = 
-00006420: 7b71 312c 2070 317d 5f7b 7131 2c20 7031  {q1, p1}_{q1, p1
-00006430: 7d20 616e 6420 2d31 6a20 3d20 7b71 312c  } and -1j = {q1,
-00006440: 2070 317d 5f7b 7869 2c20 6574 617d 2e20   p1}_{xi, eta}. 
-00006450: 5468 6572 6566 6f72 652c 2069 6620 7472  Therefore, if tr
-00006460: 616e 7366 6f72 6d69 6e67 2066 726f 6d20  ansforming from 
-00006470: 712f 7020 746f 2078 692f 6574 612c 0a20  q/p to xi/eta,. 
-00006480: 2020 2020 2020 2074 6865 2070 6f69 7373         the poiss
-00006490: 6f6e 2066 6163 746f 7220 6620 6861 7320  on factor f has 
-000064a0: 746f 2062 6520 2d31 6a2e 0a20 2020 2020  to be -1j..     
-000064b0: 2020 200a 2020 2020 2020 2020 4174 2074     .        At t
-000064c0: 6865 206d 6f6d 656e 7420 6f6e 6c79 2032  he moment only 2
-000064d0: 6420 7472 616e 7366 6f72 6d61 7469 6f6e  d transformation
-000064e0: 7320 6172 6520 7375 7070 6f72 7465 643b  s are supported;
-000064f0: 206d 6f72 6520 736f 7068 6973 7469 6361   more sophistica
-00006500: 7465 6420 7472 616e 7366 6f72 6d61 7469  ted transformati
-00006510: 6f6e 7320 7265 7175 6972 650a 2020 2020  ons require.    
-00006520: 2020 2020 736f 6d65 206f 7665 7277 6f72      some overwor
-00006530: 6b20 696e 2074 6865 2070 6f69 7373 6f6e  k in the poisson
-00006540: 2062 7261 636b 6574 2072 6f75 7469 6e65   bracket routine
-00006550: 2073 656c 662e 5f5f 6d61 746d 756c 5f5f   self.__matmul__
-00006560: 2e0a 2020 2020 2020 2020 0a20 2020 2020  ..        .     
-00006570: 2020 206d 756c 745f 6472 763a 2062 6f6f     mult_drv: boo
-00006580: 6c65 616e 2c20 6f70 7469 6f6e 616c 0a20  lean, optional. 
-00006590: 2020 2020 2020 2020 2020 2043 6f6e 7472             Contr
-000065a0: 6f6c 206f 6620 6661 6374 6f72 6961 6c20  ol of factorial 
-000065b0: 616e 6420 7065 726d 7574 6174 696f 6e20  and permutation 
-000065c0: 636f 6566 6669 6369 656e 7473 2e20 5365  coefficients. Se
-000065d0: 6520 6e6a 6574 2e70 6f6c 792e 6a65 7470  e njet.poly.jetp
-000065e0: 6f6c 792e 6765 745f 7461 796c 6f72 5f63  oly.get_taylor_c
-000065f0: 6f65 6666 6963 6965 6e74 7320 666f 7220  oefficients for 
-00006600: 6465 7461 696c 732e 0a20 2020 2020 2020  details..       
-00006610: 2020 2020 200a 2020 2020 2020 2020 6d75       .        mu
-00006620: 6c74 5f70 726d 3a20 626f 6f6c 6561 6e2c  lt_prm: boolean,
-00006630: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00006640: 2020 2020 2020 436f 6e74 726f 6c20 6f66        Control of
-00006650: 2066 6163 746f 7269 616c 2061 6e64 2070   factorial and p
-00006660: 6572 6d75 7461 7469 6f6e 2063 6f65 6666  ermutation coeff
-00006670: 6963 6965 6e74 732e 2053 6565 206e 6a65  icients. See nje
-00006680: 742e 706f 6c79 2e6a 6574 706f 6c79 2e67  t.poly.jetpoly.g
-00006690: 6574 5f74 6179 6c6f 725f 636f 6566 6669  et_taylor_coeffi
-000066a0: 6369 656e 7473 2066 6f72 2064 6574 6169  cients for detai
-000066b0: 6c73 2e0a 2020 2020 2020 2020 2020 2020  ls..            
-000066c0: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
-000066d0: 730a 2020 2020 2020 2020 2020 2020 4172  s.            Ar
-000066e0: 6775 6d65 6e74 7320 7061 7373 6564 2074  guments passed t
-000066f0: 6f20 7365 6c66 2e5f 5f63 6c61 7373 5f5f  o self.__class__
-00006700: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-00006710: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
-00006720: 2d2d 0a20 2020 2020 2020 2064 6963 740a  --.        dict.
-00006730: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00006740: 636f 6566 6669 6369 656e 7473 206f 6620  coefficients of 
-00006750: 7468 6520 706f 6c79 6e6f 6d69 616c 2077  the polynomial w
-00006760: 6974 6820 7265 7370 6563 7420 746f 2074  ith respect to t
-00006770: 6865 2072 6561 6c20 7120 616e 6420 7020  he real q and p 
-00006780: 636f 6f72 6469 6e61 7465 732e 0a20 2020  coordinates..   
-00006790: 2020 2020 2020 2020 2054 6865 206b 6579           The key
-000067a0: 7320 636f 7272 6573 706f 6e64 2074 6f20  s correspond to 
-000067b0: 7468 6520 706f 7765 7273 2077 6974 6820  the powers with 
-000067c0: 7265 7370 6563 7420 746f 2028 715f 312c  respect to (q_1,
-000067d0: 202e 2e2e 2c20 715f 6469 6d2c 2070 312c   ..., q_dim, p1,
-000067e0: 202e 2e2e 2c20 705f 6469 6d29 2e0a 2020   ..., p_dim)..  
-000067f0: 2020 2020 2020 7201 0000 0072 1500 0000        r....r....
-00006800: 7229 0000 0029 02da 0569 6e64 6578 72ac  r)...)...indexr.
-00006810: 0000 0072 7100 0000 2903 da05 6661 6374  ...rq...)...fact
-00006820: 73da 086d 756c 745f 6472 76da 086d 756c  s..mult_drv..mul
-00006830: 745f 7072 6d29 0272 0900 0000 7207 0000  t_prm).r....r...
-00006840: 0029 0b72 1400 0000 72ad 0000 0072 6500  .).r....r....re.
-00006850: 0000 72da 0000 0072 6900 0000 7203 0000  ..r....ri...r...
-00006860: 0072 ae00 0000 da17 6765 745f 7461 796c  .r......get_tayl
-00006870: 6f72 5f63 6f65 6666 6963 6965 6e74 7372  or_coefficientsr
-00006880: 0500 0000 7232 0000 0072 3900 0000 2910  ....r2...r9...).
-00006890: 7221 0000 0072 d700 0000 7207 0000 0072  r!...r....r....r
-000068a0: e200 0000 72e3 0000 0072 2200 0000 72d6  ....r....r"...r.
-000068b0: 0000 00da 0271 32da 0270 3272 0d00 0000  .....q2..p2r....
-000068c0: da02 716b da02 706b da03 7132 6bda 0370  ..qk..pk..q2k..p
-000068d0: 326b da02 6831 da03 7262 7672 0a00 0000  2k..h1..rbvr....
-000068e0: 720a 0000 0072 0f00 0000 72db 0000 0073  r....r....r....s
-000068f0: 0200 0073 2000 0000 0e21 0e01 0a01 0e01  ...s ....!......
-00006900: 0e02 1401 0e01 0a01 0c01 0c01 0801 1401  ................
-00006910: 1602 0401 06ff 0e02 7a0f 5f70 6f6c 792e  ........z._poly.
-00006920: 7472 616e 7366 6f72 6d63 0400 0000 0000  transformc......
-00006930: 0000 0000 0000 0e00 0000 0500 0000 0b00  ................
-00006940: 0000 73cc 0000 007c 006a 0087 0066 0164  ..s....|.j...f.d
-00006950: 0164 0284 0864 038d 017d 057c 006a 0087  .d...d...}.|.j..
-00006960: 0066 0164 0464 0284 0864 038d 017d 0667  .f.d.d...d...}.g
-00006970: 007d 0767 0067 0002 027d 087d 0974 0174  .}.g.g...}.}.t.t
-00006980: 027c 0283 0183 0144 005d 257d 0a7c 027c  .|.....D.]%}.|.|
-00006990: 0a19 007d 0b7c 0a64 0516 0064 066b 0272  ...}.|.d...d.k.r
-000069a0: 3a7c 07a0 037c 057c 0b14 00a1 0101 007c  :|...|.|.......|
-000069b0: 08a0 037c 0ba1 0101 0071 217c 07a0 037c  ...|.....q!|...|
-000069c0: 067c 0b14 00a1 0101 007c 09a0 037c 0ba1  .|.......|...|..
-000069d0: 0101 0071 217c 0372 6474 047c 0883 0174  ...q!|.rdt.|...t
-000069e0: 047c 0983 0102 027d 0c7d 0d7c 0c64 076b  .|.....}.}.|.d.k
-000069f0: 0272 5a7c 0d64 076b 0273 644a 0064 087c  .rZ|.d.k.sdJ.d.|
-00006a00: 0c9b 0064 097c 0d9b 009d 0483 0182 017c  ...d.|.........|
-00006a10: 0753 0029 0a61 8802 0000 0a20 2020 2020  .S.).a.....     
-00006a20: 2020 2053 706c 6974 2074 6865 2048 616d     Split the Ham
-00006a30: 696c 746f 6e69 616e 2077 6974 6820 7265  iltonian with re
-00006a40: 7370 6563 7420 746f 2061 2073 6574 206f  spect to a set o
-00006a50: 6620 6b65 7973 2e20 0a20 2020 2020 2020  f keys. .       
-00006a60: 2052 6574 7572 6e20 6120 6c69 7374 206f   Return a list o
-00006a70: 6620 706f 6c79 6e6f 6d69 616c 7320 6163  f polynomials ac
-00006a80: 636f 7264 696e 6720 746f 2074 6865 2072  cording to the r
-00006a90: 6571 7565 7374 6564 206e 756d 6265 7220  equested number 
-00006aa0: 6f66 2073 6c69 6365 7320 616e 6420 7468  of slices and th
-00006ab0: 6520 7370 6c69 7474 696e 672e 0a20 2020  e splitting..   
-00006ac0: 2020 2020 200a 2020 2020 2020 2020 5061       .        Pa
-00006ad0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-00006ae0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00006af0: 2020 2020 7363 6865 6d65 3a20 6c69 7374      scheme: list
-00006b00: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00006b10: 2020 2020 2020 2041 206c 6973 7420 6f66         A list of
-00006b20: 2063 6f65 6666 6963 6965 6e74 7320 5b61   coefficients [a
-00006b30: 312c 2062 312c 2061 322c 202e 2e2e 5d0a  1, b1, a2, ...].
-00006b40: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
-00006b50: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-00006b60: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-00006b70: 2020 2020 206c 6973 740a 2020 2020 2020       list.      
-00006b80: 2020 2020 2020 4120 6c69 7374 2046 206f        A list F o
-00006b90: 6620 706f 6c79 206f 626a 6563 7473 2073  f poly objects s
-00006ba0: 6f20 7468 6174 2069 6620 4820 3d20 4831  o that if H = H1
-00006bb0: 202b 2048 322c 2077 6865 7265 2048 2069   + H2, where H i
-00006bc0: 7320 7468 6520 6375 7272 656e 7420 706f  s the current po
-00006bd0: 6c79 2c20 4831 2074 6865 2070 6f6c 790a  ly, H1 the poly.
-00006be0: 2020 2020 2020 2020 2020 2020 6163 636f              acco
-00006bf0: 7264 696e 6720 746f 2074 6865 2073 7562  rding to the sub
-00006c00: 7365 7420 6f66 206b 6579 7320 616e 6420  set of keys and 
-00006c10: 4832 2074 6865 2063 6f6d 706c 656d 656e  H2 the complemen
-00006c20: 7420 6f66 2048 312c 2074 6865 6e3a 0a20  t of H1, then:. 
-00006c30: 2020 2020 2020 2020 2020 2046 203d 205b             F = [
-00006c40: 6131 2a48 312c 2062 312a 4832 2c20 6132  a1*H1, b1*H2, a2
-00006c50: 2a48 312c 2062 322a 4832 2c20 2e2e 2e5d  *H1, b2*H2, ...]
-00006c60: 0a20 2020 2020 2020 2020 2020 2061 6363  .            acc
-00006c70: 6f72 6469 6e67 2074 6f20 7468 6520 7265  ording to the re
-00006c80: 7175 6573 7465 6420 696e 7075 7420 6c69  quested input li
-00006c90: 7374 2061 626f 7665 2e0a 2020 2020 2020  st above..      
-00006ca0: 2020 6301 0000 0000 0000 0000 0000 0001    c.............
-00006cb0: 0000 0002 0000 0013 0000 0073 0800 0000  ...........s....
-00006cc0: 7c00 8800 7600 5300 7248 0000 0072 0a00  |...v.S.rH...r..
-00006cd0: 0000 723b 0000 00a9 0172 1800 0000 720a  ..r;.....r....r.
-00006ce0: 0000 0072 0f00 0000 723d 0000 00b8 0200  ...r....r=......
-00006cf0: 00f3 0200 0000 0800 7a1d 5f70 6f6c 792e  ........z._poly.
-00006d00: 7370 6c69 742e 3c6c 6f63 616c 733e 2e3c  split.<locals>.<
-00006d10: 6c61 6d62 6461 3e72 4b00 0000 6301 0000  lambda>rK...c...
-00006d20: 0000 0000 0000 0000 0001 0000 0002 0000  ................
-00006d30: 0013 0000 0073 0800 0000 7c00 8800 7601  .....s....|...v.
-00006d40: 5300 7248 0000 0072 0a00 0000 723b 0000  S.rH...r....r;..
-00006d50: 0072 ed00 0000 720a 0000 0072 0f00 0000  .r....r....r....
-00006d60: 723d 0000 00b9 0200 0072 ee00 0000 7215  r=.......r....r.
-00006d70: 0000 0072 0100 0000 7229 0000 007a 1e42  ...r....r)...z.B
-00006d80: 6f74 6820 7375 6d73 206e 6565 6420 746f  oth sums need to
-00006d90: 2062 6520 313a 0a73 756d 313a 207a 082c   be 1:.sum1: z.,
-00006da0: 2073 756d 323a 2029 0572 4600 0000 7269   sum2: ).rF...ri
-00006db0: 0000 0072 1c00 0000 72ae 0000 0072 2600  ...r....r....r&.
-00006dc0: 0000 290e 7221 0000 0072 1800 0000 da06  ..).r!...r......
-00006dd0: 7363 6865 6d65 da05 6368 6563 6b72 2200  scheme..checkr".
-00006de0: 0000 da04 6861 6d31 da04 6861 6d32 72bb  ....ham1..ham2r.
-00006df0: 0000 0072 8600 0000 7288 0000 0072 0d00  ...r....r....r..
-00006e00: 0000 72c0 0000 00da 0663 6865 636b 31da  ..r......check1.
-00006e10: 0663 6865 636b 3272 0a00 0000 72ed 0000  .check2r....r...
-00006e20: 0072 0f00 0000 da05 7370 6c69 74a6 0200  .r......split...
-00006e30: 0073 1e00 0000 1412 1401 0401 0a01 1002  .s..............
-00006e40: 0801 0c01 0e01 0c01 0e02 0c01 0402 1202  ................
-00006e50: 2401 0401 7a0b 5f70 6f6c 792e 7370 6c69  $...z._poly.spli
-00006e60: 744e 7284 0000 0029 0246 4629 0146 2937  tNr....).FF).F)7
-00006e70: 728a 0000 00da 0a5f 5f6d 6f64 756c 655f  r......__module_
-00006e80: 5fda 0c5f 5f71 7561 6c6e 616d 655f 5fda  _..__qualname__.
-00006e90: 075f 5f64 6f63 5f5f 7223 0000 0072 ad00  .__doc__r#...r..
-00006ea0: 0000 721f 0000 0072 1b00 0000 7232 0000  ..r....r....r2..
-00006eb0: 0072 3500 0000 7236 0000 0072 4600 0000  .r5...r6...rF...
-00006ec0: 725f 0000 0072 4e00 0000 7255 0000 0072  r_...rN...rU...r
-00006ed0: 5700 0000 7259 0000 0072 5a00 0000 726f  W...rY...rZ...ro
-00006ee0: 0000 0072 7700 0000 7279 0000 0072 7b00  ...rw...ry...r{.
-00006ef0: 0000 727c 0000 0072 7e00 0000 7281 0000  ..r|...r~...r...
-00006f00: 0072 8000 0000 7299 0000 0072 9a00 0000  .r....r....r....
-00006f10: 729c 0000 0072 9f00 0000 725d 0000 0072  r....r....r]...r
-00006f20: a000 0000 72a1 0000 0072 1800 0000 7216  ....r....r....r.
-00006f30: 0000 0072 1900 0000 7209 0000 0072 a600  ...r....r....r..
-00006f40: 0000 72a8 0000 0072 a900 0000 72aa 0000  ..r....r....r...
-00006f50: 0072 ab00 0000 72b3 0000 0072 b500 0000  .r....r....r....
-00006f60: 72bc 0000 0072 bd00 0000 7202 0000 0072  r....r....r....r
-00006f70: bf00 0000 72c5 0000 0072 b400 0000 72cd  ....r....r....r.
-00006f80: 0000 0072 dd00 0000 72df 0000 0072 db00  ...r....r....r..
-00006f90: 0000 72f5 0000 0072 0a00 0000 720a 0000  ..r....r....r...
-00006fa0: 0072 0a00 0000 720f 0000 0072 0600 0000  .r....r....r....
-00006fb0: 0900 0000 7366 0000 0008 0004 0108 2b10  ....sf........+.
-00006fc0: 1b10 0f08 0808 0908 0918 080e 1a0e 100e  ................
-00006fd0: 1108 1108 0608 0608 2908 1008 0308 0408  ........).......
-00006fe0: 0308 0308 0308 1a08 1208 0308 0808 1008  ................
-00006ff0: 0408 0308 0908 0308 0308 0308 0308 0408  ................
-00007000: 0308 0308 0510 0508 3308 0308 0908 0308  ........3.......
-00007010: 1708 1d08 180c 1708 1f08 0b0a 0b0e 3372  ..............3r
-00007020: 0600 0000 6301 0000 0000 0000 0000 0000  ....c...........
-00007030: 0009 0000 0006 0000 000f 0000 0073 e400  .............s..
-00007040: 0000 7400 8802 8301 8903 8803 6401 6b04  ..t.........d.k.
-00007050: 730a 4a00 8201 8802 6401 1900 6a01 8900  s.J.....d...j...
-00007060: 8803 8801 6a02 6a03 6b02 7319 4a00 6402  ....j.j.k.s.J.d.
-00007070: 8301 8201 7404 8700 6601 6403 6404 8408  ....t...f.d.d...
-00007080: 8802 4400 8301 8301 7328 4a00 6405 8301  ..D.....s(J.d...
-00007090: 8201 8701 8702 8703 6603 6406 6407 8408  ........f.d.d...
-000070a0: 7d03 7c02 a005 6408 7406 6409 8301 a102  }.|...d.t.d.....
-000070b0: 7d04 7c04 7406 6409 8301 6b02 7240 7c03  }.|.t.d...k.r@|.
-000070c0: 5300 7c02 a005 640a 6401 6701 640b 1400  S.|...d.d.g.d...
-000070d0: 8800 1400 a102 7d05 7c02 a005 640c 7407  ......}.|...d.t.
-000070e0: 640d 6404 8400 8802 4400 8301 8301 a102  d.d.....D.......
-000070f0: 7d06 7408 7c03 7c04 640b 8800 1400 640e  }.t.|.|.d.....d.
-00007100: 8d03 7d07 7c07 7c05 640f 6410 6901 8e01  ..}.|.|.d.d.i...
-00007110: 7d08 8802 6401 1900 6a09 7c08 8800 7c06  }...d...j.|...|.
-00007120: 6411 8d03 5300 2912 61d7 0400 000a 2020  d...S.).a.....  
-00007130: 2020 4c65 7420 7a31 2c20 2e2e 2e2c 207a    Let z1, ..., z
-00007140: 6b20 6265 204c 6965 2070 6f6c 796e 6f6d  k be Lie polynom
-00007150: 6961 6c73 2061 6e64 2066 2061 6e20 616e  ials and f an an
-00007160: 616c 7974 6963 616c 2066 756e 6374 696f  alytical functio
-00007170: 6e2c 2074 616b 696e 6720 6b20 7661 6c75  n, taking k valu
-00007180: 6573 2e0a 2020 2020 4465 7065 6e64 696e  es..    Dependin
-00007190: 6720 6f6e 2074 6865 2069 6e70 7574 2c20  g on the input, 
-000071a0: 7468 6973 2072 6f75 7469 6e65 2077 696c  this routine wil
-000071b0: 6c20 6569 7468 6572 2072 6574 7572 6e20  l either return 
-000071c0: 7468 6520 4c69 6520 706f 6c79 6e6f 6d69  the Lie polynomi
-000071d0: 616c 203a 6628 7a31 2c20 2e2e 2e2c 207a  al :f(z1, ..., z
-000071e0: 6b29 3a20 6f72 0a20 2020 2074 6865 206d  k): or.    the m
-000071f0: 6170 2066 287a 312c 202e 2e2e 2c20 7a6b  ap f(z1, ..., zk
-00007200: 292e 0a20 2020 200a 2020 2020 5061 7261  )..    .    Para
-00007210: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
-00007220: 2d2d 2d2d 2d0a 2020 2020 663a 2063 616c  -----.    f: cal
-00007230: 6c61 626c 650a 2020 2020 2020 2020 4120  lable.        A 
-00007240: 6675 6e63 7469 6f6e 206f 6e20 7768 6963  function on whic
-00007250: 6820 7765 2077 616e 7420 746f 2061 7070  h we want to app
-00007260: 6c79 2074 6865 206c 6973 7420 6f66 2070  ly the list of p
-00007270: 6f6c 7920 6f62 6a65 6374 732e 0a20 2020  oly objects..   
-00007280: 2020 2020 2049 7420 6e65 6564 7320 746f       It needs to
-00007290: 2062 6520 7375 7070 6f72 7465 6420 6279   be supported by
-000072a0: 2074 6865 206e 6a65 7420 6d6f 6475 6c65   the njet module
-000072b0: 2e0a 2020 2020 2020 2020 0a20 2020 206c  ..        .    l
-000072c0: 7073 3a20 706f 6c79 0a20 2020 2020 2020  ps: poly.       
-000072d0: 2054 6865 204c 6965 2070 6f6c 796e 6f6d   The Lie polynom
-000072e0: 6961 6c28 7329 2074 6f20 6265 2063 6f6e  ial(s) to be con
-000072f0: 7374 7275 6374 6564 2e0a 2020 2020 2020  structed..      
-00007300: 2020 0a20 2020 2070 6f77 6572 3a20 696e    .    power: in
-00007310: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-00007320: 2020 2020 5468 6520 6d61 7869 6d61 6c20      The maximal 
-00007330: 706f 7765 7220 6f66 2074 6865 2072 6573  power of the res
-00007340: 756c 7469 6e67 204c 6965 2070 6f6c 796e  ulting Lie polyn
-00007350: 6f6d 6961 6c20 2864 6566 6175 6c74 3a20  omial (default: 
-00007360: 696e 6629 2e0a 2020 2020 2020 2020 4966  inf)..        If
-00007370: 2061 2076 616c 7565 2069 7320 7072 6f76   a value is prov
-00007380: 6964 6564 2c20 7468 6520 726f 7574 696e  ided, the routin
-00007390: 6520 7769 6c6c 2072 6574 7572 6e20 6120  e will return a 
-000073a0: 636c 6173 7320 6f66 2074 7970 6520 706f  class of type po
-000073b0: 6c79 2c20 7265 7072 6573 656e 7469 6e67  ly, representing
-000073c0: 0a20 2020 2020 2020 2061 204c 6965 2070  .        a Lie p
-000073d0: 6f6c 796e 6f6d 6961 6c2e 2049 6620 6e6f  olynomial. If no
-000073e0: 7468 696e 6720 6973 2070 726f 7669 6465  thing is provide
-000073f0: 642c 2074 6865 2072 6f75 7469 6e65 2077  d, the routine w
-00007400: 696c 6c20 7265 7475 726e 2074 6865 2066  ill return the f
-00007410: 756e 6374 696f 6e0a 2020 2020 2020 2020  unction.        
-00007420: 6628 7a31 2c20 2e2e 2e2c 207a 6b29 0a20  f(z1, ..., zk). 
-00007430: 2020 2020 2020 200a 2020 2020 6d61 785f         .    max_
-00007440: 706f 7765 723a 2069 6e74 2c20 6f70 7469  power: int, opti
-00007450: 6f6e 616c 0a20 2020 2020 2020 2053 6565  onal.        See
-00007460: 2070 6f6c 792e 5f5f 696e 6974 5f5f 3b20   poly.__init__; 
-00007470: 6f6e 6c79 2075 7365 6420 6966 2070 6f77  only used if pow
-00007480: 6572 203c 2069 6e66 2e0a 2020 2020 2020  er < inf..      
-00007490: 2020 0a20 2020 2070 6f69 6e74 3a20 6c69    .    point: li
-000074a0: 7374 2c20 6f70 7469 6f6e 616c 0a20 2020  st, optional.   
-000074b0: 2020 2020 204f 6e6c 7920 7265 6c65 7661       Only releva
-000074c0: 6e74 2069 6620 706f 7765 7220 213d 2069  nt if power != i
-000074d0: 6e66 2e20 4120 706f 696e 7420 6172 6f75  nf. A point arou
-000074e0: 6e64 2066 2077 696c 6c20 6265 2065 7870  nd f will be exp
-000074f0: 616e 6465 642e 2049 6620 6e6f 7468 696e  anded. If nothin
-00007500: 6720 7370 6563 6966 6965 642c 200a 2020  g specified, .  
-00007510: 2020 2020 2020 7a65 726f 7320 7769 6c6c        zeros will
-00007520: 2062 6520 7573 6564 2e0a 2020 2020 2020   be used..      
-00007530: 2020 0a20 2020 2052 6574 7572 6e73 0a20    .    Returns. 
-00007540: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2063     -------.    c
-00007550: 616c 6c61 626c 6520 6f72 2070 6f6c 790a  allable or poly.
-00007560: 2020 2020 2020 2020 4173 2064 6573 6372          As descr
-00007570: 6962 6564 2061 626f 7665 2c20 6465 7065  ibed above, depe
-00007580: 6e64 696e 6720 6f6e 2074 6865 2027 706f  nding on the 'po
-00007590: 7765 7227 2069 6e70 7574 2070 6172 616d  wer' input param
-000075a0: 6574 6572 2c20 6569 7468 6572 2074 6865  eter, either the
-000075b0: 206d 6170 2066 287a 312c 202e 2e2e 2c20   map f(z1, ..., 
-000075c0: 7a6b 2920 6f72 0a20 2020 2020 2020 2074  zk) or.        t
-000075d0: 6865 204c 6965 2070 6f6c 796e 6f6d 6961  he Lie polynomia
-000075e0: 6c20 3a66 287a 312c 202e 2e2e 2c20 7a6b  l :f(z1, ..., zk
-000075f0: 293a 2069 7320 7265 7475 726e 6564 2e0a  ): is returned..
-00007600: 2020 2020 7201 0000 007a 3a49 6e70 7574      r....z:Input
-00007610: 2066 756e 6374 696f 6e20 6465 7065 6e64   function depend
-00007620: 7320 6f6e 2061 2064 6966 6665 7265 6e74  s on a different
-00007630: 206e 756d 6265 7220 6f66 2061 7267 756d   number of argum
-00007640: 656e 7473 2e63 0100 0000 0000 0000 0000  ents.c..........
-00007650: 0000 0200 0000 0400 0000 1300 0000 7316  ..............s.
-00007660: 0000 0067 007c 005d 077d 017c 016a 0088  ...g.|.].}.|.j..
-00007670: 006b 0291 0271 0253 0072 0a00 0000 2901  .k...q.S.r....).
-00007680: 7214 0000 0029 0272 0c00 0000 da02 6c70  r....).r......lp
-00007690: 2901 da08 6469 6d5f 706f 6c79 720a 0000  )...dim_polyr...
-000076a0: 0072 0f00 0000 722f 0000 00f4 0200 0072  .r....r/.......r
-000076b0: 4500 0000 7a1d 636f 6e73 7472 7563 742e  E...z.construct.
-000076c0: 3c6c 6f63 616c 733e 2e3c 6c69 7374 636f  <locals>.<listco
-000076d0: 6d70 3e7a 3549 6e70 7574 2070 6f6c 796e  mp>z5Input polyn
-000076e0: 6f6d 6961 6c73 206e 6f74 2061 6c6c 2068  omials not all h
-000076f0: 6176 696e 6720 7468 6520 7361 6d65 2064  aving the same d
-00007700: 696d 656e 7369 6f6e 732e 6300 0000 0000  imensions.c.....
-00007710: 0000 0000 0000 0001 0000 0004 0000 0017  ................
-00007720: 0000 0073 1c00 0000 8801 8702 8700 6602  ...s..........f.
-00007730: 6401 6402 8408 7400 8803 8301 4400 8301  d.d...t.....D...
-00007740: 8e00 5300 2903 4e63 0100 0000 0000 0000  ..S.).Nc........
-00007750: 0000 0000 0200 0000 0400 0000 1300 0000  ................
-00007760: 7318 0000 0067 007c 005d 087d 0188 007c  s....g.|.].}...|
-00007770: 0119 0088 018e 0091 0271 0253 0072 0a00  .........q.S.r..
-00007780: 0000 720a 0000 0072 6000 0000 2902 da03  ..r....r`...)...
-00007790: 6c70 7372 6300 0000 720a 0000 0072 0f00  lpsrc...r....r..
-000077a0: 0000 722f 0000 00f6 0200 0072 3000 0000  ..r/.......r0...
-000077b0: 7a2f 636f 6e73 7472 7563 742e 3c6c 6f63  z/construct.<loc
-000077c0: 616c 733e 2e3c 6c61 6d62 6461 3e2e 3c6c  als>.<lambda>.<l
-000077d0: 6f63 616c 733e 2e3c 6c69 7374 636f 6d70  ocals>.<listcomp
-000077e0: 3e29 0172 6900 0000 a901 7263 0000 0029  >).ri.....rc...)
-000077f0: 0372 c000 0000 72fb 0000 00da 086e 5f61  .r....r......n_a
-00007800: 7267 735f 6672 fc00 0000 720f 0000 0072  rgs_fr....r....r
-00007810: 3d00 0000 f602 0000 7294 0000 007a 1b63  =.......r....z.c
-00007820: 6f6e 7374 7275 6374 2e3c 6c6f 6361 6c73  onstruct.<locals
-00007830: 3e2e 3c6c 616d 6264 613e 72ac 0000 0072  >.<lambda>r....r
-00007840: 2400 0000 da05 706f 696e 7472 1500 0000  $.....pointr....
-00007850: 7228 0000 0063 0100 0000 0000 0000 0000  r(...c..........
-00007860: 0000 0200 0000 0300 0000 5300 0000 7312  ..........S...s.
-00007870: 0000 0067 007c 005d 057d 017c 016a 0091  ...g.|.].}.|.j..
-00007880: 0271 0253 0072 0a00 0000 7227 0000 0029  .q.S.r....r'...)
-00007890: 0272 0c00 0000 da01 6c72 0a00 0000 720a  .r......lr....r.
-000078a0: 0000 0072 0f00 0000 722f 0000 00fd 0200  ...r....r/......
-000078b0: 0073 0200 0000 1200 2902 da05 6f72 6465  .s......)...orde
-000078c0: 7272 be00 0000 72e2 0000 0046 7237 0000  rr....r....Fr7..
-000078d0: 0029 0a72 1c00 0000 7214 0000 00da 085f  .).r....r......_
-000078e0: 5f63 6f64 655f 5fda 0b63 6f5f 6172 6763  _code__..co_argc
-000078f0: 6f75 6e74 da03 616c 6c72 1600 0000 72ad  ount..allr....r.
-00007900: 0000 0072 3400 0000 7202 0000 0072 3900  ...r4...r....r9.
-00007910: 0000 2909 72c0 0000 0072 fb00 0000 7222  ..).r....r....r"
-00007920: 0000 00da 0c63 6f6e 7374 7275 6374 696f  .....constructio
-00007930: 6e72 ac00 0000 72fe 0000 0072 2800 0000  nr....r....r(...
-00007940: da05 6463 6f6d 70da 0d74 6179 6c6f 725f  ..dcomp..taylor_
-00007950: 636f 6566 6673 720a 0000 0029 0472 fa00  coeffsr....).r..
-00007960: 0000 72c0 0000 0072 fb00 0000 72fd 0000  ..r....r....r...
-00007970: 0072 0f00 0000 72bf 0000 00cd 0200 0073  .r....r........s
-00007980: 1c00 0000 0822 0c01 0a01 1402 1e01 1002  ....."..........
-00007990: 1002 0c01 0401 1602 1a01 1201 0e01 1401  ................
-000079a0: 72bf 0000 0029 0ada 056e 756d 7079 7265  r....)...numpyre
-000079b0: 0000 00da 046e 6a65 7472 0200 0000 7203  .....njetr....r.
-000079c0: 0000 005a 0b6e 6a65 742e 636f 6d6d 6f6e  ...Z.njet.common
-000079d0: 7204 0000 0072 0500 0000 7206 0000 0072  r....r....r....r
-000079e0: bf00 0000 720a 0000 0072 0a00 0000 720a  ....r....r....r.
-000079f0: 0000 0072 0f00 0000 da08 3c6d 6f64 756c  ...r......<modul
-00007a00: 653e 0100 0000 7314 0000 0008 0310 0210  e>....s.........
-00007a10: 010e 0200 7f00 7f00 7f00 7f00 7f0c 49    ..............I
+00000260: 3064 6064 6184 005a 3164 6264 6384 005a  0d`da..Z1dbdc..Z
+00000270: 3269 0066 0164 6464 6584 015a 3364 6664  2i.f.ddde..Z3dfd
+00000280: 6784 005a 3464 6864 6984 005a 3564 7164  g..Z4dhdi..Z5dqd
+00000290: 6b64 6c84 015a 3664 7264 6d64 6e84 015a  kdl..Z6drdmdn..Z
+000002a0: 3764 6f53 0029 73da 055f 706f 6c79 6140  7doS.)s.._polya@
+000002b0: 0900 000a 2020 2020 436c 6173 7320 746f  ....    Class to
+000002c0: 206d 6f64 656c 2074 6865 204c 6965 206f   model the Lie o
+000002d0: 7065 7261 746f 7220 3a70 3a2c 2077 6865  perator :p:, whe
+000002e0: 7265 2070 2069 7320 6120 706f 6c79 6e6f  re p is a polyno
+000002f0: 6d69 616c 2067 6976 656e 2069 6e20 7465  mial given in te
+00000300: 726d 7320 6f66 0a20 2020 2063 6f6d 706c  rms of.    compl
+00000310: 6578 2028 7869 2c20 6574 6129 2d63 6f6f  ex (xi, eta)-coo
+00000320: 7264 696e 6174 6573 2e20 466f 7220 7468  rdinates. For th
+00000330: 6520 6e6f 7461 7469 6f6e 206f 6620 7468  e notation of th
+00000340: 6573 6520 636f 6f72 6469 6e61 7465 7320  ese coordinates 
+00000350: 7365 6520 5265 662e 205b 315d 2070 2e20  see Ref. [1] p. 
+00000360: 3333 206f 6e77 6172 6473 2e0a 2020 2020  33 onwards..    
+00000370: 496e 2074 6865 206c 6974 6572 6174 7572  In the literatur
+00000380: 6520 7468 6973 2070 6f6c 796e 6f6d 6961  e this polynomia
+00000390: 6c20 6974 7365 6c66 206d 6179 2062 6520  l itself may be 
+000003a0: 6361 6c6c 6564 2061 2022 4c69 6520 706f  called a "Lie po
+000003b0: 6c79 6e6f 6d69 616c 222c 2073 6565 2065  lynomial", see e
+000003c0: 2e67 2e20 5265 662e 205b 325d 2e0a 2020  .g. Ref. [2]..  
+000003d0: 2020 0a20 2020 2050 6172 616d 6574 6572    .    Parameter
+000003e0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+000003f0: 0a20 2020 2076 616c 7565 733a 2064 6963  .    values: dic
+00000400: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
+00000410: 2020 2020 4120 6469 6374 696f 6e61 7279      A dictionary
+00000420: 2061 7373 6967 6e69 6e67 2074 6865 2070   assigning the p
+00000430: 6f77 6572 7320 6f66 2074 6865 2078 692d  owers of the xi-
+00000440: 2061 6e64 2065 7461 2d76 6172 6961 626c   and eta-variabl
+00000450: 6573 2074 6f20 636f 6566 6669 6369 656e  es to coefficien
+00000460: 7473 2c20 6d6f 6465 6c69 6e67 206d 6f6e  ts, modeling mon
+00000470: 6f6d 6961 6c73 2e0a 2020 2020 2020 2020  omials..        
+00000480: 4e6f 7465 2074 6861 7420 6974 2069 7320  Note that it is 
+00000490: 696e 7465 726e 616c 6c79 2061 7373 756d  internally assum
+000004a0: 6564 2074 6861 7420 6576 6572 7920 636f  ed that every co
+000004b0: 6566 6669 6369 656e 7420 6973 206e 6f6e  efficient is non
+000004c0: 2d7a 6572 6f20 616e 6420 736f 207a 6572  -zero and so zer
+000004d0: 6f2d 636f 6566 6669 6369 656e 7473 2077  o-coefficients w
+000004e0: 696c 6c0a 2020 2020 2020 2020 6265 2064  ill.        be d
+000004f0: 6973 6361 7264 6564 2e20 506f 7765 7273  iscarded. Powers
+00000500: 2077 6869 6368 2064 6f20 6e6f 7420 6170   which do not ap
+00000510: 7065 6172 2069 6e20 7468 6520 6469 6374  pear in the dict
+00000520: 696f 6e61 7279 2061 7265 2061 7373 756d  ionary are assum
+00000530: 6564 2074 6f20 6265 207a 6572 6f2e 0a20  ed to be zero.. 
+00000540: 2020 2020 2020 200a 2020 2020 613a 2074         .    a: t
+00000550: 7570 6c65 2c20 6f70 7469 6f6e 616c 0a20  uple, optional. 
+00000560: 2020 2020 2020 2049 6620 6e6f 2076 616c         If no val
+00000570: 7565 7320 7370 6563 6966 6965 642c 2074  ues specified, t
+00000580: 6865 6e20 6f6e 6520 6361 6e20 7370 6563  hen one can spec
+00000590: 6966 7920 6120 7475 706c 6520 6f66 2069  ify a tuple of i
+000005a0: 6e74 6567 6572 7320 6120 3d20 2861 312c  ntegers a = (a1,
+000005b0: 202e 2e2e 2c20 616e 2920 0a20 2020 2020   ..., an) .     
+000005c0: 2020 2074 6f20 7365 7420 7468 6520 706f     to set the po
+000005d0: 7765 7273 206f 6620 7468 6520 6d6f 6e6f  wers of the mono
+000005e0: 6d69 616c 2078 6920 3d20 7869 5f31 2a2a  mial xi = xi_1**
+000005f0: 6131 202a 202e 2e2e 202a 2078 695f 6e2a  a1 * ... * xi_n*
+00000600: 2a61 6e2e 0a20 2020 2020 2020 200a 2020  *an..        .  
+00000610: 2020 623a 2074 7570 6c65 2c20 6f70 7469    b: tuple, opti
+00000620: 6f6e 616c 0a20 2020 2020 2020 2053 696d  onal.        Sim
+00000630: 696c 6172 2074 6f20 2761 272c 2074 6869  ilar to 'a', thi
+00000640: 7320 7475 706c 6520 7769 6c6c 2064 6566  s tuple will def
+00000650: 696e 6520 7468 6520 706f 7765 7273 206f  ine the powers o
+00000660: 6620 7468 6520 6d6f 6e6f 6d69 616c 2062  f the monomial b
+00000670: 656c 6f6e 6769 6e67 2074 6f20 7468 6520  elonging to the 
+00000680: 6574 612d 7661 7269 6162 6c65 732e 0a20  eta-variables.. 
+00000690: 2020 200a 2020 2020 6d61 785f 706f 7765     .    max_powe
+000006a0: 723a 2069 6e74 2c20 6f70 7469 6f6e 616c  r: int, optional
+000006b0: 0a20 2020 2020 2020 2041 6e20 696e 7465  .        An inte
+000006c0: 6765 7220 6265 796f 6e64 2077 6520 646f  ger beyond we do
+000006d0: 206e 6f74 2070 6572 666f 726d 2063 616c   not perform cal
+000006e0: 6375 6c61 7469 6f6e 732e 2049 6e20 7061  culations. In pa
+000006f0: 7274 6963 756c 6172 2069 7420 6973 2061  rticular it is a
+00000700: 7373 756d 6564 2066 6f72 2074 6865 2070  ssumed for the p
+00000710: 6f69 7373 6f6e 0a20 2020 2020 2020 2062  oisson.        b
+00000720: 7261 636b 6574 2074 6861 7420 7465 726d  racket that term
+00000730: 7320 6265 796f 6e64 2074 6861 7420 696e  s beyond that in
+00000740: 7465 6765 7220 6172 6520 7a65 726f 2e0a  teger are zero..
+00000750: 2020 2020 2020 2020 4174 7465 6e74 696f          Attentio
+00000760: 6e3a 0a20 2020 2020 2020 2054 6865 2070  n:.        The p
+00000770: 6f69 7373 6f6e 2062 7261 636b 6574 206f  oisson bracket o
+00000780: 6620 7477 6f20 686f 6d6f 6765 6e65 6f75  f two homogeneou
+00000790: 7320 4c69 6520 706f 6c79 6e6f 6d69 616c  s Lie polynomial
+000007a0: 7320 6f66 206f 7264 6572 7320 6e20 616e  s of orders n an
+000007b0: 6420 6d20 6861 7320 6f72 6465 7220 4b20  d m has order K 
+000007c0: 3d20 6d20 2b20 6e20 2d20 322e 200a 2020  = m + n - 2. .  
+000007d0: 2020 2020 2020 466f 7220 6120 6765 6e65        For a gene
+000007e0: 7261 6c20 706f 6c79 6e6f 6d69 616c 2c20  ral polynomial, 
+000007f0: 7765 2068 6176 6520 696e 206f 7264 6572  we have in order
+00000800: 204b 2061 2063 6f6e 7472 6962 7574 696f   K a contributio
+00000810: 6e20 6f66 206d 2077 6869 6368 2063 6f75  n of m which cou
+00000820: 6c64 2062 6520 652e 672e 206f 6620 6f72  ld be e.g. of or
+00000830: 6465 7220 4b20 2b20 3120 0a20 2020 2020  der K + 1 .     
+00000840: 2020 2028 7769 7468 206e 203d 2031 292e     (with n = 1).
+00000850: 2054 6869 7320 6d65 616e 7320 7468 6174   This means that
+00000860: 206f 7264 6572 7320 4b20 2b20 3120 7769   orders K + 1 wi
+00000870: 6c6c 2069 6e20 6765 6e65 7261 6c0a 2020  ll in general.  
+00000880: 2020 2020 2020 636f 6e74 7269 6275 7465        contribute
+00000890: 2074 6f20 7468 6520 4b2d 7468 206f 7264   to the K-th ord
+000008a0: 6572 2069 6e20 7468 6520 706f 6973 736f  er in the poisso
+000008b0: 6e20 6272 6163 6b65 742c 206d 616b 696e  n bracket, makin
+000008c0: 6720 7265 7065 6174 6564 2061 7070 6c69  g repeated appli
+000008d0: 6361 7469 6f6e 206f 660a 2020 2020 2020  cation of.      
+000008e0: 2020 706f 6973 736f 6e20 6272 6163 6b65    poisson bracke
+000008f0: 7473 206e 6f74 2072 656c 6961 626c 6520  ts not reliable 
+00000900: 6966 206d 6178 5f70 6f77 6572 2069 7320  if max_power is 
+00000910: 7365 7420 746f 6f20 736d 616c 6c2e 0a0a  set too small...
+00000920: 2020 2020 2020 2020 5370 6563 6966 6963          Specific
+00000930: 6961 6c6c 792c 2069 6620 7765 2073 6574  ially, if we set
+00000940: 206d 6178 5f70 6f77 6572 203d 204b 2066   max_power = K f
+00000950: 6f72 2074 776f 204c 6965 2070 6f6c 796e  or two Lie polyn
+00000960: 6f6d 6961 6c73 2061 2061 6e64 2062 2c20  omials a and b, 
+00000970: 7468 656e 2069 6e20 7b61 2c20 627d 206f  then in {a, b} o
+00000980: 6e6c 7920 7468 6f73 6520 706f 7765 7273  nly those powers
+00000990: 2075 7020 616e 6420 696e 636c 7564 696e   up and includin
+000009a0: 6720 4b20 2d20 3120 6361 6e20 6265 2065  g K - 1 can be e
+000009b0: 7870 6563 7465 6420 746f 2062 6520 636f  xpected to be co
+000009c0: 7272 6563 742e 0a20 2020 2020 2020 200a  rrect..        .
+000009d0: 2020 2020 6469 6d3a 2069 6e74 2c20 6f70      dim: int, op
+000009e0: 7469 6f6e 616c 0a20 2020 2020 2020 2054  tional.        T
+000009f0: 6865 206e 756d 6265 7220 6f66 2078 692d  he number of xi-
+00000a00: 2028 6f72 2065 7461 2d29 2076 6172 6961   (or eta-) varia
+00000a10: 626c 6573 2e20 5769 6c6c 2062 6520 6465  bles. Will be de
+00000a20: 7465 726d 696e 6564 2061 7574 6f6d 6174  termined automat
+00000a30: 6963 616c 6c79 2066 726f 6d20 7468 6520  ically from the 
+00000a40: 696e 7075 742c 2069 6620 6e6f 7468 696e  input, if nothin
+00000a50: 670a 2020 2020 2020 2020 7370 6563 6966  g.        specif
+00000a60: 6965 642e 0a20 2020 2020 2020 200a 2020  ied..        .  
+00000a70: 2020 2a2a 6b77 6172 6773 0a20 2020 2020    **kwargs.     
+00000a80: 2020 204f 7074 696f 6e61 6c20 6172 6775     Optional argu
+00000a90: 6d65 6e74 7320 7061 7373 6564 2074 6f20  ments passed to 
+00000aa0: 7365 6c66 2e73 6574 5f6d 6f6e 696d 6961  self.set_monimia
+00000ab0: 6c20 616e 6420 7365 6c66 2e73 6574 5f6d  l and self.set_m
+00000ac0: 6178 5f70 6f77 6572 0a20 2020 2020 2020  ax_power.       
+00000ad0: 200a 2020 2020 5265 6665 7265 6e63 6528   .    Reference(
+00000ae0: 7329 3a0a 2020 2020 2020 2020 5b31 5d20  s):.        [1] 
+00000af0: 5469 747a 652c 204d 2e20 2253 7061 6365  Titze, M. "Space
+00000b00: 2043 6861 7267 6520 4d6f 6465 6c69 6e67   Charge Modeling
+00000b10: 2061 7420 7468 6520 496e 7465 6765 7220   at the Integer 
+00000b20: 5265 736f 6e61 6e63 6520 666f 7220 7468  Resonance for th
+00000b30: 6520 4345 524e 2050 5320 616e 6420 5350  e CERN PS and SP
+00000b40: 5322 2028 3230 3139 292e 0a20 2020 2020  S" (2019)..     
+00000b50: 2020 205b 325d 2043 6173 6173 2c20 462e     [2] Casas, F.
+00000b60: 2061 6e64 204d 7572 7561 2c20 4d2e 2022   and Murua, M. "
+00000b70: 416e 2065 6666 6963 6965 6e74 2061 6c67  An efficient alg
+00000b80: 6f72 6974 686d 2066 6f72 2063 6f6d 7075  orithm for compu
+00000b90: 7469 6e67 2074 6865 2042 616b 6572 2d43  ting the Baker-C
+00000ba0: 616d 7062 656c 6c2d 4861 7573 646f 7266  ampbell-Hausdorf
+00000bb0: 6620 7365 7269 6573 2061 6e64 2073 6f6d  f series and som
+00000bc0: 6520 6f66 2069 7473 2061 7070 6c69 6361  e of its applica
+00000bd0: 7469 6f6e 7322 2028 3230 3038 2920 6172  tions" (2008) ar
+00000be0: 5869 763a 3038 3130 2e32 3635 362e 0a20  Xiv:0810.2656.. 
+00000bf0: 2020 2063 0100 0000 0000 0000 0000 0000     c............
+00000c00: 0200 0000 0700 0000 4b00 0000 73b6 0000  ........K...s...
+00000c10: 007c 01a0 0064 0164 02a1 027c 005f 0164  .|...d.d...|._.d
+00000c20: 037c 01a0 02a1 0076 0072 1a64 0464 0584  .|.....v.r.d.d..
+00000c30: 007c 0164 0319 00a0 03a1 0044 0083 017c  .|.d.......D...|
+00000c40: 005f 046e 1864 067c 01a0 02a1 0076 0073  ._.n.d.|.....v.s
+00000c50: 2664 077c 01a0 02a1 0076 0072 2f7c 006a  &d.|.....v.r/|.j
+00000c60: 0564 0b69 007c 01a4 018e 0101 006e 0369  .d.i.|.......n.i
+00000c70: 007c 005f 0474 067c 006a 0483 0164 086b  .|._.t.|.j...d.k
+00000c80: 0272 417c 01a0 0064 0964 08a1 027c 005f  .rA|...d.d...|._
+00000c90: 076e 107c 01a0 0064 0974 0674 0874 097c  .n.|...d.t.t.t.|
+00000ca0: 006a 0483 0183 0183 0164 0a1a 00a1 027c  .j.......d.....|
+00000cb0: 005f 077c 006a 0a64 0b69 007c 01a4 018e  ._.|.j.d.i.|....
+00000cc0: 0101 0064 0053 0029 0c4e da0e 706f 6973  ...d.S.).N..pois
+00000cd0: 736f 6e5f 6661 6374 6f72 f900 0000 0000  son_factor......
+00000ce0: 0000 8000 0000 0000 00f0 bfda 0676 616c  .............val
+00000cf0: 7565 7363 0100 0000 0000 0000 0000 0000  uesc............
+00000d00: 0300 0000 0400 0000 5300 0000 731e 0000  ........S...s...
+00000d10: 0069 007c 005d 0b5c 027d 017d 0274 007c  .i.|.].\.}.}.t.|
+00000d20: 0283 0173 027c 017c 0293 0271 0253 00a9  ...s.|.|...q.S..
+00000d30: 0029 0172 0400 0000 a903 da02 2e30 da01  .).r.........0..
+00000d40: 6bda 0176 720a 0000 0072 0a00 0000 fa2a  k..vr....r.....*
+00000d50: 2f68 6f6d 652f 6d61 6c74 652f 6769 742f  /home/malte/git/
+00000d60: 6c69 656f 7073 2f6c 6965 6f70 732f 636f  lieops/lieops/co
+00000d70: 7265 2f70 6f6c 792e 7079 da0a 3c64 6963  re/poly.py..<dic
+00000d80: 7463 6f6d 703e 4300 0000 f302 0000 001e  tcomp>C.........
+00000d90: 007a 225f 706f 6c79 2e5f 5f69 6e69 745f  .z"_poly.__init_
+00000da0: 5f2e 3c6c 6f63 616c 733e 2e3c 6469 6374  _.<locals>.<dict
+00000db0: 636f 6d70 3eda 0161 da01 6272 0100 0000  comp>..a..br....
+00000dc0: da03 6469 6de9 0200 0000 720a 0000 0029  ..dim.....r....)
+00000dd0: 0bda 0367 6574 da0f 5f70 6f69 7373 6f6e  ...get.._poisson
+00000de0: 5f66 6163 746f 72da 046b 6579 73da 0569  _factor..keys..i
+00000df0: 7465 6d73 da07 5f76 616c 7565 73da 0c73  tems.._values..s
+00000e00: 6574 5f6d 6f6e 6f6d 6961 6cda 036c 656e  et_monomial..len
+00000e10: 7214 0000 00da 046e 6578 74da 0469 7465  r......next..ite
+00000e20: 72da 0d73 6574 5f6d 6178 5f70 6f77 6572  r..set_max_power
+00000e30: a902 da04 7365 6c66 da06 6b77 6172 6773  ....self..kwargs
+00000e40: 720a 0000 0072 0a00 0000 720f 0000 00da  r....r....r.....
+00000e50: 085f 5f69 6e69 745f 5f35 0000 0073 1400  .__init__5...s..
+00000e60: 0000 0e02 0c0b 1a01 1801 1201 0602 0e02  ................
+00000e70: 1001 2002 1402 7a0e 5f70 6f6c 792e 5f5f  .. ...z._poly.__
+00000e80: 696e 6974 5f5f da03 696e 6663 0200 0000  init__..infc....
+00000e90: 0000 0000 0000 0000 0300 0000 0300 0000  ................
+00000ea0: 0b00 0000 7322 0000 0088 007c 005f 0087  ....s".....|._..
+00000eb0: 0066 0164 0164 0284 087c 00a0 01a1 0044  .f.d.d...|.....D
+00000ec0: 0083 017c 005f 0264 0353 0029 0461 b701  ...|._.d.S.).a..
+00000ed0: 0000 0a20 2020 2020 2020 2053 6574 2074  ...        Set t
+00000ee0: 6865 206d 6178 696d 616c 2070 6f77 6572  he maximal power
+00000ef0: 2074 6f20 6265 2074 616b 656e 2069 6e74   to be taken int
+00000f00: 6f20 636f 6e73 6964 6572 6174 696f 6e2e  o consideration.
+00000f10: 0a20 2020 2020 2020 2041 7474 656e 7469  .        Attenti
+00000f20: 6f6e 3a20 5468 6973 206f 7065 7261 7469  on: This operati
+00000f30: 6f6e 2077 696c 6c20 6469 7363 6172 6420  on will discard 
+00000f40: 7468 6520 6375 7272 656e 7420 7661 6c75  the current valu
+00000f50: 6573 202a 7769 7468 6f75 742a 2072 6563  es *without* rec
+00000f60: 6f76 6572 792e 0a20 2020 2020 2020 200a  overy..        .
+00000f70: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00000f80: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00000f90: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6d61  -----.        ma
+00000fa0: 785f 706f 7765 723a 2069 6e74 2c20 6f70  x_power: int, op
+00000fb0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00000fc0: 2020 2041 2076 616c 7565 203e 2030 206d     A value > 0 m
+00000fd0: 6561 6e73 2074 6861 7420 616e 7920 6361  eans that any ca
+00000fe0: 6c63 756c 6174 696f 6e73 206c 6561 6469  lculations leadi
+00000ff0: 6e67 2074 6f20 6578 7072 6573 7369 6f6e  ng to expression
+00001000: 7320 6265 796f 6e64 2074 6869 7320 0a20  s beyond this . 
+00001010: 2020 2020 2020 2020 2020 2064 6567 7265             degre
+00001020: 6520 7769 6c6c 2062 6520 6469 7363 6172  e will be discar
+00001030: 6465 642e 2046 6f72 2062 696e 6172 7920  ded. For binary 
+00001040: 6f70 6572 6174 696f 6e73 2074 6865 206d  operations the m
+00001050: 696e 696d 756d 206f 6620 626f 7468 200a  inimum of both .
+00001060: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
+00001070: 706f 7765 7273 2061 7265 2075 7365 642e  powers are used.
+00001080: 0a20 2020 2020 2020 2063 0100 0000 0000  .        c......
+00001090: 0000 0000 0000 0300 0000 0400 0000 1300  ................
+000010a0: 0000 7322 0000 0069 007c 005d 0d5c 027d  ..s"...i.|.].\.}
+000010b0: 017d 0274 007c 0183 0188 006b 0172 027c  .}.t.|.....k.r.|
+000010c0: 017c 0293 0271 0253 0072 0a00 0000 a901  .|...q.S.r......
+000010d0: da03 7375 6d72 0b00 0000 a901 da09 6d61  ..sumr........ma
+000010e0: 785f 706f 7765 7272 0a00 0000 720f 0000  x_powerr....r...
+000010f0: 0072 1000 0000 5d00 0000 7302 0000 0022  .r....]...s...."
+00001100: 007a 275f 706f 6c79 2e73 6574 5f6d 6178  .z'_poly.set_max
+00001110: 5f70 6f77 6572 2e3c 6c6f 6361 6c73 3e2e  _power.<locals>.
+00001120: 3c64 6963 7463 6f6d 703e 4e29 0372 2800  <dictcomp>N).r(.
+00001130: 0000 7219 0000 0072 1a00 0000 2903 7221  ..r....r....).r!
+00001140: 0000 0072 2800 0000 7222 0000 0072 0a00  ...r(...r"...r..
+00001150: 0000 7227 0000 0072 0f00 0000 721f 0000  ..r'...r....r...
+00001160: 0050 0000 0073 0400 0000 060c 1c01 7a13  .P...s........z.
+00001170: 5f70 6f6c 792e 7365 745f 6d61 785f 706f  _poly.set_max_po
+00001180: 7765 72e9 0100 0000 6304 0000 0000 0000  wer.....c.......
+00001190: 0000 0000 0006 0000 0005 0000 004b 0000  .............K..
+000011a0: 0073 6e00 0000 7400 7401 7c01 8301 7401  .sn...t.t.|...t.
+000011b0: 7c02 8301 6702 8301 7d05 7401 7c01 8301  |...g...}.t.|...
+000011c0: 7c05 6b00 721b 7c01 6401 6701 7c05 7401  |.k.r.|.d.g.|.t.
+000011d0: 7c01 8301 1800 1400 3700 7d01 7401 7c02  |.......7.}.t.|.
+000011e0: 8301 7c05 6b00 722c 7c02 6401 6701 7c05  ..|.k.r,|.d.g.|.
+000011f0: 7401 7c02 8301 1800 1400 3700 7d02 7402  t.|.......7.}.t.
+00001200: 7c01 7c02 1700 8301 7c03 6901 7c00 5f03  |.|.....|.i.|._.
+00001210: 6400 5300 2902 4e72 0100 0000 2904 da03  d.S.).Nr....)...
+00001220: 6d61 7872 1c00 0000 da05 7475 706c 6572  maxr......tupler
+00001230: 1a00 0000 2906 7221 0000 0072 1200 0000  ....).r!...r....
+00001240: 7213 0000 00da 0576 616c 7565 7222 0000  r......valuer"..
+00001250: 0072 1400 0000 720a 0000 0072 0a00 0000  .r....r....r....
+00001260: 720f 0000 0072 1b00 0000 5f00 0000 730c  r....r...._...s.
+00001270: 0000 0014 010c 0116 010c 0116 0116 017a  ...............z
+00001280: 125f 706f 6c79 2e73 6574 5f6d 6f6e 6f6d  ._poly.set_monom
+00001290: 6961 6c63 0100 0000 0000 0000 0000 0000  ialc............
+000012a0: 0100 0000 0400 0000 4300 0000 f328 0000  ........C....(..
+000012b0: 0074 007c 006a 0183 0164 016b 0272 0964  .t.|.j...d.k.r.d
+000012c0: 0153 0074 0264 0264 0384 007c 00a0 03a1  .S.t.d.d...|....
+000012d0: 0044 0083 0183 0153 0029 047a 470a 2020  .D.....S.).zG.  
+000012e0: 2020 2020 2020 4f62 7461 696e 2074 6865        Obtain the
+000012f0: 206d 6178 696d 616c 2064 6567 7265 6520   maximal degree 
+00001300: 6f66 2074 6865 2063 7572 7265 6e74 2070  of the current p
+00001310: 6f6c 796e 6f6d 6961 6c2e 200a 2020 2020  olynomial. .    
+00001320: 2020 2020 7201 0000 0063 0100 0000 0000      r....c......
+00001330: 0000 0000 0000 0300 0000 0400 0000 5300  ..............S.
+00001340: 0000 f318 0000 0067 007c 005d 085c 027d  .......g.|.].\.}
+00001350: 017d 0274 007c 0183 0191 0271 0253 0072  .}.t.|.....q.S.r
+00001360: 0a00 0000 7225 0000 0072 0b00 0000 720a  ....r%...r....r.
+00001370: 0000 0072 0a00 0000 720f 0000 00da 0a3c  ...r....r......<
+00001380: 6c69 7374 636f 6d70 3e6e 0000 00f3 0200  listcomp>n......
+00001390: 0000 1800 7a20 5f70 6f6c 792e 6d61 7864  ....z _poly.maxd
+000013a0: 6567 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973  eg.<locals>.<lis
+000013b0: 7463 6f6d 703e 2904 721c 0000 0072 1a00  tcomp>).r....r..
+000013c0: 0000 722a 0000 0072 1900 0000 a901 7221  ..r*...r......r!
+000013d0: 0000 0072 0a00 0000 720a 0000 0072 0f00  ...r....r....r..
+000013e0: 0000 da06 6d61 7864 6567 6700 0000 f306  ....maxdegg.....
+000013f0: 0000 000e 0404 0116 027a 0c5f 706f 6c79  .........z._poly
+00001400: 2e6d 6178 6465 6763 0100 0000 0000 0000  .maxdegc........
+00001410: 0000 0000 0100 0000 0400 0000 4300 0000  ............C...
+00001420: 722d 0000 0029 047a 470a 2020 2020 2020  r-...).zG.      
+00001430: 2020 4f62 7461 696e 2074 6865 206d 696e    Obtain the min
+00001440: 696d 616c 2064 6567 7265 6520 6f66 2074  imal degree of t
+00001450: 6865 2063 7572 7265 6e74 2070 6f6c 796e  he current polyn
+00001460: 6f6d 6961 6c2e 200a 2020 2020 2020 2020  omial. .        
+00001470: 7201 0000 0063 0100 0000 0000 0000 0000  r....c..........
+00001480: 0000 0300 0000 0400 0000 5300 0000 722e  ..........S...r.
+00001490: 0000 0072 0a00 0000 7225 0000 0072 0b00  ...r....r%...r..
+000014a0: 0000 720a 0000 0072 0a00 0000 720f 0000  ..r....r....r...
+000014b0: 0072 2f00 0000 7700 0000 7230 0000 007a  .r/...w...r0...z
+000014c0: 205f 706f 6c79 2e6d 696e 6465 672e 3c6c   _poly.mindeg.<l
+000014d0: 6f63 616c 733e 2e3c 6c69 7374 636f 6d70  ocals>.<listcomp
+000014e0: 3e29 0472 1c00 0000 721a 0000 00da 036d  >).r....r......m
+000014f0: 696e 7219 0000 0072 3100 0000 720a 0000  inr....r1...r...
+00001500: 0072 0a00 0000 720f 0000 00da 066d 696e  .r....r......min
+00001510: 6465 6770 0000 0072 3300 0000 7a0c 5f70  degp...r3...z._p
+00001520: 6f6c 792e 6d69 6e64 6567 6301 0000 0000  oly.mindegc.....
+00001530: 0000 0000 0000 0004 0000 0005 0000 0043  ...............C
+00001540: 0000 0073 4400 0000 6900 7d01 7c00 a000  ...sD...i.}.|...
+00001550: a100 4400 5d11 5c02 7d02 7d03 7401 7c03  ..D.].\.}.}.t.|.
+00001560: 6401 8302 7213 7c03 a002 a100 7d03 7c03  d...r.|.....}.|.
+00001570: 7c01 7c02 3c00 7106 7c00 6a03 7c01 7c00  |.|.<.q.|.j.|.|.
+00001580: 6a04 7c00 6a05 6402 8d03 5300 2903 4eda  j.|.j.d...S.).N.
+00001590: 0463 6f70 79a9 0372 0900 0000 7214 0000  .copy..r....r...
+000015a0: 0072 2800 0000 2906 7219 0000 00da 0768  .r(...).r......h
+000015b0: 6173 6174 7472 7236 0000 00da 095f 5f63  asattrr6.....__c
+000015c0: 6c61 7373 5f5f 7214 0000 0072 2800 0000  lass__r....r(...
+000015d0: 2904 7221 0000 00da 0a6e 6577 5f76 616c  ).r!.....new_val
+000015e0: 7565 7372 0d00 0000 720e 0000 0072 0a00  uesr....r....r..
+000015f0: 0000 720a 0000 0072 0f00 0000 7236 0000  ..r....r....r6..
+00001600: 0079 0000 0073 0c00 0000 0401 1001 0a01  .y...s..........
+00001610: 0801 0a01 1401 7a0a 5f70 6f6c 792e 636f  ......z._poly.co
+00001620: 7079 6301 0000 0000 0000 0000 0000 0001  pyc.............
+00001630: 0000 0001 0000 0043 0000 0073 0400 0000  .......C...s....
+00001640: 6401 5300 2902 4e54 720a 0000 00a9 01da  d.S.).NTr.......
+00001650: 0178 720a 0000 0072 0a00 0000 720f 0000  .xr....r....r...
+00001660: 00da 083c 6c61 6d62 6461 3e81 0000 0073  ...<lambda>....s
+00001670: 0200 0000 0400 7a0e 5f70 6f6c 792e 3c6c  ......z._poly.<l
+00001680: 616d 6264 613e a902 da08 6b65 795f 636f  ambda>....key_co
+00001690: 6e64 da0a 7661 6c75 655f 636f 6e64 6301  nd..value_condc.
+000016a0: 0000 0000 0000 0002 0000 0004 0000 0005  ................
+000016b0: 0000 0007 0000 0073 5600 0000 7400 7c03  .......sV...t.|.
+000016c0: 8301 6401 6b02 721a 8801 6a01 8700 8702  ..d.k.r...j.....
+000016d0: 6602 6402 6403 8408 8801 a002 a100 4400  f.d.d.........D.
+000016e0: 8301 8801 6a03 8801 6a04 6404 8d03 5300  ....j...j.d...S.
+000016f0: 8801 6a01 8701 6601 6405 6403 8408 7c03  ..j...f.d.d...|.
+00001700: 4400 8301 8801 6a03 8801 6a04 6404 8d03  D.....j...j.d...
+00001710: 5300 2906 611f 0300 000a 2020 2020 2020  S.).a.....      
+00001720: 2020 4578 7472 6163 7420 6120 4c69 6520    Extract a Lie 
+00001730: 706f 6c79 6e6f 6d69 616c 2066 726f 6d20  polynomial from 
+00001740: 7468 6520 6375 7272 656e 7420 4c69 6520  the current Lie 
+00001750: 706f 6c79 6e6f 6d69 616c 2c20 6261 7365  polynomial, base
+00001760: 6420 6f6e 2061 2063 6f6e 6469 7469 6f6e  d on a condition
+00001770: 2e0a 2020 2020 2020 2020 0a20 2020 2020  ..        .     
+00001780: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00001790: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000017a0: 0a20 2020 2020 2020 206b 6579 5f63 6f6e  .        key_con
+000017b0: 643a 2063 616c 6c61 626c 652c 206f 7074  d: callable, opt
+000017c0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+000017d0: 2020 4120 6675 6e63 7469 6f6e 2077 6869    A function whi
+000017e0: 6368 206d 6170 7320 6120 6769 7665 6e20  ch maps a given 
+000017f0: 7475 706c 6520 2861 6e20 696e 6465 7829  tuple (an index)
+00001800: 2074 6f20 6120 626f 6f6c 6561 6e2e 206b   to a boolean. k
+00001810: 6579 5f63 6f6e 6420 6973 2075 7365 6420  ey_cond is used 
+00001820: 746f 2065 6e66 6f72 6365 2061 2063 6f6e  to enforce a con
+00001830: 6469 7469 6f6e 0a20 2020 2020 2020 2020  dition.         
+00001840: 2020 206f 6e20 7468 6520 6b65 7973 206f     on the keys o
+00001850: 6620 7468 6520 6375 7272 656e 7420 706f  f the current po
+00001860: 6c79 6e6f 6d69 616c 2e20 466f 7220 6578  lynomial. For ex
+00001870: 616d 706c 6520 276b 6579 5f63 6f6e 6420  ample 'key_cond 
+00001880: 3d20 6c61 6d62 6461 2078 3a20 7375 6d28  = lambda x: sum(
+00001890: 7829 203d 3d20 6b27 2077 6f75 6c64 0a20  x) == k' would. 
+000018a0: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
+000018b0: 2074 6865 2068 6f6d 6f67 656e 656f 7573   the homogeneous
+000018c0: 2070 6172 7420 6f66 2074 6865 2063 7572   part of the cur
+000018d0: 7265 6e74 204c 6965 2070 6f6c 796e 6f6d  rent Lie polynom
+000018e0: 6961 6c20 2874 6869 7320 6973 2072 6561  ial (this is rea
+000018f0: 6c69 7a65 6420 696e 2027 7365 6c66 2e68  lized in 'self.h
+00001900: 6f6d 6f67 656e 656f 7573 5f70 6172 7427  omogeneous_part'
+00001910: 292e 0a0a 2020 2020 2020 2020 7661 6c75  )...        valu
+00001920: 655f 636f 6e64 3a20 6361 6c6c 6162 6c65  e_cond: callable
+00001930: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00001940: 2020 2020 2020 2041 2066 756e 6374 696f         A functio
+00001950: 6e20 7768 6963 6820 6d61 7073 2061 2067  n which maps a g
+00001960: 6976 656e 2076 616c 7565 2074 6f20 6120  iven value to a 
+00001970: 626f 6f6c 6561 6e2e 2076 616c 7565 5f63  boolean. value_c
+00001980: 6f6e 6420 6973 2075 7365 6420 746f 2065  ond is used to e
+00001990: 6e66 6f72 6365 2061 2063 6f6e 6469 7469  nforce a conditi
+000019a0: 6f6e 206f 6e20 7468 6520 7661 6c75 6573  on on the values
+000019b0: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
+000019c0: 2020 2020 6375 7272 656e 7420 706f 6c79      current poly
+000019d0: 6e6f 6d69 616c 2e0a 0a20 2020 2020 2020  nomial...       
+000019e0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+000019f0: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00001a00: 2070 6f6c 790a 2020 2020 2020 2020 2020   poly.          
+00001a10: 2020 5468 6520 6578 7472 6163 7465 6420    The extracted 
+00001a20: 4c69 6520 706f 6c79 6e6f 6d69 616c 2e0a  Lie polynomial..
+00001a30: 2020 2020 2020 2020 7201 0000 0063 0100          r....c..
+00001a40: 0000 0000 0000 0000 0000 0300 0000 0400  ................
+00001a50: 0000 1300 0000 7326 0000 0069 007c 005d  ......s&...i.|.]
+00001a60: 0f5c 027d 017d 0288 007c 0183 0172 0288  .\.}.}...|...r..
+00001a70: 017c 0283 0172 027c 017c 0293 0271 0253  .|...r.|.|...q.S
+00001a80: 0072 0a00 0000 720a 0000 0029 0372 0c00  .r....r....).r..
+00001a90: 0000 5a04 6b65 7963 5a06 7661 6c75 6563  ..Z.keycZ.valuec
+00001aa0: 723e 0000 0072 0a00 0000 720f 0000 0072  r>...r....r....r
+00001ab0: 1000 0000 9600 0000 f302 0000 0026 007a  .............&.z
+00001ac0: 215f 706f 6c79 2e65 7874 7261 6374 2e3c  !_poly.extract.<
+00001ad0: 6c6f 6361 6c73 3e2e 3c64 6963 7463 6f6d  locals>.<dictcom
+00001ae0: 703e 7237 0000 0063 0100 0000 0000 0000  p>r7...c........
+00001af0: 0000 0000 0200 0000 0500 0000 1300 0000  ................
+00001b00: 7316 0000 0069 007c 005d 077d 017c 0188  s....i.|.].}.|..
+00001b10: 007c 0119 0093 0271 0253 0072 0a00 0000  .|.....q.S.r....
+00001b20: 720a 0000 0029 0272 0c00 0000 da03 6b65  r....).r......ke
+00001b30: 7972 3100 0000 720a 0000 0072 0f00 0000  yr1...r....r....
+00001b40: 7210 0000 0099 0000 00f3 0200 0000 1600  r...............
+00001b50: 2905 721c 0000 0072 3900 0000 7219 0000  ).r....r9...r...
+00001b60: 0072 1400 0000 7228 0000 0029 0472 2100  .r....r(...).r!.
+00001b70: 0000 723f 0000 0072 4000 0000 7218 0000  ..r?...r@...r...
+00001b80: 0072 0a00 0000 2903 723f 0000 0072 2100  .r....).r?...r!.
+00001b90: 0000 7240 0000 0072 0f00 0000 da07 6578  ..r@...r......ex
+00001ba0: 7472 6163 7481 0000 0073 0a00 0000 0c14  tract....s......
+00001bb0: 1a01 0801 06ff 2203 7a0d 5f70 6f6c 792e  ......".z._poly.
+00001bc0: 6578 7472 6163 7472 0d00 0000 6302 0000  extractr....c...
+00001bd0: 0000 0000 0000 0000 0002 0000 0004 0000  ................
+00001be0: 0003 0000 00f3 1400 0000 7c00 6a00 8700  ..........|.j...
+00001bf0: 6601 6401 6402 8408 6403 8d01 5300 2904  f.d.d...d...S.).
+00001c00: 6119 0100 000a 2020 2020 2020 2020 4578  a.....        Ex
+00001c10: 7472 6163 7420 7468 6520 686f 6d6f 6765  tract the homoge
+00001c20: 6e65 6f75 7320 7061 7274 206f 6620 6f72  neous part of or
+00001c30: 6465 7220 6b20 6672 6f6d 2074 6865 2063  der k from the c
+00001c40: 7572 7265 6e74 204c 6965 2070 6f6c 796e  urrent Lie polyn
+00001c50: 6f6d 6961 6c2e 0a20 2020 2020 2020 200a  omial..        .
+00001c60: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00001c70: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00001c80: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6b3a  -----.        k:
+00001c90: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
+00001ca0: 2054 6865 2072 6571 7565 7374 6564 206f   The requested o
+00001cb0: 7264 6572 2e0a 2020 2020 2020 2020 2020  rder..          
+00001cc0: 2020 0a20 2020 2020 2020 2052 6574 7572    .        Retur
+00001cd0: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
+00001ce0: 2d2d 0a20 2020 2020 2020 2070 6f6c 790a  --.        poly.
+00001cf0: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+00001d00: 6578 7472 6163 7465 6420 706f 6c79 6e6f  extracted polyno
+00001d10: 6d69 616c 2e0a 2020 2020 2020 2020 6301  mial..        c.
+00001d20: 0000 0000 0000 0000 0000 0001 0000 0002  ................
+00001d30: 0000 0013 0000 0073 0c00 0000 7400 7c00  .......s....t.|.
+00001d40: 8301 8800 6b02 5300 a901 4e72 2500 0000  ....k.S...Nr%...
+00001d50: 723b 0000 00a9 0172 0d00 0000 720a 0000  r;.....r....r...
+00001d60: 0072 0f00 0000 723d 0000 00a9 0000 00f3  .r....r=........
+00001d70: 0200 0000 0c00 7a28 5f70 6f6c 792e 686f  ......z(_poly.ho
+00001d80: 6d6f 6765 6e65 6f75 735f 7061 7274 2e3c  mogeneous_part.<
+00001d90: 6c6f 6361 6c73 3e2e 3c6c 616d 6264 613e  locals>.<lambda>
+00001da0: a901 723f 0000 00a9 0172 4400 0000 a902  ..r?.....rD.....
+00001db0: 7221 0000 0072 0d00 0000 720a 0000 0072  r!...r....r....r
+00001dc0: 4700 0000 720f 0000 00da 1068 6f6d 6f67  G...r......homog
+00001dd0: 656e 656f 7573 5f70 6172 749b 0000 0073  eneous_part....s
+00001de0: 0200 0000 140e 7a16 5f70 6f6c 792e 686f  ......z._poly.ho
+00001df0: 6d6f 6765 6e65 6f75 735f 7061 7274 da03  mogeneous_part..
+00001e00: 746f 6c63 0200 0000 0000 0000 0000 0000  tolc............
+00001e10: 0300 0000 0300 0000 0300 0000 f318 0000  ................
+00001e20: 0087 0066 0164 0164 0284 087d 027c 006a  ...f.d.d...}.|.j
+00001e30: 007c 0264 038d 0153 0029 0461 6a01 0000  .|.d...S.).aj...
+00001e40: 0a20 2020 2020 2020 2044 726f 7020 7661  .        Drop va
+00001e50: 6c75 6573 2062 656c 6f77 2061 2067 6976  lues below a giv
+00001e60: 656e 2074 6872 6573 686f 6c64 2e0a 2020  en threshold..  
+00001e70: 2020 2020 2020 0a20 2020 2020 2020 2050        .        P
+00001e80: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00001e90: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00001ea0: 2020 2020 2074 6f6c 3a20 666c 6f61 740a       tol: float.
+00001eb0: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+00001ec0: 7468 7265 7368 6f6c 642e 0a20 2020 2020  threshold..     
+00001ed0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00001ee0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+00001ef0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00001f00: 706f 6c79 0a20 2020 2020 2020 2020 2020  poly.           
+00001f10: 2041 2070 6f6c 796e 6f6d 6961 6c20 6861   A polynomial ha
+00001f20: 7669 6e67 2074 6865 2073 616d 6520 6b65  ving the same ke
+00001f30: 7973 2f76 616c 7565 7320 6173 2074 6865  ys/values as the
+00001f40: 2063 7572 7265 6e74 2070 6f6c 796e 6f6d   current polynom
+00001f50: 6961 6c2c 2062 7574 2074 6865 2061 6273  ial, but the abs
+00001f60: 6f6c 7574 6520 7661 6c75 6573 2061 7265  olute values are
+00001f70: 206c 6172 6765 720a 2020 2020 2020 2020   larger.        
+00001f80: 2020 2020 7468 616e 2074 6865 2072 6571      than the req
+00001f90: 7565 7374 6564 2074 6872 6573 686f 6c64  uested threshold
+00001fa0: 2e0a 2020 2020 2020 2020 6301 0000 0000  ..        c.....
+00001fb0: 0000 0000 0000 0002 0000 0003 0000 0013  ................
+00001fc0: 0000 0073 2200 0000 7400 7c00 8301 8800  ...s"...t.|.....
+00001fd0: 6b04 7d01 7401 7c01 6401 8302 730d 7c01  k.}.t.|.d...s.|.
+00001fe0: 5300 7c01 a002 a100 5300 a902 4eda 085f  S.|.....S...N.._
+00001ff0: 5f69 7465 725f 5fa9 03da 0361 6273 7238  _iter__....absr8
+00002000: 0000 00da 0361 6c6c a902 723c 0000 00da  .....all..r<....
+00002010: 0672 6573 756c 74a9 0172 4d00 0000 720a  .result..rM...r.
+00002020: 0000 0072 0f00 0000 7240 0000 00ba 0000  ...r....r@......
+00002030: 00f3 0800 0000 0c01 0a01 0401 0802 7a1f  ..............z.
+00002040: 5f70 6f6c 792e 6162 6f76 652e 3c6c 6f63  _poly.above.<loc
+00002050: 616c 733e 2e76 616c 7565 5f63 6f6e 64a9  als>.value_cond.
+00002060: 0172 4000 0000 724a 0000 00a9 0372 2100  .r@...rJ.....r!.
+00002070: 0000 724d 0000 0072 4000 0000 720a 0000  ..rM...r@...r...
+00002080: 0072 5600 0000 720f 0000 00da 0561 626f  .rV...r......abo
+00002090: 7665 ab00 0000 f304 0000 000c 0f0c 067a  ve.............z
+000020a0: 0b5f 706f 6c79 2e61 626f 7665 6302 0000  ._poly.abovec...
+000020b0: 0000 0000 0000 0000 0003 0000 0003 0000  ................
+000020c0: 0003 0000 0072 4e00 0000 2904 616b 0100  .....rN...).ak..
+000020d0: 000a 2020 2020 2020 2020 4472 6f70 2076  ..        Drop v
+000020e0: 616c 7565 7320 6162 6f76 6520 6120 6769  alues above a gi
+000020f0: 7665 6e20 7468 7265 7368 6f6c 642e 0a20  ven threshold.. 
+00002100: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00002110: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+00002120: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+00002130: 2020 2020 2020 746f 6c3a 2066 6c6f 6174        tol: float
+00002140: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+00002150: 2074 6872 6573 686f 6c64 2e0a 2020 2020   threshold..    
+00002160: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+00002170: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+00002180: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00002190: 2070 6f6c 790a 2020 2020 2020 2020 2020   poly.          
+000021a0: 2020 4120 706f 6c79 6e6f 6d69 616c 2068    A polynomial h
+000021b0: 6176 696e 6720 7468 6520 7361 6d65 206b  aving the same k
+000021c0: 6579 732f 7661 6c75 6573 2061 7320 7468  eys/values as th
+000021d0: 6520 6375 7272 656e 7420 706f 6c79 6e6f  e current polyno
+000021e0: 6d69 616c 2c20 6275 7420 7468 6520 6162  mial, but the ab
+000021f0: 736f 6c75 7465 2076 616c 7565 7320 6172  solute values ar
+00002200: 6520 736d 616c 6c65 720a 2020 2020 2020  e smaller.      
+00002210: 2020 2020 2020 7468 616e 2074 6865 2072        than the r
+00002220: 6571 7565 7374 6564 2074 6872 6573 686f  equested thresho
+00002230: 6c64 2e0a 2020 2020 2020 2020 6301 0000  ld..        c...
+00002240: 0000 0000 0000 0000 0002 0000 0003 0000  ................
+00002250: 0013 0000 0073 2200 0000 7400 7c00 8301  .....s"...t.|...
+00002260: 8800 6b00 7d01 7401 7c01 6401 8302 730d  ..k.}.t.|.d...s.
+00002270: 7c01 5300 7c01 a002 a100 5300 724f 0000  |.S.|.....S.rO..
+00002280: 0072 5100 0000 7254 0000 0072 5600 0000  .rQ...rT...rV...
+00002290: 720a 0000 0072 0f00 0000 7240 0000 00d1  r....r....r@....
+000022a0: 0000 0072 5700 0000 7a1f 5f70 6f6c 792e  ...rW...z._poly.
+000022b0: 6265 6c6f 772e 3c6c 6f63 616c 733e 2e76  below.<locals>.v
+000022c0: 616c 7565 5f63 6f6e 6472 5800 0000 724a  alue_condrX...rJ
+000022d0: 0000 0072 5900 0000 720a 0000 0072 5600  ...rY...r....rV.
+000022e0: 0000 720f 0000 00da 0562 656c 6f77 c200  ..r......below..
+000022f0: 0000 725b 0000 007a 0b5f 706f 6c79 2e62  ..r[...z._poly.b
+00002300: 656c 6f77 6301 0000 0000 0000 0000 0000  elowc...........
+00002310: 0001 0000 0003 0000 0003 0000 0073 1600  .............s..
+00002320: 0000 8700 6601 6401 6402 8408 8800 a000  ....f.d.d.......
+00002330: a100 4400 8301 5300 2903 7a4b 0a20 2020  ..D...S.).zK.   
+00002340: 2020 2020 2052 6574 7572 6e20 6120 6c69       Return a li
+00002350: 7374 206f 6620 7468 6520 6d6f 6e6f 6d69  st of the monomi
+00002360: 616c 7320 6f66 2074 6865 2063 7572 7265  als of the curre
+00002370: 6e74 2070 6f6c 796e 6f6d 6961 6c2e 0a20  nt polynomial.. 
+00002380: 2020 2020 2020 2063 0100 0000 0000 0000         c........
+00002390: 0000 0000 0300 0000 0700 0000 1300 0000  ................
+000023a0: 7328 0000 0067 007c 005d 105c 027d 017d  s(...g.|.].\.}.}
+000023b0: 0288 006a 007c 017c 0269 0188 006a 0188  ...j.|.|.i...j..
+000023c0: 006a 0264 008d 0391 0271 0253 0029 0172  .j.d.....q.S.).r
+000023d0: 3700 0000 2903 7239 0000 0072 1400 0000  7...).r9...r....
+000023e0: 7228 0000 0072 0b00 0000 7231 0000 0072  r(...r....r1...r
+000023f0: 0a00 0000 720f 0000 0072 2f00 0000 dd00  ....r....r/.....
+00002400: 0000 f302 0000 0028 007a 235f 706f 6c79  .......(.z#_poly
+00002410: 2e6d 6f6e 6f6d 6961 6c73 2e3c 6c6f 6361  .monomials.<loca
+00002420: 6c73 3e2e 3c6c 6973 7463 6f6d 703e 2901  ls>.<listcomp>).
+00002430: 7219 0000 0072 3100 0000 720a 0000 0072  r....r1...r....r
+00002440: 3100 0000 720f 0000 00da 096d 6f6e 6f6d  1...r......monom
+00002450: 6961 6c73 d900 0000 7302 0000 0016 047a  ials....s......z
+00002460: 0f5f 706f 6c79 2e6d 6f6e 6f6d 6961 6c73  ._poly.monomials
+00002470: 6302 0000 0000 0000 0000 0000 0002 0000  c...............
+00002480: 0004 0000 0003 0000 0072 4500 0000 2904  .........rE...).
+00002490: 7a50 0a20 2020 2020 2020 2054 7275 6e63  zP.        Trunc
+000024a0: 6174 6520 7468 6520 6375 7272 656e 7420  ate the current 
+000024b0: 706f 6c79 6e6f 6d69 616c 2077 6974 6820  polynomial with 
+000024c0: 7265 7370 6563 7420 746f 2061 2074 6f74  respect to a tot
+000024d0: 616c 2070 6f77 6572 2e0a 2020 2020 2020  al power..      
+000024e0: 2020 6301 0000 0000 0000 0000 0000 0001    c.............
+000024f0: 0000 0002 0000 0013 0000 0073 0c00 0000  ...........s....
+00002500: 7400 7c00 8301 8800 6b01 5300 7246 0000  t.|.....k.S.rF..
+00002510: 0072 2500 0000 723b 0000 0072 4700 0000  .r%...r;...rG...
+00002520: 720a 0000 0072 0f00 0000 723d 0000 00e3  r....r....r=....
+00002530: 0000 0072 4800 0000 7a20 5f70 6f6c 792e  ...rH...z _poly.
+00002540: 7472 756e 6361 7465 2e3c 6c6f 6361 6c73  truncate.<locals
+00002550: 3e2e 3c6c 616d 6264 613e 7249 0000 0072  >.<lambda>rI...r
+00002560: 4a00 0000 724b 0000 0072 0a00 0000 7247  J...rK...r....rG
+00002570: 0000 0072 0f00 0000 da08 7472 756e 6361  ...r......trunca
+00002580: 7465 df00 0000 7302 0000 0014 047a 0e5f  te....s......z._
+00002590: 706f 6c79 2e74 7275 6e63 6174 6563 0100  poly.truncatec..
+000025a0: 0000 0000 0000 0000 0000 0300 0000 0800  ................
+000025b0: 0000 4700 0000 7370 0000 0074 007c 0183  ..G...sp...t.|..
+000025c0: 017c 006a 016b 0272 1a7c 006a 0264 016b  .|.j.k.r.|.j.d.k
+000025d0: 0272 1a64 0264 0384 007c 0144 0083 0164  .r.d.d...|.D...d
+000025e0: 0464 0384 007c 0144 0083 0117 007d 017c  .d...|.D.....}.|
+000025f0: 006a 0164 0514 007d 0274 007c 0183 017c  .j.d...}.t.|...|
+00002600: 026b 0273 364a 0064 0674 007c 0183 019b  .k.s6J.d.t.|....
+00002610: 0064 077c 029b 0064 087c 006a 019b 0064  .d.|...d.|.j...d
+00002620: 099d 0783 0182 017c 0153 0029 0a7a 4c0a  .......|.S.).zL.
+00002630: 2020 2020 2020 2020 436f 6e73 6973 7465          Consiste
+00002640: 6e63 7920 6368 6563 6b20 2620 696e 7075  ncy check & inpu
+00002650: 7420 7072 6570 6172 6174 696f 6e20 7072  t preparation pr
+00002660: 696f 7220 746f 2065 7661 6c75 6174 696f  ior to evaluatio
+00002670: 6e2e 0a20 2020 2020 2020 2072 0800 0000  n..        r....
+00002680: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
+00002690: 0003 0000 0053 0000 0073 1000 0000 6700  .....S...s....g.
+000026a0: 7c00 5d04 7d01 7c01 9102 7102 5300 720a  |.].}.|...q.S.r.
+000026b0: 0000 0072 0a00 0000 a902 720c 0000 00da  ...r......r.....
+000026c0: 0165 720a 0000 0072 0a00 0000 720f 0000  .er....r....r...
+000026d0: 0072 2f00 0000 eb00 0000 7302 0000 0010  .r/.......s.....
+000026e0: 007a 285f 706f 6c79 2e5f 7072 6570 6172  .z(_poly._prepar
+000026f0: 655f 696e 7075 742e 3c6c 6f63 616c 733e  e_input.<locals>
+00002700: 2e3c 6c69 7374 636f 6d70 3e63 0100 0000  .<listcomp>c....
+00002710: 0000 0000 0000 0000 0200 0000 0400 0000  ................
+00002720: 5300 0000 7314 0000 0067 007c 005d 067d  S...s....g.|.].}
+00002730: 017c 01a0 00a1 0091 0271 0253 0072 0a00  .|.......q.S.r..
+00002740: 0000 2901 da09 636f 6e6a 7567 6174 6572  ..)...conjugater
+00002750: 6000 0000 720a 0000 0072 0a00 0000 720f  `...r....r....r.
+00002760: 0000 0072 2f00 0000 eb00 0000 7302 0000  ...r/.......s...
+00002770: 0014 0072 1500 0000 7a1c 4e75 6d62 6572  ...r....z.Number
+00002780: 206f 6620 696e 7075 7420 7061 7261 6d65   of input parame
+00002790: 7465 7273 3a20 7a0c 2c20 6578 7065 6374  ters: z., expect
+000027a0: 6564 3a20 7a05 2028 6f72 20fa 0129 2903  ed: z. (or ..)).
+000027b0: 721c 0000 0072 1400 0000 7217 0000 0029  r....r....r....)
+000027c0: 0372 2100 0000 da01 7ada 0464 696d 3272  .r!.....z..dim2r
+000027d0: 0a00 0000 720a 0000 0072 0f00 0000 da0e  ....r....r......
+000027e0: 5f70 7265 7061 7265 5f69 6e70 7574 e500  _prepare_input..
+000027f0: 0000 730a 0000 0018 041c 020a 012e 0104  ..s.............
+00002800: 017a 145f 706f 6c79 2e5f 7072 6570 6172  .z._poly._prepar
+00002810: 655f 696e 7075 7463 0100 0000 0000 0000  e_inputc........
+00002820: 0000 0000 0800 0000 0800 0000 0700 0000  ................
+00002830: 73dc 0000 007c 006a 0088 018e 0089 0169  s....|.j.......i
+00002840: 007d 0264 0189 0074 017c 00a0 02a1 008e  .}.d...t.|......
+00002850: 0044 005d 157d 0387 0087 0166 0264 0264  .D.].}.....f.d.d
+00002860: 0384 0874 03a0 047c 03a1 0144 0083 017c  ...t...|...D...|
+00002870: 0288 003c 0088 0064 0437 0089 0071 0f74  ...<...d.7...q.t
+00002880: 057c 0074 0688 0164 0119 0083 0183 0272  .|.t...d.......r
+00002890: 397c 006a 0769 007c 006a 087c 006a 0964  9|.j.i.|.j.|.j.d
+000028a0: 058d 037d 046e 0264 017d 047c 00a0 0aa1  ...}.n.d.}.|....
+000028b0: 0044 005d 2c5c 027d 057d 0664 047d 0774  .D.],\.}.}.d.}.t
+000028c0: 0b7c 006a 0883 0144 005d 1a89 007c 077c  .|.j...D.]...|.|
+000028d0: 0288 0019 007c 0588 0019 0019 007c 0288  .....|.......|..
+000028e0: 007c 006a 0817 0019 007c 0588 007c 006a  .|.j.....|...|.j
+000028f0: 0817 0019 0019 0014 0039 007d 0771 4a7c  .........9.}.qJ|
+00002900: 047c 077c 0614 0037 007d 0471 3f7c 0453  .|.|...7.}.q?|.S
+00002910: 0029 0661 c401 0000 0a20 2020 2020 2020  .).a.....       
+00002920: 2045 7661 6c75 6174 6520 7468 6520 706f   Evaluate the po
+00002930: 6c79 6e6f 6d69 616c 2061 7420 6120 7370  lynomial at a sp
+00002940: 6563 6966 6963 2070 6f73 6974 696f 6e20  ecific position 
+00002950: 7a2e 0a20 2020 2020 2020 200a 2020 2020  z..        .    
+00002960: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00002970: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00002980: 2d0a 2020 2020 2020 2020 7a3a 2073 7562  -.        z: sub
+00002990: 7363 7269 7074 6162 6c65 0a20 2020 2020  scriptable.     
+000029a0: 2020 2020 2020 2054 6865 2070 6f69 6e74         The point
+000029b0: 2061 7420 7768 6963 6820 7468 6520 706f   at which the po
+000029c0: 6c79 6e6f 6d69 616c 2073 686f 756c 6420  lynomial should 
+000029d0: 6265 2065 7661 6c75 6174 6564 2e20 4974  be evaluated. It
+000029e0: 2069 7320 6173 7375 6d65 6420 7468 6174   is assumed that
+000029f0: 206c 656e 287a 2920 3d3d 2073 656c 662e   len(z) == self.
+00002a00: 6469 6d2c 0a20 2020 2020 2020 2020 2020  dim,.           
+00002a10: 2069 6e20 7768 6963 6820 6361 7365 2074   in which case t
+00002a20: 6865 2063 6f6d 706f 6e65 6e74 7320 6f66  he components of
+00002a30: 207a 2061 7265 2061 7373 756d 6564 2074   z are assumed t
+00002a40: 6f20 6265 2078 692d 7661 6c75 6573 2e20  o be xi-values. 
+00002a50: 4f74 6865 7277 6973 652c 2069 7420 6973  Otherwise, it is
+00002a60: 2061 7373 756d 6564 2074 6861 7420 6c65   assumed that le
+00002a70: 6e28 7a29 203d 3d20 322a 7365 6c66 2e64  n(z) == 2*self.d
+00002a80: 696d 2c0a 2020 2020 2020 2020 2020 2020  im,.            
+00002a90: 7768 6572 6520 7a20 3d20 2878 692c 2065  where z = (xi, e
+00002aa0: 7461 2920 6465 6e6f 7465 2061 2073 6574  ta) denote a set
+00002ab0: 206f 6620 636f 6d70 6c65 7820 636f 6e6a   of complex conj
+00002ac0: 7567 6174 6564 2063 6f6f 7264 696e 6174  ugated coordinat
+00002ad0: 6573 2e0a 2020 2020 2020 2020 7201 0000  es..        r...
+00002ae0: 0063 0100 0000 0000 0000 0000 0000 0200  .c..............
+00002af0: 0000 0600 0000 1300 0000 731e 0000 0069  ..........s....i
+00002b00: 007c 005d 0b7d 017c 0188 0188 0019 0074  .|.].}.|.......t
+00002b10: 007c 0183 0113 0093 0271 0253 0072 0a00  .|.......q.S.r..
+00002b20: 0000 2901 da03 696e 74a9 0272 0c00 0000  ..)...int..r....
+00002b30: 720d 0000 00a9 02da 016a 7264 0000 0072  r........jrd...r
+00002b40: 0a00 0000 720f 0000 0072 1000 0000 0201  ....r....r......
+00002b50: 0000 7211 0000 007a 225f 706f 6c79 2e5f  ..r....z"_poly._
+00002b60: 5f63 616c 6c5f 5f2e 3c6c 6f63 616c 733e  _call__.<locals>
+00002b70: 2e3c 6469 6374 636f 6d70 3e72 2900 0000  .<dictcomp>r)...
+00002b80: 7237 0000 0029 0c72 6600 0000 da03 7a69  r7...).rf.....zi
+00002b90: 7072 1800 0000 da02 6e70 da06 756e 6971  pr......np..uniq
+00002ba0: 7565 da0a 6973 696e 7374 616e 6365 da04  ue..isinstance..
+00002bb0: 7479 7065 7239 0000 0072 1400 0000 7228  typer9...r....r(
+00002bc0: 0000 0072 1900 0000 da05 7261 6e67 6529  ...r......range)
+00002bd0: 0872 2100 0000 7264 0000 005a 087a 5f70  .r!...rd...Z.z_p
+00002be0: 6f77 6572 735a 0277 6572 5500 0000 720d  owersZ.werU...r.
+00002bf0: 0000 0072 0e00 0000 da04 7072 6f64 720a  ...r......prodr.
+00002c00: 0000 0072 6900 0000 720f 0000 00da 085f  ...ri...r......_
+00002c10: 5f63 616c 6c5f 5ff0 0000 0073 1e00 0000  _call__....s....
+00002c20: 0a0c 0403 0401 1001 1e01 0a02 1203 1602  ................
+00002c30: 0402 1002 0401 0e01 3201 0e01 0402 7a0e  ........2.....z.
+00002c40: 5f70 6f6c 792e 5f5f 6361 6c6c 5f5f 6302  _poly.__call__c.
+00002c50: 0000 0000 0000 0000 0000 0007 0000 0005  ................
+00002c60: 0000 0043 0000 0073 c200 0000 7400 7c01  ...C...s....t.|.
+00002c70: 8301 7206 7c00 5300 6401 6402 8400 7c00  ..r.|.S.d.d...|.
+00002c80: a001 a100 4400 8301 7d02 7402 7c00 7403  ....D...}.t.|.t.
+00002c90: 7c01 8301 8302 732b 6403 7c00 6a04 1400  |.....s+d.|.j...
+00002ca0: 6404 1400 7d03 7c02 a005 7c03 6405 a102  d...}.|...|.d...
+00002cb0: 7c01 1700 7c02 7c03 3c00 7c00 6a06 7d04  |...|.|.<.|.j.}.
+00002cc0: 6e2d 7c00 6a04 7c01 6a04 6b02 733d 4a00  n-|.j.|.j.k.s=J.
+00002cd0: 6406 7c00 6a04 9b00 6407 7c01 6a04 9b00  d.|.j...d.|.j...
+00002ce0: 9d04 8301 8201 7c01 a001 a100 4400 5d0e  ......|.....D.].
+00002cf0: 5c02 7d05 7d06 7c02 a005 7c05 6405 a102  \.}.}.|...|.d...
+00002d00: 7c06 1700 7c02 7c05 3c00 7141 7407 7c00  |...|.|.<.qAt.|.
+00002d10: 6a06 7c01 6a06 6702 8301 7d04 7c00 6a08  j.|.j.g...}.|.j.
+00002d20: 7c02 7c00 6a04 7c04 6408 8d03 5300 2909  |.|.j.|.d...S.).
+00002d30: 4e63 0100 0000 0000 0000 0000 0000 0300  Nc..............
+00002d40: 0000 0400 0000 5300 0000 f316 0000 0069  ......S........i
+00002d50: 007c 005d 075c 027d 017d 027c 017c 0293  .|.].\.}.}.|.|..
+00002d60: 0271 0253 0072 0a00 0000 720a 0000 0072  .q.S.r....r....r
+00002d70: 0b00 0000 720a 0000 0072 0a00 0000 720f  ....r....r....r.
+00002d80: 0000 0072 1000 0000 1801 0000 7243 0000  ...r........rC..
+00002d90: 007a 215f 706f 6c79 2e5f 5f61 6464 5f5f  .z!_poly.__add__
+00002da0: 2e3c 6c6f 6361 6c73 3e2e 3c64 6963 7463  .<locals>.<dictc
+00002db0: 6f6d 703e a901 7201 0000 0072 1500 0000  omp>..r....r....
+00002dc0: 7201 0000 00fa 1944 696d 656e 7369 6f6e  r......Dimension
+00002dd0: 7320 646f 206e 6f74 2061 6772 6565 3a20  s do not agree: 
+00002de0: fa04 2021 3d20 7237 0000 0029 0972 0400  .. != r7...).r..
+00002df0: 0000 7219 0000 0072 6e00 0000 726f 0000  ..r....rn...ro..
+00002e00: 0072 1400 0000 7216 0000 0072 2800 0000  .r....r....r(...
+00002e10: 7234 0000 0072 3900 0000 2907 7221 0000  r4...r9...).r!..
+00002e20: 00da 056f 7468 6572 5a0a 6164 645f 7661  ...otherZ.add_va
+00002e30: 6c75 6573 5a08 7a65 726f 5f74 706c 7228  luesZ.zero_tplr(
+00002e40: 0000 0072 0d00 0000 720e 0000 0072 0a00  ...r....r....r..
+00002e50: 0000 720a 0000 0072 0f00 0000 da07 5f5f  ..r....r......__
+00002e60: 6164 645f 5f15 0100 0073 1800 0000 0801  add__....s......
+00002e70: 0401 1201 0e01 0e02 1401 0801 2402 1001  ............$...
+00002e80: 1601 1001 1201 7a0d 5f70 6f6c 792e 5f5f  ......z._poly.__
+00002e90: 6164 645f 5f63 0200 0000 0000 0000 0000  add__c..........
+00002ea0: 0000 0200 0000 0200 0000 4300 0000 7308  ..........C...s.
+00002eb0: 0000 007c 007c 0117 0053 0072 4600 0000  ...|.|...S.rF...
+00002ec0: 720a 0000 00a9 0272 2100 0000 7277 0000  r......r!...rw..
+00002ed0: 0072 0a00 0000 720a 0000 0072 0f00 0000  .r....r....r....
+00002ee0: da08 5f5f 7261 6464 5f5f 2501 0000 7302  ..__radd__%...s.
+00002ef0: 0000 0008 017a 0e5f 706f 6c79 2e5f 5f72  .....z._poly.__r
+00002f00: 6164 645f 5f63 0100 0000 0000 0000 0000  add__c..........
+00002f10: 0000 0100 0000 0500 0000 4300 0000 7322  ..........C...s"
+00002f20: 0000 007c 006a 0064 0164 0284 007c 00a0  ...|.j.d.d...|..
+00002f30: 01a1 0044 0083 017c 006a 027c 006a 0364  ...D...|.j.|.j.d
+00002f40: 038d 0353 0029 044e 6301 0000 0000 0000  ...S.).Nc.......
+00002f50: 0000 0000 0003 0000 0004 0000 0053 0000  .............S..
+00002f60: 0073 1800 0000 6900 7c00 5d08 5c02 7d01  .s....i.|.].\.}.
+00002f70: 7d02 7c01 7c02 0b00 9302 7102 5300 720a  }.|.|.....q.S.r.
+00002f80: 0000 0072 0a00 0000 720b 0000 0072 0a00  ...r....r....r..
+00002f90: 0000 720a 0000 0072 0f00 0000 7210 0000  ..r....r....r...
+00002fa0: 0029 0100 0072 3000 0000 7a21 5f70 6f6c  .)...r0...z!_pol
+00002fb0: 792e 5f5f 6e65 675f 5f2e 3c6c 6f63 616c  y.__neg__.<local
+00002fc0: 733e 2e3c 6469 6374 636f 6d70 3e72 3700  s>.<dictcomp>r7.
+00002fd0: 0000 a904 7239 0000 0072 1900 0000 7214  ....r9...r....r.
+00002fe0: 0000 0072 2800 0000 7231 0000 0072 0a00  ...r(...r1...r..
+00002ff0: 0000 720a 0000 0072 0f00 0000 da07 5f5f  ..r....r......__
+00003000: 6e65 675f 5f28 0100 0073 0600 0000 1401  neg__(...s......
+00003010: 0801 06ff 7a0d 5f70 6f6c 792e 5f5f 6e65  ....z._poly.__ne
+00003020: 675f 5f63 0200 0000 0000 0000 0000 0000  g__c............
+00003030: 0200 0000 0200 0000 4300 0000 730a 0000  ........C...s...
+00003040: 007c 007c 010b 0017 0053 0072 4600 0000  .|.|.....S.rF...
+00003050: 720a 0000 0072 7900 0000 720a 0000 0072  r....ry...r....r
+00003060: 0a00 0000 720f 0000 00da 075f 5f73 7562  ....r......__sub
+00003070: 5f5f 2c01 0000 f302 0000 000a 017a 0d5f  __,..........z._
+00003080: 706f 6c79 2e5f 5f73 7562 5f5f 6302 0000  poly.__sub__c...
+00003090: 0000 0000 0000 0000 0002 0000 0002 0000  ................
+000030a0: 0043 0000 0073 0a00 0000 7c00 0b00 7c01  .C...s....|...|.
+000030b0: 1700 5300 7246 0000 0072 0a00 0000 7279  ..S.rF...r....ry
+000030c0: 0000 0072 0a00 0000 720a 0000 0072 0f00  ...r....r....r..
+000030d0: 0000 da08 5f5f 7273 7562 5f5f 2f01 0000  ....__rsub__/...
+000030e0: 727e 0000 007a 0e5f 706f 6c79 2e5f 5f72  r~...z._poly.__r
+000030f0: 7375 625f 5f63 0200 0000 0000 0000 0000  sub__c..........
+00003100: 0000 0200 0000 0300 0000 4300 0000 f30a  ..........C.....
+00003110: 0000 007c 00a0 007c 01a1 0153 0072 4600  ...|...|...S.rF.
+00003120: 0000 2901 da07 706f 6973 736f 6e72 7900  ..)...poissonry.
+00003130: 0000 720a 0000 0072 0a00 0000 720f 0000  ..r....r....r...
+00003140: 00da 0a5f 5f6d 6174 6d75 6c5f 5f32 0100  ...__matmul__2..
+00003150: 0072 7e00 0000 7a10 5f70 6f6c 792e 5f5f  .r~...z._poly.__
+00003160: 6d61 746d 756c 5f5f 6302 0000 0000 0000  matmul__c.......
+00003170: 0000 0000 000c 0000 0008 0000 0003 0000  ................
+00003180: 0073 9001 0000 7400 7c00 7401 7c01 8301  .s....t.|.t.|...
+00003190: 8302 7316 7402 6401 7c00 6a03 6a04 9b00  ..s.t.d.|.j.j...
+000031a0: 6402 7c01 6a03 6a04 9b00 6403 9d05 8301  d.|.j.j...d.....
+000031b0: 8201 7c00 6a05 7c01 6a05 6b02 7328 4a00  ..|.j.|.j.k.s(J.
+000031c0: 6404 7c00 6a05 9b00 6405 7c01 6a05 9b00  d.|.j...d.|.j...
+000031d0: 9d04 8301 8201 7406 7c00 6a07 7c01 6a07  ......t.|.j.|.j.
+000031e0: 6702 8301 7d02 6900 7d03 7c00 a008 a100  g...}.i.}.|.....
+000031f0: 4400 5d88 5c02 7d04 7d05 7409 7c04 8301  D.].\.}.}.t.|...
+00003200: 7d06 7c01 a008 a100 4400 5d7b 5c02 7d07  }.|.....D.]{\.}.
+00003210: 7d08 7409 7c07 8301 7d09 7c06 7c09 1700  }.t.|...}.|.|...
+00003220: 6406 1800 7c02 6b04 7253 7142 7c04 6407  d...|.k.rSqB|.d.
+00003230: 7c00 6a05 8502 1900 7c04 7c00 6a05 6407  |.j.....|.|.j.d.
+00003240: 8502 1900 0202 8900 8901 7c07 6407 7c00  ..........|.d.|.
+00003250: 6a05 8502 1900 7c07 7c00 6a05 6407 8502  j.....|.|.j.d...
+00003260: 1900 0202 8902 8903 740a 7c00 6a05 8301  ........t.|.j...
+00003270: 4400 5d46 8904 8800 8804 1900 8803 8804  D.]F............
+00003280: 1900 1400 8801 8804 1900 8802 8804 1900  ................
+00003290: 1400 1800 7d0a 7c0a 6408 6b02 728d 7176  ....}.|.d.k.r.qv
+000032a0: 740b 8700 8702 8704 6603 6409 640a 8408  t.......f.d.d...
+000032b0: 740a 7c00 6a05 8301 4400 8301 8701 8703  t.|.j...D.......
+000032c0: 8704 6603 640b 640a 8408 740a 7c00 6a05  ..f.d.d...t.|.j.
+000032d0: 8301 4400 8301 1700 8301 7d0b 7c05 7c08  ..D.......}.|.|.
+000032e0: 1400 7c0a 1400 7c00 6a0c 1400 7c03 a00d  ..|...|.j...|...
+000032f0: 7c0b 6408 a102 1700 7c03 7c0b 3c00 7176  |.d.....|.|.<.qv
+00003300: 7142 7136 7c00 6a03 7c03 7c00 6a05 7c02  qBq6|.j.|.|.j.|.
+00003310: 640c 8d03 5300 290d 7a3b 0a20 2020 2020  d...S.).z;.     
+00003320: 2020 2043 6f6d 7075 7465 2074 6865 2050     Compute the P
+00003330: 6f69 7373 6f6e 2d62 7261 636b 6574 207b  oisson-bracket {
+00003340: 7365 6c66 2c20 6f74 6865 727d 0a20 2020  self, other}.   
+00003350: 2020 2020 207a 2a75 6e73 7570 706f 7274       z*unsupport
+00003360: 6564 206f 7065 7261 6e64 2074 7970 6528  ed operand type(
+00003370: 7329 2066 6f72 2070 6f69 7373 6f6e 3a20  s) for poisson: 
+00003380: 277a 0727 2061 6e64 2027 fa02 272e 7275  'z.' and '..'.ru
+00003390: 0000 0072 7600 0000 7215 0000 004e 7201  ...rv...r....Nr.
+000033a0: 0000 0063 0100 0000 0000 0000 0000 0000  ...c............
+000033b0: 0200 0000 0500 0000 1300 0000 f338 0000  .............8..
+000033c0: 0067 007c 005d 187d 017c 0188 026b 0372  .g.|.].}.|...k.r
+000033d0: 1088 007c 0119 0088 017c 0119 0017 006e  ...|.....|.....n
+000033e0: 0988 007c 0119 0088 017c 0119 0017 0064  ...|.....|.....d
+000033f0: 0018 0091 0271 0253 00a9 0172 2900 0000  .....q.S...r)...
+00003400: 720a 0000 00a9 0272 0c00 0000 726a 0000  r......r....rj..
+00003410: 0029 0372 1200 0000 da01 6372 0d00 0000  .).r......cr....
+00003420: 720a 0000 0072 0f00 0000 722f 0000 004a  r....r....r/...J
+00003430: 0100 00f3 0200 0000 3800 7a21 5f70 6f6c  ........8.z!_pol
+00003440: 792e 706f 6973 736f 6e2e 3c6c 6f63 616c  y.poisson.<local
+00003450: 733e 2e3c 6c69 7374 636f 6d70 3e63 0100  s>.<listcomp>c..
+00003460: 0000 0000 0000 0000 0000 0200 0000 0500  ................
+00003470: 0000 1300 0000 7284 0000 0072 8500 0000  ......r....r....
+00003480: 720a 0000 0072 8600 0000 2903 7213 0000  r....r....).r...
+00003490: 00da 0164 720d 0000 0072 0a00 0000 720f  ...dr....r....r.
+000034a0: 0000 0072 2f00 0000 4b01 0000 7288 0000  ...r/...K...r...
+000034b0: 0072 3700 0000 290e 726e 0000 0072 6f00  .r7...).rn...ro.
+000034c0: 0000 da09 5479 7065 4572 726f 7272 3900  ....TypeErrorr9.
+000034d0: 0000 da08 5f5f 6e61 6d65 5f5f 7214 0000  ....__name__r...
+000034e0: 0072 3400 0000 7228 0000 0072 1900 0000  .r4...r(...r....
+000034f0: 7226 0000 0072 7000 0000 722b 0000 0072  r&...rp...r+...r
+00003500: 1700 0000 7216 0000 0029 0c72 2100 0000  ....r....).r!...
+00003510: 7277 0000 0072 2800 0000 5a0e 706f 6973  rw...r(...Z.pois
+00003520: 736f 6e5f 7661 6c75 6573 da02 7431 da02  son_values..t1..
+00003530: 7631 da06 706f 7765 7231 da02 7432 da02  v1..power1..t2..
+00003540: 7632 da06 706f 7765 7232 da03 6465 745a  v2..power2..detZ
+00003550: 096e 6577 5f70 6f77 6572 720a 0000 0029  .new_powerr....)
+00003560: 0572 1200 0000 7213 0000 0072 8700 0000  .r....r....r....
+00003570: 7289 0000 0072 0d00 0000 720f 0000 0072  r....r....r....r
+00003580: 8100 0000 3501 0000 7330 0000 000e 041e  ....5...s0......
+00003590: 0124 0110 0104 0110 0108 0110 0108 0110  .$..............
+000035a0: 0102 011e 011e 010e 0120 0108 0102 011c  ......... ......
+000035b0: 011a 0106 ff24 0202 fa02 fa12 0d7a 0d5f  .....$.......z._
+000035c0: 706f 6c79 2e70 6f69 7373 6f6e 6302 0000  poly.poissonc...
+000035d0: 0000 0000 0000 0000 000a 0000 0006 0000  ................
+000035e0: 0003 0000 0073 ea00 0000 7400 7c00 7401  .....s....t.|.t.
+000035f0: 8800 8301 8302 7262 7c00 6a02 8800 6a02  ......rb|.j...j.
+00003600: 6b02 730f 4a00 8201 6401 7c00 6a02 1400  k.s.J...d.|.j...
+00003610: 7d02 7403 7c00 6a04 8800 6a04 6702 8301  }.t.|.j...j.g...
+00003620: 7d03 6900 7d04 7c00 a005 a100 4400 5d36  }.i.}.|.....D.]6
+00003630: 5c02 8901 7d05 7406 8801 8301 7d06 8800  \...}.t.....}...
+00003640: a005 a100 4400 5d29 5c02 8902 7d07 7406  ....D.])\...}.t.
+00003650: 8802 8301 7d08 7c06 7c08 1700 7c03 6b04  ....}.|.|...|.k.
+00003660: 723d 712e 7407 8701 8702 6602 6402 6403  r=q.t.....f.d.d.
+00003670: 8408 7408 7c02 8301 4400 8301 8301 7d09  ..t.|...D.....}.
+00003680: 7c04 a009 7c09 6404 a102 7c05 7c07 1400  |...|.d...|.|...
+00003690: 1700 7c04 7c09 3c00 712e 7122 7c00 6a0a  ..|.|.<.q.q"|.j.
+000036a0: 7c04 7c00 6a02 7c03 6405 8d03 5300 7c00  |.|.j.|.d...S.|.
+000036b0: 6a0a 8700 6601 6406 6407 8408 7c00 a005  j...f.d.d...|...
+000036c0: a100 4400 8301 7c00 6a02 7c00 6a04 6405  ..D...|.j.|.j.d.
+000036d0: 8d03 5300 2908 4e72 1500 0000 6301 0000  ..S.).Nr....c...
+000036e0: 0000 0000 0000 0000 0002 0000 0005 0000  ................
+000036f0: 0013 0000 0073 1c00 0000 6700 7c00 5d0a  .....s....g.|.].
+00003700: 7d01 8800 7c01 1900 8801 7c01 1900 1700  }...|.....|.....
+00003710: 9102 7102 5300 720a 0000 0072 0a00 0000  ..q.S.r....r....
+00003720: 7268 0000 0029 0272 8c00 0000 728f 0000  rh...).r....r...
+00003730: 0072 0a00 0000 720f 0000 0072 2f00 0000  .r....r....r/...
+00003740: 5b01 0000 f302 0000 001c 007a 215f 706f  [..........z!_po
+00003750: 6c79 2e5f 5f6d 756c 5f5f 2e3c 6c6f 6361  ly.__mul__.<loca
+00003760: 6c73 3e2e 3c6c 6973 7463 6f6d 703e 7201  ls>.<listcomp>r.
+00003770: 0000 0072 3700 0000 6301 0000 0000 0000  ...r7...c.......
+00003780: 0000 0000 0003 0000 0005 0000 0013 0000  ................
+00003790: 0073 1a00 0000 6900 7c00 5d09 5c02 7d01  .s....i.|.].\.}.
+000037a0: 7d02 7c01 7c02 8800 1400 9302 7102 5300  }.|.|.......q.S.
+000037b0: 720a 0000 0072 0a00 0000 720b 0000 00a9  r....r....r.....
+000037c0: 0172 7700 0000 720a 0000 0072 0f00 0000  .rw...r....r....
+000037d0: 7210 0000 005f 0100 00f3 0200 0000 1a00  r...._..........
+000037e0: 7a21 5f70 6f6c 792e 5f5f 6d75 6c5f 5f2e  z!_poly.__mul__.
+000037f0: 3c6c 6f63 616c 733e 2e3c 6469 6374 636f  <locals>.<dictco
+00003800: 6d70 3e29 0b72 6e00 0000 726f 0000 0072  mp>).rn...ro...r
+00003810: 1400 0000 7234 0000 0072 2800 0000 7219  ....r4...r(...r.
+00003820: 0000 0072 2600 0000 722b 0000 0072 7000  ...r&...r+...rp.
+00003830: 0000 7216 0000 0072 3900 0000 290a 7221  ..r....r9...).r!
+00003840: 0000 0072 7700 0000 7265 0000 0072 2800  ...rw...re...r(.
+00003850: 0000 5a0b 6d75 6c74 5f76 616c 7565 7372  ..Z.mult_valuesr
+00003860: 8d00 0000 728e 0000 0072 9000 0000 7291  ....r....r....r.
+00003870: 0000 005a 0870 726f 645f 7470 6c72 0a00  ...Z.prod_tplr..
+00003880: 0000 2903 7277 0000 0072 8c00 0000 728f  ..).rw...r....r.
+00003890: 0000 0072 0f00 0000 da07 5f5f 6d75 6c5f  ...r......__mul_
+000038a0: 5f4f 0100 0073 2000 0000 0e01 1001 0a01  _O...s .........
+000038b0: 1001 0401 1001 0801 1001 0801 0c01 0201  ................
+000038c0: 1c01 1a01 02fb 1206 2602 7a0d 5f70 6f6c  ........&.z._pol
+000038d0: 792e 5f5f 6d75 6c5f 5f63 0200 0000 0000  y.__mul__c......
+000038e0: 0000 0000 0000 0200 0000 0300 0000 4300  ..............C.
+000038f0: 0000 7280 0000 0072 4600 0000 2901 7296  ..r....rF...).r.
+00003900: 0000 0072 7900 0000 720a 0000 0072 0a00  ...ry...r....r..
+00003910: 0000 720f 0000 00da 085f 5f72 6d75 6c5f  ..r......__rmul_
+00003920: 5f61 0100 0072 7e00 0000 7a0e 5f70 6f6c  _a...r~...z._pol
+00003930: 792e 5f5f 726d 756c 5f5f 6302 0000 0000  y.__rmul__c.....
+00003940: 0000 0000 0000 0002 0000 0005 0000 0003  ................
+00003950: 0000 0073 3c00 0000 7400 7c00 7401 8800  ...s<...t.|.t...
+00003960: 8301 8302 731a 7c00 6a02 8700 6601 6401  ....s.|.j...f.d.
+00003970: 6402 8408 7c00 a003 a100 4400 8301 7c00  d...|.....D...|.
+00003980: 6a04 7c00 6a05 6403 8d03 5300 7406 6404  j.|.j.d...S.t.d.
+00003990: 8301 8201 2905 4e63 0100 0000 0000 0000  ....).Nc........
+000039a0: 0000 0000 0300 0000 0500 0000 1300 0000  ................
+000039b0: 731a 0000 0069 007c 005d 095c 027d 017d  s....i.|.].\.}.}
+000039c0: 027c 017c 0288 001b 0093 0271 0253 0072  .|.|.......q.S.r
+000039d0: 0a00 0000 720a 0000 0072 0b00 0000 7294  ....r....r....r.
+000039e0: 0000 0072 0a00 0000 720f 0000 0072 1000  ...r....r....r..
+000039f0: 0000 6801 0000 7295 0000 007a 255f 706f  ..h...r....z%_po
+00003a00: 6c79 2e5f 5f74 7275 6564 6976 5f5f 2e3c  ly.__truediv__.<
+00003a10: 6c6f 6361 6c73 3e2e 3c64 6963 7463 6f6d  locals>.<dictcom
+00003a20: 703e 7237 0000 007a 2944 6976 6973 696f  p>r7...z)Divisio
+00003a30: 6e20 6279 204c 6965 2070 6f6c 796e 6f6d  n by Lie polynom
+00003a40: 6961 6c20 6e6f 7420 7375 7070 6f72 7465  ial not supporte
+00003a50: 642e 2907 726e 0000 0072 6f00 0000 7239  d.).rn...ro...r9
+00003a60: 0000 0072 1900 0000 7214 0000 0072 2800  ...r....r....r(.
+00003a70: 0000 da13 4e6f 7449 6d70 6c65 6d65 6e74  ....NotImplement
+00003a80: 6564 4572 726f 7272 7900 0000 720a 0000  edErrorry...r...
+00003a90: 0072 9400 0000 720f 0000 00da 0b5f 5f74  .r....r......__t
+00003aa0: 7275 6564 6976 5f5f 6401 0000 7306 0000  ruediv__d...s...
+00003ab0: 000e 0226 0208 027a 115f 706f 6c79 2e5f  ...&...z._poly._
+00003ac0: 5f74 7275 6564 6976 5f5f 6302 0000 0000  _truediv__c.....
+00003ad0: 0000 0000 0000 0004 0000 0005 0000 0043  ...............C
+00003ae0: 0000 0073 8200 0000 7400 7c01 8301 7401  ...s....t.|...t.
+00003af0: 6b02 7308 4a00 8201 7c01 6401 6b05 730e  k.s.J...|.d.k.s.
+00003b00: 4a00 8201 7c01 6401 6b02 7223 7c00 6a02  J...|.d.k.r#|.j.
+00003b10: 6402 7c00 6a03 1400 6403 1400 6404 6901  d.|.j...d...d.i.
+00003b20: 7c00 6a03 7c00 6a04 6405 8d03 5300 7c01  |.j.|.j.d...S.|.
+00003b30: 6404 6b02 7229 7c00 5300 7c01 6403 1600  d.k.r)|.S.|.d...
+00003b40: 7d02 7c00 7c01 6403 1a00 1300 7d03 7c02  }.|.|.d.....}.|.
+00003b50: 6404 6b02 723d 7c00 7c03 1400 7c03 1400  d.k.r=|.|...|...
+00003b60: 5300 7c03 7c03 1400 5300 2906 4e72 0100  S.|.|...S.).Nr..
+00003b70: 0000 7274 0000 0072 1500 0000 7229 0000  ..rt...r....r)..
+00003b80: 0072 3700 0000 2905 726f 0000 0072 6700  .r7...).ro...rg.
+00003b90: 0000 7239 0000 0072 1400 0000 7228 0000  ..r9...r....r(..
+00003ba0: 0029 0472 2100 0000 7277 0000 00da 0972  .).r!...rw.....r
+00003bb0: 656d 6169 6e64 6572 da04 6861 6c66 720a  emainder..halfr.
+00003bc0: 0000 0072 0a00 0000 720f 0000 00da 075f  ...r....r......_
+00003bd0: 5f70 6f77 5f5f 6c01 0000 731a 0000 0010  _pow__l...s.....
+00003be0: 010c 0108 0114 0108 0106 ff08 0204 0108  ................
+00003bf0: 020c 0108 010c 0108 027a 0d5f 706f 6c79  .........z._poly
+00003c00: 2e5f 5f70 6f77 5f5f 6301 0000 0000 0000  .__pow__c.......
+00003c10: 0000 0000 0001 0000 0005 0000 0003 0000  ................
+00003c20: 0073 2600 0000 8800 6a00 8700 6601 6401  .s&.....j...f.d.
+00003c30: 6402 8408 8800 a001 a100 4400 8301 8800  d.........D.....
+00003c40: 6a02 8800 6a03 6403 8d03 5300 2904 4e63  j...j.d...S.).Nc
+00003c50: 0100 0000 0000 0000 0000 0000 0300 0000  ................
+00003c60: 0600 0000 1300 0000 7332 0000 0069 007c  ........s2...i.|
+00003c70: 005d 155c 027d 017d 027c 0188 006a 0064  .].\.}.}.|...j.d
+00003c80: 0085 0219 007c 0164 0088 006a 0085 0219  .....|.d...j....
+00003c90: 0017 007c 02a0 01a1 0093 0271 0253 0072  ...|.......q.S.r
+00003ca0: 4600 0000 2902 7214 0000 0072 6200 0000  F...).r....rb...
+00003cb0: 720b 0000 0072 3100 0000 720a 0000 0072  r....r1...r....r
+00003cc0: 0f00 0000 7210 0000 007d 0100 0073 0200  ....r....}...s..
+00003cd0: 0000 3200 7a23 5f70 6f6c 792e 636f 6e6a  ..2.z#_poly.conj
+00003ce0: 7567 6174 652e 3c6c 6f63 616c 733e 2e3c  ugate.<locals>.<
+00003cf0: 6469 6374 636f 6d70 3e72 3700 0000 727b  dictcomp>r7...r{
+00003d00: 0000 0072 3100 0000 720a 0000 0072 3100  ...r1...r....r1.
+00003d10: 0000 720f 0000 0072 6200 0000 7c01 0000  ..r....rb...|...
+00003d20: 7306 0000 0018 0108 0106 ff7a 0f5f 706f  s..........z._po
+00003d30: 6c79 2e63 6f6e 6a75 6761 7465 6301 0000  ly.conjugatec...
+00003d40: 0000 0000 0000 0000 0001 0000 0002 0000  ................
+00003d50: 0043 0000 0073 0a00 0000 7400 7c00 6a01  .C...s....t.|.j.
+00003d60: 8301 5300 7246 0000 0029 0272 1c00 0000  ..S.rF...).r....
+00003d70: 721a 0000 0072 3100 0000 720a 0000 0072  r....r1...r....r
+00003d80: 0a00 0000 720f 0000 00da 075f 5f6c 656e  ....r......__len
+00003d90: 5f5f 8001 0000 727e 0000 007a 0d5f 706f  __....r~...z._po
+00003da0: 6c79 2e5f 5f6c 656e 5f5f 6302 0000 0000  ly.__len__c.....
+00003db0: 0000 0000 0000 0002 0000 0005 0000 0043  ...............C
+00003dc0: 0000 0073 4a00 0000 7400 7c00 7401 7c01  ...sJ...t.|.t.|.
+00003dd0: 8301 8302 720d 7c00 6a02 7c01 6a02 6b02  ....r.|.j.|.j.k.
+00003de0: 5300 7c00 a003 a100 6401 6b03 7215 6402  S.|.....d.k.r.d.
+00003df0: 5300 7c00 a004 7405 6401 6701 6403 1400  S.|...t.d.g.d...
+00003e00: 7c00 6a06 1400 8301 6401 a102 7c01 6b02  |.j.....d...|.k.
+00003e10: 5300 2904 4e72 0100 0000 4672 1500 0000  S.).Nr....Fr....
+00003e20: 2907 726e 0000 0072 6f00 0000 721a 0000  ).rn...ro...r...
+00003e30: 0072 3200 0000 7216 0000 0072 2b00 0000  .r2...r....r+...
+00003e40: 7214 0000 0072 7900 0000 720a 0000 0072  r....ry...r....r
+00003e50: 0a00 0000 720f 0000 00da 065f 5f65 715f  ....r......__eq_
+00003e60: 5f83 0100 0073 0a00 0000 0e01 0c01 0c02  _....s..........
+00003e70: 0401 2002 7a0c 5f70 6f6c 792e 5f5f 6571  .. .z._poly.__eq
+00003e80: 5f5f 6301 0000 0000 0000 0000 0000 0001  __c.............
+00003e90: 0000 0002 0000 0043 0000 00f3 0a00 0000  .......C........
+00003ea0: 7c00 6a00 a001 a100 5300 7246 0000 00a9  |.j.....S.rF....
+00003eb0: 0272 1a00 0000 7218 0000 0072 3100 0000  .r....r....r1...
+00003ec0: 720a 0000 0072 0a00 0000 720f 0000 0072  r....r....r....r
+00003ed0: 1800 0000 8c01 0000 727e 0000 007a 0a5f  ........r~...z._
+00003ee0: 706f 6c79 2e6b 6579 7363 0100 0000 0000  poly.keysc......
+00003ef0: 0000 0000 0000 0300 0000 0400 0000 4f00  ..............O.
+00003f00: 0000 7312 0000 007c 006a 006a 017c 0169  ..s....|.j.j.|.i
+00003f10: 007c 02a4 018e 0153 0072 4600 0000 2902  .|.....S.rF...).
+00003f20: 721a 0000 0072 1600 0000 2903 7221 0000  r....r....).r!..
+00003f30: 00da 0461 7267 7372 2200 0000 720a 0000  ...argsr"...r...
+00003f40: 0072 0a00 0000 720f 0000 0072 1600 0000  .r....r....r....
+00003f50: 8f01 0000 7302 0000 0012 017a 095f 706f  ....s......z._po
+00003f60: 6c79 2e67 6574 6301 0000 0000 0000 0000  ly.getc.........
+00003f70: 0000 0001 0000 0002 0000 0043 0000 0072  ...........C...r
+00003f80: 9f00 0000 7246 0000 0029 0272 1a00 0000  ....rF...).r....
+00003f90: 7219 0000 0072 3100 0000 720a 0000 0072  r....r1...r....r
+00003fa0: 0a00 0000 720f 0000 0072 1900 0000 9201  ....r....r......
+00003fb0: 0000 727e 0000 007a 0b5f 706f 6c79 2e69  ..r~...z._poly.i
+00003fc0: 7465 6d73 6301 0000 0000 0000 0000 0000  temsc...........
+00003fd0: 0001 0000 0002 0000 0043 0000 0072 9f00  .........C...r..
+00003fe0: 0000 7246 0000 0029 0272 1a00 0000 7209  ..rF...).r....r.
+00003ff0: 0000 0072 3100 0000 720a 0000 0072 0a00  ...r1...r....r..
+00004000: 0000 720f 0000 0072 0900 0000 9501 0000  ..r....r........
+00004010: 727e 0000 007a 0c5f 706f 6c79 2e76 616c  r~...z._poly.val
+00004020: 7565 7363 0100 0000 0000 0000 0000 0000  uesc............
+00004030: 0200 0000 0300 0000 6300 0000 7322 0000  ........c...s"..
+00004040: 0081 007c 006a 00a0 01a1 0044 005d 087d  ...|.j.....D.].}
+00004050: 017c 006a 007c 0119 0056 0001 0071 0664  .|.j.|...V...q.d
+00004060: 0053 0072 4600 0000 72a0 0000 00a9 0272  .S.rF...r......r
+00004070: 2100 0000 7242 0000 0072 0a00 0000 720a  !...rB...r....r.
+00004080: 0000 0072 0f00 0000 7250 0000 0098 0100  ...r....rP......
+00004090: 0073 0800 0000 0280 0e01 0e01 04ff 7a0e  .s............z.
+000040a0: 5f70 6f6c 792e 5f5f 6974 6572 5f5f 6302  _poly.__iter__c.
+000040b0: 0000 0000 0000 0000 0000 0002 0000 0002  ................
+000040c0: 0000 0043 0000 0073 0a00 0000 7c00 6a00  ...C...s....|.j.
+000040d0: 7c01 1900 5300 7246 0000 00a9 0172 1a00  |...S.rF.....r..
+000040e0: 0000 72a2 0000 0072 0a00 0000 720a 0000  ..r....r....r...
+000040f0: 0072 0f00 0000 da0b 5f5f 6765 7469 7465  .r......__getite
+00004100: 6d5f 5f9c 0100 0072 7e00 0000 7a11 5f70  m__....r~...z._p
+00004110: 6f6c 792e 5f5f 6765 7469 7465 6d5f 5f63  oly.__getitem__c
+00004120: 0300 0000 0000 0000 0000 0000 0300 0000  ................
+00004130: 0300 0000 4300 0000 730e 0000 007c 027c  ....C...s....|.|
+00004140: 006a 007c 013c 0064 0053 0072 4600 0000  .j.|.<.d.S.rF...
+00004150: 72a3 0000 0029 0372 2100 0000 7242 0000  r....).r!...rB..
+00004160: 0072 7700 0000 720a 0000 0072 0a00 0000  .rw...r....r....
+00004170: 720f 0000 00da 0b5f 5f73 6574 6974 656d  r......__setitem
+00004180: 5f5f 9f01 0000 7302 0000 000e 017a 115f  __....s......z._
+00004190: 706f 6c79 2e5f 5f73 6574 6974 656d 5f5f  poly.__setitem__
+000041a0: 6301 0000 0000 0000 0000 0000 0004 0000  c...............
+000041b0: 0005 0000 004f 0000 0073 3800 0000 6401  .....O...s8...d.
+000041c0: 6402 8400 7c00 6a00 a001 a100 4400 8301  d...|.j.....D...
+000041d0: 7d03 7c03 6a02 7c01 6900 7c02 a401 8e01  }.|.j.|.i.|.....
+000041e0: 0100 7c00 6a03 7c03 7c00 6a04 7c00 6a05  ..|.j.|.|.j.|.j.
+000041f0: 6403 8d03 5300 2904 4e63 0100 0000 0000  d...S.).Nc......
+00004200: 0000 0000 0000 0300 0000 0400 0000 5300  ..............S.
+00004210: 0000 7273 0000 0072 0a00 0000 720a 0000  ..rs...r....r...
+00004220: 0072 0b00 0000 720a 0000 0072 0a00 0000  .r....r....r....
+00004230: 720f 0000 0072 1000 0000 a301 0000 7243  r....r........rC
+00004240: 0000 007a 1d5f 706f 6c79 2e70 6f70 2e3c  ...z._poly.pop.<
+00004250: 6c6f 6361 6c73 3e2e 3c64 6963 7463 6f6d  locals>.<dictcom
+00004260: 703e 7237 0000 0029 0672 1a00 0000 7219  p>r7...).r....r.
+00004270: 0000 00da 0370 6f70 7239 0000 0072 1400  .....popr9...r..
+00004280: 0000 7228 0000 0029 0472 2100 0000 72a1  ..r(...).r!...r.
+00004290: 0000 0072 2200 0000 723a 0000 0072 0a00  ...r"...r:...r..
+000042a0: 0000 720a 0000 0072 0f00 0000 72a6 0000  ..r....r....r...
+000042b0: 00a2 0100 0073 0600 0000 1401 1001 1401  .....s..........
+000042c0: 7a09 5f70 6f6c 792e 706f 7063 0200 0000  z._poly.popc....
+000042d0: 0000 0000 0000 0000 0300 0000 0500 0000  ................
+000042e0: 4300 0000 7330 0000 0064 0164 0284 007c  C...s0...d.d...|
+000042f0: 00a0 00a1 0044 0083 017d 027c 02a0 017c  .....D...}.|...|
+00004300: 01a1 0101 007c 006a 027c 027c 006a 037c  .....|.j.|.|.j.|
+00004310: 006a 0464 038d 0353 0029 044e 6301 0000  .j.d...S.).Nc...
+00004320: 0000 0000 0000 0000 0003 0000 0004 0000  ................
+00004330: 0053 0000 0072 7300 0000 720a 0000 0072  .S...rs...r....r
+00004340: 0a00 0000 720b 0000 0072 0a00 0000 720a  ....r....r....r.
+00004350: 0000 0072 0f00 0000 7210 0000 00a8 0100  ...r....r.......
+00004360: 0072 4300 0000 7a20 5f70 6f6c 792e 7570  .rC...z _poly.up
+00004370: 6461 7465 2e3c 6c6f 6361 6c73 3e2e 3c64  date.<locals>.<d
+00004380: 6963 7463 6f6d 703e 7237 0000 0029 0572  ictcomp>r7...).r
+00004390: 1900 0000 da06 7570 6461 7465 7239 0000  ......updater9..
+000043a0: 0072 1400 0000 7228 0000 0029 0372 2100  .r....r(...).r!.
+000043b0: 0000 7289 0000 0072 3a00 0000 720a 0000  ..r....r:...r...
+000043c0: 0072 0a00 0000 720f 0000 0072 a700 0000  .r....r....r....
+000043d0: a701 0000 7306 0000 0012 010a 0114 017a  ....s..........z
+000043e0: 0c5f 706f 6c79 2e75 7064 6174 65da 0570  ._poly.update..p
+000043f0: 6f77 6572 6303 0000 0000 0000 0000 0000  owerc...........
+00004400: 0009 0000 0006 0000 0043 0000 0073 e000  .........C...s..
+00004410: 0000 7400 7c00 7401 7c01 8301 8302 7316  ..t.|.t.|.....s.
+00004420: 7402 6401 7c00 6a03 6a04 9b00 6402 7c01  t.d.|.j.j...d.|.
+00004430: 6a03 6a04 9b00 6403 9d05 8301 8201 7c02  j.j...d.......|.
+00004440: 6404 6b05 731c 4a00 8201 7405 7c00 6a06  d.k.s.J...t.|.j.
+00004450: 7c01 6a06 6702 8301 7d03 7c00 a007 a100  |.j.g...}.|.....
+00004460: 7d04 7c04 6405 6b04 7242 7c03 7408 6406  }.|.d.k.rB|.t.d.
+00004470: 8301 6b00 7242 7c01 a007 a100 7d05 7405  ..k.rB|.....}.t.
+00004480: 7c03 7c05 1800 7c04 6405 1800 1a00 7c02  |.|...|.d.....|.
+00004490: 6702 8301 7d02 7c00 6a03 6407 6408 8400  g...}.|.j.d.d...
+000044a0: 7c01 a009 a100 4400 8301 7c01 6a0a 7c03  |.....D...|.j.|.
+000044b0: 6409 8d03 7d06 7c06 6701 7d07 740b 7c02  d...}.|.g.}.t.|.
+000044c0: 8301 4400 5d14 7d08 7c00 7c06 1000 7d06  ..D.].}.|.|...}.
+000044d0: 740c 7c06 8301 6404 6b02 7268 0100 7c07  t.|...d.k.rh..|.
+000044e0: 5300 7c07 a00d 7c06 a101 0100 7159 7c07  S.|...|.....qY|.
+000044f0: 5300 290a 61b9 0300 000a 2020 2020 2020  S.).a.....      
+00004500: 2020 436f 6d70 7574 6520 7265 7065 6174    Compute repeat
+00004510: 6564 2050 6f69 7373 6f6e 2d62 7261 636b  ed Poisson-brack
+00004520: 6574 732e 0a20 2020 2020 2020 2045 2e67  ets..        E.g
+00004530: 2e20 6c65 7420 7820 3d20 7365 6c66 2e20  . let x = self. 
+00004540: 5468 656e 207b 782c 207b 782c 207b 782c  Then {x, {x, {x,
+00004550: 207b 782c 207b 782c 207b 782c 2079 7d7d   {x, {x, {x, y}}
+00004560: 7d7d 7d7d 203d 3a20 782a 2a36 2879 290a  }}}} =: x**6(y).
+00004570: 2020 2020 2020 2020 5370 6563 6961 6c20          Special 
+00004580: 6361 7365 3a20 782a 2a30 2879 2920 3a3d  case: x**0(y) :=
+00004590: 2079 0a20 2020 2020 2020 200a 2020 2020   y.        .    
+000045a0: 2020 2020 4c65 7420 7a20 6265 2061 2068      Let z be a h
+000045b0: 6f6d 6f67 656e 656f 7573 204c 6965 2070  omogeneous Lie p
+000045c0: 6f6c 796e 6f6d 6961 6c20 616e 6420 6465  olynomial and de
+000045d0: 6728 7a29 2074 6865 2064 6567 7265 6520  g(z) the degree 
+000045e0: 6f66 207a 2e20 5468 656e 2069 7420 686f  of z. Then it ho
+000045f0: 6c64 730a 2020 2020 2020 2020 6465 6728  lds.        deg(
+00004600: 782a 2a6d 2879 2929 203d 2064 6567 2879  x**m(y)) = deg(y
+00004610: 2920 2b20 6d2a 2864 6567 2878 2920 2d20  ) + m*(deg(x) - 
+00004620: 3229 2e0a 2020 2020 2020 2020 5468 6973  2)..        This
+00004630: 2061 6c73 6f20 686f 6c64 7320 666f 7220   also holds for 
+00004640: 7468 6520 6d61 7869 6d61 6c20 6465 6772  the maximal degr
+00004650: 6565 7320 616e 6420 6d69 6e69 6d61 6c20  ees and minimal 
+00004660: 6465 6772 6565 7320 696e 2063 6173 6520  degrees in case 
+00004670: 7468 6174 2078 2c20 616e 6420 790a 2020  that x, and y.  
+00004680: 2020 2020 2020 6172 6520 696e 686f 6d6f        are inhomo
+00004690: 6765 6e65 6f75 732e 0a20 2020 2020 2020  geneous..       
+000046a0: 200a 2020 2020 2020 2020 5468 6572 6566   .        Theref
+000046b0: 6f72 652c 2069 6620 7820 616e 6420 7920  ore, if x and y 
+000046c0: 626f 7468 2068 6176 6520 6e6f 6e2d 7a65  both have non-ze
+000046d0: 726f 206d 6178 5f70 6f77 6572 2066 6965  ro max_power fie
+000046e0: 6c64 732c 2027 7365 6c66 2e70 6f77 6572  lds, 'self.power
+000046f0: 2720 7769 6c6c 206e 6f74 2065 7661 6c75  ' will not evalu
+00004700: 6174 650a 2020 2020 2020 2020 7465 726d  ate.        term
+00004710: 7320 782a 2a6d 2077 6974 680a 2020 2020  s x**m with.    
+00004720: 2020 2020 6d20 3e3d 206d 696e 285b 286d      m >= min([(m
+00004730: 6178 5f70 6f77 6572 202d 206d 696e 6465  ax_power - minde
+00004740: 6728 7929 292f 2f28 6d69 6e64 6567 2878  g(y))//(mindeg(x
+00004750: 2920 2d20 3229 2c20 706f 7765 725d 292e  ) - 2), power]).
+00004760: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00004770: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00004780: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00004790: 2020 2020 2020 2020 793a 2070 6f6c 790a          y: poly.
+000047a0: 2020 2020 2020 2020 2020 2020 4c69 6520              Lie 
+000047b0: 706f 6c79 6e6f 6d69 616c 2077 6869 6368  polynomial which
+000047c0: 2077 6520 7761 6e74 2074 6f20 6576 616c   we want to eval
+000047d0: 7561 7465 206f 6e0a 0a20 2020 2020 2020  uate on..       
+000047e0: 2070 6f77 6572 3a20 696e 742c 206f 7074   power: int, opt
+000047f0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00004800: 2020 4e75 6d62 6572 206f 6620 7265 7065    Number of repe
+00004810: 6174 6564 2062 7261 636b 6574 7320 2864  ated brackets (d
+00004820: 6566 6175 6c74 3a20 3129 2e0a 0a0a 2020  efault: 1)....  
+00004830: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+00004840: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+00004850: 2020 2020 2020 6c69 7374 0a20 2020 2020        list.     
+00004860: 2020 2020 2020 204c 6973 7420 5b78 2a2a         List [x**
+00004870: 6b28 7929 2066 6f72 206b 2069 6e20 7261  k(y) for k in ra
+00004880: 6e67 6528 6e20 2b20 3129 5d2c 2069 6620  nge(n + 1)], if 
+00004890: 6e20 6973 2074 6865 2070 6f77 6572 2072  n is the power r
+000048a0: 6571 7565 7374 6564 2e0a 2020 2020 2020  equested..      
+000048b0: 2020 7a2a 756e 7375 7070 6f72 7465 6420    z*unsupported 
+000048c0: 6f70 6572 616e 6420 7479 7065 2873 2920  operand type(s) 
+000048d0: 666f 7220 6164 6a6f 696e 743a 2027 7a06  for adjoint: 'z.
+000048e0: 2720 6f6e 2027 7283 0000 0072 0100 0000  ' on 'r....r....
+000048f0: 7215 0000 0072 2400 0000 6301 0000 0000  r....r$...c.....
+00004900: 0000 0000 0000 0003 0000 0004 0000 0053  ...............S
+00004910: 0000 0072 7300 0000 720a 0000 0072 0a00  ...rs...r....r..
+00004920: 0000 720b 0000 0072 0a00 0000 720a 0000  ..r....r....r...
+00004930: 0072 0f00 0000 7210 0000 00d4 0100 0072  .r....r........r
+00004940: 4300 0000 7a1c 5f70 6f6c 792e 6164 2e3c  C...z._poly.ad.<
+00004950: 6c6f 6361 6c73 3e2e 3c64 6963 7463 6f6d  locals>.<dictcom
+00004960: 703e 7237 0000 0029 0e72 6e00 0000 726f  p>r7...).rn...ro
+00004970: 0000 0072 8a00 0000 7239 0000 0072 8b00  ...r....r9...r..
+00004980: 0000 7234 0000 0072 2800 0000 7235 0000  ..r4...r(...r5..
+00004990: 00da 0566 6c6f 6174 7219 0000 0072 1400  ...floatr....r..
+000049a0: 0000 7270 0000 0072 1c00 0000 da06 6170  ..rp...r......ap
+000049b0: 7065 6e64 2909 7221 0000 00da 0179 72a8  pend).r!.....yr.
+000049c0: 0000 0072 2800 0000 5a08 6d69 6e64 6567  ...r(...Z.mindeg
+000049d0: 5f78 5a08 6d69 6e64 6567 5f79 7255 0000  _xZ.mindeg_yrU..
+000049e0: 005a 0b61 6c6c 5f72 6573 756c 7473 720d  .Z.all_resultsr.
+000049f0: 0000 0072 0a00 0000 720a 0000 0072 0f00  ...r....r....r..
+00004a00: 0000 da02 6164 ac01 0000 7326 0000 000e  ....ad....s&....
+00004a10: 1d1e 010c 0110 0308 0114 0108 0118 0114  ................
+00004a20: 0206 0106 ff06 020c 0208 010c 0102 0104  ................
+00004a30: 020c ff04 017a 085f 706f 6c79 2e61 6463  .....z._poly.adc
+00004a40: 0100 0000 0000 0000 0000 0000 0100 0000  ................
+00004a50: 0300 0000 4300 0000 730a 0000 007c 00a0  ....C...s....|..
+00004a60: 0074 01a1 0153 0072 4600 0000 2902 da05  .t...S.rF...)...
+00004a70: 6170 706c 7972 5200 0000 7231 0000 0072  applyrR...r1...r
+00004a80: 0a00 0000 720a 0000 0072 0f00 0000 da07  ....r....r......
+00004a90: 5f5f 6162 735f 5fdf 0100 0072 7e00 0000  __abs__....r~...
+00004aa0: 7a0d 5f70 6f6c 792e 5f5f 6162 735f 5f63  z._poly.__abs__c
+00004ab0: 0100 0000 0000 0000 0000 0000 0400 0000  ................
+00004ac0: 0600 0000 4300 0000 734a 0000 0064 017d  ....C...sJ...d.}
+00004ad0: 017c 00a0 00a1 0044 005d 105c 027d 027d  .|.....D.].\.}.}
+00004ae0: 037c 017c 029b 0064 0274 017c 0383 019b  .|.|...d.t.|....
+00004af0: 0064 039d 0437 007d 0171 0674 027c 0183  .d...7.}.q.t.|..
+00004b00: 0164 046b 0472 237c 0164 0064 0585 0219  .d.k.r#|.d.d....
+00004b10: 0053 0064 0653 0029 074e da00 7a02 3a20  .S.d.S.).N..z.: 
+00004b20: fa01 2072 0100 0000 e9ff ffff ffda 0130  .. r...........0
+00004b30: 2903 7219 0000 00da 0373 7472 721c 0000  ).r......strr...
+00004b40: 0029 0472 2100 0000 da03 6f75 7472 0d00  .).r!.....outr..
+00004b50: 0000 720e 0000 0072 0a00 0000 720a 0000  ..r....r....r...
+00004b60: 0072 0f00 0000 da07 5f5f 7374 725f 5fe2  .r......__str__.
+00004b70: 0100 0073 0c00 0000 0401 1001 1a01 0c01  ...s............
+00004b80: 0c01 0402 7a0d 5f70 6f6c 792e 5f5f 7374  ....z._poly.__st
+00004b90: 725f 5f63 0100 0000 0000 0000 0000 0000  r__c............
+00004ba0: 0100 0000 0300 0000 4300 0000 7310 0000  ........C...s...
+00004bb0: 0064 017c 00a0 00a1 009b 0064 029d 0353  .d.|.......d...S
+00004bc0: 0029 034e 7a06 3c73 616d 703e 7a07 3c2f  .).Nz.<samp>z.</
+00004bd0: 7361 6d70 3e29 0172 b500 0000 7231 0000  samp>).r....r1..
+00004be0: 0072 0a00 0000 720a 0000 0072 0f00 0000  .r....r....r....
+00004bf0: da0b 5f72 6570 725f 6874 6d6c 5feb 0100  .._repr_html_...
+00004c00: 0073 0200 0000 1001 7a11 5f70 6f6c 792e  .s......z._poly.
+00004c10: 5f72 6570 725f 6874 6d6c 5f63 0100 0000  _repr_html_c....
+00004c20: 0000 0000 0000 0000 0200 0000 0500 0000  ................
+00004c30: 4b00 0000 7326 0000 007c 01a0 0064 0164  K...s&...|...d.d
+00004c40: 027c 006a 0114 00a1 027c 0164 013c 0074  .|.j.....|.d.<.t
+00004c50: 027c 0066 0169 007c 01a4 018e 0153 0029  .|.f.i.|.....S.)
+00004c60: 0361 6902 0000 0a20 2020 2020 2020 2044  .ai....        D
+00004c70: 6572 6976 6520 7468 6520 6375 7272 656e  erive the curren
+00004c80: 7420 4c69 6520 706f 6c79 6e6f 6d69 616c  t Lie polynomial
+00004c90: 2e0a 2020 2020 2020 2020 0a20 2020 2020  ..        .     
+00004ca0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00004cb0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00004cc0: 0a20 2020 2020 2020 206f 7264 6572 3a20  .        order: 
+00004cd0: 696e 740a 2020 2020 2020 2020 2020 2020  int.            
+00004ce0: 5468 6520 6f72 6465 7220 6279 2077 6869  The order by whi
+00004cf0: 6368 2077 6520 6172 6520 676f 696e 6720  ch we are going 
+00004d00: 746f 2064 6572 6976 6520 7468 6520 706f  to derive the po
+00004d10: 6c79 6e6f 6d69 616c 2e0a 2020 2020 2020  lynomial..      
+00004d20: 2020 2020 2020 0a20 2020 2020 2020 202a        .        *
+00004d30: 2a6b 7761 7267 730a 2020 2020 2020 2020  *kwargs.        
+00004d40: 2020 2020 4f70 7469 6f6e 616c 206b 6579      Optional key
+00004d50: 776f 7264 2061 7267 756d 656e 7473 2070  word arguments p
+00004d60: 6173 7365 6420 746f 206e 6a65 742e 6465  assed to njet.de
+00004d70: 7269 7665 0a20 2020 2020 2020 2020 2020  rive.           
+00004d80: 200a 2020 2020 2020 2020 5265 7475 726e   .        Return
+00004d90: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00004da0: 2d0a 2020 2020 2020 2020 6465 7269 7665  -.        derive
+00004db0: 0a20 2020 2020 2020 2020 2020 2041 2063  .            A c
+00004dc0: 6c61 7373 206f 6620 7479 7065 206e 6a65  lass of type nje
+00004dd0: 742e 6164 2e64 6572 6976 6520 7769 7468  t.ad.derive with
+00004de0: 206e 5f61 7267 733d 322a 7365 6c66 2e64   n_args=2*self.d
+00004df0: 696d 2070 6172 616d 6574 6572 732e 0a20  im parameters.. 
+00004e00: 2020 2020 2020 2020 2020 204e 6f74 6520             Note 
+00004e10: 7468 6174 2061 2066 756e 6374 696f 6e20  that a function 
+00004e20: 6576 616c 7561 7469 6f6e 2073 686f 756c  evaluation shoul
+00004e30: 6420 6265 2063 6f6e 7369 7374 656e 7420  d be consistent 
+00004e40: 7769 7468 2074 6865 2066 6163 7420 7468  with the fact th
+00004e50: 6174 200a 2020 2020 2020 2020 2020 2020  at .            
+00004e60: 7468 6520 6c61 7374 2073 656c 662e 6469  the last self.di
+00004e70: 6d20 656e 7472 6965 7320 6172 6520 7468  m entries are th
+00004e80: 6520 636f 6d70 6c65 7820 636f 6e6a 7567  e complex conjug
+00004e90: 6174 6520 7661 6c75 6573 206f 6620 7468  ate values of th
+00004ea0: 6520 0a20 2020 2020 2020 2020 2020 2066  e .            f
+00004eb0: 6972 7374 2073 656c 662e 6469 6d20 656e  irst self.dim en
+00004ec0: 7472 6965 732e 0a20 2020 2020 2020 20da  tries..        .
+00004ed0: 066e 5f61 7267 7372 1500 0000 2903 7216  .n_argsr....).r.
+00004ee0: 0000 0072 1400 0000 7202 0000 0072 2000  ...r....r....r .
+00004ef0: 0000 720a 0000 0072 0a00 0000 720f 0000  ..r....r....r...
+00004f00: 0072 0200 0000 ee01 0000 7304 0000 0016  .r........s.....
+00004f10: 1410 017a 0c5f 706f 6c79 2e64 6572 6976  ...z._poly.deriv
+00004f20: 6563 0200 0000 0000 0000 0000 0000 0300  ec..............
+00004f30: 0000 0400 0000 4b00 0000 732a 0000 0064  ......K...s*...d
+00004f40: 017c 02a0 00a1 0076 0172 0b7c 006a 017c  .|.....v.r.|.j.|
+00004f50: 0264 013c 0074 027c 0067 017c 0166 0269  .d.<.t.|.g.|.f.i
+00004f60: 007c 02a4 018e 0153 0029 0261 ad03 0000  .|.....S.).a....
+00004f70: 0a20 2020 2020 2020 204c 6574 203a 783a  .        Let :x:
+00004f80: 2072 6570 7265 7365 6e74 2074 6865 2063   represent the c
+00004f90: 7572 7265 6e74 204c 6965 2070 6f6c 796e  urrent Lie polyn
+00004fa0: 6f6d 6961 6c2e 2044 6570 656e 6469 6e67  omial. Depending
+00004fb0: 206f 6e20 7468 6520 696e 7075 742c 0a20   on the input,. 
+00004fc0: 2020 2020 2020 2074 6869 7320 726f 7574         this rout
+00004fd0: 696e 6520 7769 6c6c 2065 6974 6865 7220  ine will either 
+00004fe0: 7265 7475 726e 2074 6865 206d 6170 2066  return the map f
+00004ff0: 2878 2920 6f72 2074 6865 204c 6965 2070  (x) or the Lie p
+00005000: 6f6c 796e 6f6d 6961 6c20 3a66 2878 293a  olynomial :f(x):
+00005010: 2e0a 2020 2020 2020 2020 0a20 2020 2020  ..        .     
+00005020: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00005030: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00005040: 0a20 2020 2020 2020 2066 3a20 6361 6c6c  .        f: call
+00005050: 6162 6c65 0a20 2020 2020 2020 2020 2020  able.           
+00005060: 2041 2066 756e 6374 696f 6e20 6465 7065   A function depe
+00005070: 6e64 696e 6720 6f6e 2061 2073 696e 676c  nding on a singl
+00005080: 6520 7061 7261 6d65 7465 722e 2049 7420  e parameter. It 
+00005090: 6e65 6564 7320 746f 2062 6520 7375 7070  needs to be supp
+000050a0: 6f72 7465 6420 6279 2074 6865 206e 6a65  orted by the nje
+000050b0: 7420 6d6f 6475 6c65 2e0a 2020 2020 2020  t module..      
+000050c0: 2020 2020 2020 0a20 2020 2020 2020 202a        .        *
+000050d0: 2a6b 7761 7267 730a 2020 2020 2020 2020  *kwargs.        
+000050e0: 2020 2020 4164 6469 7469 6f6e 616c 2070      Additional p
+000050f0: 6172 616d 6574 6572 7320 7061 7373 6564  arameters passed
+00005100: 2074 6f20 6c69 652e 636f 6e73 7472 7563   to lie.construc
+00005110: 7420 726f 7574 696e 652e 0a20 2020 2020  t routine..     
+00005120: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00005130: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+00005140: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00005150: 6361 6c6c 6162 6c65 206f 7220 706f 6c79  callable or poly
+00005160: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+00005170: 206f 7574 7075 7420 6465 7065 6e64 7320   output depends 
+00005180: 6f6e 2074 6865 206f 7074 696f 6e61 6c20  on the optional 
+00005190: 6172 6775 6d65 6e74 2027 706f 7765 7227  argument 'power'
+000051a0: 2e0a 2020 2020 2020 2020 2020 2020 0a20  ..            . 
+000051b0: 2020 2020 2020 2020 2020 2049 6620 6e6f             If no
+000051c0: 2061 7267 756d 656e 7420 2770 6f77 6572   argument 'power
+000051d0: 2720 6861 7320 6265 656e 2070 6173 7365  ' has been passe
+000051e0: 642c 2074 6865 6e20 6974 2077 696c 6c0a  d, then it will.
+000051f0: 2020 2020 2020 2020 2020 2020 6265 2074              be t
+00005200: 616b 656e 2066 726f 6d20 7468 6520 6375  aken from the cu
+00005210: 7272 656e 7420 7661 6c75 6520 7365 6c66  rrent value self
+00005220: 2e6d 6178 5f70 6f77 6572 2e0a 2020 2020  .max_power..    
+00005230: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+00005240: 2020 2020 2049 6620 706f 7765 7220 3c20       If power < 
+00005250: 666c 6f61 7428 2769 6e66 2729 2c20 7468  float('inf'), th
+00005260: 656e 2074 6865 204c 6965 2070 6f6c 796e  en the Lie polyn
+00005270: 6f6d 6961 6c20 3a66 2878 293a 2069 7320  omial :f(x): is 
+00005280: 7265 7475 726e 6564 2c0a 2020 2020 2020  returned,.      
+00005290: 2020 2020 2020 7768 6572 6520 6620 6861        where f ha
+000052a0: 7320 6265 656e 2065 7870 616e 6465 6420  s been expanded 
+000052b0: 7570 2074 6f20 7468 6520 7370 6563 6966  up to the specif
+000052c0: 6965 6420 706f 7765 722e 2049 6620 706f  ied power. If po
+000052d0: 7765 7220 3d3d 2066 6c6f 6174 2827 696e  wer == float('in
+000052e0: 6627 292c 0a20 2020 2020 2020 2020 2020  f'),.           
+000052f0: 2074 6865 6e20 7468 6520 6675 6e63 7469   then the functi
+00005300: 6f6e 2066 2878 2920 6973 2072 6574 7572  on f(x) is retur
+00005310: 6e65 642e 0a20 2020 2020 2020 2072 a800  ned..        r..
+00005320: 0000 2903 7218 0000 0072 2800 0000 da09  ..).r....r(.....
+00005330: 636f 6e73 7472 7563 7429 0372 2100 0000  construct).r!...
+00005340: da01 6672 2200 0000 720a 0000 0072 0a00  ..fr"...r....r..
+00005350: 0000 720f 0000 0072 b800 0000 0502 0000  ..r....r........
+00005360: 7306 0000 000c 190a 0114 017a 0f5f 706f  s..........z._po
+00005370: 6c79 2e63 6f6e 7374 7275 6374 6301 0000  ly.constructc...
+00005380: 0000 0000 0000 0000 0004 0000 0008 0000  ................
+00005390: 0003 0000 0073 8000 0000 6401 7c00 6a00  .....s....d.|.j.
+000053a0: 1400 6402 1400 7d01 6900 7d02 7c01 7c00  ..d...}.i.}.|.|.
+000053b0: a001 a100 7600 7219 7c00 6a02 7c01 1900  ....v.r.|.j.|...
+000053c0: 7c02 7403 6403 6701 8301 3c00 7c00 a004  |.t.d.g...<.|...
+000053d0: a100 4400 5d1d 5c02 8900 7d03 7405 8800  ..D.].\...}.t...
+000053e0: 8301 6404 6b02 7228 711d 7c03 7c02 7403  ..d.k.r(q.|.|.t.
+000053f0: 8700 6601 6405 6406 8408 7406 7c00 6a00  ..f.d.d...t.|.j.
+00005400: 6402 1400 8301 4400 8301 8301 3c00 711d  d.....D.....<.q.
+00005410: 7407 7c02 6407 8d01 5300 2908 7ae1 0a20  t.|.d...S.).z.. 
+00005420: 2020 2020 2020 204d 6170 2074 6865 2063         Map the c
+00005430: 7572 7265 6e74 204c 6965 2070 6f6c 796e  urrent Lie polyn
+00005440: 6f6d 6961 6c20 746f 2061 6e20 6e6a 6574  omial to an njet
+00005450: 206a 6574 706f 6c79 2063 6c61 7373 2e0a   jetpoly class..
+00005460: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+00005470: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+00005480: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00005490: 206a 6574 706f 6c79 0a20 2020 2020 2020   jetpoly.       
+000054a0: 2020 2020 2041 206a 6574 706f 6c79 2063       A jetpoly c
+000054b0: 6c61 7373 206f 6620 7365 6c66 2e64 696d  lass of self.dim
+000054c0: 2a32 2076 6172 6961 626c 6573 2c20 7265  *2 variables, re
+000054d0: 7072 6573 656e 7469 6e67 2074 6865 2063  presenting the c
+000054e0: 7572 7265 6e74 204c 6965 2070 6f6c 796e  urrent Lie polyn
+000054f0: 6f6d 6961 6c2e 0a20 2020 2020 2020 2072  omial..        r
+00005500: 7400 0000 7215 0000 0029 0272 0100 0000  t...r....).r....
+00005510: 7201 0000 0072 0100 0000 6301 0000 0000  r....r....c.....
+00005520: 0000 0000 0000 0002 0000 0005 0000 0013  ................
+00005530: 0000 0073 2400 0000 6700 7c00 5d0e 7d01  ...s$...g.|.].}.
+00005540: 8800 7c01 1900 6400 6b03 7202 7c01 8800  ..|...d.k.r.|...
+00005550: 7c01 1900 6602 9102 7102 5300 7274 0000  |...f...q.S.rt..
+00005560: 0072 0a00 0000 7286 0000 00a9 0172 4200  .r....r......rB.
+00005570: 0000 720a 0000 0072 0f00 0000 722f 0000  ..r....r....r/..
+00005580: 0037 0200 0073 0200 0000 2400 7a24 5f70  .7...s....$.z$_p
+00005590: 6f6c 792e 746f 5f6a 6574 706f 6c79 2e3c  oly.to_jetpoly.<
+000055a0: 6c6f 6361 6c73 3e2e 3c6c 6973 7463 6f6d  locals>.<listcom
+000055b0: 703e 2901 7209 0000 0029 0872 1400 0000  p>).r....).r....
+000055c0: 7218 0000 0072 1a00 0000 da09 6672 6f7a  r....r......froz
+000055d0: 656e 7365 7472 1900 0000 7226 0000 0072  ensetr....r&...r
+000055e0: 7000 0000 7203 0000 0029 0472 2100 0000  p...r....).r!...
+000055f0: 5a0c 636f 6e73 7461 6e74 5f6b 6579 5a08  Z.constant_keyZ.
+00005600: 6a70 7661 6c75 6573 720e 0000 0072 0a00  jpvaluesr....r..
+00005610: 0000 72ba 0000 0072 0f00 0000 da0a 746f  ..r....r......to
+00005620: 5f6a 6574 706f 6c79 2202 0000 7312 0000  _jetpoly"...s...
+00005630: 000e 0e04 010c 0114 0110 010c 0102 0126  ...............&
+00005640: 010a 017a 105f 706f 6c79 2e74 6f5f 6a65  ...z._poly.to_je
+00005650: 7470 6f6c 7963 0200 0000 0000 0000 0000  tpolyc..........
+00005660: 0000 0500 0000 0500 0000 0f00 0000 732e  ..............s.
+00005670: 0000 0087 0087 0187 0266 0364 0164 0284  .........f.d.d..
+00005680: 087c 00a0 00a1 0044 0083 017d 047c 006a  .|.....D...}.|.j
+00005690: 017c 047c 006a 027c 006a 0364 038d 0353  .|.|.j.|.j.d...S
+000056a0: 0029 0461 de01 0000 0a20 2020 2020 2020  .).a.....       
+000056b0: 2041 7070 6c79 2061 6e20 6f70 6572 6174   Apply an operat
+000056c0: 6f72 2074 6f20 7468 6520 636f 6566 6669  or to the coeffi
+000056d0: 6369 656e 7473 206f 6620 7468 6520 6375  cients of the cu
+000056e0: 7272 656e 7420 4c69 652d 706f 6c79 6e6f  rrent Lie-polyno
+000056f0: 6d69 616c 2e0a 2020 2020 2020 2020 0a20  mial..        . 
+00005700: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00005710: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00005720: 2d2d 2d2d 0a20 2020 2020 2020 206f 7065  ----.        ope
+00005730: 7261 746f 723a 2063 616c 6c61 626c 650a  rator: callable.
+00005740: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+00005750: 6f70 6572 6174 6f72 2e0a 2020 2020 2020  operator..      
+00005760: 2020 2020 2020 0a20 2020 2020 2020 202a        .        *
+00005770: 6172 6773 0a20 2020 2020 2020 2020 2020  args.           
+00005780: 204f 7074 696f 6e61 6c20 7061 7261 6d65   Optional parame
+00005790: 7465 7273 2070 6173 7365 6420 746f 2074  ters passed to t
+000057a0: 6865 206f 7065 7261 746f 722e 0a20 2020  he operator..   
+000057b0: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+000057c0: 2020 2a2a 6b77 6172 6773 0a20 2020 2020    **kwargs.     
+000057d0: 2020 2020 2020 204f 7074 696f 6e61 6c20         Optional 
+000057e0: 6b65 7977 6f72 6465 6420 7061 7261 6d65  keyworded parame
+000057f0: 7465 7273 2070 6173 7365 6420 746f 2074  ters passed to t
+00005800: 6865 206f 7065 7261 746f 722e 0a20 2020  he operator..   
+00005810: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+00005820: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
+00005830: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+00005840: 2020 706f 6c79 0a20 2020 2020 2020 2020    poly.         
+00005850: 2020 2041 204c 6965 2d70 6f6c 796e 6f6d     A Lie-polynom
+00005860: 6961 6c20 6861 7669 6e67 2074 6865 206d  ial having the m
+00005870: 6170 7065 6420 7661 6c75 6573 2e0a 2020  apped values..  
+00005880: 2020 2020 2020 6301 0000 0000 0000 0000        c.........
+00005890: 0000 0003 0000 0007 0000 0013 0000 0073  ...............s
+000058a0: 2800 0000 6900 7c00 5d10 5c02 7d01 7d02  (...i.|.].\.}.}.
+000058b0: 7c01 8802 7c02 6701 8800 a201 5200 6900  |...|.g.....R.i.
+000058c0: 8801 a401 8e01 9302 7102 5300 720a 0000  ........q.S.r...
+000058d0: 0072 0a00 0000 720b 0000 00a9 0372 a100  .r....r......r..
+000058e0: 0000 7222 0000 00da 086f 7065 7261 746f  ..r".....operato
+000058f0: 7272 0a00 0000 720f 0000 0072 1000 0000  rr....r....r....
+00005900: 4e02 0000 725d 0000 007a 1f5f 706f 6c79  N...r]...z._poly
+00005910: 2e61 7070 6c79 2e3c 6c6f 6361 6c73 3e2e  .apply.<locals>.
+00005920: 3c64 6963 7463 6f6d 703e 7237 0000 0029  <dictcomp>r7...)
+00005930: 0472 1900 0000 7239 0000 0072 1400 0000  .r....r9...r....
+00005940: 7228 0000 0029 0572 2100 0000 72be 0000  r(...).r!...r...
+00005950: 0072 a100 0000 7222 0000 0072 3a00 0000  .r....r"...r:...
+00005960: 720a 0000 0072 bd00 0000 720f 0000 0072  r....r....r....r
+00005970: ad00 0000 3a02 0000 7304 0000 001a 1414  ....:...s.......
+00005980: 017a 0b5f 706f 6c79 2e61 7070 6c79 6303  .z._poly.applyc.
+00005990: 0000 0000 0000 0000 0000 0006 0000 0005  ................
+000059a0: 0000 000f 0000 0073 5600 0000 7400 8801  .......sV...t...
+000059b0: 8301 6401 6b04 7214 8700 8701 8703 6603  ..d.k.r.......f.
+000059c0: 6402 6403 8408 7c00 a001 a100 4400 8301  d.d...|.....D...
+000059d0: 7d05 6e0d 8700 8702 8703 6603 6404 6403  }.n.......f.d.d.
+000059e0: 8408 7c00 a001 a100 4400 8301 7d05 7c00  ..|.....D...}.|.
+000059f0: 6a02 7c05 7c00 6a03 7c00 6a04 6405 8d03  j.|.|.j.|.j.d...
+00005a00: 5300 2906 615e 0300 000a 2020 2020 2020  S.).a^....      
+00005a10: 2020 4170 706c 7920 6120 636c 6173 7320    Apply a class 
+00005a20: 6675 6e63 7469 6f6e 206f 6620 7468 6520  function of the 
+00005a30: 636f 6566 6669 6369 656e 7473 206f 6620  coefficients of 
+00005a40: 7468 6520 6375 7272 656e 7420 4c69 652d  the current Lie-
+00005a50: 706f 6c79 6e6f 6d69 616c 2e0a 2020 2020  polynomial..    
+00005a60: 2020 2020 0a20 2020 2020 2020 2050 6172      .        Par
+00005a70: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+00005a80: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00005a90: 2020 206e 616d 653a 2073 7472 0a20 2020     name: str.   
+00005aa0: 2020 2020 2020 2020 2054 6865 206e 616d           The nam
+00005ab0: 6520 6f66 2074 6865 2063 6c61 7373 2066  e of the class f
+00005ac0: 756e 6374 696f 6e20 276e 616d 6527 2e0a  unction 'name'..
+00005ad0: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
+00005ae0: 2020 2020 2063 6172 6773 3a20 6469 6374       cargs: dict
+00005af0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00005b00: 2020 2020 2020 2044 6963 7469 6f6e 6172         Dictionar
+00005b10: 7920 6f66 206b 6579 776f 7264 7320 7768  y of keywords wh
+00005b20: 6963 6820 6d61 7920 6465 7065 6e64 206f  ich may depend o
+00005b30: 6e20 7365 6c66 2e76 616c 7565 732e 6b65  n self.values.ke
+00005b40: 7973 2829 2e20 5468 6973 206d 6561 6e73  ys(). This means
+00005b50: 2074 6861 7420 7468 6520 6b65 7973 206f   that the keys o
+00005b60: 660a 2020 2020 2020 2020 2020 2020 6361  f.            ca
+00005b70: 7267 7320 6d75 7374 2063 6f72 7265 7370  rgs must corresp
+00005b80: 6f6e 6420 746f 2073 656c 662e 7661 6c75  ond to self.valu
+00005b90: 6573 2e6b 6579 7328 292e 2054 6865 2069  es.keys(). The i
+00005ba0: 7465 6d73 206f 6620 6361 7267 7320 636f  tems of cargs co
+00005bb0: 7272 6573 706f 6e64 2074 6f20 6120 7365  rrespond to a se
+00005bc0: 7420 6f66 206b 6579 776f 7264 6564 0a20  t of keyworded. 
+00005bd0: 2020 2020 2020 2020 2020 2061 7267 756d             argum
+00005be0: 656e 7473 2066 6f72 2074 6865 2063 6c61  ents for the cla
+00005bf0: 7373 2066 756e 6374 696f 6e20 276e 616d  ss function 'nam
+00005c00: 6527 2e0a 2020 2020 2020 2020 2020 2020  e'..            
+00005c10: 0a20 2020 2020 2020 202a 6172 6773 3a0a  .        *args:.
+00005c20: 2020 2020 2020 2020 2020 2020 4172 6775              Argu
+00005c30: 6d65 6e74 7320 6f66 2074 6865 2063 6c61  ments of the cla
+00005c40: 7373 2066 756e 6374 696f 6e20 276e 616d  ss function 'nam
+00005c50: 6527 2e0a 2020 2020 2020 2020 2020 2020  e'..            
+00005c60: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
+00005c70: 733a 0a20 2020 2020 2020 2020 2020 204b  s:.            K
+00005c80: 6579 776f 7264 6564 2061 7267 756d 656e  eyworded argumen
+00005c90: 7473 206f 6620 7468 6520 636c 6173 7320  ts of the class 
+00005ca0: 6675 6e63 7469 6f6e 2027 6e61 6d65 272e  function 'name'.
+00005cb0: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
+00005cc0: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+00005cd0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+00005ce0: 2020 2020 2020 706f 6c79 0a20 2020 2020        poly.     
+00005cf0: 2020 2020 2020 2041 204c 6965 2d70 6f6c         A Lie-pol
+00005d00: 796e 6f6d 6961 6c20 696e 2077 6869 6368  ynomial in which
+00005d10: 2065 7665 7279 2065 6e74 7279 2069 6e20   every entry in 
+00005d20: 6974 7320 7661 6c75 6573 2063 6f6e 7461  its values conta
+00005d30: 696e 2074 6865 2072 6573 756c 7420 6f66  in the result of
+00005d40: 2074 6865 2072 6571 7565 7374 6564 2063   the requested c
+00005d50: 6c61 7373 2066 756e 6374 696f 6e2e 0a20  lass function.. 
+00005d60: 2020 2020 2020 2072 0100 0000 6301 0000         r....c...
+00005d70: 0000 0000 0000 0000 0003 0000 0008 0000  ................
+00005d80: 0013 0000 0073 2a00 0000 6900 7c00 5d11  .....s*...i.|.].
+00005d90: 5c02 7d01 7d02 7c01 7400 7c02 8802 8302  \.}.}.|.t.|.....
+00005da0: 8800 6900 8801 7c01 1900 a401 8e01 9302  ..i...|.........
+00005db0: 7102 5300 720a 0000 00a9 01da 0767 6574  q.S.r........get
+00005dc0: 6174 7472 a903 720c 0000 0072 4200 0000  attr..r....rB...
+00005dd0: 720e 0000 0029 0372 a100 0000 da05 6361  r....).r......ca
+00005de0: 7267 73da 046e 616d 6572 0a00 0000 720f  rgs..namer....r.
+00005df0: 0000 0072 1000 0000 6b02 0000 7302 0000  ...r....k...s...
+00005e00: 002a 007a 285f 706f 6c79 2e61 7070 6c79  .*.z(_poly.apply
+00005e10: 436c 6173 7346 756e 632e 3c6c 6f63 616c  ClassFunc.<local
+00005e20: 733e 2e3c 6469 6374 636f 6d70 3e63 0100  s>.<dictcomp>c..
+00005e30: 0000 0000 0000 0000 0000 0300 0000 0700  ................
+00005e40: 0000 1300 0000 7326 0000 0069 007c 005d  ......s&...i.|.]
+00005e50: 0f5c 027d 017d 027c 0174 007c 0288 0283  .\.}.}.|.t.|....
+00005e60: 0288 0069 0088 01a4 018e 0193 0271 0253  ...i.........q.S
+00005e70: 0072 0a00 0000 72bf 0000 0072 c100 0000  .r....r....r....
+00005e80: 2903 72a1 0000 0072 2200 0000 72c3 0000  ).r....r"...r...
+00005e90: 0072 0a00 0000 720f 0000 0072 1000 0000  .r....r....r....
+00005ea0: 6d02 0000 7241 0000 0072 3700 0000 2905  m...rA...r7...).
+00005eb0: 721c 0000 0072 1900 0000 7239 0000 0072  r....r....r9...r
+00005ec0: 1400 0000 7228 0000 0029 0672 2100 0000  ....r(...).r!...
+00005ed0: 72c3 0000 0072 c200 0000 72a1 0000 0072  r....r....r....r
+00005ee0: 2200 0000 72b4 0000 0072 0a00 0000 2904  "...r....r....).
+00005ef0: 72a1 0000 0072 c200 0000 7222 0000 0072  r....r....r"...r
+00005f00: c300 0000 720f 0000 00da 0e61 7070 6c79  ....r......apply
+00005f10: 436c 6173 7346 756e 6351 0200 0073 0800  ClassFuncQ...s..
+00005f20: 0000 0c19 1c01 1a02 1401 7a14 5f70 6f6c  ..........z._pol
+00005f30: 792e 6170 706c 7943 6c61 7373 4675 6e63  y.applyClassFunc
+00005f40: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
+00005f50: 0004 0000 0003 0000 00f3 2800 0000 7400  ..........(...t.
+00005f60: 7401 a002 6401 a101 8301 8900 8700 6601  t...d.........f.
+00005f70: 6402 6403 8408 7d01 7c00 6a03 7c01 6404  d.d...}.|.j.|.d.
+00005f80: 6405 8d02 5300 2906 fa53 0a20 2020 2020  d...S.)..S.     
+00005f90: 2020 204e 6f74 6520 7468 6174 2069 7420     Note that it 
+00005fa0: 686f 6c64 7320 7869 203d 2028 7120 2b20  holds xi = (q + 
+00005fb0: 316a 2a70 292f 7371 7274 322c 2065 7461  1j*p)/sqrt2, eta
+00005fc0: 203d 2028 7120 2d20 316a 2a70 292f 7371   = (q - 1j*p)/sq
+00005fd0: 7274 322e 0a20 2020 2020 2020 2072 1500  rt2..        r..
+00005fe0: 0000 6302 0000 0000 0000 0000 0000 0004  ..c.............
+00005ff0: 0000 0003 0000 0013 0000 0073 2800 0000  ...........s(...
+00006000: 7c00 7c01 6401 1400 1700 8800 1b00 7d02  |.|.d.........}.
+00006010: 7c00 7c01 6401 1400 1800 8800 1b00 7d03  |.|.d.........}.
+00006020: 7c02 7c03 6602 5300 a902 4e79 0000 0000  |.|.f.S...Ny....
+00006030: 0000 0000 0000 0000 0000 f03f 720a 0000  ...........?r...
+00006040: 0029 04da 0171 da01 70da 0278 69da 0365  .)...q..p..xi..e
+00006050: 7461 a901 da05 7371 7274 3272 0a00 0000  ta....sqrt2r....
+00006060: 720f 0000 00da 0374 7266 7502 0000 7306  r......trfu...s.
+00006070: 0000 0010 0110 0108 017a 1c5f 706f 6c79  .........z._poly
+00006080: 2e72 6561 6c42 6173 6973 2e3c 6c6f 6361  .realBasis.<loca
+00006090: 6c73 3e2e 7472 6672 2900 0000 a902 72ce  ls>.trfr).....r.
+000060a0: 0000 0072 0700 0000 a904 72a9 0000 0072  ...r......r....r
+000060b0: 6c00 0000 da04 7371 7274 da09 7472 616e  l.....sqrt..tran
+000060c0: 7366 6f72 6da9 0272 2100 0000 72ce 0000  sform..r!...r...
+000060d0: 0072 0a00 0000 72cc 0000 0072 0f00 0000  .r....r....r....
+000060e0: da09 7265 616c 4261 7369 7370 0200 00f3  ..realBasisp....
+000060f0: 0600 0000 0e04 0c01 0e04 7a0f 5f70 6f6c  ..........z._pol
+00006100: 792e 7265 616c 4261 7369 7363 0100 0000  y.realBasisc....
+00006110: 0000 0000 0000 0000 0200 0000 0400 0000  ................
+00006120: 0300 0000 72c5 0000 0029 0672 c600 0000  ....r....).r....
+00006130: 7215 0000 0063 0200 0000 0000 0000 0000  r....c..........
+00006140: 0000 0400 0000 0200 0000 1300 0000 7324  ..............s$
+00006150: 0000 007c 007c 0117 0088 001b 007d 027c  ...|.|.......}.|
+00006160: 007c 0118 0088 001b 0064 011b 007d 037c  .|.......d...}.|
+00006170: 027c 0366 0253 0072 c700 0000 720a 0000  .|.f.S.r....r...
+00006180: 0029 0472 ca00 0000 72cb 0000 0072 c800  .).r....r....r..
+00006190: 0000 72c9 0000 0072 cc00 0000 720a 0000  ..r....r....r...
+000061a0: 0072 0f00 0000 72ce 0000 0080 0200 0073  .r....r........s
+000061b0: 0600 0000 0c01 1001 0801 7a1f 5f70 6f6c  ..........z._pol
+000061c0: 792e 636f 6d70 6c65 7842 6173 6973 2e3c  y.complexBasis.<
+000061d0: 6c6f 6361 6c73 3e2e 7472 6672 0800 0000  locals>.trfr....
+000061e0: 72cf 0000 0072 d000 0000 72d3 0000 0072  r....r....r....r
+000061f0: 0a00 0000 72cc 0000 0072 0f00 0000 da0c  ....r....r......
+00006200: 636f 6d70 6c65 7842 6173 6973 7b02 0000  complexBasis{...
+00006210: 72d5 0000 007a 125f 706f 6c79 2e63 6f6d  r....z._poly.com
+00006220: 706c 6578 4261 7369 7346 6305 0000 0000  plexBasisFc.....
+00006230: 0000 0000 0000 000f 0000 0006 0000 0043  ...............C
+00006240: 0000 0073 d400 0000 7c00 6a00 6401 6b04  ...s....|.j.d.k.
+00006250: 7307 4a00 8201 7401 7402 a003 6402 a101  s.J...t.t...d...
+00006260: 8301 7d05 6700 6700 0202 7d06 7d07 7404  ..}.g.g...}.}.t.
+00006270: 7c00 6a00 8301 4400 5d24 7d08 7405 6403  |.j...D.]$}.t.d.
+00006280: 7c08 6403 6404 8d03 7d09 7405 6403 7c08  |.d.d...}.t.d.|.
+00006290: 7c00 6a00 1700 6403 6404 8d03 7d0a 7c01  |.j...d.d...}.|.
+000062a0: 7c09 7c0a 8302 5c02 7d0b 7d0c 7c06 a006  |.|...\.}.}.|...
+000062b0: 7c0b a101 0100 7c07 a006 7c0c a101 0100  |.....|...|.....
+000062c0: 7118 7c00 7c06 7c07 1700 8e00 7d0d 7c0d  q.|.|.|.....}.|.
+000062d0: 6401 6b02 7251 6405 7c00 6a00 1400 6402  d.k.rQd.|.j...d.
+000062e0: 1400 6401 6901 7d0e 6e10 7c0d 6a07 6402  ..d.i.}.n.|.j.d.
+000062f0: 7c00 6a00 1400 7408 7c00 a009 a100 8301  |.j...t.|.......
+00006300: 7c03 7c04 6406 8d04 7d0e 7c00 6a0a 7c0e  |.|.d...}.|.j.|.
+00006310: 7c02 7c00 6a0b 6407 8d03 5300 2908 6195  |.|.j.d...S.).a.
+00006320: 0500 000a 2020 2020 2020 2020 4361 7374  ....        Cast
+00006330: 2074 6865 2063 7572 7265 6e74 2070 6f6c   the current pol
+00006340: 796e 6f6d 6961 6c20 696e 746f 2061 2064  ynomial into a d
+00006350: 6966 6665 7265 6e74 2066 6f72 6d2e 0a20  ifferent form.. 
+00006360: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00006370: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+00006380: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+00006390: 2020 2020 2020 7472 663a 2063 616c 6c61        trf: calla
+000063a0: 626c 650a 2020 2020 2020 2020 2020 2020  ble.            
+000063b0: 4120 6c69 6e65 6172 2074 7261 6e73 666f  A linear transfo
+000063c0: 726d 6174 696f 6e20 6d61 7070 696e 6720  rmation mapping 
+000063d0: 6120 7061 6972 206f 6620 6e65 7720 7661  a pair of new va
+000063e0: 7269 6162 6c65 7320 7132 2c20 7032 2074  riables q2, p2 t
+000063f0: 6f20 6f72 6967 696e 616c 2076 6172 6961  o original varia
+00006400: 626c 6573 2071 312c 2070 312e 0a20 2020  bles q1, p1..   
+00006410: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+00006420: 2020 706f 6973 736f 6e5f 6661 6374 6f72    poisson_factor
+00006430: 3a20 5468 6520 6661 6374 6f72 2066 2073  : The factor f s
+00006440: 6f20 7468 6174 207b 7131 2c20 7031 7d5f  o that {q1, p1}_
+00006450: 7b71 312c 2070 317d 203d 2066 2a7b 7131  {q1, p1} = f*{q1
+00006460: 2c20 7031 7d5f 7b71 322c 2070 327d 2068  , p1}_{q2, p2} h
+00006470: 6f6c 642c 2077 6865 7265 0a20 2020 2020  old, where.     
+00006480: 2020 2074 6865 2062 7261 636b 6574 7320     the brackets 
+00006490: 6172 6520 6769 7665 6e20 7769 7468 2072  are given with r
+000064a0: 6573 7065 6374 2074 6f20 7468 6520 6f6c  espect to the ol
+000064b0: 642f 6e65 7720 636f 6f72 6469 6e61 7465  d/new coordinate
+000064c0: 732e 2046 6f72 2065 7861 6d70 6c65 2c20  s. For example, 
+000064d0: 6966 2071 3120 3d20 712c 2070 3120 3d20  if q1 = q, p1 = 
+000064e0: 700a 2020 2020 2020 2020 616e 6420 7132  p.        and q2
+000064f0: 203d 2078 6920 3d20 2871 202b 2070 2a31   = xi = (q + p*1
+00006500: 6a29 2f73 7172 7432 2c20 7032 203d 2065  j)/sqrt2, p2 = e
+00006510: 7461 203d 2028 7120 2d20 702a 316a 292f  ta = (q - p*1j)/
+00006520: 7371 7274 322c 2074 6865 6e0a 2020 2020  sqrt2, then.    
+00006530: 2020 2020 3120 3d20 7b71 312c 2070 317d      1 = {q1, p1}
+00006540: 5f7b 7131 2c20 7031 7d20 616e 6420 2d31  _{q1, p1} and -1
+00006550: 6a20 3d20 7b71 312c 2070 317d 5f7b 7869  j = {q1, p1}_{xi
+00006560: 2c20 6574 617d 2e20 5468 6572 6566 6f72  , eta}. Therefor
+00006570: 652c 2069 6620 7472 616e 7366 6f72 6d69  e, if transformi
+00006580: 6e67 2066 726f 6d20 712f 7020 746f 2078  ng from q/p to x
+00006590: 692f 6574 612c 0a20 2020 2020 2020 2074  i/eta,.        t
+000065a0: 6865 2070 6f69 7373 6f6e 2066 6163 746f  he poisson facto
+000065b0: 7220 6620 6861 7320 746f 2062 6520 2d31  r f has to be -1
+000065c0: 6a2e 0a20 2020 2020 2020 200a 2020 2020  j..        .    
+000065d0: 2020 2020 4174 2074 6865 206d 6f6d 656e      At the momen
+000065e0: 7420 6f6e 6c79 2032 6420 7472 616e 7366  t only 2d transf
+000065f0: 6f72 6d61 7469 6f6e 7320 6172 6520 7375  ormations are su
+00006600: 7070 6f72 7465 643b 206d 6f72 6520 736f  pported; more so
+00006610: 7068 6973 7469 6361 7465 6420 7472 616e  phisticated tran
+00006620: 7366 6f72 6d61 7469 6f6e 7320 7265 7175  sformations requ
+00006630: 6972 650a 2020 2020 2020 2020 736f 6d65  ire.        some
+00006640: 206f 7665 7277 6f72 6b20 696e 2074 6865   overwork in the
+00006650: 2070 6f69 7373 6f6e 2062 7261 636b 6574   poisson bracket
+00006660: 2072 6f75 7469 6e65 2073 656c 662e 5f5f   routine self.__
+00006670: 6d61 746d 756c 5f5f 2e0a 2020 2020 2020  matmul__..      
+00006680: 2020 0a20 2020 2020 2020 206d 756c 745f    .        mult_
+00006690: 6472 763a 2062 6f6f 6c65 616e 2c20 6f70  drv: boolean, op
+000066a0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+000066b0: 2020 2043 6f6e 7472 6f6c 206f 6620 6661     Control of fa
+000066c0: 6374 6f72 6961 6c20 616e 6420 7065 726d  ctorial and perm
+000066d0: 7574 6174 696f 6e20 636f 6566 6669 6369  utation coeffici
+000066e0: 656e 7473 2e20 5365 6520 6e6a 6574 2e70  ents. See njet.p
+000066f0: 6f6c 792e 6a65 7470 6f6c 792e 7461 796c  oly.jetpoly.tayl
+00006700: 6f72 5f63 6f65 6666 6963 6965 6e74 7320  or_coefficients 
+00006710: 666f 7220 6465 7461 696c 732e 0a20 2020  for details..   
+00006720: 2020 2020 2020 2020 200a 2020 2020 2020           .      
+00006730: 2020 6d75 6c74 5f70 726d 3a20 626f 6f6c    mult_prm: bool
+00006740: 6561 6e2c 206f 7074 696f 6e61 6c0a 2020  ean, optional.  
+00006750: 2020 2020 2020 2020 2020 436f 6e74 726f            Contro
+00006760: 6c20 6f66 2066 6163 746f 7269 616c 2061  l of factorial a
+00006770: 6e64 2070 6572 6d75 7461 7469 6f6e 2063  nd permutation c
+00006780: 6f65 6666 6963 6965 6e74 732e 2053 6565  oefficients. See
+00006790: 206e 6a65 742e 706f 6c79 2e6a 6574 706f   njet.poly.jetpo
+000067a0: 6c79 2e74 6179 6c6f 725f 636f 6566 6669  ly.taylor_coeffi
+000067b0: 6369 656e 7473 2066 6f72 2064 6574 6169  cients for detai
+000067c0: 6c73 2e0a 0a20 2020 2020 2020 2052 6574  ls...        Ret
+000067d0: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+000067e0: 2d2d 2d2d 0a20 2020 2020 2020 2064 6963  ----.        dic
+000067f0: 740a 2020 2020 2020 2020 2020 2020 5468  t.            Th
+00006800: 6520 636f 6566 6669 6369 656e 7473 206f  e coefficients o
+00006810: 6620 7468 6520 706f 6c79 6e6f 6d69 616c  f the polynomial
+00006820: 2077 6974 6820 7265 7370 6563 7420 746f   with respect to
+00006830: 2074 6865 2072 6561 6c20 7120 616e 6420   the real q and 
+00006840: 7020 636f 6f72 6469 6e61 7465 732e 0a20  p coordinates.. 
+00006850: 2020 2020 2020 2020 2020 2054 6865 206b             The k
+00006860: 6579 7320 636f 7272 6573 706f 6e64 2074  eys correspond t
+00006870: 6f20 7468 6520 706f 7765 7273 2077 6974  o the powers wit
+00006880: 6820 7265 7370 6563 7420 746f 2028 715f  h respect to (q_
+00006890: 312c 202e 2e2e 2c20 715f 6469 6d2c 2070  1, ..., q_dim, p
+000068a0: 312c 202e 2e2e 2c20 705f 6469 6d29 2e0a  1, ..., p_dim)..
+000068b0: 2020 2020 2020 2020 7201 0000 0072 1500          r....r..
+000068c0: 0000 7229 0000 0029 02da 0569 6e64 6578  ..r)...)...index
+000068d0: 72a8 0000 0072 7400 0000 2903 da05 6661  r....rt...)...fa
+000068e0: 6374 73da 086d 756c 745f 6472 76da 086d  cts..mult_drv..m
+000068f0: 756c 745f 7072 6d29 0372 0900 0000 7207  ult_prm).r....r.
+00006900: 0000 0072 2800 0000 290c 7214 0000 0072  ...r(...).r....r
+00006910: a900 0000 726c 0000 0072 d100 0000 7270  ....rl...r....rp
+00006920: 0000 0072 0300 0000 72aa 0000 00da 1374  ...r....r......t
+00006930: 6179 6c6f 725f 636f 6566 6669 6369 656e  aylor_coefficien
+00006940: 7473 7205 0000 0072 3200 0000 7239 0000  tsr....r2...r9..
+00006950: 0072 2800 0000 290f 7221 0000 0072 ce00  .r(...).r!...r..
+00006960: 0000 7207 0000 0072 d900 0000 72da 0000  ..r....r....r...
+00006970: 0072 cd00 0000 da02 7132 da02 7032 720d  .r......q2..p2r.
+00006980: 0000 00da 0271 6bda 0270 6b5a 0371 326b  .....qk..pkZ.q2k
+00006990: 5a03 7032 6bda 0268 315a 0372 6276 720a  Z.p2k..h1Z.rbvr.
+000069a0: 0000 0072 0a00 0000 720f 0000 0072 d200  ...r....r....r..
+000069b0: 0000 8602 0000 7320 0000 000e 1e0e 010a  ......s ........
+000069c0: 010e 010e 0214 010e 010a 010c 010c 0108  ................
+000069d0: 0114 0116 0204 0106 ff12 027a 0f5f 706f  ...........z._po
+000069e0: 6c79 2e74 7261 6e73 666f 726d 6304 0000  ly.transformc...
+000069f0: 0000 0000 0000 0000 000e 0000 0005 0000  ................
+00006a00: 000b 0000 0073 cc00 0000 7c00 6a00 8700  .....s....|.j...
+00006a10: 6601 6401 6402 8408 6403 8d01 7d05 7c00  f.d.d...d...}.|.
+00006a20: 6a00 8700 6601 6404 6402 8408 6403 8d01  j...f.d.d...d...
+00006a30: 7d06 6700 7d07 6700 6700 0202 7d08 7d09  }.g.}.g.g...}.}.
+00006a40: 7401 7402 7c02 8301 8301 4400 5d25 7d0a  t.t.|.....D.]%}.
+00006a50: 7c02 7c0a 1900 7d0b 7c0a 6405 1600 6406  |.|...}.|.d...d.
+00006a60: 6b02 723a 7c07 a003 7c05 7c0b 1400 a101  k.r:|...|.|.....
+00006a70: 0100 7c08 a003 7c0b a101 0100 7121 7c07  ..|...|.....q!|.
+00006a80: a003 7c06 7c0b 1400 a101 0100 7c09 a003  ..|.|.......|...
+00006a90: 7c0b a101 0100 7121 7c03 7264 7404 7c08  |.....q!|.rdt.|.
+00006aa0: 8301 7404 7c09 8301 0202 7d0c 7d0d 7c0c  ..t.|.....}.}.|.
+00006ab0: 6407 6b02 725a 7c0d 6407 6b02 7364 4a00  d.k.rZ|.d.k.sdJ.
+00006ac0: 6408 7c0c 9b00 6409 7c0d 9b00 9d04 8301  d.|...d.|.......
+00006ad0: 8201 7c07 5300 290a 6188 0200 000a 2020  ..|.S.).a.....  
+00006ae0: 2020 2020 2020 5370 6c69 7420 7468 6520        Split the 
+00006af0: 4861 6d69 6c74 6f6e 6961 6e20 7769 7468  Hamiltonian with
+00006b00: 2072 6573 7065 6374 2074 6f20 6120 7365   respect to a se
+00006b10: 7420 6f66 206b 6579 732e 200a 2020 2020  t of keys. .    
+00006b20: 2020 2020 5265 7475 726e 2061 206c 6973      Return a lis
+00006b30: 7420 6f66 2070 6f6c 796e 6f6d 6961 6c73  t of polynomials
+00006b40: 2061 6363 6f72 6469 6e67 2074 6f20 7468   according to th
+00006b50: 6520 7265 7175 6573 7465 6420 6e75 6d62  e requested numb
+00006b60: 6572 206f 6620 736c 6963 6573 2061 6e64  er of slices and
+00006b70: 2074 6865 2073 706c 6974 7469 6e67 2e0a   the splitting..
+00006b80: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+00006b90: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00006ba0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00006bb0: 2020 2020 2020 2073 6368 656d 653a 206c         scheme: l
+00006bc0: 6973 742c 206f 7074 696f 6e61 6c0a 2020  ist, optional.  
+00006bd0: 2020 2020 2020 2020 2020 4120 6c69 7374            A list
+00006be0: 206f 6620 636f 6566 6669 6369 656e 7473   of coefficients
+00006bf0: 205b 6131 2c20 6231 2c20 6132 2c20 2e2e   [a1, b1, a2, ..
+00006c00: 2e5d 0a20 2020 2020 2020 2020 2020 200a  .].            .
+00006c10: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
+00006c20: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+00006c30: 2020 2020 2020 2020 6c69 7374 0a20 2020          list.   
+00006c40: 2020 2020 2020 2020 2041 206c 6973 7420           A list 
+00006c50: 4620 6f66 2070 6f6c 7920 6f62 6a65 6374  F of poly object
+00006c60: 7320 736f 2074 6861 7420 6966 2048 203d  s so that if H =
+00006c70: 2048 3120 2b20 4832 2c20 7768 6572 6520   H1 + H2, where 
+00006c80: 4820 6973 2074 6865 2063 7572 7265 6e74  H is the current
+00006c90: 2070 6f6c 792c 2048 3120 7468 6520 706f   poly, H1 the po
+00006ca0: 6c79 0a20 2020 2020 2020 2020 2020 2061  ly.            a
+00006cb0: 6363 6f72 6469 6e67 2074 6f20 7468 6520  ccording to the 
+00006cc0: 7375 6273 6574 206f 6620 6b65 7973 2061  subset of keys a
+00006cd0: 6e64 2048 3220 7468 6520 636f 6d70 6c65  nd H2 the comple
+00006ce0: 6d65 6e74 206f 6620 4831 2c20 7468 656e  ment of H1, then
+00006cf0: 3a0a 2020 2020 2020 2020 2020 2020 4620  :.            F 
+00006d00: 3d20 5b61 312a 4831 2c20 6231 2a48 322c  = [a1*H1, b1*H2,
+00006d10: 2061 322a 4831 2c20 6232 2a48 322c 202e   a2*H1, b2*H2, .
+00006d20: 2e2e 5d0a 2020 2020 2020 2020 2020 2020  ..].            
+00006d30: 6163 636f 7264 696e 6720 746f 2074 6865  according to the
+00006d40: 2072 6571 7565 7374 6564 2069 6e70 7574   requested input
+00006d50: 206c 6973 7420 6162 6f76 652e 0a20 2020   list above..   
+00006d60: 2020 2020 2063 0100 0000 0000 0000 0000       c..........
+00006d70: 0000 0100 0000 0200 0000 1300 0000 7308  ..............s.
+00006d80: 0000 007c 0088 0076 0053 0072 4600 0000  ...|...v.S.rF...
+00006d90: 720a 0000 0072 3b00 0000 a901 7218 0000  r....r;.....r...
+00006da0: 0072 0a00 0000 720f 0000 0072 3d00 0000  .r....r....r=...
+00006db0: c802 0000 f302 0000 0008 007a 1d5f 706f  ...........z._po
+00006dc0: 6c79 2e73 706c 6974 2e3c 6c6f 6361 6c73  ly.split.<locals
+00006dd0: 3e2e 3c6c 616d 6264 613e 7249 0000 0063  >.<lambda>rI...c
+00006de0: 0100 0000 0000 0000 0000 0000 0100 0000  ................
+00006df0: 0200 0000 1300 0000 7308 0000 007c 0088  ........s....|..
+00006e00: 0076 0153 0072 4600 0000 720a 0000 0072  .v.S.rF...r....r
+00006e10: 3b00 0000 72e1 0000 0072 0a00 0000 720f  ;...r....r....r.
+00006e20: 0000 0072 3d00 0000 c902 0000 72e2 0000  ...r=.......r...
+00006e30: 0072 1500 0000 7201 0000 0072 2900 0000  .r....r....r)...
+00006e40: 7a1e 426f 7468 2073 756d 7320 6e65 6564  z.Both sums need
+00006e50: 2074 6f20 6265 2031 3a0a 7375 6d31 3a20   to be 1:.sum1: 
+00006e60: 7a08 2c20 7375 6d32 3a20 2905 7244 0000  z., sum2: ).rD..
+00006e70: 0072 7000 0000 721c 0000 0072 aa00 0000  .rp...r....r....
+00006e80: 7226 0000 0029 0e72 2100 0000 7218 0000  r&...).r!...r...
+00006e90: 00da 0673 6368 656d 65da 0563 6865 636b  ...scheme..check
+00006ea0: 7222 0000 005a 0468 616d 315a 0468 616d  r"...Z.ham1Z.ham
+00006eb0: 3272 b400 0000 7287 0000 0072 8900 0000  2r....r....r....
+00006ec0: 720d 0000 0072 b900 0000 da06 6368 6563  r....r......chec
+00006ed0: 6b31 da06 6368 6563 6b32 720a 0000 0072  k1..check2r....r
+00006ee0: e100 0000 720f 0000 00da 0573 706c 6974  ....r......split
+00006ef0: b602 0000 731e 0000 0014 1214 0104 010a  ....s...........
+00006f00: 0110 0208 010c 010e 010c 010e 020c 0104  ................
+00006f10: 0212 0224 0104 017a 0b5f 706f 6c79 2e73  ...$...z._poly.s
+00006f20: 706c 6974 4e72 8500 0000 2902 4646 2901  plitNr....).FF).
+00006f30: 4629 3872 8b00 0000 da0a 5f5f 6d6f 6475  F)8r......__modu
+00006f40: 6c65 5f5f da0c 5f5f 7175 616c 6e61 6d65  le__..__qualname
+00006f50: 5f5f da07 5f5f 646f 635f 5f72 2300 0000  __..__doc__r#...
+00006f60: 72a9 0000 0072 1f00 0000 721b 0000 0072  r....r....r....r
+00006f70: 3200 0000 7235 0000 0072 3600 0000 7244  2...r5...r6...rD
+00006f80: 0000 0072 6700 0000 724c 0000 0072 5a00  ...rg...rL...rZ.
+00006f90: 0000 725c 0000 0072 5e00 0000 725f 0000  ..r\...r^...r_..
+00006fa0: 0072 6600 0000 7272 0000 0072 7800 0000  .rf...rr...rx...
+00006fb0: 727a 0000 0072 7c00 0000 727d 0000 0072  rz...r|...r}...r
+00006fc0: 7f00 0000 7282 0000 0072 8100 0000 7296  ....r....r....r.
+00006fd0: 0000 0072 9700 0000 7299 0000 0072 9c00  ...r....r....r..
+00006fe0: 0000 7262 0000 0072 9d00 0000 729e 0000  ..rb...r....r...
+00006ff0: 0072 1800 0000 7216 0000 0072 1900 0000  .r....r....r....
+00007000: 7209 0000 0072 5000 0000 72a4 0000 0072  r....rP...r....r
+00007010: a500 0000 72a6 0000 0072 a700 0000 72ac  ....r....r....r.
+00007020: 0000 0072 ae00 0000 72b5 0000 0072 b600  ...r....r....r..
+00007030: 0000 7202 0000 0072 b800 0000 72bc 0000  ..r....r....r...
+00007040: 0072 ad00 0000 72c4 0000 0072 d400 0000  .r....r....r....
+00007050: 72d6 0000 0072 d200 0000 72e7 0000 0072  r....r....r....r
+00007060: 0a00 0000 720a 0000 0072 0a00 0000 720f  ....r....r....r.
+00007070: 0000 0072 0600 0000 0900 0000 7368 0000  ...r........sh..
+00007080: 0008 0004 0108 2b10 1b10 0f08 0808 0908  ......+.........
+00007090: 0918 080e 1a0e 100e 1708 1708 0608 0608  ................
+000070a0: 0b08 2508 1008 0308 0408 0308 0308 0308  ..%.............
+000070b0: 1a08 1208 0308 0808 1008 0408 0308 0908  ................
+000070c0: 0308 0308 0308 0308 0408 0308 0308 0510  ................
+000070d0: 0508 3308 0308 0908 0308 1708 1d08 180c  ..3.............
+000070e0: 1708 1f08 0b0a 0b0e 3072 0600 0000 6301  ........0r....c.
+000070f0: 0000 0000 0000 0000 0000 0009 0000 0006  ................
+00007100: 0000 000f 0000 0073 e400 0000 7400 8802  .......s....t...
+00007110: 8301 8903 8803 6401 6b04 730a 4a00 8201  ......d.k.s.J...
+00007120: 8802 6401 1900 6a01 8900 8803 8801 6a02  ..d...j.......j.
+00007130: 6a03 6b02 7319 4a00 6402 8301 8201 7404  j.k.s.J.d.....t.
+00007140: 8700 6601 6403 6404 8408 8802 4400 8301  ..f.d.d.....D...
+00007150: 8301 7328 4a00 6405 8301 8201 8701 8702  ..s(J.d.........
+00007160: 8703 6603 6406 6407 8408 7d03 7c02 a005  ..f.d.d...}.|...
+00007170: 6408 7406 6409 8301 a102 7d04 7c04 7406  d.t.d.....}.|.t.
+00007180: 6409 8301 6b02 7240 7c03 5300 7c02 a005  d...k.r@|.S.|...
+00007190: 640a 6401 6701 640b 1400 8800 1400 a102  d.d.g.d.........
+000071a0: 7d05 7c02 a005 640c 7407 640d 6404 8400  }.|...d.t.d.d...
+000071b0: 8802 4400 8301 8301 a102 7d06 7408 7c03  ..D.......}.t.|.
+000071c0: 7c04 640b 8800 1400 640e 8d03 7d07 7c07  |.d.....d...}.|.
+000071d0: 7c05 640f 6410 6901 8e01 7d08 8802 6401  |.d.d.i...}...d.
+000071e0: 1900 6a09 7c08 8800 7c06 6411 8d03 5300  ..j.|...|.d...S.
+000071f0: 2912 61d7 0400 000a 2020 2020 4c65 7420  ).a.....    Let 
+00007200: 7a31 2c20 2e2e 2e2c 207a 6b20 6265 204c  z1, ..., zk be L
+00007210: 6965 2070 6f6c 796e 6f6d 6961 6c73 2061  ie polynomials a
+00007220: 6e64 2066 2061 6e20 616e 616c 7974 6963  nd f an analytic
+00007230: 616c 2066 756e 6374 696f 6e2c 2074 616b  al function, tak
+00007240: 696e 6720 6b20 7661 6c75 6573 2e0a 2020  ing k values..  
+00007250: 2020 4465 7065 6e64 696e 6720 6f6e 2074    Depending on t
+00007260: 6865 2069 6e70 7574 2c20 7468 6973 2072  he input, this r
+00007270: 6f75 7469 6e65 2077 696c 6c20 6569 7468  outine will eith
+00007280: 6572 2072 6574 7572 6e20 7468 6520 4c69  er return the Li
+00007290: 6520 706f 6c79 6e6f 6d69 616c 203a 6628  e polynomial :f(
+000072a0: 7a31 2c20 2e2e 2e2c 207a 6b29 3a20 6f72  z1, ..., zk): or
+000072b0: 0a20 2020 2074 6865 206d 6170 2066 287a  .    the map f(z
+000072c0: 312c 202e 2e2e 2c20 7a6b 292e 0a20 2020  1, ..., zk)..   
+000072d0: 200a 2020 2020 5061 7261 6d65 7465 7273   .    Parameters
+000072e0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+000072f0: 2020 2020 663a 2063 616c 6c61 626c 650a      f: callable.
+00007300: 2020 2020 2020 2020 4120 6675 6e63 7469          A functi
+00007310: 6f6e 206f 6e20 7768 6963 6820 7765 2077  on on which we w
+00007320: 616e 7420 746f 2061 7070 6c79 2074 6865  ant to apply the
+00007330: 206c 6973 7420 6f66 2070 6f6c 7920 6f62   list of poly ob
+00007340: 6a65 6374 732e 0a20 2020 2020 2020 2049  jects..        I
+00007350: 7420 6e65 6564 7320 746f 2062 6520 7375  t needs to be su
+00007360: 7070 6f72 7465 6420 6279 2074 6865 206e  pported by the n
+00007370: 6a65 7420 6d6f 6475 6c65 2e0a 2020 2020  jet module..    
+00007380: 2020 2020 0a20 2020 206c 7073 3a20 706f      .    lps: po
+00007390: 6c79 0a20 2020 2020 2020 2054 6865 204c  ly.        The L
+000073a0: 6965 2070 6f6c 796e 6f6d 6961 6c28 7329  ie polynomial(s)
+000073b0: 2074 6f20 6265 2063 6f6e 7374 7275 6374   to be construct
+000073c0: 6564 2e0a 2020 2020 2020 2020 0a20 2020  ed..        .   
+000073d0: 2070 6f77 6572 3a20 696e 742c 206f 7074   power: int, opt
+000073e0: 696f 6e61 6c0a 2020 2020 2020 2020 5468  ional.        Th
+000073f0: 6520 6d61 7869 6d61 6c20 706f 7765 7220  e maximal power 
+00007400: 6f66 2074 6865 2072 6573 756c 7469 6e67  of the resulting
+00007410: 204c 6965 2070 6f6c 796e 6f6d 6961 6c20   Lie polynomial 
+00007420: 2864 6566 6175 6c74 3a20 696e 6629 2e0a  (default: inf)..
+00007430: 2020 2020 2020 2020 4966 2061 2076 616c          If a val
+00007440: 7565 2069 7320 7072 6f76 6964 6564 2c20  ue is provided, 
+00007450: 7468 6520 726f 7574 696e 6520 7769 6c6c  the routine will
+00007460: 2072 6574 7572 6e20 6120 636c 6173 7320   return a class 
+00007470: 6f66 2074 7970 6520 706f 6c79 2c20 7265  of type poly, re
+00007480: 7072 6573 656e 7469 6e67 0a20 2020 2020  presenting.     
+00007490: 2020 2061 204c 6965 2070 6f6c 796e 6f6d     a Lie polynom
+000074a0: 6961 6c2e 2049 6620 6e6f 7468 696e 6720  ial. If nothing 
+000074b0: 6973 2070 726f 7669 6465 642c 2074 6865  is provided, the
+000074c0: 2072 6f75 7469 6e65 2077 696c 6c20 7265   routine will re
+000074d0: 7475 726e 2074 6865 2066 756e 6374 696f  turn the functio
+000074e0: 6e0a 2020 2020 2020 2020 6628 7a31 2c20  n.        f(z1, 
+000074f0: 2e2e 2e2c 207a 6b29 0a20 2020 2020 2020  ..., zk).       
+00007500: 200a 2020 2020 6d61 785f 706f 7765 723a   .    max_power:
+00007510: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
+00007520: 2020 2020 2020 2053 6565 2070 6f6c 792e         See poly.
+00007530: 5f5f 696e 6974 5f5f 3b20 6f6e 6c79 2075  __init__; only u
+00007540: 7365 6420 6966 2070 6f77 6572 203c 2069  sed if power < i
+00007550: 6e66 2e0a 2020 2020 2020 2020 0a20 2020  nf..        .   
+00007560: 2070 6f69 6e74 3a20 6c69 7374 2c20 6f70   point: list, op
+00007570: 7469 6f6e 616c 0a20 2020 2020 2020 204f  tional.        O
+00007580: 6e6c 7920 7265 6c65 7661 6e74 2069 6620  nly relevant if 
+00007590: 706f 7765 7220 213d 2069 6e66 2e20 4120  power != inf. A 
+000075a0: 706f 696e 7420 6172 6f75 6e64 2066 2077  point around f w
+000075b0: 696c 6c20 6265 2065 7870 616e 6465 642e  ill be expanded.
+000075c0: 2049 6620 6e6f 7468 696e 6720 7370 6563   If nothing spec
+000075d0: 6966 6965 642c 200a 2020 2020 2020 2020  ified, .        
+000075e0: 7a65 726f 7320 7769 6c6c 2062 6520 7573  zeros will be us
+000075f0: 6564 2e0a 2020 2020 2020 2020 0a20 2020  ed..        .   
+00007600: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
+00007610: 2d2d 2d2d 0a20 2020 2063 616c 6c61 626c  ----.    callabl
+00007620: 6520 6f72 2070 6f6c 790a 2020 2020 2020  e or poly.      
+00007630: 2020 4173 2064 6573 6372 6962 6564 2061    As described a
+00007640: 626f 7665 2c20 6465 7065 6e64 696e 6720  bove, depending 
+00007650: 6f6e 2074 6865 2027 706f 7765 7227 2069  on the 'power' i
+00007660: 6e70 7574 2070 6172 616d 6574 6572 2c20  nput parameter, 
+00007670: 6569 7468 6572 2074 6865 206d 6170 2066  either the map f
+00007680: 287a 312c 202e 2e2e 2c20 7a6b 2920 6f72  (z1, ..., zk) or
+00007690: 0a20 2020 2020 2020 2074 6865 204c 6965  .        the Lie
+000076a0: 2070 6f6c 796e 6f6d 6961 6c20 3a66 287a   polynomial :f(z
+000076b0: 312c 202e 2e2e 2c20 7a6b 293a 2069 7320  1, ..., zk): is 
+000076c0: 7265 7475 726e 6564 2e0a 2020 2020 7201  returned..    r.
+000076d0: 0000 007a 3a49 6e70 7574 2066 756e 6374  ...z:Input funct
+000076e0: 696f 6e20 6465 7065 6e64 7320 6f6e 2061  ion depends on a
+000076f0: 2064 6966 6665 7265 6e74 206e 756d 6265   different numbe
+00007700: 7220 6f66 2061 7267 756d 656e 7473 2e63  r of arguments.c
+00007710: 0100 0000 0000 0000 0000 0000 0200 0000  ................
+00007720: 0400 0000 1300 0000 7316 0000 0067 007c  ........s....g.|
+00007730: 005d 077d 017c 016a 0088 006b 0291 0271  .].}.|.j...k...q
+00007740: 0253 0072 0a00 0000 2901 7214 0000 0029  .S.r....).r....)
+00007750: 0272 0c00 0000 da02 6c70 2901 da08 6469  .r......lp)...di
+00007760: 6d5f 706f 6c79 720a 0000 0072 0f00 0000  m_polyr....r....
+00007770: 722f 0000 0004 0300 0072 4300 0000 7a1d  r/.......rC...z.
+00007780: 636f 6e73 7472 7563 742e 3c6c 6f63 616c  construct.<local
+00007790: 733e 2e3c 6c69 7374 636f 6d70 3e7a 3549  s>.<listcomp>z5I
+000077a0: 6e70 7574 2070 6f6c 796e 6f6d 6961 6c73  nput polynomials
+000077b0: 206e 6f74 2061 6c6c 2068 6176 696e 6720   not all having 
+000077c0: 7468 6520 7361 6d65 2064 696d 656e 7369  the same dimensi
+000077d0: 6f6e 732e 6300 0000 0000 0000 0000 0000  ons.c...........
+000077e0: 0001 0000 0004 0000 0017 0000 0073 1c00  .............s..
+000077f0: 0000 8801 8702 8700 6602 6401 6402 8408  ........f.d.d...
+00007800: 7400 8803 8301 4400 8301 8e00 5300 2903  t.....D.....S.).
+00007810: 4e63 0100 0000 0000 0000 0000 0000 0200  Nc..............
+00007820: 0000 0400 0000 1300 0000 7318 0000 0067  ..........s....g
+00007830: 007c 005d 087d 0188 007c 0119 0088 018e  .|.].}...|......
+00007840: 0091 0271 0253 0072 0a00 0000 720a 0000  ...q.S.r....r...
+00007850: 0072 6800 0000 2902 da03 6c70 7372 6400  .rh...)...lpsrd.
+00007860: 0000 720a 0000 0072 0f00 0000 722f 0000  ..r....r....r/..
+00007870: 0006 0300 0072 3000 0000 7a2f 636f 6e73  .....r0...z/cons
+00007880: 7472 7563 742e 3c6c 6f63 616c 733e 2e3c  truct.<locals>.<
+00007890: 6c61 6d62 6461 3e2e 3c6c 6f63 616c 733e  lambda>.<locals>
+000078a0: 2e3c 6c69 7374 636f 6d70 3e29 0172 7000  .<listcomp>).rp.
+000078b0: 0000 a901 7264 0000 0029 0372 b900 0000  ....rd...).r....
+000078c0: 72ed 0000 00da 086e 5f61 7267 735f 6672  r......n_args_fr
+000078d0: ee00 0000 720f 0000 0072 3d00 0000 0603  ....r....r=.....
+000078e0: 0000 7293 0000 007a 1b63 6f6e 7374 7275  ..r....z.constru
+000078f0: 6374 2e3c 6c6f 6361 6c73 3e2e 3c6c 616d  ct.<locals>.<lam
+00007900: 6264 613e 72a8 0000 0072 2400 0000 da05  bda>r....r$.....
+00007910: 706f 696e 7472 1500 0000 7228 0000 0063  pointr....r(...c
+00007920: 0100 0000 0000 0000 0000 0000 0200 0000  ................
+00007930: 0300 0000 5300 0000 7312 0000 0067 007c  ....S...s....g.|
+00007940: 005d 057d 017c 016a 0091 0271 0253 0072  .].}.|.j...q.S.r
+00007950: 0a00 0000 7227 0000 0029 0272 0c00 0000  ....r'...).r....
+00007960: da01 6c72 0a00 0000 720a 0000 0072 0f00  ..lr....r....r..
+00007970: 0000 722f 0000 000d 0300 0073 0200 0000  ..r/.......s....
+00007980: 1200 2902 da05 6f72 6465 7272 b700 0000  ..)...orderr....
+00007990: 72d9 0000 0046 7237 0000 0029 0a72 1c00  r....Fr7...).r..
+000079a0: 0000 7214 0000 00da 085f 5f63 6f64 655f  ..r......__code_
+000079b0: 5fda 0b63 6f5f 6172 6763 6f75 6e74 7253  _..co_argcountrS
+000079c0: 0000 0072 1600 0000 72a9 0000 0072 3400  ...r....r....r4.
+000079d0: 0000 7202 0000 0072 3900 0000 2909 72b9  ..r....r9...).r.
+000079e0: 0000 0072 ed00 0000 7222 0000 00da 0c63  ...r....r".....c
+000079f0: 6f6e 7374 7275 6374 696f 6e72 a800 0000  onstructionr....
+00007a00: 72f0 0000 0072 2800 0000 5a05 6463 6f6d  r....r(...Z.dcom
+00007a10: 70da 0d74 6179 6c6f 725f 636f 6566 6673  p..taylor_coeffs
+00007a20: 720a 0000 0029 0472 ec00 0000 72b9 0000  r....).r....r...
+00007a30: 0072 ed00 0000 72ef 0000 0072 0f00 0000  .r....r....r....
+00007a40: 72b8 0000 00dd 0200 0073 1c00 0000 0822  r........s....."
+00007a50: 0c01 0a01 1402 1e01 1002 1002 0c01 0401  ................
+00007a60: 1602 1a01 1201 0e01 1401 72b8 0000 0029  ..........r....)
+00007a70: 0ada 056e 756d 7079 726c 0000 00da 046e  ...numpyrl.....n
+00007a80: 6a65 7472 0200 0000 7203 0000 005a 0b6e  jetr....r....Z.n
+00007a90: 6a65 742e 636f 6d6d 6f6e 7204 0000 0072  jet.commonr....r
+00007aa0: 0500 0000 7206 0000 0072 b800 0000 720a  ....r....r....r.
+00007ab0: 0000 0072 0a00 0000 720a 0000 0072 0f00  ...r....r....r..
+00007ac0: 0000 da08 3c6d 6f64 756c 653e 0100 0000  ....<module>....
+00007ad0: 7314 0000 0008 0310 0210 010e 0200 7f00  s...............
+00007ae0: 7f00 7f00 7f00 7f0c 59                   ........Y
```

### Comparing `lieops-0.2.1/lieops/core/__pycache__/tools.cpython-310.pyc` & `lieops-0.2.2/lieops/core/__pycache__/tools.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.10, timestamp-based, .py timestamp: Fri Feb 24 10:08:05 2023 UTC, .py size: 16133 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 14% similar despite different names*

```diff
@@ -1,906 +1,973 @@
-00000000: 6f0d 0d0a 0000 0000 858c f863 053f 0000  o..........c.?..
+00000000: 6f0d 0d0a 0000 0000 01e1 3f64 f445 0000  o.........?d.E..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0004 0000 0040 0000 0073 ca00 0000 6400  .....@...s....d.
+00000020: 0004 0000 0040 0000 0073 d200 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a01 6400 6401 6c02 5a02 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6402 6c03 6d04 5a04 6d05 5a05 0100 6400  d.l.m.Z.m.Z...d.
-00000050: 6401 6c06 5a07 6400 6403 6c08 6d09 5a09  d.l.Z.d.d.l.m.Z.
-00000060: 0100 6404 6405 8400 5a0a 6429 6407 6408  ..d.d...Z.d)d.d.
-00000070: 8401 5a0b 6409 640a 8400 5a0c 640b 640c  ..Z.d.d...Z.d.d.
-00000080: 8400 5a0d 640d 640e 8400 5a0e 640f 6410  ..Z.d.d...Z.d.d.
-00000090: 8400 5a0f 6411 6412 8400 5a10 6413 6414  ..Z.d.d...Z.d.d.
-000000a0: 8400 5a11 6406 6415 9c01 6416 6417 8402  ..Z.d.d...d.d...
-000000b0: 5a12 6418 6419 8400 5a13 641a 641b 8400  Z.d.d...Z.d.d...
-000000c0: 641c 9c01 641d 641e 8402 5a14 641f 6420  d...d.d...Z.d.d 
-000000d0: 8400 5a15 6700 6421 6422 9c02 6423 6516  ..Z.g.d!d"..d#e.
-000000e0: 6602 6424 6425 8406 5a17 642a 6427 6428  f.d$d%..Z.d*d'd(
-000000f0: 8401 5a18 6401 5300 292b e900 0000 004e  ..Z.d.S.)+.....N
-00000100: 2902 da06 6465 7269 7665 da17 6765 745f  )...derive..get_
-00000110: 7461 796c 6f72 5f63 6f65 6666 6963 6965  taylor_coefficie
-00000120: 6e74 7329 01da 0863 7265 6174 655f 4a63  nts)...create_Jc
-00000130: 0100 0000 0000 0000 0000 0000 0b00 0000  ................
-00000140: 0700 0000 4300 0000 738c 0100 007c 00a0  ....C...s....|..
-00000150: 00a1 0064 016b 0272 0c7c 00a0 01a1 0064  ...d.k.r.|.....d
-00000160: 016b 0273 0e4a 0082 017c 006a 027d 017c  .k.s.J...|.j.}.|
-00000170: 0164 0114 007d 027c 006a 037d 0374 046a  .d...}.|.j.}.t.j
-00000180: 057c 027c 0267 0274 046a 0664 028d 027d  .|.|.g.t.j.d...}
-00000190: 0474 077c 0183 0144 005d 9d7d 0574 077c  .t.|...D.].}.t.|
-000001a0: 0183 0144 005d 967d 0664 0367 017c 0214  ...D.].}.d.g.|..
-000001b0: 007d 077c 077c 0505 0019 0064 0437 0003  .}.|.|.....d.7..
-000001c0: 003c 007c 077c 067c 0117 0005 0019 0064  .<.|.|.|.......d
-000001d0: 0437 0003 003c 007c 00a0 0874 097c 0783  .7...<.|...t.|..
-000001e0: 0164 03a1 027c 030b 0014 007c 047c 057c  .d...|.....|.|.|
-000001f0: 0666 023c 007c 00a0 0874 097c 0783 0164  .f.<.|...t.|...d
-00000200: 03a1 027c 0314 007c 047c 067c 0117 007c  ...|...|.|.|...|
-00000210: 057c 0117 0066 023c 007c 057c 066b 0372  .|...f.<.|.|.k.r
-00000220: 6d64 047d 086e 0264 017d 0864 0367 017c  md.}.n.d.}.d.g.|
-00000230: 0214 007d 097c 097c 0505 0019 0064 0437  ...}.|.|.....d.7
-00000240: 0003 003c 007c 097c 0605 0019 0064 0437  ...<.|.|.....d.7
-00000250: 0003 003c 007c 00a0 0874 097c 0983 0164  ...<.|...t.|...d
-00000260: 03a1 027c 0314 007c 0814 007c 047c 057c  ...|...|...|.|.|
-00000270: 067c 0117 0066 023c 0064 0367 017c 0214  .|...f.<.d.g.|..
-00000280: 007d 0a7c 0a7c 057c 0117 0005 0019 0064  .}.|.|.|.......d
-00000290: 0437 0003 003c 007c 0a7c 067c 0117 0005  .7...<.|.|.|....
-000002a0: 0019 0064 0437 0003 003c 007c 00a0 0874  ...d.7...<.|...t
-000002b0: 097c 0a83 0164 03a1 027c 030b 0014 007c  .|...d...|.....|
-000002c0: 0814 007c 047c 057c 0117 007c 0666 023c  ...|.|.|...|.f.<
-000002d0: 0071 2c71 267c 0453 0029 0561 ea02 0000  .q,q&|.S.).a....
-000002e0: 0a20 2020 2043 6f6d 7075 7465 2061 2028  .    Compute a (
-000002f0: 326e 2978 2832 6e29 2d6d 6174 7269 7820  2n)x(2n)-matrix 
-00000300: 7265 7072 6573 656e 7461 7469 6f6e 206f  representation o
-00000310: 6620 6120 686f 6d6f 6765 6e6f 7573 2073  f a homogenous s
-00000320: 6563 6f6e 642d 6f72 6465 7220 706f 6c79  econd-order poly
-00000330: 6e6f 6d69 616c 2041 2c0a 2020 2020 736f  nomial A,.    so
-00000340: 2074 6861 7420 6966 207a 5f6a 2064 656e   that if z_j den
-00000350: 6f74 6573 2074 6865 2070 726f 6a65 6374  otes the project
-00000360: 696f 6e73 206f 6e74 6f20 7468 6520 6361  ions onto the ca
-00000370: 6e6f 6e69 6361 6c20 636f 6f72 6469 6e61  nonical coordina
-00000380: 7465 2063 6f6d 706f 6e65 6e74 732c 2074  te components, t
-00000390: 6865 6e0a 2020 2020 0a20 2020 207b 412c  hen.    .    {A,
-000003a0: 207a 5f6a 7d20 3d20 415f 7b69 6a7d 207a   z_j} = A_{ij} z
-000003b0: 5f69 2020 2020 2020 2020 2020 2020 2020  _i              
-000003c0: 2020 2020 2020 2831 290a 2020 2020 0a20        (1).    . 
-000003d0: 2020 2068 6f6c 6473 2e20 5468 6520 6272     holds. The br
-000003e0: 6163 6b65 7473 207b 202c 207d 2064 656e  ackets { , } den
-000003f0: 6f74 6520 7468 6520 706f 6973 736f 6e20  ote the poisson 
-00000400: 6272 6163 6b65 742e 2054 6865 2076 616c  bracket. The val
-00000410: 7565 7320 415f 7b69 6a7d 2077 696c 6c20  ues A_{ij} will 
-00000420: 6265 2064 6574 6572 6d69 6e65 642e 0a20  be determined.. 
-00000430: 2020 200a 2020 2020 5265 6d61 726b 3a20     .    Remark: 
-00000440: 5468 6520 6f72 6465 7220 6f66 2074 6865  The order of the
-00000450: 2069 6e64 6963 6573 2069 6e20 4571 2e20   indices in Eq. 
-00000460: 2831 2920 6861 7320 6265 656e 2063 686f  (1) has been cho
-00000470: 7365 6e20 746f 2067 7561 7261 6e74 6565  sen to guarantee
-00000480: 2074 6861 7420 6d61 7472 6978 206d 756c   that matrix mul
-00000490: 7469 706c 6963 6174 696f 6e0a 2020 2020  tiplication.    
-000004a0: 2020 2020 2020 2020 616e 6420 6164 6a6f          and adjo
-000004b0: 696e 7420 626f 7468 206d 6169 6e74 6169  int both maintai
-000004c0: 6e20 7468 6520 7361 6d65 206f 7264 6572  n the same order
-000004d0: 3a0a 2020 2020 2020 2020 2020 2020 7b41  :.            {A
-000004e0: 2c20 7b42 2c20 7a5f 6a7d 7d20 3d20 2841  , {B, z_j}} = (A
-000004f0: 206f 2042 295f 7b69 6a7d 207a 5f69 0a20   o B)_{ij} z_i. 
-00000500: 2020 200a 2020 2020 5061 7261 6d65 7465     .    Paramete
-00000510: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
-00000520: 2d0a 2020 2020 7069 6e3a 2070 6f6c 790a  -.    pin: poly.
-00000530: 2020 2020 2020 2020 5468 6520 706f 6c79          The poly
-00000540: 6e6f 6d69 616c 2074 6f20 6265 2063 6f6e  nomial to be con
-00000550: 7665 7274 6564 2e0a 2020 2020 2020 2020  verted..        
-00000560: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
-00000570: 202d 2d2d 2d2d 2d2d 0a20 2020 2061 7272   -------.    arr
-00000580: 6179 2d6c 696b 650a 2020 2020 2020 2020  ay-like.        
-00000590: 4120 636f 6d70 6c65 7820 6d61 7472 6978  A complex matrix
-000005a0: 2063 6f72 7265 7370 6f6e 6469 6e67 2074   corresponding t
-000005b0: 6f20 7468 6520 7265 7072 6573 656e 7461  o the representa
-000005c0: 7469 6f6e 2e0a 2020 2020 e902 0000 00a9  tion..    ......
-000005d0: 01da 0564 7479 7065 7201 0000 00e9 0100  ...dtyper.......
-000005e0: 0000 290a da06 6d61 7864 6567 da06 6d69  ..)...maxdeg..mi
-000005f0: 6e64 6567 da03 6469 6dda 0f5f 706f 6973  ndeg..dim.._pois
-00000600: 736f 6e5f 6661 6374 6f72 da02 6e70 da05  son_factor..np..
-00000610: 7a65 726f 73da 0a63 6f6d 706c 6578 3132  zeros..complex12
-00000620: 38da 0572 616e 6765 da03 6765 74da 0574  8..range..get..t
-00000630: 7570 6c65 290b da03 7069 6e72 0b00 0000  uple)...pinr....
-00000640: da04 6469 6d32 da0e 706f 6973 736f 6e5f  ..dim2..poisson_
-00000650: 6661 6374 6f72 da01 41da 0169 da01 6ada  factor..A..i..j.
-00000660: 096d 6978 6564 5f6b 6579 da02 6666 da0a  .mixed_key..ff..
-00000670: 686f 6d5f 6b65 795f 7869 da0b 686f 6d5f  hom_key_xi..hom_
-00000680: 6b65 795f 6574 61a9 0072 1d00 0000 fa52  key_eta..r.....R
-00000690: 2f68 6f6d 652f 6d61 6c74 652f 6d69 6e69  /home/malte/mini
-000006a0: 636f 6e64 6133 2f65 6e76 732f 776f 726b  conda3/envs/work
-000006b0: 2f6c 6962 2f70 7974 686f 6e33 2e31 302f  /lib/python3.10/
-000006c0: 7369 7465 2d70 6163 6b61 6765 732f 6c69  site-packages/li
-000006d0: 656f 7073 2f63 6f72 652f 746f 6f6c 732e  eops/core/tools.
-000006e0: 7079 da07 706f 6c79 3261 640a 0000 0073  py..poly2ad....s
-000006f0: 3200 0000 1c17 0601 0801 0601 1401 0c01  2...............
-00000700: 0c01 0a01 1001 1401 1e01 2401 0802 0603  ..........$.....
-00000710: 0402 0a02 1001 1001 2401 0a02 1401 1401  ........$.......
-00000720: 2801 02ea 0417 721f 0000 00f9 0000 0000  (.....r.........
-00000730: 0000 0080 0000 0000 0000 f0bf 6303 0000  ............c...
-00000740: 0000 0000 0000 0000 0011 0000 0008 0000  ................
-00000750: 004b 0000 0073 4a02 0000 7c00 6a00 6401  .K...sJ...|.j.d.
-00000760: 1900 7c00 6a00 6402 1900 6b02 730c 4a00  ..|.j.d...k.s.J.
-00000770: 8201 7c00 6a00 6401 1900 7d04 7c04 6403  ..|.j.d...}.|.d.
-00000780: 1600 6401 6b02 7319 4a00 8201 7c04 6403  ..d.k.s.J...|.d.
-00000790: 1a00 7d05 6900 7d06 7401 7c05 8301 4400  ..}.i.}.t.|...D.
-000007a0: 5df3 7d07 7401 7c05 8301 4400 5dec 7d08  ].}.t.|...D.].}.
-000007b0: 7c01 6401 6b04 7297 7c00 9b00 6404 7c01  |.d.k.r.|...d.|.
-000007c0: 9b00 6405 9d04 7d09 7402 7c00 7c07 7c08  ..d...}.t.|.|.|.
-000007d0: 6602 1900 7c00 7c08 7c05 1700 7c07 7c05  f...|.|.|...|.|.
-000007e0: 1700 6602 1900 1700 8301 7d0a 7402 7c00  ..f.......}.t.|.
-000007f0: 7c07 7c08 7c05 1700 6602 1900 7c00 7c08  |.|.|...f...|.|.
-00000800: 7c07 7c05 1700 6602 1900 1800 8301 7d0b  |.|...f.......}.
-00000810: 7402 7c00 7c07 7c05 1700 7c08 6602 1900  t.|.|.|...|.f...
-00000820: 7c00 7c08 7c05 1700 7c07 6602 1900 1800  |.|.|...|.f.....
-00000830: 8301 7d0c 7c0a 7c01 6b00 737b 4a00 7c09  ..}.|.|.k.s{J.|.
-00000840: 6406 7c0a 9b00 6405 9d03 1700 8301 8201  d.|...d.........
-00000850: 7c0b 7c01 6b00 7389 4a00 7c09 6406 7c0b  |.|.k.s.J.|.d.|.
-00000860: 9b00 6405 9d03 1700 8301 8201 7c0c 7c01  ..d.........|.|.
-00000870: 6b00 7397 4a00 7c09 6406 7c0c 9b00 6405  k.s.J.|.d.|...d.
-00000880: 9d03 1700 8301 8201 6401 6701 7c04 1400  ........d.g.|...
-00000890: 7d0d 7c0d 7c07 0500 1900 6402 3700 0300  }.|.|.....d.7...
-000008a0: 3c00 7c0d 7c08 7c05 1700 0500 1900 6402  <.|.|.|.......d.
-000008b0: 3700 0300 3c00 7c00 7c07 7c08 6602 1900  7...<.|.|.|.f...
-000008c0: 6407 1400 7c02 1b00 7c06 7403 7c0d 8301  d...|...|.t.|...
-000008d0: 3c00 7c07 7c08 6b03 72c3 6402 7d0e 6e02  <.|.|.k.r.d.}.n.
-000008e0: 6403 7d0e 6401 6701 7c04 1400 7d0f 7c0f  d.}.d.g.|...}.|.
-000008f0: 7c07 0500 1900 6402 3700 0300 3c00 7c0f  |.....d.7...<.|.
-00000900: 7c08 0500 1900 6402 3700 0300 3c00 7c00  |.....d.7...<.|.
-00000910: 7c07 7c08 7c05 1700 6602 1900 7c0e 1b00  |.|.|...f...|...
-00000920: 7c02 1b00 7c06 7403 7c0f 8301 3c00 6401  |...|.t.|...<.d.
-00000930: 6701 7c04 1400 7d10 7c10 7c07 7c05 1700  g.|...}.|.|.|...
-00000940: 0500 1900 6402 3700 0300 3c00 7c10 7c08  ....d.7...<.|.|.
-00000950: 7c05 1700 0500 1900 6402 3700 0300 3c00  |.......d.7...<.
-00000960: 7c00 7c07 7c05 1700 7c08 6602 1900 7c0e  |.|.|...|.f...|.
-00000970: 1b00 6407 1400 7c02 1b00 7c06 7403 7c10  ..d...|...|.t.|.
-00000980: 8301 3c00 7129 7123 7404 6a05 6a06 6a07  ..<.q)q#t.j.j.j.
-00000990: 640a 7c06 7c05 7c02 6408 9c03 7c03 a401  d.|.|.|.d...|...
-000009a0: 8e01 5300 290b 619d 0400 000a 2020 2020  ..S.).a.....    
-000009b0: 5472 616e 7366 6f72 6d20 6120 636f 6d70  Transform a comp
-000009c0: 6c65 7820 2832 6e29 7828 326e 292d 6d61  lex (2n)x(2n)-ma
-000009d0: 7472 6978 2072 6570 7265 7365 6e74 6174  trix representat
-000009e0: 696f 6e20 6f66 2061 2070 6f6c 796e 6f6d  ion of a polynom
-000009f0: 6961 6c20 6261 636b 2074 6f20 0a20 2020  ial back to .   
-00000a00: 2069 7473 2070 6f6c 796e 6f6d 6961 6c20   its polynomial 
-00000a10: 7869 2f65 7461 2d72 6570 7265 7365 6e74  xi/eta-represent
-00000a20: 6174 696f 6e2e 2054 6869 7320 6973 2074  ation. This is t
-00000a30: 6865 2069 6e76 6572 7365 206f 6620 7468  he inverse of th
-00000a40: 6520 2770 6f6c 7932 6164 2720 726f 7574  e 'poly2ad' rout
-00000a50: 696e 652e 0a20 2020 200a 2020 2020 4174  ine..    .    At
-00000a60: 7465 6e74 696f 6e3a 2041 206d 6174 7269  tention: A matri
-00000a70: 7820 6164 6d69 7473 2061 2070 6f6c 796e  x admits a polyn
-00000a80: 6f6d 6961 6c20 7265 7072 6573 656e 7461  omial representa
-00000a90: 7469 6f6e 2069 6620 616e 6420 6f6e 6c79  tion if and only
-00000aa0: 2069 6620 6974 2069 7320 616e 2065 6c65   if it is an ele
-00000ab0: 6d65 6e74 0a20 2020 2020 2020 2020 2020  ment.           
-00000ac0: 2020 2020 6f66 2073 7028 326e 3b20 4329      of sp(2n; C)
-00000ad0: 2c20 7468 6520 4c69 652d 616c 6765 6272  , the Lie-algebr
-00000ae0: 6120 6f66 2073 796d 706c 6563 7469 6320  a of symplectic 
-00000af0: 636f 6d70 6c65 7820 2832 6e29 7828 326e  complex (2n)x(2n
-00000b00: 292d 6d61 7472 6963 6573 2e20 4279 2064  )-matrices. By d
-00000b10: 6566 6175 6c74 0a20 2020 2020 2020 2020  efault.         
-00000b20: 2020 2020 2020 7468 6973 2072 6f75 7469        this routi
-00000b30: 6e65 2077 696c 6c20 2a6e 6f74 2a20 6368  ne will *not* ch
-00000b40: 6563 6b20 6167 6169 6e73 7420 7468 6973  eck against this
-00000b50: 2070 726f 7065 7274 7920 2862 7574 2073   property (but s
-00000b60: 6565 2074 6865 2069 6e66 6f72 6d61 7469  ee the informati
-00000b70: 6f6e 2062 656c 6f77 292e 0a20 2020 200a  on below)..    .
-00000b80: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00000b90: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00000ba0: 2020 413a 2061 7272 6179 2d6c 696b 650a    A: array-like.
-00000bb0: 2020 2020 2020 2020 4d61 7472 6978 2072          Matrix r
-00000bc0: 6570 7265 7365 6e74 696e 6720 7468 6520  epresenting the 
-00000bd0: 706f 6c79 6e6f 6d69 616c 2e0a 2020 2020  polynomial..    
-00000be0: 2020 2020 0a20 2020 2074 6f6c 3a20 666c      .    tol: fl
-00000bf0: 6f61 742c 206f 7074 696f 6e61 6c0a 2020  oat, optional.  
-00000c00: 2020 2020 2020 4120 746f 6c65 7261 6e63        A toleranc
-00000c10: 6520 746f 2063 6865 636b 2061 2073 7566  e to check a suf
-00000c20: 6669 6369 656e 7420 7072 6f70 6572 7479  ficient property
-00000c30: 206f 6620 7468 6520 6769 7665 6e20 6d61   of the given ma
-00000c40: 7472 6978 2074 6f20 6265 2061 2076 616c  trix to be a val
-00000c50: 6964 2072 6570 7265 7365 6e74 6174 696f  id representatio
-00000c60: 6e2e 0a20 2020 2020 2020 204e 6f20 6368  n..        No ch
-00000c70: 6563 6b20 7769 6c6c 2062 6520 6d61 6465  eck will be made
-00000c80: 2069 6620 2774 6f6c 2720 6973 207a 6572   if 'tol' is zer
-00000c90: 6f20 2864 6566 6175 6c74 292e 0a20 2020  o (default)..   
-00000ca0: 2020 2020 200a 2020 2020 706f 6973 736f       .    poisso
-00000cb0: 6e5f 6661 6374 6f72 3a20 636f 6d70 6c65  n_factor: comple
-00000cc0: 782c 206f 7074 696f 6e61 6c0a 2020 2020  x, optional.    
-00000cd0: 2020 2020 4120 6661 6374 6f72 2064 6566      A factor def
-00000ce0: 696e 696e 6720 7468 6520 706f 6973 736f  ining the poisso
-00000cf0: 6e20 7374 7275 6374 7572 6520 6f66 2074  n structure of t
-00000d00: 6865 2073 6f75 6768 7420 706f 6c79 6e6f  he sought polyno
-00000d10: 6d69 616c 2e20 4279 2064 6566 6175 6c74  mial. By default
-00000d20: 2074 6869 7320 6661 6374 6f72 0a20 2020   this factor.   
-00000d30: 2020 2020 2069 7320 2d31 6a2c 2063 6f72       is -1j, cor
-00000d40: 7265 7370 6f6e 6469 6e67 2074 6f20 7468  responding to th
-00000d50: 6520 706f 6973 736f 6e20 7374 7275 6374  e poisson struct
-00000d60: 7572 6520 6f66 2074 6865 2063 6f6d 706c  ure of the compl
-00000d70: 6578 2078 692f 6574 6120 636f 6f72 6469  ex xi/eta coordi
-00000d80: 6e61 7465 732e 0a20 2020 2020 2020 200a  nates..        .
-00000d90: 2020 2020 2a2a 6b77 6172 6773 0a20 2020      **kwargs.   
-00000da0: 2020 2020 204f 7074 696f 6e61 6c20 6b65       Optional ke
-00000db0: 7977 6f72 6465 6420 6172 6775 6d65 6e74  yworded argument
-00000dc0: 7320 7061 7373 6564 2074 6f20 6c69 656f  s passed to lieo
-00000dd0: 7073 2e63 6f72 652e 6c69 652e 706f 6c79  ps.core.lie.poly
-00000de0: 2072 6f75 7469 6e65 2e0a 2020 2020 2020   routine..      
-00000df0: 2020 0a20 2020 2052 6574 7572 6e73 0a20    .    Returns. 
-00000e00: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2070     -------.    p
-00000e10: 6f6c 790a 2020 2020 2020 2020 506f 6c79  oly.        Poly
-00000e20: 6e6f 6d69 616c 2063 6f72 7265 7370 6f6e  nomial correspon
-00000e30: 6469 6e67 2074 6f20 7468 6520 6d61 7472  ding to the matr
-00000e40: 6978 2e0a 2020 2020 7201 0000 0072 0800  ix..    r....r..
-00000e50: 0000 7205 0000 007a 4f0a 4d61 7472 6978  ..r....zO.Matrix
-00000e60: 206e 6f74 2069 6e20 7370 2832 6e3b 2043   not in sp(2n; C
-00000e70: 292c 2074 6865 204c 6965 2d61 6c67 6562  ), the Lie-algeb
-00000e80: 7261 206f 6620 636f 6d70 6c65 7820 7379  ra of complex sy
-00000e90: 6d70 6c65 6374 6963 206d 6174 7269 6365  mplectic matrice
-00000ea0: 7320 2874 6f6c 3a20 7a02 292e fa01 28e9  s (tol: z.)...(.
-00000eb0: ffff ffff 2903 da06 7661 6c75 6573 720b  ....)...valuesr.
-00000ec0: 0000 0072 1500 0000 4e72 1d00 0000 2908  ...r....Nr....).
-00000ed0: da05 7368 6170 6572 1000 0000 da03 6162  ..shaper......ab
-00000ee0: 7372 1200 0000 da06 6c69 656f 7073 da04  sr......lieops..
-00000ef0: 636f 7265 da03 6c69 65da 0470 6f6c 7929  core..lie..poly)
-00000f00: 1172 1600 0000 da03 746f 6c72 1500 0000  .r......tolr....
-00000f10: da06 6b77 6172 6773 7214 0000 0072 0b00  ..kwargsr....r..
-00000f20: 0000 7223 0000 0072 1700 0000 7218 0000  ..r#...r....r...
-00000f30: 00da 0965 7272 6f72 5f6d 7367 da02 6331  ...error_msg..c1
-00000f40: da02 6332 da02 6333 7219 0000 0072 1a00  ..c2..c3r....r..
-00000f50: 0000 721b 0000 0072 1c00 0000 721d 0000  ..r....r....r...
-00000f60: 0072 1d00 0000 721e 0000 00da 0761 6432  .r....r......ad2
-00000f70: 706f 6c79 4000 0000 7340 0000 0018 1e0a  poly@...s@......
-00000f80: 0110 0108 0104 020c 010c 0108 0210 0324  ...............$
-00000f90: 0124 0124 011c 011c 011c 010a 0210 0114  .$.$............
-00000fa0: 011c 0108 0306 0104 020a 0210 0110 0120  ............... 
-00000fb0: 010a 0214 0114 0126 0102 e01c 2172 3000  .......&....!r0.
-00000fc0: 0000 6301 0000 0000 0000 0000 0000 0006  ..c.............
-00000fd0: 0000 0004 0000 0043 0000 0073 6200 0000  .......C...sb...
-00000fe0: 7c00 a000 a100 6401 6b02 720c 7c00 a001  |.....d.k.r.|...
-00000ff0: a100 6401 6b02 730e 4a00 8201 7c00 6a02  ..d.k.s.J...|.j.
-00001000: 7d01 7403 6a04 7c01 6402 1400 7403 6a05  }.t.j.|.d...t.j.
-00001010: 6403 8d02 7d02 7c00 a006 a100 4400 5d0f  d...}.|.....D.].
-00001020: 5c02 7d03 7d04 7407 7c03 8301 a008 6401  \.}.}.t.|.....d.
-00001030: a101 7d05 7c04 7c02 7c05 3c00 711f 7c02  ..}.|.|.|.<.q.|.
-00001040: 5300 2904 7a7a 0a20 2020 204d 6170 2061  S.).zz.    Map a
-00001050: 2066 6972 7374 2d6f 7264 6572 2070 6f6c   first-order pol
-00001060: 796e 6f6d 6961 6c20 746f 2069 7473 2072  ynomial to its r
-00001070: 6573 7065 6374 6976 6520 7665 6374 6f72  espective vector
-00001080: 2069 6e20 6d61 7472 6978 2072 6570 7265   in matrix repre
-00001090: 7365 6e74 6174 696f 6e20 0a20 2020 2028  sentation .    (
-000010a0: 7365 6520 616c 736f 2027 706f 6c79 3261  see also 'poly2a
-000010b0: 6427 2072 6f75 7469 6e65 290a 2020 2020  d' routine).    
-000010c0: 7208 0000 0072 0500 0000 7206 0000 0029  r....r....r....)
-000010d0: 0972 0900 0000 720a 0000 0072 0b00 0000  .r....r....r....
-000010e0: 720d 0000 0072 0e00 0000 720f 0000 00da  r....r....r.....
-000010f0: 0569 7465 6d73 da04 6c69 7374 da05 696e  .items..list..in
-00001100: 6465 7829 06da 0170 720b 0000 00da 036f  dex)...pr......o
-00001110: 7574 da01 6bda 0176 7218 0000 0072 1d00  ut..k..vr....r..
-00001120: 0000 721d 0000 0072 1e00 0000 da08 706f  ..r....r......po
-00001130: 6c79 3276 6563 8800 0000 730e 0000 001c  ly2vec....s.....
-00001140: 0506 0114 0110 010e 010a 0104 0172 3800  .............r8.
-00001150: 0000 6301 0000 0000 0000 0000 0000 0002  ..c.............
-00001160: 0000 0004 0000 0003 0000 0073 4a00 0000  ...........sJ...
-00001170: 7400 8800 8301 7d01 7c01 6401 1600 6402  t.....}.|.d...d.
-00001180: 6b02 730e 4a00 6403 8301 8201 7401 6a02  k.s.J.d.....t.j.
-00001190: 6a03 a004 7c01 6401 1a00 a101 8901 7405  j...|.d.......t.
-000011a0: 8700 8701 6602 6404 6405 8408 7406 7c01  ....f.d.d...t.|.
-000011b0: 8301 4400 8301 8301 5300 2906 7a2c 0a20  ..D.....S.).z,. 
-000011c0: 2020 2054 6865 2069 6e76 6572 7365 206f     The inverse o
-000011d0: 6620 2770 6f6c 7932 7665 6327 2072 6f75  f 'poly2vec' rou
-000011e0: 7469 6e65 2e0a 2020 2020 7205 0000 0072  tine..    r....r
-000011f0: 0100 0000 fa17 4469 6d65 6e73 696f 6e20  ......Dimension 
-00001200: 6d75 7374 2062 6520 6576 656e 2e63 0100  must be even.c..
-00001210: 0000 0000 0000 0000 0000 0200 0000 0500  ................
-00001220: 0000 1300 0000 731c 0000 0067 007c 005d  ......s....g.|.]
-00001230: 0a7d 0188 017c 0119 0088 007c 0119 0014  .}...|.....|....
-00001240: 0091 0271 0253 0072 1d00 0000 721d 0000  ...q.S.r....r...
-00001250: 00a9 02da 022e 3072 3600 0000 a902 7237  ......0r6.....r7
-00001260: 0000 00da 0578 6965 7461 721d 0000 0072  .....xietar....r
-00001270: 1e00 0000 da0a 3c6c 6973 7463 6f6d 703e  ......<listcomp>
-00001280: 9c00 0000 7302 0000 001c 007a 1c76 6563  ....s......z.vec
-00001290: 3270 6f6c 792e 3c6c 6f63 616c 733e 2e3c  2poly.<locals>.<
-000012a0: 6c69 7374 636f 6d70 3e29 07da 036c 656e  listcomp>)...len
-000012b0: 7226 0000 0072 2700 0000 7228 0000 00da  r&...r'...r(....
-000012c0: 0d63 7265 6174 655f 636f 6f72 6473 da03  .create_coords..
-000012d0: 7375 6d72 1000 0000 2902 7237 0000 0072  sumr....).r7...r
-000012e0: 1400 0000 721d 0000 0072 3c00 0000 721e  ....r....r<...r.
-000012f0: 0000 00da 0876 6563 3270 6f6c 7995 0000  .....vec2poly...
-00001300: 0073 0800 0000 0804 1401 1201 1c01 7242  .s............rB
-00001310: 0000 0063 0100 0000 0000 0000 0000 0000  ...c............
-00001320: 0a00 0000 0600 0000 4300 0000 7308 0100  ........C...s...
-00001330: 007c 00a0 00a1 0064 016b 0172 0c7c 00a0  .|.....d.k.r.|..
-00001340: 01a1 0064 026b 0573 0e4a 0082 017c 006a  ...d.k.s.J...|.j
-00001350: 027d 017c 0164 0114 007d 027c 006a 037d  .}.|.d...}.|.j.}
-00001360: 0374 046a 057c 0264 0217 007c 0264 0217  .t.j.|.d...|.d..
-00001370: 0067 0274 046a 0664 038d 027d 047c 00a0  .g.t.j.d...}.|..
-00001380: 0764 01a1 017d 0574 087c 0583 0164 046b  .d...}.t.|...d.k
-00001390: 0372 3d74 097c 0583 017c 0464 057c 0285  .r=t.|...|.d.|..
-000013a0: 0264 057c 0285 0266 023c 007c 00a0 0764  .d.|...f.<.|...d
-000013b0: 02a1 017d 0674 087c 0683 0164 046b 0372  ...}.t.|...d.k.r
-000013c0: 8274 0a7c 0183 0144 005d 357d 0764 0467  .t.|...D.]5}.d.g
-000013d0: 017c 0214 007d 0864 027c 087c 073c 007c  .|...}.d.|.|.<.|
-000013e0: 06a0 0b74 0c7c 0883 0164 04a1 027c 0314  ...t.|...d...|..
-000013f0: 007c 047c 027c 077c 0117 0066 023c 0064  .|.|.|.|...f.<.d
-00001400: 0467 017c 0214 007d 0964 027c 097c 077c  .g.|...}.d.|.|.|
-00001410: 0117 003c 007c 06a0 0b74 0c7c 0983 0164  ...<.|...t.|...d
-00001420: 04a1 027c 030b 0014 007c 047c 027c 0766  ...|.....|.|.|.f
-00001430: 023c 0071 4c7c 0453 0029 0661 3002 0000  .<.qL|.S.).a0...
-00001440: 0a20 2020 2043 6f6d 7075 7465 2061 2028  .    Compute a (
-00001450: 326e 202b 2031 2978 2832 6e20 2b20 3129  2n + 1)x(2n + 1)
-00001460: 2d6d 6174 7269 7820 7265 7072 6573 656e  -matrix represen
-00001470: 7461 7469 6f6e 206f 6620 6120 7365 636f  tation of a seco
-00001480: 6e64 2d6f 7264 6572 2070 6f6c 796e 6f6d  nd-order polynom
-00001490: 6961 6c20 2877 6974 686f 7574 0a20 2020  ial (without.   
-000014a0: 2063 6f6e 7374 616e 7420 7465 726d 292c   constant term),
-000014b0: 2067 6976 656e 2069 6e20 7465 726d 7320   given in terms 
-000014c0: 6f66 2063 6f6d 706c 6578 2078 692f 6574  of complex xi/et
-000014d0: 6120 636f 6f72 6469 6e61 7465 732c 200a  a coordinates, .
-000014e0: 2020 2020 736f 2074 6861 7420 6966 207a      so that if z
-000014f0: 5f6a 2064 656e 6f74 6520 7468 6520 6261  _j denote the ba
-00001500: 7369 7320 7665 6374 6f72 732c 2074 6865  sis vectors, the
-00001510: 6e3a 0a20 2020 200a 2020 2020 7b70 2c20  n:.    .    {p, 
-00001520: 7a5f 6a7d 203d 2070 5f7b 696a 7d20 7a5f  z_j} = p_{ij} z_
-00001530: 6920 2b20 725f 6a0a 2020 2020 0a20 2020  i + r_j.    .   
-00001540: 2068 6f6c 6473 2e20 5468 6520 6272 6163   holds. The brac
-00001550: 6b65 7473 207b 202c 207d 2064 656e 6f74  kets { , } denot
-00001560: 6520 7468 6520 706f 6973 736f 6e20 6272  e the poisson br
-00001570: 6163 6b65 742e 2054 6865 2076 616c 7565  acket. The value
-00001580: 7320 705f 7b69 6a7d 2061 6e64 2072 5f6a  s p_{ij} and r_j
-00001590: 2077 696c 6c20 6265 2064 6574 6572 6d69   will be determi
-000015a0: 6e65 642e 0a20 2020 200a 2020 2020 5061  ned..    .    Pa
-000015b0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-000015c0: 2d2d 2d2d 2d2d 2d0a 2020 2020 7069 6e3a  -------.    pin:
-000015d0: 2070 6f6c 790a 2020 2020 2020 2020 5468   poly.        Th
-000015e0: 6520 706f 6c79 6e6f 6d69 616c 2074 6f20  e polynomial to 
-000015f0: 6265 2063 6f6e 7665 7274 6564 2e0a 2020  be converted..  
-00001600: 2020 2020 2020 0a20 2020 2052 6574 7572        .    Retur
-00001610: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
-00001620: 2020 2061 7272 6179 2d6c 696b 650a 2020     array-like.  
-00001630: 2020 2020 2020 4120 636f 6d70 6c65 7820        A complex 
-00001640: 6d61 7472 6978 2063 6f72 7265 7370 6f6e  matrix correspon
-00001650: 6469 6e67 2074 6f20 7468 6520 7265 7072  ding to the repr
-00001660: 6573 656e 7461 7469 6f6e 2e0a 2020 2020  esentation..    
-00001670: 7205 0000 0072 0800 0000 7206 0000 0072  r....r....r....r
-00001680: 0100 0000 4e29 0d72 0900 0000 720a 0000  ....N).r....r...
-00001690: 0072 0b00 0000 720c 0000 0072 0d00 0000  .r....r....r....
-000016a0: 720e 0000 0072 0f00 0000 da10 686f 6d6f  r....r......homo
-000016b0: 6765 6e65 6f75 735f 7061 7274 723f 0000  geneous_partr?..
-000016c0: 0072 1f00 0000 7210 0000 0072 1100 0000  .r....r....r....
-000016d0: 7212 0000 0029 0a72 1300 0000 720b 0000  r....).r....r...
-000016e0: 0072 1400 0000 7215 0000 00da 0470 6d61  .r....r......pma
-000016f0: 74da 0470 696e 32da 0470 696e 3172 3600  t..pin2..pin1r6.
-00001700: 0000 da06 7869 5f6b 6579 da07 6574 615f  ....xi_key..eta_
-00001710: 6b65 7972 1d00 0000 721d 0000 0072 1e00  keyr....r....r..
-00001720: 0000 da07 706f 6c79 3361 649e 0000 0073  ....poly3ad....s
-00001730: 2400 0000 1c14 0601 0801 0601 1c02 0a02  $...............
-00001740: 0c01 1801 0a02 0c01 0c01 0a01 0801 2001  .............. .
-00001750: 0a02 0c01 2001 0401 7249 0000 0063 0100  .... ...rI...c..
-00001760: 0000 0000 0000 0000 0000 0a00 0000 0500  ................
-00001770: 0000 4b00 0000 73de 0000 007c 006a 0064  ..K...s....|.j.d
-00001780: 0119 007c 006a 0064 0219 006b 0273 0c4a  ...|.j.d...k.s.J
-00001790: 0082 017c 006a 0064 0119 0064 0218 007d  ...|.j.d...d...}
-000017a0: 027c 0264 0316 0064 016b 0273 1b4a 0082  .|.d...d.k.s.J..
-000017b0: 017c 0264 031a 007d 0374 017c 0064 047c  .|.d...}.t.|.d.|
-000017c0: 0285 0264 047c 0285 0266 0219 0066 0169  ...d.|...f...f.i
-000017d0: 007c 01a4 018e 017d 047c 046a 027d 0574  .|.....}.|.j.}.t
-000017e0: 037c 0483 0164 016b 0272 3a64 017d 0474  .|...d.k.r:d.}.t
-000017f0: 046a 056a 06a0 077c 03a1 017d 0674 087c  .j.j...|...}.t.|
-00001800: 0383 0144 005d 277d 077c 007c 027c 0766  ...D.]'}.|.|.|.f
-00001810: 0219 007c 050b 001b 007d 087c 007c 027c  ...|.....}.|.|.|
-00001820: 077c 0317 0066 0219 007c 051b 007d 097c  .|...f...|...}.|
-00001830: 047c 067c 0719 007c 0914 0037 007d 047c  .|.|...|...7.}.|
-00001840: 047c 067c 077c 0317 0019 007c 0814 0037  .|.|.|.....|...7
-00001850: 007d 0471 457c 0453 0029 057a 2f0a 2020  .}.qE|.S.).z/.  
-00001860: 2020 5468 6520 696e 7665 7273 6520 6f66    The inverse of
-00001870: 2074 6865 2027 706f 6c79 3361 6427 2072   the 'poly3ad' r
-00001880: 6f75 7469 6e65 2e0a 2020 2020 7201 0000  outine..    r...
-00001890: 0072 0800 0000 7205 0000 004e 2909 7224  .r....r....N).r$
-000018a0: 0000 0072 3000 0000 720c 0000 0072 3f00  ...r0...r....r?.
-000018b0: 0000 7226 0000 0072 2700 0000 7228 0000  ..r&...r'...r(..
-000018c0: 0072 4000 0000 7210 0000 0029 0a72 1600  .r@...r....).r..
-000018d0: 0000 722b 0000 0072 1400 0000 720b 0000  ..r+...r....r...
-000018e0: 00da 0270 3272 1500 0000 723d 0000 0072  ...p2r....r=...r
-000018f0: 3600 0000 da0b 6574 615f 6b5f 636f 6566  6.....eta_k_coef
-00001900: 66da 0a78 695f 6b5f 636f 6566 6672 1d00  f..xi_k_coeffr..
-00001910: 0000 721d 0000 0072 1e00 0000 da07 6164  ..r....r......ad
-00001920: 3370 6f6c 79c9 0000 0073 1e00 0000 1804  3poly....s......
-00001930: 0e01 1001 0801 2002 0601 0c01 0401 0e02  ...... .........
-00001940: 0c01 1201 1401 1001 1601 0401 724d 0000  ............rM..
-00001950: 0063 0100 0000 0000 0000 0000 0000 0500  .c..............
-00001960: 0000 0700 0000 4b00 0000 7352 0000 007c  ......K...sR...|
-00001970: 00a0 00a1 0064 016b 0173 084a 0082 017c  .....d.k.s.J...|
-00001980: 00a0 0164 02a1 017d 027c 00a0 0164 01a1  ...d...}.|...d..
-00001990: 017d 0374 027c 0366 0169 007c 01a4 018e  .}.t.|.f.i.|....
-000019a0: 017d 0474 03a0 047c 047c 02a0 0564 037c  .}.t...|.|...d.|
-000019b0: 006a 0614 0064 0414 0064 02a1 02a1 0253  .j...d...d.....S
-000019c0: 0029 057a 9a0a 2020 2020 4d61 7020 6120  .).z..    Map a 
-000019d0: 4c69 6520 706f 6c79 6e6f 6d69 616c 206f  Lie polynomial o
-000019e0: 6620 6465 6772 6565 203c 3d20 3120 746f  f degree <= 1 to
-000019f0: 2069 7473 2072 6573 7065 6374 6976 6520   its respective 
-00001a00: 2832 6e20 2b20 3129 2d64 696d 656e 7369  (2n + 1)-dimensi
-00001a10: 6f6e 616c 0a20 2020 2076 6563 746f 722e  onal.    vector.
-00001a20: 2054 6865 206c 6173 7420 6469 6d65 6e73   The last dimens
-00001a30: 696f 6e20 6973 2068 6572 6562 7920 6465  ion is hereby de
-00001a40: 6469 6361 7465 6420 746f 2074 6865 2063  dicated to the c
-00001a50: 6f6e 7374 616e 7473 2e20 0a20 2020 2072  onstants. .    r
-00001a60: 0800 0000 7201 0000 00a9 0172 0100 0000  ....r......r....
-00001a70: 7205 0000 0029 0772 0900 0000 7243 0000  r....).r....rC..
-00001a80: 0072 3800 0000 720d 0000 00da 0661 7070  .r8...r......app
-00001a90: 656e 6472 1100 0000 720b 0000 0029 0572  endr....r....).r
-00001aa0: 3400 0000 722b 0000 00da 0270 30da 0270  4...r+.....p0..p
-00001ab0: 31da 0476 6563 3172 1d00 0000 721d 0000  1..vec1r....r...
-00001ac0: 0072 1e00 0000 da08 706f 6c79 3376 6563  .r......poly3vec
-00001ad0: df00 0000 730a 0000 0010 050a 010a 0110  ....s...........
-00001ae0: 011e 0172 5300 0000 6301 0000 0000 0000  ...rS...c.......
-00001af0: 0000 0000 0004 0000 0004 0000 004b 0000  .............K..
-00001b00: 0073 4c00 0000 7400 7c00 8301 6401 1600  .sL...t.|...d...
-00001b10: 6402 6b02 730a 4a00 8201 7400 7c00 8301  d.k.s.J...t.|...
-00001b20: 6402 1800 7d02 7401 7c00 6403 6404 8502  d...}.t.|.d.d...
-00001b30: 1900 6601 6900 7c01 a401 8e01 7d03 7c00  ..f.i.|.....}.|.
-00001b40: 6404 1900 7c03 6405 7c02 1400 3c00 7c03  d...|.d.|...<.|.
-00001b50: 5300 2906 7a2e 0a20 2020 2054 6865 2069  S.).z..    The i
-00001b60: 6e76 6572 7365 206f 6620 7468 6520 706f  nverse of the po
-00001b70: 6c79 3376 6563 2072 6f75 7469 6e65 2e0a  ly3vec routine..
-00001b80: 2020 2020 7205 0000 0072 0800 0000 4e72      r....r....Nr
-00001b90: 2200 0000 724e 0000 0029 0272 3f00 0000  "...rN...).r?...
-00001ba0: 7242 0000 0029 04da 0376 6563 722b 0000  rB...)...vecr+..
-00001bb0: 00da 026e 3272 5100 0000 721d 0000 0072  ...n2rQ...r....r
-00001bc0: 1d00 0000 721e 0000 00da 0876 6563 3370  ....r......vec3p
-00001bd0: 6f6c 79ea 0000 0073 0a00 0000 1404 0c01  oly....s........
-00001be0: 1801 1001 0401 7256 0000 0029 0172 1500  ......rV...).r..
-00001bf0: 0000 6300 0000 0000 0000 0001 0000 0005  ..c.............
-00001c00: 0000 0004 0000 000f 0000 0073 6800 0000  ...........sh...
-00001c10: 7400 8801 8301 7d03 7c03 6401 1600 6402  t.....}.|.d...d.
-00001c20: 6b02 730e 4a00 6403 8301 8201 7c03 6401  k.s.J.d.....|.d.
-00001c30: 1a00 7d04 7401 7c04 8301 8900 7402 6a03  ..}.t.|.....t.j.
-00001c40: 6a04 6a05 7c04 6601 6404 7c00 6901 7c02  j.j.|.f.d.|.i.|.
-00001c50: a401 8e01 8902 7406 8700 8701 8702 6603  ......t.......f.
-00001c60: 6405 6406 8408 7407 7c03 8301 4400 8301  d.d...t.|...D...
-00001c70: 8301 7c00 1b00 5300 2907 7a80 0a20 2020  ..|...S.).z..   
-00001c80: 204c 6574 2063 5f31 2c20 2e2e 2e2c 2063   Let c_1, ..., c
-00001c90: 5f7b 326e 7d20 6265 2063 6f6e 7374 616e  _{2n} be constan
-00001ca0: 7473 2e20 5468 656e 2063 6f6d 7075 7465  ts. Then compute
-00001cb0: 2061 2066 6972 7374 2d6f 7264 6572 2070   a first-order p
-00001cc0: 6f6c 796e 6f6d 6961 6c20 675f 310a 2020  olynomial g_1.  
-00001cd0: 2020 736f 2074 6861 7420 7b67 5f31 2c20    so that {g_1, 
-00001ce0: 7a5f 6a7d 203d 207a 5f6a 202b 2063 5f6a  z_j} = z_j + c_j
-00001cf0: 2068 6f6c 6473 2e0a 2020 2020 7205 0000   holds..    r...
-00001d00: 0072 0100 0000 7239 0000 0072 1500 0000  .r....r9...r....
-00001d10: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
-00001d20: 0005 0000 0013 0000 0073 2000 0000 6700  .........s ...g.
-00001d30: 7c00 5d0c 7d01 8802 7c01 1900 8800 8801  |.].}...|.......
-00001d40: 1000 7c01 1900 1400 9102 7102 5300 721d  ..|.......q.S.r.
-00001d50: 0000 0072 1d00 0000 723a 0000 00a9 03da  ...r....r:......
-00001d60: 014a da05 636f 6e73 7472 3d00 0000 721d  .J..constr=...r.
-00001d70: 0000 0072 1e00 0000 723e 0000 00fe 0000  ...r....r>......
-00001d80: 0073 0200 0000 2000 7a1e 636f 6e73 7432  .s.... .z.const2
-00001d90: 706f 6c79 2e3c 6c6f 6361 6c73 3e2e 3c6c  poly.<locals>.<l
-00001da0: 6973 7463 6f6d 703e 2908 723f 0000 0072  istcomp>).r?...r
-00001db0: 0400 0000 7226 0000 0072 2700 0000 7228  ....r&...r'...r(
-00001dc0: 0000 0072 4000 0000 7241 0000 0072 1000  ...r@...rA...r..
-00001dd0: 0000 2905 7215 0000 0072 5900 0000 722b  ..).r....rY...r+
-00001de0: 0000 0072 1400 0000 720b 0000 0072 1d00  ...r....r....r..
-00001df0: 0000 7257 0000 0072 1e00 0000 da0a 636f  ..rW...r......co
-00001e00: 6e73 7432 706f 6c79 f400 0000 730c 0000  nst2poly....s...
-00001e10: 0008 0514 0108 0108 011a 0122 0172 5a00  ...........".rZ.
-00001e20: 0000 6301 0000 0000 0000 0000 0000 0002  ..c.............
-00001e30: 0000 0005 0000 0003 0000 0073 4800 0000  ...........sH...
-00001e40: 8800 a000 a100 6401 6b02 720c 8800 a001  ......d.k.r.....
-00001e50: a100 6401 6b02 730e 4a00 8201 7402 6a03  ..d.k.s.J...t.j.
-00001e60: 6a04 6a05 8800 6a06 8800 6a07 8800 6a08  j.j...j...j...j.
-00001e70: 6402 8d03 7d01 8700 6601 6403 6404 8408  d...}...f.d.d...
-00001e80: 7c01 4400 8301 5300 2905 7a32 0a20 2020  |.D...S.).z2.   
-00001e90: 2054 6865 2069 6e76 6572 7365 206f 6620   The inverse of 
-00001ea0: 7468 6520 2763 6f6e 7374 3270 6f6c 7927  the 'const2poly'
-00001eb0: 2072 6f75 7469 6e65 2e0a 2020 2020 7208   routine..    r.
-00001ec0: 0000 0029 0272 1500 0000 da09 6d61 785f  ...).r......max_
-00001ed0: 706f 7765 7263 0100 0000 0000 0000 0000  powerc..........
-00001ee0: 0000 0200 0000 0500 0000 1300 0000 7322  ..............s"
-00001ef0: 0000 0067 007c 005d 0d7d 0188 007c 0110  ...g.|.].}...|..
-00001f00: 0064 0088 006a 0014 0064 0114 0019 0091  .d...j...d......
-00001f10: 0271 0253 0029 0272 4e00 0000 7205 0000  .q.S.).rN...r...
-00001f20: 00a9 0172 0b00 0000 2902 723b 0000 00da  ...r....).r;....
-00001f30: 0278 65a9 0172 5100 0000 721d 0000 0072  .xe..rQ...r....r
-00001f40: 1e00 0000 723e 0000 0006 0100 0073 0200  ....r>.......s..
-00001f50: 0000 2200 7a1e 706f 6c79 3263 6f6e 7374  ..".z.poly2const
-00001f60: 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973 7463  .<locals>.<listc
-00001f70: 6f6d 703e 2909 720a 0000 0072 0900 0000  omp>).r....r....
-00001f80: 7226 0000 0072 2700 0000 7228 0000 0072  r&...r'...r(...r
-00001f90: 4000 0000 720b 0000 0072 0c00 0000 725b  @...r....r....r[
-00001fa0: 0000 0029 0272 5100 0000 723d 0000 0072  ...).rQ...r=...r
-00001fb0: 1d00 0000 725e 0000 0072 1e00 0000 da0a  ....r^...r......
-00001fc0: 706f 6c79 3263 6f6e 7374 0001 0000 7306  poly2const....s.
-00001fd0: 0000 001c 041a 0112 0172 5f00 0000 6301  .........r_...c.
-00001fe0: 0000 0000 0000 0000 0000 0001 0000 0001  ................
-00001ff0: 0000 0043 0000 0073 0400 0000 7c00 5300  ...C...s....|.S.
-00002000: a901 4e72 1d00 0000 2901 da01 7a72 1d00  ..Nr....)...zr..
-00002010: 0000 721d 0000 0072 1e00 0000 da08 3c6c  ..r....r......<l
-00002020: 616d 6264 613e 0801 0000 7302 0000 0004  ambda>....s.....
-00002030: 0072 6200 0000 2901 da04 6675 6e63 6300  .rb...)...funcc.
-00002040: 0000 0000 0000 0002 0000 0003 0000 0005  ................
-00002050: 0000 0007 0000 0073 4000 0000 7400 8802  .......s@...t...
-00002060: 8301 8800 6a01 6b02 7309 4a00 8201 7402  ....j.k.s.J...t.
-00002070: 6a03 6a04 6a05 8700 8701 8702 6603 6401  j.j.j.......f.d.
-00002080: 6402 8408 8800 a006 a100 4400 8301 8800  d.........D.....
-00002090: 6a01 8800 6a07 6403 8d03 5300 2904 612f  j...j.d...S.).a/
-000020a0: 0300 000a 2020 2020 5468 6520 706f 6973  ....    The pois
-000020b0: 736f 6e20 6272 6163 6b65 7420 6f66 2074  son bracket of t
-000020c0: 6865 2070 6f6c 796e 6f6d 6961 6c20 5820  he polynomial X 
-000020d0: 3a3d 2073 756d 5f6b 206d 755f 6b20 6570  := sum_k mu_k ep
-000020e0: 7369 6c6f 6e5f 6b20 0a20 2020 2028 6e6f  silon_k .    (no
-000020f0: 7461 7469 6f6e 2061 7320 696e 2052 6566  tation as in Ref
-00002100: 2e20 5b31 5d2c 2077 6865 7265 2065 7073  . [1], where eps
-00002110: 696c 6f6e 5f6b 2064 656e 6f74 6573 2074  ilon_k denotes t
-00002120: 6865 206b 2d74 6820 6163 7469 6f6e 2061  he k-th action a
-00002130: 6e64 206d 755f 6b20 0a20 2020 2074 6865  nd mu_k .    the
-00002140: 206b 2d74 6820 7475 6e65 292c 2061 7070   k-th tune), app
-00002150: 6c69 6564 2074 6f20 736f 6d65 2061 7262  lied to some arb
-00002160: 6974 7261 7279 2070 6f6c 796e 6f6d 6961  itrary polynomia
-00002170: 6c20 432c 2063 616e 2062 6520 636f 6d70  l C, can be comp
-00002180: 7574 6564 2064 6972 6563 746c 7920 0a20  uted directly . 
-00002190: 2020 2064 7565 2074 6f20 7468 6520 6661     due to the fa
-000021a0: 6374 2074 6861 7420 7468 6520 7869 2f65  ct that the xi/e
-000021b0: 7461 2d63 6f6f 7264 696e 6174 6573 2063  ta-coordinates c
-000021c0: 6f6e 7374 6974 7574 6520 616e 2022 6569  onstitute an "ei
-000021d0: 6765 6e62 6173 6973 2220 6f66 2058 2e0a  genbasis" of X..
-000021e0: 2020 2020 0a20 2020 2054 6869 7320 726f      .    This ro
-000021f0: 7574 696e 6520 7769 6c6c 2070 6572 666f  utine will perfo
-00002200: 726d 2074 6865 2063 616c 6375 6c61 7469  rm the calculati
-00002210: 6f6e 2061 6e64 2072 6574 7572 6e20 7468  on and return th
-00002220: 6520 7265 7375 6c74 696e 6720 706f 6c79  e resulting poly
-00002230: 6e6f 6d69 616c 2e0a 2020 2020 0a20 2020  nomial..    .   
-00002240: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00002250: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 206d  ----------.    m
-00002260: 753a 2066 6c6f 6174 2028 6f72 2063 6f6d  u: float (or com
-00002270: 706c 6578 290a 2020 2020 2020 2020 5468  plex).        Th
-00002280: 6520 7475 6e65 7320 6f66 2074 6865 2061  e tunes of the a
-00002290: 6374 696f 6e2d 6f70 6572 6174 6f72 0a20  ction-operator. 
-000022a0: 2020 200a 2020 2020 433a 2070 6f6c 790a     .    C: poly.
-000022b0: 2020 2020 2020 2020 5468 6520 706f 6c79          The poly
-000022c0: 6e6f 6d69 616c 206f 6e20 7768 6963 6820  nomial on which 
-000022d0: 7468 6520 6163 7469 6f6e 206f 7065 7261  the action opera
-000022e0: 746f 7220 7368 6f75 6c64 2062 6520 6170  tor should be ap
-000022f0: 706c 6965 642e 0a20 2020 2020 2020 200a  plied..        .
-00002300: 2020 2020 6675 6e63 3a20 6361 6c6c 6162      func: callab
-00002310: 6c65 2028 6f70 7469 6f6e 616c 290a 2020  le (optional).  
-00002320: 2020 2020 2020 4120 6675 6e63 7469 6f6e        A function
-00002330: 2066 2073 6f20 7468 6174 2066 2858 2920   f so that f(X) 
-00002340: 6973 2061 7070 6c69 6564 2069 6e73 7465  is applied inste
-00002350: 6164 2e0a 2020 2020 2020 2020 0a20 2020  ad..        .   
-00002360: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
-00002370: 2d2d 2d2d 0a20 2020 2070 6f6c 790a 2020  ----.    poly.  
-00002380: 2020 2020 2020 5468 6520 706f 6c79 206f        The poly o
-00002390: 626a 6563 7420 7b58 2c20 437d 2028 6f72  bject {X, C} (or
-000023a0: 207b 6628 5829 2c20 437d 2c20 6966 2061   {f(X), C}, if a
-000023b0: 2066 756e 6374 696f 6e20 6861 7320 6265   function has be
-000023c0: 656e 2070 726f 7669 6465 6429 2e0a 2020  en provided)..  
-000023d0: 2020 6301 0000 0000 0000 0000 0000 0002    c.............
-000023e0: 0000 0009 0000 0013 0000 0073 3e00 0000  ...........s>...
-000023f0: 6900 7c00 5d1b 5c02 8900 7d01 8800 7c01  i.|.].\...}...|.
-00002400: 8802 7400 8701 8703 8700 6603 6400 6401  ..t.......f.d.d.
-00002410: 8408 7401 8801 6a02 8301 4400 8301 8301  ..t...j...D.....
-00002420: 6402 1400 8301 1400 9302 7102 5300 2903  d.........q.S.).
-00002430: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
-00002440: 0006 0000 0013 0000 0073 2a00 0000 6700  .........s*...g.
-00002450: 7c00 5d11 7d01 8802 7c01 1900 8802 7c01  |.].}...|.....|.
-00002460: 8800 6a00 1700 1900 1800 8801 7c01 1900  ..j.........|...
-00002470: 1400 9102 7102 5300 721d 0000 0072 5c00  ....q.S.r....r\.
-00002480: 0000 723a 0000 0029 03da 0143 da02 6d75  ..r:...)...C..mu
-00002490: da06 706f 7765 7273 721d 0000 0072 1e00  ..powersr....r..
-000024a0: 0000 723e 0000 0022 0100 0073 0200 0000  ..r>..."...s....
-000024b0: 2a00 7a2d 6163 7469 6f6e 5f6f 6e5f 706f  *.z-action_on_po
-000024c0: 6c79 2e3c 6c6f 6361 6c73 3e2e 3c64 6963  ly.<locals>.<dic
-000024d0: 7463 6f6d 703e 2e3c 6c69 7374 636f 6d70  tcomp>.<listcomp
-000024e0: 3ef9 0000 0000 0000 0000 0000 0000 0000  >...............
-000024f0: f03f 2903 7241 0000 0072 1000 0000 720b  .?).rA...r....r.
-00002500: 0000 0029 0272 3b00 0000 7237 0000 00a9  ...).r;...r7....
-00002510: 0372 6400 0000 7263 0000 0072 6500 0000  .rd...rc...re...
-00002520: 2901 7266 0000 0072 1e00 0000 da0a 3c64  ).rf...r......<d
-00002530: 6963 7463 6f6d 703e 2201 0000 7302 0000  ictcomp>"...s...
-00002540: 003e 007a 2261 6374 696f 6e5f 6f6e 5f70  .>.z"action_on_p
-00002550: 6f6c 792e 3c6c 6f63 616c 733e 2e3c 6469  oly.<locals>.<di
-00002560: 6374 636f 6d70 3e29 0372 2300 0000 720b  ctcomp>).r#...r.
-00002570: 0000 0072 5b00 0000 2908 723f 0000 0072  ...r[...).r?...r
-00002580: 0b00 0000 7226 0000 0072 2700 0000 7228  ....r&...r'...r(
-00002590: 0000 0072 2900 0000 7231 0000 0072 5b00  ...r)...r1...r[.
-000025a0: 0000 7268 0000 0072 1d00 0000 7268 0000  ..rh...r....rh..
-000025b0: 0072 1e00 0000 da0e 6163 7469 6f6e 5f6f  .r......action_o
-000025c0: 6e5f 706f 6c79 0801 0000 7308 0000 0012  n_poly....s.....
-000025d0: 1920 0108 0106 ff72 6a00 0000 6300 0000  . .....rj...c...
-000025e0: 0000 0000 0000 0000 0004 0000 0007 0000  ................
-000025f0: 000f 0000 0073 3400 0000 8800 a000 6401  .....s4.......d.
-00002600: 7401 7c00 8301 a102 7d02 7402 7c00 6402  t.|.....}.t.|.d.
-00002610: 6403 7c02 6404 6405 8d05 7d03 8700 6601  d.|.d.d...}...f.
-00002620: 6406 6407 8408 7c03 4400 8301 5300 2908  d.d...|.D...S.).
-00002630: 619d 0200 000a 2020 2020 4f62 7461 696e  a.....    Obtain
-00002640: 2074 6865 2054 6179 6c6f 7220 6d61 7020   the Taylor map 
-00002650: 6672 6f6d 2061 2067 6976 656e 206a 6574  from a given jet
-00002660: 2065 7661 6c75 6174 696f 6e20 696e 2074   evaluation in t
-00002670: 6572 6d73 206f 6620 6c69 656f 7073 2e63  erms of lieops.c
-00002680: 6f72 652e 6c69 652e 706f 6c79 206f 626a  ore.lie.poly obj
-00002690: 6563 7473 2e0a 2020 2020 0a20 2020 2050  ects..    .    P
-000026a0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-000026b0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2065 7661  --------.    eva
-000026c0: 6c75 6174 696f 6e28 7329 3a0a 2020 2020  luation(s):.    
-000026d0: 2020 2020 6e2d 6a65 7420 6f62 6a65 6374      n-jet object
-000026e0: 7320 636f 6e74 6169 6e69 6e67 2070 6f6c  s containing pol
-000026f0: 796a 6574 206f 626a 6563 7473 2e0a 2020  yjet objects..  
-00002700: 2020 2020 2020 0a20 2020 2064 696d 323a        .    dim2:
-00002710: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
-00002720: 2020 2020 2020 2054 6865 2064 696d 656e         The dimen
-00002730: 7369 6f6e 206f 6620 7468 6520 646f 6d61  sion of the doma
-00002740: 696e 206f 6620 7468 6520 6576 616c 7561  in of the evalua
-00002750: 7469 6f6e 2e20 5468 6973 2069 7320 7265  tion. This is re
-00002760: 7175 6972 6564 0a20 2020 2020 2020 2074  quired.        t
-00002770: 6f20 636f 6e73 7472 7563 7420 7468 6520  o construct the 
-00002780: 302d 7475 706c 6573 2066 6f72 2074 6865  0-tuples for the
-00002790: 2063 6f6e 7374 616e 7473 2e0a 2020 2020   constants..    
-000027a0: 2020 2020 4174 7465 6e74 696f 6e3a 200a      Attention: .
-000027b0: 2020 2020 2020 2020 4966 2074 6869 7320          If this 
-000027c0: 7061 7261 6d65 7465 7220 6973 206e 6f74  parameter is not
-000027d0: 2070 726f 7669 6465 642c 2027 6469 6d32   provided, 'dim2
-000027e0: 2720 7769 6c6c 2062 6520 7461 6b65 6e20  ' will be taken 
-000027f0: 6672 6f6d 2074 6865 0a20 2020 2020 2020  from the.       
-00002800: 206e 756d 6265 7220 6f66 2069 6e70 7574   number of input
-00002810: 2065 7661 6c75 6174 696f 6e73 2e0a 2020   evaluations..  
-00002820: 2020 2020 2020 0a20 2020 202a 2a6b 7761        .    **kwa
-00002830: 7267 730a 2020 2020 2020 2020 5061 7261  rgs.        Para
-00002840: 6d65 7465 7273 2070 6173 7365 6420 746f  meters passed to
-00002850: 206c 6965 6f70 732e 636f 7265 2e6c 6965   lieops.core.lie
-00002860: 2e70 6f6c 792e 0a20 2020 2020 2020 200a  .poly..        .
-00002870: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-00002880: 2d2d 2d2d 2d2d 2d0a 2020 2020 6c69 7374  -------.    list
-00002890: 0a20 2020 2020 2020 2041 206c 6973 7420  .        A list 
-000028a0: 6f66 2070 6f6c 7920 6f62 6a65 6374 732c  of poly objects,
-000028b0: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
-000028c0: 6520 5461 796c 6f72 206d 6170 2e0a 2020  e Taylor map..  
-000028d0: 2020 7214 0000 0054 4672 0800 0000 2904    r....TFr....).
-000028e0: da08 6d75 6c74 5f70 726d da08 6d75 6c74  ..mult_prm..mult
-000028f0: 5f64 7276 da06 6e5f 6172 6773 da0d 6f75  _drv..n_args..ou
-00002900: 7470 7574 5f66 6f72 6d61 7463 0100 0000  tput_formatc....
-00002910: 0000 0000 0000 0000 0200 0000 0600 0000  ................
-00002920: 1300 0000 7324 0000 0067 007c 005d 0e7d  ....s$...g.|.].}
-00002930: 0174 006a 016a 026a 0364 0164 007c 0169  .t.j.j.j.d.d.|.i
-00002940: 0188 00a4 018e 0191 0271 0253 0029 0272  .........q.S.).r
-00002950: 2300 0000 721d 0000 0029 0472 2600 0000  #...r....).r&...
-00002960: 7227 0000 0072 2800 0000 7229 0000 00a9  r'...r(...r)....
-00002970: 0272 3b00 0000 da01 65a9 0172 2b00 0000  .r;.....e..r+...
-00002980: 721d 0000 0072 1e00 0000 723e 0000 003f  r....r....r>...?
-00002990: 0100 0073 0200 0000 2400 7a22 6765 745f  ...s....$.z"get_
-000029a0: 7461 796c 6f72 5f6d 6170 2e3c 6c6f 6361  taylor_map.<loca
-000029b0: 6c73 3e2e 3c6c 6973 7463 6f6d 703e 2903  ls>.<listcomp>).
-000029c0: 7211 0000 0072 3f00 0000 7203 0000 0029  r....r?...r....)
-000029d0: 04da 0a65 7661 6c75 6174 696f 6e72 2b00  ...evaluationr+.
-000029e0: 0000 726d 0000 00da 0274 6372 1d00 0000  ..rm.....tcr....
-000029f0: 7271 0000 0072 1e00 0000 da0e 6765 745f  rq...r......get_
-00002a00: 7461 796c 6f72 5f6d 6170 2501 0000 7306  taylor_map%...s.
-00002a10: 0000 0010 1812 0112 0172 7400 0000 4629  .........rt...F)
-00002a20: 02da 0870 6f73 6974 696f 6eda 0a74 6179  ...position..tay
-00002a30: 6c6f 725f 6d61 70da 056f 7264 6572 6300  lor_map..orderc.
-00002a40: 0000 0000 0000 0003 0000 0009 0000 0007  ................
-00002a50: 0000 000f 0000 0073 e600 0000 7400 8801  .......s....t...
-00002a60: 8301 6401 6b04 730a 4a00 6402 8301 8201  ..d.k.s.J.d.....
-00002a70: 8801 6401 1900 6a01 6a02 8900 7403 8700  ..d...j.j...t...
-00002a80: 6601 6403 6404 8408 8801 4400 8301 8301  f.d.d.....D.....
-00002a90: 731f 4a00 6405 8301 8201 8800 6406 1400  s.J.d.......d...
-00002aa0: 7d05 8701 6601 6407 6408 8408 7d06 7404  }...f.d.d...}.t.
-00002ab0: 7c06 7c05 7c01 6409 8d03 7d07 7400 7c00  |.|.|.d...}.t.|.
-00002ac0: 8301 6401 6b02 723a 640a 7c05 1400 7d00  ..d.k.r:d.|...}.
-00002ad0: 7c07 6a05 7c00 6900 7c04 a401 8e01 0100  |.j.|.i.|.......
-00002ae0: 6900 7d08 7c07 7c08 640b 3c00 7c04 a006  i.}.|.|.d.<.|...
-00002af0: a100 7c08 640c 3c00 7c00 7c08 640c 1900  ..|.d.<.|.|.d...
-00002b00: 640d 3c00 7c02 7c08 640c 1900 640e 3c00  d.<.|.|.d...d.<.
-00002b10: 7c01 7c08 640c 1900 640f 3c00 7c02 7271  |.|.d...d.<.|.rq
-00002b20: 7407 7c07 6a08 8800 7c04 a009 6410 7c01  t.|.j...|...d.|.
-00002b30: a102 6411 9c02 8e01 7c08 640e 3c00 7c08  ..d.....|.d.<.|.
-00002b40: 5300 2912 614a 0400 000a 2020 2020 5061  S.).aJ....    Pa
-00002b50: 7373 206e 2d6a 6574 7320 7468 726f 7567  ss n-jets throug
-00002b60: 6820 7468 6520 666c 6f77 2066 756e 6374  h the flow funct
-00002b70: 696f 6e73 206f 6620 6120 6368 6169 6e20  ions of a chain 
-00002b80: 6f66 204c 6965 2d6f 7065 7261 746f 7273  of Lie-operators
-00002b90: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-00002ba0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-00002bb0: 0a20 2020 202a 6f70 733a 206c 6965 6f70  .    *ops: lieop
-00002bc0: 6572 6174 6f72 2873 290a 2020 2020 2020  erator(s).      
-00002bd0: 2020 416e 206f 7065 7261 746f 7220 6f72    An operator or
-00002be0: 2061 206c 6973 7420 6f66 206f 7065 7261   a list of opera
-00002bf0: 746f 7273 2077 6869 6368 2073 686f 756c  tors which shoul
-00002c00: 6420 6265 2064 6572 6976 6564 2e20 496e  d be derived. In
-00002c10: 2063 6173 6520 6120 6c69 7374 0a20 2020   case a list.   
-00002c20: 2020 2020 2069 7320 6769 7665 6e2c 2074       is given, t
-00002c30: 6865 2066 6972 7374 2065 6c65 6d65 6e74  he first element
-00002c40: 206f 6620 7468 6520 6c69 7374 2077 696c   of the list wil
-00002c50: 6c20 6265 2063 616c 6c65 6420 6669 7273  l be called firs
-00002c60: 742e 0a20 2020 200a 2020 2020 706f 7369  t..    .    posi
-00002c70: 7469 6f6e 3a20 6c69 7374 0a20 2020 2020  tion: list.     
-00002c80: 2020 2041 6e20 6f70 7469 6f6e 616c 2070     An optional p
-00002c90: 6f69 6e74 206f 6620 7265 6665 7265 6e63  oint of referenc
-00002ca0: 652e 2042 7920 6465 6661 756c 7420 7468  e. By default th
-00002cb0: 6520 706f 7369 7469 6f6e 2077 696c 6c20  e position will 
-00002cc0: 6265 2074 6865 206f 7269 6769 6e2e 0a0a  be the origin...
-00002cd0: 2020 2020 6f72 6465 723a 2069 6e74 0a20      order: int. 
-00002ce0: 2020 2020 2020 2054 6865 206e 756d 6265         The numbe
-00002cf0: 7220 6f66 2064 6572 6976 6174 6976 6573  r of derivatives
-00002d00: 2077 6520 7761 6e74 2074 6f20 7461 6b65   we want to take
-00002d10: 2069 6e74 6f20 6163 636f 756e 742e 0a20   into account.. 
-00002d20: 2020 2020 2020 200a 2020 2020 7461 796c         .    tayl
-00002d30: 6f72 5f6d 6170 3a20 626f 6f6c 6561 6e2c  or_map: boolean,
-00002d40: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00002d50: 2020 4966 2074 7275 652c 2061 6c73 6f20    If true, also 
-00002d60: 636f 6d70 7574 6520 7468 6520 7461 796c  compute the tayl
-00002d70: 6f72 206d 6170 2e0a 0a20 2020 202a 2a6b  or map...    **k
-00002d80: 7761 7267 730a 2020 2020 2020 2020 4f70  wargs.        Op
-00002d90: 7469 6f6e 616c 206b 6579 776f 7264 6564  tional keyworded
-00002da0: 2061 7267 756d 656e 7473 2070 6173 7365   arguments passe
-00002db0: 6420 746f 206e 6a65 742e 6465 7269 7665  d to njet.derive
-00002dc0: 2063 6c61 7373 2028 616e 6420 7468 6572   class (and ther
-00002dd0: 6566 6f72 6520 7468 6520 756e 6465 726c  efore the underl
-00002de0: 7969 6e67 0a20 2020 2020 2020 206f 7065  ying.        ope
-00002df0: 7261 746f 7273 206f 6620 7468 6973 2062  rators of this b
-00002e00: 6561 6d6c 696e 6529 2e0a 2020 2020 2020  eamline)..      
-00002e10: 2020 0a20 2020 2052 6574 7572 6e73 0a20    .    Returns. 
-00002e20: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2064     -------.    d
-00002e30: 6963 740a 2020 2020 2020 2020 4120 6469  ict.        A di
-00002e40: 6374 696f 6e61 7279 2063 6f6e 7461 696e  ctionary contain
-00002e50: 696e 6720 7468 6520 7265 7375 6c74 7320  ing the results 
-00002e60: 6f66 2074 6865 2054 5053 4120 7275 6e2e  of the TPSA run.
-00002e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002e80: 2044 413a 206e 6a65 7420 6465 7269 7665   DA: njet derive
-00002e90: 206f 626a 6563 742c 2063 6f6e 7461 696e   object, contain
-00002ea0: 696e 6720 7468 6520 6a65 7420 6576 616c  ing the jet eval
-00002eb0: 7561 7469 6f6e 2072 6573 756c 7473 2e0a  uation results..
-00002ec0: 2020 2020 2020 2020 2020 2020 2069 6e70               inp
-00002ed0: 7574 3a20 5468 6520 696e 7075 7420 7061  ut: The input pa
-00002ee0: 7261 6d65 7465 7273 2075 7365 642e 0a20  rameters used.. 
-00002ef0: 2020 2020 2020 2074 6179 6c6f 725f 6d61         taylor_ma
-00002f00: 703a 2028 4f6e 6c79 2069 6620 7461 796c  p: (Only if tayl
-00002f10: 6f72 5f6d 6170 203d 3d20 5472 7565 2920  or_map == True) 
-00002f20: 4120 6c69 7374 206f 6620 706f 6c79 206f  A list of poly o
-00002f30: 626a 6563 7473 2c20 7265 7072 6573 656e  bjects, represen
-00002f40: 7469 6e67 2074 6865 2054 6179 6c6f 7220  ting the Taylor 
-00002f50: 6d61 7020 6f66 200a 2020 2020 2020 2020  map of .        
-00002f60: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-00002f70: 6769 7665 6e20 6f70 6572 6174 6f72 7320  given operators 
-00002f80: 6174 2027 706f 7369 7469 6f6e 272e 0a20  at 'position'.. 
-00002f90: 2020 2072 0100 0000 7a15 4e6f 206f 7065     r....z.No ope
-00002fa0: 7261 746f 7220 7072 6f76 6964 6564 2e63  rator provided.c
-00002fb0: 0100 0000 0000 0000 0000 0000 0200 0000  ................
-00002fc0: 0400 0000 1300 0000 7318 0000 0067 007c  ........s....g.|
-00002fd0: 005d 087d 017c 016a 006a 0188 006b 0291  .].}.|.j.j...k..
-00002fe0: 0271 0253 0072 1d00 0000 2902 da08 6172  .q.S.r....)...ar
-00002ff0: 6775 6d65 6e74 720b 0000 0029 0272 3b00  gumentr....).r;.
-00003000: 0000 da02 6f70 725c 0000 0072 1d00 0000  ....opr\...r....
-00003010: 721e 0000 0072 3e00 0000 6301 0000 7302  r....r>...c...s.
-00003020: 0000 0018 007a 1874 7073 612e 3c6c 6f63  .....z.tpsa.<loc
-00003030: 616c 733e 2e3c 6c69 7374 636f 6d70 3e7a  als>.<listcomp>z
-00003040: 264e 6f74 2061 6c6c 206f 7065 7261 746f  &Not all operato
-00003050: 7220 6469 6d65 6e73 696f 6e73 2061 7265  r dimensions are
-00003060: 2065 7175 616c 2e72 0500 0000 6300 0000   equal.r....c...
-00003070: 0000 0000 0000 0000 0003 0000 0005 0000  ................
-00003080: 001f 0000 0073 1c00 0000 8800 4400 5d09  .....s......D.].
-00003090: 7d02 7c02 7c00 6900 7c01 a401 8e01 7d00  }.|.|.i.|.....}.
-000030a0: 7102 7c00 5300 7260 0000 0072 1d00 0000  q.|.S.r`...r....
-000030b0: 2903 7261 0000 00da 076b 7761 7267 7331  ).ra.....kwargs1
-000030c0: 7279 0000 0029 01da 036f 7073 721d 0000  ry...)...opsr...
-000030d0: 0072 1e00 0000 da05 6368 6169 6e66 0100  .r......chainf..
-000030e0: 0073 0600 0000 0801 1001 0401 7a13 7470  .s..........z.tp
-000030f0: 7361 2e3c 6c6f 6361 6c73 3e2e 6368 6169  sa.<locals>.chai
-00003100: 6e29 0272 6d00 0000 7277 0000 0072 4e00  n).rm...rw...rN.
-00003110: 0000 da02 4441 da05 696e 7075 7472 7500  ....DA..inputru.
-00003120: 0000 7276 0000 0072 7700 0000 725b 0000  ..rv...rw...r[..
-00003130: 0029 0272 0b00 0000 725b 0000 0029 0a72  .).r....r[...).r
-00003140: 3f00 0000 7278 0000 0072 0b00 0000 da03  ?...rx...r......
-00003150: 616c 6c72 0200 0000 da04 6576 616c da04  allr......eval..
-00003160: 636f 7079 7274 0000 00da 0b5f 6576 616c  copyrt....._eval
-00003170: 7561 7469 6f6e 7211 0000 0029 0972 7500  uationr....).ru.
-00003180: 0000 7277 0000 0072 7600 0000 727b 0000  ..rw...rv...r{..
-00003190: 0072 2b00 0000 726d 0000 0072 7c00 0000  .r+...rm...r|...
-000031a0: da06 6463 6861 696e 7235 0000 0072 1d00  ..dchainr5...r..
-000031b0: 0000 2902 720b 0000 0072 7b00 0000 721e  ..).r....r{...r.
-000031c0: 0000 00da 0474 7073 6141 0100 0073 2400  .....tpsaA...s$.
-000031d0: 0000 1420 0c01 1e01 0801 0c02 0e05 0c01  ... ............
-000031e0: 0801 1001 0401 0801 0c01 0c01 0c01 0c01  ................
-000031f0: 0402 1e01 0402 7284 0000 0054 6303 0000  ......r....Tc...
-00003200: 0000 0000 0000 0000 000d 0000 000e 0000  ................
-00003210: 0043 0000 0073 1201 0000 7400 7c00 8301  .C...s....t.|...
-00003220: 7d03 7c03 6401 1600 6402 6b02 730e 4a00  }.|.d...d.k.s.J.
-00003230: 6403 8301 8201 7c03 6401 1a00 7d04 7401  d.....|.d...}.t.
-00003240: 6404 6405 8400 7c00 4400 8301 8301 7d05  d.d...|.D.....}.
-00003250: 6900 7d06 7c05 7402 6406 8301 6b02 7227  i.}.|.t.d...k.r'
-00003260: 7403 6407 8301 8201 7404 7c04 8301 4400  t.d.....t.|...D.
-00003270: 5d5b 7d07 7404 7c07 7c04 8302 4400 5d53  ][}.t.|.|...D.]S
-00003280: 7d08 7c00 7c07 1900 7c00 7c08 7c04 1700  }.|.|...|.|.|...
-00003290: 1900 1000 7d09 7c07 7c08 6b02 7246 7c09  ....}.|.|.k.rF|.
-000032a0: 6408 3700 7d09 7404 7c05 8301 4400 5d3a  d.7.}.t.|...D.]:
-000032b0: 7d0a 7405 7c09 a006 7c0a a101 8301 7d0b  }.t.|...|.....}.
-000032c0: 7400 7c0b 8301 6402 6b02 725a 714a 7401  t.|...d.k.rZqJt.
-000032d0: 7c0b 8301 7d0c 7c0c 7c01 6b04 7284 7401  |...}.|.|.k.r.t.
-000032e0: 7c06 a007 7c0a 6402 a102 7c0c 6702 8301  |...|.d...|.g...
-000032f0: 7c06 7c0a 3c00 7c02 7284 7408 a009 6409  |.|.<.|.r.t...d.
-00003300: 7c0a 9b00 640a 7c07 7c08 6602 9b00 640b  |...d.|.|.f...d.
-00003310: 7c0c 9b00 640c 7c01 9b00 640d 9d09 a101  |...d.|...d.....
-00003320: 0100 714a 7132 712b 7c06 5300 290e 6151  ..qJq2q+|.S.).aQ
-00003330: 0200 000a 2020 2020 4368 6563 6b20 7768  ....    Check wh
-00003340: 6574 6865 7220 6120 6769 7665 6e20 5461  ether a given Ta
-00003350: 796c 6f72 206d 6170 2c20 6465 7363 7269  ylor map, descri
-00003360: 6265 6420 6173 2061 2073 6574 206f 6620  bed as a set of 
-00003370: 4c69 652d 706f 6c79 6e6f 6d69 616c 732c  Lie-polynomials,
-00003380: 2064 6573 6372 6962 6573 2061 2073 796d   describes a sym
-00003390: 706c 6563 746f 6d6f 7270 6869 736d 2e0a  plectomorphism..
-000033a0: 2020 2020 0a20 2020 2050 6172 616d 6574      .    Paramet
-000033b0: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-000033c0: 2d2d 0a20 2020 2070 3a20 6c69 7374 206f  --.    p: list o
-000033d0: 6620 706f 6c79 206f 626a 6563 7473 0a20  f poly objects. 
-000033e0: 2020 2020 2020 2054 6865 2054 6179 6c6f         The Taylo
-000033f0: 7220 6d61 7020 746f 2062 6520 6368 6563  r map to be chec
-00003400: 6b65 642e 0a20 2020 2020 2020 200a 2020  ked..        .  
-00003410: 2020 746f 6c3a 2066 6c6f 6174 0a20 2020    tol: float.   
-00003420: 2020 2020 2054 6865 2074 6f6c 6572 616e       The toleran
-00003430: 6365 2061 6761 696e 7374 2074 6f20 6368  ce against to ch
-00003440: 6563 6b20 7468 6520 7265 6c61 7469 6f6e  eck the relation
-00003450: 3a0a 2020 2020 2020 2020 705b 695d 4070  :.        p[i]@p
-00003460: 5b6a 202b 2064 696d 5d20 3d20 2d31 6a2a  [j + dim] = -1j*
-00003470: 6465 6c74 615f 7b69 6a7d 0a20 2020 2020  delta_{ij}.     
-00003480: 2020 2069 6e20 616e 7920 6f72 6465 722e     in any order.
-00003490: 0a20 2020 2020 2020 200a 2020 2020 7761  .        .    wa
-000034a0: 726e 3a20 626f 6f6c 6561 6e2c 206f 7074  rn: boolean, opt
-000034b0: 696f 6e61 6c0a 2020 2020 2020 2020 4966  ional.        If
-000034c0: 2054 7275 652c 2072 6169 7365 2061 2077   True, raise a w
-000034d0: 6172 6e69 6e67 2065 7665 7279 2074 696d  arning every tim
-000034e0: 6520 7468 6520 6368 6563 6b20 6661 696c  e the check fail
-000034f0: 7320 6174 2073 6f6d 6520 7374 6570 2e0a  s at some step..
-00003500: 2020 2020 2020 2020 0a20 2020 2052 6574          .    Ret
-00003510: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
-00003520: 0a20 2020 2064 6963 740a 2020 2020 2020  .    dict.      
-00003530: 2020 4120 6469 6374 696f 6e61 7279 206d    A dictionary m
-00003540: 6170 7069 6e67 2074 6865 2070 6f77 6572  apping the power
-00003550: 7320 746f 2074 6865 206d 6178 696d 616c  s to the maximal
-00003560: 2065 7272 6f72 2077 6865 6e65 7665 7220   error whenever 
-00003570: 6120 6368 6563 6b20 6661 696c 6564 2e0a  a check failed..
-00003580: 2020 2020 7205 0000 0072 0100 0000 7a1e      r....r....z.
-00003590: 4469 6d65 6e73 696f 6e20 6f66 206d 6170  Dimension of map
-000035a0: 206d 7573 7420 6265 2065 7665 6e2e 6301   must be even.c.
-000035b0: 0000 0000 0000 0000 0000 0002 0000 0003  ................
-000035c0: 0000 0053 0000 0073 1200 0000 6700 7c00  ...S...s....g.|.
-000035d0: 5d05 7d01 7c01 6a00 9102 7102 5300 721d  ].}.|.j...q.S.r.
-000035e0: 0000 0029 0172 5b00 0000 726f 0000 0072  ...).r[...ro...r
-000035f0: 1d00 0000 721d 0000 0072 1e00 0000 723e  ....r....r....r>
-00003600: 0000 0094 0100 0073 0200 0000 1200 7a1c  .......s......z.
-00003610: 7379 6d63 6865 636b 2e3c 6c6f 6361 6c73  symcheck.<locals
-00003620: 3e2e 3c6c 6973 7463 6f6d 703e da03 696e  >.<listcomp>..in
-00003630: 667a 256d 6178 5f70 6f77 6572 206f 6620  fz%max_power of 
-00003640: 6d61 7020 6361 6e20 6e6f 7420 6265 2069  map can not be i
-00003650: 6e66 696e 6974 652e 7267 0000 007a 2354  nfinite.rg...z#T
-00003660: 6179 6c6f 7220 6d61 7020 6e6f 6e2d 7379  aylor map non-sy
-00003670: 6d70 6c65 6374 6963 2061 7420 6f72 6465  mplectic at orde
-00003680: 7220 7a10 2066 6f72 2063 6f6d 706f 6e65  r z. for compone
-00003690: 6e74 7320 7a09 2e20 4572 726f 723a 207a  nts z.. Error: z
-000036a0: 0720 2874 6f6c 3a20 fa01 2929 0a72 3f00  . (tol: ..)).r?.
-000036b0: 0000 da03 6d61 78da 0566 6c6f 6174 da0c  ....max..float..
-000036c0: 5275 6e74 696d 6545 7272 6f72 7210 0000  RuntimeErrorr...
-000036d0: 0072 2500 0000 7243 0000 0072 1100 0000  .r%...rC...r....
-000036e0: da08 7761 726e 696e 6773 da04 7761 726e  ..warnings..warn
-000036f0: 290d 7234 0000 0072 2a00 0000 728b 0000  ).r4...r*...r...
-00003700: 0072 1400 0000 720b 0000 0072 5b00 0000  .r....r....r[...
-00003710: da06 7265 7375 6c74 7236 0000 00da 016c  ..resultr6.....l
-00003720: da05 6368 6563 6b72 7700 0000 da0b 6368  ..checkrw.....ch
-00003730: 6563 6b5f 6f72 6465 72da 096d 6178 5f65  eck_order..max_e
-00003740: 7272 6f72 721d 0000 0072 1d00 0000 721e  rrorr....r....r.
-00003750: 0000 00da 0873 796d 6368 6563 6b7b 0100  .....symcheck{..
-00003760: 0073 3200 0000 0816 1401 0801 1201 0401  .s2.............
-00003770: 0c01 0801 0c02 0e01 1401 0801 0801 0c02  ................
-00003780: 0e05 0c01 0201 0801 0801 1801 0401 2801  ..............(.
-00003790: 0280 02f4 02fb 0413 7291 0000 0029 0272  ........r....).r
-000037a0: 0100 0000 7220 0000 0029 0154 2919 da05  ....r ...).T)...
-000037b0: 6e75 6d70 7972 0d00 0000 728a 0000 00da  numpyr....r.....
-000037c0: 046e 6a65 7472 0200 0000 7203 0000 005a  .njetr....r....Z
-000037d0: 0f6c 6965 6f70 732e 636f 7265 2e6c 6965  .lieops.core.lie
-000037e0: 7226 0000 00da 146c 6965 6f70 732e 6c69  r&.....lieops.li
-000037f0: 6e61 6c67 2e6d 6174 7269 7872 0400 0000  nalg.matrixr....
-00003800: 721f 0000 0072 3000 0000 7238 0000 0072  r....r0...r8...r
-00003810: 4200 0000 7249 0000 0072 4d00 0000 7253  B...rI...rM...rS
-00003820: 0000 0072 5600 0000 725a 0000 0072 5f00  ...rV...rZ...r_.
-00003830: 0000 726a 0000 0072 7400 0000 da03 696e  ..rj...rt.....in
-00003840: 7472 8400 0000 7291 0000 0072 1d00 0000  tr....r....r....
-00003850: 721d 0000 0072 1d00 0000 721e 0000 00da  r....r....r.....
-00003860: 083c 6d6f 6475 6c65 3e01 0000 0073 2600  .<module>....s&.
-00003870: 0000 0801 0801 1002 0802 0c01 0802 0a36  ...............6
-00003880: 0848 080d 0809 082b 0816 080b 0e0a 080c  .H.....+........
-00003890: 1208 081d 161c 0e3a                      .......:
+00000050: 6403 6c06 6d07 5a07 0100 6400 6401 6c08  d.l.m.Z...d.d.l.
+00000060: 5a09 6400 6404 6c0a 6d0b 5a0b 0100 6405  Z.d.d.l.m.Z...d.
+00000070: 6406 8400 5a0c 6429 6408 6409 8401 5a0d  d...Z.d)d.d...Z.
+00000080: 640a 640b 8400 5a0e 640c 640d 8400 5a0f  d.d...Z.d.d...Z.
+00000090: 640e 640f 8400 5a10 6410 6411 8400 5a11  d.d...Z.d.d...Z.
+000000a0: 6412 6413 8400 5a12 6414 6415 8400 5a13  d.d...Z.d.d...Z.
+000000b0: 6407 6416 9c01 6417 6418 8402 5a14 6419  d.d...d.d...Z.d.
+000000c0: 641a 8400 5a15 641b 641c 8400 641d 9c01  d...Z.d.d...d...
+000000d0: 641e 641f 8402 5a16 6420 6421 8400 5a17  d.d...Z.d d!..Z.
+000000e0: 6700 6401 6422 6423 9c03 6424 6425 8402  g.d.d"d#..d$d%..
+000000f0: 5a18 642a 6427 6428 8401 5a19 6401 5300  Z.d*d'd(..Z.d.S.
+00000100: 292b e900 0000 004e 2902 da06 6465 7269  )+.....N)...deri
+00000110: 7665 da13 7461 796c 6f72 5f63 6f65 6666  ve..taylor_coeff
+00000120: 6963 6965 6e74 7329 01da 0763 6465 7269  icients)...cderi
+00000130: 7665 2901 da08 6372 6561 7465 5f4a 6301  ve)...create_Jc.
+00000140: 0000 0000 0000 0000 0000 000d 0000 0007  ................
+00000150: 0000 0043 0000 0073 da01 0000 7c00 a000  ...C...s....|...
+00000160: a100 6401 6b02 720c 7c00 a001 a100 6401  ..d.k.r.|.....d.
+00000170: 6b02 730e 4a00 8201 7c00 6a02 7d01 7c01  k.s.J...|.j.}.|.
+00000180: 6401 1400 7d02 7c00 6a03 7d03 7404 7405  d...}.|.j.}.t.t.
+00000190: 7c00 8301 8301 7d04 7406 7c04 6402 8302  |.....}.t.|.d...
+000001a0: 7239 7407 6a08 7c02 7c02 6702 7409 7c04  r9t.j.|.|.g.t.|.
+000001b0: 6a0a 8301 1700 7407 6a0b 6403 8d02 7d05  j.....t.j.d...}.
+000001c0: 7407 a008 7c04 6a0a a101 7d06 6e0c 7407  t...|.j...}.n.t.
+000001d0: 6a08 7c02 7c02 6702 7407 6a0b 6403 8d02  j.|.|.g.t.j.d...
+000001e0: 7d05 6404 7d06 740c 7c01 8301 4400 5da1  }.d.}.t.|...D.].
+000001f0: 7d07 740c 7c01 8301 4400 5d9a 7d08 6404  }.t.|...D.].}.d.
+00000200: 6701 7c02 1400 7d09 7c09 7c07 0500 1900  g.|...}.|.|.....
+00000210: 6405 3700 0300 3c00 7c09 7c08 7c01 1700  d.7...<.|.|.|...
+00000220: 0500 1900 6405 3700 0300 3c00 7c00 a00d  ....d.7...<.|...
+00000230: 740e 7c09 8301 7c06 a102 7c03 0b00 1400  t.|...|...|.....
+00000240: 7c05 7c07 7c08 6406 6603 3c00 7c00 a00d  |.|.|.d.f.<.|...
+00000250: 740e 7c09 8301 7c06 a102 7c03 1400 7c05  t.|...|...|...|.
+00000260: 7c08 7c01 1700 7c07 7c01 1700 6406 6603  |.|...|.|...d.f.
+00000270: 3c00 7c07 7c08 6b03 7292 6405 7d0a 6e02  <.|.|.k.r.d.}.n.
+00000280: 6401 7d0a 6404 6701 7c02 1400 7d0b 7c0b  d.}.d.g.|...}.|.
+00000290: 7c07 0500 1900 6405 3700 0300 3c00 7c0b  |.....d.7...<.|.
+000002a0: 7c08 0500 1900 6405 3700 0300 3c00 7c00  |.....d.7...<.|.
+000002b0: a00d 740e 7c0b 8301 7c06 a102 7c03 1400  ..t.|...|...|...
+000002c0: 7c0a 1400 7c05 7c07 7c08 7c01 1700 6406  |...|.|.|.|...d.
+000002d0: 6603 3c00 6404 6701 7c02 1400 7d0c 7c0c  f.<.d.g.|...}.|.
+000002e0: 7c07 7c01 1700 0500 1900 6405 3700 0300  |.|.......d.7...
+000002f0: 3c00 7c0c 7c08 7c01 1700 0500 1900 6405  <.|.|.|.......d.
+00000300: 3700 0300 3c00 7c00 a00d 740e 7c0c 8301  7...<.|...t.|...
+00000310: 7c06 a102 7c03 0b00 1400 7c0a 1400 7c05  |...|.....|...|.
+00000320: 7c07 7c01 1700 7c08 6406 6603 3c00 714f  |.|...|.d.f.<.qO
+00000330: 7149 7c05 5300 2907 61ea 0200 000a 2020  qI|.S.).a.....  
+00000340: 2020 436f 6d70 7574 6520 6120 2832 6e29    Compute a (2n)
+00000350: 7828 326e 292d 6d61 7472 6978 2072 6570  x(2n)-matrix rep
+00000360: 7265 7365 6e74 6174 696f 6e20 6f66 2061  resentation of a
+00000370: 2068 6f6d 6f67 656e 6f75 7320 7365 636f   homogenous seco
+00000380: 6e64 2d6f 7264 6572 2070 6f6c 796e 6f6d  nd-order polynom
+00000390: 6961 6c20 412c 0a20 2020 2073 6f20 7468  ial A,.    so th
+000003a0: 6174 2069 6620 7a5f 6a20 6465 6e6f 7465  at if z_j denote
+000003b0: 7320 7468 6520 7072 6f6a 6563 7469 6f6e  s the projection
+000003c0: 7320 6f6e 746f 2074 6865 2063 616e 6f6e  s onto the canon
+000003d0: 6963 616c 2063 6f6f 7264 696e 6174 6520  ical coordinate 
+000003e0: 636f 6d70 6f6e 656e 7473 2c20 7468 656e  components, then
+000003f0: 0a20 2020 200a 2020 2020 7b41 2c20 7a5f  .    .    {A, z_
+00000400: 6a7d 203d 2041 5f7b 696a 7d20 7a5f 6920  j} = A_{ij} z_i 
+00000410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000420: 2020 2028 3129 0a20 2020 200a 2020 2020     (1).    .    
+00000430: 686f 6c64 732e 2054 6865 2062 7261 636b  holds. The brack
+00000440: 6574 7320 7b20 2c20 7d20 6465 6e6f 7465  ets { , } denote
+00000450: 2074 6865 2070 6f69 7373 6f6e 2062 7261   the poisson bra
+00000460: 636b 6574 2e20 5468 6520 7661 6c75 6573  cket. The values
+00000470: 2041 5f7b 696a 7d20 7769 6c6c 2062 6520   A_{ij} will be 
+00000480: 6465 7465 726d 696e 6564 2e0a 2020 2020  determined..    
+00000490: 0a20 2020 2052 656d 6172 6b3a 2054 6865  .    Remark: The
+000004a0: 206f 7264 6572 206f 6620 7468 6520 696e   order of the in
+000004b0: 6469 6365 7320 696e 2045 712e 2028 3129  dices in Eq. (1)
+000004c0: 2068 6173 2062 6565 6e20 6368 6f73 656e   has been chosen
+000004d0: 2074 6f20 6775 6172 616e 7465 6520 7468   to guarantee th
+000004e0: 6174 206d 6174 7269 7820 6d75 6c74 6970  at matrix multip
+000004f0: 6c69 6361 7469 6f6e 0a20 2020 2020 2020  lication.       
+00000500: 2020 2020 2061 6e64 2061 646a 6f69 6e74       and adjoint
+00000510: 2062 6f74 6820 6d61 696e 7461 696e 2074   both maintain t
+00000520: 6865 2073 616d 6520 6f72 6465 723a 0a20  he same order:. 
+00000530: 2020 2020 2020 2020 2020 207b 412c 207b             {A, {
+00000540: 422c 207a 5f6a 7d7d 203d 2028 4120 6f20  B, z_j}} = (A o 
+00000550: 4229 5f7b 696a 7d20 7a5f 690a 2020 2020  B)_{ij} z_i.    
+00000560: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+00000570: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00000580: 2020 2070 696e 3a20 706f 6c79 0a20 2020     pin: poly.   
+00000590: 2020 2020 2054 6865 2070 6f6c 796e 6f6d       The polynom
+000005a0: 6961 6c20 746f 2062 6520 636f 6e76 6572  ial to be conver
+000005b0: 7465 642e 0a20 2020 2020 2020 200a 2020  ted..        .  
+000005c0: 2020 5265 7475 726e 730a 2020 2020 2d2d    Returns.    --
+000005d0: 2d2d 2d2d 2d0a 2020 2020 6172 7261 792d  -----.    array-
+000005e0: 6c69 6b65 0a20 2020 2020 2020 2041 2063  like.        A c
+000005f0: 6f6d 706c 6578 206d 6174 7269 7820 636f  omplex matrix co
+00000600: 7272 6573 706f 6e64 696e 6720 746f 2074  rresponding to t
+00000610: 6865 2072 6570 7265 7365 6e74 6174 696f  he representatio
+00000620: 6e2e 0a20 2020 20e9 0200 0000 da05 7368  n..    .......sh
+00000630: 6170 65a9 01da 0564 7479 7065 7201 0000  ape....dtyper...
+00000640: 00e9 0100 0000 2e29 0fda 066d 6178 6465  .......)...maxde
+00000650: 67da 066d 696e 6465 67da 0364 696d da0f  g..mindeg..dim..
+00000660: 5f70 6f69 7373 6f6e 5f66 6163 746f 72da  _poisson_factor.
+00000670: 046e 6578 74da 0469 7465 72da 0768 6173  .next..iter..has
+00000680: 6174 7472 da02 6e70 da05 7a65 726f 73da  attr..np..zeros.
+00000690: 046c 6973 7472 0700 0000 da0a 636f 6d70  .listr......comp
+000006a0: 6c65 7831 3238 da05 7261 6e67 65da 0367  lex128..range..g
+000006b0: 6574 da05 7475 706c 6529 0dda 0370 696e  et..tuple)...pin
+000006c0: 720d 0000 00da 0464 696d 32da 0e70 6f69  r......dim2..poi
+000006d0: 7373 6f6e 5f66 6163 746f 72da 0476 616c  sson_factor..val
+000006e0: 30da 0141 da04 7a65 726f da01 69da 016a  0..A..zero..i..j
+000006f0: da09 6d69 7865 645f 6b65 79da 0266 66da  ..mixed_key..ff.
+00000700: 0a68 6f6d 5f6b 6579 5f78 69da 0b68 6f6d  .hom_key_xi..hom
+00000710: 5f6b 6579 5f65 7461 a900 7225 0000 00fa  _key_eta..r%....
+00000720: 522f 686f 6d65 2f6d 616c 7465 2f6d 696e  R/home/malte/min
+00000730: 6963 6f6e 6461 332f 656e 7673 2f77 6f72  iconda3/envs/wor
+00000740: 6b2f 6c69 622f 7079 7468 6f6e 332e 3130  k/lib/python3.10
+00000750: 2f73 6974 652d 7061 636b 6167 6573 2f6c  /site-packages/l
+00000760: 6965 6f70 732f 636f 7265 2f74 6f6f 6c73  ieops/core/tools
+00000770: 2e70 79da 0770 6f6c 7932 6164 0b00 0000  .py..poly2ad....
+00000780: 733c 0000 001c 1706 0108 0106 010c 030a  s<..............
+00000790: 011e 010e 0114 0204 010c 020c 010a 0110  ................
+000007a0: 0114 0120 0126 0108 0206 0304 020a 0210  ... .&..........
+000007b0: 0110 0126 010a 0214 0114 012a 0102 ea04  ...&.......*....
+000007c0: 1772 2700 0000 f900 0000 0000 0000 8000  .r'.............
+000007d0: 0000 0000 00f0 bf63 0300 0000 0000 0000  .......c........
+000007e0: 0000 0000 1100 0000 0800 0000 4b00 0000  ............K...
+000007f0: 7356 0200 007c 006a 0064 0119 007c 006a  sV...|.j.d...|.j
+00000800: 0064 0219 006b 0273 0c4a 0082 017c 006a  .d...k.s.J...|.j
+00000810: 0064 0119 007d 047c 0464 0316 0064 016b  .d...}.|.d...d.k
+00000820: 0273 194a 0082 017c 0464 031a 007d 0569  .s.J...|.d...}.i
+00000830: 007d 0674 017c 0583 0144 005d f97d 0774  .}.t.|...D.].}.t
+00000840: 017c 0583 0144 005d f27d 087c 0164 016b  .|...D.].}.|.d.k
+00000850: 0472 9d7c 009b 0064 047c 019b 0064 059d  .r.|...d.|...d..
+00000860: 047d 0974 027c 007c 077c 0866 0219 007c  .}.t.|.|.|.f...|
+00000870: 007c 087c 0517 007c 077c 0517 0066 0219  .|.|...|.|...f..
+00000880: 0017 0083 017d 0a74 027c 007c 077c 087c  .....}.t.|.|.|.|
+00000890: 0517 0066 0219 007c 007c 087c 077c 0517  ...f...|.|.|.|..
+000008a0: 0066 0219 0018 0083 017d 0b74 027c 007c  .f.......}.t.|.|
+000008b0: 077c 0517 007c 0866 0219 007c 007c 087c  .|...|.f...|.|.|
+000008c0: 0517 007c 0766 0219 0018 0083 017d 0c7c  ...|.f.......}.|
+000008d0: 0a7c 016b 00a0 03a1 0073 7d4a 007c 0964  .|.k.....s}J.|.d
+000008e0: 067c 0a9b 0064 059d 0317 0083 0182 017c  .|...d.........|
+000008f0: 0b7c 016b 00a0 03a1 0073 8d4a 007c 0964  .|.k.....s.J.|.d
+00000900: 067c 0b9b 0064 059d 0317 0083 0182 017c  .|...d.........|
+00000910: 0c7c 016b 00a0 03a1 0073 9d4a 007c 0964  .|.k.....s.J.|.d
+00000920: 067c 0c9b 0064 059d 0317 0083 0182 0164  .|...d.........d
+00000930: 0167 017c 0414 007d 0d7c 0d7c 0705 0019  .g.|...}.|.|....
+00000940: 0064 0237 0003 003c 007c 0d7c 087c 0517  .d.7...<.|.|.|..
+00000950: 0005 0019 0064 0237 0003 003c 007c 007c  .....d.7...<.|.|
+00000960: 077c 0866 0219 0064 0714 007c 021b 007c  .|.f...d...|...|
+00000970: 0674 047c 0d83 013c 007c 077c 086b 0372  .t.|...<.|.|.k.r
+00000980: c964 027d 0e6e 0264 037d 0e64 0167 017c  .d.}.n.d.}.d.g.|
+00000990: 0414 007d 0f7c 0f7c 0705 0019 0064 0237  ...}.|.|.....d.7
+000009a0: 0003 003c 007c 0f7c 0805 0019 0064 0237  ...<.|.|.....d.7
+000009b0: 0003 003c 007c 007c 077c 087c 0517 0066  ...<.|.|.|.|...f
+000009c0: 0219 007c 0e1b 007c 021b 007c 0674 047c  ...|...|...|.t.|
+000009d0: 0f83 013c 0064 0167 017c 0414 007d 107c  ...<.d.g.|...}.|
+000009e0: 107c 077c 0517 0005 0019 0064 0237 0003  .|.|.......d.7..
+000009f0: 003c 007c 107c 087c 0517 0005 0019 0064  .<.|.|.|.......d
+00000a00: 0237 0003 003c 007c 007c 077c 0517 007c  .7...<.|.|.|...|
+00000a10: 0866 0219 007c 0e1b 0064 0714 007c 021b  .f...|...d...|..
+00000a20: 007c 0674 047c 1083 013c 0071 2971 2374  .|.t.|...<.q)q#t
+00000a30: 056a 066a 076a 0864 0a7c 067c 057c 0264  .j.j.j.d.|.|.|.d
+00000a40: 089c 037c 03a4 018e 0153 0029 0b61 9d04  ...|.....S.).a..
+00000a50: 0000 0a20 2020 2054 7261 6e73 666f 726d  ...    Transform
+00000a60: 2061 2063 6f6d 706c 6578 2028 326e 2978   a complex (2n)x
+00000a70: 2832 6e29 2d6d 6174 7269 7820 7265 7072  (2n)-matrix repr
+00000a80: 6573 656e 7461 7469 6f6e 206f 6620 6120  esentation of a 
+00000a90: 706f 6c79 6e6f 6d69 616c 2062 6163 6b20  polynomial back 
+00000aa0: 746f 200a 2020 2020 6974 7320 706f 6c79  to .    its poly
+00000ab0: 6e6f 6d69 616c 2078 692f 6574 612d 7265  nomial xi/eta-re
+00000ac0: 7072 6573 656e 7461 7469 6f6e 2e20 5468  presentation. Th
+00000ad0: 6973 2069 7320 7468 6520 696e 7665 7273  is is the invers
+00000ae0: 6520 6f66 2074 6865 2027 706f 6c79 3261  e of the 'poly2a
+00000af0: 6427 2072 6f75 7469 6e65 2e0a 2020 2020  d' routine..    
+00000b00: 0a20 2020 2041 7474 656e 7469 6f6e 3a20  .    Attention: 
+00000b10: 4120 6d61 7472 6978 2061 646d 6974 7320  A matrix admits 
+00000b20: 6120 706f 6c79 6e6f 6d69 616c 2072 6570  a polynomial rep
+00000b30: 7265 7365 6e74 6174 696f 6e20 6966 2061  resentation if a
+00000b40: 6e64 206f 6e6c 7920 6966 2069 7420 6973  nd only if it is
+00000b50: 2061 6e20 656c 656d 656e 740a 2020 2020   an element.    
+00000b60: 2020 2020 2020 2020 2020 206f 6620 7370             of sp
+00000b70: 2832 6e3b 2043 292c 2074 6865 204c 6965  (2n; C), the Lie
+00000b80: 2d61 6c67 6562 7261 206f 6620 7379 6d70  -algebra of symp
+00000b90: 6c65 6374 6963 2063 6f6d 706c 6578 2028  lectic complex (
+00000ba0: 326e 2978 2832 6e29 2d6d 6174 7269 6365  2n)x(2n)-matrice
+00000bb0: 732e 2042 7920 6465 6661 756c 740a 2020  s. By default.  
+00000bc0: 2020 2020 2020 2020 2020 2020 2074 6869               thi
+00000bd0: 7320 726f 7574 696e 6520 7769 6c6c 202a  s routine will *
+00000be0: 6e6f 742a 2063 6865 636b 2061 6761 696e  not* check again
+00000bf0: 7374 2074 6869 7320 7072 6f70 6572 7479  st this property
+00000c00: 2028 6275 7420 7365 6520 7468 6520 696e   (but see the in
+00000c10: 666f 726d 6174 696f 6e20 6265 6c6f 7729  formation below)
+00000c20: 2e0a 2020 2020 0a20 2020 2050 6172 616d  ..    .    Param
+00000c30: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
+00000c40: 2d2d 2d2d 0a20 2020 2041 3a20 6172 7261  ----.    A: arra
+00000c50: 792d 6c69 6b65 0a20 2020 2020 2020 204d  y-like.        M
+00000c60: 6174 7269 7820 7265 7072 6573 656e 7469  atrix representi
+00000c70: 6e67 2074 6865 2070 6f6c 796e 6f6d 6961  ng the polynomia
+00000c80: 6c2e 0a20 2020 2020 2020 200a 2020 2020  l..        .    
+00000c90: 746f 6c3a 2066 6c6f 6174 2c20 6f70 7469  tol: float, opti
+00000ca0: 6f6e 616c 0a20 2020 2020 2020 2041 2074  onal.        A t
+00000cb0: 6f6c 6572 616e 6365 2074 6f20 6368 6563  olerance to chec
+00000cc0: 6b20 6120 7375 6666 6963 6965 6e74 2070  k a sufficient p
+00000cd0: 726f 7065 7274 7920 6f66 2074 6865 2067  roperty of the g
+00000ce0: 6976 656e 206d 6174 7269 7820 746f 2062  iven matrix to b
+00000cf0: 6520 6120 7661 6c69 6420 7265 7072 6573  e a valid repres
+00000d00: 656e 7461 7469 6f6e 2e0a 2020 2020 2020  entation..      
+00000d10: 2020 4e6f 2063 6865 636b 2077 696c 6c20    No check will 
+00000d20: 6265 206d 6164 6520 6966 2027 746f 6c27  be made if 'tol'
+00000d30: 2069 7320 7a65 726f 2028 6465 6661 756c   is zero (defaul
+00000d40: 7429 2e0a 2020 2020 2020 2020 0a20 2020  t)..        .   
+00000d50: 2070 6f69 7373 6f6e 5f66 6163 746f 723a   poisson_factor:
+00000d60: 2063 6f6d 706c 6578 2c20 6f70 7469 6f6e   complex, option
+00000d70: 616c 0a20 2020 2020 2020 2041 2066 6163  al.        A fac
+00000d80: 746f 7220 6465 6669 6e69 6e67 2074 6865  tor defining the
+00000d90: 2070 6f69 7373 6f6e 2073 7472 7563 7475   poisson structu
+00000da0: 7265 206f 6620 7468 6520 736f 7567 6874  re of the sought
+00000db0: 2070 6f6c 796e 6f6d 6961 6c2e 2042 7920   polynomial. By 
+00000dc0: 6465 6661 756c 7420 7468 6973 2066 6163  default this fac
+00000dd0: 746f 720a 2020 2020 2020 2020 6973 202d  tor.        is -
+00000de0: 316a 2c20 636f 7272 6573 706f 6e64 696e  1j, correspondin
+00000df0: 6720 746f 2074 6865 2070 6f69 7373 6f6e  g to the poisson
+00000e00: 2073 7472 7563 7475 7265 206f 6620 7468   structure of th
+00000e10: 6520 636f 6d70 6c65 7820 7869 2f65 7461  e complex xi/eta
+00000e20: 2063 6f6f 7264 696e 6174 6573 2e0a 2020   coordinates..  
+00000e30: 2020 2020 2020 0a20 2020 202a 2a6b 7761        .    **kwa
+00000e40: 7267 730a 2020 2020 2020 2020 4f70 7469  rgs.        Opti
+00000e50: 6f6e 616c 206b 6579 776f 7264 6564 2061  onal keyworded a
+00000e60: 7267 756d 656e 7473 2070 6173 7365 6420  rguments passed 
+00000e70: 746f 206c 6965 6f70 732e 636f 7265 2e6c  to lieops.core.l
+00000e80: 6965 2e70 6f6c 7920 726f 7574 696e 652e  ie.poly routine.
+00000e90: 0a20 2020 2020 2020 200a 2020 2020 5265  .        .    Re
+00000ea0: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
+00000eb0: 2d0a 2020 2020 706f 6c79 0a20 2020 2020  -.    poly.     
+00000ec0: 2020 2050 6f6c 796e 6f6d 6961 6c20 636f     Polynomial co
+00000ed0: 7272 6573 706f 6e64 696e 6720 746f 2074  rresponding to t
+00000ee0: 6865 206d 6174 7269 782e 0a20 2020 2072  he matrix..    r
+00000ef0: 0100 0000 720a 0000 0072 0600 0000 7a4f  ....r....r....zO
+00000f00: 0a4d 6174 7269 7820 6e6f 7420 696e 2073  .Matrix not in s
+00000f10: 7028 326e 3b20 4329 2c20 7468 6520 4c69  p(2n; C), the Li
+00000f20: 652d 616c 6765 6272 6120 6f66 2063 6f6d  e-algebra of com
+00000f30: 706c 6578 2073 796d 706c 6563 7469 6320  plex symplectic 
+00000f40: 6d61 7472 6963 6573 2028 746f 6c3a 207a  matrices (tol: z
+00000f50: 0229 2efa 0128 e9ff ffff ff29 03da 0676  .)...(.....)...v
+00000f60: 616c 7565 7372 0d00 0000 721b 0000 004e  aluesr....r....N
+00000f70: 7225 0000 0029 0972 0700 0000 7216 0000  r%...).r....r...
+00000f80: 00da 0361 6273 da03 616c 6c72 1800 0000  ...abs..allr....
+00000f90: da06 6c69 656f 7073 da04 636f 7265 da03  ..lieops..core..
+00000fa0: 6c69 65da 0470 6f6c 7929 1172 1d00 0000  lie..poly).r....
+00000fb0: da03 746f 6c72 1b00 0000 da06 6b77 6172  ..tolr......kwar
+00000fc0: 6773 721a 0000 0072 0d00 0000 722b 0000  gsr....r....r+..
+00000fd0: 0072 1f00 0000 7220 0000 00da 0965 7272  .r....r .....err
+00000fe0: 6f72 5f6d 7367 da02 6331 da02 6332 da02  or_msg..c1..c2..
+00000ff0: 6333 7221 0000 0072 2200 0000 7223 0000  c3r!...r"...r#..
+00001000: 0072 2400 0000 7225 0000 0072 2500 0000  .r$...r%...r%...
+00001010: 7226 0000 00da 0761 6432 706f 6c79 4a00  r&.....ad2polyJ.
+00001020: 0000 7340 0000 0018 1e0a 0110 0108 0104  ..s@............
+00001030: 020c 010c 0108 0210 0324 0124 0124 0120  .........$.$.$. 
+00001040: 0120 0120 010a 0210 0114 011c 0108 0306  . . ............
+00001050: 0104 020a 0210 0110 0120 010a 0214 0114  ......... ......
+00001060: 0126 0102 e01c 2172 3800 0000 6301 0000  .&....!r8...c...
+00001070: 0000 0000 0000 0000 0008 0000 0004 0000  ................
+00001080: 0043 0000 0073 9600 0000 7c00 a000 a100  .C...s....|.....
+00001090: 6401 6b02 720c 7c00 a001 a100 6401 6b02  d.k.r.|.....d.k.
+000010a0: 730e 4a00 8201 7c00 6a02 7d01 7403 7404  s.J...|.j.}.t.t.
+000010b0: 7c00 8301 8301 7d02 7405 7c02 6402 8302  |.....}.t.|.d...
+000010c0: 7226 7406 6a07 7c02 6a08 7406 6a09 6403  r&t.j.|.j.t.j.d.
+000010d0: 8d02 7d03 6e02 6404 7d03 7c03 6701 7c01  ..}.n.d.}.|.g.|.
+000010e0: 1400 6405 1400 7d04 7c00 a00a a100 4400  ..d...}.|.....D.
+000010f0: 5d0f 5c02 7d05 7d06 740b 7c05 8301 a00c  ].\.}.}.t.|.....
+00001100: 6401 a101 7d07 7c06 7c04 7c07 3c00 7133  d...}.|.|.|.<.q3
+00001110: 7406 6a0d 7c04 7406 6a09 6403 8d02 5300  t.j.|.t.j.d...S.
+00001120: 2906 7a7a 0a20 2020 204d 6170 2061 2066  ).zz.    Map a f
+00001130: 6972 7374 2d6f 7264 6572 2070 6f6c 796e  irst-order polyn
+00001140: 6f6d 6961 6c20 746f 2069 7473 2072 6573  omial to its res
+00001150: 7065 6374 6976 6520 7665 6374 6f72 2069  pective vector i
+00001160: 6e20 6d61 7472 6978 2072 6570 7265 7365  n matrix represe
+00001170: 6e74 6174 696f 6e20 0a20 2020 2028 7365  ntation .    (se
+00001180: 6520 616c 736f 2027 706f 6c79 3261 6427  e also 'poly2ad'
+00001190: 2072 6f75 7469 6e65 290a 2020 2020 720a   routine).    r.
+000011a0: 0000 0072 0700 0000 7208 0000 0072 0100  ...r....r....r..
+000011b0: 0000 7206 0000 0029 0e72 0b00 0000 720c  ..r....).r....r.
+000011c0: 0000 0072 0d00 0000 720f 0000 0072 1000  ...r....r....r..
+000011d0: 0000 7211 0000 0072 1200 0000 7213 0000  ..r....r....r...
+000011e0: 0072 0700 0000 7215 0000 00da 0569 7465  .r....r......ite
+000011f0: 6d73 7214 0000 00da 0569 6e64 6578 da05  msr......index..
+00001200: 6172 7261 7929 08da 0170 720d 0000 00da  array)...pr.....
+00001210: 0276 3072 1300 0000 da03 6f75 74da 016b  .v0r......out..k
+00001220: da01 7672 2000 0000 7225 0000 0072 2500  ..vr ...r%...r%.
+00001230: 0000 7226 0000 00da 0870 6f6c 7932 7665  ..r&.....poly2ve
+00001240: 6392 0000 0073 1600 0000 1c05 0601 0c03  c....s..........
+00001250: 0a01 1401 0402 0e02 1001 0e01 0a01 1002  ................
+00001260: 7241 0000 0063 0100 0000 0000 0000 0000  rA...c..........
+00001270: 0000 0200 0000 0400 0000 0300 0000 734a  ..............sJ
+00001280: 0000 0074 0088 0083 017d 017c 0164 0116  ...t.....}.|.d..
+00001290: 0064 026b 0273 0e4a 0064 0383 0182 0174  .d.k.s.J.d.....t
+000012a0: 016a 026a 03a0 047c 0164 011a 00a1 0189  .j.j...|.d......
+000012b0: 0174 0587 0087 0166 0264 0464 0584 0874  .t.....f.d.d...t
+000012c0: 067c 0183 0144 0083 0183 0153 0029 067a  .|...D.....S.).z
+000012d0: 2c0a 2020 2020 5468 6520 696e 7665 7273  ,.    The invers
+000012e0: 6520 6f66 2027 706f 6c79 3276 6563 2720  e of 'poly2vec' 
+000012f0: 726f 7574 696e 652e 0a20 2020 2072 0600  routine..    r..
+00001300: 0000 7201 0000 00fa 1744 696d 656e 7369  ..r......Dimensi
+00001310: 6f6e 206d 7573 7420 6265 2065 7665 6e2e  on must be even.
+00001320: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
+00001330: 0005 0000 0013 0000 0073 1c00 0000 6700  .........s....g.
+00001340: 7c00 5d0a 7d01 8801 7c01 1900 8800 7c01  |.].}...|.....|.
+00001350: 1900 1400 9102 7102 5300 7225 0000 0072  ......q.S.r%...r
+00001360: 2500 0000 a902 da02 2e30 723f 0000 00a9  %........0r?....
+00001370: 0272 4000 0000 da05 7869 6574 6172 2500  .r@.....xietar%.
+00001380: 0000 7226 0000 00da 0a3c 6c69 7374 636f  ..r&.....<listco
+00001390: 6d70 3eaf 0000 0073 0200 0000 1c00 7a1c  mp>....s......z.
+000013a0: 7665 6332 706f 6c79 2e3c 6c6f 6361 6c73  vec2poly.<locals
+000013b0: 3e2e 3c6c 6973 7463 6f6d 703e 2907 da03  >.<listcomp>)...
+000013c0: 6c65 6e72 2e00 0000 722f 0000 0072 3000  lenr....r/...r0.
+000013d0: 0000 da0d 6372 6561 7465 5f63 6f6f 7264  ....create_coord
+000013e0: 73da 0373 756d 7216 0000 0029 0272 4000  s..sumr....).r@.
+000013f0: 0000 721a 0000 0072 2500 0000 7245 0000  ..r....r%...rE..
+00001400: 0072 2600 0000 da08 7665 6332 706f 6c79  .r&.....vec2poly
+00001410: a800 0000 7308 0000 0008 0414 0112 011c  ....s...........
+00001420: 0172 4b00 0000 6301 0000 0000 0000 0000  .rK...c.........
+00001430: 0000 000c 0000 0006 0000 0043 0000 0073  ...........C...s
+00001440: 5c01 0000 7c00 a000 a100 6401 6b01 720c  \...|.....d.k.r.
+00001450: 7c00 a001 a100 6402 6b05 730e 4a00 8201  |.....d.k.s.J...
+00001460: 7c00 6a02 7d01 7c01 6401 1400 7d02 7c00  |.j.}.|.d...}.|.
+00001470: 6a03 7d03 7404 7405 7c00 8301 8301 7d04  j.}.t.t.|.....}.
+00001480: 7406 7c04 6403 8302 723d 7407 6a08 7c02  t.|.d...r=t.j.|.
+00001490: 6402 1700 7c02 6402 1700 6702 7409 7c04  d...|.d...g.t.|.
+000014a0: 6a0a 8301 1700 7407 6a0b 6404 8d02 7d05  j.....t.j.d...}.
+000014b0: 7407 a008 7c04 6a0a a101 7d06 6e10 7407  t...|.j...}.n.t.
+000014c0: 6a08 7c02 6402 1700 7c02 6402 1700 6702  j.|.d...|.d...g.
+000014d0: 7407 6a0b 6404 8d02 7d05 6405 7d06 7c00  t.j.d...}.d.}.|.
+000014e0: a00c 6401 a101 7d07 740d 7c07 8301 6405  ..d...}.t.|...d.
+000014f0: 6b03 7265 740e 7c07 8301 7c05 6406 7c02  k.ret.|...|.d.|.
+00001500: 8502 6406 7c02 8502 6407 6603 3c00 7c00  ..d.|...d.f.<.|.
+00001510: a00c 6402 a101 7d08 740d 7c08 8301 6405  ..d...}.t.|...d.
+00001520: 6b03 72ac 740f 7c01 8301 4400 5d37 7d09  k.r.t.|...D.]7}.
+00001530: 6405 6701 7c02 1400 7d0a 6402 7c0a 7c09  d.g.|...}.d.|.|.
+00001540: 3c00 7c08 a010 7411 7c0a 8301 7c06 a102  <.|...t.|...|...
+00001550: 7c03 1400 7c05 7c02 7c09 7c01 1700 6407  |...|.|.|.|...d.
+00001560: 6603 3c00 6405 6701 7c02 1400 7d0b 6402  f.<.d.g.|...}.d.
+00001570: 7c0b 7c09 7c01 1700 3c00 7c08 a010 7411  |.|.|...<.|...t.
+00001580: 7c0b 8301 7c06 a102 7c03 0b00 1400 7c05  |...|...|.....|.
+00001590: 7c02 7c09 6407 6603 3c00 7174 7c05 5300  |.|.d.f.<.qt|.S.
+000015a0: 2908 6130 0200 000a 2020 2020 436f 6d70  ).a0....    Comp
+000015b0: 7574 6520 6120 2832 6e20 2b20 3129 7828  ute a (2n + 1)x(
+000015c0: 326e 202b 2031 292d 6d61 7472 6978 2072  2n + 1)-matrix r
+000015d0: 6570 7265 7365 6e74 6174 696f 6e20 6f66  epresentation of
+000015e0: 2061 2073 6563 6f6e 642d 6f72 6465 7220   a second-order 
+000015f0: 706f 6c79 6e6f 6d69 616c 2028 7769 7468  polynomial (with
+00001600: 6f75 740a 2020 2020 636f 6e73 7461 6e74  out.    constant
+00001610: 2074 6572 6d29 2c20 6769 7665 6e20 696e   term), given in
+00001620: 2074 6572 6d73 206f 6620 636f 6d70 6c65   terms of comple
+00001630: 7820 7869 2f65 7461 2063 6f6f 7264 696e  x xi/eta coordin
+00001640: 6174 6573 2c20 0a20 2020 2073 6f20 7468  ates, .    so th
+00001650: 6174 2069 6620 7a5f 6a20 6465 6e6f 7465  at if z_j denote
+00001660: 2074 6865 2062 6173 6973 2076 6563 746f   the basis vecto
+00001670: 7273 2c20 7468 656e 3a0a 2020 2020 0a20  rs, then:.    . 
+00001680: 2020 207b 702c 207a 5f6a 7d20 3d20 705f     {p, z_j} = p_
+00001690: 7b69 6a7d 207a 5f69 202b 2072 5f6a 0a20  {ij} z_i + r_j. 
+000016a0: 2020 200a 2020 2020 686f 6c64 732e 2054     .    holds. T
+000016b0: 6865 2062 7261 636b 6574 7320 7b20 2c20  he brackets { , 
+000016c0: 7d20 6465 6e6f 7465 2074 6865 2070 6f69  } denote the poi
+000016d0: 7373 6f6e 2062 7261 636b 6574 2e20 5468  sson bracket. Th
+000016e0: 6520 7661 6c75 6573 2070 5f7b 696a 7d20  e values p_{ij} 
+000016f0: 616e 6420 725f 6a20 7769 6c6c 2062 6520  and r_j will be 
+00001700: 6465 7465 726d 696e 6564 2e0a 2020 2020  determined..    
+00001710: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+00001720: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00001730: 2020 2070 696e 3a20 706f 6c79 0a20 2020     pin: poly.   
+00001740: 2020 2020 2054 6865 2070 6f6c 796e 6f6d       The polynom
+00001750: 6961 6c20 746f 2062 6520 636f 6e76 6572  ial to be conver
+00001760: 7465 642e 0a20 2020 2020 2020 200a 2020  ted..        .  
+00001770: 2020 5265 7475 726e 730a 2020 2020 2d2d    Returns.    --
+00001780: 2d2d 2d2d 2d0a 2020 2020 6172 7261 792d  -----.    array-
+00001790: 6c69 6b65 0a20 2020 2020 2020 2041 2063  like.        A c
+000017a0: 6f6d 706c 6578 206d 6174 7269 7820 636f  omplex matrix co
+000017b0: 7272 6573 706f 6e64 696e 6720 746f 2074  rresponding to t
+000017c0: 6865 2072 6570 7265 7365 6e74 6174 696f  he representatio
+000017d0: 6e2e 0a20 2020 2072 0600 0000 720a 0000  n..    r....r...
+000017e0: 0072 0700 0000 7208 0000 0072 0100 0000  .r....r....r....
+000017f0: 4e2e 2912 720b 0000 0072 0c00 0000 720d  N.).r....r....r.
+00001800: 0000 0072 0e00 0000 720f 0000 0072 1000  ...r....r....r..
+00001810: 0000 7211 0000 0072 1200 0000 7213 0000  ..r....r....r...
+00001820: 0072 1400 0000 7207 0000 0072 1500 0000  .r....r....r....
+00001830: da10 686f 6d6f 6765 6e65 6f75 735f 7061  ..homogeneous_pa
+00001840: 7274 7248 0000 0072 2700 0000 7216 0000  rtrH...r'...r...
+00001850: 0072 1700 0000 7218 0000 0029 0c72 1900  .r....r....).r..
+00001860: 0000 720d 0000 0072 1a00 0000 721b 0000  ..r....r....r...
+00001870: 0072 1c00 0000 da04 706d 6174 721e 0000  .r......pmatr...
+00001880: 00da 0470 696e 32da 0470 696e 3172 3f00  ...pin2..pin1r?.
+00001890: 0000 da06 7869 5f6b 6579 da07 6574 615f  ....xi_key..eta_
+000018a0: 6b65 7972 2500 0000 7225 0000 0072 2600  keyr%...r%...r&.
+000018b0: 0000 da07 706f 6c79 3361 64b1 0000 0073  ....poly3ad....s
+000018c0: 2e00 0000 1c14 0601 0801 0601 0c03 0a01  ................
+000018d0: 2601 0e01 1c02 0401 0a03 0c01 1a01 0a02  &...............
+000018e0: 0c01 0c01 0a01 0801 2201 0a02 0c01 2201  ........".....".
+000018f0: 0401 7252 0000 0063 0100 0000 0000 0000  ..rR...c........
+00001900: 0000 0000 0a00 0000 0500 0000 4b00 0000  ............K...
+00001910: 73de 0000 007c 006a 0064 0119 007c 006a  s....|.j.d...|.j
+00001920: 0064 0219 006b 0273 0c4a 0082 017c 006a  .d...k.s.J...|.j
+00001930: 0064 0119 0064 0218 007d 027c 0264 0316  .d...d...}.|.d..
+00001940: 0064 016b 0273 1b4a 0082 017c 0264 031a  .d.k.s.J...|.d..
+00001950: 007d 0374 017c 0064 047c 0285 0264 047c  .}.t.|.d.|...d.|
+00001960: 0285 0266 0219 0066 0169 007c 01a4 018e  ...f...f.i.|....
+00001970: 017d 047c 046a 027d 0574 037c 0483 0164  .}.|.j.}.t.|...d
+00001980: 016b 0272 3a64 017d 0474 046a 056a 06a0  .k.r:d.}.t.j.j..
+00001990: 077c 03a1 017d 0674 087c 0383 0144 005d  .|...}.t.|...D.]
+000019a0: 277d 077c 007c 027c 0766 0219 007c 050b  '}.|.|.|.f...|..
+000019b0: 001b 007d 087c 007c 027c 077c 0317 0066  ...}.|.|.|.|...f
+000019c0: 0219 007c 051b 007d 097c 047c 067c 0719  ...|...}.|.|.|..
+000019d0: 007c 0914 0037 007d 047c 047c 067c 077c  .|...7.}.|.|.|.|
+000019e0: 0317 0019 007c 0814 0037 007d 0471 457c  .....|...7.}.qE|
+000019f0: 0453 0029 057a 2f0a 2020 2020 5468 6520  .S.).z/.    The 
+00001a00: 696e 7665 7273 6520 6f66 2074 6865 2027  inverse of the '
+00001a10: 706f 6c79 3361 6427 2072 6f75 7469 6e65  poly3ad' routine
+00001a20: 2e0a 2020 2020 7201 0000 0072 0a00 0000  ..    r....r....
+00001a30: 7206 0000 004e 2909 7207 0000 0072 3800  r....N).r....r8.
+00001a40: 0000 720e 0000 0072 4800 0000 722e 0000  ..r....rH...r...
+00001a50: 0072 2f00 0000 7230 0000 0072 4900 0000  .r/...r0...rI...
+00001a60: 7216 0000 0029 0a72 1d00 0000 7233 0000  r....).r....r3..
+00001a70: 0072 1a00 0000 720d 0000 00da 0270 3272  .r....r......p2r
+00001a80: 1b00 0000 7246 0000 0072 3f00 0000 da0b  ....rF...r?.....
+00001a90: 6574 615f 6b5f 636f 6566 66da 0a78 695f  eta_k_coeff..xi_
+00001aa0: 6b5f 636f 6566 6672 2500 0000 7225 0000  k_coeffr%...r%..
+00001ab0: 0072 2600 0000 da07 6164 3370 6f6c 79e4  .r&.....ad3poly.
+00001ac0: 0000 0073 1e00 0000 1804 0e01 1001 0801  ...s............
+00001ad0: 2002 0601 0c01 0401 0e02 0c01 1201 1401   ...............
+00001ae0: 1001 1601 0401 7256 0000 0063 0100 0000  ......rV...c....
+00001af0: 0000 0000 0000 0000 0500 0000 0700 0000  ................
+00001b00: 4b00 0000 7352 0000 007c 00a0 00a1 0064  K...sR...|.....d
+00001b10: 016b 0173 084a 0082 017c 00a0 0164 02a1  .k.s.J...|...d..
+00001b20: 017d 027c 00a0 0164 01a1 017d 0374 027c  .}.|...d...}.t.|
+00001b30: 0366 0169 007c 01a4 018e 017d 0474 03a0  .f.i.|.....}.t..
+00001b40: 047c 047c 02a0 0564 037c 006a 0614 0064  .|.|...d.|.j...d
+00001b50: 0414 0064 02a1 02a1 0253 0029 057a 9a0a  ...d.....S.).z..
+00001b60: 2020 2020 4d61 7020 6120 4c69 6520 706f      Map a Lie po
+00001b70: 6c79 6e6f 6d69 616c 206f 6620 6465 6772  lynomial of degr
+00001b80: 6565 203c 3d20 3120 746f 2069 7473 2072  ee <= 1 to its r
+00001b90: 6573 7065 6374 6976 6520 2832 6e20 2b20  espective (2n + 
+00001ba0: 3129 2d64 696d 656e 7369 6f6e 616c 0a20  1)-dimensional. 
+00001bb0: 2020 2076 6563 746f 722e 2054 6865 206c     vector. The l
+00001bc0: 6173 7420 6469 6d65 6e73 696f 6e20 6973  ast dimension is
+00001bd0: 2068 6572 6562 7920 6465 6469 6361 7465   hereby dedicate
+00001be0: 6420 746f 2074 6865 2063 6f6e 7374 616e  d to the constan
+00001bf0: 7473 2e20 0a20 2020 2072 0a00 0000 7201  ts. .    r....r.
+00001c00: 0000 00a9 0172 0100 0000 7206 0000 0029  .....r....r....)
+00001c10: 0772 0b00 0000 724c 0000 0072 4100 0000  .r....rL...rA...
+00001c20: 7212 0000 00da 0661 7070 656e 6472 1700  r......appendr..
+00001c30: 0000 720d 0000 0029 0572 3c00 0000 7233  ..r....).r<...r3
+00001c40: 0000 00da 0270 30da 0270 31da 0476 6563  .....p0..p1..vec
+00001c50: 3172 2500 0000 7225 0000 0072 2600 0000  1r%...r%...r&...
+00001c60: da08 706f 6c79 3376 6563 fa00 0000 730a  ..poly3vec....s.
+00001c70: 0000 0010 050a 010a 0110 011e 0172 5c00  .............r\.
+00001c80: 0000 6301 0000 0000 0000 0000 0000 0004  ..c.............
+00001c90: 0000 0004 0000 004b 0000 0073 4c00 0000  .......K...sL...
+00001ca0: 7400 7c00 8301 6401 1600 6402 6b02 730a  t.|...d...d.k.s.
+00001cb0: 4a00 8201 7400 7c00 8301 6402 1800 7d02  J...t.|...d...}.
+00001cc0: 7401 7c00 6403 6404 8502 1900 6601 6900  t.|.d.d.....f.i.
+00001cd0: 7c01 a401 8e01 7d03 7c00 6404 1900 7c03  |.....}.|.d...|.
+00001ce0: 6405 7c02 1400 3c00 7c03 5300 2906 7a2e  d.|...<.|.S.).z.
+00001cf0: 0a20 2020 2054 6865 2069 6e76 6572 7365  .    The inverse
+00001d00: 206f 6620 7468 6520 706f 6c79 3376 6563   of the poly3vec
+00001d10: 2072 6f75 7469 6e65 2e0a 2020 2020 7206   routine..    r.
+00001d20: 0000 0072 0a00 0000 4e72 2a00 0000 7257  ...r....Nr*...rW
+00001d30: 0000 0029 0272 4800 0000 724b 0000 0029  ...).rH...rK...)
+00001d40: 04da 0376 6563 7233 0000 00da 026e 3272  ...vecr3.....n2r
+00001d50: 5a00 0000 7225 0000 0072 2500 0000 7226  Z...r%...r%...r&
+00001d60: 0000 00da 0876 6563 3370 6f6c 7905 0100  .....vec3poly...
+00001d70: 0073 0a00 0000 1404 0c01 1801 1001 0401  .s..............
+00001d80: 725f 0000 0029 0172 1b00 0000 6300 0000  r_...).r....c...
+00001d90: 0000 0000 0001 0000 0005 0000 0004 0000  ................
+00001da0: 000f 0000 0073 6800 0000 7400 8801 8301  .....sh...t.....
+00001db0: 7d03 7c03 6401 1600 6402 6b02 730e 4a00  }.|.d...d.k.s.J.
+00001dc0: 6403 8301 8201 7c03 6401 1a00 7d04 7401  d.....|.d...}.t.
+00001dd0: 7c04 8301 8900 7402 6a03 6a04 6a05 7c04  |.....t.j.j.j.|.
+00001de0: 6601 6404 7c00 6901 7c02 a401 8e01 8902  f.d.|.i.|.......
+00001df0: 7406 8700 8701 8702 6603 6405 6406 8408  t.......f.d.d...
+00001e00: 7407 7c03 8301 4400 8301 8301 7c00 1b00  t.|...D.....|...
+00001e10: 5300 2907 7aa9 0a20 2020 204c 6574 2063  S.).z..    Let c
+00001e20: 5f31 2c20 2e2e 2e2c 2063 5f7b 326e 7d20  _1, ..., c_{2n} 
+00001e30: 6265 2063 6f6e 7374 616e 7473 2e20 5468  be constants. Th
+00001e40: 656e 2063 6f6d 7075 7465 2061 2066 6972  en compute a fir
+00001e50: 7374 2d6f 7264 6572 2070 6f6c 796e 6f6d  st-order polynom
+00001e60: 6961 6c20 675f 310a 2020 2020 736f 2074  ial g_1.    so t
+00001e70: 6861 7420 7b67 5f31 2c20 7a5f 6a7d 203d  hat {g_1, z_j} =
+00001e80: 207a 5f6a 202b 2063 5f6a 2068 6f6c 6473   z_j + c_j holds
+00001e90: 2c20 7768 6572 6520 7468 6520 7a5f 6a20  , where the z_j 
+00001ea0: 6172 6520 6361 6e6f 6e69 6361 6c20 636f  are canonical co
+00001eb0: 6f72 6469 6e61 7465 732e 0a20 2020 2072  ordinates..    r
+00001ec0: 0600 0000 7201 0000 0072 4200 0000 721b  ....r....rB...r.
+00001ed0: 0000 0063 0100 0000 0000 0000 0000 0000  ...c............
+00001ee0: 0200 0000 0800 0000 1300 0000 7328 0000  ............s(..
+00001ef0: 0067 007c 005d 107d 0188 027c 0119 0074  .g.|.].}...|...t
+00001f00: 006a 0188 0088 0164 0064 018d 037c 0119  .j.....d.d...|..
+00001f10: 0014 0091 0271 0253 0029 0229 0272 0a00  .....q.S.).).r..
+00001f20: 0000 7201 0000 0029 01da 0461 7865 7329  ..r....)...axes)
+00001f30: 0272 1200 0000 da09 7465 6e73 6f72 646f  .r......tensordo
+00001f40: 7472 4300 0000 a903 da01 4ada 0563 6f6e  trC.......J..con
+00001f50: 7374 7246 0000 0072 2500 0000 7226 0000  strF...r%...r&..
+00001f60: 0072 4700 0000 1901 0000 7302 0000 0028  .rG.......s....(
+00001f70: 007a 1e63 6f6e 7374 3270 6f6c 792e 3c6c  .z.const2poly.<l
+00001f80: 6f63 616c 733e 2e3c 6c69 7374 636f 6d70  ocals>.<listcomp
+00001f90: 3e29 0872 4800 0000 7205 0000 0072 2e00  >).rH...r....r..
+00001fa0: 0000 722f 0000 0072 3000 0000 7249 0000  ..r/...r0...rI..
+00001fb0: 0072 4a00 0000 7216 0000 0029 0572 1b00  .rJ...r....).r..
+00001fc0: 0000 7264 0000 0072 3300 0000 721a 0000  ..rd...r3...r...
+00001fd0: 0072 0d00 0000 7225 0000 0072 6200 0000  .r....r%...rb...
+00001fe0: 7226 0000 00da 0a63 6f6e 7374 3270 6f6c  r&.....const2pol
+00001ff0: 790f 0100 0073 0c00 0000 0805 1401 0801  y....s..........
+00002000: 0801 1a01 2201 7265 0000 0063 0100 0000  ....".re...c....
+00002010: 0000 0000 0000 0000 0200 0000 0500 0000  ................
+00002020: 0300 0000 7348 0000 0088 00a0 00a1 0064  ....sH.........d
+00002030: 016b 0272 0c88 00a0 01a1 0064 016b 0273  .k.r.......d.k.s
+00002040: 0e4a 0082 0174 026a 036a 046a 0588 006a  .J...t.j.j.j...j
+00002050: 0688 006a 0788 006a 0864 028d 037d 0187  ...j...j.d...}..
+00002060: 0066 0164 0364 0484 087c 0144 0083 0153  .f.d.d...|.D...S
+00002070: 0029 057a 320a 2020 2020 5468 6520 696e  .).z2.    The in
+00002080: 7665 7273 6520 6f66 2074 6865 2027 636f  verse of the 'co
+00002090: 6e73 7432 706f 6c79 2720 726f 7574 696e  nst2poly' routin
+000020a0: 652e 0a20 2020 2072 0a00 0000 2902 721b  e..    r....).r.
+000020b0: 0000 00da 096d 6178 5f70 6f77 6572 6301  .....max_powerc.
+000020c0: 0000 0000 0000 0000 0000 0002 0000 0005  ................
+000020d0: 0000 0013 0000 0073 2200 0000 6700 7c00  .......s"...g.|.
+000020e0: 5d0d 7d01 8800 7c01 1000 6400 8800 6a00  ].}...|...d...j.
+000020f0: 1400 6401 1400 1900 9102 7102 5300 2902  ..d.......q.S.).
+00002100: 7257 0000 0072 0600 0000 a901 720d 0000  rW...r......r...
+00002110: 0029 0272 4400 0000 da02 7865 a901 725a  .).rD.....xe..rZ
+00002120: 0000 0072 2500 0000 7226 0000 0072 4700  ...r%...r&...rG.
+00002130: 0000 2101 0000 7302 0000 0022 007a 1e70  ..!...s....".z.p
+00002140: 6f6c 7932 636f 6e73 742e 3c6c 6f63 616c  oly2const.<local
+00002150: 733e 2e3c 6c69 7374 636f 6d70 3e29 0972  s>.<listcomp>).r
+00002160: 0c00 0000 720b 0000 0072 2e00 0000 722f  ....r....r....r/
+00002170: 0000 0072 3000 0000 7249 0000 0072 0d00  ...r0...rI...r..
+00002180: 0000 720e 0000 0072 6600 0000 2902 725a  ..r....rf...).rZ
+00002190: 0000 0072 4600 0000 7225 0000 0072 6900  ...rF...r%...ri.
+000021a0: 0000 7226 0000 00da 0a70 6f6c 7932 636f  ..r&.....poly2co
+000021b0: 6e73 741b 0100 0073 0600 0000 1c04 1a01  nst....s........
+000021c0: 1201 726a 0000 0063 0100 0000 0000 0000  ..rj...c........
+000021d0: 0000 0000 0100 0000 0100 0000 4300 0000  ............C...
+000021e0: 7304 0000 007c 0053 00a9 014e 7225 0000  s....|.S...Nr%..
+000021f0: 0029 01da 017a 7225 0000 0072 2500 0000  .)...zr%...r%...
+00002200: 7226 0000 00da 083c 6c61 6d62 6461 3e23  r&.....<lambda>#
+00002210: 0100 0073 0200 0000 0400 726d 0000 0029  ...s......rm...)
+00002220: 01da 0466 756e 6363 0000 0000 0000 0000  ...funcc........
+00002230: 0200 0000 0300 0000 0500 0000 0700 0000  ................
+00002240: 7340 0000 0074 0088 0283 0188 006a 016b  s@...t.......j.k
+00002250: 0273 094a 0082 0174 026a 036a 046a 0587  .s.J...t.j.j.j..
+00002260: 0087 0187 0266 0364 0164 0284 0888 00a0  .....f.d.d......
+00002270: 06a1 0044 0083 0188 006a 0188 006a 0764  ...D.....j...j.d
+00002280: 038d 0353 0029 0461 2f03 0000 0a20 2020  ...S.).a/....   
+00002290: 2054 6865 2070 6f69 7373 6f6e 2062 7261   The poisson bra
+000022a0: 636b 6574 206f 6620 7468 6520 706f 6c79  cket of the poly
+000022b0: 6e6f 6d69 616c 2058 203a 3d20 7375 6d5f  nomial X := sum_
+000022c0: 6b20 6d75 5f6b 2065 7073 696c 6f6e 5f6b  k mu_k epsilon_k
+000022d0: 200a 2020 2020 286e 6f74 6174 696f 6e20   .    (notation 
+000022e0: 6173 2069 6e20 5265 662e 205b 315d 2c20  as in Ref. [1], 
+000022f0: 7768 6572 6520 6570 7369 6c6f 6e5f 6b20  where epsilon_k 
+00002300: 6465 6e6f 7465 7320 7468 6520 6b2d 7468  denotes the k-th
+00002310: 2061 6374 696f 6e20 616e 6420 6d75 5f6b   action and mu_k
+00002320: 200a 2020 2020 7468 6520 6b2d 7468 2074   .    the k-th t
+00002330: 756e 6529 2c20 6170 706c 6965 6420 746f  une), applied to
+00002340: 2073 6f6d 6520 6172 6269 7472 6172 7920   some arbitrary 
+00002350: 706f 6c79 6e6f 6d69 616c 2043 2c20 6361  polynomial C, ca
+00002360: 6e20 6265 2063 6f6d 7075 7465 6420 6469  n be computed di
+00002370: 7265 6374 6c79 200a 2020 2020 6475 6520  rectly .    due 
+00002380: 746f 2074 6865 2066 6163 7420 7468 6174  to the fact that
+00002390: 2074 6865 2078 692f 6574 612d 636f 6f72   the xi/eta-coor
+000023a0: 6469 6e61 7465 7320 636f 6e73 7469 7475  dinates constitu
+000023b0: 7465 2061 6e20 2265 6967 656e 6261 7369  te an "eigenbasi
+000023c0: 7322 206f 6620 582e 0a20 2020 200a 2020  s" of X..    .  
+000023d0: 2020 5468 6973 2072 6f75 7469 6e65 2077    This routine w
+000023e0: 696c 6c20 7065 7266 6f72 6d20 7468 6520  ill perform the 
+000023f0: 6361 6c63 756c 6174 696f 6e20 616e 6420  calculation and 
+00002400: 7265 7475 726e 2074 6865 2072 6573 756c  return the resul
+00002410: 7469 6e67 2070 6f6c 796e 6f6d 6961 6c2e  ting polynomial.
+00002420: 0a20 2020 200a 2020 2020 5061 7261 6d65  .    .    Parame
+00002430: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+00002440: 2d2d 2d0a 2020 2020 6d75 3a20 666c 6f61  ---.    mu: floa
+00002450: 7420 286f 7220 636f 6d70 6c65 7829 0a20  t (or complex). 
+00002460: 2020 2020 2020 2054 6865 2074 756e 6573         The tunes
+00002470: 206f 6620 7468 6520 6163 7469 6f6e 2d6f   of the action-o
+00002480: 7065 7261 746f 720a 2020 2020 0a20 2020  perator.    .   
+00002490: 2043 3a20 706f 6c79 0a20 2020 2020 2020   C: poly.       
+000024a0: 2054 6865 2070 6f6c 796e 6f6d 6961 6c20   The polynomial 
+000024b0: 6f6e 2077 6869 6368 2074 6865 2061 6374  on which the act
+000024c0: 696f 6e20 6f70 6572 6174 6f72 2073 686f  ion operator sho
+000024d0: 756c 6420 6265 2061 7070 6c69 6564 2e0a  uld be applied..
+000024e0: 2020 2020 2020 2020 0a20 2020 2066 756e          .    fun
+000024f0: 633a 2063 616c 6c61 626c 6520 286f 7074  c: callable (opt
+00002500: 696f 6e61 6c29 0a20 2020 2020 2020 2041  ional).        A
+00002510: 2066 756e 6374 696f 6e20 6620 736f 2074   function f so t
+00002520: 6861 7420 6628 5829 2069 7320 6170 706c  hat f(X) is appl
+00002530: 6965 6420 696e 7374 6561 642e 0a20 2020  ied instead..   
+00002540: 2020 2020 200a 2020 2020 5265 7475 726e       .    Return
+00002550: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
+00002560: 2020 706f 6c79 0a20 2020 2020 2020 2054    poly.        T
+00002570: 6865 2070 6f6c 7920 6f62 6a65 6374 207b  he poly object {
+00002580: 582c 2043 7d20 286f 7220 7b66 2858 292c  X, C} (or {f(X),
+00002590: 2043 7d2c 2069 6620 6120 6675 6e63 7469   C}, if a functi
+000025a0: 6f6e 2068 6173 2062 6565 6e20 7072 6f76  on has been prov
+000025b0: 6964 6564 292e 0a20 2020 2063 0100 0000  ided)..    c....
+000025c0: 0000 0000 0000 0000 0200 0000 0900 0000  ................
+000025d0: 1300 0000 733e 0000 0069 007c 005d 1b5c  ....s>...i.|.].\
+000025e0: 0289 007d 0188 007c 0188 0274 0087 0187  ...}...|...t....
+000025f0: 0387 0066 0364 0064 0184 0874 0188 016a  ...f.d.d...t...j
+00002600: 0283 0144 0083 0183 0164 0214 0083 0114  ...D.....d......
+00002610: 0093 0271 0253 0029 0363 0100 0000 0000  ...q.S.).c......
+00002620: 0000 0000 0000 0200 0000 0600 0000 1300  ................
+00002630: 0000 732a 0000 0067 007c 005d 117d 0188  ..s*...g.|.].}..
+00002640: 027c 0119 0088 027c 0188 006a 0017 0019  .|.....|...j....
+00002650: 0018 0088 017c 0119 0014 0091 0271 0253  .....|.......q.S
+00002660: 0072 2500 0000 7267 0000 0072 4300 0000  .r%...rg...rC...
+00002670: 2903 da01 43da 026d 75da 0670 6f77 6572  )...C..mu..power
+00002680: 7372 2500 0000 7226 0000 0072 4700 0000  sr%...r&...rG...
+00002690: 3d01 0000 7302 0000 002a 007a 2d61 6374  =...s....*.z-act
+000026a0: 696f 6e5f 6f6e 5f70 6f6c 792e 3c6c 6f63  ion_on_poly.<loc
+000026b0: 616c 733e 2e3c 6469 6374 636f 6d70 3e2e  als>.<dictcomp>.
+000026c0: 3c6c 6973 7463 6f6d 703e f900 0000 0000  <listcomp>......
+000026d0: 0000 0000 0000 0000 00f0 3f29 0372 4a00  ..........?).rJ.
+000026e0: 0000 7216 0000 0072 0d00 0000 2902 7244  ..r....r....).rD
+000026f0: 0000 0072 4000 0000 a903 726f 0000 0072  ...r@.....ro...r
+00002700: 6e00 0000 7270 0000 0029 0172 7100 0000  n...rp...).rq...
+00002710: 7226 0000 00da 0a3c 6469 6374 636f 6d70  r&.....<dictcomp
+00002720: 3e3d 0100 0073 0200 0000 3e00 7a22 6163  >=...s....>.z"ac
+00002730: 7469 6f6e 5f6f 6e5f 706f 6c79 2e3c 6c6f  tion_on_poly.<lo
+00002740: 6361 6c73 3e2e 3c64 6963 7463 6f6d 703e  cals>.<dictcomp>
+00002750: 2903 722b 0000 0072 0d00 0000 7266 0000  ).r+...r....rf..
+00002760: 0029 0872 4800 0000 720d 0000 0072 2e00  .).rH...r....r..
+00002770: 0000 722f 0000 0072 3000 0000 7231 0000  ..r/...r0...r1..
+00002780: 0072 3900 0000 7266 0000 0072 7300 0000  .r9...rf...rs...
+00002790: 7225 0000 0072 7300 0000 7226 0000 00da  r%...rs...r&....
+000027a0: 0e61 6374 696f 6e5f 6f6e 5f70 6f6c 7923  .action_on_poly#
+000027b0: 0100 0073 0800 0000 1219 2001 0801 06ff  ...s...... .....
+000027c0: 7275 0000 0063 0000 0000 0000 0000 0000  ru...c..........
+000027d0: 0000 0400 0000 0700 0000 0f00 0000 7334  ..............s4
+000027e0: 0000 0088 00a0 0064 0174 017c 0083 01a1  .......d.t.|....
+000027f0: 027d 0274 027c 0064 0264 037c 0264 0464  .}.t.|.d.d.|.d.d
+00002800: 058d 057d 0387 0066 0164 0664 0784 087c  ...}...f.d.d...|
+00002810: 0344 0083 0153 0029 0861 9d02 0000 0a20  .D...S.).a..... 
+00002820: 2020 204f 6274 6169 6e20 7468 6520 5461     Obtain the Ta
+00002830: 796c 6f72 206d 6170 2066 726f 6d20 6120  ylor map from a 
+00002840: 6769 7665 6e20 6a65 7420 6576 616c 7561  given jet evalua
+00002850: 7469 6f6e 2069 6e20 7465 726d 7320 6f66  tion in terms of
+00002860: 206c 6965 6f70 732e 636f 7265 2e6c 6965   lieops.core.lie
+00002870: 2e70 6f6c 7920 6f62 6a65 6374 732e 0a20  .poly objects.. 
+00002880: 2020 200a 2020 2020 5061 7261 6d65 7465     .    Paramete
+00002890: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+000028a0: 2d0a 2020 2020 6576 616c 7561 7469 6f6e  -.    evaluation
+000028b0: 2873 293a 0a20 2020 2020 2020 206e 2d6a  (s):.        n-j
+000028c0: 6574 206f 626a 6563 7473 2063 6f6e 7461  et objects conta
+000028d0: 696e 696e 6720 706f 6c79 6a65 7420 6f62  ining polyjet ob
+000028e0: 6a65 6374 732e 0a20 2020 2020 2020 200a  jects..        .
+000028f0: 2020 2020 6469 6d32 3a20 696e 742c 206f      dim2: int, o
+00002900: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00002910: 5468 6520 6469 6d65 6e73 696f 6e20 6f66  The dimension of
+00002920: 2074 6865 2064 6f6d 6169 6e20 6f66 2074   the domain of t
+00002930: 6865 2065 7661 6c75 6174 696f 6e2e 2054  he evaluation. T
+00002940: 6869 7320 6973 2072 6571 7569 7265 640a  his is required.
+00002950: 2020 2020 2020 2020 746f 2063 6f6e 7374          to const
+00002960: 7275 6374 2074 6865 2030 2d74 7570 6c65  ruct the 0-tuple
+00002970: 7320 666f 7220 7468 6520 636f 6e73 7461  s for the consta
+00002980: 6e74 732e 0a20 2020 2020 2020 2041 7474  nts..        Att
+00002990: 656e 7469 6f6e 3a20 0a20 2020 2020 2020  ention: .       
+000029a0: 2049 6620 7468 6973 2070 6172 616d 6574   If this paramet
+000029b0: 6572 2069 7320 6e6f 7420 7072 6f76 6964  er is not provid
+000029c0: 6564 2c20 2764 696d 3227 2077 696c 6c20  ed, 'dim2' will 
+000029d0: 6265 2074 616b 656e 2066 726f 6d20 7468  be taken from th
+000029e0: 650a 2020 2020 2020 2020 6e75 6d62 6572  e.        number
+000029f0: 206f 6620 696e 7075 7420 6576 616c 7561   of input evalua
+00002a00: 7469 6f6e 732e 0a20 2020 2020 2020 200a  tions..        .
+00002a10: 2020 2020 2a2a 6b77 6172 6773 0a20 2020      **kwargs.   
+00002a20: 2020 2020 2050 6172 616d 6574 6572 7320       Parameters 
+00002a30: 7061 7373 6564 2074 6f20 6c69 656f 7073  passed to lieops
+00002a40: 2e63 6f72 652e 6c69 652e 706f 6c79 2e0a  .core.lie.poly..
+00002a50: 2020 2020 2020 2020 0a20 2020 2052 6574          .    Ret
+00002a60: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
+00002a70: 0a20 2020 206c 6973 740a 2020 2020 2020  .    list.      
+00002a80: 2020 4120 6c69 7374 206f 6620 706f 6c79    A list of poly
+00002a90: 206f 626a 6563 7473 2c20 7265 7072 6573   objects, repres
+00002aa0: 656e 7469 6e67 2074 6865 2054 6179 6c6f  enting the Taylo
+00002ab0: 7220 6d61 702e 0a20 2020 2072 1a00 0000  r map..    r....
+00002ac0: 5446 720a 0000 0029 04da 086d 756c 745f  TFr....)...mult_
+00002ad0: 7072 6dda 086d 756c 745f 6472 76da 066e  prm..mult_drv..n
+00002ae0: 5f61 7267 73da 0d6f 7574 7075 745f 666f  _args..output_fo
+00002af0: 726d 6174 6301 0000 0000 0000 0000 0000  rmatc...........
+00002b00: 0002 0000 0006 0000 0013 0000 0073 2400  .............s$.
+00002b10: 0000 6700 7c00 5d0e 7d01 7400 6a01 6a02  ..g.|.].}.t.j.j.
+00002b20: 6a03 6401 6400 7c01 6901 8800 a401 8e01  j.d.d.|.i.......
+00002b30: 9102 7102 5300 2902 722b 0000 0072 2500  ..q.S.).r+...r%.
+00002b40: 0000 2904 722e 0000 0072 2f00 0000 7230  ..).r....r/...r0
+00002b50: 0000 0072 3100 0000 a902 7244 0000 00da  ...r1.....rD....
+00002b60: 0165 a901 7233 0000 0072 2500 0000 7226  .e..r3...r%...r&
+00002b70: 0000 0072 4700 0000 5a01 0000 7302 0000  ...rG...Z...s...
+00002b80: 0024 007a 1e74 6179 6c6f 725f 6d61 702e  .$.z.taylor_map.
+00002b90: 3c6c 6f63 616c 733e 2e3c 6c69 7374 636f  <locals>.<listco
+00002ba0: 6d70 3e29 0372 1700 0000 7248 0000 0072  mp>).r....rH...r
+00002bb0: 0300 0000 2904 da0a 6576 616c 7561 7469  ....)...evaluati
+00002bc0: 6f6e 7233 0000 0072 7800 0000 da02 7463  onr3...rx.....tc
+00002bd0: 7225 0000 0072 7c00 0000 7226 0000 00da  r%...r|...r&....
+00002be0: 0a74 6179 6c6f 725f 6d61 7040 0100 0073  .taylor_map@...s
+00002bf0: 0600 0000 1018 1201 1201 727f 0000 00da  ..........r.....
+00002c00: 0461 7574 6f29 03da 0870 6f73 6974 696f  .auto)...positio
+00002c10: 6eda 086f 7264 6572 696e 67da 046d 6f64  n..ordering..mod
+00002c20: 6563 0000 0000 0000 0000 0300 0000 0a00  ec..............
+00002c30: 0000 0600 0000 0f00 0000 730e 0100 0074  ..........s....t
+00002c40: 0088 0183 0164 016b 0473 0a4a 0064 0283  .....d.k.s.J.d..
+00002c50: 0182 0188 0164 0119 006a 016a 0289 0074  .....d...j.j...t
+00002c60: 0387 0066 0164 0364 0484 0888 0144 0083  ...f.d.d.....D..
+00002c70: 0183 0173 1f4a 0064 0583 0182 0188 0064  ...s.J.d.......d
+00002c80: 0614 007d 0564 077c 04a0 04a1 0076 0073  ...}.d.|.....v.s
+00002c90: 2b4a 0082 017c 04a0 0564 07a1 017d 067c  +J...|...d...}.|
+00002ca0: 0264 086b 0272 4464 097d 0288 0264 0a75  .d.k.rDd.}...d.u
+00002cb0: 0172 4474 0088 0283 0174 0088 0183 016b  .rDt.....t.....k
+00002cc0: 0472 4464 0b7d 027c 0264 096b 0272 6188  .rDd.}.|.d.k.ra.
+00002cd0: 0264 0a75 0072 5274 0674 0088 0183 0183  .d.u.rRt.t......
+00002ce0: 0189 0287 0187 0266 0264 0c64 0d84 087d  .......f.d.d...}
+00002cf0: 0774 077c 077c 057c 0664 0e8d 037d 086e  .t.|.|.|.d...}.n
+00002d00: 167c 0264 0b6b 0272 6f74 0888 017c 057c  .|.d.k.rot...|.|
+00002d10: 0688 0264 0f9c 038e 017d 086e 0874 0964  ...d.....}.n.t.d
+00002d20: 107c 029b 0064 119d 0383 0182 0174 007c  .|...d.......t.|
+00002d30: 0083 0164 016b 0472 857c 086a 0a7c 0069  ...d.k.r.|.j.|.i
+00002d40: 007c 04a4 018e 017d 097c 0853 0029 1261  .|.....}.|.S.).a
+00002d50: fd05 0000 0a20 2020 2050 6173 7320 6e2d  .....    Pass n-
+00002d60: 6a65 7473 2074 6872 6f75 6768 2074 6865  jets through the
+00002d70: 2066 6c6f 7720 6675 6e63 7469 6f6e 7320   flow functions 
+00002d80: 6f66 2061 2063 6861 696e 206f 6620 4c69  of a chain of Li
+00002d90: 652d 6f70 6572 6174 6f72 730a 2020 2020  e-operators.    
+00002da0: 746f 2063 6f6d 7075 7465 2074 6865 2072  to compute the r
+00002db0: 6573 756c 7420 666f 7220 6576 6572 7920  esult for every 
+00002dc0: 6379 636c 652e 0a0a 2020 2020 5061 7261  cycle...    Para
+00002dd0: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
+00002de0: 2d2d 2d2d 2d0a 2020 2020 2a6f 7073 3a20  -----.    *ops: 
+00002df0: 6c69 656f 7065 7261 746f 7228 7329 0a20  lieoperator(s). 
+00002e00: 2020 2020 2020 2041 6e20 6f70 6572 6174         An operat
+00002e10: 6f72 206f 7220 6120 6c69 7374 206f 6620  or or a list of 
+00002e20: 6f70 6572 6174 6f72 7320 7768 6963 6820  operators which 
+00002e30: 7368 6f75 6c64 2062 6520 6465 7269 7665  should be derive
+00002e40: 642e 2049 6e20 6361 7365 2061 206c 6973  d. In case a lis
+00002e50: 740a 2020 2020 2020 2020 6973 2067 6976  t.        is giv
+00002e60: 656e 2c20 7468 6520 6669 7273 7420 656c  en, the first el
+00002e70: 656d 656e 7420 6f66 2074 6865 206c 6973  ement of the lis
+00002e80: 7420 7769 6c6c 2062 6520 7072 6f63 6573  t will be proces
+00002e90: 7365 6420 6669 7273 742e 0a20 2020 200a  sed first..    .
+00002ea0: 2020 2020 6f72 6465 723a 2069 6e74 0a20      order: int. 
+00002eb0: 2020 2020 2020 2054 6865 206e 756d 6265         The numbe
+00002ec0: 7220 6f66 2064 6572 6976 6174 6976 6573  r of derivatives
+00002ed0: 2077 6869 6368 2073 686f 756c 6420 6265   which should be
+00002ee0: 2074 616b 656e 2069 6e74 6f20 6163 636f   taken into acco
+00002ef0: 756e 742e 0a0a 2020 2020 706f 7369 7469  unt...    positi
+00002f00: 6f6e 3a20 6c69 7374 2c20 6f70 7469 6f6e  on: list, option
+00002f10: 616c 0a20 2020 2020 2020 2041 6e20 6f70  al.        An op
+00002f20: 7469 6f6e 616c 2070 6f69 6e74 206f 6620  tional point of 
+00002f30: 7265 6665 7265 6e63 652e 2049 6620 6e6f  reference. If no
+00002f40: 7468 696e 6720 7370 6563 6966 6965 642c  thing specified,
+00002f50: 206e 6f20 6576 616c 7561 7469 6f6e 206f   no evaluation o
+00002f60: 6620 7468 650a 2020 2020 2020 2020 696e  f the.        in
+00002f70: 7465 726e 616c 2027 6465 7269 7665 2720  ternal 'derive' 
+00002f80: 286f 7220 2763 6465 7269 7665 2729 206f  (or 'cderive') o
+00002f90: 626a 6563 7420 7769 6c6c 2062 6520 6d61  bject will be ma
+00002fa0: 6465 2e20 4f74 6865 7277 6973 652c 2061  de. Otherwise, a
+00002fb0: 0a20 2020 2020 2020 206a 6574 2d65 7661  .        jet-eva
+00002fc0: 6c75 6174 696f 6e20 6174 2074 6865 2072  luation at the r
+00002fd0: 6571 7565 7374 6564 2070 6f73 6974 696f  equested positio
+00002fe0: 6e20 7769 6c6c 2062 6520 6d61 6465 2e0a  n will be made..
+00002ff0: 2020 2020 2020 2020 0a20 2020 206f 7264          .    ord
+00003000: 6572 696e 673a 206c 6973 742c 206f 7074  ering: list, opt
+00003010: 696f 6e61 6c0a 2020 2020 2020 2020 4120  ional.        A 
+00003020: 6c69 7374 2064 6566 696e 696e 6720 616e  list defining an
+00003030: 206f 7074 696e 6f6e 616c 206f 7264 6572   optinonal order
+00003040: 696e 6720 6f66 2074 6865 206f 7065 7261  ing of the opera
+00003050: 746f 7273 2e20 5365 6520 6e6a 6574 2e65  tors. See njet.e
+00003060: 7874 7261 732e 6364 6572 6976 6520 666f  xtras.cderive fo
+00003070: 720a 2020 2020 2020 2020 6465 7461 696c  r.        detail
+00003080: 732e 2049 6620 6e6f 7468 696e 6720 7072  s. If nothing pr
+00003090: 6f76 6964 6564 2c20 7468 6520 6f72 6465  ovided, the orde
+000030a0: 7269 6e67 2066 726f 6d20 7468 6520 6769  ring from the gi
+000030b0: 7665 6e20 6f70 6572 6174 6f72 7320 6973  ven operators is
+000030c0: 2075 7365 6420 616e 640a 2020 2020 2020   used and.      
+000030d0: 2020 616e 206e 6a65 742e 6465 7269 7665    an njet.derive
+000030e0: 206f 626a 6563 7420 7769 6c6c 2062 6520   object will be 
+000030f0: 7573 6564 2069 6e73 7465 6164 2e0a 2020  used instead..  
+00003100: 2020 2020 2020 0a20 2020 206d 6f64 653a        .    mode:
+00003110: 2073 7472 2c20 6f70 7469 6f6e 616c 0a20   str, optional. 
+00003120: 2020 2020 2020 2043 6f6e 7472 6f6c 2074         Control t
+00003130: 6865 2074 7970 6520 6f66 206f 7574 7075  he type of outpu
+00003140: 742e 0a20 2020 2020 2020 2027 6465 6661  t..        'defa
+00003150: 756c 7427 3a20 7265 7475 726e 2061 6e20  ult': return an 
+00003160: 6f62 6a65 6374 206f 6620 7479 7065 206e  object of type n
+00003170: 6a65 742e 6465 7269 7665 2e20 0a20 2020  jet.derive. .   
+00003180: 2020 2020 2020 2027 6368 6169 6e27 3a20         'chain': 
+00003190: 5265 7475 726e 2061 6e20 6f62 6a65 6374  Return an object
+000031a0: 206f 6620 7479 7065 206e 6a65 742e 6578   of type njet.ex
+000031b0: 7472 6173 2e63 6465 7269 7665 2e0a 2020  tras.cderive..  
+000031c0: 2020 2020 2020 2020 2027 6175 746f 273a           'auto':
+000031d0: 2053 656c 6563 7420 7468 6520 7265 7375   Select the resu
+000031e0: 6c74 2062 6173 6564 206f 6e20 7468 6520  lt based on the 
+000031f0: 6e75 6d62 6572 206f 6620 756e 6971 7565  number of unique
+00003200: 2065 6c65 6d65 6e74 7320 696e 2074 6865   elements in the
+00003210: 2067 6976 656e 2063 6861 696e 2e0a 0a20   given chain... 
+00003220: 2020 202a 2a6b 7761 7267 730a 2020 2020     **kwargs.    
+00003230: 2020 2020 4f70 7469 6f6e 616c 206b 6579      Optional key
+00003240: 776f 7264 6564 2061 7267 756d 656e 7473  worded arguments
+00003250: 2070 6173 7365 6420 746f 206e 6a65 742e   passed to njet.
+00003260: 6578 7472 6173 2e63 6465 7269 7665 206f  extras.cderive o
+00003270: 7220 6e6a 6574 2e64 6572 6976 6520 636c  r njet.derive cl
+00003280: 6173 732e 0a20 2020 2020 2020 200a 2020  ass..        .  
+00003290: 2020 5265 7475 726e 730a 2020 2020 2d2d    Returns.    --
+000032a0: 2d2d 2d2d 2d0a 2020 2020 6465 7269 7665  -----.    derive
+000032b0: 206f 7220 6364 6572 6976 650a 2020 2020   or cderive.    
+000032c0: 2020 2020 416e 206e 6a65 742e 6465 7269      An njet.deri
+000032d0: 7665 206f 7220 6e6a 6574 2e65 7874 7261  ve or njet.extra
+000032e0: 732e 6364 6572 6976 6520 6f62 6a65 6374  s.cderive object
+000032f0: 2c20 636f 6e74 6169 6e69 6e67 2074 6865  , containing the
+00003300: 2072 6573 756c 7473 206f 6620 7468 6520   results of the 
+00003310: 5450 5341 2063 616c 6375 6c61 7469 6f6e  TPSA calculation
+00003320: 2c0a 2020 2020 2020 2020 6465 7065 6e64  ,.        depend
+00003330: 696e 6720 6f6e 2074 6865 2027 6d6f 6465  ing on the 'mode
+00003340: 2720 7061 7261 6d65 7465 722e 0a20 2020  ' parameter..   
+00003350: 2072 0100 0000 7a15 4e6f 206f 7065 7261   r....z.No opera
+00003360: 746f 7220 7072 6f76 6964 6564 2e63 0100  tor provided.c..
+00003370: 0000 0000 0000 0000 0000 0200 0000 0400  ................
+00003380: 0000 1300 0000 7318 0000 0067 007c 005d  ......s....g.|.]
+00003390: 087d 017c 016a 006a 0188 006b 0291 0271  .}.|.j.j...k...q
+000033a0: 0253 0072 2500 0000 2902 da08 6172 6775  .S.r%...)...argu
+000033b0: 6d65 6e74 720d 0000 0029 0272 4400 0000  mentr....).rD...
+000033c0: da02 6f70 7267 0000 0072 2500 0000 7226  ..oprg...r%...r&
+000033d0: 0000 0072 4700 0000 8501 0000 7302 0000  ...rG.......s...
+000033e0: 0018 007a 1874 7073 612e 3c6c 6f63 616c  ...z.tpsa.<local
+000033f0: 733e 2e3c 6c69 7374 636f 6d70 3e7a 264e  s>.<listcomp>z&N
+00003400: 6f74 2061 6c6c 206f 7065 7261 746f 7220  ot all operator 
+00003410: 6469 6d65 6e73 696f 6e73 2061 7265 2065  dimensions are e
+00003420: 7175 616c 2e72 0600 0000 da05 6f72 6465  qual.r......orde
+00003430: 7272 8000 0000 da07 6465 6661 756c 744e  rr......defaultN
+00003440: da05 6368 6169 6e63 0000 0000 0000 0000  ..chainc........
+00003450: 0000 0000 0300 0000 0500 0000 1f00 0000  ................
+00003460: 732c 0000 0074 0074 0188 0183 0183 0144  s,...t.t.......D
+00003470: 005d 0d7d 0288 0088 017c 0219 0019 007c  .].}.....|.....|
+00003480: 0069 007c 01a4 018e 017d 0071 067c 0053  .i.|.....}.q.|.S
+00003490: 0072 6b00 0000 2902 7216 0000 0072 4800  .rk...).r....rH.
+000034a0: 0000 2903 726c 0000 00da 076b 7761 7267  ..).rl.....kwarg
+000034b0: 7331 723f 0000 0029 02da 036f 7073 7282  s1r?...)...opsr.
+000034c0: 0000 0072 2500 0000 7226 0000 0072 8800  ...r%...r&...r..
+000034d0: 0000 9701 0000 7306 0000 0010 0118 0104  ......s.........
+000034e0: 017a 1374 7073 612e 3c6c 6f63 616c 733e  .z.tpsa.<locals>
+000034f0: 2e63 6861 696e 2902 7278 0000 0072 8600  .chain).rx...r..
+00003500: 0000 2903 7278 0000 0072 8600 0000 7282  ..).rx...r....r.
+00003510: 0000 007a 0f4f 7574 7075 7420 666f 726d  ...z.Output form
+00003520: 6174 2027 7a11 2720 6e6f 7420 7265 636f  at 'z.' not reco
+00003530: 676e 697a 6564 2e29 0b72 4800 0000 7284  gnized.).rH...r.
+00003540: 0000 0072 0d00 0000 722d 0000 00da 046b  ...r....r-.....k
+00003550: 6579 73da 0370 6f70 7216 0000 0072 0200  eys..popr....r..
+00003560: 0000 7204 0000 00da 0c52 756e 7469 6d65  ..r......Runtime
+00003570: 4572 726f 72da 0465 7661 6c29 0a72 8100  Error..eval).r..
+00003580: 0000 7282 0000 0072 8300 0000 728a 0000  ..r....r....r...
+00003590: 0072 3300 0000 7278 0000 0072 8600 0000  .r3...rx...r....
+000035a0: 7288 0000 00da 0664 6368 6169 6eda 015f  r......dchain.._
+000035b0: 7225 0000 0029 0372 0d00 0000 728a 0000  r%...).r....r...
+000035c0: 0072 8200 0000 7226 0000 00da 0474 7073  .r....r&.....tps
+000035d0: 615c 0100 0073 2c00 0000 1427 0c01 1e01  a\...s,....'....
+000035e0: 0801 1001 0a01 0802 0401 0801 1004 0401  ................
+000035f0: 0802 0801 0c01 0e02 1004 0801 1401 1002  ................
+00003600: 0c02 1001 0401 7291 0000 0054 6303 0000  ......r....Tc...
+00003610: 0000 0000 0000 0000 000d 0000 000e 0000  ................
+00003620: 0043 0000 0073 1c01 0000 7400 7c00 8301  .C...s....t.|...
+00003630: 7d03 7c03 6401 1600 6402 6b02 730e 4a00  }.|.d...d.k.s.J.
+00003640: 6403 8301 8201 7c03 6401 1a00 7d04 7401  d.....|.d...}.t.
+00003650: 6404 6405 8400 7c00 4400 8301 8301 7d05  d.d...|.D.....}.
+00003660: 6900 7d06 7c05 7402 6406 8301 6b02 7227  i.}.|.t.d...k.r'
+00003670: 7403 6407 8301 8201 7404 7c04 8301 4400  t.d.....t.|...D.
+00003680: 5d60 7d07 7404 7c07 7c04 8302 4400 5d58  ]`}.t.|.|...D.]X
+00003690: 7d08 7c00 7c07 1900 7c00 7c08 7c04 1700  }.|.|...|.|.|...
+000036a0: 1900 1000 7d09 7c07 7c08 6b02 7246 7c09  ....}.|.|.k.rF|.
+000036b0: 6408 3700 7d09 7404 7c05 8301 4400 5d3f  d.7.}.t.|...D.]?
+000036c0: 7d0a 7405 7c09 a006 7c0a a101 8301 7d0b  }.t.|...|.....}.
+000036d0: 7400 7c0b 8301 6402 6b02 725a 714a 7407  t.|...d.k.rZqJt.
+000036e0: a008 7409 7c0b a00a a100 8301 a101 7d0c  ..t.|.........}.
+000036f0: 7c0c 7c01 6b04 7289 7401 7c06 a00b 7c0a  |.|.k.r.t.|...|.
+00003700: 6402 a102 7c0c 6702 8301 7c06 7c0a 3c00  d...|.g...|.|.<.
+00003710: 7c02 7289 740c a00d 6409 7c0a 9b00 640a  |.r.t...d.|...d.
+00003720: 7c07 7c08 6602 9b00 640b 7c0c 9b00 640c  |.|.f...d.|...d.
+00003730: 7c01 9b00 640d 9d09 a101 0100 714a 7132  |...d.......qJq2
+00003740: 712b 7c06 5300 290e 6151 0200 000a 2020  q+|.S.).aQ....  
+00003750: 2020 4368 6563 6b20 7768 6574 6865 7220    Check whether 
+00003760: 6120 6769 7665 6e20 5461 796c 6f72 206d  a given Taylor m
+00003770: 6170 2c20 6465 7363 7269 6265 6420 6173  ap, described as
+00003780: 2061 2073 6574 206f 6620 4c69 652d 706f   a set of Lie-po
+00003790: 6c79 6e6f 6d69 616c 732c 2064 6573 6372  lynomials, descr
+000037a0: 6962 6573 2061 2073 796d 706c 6563 746f  ibes a symplecto
+000037b0: 6d6f 7270 6869 736d 2e0a 2020 2020 0a20  morphism..    . 
+000037c0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+000037d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+000037e0: 2070 3a20 6c69 7374 206f 6620 706f 6c79   p: list of poly
+000037f0: 206f 626a 6563 7473 0a20 2020 2020 2020   objects.       
+00003800: 2054 6865 2054 6179 6c6f 7220 6d61 7020   The Taylor map 
+00003810: 746f 2062 6520 6368 6563 6b65 642e 0a20  to be checked.. 
+00003820: 2020 2020 2020 200a 2020 2020 746f 6c3a         .    tol:
+00003830: 2066 6c6f 6174 0a20 2020 2020 2020 2054   float.        T
+00003840: 6865 2074 6f6c 6572 616e 6365 2061 6761  he tolerance aga
+00003850: 696e 7374 2074 6f20 6368 6563 6b20 7468  inst to check th
+00003860: 6520 7265 6c61 7469 6f6e 3a0a 2020 2020  e relation:.    
+00003870: 2020 2020 705b 695d 4070 5b6a 202b 2064      p[i]@p[j + d
+00003880: 696d 5d20 3d20 2d31 6a2a 6465 6c74 615f  im] = -1j*delta_
+00003890: 7b69 6a7d 0a20 2020 2020 2020 2069 6e20  {ij}.        in 
+000038a0: 616e 7920 6f72 6465 722e 0a20 2020 2020  any order..     
+000038b0: 2020 200a 2020 2020 7761 726e 3a20 626f     .    warn: bo
+000038c0: 6f6c 6561 6e2c 206f 7074 696f 6e61 6c0a  olean, optional.
+000038d0: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
+000038e0: 2072 6169 7365 2061 2077 6172 6e69 6e67   raise a warning
+000038f0: 2065 7665 7279 2074 696d 6520 7468 6520   every time the 
+00003900: 6368 6563 6b20 6661 696c 7320 6174 2073  check fails at s
+00003910: 6f6d 6520 7374 6570 2e0a 2020 2020 2020  ome step..      
+00003920: 2020 0a20 2020 2052 6574 7572 6e73 0a20    .    Returns. 
+00003930: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2064     -------.    d
+00003940: 6963 740a 2020 2020 2020 2020 4120 6469  ict.        A di
+00003950: 6374 696f 6e61 7279 206d 6170 7069 6e67  ctionary mapping
+00003960: 2074 6865 2070 6f77 6572 7320 746f 2074   the powers to t
+00003970: 6865 206d 6178 696d 616c 2065 7272 6f72  he maximal error
+00003980: 2077 6865 6e65 7665 7220 6120 6368 6563   whenever a chec
+00003990: 6b20 6661 696c 6564 2e0a 2020 2020 7206  k failed..    r.
+000039a0: 0000 0072 0100 0000 7a1e 4469 6d65 6e73  ...r....z.Dimens
+000039b0: 696f 6e20 6f66 206d 6170 206d 7573 7420  ion of map must 
+000039c0: 6265 2065 7665 6e2e 6301 0000 0000 0000  be even.c.......
+000039d0: 0000 0000 0002 0000 0003 0000 0053 0000  .............S..
+000039e0: 0073 1200 0000 6700 7c00 5d05 7d01 7c01  .s....g.|.].}.|.
+000039f0: 6a00 9102 7102 5300 7225 0000 0029 0172  j...q.S.r%...).r
+00003a00: 6600 0000 727a 0000 0072 2500 0000 7225  f...rz...r%...r%
+00003a10: 0000 0072 2600 0000 7247 0000 00be 0100  ...r&...rG......
+00003a20: 0073 0200 0000 1200 7a1c 7379 6d63 6865  .s......z.symche
+00003a30: 636b 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973  ck.<locals>.<lis
+00003a40: 7463 6f6d 703e da03 696e 667a 256d 6178  tcomp>..infz%max
+00003a50: 5f70 6f77 6572 206f 6620 6d61 7020 6361  _power of map ca
+00003a60: 6e20 6e6f 7420 6265 2069 6e66 696e 6974  n not be infinit
+00003a70: 652e 7272 0000 007a 2354 6179 6c6f 7220  e.rr...z#Taylor 
+00003a80: 6d61 7020 6e6f 6e2d 7379 6d70 6c65 6374  map non-symplect
+00003a90: 6963 2061 7420 6f72 6465 7220 7a10 2066  ic at order z. f
+00003aa0: 6f72 2063 6f6d 706f 6e65 6e74 7320 7a09  or components z.
+00003ab0: 2e20 4572 726f 723a 207a 0720 2874 6f6c  . Error: z. (tol
+00003ac0: 3a20 fa01 2929 0e72 4800 0000 da03 6d61  : ..)).rH.....ma
+00003ad0: 78da 0566 6c6f 6174 728d 0000 0072 1600  x..floatr....r..
+00003ae0: 0000 722c 0000 0072 4c00 0000 7212 0000  ..r,...rL...r...
+00003af0: 00da 0461 6d61 7872 1400 0000 722b 0000  ...amaxr....r+..
+00003b00: 0072 1700 0000 da08 7761 726e 696e 6773  .r......warnings
+00003b10: da04 7761 726e 290d 723c 0000 0072 3200  ..warn).r<...r2.
+00003b20: 0000 7298 0000 0072 1a00 0000 720d 0000  ..r....r....r...
+00003b30: 0072 6600 0000 da06 7265 7375 6c74 723f  .rf.....resultr?
+00003b40: 0000 00da 016c da05 6368 6563 6b72 8600  .....l..checkr..
+00003b50: 0000 da0b 6368 6563 6b5f 6f72 6465 72da  ....check_order.
+00003b60: 096d 6178 5f65 7272 6f72 7225 0000 0072  .max_errorr%...r
+00003b70: 2500 0000 7226 0000 00da 0873 796d 6368  %...r&.....symch
+00003b80: 6563 6ba5 0100 0073 3200 0000 0816 1401  eck....s2.......
+00003b90: 0801 1201 0401 0c01 0801 0c02 0e01 1401  ................
+00003ba0: 0801 0801 0c02 0e05 0c01 0201 1201 0801  ................
+00003bb0: 1801 0401 2801 0280 02f4 02fb 0413 729e  ....(.........r.
+00003bc0: 0000 0029 0272 0100 0000 7228 0000 0029  ...).r....r(...)
+00003bd0: 0154 291a da05 6e75 6d70 7972 1200 0000  .T)...numpyr....
+00003be0: 7297 0000 00da 046e 6a65 7472 0200 0000  r......njetr....
+00003bf0: 7203 0000 00da 0b6e 6a65 742e 6578 7472  r......njet.extr
+00003c00: 6173 7204 0000 00da 0f6c 6965 6f70 732e  asr......lieops.
+00003c10: 636f 7265 2e6c 6965 722e 0000 00da 146c  core.lier......l
+00003c20: 6965 6f70 732e 6c69 6e61 6c67 2e6d 6174  ieops.linalg.mat
+00003c30: 7269 7872 0500 0000 7227 0000 0072 3800  rixr....r'...r8.
+00003c40: 0000 7241 0000 0072 4b00 0000 7252 0000  ..rA...rK...rR..
+00003c50: 0072 5600 0000 725c 0000 0072 5f00 0000  .rV...r\...r_...
+00003c60: 7265 0000 0072 6a00 0000 7275 0000 0072  re...rj...ru...r
+00003c70: 7f00 0000 7291 0000 0072 9e00 0000 7225  ....r....r....r%
+00003c80: 0000 0072 2500 0000 7225 0000 0072 2600  ...r%...r%...r&.
+00003c90: 0000 da08 3c6d 6f64 756c 653e 0100 0000  ....<module>....
+00003ca0: 7328 0000 0008 0108 0110 020c 0108 020c  s(..............
+00003cb0: 0108 020a 3f08 4808 1608 0908 3308 1608  ....?.H.....3...
+00003cc0: 0b0e 0a08 0c12 0808 1d12 1c0e 49         ............I
```

### Comparing `lieops-0.2.1/lieops/core/birkhoff.py` & `lieops-0.2.2/lieops/core/birkhoff.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,10 +1,11 @@
 import lieops.core.lie
 from lieops.solver.common import getRealHamiltonFunction
 from lieops.linalg.nf import first_order_nf_expansion
+from lieops.linalg.matrix import emat
 from lieops.core.tools import ad2poly
 
 def homological_eq(mu, Z, **kwargs):
     '''
     Let e[k], k = 1, ..., len(mu) be actions, H0 := sum_k mu[k]*e[k] and Z a
     polynomial of degree n. Then this routine will solve 
     the homological equation 
@@ -38,15 +39,15 @@
         om = sum([(powers[k] - powers[Z.dim + k])*mu[k] for k in range(len(mu))])
         if om != 0:
             chi[powers] = 1j/om*value
         else:
             Q[powers] = value
     return chi, Q
 
-def bnf(H, order: int=1, tol=1e-12, cmplx=True, **kwargs):
+def bnf(H, order: int=1, tol_drop=0, tol=1e-12, cmplx=True, **kwargs):
     '''
     Compute the Birkhoff normal form of a given Hamiltonian up to a specific order.
     
     Attention: Constants and any gradients of H at z will be ignored. If there is 
     a non-zero gradient, a warning is issued by default.
     
     Parameters
@@ -64,26 +65,30 @@
         k homogeneous Lie-polynomials, where the smallest one will have power k + 2 and the 
         succeeding ones will have increased powers by 1.
     
     cmplx: boolean, optional
         If false, assume that the coefficients of the second-order terms of the Hamiltonian are real.
         In this case a check will be done and an error will be raised if that is not the case.
         
+    tol_drop: float, optional
+        Tolerance below which values in the Hamiltonian are set to zero.
+        
     tol: float, optional
-        Tolerance below which values are assumed to be zero.
+        Tolerance for consistency checks.
         
     **kwargs
         Keyword arguments are passed to lieops.linalg.nf.first_order_nf_expansion routine.
         
     Returns
     -------
     dict
         A dictionary with the following keys:
         nfdict : The output of lieops.linalg.nf.first_order_nf_expansion.
-        H      : Dictionary denoting the used Hamiltonian.
+        H_func : Callable denoting the Hamiltonian in (q, p)-coordinates whose derivatives will be calculated.
+        H      : Dictionary denoting the Hamiltonian used at the start of the normal form procedure.
         H0     : Dictionary denoting the second-order coefficients of H.
         mu     : List of the tunes used (coefficients of H0).
         chi    : List of poly objects, denoting the Lie-polynomials of degree >= 3 which map to normal form.
         chi0   : List of the two Lie-polynomials of degree 2 which map the given Hamiltonian 
                  to its first-order normal form equivalent. This means that the list "chi0 + chi" performs the 
                  entire map up to the desired order (see also the example below). Not supported if mpmath has been used.                 
         Hk     : List of poly objects, corresponding to the transformed Hamiltonians.
@@ -115,15 +120,15 @@
         # assume that H is given as a function, depending on phase space coordinates.
         kwargs['power'] = power
         Hinp = H
         if isinstance(H, lieops.core.lie.poly):
             # we have to transfom the call-routine of H: H depend on (xi, eta)-coordinates, but the nf routines later on assume (q, p)-coordinates.
             # In principle, one can change this transformation somewhere else, but this may cause the normal form routines
             # to either yield inconsistent output at a general point z -- or it may introduce additional complexity.
-            Hinp = getRealHamiltonFunction(H, tol=tol, **kwargs)
+            Hinp = getRealHamiltonFunction(H, tol_drop=tol_drop)
         taylor_coeffs, nfdict = first_order_nf_expansion(Hinp, tol=tol, **kwargs)
         # N.B. while Hinp is given in terms of (q, p) variables, taylor_coeffs correspond to the Taylor-expansion
         # of the Hamiltonian around z=(q0, p0) with respect to the normal form (xi, eta) coordinates (see first_order_nf_expansion routine).
     else:
         # Attention: In this case we assume that H is already in complex normal form (CNF): Off-diagonal entries will be ignored (see code below).
         taylor_coeffs = H
         nfdict = {}
@@ -146,15 +151,15 @@
         if not cmplx:
             # by default we assume that the coefficients in front of the 2nd order terms are real.
             assert muj.imag < tol, f'Imaginary part of entry {j} above tolerance: {muj.imag} >= {tol}. Check input or try cmplx=True option.'
             muj = muj.real
         H0_values[tpl] = muj
         mu.append(muj)
     H0 = lieops.core.lie.poly(values=H0_values, dim=dim, max_power=max_power)
-    assert len({k: v for k, v in taylor_coeffs.items() if sum(k) == 2 and abs(v) >= tol}) == 0 # All other 2nd order Taylor coefficients must be zero.
+    assert len({k: v for k, v in taylor_coeffs.items() if sum(k) == 2 and (abs(v) >= tol).all()}) == 0 # All other 2nd order Taylor coefficients must be zero.
 
     # For H, we take the values of H0 and add only higher-order terms (so we skip any gradients (and constants). 
     # Note that the skipping of gradients leads to an artificial normal form which may not have any relation
     # to the original problem. By default, the user will be informed if there is a non-zero gradient 
     # in 'first_order_nf_expansion' routine.
     H = H0.update({k: v for k, v in taylor_coeffs.items() if sum(k) > 2})
         
@@ -187,14 +192,15 @@
         Zk_all.append(Zk)
         Qk_all.append(Q)
 
     # assemble output
     out = {}
     out['nfdict'] = nfdict
     out['H'] = H
+    out['H_func'] = Hinp
     out['H0'] = H0
     out['mu'] = mu
     out['lchi_inv'] = lchi_all
     out['chi'] = chi_all
     out['Hk'] = Hk_all
     out['Zk'] = Zk_all
     out['Qk'] = Qk_all
@@ -203,11 +209,12 @@
     out['max_power'] = max_power
     
     out['chi0'] = []
     for clabel in ['C1', 'C2']:
         if clabel in nfdict.keys():
             # In this case we can also compute the polynomials which provide the transformation to first-order normal form:
             C = nfdict[clabel]
-            Cp = ad2poly(C.transpose()) # transposition required (see e.g. Sec. 8.3.5 "Dual role of the Phase-Space Coordinates" in Dragt's book)
+            C = emat(C).transpose().matrix # transposition required (see e.g. Sec. 8.3.5 "Dual role of the Phase-Space Coordinates" in Dragt's book)
+            Cp = ad2poly(C)
             out['chi0'].append(Cp)
         
     return out
```

### Comparing `lieops-0.2.1/lieops/core/combine/.ipynb_checkpoints/bch-checkpoint.py` & `lieops-0.2.2/lieops/core/combine/.ipynb_checkpoints/bch-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/combine/.ipynb_checkpoints/magnus-checkpoint.py` & `lieops-0.2.2/lieops/core/combine/.ipynb_checkpoints/magnus-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/combine/__pycache__/bch.cpython-310.pyc` & `lieops-0.2.2/lieops/core/combine/__pycache__/bch.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/combine/__pycache__/bruteforce.cpython-310.pyc` & `lieops-0.2.2/lieops/core/combine/__pycache__/bruteforce.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/combine/__pycache__/magnus.cpython-310.pyc` & `lieops-0.2.2/lieops/core/combine/__pycache__/magnus.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/combine/bch.py` & `lieops-0.2.2/lieops/core/combine/bch.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/combine/bch20.csv` & `lieops-0.2.2/lieops/core/combine/bch20.csv`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/combine/magnus.py` & `lieops-0.2.2/lieops/core/combine/magnus.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/dragt.py` & `lieops-0.2.2/lieops/core/dragt.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,17 +1,29 @@
 import numpy as np
 from scipy.linalg import expm, logm
 from tqdm import tqdm
 import warnings
 
-from lieops.linalg.matrix import create_J
+from njet.common import check_zero
+
+from lieops.linalg.matrix import create_J, emat
 from lieops.linalg.nf import symlogs
+from lieops.linalg.common import ndsupport
+
 from lieops.core.lie import create_coords, lexp
 from lieops.core.tools import const2poly, poly2vec, ad2poly
 
+@ndsupport
+def logm_nd(X, **kwargs):
+    return logm(X, **kwargs)
+
+@ndsupport
+def expm_nd(X, **kwargs):
+    return expm(X, **kwargs)
+
 def _integrate_k(p, k: int):
     '''
     Let p be a Lie polynomial. Then this routine will
     compute the integral of p*dz_k, where z_k denotes the k-th component.
     '''
     integral_values = {}
     dim = p.dim
@@ -162,15 +174,15 @@
         start = offset
         final = [e(*offset) for e in p]
 
     if order == 0: # In this case we can immediately return a first-order polynomial, which will provide the translation:
         diff = [final[k] - start[k] for k in range(dim2)]
         return [const2poly(*diff, poisson_factor=pf)]
 
-    start_is_nonzero = any([e != 0 for e in start])
+    start_is_nonzero = any([not check_zero(e) for e in start])
     if start_is_nonzero:
         # preparation step in case of translations, see Ref. [1], Eq. (7.7.17)
         h1 = const2poly(*start, poisson_factor=pf, max_power=max_power) # E.g.: lexp(h1)(xi) = xi + start[0] 
         p = lexp(h1)(*p, method='2flow')
         # the application of exp(:h1:), where h1 is a first-order polynomial, has produced a new Taylor map of max_deg - 1.
         # Therefore we should reduce the requested order by one if the order is larger or equal max_deg, to avoid an error with the final step: 
         # Due to truncation at the original map may not admit a symplectomorphism at the its final requested order.
@@ -180,35 +192,43 @@
             order = order - 1
 
     if order > max_deg and warn:
         warnings.warn(f'Requested order {order} > {max_deg} (maximal degree of Taylor map).')
         
     # Determine the linear part of the map
     R = np.array([poly2vec(e.homogeneous_part(1)).tolist() for e in p])
-    J = create_J(dim)
+    R = emat(R)
+    J = emat(create_J(dim))
+    Rtr = R.transpose()    
+    Ri = -J@Rtr@J # The inverse of R. 
+    
     if tol_checks > 0:
         # Symplecticity check of the map; it is crucial to check symplecticity this point *before* applying logm or symlogs etc. to avoid subtle errors produced from 'almost symplectic' maps
-        assert np.linalg.norm(R.transpose()@J@R - J) < tol_checks, f'Map not symplectic within a tolerance of {tol_checks}.'
-    
+        RtrJR = Rtr@J@R
+        JJ = create_J(dim, shape=R.shape[2:])
+        check = np.sqrt(np.linalg.norm(RtrJR.matrix - JJ)**2/np.prod(R.shape[2:])) # Division by the number of matrices as measure (seems to be good enough rather than computing the norms individually)
+        assert check < tol_checks, f'Symplecticity check fails: {check} >= {tol_checks} (tol_checks).'
+        
     # Compute the 2nd-order polynomial(s) of the Dragt/Finn factorization
     if comb2:
         try:
-            A = logm(R.transpose()) # Explanation why we have to use transpose will follow at (++)
-            SA = ad2poly(A, poisson_factor=pf, tol=tol, max_power=max_power).above(tol)
+            A = logm_nd(Rtr.matrix) # Explanation why we have to use transpose will follow at (++)
+            SA = ad2poly(A, poisson_factor=pf, tol=tol_checks, max_power=max_power).above(tol)
             SB = SA*0
             B = A*0
         except:
             if warn:
-                warnings.warn(f"Map appears to require two 2nd-order polynomials (tol: {tol}).")
+                warnings.warn(f"Map requires two 2nd-order polynomials (tol: {tol}).")
             comb2 = False
+            
     if not comb2:
-        A, B = symlogs(R.transpose(), tol2=tol_checks) # This means: exp(A) o exp(B) = R.transpose(). Explanation why we have to use transpose will follow at (++)
+        A, B = symlogs(Rtr.matrix, tol2=tol_checks) # This means: exp(A) o exp(B) = R.transpose(). Explanation why we have to use transpose will follow at (++)
         SA = ad2poly(A, poisson_factor=pf, tol=tol_checks, max_power=max_power).above(tol)
         SB = ad2poly(B, poisson_factor=pf, tol=tol_checks, max_power=max_power).above(tol)
-        
+                
     # (++) 
     # Let us assume that we would have taken "symlogs(R) = A, B" (i.e. exp(A) o exp(B) = R) and consider a 1-dim case.
     # In the following the '~' symbol means that we identify the (1, 0)-key with xi and the (0, 1)-key with eta.
     # By definition of ad2poly:
     # SA@xi ~ A@[1, 0]
     # SA@eta ~ A@[0, 1]
     # SB@xi ~ B@[1, 0]
@@ -231,15 +251,21 @@
     # lexp(SA')(*lexp(SB')(*xieta)) = R        (1)
     # This is the reason why we had to use .transpose() in the construction of SA and SB above.
     # See also Sec. 8.3.5 "Dual role of the Phase-Space Coordinates" in Dragt's book [1]. In that
     # section, the transposition can be found as well.
         
     if tol_checks > 0:
         # check if symlogs gives correct results
-        assert np.linalg.norm(expm(A)@expm(B) - R.transpose()) < tol_checks
+        # Calculate expm(A)@expm(B). In case of multi-dimensional arrays, we can not simply use
+        # the matrix multiplication operator '@' however, but instead need to multiply by hand:
+        expA, expB = expm_nd(A), expm_nd(B)
+        expA, expB = emat(expA), emat(expB)
+        expAexpB = expA@expB
+        check = np.sqrt(np.linalg.norm(expAexpB.matrix - Rtr.matrix)**2/np.prod(R.shape[2:])) # Division by the number of matrices.
+        assert check < tol_checks
         xieta = create_coords(dim, poisson_factor=pf, max_power=max_power) # for the two checks at (+) below
         # Now it holds with
         # op_result := lexp(SA)(*lexp(SB)(*xieta, power=30), power=30)
         # 1) p[k] == op_result[k]    (2)
         # 2) with
         # op_matrix = np.array([poly2vec(op) for op in op_result])
         # R == op_matrix
@@ -253,16 +279,15 @@
         # [e(*xieta0) for e in p]        (3)
         # Instead, due to the pull-back property of the lexp-operators, the correct way to obtain
         # the result (3) would be:
         # lexp(SB)(*lexp(SA)(*xieta0))   (4)
         # Note the difference of the order: Now SB and SA in Eq. (4) are reversed in comparison to Eq. (1).
 
     # Ensure that the Poincare-Lemma is met for the first step; See Ref. [1], Eq. (7.6.17):
-    Ri = -J@R.transpose()@J
-    p_new = [sum([p[k]*Ri[l, k] for k in range(dim2)]) for l in range(dim2)] # multiply Ri from right to prevent operator overloading from numpy.
+    p_new = [sum([p[k]*Ri.matrix[l, k] for k in range(dim2)]) for l in range(dim2)] # multiply Ri from right to prevent operator overloading from numpy.
     if tol > 0:
         # not dropping small values may result in a slow-down of the code. Therefore:
         p_new = [e.above(tol) for e in p_new]
         
     # Construct & collect the chain of operators of the Dragt/Finn factorization.
     # We shall collect these operators in a list 'f_all' so that the first operator 
     # in f_all is exectued first, if applied to *numbers* (see the 'Attention' section above). Hence:
@@ -325,15 +350,15 @@
         if len(f_nl) > 0:
             f_hdm = lexp(-SB)(*lexp(-SA)(*f_nl, outl1=True, method='2flow'), outl1=True, method='2flow') # the outl1 parameters are True here to cope with special cases that SA or its input is zero. In this case the Lie-operators would return a Lie-polynomial. That would cause a problem with the use of '*' here and f_hdm may also not be a list ...
         f_all = f_all + [f.above(tol) for f in f_hdm if f.above(tol) != 0] # Every entry in f_nl is non-zero (wrt. tol) by construction. Since the lexp(-SB) and lexp(-SA) operators are invertible, the elements in f_hdm are therefore also non-zero. However, the lexp-operators may still generate many small terms which should be removed here.
         
     if start_is_nonzero:
         f_all.insert(0, -h1)
             
-    if any([e != 0 for e in final]):
+    if any([not check_zero(e) for e in final]):
         g1 = const2poly(*final, poisson_factor=pf, max_power=max_power)
         if start_is_nonzero and len(f_all) == 1:
             # in this case only a single term (-h1) of order 1 is contained in f_all thus far. We shall combine this term with g1 (such a case may happen for a first-order polynomial + offset as input)
             f_all[0] += g1
         else:
             f_all.append(g1)
```

### Comparing `lieops-0.2.1/lieops/core/forest.py` & `lieops-0.2.2/lieops/core/forest.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,13 +1,13 @@
 import warnings
 import numpy as np
 from tqdm import tqdm
 
 from lieops.core import lexp, create_coords, poly
-from lieops.core.tools import ad2poly, poly2ad, tpsa
+from lieops.core.tools import ad2poly, poly2ad, tpsa, taylor_map
 from lieops.core.dragt import dragtfinn
 
 twopi = float(np.pi*2)
 
 def _rot_kernel(fk, mu):
     '''
     In case that R in Eq. (4.34), Ref. [1], consist of a rotation, we can
@@ -15,20 +15,24 @@
     '''
     dim = len(mu)
     a = {}
     for powers, value in fk.items():
         m1 = powers[:dim]
         m2 = powers[dim:]
         z = sum([(m1[k] - m2[k])*mu[k] for k in range(dim)])*1j
-        if z.real != 0 or (z.real == 0 and (z.imag/twopi)%1 != 0): # I.e. exp(z) != 1
-            a[powers] = value/(1 - np.exp(-z)) # for the -1 sign in front of z see my notes regarding Normal form (Lie_techniques.pdf); this -1 is due to the fact that R^(-1) must be considered.
+        
+        cond = np.logical_or(z.real != 0, np.logical_and(z.real == 0, (z.imag/twopi)%1 != 0)) # I.e. exp(z) != 1
+        a[powers] = np.divide(value, 1 - np.exp(-z), out=np.zeros_like(value), where=cond)
+        # Remarks:
+        # 1) for the -1 sign in front of z see my notes regarding Normal form (Lie_techniques.pdf); this -1 is due to the fact that R^(-1) must be considered.
+        # 2) The poly class will check the values "a" above by zero. Only non-zero terms will be stored.
     return poly(values=a, dim=dim, max_power=fk.max_power)
 
     
-def fnf(*p, order: int=1, mode='quick', **kwargs):
+def fnf(*p, order: int=1, mode='conj', **kwargs):
     '''
     Obtain maps to Normal form for a given chain of Lie-operators. The concept
     is outlined in Sec. 4.4 in Ref. [1].
     
     Attention:
     I)
     First-order Lie-polynomials in the resulting Dragt/Finn expansion will be dropped.
@@ -59,54 +63,72 @@
         
     tol: float, optional
         A small number to identify polynomials which should be zero. Required in dragtfinn to
         identify if the two 2nd order polynomials can be combined.
         
     mode: str, optional
         Control the way of how the successive Taylor maps are computed:
-        'quick': The Taylor map of the next step (for the map M' = exp(:ak:) M exp(-:ak:)) is computed
-                 from the previous Taylor map by pull-back using the maps exp(:ak:) and exp(-:ak:).
-                 Note that if first-order elements in the Dragt/Finn factorization are detected,
-                 one TPSA calculation will be done for this interior part.
+        'conj': The Taylor map of the next step (for the map M' = exp(:ak:) M exp(-:ak:)) is computed
+                from the previous Taylor map by conjugation with the map exp(:ak:).
+                Note that if first-order elements in the Dragt/Finn factorization are detected,
+                one TPSA calculation will be done for this interior part.
         'tpsa': The Taylor map of the next step is computed by using TPSA on M'.
-                
+        
+    Returns
+    -------
+    dict
+        A dictionary containing the following keys:
+         'dragtfinn': The output of the Dragt/Finn factorization of the given Taylor map
+            'bnfout': The output of the Birkhoff normal form routine for order 1, used in the first step
+                      in the normalization.
+            'nf_all': A list X of lists, where each element E of X contains the Lie-polynomials n_j
+                      which represent one step in the normalization procedure according to Ref. [1], 
+                      Eq. (4.31). The last elements of X therefore yield the entire normalization.
+        'normalform': The last element of 'nf_all'.
+               'chi': The normalizing Lie-polynomials in ascending order. This means that
+                      "N = chi[::-1] o M o chi[::-1]**(-1)"
+                      is the normalized form of M (the lowest orders needs to be applied on M first).
+            'tm_all': A list of Taylor-maps which were used in each step in the normalization procedure,
+                      see the discussion in Ref. [1] around Eq. (4.31).
+        'taylor_map': The last element in 'tm_all'.               
         
     Reference(s)
     ------------
     [1] E. Forest: "Beam Dynamics - A New Attitude and Framework", harwood academic publishers (1998).
     '''
     #####################
     # Progress user input
     #####################
-    tol = kwargs.get('tol', 0)
+    tol = kwargs.pop('tol', 0)
     disable_tqdm = kwargs.get('disable_tqdm', False) # show progress bar (if requested) in the loop below
     kwargs['disable_tqdm'] = True # never show progress bars within the loop(s) itself
     
     # Compute the Dragt/Finn factorization up to a specific order
     kwargs['pos2'] = 'left'
     kwargs['comb2'] = True
-    df = dragtfinn(*p, order=order, **kwargs)
+    df = dragtfinn(*p, order=order, tol=tol, **kwargs)
 
     nterms_1 = [f for f in df if f.maxdeg() > 1]
     df_orders = [f.maxdeg() for f in nterms_1]
     
     # R^(-1) != 1, otherwise the normal form will be identical to the input
     if 2 not in df_orders:
         warnings.warn('No 2nd-order terms found => Normal form identical to input.')
         return {'dragtfinn': df, 'nterms': [nterms_1], 'chi': [], 'nmaps': [p]}
     
-    # If first-order elements in the Dragt/Finn factorization have been found, and the mode was 'quick',
+    # If first-order elements in the Dragt/Finn factorization have been found, and the mode is 'conj',
     # then we will re-calculate the tpsa map p for this inner part (& raise a warning):
-    kwargs['taylor_map'] = True
+    default_max_power = kwargs.get('max_power', min([f.max_power for f in df]))
     if len(nterms_1) < len(df):
         warnings.warn('Non-zero kicks detected. Will normalize only the interior.')
-        if mode == 'quick':
-            warnings.warn("mode == 'quick' with non-zero kicks. Performing TPSA for the interior ...")
-            tpsa_out = tpsa(*[lexp(a) for a in nterms_1], order=order, **kwargs)
-            p = tpsa_out['taylor_map']
+        if mode == 'conj':
+            warnings.warn(f"mode == '{mode}' with non-zero kicks. Performing TPSA for the interior ...")
+            position = [0]*df[0].dim*2
+            tpsa_out = tpsa(*[lexp(a) for a in nterms_1], order=order, position=position, **kwargs)
+            p = taylor_map(*tpsa_out._evaluation, max_power=default_max_power)
 
     ###############################
     # II) First-order normalization
     ###############################
     i1 = df_orders.index(2)
     i2 = len(df_orders) - 1 - df_orders[::-1].index(2)
     if i1 < i2:
@@ -155,38 +177,41 @@
     all_nmaps = [nmap]
     all_nterms = [nterms_1] # to collect the successive Dragt/Finn polynomials at each iteration step
     chi = [w.copy() for w in chi0s] # to collect the maps to normal form
     nterms_k = nterms_1 # 'Running' D/F-factorization
     for k in tqdm(range(3, order + 2), disable=disable_tqdm): # k will run up and including order + 1, because 'dragtfinn' for a specific order refers to the order of the Taylor map, and therefore produces a chain of Hamiltonians up and including order + 1.
         
         # find the term of order k in the current Dragt/Finn factorization
-        orders_k = [f.maxdeg() for f in nterms_k]
-        if k in orders_k:
-            fk = nterms_k[orders_k.index(k)]
-        else:
-            # Then fk = 0, so ak = 0 as well and we just continue (lexp(ak) = 1).
+        fk_all = [f for f in nterms_k if f.maxdeg() == k]
+        if len(fk_all) == 0:
+            # Then fk = 0, so ak = 0 as well, and we just continue (lexp(ak) = 1).
             continue
+        elif len(fk_all) == 1:
+            fk = fk_all[0]
+        else:
+            raise RuntimeError(f'More than one term in the Dragt/Finn factorization at order {k} found.')
         
         ak = _rot_kernel(fk, tunes)
         chi.append(ak)
 
-        if mode == 'quick':
+        if mode == 'conj':
             xietaf = lexp(ak)(*xieta, **kwargs)
             xietaf2 = lexp(-ak)(*xieta, **kwargs)
             final_coords = [coord(*xietaf) for coord in nmap]
             nmap = [ww(*final_coords) for ww in xietaf2]
         elif mode == 'tpsa':
             # This mode is experimental and may require the removal of small non-zero operators at each step to reduce errors.
-            operators = [lexp(ak)] + [lexp(f) for f in nterms_k] + [lexp(-ak)] # or [lexp(lexp(ak)(f, **kwargs)) for f in nterms_k], but first checks indicated that this may increase numerical errors           
-            tpsa_out = tpsa(*operators, order=order, **kwargs)
-            nmap = tpsa_out['taylor_map']
+            operators = [lexp(ak)] + [lexp(f) for f in nterms_k] + [lexp(-ak)] # or [lexp(lexp(ak)(f, **kwargs)) for f in nterms_k]
+            position = [0]*df[0].dim*2
+            tpsa_out = tpsa(*operators, order=order, position=position, **kwargs)
+            nmap = taylor_map(*tpsa_out._evaluation, max_power=default_max_power)
             
         all_nmaps.append(nmap)
 
-        nterms_k = dragtfinn(*nmap, order=order, **kwargs)
+        nterms_k = dragtfinn(*nmap, order=order, tol=tol, **kwargs)
         all_nterms.append(nterms_k)
         
     out = {}
     out['dragtfinn'] = df
     out['bnfout'] = nfdict
     out['nf_all'] = all_nterms
     out['normalform'] = all_nterms[-1]
```

### Comparing `lieops-0.2.1/lieops/core/generators/.ipynb_checkpoints/__init__-checkpoint.py` & `lieops-0.2.2/lieops/core/generators/.ipynb_checkpoints/__init__-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/generators/.ipynb_checkpoints/genfunc-checkpoint.py` & `lieops-0.2.2/lieops/core/generators/.ipynb_checkpoints/genfunc-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/generators/__init__.py` & `lieops-0.2.2/lieops/core/generators/__init__.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/generators/__pycache__/__init__.cpython-310.pyc` & `lieops-0.2.2/lieops/core/generators/__pycache__/__init__.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/generators/__pycache__/genfunc.cpython-310.pyc` & `lieops-0.2.2/lieops/core/generators/__pycache__/genfunc.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/generators/genfunc.py` & `lieops-0.2.2/lieops/core/generators/genfunc.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/hadamard.py` & `lieops-0.2.2/lieops/core/hadamard.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/core/lie.py` & `lieops-0.2.2/lieops/core/lie.py`

 * *Files 2% similar despite different names*

```diff
@@ -4,16 +4,14 @@
 
 from lieops.linalg.nf import first_order_nf_expansion
 
 from .generators import genexp
 from .combine import magnus
 from .poly import _poly
 
-from lieops.core.tools import symcheck
-
 from lieops.solver import get_2flow, channell, heyoka
 from lieops.solver.splitting import recursive_monomial_split
 from lieops.solver.bruteforce import calcFlow as BFcalcFlow
 
 import lieops.core.tools
 import lieops.core.birkhoff
 
@@ -44,15 +42,15 @@
         -------
         lieoperator
             Class of type lieoperator, modeling the flow of the current Lie polynomial.
         '''
         kwargs['max_power'] = kwargs.get('max_power', self.max_power)
         return lexp(self, *args, **kwargs)
     
-    def bnf(self, order: int=1, power=10, **kwargs):
+    def bnf(self, order: int=1, **kwargs):
         '''
         Compute the Birkhoff normal form of the current Lie exponential operator.
         
         Example
         ------- 
         nf = self.bnf()
         echi1 = nf['chi'][0].flow(t=1) # exp(:chi1:)
@@ -67,15 +65,15 @@
         order: int, optional
             Order up to which the normal form should be computed.
             
         **kwargs
             Optional arguments passed to 'lieops.core.birkhoff.bnf' routine.
         '''
         kwargs['max_power'] = kwargs.get('max_power', self.max_power)
-        return lieops.core.birkhoff.bnf(self, order=order, power=power, n_args=self.dim*2, **kwargs)
+        return lieops.core.birkhoff.bnf(self, order=order, n_args=self.dim*2, **kwargs)
     
     def calcFlow(self, *args, **kwargs):
         '''
         Compute the flow of the current Lie polynomial. Shortcut for self.lexp and then calcFlow on
         the respective object.
         
         Parameters
@@ -269,14 +267,15 @@
             
         **kwargs
             Optional arguments passed to flow subroutines.
         '''
         self._flow_method = kwargs.get('method', self._flow_method)
         update = self._update_flow_parameters(**kwargs)
         if update or not self._flow_method in self._flow.keys():
+            _ = kwargs.pop('method', None) # do not pass the keyword 'method' to the underlying flow input parameters
             self._calcFlowFromParameters(**kwargs)
         # set the current flow function to the requested method.
         self.flow = self._flow[self._flow_method]['flow'] 
         
     def _calcFlowFromParameters(self, **kwargs):
         if self._flow_method == 'bruteforce':
             flow_parameters = self.get_flow_parameters()
@@ -389,15 +388,24 @@
             if kwargs.get('warn', False):
                 warnings.warn('No order provided for TPSA calculation. Attempting to set order based on max_power ...')
             assert self.argument.max_power < np.inf, f'max_power of {self.__class__.__name__}.argument can not be infinite.'
             order = self.argument.max_power + 1 # TODO: check if this is sufficient; see the comment in lieops.core.poly._poly concerning max_power
         kwargs['order'] = order
         
         # 2. Run TPSA
-        return lieops.core.tools.tpsa(self, position=position, **kwargs)
+        self._tpsa = lieops.core.tools.tpsa(self, position=position, **kwargs)
+        return self._tpsa
+    
+    def taylor_map(self, **kwargs):
+        '''
+        Return the Taylor map from a given TPSA evaluation, using the
+        dimensionn and max_power of the current Lie-operator.
+        '''
+        assert hasattr(self, '_tpsa'), 'TPSA calculation required in advance.'
+        return lieops.core.tools.taylor_map(*self._tpsa._evaluation, dim=self.argument.dim, max_power=kwargs.get('max_power', self.argument.max_power))
 
     
 class lexp(lieoperator):
     
     def __init__(self, argument, *args, **kwargs):
         '''
         Class to describe Lie operators of the form
@@ -628,19 +636,20 @@
             parameters = self._flow_parameters[method]
             assert 'components' in parameters.keys()
             
             if 'xietaf' in flow_out.keys():
                 xietaf = flow_out['xietaf']
             elif 'flow' in flow_out.keys():
                 # compute the final xi/eta-coordinates from the bare flow function, using TPSA
-                kwargs['taylor_map'] = True
-                tpsa_out = self.tpsa(**kwargs)
-                xietaf = tpsa_out['taylor_map'] # TODO: check if components = xieta (otherwise xietaf is misleading description).
+                zero = (0,)*self.argument.dim*2
+                dchain = self.tpsa(*zero, **kwargs)
+                xietaf = self.taylor_map()
+                # TODO: check if components = xieta (otherwise xietaf is misleading description).
                 flow_out['xietaf'] = xietaf
-                flow_out['dflow'] = tpsa_out['DA']
+                flow_out['dflow'] = dchain
                 self._flow[method].update(flow_out)
             else:
                 raise RuntimeError(f"No result(s) field present for method '{method}'.")
             # Compute the result by pullback: exp(:f:)Q(xi_1, ..., eta_n) = Q(exp(:f:) xi_1, ..., exp(:f:)eta_n) holds:
             final_components = [c(*xietaf) for c in parameters['components']]
             self._flow[method]['taylor_map'] = final_components
             return final_components
@@ -648,24 +657,25 @@
             return lieoperator._calcPolyFromFlow(self, **kwargs)
     
     def __call__(self, *z, **kwargs):
         if isinstance(z[0], type(self)):
             return self.bch(*z, **kwargs) # Baker-Campbell-Hausdorff (using Magnus/combine routine)
         else:
             return lieoperator.__call__(self, *z, **kwargs)
-        
-    def tpsa(self, *args, **kwargs):
+
+    def taylor_map(self, tol=0, **kwargs):
         '''
-        See lieops.core.tools.tpsa for a description.
+        Return the Taylor map from a given TPSA evaluation, using the
+        dimensionn and max_power of the current Lie-operator.
+        
+        Moreover, perform a symplecticity check if a tolerance is given.
         
         Parameters
-        ----------        
+        ----------
         tol: float, optional
-            If > 0, perform a check on symplecticity of the map.
-        '''
-        tol = kwargs.get('tol', 0)
-        tpsa_out = lieoperator.tpsa(self, *args, **kwargs)
-        if tol > 0 and 'taylor_map' in tpsa_out.keys(): # check if map is symplectic
-            _ = symcheck(tpsa_out['taylor_map'], tol=tol)
-        return tpsa_out
-
-
+            If > 0, perform a symplecticity check on the results.
+        '''        
+        tm = lieoperator.taylor_map(self, **kwargs)
+        if tol > 0:
+            _ = lieops.core.tools.symcheck(tm, tol=tol)
+        return tm
+
```

### Comparing `lieops-0.2.1/lieops/core/poly.py` & `lieops-0.2.2/lieops/core/poly.py`

 * *Files 2% similar despite different names*

```diff
@@ -179,15 +179,21 @@
             
         Returns
         -------
         poly
             A polynomial having the same keys/values as the current polynomial, but the absolute values are larger
             than the requested threshold.
         '''
-        return self.extract(value_cond=lambda x: abs(x) > tol)
+        def value_cond(x):
+            result = abs(x) > tol
+            if not hasattr(result, '__iter__'):
+                return result
+            else:
+                return result.all() # assuming a numpy array
+        return self.extract(value_cond=value_cond)
     
     def below(self, tol: float):
         '''
         Drop values above a given threshold.
         
         Parameters
         ----------
@@ -196,45 +202,58 @@
             
         Returns
         -------
         poly
             A polynomial having the same keys/values as the current polynomial, but the absolute values are smaller
             than the requested threshold.
         '''
-        return self.extract(value_cond=lambda x: abs(x) < tol)
+        def value_cond(x):
+            result = abs(x) < tol
+            if not hasattr(result, '__iter__'):
+                return result
+            else:
+                return result.all() # assuming a numpy array
+        return self.extract(value_cond=value_cond)
     
     def monomials(self):
         '''
         Return a list of the monomials of the current polynomial.
         '''
         return [self.__class__(values={k: v}, dim=self.dim, max_power=self.max_power) for k, v in self.items()]
     
     def truncate(self, k):
         '''
         Truncate the current polynomial with respect to a total power.
         '''
         return self.extract(key_cond=lambda x: sum(x) <= k)
+    
+    def _prepare_input(self, *z):
+        '''
+        Consistency check & input preparation prior to evaluation.
+        '''
+        if len(z) == self.dim and self._poisson_factor == -1j:
+            # for xi/eta-variables we conveniently conjugate the remaining components if they are not explicitly given
+            z = [e for e in z] + [e.conjugate() for e in z]
+        dim2 = self.dim*2
+        assert len(z) == dim2, f'Number of input parameters: {len(z)}, expected: {dim2} (or {self.dim})'
+        return z
         
     def __call__(self, *z):
         '''
         Evaluate the polynomial at a specific position z.
         
         Parameters
         ----------
         z: subscriptable
             The point at which the polynomial should be evaluated. It is assumed that len(z) == self.dim,
             in which case the components of z are assumed to be xi-values. Otherwise, it is assumed that len(z) == 2*self.dim,
             where z = (xi, eta) denote a set of complex conjugated coordinates.
         '''        
         # prepare input vector
-        if len(z) == self.dim and self._poisson_factor == -1j:
-            # for xi/eta-variables we conveniently conjugate the remaining components if they are not explicitly given
-            z = [e for e in z] + [e.conjugate() for e in z]
-        dim2 = self.dim*2
-        assert len(z) == dim2, f'Number of input parameters: {len(z)}, expected: {dim2} (or {self.dim})'
+        z = self._prepare_input(*z)
         
         # compute the occuring powers ahead of evaluation
         z_powers = {}
         j = 0
         for we in zip(*self.keys()):
             z_powers[j] = {k: z[j]**int(k) for k in np.unique(we)} # need to convert k to int, 
             # otherwise we get a conversion to some numpy array if z is not a float (e.g. an njet).
@@ -252,15 +271,15 @@
             for j in range(self.dim):
                 prod *= z_powers[j][k[j]]*z_powers[j + self.dim][k[j + self.dim]]
             result += prod*v # v needs to stay on the right-hand side here, because prod may be a jet class (if we compute the derivative(s) of the Lie polynomial)
             
         return result
         
     def __add__(self, other):
-        if other == 0:
+        if check_zero(other):
             return self
         add_values = {k: v for k, v in self.items()}
         if not isinstance(self, type(other)):
             # Treat other object as constant.
             zero_tpl = (0,)*self.dim*2
             add_values[zero_tpl] = add_values.get(zero_tpl, 0) + other
             max_power = self.max_power
@@ -598,37 +617,37 @@
         '''
         if len(cargs) > 0:
             out = {key: getattr(v, name)(*args, **cargs[key]) for key, v in self.items()}
         else:
             out = {key: getattr(v, name)(*args, **kwargs) for key, v in self.items()}
         return self.__class__(values=out, dim=self.dim, max_power=self.max_power)
     
-    def realBasis(self, **kwargs):
+    def realBasis(self):
         '''
         Note that it holds xi = (q + 1j*p)/sqrt2, eta = (q - 1j*p)/sqrt2.
         '''
         sqrt2 = float(np.sqrt(2))
         def trf(q, p):
             xi = (q + p*1j)/sqrt2
             eta = (q - p*1j)/sqrt2 # = xi.conjugate()
             return xi, eta
-        return self.transform(trf=trf, poisson_factor=1, **kwargs)
+        return self.transform(trf=trf, poisson_factor=1)
         
-    def complexBasis(self, **kwargs):
+    def complexBasis(self):
         '''
         Note that it holds xi = (q + 1j*p)/sqrt2, eta = (q - 1j*p)/sqrt2.
         '''
         sqrt2 = float(np.sqrt(2))
         def trf(xi, eta):
             q = (xi + eta)/sqrt2
             p = (xi - eta)/sqrt2/1j
             return q, p
-        return self.transform(trf=trf, poisson_factor=-1j, **kwargs)
+        return self.transform(trf=trf, poisson_factor=-1j)
         
-    def transform(self, trf, poisson_factor, mult_drv=False, mult_prm=False, **kwargs):
+    def transform(self, trf, poisson_factor, mult_drv=False, mult_prm=False):
         '''
         Cast the current polynomial into a different form.
         
         Parameters
         ----------
         trf: callable
             A linear transformation mapping a pair of new variables q2, p2 to original variables q1, p1.
@@ -639,21 +658,18 @@
         1 = {q1, p1}_{q1, p1} and -1j = {q1, p1}_{xi, eta}. Therefore, if transforming from q/p to xi/eta,
         the poisson factor f has to be -1j.
         
         At the moment only 2d transformations are supported; more sophisticated transformations require
         some overwork in the poisson bracket routine self.__matmul__.
         
         mult_drv: boolean, optional
-            Control of factorial and permutation coefficients. See njet.poly.jetpoly.get_taylor_coefficients for details.
+            Control of factorial and permutation coefficients. See njet.poly.jetpoly.taylor_coefficients for details.
             
         mult_prm: boolean, optional
-            Control of factorial and permutation coefficients. See njet.poly.jetpoly.get_taylor_coefficients for details.
-            
-        **kwargs
-            Arguments passed to self.__class__.
+            Control of factorial and permutation coefficients. See njet.poly.jetpoly.taylor_coefficients for details.
 
         Returns
         -------
         dict
             The coefficients of the polynomial with respect to the real q and p coordinates.
             The keys correspond to the powers with respect to (q_1, ..., q_dim, p1, ..., p_dim).
         ''' 
@@ -667,17 +683,17 @@
             q2k, p2k = trf(qk, pk)
             q2.append(q2k)
             p2.append(p2k)
         h1 = self(*(q2 + p2))
         if h1 == 0:
             rbv = {(0,)*self.dim*2: 0}
         else:
-            rbv = h1.get_taylor_coefficients(2*self.dim, facts=factorials(self.maxdeg()), 
+            rbv = h1.taylor_coefficients(2*self.dim, facts=factorials(self.maxdeg()), 
                                           mult_drv=mult_drv, mult_prm=mult_prm)
-        return self.__class__(values=rbv, poisson_factor=poisson_factor)
+        return self.__class__(values=rbv, poisson_factor=poisson_factor, max_power=self.max_power)
     
     def split(self, keys, scheme, check=False, **kwargs):
         '''
         Split the Hamiltonian with respect to a set of keys. 
         Return a list of polynomials according to the requested number of slices and the splitting.
         
         Parameters
```

### Comparing `lieops-0.2.1/lieops/core/tools.py` & `lieops-0.2.2/lieops/core/tools.py`

 * *Files 14% similar despite different names*

```diff
@@ -1,12 +1,13 @@
 # collection of specialized tools operating on polynomials
 import numpy as np
 import warnings
 
-from njet import derive, get_taylor_coefficients
+from njet import derive, taylor_coefficients
+from njet.extras import cderive
 
 import lieops.core.lie
 from lieops.linalg.matrix import create_J
 
 def poly2ad(pin):
     '''
     Compute a (2n)x(2n)-matrix representation of a homogenous second-order polynomial A,
@@ -30,39 +31,48 @@
     array-like
         A complex matrix corresponding to the representation.
     '''
     assert pin.maxdeg() == 2 and pin.mindeg() == 2
     dim = pin.dim
     dim2 = dim*2
     poisson_factor = pin._poisson_factor
-    A = np.zeros([dim2, dim2], dtype=np.complex128)
+    
+    # Determine shape of input values
+    val0 = next(iter(pin))
+    if hasattr(val0, 'shape'):
+        A = np.zeros([dim2, dim2] + list(val0.shape), dtype=np.complex128)
+        zero = np.zeros(val0.shape)
+    else:
+        A = np.zeros([dim2, dim2], dtype=np.complex128)
+        zero = 0
+    
     for i in range(dim):
         for j in range(dim):
             mixed_key = [0]*dim2 # key belonging to xi_i*eta_j
             mixed_key[i] += 1
             mixed_key[j + dim] += 1
-            A[i, j] = pin.get(tuple(mixed_key), 0)*-poisson_factor
-            A[j + dim, i + dim] = pin.get(tuple(mixed_key), 0)*poisson_factor
+            A[i, j, ...] = pin.get(tuple(mixed_key), zero)*-poisson_factor
+            A[j + dim, i + dim, ...] = pin.get(tuple(mixed_key), zero)*poisson_factor
             
             if i != j: # if i and j are different, than the key in the polynomial already
                 # corresponds to the sum of the ij and the ji-coefficient. But if they are equal,
                 # then the values has to be multiplied by 2, because we have to use the ij + ji-components.
                 ff = 1
             else:
                 ff = 2
                 
             hom_key_xi = [0]*dim2 # key belonging to xi_i*xi_j
             hom_key_xi[i] += 1
             hom_key_xi[j] += 1
-            A[i, j + dim] = pin.get(tuple(hom_key_xi), 0)*poisson_factor*ff
+            A[i, j + dim, ...] = pin.get(tuple(hom_key_xi), zero)*poisson_factor*ff
 
             hom_key_eta = [0]*dim2 # key belonging to eta_i*eta_j
             hom_key_eta[i + dim] += 1
             hom_key_eta[j + dim] += 1
-            A[i + dim, j] = pin.get(tuple(hom_key_eta), 0)*-poisson_factor*ff
+            A[i + dim, j, ...] = pin.get(tuple(hom_key_eta), zero)*-poisson_factor*ff
     return A
 
 def ad2poly(A, tol=0, poisson_factor=-1j, **kwargs):
     '''
     Transform a complex (2n)x(2n)-matrix representation of a polynomial back to 
     its polynomial xi/eta-representation. This is the inverse of the 'poly2ad' routine.
     
@@ -103,17 +113,17 @@
             if tol > 0:
                 # Check if the given matrix is an element of sp(2n; C). If this check fails,
                 # no valid polynomial representation can be obtained.
                 error_msg = f'{A}\nMatrix not in sp(2n; C), the Lie-algebra of complex symplectic matrices (tol: {tol}).'
                 c1 = abs(A[i, j] + A[j + dim, i + dim])
                 c2 = abs(A[i, j + dim] - A[j, i + dim])
                 c3 = abs(A[i + dim, j] - A[j + dim, i])
-                assert c1 < tol, error_msg + f'({c1}).'
-                assert c2 < tol, error_msg + f'({c2}).'
-                assert c3 < tol, error_msg + f'({c3}).'
+                assert (c1 < tol).all(), error_msg + f'({c1}).'
+                assert (c2 < tol).all(), error_msg + f'({c2}).'
+                assert (c3 < tol).all(), error_msg + f'({c3}).'
             
             mixed_key = [0]*dim2 # key belonging to a coefficient of mixed xi/eta variables.
             mixed_key[i] += 1
             mixed_key[j + dim] += 1            
             values[tuple(mixed_key)] = A[i, j]*-1/poisson_factor
             
             # The factor 'ff' comes from the fact that the poly objects terms of the form xi_i*xi_j (for i != j) and xi_j*xi_i are equal.
@@ -136,19 +146,28 @@
 def poly2vec(p):
     '''
     Map a first-order polynomial to its respective vector in matrix representation 
     (see also 'poly2ad' routine)
     '''
     assert p.maxdeg() == 1 and p.mindeg() == 1
     dim = p.dim
-    out = np.zeros(dim*2, dtype=np.complex128)
+    
+    # Determine the shape of the zeros to be filled:
+    v0 = next(iter(p))
+    if hasattr(v0, 'shape'):
+        zeros = np.zeros(v0.shape, dtype=np.complex128)
+    else:
+        zeros = 0
+        
+    out = [zeros]*dim*2
     for k, v in p.items():
         j = list(k).index(1)
         out[j] = v
-    return out
+        
+    return np.array(out, dtype=np.complex128)
 
 def vec2poly(v):
     '''
     The inverse of 'poly2vec' routine.
     '''
     dim2 = len(v)
     assert dim2%2 == 0, 'Dimension must be even.'
@@ -175,31 +194,39 @@
     array-like
         A complex matrix corresponding to the representation.
     '''
     assert pin.maxdeg() <= 2 and pin.mindeg() >= 1 # Regarding the second condition: Constants have no effect as 'ad' and therefore 'ad' can not be inverted. Since we want poly3ad to be invertible, we have to restrict to polynomials without such constant terms.
     dim = pin.dim
     dim2 = dim*2
     poisson_factor = pin._poisson_factor
-    # extended space: (xi/eta)-phase space + constants.
-    pmat = np.zeros([dim2 + 1, dim2 + 1], dtype=np.complex128) 
+    
+    # Determine shape of input values; extended space: (xi/eta)-phase space + constants.
+    val0 = next(iter(pin))
+    if hasattr(val0, 'shape'):
+        pmat = np.zeros([dim2 + 1, dim2 + 1] + list(val0.shape), dtype=np.complex128)
+        zero = np.zeros(val0.shape)
+    else:
+        pmat = np.zeros([dim2 + 1, dim2 + 1], dtype=np.complex128)
+        zero = 0
+        
     # 1. Add the representation with respect to 2x2-matrices:
     pin2 = pin.homogeneous_part(2)
     if len(pin2) != 0:
-        pmat[:dim2, :dim2] = poly2ad(pin2)
+        pmat[:dim2, :dim2, ...] = poly2ad(pin2)
     # 2. Add the representation with respect to the scalar:
     pin1 = pin.homogeneous_part(1)
     if len(pin1) != 0:
         for k in range(dim):
             xi_key = [0]*dim2
             xi_key[k] = 1
-            pmat[dim2, k + dim] = pin1.get(tuple(xi_key), 0)*poisson_factor
+            pmat[dim2, k + dim, ...] = pin1.get(tuple(xi_key), zero)*poisson_factor
 
             eta_key = [0]*dim2
             eta_key[k + dim] = 1
-            pmat[dim2, k] = pin1.get(tuple(eta_key), 0)*-poisson_factor
+            pmat[dim2, k, ...] = pin1.get(tuple(eta_key), zero)*-poisson_factor
     return pmat
 
 def ad3poly(A, **kwargs):
     '''
     The inverse of the 'poly3ad' routine.
     '''
     assert A.shape[0] == A.shape[1]
@@ -240,22 +267,22 @@
     p1 = vec2poly(vec[:-1], **kwargs)
     p1[(0,)*n2] = vec[-1]
     return p1
 
 def const2poly(*const, poisson_factor=-1j, **kwargs):
     '''
     Let c_1, ..., c_{2n} be constants. Then compute a first-order polynomial g_1
-    so that {g_1, z_j} = z_j + c_j holds.
+    so that {g_1, z_j} = z_j + c_j holds, where the z_j are canonical coordinates.
     '''
     dim2 = len(const)
     assert dim2%2 == 0, 'Dimension must be even.'
     dim = dim2//2
     J = create_J(dim)
-    xieta = lieops.core.lie.create_coords(dim, poisson_factor=poisson_factor, **kwargs)
-    return sum([xieta[k]*(J@const)[k] for k in range(dim2)])/poisson_factor
+    xieta = lieops.core.lie.create_coords(dim, poisson_factor=poisson_factor, **kwargs)    
+    return sum([xieta[k]*(np.tensordot(J, const, axes=(1, 0)))[k] for k in range(dim2)])/poisson_factor
 
 def poly2const(p1):
     '''
     The inverse of the 'const2poly' routine.
     '''
     assert p1.mindeg() == 1 and p1.maxdeg() == 1
     xieta = lieops.core.lie.create_coords(p1.dim, poisson_factor=p1._poisson_factor, max_power=p1.max_power)
@@ -286,15 +313,15 @@
     poly
         The poly object {X, C} (or {f(X), C}, if a function has been provided).
     '''
     assert len(mu) == C.dim
     return lieops.core.lie.poly(values={powers: v*func(sum([(powers[k] - powers[k + C.dim])*mu[k] for k in range(C.dim)])*1j) for powers, v in C.items()}, 
                 dim=C.dim, max_power=C.max_power)
 
-def get_taylor_map(*evaluation, **kwargs):
+def taylor_map(*evaluation, **kwargs):
     '''
     Obtain the Taylor map from a given jet evaluation in terms of lieops.core.lie.poly objects.
     
     Parameters
     ----------
     evaluation(s):
         n-jet objects containing polyjet objects.
@@ -311,74 +338,89 @@
         
     Returns
     -------
     list
         A list of poly objects, representing the Taylor map.
     '''
     n_args = kwargs.get('dim2', len(evaluation))
-    tc = get_taylor_coefficients(evaluation, mult_prm=True, mult_drv=False, n_args=n_args, output_format=1)
+    tc = taylor_coefficients(evaluation, mult_prm=True, mult_drv=False, n_args=n_args, output_format=1)
     return [lieops.core.lie.poly(values=e, **kwargs) for e in tc]
 
-def tpsa(*ops, position=[], order: int, taylor_map=False, **kwargs):
+def tpsa(*ops, position=[], ordering=None, mode='auto', **kwargs):
     '''
-    Pass n-jets through the flow functions of a chain of Lie-operators.
+    Pass n-jets through the flow functions of a chain of Lie-operators
+    to compute the result for every cycle.
 
     Parameters
     ----------
     *ops: lieoperator(s)
         An operator or a list of operators which should be derived. In case a list
-        is given, the first element of the list will be called first.
+        is given, the first element of the list will be processed first.
     
-    position: list
-        An optional point of reference. By default the position will be the origin.
-
     order: int
-        The number of derivatives we want to take into account.
-        
-    taylor_map: boolean, optional
-        If true, also compute the taylor map.
+        The number of derivatives which should be taken into account.
+
+    position: list, optional
+        An optional point of reference. If nothing specified, no evaluation of the
+        internal 'derive' (or 'cderive') object will be made. Otherwise, a
+        jet-evaluation at the requested position will be made.
+        
+    ordering: list, optional
+        A list defining an optinonal ordering of the operators. See njet.extras.cderive for
+        details. If nothing provided, the ordering from the given operators is used and
+        an njet.derive object will be used instead.
+        
+    mode: str, optional
+        Control the type of output.
+        'default': return an object of type njet.derive. 
+          'chain': Return an object of type njet.extras.cderive.
+           'auto': Select the result based on the number of unique elements in the given chain.
 
     **kwargs
-        Optional keyworded arguments passed to njet.derive class (and therefore the underlying
-        operators of this beamline).
+        Optional keyworded arguments passed to njet.extras.cderive or njet.derive class.
         
     Returns
     -------
-    dict
-        A dictionary containing the results of the TPSA run.
-                DA: njet derive object, containing the jet evaluation results.
-             input: The input parameters used.
-        taylor_map: (Only if taylor_map == True) A list of poly objects, representing the Taylor map of 
-                    the given operators at 'position'.
+    derive or cderive
+        An njet.derive or njet.extras.cderive object, containing the results of the TPSA calculation,
+        depending on the 'mode' parameter.
     '''
     assert len(ops) > 0, 'No operator provided.'
     dim = ops[0].argument.dim
     assert all([op.argument.dim == dim for op in ops]), 'Not all operator dimensions are equal.'
     n_args = dim*2
+    assert 'order' in kwargs.keys()
+    order = kwargs.pop('order')
     
-    def chain(*z, **kwargs1):
-        for op in ops:
-            z = op(*z, **kwargs1)
-        return z
-    
-    dchain = derive(chain, n_args=n_args, order=order)
-    if len(position) == 0:
-        position = (0,)*n_args
-    dchain.eval(*position, **kwargs) # N.B. the plain jet output is stored in dchain._evaluation. From here one can use ".get_taylor_coefficients" with other parameters -- if desired -- or re-use the jets for further processing.
-    out = {}
-    out['DA'] = dchain # chain = dchain.func
-    out['input'] = kwargs.copy()
-    out['input']['position'] = position
-    out['input']['taylor_map'] = taylor_map
-    out['input']['order'] = order
-
-    if taylor_map:
-        out['taylor_map'] = get_taylor_map(*dchain._evaluation, dim=dim, max_power=kwargs.get('max_power', order))
-        
-    return out
+    if mode == 'auto':
+        mode = 'default'
+        if ordering is not None:
+            # A direct derivative might be faster if the length of the unique elements
+            # in the chain equals the given ordering. The cderive class probes the chain 
+            # first and so it may produce a calculation overhead.
+            if len(ordering) > len(ops):
+                mode = 'chain'
+    
+    if mode == 'default':
+        if ordering is None:
+            ordering = range(len(ops))
+            
+        def chain(*z, **kwargs1):
+            for k in range(len(ordering)):
+                z = ops[ordering[k]](*z, **kwargs1)
+            return z
+        dchain = derive(chain, n_args=n_args, order=order)
+    elif mode == 'chain':
+        dchain = cderive(*ops, n_args=n_args, order=order, ordering=ordering)
+    else:
+        raise RuntimeError(f"Output format '{mode}' not recognized.")
+
+    if len(position) > 0:
+        _ = dchain.eval(*position, **kwargs) # N.B. the plain jet output is stored in dchain._evaluation. From here one can use ".taylor_coefficients" with other parameters -- if desired -- or re-use the jets for further processing.
+    return dchain
 
 def symcheck(p, tol, warn=True):
     '''
     Check whether a given Taylor map, described as a set of Lie-polynomials, describes a symplectomorphism.
     
     Parameters
     ----------
@@ -416,14 +458,14 @@
                 # The reason is that if N denotes the maximal power up to which our checks should run,
                 # then N = k + l - 2 for the two components of max order k and l. The smallest non-trivial
                 # power has k = 1, leading to N = l - 1. So the maximal order N of the check 
                 # can not exceed l - 1, where l is the maximal order of the map which we have determined. 
                 check_order = abs(check.homogeneous_part(order))
                 if len(check_order) == 0:
                     continue
-                max_error = max(check_order)
+                max_error = np.amax(list(check_order.values()))
                 if max_error > tol:
                     result[order] = max([result.get(order, 0), max_error])
                     if warn:
                         warnings.warn(f'Taylor map non-symplectic at order {order} for components {(k, l)}. Error: {max_error} (tol: {tol})')
                         
     return result
```

### Comparing `lieops-0.2.1/lieops/linalg/.ipynb_checkpoints/checks-checkpoint.py` & `lieops-0.2.2/lieops/linalg/.ipynb_checkpoints/checks-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/.ipynb_checkpoints/common-checkpoint.py` & `lieops-0.2.2/lieops/linalg/.ipynb_checkpoints/common-checkpoint.py`

 * *Files 10% similar despite different names*

```diff
@@ -425,7 +425,69 @@
     G = get_principal_sqrt(M@M.transpose())
     Q = np.linalg.inv(G)@M
     # checks:
     # G - G.transpose() == 0
     # Q.transpose()@Q = 1
     # G@Q = M
     return Q, G
+
+def ndsupport(func, n_out_args=1, n_inp_axes=2):
+    '''
+    Decorator for matrix-like calculations for multi-dimensional arrays.
+    
+    The first two indices of the input array are treated as matrix arrays, while the remaining indices
+    are considered to be running indices.
+    
+    Parameters
+    ----------
+    n_out_args: int, optional
+        If > 1, it is assumed that the function output returns more than one output.
+        
+    n_inp_axes: int, optional
+        Define the number of input axes (ascending from the first axis upwards) 
+        which should be considered as input for the function in question.
+    '''
+    def inner(X, **kwargs):
+        if not hasattr(X, 'shape'):
+            return func(X, **kwargs)
+        elif not len(X.shape) > n_inp_axes: # no modification required
+            return func(X, **kwargs)
+        else:
+            reference_shape = X.shape[n_inp_axes:]
+            # Bring first two axes (which we shall assume to run over the matrix indices) to the rear, then iterate over the remaining indices:
+            for k in range(n_inp_axes):
+                X = np.moveaxis(X, 0, -1)
+                
+            k = 0
+            for e in np.ndindex(reference_shape):
+                out = func(X[e], **kwargs)
+                if n_out_args == 1:
+                    if k == 0:
+                        out_shape = out.shape
+                        results = np.empty(list(reference_shape) + list(out.shape), dtype=np.complex128)
+                    results[e] = out
+                else:
+                    if k == 0:
+                        out_shapes = [z.shape for z in out]
+                        results = [np.empty(list(reference_shape) + list(z.shape), dtype=np.complex128) for z in out]
+                    j = 0
+                    for z in out:
+                        results[j][e] = z
+                        j += 1
+                k += 1
+
+            if n_out_args == 1:
+                results = np.copy(results) # prevent overwriting results in case function is called repeatedly
+                for k in range(len(out_shape)):
+                    results = np.moveaxis(results, -1, 0)
+                return results
+            else:
+                results2 = []
+                j = 0
+                for z in results:
+                    z = np.copy(z)
+                    for k in range(len(out_shapes[j])):                        
+                        z = np.moveaxis(z, -1, 0)
+                    results2.append(z)
+                    j += 1
+                return (*results2,)
+    return inner
```

### Comparing `lieops-0.2.1/lieops/linalg/.ipynb_checkpoints/matrix-checkpoint.py` & `lieops-0.2.2/lieops/linalg/.ipynb_checkpoints/matrix-checkpoint.py`

 * *Files 27% similar despite different names*

```diff
@@ -1,43 +1,56 @@
 # This file collects routines which are focused on fundamental generation of specific
 # matrices and to perform basic matrix operations.
-
 import numpy as np
 import mpmath as mp
 
+from njet.common import check_zero
+from njet.functions import get_package_name
+
 def printmat(M, tol=1e-14):
     # print a matrix (for e.g. debugging reasons)
     M = mp.matrix(M)
     mp.nprint(mp.chop(M, tol))
 
-def create_J(dim: int):
+def create_J(dim: int, shape=None):
     r'''
     Create a 2*dim-square matrix J, corresponding to the standard 
     symplectic block-matrix
     
              /  0   1  \
         J =  |         |
              \ -1   0  /
              
     Parameters
     ----------
     dim: int
         Dimension/2 of the matrix to be constructed.
         
+    shape: tuple, optional
+        If given, assume that the 0's and 1's in the above matrix
+        have a given shape. Return a multi-dimensional numpy array accordingly.
+        
     Returns
     -------
     list
         List of column vectors.
     '''
     dim2 = 2*dim
     J1, J2 = [], []
+    if shape is None:
+        zeros = 0
+        ones = 1
+    else:
+        zeros = np.zeros(shape, dtype=np.complex128)
+        ones = np.ones(shape, dtype=np.complex128)
+        
     for k in range(dim):
-        J1.append([0 if i != k + dim else -1 for i in range(dim2)])
-        J2.append([0 if i != k else 1 for i in range(dim2)])
-    return np.array(J1 + J2).transpose()
+        J1.append([zeros if i != k + dim else ones for i in range(dim2)])
+        J2.append([zeros if i != k else -ones for i in range(dim2)])        
+    return np.array(J1 + J2)
 
 def expandingSum(pairs):
     '''Compute a transformation matrix T, to transform a given
     (2n)x(2n) matrix M, represented in (q1, p1, q2, p2, ..., qn, pn)-coordinates, into
     a (q1, q2, ..., qn, p1, p2, ..., pn)-representation via
     M' = T^(-1)@M@T. T will be orthogonal (and unitary), i.e. T^(-1) = T.transpose().
     
@@ -112,35 +125,53 @@
     '''
     assert symmetry in [-1, 0, 1]
 
     dict_shape = max(M.keys(), default=(0, 0))
     n_rows = kwargs.get('n_rows', dict_shape[0] + 1)
     n_cols = kwargs.get('n_cols', dict_shape[1] + 1)
     
+    # determine shape of entries in case of multi-dimensional input
+    key0 = next(iter(M))
+    val0 = M[key0]
+    if hasattr(val0, 'shape'):
+        zero = np.zeros(val0.shape)
+    else:
+        zero = 0
+    
     # create a column-matrix
     if symmetry == 0:
         mat = [[0]*n_rows for k in range(n_cols)]
         for i in range(n_rows):
             for j in range(n_cols):
-                mat[j][i] = M.get((i, j), 0)
+                mat[i][j] = M.get((i, j), zero)
     else:
         dim = max([n_rows, n_cols])
         mat = [[0]*dim for k in range(dim)]
         for i in range(dim):
             for j in range(i + 1):
-                hij = M.get((i, j), 0)
-                hji = M.get((j, i), 0)
-                if hij != 0 and hji != 0:
-                    assert hij == symmetry*hji
-                if hij == 0 and hji != 0:
+                hij = M.get((i, j), zero)
+                hji = M.get((j, i), zero)
+                
+                hij_c0 = check_zero(hij)
+                hji_c0 = check_zero(hji)
+                
+                if not hij_c0 and not hji_c0 and symmetry != 0:
+                    check = hij == symmetry*hji
+                    try:
+                        assert check
+                    except:
+                        assert check.all()
+
+                if hij_c0 and not hji_c0:
                     hij = symmetry*hji
+                    
                 # (hij != 0 and hji == 0) or (hij == 0 and hji == 0). 
-                mat[j][i] = hij
-                mat[i][j] = symmetry*hij
-    return np.array(mat).transpose()
+                mat[i][j] = hij
+                mat[j][i] = symmetry*hij
+    return np.array(mat)
     
 def vecmat(mat):
     '''
     Map a given NxN-matrix to a vector, by concatenating its rows.
     '''
     return np.concatenate([mat[k, :] for k in range(mat.shape[0])])
 
@@ -191,7 +222,108 @@
         U1.append([0 if i != k and i != k2 else 1/sqrt2 for i in range(dim)])
         U2.append([0 if i != k and i != k2 else 1j/sqrt2 if i == k else -1j/sqrt2 if i == k2 else 0 for i in range(dim)])
         
     out = np.array(U1 + U2).transpose()
     if code == 'mpmath':
         out = mp.matrix(out)
     return out
+
+
+class emat:
+    '''
+    emat: extended matrix
+    
+    Class to maintain the same behavior as the ordinary mpmath or numpy arrays
+    concerning matrix multiplication, but when it comes to matrix multiplication
+    and transposition, only modify the first two axes.
+    '''
+    def __init__(self, matrix, code=None):
+        self.__array_priority__ = 1000 # prevent numpy __mul__ and force self.__rmul__ instead if multiplication from left with a numpy object
+        
+        if code is None:
+            self.code = get_package_name(matrix)
+        else:
+            self.code = code
+        self.matrix = matrix
+        if hasattr(matrix, 'shape'):
+            self.shape = self.matrix.shape
+    
+    def __add__(self, other):
+        assert self.code == other.code
+        return self.__class__(self.matrix + other.matrix, code=self.code)
+    
+    def __radd__(self, other):
+        return self + other
+    
+    def __neg__(self):
+        return self.__class__(-self.matrix, code=self.code)
+    
+    def __sub__(self, other):
+        return self + -other
+    
+    def __rsub__(self, other):
+        return other - self
+    
+    def __mul__(self, other):
+        return self.__class__(self.matrix*other, code=self.code)
+    
+    def __rmul__(self, other):
+        return self*other
+    
+    def __matmul__(self, other):
+        if self.code == 'numpy':
+            if get_package_name(other) == 'numpy':
+                B = other
+            elif hasattr(other, 'matrix'):
+                # assume other is of class emat
+                B = other.matrix
+            else:
+                raise NotImplementedError(f'Matrix multiplication between {self.__class__} and {other.__class__} not implemented.')
+                
+            A = self.matrix
+            shape1 = A.shape
+            shape2 = B.shape
+            assert shape1[1] == shape2[0]
+            if len(shape1[2:]) == 0 and len(shape2[2:]) == 0:
+                # both are ordinary matrices
+                AB = A@B
+            elif len(shape1[2:]) > 0 and len(shape2[2:]) == 0:
+                # B is an ordinary matrix
+                AB1 = np.tensordot(A, B, axes=(1, 0)) # axes not in proper order yet
+                # the last axes of AB1 corresponds to the second axis of the ordinary matrix B, so it needs to be moved to the 2nd position of the result
+                for k in range(len(shape2[1:])):
+                    AB2 = np.moveaxis(AB1, -1, 0)
+                    AB1 = np.swapaxes(AB2, 0, 1)
+                AB = AB1
+            elif len(shape1[2:]) == 0 and len(shape2[2:]) > 0:
+                # A is an ordinary matrix
+                AB = np.tensordot(A, B, axes=(1, 0))
+            else:
+                assert shape1[2:] == shape2[2:]
+                # component-wise multiplication of the remaining terms
+                AB_shape = [shape1[0]] + [shape2[1]] + list(shape1[2:])
+                AB = np.empty(AB_shape, dtype=np.complex128)
+                for i in range(shape2[1]):
+                    AB[i, ...] = sum([A[i, k, ...]*B[k, ...] for k in range(shape1[1])])
+
+            return self.__class__(AB, code=self.code)
+        else:
+            if not hasattr(other, 'matrix'): # other might be a numpy or mpmath array
+                return self.__class__(self.matrix@other, code=self.code)
+            else:
+                return self.__class__(self.matrix@other.matrix, code=self.code)
+            
+        def __rmatmul__(self, other):
+            return self.__class__(other, code=self.code)@self
+        
+    def transpose(self):
+        if self.code == 'numpy':
+            return self.__class__(np.swapaxes(self.matrix, 0, 1), code=self.code)
+        else:
+            return self.__class__(self.matrix.transpose(), code=self.code)
+        
+    def conjugate(self):
+        return self.__class__(self.matrix.conjugate(), code=self.code)
+    
+    def __len__(self):
+        return len(self.matrix)
+
```

### Comparing `lieops-0.2.1/lieops/linalg/.ipynb_checkpoints/misc-checkpoint.py` & `lieops-0.2.2/lieops/linalg/.ipynb_checkpoints/misc-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/.ipynb_checkpoints/nf-checkpoint.py` & `lieops-0.2.2/lieops/linalg/.ipynb_checkpoints/nf-checkpoint.py`

 * *Files 5% similar despite different names*

```diff
@@ -8,20 +8,26 @@
 
 from .checks import is_positive_definite
 from .matrix import create_J, matrix_from_dict, create_pq2xieta
 
 from lieops.linalg.congruence.takagi import symplectic_takagi, symplectic_takagi_old
 from lieops.linalg.congruence.williamson import unitary_williamson, williamson
 from lieops.linalg.similarity.symplectic import thm31
+from lieops.linalg.common import ndsupport
+from lieops.linalg.matrix import emat
 
 from njet.ad import getNargs
 from njet.functions import get_package_name
-from njet import derive    
+from njet import derive
 
-def symlogs(X, **kwargs):
+@ndsupport
+def logm_nd(X, **kwargs):
+    return logm(X, **kwargs)
+
+def _symlogs(X, **kwargs):
     r'''
     Let X be a complex symplectic matrix, i.e. a matrix satisfying
     X.transpose()@J@X = J.
     
     Then this routine will determine two matrices A and B so that
     X = exp(A)@exp(B),
     where A is an element in sp(n), the Lie-algebra of Sp(n) = Sp(2n; C) \cap U(2n),
@@ -48,15 +54,17 @@
     V = thm31(U, **kwargs) # V@U@V.transpose().conj() = D will be diagonal
     Vi = V.transpose().conj()
     D = V@U@Vi
     logD = logm(D) # logD.transpose()@J + J@logD = 0
     Y = Vi@logD@V
     return Y, logP
 
-def normal_form(H2, T=[], mode='default', check: bool=False, **kwargs):
+symlogs = ndsupport(_symlogs, n_out_args=2)
+
+def normal_form(H2, T=None, mode='default', check: bool=False, **kwargs):
     r'''
     Perform linear calculations to transform a given second-order Hamiltonian,
     expressed in canonical coordinates (q, p), to
     complex normal form coordinates xi, eta. Along the way, the symplectic linear map to
     real normal form is computed. The quantities xi and eta are defined as in my thesis,
     Chapter 1.
     
@@ -123,61 +131,71 @@
                  determines this behavior can be controlled with the tol_logm parameter. So if that parameter
                  is set to zero, there will always be returned two elements.
                  *Currently only returned for numpy input*
     ''' 
     dim = len(H2)
     assert dim%2 == 0, 'Dimension must be even.'
     code = get_package_name(H2)
+    H2 = emat(H2) 
         
-    if len(T) != 0: # transform H2 to default block ordering before entering williamson routine; the results will later be transformed back. This is easier instead of keeping track of orders inside the subroutines.
+    if T is not None: # transform H2 to default block ordering before entering williamson routine; the results will later be transformed back. This is easier instead of keeping track of orders inside the subroutines.
+        T = emat(T)
         T_ctr = T.transpose()
         H2 = T@H2@T_ctr
 
     J = create_J(dim//2)
     if code == 'mpmath':
         J = mp.matrix(J)
+    J = emat(J)
     
     if check:
         # consistency check: H2@J must be diagonalizable in order that the normal form can be computed.
         # Since computing the Jordan normal form is numerically unstable, we use sympy for this.
         # Note that this will only work for dim = 1 or dim = 2.
-        J_symp = sympy_matrix(J)
-        G_symp = sympy_matrix(H2)
+        J_symp = sympy_matrix(J.matrix)
+        G_symp = sympy_matrix(H2.matrix)
         P_symp, JNF = (G_symp@J_symp).jordan_form()
         if not JNF.is_diagonal():
             raise RuntimeError(f'Jordan normal form of H2@J not diagonal:\nH2:\n{H2}\nJNF:\n{JNF}')
-            
+
     # Perform symplectic diagonalization
     if mode == 'new':
         # will become the default in future; TODO: some tests are failing
-        S, X = symplectic_takagi(H2, **kwargs)
+        S, X = symplectic_takagi(H2.matrix, **kwargs)
+        S, X = emat(S), emat(X)
         S = S.transpose()
         Sinv = -J@S.transpose()@J
-                
+
         D = Sinv.transpose()@H2@Sinv
         U = create_pq2xieta(dim=dim, code=code, **kwargs)
+        U = emat(U)
     elif mode == 'default':
         # will become OLD code. Using symplectic takagi assuming GJ is diagonalizable. This older version
         # works with eigenspaces and eigenvalues routine.
         # TODO: S may change the sign of the Hesse-matrix. Need to figure out the issue. 
-        S, D, _ = symplectic_takagi_old(H2, check=check, **kwargs)
+        S, D, _ = symplectic_takagi_old(H2.matrix, check=check, **kwargs)
+        S, D = emat(S), emat(D)
         S = S.transpose()
         Sinv = -J@S.transpose()@J
         U = create_pq2xieta(dim=dim, code=code, **kwargs)
+        U = emat(U)
     elif mode == 'classic':
         # OLD code, using Williamson or "unitary" Williamson.
-        if is_positive_definite(H2):
-            S, D = williamson(V=H2, **kwargs)
+        if is_positive_definite(H2.matrix):
+            S, D = williamson(V=H2.matrix, **kwargs)
+            S, D = emat(S), emat(D)
 
             U = create_pq2xieta(dim=dim, code=code, **kwargs)
+            U = emat(U)
             Sinv = -J@S.transpose()@J
         else:
             assert code == 'numpy' # TODO: mpmath support
             # apply new general routine in case H2 is not positive definite
-            Sinv, D, U = unitary_williamson(M=H2, **kwargs) # U.conjugate()@Sinv.transpose()@H2@Sinv@U.conjugate().transpose() will be in (xi, eta)-canonical form.
+            Sinv, D, U = unitary_williamson(M=H2.matrix, **kwargs) # U.conjugate()@Sinv.transpose()@H2@Sinv@U.conjugate().transpose() will be in (xi, eta)-canonical form.
+            Sinv, D, U = emat(Sinv), emat(D), emat(U)
             S = -J@Sinv.transpose()@J
     else:
         raise RuntimeError(f"Mode '{mode}' not recognized.")
     # The first dim columns of S denote (new) canonical positions u, the last dim columns of S
     # denote (new) canonical momenta v: S(q, p) = (u, v)
         
     # U is hermitian, therefore
@@ -187,56 +205,61 @@
     J2 = U@J@U.transpose() # the new symplectic structure (see my notes).
     #J2 = Uinv.transpose().conjugate()@J@Uinv # the new symplectic structure with respect to the (xi, eta)-coordinates (holds also in the case len(T) != 0)
     #   = U@J@U.transpose().conjuage() = [U@J@U.transpose()].conjugate()
     
     K = U@S # K(q, p) = (xi, eta)
     Kinv = Sinv@Uinv  # this map will transform to the new (xi, eta)-coordinates via Kinv.transpose()*H2*Kinv
 
-    if len(T) != 0: # transform results back to the requested (q, p)-ordering
+    if T is not None: # transform results back to the requested (q, p)-ordering
         S = T_ctr@S@T
         Sinv = T_ctr@Sinv@T
         J = T_ctr@J@T
         H2 = T_ctr@H2@T
         K = K@T
         Kinv = T_ctr@Kinv
     
     # assemble output
     out = {}
-    out['S'] = S 
-    out['Sinv'] = Sinv # this symplectic map will diagonalize H2 in its original 
+    out['S'] = S.matrix
+    out['Sinv'] = Sinv.matrix # this symplectic map will diagonalize H2 in its original 
     # (q, p)-coordinates via Sinv.transpose()*H2*Sinv. Sinv (and S) are symplectic wrt. J
-    out['H2'] = H2 # the input matrix
-    out['rnf'] = Sinv.transpose()@H2@Sinv # the diagonal matrix obtained as a result of the symplectic diagonalization of H2
-    out['T'] = T
-    out['J'] = J # the original symplectic structure
-    out['J2'] = J2 # the new symplectic structure
-    out['U'] = U # the unitary map from the S(p, q)=(u, v)-block coordinates to the (xi, eta)-coordinates
-    out['Uinv'] = Uinv
-    out['K'] = K # K(q, p) = (xi, eta)
-    out['Kinv'] = Kinv
-    out['cnf'] = Kinv.transpose()@H2@Kinv # the representation of H2 in (xi, eta)-coordinates
-    out['D'] = D
+    out['H2'] = H2.matrix # the input matrix
+    out['rnf'] = (Sinv.transpose()@H2@Sinv).matrix # the diagonal matrix obtained as a result of the symplectic diagonalization of H2
+    if T is not None:
+        out['T'] = T.matrix
+    else:
+        out['T'] = []
+    out['J'] = J.matrix # the original symplectic structure
+    out['J2'] = J2.matrix # the new symplectic structure
+    out['U'] = U.matrix # the unitary map from the S(p, q)=(u, v)-block coordinates to the (xi, eta)-coordinates
+    out['Uinv'] = Uinv.matrix
+    out['K'] = K.matrix # K(q, p) = (xi, eta)
+    out['Kinv'] = Kinv.matrix
+    out['cnf'] = (Kinv.transpose()@H2@Kinv).matrix # the representation of H2 in (xi, eta)-coordinates
+    out['D'] = D.matrix
     
     # Furthermore, compute the map A transforming the Hamiltonian (given in (xi, eta)-coordinates), 
     # whose Hessian corresponds to H2 above, into its first-order normal form.
     # For details see my notes (On_Sp2n.pdf)
     if code != 'mpmath':
-        out['A'] = U@Sinv@Uinv
+        out['A'] = (U@Sinv@Uinv).matrix
         tol_logm = kwargs.get('tol_logm', 1e-14)
         try:
-            B1 = logm(Sinv) # exist always, since Sinv is invertible
+            B1 = logm_nd(Sinv.matrix) # exist always, since Sinv is invertible
             # But: B1 must be in the Lie-algebra sp(2n; C). This is not always guaranteed, so we have to check it here:
+            B1 = emat(B1)
             zero = J@B1.transpose() + B1@J
-            assert (all([abs(zero[i, j]) < tol_logm for i in range(dim) for j in range(dim)]))
+            assert all([(abs(zero.matrix[i, j]) < tol_logm).all() for i in range(dim) for j in range(dim)])
         except:
             # Sinv can only be represented by two exponentials
-            B1, B2 = symlogs(Sinv, tol2=kwargs.get('symlogs_tol2', 0))
+            B1, B2 = symlogs(Sinv.matrix, tol2=kwargs.get('symlogs_tol2', 0))
             warnings.warn(f'Matrix appears to require two exponentials for representation (tol_logm: {tol_logm})')
-            out['C2'] = U@B2@Uinv
-        out['C1'] = U@B1@Uinv
+            B1, B2 = emat(B1), emat(B2)
+            out['C2'] = (U@B2@Uinv).matrix
+        out['C1'] = (U@B1@Uinv).matrix
         # so that A = exp(C1)@exp(C2)
         # Note that due to the nature of the matrix U, the Cj's are elements of sp(2n; C), so they admit a polynomial representation.
     return out
 
 def first_order_nf_expansion(H, power: int=2, z=[], check: bool=False, n_args: int=0, tol: float=1e-14,
                              code='numpy', **kwargs):
     '''
@@ -275,57 +298,57 @@
         A dictionary of the Taylor coefficients of the Hamiltonian in normal form around z = (q, p), where the first n
         entries denote powers of xi, while the last n entries denote powers of eta.
         
     dict
         The output of lieops.linalg.nf.normal_form routine, providing the linear map information at the requested point.
     '''
     assert power >= 2
-    dim = n_args
+    dim2 = n_args
     if n_args == 0:
-        dim = getNargs(H)
-    assert dim%2 == 0, 'Dimension must be even; try passing n_args argument.'
+        dim2 = getNargs(H)
+    assert dim2%2 == 0, 'Dimension must be even; try passing n_args argument.'
     
     # Step 1 (optional): Construct H locally around z (N.B. shifts are symplectic, as they drop out from derivatives.)
     # This step is required, because later on (at point (+)) we want to extract the Taylor coefficients, and
     # this works numerically only if we consider a function around zero.
     if len(z) > 0:
-        assert len(z) == dim, f'Dimension ({len(z)}) of custom point mismatch (expected: {dim})'
+        assert len(z) == dim2, f'Dimension ({len(z)}) of custom point mismatch (expected: {dim2})'
         Hshift = lambda *x: H(*[x[k] + z[k] for k in range(len(z))])
     else:
         Hshift = H
-        z = dim*[0]
+        z = dim2*[0]
     
     # Step 2: Obtain the Hesse-matrix of H.
     # N.B. we need to work with the Hesse-matrix here (and *not* with the Taylor-coefficients), because we want to get
     # a (linear) map K so that the Hesse-matrix of H o K is in CNF (complex normal form). This is guaranteed
     # if the Hesse-matrix of H is transformed to CNF.
     # Note that the Taylor-coefficients of H in 2nd-order are 1/2*Hesse_matrix. This means that at (++) (see below),
     # no factor of two is required.
-    dHshift = derive(Hshift, order=2, n_args=dim)
-    z0 = dim*[0]
+    dHshift = derive(Hshift, order=2, n_args=dim2)
+    z0 = dim2*[0]
     Hesse_dict = dHshift.hess(*z0)
-    Hesse_matrix = matrix_from_dict(Hesse_dict, symmetry=1, n_rows=dim, n_cols=dim)
+    Hesse_matrix = matrix_from_dict(Hesse_dict, symmetry=1, n_rows=dim2, n_cols=dim2)
     if code == 'mpmath':
         Hesse_matrix = mp.matrix(Hesse_matrix)
         
     # Optional: Raise a warning in case the shifted Hamiltonian has first-order terms.
     if check:
         gradient = dHshift.grad() # the gradient of H is evaluated at z0 (note that H has been shifted to z0 above, so that z0 corresponds to the original point z).
-        grad_vector = [gradient.get((k,), 0) for k in range(dim)]
+        grad_vector = [gradient.get((k,), 0) for k in range(dim2)]
         if any([abs(c) > tol for c in grad_vector]) > 0:
             warnings.warn(f'Input appears to have a non-zero gradient around the requested point\n{z}\nfor given tolerance {tol}:\n{grad_vector}')
 
     # Step 3: Compute the linear map to first-order complex normal form near z.
-    nfdict = normal_form(Hesse_matrix, tol=tol, check=check, **kwargs)
+    nfdict = normal_form(Hesse_matrix, check=check, **kwargs)
     Kinv = nfdict['Kinv'] # Kinv.transpose()@Hesse_matrix@Kinv is in cnf; K(q, p) = (xi, eta)
     
     # Step 4: Obtain the expansion of the Hamiltonian up to the requested power.
     Kmap = lambda *zz: [sum([zz[k]*Kinv[j, k] for k in range(len(zz))]) for j in range(len(zz))] # TODO: implement column matrix class. Attention: Kinv[j, k] must stand on right-hand side, otherwise zz[k] may be inserted into a NumPy array!
     HK = lambda *zz: Hshift(*Kmap(*zz))
-    dHK = derive(HK, order=power, n_args=dim)
+    dHK = derive(HK, order=power, n_args=dim2)
     results = dHK(*z0, mult_drv=False) # mult_drv=False ensures that we obtain the Taylor-coefficients of the new Hamiltonian. (+)
         
     if check:
         # Check if the 2nd order Taylor coefficients of the derived shifted Hamiltonian agree in complex
         # normal form with the values predicted by linear theory.
         HK_hesse_dict = dHK.hess(tc=results)
         HK_hesse_dict = {k: v for k, v in HK_hesse_dict.items() if abs(v) > tol}
```

### Comparing `lieops-0.2.1/lieops/linalg/__pycache__/checks.cpython-310.pyc` & `lieops-0.2.2/lieops/linalg/__pycache__/checks.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/__pycache__/common.cpython-310.pyc` & `lieops-0.2.2/lieops/linalg/__pycache__/common.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.10, timestamp-based, .py timestamp: Wed Nov  9 21:25:15 2022 UTC, .py size: 16671 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 12% similar despite different names*

```diff
@@ -1,879 +1,994 @@
-00000000: 6f0d 0d0a 0000 0000 bb1a 6c63 1f41 0000  o.........lc.A..
+00000000: 6f0d 0d0a 0000 0000 9500 2f64 2a4b 0000  o........./d*K..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0003 0000 0040 0000 0073 8400 0000 6400  .....@...s....d.
+00000020: 0003 0000 0040 0000 0073 8e00 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a01 6400 6401 6c02 5a03 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6402 6c04 6d05 5a05 0100 6400 6403 6c06  d.l.m.Z...d.d.l.
-00000050: 6d07 5a07 0100 641c 6405 6406 8401 5a08  m.Z...d.d.d...Z.
-00000060: 641d 6408 6409 8401 5a09 641e 640b 640c  d.d.d...Z.d.d.d.
+00000050: 6d07 5a07 0100 6420 6405 6406 8401 5a08  m.Z...d d.d...Z.
+00000060: 6421 6408 6409 8401 5a09 6422 640b 640c  d!d.d...Z.d"d.d.
 00000070: 8401 5a0a 640d 640e 8400 5a0b 640f 6410  ..Z.d.d...Z.d.d.
-00000080: 9c01 6411 6412 8402 5a0c 641f 6413 6414  ..d.d...Z.d.d.d.
-00000090: 8401 5a0d 6420 6416 6417 8401 5a0e 6418  ..Z.d d.d...Z.d.
-000000a0: 6419 8400 5a0f 641a 641b 8400 5a10 6401  d...Z.d.d...Z.d.
-000000b0: 5300 2921 e900 0000 004e 2901 da05 7363  S.)!.....N)...sc
-000000c0: 6875 7229 01da 1067 6574 5f70 6163 6b61  hur)...get_packa
-000000d0: 6765 5f6e 616d 65da 0763 6f6d 706c 6578  ge_name..complex
-000000e0: 6302 0000 0000 0000 0000 0000 0005 0000  c...............
-000000f0: 0005 0000 000b 0000 0073 8200 0000 7c01  .........s....|.
-00000100: 6401 6b02 7214 7400 8700 6601 6402 6403  d.k.r.t...f.d.d.
-00000110: 8408 7401 7402 8800 8301 8301 4400 8301  ..t.t.......D...
-00000120: 8301 7d03 6e0f 7400 8700 6601 6404 6403  ..}.n.t...f.d.d.
-00000130: 8408 7401 7402 8800 8301 8301 4400 8301  ..t.t.......D...
-00000140: 8301 7d03 7403 7c03 8301 7d04 7c04 6405  ..}.t.|...}.|.d.
-00000150: 6b02 7233 7404 a005 7404 a006 7c03 a101  k.r3t...t...|...
-00000160: a101 5300 7c04 6406 7600 723f 7407 a005  ..S.|.d.v.r?t...
-00000170: 7407 a008 7c03 a101 a101 5300 6400 5300  t...|.....S.d.S.
-00000180: 2907 4e72 0400 0000 6301 0000 0000 0000  ).Nr....c.......
-00000190: 0000 0000 0002 0000 0005 0000 0013 0000  ................
-000001a0: 0073 2000 0000 6700 7c00 5d0c 7d01 8800  .s ...g.|.].}...
-000001b0: 7c01 1900 a000 a100 8800 7c01 1900 1400  |.........|.....
-000001c0: 9102 7102 5300 a900 a901 da09 636f 6e6a  ..q.S.......conj
-000001d0: 7567 6174 65a9 02da 022e 30da 016b a901  ugate.....0..k..
-000001e0: da06 7665 6374 6f72 7205 0000 00fa 552f  ..vectorr.....U/
-000001f0: 686f 6d65 2f6d 616c 7465 2f6d 696e 6963  home/malte/minic
-00000200: 6f6e 6461 332f 656e 7673 2f77 6f72 6b2f  onda3/envs/work/
-00000210: 6c69 622f 7079 7468 6f6e 332e 3130 2f73  lib/python3.10/s
-00000220: 6974 652d 7061 636b 6167 6573 2f6c 6965  ite-packages/lie
-00000230: 6f70 732f 6c69 6e61 6c67 2f63 6f6d 6d6f  ops/linalg/commo
-00000240: 6e2e 7079 da0a 3c6c 6973 7463 6f6d 703e  n.py..<listcomp>
-00000250: 0e00 0000 f302 0000 0020 007a 1b74 776f  ......... .z.two
-00000260: 6e6f 726d 2e3c 6c6f 6361 6c73 3e2e 3c6c  norm.<locals>.<l
-00000270: 6973 7463 6f6d 703e 6301 0000 0000 0000  istcomp>c.......
-00000280: 0000 0000 0002 0000 0005 0000 0013 0000  ................
-00000290: 0073 1c00 0000 6700 7c00 5d0a 7d01 8800  .s....g.|.].}...
-000002a0: 7c01 1900 8800 7c01 1900 1400 9102 7102  |.....|.......q.
-000002b0: 5300 7205 0000 0072 0500 0000 7208 0000  S.r....r....r...
-000002c0: 0072 0b00 0000 7205 0000 0072 0d00 0000  .r....r....r....
-000002d0: 720e 0000 0010 0000 00f3 0200 0000 1c00  r...............
-000002e0: da06 6d70 6d61 7468 2902 da05 6e75 6d70  ..mpmath)...nump
-000002f0: 79da 0862 7569 6c74 696e 7329 09da 0373  y..builtins)...s
-00000300: 756d da05 7261 6e67 65da 036c 656e 7203  um..range..lenr.
-00000310: 0000 00da 026d 70da 0473 7172 74da 0272  .....mp..sqrt..r
-00000320: 65da 026e 70da 0472 6561 6c29 0572 0c00  e..np..real).r..
-00000330: 0000 da04 6d6f 6465 da06 6b77 6172 6773  ....mode..kwargs
-00000340: 5a04 7375 6d32 da04 636f 6465 7205 0000  Z.sum2..coder...
-00000350: 0072 0b00 0000 720d 0000 00da 0774 776f  .r....r......two
-00000360: 6e6f 726d 0a00 0000 7312 0000 0008 0320  norm....s...... 
-00000370: 011e 0208 0208 0210 0108 0110 0104 ff72  ...............r
-00000380: 1f00 0000 e716 56e7 9eaf 03d2 3c63 0300  ......V.....<c..
-00000390: 0000 0000 0000 0000 0000 0800 0000 0a00  ................
-000003a0: 0000 0b00 0000 7374 0100 0074 0088 0683  ......st...t....
-000003b0: 017d 0474 0088 0664 0119 0083 0189 0074  .}.t...d.......t
-000003c0: 0188 0664 0119 0066 0164 027c 0169 017c  ...d...f.d.|.i.|
-000003d0: 03a4 018e 0189 0387 0387 0666 0264 0364  ...........f.d.d
-000003e0: 0484 0874 0288 0083 0144 0083 0189 0474  ...t.....D.....t
-000003f0: 0264 057c 0483 0244 005d 8689 0187 0187  .d.|...D.]......
-00000400: 0666 0264 0664 0484 0874 0288 0083 0144  .f.d.d...t.....D
-00000410: 0083 0189 0574 0288 0183 0144 005d 3e89  .....t.....D.]>.
-00000420: 027c 0164 076b 0272 5074 0387 0187 0287  .|.d.k.rPt......
-00000430: 0487 0666 0464 0864 0984 0874 0288 0083  ...f.d.d...t....
-00000440: 0144 0083 0183 017d 056e 1074 0387 0187  .D.....}.n.t....
-00000450: 0287 0487 0666 0464 0a64 0984 0874 0288  .....f.d.d...t..
-00000460: 0083 0144 0083 0183 017d 0574 0288 0083  ...D.....}.t....
-00000470: 0144 005d 127d 0688 057c 0688 0166 0205  .D.].}...|...f..
-00000480: 0019 007c 0588 047c 0688 0266 0219 0014  ...|...|...f....
-00000490: 0038 0003 003c 0071 6471 3974 0187 0187  .8...<.qdq9t....
-000004a0: 0566 0264 0b64 0984 0874 0288 0083 0144  .f.d.d...t.....D
-000004b0: 0083 0166 0164 027c 0169 017c 03a4 018e  ...f.d.|.i.|....
-000004c0: 017d 0774 047c 0783 017c 026b 0072 9a74  .}.t.|...|.k.r.t
-000004d0: 0564 0c7c 019b 0064 0d9d 0383 0182 0174  .d.|...d.......t
-000004e0: 0288 0083 0144 005d 0e7d 0688 057c 0688  .....D.].}...|..
-000004f0: 0166 0219 007c 071b 0088 047c 0688 0166  .f...|.....|...f
-00000500: 023c 0071 9e71 2787 0087 0466 0264 0e64  .<.q.q'....f.d.d
-00000510: 0984 0874 027c 0483 0144 0083 0153 0029  ...t.|...D...S.)
-00000520: 0f61 8a02 0000 4772 616d 2d53 6368 6d69  .a....Gram-Schmi
-00000530: 6474 206f 7274 686f 676f 6e61 6c69 7a61  dt orthogonaliza
-00000540: 7469 6f6e 2070 726f 6365 6475 7265 206f  tion procedure o
-00000550: 6620 6c69 6e61 726c 7920 696e 6465 7065  f linarly indepe
-00000560: 6e64 656e 7420 7665 6374 6f72 7320 7769  ndent vectors wi
-00000570: 7468 2063 6f6d 706c 6578 2065 6e74 7269  th complex entri
-00000580: 6573 2c20 692e 652e 0a20 2020 2027 756e  es, i.e..    'un
-00000590: 6974 6172 697a 6174 696f 6e27 2e0a 2020  itarization'..  
-000005a0: 2020 0a20 2020 2050 6172 616d 6574 6572    .    Parameter
-000005b0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-000005c0: 0a20 2020 2076 6563 746f 7273 3a20 6c69  .    vectors: li
-000005d0: 7374 0a20 2020 2020 2020 206c 6973 7420  st.        list 
-000005e0: 6f66 2076 6563 746f 7273 2074 6f20 6265  of vectors to be
-000005f0: 206f 7274 686f 676f 6e61 6c69 7a65 642e   orthogonalized.
-00000600: 0a20 2020 2020 2020 200a 2020 2020 6d6f  .        .    mo
-00000610: 6465 3a20 7374 722c 206f 7074 696f 6e61  de: str, optiona
-00000620: 6c0a 2020 2020 2020 2020 4966 206d 6f64  l.        If mod
-00000630: 6520 3d3d 2027 636f 6d70 6c65 7827 2028  e == 'complex' (
-00000640: 6465 6661 756c 7429 2c20 7468 656e 2061  default), then a
-00000650: 6c6c 206e 6f72 6d73 2061 6e64 2073 6361  ll norms and sca
-00000660: 6c61 7220 7072 6f64 7563 7473 2061 7265  lar products are
-00000670: 2063 6f6d 7075 7465 6420 7573 696e 6720   computed using 
-00000680: 636f 6e6a 7567 6174 696f 6e2e 0a20 2020  conjugation..   
-00000690: 2020 2020 200a 2020 2020 2a2a 6b77 6172       .    **kwar
-000006a0: 6773 200a 2020 2020 2020 2020 4164 6469  gs .        Addi
-000006b0: 7469 6f6e 616c 2061 7267 756d 656e 7473  tional arguments
-000006c0: 2070 6173 7365 6420 746f 202e 7477 6f6e   passed to .twon
-000006d0: 6f72 6d0a 2020 2020 0a20 2020 2052 6574  orm.    .    Ret
-000006e0: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
-000006f0: 0a20 2020 206c 6973 740a 2020 2020 2020  .    list.      
-00000700: 2020 6c69 7374 206f 6620 6c65 6e67 7468    list of length
-00000710: 206c 656e 2876 6563 746f 7273 2920 7768   len(vectors) wh
-00000720: 6963 6820 6172 6520 6d75 7475 616c 6c79  ich are mutually
-00000730: 2075 6e69 7461 7279 2e20 492e 652e 0a20   unitary. I.e.. 
-00000740: 2020 2020 2020 2077 6974 6820 4f20 3a3d         with O :=
-00000750: 206e 702e 6172 7261 7928 6c69 7374 292e   np.array(list).
-00000760: 5420 6974 2068 6f6c 6473 204f 5e48 404f  T it holds O^H@O
-00000770: 203d 2031 2c20 7768 6572 6520 5e48 206d   = 1, where ^H m
-00000780: 6561 6e73 2074 7261 6e73 706f 7369 7469  eans transpositi
-00000790: 6f6e 2061 6e64 2063 6f6d 706c 6578 2063  on and complex c
-000007a0: 6f6e 6a75 6761 7469 6f6e 2e0a 2020 2020  onjugation..    
-000007b0: 7201 0000 0072 1c00 0000 6301 0000 0000  r....r....c.....
-000007c0: 0000 0000 0000 0002 0000 0005 0000 0013  ................
-000007d0: 0000 0073 2200 0000 6900 7c00 5d0d 7d01  ...s"...i.|.].}.
-000007e0: 7c01 6400 6602 8801 6400 1900 7c01 1900  |.d.f...d...|...
-000007f0: 8800 1b00 9302 7102 5300 a901 7201 0000  ......q.S...r...
-00000800: 0072 0500 0000 a902 7209 0000 00da 016d  .r......r......m
-00000810: 2902 da06 6e6f 726d 5f30 da07 7665 6374  )...norm_0..vect
-00000820: 6f72 7372 0500 0000 720d 0000 00da 0a3c  orsr....r......<
-00000830: 6469 6374 636f 6d70 3e31 0000 00f3 0200  dictcomp>1......
-00000840: 0000 2200 7a20 6772 616d 5f73 6368 6d69  ..".z gram_schmi
-00000850: 6474 2e3c 6c6f 6361 6c73 3e2e 3c64 6963  dt.<locals>.<dic
-00000860: 7463 6f6d 703e e901 0000 0063 0100 0000  tcomp>.....c....
-00000870: 0000 0000 0000 0000 0200 0000 0500 0000  ................
-00000880: 1300 0000 731e 0000 0069 007c 005d 0b7d  ....s....i.|.].}
-00000890: 017c 0188 0066 0288 0188 0019 007c 0119  .|...f.......|..
-000008a0: 0093 0271 0253 0072 0500 0000 7205 0000  ...q.S.r....r...
-000008b0: 0072 2200 0000 2902 da01 6972 2500 0000  .r"...)...ir%...
-000008c0: 7205 0000 0072 0d00 0000 7226 0000 0033  r....r....r&...3
-000008d0: 0000 0073 0200 0000 1e00 7204 0000 0063  ...s......r....c
-000008e0: 0100 0000 0000 0000 0000 0000 0200 0000  ................
-000008f0: 0500 0000 1300 0000 7328 0000 0067 007c  ........s(...g.|
-00000900: 005d 107d 0188 027c 0188 0166 0219 00a0  .].}...|...f....
-00000910: 00a1 0088 0388 0019 007c 0119 0014 0091  .........|......
-00000920: 0271 0253 0072 0500 0000 7206 0000 00a9  .q.S.r....r.....
-00000930: 0272 0900 0000 da01 72a9 0472 2900 0000  .r......r..r)...
-00000940: da01 6ada 056f 7274 686f 7225 0000 0072  ..j..orthor%...r
-00000950: 0500 0000 720d 0000 0072 0e00 0000 3600  ....r....r....6.
-00000960: 0000 7302 0000 0028 007a 2067 7261 6d5f  ..s....(.z gram_
-00000970: 7363 686d 6964 742e 3c6c 6f63 616c 733e  schmidt.<locals>
-00000980: 2e3c 6c69 7374 636f 6d70 3e63 0100 0000  .<listcomp>c....
-00000990: 0000 0000 0000 0000 0200 0000 0500 0000  ................
-000009a0: 1300 0000 7324 0000 0067 007c 005d 0e7d  ....s$...g.|.].}
-000009b0: 0188 027c 0188 0166 0219 0088 0388 0019  ...|...f........
-000009c0: 007c 0119 0014 0091 0271 0253 0072 0500  .|.......q.S.r..
-000009d0: 0000 7205 0000 0072 2a00 0000 722c 0000  ..r....r*...r,..
-000009e0: 0072 0500 0000 720d 0000 0072 0e00 0000  .r....r....r....
-000009f0: 3800 0000 f302 0000 0024 0063 0100 0000  8........$.c....
-00000a00: 0000 0000 0000 0000 0200 0000 0500 0000  ................
-00000a10: 1300 0000 f318 0000 0067 007c 005d 087d  .........g.|.].}
-00000a20: 0188 017c 0188 0066 0219 0091 0271 0253  ...|...f.....q.S
-00000a30: 0072 0500 0000 7205 0000 0072 2200 0000  .r....r....r"...
-00000a40: 2902 7229 0000 00da 0473 756d 3172 0500  ).r).....sum1r..
-00000a50: 0000 720d 0000 0072 0e00 0000 3c00 0000  ..r....r....<...
-00000a60: f302 0000 0018 007a 1c44 6976 6973 696f  .......z.Divisio
-00000a70: 6e20 6279 207a 6572 6f20 7769 7468 206d  n by zero with m
-00000a80: 6f64 6520 287a 3429 2065 6e63 6f75 6e74  ode (z4) encount
-00000a90: 6572 6564 3b20 6368 6563 6b20 696e 7075  ered; check inpu
-00000aa0: 7420 6f6e 206c 696e 6561 726c 7920 696e  t on linearly in
-00000ab0: 6465 7065 6e64 656e 6365 2e63 0100 0000  dependence.c....
-00000ac0: 0000 0000 0000 0000 0100 0000 0500 0000  ................
-00000ad0: 1300 0000 7324 0000 0067 007c 005d 0e89  ....s$...g.|.]..
-00000ae0: 0087 0087 0266 0264 0064 0184 0874 0088  .....f.d.d...t..
-00000af0: 0183 0144 0083 0191 0271 0253 0029 0263  ...D.....q.S.).c
-00000b00: 0100 0000 0000 0000 0000 0000 0200 0000  ................
-00000b10: 0500 0000 1300 0000 7230 0000 0072 0500  ........r0...r..
-00000b20: 0000 7205 0000 0072 2200 0000 2902 7229  ..r....r"...).r)
-00000b30: 0000 0072 2e00 0000 7205 0000 0072 0d00  ...r....r....r..
-00000b40: 0000 720e 0000 0041 0000 0072 3200 0000  ..r....A...r2...
-00000b50: 7a2b 6772 616d 5f73 6368 6d69 6474 2e3c  z+gram_schmidt.<
-00000b60: 6c6f 6361 6c73 3e2e 3c6c 6973 7463 6f6d  locals>.<listcom
-00000b70: 703e 2e3c 6c69 7374 636f 6d70 3ea9 0172  p>.<listcomp>..r
-00000b80: 1500 0000 a901 7209 0000 0029 02da 0364  ......r....)...d
-00000b90: 696d 722e 0000 0029 0172 2900 0000 720d  imr....).r)...r.
-00000ba0: 0000 0072 0e00 0000 4100 0000 722f 0000  ...r....A...r/..
-00000bb0: 0029 0672 1600 0000 721f 0000 0072 1500  .).r....r....r..
-00000bc0: 0000 7214 0000 00da 0361 6273 da0c 5275  ..r......abs..Ru
-00000bd0: 6e74 696d 6545 7272 6f72 2908 7225 0000  ntimeError).r%..
-00000be0: 0072 1c00 0000 da03 746f 6c72 1d00 0000  .r......tolr....
-00000bf0: 720a 0000 005a 1173 6361 6c61 725f 7072  r....Z.scalar_pr
-00000c00: 6f64 7563 745f 696a 7223 0000 005a 066e  oduct_ijr#...Z.n
-00000c10: 6f72 6d5f 6972 0500 0000 2907 7235 0000  orm_ir....).r5..
-00000c20: 0072 2900 0000 722d 0000 0072 2400 0000  .r)...r-...r$...
-00000c30: 722e 0000 0072 3100 0000 7225 0000 0072  r....r1...r%...r
-00000c40: 0d00 0000 da0c 6772 616d 5f73 6368 6d69  ......gram_schmi
-00000c50: 6474 1900 0000 7328 0000 0008 150c 0118  dt....s(........
-00000c60: 0118 010e 0118 010c 0108 0122 0120 020c  ...........". ..
-00000c70: 0222 0102 ff28 020c 0110 010c 011a 0102  ."...(..........
-00000c80: ff18 0272 3900 0000 e7bb bdd7 d9df 7cdb  ...r9.........|.
-00000c90: 3d63 0300 0000 0000 0000 0000 0000 0e00  =c..............
-00000ca0: 0000 0800 0000 4b00 0000 7386 0200 0074  ......K...s....t
-00000cb0: 007c 0083 017d 047c 0464 016b 0272 267c  .|...}.|.d.k.r&|
-00000cc0: 006a 015c 027d 057d 067c 0164 026b 0272  .j.\.}.}.|.d.k.r
-00000cd0: 1674 02a0 037c 05a1 017d 017c 016a 0164  .t...|...}.|.j.d
-00000ce0: 0319 007c 056b 0273 1f4a 0082 0174 02a0  ...|.k.s.J...t..
-00000cf0: 047c 007c 0167 02a1 017d 077c 0464 046b  .|.|.g...}.|.d.k
-00000d00: 0272 5e7c 006a 057c 006a 0602 027d 057d  .r^|.j.|.j...}.}
-00000d10: 067c 0164 026b 0272 3a74 07a0 037c 05a1  .|.d.k.r:t...|..
-00000d20: 017d 017c 016a 057c 056b 0273 414a 0082  .}.|.j.|.k.sAJ..
-00000d30: 0174 07a0 087c 057c 067c 016a 0617 00a1  .t...|.|.|.j....
-00000d40: 027d 077c 007c 0764 0264 0285 0264 027c  .}.|.|.d.d...d.|
-00000d50: 0685 0266 023c 007c 017c 0764 0264 0285  ...f.<.|.|.d.d..
-00000d60: 027c 0664 0285 0266 023c 0064 037d 0867  .|.d...f.<.d.}.g
-00000d70: 007d 0974 097c 0683 0144 005d c77d 0a64  .}.t.|...D.].}.d
-00000d80: 057d 0b74 097c 087c 0583 0244 005d 817d  .}.t.|.|...D.].}
-00000d90: 0c74 0a7c 077c 0c7c 0a66 0219 0083 017c  .t.|.|.|.f.....|
-00000da0: 026b 0072 7c71 6f7c 0c7c 086b 0472 d37c  .k.r|qo|.|.k.r.|
-00000db0: 0464 016b 0272 a774 02a0 0b7c 077c 0864  .d.k.r.t...|.|.d
-00000dc0: 0264 0285 0266 0219 00a1 017d 0d74 02a0  .d...f.....}.t..
-00000dd0: 0b7c 077c 0c64 0264 0285 0266 0219 00a1  .|.|.d.d...f....
-00000de0: 017c 077c 0c7c 0a66 0219 001b 007c 077c  .|.|.|.f.....|.|
-00000df0: 0864 0264 0285 0266 023c 006e 247c 0464  .d.d...f.<.n$|.d
-00000e00: 046b 0272 cb7c 077c 0864 0264 0285 0266  .k.r.|.|.d.d...f
-00000e10: 0219 00a0 0ba1 007d 0d7c 077c 0c64 0264  .......}.|.|.d.d
-00000e20: 0285 0266 0219 00a0 0ba1 007c 077c 0c7c  ...f.......|.|.|
-00000e30: 0a66 0219 001b 007c 077c 0864 0264 0285  .f.....|.|.d.d..
-00000e40: 0266 023c 007c 0d7c 077c 0c64 0264 0285  .f.<.|.|.|.d.d..
-00000e50: 0266 023c 007c 077c 0864 0264 0285 0266  .f.<.|.|.d.d...f
-00000e60: 0219 007c 077c 087c 0a66 0219 001b 007c  ...|.|.|.f.....|
-00000e70: 077c 0864 0264 0285 0266 023c 007c 09a0  .|.d.d...f.<.|..
-00000e80: 0c7c 087c 0a66 02a1 0101 0064 067d 0b01  .|.|.f.....d.}..
-00000e90: 007c 0b73 f471 6674 0964 037c 0583 0244  .|.s.qft.d.|...D
-00000ea0: 005d 2f7d 0c74 0a7c 077c 0c7c 0a66 0219  .]/}.t.|.|.|.f..
-00000eb0: 0083 017c 026b 0090 0173 0b7c 0c7c 086b  ...|.k...s.|.|.k
-00000ec0: 0290 0172 0c71 f97c 077c 0c64 0264 0285  ...r.q.|.|.d.d..
-00000ed0: 0266 0219 007c 077c 0c7c 0a66 0219 007c  .f...|.|.|.f...|
-00000ee0: 077c 0864 0264 0285 0266 0219 0014 0018  .|.d.d...f......
-00000ef0: 007c 077c 0c64 0264 0285 0266 023c 0071  .|.|.d.d...f.<.q
-00000f00: f97c 0864 0717 007d 0871 667c 0764 0264  .|.d...}.qf|.d.d
-00000f10: 0285 0264 027c 0685 0266 0219 007c 0764  ...d.|...f...|.d
-00000f20: 0264 0285 027c 0664 0285 0266 0219 007c  .d...|.d...f...|
-00000f30: 0966 0353 0029 0861 b502 0000 0a20 2020  .f.S.).a.....   
-00000f40: 2043 6f6d 7075 7465 2074 6865 2072 6564   Compute the red
-00000f50: 7563 6564 2072 6f77 2065 6368 656c 6f6e  uced row echelon
-00000f60: 2066 6f72 6d20 6f66 204d 2028 4d20 6361   form of M (M ca
-00000f70: 6e20 6265 2061 2072 6561 6c20 6f72 2063  n be a real or c
-00000f80: 6f6d 706c 6578 206d 6174 7269 7829 2e0a  omplex matrix)..
-00000f90: 2020 2020 0a20 2020 2050 6172 616d 6574      .    Paramet
-00000fa0: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-00000fb0: 2d2d 0a20 2020 204d 3a20 6d61 7472 6978  --.    M: matrix
-00000fc0: 0a20 2020 2020 2020 206d 6174 7269 7820  .        matrix 
-00000fd0: 746f 2062 6520 7472 616e 7366 6f72 6d65  to be transforme
-00000fe0: 642e 0a20 2020 2020 2020 200a 2020 2020  d..        .    
-00000ff0: 6175 676d 656e 743a 206d 6174 7269 782c  augment: matrix,
-00001000: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00001010: 2020 6f70 7469 6f6e 616c 206d 6174 7269    optional matri
-00001020: 7820 746f 2062 6520 7573 6564 206f 6e20  x to be used on 
-00001030: 7468 6520 7269 6768 742d 6861 6e64 2073  the right-hand s
-00001040: 6964 6520 6f66 204d 2c20 616e 6420 7768  ide of M, and wh
-00001050: 6963 6820 7769 6c6c 2062 6520 7369 6d75  ich will be simu
-00001060: 6c74 616e 656f 7573 6c79 2074 7261 6e73  ltaneously trans
-00001070: 666f 726d 6564 2e0a 2020 2020 2020 2020  formed..        
-00001080: 4966 206e 6f74 6869 6e67 2073 7065 6369  If nothing speci
-00001090: 6669 6564 2c20 7468 6520 6964 656e 7469  fied, the identi
-000010a0: 7479 206d 6174 7269 7820 7769 6c6c 2062  ty matrix will b
-000010b0: 6520 7573 6564 2e0a 2020 2020 2020 2020  e used..        
-000010c0: 0a20 2020 2074 6f6c 3a20 666c 6f61 742c  .    tol: float,
-000010d0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-000010e0: 2020 4120 746f 6c65 7261 6e63 6520 6279    A tolerance by
-000010f0: 2077 6869 6368 2077 6520 6964 656e 7469   which we identi
-00001100: 6679 2073 6d61 6c6c 206e 756d 6265 7273  fy small numbers
-00001110: 2061 7320 7a65 726f 2e0a 2020 2020 0a20   as zero..    . 
-00001120: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
-00001130: 2d2d 2d2d 2d2d 0a20 2020 2074 7269 706c  ------.    tripl
-00001140: 650a 2020 2020 2020 2020 4120 7472 6970  e.        A trip
-00001150: 6c65 2063 6f6e 7369 7374 696e 6720 6f66  le consisting of
-00001160: 2069 2920 7468 6520 7472 616e 7366 6f72   i) the transfor
-00001170: 6d65 6420 6d61 7472 6978 204d 2c20 6969  med matrix M, ii
-00001180: 2920 7468 6520 7472 616e 7366 6f72 6d65  ) the transforme
-00001190: 6420 6175 676d 656e 7420 616e 6420 6969  d augment and ii
-000011a0: 6929 2074 6865 2070 6976 6f74 2069 6e64  i) the pivot ind
-000011b0: 6963 6573 0a20 2020 2020 2020 206f 6620  ices.        of 
-000011c0: 7468 6520 7472 616e 7366 6f72 6d65 6420  the transformed 
-000011d0: 6d61 7472 6978 204d 2028 6120 6c69 7374  matrix M (a list
-000011e0: 206f 6620 7475 706c 6573 292e 0a20 2020   of tuples)..   
-000011f0: 2072 1200 0000 4e72 0100 0000 7211 0000   r....Nr....r...
-00001200: 0046 5472 2800 0000 290d 7203 0000 00da  .FTr(...).r.....
-00001210: 0573 6861 7065 721a 0000 00da 0365 7965  .shaper......eye
-00001220: da04 626d 6174 da04 726f 7773 da04 636f  ..bmat..rows..co
-00001230: 6c73 7217 0000 00da 057a 6572 6f73 7215  lsr......zerosr.
-00001240: 0000 0072 3600 0000 da04 636f 7079 da06  ...r6.....copy..
-00001250: 6170 7065 6e64 290e da01 4d5a 0761 7567  append)...MZ.aug
-00001260: 6d65 6e74 7238 0000 0072 1d00 0000 721e  mentr8...r....r.
-00001270: 0000 00da 016e 7223 0000 005a 044d 6f6e  .....nr#...Z.Mon
-00001280: 655a 0f70 6976 6f74 5f72 6f77 5f69 6e64  eZ.pivot_row_ind
-00001290: 6578 5a0d 7069 766f 745f 696e 6469 6365  exZ.pivot_indice
-000012a0: 7372 2d00 0000 5a12 636f 6c75 6d6e 5f6a  sr-...Z.column_j
-000012b0: 5f68 6173 5f70 6976 6f74 720a 0000 00da  _has_pivotr.....
-000012c0: 0970 6976 6f74 5f72 6f77 7205 0000 0072  .pivot_rowr....r
-000012d0: 0500 0000 720d 0000 00da 0472 7265 6644  ....r......rrefD
-000012e0: 0000 0073 5400 0000 0816 0802 0a01 0801  ...sT...........
-000012f0: 0a01 1201 0e01 0802 0e01 0801 0a01 0e01  ................
-00001300: 1201 1401 1401 0403 0401 0c01 0403 0e01  ................
-00001310: 1402 0201 0802 0802 1601 3001 0801 1401  ..........0.....
-00001320: 2c01 1001 2803 0e02 0401 0201 0402 0203  ,...(...........
-00001330: 0e03 2001 0201 3a01 0a02 2a02 7246 0000  .. ...:...*.rF..
-00001340: 0063 0100 0000 0000 0000 0000 0000 0900  .c..............
-00001350: 0000 0400 0000 4b00 0000 732a 0100 0074  ......K...s*...t
-00001360: 007c 0083 017d 027c 0264 016b 0272 0d74  .|...}.|.d.k.r.t
-00001370: 01a0 027c 00a1 017d 007c 0264 026b 0272  ...|...}.|.d.k.r
-00001380: 1674 03a0 047c 00a1 017d 0074 057c 00a0  .t...|...}.t.|..
-00001390: 06a1 0066 0169 007c 01a4 018e 015c 037d  ...f.i.|.....\.}
-000013a0: 037d 047d 0574 077c 0583 0164 036b 0272  .}.}.t.|...d.k.r
-000013b0: 4d7c 0264 016b 0272 3c74 01a0 087c 006a  M|.d.k.r<t...|.j
-000013c0: 0964 0419 00a1 017d 0674 01a0 0467 0067  .d.....}.t...g.g
-000013d0: 01a1 017d 076e 317c 0264 026b 0272 4c74  ...}.n1|.d.k.rLt
-000013e0: 03a0 087c 006a 0aa1 017d 0674 03a0 0467  ...|.j...}.t...g
-000013f0: 0067 01a1 017d 076e 207c 0564 0519 0064  .g...}.n |.d...d
-00001400: 0319 0064 0417 007d 087c 047c 0864 0685  ...d...}.|.|.d..
-00001410: 0264 0664 0685 0266 0219 00a0 06a1 007d  .d.d...f.......}
-00001420: 067c 0364 067c 0885 0264 0664 0685 0266  .|.d.|...d.d...f
-00001430: 0219 00a0 06a1 007d 077c 0264 016b 0272  .......}.|.d.k.r
-00001440: 827c 066a 0964 0419 007c 076a 0964 0419  .|.j.d...|.j.d..
-00001450: 0017 007c 006a 0964 0419 006b 0273 824a  ...|.j.d...k.s.J
-00001460: 0082 017c 0264 026b 0272 917c 066a 0a7c  ...|.d.k.r.|.j.|
-00001470: 076a 0a17 007c 006a 0a6b 0273 914a 0082  .j...|.j.k.s.J..
-00001480: 017c 077c 0666 0253 0029 0761 8901 0000  .|.|.f.S.).a....
-00001490: 0a20 2020 204f 6274 6169 6e20 6120 6261  .    Obtain a ba
-000014a0: 7369 7320 666f 7220 7468 6520 696d 6167  sis for the imag
-000014b0: 6520 616e 6420 7468 6520 6b65 726e 656c  e and the kernel
-000014c0: 206f 6620 4d2e 0a20 2020 204d 2063 616e   of M..    M can
-000014d0: 2062 6520 6120 7265 616c 206f 7220 636f   be a real or co
-000014e0: 6d70 6c65 7820 6d61 7472 6978 2e0a 2020  mplex matrix..  
-000014f0: 2020 0a20 2020 2050 6172 616d 6574 6572    .    Parameter
-00001500: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-00001510: 0a20 2020 204d 3a0a 2020 2020 2020 2020  .    M:.        
-00001520: 6d61 7472 6978 2074 6f20 6265 2061 6e61  matrix to be ana
-00001530: 6c79 7a65 642e 0a20 2020 2020 2020 200a  lyzed..        .
-00001540: 2020 2020 2a2a 6b77 6172 6773 0a20 2020      **kwargs.   
-00001550: 2020 2020 2041 6464 6974 696f 6e61 6c20       Additional 
-00001560: 6172 6775 6d65 6e74 7320 7061 7373 6564  arguments passed
-00001570: 2074 6f20 7272 6566 2072 6f75 7469 6e65   to rref routine
-00001580: 2e0a 2020 2020 2020 2020 0a20 2020 2052  ..        .    R
-00001590: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-000015a0: 2d2d 0a20 2020 2069 6d61 6765 3a0a 2020  --.    image:.  
-000015b0: 2020 2020 2020 6d61 7472 6978 2073 7061        matrix spa
-000015c0: 6e6e 696e 6720 7468 6520 696d 6167 6520  nning the image 
-000015d0: 6f66 204d 0a20 2020 2020 2020 200a 2020  of M.        .  
-000015e0: 2020 6b65 726e 656c 3a0a 2020 2020 2020    kernel:.      
-000015f0: 2020 6d61 7472 6978 2073 7061 6e6e 696e    matrix spannin
-00001600: 6720 746f 2074 6865 206b 6572 6e65 6c20  g to the kernel 
-00001610: 6f66 204d 0a20 2020 2072 1200 0000 7211  of M.    r....r.
-00001620: 0000 0072 0100 0000 7228 0000 00e9 ffff  ...r....r(......
-00001630: ffff 4e29 0b72 0300 0000 721a 0000 00da  ..N).r....r.....
-00001640: 0561 7272 6179 7217 0000 00da 066d 6174  .arrayr......mat
-00001650: 7269 7872 4600 0000 da09 7472 616e 7370  rixrF.....transp
-00001660: 6f73 6572 1600 0000 723c 0000 0072 3b00  oser....r<...r;.
-00001670: 0000 723f 0000 0029 0972 4300 0000 721d  ..r?...).rC...r.
-00001680: 0000 0072 1e00 0000 5a03 496d 545a 044b  ...r....Z.ImTZ.K
-00001690: 6572 54da 0670 6976 6f74 73da 066b 6572  erT..pivots..ker
-000016a0: 6e65 6cda 0569 6d61 6765 5a10 7a65 726f  nel..imageZ.zero
-000016b0: 5f72 6f77 5f69 6e64 6963 6573 7205 0000  _row_indicesr...
-000016c0: 0072 0500 0000 720d 0000 00da 0569 6d6b  .r....r......imk
-000016d0: 6572 9900 0000 732c 0000 0008 1808 010a  er....s,........
-000016e0: 0108 010a 011a 020c 0108 0210 010e 0108  ................
-000016f0: 010c 010c 0102 8010 0218 0118 0108 0322  ..............."
-00001700: 0108 0116 0108 0272 4e00 0000 4629 01da  .......rN...F)..
-00001710: 0267 7363 0000 0000 0000 0000 0100 0000  .gsc............
-00001720: 0600 0000 0400 0000 0f00 0000 73da 0000  ............s...
-00001730: 0074 007c 0164 0119 0083 017d 037c 0364  .t.|.d.....}.|.d
-00001740: 026b 0272 0f74 01a0 027c 01a1 017d 017c  .k.r.t...|...}.|
-00001750: 0364 036b 0272 1874 03a0 047c 01a1 017d  .d.k.r.t...|...}
-00001760: 0174 057c 01a0 06a1 0066 0169 007c 02a4  .t.|.....f.i.|..
-00001770: 018e 015c 027d 0489 007c 0364 026b 0272  ...\.}...|.d.k.r
-00001780: 2e88 006a 075c 0289 017d 056e 0b7c 0364  ...j.\...}.n.|.d
-00001790: 036b 0272 3988 006a 0888 006a 0902 0289  .k.r9..j...j....
-000017a0: 017d 057c 0072 5588 0164 016b 0472 557c  .}.|.rU..d.k.rU|
-000017b0: 0564 016b 0472 5574 0a87 0087 0166 0264  .d.k.rUt.....f.d
-000017c0: 0464 0584 0874 0b7c 0583 0144 0083 0166  .d...t.|...D...f
-000017d0: 0169 007c 02a4 018e 0189 007c 0364 026b  .i.|.......|.d.k
-000017e0: 0272 6074 01a0 0288 00a1 01a0 0ca1 0053  .r`t...........S
-000017f0: 007c 0364 036b 0272 6b74 03a0 0488 00a1  .|.d.k.rkt......
-00001800: 01a0 0ca1 0053 0064 0653 0029 0761 1902  .....S.d.S.).a..
-00001810: 0000 0a20 2020 2050 726f 7669 6465 2061  ...    Provide a
-00001820: 6e20 6578 7465 6e73 696f 6e20 6f66 2061  n extension of a
-00001830: 2067 6976 656e 2073 6574 206f 6620 7665   given set of ve
-00001840: 6374 6f72 7320 746f 2073 7061 6e20 7468  ctors to span th
-00001850: 6520 6675 6c6c 2073 7061 6365 2e20 0a20  e full space. . 
-00001860: 2020 2054 6865 2076 6563 746f 7273 2063     The vectors c
-00001870: 616e 2068 6176 6520 7265 616c 206f 7220  an have real or 
-00001880: 636f 6d70 6c65 7820 636f 6566 6669 6369  complex coeffici
-00001890: 656e 7473 2e0a 2020 2020 0a20 2020 2050  ents..    .    P
-000018a0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-000018b0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 202a 7665  --------.    *ve
-000018c0: 6374 733a 0a20 2020 2020 2020 2056 6563  cts:.        Vec
-000018d0: 746f 7273 2074 6f20 6265 2065 7874 656e  tors to be exten
-000018e0: 6465 640a 2020 2020 2020 2020 0a20 2020  ded.        .   
-000018f0: 2067 733a 2062 6f6f 6c65 616e 2c20 6f70   gs: boolean, op
-00001900: 7469 6f6e 616c 0a20 2020 2020 2020 2041  tional.        A
-00001910: 7070 6c79 2074 6865 2047 7261 6d2d 5363  pply the Gram-Sc
-00001920: 686d 6964 7420 6f72 7468 6f67 6f6e 616c  hmidt orthogonal
-00001930: 697a 6174 696f 6e20 7072 6f63 6564 7572  ization procedur
-00001940: 6520 6f6e 2074 6865 2065 7874 656e 7369  e on the extensi
-00001950: 6f6e 2e0a 2020 2020 2020 2020 0a20 2020  on..        .   
-00001960: 202a 2a6b 7761 7267 730a 2020 2020 2020   **kwargs.      
-00001970: 2020 4f70 7469 6f6e 616c 2061 7267 756d    Optional argum
-00001980: 656e 7473 2070 6173 7365 6420 746f 2067  ents passed to g
-00001990: 7261 6d5f 7363 686d 6964 742e 2049 6e20  ram_schmidt. In 
-000019a0: 7573 6520 6f6e 6c79 2069 6620 6773 3d54  use only if gs=T
-000019b0: 7275 652e 0a20 2020 2020 2020 200a 2020  rue..        .  
-000019c0: 2020 5265 7475 726e 730a 2020 2020 2d2d    Returns.    --
-000019d0: 2d2d 2d2d 2d0a 2020 2020 6d61 7472 6978  -----.    matrix
-000019e0: 0a20 2020 2020 2020 2041 206d 6174 7269  .        A matri
-000019f0: 7820 7265 7072 6573 656e 7469 6e67 2061  x representing a
-00001a00: 2062 6173 6973 2065 7874 656e 7369 6f6e   basis extension
-00001a10: 206f 6620 7468 6520 6769 7665 6e20 7665   of the given ve
-00001a20: 6374 6f72 732e 0a20 2020 2072 0100 0000  ctors..    r....
-00001a30: 7212 0000 0072 1100 0000 6301 0000 0000  r....r....c.....
-00001a40: 0000 0000 0000 0001 0000 0005 0000 0013  ................
-00001a50: 0000 0073 2400 0000 6700 7c00 5d0e 8900  ...s$...g.|.]...
-00001a60: 8701 8700 6602 6400 6401 8408 7400 8802  ....f.d.d...t...
-00001a70: 8301 4400 8301 9102 7102 5300 2902 6301  ..D.....q.S.).c.
-00001a80: 0000 0000 0000 0000 0000 0002 0000 0005  ................
-00001a90: 0000 0013 0000 0073 1800 0000 6700 7c00  .......s....g.|.
-00001aa0: 5d08 7d01 8800 7c01 8801 6602 1900 9102  ].}...|...f.....
-00001ab0: 7102 5300 7205 0000 0072 0500 0000 7208  q.S.r....r....r.
-00001ac0: 0000 0029 02da 0365 7874 722d 0000 0072  ...)...extr-...r
-00001ad0: 0500 0000 720d 0000 0072 0e00 0000 f100  ....r....r......
-00001ae0: 0000 7232 0000 007a 2e62 6173 6973 5f65  ..r2...z.basis_e
-00001af0: 7874 656e 7369 6f6e 2e3c 6c6f 6361 6c73  xtension.<locals
-00001b00: 3e2e 3c6c 6973 7463 6f6d 703e 2e3c 6c69  >.<listcomp>.<li
-00001b10: 7374 636f 6d70 3e72 3300 0000 7234 0000  stcomp>r3...r4..
-00001b20: 00a9 0272 5000 0000 7244 0000 00a9 0172  ...rP...rD.....r
-00001b30: 2d00 0000 720d 0000 0072 0e00 0000 f100  -...r....r......
-00001b40: 0000 722f 0000 007a 2362 6173 6973 5f65  ..r/...z#basis_e
-00001b50: 7874 656e 7369 6f6e 2e3c 6c6f 6361 6c73  xtension.<locals
-00001b60: 3e2e 3c6c 6973 7463 6f6d 703e 4e29 0d72  >.<listcomp>N).r
-00001b70: 0300 0000 721a 0000 0072 4800 0000 7217  ....r....rH...r.
-00001b80: 0000 0072 4900 0000 724e 0000 0072 0700  ...rI...rN...r..
-00001b90: 0000 723b 0000 0072 3e00 0000 723f 0000  ..r;...r>...r?..
-00001ba0: 0072 3900 0000 7215 0000 0072 4a00 0000  .r9...r....rJ...
-00001bb0: 2906 724f 0000 00da 0576 6563 7473 721d  ).rO.....vectsr.
-00001bc0: 0000 0072 1e00 0000 da01 5f72 2300 0000  ...r......_r#...
-00001bd0: 7205 0000 0072 5100 0000 720d 0000 00da  r....rQ...r.....
-00001be0: 0f62 6173 6973 5f65 7874 656e 7369 6f6e  .basis_extension
-00001bf0: ce00 0000 7322 0000 000c 1508 010a 0108  ....s"..........
-00001c00: 010a 0118 0208 020c 0108 010e 0114 0224  ...............$
-00001c10: 0108 020e 0108 010e 0104 ff72 5500 0000  ...........rU...
-00001c20: 6302 0000 0000 0000 0000 0000 0005 0000  c...............
-00001c30: 0005 0000 000b 0000 0073 0801 0000 7400  .........s....t.
-00001c40: 7c00 8301 7d03 7c03 6401 6b02 723c 7c00  |...}.|.d.k.r<|.
-00001c50: 6a01 6402 1900 7c00 6a01 6403 1900 6b02  j.d...|.j.d...k.
-00001c60: 7314 4a00 8201 7c01 731f 7402 6a03 a004  s.J...|.s.t.j...
-00001c70: 7c00 a101 5c02 7d04 8900 6e08 7402 6a03  |...\.}...n.t.j.
-00001c80: a005 7c00 a101 5c02 7d04 8900 7c04 a006  ..|...\.}...|...
-00001c90: a100 7d04 8700 6601 6404 6405 8408 7407  ..}...f.d.d...t.
-00001ca0: 7408 7c04 8301 8301 4400 8301 8900 7c04  t.|.....D.....|.
-00001cb0: 8800 6602 5300 7c03 6406 6b02 727c 7c00  ..f.S.|.d.k.r||.
-00001cc0: 6a09 7c00 6a0a 6b02 7348 4a00 8201 6407  j.|.j.k.sHJ...d.
-00001cd0: 7c02 a00b a100 7600 7254 7c02 6407 1900  |.....v.rT|.d...
-00001ce0: 740c 6a0c 5f0d 7c01 7361 740c a004 740c  t.j._.|.sat...t.
-00001cf0: a00e 7c00 a101 a101 5c02 7d04 8900 6e0a  ..|.....\.}...n.
-00001d00: 740c a005 740c a00e 7c00 a101 a101 5c02  t...t...|.....\.
-00001d10: 7d04 8900 8700 6601 6408 6405 8408 7407  }.....f.d.d...t.
-00001d20: 7408 7c04 8301 8301 4400 8301 8900 7c04  t.|.....D.....|.
-00001d30: 8800 6602 5300 740f 6409 7c03 9b00 640a  ..f.S.t.d.|...d.
-00001d40: 9d03 8301 8201 290b 6112 0100 000a 2020  ......).a.....  
-00001d50: 2020 436f 6d70 7574 6520 7468 6520 6569    Compute the ei
-00001d60: 6765 6e76 616c 7565 7320 616e 6420 6569  genvalues and ei
-00001d70: 6765 6e76 6563 746f 7273 206f 6620 6120  genvectors of a 
-00001d80: 6769 7665 6e20 6d61 7472 6978 2c20 6261  given matrix, ba
-00001d90: 7365 6420 6f6e 2075 6e64 6572 6c79 696e  sed on underlyin
-00001da0: 6720 636f 6465 2e0a 2020 2020 0a20 2020  g code..    .   
-00001db0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00001dc0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 204d  ----------.    M
-00001dd0: 3a20 6d61 7472 6978 0a20 2020 2020 2020  : matrix.       
-00001de0: 204d 6174 7269 7820 746f 2062 6520 636f   Matrix to be co
-00001df0: 6e73 6964 6572 6564 2e0a 2020 2020 2020  nsidered..      
-00001e00: 2020 0a20 2020 2073 796d 6d65 7472 6963    .    symmetric
-00001e10: 3a20 626f 6f6c 6561 6e2c 206f 7074 696f  : boolean, optio
-00001e20: 6e61 6c0a 2020 2020 2020 2020 5768 6574  nal.        Whet
-00001e30: 6865 7220 7468 6520 6d61 7472 6978 2069  her the matrix i
-00001e40: 7320 6173 7375 6d65 6420 746f 2062 6520  s assumed to be 
-00001e50: 7379 6d6d 6574 7269 632e 0a20 2020 2072  symmetric..    r
-00001e60: 1200 0000 7201 0000 0072 2800 0000 6301  ....r....r(...c.
-00001e70: 0000 0000 0000 0000 0000 0002 0000 0005  ................
-00001e80: 0000 0013 0000 0073 2200 0000 6700 7c00  .......s"...g.|.
-00001e90: 5d0d 7d01 7400 a001 8800 a101 6400 6400  ].}.t.......d.d.
-00001ea0: 8502 7c01 6602 1900 9102 7102 5300 a901  ..|.f.....q.S...
-00001eb0: 4e29 0272 1a00 0000 7248 0000 00a9 0272  N).r....rH.....r
-00001ec0: 0900 0000 722d 0000 00a9 01da 0c65 6967  ....r-.......eig
-00001ed0: 656e 7665 6374 6f72 7372 0500 0000 720d  envectorsr....r.
-00001ee0: 0000 0072 0e00 0000 0e01 0000 7227 0000  ...r........r'..
-00001ef0: 007a 1765 6967 2e3c 6c6f 6361 6c73 3e2e  .z.eig.<locals>.
-00001f00: 3c6c 6973 7463 6f6d 703e 7211 0000 00da  <listcomp>r.....
-00001f10: 0364 7073 6301 0000 0000 0000 0000 0000  .dpsc...........
-00001f20: 0002 0000 0005 0000 0013 0000 0073 1c00  .............s..
-00001f30: 0000 6700 7c00 5d0a 7d01 8800 6400 6400  ..g.|.].}...d.d.
-00001f40: 8502 7c01 6602 1900 9102 7102 5300 7256  ..|.f.....q.S.rV
-00001f50: 0000 0072 0500 0000 7257 0000 0072 5800  ...r....rW...rX.
-00001f60: 0000 7205 0000 0072 0d00 0000 720e 0000  ..r....r....r...
-00001f70: 0019 0100 0072 1000 0000 7a06 636f 6465  .....r....z.code
-00001f80: 2027 7a11 2720 6e6f 7420 7265 636f 676e   'z.' not recogn
-00001f90: 697a 6564 2e29 1072 0300 0000 723b 0000  ized.).r....r;..
-00001fa0: 0072 1a00 0000 da06 6c69 6e61 6c67 da03  .r......linalg..
-00001fb0: 6569 67da 0465 6967 68da 0674 6f6c 6973  eig..eigh..tolis
-00001fc0: 7472 1500 0000 7216 0000 0072 3f00 0000  tr....r....r?...
-00001fd0: 723e 0000 00da 046b 6579 7372 1700 0000  r>.....keysr....
-00001fe0: 725a 0000 0072 4900 0000 7237 0000 0029  rZ...rI...r7...)
-00001ff0: 0572 4300 0000 da09 7379 6d6d 6574 7269  .rC.....symmetri
-00002000: 6372 1d00 0000 721e 0000 00da 0b65 6967  cr....r......eig
-00002010: 656e 7661 6c75 6573 7205 0000 0072 5800  envaluesr....rX.
-00002020: 0000 720d 0000 0072 5c00 0000 f900 0000  ..r....r\.......
-00002030: 7326 0000 0008 0c08 0218 0104 0112 0110  s&..............
-00002040: 0208 011a 0108 0f08 f310 010c 010c 0104  ................
-00002050: 0216 0114 021a 0108 0410 fe72 5c00 0000  ...........r\...
-00002060: 5463 0400 0000 0000 0000 0000 0000 1600  Tc..............
-00002070: 0000 0800 0000 0b00 0000 7364 0200 0074  ..........sd...t
-00002080: 007c 0083 017d 0574 017c 0066 0169 007c  .|...}.t.|.f.i.|
-00002090: 04a4 018e 015c 0289 0089 0174 0288 0083  .....\.....t....
-000020a0: 017d 067c 0664 016b 0473 184a 0082 0174  .}.|.d.k.s.J...t
-000020b0: 0288 0164 0119 0083 017d 0774 0387 0366  ...d.....}.t...f
-000020c0: 0164 0264 0384 0888 0144 0083 0183 0173  .d.d.....D.....s
-000020d0: 314a 0064 0488 039b 0064 059d 0383 0182  1J.d.....d......
-000020e0: 0164 0167 0167 017d 0874 0464 067c 0683  .d.g.g.}.t.d.|..
-000020f0: 0244 005d 387d 0964 017d 0a7c 0a74 027c  .D.]8}.d.}.|.t.|
-00002100: 0883 016b 0072 6674 0588 007c 0919 0088  ...k.rft...|....
-00002110: 007c 087c 0a19 0064 0119 0019 0018 0083  .|.|...d........
-00002120: 0188 036b 0072 5c7c 087c 0a19 00a0 067c  ...k.r\|.|.....|
-00002130: 09a1 0101 006e 0a7c 0a64 0637 007d 0a7c  .....n.|.d.7.}.|
-00002140: 0a74 027c 0883 016b 0073 447c 0a74 027c  .t.|...k.sD|.t.|
-00002150: 0883 016b 0272 727c 08a0 067c 0967 01a1  ...k.rr|...|.g..
-00002160: 0101 0071 3a7c 0372 af74 077c 0066 0164  ...q:|.r.t.|.f.d
-00002170: 0788 0369 017c 04a4 018e 015c 027d 0b7d  ...i.|.....\.}.}
-00002180: 0c7c 0564 086b 0272 8a7c 0c6a 0864 0619  .|.d.k.r.|.j.d..
-00002190: 007d 0d7c 0564 096b 0272 917c 0c6a 097d  .}.|.d.k.r.|.j.}
-000021a0: 0d74 0287 0087 0366 0264 0a64 0384 087c  .t.....f.d.d...|
-000021b0: 0844 0083 0183 017d 0e7c 0d7c 0e6b 0273  .D.....}.|.|.k.s
-000021c0: af4a 0064 0b7c 0e9b 0064 0c7c 0d9b 0064  .J.d.|...d.|...d
-000021d0: 0d88 039b 0064 0e9d 0783 0182 0167 0067  .....d.......g.g
-000021e0: 0002 027d 0f7d 107c 0844 005d 7789 0287  ...}.}.|.D.]w...
-000021f0: 0187 0266 0264 0f64 0384 0874 047c 0783  ...f.d.d...t.|..
-00002200: 0144 0083 017d 117c 0564 086b 0272 cd74  .D...}.|.d.k.r.t
-00002210: 0aa0 0b7c 11a1 017d 127c 0564 096b 0272  ...|...}.|.d.k.r
-00002220: d674 0ca0 0d7c 11a1 017d 1274 077c 1266  .t...|...}.t.|.f
-00002230: 0164 0788 0369 017c 04a4 018e 015c 0289  .d...i.|.....\..
-00002240: 047d 137c 0564 086b 0272 ec88 04a0 0ea1  .}.|.d.k.r......
-00002250: 00a0 0fa1 0089 047c 0564 096b 0272 fc87  .......|.d.k.r..
-00002260: 0466 0164 1064 0384 0874 0488 046a 0983  .f.d.d...t...j..
-00002270: 0144 0083 0189 0474 1088 0466 0164 0788  .D.....t...f.d..
-00002280: 0369 017c 04a4 018e 017d 1487 0066 0164  .i.|.....}...f.d
-00002290: 1164 0384 0888 0264 1274 027c 1483 0185  .d.....d.t.|....
-000022a0: 0219 0044 0083 017d 157c 0190 0172 217c  ...D...}.|...r!|
-000022b0: 107c 1437 007d 107c 0f7c 1537 007d 0f71  .|.7.}.|.|.7.}.q
-000022c0: b67c 10a0 067c 14a1 0101 007c 0fa0 067c  .|...|.....|...|
-000022d0: 1564 0119 00a1 0101 0071 b67c 0f7c 1066  .d.......q.|.|.f
-000022e0: 0253 0029 1361 a807 0000 0a20 2020 204c  .S.).a.....    L
-000022f0: 6574 204d 2062 6520 6120 7371 7561 7265  et M be a square
-00002300: 206d 6174 7269 782e 2054 6865 6e20 7468   matrix. Then th
-00002310: 6973 2072 6f75 7469 6e65 2077 696c 6c20  is routine will 
-00002320: 6174 7465 6d70 7420 746f 2064 6574 6572  attempt to deter
-00002330: 6d69 6e65 2061 2062 6173 6973 206f 6620  mine a basis of 
-00002340: 6e6f 726d 616c 697a 6564 2065 6967 656e  normalized eigen
-00002350: 7665 6374 6f72 732e 200a 2020 2020 4865  vectors. .    He
-00002360: 7265 6279 2065 6967 656e 7665 6374 6f72  reby eigenvector
-00002370: 7320 6265 6c6f 6e67 696e 6720 746f 2074  s belonging to t
-00002380: 6865 2073 616d 6520 6569 6765 6e76 616c  he same eigenval
-00002390: 7565 7320 6172 6520 2863 6f6d 706c 6578  ues are (complex
-000023a0: 2920 6f72 7468 6f67 6f6e 616c 697a 6564  ) orthogonalized
-000023b0: 2e0a 2020 2020 0a20 2020 2021 2121 2041  ..    .    !!! A
-000023c0: 7474 656e 7469 6f6e 2021 2121 0a20 2020  ttention !!!.   
-000023d0: 2053 696e 6365 2074 6865 2064 6961 676f   Since the diago
-000023e0: 6e61 6c69 7a61 626c 6520 6d61 7472 6963  nalizable matric
-000023f0: 6573 2077 6974 6820 636f 6d70 6c65 7820  es with complex 
-00002400: 656e 7472 6965 7320 6c61 7920 6465 6e73  entries lay dens
-00002410: 6520 7769 7468 696e 2074 6865 2073 6574  e within the set
-00002420: 206f 6620 616c 6c20 636f 6d70 6c65 7820   of all complex 
-00002430: 6d61 7472 6963 6573 2c0a 2020 2020 7468  matrices,.    th
-00002440: 6520 636f 6465 206d 6179 2066 6169 6c20  e code may fail 
-00002450: 666f 7220 696c 6c2d 636f 6e64 6974 696f  for ill-conditio
-00002460: 6e65 6420 6d61 7472 6963 6573 2e20 4e6f  ned matrices. No
-00002470: 7465 2074 6861 7420 6120 6d61 7472 6978  te that a matrix
-00002480: 2069 7320 6469 6167 6f6e 616c 697a 6162   is diagonalizab
-00002490: 6c65 2069 6620 0a20 2020 2061 6e64 206f  le if .    and o
-000024a0: 6e6c 7920 6966 2066 6f72 2065 6163 6820  nly if for each 
-000024b0: 6569 6765 6e76 616c 7565 2074 6865 2064  eigenvalue the d
-000024c0: 696d 656e 7369 6f6e 206f 6620 7468 6520  imension of the 
-000024d0: 6569 6765 6e73 7061 6365 2069 7320 6571  eigenspace is eq
-000024e0: 7561 6c20 746f 2074 6865 206d 756c 7469  ual to the multi
-000024f0: 706c 6963 6974 7920 0a20 2020 206f 6620  plicity .    of 
-00002500: 7468 6520 6569 6765 6e76 616c 7565 2e0a  the eigenvalue..
-00002510: 2020 2020 0a20 2020 2049 7420 6d61 7920      .    It may 
-00002520: 6861 7070 656e 2074 6861 7420 7468 6520  happen that the 
-00002530: 636f 6465 2077 696c 6c20 6465 7465 726d  code will determ
-00002540: 696e 6520 6120 6469 6666 6572 656e 7420  ine a different 
-00002550: 7365 7420 6f66 2064 696d 656e 7369 6f6e  set of dimension
-00002560: 206f 6620 7468 6520 6569 6765 6e73 7061   of the eigenspa
-00002570: 6365 2074 6861 6e0a 2020 2020 7468 6520  ce than.    the 
-00002580: 756e 6465 726c 7969 6e67 206d 756c 7469  underlying multi
-00002590: 706c 6963 6974 7920 6f66 2069 7473 2063  plicity of its c
-000025a0: 6f72 7265 7370 6f6e 6469 6e67 2065 6967  orresponding eig
-000025b0: 656e 7661 6c75 652e 2046 6f72 2065 7861  envalue. For exa
-000025c0: 6d70 6c65 2c20 7468 6520 6d75 6c74 6970  mple, the multip
-000025d0: 6c69 6369 7479 206f 6620 6120 0a20 2020  licity of a .   
-000025e0: 207a 6572 6f2d 6569 6765 6e76 616c 7565   zero-eigenvalue
-000025f0: 206d 6967 6874 2062 6520 322c 2074 6865   might be 2, the
-00002600: 2061 6374 7561 6c20 6469 6d65 6e73 696f   actual dimensio
-00002610: 6e20 6f66 2074 6865 206b 6572 6e65 6c20  n of the kernel 
-00002620: 6f66 2074 6865 2067 6976 656e 206d 6174  of the given mat
-00002630: 7269 7820 6973 2031 2c20 0a20 2020 2062  rix is 1, .    b
-00002640: 7574 2064 7565 2074 6f20 726f 756e 642d  ut due to round-
-00002650: 6f66 6620 6572 726f 7273 2074 6865 2063  off errors the c
-00002660: 6f64 6520 6d61 7920 7374 696c 6c20 6669  ode may still fi
-00002670: 6e64 2061 2032 2d64 696d 656e 7369 6f6e  nd a 2-dimension
-00002680: 616c 2062 6173 6973 206f 6620 7468 6520  al basis of the 
-00002690: 7a65 726f 2d65 6967 656e 7370 6163 652e  zero-eigenspace.
-000026a0: 0a20 2020 2054 6865 7265 666f 7265 2063  .    Therefore c
-000026b0: 6865 636b 2074 6865 206f 7574 7075 7420  heck the output 
-000026c0: 2861 6e64 2074 6865 2069 6e70 7574 2920  (and the input) 
-000026d0: 6361 7265 6675 6c6c 792e 0a20 2020 200a  carefully..    .
-000026e0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-000026f0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00002700: 2020 4d3a 0a20 2020 2020 2020 206c 6973    M:.        lis
-00002710: 7420 6f66 2076 6563 746f 7273 2064 6566  t of vectors def
-00002720: 696e 696e 6720 6120 286e 2078 206e 292d  ining a (n x n)-
-00002730: 6d61 7472 6978 2e0a 2020 2020 2020 2020  matrix..        
-00002740: 0a20 2020 2066 6c61 7474 656e 3a20 626f  .    flatten: bo
-00002750: 6f6c 6561 6e2c 206f 7074 696f 6e61 6c0a  olean, optional.
-00002760: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
-00002770: 2066 6c61 7474 656e 2074 6865 2072 6573   flatten the res
-00002780: 7065 6374 6976 6520 7265 7375 6c74 7320  pective results 
-00002790: 2864 6566 6175 6c74 3a20 4661 6c73 6529  (default: False)
-000027a0: 2e0a 2020 2020 2020 2020 0a20 2020 2074  ..        .    t
-000027b0: 6f6c 3a20 666c 6f61 742c 206f 7074 696f  ol: float, optio
-000027c0: 6e61 6c0a 2020 2020 2020 2020 5061 7261  nal.        Para
-000027d0: 6d65 7465 7220 746f 2069 6465 6e74 6966  meter to identif
-000027e0: 7920 736d 616c 6c20 7661 6c75 6573 2061  y small values a
-000027f0: 7320 6265 696e 6720 7a65 726f 2e0a 2020  s being zero..  
-00002800: 2020 2020 2020 0a20 2020 2063 6865 636b        .    check
-00002810: 3a20 626f 6f6c 6561 6e2c 206f 7074 696f  : boolean, optio
-00002820: 6e61 6c0a 2020 2020 2020 2020 4368 6563  nal.        Chec
-00002830: 6b20 6966 2074 6865 206e 756d 6265 7220  k if the number 
-00002840: 6f66 207a 6572 6f2d 6569 6765 6e76 616c  of zero-eigenval
-00002850: 7565 7320 6973 2063 6f6e 7369 7374 656e  ues is consisten
-00002860: 7420 7769 7468 2074 6865 2064 696d 656e  t with the dimen
-00002870: 7369 6f6e 206f 6620 7468 6520 6b65 726e  sion of the kern
-00002880: 656c 206f 6620 7468 6520 696e 7075 7420  el of the input 
-00002890: 6d61 7472 6978 2077 6974 6869 6e20 7468  matrix within th
-000028a0: 6520 6769 7665 6e20 746f 6c65 7261 6e63  e given toleranc
-000028b0: 652e 0a20 2020 2020 2020 2054 6865 206b  e..        The k
-000028c0: 6572 6e65 6c20 6f66 2074 6865 2069 6e70  ernel of the inp
-000028d0: 7574 206d 6174 7269 7820 6973 2068 6572  ut matrix is her
-000028e0: 6562 7920 6465 7465 726d 696e 6564 2062  eby determined b
-000028f0: 7920 7468 6520 696d 6b65 7220 726f 7574  y the imker rout
-00002900: 696e 652e 0a20 2020 2020 2020 200a 2020  ine..        .  
-00002910: 2020 2a2a 6b77 6172 6773 0a20 2020 2020    **kwargs.     
-00002920: 2020 204f 7074 696f 6e61 6c20 6172 6775     Optional argu
-00002930: 6d65 6e74 7320 7061 7373 6564 2074 6f20  ments passed to 
-00002940: 6569 672c 2069 6d6b 6572 2061 6e64 2067  eig, imker and g
-00002950: 7261 6d5f 7363 686d 6964 7420 726f 7574  ram_schmidt rout
-00002960: 696e 6573 2e0a 2020 2020 2020 2020 0a20  ines..        . 
-00002970: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
-00002980: 2d2d 2d2d 2d2d 0a20 2020 2065 6967 656e  ------.    eigen
-00002990: 7661 6c75 6573 3a20 6c69 7374 0a20 2020  values: list.   
-000029a0: 2020 2020 204c 6973 7420 6f66 2065 6c65       List of ele
-000029b0: 6d65 6e74 732c 2077 6865 7265 2074 6865  ments, where the
-000029c0: 206b 2d74 6820 656c 656d 656e 7420 636f   k-th element co
-000029d0: 6e73 7469 7475 7465 2074 6865 2065 6967  nstitute the eig
-000029e0: 656e 7661 6c75 6520 746f 2074 6865 206b  envalue to the k
-000029f0: 2d74 6820 6569 6765 6e73 7061 6365 2e0a  -th eigenspace..
-00002a00: 2020 2020 0a20 2020 2065 6967 656e 7665      .    eigenve
-00002a10: 6374 6f72 733a 206c 6973 740a 2020 2020  ctors: list.    
-00002a20: 2020 2020 4c69 7374 206f 6620 6c69 7374      List of list
-00002a30: 732c 2077 6865 7265 2074 6865 206b 2d74  s, where the k-t
-00002a40: 6820 656c 656d 656e 7420 6973 2061 206c  h element is a l
-00002a50: 6973 7420 6f66 2070 6169 7277 6973 6520  ist of pairwise 
-00002a60: 756e 6974 6172 7920 7665 6374 6f72 7320  unitary vectors 
-00002a70: 7370 616e 6e69 6e67 2074 6865 206b 2d74  spanning the k-t
-00002a80: 6820 6569 6765 6e73 7061 6365 2e0a 2020  h eigenspace..  
-00002a90: 2020 7201 0000 0063 0100 0000 0000 0000    r....c........
-00002aa0: 0000 0000 0200 0000 0400 0000 1300 0000  ................
-00002ab0: 7318 0000 0067 007c 005d 087d 0174 007c  s....g.|.].}.t.|
-00002ac0: 0183 0188 006b 0591 0271 0253 0072 0500  .....k...q.S.r..
-00002ad0: 0000 2901 721f 0000 00a9 0272 0900 0000  ..).r......r....
-00002ae0: da01 6529 0172 3800 0000 7205 0000 0072  ..e).r8...r....r
-00002af0: 0d00 0000 720e 0000 0052 0100 0072 3200  ....r....R...r2.
-00002b00: 0000 7a1f 6569 6765 6e73 7061 6365 732e  ..z.eigenspaces.
-00002b10: 3c6c 6f63 616c 733e 2e3c 6c69 7374 636f  <locals>.<listco
-00002b20: 6d70 3e7a 234e 6f72 6d20 6f66 2061 7420  mp>z#Norm of at 
-00002b30: 6c65 6173 7420 6f6e 6520 6569 6765 6e76  least one eigenv
-00002b40: 6563 746f 7220 3c20 da01 2e72 2800 0000  ector < ...r(...
-00002b50: 7238 0000 0072 1200 0000 7211 0000 0063  r8...r....r....c
-00002b60: 0100 0000 0000 0000 0000 0000 0200 0000  ................
-00002b70: 0600 0000 1300 0000 7324 0000 0067 007c  ........s$...g.|
-00002b80: 005d 0e7d 0174 0088 007c 0164 0019 0019  .].}.t...|.d....
-00002b90: 0083 0188 016b 0072 027c 0191 0271 0253  .....k.r.|...q.S
-00002ba0: 0072 2100 0000 2901 7236 0000 0072 6200  .r!...).r6...rb.
-00002bb0: 0000 2902 7261 0000 0072 3800 0000 7205  ..).ra...r8...r.
-00002bc0: 0000 0072 0d00 0000 720e 0000 006b 0100  ...r....r....k..
-00002bd0: 0072 2f00 0000 7a20 5468 6520 6e75 6d62  .r/...z The numb
-00002be0: 6572 206f 6620 7a65 726f 2d65 6967 656e  er of zero-eigen
-00002bf0: 7661 6c75 6573 2028 7a28 2920 6973 206e  values (z() is n
-00002c00: 6f74 2063 6f6e 7369 7374 656e 7420 7769  ot consistent wi
-00002c10: 7468 2074 6865 2064 696d 656e 7369 6f6e  th the dimension
-00002c20: 2028 7a4a 2920 6f66 2074 6865 206b 6572   (zJ) of the ker
-00002c30: 6e65 6c20 6f66 2074 6865 2069 6e70 7574  nel of the input
-00002c40: 206d 6174 7269 782c 2062 6f74 6820 6465   matrix, both de
-00002c50: 7465 726d 696e 6564 2075 7369 6e67 2061  termined using a
-00002c60: 2074 6f6c 6572 616e 6365 206f 6620 7a45   tolerance of zE
-00002c70: 2e20 4368 6563 6b20 6966 2069 6e70 7574  . Check if input
-00002c80: 206d 6174 7269 7820 6973 2064 6961 676f   matrix is diago
-00002c90: 6e61 6c69 7a61 626c 6520 6f72 2074 7279  nalizable or try
-00002ca0: 2074 6f20 6164 6a75 7374 2070 7265 6369   to adjust preci
-00002cb0: 7369 6f6e 2e63 0100 0000 0000 0000 0000  sion.c..........
-00002cc0: 0000 0100 0000 0500 0000 1300 0000 7320  ..............s 
-00002cd0: 0000 0067 007c 005d 0c89 0087 0187 0066  ...g.|.].......f
-00002ce0: 0264 0064 0184 0888 0244 0083 0191 0271  .d.d.....D.....q
-00002cf0: 0253 0029 0263 0100 0000 0000 0000 0000  .S.).c..........
-00002d00: 0000 0200 0000 0400 0000 1300 0000 7318  ..............s.
-00002d10: 0000 0067 007c 005d 087d 0188 007c 0119  ...g.|.].}...|..
-00002d20: 0088 0119 0091 0271 0253 0072 0500 0000  .......q.S.r....
-00002d30: 7205 0000 0072 0800 0000 2902 7259 0000  r....r....).rY..
-00002d40: 0072 2d00 0000 7205 0000 0072 0d00 0000  .r-...r....r....
-00002d50: 720e 0000 0071 0100 0072 3200 0000 fa2a  r....q...r2....*
-00002d60: 6569 6765 6e73 7061 6365 732e 3c6c 6f63  eigenspaces.<loc
-00002d70: 616c 733e 2e3c 6c69 7374 636f 6d70 3e2e  als>.<listcomp>.
-00002d80: 3c6c 6973 7463 6f6d 703e 7205 0000 0072  <listcomp>r....r
-00002d90: 3400 0000 2902 7259 0000 00da 0769 6e64  4...).rY.....ind
-00002da0: 6963 6573 7252 0000 0072 0d00 0000 720e  icesrR...r....r.
-00002db0: 0000 0071 0100 0072 0f00 0000 6301 0000  ...q...r....c...
-00002dc0: 0000 0000 0000 0000 0001 0000 0005 0000  ................
-00002dd0: 0013 0000 0073 2600 0000 6700 7c00 5d0f  .....s&...g.|.].
-00002de0: 8900 8700 8701 6602 6400 6401 8408 7400  ......f.d.d...t.
-00002df0: 8801 6a01 8301 4400 8301 9102 7102 5300  ..j...D.....q.S.
-00002e00: 2902 6301 0000 0000 0000 0000 0000 0002  ).c.............
-00002e10: 0000 0005 0000 0013 0000 0072 3000 0000  ...........r0...
-00002e20: 7205 0000 0072 0500 0000 7257 0000 0029  r....r....rW...)
-00002e30: 0272 0a00 0000 da06 7669 6d61 6765 7205  .r......vimager.
-00002e40: 0000 0072 0d00 0000 720e 0000 007d 0100  ...r....r....}..
-00002e50: 0072 3200 0000 7265 0000 0029 0272 1500  .r2...re...).r..
-00002e60: 0000 723e 0000 0072 3400 0000 2901 7267  ..r>...r4...).rg
-00002e70: 0000 0029 0172 0a00 0000 720d 0000 0072  ...).r....r....r
-00002e80: 0e00 0000 7d01 0000 7302 0000 0026 0063  ....}...s....&.c
-00002e90: 0100 0000 0000 0000 0000 0000 0200 0000  ................
-00002ea0: 0400 0000 1300 0000 7314 0000 0067 007c  ........s....g.|
-00002eb0: 005d 067d 0188 007c 0119 0091 0271 0253  .].}...|.....q.S
-00002ec0: 0072 0500 0000 7205 0000 0072 0800 0000  .r....r....r....
-00002ed0: 2901 7261 0000 0072 0500 0000 720d 0000  ).ra...r....r...
-00002ee0: 0072 0e00 0000 8001 0000 7302 0000 0014  .r........s.....
-00002ef0: 004e 2911 7203 0000 0072 5c00 0000 7216  .N).r....r\...r.
-00002f00: 0000 00da 0361 6c6c 7215 0000 0072 3600  .....allr....r6.
-00002f10: 0000 7242 0000 0072 4e00 0000 723b 0000  ..rB...rN...r;..
-00002f20: 0072 3f00 0000 721a 0000 0072 4800 0000  .r?...r....rH...
-00002f30: 7217 0000 0072 4900 0000 724a 0000 0072  r....rI...rJ...r
-00002f40: 5e00 0000 7239 0000 0029 1672 4300 0000  ^...r9...).rC...
-00002f50: da07 666c 6174 7465 6e72 3800 0000 da05  ..flattenr8.....
-00002f60: 6368 6563 6b72 1d00 0000 721e 0000 0072  checkr....r....r
-00002f70: 4400 0000 7235 0000 00da 0b65 6967 656e  D...r5.....eigen
-00002f80: 7370 6163 6573 7229 0000 0072 2d00 0000  spacesr)...r-...
-00002f90: 724d 0000 0072 4c00 0000 5a0a 6469 6d5f  rM...rL...Z.dim_
-00002fa0: 6b65 726e 656c 5a12 6e5f 7a65 726f 5f65  kernelZ.n_zero_e
-00002fb0: 6967 656e 7661 6c75 6573 5a12 6569 6765  igenvaluesZ.eige
-00002fc0: 6e76 616c 7565 735f 7265 7375 6c74 5a13  nvalues_resultZ.
-00002fd0: 6569 6765 6e76 6563 746f 7273 5f72 6573  eigenvectors_res
-00002fe0: 756c 7472 2500 0000 da04 7370 616e 5a07  ultr%.....spanZ.
-00002ff0: 766b 6572 6e65 6c5a 0a6f 6e5f 7665 6374  vkernelZ.on_vect
-00003000: 6f72 735a 0e6f 6e5f 6569 6765 6e76 616c  orsZ.on_eigenval
-00003010: 7565 7372 0500 0000 2905 7261 0000 0072  uesr....).ra...r
-00003020: 5900 0000 7266 0000 0072 3800 0000 7267  Y...rf...r8...rg
-00003030: 0000 0072 0d00 0000 726b 0000 0020 0100  ...r....rk... ..
-00003040: 0073 5c00 0000 082b 1401 0803 0c01 0c01  .s\....+........
-00003050: 2601 0803 0e01 0401 0c01 2001 0e02 0201  &......... .....
-00003060: 0801 0cfb 0c06 0c02 0280 0402 1803 0801  ................
-00003070: 0a01 0801 0601 1802 2401 0a03 0801 1801  ........$.......
-00003080: 0802 0a01 0801 0a01 1801 0803 0c01 0801  ................
-00003090: 1801 1402 1e01 0601 0801 0a01 0a02 1001  ................
-000030a0: 0802 726b 0000 0063 0100 0000 0000 0000  ..rk...c........
-000030b0: 0000 0000 0700 0000 0800 0000 0b00 0000  ................
-000030c0: 73c6 0000 0074 007c 0066 0169 007c 01a4  s....t.|.f.i.|..
-000030d0: 018e 015c 027d 027d 0374 017c 0283 017d  ...\.}.}.t.|...}
-000030e0: 0474 02a0 0374 026a 047c 02a0 05a1 0074  .t...t.j.|.....t
-000030f0: 0664 018d 02a1 0189 0074 0764 027c 0483  .d.......t.d.|..
-00003100: 0244 005d 397d 0574 077c 047c 0518 0083  .D.]9}.t.|.|....
-00003110: 0144 005d 307d 067c 0689 017c 057c 0617  .D.]0}.|...|.|..
-00003120: 0089 027c 0288 0188 0266 0219 0074 0887  ...|.....f...t..
-00003130: 0087 0187 0266 0364 0364 0484 0874 0788  .....f.d.d...t..
-00003140: 0164 0217 0088 0283 0244 0083 0183 0118  .d.......D......
-00003150: 0088 0088 0188 0166 0219 0088 0088 0288  .......f........
-00003160: 0266 0219 0017 001b 0088 0088 0188 0266  .f.............f
-00003170: 023c 0071 2771 1f7c 0388 0010 007c 03a0  .<.q'q.|.....|..
-00003180: 09a1 00a0 0aa1 0010 0053 0029 0575 6301  .........S.).uc.
-00003190: 0000 0a20 2020 2041 206e 756d 6572 6963  ...    A numeric
-000031a0: 2061 6c67 6f72 6974 686d 2074 6f20 6f62   algorithm to ob
-000031b0: 7461 696e 2074 6865 2070 7269 6e63 6970  tain the princip
-000031c0: 616c 2073 7175 6172 6520 726f 6f74 206f  al square root o
-000031d0: 6620 6120 6d61 7472 6978 204d 2028 6966  f a matrix M (if
-000031e0: 2069 7420 6578 6973 7473 292e 0a20 2020   it exists)..   
-000031f0: 2054 6865 2070 7269 6e63 6970 616c 2073   The principal s
-00003200: 7175 6172 6520 6973 2074 6865 2075 6e69  quare is the uni
-00003210: 7175 6520 7371 7561 7265 2072 6f6f 7420  que square root 
-00003220: 6f66 2061 206d 6174 7269 7820 736f 2074  of a matrix so t
-00003230: 6861 7420 2d70 692f 3220 3c20 6172 6728  hat -pi/2 < arg(
-00003240: 6c28 5829 2920 3c3d 2070 692f 320a 2020  l(X)) <= pi/2.  
-00003250: 2020 686f 6c64 732c 2077 6865 7265 0a20    holds, where. 
-00003260: 2020 2049 7420 6361 6e20 6361 6e20 6265     It can can be
-00003270: 2065 7870 7265 7373 6564 2069 6e20 7465   expressed in te
-00003280: 726d 7320 6f66 2061 2070 6f6c 796e 6f6d  rms of a polynom
-00003290: 6961 6c20 696e 204d 2e0a 2020 2020 5265  ial in M..    Re
-000032a0: 6665 726e 6365 3a20 416b 6520 426a c3b6  fernce: Ake Bj..
-000032b0: 726b 3a20 4e75 6d65 7269 6361 6c20 4d65  rk: Numerical Me
-000032c0: 7468 6f64 7320 696e 204d 6174 7269 7820  thods in Matrix 
-000032d0: 436f 6d70 7574 6174 696f 6e73 2028 3230  Computations (20
-000032e0: 3134 292c 2073 6563 2e20 332e 382e 312e  14), sec. 3.8.1.
-000032f0: 0a20 2020 2029 01da 0564 7479 7065 7228  .    )...dtyper(
-00003300: 0000 0063 0100 0000 0000 0000 0000 0000  ...c............
-00003310: 0200 0000 0600 0000 1300 0000 7324 0000  ............s$..
-00003320: 0067 007c 005d 0e7d 0188 0088 017c 0166  .g.|.].}.....|.f
-00003330: 0219 0088 007c 0188 0266 0219 0014 0091  .....|...f......
-00003340: 0271 0253 0072 0500 0000 7205 0000 0072  .q.S.r....r....r
-00003350: 0800 0000 a903 da01 5372 2900 0000 722d  ........Sr)...r-
-00003360: 0000 0072 0500 0000 720d 0000 0072 0e00  ...r....r....r..
-00003370: 0000 9c01 0000 722f 0000 007a 2667 6574  ......r/...z&get
-00003380: 5f70 7269 6e63 6970 616c 5f73 7172 742e  _principal_sqrt.
-00003390: 3c6c 6f63 616c 733e 2e3c 6c69 7374 636f  <locals>.<listco
-000033a0: 6d70 3e29 0b72 0200 0000 7216 0000 0072  mp>).r....r....r
-000033b0: 1a00 0000 da04 6469 6167 7218 0000 00da  ......diagr.....
-000033c0: 0864 6961 676f 6e61 6c72 0400 0000 7215  .diagonalr....r.
-000033d0: 0000 0072 1400 0000 724a 0000 0072 0700  ...r....rJ...r..
-000033e0: 0000 2907 7243 0000 0072 1d00 0000 da01  ..).rC...r......
-000033f0: 54da 0151 7235 0000 0072 7100 0000 5a0e  T..Qr5...rq...Z.
-00003400: 6469 6167 6f6e 616c 5f69 6e64 6578 7205  diagonal_indexr.
-00003410: 0000 0072 6e00 0000 720d 0000 00da 1267  ...rn...r......g
-00003420: 6574 5f70 7269 6e63 6970 616c 5f73 7172  et_principal_sqr
-00003430: 748b 0100 0073 1400 0000 1408 0803 1801  t....s..........
-00003440: 0e01 1001 0401 0801 5201 02fd 1406 7274  ........R.....rt
-00003450: 0000 0063 0100 0000 0000 0000 0000 0000  ...c............
-00003460: 0300 0000 0400 0000 4300 0000 7328 0000  ........C...s(..
-00003470: 0074 007c 007c 00a0 01a1 0010 0083 017d  .t.|.|.........}
-00003480: 0174 026a 03a0 047c 01a1 017c 0010 007d  .t.j...|...|...}
-00003490: 027c 027c 0166 0253 0029 0161 0801 0000  .|.|.f.S.).a....
-000034a0: 0a20 2020 2049 6620 4d20 6973 2061 2063  .    If M is a c
-000034b0: 6f6d 706c 6578 206e 6f6e 2d73 696e 6775  omplex non-singu
-000034c0: 6c61 7220 7371 7561 7265 206d 6174 7269  lar square matri
-000034d0: 782c 2074 6869 7320 726f 7574 696e 6520  x, this routine 
-000034e0: 7769 6c6c 2061 7474 656d 7074 2074 6f20  will attempt to 
-000034f0: 6465 7465 726d 696e 6520 6120 6465 636f  determine a deco
-00003500: 6d70 6f73 6974 696f 6e20 0a20 2020 2020  mposition .     
-00003510: 2020 204d 203d 2047 4051 0a20 2020 2073     M = G@Q.    s
-00003520: 6f20 7468 6174 2047 2069 7320 636f 6d70  o that G is comp
-00003530: 6c65 7820 7379 6d6d 6574 7269 6320 616e  lex symmetric an
-00003540: 6420 5120 6973 2063 6f6d 706c 6578 206f  d Q is complex o
-00003550: 7274 686f 676f 6e61 6c2e 0a20 2020 2053  rthogonal..    S
-00003560: 6565 2054 686d 2e20 362e 342e 3136 2069  ee Thm. 6.4.16 i
-00003570: 6e20 486f 726e 2026 204a 6f68 6e73 6f6e  n Horn & Johnson
-00003580: 3a20 546f 7069 6373 2069 6e20 4d61 7472  : Topics in Matr
-00003590: 6978 2041 6e61 6c79 7369 7320 2831 3939  ix Analysis (199
-000035a0: 3129 2e0a 2020 2020 2905 7274 0000 0072  1)..    ).rt...r
-000035b0: 4a00 0000 721a 0000 0072 5b00 0000 da03  J...r....r[.....
-000035c0: 696e 7629 0372 4300 0000 da01 4772 7300  inv).rC.....Grs.
-000035d0: 0000 7205 0000 0072 0500 0000 720d 0000  ..r....r....r...
-000035e0: 00da 1e63 6f72 7468 6f5f 7379 6d6d 6574  ...cortho_symmet
-000035f0: 7269 635f 6465 636f 6d70 6f73 6974 696f  ric_decompositio
-00003600: 6ea2 0100 0073 0600 0000 1007 1001 0805  n....s..........
-00003610: 7277 0000 0029 0172 0400 0000 2902 7204  rw...).r....).r.
-00003620: 0000 0072 2000 0000 2902 4e72 3a00 0000  ...r ...).Nr:...
-00003630: 2901 4629 0346 723a 0000 0054 2911 7212  ).F).Fr:...T).r.
-00003640: 0000 0072 1a00 0000 7211 0000 0072 1700  ...r....r....r..
-00003650: 0000 da0c 7363 6970 792e 6c69 6e61 6c67  ....scipy.linalg
-00003660: 7202 0000 00da 0e6e 6a65 742e 6675 6e63  r......njet.func
-00003670: 7469 6f6e 7372 0300 0000 721f 0000 0072  tionsr....r....r
-00003680: 3900 0000 7246 0000 0072 4e00 0000 7255  9...rF...rN...rU
-00003690: 0000 0072 5c00 0000 726b 0000 0072 7400  ...r\...rk...rt.
-000036a0: 0000 7277 0000 0072 0500 0000 7205 0000  ..rw...r....r...
-000036b0: 0072 0500 0000 720d 0000 00da 083c 6d6f  .r....r......<mo
-000036c0: 6475 6c65 3e01 0000 0073 1a00 0000 0803  dule>....s......
-000036d0: 0801 0c01 0c02 0a02 0a0f 0a2b 0855 0e35  ...........+.U.5
-000036e0: 0a2b 0a27 086b 0c17                      .+.'.k..
+00000080: 9c01 6411 6412 8402 5a0c 6423 6413 6414  ..d.d...Z.d#d.d.
+00000090: 8401 5a0d 6424 6416 6417 8401 5a0e 6418  ..Z.d$d.d...Z.d.
+000000a0: 6419 8400 5a0f 641a 641b 8400 5a10 6425  d...Z.d.d...Z.d%
+000000b0: 641e 641f 8401 5a11 6401 5300 2926 e900  d.d...Z.d.S.)&..
+000000c0: 0000 004e 2901 da05 7363 6875 7229 01da  ...N)...schur)..
+000000d0: 1067 6574 5f70 6163 6b61 6765 5f6e 616d  .get_package_nam
+000000e0: 65da 0763 6f6d 706c 6578 6302 0000 0000  e..complexc.....
+000000f0: 0000 0000 0000 0005 0000 0005 0000 000b  ................
+00000100: 0000 0073 8200 0000 7c01 6401 6b02 7214  ...s....|.d.k.r.
+00000110: 7400 8700 6601 6402 6403 8408 7401 7402  t...f.d.d...t.t.
+00000120: 8800 8301 8301 4400 8301 8301 7d03 6e0f  ......D.....}.n.
+00000130: 7400 8700 6601 6404 6403 8408 7401 7402  t...f.d.d...t.t.
+00000140: 8800 8301 8301 4400 8301 8301 7d03 7403  ......D.....}.t.
+00000150: 7c03 8301 7d04 7c04 6405 6b02 7233 7404  |...}.|.d.k.r3t.
+00000160: a005 7404 a006 7c03 a101 a101 5300 7c04  ..t...|.....S.|.
+00000170: 6406 7600 723f 7407 a005 7407 a008 7c03  d.v.r?t...t...|.
+00000180: a101 a101 5300 6400 5300 2907 4e72 0400  ....S.d.S.).Nr..
+00000190: 0000 6301 0000 0000 0000 0000 0000 0002  ..c.............
+000001a0: 0000 0005 0000 0013 0000 0073 2000 0000  ...........s ...
+000001b0: 6700 7c00 5d0c 7d01 8800 7c01 1900 a000  g.|.].}...|.....
+000001c0: a100 8800 7c01 1900 1400 9102 7102 5300  ....|.......q.S.
+000001d0: a900 a901 da09 636f 6e6a 7567 6174 65a9  ......conjugate.
+000001e0: 02da 022e 30da 016b a901 da06 7665 6374  ....0..k....vect
+000001f0: 6f72 7205 0000 00fa 552f 686f 6d65 2f6d  orr.....U/home/m
+00000200: 616c 7465 2f6d 696e 6963 6f6e 6461 332f  alte/miniconda3/
+00000210: 656e 7673 2f77 6f72 6b2f 6c69 622f 7079  envs/work/lib/py
+00000220: 7468 6f6e 332e 3130 2f73 6974 652d 7061  thon3.10/site-pa
+00000230: 636b 6167 6573 2f6c 6965 6f70 732f 6c69  ckages/lieops/li
+00000240: 6e61 6c67 2f63 6f6d 6d6f 6e2e 7079 da0a  nalg/common.py..
+00000250: 3c6c 6973 7463 6f6d 703e 0e00 0000 f302  <listcomp>......
+00000260: 0000 0020 007a 1b74 776f 6e6f 726d 2e3c  ... .z.twonorm.<
+00000270: 6c6f 6361 6c73 3e2e 3c6c 6973 7463 6f6d  locals>.<listcom
+00000280: 703e 6301 0000 0000 0000 0000 0000 0002  p>c.............
+00000290: 0000 0005 0000 0013 0000 0073 1c00 0000  ...........s....
+000002a0: 6700 7c00 5d0a 7d01 8800 7c01 1900 8800  g.|.].}...|.....
+000002b0: 7c01 1900 1400 9102 7102 5300 7205 0000  |.......q.S.r...
+000002c0: 0072 0500 0000 7208 0000 0072 0b00 0000  .r....r....r....
+000002d0: 7205 0000 0072 0d00 0000 720e 0000 0010  r....r....r.....
+000002e0: 0000 00f3 0200 0000 1c00 da06 6d70 6d61  ............mpma
+000002f0: 7468 2902 da05 6e75 6d70 79da 0862 7569  th)...numpy..bui
+00000300: 6c74 696e 7329 09da 0373 756d da05 7261  ltins)...sum..ra
+00000310: 6e67 65da 036c 656e 7203 0000 00da 026d  nge..lenr......m
+00000320: 70da 0473 7172 74da 0272 65da 026e 70da  p..sqrt..re..np.
+00000330: 0472 6561 6c29 0572 0c00 0000 da04 6d6f  .real).r......mo
+00000340: 6465 da06 6b77 6172 6773 da04 7375 6d32  de..kwargs..sum2
+00000350: da04 636f 6465 7205 0000 0072 0b00 0000  ..coder....r....
+00000360: 720d 0000 00da 0774 776f 6e6f 726d 0a00  r......twonorm..
+00000370: 0000 7312 0000 0008 0320 011e 0208 0208  ..s...... ......
+00000380: 0210 0108 0110 0104 ff72 2000 0000 e716  .........r .....
+00000390: 56e7 9eaf 03d2 3c63 0300 0000 0000 0000  V.....<c........
+000003a0: 0000 0000 0800 0000 0a00 0000 0b00 0000  ................
+000003b0: 7374 0100 0074 0088 0683 017d 0474 0088  st...t.....}.t..
+000003c0: 0664 0119 0083 0189 0074 0188 0664 0119  .d.......t...d..
+000003d0: 0066 0164 027c 0169 017c 03a4 018e 0189  .f.d.|.i.|......
+000003e0: 0387 0387 0666 0264 0364 0484 0874 0288  .....f.d.d...t..
+000003f0: 0083 0144 0083 0189 0474 0264 057c 0483  ...D.....t.d.|..
+00000400: 0244 005d 8689 0187 0187 0666 0264 0664  .D.].......f.d.d
+00000410: 0484 0874 0288 0083 0144 0083 0189 0574  ...t.....D.....t
+00000420: 0288 0183 0144 005d 3e89 027c 0164 076b  .....D.]>..|.d.k
+00000430: 0272 5074 0387 0187 0287 0487 0666 0464  .rPt.........f.d
+00000440: 0864 0984 0874 0288 0083 0144 0083 0183  .d...t.....D....
+00000450: 017d 056e 1074 0387 0187 0287 0487 0666  .}.n.t.........f
+00000460: 0464 0a64 0984 0874 0288 0083 0144 0083  .d.d...t.....D..
+00000470: 0183 017d 0574 0288 0083 0144 005d 127d  ...}.t.....D.].}
+00000480: 0688 057c 0688 0166 0205 0019 007c 0588  ...|...f.....|..
+00000490: 047c 0688 0266 0219 0014 0038 0003 003c  .|...f.....8...<
+000004a0: 0071 6471 3974 0187 0187 0566 0264 0b64  .qdq9t.....f.d.d
+000004b0: 0984 0874 0288 0083 0144 0083 0166 0164  ...t.....D...f.d
+000004c0: 027c 0169 017c 03a4 018e 017d 0774 047c  .|.i.|.....}.t.|
+000004d0: 0783 017c 026b 0072 9a74 0564 0c7c 019b  ...|.k.r.t.d.|..
+000004e0: 0064 0d9d 0383 0182 0174 0288 0083 0144  .d.......t.....D
+000004f0: 005d 0e7d 0688 057c 0688 0166 0219 007c  .].}...|...f...|
+00000500: 071b 0088 047c 0688 0166 023c 0071 9e71  .....|...f.<.q.q
+00000510: 2787 0087 0466 0264 0e64 0984 0874 027c  '....f.d.d...t.|
+00000520: 0483 0144 0083 0153 0029 0f61 8a02 0000  ...D...S.).a....
+00000530: 4772 616d 2d53 6368 6d69 6474 206f 7274  Gram-Schmidt ort
+00000540: 686f 676f 6e61 6c69 7a61 7469 6f6e 2070  hogonalization p
+00000550: 726f 6365 6475 7265 206f 6620 6c69 6e61  rocedure of lina
+00000560: 726c 7920 696e 6465 7065 6e64 656e 7420  rly independent 
+00000570: 7665 6374 6f72 7320 7769 7468 2063 6f6d  vectors with com
+00000580: 706c 6578 2065 6e74 7269 6573 2c20 692e  plex entries, i.
+00000590: 652e 0a20 2020 2027 756e 6974 6172 697a  e..    'unitariz
+000005a0: 6174 696f 6e27 2e0a 2020 2020 0a20 2020  ation'..    .   
+000005b0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+000005c0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2076  ----------.    v
+000005d0: 6563 746f 7273 3a20 6c69 7374 0a20 2020  ectors: list.   
+000005e0: 2020 2020 206c 6973 7420 6f66 2076 6563       list of vec
+000005f0: 746f 7273 2074 6f20 6265 206f 7274 686f  tors to be ortho
+00000600: 676f 6e61 6c69 7a65 642e 0a20 2020 2020  gonalized..     
+00000610: 2020 200a 2020 2020 6d6f 6465 3a20 7374     .    mode: st
+00000620: 722c 206f 7074 696f 6e61 6c0a 2020 2020  r, optional.    
+00000630: 2020 2020 4966 206d 6f64 6520 3d3d 2027      If mode == '
+00000640: 636f 6d70 6c65 7827 2028 6465 6661 756c  complex' (defaul
+00000650: 7429 2c20 7468 656e 2061 6c6c 206e 6f72  t), then all nor
+00000660: 6d73 2061 6e64 2073 6361 6c61 7220 7072  ms and scalar pr
+00000670: 6f64 7563 7473 2061 7265 2063 6f6d 7075  oducts are compu
+00000680: 7465 6420 7573 696e 6720 636f 6e6a 7567  ted using conjug
+00000690: 6174 696f 6e2e 0a20 2020 2020 2020 200a  ation..        .
+000006a0: 2020 2020 2a2a 6b77 6172 6773 200a 2020      **kwargs .  
+000006b0: 2020 2020 2020 4164 6469 7469 6f6e 616c        Additional
+000006c0: 2061 7267 756d 656e 7473 2070 6173 7365   arguments passe
+000006d0: 6420 746f 202e 7477 6f6e 6f72 6d0a 2020  d to .twonorm.  
+000006e0: 2020 0a20 2020 2052 6574 7572 6e73 0a20    .    Returns. 
+000006f0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 206c     -------.    l
+00000700: 6973 740a 2020 2020 2020 2020 6c69 7374  ist.        list
+00000710: 206f 6620 6c65 6e67 7468 206c 656e 2876   of length len(v
+00000720: 6563 746f 7273 2920 7768 6963 6820 6172  ectors) which ar
+00000730: 6520 6d75 7475 616c 6c79 2075 6e69 7461  e mutually unita
+00000740: 7279 2e20 492e 652e 0a20 2020 2020 2020  ry. I.e..       
+00000750: 2077 6974 6820 4f20 3a3d 206e 702e 6172   with O := np.ar
+00000760: 7261 7928 6c69 7374 292e 5420 6974 2068  ray(list).T it h
+00000770: 6f6c 6473 204f 5e48 404f 203d 2031 2c20  olds O^H@O = 1, 
+00000780: 7768 6572 6520 5e48 206d 6561 6e73 2074  where ^H means t
+00000790: 7261 6e73 706f 7369 7469 6f6e 2061 6e64  ransposition and
+000007a0: 2063 6f6d 706c 6578 2063 6f6e 6a75 6761   complex conjuga
+000007b0: 7469 6f6e 2e0a 2020 2020 7201 0000 0072  tion..    r....r
+000007c0: 1c00 0000 6301 0000 0000 0000 0000 0000  ....c...........
+000007d0: 0002 0000 0005 0000 0013 0000 0073 2200  .............s".
+000007e0: 0000 6900 7c00 5d0d 7d01 7c01 6400 6602  ..i.|.].}.|.d.f.
+000007f0: 8801 6400 1900 7c01 1900 8800 1b00 9302  ..d...|.........
+00000800: 7102 5300 a901 7201 0000 0072 0500 0000  q.S...r....r....
+00000810: a902 7209 0000 00da 016d 2902 da06 6e6f  ..r......m)...no
+00000820: 726d 5f30 da07 7665 6374 6f72 7372 0500  rm_0..vectorsr..
+00000830: 0000 720d 0000 00da 0a3c 6469 6374 636f  ..r......<dictco
+00000840: 6d70 3e31 0000 00f3 0200 0000 2200 7a20  mp>1........".z 
+00000850: 6772 616d 5f73 6368 6d69 6474 2e3c 6c6f  gram_schmidt.<lo
+00000860: 6361 6c73 3e2e 3c64 6963 7463 6f6d 703e  cals>.<dictcomp>
+00000870: e901 0000 0063 0100 0000 0000 0000 0000  .....c..........
+00000880: 0000 0200 0000 0500 0000 1300 0000 731e  ..............s.
+00000890: 0000 0069 007c 005d 0b7d 017c 0188 0066  ...i.|.].}.|...f
+000008a0: 0288 0188 0019 007c 0119 0093 0271 0253  .......|.....q.S
+000008b0: 0072 0500 0000 7205 0000 0072 2300 0000  .r....r....r#...
+000008c0: 2902 da01 6972 2600 0000 7205 0000 0072  )...ir&...r....r
+000008d0: 0d00 0000 7227 0000 0033 0000 0073 0200  ....r'...3...s..
+000008e0: 0000 1e00 7204 0000 0063 0100 0000 0000  ....r....c......
+000008f0: 0000 0000 0000 0200 0000 0500 0000 1300  ................
+00000900: 0000 7328 0000 0067 007c 005d 107d 0188  ..s(...g.|.].}..
+00000910: 027c 0188 0166 0219 00a0 00a1 0088 0388  .|...f..........
+00000920: 0019 007c 0119 0014 0091 0271 0253 0072  ...|.......q.S.r
+00000930: 0500 0000 7206 0000 00a9 0272 0900 0000  ....r......r....
+00000940: da01 72a9 0472 2a00 0000 da01 6ada 056f  ..r..r*.....j..o
+00000950: 7274 686f 7226 0000 0072 0500 0000 720d  rthor&...r....r.
+00000960: 0000 0072 0e00 0000 3600 0000 7302 0000  ...r....6...s...
+00000970: 0028 007a 2067 7261 6d5f 7363 686d 6964  .(.z gram_schmid
+00000980: 742e 3c6c 6f63 616c 733e 2e3c 6c69 7374  t.<locals>.<list
+00000990: 636f 6d70 3e63 0100 0000 0000 0000 0000  comp>c..........
+000009a0: 0000 0200 0000 0500 0000 1300 0000 7324  ..............s$
+000009b0: 0000 0067 007c 005d 0e7d 0188 027c 0188  ...g.|.].}...|..
+000009c0: 0166 0219 0088 0388 0019 007c 0119 0014  .f.........|....
+000009d0: 0091 0271 0253 0072 0500 0000 7205 0000  ...q.S.r....r...
+000009e0: 0072 2b00 0000 722d 0000 0072 0500 0000  .r+...r-...r....
+000009f0: 720d 0000 0072 0e00 0000 3800 0000 f302  r....r....8.....
+00000a00: 0000 0024 0063 0100 0000 0000 0000 0000  ...$.c..........
+00000a10: 0000 0200 0000 0500 0000 1300 0000 f318  ................
+00000a20: 0000 0067 007c 005d 087d 0188 017c 0188  ...g.|.].}...|..
+00000a30: 0066 0219 0091 0271 0253 0072 0500 0000  .f.....q.S.r....
+00000a40: 7205 0000 0072 2300 0000 2902 722a 0000  r....r#...).r*..
+00000a50: 00da 0473 756d 3172 0500 0000 720d 0000  ...sum1r....r...
+00000a60: 0072 0e00 0000 3c00 0000 f302 0000 0018  .r....<.........
+00000a70: 007a 1c44 6976 6973 696f 6e20 6279 207a  .z.Division by z
+00000a80: 6572 6f20 7769 7468 206d 6f64 6520 287a  ero with mode (z
+00000a90: 3429 2065 6e63 6f75 6e74 6572 6564 3b20  4) encountered; 
+00000aa0: 6368 6563 6b20 696e 7075 7420 6f6e 206c  check input on l
+00000ab0: 696e 6561 726c 7920 696e 6465 7065 6e64  inearly independ
+00000ac0: 656e 6365 2e63 0100 0000 0000 0000 0000  ence.c..........
+00000ad0: 0000 0100 0000 0500 0000 1300 0000 7324  ..............s$
+00000ae0: 0000 0067 007c 005d 0e89 0087 0087 0266  ...g.|.].......f
+00000af0: 0264 0064 0184 0874 0088 0183 0144 0083  .d.d...t.....D..
+00000b00: 0191 0271 0253 0029 0263 0100 0000 0000  ...q.S.).c......
+00000b10: 0000 0000 0000 0200 0000 0500 0000 1300  ................
+00000b20: 0000 7231 0000 0072 0500 0000 7205 0000  ..r1...r....r...
+00000b30: 0072 2300 0000 2902 722a 0000 0072 2f00  .r#...).r*...r/.
+00000b40: 0000 7205 0000 0072 0d00 0000 720e 0000  ..r....r....r...
+00000b50: 0041 0000 0072 3300 0000 7a2b 6772 616d  .A...r3...z+gram
+00000b60: 5f73 6368 6d69 6474 2e3c 6c6f 6361 6c73  _schmidt.<locals
+00000b70: 3e2e 3c6c 6973 7463 6f6d 703e 2e3c 6c69  >.<listcomp>.<li
+00000b80: 7374 636f 6d70 3ea9 0172 1500 0000 a901  stcomp>..r......
+00000b90: 7209 0000 0029 02da 0364 696d 722f 0000  r....)...dimr/..
+00000ba0: 0029 0172 2a00 0000 720d 0000 0072 0e00  .).r*...r....r..
+00000bb0: 0000 4100 0000 7230 0000 0029 0672 1600  ..A...r0...).r..
+00000bc0: 0000 7220 0000 0072 1500 0000 7214 0000  ..r ...r....r...
+00000bd0: 00da 0361 6273 da0c 5275 6e74 696d 6545  ...abs..RuntimeE
+00000be0: 7272 6f72 2908 7226 0000 0072 1c00 0000  rror).r&...r....
+00000bf0: da03 746f 6c72 1d00 0000 720a 0000 00da  ..tolr....r.....
+00000c00: 1173 6361 6c61 725f 7072 6f64 7563 745f  .scalar_product_
+00000c10: 696a 7224 0000 00da 066e 6f72 6d5f 6972  ijr$.....norm_ir
+00000c20: 0500 0000 2907 7236 0000 0072 2a00 0000  ....).r6...r*...
+00000c30: 722e 0000 0072 2500 0000 722f 0000 0072  r....r%...r/...r
+00000c40: 3200 0000 7226 0000 0072 0d00 0000 da0c  2...r&...r......
+00000c50: 6772 616d 5f73 6368 6d69 6474 1900 0000  gram_schmidt....
+00000c60: 7328 0000 0008 150c 0118 0118 010e 0118  s(..............
+00000c70: 010c 0108 0122 0120 020c 0222 0102 ff28  .....". ..."...(
+00000c80: 020c 0110 010c 011a 0102 ff18 0272 3c00  .............r<.
+00000c90: 0000 e7bb bdd7 d9df 7cdb 3d63 0300 0000  ........|.=c....
+00000ca0: 0000 0000 0000 0000 0e00 0000 0800 0000  ................
+00000cb0: 4b00 0000 7386 0200 0074 007c 0083 017d  K...s....t.|...}
+00000cc0: 047c 0464 016b 0272 267c 006a 015c 027d  .|.d.k.r&|.j.\.}
+00000cd0: 057d 067c 0164 026b 0272 1674 02a0 037c  .}.|.d.k.r.t...|
+00000ce0: 05a1 017d 017c 016a 0164 0319 007c 056b  ...}.|.j.d...|.k
+00000cf0: 0273 1f4a 0082 0174 02a0 047c 007c 0167  .s.J...t...|.|.g
+00000d00: 02a1 017d 077c 0464 046b 0272 5e7c 006a  ...}.|.d.k.r^|.j
+00000d10: 057c 006a 0602 027d 057d 067c 0164 026b  .|.j...}.}.|.d.k
+00000d20: 0272 3a74 07a0 037c 05a1 017d 017c 016a  .r:t...|...}.|.j
+00000d30: 057c 056b 0273 414a 0082 0174 07a0 087c  .|.k.sAJ...t...|
+00000d40: 057c 067c 016a 0617 00a1 027d 077c 007c  .|.|.j.....}.|.|
+00000d50: 0764 0264 0285 0264 027c 0685 0266 023c  .d.d...d.|...f.<
+00000d60: 007c 017c 0764 0264 0285 027c 0664 0285  .|.|.d.d...|.d..
+00000d70: 0266 023c 0064 037d 0867 007d 0974 097c  .f.<.d.}.g.}.t.|
+00000d80: 0683 0144 005d c77d 0a64 057d 0b74 097c  ...D.].}.d.}.t.|
+00000d90: 087c 0583 0244 005d 817d 0c74 0a7c 077c  .|...D.].}.t.|.|
+00000da0: 0c7c 0a66 0219 0083 017c 026b 0072 7c71  .|.f.....|.k.r|q
+00000db0: 6f7c 0c7c 086b 0472 d37c 0464 016b 0272  o|.|.k.r.|.d.k.r
+00000dc0: a774 02a0 0b7c 077c 0864 0264 0285 0266  .t...|.|.d.d...f
+00000dd0: 0219 00a1 017d 0d74 02a0 0b7c 077c 0c64  .....}.t...|.|.d
+00000de0: 0264 0285 0266 0219 00a1 017c 077c 0c7c  .d...f.....|.|.|
+00000df0: 0a66 0219 001b 007c 077c 0864 0264 0285  .f.....|.|.d.d..
+00000e00: 0266 023c 006e 247c 0464 046b 0272 cb7c  .f.<.n$|.d.k.r.|
+00000e10: 077c 0864 0264 0285 0266 0219 00a0 0ba1  .|.d.d...f......
+00000e20: 007d 0d7c 077c 0c64 0264 0285 0266 0219  .}.|.|.d.d...f..
+00000e30: 00a0 0ba1 007c 077c 0c7c 0a66 0219 001b  .....|.|.|.f....
+00000e40: 007c 077c 0864 0264 0285 0266 023c 007c  .|.|.d.d...f.<.|
+00000e50: 0d7c 077c 0c64 0264 0285 0266 023c 007c  .|.|.d.d...f.<.|
+00000e60: 077c 0864 0264 0285 0266 0219 007c 077c  .|.d.d...f...|.|
+00000e70: 087c 0a66 0219 001b 007c 077c 0864 0264  .|.f.....|.|.d.d
+00000e80: 0285 0266 023c 007c 09a0 0c7c 087c 0a66  ...f.<.|...|.|.f
+00000e90: 02a1 0101 0064 067d 0b01 007c 0b73 f471  .....d.}...|.s.q
+00000ea0: 6674 0964 037c 0583 0244 005d 2f7d 0c74  ft.d.|...D.]/}.t
+00000eb0: 0a7c 077c 0c7c 0a66 0219 0083 017c 026b  .|.|.|.f.....|.k
+00000ec0: 0090 0173 0b7c 0c7c 086b 0290 0172 0c71  ...s.|.|.k...r.q
+00000ed0: f97c 077c 0c64 0264 0285 0266 0219 007c  .|.|.d.d...f...|
+00000ee0: 077c 0c7c 0a66 0219 007c 077c 0864 0264  .|.|.f...|.|.d.d
+00000ef0: 0285 0266 0219 0014 0018 007c 077c 0c64  ...f.......|.|.d
+00000f00: 0264 0285 0266 023c 0071 f97c 0864 0717  .d...f.<.q.|.d..
+00000f10: 007d 0871 667c 0764 0264 0285 0264 027c  .}.qf|.d.d...d.|
+00000f20: 0685 0266 0219 007c 0764 0264 0285 027c  ...f...|.d.d...|
+00000f30: 0664 0285 0266 0219 007c 0966 0353 0029  .d...f...|.f.S.)
+00000f40: 0861 b502 0000 0a20 2020 2043 6f6d 7075  .a.....    Compu
+00000f50: 7465 2074 6865 2072 6564 7563 6564 2072  te the reduced r
+00000f60: 6f77 2065 6368 656c 6f6e 2066 6f72 6d20  ow echelon form 
+00000f70: 6f66 204d 2028 4d20 6361 6e20 6265 2061  of M (M can be a
+00000f80: 2072 6561 6c20 6f72 2063 6f6d 706c 6578   real or complex
+00000f90: 206d 6174 7269 7829 2e0a 2020 2020 0a20   matrix)..    . 
+00000fa0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00000fb0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00000fc0: 204d 3a20 6d61 7472 6978 0a20 2020 2020   M: matrix.     
+00000fd0: 2020 206d 6174 7269 7820 746f 2062 6520     matrix to be 
+00000fe0: 7472 616e 7366 6f72 6d65 642e 0a20 2020  transformed..   
+00000ff0: 2020 2020 200a 2020 2020 6175 676d 656e       .    augmen
+00001000: 743a 206d 6174 7269 782c 206f 7074 696f  t: matrix, optio
+00001010: 6e61 6c0a 2020 2020 2020 2020 6f70 7469  nal.        opti
+00001020: 6f6e 616c 206d 6174 7269 7820 746f 2062  onal matrix to b
+00001030: 6520 7573 6564 206f 6e20 7468 6520 7269  e used on the ri
+00001040: 6768 742d 6861 6e64 2073 6964 6520 6f66  ght-hand side of
+00001050: 204d 2c20 616e 6420 7768 6963 6820 7769   M, and which wi
+00001060: 6c6c 2062 6520 7369 6d75 6c74 616e 656f  ll be simultaneo
+00001070: 7573 6c79 2074 7261 6e73 666f 726d 6564  usly transformed
+00001080: 2e0a 2020 2020 2020 2020 4966 206e 6f74  ..        If not
+00001090: 6869 6e67 2073 7065 6369 6669 6564 2c20  hing specified, 
+000010a0: 7468 6520 6964 656e 7469 7479 206d 6174  the identity mat
+000010b0: 7269 7820 7769 6c6c 2062 6520 7573 6564  rix will be used
+000010c0: 2e0a 2020 2020 2020 2020 0a20 2020 2074  ..        .    t
+000010d0: 6f6c 3a20 666c 6f61 742c 206f 7074 696f  ol: float, optio
+000010e0: 6e61 6c0a 2020 2020 2020 2020 4120 746f  nal.        A to
+000010f0: 6c65 7261 6e63 6520 6279 2077 6869 6368  lerance by which
+00001100: 2077 6520 6964 656e 7469 6679 2073 6d61   we identify sma
+00001110: 6c6c 206e 756d 6265 7273 2061 7320 7a65  ll numbers as ze
+00001120: 726f 2e0a 2020 2020 0a20 2020 2052 6574  ro..    .    Ret
+00001130: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
+00001140: 0a20 2020 2074 7269 706c 650a 2020 2020  .    triple.    
+00001150: 2020 2020 4120 7472 6970 6c65 2063 6f6e      A triple con
+00001160: 7369 7374 696e 6720 6f66 2069 2920 7468  sisting of i) th
+00001170: 6520 7472 616e 7366 6f72 6d65 6420 6d61  e transformed ma
+00001180: 7472 6978 204d 2c20 6969 2920 7468 6520  trix M, ii) the 
+00001190: 7472 616e 7366 6f72 6d65 6420 6175 676d  transformed augm
+000011a0: 656e 7420 616e 6420 6969 6929 2074 6865  ent and iii) the
+000011b0: 2070 6976 6f74 2069 6e64 6963 6573 0a20   pivot indices. 
+000011c0: 2020 2020 2020 206f 6620 7468 6520 7472         of the tr
+000011d0: 616e 7366 6f72 6d65 6420 6d61 7472 6978  ansformed matrix
+000011e0: 204d 2028 6120 6c69 7374 206f 6620 7475   M (a list of tu
+000011f0: 706c 6573 292e 0a20 2020 2072 1200 0000  ples)..    r....
+00001200: 4e72 0100 0000 7211 0000 0046 5472 2900  Nr....r....FTr).
+00001210: 0000 290d 7203 0000 00da 0573 6861 7065  ..).r......shape
+00001220: 721a 0000 00da 0365 7965 da04 626d 6174  r......eye..bmat
+00001230: da04 726f 7773 da04 636f 6c73 7217 0000  ..rows..colsr...
+00001240: 00da 057a 6572 6f73 7215 0000 0072 3700  ...zerosr....r7.
+00001250: 0000 da04 636f 7079 da06 6170 7065 6e64  ....copy..append
+00001260: 290e da01 4dda 0761 7567 6d65 6e74 7239  )...M..augmentr9
+00001270: 0000 0072 1d00 0000 721f 0000 00da 016e  ...r....r......n
+00001280: 7224 0000 00da 044d 6f6e 65da 0f70 6976  r$.....Mone..piv
+00001290: 6f74 5f72 6f77 5f69 6e64 6578 da0d 7069  ot_row_index..pi
+000012a0: 766f 745f 696e 6469 6365 7372 2e00 0000  vot_indicesr....
+000012b0: da12 636f 6c75 6d6e 5f6a 5f68 6173 5f70  ..column_j_has_p
+000012c0: 6976 6f74 720a 0000 00da 0970 6976 6f74  ivotr......pivot
+000012d0: 5f72 6f77 7205 0000 0072 0500 0000 720d  _rowr....r....r.
+000012e0: 0000 00da 0472 7265 6644 0000 0073 5400  .....rrefD...sT.
+000012f0: 0000 0816 0802 0a01 0801 0a01 1201 0e01  ................
+00001300: 0802 0e01 0801 0a01 0e01 1201 1401 1401  ................
+00001310: 0403 0401 0c01 0403 0e01 1402 0201 0802  ................
+00001320: 0802 1601 3001 0801 1401 2c01 1001 2803  ....0.....,...(.
+00001330: 0e02 0401 0201 0402 0203 0e03 2001 0201  ............ ...
+00001340: 3a01 0a02 2a02 724e 0000 0063 0100 0000  :...*.rN...c....
+00001350: 0000 0000 0000 0000 0900 0000 0400 0000  ................
+00001360: 4b00 0000 732a 0100 0074 007c 0083 017d  K...s*...t.|...}
+00001370: 027c 0264 016b 0272 0d74 01a0 027c 00a1  .|.d.k.r.t...|..
+00001380: 017d 007c 0264 026b 0272 1674 03a0 047c  .}.|.d.k.r.t...|
+00001390: 00a1 017d 0074 057c 00a0 06a1 0066 0169  ...}.t.|.....f.i
+000013a0: 007c 01a4 018e 015c 037d 037d 047d 0574  .|.....\.}.}.}.t
+000013b0: 077c 0583 0164 036b 0272 4d7c 0264 016b  .|...d.k.rM|.d.k
+000013c0: 0272 3c74 01a0 087c 006a 0964 0419 00a1  .r<t...|.j.d....
+000013d0: 017d 0674 01a0 0467 0067 01a1 017d 076e  .}.t...g.g...}.n
+000013e0: 317c 0264 026b 0272 4c74 03a0 087c 006a  1|.d.k.rLt...|.j
+000013f0: 0aa1 017d 0674 03a0 0467 0067 01a1 017d  ...}.t...g.g...}
+00001400: 076e 207c 0564 0519 0064 0319 0064 0417  .n |.d...d...d..
+00001410: 007d 087c 047c 0864 0685 0264 0664 0685  .}.|.|.d...d.d..
+00001420: 0266 0219 00a0 06a1 007d 067c 0364 067c  .f.......}.|.d.|
+00001430: 0885 0264 0664 0685 0266 0219 00a0 06a1  ...d.d...f......
+00001440: 007d 077c 0264 016b 0272 827c 066a 0964  .}.|.d.k.r.|.j.d
+00001450: 0419 007c 076a 0964 0419 0017 007c 006a  ...|.j.d.....|.j
+00001460: 0964 0419 006b 0273 824a 0082 017c 0264  .d...k.s.J...|.d
+00001470: 026b 0272 917c 066a 0a7c 076a 0a17 007c  .k.r.|.j.|.j...|
+00001480: 006a 0a6b 0273 914a 0082 017c 077c 0666  .j.k.s.J...|.|.f
+00001490: 0253 0029 0761 8901 0000 0a20 2020 204f  .S.).a.....    O
+000014a0: 6274 6169 6e20 6120 6261 7369 7320 666f  btain a basis fo
+000014b0: 7220 7468 6520 696d 6167 6520 616e 6420  r the image and 
+000014c0: 7468 6520 6b65 726e 656c 206f 6620 4d2e  the kernel of M.
+000014d0: 0a20 2020 204d 2063 616e 2062 6520 6120  .    M can be a 
+000014e0: 7265 616c 206f 7220 636f 6d70 6c65 7820  real or complex 
+000014f0: 6d61 7472 6978 2e0a 2020 2020 0a20 2020  matrix..    .   
+00001500: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00001510: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 204d  ----------.    M
+00001520: 3a0a 2020 2020 2020 2020 6d61 7472 6978  :.        matrix
+00001530: 2074 6f20 6265 2061 6e61 6c79 7a65 642e   to be analyzed.
+00001540: 0a20 2020 2020 2020 200a 2020 2020 2a2a  .        .    **
+00001550: 6b77 6172 6773 0a20 2020 2020 2020 2041  kwargs.        A
+00001560: 6464 6974 696f 6e61 6c20 6172 6775 6d65  dditional argume
+00001570: 6e74 7320 7061 7373 6564 2074 6f20 7272  nts passed to rr
+00001580: 6566 2072 6f75 7469 6e65 2e0a 2020 2020  ef routine..    
+00001590: 2020 2020 0a20 2020 2052 6574 7572 6e73      .    Returns
+000015a0: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
+000015b0: 2069 6d61 6765 3a0a 2020 2020 2020 2020   image:.        
+000015c0: 6d61 7472 6978 2073 7061 6e6e 696e 6720  matrix spanning 
+000015d0: 7468 6520 696d 6167 6520 6f66 204d 0a20  the image of M. 
+000015e0: 2020 2020 2020 200a 2020 2020 6b65 726e         .    kern
+000015f0: 656c 3a0a 2020 2020 2020 2020 6d61 7472  el:.        matr
+00001600: 6978 2073 7061 6e6e 696e 6720 746f 2074  ix spanning to t
+00001610: 6865 206b 6572 6e65 6c20 6f66 204d 0a20  he kernel of M. 
+00001620: 2020 2072 1200 0000 7211 0000 0072 0100     r....r....r..
+00001630: 0000 7229 0000 00e9 ffff ffff 4e29 0b72  ..r)........N).r
+00001640: 0300 0000 721a 0000 00da 0561 7272 6179  ....r......array
+00001650: 7217 0000 00da 066d 6174 7269 7872 4e00  r......matrixrN.
+00001660: 0000 da09 7472 616e 7370 6f73 6572 1600  ....transposer..
+00001670: 0000 723f 0000 0072 3e00 0000 7242 0000  ..r?...r>...rB..
+00001680: 0029 0972 4600 0000 721d 0000 0072 1f00  .).rF...r....r..
+00001690: 0000 da03 496d 54da 044b 6572 54da 0670  ....ImT..KerT..p
+000016a0: 6976 6f74 73da 066b 6572 6e65 6cda 0569  ivots..kernel..i
+000016b0: 6d61 6765 da10 7a65 726f 5f72 6f77 5f69  mage..zero_row_i
+000016c0: 6e64 6963 6573 7205 0000 0072 0500 0000  ndicesr....r....
+000016d0: 720d 0000 00da 0569 6d6b 6572 9900 0000  r......imker....
+000016e0: 732c 0000 0008 1808 010a 0108 010a 011a  s,..............
+000016f0: 020c 0108 0210 010e 0108 010c 010c 0102  ................
+00001700: 8010 0218 0118 0108 0322 0108 0116 0108  ........."......
+00001710: 0272 5900 0000 4629 01da 0267 7363 0000  .rY...F)...gsc..
+00001720: 0000 0000 0000 0100 0000 0600 0000 0400  ................
+00001730: 0000 0f00 0000 73da 0000 0074 007c 0164  ......s....t.|.d
+00001740: 0119 0083 017d 037c 0364 026b 0272 0f74  .....}.|.d.k.r.t
+00001750: 01a0 027c 01a1 017d 017c 0364 036b 0272  ...|...}.|.d.k.r
+00001760: 1874 03a0 047c 01a1 017d 0174 057c 01a0  .t...|...}.t.|..
+00001770: 06a1 0066 0169 007c 02a4 018e 015c 027d  ...f.i.|.....\.}
+00001780: 0489 007c 0364 026b 0272 2e88 006a 075c  ...|.d.k.r...j.\
+00001790: 0289 017d 056e 0b7c 0364 036b 0272 3988  ...}.n.|.d.k.r9.
+000017a0: 006a 0888 006a 0902 0289 017d 057c 0072  .j...j.....}.|.r
+000017b0: 5588 0164 016b 0472 557c 0564 016b 0472  U..d.k.rU|.d.k.r
+000017c0: 5574 0a87 0087 0166 0264 0464 0584 0874  Ut.....f.d.d...t
+000017d0: 0b7c 0583 0144 0083 0166 0169 007c 02a4  .|...D...f.i.|..
+000017e0: 018e 0189 007c 0364 026b 0272 6074 01a0  .....|.d.k.r`t..
+000017f0: 0288 00a1 01a0 0ca1 0053 007c 0364 036b  .........S.|.d.k
+00001800: 0272 6b74 03a0 0488 00a1 01a0 0ca1 0053  .rkt...........S
+00001810: 0064 0653 0029 0761 1902 0000 0a20 2020  .d.S.).a.....   
+00001820: 2050 726f 7669 6465 2061 6e20 6578 7465   Provide an exte
+00001830: 6e73 696f 6e20 6f66 2061 2067 6976 656e  nsion of a given
+00001840: 2073 6574 206f 6620 7665 6374 6f72 7320   set of vectors 
+00001850: 746f 2073 7061 6e20 7468 6520 6675 6c6c  to span the full
+00001860: 2073 7061 6365 2e20 0a20 2020 2054 6865   space. .    The
+00001870: 2076 6563 746f 7273 2063 616e 2068 6176   vectors can hav
+00001880: 6520 7265 616c 206f 7220 636f 6d70 6c65  e real or comple
+00001890: 7820 636f 6566 6669 6369 656e 7473 2e0a  x coefficients..
+000018a0: 2020 2020 0a20 2020 2050 6172 616d 6574      .    Paramet
+000018b0: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
+000018c0: 2d2d 0a20 2020 202a 7665 6374 733a 0a20  --.    *vects:. 
+000018d0: 2020 2020 2020 2056 6563 746f 7273 2074         Vectors t
+000018e0: 6f20 6265 2065 7874 656e 6465 640a 2020  o be extended.  
+000018f0: 2020 2020 2020 0a20 2020 2067 733a 2062        .    gs: b
+00001900: 6f6f 6c65 616e 2c20 6f70 7469 6f6e 616c  oolean, optional
+00001910: 0a20 2020 2020 2020 2041 7070 6c79 2074  .        Apply t
+00001920: 6865 2047 7261 6d2d 5363 686d 6964 7420  he Gram-Schmidt 
+00001930: 6f72 7468 6f67 6f6e 616c 697a 6174 696f  orthogonalizatio
+00001940: 6e20 7072 6f63 6564 7572 6520 6f6e 2074  n procedure on t
+00001950: 6865 2065 7874 656e 7369 6f6e 2e0a 2020  he extension..  
+00001960: 2020 2020 2020 0a20 2020 202a 2a6b 7761        .    **kwa
+00001970: 7267 730a 2020 2020 2020 2020 4f70 7469  rgs.        Opti
+00001980: 6f6e 616c 2061 7267 756d 656e 7473 2070  onal arguments p
+00001990: 6173 7365 6420 746f 2067 7261 6d5f 7363  assed to gram_sc
+000019a0: 686d 6964 742e 2049 6e20 7573 6520 6f6e  hmidt. In use on
+000019b0: 6c79 2069 6620 6773 3d54 7275 652e 0a20  ly if gs=True.. 
+000019c0: 2020 2020 2020 200a 2020 2020 5265 7475         .    Retu
+000019d0: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
+000019e0: 2020 2020 6d61 7472 6978 0a20 2020 2020      matrix.     
+000019f0: 2020 2041 206d 6174 7269 7820 7265 7072     A matrix repr
+00001a00: 6573 656e 7469 6e67 2061 2062 6173 6973  esenting a basis
+00001a10: 2065 7874 656e 7369 6f6e 206f 6620 7468   extension of th
+00001a20: 6520 6769 7665 6e20 7665 6374 6f72 732e  e given vectors.
+00001a30: 0a20 2020 2072 0100 0000 7212 0000 0072  .    r....r....r
+00001a40: 1100 0000 6301 0000 0000 0000 0000 0000  ....c...........
+00001a50: 0001 0000 0005 0000 0013 0000 0073 2400  .............s$.
+00001a60: 0000 6700 7c00 5d0e 8900 8701 8700 6602  ..g.|.].......f.
+00001a70: 6400 6401 8408 7400 8802 8301 4400 8301  d.d...t.....D...
+00001a80: 9102 7102 5300 2902 6301 0000 0000 0000  ..q.S.).c.......
+00001a90: 0000 0000 0002 0000 0005 0000 0013 0000  ................
+00001aa0: 0073 1800 0000 6700 7c00 5d08 7d01 8800  .s....g.|.].}...
+00001ab0: 7c01 8801 6602 1900 9102 7102 5300 7205  |...f.....q.S.r.
+00001ac0: 0000 0072 0500 0000 7208 0000 0029 02da  ...r....r....)..
+00001ad0: 0365 7874 722e 0000 0072 0500 0000 720d  .extr....r....r.
+00001ae0: 0000 0072 0e00 0000 f100 0000 7233 0000  ...r........r3..
+00001af0: 007a 2e62 6173 6973 5f65 7874 656e 7369  .z.basis_extensi
+00001b00: 6f6e 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973  on.<locals>.<lis
+00001b10: 7463 6f6d 703e 2e3c 6c69 7374 636f 6d70  tcomp>.<listcomp
+00001b20: 3e72 3400 0000 7235 0000 00a9 0272 5b00  >r4...r5.....r[.
+00001b30: 0000 7248 0000 00a9 0172 2e00 0000 720d  ..rH.....r....r.
+00001b40: 0000 0072 0e00 0000 f100 0000 7230 0000  ...r........r0..
+00001b50: 007a 2362 6173 6973 5f65 7874 656e 7369  .z#basis_extensi
+00001b60: 6f6e 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973  on.<locals>.<lis
+00001b70: 7463 6f6d 703e 4e29 0d72 0300 0000 721a  tcomp>N).r....r.
+00001b80: 0000 0072 5000 0000 7217 0000 0072 5100  ...rP...r....rQ.
+00001b90: 0000 7259 0000 0072 0700 0000 723e 0000  ..rY...r....r>..
+00001ba0: 0072 4100 0000 7242 0000 0072 3c00 0000  .rA...rB...r<...
+00001bb0: 7215 0000 0072 5200 0000 2906 725a 0000  r....rR...).rZ..
+00001bc0: 00da 0576 6563 7473 721d 0000 0072 1f00  ...vectsr....r..
+00001bd0: 0000 da01 5f72 2400 0000 7205 0000 0072  ...._r$...r....r
+00001be0: 5c00 0000 720d 0000 00da 0f62 6173 6973  \...r......basis
+00001bf0: 5f65 7874 656e 7369 6f6e ce00 0000 7322  _extension....s"
+00001c00: 0000 000c 1508 010a 0108 010a 0118 0208  ................
+00001c10: 020c 0108 010e 0114 0224 0108 020e 0108  .........$......
+00001c20: 010e 0104 ff72 6000 0000 6302 0000 0000  .....r`...c.....
+00001c30: 0000 0000 0000 0005 0000 0005 0000 000b  ................
+00001c40: 0000 0073 0801 0000 7400 7c00 8301 7d03  ...s....t.|...}.
+00001c50: 7c03 6401 6b02 723c 7c00 6a01 6402 1900  |.d.k.r<|.j.d...
+00001c60: 7c00 6a01 6403 1900 6b02 7314 4a00 8201  |.j.d...k.s.J...
+00001c70: 7c01 731f 7402 6a03 a004 7c00 a101 5c02  |.s.t.j...|...\.
+00001c80: 7d04 8900 6e08 7402 6a03 a005 7c00 a101  }...n.t.j...|...
+00001c90: 5c02 7d04 8900 7c04 a006 a100 7d04 8700  \.}...|.....}...
+00001ca0: 6601 6404 6405 8408 7407 7408 7c04 8301  f.d.d...t.t.|...
+00001cb0: 8301 4400 8301 8900 7c04 8800 6602 5300  ..D.....|...f.S.
+00001cc0: 7c03 6406 6b02 727c 7c00 6a09 7c00 6a0a  |.d.k.r||.j.|.j.
+00001cd0: 6b02 7348 4a00 8201 6407 7c02 a00b a100  k.sHJ...d.|.....
+00001ce0: 7600 7254 7c02 6407 1900 740c 6a0c 5f0d  v.rT|.d...t.j._.
+00001cf0: 7c01 7361 740c a004 740c a00e 7c00 a101  |.sat...t...|...
+00001d00: a101 5c02 7d04 8900 6e0a 740c a005 740c  ..\.}...n.t...t.
+00001d10: a00e 7c00 a101 a101 5c02 7d04 8900 8700  ..|.....\.}.....
+00001d20: 6601 6408 6405 8408 7407 7408 7c04 8301  f.d.d...t.t.|...
+00001d30: 8301 4400 8301 8900 7c04 8800 6602 5300  ..D.....|...f.S.
+00001d40: 740f 6409 7c03 9b00 640a 9d03 8301 8201  t.d.|...d.......
+00001d50: 290b 6112 0100 000a 2020 2020 436f 6d70  ).a.....    Comp
+00001d60: 7574 6520 7468 6520 6569 6765 6e76 616c  ute the eigenval
+00001d70: 7565 7320 616e 6420 6569 6765 6e76 6563  ues and eigenvec
+00001d80: 746f 7273 206f 6620 6120 6769 7665 6e20  tors of a given 
+00001d90: 6d61 7472 6978 2c20 6261 7365 6420 6f6e  matrix, based on
+00001da0: 2075 6e64 6572 6c79 696e 6720 636f 6465   underlying code
+00001db0: 2e0a 2020 2020 0a20 2020 2050 6172 616d  ..    .    Param
+00001dc0: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
+00001dd0: 2d2d 2d2d 0a20 2020 204d 3a20 6d61 7472  ----.    M: matr
+00001de0: 6978 0a20 2020 2020 2020 204d 6174 7269  ix.        Matri
+00001df0: 7820 746f 2062 6520 636f 6e73 6964 6572  x to be consider
+00001e00: 6564 2e0a 2020 2020 2020 2020 0a20 2020  ed..        .   
+00001e10: 2073 796d 6d65 7472 6963 3a20 626f 6f6c   symmetric: bool
+00001e20: 6561 6e2c 206f 7074 696f 6e61 6c0a 2020  ean, optional.  
+00001e30: 2020 2020 2020 5768 6574 6865 7220 7468        Whether th
+00001e40: 6520 6d61 7472 6978 2069 7320 6173 7375  e matrix is assu
+00001e50: 6d65 6420 746f 2062 6520 7379 6d6d 6574  med to be symmet
+00001e60: 7269 632e 0a20 2020 2072 1200 0000 7201  ric..    r....r.
+00001e70: 0000 0072 2900 0000 6301 0000 0000 0000  ...r)...c.......
+00001e80: 0000 0000 0002 0000 0005 0000 0013 0000  ................
+00001e90: 0073 2200 0000 6700 7c00 5d0d 7d01 7400  .s"...g.|.].}.t.
+00001ea0: a001 8800 a101 6400 6400 8502 7c01 6602  ......d.d...|.f.
+00001eb0: 1900 9102 7102 5300 a901 4e29 0272 1a00  ....q.S...N).r..
+00001ec0: 0000 7250 0000 00a9 0272 0900 0000 722e  ..rP.....r....r.
+00001ed0: 0000 00a9 01da 0c65 6967 656e 7665 6374  .......eigenvect
+00001ee0: 6f72 7372 0500 0000 720d 0000 0072 0e00  orsr....r....r..
+00001ef0: 0000 0e01 0000 7228 0000 007a 1765 6967  ......r(...z.eig
+00001f00: 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973 7463  .<locals>.<listc
+00001f10: 6f6d 703e 7211 0000 00da 0364 7073 6301  omp>r......dpsc.
+00001f20: 0000 0000 0000 0000 0000 0002 0000 0005  ................
+00001f30: 0000 0013 0000 0073 1c00 0000 6700 7c00  .......s....g.|.
+00001f40: 5d0a 7d01 8800 6400 6400 8502 7c01 6602  ].}...d.d...|.f.
+00001f50: 1900 9102 7102 5300 7261 0000 0072 0500  ....q.S.ra...r..
+00001f60: 0000 7262 0000 0072 6300 0000 7205 0000  ..rb...rc...r...
+00001f70: 0072 0d00 0000 720e 0000 0019 0100 0072  .r....r........r
+00001f80: 1000 0000 7a06 636f 6465 2027 7a11 2720  ....z.code 'z.' 
+00001f90: 6e6f 7420 7265 636f 676e 697a 6564 2e29  not recognized.)
+00001fa0: 1072 0300 0000 723e 0000 0072 1a00 0000  .r....r>...r....
+00001fb0: da06 6c69 6e61 6c67 da03 6569 67da 0465  ..linalg..eig..e
+00001fc0: 6967 68da 0674 6f6c 6973 7472 1500 0000  igh..tolistr....
+00001fd0: 7216 0000 0072 4200 0000 7241 0000 00da  r....rB...rA....
+00001fe0: 046b 6579 7372 1700 0000 7265 0000 0072  .keysr....re...r
+00001ff0: 5100 0000 7238 0000 0029 0572 4600 0000  Q...r8...).rF...
+00002000: da09 7379 6d6d 6574 7269 6372 1d00 0000  ..symmetricr....
+00002010: 721f 0000 00da 0b65 6967 656e 7661 6c75  r......eigenvalu
+00002020: 6573 7205 0000 0072 6300 0000 720d 0000  esr....rc...r...
+00002030: 0072 6700 0000 f900 0000 7326 0000 0008  .rg.......s&....
+00002040: 0c08 0218 0104 0112 0110 0208 011a 0108  ................
+00002050: 0f08 f310 010c 010c 0104 0216 0114 021a  ................
+00002060: 0108 0410 fe72 6700 0000 5463 0400 0000  .....rg...Tc....
+00002070: 0000 0000 0000 0000 1600 0000 0800 0000  ................
+00002080: 0b00 0000 7364 0200 0074 007c 0083 017d  ....sd...t.|...}
+00002090: 0574 017c 0066 0169 007c 04a4 018e 015c  .t.|.f.i.|.....\
+000020a0: 0289 0089 0174 0288 0083 017d 067c 0664  .....t.....}.|.d
+000020b0: 016b 0473 184a 0082 0174 0288 0164 0119  .k.s.J...t...d..
+000020c0: 0083 017d 0774 0387 0366 0164 0264 0384  ...}.t...f.d.d..
+000020d0: 0888 0144 0083 0183 0173 314a 0064 0488  ...D.....s1J.d..
+000020e0: 039b 0064 059d 0383 0182 0164 0167 0167  ...d.......d.g.g
+000020f0: 017d 0874 0464 067c 0683 0244 005d 387d  .}.t.d.|...D.]8}
+00002100: 0964 017d 0a7c 0a74 027c 0883 016b 0072  .d.}.|.t.|...k.r
+00002110: 6674 0588 007c 0919 0088 007c 087c 0a19  ft...|.....|.|..
+00002120: 0064 0119 0019 0018 0083 0188 036b 0072  .d...........k.r
+00002130: 5c7c 087c 0a19 00a0 067c 09a1 0101 006e  \|.|.....|.....n
+00002140: 0a7c 0a64 0637 007d 0a7c 0a74 027c 0883  .|.d.7.}.|.t.|..
+00002150: 016b 0073 447c 0a74 027c 0883 016b 0272  .k.sD|.t.|...k.r
+00002160: 727c 08a0 067c 0967 01a1 0101 0071 3a7c  r|...|.g.....q:|
+00002170: 0372 af74 077c 0066 0164 0788 0369 017c  .r.t.|.f.d...i.|
+00002180: 04a4 018e 015c 027d 0b7d 0c7c 0564 086b  .....\.}.}.|.d.k
+00002190: 0272 8a7c 0c6a 0864 0619 007d 0d7c 0564  .r.|.j.d...}.|.d
+000021a0: 096b 0272 917c 0c6a 097d 0d74 0287 0087  .k.r.|.j.}.t....
+000021b0: 0366 0264 0a64 0384 087c 0844 0083 0183  .f.d.d...|.D....
+000021c0: 017d 0e7c 0d7c 0e6b 0273 af4a 0064 0b7c  .}.|.|.k.s.J.d.|
+000021d0: 0e9b 0064 0c7c 0d9b 0064 0d88 039b 0064  ...d.|...d.....d
+000021e0: 0e9d 0783 0182 0167 0067 0002 027d 0f7d  .......g.g...}.}
+000021f0: 107c 0844 005d 7789 0287 0187 0266 0264  .|.D.]w......f.d
+00002200: 0f64 0384 0874 047c 0783 0144 0083 017d  .d...t.|...D...}
+00002210: 117c 0564 086b 0272 cd74 0aa0 0b7c 11a1  .|.d.k.r.t...|..
+00002220: 017d 127c 0564 096b 0272 d674 0ca0 0d7c  .}.|.d.k.r.t...|
+00002230: 11a1 017d 1274 077c 1266 0164 0788 0369  ...}.t.|.f.d...i
+00002240: 017c 04a4 018e 015c 0289 047d 137c 0564  .|.....\...}.|.d
+00002250: 086b 0272 ec88 04a0 0ea1 00a0 0fa1 0089  .k.r............
+00002260: 047c 0564 096b 0272 fc87 0466 0164 1064  .|.d.k.r...f.d.d
+00002270: 0384 0874 0488 046a 0983 0144 0083 0189  ...t...j...D....
+00002280: 0474 1088 0466 0164 0788 0369 017c 04a4  .t...f.d...i.|..
+00002290: 018e 017d 1487 0066 0164 1164 0384 0888  ...}...f.d.d....
+000022a0: 0264 1274 027c 1483 0185 0219 0044 0083  .d.t.|.......D..
+000022b0: 017d 157c 0190 0172 217c 107c 1437 007d  .}.|...r!|.|.7.}
+000022c0: 107c 0f7c 1537 007d 0f71 b67c 10a0 067c  .|.|.7.}.q.|...|
+000022d0: 14a1 0101 007c 0fa0 067c 1564 0119 00a1  .....|...|.d....
+000022e0: 0101 0071 b67c 0f7c 1066 0253 0029 1361  ...q.|.|.f.S.).a
+000022f0: a807 0000 0a20 2020 204c 6574 204d 2062  .....    Let M b
+00002300: 6520 6120 7371 7561 7265 206d 6174 7269  e a square matri
+00002310: 782e 2054 6865 6e20 7468 6973 2072 6f75  x. Then this rou
+00002320: 7469 6e65 2077 696c 6c20 6174 7465 6d70  tine will attemp
+00002330: 7420 746f 2064 6574 6572 6d69 6e65 2061  t to determine a
+00002340: 2062 6173 6973 206f 6620 6e6f 726d 616c   basis of normal
+00002350: 697a 6564 2065 6967 656e 7665 6374 6f72  ized eigenvector
+00002360: 732e 200a 2020 2020 4865 7265 6279 2065  s. .    Hereby e
+00002370: 6967 656e 7665 6374 6f72 7320 6265 6c6f  igenvectors belo
+00002380: 6e67 696e 6720 746f 2074 6865 2073 616d  nging to the sam
+00002390: 6520 6569 6765 6e76 616c 7565 7320 6172  e eigenvalues ar
+000023a0: 6520 2863 6f6d 706c 6578 2920 6f72 7468  e (complex) orth
+000023b0: 6f67 6f6e 616c 697a 6564 2e0a 2020 2020  ogonalized..    
+000023c0: 0a20 2020 2021 2121 2041 7474 656e 7469  .    !!! Attenti
+000023d0: 6f6e 2021 2121 0a20 2020 2053 696e 6365  on !!!.    Since
+000023e0: 2074 6865 2064 6961 676f 6e61 6c69 7a61   the diagonaliza
+000023f0: 626c 6520 6d61 7472 6963 6573 2077 6974  ble matrices wit
+00002400: 6820 636f 6d70 6c65 7820 656e 7472 6965  h complex entrie
+00002410: 7320 6c61 7920 6465 6e73 6520 7769 7468  s lay dense with
+00002420: 696e 2074 6865 2073 6574 206f 6620 616c  in the set of al
+00002430: 6c20 636f 6d70 6c65 7820 6d61 7472 6963  l complex matric
+00002440: 6573 2c0a 2020 2020 7468 6520 636f 6465  es,.    the code
+00002450: 206d 6179 2066 6169 6c20 666f 7220 696c   may fail for il
+00002460: 6c2d 636f 6e64 6974 696f 6e65 6420 6d61  l-conditioned ma
+00002470: 7472 6963 6573 2e20 4e6f 7465 2074 6861  trices. Note tha
+00002480: 7420 6120 6d61 7472 6978 2069 7320 6469  t a matrix is di
+00002490: 6167 6f6e 616c 697a 6162 6c65 2069 6620  agonalizable if 
+000024a0: 0a20 2020 2061 6e64 206f 6e6c 7920 6966  .    and only if
+000024b0: 2066 6f72 2065 6163 6820 6569 6765 6e76   for each eigenv
+000024c0: 616c 7565 2074 6865 2064 696d 656e 7369  alue the dimensi
+000024d0: 6f6e 206f 6620 7468 6520 6569 6765 6e73  on of the eigens
+000024e0: 7061 6365 2069 7320 6571 7561 6c20 746f  pace is equal to
+000024f0: 2074 6865 206d 756c 7469 706c 6963 6974   the multiplicit
+00002500: 7920 0a20 2020 206f 6620 7468 6520 6569  y .    of the ei
+00002510: 6765 6e76 616c 7565 2e0a 2020 2020 0a20  genvalue..    . 
+00002520: 2020 2049 7420 6d61 7920 6861 7070 656e     It may happen
+00002530: 2074 6861 7420 7468 6520 636f 6465 2077   that the code w
+00002540: 696c 6c20 6465 7465 726d 696e 6520 6120  ill determine a 
+00002550: 6469 6666 6572 656e 7420 7365 7420 6f66  different set of
+00002560: 2064 696d 656e 7369 6f6e 206f 6620 7468   dimension of th
+00002570: 6520 6569 6765 6e73 7061 6365 2074 6861  e eigenspace tha
+00002580: 6e0a 2020 2020 7468 6520 756e 6465 726c  n.    the underl
+00002590: 7969 6e67 206d 756c 7469 706c 6963 6974  ying multiplicit
+000025a0: 7920 6f66 2069 7473 2063 6f72 7265 7370  y of its corresp
+000025b0: 6f6e 6469 6e67 2065 6967 656e 7661 6c75  onding eigenvalu
+000025c0: 652e 2046 6f72 2065 7861 6d70 6c65 2c20  e. For example, 
+000025d0: 7468 6520 6d75 6c74 6970 6c69 6369 7479  the multiplicity
+000025e0: 206f 6620 6120 0a20 2020 207a 6572 6f2d   of a .    zero-
+000025f0: 6569 6765 6e76 616c 7565 206d 6967 6874  eigenvalue might
+00002600: 2062 6520 322c 2074 6865 2061 6374 7561   be 2, the actua
+00002610: 6c20 6469 6d65 6e73 696f 6e20 6f66 2074  l dimension of t
+00002620: 6865 206b 6572 6e65 6c20 6f66 2074 6865  he kernel of the
+00002630: 2067 6976 656e 206d 6174 7269 7820 6973   given matrix is
+00002640: 2031 2c20 0a20 2020 2062 7574 2064 7565   1, .    but due
+00002650: 2074 6f20 726f 756e 642d 6f66 6620 6572   to round-off er
+00002660: 726f 7273 2074 6865 2063 6f64 6520 6d61  rors the code ma
+00002670: 7920 7374 696c 6c20 6669 6e64 2061 2032  y still find a 2
+00002680: 2d64 696d 656e 7369 6f6e 616c 2062 6173  -dimensional bas
+00002690: 6973 206f 6620 7468 6520 7a65 726f 2d65  is of the zero-e
+000026a0: 6967 656e 7370 6163 652e 0a20 2020 2054  igenspace..    T
+000026b0: 6865 7265 666f 7265 2063 6865 636b 2074  herefore check t
+000026c0: 6865 206f 7574 7075 7420 2861 6e64 2074  he output (and t
+000026d0: 6865 2069 6e70 7574 2920 6361 7265 6675  he input) carefu
+000026e0: 6c6c 792e 0a20 2020 200a 2020 2020 5061  lly..    .    Pa
+000026f0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+00002700: 2d2d 2d2d 2d2d 2d0a 2020 2020 4d3a 0a20  -------.    M:. 
+00002710: 2020 2020 2020 206c 6973 7420 6f66 2076         list of v
+00002720: 6563 746f 7273 2064 6566 696e 696e 6720  ectors defining 
+00002730: 6120 286e 2078 206e 292d 6d61 7472 6978  a (n x n)-matrix
+00002740: 2e0a 2020 2020 2020 2020 0a20 2020 2066  ..        .    f
+00002750: 6c61 7474 656e 3a20 626f 6f6c 6561 6e2c  latten: boolean,
+00002760: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00002770: 2020 4966 2054 7275 652c 2066 6c61 7474    If True, flatt
+00002780: 656e 2074 6865 2072 6573 7065 6374 6976  en the respectiv
+00002790: 6520 7265 7375 6c74 7320 2864 6566 6175  e results (defau
+000027a0: 6c74 3a20 4661 6c73 6529 2e0a 2020 2020  lt: False)..    
+000027b0: 2020 2020 0a20 2020 2074 6f6c 3a20 666c      .    tol: fl
+000027c0: 6f61 742c 206f 7074 696f 6e61 6c0a 2020  oat, optional.  
+000027d0: 2020 2020 2020 5061 7261 6d65 7465 7220        Parameter 
+000027e0: 746f 2069 6465 6e74 6966 7920 736d 616c  to identify smal
+000027f0: 6c20 7661 6c75 6573 2061 7320 6265 696e  l values as bein
+00002800: 6720 7a65 726f 2e0a 2020 2020 2020 2020  g zero..        
+00002810: 0a20 2020 2063 6865 636b 3a20 626f 6f6c  .    check: bool
+00002820: 6561 6e2c 206f 7074 696f 6e61 6c0a 2020  ean, optional.  
+00002830: 2020 2020 2020 4368 6563 6b20 6966 2074        Check if t
+00002840: 6865 206e 756d 6265 7220 6f66 207a 6572  he number of zer
+00002850: 6f2d 6569 6765 6e76 616c 7565 7320 6973  o-eigenvalues is
+00002860: 2063 6f6e 7369 7374 656e 7420 7769 7468   consistent with
+00002870: 2074 6865 2064 696d 656e 7369 6f6e 206f   the dimension o
+00002880: 6620 7468 6520 6b65 726e 656c 206f 6620  f the kernel of 
+00002890: 7468 6520 696e 7075 7420 6d61 7472 6978  the input matrix
+000028a0: 2077 6974 6869 6e20 7468 6520 6769 7665   within the give
+000028b0: 6e20 746f 6c65 7261 6e63 652e 0a20 2020  n tolerance..   
+000028c0: 2020 2020 2054 6865 206b 6572 6e65 6c20       The kernel 
+000028d0: 6f66 2074 6865 2069 6e70 7574 206d 6174  of the input mat
+000028e0: 7269 7820 6973 2068 6572 6562 7920 6465  rix is hereby de
+000028f0: 7465 726d 696e 6564 2062 7920 7468 6520  termined by the 
+00002900: 696d 6b65 7220 726f 7574 696e 652e 0a20  imker routine.. 
+00002910: 2020 2020 2020 200a 2020 2020 2a2a 6b77         .    **kw
+00002920: 6172 6773 0a20 2020 2020 2020 204f 7074  args.        Opt
+00002930: 696f 6e61 6c20 6172 6775 6d65 6e74 7320  ional arguments 
+00002940: 7061 7373 6564 2074 6f20 6569 672c 2069  passed to eig, i
+00002950: 6d6b 6572 2061 6e64 2067 7261 6d5f 7363  mker and gram_sc
+00002960: 686d 6964 7420 726f 7574 696e 6573 2e0a  hmidt routines..
+00002970: 2020 2020 2020 2020 0a20 2020 2052 6574          .    Ret
+00002980: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
+00002990: 0a20 2020 2065 6967 656e 7661 6c75 6573  .    eigenvalues
+000029a0: 3a20 6c69 7374 0a20 2020 2020 2020 204c  : list.        L
+000029b0: 6973 7420 6f66 2065 6c65 6d65 6e74 732c  ist of elements,
+000029c0: 2077 6865 7265 2074 6865 206b 2d74 6820   where the k-th 
+000029d0: 656c 656d 656e 7420 636f 6e73 7469 7475  element constitu
+000029e0: 7465 2074 6865 2065 6967 656e 7661 6c75  te the eigenvalu
+000029f0: 6520 746f 2074 6865 206b 2d74 6820 6569  e to the k-th ei
+00002a00: 6765 6e73 7061 6365 2e0a 2020 2020 0a20  genspace..    . 
+00002a10: 2020 2065 6967 656e 7665 6374 6f72 733a     eigenvectors:
+00002a20: 206c 6973 740a 2020 2020 2020 2020 4c69   list.        Li
+00002a30: 7374 206f 6620 6c69 7374 732c 2077 6865  st of lists, whe
+00002a40: 7265 2074 6865 206b 2d74 6820 656c 656d  re the k-th elem
+00002a50: 656e 7420 6973 2061 206c 6973 7420 6f66  ent is a list of
+00002a60: 2070 6169 7277 6973 6520 756e 6974 6172   pairwise unitar
+00002a70: 7920 7665 6374 6f72 7320 7370 616e 6e69  y vectors spanni
+00002a80: 6e67 2074 6865 206b 2d74 6820 6569 6765  ng the k-th eige
+00002a90: 6e73 7061 6365 2e0a 2020 2020 7201 0000  nspace..    r...
+00002aa0: 0063 0100 0000 0000 0000 0000 0000 0200  .c..............
+00002ab0: 0000 0400 0000 1300 0000 7318 0000 0067  ..........s....g
+00002ac0: 007c 005d 087d 0174 007c 0183 0188 006b  .|.].}.t.|.....k
+00002ad0: 0591 0271 0253 0072 0500 0000 2901 7220  ...q.S.r....).r 
+00002ae0: 0000 00a9 0272 0900 0000 da01 6529 0172  .....r......e).r
+00002af0: 3900 0000 7205 0000 0072 0d00 0000 720e  9...r....r....r.
+00002b00: 0000 0052 0100 0072 3300 0000 7a1f 6569  ...R...r3...z.ei
+00002b10: 6765 6e73 7061 6365 732e 3c6c 6f63 616c  genspaces.<local
+00002b20: 733e 2e3c 6c69 7374 636f 6d70 3e7a 234e  s>.<listcomp>z#N
+00002b30: 6f72 6d20 6f66 2061 7420 6c65 6173 7420  orm of at least 
+00002b40: 6f6e 6520 6569 6765 6e76 6563 746f 7220  one eigenvector 
+00002b50: 3c20 da01 2e72 2900 0000 7239 0000 0072  < ...r)...r9...r
+00002b60: 1200 0000 7211 0000 0063 0100 0000 0000  ....r....c......
+00002b70: 0000 0000 0000 0200 0000 0600 0000 1300  ................
+00002b80: 0000 7324 0000 0067 007c 005d 0e7d 0174  ..s$...g.|.].}.t
+00002b90: 0088 007c 0164 0019 0019 0083 0188 016b  ...|.d.........k
+00002ba0: 0072 027c 0191 0271 0253 0072 2200 0000  .r.|...q.S.r"...
+00002bb0: 2901 7237 0000 0072 6d00 0000 2902 726c  ).r7...rm...).rl
+00002bc0: 0000 0072 3900 0000 7205 0000 0072 0d00  ...r9...r....r..
+00002bd0: 0000 720e 0000 006b 0100 0072 3000 0000  ..r....k...r0...
+00002be0: 7a20 5468 6520 6e75 6d62 6572 206f 6620  z The number of 
+00002bf0: 7a65 726f 2d65 6967 656e 7661 6c75 6573  zero-eigenvalues
+00002c00: 2028 7a28 2920 6973 206e 6f74 2063 6f6e   (z() is not con
+00002c10: 7369 7374 656e 7420 7769 7468 2074 6865  sistent with the
+00002c20: 2064 696d 656e 7369 6f6e 2028 7a4a 2920   dimension (zJ) 
+00002c30: 6f66 2074 6865 206b 6572 6e65 6c20 6f66  of the kernel of
+00002c40: 2074 6865 2069 6e70 7574 206d 6174 7269   the input matri
+00002c50: 782c 2062 6f74 6820 6465 7465 726d 696e  x, both determin
+00002c60: 6564 2075 7369 6e67 2061 2074 6f6c 6572  ed using a toler
+00002c70: 616e 6365 206f 6620 7a45 2e20 4368 6563  ance of zE. Chec
+00002c80: 6b20 6966 2069 6e70 7574 206d 6174 7269  k if input matri
+00002c90: 7820 6973 2064 6961 676f 6e61 6c69 7a61  x is diagonaliza
+00002ca0: 626c 6520 6f72 2074 7279 2074 6f20 6164  ble or try to ad
+00002cb0: 6a75 7374 2070 7265 6369 7369 6f6e 2e63  just precision.c
+00002cc0: 0100 0000 0000 0000 0000 0000 0100 0000  ................
+00002cd0: 0500 0000 1300 0000 7320 0000 0067 007c  ........s ...g.|
+00002ce0: 005d 0c89 0087 0187 0066 0264 0064 0184  .].......f.d.d..
+00002cf0: 0888 0244 0083 0191 0271 0253 0029 0263  ...D.....q.S.).c
+00002d00: 0100 0000 0000 0000 0000 0000 0200 0000  ................
+00002d10: 0400 0000 1300 0000 7318 0000 0067 007c  ........s....g.|
+00002d20: 005d 087d 0188 007c 0119 0088 0119 0091  .].}...|........
+00002d30: 0271 0253 0072 0500 0000 7205 0000 0072  .q.S.r....r....r
+00002d40: 0800 0000 2902 7264 0000 0072 2e00 0000  ....).rd...r....
+00002d50: 7205 0000 0072 0d00 0000 720e 0000 0071  r....r....r....q
+00002d60: 0100 0072 3300 0000 fa2a 6569 6765 6e73  ...r3....*eigens
+00002d70: 7061 6365 732e 3c6c 6f63 616c 733e 2e3c  paces.<locals>.<
+00002d80: 6c69 7374 636f 6d70 3e2e 3c6c 6973 7463  listcomp>.<listc
+00002d90: 6f6d 703e 7205 0000 0072 3500 0000 2902  omp>r....r5...).
+00002da0: 7264 0000 00da 0769 6e64 6963 6573 725d  rd.....indicesr]
+00002db0: 0000 0072 0d00 0000 720e 0000 0071 0100  ...r....r....q..
+00002dc0: 0072 0f00 0000 6301 0000 0000 0000 0000  .r....c.........
+00002dd0: 0000 0001 0000 0005 0000 0013 0000 0073  ...............s
+00002de0: 2600 0000 6700 7c00 5d0f 8900 8700 8701  &...g.|.].......
+00002df0: 6602 6400 6401 8408 7400 8801 6a01 8301  f.d.d...t...j...
+00002e00: 4400 8301 9102 7102 5300 2902 6301 0000  D.....q.S.).c...
+00002e10: 0000 0000 0000 0000 0002 0000 0005 0000  ................
+00002e20: 0013 0000 0072 3100 0000 7205 0000 0072  .....r1...r....r
+00002e30: 0500 0000 7262 0000 0029 0272 0a00 0000  ....rb...).r....
+00002e40: da06 7669 6d61 6765 7205 0000 0072 0d00  ..vimager....r..
+00002e50: 0000 720e 0000 007d 0100 0072 3300 0000  ..r....}...r3...
+00002e60: 7270 0000 0029 0272 1500 0000 7241 0000  rp...).r....rA..
+00002e70: 0072 3500 0000 2901 7272 0000 0029 0172  .r5...).rr...).r
+00002e80: 0a00 0000 720d 0000 0072 0e00 0000 7d01  ....r....r....}.
+00002e90: 0000 7302 0000 0026 0063 0100 0000 0000  ..s....&.c......
+00002ea0: 0000 0000 0000 0200 0000 0400 0000 1300  ................
+00002eb0: 0000 7314 0000 0067 007c 005d 067d 0188  ..s....g.|.].}..
+00002ec0: 007c 0119 0091 0271 0253 0072 0500 0000  .|.....q.S.r....
+00002ed0: 7205 0000 0072 0800 0000 2901 726c 0000  r....r....).rl..
+00002ee0: 0072 0500 0000 720d 0000 0072 0e00 0000  .r....r....r....
+00002ef0: 8001 0000 7302 0000 0014 004e 2911 7203  ....s......N).r.
+00002f00: 0000 0072 6700 0000 7216 0000 00da 0361  ...rg...r......a
+00002f10: 6c6c 7215 0000 0072 3700 0000 7245 0000  llr....r7...rE..
+00002f20: 0072 5900 0000 723e 0000 0072 4200 0000  .rY...r>...rB...
+00002f30: 721a 0000 0072 5000 0000 7217 0000 0072  r....rP...r....r
+00002f40: 5100 0000 7252 0000 0072 6900 0000 723c  Q...rR...ri...r<
+00002f50: 0000 0029 1672 4600 0000 da07 666c 6174  ...).rF.....flat
+00002f60: 7465 6e72 3900 0000 da05 6368 6563 6b72  tenr9.....checkr
+00002f70: 1d00 0000 721f 0000 0072 4800 0000 7236  ....r....rH...r6
+00002f80: 0000 00da 0b65 6967 656e 7370 6163 6573  .....eigenspaces
+00002f90: 722a 0000 0072 2e00 0000 7257 0000 0072  r*...r....rW...r
+00002fa0: 5600 0000 da0a 6469 6d5f 6b65 726e 656c  V.....dim_kernel
+00002fb0: da12 6e5f 7a65 726f 5f65 6967 656e 7661  ..n_zero_eigenva
+00002fc0: 6c75 6573 da12 6569 6765 6e76 616c 7565  lues..eigenvalue
+00002fd0: 735f 7265 7375 6c74 da13 6569 6765 6e76  s_result..eigenv
+00002fe0: 6563 746f 7273 5f72 6573 756c 7472 2600  ectors_resultr&.
+00002ff0: 0000 da04 7370 616e da07 766b 6572 6e65  ....span..vkerne
+00003000: 6cda 0a6f 6e5f 7665 6374 6f72 73da 0e6f  l..on_vectors..o
+00003010: 6e5f 6569 6765 6e76 616c 7565 7372 0500  n_eigenvaluesr..
+00003020: 0000 2905 726c 0000 0072 6400 0000 7271  ..).rl...rd...rq
+00003030: 0000 0072 3900 0000 7272 0000 0072 0d00  ...r9...rr...r..
+00003040: 0000 7276 0000 0020 0100 0073 5c00 0000  ..rv... ...s\...
+00003050: 082b 1401 0803 0c01 0c01 2601 0803 0e01  .+........&.....
+00003060: 0401 0c01 2001 0e02 0201 0801 0cfb 0c06  .... ...........
+00003070: 0c02 0280 0402 1803 0801 0a01 0801 0601  ................
+00003080: 1802 2401 0a03 0801 1801 0802 0a01 0801  ..$.............
+00003090: 0a01 1801 0803 0c01 0801 1801 1402 1e01  ................
+000030a0: 0601 0801 0a01 0a02 1001 0802 7276 0000  ............rv..
+000030b0: 0063 0100 0000 0000 0000 0000 0000 0700  .c..............
+000030c0: 0000 0800 0000 0b00 0000 73c6 0000 0074  ..........s....t
+000030d0: 007c 0066 0169 007c 01a4 018e 015c 027d  .|.f.i.|.....\.}
+000030e0: 027d 0374 017c 0283 017d 0474 02a0 0374  .}.t.|...}.t...t
+000030f0: 026a 047c 02a0 05a1 0074 0664 018d 02a1  .j.|.....t.d....
+00003100: 0189 0074 0764 027c 0483 0244 005d 397d  ...t.d.|...D.]9}
+00003110: 0574 077c 047c 0518 0083 0144 005d 307d  .t.|.|.....D.]0}
+00003120: 067c 0689 017c 057c 0617 0089 027c 0288  .|...|.|.....|..
+00003130: 0188 0266 0219 0074 0887 0087 0187 0266  ...f...t.......f
+00003140: 0364 0364 0484 0874 0788 0164 0217 0088  .d.d...t...d....
+00003150: 0283 0244 0083 0183 0118 0088 0088 0188  ...D............
+00003160: 0166 0219 0088 0088 0288 0266 0219 0017  .f.........f....
+00003170: 001b 0088 0088 0188 0266 023c 0071 2771  .........f.<.q'q
+00003180: 1f7c 0388 0010 007c 03a0 09a1 00a0 0aa1  .|.....|........
+00003190: 0010 0053 0029 0575 6301 0000 0a20 2020  ...S.).uc....   
+000031a0: 2041 206e 756d 6572 6963 2061 6c67 6f72   A numeric algor
+000031b0: 6974 686d 2074 6f20 6f62 7461 696e 2074  ithm to obtain t
+000031c0: 6865 2070 7269 6e63 6970 616c 2073 7175  he principal squ
+000031d0: 6172 6520 726f 6f74 206f 6620 6120 6d61  are root of a ma
+000031e0: 7472 6978 204d 2028 6966 2069 7420 6578  trix M (if it ex
+000031f0: 6973 7473 292e 0a20 2020 2054 6865 2070  ists)..    The p
+00003200: 7269 6e63 6970 616c 2073 7175 6172 6520  rincipal square 
+00003210: 6973 2074 6865 2075 6e69 7175 6520 7371  is the unique sq
+00003220: 7561 7265 2072 6f6f 7420 6f66 2061 206d  uare root of a m
+00003230: 6174 7269 7820 736f 2074 6861 7420 2d70  atrix so that -p
+00003240: 692f 3220 3c20 6172 6728 6c28 5829 2920  i/2 < arg(l(X)) 
+00003250: 3c3d 2070 692f 320a 2020 2020 686f 6c64  <= pi/2.    hold
+00003260: 732c 2077 6865 7265 0a20 2020 2049 7420  s, where.    It 
+00003270: 6361 6e20 6361 6e20 6265 2065 7870 7265  can can be expre
+00003280: 7373 6564 2069 6e20 7465 726d 7320 6f66  ssed in terms of
+00003290: 2061 2070 6f6c 796e 6f6d 6961 6c20 696e   a polynomial in
+000032a0: 204d 2e0a 2020 2020 5265 6665 726e 6365   M..    Refernce
+000032b0: 3a20 416b 6520 426a c3b6 726b 3a20 4e75  : Ake Bj..rk: Nu
+000032c0: 6d65 7269 6361 6c20 4d65 7468 6f64 7320  merical Methods 
+000032d0: 696e 204d 6174 7269 7820 436f 6d70 7574  in Matrix Comput
+000032e0: 6174 696f 6e73 2028 3230 3134 292c 2073  ations (2014), s
+000032f0: 6563 2e20 332e 382e 312e 0a20 2020 20a9  ec. 3.8.1..    .
+00003300: 01da 0564 7479 7065 7229 0000 0063 0100  ...dtyper)...c..
+00003310: 0000 0000 0000 0000 0000 0200 0000 0600  ................
+00003320: 0000 1300 0000 7324 0000 0067 007c 005d  ......s$...g.|.]
+00003330: 0e7d 0188 0088 017c 0166 0219 0088 007c  .}.....|.f.....|
+00003340: 0188 0266 0219 0014 0091 0271 0253 0072  ...f.......q.S.r
+00003350: 0500 0000 7205 0000 0072 0800 0000 a903  ....r....r......
+00003360: da01 5372 2a00 0000 722e 0000 0072 0500  ..Sr*...r....r..
+00003370: 0000 720d 0000 0072 0e00 0000 9c01 0000  ..r....r........
+00003380: 7230 0000 007a 2667 6574 5f70 7269 6e63  r0...z&get_princ
+00003390: 6970 616c 5f73 7172 742e 3c6c 6f63 616c  ipal_sqrt.<local
+000033a0: 733e 2e3c 6c69 7374 636f 6d70 3e29 0b72  s>.<listcomp>).r
+000033b0: 0200 0000 7216 0000 0072 1a00 0000 da04  ....r....r......
+000033c0: 6469 6167 7218 0000 00da 0864 6961 676f  diagr......diago
+000033d0: 6e61 6c72 0400 0000 7215 0000 0072 1400  nalr....r....r..
+000033e0: 0000 7252 0000 0072 0700 0000 2907 7246  ..rR...r....).rF
+000033f0: 0000 0072 1d00 0000 da01 54da 0151 7236  ...r......T..Qr6
+00003400: 0000 0072 8400 0000 da0e 6469 6167 6f6e  ...r......diagon
+00003410: 616c 5f69 6e64 6578 7205 0000 0072 8100  al_indexr....r..
+00003420: 0000 720d 0000 00da 1267 6574 5f70 7269  ..r......get_pri
+00003430: 6e63 6970 616c 5f73 7172 748b 0100 0073  ncipal_sqrt....s
+00003440: 1400 0000 1408 0803 1801 0e01 1001 0401  ................
+00003450: 0801 5201 02fd 1406 7288 0000 0063 0100  ..R.....r....c..
+00003460: 0000 0000 0000 0000 0000 0300 0000 0400  ................
+00003470: 0000 4300 0000 7328 0000 0074 007c 007c  ..C...s(...t.|.|
+00003480: 00a0 01a1 0010 0083 017d 0174 026a 03a0  .........}.t.j..
+00003490: 047c 01a1 017c 0010 007d 027c 027c 0166  .|...|...}.|.|.f
+000034a0: 0253 0029 0161 0801 0000 0a20 2020 2049  .S.).a.....    I
+000034b0: 6620 4d20 6973 2061 2063 6f6d 706c 6578  f M is a complex
+000034c0: 206e 6f6e 2d73 696e 6775 6c61 7220 7371   non-singular sq
+000034d0: 7561 7265 206d 6174 7269 782c 2074 6869  uare matrix, thi
+000034e0: 7320 726f 7574 696e 6520 7769 6c6c 2061  s routine will a
+000034f0: 7474 656d 7074 2074 6f20 6465 7465 726d  ttempt to determ
+00003500: 696e 6520 6120 6465 636f 6d70 6f73 6974  ine a decomposit
+00003510: 696f 6e20 0a20 2020 2020 2020 204d 203d  ion .        M =
+00003520: 2047 4051 0a20 2020 2073 6f20 7468 6174   G@Q.    so that
+00003530: 2047 2069 7320 636f 6d70 6c65 7820 7379   G is complex sy
+00003540: 6d6d 6574 7269 6320 616e 6420 5120 6973  mmetric and Q is
+00003550: 2063 6f6d 706c 6578 206f 7274 686f 676f   complex orthogo
+00003560: 6e61 6c2e 0a20 2020 2053 6565 2054 686d  nal..    See Thm
+00003570: 2e20 362e 342e 3136 2069 6e20 486f 726e  . 6.4.16 in Horn
+00003580: 2026 204a 6f68 6e73 6f6e 3a20 546f 7069   & Johnson: Topi
+00003590: 6373 2069 6e20 4d61 7472 6978 2041 6e61  cs in Matrix Ana
+000035a0: 6c79 7369 7320 2831 3939 3129 2e0a 2020  lysis (1991)..  
+000035b0: 2020 2905 7288 0000 0072 5200 0000 721a    ).r....rR...r.
+000035c0: 0000 0072 6600 0000 da03 696e 7629 0372  ...rf.....inv).r
+000035d0: 4600 0000 da01 4772 8600 0000 7205 0000  F.....Gr....r...
+000035e0: 0072 0500 0000 720d 0000 00da 1e63 6f72  .r....r......cor
+000035f0: 7468 6f5f 7379 6d6d 6574 7269 635f 6465  tho_symmetric_de
+00003600: 636f 6d70 6f73 6974 696f 6ea2 0100 0073  composition....s
+00003610: 0600 0000 1007 1001 0805 728b 0000 0072  ..........r....r
+00003620: 2900 0000 e902 0000 0063 0300 0000 0000  )........c......
+00003630: 0000 0000 0000 0400 0000 0300 0000 0300  ................
+00003640: 0000 7314 0000 0087 0087 0187 0266 0364  ..s..........f.d
+00003650: 0164 0284 087d 037c 0353 0029 0361 3c02  .d...}.|.S.).a<.
+00003660: 0000 0a20 2020 2044 6563 6f72 6174 6f72  ...    Decorator
+00003670: 2066 6f72 206d 6174 7269 782d 6c69 6b65   for matrix-like
+00003680: 2063 616c 6375 6c61 7469 6f6e 7320 666f   calculations fo
+00003690: 7220 6d75 6c74 692d 6469 6d65 6e73 696f  r multi-dimensio
+000036a0: 6e61 6c20 6172 7261 7973 2e0a 2020 2020  nal arrays..    
+000036b0: 0a20 2020 2054 6865 2066 6972 7374 2074  .    The first t
+000036c0: 776f 2069 6e64 6963 6573 206f 6620 7468  wo indices of th
+000036d0: 6520 696e 7075 7420 6172 7261 7920 6172  e input array ar
+000036e0: 6520 7472 6561 7465 6420 6173 206d 6174  e treated as mat
+000036f0: 7269 7820 6172 7261 7973 2c20 7768 696c  rix arrays, whil
+00003700: 6520 7468 6520 7265 6d61 696e 696e 6720  e the remaining 
+00003710: 696e 6469 6365 730a 2020 2020 6172 6520  indices.    are 
+00003720: 636f 6e73 6964 6572 6564 2074 6f20 6265  considered to be
+00003730: 2072 756e 6e69 6e67 2069 6e64 6963 6573   running indices
+00003740: 2e0a 2020 2020 0a20 2020 2050 6172 616d  ..    .    Param
+00003750: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
+00003760: 2d2d 2d2d 0a20 2020 206e 5f6f 7574 5f61  ----.    n_out_a
+00003770: 7267 733a 2069 6e74 2c20 6f70 7469 6f6e  rgs: int, option
+00003780: 616c 0a20 2020 2020 2020 2049 6620 3e20  al.        If > 
+00003790: 312c 2069 7420 6973 2061 7373 756d 6564  1, it is assumed
+000037a0: 2074 6861 7420 7468 6520 6675 6e63 7469   that the functi
+000037b0: 6f6e 206f 7574 7075 7420 7265 7475 726e  on output return
+000037c0: 7320 6d6f 7265 2074 6861 6e20 6f6e 6520  s more than one 
+000037d0: 6f75 7470 7574 2e0a 2020 2020 2020 2020  output..        
+000037e0: 0a20 2020 206e 5f69 6e70 5f61 7865 733a  .    n_inp_axes:
+000037f0: 2069 6e74 2c20 6f70 7469 6f6e 616c 0a20   int, optional. 
+00003800: 2020 2020 2020 2044 6566 696e 6520 7468         Define th
+00003810: 6520 6e75 6d62 6572 206f 6620 696e 7075  e number of inpu
+00003820: 7420 6178 6573 2028 6173 6365 6e64 696e  t axes (ascendin
+00003830: 6720 6672 6f6d 2074 6865 2066 6972 7374  g from the first
+00003840: 2061 7869 7320 7570 7761 7264 7329 200a   axis upwards) .
+00003850: 2020 2020 2020 2020 7768 6963 6820 7368          which sh
+00003860: 6f75 6c64 2062 6520 636f 6e73 6964 6572  ould be consider
+00003870: 6564 2061 7320 696e 7075 7420 666f 7220  ed as input for 
+00003880: 7468 6520 6675 6e63 7469 6f6e 2069 6e20  the function in 
+00003890: 7175 6573 7469 6f6e 2e0a 2020 2020 6301  question..    c.
+000038a0: 0000 0000 0000 0000 0000 000b 0000 0007  ................
+000038b0: 0000 001b 0000 0073 ac01 0000 7400 7c00  .......s....t.|.
+000038c0: 6401 8302 730d 8801 7c00 6601 6900 7c01  d...s...|.f.i.|.
+000038d0: a401 8e01 5300 7401 7c00 6a02 8301 8802  ....S.t.|.j.....
+000038e0: 6b04 731c 8801 7c00 6601 6900 7c01 a401  k.s...|.f.i.|...
+000038f0: 8e01 5300 7c00 6a02 8802 6400 8502 1900  ..S.|.j...d.....
+00003900: 8900 7403 8802 8301 4400 5d09 7d02 7404  ..t.....D.].}.t.
+00003910: a005 7c00 6402 6403 a103 7d00 7127 6402  ..|.d.d...}.q'd.
+00003920: 7d02 7404 a006 8800 a101 4400 5d54 7d03  }.t.......D.]T}.
+00003930: 8801 7c00 7c03 1900 6601 6900 7c01 a401  ..|.|...f.i.|...
+00003940: 8e01 7d04 8803 6404 6b02 7263 7c02 6402  ..}...d.k.rc|.d.
+00003950: 6b02 725e 7c04 6a02 7d05 7404 6a07 7408  k.r^|.j.}.t.j.t.
+00003960: 8800 8301 7408 7c04 6a02 8301 1700 7404  ....t.|.j.....t.
+00003970: 6a09 6405 8d02 7d06 7c04 7c06 7c03 3c00  j.d...}.|.|.|.<.
+00003980: 6e25 7c02 6402 6b02 7277 6406 6407 8400  n%|.d.k.rwd.d...
+00003990: 7c04 4400 8301 7d07 8700 6601 6408 6407  |.D...}...f.d.d.
+000039a0: 8408 7c04 4400 8301 7d06 6402 7d08 7c04  ..|.D...}.d.}.|.
+000039b0: 4400 5d0c 7d09 7c09 7c06 7c08 1900 7c03  D.].}.|.|.|...|.
+000039c0: 3c00 7c08 6404 3700 7d08 717b 7c02 6404  <.|.d.7.}.q{|.d.
+000039d0: 3700 7d02 7138 8803 6404 6b02 72a8 7404  7.}.q8..d.k.r.t.
+000039e0: a00a 7c06 a101 7d06 7403 7401 7c05 8301  ..|...}.t.t.|...
+000039f0: 8301 4400 5d09 7d02 7404 a005 7c06 6403  ..D.].}.t...|.d.
+00003a00: 6402 a103 7d06 719c 7c06 5300 6700 7d0a  d...}.q.|.S.g.}.
+00003a10: 6402 7d08 7c06 4400 5d22 7d09 7404 a00a  d.}.|.D.]"}.t...
+00003a20: 7c09 a101 7d09 7403 7401 7c07 7c08 1900  |...}.t.t.|.|...
+00003a30: 8301 8301 4400 5d09 7d02 7404 a005 7c09  ....D.].}.t...|.
+00003a40: 6403 6402 a103 7d09 71bd 7c0a a00b 7c09  d.d...}.q.|...|.
+00003a50: a101 0100 7c08 6404 3700 7d08 71ae 6700  ....|.d.7.}.q.g.
+00003a60: 7c0a a201 5200 5300 2909 4e72 3e00 0000  |...R.S.).Nr>...
+00003a70: 7201 0000 0072 4f00 0000 7229 0000 0072  r....rO...r)...r
+00003a80: 7f00 0000 6301 0000 0000 0000 0000 0000  ....c...........
+00003a90: 0002 0000 0003 0000 0053 0000 0073 1200  .........S...s..
+00003aa0: 0000 6700 7c00 5d05 7d01 7c01 6a00 9102  ..g.|.].}.|.j...
+00003ab0: 7102 5300 7205 0000 0029 0172 3e00 0000  q.S.r....).r>...
+00003ac0: a902 7209 0000 00da 017a 7205 0000 0072  ..r......zr....r
+00003ad0: 0500 0000 720d 0000 0072 0e00 0000 d601  ....r....r......
+00003ae0: 0000 7302 0000 0012 007a 2c6e 6473 7570  ..s......z,ndsup
+00003af0: 706f 7274 2e3c 6c6f 6361 6c73 3e2e 696e  port.<locals>.in
+00003b00: 6e65 722e 3c6c 6f63 616c 733e 2e3c 6c69  ner.<locals>.<li
+00003b10: 7374 636f 6d70 3e63 0100 0000 0000 0000  stcomp>c........
+00003b20: 0000 0000 0200 0000 0600 0000 1300 0000  ................
+00003b30: 732a 0000 0067 007c 005d 117d 0174 006a  s*...g.|.].}.t.j
+00003b40: 0174 0288 0083 0174 027c 016a 0383 0117  .t.....t.|.j....
+00003b50: 0074 006a 0464 008d 0291 0271 0253 0029  .t.j.d.....q.S.)
+00003b60: 0172 7f00 0000 2905 721a 0000 00da 0565  .r....).r......e
+00003b70: 6d70 7479 da04 6c69 7374 723e 0000 00da  mpty..listr>....
+00003b80: 0a63 6f6d 706c 6578 3132 3872 8d00 0000  .complex128r....
+00003b90: a901 da0f 7265 6665 7265 6e63 655f 7368  ....reference_sh
+00003ba0: 6170 6572 0500 0000 720d 0000 0072 0e00  aper....r....r..
+00003bb0: 0000 d701 0000 7302 0000 002a 0029 0cda  ......s....*.)..
+00003bc0: 0768 6173 6174 7472 7216 0000 0072 3e00  .hasattrr....r>.
+00003bd0: 0000 7215 0000 0072 1a00 0000 da08 6d6f  ..r....r......mo
+00003be0: 7665 6178 6973 da07 6e64 696e 6465 7872  veaxis..ndindexr
+00003bf0: 8f00 0000 7290 0000 0072 9100 0000 7244  ....r....r....rD
+00003c00: 0000 0072 4500 0000 290b da01 5872 1d00  ...rE...)...Xr..
+00003c10: 0000 720a 0000 0072 6e00 0000 da03 6f75  ..r....rn.....ou
+00003c20: 74da 096f 7574 5f73 6861 7065 da07 7265  t..out_shape..re
+00003c30: 7375 6c74 73da 0a6f 7574 5f73 6861 7065  sults..out_shape
+00003c40: 7372 2e00 0000 728e 0000 00da 0872 6573  sr....r......res
+00003c50: 756c 7473 32a9 03da 0466 756e 63da 0a6e  ults2....func..n
+00003c60: 5f69 6e70 5f61 7865 73da 0a6e 5f6f 7574  _inp_axes..n_out
+00003c70: 5f61 7267 7372 9200 0000 720d 0000 00da  _argsr....r.....
+00003c80: 0569 6e6e 6572 c101 0000 734a 0000 000a  .inner....sJ....
+00003c90: 0110 010e 0110 010e 020c 0210 0104 020e  ................
+00003ca0: 0114 0108 0108 0106 011e 010a 0108 020e  ................
+00003cb0: 0112 0104 0108 010c 010a 010a 0108 020a  ................
+00003cc0: 0110 0110 0104 0104 0204 0108 010a 0114  ................
+00003cd0: 0110 010a 010a 010a 017a 186e 6473 7570  .........z.ndsup
+00003ce0: 706f 7274 2e3c 6c6f 6361 6c73 3e2e 696e  port.<locals>.in
+00003cf0: 6e65 7272 0500 0000 2904 729e 0000 0072  nerr....).r....r
+00003d00: a000 0000 729f 0000 0072 a100 0000 7205  ....r....r....r.
+00003d10: 0000 0072 9d00 0000 720d 0000 00da 096e  ...r....r......n
+00003d20: 6473 7570 706f 7274 b101 0000 7304 0000  dsupport....s...
+00003d30: 0010 1004 2c72 a200 0000 2901 7204 0000  ....,r....).r...
+00003d40: 0029 0272 0400 0000 7221 0000 0029 024e  .).r....r!...).N
+00003d50: 723d 0000 0029 0146 2903 4672 3d00 0000  r=...).F).Fr=...
+00003d60: 5429 0272 2900 0000 728c 0000 0029 1272  T).r)...r....).r
+00003d70: 1200 0000 721a 0000 0072 1100 0000 7217  ....r....r....r.
+00003d80: 0000 00da 0c73 6369 7079 2e6c 696e 616c  .....scipy.linal
+00003d90: 6772 0200 0000 da0e 6e6a 6574 2e66 756e  gr......njet.fun
+00003da0: 6374 696f 6e73 7203 0000 0072 2000 0000  ctionsr....r ...
+00003db0: 723c 0000 0072 4e00 0000 7259 0000 0072  r<...rN...rY...r
+00003dc0: 6000 0000 7267 0000 0072 7600 0000 7288  `...rg...rv...r.
+00003dd0: 0000 0072 8b00 0000 72a2 0000 0072 0500  ...r....r....r..
+00003de0: 0000 7205 0000 0072 0500 0000 720d 0000  ..r....r....r...
+00003df0: 00da 083c 6d6f 6475 6c65 3e01 0000 0073  ...<module>....s
+00003e00: 1c00 0000 0803 0801 0c01 0c02 0a02 0a0f  ................
+00003e10: 0a2b 0855 0e35 0a2b 0a27 086b 0817 0e0f  .+.U.5.+.'.k....
```

### Comparing `lieops-0.2.1/lieops/linalg/__pycache__/matrix.cpython-310.pyc` & `lieops-0.2.2/lieops/linalg/similarity/__pycache__/symplectic.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.10, timestamp-based, .py timestamp: Wed Jan  4 21:02:22 2023 UTC, .py size: 6943 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 23% similar despite different names*

```diff
@@ -1,510 +1,539 @@
-00000000: 6f0d 0d0a 0000 0000 5ee9 b563 1f1b 0000  o.......^..c....
+00000000: 6f0d 0d0a 0000 0000 5959 c163 c431 0000  o.......YY.c.1..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0004 0000 0040 0000 0073 6400 0000 6400  .....@...sd...d.
-00000030: 6401 6c00 5a01 6400 6401 6c02 5a03 6415  d.l.Z.d.d.l.Z.d.
-00000040: 6403 6404 8401 5a04 6405 6505 6602 6406  d.d...Z.d.e.f.d.
-00000050: 6407 8404 5a06 6408 6409 8400 5a07 6416  d...Z.d.d...Z.d.
-00000060: 640a 6505 6602 640b 640c 8405 5a08 640d  d.e.f.d.d...Z.d.
-00000070: 640e 8400 5a09 640f 6410 8400 5a0a 6411  d...Z.d.d...Z.d.
-00000080: 6412 8400 5a0b 6413 6414 8400 5a0c 6401  d...Z.d.d...Z.d.
-00000090: 5300 2917 e900 0000 004e e79b 2ba1 869b  S.)......N..+...
-000000a0: 8406 3d63 0200 0000 0000 0000 0000 0000  ..=c............
-000000b0: 0200 0000 0600 0000 4300 0000 7320 0000  ........C...s ..
-000000c0: 0074 00a0 017c 00a1 017d 0074 00a0 0274  .t...|...}.t...t
-000000d0: 00a0 037c 007c 01a1 02a1 0101 0064 0053  ...|.|.......d.S
-000000e0: 00a9 014e 2904 da02 6d70 da06 6d61 7472  ...N)...mp..matr
-000000f0: 6978 da06 6e70 7269 6e74 da04 6368 6f70  ix..nprint..chop
-00000100: 2902 da01 4dda 0374 6f6c a900 720a 0000  )...M..tol..r...
-00000110: 00fa 2e2f 686f 6d65 2f6d 616c 7465 2f67  .../home/malte/g
-00000120: 6974 2f6c 6965 6f70 732f 6c69 656f 7073  it/lieops/lieops
-00000130: 2f6c 696e 616c 672f 6d61 7472 6978 2e70  /linalg/matrix.p
-00000140: 79da 0870 7269 6e74 6d61 7407 0000 0073  y..printmat....s
-00000150: 0400 0000 0a02 1601 720c 0000 00da 0364  ........r......d
-00000160: 696d 6301 0000 0000 0000 0000 0000 0004  imc.............
-00000170: 0000 0006 0000 0003 0000 0073 6c00 0000  ...........sl...
-00000180: 6401 8800 1400 7d01 6700 6700 0202 7d02  d.....}.g.g...}.
-00000190: 7d03 7400 8800 8301 4400 5d1f 8901 7c02  }.t.....D.]...|.
-000001a0: a001 8700 8701 6602 6402 6403 8408 7400  ......f.d.d...t.
-000001b0: 7c01 8301 4400 8301 a101 0100 7c03 a001  |...D.......|...
-000001c0: 8701 6601 6404 6403 8408 7400 7c01 8301  ..f.d.d...t.|...
-000001d0: 4400 8301 a101 0100 710d 7402 a003 7c02  D.......q.t...|.
-000001e0: 7c03 1700 a101 a004 a100 5300 2905 616c  |.........S.).al
-000001f0: 0100 000a 2020 2020 4372 6561 7465 2061  ....    Create a
-00000200: 2032 2a64 696d 2d73 7175 6172 6520 6d61   2*dim-square ma
-00000210: 7472 6978 204a 2c20 636f 7272 6573 706f  trix J, correspo
-00000220: 6e64 696e 6720 746f 2074 6865 2073 7461  nding to the sta
-00000230: 6e64 6172 6420 0a20 2020 2073 796d 706c  ndard .    sympl
-00000240: 6563 7469 6320 626c 6f63 6b2d 6d61 7472  ectic block-matr
-00000250: 6978 0a20 2020 200a 2020 2020 2020 2020  ix.    .        
-00000260: 2020 2020 202f 2020 3020 2020 3120 205c       /  0   1  \
-00000270: 0a20 2020 2020 2020 204a 203d 2020 7c20  .        J =  | 
-00000280: 2020 2020 2020 2020 7c0a 2020 2020 2020          |.      
-00000290: 2020 2020 2020 205c 202d 3120 2020 3020         \ -1   0 
-000002a0: 202f 0a20 2020 2020 2020 2020 2020 2020   /.             
-000002b0: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
-000002c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-000002d0: 2020 2064 696d 3a20 696e 740a 2020 2020     dim: int.    
-000002e0: 2020 2020 4469 6d65 6e73 696f 6e2f 3220      Dimension/2 
-000002f0: 6f66 2074 6865 206d 6174 7269 7820 746f  of the matrix to
-00000300: 2062 6520 636f 6e73 7472 7563 7465 642e   be constructed.
-00000310: 0a20 2020 2020 2020 200a 2020 2020 5265  .        .    Re
-00000320: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
-00000330: 2d0a 2020 2020 6c69 7374 0a20 2020 2020  -.    list.     
-00000340: 2020 204c 6973 7420 6f66 2063 6f6c 756d     List of colum
-00000350: 6e20 7665 6374 6f72 732e 0a20 2020 20e9  n vectors..    .
-00000360: 0200 0000 6301 0000 0000 0000 0000 0000  ....c...........
-00000370: 0002 0000 0005 0000 0013 0000 0073 2000  .............s .
-00000380: 0000 6700 7c00 5d0c 7d01 7c01 8801 8800  ..g.|.].}.|.....
-00000390: 1700 6b03 720c 6400 6e01 6401 9102 7102  ..k.r.d.n.d...q.
-000003a0: 5300 2902 7201 0000 00e9 ffff ffff 720a  S.).r.........r.
-000003b0: 0000 00a9 02da 022e 30da 0169 a902 720d  ........0..i..r.
-000003c0: 0000 00da 016b 720a 0000 0072 0b00 0000  .....kr....r....
-000003d0: da0a 3c6c 6973 7463 6f6d 703e 2200 0000  ..<listcomp>"...
-000003e0: f302 0000 0020 007a 1c63 7265 6174 655f  ..... .z.create_
-000003f0: 4a2e 3c6c 6f63 616c 733e 2e3c 6c69 7374  J.<locals>.<list
-00000400: 636f 6d70 3e63 0100 0000 0000 0000 0000  comp>c..........
-00000410: 0000 0200 0000 0400 0000 1300 0000 731c  ..............s.
-00000420: 0000 0067 007c 005d 0a7d 017c 0188 006b  ...g.|.].}.|...k
-00000430: 0372 0a64 006e 0164 0191 0271 0253 00a9  .r.d.n.d...q.S..
-00000440: 0272 0100 0000 e901 0000 0072 0a00 0000  .r.........r....
-00000450: 7210 0000 00a9 0172 1400 0000 720a 0000  r......r....r...
-00000460: 0072 0b00 0000 7215 0000 0023 0000 00f3  .r....r....#....
-00000470: 0200 0000 1c00 2905 da05 7261 6e67 65da  ......)...range.
-00000480: 0661 7070 656e 64da 026e 70da 0561 7272  .append..np..arr
-00000490: 6179 da09 7472 616e 7370 6f73 6529 0472  ay..transpose).r
-000004a0: 0d00 0000 da04 6469 6d32 da02 4a31 da02  ......dim2..J1..
-000004b0: 4a32 720a 0000 0072 1300 0000 720b 0000  J2r....r....r...
-000004c0: 00da 0863 7265 6174 655f 4a0c 0000 0073  ...create_J....s
-000004d0: 0c00 0000 0813 0a01 0c01 1e01 1e01 1201  ................
-000004e0: 7223 0000 0063 0100 0000 0000 0000 0000  r#...c..........
-000004f0: 0000 0500 0000 0500 0000 0300 0000 7396  ..............s.
-00000500: 0000 0074 0088 0183 0174 016b 0272 1688  ...t.....t.k.r..
-00000510: 0189 0087 0066 0164 0164 0284 0874 0264  .....f.d.d...t.d
-00000520: 0388 0014 0083 0144 0083 017d 016e 1b74  .......D...}.n.t
-00000530: 0388 0183 0189 0087 0166 0164 0464 0284  .........f.d.d..
-00000540: 0874 0288 0083 0144 0083 0187 0087 0166  .t.....D.......f
-00000550: 0264 0564 0284 0874 0288 0083 0144 0083  .d.d...t.....D..
-00000560: 0117 007d 0174 04a0 0588 0064 0314 0088  ...}.t.....d....
-00000570: 0064 0314 0067 02a1 017d 027c 0144 005d  .d...g...}.|.D.]
-00000580: 0a5c 027d 037d 0464 067c 027c 037c 0466  .\.}.}.d.|.|.|.f
-00000590: 023c 0071 3e7c 0253 0029 0775 1c07 0000  .<.q>|.S.).u....
-000005a0: 436f 6d70 7574 6520 6120 7472 616e 7366  Compute a transf
-000005b0: 6f72 6d61 7469 6f6e 206d 6174 7269 7820  ormation matrix 
-000005c0: 542c 2074 6f20 7472 616e 7366 6f72 6d20  T, to transform 
-000005d0: 6120 6769 7665 6e0a 2020 2020 2832 6e29  a given.    (2n)
-000005e0: 7828 326e 2920 6d61 7472 6978 204d 2c20  x(2n) matrix M, 
-000005f0: 7265 7072 6573 656e 7465 6420 696e 2028  represented in (
-00000600: 7131 2c20 7031 2c20 7132 2c20 7032 2c20  q1, p1, q2, p2, 
-00000610: 2e2e 2e2c 2071 6e2c 2070 6e29 2d63 6f6f  ..., qn, pn)-coo
-00000620: 7264 696e 6174 6573 2c20 696e 746f 0a20  rdinates, into. 
-00000630: 2020 2061 2028 7131 2c20 7132 2c20 2e2e     a (q1, q2, ..
-00000640: 2e2c 2071 6e2c 2070 312c 2070 322c 202e  ., qn, p1, p2, .
-00000650: 2e2e 2c20 706e 292d 7265 7072 6573 656e  .., pn)-represen
-00000660: 7461 7469 6f6e 2076 6961 0a20 2020 204d  tation via.    M
-00000670: 2720 3d20 545e 282d 3129 404d 4054 2e20  ' = T^(-1)@M@T. 
-00000680: 5420 7769 6c6c 2062 6520 6f72 7468 6f67  T will be orthog
-00000690: 6f6e 616c 2028 616e 6420 756e 6974 6172  onal (and unitar
-000006a0: 7929 2c20 692e 652e 2054 5e28 2d31 2920  y), i.e. T^(-1) 
-000006b0: 3d20 542e 7472 616e 7370 6f73 6528 292e  = T.transpose().
-000006c0: 0a20 2020 200a 2020 2020 5365 6520 616c  .    .    See al
-000006d0: 736f 2052 6566 732e 205b 312c 2032 5d20  so Refs. [1, 2] 
-000006e0: 6f72 2028 616c 7465 726e 6174 6976 656c  or (alternativel
-000006f0: 7929 2069 6e20 5265 662e 205b 335d 2c20  y) in Ref. [3], 
-00000700: 702e 2032 3932 2e20 496e 2070 6172 7469  p. 292. In parti
-00000710: 6375 6c61 722c 204d 0a20 2020 2069 7320  cular, M.    is 
-00000720: 6769 7665 6e20 696e 2074 6572 6d73 206f  given in terms o
-00000730: 6620 3278 3220 626c 6f63 6b20 6d61 7472  f 2x2 block matr
-00000740: 6963 6573 2c20 7468 656e 204d 2720 6973  ices, then M' is
-00000750: 2063 616c 6c65 6420 7468 6520 2765 7870   called the 'exp
-00000760: 616e 6469 6e67 2053 756d 2720 6f66 204d  anding Sum' of M
-00000770: 2e0a 2020 2020 0a20 2020 2050 6172 616d  ..    .    Param
-00000780: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
-00000790: 2d2d 2d2d 0a20 2020 2020 2020 200a 2020  ----.        .  
-000007a0: 2020 7061 6972 733a 2069 6e74 206f 7220    pairs: int or 
-000007b0: 6c69 7374 0a20 2020 2020 2020 2049 6620  list.        If 
-000007c0: 616e 2069 6e74 6567 6572 2069 7320 6769  an integer is gi
-000007d0: 7665 6e2c 2074 6865 6e20 6974 2069 7320  ven, then it is 
-000007e0: 6173 7375 6d65 6420 7468 6174 2074 6869  assumed that thi
-000007f0: 7320 696e 7465 6765 7220 6465 6e6f 7465  s integer denote
-00000800: 730a 2020 2020 2020 2020 7468 6520 6469  s.        the di
-00000810: 6d65 6e73 696f 6e20 6f66 2074 6865 2063  mension of the c
-00000820: 7572 7265 6e74 2070 726f 626c 656d 2e20  urrent problem. 
-00000830: 4120 7265 7370 6563 7469 7665 2073 7175  A respective squ
-00000840: 6172 6520 6d61 7472 6978 2054 0a20 2020  are matrix T.   
-00000850: 2020 2020 2028 6172 7261 792d 6c69 6b65       (array-like
-00000860: 2920 7769 6c6c 2062 6520 636f 6e73 7472  ) will be constr
-00000870: 7563 7465 642c 2061 7320 6465 7363 7269  ucted, as descri
-00000880: 6265 6420 6162 6f76 652e 0a20 2020 2020  bed above..     
-00000890: 2020 200a 2020 2020 2020 2020 4966 2061     .        If a
-000008a0: 206c 6973 7420 6973 2067 6976 656e 2c20   list is given, 
-000008b0: 7468 656e 2069 7420 6973 2061 7373 756d  then it is assum
-000008c0: 6564 2074 6861 7420 7468 6973 206c 6973  ed that this lis
-000008d0: 7420 636f 6e73 6973 7473 206f 660a 2020  t consists of.  
-000008e0: 2020 2020 2020 7475 706c 6573 2062 7920        tuples by 
-000008f0: 7768 6963 6820 6f6e 6520 6361 6e20 7477  which one can tw
-00000900: 6561 6b20 7468 6520 6f72 6465 7220 6f66  eak the order of
-00000910: 2074 6865 206f 7269 6769 6e61 6c20 636f   the original co
-00000920: 6f72 6469 6e61 7465 733a 0a20 2020 2020  ordinates:.     
-00000930: 2020 2049 6e20 7468 6973 2063 6173 6520     In this case 
-00000940: 7468 6520 6c69 7374 206d 7573 7420 756e  the list must un
-00000950: 616d 6269 676f 7573 6c79 2069 6465 6e74  ambigously ident
-00000960: 6966 7920 6561 6368 2070 6169 7220 2871  ify each pair (q
-00000970: 5f69 2c20 705f 6a29 2062 7920 6120 7370  _i, p_j) by a sp
-00000980: 6563 6966 6963 2074 7570 6c65 0a20 2020  ecific tuple.   
-00000990: 2020 2020 2028 692c 206a 2920 696e 2074       (i, j) in t
-000009a0: 6865 206c 6973 742e 2054 6865 206f 7574  he list. The out
-000009b0: 636f 6d65 2077 696c 6c20 6265 2061 6e20  come will be an 
-000009c0: 6f72 7468 6f67 6f6e 616c 2028 616e 6420  orthogonal (and 
-000009d0: 756e 6974 6172 7929 206d 6174 7269 7820  unitary) matrix 
-000009e0: 540a 2020 2020 2020 2020 7768 6963 6820  T.        which 
-000009f0: 7472 616e 7366 6f72 6d61 7469 6f6e 7320  transformations 
-00000a00: 7468 6520 636f 6f72 6469 6e61 7465 7320  the coordinates 
-00000a10: 2871 5f69 2c20 2e2e 2e2c 2070 5f6a 2c20  (q_i, ..., p_j, 
-00000a20: 2e2e 2e29 2069 6e74 6f20 0a20 2020 2020  ...) into .     
-00000a30: 2020 2028 715f 692c 202e 2e2e 2c20 715f     (q_i, ..., q_
-00000a40: 6e2c 2070 5f6a 2c20 2e2e 2e2c 2070 5f6e  n, p_j, ..., p_n
-00000a50: 292e 2048 6572 6279 2074 6865 206b 2774  ). Herby the k't
-00000a60: 6820 656c 656d 656e 7420 696e 2074 6865  h element in the
-00000a70: 206c 6973 7420 7769 6c6c 2062 6520 6361   list will be ca
-00000a80: 7374 2074 6f0a 2020 2020 2020 2020 706f  st to.        po
-00000a90: 7369 7469 6f6e 7320 6b2c 206b 202b 2064  sitions k, k + d
-00000aa0: 696d 2e0a 2020 2020 2020 2020 0a20 2020  im..        .   
-00000ab0: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
-00000ac0: 2d2d 2d2d 0a20 2020 206e 702e 6d61 7472  ----.    np.matr
-00000ad0: 6978 0a20 2020 2020 2020 204e 756d 7079  ix.        Numpy
-00000ae0: 206d 6174 7269 7820 5420 6465 6669 6e69   matrix T defini
-00000af0: 6e67 2074 6865 2061 666f 7265 6d65 6e74  ng the aforement
-00000b00: 696f 6e65 6420 7472 616e 7366 6f72 6d61  ioned transforma
-00000b10: 7469 6f6e 2e0a 2020 2020 2020 2020 0a20  tion..        . 
-00000b20: 2020 2052 6566 6572 656e 6365 2873 293a     Reference(s):
-00000b30: 0a20 2020 205b 315d 3a20 4d2e 2054 6974  .    [1]: M. Tit
-00000b40: 7a65 3a20 2253 7061 6365 2043 6861 7267  ze: "Space Charg
-00000b50: 6520 4d6f 6465 6c69 6e67 2061 7420 7468  e Modeling at th
-00000b60: 6520 496e 7465 6765 7220 5265 736f 6e61  e Integer Resona
-00000b70: 6e63 6573 2066 6f72 2074 6865 2043 4552  nces for the CER
-00000b80: 4e20 5053 2061 6e64 2053 5053 222c 2050  N PS and SPS", P
-00000b90: 6844 2054 6865 7369 7320 2832 3031 3929  hD Thesis (2019)
-00000ba0: 0a20 2020 205b 325d 3a20 4d2e 2054 6974  .    [2]: M. Tit
-00000bb0: 7a65 3a20 224f 6e20 656d 6974 7461 6e63  ze: "On emittanc
-00000bc0: 6520 616e 6420 6f70 7469 6373 2063 616c  e and optics cal
-00000bd0: 6375 6c61 7469 6f6e 2066 726f 6d20 7468  culation from th
-00000be0: 6520 7472 6163 6b69 6e67 2064 6174 6120  e tracking data 
-00000bf0: 696e 2070 6572 696f 6469 6320 6c61 7474  in periodic latt
-00000c00: 6963 6573 222c 2061 7258 6976 2e6f 7267  ices", arXiv.org
-00000c10: 2028 3230 3139 290a 2020 2020 5b33 5d3a   (2019).    [3]:
-00000c20: 2052 2e20 4a2e 2064 6520 6c61 2043 7275   R. J. de la Cru
-00000c30: 7a20 616e 6420 482e 2046 61c3 9f62 656e  z and H. Fa..ben
-00000c40: 6465 723a 2022 4f6e 2074 6865 2064 6961  der: "On the dia
-00000c50: 676f 6e61 6c69 7a61 6269 6c69 7479 206f  gonalizability o
-00000c60: 6620 6120 6d61 7472 6978 2062 7920 6120  f a matrix by a 
-00000c70: 7379 6d70 6c65 6374 6963 2065 7175 6976  symplectic equiv
-00000c80: 616c 656e 6365 2c20 7369 6d69 6c61 7269  alence, similari
-00000c90: 7479 206f 7220 636f 6e67 7275 656e 6365  ty or congruence
-00000ca0: 2074 7261 6e73 666f 726d 6174 696f 6e20   transformation 
-00000cb0: 2832 3031 3629 2e0a 2020 2020 6301 0000  (2016)..    c...
-00000cc0: 0000 0000 0000 0000 0002 0000 0006 0000  ................
-00000cd0: 0013 0000 0073 3800 0000 6700 7c00 5d18  .....s8...g.|.].
-00000ce0: 7d01 7c01 6400 1600 6401 6b02 7210 7c01  }.|.d...d.k.r.|.
-00000cf0: 7c01 6400 1a00 6602 6e09 7c01 8800 7c01  |.d...f.n.|...|.
-00000d00: 6402 1800 6400 1a00 1700 6602 9102 7102  d...d.....f...q.
-00000d10: 5300 2903 720e 0000 0072 0100 0000 7218  S.).r....r....r.
-00000d20: 0000 0072 0a00 0000 a902 7211 0000 00da  ...r......r.....
-00000d30: 016a a901 720d 0000 0072 0a00 0000 720b  .j..r....r....r.
-00000d40: 0000 0072 1500 0000 4c00 0000 7302 0000  ...r....L...s...
-00000d50: 0038 007a 2065 7870 616e 6469 6e67 5375  .8.z expandingSu
-00000d60: 6d2e 3c6c 6f63 616c 733e 2e3c 6c69 7374  m.<locals>.<list
-00000d70: 636f 6d70 3e72 0e00 0000 6301 0000 0000  comp>r....c.....
-00000d80: 0000 0000 0000 0002 0000 0004 0000 0013  ................
-00000d90: 0000 0073 1c00 0000 6700 7c00 5d0a 7d01  ...s....g.|.].}.
-00000da0: 8800 7c01 1900 6400 1900 7c01 6602 9102  ..|...d...|.f...
-00000db0: 7102 5300 a901 7201 0000 0072 0a00 0000  q.S...r....r....
-00000dc0: a902 7211 0000 0072 1400 0000 2901 da05  ..r....r....)...
-00000dd0: 7061 6972 7372 0a00 0000 720b 0000 0072  pairsr....r....r
-00000de0: 1500 0000 4f00 0000 721a 0000 0063 0100  ....O...r....c..
-00000df0: 0000 0000 0000 0000 0000 0200 0000 0500  ................
-00000e00: 0000 1300 0000 7320 0000 0067 007c 005d  ......s ...g.|.]
-00000e10: 0c7d 0188 017c 0119 0064 0019 007c 0188  .}...|...d...|..
-00000e20: 0017 0066 0291 0271 0253 0029 0172 1800  ...f...q.S.).r..
-00000e30: 0000 720a 0000 0072 2800 0000 a902 720d  ..r....r(.....r.
-00000e40: 0000 0072 2900 0000 720a 0000 0072 0b00  ...r)...r....r..
-00000e50: 0000 7215 0000 004f 0000 0072 1600 0000  ..r....O...r....
-00000e60: 7218 0000 0029 06da 0474 7970 65da 0369  r....)...type..i
-00000e70: 6e74 721b 0000 00da 036c 656e 721d 0000  ntr......lenr...
-00000e80: 00da 057a 6572 6f73 2905 7229 0000 005a  ...zeros).r)...Z
-00000e90: 0969 6e64 6963 6573 5f31 da01 5472 1200  .indices_1..Tr..
-00000ea0: 0000 7225 0000 0072 0a00 0000 722a 0000  ..r%...r....r*..
-00000eb0: 0072 0b00 0000 da0c 6578 7061 6e64 696e  .r......expandin
-00000ec0: 6753 756d 2600 0000 7312 0000 000c 2304  gSum&...s.....#.
-00000ed0: 011c 0208 022e 0116 020c 020e 0104 0172  ...............r
-00000ee0: 3000 0000 da08 7379 6d6d 6574 7279 6302  0.....symmetryc.
-00000ef0: 0000 0000 0000 0000 0000 000a 0000 0006  ................
-00000f00: 0000 000b 0000 0073 5c01 0000 7c01 6401  .......s\...|.d.
-00000f10: 7600 7306 4a00 8201 7400 7c00 a001 a100  v.s.J...t.|.....
-00000f20: 6402 6403 8d02 7d03 7c02 a002 6404 7c03  d.d...}.|...d.|.
-00000f30: 6405 1900 6406 1700 a102 8901 7c02 a002  d...d.......|...
-00000f40: 6407 7c03 6406 1900 6406 1700 a102 7d04  d.|.d...d.....}.
-00000f50: 7c01 6405 6b02 724c 8701 6601 6408 6409  |.d.k.rL..f.d.d.
-00000f60: 8408 7403 7c04 8301 4400 8301 7d05 7403  ..t.|...D...}.t.
-00000f70: 8801 8301 4400 5d15 7d06 7403 7c04 8301  ....D.].}.t.|...
-00000f80: 4400 5d0e 7d07 7c00 a002 7c06 7c07 6602  D.].}.|...|.|.f.
-00000f90: 6405 a102 7c05 7c07 1900 7c06 3c00 713b  d...|.|...|.<.q;
-00000fa0: 7135 6e5b 7400 8801 7c04 6702 8301 8900  q5n[t...|.g.....
-00000fb0: 8700 6601 640a 6409 8408 7403 8800 8301  ..f.d.d...t.....
-00000fc0: 4400 8301 7d05 7403 8800 8301 4400 5d45  D...}.t.....D.]E
-00000fd0: 7d06 7403 7c06 6406 1700 8301 4400 5d3c  }.t.|.d.....D.]<
-00000fe0: 7d07 7c00 a002 7c06 7c07 6602 6405 a102  }.|...|.|.f.d...
-00000ff0: 7d08 7c00 a002 7c07 7c06 6602 6405 a102  }.|...|.|.f.d...
-00001000: 7d09 7c08 6405 6b03 728b 7c09 6405 6b03  }.|.d.k.r.|.d.k.
-00001010: 728b 7c08 7c01 7c09 1400 6b02 738b 4a00  r.|.|.|...k.s.J.
-00001020: 8201 7c08 6405 6b02 7297 7c09 6405 6b03  ..|.d.k.r.|.d.k.
-00001030: 7297 7c01 7c09 1400 7d08 7c08 7c05 7c07  r.|.|...}.|.|.|.
-00001040: 1900 7c06 3c00 7c01 7c08 1400 7c05 7c06  ..|.<.|.|...|.|.
-00001050: 1900 7c07 3c00 7169 7161 7404 a005 7c05  ..|.<.qiqat...|.
-00001060: a101 a006 a100 5300 290b 6193 0200 000a  ......S.).a.....
-00001070: 2020 2020 4372 6561 7465 206d 6174 7269      Create matri
-00001080: 7820 6672 6f6d 2028 7370 6172 7365 2920  x from (sparse) 
-00001090: 6469 6374 2e0a 2020 2020 0a20 2020 2050  dict..    .    P
-000010a0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-000010b0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 204d 3a20  --------.    M: 
-000010c0: 6469 6374 0a20 2020 2020 2020 2054 6865  dict.        The
-000010d0: 2064 6963 7469 6f6e 6172 7920 6465 6669   dictionary defi
-000010e0: 6e69 6e67 2074 6865 2065 6e74 7269 6573  ning the entries
-000010f0: 204d 5f69 6a20 6f66 2074 6865 206d 6174   M_ij of the mat
-00001100: 7269 7820 696e 2074 6865 2066 6f72 6d3a  rix in the form:
-00001110: 0a20 2020 2020 2020 204d 5b28 692c 206a  .        M[(i, j
-00001120: 295d 203d 204d 5f69 6a0a 2020 2020 2020  )] = M_ij.      
-00001130: 2020 0a20 2020 206e 5f72 6f77 733a 2069    .    n_rows: i
-00001140: 6e74 2c20 6f70 7469 6f6e 616c 0a20 2020  nt, optional.   
-00001150: 2020 2020 2054 6865 206e 756d 6265 7220       The number 
-00001160: 6f66 2072 6f77 732e 0a0a 2020 2020 6e5f  of rows...    n_
-00001170: 636f 6c73 3a20 696e 742c 206f 7074 696f  cols: int, optio
-00001180: 6e61 6c0a 2020 2020 2020 2020 5468 6520  nal.        The 
-00001190: 6e75 6d62 6572 206f 6620 636f 6c75 6d6e  number of column
-000011a0: 732e 0a20 2020 200a 2020 2020 7379 6d6d  s..    .    symm
-000011b0: 6574 7279 3a20 696e 742c 206f 7074 696f  etry: int, optio
-000011c0: 6e61 6c0a 2020 2020 2020 2020 4966 2030  nal.        If 0
-000011d0: 2c20 6e6f 2073 796d 6d65 7472 7920 6973  , no symmetry is
-000011e0: 2061 7373 756d 6564 2028 6465 6661 756c   assumed (defaul
-000011f0: 7429 2e20 0a20 2020 2020 2020 2049 6620  t). .        If 
-00001200: 312c 206d 6174 7269 7820 6973 2061 7373  1, matrix is ass
-00001210: 756d 6564 2074 6f20 6265 2073 796d 6d65  umed to be symme
-00001220: 7472 6963 2e20 5265 7175 6972 6573 206e  tric. Requires n
-00001230: 5f72 6f77 7320 3d3d 206e 5f63 6f6c 732e  _rows == n_cols.
-00001240: 0a20 2020 2020 2020 2049 6620 2d31 2c20  .        If -1, 
-00001250: 6d61 7472 6978 2069 7320 6173 7375 6d65  matrix is assume
-00001260: 6420 746f 2062 6520 616e 7469 2d73 796d  d to be anti-sym
-00001270: 6d65 7472 6963 2e20 5265 7175 6972 6573  metric. Requires
-00001280: 206e 5f72 6f77 7320 3d3d 206e 5f63 6f6c   n_rows == n_col
-00001290: 732e 0a20 2020 2020 2020 200a 2020 2020  s..        .    
-000012a0: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
-000012b0: 2d2d 2d0a 2020 2020 413a 206e 6461 7272  ---.    A: ndarr
-000012c0: 6179 0a20 2020 2020 2020 2041 206e 756d  ay.        A num
-000012d0: 7079 206e 6461 7272 6179 2072 6570 7265  py ndarray repre
-000012e0: 7365 6e74 696e 6720 7468 6520 7265 7175  senting the requ
-000012f0: 6573 7465 6420 6d61 7472 6978 2e0a 2020  ested matrix..  
-00001300: 2020 2903 720f 0000 0072 0100 0000 7218    ).r....r....r.
-00001310: 0000 0029 0272 0100 0000 7201 0000 0029  ...).r....r....)
-00001320: 01da 0764 6566 6175 6c74 da06 6e5f 726f  ...default..n_ro
-00001330: 7773 7201 0000 0072 1800 0000 da06 6e5f  wsr....r......n_
-00001340: 636f 6c73 6301 0000 0000 0000 0000 0000  colsc...........
-00001350: 0002 0000 0004 0000 0013 0000 00f3 1600  ................
-00001360: 0000 6700 7c00 5d07 7d01 6400 6701 8800  ..g.|.].}.d.g...
-00001370: 1400 9102 7102 5300 7227 0000 0072 0a00  ....q.S.r'...r..
-00001380: 0000 7228 0000 0029 0172 3300 0000 720a  ..r(...).r3...r.
-00001390: 0000 0072 0b00 0000 7215 0000 0079 0000  ...r....r....y..
-000013a0: 00f3 0200 0000 1600 7a24 6d61 7472 6978  ........z$matrix
-000013b0: 5f66 726f 6d5f 6469 6374 2e3c 6c6f 6361  _from_dict.<loca
-000013c0: 6c73 3e2e 3c6c 6973 7463 6f6d 703e 6301  ls>.<listcomp>c.
-000013d0: 0000 0000 0000 0000 0000 0002 0000 0004  ................
-000013e0: 0000 0013 0000 0072 3500 0000 7227 0000  .......r5...r'..
-000013f0: 0072 0a00 0000 7228 0000 0072 2600 0000  .r....r(...r&...
-00001400: 720a 0000 0072 0b00 0000 7215 0000 007f  r....r....r.....
-00001410: 0000 0072 3600 0000 2907 da03 6d61 78da  ...r6...)...max.
-00001420: 046b 6579 73da 0367 6574 721b 0000 0072  .keys..getr....r
-00001430: 1d00 0000 721e 0000 0072 1f00 0000 290a  ....r....r....).
-00001440: 7208 0000 0072 3100 0000 da06 6b77 6172  r....r1.....kwar
-00001450: 6773 5a0a 6469 6374 5f73 6861 7065 7234  gsZ.dict_shaper4
-00001460: 0000 00da 036d 6174 7212 0000 0072 2500  .....matr....r%.
-00001470: 0000 5a03 6869 6a5a 0368 6a69 720a 0000  ..Z.hijZ.hjir...
-00001480: 0029 0272 0d00 0000 7233 0000 0072 0b00  .).r....r3...r..
-00001490: 0000 da10 6d61 7472 6978 5f66 726f 6d5f  ....matrix_from_
-000014a0: 6469 6374 5700 0000 7332 0000 000c 1a10  dictW...s2......
-000014b0: 0214 0114 0108 0316 010c 010c 011a 0102  ................
-000014c0: ff02 ff0c 0416 010c 0110 0110 0110 0110  ................
-000014d0: 0110 0110 0108 010c 0212 0102 f70e 0a72  ...............r
-000014e0: 3c00 0000 6301 0000 0000 0000 0000 0000  <...c...........
-000014f0: 0001 0000 0006 0000 0003 0000 0073 2200  .............s".
-00001500: 0000 7400 a001 8700 6601 6401 6402 8408  ..t.....f.d.d...
-00001510: 7402 8800 6a03 6403 1900 8301 4400 8301  t...j.d.....D...
-00001520: a101 5300 2904 7a48 0a20 2020 204d 6170  ..S.).zH.    Map
-00001530: 2061 2067 6976 656e 204e 784e 2d6d 6174   a given NxN-mat
-00001540: 7269 7820 746f 2061 2076 6563 746f 722c  rix to a vector,
-00001550: 2062 7920 636f 6e63 6174 656e 6174 696e   by concatenatin
-00001560: 6720 6974 7320 726f 7773 2e0a 2020 2020  g its rows..    
-00001570: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
-00001580: 0006 0000 0013 0000 0073 1c00 0000 6700  .........s....g.
-00001590: 7c00 5d0a 7d01 8800 7c01 6400 6400 8502  |.].}...|.d.d...
-000015a0: 6602 1900 9102 7102 5300 7203 0000 0072  f.....q.S.r....r
-000015b0: 0a00 0000 7228 0000 00a9 0172 3b00 0000  ....r(.....r;...
-000015c0: 720a 0000 0072 0b00 0000 7215 0000 0091  r....r....r.....
-000015d0: 0000 0072 1a00 0000 7a1a 7665 636d 6174  ...r....z.vecmat
-000015e0: 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973 7463  .<locals>.<listc
-000015f0: 6f6d 703e 7201 0000 0029 0472 1d00 0000  omp>r....).r....
-00001600: da0b 636f 6e63 6174 656e 6174 6572 1b00  ..concatenater..
-00001610: 0000 da05 7368 6170 6572 3d00 0000 720a  ....shaper=...r.
-00001620: 0000 0072 3d00 0000 720b 0000 00da 0676  ...r=...r......v
-00001630: 6563 6d61 748d 0000 0073 0200 0000 2204  ecmat....s....".
-00001640: 7240 0000 0063 0100 0000 0000 0000 0000  r@...c..........
-00001650: 0000 0200 0000 0500 0000 0300 0000 734e  ..............sN
-00001660: 0000 0074 0088 0183 017d 0174 01a0 027c  ...t.....}.t...|
-00001670: 01a1 0164 0116 0064 026b 0273 114a 0064  ...d...d.k.s.J.d
-00001680: 0383 0182 0174 0374 01a0 027c 01a1 0183  .....t.t...|....
-00001690: 0189 0074 01a0 0487 0087 0166 0264 0464  ...t.......f.d.d
-000016a0: 0584 0874 0588 0083 0144 0083 01a1 0153  ...t.....D.....S
-000016b0: 0029 067a 700a 2020 2020 4d61 7020 6120  .).zp.    Map a 
-000016c0: 6769 7665 6e20 7665 6374 6f72 206f 6620  given vector of 
-000016d0: 6c65 6e67 7468 204e 2a2a 3220 746f 2061  length N**2 to a
-000016e0: 6e20 4e78 4e20 6d61 7472 6978 2e20 5468  n NxN matrix. Th
-000016f0: 6973 206d 6170 2069 7320 7468 650a 2020  is map is the.  
-00001700: 2020 696e 7665 7273 6520 6f66 2074 6865    inverse of the
-00001710: 2076 6563 6d61 7420 726f 7574 696e 652e   vecmat routine.
-00001720: 0a20 2020 2072 1800 0000 7201 0000 007a  .    r....r....z
-00001730: 3756 6563 746f 7220 646f 6573 206e 6f74  7Vector does not
-00001740: 2061 7070 6561 7220 746f 206f 7269 6769   appear to origi
-00001750: 6e61 7465 2066 726f 6d20 7371 7561 7265  nate from square
-00001760: 206d 6174 7269 782e 6301 0000 0000 0000   matrix.c.......
-00001770: 0000 0000 0001 0000 0005 0000 0013 0000  ................
-00001780: 0073 2600 0000 6700 7c00 5d0f 8900 8700  .s&...g.|.].....
-00001790: 8701 8702 6603 6400 6401 8408 7400 8801  ....f.d.d...t...
-000017a0: 8301 4400 8301 9102 7102 5300 2902 6301  ..D.....q.S.).c.
-000017b0: 0000 0000 0000 0000 0000 0002 0000 0006  ................
-000017c0: 0000 0013 0000 0073 1c00 0000 6700 7c00  .......s....g.|.
-000017d0: 5d0a 7d01 8802 7c01 8800 8801 1400 1700  ].}...|.........
-000017e0: 1900 9102 7102 5300 720a 0000 0072 0a00  ....q.S.r....r..
-000017f0: 0000 7224 0000 0029 0372 1400 0000 da01  ..r$...).r......
-00001800: 6dda 0376 6563 720a 0000 0072 0b00 0000  m..vecr....r....
-00001810: 7215 0000 009b 0000 0072 1a00 0000 7a25  r........r....z%
-00001820: 6d61 7476 6563 2e3c 6c6f 6361 6c73 3e2e  matvec.<locals>.
-00001830: 3c6c 6973 7463 6f6d 703e 2e3c 6c69 7374  <listcomp>.<list
-00001840: 636f 6d70 3e29 0172 1b00 0000 2901 7211  comp>).r....).r.
-00001850: 0000 00a9 0272 4100 0000 7242 0000 0072  .....rA...rB...r
-00001860: 1900 0000 720b 0000 0072 1500 0000 9b00  ....r....r......
-00001870: 0000 7302 0000 0026 007a 1a6d 6174 7665  ..s....&.z.matve
-00001880: 632e 3c6c 6f63 616c 733e 2e3c 6c69 7374  c.<locals>.<list
-00001890: 636f 6d70 3e29 0672 2d00 0000 721d 0000  comp>).r-...r...
-000018a0: 00da 0473 7172 7472 2c00 0000 721e 0000  ...sqrtr,...r...
-000018b0: 0072 1b00 0000 2902 7242 0000 00da 016e  .r....).rB.....n
-000018c0: 720a 0000 0072 4300 0000 720b 0000 00da  r....rC...r.....
-000018d0: 066d 6174 7665 6393 0000 0073 0800 0000  .matvec....s....
-000018e0: 0805 1a01 0e01 1e01 7246 0000 0063 0100  ........rF...c..
-000018f0: 0000 0000 0000 0000 0000 0a00 0000 0700  ................
-00001900: 0000 4300 0000 73c2 0000 007c 006a 0064  ..C...s....|.j.d
-00001910: 0119 007c 006a 0064 0219 006b 0273 0e4a  ...|.j.d...k.s.J
-00001920: 0064 0383 0182 017c 006a 0064 0119 007d  .d.....|.j.d...}
-00001930: 0164 0464 0584 007d 0274 016a 027c 0164  .d.d...}.t.j.|.d
-00001940: 0613 007c 0164 0613 0067 0274 016a 0364  ...|.d...g.t.j.d
-00001950: 078d 027d 0374 047c 0164 0613 0083 0144  ...}.t.|.d.....D
-00001960: 005d 337d 0474 057c 047c 0183 025c 027d  .]3}.t.|.|...\.}
-00001970: 057d 0674 047c 0164 0613 0083 0144 005d  .}.t.|.d.....D.]
-00001980: 237d 0774 057c 077c 0183 025c 027d 087d  #}.t.|.|...\.}.}
-00001990: 097c 007c 087c 0566 0219 007c 027c 067c  .|.|.|.f...|.|.|
-000019a0: 0983 0214 007c 027c 057c 0883 027c 007c  .....|.|.|...|.|
-000019b0: 067c 0966 0219 0014 0018 007c 037c 077c  .|.f.......|.|.|
-000019c0: 0466 023c 0071 3a71 2b7c 0353 0029 087a  .f.<.q:q+|.S.).z
-000019d0: 6e0a 2020 2020 4d61 7020 6120 6769 7665  n.    Map a give
-000019e0: 6e20 4e78 4e2d 6d61 7472 6978 2074 6f20  n NxN-matrix to 
-000019f0: 6974 7320 6164 6a6f 696e 7420 7265 7072  its adjoint repr
-00001a00: 6573 656e 7461 7469 6f6e 2077 6974 6820  esentation with 
-00001a10: 7265 7370 6563 7420 746f 2074 6865 2076  respect to the v
-00001a20: 6563 6d61 7420 616e 6420 6d61 7476 6563  ecmat and matvec
-00001a30: 2072 6f75 7469 6e65 732e 0a20 2020 2072   routines..    r
-00001a40: 0100 0000 7218 0000 007a 124d 6174 7269  ....r....z.Matri
-00001a50: 7820 6e6f 7420 7371 7561 7265 2e63 0000  x not square.c..
-00001a60: 0000 0000 0000 0000 0000 0100 0000 0300  ................
-00001a70: 0000 5700 0000 7318 0000 007c 0064 0119  ..W...s....|.d..
-00001a80: 007c 0064 0219 006b 0272 0a64 0253 0064  .|.d...k.r.d.S.d
-00001a90: 0153 0029 034e 7201 0000 0072 1800 0000  .S.).Nr....r....
-00001aa0: 720a 0000 0029 01da 017a 720a 0000 0072  r....)...zr....r
-00001ab0: 0a00 0000 720b 0000 00da 083c 6c61 6d62  ....r......<lamb
-00001ac0: 6461 3ea3 0000 0073 0200 0000 1800 7a19  da>....s......z.
-00001ad0: 6164 6a6f 696e 742e 3c6c 6f63 616c 733e  adjoint.<locals>
-00001ae0: 2e3c 6c61 6d62 6461 3e72 0e00 0000 2901  .<lambda>r....).
-00001af0: da05 6474 7970 6529 0672 3f00 0000 721d  ..dtype).r?...r.
-00001b00: 0000 0072 2e00 0000 da0a 636f 6d70 6c65  ...r......comple
-00001b10: 7831 3238 721b 0000 00da 0664 6976 6d6f  x128r......divmo
-00001b20: 6429 0a72 3b00 0000 7245 0000 00da 0564  d).r;...rE.....d
-00001b30: 656c 7461 da06 7265 7375 6c74 da01 75da  elta..result..u.
-00001b40: 0561 6c70 6861 da04 6265 7461 da01 7672  .alpha..beta..vr
-00001b50: 1200 0000 7225 0000 0072 0a00 0000 720a  ....r%...r....r.
-00001b60: 0000 0072 0b00 0000 da07 6164 6a6f 696e  ...r......adjoin
-00001b70: 749d 0000 0073 1600 0000 1c04 0a01 0801  t....s..........
-00001b80: 1c01 1001 0e01 1001 0e01 3601 02fe 0403  ..........6.....
-00001b90: 7252 0000 0063 0200 0000 0000 0000 0000  rR...c..........
-00001ba0: 0000 0700 0000 0600 0000 0b00 0000 73dc  ..............s.
-00001bb0: 0000 007c 0064 0116 0064 026b 0273 084a  ...|.d...d.k.s.J
-00001bc0: 0082 017c 0164 036b 0272 1174 00a0 0164  ...|.d.k.r.t...d
-00001bd0: 01a1 0189 027c 0164 046b 0272 2664 057c  .....|.d.k.r&d.|
-00001be0: 02a0 02a1 0076 0072 217c 0264 0519 0074  .....v.r!|.d...t
-00001bf0: 036a 035f 0474 03a0 0164 01a1 0189 0267  .j._.t...d.....g
-00001c00: 0067 0002 027d 037d 047c 0064 011a 007d  .g...}.}.|.d...}
-00001c10: 0574 057c 0583 0144 005d 2689 0088 007c  .t.|...D.]&....|
-00001c20: 0517 0089 017c 03a0 0687 0087 0187 0266  .....|.........f
-00001c30: 0364 0664 0784 0874 057c 0083 0144 0083  .d.d...t.|...D..
-00001c40: 01a1 0101 007c 04a0 0687 0087 0187 0266  .....|.........f
-00001c50: 0364 0864 0784 0874 057c 0083 0144 0083  .d.d...t.|...D..
-00001c60: 01a1 0101 0071 3374 00a0 077c 037c 0417  .....q3t...|.|..
-00001c70: 00a1 01a0 08a1 007d 067c 0164 046b 0272  .......}.|.d.k.r
-00001c80: 6c74 03a0 097c 06a1 017d 067c 0653 0029  lt...|...}.|.S.)
-00001c90: 097a 930a 2020 2020 4372 6561 7465 2061  .z..    Create a
-00001ca0: 2075 6e69 7461 7279 206d 6174 7269 782c   unitary matrix,
-00001cb0: 206d 6170 7069 6e67 2028 702c 2071 292d   mapping (p, q)-
-00001cc0: 636f 6f72 6469 6e61 7465 7320 746f 2028  coordinates to (
-00001cd0: 7869 2c20 6574 6129 2d63 6f6f 7264 696e  xi, eta)-coordin
-00001ce0: 6174 6573 2076 6961 0a20 2020 2078 6920  ates via.    xi 
-00001cf0: 3d20 2871 202b 2031 6a2a 7029 2f73 7172  = (q + 1j*p)/sqr
-00001d00: 7428 3229 0a20 2020 2065 7461 203d 2028  t(2).    eta = (
-00001d10: 7120 2d20 316a 2a70 292f 7371 7274 2832  q - 1j*p)/sqrt(2
-00001d20: 290a 2020 2020 720e 0000 0072 0100 0000  ).    r....r....
-00001d30: da05 6e75 6d70 79da 066d 706d 6174 68da  ..numpy..mpmath.
-00001d40: 0364 7073 6301 0000 0000 0000 0000 0000  .dpsc...........
-00001d50: 0002 0000 0004 0000 0013 0000 0073 2800  .............s(.
-00001d60: 0000 6700 7c00 5d10 7d01 7c01 8800 6b03  ..g.|.].}.|...k.
-00001d70: 720e 7c01 8801 6b03 720e 6400 6e03 6401  r.|...k.r.d.n.d.
-00001d80: 8802 1b00 9102 7102 5300 7217 0000 0072  ......q.S.r....r
-00001d90: 0a00 0000 7210 0000 00a9 0372 1400 0000  ....r......r....
-00001da0: da02 6b32 da05 7371 7274 3272 0a00 0000  ..k2..sqrt2r....
-00001db0: 720b 0000 0072 1500 0000 bf00 0000 7302  r....r........s.
-00001dc0: 0000 0028 007a 2363 7265 6174 655f 7071  ...(.z#create_pq
-00001dd0: 3278 6965 7461 2e3c 6c6f 6361 6c73 3e2e  2xieta.<locals>.
-00001de0: 3c6c 6973 7463 6f6d 703e 6301 0000 0000  <listcomp>c.....
-00001df0: 0000 0000 0000 0002 0000 0004 0000 0013  ................
-00001e00: 0000 0073 4400 0000 6700 7c00 5d1e 7d01  ...sD...g.|.].}.
-00001e10: 7c01 8800 6b03 720e 7c01 8801 6b03 720e  |...k.r.|...k.r.
-00001e20: 6400 6e11 7c01 8800 6b02 7216 6401 8802  d.n.|...k.r.d...
-00001e30: 1b00 6e09 7c01 8801 6b02 721e 6402 8802  ..n.|...k.r.d...
-00001e40: 1b00 6e01 6400 9102 7102 5300 2903 7201  ..n.d...q.S.).r.
-00001e50: 0000 0079 0000 0000 0000 0000 0000 0000  ...y............
-00001e60: 0000 f03f 7900 0000 0000 0000 8000 0000  ...?y...........
-00001e70: 0000 00f0 bf72 0a00 0000 7210 0000 0072  .....r....r....r
-00001e80: 5600 0000 720a 0000 0072 0b00 0000 7215  V...r....r....r.
-00001e90: 0000 00c0 0000 0073 0200 0000 4400 290a  .......s....D.).
-00001ea0: 721d 0000 0072 4400 0000 7238 0000 0072  r....rD...r8...r
-00001eb0: 0400 0000 7255 0000 0072 1b00 0000 721c  ....rU...r....r.
-00001ec0: 0000 0072 1e00 0000 721f 0000 0072 0500  ...r....r....r..
-00001ed0: 0000 2907 720d 0000 00da 0463 6f64 6572  ..).r......coder
-00001ee0: 3a00 0000 5a02 5531 da02 5532 5a08 6469  :...Z.U1..U2Z.di
-00001ef0: 6d5f 6861 6c66 da03 6f75 7472 0a00 0000  m_half..outr....
-00001f00: 7256 0000 0072 0b00 0000 da0f 6372 6561  rV...r......crea
-00001f10: 7465 5f70 7132 7869 6574 61ac 0000 0073  te_pq2xieta....s
-00001f20: 2200 0000 1006 0802 0a01 0801 0c01 0c01  "...............
-00001f30: 0a01 0a02 0801 0c01 0801 2001 2201 1202  .......... ."...
-00001f40: 0801 0a01 0401 725c 0000 0029 0172 0200  ......r\...).r..
-00001f50: 0000 7227 0000 0029 0d72 5300 0000 721d  ..r'...).rS...r.
-00001f60: 0000 0072 5400 0000 7204 0000 0072 0c00  ...rT...r....r..
-00001f70: 0000 722c 0000 0072 2300 0000 7230 0000  ..r,...r#...r0..
-00001f80: 0072 3c00 0000 7240 0000 0072 4600 0000  .r<...r@...rF...
-00001f90: 7252 0000 0072 5c00 0000 720a 0000 0072  rR...r\...r....r
-00001fa0: 0a00 0000 720a 0000 0072 0b00 0000 da08  ....r....r......
-00001fb0: 3c6d 6f64 756c 653e 0100 0000 7314 0000  <module>....s...
-00001fc0: 0008 0308 010a 020e 0508 1a10 3108 3608  ............1.6.
-00001fd0: 0608 0a0c 0f                             .....
+00000020: 0003 0000 0040 0000 0073 6e00 0000 6400  .....@...sn...d.
+00000030: 6401 6c00 5a01 6400 6402 6c02 6d03 5a03  d.l.Z.d.d.l.m.Z.
+00000040: 0100 6400 6403 6c04 6d05 5a05 0100 6400  ..d.d.l.m.Z...d.
+00000050: 6404 6c06 6d07 5a07 0100 6400 6405 6c08  d.l.m.Z...d.d.l.
+00000060: 6d09 5a09 0100 6400 6406 6c0a 6d0b 5a0b  m.Z...d.d.l.m.Z.
+00000070: 0100 0900 6407 6408 8400 5a0c 6410 6409  ....d.d...Z.d.d.
+00000080: 640a 8401 5a0d 640b 640c 8400 5a0e 6411  d...Z.d.d...Z.d.
+00000090: 640e 640f 8401 5a0f 6401 5300 2912 e900  d.d...Z.d.S.)...
+000000a0: 0000 004e 2901 da04 6569 6773 2901 da03  ...N)...eigs)...
+000000b0: 6569 6729 01da 0863 7265 6174 655f 4a29  eig)...create_J)
+000000c0: 01da 0d69 6465 6e74 6966 7950 6169 7273  ...identifyPairs
+000000d0: 2901 da09 7369 6d75 6c64 6961 6763 0100  )...simuldiagc..
+000000e0: 0000 0000 0000 0000 0000 0300 0000 0600  ................
+000000f0: 0000 4300 0000 7360 0000 0074 006a 017c  ..C...s`...t.j.|
+00000100: 0074 006a 0264 018d 027d 0074 006a 03a0  .t.j.d...}.t.j..
+00000110: 047c 00a1 017d 017c 0164 026b 0473 144a  .|...}.|.d.k.s.J
+00000120: 0082 017c 007c 011b 007d 0274 00a0 017c  ...|.|...}.t...|
+00000130: 0264 0219 007c 0264 0319 00a0 05a1 000b  .d...|.d........
+00000140: 0067 027c 0264 0319 007c 0264 0219 00a0  .g.|.d...|.d....
+00000150: 05a1 0067 0267 02a1 0153 0029 044e a901  ...g.g...S.).N..
+00000160: da05 6474 7970 6572 0100 0000 e901 0000  ..dtyper........
+00000170: 0029 06da 026e 70da 0561 7272 6179 da0a  .)...np..array..
+00000180: 636f 6d70 6c65 7831 3238 da06 6c69 6e61  complex128..lina
+00000190: 6c67 da04 6e6f 726d da04 636f 6e6a 2903  lg..norm..conj).
+000001a0: da01 75da 066e 6f72 6d5f 75da 0176 a900  ..u..norm_u..v..
+000001b0: 7213 0000 00fa 642f 686f 6d65 2f6d 616c  r.....d/home/mal
+000001c0: 7465 2f6d 696e 6963 6f6e 6461 332f 656e  te/miniconda3/en
+000001d0: 7673 2f77 6f72 6b2f 6c69 622f 7079 7468  vs/work/lib/pyth
+000001e0: 6f6e 332e 3130 2f73 6974 652d 7061 636b  on3.10/site-pack
+000001f0: 6167 6573 2f6c 6965 6f70 732f 6c69 6e61  ages/lieops/lina
+00000200: 6c67 2f73 696d 696c 6172 6974 792f 7379  lg/similarity/sy
+00000210: 6d70 6c65 6374 6963 2e70 79da 066c 656d  mplectic.py..lem
+00000220: 6d61 3911 0000 0073 0a00 0000 1001 0c01  ma9....s........
+00000230: 0c01 0801 3006 7215 0000 0063 0200 0000  ....0.r....c....
+00000240: 0000 0000 0000 0000 1000 0000 0700 0000  ................
+00000250: 0300 0000 733a 0200 0074 006a 017c 0074  ....s:...t.j.|.t
+00000260: 006a 0264 018d 027d 0074 006a 03a0 047c  .j.d...}.t.j...|
+00000270: 00a1 017d 027c 0264 026b 0473 144a 0082  ...}.|.d.k.s.J..
+00000280: 017c 007c 021b 007d 0374 057c 0083 017d  .|.|...}.t.|...}
+00000290: 047c 0464 0316 0064 026b 0273 244a 0082  .|.d...d.k.s$J..
+000002a0: 017c 0464 031a 0089 0074 006a 067c 047c  .|.d.....t.j.|.|
+000002b0: 0467 0274 006a 0264 018d 027d 0574 0788  .g.t.j.d...}.t..
+000002c0: 0083 0144 005d 5b7d 067c 037c 0619 007c  ...D.][}.|.|...|
+000002d0: 037c 0688 0017 0019 0067 027d 0774 006a  .|.......g.}.t.j
+000002e0: 03a0 047c 07a1 0164 026b 0372 6474 087c  ...|...d.k.rdt.|
+000002f0: 0783 017d 0874 00a0 017c 0864 0419 007c  ...}.t...|.d...|
+00000300: 0864 0519 000b 0067 027c 0864 0619 000b  .d.....g.|.d....
+00000310: 007c 0864 0719 0067 0267 02a1 017d 096e  .|.d...g.g...}.n
+00000320: 0574 00a0 0964 03a1 017d 097c 0964 0719  .t...d...}.|.d..
+00000330: 007c 057c 067c 0666 023c 007c 0964 0519  .|.|.|.f.<.|.d..
+00000340: 007c 057c 067c 0688 0017 0066 023c 007c  .|.|.|.....f.<.|
+00000350: 0964 0619 007c 057c 0688 0017 007c 0666  .d...|.|.....|.f
+00000360: 023c 007c 0964 0419 007c 057c 0688 0017  .<.|.d...|.|....
+00000370: 007c 0688 0017 0066 023c 0071 367c 057c  .|.....f.<.q6|.|
+00000380: 0310 0089 0288 0164 026b 0472 c974 0a74  .......d.k.r.t.t
+00000390: 006a 03a0 0488 02a1 0164 0818 0083 0188  .j.......d......
+000003a0: 016b 0073 a84a 0082 0174 0b87 0087 0187  .k.s.J...t......
+000003b0: 0266 0364 0964 0a84 0874 0788 0083 0144  .f.d.d...t.....D
+000003c0: 0083 0183 0173 b94a 0082 0174 0b87 0187  .....s.J...t....
+000003d0: 0266 0264 0b64 0a84 0874 077c 0483 0144  .f.d.d...t.|...D
+000003e0: 0083 0183 0173 c94a 0082 0188 0264 0c88  .....s.J.....d..
+000003f0: 0085 0219 007d 0a7c 0aa0 0ca1 00a0 0d88  .....}.|........
+00000400: 0064 08a1 027d 0b7c 0b64 0705 0019 0064  .d...}.|.d.....d
+00000410: 0838 0003 003c 0074 006a 03a0 047c 0ba1  .8...<.t.j...|..
+00000420: 017d 0c7c 0c64 026b 0472 fd7c 0b7c 0c1b  .}.|.d.k.r.|.|..
+00000430: 007d 0b74 00a0 0988 00a1 0164 037c 0b14  .}.t.......d.|..
+00000440: 007c 0ba0 0ea1 00a0 0fa1 0010 0018 007d  .|.............}
+00000450: 0d6e 0574 00a0 0988 00a1 017d 0d74 00a0  .n.t.......}.t..
+00000460: 067c 0d6a 10a1 017d 0e74 00a0 117c 0d7c  .|.j...}.t...|.|
+00000470: 0e67 027c 0e7c 0da0 0fa1 0067 0267 02a1  .g.|.|.....g.g..
+00000480: 017d 0f7c 0f7c 0510 00a0 0ea1 00a0 0fa1  .}.|.|..........
+00000490: 0053 0029 0d61 4601 0000 0a20 2020 2046  .S.).aF....    F
+000004a0: 6f72 2065 7665 7279 2063 6f6d 706c 6578  or every complex
+000004b0: 2076 6563 746f 7220 7520 636f 6e73 7472   vector u constr
+000004c0: 7563 7420 6120 756e 6974 6172 7920 616e  uct a unitary an
+000004d0: 6420 7379 6d70 6c65 6374 6963 206d 6174  d symplectic mat
+000004e0: 7269 7820 5520 736f 2074 6861 7420 5528  rix U so that U(
+000004f0: 655f 3129 203d 2075 2f7c 757c 2068 6f6c  e_1) = u/|u| hol
+00000500: 6473 2e0a 2020 2020 0a20 2020 2050 6172  ds..    .    Par
+00000510: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00000520: 2d2d 2d2d 2d2d 0a20 2020 2075 3a20 6172  ------.    u: ar
+00000530: 7261 792d 6c69 6b65 0a20 2020 2020 2020  ray-like.       
+00000540: 2041 2063 6f6d 706c 6578 2032 6e2d 6469   A complex 2n-di
+00000550: 6d65 6e73 696f 6e61 6c20 7665 6374 6f72  mensional vector
+00000560: 2e0a 2020 2020 2020 2020 0a20 2020 2052  ..        .    R
+00000570: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
+00000580: 2d2d 0a20 2020 2055 3a20 6172 7261 792d  --.    U: array-
+00000590: 6c69 6b65 0a20 2020 2020 2020 2041 2063  like.        A c
+000005a0: 6f6d 706c 6578 2028 326e 2978 2832 6e29  omplex (2n)x(2n)
+000005b0: 2d64 696d 656e 7369 6f6e 616c 2075 6e69  -dimensional uni
+000005c0: 7461 7279 2061 6e64 2073 796d 706c 6563  tary and symplec
+000005d0: 7469 6320 6d61 7472 6978 2e0a 2020 2020  tic matrix..    
+000005e0: 7207 0000 0072 0100 0000 e902 0000 0029  r....r.........)
+000005f0: 0272 0900 0000 7209 0000 0029 0272 0100  .r....r....).r..
+00000600: 0000 7209 0000 0029 0272 0900 0000 7201  ..r....).r....r.
+00000610: 0000 0029 0272 0100 0000 7201 0000 0072  ...).r....r....r
+00000620: 0900 0000 6301 0000 0000 0000 0000 0000  ....c...........
+00000630: 0002 0000 0006 0000 0013 0000 0073 2000  .............s .
+00000640: 0000 6700 7c00 5d0c 7d01 7400 8802 7c01  ..g.|.].}.t...|.
+00000650: 8800 1700 1900 8301 8801 6b00 9102 7102  ..........k...q.
+00000660: 5300 7213 0000 00a9 01da 0361 6273 a902  S.r........abs..
+00000670: da02 2e30 da01 6ba9 03da 0364 696d da03  ...0..k....dim..
+00000680: 746f 6cda 0677 5f66 756c 6c72 1300 0000  tol..w_fullr....
+00000690: 7214 0000 00da 0a3c 6c69 7374 636f 6d70  r......<listcomp
+000006a0: 3e49 0000 00f3 0200 0000 2000 7a19 7468  >I........ .z.th
+000006b0: 6d31 302e 3c6c 6f63 616c 733e 2e3c 6c69  m10.<locals>.<li
+000006c0: 7374 636f 6d70 3e63 0100 0000 0000 0000  stcomp>c........
+000006d0: 0000 0000 0200 0000 0500 0000 1300 0000  ................
+000006e0: 731e 0000 0067 007c 005d 0b7d 0174 0088  s....g.|.].}.t..
+000006f0: 017c 0119 006a 0183 0188 006b 0091 0271  .|...j.....k...q
+00000700: 0253 0072 1300 0000 2902 7218 0000 00da  .S.r....).r.....
+00000710: 0469 6d61 6772 1900 0000 2902 721e 0000  .imagr....).r...
+00000720: 0072 1f00 0000 7213 0000 0072 1400 0000  .r....r....r....
+00000730: 7220 0000 004a 0000 0073 0200 0000 1e00  r ...J...s......
+00000740: 4e29 1272 0a00 0000 720b 0000 0072 0c00  N).r....r....r..
+00000750: 0000 720d 0000 0072 0e00 0000 da03 6c65  ..r....r......le
+00000760: 6eda 057a 6572 6f73 da05 7261 6e67 6572  n..zeros..ranger
+00000770: 1500 0000 da03 6579 6572 1800 0000 da03  ......eyer......
+00000780: 616c 6cda 0463 6f70 79da 0772 6573 6861  all..copy..resha
+00000790: 7065 da09 7472 616e 7370 6f73 6572 0f00  pe..transposer..
+000007a0: 0000 da05 7368 6170 65da 0562 6c6f 636b  ....shape..block
+000007b0: 2910 7210 0000 0072 1e00 0000 7211 0000  ).r....r....r...
+000007c0: 0072 1200 0000 da04 6469 6d32 da01 5072  .r......dim2..Pr
+000007d0: 1b00 0000 da05 7670 6172 74da 0950 7061  ......vpart..Ppa
+000007e0: 7274 5f69 6e76 da05 5070 6172 74da 0177  rt_inv..Ppart..w
+000007f0: da04 6469 6666 da09 6e6f 726d 5f64 6966  ..diff..norm_dif
+00000800: 66da 0248 4872 2400 0000 da01 5672 1300  f..HHr$.....Vr..
+00000810: 0000 721c 0000 0072 1400 0000 da05 7468  ..r....r......th
+00000820: 6d31 301e 0000 0073 4400 0000 100e 0c01  m10....sD.......
+00000830: 0c01 0801 0801 1001 0801 1401 0c01 1401  ................
+00000840: 1001 0801 2c01 0a02 1001 1401 1401 1a01  ....,...........
+00000850: 0802 0806 1c02 2201 2001 0c03 1001 1001  ......". .......
+00000860: 0c01 0801 0801 2001 0a03 0c02 1a01 1003  ...... .........
+00000870: 7237 0000 0063 0100 0000 0000 0000 0000  r7...c..........
+00000880: 0000 1a00 0000 0900 0000 4b00 0000 731a  ..........K...s.
+00000890: 0200 0074 006a 017c 0074 006a 0264 018d  ...t.j.|.t.j.d..
+000008a0: 027d 007c 006a 0364 0219 007c 006a 0364  .}.|.j.d...|.j.d
+000008b0: 0319 006b 0273 144a 0082 017c 006a 0364  ...k.s.J...|.j.d
+000008c0: 0219 007d 027c 0264 0416 0064 026b 0273  ...}.|.d...d.k.s
+000008d0: 214a 0082 017c 0264 041a 007d 037c 0264  !J...|.d...}.|.d
+000008e0: 046b 0472 3674 047c 0064 0374 00a0 057c  .k.r6t.|.d.t...|
+000008f0: 02a1 0164 058d 035c 027d 047d 056e 0674  ...d...\.}.}.n.t
+00000900: 067c 0083 015c 027d 047d 057c 0564 0664  .|...\.}.}.|.d.d
+00000910: 0685 0264 0266 0219 007d 067c 0674 006a  ...d.f...}.|.t.j
+00000920: 07a0 087c 06a1 011b 007d 0774 097c 0766  ...|.....}.t.|.f
+00000930: 0169 007c 01a4 018e 017d 087c 08a0 0aa1  .i.|.....}.|....
+00000940: 00a0 0ba1 007d 097c 097c 0010 007c 0810  .....}.|.|...|..
+00000950: 007d 0a7c 0364 046b 0590 0172 0b7c 0a64  .}.|.d.k...r.|.d
+00000960: 037c 0385 0264 037c 0385 0266 0219 007d  .|...d.|...f...}
+00000970: 0b7c 0a64 037c 0385 027c 0364 0317 0064  .|.d.|...|.d...d
+00000980: 0685 0266 0219 007d 0c7c 0a7c 0364 0317  ...f...}.|.|.d..
+00000990: 0064 0685 0264 037c 0385 0266 0219 007d  .d...d.|...f...}
+000009a0: 0d7c 0a7c 0364 0317 0064 0685 027c 0364  .|.|.d...d...|.d
+000009b0: 0317 0064 0685 0266 0219 007d 0e74 0c74  ...d...f...}.t.t
+000009c0: 00a0 0d7c 0b7c 0c67 027c 0d7c 0e67 0267  ...|.|.g.|.|.g.g
+000009d0: 02a1 0166 0169 007c 01a4 018e 017d 0f7c  ...f.i.|.....}.|
+000009e0: 0364 0318 007d 107c 0f64 067c 1085 0264  .d...}.|.d.|...d
+000009f0: 067c 1085 0266 0219 007d 117c 0f64 067c  .|...f...}.|.d.|
+00000a00: 1085 027c 1064 0685 0266 0219 007d 127c  ...|.d...f...}.|
+00000a10: 0f7c 1064 0685 0264 067c 1085 0266 0219  .|.d...d.|...f..
+00000a20: 007d 137c 0f7c 1064 0685 027c 1064 0685  .}.|.|.d...|.d..
+00000a30: 0266 0219 007d 1474 00a0 0e64 037c 1067  .f...}.t...d.|.g
+00000a40: 02a1 017d 1574 00a0 0e7c 1064 0367 02a1  ...}.t...|.d.g..
+00000a50: 017d 1674 00a0 0164 0367 0167 01a1 017d  .}.t...d.g.g...}
+00000a60: 1774 00a0 0164 0267 0167 01a1 017d 1874  .t...d.g.g...}.t
+00000a70: 00a0 0d7c 177c 157c 187c 1567 047c 167c  ...|.|.|.|.g.|.|
+00000a80: 117c 167c 1267 047c 187c 157c 177c 1567  .|.|.g.|.|.|.|.g
+00000a90: 047c 167c 137c 167c 1467 0467 04a1 017d  .|.|.|.|.g.g...}
+00000aa0: 197c 087c 1910 007d 087c 0853 0029 0761  .|.|...}.|.S.).a
+00000ab0: 8603 0000 0a20 2020 204c 6574 2041 2062  .....    Let A b
+00000ac0: 6520 6120 6e6f 726d 616c 2061 6e64 2028  e a normal and (
+00000ad0: 736b 6577 292d 4861 6d69 6c74 6f6e 6961  skew)-Hamiltonia
+00000ae0: 6e2e 2052 6563 616c 6c20 7468 6174 2074  n. Recall that t
+00000af0: 6869 7320 6d65 616e 7320 4120 7361 7469  his means A sati
+00000b00: 7366 6965 7320 7468 6520 666f 6c6c 6f77  sfies the follow
+00000b10: 696e 6720 7477 6f20 636f 6e64 6974 696f  ing two conditio
+00000b20: 6e73 3a0a 2020 2020 0a20 2020 2031 2920  ns:.    .    1) 
+00000b30: 412e 7472 616e 7370 6f73 6528 2940 4a20  A.transpose()@J 
+00000b40: 2b20 7369 676e 2a4a 4041 203d 2030 2c20  + sign*J@A = 0, 
+00000b50: 7768 6572 6520 7369 676e 203d 2031 2069  where sign = 1 i
+00000b60: 6620 2273 6b65 7722 2c20 656c 7365 202d  f "skew", else -
+00000b70: 312e 0a20 2020 2032 2920 412e 7472 616e  1..    2) A.tran
+00000b80: 7370 6f73 6528 292e 636f 6e6a 2829 4041  spose().conj()@A
+00000b90: 203d 2041 4041 2e74 7261 6e73 706f 7365   = A@A.transpose
+00000ba0: 2829 2e63 6f6e 6a28 290a 2020 2020 0a20  ().conj().    . 
+00000bb0: 2020 2054 6865 6e20 7468 6973 2072 6f75     Then this rou
+00000bc0: 7469 6e65 2077 696c 6c20 6669 6e64 2061  tine will find a
+00000bd0: 2073 796d 706c 6563 7469 6320 616e 6420   symplectic and 
+00000be0: 756e 6974 6172 7920 6d61 7472 6978 2055  unitary matrix U
+00000bf0: 2073 6f20 7468 6174 0a20 2020 200a 2020   so that.    .  
+00000c00: 2020 552e 7472 616e 7370 6f73 6528 292e    U.transpose().
+00000c10: 636f 6e6a 2829 4041 4055 0a20 2020 200a  conj()@A@U.    .
+00000c20: 2020 2020 6973 2064 6961 676f 6e61 6c2e      is diagonal.
+00000c30: 2049 7420 6973 2068 6572 6562 7920 6173   It is hereby as
+00000c40: 7375 6d65 6420 7468 6174 204a 2063 6f72  sumed that J cor
+00000c50: 7265 7370 6f6e 6420 746f 2074 6865 2073  respond to the s
+00000c60: 796d 706c 6563 7469 6320 7374 7275 6374  ymplectic struct
+00000c70: 7572 6520 696e 2074 6572 6d73 206f 6620  ure in terms of 
+00000c80: 6e78 6e2d 626c 6f63 6b20 6d61 7472 6963  nxn-block matric
+00000c90: 6573 3a0a 2020 2020 0a20 2020 2020 2020  es:.    .       
+00000ca0: 202f 2030 2020 2031 205c 0a20 2020 204a   / 0   1 \.    J
+00000cb0: 203d 207c 2020 2020 2020 207c 0a20 2020   = |       |.   
+00000cc0: 2020 2020 205c 202d 3120 2030 202f 0a20       \ -1  0 /. 
+00000cd0: 2020 200a 2020 2020 5061 7261 6d65 7465     .    Paramete
+00000ce0: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+00000cf0: 2d0a 2020 2020 413a 2061 7272 6179 2d6c  -.    A: array-l
+00000d00: 696b 650a 2020 2020 2020 2020 4120 636f  ike.        A co
+00000d10: 6d70 6c65 782d 7661 6c75 6564 2028 326e  mplex-valued (2n
+00000d20: 2978 2832 6e29 2d6d 6174 7269 7820 6861  )x(2n)-matrix ha
+00000d30: 7669 6e67 2074 6865 2061 626f 7665 2070  ving the above p
+00000d40: 726f 7065 7274 6965 7320 2857 6172 6e69  roperties (Warni
+00000d50: 6e67 3a20 4e6f 2063 6865 636b 2069 7320  ng: No check is 
+00000d60: 6d61 6465 2061 6761 696e 7374 2074 6865  made against the
+00000d70: 7365 2070 726f 7065 7274 6965 7320 7769  se properties wi
+00000d80: 7468 696e 0a20 2020 2020 2020 2074 6869  thin.        thi
+00000d90: 7320 726f 7574 696e 6529 2e0a 2020 2020  s routine)..    
+00000da0: 2020 2020 0a20 2020 2052 6574 7572 6e73      .    Returns
+00000db0: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
+00000dc0: 2055 3a20 6172 7261 792d 6c69 6b65 0a20   U: array-like. 
+00000dd0: 2020 2020 2020 2041 2063 6f6d 706c 6578         A complex
+00000de0: 2d76 616c 7565 6420 7379 6d70 6c65 6374  -valued symplect
+00000df0: 6963 2061 6e64 2075 6e69 7461 7279 2028  ic and unitary (
+00000e00: 326e 2978 2832 6e29 2d6d 6174 7269 7820  2n)x(2n)-matrix 
+00000e10: 5520 736f 2074 6861 7420 555e 282d 3129  U so that U^(-1)
+00000e20: 4041 4055 203d 2044 2069 7320 6469 6167  @A@U = D is diag
+00000e30: 6f6e 616c 2e0a 2020 2020 7207 0000 0072  onal..    r....r
+00000e40: 0100 0000 7209 0000 0072 1600 0000 2902  ....r....r....).
+00000e50: 721b 0000 00da 0276 304e 290f 720a 0000  r......v0N).r...
+00000e60: 0072 0b00 0000 720c 0000 0072 2b00 0000  .r....r....r+...
+00000e70: 7202 0000 00da 046f 6e65 7372 0300 0000  r......onesr....
+00000e80: 720d 0000 0072 0e00 0000 7237 0000 0072  r....r....r7...r
+00000e90: 2a00 0000 720f 0000 00da 0563 6f72 3239  *...r......cor29
+00000ea0: 722c 0000 0072 2400 0000 291a da01 41da  r,...r$...)...A.
+00000eb0: 066b 7761 7267 7372 2d00 0000 721d 0000  .kwargsr-...r...
+00000ec0: 00da 0b65 6967 656e 7661 6c75 6573 da0c  ...eigenvalues..
+00000ed0: 6569 6765 6e76 6563 746f 7273 da0b 6569  eigenvectors..ei
+00000ee0: 6765 6e76 6563 746f 7272 1200 0000 da01  genvectorr......
+00000ef0: 55da 0555 5f69 6e76 da01 42da 0342 3131  U..U_inv..B..B11
+00000f00: da03 4231 32da 0342 3231 da03 4232 32da  ..B12..B21..B22.
+00000f10: 0555 5f73 7562 da07 6469 6d5f 7375 62da  .U_sub..dim_sub.
+00000f20: 0855 5f73 7562 5f31 31da 0855 5f73 7562  .U_sub_11..U_sub
+00000f30: 5f31 32da 0855 5f73 7562 5f32 31da 0855  _12..U_sub_21..U
+00000f40: 5f73 7562 5f32 32da 077a 6572 6f73 5f76  _sub_22..zeros_v
+00000f50: da08 7a65 726f 735f 7674 da03 6f6e 65da  ..zeros_vt..one.
+00000f60: 047a 6572 6fda 0a55 5f73 7562 5f66 756c  .zero..U_sub_ful
+00000f70: 6c72 1300 0000 7213 0000 0072 1400 0000  lr....r....r....
+00000f80: 723a 0000 005f 0000 0073 4600 0000 101c  r:..._...sF.....
+00000f90: 1801 0a01 1001 0801 0803 1a01 0c03 1001  ................
+00000fa0: 1001 1001 0c01 0c01 0a02 1402 1801 1801  ................
+00000fb0: 1c01 2201 0802 1403 1401 1401 1401 0e03  ..".............
+00000fc0: 0e01 0e01 0e01 0e02 0a01 0a01 0a01 06fd  ................
+00000fd0: 0804 0402 723a 0000 00e7 9b2b a186 9b84  ....r:.....+....
+00000fe0: 063d 6303 0000 0000 0000 0000 0000 002b  .=c............+
+00000ff0: 0000 0007 0000 000b 0000 0073 d003 0000  ...........s....
+00001000: 7c00 6a00 6401 1900 7c00 6a00 6402 1900  |.j.d...|.j.d...
+00001010: 6b02 730c 4a00 8201 7c00 6a00 5c02 7d04  k.s.J...|.j.\.}.
+00001020: 7d05 7c04 6403 1600 6401 6b02 7319 4a00  }.|.d...d.k.s.J.
+00001030: 8201 7c04 6403 1a00 7d06 7401 7c06 8301  ..|.d...}.t.|...
+00001040: 7d07 7c00 7c07 7c00 a002 a100 1000 7c07  }.|.|.|.......|.
+00001050: 1000 1700 7d08 7403 7c08 8301 7d09 7c09  ....}.t.|...}.|.
+00001060: a002 a100 a004 a100 7d0a 7c0a 7c08 1000  ........}.|.|...
+00001070: 7c09 1000 7d0b 7c0b a005 a100 7d0c 7406  |...}.|.....}.t.
+00001080: 7c0c 8706 6601 6404 6405 8408 6406 8d02  |...f.d.d...d...
+00001090: 7d0d 7c0a 7c00 1000 7c09 1000 8903 7407  }.|.|...|.....t.
+000010a0: 6a08 7c04 7c04 6702 7407 6a09 6407 8d02  j.|.|.g.t.j.d...
+000010b0: 7d0e 740a 7c0d 8301 6401 6b04 9001 723e  }.t.|...d.k...r>
+000010c0: 740b 7c0d 8e00 5c02 8900 8901 7407 a00c  t.|...\.....t...
+000010d0: 8700 8703 6602 6408 6409 8408 8800 4400  ....f.d.d.....D.
+000010e0: 8301 a101 7d0f 7407 a00c 8701 8703 6602  ....}.t.......f.
+000010f0: 640a 6409 8408 8801 4400 8301 a101 7d10  d.d.....D.....}.
+00001100: 740d 7c0f 7c10 a002 a100 7c03 a00e 640b  t.|.|.....|...d.
+00001110: 640c a102 640d 8d03 5c04 7d11 7d12 7d13  d...d...\.}.}.}.
+00001120: 7d14 7407 6a08 7c11 6a00 7407 6a09 6407  }.t.j.|.j.t.j.d.
+00001130: 8d02 7d15 7407 a00f 7c11 7c15 6702 7c15  ..}.t...|.|.g.|.
+00001140: 7c11 a004 a100 6702 6702 a101 7d16 8800  |.....g.g...}...
+00001150: 8801 1700 7d17 7410 740a 7c17 8301 8301  ....}.t.t.|.....
+00001160: 4400 5d1d 7d18 7410 740a 7c17 8301 8301  D.].}.t.t.|.....
+00001170: 4400 5d14 7d19 7c17 7c18 1900 7d1a 7c17  D.].}.|.|...}.|.
+00001180: 7c19 1900 7d1b 7c16 7c18 7c19 6602 1900  |...}.|.|.|.f...
+00001190: 7c0e 7c1a 7c1b 6602 3c00 71b9 71b1 8807  |.|.|.f.<.q.q...
+000011a0: 6401 6b04 9001 723e 740a 8800 8301 8905  d.k...r>t.......
+000011b0: 7401 8805 8301 7d1c 7c0f 7c10 a002 a100  t.....}.|.|.....
+000011c0: 1000 7c10 a002 a100 7c0f 1000 1800 7d1d  ..|.....|.....}.
+000011d0: 7c0f a002 a100 a004 a100 7c0f 1000 7c0f  |.........|...|.
+000011e0: 7c0f a002 a100 a004 a100 1000 1800 7d1e  |.............}.
+000011f0: 7c10 a002 a100 a004 a100 7c10 1000 7c10  |.........|...|.
+00001200: 7c10 a002 a100 a004 a100 1000 1800 7d1f  |.............}.
+00001210: 7c16 a002 a100 a004 a100 7c16 1000 7407  |.........|...t.
+00001220: a011 8805 6403 1400 a101 1800 7d20 7c16  ....d.......} |.
+00001230: a002 a100 7c1c 1000 7c16 1000 7c1c 1800  ....|...|...|...
+00001240: 7d21 7c1d 7c1e 7c1f 7c20 7c21 6605 4400  }!|.|.|.| |!f.D.
+00001250: 5d15 8908 7412 8705 8707 8708 6603 640e  ]...t.......f.d.
+00001260: 6409 8408 7410 8805 8301 4400 8301 8301  d...t.....D.....
+00001270: 9001 733c 4a00 8201 9001 7128 7407 a013  ..s<J.....q(t...
+00001280: 7407 a014 7c0c a101 8806 6b00 a101 6401  t...|.....k...d.
+00001290: 1900 8902 740a 8802 8301 6401 6b04 9001  ....t.....d.k...
+000012a0: 728e 7407 a00c 8702 8703 6602 640f 6409  r.t.......f.d.d.
+000012b0: 8408 8802 4400 8301 a101 7d22 7403 7c22  ....D.....}"t.|"
+000012c0: 8301 7d23 7c23 a002 a100 a004 a100 7d24  ..}#|#........}$
+000012d0: 7410 740a 8802 8301 8301 4400 5d1f 7d18  t.t.......D.].}.
+000012e0: 7410 740a 8802 8301 8301 4400 5d15 7d19  t.t.......D.].}.
+000012f0: 8802 7c18 1900 7d1a 8802 7c19 1900 7d1b  ..|...}...|...}.
+00001300: 7c24 7c18 7c19 6602 1900 7c0e 7c1a 7c1b  |$|.|.f...|.|.|.
+00001310: 6602 3c00 9001 7176 9001 716e 7c0e 7c0a  f.<...qv..qn|.|.
+00001320: 1000 7d0e 8807 6401 6b04 9001 72e6 7c0e  ..}...d.k...r.|.
+00001330: a002 a100 a004 a100 7c0e 1000 7407 a011  ........|...t...
+00001340: 7c04 a101 1800 7d25 7c0e a002 a100 7c07  |.....}%|.....|.
+00001350: 1000 7c0e 1000 7c07 1800 7d26 7c07 0b00  ..|...|...}&|...
+00001360: 7c0e a002 a100 1000 7c07 1000 7d27 7c0e  |.......|...}'|.
+00001370: 7c00 1000 7c27 1000 7d28 7c28 7407 a015  |...|'..}(|(t...
+00001380: 7c28 a005 a100 a101 1800 7d29 7c25 7c26  |(........})|%|&
+00001390: 7c29 6603 4400 5d1a 8908 8808 6a00 5c02  |)f.D.].....j.\.
+000013a0: 7d2a 8904 7412 8704 8707 8708 6603 6410  }*..t.......f.d.
+000013b0: 6409 8408 7410 7c2a 8301 4400 8301 8301  d...t.|*..D.....
+000013c0: 9001 73e4 4a00 8201 9001 71cb 7c0e 5300  ..s.J.....q.|.S.
+000013d0: 2911 6190 0600 000a 2020 2020 4669 6e64  ).a.....    Find
+000013e0: 2061 2075 6e69 7461 7279 2061 6e64 2073   a unitary and s
+000013f0: 796d 706c 6563 7469 6320 6d61 7472 6978  ymplectic matrix
+00001400: 2055 2077 6869 6368 2063 616e 2064 6961   U which can dia
+00001410: 676f 6e61 6c69 7a65 2061 2067 6976 656e  gonalize a given
+00001420: 2063 6f6d 706c 6578 206e 6f72 6d61 6c20   complex normal 
+00001430: 616e 6420 4a2d 6e6f 726d 616c 206d 6174  and J-normal mat
+00001440: 7269 7820 4d2c 0a20 2020 2073 6f20 7468  rix M,.    so th
+00001450: 6174 2055 404d 4055 5e28 2d31 2920 6973  at U@M@U^(-1) is
+00001460: 2064 6961 676f 6e61 6c2e 0a20 2020 200a   diagonal..    .
+00001470: 2020 2020 4e6f 7465 2074 6861 7420 7468      Note that th
+00001480: 6520 6162 6f76 6520 7072 6f70 6572 7469  e above properti
+00001490: 6573 206f 6620 4d20 7472 616e 736c 6174  es of M translat
+000014a0: 6520 746f 3a0a 2020 2020 3129 204d 404d  e to:.    1) M@M
+000014b0: 5e48 203d 204d 5e48 404d 2028 4d20 6e6f  ^H = M^H@M (M no
+000014c0: 726d 616c 292c 0a20 2020 2032 2920 4d40  rmal),.    2) M@
+000014d0: 4a40 4d2e 7472 616e 7370 6f73 6528 2940  J@M.transpose()@
+000014e0: 4a20 3d20 4a40 4d2e 7472 616e 7370 6f73  J = J@M.transpos
+000014f0: 6528 2940 4a40 4d20 284d 204a 2d6e 6f72  e()@J@M (M J-nor
+00001500: 6d61 6c29 2e0a 2020 2020 0a20 2020 2049  mal)..    .    I
+00001510: 6e20 7061 7274 6963 756c 6172 2c20 6966  n particular, if
+00001520: 204d 2069 7320 7379 6d70 6c65 6374 6963   M is symplectic
+00001530: 2c20 4d20 7769 6c6c 2062 6520 4a2d 6e6f  , M will be J-no
+00001540: 726d 616c 2e0a 2020 2020 0a20 2020 2048  rmal..    .    H
+00001550: 6572 6562 7920 4a20 6465 6e6f 7465 7320  ereby J denotes 
+00001560: 7468 6520 2832 6e29 7828 326e 292d 6d61  the (2n)x(2n)-ma
+00001570: 7472 6978 2064 6573 6372 6962 696e 6720  trix describing 
+00001580: 7468 6520 7374 616e 6461 7264 2073 796d  the standard sym
+00001590: 706c 6563 7469 6320 7374 7275 6374 7572  plectic structur
+000015a0: 650a 2020 2020 696e 2062 6c6f 636b 2d6d  e.    in block-m
+000015b0: 6174 7269 7820 666f 726d 3a0a 2020 2020  atrix form:.    
+000015c0: 0a20 2020 2020 2020 202f 2020 3020 2031  .        /  0  1
+000015d0: 205c 0a20 2020 204a 203d 207c 2020 2020   \.    J = |    
+000015e0: 2020 207c 0a20 2020 2020 2020 205c 202d     |.        \ -
+000015f0: 3120 2030 202f 0a20 2020 200a 2020 2020  1  0 /.    .    
+00001600: 5520 7379 6d70 6c65 6374 6963 2061 6e64  U symplectic and
+00001610: 2075 6e69 7461 7279 206d 6561 6e73 3a0a   unitary means:.
+00001620: 2020 2020 3129 2055 4055 5e48 203d 2031      1) U@U^H = 1
+00001630: 2028 3d20 555e 4840 5529 2028 5520 756e   (= U^H@U) (U un
+00001640: 6974 6172 7929 0a20 2020 2032 2920 552e  itary).    2) U.
+00001650: 7472 616e 7370 6f73 6528 2940 4a40 5520  transpose()@J@U 
+00001660: 3d20 4a20 2855 2073 796d 706c 6563 7469  = J (U symplecti
+00001670: 6329 0a20 2020 200a 2020 2020 5468 6520  c).    .    The 
+00001680: 616c 676f 7269 7468 6d20 666f 6c6c 6f77  algorithm follow
+00001690: 7320 7468 6520 6f6e 6520 6f75 746c 696e  s the one outlin
+000016a0: 6564 2069 6e20 5265 662e 205b 315d 2e0a  ed in Ref. [1]..
+000016b0: 2020 2020 0a20 2020 2050 6172 616d 6574      .    Paramet
+000016c0: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
+000016d0: 2d2d 0a20 2020 204d 3a20 6e64 6172 7261  --.    M: ndarra
+000016e0: 790a 2020 2020 2020 2020 5468 6520 6d61  y.        The ma
+000016f0: 7472 6978 204d 2c20 6861 7669 6e67 2074  trix M, having t
+00001700: 6865 2061 626f 7665 2070 726f 7065 7274  he above propert
+00001710: 6965 732c 2077 6869 6368 2073 686f 756c  ies, which shoul
+00001720: 6420 6265 2064 6961 676f 6e61 6c69 7a65  d be diagonalize
+00001730: 642e 0a20 2020 2020 2020 2041 7474 656e  d..        Atten
+00001740: 7469 6f6e 3a20 4e6f 2065 7874 656e 7369  tion: No extensi
+00001750: 7665 2063 6865 636b 7320 6172 6520 6d61  ve checks are ma
+00001760: 6465 2061 6761 696e 7374 2074 6865 2070  de against the p
+00001770: 726f 7065 7274 6965 7320 4d20 6861 7320  roperties M has 
+00001780: 746f 2073 6174 6973 6679 2e0a 2020 2020  to satisfy..    
+00001790: 2020 2020 0a20 2020 2074 6f6c 313a 2066      .    tol1: f
+000017a0: 6c6f 6174 2c20 6f70 7469 6f6e 616c 0a20  loat, optional. 
+000017b0: 2020 2020 2020 2041 6e20 6f70 7469 6f6e         An option
+000017c0: 616c 2074 6f6c 6572 616e 6365 2074 6f20  al tolerance to 
+000017d0: 6964 656e 7469 6679 2063 6572 7461 696e  identify certain
+000017e0: 2070 6169 7273 206f 6620 6569 6765 6e76   pairs of eigenv
+000017f0: 616c 7565 7320 2873 6565 2073 6f75 7263  alues (see sourc
+00001800: 6529 2e0a 0a20 2020 2074 6f6c 323a 2066  e)...    tol2: f
+00001810: 6c6f 6174 2c20 6f70 7469 6f6e 616c 0a20  loat, optional. 
+00001820: 2020 2020 2020 2041 6e20 6f70 7469 6f6e         An option
+00001830: 616c 2074 6f6c 6572 616e 6365 2074 6f20  al tolerance to 
+00001840: 7065 7266 6f72 6d20 736f 6d65 2063 6f6e  perform some con
+00001850: 7369 7374 656e 6379 2063 6865 636b 7320  sistency checks 
+00001860: 6f6e 2074 6865 206f 7574 7075 742c 2069  on the output, i
+00001870: 6620 3e20 302e 0a0a 2020 2020 7364 6e5f  f > 0...    sdn_
+00001880: 746f 6c3a 2066 6c6f 6174 2c20 6f70 7469  tol: float, opti
+00001890: 6f6e 616c 0a20 2020 2020 2020 2054 6865  onal.        The
+000018a0: 2027 746f 6c27 2070 6172 616d 6574 6572   'tol' parameter
+000018b0: 2066 6f72 2074 6865 206c 6965 6f70 732e   for the lieops.
+000018c0: 6c69 6e61 6c67 2e73 696d 696c 6172 6974  linalg.similarit
+000018d0: 792e 7369 6d75 6c74 616e 656f 7573 2e73  y.simultaneous.s
+000018e0: 696d 756c 6469 6167 2072 6f75 7469 6e65  imuldiag routine
+000018f0: 2e0a 2020 2020 0a20 2020 2052 6574 7572  ..    .    Retur
+00001900: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
+00001910: 2020 206e 6461 7272 6179 0a20 2020 2020     ndarray.     
+00001920: 2020 2041 2063 6f6d 706c 6578 2075 6e69     A complex uni
+00001930: 7461 7279 2061 6e64 2073 796d 706c 6563  tary and symplec
+00001940: 7469 6320 6d61 7472 6978 2055 2061 7320  tic matrix U as 
+00001950: 6465 7363 7269 6265 6420 6162 6f76 652e  described above.
+00001960: 0a20 2020 200a 2020 2020 5265 6665 7265  .    .    Refere
+00001970: 6e63 6573 0a20 2020 202d 2d2d 2d2d 2d2d  nces.    -------
+00001980: 2d2d 2d0a 2020 2020 5b31 5d20 522e 2064  ---.    [1] R. d
+00001990: 6520 6c61 2043 7275 7a20 616e 6420 482e  e la Cruz and H.
+000019a0: 2046 6173 7362 656e 6465 723a 2022 4f6e   Fassbender: "On
+000019b0: 2074 6865 2064 6961 676f 6e61 6c69 7a61   the diagonaliza
+000019c0: 6269 6c69 7479 206f 6620 6120 6d61 7472  bility of a matr
+000019d0: 6978 2062 7920 6120 7379 6d70 6c65 6374  ix by a symplect
+000019e0: 6963 2065 7175 6976 616c 656e 6365 2c20  ic equivalence, 
+000019f0: 0a20 2020 2020 2020 2073 696d 696c 6172  .        similar
+00001a00: 6974 7920 6f72 2063 6f6e 6772 7565 6e63  ity or congruenc
+00001a10: 6520 7472 616e 7366 6f72 6d61 7469 6f6e  e transformation
+00001a20: 222c 204c 696e 6561 7220 416c 6765 6272  ", Linear Algebr
+00001a30: 6120 616e 6420 6974 7320 4170 706c 6963  a and its Applic
+00001a40: 6174 696f 6e73 2034 3936 2028 3230 3136  ations 496 (2016
+00001a50: 2920 7070 2e20 3238 3820 2d2d 2033 3036  ) pp. 288 -- 306
+00001a60: 2e20 0a20 2020 2072 0100 0000 7209 0000  . .    r....r...
+00001a70: 0072 1600 0000 6302 0000 0000 0000 0000  .r....c.........
+00001a80: 0000 0002 0000 0003 0000 0013 0000 0073  ...............s
+00001a90: 1c00 0000 7400 7c00 7c01 1700 8301 8800  ....t.|.|.......
+00001aa0: 6b00 6f0d 7400 7c00 8301 8800 6b04 5300  k.o.t.|.....k.S.
+00001ab0: 2901 4e72 1700 0000 2902 da01 61da 0162  ).Nr....)...a..b
+00001ac0: 2901 da04 746f 6c31 7213 0000 0072 1400  )...tol1r....r..
+00001ad0: 0000 da08 3c6c 616d 6264 613e f100 0000  ....<lambda>....
+00001ae0: 7302 0000 001c 007a 1774 686d 3331 2e3c  s......z.thm31.<
+00001af0: 6c6f 6361 6c73 3e2e 3c6c 616d 6264 613e  locals>.<lambda>
+00001b00: 2901 da09 636f 6e64 6974 696f 6e72 0700  )...conditionr..
+00001b10: 0000 6301 0000 0000 0000 0000 0000 0001  ..c.............
+00001b20: 0000 0005 0000 0013 0000 00f3 2000 0000  ............ ...
+00001b30: 6700 7c00 5d0c 8900 8702 8700 6602 6400  g.|.].......f.d.
+00001b40: 6401 8408 8801 4400 8301 9102 7102 5300  d.....D.....q.S.
+00001b50: 2902 6301 0000 0000 0000 0000 0000 0002  ).c.............
+00001b60: 0000 0005 0000 0013 0000 00f3 1800 0000  ................
+00001b70: 6700 7c00 5d08 7d01 8800 8801 7c01 6602  g.|.].}.....|.f.
+00001b80: 1900 9102 7102 5300 7213 0000 0072 1300  ....q.S.r....r..
+00001b90: 0000 a902 721a 0000 00da 016a a902 da04  ....r......j....
+00001ba0: 504d 5069 da01 6972 1300 0000 7214 0000  PMPi..ir....r...
+00001bb0: 0072 2000 0000 f900 0000 f302 0000 0018  .r .............
+00001bc0: 00fa 2474 686d 3331 2e3c 6c6f 6361 6c73  ..$thm31.<locals
+00001bd0: 3e2e 3c6c 6973 7463 6f6d 703e 2e3c 6c69  >.<listcomp>.<li
+00001be0: 7374 636f 6d70 3e72 1300 0000 a901 721a  stcomp>r......r.
+00001bf0: 0000 0029 02da 0a4d 315f 696e 6469 6365  ...)...M1_indice
+00001c00: 7372 5d00 0000 a901 725e 0000 0072 1400  sr].....r^...r..
+00001c10: 0000 7220 0000 00f9 0000 0072 2100 0000  ..r .......r!...
+00001c20: 7a19 7468 6d33 312e 3c6c 6f63 616c 733e  z.thm31.<locals>
+00001c30: 2e3c 6c69 7374 636f 6d70 3e63 0100 0000  .<listcomp>c....
+00001c40: 0000 0000 0000 0000 0100 0000 0500 0000  ................
+00001c50: 1300 0000 7258 0000 0029 0263 0100 0000  ....rX...).c....
+00001c60: 0000 0000 0000 0000 0200 0000 0500 0000  ................
+00001c70: 1300 0000 7259 0000 0072 1300 0000 7213  ....rY...r....r.
+00001c80: 0000 0072 5a00 0000 725c 0000 0072 1300  ...rZ...r\...r..
+00001c90: 0000 7214 0000 0072 2000 0000 fa00 0000  ..r....r .......
+00001ca0: 725f 0000 0072 6000 0000 7213 0000 0072  r_...r`...r....r
+00001cb0: 6100 0000 2902 da0a 4d32 5f69 6e64 6963  a...)...M2_indic
+00001cc0: 6573 725d 0000 0072 6300 0000 7214 0000  esr]...rc...r...
+00001cd0: 0072 2000 0000 fa00 0000 7221 0000 00da  .r .......r!....
+00001ce0: 0773 646e 5f74 6f6c 7252 0000 0029 0172  .sdn_tolrR...).r
+00001cf0: 1e00 0000 6301 0000 0000 0000 0000 0000  ....c...........
+00001d00: 0003 0000 0007 0000 0013 0000 00f3 2e00  ................
+00001d10: 0000 6700 7c00 5d13 7d01 7400 8800 8301  ..g.|.].}.t.....
+00001d20: 4400 5d0c 7d02 7401 8802 7c01 7c02 6602  D.].}.t...|.|.f.
+00001d30: 1900 8301 8801 6b00 9103 7108 7102 5300  ......k...q.q.S.
+00001d40: 7213 0000 00a9 0272 2500 0000 7218 0000  r......r%...r...
+00001d50: 00a9 0372 1a00 0000 725e 0000 0072 5b00  ...r....r^...r[.
+00001d60: 0000 2903 da04 6469 6d31 da04 746f 6c32  ..)...dim1..tol2
+00001d70: 7250 0000 0072 1300 0000 7214 0000 0072  rP...r....r....r
+00001d80: 2000 0000 1301 0000 f302 0000 002e 0063   ..............c
+00001d90: 0100 0000 0000 0000 0000 0000 0100 0000  ................
+00001da0: 0500 0000 1300 0000 7258 0000 0029 0263  ........rX...).c
+00001db0: 0100 0000 0000 0000 0000 0000 0200 0000  ................
+00001dc0: 0500 0000 1300 0000 7259 0000 0072 1300  ........rY...r..
+00001dd0: 0000 7213 0000 0072 5a00 0000 725c 0000  ..r....rZ...r\..
+00001de0: 0072 1300 0000 7214 0000 0072 2000 0000  .r....r....r ...
+00001df0: 1701 0000 725f 0000 0072 6000 0000 7213  ....r_...r`...r.
+00001e00: 0000 0072 6100 0000 2902 da0a 4d33 5f69  ...ra...)...M3_i
+00001e10: 6e64 6963 6573 725d 0000 0072 6300 0000  ndicesr]...rc...
+00001e20: 7214 0000 0072 2000 0000 1701 0000 7221  r....r .......r!
+00001e30: 0000 0063 0100 0000 0000 0000 0000 0000  ...c............
+00001e40: 0300 0000 0700 0000 1300 0000 7266 0000  ............rf..
+00001e50: 0072 1300 0000 7267 0000 0072 6800 0000  .r....rg...rh...
+00001e60: 2903 7254 0000 0072 6a00 0000 7250 0000  ).rT...rj...rP..
+00001e70: 0072 1300 0000 7214 0000 0072 2000 0000  .r....r....r ...
+00001e80: 2901 0000 726b 0000 0029 1672 2b00 0000  )...rk...).r+...
+00001e90: 7204 0000 0072 2a00 0000 723a 0000 0072  r....r*...r:...r
+00001ea0: 0f00 0000 da08 6469 6167 6f6e 616c 7205  ......diagonalr.
+00001eb0: 0000 0072 0a00 0000 7224 0000 0072 0c00  ...r....r$...r..
+00001ec0: 0000 7223 0000 00da 037a 6970 720b 0000  ..r#.....zipr...
+00001ed0: 0072 0600 0000 da03 6765 7472 2c00 0000  .r......getr,...
+00001ee0: 7225 0000 0072 2600 0000 7227 0000 00da  r%...r&...r'....
+00001ef0: 0577 6865 7265 7218 0000 00da 0464 6961  .wherer......dia
+00001f00: 6729 2bda 014d 7255 0000 0072 6a00 0000  g)+..MrU...rj...
+00001f10: 723c 0000 0072 2d00 0000 da01 5f72 1d00  r<...r-....._r..
+00001f20: 0000 da01 4ada 064d 7068 694a 4dda 0250  ....J..MphiJM..P
+00001f30: 6972 2e00 0000 da01 4472 7100 0000 da05  ir......Drq.....
+00001f40: 7061 6972 73da 0154 da02 4d31 da02 4d32  pairs..T..M1..M2
+00001f50: da01 58da 0444 3144 32da 0365 7272 da08  ..X..D1D2..err..
+00001f60: 6e5f 7377 6565 7073 da05 7a65 726f 62da  n_sweeps..zerob.
+00001f70: 0151 da09 515f 696e 6469 6365 7372 1b00  .Q..Q_indicesr..
+00001f80: 0000 da01 6cda 026b 6bda 026c 6cda 024a  ....l..kk..ll..J
+00001f90: 31da 057a 6572 6f31 da05 7a65 726f 32da  1..zero1..zero2.
+00001fa0: 057a 6572 6f33 da05 7a65 726f 34da 057a  .zero3..zero4..z
+00001fb0: 6572 6f35 da02 4d33 da03 5033 69da 0250  ero5..M3..P3i..P
+00001fc0: 33da 057a 6572 6f36 da05 7a65 726f 37da  3..zero6..zero7.
+00001fd0: 0554 5f69 6e76 da04 544d 5469 da05 7a65  .T_inv..TMTi..ze
+00001fe0: 726f 3872 5300 0000 7213 0000 0029 0972  ro8rS...r....).r
+00001ff0: 6200 0000 7264 0000 0072 6c00 0000 725d  b...rd...rl...r]
+00002000: 0000 0072 5400 0000 7269 0000 0072 5500  ...rT...ri...rU.
+00002010: 0000 726a 0000 0072 5000 0000 7214 0000  ..rj...rP...r...
+00002020: 00da 0574 686d 3331 ac00 0000 7376 0000  ...thm31....sv..
+00002030: 0018 310a 0110 0108 0108 0914 0108 010c  ..1.............
+00002040: 010c 0108 0314 010c 0114 030e 020c 011a  ................
+00002050: 011a 0122 0312 031a 0108 0210 0110 0108  ..."............
+00002060: 0108 0116 0102 fd0a 0508 0108 0118 0120  ............... 
+00002070: 0120 011e 0114 0112 0128 0118 020e 011a  . .......(......
+00002080: 0108 010c 0110 0110 0108 0108 0118 0104  ................
+00002090: fd08 040a 021a 0114 0112 010c 0112 010e  ................
+000020a0: 010a 0128 0104 0272 9400 0000 2901 7201  ...(...r....).r.
+000020b0: 0000 0029 0272 5200 0000 7201 0000 0029  ...).rR...r....)
+000020c0: 10da 056e 756d 7079 720a 0000 00da 1373  ...numpyr......s
+000020d0: 6369 7079 2e73 7061 7273 652e 6c69 6e61  cipy.sparse.lina
+000020e0: 6c67 7202 0000 00da 0c73 6369 7079 2e6c  lgr......scipy.l
+000020f0: 696e 616c 6772 0300 0000 da14 6c69 656f  inalgr......lieo
+00002100: 7073 2e6c 696e 616c 672e 6d61 7472 6978  ps.linalg.matrix
+00002110: 7204 0000 00da 126c 6965 6f70 732e 6c69  r......lieops.li
+00002120: 6e61 6c67 2e6d 6973 6372 0500 0000 da25  nalg.miscr.....%
+00002130: 6c69 656f 7073 2e6c 696e 616c 672e 7369  lieops.linalg.si
+00002140: 6d69 6c61 7269 7479 2e73 696d 756c 7461  milarity.simulta
+00002150: 6e65 6f75 7372 0600 0000 7215 0000 0072  neousr....r....r
+00002160: 3700 0000 723a 0000 0072 9400 0000 7213  7...r:...r....r.
+00002170: 0000 0072 1300 0000 7213 0000 0072 1400  ...r....r....r..
+00002180: 0000 da08 3c6d 6f64 756c 653e 0100 0000  ....<module>....
+00002190: 7316 0000 0008 000c 010c 010c 020c 010c  s...............
+000021a0: 0102 0208 080a 0d08 410e 4d              ........A.M
```

### Comparing `lieops-0.2.1/lieops/linalg/__pycache__/misc.cpython-310.pyc` & `lieops-0.2.2/lieops/linalg/__pycache__/misc.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/__pycache__/nf.cpython-310.pyc` & `lieops-0.2.2/lieops/linalg/__pycache__/nf.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.10, timestamp-based, .py timestamp: Thu Feb 16 16:59:29 2023 UTC, .py size: 17063 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 11% similar despite different names*

```diff
@@ -1,790 +1,822 @@
-00000000: 6f0d 0d0a 0000 0000 f160 ee63 a742 0000  o........`.c.B..
+00000000: 6f0d 0d0a 0000 0000 f84d 3e64 a745 0000  o........M>d.E..
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0009 0000 0040 0000 0073 e600 0000 6400  .....@...s....d.
+00000020: 0009 0000 0040 0000 0073 1001 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a01 6400 6401 6c02 5a02 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6402 6c03 6d04 5a05 0100 6400 6403 6c06  d.l.m.Z...d.d.l.
 00000050: 6d07 5a07 6d08 5a08 0100 6404 6405 6c09  m.Z.m.Z...d.d.l.
 00000060: 6d0a 5a0a 0100 6404 6406 6c0b 6d0c 5a0c  m.Z...d.d.l.m.Z.
 00000070: 6d0d 5a0d 6d0e 5a0e 0100 6400 6407 6c0f  m.Z.m.Z...d.d.l.
 00000080: 6d10 5a10 6d11 5a11 0100 6400 6408 6c12  m.Z.m.Z...d.d.l.
 00000090: 6d13 5a13 6d14 5a14 0100 6400 6409 6c15  m.Z.m.Z...d.d.l.
 000000a0: 6d16 5a16 0100 6400 640a 6c17 6d18 5a18  m.Z...d.d.l.m.Z.
 000000b0: 0100 6400 640b 6c19 6d1a 5a1a 0100 6400  ..d.d.l.m.Z...d.
-000000c0: 640c 6c1b 6d1c 5a1c 0100 640d 640e 8400  d.l.m.Z...d.d...
-000000d0: 5a1d 6700 640f 6410 6603 6411 651e 6602  Z.g.d.d.f.d.e.f.
-000000e0: 6412 6413 8405 5a1f 6414 6700 6410 6400  d.d...Z.d.g.d.d.
-000000f0: 6415 6416 6606 6417 6520 6411 651e 6418  d.d.f.d.e d.e.d.
-00000100: 6520 6419 6521 6608 641a 641b 8405 5a22  e d.e!f.d.d...Z"
-00000110: 6401 5300 291c e900 0000 004e 2901 da06  d.S.)......N)...
-00000120: 4d61 7472 6978 2902 da05 706f 6c61 72da  Matrix)...polar.
-00000130: 046c 6f67 6de9 0100 0000 2901 da14 6973  .logm.....)...is
-00000140: 5f70 6f73 6974 6976 655f 6465 6669 6e69  _positive_defini
-00000150: 7465 2903 da08 6372 6561 7465 5f4a da10  te)...create_J..
-00000160: 6d61 7472 6978 5f66 726f 6d5f 6469 6374  matrix_from_dict
-00000170: da0f 6372 6561 7465 5f70 7132 7869 6574  ..create_pq2xiet
-00000180: 6129 02da 1173 796d 706c 6563 7469 635f  a)...symplectic_
-00000190: 7461 6b61 6769 da15 7379 6d70 6c65 6374  takagi..symplect
-000001a0: 6963 5f74 616b 6167 695f 6f6c 6429 02da  ic_takagi_old)..
-000001b0: 1275 6e69 7461 7279 5f77 696c 6c69 616d  .unitary_william
-000001c0: 736f 6eda 0a77 696c 6c69 616d 736f 6e29  son..williamson)
-000001d0: 01da 0574 686d 3331 2901 da08 6765 744e  ...thm31)...getN
-000001e0: 6172 6773 2901 da10 6765 745f 7061 636b  args)...get_pack
-000001f0: 6167 655f 6e61 6d65 2901 da06 6465 7269  age_name)...deri
-00000200: 7665 6301 0000 0000 0000 0000 0000 000a  vec.............
-00000210: 0000 0004 0000 004b 0000 0073 5800 0000  .......K...sX...
-00000220: 7400 7c00 8301 5c02 7d02 7d03 7401 7c03  t.|...\.}.}.t.|.
-00000230: 8301 7d04 7402 7c02 6601 6900 7c01 a401  ..}.t.|.f.i.|...
-00000240: 8e01 7d05 7c05 a003 a100 a004 a100 7d06  ..}.|.........}.
-00000250: 7c05 7c02 1000 7c06 1000 7d07 7401 7c07  |.|...|...}.t.|.
-00000260: 8301 7d08 7c06 7c08 1000 7c05 1000 7d09  ..}.|.|...|...}.
-00000270: 7c09 7c04 6602 5300 2901 61d2 0200 000a  |.|.f.S.).a.....
-00000280: 2020 2020 4c65 7420 5820 6265 2061 2063      Let X be a c
-00000290: 6f6d 706c 6578 2073 796d 706c 6563 7469  omplex symplecti
-000002a0: 6320 6d61 7472 6978 2c20 692e 652e 2061  c matrix, i.e. a
-000002b0: 206d 6174 7269 7820 7361 7469 7366 7969   matrix satisfyi
-000002c0: 6e67 0a20 2020 2058 2e74 7261 6e73 706f  ng.    X.transpo
-000002d0: 7365 2829 404a 4058 203d 204a 2e0a 2020  se()@J@X = J..  
-000002e0: 2020 0a20 2020 2054 6865 6e20 7468 6973    .    Then this
-000002f0: 2072 6f75 7469 6e65 2077 696c 6c20 6465   routine will de
-00000300: 7465 726d 696e 6520 7477 6f20 6d61 7472  termine two matr
-00000310: 6963 6573 2041 2061 6e64 2042 2073 6f20  ices A and B so 
-00000320: 7468 6174 0a20 2020 2058 203d 2065 7870  that.    X = exp
-00000330: 2841 2940 6578 7028 4229 2c0a 2020 2020  (A)@exp(B),.    
-00000340: 7768 6572 6520 4120 6973 2061 6e20 656c  where A is an el
-00000350: 656d 656e 7420 696e 2073 7028 6e29 2c20  ement in sp(n), 
-00000360: 7468 6520 4c69 652d 616c 6765 6272 6120  the Lie-algebra 
-00000370: 6f66 2053 7028 6e29 203d 2053 7028 326e  of Sp(n) = Sp(2n
-00000380: 3b20 4329 205c 6361 7020 5528 326e 292c  ; C) \cap U(2n),
-00000390: 0a20 2020 2061 6e64 2042 2069 7320 616e  .    and B is an
-000003a0: 2065 6c65 6d65 6e74 206f 6620 7370 2832   element of sp(2
-000003b0: 6e3b 2043 292c 2074 6865 204c 6965 2d61  n; C), the Lie-a
-000003c0: 6c67 6562 7261 206f 6620 5370 2832 6e3b  lgebra of Sp(2n;
-000003d0: 2043 292e 0a20 2020 200a 2020 2020 5061   C)..    .    Pa
-000003e0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-000003f0: 2d2d 2d2d 2d2d 2d0a 2020 2020 583a 206e  -------.    X: n
-00000400: 6461 7272 6179 0a20 2020 2020 2020 2041  darray.        A
-00000410: 6e20 6172 7261 7920 7265 7072 6573 656e  n array represen
-00000420: 7469 6e67 2074 6865 206d 6174 7269 7820  ting the matrix 
-00000430: 582e 0a20 2020 2020 2020 200a 2020 2020  X..        .    
-00000440: 2a2a 6b77 6172 6773 0a20 2020 2020 2020  **kwargs.       
-00000450: 204f 7074 696f 6e61 6c20 6b65 7977 6f72   Optional keywor
-00000460: 6465 6420 6172 6775 6d65 6e74 7320 7061  ded arguments pa
-00000470: 7373 6564 2074 6f20 276c 6965 6f70 732e  ssed to 'lieops.
-00000480: 6c69 6e61 6c67 2e73 696d 696c 6172 6974  linalg.similarit
-00000490: 792e 7379 6d70 6c65 6374 6963 2e74 686d  y.symplectic.thm
-000004a0: 3331 2720 726f 7574 696e 652e 0a20 2020  31' routine..   
-000004b0: 2020 2020 200a 2020 2020 5265 7475 726e       .    Return
-000004c0: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
-000004d0: 2020 413a 206e 6461 7272 6179 0a20 2020    A: ndarray.   
-000004e0: 2020 2020 2041 6e20 6172 7261 7920 7265       An array re
-000004f0: 7072 6573 656e 7469 6e67 2074 6865 206d  presenting the m
-00000500: 6174 7269 7820 412e 0a20 2020 2020 2020  atrix A..       
-00000510: 200a 2020 2020 423a 206e 6461 7272 6179   .    B: ndarray
-00000520: 0a20 2020 2020 2020 2041 6e20 6172 7261  .        An arra
-00000530: 7920 7265 7072 6573 656e 7469 6e67 2074  y representing t
-00000540: 6865 206d 6174 7269 7820 422e 0a20 2020  he matrix B..   
-00000550: 2029 0572 0300 0000 7204 0000 0072 0e00   ).r....r....r..
-00000560: 0000 da09 7472 616e 7370 6f73 65da 0463  ....transpose..c
-00000570: 6f6e 6a29 0ada 0158 da06 6b77 6172 6773  onj)...X..kwargs
-00000580: da01 55da 0150 da04 6c6f 6750 da01 56da  ..U..P..logP..V.
-00000590: 0256 69da 0144 da04 6c6f 6744 da01 59a9  .Vi..D..logD..Y.
-000005a0: 0072 1e00 0000 fa51 2f68 6f6d 652f 6d61  .r.....Q/home/ma
-000005b0: 6c74 652f 6d69 6e69 636f 6e64 6133 2f65  lte/miniconda3/e
-000005c0: 6e76 732f 776f 726b 2f6c 6962 2f70 7974  nvs/work/lib/pyt
-000005d0: 686f 6e33 2e31 302f 7369 7465 2d70 6163  hon3.10/site-pac
-000005e0: 6b61 6765 732f 6c69 656f 7073 2f6c 696e  kages/lieops/lin
-000005f0: 616c 672f 6e66 2e70 79da 0773 796d 6c6f  alg/nf.py..symlo
-00000600: 6773 1400 0000 7310 0000 000c 1a08 0110  gs....s.........
-00000610: 010c 010c 0108 010c 0108 0172 2000 0000  ...........r ...
-00000620: da07 6465 6661 756c 7446 da05 6368 6563  ..defaultF..chec
-00000630: 6b63 0400 0000 0000 0000 0000 0000 1900  kc..............
-00000640: 0000 0900 0000 0b00 0000 73a6 0300 0074  ..........s....t
-00000650: 007c 0083 0189 0088 0064 0116 0064 026b  .|.......d...d.k
-00000660: 0273 0e4a 0064 0383 0182 0174 017c 0083  .s.J.d.....t.|..
-00000670: 017d 0574 007c 0183 0164 026b 0372 227c  .}.t.|...d.k.r"|
-00000680: 01a0 02a1 007d 067c 017c 0010 007c 0610  .....}.|.|...|..
-00000690: 007d 0074 0388 0064 011a 0083 017d 077c  .}.t...d.....}.|
-000006a0: 0564 046b 0272 3174 04a0 057c 07a1 017d  .d.k.r1t...|...}
-000006b0: 077c 0372 5174 067c 0783 017d 0874 067c  .|.rQt.|...}.t.|
-000006c0: 0083 017d 097c 097c 0810 00a0 07a1 005c  ...}.|.|.......\
-000006d0: 027d 0a7d 0b7c 0ba0 08a1 0073 5174 0964  .}.}.|.....sQt.d
-000006e0: 057c 009b 0064 067c 0b9b 009d 0483 0182  .|...d.|........
-000006f0: 017c 0264 076b 0272 7f74 0a7c 0066 0169  .|.d.k.r.t.|.f.i
-00000700: 007c 04a4 018e 015c 027d 0c7d 0d7c 0ca0  .|.....\.}.}.|..
-00000710: 02a1 007d 0c7c 070b 007c 0ca0 02a1 0010  ...}.|...|......
-00000720: 007c 0710 007d 0e7c 0ea0 02a1 007c 0010  .|...}.|.....|..
-00000730: 007c 0e10 007d 0f74 0b64 2a88 007c 0564  .|...}.t.d*..|.d
-00000740: 089c 027c 04a4 018e 017d 106e 747c 0264  ...|.....}.nt|.d
-00000750: 096b 0272 a874 0c7c 0066 0164 0a7c 0369  .k.r.t.|.f.d.|.i
-00000760: 017c 04a4 018e 015c 037d 0c7d 0f7d 117c  .|.....\.}.}.}.|
-00000770: 0ca0 02a1 007d 0c7c 070b 007c 0ca0 02a1  .....}.|...|....
-00000780: 0010 007c 0710 007d 0e74 0b64 2a88 007c  ...|...}.t.d*..|
-00000790: 0564 089c 027c 04a4 018e 017d 106e 4b7c  .d...|.....}.nK|
-000007a0: 0264 0b6b 0272 eb74 0d7c 0083 0172 cf74  .d.k.r.t.|...r.t
-000007b0: 0e64 2a64 0c7c 0069 017c 04a4 018e 015c  .d*d.|.i.|.....\
-000007c0: 027d 0c7d 0f74 0b64 2a88 007c 0564 089c  .}.}.t.d*..|.d..
-000007d0: 027c 04a4 018e 017d 107c 070b 007c 0ca0  .|.....}.|...|..
-000007e0: 02a1 0010 007c 0710 007d 0e6e 247c 0564  .....|...}.n$|.d
-000007f0: 0d6b 0273 d54a 0082 0174 0f64 2a64 0e7c  .k.s.J...t.d*d.|
-00000800: 0069 017c 04a4 018e 015c 037d 0e7d 0f7d  .i.|.....\.}.}.}
-00000810: 107c 070b 007c 0ea0 02a1 0010 007c 0710  .|...|.......|..
-00000820: 007d 0c6e 0874 0964 0f7c 029b 0064 109d  .}.n.t.d.|...d..
-00000830: 0383 0182 017c 10a0 02a1 00a0 10a1 007d  .....|.........}
-00000840: 127c 107c 0710 007c 10a0 02a1 0010 007d  .|.|...|.......}
-00000850: 137c 107c 0c10 007d 147c 0e7c 1210 007d  .|.|...}.|.|...}
-00000860: 1574 007c 0183 0164 026b 0390 0172 307c  .t.|...d.k...r0|
-00000870: 067c 0c10 007c 0110 007d 0c7c 067c 0e10  .|...|...}.|.|..
-00000880: 007c 0110 007d 0e7c 067c 0710 007c 0110  .|...}.|.|...|..
-00000890: 007d 077c 067c 0010 007c 0110 007d 007c  .}.|.|...|...}.|
-000008a0: 147c 0110 007d 147c 067c 1510 007d 1569  .|...}.|.|...}.i
-000008b0: 007d 167c 0c7c 1664 113c 007c 0e7c 1664  .}.|.|.d.<.|.|.d
-000008c0: 123c 007c 007c 1664 133c 007c 0ea0 02a1  .<.|.|.d.<.|....
-000008d0: 007c 0010 007c 0e10 007c 1664 143c 007c  .|...|...|.d.<.|
-000008e0: 017c 1664 153c 007c 077c 1664 163c 007c  .|.d.<.|.|.d.<.|
-000008f0: 137c 1664 173c 007c 107c 1664 183c 007c  .|.d.<.|.|.d.<.|
-00000900: 127c 1664 193c 007c 147c 1664 1a3c 007c  .|.d.<.|.|.d.<.|
-00000910: 157c 1664 1b3c 007c 15a0 02a1 007c 0010  .|.d.<.|.....|..
-00000920: 007c 1510 007c 1664 1c3c 007c 0f7c 1664  .|...|.d.<.|.|.d
-00000930: 1d3c 007c 0564 046b 0390 0172 d17c 107c  .<.|.d.k...r.|.|
-00000940: 0e10 007c 1210 007c 1664 1e3c 007c 04a0  ...|...|.d.<.|..
-00000950: 1164 1f64 20a1 0289 017a 2274 127c 0e83  .d.d ....z"t.|..
-00000960: 017d 177c 077c 17a0 02a1 0010 007c 177c  .}.|.|.......|.|
-00000970: 0710 0017 0089 0274 1387 0087 0187 0266  .......t.......f
-00000980: 0364 2164 2284 0874 1488 0083 0144 0083  .d!d"..t.....D..
-00000990: 0183 0190 0173 a64a 0082 0157 006e 2101  .....s.J...W.n!.
-000009a0: 0001 0001 0074 157c 0e7c 04a0 1164 2364  .....t.|.|...d#d
-000009b0: 02a1 0264 248d 025c 027d 177d 1874 16a0  ...d$..\.}.}.t..
-000009c0: 1764 2588 019b 0064 269d 03a1 0101 007c  .d%....d&......|
-000009d0: 107c 1810 007c 1210 007c 1664 273c 0059  .|...|...|.d'<.Y
-000009e0: 007c 107c 1710 007c 1210 007c 1664 283c  .|.|...|...|.d(<
-000009f0: 007c 1653 0029 2b61 2a11 0000 0a20 2020  .|.S.)+a*....   
-00000a00: 2050 6572 666f 726d 206c 696e 6561 7220   Perform linear 
-00000a10: 6361 6c63 756c 6174 696f 6e73 2074 6f20  calculations to 
-00000a20: 7472 616e 7366 6f72 6d20 6120 6769 7665  transform a give
-00000a30: 6e20 7365 636f 6e64 2d6f 7264 6572 2048  n second-order H
-00000a40: 616d 696c 746f 6e69 616e 2c0a 2020 2020  amiltonian,.    
-00000a50: 6578 7072 6573 7365 6420 696e 2063 616e  expressed in can
-00000a60: 6f6e 6963 616c 2063 6f6f 7264 696e 6174  onical coordinat
-00000a70: 6573 2028 712c 2070 292c 2074 6f0a 2020  es (q, p), to.  
-00000a80: 2020 636f 6d70 6c65 7820 6e6f 726d 616c    complex normal
-00000a90: 2066 6f72 6d20 636f 6f72 6469 6e61 7465   form coordinate
-00000aa0: 7320 7869 2c20 6574 612e 2041 6c6f 6e67  s xi, eta. Along
-00000ab0: 2074 6865 2077 6179 2c20 7468 6520 7379   the way, the sy
-00000ac0: 6d70 6c65 6374 6963 206c 696e 6561 7220  mplectic linear 
-00000ad0: 6d61 7020 746f 0a20 2020 2072 6561 6c20  map to.    real 
-00000ae0: 6e6f 726d 616c 2066 6f72 6d20 6973 2063  normal form is c
-00000af0: 6f6d 7075 7465 642e 2054 6865 2071 7561  omputed. The qua
-00000b00: 6e74 6974 6965 7320 7869 2061 6e64 2065  ntities xi and e
-00000b10: 7461 2061 7265 2064 6566 696e 6564 2061  ta are defined a
-00000b20: 7320 696e 206d 7920 7468 6573 6973 2c0a  s in my thesis,.
-00000b30: 2020 2020 4368 6170 7465 7220 312e 0a20      Chapter 1.. 
-00000b40: 2020 200a 2020 2020 5061 7261 6d74 6572     .    Paramter
-00000b50: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0a  s.    ---------.
-00000b60: 2020 2020 4832 3a0a 2020 2020 2020 2020      H2:.        
-00000b70: 5379 6d6d 6574 7269 6320 6d61 7472 6978  Symmetric matrix
-00000b80: 2073 6f20 7468 6174 2048 3240 4a20 6973   so that H2@J is
-00000b90: 2064 6961 676f 6e61 6c69 7a61 626c 652e   diagonalizable.
-00000ba0: 0a20 2020 2020 2020 2041 7474 656e 7469  .        Attenti
-00000bb0: 6f6e 3a20 4120 6368 6563 6b20 6966 2048  on: A check if H
-00000bc0: 3240 4a20 6973 2064 6961 676f 6e61 6c69  2@J is diagonali
-00000bd0: 7a61 626c 6520 6973 206e 6f74 2064 6f6e  zable is not don
-00000be0: 6520 6578 706c 6963 6974 6c79 2e0a 2020  e explicitly..  
-00000bf0: 2020 2020 2020 0a20 2020 2054 3a20 6d61        .    T: ma
-00000c00: 7472 6978 2c20 6f70 7469 6f6e 616c 0a20  trix, optional. 
-00000c10: 2020 2020 2020 2050 6572 6d75 7461 7469         Permutati
-00000c20: 6f6e 206d 6174 7269 7820 746f 2063 6861  on matrix to cha
-00000c30: 6e67 6520 7468 6520 6f72 6465 7269 6e67  nge the ordering
-00000c40: 206f 6620 6361 6e6f 6e63 6961 6c0a 2020   of canoncial.  
-00000c50: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
-00000c60: 7320 616e 6420 6d6f 6d65 6e74 612c 2067  s and momenta, g
-00000c70: 6976 656e 2068 6572 6520 6279 2064 6566  iven here by def
-00000c80: 6175 6c74 2061 7320 2871 312c 202e 2e2e  ault as (q1, ...
-00000c90: 2c20 716e 2c20 7031 2c20 2e2e 2e2c 2070  , qn, p1, ..., p
-00000ca0: 6e29 2c20 0a20 2020 2020 2020 2069 6e74  n), .        int
-00000cb0: 6f20 6120 6469 6666 6572 656e 7420 6f72  o a different or
-00000cc0: 6465 722e 2049 2e65 2e20 5420 7472 616e  der. I.e. T tran
-00000cd0: 7366 6f72 6d73 2074 6865 200a 2020 2020  sforms the .    
-00000ce0: 2020 2020 286e 2078 206e 2920 626c 6f63      (n x n) bloc
-00000cf0: 6b20 6d61 7472 6978 0a20 2020 2020 2020  k matrix.       
-00000d00: 200a 2020 2020 2020 2020 2020 2020 202f   .             /
-00000d10: 2020 3020 2020 3120 205c 0a20 2020 2020    0   1  \.     
-00000d20: 2020 204a 203d 2020 7c20 2020 2020 2020     J =  |       
-00000d30: 2020 7c0a 2020 2020 2020 2020 2020 2020    |.            
-00000d40: 205c 202d 3120 2020 3020 202f 0a20 2020   \ -1   0  /.   
-00000d50: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
-00000d60: 2020 2069 6e74 6f20 6120 6d61 7472 6978     into a matrix
-00000d70: 204a 2720 6279 206d 6174 7269 7820 636f   J' by matrix co
-00000d80: 6e67 7275 656e 6365 3a20 4a27 203d 2054  ngruence: J' = T
-00000d90: 2e74 7261 6e73 706f 7365 2829 404a 4054  .transpose()@J@T
-00000da0: 2e0a 2020 2020 2020 2020 0a20 2020 206d  ..        .    m
-00000db0: 6f64 653a 2073 7472 2c20 6f70 7469 6f6e  ode: str, option
-00000dc0: 616c 0a20 2020 2020 2020 204d 6574 686f  al.        Metho
-00000dd0: 6420 6f66 2068 6f77 2074 6f20 636f 6d70  d of how to comp
-00000de0: 7574 6520 7468 6520 7379 6d70 6c65 6374  ute the symplect
-00000df0: 6963 206d 6174 7269 6365 7320 7768 6963  ic matrices whic
-00000e00: 6820 636f 6e6a 7567 6174 652d 6469 6167  h conjugate-diag
-00000e10: 6f6e 616c 697a 6520 4832 2e0a 2020 2020  onalize H2..    
-00000e20: 2020 2020 5375 7070 6f72 7465 6420 6d6f      Supported mo
-00000e30: 6465 7320 6172 6520 2864 6566 6175 6c74  des are (default
-00000e40: 3a20 2764 6566 6175 6c74 2729 3a0a 2020  : 'default'):.  
-00000e50: 2020 2020 2020 3129 2027 6465 6661 756c        1) 'defaul
-00000e60: 7427 202d 2d20 5573 6520 7379 6d70 6c65  t' -- Use symple
-00000e70: 6374 6963 2054 616b 6167 6920 6661 6374  ctic Takagi fact
-00000e80: 6f72 697a 6174 696f 6e0a 2020 2020 2020  orization.      
-00000e90: 2020 3229 2027 636c 6173 7369 6327 202d    2) 'classic' -
-00000ea0: 2d20 5573 6520 2875 6e69 7461 7279 2920  - Use (unitary) 
-00000eb0: 5769 6c6c 6961 6d73 6f6e 2064 6961 676f  Williamson diago
-00000ec0: 6e61 6c69 7a61 7469 6f6e 2028 776f 726b  nalization (work
-00000ed0: 7320 6f6e 6c79 2069 6620 4832 2069 7320  s only if H2 is 
-00000ee0: 696e 7665 7274 6962 6c65 2e29 0a20 2020  invertible.).   
-00000ef0: 2020 2020 200a 2020 2020 6368 6563 6b3a       .    check:
-00000f00: 2062 6f6f 6c65 616e 2c20 6f70 7469 6f6e   boolean, option
-00000f10: 616c 0a20 2020 2020 2020 2050 6572 666f  al.        Perfo
-00000f20: 726d 2061 2063 6f6e 7369 7374 656e 6379  rm a consistency
-00000f30: 2063 6865 636b 2077 6865 7468 6572 2048   check whether H
-00000f40: 3240 4a20 6973 2064 6961 676f 6e61 6c69  2@J is diagonali
-00000f50: 7a61 626c 652c 2075 7369 6e67 2073 796d  zable, using sym
-00000f60: 7079 2e0a 2020 2020 2020 2020 0a20 2020  py..        .   
-00000f70: 2074 6f6c 5f6c 6f67 6d3a 2066 6c6f 6174   tol_logm: float
-00000f80: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00000f90: 2020 2041 2074 6f6c 6572 616e 6365 2074     A tolerance t
-00000fa0: 6f20 6465 7465 726d 696e 6520 7768 6574  o determine whet
-00000fb0: 6865 7220 6f6e 6520 6f72 2074 776f 2065  her one or two e
-00000fc0: 7870 6f6e 656e 7469 616c 7320 6172 6520  xponentials are 
-00000fd0: 7265 7175 6972 6564 2066 6f72 2074 6865  required for the
-00000fe0: 206d 6170 2074 6f20 6e6f 726d 616c 2066   map to normal f
-00000ff0: 6f72 6d2e 0a20 2020 2020 2020 2041 7474  orm..        Att
-00001000: 656e 7469 6f6e 3a20 4120 7661 6c75 6520  ention: A value 
-00001010: 6f66 207a 6572 6f20 7769 6c6c 2072 6573  of zero will res
-00001020: 756c 7420 696e 2074 776f 2065 7870 6f6e  ult in two expon
-00001030: 656e 7469 616c 732c 2077 6869 6368 206d  entials, which m
-00001040: 6967 6874 206e 6f74 2061 6c77 6179 7320  ight not always 
-00001050: 6265 2064 6573 6972 6564 2e0a 2020 2020  be desired..    
-00001060: 2020 2020 466f 7220 7468 6973 2072 6561      For this rea
-00001070: 736f 6e20 7468 6520 746f 6c65 7261 6e63  son the toleranc
-00001080: 6520 6973 2073 6574 2074 6f20 6120 736d  e is set to a sm
-00001090: 616c 6c20 7661 6c75 6520 6279 2064 6566  all value by def
-000010a0: 6175 6c74 2061 6e64 2061 2077 6172 6e69  ault and a warni
-000010b0: 6e67 2077 696c 6c20 6265 2069 7373 7565  ng will be issue
-000010c0: 6420 6966 0a20 2020 2020 2020 2074 776f  d if.        two
-000010d0: 2065 7870 6f6e 656e 7473 2068 6176 6520   exponents have 
-000010e0: 6265 656e 2066 6f75 6e64 2069 6e73 7465  been found inste
-000010f0: 6164 206f 6620 6f6e 652e 0a20 2020 2020  ad of one..     
-00001100: 2020 2020 2020 2020 0a20 2020 2052 6574          .    Ret
-00001110: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
-00001120: 0a20 2020 2064 6963 740a 2020 2020 2020  .    dict.      
-00001130: 2020 4469 6374 696f 6e61 7279 2063 6f6e    Dictionary con
-00001140: 7461 696e 696e 6720 7661 7269 6f75 7320  taining various 
-00001150: 6c69 6e65 6172 206d 6170 732e 2054 6865  linear maps. The
-00001160: 2069 7465 6d73 206f 6620 7468 6973 2064   items of this d
-00001170: 6963 7469 6f6e 6172 7920 6172 6520 6465  ictionary are de
-00001180: 7363 7269 6265 6420 696e 2074 6865 2066  scribed in the f
-00001190: 6f6c 6c6f 7769 6e67 2e0a 2020 2020 2020  ollowing..      
-000011a0: 2020 0a20 2020 2020 2020 2053 2020 2020    .        S    
-000011b0: 2020 3a20 5468 6520 7379 6d70 6c65 6374    : The symplect
-000011c0: 6963 206d 6170 2064 6961 676f 6e61 6c69  ic map diagonali
-000011d0: 7a69 6e67 2048 3220 7669 6120 532e 7472  zing H2 via S.tr
-000011e0: 616e 7370 6f73 6528 2940 4440 5320 3d20  anspose()@D@S = 
-000011f0: 4832 2c20 7768 6572 6520 4420 6973 2061  H2, where D is a
-00001200: 2064 6961 676f 6e61 6c20 6d61 7472 6978   diagonal matrix
-00001210: 2e0a 2020 2020 2020 2020 5369 6e76 2020  ..        Sinv  
-00001220: 203a 2054 6865 2069 6e76 6572 7365 206f   : The inverse o
-00001230: 6620 532c 2069 2e65 2e20 7468 6520 7379  f S, i.e. the sy
-00001240: 6d70 6c65 6374 6963 206d 6170 2074 6f20  mplectic map to 
-00001250: 2872 6561 6c29 206e 6f72 6d61 6c20 666f  (real) normal fo
-00001260: 726d 2e20 2020 2020 2020 200a 2020 2020  rm.        .    
-00001270: 2020 2020 4832 2020 2020 203a 2054 6865      H2     : The
-00001280: 2069 6e70 7574 2069 6e20 6d61 7472 6978   input in matrix
-00001290: 2066 6f72 6d2e 0a20 2020 2020 2020 2054   form..        T
-000012a0: 2020 2020 2020 3a20 5468 6520 286f 7074        : The (opt
-000012b0: 696f 6e61 6c29 206d 6174 7269 7820 5420  ional) matrix T 
-000012c0: 6465 7363 7269 6265 6420 6162 6f76 652e  described above.
-000012d0: 0a20 2020 2020 2020 204a 2020 2020 2020  .        J      
-000012e0: 3a20 5468 6520 286f 7269 6769 6e61 6c29  : The (original)
-000012f0: 2073 796d 706c 6563 7469 6320 7374 7275   symplectic stru
-00001300: 6374 7572 6520 4a27 203d 2054 2e74 7261  cture J' = T.tra
-00001310: 6e73 706f 7365 2829 404a 4054 2077 6974  nspose()@J@T wit
-00001320: 6869 6e20 7768 6963 6820 7468 6520 696e  hin which the in
-00001330: 7075 7420 4861 6d69 6c74 6f6e 6961 6e20  put Hamiltonian 
-00001340: 7761 7320 666f 726d 756c 6174 6564 2e0a  was formulated..
-00001350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001360: 2048 6572 6562 7920 4a20 6973 2074 6865   Hereby J is the
-00001370: 2062 6c6f 636b 2d6d 6174 7269 7820 6672   block-matrix fr
-00001380: 6f6d 2061 626f 7665 2e0a 2020 2020 2020  om above..      
-00001390: 2020 4a32 2020 2020 203a 2054 6865 206e    J2     : The n
-000013a0: 6577 2073 796d 706c 6563 7469 6320 7374  ew symplectic st
-000013b0: 7275 6374 7572 6520 666f 7220 7468 6520  ructure for the 
-000013c0: 2878 692c 2065 7461 292d 636f 6f72 6469  (xi, eta)-coordi
-000013d0: 6e61 7465 732e 0a20 2020 2020 2020 2055  nates..        U
-000013e0: 2020 2020 2020 3a20 5468 6520 756e 6974        : The unit
-000013f0: 6172 7920 6d61 7020 6672 6f6d 2074 6865  ary map from the
-00001400: 2053 2871 2c20 7029 203d 2028 752c 2076   S(q, p) = (u, v
-00001410: 292d 626c 6f63 6b20 636f 6f72 6469 6e61  )-block coordina
-00001420: 7465 7320 746f 2074 6865 2028 7869 2c20  tes to the (xi, 
-00001430: 6574 6129 2d63 6f6f 7264 696e 6174 6573  eta)-coordinates
-00001440: 2e0a 2020 2020 2020 2020 5569 6e76 2020  ..        Uinv  
-00001450: 203a 2054 6865 2069 6e76 6572 7365 206f   : The inverse o
-00001460: 6620 552e 0a20 2020 2020 2020 204b 2020  f U..        K  
-00001470: 2020 2020 3a20 5468 6520 6c69 6e65 6172      : The linear
-00001480: 206d 6170 2074 7261 6e73 666f 726d 696e   map transformin
-00001490: 6720 2871 2c20 7029 2074 6f20 2878 692c  g (q, p) to (xi,
-000014a0: 2065 7461 292d 636f 6f72 6469 6e61 7465   eta)-coordinate
-000014b0: 732e 204b 2069 7320 6769 7665 6e20 6279  s. K is given by
-000014c0: 2055 4053 4054 2e0a 2020 2020 2020 2020   U@S@T..        
-000014d0: 4b69 6e76 2020 203a 2054 6865 2069 6e76  Kinv   : The inv
-000014e0: 6572 7365 206f 6620 4b2e 2048 656e 6365  erse of K. Hence
-000014f0: 2c20 6974 2077 696c 6c20 7472 616e 7366  , it will transf
-00001500: 6f72 6d20 4832 2074 6f20 636f 6d70 6c65  orm H2 to comple
-00001510: 7820 6e6f 726d 616c 2066 6f72 6d20 7669  x normal form vi
-00001520: 6120 4b69 6e76 2e74 7261 6e73 706f 7365  a Kinv.transpose
-00001530: 2829 4048 3240 4b69 6e76 2e0a 2020 2020  ()@H2@Kinv..    
-00001540: 2020 2020 726e 6620 2020 203a 2054 6865      rnf    : The
-00001550: 2027 7265 616c 2720 6e6f 726d 616c 2066   'real' normal f
-00001560: 6f72 6d2c 2062 7920 7768 6963 6820 7765  orm, by which we
-00001570: 2075 6e64 6572 7374 616e 6420 7468 6520   understand the 
-00001580: 6469 6167 6f6e 616c 697a 6174 696f 6e20  diagonalization 
-00001590: 6f66 2048 3220 7265 6c61 7469 7665 2074  of H2 relative t
-000015a0: 6f20 7468 6520 0a20 2020 2020 2020 2020  o the .         
-000015b0: 2020 2020 2020 2020 7379 6d70 6c65 6374          symplect
-000015c0: 6963 206d 6174 7269 7820 532e 204e 6f74  ic matrix S. Not
-000015d0: 6520 7468 6174 2053 206d 6967 6874 2062  e that S might b
-000015e0: 6520 636f 6d70 6c65 7820 6966 2074 6865  e complex if the
-000015f0: 2048 6573 7365 206d 6174 7269 7820 6f66   Hesse matrix of
-00001600: 2048 3220 6973 206e 6f74 2070 6f73 6974   H2 is not posit
-00001610: 6976 6520 6465 6669 6e69 7465 2e0a 2020  ive definite..  
-00001620: 2020 2020 2020 636e 6620 2020 203a 2054        cnf    : T
-00001630: 6865 2027 636f 6d70 6c65 7827 206e 6f72  he 'complex' nor
-00001640: 6d61 6c20 666f 726d 2c20 7768 6963 6820  mal form, which 
-00001650: 6973 2067 6976 656e 2061 7320 7468 6520  is given as the 
-00001660: 7265 7072 6573 656e 7461 7469 6f6e 206f  representation o
-00001670: 6620 4832 2069 6e20 7465 726d 7320 6f66  f H2 in terms of
-00001680: 2074 6865 2063 6f6d 706c 6578 0a20 2020   the complex.   
-00001690: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
-000016a0: 726d 616c 697a 696e 6720 2878 692c 2065  rmalizing (xi, e
-000016b0: 7461 292d 636f 6f72 6469 6e61 7465 7320  ta)-coordinates 
-000016c0: 2874 6865 2027 6e65 7727 2063 6f6d 706c  (the 'new' compl
-000016d0: 6578 2073 796d 706c 6563 7469 6320 7374  ex symplectic st
-000016e0: 7275 6374 7572 6529 2e0a 2020 2020 2020  ructure)..      
-000016f0: 2020 4120 2020 2020 203a 2041 2063 6f6d    A      : A com
-00001700: 706c 6578 206d 6174 7269 7820 7472 616e  plex matrix tran
-00001710: 7366 6f72 6d69 6e67 2074 6865 2075 6e64  sforming the und
-00001720: 6572 6c79 696e 6720 4861 6d69 6c74 6f6e  erlying Hamilton
-00001730: 6961 6e20 4820 2877 686f 7365 2048 6573  ian H (whose Hes
-00001740: 7365 2d6d 6174 7269 7820 636f 7272 6573  se-matrix corres
-00001750: 706f 6e64 7320 746f 2048 3229 2c0a 2020  ponds to H2),.  
-00001760: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-00001770: 6976 656e 2069 6e20 7465 726d 7320 6f66  iven in terms of
-00001780: 2063 6f6d 706c 6578 2028 7869 2c20 6574   complex (xi, et
-00001790: 6129 2d63 6f6f 7264 696e 6174 6573 2c20  a)-coordinates, 
-000017a0: 696e 746f 206e 6f72 6d61 6c20 666f 726d  into normal form
-000017b0: 204e 2076 6961 204e 203d 2048 206f 2041   N via N = H o A
-000017c0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000017d0: 2020 2049 7420 686f 6c64 7320 4120 3d20     It holds A = 
-000017e0: 5540 5369 6e76 4055 696e 762e 202a 4375  U@Sinv@Uinv. *Cu
-000017f0: 7272 656e 746c 7920 6f6e 6c79 2072 6574  rrently only ret
-00001800: 7572 6e65 6420 666f 7220 6e75 6d70 7920  urned for numpy 
-00001810: 696e 7075 742a 0a20 2020 2020 2020 2053  input*.        S
-00001820: 312c 2053 3220 3a20 456c 656d 656e 7473  1, S2 : Elements
-00001830: 206f 6620 7370 2832 6e3b 2043 2920 2874   of sp(2n; C) (t
-00001840: 6865 204c 6965 2d61 6c67 6562 7261 206f  he Lie-algebra o
-00001850: 6620 636f 6d70 6c65 7820 7379 6d70 6c65  f complex symple
-00001860: 6374 6963 206d 6174 7269 6365 7329 2073  ctic matrices) s
-00001870: 6174 6973 6679 696e 670a 2020 2020 2020  atisfying.      
-00001880: 2020 2020 2020 2020 2020 2041 203d 2065             A = e
-00001890: 7870 2853 3129 4065 7870 2853 3229 2e20  xp(S1)@exp(S2). 
-000018a0: 5468 6573 6520 6d61 7472 6963 6573 2063  These matrices c
-000018b0: 616e 2062 6520 7573 6564 2074 6f20 6f62  an be used to ob
-000018c0: 7461 696e 2072 6573 7065 6374 6976 6520  tain respective 
-000018d0: 706f 6c79 6e6f 6d69 616c 2072 6570 7265  polynomial repre
-000018e0: 7365 6e74 6174 696f 6e73 0a20 2020 2020  sentations.     
-000018f0: 2020 2020 2020 2020 2020 2020 6f66 2074              of t
-00001900: 6865 204c 6965 2d6f 7065 7261 746f 722c  he Lie-operator,
-00001910: 206d 6170 7069 6e67 2074 6865 2067 6976   mapping the giv
-00001920: 656e 2048 616d 696c 746f 6e69 616e 2048  en Hamiltonian H
-00001930: 2069 6e74 6f20 6974 7320 2266 6972 7374   into its "first
-00001940: 2d6f 7264 6572 2220 6e6f 726d 616c 2066  -order" normal f
-00001950: 6f72 6d20 4e20 2873 6565 0a20 2020 2020  orm N (see.     
-00001960: 2020 2020 2020 2020 2020 2020 616c 736f              also
-00001970: 2074 6865 2063 6f6d 6d6d 656e 7420 6162   the commment ab
-00001980: 6f76 6529 2e20 4e6f 7465 2074 6861 7420  ove). Note that 
-00001990: 6966 2053 3120 6f72 2053 3220 646f 6573  if S1 or S2 does
-000019a0: 206e 6f74 2065 7869 7374 2c20 7468 6973   not exist, this
-000019b0: 206d 6561 6e73 2074 6861 7420 7468 6520   means that the 
-000019c0: 7265 7370 6563 7469 7665 2065 6c65 6d65  respective eleme
-000019d0: 6e74 2069 7320 7a65 726f 2c20 736f 2074  nt is zero, so t
-000019e0: 6865 2065 6c65 6d65 6e74 2041 2063 616e  he element A can
-000019f0: 2062 6520 7265 7065 7365 6e74 6564 2061   be repesented a
-00001a00: 7320 6120 7369 6e67 6c65 2065 7870 6f6e  s a single expon
-00001a10: 656e 7469 616c 2e20 5468 6520 746f 6c65  ential. The tole
-00001a20: 7261 6e63 6520 7768 6963 680a 2020 2020  rance which.    
-00001a30: 2020 2020 2020 2020 2020 2020 2064 6574               det
-00001a40: 6572 6d69 6e65 7320 7468 6973 2062 6568  ermines this beh
-00001a50: 6176 696f 7220 6361 6e20 6265 2063 6f6e  avior can be con
-00001a60: 7472 6f6c 6c65 6420 7769 7468 2074 6865  trolled with the
-00001a70: 2074 6f6c 5f6c 6f67 6d20 7061 7261 6d65   tol_logm parame
-00001a80: 7465 722e 2053 6f20 6966 2074 6861 7420  ter. So if that 
-00001a90: 7061 7261 6d65 7465 720a 2020 2020 2020  parameter.      
-00001aa0: 2020 2020 2020 2020 2020 2069 7320 7365             is se
-00001ab0: 7420 746f 207a 6572 6f2c 2074 6865 7265  t to zero, there
-00001ac0: 2077 696c 6c20 616c 7761 7973 2062 6520   will always be 
-00001ad0: 7265 7475 726e 6564 2074 776f 2065 6c65  returned two ele
-00001ae0: 6d65 6e74 732e 0a20 2020 2020 2020 2020  ments..         
-00001af0: 2020 2020 2020 2020 2a43 7572 7265 6e74          *Current
-00001b00: 6c79 206f 6e6c 7920 7265 7475 726e 6564  ly only returned
-00001b10: 2066 6f72 206e 756d 7079 2069 6e70 7574   for numpy input
-00001b20: 2a0a 2020 2020 e902 0000 0072 0100 0000  *.    .....r....
-00001b30: 7a17 4469 6d65 6e73 696f 6e20 6d75 7374  z.Dimension must
-00001b40: 2062 6520 6576 656e 2eda 066d 706d 6174   be even...mpmat
-00001b50: 687a 2d4a 6f72 6461 6e20 6e6f 726d 616c  hz-Jordan normal
-00001b60: 2066 6f72 6d20 6f66 2048 3240 4a20 6e6f   form of H2@J no
-00001b70: 7420 6469 6167 6f6e 616c 3a0a 4832 3a0a  t diagonal:.H2:.
-00001b80: 7a06 0a4a 4e46 3a0a da03 6e65 7729 02da  z..JNF:...new)..
-00001b90: 0364 696d da04 636f 6465 7221 0000 0072  .dim..coder!...r
-00001ba0: 2200 0000 da07 636c 6173 7369 6372 1900  ".....classicr..
-00001bb0: 0000 da05 6e75 6d70 79da 014d 7a06 4d6f  ....numpy..Mz.Mo
-00001bc0: 6465 2027 7a11 2720 6e6f 7420 7265 636f  de 'z.' not reco
-00001bd0: 676e 697a 6564 2eda 0153 da04 5369 6e76  gnized...S..Sinv
-00001be0: da02 4832 da03 726e 66da 0154 da01 4ada  ..H2..rnf..T..J.
-00001bf0: 024a 3272 1600 0000 da04 5569 6e76 da01  .J2r......Uinv..
-00001c00: 4bda 044b 696e 76da 0363 6e66 721b 0000  K..Kinv..cnfr...
-00001c10: 00da 0141 da08 746f 6c5f 6c6f 676d e79b  ...A..tol_logm..
-00001c20: 2ba1 869b 8406 3d63 0100 0000 0000 0000  +.....=c........
-00001c30: 0000 0000 0300 0000 0700 0000 1300 0000  ................
-00001c40: 732e 0000 0067 007c 005d 137d 0174 0088  s....g.|.].}.t..
-00001c50: 0083 0144 005d 0c7d 0274 0188 027c 017c  ...D.].}.t...|.|
-00001c60: 0266 0219 0083 0188 016b 0091 0371 0871  .f.......k...q.q
-00001c70: 0253 0072 1e00 0000 2902 da05 7261 6e67  .S.r....)...rang
-00001c80: 65da 0361 6273 2903 da02 2e30 da01 69da  e..abs)....0..i.
-00001c90: 016a a903 7226 0000 0072 3700 0000 da04  .j..r&...r7.....
-00001ca0: 7a65 726f 721e 0000 0072 1f00 0000 da0a  zeror....r......
-00001cb0: 3c6c 6973 7463 6f6d 703e e500 0000 f302  <listcomp>......
-00001cc0: 0000 002e 007a 1f6e 6f72 6d61 6c5f 666f  .....z.normal_fo
-00001cd0: 726d 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973  rm.<locals>.<lis
-00001ce0: 7463 6f6d 703e da0c 7379 6d6c 6f67 735f  tcomp>..symlogs_
-00001cf0: 746f 6c32 2901 da04 746f 6c32 7a49 4d61  tol2)...tol2zIMa
-00001d00: 7472 6978 2061 7070 6561 7273 2074 6f20  trix appears to 
-00001d10: 7265 7175 6972 6520 7477 6f20 6578 706f  require two expo
-00001d20: 6e65 6e74 6961 6c73 2066 6f72 2072 6570  nentials for rep
-00001d30: 7265 7365 6e74 6174 696f 6e20 2874 6f6c  resentation (tol
-00001d40: 5f6c 6f67 6d3a 20fa 0129 da02 4332 da02  _logm: ..)..C2..
-00001d50: 4331 4e72 1e00 0000 2918 da03 6c65 6e72  C1Nr....)...lenr
-00001d60: 1000 0000 7212 0000 0072 0700 0000 da02  ....r....r......
-00001d70: 6d70 da06 6d61 7472 6978 da0c 7379 6d70  mp..matrix..symp
-00001d80: 795f 6d61 7472 6978 da0b 6a6f 7264 616e  y_matrix..jordan
-00001d90: 5f66 6f72 6dda 0b69 735f 6469 6167 6f6e  _form..is_diagon
-00001da0: 616c da0c 5275 6e74 696d 6545 7272 6f72  al..RuntimeError
-00001db0: 720a 0000 0072 0900 0000 720b 0000 0072  r....r....r....r
-00001dc0: 0600 0000 720d 0000 0072 0c00 0000 da09  ....r....r......
-00001dd0: 636f 6e6a 7567 6174 65da 0367 6574 7204  conjugate..getr.
-00001de0: 0000 00da 0361 6c6c 7239 0000 0072 2000  .....allr9...r .
-00001df0: 0000 da08 7761 726e 696e 6773 da04 7761  ....warnings..wa
-00001e00: 726e 2919 722d 0000 0072 2f00 0000 da04  rn).r-...r/.....
-00001e10: 6d6f 6465 7222 0000 0072 1500 0000 7227  moder"...r....r'
-00001e20: 0000 00da 0554 5f63 7472 7230 0000 00da  .....T_ctrr0....
-00001e30: 064a 5f73 796d 70da 0647 5f73 796d 70da  .J_symp..G_symp.
-00001e40: 0650 5f73 796d 70da 034a 4e46 722b 0000  .P_symp..JNFr+..
-00001e50: 0072 1400 0000 722c 0000 0072 1b00 0000  .r....r,...r....
-00001e60: 7216 0000 00da 015f 7232 0000 0072 3100  r......_r2...r1.
-00001e70: 0000 7233 0000 0072 3400 0000 da03 6f75  ..r3...r4.....ou
-00001e80: 74da 0242 31da 0242 3272 1e00 0000 723e  t..B1..B2r....r>
-00001e90: 0000 0072 1f00 0000 da0b 6e6f 726d 616c  ...r......normal
-00001ea0: 5f66 6f72 6d37 0000 0073 9200 0000 0848  _form7...s.....H
-00001eb0: 1401 0801 0c02 0801 0c01 0c02 0801 0a01  ................
-00001ec0: 0402 0804 0801 1001 0801 1401 0803 1402  ................
-00001ed0: 0801 1201 1002 1601 0801 1a04 0801 1201  ................
-00001ee0: 1601 0801 0802 1601 1402 1401 0c02 1802  ................
-00001ef0: 1401 1002 0c05 1003 0804 0801 0e02 0c01  ................
-00001f00: 0c01 0c01 0c01 0801 0801 0403 0801 0801  ................
-00001f10: 0802 1401 0801 0801 0801 0801 0801 0801  ................
-00001f20: 0801 1401 0801 0a05 1001 0c01 0201 0801  ................
-00001f30: 1402 2801 0601 1802 1201 1201 1001 0403  ..(.............
-00001f40: 725d 0000 0072 2300 0000 7238 0000 0072  r]...r#...r8...r
-00001f50: 2900 0000 da05 706f 7765 72da 066e 5f61  ).....power..n_a
-00001f60: 7267 73da 0374 6f6c 6307 0000 0000 0000  rgs..tolc.......
-00001f70: 0000 0000 0015 0000 0009 0000 000b 0000  ................
-00001f80: 0073 f801 0000 7c01 6401 6b05 7306 4a00  .s....|.d.k.s.J.
-00001f90: 8201 7c04 7d08 7c04 6402 6b02 7210 7400  ..|.}.|.d.k.r.t.
-00001fa0: 8800 8301 7d08 7c08 6401 1600 6402 6b02  ....}.|.d...d.k.
-00001fb0: 731a 4a00 6403 8301 8201 7401 8806 8301  s.J.d.....t.....
-00001fc0: 6402 6b04 723b 7401 8806 8301 7c08 6b02  d.k.r;t.....|.k.
-00001fd0: 7333 4a00 6404 7401 8806 8301 9b00 6405  s3J.d.t.......d.
-00001fe0: 7c08 9b00 6406 9d05 8301 8201 8700 8706  |...d...........
-00001ff0: 6602 6407 6408 8408 8901 6e07 8800 8901  f.d.d.....n.....
-00002000: 7c08 6402 6701 1400 8906 7402 8801 6401  |.d.g.....t...d.
-00002010: 7c08 6409 8d03 7d09 7c08 6402 6701 1400  |.d...}.|.d.g...
-00002020: 7d0a 7c09 6a03 7c0a 8e00 7d0b 7404 7c0b  }.|.j.|...}.t.|.
-00002030: 640a 7c08 7c08 640b 8d04 7d0c 7c06 640c  d.|.|.d...}.|.d.
-00002040: 6b02 7264 7405 a006 7c0c a101 7d0c 7c03  k.rdt...|...}.|.
-00002050: 7290 7c09 a007 a100 8904 8704 6601 640d  r.|.........f.d.
-00002060: 640e 8408 7408 7c08 8301 4400 8301 7d0d  d...t.|...D...}.
-00002070: 7409 8705 6601 640f 640e 8408 7c0d 4400  t...f.d.d...|.D.
-00002080: 8301 8301 6402 6b04 7290 740a a00b 6410  ....d.k.r.t...d.
-00002090: 8806 9b00 6411 8805 9b00 6412 7c0d 9b00  ....d.....d.|...
-000020a0: 9d06 a101 0100 740c 7c0c 6601 8805 7c03  ......t.|.f...|.
-000020b0: 6413 9c02 7c07 a401 8e01 7d0e 7c0e 6414  d...|.....}.|.d.
-000020c0: 1900 8902 8702 6601 6415 6408 8408 8903  ......f.d.d.....
-000020d0: 8701 8703 6602 6416 6408 8408 7d0f 7402  ....f.d.d...}.t.
-000020e0: 7c0f 7c01 7c08 6409 8d03 7d10 7c10 7c0a  |.|.|.d...}.|.|.
-000020f0: 6417 6418 6901 8e01 7d11 7c03 72f8 7c10  d.d.i...}.|.r.|.
-00002100: 6a03 7c11 6419 8d01 7d12 8705 6601 641a  j.|.d...}...f.d.
-00002110: 641b 8408 7c12 a00d a100 4400 8301 7d12  d...|.....D...}.
-00002120: 7c12 a00e a100 4400 5d26 7d13 740f 7c12  |.....D.]&}.t.|.
-00002130: 7c13 1900 7c0e 641c 1900 7c13 6402 1900  |...|.d...|.d...
-00002140: 7c13 640a 1900 6602 1900 1800 8301 7d14  |.d...f.......}.
-00002150: 7c14 8805 6b04 72f7 7410 641d 7c13 9b00  |...k.r.t.d.|...
-00002160: 641e 7c14 9b00 641f 8805 9b00 6420 9d07  d.|...d.....d ..
-00002170: 8301 8201 71d1 7c11 7c0e 6602 5300 2921  ....q.|.|.f.S.)!
-00002180: 611b 0600 000a 2020 2020 5265 7475 726e  a.....    Return
-00002190: 2074 6865 2054 6179 6c6f 722d 6578 7061   the Taylor-expa
-000021a0: 6e73 696f 6e20 6f66 2061 2048 616d 696c  nsion of a Hamil
-000021b0: 746f 6e69 616e 2048 2069 6e20 7465 726d  tonian H in term
-000021c0: 7320 6f66 2066 6972 7374 2d6f 7264 6572  s of first-order
-000021d0: 2063 6f6d 706c 6578 206e 6f72 6d61 6c20   complex normal 
-000021e0: 666f 726d 2063 6f6f 7264 696e 6174 6573  form coordinates
-000021f0: 0a20 2020 2061 726f 756e 6420 616e 206f  .    around an o
-00002200: 7074 696f 6e61 6c20 706f 696e 7420 6f66  ptional point of
-00002210: 2069 6e74 6572 6573 742e 2046 6f72 2074   interest. For t
-00002220: 6865 206e 6f74 6174 696f 6e20 7365 6520  he notation see 
-00002230: 6d79 2074 6865 7369 732e 0a20 2020 200a  my thesis..    .
-00002240: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00002250: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00002260: 2020 483a 2063 616c 6c61 626c 650a 2020    H: callable.  
-00002270: 2020 2020 2020 4120 7265 616c 2d76 616c        A real-val
-00002280: 7565 6420 6675 6e63 7469 6f6e 206f 6620  ued function of 
-00002290: 322a 6e20 7061 7261 6d65 7465 7273 2028  2*n parameters (
-000022a0: 4861 6d69 6c74 6f6e 6961 6e29 2e0a 2020  Hamiltonian)..  
-000022b0: 2020 2020 2020 0a20 2020 2070 6f77 6572        .    power
-000022c0: 3a20 696e 742c 206f 7074 696f 6e61 6c0a  : int, optional.
-000022d0: 2020 2020 2020 2020 5468 6520 6d61 7869          The maxi
-000022e0: 6d61 6c20 706f 6c79 6e6f 6d69 616c 2070  mal polynomial p
-000022f0: 6f77 6572 206f 6620 6578 7061 6e73 696f  ower of expansio
-00002300: 6e2e 204d 7573 7420 6265 203e 3d20 322e  n. Must be >= 2.
-00002310: 0a20 2020 200a 2020 2020 7a3a 2073 7562  .    .    z: sub
-00002320: 7363 7269 7074 6162 6c65 2c20 6f70 7469  scriptable, opti
-00002330: 6f6e 616c 0a20 2020 2020 2020 2041 2070  onal.        A p
-00002340: 6f69 6e74 206f 6620 696e 7465 7265 7374  oint of interest
-00002350: 2061 726f 756e 6420 7768 6963 6820 7765   around which we
-00002360: 2077 616e 7420 746f 2065 7870 616e 642e   want to expand.
-00002370: 2049 6620 6e6f 7468 696e 6720 7370 6563   If nothing spec
-00002380: 6966 6965 642c 0a20 2020 2020 2020 2074  ified,.        t
-00002390: 6865 6e20 7468 6520 6578 7061 6e73 696f  hen the expansio
-000023a0: 6e20 7769 6c6c 2074 616b 6520 706c 6163  n will take plac
-000023b0: 6520 6172 6f75 6e64 207a 6572 6f2e 0a20  e around zero.. 
-000023c0: 2020 2020 2020 200a 2020 2020 6e5f 6172         .    n_ar
-000023d0: 6773 3a20 696e 742c 206f 7074 696f 6e61  gs: int, optiona
-000023e0: 6c0a 2020 2020 2020 2020 4966 2048 2074  l.        If H t
-000023f0: 616b 6573 2061 2073 696e 676c 6520 7375  akes a single su
-00002400: 6273 6372 6970 7461 626c 6520 6173 2061  bscriptable as a
-00002410: 7267 756d 656e 742c 2064 6566 696e 6520  rgument, define 
-00002420: 7468 6520 6e75 6d62 6572 206f 6620 6172  the number of ar
-00002430: 6775 6d65 6e74 7320 7769 7468 2074 6869  guments with thi
-00002440: 7320 7061 7261 6d65 7465 722e 0a20 2020  s parameter..   
-00002450: 2020 2020 200a 2020 2020 6368 6563 6b3a       .    check:
-00002460: 2062 6f6f 6c65 616e 2c20 6f70 7469 6f6e   boolean, option
-00002470: 616c 0a20 2020 2020 2020 2054 7572 6e20  al.        Turn 
-00002480: 6f6e 2073 6f6d 6520 6261 7369 6320 6368  on some basic ch
-00002490: 6563 6b73 3a0a 2020 2020 2020 2020 6129  ecks:.        a)
-000024a0: 2057 6172 6e20 6966 2074 6865 2065 7870   Warn if the exp
-000024b0: 616e 7369 6f6e 206f 6620 7468 6520 4861  ansion of the Ha
-000024c0: 6d69 6c74 6f6e 6961 6e20 6172 6f75 6e64  miltonian around
-000024d0: 207a 2063 6f6e 7461 696e 7320 6772 6164   z contains grad
-000024e0: 6965 6e74 2074 6572 6d73 206c 6172 6765  ient terms large
-000024f0: 7220 7468 616e 2061 2073 7065 6369 6669  r than a specifi
-00002500: 6320 7661 6c75 652e 200a 2020 2020 2020  c value. .      
-00002510: 2020 6229 2056 6572 6966 7920 7468 6174    b) Verify that
-00002520: 2074 6865 2032 6e64 206f 7264 6572 2074   the 2nd order t
-00002530: 6572 6d73 2069 6e20 7468 6520 6578 7061  erms in the expa
-00002540: 6e73 696f 6e20 6f66 2074 6865 2048 616d  nsion of the Ham
-00002550: 696c 746f 6e69 616e 2061 6772 6565 2077  iltonian agree w
-00002560: 6974 6820 7468 6f73 6520 6672 6f6d 2074  ith those from t
-00002570: 6865 206c 696e 6561 7220 7468 656f 7279  he linear theory
-00002580: 2e0a 2020 2020 2020 2020 0a20 2020 2074  ..        .    t
-00002590: 6f6c 3a20 666c 6f61 742c 206f 7074 696f  ol: float, optio
-000025a0: 6e61 6c0a 2020 2020 2020 2020 416e 206f  nal.        An o
-000025b0: 7074 696f 6e61 6c20 746f 6c65 7261 6e63  ptional toleranc
-000025c0: 6520 666f 7220 6368 6563 6b73 2e0a 2020  e for checks..  
-000025d0: 2020 2020 2020 0a20 2020 202a 2a6b 7761        .    **kwa
-000025e0: 7267 730a 2020 2020 2020 2020 4172 6775  rgs.        Argu
-000025f0: 6d65 6e74 7320 7061 7373 6564 2074 6f20  ments passed to 
-00002600: 6c69 6e61 6c67 2e6e 6f72 6d61 6c5f 666f  linalg.normal_fo
-00002610: 726d 2072 6f75 7469 6e65 2e0a 2020 2020  rm routine..    
-00002620: 2020 2020 0a20 2020 2052 6574 7572 6e73      .    Returns
-00002630: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
-00002640: 2064 6963 740a 2020 2020 2020 2020 4120   dict.        A 
-00002650: 6469 6374 696f 6e61 7279 206f 6620 7468  dictionary of th
-00002660: 6520 5461 796c 6f72 2063 6f65 6666 6963  e Taylor coeffic
-00002670: 6965 6e74 7320 6f66 2074 6865 2048 616d  ients of the Ham
-00002680: 696c 746f 6e69 616e 2069 6e20 6e6f 726d  iltonian in norm
-00002690: 616c 2066 6f72 6d20 6172 6f75 6e64 207a  al form around z
-000026a0: 203d 2028 712c 2070 292c 2077 6865 7265   = (q, p), where
-000026b0: 2074 6865 2066 6972 7374 206e 0a20 2020   the first n.   
-000026c0: 2020 2020 2065 6e74 7269 6573 2064 656e       entries den
-000026d0: 6f74 6520 706f 7765 7273 206f 6620 7869  ote powers of xi
-000026e0: 2c20 7768 696c 6520 7468 6520 6c61 7374  , while the last
-000026f0: 206e 2065 6e74 7269 6573 2064 656e 6f74   n entries denot
-00002700: 6520 706f 7765 7273 206f 6620 6574 612e  e powers of eta.
-00002710: 0a20 2020 2020 2020 200a 2020 2020 6469  .        .    di
-00002720: 6374 0a20 2020 2020 2020 2054 6865 206f  ct.        The o
-00002730: 7574 7075 7420 6f66 206c 6965 6f70 732e  utput of lieops.
-00002740: 6c69 6e61 6c67 2e6e 662e 6e6f 726d 616c  linalg.nf.normal
-00002750: 5f66 6f72 6d20 726f 7574 696e 652c 2070  _form routine, p
-00002760: 726f 7669 6469 6e67 2074 6865 206c 696e  roviding the lin
-00002770: 6561 7220 6d61 7020 696e 666f 726d 6174  ear map informat
-00002780: 696f 6e20 6174 2074 6865 2072 6571 7565  ion at the reque
-00002790: 7374 6564 2070 6f69 6e74 2e0a 2020 2020  sted point..    
-000027a0: 7223 0000 0072 0100 0000 7a34 4469 6d65  r#...r....z4Dime
-000027b0: 6e73 696f 6e20 6d75 7374 2062 6520 6576  nsion must be ev
-000027c0: 656e 3b20 7472 7920 7061 7373 696e 6720  en; try passing 
-000027d0: 6e5f 6172 6773 2061 7267 756d 656e 742e  n_args argument.
-000027e0: 7a0b 4469 6d65 6e73 696f 6e20 287a 2629  z.Dimension (z&)
-000027f0: 206f 6620 6375 7374 6f6d 2070 6f69 6e74   of custom point
-00002800: 206d 6973 6d61 7463 6820 2865 7870 6563   mismatch (expec
-00002810: 7465 643a 2072 4400 0000 6300 0000 0000  ted: rD...c.....
-00002820: 0000 0000 0000 0001 0000 0005 0000 0017  ................
-00002830: 0000 0073 2000 0000 8801 8700 8702 6602  ...s .........f.
-00002840: 6401 6402 8408 7400 7401 8802 8301 8301  d.d...t.t.......
-00002850: 4400 8301 8e00 5300 2903 4e63 0100 0000  D.....S.).Nc....
-00002860: 0000 0000 0000 0000 0200 0000 0500 0000  ................
-00002870: 1300 0000 731c 0000 0067 007c 005d 0a7d  ....s....g.|.].}
-00002880: 0188 007c 0119 0088 017c 0119 0017 0091  ...|.....|......
-00002890: 0271 0253 0072 1e00 0000 721e 0000 00a9  .q.S.r....r.....
-000028a0: 0272 3b00 0000 da01 6b29 02da 0178 da01  .r;.....k)...x..
-000028b0: 7a72 1e00 0000 721f 0000 0072 4000 0000  zr....r....r@...
-000028c0: 2401 0000 f302 0000 001c 00fa 3e66 6972  $...........>fir
-000028d0: 7374 5f6f 7264 6572 5f6e 665f 6578 7061  st_order_nf_expa
-000028e0: 6e73 696f 6e2e 3c6c 6f63 616c 733e 2e3c  nsion.<locals>.<
-000028f0: 6c61 6d62 6461 3e2e 3c6c 6f63 616c 733e  lambda>.<locals>
-00002900: 2e3c 6c69 7374 636f 6d70 3ea9 0272 3900  .<listcomp>..r9.
-00002910: 0000 7247 0000 00a9 0172 6300 0000 2902  ..rG.....rc...).
-00002920: da01 4872 6400 0000 7268 0000 0072 1f00  ..Hrd...rh...r..
-00002930: 0000 da08 3c6c 616d 6264 613e 2401 0000  ....<lambda>$...
-00002940: f302 0000 0020 007a 2a66 6972 7374 5f6f  ..... .z*first_o
-00002950: 7264 6572 5f6e 665f 6578 7061 6e73 696f  rder_nf_expansio
-00002960: 6e2e 3c6c 6f63 616c 733e 2e3c 6c61 6d62  n.<locals>.<lamb
-00002970: 6461 3e29 02da 056f 7264 6572 725f 0000  da>)...orderr_..
-00002980: 0072 0500 0000 2903 da08 7379 6d6d 6574  .r....)...symmet
-00002990: 7279 da06 6e5f 726f 7773 da06 6e5f 636f  ry..n_rows..n_co
-000029a0: 6c73 7224 0000 0063 0100 0000 0000 0000  lsr$...c........
-000029b0: 0000 0000 0200 0000 0600 0000 1300 0000  ................
-000029c0: 731a 0000 0067 007c 005d 097d 0188 00a0  s....g.|.].}....
-000029d0: 007c 0166 0164 00a1 0291 0271 0253 0029  .|.f.d.....q.S.)
-000029e0: 0172 0100 0000 2901 724f 0000 0072 6100  .r....).rO...ra.
-000029f0: 0000 2901 da08 6772 6164 6965 6e74 721e  ..)...gradientr.
-00002a00: 0000 0072 1f00 0000 7240 0000 0039 0100  ...r....r@...9..
-00002a10: 0073 0200 0000 1a00 7a2c 6669 7273 745f  .s......z,first_
-00002a20: 6f72 6465 725f 6e66 5f65 7870 616e 7369  order_nf_expansi
-00002a30: 6f6e 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973  on.<locals>.<lis
-00002a40: 7463 6f6d 703e 6301 0000 0000 0000 0000  tcomp>c.........
-00002a50: 0000 0002 0000 0004 0000 0013 0000 0073  ...............s
-00002a60: 1800 0000 6700 7c00 5d08 7d01 7400 7c01  ....g.|.].}.t.|.
-00002a70: 8301 8800 6b04 9102 7102 5300 721e 0000  ....k...q.S.r...
-00002a80: 00a9 0172 3a00 0000 2902 723b 0000 00da  ...r:...).r;....
-00002a90: 0163 a901 7260 0000 0072 1e00 0000 721f  .c..r`...r....r.
-00002aa0: 0000 0072 4000 0000 3a01 0000 7302 0000  ...r@...:...s...
-00002ab0: 0018 007a 4549 6e70 7574 2061 7070 6561  ...zEInput appea
-00002ac0: 7273 2074 6f20 6861 7665 2061 206e 6f6e  rs to have a non
-00002ad0: 2d7a 6572 6f20 6772 6164 6965 6e74 2061  -zero gradient a
-00002ae0: 726f 756e 6420 7468 6520 7265 7175 6573  round the reques
-00002af0: 7465 6420 706f 696e 740a 7a15 0a66 6f72  ted point.z..for
-00002b00: 2067 6976 656e 2074 6f6c 6572 616e 6365   given tolerance
-00002b10: 207a 023a 0a29 0272 6000 0000 7222 0000   z.:.).r`...r"..
-00002b20: 0072 3400 0000 6300 0000 0000 0000 0000  .r4...c.........
-00002b30: 0000 0001 0000 0004 0000 0017 0000 0073  ...............s
-00002b40: 1c00 0000 8701 8700 6602 6401 6402 8408  ........f.d.d...
-00002b50: 7400 7401 8800 8301 8301 4400 8301 5300  t.t.......D...S.
-00002b60: 2903 4e63 0100 0000 0000 0000 0000 0000  ).Nc............
-00002b70: 0100 0000 0700 0000 1300 0000 732e 0000  ............s...
-00002b80: 0067 007c 005d 1389 0074 0087 0187 0087  .g.|.]...t......
-00002b90: 0266 0364 0064 0184 0874 0174 0288 0283  .f.d.d...t.t....
-00002ba0: 0183 0144 0083 0183 0191 0271 0253 0029  ...D.......q.S.)
-00002bb0: 0263 0100 0000 0000 0000 0000 0000 0200  .c..............
-00002bc0: 0000 0600 0000 1300 0000 7320 0000 0067  ..........s ...g
-00002bd0: 007c 005d 0c7d 0188 027c 0119 0088 0088  .|.].}...|......
-00002be0: 017c 0166 0219 0014 0091 0271 0253 0072  .|.f.......q.S.r
-00002bf0: 1e00 0000 721e 0000 0072 6100 0000 2903  ....r....ra...).
-00002c00: 7234 0000 0072 3d00 0000 da02 7a7a 721e  r4...r=.....zzr.
-00002c10: 0000 0072 1f00 0000 7240 0000 0042 0100  ...r....r@...B..
-00002c20: 0072 6b00 0000 7a49 6669 7273 745f 6f72  .rk...zIfirst_or
-00002c30: 6465 725f 6e66 5f65 7870 616e 7369 6f6e  der_nf_expansion
-00002c40: 2e3c 6c6f 6361 6c73 3e2e 3c6c 616d 6264  .<locals>.<lambd
-00002c50: 613e 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973  a>.<locals>.<lis
-00002c60: 7463 6f6d 703e 2e3c 6c69 7374 636f 6d70  tcomp>.<listcomp
-00002c70: 3e29 03da 0373 756d 7239 0000 0072 4700  >)...sumr9...rG.
-00002c80: 0000 2901 723b 0000 0029 0272 3400 0000  ..).r;...).r4...
-00002c90: 7274 0000 0029 0172 3d00 0000 721f 0000  rt...).r=...r...
-00002ca0: 0072 4000 0000 4201 0000 7241 0000 0072  .r@...B...rA...r
-00002cb0: 6600 0000 7267 0000 00a9 0172 7400 0000  f...rg.....rt...
-00002cc0: 2901 7234 0000 0072 7600 0000 721f 0000  ).r4...rv...r...
-00002cd0: 0072 6a00 0000 4201 0000 7265 0000 0063  .rj...B...re...c
-00002ce0: 0000 0000 0000 0000 0000 0000 0100 0000  ................
-00002cf0: 0300 0000 1700 0000 730c 0000 0088 0088  ........s.......
-00002d00: 017c 008e 008e 0053 0029 014e 721e 0000  .|.....S.).Nr...
-00002d10: 0072 7600 0000 2902 da06 4873 6869 6674  .rv...)...Hshift
-00002d20: da04 4b6d 6170 721e 0000 0072 1f00 0000  ..Kmapr....r....
-00002d30: 726a 0000 0043 0100 0073 0200 0000 0c00  rj...C...s......
-00002d40: da08 6d75 6c74 5f64 7276 4629 01da 0274  ..mult_drvF)...t
-00002d50: 6363 0100 0000 0000 0000 0000 0000 0300  cc..............
-00002d60: 0000 0400 0000 1300 0000 7322 0000 0069  ..........s"...i
-00002d70: 007c 005d 0d5c 027d 017d 0274 007c 0283  .|.].\.}.}.t.|..
-00002d80: 0188 006b 0472 027c 017c 0293 0271 0253  ...k.r.|.|...q.S
-00002d90: 0072 1e00 0000 7271 0000 0029 0372 3b00  .r....rq...).r;.
-00002da0: 0000 7262 0000 00da 0176 7273 0000 0072  ..rb.....vrs...r
-00002db0: 1e00 0000 721f 0000 00da 0a3c 6469 6374  ....r......<dict
-00002dc0: 636f 6d70 3e4b 0100 0073 0200 0000 2200  comp>K...s....".
-00002dd0: 7a2c 6669 7273 745f 6f72 6465 725f 6e66  z,first_order_nf
-00002de0: 5f65 7870 616e 7369 6f6e 2e3c 6c6f 6361  _expansion.<loca
-00002df0: 6c73 3e2e 3c64 6963 7463 6f6d 703e 7235  ls>.<dictcomp>r5
-00002e00: 0000 007a 0a43 4e46 2065 6e74 7279 207a  ...z.CNF entry z
-00002e10: 3120 646f 6573 206e 6f74 2061 6772 6565  1 does not agree
-00002e20: 2077 6974 6820 4861 6d69 6c74 6f6e 6961   with Hamiltonia
-00002e30: 6e20 6578 7061 6e73 696f 6e3a 2064 6966  n expansion: dif
-00002e40: 6620 7a03 203e 207a 0720 2874 6f6c 292e  f z. > z. (tol).
-00002e50: 2911 720f 0000 0072 4700 0000 7211 0000  ).r....rG...r...
-00002e60: 00da 0468 6573 7372 0800 0000 7248 0000  ...hessr....rH..
-00002e70: 0072 4900 0000 da04 6772 6164 7239 0000  .rI.....gradr9..
-00002e80: 00da 0361 6e79 7251 0000 0072 5200 0000  ...anyrQ...rR...
-00002e90: 725d 0000 00da 0569 7465 6d73 da04 6b65  r].....items..ke
-00002ea0: 7973 723a 0000 0072 4d00 0000 2915 7269  ysr:...rM...).ri
-00002eb0: 0000 0072 5e00 0000 7264 0000 0072 2200  ...r^...rd...r".
-00002ec0: 0000 725f 0000 0072 6000 0000 7227 0000  ..r_...r`...r'..
-00002ed0: 0072 1500 0000 7226 0000 00da 0764 4873  .r....r&.....dHs
-00002ee0: 6869 6674 da02 7a30 da0a 4865 7373 655f  hift..z0..Hesse_
-00002ef0: 6469 6374 da0c 4865 7373 655f 6d61 7472  dict..Hesse_matr
-00002f00: 6978 da0b 6772 6164 5f76 6563 746f 72da  ix..grad_vector.
-00002f10: 066e 6664 6963 74da 0248 4bda 0364 484b  .nfdict..HK..dHK
-00002f20: da07 7265 7375 6c74 73da 0d48 4b5f 6865  ..results..HK_he
-00002f30: 7373 655f 6469 6374 7262 0000 00da 0464  sse_dictrb.....d
-00002f40: 6966 6672 1e00 0000 2907 7269 0000 0072  iffr....).ri...r
-00002f50: 7700 0000 7234 0000 0072 7800 0000 7270  w...r4...rx...rp
-00002f60: 0000 0072 6000 0000 7264 0000 0072 1f00  ...r`...rd...r..
-00002f70: 0000 da18 6669 7273 745f 6f72 6465 725f  ....first_order_
-00002f80: 6e66 5f65 7870 616e 7369 6f6e f000 0000  nf_expansion....
-00002f90: 7348 0000 000c 2904 0108 0108 0114 010c  sH....).........
-00002fa0: 0526 0110 0104 020a 010e 080a 010a 0110  .&..............
-00002fb0: 0108 010a 0104 0308 0116 011a 011c 0116  ................
-00002fc0: 0308 010c 030e 010e 010e 0104 020c 0316  ................
-00002fd0: 010c 0124 0108 011c 0102 ff08 0372 8d00  ...$.........r..
-00002fe0: 0000 2923 7224 0000 0072 4800 0000 7251  ..)#r$...rH...rQ
-00002ff0: 0000 00da 0573 796d 7079 7202 0000 0072  .....sympyr....r
-00003000: 4a00 0000 da0c 7363 6970 792e 6c69 6e61  J.....scipy.lina
-00003010: 6c67 7203 0000 0072 0400 0000 da06 6368  lgr....r......ch
-00003020: 6563 6b73 7206 0000 0072 4900 0000 7207  ecksr....rI...r.
-00003030: 0000 0072 0800 0000 7209 0000 00da 1f6c  ...r....r......l
-00003040: 6965 6f70 732e 6c69 6e61 6c67 2e63 6f6e  ieops.linalg.con
-00003050: 6772 7565 6e63 652e 7461 6b61 6769 720a  gruence.takagir.
-00003060: 0000 0072 0b00 0000 da23 6c69 656f 7073  ...r.....#lieops
-00003070: 2e6c 696e 616c 672e 636f 6e67 7275 656e  .linalg.congruen
-00003080: 6365 2e77 696c 6c69 616d 736f 6e72 0c00  ce.williamsonr..
-00003090: 0000 720d 0000 00da 236c 6965 6f70 732e  ..r.....#lieops.
-000030a0: 6c69 6e61 6c67 2e73 696d 696c 6172 6974  linalg.similarit
-000030b0: 792e 7379 6d70 6c65 6374 6963 720e 0000  y.symplecticr...
-000030c0: 00da 076e 6a65 742e 6164 720f 0000 00da  ...njet.adr.....
-000030d0: 0e6e 6a65 742e 6675 6e63 7469 6f6e 7372  .njet.functionsr
-000030e0: 1000 0000 da04 6e6a 6574 7211 0000 0072  ......njetr....r
-000030f0: 2000 0000 da04 626f 6f6c 725d 0000 00da   .....boolr]....
-00003100: 0369 6e74 da05 666c 6f61 7472 8d00 0000  .int..floatr....
-00003110: 721e 0000 0072 1e00 0000 721e 0000 0072  r....r....r....r
-00003120: 1f00 0000 da08 3c6d 6f64 756c 653e 0100  ......<module>..
-00003130: 0000 7324 0000 0008 0308 010c 0110 010c  ..s$............
-00003140: 0214 0110 0210 010c 010c 020c 010c 0108  ................
-00003150: 0216 2300 7f0a 3a02 0120 ff              ..#...:.. .
+000000c0: 640c 6c1b 6d1c 5a1c 0100 6400 640d 6c1d  d.l.m.Z...d.d.l.
+000000d0: 6d1e 5a1e 0100 6400 640e 6c1f 6d20 5a20  m.Z...d.d.l.m Z 
+000000e0: 0100 6518 640f 6410 8400 8301 5a21 6411  ..e.d.d.....Z!d.
+000000f0: 6412 8400 5a22 6518 6522 6413 6414 8d02  d...Z"e.e"d.d...
+00000100: 5a23 6421 6417 6524 6602 6418 6419 8405  Z#d!d.e$f.d.d...
+00000110: 5a25 6413 6700 6416 6400 641a 641b 6606  Z%d.g.d.d.d.d.f.
+00000120: 641c 6526 6417 6524 641d 6526 641e 6527  d.e&d.e$d.e&d.e'
+00000130: 6608 641f 6420 8405 5a28 6401 5300 2922  f.d.d ..Z(d.S.)"
+00000140: e900 0000 004e 2901 da06 4d61 7472 6978  .....N)...Matrix
+00000150: 2902 da05 706f 6c61 72da 046c 6f67 6de9  )...polar..logm.
+00000160: 0100 0000 2901 da14 6973 5f70 6f73 6974  ....)...is_posit
+00000170: 6976 655f 6465 6669 6e69 7465 2903 da08  ive_definite)...
+00000180: 6372 6561 7465 5f4a da10 6d61 7472 6978  create_J..matrix
+00000190: 5f66 726f 6d5f 6469 6374 da0f 6372 6561  _from_dict..crea
+000001a0: 7465 5f70 7132 7869 6574 6129 02da 1173  te_pq2xieta)...s
+000001b0: 796d 706c 6563 7469 635f 7461 6b61 6769  ymplectic_takagi
+000001c0: da15 7379 6d70 6c65 6374 6963 5f74 616b  ..symplectic_tak
+000001d0: 6167 695f 6f6c 6429 02da 1275 6e69 7461  agi_old)...unita
+000001e0: 7279 5f77 696c 6c69 616d 736f 6eda 0a77  ry_williamson..w
+000001f0: 696c 6c69 616d 736f 6e29 01da 0574 686d  illiamson)...thm
+00000200: 3331 2901 da09 6e64 7375 7070 6f72 7429  31)...ndsupport)
+00000210: 01da 0465 6d61 7429 01da 0867 6574 4e61  ...emat)...getNa
+00000220: 7267 7329 01da 1067 6574 5f70 6163 6b61  rgs)...get_packa
+00000230: 6765 5f6e 616d 6529 01da 0664 6572 6976  ge_name)...deriv
+00000240: 6563 0100 0000 0000 0000 0000 0000 0200  ec..............
+00000250: 0000 0400 0000 4b00 0000 7310 0000 0074  ......K...s....t
+00000260: 007c 0066 0169 007c 01a4 018e 0153 00a9  .|.f.i.|.....S..
+00000270: 014e 2901 7204 0000 0029 02da 0158 da06  .N).r....)...X..
+00000280: 6b77 6172 6773 a900 7217 0000 00fa 2a2f  kwargs..r.....*/
+00000290: 686f 6d65 2f6d 616c 7465 2f67 6974 2f6c  home/malte/git/l
+000002a0: 6965 6f70 732f 6c69 656f 7073 2f6c 696e  ieops/lieops/lin
+000002b0: 616c 672f 6e66 2e70 79da 076c 6f67 6d5f  alg/nf.py..logm_
+000002c0: 6e64 1600 0000 7302 0000 0010 0272 1900  nd....s......r..
+000002d0: 0000 6301 0000 0000 0000 0000 0000 000a  ..c.............
+000002e0: 0000 0004 0000 004b 0000 0073 5800 0000  .......K...sX...
+000002f0: 7400 7c00 8301 5c02 7d02 7d03 7401 7c03  t.|...\.}.}.t.|.
+00000300: 8301 7d04 7402 7c02 6601 6900 7c01 a401  ..}.t.|.f.i.|...
+00000310: 8e01 7d05 7c05 a003 a100 a004 a100 7d06  ..}.|.........}.
+00000320: 7c05 7c02 1000 7c06 1000 7d07 7401 7c07  |.|...|...}.t.|.
+00000330: 8301 7d08 7c06 7c08 1000 7c05 1000 7d09  ..}.|.|...|...}.
+00000340: 7c09 7c04 6602 5300 2901 61d2 0200 000a  |.|.f.S.).a.....
+00000350: 2020 2020 4c65 7420 5820 6265 2061 2063      Let X be a c
+00000360: 6f6d 706c 6578 2073 796d 706c 6563 7469  omplex symplecti
+00000370: 6320 6d61 7472 6978 2c20 692e 652e 2061  c matrix, i.e. a
+00000380: 206d 6174 7269 7820 7361 7469 7366 7969   matrix satisfyi
+00000390: 6e67 0a20 2020 2058 2e74 7261 6e73 706f  ng.    X.transpo
+000003a0: 7365 2829 404a 4058 203d 204a 2e0a 2020  se()@J@X = J..  
+000003b0: 2020 0a20 2020 2054 6865 6e20 7468 6973    .    Then this
+000003c0: 2072 6f75 7469 6e65 2077 696c 6c20 6465   routine will de
+000003d0: 7465 726d 696e 6520 7477 6f20 6d61 7472  termine two matr
+000003e0: 6963 6573 2041 2061 6e64 2042 2073 6f20  ices A and B so 
+000003f0: 7468 6174 0a20 2020 2058 203d 2065 7870  that.    X = exp
+00000400: 2841 2940 6578 7028 4229 2c0a 2020 2020  (A)@exp(B),.    
+00000410: 7768 6572 6520 4120 6973 2061 6e20 656c  where A is an el
+00000420: 656d 656e 7420 696e 2073 7028 6e29 2c20  ement in sp(n), 
+00000430: 7468 6520 4c69 652d 616c 6765 6272 6120  the Lie-algebra 
+00000440: 6f66 2053 7028 6e29 203d 2053 7028 326e  of Sp(n) = Sp(2n
+00000450: 3b20 4329 205c 6361 7020 5528 326e 292c  ; C) \cap U(2n),
+00000460: 0a20 2020 2061 6e64 2042 2069 7320 616e  .    and B is an
+00000470: 2065 6c65 6d65 6e74 206f 6620 7370 2832   element of sp(2
+00000480: 6e3b 2043 292c 2074 6865 204c 6965 2d61  n; C), the Lie-a
+00000490: 6c67 6562 7261 206f 6620 5370 2832 6e3b  lgebra of Sp(2n;
+000004a0: 2043 292e 0a20 2020 200a 2020 2020 5061   C)..    .    Pa
+000004b0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+000004c0: 2d2d 2d2d 2d2d 2d0a 2020 2020 583a 206e  -------.    X: n
+000004d0: 6461 7272 6179 0a20 2020 2020 2020 2041  darray.        A
+000004e0: 6e20 6172 7261 7920 7265 7072 6573 656e  n array represen
+000004f0: 7469 6e67 2074 6865 206d 6174 7269 7820  ting the matrix 
+00000500: 582e 0a20 2020 2020 2020 200a 2020 2020  X..        .    
+00000510: 2a2a 6b77 6172 6773 0a20 2020 2020 2020  **kwargs.       
+00000520: 204f 7074 696f 6e61 6c20 6b65 7977 6f72   Optional keywor
+00000530: 6465 6420 6172 6775 6d65 6e74 7320 7061  ded arguments pa
+00000540: 7373 6564 2074 6f20 276c 6965 6f70 732e  ssed to 'lieops.
+00000550: 6c69 6e61 6c67 2e73 696d 696c 6172 6974  linalg.similarit
+00000560: 792e 7379 6d70 6c65 6374 6963 2e74 686d  y.symplectic.thm
+00000570: 3331 2720 726f 7574 696e 652e 0a20 2020  31' routine..   
+00000580: 2020 2020 200a 2020 2020 5265 7475 726e       .    Return
+00000590: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
+000005a0: 2020 413a 206e 6461 7272 6179 0a20 2020    A: ndarray.   
+000005b0: 2020 2020 2041 6e20 6172 7261 7920 7265       An array re
+000005c0: 7072 6573 656e 7469 6e67 2074 6865 206d  presenting the m
+000005d0: 6174 7269 7820 412e 0a20 2020 2020 2020  atrix A..       
+000005e0: 200a 2020 2020 423a 206e 6461 7272 6179   .    B: ndarray
+000005f0: 0a20 2020 2020 2020 2041 6e20 6172 7261  .        An arra
+00000600: 7920 7265 7072 6573 656e 7469 6e67 2074  y representing t
+00000610: 6865 206d 6174 7269 7820 422e 0a20 2020  he matrix B..   
+00000620: 2029 0572 0300 0000 7204 0000 0072 0e00   ).r....r....r..
+00000630: 0000 da09 7472 616e 7370 6f73 65da 0463  ....transpose..c
+00000640: 6f6e 6a29 0a72 1500 0000 7216 0000 00da  onj).r....r.....
+00000650: 0155 da01 505a 046c 6f67 50da 0156 da02  .U..PZ.logP..V..
+00000660: 5669 da01 445a 046c 6f67 44da 0159 7217  Vi..DZ.logD..Yr.
+00000670: 0000 0072 1700 0000 7218 0000 00da 085f  ...r....r......_
+00000680: 7379 6d6c 6f67 731a 0000 0073 1000 0000  symlogs....s....
+00000690: 0c1a 0801 1001 0c01 0c01 0801 0c01 0801  ................
+000006a0: 7222 0000 00e9 0200 0000 2901 5a0a 6e5f  r"........).Z.n_
+000006b0: 6f75 745f 6172 6773 da07 6465 6661 756c  out_args..defaul
+000006c0: 7446 da05 6368 6563 6b63 0400 0000 0000  tF..checkc......
+000006d0: 0000 0000 0000 1900 0000 0900 0000 0b00  ................
+000006e0: 0000 7386 0400 0074 007c 0083 0189 0088  ..s....t.|......
+000006f0: 0064 0116 0064 026b 0273 0e4a 0064 0383  .d...d.k.s.J.d..
+00000700: 0182 0174 017c 0083 017d 0574 027c 0083  ...t.|...}.t.|..
+00000710: 017d 007c 0164 0475 0172 2874 027c 0183  .}.|.d.u.r(t.|..
+00000720: 017d 017c 01a0 03a1 007d 067c 017c 0010  .}.|.....}.|.|..
+00000730: 007c 0610 007d 0074 0488 0064 011a 0083  .|...}.t...d....
+00000740: 017d 077c 0564 056b 0272 3774 05a0 067c  .}.|.d.k.r7t...|
+00000750: 07a1 017d 0774 027c 0783 017d 077c 0372  ...}.t.|...}.|.r
+00000760: 5d74 077c 076a 0683 017d 0874 077c 006a  ]t.|.j...}.t.|.j
+00000770: 0683 017d 097c 097c 0810 00a0 08a1 005c  ...}.|.|.......\
+00000780: 027d 0a7d 0b7c 0ba0 09a1 0073 5d74 0a64  .}.}.|.....s]t.d
+00000790: 067c 009b 0064 077c 0b9b 009d 0483 0182  .|...d.|........
+000007a0: 017c 0264 086b 0272 9974 0b7c 006a 0666  .|.d.k.r.t.|.j.f
+000007b0: 0169 007c 04a4 018e 015c 027d 0c7d 0d74  .i.|.....\.}.}.t
+000007c0: 027c 0c83 0174 027c 0d83 0102 027d 0c7d  .|...t.|.....}.}
+000007d0: 0d7c 0ca0 03a1 007d 0c7c 070b 007c 0ca0  .|.....}.|...|..
+000007e0: 03a1 0010 007c 0710 007d 0e7c 0ea0 03a1  .....|...}.|....
+000007f0: 007c 0010 007c 0e10 007d 0f74 0c64 2a88  .|...|...}.t.d*.
+00000800: 007c 0564 099c 027c 04a4 018e 017d 1074  .|.d...|.....}.t
+00000810: 027c 1083 017d 106e a37c 0264 0a6b 0272  .|...}.n.|.d.k.r
+00000820: d074 0d7c 006a 0666 0164 0b7c 0369 017c  .t.|.j.f.d.|.i.|
+00000830: 04a4 018e 015c 037d 0c7d 0f7d 1174 027c  .....\.}.}.}.t.|
+00000840: 0c83 0174 027c 0f83 0102 027d 0c7d 0f7c  ...t.|.....}.}.|
+00000850: 0ca0 03a1 007d 0c7c 070b 007c 0ca0 03a1  .....}.|...|....
+00000860: 0010 007c 0710 007d 0e74 0c64 2a88 007c  ...|...}.t.d*..|
+00000870: 0564 099c 027c 04a4 018e 017d 1074 027c  .d...|.....}.t.|
+00000880: 1083 017d 106e 6c7c 0264 0c6b 0290 0172  ...}.nl|.d.k...r
+00000890: 3474 0e7c 006a 0683 0190 0172 0874 0f64  4t.|.j.....r.t.d
+000008a0: 2a64 0d7c 006a 0669 017c 04a4 018e 015c  *d.|.j.i.|.....\
+000008b0: 027d 0c7d 0f74 027c 0c83 0174 027c 0f83  .}.}.t.|...t.|..
+000008c0: 0102 027d 0c7d 0f74 0c64 2a88 007c 0564  ...}.}.t.d*..|.d
+000008d0: 099c 027c 04a4 018e 017d 1074 027c 1083  ...|.....}.t.|..
+000008e0: 017d 107c 070b 007c 0ca0 03a1 0010 007c  .}.|...|.......|
+000008f0: 0710 007d 0e6e 347c 0564 0e6b 0290 0173  ...}.n4|.d.k...s
+00000900: 0f4a 0082 0174 1064 2a64 0f7c 006a 0669  .J...t.d*d.|.j.i
+00000910: 017c 04a4 018e 015c 037d 0e7d 0f7d 1074  .|.....\.}.}.}.t
+00000920: 027c 0e83 0174 027c 0f83 0174 027c 1083  .|...t.|...t.|..
+00000930: 0103 0302 037d 0e7d 0f7d 107c 070b 007c  .....}.}.}.|...|
+00000940: 0ea0 03a1 0010 007c 0710 007d 0c6e 0874  .......|...}.n.t
+00000950: 0a64 107c 029b 0064 119d 0383 0182 017c  .d.|...d.......|
+00000960: 10a0 03a1 00a0 11a1 007d 127c 107c 0710  .........}.|.|..
+00000970: 007c 10a0 03a1 0010 007d 137c 107c 0c10  .|.......}.|.|..
+00000980: 007d 147c 0e7c 1210 007d 157c 0164 0475  .}.|.|...}.|.d.u
+00000990: 0190 0172 777c 067c 0c10 007c 0110 007d  ...rw|.|...|...}
+000009a0: 0c7c 067c 0e10 007c 0110 007d 0e7c 067c  .|.|...|...}.|.|
+000009b0: 0710 007c 0110 007d 077c 067c 0010 007c  ...|...}.|.|...|
+000009c0: 0110 007d 007c 147c 0110 007d 147c 067c  ...}.|.|...}.|.|
+000009d0: 1510 007d 1569 007d 167c 0c6a 067c 1664  ...}.i.}.|.j.|.d
+000009e0: 123c 007c 0e6a 067c 1664 133c 007c 006a  .<.|.j.|.d.<.|.j
+000009f0: 067c 1664 143c 007c 0ea0 03a1 007c 0010  .|.d.<.|.....|..
+00000a00: 007c 0e10 006a 067c 1664 153c 007c 0164  .|...j.|.d.<.|.d
+00000a10: 0475 0190 0172 9e7c 016a 067c 1664 163c  .u...r.|.j.|.d.<
+00000a20: 006e 0467 007c 1664 163c 007c 076a 067c  .n.g.|.d.<.|.j.|
+00000a30: 1664 173c 007c 136a 067c 1664 183c 007c  .d.<.|.j.|.d.<.|
+00000a40: 106a 067c 1664 193c 007c 126a 067c 1664  .j.|.d.<.|.j.|.d
+00000a50: 1a3c 007c 146a 067c 1664 1b3c 007c 156a  .<.|.j.|.d.<.|.j
+00000a60: 067c 1664 1c3c 007c 15a0 03a1 007c 0010  .|.d.<.|.....|..
+00000a70: 007c 1510 006a 067c 1664 1d3c 007c 0f6a  .|...j.|.d.<.|.j
+00000a80: 067c 1664 1e3c 007c 0564 056b 0390 0272  .|.d.<.|.d.k...r
+00000a90: 417c 107c 0e10 007c 1210 006a 067c 1664  A|.|...|...j.|.d
+00000aa0: 1f3c 007c 04a0 1264 2064 21a1 0289 017a  .<.|...d d!....z
+00000ab0: 2774 137c 0e6a 0683 017d 1774 027c 1783  't.|.j...}.t.|..
+00000ac0: 017d 177c 077c 17a0 03a1 0010 007c 177c  .}.|.|.......|.|
+00000ad0: 0710 0017 0089 0274 1487 0087 0187 0266  .......t.......f
+00000ae0: 0364 2264 2384 0874 1588 0083 0144 0083  .d"d#..t.....D..
+00000af0: 0183 0190 0273 0a4a 0082 0157 006e 2c01  .....s.J...W.n,.
+00000b00: 0001 0001 0074 167c 0e6a 067c 04a0 1264  .....t.|.j.|...d
+00000b10: 2464 02a1 0264 258d 025c 027d 177d 1874  $d...d%..\.}.}.t
+00000b20: 17a0 1864 2688 019b 0064 279d 03a1 0101  ...d&....d'.....
+00000b30: 0074 027c 1783 0174 027c 1883 0102 027d  .t.|...t.|.....}
+00000b40: 177d 187c 107c 1810 007c 1210 006a 067c  .}.|.|...|...j.|
+00000b50: 1664 283c 0059 007c 107c 1710 007c 1210  .d(<.Y.|.|...|..
+00000b60: 006a 067c 1664 293c 007c 1653 0029 2b61  .j.|.d)<.|.S.)+a
+00000b70: 2a11 0000 0a20 2020 2050 6572 666f 726d  *....    Perform
+00000b80: 206c 696e 6561 7220 6361 6c63 756c 6174   linear calculat
+00000b90: 696f 6e73 2074 6f20 7472 616e 7366 6f72  ions to transfor
+00000ba0: 6d20 6120 6769 7665 6e20 7365 636f 6e64  m a given second
+00000bb0: 2d6f 7264 6572 2048 616d 696c 746f 6e69  -order Hamiltoni
+00000bc0: 616e 2c0a 2020 2020 6578 7072 6573 7365  an,.    expresse
+00000bd0: 6420 696e 2063 616e 6f6e 6963 616c 2063  d in canonical c
+00000be0: 6f6f 7264 696e 6174 6573 2028 712c 2070  oordinates (q, p
+00000bf0: 292c 2074 6f0a 2020 2020 636f 6d70 6c65  ), to.    comple
+00000c00: 7820 6e6f 726d 616c 2066 6f72 6d20 636f  x normal form co
+00000c10: 6f72 6469 6e61 7465 7320 7869 2c20 6574  ordinates xi, et
+00000c20: 612e 2041 6c6f 6e67 2074 6865 2077 6179  a. Along the way
+00000c30: 2c20 7468 6520 7379 6d70 6c65 6374 6963  , the symplectic
+00000c40: 206c 696e 6561 7220 6d61 7020 746f 0a20   linear map to. 
+00000c50: 2020 2072 6561 6c20 6e6f 726d 616c 2066     real normal f
+00000c60: 6f72 6d20 6973 2063 6f6d 7075 7465 642e  orm is computed.
+00000c70: 2054 6865 2071 7561 6e74 6974 6965 7320   The quantities 
+00000c80: 7869 2061 6e64 2065 7461 2061 7265 2064  xi and eta are d
+00000c90: 6566 696e 6564 2061 7320 696e 206d 7920  efined as in my 
+00000ca0: 7468 6573 6973 2c0a 2020 2020 4368 6170  thesis,.    Chap
+00000cb0: 7465 7220 312e 0a20 2020 200a 2020 2020  ter 1..    .    
+00000cc0: 5061 7261 6d74 6572 730a 2020 2020 2d2d  Paramters.    --
+00000cd0: 2d2d 2d2d 2d2d 2d0a 2020 2020 4832 3a0a  -------.    H2:.
+00000ce0: 2020 2020 2020 2020 5379 6d6d 6574 7269          Symmetri
+00000cf0: 6320 6d61 7472 6978 2073 6f20 7468 6174  c matrix so that
+00000d00: 2048 3240 4a20 6973 2064 6961 676f 6e61   H2@J is diagona
+00000d10: 6c69 7a61 626c 652e 0a20 2020 2020 2020  lizable..       
+00000d20: 2041 7474 656e 7469 6f6e 3a20 4120 6368   Attention: A ch
+00000d30: 6563 6b20 6966 2048 3240 4a20 6973 2064  eck if H2@J is d
+00000d40: 6961 676f 6e61 6c69 7a61 626c 6520 6973  iagonalizable is
+00000d50: 206e 6f74 2064 6f6e 6520 6578 706c 6963   not done explic
+00000d60: 6974 6c79 2e0a 2020 2020 2020 2020 0a20  itly..        . 
+00000d70: 2020 2054 3a20 6d61 7472 6978 2c20 6f70     T: matrix, op
+00000d80: 7469 6f6e 616c 0a20 2020 2020 2020 2050  tional.        P
+00000d90: 6572 6d75 7461 7469 6f6e 206d 6174 7269  ermutation matri
+00000da0: 7820 746f 2063 6861 6e67 6520 7468 6520  x to change the 
+00000db0: 6f72 6465 7269 6e67 206f 6620 6361 6e6f  ordering of cano
+00000dc0: 6e63 6961 6c0a 2020 2020 2020 2020 636f  ncial.        co
+00000dd0: 6f72 6469 6e61 7465 7320 616e 6420 6d6f  ordinates and mo
+00000de0: 6d65 6e74 612c 2067 6976 656e 2068 6572  menta, given her
+00000df0: 6520 6279 2064 6566 6175 6c74 2061 7320  e by default as 
+00000e00: 2871 312c 202e 2e2e 2c20 716e 2c20 7031  (q1, ..., qn, p1
+00000e10: 2c20 2e2e 2e2c 2070 6e29 2c20 0a20 2020  , ..., pn), .   
+00000e20: 2020 2020 2069 6e74 6f20 6120 6469 6666       into a diff
+00000e30: 6572 656e 7420 6f72 6465 722e 2049 2e65  erent order. I.e
+00000e40: 2e20 5420 7472 616e 7366 6f72 6d73 2074  . T transforms t
+00000e50: 6865 200a 2020 2020 2020 2020 286e 2078  he .        (n x
+00000e60: 206e 2920 626c 6f63 6b20 6d61 7472 6978   n) block matrix
+00000e70: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00000e80: 2020 2020 2020 202f 2020 3020 2020 3120         /  0   1 
+00000e90: 205c 0a20 2020 2020 2020 204a 203d 2020   \.        J =  
+00000ea0: 7c20 2020 2020 2020 2020 7c0a 2020 2020  |         |.    
+00000eb0: 2020 2020 2020 2020 205c 202d 3120 2020           \ -1   
+00000ec0: 3020 202f 0a20 2020 2020 2020 2020 2020  0  /.           
+00000ed0: 2020 0a20 2020 2020 2020 2069 6e74 6f20    .        into 
+00000ee0: 6120 6d61 7472 6978 204a 2720 6279 206d  a matrix J' by m
+00000ef0: 6174 7269 7820 636f 6e67 7275 656e 6365  atrix congruence
+00000f00: 3a20 4a27 203d 2054 2e74 7261 6e73 706f  : J' = T.transpo
+00000f10: 7365 2829 404a 4054 2e0a 2020 2020 2020  se()@J@T..      
+00000f20: 2020 0a20 2020 206d 6f64 653a 2073 7472    .    mode: str
+00000f30: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00000f40: 2020 204d 6574 686f 6420 6f66 2068 6f77     Method of how
+00000f50: 2074 6f20 636f 6d70 7574 6520 7468 6520   to compute the 
+00000f60: 7379 6d70 6c65 6374 6963 206d 6174 7269  symplectic matri
+00000f70: 6365 7320 7768 6963 6820 636f 6e6a 7567  ces which conjug
+00000f80: 6174 652d 6469 6167 6f6e 616c 697a 6520  ate-diagonalize 
+00000f90: 4832 2e0a 2020 2020 2020 2020 5375 7070  H2..        Supp
+00000fa0: 6f72 7465 6420 6d6f 6465 7320 6172 6520  orted modes are 
+00000fb0: 2864 6566 6175 6c74 3a20 2764 6566 6175  (default: 'defau
+00000fc0: 6c74 2729 3a0a 2020 2020 2020 2020 3129  lt'):.        1)
+00000fd0: 2027 6465 6661 756c 7427 202d 2d20 5573   'default' -- Us
+00000fe0: 6520 7379 6d70 6c65 6374 6963 2054 616b  e symplectic Tak
+00000ff0: 6167 6920 6661 6374 6f72 697a 6174 696f  agi factorizatio
+00001000: 6e0a 2020 2020 2020 2020 3229 2027 636c  n.        2) 'cl
+00001010: 6173 7369 6327 202d 2d20 5573 6520 2875  assic' -- Use (u
+00001020: 6e69 7461 7279 2920 5769 6c6c 6961 6d73  nitary) Williams
+00001030: 6f6e 2064 6961 676f 6e61 6c69 7a61 7469  on diagonalizati
+00001040: 6f6e 2028 776f 726b 7320 6f6e 6c79 2069  on (works only i
+00001050: 6620 4832 2069 7320 696e 7665 7274 6962  f H2 is invertib
+00001060: 6c65 2e29 0a20 2020 2020 2020 200a 2020  le.).        .  
+00001070: 2020 6368 6563 6b3a 2062 6f6f 6c65 616e    check: boolean
+00001080: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00001090: 2020 2050 6572 666f 726d 2061 2063 6f6e     Perform a con
+000010a0: 7369 7374 656e 6379 2063 6865 636b 2077  sistency check w
+000010b0: 6865 7468 6572 2048 3240 4a20 6973 2064  hether H2@J is d
+000010c0: 6961 676f 6e61 6c69 7a61 626c 652c 2075  iagonalizable, u
+000010d0: 7369 6e67 2073 796d 7079 2e0a 2020 2020  sing sympy..    
+000010e0: 2020 2020 0a20 2020 2074 6f6c 5f6c 6f67      .    tol_log
+000010f0: 6d3a 2066 6c6f 6174 2c20 6f70 7469 6f6e  m: float, option
+00001100: 616c 0a20 2020 2020 2020 2041 2074 6f6c  al.        A tol
+00001110: 6572 616e 6365 2074 6f20 6465 7465 726d  erance to determ
+00001120: 696e 6520 7768 6574 6865 7220 6f6e 6520  ine whether one 
+00001130: 6f72 2074 776f 2065 7870 6f6e 656e 7469  or two exponenti
+00001140: 616c 7320 6172 6520 7265 7175 6972 6564  als are required
+00001150: 2066 6f72 2074 6865 206d 6170 2074 6f20   for the map to 
+00001160: 6e6f 726d 616c 2066 6f72 6d2e 0a20 2020  normal form..   
+00001170: 2020 2020 2041 7474 656e 7469 6f6e 3a20       Attention: 
+00001180: 4120 7661 6c75 6520 6f66 207a 6572 6f20  A value of zero 
+00001190: 7769 6c6c 2072 6573 756c 7420 696e 2074  will result in t
+000011a0: 776f 2065 7870 6f6e 656e 7469 616c 732c  wo exponentials,
+000011b0: 2077 6869 6368 206d 6967 6874 206e 6f74   which might not
+000011c0: 2061 6c77 6179 7320 6265 2064 6573 6972   always be desir
+000011d0: 6564 2e0a 2020 2020 2020 2020 466f 7220  ed..        For 
+000011e0: 7468 6973 2072 6561 736f 6e20 7468 6520  this reason the 
+000011f0: 746f 6c65 7261 6e63 6520 6973 2073 6574  tolerance is set
+00001200: 2074 6f20 6120 736d 616c 6c20 7661 6c75   to a small valu
+00001210: 6520 6279 2064 6566 6175 6c74 2061 6e64  e by default and
+00001220: 2061 2077 6172 6e69 6e67 2077 696c 6c20   a warning will 
+00001230: 6265 2069 7373 7565 6420 6966 0a20 2020  be issued if.   
+00001240: 2020 2020 2074 776f 2065 7870 6f6e 656e       two exponen
+00001250: 7473 2068 6176 6520 6265 656e 2066 6f75  ts have been fou
+00001260: 6e64 2069 6e73 7465 6164 206f 6620 6f6e  nd instead of on
+00001270: 652e 0a20 2020 2020 2020 2020 2020 2020  e..             
+00001280: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
+00001290: 202d 2d2d 2d2d 2d2d 0a20 2020 2064 6963   -------.    dic
+000012a0: 740a 2020 2020 2020 2020 4469 6374 696f  t.        Dictio
+000012b0: 6e61 7279 2063 6f6e 7461 696e 696e 6720  nary containing 
+000012c0: 7661 7269 6f75 7320 6c69 6e65 6172 206d  various linear m
+000012d0: 6170 732e 2054 6865 2069 7465 6d73 206f  aps. The items o
+000012e0: 6620 7468 6973 2064 6963 7469 6f6e 6172  f this dictionar
+000012f0: 7920 6172 6520 6465 7363 7269 6265 6420  y are described 
+00001300: 696e 2074 6865 2066 6f6c 6c6f 7769 6e67  in the following
+00001310: 2e0a 2020 2020 2020 2020 0a20 2020 2020  ..        .     
+00001320: 2020 2053 2020 2020 2020 3a20 5468 6520     S      : The 
+00001330: 7379 6d70 6c65 6374 6963 206d 6170 2064  symplectic map d
+00001340: 6961 676f 6e61 6c69 7a69 6e67 2048 3220  iagonalizing H2 
+00001350: 7669 6120 532e 7472 616e 7370 6f73 6528  via S.transpose(
+00001360: 2940 4440 5320 3d20 4832 2c20 7768 6572  )@D@S = H2, wher
+00001370: 6520 4420 6973 2061 2064 6961 676f 6e61  e D is a diagona
+00001380: 6c20 6d61 7472 6978 2e0a 2020 2020 2020  l matrix..      
+00001390: 2020 5369 6e76 2020 203a 2054 6865 2069    Sinv   : The i
+000013a0: 6e76 6572 7365 206f 6620 532c 2069 2e65  nverse of S, i.e
+000013b0: 2e20 7468 6520 7379 6d70 6c65 6374 6963  . the symplectic
+000013c0: 206d 6170 2074 6f20 2872 6561 6c29 206e   map to (real) n
+000013d0: 6f72 6d61 6c20 666f 726d 2e20 2020 2020  ormal form.     
+000013e0: 2020 200a 2020 2020 2020 2020 4832 2020     .        H2  
+000013f0: 2020 203a 2054 6865 2069 6e70 7574 2069     : The input i
+00001400: 6e20 6d61 7472 6978 2066 6f72 6d2e 0a20  n matrix form.. 
+00001410: 2020 2020 2020 2054 2020 2020 2020 3a20         T      : 
+00001420: 5468 6520 286f 7074 696f 6e61 6c29 206d  The (optional) m
+00001430: 6174 7269 7820 5420 6465 7363 7269 6265  atrix T describe
+00001440: 6420 6162 6f76 652e 0a20 2020 2020 2020  d above..       
+00001450: 204a 2020 2020 2020 3a20 5468 6520 286f   J      : The (o
+00001460: 7269 6769 6e61 6c29 2073 796d 706c 6563  riginal) symplec
+00001470: 7469 6320 7374 7275 6374 7572 6520 4a27  tic structure J'
+00001480: 203d 2054 2e74 7261 6e73 706f 7365 2829   = T.transpose()
+00001490: 404a 4054 2077 6974 6869 6e20 7768 6963  @J@T within whic
+000014a0: 6820 7468 6520 696e 7075 7420 4861 6d69  h the input Hami
+000014b0: 6c74 6f6e 6961 6e20 7761 7320 666f 726d  ltonian was form
+000014c0: 756c 6174 6564 2e0a 2020 2020 2020 2020  ulated..        
+000014d0: 2020 2020 2020 2020 2048 6572 6562 7920           Hereby 
+000014e0: 4a20 6973 2074 6865 2062 6c6f 636b 2d6d  J is the block-m
+000014f0: 6174 7269 7820 6672 6f6d 2061 626f 7665  atrix from above
+00001500: 2e0a 2020 2020 2020 2020 4a32 2020 2020  ..        J2    
+00001510: 203a 2054 6865 206e 6577 2073 796d 706c   : The new sympl
+00001520: 6563 7469 6320 7374 7275 6374 7572 6520  ectic structure 
+00001530: 666f 7220 7468 6520 2878 692c 2065 7461  for the (xi, eta
+00001540: 292d 636f 6f72 6469 6e61 7465 732e 0a20  )-coordinates.. 
+00001550: 2020 2020 2020 2055 2020 2020 2020 3a20         U      : 
+00001560: 5468 6520 756e 6974 6172 7920 6d61 7020  The unitary map 
+00001570: 6672 6f6d 2074 6865 2053 2871 2c20 7029  from the S(q, p)
+00001580: 203d 2028 752c 2076 292d 626c 6f63 6b20   = (u, v)-block 
+00001590: 636f 6f72 6469 6e61 7465 7320 746f 2074  coordinates to t
+000015a0: 6865 2028 7869 2c20 6574 6129 2d63 6f6f  he (xi, eta)-coo
+000015b0: 7264 696e 6174 6573 2e0a 2020 2020 2020  rdinates..      
+000015c0: 2020 5569 6e76 2020 203a 2054 6865 2069    Uinv   : The i
+000015d0: 6e76 6572 7365 206f 6620 552e 0a20 2020  nverse of U..   
+000015e0: 2020 2020 204b 2020 2020 2020 3a20 5468       K      : Th
+000015f0: 6520 6c69 6e65 6172 206d 6170 2074 7261  e linear map tra
+00001600: 6e73 666f 726d 696e 6720 2871 2c20 7029  nsforming (q, p)
+00001610: 2074 6f20 2878 692c 2065 7461 292d 636f   to (xi, eta)-co
+00001620: 6f72 6469 6e61 7465 732e 204b 2069 7320  ordinates. K is 
+00001630: 6769 7665 6e20 6279 2055 4053 4054 2e0a  given by U@S@T..
+00001640: 2020 2020 2020 2020 4b69 6e76 2020 203a          Kinv   :
+00001650: 2054 6865 2069 6e76 6572 7365 206f 6620   The inverse of 
+00001660: 4b2e 2048 656e 6365 2c20 6974 2077 696c  K. Hence, it wil
+00001670: 6c20 7472 616e 7366 6f72 6d20 4832 2074  l transform H2 t
+00001680: 6f20 636f 6d70 6c65 7820 6e6f 726d 616c  o complex normal
+00001690: 2066 6f72 6d20 7669 6120 4b69 6e76 2e74   form via Kinv.t
+000016a0: 7261 6e73 706f 7365 2829 4048 3240 4b69  ranspose()@H2@Ki
+000016b0: 6e76 2e0a 2020 2020 2020 2020 726e 6620  nv..        rnf 
+000016c0: 2020 203a 2054 6865 2027 7265 616c 2720     : The 'real' 
+000016d0: 6e6f 726d 616c 2066 6f72 6d2c 2062 7920  normal form, by 
+000016e0: 7768 6963 6820 7765 2075 6e64 6572 7374  which we underst
+000016f0: 616e 6420 7468 6520 6469 6167 6f6e 616c  and the diagonal
+00001700: 697a 6174 696f 6e20 6f66 2048 3220 7265  ization of H2 re
+00001710: 6c61 7469 7665 2074 6f20 7468 6520 0a20  lative to the . 
+00001720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001730: 7379 6d70 6c65 6374 6963 206d 6174 7269  symplectic matri
+00001740: 7820 532e 204e 6f74 6520 7468 6174 2053  x S. Note that S
+00001750: 206d 6967 6874 2062 6520 636f 6d70 6c65   might be comple
+00001760: 7820 6966 2074 6865 2048 6573 7365 206d  x if the Hesse m
+00001770: 6174 7269 7820 6f66 2048 3220 6973 206e  atrix of H2 is n
+00001780: 6f74 2070 6f73 6974 6976 6520 6465 6669  ot positive defi
+00001790: 6e69 7465 2e0a 2020 2020 2020 2020 636e  nite..        cn
+000017a0: 6620 2020 203a 2054 6865 2027 636f 6d70  f    : The 'comp
+000017b0: 6c65 7827 206e 6f72 6d61 6c20 666f 726d  lex' normal form
+000017c0: 2c20 7768 6963 6820 6973 2067 6976 656e  , which is given
+000017d0: 2061 7320 7468 6520 7265 7072 6573 656e   as the represen
+000017e0: 7461 7469 6f6e 206f 6620 4832 2069 6e20  tation of H2 in 
+000017f0: 7465 726d 7320 6f66 2074 6865 2063 6f6d  terms of the com
+00001800: 706c 6578 0a20 2020 2020 2020 2020 2020  plex.           
+00001810: 2020 2020 2020 6e6f 726d 616c 697a 696e        normalizin
+00001820: 6720 2878 692c 2065 7461 292d 636f 6f72  g (xi, eta)-coor
+00001830: 6469 6e61 7465 7320 2874 6865 2027 6e65  dinates (the 'ne
+00001840: 7727 2063 6f6d 706c 6578 2073 796d 706c  w' complex sympl
+00001850: 6563 7469 6320 7374 7275 6374 7572 6529  ectic structure)
+00001860: 2e0a 2020 2020 2020 2020 4120 2020 2020  ..        A     
+00001870: 203a 2041 2063 6f6d 706c 6578 206d 6174   : A complex mat
+00001880: 7269 7820 7472 616e 7366 6f72 6d69 6e67  rix transforming
+00001890: 2074 6865 2075 6e64 6572 6c79 696e 6720   the underlying 
+000018a0: 4861 6d69 6c74 6f6e 6961 6e20 4820 2877  Hamiltonian H (w
+000018b0: 686f 7365 2048 6573 7365 2d6d 6174 7269  hose Hesse-matri
+000018c0: 7820 636f 7272 6573 706f 6e64 7320 746f  x corresponds to
+000018d0: 2048 3229 2c0a 2020 2020 2020 2020 2020   H2),.          
+000018e0: 2020 2020 2020 2067 6976 656e 2069 6e20         given in 
+000018f0: 7465 726d 7320 6f66 2063 6f6d 706c 6578  terms of complex
+00001900: 2028 7869 2c20 6574 6129 2d63 6f6f 7264   (xi, eta)-coord
+00001910: 696e 6174 6573 2c20 696e 746f 206e 6f72  inates, into nor
+00001920: 6d61 6c20 666f 726d 204e 2076 6961 204e  mal form N via N
+00001930: 203d 2048 206f 2041 2e0a 2020 2020 2020   = H o A..      
+00001940: 2020 2020 2020 2020 2020 2049 7420 686f             It ho
+00001950: 6c64 7320 4120 3d20 5540 5369 6e76 4055  lds A = U@Sinv@U
+00001960: 696e 762e 202a 4375 7272 656e 746c 7920  inv. *Currently 
+00001970: 6f6e 6c79 2072 6574 7572 6e65 6420 666f  only returned fo
+00001980: 7220 6e75 6d70 7920 696e 7075 742a 0a20  r numpy input*. 
+00001990: 2020 2020 2020 2053 312c 2053 3220 3a20         S1, S2 : 
+000019a0: 456c 656d 656e 7473 206f 6620 7370 2832  Elements of sp(2
+000019b0: 6e3b 2043 2920 2874 6865 204c 6965 2d61  n; C) (the Lie-a
+000019c0: 6c67 6562 7261 206f 6620 636f 6d70 6c65  lgebra of comple
+000019d0: 7820 7379 6d70 6c65 6374 6963 206d 6174  x symplectic mat
+000019e0: 7269 6365 7329 2073 6174 6973 6679 696e  rices) satisfyin
+000019f0: 670a 2020 2020 2020 2020 2020 2020 2020  g.              
+00001a00: 2020 2041 203d 2065 7870 2853 3129 4065     A = exp(S1)@e
+00001a10: 7870 2853 3229 2e20 5468 6573 6520 6d61  xp(S2). These ma
+00001a20: 7472 6963 6573 2063 616e 2062 6520 7573  trices can be us
+00001a30: 6564 2074 6f20 6f62 7461 696e 2072 6573  ed to obtain res
+00001a40: 7065 6374 6976 6520 706f 6c79 6e6f 6d69  pective polynomi
+00001a50: 616c 2072 6570 7265 7365 6e74 6174 696f  al representatio
+00001a60: 6e73 0a20 2020 2020 2020 2020 2020 2020  ns.             
+00001a70: 2020 2020 6f66 2074 6865 204c 6965 2d6f      of the Lie-o
+00001a80: 7065 7261 746f 722c 206d 6170 7069 6e67  perator, mapping
+00001a90: 2074 6865 2067 6976 656e 2048 616d 696c   the given Hamil
+00001aa0: 746f 6e69 616e 2048 2069 6e74 6f20 6974  tonian H into it
+00001ab0: 7320 2266 6972 7374 2d6f 7264 6572 2220  s "first-order" 
+00001ac0: 6e6f 726d 616c 2066 6f72 6d20 4e20 2873  normal form N (s
+00001ad0: 6565 0a20 2020 2020 2020 2020 2020 2020  ee.             
+00001ae0: 2020 2020 616c 736f 2074 6865 2063 6f6d      also the com
+00001af0: 6d6d 656e 7420 6162 6f76 6529 2e20 4e6f  mment above). No
+00001b00: 7465 2074 6861 7420 6966 2053 3120 6f72  te that if S1 or
+00001b10: 2053 3220 646f 6573 206e 6f74 2065 7869   S2 does not exi
+00001b20: 7374 2c20 7468 6973 206d 6561 6e73 2074  st, this means t
+00001b30: 6861 7420 7468 6520 7265 7370 6563 7469  hat the respecti
+00001b40: 7665 2065 6c65 6d65 6e74 2069 7320 7a65  ve element is ze
+00001b50: 726f 2c20 736f 2074 6865 2065 6c65 6d65  ro, so the eleme
+00001b60: 6e74 2041 2063 616e 2062 6520 7265 7065  nt A can be repe
+00001b70: 7365 6e74 6564 2061 7320 6120 7369 6e67  sented as a sing
+00001b80: 6c65 2065 7870 6f6e 656e 7469 616c 2e20  le exponential. 
+00001b90: 5468 6520 746f 6c65 7261 6e63 6520 7768  The tolerance wh
+00001ba0: 6963 680a 2020 2020 2020 2020 2020 2020  ich.            
+00001bb0: 2020 2020 2064 6574 6572 6d69 6e65 7320       determines 
+00001bc0: 7468 6973 2062 6568 6176 696f 7220 6361  this behavior ca
+00001bd0: 6e20 6265 2063 6f6e 7472 6f6c 6c65 6420  n be controlled 
+00001be0: 7769 7468 2074 6865 2074 6f6c 5f6c 6f67  with the tol_log
+00001bf0: 6d20 7061 7261 6d65 7465 722e 2053 6f20  m parameter. So 
+00001c00: 6966 2074 6861 7420 7061 7261 6d65 7465  if that paramete
+00001c10: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+00001c20: 2020 2069 7320 7365 7420 746f 207a 6572     is set to zer
+00001c30: 6f2c 2074 6865 7265 2077 696c 6c20 616c  o, there will al
+00001c40: 7761 7973 2062 6520 7265 7475 726e 6564  ways be returned
+00001c50: 2074 776f 2065 6c65 6d65 6e74 732e 0a20   two elements.. 
+00001c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001c70: 2a43 7572 7265 6e74 6c79 206f 6e6c 7920  *Currently only 
+00001c80: 7265 7475 726e 6564 2066 6f72 206e 756d  returned for num
+00001c90: 7079 2069 6e70 7574 2a0a 2020 2020 7223  py input*.    r#
+00001ca0: 0000 0072 0100 0000 7a17 4469 6d65 6e73  ...r....z.Dimens
+00001cb0: 696f 6e20 6d75 7374 2062 6520 6576 656e  ion must be even
+00001cc0: 2e4e da06 6d70 6d61 7468 7a2d 4a6f 7264  .N..mpmathz-Jord
+00001cd0: 616e 206e 6f72 6d61 6c20 666f 726d 206f  an normal form o
+00001ce0: 6620 4832 404a 206e 6f74 2064 6961 676f  f H2@J not diago
+00001cf0: 6e61 6c3a 0a48 323a 0a7a 060a 4a4e 463a  nal:.H2:.z..JNF:
+00001d00: 0ada 036e 6577 2902 da03 6469 6dda 0463  ...new)...dim..c
+00001d10: 6f64 6572 2400 0000 7225 0000 005a 0763  oder$...r%...Z.c
+00001d20: 6c61 7373 6963 721e 0000 00da 056e 756d  lassicr......num
+00001d30: 7079 da01 4d7a 064d 6f64 6520 277a 1127  py..Mz.Mode 'z.'
+00001d40: 206e 6f74 2072 6563 6f67 6e69 7a65 642e   not recognized.
+00001d50: da01 53da 0453 696e 76da 0248 325a 0372  ..S..Sinv..H2Z.r
+00001d60: 6e66 da01 54da 014a da02 4a32 721c 0000  nf..T..J..J2r...
+00001d70: 00da 0455 696e 76da 014b da04 4b69 6e76  ...Uinv..K..Kinv
+00001d80: da03 636e 6672 2000 0000 da01 41da 0874  ..cnfr .....A..t
+00001d90: 6f6c 5f6c 6f67 6de7 9b2b a186 9b84 063d  ol_logm..+.....=
+00001da0: 6301 0000 0000 0000 0000 0000 0003 0000  c...............
+00001db0: 0007 0000 0013 0000 0073 3400 0000 6700  .........s4...g.
+00001dc0: 7c00 5d16 7d01 7400 8800 8301 4400 5d0f  |.].}.t.....D.].
+00001dd0: 7d02 7401 8802 6a02 7c01 7c02 6602 1900  }.t...j.|.|.f...
+00001de0: 8301 8801 6b00 a003 a100 9103 7108 7102  ....k.......q.q.
+00001df0: 5300 7217 0000 0029 04da 0572 616e 6765  S.r....)...range
+00001e00: da03 6162 73da 066d 6174 7269 78da 0361  ..abs..matrix..a
+00001e10: 6c6c 2903 da02 2e30 da01 69da 016a a903  ll)....0..i..j..
+00001e20: 7228 0000 0072 3700 0000 da04 7a65 726f  r(...r7.....zero
+00001e30: 7217 0000 0072 1800 0000 da0a 3c6c 6973  r....r......<lis
+00001e40: 7463 6f6d 703e fb00 0000 7302 0000 0034  tcomp>....s....4
+00001e50: 007a 1f6e 6f72 6d61 6c5f 666f 726d 2e3c  .z.normal_form.<
+00001e60: 6c6f 6361 6c73 3e2e 3c6c 6973 7463 6f6d  locals>.<listcom
+00001e70: 703e da0c 7379 6d6c 6f67 735f 746f 6c32  p>..symlogs_tol2
+00001e80: 2901 da04 746f 6c32 7a49 4d61 7472 6978  )...tol2zIMatrix
+00001e90: 2061 7070 6561 7273 2074 6f20 7265 7175   appears to requ
+00001ea0: 6972 6520 7477 6f20 6578 706f 6e65 6e74  ire two exponent
+00001eb0: 6961 6c73 2066 6f72 2072 6570 7265 7365  ials for represe
+00001ec0: 6e74 6174 696f 6e20 2874 6f6c 5f6c 6f67  ntation (tol_log
+00001ed0: 6d3a 20fa 0129 da02 4332 da02 4331 7217  m: ..)..C2..C1r.
+00001ee0: 0000 0029 19da 036c 656e 7212 0000 0072  ...)...lenr....r
+00001ef0: 1000 0000 721a 0000 0072 0700 0000 da02  ....r....r......
+00001f00: 6d70 723b 0000 00da 0c73 796d 7079 5f6d  mpr;.....sympy_m
+00001f10: 6174 7269 78da 0b6a 6f72 6461 6e5f 666f  atrix..jordan_fo
+00001f20: 726d da0b 6973 5f64 6961 676f 6e61 6cda  rm..is_diagonal.
+00001f30: 0c52 756e 7469 6d65 4572 726f 7272 0a00  .RuntimeErrorr..
+00001f40: 0000 7209 0000 0072 0b00 0000 7206 0000  ..r....r....r...
+00001f50: 0072 0d00 0000 720c 0000 00da 0963 6f6e  .r....r......con
+00001f60: 6a75 6761 7465 da03 6765 7472 1900 0000  jugate..getr....
+00001f70: 723c 0000 0072 3900 0000 da07 7379 6d6c  r<...r9.....syml
+00001f80: 6f67 73da 0877 6172 6e69 6e67 73da 0477  ogs..warnings..w
+00001f90: 6172 6e29 1972 2e00 0000 722f 0000 00da  arn).r....r/....
+00001fa0: 046d 6f64 6572 2500 0000 7216 0000 0072  .moder%...r....r
+00001fb0: 2900 0000 5a05 545f 6374 7272 3000 0000  )...Z.T_ctrr0...
+00001fc0: 5a06 4a5f 7379 6d70 5a06 475f 7379 6d70  Z.J_sympZ.G_symp
+00001fd0: 5a06 505f 7379 6d70 5a03 4a4e 4672 2c00  Z.P_sympZ.JNFr,.
+00001fe0: 0000 7215 0000 0072 2d00 0000 7220 0000  ..r....r-...r ..
+00001ff0: 0072 1c00 0000 da01 5f72 3200 0000 7231  .r......_r2...r1
+00002000: 0000 0072 3300 0000 7234 0000 00da 036f  ...r3...r4.....o
+00002010: 7574 da02 4231 da02 4232 7217 0000 0072  ut..B1..B2r....r
+00002020: 4000 0000 7218 0000 00da 0b6e 6f72 6d61  @...r......norma
+00002030: 6c5f 666f 726d 3f00 0000 73ae 0000 0008  l_form?...s.....
+00002040: 4814 0108 0108 0108 0208 0108 010c 010c  H...............
+00002050: 0208 010a 0108 0104 020a 040a 0110 0108  ................
+00002060: 0114 0108 0316 0212 0108 0112 0110 0214  ................
+00002070: 010a 0108 011c 0412 0108 0112 0114 010a  ................
+00002080: 010a 010c 0218 0112 0114 0208 0114 010e  ................
+00002090: 021a 021c 0114 0110 020c 0510 0308 0408  ................
+000020a0: 010a 020c 010c 010c 010c 0108 0108 0104  ................
+000020b0: 030a 010a 010a 0216 010a 010c 0108 020a  ................
+000020c0: 010a 010a 010a 010a 010a 0116 010a 010a  ................
+000020d0: 0512 010c 0102 010a 0108 0214 0128 0106  .............(..
+000020e0: 011a 0212 0112 0114 0112 0104 0372 5800  .............rX.
+000020f0: 0000 7238 0000 0072 2a00 0000 da05 706f  ..r8...r*.....po
+00002100: 7765 72da 066e 5f61 7267 73da 0374 6f6c  wer..n_args..tol
+00002110: 6307 0000 0000 0000 0000 0000 0015 0000  c...............
+00002120: 0009 0000 000b 0000 0073 f601 0000 7c01  .........s....|.
+00002130: 6401 6b05 7306 4a00 8201 7c04 7d08 7c04  d.k.s.J...|.}.|.
+00002140: 6402 6b02 7210 7400 8800 8301 7d08 7c08  d.k.r.t.....}.|.
+00002150: 6401 1600 6402 6b02 731a 4a00 6403 8301  d...d.k.s.J.d...
+00002160: 8201 7401 8806 8301 6402 6b04 723b 7401  ..t.....d.k.r;t.
+00002170: 8806 8301 7c08 6b02 7333 4a00 6404 7401  ....|.k.s3J.d.t.
+00002180: 8806 8301 9b00 6405 7c08 9b00 6406 9d05  ......d.|...d...
+00002190: 8301 8201 8700 8706 6602 6407 6408 8408  ........f.d.d...
+000021a0: 8901 6e07 8800 8901 7c08 6402 6701 1400  ..n.....|.d.g...
+000021b0: 8906 7402 8801 6401 7c08 6409 8d03 7d09  ..t...d.|.d...}.
+000021c0: 7c08 6402 6701 1400 7d0a 7c09 6a03 7c0a  |.d.g...}.|.j.|.
+000021d0: 8e00 7d0b 7404 7c0b 640a 7c08 7c08 640b  ..}.t.|.d.|.|.d.
+000021e0: 8d04 7d0c 7c06 640c 6b02 7264 7405 a006  ..}.|.d.k.rdt...
+000021f0: 7c0c a101 7d0c 7c03 7290 7c09 a007 a100  |...}.|.r.|.....
+00002200: 8904 8704 6601 640d 640e 8408 7408 7c08  ....f.d.d...t.|.
+00002210: 8301 4400 8301 7d0d 7409 8705 6601 640f  ..D...}.t...f.d.
+00002220: 640e 8408 7c0d 4400 8301 8301 6402 6b04  d...|.D.....d.k.
+00002230: 7290 740a a00b 6410 8806 9b00 6411 8805  r.t...d.....d...
+00002240: 9b00 6412 7c0d 9b00 9d06 a101 0100 740c  ..d.|.........t.
+00002250: 7c0c 6601 6413 7c03 6901 7c07 a401 8e01  |.f.d.|.i.|.....
+00002260: 7d0e 7c0e 6414 1900 8902 8702 6601 6415  }.|.d.......f.d.
+00002270: 6408 8408 8903 8701 8703 6602 6416 6408  d.........f.d.d.
+00002280: 8408 7d0f 7402 7c0f 7c01 7c08 6409 8d03  ..}.t.|.|.|.d...
+00002290: 7d10 7c10 7c0a 6417 6418 6901 8e01 7d11  }.|.|.d.d.i...}.
+000022a0: 7c03 72f7 7c10 6a03 7c11 6419 8d01 7d12  |.r.|.j.|.d...}.
+000022b0: 8705 6601 641a 641b 8408 7c12 a00d a100  ..f.d.d...|.....
+000022c0: 4400 8301 7d12 7c12 a00e a100 4400 5d26  D...}.|.....D.]&
+000022d0: 7d13 740f 7c12 7c13 1900 7c0e 641c 1900  }.t.|.|...|.d...
+000022e0: 7c13 6402 1900 7c13 640a 1900 6602 1900  |.d...|.d...f...
+000022f0: 1800 8301 7d14 7c14 8805 6b04 72f6 7410  ....}.|...k.r.t.
+00002300: 641d 7c13 9b00 641e 7c14 9b00 641f 8805  d.|...d.|...d...
+00002310: 9b00 6420 9d07 8301 8201 71d0 7c11 7c0e  ..d ......q.|.|.
+00002320: 6602 5300 2921 611b 0600 000a 2020 2020  f.S.)!a.....    
+00002330: 5265 7475 726e 2074 6865 2054 6179 6c6f  Return the Taylo
+00002340: 722d 6578 7061 6e73 696f 6e20 6f66 2061  r-expansion of a
+00002350: 2048 616d 696c 746f 6e69 616e 2048 2069   Hamiltonian H i
+00002360: 6e20 7465 726d 7320 6f66 2066 6972 7374  n terms of first
+00002370: 2d6f 7264 6572 2063 6f6d 706c 6578 206e  -order complex n
+00002380: 6f72 6d61 6c20 666f 726d 2063 6f6f 7264  ormal form coord
+00002390: 696e 6174 6573 0a20 2020 2061 726f 756e  inates.    aroun
+000023a0: 6420 616e 206f 7074 696f 6e61 6c20 706f  d an optional po
+000023b0: 696e 7420 6f66 2069 6e74 6572 6573 742e  int of interest.
+000023c0: 2046 6f72 2074 6865 206e 6f74 6174 696f   For the notatio
+000023d0: 6e20 7365 6520 6d79 2074 6865 7369 732e  n see my thesis.
+000023e0: 0a20 2020 200a 2020 2020 5061 7261 6d65  .    .    Parame
+000023f0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+00002400: 2d2d 2d0a 2020 2020 483a 2063 616c 6c61  ---.    H: calla
+00002410: 626c 650a 2020 2020 2020 2020 4120 7265  ble.        A re
+00002420: 616c 2d76 616c 7565 6420 6675 6e63 7469  al-valued functi
+00002430: 6f6e 206f 6620 322a 6e20 7061 7261 6d65  on of 2*n parame
+00002440: 7465 7273 2028 4861 6d69 6c74 6f6e 6961  ters (Hamiltonia
+00002450: 6e29 2e0a 2020 2020 2020 2020 0a20 2020  n)..        .   
+00002460: 2070 6f77 6572 3a20 696e 742c 206f 7074   power: int, opt
+00002470: 696f 6e61 6c0a 2020 2020 2020 2020 5468  ional.        Th
+00002480: 6520 6d61 7869 6d61 6c20 706f 6c79 6e6f  e maximal polyno
+00002490: 6d69 616c 2070 6f77 6572 206f 6620 6578  mial power of ex
+000024a0: 7061 6e73 696f 6e2e 204d 7573 7420 6265  pansion. Must be
+000024b0: 203e 3d20 322e 0a20 2020 200a 2020 2020   >= 2..    .    
+000024c0: 7a3a 2073 7562 7363 7269 7074 6162 6c65  z: subscriptable
+000024d0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+000024e0: 2020 2041 2070 6f69 6e74 206f 6620 696e     A point of in
+000024f0: 7465 7265 7374 2061 726f 756e 6420 7768  terest around wh
+00002500: 6963 6820 7765 2077 616e 7420 746f 2065  ich we want to e
+00002510: 7870 616e 642e 2049 6620 6e6f 7468 696e  xpand. If nothin
+00002520: 6720 7370 6563 6966 6965 642c 0a20 2020  g specified,.   
+00002530: 2020 2020 2074 6865 6e20 7468 6520 6578       then the ex
+00002540: 7061 6e73 696f 6e20 7769 6c6c 2074 616b  pansion will tak
+00002550: 6520 706c 6163 6520 6172 6f75 6e64 207a  e place around z
+00002560: 6572 6f2e 0a20 2020 2020 2020 200a 2020  ero..        .  
+00002570: 2020 6e5f 6172 6773 3a20 696e 742c 206f    n_args: int, o
+00002580: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00002590: 4966 2048 2074 616b 6573 2061 2073 696e  If H takes a sin
+000025a0: 676c 6520 7375 6273 6372 6970 7461 626c  gle subscriptabl
+000025b0: 6520 6173 2061 7267 756d 656e 742c 2064  e as argument, d
+000025c0: 6566 696e 6520 7468 6520 6e75 6d62 6572  efine the number
+000025d0: 206f 6620 6172 6775 6d65 6e74 7320 7769   of arguments wi
+000025e0: 7468 2074 6869 7320 7061 7261 6d65 7465  th this paramete
+000025f0: 722e 0a20 2020 2020 2020 200a 2020 2020  r..        .    
+00002600: 6368 6563 6b3a 2062 6f6f 6c65 616e 2c20  check: boolean, 
+00002610: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00002620: 2054 7572 6e20 6f6e 2073 6f6d 6520 6261   Turn on some ba
+00002630: 7369 6320 6368 6563 6b73 3a0a 2020 2020  sic checks:.    
+00002640: 2020 2020 6129 2057 6172 6e20 6966 2074      a) Warn if t
+00002650: 6865 2065 7870 616e 7369 6f6e 206f 6620  he expansion of 
+00002660: 7468 6520 4861 6d69 6c74 6f6e 6961 6e20  the Hamiltonian 
+00002670: 6172 6f75 6e64 207a 2063 6f6e 7461 696e  around z contain
+00002680: 7320 6772 6164 6965 6e74 2074 6572 6d73  s gradient terms
+00002690: 206c 6172 6765 7220 7468 616e 2061 2073   larger than a s
+000026a0: 7065 6369 6669 6320 7661 6c75 652e 200a  pecific value. .
+000026b0: 2020 2020 2020 2020 6229 2056 6572 6966          b) Verif
+000026c0: 7920 7468 6174 2074 6865 2032 6e64 206f  y that the 2nd o
+000026d0: 7264 6572 2074 6572 6d73 2069 6e20 7468  rder terms in th
+000026e0: 6520 6578 7061 6e73 696f 6e20 6f66 2074  e expansion of t
+000026f0: 6865 2048 616d 696c 746f 6e69 616e 2061  he Hamiltonian a
+00002700: 6772 6565 2077 6974 6820 7468 6f73 6520  gree with those 
+00002710: 6672 6f6d 2074 6865 206c 696e 6561 7220  from the linear 
+00002720: 7468 656f 7279 2e0a 2020 2020 2020 2020  theory..        
+00002730: 0a20 2020 2074 6f6c 3a20 666c 6f61 742c  .    tol: float,
+00002740: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00002750: 2020 416e 206f 7074 696f 6e61 6c20 746f    An optional to
+00002760: 6c65 7261 6e63 6520 666f 7220 6368 6563  lerance for chec
+00002770: 6b73 2e0a 2020 2020 2020 2020 0a20 2020  ks..        .   
+00002780: 202a 2a6b 7761 7267 730a 2020 2020 2020   **kwargs.      
+00002790: 2020 4172 6775 6d65 6e74 7320 7061 7373    Arguments pass
+000027a0: 6564 2074 6f20 6c69 6e61 6c67 2e6e 6f72  ed to linalg.nor
+000027b0: 6d61 6c5f 666f 726d 2072 6f75 7469 6e65  mal_form routine
+000027c0: 2e0a 2020 2020 2020 2020 0a20 2020 2052  ..        .    R
+000027d0: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
+000027e0: 2d2d 0a20 2020 2064 6963 740a 2020 2020  --.    dict.    
+000027f0: 2020 2020 4120 6469 6374 696f 6e61 7279      A dictionary
+00002800: 206f 6620 7468 6520 5461 796c 6f72 2063   of the Taylor c
+00002810: 6f65 6666 6963 6965 6e74 7320 6f66 2074  oefficients of t
+00002820: 6865 2048 616d 696c 746f 6e69 616e 2069  he Hamiltonian i
+00002830: 6e20 6e6f 726d 616c 2066 6f72 6d20 6172  n normal form ar
+00002840: 6f75 6e64 207a 203d 2028 712c 2070 292c  ound z = (q, p),
+00002850: 2077 6865 7265 2074 6865 2066 6972 7374   where the first
+00002860: 206e 0a20 2020 2020 2020 2065 6e74 7269   n.        entri
+00002870: 6573 2064 656e 6f74 6520 706f 7765 7273  es denote powers
+00002880: 206f 6620 7869 2c20 7768 696c 6520 7468   of xi, while th
+00002890: 6520 6c61 7374 206e 2065 6e74 7269 6573  e last n entries
+000028a0: 2064 656e 6f74 6520 706f 7765 7273 206f   denote powers o
+000028b0: 6620 6574 612e 0a20 2020 2020 2020 200a  f eta..        .
+000028c0: 2020 2020 6469 6374 0a20 2020 2020 2020      dict.       
+000028d0: 2054 6865 206f 7574 7075 7420 6f66 206c   The output of l
+000028e0: 6965 6f70 732e 6c69 6e61 6c67 2e6e 662e  ieops.linalg.nf.
+000028f0: 6e6f 726d 616c 5f66 6f72 6d20 726f 7574  normal_form rout
+00002900: 696e 652c 2070 726f 7669 6469 6e67 2074  ine, providing t
+00002910: 6865 206c 696e 6561 7220 6d61 7020 696e  he linear map in
+00002920: 666f 726d 6174 696f 6e20 6174 2074 6865  formation at the
+00002930: 2072 6571 7565 7374 6564 2070 6f69 6e74   requested point
+00002940: 2e0a 2020 2020 7223 0000 0072 0100 0000  ..    r#...r....
+00002950: 7a34 4469 6d65 6e73 696f 6e20 6d75 7374  z4Dimension must
+00002960: 2062 6520 6576 656e 3b20 7472 7920 7061   be even; try pa
+00002970: 7373 696e 6720 6e5f 6172 6773 2061 7267  ssing n_args arg
+00002980: 756d 656e 742e 7a0b 4469 6d65 6e73 696f  ument.z.Dimensio
+00002990: 6e20 287a 2629 206f 6620 6375 7374 6f6d  n (z&) of custom
+000029a0: 2070 6f69 6e74 206d 6973 6d61 7463 6820   point mismatch 
+000029b0: 2865 7870 6563 7465 643a 2072 4500 0000  (expected: rE...
+000029c0: 6300 0000 0000 0000 0000 0000 0001 0000  c...............
+000029d0: 0005 0000 0017 0000 0073 2000 0000 8801  .........s .....
+000029e0: 8700 8702 6602 6401 6402 8408 7400 7401  ....f.d.d...t.t.
+000029f0: 8802 8301 8301 4400 8301 8e00 5300 2903  ......D.....S.).
+00002a00: 4e63 0100 0000 0000 0000 0000 0000 0200  Nc..............
+00002a10: 0000 0500 0000 1300 0000 731c 0000 0067  ..........s....g
+00002a20: 007c 005d 0a7d 0188 007c 0119 0088 017c  .|.].}...|.....|
+00002a30: 0119 0017 0091 0271 0253 0072 1700 0000  .......q.S.r....
+00002a40: 7217 0000 00a9 0272 3d00 0000 da01 6b29  r......r=.....k)
+00002a50: 02da 0178 da01 7a72 1700 0000 7218 0000  ...x..zr....r...
+00002a60: 0072 4200 0000 3b01 0000 f302 0000 001c  .rB...;.........
+00002a70: 00fa 3e66 6972 7374 5f6f 7264 6572 5f6e  ..>first_order_n
+00002a80: 665f 6578 7061 6e73 696f 6e2e 3c6c 6f63  f_expansion.<loc
+00002a90: 616c 733e 2e3c 6c61 6d62 6461 3e2e 3c6c  als>.<lambda>.<l
+00002aa0: 6f63 616c 733e 2e3c 6c69 7374 636f 6d70  ocals>.<listcomp
+00002ab0: 3ea9 0272 3900 0000 7248 0000 00a9 0172  >..r9...rH.....r
+00002ac0: 5e00 0000 2902 da01 4872 5f00 0000 7263  ^...)...Hr_...rc
+00002ad0: 0000 0072 1800 0000 da08 3c6c 616d 6264  ...r......<lambd
+00002ae0: 613e 3b01 0000 f302 0000 0020 007a 2a66  a>;........ .z*f
+00002af0: 6972 7374 5f6f 7264 6572 5f6e 665f 6578  irst_order_nf_ex
+00002b00: 7061 6e73 696f 6e2e 3c6c 6f63 616c 733e  pansion.<locals>
+00002b10: 2e3c 6c61 6d62 6461 3e29 02da 056f 7264  .<lambda>)...ord
+00002b20: 6572 725a 0000 0072 0500 0000 2903 da08  errZ...r....)...
+00002b30: 7379 6d6d 6574 7279 da06 6e5f 726f 7773  symmetry..n_rows
+00002b40: 5a06 6e5f 636f 6c73 7226 0000 0063 0100  Z.n_colsr&...c..
+00002b50: 0000 0000 0000 0000 0000 0200 0000 0600  ................
+00002b60: 0000 1300 0000 731a 0000 0067 007c 005d  ......s....g.|.]
+00002b70: 097d 0188 00a0 007c 0166 0164 00a1 0291  .}.....|.f.d....
+00002b80: 0271 0253 0029 0172 0100 0000 2901 724f  .q.S.).r....).rO
+00002b90: 0000 0072 5c00 0000 2901 da08 6772 6164  ...r\...)...grad
+00002ba0: 6965 6e74 7217 0000 0072 1800 0000 7242  ientr....r....rB
+00002bb0: 0000 0050 0100 0073 0200 0000 1a00 7a2c  ...P...s......z,
+00002bc0: 6669 7273 745f 6f72 6465 725f 6e66 5f65  first_order_nf_e
+00002bd0: 7870 616e 7369 6f6e 2e3c 6c6f 6361 6c73  xpansion.<locals
+00002be0: 3e2e 3c6c 6973 7463 6f6d 703e 6301 0000  >.<listcomp>c...
+00002bf0: 0000 0000 0000 0000 0002 0000 0004 0000  ................
+00002c00: 0013 0000 0073 1800 0000 6700 7c00 5d08  .....s....g.|.].
+00002c10: 7d01 7400 7c01 8301 8800 6b04 9102 7102  }.t.|.....k...q.
+00002c20: 5300 7217 0000 00a9 0172 3a00 0000 2902  S.r......r:...).
+00002c30: 723d 0000 00da 0163 a901 725b 0000 0072  r=.....c..r[...r
+00002c40: 1700 0000 7218 0000 0072 4200 0000 5101  ....r....rB...Q.
+00002c50: 0000 7302 0000 0018 007a 4549 6e70 7574  ..s......zEInput
+00002c60: 2061 7070 6561 7273 2074 6f20 6861 7665   appears to have
+00002c70: 2061 206e 6f6e 2d7a 6572 6f20 6772 6164   a non-zero grad
+00002c80: 6965 6e74 2061 726f 756e 6420 7468 6520  ient around the 
+00002c90: 7265 7175 6573 7465 6420 706f 696e 740a  requested point.
+00002ca0: 7a15 0a66 6f72 2067 6976 656e 2074 6f6c  z..for given tol
+00002cb0: 6572 616e 6365 207a 023a 0a72 2500 0000  erance z.:.r%...
+00002cc0: 7234 0000 0063 0000 0000 0000 0000 0000  r4...c..........
+00002cd0: 0000 0100 0000 0400 0000 1700 0000 731c  ..............s.
+00002ce0: 0000 0087 0187 0066 0264 0164 0284 0874  .......f.d.d...t
+00002cf0: 0074 0188 0083 0183 0144 0083 0153 0029  .t.......D...S.)
+00002d00: 034e 6301 0000 0000 0000 0000 0000 0001  .Nc.............
+00002d10: 0000 0007 0000 0013 0000 0073 2e00 0000  ...........s....
+00002d20: 6700 7c00 5d13 8900 7400 8701 8700 8702  g.|.]...t.......
+00002d30: 6603 6400 6401 8408 7401 7402 8802 8301  f.d.d...t.t.....
+00002d40: 8301 4400 8301 8301 9102 7102 5300 2902  ..D.......q.S.).
+00002d50: 6301 0000 0000 0000 0000 0000 0002 0000  c...............
+00002d60: 0006 0000 0013 0000 0073 2000 0000 6700  .........s ...g.
+00002d70: 7c00 5d0c 7d01 8802 7c01 1900 8800 8801  |.].}...|.......
+00002d80: 7c01 6602 1900 1400 9102 7102 5300 7217  |.f.......q.S.r.
+00002d90: 0000 0072 1700 0000 725c 0000 0029 0372  ...r....r\...).r
+00002da0: 3400 0000 723f 0000 00da 027a 7a72 1700  4...r?.....zzr..
+00002db0: 0000 7218 0000 0072 4200 0000 5901 0000  ..r....rB...Y...
+00002dc0: 7266 0000 007a 4966 6972 7374 5f6f 7264  rf...zIfirst_ord
+00002dd0: 6572 5f6e 665f 6578 7061 6e73 696f 6e2e  er_nf_expansion.
+00002de0: 3c6c 6f63 616c 733e 2e3c 6c61 6d62 6461  <locals>.<lambda
+00002df0: 3e2e 3c6c 6f63 616c 733e 2e3c 6c69 7374  >.<locals>.<list
+00002e00: 636f 6d70 3e2e 3c6c 6973 7463 6f6d 703e  comp>.<listcomp>
+00002e10: 2903 da03 7375 6d72 3900 0000 7248 0000  )...sumr9...rH..
+00002e20: 0029 0172 3d00 0000 2902 7234 0000 0072  .).r=...).r4...r
+00002e30: 6e00 0000 2901 723f 0000 0072 1800 0000  n...).r?...r....
+00002e40: 7242 0000 0059 0100 0073 0200 0000 2e00  rB...Y...s......
+00002e50: 7261 0000 0072 6200 0000 a901 726e 0000  ra...rb.....rn..
+00002e60: 0029 0172 3400 0000 7270 0000 0072 1800  .).r4...rp...r..
+00002e70: 0000 7265 0000 0059 0100 0072 6000 0000  ..re...Y...r`...
+00002e80: 6300 0000 0000 0000 0000 0000 0001 0000  c...............
+00002e90: 0003 0000 0017 0000 0073 0c00 0000 8800  .........s......
+00002ea0: 8801 7c00 8e00 8e00 5300 7214 0000 0072  ..|.....S.r....r
+00002eb0: 1700 0000 7270 0000 0029 02da 0648 7368  ....rp...)...Hsh
+00002ec0: 6966 74da 044b 6d61 7072 1700 0000 7218  ift..Kmapr....r.
+00002ed0: 0000 0072 6500 0000 5a01 0000 7302 0000  ...re...Z...s...
+00002ee0: 000c 00da 086d 756c 745f 6472 7646 2901  .....mult_drvF).
+00002ef0: da02 7463 6301 0000 0000 0000 0000 0000  ..tcc...........
+00002f00: 0003 0000 0004 0000 0013 0000 0073 2200  .............s".
+00002f10: 0000 6900 7c00 5d0d 5c02 7d01 7d02 7400  ..i.|.].\.}.}.t.
+00002f20: 7c02 8301 8800 6b04 7202 7c01 7c02 9302  |.....k.r.|.|...
+00002f30: 7102 5300 7217 0000 0072 6b00 0000 2903  q.S.r....rk...).
+00002f40: 723d 0000 0072 5d00 0000 da01 7672 6d00  r=...r].....vrm.
+00002f50: 0000 7217 0000 0072 1800 0000 da0a 3c64  ..r....r......<d
+00002f60: 6963 7463 6f6d 703e 6201 0000 7302 0000  ictcomp>b...s...
+00002f70: 0022 007a 2c66 6972 7374 5f6f 7264 6572  .".z,first_order
+00002f80: 5f6e 665f 6578 7061 6e73 696f 6e2e 3c6c  _nf_expansion.<l
+00002f90: 6f63 616c 733e 2e3c 6469 6374 636f 6d70  ocals>.<dictcomp
+00002fa0: 3e72 3500 0000 7a0a 434e 4620 656e 7472  >r5...z.CNF entr
+00002fb0: 7920 7a31 2064 6f65 7320 6e6f 7420 6167  y z1 does not ag
+00002fc0: 7265 6520 7769 7468 2048 616d 696c 746f  ree with Hamilto
+00002fd0: 6e69 616e 2065 7870 616e 7369 6f6e 3a20  nian expansion: 
+00002fe0: 6469 6666 207a 0320 3e20 7a07 2028 746f  diff z. > z. (to
+00002ff0: 6c29 2e29 1172 1100 0000 7248 0000 0072  l).).r....rH...r
+00003000: 1300 0000 da04 6865 7373 7208 0000 0072  ......hessr....r
+00003010: 4900 0000 723b 0000 00da 0467 7261 6472  I...r;.....gradr
+00003020: 3900 0000 da03 616e 7972 5100 0000 7252  9.....anyrQ...rR
+00003030: 0000 0072 5800 0000 da05 6974 656d 73da  ...rX.....items.
+00003040: 046b 6579 7372 3a00 0000 724d 0000 0029  .keysr:...rM...)
+00003050: 1572 6400 0000 7259 0000 0072 5f00 0000  .rd...rY...r_...
+00003060: 7225 0000 0072 5a00 0000 725b 0000 0072  r%...rZ...r[...r
+00003070: 2900 0000 7216 0000 00da 0464 696d 325a  )...r......dim2Z
+00003080: 0764 4873 6869 6674 da02 7a30 5a0a 4865  .dHshift..z0Z.He
+00003090: 7373 655f 6469 6374 5a0c 4865 7373 655f  sse_dictZ.Hesse_
+000030a0: 6d61 7472 6978 5a0b 6772 6164 5f76 6563  matrixZ.grad_vec
+000030b0: 746f 72da 066e 6664 6963 745a 0248 4b5a  tor..nfdictZ.HKZ
+000030c0: 0364 484b da07 7265 7375 6c74 735a 0d48  .dHK..resultsZ.H
+000030d0: 4b5f 6865 7373 655f 6469 6374 725d 0000  K_hesse_dictr]..
+000030e0: 00da 0464 6966 6672 1700 0000 2907 7264  ...diffr....).rd
+000030f0: 0000 0072 7100 0000 7234 0000 0072 7200  ...rq...r4...rr.
+00003100: 0000 726a 0000 0072 5b00 0000 725f 0000  ..rj...r[...r_..
+00003110: 0072 1800 0000 da18 6669 7273 745f 6f72  .r......first_or
+00003120: 6465 725f 6e66 5f65 7870 616e 7369 6f6e  der_nf_expansion
+00003130: 0701 0000 7348 0000 000c 2904 0108 0108  ....sH....).....
+00003140: 0114 010c 0526 0110 0104 020a 010e 080a  .....&..........
+00003150: 010a 0110 0108 010a 0104 0308 0116 011a  ................
+00003160: 011c 0114 0308 010c 030e 010e 010e 0104  ................
+00003170: 020c 0316 010c 0124 0108 011c 0102 ff08  .......$........
+00003180: 0372 8100 0000 2903 4e72 2400 0000 4629  .r....).Nr$...F)
+00003190: 2972 2600 0000 7249 0000 0072 5100 0000  )r&...rI...rQ...
+000031a0: da05 7379 6d70 7972 0200 0000 724a 0000  ..sympyr....rJ..
+000031b0: 00da 0c73 6369 7079 2e6c 696e 616c 6772  ...scipy.linalgr
+000031c0: 0300 0000 7204 0000 005a 0663 6865 636b  ....r....Z.check
+000031d0: 7372 0600 0000 723b 0000 0072 0700 0000  sr....r;...r....
+000031e0: 7208 0000 0072 0900 0000 5a1f 6c69 656f  r....r....Z.lieo
+000031f0: 7073 2e6c 696e 616c 672e 636f 6e67 7275  ps.linalg.congru
+00003200: 656e 6365 2e74 616b 6167 6972 0a00 0000  ence.takagir....
+00003210: 720b 0000 005a 236c 6965 6f70 732e 6c69  r....Z#lieops.li
+00003220: 6e61 6c67 2e63 6f6e 6772 7565 6e63 652e  nalg.congruence.
+00003230: 7769 6c6c 6961 6d73 6f6e 720c 0000 0072  williamsonr....r
+00003240: 0d00 0000 5a23 6c69 656f 7073 2e6c 696e  ....Z#lieops.lin
+00003250: 616c 672e 7369 6d69 6c61 7269 7479 2e73  alg.similarity.s
+00003260: 796d 706c 6563 7469 6372 0e00 0000 5a14  ymplecticr....Z.
+00003270: 6c69 656f 7073 2e6c 696e 616c 672e 636f  lieops.linalg.co
+00003280: 6d6d 6f6e 720f 0000 005a 146c 6965 6f70  mmonr....Z.lieop
+00003290: 732e 6c69 6e61 6c67 2e6d 6174 7269 7872  s.linalg.matrixr
+000032a0: 1000 0000 5a07 6e6a 6574 2e61 6472 1100  ....Z.njet.adr..
+000032b0: 0000 5a0e 6e6a 6574 2e66 756e 6374 696f  ..Z.njet.functio
+000032c0: 6e73 7212 0000 00da 046e 6a65 7472 1300  nsr......njetr..
+000032d0: 0000 7219 0000 0072 2200 0000 7250 0000  ..r....r"...rP..
+000032e0: 00da 0462 6f6f 6c72 5800 0000 da03 696e  ...boolrX.....in
+000032f0: 74da 0566 6c6f 6174 7281 0000 0072 1700  t..floatr....r..
+00003300: 0000 7217 0000 0072 1700 0000 7218 0000  ..r....r....r...
+00003310: 00da 083c 6d6f 6475 6c65 3e01 0000 0073  ...<module>....s
+00003320: 2e00 0000 0803 0801 0c01 1001 0c02 1401  ................
+00003330: 1002 1001 0c01 0c01 0c01 0c02 0c01 0c01  ................
+00003340: 0202 0a01 0803 0c23 1002 007f 0a49 0201  .......#.....I..
+00003350: 20ff                                      .
```

### Comparing `lieops-0.2.1/lieops/linalg/bch/.ipynb_checkpoints/bch_2x2-checkpoint.py` & `lieops-0.2.2/lieops/linalg/bch/.ipynb_checkpoints/bch_2x2-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/bch/__pycache__/bch_2x2.cpython-310.pyc` & `lieops-0.2.2/lieops/linalg/bch/__pycache__/bch_2x2.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/bch/bch_2x2.py` & `lieops-0.2.2/lieops/linalg/bch/bch_2x2.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/checks.py` & `lieops-0.2.2/lieops/linalg/checks.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/common.py` & `lieops-0.2.2/lieops/linalg/common.py`

 * *Files 10% similar despite different names*

```diff
@@ -425,7 +425,69 @@
     G = get_principal_sqrt(M@M.transpose())
     Q = np.linalg.inv(G)@M
     # checks:
     # G - G.transpose() == 0
     # Q.transpose()@Q = 1
     # G@Q = M
     return Q, G
+
+def ndsupport(func, n_out_args=1, n_inp_axes=2):
+    '''
+    Decorator for matrix-like calculations for multi-dimensional arrays.
+    
+    The first two indices of the input array are treated as matrix arrays, while the remaining indices
+    are considered to be running indices.
+    
+    Parameters
+    ----------
+    n_out_args: int, optional
+        If > 1, it is assumed that the function output returns more than one output.
+        
+    n_inp_axes: int, optional
+        Define the number of input axes (ascending from the first axis upwards) 
+        which should be considered as input for the function in question.
+    '''
+    def inner(X, **kwargs):
+        if not hasattr(X, 'shape'):
+            return func(X, **kwargs)
+        elif not len(X.shape) > n_inp_axes: # no modification required
+            return func(X, **kwargs)
+        else:
+            reference_shape = X.shape[n_inp_axes:]
+            # Bring first two axes (which we shall assume to run over the matrix indices) to the rear, then iterate over the remaining indices:
+            for k in range(n_inp_axes):
+                X = np.moveaxis(X, 0, -1)
+                
+            k = 0
+            for e in np.ndindex(reference_shape):
+                out = func(X[e], **kwargs)
+                if n_out_args == 1:
+                    if k == 0:
+                        out_shape = out.shape
+                        results = np.empty(list(reference_shape) + list(out.shape), dtype=np.complex128)
+                    results[e] = out
+                else:
+                    if k == 0:
+                        out_shapes = [z.shape for z in out]
+                        results = [np.empty(list(reference_shape) + list(z.shape), dtype=np.complex128) for z in out]
+                    j = 0
+                    for z in out:
+                        results[j][e] = z
+                        j += 1
+                k += 1
+
+            if n_out_args == 1:
+                results = np.copy(results) # prevent overwriting results in case function is called repeatedly
+                for k in range(len(out_shape)):
+                    results = np.moveaxis(results, -1, 0)
+                return results
+            else:
+                results2 = []
+                j = 0
+                for z in results:
+                    z = np.copy(z)
+                    for k in range(len(out_shapes[j])):                        
+                        z = np.moveaxis(z, -1, 0)
+                    results2.append(z)
+                    j += 1
+                return (*results2,)
+    return inner
```

### Comparing `lieops-0.2.1/lieops/linalg/congruence/.ipynb_checkpoints/common-checkpoint.py` & `lieops-0.2.2/lieops/linalg/congruence/.ipynb_checkpoints/common-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/congruence/.ipynb_checkpoints/takagi-checkpoint.py` & `lieops-0.2.2/lieops/linalg/congruence/.ipynb_checkpoints/takagi-checkpoint.py`

 * *Files 7% similar despite different names*

```diff
@@ -3,19 +3,19 @@
 
 from sympy import Matrix as sympy_matrix
 from sympy import diag as sympy_diag
 
 from njet.functions import get_package_name
 
 from lieops.linalg.matrix import create_J
-from lieops.linalg.common import eigenspaces, get_principal_sqrt
+from lieops.linalg.common import eigenspaces, get_principal_sqrt, ndsupport
 from lieops.linalg.similarity.common import diagonal2block
 from lieops.linalg.matrix import expandingSum
 
-def symplectic_takagi_old(G, d2b_tol=1e-10, check=True, **kwargs):
+def _symplectic_takagi_old(G, d2b_tol=1e-10, check=True, **kwargs):
     '''
     Symplectic Takagi factorization (OLD ROUTINE).
     
     Let G be a symmetric matrix with complex entries and J the canonical symplectic
     structure. Assumes that G@J is diagonalizable.
     
     Then this routine will determine a symplectic matrix S so that S@D@S.transpose() = G, where
@@ -88,15 +88,17 @@
     # It must hold: -J@YY.transpose()@J = Y. If this is not the case, then YY is not a polynomial square root of the above matrix.
     # (see Thm. 5.5 my notes, or Horner: Topics in Matrix Analysis, S-polar decomposition. Throw me a message if you need details)
     if kwargs.get('check', True):
         assert max(np.abs(np.array(-J@YY.transpose()@J - YY, dtype=np.complex128).flatten())) < d2b_tol, 'It appears that the routine to compute the matrix square root does not give a *polynomial* square root.'
         
     return YY@X, D, X
 
-def symplectic_takagi(G, **kwargs):
+symplectic_takagi_old = ndsupport(_symplectic_takagi_old, n_out_args=3)
+
+def _symplectic_takagi(G, **kwargs):
     '''
     Symplectic Takagi factorization.
     
     Let G be a symmetric matrix with complex entries and J the canonical symplectic
     structure. Assumes that G@J@G@J is diagonalizable.
     
     Then this routine will determine a symplectic matrix S so that S@G@S.transpose() is diagonal.
@@ -151,7 +153,8 @@
     # Now construct the symplectic diagonalizing matrix Y@Xi: 
     Y = get_principal_sqrt(-J@X.transpose()@J@X)
     if kwargs.get('check', True):
         assert max(np.abs(np.array(-J@Y.transpose()@J - Y, dtype=np.complex128).flatten())) < kwargs.get('d2b_tol', 1e-10), 'It appears that the routine to compute the matrix square root does not give a *polynomial* square root.'
     S = Y@Xi
     return S, S@G@S.transpose()
 
+symplectic_takagi = ndsupport(_symplectic_takagi, n_out_args=2)
```

### Comparing `lieops-0.2.1/lieops/linalg/congruence/__pycache__/common.cpython-310.pyc` & `lieops-0.2.2/lieops/linalg/congruence/__pycache__/common.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/congruence/__pycache__/symmetric.cpython-310.pyc` & `lieops-0.2.2/lieops/linalg/congruence/__pycache__/symmetric.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/congruence/__pycache__/takagi.cpython-310.pyc` & `lieops-0.2.2/lieops/linalg/congruence/__pycache__/takagi.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.10, timestamp-based, .py timestamp: Thu Feb 16 16:59:29 2023 UTC, .py size: 5749 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 8% similar despite different names*

```diff
@@ -1,284 +1,291 @@
-00000000: 6f0d 0d0a 0000 0000 f160 ee63 7516 0000  o........`.cu...
+00000000: 6f0d 0d0a 0000 0000 fa20 2c64 0a17 0000  o........ ,d....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
-00000020: 0003 0000 0040 0000 0073 7e00 0000 6400  .....@...s~...d.
+00000020: 0004 0000 0040 0000 0073 9a00 0000 6400  .....@...s....d.
 00000030: 6401 6c00 5a01 6400 6401 6c02 5a03 6400  d.l.Z.d.d.l.Z.d.
 00000040: 6402 6c04 6d05 5a06 0100 6400 6403 6c04  d.l.m.Z...d.d.l.
 00000050: 6d07 5a08 0100 6400 6404 6c09 6d0a 5a0a  m.Z...d.d.l.m.Z.
 00000060: 0100 6400 6405 6c0b 6d0c 5a0c 0100 6400  ..d.d.l.m.Z...d.
-00000070: 6406 6c0d 6d0e 5a0e 6d0f 5a0f 0100 6400  d.l.m.Z.m.Z...d.
-00000080: 6407 6c10 6d11 5a11 0100 6400 6408 6c0b  d.l.m.Z...d.d.l.
-00000090: 6d12 5a12 0100 640f 640b 640c 8401 5a13  m.Z...d.d.d...Z.
-000000a0: 640d 640e 8400 5a14 6401 5300 2910 e900  d.d...Z.d.S.)...
-000000b0: 0000 004e 2901 da06 4d61 7472 6978 2901  ...N)...Matrix).
-000000c0: da04 6469 6167 2901 da10 6765 745f 7061  ..diag)...get_pa
-000000d0: 636b 6167 655f 6e61 6d65 2901 da08 6372  ckage_name)...cr
-000000e0: 6561 7465 5f4a 2902 da0b 6569 6765 6e73  eate_J)...eigens
-000000f0: 7061 6365 73da 1267 6574 5f70 7269 6e63  paces..get_princ
-00000100: 6970 616c 5f73 7172 7429 01da 0e64 6961  ipal_sqrt)...dia
-00000110: 676f 6e61 6c32 626c 6f63 6b29 01da 0c65  gonal2block)...e
-00000120: 7870 616e 6469 6e67 5375 6de7 bbbd d7d9  xpandingSum.....
-00000130: df7c db3d 5463 0300 0000 0000 0000 0000  .|.=Tc..........
-00000140: 0000 1500 0000 0700 0000 0b00 0000 73ea  ..............s.
-00000150: 0100 0074 0088 0083 017d 0474 0188 0083  ...t.....}.t....
-00000160: 0189 0188 0164 0116 0064 026b 0273 124a  .....d...d.k.s.J
-00000170: 0064 0383 0182 0188 0164 011a 007d 0574  .d.......d...}.t
-00000180: 0287 0087 0166 0264 0464 0584 0874 0388  .....f.d.d...t..
-00000190: 0183 0144 0083 0183 017c 03a0 0464 067c  ...D.....|...d.|
-000001a0: 01a1 026b 0073 2e4a 0064 0783 0182 0174  ...k.s.J.d.....t
-000001b0: 057c 0583 017d 067c 0464 086b 0272 3b74  .|...}.|.d.k.r;t
-000001c0: 06a0 077c 06a1 017d 0688 007c 0610 007d  ...|...}...|...}
-000001d0: 0774 087c 0766 0164 0964 0a69 017c 03a4  .t.|.f.d.d.i.|..
-000001e0: 018e 015c 027d 087d 097c 0464 0b6b 0272  ...\.}.}.|.d.k.r
-000001f0: 5c74 09a0 0a7c 09a1 01a0 0ba1 007d 0a74  \t...|.......}.t
-00000200: 096a 0ca0 0d7c 0aa1 017d 0b7c 0464 086b  .j...|...}.|.d.k
-00000210: 0272 6c74 06a0 077c 09a1 01a0 0ba1 007d  .rlt...|.......}
-00000220: 0a74 06a0 0e7c 0aa1 017d 0b7c 03a0 0f64  .t...|...}.|...d
-00000230: 0664 0ca1 027d 0c74 107c 0866 017c 047c  .d...}.t.|.f.|.|
-00000240: 0164 0d9c 027c 03a4 018e 017d 0d7c 0da0  .d...|.....}.|..
-00000250: 0ba1 00a0 11a1 007c 0b10 007d 0e7c 0a7c  .......|...}.|.|
-00000260: 0d10 007d 0f7c 0e7c 0710 007c 0f10 007d  ...}.|.|...|...}
-00000270: 107c 100b 007c 0610 007d 117c 0464 0b6b  .|...|...}.|.d.k
-00000280: 0272 b874 06a0 077c 06a1 017d 1274 06a0  .r.t...|...}.t..
-00000290: 077c 0ea1 017d 1374 096a 0a74 06a0 127c  .|...}.t.j.t...|
-000002a0: 120b 007c 13a0 0ba1 0010 007c 1210 007c  ...|.......|...|
-000002b0: 1310 00a1 01a0 13a1 0074 096a 1464 0e8d  .........t.j.d..
-000002c0: 027d 147c 0464 086b 0272 ca74 06a0 127c  .}.|.d.k.r.t...|
-000002d0: 060b 007c 0ea0 0ba1 0010 007c 0610 007c  ...|.......|...|
-000002e0: 0e10 00a1 017d 147c 03a0 0464 0f64 0aa1  .....}.|...d.d..
-000002f0: 0272 ee74 0274 09a0 1574 096a 0a7c 060b  .r.t.t...t.j.|..
-00000300: 007c 14a0 0ba1 0010 007c 0610 007c 1418  .|.......|...|..
-00000310: 0074 096a 1464 0e8d 02a0 16a1 00a1 0183  .t.j.d..........
-00000320: 017c 016b 0073 ee4a 0064 1083 0182 017c  .|.k.s.J.d.....|
-00000330: 147c 0f10 007c 117c 0f66 0353 0029 1161  .|...|.|.f.S.).a
-00000340: 6e03 0000 0a20 2020 2053 796d 706c 6563  n....    Symplec
-00000350: 7469 6320 5461 6b61 6769 2066 6163 746f  tic Takagi facto
-00000360: 7269 7a61 7469 6f6e 2028 4f4c 4420 524f  rization (OLD RO
-00000370: 5554 494e 4529 2e0a 2020 2020 0a20 2020  UTINE)..    .   
-00000380: 204c 6574 2047 2062 6520 6120 7379 6d6d   Let G be a symm
-00000390: 6574 7269 6320 6d61 7472 6978 2077 6974  etric matrix wit
-000003a0: 6820 636f 6d70 6c65 7820 656e 7472 6965  h complex entrie
-000003b0: 7320 616e 6420 4a20 7468 6520 6361 6e6f  s and J the cano
-000003c0: 6e69 6361 6c20 7379 6d70 6c65 6374 6963  nical symplectic
-000003d0: 0a20 2020 2073 7472 7563 7475 7265 2e20  .    structure. 
-000003e0: 4173 7375 6d65 7320 7468 6174 2047 404a  Assumes that G@J
-000003f0: 2069 7320 6469 6167 6f6e 616c 697a 6162   is diagonalizab
-00000400: 6c65 2e0a 2020 2020 0a20 2020 2054 6865  le..    .    The
-00000410: 6e20 7468 6973 2072 6f75 7469 6e65 2077  n this routine w
-00000420: 696c 6c20 6465 7465 726d 696e 6520 6120  ill determine a 
-00000430: 7379 6d70 6c65 6374 6963 206d 6174 7269  symplectic matri
-00000440: 7820 5320 736f 2074 6861 7420 5340 4440  x S so that S@D@
-00000450: 532e 7472 616e 7370 6f73 6528 2920 3d20  S.transpose() = 
-00000460: 472c 2077 6865 7265 0a20 2020 2053 2077  G, where.    S w
-00000470: 696c 6c20 6265 2063 6f6d 706c 6578 2069  ill be complex i
-00000480: 6e20 6765 6e65 7261 6c20 616e 6420 4420  n general and D 
-00000490: 6120 6469 6167 6f6e 616c 206d 6174 7269  a diagonal matri
-000004a0: 782e 0a20 2020 200a 2020 2020 5061 7261  x..    .    Para
-000004b0: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
-000004c0: 2d2d 2d2d 2d0a 2020 2020 473a 206d 6174  -----.    G: mat
-000004d0: 7269 780a 2020 2020 2020 2020 5379 6d6d  rix.        Symm
-000004e0: 6574 7269 6320 6d61 7472 6978 2e0a 2020  etric matrix..  
-000004f0: 2020 2020 2020 0a20 2020 2064 3262 5f74        .    d2b_t
-00000500: 6f6c 3a20 666c 6f61 742c 206f 7074 696f  ol: float, optio
-00000510: 6e61 6c0a 2020 2020 2020 2020 4f70 7469  nal.        Opti
-00000520: 6f6e 616c 2074 6f6c 6572 616e 6365 2067  onal tolerance g
-00000530: 6976 656e 2074 6f20 2764 6961 676f 6e61  iven to 'diagona
-00000540: 6c32 626c 6f63 6b27 2072 6f75 7469 6e65  l2block' routine
-00000550: 2e0a 2020 2020 2020 2020 0a20 2020 202a  ..        .    *
-00000560: 2a6b 7761 7267 733a 206f 7074 696f 6e61  *kwargs: optiona
-00000570: 6c0a 2020 2020 2020 2020 4f70 7469 6f6e  l.        Option
-00000580: 616c 2061 7267 756d 656e 7473 2070 6173  al arguments pas
-00000590: 7365 6420 746f 2027 6569 6765 6e73 7061  sed to 'eigenspa
-000005a0: 6365 7327 2072 6f75 7469 6e65 2e0a 2020  ces' routine..  
-000005b0: 2020 2020 2020 0a20 2020 2052 6574 7572        .    Retur
-000005c0: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
-000005d0: 2020 2053 3a20 6d61 7472 6978 0a20 2020     S: matrix.   
-000005e0: 2020 2020 2053 796d 706c 6563 7469 6320       Symplectic 
-000005f0: 6d61 7472 6978 2e0a 2020 2020 2020 2020  matrix..        
-00000600: 0a20 2020 2044 3a20 6d61 7472 6978 0a20  .    D: matrix. 
-00000610: 2020 2020 2020 2044 6961 676f 6e61 6c20         Diagonal 
-00000620: 6d61 7472 6978 2e0a 2020 2020 2020 2020  matrix..        
-00000630: 0a20 2020 2058 3a20 6d61 7472 6978 0a20  .    X: matrix. 
-00000640: 2020 2020 2020 204d 6174 7269 7820 7768         Matrix wh
-00000650: 6963 6820 6861 7320 6265 656e 2066 6f75  ich has been fou
-00000660: 6e64 2074 6f20 616e 7469 2d64 6961 676f  nd to anti-diago
-00000670: 6e61 6c69 7a65 2047 404a 2073 6f20 7468  nalize G@J so th
-00000680: 6174 2058 5e28 2d31 2940 4740 4a40 5820  at X^(-1)@G@J@X 
-00000690: 3d20 4620 6973 2069 6e20 616e 7469 2d64  = F is in anti-d
-000006a0: 6961 676f 6e61 6c20 666f 726d 2e0a 2020  iagonal form..  
-000006b0: 2020 e902 0000 0072 0100 0000 fa17 4469    .....r......Di
-000006c0: 6d65 6e73 696f 6e20 6d75 7374 2062 6520  mension must be 
-000006d0: 6576 656e 2e63 0100 0000 0000 0000 0000  even.c..........
-000006e0: 0000 0100 0000 0600 0000 1300 0000 7328  ..............s(
-000006f0: 0000 0067 007c 005d 1089 0074 0087 0187  ...g.|.]...t....
-00000700: 0066 0264 0064 0184 0874 0188 0283 0144  .f.d.d...t.....D
-00000710: 0083 0183 0191 0271 0253 0029 0263 0100  .......q.S.).c..
-00000720: 0000 0000 0000 0000 0000 0200 0000 0700  ................
-00000730: 0000 1300 0000 7328 0000 0067 007c 005d  ......s(...g.|.]
-00000740: 107d 0174 0088 007c 0188 0166 0219 0088  .}.t...|...f....
-00000750: 0088 017c 0166 0219 0018 0083 0191 0271  ...|.f.........q
-00000760: 0253 00a9 0029 01da 0361 6273 2902 da02  .S...)...abs)...
-00000770: 2e30 da01 6a29 02da 0147 da01 6b72 0d00  .0..j)...G..kr..
-00000780: 0000 fa60 2f68 6f6d 652f 6d61 6c74 652f  ...`/home/malte/
-00000790: 6d69 6e69 636f 6e64 6133 2f65 6e76 732f  miniconda3/envs/
-000007a0: 776f 726b 2f6c 6962 2f70 7974 686f 6e33  work/lib/python3
-000007b0: 2e31 302f 7369 7465 2d70 6163 6b61 6765  .10/site-package
-000007c0: 732f 6c69 656f 7073 2f6c 696e 616c 672f  s/lieops/linalg/
-000007d0: 636f 6e67 7275 656e 6365 2f74 616b 6167  congruence/takag
-000007e0: 692e 7079 da0a 3c6c 6973 7463 6f6d 703e  i.py..<listcomp>
-000007f0: 3300 0000 f302 0000 0028 007a 3473 796d  3........(.z4sym
-00000800: 706c 6563 7469 635f 7461 6b61 6769 5f6f  plectic_takagi_o
-00000810: 6c64 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973  ld.<locals>.<lis
-00000820: 7463 6f6d 703e 2e3c 6c69 7374 636f 6d70  tcomp>.<listcomp
-00000830: 3e29 02da 036d 6178 da05 7261 6e67 6529  >)...max..range)
-00000840: 0172 0f00 0000 a902 7211 0000 00da 0464  .r......r......d
-00000850: 696d 3229 0172 1200 0000 7213 0000 0072  im2).r....r....r
-00000860: 1400 0000 3300 0000 7215 0000 007a 2973  ....3...r....z)s
-00000870: 796d 706c 6563 7469 635f 7461 6b61 6769  ymplectic_takagi
-00000880: 5f6f 6c64 2e3c 6c6f 6361 6c73 3e2e 3c6c  _old.<locals>.<l
-00000890: 6973 7463 6f6d 703e da03 746f 6c7a 2d49  istcomp>..tolz-I
-000008a0: 6e70 7574 206d 6174 7269 7820 646f 6573  nput matrix does
-000008b0: 206e 6f74 2061 7070 6561 7220 746f 2062   not appear to b
-000008c0: 6520 7379 6d6d 6574 7269 632e da06 6d70  e symmetric...mp
-000008d0: 6d61 7468 da07 666c 6174 7465 6e54 da05  math..flattenT..
-000008e0: 6e75 6d70 794e 2902 da04 636f 6465 721a  numpyN)...coder.
-000008f0: 0000 00a9 01da 0564 7479 7065 da05 6368  .......dtype..ch
-00000900: 6563 6bfa 6749 7420 6170 7065 6172 7320  eck.gIt appears 
-00000910: 7468 6174 2074 6865 2072 6f75 7469 6e65  that the routine
-00000920: 2074 6f20 636f 6d70 7574 6520 7468 6520   to compute the 
-00000930: 6d61 7472 6978 2073 7175 6172 6520 726f  matrix square ro
-00000940: 6f74 2064 6f65 7320 6e6f 7420 6769 7665  ot does not give
-00000950: 2061 202a 706f 6c79 6e6f 6d69 616c 2a20   a *polynomial* 
-00000960: 7371 7561 7265 2072 6f6f 742e 2917 7204  square root.).r.
-00000970: 0000 00da 036c 656e 7216 0000 0072 1700  .....lenr....r..
-00000980: 0000 da03 6765 7472 0500 0000 da02 6d70  ....getr......mp
-00000990: da06 6d61 7472 6978 7206 0000 00da 026e  ..matrixr......n
-000009a0: 70da 0561 7272 6179 da09 7472 616e 7370  p..array..transp
-000009b0: 6f73 65da 066c 696e 616c 67da 0369 6e76  ose..linalg..inv
-000009c0: da07 696e 7665 7273 65da 0370 6f70 7208  ..inverse..popr.
-000009d0: 0000 00da 0963 6f6e 6a75 6761 7465 da05  .....conjugate..
-000009e0: 7371 7274 6dda 0674 6f6c 6973 74da 0a63  sqrtm..tolist..c
-000009f0: 6f6d 706c 6578 3132 3872 0e00 0000 721c  omplex128r....r.
-00000a00: 0000 0029 1572 1100 0000 da07 6432 625f  ...).r......d2b_
-00000a10: 746f 6c72 2100 0000 da06 6b77 6172 6773  tolr!.....kwargs
-00000a20: 721e 0000 00da 0364 696d da01 4ada 0247  r......dim..J..G
-00000a30: 4ada 0565 7661 6c73 da06 6576 6563 7473  J..evals..evects
-00000a40: da01 59da 0259 69da 015f da01 55da 0258  ..Y..Yi.._..U..X
-00000a50: 69da 0158 da01 46da 0144 da03 4a6d 70da  i..X..F..D..Jmp.
-00000a60: 0458 696d 70da 0259 5972 0d00 0000 7218  .Ximp..YYr....r.
-00000a70: 0000 0072 1300 0000 da15 7379 6d70 6c65  ...r......symple
-00000a80: 6374 6963 5f74 616b 6167 695f 6f6c 640e  ctic_takagi_old.
-00000a90: 0000 0073 3e00 0000 0820 0802 1401 0801  ...s>.... ......
-00000aa0: 3001 0802 0801 0a01 0802 1803 0801 0e01  0...............
-00000ab0: 0c01 0801 0e01 0a01 0c03 1601 1001 0801  ................
-00000ac0: 0c01 0a01 0803 0a05 0a01 2c01 0801 1c01  ..........,.....
-00000ad0: 0c04 3c01 0e02 7244 0000 0063 0100 0000  ..<...rD...c....
-00000ae0: 0000 0000 0000 0000 1700 0000 0800 0000  ................
-00000af0: 4b00 0000 73aa 0100 0074 007c 0083 017d  K...s....t.|...}
-00000b00: 027c 0264 0116 0064 026b 0273 0e4a 0064  .|.d...d.k.s.J.d
-00000b10: 0383 0182 017c 0264 011a 007d 0374 017c  .....|.d...}.t.|
-00000b20: 0383 017d 0474 027c 007c 0410 0083 017d  ...}.t.|.|.....}
-00000b30: 057c 05a0 03a1 005c 027d 067d 0774 047c  .|.....\.}.}.t.|
-00000b40: 078e 007d 0874 05a0 067c 06a1 01a0 0774  ...}.t...|.....t
-00000b50: 056a 08a1 017d 0674 05a0 0664 0464 0567  .j...}.t...d.d.g
-00000b60: 0264 0664 0667 0267 02a1 0174 05a0 0964  .d.d.g.g...t...d
-00000b70: 01a1 011b 007d 0974 05a0 0a64 0164 0167  .....}.t...d.d.g
-00000b80: 02a1 017d 0a74 05a0 0b64 01a1 017d 0b67  ...}.t...d...}.g
-00000b90: 007d 0c64 027d 0d7c 0744 005d 157d 0e7c  .}.d.}.|.D.].}.|
-00000ba0: 0e6a 0c64 0219 0064 016b 0272 667c 0ca0  .j.d...d.k.rf|..
-00000bb0: 0d7c 0da1 0101 007c 0ca0 0d7c 0d64 0617  .|.....|...|.d..
-00000bc0: 00a1 0101 0071 5174 05a0 067c 08a0 0ea1  .....qQt...|....
-00000bd0: 00a1 01a0 0774 056a 08a1 0164 0219 007d  .....t.j...d...}
-00000be0: 0f74 0f7c 0f64 077c 0c7c 01a0 1064 0867  .t.|.d.|.|...d.g
-00000bf0: 00a1 0264 098d 047d 1074 117c 0383 017d  ...d...}.t.|...}
-00000c00: 117c 107c 1110 007d 127c 067c 1210 007d  .|.|...}.|.|...}
-00000c10: 1374 056a 12a0 137c 13a1 017d 1474 147c  .t.j...|...}.t.|
-00000c20: 040b 007c 13a0 15a1 0010 007c 0410 007c  ...|.......|...|
-00000c30: 1310 0083 017d 157c 01a0 1064 0a64 0ba1  .....}.|...d.d..
-00000c40: 0272 c774 1674 05a0 1774 056a 067c 040b  .r.t.t...t.j.|..
-00000c50: 007c 15a0 15a1 0010 007c 0410 007c 1518  .|.......|...|..
-00000c60: 0074 056a 0864 0c8d 02a0 18a1 00a1 0183  .t.j.d..........
-00000c70: 017c 01a0 1064 0d64 0ea1 026b 0073 c74a  .|...d.d...k.s.J
-00000c80: 0064 0f83 0182 017c 157c 1410 007d 167c  .d.....|.|...}.|
-00000c90: 167c 167c 0010 007c 16a0 15a1 0010 0066  .|.|...|.......f
-00000ca0: 0253 0029 1061 0d02 0000 0a20 2020 2053  .S.).a.....    S
-00000cb0: 796d 706c 6563 7469 6320 5461 6b61 6769  ymplectic Takagi
-00000cc0: 2066 6163 746f 7269 7a61 7469 6f6e 2e0a   factorization..
-00000cd0: 2020 2020 0a20 2020 204c 6574 2047 2062      .    Let G b
-00000ce0: 6520 6120 7379 6d6d 6574 7269 6320 6d61  e a symmetric ma
-00000cf0: 7472 6978 2077 6974 6820 636f 6d70 6c65  trix with comple
-00000d00: 7820 656e 7472 6965 7320 616e 6420 4a20  x entries and J 
-00000d10: 7468 6520 6361 6e6f 6e69 6361 6c20 7379  the canonical sy
-00000d20: 6d70 6c65 6374 6963 0a20 2020 2073 7472  mplectic.    str
-00000d30: 7563 7475 7265 2e20 4173 7375 6d65 7320  ucture. Assumes 
-00000d40: 7468 6174 2047 404a 4047 404a 2069 7320  that G@J@G@J is 
-00000d50: 6469 6167 6f6e 616c 697a 6162 6c65 2e0a  diagonalizable..
-00000d60: 2020 2020 0a20 2020 2054 6865 6e20 7468      .    Then th
-00000d70: 6973 2072 6f75 7469 6e65 2077 696c 6c20  is routine will 
-00000d80: 6465 7465 726d 696e 6520 6120 7379 6d70  determine a symp
-00000d90: 6c65 6374 6963 206d 6174 7269 7820 5320  lectic matrix S 
-00000da0: 736f 2074 6861 7420 5340 4740 532e 7472  so that S@G@S.tr
-00000db0: 616e 7370 6f73 6528 2920 6973 2064 6961  anspose() is dia
-00000dc0: 676f 6e61 6c2e 0a20 2020 200a 2020 2020  gonal..    .    
-00000dd0: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-00000de0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 473a  ---------.    G:
-00000df0: 206d 6174 7269 780a 2020 2020 2020 2020   matrix.        
-00000e00: 5379 6d6d 6574 7269 6320 6d61 7472 6978  Symmetric matrix
-00000e10: 2e0a 0a20 2020 202a 2a6b 7761 7267 733a  ...    **kwargs:
-00000e20: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00000e30: 2020 4f70 7469 6f6e 616c 2061 7267 756d    Optional argum
-00000e40: 656e 7473 2070 6173 7365 6420 746f 2027  ents passed to '
-00000e50: 6469 6167 6f6e 616c 3262 6c6f 636b 2720  diagonal2block' 
-00000e60: 726f 7574 696e 652e 0a20 2020 2020 2020  routine..       
-00000e70: 200a 2020 2020 5265 7475 726e 730a 2020   .    Returns.  
-00000e80: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 533a    -------.    S:
-00000e90: 206d 6174 7269 780a 2020 2020 2020 2020   matrix.        
-00000ea0: 5379 6d70 6c65 6374 6963 206d 6174 7269  Symplectic matri
-00000eb0: 782e 0a20 2020 2072 0b00 0000 7201 0000  x..    r....r...
-00000ec0: 0072 0c00 0000 7900 0000 0000 0000 0000  .r....y.........
-00000ed0: 0000 0000 00f0 3f79 0000 0000 0000 0080  ......?y........
-00000ee0: 0000 0000 0000 f0bf e901 0000 0072 1d00  .............r..
-00000ef0: 0000 da0b 6f72 6965 6e74 6174 696f 6e29  ....orientation)
-00000f00: 0372 1e00 0000 da04 736b 6970 7246 0000  .r......skiprF..
-00000f10: 0072 2100 0000 5472 1f00 0000 7232 0000  .r!...Tr....r2..
-00000f20: 0072 0a00 0000 7222 0000 0029 1972 2300  .r....r"...).r#.
-00000f30: 0000 7205 0000 00da 0c73 796d 7079 5f6d  ..r......sympy_m
-00000f40: 6174 7269 78da 0c6a 6f72 6461 6e5f 6365  atrix..jordan_ce
-00000f50: 6c6c 73da 0a73 796d 7079 5f64 6961 6772  lls..sympy_diagr
-00000f60: 2700 0000 7228 0000 00da 0661 7374 7970  '...r(.....astyp
-00000f70: 6572 3100 0000 da04 7371 7274 da05 7a65  er1.....sqrt..ze
-00000f80: 726f 73da 0365 7965 da05 7368 6170 65da  ros..eye..shape.
-00000f90: 0661 7070 656e 64da 0864 6961 676f 6e61  .append..diagona
-00000fa0: 6c72 0800 0000 7224 0000 0072 0900 0000  lr....r$...r....
-00000fb0: 722a 0000 0072 2b00 0000 7207 0000 0072  r*...r+...r....r
-00000fc0: 2900 0000 7216 0000 0072 0e00 0000 721c  )...r....r....r.
-00000fd0: 0000 0029 1772 1100 0000 7233 0000 0072  ...).r....r3...r
-00000fe0: 1900 0000 7234 0000 0072 3500 0000 da03  ....r4...r5.....
-00000ff0: 474a 73da 0150 da05 6365 6c6c 73da 034a  GJs..P..cells..J
-00001000: 4e46 da02 5532 da05 7a65 726f 32da 046f  NF..U2..zero2..o
-00001010: 6e65 3272 4700 0000 7212 0000 00da 0163  ne2rG...r......c
-00001020: da0f 6469 6167 6f6e 616c 5f6f 665f 4a4e  ..diagonal_of_JN
-00001030: 4672 3c00 0000 da01 54da 0255 5472 3e00  Fr<.....T..UTr>.
-00001040: 0000 723d 0000 0072 3900 0000 da01 5372  ..r=...r9.....Sr
-00001050: 0d00 0000 720d 0000 0072 1300 0000 da11  ....r....r......
-00001060: 7379 6d70 6c65 6374 6963 5f74 616b 6167  symplectic_takag
-00001070: 695f 0000 0073 3a00 0000 0817 1401 0801  i_...s:.........
-00001080: 0803 0c01 0c01 0801 1201 2002 0e01 0a01  .......... .....
-00001090: 0403 0401 0801 0e01 0a01 0e01 0280 1a01  ................
-000010a0: 1801 0805 0801 0801 0c01 1a03 0c01 4401  ..............D.
-000010b0: 0801 1401 725e 0000 0029 0272 0a00 0000  ....r^...).r....
-000010c0: 5429 1572 1d00 0000 7227 0000 0072 1b00  T).r....r'...r..
-000010d0: 0000 7225 0000 00da 0573 796d 7079 7202  ..r%.....sympyr.
-000010e0: 0000 0072 4800 0000 7203 0000 0072 4a00  ...rH...r....rJ.
-000010f0: 0000 da0e 6e6a 6574 2e66 756e 6374 696f  ....njet.functio
-00001100: 6e73 7204 0000 00da 146c 6965 6f70 732e  nsr......lieops.
-00001110: 6c69 6e61 6c67 2e6d 6174 7269 7872 0500  linalg.matrixr..
-00001120: 0000 da14 6c69 656f 7073 2e6c 696e 616c  ....lieops.linal
-00001130: 672e 636f 6d6d 6f6e 7206 0000 0072 0700  g.commonr....r..
-00001140: 0000 da1f 6c69 656f 7073 2e6c 696e 616c  ....lieops.linal
-00001150: 672e 7369 6d69 6c61 7269 7479 2e63 6f6d  g.similarity.com
-00001160: 6d6f 6e72 0800 0000 7209 0000 0072 4400  monr....r....rD.
-00001170: 0000 725e 0000 0072 0d00 0000 720d 0000  ..r^...r....r...
-00001180: 0072 0d00 0000 7213 0000 00da 083c 6d6f  .r....r......<mo
-00001190: 6475 6c65 3e01 0000 0073 1600 0000 0800  dule>....s......
-000011a0: 0801 0c02 0c01 0c02 0c02 1001 0c01 0c01  ................
-000011b0: 0a02 0c51                                ...Q
+00000070: 6406 6c0d 6d0e 5a0e 6d0f 5a0f 6d10 5a10  d.l.m.Z.m.Z.m.Z.
+00000080: 0100 6400 6407 6c11 6d12 5a12 0100 6400  ..d.d.l.m.Z...d.
+00000090: 6408 6c0b 6d13 5a13 0100 6412 640b 640c  d.l.m.Z...d.d.d.
+000000a0: 8401 5a14 6510 6514 640d 640e 8d02 5a15  ..Z.e.e.d.d...Z.
+000000b0: 640f 6410 8400 5a16 6510 6516 6411 640e  d.d...Z.e.e.d.d.
+000000c0: 8d02 5a17 6401 5300 2913 e900 0000 004e  ..Z.d.S.)......N
+000000d0: 2901 da06 4d61 7472 6978 2901 da04 6469  )...Matrix)...di
+000000e0: 6167 2901 da10 6765 745f 7061 636b 6167  ag)...get_packag
+000000f0: 655f 6e61 6d65 2901 da08 6372 6561 7465  e_name)...create
+00000100: 5f4a 2903 da0b 6569 6765 6e73 7061 6365  _J)...eigenspace
+00000110: 73da 1267 6574 5f70 7269 6e63 6970 616c  s..get_principal
+00000120: 5f73 7172 74da 096e 6473 7570 706f 7274  _sqrt..ndsupport
+00000130: 2901 da0e 6469 6167 6f6e 616c 3262 6c6f  )...diagonal2blo
+00000140: 636b 2901 da0c 6578 7061 6e64 696e 6753  ck)...expandingS
+00000150: 756d e7bb bdd7 d9df 7cdb 3d54 6303 0000  um......|.=Tc...
+00000160: 0000 0000 0000 0000 0015 0000 0007 0000  ................
+00000170: 000b 0000 0073 ea01 0000 7400 8800 8301  .....s....t.....
+00000180: 7d04 7401 8800 8301 8901 8801 6401 1600  }.t.........d...
+00000190: 6402 6b02 7312 4a00 6403 8301 8201 8801  d.k.s.J.d.......
+000001a0: 6401 1a00 7d05 7402 8700 8701 6602 6404  d...}.t.....f.d.
+000001b0: 6405 8408 7403 8801 8301 4400 8301 8301  d...t.....D.....
+000001c0: 7c03 a004 6406 7c01 a102 6b00 732e 4a00  |...d.|...k.s.J.
+000001d0: 6407 8301 8201 7405 7c05 8301 7d06 7c04  d.....t.|...}.|.
+000001e0: 6408 6b02 723b 7406 a007 7c06 a101 7d06  d.k.r;t...|...}.
+000001f0: 8800 7c06 1000 7d07 7408 7c07 6601 6409  ..|...}.t.|.f.d.
+00000200: 640a 6901 7c03 a401 8e01 5c02 7d08 7d09  d.i.|.....\.}.}.
+00000210: 7c04 640b 6b02 725c 7409 a00a 7c09 a101  |.d.k.r\t...|...
+00000220: a00b a100 7d0a 7409 6a0c a00d 7c0a a101  ....}.t.j...|...
+00000230: 7d0b 7c04 6408 6b02 726c 7406 a007 7c09  }.|.d.k.rlt...|.
+00000240: a101 a00b a100 7d0a 7406 a00e 7c0a a101  ......}.t...|...
+00000250: 7d0b 7c03 a00f 6406 640c a102 7d0c 7410  }.|...d.d...}.t.
+00000260: 7c08 6601 7c04 7c01 640d 9c02 7c03 a401  |.f.|.|.d...|...
+00000270: 8e01 7d0d 7c0d a00b a100 a011 a100 7c0b  ..}.|.........|.
+00000280: 1000 7d0e 7c0a 7c0d 1000 7d0f 7c0e 7c07  ..}.|.|...}.|.|.
+00000290: 1000 7c0f 1000 7d10 7c10 0b00 7c06 1000  ..|...}.|...|...
+000002a0: 7d11 7c04 640b 6b02 72b8 7406 a007 7c06  }.|.d.k.r.t...|.
+000002b0: a101 7d12 7406 a007 7c0e a101 7d13 7409  ..}.t...|...}.t.
+000002c0: 6a0a 7406 a012 7c12 0b00 7c13 a00b a100  j.t...|...|.....
+000002d0: 1000 7c12 1000 7c13 1000 a101 a013 a100  ..|...|.........
+000002e0: 7409 6a14 640e 8d02 7d14 7c04 6408 6b02  t.j.d...}.|.d.k.
+000002f0: 72ca 7406 a012 7c06 0b00 7c0e a00b a100  r.t...|...|.....
+00000300: 1000 7c06 1000 7c0e 1000 a101 7d14 7c03  ..|...|.....}.|.
+00000310: a004 640f 640a a102 72ee 7402 7409 a015  ..d.d...r.t.t...
+00000320: 7409 6a0a 7c06 0b00 7c14 a00b a100 1000  t.j.|...|.......
+00000330: 7c06 1000 7c14 1800 7409 6a14 640e 8d02  |...|...t.j.d...
+00000340: a016 a100 a101 8301 7c01 6b00 73ee 4a00  ........|.k.s.J.
+00000350: 6410 8301 8201 7c14 7c0f 1000 7c11 7c0f  d.....|.|...|.|.
+00000360: 6603 5300 2911 616e 0300 000a 2020 2020  f.S.).an....    
+00000370: 5379 6d70 6c65 6374 6963 2054 616b 6167  Symplectic Takag
+00000380: 6920 6661 6374 6f72 697a 6174 696f 6e20  i factorization 
+00000390: 284f 4c44 2052 4f55 5449 4e45 292e 0a20  (OLD ROUTINE).. 
+000003a0: 2020 200a 2020 2020 4c65 7420 4720 6265     .    Let G be
+000003b0: 2061 2073 796d 6d65 7472 6963 206d 6174   a symmetric mat
+000003c0: 7269 7820 7769 7468 2063 6f6d 706c 6578  rix with complex
+000003d0: 2065 6e74 7269 6573 2061 6e64 204a 2074   entries and J t
+000003e0: 6865 2063 616e 6f6e 6963 616c 2073 796d  he canonical sym
+000003f0: 706c 6563 7469 630a 2020 2020 7374 7275  plectic.    stru
+00000400: 6374 7572 652e 2041 7373 756d 6573 2074  cture. Assumes t
+00000410: 6861 7420 4740 4a20 6973 2064 6961 676f  hat G@J is diago
+00000420: 6e61 6c69 7a61 626c 652e 0a20 2020 200a  nalizable..    .
+00000430: 2020 2020 5468 656e 2074 6869 7320 726f      Then this ro
+00000440: 7574 696e 6520 7769 6c6c 2064 6574 6572  utine will deter
+00000450: 6d69 6e65 2061 2073 796d 706c 6563 7469  mine a symplecti
+00000460: 6320 6d61 7472 6978 2053 2073 6f20 7468  c matrix S so th
+00000470: 6174 2053 4044 4053 2e74 7261 6e73 706f  at S@D@S.transpo
+00000480: 7365 2829 203d 2047 2c20 7768 6572 650a  se() = G, where.
+00000490: 2020 2020 5320 7769 6c6c 2062 6520 636f      S will be co
+000004a0: 6d70 6c65 7820 696e 2067 656e 6572 616c  mplex in general
+000004b0: 2061 6e64 2044 2061 2064 6961 676f 6e61   and D a diagona
+000004c0: 6c20 6d61 7472 6978 2e0a 2020 2020 0a20  l matrix..    . 
+000004d0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+000004e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+000004f0: 2047 3a20 6d61 7472 6978 0a20 2020 2020   G: matrix.     
+00000500: 2020 2053 796d 6d65 7472 6963 206d 6174     Symmetric mat
+00000510: 7269 782e 0a20 2020 2020 2020 200a 2020  rix..        .  
+00000520: 2020 6432 625f 746f 6c3a 2066 6c6f 6174    d2b_tol: float
+00000530: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00000540: 2020 204f 7074 696f 6e61 6c20 746f 6c65     Optional tole
+00000550: 7261 6e63 6520 6769 7665 6e20 746f 2027  rance given to '
+00000560: 6469 6167 6f6e 616c 3262 6c6f 636b 2720  diagonal2block' 
+00000570: 726f 7574 696e 652e 0a20 2020 2020 2020  routine..       
+00000580: 200a 2020 2020 2a2a 6b77 6172 6773 3a20   .    **kwargs: 
+00000590: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+000005a0: 204f 7074 696f 6e61 6c20 6172 6775 6d65   Optional argume
+000005b0: 6e74 7320 7061 7373 6564 2074 6f20 2765  nts passed to 'e
+000005c0: 6967 656e 7370 6163 6573 2720 726f 7574  igenspaces' rout
+000005d0: 696e 652e 0a20 2020 2020 2020 200a 2020  ine..        .  
+000005e0: 2020 5265 7475 726e 730a 2020 2020 2d2d    Returns.    --
+000005f0: 2d2d 2d2d 2d0a 2020 2020 533a 206d 6174  -----.    S: mat
+00000600: 7269 780a 2020 2020 2020 2020 5379 6d70  rix.        Symp
+00000610: 6c65 6374 6963 206d 6174 7269 782e 0a20  lectic matrix.. 
+00000620: 2020 2020 2020 200a 2020 2020 443a 206d         .    D: m
+00000630: 6174 7269 780a 2020 2020 2020 2020 4469  atrix.        Di
+00000640: 6167 6f6e 616c 206d 6174 7269 782e 0a20  agonal matrix.. 
+00000650: 2020 2020 2020 200a 2020 2020 583a 206d         .    X: m
+00000660: 6174 7269 780a 2020 2020 2020 2020 4d61  atrix.        Ma
+00000670: 7472 6978 2077 6869 6368 2068 6173 2062  trix which has b
+00000680: 6565 6e20 666f 756e 6420 746f 2061 6e74  een found to ant
+00000690: 692d 6469 6167 6f6e 616c 697a 6520 4740  i-diagonalize G@
+000006a0: 4a20 736f 2074 6861 7420 585e 282d 3129  J so that X^(-1)
+000006b0: 4047 404a 4058 203d 2046 2069 7320 696e  @G@J@X = F is in
+000006c0: 2061 6e74 692d 6469 6167 6f6e 616c 2066   anti-diagonal f
+000006d0: 6f72 6d2e 0a20 2020 20e9 0200 0000 7201  orm..    .....r.
+000006e0: 0000 00fa 1744 696d 656e 7369 6f6e 206d  .....Dimension m
+000006f0: 7573 7420 6265 2065 7665 6e2e 6301 0000  ust be even.c...
+00000700: 0000 0000 0000 0000 0001 0000 0006 0000  ................
+00000710: 0013 0000 0073 2800 0000 6700 7c00 5d10  .....s(...g.|.].
+00000720: 8900 7400 8701 8700 6602 6400 6401 8408  ..t.....f.d.d...
+00000730: 7401 8802 8301 4400 8301 8301 9102 7102  t.....D.......q.
+00000740: 5300 2902 6301 0000 0000 0000 0000 0000  S.).c...........
+00000750: 0002 0000 0007 0000 0013 0000 0073 2800  .............s(.
+00000760: 0000 6700 7c00 5d10 7d01 7400 8800 7c01  ..g.|.].}.t...|.
+00000770: 8801 6602 1900 8800 8801 7c01 6602 1900  ..f.......|.f...
+00000780: 1800 8301 9102 7102 5300 a900 2901 da03  ......q.S...)...
+00000790: 6162 7329 02da 022e 30da 016a 2902 da01  abs)....0..j)...
+000007a0: 47da 016b 720e 0000 00fa 602f 686f 6d65  G..kr.....`/home
+000007b0: 2f6d 616c 7465 2f6d 696e 6963 6f6e 6461  /malte/miniconda
+000007c0: 332f 656e 7673 2f77 6f72 6b2f 6c69 622f  3/envs/work/lib/
+000007d0: 7079 7468 6f6e 332e 3130 2f73 6974 652d  python3.10/site-
+000007e0: 7061 636b 6167 6573 2f6c 6965 6f70 732f  packages/lieops/
+000007f0: 6c69 6e61 6c67 2f63 6f6e 6772 7565 6e63  linalg/congruenc
+00000800: 652f 7461 6b61 6769 2e70 79da 0a3c 6c69  e/takagi.py..<li
+00000810: 7374 636f 6d70 3e33 0000 00f3 0200 0000  stcomp>3........
+00000820: 2800 7a35 5f73 796d 706c 6563 7469 635f  (.z5_symplectic_
+00000830: 7461 6b61 6769 5f6f 6c64 2e3c 6c6f 6361  takagi_old.<loca
+00000840: 6c73 3e2e 3c6c 6973 7463 6f6d 703e 2e3c  ls>.<listcomp>.<
+00000850: 6c69 7374 636f 6d70 3e29 02da 036d 6178  listcomp>)...max
+00000860: da05 7261 6e67 6529 0172 1000 0000 a902  ..range).r......
+00000870: 7212 0000 00da 0464 696d 3229 0172 1300  r......dim2).r..
+00000880: 0000 7214 0000 0072 1500 0000 3300 0000  ..r....r....3...
+00000890: 7216 0000 007a 2a5f 7379 6d70 6c65 6374  r....z*_symplect
+000008a0: 6963 5f74 616b 6167 695f 6f6c 642e 3c6c  ic_takagi_old.<l
+000008b0: 6f63 616c 733e 2e3c 6c69 7374 636f 6d70  ocals>.<listcomp
+000008c0: 3eda 0374 6f6c 7a2d 496e 7075 7420 6d61  >..tolz-Input ma
+000008d0: 7472 6978 2064 6f65 7320 6e6f 7420 6170  trix does not ap
+000008e0: 7065 6172 2074 6f20 6265 2073 796d 6d65  pear to be symme
+000008f0: 7472 6963 2eda 066d 706d 6174 68da 0766  tric...mpmath..f
+00000900: 6c61 7474 656e 54da 056e 756d 7079 4e29  lattenT..numpyN)
+00000910: 02da 0463 6f64 6572 1b00 0000 a901 da05  ...coder........
+00000920: 6474 7970 65da 0563 6865 636b fa67 4974  dtype..check.gIt
+00000930: 2061 7070 6561 7273 2074 6861 7420 7468   appears that th
+00000940: 6520 726f 7574 696e 6520 746f 2063 6f6d  e routine to com
+00000950: 7075 7465 2074 6865 206d 6174 7269 7820  pute the matrix 
+00000960: 7371 7561 7265 2072 6f6f 7420 646f 6573  square root does
+00000970: 206e 6f74 2067 6976 6520 6120 2a70 6f6c   not give a *pol
+00000980: 796e 6f6d 6961 6c2a 2073 7175 6172 6520  ynomial* square 
+00000990: 726f 6f74 2e29 1772 0400 0000 da03 6c65  root.).r......le
+000009a0: 6e72 1700 0000 7218 0000 00da 0367 6574  nr....r......get
+000009b0: 7205 0000 00da 026d 70da 066d 6174 7269  r......mp..matri
+000009c0: 7872 0600 0000 da02 6e70 da05 6172 7261  xr......np..arra
+000009d0: 79da 0974 7261 6e73 706f 7365 da06 6c69  y..transpose..li
+000009e0: 6e61 6c67 da03 696e 76da 0769 6e76 6572  nalg..inv..inver
+000009f0: 7365 da03 706f 7072 0900 0000 da09 636f  se..popr......co
+00000a00: 6e6a 7567 6174 65da 0573 7172 746d da06  njugate..sqrtm..
+00000a10: 746f 6c69 7374 da0a 636f 6d70 6c65 7831  tolist..complex1
+00000a20: 3238 720f 0000 0072 1d00 0000 2915 7212  28r....r....).r.
+00000a30: 0000 00da 0764 3262 5f74 6f6c 7222 0000  .....d2b_tolr"..
+00000a40: 00da 066b 7761 7267 7372 1f00 0000 da03  ...kwargsr......
+00000a50: 6469 6dda 014a da02 474a 5a05 6576 616c  dim..J..GJZ.eval
+00000a60: 735a 0665 7665 6374 73da 0159 5a02 5969  sZ.evects..YZ.Yi
+00000a70: da01 5fda 0155 da02 5869 da01 58da 0146  .._..U..Xi..X..F
+00000a80: da01 445a 034a 6d70 5a04 5869 6d70 5a02  ..DZ.JmpZ.XimpZ.
+00000a90: 5959 720e 0000 0072 1900 0000 7214 0000  YYr....r....r...
+00000aa0: 00da 165f 7379 6d70 6c65 6374 6963 5f74  ..._symplectic_t
+00000ab0: 616b 6167 695f 6f6c 640e 0000 0073 3e00  akagi_old....s>.
+00000ac0: 0000 0820 0802 1401 0801 3001 0802 0801  ... ......0.....
+00000ad0: 0a01 0802 1803 0801 0e01 0c01 0801 0e01  ................
+00000ae0: 0a01 0c03 1601 1001 0801 0c01 0a01 0803  ................
+00000af0: 0a05 0a01 2c01 0801 1c01 0c04 3c01 0e02  ....,.......<...
+00000b00: 723f 0000 00e9 0300 0000 2901 da0a 6e5f  r?........)...n_
+00000b10: 6f75 745f 6172 6773 6301 0000 0000 0000  out_argsc.......
+00000b20: 0000 0000 0017 0000 0008 0000 004b 0000  .............K..
+00000b30: 0073 aa01 0000 7400 7c00 8301 7d02 7c02  .s....t.|...}.|.
+00000b40: 6401 1600 6402 6b02 730e 4a00 6403 8301  d...d.k.s.J.d...
+00000b50: 8201 7c02 6401 1a00 7d03 7401 7c03 8301  ..|.d...}.t.|...
+00000b60: 7d04 7402 7c00 7c04 1000 8301 7d05 7c05  }.t.|.|.....}.|.
+00000b70: a003 a100 5c02 7d06 7d07 7404 7c07 8e00  ....\.}.}.t.|...
+00000b80: 7d08 7405 a006 7c06 a101 a007 7405 6a08  }.t...|.....t.j.
+00000b90: a101 7d06 7405 a006 6404 6405 6702 6406  ..}.t...d.d.g.d.
+00000ba0: 6406 6702 6702 a101 7405 a009 6401 a101  d.g.g...t...d...
+00000bb0: 1b00 7d09 7405 a00a 6401 6401 6702 a101  ..}.t...d.d.g...
+00000bc0: 7d0a 7405 a00b 6401 a101 7d0b 6700 7d0c  }.t...d...}.g.}.
+00000bd0: 6402 7d0d 7c07 4400 5d15 7d0e 7c0e 6a0c  d.}.|.D.].}.|.j.
+00000be0: 6402 1900 6401 6b02 7266 7c0c a00d 7c0d  d...d.k.rf|...|.
+00000bf0: a101 0100 7c0c a00d 7c0d 6406 1700 a101  ....|...|.d.....
+00000c00: 0100 7151 7405 a006 7c08 a00e a100 a101  ..qQt...|.......
+00000c10: a007 7405 6a08 a101 6402 1900 7d0f 740f  ..t.j...d...}.t.
+00000c20: 7c0f 6407 7c0c 7c01 a010 6408 6700 a102  |.d.|.|...d.g...
+00000c30: 6409 8d04 7d10 7411 7c03 8301 7d11 7c10  d...}.t.|...}.|.
+00000c40: 7c11 1000 7d12 7c06 7c12 1000 7d13 7405  |...}.|.|...}.t.
+00000c50: 6a12 a013 7c13 a101 7d14 7414 7c04 0b00  j...|...}.t.|...
+00000c60: 7c13 a015 a100 1000 7c04 1000 7c13 1000  |.......|...|...
+00000c70: 8301 7d15 7c01 a010 640a 640b a102 72c7  ..}.|...d.d...r.
+00000c80: 7416 7405 a017 7405 6a06 7c04 0b00 7c15  t.t...t.j.|...|.
+00000c90: a015 a100 1000 7c04 1000 7c15 1800 7405  ......|...|...t.
+00000ca0: 6a08 640c 8d02 a018 a100 a101 8301 7c01  j.d...........|.
+00000cb0: a010 640d 640e a102 6b00 73c7 4a00 640f  ..d.d...k.s.J.d.
+00000cc0: 8301 8201 7c15 7c14 1000 7d16 7c16 7c16  ....|.|...}.|.|.
+00000cd0: 7c00 1000 7c16 a015 a100 1000 6602 5300  |...|.......f.S.
+00000ce0: 2910 610d 0200 000a 2020 2020 5379 6d70  ).a.....    Symp
+00000cf0: 6c65 6374 6963 2054 616b 6167 6920 6661  lectic Takagi fa
+00000d00: 6374 6f72 697a 6174 696f 6e2e 0a20 2020  ctorization..   
+00000d10: 200a 2020 2020 4c65 7420 4720 6265 2061   .    Let G be a
+00000d20: 2073 796d 6d65 7472 6963 206d 6174 7269   symmetric matri
+00000d30: 7820 7769 7468 2063 6f6d 706c 6578 2065  x with complex e
+00000d40: 6e74 7269 6573 2061 6e64 204a 2074 6865  ntries and J the
+00000d50: 2063 616e 6f6e 6963 616c 2073 796d 706c   canonical sympl
+00000d60: 6563 7469 630a 2020 2020 7374 7275 6374  ectic.    struct
+00000d70: 7572 652e 2041 7373 756d 6573 2074 6861  ure. Assumes tha
+00000d80: 7420 4740 4a40 4740 4a20 6973 2064 6961  t G@J@G@J is dia
+00000d90: 676f 6e61 6c69 7a61 626c 652e 0a20 2020  gonalizable..   
+00000da0: 200a 2020 2020 5468 656e 2074 6869 7320   .    Then this 
+00000db0: 726f 7574 696e 6520 7769 6c6c 2064 6574  routine will det
+00000dc0: 6572 6d69 6e65 2061 2073 796d 706c 6563  ermine a symplec
+00000dd0: 7469 6320 6d61 7472 6978 2053 2073 6f20  tic matrix S so 
+00000de0: 7468 6174 2053 4047 4053 2e74 7261 6e73  that S@G@S.trans
+00000df0: 706f 7365 2829 2069 7320 6469 6167 6f6e  pose() is diagon
+00000e00: 616c 2e0a 2020 2020 0a20 2020 2050 6172  al..    .    Par
+00000e10: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00000e20: 2d2d 2d2d 2d2d 0a20 2020 2047 3a20 6d61  ------.    G: ma
+00000e30: 7472 6978 0a20 2020 2020 2020 2053 796d  trix.        Sym
+00000e40: 6d65 7472 6963 206d 6174 7269 782e 0a0a  metric matrix...
+00000e50: 2020 2020 2a2a 6b77 6172 6773 3a20 6f70      **kwargs: op
+00000e60: 7469 6f6e 616c 0a20 2020 2020 2020 204f  tional.        O
+00000e70: 7074 696f 6e61 6c20 6172 6775 6d65 6e74  ptional argument
+00000e80: 7320 7061 7373 6564 2074 6f20 2764 6961  s passed to 'dia
+00000e90: 676f 6e61 6c32 626c 6f63 6b27 2072 6f75  gonal2block' rou
+00000ea0: 7469 6e65 2e0a 2020 2020 2020 2020 0a20  tine..        . 
+00000eb0: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
+00000ec0: 2d2d 2d2d 2d2d 0a20 2020 2053 3a20 6d61  ------.    S: ma
+00000ed0: 7472 6978 0a20 2020 2020 2020 2053 796d  trix.        Sym
+00000ee0: 706c 6563 7469 6320 6d61 7472 6978 2e0a  plectic matrix..
+00000ef0: 2020 2020 720c 0000 0072 0100 0000 720d      r....r....r.
+00000f00: 0000 0079 0000 0000 0000 0000 0000 0000  ...y............
+00000f10: 0000 f03f 7900 0000 0000 0000 8000 0000  ...?y...........
+00000f20: 0000 00f0 bfe9 0100 0000 721e 0000 00da  ..........r.....
+00000f30: 0b6f 7269 656e 7461 7469 6f6e 2903 721f  .orientation).r.
+00000f40: 0000 00da 0473 6b69 7072 4300 0000 7222  .....skiprC...r"
+00000f50: 0000 0054 7220 0000 0072 3300 0000 720b  ...Tr ...r3...r.
+00000f60: 0000 0072 2300 0000 2919 7224 0000 0072  ...r#...).r$...r
+00000f70: 0500 0000 da0c 7379 6d70 795f 6d61 7472  ......sympy_matr
+00000f80: 6978 da0c 6a6f 7264 616e 5f63 656c 6c73  ix..jordan_cells
+00000f90: da0a 7379 6d70 795f 6469 6167 7228 0000  ..sympy_diagr(..
+00000fa0: 0072 2900 0000 da06 6173 7479 7065 7232  .r).....astyper2
+00000fb0: 0000 00da 0473 7172 74da 057a 6572 6f73  .....sqrt..zeros
+00000fc0: da03 6579 65da 0573 6861 7065 da06 6170  ..eye..shape..ap
+00000fd0: 7065 6e64 da08 6469 6167 6f6e 616c 7209  pend..diagonalr.
+00000fe0: 0000 0072 2500 0000 720a 0000 0072 2b00  ...r%...r....r+.
+00000ff0: 0000 722c 0000 0072 0700 0000 722a 0000  ..r,...r....r*..
+00001000: 0072 1700 0000 720f 0000 0072 1d00 0000  .r....r....r....
+00001010: 2917 7212 0000 0072 3400 0000 721a 0000  ).r....r4...r...
+00001020: 0072 3500 0000 7236 0000 005a 0347 4a73  .r5...r6...Z.GJs
+00001030: da01 50da 0563 656c 6c73 da03 4a4e 46da  ..P..cells..JNF.
+00001040: 0255 325a 057a 6572 6f32 5a04 6f6e 6532  .U2Z.zero2Z.one2
+00001050: 7244 0000 0072 1300 0000 da01 635a 0f64  rD...r......cZ.d
+00001060: 6961 676f 6e61 6c5f 6f66 5f4a 4e46 723a  iagonal_of_JNFr:
+00001070: 0000 00da 0154 da02 5554 723c 0000 0072  .....T..UTr<...r
+00001080: 3b00 0000 7238 0000 00da 0153 720e 0000  ;...r8.....Sr...
+00001090: 0072 0e00 0000 7214 0000 00da 125f 7379  .r....r......_sy
+000010a0: 6d70 6c65 6374 6963 5f74 616b 6167 6961  mplectic_takagia
+000010b0: 0000 0073 3a00 0000 0817 1401 0801 0803  ...s:...........
+000010c0: 0c01 0c01 0801 1201 2002 0e01 0a01 0403  ........ .......
+000010d0: 0401 0801 0e01 0a01 0e01 0280 1a01 1801  ................
+000010e0: 0805 0801 0801 0c01 1a03 0c01 4401 0801  ............D...
+000010f0: 1401 7257 0000 0072 0c00 0000 2902 720b  ..rW...r....).r.
+00001100: 0000 0054 2918 721e 0000 0072 2800 0000  ...T).r....r(...
+00001110: 721c 0000 0072 2600 0000 da05 7379 6d70  r....r&.....symp
+00001120: 7972 0200 0000 7245 0000 0072 0300 0000  yr....rE...r....
+00001130: 7247 0000 00da 0e6e 6a65 742e 6675 6e63  rG.....njet.func
+00001140: 7469 6f6e 7372 0400 0000 da14 6c69 656f  tionsr......lieo
+00001150: 7073 2e6c 696e 616c 672e 6d61 7472 6978  ps.linalg.matrix
+00001160: 7205 0000 00da 146c 6965 6f70 732e 6c69  r......lieops.li
+00001170: 6e61 6c67 2e63 6f6d 6d6f 6e72 0600 0000  nalg.commonr....
+00001180: 7207 0000 0072 0800 0000 5a1f 6c69 656f  r....r....Z.lieo
+00001190: 7073 2e6c 696e 616c 672e 7369 6d69 6c61  ps.linalg.simila
+000011a0: 7269 7479 2e63 6f6d 6d6f 6e72 0900 0000  rity.commonr....
+000011b0: 720a 0000 0072 3f00 0000 da15 7379 6d70  r....r?.....symp
+000011c0: 6c65 6374 6963 5f74 616b 6167 695f 6f6c  lectic_takagi_ol
+000011d0: 6472 5700 0000 da11 7379 6d70 6c65 6374  drW.....symplect
+000011e0: 6963 5f74 616b 6167 6972 0e00 0000 720e  ic_takagir....r.
+000011f0: 0000 0072 0e00 0000 7214 0000 00da 083c  ...r....r......<
+00001200: 6d6f 6475 6c65 3e01 0000 0073 1a00 0000  module>....s....
+00001210: 0800 0801 0c02 0c01 0c02 0c02 1401 0c01  ................
+00001220: 0c01 0a02 0c51 0802 103f                 .....Q...?
```

### Comparing `lieops-0.2.1/lieops/linalg/congruence/__pycache__/williamson.cpython-310.pyc` & `lieops-0.2.2/lieops/linalg/congruence/__pycache__/williamson.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/congruence/__pycache__/youla.cpython-310.pyc` & `lieops-0.2.2/lieops/linalg/congruence/__pycache__/youla.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/congruence/common.py` & `lieops-0.2.2/lieops/linalg/congruence/common.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/congruence/symmetric.py` & `lieops-0.2.2/lieops/linalg/congruence/symmetric.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/congruence/takagi.py` & `lieops-0.2.2/lieops/linalg/congruence/takagi.py`

 * *Files 7% similar despite different names*

```diff
@@ -3,19 +3,19 @@
 
 from sympy import Matrix as sympy_matrix
 from sympy import diag as sympy_diag
 
 from njet.functions import get_package_name
 
 from lieops.linalg.matrix import create_J
-from lieops.linalg.common import eigenspaces, get_principal_sqrt
+from lieops.linalg.common import eigenspaces, get_principal_sqrt, ndsupport
 from lieops.linalg.similarity.common import diagonal2block
 from lieops.linalg.matrix import expandingSum
 
-def symplectic_takagi_old(G, d2b_tol=1e-10, check=True, **kwargs):
+def _symplectic_takagi_old(G, d2b_tol=1e-10, check=True, **kwargs):
     '''
     Symplectic Takagi factorization (OLD ROUTINE).
     
     Let G be a symmetric matrix with complex entries and J the canonical symplectic
     structure. Assumes that G@J is diagonalizable.
     
     Then this routine will determine a symplectic matrix S so that S@D@S.transpose() = G, where
@@ -88,15 +88,17 @@
     # It must hold: -J@YY.transpose()@J = Y. If this is not the case, then YY is not a polynomial square root of the above matrix.
     # (see Thm. 5.5 my notes, or Horner: Topics in Matrix Analysis, S-polar decomposition. Throw me a message if you need details)
     if kwargs.get('check', True):
         assert max(np.abs(np.array(-J@YY.transpose()@J - YY, dtype=np.complex128).flatten())) < d2b_tol, 'It appears that the routine to compute the matrix square root does not give a *polynomial* square root.'
         
     return YY@X, D, X
 
-def symplectic_takagi(G, **kwargs):
+symplectic_takagi_old = ndsupport(_symplectic_takagi_old, n_out_args=3)
+
+def _symplectic_takagi(G, **kwargs):
     '''
     Symplectic Takagi factorization.
     
     Let G be a symmetric matrix with complex entries and J the canonical symplectic
     structure. Assumes that G@J@G@J is diagonalizable.
     
     Then this routine will determine a symplectic matrix S so that S@G@S.transpose() is diagonal.
@@ -151,7 +153,8 @@
     # Now construct the symplectic diagonalizing matrix Y@Xi: 
     Y = get_principal_sqrt(-J@X.transpose()@J@X)
     if kwargs.get('check', True):
         assert max(np.abs(np.array(-J@Y.transpose()@J - Y, dtype=np.complex128).flatten())) < kwargs.get('d2b_tol', 1e-10), 'It appears that the routine to compute the matrix square root does not give a *polynomial* square root.'
     S = Y@Xi
     return S, S@G@S.transpose()
 
+symplectic_takagi = ndsupport(_symplectic_takagi, n_out_args=2)
```

### Comparing `lieops-0.2.1/lieops/linalg/congruence/williamson.py` & `lieops-0.2.2/lieops/linalg/congruence/.ipynb_checkpoints/williamson-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/congruence/youla.py` & `lieops-0.2.2/lieops/linalg/congruence/youla.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/matrix.py` & `lieops-0.2.2/lieops/linalg/matrix.py`

 * *Files 27% similar despite different names*

```diff
@@ -1,43 +1,56 @@
 # This file collects routines which are focused on fundamental generation of specific
 # matrices and to perform basic matrix operations.
-
 import numpy as np
 import mpmath as mp
 
+from njet.common import check_zero
+from njet.functions import get_package_name
+
 def printmat(M, tol=1e-14):
     # print a matrix (for e.g. debugging reasons)
     M = mp.matrix(M)
     mp.nprint(mp.chop(M, tol))
 
-def create_J(dim: int):
+def create_J(dim: int, shape=None):
     r'''
     Create a 2*dim-square matrix J, corresponding to the standard 
     symplectic block-matrix
     
              /  0   1  \
         J =  |         |
              \ -1   0  /
              
     Parameters
     ----------
     dim: int
         Dimension/2 of the matrix to be constructed.
         
+    shape: tuple, optional
+        If given, assume that the 0's and 1's in the above matrix
+        have a given shape. Return a multi-dimensional numpy array accordingly.
+        
     Returns
     -------
     list
         List of column vectors.
     '''
     dim2 = 2*dim
     J1, J2 = [], []
+    if shape is None:
+        zeros = 0
+        ones = 1
+    else:
+        zeros = np.zeros(shape, dtype=np.complex128)
+        ones = np.ones(shape, dtype=np.complex128)
+        
     for k in range(dim):
-        J1.append([0 if i != k + dim else -1 for i in range(dim2)])
-        J2.append([0 if i != k else 1 for i in range(dim2)])
-    return np.array(J1 + J2).transpose()
+        J1.append([zeros if i != k + dim else ones for i in range(dim2)])
+        J2.append([zeros if i != k else -ones for i in range(dim2)])        
+    return np.array(J1 + J2)
 
 def expandingSum(pairs):
     '''Compute a transformation matrix T, to transform a given
     (2n)x(2n) matrix M, represented in (q1, p1, q2, p2, ..., qn, pn)-coordinates, into
     a (q1, q2, ..., qn, p1, p2, ..., pn)-representation via
     M' = T^(-1)@M@T. T will be orthogonal (and unitary), i.e. T^(-1) = T.transpose().
     
@@ -112,35 +125,53 @@
     '''
     assert symmetry in [-1, 0, 1]
 
     dict_shape = max(M.keys(), default=(0, 0))
     n_rows = kwargs.get('n_rows', dict_shape[0] + 1)
     n_cols = kwargs.get('n_cols', dict_shape[1] + 1)
     
+    # determine shape of entries in case of multi-dimensional input
+    key0 = next(iter(M))
+    val0 = M[key0]
+    if hasattr(val0, 'shape'):
+        zero = np.zeros(val0.shape)
+    else:
+        zero = 0
+    
     # create a column-matrix
     if symmetry == 0:
         mat = [[0]*n_rows for k in range(n_cols)]
         for i in range(n_rows):
             for j in range(n_cols):
-                mat[j][i] = M.get((i, j), 0)
+                mat[i][j] = M.get((i, j), zero)
     else:
         dim = max([n_rows, n_cols])
         mat = [[0]*dim for k in range(dim)]
         for i in range(dim):
             for j in range(i + 1):
-                hij = M.get((i, j), 0)
-                hji = M.get((j, i), 0)
-                if hij != 0 and hji != 0:
-                    assert hij == symmetry*hji
-                if hij == 0 and hji != 0:
+                hij = M.get((i, j), zero)
+                hji = M.get((j, i), zero)
+                
+                hij_c0 = check_zero(hij)
+                hji_c0 = check_zero(hji)
+                
+                if not hij_c0 and not hji_c0 and symmetry != 0:
+                    check = hij == symmetry*hji
+                    try:
+                        assert check
+                    except:
+                        assert check.all()
+
+                if hij_c0 and not hji_c0:
                     hij = symmetry*hji
+                    
                 # (hij != 0 and hji == 0) or (hij == 0 and hji == 0). 
-                mat[j][i] = hij
-                mat[i][j] = symmetry*hij
-    return np.array(mat).transpose()
+                mat[i][j] = hij
+                mat[j][i] = symmetry*hij
+    return np.array(mat)
     
 def vecmat(mat):
     '''
     Map a given NxN-matrix to a vector, by concatenating its rows.
     '''
     return np.concatenate([mat[k, :] for k in range(mat.shape[0])])
 
@@ -191,7 +222,108 @@
         U1.append([0 if i != k and i != k2 else 1/sqrt2 for i in range(dim)])
         U2.append([0 if i != k and i != k2 else 1j/sqrt2 if i == k else -1j/sqrt2 if i == k2 else 0 for i in range(dim)])
         
     out = np.array(U1 + U2).transpose()
     if code == 'mpmath':
         out = mp.matrix(out)
     return out
+
+
+class emat:
+    '''
+    emat: extended matrix
+    
+    Class to maintain the same behavior as the ordinary mpmath or numpy arrays
+    concerning matrix multiplication, but when it comes to matrix multiplication
+    and transposition, only modify the first two axes.
+    '''
+    def __init__(self, matrix, code=None):
+        self.__array_priority__ = 1000 # prevent numpy __mul__ and force self.__rmul__ instead if multiplication from left with a numpy object
+        
+        if code is None:
+            self.code = get_package_name(matrix)
+        else:
+            self.code = code
+        self.matrix = matrix
+        if hasattr(matrix, 'shape'):
+            self.shape = self.matrix.shape
+    
+    def __add__(self, other):
+        assert self.code == other.code
+        return self.__class__(self.matrix + other.matrix, code=self.code)
+    
+    def __radd__(self, other):
+        return self + other
+    
+    def __neg__(self):
+        return self.__class__(-self.matrix, code=self.code)
+    
+    def __sub__(self, other):
+        return self + -other
+    
+    def __rsub__(self, other):
+        return other - self
+    
+    def __mul__(self, other):
+        return self.__class__(self.matrix*other, code=self.code)
+    
+    def __rmul__(self, other):
+        return self*other
+    
+    def __matmul__(self, other):
+        if self.code == 'numpy':
+            if get_package_name(other) == 'numpy':
+                B = other
+            elif hasattr(other, 'matrix'):
+                # assume other is of class emat
+                B = other.matrix
+            else:
+                raise NotImplementedError(f'Matrix multiplication between {self.__class__} and {other.__class__} not implemented.')
+                
+            A = self.matrix
+            shape1 = A.shape
+            shape2 = B.shape
+            assert shape1[1] == shape2[0]
+            if len(shape1[2:]) == 0 and len(shape2[2:]) == 0:
+                # both are ordinary matrices
+                AB = A@B
+            elif len(shape1[2:]) > 0 and len(shape2[2:]) == 0:
+                # B is an ordinary matrix
+                AB1 = np.tensordot(A, B, axes=(1, 0)) # axes not in proper order yet
+                # the last axes of AB1 corresponds to the second axis of the ordinary matrix B, so it needs to be moved to the 2nd position of the result
+                for k in range(len(shape2[1:])):
+                    AB2 = np.moveaxis(AB1, -1, 0)
+                    AB1 = np.swapaxes(AB2, 0, 1)
+                AB = AB1
+            elif len(shape1[2:]) == 0 and len(shape2[2:]) > 0:
+                # A is an ordinary matrix
+                AB = np.tensordot(A, B, axes=(1, 0))
+            else:
+                assert shape1[2:] == shape2[2:]
+                # component-wise multiplication of the remaining terms
+                AB_shape = [shape1[0]] + [shape2[1]] + list(shape1[2:])
+                AB = np.empty(AB_shape, dtype=np.complex128)
+                for i in range(shape2[1]):
+                    AB[i, ...] = sum([A[i, k, ...]*B[k, ...] for k in range(shape1[1])])
+
+            return self.__class__(AB, code=self.code)
+        else:
+            if not hasattr(other, 'matrix'): # other might be a numpy or mpmath array
+                return self.__class__(self.matrix@other, code=self.code)
+            else:
+                return self.__class__(self.matrix@other.matrix, code=self.code)
+            
+        def __rmatmul__(self, other):
+            return self.__class__(other, code=self.code)@self
+        
+    def transpose(self):
+        if self.code == 'numpy':
+            return self.__class__(np.swapaxes(self.matrix, 0, 1), code=self.code)
+        else:
+            return self.__class__(self.matrix.transpose(), code=self.code)
+        
+    def conjugate(self):
+        return self.__class__(self.matrix.conjugate(), code=self.code)
+    
+    def __len__(self):
+        return len(self.matrix)
+
```

### Comparing `lieops-0.2.1/lieops/linalg/misc.py` & `lieops-0.2.2/lieops/linalg/misc.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/nf.py` & `lieops-0.2.2/lieops/linalg/nf.py`

 * *Files 5% similar despite different names*

```diff
@@ -8,20 +8,26 @@
 
 from .checks import is_positive_definite
 from .matrix import create_J, matrix_from_dict, create_pq2xieta
 
 from lieops.linalg.congruence.takagi import symplectic_takagi, symplectic_takagi_old
 from lieops.linalg.congruence.williamson import unitary_williamson, williamson
 from lieops.linalg.similarity.symplectic import thm31
+from lieops.linalg.common import ndsupport
+from lieops.linalg.matrix import emat
 
 from njet.ad import getNargs
 from njet.functions import get_package_name
-from njet import derive    
+from njet import derive
 
-def symlogs(X, **kwargs):
+@ndsupport
+def logm_nd(X, **kwargs):
+    return logm(X, **kwargs)
+
+def _symlogs(X, **kwargs):
     r'''
     Let X be a complex symplectic matrix, i.e. a matrix satisfying
     X.transpose()@J@X = J.
     
     Then this routine will determine two matrices A and B so that
     X = exp(A)@exp(B),
     where A is an element in sp(n), the Lie-algebra of Sp(n) = Sp(2n; C) \cap U(2n),
@@ -48,15 +54,17 @@
     V = thm31(U, **kwargs) # V@U@V.transpose().conj() = D will be diagonal
     Vi = V.transpose().conj()
     D = V@U@Vi
     logD = logm(D) # logD.transpose()@J + J@logD = 0
     Y = Vi@logD@V
     return Y, logP
 
-def normal_form(H2, T=[], mode='default', check: bool=False, **kwargs):
+symlogs = ndsupport(_symlogs, n_out_args=2)
+
+def normal_form(H2, T=None, mode='default', check: bool=False, **kwargs):
     r'''
     Perform linear calculations to transform a given second-order Hamiltonian,
     expressed in canonical coordinates (q, p), to
     complex normal form coordinates xi, eta. Along the way, the symplectic linear map to
     real normal form is computed. The quantities xi and eta are defined as in my thesis,
     Chapter 1.
     
@@ -123,61 +131,71 @@
                  determines this behavior can be controlled with the tol_logm parameter. So if that parameter
                  is set to zero, there will always be returned two elements.
                  *Currently only returned for numpy input*
     ''' 
     dim = len(H2)
     assert dim%2 == 0, 'Dimension must be even.'
     code = get_package_name(H2)
+    H2 = emat(H2) 
         
-    if len(T) != 0: # transform H2 to default block ordering before entering williamson routine; the results will later be transformed back. This is easier instead of keeping track of orders inside the subroutines.
+    if T is not None: # transform H2 to default block ordering before entering williamson routine; the results will later be transformed back. This is easier instead of keeping track of orders inside the subroutines.
+        T = emat(T)
         T_ctr = T.transpose()
         H2 = T@H2@T_ctr
 
     J = create_J(dim//2)
     if code == 'mpmath':
         J = mp.matrix(J)
+    J = emat(J)
     
     if check:
         # consistency check: H2@J must be diagonalizable in order that the normal form can be computed.
         # Since computing the Jordan normal form is numerically unstable, we use sympy for this.
         # Note that this will only work for dim = 1 or dim = 2.
-        J_symp = sympy_matrix(J)
-        G_symp = sympy_matrix(H2)
+        J_symp = sympy_matrix(J.matrix)
+        G_symp = sympy_matrix(H2.matrix)
         P_symp, JNF = (G_symp@J_symp).jordan_form()
         if not JNF.is_diagonal():
             raise RuntimeError(f'Jordan normal form of H2@J not diagonal:\nH2:\n{H2}\nJNF:\n{JNF}')
-            
+
     # Perform symplectic diagonalization
     if mode == 'new':
         # will become the default in future; TODO: some tests are failing
-        S, X = symplectic_takagi(H2, **kwargs)
+        S, X = symplectic_takagi(H2.matrix, **kwargs)
+        S, X = emat(S), emat(X)
         S = S.transpose()
         Sinv = -J@S.transpose()@J
-                
+
         D = Sinv.transpose()@H2@Sinv
         U = create_pq2xieta(dim=dim, code=code, **kwargs)
+        U = emat(U)
     elif mode == 'default':
         # will become OLD code. Using symplectic takagi assuming GJ is diagonalizable. This older version
         # works with eigenspaces and eigenvalues routine.
         # TODO: S may change the sign of the Hesse-matrix. Need to figure out the issue. 
-        S, D, _ = symplectic_takagi_old(H2, check=check, **kwargs)
+        S, D, _ = symplectic_takagi_old(H2.matrix, check=check, **kwargs)
+        S, D = emat(S), emat(D)
         S = S.transpose()
         Sinv = -J@S.transpose()@J
         U = create_pq2xieta(dim=dim, code=code, **kwargs)
+        U = emat(U)
     elif mode == 'classic':
         # OLD code, using Williamson or "unitary" Williamson.
-        if is_positive_definite(H2):
-            S, D = williamson(V=H2, **kwargs)
+        if is_positive_definite(H2.matrix):
+            S, D = williamson(V=H2.matrix, **kwargs)
+            S, D = emat(S), emat(D)
 
             U = create_pq2xieta(dim=dim, code=code, **kwargs)
+            U = emat(U)
             Sinv = -J@S.transpose()@J
         else:
             assert code == 'numpy' # TODO: mpmath support
             # apply new general routine in case H2 is not positive definite
-            Sinv, D, U = unitary_williamson(M=H2, **kwargs) # U.conjugate()@Sinv.transpose()@H2@Sinv@U.conjugate().transpose() will be in (xi, eta)-canonical form.
+            Sinv, D, U = unitary_williamson(M=H2.matrix, **kwargs) # U.conjugate()@Sinv.transpose()@H2@Sinv@U.conjugate().transpose() will be in (xi, eta)-canonical form.
+            Sinv, D, U = emat(Sinv), emat(D), emat(U)
             S = -J@Sinv.transpose()@J
     else:
         raise RuntimeError(f"Mode '{mode}' not recognized.")
     # The first dim columns of S denote (new) canonical positions u, the last dim columns of S
     # denote (new) canonical momenta v: S(q, p) = (u, v)
         
     # U is hermitian, therefore
@@ -187,56 +205,61 @@
     J2 = U@J@U.transpose() # the new symplectic structure (see my notes).
     #J2 = Uinv.transpose().conjugate()@J@Uinv # the new symplectic structure with respect to the (xi, eta)-coordinates (holds also in the case len(T) != 0)
     #   = U@J@U.transpose().conjuage() = [U@J@U.transpose()].conjugate()
     
     K = U@S # K(q, p) = (xi, eta)
     Kinv = Sinv@Uinv  # this map will transform to the new (xi, eta)-coordinates via Kinv.transpose()*H2*Kinv
 
-    if len(T) != 0: # transform results back to the requested (q, p)-ordering
+    if T is not None: # transform results back to the requested (q, p)-ordering
         S = T_ctr@S@T
         Sinv = T_ctr@Sinv@T
         J = T_ctr@J@T
         H2 = T_ctr@H2@T
         K = K@T
         Kinv = T_ctr@Kinv
     
     # assemble output
     out = {}
-    out['S'] = S 
-    out['Sinv'] = Sinv # this symplectic map will diagonalize H2 in its original 
+    out['S'] = S.matrix
+    out['Sinv'] = Sinv.matrix # this symplectic map will diagonalize H2 in its original 
     # (q, p)-coordinates via Sinv.transpose()*H2*Sinv. Sinv (and S) are symplectic wrt. J
-    out['H2'] = H2 # the input matrix
-    out['rnf'] = Sinv.transpose()@H2@Sinv # the diagonal matrix obtained as a result of the symplectic diagonalization of H2
-    out['T'] = T
-    out['J'] = J # the original symplectic structure
-    out['J2'] = J2 # the new symplectic structure
-    out['U'] = U # the unitary map from the S(p, q)=(u, v)-block coordinates to the (xi, eta)-coordinates
-    out['Uinv'] = Uinv
-    out['K'] = K # K(q, p) = (xi, eta)
-    out['Kinv'] = Kinv
-    out['cnf'] = Kinv.transpose()@H2@Kinv # the representation of H2 in (xi, eta)-coordinates
-    out['D'] = D
+    out['H2'] = H2.matrix # the input matrix
+    out['rnf'] = (Sinv.transpose()@H2@Sinv).matrix # the diagonal matrix obtained as a result of the symplectic diagonalization of H2
+    if T is not None:
+        out['T'] = T.matrix
+    else:
+        out['T'] = []
+    out['J'] = J.matrix # the original symplectic structure
+    out['J2'] = J2.matrix # the new symplectic structure
+    out['U'] = U.matrix # the unitary map from the S(p, q)=(u, v)-block coordinates to the (xi, eta)-coordinates
+    out['Uinv'] = Uinv.matrix
+    out['K'] = K.matrix # K(q, p) = (xi, eta)
+    out['Kinv'] = Kinv.matrix
+    out['cnf'] = (Kinv.transpose()@H2@Kinv).matrix # the representation of H2 in (xi, eta)-coordinates
+    out['D'] = D.matrix
     
     # Furthermore, compute the map A transforming the Hamiltonian (given in (xi, eta)-coordinates), 
     # whose Hessian corresponds to H2 above, into its first-order normal form.
     # For details see my notes (On_Sp2n.pdf)
     if code != 'mpmath':
-        out['A'] = U@Sinv@Uinv
+        out['A'] = (U@Sinv@Uinv).matrix
         tol_logm = kwargs.get('tol_logm', 1e-14)
         try:
-            B1 = logm(Sinv) # exist always, since Sinv is invertible
+            B1 = logm_nd(Sinv.matrix) # exist always, since Sinv is invertible
             # But: B1 must be in the Lie-algebra sp(2n; C). This is not always guaranteed, so we have to check it here:
+            B1 = emat(B1)
             zero = J@B1.transpose() + B1@J
-            assert (all([abs(zero[i, j]) < tol_logm for i in range(dim) for j in range(dim)]))
+            assert all([(abs(zero.matrix[i, j]) < tol_logm).all() for i in range(dim) for j in range(dim)])
         except:
             # Sinv can only be represented by two exponentials
-            B1, B2 = symlogs(Sinv, tol2=kwargs.get('symlogs_tol2', 0))
+            B1, B2 = symlogs(Sinv.matrix, tol2=kwargs.get('symlogs_tol2', 0))
             warnings.warn(f'Matrix appears to require two exponentials for representation (tol_logm: {tol_logm})')
-            out['C2'] = U@B2@Uinv
-        out['C1'] = U@B1@Uinv
+            B1, B2 = emat(B1), emat(B2)
+            out['C2'] = (U@B2@Uinv).matrix
+        out['C1'] = (U@B1@Uinv).matrix
         # so that A = exp(C1)@exp(C2)
         # Note that due to the nature of the matrix U, the Cj's are elements of sp(2n; C), so they admit a polynomial representation.
     return out
 
 def first_order_nf_expansion(H, power: int=2, z=[], check: bool=False, n_args: int=0, tol: float=1e-14,
                              code='numpy', **kwargs):
     '''
@@ -275,57 +298,57 @@
         A dictionary of the Taylor coefficients of the Hamiltonian in normal form around z = (q, p), where the first n
         entries denote powers of xi, while the last n entries denote powers of eta.
         
     dict
         The output of lieops.linalg.nf.normal_form routine, providing the linear map information at the requested point.
     '''
     assert power >= 2
-    dim = n_args
+    dim2 = n_args
     if n_args == 0:
-        dim = getNargs(H)
-    assert dim%2 == 0, 'Dimension must be even; try passing n_args argument.'
+        dim2 = getNargs(H)
+    assert dim2%2 == 0, 'Dimension must be even; try passing n_args argument.'
     
     # Step 1 (optional): Construct H locally around z (N.B. shifts are symplectic, as they drop out from derivatives.)
     # This step is required, because later on (at point (+)) we want to extract the Taylor coefficients, and
     # this works numerically only if we consider a function around zero.
     if len(z) > 0:
-        assert len(z) == dim, f'Dimension ({len(z)}) of custom point mismatch (expected: {dim})'
+        assert len(z) == dim2, f'Dimension ({len(z)}) of custom point mismatch (expected: {dim2})'
         Hshift = lambda *x: H(*[x[k] + z[k] for k in range(len(z))])
     else:
         Hshift = H
-        z = dim*[0]
+        z = dim2*[0]
     
     # Step 2: Obtain the Hesse-matrix of H.
     # N.B. we need to work with the Hesse-matrix here (and *not* with the Taylor-coefficients), because we want to get
     # a (linear) map K so that the Hesse-matrix of H o K is in CNF (complex normal form). This is guaranteed
     # if the Hesse-matrix of H is transformed to CNF.
     # Note that the Taylor-coefficients of H in 2nd-order are 1/2*Hesse_matrix. This means that at (++) (see below),
     # no factor of two is required.
-    dHshift = derive(Hshift, order=2, n_args=dim)
-    z0 = dim*[0]
+    dHshift = derive(Hshift, order=2, n_args=dim2)
+    z0 = dim2*[0]
     Hesse_dict = dHshift.hess(*z0)
-    Hesse_matrix = matrix_from_dict(Hesse_dict, symmetry=1, n_rows=dim, n_cols=dim)
+    Hesse_matrix = matrix_from_dict(Hesse_dict, symmetry=1, n_rows=dim2, n_cols=dim2)
     if code == 'mpmath':
         Hesse_matrix = mp.matrix(Hesse_matrix)
         
     # Optional: Raise a warning in case the shifted Hamiltonian has first-order terms.
     if check:
         gradient = dHshift.grad() # the gradient of H is evaluated at z0 (note that H has been shifted to z0 above, so that z0 corresponds to the original point z).
-        grad_vector = [gradient.get((k,), 0) for k in range(dim)]
+        grad_vector = [gradient.get((k,), 0) for k in range(dim2)]
         if any([abs(c) > tol for c in grad_vector]) > 0:
             warnings.warn(f'Input appears to have a non-zero gradient around the requested point\n{z}\nfor given tolerance {tol}:\n{grad_vector}')
 
     # Step 3: Compute the linear map to first-order complex normal form near z.
-    nfdict = normal_form(Hesse_matrix, tol=tol, check=check, **kwargs)
+    nfdict = normal_form(Hesse_matrix, check=check, **kwargs)
     Kinv = nfdict['Kinv'] # Kinv.transpose()@Hesse_matrix@Kinv is in cnf; K(q, p) = (xi, eta)
     
     # Step 4: Obtain the expansion of the Hamiltonian up to the requested power.
     Kmap = lambda *zz: [sum([zz[k]*Kinv[j, k] for k in range(len(zz))]) for j in range(len(zz))] # TODO: implement column matrix class. Attention: Kinv[j, k] must stand on right-hand side, otherwise zz[k] may be inserted into a NumPy array!
     HK = lambda *zz: Hshift(*Kmap(*zz))
-    dHK = derive(HK, order=power, n_args=dim)
+    dHK = derive(HK, order=power, n_args=dim2)
     results = dHK(*z0, mult_drv=False) # mult_drv=False ensures that we obtain the Taylor-coefficients of the new Hamiltonian. (+)
         
     if check:
         # Check if the 2nd order Taylor coefficients of the derived shifted Hamiltonian agree in complex
         # normal form with the values predicted by linear theory.
         HK_hesse_dict = dHK.hess(tc=results)
         HK_hesse_dict = {k: v for k, v in HK_hesse_dict.items() if abs(v) > tol}
```

### Comparing `lieops-0.2.1/lieops/linalg/similarity/.ipynb_checkpoints/common-checkpoint.py` & `lieops-0.2.2/lieops/linalg/similarity/.ipynb_checkpoints/common-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/similarity/.ipynb_checkpoints/simultaneous-checkpoint.py` & `lieops-0.2.2/lieops/linalg/similarity/.ipynb_checkpoints/simultaneous-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/similarity/.ipynb_checkpoints/symplectic-checkpoint.py` & `lieops-0.2.2/lieops/linalg/similarity/.ipynb_checkpoints/symplectic-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/similarity/__pycache__/common.cpython-310.pyc` & `lieops-0.2.2/lieops/linalg/similarity/__pycache__/common.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/similarity/__pycache__/simultaneous.cpython-310.pyc` & `lieops-0.2.2/lieops/linalg/similarity/__pycache__/simultaneous.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/similarity/common.py` & `lieops-0.2.2/lieops/linalg/similarity/common.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/similarity/simultaneous.py` & `lieops-0.2.2/lieops/linalg/similarity/simultaneous.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/linalg/similarity/symplectic.py` & `lieops-0.2.2/lieops/linalg/similarity/symplectic.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/solver/.ipynb_checkpoints/bruteforce-checkpoint.py` & `lieops-0.2.2/lieops/solver/.ipynb_checkpoints/bruteforce-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/solver/.ipynb_checkpoints/channell-checkpoint.py` & `lieops-0.2.2/lieops/solver/.ipynb_checkpoints/channell-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/solver/.ipynb_checkpoints/common-checkpoint.py` & `lieops-0.2.2/lieops/solver/.ipynb_checkpoints/common-checkpoint.py`

 * *Files 4% similar despite different names*

```diff
@@ -22,49 +22,50 @@
     def eqs(*z):
         zinp = list(z) + [e.conjugate() for e in z]
         dH = dhamiltonian.grad(*zinp)
         dxi = [dH.get((k,), 0) for k in range(hamiltonian.dim, 2*hamiltonian.dim)]
         return dxi
     return eqs
 
-def getRealHamiltonFunction(hamiltonian, real=False, tol=0, **kwargs):
+def getRealHamiltonFunction(hamiltonian, real=False, tol_drop=0):
     '''
     Create a Hamilton function H(q, p), for a given Hamiltonian H(xi, eta).
     
     Parameters
     ----------
     hamiltonian: ops.poly
         A poly object, representing a Hamiltonian in its default complex (xi, eta)-coordinates.
     
     real: boolean, optional
         This flag is intended to be used on Hamiltonians whose real form is expected to not
         contain imaginary parts.
         
-    tol: float, optional
-        Only in effect if len(nf) == 0. If > 0, then drop Hamiltonian coefficients below this threshold.
-        
-    **kwargs
-        Optional keyword arguments passed to hamiltonian.realBasis routine.
-        
+    tol_drop: float, optional
+        Drop coefficients below this threshold.
+                
     Returns
     -------
     callable
         A function taking values in 2*hamiltonian.dim input parameters and returns a complex (or real) value.
         It will represent the Hamiltonian with respect to its real (q, p)-coordinates.
     '''
     dim = hamiltonian.dim
-    rbh = hamiltonian.realBasis(**kwargs)
+    rbh = hamiltonian.realBasis()
     if real:
         # In this case we remove the imaginary parts from rbh outright.
         # This becomes necessary if we want to apply the heyoka solver, which complains if
         # one attempts to multiply a complex value with one of its variables
         rbh = {k: v.real for k, v in rbh.items()}
 
-    if tol > 0:
-        rbh = {k: v for k, v in rbh.items() if abs(v) >= tol}
+    if tol_drop > 0:
+        try:
+            rbh = {k: v for k, v in rbh.items() if abs(v) >= tol_drop}
+        except:
+            # Values might be multi-dimensional numpy arrays
+            rbh = {k: v for k, v in rbh.items() if (abs(v) >= tol_drop).all()}
 
     # By construction, the realBasis of a Hamiltonian is given in terms of powers of q and p:
     def ham(*qp):
         result = 0
         for k, v in rbh.items():
             power = 1
             for l in range(dim):
@@ -88,17 +89,21 @@
         Optional keyword arguments passed to getRealHamiltonFunction routine.
         
     Returns
     -------
     callable
         A function taking values in real (q, p)-variables, representing the right-hand side of the
         Hamilton-equations \dot z = J \nabla H(z).
+        
+    callable
+        The given Hamiltonian in (real) (q, p)-variables.
     '''
     realHam = getRealHamiltonFunction(hamiltonian, **kwargs)
     dim = hamiltonian.dim
     dhamiltonian = derive(realHam, order=1, n_args=2*dim)    
     def eqs(*qp):
         dH = dhamiltonian.grad(*qp)
         # we have to use qp[0]*0 to broadcast zero in the data type of qp[0]
-        dqp = [dH.get((k + dim,), qp[0]*0) for k in range(dim)] + [-dH.get((k,), qp[0]*0) for k in range(dim)]
+        zero = qp[0]*0
+        dqp = [dH.get((k + dim,), zero) for k in range(dim)] + [-dH.get((k,), zero) for k in range(dim)]
         return dqp
     return eqs, realHam
```

### Comparing `lieops-0.2.1/lieops/solver/.ipynb_checkpoints/flow2by2-checkpoint.py` & `lieops-0.2.2/lieops/solver/.ipynb_checkpoints/flow2by2-checkpoint.py`

 * *Files 27% similar despite different names*

```diff
@@ -1,14 +1,24 @@
 import numpy as np
 from scipy.linalg import expm
 import warnings
 
 from lieops.core.tools import poly3ad, ad3poly, vec3poly, poly3vec
+from lieops.linalg.common import ndsupport
+from lieops.linalg.matrix import emat
+
 import lieops.core.lie
 
+np_eig_nd = ndsupport(np.linalg.eig, n_out_args=2)
+np_inv_nd = ndsupport(np.linalg.inv)
+
+_checkf = ndsupport(lambda x: abs(np.linalg.det(x)))
+expm_nd = ndsupport(expm)
+_diagexp = ndsupport(lambda d: np.diag(np.exp(d)), n_inp_axes=1)
+
 def get_2flow(ham, tol=1e-12):
     '''
     Compute the exact flow of a Hamiltonian, modeled by a polynomial of first or second-order.
     I.e. compute the solution of
         dz/dt = {H, z}, z(0) = p,
     where { , } denotes the poisson bracket, H the requested Hamiltonian.
     Hereby H and p must be polynomials of order <= 2.
@@ -30,26 +40,27 @@
         return flow
     
     assert ham.maxdeg() <= 2, 'Hamiltonian of degree <= 2 required.'
     poisson_factor = ham._poisson_factor
     
     Hmat = poly3ad(ham) # Hmat: (2n + 1)x(2n + 1)-matrix
     
-    # Alternative:
-    evals, M = np.linalg.eig(Hmat)
-    check = abs(np.linalg.det(M)) < tol
+    evals, M = np_eig_nd(Hmat) # Compute the eigenvalues and eigenvectors of Hmat
+    check = (_checkf(M) < tol).any()
     if check:
         # in this case we have to rely on a different method to calculate the matrix exponential.
         # for the time being we shall use scipy's expm routine.
-        expH = expm(Hmat)
+        expH = emat(expm_nd(Hmat))
     else:
-        Mi = np.linalg.inv(M) # so that M@np.diag(evals)@Mi = Hmat holds.
+        #Mi = np.linalg.inv(M) so that M@np.diag(evals)@Mi = Hmat holds.
+        Mi = np_inv_nd(M)
         # compute the exponential exp(t*Hmat) = exp(M@(t*D)@Mi) = M@exp(t*D)@Mi:
-        expH = M@np.diag(np.exp(evals))@Mi
-    
+        M, Mi = emat(M), emat(Mi)
+        expH = M@emat(_diagexp(evals))@Mi
+
     def flow(p, t=1, **kwargs):
         '''
         Compute the solution z so that
         dz/dt = {H, z}, z(0) = p,
         where { , } denotes the poisson bracket, H the requested Hamiltonian.
         
         The solution thus corresponds to
@@ -67,33 +78,42 @@
             warnings.warn('lieops.core.lie.poly input expected')
             return p
         
         assert poisson_factor == p._poisson_factor, 'Hamiltonian and given polynomial are instantiated with respect to different poisson structures.'
         
         if t != 1:
             if check:
-                expH_t = expm(Hmat*t)
+                expH_t = emat(expm_nd(Hmat*t))
             else:
-                expH_t = M@np.diag(np.exp(evals*t))@Mi  
+                expH_t = M@emat(_diagexp(evals*t))@Mi
         else:
             expH_t = expH
-            
+                        
         maxdeg = p.maxdeg()
         p0 = p.homogeneous_part(0) # the constants will be reproduced in the end (by the '1' in the flow)
         result = p0
+        
         if maxdeg > 0:
             p1 = p.homogeneous_part(1)
-            Y = poly3vec(p1)
+            Y = emat(poly3vec(p1))
             Z = expH_t@Y
-            result += vec3poly(Z)
-        if maxdeg > 1:
+            result += vec3poly(Z.matrix) # Z (and Y) are modeled here by 'emat' objects (extended matrices). This object also works for vectors, which is the case here.
+            
+        if maxdeg > 1: # compute the flow using the Pull-back property of exp(:f:)
             p_rest = p.extract(key_cond=lambda x: sum(x) > 1)
-            # compute the flow using the Pull-back property of exp(:f:)
             dim = p.dim
             dim2 = dim*2
-            xieta = lieops.core.lie.create_coords(dim=dim)
-            unit_vectors = np.concatenate([np.eye(dim2), np.zeros([1, dim2])], axis=0)
-            Z = expH_t@unit_vectors
-            xietaf = [vec3poly(zz) for zz in Z.transpose()]
+            
+            # Create unit vectors where each has attached one zero in the end (for the dim2 + 1 scenario).
+            shape = expH_t.shape[2:]
+            zeros = np.zeros(shape, dtype=np.complex128)
+            ones = np.ones(shape, dtype=np.complex128)
+            E = np.array([[zeros if i != k else ones for i in range(dim2)] for k in range(dim2 + 1)])
+            
+            # Apply the matrix representation to the unit vectors
+            Z = (expH_t@E).transpose()
+            xietaf = [vec3poly(Z.matrix[j]) for j in range(len(Z))]
             result += p_rest(*xietaf)
+            
         return result
+    
     return flow
```

### Comparing `lieops-0.2.1/lieops/solver/.ipynb_checkpoints/heyoka-checkpoint.py` & `lieops-0.2.2/lieops/solver/.ipynb_checkpoints/heyoka-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/solver/.ipynb_checkpoints/splitting-checkpoint.py` & `lieops-0.2.2/lieops/solver/.ipynb_checkpoints/splitting-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/solver/.ipynb_checkpoints/tao-checkpoint.py` & `lieops-0.2.2/lieops/solver/.ipynb_checkpoints/tao-checkpoint.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/solver/__pycache__/bruteforce.cpython-310.pyc` & `lieops-0.2.2/lieops/solver/__pycache__/bruteforce.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/solver/__pycache__/channell.cpython-310.pyc` & `lieops-0.2.2/lieops/solver/__pycache__/channell.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/solver/__pycache__/common.cpython-310.pyc` & `lieops-0.2.2/lieops/solver/__pycache__/common.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.10, timestamp-based, .py timestamp: Tue Dec 13 15:19:37 2022 UTC, .py size: 3782 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 9% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-00000000: 6f0d 0d0a 0000 0000 0998 9863 c60e 0000  o..........c....
+00000000: 6f0d 0d0a 0000 0000 1f51 3e64 e20e 0000  o........Q>d....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0003 0000 0040 0000 0073 3200 0000 6400  .....@...s2...d.
 00000030: 6401 6c00 6d01 5a01 0100 6400 6402 6c02  d.l.m.Z...d.d.l.
 00000040: 5a03 6403 6404 8400 5a04 640a 6406 6407  Z.d.d...Z.d.d.d.
 00000050: 8401 5a05 6408 6409 8400 5a06 6402 5300  ..Z.d.d...Z.d.S.
 00000060: 290b e900 0000 00a9 01da 0664 6572 6976  )..........deriv
 00000070: 654e 6301 0000 0000 0000 0000 0000 0002  eNc.............
@@ -41,236 +41,234 @@
 00000280: 8408 7402 8802 6a03 6404 8802 6a03 1400  ..t...j.d...j...
 00000290: 8302 4400 8301 7d02 7c02 5300 2905 4e63  ..D...}.|.S.).Nc
 000002a0: 0100 0000 0000 0000 0000 0000 0200 0000  ................
 000002b0: 0400 0000 5300 0000 7314 0000 0067 007c  ....S...s....g.|
 000002c0: 005d 067d 017c 01a0 00a1 0091 0271 0253  .].}.|.......q.S
 000002d0: 00a9 0029 01da 0963 6f6e 6a75 6761 7465  ...)...conjugate
 000002e0: 2902 da02 2e30 da01 6572 0600 0000 7206  )....0..er....r.
-000002f0: 0000 00fa 552f 686f 6d65 2f6d 616c 7465  ....U/home/malte
-00000300: 2f6d 696e 6963 6f6e 6461 332f 656e 7673  /miniconda3/envs
-00000310: 2f77 6f72 6b2f 6c69 622f 7079 7468 6f6e  /work/lib/python
-00000320: 332e 3130 2f73 6974 652d 7061 636b 6167  3.10/site-packag
-00000330: 6573 2f6c 6965 6f70 732f 736f 6c76 6572  es/lieops/solver
-00000340: 2f63 6f6d 6d6f 6e2e 7079 da0a 3c6c 6973  /common.py..<lis
-00000350: 7463 6f6d 703e 1700 0000 7302 0000 0014  tcomp>....s.....
-00000360: 007a 3363 6f6d 706c 6578 4861 6d69 6c74  .z3complexHamilt
-00000370: 6f6e 4571 732e 3c6c 6f63 616c 733e 2e65  onEqs.<locals>.e
-00000380: 7173 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973  qs.<locals>.<lis
-00000390: 7463 6f6d 703e 6301 0000 0000 0000 0000  tcomp>c.........
-000003a0: 0000 0002 0000 0006 0000 0013 0000 0073  ...............s
-000003b0: 1a00 0000 6700 7c00 5d09 7d01 8800 a000  ....g.|.].}.....
-000003c0: 7c01 6601 6400 a102 9102 7102 5300 2901  |.f.d.....q.S.).
-000003d0: 7201 0000 00a9 01da 0367 6574 a902 7208  r........get..r.
-000003e0: 0000 00da 016b a901 da02 6448 7206 0000  .....k....dHr...
-000003f0: 0072 0a00 0000 720b 0000 0019 0000 0073  .r....r........s
-00000400: 0200 0000 1a00 e902 0000 0029 04da 046c  ...........)...l
-00000410: 6973 74da 0467 7261 64da 0572 616e 6765  ist..grad..range
-00000420: da03 6469 6d29 03da 017a 5a04 7a69 6e70  ..dim)...zZ.zinp
-00000430: da03 6478 69a9 02da 0c64 6861 6d69 6c74  ..dxi....dhamilt
-00000440: 6f6e 6961 6eda 0b68 616d 696c 746f 6e69  onian..hamiltoni
-00000450: 616e 7210 0000 0072 0a00 0000 da03 6571  anr....r......eq
-00000460: 7316 0000 0073 0800 0000 1601 0a01 2001  s....s........ .
-00000470: 0401 7a1f 636f 6d70 6c65 7848 616d 696c  ..z.complexHamil
-00000480: 746f 6e45 7173 2e3c 6c6f 6361 6c73 3e2e  tonEqs.<locals>.
-00000490: 6571 7372 0200 0000 2902 721b 0000 0072  eqsr....).r....r
-000004a0: 1c00 0000 7206 0000 0072 1900 0000 720a  ....r....r....r.
-000004b0: 0000 00da 1263 6f6d 706c 6578 4861 6d69  .....complexHami
-000004c0: 6c74 6f6e 4571 7304 0000 0073 0600 0000  ltonEqs....s....
-000004d0: 100f 0e03 0405 721d 0000 0046 6303 0000  ......r....Fc...
-000004e0: 0000 0000 0000 0000 0005 0000 0004 0000  ................
-000004f0: 000b 0000 0073 5c00 0000 7c00 6a00 8900  .....s\...|.j...
-00000500: 7c00 6a01 6408 6900 7c03 a401 8e01 8901  |.j.d.i.|.......
-00000510: 7c01 7216 6401 6402 8400 8801 a002 a100  |.r.d.d.........
-00000520: 4400 8301 8901 8802 6403 6b04 7225 8702  D.......d.k.r%..
-00000530: 6601 6404 6402 8408 8801 a002 a100 4400  f.d.d.........D.
-00000540: 8301 8901 8700 8701 6602 6405 6406 8408  ........f.d.d...
-00000550: 7d04 7c04 5300 2909 616c 0300 000a 2020  }.|.S.).al....  
-00000560: 2020 4372 6561 7465 2061 2048 616d 696c    Create a Hamil
-00000570: 746f 6e20 6675 6e63 7469 6f6e 2048 2871  ton function H(q
-00000580: 2c20 7029 2c20 666f 7220 6120 6769 7665  , p), for a give
-00000590: 6e20 4861 6d69 6c74 6f6e 6961 6e20 4828  n Hamiltonian H(
-000005a0: 7869 2c20 6574 6129 2e0a 2020 2020 0a20  xi, eta)..    . 
-000005b0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-000005c0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-000005d0: 2068 616d 696c 746f 6e69 616e 3a20 6f70   hamiltonian: op
-000005e0: 732e 706f 6c79 0a20 2020 2020 2020 2041  s.poly.        A
-000005f0: 2070 6f6c 7920 6f62 6a65 6374 2c20 7265   poly object, re
-00000600: 7072 6573 656e 7469 6e67 2061 2048 616d  presenting a Ham
-00000610: 696c 746f 6e69 616e 2069 6e20 6974 7320  iltonian in its 
-00000620: 6465 6661 756c 7420 636f 6d70 6c65 7820  default complex 
-00000630: 2878 692c 2065 7461 292d 636f 6f72 6469  (xi, eta)-coordi
-00000640: 6e61 7465 732e 0a20 2020 200a 2020 2020  nates..    .    
-00000650: 7265 616c 3a20 626f 6f6c 6561 6e2c 206f  real: boolean, o
-00000660: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-00000670: 5468 6973 2066 6c61 6720 6973 2069 6e74  This flag is int
-00000680: 656e 6465 6420 746f 2062 6520 7573 6564  ended to be used
-00000690: 206f 6e20 4861 6d69 6c74 6f6e 6961 6e73   on Hamiltonians
-000006a0: 2077 686f 7365 2072 6561 6c20 666f 726d   whose real form
-000006b0: 2069 7320 6578 7065 6374 6564 2074 6f20   is expected to 
-000006c0: 6e6f 740a 2020 2020 2020 2020 636f 6e74  not.        cont
-000006d0: 6169 6e20 696d 6167 696e 6172 7920 7061  ain imaginary pa
-000006e0: 7274 732e 0a20 2020 2020 2020 200a 2020  rts..        .  
-000006f0: 2020 746f 6c3a 2066 6c6f 6174 2c20 6f70    tol: float, op
-00000700: 7469 6f6e 616c 0a20 2020 2020 2020 204f  tional.        O
-00000710: 6e6c 7920 696e 2065 6666 6563 7420 6966  nly in effect if
-00000720: 206c 656e 286e 6629 203d 3d20 302e 2049   len(nf) == 0. I
-00000730: 6620 3e20 302c 2074 6865 6e20 6472 6f70  f > 0, then drop
-00000740: 2048 616d 696c 746f 6e69 616e 2063 6f65   Hamiltonian coe
-00000750: 6666 6963 6965 6e74 7320 6265 6c6f 7720  fficients below 
-00000760: 7468 6973 2074 6872 6573 686f 6c64 2e0a  this threshold..
-00000770: 2020 2020 2020 2020 0a20 2020 202a 2a6b          .    **k
-00000780: 7761 7267 730a 2020 2020 2020 2020 4f70  wargs.        Op
-00000790: 7469 6f6e 616c 206b 6579 776f 7264 2061  tional keyword a
-000007a0: 7267 756d 656e 7473 2070 6173 7365 6420  rguments passed 
-000007b0: 746f 2068 616d 696c 746f 6e69 616e 2e72  to hamiltonian.r
-000007c0: 6561 6c42 6173 6973 2072 6f75 7469 6e65  ealBasis routine
-000007d0: 2e0a 2020 2020 2020 2020 0a20 2020 2052  ..        .    R
-000007e0: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-000007f0: 2d2d 0a20 2020 2063 616c 6c61 626c 650a  --.    callable.
-00000800: 2020 2020 2020 2020 4120 6675 6e63 7469          A functi
-00000810: 6f6e 2074 616b 696e 6720 7661 6c75 6573  on taking values
-00000820: 2069 6e20 322a 6861 6d69 6c74 6f6e 6961   in 2*hamiltonia
-00000830: 6e2e 6469 6d20 696e 7075 7420 7061 7261  n.dim input para
-00000840: 6d65 7465 7273 2061 6e64 2072 6574 7572  meters and retur
-00000850: 6e73 2061 2063 6f6d 706c 6578 2028 6f72  ns a complex (or
-00000860: 2072 6561 6c29 2076 616c 7565 2e0a 2020   real) value..  
-00000870: 2020 2020 2020 4974 2077 696c 6c20 7265        It will re
-00000880: 7072 6573 656e 7420 7468 6520 4861 6d69  present the Hami
-00000890: 6c74 6f6e 6961 6e20 7769 7468 2072 6573  ltonian with res
-000008a0: 7065 6374 2074 6f20 6974 7320 7265 616c  pect to its real
-000008b0: 2028 712c 2070 292d 636f 6f72 6469 6e61   (q, p)-coordina
-000008c0: 7465 732e 0a20 2020 2063 0100 0000 0000  tes..    c......
-000008d0: 0000 0000 0000 0300 0000 0400 0000 5300  ..............S.
-000008e0: 0000 7318 0000 0069 007c 005d 085c 027d  ..s....i.|.].\.}
-000008f0: 017d 027c 017c 026a 0093 0271 0253 0072  .}.|.|.j...q.S.r
-00000900: 0600 0000 2901 da04 7265 616c a903 7208  ....)...real..r.
-00000910: 0000 0072 0f00 0000 da01 7672 0600 0000  ...r......vr....
-00000920: 7206 0000 0072 0a00 0000 da0a 3c64 6963  r....r......<dic
-00000930: 7463 6f6d 703e 3c00 0000 7302 0000 0018  tcomp><...s.....
-00000940: 007a 2b67 6574 5265 616c 4861 6d69 6c74  .z+getRealHamilt
-00000950: 6f6e 4675 6e63 7469 6f6e 2e3c 6c6f 6361  onFunction.<loca
-00000960: 6c73 3e2e 3c64 6963 7463 6f6d 703e 7201  ls>.<dictcomp>r.
-00000970: 0000 0063 0100 0000 0000 0000 0000 0000  ...c............
-00000980: 0300 0000 0400 0000 1300 0000 7322 0000  ............s"..
-00000990: 0069 007c 005d 0d5c 027d 017d 0274 007c  .i.|.].\.}.}.t.|
-000009a0: 0283 0188 006b 0572 027c 017c 0293 0271  .....k.r.|.|...q
-000009b0: 0253 0072 0600 0000 2901 da03 6162 7372  .S.r....)...absr
-000009c0: 1f00 0000 2901 da03 746f 6c72 0600 0000  ....)...tolr....
-000009d0: 720a 0000 0072 2100 0000 3f00 0000 7302  r....r!...?...s.
-000009e0: 0000 0022 0063 0000 0000 0000 0000 0000  ...".c..........
-000009f0: 0000 0600 0000 0800 0000 1700 0000 7364  ..............sd
-00000a00: 0000 0064 017d 0188 01a0 00a1 0044 005d  ...d.}.......D.]
-00000a10: 295c 027d 027d 0364 027d 0474 0188 0083  )\.}.}.d.}.t....
-00000a20: 0144 005d 187d 057c 047c 007c 0519 007c  .D.].}.|.|.|...|
-00000a30: 027c 0519 0013 007c 007c 0588 0017 0019  .|.....|.|......
-00000a40: 007c 027c 0588 0017 0019 0013 0014 0039  .|.|...........9
-00000a50: 007d 0471 107c 017c 047c 0314 0037 007d  .}.q.|.|.|...7.}
-00000a60: 0171 067c 0153 0029 034e 7201 0000 0072  .q.|.S.).Nr....r
-00000a70: 0400 0000 2902 da05 6974 656d 7372 1500  ....)...itemsr..
-00000a80: 0000 2906 da02 7170 da06 7265 7375 6c74  ..)...qp..result
-00000a90: 720f 0000 0072 2000 0000 da05 706f 7765  r....r .....powe
-00000aa0: 72da 016c 2902 7216 0000 00da 0372 6268  r..l).r......rbh
-00000ab0: 7206 0000 0072 0a00 0000 da03 6861 6d42  r....r......hamB
-00000ac0: 0000 0073 0e00 0000 0401 1001 0401 0c01  ...s............
-00000ad0: 2e01 0e01 0401 7a24 6765 7452 6561 6c48  ......z$getRealH
-00000ae0: 616d 696c 746f 6e46 756e 6374 696f 6e2e  amiltonFunction.
-00000af0: 3c6c 6f63 616c 733e 2e68 616d 4e72 0600  <locals>.hamNr..
-00000b00: 0000 2903 7216 0000 00da 0972 6561 6c42  ..).r......realB
-00000b10: 6173 6973 7224 0000 0029 0572 1b00 0000  asisr$...).r....
-00000b20: 721e 0000 0072 2300 0000 da06 6b77 6172  r....r#.....kwar
-00000b30: 6773 722a 0000 0072 0600 0000 2903 7216  gsr*...r....).r.
-00000b40: 0000 0072 2900 0000 7223 0000 0072 0a00  ...r)...r#...r..
-00000b50: 0000 da17 6765 7452 6561 6c48 616d 696c  ....getRealHamil
-00000b60: 746f 6e46 756e 6374 696f 6e1d 0000 0073  tonFunction....s
-00000b70: 1000 0000 0619 1001 0401 1204 0802 1601  ................
-00000b80: 0e03 0409 722d 0000 0063 0100 0000 0000  ....r-...c......
-00000b90: 0000 0000 0000 0400 0000 0500 0000 0b00  ................
-00000ba0: 0000 733e 0000 0074 007c 0066 0169 007c  ..s>...t.|.f.i.|
-00000bb0: 01a4 018e 017d 027c 006a 0189 0174 027c  .....}.|.j...t.|
-00000bc0: 0264 0164 0288 0114 0064 038d 0389 0087  .d.d.....d......
-00000bd0: 0087 0166 0264 0464 0584 087d 037c 037c  ...f.d.d...}.|.|
-00000be0: 0266 0253 0029 0661 8a02 0000 0a20 2020  .f.S.).a.....   
-00000bf0: 204f 6274 6169 6e20 7468 6520 7265 616c   Obtain the real
-00000c00: 2d76 616c 7565 6420 4861 6d69 6c74 6f6e  -valued Hamilton
-00000c10: 2d65 7175 6174 696f 6e73 2066 6f72 2061  -equations for a
-00000c20: 2067 6976 656e 206f 7073 2e70 6f6c 7920   given ops.poly 
-00000c30: 636c 6173 732e 0a20 2020 200a 2020 2020  class..    .    
-00000c40: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-00000c50: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6861  ---------.    ha
-00000c60: 6d69 6c74 6f6e 6961 6e3a 206f 7073 2e70  miltonian: ops.p
-00000c70: 6f6c 790a 2020 2020 2020 2020 4120 6f70  oly.        A op
-00000c80: 732e 706f 6c79 206f 626a 6563 742c 2072  s.poly object, r
-00000c90: 6570 7265 7365 6e74 696e 6720 7468 6520  epresenting the 
-00000ca0: 706f 6c79 6e6f 6d69 616c 2065 7870 616e  polynomial expan
-00000cb0: 7369 6f6e 206f 6620 6120 4861 6d69 6c74  sion of a Hamilt
-00000cc0: 6f6e 6961 6e20 696e 2069 7473 2028 6465  onian in its (de
-00000cd0: 6661 756c 7429 0a20 2020 2020 2020 2063  fault).        c
-00000ce0: 6f6d 706c 6578 2028 7869 2c20 6574 6129  omplex (xi, eta)
-00000cf0: 2d63 6f6f 7264 696e 6174 6573 2e0a 2020  -coordinates..  
-00000d00: 2020 0a20 2020 202a 2a6b 7761 7267 730a    .    **kwargs.
-00000d10: 2020 2020 2020 2020 4f70 7469 6f6e 616c          Optional
-00000d20: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
-00000d30: 7473 2070 6173 7365 6420 746f 2067 6574  ts passed to get
-00000d40: 5265 616c 4861 6d69 6c74 6f6e 4675 6e63  RealHamiltonFunc
-00000d50: 7469 6f6e 2072 6f75 7469 6e65 2e0a 2020  tion routine..  
-00000d60: 2020 2020 2020 0a20 2020 2052 6574 7572        .    Retur
-00000d70: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
-00000d80: 2020 2063 616c 6c61 626c 650a 2020 2020     callable.    
-00000d90: 2020 2020 4120 6675 6e63 7469 6f6e 2074      A function t
-00000da0: 616b 696e 6720 7661 6c75 6573 2069 6e20  aking values in 
-00000db0: 7265 616c 2028 712c 2070 292d 7661 7269  real (q, p)-vari
-00000dc0: 6162 6c65 732c 2072 6570 7265 7365 6e74  ables, represent
-00000dd0: 696e 6720 7468 6520 7269 6768 742d 6861  ing the right-ha
-00000de0: 6e64 2073 6964 6520 6f66 2074 6865 0a20  nd side of the. 
-00000df0: 2020 2020 2020 2048 616d 696c 746f 6e2d         Hamilton-
-00000e00: 6571 7561 7469 6f6e 7320 5c64 6f74 207a  equations \dot z
-00000e10: 203d 204a 205c 6e61 626c 6120 4828 7a29   = J \nabla H(z)
-00000e20: 2e0a 2020 2020 2020 2020 0a20 2020 2063  ..        .    c
-00000e30: 616c 6c61 626c 650a 2020 2020 2020 2020  allable.        
-00000e40: 5468 6520 6769 7665 6e20 4861 6d69 6c74  The given Hamilt
-00000e50: 6f6e 6961 6e20 696e 2028 7265 616c 2920  onian in (real) 
-00000e60: 2871 2c20 7029 2d76 6172 6961 626c 6573  (q, p)-variables
-00000e70: 2e0a 2020 2020 7204 0000 0072 1200 0000  ..    r....r....
-00000e80: 2902 7205 0000 00da 066e 5f61 7267 7363  ).r......n_argsc
-00000e90: 0000 0000 0000 0000 0000 0000 0200 0000  ................
-00000ea0: 0400 0000 1700 0000 734c 0000 0088 026a  ........sL.....j
-00000eb0: 007c 008e 0089 007c 0064 0119 0064 0114  .|.....|.d...d..
-00000ec0: 0089 0187 0087 0387 0166 0364 0264 0384  .........f.d.d..
-00000ed0: 0874 0188 0383 0144 0083 0187 0087 0166  .t.....D.......f
-00000ee0: 0264 0464 0384 0874 0188 0383 0144 0083  .d.d...t.....D..
-00000ef0: 0117 007d 017c 0153 0029 054e 7201 0000  ...}.|.S.).Nr...
-00000f00: 0063 0100 0000 0000 0000 0000 0000 0200  .c..............
-00000f10: 0000 0600 0000 1300 0000 731e 0000 0067  ..........s....g
-00000f20: 007c 005d 0b7d 0188 00a0 007c 0188 0117  .|.].}.....|....
-00000f30: 0066 0188 02a1 0291 0271 0253 0072 0600  .f.......q.S.r..
-00000f40: 0000 720c 0000 0072 0e00 0000 2903 7211  ..r....r....).r.
-00000f50: 0000 0072 1600 0000 da04 7a65 726f 7206  ...r......zeror.
-00000f60: 0000 0072 0a00 0000 720b 0000 006a 0000  ...r....r....j..
-00000f70: 0073 0200 0000 1e00 7a30 7265 616c 4861  .s......z0realHa
-00000f80: 6d69 6c74 6f6e 4571 732e 3c6c 6f63 616c  miltonEqs.<local
-00000f90: 733e 2e65 7173 2e3c 6c6f 6361 6c73 3e2e  s>.eqs.<locals>.
-00000fa0: 3c6c 6973 7463 6f6d 703e 6301 0000 0000  <listcomp>c.....
-00000fb0: 0000 0000 0000 0002 0000 0006 0000 0013  ................
-00000fc0: 0000 0073 1c00 0000 6700 7c00 5d0a 7d01  ...s....g.|.].}.
-00000fd0: 8800 a000 7c01 6601 8801 a102 0b00 9102  ....|.f.........
-00000fe0: 7102 5300 7206 0000 0072 0c00 0000 720e  q.S.r....r....r.
-00000ff0: 0000 00a9 0272 1100 0000 722f 0000 0072  .....r....r/...r
-00001000: 0600 0000 720a 0000 0072 0b00 0000 6a00  ....r....r....j.
-00001010: 0000 7302 0000 001c 0029 0272 1400 0000  ..s......).r....
-00001020: 7215 0000 0029 0272 2500 0000 5a03 6471  r....).r%...Z.dq
-00001030: 70a9 0272 1a00 0000 7216 0000 0072 3000  p..r....r....r0.
-00001040: 0000 720a 0000 0072 1c00 0000 6600 0000  ..r....r....f...
-00001050: 7308 0000 000a 010c 0232 0104 017a 1c72  s........2...z.r
-00001060: 6561 6c48 616d 696c 746f 6e45 7173 2e3c  ealHamiltonEqs.<
-00001070: 6c6f 6361 6c73 3e2e 6571 7329 0372 2d00  locals>.eqs).r-.
-00001080: 0000 7216 0000 0072 0300 0000 2904 721b  ..r....r....).r.
-00001090: 0000 0072 2c00 0000 5a07 7265 616c 4861  ...r,...Z.realHa
-000010a0: 6d72 1c00 0000 7206 0000 0072 3100 0000  mr....r....r1...
-000010b0: 720a 0000 00da 0f72 6561 6c48 616d 696c  r......realHamil
-000010c0: 746f 6e45 7173 4d00 0000 730a 0000 0010  tonEqsM...s.....
-000010d0: 1606 0112 010e 0108 0672 3200 0000 2902  .........r2...).
-000010e0: 4672 0100 0000 2907 da04 6e6a 6574 7203  Fr....)...njetr.
-000010f0: 0000 00da 056e 756d 7079 da02 6e70 721d  .....numpy..npr.
-00001100: 0000 0072 2d00 0000 7232 0000 0072 0600  ...r-...r2...r..
-00001110: 0000 7206 0000 0072 0600 0000 720a 0000  ..r....r....r...
-00001120: 00da 083c 6d6f 6475 6c65 3e01 0000 0073  ...<module>....s
-00001130: 0a00 0000 0c00 0801 0802 0a19 0c30       .............0
+000002f0: 0000 00fa 2e2f 686f 6d65 2f6d 616c 7465  ...../home/malte
+00000300: 2f67 6974 2f6c 6965 6f70 732f 6c69 656f  /git/lieops/lieo
+00000310: 7073 2f73 6f6c 7665 722f 636f 6d6d 6f6e  ps/solver/common
+00000320: 2e70 79da 0a3c 6c69 7374 636f 6d70 3e17  .py..<listcomp>.
+00000330: 0000 0073 0200 0000 1400 7a33 636f 6d70  ...s......z3comp
+00000340: 6c65 7848 616d 696c 746f 6e45 7173 2e3c  lexHamiltonEqs.<
+00000350: 6c6f 6361 6c73 3e2e 6571 732e 3c6c 6f63  locals>.eqs.<loc
+00000360: 616c 733e 2e3c 6c69 7374 636f 6d70 3e63  als>.<listcomp>c
+00000370: 0100 0000 0000 0000 0000 0000 0200 0000  ................
+00000380: 0600 0000 1300 0000 731a 0000 0067 007c  ........s....g.|
+00000390: 005d 097d 0188 00a0 007c 0166 0164 00a1  .].}.....|.f.d..
+000003a0: 0291 0271 0253 0029 0172 0100 0000 a901  ...q.S.).r......
+000003b0: da03 6765 74a9 0272 0800 0000 da01 6ba9  ..get..r......k.
+000003c0: 01da 0264 4872 0600 0000 720a 0000 0072  ...dHr....r....r
+000003d0: 0b00 0000 1900 0000 7302 0000 001a 00e9  ........s.......
+000003e0: 0200 0000 2904 da04 6c69 7374 da04 6772  ....)...list..gr
+000003f0: 6164 da05 7261 6e67 65da 0364 696d 2903  ad..range..dim).
+00000400: da01 7a5a 047a 696e 70da 0364 7869 a902  ..zZ.zinp..dxi..
+00000410: da0c 6468 616d 696c 746f 6e69 616e da0b  ..dhamiltonian..
+00000420: 6861 6d69 6c74 6f6e 6961 6e72 1000 0000  hamiltonianr....
+00000430: 720a 0000 00da 0365 7173 1600 0000 7308  r......eqs....s.
+00000440: 0000 0016 010a 0120 0104 017a 1f63 6f6d  ....... ...z.com
+00000450: 706c 6578 4861 6d69 6c74 6f6e 4571 732e  plexHamiltonEqs.
+00000460: 3c6c 6f63 616c 733e 2e65 7173 7202 0000  <locals>.eqsr...
+00000470: 0029 0272 1b00 0000 721c 0000 0072 0600  .).r....r....r..
+00000480: 0000 7219 0000 0072 0a00 0000 da12 636f  ..r....r......co
+00000490: 6d70 6c65 7848 616d 696c 746f 6e45 7173  mplexHamiltonEqs
+000004a0: 0400 0000 7306 0000 0010 0f0e 0304 0572  ....s..........r
+000004b0: 1d00 0000 4663 0300 0000 0000 0000 0000  ....Fc..........
+000004c0: 0000 0400 0000 0600 0000 0300 0000 7378  ..............sx
+000004d0: 0000 007c 006a 0089 007c 00a0 01a1 0089  ...|.j...|......
+000004e0: 017c 0172 1264 0164 0284 0088 01a0 02a1  .|.r.d.d........
+000004f0: 0044 0083 0189 0188 0264 036b 0472 337a  .D.......d.k.r3z
+00000500: 0d87 0266 0164 0464 0284 0888 01a0 02a1  ...f.d.d........
+00000510: 0044 0083 0189 0157 006e 0f01 0001 0001  .D.....W.n......
+00000520: 0087 0266 0164 0564 0284 0888 01a0 02a1  ...f.d.d........
+00000530: 0044 0083 0189 0159 0087 0087 0166 0264  .D.....Y.....f.d
+00000540: 0664 0784 087d 037c 0353 0029 0861 de02  .d...}.|.S.).a..
+00000550: 0000 0a20 2020 2043 7265 6174 6520 6120  ...    Create a 
+00000560: 4861 6d69 6c74 6f6e 2066 756e 6374 696f  Hamilton functio
+00000570: 6e20 4828 712c 2070 292c 2066 6f72 2061  n H(q, p), for a
+00000580: 2067 6976 656e 2048 616d 696c 746f 6e69   given Hamiltoni
+00000590: 616e 2048 2878 692c 2065 7461 292e 0a20  an H(xi, eta).. 
+000005a0: 2020 200a 2020 2020 5061 7261 6d65 7465     .    Paramete
+000005b0: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+000005c0: 2d0a 2020 2020 6861 6d69 6c74 6f6e 6961  -.    hamiltonia
+000005d0: 6e3a 206f 7073 2e70 6f6c 790a 2020 2020  n: ops.poly.    
+000005e0: 2020 2020 4120 706f 6c79 206f 626a 6563      A poly objec
+000005f0: 742c 2072 6570 7265 7365 6e74 696e 6720  t, representing 
+00000600: 6120 4861 6d69 6c74 6f6e 6961 6e20 696e  a Hamiltonian in
+00000610: 2069 7473 2064 6566 6175 6c74 2063 6f6d   its default com
+00000620: 706c 6578 2028 7869 2c20 6574 6129 2d63  plex (xi, eta)-c
+00000630: 6f6f 7264 696e 6174 6573 2e0a 2020 2020  oordinates..    
+00000640: 0a20 2020 2072 6561 6c3a 2062 6f6f 6c65  .    real: boole
+00000650: 616e 2c20 6f70 7469 6f6e 616c 0a20 2020  an, optional.   
+00000660: 2020 2020 2054 6869 7320 666c 6167 2069       This flag i
+00000670: 7320 696e 7465 6e64 6564 2074 6f20 6265  s intended to be
+00000680: 2075 7365 6420 6f6e 2048 616d 696c 746f   used on Hamilto
+00000690: 6e69 616e 7320 7768 6f73 6520 7265 616c  nians whose real
+000006a0: 2066 6f72 6d20 6973 2065 7870 6563 7465   form is expecte
+000006b0: 6420 746f 206e 6f74 0a20 2020 2020 2020  d to not.       
+000006c0: 2063 6f6e 7461 696e 2069 6d61 6769 6e61   contain imagina
+000006d0: 7279 2070 6172 7473 2e0a 2020 2020 2020  ry parts..      
+000006e0: 2020 0a20 2020 2074 6f6c 5f64 726f 703a    .    tol_drop:
+000006f0: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
+00000700: 0a20 2020 2020 2020 2044 726f 7020 636f  .        Drop co
+00000710: 6566 6669 6369 656e 7473 2062 656c 6f77  efficients below
+00000720: 2074 6869 7320 7468 7265 7368 6f6c 642e   this threshold.
+00000730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000740: 200a 2020 2020 5265 7475 726e 730a 2020   .    Returns.  
+00000750: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6361    -------.    ca
+00000760: 6c6c 6162 6c65 0a20 2020 2020 2020 2041  llable.        A
+00000770: 2066 756e 6374 696f 6e20 7461 6b69 6e67   function taking
+00000780: 2076 616c 7565 7320 696e 2032 2a68 616d   values in 2*ham
+00000790: 696c 746f 6e69 616e 2e64 696d 2069 6e70  iltonian.dim inp
+000007a0: 7574 2070 6172 616d 6574 6572 7320 616e  ut parameters an
+000007b0: 6420 7265 7475 726e 7320 6120 636f 6d70  d returns a comp
+000007c0: 6c65 7820 286f 7220 7265 616c 2920 7661  lex (or real) va
+000007d0: 6c75 652e 0a20 2020 2020 2020 2049 7420  lue..        It 
+000007e0: 7769 6c6c 2072 6570 7265 7365 6e74 2074  will represent t
+000007f0: 6865 2048 616d 696c 746f 6e69 616e 2077  he Hamiltonian w
+00000800: 6974 6820 7265 7370 6563 7420 746f 2069  ith respect to i
+00000810: 7473 2072 6561 6c20 2871 2c20 7029 2d63  ts real (q, p)-c
+00000820: 6f6f 7264 696e 6174 6573 2e0a 2020 2020  oordinates..    
+00000830: 6301 0000 0000 0000 0000 0000 0003 0000  c...............
+00000840: 0004 0000 0053 0000 0073 1800 0000 6900  .....S...s....i.
+00000850: 7c00 5d08 5c02 7d01 7d02 7c01 7c02 6a00  |.].\.}.}.|.|.j.
+00000860: 9302 7102 5300 7206 0000 0029 01da 0472  ..q.S.r....)...r
+00000870: 6561 6ca9 0372 0800 0000 720f 0000 00da  eal..r....r.....
+00000880: 0176 7206 0000 0072 0600 0000 720a 0000  .vr....r....r...
+00000890: 00da 0a3c 6469 6374 636f 6d70 3e39 0000  ...<dictcomp>9..
+000008a0: 0073 0200 0000 1800 7a2b 6765 7452 6561  .s......z+getRea
+000008b0: 6c48 616d 696c 746f 6e46 756e 6374 696f  lHamiltonFunctio
+000008c0: 6e2e 3c6c 6f63 616c 733e 2e3c 6469 6374  n.<locals>.<dict
+000008d0: 636f 6d70 3e72 0100 0000 6301 0000 0000  comp>r....c.....
+000008e0: 0000 0000 0000 0003 0000 0004 0000 0013  ................
+000008f0: 0000 0073 2200 0000 6900 7c00 5d0d 5c02  ...s"...i.|.].\.
+00000900: 7d01 7d02 7400 7c02 8301 8800 6b05 7202  }.}.t.|.....k.r.
+00000910: 7c01 7c02 9302 7102 5300 7206 0000 0029  |.|...q.S.r....)
+00000920: 01da 0361 6273 721f 0000 00a9 01da 0874  ...absr........t
+00000930: 6f6c 5f64 726f 7072 0600 0000 720a 0000  ol_dropr....r...
+00000940: 0072 2100 0000 3d00 0000 7302 0000 0022  .r!...=...s...."
+00000950: 0063 0100 0000 0000 0000 0000 0000 0300  .c..............
+00000960: 0000 0400 0000 1300 0000 7326 0000 0069  ..........s&...i
+00000970: 007c 005d 0f5c 027d 017d 0274 007c 0283  .|.].\.}.}.t.|..
+00000980: 0188 006b 05a0 01a1 0072 027c 017c 0293  ...k.....r.|.|..
+00000990: 0271 0253 0072 0600 0000 2902 7222 0000  .q.S.r....).r"..
+000009a0: 00da 0361 6c6c 721f 0000 0072 2300 0000  ...allr....r#...
+000009b0: 7206 0000 0072 0a00 0000 7221 0000 0040  r....r....r!...@
+000009c0: 0000 0073 0200 0000 2600 6300 0000 0000  ...s....&.c.....
+000009d0: 0000 0000 0000 0006 0000 0008 0000 0017  ................
+000009e0: 0000 0073 6400 0000 6401 7d01 8801 a000  ...sd...d.}.....
+000009f0: a100 4400 5d29 5c02 7d02 7d03 6402 7d04  ..D.])\.}.}.d.}.
+00000a00: 7401 8800 8301 4400 5d18 7d05 7c04 7c00  t.....D.].}.|.|.
+00000a10: 7c05 1900 7c02 7c05 1900 1300 7c00 7c05  |...|.|.....|.|.
+00000a20: 8800 1700 1900 7c02 7c05 8800 1700 1900  ......|.|.......
+00000a30: 1300 1400 3900 7d04 7110 7c01 7c04 7c03  ....9.}.q.|.|.|.
+00000a40: 1400 3700 7d01 7106 7c01 5300 2903 4e72  ..7.}.q.|.S.).Nr
+00000a50: 0100 0000 7204 0000 0029 02da 0569 7465  ....r....)...ite
+00000a60: 6d73 7215 0000 0029 06da 0271 70da 0672  msr....)...qp..r
+00000a70: 6573 756c 7472 0f00 0000 7220 0000 00da  esultr....r ....
+00000a80: 0570 6f77 6572 da01 6c29 0272 1600 0000  .power..l).r....
+00000a90: da03 7262 6872 0600 0000 720a 0000 00da  ..rbhr....r.....
+00000aa0: 0368 616d 4300 0000 730e 0000 0004 0110  .hamC...s.......
+00000ab0: 0104 010c 012e 010e 0104 017a 2467 6574  ...........z$get
+00000ac0: 5265 616c 4861 6d69 6c74 6f6e 4675 6e63  RealHamiltonFunc
+00000ad0: 7469 6f6e 2e3c 6c6f 6361 6c73 3e2e 6861  tion.<locals>.ha
+00000ae0: 6d29 0372 1600 0000 da09 7265 616c 4261  m).r......realBa
+00000af0: 7369 7372 2600 0000 2904 721b 0000 0072  sisr&...).r....r
+00000b00: 1e00 0000 7224 0000 0072 2c00 0000 7206  ....r$...r,...r.
+00000b10: 0000 0029 0372 1600 0000 722b 0000 0072  ...).r....r+...r
+00000b20: 2400 0000 720a 0000 00da 1767 6574 5265  $...r......getRe
+00000b30: 616c 4861 6d69 6c74 6f6e 4675 6e63 7469  alHamiltonFuncti
+00000b40: 6f6e 1d00 0000 7316 0000 0006 1608 0104  on....s.........
+00000b50: 0112 0408 0202 011a 0106 0118 020e 0304  ................
+00000b60: 0972 2e00 0000 6301 0000 0000 0000 0000  .r....c.........
+00000b70: 0000 0004 0000 0005 0000 000b 0000 0073  ...............s
+00000b80: 3e00 0000 7400 7c00 6601 6900 7c01 a401  >...t.|.f.i.|...
+00000b90: 8e01 7d02 7c00 6a01 8901 7402 7c02 6401  ..}.|.j...t.|.d.
+00000ba0: 6402 8801 1400 6403 8d03 8900 8700 8701  d.....d.........
+00000bb0: 6602 6404 6405 8408 7d03 7c03 7c02 6602  f.d.d...}.|.|.f.
+00000bc0: 5300 2906 618a 0200 000a 2020 2020 4f62  S.).a.....    Ob
+00000bd0: 7461 696e 2074 6865 2072 6561 6c2d 7661  tain the real-va
+00000be0: 6c75 6564 2048 616d 696c 746f 6e2d 6571  lued Hamilton-eq
+00000bf0: 7561 7469 6f6e 7320 666f 7220 6120 6769  uations for a gi
+00000c00: 7665 6e20 6f70 732e 706f 6c79 2063 6c61  ven ops.poly cla
+00000c10: 7373 2e0a 2020 2020 0a20 2020 2050 6172  ss..    .    Par
+00000c20: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00000c30: 2d2d 2d2d 2d2d 0a20 2020 2068 616d 696c  ------.    hamil
+00000c40: 746f 6e69 616e 3a20 6f70 732e 706f 6c79  tonian: ops.poly
+00000c50: 0a20 2020 2020 2020 2041 206f 7073 2e70  .        A ops.p
+00000c60: 6f6c 7920 6f62 6a65 6374 2c20 7265 7072  oly object, repr
+00000c70: 6573 656e 7469 6e67 2074 6865 2070 6f6c  esenting the pol
+00000c80: 796e 6f6d 6961 6c20 6578 7061 6e73 696f  ynomial expansio
+00000c90: 6e20 6f66 2061 2048 616d 696c 746f 6e69  n of a Hamiltoni
+00000ca0: 616e 2069 6e20 6974 7320 2864 6566 6175  an in its (defau
+00000cb0: 6c74 290a 2020 2020 2020 2020 636f 6d70  lt).        comp
+00000cc0: 6c65 7820 2878 692c 2065 7461 292d 636f  lex (xi, eta)-co
+00000cd0: 6f72 6469 6e61 7465 732e 0a20 2020 200a  ordinates..    .
+00000ce0: 2020 2020 2a2a 6b77 6172 6773 0a20 2020      **kwargs.   
+00000cf0: 2020 2020 204f 7074 696f 6e61 6c20 6b65       Optional ke
+00000d00: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
+00000d10: 7061 7373 6564 2074 6f20 6765 7452 6561  passed to getRea
+00000d20: 6c48 616d 696c 746f 6e46 756e 6374 696f  lHamiltonFunctio
+00000d30: 6e20 726f 7574 696e 652e 0a20 2020 2020  n routine..     
+00000d40: 2020 200a 2020 2020 5265 7475 726e 730a     .    Returns.
+00000d50: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00000d60: 6361 6c6c 6162 6c65 0a20 2020 2020 2020  callable.       
+00000d70: 2041 2066 756e 6374 696f 6e20 7461 6b69   A function taki
+00000d80: 6e67 2076 616c 7565 7320 696e 2072 6561  ng values in rea
+00000d90: 6c20 2871 2c20 7029 2d76 6172 6961 626c  l (q, p)-variabl
+00000da0: 6573 2c20 7265 7072 6573 656e 7469 6e67  es, representing
+00000db0: 2074 6865 2072 6967 6874 2d68 616e 6420   the right-hand 
+00000dc0: 7369 6465 206f 6620 7468 650a 2020 2020  side of the.    
+00000dd0: 2020 2020 4861 6d69 6c74 6f6e 2d65 7175      Hamilton-equ
+00000de0: 6174 696f 6e73 205c 646f 7420 7a20 3d20  ations \dot z = 
+00000df0: 4a20 5c6e 6162 6c61 2048 287a 292e 0a20  J \nabla H(z).. 
+00000e00: 2020 2020 2020 200a 2020 2020 6361 6c6c         .    call
+00000e10: 6162 6c65 0a20 2020 2020 2020 2054 6865  able.        The
+00000e20: 2067 6976 656e 2048 616d 696c 746f 6e69   given Hamiltoni
+00000e30: 616e 2069 6e20 2872 6561 6c29 2028 712c  an in (real) (q,
+00000e40: 2070 292d 7661 7269 6162 6c65 732e 0a20   p)-variables.. 
+00000e50: 2020 2072 0400 0000 7212 0000 0029 0272     r....r....).r
+00000e60: 0500 0000 da06 6e5f 6172 6773 6300 0000  ......n_argsc...
+00000e70: 0000 0000 0000 0000 0002 0000 0004 0000  ................
+00000e80: 0017 0000 0073 4c00 0000 8802 6a00 7c00  .....sL.....j.|.
+00000e90: 8e00 8900 7c00 6401 1900 6401 1400 8901  ....|.d...d.....
+00000ea0: 8700 8703 8701 6603 6402 6403 8408 7401  ......f.d.d...t.
+00000eb0: 8803 8301 4400 8301 8700 8701 6602 6404  ....D.......f.d.
+00000ec0: 6403 8408 7401 8803 8301 4400 8301 1700  d...t.....D.....
+00000ed0: 7d01 7c01 5300 2905 4e72 0100 0000 6301  }.|.S.).Nr....c.
+00000ee0: 0000 0000 0000 0000 0000 0002 0000 0006  ................
+00000ef0: 0000 0013 0000 0073 1e00 0000 6700 7c00  .......s....g.|.
+00000f00: 5d0b 7d01 8800 a000 7c01 8801 1700 6601  ].}.....|.....f.
+00000f10: 8802 a102 9102 7102 5300 7206 0000 0072  ......q.S.r....r
+00000f20: 0c00 0000 720e 0000 0029 0372 1100 0000  ....r....).r....
+00000f30: 7216 0000 00da 047a 6572 6f72 0600 0000  r......zeror....
+00000f40: 720a 0000 0072 0b00 0000 6b00 0000 7302  r....r....k...s.
+00000f50: 0000 001e 007a 3072 6561 6c48 616d 696c  .....z0realHamil
+00000f60: 746f 6e45 7173 2e3c 6c6f 6361 6c73 3e2e  tonEqs.<locals>.
+00000f70: 6571 732e 3c6c 6f63 616c 733e 2e3c 6c69  eqs.<locals>.<li
+00000f80: 7374 636f 6d70 3e63 0100 0000 0000 0000  stcomp>c........
+00000f90: 0000 0000 0200 0000 0600 0000 1300 0000  ................
+00000fa0: 731c 0000 0067 007c 005d 0a7d 0188 00a0  s....g.|.].}....
+00000fb0: 007c 0166 0188 01a1 020b 0091 0271 0253  .|.f.........q.S
+00000fc0: 0072 0600 0000 720c 0000 0072 0e00 0000  .r....r....r....
+00000fd0: a902 7211 0000 0072 3000 0000 7206 0000  ..r....r0...r...
+00000fe0: 0072 0a00 0000 720b 0000 006b 0000 0073  .r....r....k...s
+00000ff0: 0200 0000 1c00 2902 7214 0000 0072 1500  ......).r....r..
+00001000: 0000 2902 7227 0000 005a 0364 7170 a902  ..).r'...Z.dqp..
+00001010: 721a 0000 0072 1600 0000 7231 0000 0072  r....r....r1...r
+00001020: 0a00 0000 721c 0000 0067 0000 0073 0800  ....r....g...s..
+00001030: 0000 0a01 0c02 3201 0401 7a1c 7265 616c  ......2...z.real
+00001040: 4861 6d69 6c74 6f6e 4571 732e 3c6c 6f63  HamiltonEqs.<loc
+00001050: 616c 733e 2e65 7173 2903 722e 0000 0072  als>.eqs).r....r
+00001060: 1600 0000 7203 0000 0029 0472 1b00 0000  ....r....).r....
+00001070: da06 6b77 6172 6773 5a07 7265 616c 4861  ..kwargsZ.realHa
+00001080: 6d72 1c00 0000 7206 0000 0072 3200 0000  mr....r....r2...
+00001090: 720a 0000 00da 0f72 6561 6c48 616d 696c  r......realHamil
+000010a0: 746f 6e45 7173 4e00 0000 730a 0000 0010  tonEqsN...s.....
+000010b0: 1606 0112 010e 0108 0672 3400 0000 2902  .........r4...).
+000010c0: 4672 0100 0000 2907 da04 6e6a 6574 7203  Fr....)...njetr.
+000010d0: 0000 00da 056e 756d 7079 da02 6e70 721d  .....numpy..npr.
+000010e0: 0000 0072 2e00 0000 7234 0000 0072 0600  ...r....r4...r..
+000010f0: 0000 7206 0000 0072 0600 0000 720a 0000  ..r....r....r...
+00001100: 00da 083c 6d6f 6475 6c65 3e01 0000 0073  ...<module>....s
+00001110: 0a00 0000 0c00 0801 0802 0a19 0c31       .............1
```

### Comparing `lieops-0.2.1/lieops/solver/__pycache__/heyoka.cpython-310.pyc` & `lieops-0.2.2/lieops/solver/__pycache__/heyoka.cpython-310.pyc`

 * *Format-specific differences are supported for Python .pyc files but no file-specific differences were detected; falling back to a binary diff. file(1) reports: Byte-compiled Python module for CPython 3.10, timestamp-based, .py timestamp: Wed Jan 18 13:21:39 2023 UTC, .py size: 6911 bytes*

 * *Could not decompile bytecode: bad marshal data (unknown type code)*

 * *Files 2% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-00000000: 6f0d 0d0a 0000 0000 63f2 c763 ff1a 0000  o.......c..c....
+00000000: 6f0d 0d0a 0000 0000 0152 3e64 ff1a 0000  o........R>d....
 00000010: e300 0000 0000 0000 0000 0000 0000 0000  ................
 00000020: 0003 0000 0040 0000 0073 3600 0000 6400  .....@...s6...d.
 00000030: 6401 6c00 5a01 6400 6401 6c02 5a03 6402  d.l.Z.d.d.l.Z.d.
 00000040: 6403 6c04 6d05 5a05 0100 6404 6405 8400  d.l.m.Z...d.d...
 00000050: 5a06 4700 6406 6407 8400 6407 8302 5a07  Z.G.d.d...d...Z.
 00000060: 6401 5300 2908 e900 0000 004e e901 0000  d.S.)......N....
 00000070: 0029 01da 0f72 6561 6c48 616d 696c 746f  .)...realHamilto
@@ -40,379 +40,377 @@
 00000270: 6c65 6eda 0573 6861 7065 da07 7265 7368  len..shape..resh
 00000280: 6170 65da 026e 70da 0b63 6f6e 6361 7465  ape..np..concate
 00000290: 6e61 7465 7204 0000 00da 0469 6d61 67da  nater......imag.
 000002a0: 095f 7170 3278 6965 7461 da05 6172 7261  ._qp2xieta..arra
 000002b0: 7929 08da 0473 656c 6672 0400 0000 da06  y)...selfr......
 000002c0: 7869 6574 6130 da06 6b77 6172 6773 da03  xieta0..kwargs..
 000002d0: 7170 305a 0371 7031 da04 6f75 7431 da03  qp0Z.qp1..out1..
-000002e0: 6f75 74a9 01da 0466 756e 63a9 00fa 552f  out....func...U/
-000002f0: 686f 6d65 2f6d 616c 7465 2f6d 696e 6963  home/malte/minic
-00000300: 6f6e 6461 332f 656e 7673 2f77 6f72 6b2f  onda3/envs/work/
-00000310: 6c69 622f 7079 7468 6f6e 332e 3130 2f73  lib/python3.10/s
-00000320: 6974 652d 7061 636b 6167 6573 2f6c 6965  ite-packages/lie
-00000330: 6f70 732f 736f 6c76 6572 2f68 6579 6f6b  ops/solver/heyok
-00000340: 612e 7079 da07 7869 6574 6171 700a 0000  a.py..xietaqp...
-00000350: 0073 1c00 0000 0401 0a02 0e01 1201 1601  .s..............
-00000360: 1201 3801 0a01 0406 0cfc 0e01 1201 1201  ..8.............
-00000370: 0401 7a14 7472 662e 3c6c 6f63 616c 733e  ..z.trf.<locals>
-00000380: 2e78 6965 7461 7170 721b 0000 0029 0272  .xietaqpr....).r
-00000390: 1a00 0000 721d 0000 0072 1b00 0000 7219  ....r....r....r.
-000003a0: 0000 0072 1c00 0000 da03 7472 6606 0000  ...r......trf...
-000003b0: 0073 0400 0000 1204 0410 721e 0000 0063  .s........r....c
-000003c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000003d0: 0400 0000 4000 0000 7342 0000 0065 005a  ....@...sB...e.Z
-000003e0: 0164 005a 0264 0164 0284 005a 0364 0364  .d.Z.d.d...Z.d.d
-000003f0: 0484 005a 0465 0564 0f64 0664 0784 0183  ...Z.e.d.d.d....
-00000400: 015a 0664 0864 0984 005a 0764 0a64 0b84  .Z.d.d...Z.d.d..
-00000410: 005a 0864 0c64 0d84 005a 0964 0e53 0029  .Z.d.d...Z.d.S.)
-00000420: 10da 0d68 6579 6f6b 615f 736f 6c76 6572  ...heyoka_solver
-00000430: 6302 0000 0000 0000 0000 0000 0003 0000  c...............
-00000440: 0005 0000 004b 0000 0073 5c00 0000 7c01  .....K...s\...|.
-00000450: 0b00 7c00 5f00 7c00 6a00 6a01 7c00 5f01  ..|._.|.j.j.|._.
-00000460: 7c00 6a02 6405 6900 7c02 a401 8e01 5c03  |.j.d.i.|.....\.
-00000470: 7c00 5f03 7c00 5f04 7c00 5f05 7406 a007  |._.|._.|._.t...
-00000480: 7c00 6a04 6401 6701 7c00 6a01 1400 6402  |.j.d.g.|.j...d.
-00000490: 1400 a102 7c00 5f08 7c02 a009 6403 6404  ....|._.|...d.d.
-000004a0: a102 7c00 5f0a 6400 5300 2906 4e72 0100  ..|._.d.S.).Nr..
-000004b0: 0000 7208 0000 00da 0174 7202 0000 0072  ..r......tr....r
-000004c0: 1b00 0000 290b da0b 6861 6d69 6c74 6f6e  ....)...hamilton
-000004d0: 6961 6eda 0364 696d da0e 6765 7448 616d  ian..dim..getHam
-000004e0: 696c 746f 6e45 7173 da09 7661 7269 6162  iltonEqs..variab
-000004f0: 6c65 73da 0668 616d 6571 735a 0f72 6561  les..hameqsZ.rea
-00000500: 6c48 616d 696c 746f 6e69 616e da02 6879  lHamiltonian..hy
-00000510: 5a0f 7461 796c 6f72 5f61 6461 7074 6976  Z.taylor_adaptiv
-00000520: 65da 0a69 6e74 6567 7261 746f 72da 0367  e..integrator..g
-00000530: 6574 7220 0000 0029 0372 1300 0000 7221  etr ...).r....r!
-00000540: 0000 0072 1500 0000 721b 0000 0072 1b00  ...r....r....r..
-00000550: 0000 721c 0000 00da 085f 5f69 6e69 745f  ..r......__init_
-00000560: 5f1f 0000 0073 0a00 0000 0801 0a01 1c01  _....s..........
-00000570: 1c01 1201 7a16 6865 796f 6b61 5f73 6f6c  ....z.heyoka_sol
-00000580: 7665 722e 5f5f 696e 6974 5f5f 6301 0000  ver.__init__c...
-00000590: 0000 0000 0000 0000 0006 0000 0005 0000  ................
-000005a0: 004b 0000 0073 7000 0000 7400 6a01 6401  .K...sp...t.j.d.
-000005b0: 6402 8400 7402 7c00 6a03 8301 4400 8301  d...t.|.j...D...
-000005c0: 6403 6402 8400 7402 7c00 6a03 8301 4400  d.d...t.|.j...D.
-000005d0: 8301 1700 8e00 7d02 6404 7c01 6405 3c00  ......}.d.|.d.<.
-000005e0: 7404 7c00 6a05 6601 6900 7c01 a401 8e01  t.|.j.f.i.|.....
-000005f0: 5c02 7d03 7d04 7c03 7c02 8e00 7d05 7c02  \.}.}.|.|...}.|.
-00000600: 6406 6402 8400 7406 7c02 7c05 6702 8e00  d.d...t.|.|.g...
-00000610: 4400 8301 7c04 6603 5300 2907 7af1 0a20  D...|.f.S.).z.. 
-00000620: 2020 2020 2020 2043 6f6d 7075 7465 2074         Compute t
-00000630: 6865 2048 616d 696c 746f 6e20 6571 7561  he Hamilton equa
-00000640: 7469 6f6e 7320 6672 6f6d 2074 6865 2067  tions from the g
-00000650: 6976 656e 2048 616d 696c 746f 6e69 616e  iven Hamiltonian
-00000660: 2028 7365 6c66 2e68 616d 696c 746f 6e69   (self.hamiltoni
-00000670: 616e 292e 0a20 2020 2020 2020 200a 0a20  an)..        .. 
-00000680: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-00000690: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-000006a0: 2020 2020 2020 2064 6963 740a 2020 2020         dict.    
-000006b0: 2020 2020 2020 2020 4120 6469 6374 696f          A dictio
-000006c0: 6e61 7279 2063 6f6e 7461 696e 696e 6720  nary containing 
-000006d0: 7468 6520 7265 616c 2048 616d 696c 746f  the real Hamilto
-000006e0: 6e20 6571 7561 7469 6f6e 7320 616e 6420  n equations and 
-000006f0: 7468 6520 696e 7465 6772 6174 696f 6e20  the integration 
-00000700: 7374 6570 732e 0a20 2020 2020 2020 2063  steps..        c
-00000710: 0100 0000 0000 0000 0000 0000 0200 0000  ................
-00000720: 0400 0000 5300 0000 f316 0000 0067 007c  ....S........g.|
-00000730: 005d 077d 0164 007c 019b 009d 0291 0271  .].}.d.|.......q
-00000740: 0253 0029 015a 0763 6f6f 7264 5f71 721b  .S.).Z.coord_qr.
-00000750: 0000 00a9 02da 022e 30da 016b 721b 0000  ........0..kr...
-00000760: 0072 1b00 0000 721c 0000 00da 0a3c 6c69  .r....r......<li
-00000770: 7374 636f 6d70 3e30 0000 00f3 0200 0000  stcomp>0........
-00000780: 1600 7a30 6865 796f 6b61 5f73 6f6c 7665  ..z0heyoka_solve
-00000790: 722e 6765 7448 616d 696c 746f 6e45 7173  r.getHamiltonEqs
-000007a0: 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973 7463  .<locals>.<listc
-000007b0: 6f6d 703e 6301 0000 0000 0000 0000 0000  omp>c...........
-000007c0: 0002 0000 0004 0000 0053 0000 0072 2a00  .........S...r*.
-000007d0: 0000 2901 5a07 636f 6f72 645f 7072 1b00  ..).Z.coord_pr..
-000007e0: 0000 722b 0000 0072 1b00 0000 721b 0000  ..r+...r....r...
-000007f0: 0072 1c00 0000 722e 0000 0031 0000 0072  .r....r....1...r
-00000800: 2f00 0000 5472 0400 0000 6301 0000 0000  /...Tr....c.....
-00000810: 0000 0000 0000 0002 0000 0003 0000 0053  ...............S
-00000820: 0000 0073 1000 0000 6700 7c00 5d04 7d01  ...s....g.|.].}.
-00000830: 7c01 9102 7102 5300 721b 0000 0072 1b00  |...q.S.r....r..
-00000840: 0000 a902 722c 0000 00da 0165 721b 0000  ....r,.....er...
-00000850: 0072 1b00 0000 721c 0000 0072 2e00 0000  .r....r....r....
-00000860: 3500 0000 7302 0000 0010 0029 0772 2600  5...s......).r&.
-00000870: 0000 5a09 6d61 6b65 5f76 6172 73da 0572  ..Z.make_vars..r
-00000880: 616e 6765 7222 0000 0072 0300 0000 7221  anger"...r....r!
-00000890: 0000 00da 037a 6970 2906 7213 0000 0072  .....zip).r....r
-000008a0: 1500 0000 da02 7170 7225 0000 005a 0472  ......qpr%...Z.r
-000008b0: 6861 6d5a 0968 616d 6571 735f 6879 721b  hamZ.hameqs_hyr.
-000008c0: 0000 0072 1b00 0000 721c 0000 0072 2300  ...r....r....r#.
-000008d0: 0000 2600 0000 730e 0000 0016 0a12 0106  ..&...s.........
-000008e0: ff08 0216 0108 011c 017a 1c68 6579 6f6b  .........z.heyok
-000008f0: 615f 736f 6c76 6572 2e67 6574 4861 6d69  a_solver.getHami
-00000900: 6c74 6f6e 4571 73da 0575 6e74 696c 6303  ltonEqs..untilc.
-00000910: 0000 0000 0000 0000 0000 0008 0000 0008  ................
-00000920: 0000 000b 0000 0073 2e01 0000 7400 8800  .......s....t...
-00000930: 6a01 8301 6401 6b02 7309 4a00 8201 8800  j...d.k.s.J.....
-00000940: 6a01 5c02 7d04 7d05 7c04 6401 1a00 7c00  j.\.}.}.|.d...|.
-00000950: 6a02 6b02 7323 4a00 6402 7c04 6401 1a00  j.k.s#J.d.|.d...
-00000960: 9b00 6403 7c00 6a02 9b00 6404 9d05 8301  ..d.|.j...d.....
-00000970: 8201 7c03 a003 6405 7c00 6a04 a102 7d06  ..|...d.|.j...}.
-00000980: 7405 7c06 6406 8302 7231 6407 7d02 8700  t.|.d...r1d.}...
-00000990: 6601 6408 6409 8408 7d07 7c02 640a 6b02  f.d.d...}.|.d.k.
-000009a0: 7255 7406 6a07 7c00 6a08 7c05 7c07 7c06  rUt.j.|.j.|.|.|.
-000009b0: 640b 640b 640c 8d06 7c00 5f09 740a a00b  d.d.d...|._.t...
-000009c0: 640d 640e 8400 7c00 6a09 4400 8301 a101  d.d...|.j.D.....
-000009d0: a00c a100 5300 7c02 640f 6b02 7273 7406  ....S.|.d.k.rst.
-000009e0: 6a0d 7c00 6a08 7c05 7c07 7c06 640b 640b  j.|.j.|.|.|.d.d.
-000009f0: 6410 8d06 7c00 5f09 740a a00b 6411 640e  d...|._.t...d.d.
-00000a00: 8400 7c00 6a09 4400 8301 a101 a00c a100  ..|.j.D.........
-00000a10: 5300 7c02 6407 6b02 728f 7406 6a0e 7c00  S.|.d.k.r.t.j.|.
-00000a20: 6a08 7c05 7c07 7c06 6412 8d04 7c00 5f09  j.|.|.|.d...|._.
-00000a30: 740a a00b 6413 640e 8400 7c00 6a09 4400  t...d.d...|.j.D.
-00000a40: 8301 a101 a00c a100 5300 740f 6414 7c02  ........S.t.d.|.
-00000a50: 9b00 6415 9d03 8301 8201 2916 6108 0400  ..d.......).a...
-00000a60: 000a 2020 2020 2020 2020 456e 7365 6d62  ..        Ensemb
-00000a70: 6c65 2070 726f 7061 6761 7469 6f6e 2061  le propagation a
-00000a80: 6363 6f72 6469 6e67 2074 6f20 6874 7470  ccording to http
-00000a90: 733a 2f2f 626c 7565 7363 6172 6e69 2e67  s://bluescarni.g
-00000aa0: 6974 6875 622e 696f 2f68 6579 6f6b 612f  ithub.io/heyoka/
-00000ab0: 7475 745f 656e 7365 6d62 6c65 2e68 746d  tut_ensemble.htm
-00000ac0: 6c0a 2020 2020 2020 2020 0a20 2020 2020  l.        .     
-00000ad0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00000ae0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00000af0: 0a20 2020 2020 2020 2071 7030 3a20 6172  .        qp0: ar
-00000b00: 7261 792d 6c69 6b65 206f 6620 7368 6170  ray-like of shap
-00000b10: 6520 284b 2c20 322a 6469 6d29 200a 2020  e (K, 2*dim) .  
-00000b20: 2020 2020 2020 2020 2020 496e 7075 7420            Input 
-00000b30: 7665 6374 6f72 2873 2920 6465 6e6f 7469  vector(s) denoti
-00000b40: 6e67 2074 6865 2063 6f6f 7264 696e 6174  ng the coordinat
-00000b50: 6573 2e20 5468 6520 6e75 6d62 6572 2027  es. The number '
-00000b60: 4b27 2064 656e 6f74 6573 2074 6865 206e  K' denotes the n
-00000b70: 756d 6265 7220 6f66 2064 6966 6665 7265  umber of differe
-00000b80: 6e74 0a20 2020 2020 2020 2020 2020 2076  nt.            v
-00000b90: 6563 746f 7273 2074 6f20 6265 2074 7261  ectors to be tra
-00000ba0: 636b 6564 2c20 7768 696c 6520 2764 696d  cked, while 'dim
-00000bb0: 2720 6d75 7374 2063 6f72 7265 7370 6f6e  ' must correspon
-00000bc0: 6420 746f 2074 6865 2064 696d 656e 7369  d to the dimensi
-00000bd0: 6f6e 206f 6620 7468 6520 6375 7272 656e  on of the curren
-00000be0: 7420 6861 6d69 6c74 6f6e 6961 6e2e 0a20  t hamiltonian.. 
-00000bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000c00: 2020 2020 2020 200a 2020 2020 2020 2020         .        
-00000c10: 6b69 6e64 3a20 7374 722c 206f 7074 696f  kind: str, optio
-00000c20: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00000c30: 4120 7374 7269 6e67 2064 656e 6f74 696e  A string denotin
-00000c40: 6720 7468 6520 7479 7065 206f 6620 696e  g the type of in
-00000c50: 7465 6772 6174 696f 6e2c 2063 616c 6c69  tegration, calli
-00000c60: 6e67 2074 6865 2074 6872 6565 2070 6f73  ng the three pos
-00000c70: 7369 626c 6520 696e 7465 6772 6174 696f  sible integratio
-00000c80: 6e20 726f 7574 696e 6573 0a20 2020 2020  n routines.     
-00000c90: 2020 2020 2020 2069 6e20 4865 796f 6b61         in Heyoka
-00000ca0: 2028 7365 6520 6874 7470 733a 2f2f 626c   (see https://bl
-00000cb0: 7565 7363 6172 6e69 2e67 6974 6875 622e  uescarni.github.
-00000cc0: 696f 2f68 6579 6f6b 612f 7475 745f 656e  io/heyoka/tut_en
-00000cd0: 7365 6d62 6c65 2e68 746d 6c29 0a20 2020  semble.html).   
-00000ce0: 2020 2020 2020 2020 2027 756e 7469 6c27           'until'
-00000cf0: 3a20 7472 6163 6b20 6672 6f6d 2030 2075  : track from 0 u
-00000d00: 6e74 696c 2074 0a20 2020 2020 2020 2020  ntil t.         
-00000d10: 2020 2027 666f 7227 3a20 7472 6163 6b20     'for': track 
-00000d20: 6672 6f6d 2074 3020 756e 7469 6c20 7430  from t0 until t0
-00000d30: 202b 2074 0a20 2020 2020 2020 2020 2020   + t.           
-00000d40: 2027 6772 6964 273a 2074 7261 636b 2061   'grid': track a
-00000d50: 2067 7269 642e 0a20 2020 2020 2020 2020   grid..         
-00000d60: 2020 200a 2020 2020 2020 2020 2a2a 6b77     .        **kw
-00000d70: 6172 6773 0a20 2020 2020 2020 2020 2020  args.           
-00000d80: 204f 7074 696f 6e61 6c20 6b65 7977 6f72   Optional keywor
-00000d90: 6465 6420 6172 6775 6d65 6e74 7320 7061  ded arguments pa
-00000da0: 7373 6564 2074 6f20 7468 6520 6865 796f  ssed to the heyo
-00000db0: 6b61 2065 6e73 656d 626c 655f 7072 6f70  ka ensemble_prop
-00000dc0: 6167 6174 655f 2a20 726f 7574 696e 6573  agate_* routines
-00000dd0: 2e0a 2020 2020 2020 2020 2020 2020 0a20  ..            . 
-00000de0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-00000df0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-00000e00: 2020 2020 2020 2072 6574 0a20 2020 2020         ret.     
-00000e10: 2020 2020 2020 204f 626a 6563 7420 6163         Object ac
-00000e20: 636f 7264 696e 6720 746f 2068 7474 7073  cording to https
-00000e30: 3a2f 2f62 6c75 6573 6361 726e 692e 6769  ://bluescarni.gi
-00000e40: 7468 7562 2e69 6f2f 6865 796f 6b61 2f74  thub.io/heyoka/t
-00000e50: 7574 5f65 6e73 656d 626c 652e 6874 6d6c  ut_ensemble.html
-00000e60: 0a20 2020 2020 2020 2072 0800 0000 7a17  .        r....z.
-00000e70: 496e 7075 7420 7665 6374 6f72 2064 696d  Input vector dim
-00000e80: 656e 7369 6f6e 207a 1f20 6e6f 7420 636f  ension z. not co
-00000e90: 6e73 6973 7465 6e74 2077 6974 6820 6469  nsistent with di
-00000ea0: 6d65 6e73 696f 6e20 7a16 206f 6620 6769  mension z. of gi
-00000eb0: 7665 6e20 4861 6d69 6c74 6f6e 6961 6e2e  ven Hamiltonian.
-00000ec0: 7220 0000 00da 085f 5f69 7465 725f 5fda  r .....__iter__.
-00000ed0: 0467 7269 6463 0200 0000 0000 0000 0000  .gridc..........
-00000ee0: 0000 0200 0000 0400 0000 1300 0000 731e  ..............s.
-00000ef0: 0000 0088 0064 0064 0085 027c 0166 0219  .....d.d...|.f..
-00000f00: 007c 006a 0064 0064 0085 023c 007c 0053  .|.j.d.d...<.|.S
-00000f10: 0029 014e a901 da05 7374 6174 6529 025a  .).N....state).Z
-00000f20: 0474 6163 70da 0169 a901 7216 0000 0072  .tacp..i..r....r
-00000f30: 1b00 0000 721c 0000 00da 0367 656e 5e00  ....r......gen^.
-00000f40: 0000 7304 0000 001a 0104 017a 2f68 6579  ..s........z/hey
-00000f50: 6f6b 615f 736f 6c76 6572 2e65 6e73 656d  oka_solver.ensem
-00000f60: 626c 655f 7072 6f70 6167 6174 696f 6e2e  ble_propagation.
-00000f70: 3c6c 6f63 616c 733e 2e67 656e 7235 0000  <locals>.genr5..
-00000f80: 0054 2905 da06 6e5f 6974 6572 723c 0000  .T)...n_iterr<..
-00000f90: 0072 2000 0000 da08 7772 6974 655f 7463  .r .....write_tc
-00000fa0: da08 635f 6f75 7470 7574 6301 0000 0000  ..c_outputc.....
-00000fb0: 0000 0000 0000 0002 0000 0004 0000 0053  ...............S
-00000fc0: 0000 00f3 1600 0000 6700 7c00 5d07 7d01  ........g.|.].}.
-00000fd0: 7c01 6400 1900 6a00 9102 7102 5300 a901  |.d...j...q.S...
-00000fe0: 7201 0000 0072 3800 0000 7230 0000 0072  r....r8...r0...r
-00000ff0: 1b00 0000 721b 0000 0072 1c00 0000 722e  ....r....r....r.
-00001000: 0000 0064 0000 0072 2f00 0000 7a36 6865  ...d...r/...z6he
-00001010: 796f 6b61 5f73 6f6c 7665 722e 656e 7365  yoka_solver.ense
-00001020: 6d62 6c65 5f70 726f 7061 6761 7469 6f6e  mble_propagation
-00001030: 2e3c 6c6f 6361 6c73 3e2e 3c6c 6973 7463  .<locals>.<listc
-00001040: 6f6d 703e da03 666f 7229 0572 3d00 0000  omp>..for).r=...
-00001050: 723c 0000 00da 0764 656c 7461 5f74 723e  r<.....delta_tr>
-00001060: 0000 0072 3f00 0000 6301 0000 0000 0000  ...r?...c.......
-00001070: 0000 0000 0002 0000 0004 0000 0053 0000  .............S..
-00001080: 0072 4000 0000 7241 0000 0072 3800 0000  .r@...rA...r8...
-00001090: 7230 0000 0072 1b00 0000 721b 0000 0072  r0...r....r....r
-000010a0: 1c00 0000 722e 0000 0067 0000 0072 2f00  ....r....g...r/.
-000010b0: 0000 2903 723d 0000 0072 3c00 0000 7237  ..).r=...r<...r7
-000010c0: 0000 0063 0100 0000 0000 0000 0000 0000  ...c............
-000010d0: 0200 0000 0400 0000 5300 0000 7314 0000  ........S...s...
-000010e0: 0067 007c 005d 067d 017c 0164 0019 0091  .g.|.].}.|.d....
-000010f0: 0271 0253 0029 01e9 0500 0000 721b 0000  .q.S.)......r...
-00001100: 0072 3000 0000 721b 0000 0072 1b00 0000  .r0...r....r....
-00001110: 721c 0000 0072 2e00 0000 6a00 0000 7302  r....r....j...s.
-00001120: 0000 0014 007a 1052 6571 7565 7374 6564  .....z.Requested
-00001130: 206b 696e 6420 277a 1127 206e 6f74 2072   kind 'z.' not r
-00001140: 6563 6f67 6e69 7a65 642e 2910 720b 0000  ecognized.).r...
-00001150: 0072 0c00 0000 7222 0000 0072 2800 0000  .r....r"...r(...
-00001160: 7220 0000 00da 0768 6173 6174 7472 7226  r .....hasattrr&
-00001170: 0000 005a 1865 6e73 656d 626c 655f 7072  ...Z.ensemble_pr
-00001180: 6f70 6167 6174 655f 756e 7469 6c72 2700  opagate_untilr'.
-00001190: 0000 da07 7265 7375 6c74 7372 0e00 0000  ....resultsr....
-000011a0: 7212 0000 00da 0974 7261 6e73 706f 7365  r......transpose
-000011b0: 5a16 656e 7365 6d62 6c65 5f70 726f 7061  Z.ensemble_propa
-000011c0: 6761 7465 5f66 6f72 5a17 656e 7365 6d62  gate_forZ.ensemb
-000011d0: 6c65 5f70 726f 7061 6761 7465 5f67 7269  le_propagate_gri
-000011e0: 64da 0c52 756e 7469 6d65 4572 726f 7229  d..RuntimeError)
-000011f0: 0872 1300 0000 7216 0000 00da 046b 696e  .r....r......kin
-00001200: 6472 1500 0000 da04 6469 6d32 723d 0000  dr......dim2r=..
-00001210: 0072 2000 0000 723c 0000 0072 1b00 0000  .r ...r<...r....
-00001220: 723b 0000 0072 1c00 0000 da14 656e 7365  r;...r......ense
-00001230: 6d62 6c65 5f70 726f 7061 6761 7469 6f6e  mble_propagation
-00001240: 3700 0000 7322 0000 0012 1b0a 012a 010e  7...s".......*..
-00001250: 020a 0104 010c 0608 041a 011a 0108 011a  ................
-00001260: 011a 0108 0116 011a 0110 027a 2268 6579  ...........z"hey
-00001270: 6f6b 615f 736f 6c76 6572 2e65 6e73 656d  oka_solver.ensem
-00001280: 626c 655f 7072 6f70 6167 6174 696f 6e63  ble_propagationc
-00001290: 0100 0000 0000 0000 0000 0000 0800 0000  ................
-000012a0: 0600 0000 4f00 0000 7396 0000 0074 007c  ....O...s....t.|
-000012b0: 0183 0164 017c 006a 0114 006b 0273 184a  ...d.|.j...k.s.J
-000012c0: 0064 0274 007c 0183 019b 0064 0364 017c  .d.t.|.....d.d.|
-000012d0: 006a 0114 009b 009d 0483 0182 0174 02a0  .j...........t..
-000012e0: 037c 0164 047c 006a 0185 0219 00a1 0174  .|.d.|.j.......t
-000012f0: 02a0 037c 017c 006a 0164 0485 0219 00a1  ...|.|.j.d......
-00001300: 0102 027d 037d 0474 0474 02a0 0564 01a1  ...}.}.t.t...d..
-00001310: 0183 017d 057c 037c 0417 007c 051b 007d  ...}.|.|...|...}
-00001320: 067c 037c 0418 007c 051b 0064 051b 007d  .|.|...|...d...}
-00001330: 0774 026a 067c 067c 0767 0264 0664 078d  .t.j.|.|.g.d.d..
-00001340: 0253 00a9 087a 3f0a 2020 2020 2020 2020  .S...z?.        
-00001350: 4865 6c70 6572 2063 6c61 7373 2074 6f20  Helper class to 
-00001360: 6465 616c 2077 6974 6820 7573 6572 2d64  deal with user-d
-00001370: 6566 696e 6564 2069 6e70 7574 2e0a 2020  efined input..  
-00001380: 2020 2020 2020 7208 0000 007a 104c 656e        r....z.Len
-00001390: 6774 6820 6f66 2069 6e70 7574 207a 0c2c  gth of input z.,
-000013a0: 2065 7870 6563 7465 643a 204e 7209 0000   expected: Nr...
-000013b0: 0072 0100 0000 7205 0000 00a9 0772 0b00  .r....r......r..
-000013c0: 0000 7222 0000 0072 0e00 0000 7212 0000  ..r"...r....r...
-000013d0: 00da 0566 6c6f 6174 da04 7371 7274 720f  ...float..sqrtr.
-000013e0: 0000 0029 0872 1300 0000 da05 7869 6574  ...).r......xiet
-000013f0: 6172 1500 0000 da02 7869 da03 6574 61da  ar......xi..eta.
-00001400: 0573 7172 7432 da01 71da 0170 721b 0000  .sqrt2..q..pr...
-00001410: 0072 1b00 0000 721c 0000 0072 0a00 0000  .r....r....r....
-00001420: 6e00 0000 730c 0000 0030 042a 010e 010c  n...s....0.*....
-00001430: 0110 0112 017a 1768 6579 6f6b 615f 736f  .....z.heyoka_so
-00001440: 6c76 6572 2e5f 7869 6574 6132 7170 6301  lver._xieta2qpc.
-00001450: 0000 0000 0000 0000 0000 0008 0000 0006  ................
-00001460: 0000 004f 0000 0073 9a00 0000 7400 7c01  ...O...s....t.|.
-00001470: 8301 6401 7c00 6a01 1400 6b02 7318 4a00  ..d.|.j...k.s.J.
-00001480: 6402 7400 7c01 8301 9b00 6403 6401 7c00  d.t.|.....d.d.|.
-00001490: 6a01 1400 9b00 9d04 8301 8201 7402 a003  j...........t...
-000014a0: 7c01 6404 7c00 6a01 8502 1900 a101 7402  |.d.|.j.......t.
-000014b0: a003 7c01 7c00 6a01 6404 8502 1900 a101  ..|.|.j.d.......
-000014c0: 0202 7d03 7d04 7404 7402 a005 6401 a101  ..}.}.t.t...d...
-000014d0: 8301 7d05 7c03 7c04 6405 1400 1700 7c05  ..}.|.|.d.....|.
-000014e0: 1b00 7d06 7c03 7c04 6405 1400 1800 7c05  ..}.|.|.d.....|.
-000014f0: 1b00 7d07 7402 6a06 7c06 7c07 6702 6406  ..}.t.j.|.|.g.d.
-00001500: 6407 8d02 5300 724c 0000 0072 4d00 0000  d...S.rL...rM...
-00001510: 2908 7213 0000 0072 3400 0000 7215 0000  ).r....r4...r...
-00001520: 0072 5400 0000 7255 0000 0072 5300 0000  .rT...rU...rS...
-00001530: 7251 0000 0072 5200 0000 721b 0000 0072  rQ...rR...r....r
-00001540: 1b00 0000 721c 0000 0072 1100 0000 7900  ....r....r....y.
-00001550: 0000 730c 0000 0030 042a 010e 0110 0110  ..s....0.*......
-00001560: 0112 017a 1768 6579 6f6b 615f 736f 6c76  ...z.heyoka_solv
-00001570: 6572 2e5f 7170 3278 6965 7461 6301 0000  er._qp2xietac...
-00001580: 0000 0000 0000 0000 0003 0000 0004 0000  ................
-00001590: 004f 0000 0073 1000 0000 7c00 6a00 7c01  .O...s....|.j.|.
-000015a0: 6900 7c02 a401 8e01 5300 2901 612c 0300  i.|.....S.).a,..
-000015b0: 000a 2020 2020 2020 2020 4170 706c 7920  ..        Apply 
-000015c0: 7468 6520 736f 6c76 6572 206f 6e20 7374  the solver on st
-000015d0: 6172 7420 636f 6f72 6469 6e61 7465 733b  art coordinates;
-000015e0: 2074 6869 7320 6973 2061 2073 686f 7274   this is a short
-000015f0: 2d63 7574 2066 6f72 2063 616c 6c69 6e67  -cut for calling
-00001600: 0a20 2020 2020 2020 2073 656c 662e 656e  .        self.en
-00001610: 7365 6d62 6c65 5f70 726f 7061 6761 7469  semble_propagati
-00001620: 6f6e 2061 6e64 2075 7369 6e67 2073 656c  on and using sel
-00001630: 662e 5f78 6965 7461 3271 7020 616e 6420  f._xieta2qp and 
-00001640: 7365 6c66 2e5f 7170 3278 6965 7461 2068  self._qp2xieta h
-00001650: 656c 7065 7220 726f 7574 696e 6573 2e0a  elper routines..
-00001660: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
-00001670: 2046 6f72 2072 6570 6561 7465 6420 6170   For repeated ap
-00001680: 706c 6963 6174 696f 6e20 696e 7369 6465  plication inside
-00001690: 2061 206c 6f6f 702c 2074 6865 7365 2068   a loop, these h
-000016a0: 656c 7065 7220 726f 7574 696e 6573 2073  elper routines s
-000016b0: 686f 756c 6420 6265 200a 2020 2020 2020  hould be .      
-000016c0: 2020 6170 706c 6965 6420 696e 2066 726f    applied in fro
-000016d0: 6e74 2061 6e64 2062 6568 696e 6420 6f66  nt and behind of
-000016e0: 2074 6865 206c 6f6f 702e 0a20 2020 2020   the loop..     
-000016f0: 2020 200a 2020 2020 2020 2020 5061 7261     .        Para
-00001700: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-00001710: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00001720: 2020 2a78 6965 7461 303a 200a 2020 2020    *xieta0: .    
-00001730: 2020 2020 2020 2020 5374 6172 7420 7665          Start ve
-00001740: 6374 6f72 2873 290a 2020 2020 2020 2020  ctor(s).        
-00001750: 0a20 2020 2020 2020 2074 3a20 666c 6f61  .        t: floa
-00001760: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-00001770: 2020 2020 2020 2020 496e 7465 6772 6174          Integrat
-00001780: 696f 6e20 6c65 6e67 7468 2f69 6e74 6572  ion length/inter
-00001790: 7661 6c6c 0a20 2020 2020 2020 2020 2020  vall.           
-000017a0: 200a 2020 2020 2020 2020 7265 616c 3a20   .        real: 
-000017b0: 626f 6f6c 6561 6e2c 206f 7074 696f 6e61  boolean, optiona
-000017c0: 6c0a 2020 2020 2020 2020 2020 2020 4966  l.            If
-000017d0: 2054 7275 652c 2061 7373 756d 6520 7468   True, assume th
-000017e0: 6520 696e 7075 7420 6172 6520 7265 616c  e input are real
-000017f0: 2d76 616c 7565 6420 7120 616e 6420 7020  -valued q and p 
-00001800: 7661 6c75 6573 2e20 4966 2046 616c 7365  values. If False
-00001810: 2c20 6173 7375 6d65 2074 6865 2069 6e70  , assume the inp
-00001820: 7574 0a20 2020 2020 2020 2020 2020 2069  ut.            i
-00001830: 7320 6769 7665 6e20 696e 2074 6572 6d73  s given in terms
-00001840: 206f 6620 2863 6f6d 706c 6578 2920 7869   of (complex) xi
-00001850: 2061 6e64 2065 7461 2076 616c 7565 732e   and eta values.
-00001860: 0a20 2020 2020 2020 2020 2020 200a 2020  .            .  
-00001870: 2020 2020 2020 2a2a 6b77 6172 6773 0a20        **kwargs. 
-00001880: 2020 2020 2020 2020 2020 204f 7074 696f             Optio
-00001890: 6e61 6c20 6b65 7977 6f72 6465 6420 6172  nal keyworded ar
-000018a0: 6775 6d65 6e74 7320 7061 7373 6564 2074  guments passed t
-000018b0: 6f20 7365 6c66 2e65 6e73 656d 626c 655f  o self.ensemble_
-000018c0: 7072 6f70 6167 6174 696f 6e20 726f 7574  propagation rout
-000018d0: 696e 652e 0a20 2020 2020 2020 2029 0172  ine..        ).r
-000018e0: 4b00 0000 2903 7213 0000 0072 1400 0000  K...).r....r....
-000018f0: 7215 0000 0072 1b00 0000 721b 0000 0072  r....r....r....r
-00001900: 1c00 0000 da08 5f5f 6361 6c6c 5f5f 8400  ......__call__..
-00001910: 0000 7302 0000 0010 177a 1668 6579 6f6b  ..s......z.heyok
-00001920: 615f 736f 6c76 6572 2e5f 5f63 616c 6c5f  a_solver.__call_
-00001930: 5f4e 2901 7235 0000 0029 0ada 085f 5f6e  _N).r5...)...__n
-00001940: 616d 655f 5fda 0a5f 5f6d 6f64 756c 655f  ame__..__module_
-00001950: 5fda 0c5f 5f71 7561 6c6e 616d 655f 5f72  _..__qualname__r
-00001960: 2900 0000 7223 0000 0072 1e00 0000 724b  )...r#...r....rK
-00001970: 0000 0072 0a00 0000 7211 0000 0072 5600  ...r....r....rV.
-00001980: 0000 721b 0000 0072 1b00 0000 721b 0000  ..r....r....r...
-00001990: 0072 1c00 0000 721f 0000 001d 0000 0073  .r....r........s
-000019a0: 1000 0000 0800 0802 0807 0211 0c01 0836  ...............6
-000019b0: 080b 0c0b 721f 0000 0029 08da 0668 6579  ....r....)...hey
-000019c0: 6f6b 6172 2600 0000 da05 6e75 6d70 7972  okar&.....numpyr
-000019d0: 0e00 0000 da06 636f 6d6d 6f6e 7203 0000  ......commonr...
-000019e0: 0072 1e00 0000 721f 0000 0072 1b00 0000  .r....r....r....
-000019f0: 721b 0000 0072 1b00 0000 721c 0000 00da  r....r....r.....
-00001a00: 083c 6d6f 6475 6c65 3e01 0000 0073 0a00  .<module>....s..
-00001a10: 0000 0800 0801 0c02 0802 1217            ............
+000002e0: 6f75 74a9 01da 0466 756e 63a9 00fa 2e2f  out....func..../
+000002f0: 686f 6d65 2f6d 616c 7465 2f67 6974 2f6c  home/malte/git/l
+00000300: 6965 6f70 732f 6c69 656f 7073 2f73 6f6c  ieops/lieops/sol
+00000310: 7665 722f 6865 796f 6b61 2e70 79da 0778  ver/heyoka.py..x
+00000320: 6965 7461 7170 0a00 0000 731c 0000 0004  ietaqp....s.....
+00000330: 010a 020e 0112 0116 0112 0138 010a 0104  ...........8....
+00000340: 060c fc0e 0112 0112 0104 017a 1474 7266  ...........z.trf
+00000350: 2e3c 6c6f 6361 6c73 3e2e 7869 6574 6171  .<locals>.xietaq
+00000360: 7072 1b00 0000 2902 721a 0000 0072 1d00  pr....).r....r..
+00000370: 0000 721b 0000 0072 1900 0000 721c 0000  ..r....r....r...
+00000380: 00da 0374 7266 0600 0000 7304 0000 0012  ...trf....s.....
+00000390: 0404 1072 1e00 0000 6300 0000 0000 0000  ...r....c.......
+000003a0: 0000 0000 0000 0000 0004 0000 0040 0000  .............@..
+000003b0: 0073 4200 0000 6500 5a01 6400 5a02 6401  .sB...e.Z.d.Z.d.
+000003c0: 6402 8400 5a03 6403 6404 8400 5a04 6505  d...Z.d.d...Z.e.
+000003d0: 640f 6406 6407 8401 8301 5a06 6408 6409  d.d.d.....Z.d.d.
+000003e0: 8400 5a07 640a 640b 8400 5a08 640c 640d  ..Z.d.d...Z.d.d.
+000003f0: 8400 5a09 640e 5300 2910 da0d 6865 796f  ..Z.d.S.)...heyo
+00000400: 6b61 5f73 6f6c 7665 7263 0200 0000 0000  ka_solverc......
+00000410: 0000 0000 0000 0300 0000 0500 0000 4b00  ..............K.
+00000420: 0000 735c 0000 007c 010b 007c 005f 007c  ..s\...|...|._.|
+00000430: 006a 006a 017c 005f 017c 006a 0264 0569  .j.j.|._.|.j.d.i
+00000440: 007c 02a4 018e 015c 037c 005f 037c 005f  .|.....\.|._.|._
+00000450: 047c 005f 0574 06a0 077c 006a 0464 0167  .|._.t...|.j.d.g
+00000460: 017c 006a 0114 0064 0214 00a1 027c 005f  .|.j...d.....|._
+00000470: 087c 02a0 0964 0364 04a1 027c 005f 0a64  .|...d.d...|._.d
+00000480: 0053 0029 064e 7201 0000 0072 0800 0000  .S.).Nr....r....
+00000490: da01 7472 0200 0000 721b 0000 0029 0bda  ..tr....r....)..
+000004a0: 0b68 616d 696c 746f 6e69 616e da03 6469  .hamiltonian..di
+000004b0: 6dda 0e67 6574 4861 6d69 6c74 6f6e 4571  m..getHamiltonEq
+000004c0: 73da 0976 6172 6961 626c 6573 da06 6861  s..variables..ha
+000004d0: 6d65 7173 5a0f 7265 616c 4861 6d69 6c74  meqsZ.realHamilt
+000004e0: 6f6e 6961 6eda 0268 795a 0f74 6179 6c6f  onian..hyZ.taylo
+000004f0: 725f 6164 6170 7469 7665 da0a 696e 7465  r_adaptive..inte
+00000500: 6772 6174 6f72 da03 6765 7472 2000 0000  grator..getr ...
+00000510: 2903 7213 0000 0072 2100 0000 7215 0000  ).r....r!...r...
+00000520: 0072 1b00 0000 721b 0000 0072 1c00 0000  .r....r....r....
+00000530: da08 5f5f 696e 6974 5f5f 1f00 0000 730a  ..__init__....s.
+00000540: 0000 0008 010a 011c 011c 0112 017a 1668  .............z.h
+00000550: 6579 6f6b 615f 736f 6c76 6572 2e5f 5f69  eyoka_solver.__i
+00000560: 6e69 745f 5f63 0100 0000 0000 0000 0000  nit__c..........
+00000570: 0000 0600 0000 0500 0000 4b00 0000 7370  ..........K...sp
+00000580: 0000 0074 006a 0164 0164 0284 0074 027c  ...t.j.d.d...t.|
+00000590: 006a 0383 0144 0083 0164 0364 0284 0074  .j...D...d.d...t
+000005a0: 027c 006a 0383 0144 0083 0117 008e 007d  .|.j...D.......}
+000005b0: 0264 047c 0164 053c 0074 047c 006a 0566  .d.|.d.<.t.|.j.f
+000005c0: 0169 007c 01a4 018e 015c 027d 037d 047c  .i.|.....\.}.}.|
+000005d0: 037c 028e 007d 057c 0264 0664 0284 0074  .|...}.|.d.d...t
+000005e0: 067c 027c 0567 028e 0044 0083 017c 0466  .|.|.g...D...|.f
+000005f0: 0353 0029 077a f10a 2020 2020 2020 2020  .S.).z..        
+00000600: 436f 6d70 7574 6520 7468 6520 4861 6d69  Compute the Hami
+00000610: 6c74 6f6e 2065 7175 6174 696f 6e73 2066  lton equations f
+00000620: 726f 6d20 7468 6520 6769 7665 6e20 4861  rom the given Ha
+00000630: 6d69 6c74 6f6e 6961 6e20 2873 656c 662e  miltonian (self.
+00000640: 6861 6d69 6c74 6f6e 6961 6e29 2e0a 2020  hamiltonian)..  
+00000650: 2020 2020 2020 0a0a 2020 2020 2020 2020        ..        
+00000660: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+00000670: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00000680: 6469 6374 0a20 2020 2020 2020 2020 2020  dict.           
+00000690: 2041 2064 6963 7469 6f6e 6172 7920 636f   A dictionary co
+000006a0: 6e74 6169 6e69 6e67 2074 6865 2072 6561  ntaining the rea
+000006b0: 6c20 4861 6d69 6c74 6f6e 2065 7175 6174  l Hamilton equat
+000006c0: 696f 6e73 2061 6e64 2074 6865 2069 6e74  ions and the int
+000006d0: 6567 7261 7469 6f6e 2073 7465 7073 2e0a  egration steps..
+000006e0: 2020 2020 2020 2020 6301 0000 0000 0000          c.......
+000006f0: 0000 0000 0002 0000 0004 0000 0053 0000  .............S..
+00000700: 00f3 1600 0000 6700 7c00 5d07 7d01 6400  ......g.|.].}.d.
+00000710: 7c01 9b00 9d02 9102 7102 5300 2901 5a07  |.......q.S.).Z.
+00000720: 636f 6f72 645f 7172 1b00 0000 a902 da02  coord_qr........
+00000730: 2e30 da01 6b72 1b00 0000 721b 0000 0072  .0..kr....r....r
+00000740: 1c00 0000 da0a 3c6c 6973 7463 6f6d 703e  ......<listcomp>
+00000750: 3000 0000 f302 0000 0016 007a 3068 6579  0..........z0hey
+00000760: 6f6b 615f 736f 6c76 6572 2e67 6574 4861  oka_solver.getHa
+00000770: 6d69 6c74 6f6e 4571 732e 3c6c 6f63 616c  miltonEqs.<local
+00000780: 733e 2e3c 6c69 7374 636f 6d70 3e63 0100  s>.<listcomp>c..
+00000790: 0000 0000 0000 0000 0000 0200 0000 0400  ................
+000007a0: 0000 5300 0000 722a 0000 0029 015a 0763  ..S...r*...).Z.c
+000007b0: 6f6f 7264 5f70 721b 0000 0072 2b00 0000  oord_pr....r+...
+000007c0: 721b 0000 0072 1b00 0000 721c 0000 0072  r....r....r....r
+000007d0: 2e00 0000 3100 0000 722f 0000 0054 7204  ....1...r/...Tr.
+000007e0: 0000 0063 0100 0000 0000 0000 0000 0000  ...c............
+000007f0: 0200 0000 0300 0000 5300 0000 7310 0000  ........S...s...
+00000800: 0067 007c 005d 047d 017c 0191 0271 0253  .g.|.].}.|...q.S
+00000810: 0072 1b00 0000 721b 0000 00a9 0272 2c00  .r....r......r,.
+00000820: 0000 da01 6572 1b00 0000 721b 0000 0072  ....er....r....r
+00000830: 1c00 0000 722e 0000 0035 0000 0073 0200  ....r....5...s..
+00000840: 0000 1000 2907 7226 0000 005a 096d 616b  ....).r&...Z.mak
+00000850: 655f 7661 7273 da05 7261 6e67 6572 2200  e_vars..ranger".
+00000860: 0000 7203 0000 0072 2100 0000 da03 7a69  ..r....r!.....zi
+00000870: 7029 0672 1300 0000 7215 0000 00da 0271  p).r....r......q
+00000880: 7072 2500 0000 5a04 7268 616d 5a09 6861  pr%...Z.rhamZ.ha
+00000890: 6d65 7173 5f68 7972 1b00 0000 721b 0000  meqs_hyr....r...
+000008a0: 0072 1c00 0000 7223 0000 0026 0000 0073  .r....r#...&...s
+000008b0: 0e00 0000 160a 1201 06ff 0802 1601 0801  ................
+000008c0: 1c01 7a1c 6865 796f 6b61 5f73 6f6c 7665  ..z.heyoka_solve
+000008d0: 722e 6765 7448 616d 696c 746f 6e45 7173  r.getHamiltonEqs
+000008e0: da05 756e 7469 6c63 0300 0000 0000 0000  ..untilc........
+000008f0: 0000 0000 0800 0000 0800 0000 0b00 0000  ................
+00000900: 732e 0100 0074 0088 006a 0183 0164 016b  s....t...j...d.k
+00000910: 0273 094a 0082 0188 006a 015c 027d 047d  .s.J.....j.\.}.}
+00000920: 057c 0464 011a 007c 006a 026b 0273 234a  .|.d...|.j.k.s#J
+00000930: 0064 027c 0464 011a 009b 0064 037c 006a  .d.|.d.....d.|.j
+00000940: 029b 0064 049d 0583 0182 017c 03a0 0364  ...d.......|...d
+00000950: 057c 006a 04a1 027d 0674 057c 0664 0683  .|.j...}.t.|.d..
+00000960: 0272 3164 077d 0287 0066 0164 0864 0984  .r1d.}...f.d.d..
+00000970: 087d 077c 0264 0a6b 0272 5574 066a 077c  .}.|.d.k.rUt.j.|
+00000980: 006a 087c 057c 077c 0664 0b64 0b64 0c8d  .j.|.|.|.d.d.d..
+00000990: 067c 005f 0974 0aa0 0b64 0d64 0e84 007c  .|._.t...d.d...|
+000009a0: 006a 0944 0083 01a1 01a0 0ca1 0053 007c  .j.D.........S.|
+000009b0: 0264 0f6b 0272 7374 066a 0d7c 006a 087c  .d.k.rst.j.|.j.|
+000009c0: 057c 077c 0664 0b64 0b64 108d 067c 005f  .|.|.d.d.d...|._
+000009d0: 0974 0aa0 0b64 1164 0e84 007c 006a 0944  .t...d.d...|.j.D
+000009e0: 0083 01a1 01a0 0ca1 0053 007c 0264 076b  .........S.|.d.k
+000009f0: 0272 8f74 066a 0e7c 006a 087c 057c 077c  .r.t.j.|.j.|.|.|
+00000a00: 0664 128d 047c 005f 0974 0aa0 0b64 1364  .d...|._.t...d.d
+00000a10: 0e84 007c 006a 0944 0083 01a1 01a0 0ca1  ...|.j.D........
+00000a20: 0053 0074 0f64 147c 029b 0064 159d 0383  .S.t.d.|...d....
+00000a30: 0182 0129 1661 0804 0000 0a20 2020 2020  ...).a.....     
+00000a40: 2020 2045 6e73 656d 626c 6520 7072 6f70     Ensemble prop
+00000a50: 6167 6174 696f 6e20 6163 636f 7264 696e  agation accordin
+00000a60: 6720 746f 2068 7474 7073 3a2f 2f62 6c75  g to https://blu
+00000a70: 6573 6361 726e 692e 6769 7468 7562 2e69  escarni.github.i
+00000a80: 6f2f 6865 796f 6b61 2f74 7574 5f65 6e73  o/heyoka/tut_ens
+00000a90: 656d 626c 652e 6874 6d6c 0a20 2020 2020  emble.html.     
+00000aa0: 2020 200a 2020 2020 2020 2020 5061 7261     .        Para
+00000ab0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+00000ac0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00000ad0: 2020 7170 303a 2061 7272 6179 2d6c 696b    qp0: array-lik
+00000ae0: 6520 6f66 2073 6861 7065 2028 4b2c 2032  e of shape (K, 2
+00000af0: 2a64 696d 2920 0a20 2020 2020 2020 2020  *dim) .         
+00000b00: 2020 2049 6e70 7574 2076 6563 746f 7228     Input vector(
+00000b10: 7329 2064 656e 6f74 696e 6720 7468 6520  s) denoting the 
+00000b20: 636f 6f72 6469 6e61 7465 732e 2054 6865  coordinates. The
+00000b30: 206e 756d 6265 7220 274b 2720 6465 6e6f   number 'K' deno
+00000b40: 7465 7320 7468 6520 6e75 6d62 6572 206f  tes the number o
+00000b50: 6620 6469 6666 6572 656e 740a 2020 2020  f different.    
+00000b60: 2020 2020 2020 2020 7665 6374 6f72 7320          vectors 
+00000b70: 746f 2062 6520 7472 6163 6b65 642c 2077  to be tracked, w
+00000b80: 6869 6c65 2027 6469 6d27 206d 7573 7420  hile 'dim' must 
+00000b90: 636f 7272 6573 706f 6e64 2074 6f20 7468  correspond to th
+00000ba0: 6520 6469 6d65 6e73 696f 6e20 6f66 2074  e dimension of t
+00000bb0: 6865 2063 7572 7265 6e74 2068 616d 696c  he current hamil
+00000bc0: 746f 6e69 616e 2e0a 2020 2020 2020 2020  tonian..        
+00000bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000be0: 0a20 2020 2020 2020 206b 696e 643a 2073  .        kind: s
+00000bf0: 7472 2c20 6f70 7469 6f6e 616c 0a20 2020  tr, optional.   
+00000c00: 2020 2020 2020 2020 2041 2073 7472 696e           A strin
+00000c10: 6720 6465 6e6f 7469 6e67 2074 6865 2074  g denoting the t
+00000c20: 7970 6520 6f66 2069 6e74 6567 7261 7469  ype of integrati
+00000c30: 6f6e 2c20 6361 6c6c 696e 6720 7468 6520  on, calling the 
+00000c40: 7468 7265 6520 706f 7373 6962 6c65 2069  three possible i
+00000c50: 6e74 6567 7261 7469 6f6e 2072 6f75 7469  ntegration routi
+00000c60: 6e65 730a 2020 2020 2020 2020 2020 2020  nes.            
+00000c70: 696e 2048 6579 6f6b 6120 2873 6565 2068  in Heyoka (see h
+00000c80: 7474 7073 3a2f 2f62 6c75 6573 6361 726e  ttps://bluescarn
+00000c90: 692e 6769 7468 7562 2e69 6f2f 6865 796f  i.github.io/heyo
+00000ca0: 6b61 2f74 7574 5f65 6e73 656d 626c 652e  ka/tut_ensemble.
+00000cb0: 6874 6d6c 290a 2020 2020 2020 2020 2020  html).          
+00000cc0: 2020 2775 6e74 696c 273a 2074 7261 636b    'until': track
+00000cd0: 2066 726f 6d20 3020 756e 7469 6c20 740a   from 0 until t.
+00000ce0: 2020 2020 2020 2020 2020 2020 2766 6f72              'for
+00000cf0: 273a 2074 7261 636b 2066 726f 6d20 7430  ': track from t0
+00000d00: 2075 6e74 696c 2074 3020 2b20 740a 2020   until t0 + t.  
+00000d10: 2020 2020 2020 2020 2020 2767 7269 6427            'grid'
+00000d20: 3a20 7472 6163 6b20 6120 6772 6964 2e0a  : track a grid..
+00000d30: 2020 2020 2020 2020 2020 2020 0a20 2020              .   
+00000d40: 2020 2020 202a 2a6b 7761 7267 730a 2020       **kwargs.  
+00000d50: 2020 2020 2020 2020 2020 4f70 7469 6f6e            Option
+00000d60: 616c 206b 6579 776f 7264 6564 2061 7267  al keyworded arg
+00000d70: 756d 656e 7473 2070 6173 7365 6420 746f  uments passed to
+00000d80: 2074 6865 2068 6579 6f6b 6120 656e 7365   the heyoka ense
+00000d90: 6d62 6c65 5f70 726f 7061 6761 7465 5f2a  mble_propagate_*
+00000da0: 2072 6f75 7469 6e65 732e 0a20 2020 2020   routines..     
+00000db0: 2020 2020 2020 200a 2020 2020 2020 2020         .        
+00000dc0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+00000dd0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00000de0: 7265 740a 2020 2020 2020 2020 2020 2020  ret.            
+00000df0: 4f62 6a65 6374 2061 6363 6f72 6469 6e67  Object according
+00000e00: 2074 6f20 6874 7470 733a 2f2f 626c 7565   to https://blue
+00000e10: 7363 6172 6e69 2e67 6974 6875 622e 696f  scarni.github.io
+00000e20: 2f68 6579 6f6b 612f 7475 745f 656e 7365  /heyoka/tut_ense
+00000e30: 6d62 6c65 2e68 746d 6c0a 2020 2020 2020  mble.html.      
+00000e40: 2020 7208 0000 007a 1749 6e70 7574 2076    r....z.Input v
+00000e50: 6563 746f 7220 6469 6d65 6e73 696f 6e20  ector dimension 
+00000e60: 7a1f 206e 6f74 2063 6f6e 7369 7374 656e  z. not consisten
+00000e70: 7420 7769 7468 2064 696d 656e 7369 6f6e  t with dimension
+00000e80: 207a 1620 6f66 2067 6976 656e 2048 616d   z. of given Ham
+00000e90: 696c 746f 6e69 616e 2e72 2000 0000 da08  iltonian.r .....
+00000ea0: 5f5f 6974 6572 5f5f da04 6772 6964 6302  __iter__..gridc.
+00000eb0: 0000 0000 0000 0000 0000 0002 0000 0004  ................
+00000ec0: 0000 0013 0000 0073 1e00 0000 8800 6400  .......s......d.
+00000ed0: 6400 8502 7c01 6602 1900 7c00 6a00 6400  d...|.f...|.j.d.
+00000ee0: 6400 8502 3c00 7c00 5300 2901 4ea9 01da  d...<.|.S.).N...
+00000ef0: 0573 7461 7465 2902 5a04 7461 6370 da01  .state).Z.tacp..
+00000f00: 69a9 0172 1600 0000 721b 0000 0072 1c00  i..r....r....r..
+00000f10: 0000 da03 6765 6e5e 0000 0073 0400 0000  ....gen^...s....
+00000f20: 1a01 0401 7a2f 6865 796f 6b61 5f73 6f6c  ....z/heyoka_sol
+00000f30: 7665 722e 656e 7365 6d62 6c65 5f70 726f  ver.ensemble_pro
+00000f40: 7061 6761 7469 6f6e 2e3c 6c6f 6361 6c73  pagation.<locals
+00000f50: 3e2e 6765 6e72 3500 0000 5429 05da 066e  >.genr5...T)...n
+00000f60: 5f69 7465 7272 3c00 0000 7220 0000 00da  _iterr<...r ....
+00000f70: 0877 7269 7465 5f74 63da 0863 5f6f 7574  .write_tc..c_out
+00000f80: 7075 7463 0100 0000 0000 0000 0000 0000  putc............
+00000f90: 0200 0000 0400 0000 5300 0000 f316 0000  ........S.......
+00000fa0: 0067 007c 005d 077d 017c 0164 0019 006a  .g.|.].}.|.d...j
+00000fb0: 0091 0271 0253 00a9 0172 0100 0000 7238  ...q.S...r....r8
+00000fc0: 0000 0072 3000 0000 721b 0000 0072 1b00  ...r0...r....r..
+00000fd0: 0000 721c 0000 0072 2e00 0000 6400 0000  ..r....r....d...
+00000fe0: 722f 0000 007a 3668 6579 6f6b 615f 736f  r/...z6heyoka_so
+00000ff0: 6c76 6572 2e65 6e73 656d 626c 655f 7072  lver.ensemble_pr
+00001000: 6f70 6167 6174 696f 6e2e 3c6c 6f63 616c  opagation.<local
+00001010: 733e 2e3c 6c69 7374 636f 6d70 3eda 0366  s>.<listcomp>..f
+00001020: 6f72 2905 723d 0000 0072 3c00 0000 da07  or).r=...r<.....
+00001030: 6465 6c74 615f 7472 3e00 0000 723f 0000  delta_tr>...r?..
+00001040: 0063 0100 0000 0000 0000 0000 0000 0200  .c..............
+00001050: 0000 0400 0000 5300 0000 7240 0000 0072  ......S...r@...r
+00001060: 4100 0000 7238 0000 0072 3000 0000 721b  A...r8...r0...r.
+00001070: 0000 0072 1b00 0000 721c 0000 0072 2e00  ...r....r....r..
+00001080: 0000 6700 0000 722f 0000 0029 0372 3d00  ..g...r/...).r=.
+00001090: 0000 723c 0000 0072 3700 0000 6301 0000  ..r<...r7...c...
+000010a0: 0000 0000 0000 0000 0002 0000 0004 0000  ................
+000010b0: 0053 0000 0073 1400 0000 6700 7c00 5d06  .S...s....g.|.].
+000010c0: 7d01 7c01 6400 1900 9102 7102 5300 2901  }.|.d.....q.S.).
+000010d0: e905 0000 0072 1b00 0000 7230 0000 0072  .....r....r0...r
+000010e0: 1b00 0000 721b 0000 0072 1c00 0000 722e  ....r....r....r.
+000010f0: 0000 006a 0000 0073 0200 0000 1400 7a10  ...j...s......z.
+00001100: 5265 7175 6573 7465 6420 6b69 6e64 2027  Requested kind '
+00001110: 7a11 2720 6e6f 7420 7265 636f 676e 697a  z.' not recogniz
+00001120: 6564 2e29 1072 0b00 0000 720c 0000 0072  ed.).r....r....r
+00001130: 2200 0000 7228 0000 0072 2000 0000 da07  "...r(...r .....
+00001140: 6861 7361 7474 7272 2600 0000 5a18 656e  hasattrr&...Z.en
+00001150: 7365 6d62 6c65 5f70 726f 7061 6761 7465  semble_propagate
+00001160: 5f75 6e74 696c 7227 0000 00da 0772 6573  _untilr'.....res
+00001170: 756c 7473 720e 0000 0072 1200 0000 da09  ultsr....r......
+00001180: 7472 616e 7370 6f73 655a 1665 6e73 656d  transposeZ.ensem
+00001190: 626c 655f 7072 6f70 6167 6174 655f 666f  ble_propagate_fo
+000011a0: 725a 1765 6e73 656d 626c 655f 7072 6f70  rZ.ensemble_prop
+000011b0: 6167 6174 655f 6772 6964 da0c 5275 6e74  agate_grid..Runt
+000011c0: 696d 6545 7272 6f72 2908 7213 0000 0072  imeError).r....r
+000011d0: 1600 0000 da04 6b69 6e64 7215 0000 00da  ......kindr.....
+000011e0: 0464 696d 3272 3d00 0000 7220 0000 0072  .dim2r=...r ...r
+000011f0: 3c00 0000 721b 0000 0072 3b00 0000 721c  <...r....r;...r.
+00001200: 0000 00da 1465 6e73 656d 626c 655f 7072  .....ensemble_pr
+00001210: 6f70 6167 6174 696f 6e37 0000 0073 2200  opagation7...s".
+00001220: 0000 121b 0a01 2a01 0e02 0a01 0401 0c06  ......*.........
+00001230: 0804 1a01 1a01 0801 1a01 1a01 0801 1601  ................
+00001240: 1a01 1002 7a22 6865 796f 6b61 5f73 6f6c  ....z"heyoka_sol
+00001250: 7665 722e 656e 7365 6d62 6c65 5f70 726f  ver.ensemble_pro
+00001260: 7061 6761 7469 6f6e 6301 0000 0000 0000  pagationc.......
+00001270: 0000 0000 0008 0000 0006 0000 004f 0000  .............O..
+00001280: 0073 9600 0000 7400 7c01 8301 6401 7c00  .s....t.|...d.|.
+00001290: 6a01 1400 6b02 7318 4a00 6402 7400 7c01  j...k.s.J.d.t.|.
+000012a0: 8301 9b00 6403 6401 7c00 6a01 1400 9b00  ....d.d.|.j.....
+000012b0: 9d04 8301 8201 7402 a003 7c01 6404 7c00  ......t...|.d.|.
+000012c0: 6a01 8502 1900 a101 7402 a003 7c01 7c00  j.......t...|.|.
+000012d0: 6a01 6404 8502 1900 a101 0202 7d03 7d04  j.d.........}.}.
+000012e0: 7404 7402 a005 6401 a101 8301 7d05 7c03  t.t...d.....}.|.
+000012f0: 7c04 1700 7c05 1b00 7d06 7c03 7c04 1800  |...|...}.|.|...
+00001300: 7c05 1b00 6405 1b00 7d07 7402 6a06 7c06  |...d...}.t.j.|.
+00001310: 7c07 6702 6406 6407 8d02 5300 a908 7a3f  |.g.d.d...S...z?
+00001320: 0a20 2020 2020 2020 2048 656c 7065 7220  .        Helper 
+00001330: 636c 6173 7320 746f 2064 6561 6c20 7769  class to deal wi
+00001340: 7468 2075 7365 722d 6465 6669 6e65 6420  th user-defined 
+00001350: 696e 7075 742e 0a20 2020 2020 2020 2072  input..        r
+00001360: 0800 0000 7a10 4c65 6e67 7468 206f 6620  ....z.Length of 
+00001370: 696e 7075 7420 7a0c 2c20 6578 7065 6374  input z., expect
+00001380: 6564 3a20 4e72 0900 0000 7201 0000 0072  ed: Nr....r....r
+00001390: 0500 0000 a907 720b 0000 0072 2200 0000  ......r....r"...
+000013a0: 720e 0000 0072 1200 0000 da05 666c 6f61  r....r......floa
+000013b0: 74da 0473 7172 7472 0f00 0000 2908 7213  t..sqrtr....).r.
+000013c0: 0000 00da 0578 6965 7461 7215 0000 00da  .....xietar.....
+000013d0: 0278 69da 0365 7461 da05 7371 7274 32da  .xi..eta..sqrt2.
+000013e0: 0171 da01 7072 1b00 0000 721b 0000 0072  .q..pr....r....r
+000013f0: 1c00 0000 720a 0000 006e 0000 0073 0c00  ....r....n...s..
+00001400: 0000 3004 2a01 0e01 0c01 1001 1201 7a17  ..0.*.........z.
+00001410: 6865 796f 6b61 5f73 6f6c 7665 722e 5f78  heyoka_solver._x
+00001420: 6965 7461 3271 7063 0100 0000 0000 0000  ieta2qpc........
+00001430: 0000 0000 0800 0000 0600 0000 4f00 0000  ............O...
+00001440: 739a 0000 0074 007c 0183 0164 017c 006a  s....t.|...d.|.j
+00001450: 0114 006b 0273 184a 0064 0274 007c 0183  ...k.s.J.d.t.|..
+00001460: 019b 0064 0364 017c 006a 0114 009b 009d  ...d.d.|.j......
+00001470: 0483 0182 0174 02a0 037c 0164 047c 006a  .....t...|.d.|.j
+00001480: 0185 0219 00a1 0174 02a0 037c 017c 006a  .......t...|.|.j
+00001490: 0164 0485 0219 00a1 0102 027d 037d 0474  .d.........}.}.t
+000014a0: 0474 02a0 0564 01a1 0183 017d 057c 037c  .t...d.....}.|.|
+000014b0: 0464 0514 0017 007c 051b 007d 067c 037c  .d.....|...}.|.|
+000014c0: 0464 0514 0018 007c 051b 007d 0774 026a  .d.....|...}.t.j
+000014d0: 067c 067c 0767 0264 0664 078d 0253 0072  .|.|.g.d.d...S.r
+000014e0: 4c00 0000 724d 0000 0029 0872 1300 0000  L...rM...).r....
+000014f0: 7234 0000 0072 1500 0000 7254 0000 0072  r4...r....rT...r
+00001500: 5500 0000 7253 0000 0072 5100 0000 7252  U...rS...rQ...rR
+00001510: 0000 0072 1b00 0000 721b 0000 0072 1c00  ...r....r....r..
+00001520: 0000 7211 0000 0079 0000 0073 0c00 0000  ..r....y...s....
+00001530: 3004 2a01 0e01 1001 1001 1201 7a17 6865  0.*.........z.he
+00001540: 796f 6b61 5f73 6f6c 7665 722e 5f71 7032  yoka_solver._qp2
+00001550: 7869 6574 6163 0100 0000 0000 0000 0000  xietac..........
+00001560: 0000 0300 0000 0400 0000 4f00 0000 7310  ..........O...s.
+00001570: 0000 007c 006a 007c 0169 007c 02a4 018e  ...|.j.|.i.|....
+00001580: 0153 0029 0161 2c03 0000 0a20 2020 2020  .S.).a,....     
+00001590: 2020 2041 7070 6c79 2074 6865 2073 6f6c     Apply the sol
+000015a0: 7665 7220 6f6e 2073 7461 7274 2063 6f6f  ver on start coo
+000015b0: 7264 696e 6174 6573 3b20 7468 6973 2069  rdinates; this i
+000015c0: 7320 6120 7368 6f72 742d 6375 7420 666f  s a short-cut fo
+000015d0: 7220 6361 6c6c 696e 670a 2020 2020 2020  r calling.      
+000015e0: 2020 7365 6c66 2e65 6e73 656d 626c 655f    self.ensemble_
+000015f0: 7072 6f70 6167 6174 696f 6e20 616e 6420  propagation and 
+00001600: 7573 696e 6720 7365 6c66 2e5f 7869 6574  using self._xiet
+00001610: 6132 7170 2061 6e64 2073 656c 662e 5f71  a2qp and self._q
+00001620: 7032 7869 6574 6120 6865 6c70 6572 2072  p2xieta helper r
+00001630: 6f75 7469 6e65 732e 0a20 2020 2020 2020  outines..       
+00001640: 200a 2020 2020 2020 2020 466f 7220 7265   .        For re
+00001650: 7065 6174 6564 2061 7070 6c69 6361 7469  peated applicati
+00001660: 6f6e 2069 6e73 6964 6520 6120 6c6f 6f70  on inside a loop
+00001670: 2c20 7468 6573 6520 6865 6c70 6572 2072  , these helper r
+00001680: 6f75 7469 6e65 7320 7368 6f75 6c64 2062  outines should b
+00001690: 6520 0a20 2020 2020 2020 2061 7070 6c69  e .        appli
+000016a0: 6564 2069 6e20 6672 6f6e 7420 616e 6420  ed in front and 
+000016b0: 6265 6869 6e64 206f 6620 7468 6520 6c6f  behind of the lo
+000016c0: 6f70 2e0a 2020 2020 2020 2020 0a20 2020  op..        .   
+000016d0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+000016e0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000016f0: 2d2d 0a20 2020 2020 2020 202a 7869 6574  --.        *xiet
+00001700: 6130 3a20 0a20 2020 2020 2020 2020 2020  a0: .           
+00001710: 2053 7461 7274 2076 6563 746f 7228 7329   Start vector(s)
+00001720: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00001730: 2020 743a 2066 6c6f 6174 2c20 6f70 7469    t: float, opti
+00001740: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+00001750: 2049 6e74 6567 7261 7469 6f6e 206c 656e   Integration len
+00001760: 6774 682f 696e 7465 7276 616c 6c0a 2020  gth/intervall.  
+00001770: 2020 2020 2020 2020 2020 0a20 2020 2020            .     
+00001780: 2020 2072 6561 6c3a 2062 6f6f 6c65 616e     real: boolean
+00001790: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+000017a0: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
+000017b0: 6173 7375 6d65 2074 6865 2069 6e70 7574  assume the input
+000017c0: 2061 7265 2072 6561 6c2d 7661 6c75 6564   are real-valued
+000017d0: 2071 2061 6e64 2070 2076 616c 7565 732e   q and p values.
+000017e0: 2049 6620 4661 6c73 652c 2061 7373 756d   If False, assum
+000017f0: 6520 7468 6520 696e 7075 740a 2020 2020  e the input.    
+00001800: 2020 2020 2020 2020 6973 2067 6976 656e          is given
+00001810: 2069 6e20 7465 726d 7320 6f66 2028 636f   in terms of (co
+00001820: 6d70 6c65 7829 2078 6920 616e 6420 6574  mplex) xi and et
+00001830: 6120 7661 6c75 6573 2e0a 2020 2020 2020  a values..      
+00001840: 2020 2020 2020 0a20 2020 2020 2020 202a        .        *
+00001850: 2a6b 7761 7267 730a 2020 2020 2020 2020  *kwargs.        
+00001860: 2020 2020 4f70 7469 6f6e 616c 206b 6579      Optional key
+00001870: 776f 7264 6564 2061 7267 756d 656e 7473  worded arguments
+00001880: 2070 6173 7365 6420 746f 2073 656c 662e   passed to self.
+00001890: 656e 7365 6d62 6c65 5f70 726f 7061 6761  ensemble_propaga
+000018a0: 7469 6f6e 2072 6f75 7469 6e65 2e0a 2020  tion routine..  
+000018b0: 2020 2020 2020 2901 724b 0000 0029 0372        ).rK...).r
+000018c0: 1300 0000 7214 0000 0072 1500 0000 721b  ....r....r....r.
+000018d0: 0000 0072 1b00 0000 721c 0000 00da 085f  ...r....r......_
+000018e0: 5f63 616c 6c5f 5f84 0000 0073 0200 0000  _call__....s....
+000018f0: 1017 7a16 6865 796f 6b61 5f73 6f6c 7665  ..z.heyoka_solve
+00001900: 722e 5f5f 6361 6c6c 5f5f 4e29 0172 3500  r.__call__N).r5.
+00001910: 0000 290a da08 5f5f 6e61 6d65 5f5f da0a  ..)...__name__..
+00001920: 5f5f 6d6f 6475 6c65 5f5f da0c 5f5f 7175  __module__..__qu
+00001930: 616c 6e61 6d65 5f5f 7229 0000 0072 2300  alname__r)...r#.
+00001940: 0000 721e 0000 0072 4b00 0000 720a 0000  ..r....rK...r...
+00001950: 0072 1100 0000 7256 0000 0072 1b00 0000  .r....rV...r....
+00001960: 721b 0000 0072 1b00 0000 721c 0000 0072  r....r....r....r
+00001970: 1f00 0000 1d00 0000 7310 0000 0008 0008  ........s.......
+00001980: 0208 0702 110c 0108 3608 0b0c 0b72 1f00  ........6....r..
+00001990: 0000 2908 da06 6865 796f 6b61 7226 0000  ..)...heyokar&..
+000019a0: 00da 056e 756d 7079 720e 0000 00da 0663  ...numpyr......c
+000019b0: 6f6d 6d6f 6e72 0300 0000 721e 0000 0072  ommonr....r....r
+000019c0: 1f00 0000 721b 0000 0072 1b00 0000 721b  ....r....r....r.
+000019d0: 0000 0072 1c00 0000 da08 3c6d 6f64 756c  ...r......<modul
+000019e0: 653e 0100 0000 730a 0000 0008 0008 010c  e>....s.........
+000019f0: 0208 0212 17                             .....
```

### Comparing `lieops-0.2.1/lieops/solver/__pycache__/splitting.cpython-310.pyc` & `lieops-0.2.2/lieops/solver/__pycache__/splitting.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/solver/__pycache__/tao.cpython-310.pyc` & `lieops-0.2.2/lieops/solver/__pycache__/tao.cpython-310.pyc`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/solver/bruteforce.py` & `lieops-0.2.2/lieops/solver/bruteforce.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/solver/channell.py` & `lieops-0.2.2/lieops/solver/channell.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/solver/common.py` & `lieops-0.2.2/lieops/solver/common.py`

 * *Files 11% similar despite different names*

```diff
@@ -22,49 +22,50 @@
     def eqs(*z):
         zinp = list(z) + [e.conjugate() for e in z]
         dH = dhamiltonian.grad(*zinp)
         dxi = [dH.get((k,), 0) for k in range(hamiltonian.dim, 2*hamiltonian.dim)]
         return dxi
     return eqs
 
-def getRealHamiltonFunction(hamiltonian, real=False, tol=0, **kwargs):
+def getRealHamiltonFunction(hamiltonian, real=False, tol_drop=0):
     '''
     Create a Hamilton function H(q, p), for a given Hamiltonian H(xi, eta).
     
     Parameters
     ----------
     hamiltonian: ops.poly
         A poly object, representing a Hamiltonian in its default complex (xi, eta)-coordinates.
     
     real: boolean, optional
         This flag is intended to be used on Hamiltonians whose real form is expected to not
         contain imaginary parts.
         
-    tol: float, optional
-        Only in effect if len(nf) == 0. If > 0, then drop Hamiltonian coefficients below this threshold.
-        
-    **kwargs
-        Optional keyword arguments passed to hamiltonian.realBasis routine.
-        
+    tol_drop: float, optional
+        Drop coefficients below this threshold.
+                
     Returns
     -------
     callable
         A function taking values in 2*hamiltonian.dim input parameters and returns a complex (or real) value.
         It will represent the Hamiltonian with respect to its real (q, p)-coordinates.
     '''
     dim = hamiltonian.dim
-    rbh = hamiltonian.realBasis(**kwargs)
+    rbh = hamiltonian.realBasis()
     if real:
         # In this case we remove the imaginary parts from rbh outright.
         # This becomes necessary if we want to apply the heyoka solver, which complains if
         # one attempts to multiply a complex value with one of its variables
         rbh = {k: v.real for k, v in rbh.items()}
 
-    if tol > 0:
-        rbh = {k: v for k, v in rbh.items() if abs(v) >= tol}
+    if tol_drop > 0:
+        try:
+            rbh = {k: v for k, v in rbh.items() if abs(v) >= tol_drop}
+        except:
+            # Values might be multi-dimensional numpy arrays
+            rbh = {k: v for k, v in rbh.items() if (abs(v) >= tol_drop).all()}
 
     # By construction, the realBasis of a Hamiltonian is given in terms of powers of q and p:
     def ham(*qp):
         result = 0
         for k, v in rbh.items():
             power = 1
             for l in range(dim):
```

### Comparing `lieops-0.2.1/lieops/solver/flow2by2.py` & `lieops-0.2.2/lieops/solver/flow2by2.py`

 * *Files 27% similar despite different names*

```diff
@@ -1,14 +1,24 @@
 import numpy as np
 from scipy.linalg import expm
 import warnings
 
 from lieops.core.tools import poly3ad, ad3poly, vec3poly, poly3vec
+from lieops.linalg.common import ndsupport
+from lieops.linalg.matrix import emat
+
 import lieops.core.lie
 
+np_eig_nd = ndsupport(np.linalg.eig, n_out_args=2)
+np_inv_nd = ndsupport(np.linalg.inv)
+
+_checkf = ndsupport(lambda x: abs(np.linalg.det(x)))
+expm_nd = ndsupport(expm)
+_diagexp = ndsupport(lambda d: np.diag(np.exp(d)), n_inp_axes=1)
+
 def get_2flow(ham, tol=1e-12):
     '''
     Compute the exact flow of a Hamiltonian, modeled by a polynomial of first or second-order.
     I.e. compute the solution of
         dz/dt = {H, z}, z(0) = p,
     where { , } denotes the poisson bracket, H the requested Hamiltonian.
     Hereby H and p must be polynomials of order <= 2.
@@ -30,25 +40,26 @@
         return flow
     
     assert ham.maxdeg() <= 2, 'Hamiltonian of degree <= 2 required.'
     poisson_factor = ham._poisson_factor
     
     Hmat = poly3ad(ham) # Hmat: (2n + 1)x(2n + 1)-matrix
     
-    # Alternative:
-    evals, M = np.linalg.eig(Hmat)
-    check = abs(np.linalg.det(M)) < tol
+    evals, M = np_eig_nd(Hmat) # Compute the eigenvalues and eigenvectors of Hmat
+    check = (_checkf(M) < tol).any()
     if check:
         # in this case we have to rely on a different method to calculate the matrix exponential.
         # for the time being we shall use scipy's expm routine.
-        expH = expm(Hmat)
+        expH = emat(expm_nd(Hmat))
     else:
-        Mi = np.linalg.inv(M) # so that M@np.diag(evals)@Mi = Hmat holds.
+        #Mi = np.linalg.inv(M) so that M@np.diag(evals)@Mi = Hmat holds.
+        Mi = np_inv_nd(M)
         # compute the exponential exp(t*Hmat) = exp(M@(t*D)@Mi) = M@exp(t*D)@Mi:
-        expH = M@np.diag(np.exp(evals))@Mi
+        M, Mi = emat(M), emat(Mi)
+        expH = M@emat(_diagexp(evals))@Mi
 
     def flow(p, t=1, **kwargs):
         '''
         Compute the solution z so that
         dz/dt = {H, z}, z(0) = p,
         where { , } denotes the poisson bracket, H the requested Hamiltonian.
         
@@ -67,33 +78,42 @@
             warnings.warn('lieops.core.lie.poly input expected')
             return p
         
         assert poisson_factor == p._poisson_factor, 'Hamiltonian and given polynomial are instantiated with respect to different poisson structures.'
         
         if t != 1:
             if check:
-                expH_t = expm(Hmat*t)
+                expH_t = emat(expm_nd(Hmat*t))
             else:
-                expH_t = M@np.diag(np.exp(evals*t))@Mi  
+                expH_t = M@emat(_diagexp(evals*t))@Mi
         else:
             expH_t = expH
-            
+                        
         maxdeg = p.maxdeg()
         p0 = p.homogeneous_part(0) # the constants will be reproduced in the end (by the '1' in the flow)
         result = p0
+        
         if maxdeg > 0:
             p1 = p.homogeneous_part(1)
-            Y = poly3vec(p1)
+            Y = emat(poly3vec(p1))
             Z = expH_t@Y
-            result += vec3poly(Z)
-        if maxdeg > 1:
+            result += vec3poly(Z.matrix) # Z (and Y) are modeled here by 'emat' objects (extended matrices). This object also works for vectors, which is the case here.
+            
+        if maxdeg > 1: # compute the flow using the Pull-back property of exp(:f:)
             p_rest = p.extract(key_cond=lambda x: sum(x) > 1)
-            # compute the flow using the Pull-back property of exp(:f:)
             dim = p.dim
             dim2 = dim*2
-            xieta = lieops.core.lie.create_coords(dim=dim)
-            unit_vectors = np.concatenate([np.eye(dim2), np.zeros([1, dim2])], axis=0)
-            Z = expH_t@unit_vectors
-            xietaf = [vec3poly(zz) for zz in Z.transpose()]
+            
+            # Create unit vectors where each has attached one zero in the end (for the dim2 + 1 scenario).
+            shape = expH_t.shape[2:]
+            zeros = np.zeros(shape, dtype=np.complex128)
+            ones = np.ones(shape, dtype=np.complex128)
+            E = np.array([[zeros if i != k else ones for i in range(dim2)] for k in range(dim2 + 1)])
+            
+            # Apply the matrix representation to the unit vectors
+            Z = (expH_t@E).transpose()
+            xietaf = [vec3poly(Z.matrix[j]) for j in range(len(Z))]
             result += p_rest(*xietaf)
+            
         return result
+    
     return flow
```

### Comparing `lieops-0.2.1/lieops/solver/heyoka.py` & `lieops-0.2.2/lieops/solver/heyoka.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/solver/splitting.py` & `lieops-0.2.2/lieops/solver/splitting.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/lieops/solver/tao.py` & `lieops-0.2.2/lieops/solver/tao.py`

 * *Files identical despite different names*

### Comparing `lieops-0.2.1/pyproject.toml` & `lieops-0.2.2/pyproject.toml`

 * *Files 12% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 [tool.poetry]
 name = "lieops"
-version = "0.2.1"
+version = "0.2.2"
 description = "Lie operator tools."
 authors = [ "Malte Titze <mtitze@users.noreply.github.com>",]
 license = "GPL-3.0-or-later"
 homepage = "https://lieops.readthedocs.io/en/latest/index.html"
 repository = "https://github.com/mtitze/lieops"
 keywords = [ "Birkhoff", "normal", "form", "Lie", "Magnus",]
 include = [
```

### Comparing `lieops-0.2.1/setup.py` & `lieops-0.2.2/setup.py`

 * *Files 5% similar despite different names*

```diff
@@ -33,15 +33,15 @@
 extras_require = \
 {'docs': ['Sphinx>=4.5.0,<5.0.0',
           'sphinx-rtd-theme>=1.0.0,<2.0.0',
           'sphinxcontrib-napoleon>=0.7,<0.8']}
 
 setup_kwargs = {
     'name': 'lieops',
-    'version': '0.2.1',
+    'version': '0.2.2',
     'description': 'Lie operator tools.',
     'long_description': None,
     'author': 'Malte Titze',
     'author_email': 'mtitze@users.noreply.github.com',
     'maintainer': None,
     'maintainer_email': None,
     'url': 'https://lieops.readthedocs.io/en/latest/index.html',
```

### Comparing `lieops-0.2.1/PKG-INFO` & `lieops-0.2.2/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: lieops
-Version: 0.2.1
+Version: 0.2.2
 Summary: Lie operator tools.
 Home-page: https://lieops.readthedocs.io/en/latest/index.html
 License: GPL-3.0-or-later
 Keywords: Birkhoff,normal,form,Lie,Magnus
 Author: Malte Titze
 Author-email: mtitze@users.noreply.github.com
 Requires-Python: >=3.8,<3.11
```

